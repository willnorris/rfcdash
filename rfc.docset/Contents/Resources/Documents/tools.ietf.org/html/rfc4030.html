<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head profile="http://dublincore.org/documents/2008/08/04/dc-html/">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="robots" content="index,follow" />
    <meta name="creator" content="rfcmarkup version 1.107" />
    <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" />
<meta name="DC.Identifier" content="urn:ietf:rfc:4030" />
<meta name="DC.Description.Abstract" content="The Dynamic Host Configuration Protocol (DHCP) Relay Agent Information\nOption (RFC 3046) conveys information between a DHCP Relay Agent and a\nDHCP server. This specification defines an authentication suboption\nfor that option, containing a keyed hash in its payload. The suboption\nsupports data integrity and replay protection for relayed DHCP\nmessages. [STANDARDS-TRACK]" />
<meta name="DC.Creator" content="Lemon, Ted" />
<meta name="DC.Creator" content="Stapp, Mark" />
<meta name="DC.Date.Issued" content="March, 2005" />
<meta name="DC.Title" content="The Authentication Suboption for the Dynamic Host Configuration Protocol (DHCP) Relay Agent Option" />

    <link rel="icon" href="http://tools.ietf.org/images/rfc.png" type="image/png" />
    <link rel="shortcut icon" href="http://tools.ietf.org/images/rfc.png" type="image/png" />
    <title>RFC 4030 - The Authentication Suboption for the Dynamic Host Configuration Protocol (DHCP) Relay Agent Option</title>
    
    
    <style type="text/css">
	body {
	    margin: 0px 8px;
            font-size: 1em;
	}
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
   <div style="height: 13px;">
      <div onmouseover="this.style.cursor='pointer';"
         onclick="showElem('legend');"
         onmouseout="hideElem('legend')"
	 style="height: 6px; position: absolute;"
         class="pre noprint docinfo bgblue"
         title="Click for colour legend." >                                                                        </div>
      <div id="legend"
           class="docinfo noprint pre legend"
           style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; "
           onmouseover="showElem('legend');"
           onmouseout="hideElem('legend');">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="http://tools.ietf.org/rfc/rfc4030.txt" title="Plaintext version of this document">txt</a>|<a href="http://tools.ietf.org/pdf/rfc4030" title="PDF version of this document">pdf</a>] [<a href="http://tools.ietf.org/html/draft-ietf-dhc-auth-suboption" title="draft-ietf-dhc-auth-suboption">draft-ietf-dhc-au...</a>] [<a href="http://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc4030" title="Inline diff (wdiff)">Diff1</a>] [<a href="http://tools.ietf.org/rfcdiff?url2=rfc4030" title="Side-by-side diff">Diff2</a>]                 </span><br />
<span class="pre noprint docinfo">                                                                        </span><br />
<span class="pre noprint docinfo">                                                       PROPOSED STANDARD</span><br />
<span class="pre noprint docinfo">                                                                        </span><br />
<pre>
Network Working Group                                           M. Stapp
Request for Comments: 4030                           Cisco Systems, Inc.
Category: Standards Track                                      T. Lemon
                                                           Nominum, Inc.
                                                              March 2005


                 <span class="h1">The Authentication Suboption for the</span>
     <span class="h1">Dynamic Host Configuration Protocol (DHCP) Relay Agent Option</span>

Status of This Memo

   This document specifies an Internet standards track protocol for the
   Internet community, and requests discussion and suggestions for
   improvements.  Please refer to the current edition of the "Internet
   Official Protocol Standards" (STD 1) for the standardization state
   and status of this protocol.  Distribution of this memo is unlimited.

Copyright Notice

   Copyright (C) The Internet Society (2005).

Abstract

   The Dynamic Host Configuration Protocol (DHCP) Relay Agent
   Information Option (<a href="rfc3046.html">RFC 3046</a>) conveys information between a DHCP
   Relay Agent and a DHCP server.  This specification defines an
   authentication suboption for that option, containing a keyed hash in
   its payload.  The suboption supports data integrity and replay
   protection for relayed DHCP messages.





















<span class="grey">Stapp &amp; Lemon               Standards Track                     [Page 1]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-2" id="page-2" href="#page-2" class="invisible"> </a>
<span class="grey"><a href="rfc4030.html">RFC 4030</a>                Authentication Suboption              March 2005</span>


Table of Contents

   <a href="#section-1">1</a>.  Introduction . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-2">2</a>
   <a href="#section-2">2</a>.  Requirements Terminology . . . . . . . . . . . . . . . . . .   <a href="#page-3">3</a>
   <a href="#section-3">3</a>.  DHCP Terminology . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-4">4</a>
   <a href="#section-4">4</a>.  Suboption Format . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-4">4</a>
   <a href="#section-5">5</a>.  Replay Detection . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-5">5</a>
   <a href="#section-6">6</a>.  The Relay Identifier Field . . . . . . . . . . . . . . . . .   <a href="#page-5">5</a>
   <a href="#section-7">7</a>.  Computing Authentication Information . . . . . . . . . . . .   <a href="#page-6">6</a>
       <a href="#section-7.1">7.1</a>.  The HMAC-SHA1 Algorithm  . . . . . . . . . . . . . . .   <a href="#page-6">6</a>
   <a href="#section-8">8</a>.  Procedures for Sending Messages  . . . . . . . . . . . . . .   <a href="#page-7">7</a>
       <a href="#section-8.1">8.1</a>.  Replay Detection . . . . . . . . . . . . . . . . . . .   <a href="#page-7">7</a>
       <a href="#section-8.2">8.2</a>.  Packet Preparation . . . . . . . . . . . . . . . . . .   <a href="#page-8">8</a>
       <a href="#section-8.3">8.3</a>.  Checksum Computation . . . . . . . . . . . . . . . . .   <a href="#page-8">8</a>
       <a href="#section-8.4">8.4</a>.  Sending the Message  . . . . . . . . . . . . . . . . .   <a href="#page-8">8</a>
   <a href="#section-9">9</a>.  Procedures for Processing Incoming Messages  . . . . . . . .   <a href="#page-8">8</a>
       <a href="#section-9.1">9.1</a>.  Initial Examination  . . . . . . . . . . . . . . . . .   <a href="#page-8">8</a>
       <a href="#section-9.2">9.2</a>.  Replay Detection Check . . . . . . . . . . . . . . . .   <a href="#page-9">9</a>
       <a href="#section-9.3">9.3</a>.  Testing the Checksum . . . . . . . . . . . . . . . . .   <a href="#page-9">9</a>
   <a href="#section-10">10</a>. Relay Agent Behavior . . . . . . . . . . . . . . . . . . . .   <a href="#page-9">9</a>
       <a href="#section-10.1">10.1</a>. Receiving Messages from Other Relay Agents . . . . . .  <a href="#page-10">10</a>
       <a href="#section-10.2">10.2</a>. Sending Messages to Servers  . . . . . . . . . . . . .  <a href="#page-10">10</a>
       <a href="#section-10.3">10.3</a>. Receiving Messages from Servers  . . . . . . . . . . .  <a href="#page-10">10</a>
   <a href="#section-11">11</a>. DHCP Server Behavior . . . . . . . . . . . . . . . . . . . .  <a href="#page-10">10</a>
       <a href="#section-11.1">11.1</a>. Receiving Messages from Relay Agents . . . . . . . . .  <a href="#page-10">10</a>
       <a href="#section-11.2">11.2</a>. Sending Reply Messages to Relay Agents . . . . . . . .  <a href="#page-11">11</a>
   <a href="#section-12">12</a>. IANA Considerations  . . . . . . . . . . . . . . . . . . . .  <a href="#page-11">11</a>
   <a href="#section-13">13</a>. Security Considerations  . . . . . . . . . . . . . . . . . .  <a href="#page-11">11</a>
       <a href="#section-13.1">13.1</a>. The Key ID Field . . . . . . . . . . . . . . . . . . .  <a href="#page-12">12</a>
       <a href="#section-13.2">13.2</a>. Protocol Vulnerabilities . . . . . . . . . . . . . . .  <a href="#page-12">12</a>
   <a href="#section-14">14</a>. Acknowledgements . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-13">13</a>
   <a href="#section-15">15</a>. References . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-13">13</a>
       <a href="#section-15.1">15.1</a>. Normative References . . . . . . . . . . . . . . . . .  <a href="#page-13">13</a>
       <a href="#section-15.2">15.2</a>. Informative References . . . . . . . . . . . . . . . .  <a href="#page-13">13</a>
   Authors' Addresses . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-14">14</a>
   Full Copyright Statement . . . . . . . . . . . . . . . . . . . .  <a href="#page-15">15</a>

<span class="h2"><a class="selflink" name="section-1" href="#section-1">1</a>.  Introduction</span>

   DHCP (<a href="rfc2131.html">RFC 2131</a> [<a href="#ref-6" title="&quot;Dynamic Host Configuration Protocol&quot;">6</a>]) provides IP addresses and configuration
   information for IPv4 clients.  It includes a relay-agent capability
   (<a href="rfc951.html">RFC 951</a> [<a href="#ref-7" title="&quot;Bootstrap Protocol&quot;">7</a>], <a href="rfc1542.html">RFC 1542</a> [<a href="#ref-8" title="&quot;Clarifications and Extensions for the Bootstrap Protocol&quot;">8</a>]) in which processes within the network
   infrastructure receive broadcast messages from clients and forward
   them to servers as unicast messages.  In network environments such as
   DOCSIS data-over-cable and xDSL, for example, it has proven useful
   for the relay agent to add information to the DHCP message before
   forwarding it, by using the relay-agent information option (<a href="rfc3046.html">RFC 3046</a>
   [<a href="#ref-1" title="&quot;DHCP Relay Agent Information Option&quot;">1</a>]).  The kind of information that relays add is often used in the



<span class="grey">Stapp &amp; Lemon               Standards Track                     [Page 2]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-3" id="page-3" href="#page-3" class="invisible"> </a>
<span class="grey"><a href="rfc4030.html">RFC 4030</a>                Authentication Suboption              March 2005</span>


   server's decision-making about the addresses and configuration
   parameters that the client should receive.  The way that the
   relay-agent data is used in server decision-making tends to make that
   data very important, and it highlights the importance of the trust
   relationship between the relay agent and the server.

   The existing DHCP Authentication specification (<a href="rfc3118.html">RFC 3118</a>) [<a href="#ref-9" title="&quot;Authentication for DHCP Messages&quot;">9</a>] only
   covers communication between the DHCP client and server.  Because
   relay-agent information is added after the client has sent its
   message, the DHCP Authentication specification explicitly excludes
   relay-agent data from that authentication.

   The goal of this specification is to define methods that a relay
   agent can use to

      1.  protect the integrity of relayed DHCP messages,
      2.  provide replay protection for those messages, and
      3.  leverage existing mechanisms, such as DHCP Authentication.

   In order to meet these goals, we specify a new relay-agent suboption,
   the Authentication suboption.  The format of this suboption is very
   similar to the format of the DHCP Authentication option, and the
   specification of its cryptographic methods and hash computation is
   also similar.

   The Authentication suboption is included by relay agents that seek to
   ensure the integrity of the data they include in the Relay Agent
   option.  These relay agents are configured with the parameters
   necessary for generating cryptographic checksums of the data in the
   DHCP messages that they forward to DHCP servers.  A DHCP server
   configured to process the Authentication suboption uses the
   information in the suboption to verify the checksum in the suboption
   and continues processing the relay agent information option only if
   the checksum is valid.  If the DHCP server sends a response, it
   includes an Authentication suboption in its response message.  Relay
   agents test the checksums in DHCP server responses to decide whether
   to forward the responses.

<span class="h2"><a class="selflink" name="section-2" href="#section-2">2</a>.  Requirements Terminology</span>

   In this document, the key words "MUST", "MUST NOT", "REQUIRED",
   "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY",
   and "OPTIONAL" are to be interpreted as described in <a href="rfc2119.html">RFC 2119</a> [<a href="#ref-2" title="&quot;Key words for use in RFCs to Indicate Requirement Levels&quot;">2</a>].








<span class="grey">Stapp &amp; Lemon               Standards Track                     [Page 3]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-4" id="page-4" href="#page-4" class="invisible"> </a>
<span class="grey"><a href="rfc4030.html">RFC 4030</a>                Authentication Suboption              March 2005</span>


<span class="h2"><a class="selflink" name="section-3" href="#section-3">3</a>.  DHCP Terminology</span>

   This document uses the terms "DHCP server" (or "server") and "DHCP
   client" (or "client") as defined in <a href="rfc2131.html">RFC 2131</a> [<a href="#ref-6" title="&quot;Dynamic Host Configuration Protocol&quot;">6</a>].  The term "DHCP
   relay agent" refers to a "BOOTP relay agent" as defined in <a href="rfc2131.html">RFC 2131</a>.

<span class="h2"><a class="selflink" name="section-4" href="#section-4">4</a>.  Suboption Format</span>

       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |     Code      |    Length     |   Algorithm   |  MBZ  |  RDM  |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |  Replay Detection (64 bits)                                   |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |  Replay Detection cont.                                       |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                    Relay Identifier                           |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                                                               |
      |                                                               |
      |                Authentication Information                     |
      |                                                               |
      |                                                               |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   The code for the suboption is 8.  The length field includes the
   lengths of the algorithm, the RDM, and all subsequent suboption
   fields in octets.

   The Algorithm field defines the algorithm used to generate the
   authentication information.

   Four bits are reserved for future use.  These bits SHOULD be set to
   zero and MUST NOT be used when the suboption is processed.

   The Replay Detection Method (RDM) field defines the method used to
   generate the Replay Detection Data.

   The Replay Detection field contains a value used to detect replayed
   messages, which are interpreted according to the RDM.

   The Relay Identifier field is used by relay agents that do not set
   giaddr, as described in <a href="rfc3046.html">RFC 3046</a> [<a href="#ref-1" title="&quot;DHCP Relay Agent Information Option&quot;">1</a>], section 2.1.







<span class="grey">Stapp &amp; Lemon               Standards Track                     [Page 4]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-5" id="page-5" href="#page-5" class="invisible"> </a>
<span class="grey"><a href="rfc4030.html">RFC 4030</a>                Authentication Suboption              March 2005</span>


   The Authentication Information field contains the data required to
   communicate algorithm-specific parameters, as well as the checksum.
   The checksum is usually a digest of the data in the DHCP packet
   computed by using the method specified by the Algorithm field.

<span class="h2"><a class="selflink" name="section-5" href="#section-5">5</a>.  Replay Detection</span>

   The replay-detection mechanism is designed on the notion that a
   receiver can determine whether a message has a valid replay token
   value.  The default RDM, with value 1, specifies that the Replay
   Detection field contains an increasing counter value.  The receiver
   associates a replay counter with each sender and rejects any message
   containing an authentication suboption with a Replay Detection
   counter value less than or equal to the last valid value.  DHCP
   servers MAY identify relay agents by giaddr value or by other data in
   the message (e.g., data in other relay agent suboptions).  Relay
   agents identify DHCP servers by source IP address.  If the message's
   replay detection value, and the checksum are valid, the receiver
   updates its notion of the last valid replay counter value associated
   with the sender.

   All implementations MUST support the default RDM.  Additional methods
   may be defined in the future, following the process described in
   <a href="#section-12">section 12</a>.

   Receivers SHOULD perform the replay-detection check before testing
   the checksum.  The keyed hash calculation is likely to be much more
   expensive than the replay-detection value check.

      DISCUSSION:
         This places a burden on the receiver to maintain some run-time
         state (the most-recent valid counter value) for each sender,
         but the number of members in a DHCP agent-server system is
         unlikely to be unmanageably large.

<span class="h2"><a class="selflink" name="section-6" href="#section-6">6</a>.  The Relay Identifier Field</span>

   The Relay Agent Information Option [<a href="#ref-1" title="&quot;DHCP Relay Agent Information Option&quot;">1</a>] specification permits a relay
   agent to add a relay agent option to relayed messages without setting
   the giaddr field.  In this case, the eventual receiver of the message
   needs a stable identifier to use in order to associate per-sender
   state such as Key ID and replay-detection counters.

   A relay agent that adds a relay agent information option and sets
   giaddr MUST NOT set the Relay ID field.  A relay agent that does not
   set giaddr MAY be configured to place a value in the Relay ID field.
   If the relay agent is configured to use the Relay ID field, it MAY be
   configured with a value to use, or it MAY be configured to generate a



<span class="grey">Stapp &amp; Lemon               Standards Track                     [Page 5]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-6" id="page-6" href="#page-6" class="invisible"> </a>
<span class="grey"><a href="rfc4030.html">RFC 4030</a>                Authentication Suboption              March 2005</span>


   value based on some other data, such as its MAC or IP addresses.  If
   a relay generates a Relay ID value, it SHOULD select a value that it
   can regenerate reliably; e.g., across reboots.

   Servers that process an Authentication Suboption SHOULD use the
   giaddr value to identify the sender if the giaddr field is set.
   Servers MAY be configured to use some other data in the message to
   identify the sender.  If giaddr is not set, the server SHOULD use the
   Relay ID field if it is nonzero.  If neither the giaddr nor the Relay
   ID field is set, the server MAY be configured to use some other data
   in the message, or it MAY increment an error counter.

<span class="h2"><a class="selflink" name="section-7" href="#section-7">7</a>.  Computing Authentication Information</span>

   The Authentication Information field contains a keyed hash generated
   by the sender.  All algorithms are defined to process the data in the
   DHCP messages in the same way.  The sender and receiver compute a
   hash across a buffer containing all of the bytes in the DHCP message,
   including the fixed DHCP message header, the DHCP options, and the
   relay agent suboptions, with the following exceptions.  The value of
   the 'hops' field MUST be set to zero for the computation because its
   value may be changed in transmission.  The value of the 'giaddr'
   field MUST also be set to zero for the computation because it may be
   modified in networks where one relay agent adds the relay agent
   option but another relay agent sets 'giaddr' (see <a href="rfc3046.html#section-2.1">RFC 3046, section&nbsp;</a>
   <a href="#section-2.1">2.1</a>).  In addition, because the relay agent option is itself included
   in the computation, the 'authentication information' field in the
   Authentication suboption is set to all zeros.  The relay agent option
   length, the Authentication suboption length and other Authentication
   suboption fields are all included in the computation.

   All implementations MUST support Algorithm 1, the HMAC-SHA1
   algorithm.  Additional algorithms may be defined in the future,
   following the process described in <a href="#section-12">section 12</a>.

<span class="h3"><a class="selflink" name="section-7.1" href="#section-7.1">7.1</a>.  The HMAC-SHA1 Algorithm</span>

   Algorithm 1 is assigned to the HMAC [<a href="#ref-3" title="&quot;HMAC: Keyed-Hashing for Message Authentication&quot;">3</a>] protocol by using the SHA-1
   [<a href="#ref-4" title="&quot;US Secure Hash Algorithm 1 (SHA1)&quot;">4</a>] hash function.  This algorithm requires that a shared secret key
   be configured at the relay agent and the DHCP server.  A 32-bit Key
   Identifier is associated with each shared key, and this identifier is
   carried in the first 4 bytes of the Authentication Information field
   of the Authentication suboption.  The HMAC-SHA1 computation generates
   a 20-byte hash value, which is placed in the Authentication
   Information field after the Key ID.






<span class="grey">Stapp &amp; Lemon               Standards Track                     [Page 6]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-7" id="page-7" href="#page-7" class="invisible"> </a>
<span class="grey"><a href="rfc4030.html">RFC 4030</a>                Authentication Suboption              March 2005</span>


   When Algorithm 1 is used, the format of the Authentication suboption
   is as follows:

       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |     Code      |       38      |0 0 0 0 0 0 0 1|  MBZ  |  RDM  |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |  Replay Detection (64 bits)                                   |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |  Replay Detection cont.                                       |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                    Relay Identifier                           |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                        Key ID (32 bits)                       |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                                                               |
      |                      HMAC-SHA1 (160 bits)                     |
      |                                                               |
      |                                                               |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   The suboption length is 38.  The RDM and Replay Detection fields are
   as specified in <a href="#section-5">section 5</a>.  The Relay ID field is set as specified in
   <a href="#section-6">section 6</a>.  The Key ID is set by the sender to the ID of the key used
   in computing the checksum, as an integer value in network byte order.
   The HMAC result follows the Key ID.

   The Key ID exists only to allow the sender and receiver to specify a
   shared secret in cases where more than one secret is in use among a
   network's relays and DHCP servers.  The Key ID values are entirely a
   matter of local configuration; they only have to be unique locally.
   This specification does not define any semantics or impose any
   requirements on this algorithm's Key ID values.

<span class="h2"><a class="selflink" name="section-8" href="#section-8">8</a>.  Procedures for Sending Messages</span>

<span class="h3"><a class="selflink" name="section-8.1" href="#section-8.1">8.1</a>.  Replay Detection</span>

   The sender obtains a replay-detection counter value to use based on
   the RDM it is using.  If the sender is using RDM 1, the default RDM,
   the value MUST be greater than any previously sent value.









<span class="grey">Stapp &amp; Lemon               Standards Track                     [Page 7]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-8" id="page-8" href="#page-8" class="invisible"> </a>
<span class="grey"><a href="rfc4030.html">RFC 4030</a>                Authentication Suboption              March 2005</span>


<span class="h3"><a class="selflink" name="section-8.2" href="#section-8.2">8.2</a>.  Packet Preparation</span>

   The sender sets the 'giaddr' field and the 'hops' field to all zeros.
   The sender appends the relay agent information option to the client's
   packet, including the Authentication suboption.  The sender selects
   an appropriate Replay Detection value.  The sender places its
   identifier into the Relay ID field, if necessary, or sets the field
   to all zeros.  The sender sets the suboption length, places the
   Replay Detection value into the Replay Detection field of the
   suboption, and sets the algorithm to the algorithm number that it is
   using.  If the sender is using HMAC-SHA1, it sets the Key ID field to
   the appropriate value.  The sender sets the field that will contain
   the checksum to all zeros.  Other algorithms may specify additional
   preparation steps.

<span class="h3"><a class="selflink" name="section-8.3" href="#section-8.3">8.3</a>.  Checksum Computation</span>

   The sender computes the checksum across the entire DHCP message,
   using the algorithm it has selected.  The sender places the result of
   the computation into the Authentication Information field of the
   Authentication suboption.

<span class="h3"><a class="selflink" name="section-8.4" href="#section-8.4">8.4</a>.  Sending the Message</span>

   The sender restores the values of the 'hops' and 'giaddr' fields and
   sends the message.

<span class="h2"><a class="selflink" name="section-9" href="#section-9">9</a>.  Procedures for Processing Incoming Messages</span>

<span class="h3"><a class="selflink" name="section-9.1" href="#section-9.1">9.1</a>.  Initial Examination</span>

   The receiver examines the message for the value of the giaddr field
   and determines whether the packet includes the relay agent
   information option.  The receiver uses its configuration to determine
   whether it should expect an Authentication suboption.  The receiver
   MUST support a configuration that allows it to drop incoming messages
   that do not contain a valid relay agent information option and
   Authentication suboption.

   If the receiver determines that the Authentication suboption is
   present and that it should process the suboption, it uses the data in
   the message to determine which algorithm, key, and RDM to use in
   validating the message.  If the receiver cannot determine which
   algorithm, key, and RDM to use, or if it does not support the value
   indicated in the message, it SHOULD drop the message.  Because this
   situation could indicate a misconfiguration that could deny service
   to clients, receivers MAY attempt to notify their administrators or
   to log an error message.



<span class="grey">Stapp &amp; Lemon               Standards Track                     [Page 8]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-9" id="page-9" href="#page-9" class="invisible"> </a>
<span class="grey"><a href="rfc4030.html">RFC 4030</a>                Authentication Suboption              March 2005</span>


<span class="h3"><a class="selflink" name="section-9.2" href="#section-9.2">9.2</a>.  Replay Detection Check</span>

   The receiver examines the RDM field.  Receivers MUST discard messages
   containing RDM values that they do not support.  Because this may
   indicate a misconfiguration at the sender, an attempt SHOULD be made
   to indicate this condition to the administrator by incrementing an
   error counter or writing a log message.  If the receiver supports the
   RDM, it examines the value in the Replay Detection field by using the
   procedures in the RDM and in <a href="#section-5">section 5</a>.  If the Replay value is not
   valid, the receiver MUST drop the message.

   Note that at this point the receiver MUST NOT update its notion of
   the last valid Replay Detection value for the sender.  Until the
   checksum has been tested, the Replay Detection field cannot be
   trusted.  If the receiver trusts the Replay Detection value without
   testing the checksum, a malicious host could send a replayed message
   with a Replay Detection value that was very high, tricking the
   receiver into rejecting legitimate values from the sender.

<span class="h3"><a class="selflink" name="section-9.3" href="#section-9.3">9.3</a>.  Testing the Checksum</span>

   The receiver prepares the packet in order to test the checksum by
   setting the 'giaddr' and 'hops' fields to zero, and by setting the
   Authentication Information field of the suboption to all zeros.
   Using the algorithm and key associated with the sender, the receiver
   computes a hash of the message.  The receiver compares the result of
   its computation with the value sent.  If the checksums do not match,
   the receiver MUST drop the message.  Otherwise, the receiver updates
   its notion of the last valid Replay Detection value associated with
   the sender and processes the message.

<span class="h2"><a class="selflink" name="section-10" href="#section-10">10</a>.  Relay Agent Behavior</span>

   DHCP Relay agents are typically configured with the addresses of one
   or more DHCP servers.  A relay agent that implements this suboption
   requires an algorithm number for each server, as well as appropriate
   credentials (i.e., keys).  Relay implementations SHOULD support a
   configuration that indicates that all relayed messages should include
   the authentication suboption.  Use of the authentication suboption
   SHOULD be disabled by default.  Relay agents MAY support
   configuration that indicates that certain destination servers support
   the authentication suboption and that other servers do not.  Relay
   agents MAY support configuration of a single algorithm number and key
   to be used with all DHCP servers, or they MAY support configuration
   of different algorithms and keys for each server.






<span class="grey">Stapp &amp; Lemon               Standards Track                     [Page 9]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-10" id="page-10" href="#page-10" class="invisible"> </a>
<span class="grey"><a href="rfc4030.html">RFC 4030</a>                Authentication Suboption              March 2005</span>


<span class="h3"><a class="selflink" name="section-10.1" href="#section-10.1">10.1</a>.  Receiving Messages from Other Relay Agents</span>

   There are network configurations in which one relay agent adds the
   relay agent option and then forwards the DHCP message to another
   relay agent.  For example, a layer-2 switch might be directly
   connected to a client, and it might forward messages to an
   aggregating router, which sets giaddr and then forwards the message
   to a DHCP server.  When a DHCP relay that implements the
   Authentication suboption receives a message, it MAY use the
   procedures in <a href="#section-9">section 9</a> to verify the source of the message before
   forwarding it.

<span class="h3"><a class="selflink" name="section-10.2" href="#section-10.2">10.2</a>.  Sending Messages to Servers</span>

   When the relay agent receives a broadcast packet from a client, it
   determines which DHCP servers (or other relay agents) should receive
   copies of the message.  If the relay agent is configured to include
   the Authentication suboption, it determines which Algorithm and RDM
   to use, and then it performs the steps in <a href="#section-8">section 8</a>.

<span class="h3"><a class="selflink" name="section-10.3" href="#section-10.3">10.3</a>.  Receiving Messages from Servers</span>

   When the relay agent receives a message, it determines from its
   configuration whether it expects the message to contain a relay agent
   information option and an Authentication suboption.  The relay agent
   MAY be configured to drop response messages that do not contain the
   Authentication suboption.  The relay agent then follows the
   procedures in <a href="#section-9">section 9</a>.

<span class="h2"><a class="selflink" name="section-11" href="#section-11">11</a>.  DHCP Server Behavior</span>

   DHCP servers may interact with multiple relay agents.  Server
   implementations MAY support a configuration that associates the same
   algorithm and key with all relay agents.  Servers MAY support a
   configuration that specifies the algorithm and key to use with each
   relay agent individually.

<span class="h3"><a class="selflink" name="section-11.1" href="#section-11.1">11.1</a>.  Receiving Messages from Relay Agents</span>

   When a DHCP server that implements the Authentication suboption
   receives a message, it performs the steps in <a href="#section-9">section 9</a>.










<span class="grey">Stapp &amp; Lemon               Standards Track                    [Page 10]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-11" id="page-11" href="#page-11" class="invisible"> </a>
<span class="grey"><a href="rfc4030.html">RFC 4030</a>                Authentication Suboption              March 2005</span>


<span class="h3"><a class="selflink" name="section-11.2" href="#section-11.2">11.2</a>.  Sending Reply Messages to Relay Agents</span>

   When the server has prepared a reply message, it uses the incoming
   request message and its configuration to determine whether it should
   include a relay agent information option and an Authentication
   suboption.  If the server is configured to include the Authentication
   suboption, it determines which Algorithm and RDM to use and then
   performs the steps in <a href="#section-8">section 8</a>.

      DISCUSSION:
         This server behavior represents a slight variance from <a href="rfc3046.html">RFC 3046</a>
         [<a href="#ref-1" title="&quot;DHCP Relay Agent Information Option&quot;">1</a>], section 2.2.  The Authentication suboption is not echoed
         back from the server to the relay; the server generates its own
         suboption.

<span class="h2"><a class="selflink" name="section-12" href="#section-12">12</a>.  IANA Considerations</span>

   <a href="#section-4">Section 4</a> defines a new suboption for the DHCP relay agent option
   called the Authentication Suboption.  IANA has allocated a new
   suboption code from the relay agent option suboption number space.

   This specification introduces two new number spaces for the
   Authentication suboption's 'Algorithm' and 'Replay Detection Method'
   fields.  These number spaces have been created and will be maintained
   by IANA.

   The Algorithm identifier is a one-byte value.  The Algorithm value 0
   is reserved.  The Algorithm value 1 is assigned to the HMAC-SHA1
   keyed hash, as defined in <a href="#section-7.1">section 7.1</a>.  Additional algorithm values
   will be allocated and assigned through IETF consensus, as defined in
   <a href="rfc2434.html">RFC 2434</a> [<a href="#ref-5" title="&quot;Guidelines for Writing an IANA Considerations Section in RFCs&quot;">5</a>].

   The RDM identifier is a four-bit value.  The RDM value 0 is reserved.
   The RDM value 1 is assigned to the use of a monotonically increasing
   counter value, as defined in <a href="#section-5">section 5</a>.  Additional RDM values will
   be allocated and assigned through IETF consensus, as defined in <a href="rfc2434.html">RFC</a>
   <a href="rfc2434.html">2434</a> [<a href="#ref-5" title="&quot;Guidelines for Writing an IANA Considerations Section in RFCs&quot;">5</a>].

<span class="h2"><a class="selflink" name="section-13" href="#section-13">13</a>.  Security Considerations</span>

   This specification describes a protocol that adds source
   authentication and message integrity protection to the messages
   between DHCP relay agents and DHCP servers.

   The use of this protocol imposes a new computational burden on relay
   agents and servers, because they must perform cryptographic hash
   calculations when they send and receive messages.  This burden may
   add latency to DHCP message exchanges.  Because relay agents are



<span class="grey">Stapp &amp; Lemon               Standards Track                    [Page 11]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-12" id="page-12" href="#page-12" class="invisible"> </a>
<span class="grey"><a href="rfc4030.html">RFC 4030</a>                Authentication Suboption              March 2005</span>


   involved when clients reboot, periods of very high reboot activity
   will result in the largest number of messages that have to be
   processed.  During a cable MSO head-end reboot event, for example,
   the time required for all clients to be served may increase.

<span class="h3"><a class="selflink" name="section-13.1" href="#section-13.1">13.1</a>.  The Key ID Field</span>

   The Authentication suboption contains a four-byte Key ID, following
   the example of the DHCP Authentication RFC.  Other authentication
   protocols, such as DNS TSIG [<a href="#ref-10" title="&quot;Secret Key Transaction Authentication for DNS (TSIG)&quot;">10</a>], use a key name.  A key name is more
   flexible and potentially more human readable than a key id.  DHCP
   servers may well be configured to use key names for DNS updates using
   TSIG, so it might simplify DHCP server configuration if some of the
   key management for both protocols could be shared.

   On the other hand, it is crucial to minimize the size expansion
   caused by the introduction of the relay agent information option.
   Named keys would require more physical space and would entail more
   complex suboption encoding and parsing implementations.  These
   considerations have led us to specify a fixed-length Key ID instead
   of a variable-length key name.

<span class="h3"><a class="selflink" name="section-13.2" href="#section-13.2">13.2</a>.  Protocol Vulnerabilities</span>

   Because DHCP is a UDP protocol, messages between relays and servers
   may be delivered in an order different from that in which they were
   generated.  The replay-detection mechanism will cause receivers to
   drop packets that are delivered 'late', leading to client retries.
   The retry mechanisms that most clients implement should not cause
   this to be an enormous issue, but it will cause senders to do
   computational work which will be wasted if their messages are
   re-ordered.

   The DHC WG has developed two documents describing authentication of
   DHCP relay agent options to accommodate the requirements of different
   deployment scenarios: this document and "Authentication of Relay
   Agent Options Using IPsec" [<a href="#ref-11" title="&quot;Authentication of Relay Agent Options Using IPsec&quot;">11</a>].  As we note in <a href="#section-11">section 11</a>, the
   Authentication suboption can be used without pairwise keys between
   each relay and each DHCP server.  In deployments where IPsec is
   readily available and pairwise keys can be managed efficiently, the
   use of IPsec as described in that document may be appropriate.  If
   IPsec is not available or there are multiple relay agents for which
   multiple keys must be managed, the protocol described in this
   document may be appropriate.  As is the case whenever two
   alternatives are available, local network administration can choose
   whichever is more appropriate.  Because the relay agents and the DHCP





<span class="grey">Stapp &amp; Lemon               Standards Track                    [Page 12]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-13" id="page-13" href="#page-13" class="invisible"> </a>
<span class="grey"><a href="rfc4030.html">RFC 4030</a>                Authentication Suboption              March 2005</span>


   server are all in the same administrative domain, the appropriate
   mechanism can be configured on all interoperating DHCP server
   elements.

<span class="h2"><a class="selflink" name="section-14" href="#section-14">14</a>.  Acknowledgements</span>

   The need for this specification was made clear by comments made by
   Thomas Narten and John Schnizlein, and the use of the DHCP
   Authentication option format was suggested by Josh Littlefield, at
   IETF 53.

<span class="h2"><a class="selflink" name="section-15" href="#section-15">15</a>.  References</span>

<span class="h3"><a class="selflink" name="section-15.1" href="#section-15.1">15.1</a>.  Normative References</span>

   [<a name="ref-1" id="ref-1">1</a>]  Patrick, M., "DHCP Relay Agent Information Option", <a href="rfc3046.html">RFC 3046</a>,
        January 2001.

   [<a name="ref-2" id="ref-2">2</a>]  Bradner, S., "Key words for use in RFCs to Indicate Requirement
        Levels", <a href="http://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.

   [<a name="ref-3" id="ref-3">3</a>]  Krawczyk, H., Bellare, M., and R. Canetti, "HMAC: Keyed-Hashing
        for Message Authentication", <a href="rfc2104.html">RFC 2104</a>, February 1997.

   [<a name="ref-4" id="ref-4">4</a>]  Eastlake 3rd, D. and P. Jones, "US Secure Hash Algorithm 1
        (SHA1)", <a href="rfc3174.html">RFC 3174</a>, September 2001.

   [<a name="ref-5" id="ref-5">5</a>]  Narten, T. and H. Alvestrand, "Guidelines for Writing an IANA
        Considerations Section in RFCs", <a href="http://tools.ietf.org/html/bcp26">BCP 26</a>, <a href="rfc2434.html">RFC 2434</a>, October 1998.

<span class="h3"><a class="selflink" name="section-15.2" href="#section-15.2">15.2</a>.  Informative References</span>

   [<a name="ref-6" id="ref-6">6</a>]  Droms, R., "Dynamic Host Configuration Protocol", <a href="rfc2131.html">RFC 2131</a>,
        March 1997.

   [<a name="ref-7" id="ref-7">7</a>]  Croft, W. and J. Gilmore, "Bootstrap Protocol", <a href="rfc951.html">RFC 951</a>,
        September 1985.

   [<a name="ref-8" id="ref-8">8</a>]  Wimer, W., "Clarifications and Extensions for the Bootstrap
        Protocol", <a href="rfc1542.html">RFC 1542</a>, October 1993.

   [<a name="ref-9" id="ref-9">9</a>]  Droms, R. and W. Arbaugh, "Authentication for DHCP Messages",
        <a href="rfc3118.html">RFC 3118</a>, June 2001.

   [<a name="ref-10" id="ref-10">10</a>] Vixie, P., Gudmundsson, O., Eastlake 3rd, D., and B. Wellington,
        "Secret Key Transaction Authentication for DNS (TSIG)", <a href="rfc2845.html">RFC</a>
        <a href="rfc2845.html">2845</a>, May 2000.




<span class="grey">Stapp &amp; Lemon               Standards Track                    [Page 13]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-14" id="page-14" href="#page-14" class="invisible"> </a>
<span class="grey"><a href="rfc4030.html">RFC 4030</a>                Authentication Suboption              March 2005</span>


   [<a name="ref-11" id="ref-11">11</a>] Droms, R., <a style="text-decoration: none" href='http://www.google.com/search?sitesearch=tools.ietf.org%2Fhtml%2F&amp;q=inurl:draft-+%22Authentication+of+Relay+Agent+Options+Using+IPsec%22'>"Authentication of Relay Agent Options Using IPsec"</a>,
        Work in Progress, February 2004.

Authors' Addresses

   Mark Stapp
   Cisco Systems, Inc.
   1414 Massachusetts Ave.
   Boxborough, MA  01719
   USA

   Phone: 978.936.0000
   EMail: mjs@cisco.com


   Ted Lemon
   Nominum, Inc.
   950 Charter St.
   Redwood City, CA  94063
   USA

   EMail: Ted.Lemon@nominum.com





























<span class="grey">Stapp &amp; Lemon               Standards Track                    [Page 14]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-15" id="page-15" href="#page-15" class="invisible"> </a>
<span class="grey"><a href="rfc4030.html">RFC 4030</a>                Authentication Suboption              March 2005</span>


Full Copyright Statement

   Copyright (C) The Internet Society (2005).

   This document is subject to the rights, licenses and restrictions
   contained in <a href="http://tools.ietf.org/html/bcp78">BCP 78</a>, and except as set forth therein, the authors
   retain all their rights.

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY AND THE INTERNET
   ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS OR IMPLIED,
   INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE
   INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

Intellectual Property

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in <a href="http://tools.ietf.org/html/bcp78">BCP 78</a> and <a href="http://tools.ietf.org/html/bcp79">BCP 79</a>.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   <a href="http://www.ietf.org/ipr">http://www.ietf.org/ipr</a>.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at ietf-
   ipr@ietf.org.

Acknowledgement

   Funding for the RFC Editor function is currently provided by the
   Internet Society.







Stapp &amp; Lemon               Standards Track                    [Page 15]

</pre><br />
<span class="noprint"><small><small>Html markup produced by rfcmarkup 1.107, available from
<a href="http://tools.ietf.org/tools/rfcmarkup/">http://tools.ietf.org/tools/rfcmarkup/</a>
</small></small></span>
</body>
<!-- Mirrored from tools.ietf.org/html/rfc4030 by HTTrack Website Copier/3.x [XR&CO'2010], Wed, 19 Mar 2014 18:41:31 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8"><!-- /Added by HTTrack -->
</html>
