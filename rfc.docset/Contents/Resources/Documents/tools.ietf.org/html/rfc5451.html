<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><head profile="http://dublincore.org/documents/2008/08/04/dc-html/">
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.107" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="urn:ietf:rfc:5451" name="DC.Identifier"/>
<meta content="This memo defines a new header field for use with electronic mail\nmessages to indicate the results of message authentication efforts.\nAny receiver-side software, such as mail filters or Mail User Agents\n(MUAs), may use this message header field to relay that information in\na convenient way to users or to make sorting and filtering decisions.\n[STANDARDS-TRACK]" name="DC.Description.Abstract"/>
<meta content="Murray S. Kucherawy &lt;msk+ietf@sendmail.com&gt;" name="DC.Creator"/>
<meta content="April, 2009" name="DC.Date.Issued"/>
<meta content="Message Header Field for Indicating Message Authentication Status" name="DC.Title"/>

    <link href="http://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="http://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 5451 - Message Header Field for Indicating Message Authentication Status</title>
    
    
    <style type="text/css">
	body {
	    margin: 0px 8px;
            font-size: 1em;
	}
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgbrown" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="http://tools.ietf.org/rfc/rfc5451.txt" title="Plaintext version of this document">txt</a>|<a href="http://tools.ietf.org/pdf/rfc5451" title="PDF version of this document">pdf</a>] [<a href="http://tools.ietf.org/html/draft-kucherawy-sender-auth-header" title="draft-kucherawy-sender-auth-header">draft-kucherawy-s...</a>] [<a href="http://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc5451" title="Inline diff (wdiff)">Diff1</a>] [<a href="http://tools.ietf.org/rfcdiff?url2=rfc5451" title="Side-by-side diff">Diff2</a>] [<a href="http://www.rfc-editor.org/errata_search.php?rfc=5451">Errata</a>]        </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">Obsoleted by: <a href="rfc7001.html">7001</a>                                     PROPOSED STANDARD</span><br/>
<span class="pre noprint docinfo">Updated by: <a href="rfc6577.html">6577</a>                                            <span style="color: #C00;">Errata Exist</span></span><br/>
<pre>Network Working Group                                       M. Kucherawy
Request for Comments: 5451                                Sendmail, Inc.
Category: Standards Track                                     April 2009


   <span class="h1">Message Header Field for Indicating Message Authentication Status</span>

Status of This Memo

   This document specifies an Internet standards track protocol for the
   Internet community, and requests discussion and suggestions for
   improvements.  Please refer to the current edition of the "Internet
   Official Protocol Standards" (STD 1) for the standardization state
   and status of this protocol.  Distribution of this memo is unlimited.

Copyright Notice

   Copyright (c) 2009 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="http://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents in effect on the date of
   publication of this document (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>).
   Please review these documents carefully, as they describe your rights
   and restrictions with respect to this document.

Abstract

   This memo defines a new header field for use with electronic mail
   messages to indicate the results of message authentication efforts.
   Any receiver-side software, such as mail filters or Mail User Agents
   (MUAs), may use this message header field to relay that information
   in a convenient way to users or to make sorting and filtering
   decisions.

















<span class="grey">Kucherawy                   Standards Track                     [Page 1]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc5451.html">RFC 5451</a>          Authentication-Results Header Field         April 2009</span>


Table of Contents

   <a href="#section-1">1</a>.  Introduction . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-3">3</a>
     <a href="#section-1.1">1.1</a>.  Purpose  . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-4">4</a>
     <a href="#section-1.2">1.2</a>.  Trust Boundary . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-4">4</a>
     <a href="#section-1.3">1.3</a>.  Processing Scope . . . . . . . . . . . . . . . . . . . . .  <a href="#page-5">5</a>
     <a href="#section-1.4">1.4</a>.  Requirements . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-5">5</a>
     <a href="#section-1.5">1.5</a>.  Definitions  . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-5">5</a>
       <a href="#section-1.5.1">1.5.1</a>.  General  . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-5">5</a>
       <a href="#section-1.5.2">1.5.2</a>.  Security . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-5">5</a>
       <a href="#section-1.5.3">1.5.3</a>.  Email Architecture . . . . . . . . . . . . . . . . . .  <a href="#page-6">6</a>
     <a href="#section-1.6">1.6</a>.  Trust Environment  . . . . . . . . . . . . . . . . . . . .  <a href="#page-7">7</a>
   <a href="#section-2">2</a>.  Definition and Format of the Header Field  . . . . . . . . . .  <a href="#page-8">8</a>
     <a href="#section-2.1">2.1</a>.  General Description  . . . . . . . . . . . . . . . . . . .  <a href="#page-8">8</a>
     <a href="#section-2.2">2.2</a>.  Formal Definition  . . . . . . . . . . . . . . . . . . . .  <a href="#page-8">8</a>
     <a href="#section-2.3">2.3</a>.  Authentication Identifier Field  . . . . . . . . . . . . . <a href="#page-10">10</a>
     <a href="#section-2.4">2.4</a>.  Result Values  . . . . . . . . . . . . . . . . . . . . . . <a href="#page-12">12</a>
       <a href="#section-2.4.1">2.4.1</a>.  DKIM and DomainKeys Results  . . . . . . . . . . . . . <a href="#page-12">12</a>
       <a href="#section-2.4.2">2.4.2</a>.  SPF and Sender-ID Results  . . . . . . . . . . . . . . <a href="#page-13">13</a>
       <a href="#section-2.4.3">2.4.3</a>.  "iprev" Results  . . . . . . . . . . . . . . . . . . . <a href="#page-14">14</a>
       <a href="#section-2.4.4">2.4.4</a>.  SMTP AUTH Results  . . . . . . . . . . . . . . . . . . <a href="#page-14">14</a>
       <a href="#section-2.4.5">2.4.5</a>.  Extension Result Codes . . . . . . . . . . . . . . . . <a href="#page-15">15</a>
     <a href="#section-2.5">2.5</a>.  Authentication Methods . . . . . . . . . . . . . . . . . . <a href="#page-15">15</a>
       <a href="#section-2.5.1">2.5.1</a>.  Definition of Initial Methods  . . . . . . . . . . . . <a href="#page-16">16</a>
       <a href="#section-2.5.2">2.5.2</a>.  Extension Methods  . . . . . . . . . . . . . . . . . . <a href="#page-16">16</a>
   <a href="#section-3">3</a>.  The "iprev" Authentication Method  . . . . . . . . . . . . . . <a href="#page-17">17</a>
   <a href="#section-4">4</a>.  Adding the Header Field to A Message . . . . . . . . . . . . . <a href="#page-18">18</a>
     <a href="#section-4.1">4.1</a>.  Header Field Position and Interpretation . . . . . . . . . <a href="#page-19">19</a>
     <a href="#section-4.2">4.2</a>.  Local Policy Enforcement . . . . . . . . . . . . . . . . . <a href="#page-20">20</a>
   <a href="#section-5">5</a>.  Removing the Header Field  . . . . . . . . . . . . . . . . . . <a href="#page-20">20</a>
   <a href="#section-6">6</a>.  IANA Considerations  . . . . . . . . . . . . . . . . . . . . . <a href="#page-22">22</a>
     <a href="#section-6.1">6.1</a>.  The Authentication-Results Header Field  . . . . . . . . . <a href="#page-22">22</a>
     <a href="#section-6.2">6.2</a>.  Email Authentication Method Name Registry  . . . . . . . . <a href="#page-22">22</a>
     <a href="#section-6.3">6.3</a>.  Email Authentication Result Name Registry  . . . . . . . . <a href="#page-24">24</a>
   <a href="#section-7">7</a>.  Security Considerations  . . . . . . . . . . . . . . . . . . . <a href="#page-26">26</a>
     <a href="#section-7.1">7.1</a>.  Forged Header Fields . . . . . . . . . . . . . . . . . . . <a href="#page-26">26</a>
     <a href="#section-7.2">7.2</a>.  Misleading Results . . . . . . . . . . . . . . . . . . . . <a href="#page-27">27</a>
     <a href="#section-7.3">7.3</a>.  Header Field Position  . . . . . . . . . . . . . . . . . . <a href="#page-28">28</a>
     <a href="#section-7.4">7.4</a>.  Reverse IP Query Denial-of-Service Attacks . . . . . . . . <a href="#page-28">28</a>
     <a href="#section-7.5">7.5</a>.  Mitigation of Backscatter  . . . . . . . . . . . . . . . . <a href="#page-28">28</a>
     <a href="#section-7.6">7.6</a>.  Internal MTA Lists . . . . . . . . . . . . . . . . . . . . <a href="#page-28">28</a>
     <a href="#section-7.7">7.7</a>.  Attacks against Authentication Methods . . . . . . . . . . <a href="#page-28">28</a>
     <a href="#section-7.8">7.8</a>.  Intentionally Malformed Header Fields  . . . . . . . . . . <a href="#page-29">29</a>
     <a href="#section-7.9">7.9</a>.  Compromised Internal Hosts . . . . . . . . . . . . . . . . <a href="#page-29">29</a>
     <a href="#section-7.10">7.10</a>. Encapsulated Instances . . . . . . . . . . . . . . . . . . <a href="#page-29">29</a>
     <a href="#section-7.11">7.11</a>. Reverse Mapping  . . . . . . . . . . . . . . . . . . . . . <a href="#page-29">29</a>





<span class="grey">Kucherawy                   Standards Track                     [Page 2]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc5451.html">RFC 5451</a>          Authentication-Results Header Field         April 2009</span>


   <a href="#section-8">8</a>.  References . . . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-30">30</a>
     <a href="#section-8.1">8.1</a>.  Normative References . . . . . . . . . . . . . . . . . . . <a href="#page-30">30</a>
     <a href="#section-8.2">8.2</a>.  Informative References . . . . . . . . . . . . . . . . . . <a href="#page-30">30</a>
   <a href="#appendix-A">Appendix A</a>.  Legacy MUAs . . . . . . . . . . . . . . . . . . . . . <a href="#page-32">32</a>
   <a href="#appendix-B">Appendix B</a>.  Authentication-Results Examples . . . . . . . . . . . <a href="#page-33">33</a>
     <a href="#appendix-B.1">B.1</a>.  Trivial Case; Header Field Not Present . . . . . . . . . . <a href="#page-33">33</a>
     B.2.  Nearly Trivial Case; Service Provided, But No
           Authentication Done  . . . . . . . . . . . . . . . . . . . <a href="#page-34">34</a>
     <a href="#appendix-B.3">B.3</a>.  Service Provided, Authentication Done  . . . . . . . . . . <a href="#page-35">35</a>
     B.4.  Service Provided, Several Authentications Done, Single
           MTA  . . . . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-36">36</a>
     B.5.  Service Provided, Several Authentications Done,
           Different MTAs . . . . . . . . . . . . . . . . . . . . . . <a href="#page-37">37</a>
     <a href="#appendix-B.6">B.6</a>.  Service Provided, Multi-Tiered Authentication Done . . . . <a href="#page-39">39</a>
   <a href="#appendix-C">Appendix C</a>.  Operational Considerations about Message
                Authentication  . . . . . . . . . . . . . . . . . . . <a href="#page-41">41</a>
   Acknowledgements . . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-43">43</a>

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   This memo defines a new header field for electronic mail messages
   that presents the results of a message authentication effort in a
   machine-readable format.  The intent is to create a place to collect
   such data when message authentication mechanisms are in use so that a
   Mail User Agent (MUA) and downstream filters can make filtering
   decisions and/or provide a recommendation to the user as to the
   validity of the message's origin and possibly the integrity of its
   content.

   End users are not expected to be direct consumers of this header
   field.  This header field is intended for consumption by programs
   that will then use or render such data in a human-usable form.

   This memo defines both the format of this new header field and
   discusses the implications of its presence or absence.  However, it
   does not discuss how the data contained in the header field should be
   used (i.e. what filtering decisions are appropriate, or how an MUA
   might render these results) as these are local policy and/or user
   interface design questions that are not appropriate for this memo.

   At the time of publication of this memo, [<a href="#ref-AUTH" title='"SMTP Service Extension for Authentication"'>AUTH</a>], [<a href="#ref-DKIM" title='"DomainKeys Identified Mail (DKIM) Signatures"'>DKIM</a>],
   [<a href="#ref-DOMAINKEYS" title='"Domain-Based Email Authentication Using Public Keys Advertised in the DNS (DomainKeys)"'>DOMAINKEYS</a>], [<a href="#ref-SENDERID" title='"Sender ID: Authenticating E-Mail"'>SENDERID</a>], and [<a href="#ref-SPF" title='"Sender Policy Framework (SPF) for Authorizing Use of Domains in E-Mail, Version 1"'>SPF</a>] are published DNS domain-level
   email authentication methods in common use.  This proposal is not
   intended to be restricted to domain-based authentication, but this
   has proven to be a good starting point for implementations.  As
   various methods emerge, it is necessary to prepare for their
   appearance and encourage convergence in the area of interfacing
   verifiers to filters and MUAs.



<span class="grey">Kucherawy                   Standards Track                     [Page 3]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc5451.html">RFC 5451</a>          Authentication-Results Header Field         April 2009</span>


   Although [<a href="#ref-SPF" title='"Sender Policy Framework (SPF) for Authorizing Use of Domains in E-Mail, Version 1"'>SPF</a>] defined a header field called Received-SPF and
   [<a href="#ref-DOMAINKEYS" title='"Domain-Based Email Authentication Using Public Keys Advertised in the DNS (DomainKeys)"'>DOMAINKEYS</a>] defined one called DomainKey-Status for this purpose,
   those header fields are specific to the conveyance of their
   respective results only and thus are insufficient to satisfy the
   requirements enumerated below.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.1.%20%20Purpose"></a><a class="selflink" href="#section-1.1" name="section-1.1">1.1</a>.  Purpose</span>

   The header field defined in this memo is expected to serve several
   purposes:

   1.  Convey the results of various message authentication checks being
       applied by upstream filters and Mail Transfer Agents (MTAs) to
       MUAs and downstream filters within the same "trust domain", as
       such agents may wish to render those results to end users or use
       that data to apply more or less stringent content checks based on
       authentication results;

   2.  Provide a common location within a message for this data;

   3.  Create an extensible framework for reporting new authentication
       methods as they emerge.

   In particular, the mere presence of this header field should not be
   construed as meaning that its data is valid, but rather that it is
   asserting validity based on one or more authentication schemes
   somewhere upstream.  For an MUA or downstream filter to treat the
   assertions as actually valid, there must be an assessment of the
   trust relationship between such agents and the validating MTA.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.2.%20%20Trust%20Boundary"></a><a class="selflink" href="#section-1.2" name="section-1.2">1.2</a>.  Trust Boundary</span>

   This document makes several references to the "trust boundary" of an
   administrative management domain (ADMD).  Given the diversity among
   existing mail environments, a precise definition of this term isn't
   possible.

   Simply put, a transfer from the creator of the header field to the
   consumer must occur within a context of trust that the creator's
   information is correct.  How this trust is obtained is outside the
   scope of this document.  It is entirely a local matter.

   Thus, this document defines a "trust boundary" as the delineation
   between "external" and "internal" entities; "external" here includes
   all hosts that do not deliberately provide some kind of messaging
   service for the receiving ADMD's users, and "internal" includes those
   hosts that do.  By this definition, the hosts within a "trust
   boundary" may lie entirely within a receiving ADMD's direct control,



<span class="grey">Kucherawy                   Standards Track                     [Page 4]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc5451.html">RFC 5451</a>          Authentication-Results Header Field         April 2009</span>


   or they can include hosts managed by another ADMD (such as an ISP or
   commercial filtering service) but that also provide services for the
   former.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.3.%20%20Processing%20Scope"></a><a class="selflink" href="#section-1.3" name="section-1.3">1.3</a>.  Processing Scope</span>

   This proposal is intended to address the needs of authenticating
   messages or properties of messages during their actual transport.  It
   is not meant to address the security of messages that might be
   encapsulated within other messages, such as a message/rfc822 [<a href="#ref-MIME" title='"Multipurpose Internet Mail Extensions (MIME) Part One: Format of Internet Message Bodies"'>MIME</a>]
   part within a message.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.4.%20%20Requirements"></a><a class="selflink" href="#section-1.4" name="section-1.4">1.4</a>.  Requirements</span>

   This memo establishes no new requirements on existing protocols or
   servers.

   In particular, this memo establishes no requirement on MTAs to reject
   or filter arriving messages that do not pass authentication checks.
   The data conveyed by the defined header field's contents are for the
   information of MUAs and filters and should be used at their
   discretion.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.5.%20%20Definitions"></a><a class="selflink" href="#section-1.5" name="section-1.5">1.5</a>.  Definitions</span>

   This section defines various terms used throughout this document.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/1.5.1.%20%20General"></a><a class="selflink" href="#section-1.5.1" name="section-1.5.1">1.5.1</a>.  General</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [<a href="#ref-KEYWORDS" title='"Key words for use in RFCs to Indicate Requirement Levels"'>KEYWORDS</a>].

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/1.5.2.%20%20Security"></a><a class="selflink" href="#section-1.5.2" name="section-1.5.2">1.5.2</a>.  Security</span>

   [<a id="ref-SECURITY" name="ref-SECURITY">SECURITY</a>] discusses authentication and authorization and the
   conflation of the two concepts.  The use of those terms within the
   context of recent message-security work has given rise to slightly
   different definitions, and this document reflects those current
   usages, as follows:

   o  "Authorization" is the establishment of permission to use a
      resource or represent an identity.  In this context, authorization
      indicates that a message from a particular ADMD arrived via a
      route the ADMD has explicitly approved.






<span class="grey">Kucherawy                   Standards Track                     [Page 5]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc5451.html">RFC 5451</a>          Authentication-Results Header Field         April 2009</span>


   o  "Authentication" is the assertion of validity of a piece of data
      about a message (such as the sender's identity) or the message in
      its entirety.

   As examples: [<a href="#ref-SPF" title='"Sender Policy Framework (SPF) for Authorizing Use of Domains in E-Mail, Version 1"'>SPF</a>] and [<a href="#ref-SENDERID" title='"Sender ID: Authenticating E-Mail"'>SENDERID</a>] are authorization mechanisms in
   that they express a result that shows whether or not the ADMD that
   apparently sent the message has explicitly authorized the connecting
   [<a href="#ref-SMTP" title='"Simple Mail Transfer Protocol"'>SMTP</a>] client to relay messages on its behalf but do not actually
   validate any property of the message itself.  By contrast, [<a href="#ref-DKIM" title='"DomainKeys Identified Mail (DKIM) Signatures"'>DKIM</a>] is
   agnostic as to the routing of a message but uses cryptographic
   signatures to authenticate agents claiming responsibility for the
   message (which implies authorization) and ensure it was not modified
   in transit.  Since the signatures are not tied to SMTP connections,
   they can be added by either the ADMD of origin, intermediate ADMDs
   (such as a mailing list server), or both.

   Rather than create a separate header field for each class of
   solution, this proposal groups them both into a single header field.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/1.5.3.%20%20Email%20Architecture"></a><a class="selflink" href="#section-1.5.3" name="section-1.5.3">1.5.3</a>.  Email Architecture</span>

   o  A "border MTA" is an MTA that acts as a gateway between the
      general Internet and the users within an organizational boundary.
      (See also <a href="#section-1.2">Section 1.2</a>.)

   o  A "delivery MTA" (or Mail Delivery Agent or MDA) is an MTA that
      actually enacts delivery of a message to a user's inbox or other
      final delivery.

   o  An "intermediate MTA" is an MTA that handles messages after a
      border MTA and before a delivery MTA.




















<span class="grey">Kucherawy                   Standards Track                     [Page 6]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc5451.html">RFC 5451</a>          Authentication-Results Header Field         April 2009</span>


   The following diagram illustrates the flow of mail among these
   defined components:

                          +-----+   +-----+   +------------+
                          | MUA |--&gt;| MSA |--&gt;| Border MTA |
                          +-----+   +-----+   +------------+
                                                    |
                                                    |
                                                    V
                                               +----------+
                                               | Internet |
                                               +----------+
                                                    |
                                                    |
                                                    V
   +-----+   +-----+   +------------------+   +------------+
   | MUA |&lt;--| MDA |&lt;--| Intermediate MTA |&lt;--| Border MTA |
   +-----+   +-----+   +------------------+   +------------+

   Generally, it is assumed that the work of applying message
   authentication schemes takes place at a border MTA or a delivery MTA.
   This specification is written with that assumption in mind.  However,
   there are some sites at which the entire mail infrastructure consists
   of a single host.  In such cases, such terms as "border MTA" and
   "delivery MTA" may well apply to the same machine or even the very
   same agent.  It is also possible that some message authentication
   tests could take place on an intermediate MTA.  Although this
   document doesn't specifically describe such cases, they are not meant
   to be excluded from this specification.

   See [<a href="#ref-EMAIL-ARCH" title='"Internet Mail Architecture"'>EMAIL-ARCH</a>] for further discussion on general email system
   architecture, and <a href="#appendix-C">Appendix C</a> of this memo for discussion about the
   common aspects of email authentication in current environments.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.6.%20%20Trust%20Environment"></a><a class="selflink" href="#section-1.6" name="section-1.6">1.6</a>.  Trust Environment</span>

   This new header field permits one or more message validation
   mechanisms to communicate its output to one or more separate
   assessment mechanisms.  These mechanisms operate within a unified
   trust boundary that defines an Administrative Management Domain
   (ADMD).  An ADMD contains one or more entities that perform
   validation and generate the header field, and one or more that
   consume it for some type of assessment.  The field contains no
   integrity or validation mechanism of its own, so its presence must be
   trusted implicitly.  Hence, use of the header field depends upon
   ensuring that mail entering the ADMD has instances of the header
   field claiming to be valid within its boundaries removed, so that
   occurrences of such header fields can be used safely by consumers.



<span class="grey">Kucherawy                   Standards Track                     [Page 7]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc5451.html">RFC 5451</a>          Authentication-Results Header Field         April 2009</span>


   The "authserv-id" token defined in <a href="#section-2.2">Section 2.2</a> can be used to label
   an entire ADMD or a specific validation engine within an ADMD.
   Although the labeling scheme is left as an operational choice, some
   guidance for selecting a token is provided within this proposal.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Definition%20and%20Format%20of%20the%20Header%20Field"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Definition and Format of the Header Field</span>

   This section gives a general overview of the format of the header
   field being defined, and then provides more formal specification.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.1.%20%20General%20Description"></a><a class="selflink" href="#section-2.1" name="section-2.1">2.1</a>.  General Description</span>

   The new header field being defined here is called "Authentication-
   Results".  It is a Structured Header Field as defined in [<a href="#ref-MAIL" title='"Internet Message Format"'>MAIL</a>] and
   thus all of the related definitions in that document apply.

   This new header field SHOULD be added at the top of the message as it
   transits MTAs that do authentication checks so some idea of how far
   away the checks were done can be inferred.  It therefore should be
   treated as a Trace Field as defined in [<a href="#ref-MAIL" title='"Internet Message Format"'>MAIL</a>], and thus all of the
   related definitions in that document apply.

   The value of the header field (after removing [<a href="#ref-MAIL" title='"Internet Message Format"'>MAIL</a>] comments)
   consists of an authentication identifier, an optional version, and
   then a series of "method=result" statements indicating which
   authentication method(s) were applied and their respective results,
   and then, for each applied method, an optional "reason" string plus
   optional "property=value" statements indicating which message
   properties were evaluated to reach that conclusion.

   The header field MAY appear more than once in a single message, or
   more than one result MAY be represented in a single header field, or
   a combination of these MAY be applied.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.2.%20%20Formal%20Definition"></a><a class="selflink" href="#section-2.2" name="section-2.2">2.2</a>.  Formal Definition</span>

   Formally, the header field is specified as follows using [<a href="#ref-ABNF" title='"Augmented BNF for Syntax Specifications: ABNF"'>ABNF</a>]:

     authres-header = "Authentication-Results:" [CFWS] authserv-id
              [ CFWS version ]
              ( [CFWS] ";" [CFWS] "none" / 1*resinfo ) [CFWS] CRLF
            ; the special case of "none" is used to indicate that no
            ; message authentication is performed

     authserv-id = dot-atom
                 ; see below for a description of this element





<span class="grey">Kucherawy                   Standards Track                     [Page 8]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc5451.html">RFC 5451</a>          Authentication-Results Header Field         April 2009</span>


     version = 1*DIGIT [CFWS]
             ; indicates which version of this specification is in use;
             ; this specification is version "1"; the absence of a
             ; version implies this version of the specification

     resinfo = [CFWS] ";" methodspec [ CFWS reasonspec ]
               *( CFWS propspec )

     methodspec = [CFWS] method [CFWS] "=" [CFWS] result
                ; indicates which authentication method was evaluated

     reasonspec = "reason" [CFWS] "=" [CFWS] value
                ; a free-form comment on the reason the given result
                ; was returned

     propspec = ptype [CFWS] "." [CFWS] property [CFWS] "=" pvalue
              ; an indication of which properties of the message
              ; were evaluated by the authentication scheme being
              ; applied to yield the reported result and would be
              ; useful to reveal to end users as authenticated

     method = dot-atom [ [CFWS] "/" [CFWS] version ]
            ; a method indicates which method's result is
            ; represented by "result", and is one of the methods
            ; explicitly defined as valid in this document
            ; or is an extension method as defined below

     result = dot-atom
            ; indicates the results of the attempt to authenticate
            ; the message; see below for details

     ptype = "smtp" / "header" / "body" / "policy"
           ; indicates whether the property being evaluated was
           ; a parameter to an [<a href="#ref-SMTP" title='"Simple Mail Transfer Protocol"'>SMTP</a>] command, or was a value taken
           ; from a message header field, or was some property of
           ; the message body, or some other property evaluated by
           ; the receiving MTA

     property = dot-atom
             ; if "ptype" is "smtp", this indicates which [<a href="#ref-SMTP" title='"Simple Mail Transfer Protocol"'>SMTP</a>]
             ; command provided the value that was evaluated by the
             ; authentication scheme being applied; if "ptype" is
             ; "header", this indicates from which header field the
             ; value being evaluated was extracted; if "ptype" is
             ; "body", this indicates the offset into the body at which
             ; content of interest was detected; if "ptype" is "policy"
             ; then this indicates the name of the policy that caused
             ; this header field to be added (see below)



<span class="grey">Kucherawy                   Standards Track                     [Page 9]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc5451.html">RFC 5451</a>          Authentication-Results Header Field         April 2009</span>


     pvalue = [CFWS] ( value / [ [ local-part ] "@" ] domain-name )
              [CFWS]
            ; the value extracted from the message property defined
            ; by the "ptype.property" construction; if the value
            ; identifies something intended to be an e-mail identity,
            ; then it MUST use the right hand portion of this ABNF
            ; definition

   The "local-part" is as defined in <a href="#section-3.4.1">Section 3.4.1</a>, and "dot-atom" is
   defined in <a href="#section-3.2.3">Section 3.2.3</a>, of [<a href="#ref-MAIL" title='"Internet Message Format"'>MAIL</a>].

   The "value" is as defined in Section 5.1 of [<a href="#ref-MIME" title='"Multipurpose Internet Mail Extensions (MIME) Part One: Format of Internet Message Bodies"'>MIME</a>].

   The "domain-name" is as defined in Section 3.5 of [<a href="#ref-DKIM" title='"DomainKeys Identified Mail (DKIM) Signatures"'>DKIM</a>].

   The "dot-atom" used in a "result" above is further constrained by the
   necessity of being enumerated in <a href="#section-2.4">Section 2.4</a> or an amendment to it.

   See <a href="#section-2.3">Section 2.3</a> for a description of the "authserv-id" element.

   The list of commands eligible for use with the "smtp" ptype can be
   found in [<a href="#ref-SMTP" title='"Simple Mail Transfer Protocol"'>SMTP</a>] and subsequent amendments.

   "CFWS" is as defined in Section 3.2.2 of [<a href="#ref-MAIL" title='"Internet Message Format"'>MAIL</a>].

   The "propspec" may be omitted if, for example, the method was unable
   to extract any properties to do its evaluation yet has a result to
   report.

   The "ptype" and "property" values used by each authentication method
   should be defined in the specification for that method (or its
   amendments).

   The "ptype" and "property" are case-insensitive.

   A "ptype" value of "policy" indicates a policy decision about the
   message not specific to a property of the message that could be
   extracted.  For example, if a method would normally report a
   "ptype.property" of "header.From" and no From: header field was
   present, the method can use "policy" to indicate that no conclusion
   about the authenticity of the message could be reached.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.3.%20%20Authentication%20Identifier%20Field"></a><a class="selflink" href="#section-2.3" name="section-2.3">2.3</a>.  Authentication Identifier Field</span>

   Every Authentication-Results header field has an authentication
   identifier field ("authserv-id" above).  This is similar in syntax to
   a fully-qualified domain name.




<span class="grey">Kucherawy                   Standards Track                    [Page 10]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc5451.html">RFC 5451</a>          Authentication-Results Header Field         April 2009</span>


   The authentication identifier field provides a unique identifier that
   refers to the authenticating service within a given ADMD.  The
   uniqueness of the identifier MUST be guaranteed by the ADMD that
   generates it and must pertain to exactly that one ADMD.  This
   identifier is intended to be machine-readable and not necessarily
   meaningful to users.  MUAs or downstream filters SHOULD use this
   identifier to determine whether or not the data contained in an
   Authentication-Results header field should be used.

   For simplicity and scalability, the authentication identifier SHOULD
   be a common token used throughout the ADMD, such as the DNS domain
   name used by or within that ADMD.

   For tracing and debugging purposes, the authentication identifier MAY
   instead be the hostname of the MTA performing the authentication
   check whose result is being reported.  This is also useful for
   another purpose, as described in <a href="#section-4">Section 4</a>.  Moreover, some
   implementations have considered appending a delimiter such as "/" and
   following it with useful transport tracing data such as the [<a href="#ref-SMTP" title='"Simple Mail Transfer Protocol"'>SMTP</a>]
   queue ID or a timestamp.

   It should be noted, however, that using a local, relative identifier
   like a single hostname, rather than a hierarchical and globally
   unique ADMD identifier like a DNS domain name, makes configuration
   more difficult for large sites.  The hierarchical identifier permits
   aggregating related, trusted systems together under a single, parent
   identifier, which in turn permits assessing the trust relationship
   with a single reference.  The alternative is a flat namespace
   requiring individually listing each trusted system.  Since consumers
   must use the identifier to determine whether to use the contents of
   the header field:

   o  Changes to the identifier impose a large, centralized
      administrative burden.

   o  Ongoing administrative changes require constantly updating this
      centralized table, making it difficult to ensure that an MUA or
      downstream filter will have access to accurate information for
      assessing the usability of the header field's content.  In
      particular, consumers of the header field will need to know not
      only the current identifier(s) in use, but previous ones as well
      to account for delivery latency or later re-assessment of the
      header field's contents.

   Examples of valid authentication identifiers are "example.com",
   "mail.example.org", "ms1.newyork.example.com", and "example-auth".





<span class="grey">Kucherawy                   Standards Track                    [Page 11]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc5451.html">RFC 5451</a>          Authentication-Results Header Field         April 2009</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.4.%20%20Result%20Values"></a><a class="selflink" href="#section-2.4" name="section-2.4">2.4</a>.  Result Values</span>

   Each individual authentication method returns one of a set of
   specific result values.  The subsections below define these results
   for the authentication methods specifically supported by this memo,
   and verifiers SHOULD use these values as described below.  New
   methods not specified in this document intended to be supported by
   the header field defined in this memo MUST include a similar result
   table either in its defining memo or in a supplementary one.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.4.1.%20%20DKIM%20and%20DomainKeys%20Results"></a><a class="selflink" href="#section-2.4.1" name="section-2.4.1">2.4.1</a>.  DKIM and DomainKeys Results</span>

   The result values used by [<a href="#ref-DKIM" title='"DomainKeys Identified Mail (DKIM) Signatures"'>DKIM</a>] and [<a href="#ref-DOMAINKEYS" title='"Domain-Based Email Authentication Using Public Keys Advertised in the DNS (DomainKeys)"'>DOMAINKEYS</a>] are as follows:

   none:  The message was not signed.

   pass:  The message was signed, the signature or signatures were
      acceptable to the verifier, and the signature(s) passed
      verification tests.

   fail:  The message was signed and the signature or signatures were
      acceptable to the verifier, but they failed the verification
      test(s).

   policy:  The message was signed but the signature or signatures were
      not acceptable to the verifier.

   neutral:  The message was signed but the signature or signatures
      contained syntax errors or were not otherwise able to be
      processed.  This result SHOULD also be used for other failures not
      covered elsewhere in this list.

   temperror:  The message could not be verified due to some error that
      is likely transient in nature, such as a temporary inability to
      retrieve a public key.  A later attempt may produce a final
      result.

   permerror:  The message could not be verified due to some error that
      is unrecoverable, such as a required header field being absent.  A
      later attempt is unlikely to produce a final result.

   A signature is "acceptable to the verifier" if it passes local policy
   checks (or there are no specific local policy checks).  For example,
   a verifier might require that the signature(s) on the message be
   added using the DNS domain present in the From: header field of the
   message, thus making third-party signatures unacceptable.





<span class="grey">Kucherawy                   Standards Track                    [Page 12]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc5451.html">RFC 5451</a>          Authentication-Results Header Field         April 2009</span>


   [<a id="ref-DKIM" name="ref-DKIM">DKIM</a>] advises that if a message fails verification, it should be
   treated as an unsigned message.  A report of "fail" here permits the
   receiver of the report to decide how to handle the failure.  A report
   of "neutral" or "none" preempts that choice, ensuring the message
   will be treated as if it had not been signed.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.4.2.%20%20SPF%20and%20Sender-ID%20Results"></a><a class="selflink" href="#section-2.4.2" name="section-2.4.2">2.4.2</a>.  SPF and Sender-ID Results</span>

   The result values are used by [<a href="#ref-SPF" title='"Sender Policy Framework (SPF) for Authorizing Use of Domains in E-Mail, Version 1"'>SPF</a>] and [<a href="#ref-SENDERID" title='"Sender ID: Authenticating E-Mail"'>SENDERID</a>] as follows:

   none:  No policy records were published at the sender's DNS domain.

   neutral:  The sender's ADMD has asserted that it cannot or does not
      want to assert whether or not the sending IP address is authorized
      to send mail using the sender's DNS domain.

   pass:  The client is authorized by the sender's ADMD to inject or
      relay mail on behalf of the sender's DNS domain.

   policy:  The client is authorized to inject or relay mail on behalf
      of the sender's DNS domain according to the authentication
      method's algorithm, but local policy dictates that the result is
      unacceptable.

   hardfail:  This client is explicitly not authorized to inject or
      relay mail using the sender's DNS domain.

   softfail:  The sender's ADMD believes the client was not authorized
      to inject or relay mail using the sender's DNS domain, but is
      unwilling to make a strong assertion to that effect.

   temperror:  The message could not be verified due to some error that
      is likely transient in nature, such as a temporary inability to
      retrieve a policy record from DNS.  A later attempt may produce a
      final result.

   permerror:  The message could not be verified due to some error that
      is unrecoverable, such as a required header field being absent or
      a syntax error in a retrieved DNS TXT record.  A later attempt is
      unlikely to produce a final result.

   The distinction between and interpretation of "none" and "neutral"
   under these methods is discussed further in [<a href="#ref-SPF" title='"Sender Policy Framework (SPF) for Authorizing Use of Domains in E-Mail, Version 1"'>SPF</a>].

   The "policy" result would be returned if, for example, [<a href="#ref-SPF" title='"Sender Policy Framework (SPF) for Authorizing Use of Domains in E-Mail, Version 1"'>SPF</a>] returned
   as "pass" result, but a local policy check matches the sending DNS
   domain to one found in an explicit list of unacceptable DNS domains
   (e.g., spammers).



<span class="grey">Kucherawy                   Standards Track                    [Page 13]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc5451.html">RFC 5451</a>          Authentication-Results Header Field         April 2009</span>


   If the retrieved sender policies used to evaluate [<a href="#ref-SPF" title='"Sender Policy Framework (SPF) for Authorizing Use of Domains in E-Mail, Version 1"'>SPF</a>] and
   [<a href="#ref-SENDERID" title='"Sender ID: Authenticating E-Mail"'>SENDERID</a>] do not contain explicit provisions for authenticating the
   local-part (see Section 3.4.1 of [<a href="#ref-MAIL" title='"Internet Message Format"'>MAIL</a>]) of an address, the "pvalue"
   reported along with results for these mechanisms SHOULD NOT include
   the local-part.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.4.3.%20%20%22iprev%22%20Results"></a><a class="selflink" href="#section-2.4.3" name="section-2.4.3">2.4.3</a>.  "iprev" Results</span>

   The result values are used by the "iprev" method, defined in
   <a href="#section-3">Section 3</a>, are as follows:

   pass:  The DNS evaluation succeeded, i.e., the "reverse" and
      "forward" lookup results were returned and were in agreement.

   fail:  The DNS evaluation failed.  In particular, the "reverse" and
      "forward" lookups each produced results but they were not in
      agreement, or the "forward" query completed but produced no
      result, e.g., a DNS RCODE of 3, commonly known as NXDOMAIN, or an
      RCODE of 0 (NOERROR) in a reply containing no answers, was
      returned.

   temperror:  The DNS evaluation could not be completed due to some
      error that is likely transient in nature, such as a temporary DNS
      error, e.g., a DNS RCODE of 2, commonly known as SERVFAIL, or
      other error condition resulted.  A later attempt may produce a
      final result.

   permerror:  The DNS evaluation could not be completed because no PTR
      data are published for the connecting IP address, e.g., a DNS
      RCODE of 3, commonly known as NXDOMAIN, or an RCODE of 0 (NOERROR)
      in a reply containing no answers, was returned.  This prevented
      completion of the evaluation.

   There is no "none" for this method since any TCP connection
   delivering email has an IP address associated with it, so some kind
   of evaluation will always be possible.

   For discussion of the format of DNS replies, see [<a href="#ref-DNS" title='"Domain names - implementation and specification"'>DNS</a>].

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.4.4.%20%20SMTP%20AUTH%20Results"></a><a class="selflink" href="#section-2.4.4" name="section-2.4.4">2.4.4</a>.  SMTP AUTH Results</span>

   The result values are used by the [<a href="#ref-AUTH" title='"SMTP Service Extension for Authentication"'>AUTH</a>] method are as follows:

   none:  SMTP authentication was not attempted.

   pass:  The SMTP client had authenticated to the server reporting the
      result using the protocol described in [<a href="#ref-AUTH" title='"SMTP Service Extension for Authentication"'>AUTH</a>].




<span class="grey">Kucherawy                   Standards Track                    [Page 14]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc5451.html">RFC 5451</a>          Authentication-Results Header Field         April 2009</span>


   fail:  The SMTP client had attempted to authenticate to the server
      using the protocol described in [<a href="#ref-AUTH" title='"SMTP Service Extension for Authentication"'>AUTH</a>] but was not successful, yet
      continued to send the message about which a result is being
      reported.

   temperror:  The SMTP client attempted to authenticate using the
      protocol described in [<a href="#ref-AUTH" title='"SMTP Service Extension for Authentication"'>AUTH</a>] but was not able to complete the
      attempt due to some error which is likely transient in nature,
      such as a temporary Lightweight Directory Access Protocol (LDAP)
      lookup error.  A later attempt may produce a final result.

   permerror:  The SMTP client attempted to authenticate using the
      protocol described in [<a href="#ref-AUTH" title='"SMTP Service Extension for Authentication"'>AUTH</a>] but was not able to complete the
      attempt due to some error that is likely not transient in nature,
      such as a permanent LDAP lookup error.  A later attempt is not
      likely produce a final result.

   Note that an agent making use of the data provided by this header
   field SHOULD consider "fail" and "temperror" to be the synonymous in
   terms of message authentication, i.e., the client did not
   authenticate.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.4.5.%20%20Extension%20Result%20Codes"></a><a class="selflink" href="#section-2.4.5" name="section-2.4.5">2.4.5</a>.  Extension Result Codes</span>

   Additional result codes (extension results) might be defined in the
   future by later revisions or extensions to this specification.
   Extension results beginning with "x-" will never be defined as
   standard fields; such names are reserved for experimental use.
   Result codes not beginning with "x-" MUST be registered with the
   Internet Assigned Numbers Authority (IANA) and published in an RFC.
   See <a href="#section-6">Section 6</a> for further details.

   Implementations reporting new result codes MUST use the "x-" prefix
   until such time as the new method is registered by IANA.

   Extension results MUST only be used within ADMDs that have explicitly
   consented to use them.  These results and the parameters associated
   with them are not documented in RFCs.  Therefore, they are subject to
   change at any time and not suitable for production use.  Any MTA, MUA
   or downstream filter intended for production use SHOULD ignore or
   delete any Authentication-Results header field that includes an
   extension result.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.5.%20%20Authentication%20Methods"></a><a class="selflink" href="#section-2.5" name="section-2.5">2.5</a>.  Authentication Methods</span>

   This section defines the supported authentication methods and
   discusses the proper means for applying experimental and other
   extension methods.



<span class="grey">Kucherawy                   Standards Track                    [Page 15]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-16" id="page-16" name="page-16"> </a>
<span class="grey"><a href="rfc5451.html">RFC 5451</a>          Authentication-Results Header Field         April 2009</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.5.1.%20%20Definition%20of%20Initial%20Methods"></a><a class="selflink" href="#section-2.5.1" name="section-2.5.1">2.5.1</a>.  Definition of Initial Methods</span>

   As they are currently existing specifications for message
   authentication, it is appropriate to define an authentication method
   identifier for each of [<a href="#ref-AUTH" title='"SMTP Service Extension for Authentication"'>AUTH</a>], [<a href="#ref-DKIM" title='"DomainKeys Identified Mail (DKIM) Signatures"'>DKIM</a>], [<a href="#ref-DOMAINKEYS" title='"Domain-Based Email Authentication Using Public Keys Advertised in the DNS (DomainKeys)"'>DOMAINKEYS</a>], [<a href="#ref-SENDERID" title='"Sender ID: Authenticating E-Mail"'>SENDERID</a>], and
   [<a href="#ref-SPF" title='"Sender Policy Framework (SPF) for Authorizing Use of Domains in E-Mail, Version 1"'>SPF</a>].  Therefore, the authentication method identifiers "auth",
   "dkim", "domainkeys", "sender-id", and "spf", respectively are hereby
   defined for MTAs applying those specifications for email message
   authentication.

   Furthermore, method "iprev" is defined in <a href="#section-3">Section 3</a>.

   See <a href="#section-6">Section 6</a> for details.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.5.2.%20%20Extension%20Methods"></a><a class="selflink" href="#section-2.5.2" name="section-2.5.2">2.5.2</a>.  Extension Methods</span>

   Additional authentication method identifiers (extension methods) may
   be defined in the future by later revisions or extensions to this
   specification.  Extension methods beginning with "x-" will never be
   defined as standard fields; such names are reserved for experimental
   use.  Method identifiers not beginning with "x-" MUST be registered
   with the Internet Assigned Numbers Authority (IANA) and published in
   an RFC.  See <a href="#section-6">Section 6</a> for further details.

   Extension methods may be defined for the following reasons:

   1.  To allow additional information from new authentication systems
       to be communicated to MUAs or downstream filters.  The names of
       such identifiers should reflect the name of the method being
       defined, but should not be needlessly long.

   2.  To allow the creation of "sub-identifiers" that indicate
       different levels of authentication and differentiate between
       their relative strengths, e.g., "auth1-weak" and "auth1-strong".

   Implementations of new methods MUST use the "x-" prefix until such
   time as the new method is registered by IANA.

   Authentication method implementors are encouraged to provide adequate
   information, via [<a href="#ref-MAIL" title='"Internet Message Format"'>MAIL</a>] comments if necessary, to allow an MUA
   developer to understand or relay ancillary details of authentication
   results.  For example, if it might be of interest to relay what data
   was used to perform an evaluation, such information could be relayed
   as a comment in the header field, such as:

        Authentication-Results: example.com;
                  foo=pass bar.baz=blob (2 of 3 tests OK)




<span class="grey">Kucherawy                   Standards Track                    [Page 16]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-17" id="page-17" name="page-17"> </a>
<span class="grey"><a href="rfc5451.html">RFC 5451</a>          Authentication-Results Header Field         April 2009</span>


   Experimental method identifiers MUST only be used within ADMDs that
   have explicitly consented to use them.  These method identifiers and
   the parameters associated with them are not documented in RFCs.
   Therefore, they are subject to change at any time and not suitable
   for production use.  Any MTA, MUA, or downstream filter intended for
   production use SHOULD ignore or delete any Authentication-Results
   header field that includes an experimental method identifier.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20The%20%22iprev%22%20Authentication%20Method"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  The "iprev" Authentication Method</span>

   This section defines an additional authentication method called
   "iprev".

   In general, "iprev" is an attempt to verify that a client appears to
   be valid based on some DNS queries.  Upon receiving a session
   initiation of some kind from a client, the IP address of the client
   peer is queried for matching names (i.e., a number-to-name
   translation, also known as a "reverse lookup" or a "PTR" record
   query).  Once that result is acquired, a lookup of each of the names
   (i.e., a name-to-number translation, or an "A" or "AAAA" record
   query) thus retrieved is done.  The response to this second check
   should result in at least one mapping back to the client's IP
   address.

   More algorithmically: if the client peer's IP address is I, the list
   of names to which I maps (after a "PTR" query) is the set N, and the
   union of IP addresses to which each member of N maps (after
   corresponding "A" and "AAAA" queries) is L, then this test is
   successful if I is an element of L.

   The response to a PTR query could contain multiple names.  To prevent
   heavy DNS loads, agents performing these queries MUST be implemented
   such that the number of names evaluated by generation of
   corresponding A or AAAA queries is finite, though it MAY be
   configurable by an administrator.  As an example, Section 5.5 of
   [<a href="#ref-SPF" title='"Sender Policy Framework (SPF) for Authorizing Use of Domains in E-Mail, Version 1"'>SPF</a>] chose a limit of 10 for its implementation of this algorithm.

   [<a id="ref-DNS-IP6" name="ref-DNS-IP6">DNS-IP6</a>] discusses the query formats for the IPv6 case.

   A successful test using this algorithm constitutes a result of "pass"
   since the ADMD in which the client's PTR claims it belongs has
   confirmed that claim by including corresponding data in its DNS
   domain.  A failure to match constitutes a "fail".  There is no case
   in which a "neutral" result can be returned.  The remaining
   "temperror" and "permerror" cases refer, respectively, to temporary
   and permanent DNS query errors.





<span class="grey">Kucherawy                   Standards Track                    [Page 17]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-18" id="page-18" name="page-18"> </a>
<span class="grey"><a href="rfc5451.html">RFC 5451</a>          Authentication-Results Header Field         April 2009</span>


   There is some contention regarding the wisdom and reliability of this
   test.  For example, in some regions it can be difficult for this test
   ever to pass because the practice of arranging to match the forward
   and reverse DNS is infrequently observed.  Therefore, the actual
   implementation details of how a verifier performs an "iprev" test are
   not specified here.  The verifier MAY report a successful or failed
   "iprev" test at its discretion having done some kind of check of the
   validity of the connection's identity using DNS.  It is incumbent
   upon an agent making use of the reported "iprev" result to understand
   what exactly that particular verifier is attempting to report.

   Extensive discussion of reverse DNS mapping and its implications can
   be found in [<a href="#ref-DNSOP-REVERSE" title='"Considerations for the use of DNS Reverse Mapping"'>DNSOP-REVERSE</a>].  In particular, it recommends that
   applications avoid using this test as a means of authentication or
   security.  Its presence in this memo is not an endorsement, but is
   merely acknowledgement that the method remains common and provides
   the means to relay the results of that test.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20Adding%20the%20Header%20Field%20to%20A%20Message"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  Adding the Header Field to A Message</span>

   This specification makes no attempt to evaluate the relative
   strengths of various message authentication methods that may become
   available.  As such, the order of the presented authentication
   methods and results MUST NOT be used either to imply or infer the
   importance or strength of any given method over another.  Instead,
   the MUA or downstream filter consuming this header field must
   interpret the result of each method based on its own knowledge of
   what that method evaluates.

   Each "method" MUST refer to an authentication method declared in the
   IANA registry, or an extension method as defined in <a href="#section-2.5.2">Section 2.5.2</a>,
   and each "result" MUST refer to a result code declared in the IANA
   registry, or an extension result code as defined in <a href="#section-2.4.5">Section 2.4.5</a>.
   See <a href="#section-6">Section 6</a> for further information about the registered methods
   and result codes.

   An MTA compliant with this specification MUST add this header field
   (after performing one or more message authentication tests) to
   indicate which MTA or ADMD performed the test, which test got applied
   and what the result was.  If an MTA applies more than one such test,
   it MUST add this header field either once per test, or once
   indicating all of the results.  An MTA MUST NOT add a result to an
   existing header field.

   An MTA MAY add this header field containing only the authentication
   identifier portion to indicate explicitly that no message
   authentication schemes were applied prior to delivery of this
   message.



<span class="grey">Kucherawy                   Standards Track                    [Page 18]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-19" id="page-19" name="page-19"> </a>
<span class="grey"><a href="rfc5451.html">RFC 5451</a>          Authentication-Results Header Field         April 2009</span>


   An MTA adding this header field must take steps to identify it as
   legitimate to the MUAs or downstream filters that will ultimately
   consume its content.  One required process to do so is described in
   <a href="#section-5">Section 5</a>.  Further measures may be required in some environments.
   Some possible solutions are enumerated in <a href="#section-7.1">Section 7.1</a>.  This memo
   does not mandate any specific solution to this issue as each
   environment has its own facilities and limitations.

   For MTAs that add this header field, adding header fields in order
   (at the top), per Section 3.6 of [<a href="#ref-MAIL" title='"Internet Message Format"'>MAIL</a>], is particularly important.
   Moreover, this header field SHOULD be inserted above any other trace
   header fields such MTAs might prepend.  This allows easy detection of
   header fields that can be trusted.

   End users making direct use of this header field may inadvertently
   trust information that has not been properly vetted.  If, for
   example, a basic [<a href="#ref-SPF" title='"Sender Policy Framework (SPF) for Authorizing Use of Domains in E-Mail, Version 1"'>SPF</a>] result were to be relayed that claims an
   authenticated addr-spec, the local-part of that addr-spec has
   actually not been authenticated.  Thus, an MTA adding this header
   field SHOULD NOT include any data that has not been authenticated by
   the method(s) being applied.  Moreover, MUAs SHOULD NOT render to
   users such information if it is presented by a method known not to
   authenticate it.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.1.%20%20Header%20Field%20Position%20and%20Interpretation"></a><a class="selflink" href="#section-4.1" name="section-4.1">4.1</a>.  Header Field Position and Interpretation</span>

   In order to ensure non-ambiguous results and avoid the impact of
   false header fields, MUAs and downstream filters SHOULD NOT interpret
   this header field unless specifically instructed to do so by the user
   or administrator.  That is, this interpretation should not be "on by
   default".  Naturally then, users or administrators should not
   activate such a feature unless they are certain the header field will
   be added by the border MTA that accepts the mail that is ultimately
   read by the MUA, and instances of the header field appearing to be
   from within the ADMD but actually added by foreign MTAs will be
   removed before delivery.

   Furthermore, MUAs and downstream filters SHOULD NOT interpret this
   header field unless the authentication identifier it bears appears to
   be one used within its own ADMD as configured by the user or
   administrator.

   MUAs and downstream filters MUST ignore any result reported using a
   "result" not specified in the result code registry, or a "ptype" not
   listed in the corresponding registry for such values as defined in
   <a href="#section-6">Section 6</a>.  Moreover, such agents MUST ignore a result indicated for
   any "method" they do not specifically support.




<span class="grey">Kucherawy                   Standards Track                    [Page 19]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-20" id="page-20" name="page-20"> </a>
<span class="grey"><a href="rfc5451.html">RFC 5451</a>          Authentication-Results Header Field         April 2009</span>


   An MUA SHOULD NOT reveal these results to end users unless the
   results are accompanied by, at a minimum, some associated reputation
   data about the authenticated origin identifiers within the message.
   For example, an attacker could register examp1e.com (note the digit
   "one") and send signed mail to intended victims; a verifier would
   detect that the signature was valid and report a "pass" even though
   it's clear the DNS domain name was intended to mislead.  See
   <a href="#section-7.2">Section 7.2</a> for further discussion.

   As stated in <a href="#section-2.1">Section 2.1</a>, this header field SHOULD be treated as
   though it were a trace header field as defined in Section 3.6.7 of
   [<a href="#ref-MAIL" title='"Internet Message Format"'>MAIL</a>], and hence MUST NOT be reordered and MUST be prepended to the
   message, so that there is generally some indication upon delivery of
   where in the chain of handling MTAs the message authentication was
   done.

   MUAs SHOULD ignore instances of this header field discovered within
   message/rfc822 [<a href="#ref-MIME" title='"Multipurpose Internet Mail Extensions (MIME) Part One: Format of Internet Message Bodies"'>MIME</a>] attachments.

   Further discussion of this can be found in <a href="#section-7">Section 7</a> below.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.2.%20%20Local%20Policy%20Enforcement"></a><a class="selflink" href="#section-4.2" name="section-4.2">4.2</a>.  Local Policy Enforcement</span>

   If a site's local policy is to consider a non-recoverable failure
   result (e.g., "fail" for DKIM, "hardfail" for SPF) for any particular
   authentication method as justification to reject the message
   completely, the border MTA SHOULD issue an [<a href="#ref-SMTP" title='"Simple Mail Transfer Protocol"'>SMTP</a>] rejection response
   to the message rather than adding this header field with the failure
   result and allowing it to proceed toward delivery.  This is more
   desirable than allowing the message to reach an internal host's MTA
   or spam filter, thus possibly generating a local rejection such as a
   [<a href="#ref-DSN" title='"An Extensible Message Format for Delivery Status Notifications"'>DSN</a>] to a forged originator.

   The same MAY also be done for local policy decisions overriding the
   results of the authentication methods (e.g., the "policy" result
   codes described in <a href="#section-2.4">Section 2.4</a>).

   Such rejections at the SMTP protocol level are not possible if local
   policy is enforced at the MUA and not the MTA.  Unfortunately, this
   may be a common scenario.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20Removing%20the%20Header%20Field"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  Removing the Header Field</span>

   For security reasons, any MTA conforming to this specification MUST
   delete any discovered instance of this header field that claims to
   have been added within its trust boundary and that did not come from
   another trusted MTA.  For example, an MTA (border or otherwise) for
   example.com receiving a message MUST delete any instance of this



<span class="grey">Kucherawy                   Standards Track                    [Page 20]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-21" id="page-21" name="page-21"> </a>
<span class="grey"><a href="rfc5451.html">RFC 5451</a>          Authentication-Results Header Field         April 2009</span>


   header field bearing an authentication identifier indicating the
   header field was added within example.com prior to adding its own
   header fields.  This may mean each MTA will have to be equipped with
   a list of internal MTAs known to be compliant (and hence
   trustworthy).

   For simplicity and maximum security, a border MTA MAY remove all
   instances of this header field on mail crossing into its trust
   boundary.  However, this may conflict with the desire to access
   authentication results performed by trusted external service
   providers.  It may also invalidate signed messages whose signatures
   cover external instances of this header field.  A more robust border
   MTA could allow a specific list of authenticating MTAs whose
   information should be let in, removing all others.

   As stated in <a href="#section-1.2">Section 1.2</a>, a formal definition of "trust boundary" is
   deliberately not made here.  It is entirely possible that a border
   MTA for example.com might explicitly trust authentication results
   asserted by upstream host example.net even though they exist in
   completely disjoint administrative boundaries.  In that case, the
   border MTA MAY elect not to delete those results; moreover, the
   upstream host doing some authentication work could apply a signing
   technology such as [<a href="#ref-DKIM" title='"DomainKeys Identified Mail (DKIM) Signatures"'>DKIM</a>] on its own results to assure downstream
   hosts of their authenticity.  An example of this is provided in
   <a href="#appendix-B">Appendix B</a>.

   Similarly, in the case of messages signed using [<a href="#ref-DKIM" title='"DomainKeys Identified Mail (DKIM) Signatures"'>DKIM</a>] or other
   message signing methods that sign header fields, this may invalidate
   one or more signatures on the message if they covered the header
   field to be removed at the time of signing.  This behavior can be
   desirable since there's little value in validating the signature on a
   message with forged headers.  However, signing agents MAY therefore
   elect to omit these header fields from signing to avoid this
   situation.

   An MTA SHOULD remove any instance of this header field bearing a
   version (express or implied) that it does not support.  However, an
   MTA MUST remove such a header if the [<a href="#ref-SMTP" title='"Simple Mail Transfer Protocol"'>SMTP</a>] connection relaying the
   message is not from a trusted internal MTA.












<span class="grey">Kucherawy                   Standards Track                    [Page 21]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-22" id="page-22" name="page-22"> </a>
<span class="grey"><a href="rfc5451.html">RFC 5451</a>          Authentication-Results Header Field         April 2009</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20IANA%20Considerations"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  IANA Considerations</span>

   IANA has registered a new header field and created two new tables as
   described below.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.1.%20%20The%20Authentication-Results%20Header%20Field"></a><a class="selflink" href="#section-6.1" name="section-6.1">6.1</a>.  The Authentication-Results Header Field</span>

   Per [<a href="#ref-IANA-HEADERS" title='"Registration Procedures for Message Header Fields"'>IANA-HEADERS</a>], the "Authentication-Results" header field has
   been added to the IANA Permanent Message Header Field Registry.  The
   following is the registration template:

     Header field name: Authentication-Results
     Applicable protocol: mail ([<a href="#ref-MAIL" title='"Internet Message Format"'>MAIL</a>])
     Status: Standard
     Author/Change controller: IETF
     Specification document(s): <a href="rfc5451.html">RFC 5451</a>
     Related information:
       Requesting review of any proposed changes and additions to
       this field is recommended.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.2.%20%20Email%20Authentication%20Method%20Name%20Registry"></a><a class="selflink" href="#section-6.2" name="section-6.2">6.2</a>.  Email Authentication Method Name Registry</span>

   Names of message authentication methods supported by this
   specification must be registered with IANA, with the exception of
   experimental names as described in <a href="#section-2.5.2">Section 2.5.2</a>.

   New entries are assigned only for values that have been documented in
   a published RFC that has had IETF Review, per [<a href="#ref-IANA-CONSIDERATIONS" title='"Guidelines for Writing an IANA Considerations Section in RFCs"'>IANA-CONSIDERATIONS</a>].
   Each method must register a name, the specification that defines it,
   one or more "ptype" values appropriate for use with that method,
   which "property" value(s) should be reported by that method, and a
   description of the "value" to be used with each.



















<span class="grey">Kucherawy                   Standards Track                    [Page 22]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-23" id="page-23" name="page-23"> </a>
<span class="grey"><a href="rfc5451.html">RFC 5451</a>          Authentication-Results Header Field         April 2009</span>


   The initial set of entries in this registry is as follows:

+------------+----------+--------+----------------+--------------------+
|   Method   | Defined  | ptype  | property       | value              |
+------------+----------+--------+----------------+--------------------+
|    auth    | <a href="rfc4954.html">RFC4954</a>  | smtp   | auth           | AUTH parameter of  |
|            |          |        |                | the SMTP MAIL      |
|            |          |        |                | command            |
+------------+----------+--------+----------------+--------------------+
|    dkim    | <a href="rfc4871.html">RFC4871</a>  | header | d              | value of           |
|            |          |        |                | signature "d" tag  |
|            |          |        +----------------+--------------------+
|            |          |        | i              | value of           |
|            |          |        |                | signature "i" tag  |
+------------+----------+--------+----------------+--------------------+
| domainkeys | <a href="rfc4870.html">RFC4870</a>  | header | d              | value of           |
|            |          |        |                | signature "d" tag  |
|            |          |        +----------------+--------------------+
|            |          |        | from           | value of From      |
|            |          |        |                | header field after |
|            |          |        |                | removing comments  |
|            |          |        |                | and local-part if  |
|            |          |        |                | not authenticated  |
|            |          |        +----------------+--------------------+
|            |          |        | sender         | value of Sender    |
|            |          |        |                | header field after |
|            |          |        |                | removing comments  |
|            |          |        |                | and local-part if  |
|            |          |        |                | not authenticated  |
+------------+----------+--------+----------------+--------------------+
|    iprev   | this     | policy | iprev          | client IP address  |
|            | document |        |                |                    |
+------------+----------+--------+----------------+--------------------+
|  sender-id | <a href="rfc4406.html">RFC4406</a>  | header | name of header | value of header    |
|            |          |        | field used by  | field used by PRA  |
|            |          |        | the Purported  | after removing     |
|            |          |        | Responsible    | comments and parts |
|            |          |        | Address (PRA)  | not authenticated  |
+------------+----------+--------+----------------+--------------------+
|     spf    | <a href="rfc4408.html">RFC4408</a>  | smtp   | mailfrom       | envelope sender    |
|            |          |        |                | after removing     |
|            |          |        |                | parts not          |
|            |          |        |                | authenticated      |
|            |          +--------+----------------+--------------------+
|            |          | smtp   | helo           | HELO/EHLO value    |
+------------+----------+--------+----------------+--------------------+





<span class="grey">Kucherawy                   Standards Track                    [Page 23]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-24" id="page-24" name="page-24"> </a>
<span class="grey"><a href="rfc5451.html">RFC 5451</a>          Authentication-Results Header Field         April 2009</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.3.%20%20Email%20Authentication%20Result%20Name%20Registry"></a><a class="selflink" href="#section-6.3" name="section-6.3">6.3</a>.  Email Authentication Result Name Registry</span>

   Names of message authentication result codes supported by this
   specification must be registered with IANA, with the exception of
   experimental codes as described in <a href="#section-2.4.5">Section 2.4.5</a>.

   New entries are assigned only for result codes that have been
   documented in a published RFC that has had IETF Review, per
   [<a href="#ref-IANA-CONSIDERATIONS" title='"Guidelines for Writing an IANA Considerations Section in RFCs"'>IANA-CONSIDERATIONS</a>].  Each code must register a name, the document
   that establishes the registration, the authentication method(s) that
   uses it, and either a definition of the semantics of its use or a
   reference to the place where those semantics are defined.

   The initial set of entries in this registry is as follows:

+-----------+----------+----------------+------------------------------+
|   Code    | Defined  | Auth Method(s) | Meaning                      |
+-----------+----------+----------------+------------------------------+
| none      | this     | dkim           | <a href="#section-2.4.1">section 2.4.1</a>                |
|           | document | domainkeys     |                              |
|           |          +----------------+------------------------------+
|           |          | spf            | <a href="#section-2.4.2">section 2.4.2</a>                |
|           |          | sender-id      |                              |
|           |          +----------------+------------------------------+
|           |          | auth           | <a href="#section-2.4.4">section 2.4.4</a>                |
+-----------+----------+----------------+------------------------------+
| pass      | this     | dkim           | <a href="#section-2.4.1">section 2.4.1</a>                |
|           | document | domainkeys     |                              |
|           |          +----------------+------------------------------+
|           |          | spf            | <a href="#section-2.4.2">section 2.4.2</a>                |
|           |          | sender-id      |                              |
|           |          +----------------+------------------------------+
|           |          | iprev          | <a href="#section-2.4.3">section 2.4.3</a>                |
|           |          +----------------+------------------------------+
|           |          | auth           | <a href="#section-2.4.4">section 2.4.4</a>                |
+-----------+----------+----------------+------------------------------+
| fail      | this     | dkim           | <a href="#section-2.4.1">section 2.4.1</a>                |
|           | document | domainkeys     |                              |
|           |          +----------------+------------------------------+
|           |          | iprev          | <a href="#section-2.4.3">section 2.4.3</a>                |
|           |          +----------------+------------------------------+
|           |          | auth           | <a href="#section-2.4.4">section 2.4.4</a>                |
+-----------+----------+----------------+------------------------------+








<span class="grey">Kucherawy                   Standards Track                    [Page 24]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-25" id="page-25" name="page-25"> </a>
<span class="grey"><a href="rfc5451.html">RFC 5451</a>          Authentication-Results Header Field         April 2009</span>


| policy    | this     | dkim           | <a href="#section-2.4.1">section 2.4.1</a>                |
|           | document | domainkeys     |                              |
|           |          +----------------+------------------------------+
|           |          | spf            | <a href="#section-2.4.2">section 2.4.2</a>                |
|           |          | sender-id      |                              |
+-----------+----------+----------------+------------------------------+
| neutral   | this     | dkim           | <a href="#section-2.4.1">section 2.4.1</a>                |
|           | document | domainkeys     |                              |
|           |          +----------------+------------------------------+
|           |          | spf            | <a href="#section-2.4.2">section 2.4.2</a>                |
|           |          | sender-id      |                              |
+-----------+----------+----------------+------------------------------+
| temperror | this     | dkim           | <a href="#section-2.4.1">section 2.4.1</a>                |
|           | document | domainkeys     |                              |
|           |          +----------------+------------------------------+
|           |          | spf            | <a href="#section-2.4.2">section 2.4.2</a>                |
|           |          | sender-id      |                              |
|           |          +----------------+------------------------------+
|           |          | iprev          | <a href="#section-2.4.3">section 2.4.3</a>                |
|           |          +----------------+------------------------------+
|           |          | auth           | <a href="#section-2.4.4">section 2.4.4</a>                |
+-----------+----------+----------------+------------------------------+
| permerror | this     | dkim           | <a href="#section-2.4.1">section 2.4.1</a>                |
|           | document | domainkeys     |                              |
|           |          +----------------+------------------------------+
|           |          | spf            | <a href="#section-2.4.2">section 2.4.2</a>                |
|           |          | sender-id      |                              |
|           |          +----------------+------------------------------+
|           |          | iprev          | <a href="#section-2.4.3">section 2.4.3</a>                |
|           |          +----------------+------------------------------+
|           |          | auth           | <a href="#section-2.4.4">section 2.4.4</a>                |
+-----------+----------+----------------+------------------------------+
| hardfail  | this     | spf            | <a href="#section-2.4.2">section 2.4.2</a>                |
|           | document | sender-id      |                              |
+-----------+----------+----------------+------------------------------+
| softfail  | this     | spf            | <a href="#section-2.4.2">section 2.4.2</a>                |
|           | document | sender-id      |                              |
+-----------+----------+----------------+------------------------------+













<span class="grey">Kucherawy                   Standards Track                    [Page 25]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-26" id="page-26" name="page-26"> </a>
<span class="grey"><a href="rfc5451.html">RFC 5451</a>          Authentication-Results Header Field         April 2009</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20Security%20Considerations"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  Security Considerations</span>

   The following security considerations apply when adding or processing
   the "Authentication-Results" header field:

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.1.%20%20Forged%20Header%20Fields"></a><a class="selflink" href="#section-7.1" name="section-7.1">7.1</a>.  Forged Header Fields</span>

   An MUA or filter that accesses a mailbox whose mail is handled by a
   non-conformant MTA, and understands Authentication-Results header
   fields, could potentially make false conclusions based on forged
   header fields.  A malicious user or agent could forge a header field
   using the DNS domain of a receiving ADMD as the authserv-id token in
   the value of the header field, and with the rest of the value claim
   that the message was properly authenticated.  The non-conformant MTA
   would fail to strip the forged header field, and the MUA could
   inappropriately trust it.

   It is for this reason an MUA should not have processing of the
   "Authentication-Results" header field enabled by default; instead it
   should be ignored, at least for the purposes of enacting filtering
   decisions, unless specifically enabled by the user or administrator
   after verifying that the border MTA is compliant.  It is acceptable
   to have an MUA aware of this specification, but have an explicit list
   of hostnames whose "Authentication-Results" header fields are
   trustworthy; however, this list should initially be empty.

   Proposed alternate solutions to this problem are nascent:

   1.  Possibly the simplest is a digital signature protecting the
       header field, such as using [<a href="#ref-DKIM" title='"DomainKeys Identified Mail (DKIM) Signatures"'>DKIM</a>], that can be verified by an
       MUA by using a posted public key.  Although one of the main
       purposes of this memo is to relieve the burden of doing message
       authentication work at the MUA, this only requires that the MUA
       learn a single authentication scheme even if a number of them are
       in use at the border MTA.  Note that [<a href="#ref-DKIM" title='"DomainKeys Identified Mail (DKIM) Signatures"'>DKIM</a>] requires that the
       From header field be signed, although in this application, the
       signing agent (a trusted MTA) likely cannot authenticate that
       value, so the fact that it is signed should be ignored.

   2.  Another would be a means to interrogate the MTA that added the
       header field to see if it is actually providing any message
       authentication services and saw the message in question, but this
       isn't especially palatable given the work required to craft and
       implement such a scheme.

   3.  Yet another might be a method to interrogate the internal MTAs
       that apparently handled the message (based on Received: header




<span class="grey">Kucherawy                   Standards Track                    [Page 26]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-27" id="page-27" name="page-27"> </a>
<span class="grey"><a href="rfc5451.html">RFC 5451</a>          Authentication-Results Header Field         April 2009</span>


       fields) to determine whether any of them conform to <a href="#section-5">Section 5</a> of
       this memo.  This, too, has potentially high barriers-to-entry.

   4.  Extensions to [<a href="#ref-IMAP" title='"INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1"'>IMAP</a>], [<a href="#ref-SMTP" title='"Simple Mail Transfer Protocol"'>SMTP</a>], and [<a href="#ref-POP3" title='"Post Office Protocol - Version 3"'>POP3</a>] could be defined to
       allow an MUA or filtering agent to acquire the "authserv-id" in
       use within an ADMD, thus allowing it to identify which
       Authentication-Results header fields it can trust.

   5.  On the presumption that internal MTAs are fully compliant with
       Section 3.6 of [<a href="#ref-MAIL" title='"Internet Message Format"'>MAIL</a>], and the compliant internal MTAs are using
       their own host names or the ADMD's DNS domain name as the
       "authserv-id" token, the header field proposed here should always
       appear above a Received: header added by a trusted MTA.  This can
       be used as a test for header field validity.

   Support for some of these is planned for future work.

   In any case, a mechanism needs to exist for an MUA or filter to
   verify that the host that appears to have added the header field (a)
   actually did so, and (b) is legitimately adding that header field for
   this delivery.  Given the variety of messaging environments deployed
   today, consensus appears to be that specifying a particular mechanism
   for doing so is not appropriate for this memo.

   Mitigation of the forged header field attack can also be accomplished
   by moving the authentication results data into meta-data associated
   with the message.  In particular, an [<a href="#ref-SMTP" title='"Simple Mail Transfer Protocol"'>SMTP</a>] extension could be
   established which is used to communicate authentication results from
   the border MTA to intermediate and delivery MTAs; the latter of these
   could arrange to store the authentication results as meta-data
   retrieved and rendered along with the message by an [<a href="#ref-IMAP" title='"INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1"'>IMAP</a>] client
   aware of a similar extension in that protocol.  The delivery MTA
   would be told to trust data via this extension only from MTAs it
   trusts, and border MTAs would not accept data via this extension from
   any source.  There is no vector in such an arrangement for forgery of
   authentication data by an outside agent.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.2.%20%20Misleading%20Results"></a><a class="selflink" href="#section-7.2" name="section-7.2">7.2</a>.  Misleading Results</span>

   Until some form of service for querying the reputation of a sending
   agent is widely deployed, the existence of this header field
   indicating a "pass" does not render the message trustworthy.  It is
   possible for an arriving piece of spam or other undesirable mail to
   pass checks by several of the methods enumerated above (e.g., a piece
   of spam signed using [<a href="#ref-DKIM" title='"DomainKeys Identified Mail (DKIM) Signatures"'>DKIM</a>] by the originator of the spam, which
   might be a spammer or a compromised system).  In particular, this
   issue is not resolved by forged header field removal discussed above.




<span class="grey">Kucherawy                   Standards Track                    [Page 27]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-28" id="page-28" name="page-28"> </a>
<span class="grey"><a href="rfc5451.html">RFC 5451</a>          Authentication-Results Header Field         April 2009</span>


   Hence, MUAs and downstream filters must take some care with use of
   this header even after possibly malicious headers are scrubbed.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.3.%20%20Header%20Field%20Position"></a><a class="selflink" href="#section-7.3" name="section-7.3">7.3</a>.  Header Field Position</span>

   Despite the requirements of [<a href="#ref-MAIL" title='"Internet Message Format"'>MAIL</a>], header fields can sometimes be
   reordered enroute by intermediate MTAs.  The goal of requiring header
   field addition only at the top of a message is an acknowledgement
   that some MTAs do reorder header fields, but most do not.  Thus, in
   the general case, there will be some indication of which MTAs (if
   any) handled the message after the addition of the header field
   defined here.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.4.%20%20Reverse%20IP%20Query%20Denial-of-Service%20Attacks"></a><a class="selflink" href="#section-7.4" name="section-7.4">7.4</a>.  Reverse IP Query Denial-of-Service Attacks</span>

   Section 5.5 of [<a href="#ref-SPF" title='"Sender Policy Framework (SPF) for Authorizing Use of Domains in E-Mail, Version 1"'>SPF</a>] describes a DNS-based denial-of-service attack
   for verifiers that attempt DNS-based identity verification of
   arriving client connections.  A verifier wishing to do this check and
   report this information SHOULD take care not to go to unbounded
   lengths to resolve "A" and "PTR" queries.  MUAs or other filters
   making use of an "iprev" result specified by this memo SHOULD be
   aware of the algorithm used by the verifier reporting the result and
   thus be aware of its limitations.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.5.%20%20Mitigation%20of%20Backscatter"></a><a class="selflink" href="#section-7.5" name="section-7.5">7.5</a>.  Mitigation of Backscatter</span>

   Failing to follow the instructions of <a href="#section-4.2">Section 4.2</a> can result in a
   denial-of-service attack caused by the generation of [<a href="#ref-DSN" title='"An Extensible Message Format for Delivery Status Notifications"'>DSN</a>] messages
   (or equivalent) to addresses that did not send the messages being
   rejected.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.6.%20%20Internal%20MTA%20Lists"></a><a class="selflink" href="#section-7.6" name="section-7.6">7.6</a>.  Internal MTA Lists</span>

   <a href="#section-5">Section 5</a> describes a procedure for scrubbing headers that may
   contain forged authentication results about a message.  A compliant
   installation will have to include, at each MTA, a list of other MTAs
   known to be compliant and trustworthy.  Failing to keep this list
   current as internal infrastructure changes may expose an ADMD to
   attack.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.7.%20%20Attacks%20against%20Authentication%20Methods"></a><a class="selflink" href="#section-7.7" name="section-7.7">7.7</a>.  Attacks against Authentication Methods</span>

   If an attack becomes known against an authentication method, clearly
   then the agent verifying that method can be fooled into thinking an
   inauthentic message is authentic, and thus the value of this header
   field can be misleading.  It follows that any attack against the
   authentication methods supported by this document (and later
   amendments to it) is also a security consideration here.



<span class="grey">Kucherawy                   Standards Track                    [Page 28]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-29" id="page-29" name="page-29"> </a>
<span class="grey"><a href="rfc5451.html">RFC 5451</a>          Authentication-Results Header Field         April 2009</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.8.%20%20Intentionally%20Malformed%20Header%20Fields"></a><a class="selflink" href="#section-7.8" name="section-7.8">7.8</a>.  Intentionally Malformed Header Fields</span>

   It is possible for an attacker to add an Authentication-Results
   header field that is extraordinarily large or otherwise malformed in
   an attempt to discover or exploit weaknesses in header field parsing
   code.  Implementors must thoroughly verify all such header fields
   received from MTAs and be robust against intentionally as well as
   unintentionally malformed header fields.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.9.%20%20Compromised%20Internal%20Hosts"></a><a class="selflink" href="#section-7.9" name="section-7.9">7.9</a>.  Compromised Internal Hosts</span>

   An internal MUA or MTA that has been compromised could generate mail
   with a forged From header field and a forged Authentication-Results
   header field that endorses it.  Although it is clearly a larger
   concern to have compromised internal machines than it is to prove the
   value of this header field, this risk can be mitigated by arranging
   that internal MTAs will remove this header field if it claims to have
   been added by a trusted border MTA (as described above), yet the
   [<a href="#ref-SMTP" title='"Simple Mail Transfer Protocol"'>SMTP</a>] connection is not coming from an internal machine known to be
   running an authorized MTA.  However, in such a configuration,
   legitimate MTAs will have to add this header field when legitimate
   internal-only messages are generated.  This is also covered in
   <a href="#section-5">Section 5</a>.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.10.%20%20Encapsulated%20Instances"></a><a class="selflink" href="#section-7.10" name="section-7.10">7.10</a>.  Encapsulated Instances</span>

   [<a id="ref-MIME" name="ref-MIME">MIME</a>] messages may contain attachments of type "message/rfc822",
   which contain other [<a href="#ref-MAIL" title='"Internet Message Format"'>MAIL</a>] messages.  Such an encapsulated message
   may also contain an Authentication-Results header field.  Although
   the processing of these is outside of the intended scope of this
   document (see <a href="#section-1.3">Section 1.3</a>), some early guidance to MUA developers is
   appropriate here.

   Since MTAs are unlikely to strip Authentication-Results header fields
   after mailbox delivery, MUAs are advised in <a href="#section-4.1">Section 4.1</a> to ignore
   such instances within [<a href="#ref-MIME" title='"Multipurpose Internet Mail Extensions (MIME) Part One: Format of Internet Message Bodies"'>MIME</a>] attachments.  Moreover, when extracting
   a message digest to separate mail store messages or other media, such
   header fields should be removed so that they will never be
   interpreted improperly by MUAs that might later consume them.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.11.%20%20Reverse%20Mapping"></a><a class="selflink" href="#section-7.11" name="section-7.11">7.11</a>.  Reverse Mapping</span>

   Although <a href="#section-3">Section 3</a> of this memo includes explicit support for the
   "iprev" method, its value as an authentication mechanism is limited.
   Implementors of both this proposal and agents that use the data it
   relays are encouraged to become familiar with the issues raised by
   [<a href="#ref-DNSOP-REVERSE" title='"Considerations for the use of DNS Reverse Mapping"'>DNSOP-REVERSE</a>] when deciding whether or not to include support for
   "iprev".



<span class="grey">Kucherawy                   Standards Track                    [Page 29]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-30" id="page-30" name="page-30"> </a>
<span class="grey"><a href="rfc5451.html">RFC 5451</a>          Authentication-Results Header Field         April 2009</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/8.%20%20References"></a><a class="selflink" href="#section-8" name="section-8">8</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/8.1.%20%20Normative%20References"></a><a class="selflink" href="#section-8.1" name="section-8.1">8.1</a>.  Normative References</span>

   [<a id="ref-ABNF" name="ref-ABNF">ABNF</a>]                 Crocker, D. and P. Overell, "Augmented BNF for
                          Syntax Specifications: ABNF", STD 68,
                          <a href="rfc5234.html">RFC 5234</a>, January 2008.

   [<a id="ref-IANA-HEADERS" name="ref-IANA-HEADERS">IANA-HEADERS</a>]         Klyne, G., Nottingham, M., and J. Mogul,
                          "Registration Procedures for Message Header
                          Fields", <a href="http://tools.ietf.org/html/bcp90">BCP 90</a>, <a href="rfc3864.html">RFC 3864</a>, September 2004.

   [<a id="ref-KEYWORDS" name="ref-KEYWORDS">KEYWORDS</a>]             Bradner, S., "Key words for use in RFCs to
                          Indicate Requirement Levels", <a href="http://tools.ietf.org/html/bcp14">BCP 14</a>,
                          <a href="rfc2119.html">RFC 2119</a>, March 1997.

   [<a id="ref-MAIL" name="ref-MAIL">MAIL</a>]                 Resnick, P., Ed., "Internet Message Format",
                          <a href="rfc5322.html">RFC 5322</a>, October 2008.

   [<a id="ref-MIME" name="ref-MIME">MIME</a>]                 Freed, N. and N. Borenstein, "Multipurpose
                          Internet Mail Extensions (MIME) Part One:
                          Format of Internet Message Bodies", <a href="rfc2045.html">RFC 2045</a>,
                          November 1996.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/8.2.%20%20Informative%20References"></a><a class="selflink" href="#section-8.2" name="section-8.2">8.2</a>.  Informative References</span>

   [<a id="ref-AUTH" name="ref-AUTH">AUTH</a>]                 Siemborski, R. and A. Melnikov, "SMTP Service
                          Extension for Authentication", <a href="rfc4954.html">RFC 4954</a>,
                          July 2007.

   [<a id="ref-DKIM" name="ref-DKIM">DKIM</a>]                 Allman, E., Callas, J., Delany, M., Libbey,
                          M., Fenton, J., and M. Thomas, "DomainKeys
                          Identified Mail (DKIM) Signatures", <a href="rfc4871.html">RFC 4871</a>,
                          May 2007.

   [<a id="ref-DNS" name="ref-DNS">DNS</a>]                  Mockapetris, P., "Domain names -
                          implementation and specification", STD 13,
                          <a href="rfc1035.html">RFC 1035</a>, November 1987.

   [<a id="ref-DNS-IP6" name="ref-DNS-IP6">DNS-IP6</a>]              Thomson, S., Huitema, C., Ksinant, V., and M.
                          Souissi, "DNS Extensions to Support IP Version
                          6", <a href="rfc3596.html">RFC 3596</a>, October 2003.

   [<a id="ref-DNSOP-REVERSE" name="ref-DNSOP-REVERSE">DNSOP-REVERSE</a>]        Senie, D. and A. Sullivan, "Considerations for
                          the use of DNS Reverse Mapping", Work
                          in Progress, March 2008.





<span class="grey">Kucherawy                   Standards Track                    [Page 30]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-31" id="page-31" name="page-31"> </a>
<span class="grey"><a href="rfc5451.html">RFC 5451</a>          Authentication-Results Header Field         April 2009</span>


   [<a id="ref-DOMAINKEYS" name="ref-DOMAINKEYS">DOMAINKEYS</a>]           Delany, M., "Domain-Based Email Authentication
                          Using Public Keys Advertised in the DNS
                          (DomainKeys)", <a href="rfc4870.html">RFC 4870</a>, May 2007.

   [<a id="ref-DSN" name="ref-DSN">DSN</a>]                  Moore, K. and G. Vaudreuil, "An Extensible
                          Message Format for Delivery Status
                          Notifications", <a href="rfc3464.html">RFC 3464</a>, January 2003.

   [<a id="ref-EMAIL-ARCH" name="ref-EMAIL-ARCH">EMAIL-ARCH</a>]           Crocker, D., <a href="http://www.google.com/search?sitesearch=tools.ietf.org%2Fhtml%2F&amp;q=inurl:draft-+%22Internet+Mail+Architecture%22" style="text-decoration: none">"Internet Mail Architecture"</a>,
                          Work in Progress, October 2008.

   [<a id="ref-IANA-CONSIDERATIONS" name="ref-IANA-CONSIDERATIONS">IANA-CONSIDERATIONS</a>]  Narten, T. and H. Alvestrand, "Guidelines for
                          Writing an IANA Considerations Section in
                          RFCs", <a href="http://tools.ietf.org/html/bcp26">BCP 26</a>, <a href="rfc5226.html">RFC 5226</a>, May 2008.

   [<a id="ref-IMAP" name="ref-IMAP">IMAP</a>]                 Crispin, M., "INTERNET MESSAGE ACCESS PROTOCOL
                          - VERSION 4rev1", <a href="rfc3501.html">RFC 3501</a>, March 2003.

   [<a id="ref-POP3" name="ref-POP3">POP3</a>]                 Myers, J. and M. Rose, "Post Office Protocol -
                          Version 3", STD 53, <a href="rfc1939.html">RFC 1939</a>, May 1996.

   [<a id="ref-SECURITY" name="ref-SECURITY">SECURITY</a>]             Rescorla, E. and B. Korver, "Guidelines for
                          Writing RFC Text on Security Considerations",
                          <a href="http://tools.ietf.org/html/bcp72">BCP 72</a>, <a href="rfc3552.html">RFC 3552</a>, July 2003.

   [<a id="ref-SENDERID" name="ref-SENDERID">SENDERID</a>]             Lyon, J. and M. Wong, "Sender ID:
                          Authenticating E-Mail", <a href="rfc4406.html">RFC 4406</a>, April 2006.

   [<a id="ref-SMTP" name="ref-SMTP">SMTP</a>]                 Klensin, J., "Simple Mail Transfer Protocol",
                          <a href="rfc5321.html">RFC 5321</a>, October 2008.

   [<a id="ref-SPF" name="ref-SPF">SPF</a>]                  Wong, M. and W. Schlitt, "Sender Policy
                          Framework (SPF) for Authorizing Use of Domains
                          in E-Mail, Version 1", <a href="rfc4408.html">RFC 4408</a>, April 2006.

















<span class="grey">Kucherawy                   Standards Track                    [Page 31]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-32" id="page-32" name="page-32"> </a>
<span class="grey"><a href="rfc5451.html">RFC 5451</a>          Authentication-Results Header Field         April 2009</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/Appendix%20A.%20%20Legacy%20MUAs"></a><a class="selflink" href="#appendix-A" name="appendix-A">Appendix A</a>.  Legacy MUAs</span>

   Implementors of this proposal should be aware that many MUAs are
   unlikely to be retrofitted to support the new header field and its
   semantics.  In the interests of convenience and quicker adoption, a
   delivery MTA might want to consider adding things that are processed
   by existing MUAs in addition to the Authentication-Results header
   field.  One suggestion is to include a Priority header field, on
   messages that don't already have such a header field, containing a
   value that reflects the strength of the authentication that was
   accomplished, e.g., "low" for weak or no authentication, "normal" or
   "high" for good or strong authentication.

   Some modern MUAs can already filter based on the content of this
   header field.  However, there is keen interest in having MUAs make
   some kind of graphical representation of this header field's meaning
   to end users.  Until this capability is added, other interim means of
   conveying authentication results may be necessary while this proposal
   and its successors are adopted.
































<span class="grey">Kucherawy                   Standards Track                    [Page 32]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-33" id="page-33" name="page-33"> </a>
<span class="grey"><a href="rfc5451.html">RFC 5451</a>          Authentication-Results Header Field         April 2009</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/Appendix%20B.%20%20Authentication-Results%20Examples"></a><a class="selflink" href="#appendix-B" name="appendix-B">Appendix B</a>.  Authentication-Results Examples</span>

   This section presents some examples of the use of this header field
   to indicate authentication results.

<span class="h1"><a class="selflink" href="#appendix-B.1" name="appendix-B.1">B.1</a>.  Trivial Case; Header Field Not Present</span>

   The trivial case:

        Received: from mail-router.example.com
                      (mail-router.example.com [192.0.2.1])
                  by server.example.org (8.11.6/8.11.6)
                      with ESMTP id g1G0r1kA003489;
                  Fri, Feb 15 2002 17:19:07 -0800
        From: sender@example.com
        Date: Fri, Feb 15 2002 16:54:30 -0800
        To: receiver@example.org
        Message-Id: &lt;12345.abc@example.com&gt;
        Subject: here's a sample

        Hello!  Goodbye!

   Example 1: Trivial case

   The "Authentication-Results" header field is completely absent.  The
   MUA may make no conclusion about the validity of the message.  This
   could be the case because the message authentication services were
   not available at the time of delivery, or no service is provided, or
   the MTA is not in compliance with this specification.






















<span class="grey">Kucherawy                   Standards Track                    [Page 33]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-34" id="page-34" name="page-34"> </a>
<span class="grey"><a href="rfc5451.html">RFC 5451</a>          Authentication-Results Header Field         April 2009</span>


<span class="h1"><a class="selflink" href="#appendix-B.2" name="appendix-B.2">B.2</a>.  Nearly Trivial Case; Service Provided, But No Authentication Done</span>

   A message that was delivered by an MTA that conforms to this
   specification but provides no actual message authentication service:

        Authentication-Results: example.org; none
        Received: from mail-router.example.com
                      (mail-router.example.com [192.0.2.1])
                  by server.example.org (8.11.6/8.11.6)
                      with ESMTP id g1G0r1kA003489;
                  Fri, Feb 15 2002 17:19:07 -0800
        From: sender@example.com
        Date: Fri, Feb 15 2002 16:54:30 -0800
        To: receiver@example.org
        Message-Id: &lt;12345.abc@example.com&gt;
        Subject: here's a sample

        Hello!  Goodbye!

   Example 2: Header present but no authentication done

   The "Authentication-Results" header field is present, showing that
   the delivering MTA conforms to this specification.  It used its DNS
   domain name as the authserv-id.  The presence of "none" (and the
   absence of any method and result tokens) indicates that no message
   authentication was done.

























<span class="grey">Kucherawy                   Standards Track                    [Page 34]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-35" id="page-35" name="page-35"> </a>
<span class="grey"><a href="rfc5451.html">RFC 5451</a>          Authentication-Results Header Field         April 2009</span>


<span class="h1"><a class="selflink" href="#appendix-B.3" name="appendix-B.3">B.3</a>.  Service Provided, Authentication Done</span>

   A message that was delivered by an MTA that conforms to this
   specification and applied some message authentication:

        Authentication-Results: example.com;
                  spf=pass smtp.mailfrom=example.net
        Received: from dialup-1-2-3-4.example.net
                      (dialup-1-2-3-4.example.net [192.0.2.200])
                  by mail-router.example.com (8.11.6/8.11.6)
                      with ESMTP id g1G0r1kA003489;
                  Fri, Feb 15 2002 17:19:07 -0800
        From: sender@example.net
        Date: Fri, Feb 15 2002 16:54:30 -0800
        To: receiver@example.com
        Message-Id: &lt;12345.abc@example.net&gt;
        Subject: here's a sample

        Hello!  Goodbye!

   Example 3: Header reporting results

   The "Authentication-Results" header field is present, indicating that
   the border MTA conforms to this specification.  The authserv-id is
   once again the DNS domain name.  Furthermore, the message was
   authenticated by that MTA via the method specified in [<a href="#ref-SPF" title='"Sender Policy Framework (SPF) for Authorizing Use of Domains in E-Mail, Version 1"'>SPF</a>].  Note
   that since that method cannot authenticate the local-part, it has
   been omitted from the result's value.  The MUA could extract and
   relay this extra information if desired.






















<span class="grey">Kucherawy                   Standards Track                    [Page 35]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-36" id="page-36" name="page-36"> </a>
<span class="grey"><a href="rfc5451.html">RFC 5451</a>          Authentication-Results Header Field         April 2009</span>


<span class="h1"><a class="selflink" href="#appendix-B.4" name="appendix-B.4">B.4</a>.  Service Provided, Several Authentications Done, Single MTA</span>

   A message that was relayed inbound via a single MTA that conforms to
   this specification and applied three different message authentication
   checks:

        Authentication-Results: example.com;
                  auth=pass (cram-md5) smtp.auth=sender@example.com;
                  spf=pass smtp.mailfrom=example.com
        Authentication-Results: example.com;
                  sender-id=pass header.from=example.com
        Received: from dialup-1-2-3-4.example.net (8.11.6/8.11.6)
                      (dialup-1-2-3-4.example.net [192.0.2.200])
                  by mail-router.example.com (8.11.6/8.11.6)
                      with ESMTP id g1G0r1kA003489;
                  Fri, Feb 15 2002 17:19:07 -0800
        Date: Fri, Feb 15 2002 16:54:30 -0800
        To: receiver@example.net
        From: sender@example.com
        Message-Id: &lt;12345.abc@example.com&gt;
        Subject: here's a sample

        Hello!  Goodbye!

   Example 4: Headers reporting results from one MTA

   The "Authentication-Results" header field is present, indicating the
   delivering MTA conforms to this specification.  Once again, the
   receiving DNS domain name is used as the authserv-id.  Furthermore,
   the sender authenticated herself/himself to the MTA via a method
   specified in [<a href="#ref-AUTH" title='"SMTP Service Extension for Authentication"'>AUTH</a>], and both [<a href="#ref-SPF" title='"Sender Policy Framework (SPF) for Authorizing Use of Domains in E-Mail, Version 1"'>SPF</a>] and [<a href="#ref-SENDERID" title='"Sender ID: Authenticating E-Mail"'>SENDERID</a>] checks were done
   and passed.  The MUA could extract and relay this extra information
   if desired.

   Two "Authentication-Results" header fields are not required since the
   same host did all of the checking.  The authenticating agent could
   have consolidated all the results into one header field.

   This example illustrates a scenario in which a remote user on a
   dialup connection (example.net) sends mail to a border MTA
   (example.com) using SMTP authentication to prove identity.  The
   dialup provider has been explicitly authorized to relay mail as
   "example.com" resulting in passes by the SPF and SenderID checks.








<span class="grey">Kucherawy                   Standards Track                    [Page 36]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-37" id="page-37" name="page-37"> </a>
<span class="grey"><a href="rfc5451.html">RFC 5451</a>          Authentication-Results Header Field         April 2009</span>


<span class="h1"><a class="selflink" href="#appendix-B.5" name="appendix-B.5">B.5</a>.  Service Provided, Several Authentications Done, Different MTAs</span>

   A message that was relayed inbound by two different MTAs that conform
   to this specification and applied multiple message authentication
   checks:

        Authentication-Results: example.com;
                  sender-id=hardfail header.from=example.com;
                  dkim=pass (good signature) header.i=sender@example.com
        Received: from mail-router.example.com
                      (mail-router.example.com [192.0.2.1])
                  by auth-checker.example.com (8.11.6/8.11.6)
                      with ESMTP id i7PK0sH7021929;
                  Fri, Feb 15 2002 17:19:22 -0800
        Authentication-Results: example.com;
                  auth=pass (cram-md5) smtp.auth=sender@example.com;
                  spf=hardfail smtp.mailfrom=example.com
        Received: from dialup-1-2-3-4.example.net
                      (dialup-1-2-3-4.example.net [192.0.2.200])
                  by mail-router.example.com (8.11.6/8.11.6)
                      with ESMTP id g1G0r1kA003489;
                  Fri, Feb 15 2002 17:19:07 -0800
        DKIM-Signature:  v=1; a=rsa-sha256; s=gatsby; d=example.com;
                  i=sender@example.com; t=1188964191; c=simple/simple;
                  h=From:Date:To:Message-Id:Subject;
                  bh=sEuZGD/pSr7ANysbY3jtdaQ3Xv9xPQtS0m70;
                  b=EToRSuvUfQVP3Bkz ... rTB0t0gYnBVCM=
        From: sender@example.com
        Date: Fri, Feb 15 2002 16:54:30 -0800
        To: receiver@example.com
        Message-Id: &lt;12345.abc@example.com&gt;
        Subject: here's a sample

        Hello!  Goodbye!

   Example 5: Headers reporting results from multiple MTAs

   The "Authentication-Results" header field is present, indicating
   conformance to this specification.  Once again, the authserv-id used
   is the recipient's DNS domain name.  The header field is present
   twice because two different MTAs in the chain of delivery did
   authentication tests.  The first, "mail-router.example.com" reports
   that [<a href="#ref-AUTH" title='"SMTP Service Extension for Authentication"'>AUTH</a>] and [<a href="#ref-SPF" title='"Sender Policy Framework (SPF) for Authorizing Use of Domains in E-Mail, Version 1"'>SPF</a>] were both used, and [<a href="#ref-AUTH" title='"SMTP Service Extension for Authentication"'>AUTH</a>] passed but [<a href="#ref-SPF" title='"Sender Policy Framework (SPF) for Authorizing Use of Domains in E-Mail, Version 1"'>SPF</a>]
   failed.  In the [<a href="#ref-AUTH" title='"SMTP Service Extension for Authentication"'>AUTH</a>] case, additional data is provided in the
   comment field, which the MUA can choose to render if desired.






<span class="grey">Kucherawy                   Standards Track                    [Page 37]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-38" id="page-38" name="page-38"> </a>
<span class="grey"><a href="rfc5451.html">RFC 5451</a>          Authentication-Results Header Field         April 2009</span>


   The second MTA, "auth-checker.example.com", reports that it did a
   [<a href="#ref-SENDERID" title='"Sender ID: Authenticating E-Mail"'>SENDERID</a>] test (which failed) and a [<a href="#ref-DKIM" title='"DomainKeys Identified Mail (DKIM) Signatures"'>DKIM</a>] test (which passed).
   Again, additional data about one of the tests is provided as a
   comment, which the MUA may choose to render.

   Since different hosts did the two sets of authentication checks, the
   header fields cannot be consolidated in this example.

   This example illustrates more typical transmission of mail into
   "example.com" from a user on a dialup connection "example.net".  The
   user appears to be legitimate as he/she had a valid password allowing
   authentication at the border MTA using [<a href="#ref-AUTH" title='"SMTP Service Extension for Authentication"'>AUTH</a>].  The [<a href="#ref-SPF" title='"Sender Policy Framework (SPF) for Authorizing Use of Domains in E-Mail, Version 1"'>SPF</a>] and
   [<a href="#ref-SENDERID" title='"Sender ID: Authenticating E-Mail"'>SENDERID</a>] tests failed since "example.com" has not granted
   "example.net" authority to relay mail on its behalf.  However, the
   [<a href="#ref-DKIM" title='"DomainKeys Identified Mail (DKIM) Signatures"'>DKIM</a>] test passed because the sending user had a private key
   matching one of "example.com"'s published public keys and used it to
   sign the message.


































<span class="grey">Kucherawy                   Standards Track                    [Page 38]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-39" id="page-39" name="page-39"> </a>
<span class="grey"><a href="rfc5451.html">RFC 5451</a>          Authentication-Results Header Field         April 2009</span>


<span class="h1"><a class="selflink" href="#appendix-B.6" name="appendix-B.6">B.6</a>.  Service Provided, Multi-Tiered Authentication Done</span>

   A message that had authentication done at various stages, one of
   which was outside the receiving ADMD:

     Authentication-Results: example.com;
           dkim=pass (good signature) header.i=@mail-router.example.net;
           dkim=fail (bad signature) header.i=@newyork.example.com
     Received: from mail-router.example.net
               (mail-router.example.net [192.0.2.250])
           by chicago.example.com (8.11.6/8.11.6)
               for &lt;recipient@chicago.example.com&gt;
               with ESMTP id i7PK0sH7021929;
           Fri, Feb 15 2002 17:19:22 -0800
     DKIM-Signature: v=1; a=rsa-sha256; s=furble;
           d=mail-router.example.net; t=1188964198; c=relaxed/simple;
           h=From:Date:To:Message-Id:Subject:Authentication-Results;
           bh=ftA9J6GtX8OpwUECzHnCkRzKw1uk6FNiLfJl5Nmv49E=;
           b=oINEO8hgn/gnunsg ... 9n9ODSNFSDij3=
     Authentication-Results: example.net;
           dkim=pass (good signature) header.i=@newyork.example.com
     Received: from smtp.newyork.example.com
               (smtp.newyork.example.com [192.0.2.220])
           by mail-router.example.net (8.11.6/8.11.6)
               with ESMTP id g1G0r1kA003489;
           Fri, Feb 15 2002 17:19:07 -0800
     DKIM-Signature: v=1; a=rsa-sha256; s=gatsby; d=newyork.example.com;
           t=1188964191; c=simple/simple;
           h=From:Date:To:Message-Id:Subject;
           bh=sEu28nfs9fuZGD/pSr7ANysbY3jtdaQ3Xv9xPQtS0m7=;
           b=EToRSuvUfQVP3Bkz ... rTB0t0gYnBVCM=
     From: sender@newyork.example.com
     Date: Fri, Feb 15 2002 16:54:30 -0800
     To: meetings@example.net
     Message-Id: &lt;12345.abc@newyork.example.com&gt;
     Subject: here's a sample

   Example 6: Headers reporting results from multiple MTAs in different
   ADMDs

   In this example we see multi-tiered authentication with an extended
   trust boundary.

   The message was sent from someone at example.com's New York office
   (newyork.example.com) to a mailing list managed at an intermediary.
   The message was signed at the origin using [<a href="#ref-DKIM" title='"DomainKeys Identified Mail (DKIM) Signatures"'>DKIM</a>].





<span class="grey">Kucherawy                   Standards Track                    [Page 39]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-40" id="page-40" name="page-40"> </a>
<span class="grey"><a href="rfc5451.html">RFC 5451</a>          Authentication-Results Header Field         April 2009</span>


   The message was sent to a mailing list service provider called
   example.net, which is used by example.com.  There,
   meetings@example.net is expanded to a long list of recipients, one of
   that is at the Chicago office.  In this example, we will assume that
   the trust boundary for chicago.example.com includes the mailing list
   server at example.net.

   The mailing list server there first authenticated the message and
   affixed an Authentication-Results header field indicating such using
   its DNS domain name for the authserv-id.  It then altered the message
   by affixing some footer text to the body, including some
   administrivia such as unsubscription instructions.  Finally, the
   mailing list server affixes a second [<a href="#ref-DKIM" title='"DomainKeys Identified Mail (DKIM) Signatures"'>DKIM</a>] signature and begins
   distribution of the message.

   The border MTA for chicago.example.com explicitly trusts results from
   mail-router.example.net so that header field is not removed.  It
   performs evaluation of both signatures and determines that the first
   (most recent) is a "pass" but, because of the aforementioned
   modifications, the second is a "fail".  However, the first signature
   included the Authentication-Results header added at mail-
   router.example.net that validated the second signature.  Thus,
   indirectly, it can be determined that the authentications claimed by
   both signatures are indeed valid.



























<span class="grey">Kucherawy                   Standards Track                    [Page 40]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-41" id="page-41" name="page-41"> </a>
<span class="grey"><a href="rfc5451.html">RFC 5451</a>          Authentication-Results Header Field         April 2009</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/Appendix%20C.%20%20Operational%20Considerations%20about%20Message%20Authentication"></a><a class="selflink" href="#appendix-C" name="appendix-C">Appendix C</a>.  Operational Considerations about Message Authentication</span>

   This proposal is predicated on the idea that authentication (and
   presumably in the future, reputation) work is typically done by
   border MTAs rather than MUAs or intermediate MTAs; the latter merely
   make use of the results determined by the former.  Certainly this is
   not mandatory for participation in electronic mail or message
   authentication, but the work of this proposal and its deployment to
   date is based on that model.  The assumption satisfies several common
   ADMD requirements:

   1.  Service operators prefer to resolve the handling of problem
       messages as close to the border of the ADMD as possible.  This
       enables, for example, rejections of messages at the SMTP level
       rather than generating a DSN internally.  Thus, doing any of the
       authentication or reputation work exclusively at the MUA or
       intermediate MTA renders this desire unattainable.

   2.  Border MTAs are more likely to have direct access to external
       sources of authentication or reputation information since modern
       MUAs are more likely to be heavily firewalled.  Thus, some MUAs
       might not even be able to complete the task of performing
       authentication or reputation evaluations without complex proxy
       configurations or similar burdens.

   3.  MUAs rely upon the upstream MTAs within their trust boundaries to
       make correct (as much as that is possible) evaluations about the
       message's envelope, header and content.  Thus, MUAs don't need to
       know how to do the work that upstream MTAs do; they only need the
       results of that work.

   4.  Evaluations about the quality of a message, from simple token
       matching (e.g., a list of preferred DNS domains) to cryptanalysis
       (e.g., public/private key work), are at least a little bit
       expensive and thus should be minimized.  To that end, performing
       those tests at the border MTA is far preferred to doing that work
       at each MUA that handles a message.  If an ADMD's environment
       adheres to common messaging protocols, a reputation query or an
       authentication check performed by a border MTA would return the
       same result as the same query performed by an MUA.  By contrast,
       in an environment where the MUA does the work, a message arriving
       for multiple recipients would thus cause authentication or
       reputation evaluation to be done more than once for the same
       message (i.e., at each MUA) causing needless amplification of
       resource use and creating a possible denial-of-service attack
       vector.





<span class="grey">Kucherawy                   Standards Track                    [Page 41]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-42" id="page-42" name="page-42"> </a>
<span class="grey"><a href="rfc5451.html">RFC 5451</a>          Authentication-Results Header Field         April 2009</span>


   5.  Minimizing change is good.  As new authentication and reputation
       methods emerge, the list of methods supported by this header
       field would presumably be extended.  If MUAs simply consume the
       contents of this header field rather than actually attempting to
       do authentication and/or reputation work, then MUAs only need to
       learn to parse this header field once; emergence of new methods
       requires only a configuration change at the MUAs and software
       changes at the MTAs (which are presumably fewer in number).  When
       choosing to implement these functions in MTAs vs MUAs, the issues
       of individual flexibility, infrastructure inertia and scale of
       effort must be considered.  It is typically easier to change a
       single MUA than an MTA because the modification affects fewer
       users and can be pursued with less care.  However, changing many
       MUAs is more effort than changing a smaller number of MTAs.

   6.  For decisions affecting message delivery and display, assessment
       based on authentication and reputation is best performed close to
       the time of message transit, as a message makes its journey
       toward a user's inbox, not afterwards.  DKIM keys and IP address
       reputations, etc., can change over time or even become invalid,
       and users can take a long time to read a message once delivered.
       The value of this work thus degrades, perhaps quickly, once the
       delivery process has completed.  This seriously diminishes the
       value of this work when done other than at MTAs.

   Many operational choices are possible within an ADMD, including the
   venue for performing authentication and/or reputation assessment.
   The current specification does not dictate any of those choices.
   Rather, it facilitates those cases in which information produced by
   one stage of analysis needs to be transported with the message to the
   next stage.




















<span class="grey">Kucherawy                   Standards Track                    [Page 42]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-43" id="page-43" name="page-43"> </a>
<span class="grey"><a href="rfc5451.html">RFC 5451</a>          Authentication-Results Header Field         April 2009</span>


Acknowledgements

   The author wishes to acknowledge the following for their review and
   constructive criticism of this proposal: Eric Allman, Mark Delany,
   Victor Duchovni, Frank Ellermann, Jim Fenton, Philip Guenther, Tony
   Hansen, Paul Hoffman, Scott Kitterman, Eliot Lear, John Levine, Miles
   Libbey, Charles Lindsey, Alexey Melnikov, Douglas Otis, Juan Altmayer
   Pizzorno, Michael Thomas, and Kazu Yamamoto.

   Special thanks to Dave Crocker and S. Moonesamy for their logistical
   support, and feedback on and contributions to the numerous proposed
   edits throughout the lifetime of this work.

Author's Address

   Murray S. Kucherawy
   Sendmail, Inc.
   6475 Christie Ave., Suite 350
   Emeryville, CA  94608
   US

   Phone: +1 510 594 5400
   EMail: msk+ietf@sendmail.com




























Kucherawy                   Standards Track                    [Page 43]

</pre><br/>
<span class="noprint"><small><small>Html markup produced by rfcmarkup 1.107, available from
<a href="http://tools.ietf.org/tools/rfcmarkup/">http://tools.ietf.org/tools/rfcmarkup/</a>
</small></small></span>


<meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

</body><!-- Mirrored from tools.ietf.org/html/rfc5451 by HTTrack Website Copier/3.x [XR&CO'2010], Wed, 19 Mar 2014 18:37:11 GMT --><!-- Added by HTTrack --></html>