<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><head profile="http://dublincore.org/documents/2008/08/04/dc-html/">
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.107" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="urn:ietf:rfc:4562" name="DC.Identifier"/>
<meta content='This document describes a mechanism to ensure layer-2 separation of\nLocal Area Network (LAN) stations accessing an IPv4 gateway over a\nbridged Ethernet segment.  The mechanism - called "MAC-Forced\nForwarding" - implements an Address Resolution Protocol (ARP) proxy\nfunction that prohibits Ethernet Media Access Control (MAC) address\nresolution between hosts located within the same IPv4 subnet but at\ndifferent customer premises, and in effect directs all upstream\ntraffic to an IPv4 gateway. The IPv4 gateway provides IP-layer\nconnectivity between these same hosts. This memo provides information\nfor the Internet community.' name="DC.Description.Abstract"/>
<meta content="Blake, Steven" name="DC.Creator"/>
<meta content="Melsen, Torben" name="DC.Creator"/>
<meta content="June, 2006" name="DC.Date.Issued"/>
<meta content="MAC-Forced Forwarding: A Method for Subscriber Separation on an Ethernet Access Network" name="DC.Title"/>

    <link href="http://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="http://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 4562 - MAC-Forced Forwarding: A Method for Subscriber Separation on an Ethernet Access Network</title>
    
    
    <style type="text/css">
	body {
	    margin: 0px 8px;
            font-size: 1em;
	}
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgorange" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="http://tools.ietf.org/rfc/rfc4562.txt" title="Plaintext version of this document">txt</a>|<a href="http://tools.ietf.org/pdf/rfc4562" title="PDF version of this document">pdf</a>] [<a href="http://tools.ietf.org/html/draft-melsen-mac-forced-fwd" title="draft-melsen-mac-forced-fwd">draft-melsen-mac-...</a>] [<a href="http://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc4562" title="Inline diff (wdiff)">Diff1</a>] [<a href="http://tools.ietf.org/rfcdiff?url2=rfc4562" title="Side-by-side diff">Diff2</a>]                 </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                           INFORMATIONAL</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<pre>Network Working Group                                          T. Melsen
Request for Comments: 4562                                      S. Blake
Category: Informational                                         Ericsson
                                                               June 2006


                         <span class="h1">MAC-Forced Forwarding:</span>
    <span class="h1">A Method for Subscriber Separation on an Ethernet Access Network</span>

Status of This Memo

   This memo provides information for the Internet community.  It does
   not specify an Internet standard of any kind.  Distribution of this
   memo is unlimited.

Copyright Notice

   Copyright (C) The Internet Society (2006).

Abstract

   This document describes a mechanism to ensure layer-2 separation of
   Local Area Network (LAN) stations accessing an IPv4 gateway over a
   bridged Ethernet segment.

   The mechanism - called "MAC-Forced Forwarding" - implements an
   Address Resolution Protocol (ARP) proxy function that prohibits
   Ethernet Media Access Control (MAC) address resolution between hosts
   located within the same IPv4 subnet but at different customer
   premises, and in effect directs all upstream traffic to an IPv4
   gateway.  The IPv4 gateway provides IP-layer connectivity between
   these same hosts.



















<span class="grey">Melsen &amp; Blake               Informational                      [Page 1]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc4562.html">RFC 4562</a>                 MAC-Forced Forwarding                 June 2006</span>


Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-2">2</a>
      <a href="#section-1.1">1.1</a>. Access Network Requirements ................................<a href="#page-3">3</a>
      <a href="#section-1.2">1.2</a>. Using Ethernet as an Access Network Technology .............<a href="#page-4">4</a>
   <a href="#section-2">2</a>. Terminology .....................................................<a href="#page-5">5</a>
   <a href="#section-3">3</a>. Solution Aspects ................................................<a href="#page-6">6</a>
      <a href="#section-3.1">3.1</a>. Obtaining the IP and MAC Addresses of the Access Routers ...<a href="#page-6">6</a>
      <a href="#section-3.2">3.2</a>. Responding to ARP Requests .................................<a href="#page-7">7</a>
      <a href="#section-3.3">3.3</a>. Filtering Upstream Traffic .................................<a href="#page-8">8</a>
      <a href="#section-3.4">3.4</a>. Restricted Access to Application Servers ...................<a href="#page-8">8</a>
   <a href="#section-4">4</a>. Access Router Considerations ....................................<a href="#page-8">8</a>
   <a href="#section-5">5</a>. Resiliency Considerations .......................................<a href="#page-9">9</a>
   <a href="#section-6">6</a>. Multicast Considerations ........................................<a href="#page-9">9</a>
   <a href="#section-7">7</a>. IPv6 Considerations ............................................<a href="#page-10">10</a>
   <a href="#section-8">8</a>. Security Considerations ........................................<a href="#page-10">10</a>
   <a href="#section-9">9</a>. Acknowledgements ...............................................<a href="#page-11">11</a>
   <a href="#section-10">10</a>. References ....................................................<a href="#page-11">11</a>
      <a href="#section-10.1">10.1</a>. Normative References .....................................<a href="#page-11">11</a>
      <a href="#section-10.2">10.2</a>. Informative References ...................................<a href="#page-12">12</a>

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   The main purpose of an access network is to provide connectivity
   between customer hosts and service provider access routers (ARs),
   typically offering reachability to the Internet and other IP networks
   and/or IP-based applications.

   An access network may be decomposed into a subscriber line part and
   an aggregation network part.  The subscriber line - often referred to
   as "the first mile" - is characterized by an individual physical (or
   logical, in the case of some wireless technologies) connection to
   each customer premises.  The aggregation network - "the second mile"
   - performs aggregation and concentration of customer traffic.

   The subscriber line and the aggregation network are interconnected by
   an Access Node (AN).  Thus, the AN constitutes the border between
   individual subscriber lines and the common aggregation network.  This
   is illustrated in the following figure.












<span class="grey">Melsen &amp; Blake               Informational                      [Page 2]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc4562.html">RFC 4562</a>                 MAC-Forced Forwarding                 June 2006</span>


        Access       Aggregation  Access    Subscriber    Customer
        Routers      Network      Nodes     Lines         Premises
                                                          Networks
        +----+           |
      --+ AR +-----------|        +----+
        +----+           |        |    +----------------[]--------
                         |--------+ AN |
                         |        |    +----------------[]--------
                         |        +----+
                         |
                         |        +----+
                         |        |    +----------------[]--------
                         |--------+ AN |
                         |        |    +----------------[]--------
                         |        +----+
                         |
                         |        +----+
                         |        |    +----------------[]--------
                         |--------+ AN |
        +----+           |        |    +----------------[]--------
      --+ AR +-----------|        +----+
        +----+           |

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.1.%20%20Access%20Network%20Requirements"></a><a class="selflink" href="#section-1.1" name="section-1.1">1.1</a>.  Access Network Requirements</span>

   There are two basic requirements that an access network solution must
   satisfy:

   1. Layer-2 separation between customer premises.

   2. High IPv4 address assignment efficiency.

   It is required that all traffic to and from customer hosts located at
   different premises (i.e., accessed via different subscriber lines or
   via different access networks) be forwarded via an AR, and not
   bridged or switched at layer-2 (Requirement 1; see also requirement
   R-40 in [<a href="#ref-TR101" title='"Migration to Ethernet-Based DSL Aggregation"'>TR101</a>]).  This enables the access network service provider
   to use the AR(s) to perform security filtering, policing, and
   accounting of all customer traffic.  This implies that within the
   access network, layer-2 traffic paths should not exist that
   circumvent an AR (with some exceptions; see <a href="#section-3.4">Section 3.4</a>).

   In ATM-based access networks, the separation of individual customer
   hosts' traffic is an intrinsic feature achieved by the use of ATM
   permanent virtual connections (PVCs) between the customers' access
   device (e.g., DSL modem) and the AR (typically co-located/integrated
   with access control functionality in a Broadband Remote Access Server




<span class="grey">Melsen &amp; Blake               Informational                      [Page 3]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc4562.html">RFC 4562</a>                 MAC-Forced Forwarding                 June 2006</span>


   (BRAS)).  In this case, the AN is an ATM-based Digital Subscriber
   Line Access Multiplexer (DSLAM).

   This document, however, targets Ethernet-based access networks.
   Techniques other than ATM PVCs must be employed to ensure the desired
   separation of traffic to and from individual customer hosts.

   Efficient address assignment is necessary to minimize consumption of
   the scarce IPv4 address space (Requirement 2).  See [<a href="rfc3069.html" title='"VLAN Aggregation for Efficient IP Address Allocation"'>RFC3069</a>] for
   further discussion.  Address assignment efficiency is improved if
   host addresses are assigned out of one or more large pools, rather
   than by being assigned out of separate, smaller subnet blocks
   allocated to each customer premises.  IPv6 address assignment
   efficiency is of much less concern, and it is anticipated that IPv6
   deployments will allocate separate IPv6 subnet blocks to each
   customer premises [<a href="#ref-v6BB" title='"ISP IPv6 Deployment Scenarios in Broadband Access Networks"'>v6BB</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.2.%20%20Using%20Ethernet%20as%20an%20Access%20Network%20Technology"></a><a class="selflink" href="#section-1.2" name="section-1.2">1.2</a>.  Using Ethernet as an Access Network Technology</span>

   A major aspect of using Ethernet as an access technology is that
   traffic pertaining to different customer hosts is conveyed over a
   shared broadcast network.  Layer-2 isolation between customer
   premises networks could be provided by implementing access router
   functionality in each EAN, treating each subscriber line as a
   separate IP interface.  However, there are a variety of reasons why
   it is often desirable to avoid IP routing in the access network,
   including the need to satisfy regulatory requirements for direct
   layer-2 accessibility to multiple IP service providers.  In addition,
   this solution would not solve Requirement 2.

   To avoid IP routing within the access network, the Ethernet
   aggregation network is bridged via EANs to individual Ethernet
   networks at the customers' premises.  If the EANs were standard
   Ethernet bridges, then there would be direct layer-2 visibility
   between Ethernet stations (hosts) located at different customers'
   premises.  Specifically, hosts located within the same IP subnet
   would have this visibility.  This violates Requirement 1 (<a href="#section-1.1">Section</a>
   <a href="#section-1.1">1.1</a>) and introduces security issues, as malicious end-users thereby
   can attack hosts at other customers' premises directly at the
   Ethernet layer.

   Existing standardized solutions may be deployed to prevent layer-2
   visibility between stations:

   o  PPP over Ethernet [<a href="rfc2516.html" title='"A Method for Transmitting PPP Over Ethernet (PPPoE)"'>RFC2516</a>].  The use of PPPoE creates individual
      PPP sessions between hosts and one or more BRASes over a bridged
      Ethernet topology.  Traffic always flows between a BRAS and hosts,




<span class="grey">Melsen &amp; Blake               Informational                      [Page 4]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc4562.html">RFC 4562</a>                 MAC-Forced Forwarding                 June 2006</span>


      never directly between hosts.  The AN can force upstream traffic
      to flow only to the BRAS initially selected by the host.

   o  VLAN per-customer premises network [<a href="rfc3069.html" title='"VLAN Aggregation for Efficient IP Address Allocation"'>RFC3069</a>].  Traffic to/from
      each customer premises network can be separated into different
      VLANs across the aggregation network between the AN and the AR.

   Both solutions provide layer-2 isolation between customer hosts, but
   they are not considered optimal for broadband access networks,
   because:

   o  PPPoE does not support efficient multicast: packets must be
      replicated on each PPPoE session to hosts listening on a specific
      multicast group.  This negates one of the major advantages of
      using Ethernet (instead of ATM) as an access technology.  This is
      an especially problematic limitation for services such as IPTV,
      which require high bandwidth per-multicast group (channel), and
      which may often have hundreds or thousands of listening customer
      hosts per group.

   o  Using VLANs to isolate individual customer premises networks also
      forces multicast packets to be replicated to each VLAN with a
      listening host.  Furthermore, the basic limit of a maximum of 4096
      VLANs per-Ethernet network limits the scalability of the solution.
      This scalability limit can be removed by deploying VLAN stacking
      techniques within the access network, but this approach increases
      provisioning complexity.

   The solution proposed in this document avoids these problems.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Terminology"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Terminology</span>

   Access Node (AN)
      The entity interconnecting individual subscriber lines to the
      shared aggregation network.

   Access Router (AR)
      The entity interconnecting the access network to the Internet or
      other IP-based networks.  The AR provides connectivity between
      hosts on the access network at different customer premises.  It is
      also used to provide security filtering, policing, and accounting
      of customer traffic.

   Application Server (AS)
      A server, usually owned by a service provider, that attaches
      directly to the aggregation network and is directly reachable at
      layer-2 by customer hosts.




<span class="grey">Melsen &amp; Blake               Informational                      [Page 5]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc4562.html">RFC 4562</a>                 MAC-Forced Forwarding                 June 2006</span>


   Ethernet Access Node (EAN)
      An Access Node supporting Ethernet-based subscriber lines and
      uplinks to an Ethernet-based aggregation network and MAC-Forced
      Forwarding.  For example, for xDSL access, the EAN is an
      Ethernet-centric DSLAM.  The EAN is a special type of filtering
      bridge that does not forward Ethernet broadcast and multicast
      frames originating on a subscriber line to other subscriber lines,
      but either discards them or forwards them upstream (towards the
      aggregation network).  The EAN also discards unicast Ethernet
      frames that originate on a subscriber line and are not addressed
      to an AR.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20Solution%20Aspects"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  Solution Aspects</span>

   The basic property of the solution is that the EAN ensures that
   upstream traffic is always sent to a designated AR, even if the IP
   traffic should ultimately flow between customer hosts located within
   the same IP subnet.

   The solution has three major aspects:

   1. Initially, the EAN obtains the IP and MAC addresses of the allowed
      target ARs for each customer host.

   2. The EAN replies to any upstream ARP request [<a href="http://tools.ietf.org/html/rfc0826" title='"Ethernet Address Resolution Protocol: Or converting network protocol addresses to 48.bit Ethernet address for transmission on Ethernet hardware"'>RFC0826</a>] from
      customer hosts with the MAC address of an allowed target AR.

   3. The EAN discards any upstream unicast traffic to MAC addresses
      other than the allowed target ARs.  The EAN also discards all
      non-essential broadcast and multicast packets received on
      subscriber lines.

   These aspects are discussed in the following sections.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.1.%20%20Obtaining%20the%20IP%20and%20MAC%20Addresses%20of%20the%20Access%20Routers"></a><a class="selflink" href="#section-3.1" name="section-3.1">3.1</a>.  Obtaining the IP and MAC Addresses of the Access Routers</span>

   An access network may contain multiple ARs, and different hosts may
   be assigned to different (groups of) ARs.  This implies that the EAN
   must register the assigned AR addresses on a per-customer host basis.

   For each customer host, one of the ARs is acting as the default
   gateway.  If a customer has simultaneous access to multiple ARs, the
   other ARs typically will provide access to other IP networks.

   The EAN learns the IPv4 address of the allowed target ARs in one of
   two ways, depending on the host IPv4 address assignment method.  For
   each host using Dynamic Host Configuration Protocol (DHCP), the EAN
   learns the AR IPv4 addresses dynamically by snooping the DHCPACK



<span class="grey">Melsen &amp; Blake               Informational                      [Page 6]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc4562.html">RFC 4562</a>                 MAC-Forced Forwarding                 June 2006</span>


   reply to a host [<a href="rfc2131.html" title='"Dynamic Host Configuration Protocol"'>RFC2131</a>].  If a host using DHCP shall have
   simultaneous access to multiple ARs, DHCP option 121 [<a href="rfc3442.html" title='"The Classless Static Route Option for Dynamic Host Configuration Protocol (DHCP) version 4"'>RFC3442</a>] or
   DHCP option 33 [<a href="rfc2132.html" title='"DHCP Options and BOOTP Vendor Extensions"'>RFC2132</a>] must be used to specify them for that host.
   If static address assignment is used instead of DHCP, then AR IPv4
   addresses must be pre-provisioned in the EAN by the network operator.
   In both cases, the EAN will ARP to determine the ARs' corresponding
   MAC addresses.  This can be done immediately after the IPv4 addresses
   are learned or when the MAC addresses are first required.

   The DHCP server can associate customer hosts with subscriber lines if
   the EAN uses the DHCP Relay Agent Information Option (82) to convey a
   subscriber line identifier to the DHCP server in DHCP messages
   flowing upstream from the customer host [<a href="rfc3046.html" title='"DHCP Relay Agent Information Option"'>RFC3046</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.2.%20%20Responding%20to%20ARP%20Requests"></a><a class="selflink" href="#section-3.2" name="section-3.2">3.2</a>.  Responding to ARP Requests</span>

   If all customer networks were assigned individual IP subnet blocks
   (and if routing protocols were blocked inside the access network),
   then all upstream traffic would normally go to an AR (typically the
   default gateway), and the EAN could validate all upstream traffic by
   checking that the destination MAC address matched that of an AR.

   However, to comply with Requirement 2 of <a href="#section-1.1">Section 1.1</a>, residential
   customer networks are not (usually) assigned individual IPv4 subnet
   blocks.  In other words, several hosts located at different premises
   are within the same IPv4 subnet.  Consequently, if a host wishes to
   communicate with a host at another premises, an ARP request is issued
   to obtain that host's corresponding MAC address.  This request is
   intercepted by the EAN's ARP proxy, and an ARP reply is sent,
   specifying an allowed AR MAC address (typically the default
   gateway's) as the requested layer-2 destination address, in a manner
   similar to the "proxy ARP" mechanism described in [<a href="rfc1812.html" title='"Requirements for IP Version 4 Routers"'>RFC1812</a>].  In this
   way, the ARP table of the requesting host will register an AR MAC
   address as the layer-2 destination for any host within that IPv4
   subnet (except those at the same customer premises; see below).

   ARP requests for an IPv4 address of an allowed target AR are replied
   to by the EAN's ARP proxy with that AR's MAC address, rather than the
   MAC address of the default gateway AR.

   An exception is made when a host is ARPing for another host located
   within the same premises network.  If this ARP request reaches the
   EAN, it should be discarded, because it is assumed to be answered
   directly by the target host within the premises network.  The EAN
   must keep track of all assigned IPv4 addresses on a subscriber line
   so that it can detect these ARP requests and discard them.





<span class="grey">Melsen &amp; Blake               Informational                      [Page 7]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc4562.html">RFC 4562</a>                 MAC-Forced Forwarding                 June 2006</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.3.%20%20Filtering%20Upstream%20Traffic"></a><a class="selflink" href="#section-3.3" name="section-3.3">3.3</a>.  Filtering Upstream Traffic</span>

   Since the EAN's ARP proxy will always reply with the MAC address of
   an AR, the requesting host will never learn MAC addresses of hosts
   located at other premises.  However, malicious customers or
   malfunctioning hosts may still try to send traffic using other
   unicast destination MAC addresses.  The EAN must discard all unicast
   frames received on a subscriber line that are not addressed to a
   destination MAC address for an allowed AR (with some exceptions; see
   <a href="#section-3.4">Section 3.4</a>.

   Similarly, broadcast or multicast packets received on a subscriber
   line must never be forwarded on other subscriber lines, but only on
   EAN uplinks to the aggregation network.  An EAN must discard all
   non-ARP broadcast packets received on subscriber lines, except when
   DHCP is in use, in which case, the EAN must forward client-to-server
   DHCP broadcast messages (DHCPDISCOVER, DHCPREQUEST, DHCPDECLINE,
   DHCPINFORM) [<a href="rfc2131.html" title='"Dynamic Host Configuration Protocol"'>RFC2131</a>] upstream.  An EAN should rate limit upstream
   broadcast packets.

   Broadcast packets forwarded on an EAN uplink may be forwarded to
   other EANs by the aggregation network.  EANs should discard all
   broadcast packets received from the aggregation network, except ARPs
   from ARs for subscriber hosts and server-to-client DHCP messages
   (DHCPOFFER, DHCPACK, DHCPNAK) [<a href="rfc2131.html" title='"Dynamic Host Configuration Protocol"'>RFC2131</a>], when DHCP is in use.

   Filtering of multicast packets to and from an EAN uplink is discussed
   in <a href="#section-6">Section 6</a>.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.4.%20%20Restricted%20Access%20to%20Application%20Servers"></a><a class="selflink" href="#section-3.4" name="section-3.4">3.4</a>.  Restricted Access to Application Servers</span>

   The previous discussion (<a href="#section-3.1">Section 3.1</a>) describes how customer hosts
   are allowed direct layer-2 connectivity only to one or more ARs.
   Similarly, a customer host could be allowed direct layer-2 access to
   one or more Application Servers (ASes) which are directly connected
   to the aggregation network.  There is no functional difference in the
   way MAC-Forced Forwarding treats access to ARs and ASes.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20Access%20Router%20Considerations"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  Access Router Considerations</span>

   Traffic between customer hosts that belong to the same IPv4 subnet
   but are located at different customer premises will always be
   forwarded via an AR.  In this case, the AR will forward the traffic
   to the originating network, i.e., on the same interface from where it
   was received.  This normally results in an ICMP redirect message
   [<a href="http://tools.ietf.org/html/rfc0792" title='"Internet Control Message Protocol"'>RFC0792</a>] being sent to the originating host.  To prevent this
   behavior, the ICMP redirect function for aggregation network
   interfaces must be disabled in the AR.



<span class="grey">Melsen &amp; Blake               Informational                      [Page 8]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc4562.html">RFC 4562</a>                 MAC-Forced Forwarding                 June 2006</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20Resiliency%20Considerations"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  Resiliency Considerations</span>

   The operation of MAC-Forced Forwarding does not interfere with or
   delay IP connectivity recovery in the event of a sustained AR
   failure.  Use of DHCP to configure hosts with information on
   multiple, redundant ARs, or use of Virtual Router Redundancy Protocol
   (VRRP) [<a href="rfc3768.html" title='"Virtual Router Redundancy Protocol (VRRP)"'>RFC3768</a>] to implement AR redundancy, allows IP connectivity
   to be maintained.

   MAC-Forced Forwarding is a stateful protocol.  If static IPv4 address
   assignment is used in the access network, then the EAN must be pre-
   provisioned with state information for the customer hosts which may
   be reached via a subscriber line, and the ARs associated with those
   hosts.  In the event of a transient EAN failure, the EAN's state
   database can be quickly recovered from its configuration storage.

   If DHCP is used to assign IPv4 addresses in the access network, then
   MAC-Forced Forwarding operates as a soft-state protocol.  Since the
   DHCP and ARP messages that are snooped to construct the EAN state
   database are usually sent infrequently, a transient failure may not
   be detected by either the AR(s) or the customer hosts.  Therefore, a
   transient failure of an EAN could lead to an extended loss of
   connectivity.  To minimize connectivity loss, an EAN should maintain
   its dynamic state database in resilient storage to permit timely
   database and connectivity restoration.

   The EAN is a single point of attachment between a subscriber line and
   the aggregation network; hence, the EAN is a single point of
   connectivity failure.  Customers seeking more resilient connectivity
   should multi-home.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20Multicast%20Considerations"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  Multicast Considerations</span>

   Multicast traffic delivery for streams originating within the
   aggregation network or further upstream and delivered to one or more
   customer hosts in an access network is supported in a scalable manner
   by virtue of Ethernet's native multicast capability.  Bandwidth
   efficiency can be enhanced if the EAN behaves as an IGMP snooping
   bridge; e.g., if it snoops on IGMP Membership Report and Leave Group
   messages originating on subscriber lines to prune the set of
   subscriber lines on which to forward particular multicast groups
   [<a href="rfc3376.html" title='"Internet Group Management Protocol, Version 3"'>RFC3376</a>].

   An EAN must discard all IPv4 multicast packets received on a
   subscriber line other than IGMP Membership Report and Leave Group
   messages [<a href="rfc3376.html" title='"Internet Group Management Protocol, Version 3"'>RFC3376</a>].  If a customer host wishes to source multicast
   packets to a group, the host must tunnel them upstream to a multicast
   router; e.g., an AR acting as a Protocol Independent Multicast -



<span class="grey">Melsen &amp; Blake               Informational                      [Page 9]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc4562.html">RFC 4562</a>                 MAC-Forced Forwarding                 June 2006</span>


   Sparse Mode (PIM-SM) Designated Router [<a href="rfc2362.html" title='"Protocol Independent Multicast-Sparse Mode (PIM-SM): Protocol Specification"'>RFC2362</a>].  An AR will forward
   them back into the access network if there are any listening customer
   hosts.

   EAN processing of IPv6 multicast packets is discussed in the next
   section.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20IPv6%20Considerations"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  IPv6 Considerations</span>

   MAC-Forced Forwarding is not directly applicable for IPv6 access
   networks for the following reasons:

   1. IPv6 access networks do not require the same efficiency of address
      allocation as IPv4 access networks.  It is expected that customer
      premises networks will be allocated unique network prefixes (e.g.,
      /48) accommodating large numbers of customer subnets and hosts
      [<a href="#ref-v6BB" title='"ISP IPv6 Deployment Scenarios in Broadband Access Networks"'>v6BB</a>].

   2. IPv6 nodes do not use ARP, but instead use the Neighbor Discovery
      Protocol [<a href="rfc2461.html" title='"Neighbor Discovery for IP Version 6 (IPv6)"'>RFC2461</a>] for layer-2 address resolution.

   To simultaneously support both IPv6 and MAC-Forced Forwarding for
   IPv4, an EAN can implement the unicast, broadcast, and multicast
   filtering rules described in <a href="#section-3.3">Section 3.3</a>.  To correctly perform
   unicast filtering, the EAN must learn the IPv6 and MAC addresses of
   the allowed ARs for a particular subscriber line.  It can learn these
   addresses either through static configuration or by snooping Router
   Discovery messages exchanged between the customer premises router and
   one or more ARs [<a href="rfc2461.html" title='"Neighbor Discovery for IP Version 6 (IPv6)"'>RFC2461</a>].

   Multicast is an intrinsic part of the IPv6 protocol suite.
   Therefore, an EAN must not indiscriminately filter IPv6 multicast
   packets flowing upstream, although it may rate limit them.  Detailed
   IPv6 multicast filtering rules are not discussed in this document.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/8.%20%20Security%20Considerations"></a><a class="selflink" href="#section-8" name="section-8">8</a>.  Security Considerations</span>

   MAC-Forced Forwarding is, by its nature, a security function,
   ensuring layer-2 isolation of customer hosts sharing a broadcast
   access medium.  In that sense, it provides security equivalent to
   alternative PVC-based solutions.  Security procedures appropriate for
   any shared access medium are equally appropriate when MAC-Forced
   Forwarding is employed.  It does not introduce any additional
   vulnerabilities over those of standard Ethernet bridging.

   In addition to layer-2 isolation, an EAN implementing MAC-Forced
   Forwarding must discard all upstream broadcast packets, except for
   valid DHCP messages, and ARP requests (which are proxied by the EAN).



<span class="grey">Melsen &amp; Blake               Informational                     [Page 10]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc4562.html">RFC 4562</a>                 MAC-Forced Forwarding                 June 2006</span>


   In particular, the EAN must discard any DHCP server replies
   originating on a subscriber line.  Further, an EAN may rate limit
   upstream broadcast DHCP messages.

   An EAN implementing MAC-Forced Forwarding must keep track of IPv4
   addresses allocated on subscriber lines.  Therefore, the EAN has
   sufficient information to discard upstream traffic with spoofed IPv4
   source addresses.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/9.%20%20Acknowledgements"></a><a class="selflink" href="#section-9" name="section-9">9</a>.  Acknowledgements</span>

   The authors would like to thank Ulf Jonsson, Thomas Narten, James
   Carlson, Rolf Engstrand, Tomas Thyni, and Johan Kolhi for their
   helpful comments.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/10.%20%20References"></a><a class="selflink" href="#section-10" name="section-10">10</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/10.1.%20%20Normative%20References"></a><a class="selflink" href="#section-10.1" name="section-10.1">10.1</a>.  Normative References</span>

   [<a id="ref-RFC0792" name="ref-RFC0792">RFC0792</a>]  Postel, J., "Internet Control Message Protocol", STD 5,
              <a href="rfc792.html">RFC 792</a>, September 1981.

   [<a id="ref-RFC0826" name="ref-RFC0826">RFC0826</a>]  Plummer, D., "Ethernet Address Resolution Protocol:  Or
              converting network protocol addresses to 48.bit Ethernet
              address for transmission on Ethernet hardware", STD 37,
              <a href="rfc826.html">RFC 826</a>, November 1982.

   [<a id="ref-RFC2131" name="ref-RFC2131">RFC2131</a>]  Droms, R., "Dynamic Host Configuration Protocol", <a href="rfc2131.html">RFC</a>
              <a href="rfc2131.html">2131</a>, March 1997.

   [<a id="ref-RFC2132" name="ref-RFC2132">RFC2132</a>]  Alexander, S. and R. Droms, "DHCP Options and BOOTP Vendor
              Extensions", <a href="rfc2132.html">RFC 2132</a>, March 1997.

   [<a id="ref-RFC2362" name="ref-RFC2362">RFC2362</a>]  Estrin, D., Farinacci, D., Helmy, A., Thaler, D., Deering,
              S., Handley, M., Jacobson, V., Liu, C., Sharma, P., and L.
              Wei, "Protocol Independent Multicast-Sparse Mode (PIM-SM):
              Protocol Specification", <a href="rfc2362.html">RFC 2362</a>, June 1998.

   [<a id="ref-RFC3046" name="ref-RFC3046">RFC3046</a>]  Patrick, M., "DHCP Relay Agent Information Option", <a href="rfc3046.html">RFC</a>
              <a href="rfc3046.html">3046</a>, January 2001.

   [<a id="ref-RFC3376" name="ref-RFC3376">RFC3376</a>]  Cain, B., Deering, S., Kouvelas, I., Fenner, B., and A.
              Thyagarajan, "Internet Group Management Protocol, Version
              3", <a href="rfc3376.html">RFC 3376</a>, October 2002.

   [<a id="ref-RFC3442" name="ref-RFC3442">RFC3442</a>]  Lemon, T., Cheshire, S., and B. Volz, "The Classless
              Static Route Option for Dynamic Host Configuration
              Protocol (DHCP) version 4", <a href="rfc3442.html">RFC 3442</a>, December 2002.



<span class="grey">Melsen &amp; Blake               Informational                     [Page 11]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc4562.html">RFC 4562</a>                 MAC-Forced Forwarding                 June 2006</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/10.2.%20%20Informative%20References"></a><a class="selflink" href="#section-10.2" name="section-10.2">10.2</a>.  Informative References</span>

   [<a id="ref-RFC1812" name="ref-RFC1812">RFC1812</a>]  Baker, F., "Requirements for IP Version 4 Routers", <a href="rfc1812.html">RFC</a>
              <a href="rfc1812.html">1812</a>, June 1995.

   [<a id="ref-RFC3768" name="ref-RFC3768">RFC3768</a>]  Hinden, R., "Virtual Router Redundancy Protocol (VRRP)",
              <a href="rfc3768.html">RFC 3768</a>, April 2004.

   [<a id="ref-RFC2461" name="ref-RFC2461">RFC2461</a>]  Narten, T., Nordmark, E., and W. Simpson, "Neighbor
              Discovery for IP Version 6 (IPv6)", <a href="rfc2461.html">RFC 2461</a>, December
              1998.

   [<a id="ref-RFC2516" name="ref-RFC2516">RFC2516</a>]  Mamakos, L., Lidl, K., Evarts, J., Carrel, D., Simone, D.,
              and R. Wheeler, "A Method for Transmitting PPP Over
              Ethernet (PPPoE)", <a href="rfc2516.html">RFC 2516</a>, February 1999.

   [<a id="ref-RFC3069" name="ref-RFC3069">RFC3069</a>]  McPherson, D. and B. Dykes, "VLAN Aggregation for
              Efficient IP Address Allocation", <a href="rfc3069.html">RFC 3069</a>, February 2001.

   [<a id="ref-TR101" name="ref-TR101">TR101</a>]    DSL Forum, "Migration to Ethernet-Based DSL Aggregation",
              Technical Report TR-101, April 2006.

   [<a id="ref-v6BB" name="ref-v6BB">v6BB</a>]     Asadullah, S., Ahmed, A., Popoviciu, C., Savola, P., and
              J.  Palet, "ISP IPv6 Deployment Scenarios in Broadband
              Access Networks", Work in Progress.

Authors' Addresses

   Torben Melsen
   Ericsson
   Faelledvej
   Struer  DK-7600
   Denmark

   EMail: Torben.Melsen@ericsson.com


   Steven Blake
   Ericsson
   920 Main Campus Drive
   Suite 500
   Raleigh, NC  27606
   USA

   Phone: +1 919 472 9913
   EMail: steven.blake@ericsson.com





<span class="grey">Melsen &amp; Blake               Informational                     [Page 12]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc4562.html">RFC 4562</a>                 MAC-Forced Forwarding                 June 2006</span>


Full Copyright Statement

   Copyright (C) The Internet Society (2006).

   This document is subject to the rights, licenses and restrictions
   contained in <a href="http://tools.ietf.org/html/bcp78">BCP 78</a> and at www.rfc-editor.org/copyright.html, and
   except as set forth therein, the authors retain all their rights.

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY AND THE INTERNET
   ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS OR IMPLIED,
   INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE
   INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

Intellectual Property

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in <a href="http://tools.ietf.org/html/bcp78">BCP 78</a> and <a href="http://tools.ietf.org/html/bcp79">BCP 79</a>.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   <a href="http://www.ietf.org/ipr">http://www.ietf.org/ipr</a>.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at
   ietf-ipr@ietf.org.

Acknowledgement

   Funding for the RFC Editor function is provided by the IETF
   Administrative Support Activity (IASA).







Melsen &amp; Blake               Informational                     [Page 13]

</pre><br/>
<span class="noprint"><small><small>Html markup produced by rfcmarkup 1.107, available from
<a href="http://tools.ietf.org/tools/rfcmarkup/">http://tools.ietf.org/tools/rfcmarkup/</a>
</small></small></span>


<meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

</body><!-- Mirrored from tools.ietf.org/html/rfc4562 by HTTrack Website Copier/3.x [XR&CO'2010], Wed, 19 Mar 2014 18:40:04 GMT --><!-- Added by HTTrack --></html>