<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><head profile="http://dublincore.org/documents/2008/08/04/dc-html/">
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.107" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="urn:ietf:rfc:5477" name="DC.Identifier"/>
<meta content="This memo defines an information model for the Packet SAMPling (PSAMP)\nprotocol. It is used by the PSAMP protocol for encoding sampled packet\ndata and information related to the Sampling process. As the PSAMP\nprotocol is based on the IP Flow Information eXport (IPFIX) protocol,\nthis information model is an extension to the IPFIX information model.\n[STANDARDS-TRACK]" name="DC.Description.Abstract"/>
<meta content="Aitken, Paul" name="DC.Creator"/>
<meta content="Dietz, Thomas" name="DC.Creator"/>
<meta content="Claise, Benoit" name="DC.Creator"/>
<meta content="Carle, Georg" name="DC.Creator"/>
<meta content="Dressler, Falko" name="DC.Creator"/>
<meta content="March, 2009" name="DC.Date.Issued"/>
<meta content="Information Model for Packet Sampling Exports" name="DC.Title"/>

    <link href="http://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="http://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 5477 - Information Model for Packet Sampling Exports</title>
    
    
    <style type="text/css">
	body {
	    margin: 0px 8px;
            font-size: 1em;
	}
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgblue" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="http://tools.ietf.org/rfc/rfc5477.txt" title="Plaintext version of this document">txt</a>|<a href="http://tools.ietf.org/pdf/rfc5477" title="PDF version of this document">pdf</a>] [<a href="http://tools.ietf.org/html/draft-ietf-psamp-info" title="draft-ietf-psamp-info">draft-ietf-psamp-...</a>] [<a href="http://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc5477" title="Inline diff (wdiff)">Diff1</a>] [<a href="http://tools.ietf.org/rfcdiff?url2=rfc5477" title="Side-by-side diff">Diff2</a>] [<a href="http://www.rfc-editor.org/errata_search.php?rfc=5477">Errata</a>]        </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                       PROPOSED STANDARD</span><br/>
<span class="pre noprint docinfo">                                                            <span style="color: #C00;">Errata Exist</span></span><br/>
<pre>Network Working Group                                           T. Dietz
Request for Comments: 5477                               NEC Europe Ltd.
Category: Standards Track                                      B. Claise
                                                               P. Aitken
                                                     Cisco Systems, Inc.
                                                             F. Dressler
                                        University of Erlangen-Nuremberg
                                                                G. Carle
                                          Technical University of Munich
                                                              March 2009


             <span class="h1">Information Model for Packet Sampling Exports</span>

Status of This Memo

   This document specifies an Internet standards track protocol for the
   Internet community, and requests discussion and suggestions for
   improvements.  Please refer to the current edition of the "Internet
   Official Protocol Standards" (STD 1) for the standardization state
   and status of this protocol.  Distribution of this memo is unlimited.

Copyright Notice

   Copyright (c) 2009 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="http://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents in effect on the date of
   publication of this document (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>).
   Please review these documents carefully, as they describe your rights
   and restrictions with respect to this document.

   This document may contain material from IETF Documents or IETF
   Contributions published or made publicly available before November
   10, 2008.  The person(s) controlling the copyright in some of this
   material may not have granted the IETF Trust the right to allow
   modifications of such material outside the IETF Standards Process.
   Without obtaining an adequate license from the person(s) controlling
   the copyright in such materials, this document may not be modified
   outside the IETF Standards Process, and derivative works of it may
   not be created outside the IETF Standards Process, except to format
   it for publication as an RFC or to translate it into languages other
   than English.







<span class="grey">Dietz, et al.               Standards Track                     [Page 1]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc5477.html">RFC 5477</a>                PSAMP Information Model               March 2009</span>


Abstract

   This memo defines an information model for the Packet SAMPling
   (PSAMP) protocol.  It is used by the PSAMP protocol for encoding
   sampled packet data and information related to the Sampling process.
   As the PSAMP protocol is based on the IP Flow Information eXport
   (IPFIX) protocol, this information model is an extension to the IPFIX
   information model.

Table of Contents

   <a href="#section-1">1</a>.  Introduction . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-3">3</a>
   <a href="#section-2">2</a>.  PSAMP Documents Overview . . . . . . . . . . . . . . . . . . .  <a href="#page-4">4</a>
   <a href="#section-3">3</a>.  Terminology  . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-4">4</a>
     <a href="#section-3.1">3.1</a>.  Conventions Used in This Document  . . . . . . . . . . . .  <a href="#page-5">5</a>
   <a href="#section-4">4</a>.  Relationship between PSAMP and IPFIX . . . . . . . . . . . . .  <a href="#page-5">5</a>
   <a href="#section-5">5</a>.  Properties of a PSAMP Information Element  . . . . . . . . . .  <a href="#page-5">5</a>
   <a href="#section-6">6</a>.  Type Space . . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-5">5</a>
   <a href="#section-7">7</a>.  Overloading Information Elements . . . . . . . . . . . . . . .  <a href="#page-6">6</a>
   <a href="#section-8">8</a>.  The PSAMP Information Elements . . . . . . . . . . . . . . . .  <a href="#page-6">6</a>
     <a href="#section-8.1">8.1</a>.  Identifiers (301-303)  . . . . . . . . . . . . . . . . . .  <a href="#page-7">7</a>
       <a href="#section-8.1.1">8.1.1</a>.  selectionSequenceId  . . . . . . . . . . . . . . . . .  <a href="#page-7">7</a>
       <a href="#section-8.1.2">8.1.2</a>.  selectorId . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-8">8</a>
       <a href="#section-8.1.3">8.1.3</a>.  informationElementId . . . . . . . . . . . . . . . . .  <a href="#page-8">8</a>
     <a href="#section-8.2">8.2</a>.  Sampling Configuration (304-311) . . . . . . . . . . . . .  <a href="#page-9">9</a>
       <a href="#section-8.2.1">8.2.1</a>.  selectorAlgorithm  . . . . . . . . . . . . . . . . . .  <a href="#page-9">9</a>
       <a href="#section-8.2.2">8.2.2</a>.  samplingPacketInterval . . . . . . . . . . . . . . . . <a href="#page-11">11</a>
       <a href="#section-8.2.3">8.2.3</a>.  samplingPacketSpace  . . . . . . . . . . . . . . . . . <a href="#page-11">11</a>
       <a href="#section-8.2.4">8.2.4</a>.  samplingTimeInterval . . . . . . . . . . . . . . . . . <a href="#page-12">12</a>
       <a href="#section-8.2.5">8.2.5</a>.  samplingTimeSpace  . . . . . . . . . . . . . . . . . . <a href="#page-12">12</a>
       <a href="#section-8.2.6">8.2.6</a>.  samplingSize . . . . . . . . . . . . . . . . . . . . . <a href="#page-13">13</a>
       <a href="#section-8.2.7">8.2.7</a>.  samplingPopulation . . . . . . . . . . . . . . . . . . <a href="#page-13">13</a>
       <a href="#section-8.2.8">8.2.8</a>.  samplingProbability  . . . . . . . . . . . . . . . . . <a href="#page-13">13</a>
     <a href="#section-8.3">8.3</a>.  Hash Configuration (326-334) . . . . . . . . . . . . . . . <a href="#page-14">14</a>
       <a href="#section-8.3.1">8.3.1</a>.  digestHashValue  . . . . . . . . . . . . . . . . . . . <a href="#page-14">14</a>
       <a href="#section-8.3.2">8.3.2</a>.  hashIPPayloadOffset  . . . . . . . . . . . . . . . . . <a href="#page-15">15</a>
       <a href="#section-8.3.3">8.3.3</a>.  hashIPPayloadSize  . . . . . . . . . . . . . . . . . . <a href="#page-15">15</a>
       <a href="#section-8.3.4">8.3.4</a>.  hashOutputRangeMin . . . . . . . . . . . . . . . . . . <a href="#page-15">15</a>
       <a href="#section-8.3.5">8.3.5</a>.  hashOutputRangeMax . . . . . . . . . . . . . . . . . . <a href="#page-16">16</a>
       <a href="#section-8.3.6">8.3.6</a>.  hashSelectedRangeMin . . . . . . . . . . . . . . . . . <a href="#page-16">16</a>
       <a href="#section-8.3.7">8.3.7</a>.  hashSelectedRangeMax . . . . . . . . . . . . . . . . . <a href="#page-16">16</a>
       <a href="#section-8.3.8">8.3.8</a>.  hashDigestOutput . . . . . . . . . . . . . . . . . . . <a href="#page-17">17</a>
       <a href="#section-8.3.9">8.3.9</a>.  hashInitialiserValue . . . . . . . . . . . . . . . . . <a href="#page-17">17</a>
     <a href="#section-8.4">8.4</a>.  Timestamps (322-325) . . . . . . . . . . . . . . . . . . . <a href="#page-18">18</a>
       <a href="#section-8.4.1">8.4.1</a>.  observationTimeSeconds . . . . . . . . . . . . . . . . <a href="#page-18">18</a>
       <a href="#section-8.4.2">8.4.2</a>.  observationTimeMilliseconds  . . . . . . . . . . . . . <a href="#page-18">18</a>
       <a href="#section-8.4.3">8.4.3</a>.  observationTimeMicroseconds  . . . . . . . . . . . . . <a href="#page-19">19</a>
       <a href="#section-8.4.4">8.4.4</a>.  observationTimeNanoseconds . . . . . . . . . . . . . . <a href="#page-19">19</a>



<span class="grey">Dietz, et al.               Standards Track                     [Page 2]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc5477.html">RFC 5477</a>                PSAMP Information Model               March 2009</span>


     <a href="#section-8.5">8.5</a>.  Packet Data (313-314, 316-317) . . . . . . . . . . . . . . <a href="#page-19">19</a>
       <a href="#section-8.5.1">8.5.1</a>.  ipHeaderPacketSection  . . . . . . . . . . . . . . . . <a href="#page-20">20</a>
       <a href="#section-8.5.2">8.5.2</a>.  ipPayloadPacketSection . . . . . . . . . . . . . . . . <a href="#page-20">20</a>
       <a href="#section-8.5.3">8.5.3</a>.  mplsLabelStackSection  . . . . . . . . . . . . . . . . <a href="#page-21">21</a>
       <a href="#section-8.5.4">8.5.4</a>.  mplsPayloadPacketSection . . . . . . . . . . . . . . . <a href="#page-21">21</a>
     <a href="#section-8.6">8.6</a>.  Statistics (318-321, 336-338)  . . . . . . . . . . . . . . <a href="#page-22">22</a>
       <a href="#section-8.6.1">8.6.1</a>.  selectorIdTotalPktsObserved  . . . . . . . . . . . . . <a href="#page-22">22</a>
       <a href="#section-8.6.2">8.6.2</a>.  selectorIdTotalPktsSelected  . . . . . . . . . . . . . <a href="#page-23">23</a>
       <a href="#section-8.6.3">8.6.3</a>.  absoluteError  . . . . . . . . . . . . . . . . . . . . <a href="#page-23">23</a>
       <a href="#section-8.6.4">8.6.4</a>.  relativeError  . . . . . . . . . . . . . . . . . . . . <a href="#page-24">24</a>
       <a href="#section-8.6.5">8.6.5</a>.  upperCILimit . . . . . . . . . . . . . . . . . . . . . <a href="#page-24">24</a>
       <a href="#section-8.6.6">8.6.6</a>.  lowerCILimit . . . . . . . . . . . . . . . . . . . . . <a href="#page-25">25</a>
       <a href="#section-8.6.7">8.6.7</a>.  confidenceLevel  . . . . . . . . . . . . . . . . . . . <a href="#page-26">26</a>
   <a href="#section-9">9</a>.  Security Considerations  . . . . . . . . . . . . . . . . . . . <a href="#page-26">26</a>
   <a href="#section-10">10</a>. IANA Considerations  . . . . . . . . . . . . . . . . . . . . . <a href="#page-27">27</a>
     <a href="#section-10.1">10.1</a>. Related Considerations . . . . . . . . . . . . . . . . . . <a href="#page-27">27</a>
     <a href="#section-10.2">10.2</a>. PSAMP-Related Considerations . . . . . . . . . . . . . . . <a href="#page-27">27</a>
   <a href="#section-11">11</a>. References . . . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-27">27</a>
     <a href="#section-11.1">11.1</a>. Normative References . . . . . . . . . . . . . . . . . . . <a href="#page-27">27</a>
     <a href="#section-11.2">11.2</a>. Informative References . . . . . . . . . . . . . . . . . . <a href="#page-28">28</a>
   <a href="#appendix-A">Appendix A</a>.  Formal Specification of PSAMP Information Elements  . 29

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   Packet Sampling techniques are required for various measurement
   scenarios.  The Packet Sampling (PSAMP) protocol provides mechanisms
   for packet selection using different Filtering and Sampling
   techniques.  A standardized way for the export and storage of the
   Information Elements defined in <a href="#section-8">Section 8</a> is required.  The
   definition of the PSAMP information and data model is based on the
   IPFIX information model [<a href="rfc5102.html" title='"Information Model for IP Flow Information Export"'>RFC5102</a>].  The PSAMP protocol document
   [<a href="rfc5476.html" title='"Packet Sampling (PSAMP) Protocol Specifications"'>RFC5476</a>] specifies how to use the IPFIX protocol in the PSAMP
   context.

   This document examines the IPFIX information model [<a href="rfc5102.html" title='"Information Model for IP Flow Information Export"'>RFC5102</a>] and
   extends it to meet the PSAMP requirements.  Therefore, the structure
   of this document is strongly based on the IPFIX document.  It
   complements the PSAMP protocol specification by providing an
   appropriate PSAMP information model.  The main part of this document,
   <a href="#section-8">Section 8</a>, defines the list of Information Elements to be transmitted
   by the PSAMP protocol.  Sections <a href="#section-5">5</a> and <a href="#section-6">6</a> describe the data types and
   Information Element properties used within this document and their
   relationship to the IPFIX information model.

   Although the PSAMP charter specified no requirements for measuring
   packet errors (such as drops, malformed, etc.), and this document
   does not cover such data, if there is need for collecting and
   exporting packet error information, the appropriate Information



<span class="grey">Dietz, et al.               Standards Track                     [Page 3]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc5477.html">RFC 5477</a>                PSAMP Information Model               March 2009</span>


   Elements can be requested from IANA, and exported with the PSAMP
   protocol.

   The main body of <a href="#section-8">Section 8</a> was generated from an XML document.  The
   XML-based specification of the PSAMP Information Elements can be used
   for automatically checking syntactical correctness of the
   specification.  Furthermore it can be used -- in combination with the
   IPFIX information model -- for automated code generation.  The
   resulting code can be used in PSAMP protocol implementations to deal
   with processing PSAMP information elements.

   For that reason, the XML document that served as the source for
   <a href="#section-8">Section 8</a> is attached to this document in <a href="#appendix-A">Appendix A</a>.

   Note that although partially generated from the attached XML
   documents, the main body of this document is normative while the
   appendix is informational.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20PSAMP%20Documents%20Overview"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  PSAMP Documents Overview</span>

   This document is one out of a series of documents from the PSAMP
   group.

   [<a href="rfc5474.html" title='"A Framework for Packet Selection and Reporting"'>RFC5474</a>]: "A Framework for Packet Selection and Reporting" describes
   the PSAMP framework for network elements to select subsets of packets
   by statistical and other methods, and to export a stream of reports
   on the selected packets to a Collector.

   [<a href="rfc5475.html" title='"Sampling and Filtering Techniques for IP Packet Selection"'>RFC5475</a>]: "Sampling and Filtering Techniques for IP Packet
   Selection" describes the set of packet selection techniques supported
   by PSAMP.

   [<a href="rfc5476.html" title='"Packet Sampling (PSAMP) Protocol Specifications"'>RFC5476</a>]: "Packet Sampling (PSAMP) Protocol Specifications"
   specifies the export of packet information from a PSAMP Exporting
   Process to a PSAMP Collecting Process.

   <a href="rfc5477.html">RFC 5477</a> (this document): "Information Model for Packet Sampling
   Exports" defines an information and data model for PSAMP.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20Terminology"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  Terminology</span>

   IPFIX-specific terminology used in this document is defined in
   <a href="rfc5101.html#section-2">Section 2 of [RFC5101]</a>.  PSAMP-specific terminology used in this
   document is defined in <a href="rfc5476.html#section-3.2">Section 3.2 of [RFC5476]</a>.  In this document,
   as in [<a href="rfc5101.html" title='"Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of IP Traffic Flow Information"'>RFC5101</a>] and [<a href="rfc5476.html" title='"Packet Sampling (PSAMP) Protocol Specifications"'>RFC5476</a>], the first letter of each IPFIX- and
   PSAMP-specific term is capitalized.





<span class="grey">Dietz, et al.               Standards Track                     [Page 4]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc5477.html">RFC 5477</a>                PSAMP Information Model               March 2009</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.1.%20%20Conventions%20Used%20in%20This%20Document"></a><a class="selflink" href="#section-3.1" name="section-3.1">3.1</a>.  Conventions Used in This Document</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in <a href="rfc2119.html">RFC 2119</a> [<a href="rfc2119.html" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20Relationship%20between%20PSAMP%20and%20IPFIX"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  Relationship between PSAMP and IPFIX</span>

   As described in the PSAMP protocol [<a href="rfc5476.html" title='"Packet Sampling (PSAMP) Protocol Specifications"'>RFC5476</a>], a PSAMP Report can be
   seen as a very special IPFIX Data Record.  It represents an IPFIX
   Flow containing only a single packet.  Therefore, the IPFIX
   information model can be used as a basis for PSAMP Reports.

   Nevertheless, there are properties required in PSAMP Reports that
   cannot be modeled using the current IPFIX information model.  This
   document describes extensions to the IPFIX information model that
   allow the modeling of information and data required by PSAMP.

   Some of these extensions allow the export of what may be considered
   sensitive information.  Refer to the Security Considerations section
   for a fuller discussion.

   Note that the export of sampled or filtered PSAMP Reports may not
   need all the Information Elements defined by the IPFIX information
   model [<a href="rfc5102.html" title='"Information Model for IP Flow Information Export"'>RFC5102</a>], as discussed in Sections <a href="#section-6.2">6.2</a> and <a href="#section-6.3">6.3</a> of the PSAMP
   Framework [<a href="rfc5474.html" title='"A Framework for Packet Selection and Reporting"'>RFC5474</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20Properties%20of%20a%20PSAMP%20Information%20Element"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  Properties of a PSAMP Information Element</span>

   The PSAMP Information Elements are defined in accordance with
   Sections <a href="#section-2.1">2.1</a> to <a href="#section-2.3">2.3</a> of the IPFIX information model [<a href="rfc5102.html" title='"Information Model for IP Flow Information Export"'>RFC5102</a>] to which
   reference should be made for more information.  Nevertheless, we
   strongly recommend defining the optional "units" property for every
   Information Element (if applicable).

   The Data Types defined in <a href="#section-3.1">Section 3.1</a> of the IPFIX information model
   [<a href="rfc5102.html" title='"Information Model for IP Flow Information Export"'>RFC5102</a>] are also used for the PSAMP Information Elements.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20Type%20Space"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  Type Space</span>

   The PSAMP Information Elements MUST be constructed from the basic
   abstract data types and data type semantics described in <a href="#section-3">Section 3</a> of
   the IPFIX information model [<a href="rfc5102.html" title='"Information Model for IP Flow Information Export"'>RFC5102</a>].  To ensure consistency between
   IPFIX and PSAMP, the data types are not repeated in this document.
   The encoding of these data types is described in the IPFIX protocol
   [<a href="rfc5101.html" title='"Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of IP Traffic Flow Information"'>RFC5101</a>].





<span class="grey">Dietz, et al.               Standards Track                     [Page 5]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc5477.html">RFC 5477</a>                PSAMP Information Model               March 2009</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20Overloading%20Information%20Elements"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  Overloading Information Elements</span>

   Information Elements SHOULD NOT be overloaded with multiple meanings
   or re-used for multiple purposes.  Different Information Elements
   SHOULD be allocated for each requirement.

   Although the presence of certain other Information Elements allows
   the selection method to be inferred, a separate Information Element
   is provided for the selectorAlgorithm to include as scope for the
   Selector Report Interpretation [<a href="rfc5476.html" title='"Packet Sampling (PSAMP) Protocol Specifications"'>RFC5476</a>].

   Even if the Information Elements are specified with a specific
   selection method (i.e., a specific value of selectorAlgorithm) in
   mind, these Information Elements are not restricted to the selection
   method and MAY be used for different selection methods in the future.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/8.%20%20The%20PSAMP%20Information%20Elements"></a><a class="selflink" href="#section-8" name="section-8">8</a>.  The PSAMP Information Elements</span>

   This section describes the Information Elements used by the PSAMP
   protocol.

   For each Information Element specified in Sections <a href="#section-8.1">8.1</a> - <a href="#section-8.6">8.6</a> below, a
   unique identifier is allocated in accordance with <a href="#section-4">Section 4</a> of the
   IPFIX information model [<a href="rfc5102.html" title='"Information Model for IP Flow Information Export"'>RFC5102</a>].  The assignments are controlled by
   IANA as an extension of the IPFIX information model.

   The Information Elements specified by the IPFIX information model
   [<a href="rfc5102.html" title='"Information Model for IP Flow Information Export"'>RFC5102</a>] are used by the PSAMP protocol where applicable.  To avoid
   inconsistencies between the IPFIX and the PSAMP information and data
   models, only those Information Elements that are not already
   described by the IPFIX information model are defined here.




















<span class="grey">Dietz, et al.               Standards Track                     [Page 6]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc5477.html">RFC 5477</a>                PSAMP Information Model               March 2009</span>


   Below is the list of additional PSAMP Information Elements:

 +-----+----------------------------+-----+----------------------------+
 |  ID | Name                       |  ID | Name                       |
 +-----+----------------------------+-----+----------------------------+
 | 301 | selectionSequenceId        | 321 | relativeError              |
 | 302 | selectorId                 | 322 | observationTimeSeconds     |
 | 303 | informationElementId       | 323 | observationTimeMilliseconds|
 | 304 | selectorAlgorithm          | 324 | observationTimeMicroseconds|
 | 305 | samplingPacketInterval     | 325 | observationTimeNanoseconds |
 | 306 | samplingPacketSpace        | 326 | digestHashValue            |
 | 307 | samplingTimeInterval       | 327 | hashIPPayloadOffset        |
 | 308 | samplingTimeSpace          | 328 | hashIPPayloadSize          |
 | 309 | samplingSize               | 329 | hashOutputRangeMin         |
 | 310 | samplingPopulation         | 330 | hashOutputRangeMax         |
 | 311 | samplingProbability        | 331 | hashSelectedRangeMin       |
 | 313 | ipHeaderPacketSection      | 332 | hashSelectedRangeMax       |
 | 314 | ipPayloadPacketSection     | 333 | hashDigestOutput           |
 | 316 | mplsLabelStackSection      | 334 | hashInitialiserValue       |
 | 317 | mplsPayloadPacketSection   | 336 | upperCILimit               |
 | 318 | selectorIdTotalPktsObserved| 337 | lowerCILimit               |
 | 319 | selectorIdTotalPktsSelected| 338 | confidenceLevel            |
 | 320 | absoluteError              |     |                            |
 +-----+----------------------------+-----+----------------------------+

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/8.1.%20%20Identifiers%20%28301-303%29"></a><a class="selflink" href="#section-8.1" name="section-8.1">8.1</a>.  Identifiers (301-303)</span>

   Information Elements in this section serve as identifiers.  All of
   them have an integral abstract data type and data type semantics
   "identifier".

 +-----+----------------------------+-----+----------------------------+
 |  ID | Name                       |  ID | Name                       |
 +-----+----------------------------+-----+----------------------------+
 | 301 | selectionSequenceId        | 303 | informationElementId       |
 | 302 | selectorId                 |     |                            |
 +-----+----------------------------+-----+----------------------------+

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/8.1.1.%20%20selectionSequenceId"></a><a class="selflink" href="#section-8.1.1" name="section-8.1.1">8.1.1</a>.  selectionSequenceId</span>

   Description:

      From all the packets observed at an Observation Point, a subset of
      the packets is selected by a sequence of one or more Selectors.
      The selectionSequenceId is a unique value per Observation Domain,
      specifying the Observation Point and the sequence of Selectors
      through which the packets are selected.




<span class="grey">Dietz, et al.               Standards Track                     [Page 7]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc5477.html">RFC 5477</a>                PSAMP Information Model               March 2009</span>


   Abstract Data Type:  unsigned64

   Data Type Semantics:  identifier

   ElementId:  301

   Status:  current

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/8.1.2.%20%20selectorId"></a><a class="selflink" href="#section-8.1.2" name="section-8.1.2">8.1.2</a>.  selectorId</span>

   Description:

      The Selector ID is the unique ID identifying a Primitive Selector.
      Each Primitive Selector must have a unique ID in the Observation
      Domain.

   Abstract Data Type:  unsigned16

   Data Type Semantics:  identifier

   ElementId:  302

   Status:  current

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/8.1.3.%20%20informationElementId"></a><a class="selflink" href="#section-8.1.3" name="section-8.1.3">8.1.3</a>.  informationElementId</span>

   Description:

      This Information Element contains the ID of another Information
      Element.

   Abstract Data Type:  unsigned16

   Data Type Semantics:  identifier

   ElementId:  303

   Status:  current













<span class="grey">Dietz, et al.               Standards Track                     [Page 8]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc5477.html">RFC 5477</a>                PSAMP Information Model               March 2009</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/8.2.%20%20Sampling%20Configuration%20%28304-311%29"></a><a class="selflink" href="#section-8.2" name="section-8.2">8.2</a>.  Sampling Configuration (304-311)</span>

   Information Elements in this section can be used for describing the
   Sampling configuration of a Selection Process.

 +-----+----------------------------+-----+----------------------------+
 |  ID | Name                       |  ID | Name                       |
 +-----+----------------------------+-----+----------------------------+
 | 304 | selectorAlgorithm          | 308 | samplingTimeSpace          |
 | 305 | samplingPacketInterval     | 309 | samplingSize               |
 | 306 | samplingPacketSpace        | 310 | samplingPopulation         |
 | 307 | samplingTimeInterval       | 311 | samplingProbability        |
 +-----+----------------------------+-----+----------------------------+

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/8.2.1.%20%20selectorAlgorithm"></a><a class="selflink" href="#section-8.2.1" name="section-8.2.1">8.2.1</a>.  selectorAlgorithm</span>

   Description:

      This Information Element identifies the packet selection methods
      (e.g., Filtering, Sampling) that are applied by the Selection
      Process.

      Most of these methods have parameters.  Further Information
      Elements are needed to fully specify packet selection with these
      methods and all their parameters.

      The methods listed below are defined in [<a href="rfc5475.html" title='"Sampling and Filtering Techniques for IP Packet Selection"'>RFC5475</a>].  For their
      parameters, Information Elements are defined in the information
      model document.  The names of these Information Elements are
      listed for each method identifier.

      Further method identifiers may be added to the list below.  It
      might be necessary to define new Information Elements to specify
      their parameters.

      The selectorAlgorithm registry is maintained by IANA.  New
      assignments for the registry will be administered by IANA and are
      subject to Expert Review [<a href="rfc5226.html" title='"Guidelines for Writing an IANA Considerations Section in RFCs"'>RFC5226</a>].

      The registry can be updated when specifications of the new
      method(s) and any new Information Elements are provided.

      The group of experts must double check the selectorAlgorithm
      definitions and Information Elements with already defined
      selectorAlgorithms and Information Elements for completeness,
      accuracy, and redundancy.  Those experts will initially be drawn
      from the Working Group Chairs and document editors of the IPFIX
      and PSAMP Working Groups.



<span class="grey">Dietz, et al.               Standards Track                     [Page 9]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc5477.html">RFC 5477</a>                PSAMP Information Model               March 2009</span>


      The following packet selection methods identifiers are defined
      here:

           +----+------------------------+------------------------+
           | ID |        Method          |      Parameters        |
           +----+------------------------+------------------------+
           | 1  | Systematic count-based | samplingPacketInterval |
           |    | Sampling               | samplingPacketSpace    |
           +----+------------------------+------------------------+
           | 2  | Systematic time-based  | samplingTimeInterval   |
           |    | Sampling               | samplingTimeSpace      |
           +----+------------------------+------------------------+
           | 3  | Random n-out-of-N      | samplingSize           |
           |    | Sampling               | samplingPopulation     |
           +----+------------------------+------------------------+
           | 4  | Uniform probabilistic  | samplingProbability    |
           |    | Sampling               |                        |
           +----+------------------------+------------------------+
           | 5  | Property Match         | no agreed parameters   |
           |    | Filtering              |                        |
           +----+------------------------+------------------------+
           |   Hash-based Filtering      | hashInitialiserValue   |
           +----+------------------------+ hashIPPayloadOffset    |
           | 6  | using BOB              | hashIPPayloadSize      |
           +----+------------------------+ hashSelectedRangeMin   |
           | 7  | using IPSX             | hashSelectedRangeMax   |
           +----+------------------------+ hashOutputRangeMin     |
           | 8  | using CRC              | hashOutputRangeMax     |
           +----+------------------------+------------------------+

      There is a broad variety of possible parameters that could be used
      for Property match Filtering (5), but currently there are no
      agreed parameters specified.

   Abstract Data Type:  unsigned16

   Data Type Semantics:  identifier

   ElementId:  304

   Status:  current










<span class="grey">Dietz, et al.               Standards Track                    [Page 10]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc5477.html">RFC 5477</a>                PSAMP Information Model               March 2009</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/8.2.2.%20%20samplingPacketInterval"></a><a class="selflink" href="#section-8.2.2" name="section-8.2.2">8.2.2</a>.  samplingPacketInterval</span>

   Description:

      This Information Element specifies the number of packets that are
      consecutively sampled.  A value of 100 means that 100 consecutive
      packets are sampled.

      For example, this Information Element may be used to describe the
      configuration of a systematic count-based Sampling Selector.

   Abstract Data Type:  unsigned32

   Data Type Semantics:  quantity

   ElementId:  305

   Status:  current

   Units:  packets

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/8.2.3.%20%20samplingPacketSpace"></a><a class="selflink" href="#section-8.2.3" name="section-8.2.3">8.2.3</a>.  samplingPacketSpace</span>

   Description:

      This Information Element specifies the number of packets between
      two "samplingPacketInterval"s.  A value of 100 means that the next
      interval starts 100 packets (which are not sampled) after the
      current "samplingPacketInterval" is over.

      For example, this Information Element may be used to describe the
      configuration of a systematic count-based Sampling Selector.

   Abstract Data Type:  unsigned32

   Data Type Semantics:  quantity

   ElementId:  306

   Status:  current

   Units:  packets









<span class="grey">Dietz, et al.               Standards Track                    [Page 11]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc5477.html">RFC 5477</a>                PSAMP Information Model               March 2009</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/8.2.4.%20%20samplingTimeInterval"></a><a class="selflink" href="#section-8.2.4" name="section-8.2.4">8.2.4</a>.  samplingTimeInterval</span>

   Description:

      This Information Element specifies the time interval in
      microseconds during which all arriving packets are sampled.

      For example, this Information Element may be used to describe the
      configuration of a systematic time-based Sampling Selector.

   Abstract Data Type:  unsigned32

   Data Type Semantics:  quantity

   ElementId:  307

   Status:  current

   Units:  microseconds

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/8.2.5.%20%20samplingTimeSpace"></a><a class="selflink" href="#section-8.2.5" name="section-8.2.5">8.2.5</a>.  samplingTimeSpace</span>

   Description:

      This Information Element specifies the time interval in
      microseconds between two "samplingTimeInterval"s.  A value of 100
      means that the next interval starts 100 microseconds (during which
      no packets are sampled) after the current "samplingTimeInterval"
      is over.

      For example, this Information Element may used to describe the
      configuration of a systematic time-based Sampling Selector.

   Abstract Data Type:  unsigned32

   Data Type Semantics:  quantity

   ElementId:  308

   Status:  current

   Units:  microseconds









<span class="grey">Dietz, et al.               Standards Track                    [Page 12]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc5477.html">RFC 5477</a>                PSAMP Information Model               March 2009</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/8.2.6.%20%20samplingSize"></a><a class="selflink" href="#section-8.2.6" name="section-8.2.6">8.2.6</a>.  samplingSize</span>

   Description:

      This Information Element specifies the number of elements taken
      from the parent Population for random Sampling methods.

      For example, this Information Element may be used to describe the
      configuration of a random n-out-of-N Sampling Selector.

   Abstract Data Type:  unsigned32

   Data Type Semantics:  quantity

   ElementId:  309

   Status:  current

   Units:  packets

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/8.2.7.%20%20samplingPopulation"></a><a class="selflink" href="#section-8.2.7" name="section-8.2.7">8.2.7</a>.  samplingPopulation</span>

   Description:

      This Information Element specifies the number of elements in the
      parent Population for random Sampling methods.

      For example, this Information Element may be used to describe the
      configuration of a random n-out-of-N Sampling Selector.

   Abstract Data Type:  unsigned32

   Data Type Semantics:  quantity

   ElementId:  310

   Status:  current

   Units:  packets

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/8.2.8.%20%20samplingProbability"></a><a class="selflink" href="#section-8.2.8" name="section-8.2.8">8.2.8</a>.  samplingProbability</span>

   Description:

      This Information Element specifies the probability that a packet
      is sampled, expressed as a value between 0 and 1.  The probability
      is equal for every packet.  A value of 0 means no packet was
      sampled since the probability is 0.



<span class="grey">Dietz, et al.               Standards Track                    [Page 13]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc5477.html">RFC 5477</a>                PSAMP Information Model               March 2009</span>


      For example, this Information Element may be used to describe the
      configuration of a uniform probabilistic Sampling Selector.

   Abstract Data Type:  float64

   Data Type Semantics:  quantity

   ElementId:  311

   Status:  current

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/8.3.%20%20Hash%20Configuration%20%28326-334%29"></a><a class="selflink" href="#section-8.3" name="section-8.3">8.3</a>.  Hash Configuration (326-334)</span>

   The following Information Elements can be used for describing the
   Sampling configuration of a Selection Process.  The individual
   parameters are explained in more detail in Sections <a href="#section-6.2">6.2</a>, <a href="#section-3.8">3.8</a>, and <a href="#section-7.1">7.1</a>
   of [<a href="rfc5475.html" title='"Sampling and Filtering Techniques for IP Packet Selection"'>RFC5475</a>].

 +-----+----------------------------+-----+----------------------------+
 |  ID | Name                       |  ID | Name                       |
 +-----+----------------------------+-----+----------------------------+
 | 326 | digestHashValue            | 331 | hashSelectedRangeMin       |
 | 327 | hashIPPayloadOffset        | 332 | hashSelectedRangeMax       |
 | 328 | hashIPPayloadSize          | 333 | hashDigestOutput           |
 | 329 | hashOutputRangeMin         | 334 | hashInitialiserValue       |
 | 330 | hashOutputRangeMax         |     |                            |
 +-----+----------------------------+-----+----------------------------+

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/8.3.1.%20%20digestHashValue"></a><a class="selflink" href="#section-8.3.1" name="section-8.3.1">8.3.1</a>.  digestHashValue</span>

   Description:

      This Information Element specifies the value from the digest hash
      function.

      See also Sections <a href="#section-6.2">6.2</a>, <a href="#section-3.8">3.8</a>, and <a href="#section-7.1">7.1</a> of [<a href="rfc5475.html" title='"Sampling and Filtering Techniques for IP Packet Selection"'>RFC5475</a>].

   Abstract Data Type:  unsigned64

   Data Type Semantics:  quantity

   ElementId:  326

   Status:  current







<span class="grey">Dietz, et al.               Standards Track                    [Page 14]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc5477.html">RFC 5477</a>                PSAMP Information Model               March 2009</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/8.3.2.%20%20hashIPPayloadOffset"></a><a class="selflink" href="#section-8.3.2" name="section-8.3.2">8.3.2</a>.  hashIPPayloadOffset</span>

   Description:

      This Information Element specifies the IP payload offset used by a
      Hash-based Selection Selector.

      See also Sections <a href="#section-6.2">6.2</a>, <a href="#section-3.8">3.8</a>, and <a href="#section-7.1">7.1</a> of [<a href="rfc5475.html" title='"Sampling and Filtering Techniques for IP Packet Selection"'>RFC5475</a>].

   Abstract Data Type:  unsigned64

   Data Type Semantics:  quantity

   ElementId:  327

   Status:  current

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/8.3.3.%20%20hashIPPayloadSize"></a><a class="selflink" href="#section-8.3.3" name="section-8.3.3">8.3.3</a>.  hashIPPayloadSize</span>

   Description:

      This Information Element specifies the IP payload size used by a
      Hash-based Selection Selector.

      See also Sections <a href="#section-6.2">6.2</a>, <a href="#section-3.8">3.8</a>, and <a href="#section-7.1">7.1</a> of [<a href="rfc5475.html" title='"Sampling and Filtering Techniques for IP Packet Selection"'>RFC5475</a>].

   Abstract Data Type:  unsigned64

   Data Type Semantics:  quantity

   ElementId:  328

   Status:  current

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/8.3.4.%20%20hashOutputRangeMin"></a><a class="selflink" href="#section-8.3.4" name="section-8.3.4">8.3.4</a>.  hashOutputRangeMin</span>

   Description:

      This Information Element specifies the value for the beginning of
      a hash function's potential output range.

      See also Sections <a href="#section-6.2">6.2</a>, <a href="#section-3.8">3.8</a>, and <a href="#section-7.1">7.1</a> of [<a href="rfc5475.html" title='"Sampling and Filtering Techniques for IP Packet Selection"'>RFC5475</a>].

   Abstract Data Type:  unsigned64

   Data Type Semantics:  quantity





<span class="grey">Dietz, et al.               Standards Track                    [Page 15]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-16" id="page-16" name="page-16"> </a>
<span class="grey"><a href="rfc5477.html">RFC 5477</a>                PSAMP Information Model               March 2009</span>


   ElementId:  329

   Status:  current

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/8.3.5.%20%20hashOutputRangeMax"></a><a class="selflink" href="#section-8.3.5" name="section-8.3.5">8.3.5</a>.  hashOutputRangeMax</span>

   Description:

      This Information Element specifies the value for the end of a hash
      function's potential output range.

      See also Sections <a href="#section-6.2">6.2</a>, <a href="#section-3.8">3.8</a>, and <a href="#section-7.1">7.1</a> of [<a href="rfc5475.html" title='"Sampling and Filtering Techniques for IP Packet Selection"'>RFC5475</a>].

   Abstract Data Type:  unsigned64

   Data Type Semantics:  quantity

   ElementId:  330

   Status:  current

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/8.3.6.%20%20hashSelectedRangeMin"></a><a class="selflink" href="#section-8.3.6" name="section-8.3.6">8.3.6</a>.  hashSelectedRangeMin</span>

   Description:

      This Information Element specifies the value for the beginning of
      a hash function's selected range.

      See also Sections <a href="#section-6.2">6.2</a>, <a href="#section-3.8">3.8</a>, and <a href="#section-7.1">7.1</a> of [<a href="rfc5475.html" title='"Sampling and Filtering Techniques for IP Packet Selection"'>RFC5475</a>].

   Abstract Data Type:  unsigned64

   Data Type Semantics:  quantity

   ElementId:  331

   Status:  current

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/8.3.7.%20%20hashSelectedRangeMax"></a><a class="selflink" href="#section-8.3.7" name="section-8.3.7">8.3.7</a>.  hashSelectedRangeMax</span>

   Description:

      This Information Element specifies the value for the end of a hash
      function's selected range.

      See also Sections <a href="#section-6.2">6.2</a>, <a href="#section-3.8">3.8</a>, and <a href="#section-7.1">7.1</a> of [<a href="rfc5475.html" title='"Sampling and Filtering Techniques for IP Packet Selection"'>RFC5475</a>].

   Abstract Data Type:  unsigned64



<span class="grey">Dietz, et al.               Standards Track                    [Page 16]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-17" id="page-17" name="page-17"> </a>
<span class="grey"><a href="rfc5477.html">RFC 5477</a>                PSAMP Information Model               March 2009</span>


   Data Type Semantics:  quantity

   ElementId:  332

   Status:  current

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/8.3.8.%20%20hashDigestOutput"></a><a class="selflink" href="#section-8.3.8" name="section-8.3.8">8.3.8</a>.  hashDigestOutput</span>

   Description:

      This Information Element contains a boolean value that is TRUE if
      the output from this hash Selector has been configured to be
      included in the packet report as a packet digest, else FALSE.

      See also Sections <a href="#section-6.2">6.2</a>, <a href="#section-3.8">3.8</a>, and <a href="#section-7.1">7.1</a> of [<a href="rfc5475.html" title='"Sampling and Filtering Techniques for IP Packet Selection"'>RFC5475</a>].

   Abstract Data Type:  boolean

   Data Type Semantics:  quantity

   ElementId:  333

   Status:  current

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/8.3.9.%20%20hashInitialiserValue"></a><a class="selflink" href="#section-8.3.9" name="section-8.3.9">8.3.9</a>.  hashInitialiserValue</span>

   Description:

      This Information Element specifies the initialiser value to the
      hash function.

      See also Sections <a href="#section-6.2">6.2</a>, <a href="#section-3.8">3.8</a>, and <a href="#section-7.1">7.1</a> of [<a href="rfc5475.html" title='"Sampling and Filtering Techniques for IP Packet Selection"'>RFC5475</a>].

   Abstract Data Type:  unsigned64

   Data Type Semantics:  quantity

   ElementId:  334

   Status:  current











<span class="grey">Dietz, et al.               Standards Track                    [Page 17]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-18" id="page-18" name="page-18"> </a>
<span class="grey"><a href="rfc5477.html">RFC 5477</a>                PSAMP Information Model               March 2009</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/8.4.%20%20Timestamps%20%28322-325%29"></a><a class="selflink" href="#section-8.4" name="section-8.4">8.4</a>.  Timestamps (322-325)</span>

   The Information Elements listed below contain timestamps.  They can
   be used for reporting the observation time of a single packet.

 +-----+----------------------------+-----+----------------------------+
 |  ID | Name                       |  ID | Name                       |
 +-----+----------------------------+-----+----------------------------+
 | 322 | observationTimeSeconds     | 324 | observationTimeMicroseconds|
 | 323 | observationTimeMilliseconds| 325 | observationTimeNanoseconds |
 +-----+----------------------------+-----+----------------------------+

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/8.4.1.%20%20observationTimeSeconds"></a><a class="selflink" href="#section-8.4.1" name="section-8.4.1">8.4.1</a>.  observationTimeSeconds</span>

   Description:

      This Information Element specifies the absolute time in seconds of
      an observation.

   Abstract Data Type:  dateTimeSeconds

   Data Type Semantics:  quantity

   ElementId:  322

   Status:  current

   Units:  seconds

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/8.4.2.%20%20observationTimeMilliseconds"></a><a class="selflink" href="#section-8.4.2" name="section-8.4.2">8.4.2</a>.  observationTimeMilliseconds</span>

   Description:

      This Information Element specifies the absolute time in
      milliseconds of an observation.

   Abstract Data Type:  dateTimeMilliseconds

   Data Type Semantics:  quantity

   ElementId:  323

   Status:  current

   Units:  milliseconds






<span class="grey">Dietz, et al.               Standards Track                    [Page 18]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-19" id="page-19" name="page-19"> </a>
<span class="grey"><a href="rfc5477.html">RFC 5477</a>                PSAMP Information Model               March 2009</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/8.4.3.%20%20observationTimeMicroseconds"></a><a class="selflink" href="#section-8.4.3" name="section-8.4.3">8.4.3</a>.  observationTimeMicroseconds</span>

   Description:

      This Information Element specifies the absolute time in
      microseconds of an observation.

   Abstract Data Type:  dateTimeMicroseconds

   Data Type Semantics:  quantity

   ElementId:  324

   Status:  current

   Units:  microseconds

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/8.4.4.%20%20observationTimeNanoseconds"></a><a class="selflink" href="#section-8.4.4" name="section-8.4.4">8.4.4</a>.  observationTimeNanoseconds</span>

   Description:

      This Information Element specifies the absolute time in
      nanoseconds of an observation.

   Abstract Data Type:  dateTimeNanoseconds

   Data Type Semantics:  quantity

   ElementId:  325

   Status:  current

   Units:  nanoseconds

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/8.5.%20%20Packet%20Data%20%28313-314%2C%20316-317%29"></a><a class="selflink" href="#section-8.5" name="section-8.5">8.5</a>.  Packet Data (313-314, 316-317)</span>

   The following Information Elements are all used for reporting raw
   content of a packet.  All Information Elements containing sections of
   the observed packet can also be used in IPFIX [<a href="rfc5101.html" title='"Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of IP Traffic Flow Information"'>RFC5101</a>].  If the
   values for those sections vary for different packets in a Flow, then
   the Flow Report will contain the value observed in the first packet
   of the Flow.









<span class="grey">Dietz, et al.               Standards Track                    [Page 19]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-20" id="page-20" name="page-20"> </a>
<span class="grey"><a href="rfc5477.html">RFC 5477</a>                PSAMP Information Model               March 2009</span>


 +-----+----------------------------+-----+----------------------------+
 |  ID | Name                       |  ID | Name                       |
 +-----+----------------------------+-----+----------------------------+
 | 313 | ipHeaderPacketSection      | 316 | mplsLabelStackSection      |
 | 314 | ipPayloadPacketSection     | 317 | mplsPayloadPacketSection   |
 +-----+----------------------------+-----+----------------------------+

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/8.5.1.%20%20ipHeaderPacketSection"></a><a class="selflink" href="#section-8.5.1" name="section-8.5.1">8.5.1</a>.  ipHeaderPacketSection</span>

   Description:

      This Information Element, which may have a variable length,
      carries a series of octets from the start of the IP header of a
      sampled packet.

      With sufficient length, this element also reports octets from the
      IP payload, subject to [<a href="rfc2804.html" title='"IETF Policy on Wiretapping"'>RFC2804</a>].  See the Security Considerations
      section.

      The size of the exported section may be constrained due to
      limitations in the IPFIX protocol.

      The data for this field MUST NOT be padded.

   Abstract Data Type:  octetArray

   ElementId:  313

   Status:  current

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/8.5.2.%20%20ipPayloadPacketSection"></a><a class="selflink" href="#section-8.5.2" name="section-8.5.2">8.5.2</a>.  ipPayloadPacketSection</span>

   Description:

      This Information Element, which may have a variable length,
      carries a series of octets from the start of the IP payload of a
      sampled packet.

      The IPv4 payload is that part of the packet that follows the IPv4
      header and any options, which [<a href="http://tools.ietf.org/html/rfc0791" title='"Internet Protocol"'>RFC0791</a>] refers to as "data" or
      "data octets".  For example, see the examples in <a href="http://tools.ietf.org/html/rfc0791#appendix-A">[RFC0791],
      Appendix A</a>.

      The IPv6 payload is the rest of the packet following the 40-octet
      IPv6 header.  Note that any extension headers present are
      considered part of the payload.  See [<a href="rfc2460.html" title='"Internet Protocol, Version 6 (IPv6) Specification"'>RFC2460</a>] for the IPv6
      specification.




<span class="grey">Dietz, et al.               Standards Track                    [Page 20]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-21" id="page-21" name="page-21"> </a>
<span class="grey"><a href="rfc5477.html">RFC 5477</a>                PSAMP Information Model               March 2009</span>


      The size of the exported section may be constrained due to
      limitations in the IPFIX protocol.

      The data for this field MUST NOT be padded.

   Abstract Data Type:  octetArray

   ElementId:  314

   Status:  current

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/8.5.3.%20%20mplsLabelStackSection"></a><a class="selflink" href="#section-8.5.3" name="section-8.5.3">8.5.3</a>.  mplsLabelStackSection</span>

   Description:

      This Information Element, which may have a variable length,
      carries the first n octets from the MPLS label stack of a sampled
      packet.

      With sufficient length, this element also reports octets from the
      MPLS payload, subject to [<a href="rfc2804.html" title='"IETF Policy on Wiretapping"'>RFC2804</a>].  See the Security
      Considerations section.

      See [<a href="rfc3031.html" title='"Multiprotocol Label Switching Architecture"'>RFC3031</a>] for the specification of MPLS packets.

      See [<a href="rfc3032.html" title='"MPLS Label Stack Encoding"'>RFC3032</a>] for the specification of the MPLS label stack.

      The size of the exported section may be constrained due to
      limitations in the IPFIX protocol.

      The data for this field MUST NOT be padded.

   Abstract Data Type:  octetArray

   ElementId:  316

   Status:  current

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/8.5.4.%20%20mplsPayloadPacketSection"></a><a class="selflink" href="#section-8.5.4" name="section-8.5.4">8.5.4</a>.  mplsPayloadPacketSection</span>

   Description:

      This Information Element, which may have a variable length,
      carries the first n octets from the MPLS payload of a sampled
      packet, being data that follows immediately after the MPLS label
      stack.

      See [<a href="rfc3031.html" title='"Multiprotocol Label Switching Architecture"'>RFC3031</a>] for the specification of MPLS packets.



<span class="grey">Dietz, et al.               Standards Track                    [Page 21]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-22" id="page-22" name="page-22"> </a>
<span class="grey"><a href="rfc5477.html">RFC 5477</a>                PSAMP Information Model               March 2009</span>


      See [<a href="rfc3032.html" title='"MPLS Label Stack Encoding"'>RFC3032</a>] for the specification of the MPLS label stack.

      The size of the exported section may be constrained due to
      limitations in the IPFIX protocol.

      The data for this field MUST NOT be padded.

   Abstract Data Type:  octetArray

   ElementId:  317

   Status:  current

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/8.6.%20%20Statistics%20%28318-321%2C%20336-338%29"></a><a class="selflink" href="#section-8.6" name="section-8.6">8.6</a>.  Statistics (318-321, 336-338)</span>

   Information Elements in this section can be used for reporting
   statistics from the Metering Process.

 +-----+----------------------------+-----+----------------------------+
 |  ID | Name                       |  ID | Name                       |
 +-----+----------------------------+-----+----------------------------+
 | 318 | selectorIdTotalPktsObserved| 336 | upperCILimit               |
 | 319 | selectorIdTotalPktsSelected| 337 | lowerCILimit               |
 | 320 | absoluteError              | 338 | confidenceLevel            |
 | 321 | relativeError              |     |                            |
 +-----+----------------------------+-----+----------------------------+

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/8.6.1.%20%20selectorIdTotalPktsObserved"></a><a class="selflink" href="#section-8.6.1" name="section-8.6.1">8.6.1</a>.  selectorIdTotalPktsObserved</span>

   Description:

      This Information Element specifies the total number of packets
      observed by a Selector, for a specific value of SelectorId.

      This Information Element should be used in an Options Template
      scoped to the observation to which it refers.  See <a href="#section-3.4.2.1">Section 3.4.2.1</a>
      of the IPFIX protocol document [<a href="rfc5101.html" title='"Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of IP Traffic Flow Information"'>RFC5101</a>].

   Abstract Data Type:  unsigned64

   Data Type Semantics:  totalCounter

   ElementId:  318

   Status:  current

   Units:  packets




<span class="grey">Dietz, et al.               Standards Track                    [Page 22]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-23" id="page-23" name="page-23"> </a>
<span class="grey"><a href="rfc5477.html">RFC 5477</a>                PSAMP Information Model               March 2009</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/8.6.2.%20%20selectorIdTotalPktsSelected"></a><a class="selflink" href="#section-8.6.2" name="section-8.6.2">8.6.2</a>.  selectorIdTotalPktsSelected</span>

   Description:

      This Information Element specifies the total number of packets
      selected by a Selector, for a specific value of SelectorId.

      This Information Element should be used in an Options Template
      scoped to the observation to which it refers.  See <a href="#section-3.4.2.1">Section 3.4.2.1</a>
      of the IPFIX protocol document [<a href="rfc5101.html" title='"Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of IP Traffic Flow Information"'>RFC5101</a>].

   Abstract Data Type:  unsigned64

   Data Type Semantics:  totalCounter

   ElementId:  319

   Status:  current

   Units:  packets

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/8.6.3.%20%20absoluteError"></a><a class="selflink" href="#section-8.6.3" name="section-8.6.3">8.6.3</a>.  absoluteError</span>

   Description:

      This Information Element specifies the maximum possible
      measurement error of the reported value for a given Information
      Element.  The absoluteError has the same unit as the Information
      Element with which it is associated.  The real value of the metric
      can differ by absoluteError (positive or negative) from the
      measured value.

      This Information Element provides only the error for measured
      values.  If an Information Element contains an estimated value
      (from Sampling), the confidence boundaries and confidence level
      have to be provided instead, using the upperCILimit, lowerCILimit,
      and confidenceLevel Information Elements.

      This Information Element should be used in an Options Template
      scoped to the observation to which it refers.  See <a href="#section-3.4.2.1">section 3.4.2.1</a>
      of the IPFIX protocol document [<a href="rfc5101.html" title='"Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of IP Traffic Flow Information"'>RFC5101</a>].

   Abstract Data Type:  float64

   Data Type Semantics:  quantity

   ElementId:  320




<span class="grey">Dietz, et al.               Standards Track                    [Page 23]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-24" id="page-24" name="page-24"> </a>
<span class="grey"><a href="rfc5477.html">RFC 5477</a>                PSAMP Information Model               March 2009</span>


   Status:  current

   Units:  The units of the Information Element for which the error is
      specified.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/8.6.4.%20%20relativeError"></a><a class="selflink" href="#section-8.6.4" name="section-8.6.4">8.6.4</a>.  relativeError</span>

   Description:

      This Information Element specifies the maximum possible positive
      or negative error ratio for the reported value for a given
      Information Element as a percentage of the measured value.  The
      real value of the metric can differ by relativeError percent
      (positive or negative) from the measured value.

      This Information Element provides only the error for measured
      values.  If an Information Element contains an estimated value
      (from Sampling), the confidence boundaries and confidence level
      have to be provided instead, using the upperCILimit, lowerCILimit,
      and confidenceLevel Information Elements.

      This Information Element should be used in an Options Template
      scoped to the observation to which it refers.  See <a href="#section-3.4.2.1">Section 3.4.2.1</a>
      of the IPFIX protocol document [<a href="rfc5101.html" title='"Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of IP Traffic Flow Information"'>RFC5101</a>].

   Abstract Data Type:  float64

   Data Type Semantics:  quantity

   ElementId:  321

   Status:  current

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/8.6.5.%20%20upperCILimit"></a><a class="selflink" href="#section-8.6.5" name="section-8.6.5">8.6.5</a>.  upperCILimit</span>

   Description:

      This Information Element specifies the upper limit of a confidence
      interval.  It is used to provide an accuracy statement for an
      estimated value.  The confidence limits define the range in which
      the real value is assumed to be with a certain probability p.
      Confidence limits always need to be associated with a confidence
      level that defines this probability p.  Please note that a
      confidence interval only provides a probability that the real
      value lies within the limits.  That means the real value can lie
      outside the confidence limits.





<span class="grey">Dietz, et al.               Standards Track                    [Page 24]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-25" id="page-25" name="page-25"> </a>
<span class="grey"><a href="rfc5477.html">RFC 5477</a>                PSAMP Information Model               March 2009</span>


      The upperCILimit, lowerCILimit, and confidenceLevel Information
      Elements should all be used in an Options Template scoped to the
      observation to which they refer.  See <a href="#section-3.4.2.1">Section 3.4.2.1</a> of the IPFIX
      protocol document [<a href="rfc5101.html" title='"Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of IP Traffic Flow Information"'>RFC5101</a>].

      Note that the upperCILimit, lowerCILimit, and confidenceLevel are
      all required to specify confidence, and should be disregarded
      unless all three are specified together.

   Abstract Data Type:  float64

   Data Type Semantics:  quantity

   ElementId:  336

   Status:  current

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/8.6.6.%20%20lowerCILimit"></a><a class="selflink" href="#section-8.6.6" name="section-8.6.6">8.6.6</a>.  lowerCILimit</span>

   Description:

      This Information Element specifies the lower limit of a confidence
      interval.  For further information, see the description of
      upperCILimit.

      The upperCILimit, lowerCILimit, and confidenceLevel Information
      Elements should all be used in an Options Template scoped to the
      observation to which they refer.  See <a href="#section-3.4.2.1">Section 3.4.2.1</a> of the IPFIX
      protocol document [<a href="rfc5101.html" title='"Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of IP Traffic Flow Information"'>RFC5101</a>].

      Note that the upperCILimit, lowerCILimit, and confidenceLevel are
      all required to specify confidence, and should be disregarded
      unless all three are specified together.

   Abstract Data Type:  float64

   Data Type Semantics:  quantity

   ElementId:  337

   Status:  current










<span class="grey">Dietz, et al.               Standards Track                    [Page 25]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-26" id="page-26" name="page-26"> </a>
<span class="grey"><a href="rfc5477.html">RFC 5477</a>                PSAMP Information Model               March 2009</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/8.6.7.%20%20confidenceLevel"></a><a class="selflink" href="#section-8.6.7" name="section-8.6.7">8.6.7</a>.  confidenceLevel</span>

   Description:

      This Information Element specifies the confidence level.  It is
      used to provide an accuracy statement for estimated values.  The
      confidence level provides the probability p with which the real
      value lies within a given range.  A confidence level always needs
      to be associated with confidence limits that define the range in
      which the real value is assumed to be.

      The upperCILimit, lowerCILimit, and confidenceLevel Information
      Elements should all be used in an Options Template scoped to the
      observation to which they refer.  See <a href="#section-3.4.2.1">Section 3.4.2.1</a> of the IPFIX
      protocol document [<a href="rfc5101.html" title='"Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of IP Traffic Flow Information"'>RFC5101</a>].

      Note that the upperCILimit, lowerCILimit, and confidenceLevel are
      all required to specify confidence, and should be disregarded
      unless all three are specified together.

   Abstract Data Type:  float64

   Data Type Semantics:  quantity

   ElementId:  338

   Status:  current

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/9.%20%20Security%20Considerations"></a><a class="selflink" href="#section-9" name="section-9">9</a>.  Security Considerations</span>

   The PSAMP information model itself does not directly introduce
   security issues.  Rather, it defines a set of attributes that may for
   privacy or business issues be considered sensitive information.

   For example, exporting values of header fields may make attacks
   possible for the receiver of this information, which would otherwise
   only be possible for direct observers of the reported Flows along the
   data path.  Specifically, the Information Elements pertaining to
   packet sections MUST target no more than the packet header, some
   subsequent bytes of the packet, and encapsulating headers if present.
   Full packet capture of arbitrary packet streams is explicitly out of
   scope, per [<a href="rfc2804.html" title='"IETF Policy on Wiretapping"'>RFC2804</a>].

   The underlying protocol used to exchange the information described
   here MUST therefore apply appropriate procedures to guarantee the
   integrity and confidentiality of the exported information.  Such
   procedures are defined in separate documents, specifically the IPFIX
   protocol document [<a href="rfc5101.html" title='"Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of IP Traffic Flow Information"'>RFC5101</a>].



<span class="grey">Dietz, et al.               Standards Track                    [Page 26]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-27" id="page-27" name="page-27"> </a>
<span class="grey"><a href="rfc5477.html">RFC 5477</a>                PSAMP Information Model               March 2009</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/10.%20%20IANA%20Considerations"></a><a class="selflink" href="#section-10" name="section-10">10</a>.  IANA Considerations</span>

   The PSAMP information model, as set out in this document, has two
   sets of assigned numbers.  Considerations for assigning them are
   discussed in this section, using the example policies as set out in
   the "Guidelines for IANA Considerations" document [<a href="rfc5226.html" title='"Guidelines for Writing an IANA Considerations Section in RFCs"'>RFC5226</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/10.1.%20%20Related%20Considerations"></a><a class="selflink" href="#section-10.1" name="section-10.1">10.1</a>.  Related Considerations</span>

   As the PSAMP protocol uses the IPFIX protocol, refer to the IANA
   Considerations section in [<a href="rfc5102.html" title='"Information Model for IP Flow Information Export"'>RFC5102</a>] for the assignments of numbers
   used in the protocol and for the numbers used in the information
   model.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/10.2.%20%20PSAMP-Related%20Considerations"></a><a class="selflink" href="#section-10.2" name="section-10.2">10.2</a>.  PSAMP-Related Considerations</span>

   This document specifies an initial set of PSAMP Information Elements
   fulfilling the needs specified in [<a href="rfc5475.html" title='"Sampling and Filtering Techniques for IP Packet Selection"'>RFC5475</a>], as an extension to the
   IPFIX Information Elements [<a href="rfc5102.html" title='"Information Model for IP Flow Information Export"'>RFC5102</a>].

   Note that the PSAMP Information Element IDs were initially started at
   value 301, in order to leave a gap for any ongoing IPFIX work
   requiring new Information Elements.  It is expected that this gap in
   the Information Element numbering will be filled in by IANA with new
   IPFIX Information Elements.

   Each new selection method MUST be assigned a unique value in the
   selectorAlgorithm registry.  Its configuration parameter(s), along
   with the way to report them with an Options Template, MUST be clearly
   specified.  The initial content of the selectorAlgorithm registry is
   found in <a href="#section-8.2.1">Section 8.2.1</a>.

   New assignments for the PSAMP selection method will be administered
   by IANA and are subject to Expert Review [<a href="rfc5226.html" title='"Guidelines for Writing an IANA Considerations Section in RFCs"'>RFC5226</a>].  The group of
   experts must double check the Information Elements definitions with
   already defined Information Elements for completeness, accuracy, and
   redundancy.  Those experts will initially be drawn from the Working
   Group Chairs and document editors of the IPFIX and PSAMP Working
   Groups.  The selectorAlgorithm registry is maintained by IANA and can
   be updated as long as specifications of the new method(s) and any new
   Information Elements are provided.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/11.%20%20References"></a><a class="selflink" href="#section-11" name="section-11">11</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/11.1.%20%20Normative%20References"></a><a class="selflink" href="#section-11.1" name="section-11.1">11.1</a>.  Normative References</span>

   [<a id="ref-RFC2119" name="ref-RFC2119">RFC2119</a>]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="http://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.



<span class="grey">Dietz, et al.               Standards Track                    [Page 27]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-28" id="page-28" name="page-28"> </a>
<span class="grey"><a href="rfc5477.html">RFC 5477</a>                PSAMP Information Model               March 2009</span>


   [<a id="ref-RFC5226" name="ref-RFC5226">RFC5226</a>]  Narten, T. and H. Alvestrand, "Guidelines for Writing an
              IANA Considerations Section in RFCs", <a href="http://tools.ietf.org/html/bcp26">BCP 26</a>, <a href="rfc5226.html">RFC 5226</a>,
              May 2008.

   [<a id="ref-RFC5101" name="ref-RFC5101">RFC5101</a>]  Claise, B., "Specification of the IP Flow Information
              Export (IPFIX) Protocol for the Exchange of IP Traffic
              Flow Information", <a href="rfc5101.html">RFC 5101</a>, January 2008.

   [<a id="ref-RFC5102" name="ref-RFC5102">RFC5102</a>]  Quittek, J., Bryant, S., Claise, B., Aitken, P., and J.
              Meyer, "Information Model for IP Flow Information Export",
              <a href="rfc5102.html">RFC 5102</a>, January 2008.

   [<a id="ref-RFC5475" name="ref-RFC5475">RFC5475</a>]  Zseby, T., Molina, M., Duffield, D., Niccolini, S., and F.
              Rapall, "Sampling and Filtering Techniques for IP Packet
              Selection", <a href="rfc5475.html">RFC 5475</a>, March 2009.

   [<a id="ref-RFC5476" name="ref-RFC5476">RFC5476</a>]  Claise, B., Ed., "Packet Sampling (PSAMP) Protocol
              Specifications", <a href="rfc5476.html">RFC 5476</a>, March 2009.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/11.2.%20%20Informative%20References"></a><a class="selflink" href="#section-11.2" name="section-11.2">11.2</a>.  Informative References</span>

   [<a id="ref-RFC0791" name="ref-RFC0791">RFC0791</a>]  Postel, J., "Internet Protocol", STD 5, <a href="rfc791.html">RFC 791</a>,
              September 1981.

   [<a id="ref-RFC2460" name="ref-RFC2460">RFC2460</a>]  Deering, S. and R. Hinden, "Internet Protocol, Version 6
              (IPv6) Specification", <a href="rfc2460.html">RFC 2460</a>, December 1998.

   [<a id="ref-RFC2629" name="ref-RFC2629">RFC2629</a>]  Rose, M., "Writing I-Ds and RFCs using XML", <a href="rfc2629.html">RFC 2629</a>,
              June 1999.

   [<a id="ref-RFC2804" name="ref-RFC2804">RFC2804</a>]  IAB and IESG, "IETF Policy on Wiretapping", <a href="rfc2804.html">RFC 2804</a>,
              May 2000.

   [<a id="ref-RFC3031" name="ref-RFC3031">RFC3031</a>]  Rosen, E., Viswanathan, A., and R. Callon, "Multiprotocol
              Label Switching Architecture", <a href="rfc3031.html">RFC 3031</a>, January 2001.

   [<a id="ref-RFC3032" name="ref-RFC3032">RFC3032</a>]  Rosen, E., Tappan, D., Fedorkow, G., Rekhter, Y.,
              Farinacci, D., Li, T., and A. Conta, "MPLS Label Stack
              Encoding", <a href="rfc3032.html">RFC 3032</a>, January 2001.

   [<a id="ref-RFC5474" name="ref-RFC5474">RFC5474</a>]  Duffield, N., Ed., "A Framework for Packet Selection and
              Reporting", <a href="rfc5474.html">RFC 5474</a>, March 2009.









<span class="grey">Dietz, et al.               Standards Track                    [Page 28]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-29" id="page-29" name="page-29"> </a>
<span class="grey"><a href="rfc5477.html">RFC 5477</a>                PSAMP Information Model               March 2009</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/Appendix%20A.%20%20Formal%20Specification%20of%20PSAMP%20Information%20Elements"></a><a class="selflink" href="#appendix-A" name="appendix-A">Appendix A</a>.  Formal Specification of PSAMP Information Elements</span>

   This appendix contains a formal description of the PSAMP information
   model XML document.  Note that this appendix is of informational
   nature, while the text in <a href="#section-8">Section 8</a> generated from this appendix is
   normative.

   Using a formal and machine-readable syntax for the information model
   enables the creation of PSAMP-aware tools that can automatically
   adapt to extensions to the information model, by simply reading
   updated information model specifications.

   The wide availability of XML-aware tools and libraries for client
   devices is a primary consideration for this choice.  In particular,
   libraries for parsing XML documents are readily available.  Also,
   mechanisms such as the Extensible Stylesheet Language (XSL) allow for
   transforming a source XML document into other documents.  This draft
   was authored in XML and transformed according to [<a href="rfc2629.html" title='"Writing I-Ds and RFCs using XML"'>RFC2629</a>].

   It should be noted that the use of XML in Exporters, Collectors, or
   other tools is not mandatory for the deployment of PSAMP.  In
   particular, exporting processes do not produce or consume XML as part
   of their operation.  It is expected that PSAMP Collectors MAY take
   advantage of the machine readability of the information model vs.
   hardcoding their behavior or inventing proprietary means for
   accommodating extensions.

&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!--
  This XML document is a product of the IETF IPFIX Working Group.
  Contact information:
    WG charter:
      <a href="http://www.ietf.org/html.charters/ipfix-charter.html">http://www.ietf.org/html.charters/ipfix-charter.html</a>

    Mailing Lists:
      General Discussion: ipfix@ietf.org
      To Subscribe: <a href="http://www1.ietf.org/mailman/listinfo/ipfix">http://www1.ietf.org/mailman/listinfo/ipfix</a>
      Archive:
        <a href="http://www1.ietf.org/mail-archive/web/ipfix/current/index.html">http://www1.ietf.org/mail-archive/web/ipfix/current/index.html</a>

    Editor:
      Thomas Dietz
      NEC Europe Ltd.
      NEC Laboratories Europe
      Network Research Division
      Kurfuersten-Anlage 36
      Heidelberg 69115
      Germany



<span class="grey">Dietz, et al.               Standards Track                    [Page 29]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-30" id="page-30" name="page-30"> </a>
<span class="grey"><a href="rfc5477.html">RFC 5477</a>                PSAMP Information Model               March 2009</span>


      Phone: +49 6221 4342-128
      Email: Thomas.Dietz@nw.neclab.eu

      Benoit Claise
      Cisco Systems, Inc.
      De Kleetlaan 6a b1
      Degem  1813
      Belgium
      Phone: +32 2 704 5622
      Email: bclaise@cisco.com

      Paul Aitken
      Cisco Systems, Inc.
      96 Commercial Quay
      Edinburgh  EH6 6LX
      Scotland
      Phone: +44 131 561 3616
      Email: paitken@cisco.com
      URI: <a href="http://www.cisco.com/">http://www.cisco.com</a>

      Falko Dressler
      University of Erlangen-Nuremberg
      Dept. of Computer Sciences
      Martensstr. 3
      Erlangen  91058
      Germany
      Phone: +49 9131 85-27914
      Email: dressler@informatik.uni-erlangen.de
      URI: <a href="http://www7.informatik.uni-erlangen.de/~dressler">http://www7.informatik.uni-erlangen.de/~dressler</a>

      Georg Carle
      Technical University of Munich
      Institute for Informatics
      Boltzmannstr. 3
      Garching bei Muenchen  85737
      Germany
      Phone: +49 89 289-18030
      EMail: carle@in.tum.de
      URI: <a href="http://www.net.in.tum.de/~carle/">http://www.net.in.tum.de/~carle/</a>

  Abstract:
   This memo defines an information model for the Packet SAMPling
   (PSAMP) protocol.  It is used by the PSAMP protocol for encoding
   sampled packet data and information related to the Sampling process.
   As the PSAMP protocol is based on the IPFIX protocol, this
   information model is an extension to the IPFIX information model.





<span class="grey">Dietz, et al.               Standards Track                    [Page 30]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-31" id="page-31" name="page-31"> </a>
<span class="grey"><a href="rfc5477.html">RFC 5477</a>                PSAMP Information Model               March 2009</span>


   Copyright (c) 2009 IETF Trust and the persons identified as
   authors of the code.  All rights reserved.

   Redistribution and use in source and binary forms, with or without
   modification, are permitted provided that the following conditions
   are met:

   - Redistributions of source code must retain the above copyright
     notice, this list of conditions and the following disclaimer.

   - Redistributions in binary form must reproduce the above copyright
     notice, this list of conditions and the following disclaimer in
     the documentation and/or other materials provided with the
     distribution.

   - Neither the name of Internet Society, IETF or IETF Trust, nor the
     names of specific contributors, may be used to endorse or promote
     products derived from this software without specific prior
     written permission.

   THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
   'AS IS' AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
   LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
   A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
   OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
   SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
   LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
   DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
   THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
   (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
   OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

   This version of the XML document is part of <a href="rfc5477.html">RFC 5477</a>;
   see the RFC itself for full legal notices.
--&gt;
&lt;fieldDefinitions xmlns="urn:ietf:params:xml:ns:ipfix-info"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="urn:ietf:params:xml:ns:ipfix-info
             ipfix-info.xsd"&gt;
  &lt;field name="selectionSequenceId" dataType="unsigned64"
    dataTypeSemantics="identifier" elementId="301" status="current"
    group="identifiers"&gt;
    &lt;description&gt;
      &lt;paragraph&gt;
        From all the packets observed at an Observation Point, a subset
        of the packets is selected by a sequence of one or more
        Selectors.  The selectionSequenceId is a unique value per
        Observation Domain, specifying the Observation Point and the



<span class="grey">Dietz, et al.               Standards Track                    [Page 31]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-32" id="page-32" name="page-32"> </a>
<span class="grey"><a href="rfc5477.html">RFC 5477</a>                PSAMP Information Model               March 2009</span>


        sequence of Selectors through which the packets are selected.
      &lt;/paragraph&gt;
    &lt;/description&gt;
  &lt;/field&gt;

  &lt;field name="selectorId" dataType="unsigned16"
    dataTypeSemantics="identifier" elementId="302" status="current"
    group="identifiers"&gt;
    &lt;description&gt;
      &lt;paragraph&gt;
        The Selector ID is the unique ID identifying a Primitive
        Selector.  Each Primitive Selector must have a unique ID in the
        Observation Domain.
      &lt;/paragraph&gt;
    &lt;/description&gt;
  &lt;/field&gt;

  &lt;field name="informationElementId" dataType="unsigned16"
    dataTypeSemantics="identifier" elementId="303" status="current"
    group="identifiers"&gt;
    &lt;description&gt;
      &lt;paragraph&gt;
        This Information Element contains the ID of another Information
        Element.
      &lt;/paragraph&gt;
    &lt;/description&gt;
  &lt;/field&gt;

  &lt;field name="selectorAlgorithm" dataType="unsigned16"
    dataTypeSemantics="identifier" elementId="304" status="current"
    group="sampling configuration"&gt;
    &lt;description&gt;
      &lt;paragraph&gt;
        This Information Element identifies the packet selection
        methods (e.g., Filtering, Sampling) that are applied by
        the Selection Process.

        Most of these methods have parameters.  Further
        Information Elements are needed to fully specify packet
        selection with these methods and all their parameters.

        The methods listed below are defined in
        [<a href="rfc5475.html" title='"Sampling and Filtering Techniques for IP Packet Selection"'>RFC5475</a>].  For their parameters,
        Information Elements are defined in the information model
        document.  The names of these Information Elements are
        listed for each method identifier.





<span class="grey">Dietz, et al.               Standards Track                    [Page 32]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-33" id="page-33" name="page-33"> </a>
<span class="grey"><a href="rfc5477.html">RFC 5477</a>                PSAMP Information Model               March 2009</span>


        Further method identifiers may be added to the list
        below.  It might be necessary to define new Information
        Elements to specify their parameters.

        The selectorAlgorithm registry is maintained by IANA.  New
        assignments for the registry will be administered by IANA
        and are subject to Expert Review [<a href="rfc5226.html" title='"Guidelines for Writing an IANA Considerations Section in RFCs"'>RFC5226</a>].

        The registry can be updated when specifications of the new
        method(s) and any new Information Elements are provided.

        The group of experts must double check the selectorAlgorithm
        definitions and Information Elements with already defined
        selectorAlgorithms and Information Elements for completeness,
        accuracy, and redundancy.  Those experts will initially be drawn
        from the Working Group Chairs and document editors of the IPFIX
        and PSAMP Working Groups.

        The following packet selection methods identifiers are
        defined here:

        +----+------------------------+------------------------+
        | ID |        Method          |      Parameters        |
        +----+------------------------+------------------------+
        | 1  | Systematic count-based | samplingPacketInterval |
        |    | Sampling               | samplingPacketSpace    |
        +----+------------------------+------------------------+
        | 2  | Systematic time-based  | samplingTimeInterval   |
        |    | Sampling               | samplingTimeSpace      |
        +----+------------------------+------------------------+
        | 3  | Random n-out-of-N      | samplingSize           |
        |    | Sampling               | samplingPopulation     |
        +----+------------------------+------------------------+
        | 4  | Uniform probabilistic  | samplingProbability    |
        |    | Sampling               |                        |
        +----+------------------------+------------------------+
        | 5  | Property Match         | no agreed parameters   |
        |    | Filtering              |                        |
        +----+------------------------+------------------------+
        |   Hash-based Filtering      | hashInitialiserValue   |
        +----+------------------------+ hashIPPayloadOffset    |
        | 6  | using BOB              | hashIPPayloadSize      |
        +----+------------------------+ hashSelectedRangeMin   |
        | 7  | using IPSX             | hashSelectedRangeMax   |
        +----+------------------------+ hashOutputRangeMin     |
        | 8  | using CRC              | hashOutputRangeMax     |
        +----+------------------------+------------------------+




<span class="grey">Dietz, et al.               Standards Track                    [Page 33]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-34" id="page-34" name="page-34"> </a>
<span class="grey"><a href="rfc5477.html">RFC 5477</a>                PSAMP Information Model               March 2009</span>


        There is a broad variety of possible parameters that could be
        used for Property Match Filtering (5), but currently there are
        no agreed parameters specified.
      &lt;/paragraph&gt;
    &lt;/description&gt;
  &lt;/field&gt;

  &lt;field name="samplingPacketInterval" dataType="unsigned32"
    dataTypeSemantics="quantity" elementId="305" status="current"
    group="sampling configuration"&gt;
    &lt;description&gt;
      &lt;paragraph&gt;
        This Information Element specifies the number of packets that
        are consecutively sampled.  A value of 100 means that
        100 consecutive packets are sampled.

        For example, this Information Element may be used to describe
        the configuration of a systematic count-based Sampling Selector.
      &lt;/paragraph&gt;
    &lt;/description&gt;
    &lt;units&gt;packets&lt;/units&gt;
  &lt;/field&gt;

  &lt;field name="samplingPacketSpace" dataType="unsigned32"
    dataTypeSemantics="quantity" elementId="306" status="current"
    group="sampling configuration"&gt;
    &lt;description&gt;
      &lt;paragraph&gt;
        This Information Element specifies the number of packets between
        two "samplingPacketInterval"s.  A value of 100 means that the
        next interval starts 100 packets (which are not sampled)
        after the current "samplingPacketInterval" is over.

        For example, this Information Element may be used to describe
        the configuration of a systematic count-based Sampling Selector.
      &lt;/paragraph&gt;
    &lt;/description&gt;
    &lt;units&gt;packets&lt;/units&gt;
  &lt;/field&gt;

  &lt;field name="samplingTimeInterval" dataType="unsigned32"
    dataTypeSemantics="quantity" elementId="307" status="current"
    group="sampling configuration"&gt;
    &lt;description&gt;
      &lt;paragraph&gt;
        This Information Element specifies the time interval in
        microseconds during which all arriving packets are sampled.




<span class="grey">Dietz, et al.               Standards Track                    [Page 34]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-35" id="page-35" name="page-35"> </a>
<span class="grey"><a href="rfc5477.html">RFC 5477</a>                PSAMP Information Model               March 2009</span>


        For example, this Information Element may be used to describe
        the configuration of a systematic time-based Sampling Selector.
      &lt;/paragraph&gt;
    &lt;/description&gt;
    &lt;units&gt;microseconds&lt;/units&gt;
  &lt;/field&gt;

  &lt;field name="samplingTimeSpace" dataType="unsigned32"
    dataTypeSemantics="quantity" elementId="308" status="current"
    group="sampling configuration"&gt;
    &lt;description&gt;
      &lt;paragraph&gt;
        This Information Element specifies the time interval in
        microseconds between two "samplingTimeInterval"s.  A value of 100
        means that the next interval starts 100 microseconds
        (during which no packets are sampled) after the current
        "samplingTimeInterval" is over.

        For example, this Information Element may used to describe the
        configuration of a systematic time-based Sampling Selector.
      &lt;/paragraph&gt;
    &lt;/description&gt;
    &lt;units&gt;microseconds&lt;/units&gt;
  &lt;/field&gt;

  &lt;field name="samplingSize" dataType="unsigned32"
    dataTypeSemantics="quantity" elementId="309" status="current"
    group="sampling configuration"&gt;
    &lt;description&gt;
      &lt;paragraph&gt;
        This Information Element specifies the number of elements taken
        from the parent Population for random Sampling methods.

        For example, this Information Element may be used to describe
        the configuration of a random n-out-of-N Sampling Selector.
      &lt;/paragraph&gt;
    &lt;/description&gt;
    &lt;units&gt;packets&lt;/units&gt;
  &lt;/field&gt;

  &lt;field name="samplingPopulation" dataType="unsigned32"
    dataTypeSemantics="quantity" elementId="310" status="current"
    group="sampling configuration"&gt;
    &lt;description&gt;
      &lt;paragraph&gt;
        This Information Element specifies the number of elements in the
        parent Population for random Sampling methods.




<span class="grey">Dietz, et al.               Standards Track                    [Page 35]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-36" id="page-36" name="page-36"> </a>
<span class="grey"><a href="rfc5477.html">RFC 5477</a>                PSAMP Information Model               March 2009</span>


        For example, this Information Element may be used to describe
        the configuration of a random n-out-of-N Sampling Selector.
      &lt;/paragraph&gt;
    &lt;/description&gt;
    &lt;units&gt;packets&lt;/units&gt;
  &lt;/field&gt;

  &lt;field name="samplingProbability" dataType="float64"
    dataTypeSemantics="quantity" elementId="311" status="current"
    group="sampling configuration"&gt;
    &lt;description&gt;
      &lt;paragraph&gt;
        This Information Element specifies the probability that a packet
        is sampled, expressed as a value between 0 and 1.  The
        probability is equal for every packet.  A value of 0 means no
        packet was sampled since the probability is 0.

        For example, this Information Element may be used to describe
        the configuration of a uniform probabilistic Sampling Selector.
      &lt;/paragraph&gt;
    &lt;/description&gt;
  &lt;/field&gt;

  &lt;field name="ipHeaderPacketSection" dataType="octetArray"
    elementId="313" status="current" group="packet data"&gt;
    &lt;description&gt;
      &lt;paragraph&gt;
        This Information Element, which may have a variable length,
        carries a series of octets from the start of the IP header of a
        sampled packet.

        With sufficient length, this element also reports octets from
        the IP payload, subject to [<a href="rfc2804.html" title='"IETF Policy on Wiretapping"'>RFC2804</a>].  See the Security
        Considerations section.

        The size of the exported section may be constrained due to
        limitations in the IPFIX protocol.

        The data for this field MUST NOT be padded.
      &lt;/paragraph&gt;
    &lt;/description&gt;
  &lt;/field&gt;

  &lt;field name="ipPayloadPacketSection" dataType="octetArray"
    elementId="314" status="current" group="packet data"&gt;
    &lt;description&gt;
      &lt;paragraph&gt;
        This Information Element, which may have a variable length,



<span class="grey">Dietz, et al.               Standards Track                    [Page 36]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-37" id="page-37" name="page-37"> </a>
<span class="grey"><a href="rfc5477.html">RFC 5477</a>                PSAMP Information Model               March 2009</span>


        carries a series of octets from the start of the IP payload of a
        sampled packet.

        The IPv4 payload is that part of the packet that follows the
        IPv4 header and any options, which [<a href="http://tools.ietf.org/html/rfc0791" title='"Internet Protocol"'>RFC0791</a>] refers to as "data"
        or "data octets".  For example, see the examples in <a href="http://tools.ietf.org/html/rfc0791#appendix-A">[RFC0791],
        Appendix A</a>.

        The IPv6 payload is the rest of the packet following the
        40-octet IPv6 header.  Note that any extension headers present
        are considered part of the payload.  See [<a href="rfc2460.html" title='"Internet Protocol, Version 6 (IPv6) Specification"'>RFC2460</a>] for the IPv6
        specification.

        The size of the exported section may be constrained due to
        limitations in the IPFIX protocol.

        The data for this field MUST NOT be padded.
      &lt;/paragraph&gt;
    &lt;/description&gt;
  &lt;/field&gt;

  &lt;field name="mplsLabelStackSection" dataType="octetArray"
    elementId="316" status="current" group="packet data"&gt;
    &lt;description&gt;
      &lt;paragraph&gt;
        This Information Element, which may have a variable length,
        carries the first n octets from the MPLS label stack of a
        sampled packet.

        With sufficient length, this element also reports octets from
        the MPLS payload, subject to [<a href="rfc2804.html" title='"IETF Policy on Wiretapping"'>RFC2804</a>].  See the Security
        Considerations section.

        See [<a href="rfc3031.html" title='"Multiprotocol Label Switching Architecture"'>RFC3031</a>] for the specification of MPLS packets.

        See [<a href="rfc3032.html" title='"MPLS Label Stack Encoding"'>RFC3032</a>] for the specification of the MPLS label stack.

        The size of the exported section may be constrained due to
        limitations in the IPFIX protocol.

        The data for this field MUST NOT be padded.
      &lt;/paragraph&gt;
    &lt;/description&gt;
  &lt;/field&gt;

  &lt;field name="mplsPayloadPacketSection" dataType="octetArray"
    elementId="317" status="current" group="packet data"&gt;
    &lt;description&gt;



<span class="grey">Dietz, et al.               Standards Track                    [Page 37]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-38" id="page-38" name="page-38"> </a>
<span class="grey"><a href="rfc5477.html">RFC 5477</a>                PSAMP Information Model               March 2009</span>


      &lt;paragraph&gt;
        This Information Element, which may have a variable length,
        carries the first n octets from the MPLS payload of a sampled
        packet, being data that follows immediately after the MPLS label
        stack.

        See [<a href="rfc3031.html" title='"Multiprotocol Label Switching Architecture"'>RFC3031</a>] for the specification of MPLS packets.

        See [<a href="rfc3032.html" title='"MPLS Label Stack Encoding"'>RFC3032</a>] for the specification of the MPLS label stack.

        The size of the exported section may be constrained due to
        limitations in the IPFIX protocol.

        The data for this field MUST NOT be padded.
      &lt;/paragraph&gt;
    &lt;/description&gt;
  &lt;/field&gt;

  &lt;field name="selectorIdTotalPktsObserved" dataType="unsigned64"
    dataTypeSemantics="totalCounter" elementId="318" status="current"
    group="statistics"&gt;
    &lt;description&gt;
      &lt;paragraph&gt;
        This Information Element specifies the total number of packets
        observed by a Selector, for a specific value of SelectorId.

        This Information Element should be used in an Options Template
        scoped to the observation to which it refers.
        See <a href="#section-3.4.2.1">Section 3.4.2.1</a> of the IPFIX protocol document [<a href="rfc5101.html" title='"Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of IP Traffic Flow Information"'>RFC5101</a>].
      &lt;/paragraph&gt;
    &lt;/description&gt;
    &lt;units&gt;packets&lt;/units&gt;
  &lt;/field&gt;

  &lt;field name="selectorIdTotalPktsSelected" dataType="unsigned64"
    dataTypeSemantics="totalCounter" elementId="319" status="current"
    group="statistics"&gt;
    &lt;description&gt;
      &lt;paragraph&gt;
        This Information Element specifies the total number of packets
        selected by a Selector, for a specific value of SelectorId.

        This Information Element should be used in an Options Template
        scoped to the observation to which it refers.
        See <a href="#section-3.4.2.1">Section 3.4.2.1</a> of the IPFIX protocol document [<a href="rfc5101.html" title='"Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of IP Traffic Flow Information"'>RFC5101</a>].
        &lt;/paragraph&gt;
    &lt;/description&gt;
    &lt;units&gt;packets&lt;/units&gt;



<span class="grey">Dietz, et al.               Standards Track                    [Page 38]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-39" id="page-39" name="page-39"> </a>
<span class="grey"><a href="rfc5477.html">RFC 5477</a>                PSAMP Information Model               March 2009</span>


  &lt;/field&gt;

  &lt;field name="absoluteError" dataType="float64"
    dataTypeSemantics="quantity" elementId="320" status="current"
    group="statistics"&gt;
    &lt;description&gt;
      &lt;paragraph&gt;
        This Information Element specifies the maximum possible
        measurement error of the reported value for a given Information
        Element.  The absoluteError has the same unit as the Information
        Element with which it is associated.  The real value of the
        metric can differ by absoluteError (positive or negative) from
        the measured value.

        This Information Element provides only the
        error for measured values.  If an Information Element contains
        an estimated value (from Sampling), the confidence boundaries
        and confidence level have to be provided instead, using the
        upperCILimit, lowerCILimit, and confidenceLevel Information
        Elements.

        This Information Element should be used in an Options Template
        scoped to the observation to which it refers.
        See <a href="#section-3.4.2.1">Section 3.4.2.1</a> of the IPFIX protocol document [<a href="rfc5101.html" title='"Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of IP Traffic Flow Information"'>RFC5101</a>].
      &lt;/paragraph&gt;
    &lt;/description&gt;
    &lt;units&gt;
      The units of the Information Element for which the error is
      specified.
    &lt;/units&gt;
  &lt;/field&gt;

  &lt;field name="relativeError" dataType="float64"
    dataTypeSemantics="quantity" elementId="321" status="current"
    group="statistics"&gt;
    &lt;description&gt;
      &lt;paragraph&gt;
        This Information Element specifies the maximum possible positive
        or negative error ratio for the reported value for a given
        Information Element as a percentage of the measured value.
        The real value of the metric can differ by relativeError percent
        (positive or negative) from the measured value.

        This Information Element provides only the error for measured
        values.  If an Information Element contains an estimated value
        (from Sampling), the confidence boundaries and confidence
        level have to be provided instead, using the upperCILimit,
        lowerCILimit, and confidenceLevel Information Elements.



<span class="grey">Dietz, et al.               Standards Track                    [Page 39]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-40" id="page-40" name="page-40"> </a>
<span class="grey"><a href="rfc5477.html">RFC 5477</a>                PSAMP Information Model               March 2009</span>


        This Information Element should be used in an Options Template
        scoped to the observation to which it refers.
        See <a href="#section-3.4.2.1">Section 3.4.2.1</a> of the IPFIX protocol document [<a href="rfc5101.html" title='"Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of IP Traffic Flow Information"'>RFC5101</a>].
      &lt;/paragraph&gt;
    &lt;/description&gt;
  &lt;/field&gt;

  &lt;field name="observationTimeSeconds" dataType="dateTimeSeconds"
    dataTypeSemantics="quantity" elementId="322" status="current"
    group="timestamps"&gt;
    &lt;description&gt;
      &lt;paragraph&gt;
        This Information Element specifies the absolute time in seconds
        of an observation.
      &lt;/paragraph&gt;
    &lt;/description&gt;
    &lt;units&gt;seconds&lt;/units&gt;
  &lt;/field&gt;

  &lt;field name="observationTimeMilliseconds"
    dataType="dateTimeMilliseconds" dataTypeSemantics="quantity"
    elementId="323" status="current" group="timestamps"&gt;
    &lt;description&gt;
      &lt;paragraph&gt;
        This Information Element specifies the absolute time in
        milliseconds of an observation.
      &lt;/paragraph&gt;
    &lt;/description&gt;
    &lt;units&gt;milliseconds&lt;/units&gt;
  &lt;/field&gt;

  &lt;field name="observationTimeMicroseconds"
    dataType="dateTimeMicroseconds" dataTypeSemantics="quantity"
    elementId="324" status="current" group="timestamps"&gt;
    &lt;description&gt;
      &lt;paragraph&gt;
        This Information Element specifies the absolute time in
        microseconds of an observation.
      &lt;/paragraph&gt;
    &lt;/description&gt;
    &lt;units&gt;microseconds&lt;/units&gt;
  &lt;/field&gt;

  &lt;field name="observationTimeNanoseconds"
    dataType="dateTimeNanoseconds" dataTypeSemantics="quantity"
    elementId="325" status="current" group="timestamps"&gt;
    &lt;description&gt;
      &lt;paragraph&gt;



<span class="grey">Dietz, et al.               Standards Track                    [Page 40]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-41" id="page-41" name="page-41"> </a>
<span class="grey"><a href="rfc5477.html">RFC 5477</a>                PSAMP Information Model               March 2009</span>


        This Information Element specifies the absolute time in
        nanoseconds of an observation.
      &lt;/paragraph&gt;
    &lt;/description&gt;
    &lt;units&gt;nanoseconds&lt;/units&gt;
  &lt;/field&gt;

  &lt;field name="digestHashValue" dataType="unsigned64"
    dataTypeSemantics="quantity" elementId="326" status="current"
    group="hash configuration"&gt;
    &lt;description&gt;
      &lt;paragraph&gt;
        This Information Element specifies the value from the digest
        hash function.

        See also Sections <a href="#section-6.2">6.2</a>, <a href="#section-3.8">3.8</a>, and <a href="#section-7.1">7.1</a> of
        [<a href="rfc5475.html" title='"Sampling and Filtering Techniques for IP Packet Selection"'>RFC5475</a>].
      &lt;/paragraph&gt;
    &lt;/description&gt;
  &lt;/field&gt;

  &lt;field name="hashIPPayloadOffset" dataType="unsigned64"
    dataTypeSemantics="quantity" elementId="327" status="current"
    group="hash configuration"&gt;
    &lt;description&gt;
      &lt;paragraph&gt;
        This Information Element specifies the IP payload offset used by
        a Hash-based Selection Selector.

        See also Sections <a href="#section-6.2">6.2</a>, <a href="#section-3.8">3.8</a>, and <a href="#section-7.1">7.1</a> of
        [<a href="rfc5475.html" title='"Sampling and Filtering Techniques for IP Packet Selection"'>RFC5475</a>].
      &lt;/paragraph&gt;
    &lt;/description&gt;
  &lt;/field&gt;

  &lt;field name="hashIPPayloadSize" dataType="unsigned64"
    dataTypeSemantics="quantity" elementId="328" status="current"
    group="hash configuration"&gt;
    &lt;description&gt;
      &lt;paragraph&gt;
        This Information Element specifies the IP payload size used by a
        Hash-based Selection Selector.
        See also Sections <a href="#section-6.2">6.2</a>, <a href="#section-3.8">3.8</a>, and <a href="#section-7.1">7.1</a> of
        [<a href="rfc5475.html" title='"Sampling and Filtering Techniques for IP Packet Selection"'>RFC5475</a>]
      &lt;/paragraph&gt;
    &lt;/description&gt;
  &lt;/field&gt;




<span class="grey">Dietz, et al.               Standards Track                    [Page 41]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-42" id="page-42" name="page-42"> </a>
<span class="grey"><a href="rfc5477.html">RFC 5477</a>                PSAMP Information Model               March 2009</span>


  &lt;field name="hashOutputRangeMin" dataType="unsigned64"
    dataTypeSemantics="quantity" elementId="329" status="current"
    group="hash configuration"&gt;
    &lt;description&gt;
      &lt;paragraph&gt;
        This Information Element specifies the value for the beginning
        of a hash function's potential output range.
        See also Sections <a href="#section-6.2">6.2</a>, <a href="#section-3.8">3.8</a>, and <a href="#section-7.1">7.1</a> of
        [<a href="rfc5475.html" title='"Sampling and Filtering Techniques for IP Packet Selection"'>RFC5475</a>].
      &lt;/paragraph&gt;
    &lt;/description&gt;
  &lt;/field&gt;

  &lt;field name="hashOutputRangeMax" dataType="unsigned64"
    dataTypeSemantics="quantity" elementId="330" status="current"
    group="hash configuration"&gt;
    &lt;description&gt;
      &lt;paragraph&gt;
        This Information Element specifies the value for the end of a
        hash function's potential output range.

        See also Sections <a href="#section-6.2">6.2</a>, <a href="#section-3.8">3.8</a>, and <a href="#section-7.1">7.1</a> of
        [<a href="rfc5475.html" title='"Sampling and Filtering Techniques for IP Packet Selection"'>RFC5475</a>].
      &lt;/paragraph&gt;
    &lt;/description&gt;
  &lt;/field&gt;

  &lt;field name="hashSelectedRangeMin" dataType="unsigned64"
    dataTypeSemantics="quantity" elementId="331" status="current"
    group="hash configuration"&gt;
    &lt;description&gt;
      &lt;paragraph&gt;
        This Information Element specifies the value for the beginning
        of a hash function's selected range.

        See also Sections <a href="#section-6.2">6.2</a>, <a href="#section-3.8">3.8</a>, and <a href="#section-7.1">7.1</a> of
        [<a href="rfc5475.html" title='"Sampling and Filtering Techniques for IP Packet Selection"'>RFC5475</a>].
      &lt;/paragraph&gt;
    &lt;/description&gt;
  &lt;/field&gt;

  &lt;field name="hashSelectedRangeMax" dataType="unsigned64"
    dataTypeSemantics="quantity" elementId="332" status="current"
    group="hash configuration"&gt;
    &lt;description&gt;
      &lt;paragraph&gt;
        This Information Element specifies the value for the end of a
        hash function's selected range.



<span class="grey">Dietz, et al.               Standards Track                    [Page 42]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-43" id="page-43" name="page-43"> </a>
<span class="grey"><a href="rfc5477.html">RFC 5477</a>                PSAMP Information Model               March 2009</span>


        See also Sections <a href="#section-6.2">6.2</a>, <a href="#section-3.8">3.8</a>, and <a href="#section-7.1">7.1</a> of
        [<a href="rfc5475.html" title='"Sampling and Filtering Techniques for IP Packet Selection"'>RFC5475</a>].
      &lt;/paragraph&gt;
    &lt;/description&gt;
  &lt;/field&gt;

  &lt;field name="hashDigestOutput" dataType="boolean"
    dataTypeSemantics="quantity" elementId="333" status="current"
    group="hash configuration"&gt;
    &lt;description&gt;
      &lt;paragraph&gt;
        This Information Element contains a boolean value that is TRUE
        if the output from this hash Selector has been configured to be
        included in the packet report as a packet digest, else FALSE.

        See also Sections <a href="#section-6.2">6.2</a>, <a href="#section-3.8">3.8</a>, and <a href="#section-7.1">7.1</a> of
        [<a href="rfc5475.html" title='"Sampling and Filtering Techniques for IP Packet Selection"'>RFC5475</a>].
      &lt;/paragraph&gt;
    &lt;/description&gt;
  &lt;/field&gt;

  &lt;field name="hashInitialiserValue" dataType="unsigned64"
    dataTypeSemantics="quantity" elementId="334" status="current"
    group="hash configuration"&gt;
    &lt;description&gt;
      &lt;paragraph&gt;
        This Information Element specifies the initialiser value to the
        hash function.

        See also Sections <a href="#section-6.2">6.2</a>, <a href="#section-3.8">3.8</a>, and <a href="#section-7.1">7.1</a> of
        [<a href="rfc5475.html" title='"Sampling and Filtering Techniques for IP Packet Selection"'>RFC5475</a>].
      &lt;/paragraph&gt;
    &lt;/description&gt;
  &lt;/field&gt;

  &lt;field name="upperCILimit" dataType="float64"
    dataTypeSemantics="quantity" elementId="336" status="current"
    group="statistics"&gt;
    &lt;description&gt;
      &lt;paragraph&gt;
        This Information Element specifies the upper limit of a
        confidence interval.  It is used to provide an accuracy
        statement for an estimated value.  The confidence limits
        define the range in which the real value is assumed to be
        with a certain probability p.  Confidence limits always need
        to be associated with a confidence level that defines this
        probability p.  Please note that a confidence interval only
        provides a probability that the real value lies within the



<span class="grey">Dietz, et al.               Standards Track                    [Page 43]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-44" id="page-44" name="page-44"> </a>
<span class="grey"><a href="rfc5477.html">RFC 5477</a>                PSAMP Information Model               March 2009</span>


        limits.  That means the real value can lie outside the
        confidence limits.

        The upperCILimit, lowerCILimit, and confidenceLevel
        Information Elements should all be used in an Options Template
        scoped to the observation to which they refer.
        See <a href="#section-3.4.2.1">Section 3.4.2.1</a> of the IPFIX protocol document [<a href="rfc5101.html" title='"Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of IP Traffic Flow Information"'>RFC5101</a>].

        Note that the upperCILimit, lowerCILimit, and confidenceLevel
        are all required to specify confidence, and should be
        disregarded unless all three are specified together.
      &lt;/paragraph&gt;
    &lt;/description&gt;
    &lt;/field&gt;

  &lt;field name="lowerCILimit" dataType="float64"
    dataTypeSemantics="quantity" elementId="337" status="current"
    group="statistics"&gt;
    &lt;description&gt;
      &lt;paragraph&gt;
        This Information Element specifies the lower limit of a
        confidence interval.  For further information, see the
        description of upperCILimit.

        The upperCILimit, lowerCILimit, and confidenceLevel
        Information Elements should all be used in an Options Template
        scoped to the observation to which they refer.
        See <a href="#section-3.4.2.1">Section 3.4.2.1</a> of the IPFIX protocol document [<a href="rfc5101.html" title='"Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of IP Traffic Flow Information"'>RFC5101</a>].

        Note that the upperCILimit, lowerCILimit, and confidenceLevel
        are all required to specify confidence, and should be
        disregarded unless all three are specified together.
      &lt;/paragraph&gt;
    &lt;/description&gt;
  &lt;/field&gt;

  &lt;field name="confidenceLevel" dataType="float64"
    dataTypeSemantics="quantity" elementId="338" status="current"
    group="statistics"&gt;
    &lt;description&gt;
      &lt;paragraph&gt;
        This Information Element specifies the confidence level.  It is
        used to provide an accuracy statement for estimated values.
        The confidence level provides the probability p with which the
        real value lies within a given range.  A confidence level
        always needs to be associated with confidence limits that
        define the range in which the real value is assumed to be.




<span class="grey">Dietz, et al.               Standards Track                    [Page 44]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-45" id="page-45" name="page-45"> </a>
<span class="grey"><a href="rfc5477.html">RFC 5477</a>                PSAMP Information Model               March 2009</span>


        The upperCILimit, lowerCILimit, and confidenceLevel
        Information Elements should all be used in an Options Template
        scoped to the observation to which they refer.
        See <a href="#section-3.4.2.1">Section 3.4.2.1</a> of the IPFIX protocol document [<a href="rfc5101.html" title='"Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of IP Traffic Flow Information"'>RFC5101</a>].

        Note that the upperCILimit, lowerCILimit, and confidenceLevel
        are all required to specify confidence, and should be
        disregarded unless all three are specified together.
      &lt;/paragraph&gt;
    &lt;/description&gt;
  &lt;/field&gt;

&lt;/fieldDefinitions&gt;

Authors' Addresses

   Thomas Dietz
   NEC Europe Ltd.
   NEC Laboratories Europe
   Network Research Division
   Kurfuersten-Anlage 36
   Heidelberg  69115
   Germany

   Phone: +49 6221 4342-128
   EMail: Thomas.Dietz@nw.neclab.eu
   URI:   <a href="http://www.nw.neclab.eu/">http://www.nw.neclab.eu</a>


   Benoit Claise
   Cisco Systems, Inc.
   De Kleetlaan 6a b1
   Degem  1813
   Belgium

   Phone: +32 2 704 5622
   EMail: bclaise@cisco.com


   Paul Aitken
   Cisco Systems, Inc.
   96 Commercial Quay
   Edinburgh  EH6 6LX
   Scotland

   Phone: +44 131 561 3616
   EMail: paitken@cisco.com
   URI:   <a href="http://www.cisco.com/">http://www.cisco.com/</a>



<span class="grey">Dietz, et al.               Standards Track                    [Page 45]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-46" id="page-46" name="page-46"> </a>
<span class="grey"><a href="rfc5477.html">RFC 5477</a>                PSAMP Information Model               March 2009</span>


   Falko Dressler
   University of Erlangen-Nuremberg
   Dept. of Computer Sciences
   Martensstr. 3
   Erlangen  91058
   Germany

   Phone: +49 9131 85-27914
   EMail: dressler@informatik.uni-erlangen.de
   URI:   <a href="http://www7.informatik.uni-erlangen.de/~dressler">http://www7.informatik.uni-erlangen.de/~dressler</a>


   Georg Carle
   Technical University of Munich
   Institute for Informatics
   Boltzmannstr. 3
   Garching bei Muenchen  85737
   Germany

   Phone: +49 89 289-18030
   EMail: carle@in.tum.de
   URI:   <a href="http://www.net.in.tum.de/~carle/">http://www.net.in.tum.de/~carle/</a>





























Dietz, et al.               Standards Track                    [Page 46]

</pre><br/>
<span class="noprint"><small><small>Html markup produced by rfcmarkup 1.107, available from
<a href="http://tools.ietf.org/tools/rfcmarkup/">http://tools.ietf.org/tools/rfcmarkup/</a>
</small></small></span>


<meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

</body><!-- Mirrored from tools.ietf.org/html/rfc5477 by HTTrack Website Copier/3.x [XR&CO'2010], Wed, 19 Mar 2014 18:37:16 GMT --><!-- Added by HTTrack --></html>