<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><head profile="http://dublincore.org/documents/2008/08/04/dc-html/">
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.107" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="urn:ietf:rfc:6471" name="DC.Identifier"/>
<meta content="The rise of spam and other anti-social behavior on the Internet has\nled to the creation of shared DNS-based lists (DNSBLs) of IP addresses\nor domain names intended to help guide email filtering. This memo\nsummarizes guidelines of accepted best practice for the management of\npublic DNSBLs by their operators as well as for the proper use of such\nlists by mail server administrators (DNSBL users), and it provides\nuseful background for both parties. It is not intended to advise on\nthe utility or efficacy of particular DNSBLs or the DNSBL concept in\ngeneral, nor to assist end users with questions about spam. This\ndocument is not an Internet Standards Track specification; it is\npublished for informational purposes." name="DC.Description.Abstract"/>
<meta content="&lt;&gt;, Chris Lewis" name="DC.Creator"/>
<meta content="Sergeant, Matt" name="DC.Creator"/>
<meta content="January, 2012" name="DC.Date.Issued"/>
<meta content="Overview of Best Email DNS-Based List (DNSBL) Operational Practices" name="DC.Title"/>

    <link href="http://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="http://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 6471 - Overview of Best Email DNS-Based List (DNSBL) Operational Practices</title>
    
    
    <style type="text/css">
	body {
	    margin: 0px 8px;
            font-size: 1em;
	}
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgorange" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="http://tools.ietf.org/rfc/rfc6471.txt" title="Plaintext version of this document">txt</a>|<a href="http://tools.ietf.org/pdf/rfc6471" title="PDF version of this document">pdf</a>] [<a href="http://tools.ietf.org/html/draft-irtf-asrg-bcp-blacklists" title="draft-irtf-asrg-bcp-blacklists">draft-irtf-asrg-b...</a>] [<a href="http://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc6471" title="Inline diff (wdiff)">Diff1</a>] [<a href="http://tools.ietf.org/rfcdiff?url2=rfc6471" title="Side-by-side diff">Diff2</a>]                 </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                           INFORMATIONAL</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<pre>Internet Research Task Force (IRTF)                             C. Lewis
Request for Comments: 6471                               Nortel Networks
Category: Informational                                      M. Sergeant
ISSN: 2070-1721                                     Symantec Corporation
                                                            January 2012


  <span class="h1">Overview of Best Email DNS-Based List (DNSBL) Operational Practices</span>

Abstract

   The rise of spam and other anti-social behavior on the Internet has
   led to the creation of shared DNS-based lists (DNSBLs) of IP
   addresses or domain names intended to help guide email filtering.
   This memo summarizes guidelines of accepted best practice for the
   management of public DNSBLs by their operators as well as for the
   proper use of such lists by mail server administrators (DNSBL users),
   and it provides useful background for both parties.  It is not
   intended to advise on the utility or efficacy of particular DNSBLs or
   the DNSBL concept in general, nor to assist end users with questions
   about spam.

Status of This Memo

   This document is not an Internet Standards Track specification; it is
   published for informational purposes.

   This document is a product of the Internet Research Task Force
   (IRTF).  The IRTF publishes the results of Internet-related research
   and development activities.  These results might not be suitable for
   deployment.  This RFC represents the consensus of the Anti-Spam
   Research Group of the Internet Research Task Force (IRTF).  Documents
   approved for publication by the IRSG are not a candidate for any
   level of Internet Standard; see <a href="rfc5741.html#section-2">SectionÂ 2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc6471">http://www.rfc-editor.org/info/rfc6471</a>.

Copyright Notice

   Copyright (c) 2012 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="http://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of




<span class="grey">Lewis &amp; Sergeant              Informational                     [Page 1]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc6471.html">RFC 6471</a>                     DNSBL Practice                 January 2012</span>


   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.

Table of Contents

   <a href="#section-1">1</a>.  Introduction . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-3">3</a>
     <a href="#section-1.1">1.1</a>.  DNS-Based Reputation Systems . . . . . . . . . . . . . . .  <a href="#page-3">3</a>
     <a href="#section-1.2">1.2</a>.  Guidance for DNSBL Users . . . . . . . . . . . . . . . . .  <a href="#page-5">5</a>
     <a href="#section-1.3">1.3</a>.  Requirements Language  . . . . . . . . . . . . . . . . . .  <a href="#page-7">7</a>
     <a href="#section-1.4">1.4</a>.  Background . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-7">7</a>
   <a href="#section-2">2</a>.  DNSBL Policies . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-7">7</a>
     <a href="#section-2.1">2.1</a>.  Transparency . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-7">7</a>
       2.1.1.  Listing/Delisting Criteria SHOULD Be Easily
               Available  . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-8">8</a>
       <a href="#section-2.1.2">2.1.2</a>.  Audit Trail SHOULD Be Maintained . . . . . . . . . . .  <a href="#page-8">8</a>
       2.1.3.  The Scope and Aggressiveness of Listings MUST Be
               Disclosed  . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-8">8</a>
     <a href="#section-2.2">2.2</a>.  Listings and Removals  . . . . . . . . . . . . . . . . . .  <a href="#page-9">9</a>
       <a href="#section-2.2.1">2.2.1</a>.  Listings SHOULD Be Temporary . . . . . . . . . . . . .  <a href="#page-9">9</a>
       2.2.2.  A Direct Non-Public Way to Request Removal SHOULD
               Be Available . . . . . . . . . . . . . . . . . . . . . <a href="#page-10">10</a>
       <a href="#section-2.2.3">2.2.3</a>.  Response SHOULD Be Prompt  . . . . . . . . . . . . . . <a href="#page-11">11</a>
       2.2.4.  A Given DNSBL SHOULD Have Similar Criteria for
               Listing and Delisting  . . . . . . . . . . . . . . . . <a href="#page-12">12</a>
       <a href="#section-2.2.5">2.2.5</a>.  Conflict of Interest . . . . . . . . . . . . . . . . . <a href="#page-12">12</a>
   <a href="#section-3">3</a>.  Operational Issues . . . . . . . . . . . . . . . . . . . . . . <a href="#page-13">13</a>
     <a href="#section-3.1">3.1</a>.  DNSBL Query Root Domain Name SHOULD be a Subdomain . . . . <a href="#page-13">13</a>
     <a href="#section-3.2">3.2</a>.  DNSBLs SHOULD Be Adequately Provisioned  . . . . . . . . . <a href="#page-13">13</a>
     <a href="#section-3.3">3.3</a>.  DNSBLs SHOULD Provide Operational Flags  . . . . . . . . . <a href="#page-14">14</a>
     <a href="#section-3.4">3.4</a>.  Shutdowns MUST Be Done Gracefully  . . . . . . . . . . . . <a href="#page-15">15</a>
     3.5.  Listing of Special and Reserved IP Addresses MUST Be
           Disclosed  . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-16">16</a>
     <a href="#section-3.6">3.6</a>.  Considerations for DNSBLs Listing Insecure Hosts . . . . . <a href="#page-17">17</a>
       <a href="#section-3.6.1">3.6.1</a>.  DNSBLs MUST NOT Scan without Provocation . . . . . . . <a href="#page-17">17</a>
       <a href="#section-3.6.2">3.6.2</a>.  Re-Scan Periods SHOULD Be Reasonable . . . . . . . . . <a href="#page-17">17</a>
       <a href="#section-3.6.3">3.6.3</a>.  Scans MUST NOT Be Destructive  . . . . . . . . . . . . <a href="#page-17">17</a>
     3.7.  Removals SHOULD Be Possible in Absence of the DNSBL
           Operator . . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-17">17</a>
     <a href="#section-3.8">3.8</a>.  Protect against Misconfiguration/Outages . . . . . . . . . <a href="#page-18">18</a>
     <a href="#section-3.9">3.9</a>.  Error Handling . . . . . . . . . . . . . . . . . . . . . . <a href="#page-19">19</a>
   <a href="#section-4">4</a>.  Security Considerations  . . . . . . . . . . . . . . . . . . . <a href="#page-19">19</a>
   <a href="#section-5">5</a>.  References . . . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-20">20</a>
     <a href="#section-5.1">5.1</a>.  Normative References . . . . . . . . . . . . . . . . . . . <a href="#page-20">20</a>
     <a href="#section-5.2">5.2</a>.  Informative References . . . . . . . . . . . . . . . . . . <a href="#page-20">20</a>
   <a href="#appendix-A">Appendix A</a>.  Acknowledgements  . . . . . . . . . . . . . . . . . . <a href="#page-21">21</a>





<span class="grey">Lewis &amp; Sergeant              Informational                     [Page 2]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc6471.html">RFC 6471</a>                     DNSBL Practice                 January 2012</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.1.%20%20DNS-Based%20Reputation%20Systems"></a><a class="selflink" href="#section-1.1" name="section-1.1">1.1</a>.  DNS-Based Reputation Systems</span>

   Due to the rising amount of spam and other forms of network abuse on
   the Internet, many community members and companies began to create,
   publish and maintain DNS-based reputation systems (DNS-based lists or
   DNSBLs) of IP addresses or domain names and make reputation
   suggestions or assertions about email sourced from these IP addresses
   or domain names.

   The first DNSBLs were almost exclusively intended to be used (by
   email administrators) as lists of abusive IP addresses to block;
   however, the DNS publication method has proven to be so robust,
   popular, and simple to use that it has been extended for use in many
   different ways, far beyond the imaginings of the designers of DNS or
   DNS-based blocking IP lists.  For example, today, the same basic DNS-
   based listing technology is commonly used for:

   DNSWL:  listings of well-behaving email source IP/domain addresses
      (whitelist).

   RHSBL:  listings of well/ill-behaving email source domain names
      (often applied against the domain name part (RHS = Right Hand
      Side) of the originating email address or DNS PTR (reverse IP)
      lookups)

   URIBL:  listings of well/ill-behaving web link domain names or host
      names used in email

   Further, the DNSBL user doesn't have to use a listing as a pass/fail
   binary decision -- it can use a listing as one factor in email
   filters that make decisions based on scoring multiple factors
   together.

   The DNS-based list technology has even been extended to purely
   informational purposes.  For example, there are implementations that
   return results based on what geographic region an IP/domain is
   putatively allocated in, implementations that translate an IP/domain
   address into an Autonomous System Number (ASN) and/or allocation
   block, implementations that indicate whether the queried domain name
   is registered through a given domain registrar, implementations that
   return aggregate numeric reputation for an IP address or domain name
   from another system's email system, and so on.  The possibilities are
   virtually endless.






<span class="grey">Lewis &amp; Sergeant              Informational                     [Page 3]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc6471.html">RFC 6471</a>                     DNSBL Practice                 January 2012</span>


   DNS-based listing technology has also been used in areas other than
   email filtering, such as Internet Relay Chat (IRC), web access
   control, and transaction verification.

   As the terminology in this area has never been well formalized, often
   overlaps, and lacks precision, this document has been written to use
   the term "DNSBLs" to refer to DNS-based lists generally, not just
   DNS-based block (or black) lists.  This document is not applicable to
   some DNSBLs in some areas (mentioned as appropriate), but it is the
   authors' belief that most of the practices are applicable to almost
   all DNSBLs.

   DNSBLs may be either public or private.  A public DNSBL makes its
   data available to any party seeking information about data on the
   list, while a private DNSBL is used solely by an organization for its
   own use, and the data is not made available publicly.  There are also
   commercial DNSBLs, available for a fee.  Furthermore, some are free
   yet require a fee for higher numbers of queries or certain classes of
   DNSBL users.

   The first publicly available DNSBL using the Domain Name System (DNS)
   for distributing reputation data about email senders emerged in 1997,
   shortly after spam became a problem for network operators and email
   administrators.  This pioneer DNSBL focused on identifying known spam
   sources situated at static (unchanging) IP/domain addresses.  Due to
   the broad adoption of this DNSBL, it had a major impact on static
   spam sources.  Consequently, abusers found other methods for
   distributing their spam, such as relaying messages through unsecured
   email servers or flawed formmail scripts on web pages.  Additional
   DNSBLs were developed by others in order to address these changing
   tactics, and today more than 700 public DNSBLs are known to be in
   operation.

   These DNSBLs vary widely in purpose for which the list was intended,
   the method the list uses to achieve the purpose, the integrity of
   those overseeing the method, and the stability of the technology used
   to create and distribute the data.  Listing criteria can sometimes be
   quite controversial; therefore, this document deliberately does not
   discuss the rightness or wrongness of any criteria.  We assert that
   DNSBL operators are free to choose whatever listing criteria they
   wish, as long as those criteria are clearly and accurately
   communicated.  It is the responsibility of the DNSBL user to ensure
   that the listing criteria and other aspects of a DNSBL meets their
   needs.

   This document is intended to provide guidance to DNSBL operators so
   that they may be able to identify what features users would be
   interested in seeing as part of a high-quality, well-managed DNSBL --



<span class="grey">Lewis &amp; Sergeant              Informational                     [Page 4]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc6471.html">RFC 6471</a>                     DNSBL Practice                 January 2012</span>


   for example, a clear listing and delisting policy to which the DNSBL
   operator adheres strictly.  This document is intended to be normative
   rather than prescriptive: it seeks to characterize the features of a
   well-managed DNSBL rather than setting out rules for how DNSBLs
   should be operated.

   This document is not intended as a protocol specification of DNSBL
   queries.  (See [<a href="rfc5782.html" title='"DNS Blacklists and Whitelists"'>RFC5782</a>].)

   The DNS has been the most popular distribution method for DNSBLs due
   to its ubiquity and its good scaling and performance characteristics.
   It is also common to make private arrangements to distribute DNSBL
   data in bulk to high-volume users, typically by rsync [<a href="#ref-RSYNC" title='"rsync"'>RSYNC</a>]
   [<a href="#ref-RSYNCTHESIS" title='"Efficient Algorithms for Sorting and Synchronization"'>RSYNCTHESIS</a>].  The data is the same in either case; the
   recommendations in this document apply, regardless of distribution
   method, other than the ones in Sections <a href="#section-3.1">3.1</a> and <a href="#section-3.2">3.2</a> that specifically
   refer to DNS distribution.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.2.%20%20Guidance%20for%20DNSBL%20Users"></a><a class="selflink" href="#section-1.2" name="section-1.2">1.2</a>.  Guidance for DNSBL Users</span>

   When choosing to adopt a DNSBL, a DNSBL user SHOULD keep the
   following questions in mind:

   1.   What is the intended use of the list?

   2.   Does the list have a web site?

   3.   Are the list's policies stated on the web site?

   4.   Are the policies stated clearly and understandably?

   5.   Does the web site function properly, e.g., hyperlinks?

   6.   Are web pages for removal requirements accessible and working
        properly?

   7.   How long has the list been in operation?

   8.   What are the demographics and quantity of the list's user base?
        In other words, do other sites like my own use this DNSBL?

   9.   Are comparative evaluations of the list available?  Note: all
        such evaluations depend on the mail mix used as well as local
        policy.  DNSBL users SHOULD consider trial periods and/or
        ongoing local monitoring of DNSBL suitability.






<span class="grey">Lewis &amp; Sergeant              Informational                     [Page 5]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc6471.html">RFC 6471</a>                     DNSBL Practice                 January 2012</span>


   10.  What do your peers or members of the Internet community say
        about the list?  DNSBLs can sometimes be quite controversial and
        sometimes considerable misinformation is spread.  Ensure that
        the opinions are knowledgeable and reflect similar goals to
        yours.

   11.  Does the DNSBL have a mailing list for announcing changes,
        outages, etc.?

   DNSBLs can, and have, ceased operation without notice.  DNSBL users
   SHOULD periodically check the correct operation of the DNSBL, and
   cease using DNSBLs that are working incorrectly.  See <a href="#section-3.3">Section 3.3</a>.

   The DNSBL user MUST ensure that they understand the intended use of
   the DNSBL.  For example, some IP address-based DNSBLs are appropriate
   for assessment of only the peer IP address of the machine connecting
   to the DNSBL user's mail server, and not other IP addresses appearing
   in an email (such as header Received lines or web links) or IRC
   connections, etc.  While a DNSBL user may choose to ignore the intent
   of the DNSBL, they SHOULD implement any variance in compliance with
   the DNSBL usage instructions.

   For example, one of the requirements of some DNSBLs is that if the
   DNSBL is used contrary to the usage instructions, then the DNSBL user
   should not identify the DNSBL being used.  Furthermore, it is the
   DNSBL user's responsibility to mitigate the effect of the listing
   locally.

   It is the responsibility of the system administrators who adopt one
   or more DNSBLs to evaluate, understand, and make a determination of
   which DNSBLs are appropriate for the sites they administer.  If you
   are going to allow a third party's information to guide your
   filtering decision-making process, you MUST understand the policies
   and practices of those third parties because responsibility for
   filter decisions remains ultimately with you, the postmaster.

   A DNSBL without DNSBL users does not block (or otherwise impair)
   email or any other Internet service.  A DNSBL user voluntarily uses
   the DNSBL data to guide their decisions, and the DNSBL user therefore
   MUST assume responsibility for dealing with the consequences.

   DNSBL operators are expressing an opinion through the publication of
   a DNSBL.  However, it is through abiding by the guidelines set forth
   in this document that the operators of a DNSBL may gain the trust of
   their users.






<span class="grey">Lewis &amp; Sergeant              Informational                     [Page 6]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc6471.html">RFC 6471</a>                     DNSBL Practice                 January 2012</span>


   These guidelines address only public DNSBLs and do not apply to
   private-access DNSBLs; however, implementers and users of private-
   access DNSBLs may wish to use these guidelines as a starting point of
   things to consider.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.3.%20%20Requirements%20Language"></a><a class="selflink" href="#section-1.3" name="section-1.3">1.3</a>.  Requirements Language</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [<a href="rfc2119.html" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.4.%20%20Background"></a><a class="selflink" href="#section-1.4" name="section-1.4">1.4</a>.  Background</span>

   The Anti-Spam Research Group (ASRG) was chartered to address the spam
   problem.  The ASRG charter includes:

   "codification of best current practices in spam management"

   This note falls within that category by listing guidelines for
   management of public DNSBLs.

   NOTE:  This document is a product of the Anti-Spam Research Group
      (ASRG) of the IRTF.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20DNSBL%20Policies"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  DNSBL Policies</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.1.%20%20Transparency"></a><a class="selflink" href="#section-2.1" name="section-2.1">2.1</a>.  Transparency</span>

   A DNSBL SHOULD carefully describe the criteria for adding and the
   criteria for removing an entry from the list.  Such listing and
   delisting criteria SHOULD be presented in a clear and readable manner
   easily accessible to the public on the DNSBL's web site.  A DNSBL
   MUST abide by its stated listing and delisting criteria.  Entries
   that do not meet the published criteria MUST NOT be added to the
   DNSBL.

   In other words, be direct and honest and clear about the listing
   criteria, and make certain that only entries meeting the published
   criteria are added to the list.  For example, some DNSBL operators
   have been known to include "spite listings" in the lists they
   administer -- listings of IP addresses or domain names associated
   with someone who has insulted them, rather than actually violating
   technical criteria for inclusion in the list.  There is nothing
   inherently wrong with this practice so long as it is clearly
   disclosed -- and thus becomes part of the published criteria.  For
   example, a DNSBL described as only listing open relays MUST NOT
   include IP addresses for any other reason.  This transparency




<span class="grey">Lewis &amp; Sergeant              Informational                     [Page 7]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc6471.html">RFC 6471</a>                     DNSBL Practice                 January 2012</span>


   principle does not require DNSBL operators to disclose the precise
   algorithms and data involved in a listing, but rather the intent
   behind choosing those algorithms and data.

   Furthermore, the DNSBL documentation SHOULD be clear on the intended
   use of the DNSBL -- whether it be intended for peer addresses of
   email, IRC, etc.

   Availability of documentation concerning a DNSBL SHOULD NOT be
   dependent on the continued operation of DNS for DNSBL queries.

   In other words, if the DNSBL documentation is at
   "http://dnsbl.example.com", the documentation for the web site should
   not become unavailable if the DNSBL query name servers are not
   available (or shut down).  See <a href="#section-3.1">Section 3.1</a>.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.1.1.%20%20Listing%2FDelisting%20Criteria%20SHOULD%20Be%20Easily%20Available"></a><a class="selflink" href="#section-2.1.1" name="section-2.1.1">2.1.1</a>.  Listing/Delisting Criteria SHOULD Be Easily Available</span>

   Listing and delisting criteria for DNSBLs SHOULD be easily available
   and SHOULD be located in a place clearly marked in its own section of
   the web site affiliated with the DNSBL.

   DNSBLs often publish their listing criteria along with additional
   technical information about using the DNSBL.  This additional
   technical information can confuse end users, so a separate page,
   section, or query function on its own SHOULD be dedicated to
   detailing why a specific entry appears in the DNSBL.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.1.2.%20%20Audit%20Trail%20SHOULD%20Be%20Maintained"></a><a class="selflink" href="#section-2.1.2" name="section-2.1.2">2.1.2</a>.  Audit Trail SHOULD Be Maintained</span>

   A DNSBL SHOULD maintain an audit trail for all listings, and it is
   RECOMMENDED that it is made publicly available in an easy to find
   location, preferably on the DNSBL's web site.  Please note that
   making data about an audit trail public does not entail revealing all
   information in the DNSBL operator's possession relating to the
   listing.  For example, a DNSBL operator MAY make the audit trail data
   selectively accessible in such a way as to not disclose information
   that might assist spammers, such as the location or identity of a
   spam trap.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.1.3.%20%20The%20Scope%20and%20Aggressiveness%20of%20Listings%20MUST%20Be%20Disclosed"></a><a class="selflink" href="#section-2.1.3" name="section-2.1.3">2.1.3</a>.  The Scope and Aggressiveness of Listings MUST Be Disclosed</span>

   Some DNSBLs have adopted policies of listing entries that are broader
   in scope than they have evidence of being involved in abuse.
   Similarly, some DNSBLs list entries that are "mixed", in that the
   entry may be behaving in a manner that is both abusive and non-
   abusive.  This is inherent to the techniques that many DNSBLs use.




<span class="grey">Lewis &amp; Sergeant              Informational                     [Page 8]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc6471.html">RFC 6471</a>                     DNSBL Practice                 January 2012</span>


   Examples: Some DNSBLs will list IP address ranges if there is reason
   to believe that abusive behavior seen from a few IP addresses within
   the range is (or will be) reflected in the rest of the range.  Some
   DNSBLs utilize scoring to list IP addresses, IP ranges, or domain
   names that have abusive behavior above some threshold -- often
   meaning that some of the email corresponding to the listing is not
   abusive.  Even an entry demonstrably infected with email spam or
   virus-emitting malware may emit non-abusive email.

   Inevitably, some of these listings may impact non-abusive email.
   This has resulted in some labeling of such practices by the
   emotionally loaded term "collateral damage".  No filtering technique
   is perfect, and an occasional mistake is inevitable no matter what is
   used, DNSBLs or otherwise.

   There is nothing wrong with this practice (of having "collateral
   damage") because mail server administrators may wish to implement
   such policies or use them in combination with other techniques (such
   as scoring).  However, a diligent administrator needs information
   about these policies in order to make an informed decision as to the
   risk and benefit of using any particularly DNSBL, and to guide them
   in how to use it for results best reflecting the DNSBL user's
   requirements.

   Therefore, DNSBL listing policies MUST include statements as to the
   scope and aggressiveness of listings and include, as appropriate,
   whether the DNSBL operator intends the listings to be used in scoring
   or other techniques.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.2.%20%20Listings%20and%20Removals"></a><a class="selflink" href="#section-2.2" name="section-2.2">2.2</a>.  Listings and Removals</span>

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.2.1.%20%20Listings%20SHOULD%20Be%20Temporary"></a><a class="selflink" href="#section-2.2.1" name="section-2.2.1">2.2.1</a>.  Listings SHOULD Be Temporary</span>

   In many cases, listings can exist for long periods of time past the
   conditions leading to the listing's creation, and/or listings can
   exist after the listed entity has putatively changed ownership.

   Generally speaking, listings SHOULD be considered temporary and
   should expire on their own at some point in the future, unless
   reasons for listing still exist.

   Expiration intervals SHOULD be chosen to be reasonable for the type
   of listing.  For example:

   1.  It does not make sense to remove entries from DNSBLs where the
       existence of an entry does not have a direct meaning, that is,
       DNSBLs that return information in addition to just existence/
       non-existence.  For example: entries in DNSBLs that return



<span class="grey">Lewis &amp; Sergeant              Informational                     [Page 9]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc6471.html">RFC 6471</a>                     DNSBL Practice                 January 2012</span>


       geographic or assignment information on where the IP address or
       domain name is located or owned, or DNSBLs that return flow
       statistics from the DNSBL operator that are intended for the
       DNSBL user to interpret, need not ever be removed, just kept
       reasonably current.

   2.  DNSBLs based on relatively static information, such as block
       assignment or domain names of demonstrably bad actors, MAY have
       very long expiration intervals or be removed only upon request
       after verification that the removal criteria have been met.

   3.  Automated DNSBLs with highly effective detection and fast listing
       mechanisms can benefit from very short expiration intervals.
       Many of the things that these DNSBLs look for are of relatively
       short duration, and even if they do expire, a resumption of the
       behavior will be caught quickly by the DNSBL's detection
       mechanisms and relisted.  By utilizing a short expiration
       interval, after reassignment/problem correction, the listing will
       automatically expire in short order without manual intervention.

   4.  Manually created DNSBL entries SHOULD be periodically reviewed in
       some manner.

   It is RECOMMENDED that DNSBL operators publish in general terms their
   expiration policy, even if it's only "delist on request" or "no
   expiration is performed".  In information-only lists, a method for
   users requesting corrections to the information (if appropriate)
   SHOULD be published.  Abusers may be able to "game" policy that is
   too explicit; on the other hand, many DNSBL users wish to have an
   idea of how "current" the DNSBL is.  It is the authors' experience
   that some automated DNSBLs have increasingly higher error rates as
   the "last detection date" gets older.

   Note that listings being temporary does not mean that all listings
   will expire after the initial time-out period.  If the DNSBL operator
   determines that the conditions triggering listing still exist, then
   the timer for determining time outs can be renewed.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.2.2.%20%20A%20Direct%20Non-Public%20Way%20to%20Request%20Removal%20SHOULD%20Be%20Available"></a><a class="selflink" href="#section-2.2.2" name="section-2.2.2">2.2.2</a>.  A Direct Non-Public Way to Request Removal SHOULD Be Available</span>

   Discussions about whether a DNSBL should remove an entry MAY include
   activity in a public forum.  Methods for processing removal requests
   through private, direct exchanges, such as person-to-person email or
   a combination of web page requests and email responses, SHOULD be
   available.  As a minimum, the DNSBL SHOULD have a web page that has a
   removal request function (separate from the page describing listing
   criteria as per <a href="#section-2.1.1">Section 2.1.1</a>).  The DNSBL SHOULD also make available
   an email address to handle issues other than blocking issues.



<span class="grey">Lewis &amp; Sergeant              Informational                    [Page 10]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc6471.html">RFC 6471</a>                     DNSBL Practice                 January 2012</span>


   The DNSBL operator MUST NOT use the list in question in such a way
   that removal requests would be blocked; and moreover, the operator
   SHOULD make mailboxes available in order to allow affected users to
   submit their requests.  In some cases, it is impractical not to
   filter email to accounts due to the amount of spam those mailboxes
   receive.  If filtering should be necessary in such circumstances,
   filtering methods with as low false positive rate as practical SHOULD
   be chosen.

   DNSBL operators SHOULD be prepared to provide alternate means of
   contact in case of system failure due to DDoS (distributed denial-of-
   service) attack or other reasons.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.2.3.%20%20Response%20SHOULD%20Be%20Prompt"></a><a class="selflink" href="#section-2.2.3" name="section-2.2.3">2.2.3</a>.  Response SHOULD Be Prompt</span>

   A response to removal requests or queries about a listing SHOULD be
   prompt.  A DNSBL operator SHOULD respond within 2 days and MUST
   respond within 7 days, except in the case that the DNSBL operator has
   deemed that further discussion of the issue will not result in
   meeting the conditions for removal and has notified the requestor of
   that decision.

   Consequent removals (if the conditions for removal are met) should be
   similarly prompt.

   A DNSBL MAY impose restrictions on who (e.g., a network operator's
   representative or domain name owner) may make valid removal requests.
   However, in many DNSBLs, this is inadvisable because it requires
   impractical amounts of effort; hence, it is NOT RECOMMENDED in most
   cases.

   Many DNSBLs (especially those with highly effective detection and
   fast listing mechanisms) greatly benefit from a "no questions asked"
   removal policy.

   Although this approach allows people to submit a request and have any
   listed IP address/domain name removed immediately, it does not
   prevent the DNSBL operator from relisting the IP address/domain name
   at a later time.

   Many DNSBLs can effectively use a "no questions asked" removal policy
   because by their very nature they will redetect or relist problems
   almost immediately.  They can mitigate more organized attempts to
   "game" the system by performing elementary checking and rate-limiting
   procedures, increasing lockout periods, executing re-scans, etc.
   Furthermore, a adding or removing a few IP addresses usually does not





<span class="grey">Lewis &amp; Sergeant              Informational                    [Page 11]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc6471.html">RFC 6471</a>                     DNSBL Practice                 January 2012</span>


   make a significant difference in the overall effectiveness of a
   DNSBL.  Moreover, a "no questions asked" removal policy provides the
   huge benefit of a swift reaction to incorrect listings.

   As an example, one popular DNSBL uses a "no questions asked" removal
   policy, but does perform rate-limiting and malicious removal
   detection and mitigation.

   Another important consideration supporting a "no questions asked"
   self-removal policy is that it forestalls many conflicts between
   DNSBL operators and organizations whose IP addresses/domain names
   have been listed.  Such a policy may be an effective measure to
   prevent small issues from becoming big problems.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.2.4.%20%20A%20Given%20DNSBL%20SHOULD%20Have%20Similar%20Criteria%20for%20Listing%20and"></a><a class="selflink" href="#section-2.2.4" name="section-2.2.4">2.2.4</a>.  A Given DNSBL SHOULD Have Similar Criteria for Listing and</span>
<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/Delisting"></a>        Delisting</span>

   The criteria for being removed from a DNSBL SHOULD bear a reasonable
   relationship to the factors that were the cause of the addition to
   the DNSBL.  If a listed entity fulfills all published requirements
   for removal from a DNSBL, then the DNSBL operator SHOULD NOT impose
   any additional obstacles to remove a given entry from the DNSBL.
   There SHOULD NOT be any extra rules for delisting other than the ones
   listed in the published listing criteria.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.2.5.%20%20Conflict%20of%20Interest"></a><a class="selflink" href="#section-2.2.5" name="section-2.2.5">2.2.5</a>.  Conflict of Interest</span>

   Some DNSBLs used for blocking/negative reputation have had a practice
   of requiring fees or donations to charities from the listee for
   delisting.

   It is generally considered entirely appropriate for a DNSBL to charge
   for access to it by its users -- the definition of a commercial
   DNSBL.

   However, the practice of requiring a listee to pay for delisting from
   a negative-connotation DNSBL steers perilously close to notions of
   extortion, blackmail, or a "protection racket".  Even when such
   accusations are entirely unjustified, the practice causes uproar and
   damage to the DNSBL's reputation, if not the DNSBL mechanism as a
   whole.

   Therefore, negative-connotation DNSBLs MUST not charge fees or
   require donations for delisting or "faster handling", and it is
   RECOMMENDED that such DNSBLs that do charge fees or require donations
   not be used.





<span class="grey">Lewis &amp; Sergeant              Informational                    [Page 12]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc6471.html">RFC 6471</a>                     DNSBL Practice                 January 2012</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20Operational%20Issues"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  Operational Issues</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.1.%20%20DNSBL%20Query%20Root%20Domain%20Name%20SHOULD%20be%20a%20Subdomain"></a><a class="selflink" href="#section-3.1" name="section-3.1">3.1</a>.  DNSBL Query Root Domain Name SHOULD be a Subdomain</span>

   By virtue of using domain names, a DNSBL is a hierarchy with a root
   anchored in the global Internet.  The DNSBL "query root" SHOULD be
   below the registered domain name, so that the DNSBL information is
   not conflated with domain name housekeeping information (e.g., name
   server or MX records) for the domain name.  By using this approach,
   DNSBL queries would take the form of "&lt;query&gt;.dnsbl.example.com"
   rather than "&lt;query&gt;.example.com".  Further, this sub-tree should
   have its own name servers.  Thus, the DNSBL query root has its own
   zone file containing the DNSBL information, and the registered domain
   name has its own name servers containing the information (MX records,
   etc.) for the domain name.  This approach facilitates clear
   delineation of function as well as orderly DNSBL shutdown because the
   DNSBL name server records can be specified separately from the domain
   name's principal name servers.

   Many DNSBLs support more than one logical zone (DNSBL entries with
   different meanings) that DNSBL users may wish to treat differently
   (or even ignore).  It is RECOMMENDED that, even if there is a single
   DNSBL zone with entry type distinguished by return code, separate
   subdomain names (of the query root) consist only of the corresponding
   entries.  For example, entry types "A" and "B" might return 127.0.0.2
   and 127.0.0.3 from the consolidated zone (e.g., dnsbl.example.com),
   but there should also be zones typeA.dnsbl.example.com and
   typeB.dnsbl.example.com that contain their respective types only.
   See also <a href="#section-3.3">Section 3.3</a>.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.2.%20%20DNSBLs%20SHOULD%20Be%20Adequately%20Provisioned"></a><a class="selflink" href="#section-3.2" name="section-3.2">3.2</a>.  DNSBLs SHOULD Be Adequately Provisioned</span>

   The DNSBL SHOULD have sufficient name server capacity to handle the
   expected loading and have sufficient redundancy to handle normal
   outages.

   Name servers SHOULD provide appropriate glue records, possibly in
   different Top-Level Domains (TLDs) to protect against single-TLD
   issues.

   If the DNSBL offers zone transfers (in addition to or instead of
   standard DNSBL query mechanisms), it SHOULD be sufficiently
   provisioned to handle the expected loading.

   Note that some DNSBLs have been subject to DDoS attacks.
   Provisioning SHOULD take the likelihood of this into account and
   include plans for dealing with it.




<span class="grey">Lewis &amp; Sergeant              Informational                    [Page 13]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc6471.html">RFC 6471</a>                     DNSBL Practice                 January 2012</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.3.%20%20DNSBLs%20SHOULD%20Provide%20Operational%20Flags"></a><a class="selflink" href="#section-3.3" name="section-3.3">3.3</a>.  DNSBLs SHOULD Provide Operational Flags</span>

   Most IP address-based DNSBLs follow a convention of query entries for
   IP addresses in 127.0.0.0/8 (127.0.0.0-127.255.255.255) to provide
   online indication of whether the DNSBL is operational.  Many, if not
   most, DNSBLs arrange to have a query of 127.0.0.2 return an A record
   (usually 127.0.0.2) indicating that the IP address is listed.  This
   appears to be a de facto standard indicating that the DNSBL is
   operating correctly.  See [<a href="rfc5782.html" title='"DNS Blacklists and Whitelists"'>RFC5782</a>] for more details on DNSBL test
   entries.

   If this indicator is missing (query of 127.0.0.2 returns NXDOMAIN),
   or any query returns an A record outside of 127.0.0.0/8, the DNSBL
   should be considered non-functional.

   There does not appear to be a de facto standard for test entries
   within domain-name-based DNSBLs.  A number of domain-name-based
   DNSBLs use the same 127.0.0.2 query test mechanism as IP-address-
   based DNSBLs, and others use a variety of domain-name-based test
   entries.  Due to the way many domain-name-based DNSBLs are used
   (e.g., hostname parts of URIs in email bodies), using anything likely
   to appear in a legitimate email message is a bad idea (e.g.,
   http://example.com), especially considering that some email readers
   will transform bare IP addresses or domain names appearing in the
   body of an email into links.  So, even 127.0.0.2 may be problematic.
   But a common testing method is desirable.

   In the absence of new emerging standards, it is RECOMMENDED that
   domain-name-based DNSBLs use a test entry of "test".  This is chosen
   because it is a reserved TLD.

   Note: In <a href="#section-3.4">Section 3.4</a>, it is noted that some DNSBLs have shut down in
   such a way to list all of the Internet.  Further, in <a href="#section-3.5">Section 3.5</a>,
   DNSBL operators MUST NOT list 127.0.0.1.  Therefore, a positive
   listing for 127.0.0.1 SHOULD indicate that the DNSBL has started
   listing the world and is non-functional.  Similarly, a domain-based
   DNSBL SHOULD NOT ever list the reserved domain INVALID, and a
   positive listing for INVALID SHOULD indicate that the DNSBL is non-
   functional.

   Other results, such as 127.0.0.3, may have different meanings.  This
   operational flag usage and meaning SHOULD be published on the DNSBL's
   web site, and the DNSBL user SHOULD periodically test the DNSBL.








<span class="grey">Lewis &amp; Sergeant              Informational                    [Page 14]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc6471.html">RFC 6471</a>                     DNSBL Practice                 January 2012</span>


   Some mail systems are unable to differentiate between these various
   results or flags, however, so a public DNSBL SHOULD NOT include
   opposing or widely different meanings -- such as 127.0.0.23 for
   "sends good mail" and 127.0.0.99 for "sends bad mail" -- within the
   same DNS zone.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.4.%20%20Shutdowns%20MUST%20Be%20Done%20Gracefully"></a><a class="selflink" href="#section-3.4" name="section-3.4">3.4</a>.  Shutdowns MUST Be Done Gracefully</span>

   A number of DNSBLs have shut down operations in such a way as to list
   the entire Internet, sometimes without warning.  These were usually
   done this way to force DNSBL users (mail administrators) to adjust
   their DNSBL client configurations to omit the now inoperative DNSBL
   and to shed the DNS query load from the registered domain name
   servers for the DNSBL.  Popular DNSBLs are used by tens of thousands
   of sites, yet, the correct operation of the DNSBLs are not well
   monitored by their users.  The DNSBL query clients are often not
   compliant with DNSBL query conventions (e.g., they will treat any A
   record returned as being "listed", instead of specific 127/8 A record
   returns), hence shutdowns (or even ordinary domain name expiration)
   can be quite destructive to all email flow if not done properly.

   The DNSBL operator MUST issue impending shutdown warnings (on the
   DNSBL web site, appropriate mailing lists, newsgroups, vendor
   newsletters, etc.), and indicate that the DNSBL is inoperative using
   the signaling given in <a href="#section-3.3">Section 3.3</a>.

   Only after these warnings have been issued for a significant period
   of time (RECOMMENDED: one or more months), should the DNSBL operator
   finally shutdown the DNSBL.

   The shutdown procedure should have the following properties:

   1.  MUST NOT list the entire Internet

   2.  SHOULD shed the DNSBL query load from the DNSBL name servers,
       permitting the registered domain name to continue being usable.

   3.  SHOULD, perhaps through increased delays, indicate to the mail
       administrator that the DNSBL is no longer functional.

   4.  Name server or query lookups MUST NOT be aimed at third parties
       unrelated to DNSBL operation.  Such behavior is similar to
       inflicting a DDoS attack.

   5.  The base domain name SHOULD be registered indefinitely, so as to
       prevent the domain name from being a "booby trap" for future
       owners, and/or to prevent a new owner from maliciously listing
       the entire Internet.



<span class="grey">Lewis &amp; Sergeant              Informational                    [Page 15]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-16" id="page-16" name="page-16"> </a>
<span class="grey"><a href="rfc6471.html">RFC 6471</a>                     DNSBL Practice                 January 2012</span>


   One way of satisfying points 1-4 above is to change the DNS name
   servers for the DNSBL to point at "TEST-NET" addresses (see
   [<a href="rfc5735.html" title='"Special Use IPv4 Addresses"'>RFC5735</a>]).  The below suggested [<a href="#ref-BIND" title='"ISC BIND"'>BIND</a>] declarations will cause a
   DNSBL query to query non-existent name servers in TEST-NET addresses,
   which will result in a significant delay (usually more delay as the
   number of non-existent TEST-NET name servers is increased), but will
   not return any A records except in very unusual circumstances.

   BIND-equivalent DNS declarations for DNSBL shutdown.

   dnsbl.example.com.  604800  IN  NS  u1.example.com.
   u1.example.com.     604800  IN  A   192.0.2.1

   dnsbl.example.com.  604800  IN  NS  u2.example.com.
   u2.example.com.     604800  IN  A   192.0.2.2

   dnsbl.example.com.  604800  IN  NS  u3.example.com.
   u3.example.com.     604800  IN  A   192.0.2.3

   ... [as many NS/A record pairs as you like]

   This example assumes that the DNSBL is named "dnsbl.example.com".
   Replace "example.com" and "dnsbl.example.com" as appropriate for the
   DNSBL.

   NOTE:  Of course, the above shutdown procedure cannot be implemented
      if <a href="#section-3.1">Section 3.1</a> is not followed.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.5.%20%20Listing%20of%20Special%20and%20Reserved%20IP%20Addresses%20MUST%20Be%20Disclosed"></a><a class="selflink" href="#section-3.5" name="section-3.5">3.5</a>.  Listing of Special and Reserved IP Addresses MUST Be Disclosed</span>

   The DNSBL MAY list loopback, [<a href="rfc1918.html" title='"Address Allocation for Private Internets"'>RFC1918</a>], LINK-LOCAL class [<a href="rfc3927.html" title='"Dynamic Configuration of IPv4 Link-Local Addresses"'>RFC3927</a>],
   class D/E, and any other permanently reserved or special-use IP
   addresses [<a href="rfc5735.html" title='"Special Use IPv4 Addresses"'>RFC5735</a>] (and [<a href="rfc5156.html" title='"Special-Use IPv6 Addresses"'>RFC5156</a>] for IPv6).  Such use MUST be
   disclosed in the documentation related to the DNSBL.

   As additional insurance against listings of space that should not be
   listed through testing or other unforeseen events, DNSBL operators
   SHOULD consider implementing facilities to prevent them.  At least
   one popular automated DNSBL has implemented permanent exclusions for
   such addresses.

   A functioning DNSBL MUST NOT list 127.0.0.1.  There are a number of
   mail server implementations that do not cope with this well, and many
   will use a positive response for 127.0.0.1 as an indication that the
   DNSBL is shut down and listing the entire Internet.






<span class="grey">Lewis &amp; Sergeant              Informational                    [Page 16]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-17" id="page-17" name="page-17"> </a>
<span class="grey"><a href="rfc6471.html">RFC 6471</a>                     DNSBL Practice                 January 2012</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.6.%20%20Considerations%20for%20DNSBLs%20Listing%20Insecure%20Hosts"></a><a class="selflink" href="#section-3.6" name="section-3.6">3.6</a>.  Considerations for DNSBLs Listing Insecure Hosts</span>

   Some DNSBLs list IP addresses of hosts that are insecure in various
   ways (e.g., open relays, open proxies).  The following
   recommendations for such DNSBLs may not be relevant to other types of
   DNSBLs.

   The practice of scanning for vulnerabilities can represent a risk in
   some jurisdictions.  The following recommendations for such DNSBLs
   MAY help alleviate this risk.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.6.1.%20%20DNSBLs%20MUST%20NOT%20Scan%20without%20Provocation"></a><a class="selflink" href="#section-3.6.1" name="section-3.6.1">3.6.1</a>.  DNSBLs MUST NOT Scan without Provocation</span>

   DNSBLs MUST NOT automatically probe for insecure hosts without
   provocation.  There is little agreement in the community as to
   whether or not such activity should be allowed, so this document errs
   on the side of caution.

   Therefore, scanning MUST be targeted, rather than broad-based, where
   a given scan is motivated by a specific reason to have concern about
   the address being scanned.  Examples of such reasons include delivery
   of an email, delivery to a spam trap address, receipt of a user
   complaint, or periodic testing of an address that is already listed.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.6.2.%20%20Re-Scan%20Periods%20SHOULD%20Be%20Reasonable"></a><a class="selflink" href="#section-3.6.2" name="section-3.6.2">3.6.2</a>.  Re-Scan Periods SHOULD Be Reasonable</span>

   If the DNSBL operator re-scans a host in order to determine whether
   the listing SHOULD time out or not, the re-scan period SHOULD be
   reasonable.  Automated scanning SHOULD NOT occur more often than once
   every 24 hours.

   It is RECOMMENDED that automated re-scanning should cease within a
   reasonable period of the vulnerability no longer existing and of the
   targeting conditions no longer being met.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.6.3.%20%20Scans%20MUST%20NOT%20Be%20Destructive"></a><a class="selflink" href="#section-3.6.3" name="section-3.6.3">3.6.3</a>.  Scans MUST NOT Be Destructive</span>

   In the past, some scanning mechanisms have proven to adversely impact
   the scanned host, sometimes in severe fashion.  Scanning
   methodologies MUST NOT negatively impact the scanned host.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.7.%20%20Removals%20SHOULD%20Be%20Possible%20in%20Absence%20of%20the%20DNSBL%20Operator"></a><a class="selflink" href="#section-3.7" name="section-3.7">3.7</a>.  Removals SHOULD Be Possible in Absence of the DNSBL Operator</span>

   If removals cannot be automated (e.g., via robot re-testing or self-
   removal), then the DNSBL SHOULD have multiple administrators so that
   a removal request can be processed if the principal list
   administrator is on vacation or otherwise unavailable.




<span class="grey">Lewis &amp; Sergeant              Informational                    [Page 17]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-18" id="page-18" name="page-18"> </a>
<span class="grey"><a href="rfc6471.html">RFC 6471</a>                     DNSBL Practice                 January 2012</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.8.%20%20Protect%20against%20Misconfiguration%2FOutages"></a><a class="selflink" href="#section-3.8" name="section-3.8">3.8</a>.  Protect against Misconfiguration/Outages</span>

   It is not altogether uncommon for DNSBL users to configure their
   systems improperly for DNSBL queries.  The consequences of an error
   can range from undue (or even damaging) load on the DNSBL servers to
   accidentally blocking all incoming email.

   DNSBL users MUST test their initial DNSBL configurations to ensure
   that they're working correctly and SHOULD periodically recheck the
   status of the DNSBLs they use and adjust their configuration as
   necessary.

   Common types of misconfigurations include:

   1.  Using wrong (sub-)zones for querying (e.g., 4.3.2.1.example.com
       or 4.3.2.1.dnsbl.exmple.cm instead of 4.3.2.1.dnsbl.example.com).

   2.  Downloading a local mirror of the data, but failing to set up the
       local name server infrastructure appropriately, and thus
       continuing to query the public name servers.

   3.  Downloading a local mirror of the data, but misconfiguring the
       local name server infrastructure to query a locally invented zone
       name (4.3.2.1.dnsbl.local) at the public name servers.

   4.  Misconfiguring local name servers to not do meaningful caching,
       thus heavily increasing load on the public name servers.

   5.  Using the DNSBL query root domain name as the name server for
       queries.

   6.  Using the DNSBL incorrectly, e.g., some DNSBLs are suitable only
       for certain types of filtering.  Improper use may result in
       excessive incorrect filtering.

   While in many cases it can be difficult to detect such situations, to
   protect against such misconfiguration, it is RECOMMENDED that DNSBL
   operators make design decisions to mitigate the impact of such
   mistakes and make efforts to contact administrative contacts to
   remedy the situation where appropriate.  But the DNSBL operator
   SHOULD also prepare to take appropriate steps to protect the
   operational infrastructure (e.g., have the ability to block abusive
   users from causing further damage).

   Appropriate use of the DNSBL SHOULD be documented on the web site.






<span class="grey">Lewis &amp; Sergeant              Informational                    [Page 18]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-19" id="page-19" name="page-19"> </a>
<span class="grey"><a href="rfc6471.html">RFC 6471</a>                     DNSBL Practice                 January 2012</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.9.%20%20Error%20Handling"></a><a class="selflink" href="#section-3.9" name="section-3.9">3.9</a>.  Error Handling</span>

   From time to time, DNSBLs have encountered operational data integrity
   or data collection problems that have resulted in improper listings.
   For example: data corruption, erroneous restoration of resolved
   listings, or grossly misfiring detection heuristics.  This often
   results in great consternation over what appear to be nonsensical
   listings or listings for previously resolved issues.

   Many DNSBLs have implemented policies and procedures whereby such
   situations result in the purging of even slightly doubtful entries,
   disconnection of untrustworthy components until the entries' validity
   or correct operation of the component can be verified or corrected,
   as well as notification of the issue on the DNSBL's web pages.

   As an example, one popular DNSBL has a demonstrated track record of
   disabling faulty data collection mechanisms, purging all listings
   generated by the faulty mechanism, and publishing a brief description
   of the problem and course of remediation.

   Therefore, DNSBLs SHOULD have policies and procedures in place to
   treat operational problems conservatively, be prepared to mass purge
   dubious entries, prevent future erroneous entries, and notify their
   users by the DNSBL's web page.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20Security%20Considerations"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  Security Considerations</span>

   Any system manager that uses DNSBLs is entrusting part of his or her
   server management to the parties that run the lists.  A DNSBL manager
   that decided to list 0/0 (which has actually happened) could cause
   every server that uses the DNSBL to reject all mail.  Conversely, if
   a DNSBL manager removes all of the entries (which has also happened),
   systems that depend on the DNSBL will find that their filtering
   doesn't work as they want it to.

   If a registered domain name used for a DNSBL is allowed to lapse, or
   the DNSBL user spells the DNSBL domain name incorrectly, the system
   manager's server management is now subject to an entirely different
   party than was intended.  Further, even if there is no malicious
   intent, some DNSBL query clients will interpret any A record being
   returned as being listed.  DNSBL users SHOULD be prepared to
   periodically test the DNSBLs they use for correct operation.

   Like all DNS-based mechanisms, DNSBLs are subject to various threats
   outlined in [<a href="rfc3833.html" title='"Threat Analysis of the Domain Name System (DNS)"'>RFC3833</a>].






<span class="grey">Lewis &amp; Sergeant              Informational                    [Page 19]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-20" id="page-20" name="page-20"> </a>
<span class="grey"><a href="rfc6471.html">RFC 6471</a>                     DNSBL Practice                 January 2012</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20References"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.1.%20%20Normative%20References"></a><a class="selflink" href="#section-5.1" name="section-5.1">5.1</a>.  Normative References</span>

   [<a id="ref-RFC1918" name="ref-RFC1918">RFC1918</a>]      Rekhter, Y., Moskowitz, R., Karrenberg, D., Groot, G.,
                  and E. Lear, "Address Allocation for Private
                  Internets", <a href="http://tools.ietf.org/html/bcp5">BCP 5</a>, <a href="rfc1918.html">RFC 1918</a>, February 1996.

   [<a id="ref-RFC2119" name="ref-RFC2119">RFC2119</a>]      Bradner, S., "Key words for use in RFCs to Indicate
                  Requirement Levels", <a href="http://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.

   [<a id="ref-RFC3927" name="ref-RFC3927">RFC3927</a>]      Cheshire, S., Aboba, B., and E. Guttman, "Dynamic
                  Configuration of IPv4 Link-Local Addresses", <a href="rfc3927.html">RFC 3927</a>,
                  May 2005.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.2.%20%20Informative%20References"></a><a class="selflink" href="#section-5.2" name="section-5.2">5.2</a>.  Informative References</span>

   [<a id="ref-BIND" name="ref-BIND">BIND</a>]         Internet Systems Corporation, "ISC BIND",
                  &lt;<a href="http://www.isc.org/software/bind">http://www.isc.org/software/bind</a>&gt;.

   [<a id="ref-RFC3833" name="ref-RFC3833">RFC3833</a>]      Atkins, D. and R. Austein, "Threat Analysis of the
                  Domain Name System (DNS)", <a href="rfc3833.html">RFC 3833</a>, August 2004.

   [<a id="ref-RFC5156" name="ref-RFC5156">RFC5156</a>]      Blanchet, M., "Special-Use IPv6 Addresses", <a href="rfc5156.html">RFC 5156</a>,
                  April 2008.

   [<a id="ref-RFC5735" name="ref-RFC5735">RFC5735</a>]      Cotton, M. and L. Vegoda, "Special Use IPv4
                  Addresses", <a href="http://tools.ietf.org/html/bcp153">BCP 153</a>, <a href="rfc5735.html">RFC 5735</a>, January 2010.

   [<a id="ref-RFC5782" name="ref-RFC5782">RFC5782</a>]      Levine, J., "DNS Blacklists and Whitelists", <a href="rfc5782.html">RFC 5782</a>,
                  February 2010.

   [<a id="ref-RSYNC" name="ref-RSYNC">RSYNC</a>]        Tridgell, A., "rsync", &lt;<a href="http://rsync.samba.org/">http://rsync.samba.org/</a>&gt;.

   [<a id="ref-RSYNCTHESIS" name="ref-RSYNCTHESIS">RSYNCTHESIS</a>]  Tridgell, A., "Efficient Algorithms for Sorting and
                  Synchronization",
                  &lt;<a href="http://samba.org/~tridge/phd_thesis.pdf">http://samba.org/~tridge/phd_thesis.pdf</a>&gt;.














<span class="grey">Lewis &amp; Sergeant              Informational                    [Page 20]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-21" id="page-21" name="page-21"> </a>
<span class="grey"><a href="rfc6471.html">RFC 6471</a>                     DNSBL Practice                 January 2012</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/Appendix%20A.%20%20Acknowledgements"></a><a class="selflink" href="#appendix-A" name="appendix-A">Appendix A</a>.  Acknowledgements</span>

   We would like to thank John R. Levine, Alan Murphy, and Dave Crocker
   for their insightful comments.

   We would also like to thank Yakov Shafranovich and Nick Nicholas for
   editing draft versions of this document.

Authors' Addresses

   Chris Lewis
   Nortel Networks

   EMail: clewisbcp@cauce.org


   Matt Sergeant
   Symantec Corporation

   EMail: matt@sergeant.org































Lewis &amp; Sergeant              Informational                    [Page 21]

</pre><br/>
<span class="noprint"><small><small>Html markup produced by rfcmarkup 1.107, available from
<a href="http://tools.ietf.org/tools/rfcmarkup/">http://tools.ietf.org/tools/rfcmarkup/</a>
</small></small></span>


<meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

</body><!-- Mirrored from tools.ietf.org/html/rfc6471 by HTTrack Website Copier/3.x [XR&CO'2010], Wed, 19 Mar 2014 18:34:04 GMT --><!-- Added by HTTrack --></html>