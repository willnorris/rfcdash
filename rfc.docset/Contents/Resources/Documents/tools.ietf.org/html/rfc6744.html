<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head profile="http://dublincore.org/documents/2008/08/04/dc-html/">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="robots" content="index,follow" />
    <meta name="creator" content="rfcmarkup version 1.107" />
    <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" />
<meta name="DC.Identifier" content="urn:ietf:rfc:6744" />
<meta name="DC.Description.Abstract" content="The Identifier-Locator Network Protocol (ILNP) is an experimental,\nevolutionary enhancement to IP. ILNP has multiple instantiations. This\ndocument describes an experimental Nonce Destination Option used only\nwith ILNP for IPv6 (ILNPv6). This document is a product of the IRTF\nRouting Research Group. This document defines an Experimental Protocol\nfor the Internet community." />
<meta name="DC.Creator" content="RJ Atkinson &lt;rja.lists@gmail.com&gt;" />
<meta name="DC.Date.Issued" content="November, 2012" />
<meta name="DC.Title" content="IPv6 Nonce Destination Option for the Identifier-Locator Network Protocol for IPv6 (ILNPv6)" />

    <link rel="icon" href="http://tools.ietf.org/images/rfc.png" type="image/png" />
    <link rel="shortcut icon" href="http://tools.ietf.org/images/rfc.png" type="image/png" />
    <title>RFC 6744 - IPv6 Nonce Destination Option for the Identifier-Locator Network Protocol for IPv6 (ILNPv6)</title>
    
    
    <style type="text/css">
	body {
	    margin: 0px 8px;
            font-size: 1em;
	}
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
   <div style="height: 13px;">
      <div onmouseover="this.style.cursor='pointer';"
         onclick="showElem('legend');"
         onmouseout="hideElem('legend')"
	 style="height: 6px; position: absolute;"
         class="pre noprint docinfo bgyellow"
         title="Click for colour legend." >                                                                        </div>
      <div id="legend"
           class="docinfo noprint pre legend"
           style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; "
           onmouseover="showElem('legend');"
           onmouseout="hideElem('legend');">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="http://tools.ietf.org/rfc/rfc6744.txt" title="Plaintext version of this document">txt</a>|<a href="http://tools.ietf.org/pdf/rfc6744" title="PDF version of this document">pdf</a>] [<a href="http://tools.ietf.org/html/draft-irtf-rrg-ilnp-noncev6" title="draft-irtf-rrg-ilnp-noncev6">draft-irtf-rrg-il...</a>] [<a href="http://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc6744" title="Inline diff (wdiff)">Diff1</a>] [<a href="http://tools.ietf.org/rfcdiff?url2=rfc6744" title="Side-by-side diff">Diff2</a>]                 </span><br />
<span class="pre noprint docinfo">                                                                        </span><br />
<span class="pre noprint docinfo">                                                            EXPERIMENTAL</span><br />
<span class="pre noprint docinfo">                                                                        </span><br />
<pre>
Internet Research Task Force (IRTF)                          RJ Atkinson
Request for Comments: 6744                                    Consultant
Category: Experimental                                         SN Bhatti
ISSN: 2070-1721                                            U. St Andrews
                                                           November 2012


                 <span class="h1">IPv6 Nonce Destination Option for the</span>
         <span class="h1">Identifier-Locator Network Protocol for IPv6 (ILNPv6)</span>

Abstract

   The Identifier-Locator Network Protocol (ILNP) is an experimental,
   evolutionary enhancement to IP.  ILNP has multiple instantiations.
   This document describes an experimental Nonce Destination Option used
   only with ILNP for IPv6 (ILNPv6).  This document is a product of the
   IRTF Routing Research Group.

Status of This Memo

   This document is not an Internet Standards Track specification; it is
   published for examination, experimental implementation, and
   evaluation.

   This document defines an Experimental Protocol for the Internet
   community.  This document is a product of the Internet Research Task
   Force (IRTF).  The IRTF publishes the results of Internet-related
   research and development activities.  These results might not be
   suitable for deployment.  This RFC represents the individual
   opinion(s) of one or more members of the Routing Research Group of
   the Internet Research Task Force (IRTF).  Documents approved for
   publication by the IRSG are not a candidate for any level of Internet
   Standard; see <a href="rfc5741.html#section-2">Section&nbsp;2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc6744">http://www.rfc-editor.org/info/rfc6744</a>.














<span class="grey">Atkinson &amp; Bhatti             Experimental                      [Page 1]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-2" id="page-2" href="#page-2" class="invisible"> </a>
<span class="grey"><a href="rfc6744.html">RFC 6744</a>                  ILNP Nonce for IPv6              November 2012</span>


Copyright Notice

   Copyright (c) 2012 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="http://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.

   This document may not be modified, and derivative works of it may not
   be created, except to format it for publication as an RFC or to
   translate it into languages other than English.

Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-2">2</a>
      <a href="#section-1.1">1.1</a>. ILNP Document Roadmap ......................................<a href="#page-3">3</a>
      <a href="#section-1.2">1.2</a>. Terminology ................................................<a href="#page-5">5</a>
   <a href="#section-2">2</a>. Syntax ..........................................................<a href="#page-5">5</a>
   <a href="#section-3">3</a>. Transport Protocol Effects ......................................<a href="#page-6">6</a>
   <a href="#section-4">4</a>. Location Changes ................................................<a href="#page-7">7</a>
   <a href="#section-5">5</a>. Implementation Considerations ...................................<a href="#page-7">7</a>
      <a href="#section-5.1">5.1</a>. ILNP Communication Cache ...................................<a href="#page-8">8</a>
      <a href="#section-5.2">5.2</a>. Mode Indicator .............................................<a href="#page-8">8</a>
      <a href="#section-5.3">5.3</a>. IP Security ................................................<a href="#page-8">8</a>
   <a href="#section-6">6</a>. Backwards Compatibility .........................................<a href="#page-8">8</a>
   <a href="#section-7">7</a>. Security Considerations ........................................<a href="#page-10">10</a>
   <a href="#section-8">8</a>. IANA Considerations ............................................<a href="#page-12">12</a>
   <a href="#section-9">9</a>. References .....................................................<a href="#page-12">12</a>
      <a href="#section-9.1">9.1</a>. Normative References ......................................<a href="#page-12">12</a>
      <a href="#section-9.2">9.2</a>. Informative References ....................................<a href="#page-13">13</a>
   <a href="#section-10">10</a>. Acknowledgements ..............................................<a href="#page-14">14</a>

<span class="h2"><a class="selflink" name="section-1" href="#section-1">1</a>.  Introduction</span>

   This document is part of the ILNP document set, which has had
   extensive review within the IRTF Routing RG.  ILNP is one of the
   recommendations made by the RG Chairs.  Separately, various refereed
   research papers on ILNP have also been published during this decade.
   So, the ideas contained herein have had much broader review than the
   IRTF Routing RG.  The views in this document were considered
   controversial by the Routing RG, but the RG reached a consensus that
   the document still should be published.  The Routing RG has had
   remarkably little consensus on anything, so virtually all Routing RG
   outputs are considered controversial.



<span class="grey">Atkinson &amp; Bhatti             Experimental                      [Page 2]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-3" id="page-3" href="#page-3" class="invisible"> </a>
<span class="grey"><a href="rfc6744.html">RFC 6744</a>                  ILNP Nonce for IPv6              November 2012</span>


   At present, the Internet research and development community is
   exploring various approaches to evolving the Internet Architecture to
   solve a variety of issues including, but not limited to, scalability
   of inter-domain routing [<a href="rfc4984.html" title="&quot;Report from the IAB Workshop on Routing and Addressing&quot;">RFC4984</a>].  A wide range of other issues
   (e.g., site multihoming, node multihoming, site/subnet mobility, node
   mobility) are also active concerns at present.  Several different
   classes of evolution are being considered by the Internet research
   and development community.  One class is often called "Map and
   Encapsulate", where traffic would be mapped and then tunnelled
   through the inter-domain core of the Internet.  Another class being
   considered is sometimes known as "Identifier/Locator Split".  This
   document relates to a proposal that is in the latter class of
   evolutionary approaches.

   This document describes a new option for the IPv6 Destination Options
   header that is used with the Identifier-Locator Network Protocol for
   IPv6 (ILNPv6).  ILNPv6 is an experimental protocol that is backwards
   compatible with, and incrementally upgradable from, IPv6.  This
   option is ONLY used in ILNPv6 sessions and is never used with classic
   IPv6 sessions.

   The Nonce Option for the IPv6 Destination Options Header that is
   described in this document provides two functions.  First, it
   provides protection against off-path attacks for packets when ILNPv6
   is in use.  Second, it provides a signal during initial network-layer
   session creation that ILNPv6 is proposed for use with this network-
   layer session, rather than classic IPv6.  This last function is
   particularly important for ensuring that ILNP is both incrementally
   deployable and backwards compatible with IPv6.  Consequently, this
   option MUST NOT be used except by an ILNPv6-capable node.

   Further, each Nonce value is unidirectional.  Since packets often
   travel asymmetric paths between two correspondents, having separate
   Nonces for each direction limits the number of on-path nodes that can
   easily learn an ILNP session's nonce.  So a typical TCP session will
   have two different nonce values in use: one nonce is used from Local
   Node to the Correspondent Node and a different nonce is used from the
   Correspondent Node to the Local Node.

<span class="h3"><a class="selflink" name="section-1.1" href="#section-1.1">1.1</a>.  ILNP Document Roadmap</span>

   This document defines a new IPv6 Nonce Destination Option used by
   ILNPv6 nodes (1) to indicate to ILNP correspondent nodes (by
   inclusion within the initial packets of an ILNP session) that the
   node is operating in the ILNP mode and (2) to prevent off-path
   attacks against ILNP ICMP messages.  This Nonce is used, for example,
   with all ILNP ICMPv6 Locator Update messages that are exchanged among
   ILNP correspondent nodes.



<span class="grey">Atkinson &amp; Bhatti             Experimental                      [Page 3]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-4" id="page-4" href="#page-4" class="invisible"> </a>
<span class="grey"><a href="rfc6744.html">RFC 6744</a>                  ILNP Nonce for IPv6              November 2012</span>


   The ILNP architecture can have more than one engineering
   instantiation.  For example, one can imagine a "clean-slate"
   engineering design based on the ILNP architecture.  In separate
   documents, we describe two specific engineering instances of ILNP.
   The term "ILNPv6" refers precisely to an instance of ILNP that is
   based upon, and backwards compatible with, IPv6.  The term "ILNPv4"
   refers precisely to an instance of ILNP that is based upon, and
   backwards compatible with, IPv4.

   Many engineering aspects common to both ILNPv4 and ILNPv6 are
   described in [<a href="rfc6741.html" title="&quot;Identifier-Locator Network Protocol (ILNP) Engineering and Implementation Considerations&quot;">RFC6741</a>].  A full engineering specification for either
   ILNPv6 or ILNPv4 is beyond the scope of this document.

   Readers are referred to other related ILNP documents for details not
   described here:

   a) [<a href="rfc6740.html" title="&quot;Identifier-Locator Network Protocol (ILNP) Architectural Description&quot;">RFC6740</a>] is the main architectural description of ILNP, including
      the concept of operations.

   b) [<a href="rfc6741.html" title="&quot;Identifier-Locator Network Protocol (ILNP) Engineering and Implementation Considerations&quot;">RFC6741</a>] describes engineering and implementation considerations
      that are common to both ILNPv4 and ILNPv6.

   c) [<a href="rfc6742.html" title="&quot;DNS Resource Records for the Identifier-Locator Network Protocol (ILNP)&quot;">RFC6742</a>] defines additional DNS resource records that support
      ILNP.

   d) [<a href="rfc6743.html" title="&quot;ICMPv6 Locator Update Message&quot;">RFC6743</a>] defines a new ICMPv6 Locator Update message used by an
      ILNP node to inform its correspondent nodes of any changes to its
      set of valid Locators.

   e) [<a href="rfc6745.html" title="&quot;ICMP Locator Update Message for the Identifier-Locator Network Protocol for IPv4 (ILNPv4)&quot;">RFC6745</a>] defines a new ICMPv4 Locator Update message used by an
      ILNP node to inform its correspondent nodes of any changes to its
      set of valid Locators.

   f) [<a href="rfc6746.html" title="&quot;IPv4 Options for the Identifier-Locator Network Protocol (ILNP)&quot;">RFC6746</a>] defines a new IPv4 Nonce Option used by ILNPv4 nodes to
      carry a security nonce to prevent off-path attacks against ILNP
      ICMP messages and also defines a new IPv4 Identifier Option used
      by ILNPv4 nodes.

   g) [<a href="rfc6747.html" title="&quot;Address Resolution Protocol (ARP) Extension for the Identifier-Locator Network Protocol for IPv4 (ILNPv4)&quot;">RFC6747</a>] describes extensions to Address Resolution Protocol
      (ARP) for use with ILNPv4.

   h) [<a href="rfc6748.html" title="&quot;Optional Advanced Deployment Scenarios for the Identifier-Locator Network Protocol (ILNP)&quot;">RFC6748</a>] describes optional engineering and deployment functions
      for ILNP.  These are not required for the operation or use of ILNP
      and are provided as additional options.







<span class="grey">Atkinson &amp; Bhatti             Experimental                      [Page 4]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-5" id="page-5" href="#page-5" class="invisible"> </a>
<span class="grey"><a href="rfc6744.html">RFC 6744</a>                  ILNP Nonce for IPv6              November 2012</span>


<span class="h3"><a class="selflink" name="section-1.2" href="#section-1.2">1.2</a>.  Terminology</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [<a href="rfc2119.html" title="&quot;Key words for use in RFCs to Indicate Requirement Levels&quot;">RFC2119</a>].

<span class="h2"><a class="selflink" name="section-2" href="#section-2">2</a>.  Syntax</span>

   The Nonce Option is carried within an IPv6 Destination Options
   header.  <a href="rfc2460.html#section-4">Section&nbsp;4 of [RFC2460]</a> provides much more information on the
   various options and optional headers used with IPv6.

   More than one option might be inside the IPv6 Destination Options
   Header; however, at most, one Nonce Option exists in a given IPv6
   packet.

   A system that receives a packet containing more than one Nonce Option
   SHOULD discard the packet as "Authentication Failed" (instead of
   passing the packet up to the appropriate transport-layer protocol or
   to ICMP) and SHOULD log the event, including the Source Locator,
   Source Identifier, Destination Locator, Destination Identifier,
   upper-layer protocol (e.g., OSPF, TCP, UDP) if any, and transport-
   layer port numbers (if any), as a security fault in accordance with
   local logging policies.

   As of this writing, IPv6 Destination Options headers, and the options
   carried by such headers, are extremely uncommon in the deployed
   Internet.  So, it is expected that this Nonce Option commonly would
   be the only IPv6 Destination Option present in a given IPv6 packet.
   If a Common Architecture Label IPv6 Security Option (CALIPSO) label
   option [<a href="rfc5570.html" title="&quot;Common Architecture Label IPv6 Security Option (CALIPSO)&quot;">RFC5570</a>] is also present in the same IPv6 Destination Options
   header, the CALIPSO Option SHOULD precede the Nonce Option.  The
   Nonce Option SHOULD precede other possible options in the same IPv6
   Destination Options header.

   In the diagram below, we show not only the Nonce Option but also the
   IPv6 Destination Options header that carries the Nonce Option.

     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    | Next Header   | Hdr Ext Len   |  Option Type  | Option Length |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    /                         Nonce Value                           /
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+






<span class="grey">Atkinson &amp; Bhatti             Experimental                      [Page 5]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-6" id="page-6" href="#page-6" class="invisible"> </a>
<span class="grey"><a href="rfc6744.html">RFC 6744</a>                  ILNP Nonce for IPv6              November 2012</span>


   Next Header:       8-bit selector.  Identifies the type of header
                      immediately following the Destination Options
                      header.  This field uses the same values as the
                      IPv4 Protocol field, as described in [<a href="rfc2460.html" title="&quot;Internet Protocol, Version 6 (IPv6) Specification&quot;">RFC2460</a>].

   Hdr Ext Len:       8-bit unsigned integer.  Length of the Destination
                      Options header in 8-octet units, not including the
                      first 8 octets.

   Option Type:       This contains the value 0x8B (139).  This is the
                      first octet of the Nonce Option itself.

   Option Length:     This indicates the length in 8-bit octets of the
                      Nonce Value field of the Nonce Option.  This value
                      must be selected so that the enveloping IPv6
                      Destination Option complies with the IPv6 header
                      alignment rules.  Common values are 4 (when the
                      Nonce Value is 32 bits) and 12 (when the Nonce
                      value is 96 bits).

   Nonce Value:       An unpredictable cryptographically random value
                      [<a href="rfc4086.html" title="&quot;Randomness Requirements for Security&quot;">RFC4086</a>] used to prevent off-path attacks on an
                      ILNP session.  This field has variable length,
                      with the length indicated by the Option Length
                      field preceding it.  Note that the overall IPv6
                      IPv6 Destination Option MUST comply with IPv6
                      header alignment rules.  Implementations MUST
                      support sending and receiving 32-bit and 96-bit
                      Nonce values.

<span class="h2"><a class="selflink" name="section-3" href="#section-3">3</a>.  Transport Protocol Effects</span>

   When the initial packet(s) of an IPv6 session contain this Nonce
   Destination Option, ILNPv6 is in use for that network-layer session.
   (NOTE: Backwards compatibility and incremental deployment are
   discussed in more detail in <a href="#section-6">Section 6</a> below.)

   When a network-layer session is using ILNPv6, the transport-layer
   pseudo-header calculations MUST set to zero the high-order 64-bits
   ("Locator" or "Routing Prefix") of each IPv6 address.  This has the
   effect that the transport-layer is no longer aware of the topological
   network location of either node in that transport-layer session.

   The preceding rule applies not only to unicast ILNPv6 sessions but
   also to multicast or anycast ILNPv6 sessions.






<span class="grey">Atkinson &amp; Bhatti             Experimental                      [Page 6]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-7" id="page-7" href="#page-7" class="invisible"> </a>
<span class="grey"><a href="rfc6744.html">RFC 6744</a>                  ILNP Nonce for IPv6              November 2012</span>


<span class="h2"><a class="selflink" name="section-4" href="#section-4">4</a>.  Location Changes</span>

   When a node has a change in its Locator set that causes all
   previously valid Locators to become invalid, the node MUST send an
   ICMP Locator Update message (containing the Nonce Option with the
   appropriate nonce value) to each of its correspondents [<a href="rfc6740.html" title="&quot;Identifier-Locator Network Protocol (ILNP) Architectural Description&quot;">RFC6740</a>]
   [<a href="rfc6743.html" title="&quot;ICMPv6 Locator Update Message&quot;">RFC6743</a>].

   In the deployed Internet, packets sometimes arrive at a destination
   out of order.  A receiving node MUST drop a packet arriving from a
   correspondent if the Source Locator of the received packet is not in
   the receiving node's Identifier-Locator Communication Cache's
   (ILCC's) Set of Correspondent Locators UNLESS that packet contains a
   Nonce Option with the appropriate nonce value for that Source
   Identifier and Destination Identifier pair.  This is done to reduce
   the risk of ILNP session hijacking or ILNP session interference
   attacks.

   Hence, the node that has had all previously valid Locators become
   invalid MUST include the Nonce Option with the appropriate nonce
   value in all packets (data or otherwise) to all correspondents for at
   least three round-trip times (RTTs) for each correspondent.  (N.B. An
   implementation need not actually calculate RTT values; it could just
   use a fixed timer with a time long enough to cover the longest RTT
   path, such as 1 minute.)  This "gratuitous authentication" ensures
   that the correspondent can authenticate any received packet, even if
   the ICMP Locator Update control message arrives and is processed
   AFTER some other packet using the new Source Locator(s).  If an ILNP
   session is using IPsec, then, of course, IPsec SHOULD continue to be
   used even if one or more participating nodes change location.
   Because IP Security for ILNP [<a href="rfc6741.html" title="&quot;Identifier-Locator Network Protocol (ILNP) Engineering and Implementation Considerations&quot;">RFC6741</a>] binds only to the Identifiers,
   and not to the Locators in the packet, changes in Locator value have
   no impact on IP Security for ILNP sessions.

   As mobility and multihoming are functionally equivalent for ILNP,
   this section applies equally to either situation and also to any
   other situation in which a node's set of Locators might change over
   time.

<span class="h2"><a class="selflink" name="section-5" href="#section-5">5</a>.  Implementation Considerations</span>

   Implementers may use any internal implementation they wish, PROVIDED
   that the externally visible behaviour is the same as this
   implementation approach.







<span class="grey">Atkinson &amp; Bhatti             Experimental                      [Page 7]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-8" id="page-8" href="#page-8" class="invisible"> </a>
<span class="grey"><a href="rfc6744.html">RFC 6744</a>                  ILNP Nonce for IPv6              November 2012</span>


<span class="h3"><a class="selflink" name="section-5.1" href="#section-5.1">5.1</a>.  ILNP Communication Cache</span>

   As described in [<a href="rfc6741.html" title="&quot;Identifier-Locator Network Protocol (ILNP) Engineering and Implementation Considerations&quot;">RFC6741</a>], ILNP nodes maintain an Identifier-Locator
   Communication Cache (ILCC) that contains several variables for each
   correspondent.  The ILNP Nonce value is an important part of that
   cache.

<span class="h3"><a class="selflink" name="section-5.2" href="#section-5.2">5.2</a>.  Mode Indicator</span>

   To support ILNP, and to retain needed incremental deployability and
   backwards compatibility, the network layer needs a (logical) mode bit
   in the Transport Control Block (or equivalent for one's
   implementation) to track which IP sessions are using traditional IPv6
   and which IP sessions are using ILNPv6.

   If a given transport-layer session is using ILNP, then an entry
   corresponding to the network-layer components of that transport-layer
   session also will exist in the ILNP Communication Cache.  Multiple
   transport-layer sessions between a given pair of nodes normally share
   a single entry in the ILNP Communication Cache, provided their
   network-layer details (e.g., Identifiers, Nonces) are identical.
   Because two different ILNP nodes at two different locations might
   share the same Identifier value, it is important for an ILNP
   implementation to use the ILNP Nonce values to distinguish between
   different ILNP nodes that happen to be using the same (or some of the
   same) Identifier value(s).

<span class="h3"><a class="selflink" name="section-5.3" href="#section-5.3">5.3</a>.  IP Security</span>

   Whether or not ILNP is in use, the IPsec subsystem MUST maintain an
   IPsec Security Association Database (SAD) and MUST maintain
   information about which IPsec Selectors apply to traffic received by
   or sent from the local node [<a href="rfc4301.html" title="&quot;Security Architecture for the Internet Protocol&quot;">RFC4301</a>].  By combining the information
   in the IPsec SAD, of what IPsec Selectors apply, and the information
   in the ILCC, an implementation has sufficient knowledge to apply
   IPsec properly to both received and transmitted packets.

<span class="h2"><a class="selflink" name="section-6" href="#section-6">6</a>.  Backwards Compatibility</span>

   This option MUST NOT be present in an IPv6 packet unless the packet
   is part of an ILNPv6 session.  As is explained below in more detail,
   the presence or absence of this option from the initial packets of a
   new IPv6 session is an important indication of whether the session is
   using classic IPv6 or ILNPv6.

   ILNPv6 nodes MUST include this option in the first few packets of
   each ILNPv6 session, MUST include this option in all ICMP messages
   generated by endpoints participating in an ILNPv6 session, and MAY



<span class="grey">Atkinson &amp; Bhatti             Experimental                      [Page 8]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-9" id="page-9" href="#page-9" class="invisible"> </a>
<span class="grey"><a href="rfc6744.html">RFC 6744</a>                  ILNP Nonce for IPv6              November 2012</span>


   include this option in any and all packets of an ILNPv6 session.  It
   is recommended that this option be included in all packets of the
   ILNPv6 session if the packet loss for that session is known to be
   much higher than normal.

   If a node supports ILNP and the node wishes to be able to receive
   incoming new ILNP sessions, then that node's FQDN SHOULD have one or
   more Node Identifier (NID) records and also one or more Locator
   (e.g., L64 or LP) records associated with it in the DNS [<a href="rfc6742.html" title="&quot;DNS Resource Records for the Identifier-Locator Network Protocol (ILNP)&quot;">RFC6742</a>].

   When a host ("initiator") initiates a new IP session with a
   correspondent ("responder"), it normally will perform a DNS lookup to
   determine the address(es) of the responder.  A host that has been
   enhanced to support the Identifier/Locator Split operating mode
   SHOULD look for Node Identifier ("NID") and Locator ("L64") records
   in any received DNS replies.  DNS servers that support Identifier and
   Locator (i.e., L64 or LP) records might include them (when they
   exist) as additional data in all DNS replies to DNS queries for DNS A
   or AAAA records associated with a specified DNS FQDN.

   If the initiator supports ILNP, and from DNS data learns that the
   responder also supports ILNP, then the initiator SHOULD attempt to
   use ILNP for new sessions with that responder.  In such cases, the
   initiator MUST generate an unpredictable, cryptographically random,
   ILNP Nonce value, MUST store that ILNP Nonce value in the local ILCC,
   and MUST include the ILNP Nonce Destination Option in its initial
   packet(s) to the responder.  The IETF has provided advice on
   generating cryptographically random numbers, such as this nonce value
   [<a href="rfc4086.html" title="&quot;Randomness Requirements for Security&quot;">RFC4086</a>].

   If the responder supports ILNP and receives initial packet(s)
   containing the ILNP Nonce Destination Option, the responder will
   thereby learn that the initiator supports ILNP and the responder also
   will use ILNP for this new IP session.

   If the responder supports ILNP and receives initial IP packet(s) NOT
   containing the Nonce Destination Option, the responder will thereby
   learn that the initiator does NOT support ILNP and the responder will
   use classic IPv6 for this new IP session.

   If the responder does not support ILNP and receives initial packet(s)
   containing the ILNP Nonce Destination Option, the responder MUST drop
   the packet and MUST send an ICMP "Parameter Problem" error message
   back to the initiator [<a href="rfc4443.html" title="&quot;Internet Control Message Protocol (ICMPv6) for the Internet Protocol Version 6 (IPv6) Specification&quot;">RFC4443</a>].  Indeed, it is not expected that
   this behaviour will need to be coded into non-ILNP nodes, as this is
   the normal behaviour for nodes receiving unknown option headers.





<span class="grey">Atkinson &amp; Bhatti             Experimental                      [Page 9]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-10" id="page-10" href="#page-10" class="invisible"> </a>
<span class="grey"><a href="rfc6744.html">RFC 6744</a>                  ILNP Nonce for IPv6              November 2012</span>


   If the initiator EITHER does not receive a response from the
   responder in a timely manner (e.g., within the applicable TCP timeout
   for a TCP session), and does not receive an ICMP Unreachable error
   message for that packet, OR receives an ICMP Parameter Problem error
   message for that packet, then the initiator infers that the responder
   is not able to support ILNP.  In this case, the initiator should try
   again to create the new IP session, but this time use classic IPv6
   and hence MUST NOT include the ILNP Nonce Destination Option.

<span class="h2"><a class="selflink" name="section-7" href="#section-7">7</a>.  Security Considerations</span>

   The ILNPv6 Nonce Destination Option is used ONLY for ILNPv6 sessions,
   because this option is part of the backwards compatibility and
   incremental-deployment approach for the Identifier-Locator Network
   Protocol (ILNP).  This option MUST NOT be used with classic IPv6
   sessions.

   The ILNPv6 Nonce Destination Option only seeks to provide protection
   against off-path attacks on an IP session.  Ordinary IPv6 is
   vulnerable to on-path attacks unless IPsec is in use [<a href="#ref-CA-1995-01" title="&quot;CERT Advisory CA-1995-01 IP Spoofing Attacks and Hijacked Terminal Connections&quot;">CA-1995-01</a>]
   [<a href="rfc4301.html" title="&quot;Security Architecture for the Internet Protocol&quot;">RFC4301</a>].  This option exists to provide non-cryptographic
   protection for ILNP sessions, protection equivalent to the security
   of IP sessions that do NOT use IPsec.

   When ILNPv6 is in use, the ILNP Nonce Destination Option MUST be
   included in any ICMP control messages (e.g., ICMP Unreachable, ICMP
   Locator Update) sent by participants in that ILNPv6 session, even if
   IPsec also is in use for that ILNPv6 session.  Note that certain ICMP
   messages, for example, a "Packet Too Big" message, might be generated
   by transit devices that are not aware of the ILNP Nonce in use for
   that ILNPv6 session; hence, they are not able to include the ILNP
   Nonce.  Again, this is also true of classic IPv6 in the same
   operational situations, so this does not create a new security issue.

   For ILNPv6 sessions, any ICMP control messages received from a
   participant in that ILNPv6 session that lack a Nonce Destination
   Option MUST be discarded as forgeries.  This security event SHOULD be
   logged in accordance with local security logging policies, including
   details of the received packet (i.e., Source Locator, Source
   Identifier, Destination Locator, Destination Identifier, upper-layer
   protocol (e.g., TCP, UDP, OSPF) if any, transport-layer port numbers
   if any, and the date and time the packet was received).

   For ILNPv6 sessions, ICMP control messages received from a
   participant in that ILNPv6 session that have a Nonce Destination
   Option, but do NOT have the correct nonce value inside the Nonce
   Destination Option, MUST be discarded as forgeries.  This security
   event SHOULD be logged as described above.



<span class="grey">Atkinson &amp; Bhatti             Experimental                     [Page 10]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-11" id="page-11" href="#page-11" class="invisible"> </a>
<span class="grey"><a href="rfc6744.html">RFC 6744</a>                  ILNP Nonce for IPv6              November 2012</span>


   Of course, longer nonce values provide greater resistance to random
   guessing of the nonce value.  However, ILNPv6 sessions operating in
   higher risk environments SHOULD also use the cryptographic
   authentication provided by IP Security for ILNP [<a href="rfc6741.html" title="&quot;Identifier-Locator Network Protocol (ILNP) Engineering and Implementation Considerations&quot;">RFC6741</a>] [<a href="rfc4301.html" title="&quot;Security Architecture for the Internet Protocol&quot;">RFC4301</a>].
   Use of IP Security for ILNP for an ILNPv6 session does not eliminate
   the need for the ILNPv6 Nonce Option to be included as described here
   or as described in [<a href="rfc6743.html" title="&quot;ICMPv6 Locator Update Message&quot;">RFC6743</a>].

   As a performance optimisation, it is suggested that when both the
   Nonce Option and IPsec are present in a packet and the Nonce Option
   has not been encrypted the Nonce Option value be checked for validity
   before beginning IPsec processing.  This minimises the ability of an
   off-path attacker to force the recipient to perform expensive
   cryptographic computations on received control packets.

   For environments with data at differing Sensitivity Levels operating
   over common infrastructure (e.g., when the IPv6 CALIPSO is deployed),
   it is recommended that the ILNP Nonce Option be encrypted by using
   ESP Transport-Mode or ESP Tunnel-Mode in order to reduce the covert
   channel bandwidth potential created by the Nonce Option and to
   prevent a node at one Sensitivity Level from attacking an ILNP
   session at a different Sensitivity Level [<a href="rfc5570.html" title="&quot;Common Architecture Label IPv6 Security Option (CALIPSO)&quot;">RFC5570</a>].  Further, Multi-
   Level Secure (MLS) systems SHOULD use different nonce values for ILNP
   sessions having different Sensitivity Levels [<a href="rfc5570.html" title="&quot;Common Architecture Label IPv6 Security Option (CALIPSO)&quot;">RFC5570</a>].  Also, an MLS
   implementation of ILNP will also store the Sensitivity Label
   information associated with each ILNP session in the implementation's
   ILCC.  When the Nonce Option and the CALIPSO Option are present in
   the same IPv6 Destination Options header, the CALIPSO Option SHOULD
   appear before the Nonce Option.

   In all cases, the ILNP Nonce Value MUST be unpredictable and
   cryptographically random.  [<a href="rfc4086.html" title="&quot;Randomness Requirements for Security&quot;">RFC4086</a>] provides concrete advice on how
   to generate a suitable nonce value.

   As this is an option within the IPv6 Destination Options header,
   rather than an option within the IPv6 Hop-by-Hop Option Header, the
   presence of this option in an IPv6 packet ought not disturb routers
   along the path an IP packet containing this option happens to travel.
   Further, many deployed modern IP routers (both IPv4 and IPv6) have
   been explicitly configured to ignore all IP Options, even including
   the "Router Alert" option, when forwarding packets not addressed to
   the router itself.  Reports indicate this has been done to preclude
   use of IP Options as a (Distributed) Denial-of-Service attack vector
   on backbone routers.







<span class="grey">Atkinson &amp; Bhatti             Experimental                     [Page 11]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-12" id="page-12" href="#page-12" class="invisible"> </a>
<span class="grey"><a href="rfc6744.html">RFC 6744</a>                  ILNP Nonce for IPv6              November 2012</span>


   As the Nonce is used in the checksum of all Authentication Header
   (AH) protected packets, as an implementation hint, it would seem
   sensible to include the Nonce value from the ILCC for that ILNP
   session.

<span class="h2"><a class="selflink" name="section-8" href="#section-8">8</a>.  IANA Considerations</span>

   Consistent with the procedures of [<a href="rfc2780.html" title="&quot;IANA Allocation Guidelines For Values In the Internet Protocol and Related Headers&quot;">RFC2780</a>], IANA has assigned a new
   IPv6 Destination Option Type value of 0x8B.

   The Nonce Option MUST NOT change in transit and MUST be included in
   IP Authentication Header calculations.

   Further, if an end system receives an IPv6 packet containing this
   option, but does not recognise this option, the end system MUST
   discard the packet and, regardless of whether or not the received
   packet's Destination Address was a multicast address, send an ICMPv6
   Parameter Problem, Code 2 ("Unrecognised IPv6 Option Encountered"),
   message to the received packet's Source IPv6 Address, pointing to the
   unrecognised Option Type.

<span class="h2"><a class="selflink" name="section-9" href="#section-9">9</a>.  References</span>

<span class="h3"><a class="selflink" name="section-9.1" href="#section-9.1">9.1</a>.  Normative References</span>

   [<a name="ref-RFC2119" id="ref-RFC2119">RFC2119</a>]     Bradner, S., "Key words for use in RFCs to Indicate
                 Requirement Levels", <a href="http://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.

   [<a name="ref-RFC2460" id="ref-RFC2460">RFC2460</a>]     Deering, S. and R. Hinden, "Internet Protocol, Version
                 6 (IPv6) Specification", <a href="rfc2460.html">RFC 2460</a>, December 1998.

   [<a name="ref-RFC2780" id="ref-RFC2780">RFC2780</a>]     Bradner, S. and V. Paxson, "IANA Allocation Guidelines
                 For Values In the Internet Protocol and Related
                 Headers", <a href="http://tools.ietf.org/html/bcp37">BCP 37</a>, <a href="rfc2780.html">RFC 2780</a>, March 2000.

   [<a name="ref-RFC4301" id="ref-RFC4301">RFC4301</a>]     Kent, S. and K. Seo, "Security Architecture for the
                 Internet Protocol", <a href="rfc4301.html">RFC 4301</a>, December 2005.

   [<a name="ref-RFC4443" id="ref-RFC4443">RFC4443</a>]     Conta, A., Deering, S., and M. Gupta, Ed., "Internet
                 Control Message Protocol (ICMPv6) for the Internet
                 Protocol Version 6 (IPv6) Specification", <a href="rfc4443.html">RFC 4443</a>,
                 March 2006.

   [<a name="ref-RFC6740" id="ref-RFC6740">RFC6740</a>]     Atkinson, R. and S. Bhatti, "Identifier-Locator Network
                 Protocol (ILNP) Architectural Description", <a href="rfc6740.html">RFC 6740</a>,
                 November 2012.





<span class="grey">Atkinson &amp; Bhatti             Experimental                     [Page 12]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-13" id="page-13" href="#page-13" class="invisible"> </a>
<span class="grey"><a href="rfc6744.html">RFC 6744</a>                  ILNP Nonce for IPv6              November 2012</span>


   [<a name="ref-RFC6741" id="ref-RFC6741">RFC6741</a>]     Atkinson, R. and S. Bhatti, "Identifier-Locator Network
                 Protocol (ILNP) Engineering and Implementation
                 Considerations", <a href="rfc6741.html">RFC 6741</a>, November 2012.

   [<a name="ref-RFC6743" id="ref-RFC6743">RFC6743</a>]     Atkinson, R. and S. Bhatti, "ICMPv6 Locator Update
                 Message", <a href="rfc6743.html">RFC 6743</a>, November 2012.

<span class="h3"><a class="selflink" name="section-9.2" href="#section-9.2">9.2</a>.  Informative References</span>

   [<a name="ref-CA-1995-01" id="ref-CA-1995-01">CA-1995-01</a>]  US CERT, "CERT Advisory CA-1995-01 IP Spoofing Attacks
                 and Hijacked Terminal Connections", Pittsburgh, PA,
                 USA, 1995.

   [<a name="ref-RFC4086" id="ref-RFC4086">RFC4086</a>]     Eastlake 3rd, D., Schiller, J., and S. Crocker,
                 "Randomness Requirements for Security", <a href="http://tools.ietf.org/html/bcp106">BCP 106</a>, <a href="rfc4086.html">RFC</a>
                 <a href="rfc4086.html">4086</a>, June 2005.

   [<a name="ref-RFC4984" id="ref-RFC4984">RFC4984</a>]     Meyer, D., Ed., Zhang, L., Ed., and K. Fall, Ed.,
                 "Report from the IAB Workshop on Routing and
                 Addressing", <a href="rfc4984.html">RFC 4984</a>, September 2007.

   [<a name="ref-RFC5570" id="ref-RFC5570">RFC5570</a>]     StJohns, M., Atkinson, R., and G. Thomas, "Common
                 Architecture Label IPv6 Security Option (CALIPSO)", <a href="rfc5570.html">RFC</a>
                 <a href="rfc5570.html">5570</a>, July 2009.

   [<a name="ref-RFC6742" id="ref-RFC6742">RFC6742</a>]     Atkinson, R., Bhatti, S. and S. Rose, "DNS Resource
                 Records for the Identifier-Locator Network Protocol
                 (ILNP)", <a href="rfc6742.html">RFC 6742</a>, November 2012.

   [<a name="ref-RFC6745" id="ref-RFC6745">RFC6745</a>]     Atkinson, R. and S. Bhatti,  "ICMP Locator Update
                 Message for the Identifier-Locator Network Protocol for
                 IPv4 (ILNPv4)", <a href="rfc6745.html">RFC 6745</a>, November 2012.

   [<a name="ref-RFC6746" id="ref-RFC6746">RFC6746</a>]     Atkinson, R. and S.Bhatti, "IPv4 Options for the
                 Identifier-Locator Network Protocol (ILNP)", <a href="rfc6746.html">RFC 6746</a>,
                 November 2012.

   [<a name="ref-RFC6747" id="ref-RFC6747">RFC6747</a>]     Atkinson, R. and S. Bhatti, "Address Resolution
                 Protocol (ARP) Extension for the Identifier-Locator
                 Network Protocol for IPv4 (ILNPv4)", <a href="rfc6747.html">RFC 6747</a>, November
                 2012.

   [<a name="ref-RFC6748" id="ref-RFC6748">RFC6748</a>]     Atkinson, R. and S. Bhatti, "Optional Advanced
                 Deployment Scenarios for the Identifier-Locator Network
                 Protocol (ILNP)", <a href="rfc6748.html">RFC 6748</a>, November 2012.






<span class="grey">Atkinson &amp; Bhatti             Experimental                     [Page 13]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-14" id="page-14" href="#page-14" class="invisible"> </a>
<span class="grey"><a href="rfc6744.html">RFC 6744</a>                  ILNP Nonce for IPv6              November 2012</span>


<span class="h2"><a class="selflink" name="section-10" href="#section-10">10</a>.  Acknowledgements</span>

   Steve Blake, Stephane Bortzmeyer, Mohamed Boucadair, Noel Chiappa,
   Wes George, Steve Hailes, Joel Halpern, Mark Handley, Volker Hilt,
   Paul Jakma, Dae-Young Kim, Tony Li, Yakov Rehkter, Bruce Simpson,
   Robin Whittle, and John Wroclawski (in alphabetical order) provided
   review and feedback on earlier versions of this document.  Steve
   Blake provided an especially thorough review of an early version of
   the entire ILNP document set, which was extremely helpful.  We also
   wish to thank the anonymous reviewers of the various ILNP papers for
   their feedback.

   Roy Arends provided expert guidance on technical and procedural
   aspects of DNS issues.

Authors' Addresses

   RJ Atkinson
   Consultant
   San Jose, CA 95125
   USA

   EMail: rja.lists@gmail.com


   SN Bhatti
   School of Computer Science
   University of St Andrews
   North Haugh, St Andrews
   Fife  KY16 9SX
   Scotland, UK

   EMail: saleem@cs.st-andrews.ac.uk


















Atkinson &amp; Bhatti             Experimental                     [Page 14]

</pre><br />
<span class="noprint"><small><small>Html markup produced by rfcmarkup 1.107, available from
<a href="http://tools.ietf.org/tools/rfcmarkup/">http://tools.ietf.org/tools/rfcmarkup/</a>
</small></small></span>
</body>
<!-- Mirrored from tools.ietf.org/html/rfc6744 by HTTrack Website Copier/3.x [XR&CO'2010], Wed, 19 Mar 2014 18:33:02 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8"><!-- /Added by HTTrack -->
</html>
