<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head profile="http://dublincore.org/documents/2008/08/04/dc-html/">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="robots" content="index,follow" />
    <meta name="creator" content="rfcmarkup version 1.107" />
    <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" />
<meta name="DC.Relation.Replaces" content="draft-johnston-sipping-rtcp-summary" />
<meta name="DC.Identifier" content="urn:ietf:rfc:6035" />
<meta name="DC.Date.Issued" content="November, 2010" />
<meta name="DC.Creator" content="Johnston, Alan" />
<meta name="DC.Creator" content="Pendleton, Amy" />
<meta name="DC.Creator" content="Sinnreich, Henry" />
<meta name="DC.Creator" content="Clark, Alan" />
<meta name="DC.Description.Abstract" content="This document defines a Session Initiation Protocol (SIP) event\npackage that enables the collection and reporting of metrics that\nmeasure the quality for Voice over Internet Protocol (VoIP) sessions.\nVoice call quality information derived from RTP Control Protocol\nExtended Reports (RTCP-XR) and call information from SIP is conveyed\nfrom a User Agent (UA) in a session, known as a reporter, to a third\nparty, known as a collector. A registration for the application/ vq-\nrtcpxr media type is also included. [STANDARDS-TRACK]" />
<meta name="DC.Title" content="Session Initiation Protocol Event Package for Voice Quality Reporting" />

    <link rel="icon" href="http://tools.ietf.org/images/rfc.png" type="image/png" />
    <link rel="shortcut icon" href="http://tools.ietf.org/images/rfc.png" type="image/png" />
    <title>RFC 6035 - Session Initiation Protocol Event Package for Voice Quality Reporting</title>
    
    
    <style type="text/css">
	body {
	    margin: 0px 8px;
            font-size: 1em;
	}
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
   <div style="height: 13px;">
      <div onmouseover="this.style.cursor='pointer';"
         onclick="showElem('legend');"
         onmouseout="hideElem('legend')"
	 style="height: 6px; position: absolute;"
         class="pre noprint docinfo bgblue"
         title="Click for colour legend." >                                                                        </div>
      <div id="legend"
           class="docinfo noprint pre legend"
           style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; "
           onmouseover="showElem('legend');"
           onmouseout="hideElem('legend');">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="http://tools.ietf.org/rfc/rfc6035.txt" title="Plaintext version of this document">txt</a>|<a href="http://tools.ietf.org/pdf/rfc6035" title="PDF version of this document">pdf</a>] [<a href="http://tools.ietf.org/html/draft-ietf-sipping-rtcp-summary" title="draft-ietf-sipping-rtcp-summary">draft-ietf-sippin...</a>] [<a href="http://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc6035" title="Inline diff (wdiff)">Diff1</a>] [<a href="http://tools.ietf.org/rfcdiff?url2=rfc6035" title="Side-by-side diff">Diff2</a>] [<a href="http://www.rfc-editor.org/errata_search.php?rfc=6035">Errata</a>]        </span><br />
<span class="pre noprint docinfo">                                                                        </span><br />
<span class="pre noprint docinfo">                                                       PROPOSED STANDARD</span><br />
<span class="pre noprint docinfo">                                                            <span style='color: #C00;'>Errata Exist</span></span><br />
<pre>
Internet Engineering Task Force (IETF)                      A. Pendleton
Request for Comments: 6035                                      A. Clark
Category: Standards Track                          Telchemy Incorporated
ISSN: 2070-1721                                              A. Johnston
                                                                   Avaya
                                                            H. Sinnreich
                                                            Unaffiliated
                                                           November 2010


 <span class="h1">Session Initiation Protocol Event Package for Voice Quality Reporting</span>

Abstract

   This document defines a Session Initiation Protocol (SIP) event
   package that enables the collection and reporting of metrics that
   measure the quality for Voice over Internet Protocol (VoIP) sessions.
   Voice call quality information derived from RTP Control Protocol
   Extended Reports (RTCP-XR) and call information from SIP is conveyed
   from a User Agent (UA) in a session, known as a reporter, to a third
   party, known as a collector.  A registration for the application/ vq-
   rtcpxr media type is also included.

Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in <a href="rfc5741.html#section-2">Section&nbsp;2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc6035">http://www.rfc-editor.org/info/rfc6035</a>.















<span class="grey">Pendleton, et al.            Standards Track                    [Page 1]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-2" id="page-2" href="#page-2" class="invisible"> </a>
<span class="grey"><a href="rfc6035.html">RFC 6035</a>         SIP Package for Voice Quality Reporting   November 2010</span>


Copyright Notice

   Copyright (c) 2010 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="http://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in <a href="#section-4">Section 4</a>.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

   This document may contain material from IETF Documents or IETF
   Contributions published or made publicly available before November
   10, 2008.  The person(s) controlling the copyright in some of this
   material may not have granted the IETF Trust the right to allow
   modifications of such material outside the IETF Standards Process.
   Without obtaining an adequate license from the person(s) controlling
   the copyright in such materials, this document may not be modified
   outside the IETF Standards Process, and derivative works of it may
   not be created outside the IETF Standards Process, except to format
   it for publication as an RFC or to translate it into languages other
   than English.

























<span class="grey">Pendleton, et al.            Standards Track                    [Page 2]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-3" id="page-3" href="#page-3" class="invisible"> </a>
<span class="grey"><a href="rfc6035.html">RFC 6035</a>         SIP Package for Voice Quality Reporting   November 2010</span>


Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-4">4</a>
      <a href="#section-1.1">1.1</a>. Applicability Statement ....................................<a href="#page-4">4</a>
      <a href="#section-1.2">1.2</a>. Use of the Mechanism .......................................<a href="#page-4">4</a>
   <a href="#section-2">2</a>. Terminology .....................................................<a href="#page-6">6</a>
   <a href="#section-3">3</a>. SIP Events for VoIP Quality Reporting ...........................<a href="#page-6">6</a>
      <a href="#section-3.1">3.1</a>. SUBSCRIBE NOTIFY Method ....................................<a href="#page-6">6</a>
      <a href="#section-3.2">3.2</a>. PUBLISH Method .............................................<a href="#page-7">7</a>
      <a href="#section-3.3">3.3</a>. Multi-Party and Multi-Segment Calls ........................<a href="#page-7">7</a>
      <a href="#section-3.4">3.4</a>. Overload Avoidance .........................................<a href="#page-7">7</a>
   <a href="#section-4">4</a>. Event Package Formal Definition .................................<a href="#page-8">8</a>
      <a href="#section-4.1">4.1</a>. Event Package Name .........................................<a href="#page-8">8</a>
      <a href="#section-4.2">4.2</a>. Event Package Parameters ...................................<a href="#page-8">8</a>
      <a href="#section-4.3">4.3</a>. SUBSCRIBE Bodies ...........................................<a href="#page-8">8</a>
      <a href="#section-4.4">4.4</a>. Subscribe Duration .........................................<a href="#page-8">8</a>
      <a href="#section-4.5">4.5</a>. NOTIFY Bodies ..............................................<a href="#page-8">8</a>
      <a href="#section-4.6">4.6</a>. Voice Quality Event and Semantics .........................<a href="#page-10">10</a>
           <a href="#section-4.6.1">4.6.1</a>. ABNF Syntax Definition .............................<a href="#page-10">10</a>
           <a href="#section-4.6.2">4.6.2</a>. Parameter Definitions and Mappings .................<a href="#page-21">21</a>
      <a href="#section-4.7">4.7</a>. Message Flow and Syntax Examples ..........................<a href="#page-29">29</a>
           <a href="#section-4.7.1">4.7.1</a>. End of Session Report Using NOTIFY .................<a href="#page-29">29</a>
           <a href="#section-4.7.2">4.7.2</a>. Midsession Threshold Violation Using NOTIFY ........<a href="#page-32">32</a>
           <a href="#section-4.7.3">4.7.3</a>. End of Session Report Using PUBLISH ................<a href="#page-35">35</a>
           <a href="#section-4.7.4">4.7.4</a>. Alert Report Using PUBLISH .........................<a href="#page-37">37</a>
      <a href="#section-4.8">4.8</a>. Configuration Dataset for vq-rtcpxr Events ................<a href="#page-39">39</a>
   <a href="#section-5">5</a>. IANA Considerations ............................................<a href="#page-39">39</a>
      <a href="#section-5.1">5.1</a>. SIP Event Package Registration ............................<a href="#page-39">39</a>
      <a href="#section-5.2">5.2</a>. application/vq-rtcpxr Media Type Registration .............<a href="#page-39">39</a>
   <a href="#section-6">6</a>. Security Considerations ........................................<a href="#page-40">40</a>
   <a href="#section-7">7</a>. Contributors ...................................................<a href="#page-40">40</a>
   <a href="#section-8">8</a>. References .....................................................<a href="#page-40">40</a>
      <a href="#section-8.1">8.1</a>. Normative References ......................................<a href="#page-40">40</a>
      <a href="#section-8.2">8.2</a>. Informative References ....................................<a href="#page-41">41</a>

















<span class="grey">Pendleton, et al.            Standards Track                    [Page 3]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-4" id="page-4" href="#page-4" class="invisible"> </a>
<span class="grey"><a href="rfc6035.html">RFC 6035</a>         SIP Package for Voice Quality Reporting   November 2010</span>


<span class="h2"><a class="selflink" name="section-1" href="#section-1">1</a>.  Introduction</span>

   Real-time communications over IP networks use SIP for signaling with
   RTP/RTCP for media transport and reporting, respectively.  These
   protocols are very flexible and can support an extremely wide
   spectrum of usage scenarios.  For this reason, extensions to these
   protocols must be specified in the context of a specific usage
   scenario.  In this memo, extensions to SIP are proposed to support
   the reporting of RTP Control Protocol Extended Reports [<a href="#ref-4" title="&quot;RTP Control Protocol Extended Reports (RTCP XR)&quot;">4</a>] metrics.

<span class="h3"><a class="selflink" name="section-1.1" href="#section-1.1">1.1</a>.  Applicability Statement</span>

   RTP is utilized in many different architectures and topologies.  <a href="rfc5117.html">RFC</a>
   <a href="rfc5117.html">5117</a> [<a href="#ref-13" title="&quot;RTP Topologies&quot;">13</a>] lists and describes the following topologies: point-to-
   point, point-to-multipoint using multicast, point-to-multipoint using
   the translator from <a href="rfc3550.html">RFC 3550</a>, point-to-multipoint using the mixer
   model from <a href="rfc3550.html">RFC 3550</a>, point-to-multipoint using video-switching
   Multipoint Control Units (MCUs), point-to-multipoint using RTCP-
   terminating MCU, and non-symmetric mixer/translators.  As the
   Abstract of this document points out, this specification is for
   reporting quality of Voice over Internet Protocol (VoIP) sessions.
   As such, only the first topology, point to point, is currently
   supported by this specification.  This reflects both current VoIP
   deployments, which are predominantly point to point using unicast,
   and the state of research in the area of quality.

   How to accurately report the quality of a multipart conference or a
   session involving multiple hops through translators and mixers is
   currently an area of research in the industry.  However, this
   mechanism can easily be used for centrally mixed conference calls, in
   which each leg of the conferences is just a point-to-point call.
   This mechanism could be extended to cover additional RTP topologies
   in the future once these topics progress out of the realm of research
   and into actual Internet deployments.

<span class="h3"><a class="selflink" name="section-1.2" href="#section-1.2">1.2</a>.  Use of the Mechanism</span>

   RTCP reports are usually sent to other participating endpoints in a
   session.  This can make the collection of performance information by
   an administrator or management system quite complex to implement.  In
   the usage scenarios addressed in this memo, the data contained in
   RTCP XR VoIP metrics reports (<a href="rfc3611.html">RFC 3611</a> [<a href="#ref-4" title="&quot;RTP Control Protocol Extended Reports (RTCP XR)&quot;">4</a>]) are forwarded to a
   central collection server systems using SIP.








<span class="grey">Pendleton, et al.            Standards Track                    [Page 4]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-5" id="page-5" href="#page-5" class="invisible"> </a>
<span class="grey"><a href="rfc6035.html">RFC 6035</a>         SIP Package for Voice Quality Reporting   November 2010</span>


   Applications residing in the server or elsewhere can aid in network
   management to alleviate bandwidth constraints and also to support
   customer service by identifying and acknowledging calls of poor
   quality.  However, specifying such applications is beyond the scope
   of this paper.

   There is a large portfolio of quality parameters that can be
   associated with VoIP, but only a minimal necessary number of
   parameters are included on the RTCP-XR reports:

   1.  The codec type, as resulting from the Session Description
       Protocol (SDP) offer-answer negotiation in SIP,

   2.  The burst gap loss density and max gap duration, since voice cut-
       outs are the most annoying quality impairment in VoIP,

   3.  Round-trip delay, because it is critical to conversational
       quality,

   4.  Conversational quality as a catch-all for other voice quality
       impairments, such as randomly distributed packet loss, jitter,
       annoying silent suppression effects, etc.

   In specific usage scenarios where other parameters are required,
   designers can include other parameters beyond the scope of this
   paper.

   RTCP reports are best effort only, and though they are very useful,
   they have a number of limitations as discussed in [<a href="#ref-3" title="&quot;RTP: A Transport Protocol for Real-Time Applications&quot;">3</a>].  This must be
   considered when using RTCP reports in managed networks.

   This document defines a new SIP event package, vq-rtcpxr, and a new
   MIME type, application/vq-rtcpxr, that enable the collection and
   reporting of metrics that measure quality for RTP [<a href="#ref-3" title="&quot;RTP: A Transport Protocol for Real-Time Applications&quot;">3</a>] sessions.  The
   definitions of the metrics used in the event package are based on
   RTCP Extended Reports [<a href="#ref-4" title="&quot;RTP Control Protocol Extended Reports (RTCP XR)&quot;">4</a>] and RTCP [<a href="#ref-3" title="&quot;RTP: A Transport Protocol for Real-Time Applications&quot;">3</a>]; a mapping between the SIP
   event parameters and the parameters within the aforementioned RFCs is
   defined within this document in <a href="#section-4.6.2">Section 4.6.2</a>.

   Monitoring of voice quality is believed to be the highest priority
   for usage of this mechanism, and as such, the metrics in the event
   package are largely tailored for voice quality measurements.  The
   event package is designed to be extensible.  However, the negotiation
   of such extensions is not defined in this document.

   The event package supports reporting the voice quality metrics for
   both the inbound and outbound directions.  Voice quality metrics for
   the inbound direction can generally be computed locally by the



<span class="grey">Pendleton, et al.            Standards Track                    [Page 5]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-6" id="page-6" href="#page-6" class="invisible"> </a>
<span class="grey"><a href="rfc6035.html">RFC 6035</a>         SIP Package for Voice Quality Reporting   November 2010</span>


   reporting endpoint; however, voice quality metrics for the outbound
   direction are computed by the remote endpoint and sent to the
   reporting endpoint using the RTCP Extended Reports [<a href="#ref-4" title="&quot;RTP Control Protocol Extended Reports (RTCP XR)&quot;">4</a>].

   The configuration of the usage of this event package is not covered
   in this document.  It is the recommendation of this document that the
   SIP configuration framework [<a href="#ref-15" title="&quot;A Framework for Session Initiation Protocol User Agent Profile Delivery&quot;">15</a>] be used.  This is discussed in
   <a href="#section-4.8">Section 4.8</a>.

   The event package SHOULD be used with the SUBSCRIBE/NOTIFY method;
   however, it MAY also be used with the PUBLISH method [<a href="#ref-8" title="&quot;Session Initiation Protocol (SIP) Extension for Event State Publication&quot;">8</a>] for backward
   compatibility with some existing implementations.  Message flow
   examples for both methods are provided in this document.

<span class="h2"><a class="selflink" name="section-2" href="#section-2">2</a>.  Terminology</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in <a href="http://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a> [<a href="#ref-1" title="&quot;Key words for use in RFCs to Indicate Requirement Levels&quot;">1</a>].

<span class="h2"><a class="selflink" name="section-3" href="#section-3">3</a>.  SIP Events for VoIP Quality Reporting</span>

   This document defines a SIP events package [<a href="#ref-5" title="&quot;Session Initiation Protocol (SIP)-Specific Event Notification&quot;">5</a>] for Voice over IP
   performance reporting.  A SIP UA can send these events to an entity
   that can make the information available to other applications.  For
   purposes of illustration, the entities involved in SIP vq-rtcpxr
   event reporting will be referred to as follows:

   o  REPORTER: an entity involved in the measurement and reporting of
      media quality, i.e., the SIP UA involved in a media session.

   o  COLLECTOR: an entity that receives SIP vq-rtcpxr events.  A
      COLLECTOR may be a proxy server or another entity that is capable
      of supporting SIP vq-rtcpxr events.

<span class="h3"><a class="selflink" name="section-3.1" href="#section-3.1">3.1</a>.  SUBSCRIBE NOTIFY Method</span>

   The COLLECTOR SHALL send a SUBSCRIBE to the REPORTER to explicitly
   establish the relationship.  The REPORTER SHOULD send the voice
   quality metric reports using the NOTIFY method.  The REPORTER MUST
   NOT send any vq-rtcpxr events if a COLLECTOR address has not been
   configured.  The REPORTER populates the Request-URI according to the
   rules for an in-dialog request.  The COLLECTOR MAY send a SUBSCRIBE
   to a SIP Proxy acting on behalf of the reporting SIP UAs.







<span class="grey">Pendleton, et al.            Standards Track                    [Page 6]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-7" id="page-7" href="#page-7" class="invisible"> </a>
<span class="grey"><a href="rfc6035.html">RFC 6035</a>         SIP Package for Voice Quality Reporting   November 2010</span>


<span class="h3"><a class="selflink" name="section-3.2" href="#section-3.2">3.2</a>.  PUBLISH Method</span>

   A SIP UA that supports this specification MAY also send the service
   quality metric reports using the PUBLISH method [<a href="#ref-8" title="&quot;Session Initiation Protocol (SIP) Extension for Event State Publication&quot;">8</a>]; however, this
   approach SHOULD NOT be used, in general, on the public Internet.  The
   PUBLISH method MAY be supported for backward compatibility with
   existing implementations.

   The REPORTER MAY therefore populate the Request-URI of the PUBLISH
   method with the address of the COLLECTOR.  To ensure security of SIP
   proxies and the COLLECTOR, the REPORTER MUST be configured with the
   address of the COLLECTOR, preferably using the SIP UA configuration
   framework [<a href="#ref-15" title="&quot;A Framework for Session Initiation Protocol User Agent Profile Delivery&quot;">15</a>], as described in <a href="#section-5.8">Section 5.8</a>.

   It is RECOMMENDED that the REPORTER send an OPTIONS message to the
   COLLECTOR to ensure support of the PUBLISH message.

      If PUBLISH is not supported, then the REPORTER can only wait for a
      SUBSCRIBE request from the COLLECTOR and then deliver the
      information in NOTIFYs.  If a REPORTER sends a PUBLISH to a
      COLLECTOR that does not support or allow this method, a 501 Not
      Implemented or a 405 Method Not Allowed response will be received,
      and the REPORTER will stop publication.

<span class="h3"><a class="selflink" name="section-3.3" href="#section-3.3">3.3</a>.  Multi-Party and Multi-Segment Calls</span>

   A voice quality metric report may be sent for each session
   terminating at the REPORTER, and it may contain multiple report
   bodies.  For a multi-party call, the report MAY contain report bodies
   for the session between the reporting endpoint and each remote
   endpoint for which there was an RTP session during the call.

   Multi-party services such as call hold and call transfer can result
   in the user participating in a series of concatenated sessions,
   potentially with different choices of codec or sample rate, although
   these may be perceived by the user as a single call.  A REPORTER MAY
   send a voice quality metric report at the end of each session or MAY
   send a single voice quality metric report containing an application/
   vq-rtcpxr body for each segment of the call.

<span class="h3"><a class="selflink" name="section-3.4" href="#section-3.4">3.4</a>.  Overload Avoidance</span>

   Users of this extension should ensure that they implement general SIP
   mechanisms for avoiding overload.  For instance, an overloaded proxy
   or COLLECTOR MUST send a 503 Service Unavailable or other 5xx
   response with an appropriate Retry-After time specified.  REPORTERs
   MUST act on these responses and respect the Retry-After time




<span class="grey">Pendleton, et al.            Standards Track                    [Page 7]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-8" id="page-8" href="#page-8" class="invisible"> </a>
<span class="grey"><a href="rfc6035.html">RFC 6035</a>         SIP Package for Voice Quality Reporting   November 2010</span>


   interval.  In addition, future SIP extensions to better handle
   overload as covered in [<a href="#ref-14" title="&quot;Design Considerations for Session Initiation Protocol (SIP) Overload Control&quot;">14</a>] should be followed as they are
   standardized.

   To avoid overload of SIP Proxies or COLLECTORS, it is important to do
   capacity planning and to minimize the number of reports that are
   sent.

   Approaches to avoiding overload include:

   a.  Send only one report at the end of each call.

   b.  Use interval reports only on "problem" calls that are being
       closely monitored.

   c.  Limit the number of alerts that can be sent to a maximum of one
       per call.

<span class="h2"><a class="selflink" name="section-4" href="#section-4">4</a>.  Event Package Formal Definition</span>

<span class="h3"><a class="selflink" name="section-4.1" href="#section-4.1">4.1</a>.  Event Package Name</span>

   This document defines a SIP Event Package.  SIP Event Packages were
   originally defined in <a href="rfc3265.html">RFC 3265</a> [<a href="#ref-5" title="&quot;Session Initiation Protocol (SIP)-Specific Event Notification&quot;">5</a>].

<span class="h3"><a class="selflink" name="section-4.2" href="#section-4.2">4.2</a>.  Event Package Parameters</span>

   No event package parameters are defined.

<span class="h3"><a class="selflink" name="section-4.3" href="#section-4.3">4.3</a>.  SUBSCRIBE Bodies</span>

   SUBSCRIBE bodies are described by this specification.

<span class="h3"><a class="selflink" name="section-4.4" href="#section-4.4">4.4</a>.  Subscribe Duration</span>

   Subscriptions to this event package MAY range from minutes to weeks.
   Subscriptions in hours or days are more typical and are RECOMMENDED.
   The default subscription duration for this event package is one hour.

<span class="h3"><a class="selflink" name="section-4.5" href="#section-4.5">4.5</a>.  NOTIFY Bodies</span>

   There are three notify bodies: a Session report, an Interval report,
   and an Alert report.

   The Session report SHOULD be used for reporting when a voice media
   session terminates, when a media change occurs, such as a codec
   change or a session fork, or when a session terminates due to no
   media packets being received and MUST NOT be used for reporting at



<span class="grey">Pendleton, et al.            Standards Track                    [Page 8]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-9" id="page-9" href="#page-9" class="invisible"> </a>
<span class="grey"><a href="rfc6035.html">RFC 6035</a>         SIP Package for Voice Quality Reporting   November 2010</span>


   arbitrary points in time.  This report MUST be used for cumulative
   metric reporting and the report timestamps MUST be from the start of
   a media session to the time at which the report is generated.

   The Interval report SHOULD be used for periodic or interval reporting
   and MUST NOT be used for reporting of the complete media session.
   This report is intended to capture short duration metric reporting
   and the report intervals SHOULD be non-overlapping time windows.

   The Alert report MAY be used when voice quality degrades during a
   session.  The time window to which an Alert report relates MAY be a
   short time interval or from the start of the call to the point the
   alert is generated; this time window SHOULD be selected to provide
   the most useful information to support problem diagnosis.

   Session, Interval, and Alert reports MUST populate the metrics with
   values that are measured over the interval explicitly defined by the
   "start" and "stop" timestamps.

   Voice quality summary reports reference only one codec (payload
   type).  This payload type SHOULD be the main voice payload, not
   comfort noise or telephone event payloads.  For applications that
   consistently and rapidly switch codecs, the most used codec should be
   reported.  All values in the report, such as IP addresses,
   synchronization source (SSRC), etc., represent those values as
   received by the REPORTER.  In some scenarios, these may not be the
   same on either end of the session -- the COLLECTOR will need logic to
   be able to put these sessions together.  The values of parameters
   such as sample rate, frame duration, frame octets, packets per
   second, round-trip delay, etc., depend on the type of report in which
   they are present.  If present in a Session or an Interval report,
   they represent average values over the session or interval.  If
   present in an Alert report, they represent instantaneous values.

   The REPORTER always includes local quality reporting information and
   should, if possible, share remote quality reporting information to
   the COLLECTOR.  This remote quality could be available from received
   RTCP-XR reports or other sources.  Reporting this is useful in cases
   where the other end might support RTCP-XR but not this voice quality
   reporting.

   This specification defines a new MIME type, application/vq-rtcpxr,
   which is a text encoding of the RTCP and RTCP-XR statistics with some
   additional metrics and correlation information.







<span class="grey">Pendleton, et al.            Standards Track                    [Page 9]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-10" id="page-10" href="#page-10" class="invisible"> </a>
<span class="grey"><a href="rfc6035.html">RFC 6035</a>         SIP Package for Voice Quality Reporting   November 2010</span>


<span class="h3"><a class="selflink" name="section-4.6" href="#section-4.6">4.6</a>.  Voice Quality Event and Semantics</span>

   This section describes the syntax extensions required for event
   publication in SIP.  The formal syntax definitions described in this
   section are expressed in the Augmented BNF [<a href="#ref-6" title="&quot;Augmented BNF for Syntax Specifications: ABNF&quot;">6</a>] format used in SIP [<a href="#ref-2" title="&quot;SIP: Session Initiation Protocol&quot;">2</a>]
   and contain references to elements defined therein.

   Additionally, the definition of the timestamp format is provided in
   [<a href="#ref-7" title="&quot;Date and Time on the Internet: Timestamps&quot;">7</a>].  Note that most of the parameters are optional.  In practice,
   most implementations will send a subset of the parameters.  It is not
   the intention of this document to define what parameters may or may
   not be useful for monitoring the quality of a voice session, but to
   enable reporting of voice quality.  As such, the syntax allows the
   implementer to choose which metrics are most appropriate for their
   solution.  As there are no "invalid", "unknown", or "not applicable"
   values in the syntax, the intention is to exclude any parameters for
   which values are not available, not applicable, or unknown.

   The authors recognize that implementers may need to add new parameter
   lines to the reports and new metrics to the existing parameter lines.
   The extension tokens are intended to fulfill this need.

<span class="h4"><a class="selflink" name="section-4.6.1" href="#section-4.6.1">4.6.1</a>.  ABNF Syntax Definition</span>

VQReportEvent  =  AlertReport /  SessionReport / IntervalReport

SessionReport = "VQSessionReport" [ HCOLON "CallTerm" ] CRLF
            SessionInfo  CRLF
            LocalMetrics [ CRLF RemoteMetrics ]
            [ CRLF DialogID ]

; CallTerm indicates the final report of a session.

IntervalReport = "VQIntervalReport" [ HCOLON "CallTerm" ] CRLF
            SessionInfo  CRLF
            LocalMetrics [ CRLF RemoteMetrics ]
            [ CRLF DialogID ]

LocalMetrics  = "LocalMetrics" HCOLON CRLF Metrics

RemoteMetrics = "RemoteMetrics" HCOLON CRLF Metrics

AlertReport   = "VQAlertReport" HCOLON
      MetricType WSP Severity WSP Direction CRLF
      SessionInfo  CRLF
      LocalMetrics [ CRLF RemoteMetrics ]
      [ DialogID ]




<span class="grey">Pendleton, et al.            Standards Track                   [Page 10]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-11" id="page-11" href="#page-11" class="invisible"> </a>
<span class="grey"><a href="rfc6035.html">RFC 6035</a>         SIP Package for Voice Quality Reporting   November 2010</span>


SessionInfo =
   CallID CRLF
   LocalID CRLF
   RemoteID CRLF
   OrigID CRLF
   LocalAddr CRLF
   RemoteAddr CRLF
   LocalGroupID CRLF
   RemoteGroupID CRLF
   [ LocalMACAddr CRLF ]
   [ RemoteMACAddr CRLF ]

Metrics = TimeStamps CRLF
   [ SessionDescription CRLF ]
   [ JitterBuffer CRLF ]
   [ PacketLoss CRLF ]
   [ BurstGapLoss CRLF ]
   [ Delay CRLF ]
   [ Signal CRLF ]
   [ QualityEstimates CRLF ]
   *(Extension CRLF)

; Timestamps are provided in Coordinated Universal Time (UTC)
; using the ABNF format provided in <a href="rfc3339.html">RFC 3339</a>,
;  "Date and Time on the Internet: Timestamps"
; These timestamps SHOULD reflect, as closely as
; possible, the actual time during which the media session
; was running to enable correlation to events occurring
; in the network infrastructure and to accounting records.
; Time zones other than "Z" are not allowed.

TimeStamps = "Timestamps" HCOLON StartTime WSP StopTime
StartTime  = "START" EQUAL date-time
StopTime   = "STOP" EQUAL date-time

; SessionDescription provides a shortened version of the
; session SDP but contains only the relevant parameters for
; session quality reporting purposes.

SessionDescription  = "SessionDesc" HCOLON
   [ PayloadType WSP ]
   [ PayloadDesc WSP ]
   [ SampleRate WSP ]
   [ PacketsPerSecond WSP ]
   [ FrameDuration WSP ]
   [ FrameOctets WSP ]
   [ FramesPerPacket WSP ]
   [ FmtpOptions WSP ]



<span class="grey">Pendleton, et al.            Standards Track                   [Page 11]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-12" id="page-12" href="#page-12" class="invisible"> </a>
<span class="grey"><a href="rfc6035.html">RFC 6035</a>         SIP Package for Voice Quality Reporting   November 2010</span>


   [ PacketLossConcealment WSP ]
   [ SilenceSuppressionState ]
   *(WSP Extension)

; PayloadType provides the PT parameter used in the RTP packets.

PayloadType  = "PT" EQUAL (1*3DIGIT)

; PayloadDesc provides a text description of the codec.
; This parameter SHOULD use the IANA registry for
; media-type names defined by <a href="rfc4855.html">RFC 4855</a> where it unambiguously
; defines the codec.  Refer to the "Audio Media Types"
; registry on <a href="http://www.iana.org/">http://www.iana.org</a>.

PayloadDesc  = "PD" EQUAL (word / DQUOTE word-plus DQUOTE)

; SampleRate reports the rate at which a voice was sampled
; in the case of narrowband codecs, this value will typically
; be 8000.
; For codecs that are able to change sample rates, the lowest and
; highest sample rates MUST be reported (e.g., 8000;16000).

SampleRate = "SR" EQUAL (1*6DIGIT) *(SEMI (1*66DIGIT))

; FrameDuration can be combined with the FramesPerPacket
; to determine the packetization rate; the units for
; FrameDuration are milliseconds.  NOTE: for frame-based codecs,
; each frame constitutes a single frame; for sample-based codecs,
; a "frame" refers to the set of samples carried in an RTP packet.

FrameDuration = "FD" EQUAL (1*4DIGIT)

; FrameOctets provides the number of octets in each frame
; at the time the report is generated (i.e., last value).
; This MAY be used where FrameDuration is not available.
; NOTE: for frame-based codecs, each frame constitutes a single frame;
; for sample-based codecs, a "frame" refers to the set of samples
; carried in an RTP packet.

FrameOctets  = "FO" EQUAL (1*5DIGIT)

; FramesPerPacket provides the number of frames in each RTP
; packet at the time the report is generated.
; NOTE: for frame-based codecs, each frame constitutes a single frame;
; for sample-based codecs, a "frame" refers to the set of samples
; carried in an RTP packet.

FramesPerPacket = "FPP" EQUAL (1*2DIGIT)



<span class="grey">Pendleton, et al.            Standards Track                   [Page 12]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-13" id="page-13" href="#page-13" class="invisible"> </a>
<span class="grey"><a href="rfc6035.html">RFC 6035</a>         SIP Package for Voice Quality Reporting   November 2010</span>


; Packets per second provides the average number of packets
; that are transmitted per second, as at the time the report is
; generated.

PacketsPerSecond = "PPS" EQUAL (1*5DIGIT)

; FMTP options from SDP.  Note that the parameter is delineated
; by " " to avoid parsing issues in transitioning between SDP
; and SIP parsing.

FmtpOptions = "FMTP" EQUAL DQUOTE word-plus DQUOTE

; PacketLossConcealment indicates whether a PLC algorithm was
; or is being used for the session.  The values follow the same
; numbering convention as <a href="rfc3611.html">RFC 3611</a> [<a href="#ref-4" title="&quot;RTP Control Protocol Extended Reports (RTCP XR)&quot;">4</a>].
; 0 - unspecified
; 1 - disabled
; 2 - enhanced
; 3 - standard

PacketLossConcealment  = "PLC" EQUAL ("0" / "1" / "2" / "3")

; SilenceSuppressionState indicates whether silence suppression,
; also known as Voice Activity Detection (VAD) is enabled.

SilenceSuppressionState  = "SSUP" EQUAL ("on" / "off")

; CallId provides the call id from the SIP dialog.

CallID  =  "CallID" HCOLON Call-ID-Parm

; LocalID identifies the reporting endpoint for the media session [<a href="#ref-2" title="&quot;SIP: Session Initiation Protocol&quot;">2</a>].

LocalID = "LocalID" HCOLON (name-addr/addr-spec)

; RemoteID identifies the remote endpoint of the media session [<a href="#ref-2" title="&quot;SIP: Session Initiation Protocol&quot;">2</a>].

RemoteID = "RemoteID" HCOLON (name-addr/addr-spec)

; OrigID identifies the endpoint which originated the session.

OrigID = "OrigID" HCOLON (name-addr/addr-spec)

; LocalAddr provides the IP address, port, and SSRC of the
; endpoint/UA, which is the receiving end of the stream being
; measured.

LocalAddr   = "LocalAddr" HCOLON IPAddress WSP Port WSP Ssrc



<span class="grey">Pendleton, et al.            Standards Track                   [Page 13]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-14" id="page-14" href="#page-14" class="invisible"> </a>
<span class="grey"><a href="rfc6035.html">RFC 6035</a>         SIP Package for Voice Quality Reporting   November 2010</span>


; RemoteAddr provides the IP address, port, and SSRC of the
; the source of the stream being measured.

RemoteAddr  = "RemoteAddr" HCOLON IPAddress WSP Port WSP Ssrc

; LocalMACAddr provides the Media Access Control (MAC) address
; of the local SIP device.

LocalMACAddr   = "LocalMAC" HCOLON hex2 *(":" hex2)

; RemoteMACAddr provides the MAC address
; of the remote SIP device.

RemoteMACAddr   = "RemoteMAC" HCOLON hex2 *(":" hex2)

; LocalGroupID provides the identification for the purposes
; of aggregation for the local endpoint.

LocalGroupID = "LocalGroup" HCOLON word-plus

; RemoteGroupID provides the identification for the purposes
; of aggregation for the remote endpoint.

RemoteGroupID = "RemoteGroup" HCOLON word-plus

; For clarification, the LocalAddr in the LocalMetrics report
; MUST be the RemoteAddr in the RemoteMetrics report.

IPAddress   = "IP" EQUAL IPv6address / IPv4address
Port        = "PORT" EQUAL 1*DIGIT
Ssrc        = "SSRC" EQUAL ( %x30.78 1*8HEXDIG)

JitterBuffer = "JitterBuffer" HCOLON
   [ JitterBufferAdaptive WSP ]
   [ JitterBufferRate WSP ]
   [ JitterBufferNominal WSP ]
   [ JitterBufferMax WSP ]
   [ JitterBufferAbsMax ]
   *(WSP Extension)

; JitterBufferAdaptive indicates whether the jitter buffer in
; the endpoint is adaptive, static, or unknown.
; The values follow the same numbering convention as <a href="rfc3611.html">RFC 3611</a> [<a href="#ref-4" title="&quot;RTP Control Protocol Extended Reports (RTCP XR)&quot;">4</a>].
; For more details, please refer to that document.
; 0 - unknown
; 1 - reserved
; 2 - non-adaptive
; 3 - adaptive



<span class="grey">Pendleton, et al.            Standards Track                   [Page 14]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-15" id="page-15" href="#page-15" class="invisible"> </a>
<span class="grey"><a href="rfc6035.html">RFC 6035</a>         SIP Package for Voice Quality Reporting   November 2010</span>


JitterBufferAdaptive  = "JBA" EQUAL ("0" / "1" / "2" / "3")

; JitterBuffer metric definitions are provided in <a href="rfc3611.html">RFC 3611</a> [<a href="#ref-4" title="&quot;RTP Control Protocol Extended Reports (RTCP XR)&quot;">4</a>].

JitterBufferRate      = "JBR" EQUAL (1*2DIGIT) ;0-15
JitterBufferNominal   = "JBN" EQUAL (1*5DIGIT) ;0-65535
JitterBufferMax       = "JBM" EQUAL (1*5DIGIT) ;0-65535
JitterBufferAbsMax    = "JBX" EQUAL (1*5DIGIT) ;0-65535

; PacketLoss metric definitions are provided in <a href="rfc3611.html">RFC 3611</a> [<a href="#ref-4" title="&quot;RTP Control Protocol Extended Reports (RTCP XR)&quot;">4</a>].

PacketLoss = "PacketLoss" HCOLON
           [ NetworkPacketLossRate WSP ]
           [ JitterBufferDiscardRate ]
           *(WSP Extension)

NetworkPacketLossRate =
  "NLR" EQUAL (1*3DIGIT [ "." 1*2DIGIT ]) ;percentage

JitterBufferDiscardRate =
  "JDR" EQUAL (1*3DIGIT [ "." 1*2DIGIT ]) ;percentage

; BurstGapLoss metric definitions are provided in <a href="rfc3611.html">RFC 3611</a> [<a href="#ref-4" title="&quot;RTP Control Protocol Extended Reports (RTCP XR)&quot;">4</a>].

BurstGapLoss = "BurstGapLoss" HCOLON
   [ BurstLossDensity WSP ]
   [ BurstDuration WSP ]
   [ GapLossDensity WSP ]
   [ GapDuration WSP ]
   [ MinimumGapThreshold ]
   *(WSP Extension)

BurstLossDensity =
 "BLD" EQUAL (1*3DIGIT [ "." 1*2DIGIT ]) ;percentage

BurstDuration =
 "BD" EQUAL (1*7DIGIT) ;0-3,600,000 -- milliseconds

GapLossDensity =
 "GLD" EQUAL (1*3DIGIT [ "." 1*2DIGIT ]) ;percentage

GapDuration =
 "GD" EQUAL (1*7DIGIT) ;0-3,600,000 -- milliseconds








<span class="grey">Pendleton, et al.            Standards Track                   [Page 15]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-16" id="page-16" href="#page-16" class="invisible"> </a>
<span class="grey"><a href="rfc6035.html">RFC 6035</a>         SIP Package for Voice Quality Reporting   November 2010</span>


MinimumGapThreshold =
 "GMIN" EQUAL (1*3DIGIT) ;1-255

Delay = "Delay" HCOLON
   [ RoundTripDelay WSP ]
   [ EndSystemDelay WSP ]
   [ OneWayDelay WSP ]
   [ SymmOneWayDelay WSP ]
   [ InterarrivalJitter WSP ]
   [ MeanAbsoluteJitter ]
   *(WSP Extension)

; RoundTripDelay SHALL be measured as defined in <a href="rfc3550.html">RFC 3550</a> [<a href="#ref-3" title="&quot;RTP: A Transport Protocol for Real-Time Applications&quot;">3</a>].

RoundTripDelay = "RTD" EQUAL (1*5DIGIT) ;0-65535

; EndSystemDelay metric is defined in <a href="rfc3611.html">RFC 3611</a> [<a href="#ref-4" title="&quot;RTP Control Protocol Extended Reports (RTCP XR)&quot;">4</a>].

EndSystemDelay = "ESD" EQUAL (1*5DIGIT) ;0-65535

; OneWayDelay is defined in <a href="rfc2679.html">RFC 2679</a> [<a href="#ref-12" title="&quot;A One-way Delay Metric for IPPM&quot;">12</a>].

OneWayDelay = "OWD" EQUAL (1*5DIGIT) ;0-65535

; SymmOneWayDelay is defined as half the sum of RoundTripDelay
; and the EndSystemDelay values for both endpoints.

SymmOneWayDelay = "SOWD" EQUAL (1*5DIGIT); 0-65535

; Interarrival Jitter is calculated as defined <a href="rfc3550.html">RFC 3550</a> [<a href="#ref-3" title="&quot;RTP: A Transport Protocol for Real-Time Applications&quot;">3</a>]
; and converted into milliseconds.

InterarrivalJitter = "IAJ" EQUAL (1*5DIGIT) ;0-65535 ms

; Mean Absolute Jitter is measured as defined
; by ITU-T G.1020 [<a href="#ref-9" title="&quot;Performance parameter definitions for quality of speech and other voiceband applications utilizing IP networks&quot;">9</a>] where it is known as MAPDV.

MeanAbsoluteJitter = "MAJ" EQUAL (1*5DIGIT);0-65535

; Signal metrics definitions are provided in <a href="rfc3611.html">RFC 3611</a> [<a href="#ref-4" title="&quot;RTP Control Protocol Extended Reports (RTCP XR)&quot;">4</a>].

Signal = "Signal" HCOLON
   [ SignalLevel WSP ]
   [ NoiseLevel WSP ]
   [ ResidualEchoReturnLoss ]
   *(WSP Extension)

; SignalLevel will normally be a negative value.



<span class="grey">Pendleton, et al.            Standards Track                   [Page 16]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-17" id="page-17" href="#page-17" class="invisible"> </a>
<span class="grey"><a href="rfc6035.html">RFC 6035</a>         SIP Package for Voice Quality Reporting   November 2010</span>


; The absence of the negative sign indicates a positive value.
; Where the signal level is negative, the sign MUST be
; included.  This metric applies to the speech signal decoded
; from the received packet stream.

SignalLevel = "SL" EQUAL ([ "-" ] 1*2DIGIT)

; NoiseLevel will normally be negative and the sign MUST be
; explicitly included.
; The absence of a sign indicates a positive value.
; This metric applies to the speech signal decoded from the
; received packet stream.

NoiseLevel  = "NL" EQUAL ([ "-" ] 1*2DIGIT)

; Residual Echo Return Loss (RERL) is the ratio between
; the original signal and the echo level as measured after
; echo cancellation or suppression has been applied.
; Expressed in decibels (dB).  This is typically a positive
; value.
; This metric relates to the proportion of the speech signal
; decoded from the received packet stream that is reflected
; back in the encoded speech signal output in the transmitted
; packet stream (i.e., will affect the REMOTE user's
; conversational quality).  To support the diagnosis of echo-
; related problems experienced by the local user of the device
; generating a report according to this document, the value of
; RERL reported via the RTCP XR VoIP Metrics payload SHOULD be
; reported in the RemoteMetrics set of data.

ResidualEchoReturnLoss = "RERL" EQUAL (1*3DIGIT)

; Voice Quality estimation metrics.
; Each quality estimate has an optional associated algorithm.
; These fields permit the implementation to use a variety
; of different calculation methods for each type of metric.

QualityEstimates  = "QualityEst" HCOLON
   [ ListeningQualityR WSP ]
   [ RLQEstAlg WSP ]
   [ ConversationalQualityR WSP ]
   [ RCQEstAlg WSP ]
   [ ExternalR-In WSP ]
   [ ExtRInEstAlg WSP ]
   [ ExternalR-Out WSP ]
   [ ExtROutEstAlg WSP ]
   [ MOS-LQ WSP ]
   [ MOSLQEstAlg WSP ]



<span class="grey">Pendleton, et al.            Standards Track                   [Page 17]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-18" id="page-18" href="#page-18" class="invisible"> </a>
<span class="grey"><a href="rfc6035.html">RFC 6035</a>         SIP Package for Voice Quality Reporting   November 2010</span>


   [ MOS-CQ WSP ]
   [ MOSCQEstAlg WSP ]
   [ QoEEstAlg ]
   *(WSP Extension)

ListeningQualityR = "RLQ" EQUAL (1*3DIGIT) ; 0 - 120

RLQEstAlg = "RLQEstAlg" EQUAL word ; "P.564" [<a href="#ref-10" title="&quot;Conformance testing for voice over IP transmission quality assessment models&quot;">10</a>], or other

ConversationalQualityR = "RCQ" EQUAL (1*3DIGIT) ; 0 - 120

RCQEstAlg = "RCQEstAlg" EQUAL word ; "P.564", or other

; ExternalR-In is measured by the local endpoint for incoming
; connection on the "other" side of this endpoint.  For example,
;   Phone A &lt;---&gt; Bridge &lt;----&gt; Phone B
;   ListeningQualityR = quality for Phone A ----&gt; Bridge path
;   ExternalR-In = quality for Bridge &lt;---- Phone B path

ExternalR-In = "EXTRI" EQUAL (1*3DIGIT) ; 0 - 120

ExtRInEstAlg = "ExtRIEstAlg" EQUAL word ; "P.564" or other

; ExternalR-Out is copied from the RTCP XR message received from the
; remote endpoint on the "other" side of this endpoint.  For example,
;   Phone A &lt;---&gt; Bridge &lt;----&gt; Phone B
;   ExternalR-Out = quality for Bridge -----&gt; Phone B path

ExternalR-Out = "EXTRO" EQUAL (1*3DIGIT) ; 0 - 120

ExtROutEstAlg = "ExtROEstAlg" EQUAL word ; "P.564" or other

MOS-LQ = "MOSLQ" EQUAL (DIGIT [ "." 1*3DIGIT ]) ; 0.0 - 4.9

MOSLQEstAlg = "MOSLQEstAlg" EQUAL word ; "P.564" or other

MOS-CQ = "MOSCQ" EQUAL (DIGIT [ "." 1*3DIGIT ])  ; 0.0 - 4.9

MOSCQEstAlg = "MOSCQEstAlg" EQUAL word ; "P.564" or other

; QoEEstAlg provides an alternative to the separate
; estimation algorithms for use when the same algorithm
; is used for all measurements.








<span class="grey">Pendleton, et al.            Standards Track                   [Page 18]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-19" id="page-19" href="#page-19" class="invisible"> </a>
<span class="grey"><a href="rfc6035.html">RFC 6035</a>         SIP Package for Voice Quality Reporting   November 2010</span>


QoEEstAlg = "QoEEstAlg" EQUAL word ; "P.564" or other

; DialogID provides the identification of the dialog with
; which the media session is related.  This value is taken
; from the SIP header.

DialogID  = "DialogID" COLON Call-ID-Parm *(SEMI did-parm)

did-parm  = to-tag / from-tag / word

to-tag    = "to-tag" EQUAL token

from-tag  = "from-tag" EQUAL token

; MetricType provides the metric on which a notification of
; threshold violation was based.  The more commonly used metrics
; for alerting purposes are included here explicitly, using the
; character encoding that represents the parameter in
; this ABNF.  The Extension parameter can be used to provide
; metrics that are not defined by this document.

MetricType = "Type" EQUAL "RLQ" / "RCQ" / "EXTR" /
   "MOSLQ" / "MOSCQ" /
   "BD" / "NLR" / "JDR" /
   "RTD" / "ESD" / "IAJ" /
   "RERL" / "SL" / "NL" / Extension

Direction = "Dir" EQUAL "local" / "remote"
Severity  = "Severity" EQUAL "Warning" / "Critical" /
   "Clear"

Call-ID-Parm =  word [ "@" word ]

; General ABNF notation from <a href="rfc5234.html">RFC 5234</a>.

CRLF =  %x0D.0A
DIGIT =  %x30-39
WSP   =  SP / HTAB ; white space
SP    =  " "
HTAB  =  %x09 ; horizontal tab
HEXDIG =  DIGIT / "A" / "B" / "C" / "D" / "E" / "F" /
             "a" / "b" / "c" / "d" / "e" / "f"
DQUOTE  =  %x22 ; " (Double Quote)
ALPHA   =  %x41-5A / %x61-7A   ; A-Z / a-z







<span class="grey">Pendleton, et al.            Standards Track                   [Page 19]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-20" id="page-20" href="#page-20" class="invisible"> </a>
<span class="grey"><a href="rfc6035.html">RFC 6035</a>         SIP Package for Voice Quality Reporting   November 2010</span>


; ABNF notation from <a href="rfc3261.html">RFC 3261</a>.

alphanum  =  ALPHA / DIGIT
LWS  =  [ *WSP CRLF ] 1*WSP ; linear whitespace
SWS  =  [ LWS ] ; sep whitespace
SEMI =  SWS ";" SWS ; semicolon
EQUAL   =  SWS "=" SWS ; equal
COLON   =  SWS ":" SWS ; colon
HCOLON  =  *( SP / HTAB ) ":" SWS

token       =  1*(alphanum / "-" / "." / "!" / "%" / "*"
                  / "_" / "+" / "`" / "'" / "~" )

IPv4address   =  1*3DIGIT "." 1*3DIGIT "." 1*3DIGIT "." 1*3DIGIT
IPv6address   =  hexpart [ ":" IPv4address ]
hexpart       =  hexseq / hexseq "::" [ hexseq ] / "::"
                      [ hexseq ]
hexseq        =  hex4 *( ":" hex4)
hex4          =  1*4HEXDIG
hex2          =  2HEXDIG

; ABNF notation from <a href="rfc3339.html">RFC 3339</a>.

date-fullyear   = 4DIGIT ; e.g. 2006
date-month      = 2DIGIT ; e.g. 01 or 11
date-mday       = 2DIGIT ; e.g. 02 or 22
time-hour       = 2DIGIT ; e.g. 01 or 13
time-minute     = 2DIGIT ; e.g. 03 or 55
time-second     = 2DIGIT ; e.g. 01 or 59
time-secfrac    = "." 1*DIGIT
time-numoffset  = ("+" / "-") time-hour ":" time-minute
time-offset     = "Z" / time-numoffset
partial-time = time-hour ":" time-minute ":" time-second [ time-secfrac]
full-date    = date-fullyear "-" date-month "-" date-mday
full-time    = partial-time time-offset
date-time    = full-date "T" full-time

; Miscellaneous definitions
;

Extension = word-plus

word  =  1*(alphanum / "-" / "." / "!" / "%" / "*" /
   "_" / "+" / "`" / "'" / "~" /
   "(" / ")" / "&lt;" / "&gt;" /
   ":" / "\" / DQUOTE /
   "/" / "[" / "]" / "?" )




<span class="grey">Pendleton, et al.            Standards Track                   [Page 20]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-21" id="page-21" href="#page-21" class="invisible"> </a>
<span class="grey"><a href="rfc6035.html">RFC 6035</a>         SIP Package for Voice Quality Reporting   November 2010</span>


word-plus =  1*(alphanum /  "-"  /  "."  /  "!"  / "%" / "*" /
   "_"  /  "+"  /  "`"  /  "'"  /  "~"  /
   "("  /  ")"  /  "&lt;"  /  "&gt;"  /  ":"  /
   "\"  /  "/"  /  "["  /  "]"  /  "?"  /
   "{"  /  "}"  /  "="  /  " ")

<span class="h4"><a class="selflink" name="section-4.6.2" href="#section-4.6.2">4.6.2</a>.  Parameter Definitions and Mappings</span>

   Parameter values, codec types, and other aspects of the endpoints may
   change dynamically during a session.  The reported values of metrics
   and configuration parameters SHALL be the current value at the time
   the report is generated.

   The Packet Loss Rate and Packet Discard Rate parameters are
   calculated over the period between the starting and ending timestamps
   for the report.  These are normally calculated from a count of the
   number of lost or discarded packets divided by the count of the
   number of packets, and hence are based on the current values of these
   counters at the time the report was generated.

   Packet delay variation, signal level, noise level, and echo level are
   computed as running or interval averages, based on the appropriate
   standard, e.g., <a href="rfc3550.html">RFC 3550</a> for Packet Delay Variation (PDV), and the
   sampled value of these running averages is reported.  Delay, packet
   size, jitter buffer size, and codec-related data may change during a
   session and the current value of these parameters is reported as
   sampled at the time the report is generated.

<span class="h5"><a class="selflink" name="section-4.6.2.1" href="#section-4.6.2.1">4.6.2.1</a>.  General Mapping Percentages from 8-bit, Fixed-Point Numbers</span>

   <a href="rfc3611.html">RFC 3611</a> uses an 8-bit, fixed-point number with the binary point at
   the left edge of the field.  This value is calculated by dividing the
   total number of packets lost by the total number of packets expected
   and multiplying the result by 256, and then taking the integer part.

   For any RTCP XR parameter in this format, to map into the equivalent
   SIP vq-rtcpxr parameter, simply reverse the equation, i.e., divide by
   256 and take the integer part.

<span class="h5"><a class="selflink" name="section-4.6.2.2" href="#section-4.6.2.2">4.6.2.2</a>.  Timestamps</span>

   Following SIP and other IETF conventions, timestamps are provided in
   Coordinated Universal Time (UTC) using the ABNF format provided in
   <a href="rfc3339.html">RFC 3339</a> [<a href="#ref-7" title="&quot;Date and Time on the Internet: Timestamps&quot;">7</a>].  These timestamps SHOULD reflect, as closely as
   possible, the actual time during which the media session was running
   to enable correlation to related events occurring in the network and
   to accounting or billing records.




<span class="grey">Pendleton, et al.            Standards Track                   [Page 21]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-22" id="page-22" href="#page-22" class="invisible"> </a>
<span class="grey"><a href="rfc6035.html">RFC 6035</a>         SIP Package for Voice Quality Reporting   November 2010</span>


<span class="h5"><a class="selflink" name="section-4.6.2.3" href="#section-4.6.2.3">4.6.2.3</a>.  SessionDescription</span>

   The parameters in this field provide a shortened version of the
   session SDP(s), containing only the relevant parameters for session
   quality reporting purposes.  Where values may change during a
   session, for example, a codec may change rate, then the most-recent
   value of the parameter is reported.

<span class="h6"><a class="selflink" name="section-4.6.2.3.1" href="#section-4.6.2.3.1">4.6.2.3.1</a>.  Payload Type</span>

   This is the "payload type" parameter used in the RTP packets, i.e.,
   the codec.  This field can also be mapped from the SDP "rtpmap"
   attribute field "payload type".  IANA-registered types SHOULD be
   used.

<span class="h6"><a class="selflink" name="section-4.6.2.3.2" href="#section-4.6.2.3.2">4.6.2.3.2</a>.  Payload Desc</span>

   This parameter is a text description of the codec.  This parameter
   SHOULD use the IANA registry for media-type names where it
   unambiguously defines the codec.  Refer to the "Audio Media Types"
   registry on <a href="http://www.iana.org/">http://www.iana.org</a>.

<span class="h6"><a class="selflink" name="section-4.6.2.3.3" href="#section-4.6.2.3.3">4.6.2.3.3</a>.  Sample Rate</span>

   This parameter is mapped from the SDP "rtpmap" attribute field "clock
   rate".  The field provides the rate at which a voice was sampled,
   measured in Hertz (Hz).

<span class="h6"><a class="selflink" name="section-4.6.2.3.4" href="#section-4.6.2.3.4">4.6.2.3.4</a>.  Packets Per Second</span>

   This parameter is not contained in RTP or SDP but can usually be
   obtained from the device codec.  Packets per second provides the
   (rounded) number of RTP packets that are transmitted per second.

<span class="h6"><a class="selflink" name="section-4.6.2.3.5" href="#section-4.6.2.3.5">4.6.2.3.5</a>.  Frame Duration</span>

   This parameter is not contained in RTP or SDP but can usually be
   obtained from the device codec.  The field reflects the amount of
   voice content in each frame within the RTP payload, measured in
   milliseconds.  Note that this value can be combined with the
   FramesPerPacket to determine the packetization rate.  Also, where a
   sample-based codec is used, a "frame" refers to the set of samples
   carried in an RTP packet.








<span class="grey">Pendleton, et al.            Standards Track                   [Page 22]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-23" id="page-23" href="#page-23" class="invisible"> </a>
<span class="grey"><a href="rfc6035.html">RFC 6035</a>         SIP Package for Voice Quality Reporting   November 2010</span>


<span class="h6"><a class="selflink" name="section-4.6.2.3.6" href="#section-4.6.2.3.6">4.6.2.3.6</a>.  Frame Octets</span>

   This parameter is not contained in RTP or SDP but is usually provided
   by the device codec.  The field provides the number of octets in each
   frame within the RTP payload.  This field is usually not provided
   when the FrameDuration is provided.  Also, where a sample-based codec
   is used, a "frame" refers to the set of samples carried in an RTP
   packet.

<span class="h6"><a class="selflink" name="section-4.6.2.3.7" href="#section-4.6.2.3.7">4.6.2.3.7</a>.  Frames Per Packet</span>

   This parameter is not contained in RTP or SDP but can usually be
   obtained from the device codec.  This field provides the number of
   frames in each RTP packet.  Note that this value can be combined with
   the FrameDuration to determine the packetization rate.  Also, where a
   sample-based codec is used, a "frame" refers to the set of samples
   carried in an RTP packet.

<span class="h6"><a class="selflink" name="section-4.6.2.3.8" href="#section-4.6.2.3.8">4.6.2.3.8</a>.  FMTP Options</span>

   This parameter is taken directly from the SDP attribute "fmtp"
   defined in <a href="rfc4566.html">RFC 4566</a>.

<span class="h6"><a class="selflink" name="section-4.6.2.3.9" href="#section-4.6.2.3.9">4.6.2.3.9</a>.  Silence Suppression State</span>

   This parameter does not correspond to SDP, RTP, or RTCP XR.  It
   indicates whether silence suppression, also known as Voice Activity
   Detection (VAD), is enabled for the identified session.

<span class="h6"><a class="selflink" name="section-4.6.2.3.10" href="#section-4.6.2.3.10">4.6.2.3.10</a>.  Packet Loss Concealment</span>

   This value corresponds to "PLC" in <a href="rfc3611.html">RFC 3611</a> in the VoIP Metrics
   Report Block.  The values defined by <a href="rfc3611.html">RFC 3611</a> are reused by this
   recommendation and therefore no mapping is required.

<span class="h5"><a class="selflink" name="section-4.6.2.4" href="#section-4.6.2.4">4.6.2.4</a>.  LocalAddr</span>

   This field provides the IP address, port, and synchronization source
   (SSRC) for the session from the perspective of the endpoint that is
   measuring performance.  The IPAddress MAY be in IPv4 or IPv6 format.
   The SSRC is taken from SDP, RTCP, or RTCP XR input parameters.

   In the presence of NAT and where a NAT-traversal mechanism such as
   Session Traversal Utilities for NAT (STUN) [<a href="#ref-16" title="&quot;Session Traversal Utilities for NAT (STUN)&quot;">16</a>] is used, the external
   IP address can be reported, since the internal IP address is not
   visible to the network operator.





<span class="grey">Pendleton, et al.            Standards Track                   [Page 23]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-24" id="page-24" href="#page-24" class="invisible"> </a>
<span class="grey"><a href="rfc6035.html">RFC 6035</a>         SIP Package for Voice Quality Reporting   November 2010</span>


<span class="h5"><a class="selflink" name="section-4.6.2.5" href="#section-4.6.2.5">4.6.2.5</a>.  RemoteAddr</span>

   This field provides the IP address, port, and SSRC of the session
   peer from the perspective of the remote endpoint measuring
   performance.  In the presence of NAT and where a NAT-traversal
   mechanism such as STUN [<a href="#ref-16" title="&quot;Session Traversal Utilities for NAT (STUN)&quot;">16</a>] is used, the external IP address can be
   reported, since the internal IP address is not visible to the network
   operator.

<span class="h5"><a class="selflink" name="section-4.6.2.6" href="#section-4.6.2.6">4.6.2.6</a>.  Jitter Buffer Parameters</span>

<span class="h6"><a class="selflink" name="section-4.6.2.6.1" href="#section-4.6.2.6.1">4.6.2.6.1</a>.  Jitter Buffer Adaptive</span>

   This value corresponds to "JBA" in <a href="rfc3611.html">RFC 3611</a> in the VoIP Metrics
   Report Block.  The values defined by <a href="rfc3611.html">RFC 3611</a> are unchanged and
   therefore no mapping is required.

<span class="h6"><a class="selflink" name="section-4.6.2.6.2" href="#section-4.6.2.6.2">4.6.2.6.2</a>.  Jitter Buffer Rate</span>

   This value corresponds to "JB rate" in <a href="rfc3611.html">RFC 3611</a> in the VoIP Metrics
   Report Block.  The parameter does not require any conversion.

<span class="h6"><a class="selflink" name="section-4.6.2.6.3" href="#section-4.6.2.6.3">4.6.2.6.3</a>.  Jitter Buffer Nominal</span>

   This value corresponds to "JB nominal" in <a href="rfc3611.html">RFC 3611</a> in the VoIP
   Metrics Report Block.  The parameter does not require any conversion.

<span class="h6"><a class="selflink" name="section-4.6.2.6.4" href="#section-4.6.2.6.4">4.6.2.6.4</a>.  Jitter Buffer Max</span>

   This value corresponds to "JB maximum" in <a href="rfc3611.html">RFC 3611</a> in the VoIP
   Metrics Report Block.  The parameter does not require any conversion.

<span class="h6"><a class="selflink" name="section-4.6.2.6.5" href="#section-4.6.2.6.5">4.6.2.6.5</a>.  Jitter Buffer Abs Max</span>

   This value corresponds to "JB abs max" in <a href="rfc3611.html">RFC 3611</a> in the VoIP
   Metrics Report Block.  The parameter does not require any conversion.

<span class="h5"><a class="selflink" name="section-4.6.2.7" href="#section-4.6.2.7">4.6.2.7</a>.  Packet Loss Parameters</span>

<span class="h6"><a class="selflink" name="section-4.6.2.7.1" href="#section-4.6.2.7.1">4.6.2.7.1</a>.  Network Loss Rate</span>

   This value corresponds to "loss rate" in <a href="rfc3611.html">RFC 3611</a> in the VoIP Metrics
   Report Block.  For conversion, see <a href="#section-4.6.2.1">Section 4.6.2.1</a>.  A loss rate of
   100% MAY be reported if media packets were expected but none had been
   received at the time of session termination.






<span class="grey">Pendleton, et al.            Standards Track                   [Page 24]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-25" id="page-25" href="#page-25" class="invisible"> </a>
<span class="grey"><a href="rfc6035.html">RFC 6035</a>         SIP Package for Voice Quality Reporting   November 2010</span>


<span class="h6"><a class="selflink" name="section-4.6.2.7.2" href="#section-4.6.2.7.2">4.6.2.7.2</a>.  Jitter Buffer Discard Rate</span>

   This value corresponds to "discard rate" in <a href="rfc3611.html">RFC 3611</a> in the VoIP
   Metrics Report Block.  For conversion, see <a href="#section-4.6.2.1">Section 4.6.2.1</a>.

<span class="h5"><a class="selflink" name="section-4.6.2.8" href="#section-4.6.2.8">4.6.2.8</a>.  Burst/Gap Parameters</span>

<span class="h6"><a class="selflink" name="section-4.6.2.8.1" href="#section-4.6.2.8.1">4.6.2.8.1</a>.  Burst Loss Density</span>

   This value corresponds to "burst density" in <a href="rfc3611.html">RFC 3611</a> in the VoIP
   Metrics Report Block.  For conversion, see <a href="#section-4.6.2.1">Section 4.6.2.1</a>.

<span class="h6"><a class="selflink" name="section-4.6.2.8.2" href="#section-4.6.2.8.2">4.6.2.8.2</a>.  Burst Duration</span>

   This value corresponds to "burst duration" in <a href="rfc3611.html">RFC 3611</a> in the VoIP
   Metrics Report Block.  This value requires no conversion; the exact
   value sent in an RTCP XR VoIP Metrics Report Block can be included in
   the SIP vq-rtcpxr parameter.

<span class="h6"><a class="selflink" name="section-4.6.2.8.3" href="#section-4.6.2.8.3">4.6.2.8.3</a>.  Gap Loss Density</span>

   This value corresponds to "gap density" in <a href="rfc3611.html">RFC 3611</a> in the VoIP
   metrics Report Block.

<span class="h6"><a class="selflink" name="section-4.6.2.8.4" href="#section-4.6.2.8.4">4.6.2.8.4</a>.  Gap Duration</span>

   This value corresponds to "gap duration" in <a href="rfc3611.html">RFC 3611</a> in the VoIP
   Metrics Report Block.  This value requires no conversion; the exact
   value sent in an RTCP XR VoIP Metrics Report Block can be reported.

<span class="h6"><a class="selflink" name="section-4.6.2.8.5" href="#section-4.6.2.8.5">4.6.2.8.5</a>.  Minimum Gap Threshold</span>

   This value corresponds to "Gmin" in <a href="rfc3611.html">RFC 3611</a> in the VoIP Metrics
   Report Block.  This value requires no conversion; the exact value
   sent in an RTCP XR VoIP Metrics Report Block can be reported.

<span class="h5"><a class="selflink" name="section-4.6.2.9" href="#section-4.6.2.9">4.6.2.9</a>.  Delay Parameters</span>

<span class="h6"><a class="selflink" name="section-4.6.2.9.1" href="#section-4.6.2.9.1">4.6.2.9.1</a>.  Round-Trip Delay</span>

   This value corresponds to "round trip delay" in <a href="rfc3611.html">RFC 3611</a> in the VoIP
   Metrics Report Block and may be measured using the method defined in
   <a href="rfc3550.html">RFC 3550</a>.  The parameter is expressed in milliseconds.








<span class="grey">Pendleton, et al.            Standards Track                   [Page 25]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-26" id="page-26" href="#page-26" class="invisible"> </a>
<span class="grey"><a href="rfc6035.html">RFC 6035</a>         SIP Package for Voice Quality Reporting   November 2010</span>


<span class="h6"><a class="selflink" name="section-4.6.2.9.2" href="#section-4.6.2.9.2">4.6.2.9.2</a>.  End System Delay</span>

   This value corresponds to "end system delay" in <a href="rfc3611.html">RFC 3611</a> in the VoIP
   Metrics Report Block.  This parameter does not require any
   conversion.  The parameter is expressed in milliseconds.

<span class="h6"><a class="selflink" name="section-4.6.2.9.3" href="#section-4.6.2.9.3">4.6.2.9.3</a>.  Symmetric One-Way Delay</span>

   This value is computed by adding Round-Trip Delay to the local and
   remote End System Delay and dividing by two.

<span class="h6"><a class="selflink" name="section-4.6.2.9.4" href="#section-4.6.2.9.4">4.6.2.9.4</a>.  One-Way Delay</span>

   This value SHOULD be measured using the methods defined in IETF <a href="rfc2679.html">RFC</a>
   <a href="rfc2679.html">2679</a> [<a href="#ref-12" title="&quot;A One-way Delay Metric for IPPM&quot;">12</a>].  The parameter is expressed in milliseconds.

<span class="h6"><a class="selflink" name="section-4.6.2.9.5" href="#section-4.6.2.9.5">4.6.2.9.5</a>.  Inter-Arrival Jitter</span>

   Inter-arrival jitter is calculated as defined in <a href="rfc3550.html">RFC 3550</a> and
   converted into milliseconds.

<span class="h6"><a class="selflink" name="section-4.6.2.9.6" href="#section-4.6.2.9.6">4.6.2.9.6</a>.  Mean Absolute Jitter</span>

   It is recommended that MAJ be measured as defined in ITU-T G.1020
   [<a href="#ref-9" title="&quot;Performance parameter definitions for quality of speech and other voiceband applications utilizing IP networks&quot;">9</a>].  This parameter is often referred to as MAPDV (Mean Absolute
   Packet Delay Variation).  The parameter is expressed in milliseconds.

<span class="h5"><a class="selflink" name="section-4.6.2.10" href="#section-4.6.2.10">4.6.2.10</a>.  Signal-Related Parameters</span>

<span class="h6"><a class="selflink" name="section-4.6.2.10.1" href="#section-4.6.2.10.1">4.6.2.10.1</a>.  Signal Level</span>

   This field corresponds to "signal level" in <a href="rfc3611.html">RFC 3611</a> in the VoIP
   Metrics Report Block.  This field provides the voice signal relative
   level is defined as the ratio of the signal level to a 0 dBm0
   reference, expressed in decibels.  This value can be used directly
   without extra conversion.

<span class="h6"><a class="selflink" name="section-4.6.2.10.2" href="#section-4.6.2.10.2">4.6.2.10.2</a>.  Noise Level</span>

   This field corresponds to "noise level" in <a href="rfc3611.html">RFC 3611</a> in the VoIP
   Metrics Report Block.  This field provides the ratio of the silent
   period background noise level to a 0 dBm0 reference, expressed in
   decibels.  This value can be used directly without extra conversion.








<span class="grey">Pendleton, et al.            Standards Track                   [Page 26]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-27" id="page-27" href="#page-27" class="invisible"> </a>
<span class="grey"><a href="rfc6035.html">RFC 6035</a>         SIP Package for Voice Quality Reporting   November 2010</span>


<span class="h6"><a class="selflink" name="section-4.6.2.10.3" href="#section-4.6.2.10.3">4.6.2.10.3</a>.  Residual Echo Return Loss (RERL)</span>

   This field corresponds to "RERL" in <a href="rfc3611.html">RFC 3611</a> in the VoIP Metrics
   Report Block.  This field provides the ratio between the original
   signal and the echo level in decibels, as measured after echo
   cancellation or suppression has been applied.  This value can be used
   directly without extra conversion.

<span class="h5"><a class="selflink" name="section-4.6.2.11" href="#section-4.6.2.11">4.6.2.11</a>.  Quality Scores</span>

<span class="h6"><a class="selflink" name="section-4.6.2.11.1" href="#section-4.6.2.11.1">4.6.2.11.1</a>.  ListeningQualityR</span>

   This field reports the listening quality expressed as an R factor
   (per G.107).  This does not include the effects of echo or delay.
   The range of R is 0-95 for narrowband calls and 0-120 for wideband
   calls.  Algorithms for computing this value SHOULD be compliant with
   ITU-T Recommendations P.564 [<a href="#ref-10" title="&quot;Conformance testing for voice over IP transmission quality assessment models&quot;">10</a>] and G.107 [<a href="#ref-11" title="&quot;The E-model, a computational model for use in transmission planning&quot;">11</a>].

<span class="h6"><a class="selflink" name="section-4.6.2.11.2" href="#section-4.6.2.11.2">4.6.2.11.2</a>.  RLQEstAlg</span>

   This field provides a text name for the algorithm used to estimate
   ListeningQualityR.  This field will be free form text and not
   necessarily reflective of any standards or recommendations.

<span class="h6"><a class="selflink" name="section-4.6.2.11.3" href="#section-4.6.2.11.3">4.6.2.11.3</a>.  ConversationalQualityR</span>

   This field corresponds to "R factor" in <a href="rfc3611.html">RFC 3611</a> in the VoIP Metrics
   Report Block.  This parameter provides a cumulative measurement of
   voice quality from the start of the session to the reporting time.
   The range of R is 0-95 for narrowband calls and 0-120 for wideband
   calls.  Algorithms for computing this value SHOULD be compliant with
   ITU-T Recommendations P.564 and G.107.  Within <a href="rfc3611.html">RFC 3611</a>, a reported R
   factor of 127 indicates that this parameter is unavailable; in this
   case, the ConversationalQualityR parameter MUST be omitted from the
   vq-rtcpxr event.

<span class="h6"><a class="selflink" name="section-4.6.2.11.4" href="#section-4.6.2.11.4">4.6.2.11.4</a>.  RCQEstAlg</span>

   This field provides a text name for the algorithm used to estimate
   ConversationalQualityR.  This field will be free form text and not
   necessarily reflective of any standards or recommendations.

<span class="h6"><a class="selflink" name="section-4.6.2.11.5" href="#section-4.6.2.11.5">4.6.2.11.5</a>.  ExternalR-In</span>

   This field corresponds to "ext. R factor" in <a href="rfc3611.html">RFC 3611</a> in the VoIP
   Metrics Report Block.  This parameter reflects voice quality as
   measured by the local endpoint for incoming connection on "other"
   side (refer to <a href="rfc3611.html">RFC 3611</a> for a more-detailed explanation).  The range



<span class="grey">Pendleton, et al.            Standards Track                   [Page 27]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-28" id="page-28" href="#page-28" class="invisible"> </a>
<span class="grey"><a href="rfc6035.html">RFC 6035</a>         SIP Package for Voice Quality Reporting   November 2010</span>


   of R is 0-95 for narrowband calls and 0-120 for wideband calls.
   Algorithms for computing this value SHOULD be compliant with ITU-T
   Recommendations P.564 and G.107.  Within <a href="rfc3611.html">RFC 3611</a>, a reported R
   factor of 127 indicates that this parameter is unavailable; in this
   case, the ConversationalQualityR parameter MUST be omitted from the
   vq-rtcpxr event.

<span class="h6"><a class="selflink" name="section-4.6.2.11.6" href="#section-4.6.2.11.6">4.6.2.11.6</a>.  ExtRInEstAlg</span>

   This field provides a text name for the algorithm used to estimate
   ExternalR-In.  This field will be free-form text and not necessarily
   reflective of any standards or recommendations.

<span class="h6"><a class="selflink" name="section-4.6.2.11.7" href="#section-4.6.2.11.7">4.6.2.11.7</a>.  ExternalR-Out</span>

   This field corresponds to "ext. R factor" in <a href="rfc3611.html">RFC 3611</a> in the VoIP
   Metrics Report Block.  Here, the value is copied from RTCP XR message
   received from the remote endpoint on the "other" side of this
   endpoint; refer to <a href="rfc3611.html">RFC 3611</a> for a more detailed explanation).  The
   range of R is 0-95 for narrowband calls and 0-120 for wideband calls.
   Algorithms for computing this value SHOULD be compliant with ITU-T
   Recommendations P.564 and G.107.  Within <a href="rfc3611.html">RFC 3611</a>, a reported R
   factor of 127 indicates that this parameter is unavailable; in this
   case, the ConversationalQualityR parameter SHALL be omitted from the
   vq-rtcpxr event.

<span class="h6"><a class="selflink" name="section-4.6.2.11.8" href="#section-4.6.2.11.8">4.6.2.11.8</a>.  ExtROutEstAlg</span>

   This field provides a text name for the algorithm used to estimate
   ExternalR-Out.  This field will be free-form text and not necessarily
   reflective of any standards or recommendations.

<span class="h6"><a class="selflink" name="section-4.6.2.11.9" href="#section-4.6.2.11.9">4.6.2.11.9</a>.  MOS Reporting</span>

   Conversion of <a href="rfc3611.html">RFC 3611</a> reported mean opinion scores (MOSs) for use in
   reporting MOS-LQ and MOS-CQ MUST be performed by dividing the <a href="rfc3611.html">RFC</a>
   <a href="rfc3611.html">3611</a> reported value by 10 if this value is less than or equal to 50
   or omitting the MOS-xQ parameter if the <a href="rfc3611.html">RFC 3611</a> reported value is
   127 (which indicates unavailable).

<span class="h6"><a class="selflink" name="section-4.6.2.11.9.1" href="#section-4.6.2.11.9.1">4.6.2.11.9.1</a>.  MOS-LQ</span>

   This field corresponds to "MOSLQ" in <a href="rfc3611.html">RFC 3611</a> in the VoIP Metrics
   Report Block.  This parameter is the estimated mean opinion score for
   listening voice quality on a scale from 1 to 5, in which 5 represents
   "Excellent" and 1 represents "Unacceptable".  Algorithms for





<span class="grey">Pendleton, et al.            Standards Track                   [Page 28]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-29" id="page-29" href="#page-29" class="invisible"> </a>
<span class="grey"><a href="rfc6035.html">RFC 6035</a>         SIP Package for Voice Quality Reporting   November 2010</span>


   computing this value SHOULD be compliant with ITU-T Recommendation
   P.564 [<a href="#ref-10" title="&quot;Conformance testing for voice over IP transmission quality assessment models&quot;">10</a>].  This field provides a text name for the algorithm used
   to estimate MOS-LQ.

<span class="h6"><a class="selflink" name="section-4.6.2.11.9.2" href="#section-4.6.2.11.9.2">4.6.2.11.9.2</a>.  MOS-CQ</span>

   This field corresponds to "MOSCQ" in <a href="rfc3611.html">RFC 3611</a> in the VoIP Metrics
   Report Block.  This parameter is the estimated mean opinion score for
   conversation voice quality on a scale from 1 to 5, in which 5
   represents excellent and 1 represents unacceptable.  Algorithms for
   computing this value SHOULD be compliant with ITU-T Recommendation
   P.564 with regard to the listening quality element of the computed
   MOS score.

<span class="h6"><a class="selflink" name="section-4.6.2.11.9.3" href="#section-4.6.2.11.9.3">4.6.2.11.9.3</a>.  MOSCQEstAlg</span>

   This field provides a text name for the algorithm used to estimate
   MOS-CQ.  This field will be free-form text and not necessarily
   reflective of any standards or recommendations.

<span class="h6"><a class="selflink" name="section-4.6.2.11.10" href="#section-4.6.2.11.10">4.6.2.11.10</a>.  QoEEstAlg</span>

   This field provides a text description of the algorithm used to
   estimate all voice quality metrics.  This parameter is provided as an
   alternative to the separate estimation algorithms for use when the
   same algorithm is used for all measurements.  This field will be
   free-form text and not necessarily reflective of any standards or
   recommendations.

<span class="h3"><a class="selflink" name="section-4.7" href="#section-4.7">4.7</a>.  Message Flow and Syntax Examples</span>

   This section shows a number of message flow examples showing how the
   event package works.

<span class="h4"><a class="selflink" name="section-4.7.1" href="#section-4.7.1">4.7.1</a>.  End of Session Report Using NOTIFY</span>
















<span class="grey">Pendleton, et al.            Standards Track                   [Page 29]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-30" id="page-30" href="#page-30" class="invisible"> </a>
<span class="grey"><a href="rfc6035.html">RFC 6035</a>         SIP Package for Voice Quality Reporting   November 2010</span>


       Alice            Proxy/Registrar        Collector             Bob
       |                    |                    |                    |
       |                    |                    |                    |
       | REGISTER Allow-Event:vq-rtcpxr F1       |                    |
       |-------------------&gt;|                    |                    |
       |      200 OK F2     |                    |                    |
       |&lt;-------------------|                    |                    |
       |                    |  SUBSCRIBE Event:vq-rtcpxr F3           |
       |                    |&lt;-------------------|                    |
       | SUBSCRIBE Event:vq-rtcpxr F4            |                    |
       |&lt;-------------------|                    |                    |
       |     200 OK F5      |                    |                    |
       |-------------------&gt;|                    |                    |
       |                    |   200 OK F6        |                    |
       |                    |-------------------&gt;|                    |
       |      INVITE F7     |                    |                    |
       |-------------------&gt;|                    |                    |
       |                    |      INVITE F8     |                    |
       |                    |----------------------------------------&gt;|
       |                    |      200 OK F9     |                    |
       |                    |&lt;----------------------------------------|
       |     200 OK F10     |                    |                    |
       |&lt;-------------------|                    |                    |
       |        ACK F11     |                    |                    |
       |-------------------&gt;|                    |                    |
       |                    |      ACK F12       |                    |
       |                    |----------------------------------------&gt;|
       |        RTP         |                    |                    |
       |&lt;============================================================&gt;|
       |        RTCP, RTCP XR                    |                    |
       |&lt;============================================================&gt;|
       |                    |                    |                    |
       |    BYE F13         |                    |                    |
       |-------------------&gt;|      BYE F14       |                    |
       |                    |----------------------------------------&gt;|
       |                    |     200 OK F15     |                    |
       |                    |&lt;----------------------------------------|
       |     200 OK F16     |                    |                    |
       |&lt;-------------------|                    |                    |
       |  NOTIFY Event:vq-rtcpxr F17             |                    |
       |-------------------&gt;|                    |                    |
       |                    | NOTIFY Event:vq-rtcpxr F18              |
       |                    |-------------------&gt;|                    |
       |                    |     200 OK F19     |                    |
       |                    |&lt;-------------------|                    |
       |     200 OK F20     |                    |                    |
       |&lt;-------------------|                    |                    |




<span class="grey">Pendleton, et al.            Standards Track                   [Page 30]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-31" id="page-31" href="#page-31" class="invisible"> </a>
<span class="grey"><a href="rfc6035.html">RFC 6035</a>         SIP Package for Voice Quality Reporting   November 2010</span>


   Figure 1. Summary report with NOTIFY sent after session termination.
   In the call flow depicted in Figure 1, the following message format
   is sent in F17:

       NOTIFY sip:collector@example.org SIP/2.0
       Via: SIP/2.0/UDP pc22.example.org;branch=z9hG4bK3343d7
       Max-Forwards: 70
       To: &lt;sip:collector@example.org&gt;;tag=43524545
       From: Alice &lt;sip:alice@example.org&gt;;tag=a3343df32
       Call-ID: 1890463548
       CSeq: 4321 NOTIFY
       Contact: &lt;sip:alice@pc22.example.org&gt;
       Allow: INVITE, ACK, CANCEL, OPTIONS, BYE, REFER,
        SUBSCRIBE, NOTIFY
       Event: vq-rtcpxr
       Accept: application/sdp, message/sipfrag
       Subscription-State: active;expires=3600
       Content-Type: application/vq-rtcpxr
       Content-Length: ...

       VQSessionReport: CallTerm
       CallID: 6dg37f1890463
       LocalID: Alice &lt;sip:alice@example.org&gt;
       RemoteID: Bill &lt;sip:bill@example.net&gt;
       OrigID: Alice &lt;sip:alice@example.org&gt;
       LocalGroup: example-phone-55671
       RemoteGroup: example-gateway-09871
       LocalAddr: IP=10.10.1.100 PORT=5000 SSRC=1a3b5c7d
       LocalMAC: 00:1f:5b:cc:21:0f
       RemoteAddr:IP=11.1.1.150 PORT=5002 SSRC=0x2468abcd
       RemoteMAC: 00:26:08:8e:95:02
       LocalMetrics:
       Timestamps:START=2004-10-10T18:23:43Z STOP=2004-10-01T18:26:02Z
       SessionDesc:PT=0 PD=PCMU SR=8000 FD=20 FO=160 FPP=1 PPS=50
                       PLC=3 SSUP=on
       JitterBuffer:JBA=3 JBR=2 JBN=40 JBM=80 JBX=120
       PacketLoss:NLR=5.0 JDR=2.0
       BurstGapLoss:BLD=0 BD=0 GLD=2.0 GD=500 GMIN=16
       Delay:RTD=200 ESD=140 SOWD=200 IAJ=2 MAJ=10
       Signal:SL=-18 NL=-50 RERL=55
       QualityEst:RLQ=88 RCQ=85 EXTRI=90 MOSLQ=4.1 MOSCQ=4.0
         QoEEstAlg=P.564
       RemoteMetrics:
       Timestamps:START=2004-10-10T18:23:43Z STOP=2004-10-01T18:26:02Z
       SessionDesc:PT=0 PD=PCMU SR=8000 FD=20 FO=160 FPP=1 PPS=50
                       PLC=3 SSUP=on
       JitterBuffer:JBA=3 JBR=2 JBN=40 JBM=80 JBX=120
       PacketLoss:NLR=5.0 JDR=2.0



<span class="grey">Pendleton, et al.            Standards Track                   [Page 31]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-32" id="page-32" href="#page-32" class="invisible"> </a>
<span class="grey"><a href="rfc6035.html">RFC 6035</a>         SIP Package for Voice Quality Reporting   November 2010</span>


       BurstGapLoss:BLD=0 BD=0 GLD=2.0 GD=500 GMIN=16
       Delay:RTD=200 ESD=140 SOWD=200 IAJ=2 MAJ=10
       Signal:SL=-21 NL=-45 RERL=55
       QualityEst:RLQ=90 RCQ=85 EXTRI=90 MOSLQ=4.3 MOSCQ=4.2
         QoEEstAlg=P.564
       DialogID:1890463548@alice.example.org;to-tag=8472761;
         from-tag=9123dh311

<span class="h4"><a class="selflink" name="section-4.7.2" href="#section-4.7.2">4.7.2</a>.  Midsession Threshold Violation Using NOTIFY</span>

   Alice            Proxy/Registrar        Collector             Bob
    |                    |                    |                    |
    |                    |                    |                    |
    | REGISTER Allow-Event:vq-rtcpxr F1       |                    |
    |-------------------&gt;|                    |                    |
    |      200 OK F2     |                    |                    |
    |&lt;-------------------|                    |                    |
    |                    |  SUBSCRIBE Event:vq-rtcpxr F3           |
    |                    |&lt;-------------------|                    |
    | SUBSCRIBE Event:vq-rtcpxr F4            |                    |
    |&lt;-------------------|                    |                    |
    |     200 OK F5      |                    |                    |
    |-------------------&gt;|                    |                    |
    |                    |   200 OK F6        |                    |
    |                    |-------------------&gt;|                    |
    |      INVITE F7     |                    |                    |
    |-------------------&gt;|                    |                    |
    |                    |      INVITE F8     |                    |
    |                    |----------------------------------------&gt;|
    |                    |      200 OK F9     |                    |
    |                    |&lt;----------------------------------------|
    |     200 OK F10     |                    |                    |
    |&lt;-------------------|                    |                    |
    |        ACK F11     |                    |                    |
    |-------------------&gt;|                    |                    |
    |                    |      ACK F12       |                    |
    |                    |----------------------------------------&gt;|
    |        RTP         |                    |                    |
    |&lt;============================================================&gt;|
    |        RTCP, RTCP XR                    |                    |
    |&lt;============================================================&gt;|
    |  NOTIFY Event:vq-rtcpxr F13             |                    |
    |-------------------&gt;|                    |                    |
    |                    | NOTIFY Event:vq-rtcpxr F14              |
    |                    |-------------------&gt;|                    |
    |                    |     200 OK F15     |                    |
    |                    |&lt;-------------------|                    |
    |     200 OK F16     |                    |                    |



<span class="grey">Pendleton, et al.            Standards Track                   [Page 32]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-33" id="page-33" href="#page-33" class="invisible"> </a>
<span class="grey"><a href="rfc6035.html">RFC 6035</a>         SIP Package for Voice Quality Reporting   November 2010</span>


    |&lt;-------------------|                    |                    |
    |                    |                    |                    |
    |    BYE F17         |                    |                    |
    |-------------------&gt;|      BYE F18       |                    |
    |                    |----------------------------------------&gt;|
    |                    |     200 OK F19     |                    |
    |                    |&lt;----------------------------------------|
    |     200 OK F20     |                    |                    |
    |&lt;-------------------|                    |                    |
    |  NOTIFY Event:vq-rtcpxr F21             |                    |
    |-------------------&gt;|                    |                    |
    |                    | NOTIFY Event:vq-rtcpxr F22              |
    |                    |-------------------&gt;|                    |
    |                    |     200 OK F23     |                    |
    |                    |&lt;-------------------|                    |
    |     200 OK F24     |                    |                    |
    |&lt;-------------------|                    |                    |

   Figure 2.  An alert report is sent during the session.
   In the call flow depicted in Figure 2, the following message
   format is sent in F13:

       NOTIFY sip:collector@example.org SIP/2.0
       Via: SIP/2.0/UDP pc22.example.org;branch=z9hG4bK3343d7
       Max-Forwards: 70
       To: &lt;sip:proxy@example.org&gt;
       From: Alice &lt;sip:alice@example.org&gt;;tag=a3343df32
       Call-ID: 1890463548
       CSeq: 4331 PUBLISH
       Allow: INVITE, ACK, CANCEL, OPTIONS, BYE, REFER,
        SUBSCRIBE, NOTIFY
       Event: vq-rtcpxr
       Accept: application/sdp, message/sipfrag
       Content-Type: application/vq-rtcpxr
       Content-Length: ...

       VQAlertReport: Type=NLR Severity=Critical Dir=local
       CallID: 6dg37f1890463
       LocalID: Alice &lt;sip:alice@example.org&gt;
       RemoteID: Bill &lt;sip:bill@example.org&gt;
       OrigID: Alice &lt;sip:alice@example.org&gt;
       LocalGroup: example-phone-55671
       RemoteGroup: example-gateway-09871
       LocalAddr:IP=10.10.1.100 PORT=5000 SSRC=0x2468abcd
       LocalMAC: 00:1f:5b:cc:21:0f






<span class="grey">Pendleton, et al.            Standards Track                   [Page 33]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-34" id="page-34" href="#page-34" class="invisible"> </a>
<span class="grey"><a href="rfc6035.html">RFC 6035</a>         SIP Package for Voice Quality Reporting   November 2010</span>


       RemoteAddr:IP=11.1.1.150 PORT=5002 SSRC=1357efff
       RemoteMAC: 00:26:08:8e:95:02
       LocalMetrics:
       Timestamps:START=2004-10-10T18:23:43Z STOP=2004-10-01T18:26:02Z
       SessionDesc:PT=18 PD=G729 SR=8000 FD=20 FO=20 FPP=2 PPS=50
                       FMTP="annexb=no" PLC=3 SSUP=on
       JitterBuffer:JBA=3 JBR=2 JBN=40 JBM=80 JBX=120
       PacketLoss:NLR=10.0 JDR=2.0
       BurstGapLoss:BLD=0 BD=0 GLD=2.0 GD=500 GMIN=16
       Delay:RTD=200 ESD=140 SOWD=200 IAJ=2 MAJ=10
       Signal:SL=-21 NL=-50 RERL=55
       QualityEst:RLQ=80 RCQ=85 EXTRI=90 MOSLQ=3.5 MOSCQ=3.7
                        QoEEstAlg=P.564
       RemoteMetrics:
       Timestamps:START=2004-10-10T18:23:43Z STOP=2004-10-01T18:26:02Z
       SessionDesc:PT=18 PD=G729 SR=8000 FD=20 FO=20 FPP=2 PPS=50
                       FMTP="annexb=no" PLC=3 SSUP=on
       JitterBuffer:JBA=3 JBR=2 JBN=40 JBM=80 JBX=120
       PacketLoss:NLR=5.0 JDR=2.0
       BurstGapLoss:BLD=0 BD=0 GLD=2.0 GD=500 GMIN=16
       Delay:RTD=200 ESD=140 SOWD=200 IAJ=2 MAJ=10
       Signal:SL=-21 NL=-45 RERL=55
       QualityEst:RLQ=90 RCQ=85 MOSLQ=4.3 MOSCQ=4.2 QoEEstAlg=P.564
       DialogID:1890463548@alice.example.org;to-tag=8472761;
          from-tag=9123dh311


























<span class="grey">Pendleton, et al.            Standards Track                   [Page 34]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-35" id="page-35" href="#page-35" class="invisible"> </a>
<span class="grey"><a href="rfc6035.html">RFC 6035</a>         SIP Package for Voice Quality Reporting   November 2010</span>


<span class="h4"><a class="selflink" name="section-4.7.3" href="#section-4.7.3">4.7.3</a>.  End of Session Report Using PUBLISH</span>

      Alice            Proxy/Registrar        Collector              Bob
       |                    |                    |                    |
       |                    |                    |                    |
       | REGISTER Allow-Event:vq-rtcpxr  F1      |                    |
       |-------------------&gt;|                    |                    |
       |      200 OK F2     |                    |                    |
       |&lt;-------------------|                    |                    |
       |      INVITE F3     |                    |                    |
       |-------------------&gt;|                    |                    |
       |                    |      INVITE F4     |                    |
       |                    |----------------------------------------&gt;|
       |                    |      200 OK F5     |                    |
       |                    |&lt;----------------------------------------|
       |     200 OK F6      |                    |                    |
       |&lt;-------------------|                    |                    |
       |        ACK F7      |                    |                    |
       |-------------------&gt;|                    |                    |
       |                    |      ACK F8        |                    |
       |                    |----------------------------------------&gt;|
       |        RTP         |                    |                    |
       |&lt;============================================================&gt;|
       |        RTCP        |                    |                    |
       |&lt;============================================================&gt;|
       |                    |                    |                    |
       |    BYE F9          |                    |                    |
       |-------------------&gt;|      BYE F10       |                    |
       |                    |----------------------------------------&gt;|
       |                    |     200 OK F11     |                    |
       |                    |&lt;----------------------------------------|
       |     200 OK F12     |                    |                    |
       |&lt;-------------------|                    |                    |
       |  PUBLISH Event:vq-rtcpxr F13            |                    |
       |-------------------&gt;|                    |                    |
       |                    | PUBLISH Event:vq-rtcpxr F14             |
       |                    |-------------------&gt;|                    |
       |                    |     200 OK F15     |                    |
       |                    |&lt;-------------------|                    |
       |     200 OK F16     |                    |                    |
       |&lt;-------------------|                    |                    |

   Figure 3. End of session report sent after session termination.
   In the message flow depicted in Figure 3, the following message is
   sent in F13.






<span class="grey">Pendleton, et al.            Standards Track                   [Page 35]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-36" id="page-36" href="#page-36" class="invisible"> </a>
<span class="grey"><a href="rfc6035.html">RFC 6035</a>         SIP Package for Voice Quality Reporting   November 2010</span>


       PUBLISH sip:collector@example.org SIP/2.0
       Via: SIP/2.0/UDP pc22.example.org;branch=z9hG4bK3343d7
       Max-Forwards: 70
       To: &lt;sip:proxy@example.org&gt;
       From: Alice &lt;sip:alice@example.org&gt;;tag=a3343df32
       Call-ID: 1890463548
       CSeq: 4331 PUBLISH
       Allow: INVITE, ACK, CANCEL, OPTIONS, BYE, REFER,
        SUBSCRIBE, NOTIFY
       Event: vq-rtcpxr
       Accept: application/sdp, message/sipfrag
       Content-Type: application/vq-rtcpxr
       Content-Length: ...

       VQSessionReport: CallTerm
       CallID: 6dg37f1890463
       LocalID: Alice &lt;sip:alice@example.org&gt;
       RemoteID: Bill &lt;sip:bill@example.net&gt;
       OrigID: Alice &lt;sip:alice@example.org&gt;
       LocalGroup: example-phone-55671
       RemoteGroup: example-gateway-09871
       LocalAddr: IP=10.10.1.100 PORT=5000 SSRC=1a3b5c7d
       LocalMAC: 00:1f:5b:cc:21:0f
       RemoteAddr:IP=11.1.1.150 PORT=5002 SSRC=0x2468abcd
       RemoteMAC: 00:26:08:8e:95:02
       LocalMetrics:
       Timestamps:START=2004-10-10T18:23:43Z STOP=2004-10-01T18:26:02Z
       SessionDesc:PT=18 PD=G729 SR=8000 FD=20 FO=20 FPP=2 PPS=50
                       FMTP="annexb=no" PLC=3 SSUP=on
       JitterBuffer:JBA=3 JBR=2 JBN=40 JBM=80 JBX=120
       PacketLoss:NLR=5.0 JDR=2.0
       BurstGapLoss:BLD=0 BD=0 GLD=2.0 GD=500 GMIN=16
       Delay:RTD=200 ESD=140 SOWD=200 IAJ=2 MAJ=10
       Signal:SL=-21 NL=-50 RERL=55
       QualityEst:RLQ=90 RCQ=85 EXTRI=90 MOSLQ=4.2 MOSCQ=4.3
         QoEEstAlg=P.564
       RemoteMetrics:
       Timestamps:START=2004-10-10T18:23:43Z STOP=2004-10-01T18:26:02Z
       SessionDesc:PT=18 PD=G729 SR=8000 FD=20 FO=20 FPP=2 PPS=50
                       FMTP="annexb=no" PLC=3 SSUP=on
       JitterBuffer:JBA=3 JBR=2 JBN=40 JBM=80 JBX=120
       PacketLoss:NLR=5.0 JDR=2.0
       BurstGapLoss:BLD=0 BD=0 GLD=2.0 GD=500 GMIN=16
       Delay:RTD=200 ESD=140 SOWD=200 IAJ=2 MAJ=10
       Signal:SL=-21 NL=-45 RERL=55
       QualityEst:RLQ=90 RCQ=85 MOSLQ=4.3 MOSCQ=4.2 QoEEstAlg=P.564
       DialogID:1890463548@alice.example.org;to-tag=8472761;
          from-tag=9123dh311



<span class="grey">Pendleton, et al.            Standards Track                   [Page 36]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-37" id="page-37" href="#page-37" class="invisible"> </a>
<span class="grey"><a href="rfc6035.html">RFC 6035</a>         SIP Package for Voice Quality Reporting   November 2010</span>


<span class="h4"><a class="selflink" name="section-4.7.4" href="#section-4.7.4">4.7.4</a>.  Alert Report Using PUBLISH</span>

       Alice            Proxy/Registrar        Collector             Bob
       |                    |                    |                    |
       |      INVITE F1     |                    |                    |
       |-------------------&gt;|                    |                    |
       |                    |      INVITE F2     |                    |
       |                    |----------------------------------------&gt;|
       |                    |      200 OK F3     |                    |
       |                    |&lt;----------------------------------------|
       |     200 OK F4      |                    |                    |
       |&lt;-------------------|                    |                    |
       |        ACK F5      |                    |                    |
       |-------------------&gt;|                    |                    |
       |                    |      ACK F6        |                    |
       |                    |----------------------------------------&gt;|
       |        RTP         |                    |                    |
       |&lt;============================================================&gt;|
       |        RTCP        |                    |                    |
       |&lt;============================================================&gt;|
       |  PUBLISH Event:vq-rtcpxr F7             |                    |
       |-------------------&gt;|                    |                    |
       |                    | PUBLISH Event:vq-rtcpxr F8              |
       |                    |-------------------&gt;|                    |
       |                    |     200 OK F9      |                    |
       |                    |&lt;-------------------|                    |
       |     200 OK F10     |                    |                    |
       |&lt;-------------------|                    |                    |
       |                    |                    |                    |
       |      BYE F11       |                    |                    |
       |-------------------&gt;|      BYE F12       |                    |
       |                    |----------------------------------------&gt;|
       |                    |     200 OK F13     |                    |
       |                    |&lt;----------------------------------------|
       |     200 OK F14     |                    |                    |
       |&lt;-------------------|                    |                    |

   Figure 4. Alert report message flow

      In the message flow depicted in Figure 4, the following message is
      sent in F7:

       PUBLISH sip:collector@example.org SIP/2.0
       Via: SIP/2.0/UDP pc22.example.org;branch=z9hG4bK3343d7
       Max-Forwards: 70
       To: &lt;sip:collector@example.org&gt;
       From: Alice &lt;sip:alice@example.org&gt;;tag=a3343df32
       Call-ID: 1890463548



<span class="grey">Pendleton, et al.            Standards Track                   [Page 37]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-38" id="page-38" href="#page-38" class="invisible"> </a>
<span class="grey"><a href="rfc6035.html">RFC 6035</a>         SIP Package for Voice Quality Reporting   November 2010</span>


       CSeq: 4321 PUBLISH
       Allow: INVITE, ACK, CANCEL, OPTIONS, BYE, REFER,
        SUBSCRIBE, NOTIFY
       Event: vq-rtcpxr
       Accept: application/sdp, message/sipfrag
       Content-Type: application/vq-rtcpxr
       Content-Length: ...

       VQAlertReport: Type=RLQ Severity=Warning Dir=local
       CallID: 6dg37f1890463
       LocalID: Alice &lt;sip:alice@example.org&gt;
       RemoteID: Bill &lt;sip:bill@example.org&gt;
       OrigID: Alice &lt;sip:alice@example.org&gt;
       LocalGroup: example-phone-55671
       RemoteGroup: example-gateway-09871
       LocalAddr: IP=10.10.1.100 PORT=5000 SSRC=1a3b5c7d
       LocalMAC: 00:1f:5b:cc:21:0f
       RemoteAddr:IP=11.1.1.150 PORT=5002 SSRC=0x2468abcd
       RemoteMAC: 00:26:08:8e:95:02
       Metrics:
       Timestamps:START=2004-10-10T18:23:43Z STOP=2004-10-01T18:26:02Z
       SessionDesc:PT=0 PD=PCMU SR=8000 FD=20 FO=160 FPP=1 PPS=50
                       PLC=3 SSUP=on
       JitterBuffer:JBA=3 JBR=2 JBN=40 JBM=80 JBX=120
       PacketLoss:NLR=5.0 JDR=2.0
       BurstGapLoss:BLD=0 BD=0 GLD=2.0 GD=500 GMIN=16
       Delay:RTD=200 ESD=140 SOWD=200 IAJ=2 MAJ=10
       Signal:SL=-12 NL=-30 RERL=55
       QualityEst:RLQ=60 RCQ=55 EXTR=90 MOSLQ=2.4 MOSCQ=2.3
          QoEEstAlg=P.564
       RemoteMetrics:
       Timestamps:START=2004-10-10T18:23:43Z STOP=2004-10-01T18:26:02Z
       SessionDesc:PT=0 PD=PCMU SR=8000 FD=20 FO=160 FPP=1 PPS=50
                       PLC=3 SSUP=on
       JitterBuffer:JBA=3 JBR=2 JBN=40 JBM=80 JBX=120
       PacketLoss:NLR=5.0 JDR=2.0
       BurstGapLoss:BLD=0 BD=0 GLD=2.0 GD=500 GMIN=16
       Delay:RTD=200 ESD=140 SOWD=200 IAJ=2 MAJ=10
       Signal:SL=-23 NL=-60 RERL=55
       QualityEst:RLQ=90 RCQ=85 EXTRI=90 MOSLQ=4.2 MOSCQ=4.3
          QoEEstAlg=P.564
       DialogID:1890463548@alice.example.org;to-tag=8472761;
               from-tag=9123dh3111








<span class="grey">Pendleton, et al.            Standards Track                   [Page 38]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-39" id="page-39" href="#page-39" class="invisible"> </a>
<span class="grey"><a href="rfc6035.html">RFC 6035</a>         SIP Package for Voice Quality Reporting   November 2010</span>


<span class="h3"><a class="selflink" name="section-4.8" href="#section-4.8">4.8</a>.  Configuration Dataset for vq-rtcpxr Events</span>

   It is the suggestion of the authors that the SIP configuration
   framework [<a href="#ref-15" title="&quot;A Framework for Session Initiation Protocol User Agent Profile Delivery&quot;">15</a>] be used to establish the necessary parameters for
   usage of vq-rtcpxr events.  A dataset for this purpose should be
   designed and documented in a separate document upon completion of the
   framework.

<span class="h2"><a class="selflink" name="section-5" href="#section-5">5</a>.  IANA Considerations</span>

   This document registers a new SIP Event Package and a new media type.

<span class="h3"><a class="selflink" name="section-5.1" href="#section-5.1">5.1</a>.  SIP Event Package Registration</span>

      Package name: vq-rtcpxr
      Type: package
      Contact: Amy Pendleton &lt;aspen@telchemy.com&gt;
      Published Specification: This document

<span class="h3"><a class="selflink" name="section-5.2" href="#section-5.2">5.2</a>.  application/vq-rtcpxr Media Type Registration</span>

   Type name: application
   Subtype name: vq-rtcpxr
   Required parameters: none
   Optional parameters: none
   Encoding considerations: 7 bit
   Security considerations: See next section.
   Interoperability considerations: none.
   Published specification: This document.

   Applications that use this media type: This document type is
      being used in notifications of VoIP quality reports.

   Additional Information:

      Magic Number: None
      File Extension: None
      Macintosh file type code: "TEXT"

   Person and email address for further information: Amy Pendleton
      &lt;aspen@telchemy.com&gt;

   Intended usage: COMMON

   Author / Change controller: The IETF.






<span class="grey">Pendleton, et al.            Standards Track                   [Page 39]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-40" id="page-40" href="#page-40" class="invisible"> </a>
<span class="grey"><a href="rfc6035.html">RFC 6035</a>         SIP Package for Voice Quality Reporting   November 2010</span>


<span class="h2"><a class="selflink" name="section-6" href="#section-6">6</a>.  Security Considerations</span>

   RTCP reports can contain sensitive information since they can provide
   information about the nature and duration of a session established
   between two or more endpoints.  As a result, any third party wishing
   to obtain this information SHOULD be properly authenticated by the
   SIP UA using standard SIP mechanisms and according to the
   recommendations in [<a href="#ref-5" title="&quot;Session Initiation Protocol (SIP)-Specific Event Notification&quot;">5</a>].  Additionally, the event content MAY be
   encrypted to ensure confidentiality; the mechanisms for providing
   confidentiality are detailed in [<a href="#ref-2" title="&quot;SIP: Session Initiation Protocol&quot;">2</a>].

<span class="h2"><a class="selflink" name="section-7" href="#section-7">7</a>.  Contributors</span>

   The authors would like to thank Rajesh Kumar, Dave Oran, Tom Redman,
   Shane Holthaus, and Jack Ford for their comments and input.

<span class="h2"><a class="selflink" name="section-8" href="#section-8">8</a>.  References</span>

<span class="h3"><a class="selflink" name="section-8.1" href="#section-8.1">8.1</a>.  Normative References</span>

   [<a name="ref-1" id="ref-1">1</a>]   Bradner, S., "Key words for use in RFCs to Indicate Requirement
         Levels", <a href="http://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.

   [<a name="ref-2" id="ref-2">2</a>]   Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A.,
         Peterson, J., Sparks, R., Handley, M., and E. Schooler, "SIP:
         Session Initiation Protocol", <a href="rfc3261.html">RFC 3261</a>, June 2002.

   [<a name="ref-3" id="ref-3">3</a>]   Schulzrinne, H., Casner, S., Frederick, R., and V. Jacobson,
         "RTP: A Transport Protocol for Real-Time Applications", STD 64,
         <a href="rfc3550.html">RFC 3550</a>, July 2003.

   [<a name="ref-4" id="ref-4">4</a>]   Friedman, T., Caceres, R., and A. Clark, "RTP Control Protocol
         Extended Reports (RTCP XR)", <a href="rfc3611.html">RFC 3611</a>, November 2003.

   [<a name="ref-5" id="ref-5">5</a>]   Roach, A., "Session Initiation Protocol (SIP)-Specific Event
         Notification", <a href="rfc3265.html">RFC 3265</a>, June 2002.

   [<a name="ref-6" id="ref-6">6</a>]   Crocker, D. and P. Overell, "Augmented BNF for Syntax
         Specifications: ABNF", STD 68, <a href="rfc5234.html">RFC 5234</a>, January 2008.

   [<a name="ref-7" id="ref-7">7</a>]   Klyne, G., Ed. and C. Newman, "Date and Time on the Internet:
         Timestamps", <a href="rfc3339.html">RFC 3339</a>, July 2002.

   [<a name="ref-8" id="ref-8">8</a>]   Niemi, A., "Session Initiation Protocol (SIP) Extension for
         Event State Publication", <a href="rfc3903.html">RFC 3903</a>, October 2004.

   [<a name="ref-9" id="ref-9">9</a>]   ITU-T G.1020, "Performance parameter definitions for quality of
         speech and other voiceband applications utilizing IP networks".



<span class="grey">Pendleton, et al.            Standards Track                   [Page 40]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-41" id="page-41" href="#page-41" class="invisible"> </a>
<span class="grey"><a href="rfc6035.html">RFC 6035</a>         SIP Package for Voice Quality Reporting   November 2010</span>


   [<a name="ref-10" id="ref-10">10</a>]  ITU-T P.564, "Conformance testing for voice over IP
         transmission quality assessment models".

   [<a name="ref-11" id="ref-11">11</a>]  ITU-T G.107, "The E-model, a computational model for use in
         transmission planning".

   [<a name="ref-12" id="ref-12">12</a>]  Almes, G., Kalidindi, S., and M. Zekauskas, "A One-way Delay
         Metric for IPPM", <a href="rfc2679.html">RFC 2679</a>, September 1999.

<span class="h3"><a class="selflink" name="section-8.2" href="#section-8.2">8.2</a>.  Informative References</span>

   [<a name="ref-13" id="ref-13">13</a>]  Westerlund, M. and S. Wenger, "RTP Topologies", <a href="rfc5117.html">RFC 5117</a>,
         January 2008.

   [<a name="ref-14" id="ref-14">14</a>]  Hilt, V., Noel, E., Shen, C., and A. Abdelal, "Design
         Considerations for Session Initiation Protocol (SIP) Overload
         Control", Work in Progress, July 2009.

   [<a name="ref-15" id="ref-15">15</a>]  Petrie, D. and S. Channabasappa, "A Framework for Session
         Initiation Protocol User Agent Profile Delivery", Work
         in Progress, October 2010.

   [<a name="ref-16" id="ref-16">16</a>]  Rosenberg, J., Mahy, R., Matthews, P., and D. Wing, "Session
         Traversal Utilities for NAT (STUN)", <a href="rfc5389.html">RFC 5389</a>, October 2008.

Authors' Addresses

   Amy Pendleton
   Telchemy Incorporated
   EMail: aspen@telchemy.com


   Alan Clark
   Telchemy Incorporated
   EMail: alan.d.clark@telchemy.com


   Alan Johnston
   Avaya
   St. Louis, MO  63124
   EMail: alan.b.johnston@gmail.com


   Henry Sinnreich
   Unaffiliated
   EMail: henry.sinnreich@gmail.com





Pendleton, et al.            Standards Track                   [Page 41]

</pre><br />
<span class="noprint"><small><small>Html markup produced by rfcmarkup 1.107, available from
<a href="http://tools.ietf.org/tools/rfcmarkup/">http://tools.ietf.org/tools/rfcmarkup/</a>
</small></small></span>
</body>
<!-- Mirrored from tools.ietf.org/html/rfc6035 by HTTrack Website Copier/3.x [XR&CO'2010], Wed, 19 Mar 2014 18:35:13 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8"><!-- /Added by HTTrack -->
</html>
