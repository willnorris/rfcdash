<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head profile="http://dublincore.org/documents/2008/08/04/dc-html/">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="robots" content="index,follow" />
    <meta name="creator" content="rfcmarkup version 1.106" />
    <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" />
<meta name="DC.Identifier" content="urn:ietf:rfc:3664" />
<meta name="DC.Description.Abstract" content="Some implementations of IP Security (IPsec) may want to use a pseudo-\nrandom function derived from the Advanced Encryption Standard (AES).\nThis document describes such an algorithm, called AES-XCBC-PRF-128." />
<meta name="DC.Creator" content="Paul Hoffman &lt;paul.hoffman@vpnc.org&gt;" />
<meta name="DC.Date.Issued" content="January, 2004" />
<meta name="DC.Title" content="The AES-XCBC-PRF-128 Algorithm for the Internet Key Exchange Protocol (IKE)" />

    <link rel="icon" href="http://tools.ietf.org/images/rfc.png" type="image/png" />
    <link rel="shortcut icon" href="http://tools.ietf.org/images/rfc.png" type="image/png" />
    <title>RFC 3664 - The AES-XCBC-PRF-128 Algorithm for the Internet Key Exchange Protocol (IKE)</title>
    
    
    <style type="text/css">
	body {
	    margin: 0px 8px;
            font-size: 1em;
	}
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
   <div style="height: 13px;">
      <div onmouseover="this.style.cursor='pointer';"
         onclick="showElem('legend');"
         onmouseout="hideElem('legend')"
	 style="height: 6px; position: absolute;"
         class="pre noprint docinfo bgbrown"
         title="Click for colour legend." >                                                                        </div>
      <div id="legend"
           class="docinfo noprint pre legend"
           style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; "
           onmouseover="showElem('legend');"
           onmouseout="hideElem('legend');">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="http://tools.ietf.org/rfc/rfc3664.txt" title="Plaintext version of this document">txt</a>|<a href="http://tools.ietf.org/pdf/rfc3664" title="PDF version of this document">pdf</a>] [<a href="http://tools.ietf.org/html/draft-ietf-ipsec-aes-xcbc-prf" title="draft-ietf-ipsec-aes-xcbc-prf">draft-ietf-ipsec-...</a>] [<a href="http://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc3664" title="Inline diff (wdiff)">Diff1</a>] [<a href="http://tools.ietf.org/rfcdiff?url2=rfc3664" title="Side-by-side diff">Diff2</a>]                 </span><br />
<span class="pre noprint docinfo">                                                                        </span><br />
<span class="pre noprint docinfo">Obsoleted by: <a href="rfc4434.html">4434</a>                                     PROPOSED STANDARD</span><br />
<span class="pre noprint docinfo">                                                                        </span><br />
<pre>
Network Working Group                                         P. Hoffman
Request for Comments: 3664                                VPN Consortium
Category: Standards Track                                   January 2004


                   <span class="h1">The AES-XCBC-PRF-128 Algorithm for</span>
                <span class="h1">the Internet Key Exchange Protocol (IKE)</span>

Status of this Memo

   This document specifies an Internet standards track protocol for the
   Internet community, and requests discussion and suggestions for
   improvements.  Please refer to the current edition of the "Internet
   Official Protocol Standards" (STD 1) for the standardization state
   and status of this protocol.  Distribution of this memo is unlimited.

Copyright Notice

   Copyright (C) The Internet Society (2004).  All Rights Reserved.

Abstract

   Some implementations of IP Security (IPsec) may want to use a
   pseudo-random function derived from the Advanced Encryption Standard
   (AES).  This document describes such an algorithm, called AES-XCBC-
   PRF-128.

<span class="h2"><a class="selflink" name="section-1" href="#section-1">1</a>.  Introduction</span>

   [<a name="ref-AES-XCBC-MAC" id="ref-AES-XCBC-MAC">AES-XCBC-MAC</a>] describes a method to use the Advanced Encryption
   Standard (AES) as a message authentication code (MAC) whose output is
   96 bits long.  While 96 bits is considered appropriate for a MAC, it
   is too short to be useful as a long-lived pseudo-random (PRF) in
   either IKE version 1 or version 2.  Both versions of IKE use the PRF
   to create keys in a fashion that is dependent on the length of the
   output of the PRF.  Using a PRF that has 96 bits of output creates
   keys that are easier to attack with brute force than a PRF that uses
   128 bits of output.

   Fortunately, there is a very simple method to use much of [AES-XCBC-
   MAC] as a PRF whose output is 128 bits: omit the step that truncates
   the 128-bit value to 96 bits.









<span class="grey">Hoffman                     Standards Track                     [Page 1]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-2" id="page-2" href="#page-2" class="invisible"> </a>
<span class="grey"><a href="rfc3664.html">RFC 3664</a>         The AES-XCBC-PRF-128 Algorithm for IKE     January 2004</span>


<span class="h2"><a class="selflink" name="section-2" href="#section-2">2</a>.  The AES-XCBC-PRF-128 Algorithm</span>

   The AES-XCBC-PRF-128 algorithm is identical to [<a href="#ref-AES-XCBC-MAC" title="&quot;The AES-XCBC-MAC-96 Algorithm and Its Use With IPsec&quot;">AES-XCBC-MAC</a>] except
   that the truncation step in section 4.3 of [<a href="#ref-AES-XCBC-MAC" title="&quot;The AES-XCBC-MAC-96 Algorithm and Its Use With IPsec&quot;">AES-XCBC-MAC</a>] is *not*
   performed.  That is, there is no processing after section 4.2 of
   [<a href="#ref-AES-XCBC-MAC" title="&quot;The AES-XCBC-MAC-96 Algorithm and Its Use With IPsec&quot;">AES-XCBC-MAC</a>].

   The test vectors in <a href="#section-4.6">section 4.6</a> can be used for AES-XCBC-PRF-128, but
   only those listed as "AES-XCBC-MAC", not "AES-XCBC-MAC-96".

<span class="h2"><a class="selflink" name="section-3" href="#section-3">3</a>.  Security Considerations</span>

   The security provided by AES-XCBC-MAC-PRF is based upon the strength
   of AES.  At the time of this writing, there are no known practical
   cryptographic attacks against AES or AES-XCBC-MAC-PRF.

   As is true with any cryptographic algorithm, part of its strength
   lies in the security of the key management mechanism, the strength of
   the associated secret key, and upon the correctness of the
   implementations in all of the participating systems.  [<a href="#ref-AES-XCBC-MAC" title="&quot;The AES-XCBC-MAC-96 Algorithm and Its Use With IPsec&quot;">AES-XCBC-MAC</a>]
   contains test vectors to assist in verifying the correctness of the
   AES-XCBC-MAC-PRF code.  The test vectors all show the full MAC value
   before it is truncated to 96 bits.  The PRF makes use of the full MAC
   value, not the truncated one.

<span class="h2"><a class="selflink" name="section-4" href="#section-4">4</a>.  Intellectual Property Statement</span>

   The IETF takes no position regarding the validity or scope of any
   intellectual property or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; neither does it represent that it
   has made any effort to identify any such rights.  Information on the
   IETF's procedures with respect to rights in standards-track and
   standards-related documentation can be found in <a href="http://tools.ietf.org/html/bcp11">BCP-11</a>.  Copies of
   claims of rights made available for publication and any assurances of
   licenses to be made available, or the result of an attempt made to
   obtain a general license or permission for the use of such
   proprietary rights by implementors or users of this specification can
   be obtained from the IETF Secretariat.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights which may cover technology that may be required to practice
   this standard.  Please address the information to the IETF Executive
   Director.





<span class="grey">Hoffman                     Standards Track                     [Page 2]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-3" id="page-3" href="#page-3" class="invisible"> </a>
<span class="grey"><a href="rfc3664.html">RFC 3664</a>         The AES-XCBC-PRF-128 Algorithm for IKE     January 2004</span>


<span class="h2"><a class="selflink" name="section-5" href="#section-5">5</a>.  References</span>

<span class="h3"><a class="selflink" name="section-5.1" href="#section-5.1">5.1</a>.  Normative References</span>

   [<a name="ref-AES-XCBC-MAC" id="ref-AES-XCBC-MAC">AES-XCBC-MAC</a>] Frankel, S. and H. Herbert, "The AES-XCBC-MAC-96
                  Algorithm and Its Use With IPsec", <a href="rfc3566.html">RFC 3566</a>, September
                  2003.

<span class="h2"><a class="selflink" name="section-6" href="#section-6">6</a>.  Author's Address</span>

   Paul Hoffman
   VPN Consortium
   127 Segre Place
   Santa Cruz, CA  95060  USA

   EMail: paul.hoffman@vpnc.org



































<span class="grey">Hoffman                     Standards Track                     [Page 3]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-4" id="page-4" href="#page-4" class="invisible"> </a>
<span class="grey"><a href="rfc3664.html">RFC 3664</a>         The AES-XCBC-PRF-128 Algorithm for IKE     January 2004</span>


<span class="h2"><a class="selflink" name="section-7" href="#section-7">7</a>.  Full Copyright Statement</span>

   Copyright (C) The Internet Society (2004).  All Rights Reserved.

   This document and translations of it may be copied and furnished to
   others, and derivative works that comment on or otherwise explain it
   or assist in its implementation may be prepared, copied, published
   and distributed, in whole or in part, without restriction of any
   kind, provided that the above copyright notice and this paragraph are
   included on all such copies and derivative works.  However, this
   document itself may not be modified in any way, such as by removing
   the copyright notice or references to the Internet Society or other
   Internet organizations, except as needed for the purpose of
   developing Internet standards in which case the procedures for
   copyrights defined in the Internet Standards process must be
   followed, or as required to translate it into languages other than
   English.

   The limited permissions granted above are perpetual and will not be
   revoked by the Internet Society or its successors or assignees.

   This document and the information contained herein is provided on an
   "AS IS" basis and THE INTERNET SOCIETY AND THE INTERNET ENGINEERING
   TASK FORCE DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED, INCLUDING
   BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE INFORMATION
   HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED WARRANTIES OF
   MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

Acknowledgement

   Funding for the RFC Editor function is currently provided by the
   Internet Society.



















Hoffman                     Standards Track                     [Page 4]

</pre><br />
<span class="noprint"><small><small>Html markup produced by rfcmarkup 1.106, available from
<a href="http://tools.ietf.org/tools/rfcmarkup/">http://tools.ietf.org/tools/rfcmarkup/</a>
</small></small></span>
</body>
<!-- Mirrored from tools.ietf.org/html/rfc3664 by HTTrack Website Copier/3.x [XR&CO'2010], Wed, 19 Mar 2014 18:42:53 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8"><!-- /Added by HTTrack -->
</html>
