<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc5122 by HTTrack Website Copier/3.x [XR&CO'2013], Sat, 07 Jun 2014 20:18:44 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.107" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="rfc4622" name="DC.Relation.Replaces"/>
<meta content="urn:ietf:rfc:5122" name="DC.Identifier"/>
<meta content="February, 2008" name="DC.Date.Issued"/>
<meta content="Peter Saint-Andre &lt;stpeter@jabber.org&gt;" name="DC.Creator"/>
<meta content="This document defines the use of Internationalized Resource\nIdentifiers (IRIs) and Uniform Resource Identifiers (URIs) in\nidentifying or interacting with entities that can communicate via the\nExtensible Messaging and Presence Protocol (XMPP). [STANDARDS-TRACK]" name="DC.Description.Abstract"/>
<meta content="Internationalized Resource Identifiers (IRIs) and Uniform Resource Identifiers (URIs) for the Extensible Messaging and Presence Protocol (XMPP)" name="DC.Title"/>

    <link href="http://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="http://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 5122 - Internationalized Resource Identifiers (IRIs) and Uniform Resource Identifiers (URIs) for the Extensible Messaging and Presence Protocol (XMPP)</title>
    
    
    <style type="text/css">
	body {
	    margin: 0px 8px;
            font-size: 1em;
	}
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgblue" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="http://tools.ietf.org/rfc/rfc5122.txt" title="Plaintext version of this document">txt</a>|<a href="http://tools.ietf.org/pdf/rfc5122" title="PDF version of this document">pdf</a>] [<a href="http://tools.ietf.org/html/draft-saintandre-rfc4622bis" title="draft-saintandre-rfc4622bis">draft-saintandre-...</a>] [<a href="http://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc5122" title="Inline diff (wdiff)">Diff1</a>] [<a href="http://tools.ietf.org/rfcdiff?url2=rfc5122" title="Side-by-side diff">Diff2</a>]                 </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                       PROPOSED STANDARD</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<pre>Network Working Group                                     P. Saint-Andre
Request for Comments: 5122                                           XSF
Obsoletes: <a href="rfc4622.html">4622</a>                                            February 2008
Category: Standards Track


           <span class="h1">Internationalized Resource Identifiers (IRIs) and</span>
                <span class="h1">Uniform Resource Identifiers (URIs) for</span>
         <span class="h1">the Extensible Messaging and Presence Protocol (XMPP)</span>

Status of This Memo

   This document specifies an Internet standards track protocol for the
   Internet community, and requests discussion and suggestions for
   improvements.  Please refer to the current edition of the "Internet
   Official Protocol Standards" (STD 1) for the standardization state
   and status of this protocol.  Distribution of this memo is unlimited.

Abstract

   This document defines the use of Internationalized Resource
   Identifiers (IRIs) and Uniform Resource Identifiers (URIs) in
   identifying or interacting with entities that can communicate via the
   Extensible Messaging and Presence Protocol (XMPP).

   This document obsoletes <a href="rfc4622.html">RFC 4622</a>.

























<span class="grey">Saint-Andre                 Standards Track                     [Page 1]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc5122.html">RFC 5122</a>                     XMPP IRIs/URIs                February 2008</span>


Table of Contents

   <a href="#section-1">1</a>.  Introduction . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-3">3</a>
     <a href="#section-1.1">1.1</a>.  Terminology  . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-3">3</a>
   <a href="#section-2">2</a>.  Use of XMPP IRIs and URIs  . . . . . . . . . . . . . . . . . .  <a href="#page-4">4</a>
     <a href="#section-2.1">2.1</a>.  Rationale  . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-4">4</a>
     <a href="#section-2.2">2.2</a>.  Form . . . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-5">5</a>
     <a href="#section-2.3">2.3</a>.  Authority Component  . . . . . . . . . . . . . . . . . . .  <a href="#page-6">6</a>
     <a href="#section-2.4">2.4</a>.  Path Component . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-7">7</a>
     <a href="#section-2.5">2.5</a>.  Query Component  . . . . . . . . . . . . . . . . . . . . .  <a href="#page-8">8</a>
     <a href="#section-2.6">2.6</a>.  Fragment Identifier Component  . . . . . . . . . . . . . .  <a href="#page-9">9</a>
     <a href="#section-2.7">2.7</a>.  Generation of XMPP IRIs/URIs . . . . . . . . . . . . . . . <a href="#page-10">10</a>
     <a href="#section-2.8">2.8</a>.  Processing of XMPP IRIs/URIs . . . . . . . . . . . . . . . <a href="#page-13">13</a>
     <a href="#section-2.9">2.9</a>.  Internationalization . . . . . . . . . . . . . . . . . . . <a href="#page-16">16</a>
   <a href="#section-3">3</a>.  IANA Registration of xmpp URI Scheme . . . . . . . . . . . . . <a href="#page-16">16</a>
     <a href="#section-3.1">3.1</a>.  URI Scheme Name  . . . . . . . . . . . . . . . . . . . . . <a href="#page-16">16</a>
     <a href="#section-3.2">3.2</a>.  Status . . . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-16">16</a>
     <a href="#section-3.3">3.3</a>.  URI Scheme Syntax  . . . . . . . . . . . . . . . . . . . . <a href="#page-17">17</a>
     <a href="#section-3.4">3.4</a>.  URI Scheme Semantics . . . . . . . . . . . . . . . . . . . <a href="#page-17">17</a>
     <a href="#section-3.5">3.5</a>.  Encoding Considerations  . . . . . . . . . . . . . . . . . <a href="#page-17">17</a>
     <a href="#section-3.6">3.6</a>.  Applications/Protocols That Use This URI Scheme Name . . . <a href="#page-18">18</a>
     <a href="#section-3.7">3.7</a>.  Interoperability Considerations  . . . . . . . . . . . . . <a href="#page-18">18</a>
     <a href="#section-3.8">3.8</a>.  Security Considerations  . . . . . . . . . . . . . . . . . <a href="#page-18">18</a>
     <a href="#section-3.9">3.9</a>.  Contact  . . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-18">18</a>
     <a href="#section-3.10">3.10</a>. Author/Change Controller . . . . . . . . . . . . . . . . . <a href="#page-18">18</a>
     <a href="#section-3.11">3.11</a>. References . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-18">18</a>
   <a href="#section-4">4</a>.  IANA Considerations  . . . . . . . . . . . . . . . . . . . . . <a href="#page-18">18</a>
   <a href="#section-5">5</a>.  Security Considerations  . . . . . . . . . . . . . . . . . . . <a href="#page-19">19</a>
     <a href="#section-5.1">5.1</a>.  Reliability and Consistency  . . . . . . . . . . . . . . . <a href="#page-19">19</a>
     <a href="#section-5.2">5.2</a>.  Malicious Construction . . . . . . . . . . . . . . . . . . <a href="#page-20">20</a>
     <a href="#section-5.3">5.3</a>.  Back-End Transcoding . . . . . . . . . . . . . . . . . . . <a href="#page-20">20</a>
     <a href="#section-5.4">5.4</a>.  Sensitive Information  . . . . . . . . . . . . . . . . . . <a href="#page-20">20</a>
     <a href="#section-5.5">5.5</a>.  Semantic Attacks . . . . . . . . . . . . . . . . . . . . . <a href="#page-21">21</a>
     <a href="#section-5.6">5.6</a>.  Spoofing . . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-21">21</a>
   <a href="#section-6">6</a>.  Acknowledgements . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-21">21</a>
   <a href="#section-7">7</a>.  References . . . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-21">21</a>
     <a href="#section-7.1">7.1</a>.  Normative References . . . . . . . . . . . . . . . . . . . <a href="#page-21">21</a>
     <a href="#section-7.2">7.2</a>.  Informative References . . . . . . . . . . . . . . . . . . <a href="#page-22">22</a>
   <a href="#appendix-A">Appendix A</a>.  Differences from <a href="rfc4622.html">RFC 4622</a> . . . . . . . . . . . . . . <a href="#page-25">25</a>
   <a href="#appendix-B">Appendix B</a>.  Copying Conditions  . . . . . . . . . . . . . . . . . <a href="#page-25">25</a>











<span class="grey">Saint-Andre                 Standards Track                     [Page 2]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc5122.html">RFC 5122</a>                     XMPP IRIs/URIs                February 2008</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   The Extensible Messaging and Presence Protocol (XMPP) is a streaming
   XML technology that enables any two entities on a network to exchange
   well-defined but extensible XML elements (called "XML stanzas") at a
   rate close to real time.

   As specified in [<a href="#ref-XMPP-CORE" title='"Extensible Messaging and Presence Protocol (XMPP): Core"'>XMPP-CORE</a>], entity addresses as used in
   communications over an XMPP network must not be prepended with a
   Uniform Resource Identifier (URI) scheme (as specified in [<a href="#ref-URI" title='"Uniform Resource Identifier (URI): Generic Syntax"'>URI</a>]).
   However, applications external to an XMPP network may need to
   identify XMPP entities either as URIs or, in a more modern fashion,
   as Internationalized Resource Identifiers (IRIs; see [<a href="#ref-IRI" title='"Internationalized Resource Identifiers (IRIs)"'>IRI</a>]).
   Examples of such external applications include databases that need to
   store XMPP addresses and non-native user agents such as web browsers
   and calendaring applications that provide interfaces to XMPP
   services.

   The format for an XMPP address is defined in [<a href="#ref-XMPP-CORE" title='"Extensible Messaging and Presence Protocol (XMPP): Core"'>XMPP-CORE</a>].  Such an
   address may contain nearly any Unicode character [<a href="#ref-UNICODE" title='"The Unicode Standard, Version 3.2.0"'>UNICODE</a>] and must
   adhere to various profiles of stringprep [<a href="#ref-STRINGPREP" title='"Preparation of Internationalized Strings ("'>STRINGPREP</a>].  The result is
   that an XMPP address is fully internationalizable and is very close
   to being an IRI without a scheme.  However, given that there is no
   freestanding registry of IRI schemes, it is necessary to define XMPP
   identifiers primarily as URIs rather than as IRIs, and to register an
   XMPP URI scheme instead of an IRI scheme.  Therefore, this document
   does the following:

   o  Specifies how to identify XMPP entities as IRIs or URIs.

   o  Specifies how to interact with XMPP entities as IRIs or URIs.

   o  Formally defines the syntax for XMPP IRIs and URIs.

   o  Specifies how to transform XMPP IRIs into URIs and vice versa.

   o  Registers the xmpp URI scheme.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.1.%20%20Terminology"></a><a class="selflink" href="#section-1.1" name="section-1.1">1.1</a>.  Terminology</span>

   This document inherits terminology from [<a href="#ref-IRI" title='"Internationalized Resource Identifiers (IRIs)"'>IRI</a>], [<a href="#ref-URI" title='"Uniform Resource Identifier (URI): Generic Syntax"'>URI</a>], and
   [<a href="#ref-XMPP-CORE" title='"Extensible Messaging and Presence Protocol (XMPP): Core"'>XMPP-CORE</a>].

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in <a href="rfc2119.html">RFC 2119</a> [<a href="#ref-TERMS" title='"Key words for use in RFCs to Indicate Requirement Levels"'>TERMS</a>].





<span class="grey">Saint-Andre                 Standards Track                     [Page 3]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc5122.html">RFC 5122</a>                     XMPP IRIs/URIs                February 2008</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Use%20of%20XMPP%20IRIs%20and%20URIs"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Use of XMPP IRIs and URIs</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.1.%20%20Rationale"></a><a class="selflink" href="#section-2.1" name="section-2.1">2.1</a>.  Rationale</span>

   As described in [<a href="#ref-XMPP-IM" title='"Extensible Messaging and Presence Protocol (XMPP): Instant Messaging and Presence"'>XMPP-IM</a>], instant messaging and presence
   applications of XMPP must handle im: and pres: URIs (as specified by
   [<a href="#ref-CPIM" title='"Common Profile for Instant Messaging (CPIM)"'>CPIM</a>] and [<a href="#ref-CPP" title='"Common Profile for Presence (CPP)"'>CPP</a>]).  However, there are many other applications of
   XMPP (including network management, workflow systems, generic
   publish-subscribe, remote procedure calls, content syndication,
   gaming, and middleware), and these applications do not implement
   instant messaging and presence semantics.  Furthermore, a generic
   XMPP entity does not implement the semantics of any existing URI
   scheme, such as the http:, ftp:, or mailto: scheme.  Therefore, it is
   appropriate to define a new URI scheme that makes it possible to
   identify or interact with any XMPP entity (not just instant messaging
   and presence entities) as an IRI or URI.

   XMPP IRIs and URIs are defined for use by non-native interfaces and
   applications.  In order to ensure interoperability on XMPP networks,
   when data is routed to an XMPP entity (e.g., when an XMPP address is
   contained in the 'to' or 'from' attribute of an XML stanza) or an
   XMPP entity is otherwise identified in standard XMPP protocol
   elements, the entity MUST be addressed as &lt;[node@]domain[/resource]&gt;
   (i.e., without a prepended scheme), where the "node identifier",
   "domain identifier", and "resource identifier" portions of an XMPP
   address conform to the definitions provided in Section 3 of
   [<a href="#ref-XMPP-CORE" title='"Extensible Messaging and Presence Protocol (XMPP): Core"'>XMPP-CORE</a>].

   Note: For historical reasons, the term "resource identifier" is used
   in XMPP to refer to the optional portion of an XMPP address that
   follows the domain identifier and the "/" separator character (for
   details, refer to Section 3.4 of [<a href="#ref-XMPP-CORE" title='"Extensible Messaging and Presence Protocol (XMPP): Core"'>XMPP-CORE</a>]); this use of the term
   "resource identifier" is not to be confused with the meanings of
   "resource" and "identifier" provided in Section 1.1 of [<a href="#ref-URI" title='"Uniform Resource Identifier (URI): Generic Syntax"'>URI</a>].

   XMPP IRIs and URIs are defined primarily for the purpose of
   identification rather than of interaction (regarding this
   distinction, see Section 1.2.2 of [<a href="#ref-URI" title='"Uniform Resource Identifier (URI): Generic Syntax"'>URI</a>]).  The "Internet resource"
   identified by an XMPP IRI or URI is an entity that can communicate
   via XMPP over a network.  An XMPP IRI or URI can contain additional
   information above and beyond the identified resource; in particular,
   as described under <a href="#section-2.5">Section 2.5</a> a query component can be included to
   specify suggested semantics for an interaction with the identified
   resource.  It is envisioned that when an XMPP application resolves an
   XMPP IRI or URI containing suggested interaction semantics, the
   application will generate an XMPP stanza and send it to the
   identified resource, where the generated stanza may include user or




<span class="grey">Saint-Andre                 Standards Track                     [Page 4]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc5122.html">RFC 5122</a>                     XMPP IRIs/URIs                February 2008</span>


   application inputs that are consistent with the suggested interaction
   semantics (for details, see <a href="#section-2.8.1">Section 2.8.1</a>).

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.2.%20%20Form"></a><a class="selflink" href="#section-2.2" name="section-2.2">2.2</a>.  Form</span>

   As described in [<a href="#ref-XMPP-CORE" title='"Extensible Messaging and Presence Protocol (XMPP): Core"'>XMPP-CORE</a>], an XMPP address used natively on an XMPP
   network is a string of Unicode characters that (1) conforms to a
   certain set of stringprep [<a href="#ref-STRINGPREP" title='"Preparation of Internationalized Strings ("'>STRINGPREP</a>] profiles and IDNA restrictions
   [<a href="#ref-IDNA" title='"Internationalizing Domain Names in Applications (IDNA)"'>IDNA</a>], (2) follows a certain set of syntax rules, and (3) is encoded
   as UTF-8 [<a href="#ref-UTF-8" title='"UTF-8, a transformation format of ISO 10646"'>UTF-8</a>].  The form of such an address can be represented
   using Augmented Backus-Naur Form [<a href="#ref-ABNF" title='"Augmented BNF for Syntax Specifications: ABNF"'>ABNF</a>] as:

      [ node "@" ] domain [ "/" resource ]

   In this context, the "node" and "resource" rules rely on distinct
   profiles of stringprep [<a href="#ref-STRINGPREP" title='"Preparation of Internationalized Strings ("'>STRINGPREP</a>], and the "domain" rule relies on
   the concept of an internationalized domain name as described in
   [<a href="#ref-IDNA" title='"Internationalizing Domain Names in Applications (IDNA)"'>IDNA</a>].  (Note: There is no need to refer to punycode in the IRI
   syntax itself, since any punycode representation would occur only
   inside an XMPP application in order to represent internationalized
   domain names.  However, it is the responsibility of the processing
   application to convert IRI syntax [<a href="#ref-IRI" title='"Internationalized Resource Identifiers (IRIs)"'>IRI</a>] into IDNA syntax [<a href="#ref-IDNA" title='"Internationalizing Domain Names in Applications (IDNA)"'>IDNA</a>]
   before addressing XML stanzas to the specified entity on an XMPP
   network.)

   Certain characters are allowed in XMPP node identifiers and XMPP
   resource identifiers but not in the relevant portion of an IRI or
   URI.  The characters are as follows:

   In node identifiers:  [ \ ] ^ ` { | }

   In resource identifiers:  " &lt; &gt; [ \ ] ^ ` { | }

   The node identifier characters are not allowed in userinfo by the
   sub-delims rule and the resource identifier characters are not
   allowed in segment by the pchar rule.  These characters MUST be
   percent-encoded when transforming an XMPP address into an XMPP IRI or
   URI.

   Naturally, in order to be converted into an IRI or URI, an XMPP
   address must be prepended with a scheme (specifically, the xmpp
   scheme) and may also need to undergo transformations that adhere to
   the rules defined in [<a href="#ref-IRI" title='"Internationalized Resource Identifiers (IRIs)"'>IRI</a>] and [<a href="#ref-URI" title='"Uniform Resource Identifier (URI): Generic Syntax"'>URI</a>].  Furthermore, in order to
   enable more advanced interaction with an XMPP entity rather than
   simple identification, it is desirable to take advantage of
   additional aspects of URI syntax and semantics, such as authority
   components, query components, and fragment identifier components.




<span class="grey">Saint-Andre                 Standards Track                     [Page 5]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc5122.html">RFC 5122</a>                     XMPP IRIs/URIs                February 2008</span>


   Therefore, the ABNF syntax for an XMPP IRI is defined as shown below
   using Augmented Backus-Naur Form specified by [<a href="#ref-ABNF" title='"Augmented BNF for Syntax Specifications: ABNF"'>ABNF</a>], where the
   "ifragment", "ihost", and "iunreserved" rules are defined in [<a href="#ref-IRI" title='"Internationalized Resource Identifiers (IRIs)"'>IRI</a>]
   and the "pct-encoded" rule is defined in [<a href="#ref-URI" title='"Uniform Resource Identifier (URI): Generic Syntax"'>URI</a>]:

     xmppiri    = "xmpp" ":" ihierxmpp
                  [ "?" iquerycomp ]
                  [ "#" ifragment ]
     ihierxmpp  = iauthpath / ipathxmpp
     iauthpath  = "//" iauthxmpp [ "/" ipathxmpp ]
     iauthxmpp  = inodeid "@" ihost
     ipathxmpp  = [ inodeid "@" ] ihost [ "/" iresid ]
     inodeid    = *( iunreserved / pct-encoded / nodeallow )
     nodeallow  = "!" / "$" / "(" / ")" / "*" / "+" / "," / ";" / "="
     iresid     = *( iunreserved / pct-encoded / resallow )
     resallow   = "!" / "$" / "&amp;" / "'" / "(" / ")" /
                  "*" / "+" / "," / ":" / ";" / "="
     iquerycomp = iquerytype [ *ipair ]
     iquerytype = *iunreserved
     ipair      = ";" ikey "=" ivalue
     ikey       = *iunreserved
     ivalue     = *( iunreserved / pct-encoded )

   However, the foregoing syntax is not appropriate for inclusion in the
   registration of the xmpp URI scheme, since the IANA recognizes only
   URI schemes and not IRI schemes.  Therefore, the ABNF syntax for an
   XMPP URI rather than for IRI is defined as shown in <a href="#section-3.3">Section 3.3</a> of
   this document.  If it is necessary to convert the IRI syntax into URI
   syntax, an application MUST adhere to the mapping procedure specified
   in Section 3.1 of [<a href="#ref-IRI" title='"Internationalized Resource Identifiers (IRIs)"'>IRI</a>].

   The following is an example of a basic XMPP IRI/URI used for purposes
   of identifying a node associated with an XMPP server:

      xmpp:node@example.com

   Descriptions of the various components of an XMPP IRI/URI are
   provided in the following sections.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.3.%20%20Authority%20Component"></a><a class="selflink" href="#section-2.3" name="section-2.3">2.3</a>.  Authority Component</span>

   As explained in <a href="#section-2.8">Section 2.8</a> of this document, in the absence of an
   authority component, the processing application would authenticate as
   a configured user at a configured XMPP server.  That is, the
   authority component section is unnecessary and should be ignored if
   the processing application has been configured with a set of default
   credentials.




<span class="grey">Saint-Andre                 Standards Track                     [Page 6]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc5122.html">RFC 5122</a>                     XMPP IRIs/URIs                February 2008</span>


   In accordance with <a href="rfc3986.html#section-3.2">SectionÂ 3.2 of RFC 3986</a> [<a href="#ref-URI" title='"Uniform Resource Identifier (URI): Generic Syntax"'>URI</a>], the authority
   component is preceded by a double slash ("//") and is terminated by
   the next slash ("/"), question mark ("?"), or number sign ("#")
   character, or by the end of the IRI/URI.  As explained more fully in
   <a href="#section-2.8.1">Section 2.8.1</a> of this document, the presence of an authority
   component signals the processing application to authenticate as the
   node@domain specified in the authority component rather than as a
   configured node@domain (see the Security Considerations section of
   this document regarding authentication).  (While it is unlikely that
   the authority component will be included in most XMPP IRIs or URIs,
   the scheme allows for its inclusion, if appropriate.)  Thus, the
   following XMPP IRI/URI indicates to authenticate as
   "guest@example.com":

      xmpp://guest@example.com

   Note well that this is quite different from the following XMPP IRI/
   URI, which identifies a node "guest@example.com" but does not signal
   the processing application to authenticate as that node:

      xmpp:guest@example.com

   Similarly, using a possible query component of "?message" to trigger
   an interface for sending a message, the following XMPP IRI/URI
   signals the processing application to authenticate as
   "guest@example.com" and to send a message to "support@example.com":

      xmpp://guest@example.com/support@example.com?message

   By contrast, the following XMPP IRI/URI signals the processing
   application to authenticate as its configured default account and to
   send a message to "support@example.com":

      xmpp:support@example.com?message

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.4.%20%20Path%20Component"></a><a class="selflink" href="#section-2.4" name="section-2.4">2.4</a>.  Path Component</span>

   The path component of an XMPP IRI/URI identifies an XMPP address or
   specifies the XMPP address to which an XML stanza shall be directed
   at the end of IRI/URI processing.

   For example, the following XMPP IRI/URI identifies a node associated
   with an XMPP server:

      xmpp:example-node@example.com






<span class="grey">Saint-Andre                 Standards Track                     [Page 7]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc5122.html">RFC 5122</a>                     XMPP IRIs/URIs                February 2008</span>


   The following XMPP IRI/URI identifies a node associated with an XMPP
   server along with a particular XMPP resource identifier associated
   with that node:

      xmpp:example-node@example.com/some-resource

   Inclusion of a node is optional in XMPP addresses, so the following
   XMPP IRI/URI simply identifies an XMPP server:

      xmpp:example.com

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.5.%20%20Query%20Component"></a><a class="selflink" href="#section-2.5" name="section-2.5">2.5</a>.  Query Component</span>

   There are many potential use cases for encapsulating information in
   the query component of an XMPP IRI/URI for the purpose of specifying
   suggested interaction semantics (see <a href="#section-2.1">Section 2.1</a>); examples include,
   but are not limited to:

   o  sending an XMPP message stanza (see [<a href="#ref-XMPP-IM" title='"Extensible Messaging and Presence Protocol (XMPP): Instant Messaging and Presence"'>XMPP-IM</a>]),

   o  adding a roster item (see [<a href="#ref-XMPP-IM" title='"Extensible Messaging and Presence Protocol (XMPP): Instant Messaging and Presence"'>XMPP-IM</a>]),

   o  sending a presence subscription (see [<a href="#ref-XMPP-IM" title='"Extensible Messaging and Presence Protocol (XMPP): Instant Messaging and Presence"'>XMPP-IM</a>]),

   o  probing for current presence information (see [<a href="#ref-XMPP-IM" title='"Extensible Messaging and Presence Protocol (XMPP): Instant Messaging and Presence"'>XMPP-IM</a>]),

   o  triggering a remote procedure call (see [<a href="#ref-XEP-0009" title='"Jabber-RPC"'>XEP-0009</a>]),

   o  discovering the identity or capabilities of another entity (see
      [<a href="#ref-XEP-0030" title='"Service Discovery"'>XEP-0030</a>]),

   o  joining an XMPP-based text chat room (see [<a href="#ref-XEP-0045" title='"Multi-User Chat"'>XEP-0045</a>]),

   o  interacting with publish-subscribe channels (see [<a href="#ref-XEP-0060" title='"Publish- Subscribe"'>XEP-0060</a>]),

   o  providing a SOAP interface (see [<a href="#ref-XEP-0072" title='"SOAP Over XMPP"'>XEP-0072</a>]), and

   o  registering with another entity (see [<a href="#ref-XEP-0077" title='"In-Band Registration"'>XEP-0077</a>]).

   Many of these potential use cases are application specific, and the
   full range of such applications cannot be foreseen in advance given
   the continued expansion in XMPP development.  However, there is
   agreement within the Jabber/XMPP developer community that all the
   uses envisioned to date can be encapsulated via a "query type",
   optionally supplemented by one or more "key-value" pairs (this is
   similar to the "application/x-www-form-urlencoded" MIME type
   described in [<a href="#ref-HTML" title='"HTML 4.0 Specification"'>HTML</a>]).




<span class="grey">Saint-Andre                 Standards Track                     [Page 8]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc5122.html">RFC 5122</a>                     XMPP IRIs/URIs                February 2008</span>


   As an example, an XMPP IRI/URI intended to launch an interface for
   sending a message to the XMPP entity "example-node@example.com" might
   be represented as follows:

      xmpp:example-node@example.com?message

   Similarly, an XMPP IRI/URI intended to launch an interface for
   sending a message to the XMPP entity "example-node@example.com" with
   a particular subject might be represented as follows:

      xmpp:example-node@example.com?message;subject=Hello%20World

   If the processing application does not understand query components or
   the specified query type, it MUST ignore the query component and
   treat the IRI/URI as consisting of, for example,
   &lt;xmpp:example-node@example.com&gt; rather than
   &lt;xmpp:example-node@example.com?query&gt;.  If the processing application
   does not understand a particular key within the query component, it
   MUST ignore that key and its associated value.

   As noted, there exist many kinds of XMPP applications (both actual
   and potential), and such applications may define query types and keys
   for use in the query component portion of XMPP URIs.  The XMPP
   Registrar function (see [<a href="#ref-XEP-0053" title='"XMPP Registrar Function"'>XEP-0053</a>]) of the XMPP Standards Foundation
   maintains a registry of such query types and keys at
   &lt;<a href="http://www.xmpp.org/registrar/querytypes.html">http://www.xmpp.org/registrar/querytypes.html</a>&gt;.  To help ensure
   interoperability, any application using the formats defined in this
   document SHOULD submit any associated query types and keys to that
   registry in accordance with the procedures specified in [<a href="#ref-XEP-0147" title='"XMPP URI Scheme Query Components"'>XEP-0147</a>].

   Note: The delimiter between key-value pairs is the ";" character
   instead of the "&amp;" character used in many other URI schemes.  This
   delimiter was chosen in order to avoid problems with escaping of the
   &amp; character in HTML and XML applications.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.6.%20%20Fragment%20Identifier%20Component"></a><a class="selflink" href="#section-2.6" name="section-2.6">2.6</a>.  Fragment Identifier Component</span>

   As stated in Section 3.5 of [<a href="#ref-URI" title='"Uniform Resource Identifier (URI): Generic Syntax"'>URI</a>], "The fragment identifier component
   of a URI allows indirect identification of a secondary resource by
   reference to a primary resource and additional identifying
   information."  Because the resource identified by an XMPP IRI/URI
   does not make available any media type (see [<a href="#ref-MIME" title='"Multipurpose Internet Mail Extensions (MIME) Part Two: Media Types"'>MIME</a>]) and therefore (in
   the terminology of [<a href="#ref-URI" title='"Uniform Resource Identifier (URI): Generic Syntax"'>URI</a>]) no representation exists at an XMPP
   resource, the semantics of the fragment identifier component in XMPP
   IRIs/URIs are to be "considered unknown and, effectively,
   unconstrained" (ibid.).  Particular XMPP applications MAY make use of
   the fragment identifier component for their own purposes.  However,
   if a processing application does not understand fragment identifier



<span class="grey">Saint-Andre                 Standards Track                     [Page 9]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc5122.html">RFC 5122</a>                     XMPP IRIs/URIs                February 2008</span>


   components or the syntax of a particular fragment identifier
   component included in an XMPP IRI/URI, it MUST ignore the fragment
   identifier component.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.7.%20%20Generation%20of%20XMPP%20IRIs%2FURIs"></a><a class="selflink" href="#section-2.7" name="section-2.7">2.7</a>.  Generation of XMPP IRIs/URIs</span>

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.7.1.%20%20Generation%20Method"></a><a class="selflink" href="#section-2.7.1" name="section-2.7.1">2.7.1</a>.  Generation Method</span>

   In order to form an XMPP IRI from an XMPP node identifier, domain
   identifier, and resource identifier, the generating application MUST
   first ensure that the XMPP address conforms to the rules specified in
   [<a href="#ref-XMPP-CORE" title='"Extensible Messaging and Presence Protocol (XMPP): Core"'>XMPP-CORE</a>], including encoding as a UTF-8 [<a href="#ref-UTF-8" title='"UTF-8, a transformation format of ISO 10646"'>UTF-8</a>] string and
   application of the relevant stringprep profiles [<a href="#ref-STRINGPREP" title='"Preparation of Internationalized Strings ("'>STRINGPREP</a>].
   Because IRI syntax [<a href="#ref-IRI" title='"Internationalized Resource Identifiers (IRIs)"'>IRI</a>] specifies that the characters in an IRI are
   the original Unicode characters themselves [<a href="#ref-UNICODE" title='"The Unicode Standard, Version 3.2.0"'>UNICODE</a>], when generating
   an XMPP IRI the generating application MUST then decode the UTF-8
   [<a href="#ref-UTF-8" title='"UTF-8, a transformation format of ISO 10646"'>UTF-8</a>] characters of a native XMPP address to their original Unicode
   form.  The generating application then MUST concatenate the
   following:

   1.  The "xmpp" scheme and the ":" character.

   2.  Optionally (if an authority component is to be included before
       the node identifier), the characters "//", an authority component
       of the form node@domain, and the character "/".

   3.  Optionally (if the XMPP address contained an XMPP "node
       identifier"), a string of Unicode characters that conforms to the
       "inodeid" rule, followed by the "@" character.

   4.  A string of Unicode characters that conforms to the "ihost" rule.

   5.  Optionally (if the XMPP address contained an XMPP "resource
       identifier"), the character "/" and a string of Unicode
       characters that conforms to the "iresid" rule.

   6.  Optionally (if a query component is to be included), the "?"
       character and query component.

   7.  Optionally (if a fragment identifier component is to be
       included), the "#" character and fragment identifier component.

   In order to form an XMPP URI from the resulting IRI, an application
   MUST adhere to the mapping procedure specified in Section 3.1 of
   [<a href="#ref-IRI" title='"Internationalized Resource Identifiers (IRIs)"'>IRI</a>].






<span class="grey">Saint-Andre                 Standards Track                    [Page 10]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc5122.html">RFC 5122</a>                     XMPP IRIs/URIs                February 2008</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.7.2.%20%20Generation%20Notes"></a><a class="selflink" href="#section-2.7.2" name="section-2.7.2">2.7.2</a>.  Generation Notes</span>

   Certain characters are allowed in the node identifier, domain
   identifier, and resource identifier portions of a native XMPP address
   but prohibited by the "inodeid", "ihost", and "iresid" rules of an
   XMPP IRI.  Specifically, the "#" and "?" characters are allowed in
   node identifiers, and the "/", "?", "#", and "@" characters are
   allowed in resource identifiers, but these characters are used as
   delimiters in XMPP IRIs.  In addition, the " " ([<a href="#ref-US-ASCII" title='"Coded Character Set - 7-bit American Standard Code for Information Interchange"'>US-ASCII</a>] space)
   character is allowed in resource identifiers but prohibited in IRIs.
   Therefore, all the foregoing characters MUST be percent-encoded when
   transforming an XMPP address into an XMPP IRI.

   Consider the following nasty node in an XMPP address:

      nasty!#$%()*+,-.;=?[\]^_`{|}~node@example.com

   That address would be transformed into the following XMPP IRI (split
   into two lines for layout purposes):

      xmpp:nasty!%23$%25()*+,-.;=%3F%5B%5C%5D%5E_%60%7B%7C%7D~node
      @example.com

   Consider the following repulsive resource in an XMPP address (split
   into two lines for layout purposes):

      node@example.com
      /repulsive !#"$%&amp;'()*+,-./:;&lt;=&gt;?@[\]^_`{|}~resource

   That address would be transformed into the following XMPP IRI (split
   into three lines for layout purposes):

      xmpp:node@example.com
      /repulsive%20!%23%22$%25&amp;'()*+,-.%2F:;%3C=
      %3E%3F%40%5B%5C%5D%5E_%60%7B%7C%7D~resource

   Furthermore, virtually any character outside the US-ASCII range
   [<a href="#ref-US-ASCII" title='"Coded Character Set - 7-bit American Standard Code for Information Interchange"'>US-ASCII</a>] is allowed in an XMPP address and therefore also in an
   XMPP IRI, but URI syntax forbids such characters directly and
   specifies that such characters MUST be percent-encoded.  In order to
   determine the URI associated with an XMPP IRI, an application MUST
   adhere to the mapping procedure specified in Section 3.1 of [<a href="#ref-IRI" title='"Internationalized Resource Identifiers (IRIs)"'>IRI</a>].

   The following table may assist implementors in understanding the
   respective encodings and "carrier units" of the identifiers discussed
   in this document, namely: (1) native XMPP addresses, (2) IRIs, and
   (3) URIs.  For details, refer to <a href="#section-3.5">Section 3.5</a> of this document as well




<span class="grey">Saint-Andre                 Standards Track                    [Page 11]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc5122.html">RFC 5122</a>                     XMPP IRIs/URIs                February 2008</span>


   as Section 3 of [<a href="#ref-XMPP-CORE" title='"Extensible Messaging and Presence Protocol (XMPP): Core"'>XMPP-CORE</a>], Section 6.4 of [<a href="#ref-IRI" title='"Internationalized Resource Identifiers (IRIs)"'>IRI</a>], and <a href="#section-2">Section 2</a> of
   [<a href="#ref-URI" title='"Uniform Resource Identifier (URI): Generic Syntax"'>URI</a>].

   +--------------+-----------+-----------+
   | Identifier   | Encoding  | Units     |
   +--------------+-----------+-----------+
   | XMPP address | UTF-8     | Octets    |
   +--------------+-----------+-----------+
   | IRI          | Unicode   | 16/32-bit |
   |              |           | values    |
   +--------------+-----------+-----------+
   | URI          | Percent-  | US-ASCII  |
   |              | encoded   |           |
   |              | UTF-8     |           |
   +--------------+-----------+-----------+

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.7.3.%20%20Generation%20Example"></a><a class="selflink" href="#section-2.7.3" name="section-2.7.3">2.7.3</a>.  Generation Example</span>

   Consider the following XMPP address:

         &lt;ji&amp;#x159;i@&amp;#x10D;echy.example/v Praze&gt;

   Note: The string "&amp;#x159;" stands for the Unicode character LATIN
   SMALL LETTER R WITH CARON, and the string "&amp;#x10D;" stands for the
   Unicode character LATIN SMALL LETTER C WITH CARON.  The "&amp;#x..." form
   is used in this document as a notational device to represent Unicode
   characters, following the "XML Notation" used in [<a href="#ref-IRI" title='"Internationalized Resource Identifiers (IRIs)"'>IRI</a>] to represent
   characters that cannot be rendered in ASCII-only documents.  An XMPP
   IRI MUST contain the Unicode characters themselves, not the
   representation in XML Notation (in particular, note that the "#"
   character is forbidden in IRI syntax).  An XMPP URI MUST properly
   escape such characters, as described below.  The '&lt;' and '&gt;'
   characters are not part of the address itself but are provided to set
   off the address for legibility.  (For those who do not understand the
   Czech language, this example could be Anglicized as
   "george@czech-lands.example/In Prague".)

   In accordance with the process specified above, the generating
   application would do the following to generate a valid XMPP IRI from
   this address:

   1.  Ensure that the XMPP address conforms to the rules specified in
       [<a href="#ref-XMPP-CORE" title='"Extensible Messaging and Presence Protocol (XMPP): Core"'>XMPP-CORE</a>], including application of the relevant stringprep
       profiles [<a href="#ref-STRINGPREP" title='"Preparation of Internationalized Strings ("'>STRINGPREP</a>] and encoding as a UTF-8 string [<a href="#ref-UTF-8" title='"UTF-8, a transformation format of ISO 10646"'>UTF-8</a>].







<span class="grey">Saint-Andre                 Standards Track                    [Page 12]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc5122.html">RFC 5122</a>                     XMPP IRIs/URIs                February 2008</span>


   2.  Concatenate the following:

       1.  The "xmpp" scheme and the ":" character.

       2.  An "authority component" if included (not shown in this
           example).

       3.  A string of Unicode characters that represents the XMPP
           address, transformed in accordance with the "inodeid",
           "ihost", and "iresid" rules.

       4.  The "?" character followed by a "query component" if
           appropriate to the application (not shown in this example).

       5.  The "#" character followed by a "fragment identifier
           component" if appropriate to the application (not shown in
           this example).

   The result is the following XMPP IRI (note again that, in accordance
   with the "XML Notation" used in [<a href="#ref-IRI" title='"Internationalized Resource Identifiers (IRIs)"'>IRI</a>], the string "&amp;#x159;" stands
   for the Unicode character LATIN SMALL LETTER R WITH CARON and the
   string "&amp;#x10D;" stands for the Unicode character LATIN SMALL LETTER
   C WITH CARON; an XMPP IRI would contain the Unicode characters
   themselves).

       &lt;xmpp:ji&amp;#x159;i@&amp;#x10D;echy.example/v%20Praze&gt;

   In order to generate a valid XMPP URI from the foregoing IRI, the
   application MUST adhere to the procedure specified in Section 3.1 of
   [<a href="#ref-IRI" title='"Internationalized Resource Identifiers (IRIs)"'>IRI</a>], resulting in the following URI:

       &lt;xmpp:ji%C5%99i@%C4%8Dechy.example/v%20Praze&gt;

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.8.%20%20Processing%20of%20XMPP%20IRIs%2FURIs"></a><a class="selflink" href="#section-2.8" name="section-2.8">2.8</a>.  Processing of XMPP IRIs/URIs</span>

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.8.1.%20%20Processing%20Method"></a><a class="selflink" href="#section-2.8.1" name="section-2.8.1">2.8.1</a>.  Processing Method</span>

   If a processing application is presented with an XMPP URI and not
   with an XMPP IRI, it MUST first convert the URI into an IRI by
   following the procedure specified in Section 3.2 of [<a href="#ref-IRI" title='"Internationalized Resource Identifiers (IRIs)"'>IRI</a>].

   In order to decompose an XMPP IRI for interaction with the entity it
   identifies, a processing application MUST separate:

   1.  The "xmpp" scheme and the ":" character.






<span class="grey">Saint-Andre                 Standards Track                    [Page 13]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc5122.html">RFC 5122</a>                     XMPP IRIs/URIs                February 2008</span>


   2.  The authority component, if included (the string of Unicode
       characters between the "//" characters and the next "/"
       character, the "?" character, the "#" character, or the end of
       the IRI).

   3.  A string of Unicode characters that represents an XMPP address as
       transformed in accordance with the "inodeid", "ihost", and
       "iresid" rules.

   4.  Optionally the query component, if included, using the "?"
       character as a separator.

   5.  Optionally the fragment identifier component, if included, using
       the "#" character as a separator.

   At this point, the processing application MUST ensure that the
   resulting XMPP address conforms to the rules specified in
   [<a href="#ref-XMPP-CORE" title='"Extensible Messaging and Presence Protocol (XMPP): Core"'>XMPP-CORE</a>], including application of the relevant stringprep
   profiles [<a href="#ref-STRINGPREP" title='"Preparation of Internationalized Strings ("'>STRINGPREP</a>].  The processing application then would either
   (1) complete further XMPP handling itself or (2) invoke a helper
   application to complete XMPP handling; such XMPP handling would most
   likely consist of the following steps:

   1.  If not already connected to an XMPP server, connect either as the
       user specified in the authority component or as the configured
       user at the configured XMPP server, normally by adhering to the
       XMPP connection procedures defined in [<a href="#ref-XMPP-CORE" title='"Extensible Messaging and Presence Protocol (XMPP): Core"'>XMPP-CORE</a>].  (Note: The
       processing application SHOULD ignore the authority component if
       it has been configured with a set of default credentials.)

   2.  Optionally, determine the nature of the intended recipient (e.g.,
       via [<a href="#ref-XEP-0030" title='"Service Discovery"'>XEP-0030</a>]).

   3.  Optionally, present an appropriate interface to a user based on
       the nature of the intended recipient and/or the contents of the
       query component.

   4.  Generate an XMPP stanza that translates any user or application
       inputs into their corresponding XMPP equivalents.

   5.  Send the XMPP stanza via the authenticated server connection for
       delivery to the intended recipient.









<span class="grey">Saint-Andre                 Standards Track                    [Page 14]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc5122.html">RFC 5122</a>                     XMPP IRIs/URIs                February 2008</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.8.2.%20%20Processing%20Notes"></a><a class="selflink" href="#section-2.8.2" name="section-2.8.2">2.8.2</a>.  Processing Notes</span>

   It may help implementors to note that the first two steps of "further
   XMPP handling", as described at the end of <a href="#section-2.8.1">Section 2.8.1</a>, are similar
   to HTTP authentication [<a href="#ref-HTTP-AUTH" title='"HTTP Authentication: Basic and Digest Access Authentication"'>HTTP-AUTH</a>], while the next three steps are
   similar to the handling of mailto: URIs [<a href="#ref-MAILTO" title='"The mailto URL scheme"'>MAILTO</a>].

   As noted in <a href="#section-2.7.2">Section 2.7.2</a> of this document, certain characters are
   allowed in the node identifier, domain identifier, and resource
   identifier portions of a native XMPP address but prohibited by the
   "inodeid", "ihost", and "iresid" rules of an XMPP IRI.  The percent-
   encoded octets corresponding to these characters in XMPP IRIs MUST be
   transformed into the characters allowed in XMPP addresses when
   processing an XMPP IRI for interaction with the represented XMPP
   entity.

   Consider the following nasty node in an XMPP IRI (split into two
   lines for layout purposes):

      xmpp:nasty!%23$%25()*+,-.;=%3F%5B%5C%5D%5E_%60%7B%7C%7D~node
      @example.com

   That IRI would be transformed into the following XMPP address:

      nasty!#$%()*+,-.;=?[\]^_`{|}~node@example.com

   Consider the following repulsive resource in an XMPP IRI (split into
   three lines for layout purposes):

      xmpp:node@example.com
      /repulsive%20!%23%22$%25&amp;'()*+,-.%2F:;%3C
      =%3E%3F%40%5B%5C%5D%5E_%60%7B%7C%7D~resource

   That IRI would be transformed into the following XMPP address (split
   into two lines for layout purposes):

      node@example.com
      /repulsive !#"$%&amp;'()*+,-./:;&lt;=&gt;?@[\]^_`{|}~resource

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.8.3.%20%20Processing%20Example"></a><a class="selflink" href="#section-2.8.3" name="section-2.8.3">2.8.3</a>.  Processing Example</span>

   Consider the XMPP URI that resulted from the previous example (see
   <a href="#section-2.7.3">Section 2.7.3</a>):

       &lt;xmpp:ji%C5%99i@%C4%8Dechy.example/v%20Praze&gt;






<span class="grey">Saint-Andre                 Standards Track                    [Page 15]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-16" id="page-16" name="page-16"> </a>
<span class="grey"><a href="rfc5122.html">RFC 5122</a>                     XMPP IRIs/URIs                February 2008</span>


   In order to generate a valid XMPP IRI from that URI, the application
   MUST adhere to the procedure specified in Section 3.2 of [<a href="#ref-IRI" title='"Internationalized Resource Identifiers (IRIs)"'>IRI</a>],
   resulting in the following IRI:

       &lt;xmpp:ji&amp;#x159;i@&amp;#x10D;echy.example/v%20Praze&gt;

   In accordance with the process specified above, the processing
   application would remove the "xmpp" scheme and ":" character to
   extract the XMPP address from this XMPP IRI, converting any percent-
   encoded octets from the "inodeid", "ihost", and "iresid" rules into
   their character equivalents (e.g., "%20" into the space character).

   The result is this XMPP address:

       &lt;ji&amp;#x159;i@&amp;#x10D;echy.example/v Praze&gt;

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.9.%20%20Internationalization"></a><a class="selflink" href="#section-2.9" name="section-2.9">2.9</a>.  Internationalization</span>

   Because XMPP addresses are UTF-8 strings [<a href="#ref-UTF-8" title='"UTF-8, a transformation format of ISO 10646"'>UTF-8</a>] and because octets
   outside the US-ASCII range [<a href="#ref-US-ASCII" title='"Coded Character Set - 7-bit American Standard Code for Information Interchange"'>US-ASCII</a>] within XMPP addresses can be
   easily converted to percent-encoded octets, XMPP addresses are
   designed to work well with Internationalized Resource Identifiers
   [<a href="#ref-IRI" title='"Internationalized Resource Identifiers (IRIs)"'>IRI</a>].  In particular, with the exceptions of stringprep
   verification, the conversion of syntax-relevant US-ASCII characters
   (e.g., "?"), and the conversion of percent-encoded octets from the
   "inodeid", "ihost", and "iresid" rules into their character
   equivalents (e.g., "%20" into the US-ASCII space character), an XMPP
   IRI can be constructed directly by prepending the "xmpp" scheme and
   ":" character to an XMPP address.  Furthermore, an XMPP IRI can be
   converted into URI syntax by adhering to the procedure specified in
   Section 3.1 of [<a href="#ref-IRI" title='"Internationalized Resource Identifiers (IRIs)"'>IRI</a>], and an XMPP URI can be converted into IRI
   syntax by adhering to the procedure specified in Section 3.2 of
   [<a href="#ref-IRI" title='"Internationalized Resource Identifiers (IRIs)"'>IRI</a>], thus ensuring interoperability with applications that are able
   to process URIs but unable to process IRIs.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20IANA%20Registration%20of%20xmpp%20URI%20Scheme"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  IANA Registration of xmpp URI Scheme</span>

   In accordance with [<a href="#ref-URI-SCHEMES" title='"Guidelines and Registration Procedures for New URI Schemes"'>URI-SCHEMES</a>], this section provides the
   information required to register the xmpp URI scheme.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.1.%20%20URI%20Scheme%20Name"></a><a class="selflink" href="#section-3.1" name="section-3.1">3.1</a>.  URI Scheme Name</span>

   xmpp

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.2.%20%20Status"></a><a class="selflink" href="#section-3.2" name="section-3.2">3.2</a>.  Status</span>

   permanent




<span class="grey">Saint-Andre                 Standards Track                    [Page 16]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-17" id="page-17" name="page-17"> </a>
<span class="grey"><a href="rfc5122.html">RFC 5122</a>                     XMPP IRIs/URIs                February 2008</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.3.%20%20URI%20Scheme%20Syntax"></a><a class="selflink" href="#section-3.3" name="section-3.3">3.3</a>.  URI Scheme Syntax</span>

   The syntax for an xmpp URI is defined below using Augmented Backus-
   Naur Form as specified by [<a href="#ref-ABNF" title='"Augmented BNF for Syntax Specifications: ABNF"'>ABNF</a>], where the "fragment", "host", "pct-
   encoded", and "unreserved" rules are defined in [<a href="#ref-URI" title='"Uniform Resource Identifier (URI): Generic Syntax"'>URI</a>]:

     xmppuri   = "xmpp" ":" hierxmpp [ "?" querycomp ] [ "#" fragment ]
     hierxmpp  = authpath / pathxmpp
     authpath  = "//" authxmpp [ "/" pathxmpp ]
     authxmpp  = nodeid "@" host
     pathxmpp  = [ nodeid "@" ] host [ "/" resid ]
     nodeid    = *( unreserved / pct-encoded / nodeallow )
     nodeallow = "!" / "$" / "(" / ")" / "*" / "+" / "," / ";" / "="
     resid     = *( unreserved / pct-encoded / resallow )
     resallow  = "!" / "$" / "&amp;" / "'" / "(" / ")" /
                  "*" / "+" / "," / ":" / ";" / "="
     querycomp = querytype [ *pair ]
     querytype = *( unreserved / pct-encoded )
     pair      = ";" key "=" value
     key       = *( unreserved / pct-encoded )
     value     = *( unreserved / pct-encoded )

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.4.%20%20URI%20Scheme%20Semantics"></a><a class="selflink" href="#section-3.4" name="section-3.4">3.4</a>.  URI Scheme Semantics</span>

   The xmpp URI scheme identifies entities that natively communicate
   using the Extensible Messaging and Presence Protocol (XMPP), and is
   mainly used for identification rather than for resource location.
   However, if an application that processes an xmpp URI enables
   interaction with the XMPP address identified by the URI, it MUST
   follow the methodology defined in <a href="#section-2">Section 2</a> of this document, Use of
   XMPP IRIs and URIs, to reconstruct the encapsulated XMPP address,
   connect to an appropriate XMPP server, and send an appropriate XMPP
   "stanza" (XML fragment) to the XMPP address.  (Note: There is no MIME
   type associated with the xmpp URI scheme.)

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.5.%20%20Encoding%20Considerations"></a><a class="selflink" href="#section-3.5" name="section-3.5">3.5</a>.  Encoding Considerations</span>

   In addition to XMPP URIs, there will also be XMPP Internationalized
   Resource Identifiers (IRIs).  Prior to converting an Extensible
   Messaging and Presence Protocol (XMPP) address into an IRI (and in
   accordance with [<a href="#ref-XMPP-CORE" title='"Extensible Messaging and Presence Protocol (XMPP): Core"'>XMPP-CORE</a>]), the XMPP address must be represented as
   a string of UTF-8 characters [<a href="#ref-UTF-8" title='"UTF-8, a transformation format of ISO 10646"'>UTF-8</a>] by the generating application
   (e.g., by transforming an application's internal representation of
   the address as a UTF-16 string into a UTF-8 string).  Because IRI
   syntax [<a href="#ref-IRI" title='"Internationalized Resource Identifiers (IRIs)"'>IRI</a>] specifies that the characters in an IRI are the original
   Unicode characters themselves [<a href="#ref-UNICODE" title='"The Unicode Standard, Version 3.2.0"'>UNICODE</a>], when generating an XMPP IRI
   the generating application MUST decode the UTF-8 characters of a
   native XMPP address to their original Unicode form.  Because URI



<span class="grey">Saint-Andre                 Standards Track                    [Page 17]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-18" id="page-18" name="page-18"> </a>
<span class="grey"><a href="rfc5122.html">RFC 5122</a>                     XMPP IRIs/URIs                February 2008</span>


   syntax [<a href="#ref-URI" title='"Uniform Resource Identifier (URI): Generic Syntax"'>URI</a>] specifices that the characters in a URI are US-ASCII
   characters [<a href="#ref-US-ASCII" title='"Coded Character Set - 7-bit American Standard Code for Information Interchange"'>US-ASCII</a>] only, when generating an XMPP URI the
   generating application MUST escape the Unicode characters of an XMPP
   IRI to US-ASCII characters by adhering to the procedure specified in
   <a href="rfc3987.html">RFC 3987</a>.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.6.%20%20Applications%2FProtocols%20That%20Use%20This%20URI%20Scheme%20Name"></a><a class="selflink" href="#section-3.6" name="section-3.6">3.6</a>.  Applications/Protocols That Use This URI Scheme Name</span>

   The xmpp URI scheme is intended to be used by interfaces to an XMPP
   network from non-native user agents, such as web browsers, as well as
   by non-native applications that need to identify XMPP entities as
   full URIs or IRIs.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.7.%20%20Interoperability%20Considerations"></a><a class="selflink" href="#section-3.7" name="section-3.7">3.7</a>.  Interoperability Considerations</span>

   There are no known interoperability concerns related to use of the
   xmpp URI scheme.  In order to help ensure interoperability, the XMPP
   Registrar function of the XMPP Standards Foundation maintains a
   registry of query types and keys that can be used in the query
   components of XMPP URIs and IRIs, located at
   &lt;<a href="http://www.xmpp.org/registrar/querytypes.html">http://www.xmpp.org/registrar/querytypes.html</a>&gt;.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.8.%20%20Security%20Considerations"></a><a class="selflink" href="#section-3.8" name="section-3.8">3.8</a>.  Security Considerations</span>

   See <a href="#section-5">Section 5</a> of this document, Security Considerations.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.9.%20%20Contact"></a><a class="selflink" href="#section-3.9" name="section-3.9">3.9</a>.  Contact</span>

   Peter Saint-Andre [mailto:stpeter@jabber.org,
   xmpp:stpeter@jabber.org]

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.10.%20%20Author%2FChange%20Controller"></a><a class="selflink" href="#section-3.10" name="section-3.10">3.10</a>.  Author/Change Controller</span>

   This scheme is registered under the IETF tree.  As such, the IETF
   maintains change control.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.11.%20%20References"></a><a class="selflink" href="#section-3.11" name="section-3.11">3.11</a>.  References</span>

   [<a id="ref-XMPP-CORE" name="ref-XMPP-CORE">XMPP-CORE</a>]

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20IANA%20Considerations"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  IANA Considerations</span>

   This document obsoletes the URI scheme registration created by <a href="rfc4622.html">RFC</a>
   <a href="rfc4622.html">4622</a>.  The registration template can be found in <a href="#section-3">Section 3</a> of this
   document.  In order to help ensure interoperability, the XMPP
   Registrar function of the XMPP Standards Foundation maintains a
   registry of query types and keys that can be used in the query




<span class="grey">Saint-Andre                 Standards Track                    [Page 18]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-19" id="page-19" name="page-19"> </a>
<span class="grey"><a href="rfc5122.html">RFC 5122</a>                     XMPP IRIs/URIs                February 2008</span>


   components of XMPP URIs and IRIs, located at
   &lt;<a href="http://www.xmpp.org/registrar/querytypes.html">http://www.xmpp.org/registrar/querytypes.html</a>&gt;.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20Security%20Considerations"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  Security Considerations</span>

   Providing an interface to XMPP services from non-native applications
   introduces new security concerns.  The security considerations
   discussed in [<a href="#ref-IRI" title='"Internationalized Resource Identifiers (IRIs)"'>IRI</a>], [<a href="#ref-URI" title='"Uniform Resource Identifier (URI): Generic Syntax"'>URI</a>], and [<a href="#ref-XMPP-CORE" title='"Extensible Messaging and Presence Protocol (XMPP): Core"'>XMPP-CORE</a>] apply to XMPP IRIs, and
   the security considerations discussed in [<a href="#ref-URI" title='"Uniform Resource Identifier (URI): Generic Syntax"'>URI</a>] and [<a href="#ref-XMPP-CORE" title='"Extensible Messaging and Presence Protocol (XMPP): Core"'>XMPP-CORE</a>] apply
   to XMPP URIs.  In accordance with Section 2.7 of [<a href="#ref-URI-SCHEMES" title='"Guidelines and Registration Procedures for New URI Schemes"'>URI-SCHEMES</a>] and
   Section 7 of [<a href="#ref-URI" title='"Uniform Resource Identifier (URI): Generic Syntax"'>URI</a>], particular security considerations are specified
   in the following sections.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.1.%20%20Reliability%20and%20Consistency"></a><a class="selflink" href="#section-5.1" name="section-5.1">5.1</a>.  Reliability and Consistency</span>

   Given that XMPP addresses of the form node@domain.tld are typically
   created via registration at an XMPP server or provisioned by an
   administrator of such a server, it is possible that such addresses
   may also be unregistered or deprovisioned.  Therefore, the XMPP IRI/
   URI that identifies such an XMPP address may not reliably and
   consistently be associated with the same principal, account owner,
   application, or device.

   XMPP addresses of the form node@domain.tld/resource are typically
   even more ephemeral (since a given XMPP resource identifier is
   typically associated with a particular, temporary session of an XMPP
   client at an XMPP server).  Therefore, the XMPP IRI/URI that
   identifies such an XMPP address probably will not reliably and
   consistently be associated with the same session.  However, the
   procedures specified in Section 10 of [<a href="#ref-XMPP-CORE" title='"Extensible Messaging and Presence Protocol (XMPP): Core"'>XMPP-CORE</a>] effectively
   eliminate any potential confusion that might be introduced by the
   lack of reliability and consistency for the XMPP IRI/URI that
   identifies such an XMPP address.

   XMPP addresses of the form domain.tld are typically long-lived XMPP
   servers or associated services.  Although naturally it is possible
   for server or service administrators to decommission the server or
   service at any time, typically the IRIs/URIs that identify such
   servers or services are the most reliable and consistent of XMPP
   IRIs/URIs.

   XMPP addresses of the form domain.tld/resource are not yet common on
   XMPP networks; however, the reliability and consistency of XMPP IRIs/
   URIs that identify such XMPP addresses would likely fall somewhere
   between those that identify XMPP addresses of the form domain.tld and
   those that identify XMPP addresses of the form node@domain.tld.





<span class="grey">Saint-Andre                 Standards Track                    [Page 19]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-20" id="page-20" name="page-20"> </a>
<span class="grey"><a href="rfc5122.html">RFC 5122</a>                     XMPP IRIs/URIs                February 2008</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.2.%20%20Malicious%20Construction"></a><a class="selflink" href="#section-5.2" name="section-5.2">5.2</a>.  Malicious Construction</span>

   Malicious construction of XMPP IRIs/URIs is made less likely by the
   prohibition on port numbers in XMPP IRIs/URIs (since port numbers are
   to be discovered using DNS SRV records [<a href="#ref-DNS-SRV" title='"A DNS RR for specifying the location of services (DNS SRV)"'>DNS-SRV</a>], as specified in
   [<a href="#ref-XMPP-CORE" title='"Extensible Messaging and Presence Protocol (XMPP): Core"'>XMPP-CORE</a>]).

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.3.%20%20Back-End%20Transcoding"></a><a class="selflink" href="#section-5.3" name="section-5.3">5.3</a>.  Back-End Transcoding</span>

   Because the base XMPP protocol is designed to implement the exchange
   of messages and presence information and not the retrieval of files
   or invocation of similar system functions, it is deemed unlikely that
   the use of XMPP IRIs/URIs would result in harmful dereferencing.
   However, if an XMPP protocol extension defines methods for
   information retrieval, it MUST define appropriate controls over
   access to that information.  In addition, XMPP servers SHOULD NOT
   natively parse XMPP IRIs/URIs but instead SHOULD accept only the XML
   wire protocol specified in [<a href="#ref-XMPP-CORE" title='"Extensible Messaging and Presence Protocol (XMPP): Core"'>XMPP-CORE</a>] and any desired extensions
   thereto.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.4.%20%20Sensitive%20Information"></a><a class="selflink" href="#section-5.4" name="section-5.4">5.4</a>.  Sensitive Information</span>

   The ability to interact with XMPP entities via a web browser or other
   non-native application may expose sensitive information (such as
   support for particular XMPP application protocol extensions) and
   thereby make it possible to launch attacks that are not possible or
   that are unlikely on a native XMPP network.  Due care must be taken
   in deciding what information is appropriate for representation in
   XMPP IRIs or URIs.

   In particular, advertising XMPP IRIs/URIs in publicly accessible
   locations (e.g., on websites) may make it easier for malicious users
   to harvest XMPP addresses from the authority and path components of
   XMPP IRIs/URIs and therefore to send unsolicited bulk communications
   to the users or applications represented by those addresses.  Due
   care should be taken in balancing the benefits of open information
   exchange against the potential costs of unwanted communications.

   To help prevent leaking of sensitive information, passwords and other
   user credentials are forbidden in the authority component of XMPP
   IRIs/URIs; in fact they are not needed, since the fact that
   authentication in XMPP occurs via the Simple Authentication and
   Security Layer [<a href="#ref-SASL" title='"Simple Authentication and Security Layer (SASL)"'>SASL</a>] makes it possible to use the SASL ANONYMOUS
   mechanism, if desired.







<span class="grey">Saint-Andre                 Standards Track                    [Page 20]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-21" id="page-21" name="page-21"> </a>
<span class="grey"><a href="rfc5122.html">RFC 5122</a>                     XMPP IRIs/URIs                February 2008</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.5.%20%20Semantic%20Attacks"></a><a class="selflink" href="#section-5.5" name="section-5.5">5.5</a>.  Semantic Attacks</span>

   Despite the existence of non-hierarchical URI schemes such as
   [<a href="#ref-MAILTO" title='"The mailto URL scheme"'>MAILTO</a>], by association human users may expect all URIs to include
   the "//" characters after the scheme name and ":" character.
   However, in XMPP IRIs/URIs, the "//" characters precede the authority
   component rather than the path component.  Thus,
   xmpp://guest@example.com indicates to authenticate as
   "guest@example.com", whereas xmpp:guest@example.com identifies the
   node "guest@example.com".  Processing applications MUST clearly
   differentiate between these forms, and user agents SHOULD discourage
   human users from including the "//" characters in XMPP IRIs/URIs
   since use of the authority component is envisioned to be helpful only
   in specialized scenarios, not more generally.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.6.%20%20Spoofing"></a><a class="selflink" href="#section-5.6" name="section-5.6">5.6</a>.  Spoofing</span>

   The ability to include effectively the full range of Unicode
   characters in an XMPP IRI may make it easier to execute certain forms
   of address mimicking (also called "spoofing").  However, XMPP IRIs
   are no different from other IRIs in this regard, and applications
   that will present XMPP IRIs to human users must adhere to best
   practices regarding address mimicking in order to help prevent
   attacks that result from spoofed addresses (e.g., the phenomenon
   known as "phishing").  For details, refer to the Security
   Considerations of [<a href="#ref-IRI" title='"Internationalized Resource Identifiers (IRIs)"'>IRI</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20Acknowledgements"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  Acknowledgements</span>

   Thanks to Martin Duerst, Lisa Dusseault, Frank Ellerman, Roy
   Fielding, Joe Hildebrand, and Ralph Meijer for their comments.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20References"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.1.%20%20Normative%20References"></a><a class="selflink" href="#section-7.1" name="section-7.1">7.1</a>.  Normative References</span>

   [<a id="ref-ABNF" name="ref-ABNF">ABNF</a>]         Crocker, D. and P. Overell, "Augmented BNF for Syntax
                  Specifications: ABNF", STD 68, <a href="rfc5234.html">RFC 5234</a>, January 2007.

   [<a id="ref-IRI" name="ref-IRI">IRI</a>]          Duerst, M. and M. Suignard, "Internationalized
                  Resource Identifiers (IRIs)", <a href="rfc3987.html">RFC 3987</a>, January 2005.

   [<a id="ref-TERMS" name="ref-TERMS">TERMS</a>]        Bradner, S., "Key words for use in RFCs to Indicate
                  Requirement Levels", <a href="http://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.

   [<a id="ref-URI" name="ref-URI">URI</a>]          Berners-Lee, T., Fielding, R., and L. Masinter,
                  "Uniform Resource Identifier (URI): Generic Syntax",
                  STD 66, <a href="rfc3986.html">RFC 3986</a>, January 2005.



<span class="grey">Saint-Andre                 Standards Track                    [Page 21]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-22" id="page-22" name="page-22"> </a>
<span class="grey"><a href="rfc5122.html">RFC 5122</a>                     XMPP IRIs/URIs                February 2008</span>


   [<a id="ref-XMPP-CORE" name="ref-XMPP-CORE">XMPP-CORE</a>]    Saint-Andre, P., "Extensible Messaging and Presence
                  Protocol (XMPP): Core", <a href="rfc3920.html">RFC 3920</a>, October 2004.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.2.%20%20Informative%20References"></a><a class="selflink" href="#section-7.2" name="section-7.2">7.2</a>.  Informative References</span>

   [<a id="ref-CPIM" name="ref-CPIM">CPIM</a>]         Peterson, J., "Common Profile for Instant Messaging
                  (CPIM)", <a href="rfc3860.html">RFC 3860</a>, August 2004.

   [<a id="ref-CPP" name="ref-CPP">CPP</a>]          Peterson, J., "Common Profile for Presence (CPP)",
                  <a href="rfc3859.html">RFC 3859</a>, August 2004.

   [<a id="ref-DNS-SRV" name="ref-DNS-SRV">DNS-SRV</a>]      Gulbrandsen, A., Vixie, P., and L. Esibov, "A DNS RR
                  for specifying the location of services (DNS SRV)",
                  <a href="rfc2782.html">RFC 2782</a>, February 2000.

   [<a id="ref-HTML" name="ref-HTML">HTML</a>]         Raggett, D., "HTML 4.0 Specification", W3C REC REC-
                  html40-19980424, April 1998.

   [<a id="ref-HTTP-AUTH" name="ref-HTTP-AUTH">HTTP-AUTH</a>]    Franks, J., Hallam-Baker, P., Hostetler, J., Lawrence,
                  S., Leach, P., Luotonen, A., and L. Stewart, "HTTP
                  Authentication: Basic and Digest Access
                  Authentication", <a href="rfc2617.html">RFC 2617</a>, June 1999.

   [<a id="ref-IDNA" name="ref-IDNA">IDNA</a>]         Faltstrom, P., Hoffman, P., and A. Costello,
                  "Internationalizing Domain Names in Applications
                  (IDNA)", <a href="rfc3490.html">RFC 3490</a>, March 2003.

   [<a id="ref-MAILTO" name="ref-MAILTO">MAILTO</a>]       Hoffman, P., Masinter, L., and J. Zawinski, "The
                  mailto URL scheme", <a href="rfc2368.html">RFC 2368</a>, July 1998.

   [<a id="ref-MIME" name="ref-MIME">MIME</a>]         Freed, N. and N. Borenstein, "Multipurpose Internet
                  Mail Extensions (MIME) Part Two: Media Types",
                  <a href="rfc2046.html">RFC 2046</a>, November 1996.

   [<a id="ref-SASL" name="ref-SASL">SASL</a>]         Melnikov, A. and K. Zeilenga, "Simple Authentication
                  and Security Layer (SASL)", <a href="rfc4422.html">RFC 4422</a>, June 2006.

   [<a id="ref-STRINGPREP" name="ref-STRINGPREP">STRINGPREP</a>]   Hoffman, P. and M. Blanchet, "Preparation of
                  Internationalized Strings ("STRINGPREP")", <a href="rfc3454.html">RFC 3454</a>,
                  December 2002.











<span class="grey">Saint-Andre                 Standards Track                    [Page 22]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-23" id="page-23" name="page-23"> </a>
<span class="grey"><a href="rfc5122.html">RFC 5122</a>                     XMPP IRIs/URIs                February 2008</span>


   [<a id="ref-UNICODE" name="ref-UNICODE">UNICODE</a>]      The Unicode Consortium, "The Unicode Standard, Version
                  3.2.0", 2000.

                  The Unicode Standard, Version 3.2.0 is defined by The
                  Unicode Standard, Version 3.0 (Reading, MA, Addison-
                  Wesley, 2000.  ISBN 0-201-61633-5), as amended by the
                  Unicode Standard Annex #27: Unicode 3.1
                  (<a href="http://www.unicode.org/reports/tr27/">http://www.unicode.org/reports/tr27/</a>) and by the
                  Unicode Standard Annex #28: Unicode 3.2
                  (<a href="http://www.unicode.org/reports/tr28/">http://www.unicode.org/reports/tr28/</a>).

   [<a id="ref-URI-SCHEMES" name="ref-URI-SCHEMES">URI-SCHEMES</a>]  Hansen, T., Hardie, T., and L. Masinter, "Guidelines
                  and Registration Procedures for New URI Schemes",
                  <a href="rfc4395.html">RFC 4395</a>, February 2006.

   [<a id="ref-US-ASCII" name="ref-US-ASCII">US-ASCII</a>]     American National Standards Institute, "Coded
                  Character Set - 7-bit American Standard Code for
                  Information Interchange", ANSI X3.4, 1986.

   [<a id="ref-UTF-8" name="ref-UTF-8">UTF-8</a>]        Yergeau, F., "UTF-8, a transformation format of ISO
                  10646", STD 63, <a href="rfc3629.html">RFC 3629</a>, November 2003.

   [<a id="ref-XEP-0009" name="ref-XEP-0009">XEP-0009</a>]     Adams, D., "Jabber-RPC", XSF XEP 0009, February 2006.

   [<a id="ref-XEP-0030" name="ref-XEP-0030">XEP-0030</a>]     Hildebrand, J., Millard, P., Eatmon, R., and P. Saint-
                  Andre, "Service Discovery", XSF XEP 0030,
                  February 2007.

   [<a id="ref-XEP-0045" name="ref-XEP-0045">XEP-0045</a>]     Saint-Andre, P., "Multi-User Chat", XSF XEP 0045,
                  April 2007.

   [<a id="ref-XEP-0053" name="ref-XEP-0053">XEP-0053</a>]     Saint-Andre, P., "XMPP Registrar Function", XSF
                  XEP 0053, December 2006.

   [<a id="ref-XEP-0060" name="ref-XEP-0060">XEP-0060</a>]     Millard, P., Saint-Andre, P., and R. Meijer, "Publish-
                  Subscribe", XSF XEP 0060, September 2006.

   [<a id="ref-XEP-0072" name="ref-XEP-0072">XEP-0072</a>]     Forno, F. and P. Saint-Andre, "SOAP Over XMPP", XSF
                  XEP 0072, December 2005.

   [<a id="ref-XEP-0077" name="ref-XEP-0077">XEP-0077</a>]     Saint-Andre, P., "In-Band Registration", XSF XEP 0077,
                  January 2006.

   [<a id="ref-XEP-0147" name="ref-XEP-0147">XEP-0147</a>]     Saint-Andre, P., "XMPP URI Scheme Query Components",
                  XSF XEP 0147, September 2006.






<span class="grey">Saint-Andre                 Standards Track                    [Page 23]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-24" id="page-24" name="page-24"> </a>
<span class="grey"><a href="rfc5122.html">RFC 5122</a>                     XMPP IRIs/URIs                February 2008</span>


   [<a id="ref-XMPP-IM" name="ref-XMPP-IM">XMPP-IM</a>]      Saint-Andre, P., "Extensible Messaging and Presence
                  Protocol (XMPP): Instant Messaging and Presence",
                  <a href="rfc3921.html">RFC 3921</a>, October 2004.
















































<span class="grey">Saint-Andre                 Standards Track                    [Page 24]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-25" id="page-25" name="page-25"> </a>
<span class="grey"><a href="rfc5122.html">RFC 5122</a>                     XMPP IRIs/URIs                February 2008</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/Appendix%20A.%20%20Differences%20from%20RFC%204622"></a><a class="selflink" href="#appendix-A" name="appendix-A">Appendix A</a>.  Differences from <a href="rfc4622.html">RFC 4622</a></span>

   Several errors were found in <a href="rfc4622.html">RFC 4622</a>.  This document corrects those
   errors.  The resulting differences from <a href="rfc4622.html">RFC 4622</a> are as follows:

   o  Specified that the characters "[", "\", "]", "^", "`", "{", "|",
      and "}" are allowed in XMPP node identifiers but not allowed in
      IRIs or URIs according to the sub-delims rule.

   o  Specified that the characters '"', "&lt;", "&gt;", "[", "\", "]", "^",
      "`", "{", "|", and "}" are allowed in XMPP resource identifiers
      but not allowed in IRIs or URIs according to the pchar rule.

   o  Specified that the foregoing characters must be percent-encoded
      when constructing an XMPP URI.

   o  Corrected the ABNF accordingly.

   o  Updated the examples accordingly.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/Appendix%20B.%20%20Copying%20Conditions"></a><a class="selflink" href="#appendix-B" name="appendix-B">Appendix B</a>.  Copying Conditions</span>

   Regarding this entire document or any portion of it, the author makes
   no guarantees and is not responsible for any damage resulting from
   its use.  The author grants irrevocable permission to anyone to use,
   modify, and distribute it in any way that does not diminish the
   rights of anyone else to use, modify, and distribute it, provided
   that redistributed derivative works do not contain misleading author
   or version information.  Derivative works need not be licensed under
   similar terms.

Author's Address

   Peter Saint-Andre
   XMPP Standards Foundation

   EMail: stpeter@jabber.org
   URI:   xmpp:stpeter@jabber.org













<span class="grey">Saint-Andre                 Standards Track                    [Page 25]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-26" id="page-26" name="page-26"> </a>
<span class="grey"><a href="rfc5122.html">RFC 5122</a>                     XMPP IRIs/URIs                February 2008</span>


Full Copyright Statement

   Copyright (C) The IETF Trust (2008).

   This document is subject to the rights, licenses and restrictions
   contained in <a href="http://tools.ietf.org/html/bcp78">BCP 78</a>, and except as set forth therein, the authors
   retain all their rights.

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST AND
   THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS
   OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF
   THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

Intellectual Property

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in <a href="http://tools.ietf.org/html/bcp78">BCP 78</a> and <a href="http://tools.ietf.org/html/bcp79">BCP 79</a>.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   <a href="http://www.ietf.org/ipr">http://www.ietf.org/ipr</a>.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at
   ietf-ipr@ietf.org.












Saint-Andre                 Standards Track                    [Page 26]

</pre><br/>
<span class="noprint"><small><small>Html markup produced by rfcmarkup 1.107, available from
<a href="http://tools.ietf.org/tools/rfcmarkup/">http://tools.ietf.org/tools/rfcmarkup/</a>
</small></small></span>



</body><!-- Mirrored from tools.ietf.org/html/rfc5122 by HTTrack Website Copier/3.x [XR&CO'2013], Sat, 07 Jun 2014 20:18:44 GMT --></html>