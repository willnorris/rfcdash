<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><head profile="http://dublincore.org/documents/2008/08/04/dc-html/">
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.107" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="rfc3278" name="DC.Relation.Replaces"/>
<meta content="urn:ietf:rfc:5753" name="DC.Identifier"/>
<meta content="January, 2010" name="DC.Date.Issued"/>
<meta content="&lt;UNKNOWN&gt;, Sean Turner" name="DC.Creator"/>
<meta content="Brown, Daniel R. L." name="DC.Creator"/>
<meta content="This document describes how to use Elliptic Curve Cryptography (ECC)\npublic key algorithms in the Cryptographic Message Syntax (CMS). The\nECC algorithms support the creation of digital signatures and the\nexchange of keys to encrypt or authenticate content. The definition of\nthe algorithm processing is based on the NIST FIPS 186-3 for digital\nsignature, NIST SP800-56A and SEC1 for key agreement, RFC 3370 and RFC\n3565 for key wrap and content encryption, NIST FIPS 180-3 for message\ndigest, SEC1 for key derivation, and RFC 2104 and RFC 4231 for message\nauthentication code standards. This document obsoletes RFC 3278. This\ndocument is not an Internet Standards Track specification; it is\npublished for informational purposes." name="DC.Description.Abstract"/>
<meta content="Use of Elliptic Curve Cryptography (ECC) Algorithms in Cryptographic Message Syntax (CMS)" name="DC.Title"/>

    <link href="http://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="http://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 5753 - Use of Elliptic Curve Cryptography (ECC) Algorithms in Cryptographic Message Syntax (CMS)</title>
    
    
    <style type="text/css">
	body {
	    margin: 0px 8px;
            font-size: 1em;
	}
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgorange" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="http://tools.ietf.org/rfc/rfc5753.txt" title="Plaintext version of this document">txt</a>|<a href="http://tools.ietf.org/pdf/rfc5753" title="PDF version of this document">pdf</a>] [<a href="http://tools.ietf.org/html/draft-ietf-smime-3278bis" title="draft-ietf-smime-3278bis">draft-ietf-smime-...</a>] [<a href="http://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc5753" title="Inline diff (wdiff)">Diff1</a>] [<a href="http://tools.ietf.org/rfcdiff?url2=rfc5753" title="Side-by-side diff">Diff2</a>] [<a href="https://datatracker.ietf.org/ipr/search/?option=rfc_search&amp;rfc_search=5753" title="IPR disclosures related to this document">IPR</a>]           </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                           INFORMATIONAL</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<pre>Internet Engineering Task Force (IETF)                         S. Turner
Request for Comments: 5753                                          IECA
Obsoletes: <a href="rfc3278.html">3278</a>                                                 D. Brown
Category: Informational                                         Certicom
ISSN: 2070-1721                                             January 2010


          <span class="h1">Use of Elliptic Curve Cryptography (ECC) Algorithms</span>
                 <span class="h1">in Cryptographic Message Syntax (CMS)</span>

Abstract

   This document describes how to use Elliptic Curve Cryptography (ECC)
   public key algorithms in the Cryptographic Message Syntax (CMS).  The
   ECC algorithms support the creation of digital signatures and the
   exchange of keys to encrypt or authenticate content.  The definition
   of the algorithm processing is based on the NIST FIPS 186-3 for
   digital signature, NIST SP800-56A and SEC1 for key agreement, <a href="rfc3370.html">RFC</a>
   <a href="rfc3370.html">3370</a> and <a href="rfc3565.html">RFC 3565</a> for key wrap and content encryption, NIST FIPS
   180-3 for message digest, SEC1 for key derivation, and <a href="rfc2104.html">RFC 2104</a> and
   <a href="rfc4231.html">RFC 4231</a> for message authentication code standards.  This document
   obsoletes <a href="rfc3278.html">RFC 3278</a>.

Status of This Memo

   This document is not an Internet Standards Track specification; it is
   published for informational purposes.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Not all documents
   approved by the IESG are a candidate for any level of Internet
   Standard; see <a href="rfc5741.html#section-2">SectionÂ 2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc5753">http://www.rfc-editor.org/info/rfc5753</a>.

Copyright Notice

   Copyright (c) 2010 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="http://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents



<span class="grey">Turner &amp; Brown                Informational                     [Page 1]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc5753.html">RFC 5753</a>              Use of ECC Algorithms in CMS          January 2010</span>


   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in <a href="#section-4">Section 4</a>.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

   This document may contain material from IETF Documents or IETF
   Contributions published or made publicly available before November
   10, 2008.  The person(s) controlling the copyright in some of this
   material may not have granted the IETF Trust the right to allow
   modifications of such material outside the IETF Standards Process.
   Without obtaining an adequate license from the person(s) controlling
   the copyright in such materials, this document may not be modified
   outside the IETF Standards Process, and derivative works of it may
   not be created outside the IETF Standards Process, except to format
   it for publication as an RFC or to translate it into languages other
   than English.

Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-3">3</a>
      <a href="#section-1.1">1.1</a>. Requirements Terminology ...................................<a href="#page-3">3</a>
   <a href="#section-2">2</a>. SignedData Using ECC ............................................<a href="#page-3">3</a>
      <a href="#section-2.1">2.1</a>. SignedData Using ECDSA .....................................<a href="#page-4">4</a>
   <a href="#section-3">3</a>. EnvelopedData Using ECC Algorithms ..............................<a href="#page-5">5</a>
      <a href="#section-3.1">3.1</a>. EnvelopedData Using (ephemeral-static) ECDH ................<a href="#page-5">5</a>
      <a href="#section-3.2">3.2</a>. EnvelopedData Using 1-Pass ECMQV ...........................<a href="#page-8">8</a>
   <a href="#section-4">4</a>. AuthenticatedData and AuthEnvelopedData Using ECC ..............<a href="#page-11">11</a>
      <a href="#section-4.1">4.1</a>. AuthenticatedData Using 1-Pass ECMQV ......................<a href="#page-11">11</a>
      <a href="#section-4.2">4.2</a>. AuthEnvelopedData Using 1-Pass ECMQV ......................<a href="#page-12">12</a>
   <a href="#section-5">5</a>. Certificates Using ECC .........................................<a href="#page-13">13</a>
   <a href="#section-6">6</a>. SMIMECapabilities Attribute and ECC ............................<a href="#page-13">13</a>
   <a href="#section-7">7</a>. ASN.1 Syntax ...................................................<a href="#page-21">21</a>
      <a href="#section-7.1">7.1</a>. Algorithm Identifiers .....................................<a href="#page-21">21</a>
      <a href="#section-7.2">7.2</a>. Other Syntax ..............................................<a href="#page-24">24</a>
   <a href="#section-8">8</a>. Recommended Algorithms and Elliptic Curves .....................<a href="#page-26">26</a>
   <a href="#section-9">9</a>. Security Considerations ........................................<a href="#page-28">28</a>
   <a href="#section-10">10</a>. IANA Considerations ...........................................<a href="#page-33">33</a>
   <a href="#section-11">11</a>. References ....................................................<a href="#page-33">33</a>
      <a href="#section-11.1">11.1</a>. Normative References .....................................<a href="#page-33">33</a>
      <a href="#section-11.2">11.2</a>. Informative References ...................................<a href="#page-35">35</a>
   <a href="#appendix-A">Appendix A</a>.  ASN.1 Modules.........................................<a href="#page-37">37</a>
      <a href="#appendix-A.1">A.1</a>.  1988 ASN.1 Module.........................................<a href="#page-37">37</a>
      <a href="#appendix-A.2">A.2</a>.  2004 ASN.1 Module.........................................<a href="#page-45">45</a>
   <a href="#appendix-B">Appendix B</a>. Changes since <a href="rfc3278.html">RFC 3278</a>.................................<a href="#page-59">59</a>
   Acknowledgements...................................................<a href="#page-61">61</a>





<span class="grey">Turner &amp; Brown                Informational                     [Page 2]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc5753.html">RFC 5753</a>              Use of ECC Algorithms in CMS          January 2010</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   The Cryptographic Message Syntax (CMS) is cryptographic algorithm
   independent.  This specification defines a profile for the use of
   Elliptic Curve Cryptography (ECC) public key algorithms in the CMS.
   The ECC algorithms are incorporated into the following CMS content
   types:

   -  'SignedData' to support ECC-based digital signature methods
      (ECDSA) to sign content;

   -  'EnvelopedData' to support ECC-based public key agreement methods
      (ECDH and ECMQV) to generate pairwise key-encryption keys to
      encrypt content-encryption keys used for content encryption;

   -  'AuthenticatedData' to support ECC-based public key agreement
      methods (ECMQV) to generate pairwise key-encryption keys to
      encrypt message-authentication keys used for content
      authentication and integrity; and

   -  'AuthEnvelopedData' to support ECC-based public key agreement
      methods (ECMQV) to generate pairwise key-encryption keys to
      encrypt message-authentication and content-encryption keys used
      for content authentication, integrity, and encryption.

   Certification of EC public keys is also described to provide public
   key distribution in support of the specified techniques.

   The document will obsolete [<a href="#ref-CMS-ECC" title='"Use of Elliptic Curve Cryptography (ECC) Algorithms in Cryptographic Message Syntax (CMS)"'>CMS-ECC</a>].  The technical changes
   performed since <a href="rfc3278.html">RFC 3278</a> are detailed in <a href="#appendix-B">Appendix B</a>.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.1.%20%20Requirements%20Terminology"></a><a class="selflink" href="#section-1.1" name="section-1.1">1.1</a>.  Requirements Terminology</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [<a href="#ref-MUST" title='"Key words for use in RFCs to Indicate Requirement Levels"'>MUST</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20SignedData%20Using%20ECC"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  SignedData Using ECC</span>

   This section describes how to use ECC algorithms with the CMS
   SignedData format to sign data.










<span class="grey">Turner &amp; Brown                Informational                     [Page 3]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc5753.html">RFC 5753</a>              Use of ECC Algorithms in CMS          January 2010</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.1.%20%20SignedData%20Using%20ECDSA"></a><a class="selflink" href="#section-2.1" name="section-2.1">2.1</a>.  SignedData Using ECDSA</span>

   This section describes how to use the Elliptic Curve Digital
   Signature Algorithm (ECDSA) with SignedData.  ECDSA is specified in
   [<a href="#ref-FIPS186-3" title=" FIPS Publication 186-3: Digital Signature Standard">FIPS186-3</a>].  The method is the elliptic curve analog of the Digital
   Signature Algorithm (DSA) [<a href="#ref-FIPS186-3" title=" FIPS Publication 186-3: Digital Signature Standard">FIPS186-3</a>].  ECDSA is used with the Secure
   Hash Algorithm (SHA) [<a href="#ref-FIPS180-3" title=" FIPS Publication 180-3: Secure Hash Standard">FIPS180-3</a>].

   In an implementation that uses ECDSA with CMS SignedData, the
   following techniques and formats MUST be used.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.1.1.%20%20Fields%20of%20the%20SignedData"></a><a class="selflink" href="#section-2.1.1" name="section-2.1.1">2.1.1</a>.  Fields of the SignedData</span>

   When using ECDSA with SignedData, the fields of SignerInfo are as in
   [<a href="#ref-CMS" title='"Cryptographic Message Syntax (CMS)"'>CMS</a>], but with the following restrictions:

   -  digestAlgorithm MUST contain the algorithm identifier of the hash
      algorithm (see <a href="#section-7.1.1">Section 7.1.1</a>), which MUST be one of the following:
      id-sha1, id-sha224, id-sha256, id-sha384, or id-sha512.

   -  signatureAlgorithm contains the signature algorithm identifier
      (see <a href="#section-7.1.3">Section 7.1.3</a>): ecdsa-with-SHA1, ecdsa-with-SHA224, ecdsa-
      with-SHA256, ecdsa-with-SHA384, or ecdsa-with-SHA512.  The hash
      algorithm identified in the name of the signature algorithm MUST
      be the same as the digestAlgorithm (e.g., digestAlgorithm is id-
      sha256 therefore signatureAlgorithm is ecdsa-with-SHA256).

   -  signature MUST contain the DER encoding (as an octet string) of a
      value of the ASN.1 type ECDSA-Sig-Value (see <a href="#section-7.2">Section 7.2</a>).

   When using ECDSA, the SignedData certificates field MAY include the
   certificate(s) for the EC public key(s) used in the generation of the
   ECDSA signatures in SignedData.  ECC certificates are discussed in
   <a href="#section-5">Section 5</a>.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.1.2.%20%20Actions%20of%20the%20Sending%20Agent"></a><a class="selflink" href="#section-2.1.2" name="section-2.1.2">2.1.2</a>.  Actions of the Sending Agent</span>

   When using ECDSA with SignedData, the sending agent uses the message
   digest calculation process and signature generation process for
   SignedData that are specified in [<a href="#ref-CMS" title='"Cryptographic Message Syntax (CMS)"'>CMS</a>].  To sign data, the sending
   agent uses the signature method specified in [<a href="#ref-FIPS186-3" title=" FIPS Publication 186-3: Digital Signature Standard">FIPS186-3</a>].

   The sending agent encodes the resulting signature using the ECDSA-
   Sig-Value syntax (see <a href="#section-7.2">Section 7.2</a>) and places it in the SignerInfo
   signature field.






<span class="grey">Turner &amp; Brown                Informational                     [Page 4]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc5753.html">RFC 5753</a>              Use of ECC Algorithms in CMS          January 2010</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.1.3.%20%20Actions%20of%20the%20Receiving%20Agent"></a><a class="selflink" href="#section-2.1.3" name="section-2.1.3">2.1.3</a>.  Actions of the Receiving Agent</span>

   When using ECDSA with SignedData, the receiving agent uses the
   message digest calculation process and signature verification process
   for SignedData that are specified in [<a href="#ref-CMS" title='"Cryptographic Message Syntax (CMS)"'>CMS</a>].  To verify SignedData,
   the receiving agent uses the signature verification method specified
   in [<a href="#ref-FIPS186-3" title=" FIPS Publication 186-3: Digital Signature Standard">FIPS186-3</a>].

   In order to verify the signature, the receiving agent retrieves the
   integers r and s from the SignerInfo signature field of the received
   message.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20EnvelopedData%20Using%20ECC%20Algorithms"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  EnvelopedData Using ECC Algorithms</span>

   This section describes how to use ECC algorithms with the CMS
   EnvelopedData format.

   This document does not specify the static-static ECDH, method C(0,2,
   ECC CDH) from [<a href="#ref-SP800-56A" title=" Special Publication 800-56A: Recommendation Pair-Wise Key Establishment Schemes Using Discrete Logarithm Cryptography (Revised)">SP800-56A</a>].  Static-static ECDH is analogous to
   static-static DH, which is specified in [<a href="#ref-CMS-ALG" title='"Cryptographic Message Syntax (CMS) Algorithms"'>CMS-ALG</a>].  Ephemeral-static
   ECDH and 1-Pass ECMQV were specified because they provide better
   security due to the originator's ephemeral contribution to the key
   agreement scheme.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.1.%20%20EnvelopedData%20Using%20%28ephemeral-static%29%20ECDH"></a><a class="selflink" href="#section-3.1" name="section-3.1">3.1</a>.  EnvelopedData Using (ephemeral-static) ECDH</span>

   This section describes how to use the ephemeral-static Elliptic Curve
   Diffie-Hellman (ECDH) key agreement algorithm with EnvelopedData.
   This algorithm has two variations:

   - 'Standard' ECDH, described as the 'Elliptic Curve Diffie-Hellman
     Scheme' with the 'Elliptic Curve Diffie-Hellman Primitive' in
     [<a href="#ref-SEC1" title='"SEC 1: Elliptic Curve Cryptography"'>SEC1</a>], and

   - 'Co-factor' ECDH, described as the 'One-Pass Diffie-Hellman scheme'
     (method C(1, 1, ECC CDH)) in [<a href="#ref-SP800-56A" title=" Special Publication 800-56A: Recommendation Pair-Wise Key Establishment Schemes Using Discrete Logarithm Cryptography (Revised)">SP800-56A</a>].

   Both variations of ephemeral-static ECDH are elliptic curve analogs
   of the ephemeral-static Diffie-Hellman key agreement algorithm
   specified jointly in the documents [<a href="#ref-CMS-ALG" title='"Cryptographic Message Syntax (CMS) Algorithms"'>CMS-ALG</a>] and [<a href="#ref-CMS-DH" title='"Diffie-Hellman Key Agreement Method"'>CMS-DH</a>].

   If an implementation uses ECDH with CMS EnvelopedData, then the
   following techniques and formats MUST be used.

   The fields of EnvelopedData are as in [<a href="#ref-CMS" title='"Cryptographic Message Syntax (CMS)"'>CMS</a>]; as ECDH is a key
   agreement algorithm, the RecipientInfo kari choice is used.





<span class="grey">Turner &amp; Brown                Informational                     [Page 5]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc5753.html">RFC 5753</a>              Use of ECC Algorithms in CMS          January 2010</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.1.1.%20%20Fields%20of%20KeyAgreeRecipientInfo"></a><a class="selflink" href="#section-3.1.1" name="section-3.1.1">3.1.1</a>.  Fields of KeyAgreeRecipientInfo</span>

   When using ephemeral-static ECDH with EnvelopedData, the fields of
   KeyAgreeRecipientInfo are as follows:

   -  version MUST be 3.

   -  originator MUST be the alternative originatorKey.  The
      originatorKey algorithm field MUST contain the id-ecPublicKey
      object identifier (see <a href="#section-7.1.2">Section 7.1.2</a>).  The parameters associated
      with id-ecPublicKey MUST be absent, ECParameters, or NULL.  The
      parameters associated with id-ecPublicKey SHOULD be absent or
      ECParameters, and NULL is allowed to support legacy
      implementations.  The previous version of this document required
      NULL to be present.  If the parameters are ECParameters, then they
      MUST be namedCurve.  The originatorKey publicKey field MUST
      contain the DER encoding of the value of the ASN.1 type ECPoint
      (see <a href="#section-7.2">Section 7.2</a>), which represents the sending agent's ephemeral
      EC public key.  The ECPoint in uncompressed form MUST be
      supported.

   -  ukm MAY be present or absent.  However, message originators SHOULD
      include the ukm.  As specified in <a href="rfc3852.html">RFC 3852</a> [<a href="#ref-CMS" title='"Cryptographic Message Syntax (CMS)"'>CMS</a>], implementations
      MUST support ukm message recipient processing, so interoperability
      is not a concern if the ukm is present or absent.  The ukm is
      placed in the entityUInfo field of the ECC-CMS-SharedInfo
      structure.  When present, the ukm is used to ensure that a
      different key-encryption key is generated, even when the ephemeral
      private key is improperly used more than once, by using the ECC-
      CMS-SharedInfo as an input to the key derivation function (see
      <a href="#section-7.2">Section 7.2</a>).

   -  keyEncryptionAlgorithm MUST contain the object identifier of the
      key-encryption algorithm, which in this case is a key agreement
      algorithm (see <a href="#section-7.1.4">Section 7.1.4</a>).  The parameters field contains
      KeyWrapAlgorithm.  The KeyWrapAlgorithm is the algorithm
      identifier that indicates the symmetric encryption algorithm used
      to encrypt the content-encryption key (CEK) with the key-
      encryption key (KEK) and any associated parameters (see <a href="#section-7.1.5">Section</a>
      <a href="#section-7.1.5">7.1.5</a>).  Algorithm requirements are found in <a href="#section-8">Section 8</a>.

   -  recipientEncryptedKeys contains an identifier and an encrypted key
      for each recipient.  The RecipientEncryptedKey
      KeyAgreeRecipientIdentifier MUST contain either the
      issuerAndSerialNumber identifying the recipient's certificate or
      the RecipientKeyIdentifier containing the subject key identifier
      from the recipient's certificate.  In both cases, the recipient's
      certificate contains the recipient's static ECDH public key.



<span class="grey">Turner &amp; Brown                Informational                     [Page 6]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc5753.html">RFC 5753</a>              Use of ECC Algorithms in CMS          January 2010</span>


      RecipientEncryptedKey EncryptedKey MUST contain the content-
      encryption key encrypted with the ephemeral-static, ECDH-generated
      pairwise key-encryption key using the algorithm specified by the
      KeyWrapAlgorithm.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.1.2.%20%20Actions%20of%20the%20Sending%20Agent"></a><a class="selflink" href="#section-3.1.2" name="section-3.1.2">3.1.2</a>.  Actions of the Sending Agent</span>

   When using ephemeral-static ECDH with EnvelopedData, the sending
   agent first obtains the recipient's EC public key and domain
   parameters (e.g., from the recipient's certificate).  The sending
   agent then performs one of the two ECDH variations mentioned above:

   - If the value of keyEncryptionAlgorithm indicates the use of
     'standard' Diffie-Hellman, then the sending agent performs the
     'Elliptic Curve Diffie-Hellman Scheme' with the 'Elliptic Curve
     Diffie-Hellman Primitive' in [<a href="#ref-SEC1" title='"SEC 1: Elliptic Curve Cryptography"'>SEC1</a>].

   - If the value of keyEncryptionAlgorithm indicates the use of 'co-
     factor' Diffie-Hellman, then the sending agent performs the 'One-
     Pass Diffie-Hellman scheme' (method C(1, 1, ECC CDH)) in
     [<a href="#ref-SP800-56A" title=" Special Publication 800-56A: Recommendation Pair-Wise Key Establishment Schemes Using Discrete Logarithm Cryptography (Revised)">SP800-56A</a>].

   In both of these cases, the sending agent uses the KDF defined in
   Section 3.6.1 of [<a href="#ref-SEC1" title='"SEC 1: Elliptic Curve Cryptography"'>SEC1</a>] with the hash algorithm identified by the
   value of keyEncryptionAlgorithm.  As a result, the sending agent
   obtains:

   -  an ephemeral public key, which is represented as a value of the
      type ECPoint (see <a href="#section-7.2">Section 7.2</a>), encapsulated in a bit string and
      placed in the KeyAgreeRecipientInfo originator originatorKey
      publicKey field, and

   -  a shared secret bit string "K", which is used as the pairwise key-
      encryption key for that recipient, as specified in [<a href="#ref-CMS" title='"Cryptographic Message Syntax (CMS)"'>CMS</a>].

   In a single message, if there are multiple layers for a recipient,
   then the ephemeral public key can be reused by the originator for
   that recipient in each of the different layers.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.1.3.%20%20Actions%20of%20the%20Receiving%20Agent"></a><a class="selflink" href="#section-3.1.3" name="section-3.1.3">3.1.3</a>.  Actions of the Receiving Agent</span>

   When using ephemeral-static ECDH with EnvelopedData, the receiving
   agent determines the bit string "SharedInfo", which is the DER
   encoding of ECC-CMS-SharedInfo (see <a href="#section-7.2">Section 7.2</a>), and the integer
   "keydatalen" from the key size, in bits, of the KeyWrapAlgorithm.
   The receiving agent retrieves the ephemeral EC public key from the
   bit string KeyAgreeRecipientInfo originator, with a value of the type
   ECPoint (see <a href="#section-7.2">Section 7.2</a>) encapsulated as a bit string, and if



<span class="grey">Turner &amp; Brown                Informational                     [Page 7]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc5753.html">RFC 5753</a>              Use of ECC Algorithms in CMS          January 2010</span>


   present, originally supplied additional user key material from the
   ukm field.  The receiving agent then performs one of the two ECDH
   variations mentioned above:

   - If the value of keyEncryptionAlgorithm indicates the use of
     'standard' Diffie-Hellman, then the receiving agent performs the
     'Elliptic Curve Diffie-Hellman Scheme' with the 'Elliptic Curve
     Diffie-Hellman Primitive' in [<a href="#ref-SEC1" title='"SEC 1: Elliptic Curve Cryptography"'>SEC1</a>].

   - If the value of keyEncryptionAlgorithm indicates the use of 'co-
     factor' Diffie-Hellman, then the receiving agent performs the 'One-
     Pass Diffie-Hellman scheme' (method C(1, 1, ECC CDH)) in
     [<a href="#ref-SP800-56A" title=" Special Publication 800-56A: Recommendation Pair-Wise Key Establishment Schemes Using Discrete Logarithm Cryptography (Revised)">SP800-56A</a>].

   In both of these cases, the receiving agent uses the KDF defined in
   Section 3.6.1 of [<a href="#ref-SEC1" title='"SEC 1: Elliptic Curve Cryptography"'>SEC1</a>] with the hash algorithm identified by the
   value of keyEncryptionAlgorithm.  As a result, the receiving agent
   obtains a shared secret bit string "K", which is used as the pairwise
   key-encryption key to unwrap the CEK.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.2.%20%20EnvelopedData%20Using%201-Pass%20ECMQV"></a><a class="selflink" href="#section-3.2" name="section-3.2">3.2</a>.  EnvelopedData Using 1-Pass ECMQV</span>

   This section describes how to use the 1-Pass Elliptic Curve Menezes-
   Qu-Vanstone (ECMQV) key agreement algorithm with EnvelopedData,
   method C(1, 2, ECC MQV) from [<a href="#ref-SP800-56A" title=" Special Publication 800-56A: Recommendation Pair-Wise Key Establishment Schemes Using Discrete Logarithm Cryptography (Revised)">SP800-56A</a>].  Like the KEA algorithm
   [<a href="#ref-CMS-KEA" title='"Use of the KEA and SKIPJACK Algorithms in CMS"'>CMS-KEA</a>], 1-Pass ECMQV uses three key pairs: an ephemeral key pair,
   a static key pair of the sending agent, and a static key pair of the
   receiving agent.  Using an algorithm with the sender static key pair
   allows for knowledge of the message creator; this means that
   authentication can, in some circumstances, be obtained for
   AuthEnvelopedData and AuthenticatedData.  This means that 1-Pass
   ECMQV can be a common algorithm for EnvelopedData, AuthenticatedData,
   and AuthEnvelopedData, while ECDH can only be used in EnvelopedData.

   If an implementation uses 1-Pass ECMQV with CMS EnvelopedData, then
   the following techniques and formats MUST be used.

   The fields of EnvelopedData are as in [<a href="#ref-CMS" title='"Cryptographic Message Syntax (CMS)"'>CMS</a>]; as 1-Pass ECMQV is a key
   agreement algorithm, the RecipientInfo kari choice is used.  When
   using 1-Pass ECMQV, the EnvelopedData originatorInfo field MAY
   include the certificate(s) for the EC public key(s) used in the
   formation of the pairwise key.  ECC certificates are discussed in
   <a href="#section-5">Section 5</a>.








<span class="grey">Turner &amp; Brown                Informational                     [Page 8]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc5753.html">RFC 5753</a>              Use of ECC Algorithms in CMS          January 2010</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.2.1.%20%20Fields%20of%20KeyAgreeRecipientInfo"></a><a class="selflink" href="#section-3.2.1" name="section-3.2.1">3.2.1</a>.  Fields of KeyAgreeRecipientInfo</span>

   When using 1-Pass ECMQV with EnvelopedData, the fields of
   KeyAgreeRecipientInfo are as follows:

   -  version MUST be 3.

   -  originator identifies the static EC public key of the sender.  It
      SHOULD be one of the alternatives, issuerAndSerialNumber or
      subjectKeyIdentifier, and point to one of the sending agent's
      certificates.

   -  ukm MUST be present.  The ukm field is an octet string that MUST
      contain the DER encoding of the type MQVuserKeyingMaterial (see
      <a href="#section-7.2">Section 7.2</a>).  The MQVuserKeyingMaterial ephemeralPublicKey
      algorithm field MUST contain the id-ecPublicKey object identifier
      (see <a href="#section-7.1.2">Section 7.1.2</a>).  The parameters associated with id-
      ecPublicKey MUST be absent, ECParameters, or NULL.  The parameters
      associated with id-ecPublicKey SHOULD be absent or ECParameters,
      as NULL is allowed to support legacy implementations.  The
      previous version of this document required NULL to be present.  If
      the parameters are ECParameters, then they MUST be namedCurve.
      The MQVuserKeyingMaterial ephemeralPublicKey publicKey field MUST
      contain the DER encoding of the ASN.1 type ECPoint (see <a href="#section-7.2">Section</a>
      <a href="#section-7.2">7.2</a>) representing the sending agent's ephemeral EC public key.
      The MQVuserKeyingMaterial addedukm field, if present, contains
      additional user keying material from the sending agent.

   -  keyEncryptionAlgorithm MUST contain the object identifier of the
      key-encryption algorithm, which in this case is a key agreement
      algorithm (see <a href="#section-7.1.4">Section 7.1.4</a>).  The parameters field contains
      KeyWrapAlgorithm.  The KeyWrapAlgorithm indicates the symmetric
      encryption algorithm used to encrypt the CEK with the KEK
      generated using the 1-Pass ECMQV algorithm and any associated
      parameters (see <a href="#section-7.1.5">Section 7.1.5</a>).  Algorithm requirements are found
      in <a href="#section-8">Section 8</a>.

   -  recipientEncryptedKeys contains an identifier and an encrypted key
      for each recipient.  The RecipientEncryptedKey
      KeyAgreeRecipientIdentifier MUST contain either the
      issuerAndSerialNumber identifying the recipient's certificate or
      the RecipientKeyIdentifier containing the subject key identifier
      from the recipient's certificate.  In both cases, the recipient's
      certificate contains the recipient's static ECMQV public key.
      RecipientEncryptedKey EncryptedKey MUST contain the content-
      encryption key encrypted with the 1-Pass ECMQV-generated pairwise
      key-encryption key using the algorithm specified by the
      KeyWrapAlgorithm.



<span class="grey">Turner &amp; Brown                Informational                     [Page 9]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc5753.html">RFC 5753</a>              Use of ECC Algorithms in CMS          January 2010</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.2.2.%20%20Actions%20of%20the%20Sending%20Agent"></a><a class="selflink" href="#section-3.2.2" name="section-3.2.2">3.2.2</a>.  Actions of the Sending Agent</span>

   When using 1-Pass ECMQV with EnvelopedData, the sending agent first
   obtains the recipient's EC public key and domain parameters (e.g.,
   from the recipient's certificate), and checks that the domain
   parameters are the same as the sender's domain parameters.  The
   sending agent then determines an integer "keydatalen", which is the
   KeyWrapAlgorithm symmetric key size in bits, and also a bit string
   "SharedInfo", which is the DER encoding of ECC-CMS-SharedInfo (see
   <a href="#section-7.2">Section 7.2</a>).  The sending agent then performs the key deployment and
   key agreement operations of the Elliptic Curve MQV Scheme specified
   in [<a href="#ref-SP800-56A" title=" Special Publication 800-56A: Recommendation Pair-Wise Key Establishment Schemes Using Discrete Logarithm Cryptography (Revised)">SP800-56A</a>], but uses the KDF defined in Section 3.6.1 of [<a href="#ref-SEC1" title='"SEC 1: Elliptic Curve Cryptography"'>SEC1</a>].
   As a result, the sending agent obtains:

   - an ephemeral public key, which is represented as a value of type
     ECPoint (see <a href="#section-7.2">Section 7.2</a>), encapsulated in a bit string, placed in
     an MQVuserKeyingMaterial ephemeralPublicKey publicKey field (see
     <a href="#section-7.2">Section 7.2</a>), and

   - a shared secret bit string "K", which is used as the pairwise key-
     encryption key for that recipient, as specified in [<a href="#ref-CMS" title='"Cryptographic Message Syntax (CMS)"'>CMS</a>].

   In a single message, if there are multiple layers for a recipient,
   then the ephemeral public key can be reused by the originator for
   that recipient in each of the different layers.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.2.3.%20%20Actions%20of%20the%20Receiving%20Agent"></a><a class="selflink" href="#section-3.2.3" name="section-3.2.3">3.2.3</a>.  Actions of the Receiving Agent</span>

   When using 1-Pass ECMQV with EnvelopedData, the receiving agent
   determines the bit string "SharedInfo", which is the DER encoding of
   ECC-CMS-SharedInfo (see <a href="#section-7.2">Section 7.2</a>), and the integer "keydatalen"
   from the key size, in bits, of the KeyWrapAlgorithm.  The receiving
   agent then retrieves the static and ephemeral EC public keys of the
   originator, from the originator and ukm fields as described in
   <a href="#section-3.2.1">Section 3.2.1</a>, and its static EC public key identified in the rid
   field and checks that the originator's domain parameters are the same
   as the recipient's domain parameters.  The receiving agent then
   performs the key agreement operation of the Elliptic Curve MQV Scheme
   [<a href="#ref-SP800-56A" title=" Special Publication 800-56A: Recommendation Pair-Wise Key Establishment Schemes Using Discrete Logarithm Cryptography (Revised)">SP800-56A</a>], but uses the KDF defined in Section 3.6.1 of [<a href="#ref-SEC1" title='"SEC 1: Elliptic Curve Cryptography"'>SEC1</a>].  As
   a result, the receiving agent obtains a shared secret bit string "K",
   which is used as the pairwise key-encryption key to unwrap the CEK.










<span class="grey">Turner &amp; Brown                Informational                    [Page 10]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc5753.html">RFC 5753</a>              Use of ECC Algorithms in CMS          January 2010</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20AuthenticatedData%20and%20AuthEnvelopedData%20Using%20ECC"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  AuthenticatedData and AuthEnvelopedData Using ECC</span>

   This section describes how to use ECC algorithms with the CMS
   AuthenticatedData format.  AuthenticatedData lacks non-repudiation,
   and so in some instances is preferable to SignedData.  (For example,
   the sending agent might not want the message to be authenticated when
   forwarded.)

   This section also describes how to use ECC algorithms with the CMS
   AuthEnvelopedData format [<a href="#ref-CMS-AUTHENV" title='"Cryptographic Message Syntax (CMS) Authenticated-Enveloped-Data Content Type"'>CMS-AUTHENV</a>].  AuthEnvelopedData supports
   authentication and encryption, and in some instances is preferable to
   signing and then encrypting data.

   For both AuthenticatedData and AuthEnvelopedData, data origin
   authentication with 1-Pass ECMQV can only be provided when there is
   one and only one recipient.  When there are multiple recipients, an
   attack is possible where one recipient modifies the content without
   other recipients noticing [<a href="#ref-BON" title='"The Security of Multicast MAC"'>BON</a>].  A sending agent who is concerned
   with such an attack SHOULD use a separate AuthenticatedData or
   AuthEnvelopedData for each recipient.

   Using an algorithm with the sender static key pair allows for
   knowledge of the message creator; this means that authentication can,
   in some circumstances, be obtained for AuthEnvelopedData and
   AuthenticatedData.  This means that 1-Pass ECMQV can be a common
   algorithm for EnvelopedData, AuthenticatedData, and AuthEnvelopedData
   while ECDH can only be used in EnvelopedData.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.1.%20%20AuthenticatedData%20Using%201-Pass%20ECMQV"></a><a class="selflink" href="#section-4.1" name="section-4.1">4.1</a>.  AuthenticatedData Using 1-Pass ECMQV</span>

   This section describes how to use the 1-Pass ECMQV key agreement
   algorithm with AuthenticatedData.  ECMQV is method C(1, 2, ECC MQV)
   from [<a href="#ref-SP800-56A" title=" Special Publication 800-56A: Recommendation Pair-Wise Key Establishment Schemes Using Discrete Logarithm Cryptography (Revised)">SP800-56A</a>].

   When using ECMQV with AuthenticatedData, the fields of
   AuthenticatedData are as in [<a href="#ref-CMS" title='"Cryptographic Message Syntax (CMS)"'>CMS</a>], but with the following
   restrictions:

   - macAlgorithm MUST contain the algorithm identifier of the message
     authentication code (MAC) algorithm (see <a href="#section-7.1.7">Section 7.1.7</a>), which MUST
     be one of the following: hmac-SHA1, id-hmacWITHSHA224, id-
     hmacWITHSHA256, id-hmacWITHSHA384, or id-hmacWITHSHA512.

   - digestAlgorithm MUST contain the algorithm identifier of the hash
     algorithm (see <a href="#section-7.1.1">Section 7.1.1</a>), which MUST be one of the following:
     id-sha1, id-sha224, id-sha256, id-sha384, or id-sha512.





<span class="grey">Turner &amp; Brown                Informational                    [Page 11]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc5753.html">RFC 5753</a>              Use of ECC Algorithms in CMS          January 2010</span>


   As 1-Pass ECMQV is a key agreement algorithm, the RecipientInfo kari
   choice is used in the AuthenticatedData.  When using 1-Pass ECMQV,
   the AuthenticatedData originatorInfo field MAY include the
   certificate(s) for the EC public key(s) used in the formation of the
   pairwise key.  ECC certificates are discussed in <a href="#section-5">Section 5</a>.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.1.1.%20%20Fields%20of%20the%20KeyAgreeRecipientInfo"></a><a class="selflink" href="#section-4.1.1" name="section-4.1.1">4.1.1</a>.  Fields of the KeyAgreeRecipientInfo</span>

   The AuthenticatedData KeyAgreeRecipientInfo fields are used in the
   same manner as the fields for the corresponding EnvelopedData
   KeyAgreeRecipientInfo fields of <a href="#section-3.2.1">Section 3.2.1</a> of this document.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.1.2.%20%20Actions%20of%20the%20Sending%20Agent"></a><a class="selflink" href="#section-4.1.2" name="section-4.1.2">4.1.2</a>.  Actions of the Sending Agent</span>

   The sending agent uses the same actions as for EnvelopedData with
   1-Pass ECMQV, as specified in <a href="#section-3.2.2">Section 3.2.2</a> of this document.

   In a single message, if there are multiple layers for a recipient,
   then the ephemeral public key can be reused by the originator for
   that recipient in each of the different layers.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.1.3.%20%20Actions%20of%20the%20Receiving%20Agent"></a><a class="selflink" href="#section-4.1.3" name="section-4.1.3">4.1.3</a>.  Actions of the Receiving Agent</span>

   The receiving agent uses the same actions as for EnvelopedData with
   1-Pass ECMQV, as specified in <a href="#section-3.2.3">Section 3.2.3</a> of this document.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.2.%20%20AuthEnvelopedData%20Using%201-Pass%20ECMQV"></a><a class="selflink" href="#section-4.2" name="section-4.2">4.2</a>.  AuthEnvelopedData Using 1-Pass ECMQV</span>

   This section describes how to use the 1-Pass ECMQV key agreement
   algorithm with AuthEnvelopedData.  ECMQV is method C(1, 2, ECC MQV)
   from [<a href="#ref-SP800-56A" title=" Special Publication 800-56A: Recommendation Pair-Wise Key Establishment Schemes Using Discrete Logarithm Cryptography (Revised)">SP800-56A</a>].

   When using ECMQV with AuthEnvelopedData, the fields of
   AuthEnvelopedData are as in [<a href="#ref-CMS-AUTHENV" title='"Cryptographic Message Syntax (CMS) Authenticated-Enveloped-Data Content Type"'>CMS-AUTHENV</a>].

   As 1-Pass ECMQV is a key agreement algorithm, the RecipientInfo kari
   choice is used.  When using 1-Pass ECMQV, the AuthEnvelopedData
   originatorInfo field MAY include the certificate(s) for the EC public
   key used in the formation of the pairwise key.  ECC certificates are
   discussed in <a href="#section-5">Section 5</a>.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.2.1.%20%20Fields%20of%20the%20KeyAgreeRecipientInfo"></a><a class="selflink" href="#section-4.2.1" name="section-4.2.1">4.2.1</a>.  Fields of the KeyAgreeRecipientInfo</span>

   The AuthEnvelopedData KeyAgreeRecipientInfo fields are used in the
   same manner as the fields for the corresponding EnvelopedData
   KeyAgreeRecipientInfo fields of <a href="#section-3.2.1">Section 3.2.1</a> of this document.





<span class="grey">Turner &amp; Brown                Informational                    [Page 12]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc5753.html">RFC 5753</a>              Use of ECC Algorithms in CMS          January 2010</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.2.2.%20%20Actions%20of%20the%20Sending%20Agent"></a><a class="selflink" href="#section-4.2.2" name="section-4.2.2">4.2.2</a>.  Actions of the Sending Agent</span>

   The sending agent uses the same actions as for EnvelopedData with
   1-Pass ECMQV, as specified in <a href="#section-3.2.2">Section 3.2.2</a> of this document.

   In a single message, if there are multiple layers for a recipient,
   then the ephemeral public key can be reused by the originator for
   that recipient in each of the different layers.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.2.3.%20%20Actions%20of%20the%20Receiving%20Agent"></a><a class="selflink" href="#section-4.2.3" name="section-4.2.3">4.2.3</a>.  Actions of the Receiving Agent</span>

   The receiving agent uses the same actions as for EnvelopedData with
   1-Pass ECMQV, as specified in <a href="#section-3.2.3">Section 3.2.3</a> of this document.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20Certificates%20Using%20ECC"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  Certificates Using ECC</span>

   Internet X.509 certificates [<a href="#ref-PKI" title='"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"'>PKI</a>] can be used in conjunction with
   this specification to distribute agents' public keys.  The use of ECC
   algorithms and keys within X.509 certificates is specified in
   [<a href="#ref-PKI-ALG" title='"Elliptic Curve Cryptography Subject Public Key Information"'>PKI-ALG</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20SMIMECapabilities%20Attribute%20and%20ECC"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  SMIMECapabilities Attribute and ECC</span>

   A sending agent MAY announce to receiving agents that it supports one
   or more of the ECC algorithms specified in this document by using the
   SMIMECapabilities signed attribute [<a href="#ref-MSG" title='"Secure/Multipurpose Internet Mail Extensions (S/MIME) Version 3.2 Message Specification"'>MSG</a>] in either a signed message
   or a certificate [<a href="#ref-CERTCAP" title='"X.509 Certificate Extension for Secure/Multipurpose Internet Mail Extensions (S/MIME) Capabilities"'>CERTCAP</a>].

   The SMIMECapabilities attribute value indicates support for one of
   the ECDSA signature algorithms in a SEQUENCE with the capabilityID
   field containing the object identifier ecdsa-with-SHA1 with NULL
   parameters and ecdsa-with-SHA* (where * is 224, 256, 384, or 512)
   with absent parameters.  The DER encodings are:

      ecdsa-with-SHA1:   30 0b 06 07 2a 86 48 ce 3d 04 01 05 00

      ecdsa-with-SHA224: 30 0a 06 08 2a 86 48 ce 3d 04 03 01

      ecdsa-with-SHA256: 30 0a 06 08 2a 86 48 ce 3d 04 03 02

      ecdsa-with-SHA384: 30 0a 06 08 2a 86 48 ce 3d 04 03 03

      ecdsa-with-SHA512: 30 0a 06 08 2a 86 48 ce 3d 04 03 04

   NOTE: The SMIMECapabilities attribute indicates that parameters for
   ECDSA with SHA-1 are NULL; however, the parameters are absent when
   used to generate a digital signature.




<span class="grey">Turner &amp; Brown                Informational                    [Page 13]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc5753.html">RFC 5753</a>              Use of ECC Algorithms in CMS          January 2010</span>


   The SMIMECapabilities attribute value indicates support for

      a)  the standard ECDH key agreement algorithm,
      b)  the cofactor ECDH key agreement algorithm, or
      c)  the 1-Pass ECMQV key agreement algorithm and

   is a SEQUENCE with the capabilityID field containing the object
   identifier

      a)  dhSinglePass-stdDH-sha*kdf-scheme,
      b)  dhSinglePass-cofactorDH-sha*kdf-scheme, or
      c)  mqvSinglePass-sha*kdf-scheme

   respectively (where * is 1, 224, 256, 384, or 512) with the
   parameters present.  The parameters indicate the supported key-
   encryption algorithm with the KeyWrapAlgorithm algorithm identifier.

   The DER encodings that indicate capabilities are as follows (KA is
   key agreement, KDF is key derivation function, and Wrap is key wrap
   algorithm):

      KA=ECDH standard KDF=SHA-1 Wrap=Triple-DES

        30 1c 06 09 2b 81 05 10 86 48 3f 00 02 30 0f 06 0b 2a 86 48 86
        f7 0d 01 09 10 03 06 05 00

      KA=ECDH standard KDF=SHA-224 Wrap=Triple-DES

        30 17 06 06 2b 81 04 01 0B 00 30 0d 06 0b 2a 86 48 86 f7 0d 01
        09 10 03 06

      KA=ECDH standard KDF=SHA-256 Wrap=Triple-DES

        30 17 06 06 2b 81 04 01 0B 01 30 0d 06 0b 2a 86 48 86 f7 0d 01
        09 10 03 06

      KA=ECDH standard KDF=SHA-384 Wrap=Triple-DES

        30 17 06 06 2b 81 04 01 0B 02 30 0d 06 0b 2a 86 48 86 f7 0d 01
        09 10 03 06

      KA=ECDH standard KDF=SHA-512 Wrap=Triple-DES

        30 17 06 06 2b 81 04 01 0B 03 30 0d 06 0b 2a 86 48 86 f7 0d 01
        09 10 03 06






<span class="grey">Turner &amp; Brown                Informational                    [Page 14]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc5753.html">RFC 5753</a>              Use of ECC Algorithms in CMS          January 2010</span>


      KA=ECDH standard KDF=SHA-1 Wrap=AES-128

        30 18 06 09 2b 81 05 10 86 48 3f 00 02 30 0b 06 09 60 86 48 01
        65 03 04 01 05

      KA=ECDH standard KDF=SHA-224 Wrap=AES-128

        30 15 06 06 2b 81 04 01 0B 00 30 0b 06 09 60 86 48 01 65 03 04
        01 05

      KA=ECDH standard KDF=SHA-256 Wrap=AES-128

        30 15 06 06 2b 81 04 01 0B 01 30 0b 06 09 60 86 48 01 65 03 04
        01 05

      KA=ECDH standard KDF=SHA-384 Wrap=AES-128

        30 15 06 06 2b 81 04 01 0B 02 30 0b 06 09 60 86 48 01 65 03 04
        01 05

      KA=ECDH standard KDF=SHA-512 Wrap=AES-128

        30 15 06 06 2b 81 04 01 0B 03 30 0b 06 09 60 86 48 01 65 03 04
        01 05

      KA=ECDH standard KDF=SHA-1 Wrap=AES-192

        30 18 06 09 2b 81 05 10 86 48 3f 00 02 30 0b 06 09 60 86 48 01
        65 03 04 01 19

      KA=ECDH standard KDF=SHA-224 Wrap=AES-192

        30 15 06 06 2b 81 04 01 0B 00 30 0b 06 09 60 86 48 01 65 03 04
        01 19

      KA=ECDH standard KDF=SHA-256 Wrap=AES-192

        30 15 06 06 2b 81 04 01 0B 01 30 0b 06 09 60 86 48 01 65 03 04
        01 19

      KA=ECDH standard KDF=SHA-384 Wrap=AES-192

        30 15 06 06 2b 81 04 01 0B 02 30 0b 06 09 60 86 48 01 65 03 04
        01 19







<span class="grey">Turner &amp; Brown                Informational                    [Page 15]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-16" id="page-16" name="page-16"> </a>
<span class="grey"><a href="rfc5753.html">RFC 5753</a>              Use of ECC Algorithms in CMS          January 2010</span>


      KA=ECDH standard KDF=SHA-512 Wrap=AES-192

        30 15 06 06 2b 81 04 01 0B 03 30 0b 06 09 60 86 48 01 65 03 04
        01 19

      KA=ECDH standard KDF=SHA-1 Wrap=AES-256

        30 18 06 09 2b 81 05 10 86 48 3f 00 02 30 0b 06 09 60 86 48 01
        65 03 04 01 2D

      KA=ECDH standard KDF=SHA-224 Wrap=AES-256

        30 15 06 06 2b 81 04 01 0B 00 30 0b 06 09 60 86 48 01 65 03 04
        01 2D

      KA=ECDH standard KDF=SHA-256 Wrap=AES-256

        30 15 06 06 2b 81 04 01 0B 01 30 0b 06 09 60 86 48 01 65 03 04
        01 2D

      KA=ECDH standard KDF=SHA-384 Wrap=AES-256

        30 15 06 06 2b 81 04 01 0B 02 30 0b 06 09 60 86 48 01 65 03 04
        01 2D 05 00

      KA=ECDH standard KDF=SHA-512 Wrap=AES-256

        30 15 06 06 2b 81 04 01 0B 03 30 0b 06 09 60 86 48 01 65 03 04
        01 2D

      KA=ECDH cofactor KDF=SHA-1 Wrap=Triple-DES

        30 1c 06 09 2b 81 05 10 86 48 3f 00 03 30 0f 06 0b 2a 86 48 86
        f7 0d 01 09 10 03 06 05 00

      KA=ECDH cofactor KDF=SHA-224 Wrap=Triple-DES

        30 17 06 06 2b 81 04 01 0E 00 30 0d 06 0b 2a 86 48 86 f7 0d 01
        09 10 03 06

      KA=ECDH cofactor KDF=SHA-256 Wrap=Triple-DES

        30 17 06 06 2b 81 04 01 0E 01 30 0d 06 0b 2a 86 48 86 f7 0d 01
        09 10 03 06







<span class="grey">Turner &amp; Brown                Informational                    [Page 16]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-17" id="page-17" name="page-17"> </a>
<span class="grey"><a href="rfc5753.html">RFC 5753</a>              Use of ECC Algorithms in CMS          January 2010</span>


      KA=ECDH cofactor KDF=SHA-384 Wrap=Triple-DES

        30 17 06 06 2b 81 04 01 0E 02 30 0d 06 0b 2a 86 48 86 f7 0d 01
        09 10 03 06

      KA=ECDH cofactor KDF=SHA-512 Wrap=Triple-DES

        30 17 06 06 2b 81 04 01 0E 03 30 0d 06 0b 2a 86 48 86 f7 0d 01
        09 10 03 06

      KA=ECDH cofactor KDF=SHA-1 Wrap=AES-128

        30 18 06 09 2b 81 05 10 86 48 3f 00 03 30 0b 06 09 60 86 48 01
        65 03 04 01 05

      KA=ECDH cofactor KDF=SHA-224 Wrap=AES-128

        30 15 06 06 2b 81 04 01 0E 00 30 0b 06 09 60 86 48 01 65 03 04
        01 05

      KA=ECDH cofactor KDF=SHA-256 Wrap=AES-128

        30 15 06 06 2b 81 04 01 0E 01 30 0b 06 09 60 86 48 01 65 03 04
        01 05

      KA=ECDH cofactor KDF=SHA-384 Wrap=AES-128

        30 15 06 06 2b 81 04 01 0E 02 30 0b 06 09 60 86 48 01 65 03 04
        01 05

      KA=ECDH cofactor KDF=SHA-512 Wrap=AES-128

        30 17 06 06 2b 81 04 01 0E 03 30 0b 06 09 60 86 48 01 65 03 04
        01 05

      KA=ECDH cofactor KDF=SHA-1 Wrap=AES-192

        30 18 06 09 2b 81 05 10 86 48 3f 00 03 30 0b 06 09 60 86 48 01
        65 03 04 01 19

      KA=ECDH cofactor KDF=SHA-224 Wrap=AES-192

        30 15 06 06 2b 81 04 01 0E 00 30 0b 06 09 60 86 48 01 65 03 04
        01 19







<span class="grey">Turner &amp; Brown                Informational                    [Page 17]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-18" id="page-18" name="page-18"> </a>
<span class="grey"><a href="rfc5753.html">RFC 5753</a>              Use of ECC Algorithms in CMS          January 2010</span>


      KA=ECDH cofactor KDF=SHA-256 Wrap=AES-192

        30 15 06 06 2b 81 04 01 0E 01 30 0b 06 09 60 86 48 01 65 03 04
        01 19

      KA=ECDH cofactor KDF=SHA-384 Wrap=AES-192

        30 15 06 06 2b 81 04 01 0E 02 30 0b 06 09 60 86 48 01 65 03 04
        01 19

      KA=ECDH cofactor KDF=SHA-512 Wrap=AES-192

        30 15 06 06 2b 81 04 01 0E 03 30 0b 06 09 60 86 48 01 65 03 04
        01 19

      KA=ECDH cofactor KDF=SHA-1 Wrap=AES-256

        30 15 06 09 2b 81 05 10 86 48 3f 00 03 30 0b 06 09 60 86 48 01
        65 03 04 01 2D

      KA=ECDH cofactor KDF=SHA-224 Wrap=AES-256

        30 15 06 06 2b 81 04 01 0E 00 30 0b 06 09 60 86 48 01 65 03 04
        01 2D

      KA=ECDH cofactor KDF=SHA-256 Wrap=AES-256

        30 15 06 06 2b 81 04 01 0E 01 30 0b 06 09 60 86 48 01 65 03 04
        01 2D

      KA=ECDH cofactor KDF=SHA-384 Wrap=AES-256

        30 15 06 06 2b 81 04 01 0E 02 30 0b 06 09 60 86 48 01 65 03 04
        01 2D

      KA=ECDH cofactor KDF=SHA-512 Wrap=AES-256

        30 15 06 06 2b 81 04 01 0E 03 30 0b 06 09 60 86 48 01 65 03 04
        01 2D

      KA=ECMQV 1-Pass KDF=SHA-1 Wrap=Triple-DES

        30 1c 06 09 2b 81 05 10 86 48 3f 00 10 30 0f 06 0b 2a 86 48 86
        f7 0d 01 09 10 03 06 05 00







<span class="grey">Turner &amp; Brown                Informational                    [Page 18]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-19" id="page-19" name="page-19"> </a>
<span class="grey"><a href="rfc5753.html">RFC 5753</a>              Use of ECC Algorithms in CMS          January 2010</span>


      KA=ECMQV 1-Pass KDF=SHA-224 Wrap=Triple-DES

        30 17 06 06 2b 81 04 01 0F 00 30 0d 06 0b 2a 86 48 86 f7 0d 01
        09 10 03 06

      KA=ECMQV 1-Pass KDF=SHA-256 Wrap=Triple-DES

        30 17 06 06 2b 81 04 01 0F 01 30 0d 06 0b 2a 86 48 86 f7 0d 01
        09 10 03 06

      KA=ECMQV 1-Pass KDF=SHA-384 Wrap=Triple-DES

        30 17 06 06 2b 81 04 01 0F 02 30 0d 06 0b 2a 86 48 86 f7 0d 01
        09 10 03 06

      KA=ECMQV 1-Pass KDF=SHA-512 Wrap=Triple-DES

        30 17 06 06 2b 81 04 01 0F 03 30 0d 06 0b 2a 86 48 86 f7 0d 01
        09 10 03 06

      KA=ECMQV 1-Pass KDF=SHA-1 Wrap=AES-128

        30 18 06 09 2b 81 05 10 86 48 3f 00 10 30 0b 06 09 60 86 48 01
        65 03 04 01 05

      KA=ECMQV 1-Pass KDF=SHA-224 Wrap=AES-128

        30 15 06 06 2b 81 04 01 0F 00 30 0b 06 09 60 86 48 01 65 03 04
        01 05

      KA=ECMQV 1-Pass KDF=SHA-256 Wrap=AES-128

        30 15 06 06 2b 81 04 01 0F 01 30 0b 06 09 60 86 48 01 65 03 04
        01 05

      KA=ECMQV 1-Pass KDF=SHA-384 Wrap=AES-128

        30 15 06 06 2b 81 04 01 0F 02 30 0b 06 09 60 86 48 01 65 03 04
        01 05

      KA=ECMQV 1-Pass KDF=SHA-512 Wrap=AES-128

        30 15 06 06 2b 81 04 01 0F 03 30 0b 06 09 60 86 48 01 65 03 04
        01 05







<span class="grey">Turner &amp; Brown                Informational                    [Page 19]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-20" id="page-20" name="page-20"> </a>
<span class="grey"><a href="rfc5753.html">RFC 5753</a>              Use of ECC Algorithms in CMS          January 2010</span>


      KA=ECMQV 1-Pass KDF=SHA-1 Wrap=AES-192

        30 18 06 09 2b 81 05 10 86 48 3f 00 10 30 0b 06 09 60 86 48 01
        65 03 04 01 19

      KA=ECMQV 1-Pass KDF=SHA-224 Wrap=AES-192

        30 15 06 06 2b 81 04 01 0F 00 30 0b 06 09 60 86 48 01 65 03 04
        01 19

      KA=ECMQV 1-Pass KDF=SHA-256 Wrap=AES-192

        30 15 06 06 2b 81 04 01 0F 01 30 0b 06 09 60 86 48 01 65 03 04
        01 19

      KA=ECMQV 1-Pass KDF=SHA-384 Wrap=AES-192

        30 15 06 06 2b 81 04 01 0F 02 30 0b 06 09 60 86 48 01 65 03 04
        01 19

      KA=ECMQV 1-Pass KDF=SHA-512 Wrap=AES-192

        30 15 06 06 2b 81 04 01 0F 03 30 0b 06 09 60 86 48 01 65 03 04
        01 19

      KA=ECMQV 1-Pass KDF=SHA-1 Wrap=AES-256

        30 18 06 09 2b 81 05 10 86 48 3f 00 10 30 0b 06 09 60 86 48 01
        65 03 04 01 2D

      KA=ECMQV 1-Pass KDF=SHA-224 Wrap=AES-256

        30 15 06 06 2b 81 04 01 0F 00 30 0b 06 09 60 86 48 01 65 03 04
        01 2D

      KA=ECMQV 1-Pass KDF=SHA-256 Wrap=AES-256

        30 15 06 06 2b 81 04 01 0F 01 30 0b 06 09 60 86 48 01 65 03 04
        01 2D

      KA=ECMQV 1-Pass KDF=SHA-384 Wrap=AES-256

        30 15 06 06 2b 81 04 01 0F 02 30 0b 06 09 60 86 48 01 65 03 04
        01 2D







<span class="grey">Turner &amp; Brown                Informational                    [Page 20]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-21" id="page-21" name="page-21"> </a>
<span class="grey"><a href="rfc5753.html">RFC 5753</a>              Use of ECC Algorithms in CMS          January 2010</span>


      KA=ECMQV 1-Pass KDF=SHA-512 Wrap=AES-256

        30 15 06 06 2b 81 04 01 0F 03 30 0b 06 09 60 86 48 01 65 03 04
        01 2D

   NOTE: The S/MIME Capabilities for the supported AES content-
   encryption key sizes are defined in [<a href="#ref-CMS-AES" title='"Use of the Advanced Encryption Standard (AES) Encryption Algorithm in Cryptographic Message Syntax (CMS)"'>CMS-AES</a>].

   NOTE: The S/MIME Capabilities for the supported MAC algorithms are
   defined in [<a href="#ref-CMS-ASN" title='"New ASN.1 Modules for CMS and S/MIME"'>CMS-ASN</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20ASN.1%20Syntax"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  ASN.1 Syntax</span>

   The ASN.1 syntax [<a href="#ref-X.680">X.680</a>], [<a href="#ref-X.681">X.681</a>], [<a href="#ref-X.682">X.682</a>], [<a href="#ref-X.683">X.683</a>] used in this
   document is gathered in this section for reference purposes.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.1.%20%20Algorithm%20Identifiers"></a><a class="selflink" href="#section-7.1" name="section-7.1">7.1</a>.  Algorithm Identifiers</span>

   This section provides the object identifiers for the algorithms used
   in this document along with any associated parameters.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/7.1.1.%20%20Digest%20Algorithms"></a><a class="selflink" href="#section-7.1.1" name="section-7.1.1">7.1.1</a>.  Digest Algorithms</span>

   Digest algorithm object identifiers are used in the SignedData
   digestAlgorithms and digestAlgorithm fields and the AuthenticatedData
   digestAlgorithm field.  The digest algorithms used in this document
   are SHA-1, SHA-224, SHA-256, SHA-384, and SHA-512.  The object
   identifiers and parameters associated with these algorithms are found
   in [<a href="#ref-CMS-ALG" title='"Cryptographic Message Syntax (CMS) Algorithms"'>CMS-ALG</a>] and [<a href="#ref-CMS-SHA2" title='"Using SHA2 Algorithms with Cryptographic Message Syntax"'>CMS-SHA2</a>].

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/7.1.2.%20%20Originator%20Public%20Key"></a><a class="selflink" href="#section-7.1.2" name="section-7.1.2">7.1.2</a>.  Originator Public Key</span>

   The KeyAgreeRecipientInfo originator field uses the following object
   identifier to indicate an elliptic curve public key:

      id-ecPublicKey OBJECT IDENTIFIER ::= {
        ansi-x9-62 keyType(2) 1 }

   where

      ansi-x9-62 OBJECT IDENTIFIER ::= {
        iso(1) member-body(2) us(840) 10045 }

   When the object identifier id-ecPublicKey is used here with an
   algorithm identifier, the associated parameters MUST be either absent
   or ECParameters.  Implementations MUST accept id-ecPublicKey with
   absent and ECParameters parameters.  If ECParameters is present, its




<span class="grey">Turner &amp; Brown                Informational                    [Page 21]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-22" id="page-22" name="page-22"> </a>
<span class="grey"><a href="rfc5753.html">RFC 5753</a>              Use of ECC Algorithms in CMS          January 2010</span>


   value MUST match the recipient's ECParameters.  Implementations
   SHOULD generate absent parameters for the id-ecPublicKey object
   identifier in the KeyAgreeRecipientInfo originator field.

   [<a id="ref-CMS-ECC" name="ref-CMS-ECC">CMS-ECC</a>] indicated the parameters were NULL.  Support for this
   legacy form is OPTIONAL.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/7.1.3.%20%20Signature%20Algorithms"></a><a class="selflink" href="#section-7.1.3" name="section-7.1.3">7.1.3</a>.  Signature Algorithms</span>

   Signature algorithm identifiers are used in the SignedData
   signatureAlgorithm and signature fields.  The signature algorithms
   used in this document are ECDSA with SHA-1, ECDSA with SHA-224, ECDSA
   with SHA-256, ECDSA with SHA-384, and ECDSA with SHA-512.  The object
   identifiers and parameters associated with these algorithms are found
   in [<a href="#ref-PKI-ALG" title='"Elliptic Curve Cryptography Subject Public Key Information"'>PKI-ALG</a>].

   [<a id="ref-CMS-ECC" name="ref-CMS-ECC">CMS-ECC</a>] indicated the parameters were NULL.  Support for this
   legacy form is OPTIONAL.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/7.1.4.%20%20Key%20Agreement%20Algorithms"></a><a class="selflink" href="#section-7.1.4" name="section-7.1.4">7.1.4</a>.  Key Agreement Algorithms</span>

   Key agreement algorithms are used in EnvelopedData,
   AuthenticatedData, and AuthEnvelopedData in the KeyAgreeRecipientInfo
   keyEncryptionAlgorithm field.  The following object identifiers
   indicate the key agreement algorithms used in this document
   [<a href="#ref-SP800-56A" title=" Special Publication 800-56A: Recommendation Pair-Wise Key Establishment Schemes Using Discrete Logarithm Cryptography (Revised)">SP800-56A</a>], [<a href="#ref-SEC1" title='"SEC 1: Elliptic Curve Cryptography"'>SEC1</a>]:

      dhSinglePass-stdDH-sha1kdf-scheme OBJECT IDENTIFIER ::= {
        x9-63-scheme 2 }

      dhSinglePass-stdDH-sha224kdf-scheme OBJECT IDENTIFIER ::= {
        secg-scheme 11 0 }

      dhSinglePass-stdDH-sha256kdf-scheme OBJECT IDENTIFIER ::= {
        secg-scheme 11 1 }

      dhSinglePass-stdDH-sha384kdf-scheme OBJECT IDENTIFIER ::= {
        secg-scheme 11 2 }

      dhSinglePass-stdDH-sha512kdf-scheme OBJECT IDENTIFIER ::= {
        secg-scheme 11 3 }

      dhSinglePass-cofactorDH-sha1kdf-scheme OBJECT IDENTIFIER ::= {
        x9-63-scheme 3 }

      dhSinglePass-cofactorDH-sha224kdf-scheme OBJECT IDENTIFIER ::= {
        secg-scheme 14 0 }




<span class="grey">Turner &amp; Brown                Informational                    [Page 22]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-23" id="page-23" name="page-23"> </a>
<span class="grey"><a href="rfc5753.html">RFC 5753</a>              Use of ECC Algorithms in CMS          January 2010</span>


      dhSinglePass-cofactorDH-sha256kdf-scheme OBJECT IDENTIFIER ::= {
        secg-scheme 14 1 }

      dhSinglePass-cofactorDH-sha384kdf-scheme OBJECT IDENTIFIER ::= {
        secg-scheme 14 2 }

      dhSinglePass-cofactorDH-sha512kdf-scheme OBJECT IDENTIFIER ::= {
        secg-scheme 14 3 }

      mqvSinglePass-sha1kdf-scheme OBJECT IDENTIFIER ::= {
        x9-63-scheme 16 }

      mqvSinglePass-sha224kdf-scheme OBJECT IDENTIFIER ::= {
        secg-scheme 15 0 }

      mqvSinglePass-sha256kdf-scheme OBJECT IDENTIFIER ::= {
        secg-scheme 15 1 }

      mqvSinglePass-sha384kdf-scheme OBJECT IDENTIFIER ::= {
        secg-scheme 15 2 }

      mqvSinglePass-sha512kdf-scheme OBJECT IDENTIFIER ::= {
        secg-scheme 15 3 }

   where

      x9-63-scheme OBJECT IDENTIFIER ::= {
        iso(1) identified-organization(3) tc68(133) country(16)
        x9(840) x9-63(63) schemes(0) }

   and

      secg-scheme OBJECT IDENTIFIER ::= {
        iso(1) identified-organization(3) certicom(132) schemes(1) }

   When the object identifiers are used here within an algorithm
   identifier, the associated parameters field contains KeyWrapAlgorithm
   to indicate the key wrap algorithm and any associated parameters.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/7.1.5.%20%20Key%20Wrap%20Algorithms"></a><a class="selflink" href="#section-7.1.5" name="section-7.1.5">7.1.5</a>.  Key Wrap Algorithms</span>

   Key wrap algorithms are used as part of the parameters in the key
   agreement algorithm.  The key wrap algorithms used in this document
   are Triple-DES, AES-128, AES-192, and AES-256.  The object
   identifiers and parameters for these algorithms are found in
   [<a href="#ref-CMS-ALG" title='"Cryptographic Message Syntax (CMS) Algorithms"'>CMS-ALG</a>] and [<a href="#ref-CMS-AES" title='"Use of the Advanced Encryption Standard (AES) Encryption Algorithm in Cryptographic Message Syntax (CMS)"'>CMS-AES</a>].





<span class="grey">Turner &amp; Brown                Informational                    [Page 23]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-24" id="page-24" name="page-24"> </a>
<span class="grey"><a href="rfc5753.html">RFC 5753</a>              Use of ECC Algorithms in CMS          January 2010</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/7.1.6.%20%20Content%20Encryption%20Algorithms"></a><a class="selflink" href="#section-7.1.6" name="section-7.1.6">7.1.6</a>.  Content Encryption Algorithms</span>

   Content encryption algorithms are used in EnvelopedData and
   AuthEnvelopedData in the EncryptedContentInfo
   contentEncryptionAlgorithm field.  The content encryption algorithms
   used with EnvelopedData in this document are 3-Key Triple DES in CBC
   mode, AES-128 in CBC mode, AES-192 in CBC mode, and AES-256 in CBC
   mode.  The object identifiers and parameters associated with these
   algorithms are found in [<a href="#ref-CMS-ALG" title='"Cryptographic Message Syntax (CMS) Algorithms"'>CMS-ALG</a>] and [<a href="#ref-CMS-AES" title='"Use of the Advanced Encryption Standard (AES) Encryption Algorithm in Cryptographic Message Syntax (CMS)"'>CMS-AES</a>].  The content
   encryption algorithms used with AuthEnvelopedData in this document
   are AES-128 in CCM mode, AES-192 in CCM mode, AES-256 in CCM mode,
   AES-128 in GCM mode, AES-192 in GCM mode, and AES-256 in GCM mode.
   The object identifiers and parameters associated with these
   algorithms are found in [<a href="#ref-CMS-AESCG" title='"Using AES-CCM and AES-GCM Authenticated Encryption in the Cryptographic Message Syntax (CMS)"'>CMS-AESCG</a>].

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/7.1.7.%20%20Message%20Authentication%20Code%20Algorithms"></a><a class="selflink" href="#section-7.1.7" name="section-7.1.7">7.1.7</a>.  Message Authentication Code Algorithms</span>

   Message authentication code algorithms are used in AuthenticatedData
   in the macAlgorithm field.  The message authentication code
   algorithms used in this document are HMAC with SHA-1, HMAC with
   SHA-224, HMAC with SHA-256, HMAC with SHA-384, and HMAC with SHA-512.
   The object identifiers and parameters associated with these
   algorithms are found in [<a href="#ref-CMS-ALG" title='"Cryptographic Message Syntax (CMS) Algorithms"'>CMS-ALG</a>] and [<a href="#ref-HMAC-SHA2" title='"Identifiers and Test Vectors for HMAC- SHA-224, HMAC-SHA-256, HMAC-SHA-384, and HMAC- SHA-512"'>HMAC-SHA2</a>].

   NOTE: [<a href="#ref-HMAC-SHA2" title='"Identifiers and Test Vectors for HMAC- SHA-224, HMAC-SHA-256, HMAC-SHA-384, and HMAC- SHA-512"'>HMAC-SHA2</a>] defines the object identifiers for HMAC with
   SHA-224, HMAC with SHA-256, HMAC with SHA-384, and HMAC with SHA-512,
   but there is no ASN.1 module from which to import these object
   identifiers.  Therefore, the object identifiers for these algorithms
   are included in the ASN.1 modules defined in <a href="#appendix-A">Appendix A</a>.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/7.1.8.%20%20Key%20Derivation%20Algorithm"></a><a class="selflink" href="#section-7.1.8" name="section-7.1.8">7.1.8</a>.  Key Derivation Algorithm</span>

   The KDF used in this document is as specified in Section 3.6.1 of
   [<a href="#ref-SEC1" title='"SEC 1: Elliptic Curve Cryptography"'>SEC1</a>].  The hash algorithm is identified in the key agreement
   algorithm.  For example, dhSinglePass-stdDH-sha256kdf-scheme uses the
   KDF from [<a href="#ref-SEC1" title='"SEC 1: Elliptic Curve Cryptography"'>SEC1</a>] but uses SHA-256 instead of SHA-1.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.2.%20%20Other%20Syntax"></a><a class="selflink" href="#section-7.2" name="section-7.2">7.2</a>.  Other Syntax</span>

   The following additional syntax is used here.

   When using ECDSA with SignedData, ECDSA signatures are encoded using
   the type:

      ECDSA-Sig-Value ::= SEQUENCE {
        r INTEGER,
        s INTEGER }




<span class="grey">Turner &amp; Brown                Informational                    [Page 24]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-25" id="page-25" name="page-25"> </a>
<span class="grey"><a href="rfc5753.html">RFC 5753</a>              Use of ECC Algorithms in CMS          January 2010</span>


   ECDSA-Sig-Value is specified in [<a href="#ref-PKI-ALG" title='"Elliptic Curve Cryptography Subject Public Key Information"'>PKI-ALG</a>].  Within CMS, ECDSA-Sig-
   Value is DER-encoded and placed within a signature field of
   SignedData.

   When using ECDH and ECMQV with EnvelopedData, AuthenticatedData, and
   AuthEnvelopedData, ephemeral and static public keys are encoded using
   the type ECPoint.  Implementations MUST support uncompressed keys,
   MAY support compressed keys, and MUST NOT support hybrid keys.

      ECPoint ::= OCTET STRING

   When using ECMQV with EnvelopedData, AuthenticatedData, and
   AuthEnvelopedData, the sending agent's ephemeral public key and
   additional keying material are encoded using the type:

      MQVuserKeyingMaterial ::= SEQUENCE {
        ephemeralPublicKey      OriginatorPublicKey,
        addedukm            [0] EXPLICIT UserKeyingMaterial OPTIONAL  }

   The ECPoint syntax is used to represent the ephemeral public key and
   is placed in the ephemeralPublicKey publicKey field.  The additional
   user keying material is placed in the addedukm field.  Then the
   MQVuserKeyingMaterial value is DER-encoded and placed within the ukm
   field of EnvelopedData, AuthenticatedData, or AuthEnvelopedData.

   When using ECDH or ECMQV with EnvelopedData, AuthenticatedData, or
   AuthEnvelopedData, the key-encryption keys are derived by using the
   type:

      ECC-CMS-SharedInfo ::= SEQUENCE {
        keyInfo         AlgorithmIdentifier,
        entityUInfo [0] EXPLICIT OCTET STRING OPTIONAL,
        suppPubInfo [2] EXPLICIT OCTET STRING  }

   The fields of ECC-CMS-SharedInfo are as follows:

      keyInfo contains the object identifier of the key-encryption
      algorithm (used to wrap the CEK) and associated parameters.  In
      this specification, 3DES wrap has NULL parameters while the AES
      wraps have absent parameters.

      entityUInfo optionally contains additional keying material
      supplied by the sending agent.  When used with ECDH and CMS, the
      entityUInfo field contains the octet string ukm.  When used with
      ECMQV and CMS, the entityUInfo contains the octet string addedukm
      (encoded in MQVuserKeyingMaterial).





<span class="grey">Turner &amp; Brown                Informational                    [Page 25]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-26" id="page-26" name="page-26"> </a>
<span class="grey"><a href="rfc5753.html">RFC 5753</a>              Use of ECC Algorithms in CMS          January 2010</span>


      suppPubInfo contains the length of the generated KEK, in bits,
      represented as a 32-bit number, as in [<a href="#ref-CMS-DH" title='"Diffie-Hellman Key Agreement Method"'>CMS-DH</a>] and [<a href="#ref-CMS-AES" title='"Use of the Advanced Encryption Standard (AES) Encryption Algorithm in Cryptographic Message Syntax (CMS)"'>CMS-AES</a>].
      (For example, for AES-256 it would be 00 00 01 00.)

   Within CMS, ECC-CMS-SharedInfo is DER-encoded and used as input to
   the key derivation function, as specified in Section 3.6.1 of [<a href="#ref-SEC1" title='"SEC 1: Elliptic Curve Cryptography"'>SEC1</a>].

   NOTE: ECC-CMS-SharedInfo differs from the OtherInfo specified in
   [<a href="#ref-CMS-DH" title='"Diffie-Hellman Key Agreement Method"'>CMS-DH</a>].  Here, a counter value is not included in the keyInfo field
   because the key derivation function specified in Section 3.6.1 of
   [<a href="#ref-SEC1" title='"SEC 1: Elliptic Curve Cryptography"'>SEC1</a>] ensures that sufficient keying data is provided.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/8.%20%20Recommended%20Algorithms%20and%20Elliptic%20Curves"></a><a class="selflink" href="#section-8" name="section-8">8</a>.  Recommended Algorithms and Elliptic Curves</span>

   It is RECOMMENDED that implementations of this specification support
   SignedData and EnvelopedData.  Support for AuthenticatedData and
   AuthEnvelopedData is OPTIONAL.

   In order to encourage interoperability, implementations SHOULD use
   the elliptic curve domain parameters specified by [<a href="#ref-PKI-ALG" title='"Elliptic Curve Cryptography Subject Public Key Information"'>PKI-ALG</a>].

   Implementations that support SignedData with ECDSA:

      - MUST support ECDSA with SHA-256; and

      - MAY support ECDSA with SHA-1, ECDSA with SHA-224, ECDSA with
        SHA-384, and ECDSA with SHA-512; other digital signature
        algorithms MAY also be supported.

   When using ECDSA, to promote interoperability it is RECOMMENDED that
   the P-192, P-224, and P-256 curves be used with SHA-256; the P-384
   curve be used with SHA-384; and the P-521 curve be used with SHA-512.

   If EnvelopedData is supported, then ephemeral-static ECDH standard
   primitive MUST be supported.  Support for ephemeral-static ECDH co-
   factor is OPTIONAL, and support for 1-Pass ECMQV is also OPTIONAL.

   Implementations that support EnvelopedData with the ephemeral-static
   ECDH standard primitive:

      - MUST support the dhSinglePass-stdDH-sha256kdf-scheme key
        agreement algorithm, the id-aes128-wrap key wrap algorithm, and
        the id-aes128-cbc content encryption algorithm; and








<span class="grey">Turner &amp; Brown                Informational                    [Page 26]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-27" id="page-27" name="page-27"> </a>
<span class="grey"><a href="rfc5753.html">RFC 5753</a>              Use of ECC Algorithms in CMS          January 2010</span>


      - MAY support the dhSinglePass-stdDH-sha1kdf-scheme, dhSinglePass-
        stdDH-sha224kdf-scheme, dhSinglePass-stdDH-sha384kdf-scheme, and
        dhSinglePass-stdDH-sha512kdf-scheme key agreement algorithms;
        the id-alg-CMS3DESwrap, id-aes192-wrap, and id-aes256-wrap key
        wrap algorithms; and the des-ede3-cbc, id-aes192-cbc, and id-
        aes256-cbc content encryption algorithms; other algorithms MAY
        also be supported.

   Implementations that support EnvelopedData with the ephemeral-static
   ECDH cofactor primitive:

      - MUST support the dhSinglePass-cofactorDH-sha256kdf-scheme key
        agreement algorithm, the id-aes128-wrap key wrap algorithm, and
        the id-aes128-cbc content encryption algorithm; and

      - MAY support the dhSinglePass-cofactorDH-sha1kdf-scheme,
        dhSinglePass-cofactorDH-sha224kdf-scheme, dhSinglePass-
        cofactorDH-sha384kdf-scheme, and dhSinglePass-cofactorDH-
        sha512kdf-scheme key agreement; the id-alg-CMS3DESwrap, id-
        aes192-wrap, and id-aes256-wrap key wrap algorithms; and the
        des-ede3-cbc, id-aes192-cbc, and id-aes256-cbc content
        encryption algorithms; other algorithms MAY also be supported.

   Implementations that support EnvelopedData with 1-Pass ECMQV:

      - MUST support the mqvSinglePass-sha256kdf-scheme key agreement
        algorithm, the id-aes128-wrap key wrap algorithm, and the id-
        aes128-cbc content encryption algorithm; and

      - MAY support the mqvSinglePass-sha1kdf-scheme, mqvSinglePass-
        sha224kdf-scheme, mqvSinglePass-sha384kdf-scheme, and
        mqvSinglePass-sha512kdf-scheme key agreement algorithms; the id-
        alg-CMS3DESwrap, id-aes192-wrap, and id-aes256-wrap key wrap
        algorithms; and the des-ede3-cbc, id-aes192-cbc, and id-
        aes256-cbc content encryption algorithms; other algorithms MAY
        also be supported.

   Implementations that support AuthenticatedData with 1-Pass ECMQV:

      - MUST support the mqvSinglePass-sha256kdf-scheme key agreement,
        the id-aes128-wrap key wrap, the id-sha256 message digest, and
        id-hmacWithSHA256 message authentication code algorithms; and

      - MAY support the mqvSinglePass-sha1kdf-scheme, mqvSinglePass-
        sha224kdf-scheme, mqvSinglePass-sha384kdf-scheme, mqvSinglePass-
        sha512kdf-scheme key agreement algorithms; the id-alg-
        CMS3DESwrap, id-aes192-wrap, and id-aes256-wrap key wrap
        algorithms; the id-sha1, id-sha224, id-sha384, and id-sha512,



<span class="grey">Turner &amp; Brown                Informational                    [Page 27]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-28" id="page-28" name="page-28"> </a>
<span class="grey"><a href="rfc5753.html">RFC 5753</a>              Use of ECC Algorithms in CMS          January 2010</span>


        message digest algorithms; and the hmac-SHA1, id-hmacWithSHA224,
        id-hmacWithSHA384, and id-hmacWithSHA512 message authentication
        code algorithms; other algorithms MAY also be supported.

   Implementations that support AuthEnvelopedData with 1-Pass ECMQV:

      - MUST support the mqvSinglePass-sha256kdf-scheme key agreement,
        the id-aes128-wrap key wrap, and the id-aes128-ccm
        authenticated-content encryption; and

      - MAY support the mqvSinglePass-sha1kdf-scheme, mqvSinglePass-
        sha224kdf-scheme, mqvSinglePass-sha384kdf-scheme, and
        mqvSinglePass-sha512kdf-scheme key agreement algorithms; the id-
        alg-CMS3DESwrap, id-aes192-wrap, and id-aes256-wrap key wrap
        algorithms; and the id-aes192-ccm, id-aes256-ccm, id-aes128-gcm,
        id-aes192-gcm, and id-aes256-ccm authenticated-content
        encryption algorithms; other algorithms MAY also be supported.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/9.%20%20Security%20Considerations"></a><a class="selflink" href="#section-9" name="section-9">9</a>.  Security Considerations</span>

   Cryptographic algorithms will be broken or weakened over time.
   Implementers and users need to check that the cryptographic
   algorithms listed in this document continue to provide the expected
   level of security.  The IETF from time to time may issue documents
   dealing with the current state of the art.

   Cryptographic algorithms rely on random numbers.  See [<a href="#ref-RANDOM" title='"Randomness Requirements for Security"'>RANDOM</a>] for
   guidance on generation of random numbers.

   Receiving agents that validate signatures and sending agents that
   encrypt messages need to be cautious of cryptographic processing
   usage when validating signatures and encrypting messages using keys
   larger than those mandated in this specification.  An attacker could
   send keys and/or certificates with keys that would result in
   excessive cryptographic processing, for example, keys larger than
   those mandated in this specification, which could swamp the
   processing element.  Agents that use such keys without first
   validating the certificate to a trust anchor are advised to have some
   sort of cryptographic resource management system to prevent such
   attacks.

   Using secret keys of an appropriate size is crucial to the security
   of a Diffie-Hellman exchange.  For elliptic curve groups, the size of
   the secret key must be equal to the size of n (the order of the group
   generated by the point g).  Using larger secret keys provides
   absolutely no additional security, and using smaller secret keys is
   likely to result in dramatically less security.  (See [<a href="#ref-SP800-56A" title=" Special Publication 800-56A: Recommendation Pair-Wise Key Establishment Schemes Using Discrete Logarithm Cryptography (Revised)">SP800-56A</a>] for
   more information on selecting secret keys.)



<span class="grey">Turner &amp; Brown                Informational                    [Page 28]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-29" id="page-29" name="page-29"> </a>
<span class="grey"><a href="rfc5753.html">RFC 5753</a>              Use of ECC Algorithms in CMS          January 2010</span>


   This specification is based on [<a href="#ref-CMS" title='"Cryptographic Message Syntax (CMS)"'>CMS</a>], [<a href="#ref-CMS-AES" title='"Use of the Advanced Encryption Standard (AES) Encryption Algorithm in Cryptographic Message Syntax (CMS)"'>CMS-AES</a>], [<a href="#ref-CMS-AESCG" title='"Using AES-CCM and AES-GCM Authenticated Encryption in the Cryptographic Message Syntax (CMS)"'>CMS-AESCG</a>],
   [<a href="#ref-CMS-ALG" title='"Cryptographic Message Syntax (CMS) Algorithms"'>CMS-ALG</a>], [<a href="#ref-CMS-AUTHENV" title='"Cryptographic Message Syntax (CMS) Authenticated-Enveloped-Data Content Type"'>CMS-AUTHENV</a>], [<a href="#ref-CMS-DH" title='"Diffie-Hellman Key Agreement Method"'>CMS-DH</a>], [<a href="#ref-CMS-SHA2" title='"Using SHA2 Algorithms with Cryptographic Message Syntax"'>CMS-SHA2</a>], [<a href="#ref-FIPS180-3" title=" FIPS Publication 180-3: Secure Hash Standard">FIPS180-3</a>],
   [<a href="#ref-FIPS186-3" title=" FIPS Publication 186-3: Digital Signature Standard">FIPS186-3</a>], and [<a href="#ref-HMAC-SHA2" title='"Identifiers and Test Vectors for HMAC- SHA-224, HMAC-SHA-256, HMAC-SHA-384, and HMAC- SHA-512"'>HMAC-SHA2</a>], and the appropriate security
   considerations of those documents apply.

   In addition, implementers of AuthenticatedData and AuthEnvelopedData
   should be aware of the concerns expressed in [<a href="#ref-BON" title='"The Security of Multicast MAC"'>BON</a>] when using
   AuthenticatedData and AuthEnvelopedData to send messages to more than
   one recipient.  Also, users of MQV should be aware of the
   vulnerability described in [<a href="#ref-K" title='"MQV Vulnerability"'>K</a>].

   When implementing EnvelopedData, AuthenticatedData, and
   AuthEnvelopedData, there are five algorithm-related choices that need
   to be made:

      1) What is the public key size?
      2) What is the KDF?
      3) What is the key wrap algorithm?
      4) What is the content encryption algorithm?
      5) What is the curve?

   Consideration must be given to the strength of the security provided
   by each of these choices.  Security algorithm strength is measured in
   bits, where bits is measured in equivalence to a symmetric cipher
   algorithm.  Thus, a strong symmetric cipher algorithm with a key of X
   bits is said to provide X bits of security.  For other algorithms,
   the key size is mapped to an equivalent symmetric cipher strength.
   It is recommended that the bits of security provided by each are
   roughly equivalent.  The following table provides comparable minimum
   bits of security [<a href="#ref-SP800-57" title=" Special Publication 800-57: Recommendation for Key Management - Part 1 (Revised)">SP800-57</a>] for the ECDH/ECMQV key sizes, KDFs, key
   wrapping algorithms, and content encryption algorithms.  It also
   lists curves [<a href="#ref-PKI-ALG" title='"Elliptic Curve Cryptography Subject Public Key Information"'>PKI-ALG</a>] for the key sizes.



















<span class="grey">Turner &amp; Brown                Informational                    [Page 29]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-30" id="page-30" name="page-30"> </a>
<span class="grey"><a href="rfc5753.html">RFC 5753</a>              Use of ECC Algorithms in CMS          January 2010</span>


   Minimum  | ECDH or  | Key        | Key      | Content     | Curves
   Bits of  | ECMQV    | Derivation | Wrap     | Encryption  |
   Security | Key Size | Function   | Alg.     | Alg.        |
   ---------+----------+------------+----------+-------------+----------
   80       | 160-223  | SHA-1      | 3DES     | 3DES CBC    | sect163k1
            |          | SHA-224    | AES-128  | AES-128 CBC | secp163r2
            |          | SHA-256    | AES-192  | AES-192 CBC | secp192r1
            |          | SHA-384    | AES-256  | AES-256 CBC |
            |          | SHA-512    |          |             |
   ---------+----------+------------+----------+-------------+---------
   112      | 224-255  | SHA-1      | 3DES     | 3DES CBC    | secp224r1
            |          | SHA-224    | AES-128  | AES-128 CBC | sect233k1
            |          | SHA-256    | AES-192  | AES-192 CBC | sect233r1
            |          | SHA-384    | AES-256  | AES-256 CBC |
            |          | SHA-512    |          |             |
   ---------+----------+------------+----------+-------------+---------
   128      | 256-383  | SHA-1      | AES-128  | AES-128 CBC | secp256r1
            |          | SHA-224    | AES-192  | AES-192 CBC | sect283k1
            |          | SHA-256    | AES-256  | AES-256 CBC | sect283r1
            |          | SHA-384    |          |             |
            |          | SHA-512    |          |             |
   ---------+----------+------------+----------+-------------+---------
   192      | 384-511  | SHA-224    | AES-192  | AES-192 CBC | secp384r1
            |          | SHA-256    | AES-256  | AES-256 CBC | sect409k1
            |          | SHA-384    |          |             | sect409r1
            |          | SHA-512    |          |             |
   ---------+----------+------------+----------+-------------+---------
   256      | 512+     | SHA-256    | AES-256  | AES-256 CBC | secp521r1
            |          | SHA-384    |          |             | sect571k1
            |          | SHA-512    |          |             | sect571r1
   ---------+----------+------------+----------+-------------+---------




















<span class="grey">Turner &amp; Brown                Informational                    [Page 30]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-31" id="page-31" name="page-31"> </a>
<span class="grey"><a href="rfc5753.html">RFC 5753</a>              Use of ECC Algorithms in CMS          January 2010</span>


   To promote interoperability, the following choices are RECOMMENDED:

   Minimum  | ECDH or  | Key        | Key      | Content     | Curve
   Bits of  | ECMQV    | Derivation | Wrap     | Encryption  |
   Security | Key Size | Function   | Alg.     | Alg.        |
   ---------+----------+------------+----------+-------------+----------
   80       | 192      | SHA-256    | 3DES     | 3DES CBC    | secp192r1
   ---------+----------+------------+----------+-------------+----------
   112      | 224      | SHA-256    | 3DES     | 3DES CBC    | secp224r1
   ---------+----------+------------+----------+-------------+----------
   128      | 256      | SHA-256    | AES-128  | AES-128 CBC | secp256r1
   ---------+----------+------------+----------+-------------+----------
   192      | 384      | SHA-384    | AES-256  | AES-256 CBC | secp384r1
   ---------+----------+------------+----------+-------------+----------
   256      | 512+     | SHA-512    | AES-256  | AES-256 CBC | secp521r1
   ---------+----------+------------+----------+-------------+----------

   When implementing SignedData, there are three algorithm-related
   choices that need to be made:

      1) What is the public key size?
      2) What is the hash algorithm?
      3) What is the curve?

   Consideration must be given to the bits of security provided by each
   of these choices.  Security is measured in bits, where a strong
   symmetric cipher with a key of X bits is said to provide X bits of
   security.  It is recommended that the bits of security provided by
   each choice are roughly equivalent.  The following table provides
   comparable minimum bits of security [<a href="#ref-SP800-57" title=" Special Publication 800-57: Recommendation for Key Management - Part 1 (Revised)">SP800-57</a>] for the ECDSA key
   sizes and message digest algorithms.  It also lists curves [<a href="#ref-PKI-ALG" title='"Elliptic Curve Cryptography Subject Public Key Information"'>PKI-ALG</a>]
   for the key sizes.



















<span class="grey">Turner &amp; Brown                Informational                    [Page 31]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-32" id="page-32" name="page-32"> </a>
<span class="grey"><a href="rfc5753.html">RFC 5753</a>              Use of ECC Algorithms in CMS          January 2010</span>


   Minimum  | ECDSA    | Message   | Curve
   Bits of  | Key Size | Digest    |
   Security |          | Algorithm |
   ---------+----------+-----------+-----------
   80       | 160-223  | SHA-1     | sect163k1
            |          | SHA-224   | secp163r2
            |          | SHA-256   | secp192r1
            |          | SHA-384   |
            |          | SHA-512   |
   ---------+----------+-----------+-----------
   112      | 224-255  | SHA-224   | secp224r1
            |          | SHA-256   | sect233k1
            |          | SHA-384   | sect233r1
            |          | SHA-512   |
   ---------+----------+-----------+-----------
   128      | 256-383  | SHA-256   | secp256r1
            |          | SHA-384   | sect283k1
            |          | SHA-512   | sect283r1
   ---------+----------+-----------+-----------
   192      | 384-511  | SHA-384   | secp384r1
            |          | SHA-512   | sect409k1
            |          |           | sect409r1
   ---------+----------+-----------+-----------
   256      | 512+     | SHA-512   | secp521r1
            |          |           | sect571k1
            |          |           | sect571r1
   ---------+----------+-----------+-----------

   To promote interoperability, the following choices are RECOMMENDED:

   Minimum  | ECDSA    | Message   | Curve
   Bits of  | Key Size | Digest    |
   Security |          | Algorithm |
   ---------+----------+-----------+-----------
   80       | 192      | SHA-256   | sect192r1
   ---------+----------+-----------+-----------
   112      | 224      | SHA-256   | secp224r1
   ---------+----------+-----------+-----------
   128      | 256      | SHA-256   | secp256r1
   ---------+----------+-----------+-----------
   192      | 384      | SHA-384   | secp384r1
   ---------+----------+-----------+-----------
   256      | 512+     | SHA-512   | secp521r1
   ---------+----------+-----------+-----------







<span class="grey">Turner &amp; Brown                Informational                    [Page 32]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-33" id="page-33" name="page-33"> </a>
<span class="grey"><a href="rfc5753.html">RFC 5753</a>              Use of ECC Algorithms in CMS          January 2010</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/10.%20%20IANA%20Considerations"></a><a class="selflink" href="#section-10" name="section-10">10</a>.  IANA Considerations</span>

   This document makes extensive use of object identifiers to register
   originator public key types and algorithms.  The algorithm object
   identifiers are registered in the ANSI X9.62, ANSI X9.63, NIST, RSA,
   and SECG arcs.  Additionally, object identifiers are used to identify
   the ASN.1 modules found in <a href="#appendix-A">Appendix A</a> (there are two).  These are
   defined by the SMIME WG Registrar in an arc delegated by RSA to the
   SMIME Working Group: iso(1) member-body(2) us(840) rsadsi(113549)
   pkcs(1) pkcs-9(9) smime(16) modules(0).  No action by IANA is
   necessary for this document or any anticipated updates.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/11.%20%20References"></a><a class="selflink" href="#section-11" name="section-11">11</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/11.1.%20%20Normative%20References"></a><a class="selflink" href="#section-11.1" name="section-11.1">11.1</a>.  Normative References</span>

   [<a id="ref-CMS" name="ref-CMS">CMS</a>]          Housley, R., "Cryptographic Message Syntax (CMS)", <a href="rfc5652.html">RFC</a>
                  <a href="rfc5652.html">5652</a>, September 2009.

   [<a id="ref-CMS-AES" name="ref-CMS-AES">CMS-AES</a>]      Schaad, J., "Use of the Advanced Encryption Standard
                  (AES) Encryption Algorithm in Cryptographic Message
                  Syntax (CMS)", <a href="rfc3565.html">RFC 3565</a>, July 2003.

   [<a id="ref-CMS-AESCG" name="ref-CMS-AESCG">CMS-AESCG</a>]    Housley, R., "Using AES-CCM and AES-GCM Authenticated
                  Encryption in the Cryptographic Message Syntax (CMS)",
                  <a href="rfc5084.html">RFC 5084</a>, December 2007.

   [<a id="ref-CMS-ALG" name="ref-CMS-ALG">CMS-ALG</a>]      Housley, R., "Cryptographic Message Syntax (CMS)
                  Algorithms", <a href="rfc3370.html">RFC 3370</a>, August 2002.

   [<a id="ref-CMS-AUTHENV" name="ref-CMS-AUTHENV">CMS-AUTHENV</a>]  Housley, R., "Cryptographic Message Syntax (CMS)
                  Authenticated-Enveloped-Data Content Type", <a href="rfc5083.html">RFC 5083</a>,
                  November 2007.

   [<a id="ref-CMS-DH" name="ref-CMS-DH">CMS-DH</a>]       Rescorla, E., "Diffie-Hellman Key Agreement Method",
                  <a href="rfc2631.html">RFC 2631</a>, June 1999.

   [<a id="ref-CMS-SHA2" name="ref-CMS-SHA2">CMS-SHA2</a>]     Turner, S., "Using SHA2 Algorithms with Cryptographic
                  Message Syntax", <a href="rfc5754.html">RFC 5754</a>, January 2010.

   [<a id="ref-FIPS180-3" name="ref-FIPS180-3">FIPS180-3</a>]    National Institute of Standards and Technology (NIST),
                  FIPS Publication 180-3: Secure Hash Standard, October
                  2008.

   [<a id="ref-FIPS186-3" name="ref-FIPS186-3">FIPS186-3</a>]    National Institute of Standards and Technology (NIST),
                  FIPS Publication 186-3: Digital Signature Standard,
                  June 2009.




<span class="grey">Turner &amp; Brown                Informational                    [Page 33]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-34" id="page-34" name="page-34"> </a>
<span class="grey"><a href="rfc5753.html">RFC 5753</a>              Use of ECC Algorithms in CMS          January 2010</span>


   [<a id="ref-HMAC-SHA2" name="ref-HMAC-SHA2">HMAC-SHA2</a>]    Nystrom, M., "Identifiers and Test Vectors for HMAC-
                  SHA-224, HMAC-SHA-256, HMAC-SHA-384, and HMAC-
                  SHA-512", <a href="rfc4231.html">RFC 4231</a>, December 2005.

   [<a id="ref-MUST" name="ref-MUST">MUST</a>]         Bradner, S., "Key words for use in RFCs to Indicate
                  Requirement Levels", <a href="http://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.

   [<a id="ref-MSG" name="ref-MSG">MSG</a>]          Ramsdell, B. and S. Turner, "Secure/Multipurpose
                  Internet Mail Extensions (S/MIME) Version 3.2 Message
                  Specification", <a href="rfc5751.html">RFC 5751</a>, January 2010.

   [<a id="ref-PKI" name="ref-PKI">PKI</a>]          Cooper, D., Santesson, S., Farrell, S., Boeyen, S.,
                  Housley, R., and W. Polk, "Internet X.509 Public Key
                  Infrastructure Certificate and Certificate Revocation
                  List (CRL) Profile", <a href="rfc5280.html">RFC 5280</a>, May 2008.

   [<a id="ref-PKI-ALG" name="ref-PKI-ALG">PKI-ALG</a>]      Turner, S., Brown, D., Yiu, K., Housley, R., and T.
                  Polk, "Elliptic Curve Cryptography Subject Public Key
                  Information", <a href="rfc5480.html">RFC 5480</a>, March 2009.

   [<a id="ref-RANDOM" name="ref-RANDOM">RANDOM</a>]       Eastlake, D., 3rd, Schiller, J., and S. Crocker,
                  "Randomness Requirements for Security", <a href="http://tools.ietf.org/html/bcp106">BCP 106</a>, <a href="rfc4086.html">RFC</a>
                  <a href="rfc4086.html">4086</a>, June 2005.

   [<a id="ref-RSAOAEP" name="ref-RSAOAEP">RSAOAEP</a>]      Schaad, J., Kaliski, B., and R. Housley, "Additional
                  Algorithms and Identifiers for RSA Cryptography for
                  use in the Internet X.509 Public Key Infrastructure
                  Certificate and Certificate Revocation List (CRL)
                  Profile", <a href="rfc4055.html">RFC 4055</a>, June 2005.

   [<a id="ref-SEC1" name="ref-SEC1">SEC1</a>]         Standards for Efficient Cryptography Group, "SEC 1:
                  Elliptic Curve Cryptography", version 2.0, May 2009,
                  available from www.secg.org.

   [<a id="ref-SP800-56A" name="ref-SP800-56A">SP800-56A</a>]    National Institute of Standards and Technology (NIST),
                  Special Publication 800-56A: Recommendation Pair-Wise
                  Key Establishment Schemes Using Discrete Logarithm
                  Cryptography (Revised), March 2007.

   [<a id="ref-X.680" name="ref-X.680">X.680</a>]        ITU-T Recommendation X.680 (2002) | ISO/IEC
                  8824-1:2002. Information Technology - Abstract Syntax
                  Notation One.









<span class="grey">Turner &amp; Brown                Informational                    [Page 34]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-35" id="page-35" name="page-35"> </a>
<span class="grey"><a href="rfc5753.html">RFC 5753</a>              Use of ECC Algorithms in CMS          January 2010</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/11.2.%20%20Informative%20References"></a><a class="selflink" href="#section-11.2" name="section-11.2">11.2</a>.  Informative References</span>

   [<a id="ref-BON" name="ref-BON">BON</a>]          D. Boneh, "The Security of Multicast MAC",
                  Presentation at Selected Areas of Cryptography 2000,
                  Center for Applied Cryptographic Research, University
                  of Waterloo, 2000.  Paper version available from
                  <a href="http://crypto.stanford.edu/~dabo/papers/mmac.ps">http://crypto.stanford.edu/~dabo/papers/mmac.ps</a>

   [<a id="ref-CERTCAP" name="ref-CERTCAP">CERTCAP</a>]      Santesson, S., "X.509 Certificate Extension for
                  Secure/Multipurpose Internet Mail Extensions (S/MIME)
                  Capabilities", <a href="rfc4262.html">RFC 4262</a>, December 2005.

   [<a id="ref-CMS-ASN" name="ref-CMS-ASN">CMS-ASN</a>]      Hoffman, P. and J. Schaad, "New ASN.1 Modules for CMS
                  and S/MIME", Work in Progress, August 2009.

   [<a id="ref-CMS-ECC" name="ref-CMS-ECC">CMS-ECC</a>]      Blake-Wilson, S., Brown, D., and P. Lambert, "Use of
                  Elliptic Curve Cryptography (ECC) Algorithms in
                  Cryptographic Message Syntax (CMS)", <a href="rfc3278.html">RFC 3278</a>, April
                  2002.

   [<a id="ref-CMS-KEA" name="ref-CMS-KEA">CMS-KEA</a>]      Pawling, J., "Use of the KEA and SKIPJACK Algorithms
                  in CMS", <a href="rfc2876.html">RFC 2876</a>, July 2000.

   [<a id="ref-K" name="ref-K">K</a>]            B. Kaliski, "MQV Vulnerability", Posting to ANSI X9F1
                  and IEEE P1363 newsgroups, 1998.

   [<a id="ref-PKI-ASN" name="ref-PKI-ASN">PKI-ASN</a>]      Hoffman, P. and J. Schaad, "New ASN.1 Modules for
                  PKIX", Work in Progress, August 2009.

   [<a id="ref-SP800-57" name="ref-SP800-57">SP800-57</a>]     National Institute of Standards and Technology (NIST),
                  Special Publication 800-57: Recommendation for Key
                  Management - Part 1 (Revised), March 2007.

   [<a id="ref-X.681" name="ref-X.681">X.681</a>]        ITU-T Recommendation X.681 (2002) | ISO/IEC
                  8824-2:2002. Information Technology - Abstract Syntax
                  Notation One: Information Object Specification.

   [<a id="ref-X.682" name="ref-X.682">X.682</a>]        ITU-T Recommendation X.682 (2002) | ISO/IEC
                  8824-3:2002. Information Technology - Abstract Syntax
                  Notation One: Constraint Specification.

   [<a id="ref-X.683" name="ref-X.683">X.683</a>]        ITU-T Recommendation X.683 (2002) | ISO/IEC
                  8824-4:2002. Information Technology - Abstract Syntax
                  Notation One: Parameterization of ASN.1
                  Specifications, 2002.






<span class="grey">Turner &amp; Brown                Informational                    [Page 35]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-36" id="page-36" name="page-36"> </a>
<span class="grey"><a href="rfc5753.html">RFC 5753</a>              Use of ECC Algorithms in CMS          January 2010</span>


   [<a id="ref-X9.62" name="ref-X9.62">X9.62</a>]        X9.62-2005, "Public Key Cryptography for the Financial
                  Services Industry: The Elliptic Curve Digital
                  Signature Standard (ECDSA)", November, 2005.
















































<span class="grey">Turner &amp; Brown                Informational                    [Page 36]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-37" id="page-37" name="page-37"> </a>
<span class="grey"><a href="rfc5753.html">RFC 5753</a>              Use of ECC Algorithms in CMS          January 2010</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/Appendix%20A.%20%20%20ASN.1%20Modules"></a><a class="selflink" href="#appendix-A" name="appendix-A">Appendix A</a>.   ASN.1 Modules</span>

   <a href="#appendix-A.1">Appendix A.1</a> provides the normative ASN.1 definitions for the
   structures described in this specification using ASN.1 as defined in
   [<a href="#ref-X.680">X.680</a>] for compilers that support the 1988 ASN.1.

   <a href="#appendix-A.2">Appendix A.2</a> provides informative ASN.1 definitions for the
   structures described in this specification using ASN.1 as defined in
   [<a href="#ref-X.680">X.680</a>], [<a href="#ref-X.681">X.681</a>], [<a href="#ref-X.682">X.682</a>], and [<a href="#ref-X.683">X.683</a>] for compilers that support the
   2002 ASN.1.  This appendix contains the same information as <a href="#appendix-A.1">Appendix</a>
   <a href="#appendix-A.1">A.1</a> in a more recent (and precise) ASN.1 notation; however, <a href="#appendix-A.1">Appendix</a>
   <a href="#appendix-A.1">A.1</a> takes precedence in case of conflict.

<span class="h1"><a class="selflink" href="#appendix-A.1" name="appendix-A.1">A.1</a>.  1988 ASN.1 Module</span>

   CMSECCAlgs-2009-88
     { iso(1) member-body(2) us(840) rsadsi(113549) pkcs(1) pkcs-9(9)
       smime(16) modules(0) id-mod-cms-ecc-alg-2009-88(45) }

   DEFINITIONS IMPLICIT TAGS ::=

   BEGIN

   -- EXPORTS ALL

   IMPORTS

   -- From [<a href="#ref-PKI" title='"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"'>PKI</a>]

   AlgorithmIdentifier
     FROM PKIX1Explicit88
       { iso(1) identified-organization(3) dod(6)
         internet(1) security(5) mechanisms(5) pkix(7) mod(0)
         pkix1-explicit(18) }

   -- From [<a href="#ref-RSAOAEP" title='"Additional Algorithms and Identifiers for RSA Cryptography for use in the Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"'>RSAOAEP</a>]

   id-sha224, id-sha256, id-sha384, id-sha512
     FROM PKIX1-PSS-OAEP-Algorithms
       { iso(1) identified-organization(3) dod(6) internet(1)
         security(5) mechanisms(5) pkix(7) id-mod(0)
         id-mod-pkix1-rsa-pkalgs(33) }









<span class="grey">Turner &amp; Brown                Informational                    [Page 37]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-38" id="page-38" name="page-38"> </a>
<span class="grey"><a href="rfc5753.html">RFC 5753</a>              Use of ECC Algorithms in CMS          January 2010</span>


   -- From [<a href="#ref-PKI-ALG" title='"Elliptic Curve Cryptography Subject Public Key Information"'>PKI-ALG</a>]

   id-sha1, ecdsa-with-SHA1, ecdsa-with-SHA224,
   ecdsa-with-SHA256, ecdsa-with-SHA384, ecdsa-with-SHA512,
   id-ecPublicKey, ECDSA-Sig-Value, ECPoint, ECParameters
     FROM PKIX1Algorithms2008
       { iso(1) identified-organization(3) dod(6) internet(1)
         security(5) mechanisms(5) pkix(7) id-mod(0) 45 }

   -- From [<a href="#ref-CMS" title='"Cryptographic Message Syntax (CMS)"'>CMS</a>]

   OriginatorPublicKey, UserKeyingMaterial
     FROM CryptographicMessageSyntax2004
       { iso(1) member-body(2) us(840) rsadsi(113549) pkcs(1) pkcs-9(9)
         smime(16) modules(0) cms-2004(24) }

   -- From [<a href="#ref-CMS-ALG" title='"Cryptographic Message Syntax (CMS) Algorithms"'>CMS-ALG</a>]

   hMAC-SHA1, des-ede3-cbc, id-alg-CMS3DESwrap, CBCParameter
     FROM CryptographicMessageSyntaxAlgorithms
       { iso(1) member-body(2) us(840) rsadsi(113549) pkcs(1) pkcs-9(9)
         smime(16) modules(0) cmsalg-2001(16) }

   -- From [<a href="#ref-CMS-AES" title='"Use of the Advanced Encryption Standard (AES) Encryption Algorithm in Cryptographic Message Syntax (CMS)"'>CMS-AES</a>]

   id-aes128-CBC, id-aes192-CBC, id-aes256-CBC, AES-IV,
   id-aes128-wrap, id-aes192-wrap, id-aes256-wrap
     FROM CMSAesRsaesOaep
       { iso(1) member-body(2) us(840) rsadsi(113549) pkcs(1) pkcs-9(9)
         smime(16) modules(0) id-mod-cms-aes(19) }

   -- From [<a href="#ref-CMS-AESCG" title='"Using AES-CCM and AES-GCM Authenticated Encryption in the Cryptographic Message Syntax (CMS)"'>CMS-AESCG</a>]

   id-aes128-CCM, id-aes192-CCM, id-aes256-CCM, CCMParameters
   id-aes128-GCM, id-aes192-GCM, id-aes256-GCM, GCMParameters
     FROM CMS-AES-CCM-and-AES-GCM
       { iso(1) member-body(2) us(840) rsadsi(113549) pkcs(1) pkcs-9(9)
         smime(16) modules(0) id-mod-cms-aes(32) }

   ;

   --
   -- Message Digest Algorithms: Imported from [<a href="#ref-PKI-ALG" title='"Elliptic Curve Cryptography Subject Public Key Information"'>PKI-ALG</a>] and [<a href="#ref-RSAOAEP" title='"Additional Algorithms and Identifiers for RSA Cryptography for use in the Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"'>RSAOAEP</a>]
   --

   -- id-sha1 Parameters are preferred absent
   -- id-sha224 Parameters are preferred absent
   -- id-sha256 Parameters are preferred absent



<span class="grey">Turner &amp; Brown                Informational                    [Page 38]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-39" id="page-39" name="page-39"> </a>
<span class="grey"><a href="rfc5753.html">RFC 5753</a>              Use of ECC Algorithms in CMS          January 2010</span>


   -- id-sha384 Parameters are preferred absent
   -- id-sha512 Parameters are preferred absent

   --
   -- Signature Algorithms: Imported from [<a href="#ref-PKI-ALG" title='"Elliptic Curve Cryptography Subject Public Key Information"'>PKI-ALG</a>]
   --

   -- ecdsa-with-SHA1 Parameters are NULL
   -- ecdsa-with-SHA224 Parameters are absent
   -- ecdsa-with-SHA256 Parameters are absent
   -- ecdsa-with-SHA384 Parameters are absent
   -- ecdsa-with-SHA512 Parameters are absent

   -- ECDSA Signature Value
   -- Contents of SignatureValue OCTET STRING

   -- ECDSA-Sig-Value ::= SEQUENCE {
   --   r  INTEGER,
   --   s  INTEGER
   -- }

   --
   -- Key Agreement Algorithms
   --

   x9-63-scheme OBJECT IDENTIFIER ::= {
     iso(1) identified-organization(3) tc68(133) country(16) x9(840)
     x9-63(63) schemes(0) }
   secg-scheme OBJECT IDENTIFIER ::= {
     iso(1) identified-organization(3) certicom(132) schemes(1) }

   --
   -- Diffie-Hellman Single Pass, Standard, with KDFs
   --

   -- Parameters are always present and indicate the key wrap algorithm
   -- with KeyWrapAlgorithm.

   dhSinglePass-stdDH-sha1kdf-scheme OBJECT IDENTIFIER ::= {
     x9-63-scheme 2 }

   dhSinglePass-stdDH-sha224kdf-scheme OBJECT IDENTIFIER ::= {
     secg-scheme 11 0 }

   dhSinglePass-stdDH-sha256kdf-scheme OBJECT IDENTIFIER ::= {
     secg-scheme 11 1 }





<span class="grey">Turner &amp; Brown                Informational                    [Page 39]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-40" id="page-40" name="page-40"> </a>
<span class="grey"><a href="rfc5753.html">RFC 5753</a>              Use of ECC Algorithms in CMS          January 2010</span>


   dhSinglePass-stdDH-sha384kdf-scheme OBJECT IDENTIFIER ::= {
     secg-scheme 11 2 }

   dhSinglePass-stdDH-sha512kdf-scheme OBJECT IDENTIFIER ::= {
     secg-scheme 11 3 }

   --
   -- Diffie-Hellman Single Pass, Cofactor, with KDFs
   --

   dhSinglePass-cofactorDH-sha1kdf-scheme OBJECT IDENTIFIER ::= {
     x9-63-scheme 3 }

   dhSinglePass-cofactorDH-sha224kdf-scheme OBJECT IDENTIFIER ::= {
     secg-scheme 14 0 }

   dhSinglePass-cofactorDH-sha256kdf-scheme OBJECT IDENTIFIER ::= {
     secg-scheme 14 1 }

   dhSinglePass-cofactorDH-sha384kdf-scheme OBJECT IDENTIFIER ::= {
     secg-scheme 14 2 }

   dhSinglePass-cofactorDH-sha512kdf-scheme OBJECT IDENTIFIER ::= {
     secg-scheme 14 3 }

   --
   -- MQV Single Pass, Cofactor, with KDFs
   --

   mqvSinglePass-sha1kdf-scheme OBJECT IDENTIFIER ::= {
     x9-63-scheme 16 }

   mqvSinglePass-sha224kdf-scheme OBJECT IDENTIFIER ::= {
     secg-scheme 15 0 }

   mqvSinglePass-sha256kdf-scheme OBJECT IDENTIFIER ::= {
     secg-scheme 15 1 }

   mqvSinglePass-sha384kdf-scheme OBJECT IDENTIFIER ::= {
     secg-scheme 15 2 }

   mqvSinglePass-sha512kdf-scheme OBJECT IDENTIFIER ::= {
     secg-scheme 15 3 }

   --
   -- Key Wrap Algorithms: Imported from [<a href="#ref-CMS-ALG" title='"Cryptographic Message Syntax (CMS) Algorithms"'>CMS-ALG</a>] and [<a href="#ref-CMS-AES" title='"Use of the Advanced Encryption Standard (AES) Encryption Algorithm in Cryptographic Message Syntax (CMS)"'>CMS-AES</a>]
   --




<span class="grey">Turner &amp; Brown                Informational                    [Page 40]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-41" id="page-41" name="page-41"> </a>
<span class="grey"><a href="rfc5753.html">RFC 5753</a>              Use of ECC Algorithms in CMS          January 2010</span>


   KeyWrapAlgorithm ::= AlgorithmIdentifier

   -- id-alg-CMS3DESwrap Parameters are NULL
   -- id-aes128-wrap Parameters are absent
   -- id-aes192-wrap Parameters are absent
   -- id-aes256-wrap Parameters are absent

   --
   -- Content Encryption Algorithms: Imported from [<a href="#ref-CMS-ALG" title='"Cryptographic Message Syntax (CMS) Algorithms"'>CMS-ALG</a>]
   -- and [<a href="#ref-CMS-AES" title='"Use of the Advanced Encryption Standard (AES) Encryption Algorithm in Cryptographic Message Syntax (CMS)"'>CMS-AES</a>]
   --

   -- des-ede3-cbc Parameters are CBCParameter
   -- id-aes128-CBC Parameters are AES-IV
   -- id-aes192-CBC Parameters are AES-IV
   -- id-aes256-CBC Parameters are AES-IV
   -- id-aes128-CCM Parameters are CCMParameters
   -- id-aes192-CCM Parameters are CCMParameters
   -- id-aes256-CCM Parameters are CCMParameters
   -- id-aes128-GCM Parameters are GCMParameters
   -- id-aes192-GCM Parameters are GCMParameters
   -- id-aes256-GCM Parameters are GCMParameters

   --
   -- Message Authentication Code Algorithms
   --

   -- hMAC-SHA1 Parameters are preferred absent

   -- HMAC with SHA-224, SHA-256, SHA_384, and SHA-512 Parameters are
   -- absent

   id-hmacWithSHA224 OBJECT IDENTIFIER ::= {
     iso(1) member-body(2) us(840) rsadsi(113549)
     digestAlgorithm(2) 8 }

   id-hmacWithSHA256 OBJECT IDENTIFIER ::= {
     iso(1) member-body(2) us(840) rsadsi(113549)
     digestAlgorithm(2) 9 }

   id-hmacWithSHA384 OBJECT IDENTIFIER ::= {
     iso(1) member-body(2) us(840) rsadsi(113549)
     digestAlgorithm(2) 10 }

   id-hmacWithSHA512 OBJECT IDENTIFIER ::= {
     iso(1) member-body(2) us(840) rsadsi(113549)
     digestAlgorithm(2) 11 }




<span class="grey">Turner &amp; Brown                Informational                    [Page 41]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-42" id="page-42" name="page-42"> </a>
<span class="grey"><a href="rfc5753.html">RFC 5753</a>              Use of ECC Algorithms in CMS          January 2010</span>


   --
   -- Originator Public Key Algorithms: Imported from [<a href="#ref-PKI-ALG" title='"Elliptic Curve Cryptography Subject Public Key Information"'>PKI-ALG</a>]
   --

   -- id-ecPublicKey Parameters are absent, NULL, or ECParameters

   -- Format for both ephemeral and static public keys: Imported from
   -- [<a href="#ref-PKI-ALG" title='"Elliptic Curve Cryptography Subject Public Key Information"'>PKI-ALG</a>]

   -- ECPoint ::= OCTET STRING

   -- ECParameters ::= CHOICE {
   --   namedCurve      OBJECT IDENTIFIER
   --   commented out in [<a href="#ref-PKI-ALG" title='"Elliptic Curve Cryptography Subject Public Key Information"'>PKI-ALG</a>]  implicitCurve   NULL
   --   commented out in [<a href="#ref-PKI-ALG" title='"Elliptic Curve Cryptography Subject Public Key Information"'>PKI-ALG</a>]  specifiedCurve  SpecifiedECDomain
   --   commented out in [<a href="#ref-PKI-ALG" title='"Elliptic Curve Cryptography Subject Public Key Information"'>PKI-ALG</a>]  ...
   -- }
       -- implicitCurve and specifiedCurve MUST NOT be used in PKIX.
       -- Details for SpecifiedECDomain can be found in [<a href="#ref-X9.62" title='"Public Key Cryptography for the Financial Services Industry: The Elliptic Curve Digital Signature Standard (ECDSA)"'>X9.62</a>].
       -- Any future additions to this CHOICE should be coordinated
       -- with ANSI X9.

   -- Format of KeyAgreeRecipientInfo ukm field when used with
   -- ECMQV

   MQVuserKeyingMaterial ::= SEQUENCE {
     ephemeralPublicKey       OriginatorPublicKey,
     addedukm             [0] EXPLICIT UserKeyingMaterial OPTIONAL
   }

   -- 'SharedInfo' for input to KDF when using ECDH and ECMQV with
   -- EnvelopedData, AuthenticatedData, or AuthEnvelopedData

   ECC-CMS-SharedInfo ::= SEQUENCE {
     keyInfo         AlgorithmIdentifier,
     entityUInfo [0] EXPLICIT OCTET STRING OPTIONAL,
     suppPubInfo [2] EXPLICIT OCTET STRING
   }

   --
   -- S/MIME Capabilities
   -- An identifier followed by type.
   --








<span class="grey">Turner &amp; Brown                Informational                    [Page 42]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-43" id="page-43" name="page-43"> </a>
<span class="grey"><a href="rfc5753.html">RFC 5753</a>              Use of ECC Algorithms in CMS          January 2010</span>


   --
   -- S/MIME Capabilities: Message Digest Algorithms
   --

   -- Found in [<a href="#ref-CMS-SHA2" title='"Using SHA2 Algorithms with Cryptographic Message Syntax"'>CMS-SHA2</a>].

   --
   -- S/MIME Capabilities: Signature Algorithms
   --

   -- ecdsa-with-SHA1 Type NULL
   -- ecdsa-with-SHA224 Type absent
   -- ecdsa-with-SHA256 Type absent
   -- ecdsa-with-SHA384 Type absent
   -- ecdsa-with-SHA512 Type absent

   --
   -- S/MIME Capabilities: ECDH, Single Pass, Standard
   --

   -- dhSinglePass-stdDH-sha1kdf Type is the KeyWrapAlgorithm
   -- dhSinglePass-stdDH-sha224kdf Type is the KeyWrapAlgorithm
   -- dhSinglePass-stdDH-sha256kdf Type is the KeyWrapAlgorithm
   -- dhSinglePass-stdDH-sha384kdf Type is the KeyWrapAlgorithm
   -- dhSinglePass-stdDH-sha512kdf Type is the KeyWrapAlgorithm


   --
   -- S/MIME Capabilities: ECDH, Single Pass, Cofactor
   --

   -- dhSinglePass-cofactorDH-sha1kdf Type is the KeyWrapAlgorithm
   -- dhSinglePass-cofactorDH-sha224kdf Type is the KeyWrapAlgorithm
   -- dhSinglePass-cofactorDH-sha256kdf Type is the KeyWrapAlgorithm
   -- dhSinglePass-cofactorDH-sha384kdf Type is the KeyWrapAlgorithm
   -- dhSinglePass-cofactorDH-sha512kdf Type is the KeyWrapAlgorithm

   --
   -- S/MIME Capabilities: ECMQV, Single Pass, Standard
   --

   -- mqvSinglePass-sha1kdf Type is the KeyWrapAlgorithm
   -- mqvSinglePass-sha224kdf Type is the KeyWrapAlgorithm
   -- mqvSinglePass-sha256kdf Type is the KeyWrapAlgorithm
   -- mqvSinglePass-sha384kdf Type is the KeyWrapAlgorithm
   -- mqvSinglePass-sha512kdf Type is the KeyWrapAlgorithm





<span class="grey">Turner &amp; Brown                Informational                    [Page 43]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-44" id="page-44" name="page-44"> </a>
<span class="grey"><a href="rfc5753.html">RFC 5753</a>              Use of ECC Algorithms in CMS          January 2010</span>


   --
   -- S/MIME Capabilities: Message Authentication Code Algorithms
   --

   -- hMACSHA1 Type is preferred absent
   -- id-hmacWithSHA224 Type is absent
   -- if-hmacWithSHA256 Type is absent
   -- id-hmacWithSHA384 Type is absent
   -- id-hmacWithSHA512 Type is absent

   END








































<span class="grey">Turner &amp; Brown                Informational                    [Page 44]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-45" id="page-45" name="page-45"> </a>
<span class="grey"><a href="rfc5753.html">RFC 5753</a>              Use of ECC Algorithms in CMS          January 2010</span>


<span class="h1"><a class="selflink" href="#appendix-A.2" name="appendix-A.2">A.2</a>.  2004 ASN.1 Module</span>

CMSECCAlgs-2009-02
  { iso(1) member-body(2) us(840) rsadsi(113549) pkcs(1) pkcs-9(9)
    smime(16) modules(0) id-mod-cms-ecc-alg-2009-02(46) }

DEFINITIONS IMPLICIT TAGS ::=

BEGIN

-- EXPORTS ALL

IMPORTS

-- From [<a href="#ref-PKI-ASN" title='"New ASN.1 Modules for PKIX"'>PKI-ASN</a>]

mda-sha1, sa-ecdsaWithSHA1, sa-ecdsaWithSHA224, sa-ecdsaWithSHA256,
sa-ecdsaWithSHA384, sa-ecdsaWithSHA512, id-ecPublicKey,
ECDSA-Sig-Value, ECPoint, ECParameters
  FROM PKIXAlgs-2009
    { iso(1) identified-organization(3) dod(6) internet(1)
      security(5) mechanisms(5) pkix(7) id-mod(0)
      id-mod-pkix1-algorithms2008-02(56) }

-- From [<a href="#ref-PKI-ASN" title='"New ASN.1 Modules for PKIX"'>PKI-ASN</a>]

mda-sha224, mda-sha256, mda-sha384, mda-sha512
  FROM PKIX1-PSS-OAEP-Algorithms-2009
    { iso(1) identified-organization(3) dod(6) internet(1)
      security(5) mechanisms(5) pkix(7) id-mod(0)
      id-mod-pkix1-rsa-pkalgs-02(54) }

-- FROM [<a href="#ref-CMS-ASN" title='"New ASN.1 Modules for CMS and S/MIME"'>CMS-ASN</a>]

KEY-WRAP, SIGNATURE-ALGORITHM, DIGEST-ALGORITHM, ALGORITHM,
PUBLIC-KEY, MAC-ALGORITHM, CONTENT-ENCRYPTION, KEY-AGREE, SMIME-CAPS,
AlgorithmIdentifier{}
  FROM AlgorithmInformation-2009
    { iso(1) identified-organization(3) dod(6) internet(1)
      security(5) mechanisms(5) pkix(7) id-mod(0)
      id-mod-algorithmInformation-02(58) }

-- From [<a href="#ref-CMS-ASN" title='"New ASN.1 Modules for CMS and S/MIME"'>CMS-ASN</a>]

OriginatorPublicKey, UserKeyingMaterial
  FROM CryptographicMessageSyntax-2009
    { iso(1) member-body(2) us(840) rsadsi(113549) pkcs(1) pkcs-9(9)
      smime(16) modules(0) id-mod-cms-2004-02(41) }



<span class="grey">Turner &amp; Brown                Informational                    [Page 45]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-46" id="page-46" name="page-46"> </a>
<span class="grey"><a href="rfc5753.html">RFC 5753</a>              Use of ECC Algorithms in CMS          January 2010</span>


-- From [<a href="#ref-CMS-ASN" title='"New ASN.1 Modules for CMS and S/MIME"'>CMS-ASN</a>]

maca-hMAC-SHA1, cea-3DES-cbc, kwa-3DESWrap, CBCParameter
  FROM CryptographicMessageSyntaxAlgorithms-2009
    { iso(1) member-body(2) us(840) rsadsi(113549) pkcs(1) pkcs-9(9)
      smime(16) modules(0) id-mod-cmsalg-2001-02(37) }

-- From [<a href="#ref-CMS-ASN" title='"New ASN.1 Modules for CMS and S/MIME"'>CMS-ASN</a>]

cea-aes128-cbc, cea-aes192-cbc, cea-aes256-cbc, kwa-aes128-wrap,
kwa-aes192-wrap, kwa-aes256-wrap
  FROM CMSAesRsaesOaep-2009
    { iso(1) member-body(2) us(840) rsadsi(113549) pkcs(1) pkcs-9(9)
      smime(16) modules(0) id-mod-cms-aes-02(38) }

-- From [<a href="#ref-CMS-ASN" title='"New ASN.1 Modules for CMS and S/MIME"'>CMS-ASN</a>]

cea-aes128-CCM, cea-aes192-CCM, cea-aes256-CCM, cea-aes128-GCM,
cea-aes192-GCM, cea-aes256-GCM
  FROM CMS-AES-CCM-and-AES-GCM-2009
    { iso(1) member-body(2) us(840) rsadsi(113549) pkcs(1) pkcs-9(9)
      smime(16) modules(0) id-mod-cms-aes-ccm-gcm-02(44) }

;

-- Constrains the SignedData digestAlgorithms field
-- Constrains the SignedData SignerInfo digestAlgorithm field
-- Constrains the AuthenticatedData digestAlgorithm field

-- Message Digest Algorithms: Imported from [<a href="#ref-PKI-ASN" title='"New ASN.1 Modules for PKIX"'>PKI-ASN</a>]

-- MessageDigestAlgs DIGEST-ALGORITHM ::= {
--  mda-sha1   |
--  mda-sha224 |
--  mda-sha256 |
--  mda-sha384 |
--  mda-sha512,
--  ...
-- }

-- Constrains the SignedData SignerInfo signatureAlgorithm field

-- Signature Algorithms: Imported from [<a href="#ref-PKI-ASN" title='"New ASN.1 Modules for PKIX"'>PKI-ASN</a>]

-- SignatureAlgs SIGNATURE-ALGORITHM ::= {
--  sa-ecdsaWithSHA1   |
--  sa-ecdsaWithSHA224 |
--  sa-ecdsaWithSHA256 |



<span class="grey">Turner &amp; Brown                Informational                    [Page 46]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-47" id="page-47" name="page-47"> </a>
<span class="grey"><a href="rfc5753.html">RFC 5753</a>              Use of ECC Algorithms in CMS          January 2010</span>


--  sa-ecdsaWithSHA384 |
--  sa-ecdsaWithSHA512,
--  ...
-- }

-- ECDSA Signature Value: Imported from [<a href="#ref-PKI-ALG" title='"Elliptic Curve Cryptography Subject Public Key Information"'>PKI-ALG</a>]
-- Contents of SignatureValue OCTET STRING

-- ECDSA-Sig-Value ::= SEQUENCE {
--   r  INTEGER,
--   s  INTEGER
-- }

--
-- Key Agreement Algorithms
--

-- Constrains the EnvelopedData RecipientInfo KeyAgreeRecipientInfo
--   keyEncryption Algorithm field
-- Constrains the AuthenticatedData RecipientInfo
--   KeyAgreeRecipientInfo keyEncryption Algorithm field
-- Constrains the AuthEnvelopedData RecipientInfo
--   KeyAgreeRecipientInfo keyEncryption Algorithm field

-- DH variants are not used with AuthenticatedData or
-- AuthEnvelopedData

KeyAgreementAlgs KEY-AGREE ::= {
  kaa-dhSinglePass-stdDH-sha1kdf-scheme        |
  kaa-dhSinglePass-stdDH-sha224kdf-scheme      |
  kaa-dhSinglePass-stdDH-sha256kdf-scheme      |
  kaa-dhSinglePass-stdDH-sha384kdf-scheme      |
  kaa-dhSinglePass-stdDH-sha512kdf-scheme      |
  kaa-dhSinglePass-cofactorDH-sha1kdf-scheme   |
  kaa-dhSinglePass-cofactorDH-sha224kdf-scheme |
  kaa-dhSinglePass-cofactorDH-sha256kdf-scheme |
  kaa-dhSinglePass-cofactorDH-sha384kdf-scheme |
  kaa-dhSinglePass-cofactorDH-sha512kdf-scheme |
  kaa-mqvSinglePass-sha1kdf-scheme             |
  kaa-mqvSinglePass-sha224kdf-scheme           |
  kaa-mqvSinglePass-sha256kdf-scheme           |
  kaa-mqvSinglePass-sha384kdf-scheme           |
  kaa-mqvSinglePass-sha512kdf-scheme,
  ...
}






<span class="grey">Turner &amp; Brown                Informational                    [Page 47]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-48" id="page-48" name="page-48"> </a>
<span class="grey"><a href="rfc5753.html">RFC 5753</a>              Use of ECC Algorithms in CMS          January 2010</span>


x9-63-scheme OBJECT IDENTIFIER ::= {
  iso(1) identified-organization(3) tc68(133) country(16) x9(840)
  x9-63(63) schemes(0) }

secg-scheme OBJECT IDENTIFIER ::= {
  iso(1) identified-organization(3) certicom(132) schemes(1) }

--
-- Diffie-Hellman Single Pass, Standard, with KDFs
--

-- Parameters are always present and indicate the Key Wrap Algorithm

kaa-dhSinglePass-stdDH-sha1kdf-scheme KEY-AGREE ::= {
  IDENTIFIER dhSinglePass-stdDH-sha1kdf-scheme
  PARAMS TYPE KeyWrapAlgorithm ARE required
  UKM -- TYPE unencoded data -- ARE preferredPresent
  SMIME-CAPS cap-kaa-dhSinglePass-stdDH-sha1kdf-scheme
}

dhSinglePass-stdDH-sha1kdf-scheme OBJECT IDENTIFIER ::= {
  x9-63-scheme 2 }

kaa-dhSinglePass-stdDH-sha224kdf-scheme KEY-AGREE ::= {
  IDENTIFIER dhSinglePass-stdDH-sha224kdf-scheme
  PARAMS TYPE KeyWrapAlgorithm ARE required
  UKM -- TYPE unencoded data -- ARE preferredPresent
  SMIME-CAPS cap-kaa-dhSinglePass-stdDH-sha224kdf-scheme
}

dhSinglePass-stdDH-sha224kdf-scheme OBJECT IDENTIFIER ::= {
  secg-scheme 11 0 }

kaa-dhSinglePass-stdDH-sha256kdf-scheme KEY-AGREE ::= {
  IDENTIFIER dhSinglePass-stdDH-sha256kdf-scheme
  PARAMS TYPE KeyWrapAlgorithm ARE required
  UKM -- TYPE unencoded data -- ARE preferredPresent
  SMIME-CAPS cap-kaa-dhSinglePass-stdDH-sha256kdf-scheme
}

dhSinglePass-stdDH-sha256kdf-scheme OBJECT IDENTIFIER ::= {
  secg-scheme 11 1 }









<span class="grey">Turner &amp; Brown                Informational                    [Page 48]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-49" id="page-49" name="page-49"> </a>
<span class="grey"><a href="rfc5753.html">RFC 5753</a>              Use of ECC Algorithms in CMS          January 2010</span>


kaa-dhSinglePass-stdDH-sha384kdf-scheme KEY-AGREE ::= {
  IDENTIFIER dhSinglePass-stdDH-sha384kdf-scheme
  PARAMS TYPE KeyWrapAlgorithm ARE required
  UKM -- TYPE unencoded data -- ARE preferredPresent
  SMIME-CAPS cap-kaa-dhSinglePass-stdDH-sha384kdf-scheme
}

dhSinglePass-stdDH-sha384kdf-scheme OBJECT IDENTIFIER ::= {
  secg-scheme 11 2 }

kaa-dhSinglePass-stdDH-sha512kdf-scheme KEY-AGREE ::= {
  IDENTIFIER dhSinglePass-stdDH-sha512kdf-scheme
  PARAMS TYPE KeyWrapAlgorithm ARE required
  UKM -- TYPE unencoded data -- ARE preferredPresent
  SMIME-CAPS cap-kaa-dhSinglePass-stdDH-sha512kdf-scheme
}

dhSinglePass-stdDH-sha512kdf-scheme OBJECT IDENTIFIER ::= {
  secg-scheme 11 3 }

--
-- Diffie-Hellman Single Pass, Cofactor, with KDFs
--

kaa-dhSinglePass-cofactorDH-sha1kdf-scheme KEY-AGREE ::= {
  IDENTIFIER dhSinglePass-cofactorDH-sha1kdf-scheme
  PARAMS TYPE KeyWrapAlgorithm ARE required
  UKM -- TYPE unencoded data -- ARE preferredPresent
  SMIME-CAPS cap-kaa-dhSinglePass-cofactorDH-sha1kdf-scheme
}

dhSinglePass-cofactorDH-sha1kdf-scheme OBJECT IDENTIFIER ::= {
  x9-63-scheme 3 }

kaa-dhSinglePass-cofactorDH-sha224kdf-scheme KEY-AGREE ::= {
  IDENTIFIER dhSinglePass-cofactorDH-sha224kdf-scheme
  PARAMS TYPE KeyWrapAlgorithm ARE required
  UKM -- TYPE unencoded data -- ARE preferredPresent
  SMIME-CAPS cap-kaa-dhSinglePass-cofactorDH-sha224kdf-scheme
}

dhSinglePass-cofactorDH-sha224kdf-scheme OBJECT IDENTIFIER ::= {
  secg-scheme 14 0 }








<span class="grey">Turner &amp; Brown                Informational                    [Page 49]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-50" id="page-50" name="page-50"> </a>
<span class="grey"><a href="rfc5753.html">RFC 5753</a>              Use of ECC Algorithms in CMS          January 2010</span>


kaa-dhSinglePass-cofactorDH-sha256kdf-scheme KEY-AGREE ::= {
  IDENTIFIER dhSinglePass-cofactorDH-sha256kdf-scheme
  PARAMS TYPE KeyWrapAlgorithm ARE required
  UKM -- TYPE unencoded data -- ARE preferredPresent
  SMIME-CAPS cap-kaa-dhSinglePass-cofactorDH-sha256kdf-scheme
}

dhSinglePass-cofactorDH-sha256kdf-scheme OBJECT IDENTIFIER ::= {
  secg-scheme 14 1 }

kaa-dhSinglePass-cofactorDH-sha384kdf-scheme KEY-AGREE ::= {
  IDENTIFIER dhSinglePass-cofactorDH-sha384kdf-scheme
  PARAMS TYPE KeyWrapAlgorithm ARE required
  UKM -- TYPE unencoded data -- ARE preferredPresent
  SMIME-CAPS cap-kaa-dhSinglePass-cofactorDH-sha384kdf-scheme
}

dhSinglePass-cofactorDH-sha384kdf-scheme OBJECT IDENTIFIER ::= {
  secg-scheme 14 2 }

kaa-dhSinglePass-cofactorDH-sha512kdf-scheme KEY-AGREE ::= {
  IDENTIFIER dhSinglePass-cofactorDH-sha512kdf-scheme
  PARAMS TYPE KeyWrapAlgorithm ARE required
  UKM -- TYPE unencoded data -- ARE preferredPresent
  SMIME-CAPS cap-kaa-dhSinglePass-cofactorDH-sha512kdf-scheme
}

dhSinglePass-cofactorDH-sha512kdf-scheme OBJECT IDENTIFIER ::= {
  secg-scheme 14 3 }

--
-- MQV Single Pass, Cofactor, with KDFs
--

kaa-mqvSinglePass-sha1kdf-scheme KEY-AGREE ::= {
  IDENTIFIER mqvSinglePass-sha1kdf-scheme
  PARAMS TYPE KeyWrapAlgorithm ARE required
  UKM -- TYPE unencoded data -- ARE preferredPresent
  SMIME-CAPS cap-kaa-mqvSinglePass-sha1kdf-scheme
}

mqvSinglePass-sha1kdf-scheme OBJECT IDENTIFIER ::= {
  x9-63-scheme 16 }








<span class="grey">Turner &amp; Brown                Informational                    [Page 50]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-51" id="page-51" name="page-51"> </a>
<span class="grey"><a href="rfc5753.html">RFC 5753</a>              Use of ECC Algorithms in CMS          January 2010</span>


kaa-mqvSinglePass-sha224kdf-scheme KEY-AGREE ::= {
  IDENTIFIER mqvSinglePass-sha224kdf-scheme
  PARAMS TYPE KeyWrapAlgorithm ARE required
  UKM -- TYPE unencoded data -- ARE preferredPresent
  SMIME-CAPS cap-kaa-mqvSinglePass-sha224kdf-scheme
}

mqvSinglePass-sha224kdf-scheme OBJECT IDENTIFIER ::= {
  secg-scheme 15 0 }

kaa-mqvSinglePass-sha256kdf-scheme KEY-AGREE ::= {
  IDENTIFIER mqvSinglePass-sha256kdf-scheme
  PARAMS TYPE KeyWrapAlgorithm ARE required
  UKM -- TYPE unencoded data -- ARE preferredPresent
  SMIME-CAPS cap-kaa-mqvSinglePass-sha256kdf-scheme
}

mqvSinglePass-sha256kdf-scheme OBJECT IDENTIFIER ::= {
  secg-scheme 15 1 }

kaa-mqvSinglePass-sha384kdf-scheme KEY-AGREE ::= {
  IDENTIFIER mqvSinglePass-sha384kdf-scheme
  PARAMS TYPE KeyWrapAlgorithm ARE required
  UKM -- TYPE unencoded data -- ARE preferredPresent
  SMIME-CAPS cap-kaa-mqvSinglePass-sha384kdf-scheme
}

mqvSinglePass-sha384kdf-scheme OBJECT IDENTIFIER ::= {
  secg-scheme 15 2 }

kaa-mqvSinglePass-sha512kdf-scheme KEY-AGREE ::= {
  IDENTIFIER mqvSinglePass-sha512kdf-scheme
  PARAMS TYPE KeyWrapAlgorithm ARE required
  UKM -- TYPE unencoded data -- ARE preferredPresent
  SMIME-CAPS cap-kaa-mqvSinglePass-sha512kdf-scheme
}

mqvSinglePass-sha512kdf-scheme OBJECT IDENTIFIER ::= {
  secg-scheme 15 3 }

--
-- Key Wrap Algorithms: Imported from [<a href="#ref-CMS-ASN" title='"New ASN.1 Modules for CMS and S/MIME"'>CMS-ASN</a>]
--








<span class="grey">Turner &amp; Brown                Informational                    [Page 51]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-52" id="page-52" name="page-52"> </a>
<span class="grey"><a href="rfc5753.html">RFC 5753</a>              Use of ECC Algorithms in CMS          January 2010</span>


KeyWrapAlgorithm ::= AlgorithmIdentifier { KEY-WRAP, { KeyWrapAlgs } }

KeyWrapAlgs KEY-WRAP ::= {
  kwa-3DESWrap    |
  kwa-aes128-wrap |
  kwa-aes192-wrap |
  kwa-aes256-wrap,
  ...
}

--
-- Content Encryption Algorithms: Imported from [<a href="#ref-CMS-ASN" title='"New ASN.1 Modules for CMS and S/MIME"'>CMS-ASN</a>]
--

-- Constrains the EnvelopedData EncryptedContentInfo encryptedContent
-- field and the AuthEnvelopedData EncryptedContentInfo
-- contentEncryptionAlgorithm field

-- ContentEncryptionAlgs CONTENT-ENCRYPTION ::= {
--   cea-3DES-cbc |
--   cea-aes128-cbc   |
--   cea-aes192-cbc   |
--   cea-aes256-cbc   |
--   cea-aes128-ccm   |
--   cea-aes192-ccm   |
--   cea-aes256-ccm   |
--   cea-aes128-gcm   |
--   cea-aes192-gcm   |
--   cea-aes256-gcm,
--   ...
--   }

-- des-ede3-cbc and aes*-cbc are used with EnvelopedData and
-- EncryptedData
-- aes*-ccm are used with AuthEnvelopedData
-- aes*-gcm are used with AuthEnvelopedData
-- (where * is 128, 192, and 256)

--
-- Message Authentication Code Algorithms
--

-- Constrains the AuthenticatedData
-- MessageAuthenticationCodeAlgorithm field
--






<span class="grey">Turner &amp; Brown                Informational                    [Page 52]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-53" id="page-53" name="page-53"> </a>
<span class="grey"><a href="rfc5753.html">RFC 5753</a>              Use of ECC Algorithms in CMS          January 2010</span>


MessageAuthAlgs MAC-ALGORITHM ::= {
--  maca-hMAC-SHA1 |
  maca-hMAC-SHA224 |
  maca-hMAC-SHA256 |
  maca-hMAC-SHA384 |
  maca-hMAC-SHA512,
  ...
}

maca-hMAC-SHA224 MAC-ALGORITHM ::= {
  IDENTIFIER id-hmacWithSHA224
  PARAMS ARE absent
  IS-KEYED-MAC TRUE
  SMIME-CAPS cap-hMAC-SHA224
}

id-hmacWithSHA224 OBJECT IDENTIFIER ::= {
  iso(1) member-body(2) us(840) rsadsi(113549)
  digestAlgorithm(2) 8 }

maca-hMAC-SHA256 MAC-ALGORITHM ::= {
  IDENTIFIER id-hmacWithSHA256
  PARAMS ARE absent
  IS-KEYED-MAC TRUE
  SMIME-CAPS cap-hMAC-SHA256
}

id-hmacWithSHA256 OBJECT IDENTIFIER ::= {
  iso(1) member-body(2) us(840) rsadsi(113549)
  digestAlgorithm(2) 9 }

maca-hMAC-SHA384 MAC-ALGORITHM ::= {
  IDENTIFIER id-hmacWithSHA384
  PARAMS ARE absent
  IS-KEYED-MAC TRUE
  SMIME-CAPS cap-hMAC-SHA384
}

id-hmacWithSHA384 OBJECT IDENTIFIER ::= {
  iso(1) member-body(2) us(840) rsadsi(113549)
  digestAlgorithm(2) 10 }

maca-hMAC-SHA512 MAC-ALGORITHM ::= {
  IDENTIFIER id-hmacWithSHA512
  PARAMS ARE absent
  IS-KEYED-MAC TRUE
  SMIME-CAPS cap-hMAC-SHA512
}



<span class="grey">Turner &amp; Brown                Informational                    [Page 53]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-54" id="page-54" name="page-54"> </a>
<span class="grey"><a href="rfc5753.html">RFC 5753</a>              Use of ECC Algorithms in CMS          January 2010</span>


id-hmacWithSHA512 OBJECT IDENTIFIER ::= {
  iso(1) member-body(2) us(840) rsadsi(113549)
  digestAlgorithm(2) 11 }

--
-- Originator Public Key Algorithms
--

-- Constraints on KeyAgreeRecipientInfo OriginatorIdentifierOrKey
-- OriginatorPublicKey algorithm field

OriginatorPKAlgorithms PUBLIC-KEY ::= {
  opka-ec,
  ...
}

opka-ec PUBLIC-KEY ::={
  IDENTIFIER id-ecPublicKey
  KEY ECPoint
  PARAMS TYPE CHOICE { n NULL, p ECParameters } ARE preferredAbsent
}

-- Format for both ephemeral and static public keys: Imported from
-- [<a href="#ref-PKI-ALG" title='"Elliptic Curve Cryptography Subject Public Key Information"'>PKI-ALG</a>]

-- ECPoint ::= OCTET STRING

-- ECParameters ::= CHOICE {
--   namedCurve      CURVE.&amp;id({NamedCurve})
--   commented out in [<a href="#ref-PKI-ALG" title='"Elliptic Curve Cryptography Subject Public Key Information"'>PKI-ALG</a>] implicitCurve   NULL
--   commented out in [<a href="#ref-PKI-ALG" title='"Elliptic Curve Cryptography Subject Public Key Information"'>PKI-ALG</a>] specifiedCurve  SpecifiedECDomain
--   commented out in [<a href="#ref-PKI-ALG" title='"Elliptic Curve Cryptography Subject Public Key Information"'>PKI-ALG</a>] ...
-- }
  -- implicitCurve and specifiedCurve MUST NOT be used in PKIX.
  -- Details for SpecifiedECDomain can be found in [<a href="#ref-X9.62" title='"Public Key Cryptography for the Financial Services Industry: The Elliptic Curve Digital Signature Standard (ECDSA)"'>X9.62</a>].
  -- Any future additions to this CHOICE should be coordinated
  -- with ANSI X.9.

-- Format of KeyAgreeRecipientInfo ukm field when used with
-- ECMQV

MQVuserKeyingMaterial ::= SEQUENCE {
  ephemeralPublicKey       OriginatorPublicKey,
  addedukm             [0] EXPLICIT UserKeyingMaterial OPTIONAL
}






<span class="grey">Turner &amp; Brown                Informational                    [Page 54]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-55" id="page-55" name="page-55"> </a>
<span class="grey"><a href="rfc5753.html">RFC 5753</a>              Use of ECC Algorithms in CMS          January 2010</span>


-- 'SharedInfo' for input to KDF when using ECDH and ECMQV with
-- EnvelopedData, AuthenticatedData, or AuthEnvelopedData

ECC-CMS-SharedInfo ::= SEQUENCE {
  keyInfo         KeyWrapAlgorithm,
  entityUInfo [0] EXPLICIT OCTET STRING OPTIONAL,
  suppPubInfo [2] EXPLICIT OCTET STRING
}

--
-- S/MIME CAPS for algorithms in this document
--







































<span class="grey">Turner &amp; Brown                Informational                    [Page 55]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-56" id="page-56" name="page-56"> </a>
<span class="grey"><a href="rfc5753.html">RFC 5753</a>              Use of ECC Algorithms in CMS          January 2010</span>


SMimeCAPS SMIME-CAPS ::= {
--  mda-sha1.&amp;smimeCaps                                   |
--  mda-sha224.&amp;smimeCaps                                 |
--  mda-sha256.&amp;smimeCaps                                 |
--  mda-sha384.&amp;smimeCaps                                 |
--  mda-sha512.&amp;smimeCaps                                 |
--  sa-ecdsaWithSHA1.&amp;smimeCaps                           |
--  sa-ecdsaWithSHA224.&amp;smimeCaps                         |
--  sa-ecdsaWithSHA256.&amp;smimeCaps                         |
--  sa-ecdsaWithSHA384.&amp;smimeCaps                         |
--  sa-ecdsaWithSHA512.&amp;smimeCaps                         |
  kaa-dhSinglePass-stdDH-sha1kdf-scheme.&amp;smimeCaps        |
  kaa-dhSinglePass-stdDH-sha224kdf-scheme.&amp;smimeCaps      |
  kaa-dhSinglePass-stdDH-sha256kdf-scheme.&amp;smimeCaps      |
  kaa-dhSinglePass-stdDH-sha384kdf-scheme.&amp;smimeCaps      |
  kaa-dhSinglePass-stdDH-sha512kdf-scheme.&amp;smimeCaps      |
  kaa-dhSinglePass-cofactorDH-sha1kdf-scheme.&amp;smimeCaps   |
  kaa-dhSinglePass-cofactorDH-sha224kdf-scheme.&amp;smimeCaps |
  kaa-dhSinglePass-cofactorDH-sha256kdf-scheme.&amp;smimeCaps |
  kaa-dhSinglePass-cofactorDH-sha384kdf-scheme.&amp;smimeCaps |
  kaa-dhSinglePass-cofactorDH-sha512kdf-scheme.&amp;smimeCaps |
  kaa-mqvSinglePass-sha1kdf-scheme.&amp;smimeCaps             |
  kaa-mqvSinglePass-sha224kdf-scheme.&amp;smimeCaps           |
  kaa-mqvSinglePass-sha256kdf-scheme.&amp;smimeCaps           |
  kaa-mqvSinglePass-sha384kdf-scheme.&amp;smimeCaps           |
  kaa-mqvSinglePass-sha512kdf-scheme.&amp;smimeCaps           |
--  kwa-3des.&amp;smimeCaps                                   |
--  kwa-aes128.&amp;smimeCaps                                 |
--  kwa-aes192.&amp;smimeCaps                                 |
--  kwa-aes256.&amp;smimeCaps                                 |
--  cea-3DES-cbc.&amp;smimeCaps                               |
--  cea-aes128-cbc.&amp;smimeCaps                             |
--  cea-aes192-cbc.&amp;smimeCaps                             |
--  cea-aes256-cbc.&amp;smimeCaps                             |
--  cea-aes128-ccm.&amp;smimeCaps                             |
--  cea-aes192-ccm.&amp;smimeCaps                             |
--  cea-aes256-ccm.&amp;smimeCaps                             |
--  cea-aes128-gcm.&amp;smimeCaps                             |
--  cea-aes192-gcm.&amp;smimeCaps                             |
--  cea-aes256-gcm.&amp;smimeCaps                             |
--  maca-hMAC-SHA1.&amp;smimeCaps                             |
  maca-hMAC-SHA224.&amp;smimeCaps                             |
  maca-hMAC-SHA256.&amp;smimeCaps                             |
  maca-hMAC-SHA384.&amp;smimeCaps                             |
  maca-hMAC-SHA512.&amp;smimeCaps,
  ...
}




<span class="grey">Turner &amp; Brown                Informational                    [Page 56]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-57" id="page-57" name="page-57"> </a>
<span class="grey"><a href="rfc5753.html">RFC 5753</a>              Use of ECC Algorithms in CMS          January 2010</span>


cap-kaa-dhSinglePass-stdDH-sha1kdf-scheme SMIME-CAPS ::= {
  TYPE KeyWrapAlgorithm
  IDENTIFIED BY dhSinglePass-stdDH-sha1kdf-scheme
}

cap-kaa-dhSinglePass-stdDH-sha224kdf-scheme SMIME-CAPS ::= {
  TYPE KeyWrapAlgorithm
  IDENTIFIED BY dhSinglePass-stdDH-sha224kdf-scheme
}

cap-kaa-dhSinglePass-stdDH-sha256kdf-scheme SMIME-CAPS ::= {
  TYPE KeyWrapAlgorithm
  IDENTIFIED BY dhSinglePass-stdDH-sha256kdf-scheme
}

cap-kaa-dhSinglePass-stdDH-sha384kdf-scheme SMIME-CAPS ::= {
   TYPE KeyWrapAlgorithm
   IDENTIFIED BY dhSinglePass-stdDH-sha384kdf-scheme
}

cap-kaa-dhSinglePass-stdDH-sha512kdf-scheme SMIME-CAPS ::= {
  TYPE KeyWrapAlgorithm
  IDENTIFIED BY dhSinglePass-stdDH-sha512kdf-scheme
}

cap-kaa-dhSinglePass-cofactorDH-sha1kdf-scheme SMIME-CAPS ::={
  TYPE KeyWrapAlgorithm
  IDENTIFIED BY dhSinglePass-cofactorDH-sha1kdf-scheme
}

cap-kaa-dhSinglePass-cofactorDH-sha224kdf-scheme SMIME-CAPS ::={
  TYPE KeyWrapAlgorithm
  IDENTIFIED BY dhSinglePass-cofactorDH-sha224kdf-scheme
}

cap-kaa-dhSinglePass-cofactorDH-sha256kdf-scheme SMIME-CAPS ::={
  TYPE KeyWrapAlgorithm
  IDENTIFIED BY dhSinglePass-cofactorDH-sha256kdf-scheme
}

cap-kaa-dhSinglePass-cofactorDH-sha384kdf-scheme SMIME-CAPS ::={
  TYPE KeyWrapAlgorithm
  IDENTIFIED BY dhSinglePass-cofactorDH-sha384kdf-scheme
}







<span class="grey">Turner &amp; Brown                Informational                    [Page 57]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-58" id="page-58" name="page-58"> </a>
<span class="grey"><a href="rfc5753.html">RFC 5753</a>              Use of ECC Algorithms in CMS          January 2010</span>


cap-kaa-dhSinglePass-cofactorDH-sha512kdf-scheme SMIME-CAPS ::={
  TYPE KeyWrapAlgorithm
  IDENTIFIED BY dhSinglePass-cofactorDH-sha512kdf-scheme
}

cap-kaa-mqvSinglePass-sha1kdf-scheme SMIME-CAPS ::={
  TYPE KeyWrapAlgorithm
  IDENTIFIED BY mqvSinglePass-sha1kdf-scheme
}

cap-kaa-mqvSinglePass-sha224kdf-scheme SMIME-CAPS ::={
  TYPE KeyWrapAlgorithm
  IDENTIFIED BY mqvSinglePass-sha224kdf-scheme
}

cap-kaa-mqvSinglePass-sha256kdf-scheme SMIME-CAPS ::={
  TYPE KeyWrapAlgorithm
  IDENTIFIED BY mqvSinglePass-sha256kdf-scheme
}

cap-kaa-mqvSinglePass-sha384kdf-scheme SMIME-CAPS ::={
  TYPE KeyWrapAlgorithm
  IDENTIFIED BY mqvSinglePass-sha384kdf-scheme
}

cap-kaa-mqvSinglePass-sha512kdf-scheme SMIME-CAPS ::={
  TYPE KeyWrapAlgorithm
  IDENTIFIED BY mqvSinglePass-sha512kdf-scheme
}

cap-hMAC-SHA224 SMIME-CAPS ::={ IDENTIFIED BY id-hmacWithSHA224 }

cap-hMAC-SHA256 SMIME-CAPS ::={ IDENTIFIED BY id-hmacWithSHA256 }

cap-hMAC-SHA384 SMIME-CAPS ::={ IDENTIFIED BY id-hmacWithSHA384 }

cap-hMAC-SHA512 SMIME-CAPS ::={ IDENTIFIED BY id-hmacWithSHA512 }

END












<span class="grey">Turner &amp; Brown                Informational                    [Page 58]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-59" id="page-59" name="page-59"> </a>
<span class="grey"><a href="rfc5753.html">RFC 5753</a>              Use of ECC Algorithms in CMS          January 2010</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/Appendix%20B.%20%20Changes%20since%20RFC%203278"></a><a class="selflink" href="#appendix-B" name="appendix-B">Appendix B</a>.  Changes since <a href="rfc3278.html">RFC 3278</a></span>

   The following summarizes the changes:

   - Abstract: The basis of the document was changed to refer to NIST
     FIPS 186-3 and SP800-56A.  However, to maintain backwards
     compatibility the Key Derivation Function from ANSI/SEC1 is
     retained.

   - <a href="#section-1">Section 1</a>: A bullet was added to address AuthEnvelopedData.

   - <a href="#section-2.1">Section 2.1</a>: A sentence was added to indicate FIPS180-3 is used
     with ECDSA.  Replaced reference to ANSI X9.62 with FIPS186-3.

   - <a href="#section-2.1.1">Section 2.1.1</a>: The permitted digest algorithms were expanded from
     SHA-1 to SHA-1, SHA-224, SHA-256, SHA-384, and SHA-512.

   - <a href="#section-2.1.2">Section 2.1.2</a> and 2.1.3: The bullet addressing integer "e" was
     deleted.

   - <a href="#section-3">Section 3</a>: Added explanation of why static-static ECDH is not
     included.

   - <a href="#section-3.1">Section 3.1</a>: The reference for DH was changed from <a href="rfc3852.html">RFC 3852</a> to <a href="rfc3370.html">RFC</a>
     <a href="rfc3370.html">3370</a>.  Provided text to indicate fields of EnvelopedData are as in
     CMS.

   - <a href="#section-3.1.1">Section 3.1.1</a>: The text was updated to include description of all
     KeyAgreeRecipientInfo fields.  Parameters for id-ecPublicKey field
     changed from NULL to absent or ECParameter.  Additional information
     about ukm was added.

   - <a href="#section-3.2">Section 3.2</a>: The sentence describing the advantages of 1-Pass ECMQV
     was rewritten.

   - <a href="#section-3.2.1">Section 3.2.1</a>: The text was updated to include description of all
     fields.  Parameters for id-ecPublicKey field changed from NULL to
     absent or ECParameters.

   - Sections <a href="#section-3.2.2">3.2.2</a> and <a href="#section-4.1.2">4.1.2</a>: The re-use of ephemeral keys paragraph
     was reworded.

   - <a href="#section-4.1">Section 4.1</a>:  The sentences describing the advantages of 1-Pass
     ECMQV was moved to <a href="#section-4">Section 4</a>.

   - <a href="#section-4.1.2">Section 4.1.2</a>: The note about the attack was moved to <a href="#section-4">Section 4</a>.





<span class="grey">Turner &amp; Brown                Informational                    [Page 59]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-60" id="page-60" name="page-60"> </a>
<span class="grey"><a href="rfc5753.html">RFC 5753</a>              Use of ECC Algorithms in CMS          January 2010</span>


   - <a href="#section-4.2">Section 4.2</a>: This section was added to address AuthEnvelopedData
     with ECMQV.

   - <a href="#section-5">Section 5</a>: This section was moved to <a href="#section-8">Section 8</a>.  The 1st paragraph
     was modified to recommend both SignedData and EnvelopedData.  The
     requirements were updated for hash algorithms and recommendations
     for matching curves and hash algorithms.  Also, the requirements
     were expanded to indicate which ECDH and ECMQV variants, key wrap
     algorithms, and content encryption algorithms are required for each
     of the content types used in this document.  The permitted digest
     algorithms used in KDFs were expanded from SHA-1 to SHA-1, SHA-224,
     SHA-256, SHA-384, and SHA-512.

   - <a href="#section-6">Section 6</a> (formerly 7): This section was updated to allow for
     SMIMECapabilities to be present in certificates.  The S/MIME
     capabilities for ECDSA with SHA-224, SHA-256, SHA-384, and SHA-512
     were added to the list of S/MIME Capabilities.  Also, updated to
     include S/MIME capabilities for ECDH and ECMQV using the SHA-224,
     SHA-256, SHA-384, and SHA-512 algorithms as the KDF.

   - <a href="#section-7.1">Section 7.1</a> (formerly 8.1): Added sub-sections for digest,
     signature, originator public key, key agreement, content
     encryption, key wrap, and message authentication code algorithms.
     Pointed to algorithms and parameters in appropriate documents for:
     SHA-224, SHA-256, SHA-384, and SHA-512 as well as SHA-224, SHA-256,
     SHA-384, and SHA-512 with ECDSA.  Also, added algorithm identifiers
     for ECDH std, ECDH cofactor, and ECMQV with SHA-224, SHA-256,
     SHA-384, and SHA-512 algorithms as the KDF.  Changed id-ecPublicKey
     parameters to be absent, NULL, or ECParameters, and if present the
     originator's ECParameters must match the recipient's ECParameters.

   - <a href="#section-7.2">Section 7.2</a> (formerly 8.2): Updated to include AuthEnvelopedData.
     Also, added text to address support requirement for compressed,
     uncompressed, and hybrid keys; changed pointers from ANSI X9.61 to
     PKIX (where ECDSA-Sig-Value is imported); changed pointers from
     SECG to NIST specs; and updated example of suppPubInfo to be
     AES-256.  keyInfo's parameters changed from NULL to any associated
     parameters (AES wraps have absent parameters).

   - <a href="#section-9">Section 9</a>: Replaced text, which was a summary paragraph, with an
     updated security considerations section.  Paragraph referring to
     definitions of SHA-224, SHA-256, SHA-384, and SHA-512 is deleted.

   - Updated references.

   - Added ASN.1 modules.

   - Updated acknowledgements section.



<span class="grey">Turner &amp; Brown                Informational                    [Page 60]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-61" id="page-61" name="page-61"> </a>
<span class="grey"><a href="rfc5753.html">RFC 5753</a>              Use of ECC Algorithms in CMS          January 2010</span>


Acknowledgements

   The methods described in this document are based on work done by the
   ANSI X9F1 working group.  The authors wish to extend their thanks to
   ANSI X9F1 for their assistance.  The authors also wish to thank Peter
   de Rooij for his patient assistance.  The technical comments of
   Francois Rousseau were valuable contributions.

   Many thanks go out to the other authors of <a href="rfc3278.html">RFC 3278</a>: Simon Blake-
   Wilson and Paul Lambert.  Without <a href="rfc3278.html">RFC 3278</a>, this version wouldn't
   exist.

   The authors also wish to thank Alfred Hoenes, Jonathan Herzog, Paul
   Hoffman, Russ Housley, and Jim Schaad for their valuable input.

Authors' Addresses

   Sean Turner
   IECA, Inc.
   3057 Nutley Street, Suite 106
   Fairfax, VA 22031
   USA

   EMail: turners@ieca.com


   Daniel R. L. Brown
   Certicom Corp
   5520 Explorer Drive #400
   Mississauga, ON L4W 5L1
   Canada

   EMail: dbrown@certicom.com


















Turner &amp; Brown                Informational                    [Page 61]

</pre><br/>
<span class="noprint"><small><small>Html markup produced by rfcmarkup 1.107, available from
<a href="http://tools.ietf.org/tools/rfcmarkup/">http://tools.ietf.org/tools/rfcmarkup/</a>
</small></small></span>


<meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

</body><!-- Mirrored from tools.ietf.org/html/rfc5753 by HTTrack Website Copier/3.x [XR&CO'2010], Wed, 19 Mar 2014 18:36:13 GMT --><!-- Added by HTTrack --></html>