<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head profile="http://dublincore.org/documents/2008/08/04/dc-html/">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="robots" content="index,follow" />
    <meta name="creator" content="rfcmarkup version 1.106" />
    <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" />
<meta name="DC.Relation.Replaces" content="draft-kelly-capwap-threat-analysis" />
<meta name="DC.Identifier" content="urn:ietf:rfc:5418" />
<meta name="DC.Date.Issued" content="March, 2009" />
<meta name="DC.Creator" content="Kelly, Scott" />
<meta name="DC.Creator" content="Clancy, T. Charles" />
<meta name="DC.Description.Abstract" content="Early Wireless Local Area Network (WLAN) deployments feature a &quot;fat&quot;\nAccess Point (AP), which serves as a \\%stand-alone interface between\nthe wired and wireless network segments. However, this model raises\nscaling, mobility, and manageability issues, and the Control and\nProvisioning of Wireless Access Points (CAPWAP) protocol is meant to\naddress these issues. CAPWAP effectively splits the fat AP\nfunctionality into two network elements, and the communication channel\nbetween these components may traverse potentially hostile hops. This\ndocument analyzes the security exposure resulting from the\nintroduction of CAPWAP and summarizes the associated security\nconsiderations for IEEE 802.11-based CAPWAP implementations and\ndeployments. This memo provides information for the Internet\ncommunity." />
<meta name="DC.Title" content="Control And Provisioning of Wireless Access Points (CAPWAP) Threat Analysis for IEEE 802.11 Deployments" />

    <link rel="icon" href="http://tools.ietf.org/images/rfc.png" type="image/png" />
    <link rel="shortcut icon" href="http://tools.ietf.org/images/rfc.png" type="image/png" />
    <title>RFC 5418 - Control And Provisioning of Wireless Access Points (CAPWAP) Threat Analysis for IEEE 802.11 Deployments</title>
    
    
    <style type="text/css">
	body {
	    margin: 0px 8px;
            font-size: 1em;
	}
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
   <div style="height: 13px;">
      <div onmouseover="this.style.cursor='pointer';"
         onclick="showElem('legend');"
         onmouseout="hideElem('legend')"
	 style="height: 6px; position: absolute;"
         class="pre noprint docinfo bgorange"
         title="Click for colour legend." >                                                                        </div>
      <div id="legend"
           class="docinfo noprint pre legend"
           style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; "
           onmouseover="showElem('legend');"
           onmouseout="hideElem('legend');">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="http://tools.ietf.org/rfc/rfc5418.txt" title="Plaintext version of this document">txt</a>|<a href="http://tools.ietf.org/pdf/rfc5418" title="PDF version of this document">pdf</a>] [<a href="http://tools.ietf.org/html/draft-ietf-capwap-threat-analysis" title="draft-ietf-capwap-threat-analysis">draft-ietf-capwap...</a>] [<a href="http://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc5418" title="Inline diff (wdiff)">Diff1</a>] [<a href="http://tools.ietf.org/rfcdiff?url2=rfc5418" title="Side-by-side diff">Diff2</a>]                 </span><br />
<span class="pre noprint docinfo">                                                                        </span><br />
<span class="pre noprint docinfo">                                                           INFORMATIONAL</span><br />
<span class="pre noprint docinfo">                                                                        </span><br />
<pre>
Network Working Group                                           S. Kelly
Request for Comments: 5418                                Aruba Networks
Category: Informational                                        T. Clancy
                                                                     LTS
                                                              March 2009


      <span class="h1">Control And Provisioning of Wireless Access Points (CAPWAP)</span>
              <span class="h1">Threat Analysis for IEEE 802.11 Deployments</span>

Status of This Memo

   This memo provides information for the Internet community.  It does
   not specify an Internet standard of any kind.  Distribution of this
   memo is unlimited.

Copyright Notice

   Copyright (c) 2009 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="http://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents in effect on the date of
   publication of this document (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>).
   Please review these documents carefully, as they describe your rights
   and restrictions with respect to this document.

   This document may contain material from IETF Documents or IETF
   Contributions published or made publicly available before November
   10, 2008.  The person(s) controlling the copyright in some of this
   material may not have granted the IETF Trust the right to allow
   modifications of such material outside the IETF Standards Process.
   Without obtaining an adequate license from the person(s) controlling
   the copyright in such materials, this document may not be modified
   outside the IETF Standards Process, and derivative works of it may
   not be created outside the IETF Standards Process, except to format
   it for publication as an RFC or to translate it into languages other
   than English.













<span class="grey">Kelly &amp; Clancy               Informational                      [Page 1]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-2" id="page-2" href="#page-2" class="invisible"> </a>
<span class="grey"><a href="rfc5418.html">RFC 5418</a>             CAPWAP 802.11 Threat Analysis            March 2009</span>


Abstract

   Early Wireless Local Area Network (WLAN) deployments feature a "fat"
   Access Point (AP), which serves as a stand-alone interface between
   the wired and wireless network segments.  However, this model raises
   scaling, mobility, and manageability issues, and the Control and
   Provisioning of Wireless Access Points (CAPWAP) protocol is meant to
   address these issues.  CAPWAP effectively splits the fat AP
   functionality into two network elements, and the communication
   channel between these components may traverse potentially hostile
   hops.  This document analyzes the security exposure resulting from
   the introduction of CAPWAP and summarizes the associated security
   considerations for IEEE 802.11-based CAPWAP implementations and
   deployments.

Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-4">4</a>
      <a href="#section-1.1">1.1</a>. Rationale for Limiting Analysis Scope to IEEE 802.11 .......<a href="#page-5">5</a>
      <a href="#section-1.2">1.2</a>. Notations ..................................................<a href="#page-6">6</a>
   <a href="#section-2">2</a>. Abbreviations and Definitions ...................................<a href="#page-7">7</a>
   <a href="#section-3">3</a>. CAPWAP Security Goals for IEEE 802.11 Deployments ...............<a href="#page-8">8</a>
   <a href="#section-4">4</a>. Overview of IEEE 802.11 and AAA Security ........................<a href="#page-8">8</a>
      <a href="#section-4.1">4.1</a>. IEEE 802.11 Authentication and AAA .........................<a href="#page-9">9</a>
      <a href="#section-4.2">4.2</a>. IEEE 802.11 Link Security .................................<a href="#page-11">11</a>
      <a href="#section-4.3">4.3</a>. AAA Security ..............................................<a href="#page-11">11</a>
      <a href="#section-4.4">4.4</a>. Cryptographic Bindings ....................................<a href="#page-12">12</a>
   <a href="#section-5">5</a>. Structure of the Analysis ......................................<a href="#page-13">13</a>
   <a href="#section-6">6</a>. Representative CAPWAP Deployment Scenarios .....................<a href="#page-14">14</a>
      <a href="#section-6.1">6.1</a>. Preliminary Definitions ...................................<a href="#page-14">14</a>
           <a href="#section-6.1.1">6.1.1</a>. Split MAC ..........................................<a href="#page-15">15</a>
           <a href="#section-6.1.2">6.1.2</a>. Local MAC ..........................................<a href="#page-15">15</a>
           <a href="#section-6.1.3">6.1.3</a>. Remote MAC .........................................<a href="#page-15">15</a>
           <a href="#section-6.1.4">6.1.4</a>. Data Tunneling .....................................<a href="#page-16">16</a>
      <a href="#section-6.2">6.2</a>. Example Scenarios .........................................<a href="#page-16">16</a>
           <a href="#section-6.2.1">6.2.1</a>. Localized Modular Deployment .......................<a href="#page-16">16</a>
           <a href="#section-6.2.2">6.2.2</a>. Internet Hotspot or Temporary Network ..............<a href="#page-17">17</a>
           <a href="#section-6.2.3">6.2.3</a>. Distributed Deployments ............................<a href="#page-18">18</a>
                  <a href="#section-6.2.3.1">6.2.3.1</a>. Large Physically Contained Organization ...<a href="#page-18">18</a>
                  <a href="#section-6.2.3.2">6.2.3.2</a>. Campus Deployments ........................<a href="#page-18">18</a>
                  <a href="#section-6.2.3.3">6.2.3.3</a>. Branch Offices ............................<a href="#page-18">18</a>
                  <a href="#section-6.2.3.4">6.2.3.4</a>. Telecommuter or Remote Office .............<a href="#page-19">19</a>
   <a href="#section-7">7</a>. General Adversary Capabilities .................................<a href="#page-19">19</a>
      <a href="#section-7.1">7.1</a>. Passive versus Active Adversaries .........................<a href="#page-20">20</a>
   <a href="#section-8">8</a>. Vulnerabilities Introduced by CAPWAP ...........................<a href="#page-22">22</a>
      <a href="#section-8.1">8.1</a>. The Session Establishment Phase ...........................<a href="#page-22">22</a>
           <a href="#section-8.1.1">8.1.1</a>. The Discovery Phase ................................<a href="#page-22">22</a>
           <a href="#section-8.1.2">8.1.2</a>. Forming an Association (Joining) ...................<a href="#page-23">23</a>



<span class="grey">Kelly &amp; Clancy               Informational                      [Page 2]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-3" id="page-3" href="#page-3" class="invisible"> </a>
<span class="grey"><a href="rfc5418.html">RFC 5418</a>             CAPWAP 802.11 Threat Analysis            March 2009</span>


      <a href="#section-8.2">8.2</a>. The Connected Phase .......................................<a href="#page-23">23</a>
   <a href="#section-9">9</a>. Adversary Goals in CAPWAP ......................................<a href="#page-24">24</a>
      <a href="#section-9.1">9.1</a>. Eavesdrop on AC-WTP Traffic ...............................<a href="#page-24">24</a>
      <a href="#section-9.2">9.2</a>. WTP Impersonation and/or Rootkit Installation .............<a href="#page-25">25</a>
      <a href="#section-9.3">9.3</a>. AC Impersonation and/or Rootkit Installation ..............<a href="#page-26">26</a>
      <a href="#section-9.4">9.4</a>. Other Goals or Sub-Goals ..................................<a href="#page-26">26</a>
   <a href="#section-10">10</a>. Countermeasures and Their Effects .............................<a href="#page-27">27</a>
      <a href="#section-10.1">10.1</a>. Communications Security Elements .........................<a href="#page-27">27</a>
           <a href="#section-10.1.1">10.1.1</a>. Mutual Authentication .............................<a href="#page-27">27</a>
                  <a href="#section-10.1.1.1">10.1.1.1</a>. Authorization ............................<a href="#page-27">27</a>
           <a href="#section-10.1.2">10.1.2</a>. Data Origin Authentication ........................<a href="#page-29">29</a>
           <a href="#section-10.1.3">10.1.3</a>. Data Integrity Verification .......................<a href="#page-29">29</a>
           <a href="#section-10.1.4">10.1.4</a>. Anti-Replay .......................................<a href="#page-29">29</a>
           <a href="#section-10.1.5">10.1.5</a>. Confidentiality ...................................<a href="#page-29">29</a>
      <a href="#section-10.2">10.2</a>. Putting the Elements Together ............................<a href="#page-30">30</a>
           <a href="#section-10.2.1">10.2.1</a>. Control Channel Security ..........................<a href="#page-30">30</a>
           <a href="#section-10.2.2">10.2.2</a>. Data Channel Security .............................<a href="#page-30">30</a>
   <a href="#section-11">11</a>. Countermeasures Provided by DTLS ..............................<a href="#page-30">30</a>
   <a href="#section-12">12</a>. Issues Not Addressed By DTLS ..................................<a href="#page-31">31</a>
      <a href="#section-12.1">12.1</a>. DoS Attacks ..............................................<a href="#page-31">31</a>
      <a href="#section-12.2">12.2</a>. Passive Monitoring (Sniffing) ............................<a href="#page-32">32</a>
      <a href="#section-12.3">12.3</a>. Traffic Analysis .........................................<a href="#page-32">32</a>
      <a href="#section-12.4">12.4</a>. Active MitM Interference .................................<a href="#page-32">32</a>
      <a href="#section-12.5">12.5</a>. Other Active Attacks .....................................<a href="#page-32">32</a>
   <a href="#section-13">13</a>. Security Considerations .......................................<a href="#page-32">32</a>
   <a href="#section-14">14</a>. Acknowledgements ..............................................<a href="#page-32">32</a>
   <a href="#section-15">15</a>. References ....................................................<a href="#page-33">33</a>
      <a href="#section-15.1">15.1</a>. Normative References .....................................<a href="#page-33">33</a>
      <a href="#section-15.2">15.2</a>. Informative References ...................................<a href="#page-33">33</a>






















<span class="grey">Kelly &amp; Clancy               Informational                      [Page 3]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-4" id="page-4" href="#page-4" class="invisible"> </a>
<span class="grey"><a href="rfc5418.html">RFC 5418</a>             CAPWAP 802.11 Threat Analysis            March 2009</span>


<span class="h2"><a class="selflink" name="section-1" href="#section-1">1</a>.  Introduction</span>

   Wireless Local Area Network (WLAN) deployments are increasingly
   common as the technology matures and wireless interface chips become
   standard equipment in laptops and various hand-held computing
   devices.  In the simplest deployments, WLAN access is entirely
   provided by a wireless Access Point (AP), which bridges the client
   system (station or "STA") and the Distribution System (DS) or wired
   network.

        +------+
        |client|         +--------+     |
        |(STA) |         | Access |     |    +------+
        +------+ ) ) ) ) | Point  |-----|   /optional\    +-------+
       /      /          +--------+     |--(    L3    )---|  AAA  |
      +------+                          |   \ cloud  /    +-------+
                                        |    +------+

                  Figure 1: IEEE 802.11 Deployment Using RSN

   In this architecture, the AP serves as a gatekeeper, facilitating
   client access to the network.  Typically, the client must somehow
   authenticate prior to being granted access, and in enterprise
   deployments, this is frequently accomplished using [<a href="#ref-8021X" title="&quot;IEEE Std 802.1X-2004: Port-based Network Access Control&quot;">8021X</a>].  When
   using IEEE 802.11, this mode is called a Robust Security Network
   (RSN) [<a href="#ref-80211I" title="&quot;IEEE Std 802.11i: WLAN Specification for Enhanced Security&quot;">80211I</a>].  Here, the client is called the "supplicant", the AP
   is the "authenticator", and either the AP or an external
   Authentication, Authorization, and Accounting (AAA) server fulfill
   the role of "authentication server", depending on the authentication
   mechanism used.

   From the perspective of the network administrator, the wired LAN to
   which the AP is attached is typically considered to be more trusted
   than the wireless LAN, either because there is some physical boundary
   around the wired segment (i.e., the building walls), or because it is
   otherwise secured somehow (perhaps cryptographically).  The AAA
   server may reside within this same physical administrative domain, or
   it may be remote.  Common AAA protocols are RADIUS [<a href="rfc3579.html" title="&quot;RADIUS (Remote Authentication Dial In User Service) Support For Extensible Authentication Protocol (EAP)&quot;">RFC3579</a>] and
   Diameter [<a href="rfc4072.html" title="&quot;Diameter Extensible Authentication Protocol (EAP) Application&quot;">RFC4072</a>].

   The CAPWAP protocol [<a href="rfc5415.html" title="&quot;Control And Provisioning of Wireless Access Points (CAPWAP) Protocol Specification&quot;">RFC5415</a>] modifies this architecture by splitting
   the AP into two pieces, the Wireless Termination Point (WTP), and the
   Access Controller (AC), and creating a communications link between
   the two new components.  In this model, the WTP implements the WLAN
   edge functions with respect to the user (wireless transmit/receive),
   while the AC implements the wired-side edge functions.  For a
   complete description of CAPWAP architecture, see [<a href="rfc4118.html" title="&quot;Architecture Taxonomy for Control and Provisioning of Wireless Access Points (CAPWAP)&quot;">RFC4118</a>].




<span class="grey">Kelly &amp; Clancy               Informational                      [Page 4]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-5" id="page-5" href="#page-5" class="invisible"> </a>
<span class="grey"><a href="rfc5418.html">RFC 5418</a>             CAPWAP 802.11 Threat Analysis            March 2009</span>


     +------+    +==========================+
     |client|    |           +---+          |   |    +------+
     |(STA) |    | +-----+  /  L3 \  +----+ |   |   /optional\   +-----+
     +------+ ) )|)| WTP |-( cloud )-| AC |-|---|--(    L3    )--| AAA |
    /      /     | +-----+  \     /  +----+ |   |   \ cloud  /   +-----+
   +------+      |           +---+          |   |    +------+
                 +==========================+
                    AP equivalence boundary

               Figure 2: WLAN Deployment utilizing CAPWAP

   For our purposes, it is useful to think of the entire CAPWAP system
   as a sort of "AP equivalent", and the figure above illustrates this
   concept.  With this model in mind, our ideal is to ensure that CAPWAP
   introduces no vulnerabilities that aren't present in the original fat
   AP scenario.  As we will see, this is not entirely possible, but from
   a security perspective, we should nonetheless strive to achieve this
   equivalence as nearly as we can.

<span class="h3"><a class="selflink" name="section-1.1" href="#section-1.1">1.1</a>.  Rationale for Limiting Analysis Scope to IEEE 802.11</span>

   Although CAPWAP derives from protocols that were designed explicitly
   for management of IEEE 802.11 wireless LANs, it may also turn out to
   be useful for managing other types of network device deployments,
   wireless and otherwise.  This might lead one to conclude that a
   single security analysis, except for minor per-binding variations,
   might be sufficient.  However, based on a limited number of
   additional related scenarios that have been described as likely
   candidates for CAPWAP thus far, e.g., use with Radio Frequency
   Identification (RFID) sensors, this does not seem to be a simple,
   binary decision.

   Contrasting RFID and IEEE 802.11 deployment scenarios, IEEE 802.11
   users typically authenticate to some a back-end AAA server, and as a
   result of that exchange, derive cryptographic keys that are used by
   the STA and WTP to encrypt and authenticate over-air communications.
   That is, the threat environment is such that the following typically
   holds:

   o  The user is not immediately trusted, and therefore must
      authenticate.

   o  The WTP is not immediately trusted, and therefore must indirectly
      authenticate to the user via the AAA server.

   o  The AAA server is not necessarily trusted, and therefore must
      authenticate.




<span class="grey">Kelly &amp; Clancy               Informational                      [Page 5]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-6" id="page-6" href="#page-6" class="invisible"> </a>
<span class="grey"><a href="rfc5418.html">RFC 5418</a>             CAPWAP 802.11 Threat Analysis            March 2009</span>


   o  The medium is not trusted, and therefore communications must be
      secured.

   RFID tags, on the other hand, typically do not have the same
   authentication, confidentiality, and integrity requirements as the
   principals in a WLAN deployment, and are not, generally speaking,
   well suited to environments in which similar threats exist.  As a
   result of the combination of WLAN security requirements and the
   Medium Access Control (MAC)-splitting behavior that epitomizes the
   IEEE 802.11 binding for CAPWAP, there are definite security-related
   considerations in the WLAN case that simply do not exist for an RFID-
   based adaptation of CAPWAP.

   Now, there certainly are similarities and overlapping security
   considerations that will apply to any CAPWAP deployment scenario.
   For example, authentication of the AC for purposes of WTP device
   management operations is probably always important.  Even so, the
   threats to RFID are different enough to suggest the need for a
   separate security analysis in that case.  For example, since RFID
   tags commonly deployed today implement no over-air authentication,
   integrity, or confidentiality mechanisms, the need for similar
   mechanisms between the WTP and AC for RFID tag data communications is
   not clearly indicated -- that is, the threats are different.

   We have limited visibility into the varied ways in which CAPWAP might
   be adapted in the future, although we may observe that it seems to
   provide the basis for a generalized scalable provisioning protocol.
   Given our currently limited view of the technologies for which it
   might be used, it seems prudent to recognize that our current view is
   colored by the IEEE 802.11 roots of the protocol, and make that
   recognition explicit in our analysis.  If newly added bindings turn
   out to be substantially similar to IEEE 802.11, then the associated
   binding documents can simply reference this document in their
   security considerations, while calling out any substantive
   differences.  However, it does appear, based on our current limited
   visibility, that per-binding threat analyses will be required.

<span class="h3"><a class="selflink" name="section-1.2" href="#section-1.2">1.2</a>.  Notations</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in <a href="rfc2119.html">RFC 2119</a> [<a href="rfc2119.html" title="&quot;Key words for use in RFCs to Indicate Requirement Levels&quot;">RFC2119</a>].









<span class="grey">Kelly &amp; Clancy               Informational                      [Page 6]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-7" id="page-7" href="#page-7" class="invisible"> </a>
<span class="grey"><a href="rfc5418.html">RFC 5418</a>             CAPWAP 802.11 Threat Analysis            March 2009</span>


<span class="h2"><a class="selflink" name="section-2" href="#section-2">2</a>.  Abbreviations and Definitions</span>

   o    AAA - Authentication Authorization and Accounting

   o    AC - Access Controller

   o    AES-CCMP - Advanced Encryption Standard - Counter-mode CBC MAC
        Protocol

   o    AP - (wireless) Access Point

   o    CAPWAP - Control And Provisioning of Wireless Access Points

   o    Cert - X509v3 Certificate

   o    DIAMETER - proposed successor to RADIUS protocol (see below)

   o    DoS - Denial of Service (attack)

   o    DTLS - Datagram Transport Layer Security

   o    EAP - Extensible Authentication Protocol

   o    MitM - Man in the Middle

   o    PMK - Pairwise Master Key

   o    PSK - Pre-Shared Key

   o    RADIUS - Remote Authentication Dial-In User Service

   o    STA - (wireless) STAtion

   o    TK - Transient Key

   o    TKIP - Temporal Key Integrity Protocol

   o    WEP - Wired Equivalent Privacy

   o    WLAN - Wireless Local Area Network

   o    WTP - Wireless Termination Point









<span class="grey">Kelly &amp; Clancy               Informational                      [Page 7]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-8" id="page-8" href="#page-8" class="invisible"> </a>
<span class="grey"><a href="rfc5418.html">RFC 5418</a>             CAPWAP 802.11 Threat Analysis            March 2009</span>


<span class="h2"><a class="selflink" name="section-3" href="#section-3">3</a>.  CAPWAP Security Goals for IEEE 802.11 Deployments</span>

   When deployed for use with IEEE 802.11, CAPWAP should avoid
   introducing any system security degradation as compared to the fat AP
   scenario.  However, by splitting the AP functions between the WTP and
   AC, CAPWAP places potentially sensitive protocol interactions that
   were previously internal to the AP onto the Layer 3 (L3) network
   between the AC and WTP.  Therefore, the security properties of this
   new system are dependent on the security properties of the
   intervening network, as well as on the details of the split.

   Since CAPWAP does not directly interact with over-air or AAA
   protocols, these are mostly out of scope for this analysis.  That is,
   we do not analyze the basic AAA or IEEE 802.11 security protocols
   directly here, as CAPWAP does not modify these protocols in any way,
   nor do they directly interact with CAPWAP.  However, by splitting AP
   functionality, CAPWAP may expose security elements of these protocols
   that would not otherwise be exposed.  In such cases, CAPWAP should
   explicitly avoid degrading the security of these protocols in any way
   when compared to the fat AP scenario.

<span class="h2"><a class="selflink" name="section-4" href="#section-4">4</a>.  Overview of IEEE 802.11 and AAA Security</span>

   While this document is not directly concerned with IEEE 802.11 or AAA
   security, there are some subtle interactions introduced by CAPWAP,
   and there will be related terminology we must touch on in discussing
   these.  The following figure illustrates some of the complex
   relationships between the various protocols, and illustrates where
   CAPWAP sits:






















<span class="grey">Kelly &amp; Clancy               Informational                      [Page 8]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-9" id="page-9" href="#page-9" class="invisible"> </a>
<span class="grey"><a href="rfc5418.html">RFC 5418</a>             CAPWAP 802.11 Threat Analysis            March 2009</span>


                             +-----+  RADIUS/Diameter
                             | AAA |&lt;==============\\
                             +-----+               ||
                                |                  ||
                    +-----------+------------+     ||
                    |                        |     ||
                 +-----+                  +----+   ||
                 | AC  |                  | AC |&lt;==//
                 +-----+                  +----+
              +---|  |---+             +---|  |---+
              |          |             |          |
              |          |             |  CAPWAP  |
           +-----+    +-----+       +-----+    +-----+
           | WTP |    | WTP |       | WTP |    | WTP |
           +-----+    +-----+       +-----+    +-----+
           ^                       ^^^
          ^^                      ^^^  802.11i,
          ^^                      ^^  802.1X, WPA,
      +-----+              +-----+     WEP
      | STA |              | STA |
      +-----+              +-----+
     /     /              /     /
    +-----+              +-----+

               Figure 3: CAPWAP Protocol Hierarchy

   CAPWAP is being inserted between the 802.ll link security mechanism
   and the authentication server communication, so to provide supporting
   context, we give a very brief overview of IEEE 802.11 and AAA
   security below.  It is very important to note that we only cover
   those topics that are relevant to our discussion, so what follows is
   not by any means exhaustive.  For more detailed coverage of IEEE
   802.11-related security topics, see e.g., [<a href="#ref-80211SEC" title="&quot;Real 802.11 Security - Wi-Fi protected Access and 802.11i&quot;">80211SEC</a>].

<span class="h3"><a class="selflink" name="section-4.1" href="#section-4.1">4.1</a>.  IEEE 802.11 Authentication and AAA</span>

   IEEE 802.11 provides for multiple methods of authentication prior to
   granting access to the network.  In the simplest case, open
   authentication is used, and this is equivalent to no authentication.
   However, if IEEE 802.11 link security is to be provided, then some
   sort of authentication is required in order to bootstrap the trust
   relationship that underlies the associated key establishment process.

   This authentication can be implemented through use of a shared
   secret.  In such cases, the authentication may be implicitly tied to
   the link security mechanism, (e.g., when Wired Equivalent Privacy
   (WEP) is used with open authentication), or it may be explicit, e.g.,
   when Wi-fi Protected Access is used with a Pre-Shared Key (WPA-PSK).



<span class="grey">Kelly &amp; Clancy               Informational                      [Page 9]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-10" id="page-10" href="#page-10" class="invisible"> </a>
<span class="grey"><a href="rfc5418.html">RFC 5418</a>             CAPWAP 802.11 Threat Analysis            March 2009</span>


   In other cases, authentication requires an explicit cryptographic
   exchange, and this operation bootstraps link security.  In most such
   cases, IEEE 802.1X is used in conjunction with the Extensible
   Authentication Protocol [<a href="rfc3748.html" title="&quot;Extensible Authentication Protocol (EAP)&quot;">RFC3748</a>] to authenticate either the client
   or both the client and the authentication server.  This exchange
   produces cryptographic keying material for use with IEEE 802.11
   security mechanisms.

   The resulting trust relationships are complex, as can be seen from
   the following (simplified) figure:

         /--------------------------------------------\
         |                       TK (6)               | EAP Credentials,
         V                  /--------------\          | PMK (3)
      +------+              |  PSK/Cert(1) |          |
      |client|              V              |          V
      |(STA) |         +--------+     |    v     |  +-----+
      +------+ ) ) ) ) |  WTP   |-----|  +----+  |--| AAA |
     /      /          +--------+     |--| AC |--|  +-----+
    +------+              ^           |  +----+  |      ^
      ^  ^                |               ^  ^ (2,4)    |
      |  |    PTK (7)     |               |  \----------/
      |  \----------------/               |   Radius PSK,
      \-----------------------------------/       PMK
              4-Way Handshake (w/PMK) (5)

                   Figure 4: Trust Relationships

   The following describes each of the relationships:

   1.  WTP and AC establish secure link

   2.  AC establishes secure link with AAA server

   3.  STA and AAA server conduct EAP, produce PMK

   4.  AAA server pushes PMK to AC

   5.  AC and STA conduct 4-way handshake (producing TK, among other
       keys)

   6.  AC pushes TK to WTP (if decentralized encryption is used)

   7.  WTP/STA use TK for IEEE 802.11 link security







<span class="grey">Kelly &amp; Clancy               Informational                     [Page 10]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-11" id="page-11" href="#page-11" class="invisible"> </a>
<span class="grey"><a href="rfc5418.html">RFC 5418</a>             CAPWAP 802.11 Threat Analysis            March 2009</span>


<span class="h3"><a class="selflink" name="section-4.2" href="#section-4.2">4.2</a>.  IEEE 802.11 Link Security</span>

   The current CAPWAP binding for IEEE 802.11 primarily supports the use
   of IEEE 802.11i [<a href="#ref-80211I" title="&quot;IEEE Std 802.11i: WLAN Specification for Enhanced Security&quot;">80211I</a>] security on the wireless link.  However,
   since IEEE 802.11i does not prohibit the use of WEP for link
   security, neither does CAPWAP.  Nonetheless, use of WEP with CAPWAP
   is NOT RECOMMENDED.

   If WEP is used with CAPWAP, the CAPWAP system will inherit all the
   security problems associated with the use of WEP in any wireless
   network.  In particular, 40-bit keys can be subject to brute-force
   attacks, and statistical attacks can be used to crack session keys of
   any length after enough packets have been collected [<a href="#ref-WEPSEC" title="&quot;The Dangers of Mitigating Security Design Flaws: A Wireless Case Study&quot;">WEPSEC</a>].  As of
   late 2008, such attacks are trivial, and take mere seconds to
   accomplish.

   Newer link security mechanisms described in IEEE 802.11i, including
   TKIP and AES-CCMP, significantly improve the security of wireless
   networks.  It is strongly RECOMMENDED that CAPWAP only be used with
   these newer techniques.

   The only slight insecurity introduced by CAPWAP when using it with
   IEEE 802.11i is the handling of the KeyRSC counter.  When performing
   decentralized encryption, this value is maintained by the WTP, but
   needed by the AC to perform the 4-way handshake.  The value used
   during the handshake initializes the counter on the client.  In
   CAPWAP, this value is initialized to zero, allowing the possibility
   for replay attacks of broadcast traffic in the window between initial
   authentication and the client receiving the first valid broadcast
   packet from the WTP.  This slight window of attack has been
   documented in [<a href="rfc5416.html" title="&quot;Control And Provisioning of Wireless Access Points (CAPWAP) Protocol Binding for IEEE 802.11&quot;">RFC5416</a>].

<span class="h3"><a class="selflink" name="section-4.3" href="#section-4.3">4.3</a>.  AAA Security</span>

   CAPWAP has very little control over how AAA security is deployed, as
   it's not directly bound to AAA as it is to IEEE 802.11.  As a result,
   CAPWAP can only provide guidance on how to best secure the AAA
   portions of a CAPWAP-enabled wireless network.

   The AAA protocol is a term that refers to use of either RADIUS
   [<a href="rfc3579.html" title="&quot;RADIUS (Remote Authentication Dial In User Service) Support For Extensible Authentication Protocol (EAP)&quot;">RFC3579</a>] or Diameter [<a href="rfc4072.html" title="&quot;Diameter Extensible Authentication Protocol (EAP) Application&quot;">RFC4072</a>] to transport EAP communications
   between the authenticator and the AAA server.  Here the authenticator
   is the AC, thus the AAA protocol secures the link between the AC and
   AAA server.  Use of non-unique or low-entropy long-term credentials
   to secure the AC-AAA link can severely impact the overall security of
   a CAPWAP deployment, and consequently is NOT RECOMMENDED.  Each AC
   should have a mutually authenticated link that provides robust data




<span class="grey">Kelly &amp; Clancy               Informational                     [Page 11]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-12" id="page-12" href="#page-12" class="invisible"> </a>
<span class="grey"><a href="rfc5418.html">RFC 5418</a>             CAPWAP 802.11 Threat Analysis            March 2009</span>


   confidentiality and integrity.  The AAA protocols and keys used
   SHOULD be consistent with the guidance in [<a href="rfc4962.html" title="&quot;Guidance for Authentication, Authorization, and Accounting (AAA) Key Management&quot;">RFC4962</a>].

   Since CAPWAP does not directly interact with AAA, it does not affect
   the overall security of a AAA network.  In fact, by decreasing the
   number of devices that communicate with the AAA server, we can
   actually decrease its exposure and risk of attack.

<span class="h3"><a class="selflink" name="section-4.4" href="#section-4.4">4.4</a>.  Cryptographic Bindings</span>

   One key shortcoming of both the EAP and AAA models is that they are
   inherently two-party models.  In CAPWAP deployments, we rely on a
   variety of security associations when an IEEE 802.11 WLAN client
   session is established.  These include:

   o  WTP-AC (CAPWAP Authentication)

   o  AC-AAA (AAA Authentication)

   o  STA-AAA (EAP Method Execution)

   o  STA-AC (AAA pushes keys to AC)

   o  STA-WTP (AC pushes keys to WTP)

   Each of these security associations involve a pairwise trust
   relationship, and none result from a multi-party key agreement
   protocol such as Kerberos.  In particular, just because an STA trusts
   a AAA server who trusts an AC who trusts a WTP doesn't necessarily
   mean that the STA should trust the WTP.  The WTP may be compromised
   and using his credentials to maintain a trust relationship with an
   AC, while advertising false information about the network to an STA.

   Protection against attacks like these can be very difficult, while
   maintaining scalable trust relationships with other entities in the
   network.  Since multiple protocols are being used, multi-party keying
   to derive end-to-end trust relationships is infeasible.

   Since CAPWAP is a collection of pairwise trust relationships, in
   order to claim CAPWAP is secure, we must believe in the transitivity
   of these trust relationships.  Its hierarchal nature mitigates the
   domino effect, but any compromised device in the hierarchy can affect
   those below it in the hierarchy.








<span class="grey">Kelly &amp; Clancy               Informational                     [Page 12]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-13" id="page-13" href="#page-13" class="invisible"> </a>
<span class="grey"><a href="rfc5418.html">RFC 5418</a>             CAPWAP 802.11 Threat Analysis            March 2009</span>


<span class="h2"><a class="selflink" name="section-5" href="#section-5">5</a>.  Structure of the Analysis</span>

   In order to conduct a comprehensive threat analysis, there are some
   basic questions we must answer:

   o  Exactly what are we trying to protect?

   o  What are the risks?

      *  What are the capabilities of would-be attackers?

      *  What might be goals of would-be attackers?

      *  What are the vulnerabilities or conditions they might attempt
         to exploit?

      *  For various attackers, what is the likelihood of attempting to
         exploit a given vulnerability given the cost of the exploit
         versus the value of attack?

   o  What potential mitigation strategies are available to us?

   o  What kinds of trade-offs do these mitigation strategies offer, and
      do they introduce any new risks?

   This is a very simplistic overview of what we must accomplish below,
   but it should give some insight into the manner in which the
   discussion proceeds.

   As a preliminary, we describe some representative CAPWAP deployment
   scenarios.  This helps to frame subsequent discussion, so that we
   better understand what we are trying to protect.  Following this, we
   describe a threat model in terms of adversary capabilities,
   vulnerabilities introduced by the CAPWAP functionality split, and a
   representative sampling of adversary goals.  Note that we do not
   spend a lot of time speculating about specific attackers here, as
   this is a very general analysis, and there are many different
   circumstances under which a WLAN might be deployed.

   Following the development of the general threat model, we describe
   appropriate countermeasures, and discuss how these are implemented
   through various means within the CAPWAP protocol.  Finally, we
   discuss those issues that are not (or cannot be) completely
   addressed, and we give recommendations for mitigating the resulting
   exposure.






<span class="grey">Kelly &amp; Clancy               Informational                     [Page 13]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-14" id="page-14" href="#page-14" class="invisible"> </a>
<span class="grey"><a href="rfc5418.html">RFC 5418</a>             CAPWAP 802.11 Threat Analysis            March 2009</span>


<span class="h2"><a class="selflink" name="section-6" href="#section-6">6</a>.  Representative CAPWAP Deployment Scenarios</span>

   In this section, we describe some representative CAPWAP deployment
   scenarios, and in particular, those scenarios that have been taken
   into consideration for the current CAPWAP protocol security design.
   For clarity, we first provide some preliminary definitions, along
   with descriptions of common deployment configurations that span
   multiple scenarios.  Following this is a sampling of individual
   deployment scenarios.

<span class="h3"><a class="selflink" name="section-6.1" href="#section-6.1">6.1</a>.  Preliminary Definitions</span>

   The IEEE 802.11 standard describes several frame types, and
   variations in WLAN architectures dictate where these frame types
   originate and/or terminate (i.e., at the WTP or AC).  There are three
   basic IEEE 802.11 frame types currently defined:

   o  Control: These are for managing the transmission medium (i.e., the
      airwaves).  Examples include RTS, CTS, ACK, PS-POLL, CF-POLL, CF-
      END, and CF-ACK.

   o  Management: These are for managing access to the logical network,
      as opposed to the physical medium.  Example functions include
      association/disassociation, reassociation, deauthentication,
      Beacons, and Probes.

   o  Data: Transit data (network packets).

   There are a number of other services provided by the WLAN
   infrastructure, including these:

   o  Packet distribution

   o  Synchronization

   o  Retransmissions

   o  Transmission Rate Adaptation

   o  Privacy/Confidentiality/Integrity (e.g., IEEE 802.11i)

   The manner in which these (and other) services are divided among the
   AC and WTP is collectively referred to in terms of "MAC-splitting"
   characteristics.  We briefly describe various forms of MAC-splitting
   below.  For further detail, see [<a href="rfc5415.html" title="&quot;Control And Provisioning of Wireless Access Points (CAPWAP) Protocol Specification&quot;">RFC5415</a>] and [<a href="rfc5416.html" title="&quot;Control And Provisioning of Wireless Access Points (CAPWAP) Protocol Binding for IEEE 802.11&quot;">RFC5416</a>].






<span class="grey">Kelly &amp; Clancy               Informational                     [Page 14]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-15" id="page-15" href="#page-15" class="invisible"> </a>
<span class="grey"><a href="rfc5418.html">RFC 5418</a>             CAPWAP 802.11 Threat Analysis            March 2009</span>


<span class="h4"><a class="selflink" name="section-6.1.1" href="#section-6.1.1">6.1.1</a>.  Split MAC</span>

   Split MAC scenarios are characterized by the fact that some IEEE
   802.11 MAC messages are processed by the WTP, while some are
   processed by the AC.  For example, a Split MAC implementation might
   divide IEEE 802.11 frame processing as follows:

   WTP

      *  Beacons

      *  Probes

      *  RTS, CTS, ACK, PS-POLL, CF-POLL,CF-END, CF-ACK

   AC

      *  Association/Reassociation/Disassociation

      *  Authentication/Deauthentication

      *  Key Management

      *  IEEE 802.11 Link Security (WEP, TKIP, IEEE 802.11i)

   The Split MAC model is not confined to any one particular deployment
   scenario, as we'll see below, and vendors have considerable leeway in
   choosing how to distribute the IEEE 802.11 functionality.

<span class="h4"><a class="selflink" name="section-6.1.2" href="#section-6.1.2">6.1.2</a>.  Local MAC</span>

   Local MAC scenarios are characterized by the fact that most IEEE
   802.11 MAC messages are processed by the WTP.  Some IEE 802.11 MAC
   frames must be forwarded to the AC (i.e., IEEE 802.11 Association
   Request frames), but in general, the WTP manages the MAC
   interactions.  Data frames may also be forwarded to the AC, but are
   generally bridged locally.

<span class="h4"><a class="selflink" name="section-6.1.3" href="#section-6.1.3">6.1.3</a>.  Remote MAC</span>

   Remote MAC scenarios are characterized by the fact that all IEEE
   802.11 MAC messages are forwarded to the AC.  The WTP does not
   process any of these locally.  This model supports very lightweight
   WTPs that need be little more than smart antennas.  While Remote MAC
   scenarios are not addressed by the current IEEE 802.11 protocol
   binding for CAPWAP, the description is included here for
   completeness.




<span class="grey">Kelly &amp; Clancy               Informational                     [Page 15]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-16" id="page-16" href="#page-16" class="invisible"> </a>
<span class="grey"><a href="rfc5418.html">RFC 5418</a>             CAPWAP 802.11 Threat Analysis            March 2009</span>


<span class="h4"><a class="selflink" name="section-6.1.4" href="#section-6.1.4">6.1.4</a>.  Data Tunneling</span>

   Regardless of the approach to MAC splitting, there is also the matter
   of where user data packets are translated between wired and wireless
   frame formats, i.e., where the bridging function occurs.  In some
   cases, user data frames are tunneled back to the AC, and in others,
   they are locally bridged by the WTP.  While one might expect Remote
   MAC implementations to always tunnel data packets back to the AC, for
   Local and Split MAC modes the decision is not so clear.  Also, it's
   important to note that there are no rules or standards in place that
   rigidly define these terms and associated handling.  Data tunneling
   is further discussed for each scenario below.

<span class="h3"><a class="selflink" name="section-6.2" href="#section-6.2">6.2</a>.  Example Scenarios</span>

   In this section, we describe a number of example deployment
   scenarios.  This is not meant to be an exhaustive enumeration;
   rather, it is intended to give a general sense of how WLANs currently
   are or may be deployed.  This will provide important context when we
   discuss adversaries and threats in subsequent sections below.

<span class="h4"><a class="selflink" name="section-6.2.1" href="#section-6.2.1">6.2.1</a>.  Localized Modular Deployment</span>

   The localized modular model describes a WLAN that is deployed within
   a single domain of control, typically within either a single building
   or some otherwise physically contained area.  This would be typical
   of a small to medium-sized organization.  In general, the LAN enjoys
   some sort of physical security (e.g., it's within the confines of a
   building for which access is somehow limited), although the actual
   level of physical security is often far less than is assumed.

   In such deployments, the WLAN is typically an extension of a wired
   LAN.  However, its interface to the wired LAN can vary.  For example,
   the interconnection between the WTPs and ACs can have its own wiring,
   and its only connection to the LAN is via the AC's Distribution
   System (DS) port(s).  In such cases, the WLAN frequently occupies its
   own distinct addressing partition(s) in order to facilitate routing,
   and the AC often acts as a forwarding element.

   In other cases, the WTPs may be mingled with the existing LAN
   elements, perhaps sharing address space, or perhaps somehow logically
   isolated from other wired elements (e.g., by Virtual LAN).  Under
   these circumstances, it is possible that traffic destined to/from the
   WLAN is mixed with traffic to/from the LAN.

   Localized deployments such as these could potentially choose any one
   of the MAC-splitting scenarios, depending on the size of the
   deployment, mobility requirements, and other considerations.  In many



<span class="grey">Kelly &amp; Clancy               Informational                     [Page 16]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-17" id="page-17" href="#page-17" class="invisible"> </a>
<span class="grey"><a href="rfc5418.html">RFC 5418</a>             CAPWAP 802.11 Threat Analysis            March 2009</span>


   cases, any one of the various MAC-splitting approaches would be
   sufficient.  This implies that user data may be bridged by either the
   WTP or the AC.

<span class="h4"><a class="selflink" name="section-6.2.2" href="#section-6.2.2">6.2.2</a>.  Internet Hotspot or Temporary Network</span>

   The Internet hotspot scenario is representative of a more general
   deployment model one might find at cafes, hotels, or airports.  It is
   also quite similar to temporary WLANs, which are created for
   conferences, conventions, and the like.  Some common characteristics
   of these networks include the following:

   o  Primary function is to provide Internet access

   o  Authentication may be very weak

   o  There frequently is no IEEE 802.11 link security

   Sometimes, the Local MAC model is used.  In such cases, the AC may be
   "in the clouds" (out on the Internet somewhere), and user data
   traffic will typically be locally bridged, rather than tunneled back
   to the AC.  Some IEEE 802.11 management traffic may be tunneled back
   to the AC, but frequently the authentication consists in simply
   knowing the Service Set Identifier (SSID) and perhaps a shared key
   for use with WEP or WPA-PSK.

   In other cases, a Split MAC model may be used.  This is more common
   in airport and hotel scenarios, where users may have an account that
   requires verification with some back-end infrastructure prior to
   access.  In these cases, IEEE 802.11 management frames are tunneled
   back to the AC (e.g., user authentication), and stronger IEEE 802.11
   link security may be provided (e.g., RSN), but user data is still
   typically locally bridged, as the primary goal is to provide Internet
   access.

   A third variation on this scenario entails tunneling user data
   through a local AC in order to apply centralized policy.  For
   example, in a hotel or airport scenario, there is no reason to
   provide direct access between WLAN users (who typically are within a
   private address space), and in fact, allowing such access might
   invite various sorts of malicious behavior.  In such cases, tunneling
   all user data back to the (local) AC provides a security choke point
   at which policy may be applied to the traffic.








<span class="grey">Kelly &amp; Clancy               Informational                     [Page 17]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-18" id="page-18" href="#page-18" class="invisible"> </a>
<span class="grey"><a href="rfc5418.html">RFC 5418</a>             CAPWAP 802.11 Threat Analysis            March 2009</span>


<span class="h4"><a class="selflink" name="section-6.2.3" href="#section-6.2.3">6.2.3</a>.  Distributed Deployments</span>

   The distributed deployment model describes a more complex WLAN
   topology that features network segments that are typically somehow
   spatially separated, although not necessarily so.  These segments
   might be connected in a physically secure manner, or (if they are
   widely separated) they might be connected across potentially hostile
   hops.  Below we discuss several subgroups of this model.

<span class="h5"><a class="selflink" name="section-6.2.3.1" href="#section-6.2.3.1">6.2.3.1</a>.  Large Physically Contained Organization</span>

   One distributed deployment example involves a single large
   organization that is physically contained, typically within one large
   building.  The network might feature logically distinct (e.g., per-
   department or per-floor) network segments, and in some cases, there
   might be firewalls between the segments for access control.  In such
   deployments, the AC is typically in a centralized datacenter, but
   there might also be a hierarchy of ACs, with a master in the
   datacenter, and subordinate ACs distributed among the network
   segments.  Such deployments typically assume some level of physical
   security for the network infrastructure.

<span class="h5"><a class="selflink" name="section-6.2.3.2" href="#section-6.2.3.2">6.2.3.2</a>.  Campus Deployments</span>

   Some large organizations have networks that span multiple buildings.
   The interconnections between these buildings might be wired (e.g.,
   underground cables), or might be wireless (e.g., a point-to-point
   Metropolitan Area Network (MAN) link).  The interconnections may be
   secured, but sometimes they are not.  The organization may be
   providing outdoor wireless access to users, in which case some WTPs
   will typically be located outdoors, and these may or may not be
   within physically secure space.  For example, college campuses
   frequently provide outdoor wireless access, and the associated WTPs
   may simply be mounted on a light post.

   For such deployments, ACs may be centrally located in a datacenter,
   or they may be distributed.  User data traffic may be locally
   bridged, but more frequently it is tunneled back to the AC, as this
   facilitates mobility and centralized policy enforcement.

<span class="h5"><a class="selflink" name="section-6.2.3.3" href="#section-6.2.3.3">6.2.3.3</a>.  Branch Offices</span>

   A common deployment model entails an enterprise consisting of a
   headquarters and one or more branch offices, with the branches
   connected to the central HQ.  In some cases, the site-to-site
   connection is via a private WAN link, and in others it is across the





<span class="grey">Kelly &amp; Clancy               Informational                     [Page 18]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-19" id="page-19" href="#page-19" class="invisible"> </a>
<span class="grey"><a href="rfc5418.html">RFC 5418</a>             CAPWAP 802.11 Threat Analysis            March 2009</span>


   Internet.  For connections crossing potentially hostile hops (e.g.,
   the Internet), some sort of Virtual Private Network (VPN) is
   typically employed as a protective measure.

   In some simple branch office scenarios, there are only WTPs at the
   remote site, and these are managed by a controller residing at the
   central site.  In other cases, a branch site may have its own
   subordinate controller, with the master controller again residing at
   the central site.  In the first case, local bridging is often the
   best choice for user data, due to latency and link capacity issues.
   In the second case, traffic may be locally bridged by the WTPs, or it
   may be forwarded to the local subordinate controller for centralized
   policy enforcement.  The choice depends on many factors, including
   local topology and security policy.

<span class="h5"><a class="selflink" name="section-6.2.3.4" href="#section-6.2.3.4">6.2.3.4</a>.  Telecommuter or Remote Office</span>

   It is becoming increasingly common to send WTPs home with employees
   for use as a telecommuting solution.  While there are not yet any
   standards or hard rules for how these work, a fairly typical
   configuration provides Split MAC with all user data tunneled back to
   the controller in the organization's datacenter so that the WTP is
   essentially providing wireless VPN services.  These devices may in
   some cases provide their own channel security (e.g., IPsec), but
   alternative approaches are possible.  For example, there may be a
   stand-alone VPN gateway between the WTP and the Internet, which
   forwards all organization-bound traffic to the VPN gateway.

   Similarly, it is becoming increasingly common for travelers to plug a
   WTP into a hotel broadband connection.  While in many cases, these
   WTPs are stand-alone fat APs, in some cases they are configured to
   create a secure connection to a centralized controller back at
   headquarters, essentially forming a VPN connection.  In such
   scenarios, a Split MAC approach is typical, but split-tunneling may
   also be supported (i.e., only data traffic destined for the
   headquarters is tunneled back to the controller, with Internet-bound
   traffic locally bridged).

<span class="h2"><a class="selflink" name="section-7" href="#section-7">7</a>.  General Adversary Capabilities</span>

   This section describes general capabilities we might expect an
   adversary to have in various CAPWAP scenarios.  Obviously, it is
   possible to limit what an adversary can do through various deployment
   restrictions (e.g., provide strict physical security for the AC-WTP
   link), but such restrictions are simply not always feasible.  For






<span class="grey">Kelly &amp; Clancy               Informational                     [Page 19]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-20" id="page-20" href="#page-20" class="invisible"> </a>
<span class="grey"><a href="rfc5418.html">RFC 5418</a>             CAPWAP 802.11 Threat Analysis            March 2009</span>


   example, it is not possible to provide strict physical security for
   various aspects of the telecommuter scenario.  Thus, we must consider
   what capabilities an adversary might have in the worst case, and plan
   accordingly.

<span class="h3"><a class="selflink" name="section-7.1" href="#section-7.1">7.1</a>.  Passive versus Active Adversaries</span>

   One way to classify adversaries is in terms of their ability to
   interact with AC/WTP communications.  For example, a passive
   adversary is one who can observe and perhaps record traffic, but
   cannot interact with it.  They can "see" the traffic as it goes by,
   but they cannot interfere in any way, and they cannot inject traffic
   of their own.  Note that such an adversary does not necessarily see
   all traffic -- they may miss portions of a communication, e.g.,
   because some packets traverse a different path, or because the
   network is so busy that the adversary can't keep up (and drops
   packets as a result).

   An active adversary, on the other hand, can directly interact with
   the traffic in real-time.  There are two modes in which an active
   adversary might operate:

   Pass-by (or sniffer)

      *  Can observe/record traffic

      *  Can inject packets

      *  Can replay packets

      *  Can reflect packets (i.e., send duplicate packets to a
         different destination, including the to the packet source)

      *  Can cause redirection (e.g., via Address Resolution Protocol
         (ARP)/DNS poisoning)

   Inline (Man-in-the-Middle, or MitM)

      *  Can observe/record traffic

      *  Can inject packets

      *  Can replay packets

      *  Can reflect packets (with or without duplication)

      *  Can delete packets




<span class="grey">Kelly &amp; Clancy               Informational                     [Page 20]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-21" id="page-21" href="#page-21" class="invisible"> </a>
<span class="grey"><a href="rfc5418.html">RFC 5418</a>             CAPWAP 802.11 Threat Analysis            March 2009</span>


      *  Can modify packets

      *  Can delay packets

   A passive adversary could be located anywhere along the path between
   the AC and WTP, and is characterized by the fact that it only
   listens:

        +------+
        |client|         +--------+     |
        |(STA) |         |   WTP  |     |     +------+
        +------+ ) ) ) ) |        |-----|    /        \    +------+
       /      /          +--------+     |-x-( optional )---|  AC  |
      +------+                          | |  \ cloud  /    +------+
                                        | |   +------+
                                          |
                                          |  +-----------+
                                          +--|  pass-by  |
                                             |  listener |
                                             +-----------+

                     Figure 5: Passive Attacker

   An active adversary may attach in the same manner as the passive
   adversary (in which case it is in pass-by mode), or it may be lodged
   directly in the path between the AC and WTP (inline mode):

        +------+
        |client|       +--------+   |
        |(STA) |       |   WTP  |   | +------+    +------+
        +------+ ) ) ) |        |---| |active|   /        \    +------+
       /      /        +--------+   |-| MitM |--( optional )---|  AC  |
      +------+                      | +------+   \ cloud  /    +------+
                                    |             +------+

               Figure 6: Active Man-in-the-Middle Attacker

   If it is not inline, it can only observe and create traffic; if it is
   inline, it can do whatever it wishes with the traffic it sees.

   It is important to recognize that becoming a MitM does not
   necessarily require physical insertion directly into the transmission
   path.  Alternatively, the adversary can cause traffic to be diverted
   to the MitM system, e.g., via ARP or DNS poisoning.  Hence, launching
   an MitM attack is not so difficult as it might first appear.






<span class="grey">Kelly &amp; Clancy               Informational                     [Page 21]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-22" id="page-22" href="#page-22" class="invisible"> </a>
<span class="grey"><a href="rfc5418.html">RFC 5418</a>             CAPWAP 802.11 Threat Analysis            March 2009</span>


<span class="h2"><a class="selflink" name="section-8" href="#section-8">8</a>.  Vulnerabilities Introduced by CAPWAP</span>

   In this section, we discuss vulnerabilities that arise as a result of
   splitting the AP function across potentially hostile hops.  We
   primarily consider network-based vulnerabilities, and while in
   particular we do not address how an adversary might affect a physical
   compromise of the WTP or AC, we do consider the potential effects of
   such compromises with respect to CAPWAP and the operational changes
   it introduces when compared to stand-alone AP deployments.

   Functionally, we are interested in two general "states of being" with
   respect to AC-WTP communications: the session establishment phase or
   state, and the "connected" (or session established) state.  We
   discuss each of these further below.  Also, it is important to note
   that we first describe vulnerabilities assuming that the CAPWAP
   communications lack security of any kind.  Later, we will evaluate
   the protocol given the security mechanisms currently planned for
   CAPWAP.

<span class="h3"><a class="selflink" name="section-8.1" href="#section-8.1">8.1</a>.  The Session Establishment Phase</span>

   The session establishment phase consists of two subordinate phases:
   discovery, and association or joining.  These are treated
   individually in the following sections.

<span class="h4"><a class="selflink" name="section-8.1.1" href="#section-8.1.1">8.1.1</a>.  The Discovery Phase</span>

   Discovery consists of an information exchange between the AC and WTP.
   There are several potential areas of exposure:

   Information Leakage:  During Discovery, information about the WTP and
      AC hardware and software are exchanged, as well as information
      about the AC's current operational state.  This could provide an
      adversary with valuable insights.

   DoS Potential:  During Discovery, there are several opportunities for
      Denial of Service (DoS), beyond those inherently available to an
      inline adversary.  For example, an adversary might respond to a
      WTP more quickly than a valid AC, causing the WTP to attempt to
      join with a non-existent AC, or one which is currently at maximum
      load.

   Redirection Potential:  There are multiple ways in which an adversary
      might redirect a WTP during Discovery.  For example, the adversary
      might pretend to be a valid AC, and entice the WTP to connect to
      it.  Or, the adversary might instead cause the WTP to associate





<span class="grey">Kelly &amp; Clancy               Informational                     [Page 22]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-23" id="page-23" href="#page-23" class="invisible"> </a>
<span class="grey"><a href="rfc5418.html">RFC 5418</a>             CAPWAP 802.11 Threat Analysis            March 2009</span>


      with the AC of the adversary's choosing, by posing as a DNS or
      DHCP server, injecting a spoofed Discovery Response, or by
      modifying valid AC responses.

   Misdirection:  An adversary might mislead either the WTP or AC by
      modifying the Discovery Request or Response in flight.  In this
      way, the AC and/or WTP will have a false view of the other's
      capabilities, and this might cause a change in the way they
      interact (e.g., they might not use important features not
      supported by earlier versions).

<span class="h4"><a class="selflink" name="section-8.1.2" href="#section-8.1.2">8.1.2</a>.  Forming an Association (Joining)</span>

   The association phase begins once the WTP has determined with which
   AC it wishes to join.  There are several potential areas of exposure
   during this phase:

   Information Leakage:  During association, the adversary could glean
      useful information about hardware, software, current
      configuration, etc. that could be used in various ways.

   DoS Potential:  During formation of a WTP-AC association, there are
      several opportunities for Denial of Service (DoS), beyond those
      inherently available to an inline adversary.  For example, the
      adversary could flood the AC with connection setup requests.  Or,
      it could respond to the WTP with invalid connection setup
      responses, causing a connection reset.  An adversary with MitM
      capability could delete critical session establishment packets.

   Misdirection:  An adversary might mislead either the WTP or AC by
      modifying the association request(s) or response(s) in flight.  In
      this way, the AC and/or WTP will have an inaccurate view of the
      other's capabilities, and this might cause a change in the way
      they interact.

   Some of these types of exposure are extremely difficult to prevent.
   However, there are things we can do to mitigate the effects, as we
   will see below.

<span class="h3"><a class="selflink" name="section-8.2" href="#section-8.2">8.2</a>.  The Connected Phase</span>

   Once the WTP and AC have established an association, the adversary's
   attention will turn to the network connection.  If we assume a
   passive adversary, the primary concern for established connections is
   eavesdropping.  If we assume an active adversary, there are several
   other potential areas of exposure:





<span class="grey">Kelly &amp; Clancy               Informational                     [Page 23]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-24" id="page-24" href="#page-24" class="invisible"> </a>
<span class="grey"><a href="rfc5418.html">RFC 5418</a>             CAPWAP 802.11 Threat Analysis            March 2009</span>


   Connection Hijacking:  An adversary may assume the identity of one
      end of the connection and take over the conversation.  There are
      numerous ways in which the true owner of the identity may be taken
      off-line, including DoS or MitM attacks.

   Eavesdropping:  An adversary may glean useful information from
      knowledge of the contents of CAPWAP control and/or data traffic.

   Modification of User Data:  An adversary with MitM capabilities could
      modify, delete, or insert user data frames.

   Modification of Control/Monitoring Messages:  An adversary with MitM
      capability could modify control traffic such as statistics, status
      information, etc. to create a false impression at the recipient.

   Modification/Control of Configuration:  An adversary with MitM
      capability could modify configuration messages to create
      unexpected conditions at the recipient.  Likewise, if a WTP is
      redirected during Discovery (or joining) and connects to an
      adversary rather than an authorized AC, the adversary may exert
      complete control over the WTPs configuration, including
      potentially loading tainted WTP firmware.

<span class="h2"><a class="selflink" name="section-9" href="#section-9">9</a>.  Adversary Goals in CAPWAP</span>

   This section gives an sampling of potential adversary goals.  It is
   not exhaustive, and makes no judgment as to the relative likelihood
   or value of each individual goal.  Rather, it is meant to give some
   idea of what is possible.  It is important to remember that clever
   attacks often result when seemingly innocuous flaws or
   vulnerabilities are combined in some non-intuitive way.  Hence, we
   don't rule out some goal that, taken alone, might not seem to make
   sense from an adversarial perspective.

<span class="h3"><a class="selflink" name="section-9.1" href="#section-9.1">9.1</a>.  Eavesdrop on AC-WTP Traffic</span>

   There are numerous reasons why an adversary might want to eavesdrop
   on AC-WTP traffic.  For example, it allows for reconnaissance,
   providing answers to the following questions:

   o  Where are the ACs?

   o  Where are the WTPs?

   o  Who owns them?

   o  Who manufactured them?




<span class="grey">Kelly &amp; Clancy               Informational                     [Page 24]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-25" id="page-25" href="#page-25" class="invisible"> </a>
<span class="grey"><a href="rfc5418.html">RFC 5418</a>             CAPWAP 802.11 Threat Analysis            March 2009</span>


   o  What version of firmware do they run?

   o  What cryptographic capabilities do they have?

   Similarly, snooping on tunneled data traffic might potentially reveal
   a great deal about the network, including answers to the following:

   o  Who's using the WLAN?

   o  When, and for how long?

   o  What addresses are they using?

   o  What protocols are they using?

   o  What over-the-air security are they using?

   o  Who/What are they talking to?

   Additionally, access to tunneled user data could allow the attacker
   to see confidential information being exchanged by applications
   (e.g., financial transactions).  An eavesdropper may gain access to
   valuable information that either provides the basis for another
   perhaps more sophisticated attack, or which has its own intrinsic
   value.

<span class="h3"><a class="selflink" name="section-9.2" href="#section-9.2">9.2</a>.  WTP Impersonation and/or Rootkit Installation</span>

   An adversary might want to impersonate or control an authorized WTP
   for many reasons, some of which we might realistically imagine today,
   and perhaps others about which we have no clue at this point.
   Examples we might reasonably imagine include the following:

   o  to facilitate MitM attacks against WLAN users

   o  to leak/inject or otherwise compromise WLAN data

   o  to give an inaccurate view of the state of the WLAN

   o  to gain access to a trusted channel to an AC, through which
      various protocol attacks might be launched (e.g., hijack client
      sessions from other WTPs)

   o  to facilitate Denial-of-Service attacks against WLAN users or the
      network






<span class="grey">Kelly &amp; Clancy               Informational                     [Page 25]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-26" id="page-26" href="#page-26" class="invisible"> </a>
<span class="grey"><a href="rfc5418.html">RFC 5418</a>             CAPWAP 802.11 Threat Analysis            March 2009</span>


<span class="h3"><a class="selflink" name="section-9.3" href="#section-9.3">9.3</a>.  AC Impersonation and/or Rootkit Installation</span>

   For reasons similar to the WTP impersonation discussed above, an
   adversary might want to impersonate an authorized AC for many
   reasons.  Examples we might reasonably imagine include the following:

   o  to facilitate DoS attacks against WLANs

   o  to facilitate MitM attacks against WLAN users

   o  to intercept user mobility context from another AC (possibly
      including security-sensitive information such as cryptographic
      keys)

   o  to facilitate selective control of one or more WTPs

      *  modify WTP configuration

      *  load tainted firmware onto WTP

   o  to assist in controlling which AC associates with which WTP

   o  to facilitate IEEE 802.11 association of unauthorized WLAN user(s)

   o  to exploit inter-AC trust in order facilitate attacks on other ACs

   In general, AC impersonation opens the door to a large measure of
   control over the WLAN, and could be used as the foundation to many
   other attacks.

<span class="h3"><a class="selflink" name="section-9.4" href="#section-9.4">9.4</a>.  Other Goals or Sub-Goals</span>

   There are many less concrete goals an adversary might have which,
   taken alone, might not seem to have any purpose, but when combined
   with other goals/attacks, might have very definite and undesirable
   consequences.  Here are some examples:

   o  cause CAPWAP de-association of WTP/AC

   o  cause IEEE 802.11 de-association of authorized user

   o  inject/modify/delete tunneled IEEE 802.11 user traffic

      *  to interact with a specific application

      *  to launch various attacks on WLAN user systems





<span class="grey">Kelly &amp; Clancy               Informational                     [Page 26]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-27" id="page-27" href="#page-27" class="invisible"> </a>
<span class="grey"><a href="rfc5418.html">RFC 5418</a>             CAPWAP 802.11 Threat Analysis            March 2009</span>


      *  to launch protocol fuzzing or other attacks on the AC that
         bridges between IEEE 802.11 and 802.3 frame formats

   o  control DNS responses

   o  control DHCP/BOOTP responses

   Anticipating all of the things an adversary might want to do is a
   daunting task.  Part of the difficulty stems from the fact that we
   are analyzing CAPWAP in a very general sense, rather than in a
   specific deployment scenario with specific assets and very specific
   adversary goals.  However, we have no choice but to take this
   approach if we are to provide reasonably good security across the
   board.

<span class="h2"><a class="selflink" name="section-10" href="#section-10">10</a>.  Countermeasures and Their Effects</span>

   In the previous sections, we described numerous vulnerabilities that
   result from splitting the AP function in two, and also discussed a
   number of adversary goals that could be realized by exploiting one or
   more of those vulnerabilities.  In this section, we describe
   countermeasures we can apply to mitigate the risks that come with the
   introduction of CAPWAP into WLAN deployment scenarios.

<span class="h3"><a class="selflink" name="section-10.1" href="#section-10.1">10.1</a>.  Communications Security Elements</span>

<span class="h4"><a class="selflink" name="section-10.1.1" href="#section-10.1.1">10.1.1</a>.  Mutual Authentication</span>

   Mutual authentication consists in each side proving its identity to
   the other.  There are numerous authentication protocols that
   accomplish this, typically using either a shared secret (e.g., a pre-
   shared key) or by relying on a trusted third party (e.g., with
   digital credentials such as X.509 certificates).

   Strong mutual authentication accomplishes the following:

   o  helps prevent AC/WTP impersonation

   o  helps prevent MitM attacks

   o  can be used to limit DoS attacks.

<span class="h5"><a class="selflink" name="section-10.1.1.1" href="#section-10.1.1.1">10.1.1.1</a>.  Authorization</span>

   While authentication consists in proving the identity of an entity,
   authorization consists in determining whether that entity should have
   access to some resource.  The current IEEE 802.11i CAPWAP protocol
   binding takes a rather simplistic approach to authorization,



<span class="grey">Kelly &amp; Clancy               Informational                     [Page 27]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-28" id="page-28" href="#page-28" class="invisible"> </a>
<span class="grey"><a href="rfc5418.html">RFC 5418</a>             CAPWAP 802.11 Threat Analysis            March 2009</span>


   depending on the authentication method chosen.  If pre-shared keys
   are used, authorization is broad and coarse: if the device knows the
   pre-shared key, the device is "trusted", meaning the that it is
   believed to be what it claims to be ( AC versus WTP), and it is
   granted all privilege/access associated with that device class.

   When using pre-shared keys, some granularity may be achieved by
   creating classes, each with their own pre-shared key, but this still
   has drawbacks.  For example, while possession of the key may suffice
   to identify the device as a member of a given group or class, it
   cannot be used to prove a device is either a WTP or an AC.  This
   means the key can be abused, and those possessing the key can claim
   to be either type of device.

   When X.509v3 certificates are used for authentication, much more
   granular authorization policies are possible.  Nonetheless, the
   current IEEE 802.11i protocol binding remains simplistic in its
   approach (though this may be addressed in future revisions).  As
   currently defined, the X.509v3 certificates facilitate the following
   authorization checks:

   o  CommonName (CN): the CN contains the MAC address of the device; if
      the relying party (AC or WTP) has a method for determining
      "acceptability" of a given MAC address, this helps prevent AC/WTP
      impersonation, MitM attacks, and may help in limiting DoS attacks

   o  Extended Key Usage (EKU) key purpose ID bits: CAPWAP uses specific
      key purpose ID bits (see [<a href="rfc5415.html" title="&quot;Control And Provisioning of Wireless Access Points (CAPWAP) Protocol Specification&quot;">RFC5415</a>] for more information) to
      explicitly differentiate between an AC and a WTP.  If use of these
      bits is strictly enforced, this segregates devices into AC versus
      WTP classes, and assists in preventing AC/WTP impersonation, MitM
      attacks, and may also help in limiting DoS attacks.  However, if
      the id-kp-anyExtendedKeyUsage keyPurposeID is supported, this
      mechanism may be on a par with pre-shared keys, as a rogue device
      has the ability to claim it is either a WTP or AC, unless CN-based
      access controls are employed in tandem.

   It should be noted that certificate-based authorization and zero
   configuration are not fully compatible.  Even if the WTPs and the ACs
   are shipped with manufacturer-provided certificates, the WTPs need a
   way to identify the correct AC is in this deployment (as opposed to
   other ACs from the same vendor, purchased and controlled by an
   adversary), and the AC needs to know which WTPs are part of this
   deployment (as opposed to WTPs purchased and controlled by an
   adversary).






<span class="grey">Kelly &amp; Clancy               Informational                     [Page 28]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-29" id="page-29" href="#page-29" class="invisible"> </a>
<span class="grey"><a href="rfc5418.html">RFC 5418</a>             CAPWAP 802.11 Threat Analysis            March 2009</span>


   The threat analysis in this document assumes that WTPs can identify
   the correct AC, and the AC can identify the correct WTPs.  Analysis
   of situations where either of these do not hold is beyond the scope
   of this document.

<span class="h4"><a class="selflink" name="section-10.1.2" href="#section-10.1.2">10.1.2</a>.  Data Origin Authentication</span>

   Data origin authentication typically depends on first authenticating
   the party at the other end of the channel, and then binding the
   identity derived from that authentication process to the data origin
   authentication process.  Data origin authentication primarily
   prevents an attacker from injecting data into the communication
   channel and pretending it was originated by a valid endpoint.  This
   mitigates risk by preventing the following:

   o  packet injection

   o  connection hijacking

   o  modification of control and/or user data

   o  impersonation

<span class="h4"><a class="selflink" name="section-10.1.3" href="#section-10.1.3">10.1.3</a>.  Data Integrity Verification</span>

   Data integrity verification provides assurance that data has not been
   altered in transit, and is another link in the trust chain beginning
   from mutual authentication, extending to data origin authentication,
   and ending with integrity verification.  This prevents the adversary
   from undetectably modifying otherwise valid data while in transit.
   It effectively prevents reflection and modification, and in some
   cases may help to prevent re-ordering.

<span class="h4"><a class="selflink" name="section-10.1.4" href="#section-10.1.4">10.1.4</a>.  Anti-Replay</span>

   Anti-replay is somewhat self-explanatory: it prevents replay of valid
   packets at a later time, or to a different recipient.  It may also
   prevent limited re-ordering of packets.  It is typically accomplished
   by assigning monotonically increasing sequence numbers to packets.

<span class="h4"><a class="selflink" name="section-10.1.5" href="#section-10.1.5">10.1.5</a>.  Confidentiality</span>

   Data confidentiality prevents eavesdropping by protecting data as it
   passes over the network.  This is typically accomplished using
   encryption.






<span class="grey">Kelly &amp; Clancy               Informational                     [Page 29]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-30" id="page-30" href="#page-30" class="invisible"> </a>
<span class="grey"><a href="rfc5418.html">RFC 5418</a>             CAPWAP 802.11 Threat Analysis            March 2009</span>


<span class="h3"><a class="selflink" name="section-10.2" href="#section-10.2">10.2</a>.  Putting the Elements Together</span>

   Above we described various security elements and their properties.
   Below, we discuss combinations of these elements in terms of CAPWAP.

<span class="h4"><a class="selflink" name="section-10.2.1" href="#section-10.2.1">10.2.1</a>.  Control Channel Security</span>

   The CAPWAP control channel is used for forming an association between
   a WTP and AC, and subsequently it allows the AC to provision and
   monitor the WTP.  This channel is critical for the control,
   management, and monitoring of the WLAN, and thus requires all of the
   security elements described above.  With these elements in place, we
   can effectively create a secure channel that mitigates almost all of
   the vulnerabilities described above.

<span class="h4"><a class="selflink" name="section-10.2.2" href="#section-10.2.2">10.2.2</a>.  Data Channel Security</span>

   The CAPWAP data channel contains some IEEE 802.11 management traffic
   including association/disassociation, reassociation, and
   deauthentication.  It also may contain potentially sensitive user
   data.  If we assume that threats to this channel exist (i.e., it
   traverses potentially hostile hops), then providing strong mutual
   authentication coupled with data origin/integrity verification would
   prevent an adversary from injecting and/or modifying transit data, or
   impersonating a valid AC or WTP.  Adding confidentiality would
   prevent eavesdropping.

<span class="h2"><a class="selflink" name="section-11" href="#section-11">11</a>.  Countermeasures Provided by DTLS</span>

   Datagram TLS (DTLS) is the currently proposed security solution for
   CAPWAP.  DTLS supports the following security functionality:

   o  Mutual Authentication (pre-shared secrets or X.509 Certificates)

   o  Mutual Authorization (pre-shared secrets or X.509 Certificates)

   o  Data Origin Authentication

   o  Data Integrity Verification

   o  Anti-replay

   o  Confidentiality (supports strong cryptographic algorithms)

   Using DTLS for both the control and data channels mitigates nearly
   all risks resulting from splitting the AP function in two.





<span class="grey">Kelly &amp; Clancy               Informational                     [Page 30]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-31" id="page-31" href="#page-31" class="invisible"> </a>
<span class="grey"><a href="rfc5418.html">RFC 5418</a>             CAPWAP 802.11 Threat Analysis            March 2009</span>


<span class="h2"><a class="selflink" name="section-12" href="#section-12">12</a>.  Issues Not Addressed By DTLS</span>

   Unfortunately, DTLS does not solve all of our CAPWAP security
   concerns.  There are some things it just cannot prevent.  These are
   enumerated below.

<span class="h3"><a class="selflink" name="section-12.1" href="#section-12.1">12.1</a>.  DoS Attacks</span>

   Even with the security provided by DTLS, CAPWAP is still susceptible
   to various types of DoS attack:

   o  Session Initialization: an adversary could initiate thousands of
      DTLS handshakes simultaneously in order to exhaust memory
      resources on the AC; DTLS provides a mitigation tool via the
      HelloVerifyRequest, which ensures that the initiator can receive
      packets at the claimed source address prior to allocating
      resources.  However, this would not thwart a botnet-style attack.

   o  Cryptographic DoS: an adversary could flood either the AC or WTP
      with properly formed DTLS records containing garbage, causing the
      recipient to waste compute cycles decrypting and authenticating
      the traffic.

   o  Session interference: a MitM could either drop important session
      establishment packets or inject bogus connection resets during
      session establishment phase.  It could also interfere with other
      traffic in an established session.

   These attacks can be mitigated through various mechanisms, but not
   entirely avoided.  For example, session initialization can be rate-
   limited, and in case of resource exhaustion, some number of
   incompletely initialized sessions could be discarded.  Also, such
   events should be strictly audited.

   Likewise, cryptographic DoS attacks are detectable if appropriate
   auditing and monitoring controls are implemented.  When detected,
   these events should (at minimum) trigger an alert.  Additional
   mitigation might be realized by randomly discarding packets.

   Session interference is probably the most difficult of DoS attacks.
   It is very difficult to detect in real-time, although it may be
   detected if exceeding a lost packet threshold triggers an alert.
   However, this depends on the MitM not being in a position to delete
   the alert before it reaches its appropriate destination.







<span class="grey">Kelly &amp; Clancy               Informational                     [Page 31]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-32" id="page-32" href="#page-32" class="invisible"> </a>
<span class="grey"><a href="rfc5418.html">RFC 5418</a>             CAPWAP 802.11 Threat Analysis            March 2009</span>


<span class="h3"><a class="selflink" name="section-12.2" href="#section-12.2">12.2</a>.  Passive Monitoring (Sniffing)</span>

   CAPWAP protocol security cannot prevent (or detect) passive
   monitoring.  The best we can do is provide a confidentiality
   mechanism.

<span class="h3"><a class="selflink" name="section-12.3" href="#section-12.3">12.3</a>.  Traffic Analysis</span>

   DTLS provides no defense for traffic analysis.  If this is a concern,
   there are traffic generation and padding techniques designed to
   mitigate this threat, but none of these are currently specified for
   CAPWAP.

<span class="h3"><a class="selflink" name="section-12.4" href="#section-12.4">12.4</a>.  Active MitM Interference</span>

   This was discussed in more limited scope in the section above on DoS
   attacks.  An active MitM can delete or re-order packets in a manner
   that is very difficult to detect, and there is little the CAPWAP
   protocol can do in such cases.  If packet loss is reported upon
   exceeding some threshold, then perhaps detection might be possible,
   but this is not guaranteed.

<span class="h3"><a class="selflink" name="section-12.5" href="#section-12.5">12.5</a>.  Other Active Attacks</span>

   In addition to the issues raised above, there are other active
   attacks that can be mounted if the adversary has access to the wired
   medium.  For example, the adversary may be able to impersonate a DNS
   or DHCP server, or to poison either a DNS or ARP cache.  Such attacks
   are beyond the scope of CAPWAP, and point to an underlying LAN
   security problem.

<span class="h2"><a class="selflink" name="section-13" href="#section-13">13</a>.  Security Considerations</span>

   This document outlines a threat analysis for CAPWAP in the context of
   IEEE 802.11 deployments, and as such, no additional CAPWAP-related
   security considerations are described here.  However, in some cases
   additional management channels (e.g., Simple Network Management
   Protocol (SNMP)) may be introduced into CAPWAP deployments.  Whenever
   this occurs, related security considerations MUST be described in
   detail in those documents.

<span class="h2"><a class="selflink" name="section-14" href="#section-14">14</a>.  Acknowledgements</span>

   The authors gratefully acknowledge the reviews and helpful comments
   of Dan Romascanu, Joe Salowey, Sam Hartman, Mahalingham Mani, and
   Pasi Eronen.





<span class="grey">Kelly &amp; Clancy               Informational                     [Page 32]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-33" id="page-33" href="#page-33" class="invisible"> </a>
<span class="grey"><a href="rfc5418.html">RFC 5418</a>             CAPWAP 802.11 Threat Analysis            March 2009</span>


<span class="h2"><a class="selflink" name="section-15" href="#section-15">15</a>.  References</span>

<span class="h3"><a class="selflink" name="section-15.1" href="#section-15.1">15.1</a>.  Normative References</span>

   [<a name="ref-80211I" id="ref-80211I">80211I</a>]    "IEEE Std 802.11i: WLAN Specification for Enhanced
               Security", April 2004.

   [<a name="ref-80211SEC" id="ref-80211SEC">80211SEC</a>]  Edney, J. and W. Arbaugh, "Real 802.11 Security - Wi-Fi
               protected Access and 802.11i", 2004.

   [<a name="ref-8021X" id="ref-8021X">8021X</a>]     "IEEE Std 802.1X-2004: Port-based Network Access
               Control", December 2004.

   [<a name="ref-RFC2119" id="ref-RFC2119">RFC2119</a>]   Bradner, S., "Key words for use in RFCs to Indicate
               Requirement Levels", <a href="http://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.

   [<a name="ref-RFC4118" id="ref-RFC4118">RFC4118</a>]   Yang, L., Zerfos, P., and E. Sadot, "Architecture
               Taxonomy for Control and Provisioning of Wireless Access
               Points (CAPWAP)", <a href="rfc4118.html">RFC 4118</a>, June 2005.

   [<a name="ref-RFC5415" id="ref-RFC5415">RFC5415</a>]   Calhoun, P., Ed., Montemurro, M., Ed., and D. Stanley,
               Ed., "Control And Provisioning of Wireless Access Points
               (CAPWAP) Protocol Specification", <a href="rfc5415.html">RFC 5415</a>, March 2009.

   [<a name="ref-RFC5416" id="ref-RFC5416">RFC5416</a>]   Calhoun, P., Ed., Montemurro, M., Ed., and D. Stanley,
               Ed., "Control And Provisioning of Wireless Access Points
               (CAPWAP) Protocol Binding for IEEE 802.11", <a href="rfc5416.html">RFC 5416</a>,
               March 2009.

<span class="h3"><a class="selflink" name="section-15.2" href="#section-15.2">15.2</a>.  Informative References</span>

   [<a name="ref-RFC3579" id="ref-RFC3579">RFC3579</a>]   Aboba, B. and P. Calhoun, "RADIUS (Remote Authentication
               Dial In User Service) Support For Extensible
               Authentication Protocol (EAP)", <a href="rfc3579.html">RFC 3579</a>, September 2003.

   [<a name="ref-RFC3748" id="ref-RFC3748">RFC3748</a>]   Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H.
               Levkowetz, "Extensible Authentication Protocol (EAP)",
               <a href="rfc3748.html">RFC 3748</a>, June 2004.

   [<a name="ref-RFC4072" id="ref-RFC4072">RFC4072</a>]   Eronen, P., Hiller, T., and G. Zorn, "Diameter Extensible
               Authentication Protocol (EAP) Application", <a href="rfc4072.html">RFC 4072</a>,
               August 2005.

   [<a name="ref-RFC4962" id="ref-RFC4962">RFC4962</a>]   Housley, R. and B. Aboba, "Guidance for Authentication,
               Authorization, and Accounting (AAA) Key Management",
               <a href="http://tools.ietf.org/html/bcp132">BCP 132</a>, <a href="rfc4962.html">RFC 4962</a>, July 2007.





<span class="grey">Kelly &amp; Clancy               Informational                     [Page 33]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-34" id="page-34" href="#page-34" class="invisible"> </a>
<span class="grey"><a href="rfc5418.html">RFC 5418</a>             CAPWAP 802.11 Threat Analysis            March 2009</span>


   [<a name="ref-WEPSEC" id="ref-WEPSEC">WEPSEC</a>]    Petroni, N. and W. Arbaugh, "The Dangers of Mitigating
               Security Design Flaws: A Wireless Case Study",
               January 2003.

Authors' Addresses

   Scott G. Kelly
   Aruba Networks
   1322 Crossman Ave
   Sunnyvale, CA  94089
   US

   EMail: scott@hyperthought.com


   T. Charles Clancy
   DoD Laboratory for Telecommunications Sciences
   8080 Greenmead Drive
   College Park, MD  20740
   US

   EMail: clancy@LTSnet.net





























Kelly &amp; Clancy               Informational                     [Page 34]

</pre><br />
<span class="noprint"><small><small>Html markup produced by rfcmarkup 1.106, available from
<a href="http://tools.ietf.org/tools/rfcmarkup/">http://tools.ietf.org/tools/rfcmarkup/</a>
</small></small></span>
</body>
<!-- Mirrored from tools.ietf.org/html/rfc5418 by HTTrack Website Copier/3.x [XR&CO'2010], Wed, 19 Mar 2014 18:37:05 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8"><!-- /Added by HTTrack -->
</html>
