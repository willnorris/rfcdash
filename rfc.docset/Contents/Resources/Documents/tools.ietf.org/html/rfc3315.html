<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc3315 by HTTrack Website Copier/3.x [XR&CO'2013], Sat, 07 Jun 2014 20:18:50 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.107" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="urn:ietf:rfc:3315" name="DC.Identifier"/>
<meta content='The Dynamic Host Configuration Protocol for IPv6 (DHCP) enables DHCP\nservers to pass configuration parameters such as IPv6 network\naddresses to IPv6 nodes. It offers the capability of automatic\nallocation of reusable network addresses and additional configuration\nflexibility. This protocol is a stateful counterpart to "IPv6\nStateless Address Autoconfiguration" (RFC2462), and can be used\nseparately or concurrently with the latter to obtain configuration\nparameters.  Contents' name="DC.Description.Abstract"/>
<meta content="Bound, Jim" name="DC.Creator"/>
<meta content="Volz, Bernie" name="DC.Creator"/>
<meta content="Perkins, Charles E." name="DC.Creator"/>
<meta content="Lemon, Ted" name="DC.Creator"/>
<meta content="Carney, Mike" name="DC.Creator"/>
<meta content="July, 2003" name="DC.Date.Issued"/>
<meta content="Dynamic Host Configuration Protocol for IPv6 (DHCPv6)" name="DC.Title"/>

    <link href="http://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="http://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 3315 - Dynamic Host Configuration Protocol for IPv6 (DHCPv6)</title>
    
    
    <style type="text/css">
	body {
	    margin: 0px 8px;
            font-size: 1em;
	}
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgblue" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="http://tools.ietf.org/rfc/rfc3315.txt" title="Plaintext version of this document">txt</a>|<a href="http://tools.ietf.org/pdf/rfc3315" title="PDF version of this document">pdf</a>] [<a href="http://tools.ietf.org/html/draft-ietf-dhc-dhcpv6" title="draft-ietf-dhc-dhcpv6">draft-ietf-dhc-dh...</a>] [<a href="http://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc3315" title="Inline diff (wdiff)">Diff1</a>] [<a href="http://tools.ietf.org/rfcdiff?url2=rfc3315" title="Side-by-side diff">Diff2</a>] [<a href="http://www.rfc-editor.org/errata_search.php?rfc=3315">Errata</a>]        </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">Updated by: <a href="rfc4361.html">4361</a>, <a href="rfc5494.html">5494</a>, <a href="rfc6221.html">6221</a>, <a href="rfc6422.html">6422</a>, <a href="rfc6644.html">6644</a>, <a href="rfc7083.html">7083</a>,        PROPOSED STANDARD</span><br/>
<span class="pre noprint docinfo">            <a href="rfc7227.html">7227</a>                                            <span style="color: #C00;">Errata Exist</span></span><br/>
<pre>Network Working Group                                      R. Droms, Ed.
Request for Comments: 3315                                         Cisco
Category: Standards Track                                       J. Bound
                                                         Hewlett Packard
                                                                 B. Volz
                                                                Ericsson
                                                                T. Lemon
                                                                 Nominum
                                                              C. Perkins
                                                   Nokia Research Center
                                                               M. Carney
                                                        Sun Microsystems
                                                               July 2003


         <span class="h1">Dynamic Host Configuration Protocol for IPv6 (DHCPv6)</span>

Status of this Memo

   This document specifies an Internet standards track protocol for the
   Internet community, and requests discussion and suggestions for
   improvements.  Please refer to the current edition of the "Internet
   Official Protocol Standards" (STD 1) for the standardization state
   and status of this protocol.  Distribution of this memo is unlimited.

Copyright Notice

   Copyright (C) The Internet Society (2003).  All Rights Reserved.

Abstract

   The Dynamic Host Configuration Protocol for IPv6 (DHCP) enables DHCP
   servers to pass configuration parameters such as IPv6 network
   addresses to IPv6 nodes.  It offers the capability of automatic
   allocation of reusable network addresses and additional configuration
   flexibility.  This protocol is a stateful counterpart to "IPv6
   Stateless Address Autoconfiguration" (<a href="rfc2462.html">RFC 2462</a>), and can be used
   separately or concurrently with the latter to obtain configuration
   parameters.












<span class="grey">Droms, et al.               Standards Track                     [Page 1]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


Table of Contents

   <a href="#section-1">1</a>.  Introduction and Overview . . . . . . . . . . . . . . . . . .   <a href="#page-5">5</a>
       <a href="#section-1.1">1.1</a>.   Protocols and Addressing . . . . . . . . . . . . . . .   <a href="#page-6">6</a>
       <a href="#section-1.2">1.2</a>.   Client-server Exchanges Involving Two Messages . . . .   <a href="#page-6">6</a>
       <a href="#section-1.3">1.3</a>.   Client-server Exchanges Involving Four Messages. . . .   <a href="#page-7">7</a>
   <a href="#section-2">2</a>.  Requirements. . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-7">7</a>
   <a href="#section-3">3</a>.  Background. . . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-8">8</a>
   <a href="#section-4">4</a>.  Terminology . . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-8">8</a>
       <a href="#section-4.1">4.1</a>.   IPv6 Terminology . . . . . . . . . . . . . . . . . . .   <a href="#page-9">9</a>
       <a href="#section-4.2">4.2</a>.   DHCP Terminology . . . . . . . . . . . . . . . . . . .  <a href="#page-10">10</a>
   <a href="#section-5">5</a>.  DHCP Constants. . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-12">12</a>
       <a href="#section-5.1">5.1</a>.   Multicast Addresses. . . . . . . . . . . . . . . . . .  <a href="#page-13">13</a>
       <a href="#section-5.2">5.2</a>.   UDP Ports. . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-13">13</a>
       <a href="#section-5.3">5.3</a>.   DHCP Message Types . . . . . . . . . . . . . . . . . .  <a href="#page-13">13</a>
       <a href="#section-5.4">5.4</a>.   Status Codes . . . . . . . . . . . . . . . . . . . . .  <a href="#page-15">15</a>
       <a href="#section-5.5">5.5</a>.   Transmission and Retransmission Parameters . . . . . .  <a href="#page-16">16</a>
       5.6    Representation of time values and "Infinity" as a time
              value. . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-16">16</a>
   <a href="#section-6">6</a>.  Client/Server Message Formats . . . . . . . . . . . . . . . .  <a href="#page-16">16</a>
   <a href="#section-7">7</a>.  Relay Agent/Server Message Formats. . . . . . . . . . . . . .  <a href="#page-17">17</a>
       <a href="#section-7.1">7.1</a>.   Relay-forward Message. . . . . . . . . . . . . . . . .  <a href="#page-18">18</a>
       <a href="#section-7.2">7.2</a>.   Relay-reply Message. . . . . . . . . . . . . . . . . .  <a href="#page-19">19</a>
   <a href="#section-8">8</a>.  Representation and Use of Domain Names. . . . . . . . . . . .  <a href="#page-19">19</a>
   <a href="#section-9">9</a>.  DHCP Unique Identifier (DUID) . . . . . . . . . . . . . . . .  <a href="#page-19">19</a>
       <a href="#section-9.1">9.1</a>.   DUID Contents. . . . . . . . . . . . . . . . . . . . .  <a href="#page-20">20</a>
       9.2.   DUID Based on Link-layer Address Plus Time [DUID-LLT].  20
       9.3.   DUID Assigned by Vendor Based on Enterprise Number
              [DUID-EN]. . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-22">22</a>
       <a href="#section-9.4">9.4</a>.   DUID Based on Link-layer Address [DUID-LL] . . . . . .  <a href="#page-22">22</a>
   <a href="#section-10">10</a>. Identity Association. . . . . . . . . . . . . . . . . . . . .  <a href="#page-23">23</a>
   <a href="#section-11">11</a>. Selecting Addresses for Assignment to an IA . . . . . . . . .  <a href="#page-24">24</a>
   <a href="#section-12">12</a>. Management of Temporary Addresses . . . . . . . . . . . . . .  <a href="#page-25">25</a>
   <a href="#section-13">13</a>. Transmission of Messages by a Client. . . . . . . . . . . . .  <a href="#page-25">25</a>
   <a href="#section-14">14</a>. Reliability of Client Initiated Message Exchanges . . . . . .  <a href="#page-26">26</a>
   <a href="#section-15">15</a>. Message Validation. . . . . . . . . . . . . . . . . . . . . .  <a href="#page-27">27</a>
       <a href="#section-15.1">15.1</a>.  Use of Transaction IDs . . . . . . . . . . . . . . . .  <a href="#page-28">28</a>
       <a href="#section-15.2">15.2</a>.  Solicit Message. . . . . . . . . . . . . . . . . . . .  <a href="#page-28">28</a>
       <a href="#section-15.3">15.3</a>.  Advertise Message. . . . . . . . . . . . . . . . . . .  <a href="#page-28">28</a>
       <a href="#section-15.4">15.4</a>.  Request Message. . . . . . . . . . . . . . . . . . . .  <a href="#page-29">29</a>
       <a href="#section-15.5">15.5</a>.  Confirm Message. . . . . . . . . . . . . . . . . . . .  <a href="#page-29">29</a>
       <a href="#section-15.6">15.6</a>.  Renew Message. . . . . . . . . . . . . . . . . . . . .  <a href="#page-29">29</a>
       <a href="#section-15.7">15.7</a>.  Rebind Message . . . . . . . . . . . . . . . . . . . .  <a href="#page-29">29</a>
       <a href="#section-15.8">15.8</a>.  Decline Messages . . . . . . . . . . . . . . . . . . .  <a href="#page-30">30</a>
       <a href="#section-15.9">15.9</a>.  Release Message. . . . . . . . . . . . . . . . . . . .  <a href="#page-30">30</a>
       <a href="#section-15.10">15.10</a>. Reply Message. . . . . . . . . . . . . . . . . . . . .  <a href="#page-30">30</a>
       <a href="#section-15.11">15.11</a>. Reconfigure Message. . . . . . . . . . . . . . . . . .  <a href="#page-31">31</a>
       <a href="#section-15.12">15.12</a>. Information-request Message. . . . . . . . . . . . . .  <a href="#page-31">31</a>



<span class="grey">Droms, et al.               Standards Track                     [Page 2]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


       <a href="#section-15.13">15.13</a>. Relay-forward Message. . . . . . . . . . . . . . . . .  <a href="#page-31">31</a>
       <a href="#section-15.14">15.14</a>. Relay-reply Message. . . . . . . . . . . . . . . . . .  <a href="#page-31">31</a>
   <a href="#section-16">16</a>. Client Source Address and Interface Selection . . . . . . . .  <a href="#page-32">32</a>
   <a href="#section-17">17</a>. DHCP Server Solicitation. . . . . . . . . . . . . . . . . . .  <a href="#page-32">32</a>
       <a href="#section-17.1">17.1</a>.  Client Behavior. . . . . . . . . . . . . . . . . . . .  <a href="#page-32">32</a>
              <a href="#section-17.1.1">17.1.1</a>. Creation of Solicit Messages . . . . . . . . .  <a href="#page-32">32</a>
              <a href="#section-17.1.2">17.1.2</a>. Transmission of Solicit Messages . . . . . . .  <a href="#page-33">33</a>
              <a href="#section-17.1.3">17.1.3</a>. Receipt of Advertise Messages. . . . . . . . .  <a href="#page-35">35</a>
              <a href="#section-17.1.4">17.1.4</a>. Receipt of Reply Message . . . . . . . . . . .  <a href="#page-35">35</a>
       <a href="#section-17.2">17.2</a>.  Server Behavior. . . . . . . . . . . . . . . . . . . .  <a href="#page-36">36</a>
              <a href="#section-17.2.1">17.2.1</a>. Receipt of Solicit Messages  . . . . . . . . .  <a href="#page-36">36</a>
              17.2.2. Creation and Transmission of Advertise Messages 36
              <a href="#section-17.2.3">17.2.3</a>. Creation and Transmission of Reply Messages. .  <a href="#page-38">38</a>
   <a href="#section-18">18</a>. DHCP Client-Initiated Configuration Exchange. . . . . . . . .  <a href="#page-38">38</a>
       <a href="#section-18.1">18.1</a>.  Client Behavior. . . . . . . . . . . . . . . . . . . .  <a href="#page-39">39</a>
              18.1.1. Creation and Transmission of Request Messages.  39
              18.1.2. Creation and Transmission of Confirm Messages.  40
              <a href="#section-18.1.3">18.1.3</a>. Creation and Transmission of Renew Messages. .  <a href="#page-41">41</a>
              18.1.4. Creation and Transmission of Rebind Messages .  43
              18.1.5. Creation and Transmission of Information-
                      request Messages  . . .. . . . . . . . . . . .  <a href="#page-44">44</a>
              18.1.6. Creation and Transmission of Release Messages.  44
              18.1.7. Creation and Transmission of Decline Messages.  46
              <a href="#section-18.1.8">18.1.8</a>. Receipt of Reply Messages. . . . . . . . . . .  <a href="#page-46">46</a>
       <a href="#section-18.2">18.2</a>.  Server Behavior. . . . . . . . . . . . . . . . . . . .  <a href="#page-48">48</a>
              <a href="#section-18.2.1">18.2.1</a>. Receipt of Request Messages. . . . . . . . . .  <a href="#page-49">49</a>
              <a href="#section-18.2.2">18.2.2</a>. Receipt of Confirm Messages. . . . . . . . . .  <a href="#page-50">50</a>
              <a href="#section-18.2.3">18.2.3</a>. Receipt of Renew Messages. . . . . . . . . . .  <a href="#page-51">51</a>
              <a href="#section-18.2.4">18.2.4</a>. Receipt of Rebind Messages . . . . . . . . . .  <a href="#page-51">51</a>
              <a href="#section-18.2.5">18.2.5</a>. Receipt of Information-request Messages. . . .  <a href="#page-52">52</a>
              <a href="#section-18.2.6">18.2.6</a>. Receipt of Release Messages. . . . . . . . . .  <a href="#page-53">53</a>
              <a href="#section-18.2.7">18.2.7</a>. Receipt of Decline Messages. . . . . . . . . .  <a href="#page-53">53</a>
              <a href="#section-18.2.8">18.2.8</a>. Transmission of Reply Messages . . . . . . . .  <a href="#page-54">54</a>
   <a href="#section-19">19</a>. DHCP Server-Initiated Configuration Exchange. . . . . . . . .  <a href="#page-54">54</a>
       <a href="#section-19.1">19.1</a>.  Server Behavior. . . . . . . . . . . . . . . . . . . .  <a href="#page-55">55</a>
              19.1.1. Creation and Transmission of Reconfigure
                      Messages . . . . . . . . . . . . . . . . . . .  <a href="#page-55">55</a>
              19.1.2. Time Out and Retransmission of Reconfigure
                      Messages . . . . . . . . . . . . . . . . . . .  <a href="#page-56">56</a>
       <a href="#section-19.2">19.2</a>.  Receipt of Renew Messages. . . . . . . . . . . . . . .  <a href="#page-56">56</a>
       <a href="#section-19.3">19.3</a>.  Receipt of Information-request Messages. . . . . . . .  <a href="#page-56">56</a>
       <a href="#section-19.4">19.4</a>.  Client Behavior. . . . . . . . . . . . . . . . . . . .  <a href="#page-57">57</a>
              <a href="#section-19.4.1">19.4.1</a>. Receipt of Reconfigure Messages. . . . . . . .  <a href="#page-57">57</a>
              <a href="#section-19.4.2">19.4.2</a>. Creation and Transmission of Renew Messages. .  <a href="#page-58">58</a>
              19.4.3. Creation and Transmission of Information-
                      request Messages . . . . . . . . . . . . . . .  <a href="#page-58">58</a>
              19.4.4. Time Out and Retransmission of Renew or
                      Information-request Messages . . . . . . . . .  <a href="#page-58">58</a>



<span class="grey">Droms, et al.               Standards Track                     [Page 3]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


              <a href="#section-19.4.5">19.4.5</a>. Receipt of Reply Messages. . . . . . . . . . .  <a href="#page-58">58</a>
   <a href="#section-20">20</a>. Relay Agent Behavior. . . . . . . . . . . . . . . . . . . . .  <a href="#page-58">58</a>
       20.1.  Relaying a Client Message or a Relay-forward Message .  59
              <a href="#section-20.1.1">20.1.1</a>. Relaying a Message from a Client . . . . . . .  <a href="#page-59">59</a>
              <a href="#section-20.1.2">20.1.2</a>. Relaying a Message from a Relay Agent. . . . .  <a href="#page-59">59</a>
       <a href="#section-20.2">20.2</a>.  Relaying a Relay-reply Message . . . . . . . . . . . .  <a href="#page-60">60</a>
       <a href="#section-20.3">20.3</a>.  Construction of Relay-reply Messages . . . . . . . . .  <a href="#page-60">60</a>
   <a href="#section-21">21</a>. Authentication of DHCP Messages . . . . . . . . . . . . . . .  <a href="#page-61">61</a>
       21.1.  Security of Messages Sent Between Servers and Relay
              Agents  . . . . . .  . . . . . . . . . . . . . . . . .  <a href="#page-61">61</a>
       <a href="#section-21.2">21.2</a>.  Summary of DHCP Authentication . . . . . . . . . . . .  <a href="#page-63">63</a>
       <a href="#section-21.3">21.3</a>.  Replay Detection . . . . . . . . . . . . . . . . . . .  <a href="#page-63">63</a>
       <a href="#section-21.4">21.4</a>.  Delayed Authentication Protocol. . . . . . . . . . . .  <a href="#page-63">63</a>
              21.4.1. Use of the Authentication Option in the Delayed
                      Authentication Protocol. . . . . . . . . . . .  <a href="#page-64">64</a>
              <a href="#section-21.4.2">21.4.2</a>. Message Validation . . . . . . . . . . . . . .  <a href="#page-65">65</a>
              <a href="#section-21.4.3">21.4.3</a>. Key Utilization  . . . . . . . . . . . . . . .  <a href="#page-65">65</a>
              21.4.4. Client Considerations for Delayed Authentication
                      Protocol . . . . . . . . . . . . . . . . . . .  <a href="#page-66">66</a>
              21.4.5. Server Considerations for Delayed Authentication
                      Protocol . . . . . . . . . . . . . . . . . . .  <a href="#page-67">67</a>
       <a href="#section-21.5">21.5</a>.  Reconfigure Key Authentication Protocol. . . . . . . .  <a href="#page-68">68</a>
              21.5.1. Use of the Authentication Option in the
                      Reconfigure Key Authentication Protocol. . . .  <a href="#page-69">69</a>
              21.5.2. Server considerations for Reconfigure Key
                      protocol . . . . . . . . . . . . . . . . . . .  <a href="#page-69">69</a>
              21.5.3. Client considerations for Reconfigure Key
                      protocol . . . . . . . . . . . . . . . . . . .  <a href="#page-70">70</a>
   <a href="#section-22">22</a>. DHCP Options. . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-70">70</a>
       <a href="#section-22.1">22.1</a>.  Format of DHCP Options . . . . . . . . . . . . . . . .  <a href="#page-71">71</a>
       <a href="#section-22.2">22.2</a>.  Client Identifier Option . . . . . . . . . . . . . . .  <a href="#page-71">71</a>
       <a href="#section-22.3">22.3</a>.  Server Identifier Option . . . . . . . . . . . . . . .  <a href="#page-72">72</a>
       22.4.  Identity Association for Non-temporary Addresses Option 72
       <a href="#section-22.5">22.5</a>.  Identity Association for Temporary Addresses Option. .  <a href="#page-75">75</a>
       <a href="#section-22.6">22.6</a>.  IA Address Option. . . . . . . . . . . . . . . . . . .  <a href="#page-76">76</a>
       <a href="#section-22.7">22.7</a>.  Option Request Option. . . . . . . . . . . . . . . . .  <a href="#page-78">78</a>
       <a href="#section-22.8">22.8</a>.  Preference Option. . . . . . . . . . . . . . . . . . .  <a href="#page-79">79</a>
       <a href="#section-22.9">22.9</a>.  Elapsed Time Option. . . . . . . . . . . . . . . . . .  <a href="#page-79">79</a>
       <a href="#section-22.10">22.10</a>. Relay Message Option . . . . . . . . . . . . . . . . .  <a href="#page-80">80</a>
       <a href="#section-22.11">22.11</a>. Authentication Option. . . . . . . . . . . . . . . . .  <a href="#page-81">81</a>
       <a href="#section-22.12">22.12</a>. Server Unicast Option. . . . . . . . . . . . . . . . .  <a href="#page-82">82</a>
       <a href="#section-22.13">22.13</a>. Status Code Option . . . . . . . . . . . . . . . . . .  <a href="#page-82">82</a>
       <a href="#section-22.14">22.14</a>. Rapid Commit Option. . . . . . . . . . . . . . . . . .  <a href="#page-83">83</a>
       <a href="#section-22.15">22.15</a>. User Class Option. . . . . . . . . . . . . . . . . . .  <a href="#page-84">84</a>
       <a href="#section-22.16">22.16</a>. Vendor Class Option. . . . . . . . . . . . . . . . . .  <a href="#page-85">85</a>
       <a href="#section-22.17">22.17</a>. Vendor-specific Information Option . . . . . . . . . .  <a href="#page-86">86</a>
       <a href="#section-22.18">22.18</a>. Interface-Id Option. . . . . . . . . . . . . . . . . .  <a href="#page-87">87</a>
       <a href="#section-22.19">22.19</a>. Reconfigure Message Option . . . . . . . . . . . . . .  <a href="#page-88">88</a>



<span class="grey">Droms, et al.               Standards Track                     [Page 4]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


       <a href="#section-22.20">22.20</a>. Reconfigure Accept Option. . . . . . . . . . . . . . .  <a href="#page-89">89</a>
   <a href="#section-23">23</a>. Security Considerations . . . . . . . . . . . . . . . . . . .  <a href="#page-89">89</a>
   <a href="#section-24">24</a>. IANA Considerations . . . . . . . . . . . . . . . . . . . . .  <a href="#page-91">91</a>
       <a href="#section-24.1">24.1</a>.  Multicast Addresses. . . . . . . . . . . . . . . . . .  <a href="#page-92">92</a>
       <a href="#section-24.2">24.2</a>.  DHCP Message Types . . . . . . . . . . . . . . . . . .  <a href="#page-93">93</a>
       <a href="#section-24.3">24.3</a>.  DHCP Options . . . . . . . . . . . . . . . . . . . . .  <a href="#page-94">94</a>
       <a href="#section-24.4">24.4</a>.  Status Codes . . . . . . . . . . . . . . . . . . . . .  <a href="#page-95">95</a>
       <a href="#section-24.5">24.5</a>.  DUID . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-95">95</a>
   <a href="#section-25">25</a>. Acknowledgments . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-95">95</a>
   <a href="#section-26">26</a>. References. . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-96">96</a>
       <a href="#section-26.1">26.1</a>.  Normative References . . . . . . . . . . . . . . . . .  <a href="#page-96">96</a>
       <a href="#section-26.2">26.2</a>.  Informative References . . . . . . . . . . . . . . . .  <a href="#page-97">97</a>
   <a href="#appendix-A">A</a>. Appearance of Options in Message Types . . . . . . . . . . . .  <a href="#page-98">98</a>
   <a href="#appendix-B">B</a>. Appearance of Options in the Options Field of DHCP Options . .  <a href="#page-99">99</a>
   Chair's Address . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-99">99</a>
   Authors' Addresses. . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-100">100</a>
   Full Copyright Statement. . . . . . . . . . . . . . . . . . . . . <a href="#page-101">101</a>

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20Introduction%20and%20Overview"></a><a class="selflink" href="#section-1" name="section-1">1</a>. Introduction and Overview</span>

   This document describes DHCP for IPv6 (DHCP), a client/server
   protocol that provides managed configuration of devices.

   DHCP can provide a device with addresses assigned by a DHCP server
   and other configuration information, which are carried in options.
   DHCP can be extended through the definition of new options to carry
   configuration information not specified in this document.

   DHCP is the "stateful address autoconfiguration protocol" and the
   "stateful autoconfiguration protocol" referred to in "IPv6 Stateless
   Address Autoconfiguration" [<a href="#ref-17" title='"IPv6 Stateless Address Autoconfiguration"'>17</a>].

   The operational models and relevant configuration information for
   DHCPv4 [<a href="#ref-18" title='"DHCP Options and BOOTP Vendor Extensions"'>18</a>][19] and DHCPv6 are sufficiently different that
   integration between the two services is not included in this
   document.  If there is sufficient interest and demand, integration
   can be specified in a document that extends DHCPv6 to carry IPv4
   addresses and configuration information.

   The remainder of this introduction summarizes DHCP, explaining the
   message exchange mechanisms and example message flows.  The message
   flows in sections <a href="#section-1.2">1.2</a> and <a href="#section-1.3">1.3</a> are intended as illustrations of DHCP
   operation rather than an exhaustive list of all possible
   client-server interactions.  Sections <a href="#section-17">17</a>, <a href="#section-18">18</a>, and <a href="#section-19">19</a> explain client
   and server operation in detail.






<span class="grey">Droms, et al.               Standards Track                     [Page 5]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.1.%20Protocols%20and%20Addressing"></a><a class="selflink" href="#section-1.1" name="section-1.1">1.1</a>. Protocols and Addressing</span>

   Clients and servers exchange DHCP messages using UDP [<a href="#ref-15" title='"User Datagram Protocol"'>15</a>].  The
   client uses a link-local address or addresses determined through
   other mechanisms for transmitting and receiving DHCP messages.

   DHCP servers receive messages from clients using a reserved,
   link-scoped multicast address.  A DHCP client transmits most messages
   to this reserved multicast address, so that the client need not be
   configured with the address or addresses of DHCP servers.

   To allow a DHCP client to send a message to a DHCP server that is not
   attached to the same link, a DHCP relay agent on the client's link
   will relay messages between the client and server.  The operation of
   the relay agent is transparent to the client and the discussion of
   message exchanges in the remainder of this section will omit the
   description of message relaying by relay agents.

   Once the client has determined the address of a server, it may under
   some circumstances send messages directly to the server using
   unicast.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.2.%20Client-server%20Exchanges%20Involving%20Two%20Messages"></a><a class="selflink" href="#section-1.2" name="section-1.2">1.2</a>. Client-server Exchanges Involving Two Messages</span>

   When a DHCP client does not need to have a DHCP server assign it IP
   addresses, the client can obtain configuration information such as a
   list of available DNS servers [<a href="#ref-20">20</a>] or NTP servers [<a href="#ref-21">21</a>] through a
   single message and reply exchanged with a DHCP server.  To obtain
   configuration information the client first sends an
   Information-Request message to the All_DHCP_Relay_Agents_and_Servers
   multicast address.  Servers respond with a Reply message containing
   the configuration information for the client.

   This message exchange assumes that the client requires only
   configuration information and does not require the assignment of any
   IPv6 addresses.

   When a server has IPv6 addresses and other configuration information
   committed to a client, the client and server may be able to complete
   the exchange using only two messages, instead of four messages as
   described in the next section.  In this case, the client sends a
   Solicit message to the All_DHCP_Relay_Agents_and_Servers requesting
   the assignment of addresses and other configuration information.
   This message includes an indication that the client is willing to
   accept an immediate Reply message from the server.  The server that
   is willing to commit the assignment of addresses to the client





<span class="grey">Droms, et al.               Standards Track                     [Page 6]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


   immediately responds with a Reply message.  The configuration
   information and the addresses in the Reply message are then
   immediately available for use by the client.

   Each address assigned to the client has associated preferred and
   valid lifetimes specified by the server.  To request an extension of
   the lifetimes assigned to an address, the client sends a Renew
   message to the server.  The server sends a Reply message to the
   client with the new lifetimes, allowing the client to continue to use
   the address without interruption.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.3.%20Client-server%20Exchanges%20Involving%20Four%20Messages"></a><a class="selflink" href="#section-1.3" name="section-1.3">1.3</a>. Client-server Exchanges Involving Four Messages</span>

   To request the assignment of one or more IPv6 addresses, a client
   first locates a DHCP server and then requests the assignment of
   addresses and other configuration information from the server.  The
   client sends a Solicit message to the
   All_DHCP_Relay_Agents_and_Servers address to find available DHCP
   servers.  Any server that can meet the client's requirements responds
   with an Advertise message.  The client then chooses one of the
   servers and sends a Request message to the server asking for
   confirmed assignment of addresses and other configuration
   information.  The server responds with a Reply message that contains
   the confirmed addresses and configuration.

   As described in the previous section, the client sends a Renew
   message to the server to extend the lifetimes associated with its
   addresses, allowing the client to continue to use those addresses
   without interruption.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20Requirements"></a><a class="selflink" href="#section-2" name="section-2">2</a>. Requirements</span>

   The keywords MUST, MUST NOT, REQUIRED, SHALL, SHALL NOT, SHOULD,
   SHOULD NOT, RECOMMENDED, MAY, and OPTIONAL, when they appear in this
   document, are to be interpreted as described in [<a href="#ref-1" title='"Key words for use in RFCs to Indicate Requirement Levels"'>1</a>].

   This document also makes use of internal conceptual variables to
   describe protocol behavior and external variables that an
   implementation must allow system administrators to change.  The
   specific variable names, how their values change, and how their
   settings influence protocol behavior are provided to demonstrate
   protocol behavior.  An implementation is not required to have them in
   the exact form described here, so long as its external behavior is
   consistent with that described in this document.







<span class="grey">Droms, et al.               Standards Track                     [Page 7]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20Background"></a><a class="selflink" href="#section-3" name="section-3">3</a>. Background</span>

   The IPv6 Specification provides the base architecture and design of
   IPv6.  Related work in IPv6 that would best serve an implementor to
   study includes the IPv6 Specification [<a href="#ref-3" title='"Internet Protocol, Version 6 (IPv6) Specification"'>3</a>], the IPv6 Addressing
   Architecture [<a href="#ref-5" title='"IP Version 6 Addressing Architecture"'>5</a>], IPv6 Stateless Address Autoconfiguration [<a href="#ref-17" title='"IPv6 Stateless Address Autoconfiguration"'>17</a>], IPv6
   Neighbor Discovery Processing [<a href="#ref-13" title='"Neighbor Discovery for IP Version 6 (IPv6)"'>13</a>], and Dynamic Updates to DNS [<a href="#ref-22" title='"Dynamic Updates in the Domain Name System (DNS UPDATE)"'>22</a>].
   These specifications enable DHCP to build upon the IPv6 work to
   provide both robust stateful autoconfiguration and autoregistration
   of DNS Host Names.

   The IPv6 Addressing Architecture specification [<a href="#ref-5" title='"IP Version 6 Addressing Architecture"'>5</a>] defines the
   address scope that can be used in an IPv6 implementation, and the
   various configuration architecture guidelines for network designers
   of the IPv6 address space.  Two advantages of IPv6 are that support
   for multicast is required and nodes can create link-local addresses
   during initialization.  The availability of these features means that
   a client can use its link-local address and a well-known multicast
   address to discover and communicate with DHCP servers or relay agents
   on its link.

   IPv6 Stateless Address Autoconfiguration [<a href="#ref-17" title='"IPv6 Stateless Address Autoconfiguration"'>17</a>] specifies procedures by
   which a node may autoconfigure addresses based on router
   advertisements [<a href="#ref-13" title='"Neighbor Discovery for IP Version 6 (IPv6)"'>13</a>], and the use of a valid lifetime to support
   renumbering of addresses on the Internet.  In addition, the protocol
   interaction by which a node begins stateless or stateful
   autoconfiguration is specified.  DHCP is one vehicle to perform
   stateful autoconfiguration.  Compatibility with stateless address
   autoconfiguration is a design requirement of DHCP.

   IPv6 Neighbor Discovery [<a href="#ref-13" title='"Neighbor Discovery for IP Version 6 (IPv6)"'>13</a>] is the node discovery protocol in IPv6
   which replaces and enhances functions of ARP [<a href="#ref-14" title='"Ethernet Address Resolution Protocol: Or converting network protocol addresses to 48.bit Ethernet address for transmission on Ethernet hardware"'>14</a>].  To understand
   IPv6 and stateless address autoconfiguration, it is strongly
   recommended that implementors understand IPv6 Neighbor Discovery.

   Dynamic Updates to DNS [<a href="#ref-22" title='"Dynamic Updates in the Domain Name System (DNS UPDATE)"'>22</a>] is a specification that supports the
   dynamic update of DNS records for both IPv4 and IPv6.  DHCP can use
   the dynamic updates to DNS to integrate addresses and name space to
   not only support autoconfiguration, but also autoregistration in
   IPv6.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20Terminology"></a><a class="selflink" href="#section-4" name="section-4">4</a>. Terminology</span>

   This sections defines terminology specific to IPv6 and DHCP used in
   this document.






<span class="grey">Droms, et al.               Standards Track                     [Page 8]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.1.%20IPv6%20Terminology"></a><a class="selflink" href="#section-4.1" name="section-4.1">4.1</a>. IPv6 Terminology</span>

   IPv6 terminology relevant to this specification from the IPv6
   Protocol [<a href="#ref-3" title='"Internet Protocol, Version 6 (IPv6) Specification"'>3</a>], IPv6 Addressing Architecture [<a href="#ref-5" title='"IP Version 6 Addressing Architecture"'>5</a>], and IPv6 Stateless
   Address Autoconfiguration [<a href="#ref-17" title='"IPv6 Stateless Address Autoconfiguration"'>17</a>] is included below.

      address                   An IP layer identifier for an interface
                                or a set of interfaces.

      host                      Any node that is not a router.

      IP                        Internet Protocol Version 6 (IPv6).  The
                                terms IPv4 and IPv6 are used only in
                                contexts where it is necessary to avoid
                                ambiguity.

      interface                 A node's attachment to a link.

      link                      A communication facility or medium over
                                which nodes can communicate at the link
                                layer, i.e., the layer immediately
                                below IP.  Examples are Ethernet (simple
                                or bridged); Token Ring; PPP links,
                                X.25, Frame Relay, or ATM networks; and
                                Internet (or higher) layer "tunnels",
                                such as tunnels over IPv4 or IPv6
                                itself.

      link-layer identifier     A link-layer identifier for an
                                interface.  Examples include IEEE 802
                                addresses for Ethernet or Token Ring
                                network interfaces, and E.164 addresses
                                for ISDN links.

      link-local address        An IPv6 address having a link-only
                                scope, indicated by having the prefix
                                (FE80::/10), that can be used to reach
                                neighboring nodes attached to the same
                                link.  Every interface has a link-local
                                address.

      multicast address         An identifier for a set of interfaces
                                (typically belonging to different
                                nodes).  A packet sent to a multicast
                                address is delivered to all interfaces
                                identified by that address.

      neighbor                  A node attached to the same link.



<span class="grey">Droms, et al.               Standards Track                     [Page 9]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


      node                      A device that implements IP.

      packet                    An IP header plus payload.

      prefix                    The initial bits of an address, or a
                                set of IP addresses that share the same
                                initial bits.

      prefix length             The number of bits in a prefix.

      router                    A node that forwards IP packets not
                                explicitly addressed to itself.

      unicast address           An identifier for a single interface.
                                A packet sent to a unicast address is
                                delivered to the interface identified by
                                that address.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.2.%20DHCP%20Terminology"></a><a class="selflink" href="#section-4.2" name="section-4.2">4.2</a>. DHCP Terminology</span>

   Terminology specific to DHCP can be found below.

      appropriate to the link   An address is "appropriate to the link"
                                when the address is consistent with the
                                DHCP server's knowledge of the network
                                topology, prefix assignment and address
                                assignment policies.

      binding                   A binding (or, client binding) is a
                                group of server data records containing
                                the information the server has about
                                the addresses in an IA or configuration
                                information explicitly assigned to the
                                client.  Configuration information that
                                has been returned to a client through a
                                policy - for example, the information
                                returned to all clients on the same
                                link - does not require a binding.  A
                                binding containing information about
                                an IA is indexed by the tuple &lt;DUID,
                                IA-type, IAID&gt; (where IA-type is the
                                type of address in the IA; for example,
                                temporary).  A binding containing
                                configuration information for a client
                                is indexed by &lt;DUID&gt;.






<span class="grey">Droms, et al.               Standards Track                    [Page 10]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


      configuration parameter   An element of the configuration
                                information set on the server and
                                delivered to the client using DHCP.
                                Such parameters may be used to carry
                                information to be used by a node to
                                configure its network subsystem and
                                enable communication on a link or
                                internetwork, for example.

      DHCP                      Dynamic Host Configuration Protocol
                                for IPv6.  The terms DHCPv4 and DHCPv6
                                are used only in contexts where it is
                                necessary to avoid ambiguity.

      DHCP client (or client)   A node that initiates requests on a link
                                to obtain configuration parameters from
                                one or more DHCP servers.

      DHCP domain               A set of links managed by DHCP and
                                operated by a single administrative
                                entity.

      DHCP realm                A name used to identify the DHCP
                                administrative domain from which a DHCP
                                authentication key was selected.

      DHCP relay agent (or relay agent) A node that acts as an
                                intermediary to deliver DHCP messages
                                between clients and servers, and is on
                                the same link as the client.

      DHCP server (or server)   A node that responds to requests from
                                clients, and may or may not be on the
                                same link as the client(s).

      DUID                      A DHCP Unique IDentifier for a DHCP
                                participant; each DHCP client and server
                                has exactly one DUID.  See <a href="#section-9">section 9</a> for
                                details of the ways in which a DUID may
                                be constructed.

      Identity association (IA) A collection of addresses assigned to
                                a client.  Each IA has an associated
                                IAID.  A client may have more than one
                                IA assigned to it; for example, one for
                                each of its interfaces.





<span class="grey">Droms, et al.               Standards Track                    [Page 11]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


                                Each IA holds one type of address;
                                for example, an identity association
                                for temporary addresses (IA_TA) holds
                                temporary addresses (see "identity
                                association for temporary addresses").
                                Throughout this document, "IA" is used
                                to refer to an identity association
                                without identifying the type of
                                addresses in the IA.

      Identity association identifier (IAID) An identifier for an IA,
                                chosen by the client.  Each IA has an
                                IAID, which is chosen to be unique among
                                all IAIDs for IAs belonging to that
                                client.

      Identity association for non-temporary addresses (IA_NA) An IA
                                that carries assigned addresses that are
                                not temporary addresses (see "identity
                                association for temporary addresses")

      Identity association for temporary addresses (IA_TA) An IA that
                                carries temporary addresses (see <a href="rfc3041.html">RFC</a>
                                <a href="rfc3041.html">3041</a> [<a href="#ref-12" title='"Privacy Extensions for Stateless Address Autoconfiguration in IPv6"'>12</a>]).

      message                   A unit of data carried as the payload
                                of a UDP datagram, exchanged among DHCP
                                servers, relay agents and clients.

      Reconfigure key           A key supplied to a client by a server
                                used to provide security for Reconfigure
                                messages.

      relaying                  A DHCP relay agent relays DHCP messages
                                between DHCP participants.

      transaction ID            An opaque value used to match responses
                                with replies initiated either by a
                                client or server.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20DHCP%20Constants"></a><a class="selflink" href="#section-5" name="section-5">5</a>. DHCP Constants</span>

   This section describes various program and networking constants used
   by DHCP.







<span class="grey">Droms, et al.               Standards Track                    [Page 12]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.1.%20Multicast%20Addresses"></a><a class="selflink" href="#section-5.1" name="section-5.1">5.1</a>. Multicast Addresses</span>

   DHCP makes use of the following multicast addresses:

      All_DHCP_Relay_Agents_and_Servers (FF02::1:2) A link-scoped
                  multicast address used by a client to communicate with
                  neighboring (i.e., on-link) relay agents and servers.
                  All servers and relay agents are members of this
                  multicast group.

      All_DHCP_Servers (FF05::1:3) A site-scoped multicast address used
                  by a relay agent to communicate with servers, either
                  because the relay agent wants to send messages to
                  all servers or because it does not know the unicast
                  addresses of the servers.  Note that in order for
                  a relay agent to use this address, it must have an
                  address of sufficient scope to be reachable by the
                  servers.  All servers within the site are members of
                  this multicast group.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.2.%20UDP%20Ports"></a><a class="selflink" href="#section-5.2" name="section-5.2">5.2</a>. UDP Ports</span>

   Clients listen for DHCP messages on UDP port 546.  Servers and relay
   agents listen for DHCP messages on UDP port 547.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.3.%20DHCP%20Message%20Types"></a><a class="selflink" href="#section-5.3" name="section-5.3">5.3</a>. DHCP Message Types</span>

   DHCP defines the following message types.  More detail on these
   message types can be found in sections <a href="#section-6">6</a> and <a href="#section-7">7</a>.  Message types not
   listed here are reserved for future use.  The numeric encoding for
   each message type is shown in parentheses.

      SOLICIT (1)        A client sends a Solicit message to locate
                         servers.

      ADVERTISE (2)      A server sends an Advertise message to indicate
                         that it is available for DHCP service, in
                         response to a Solicit message received from a
                         client.

      REQUEST (3)        A client sends a Request message to request
                         configuration parameters, including IP
                         addresses, from a specific server.

      CONFIRM (4)        A client sends a Confirm message to any
                         available server to determine whether the
                         addresses it was assigned are still appropriate
                         to the link to which the client is connected.



<span class="grey">Droms, et al.               Standards Track                    [Page 13]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


      RENEW (5)          A client sends a Renew message to the server
                         that originally provided the client's addresses
                         and configuration parameters to extend the
                         lifetimes on the addresses assigned to the
                         client and to update other configuration
                         parameters.

      REBIND (6)         A client sends a Rebind message to any
                         available server to extend the lifetimes on the
                         addresses assigned to the client and to update
                         other configuration parameters; this message is
                         sent after a client receives no response to a
                         Renew message.

      REPLY (7)          A server sends a Reply message containing
                         assigned addresses and configuration parameters
                         in response to a Solicit, Request, Renew,
                         Rebind message received from a client.  A
                         server sends a Reply message containing
                         configuration parameters in response to an
                         Information-request message.  A server sends a
                         Reply message in response to a Confirm message
                         confirming or denying that the addresses
                         assigned to the client are appropriate to the
                         link to which the client is connected.  A
                         server sends a Reply message to acknowledge
                         receipt of a Release or Decline message.

      RELEASE (8)        A client sends a Release message to the server
                         that assigned addresses to the client to
                         indicate that the client will no longer use one
                         or more of the assigned addresses.

      DECLINE (9)        A client sends a Decline message to a server to
                         indicate that the client has determined that
                         one or more addresses assigned by the server
                         are already in use on the link to which the
                         client is connected.

      RECONFIGURE (10)   A server sends a Reconfigure message to a
                         client to inform the client that the server has
                         new or updated configuration parameters, and
                         that the client is to initiate a Renew/Reply
                         or Information-request/Reply transaction with
                         the server in order to receive the updated
                         information.





<span class="grey">Droms, et al.               Standards Track                    [Page 14]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


      INFORMATION-REQUEST (11) A client sends an Information-request
                         message to a server to request configuration
                         parameters without the assignment of any IP
                         addresses to the client.

      RELAY-FORW (12)    A relay agent sends a Relay-forward message
                         to relay messages to servers, either directly
                         or through another relay agent.  The received
                         message, either a client message or a
                         Relay-forward message from another relay
                         agent, is encapsulated in an option in the
                         Relay-forward message.

      RELAY-REPL (13)    A server sends a Relay-reply message to a relay
                         agent containing a message that the relay
                         agent delivers to a client.  The Relay-reply
                         message may be relayed by other relay agents
                         for delivery to the destination relay agent.

                         The server encapsulates the client message as
                         an option in the Relay-reply message, which the
                         relay agent extracts and relays to the client.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.4.%20Status%20Codes"></a><a class="selflink" href="#section-5.4" name="section-5.4">5.4</a>. Status Codes</span>

   DHCPv6 uses status codes to communicate the success or failure of
   operations requested in messages from clients and servers, and to
   provide additional information about the specific cause of the
   failure of a message.  The specific status codes are defined in
   <a href="#section-24.4">section 24.4</a>.





















<span class="grey">Droms, et al.               Standards Track                    [Page 15]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-16" id="page-16" name="page-16"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.5.%20Transmission%20and%20Retransmission%20Parameters"></a><a class="selflink" href="#section-5.5" name="section-5.5">5.5</a>. Transmission and Retransmission Parameters</span>

   This section presents a table of values used to describe the message
   transmission behavior of clients and servers.

   Parameter     Default  Description
   -------------------------------------
   SOL_MAX_DELAY     1 sec   Max delay of first Solicit
   SOL_TIMEOUT       1 sec   Initial Solicit timeout
   SOL_MAX_RT      120 secs  Max Solicit timeout value
   REQ_TIMEOUT       1 sec   Initial Request timeout
   REQ_MAX_RT       30 secs  Max Request timeout value
   REQ_MAX_RC       10       Max Request retry attempts
   CNF_MAX_DELAY     1 sec   Max delay of first Confirm
   CNF_TIMEOUT       1 sec   Initial Confirm timeout
   CNF_MAX_RT        4 secs  Max Confirm timeout
   CNF_MAX_RD       10 secs  Max Confirm duration
   REN_TIMEOUT      10 secs  Initial Renew timeout
   REN_MAX_RT      600 secs  Max Renew timeout value
   REB_TIMEOUT      10 secs  Initial Rebind timeout
   REB_MAX_RT      600 secs  Max Rebind timeout value
   INF_MAX_DELAY     1 sec   Max delay of first Information-request
   INF_TIMEOUT       1 sec   Initial Information-request timeout
   INF_MAX_RT      120 secs  Max Information-request timeout value
   REL_TIMEOUT       1 sec   Initial Release timeout
   REL_MAX_RC        5       MAX Release attempts
   DEC_TIMEOUT       1 sec   Initial Decline timeout
   DEC_MAX_RC        5       Max Decline attempts
   REC_TIMEOUT       2 secs  Initial Reconfigure timeout
   REC_MAX_RC        8       Max Reconfigure attempts
   HOP_COUNT_LIMIT  32       Max hop count in a Relay-forward message

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.6%20%20Representation%20of%20time%20values%20and%20%22Infinity%22%20as%20a%20time%20value"></a><a class="selflink" href="#section-5.6" name="section-5.6">5.6</a>  Representation of time values and "Infinity" as a time value</span>

   All time values for lifetimes, T1 and T2 are unsigned integers.  The
   value 0xffffffff is taken to mean "infinity" when used as a lifetime
   (as in <a href="rfc2461.html">RFC2461</a> [<a href="#ref-17" title='"IPv6 Stateless Address Autoconfiguration"'>17</a>]) or a value for T1 or T2.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20Client%2FServer%20Message%20Formats"></a><a class="selflink" href="#section-6" name="section-6">6</a>. Client/Server Message Formats</span>

   All DHCP messages sent between clients and servers share an identical
   fixed format header and a variable format area for options.

   All values in the message header and in options are in network byte
   order.






<span class="grey">Droms, et al.               Standards Track                    [Page 16]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-17" id="page-17" name="page-17"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


   Options are stored serially in the options field, with no padding
   between the options.  Options are byte-aligned but are not aligned in
   any other way such as on 2 or 4 byte boundaries.

   The following diagram illustrates the format of DHCP messages sent
   between clients and servers:

       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |    msg-type   |               transaction-id                  |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                                                               |
      .                            options                            .
      .                           (variable)                          .
      |                                                               |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

      msg-type             Identifies the DHCP message type; the
                           available message types are listed in
                           <a href="#section-5.3">section 5.3</a>.

      transaction-id       The transaction ID for this message exchange.

      options              Options carried in this message; options are
                           described in <a href="#section-22">section 22</a>.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20Relay%20Agent%2FServer%20Message%20Formats"></a><a class="selflink" href="#section-7" name="section-7">7</a>. Relay Agent/Server Message Formats</span>

   Relay agents exchange messages with servers to relay messages between
   clients and servers that are not connected to the same link.

   All values in the message header and in options are in network byte
   order.

   Options are stored serially in the options field, with no padding
   between the options.  Options are byte-aligned but are not aligned in
   any other way such as on 2 or 4 byte boundaries.













<span class="grey">Droms, et al.               Standards Track                    [Page 17]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-18" id="page-18" name="page-18"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


   There are two relay agent messages, which share the following format:

       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |    msg-type   |   hop-count   |                               |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |
      |                                                               |
      |                         link-address                          |
      |                                                               |
      |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-|
      |                               |                               |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |
      |                                                               |
      |                         peer-address                          |
      |                                                               |
      |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-|
      |                               |                               |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |
      .                                                               .
      .            options (variable number and length)   ....        .
      |                                                               |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   The following sections describe the use of the Relay Agent message
   header.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.1.%20Relay-forward%20Message"></a><a class="selflink" href="#section-7.1" name="section-7.1">7.1</a>. Relay-forward Message</span>

   The following table defines the use of message fields in a Relay-
   forward message.

      msg-type       RELAY-FORW

      hop-count      Number of relay agents that have relayed this
                     message.

      link-address   A global or site-local address that will be used by
                     the server to identify the link on which the client
                     is located.

      peer-address   The address of the client or relay agent from which
                     the message to be relayed was received.

      options        MUST include a "Relay Message option" (see
                     <a href="#section-22.10">section 22.10</a>); MAY include other options added by
                     the relay agent.




<span class="grey">Droms, et al.               Standards Track                    [Page 18]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-19" id="page-19" name="page-19"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.2.%20Relay-reply%20Message"></a><a class="selflink" href="#section-7.2" name="section-7.2">7.2</a>. Relay-reply Message</span>

   The following table defines the use of message fields in a
   Relay-reply message.

      msg-type       RELAY-REPL

      hop-count      Copied from the Relay-forward message

      link-address   Copied from the Relay-forward message

      peer-address   Copied from the Relay-forward message

      options        MUST include a "Relay Message option"; see
                     <a href="#section-22.10">section 22.10</a>; MAY include other options

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/8.%20Representation%20and%20Use%20of%20Domain%20Names"></a><a class="selflink" href="#section-8" name="section-8">8</a>. Representation and Use of Domain Names</span>

   So that domain names may be encoded uniformly, a domain name or a
   list of domain names is encoded using the technique described in
   <a href="rfc1035.html#section-3.1">section3.1 of RFC 1035</a> [<a href="#ref-10" title='"Domain names - implementation and specification"'>10</a>].  A domain name, or list of domain
   names, in DHCP MUST NOT be stored in compressed form, as described in
   <a href="rfc1035.html#section-4.1.4">section4.1.4 of RFC 1035</a>.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/9.%20DHCP%20Unique%20Identifier%20%28DUID%29"></a><a class="selflink" href="#section-9" name="section-9">9</a>. DHCP Unique Identifier (DUID)</span>

   Each DHCP client and server has a DUID.  DHCP servers use DUIDs to
   identify clients for the selection of configuration parameters and in
   the association of IAs with clients.  DHCP clients use DUIDs to
   identify a server in messages where a server needs to be identified.
   See sections <a href="#section-22.2">22.2</a> and <a href="#section-22.3">22.3</a> for the representation of a DUID in a DHCP
   message.

   Clients and servers MUST treat DUIDs as opaque values and MUST only
   compare DUIDs for equality.  Clients and servers MUST NOT in any
   other way interpret DUIDs.  Clients and servers MUST NOT restrict
   DUIDs to the types defined in this document, as additional DUID types
   may be defined in the future.

   The DUID is carried in an option because it may be variable length
   and because it is not required in all DHCP messages.  The DUID is
   designed to be unique across all DHCP clients and servers, and stable
   for any specific client or server - that is, the DUID used by a
   client or server SHOULD NOT change over time if at all possible; for
   example, a device's DUID should not change as a result of a change in
   the device's network hardware.





<span class="grey">Droms, et al.               Standards Track                    [Page 19]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-20" id="page-20" name="page-20"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


   The motivation for having more than one type of DUID is that the DUID
   must be globally unique, and must also be easy to generate.  The sort
   of globally-unique identifier that is easy to generate for any given
   device can differ quite widely.  Also, some devices may not contain
   any persistent storage.  Retaining a generated DUID in such a device
   is not possible, so the DUID scheme must accommodate such devices.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/9.1.%20DUID%20Contents"></a><a class="selflink" href="#section-9.1" name="section-9.1">9.1</a>. DUID Contents</span>

   A DUID consists of a two-octet type code represented in network byte
   order, followed by a variable number of octets that make up the
   actual identifier.  A DUID can be no more than 128 octets long (not
   including the type code).  The following types are currently defined:

      1        Link-layer address plus time
      2        Vendor-assigned unique ID based on Enterprise Number
      3        Link-layer address

   Formats for the variable field of the DUID for each of the above
   types are shown below.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/9.2.%20DUID%20Based%20on%20Link-layer%20Address%20Plus%20Time%20%5BDUID-LLT%5D"></a><a class="selflink" href="#section-9.2" name="section-9.2">9.2</a>. DUID Based on Link-layer Address Plus Time [DUID-LLT]</span>

   This type of DUID consists of a two octet type field containing the
   value 1, a two octet hardware type code, four octets containing a
   time value, followed by link-layer address of any one network
   interface that is connected to the DHCP device at the time that the
   DUID is generated.  The time value is the time that the DUID is
   generated represented in seconds since midnight (UTC), January 1,
   2000, modulo 2^32.  The hardware type MUST be a valid hardware type
   assigned by the IANA as described in <a href="rfc826.html">RFC 826</a> [<a href="#ref-14" title='"Ethernet Address Resolution Protocol: Or converting network protocol addresses to 48.bit Ethernet address for transmission on Ethernet hardware"'>14</a>].  Both the time and
   the hardware type are stored in network byte order.  The link-layer
   address is stored in canonical form, as described in <a href="rfc2464.html">RFC 2464</a> [<a href="#ref-2" title='"Transmission of IPv6 Packets over Ethernet Networks"'>2</a>].

   The following diagram illustrates the format of a DUID-LLT:

     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |               1               |    hardware type (16 bits)    |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                        time (32 bits)                         |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    .                                                               .
    .             link-layer address (variable length)              .
    .                                                               .
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+




<span class="grey">Droms, et al.               Standards Track                    [Page 20]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-21" id="page-21" name="page-21"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


   The choice of network interface can be completely arbitrary, as long
   as that interface provides a globally unique link-layer address for
   the link type, and the same DUID-LLT SHOULD be used in configuring
   all network interfaces connected to the device, regardless of which
   interface's link-layer address was used to generate the DUID-LLT.

   Clients and servers using this type of DUID MUST store the DUID-LLT
   in stable storage, and MUST continue to use this DUID-LLT even if the
   network interface used to generate the DUID-LLT is removed.  Clients
   and servers that do not have any stable storage MUST NOT use this
   type of DUID.

   Clients and servers that use this DUID SHOULD attempt to configure
   the time prior to generating the DUID, if that is possible, and MUST
   use some sort of time source (for example, a real-time clock) in
   generating the DUID, even if that time source could not be configured
   prior to generating the DUID.  The use of a time source makes it
   unlikely that two identical DUID-LLTs will be generated if the
   network interface is removed from the client and another client then
   uses the same network interface to generate a DUID-LLT.  A collision
   between two DUID-LLTs is very unlikely even if the clocks have not
   been configured prior to generating the DUID.

   This method of DUID generation is recommended for all general purpose
   computing devices such as desktop computers and laptop computers, and
   also for devices such as printers, routers, and so on, that contain
   some form of writable non-volatile storage.

   Despite our best efforts, it is possible that this algorithm for
   generating a DUID could result in a client identifier collision.  A
   DHCP client that generates a DUID-LLT using this mechanism MUST
   provide an administrative interface that replaces the existing DUID
   with a newly-generated DUID-LLT.


















<span class="grey">Droms, et al.               Standards Track                    [Page 21]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-22" id="page-22" name="page-22"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/9.3.%20DUID%20Assigned%20by%20Vendor%20Based%20on%20Enterprise%20Number%20%5BDUID-EN%5D"></a><a class="selflink" href="#section-9.3" name="section-9.3">9.3</a>. DUID Assigned by Vendor Based on Enterprise Number [DUID-EN]</span>

   This form of DUID is assigned by the vendor to the device.  It
   consists of the vendor's registered Private Enterprise Number as
   maintained by IANA [<a href="#ref-6">6</a>] followed by a unique identifier assigned by
   the vendor.  The following diagram summarizes the structure of a
   DUID-EN:

     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |               2               |       enterprise-number       |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |   enterprise-number (contd)   |                               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |
    .                           identifier                          .
    .                       (variable length)                       .
    .                                                               .
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   The source of the identifier is left up to the vendor defining it,
   but each identifier part of each DUID-EN MUST be unique to the device
   that is using it, and MUST be assigned to the device at the time it
   is manufactured and stored in some form of non-volatile storage.  The
   generated DUID SHOULD be recorded in non-erasable storage.  The
   enterprise-number is the vendor's registered Private Enterprise
   Number as maintained by IANA [<a href="#ref-6">6</a>].  The enterprise-number is stored as
   an unsigned 32 bit number.

   An example DUID of this type might look like this:

    +---+---+---+---+---+---+---+---+
    | 0 | 2 | 0 | 0 | 0 |  9| 12|192|
    +---+---+---+---+---+---+---+---+
    |132|221| 3 | 0 | 9 | 18|
    +---+---+---+---+---+---+

   This example includes the two-octet type of 2, the Enterprise Number
   (9), followed by eight octets of identifier data
   (0x0CC084D303000912).

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/9.4.%20DUID%20Based%20on%20Link-layer%20Address%20%5BDUID-LL%5D"></a><a class="selflink" href="#section-9.4" name="section-9.4">9.4</a>. DUID Based on Link-layer Address [DUID-LL]</span>

   This type of DUID consists of two octets containing the DUID type 3,
   a two octet network hardware type code, followed by the link-layer
   address of any one network interface that is permanently connected to
   the client or server device.  For example, a host that has a network
   interface implemented in a chip that is unlikely to be removed and



<span class="grey">Droms, et al.               Standards Track                    [Page 22]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-23" id="page-23" name="page-23"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


   used elsewhere could use a DUID-LL.  The hardware type MUST be a
   valid hardware type assigned by the IANA, as described in <a href="rfc826.html">RFC 826</a>
   [<a href="#ref-14" title='"Ethernet Address Resolution Protocol: Or converting network protocol addresses to 48.bit Ethernet address for transmission on Ethernet hardware"'>14</a>].  The hardware type is stored in network byte order.  The
   link-layer address is stored in canonical form, as described in <a href="rfc2464.html">RFC</a>
   <a href="rfc2464.html">2464</a> [<a href="#ref-2" title='"Transmission of IPv6 Packets over Ethernet Networks"'>2</a>].  The following diagram illustrates the format of a DUID-LL:

     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |               3               |    hardware type (16 bits)    |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    .                                                               .
    .             link-layer address (variable length)              .
    .                                                               .
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   The choice of network interface can be completely arbitrary, as long
   as that interface provides a unique link-layer address and is
   permanently attached to the device on which the DUID-LL is being
   generated.  The same DUID-LL SHOULD be used in configuring all
   network interfaces connected to the device, regardless of which
   interface's link-layer address was used to generate the DUID.

   DUID-LL is recommended for devices that have a permanently-connected
   network interface with a link-layer address, and do not have
   nonvolatile, writable stable storage.  DUID-LL MUST NOT be used by
   DHCP clients or servers that cannot tell whether or not a network
   interface is permanently attached to the device on which the DHCP
   client is running.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/10.%20Identity%20Association"></a><a class="selflink" href="#section-10" name="section-10">10</a>. Identity Association</span>

   An "identity-association" (IA) is a construct through which a server
   and a client can identify, group, and manage a set of related IPv6
   addresses.  Each IA consists of an IAID and associated configuration
   information.

   A client must associate at least one distinct IA with each of its
   network interfaces for which it is to request the assignment of IPv6
   addresses from a DHCP server.  The client uses the IAs assigned to an
   interface to obtain configuration information from a server for that
   interface.  Each IA must be associated with exactly one interface.

   The IAID uniquely identifies the IA and must be chosen to be unique
   among the IAIDs on the client.  The IAID is chosen by the client.
   For any given use of an IA by the client, the IAID for that IA MUST
   be consistent across restarts of the DHCP client.  The client may
   maintain consistency either by storing the IAID in non-volatile



<span class="grey">Droms, et al.               Standards Track                    [Page 23]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-24" id="page-24" name="page-24"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


   storage or by using an algorithm that will consistently produce the
   same IAID as long as the configuration of the client has not changed.
   There may be no way for a client to maintain consistency of the IAIDs
   if it does not have non-volatile storage and the client's hardware
   configuration changes.

   The configuration information in an IA consists of one or more IPv6
   addresses along with the times T1 and T2 for the IA.  See <a href="#section-22.4">section</a>
   <a href="#section-22.4">22.4</a> for the representation of an IA in a DHCP message.

   Each address in an IA has a preferred lifetime and a valid lifetime,
   as defined in <a href="rfc2462.html">RFC 2462</a> [<a href="#ref-17" title='"IPv6 Stateless Address Autoconfiguration"'>17</a>].  The lifetimes are transmitted from the
   DHCP server to the client in the IA option.  The lifetimes apply to
   the use of IPv6 addresses, as described in <a href="rfc2462.html#section-5.5.4">section5.5.4 of RFC 2462</a>.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/11.%20Selecting%20Addresses%20for%20Assignment%20to%20an%20IA"></a><a class="selflink" href="#section-11" name="section-11">11</a>. Selecting Addresses for Assignment to an IA</span>

   A server selects addresses to be assigned to an IA according to the
   address assignment policies determined by the server administrator
   and the specific information the server determines about the client
   from some combination of the following sources:

   -  The link to which the client is attached.  The server determines
      the link as follows:

      *  If the server receives the message directly from the client and
         the source address in the IP datagram in which the message was
         received is a link-local address, then the client is on the
         same link to which the interface over which the message was
         received is attached.

      *  If the server receives the message from a forwarding relay
         agent, then the client is on the same link as the one to which
         the interface, identified by the link-address field in the
         message from the relay agent, is attached.

      *  If the server receives the message directly from the client and
         the source address in the IP datagram in which the message was
         received is not a link-local address, then the client is on the
         link identified by the source address in the IP datagram (note
         that this situation can occur only if the server has enabled
         the use of unicast message delivery by the client and the
         client has sent a message for which unicast delivery is
         allowed).

   -  The DUID supplied by the client.

   -  Other information in options supplied by the client.



<span class="grey">Droms, et al.               Standards Track                    [Page 24]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-25" id="page-25" name="page-25"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


   -  Other information in options supplied by the relay agent.

   Any address assigned by a server that is based on an EUI-64
   identifier MUST include an interface identifier with the "u"
   (universal/local) and "g" (individual/group) bits of the interface
   identifier set appropriately, as indicated in section 2.5.1 of <a href="rfc2373.html">RFC</a>
   <a href="rfc2373.html">2373</a> [<a href="#ref-5" title='"IP Version 6 Addressing Architecture"'>5</a>].

   A server MUST NOT assign an address that is otherwise reserved for
   some other purpose.  For example, a server MUST NOT assign reserved
   anycast addresses, as defined in <a href="rfc2526.html">RFC 2526</a>, from any subnet.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/12.%20Management%20of%20Temporary%20Addresses"></a><a class="selflink" href="#section-12" name="section-12">12</a>. Management of Temporary Addresses</span>

   A client may request the assignment of temporary addresses (see <a href="rfc3041.html">RFC</a>
   <a href="rfc3041.html">3041</a> [<a href="#ref-12" title='"Privacy Extensions for Stateless Address Autoconfiguration in IPv6"'>12</a>] for the definition of temporary addresses).  DHCPv6
   handling of address assignment is no different for temporary
   addresses.  DHCPv6 says nothing about details of temporary addresses
   like lifetimes, how clients use temporary addresses, rules for
   generating successive temporary addresses, etc.

   Clients ask for temporary addresses and servers assign them.
   Temporary addresses are carried in the Identity Association for
   Temporary Addresses (IA_TA) option (see <a href="#section-22.5">section 22.5</a>).  Each IA_TA
   option contains at most one temporary address for each of the
   prefixes on the link to which the client is attached.

   The IAID number space for the IA_TA option IAID number space is
   separate from the IA_NA option IAID number space.

   The server MAY update the DNS for a temporary address, as described
   in <a href="rfc3041.html#section-4">section4 of RFC 3041</a>.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/13.%20Transmission%20of%20Messages%20by%20a%20Client"></a><a class="selflink" href="#section-13" name="section-13">13</a>. Transmission of Messages by a Client</span>

   Unless otherwise specified in this document, or in a document that
   describes how IPv6 is carried over a specific type of link (for link
   types that do not support multicast), a client sends DHCP messages to
   the All_DHCP_Relay_Agents_and_Servers.

   A client uses multicast to reach all servers or an individual server.
   An individual server is indicated by specifying that server's DUID in
   a Server Identifier option (see <a href="#section-22.3">section 22.3</a>) in the client's message
   (all servers will receive this message but only the indicated server
   will respond).  All servers are indicated by not supplying this
   option.





<span class="grey">Droms, et al.               Standards Track                    [Page 25]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-26" id="page-26" name="page-26"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


   A client may send some messages directly to a server using unicast,
   as described in <a href="#section-22.12">section 22.12</a>.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/14.%20Reliability%20of%20Client%20Initiated%20Message%20Exchanges"></a><a class="selflink" href="#section-14" name="section-14">14</a>. Reliability of Client Initiated Message Exchanges</span>

   DHCP clients are responsible for reliable delivery of messages in the
   client-initiated message exchanges described in sections <a href="#section-17">17</a> and <a href="#section-18">18</a>.
   If a DHCP client fails to receive an expected response from a server,
   the client must retransmit its message.  This section describes the
   retransmission strategy to be used by clients in client-initiated
   message exchanges.

   Note that the procedure described in this section is slightly
   modified when used with the Solicit message.  The modified procedure
   is described in <a href="#section-17.1.2">section 17.1.2</a>.

   The client begins the message exchange by transmitting a message to
   the server.  The message exchange terminates when either the client
   successfully receives the appropriate response or responses from a
   server or servers, or when the message exchange is considered to have
   failed according to the retransmission mechanism described below.

   The client retransmission behavior is controlled and described by the
   following variables:

      RT     Retransmission timeout

      IRT    Initial retransmission time

      MRC    Maximum retransmission count

      MRT    Maximum retransmission time

      MRD    Maximum retransmission duration

      RAND   Randomization factor

   With each message transmission or retransmission, the client sets RT
   according to the rules given below.  If RT expires before the message
   exchange terminates, the client recomputes RT and retransmits the
   message.

   Each of the computations of a new RT include a randomization factor
   (RAND), which is a random number chosen with a uniform distribution
   between -0.1 and +0.1.  The randomization factor is included to
   minimize synchronization of messages transmitted by DHCP clients.





<span class="grey">Droms, et al.               Standards Track                    [Page 26]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-27" id="page-27" name="page-27"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


   The algorithm for choosing a random number does not need to be
   cryptographically sound.  The algorithm SHOULD produce a different
   sequence of random numbers from each invocation of the DHCP client.

   RT for the first message transmission is based on IRT:

      RT = IRT + RAND*IRT

   RT for each subsequent message transmission is based on the previous
   value of RT:

      RT = 2*RTprev + RAND*RTprev

   MRT specifies an upper bound on the value of RT (disregarding the
   randomization added by the use of RAND).  If MRT has a value of 0,
   there is no upper limit on the value of RT.  Otherwise:

      if (RT &gt; MRT)
         RT = MRT + RAND*MRT

   MRC specifies an upper bound on the number of times a client may
   retransmit a message.  Unless MRC is zero, the message exchange fails
   once the client has transmitted the message MRC times.

   MRD specifies an upper bound on the length of time a client may
   retransmit a message.  Unless MRD is zero, the message exchange fails
   once MRD seconds have elapsed since the client first transmitted the
   message.

   If both MRC and MRD are non-zero, the message exchange fails whenever
   either of the conditions specified in the previous two paragraphs are
   met.

   If both MRC and MRD are zero, the client continues to transmit the
   message until it receives a response.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/15.%20Message%20Validation"></a><a class="selflink" href="#section-15" name="section-15">15</a>. Message Validation</span>

   Clients and servers SHOULD discard any messages that contain options
   that are not allowed to appear in the received message.  For example,
   an IA option is not allowed to appear in an Information-request
   message.  Clients and servers MAY choose to extract information from
   such a message if the information is of use to the recipient.

   A server MUST discard any Solicit, Confirm, Rebind or
   Information-request messages it receives with a unicast destination
   address.




<span class="grey">Droms, et al.               Standards Track                    [Page 27]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-28" id="page-28" name="page-28"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


   Message validation based on DHCP authentication is discussed in
   <a href="#section-21.4.2">section 21.4.2</a>.

   If a server receives a message that contains options it should not
   contain (such as an Information-request message with an IA option),
   is missing options that it should contain, or is otherwise not valid,
   it MAY send a Reply (or Advertise as appropriate) with a Server
   Identifier option, a Client Identifier option if one was included in
   the message and a Status Code option with status UnSpecFail.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/15.1.%20Use%20of%20Transaction%20IDs"></a><a class="selflink" href="#section-15.1" name="section-15.1">15.1</a>. Use of Transaction IDs</span>

   The "transaction-id" field holds a value used by clients and servers
   to synchronize server responses to client messages.  A client SHOULD
   generate a random number that cannot easily be guessed or predicted
   to use as the transaction ID for each new message it sends.  Note
   that if a client generates easily predictable transaction
   identifiers, it may become more vulnerable to certain kinds of
   attacks from off-path intruders.  A client MUST leave the transaction
   ID unchanged in retransmissions of a message.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/15.2.%20Solicit%20Message"></a><a class="selflink" href="#section-15.2" name="section-15.2">15.2</a>. Solicit Message</span>

   Clients MUST discard any received Solicit messages.

   Servers MUST discard any Solicit messages that do not include a
   Client Identifier option or that do include a Server Identifier
   option.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/15.3.%20Advertise%20Message"></a><a class="selflink" href="#section-15.3" name="section-15.3">15.3</a>. Advertise Message</span>

   Clients MUST discard any received Advertise messages that meet any of
   the following conditions:

   -  the message does not include a Server Identifier option.

   -  the message does not include a Client Identifier option.

   -  the contents of the Client Identifier option does not match the
      client's DUID.

   -  the "transaction-id" field value does not match the value the
      client used in its Solicit message.

   Servers and relay agents MUST discard any received Advertise
   messages.





<span class="grey">Droms, et al.               Standards Track                    [Page 28]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-29" id="page-29" name="page-29"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/15.4.%20Request%20Message"></a><a class="selflink" href="#section-15.4" name="section-15.4">15.4</a>. Request Message</span>

   Clients MUST discard any received Request messages.

   Servers MUST discard any received Request message that meet any of
   the following conditions:

   -  the message does not include a Server Identifier option.

   -  the contents of the Server Identifier option do not match the
      server's DUID.

   -  the message does not include a Client Identifier option.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/15.5.%20Confirm%20Message"></a><a class="selflink" href="#section-15.5" name="section-15.5">15.5</a>. Confirm Message</span>

   Clients MUST discard any received Confirm messages.

   Servers MUST discard any received Confirm messages that do not
   include a Client Identifier option or that do include a Server
   Identifier option.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/15.6.%20Renew%20Message"></a><a class="selflink" href="#section-15.6" name="section-15.6">15.6</a>. Renew Message</span>

   Clients MUST discard any received Renew messages.

   Servers MUST discard any received Renew message that meets any of the
   following conditions:

   -  the message does not include a Server Identifier option.

   -  the contents of the Server Identifier option does not match the
      server's identifier.

   -  the message does not include a Client Identifier option.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/15.7.%20Rebind%20Message"></a><a class="selflink" href="#section-15.7" name="section-15.7">15.7</a>. Rebind Message</span>

   Clients MUST discard any received Rebind messages.

   Servers MUST discard any received Rebind messages that do not include
   a Client Identifier option or that do include a Server Identifier
   option.








<span class="grey">Droms, et al.               Standards Track                    [Page 29]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-30" id="page-30" name="page-30"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/15.8.%20Decline%20Messages"></a><a class="selflink" href="#section-15.8" name="section-15.8">15.8</a>. Decline Messages</span>

   Clients MUST discard any received Decline messages.

   Servers MUST discard any received Decline message that meets any of
   the following conditions:

   -  the message does not include a Server Identifier option.

   -  the contents of the Server Identifier option does not match the
      server's identifier.

   -  the message does not include a Client Identifier option.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/15.9.%20Release%20Message"></a><a class="selflink" href="#section-15.9" name="section-15.9">15.9</a>. Release Message</span>

   Clients MUST discard any received Release messages.

   Servers MUST discard any received Release message that meets any of
   the following conditions:

   -  the message does not include a Server Identifier option.

   -  the contents of the Server Identifier option does not match the
      server's identifier.

   -  the message does not include a Client Identifier option.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/15.10.%20Reply%20Message"></a><a class="selflink" href="#section-15.10" name="section-15.10">15.10</a>. Reply Message</span>

   Clients MUST discard any received Reply message that meets any of the
   following conditions:

   -  the message does not include a Server Identifier option.

   -  the "transaction-id" field in the message does not match the value
      used in the original message.

   If the client included a Client Identifier option in the original
   message, the Reply message MUST include a Client Identifier option
   and the contents of the Client Identifier option MUST match the DUID
   of the client; OR, if the client did not include a Client Identifier
   option in the original message, the Reply message MUST NOT include a
   Client Identifier option.

   Servers and relay agents MUST discard any received Reply messages.





<span class="grey">Droms, et al.               Standards Track                    [Page 30]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-31" id="page-31" name="page-31"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/15.11.%20Reconfigure%20Message"></a><a class="selflink" href="#section-15.11" name="section-15.11">15.11</a>. Reconfigure Message</span>

   Servers and relay agents MUST discard any received Reconfigure
   messages.

   Clients MUST discard any Reconfigure messages that meets any of the
   following conditions:

   -  the message was not unicast to the client.

   -  the message does not include a Server Identifier option.

   -  the message does not include a Client Identifier option that
      contains the client's DUID.

   -  the message does not contain a Reconfigure Message option and the
      msg-type must be a valid value.

   -  the message includes any IA options and the msg-type in the
      Reconfigure Message option is INFORMATION-REQUEST.

   -  the message does not include DHCP authentication:

      *  the message does not contain an authentication option.

      *  the message does not pass the authentication validation
         performed by the client.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/15.12.%20Information-request%20Message"></a><a class="selflink" href="#section-15.12" name="section-15.12">15.12</a>. Information-request Message</span>

   Clients MUST discard any received Information-request messages.

   Servers MUST discard any received Information-request message that
   meets any of the following conditions:

   -  The message includes a Server Identifier option and the DUID in
      the option does not match the server's DUID.

   -  The message includes an IA option.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/15.13.%20Relay-forward%20Message"></a><a class="selflink" href="#section-15.13" name="section-15.13">15.13</a>. Relay-forward Message</span>

   Clients MUST discard any received Relay-forward messages.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/15.14.%20Relay-reply%20Message"></a><a class="selflink" href="#section-15.14" name="section-15.14">15.14</a>. Relay-reply Message</span>

   Clients and servers MUST discard any received Relay-reply messages.




<span class="grey">Droms, et al.               Standards Track                    [Page 31]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-32" id="page-32" name="page-32"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/16.%20Client%20Source%20Address%20and%20Interface%20Selection"></a><a class="selflink" href="#section-16" name="section-16">16</a>. Client Source Address and Interface Selection</span>

   When a client sends a DHCP message to the
   All_DHCP_Relay_Agents_and_Servers address, it SHOULD send the message
   through the interface for which configuration information is being
   requested.  However, the client MAY send the message through another
   interface attached to the same link, if and only if the client is
   certain the two interfaces are attached to the same link.  The client
   MUST use a link-local address assigned to the interface for which it
   is requesting configuration information as the source address in the
   header of the IP datagram.

   When a client sends a DHCP message directly to a server using unicast
   (after receiving the Server Unicast option from that server), the
   source address in the header of the IP datagram MUST be an address
   assigned to the interface for which the client is interested in
   obtaining configuration and which is suitable for use by the server
   in responding to the client.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/17.%20DHCP%20Server%20Solicitation"></a><a class="selflink" href="#section-17" name="section-17">17</a>. DHCP Server Solicitation</span>

   This section describes how a client locates servers that will assign
   addresses to IAs belonging to the client.

   The client is responsible for creating IAs and requesting that a
   server assign IPv6 addresses to the IA.  The client first creates an
   IA and assigns it an IAID.  The client then transmits a Solicit
   message containing an IA option describing the IA.  Servers that can
   assign addresses to the IA respond to the client with an Advertise
   message.  The client then initiates a configuration exchange as
   described in <a href="#section-18">section 18</a>.

   If the client will accept a Reply message with committed address
   assignments and other resources in response to the Solicit message,
   the client includes a Rapid Commit option (see <a href="#section-22.14">section 22.14</a>) in the
   Solicit message.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/17.1.%20Client%20Behavior"></a><a class="selflink" href="#section-17.1" name="section-17.1">17.1</a>. Client Behavior</span>

   A client uses the Solicit message to discover DHCP servers configured
   to assign addresses or return other configuration parameters on the
   link to which the client is attached.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/17.1.1.%20Creation%20of%20Solicit%20Messages"></a><a class="selflink" href="#section-17.1.1" name="section-17.1.1">17.1.1</a>. Creation of Solicit Messages</span>

   The client sets the "msg-type" field to SOLICIT.  The client
   generates a transaction ID and inserts this value in the
   "transaction-id" field.



<span class="grey">Droms, et al.               Standards Track                    [Page 32]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-33" id="page-33" name="page-33"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


   The client MUST include a Client Identifier option to identify itself
   to the server.  The client includes IA options for any IAs to which
   it wants the server to assign addresses.  The client MAY include
   addresses in the IAs as a hint to the server about addresses for
   which the client has a preference.  The client MUST NOT include any
   other options in the Solicit message, except as specifically allowed
   in the definition of individual options.

   The client uses IA_NA options to request the assignment of non-
   temporary addresses and uses IA_TA options to request the assignment
   of temporary addresses.  Either IA_NA or IA_TA options, or a
   combination of both, can be included in DHCP messages.

   The client SHOULD include an Option Request option (see <a href="#section-22.7">section 22.7</a>)
   to indicate the options the client is interested in receiving.  The
   client MAY additionally include instances of those options that are
   identified in the Option Request option, with data values as hints to
   the server about parameter values the client would like to have
   returned.

   The client includes a Reconfigure Accept option (see <a href="#section-22.20">section 22.20</a>)
   if the client is willing to accept Reconfigure messages from the
   server.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/17.1.2.%20Transmission%20of%20Solicit%20Messages"></a><a class="selflink" href="#section-17.1.2" name="section-17.1.2">17.1.2</a>. Transmission of Solicit Messages</span>

   The first Solicit message from the client on the interface MUST be
   delayed by a random amount of time between 0 and SOL_MAX_DELAY.  In
   the case of a Solicit message transmitted when DHCP is initiated by
   IPv6 Neighbor Discovery, the delay gives the amount of time to wait
   after IPv6 Neighbor Discovery causes the client to invoke the
   stateful address autoconfiguration protocol (see section 5.5.3 of <a href="rfc2462.html">RFC</a>
   <a href="rfc2462.html">2462</a>).  This random delay desynchronizes clients which start at the
   same time (for example, after a power outage).

   The client transmits the message according to <a href="#section-14">section 14</a>, using the
   following parameters:

      IRT   SOL_TIMEOUT

      MRT   SOL_MAX_RT

      MRC   0

      MRD   0






<span class="grey">Droms, et al.               Standards Track                    [Page 33]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-34" id="page-34" name="page-34"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


   If the client has included a Rapid Commit option in its Solicit
   message, the client terminates the waiting process as soon as a Reply
   message with a Rapid Commit option is received.

   If the client is waiting for an Advertise message, the mechanism in
   <a href="#section-14">section 14</a> is modified as follows for use in the transmission of
   Solicit messages.  The message exchange is not terminated by the
   receipt of an Advertise before the first RT has elapsed.  Rather, the
   client collects Advertise messages until the first RT has elapsed.
   Also, the first RT MUST be selected to be strictly greater than IRT
   by choosing RAND to be strictly greater than 0.

   A client MUST collect Advertise messages for the first RT seconds,
   unless it receives an Advertise message with a preference value of
   255.  The preference value is carried in the Preference option
   (<a href="#section-22.8">section 22.8</a>).  Any Advertise that does not include a Preference
   option is considered to have a preference value of 0.  If the client
   receives an Advertise message that includes a Preference option with
   a preference value of 255, the client immediately begins a client-
   initiated message exchange (as described in <a href="#section-18">section 18</a>) by sending a
   Request message to the server from which the Advertise message was
   received.  If the client receives an Advertise message that does not
   include a Preference option with a preference value of 255, the
   client continues to wait until the first RT elapses.  If the first RT
   elapses and the client has received an Advertise message, the client
   SHOULD continue with a client-initiated message exchange by sending a
   Request message.

   If the client does not receive any Advertise messages before the
   first RT has elapsed, it begins the retransmission mechanism
   described in <a href="#section-14">section 14</a>.  The client terminates the retransmission
   process as soon as it receives any Advertise message, and the client
   acts on the received Advertise message without waiting for any
   additional Advertise messages.

   A DHCP client SHOULD choose MRC and MRD to be 0.  If the DHCP client
   is configured with either MRC or MRD set to a value other than 0, it
   MUST stop trying to configure the interface if the message exchange
   fails.  After the DHCP client stops trying to configure the
   interface, it SHOULD restart the reconfiguration process after some
   external event, such as user input, system restart, or when the
   client is attached to a new link.









<span class="grey">Droms, et al.               Standards Track                    [Page 34]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-35" id="page-35" name="page-35"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/17.1.3.%20Receipt%20of%20Advertise%20Messages"></a><a class="selflink" href="#section-17.1.3" name="section-17.1.3">17.1.3</a>. Receipt of Advertise Messages</span>

   The client MUST ignore any Advertise message that includes a Status
   Code option containing the value NoAddrsAvail, with the exception
   that the client MAY display the associated status message to the
   user.

   Upon receipt of one or more valid Advertise messages, the client
   selects one or more Advertise messages based upon the following
   criteria.

   -  Those Advertise messages with the highest server preference value
      are preferred over all other Advertise messages.

   -  Within a group of Advertise messages with the same server
      preference value, a client MAY select those servers whose
      Advertise messages advertise information of interest to the
      client.  For example, the client may choose a server that returned
      an advertisement with configuration options of interest to the
      client.

   -  The client MAY choose a less-preferred server if that server has a
      better set of advertised parameters, such as the available
      addresses advertised in IAs.

   Once a client has selected Advertise message(s), the client will
   typically store information about each server, such as server
   preference value, addresses advertised, when the advertisement was
   received, and so on.

   If the client needs to select an alternate server in the case that a
   chosen server does not respond, the client chooses the next server
   according to the criteria given above.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/17.1.4.%20Receipt%20of%20Reply%20Message"></a><a class="selflink" href="#section-17.1.4" name="section-17.1.4">17.1.4</a>. Receipt of Reply Message</span>

   If the client includes a Rapid Commit option in the Solicit message,
   it will expect a Reply message that includes a Rapid Commit option in
   response.  The client discards any Reply messages it receives that do
   not include a Rapid Commit option.  If the client receives a valid
   Reply message that includes a Rapid Commit option, it processes the
   message as described in <a href="#section-18.1.8">section 18.1.8</a>.  If it does not receive such
   a Reply message and does receive a valid Advertise message, the
   client processes the Advertise message as described in <a href="#section-17.1.3">section</a>
   <a href="#section-17.1.3">17.1.3</a>.






<span class="grey">Droms, et al.               Standards Track                    [Page 35]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-36" id="page-36" name="page-36"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


   If the client subsequently receives a valid Reply message that
   includes a Rapid Commit option, it either:

      processes the Reply message as described in <a href="#section-18.1.8">section 18.1.8</a>, and
      discards any Reply messages received in response to the Request
      message, or

      processes any Reply messages received in response to the Request
      message and discards the Reply message that includes the Rapid
      Commit option.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/17.2.%20Server%20Behavior"></a><a class="selflink" href="#section-17.2" name="section-17.2">17.2</a>. Server Behavior</span>

   A server sends an Advertise message in response to valid Solicit
   messages it receives to announce the availability of the server to
   the client.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/17.2.1.%20Receipt%20of%20Solicit%20Messages"></a><a class="selflink" href="#section-17.2.1" name="section-17.2.1">17.2.1</a>. Receipt of Solicit Messages</span>

   The server determines the information about the client and its
   location as described in <a href="#section-11">section 11</a> and checks its administrative
   policy about responding to the client.  If the server is not
   permitted to respond to the client, the server discards the Solicit
   message.  For example, if the administrative policy for the server is
   that it may only respond to a client that is willing to accept a
   Reconfigure message, if the client indicates with a Reconfigure
   Accept option in the Solicit message that it will not accept a
   Reconfigure message, the servers discard the Solicit message.

   If the client has included a Rapid Commit option in the Solicit
   message and the server has been configured to respond with committed
   address assignments and other resources, the server responds to the
   Solicit with a Reply message as described in <a href="#section-17.2.3">section 17.2.3</a>.
   Otherwise, the server ignores the Rapid Commit option and processes
   the remainder of the message as if no Rapid Commit option were
   present.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/17.2.2.%20Creation%20and%20Transmission%20of%20Advertise%20Messages"></a><a class="selflink" href="#section-17.2.2" name="section-17.2.2">17.2.2</a>. Creation and Transmission of Advertise Messages</span>

   The server sets the "msg-type" field to ADVERTISE and copies the
   contents of the transaction-id field from the Solicit message
   received from the client to the Advertise message.  The server
   includes its server identifier in a Server Identifier option and
   copies the Client Identifier from the Solicit message into the
   Advertise message.






<span class="grey">Droms, et al.               Standards Track                    [Page 36]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-37" id="page-37" name="page-37"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


   The server MAY add a Preference option to carry the preference value
   for the Advertise message.  The server implementation SHOULD allow
   the setting of a server preference value by the administrator.  The
   server preference value MUST default to zero unless otherwise
   configured by the server administrator.

   The server includes a Reconfigure Accept option if the server wants
   to require that the client accept Reconfigure messages.

   The server includes options the server will return to the client in a
   subsequent Reply message.  The information in these options may be
   used by the client in the selection of a server if the client
   receives more than one Advertise message.  If the client has included
   an Option Request option in the Solicit message, the server includes
   options in the Advertise message containing configuration parameters
   for all of the options identified in the Option Request option that
   the server has been configured to return to the client.  The server
   MAY return additional options to the client if it has been configured
   to do so.  The server must be aware of the recommendations on packet
   sizes and the use of fragmentation in <a href="rfc2460.html#section-5">section5 of RFC 2460</a>.

   If the Solicit message from the client included one or more IA
   options, the server MUST include IA options in the Advertise message
   containing any addresses that would be assigned to IAs contained in
   the Solicit message from the client.  If the client has included
   addresses in the IAs in the Solicit message, the server uses those
   addresses as hints about the addresses the client would like to
   receive.

   If the server will not assign any addresses to any IAs in a
   subsequent Request from the client, the server MUST send an Advertise
   message to the client that includes only a Status Code option with
   code NoAddrsAvail and a status message for the user, a Server
   Identifier option with the server's DUID, and a Client Identifier
   option with the client's DUID.

   If the Solicit message was received directly by the server, the
   server unicasts the Advertise message directly to the client using
   the address in the source address field from the IP datagram in which
   the Solicit message was received.  The Advertise message MUST be
   unicast on the link from which the Solicit message was received.

   If the Solicit message was received in a Relay-forward message, the
   server constructs a Relay-reply message with the Advertise message in
   the payload of a "relay-message" option.  If the Relay-forward
   messages included an Interface-id option, the server copies that
   option to the Relay-reply message.  The server unicasts the
   Relay-reply message directly to the relay agent using the address in



<span class="grey">Droms, et al.               Standards Track                    [Page 37]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-38" id="page-38" name="page-38"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


   the source address field from the IP datagram in which the Relay-
   forward message was received.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/17.2.3.%20Creation%20and%20Transmission%20of%20Reply%20Messages"></a><a class="selflink" href="#section-17.2.3" name="section-17.2.3">17.2.3</a>. Creation and Transmission of Reply Messages</span>

   The server MUST commit the assignment of any addresses or other
   configuration information message before sending a Reply message to a
   client in response to a Solicit message.

   DISCUSSION:

      When using the Solicit-Reply message exchange, the server commits
      the assignment of any addresses before sending the Reply message.
      The client can assume it has been assigned the addresses in the
      Reply message and does not need to send a Request message for
      those addresses.

      Typically, servers that are configured to use the Solicit-Reply
      message exchange will be deployed so that only one server will
      respond to a Solicit message.  If more than one server responds,
      the client will only use the addresses from one of the servers,
      while the addresses from the other servers will be committed to
      the client but not used by the client.

   The server includes a Rapid Commit option in the Reply message to
   indicate that the Reply is in response to a Solicit message.

   The server includes a Reconfigure Accept option if the server wants
   to require that the client accept Reconfigure messages.

   The server produces the Reply message as though it had received a
   Request message, as described in <a href="#section-18.2.1">section 18.2.1</a>.  The server
   transmits the Reply message as described in <a href="#section-18.2.8">section 18.2.8</a>.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/18.%20DHCP%20Client-Initiated%20Configuration%20Exchange"></a><a class="selflink" href="#section-18" name="section-18">18</a>. DHCP Client-Initiated Configuration Exchange</span>

   A client initiates a message exchange with a server or servers to
   acquire or update configuration information of interest.  The client
   may initiate the configuration exchange as part of the operating
   system configuration process, when requested to do so by the
   application layer, when required by Stateless Address
   Autoconfiguration or as required to extend the lifetime of an address
   (Renew and Rebind messages).








<span class="grey">Droms, et al.               Standards Track                    [Page 38]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-39" id="page-39" name="page-39"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/18.1.%20Client%20Behavior"></a><a class="selflink" href="#section-18.1" name="section-18.1">18.1</a>. Client Behavior</span>

   A client uses Request, Renew, Rebind, Release and Decline messages
   during the normal life cycle of addresses.  It uses Confirm to
   validate addresses when it may have moved to a new link.  It uses
   Information-Request messages when it needs configuration information
   but no addresses.

   If the client has a source address of sufficient scope that can be
   used by the server as a return address, and the client has received a
   Server Unicast option (<a href="#section-22.12">section 22.12</a>) from the server, the client
   SHOULD unicast any Request, Renew, Release and Decline messages to
   the server.

   DISCUSSION:

      Use of unicast may avoid delays due to the relaying of messages by
      relay agents, as well as avoid overhead and duplicate responses by
      servers due to the delivery of client messages to multiple
      servers.  Requiring the client to relay all DHCP messages through
      a relay agent enables the inclusion of relay agent options in all
      messages sent by the client.  The server should enable the use of
      unicast only when relay agent options will not be used.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/18.1.1.%20Creation%20and%20Transmission%20of%20Request%20Messages"></a><a class="selflink" href="#section-18.1.1" name="section-18.1.1">18.1.1</a>. Creation and Transmission of Request Messages</span>

   The client uses a Request message to populate IAs with addresses and
   obtain other configuration information.  The client includes one or
   more IA options in the Request message.  The server then returns
   addresses and other information about the IAs to the client in IA
   options in a Reply message.

   The client generates a transaction ID and inserts this value in the
   "transaction-id" field.

   The client places the identifier of the destination server in a
   Server Identifier option.

   The client MUST include a Client Identifier option to identify itself
   to the server.  The client adds any other appropriate options,
   including one or more IA options (if the client is requesting that
   the server assign it some network addresses).

   The client MUST include an Option Request option (see <a href="#section-22.7">section 22.7</a>)
   to indicate the options the client is interested in receiving.  The
   client MAY include options with data values as hints to the server
   about parameter values the client would like to have returned.




<span class="grey">Droms, et al.               Standards Track                    [Page 39]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-40" id="page-40" name="page-40"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


   The client includes a Reconfigure Accept option (see <a href="#section-22.20">section 22.20</a>)
   indicating whether or not the client is willing to accept Reconfigure
   messages from the server.

   The client transmits the message according to <a href="#section-14">section 14</a>, using the
   following parameters:

      IRT   REQ_TIMEOUT

      MRT   REQ_MAX_RT

      MRC   REQ_MAX_RC

      MRD   0

   If the message exchange fails, the client takes an action based on
   the client's local policy.  Examples of actions the client might take
   include:

   -  Select another server from a list of servers known to the client;
      for example, servers that responded with an Advertise message.

   -  Initiate the server discovery process described in <a href="#section-17">section 17</a>.

   -  Terminate the configuration process and report failure.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/18.1.2.%20Creation%20and%20Transmission%20of%20Confirm%20Messages"></a><a class="selflink" href="#section-18.1.2" name="section-18.1.2">18.1.2</a>. Creation and Transmission of Confirm Messages</span>

   Whenever a client may have moved to a new link, the prefixes from the
   addresses assigned to the interfaces on that link may no longer be
   appropriate for the link to which the client is attached.  Examples
   of times when a client may have moved to a new link include:

   o  The client reboots.

   o  The client is physically connected to a wired connection.

   o  The client returns from sleep mode.

   o  The client using a wireless technology changes access points.

   In any situation when a client may have moved to a new link, the
   client MUST initiate a Confirm/Reply message exchange.  The client
   includes any IAs assigned to the interface that may have moved to a
   new link, along with the addresses associated with those IAs, in its






<span class="grey">Droms, et al.               Standards Track                    [Page 40]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-41" id="page-41" name="page-41"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


   Confirm message.  Any responding servers will indicate whether those
   addresses are appropriate for the link to which the client is
   attached with the status in the Reply message it returns to the
   client.

   The client sets the "msg-type" field to CONFIRM.  The client
   generates a transaction ID and inserts this value in the
   "transaction-id" field.

   The client MUST include a Client Identifier option to identify itself
   to the server.  The client includes IA options for all of the IAs
   assigned to the interface for which the Confirm message is being
   sent.  The IA options include all of the addresses the client
   currently has associated with those IAs.  The client SHOULD set the
   T1 and T2 fields in any IA_NA options, and the preferred-lifetime and
   valid-lifetime fields in the IA Address options to 0, as the server
   will ignore these fields.

   The first Confirm message from the client on the interface MUST be
   delayed by a random amount of time between 0 and CNF_MAX_DELAY.  The
   client transmits the message according to <a href="#section-14">section 14</a>, using the
   following parameters:

      IRT   CNF_TIMEOUT

      MRT   CNF_MAX_RT

      MRC   0

      MRD   CNF_MAX_RD

   If the client receives no responses before the message transmission
   process terminates, as described in <a href="#section-14">section 14</a>, the client SHOULD
   continue to use any IP addresses, using the last known lifetimes for
   those addresses, and SHOULD continue to use any other previously
   obtained configuration parameters.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/18.1.3.%20Creation%20and%20Transmission%20of%20Renew%20Messages"></a><a class="selflink" href="#section-18.1.3" name="section-18.1.3">18.1.3</a>. Creation and Transmission of Renew Messages</span>

   To extend the valid and preferred lifetimes for the addresses
   associated with an IA, the client sends a Renew message to the server
   from which the client obtained the addresses in the IA containing an
   IA option for the IA.  The client includes IA Address options in the
   IA option for the addresses associated with the IA.  The server
   determines new lifetimes for the addresses in the IA according to the
   administrative configuration of the server.  The server may also add





<span class="grey">Droms, et al.               Standards Track                    [Page 41]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-42" id="page-42" name="page-42"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


   new addresses to the IA.  The server may remove addresses from the IA
   by setting the preferred and valid lifetimes of those addresses to
   zero.

   The server controls the time at which the client contacts the server
   to extend the lifetimes on assigned addresses through the T1 and T2
   parameters assigned to an IA.

   At time T1 for an IA, the client initiates a Renew/Reply message
   exchange to extend the lifetimes on any addresses in the IA.  The
   client includes an IA option with all addresses currently assigned to
   the IA in its Renew message.

   If T1 or T2 is set to 0 by the server (for an IA_NA) or there are no
   T1 or T2 times (for an IA_TA), the client may send a Renew or Rebind
   message, respectively, at the client's discretion.

   The client sets the "msg-type" field to RENEW.  The client generates
   a transaction ID and inserts this value in the "transaction-id"
   field.

   The client places the identifier of the destination server in a
   Server Identifier option.

   The client MUST include a Client Identifier option to identify itself
   to the server.  The client adds any appropriate options, including
   one or more IA options.  The client MUST include the list of
   addresses the client currently has associated with the IAs in the
   Renew message.

   The client MUST include an Option Request option (see <a href="#section-22.7">section 22.7</a>)
   to indicate the options the client is interested in receiving.  The
   client MAY include options with data values as hints to the server
   about parameter values the client would like to have returned.

   The client transmits the message according to <a href="#section-14">section 14</a>, using the
   following parameters:

      IRT   REN_TIMEOUT

      MRT   REN_MAX_RT

      MRC   0

      MRD   Remaining time until T2






<span class="grey">Droms, et al.               Standards Track                    [Page 42]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-43" id="page-43" name="page-43"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


   The message exchange is terminated when time T2 is reached (see
   <a href="#section-18.1.4">section 18.1.4</a>), at which time the client begins a Rebind message
   exchange.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/18.1.4.%20Creation%20and%20Transmission%20of%20Rebind%20Messages"></a><a class="selflink" href="#section-18.1.4" name="section-18.1.4">18.1.4</a>. Creation and Transmission of Rebind Messages</span>

   At time T2 for an IA (which will only be reached if the server to
   which the Renew message was sent at time T1 has not responded), the
   client initiates a Rebind/Reply message exchange with any available
   server.  The client includes an IA option with all addresses
   currently assigned to the IA in its Rebind message.

   The client sets the "msg-type" field to REBIND.  The client generates
   a transaction ID and inserts this value in the "transaction-id"
   field.

   The client MUST include a Client Identifier option to identify itself
   to the server.  The client adds any appropriate options, including
   one or more IA options.  The client MUST include the list of
   addresses the client currently has associated with the IAs in the
   Rebind message.

   The client MUST include an Option Request option (see <a href="#section-22.7">section 22.7</a>)
   to indicate the options the client is interested in receiving.  The
   client MAY include options with data values as hints to the server
   about parameter values the client would like to have returned.

   The client transmits the message according to <a href="#section-14">section 14</a>, using the
   following parameters:

      IRT   REB_TIMEOUT

      MRT   REB_MAX_RT

      MRC   0

      MRD   Remaining time until valid lifetimes of all addresses have
            expired

   The message exchange is terminated when the valid lifetimes of all
   the addresses assigned to the IA expire (see <a href="#section-10">section 10</a>), at which
   time the client has several alternative actions to choose from; for
   example:

   -  The client may choose to use a Solicit message to locate a new
      DHCP server and send a Request for the expired IA to the new
      server.




<span class="grey">Droms, et al.               Standards Track                    [Page 43]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-44" id="page-44" name="page-44"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


   -  The client may have other addresses in other IAs, so the client
      may choose to discard the expired IA and use the addresses in the
      other IAs.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/18.1.5.%20Creation%20and%20Transmission%20of%20Information-request%20Messages"></a><a class="selflink" href="#section-18.1.5" name="section-18.1.5">18.1.5</a>. Creation and Transmission of Information-request Messages</span>

   The client uses an Information-request message to obtain
   configuration information without having addresses assigned to it.

   The client sets the "msg-type" field to INFORMATION-REQUEST.  The
   client generates a transaction ID and inserts this value in the
   "transaction-id" field.

   The client SHOULD include a Client Identifier option to identify
   itself to the server.  If the client does not include a Client
   Identifier option, the server will not be able to return any client-
   specific options to the client, or the server may choose not to
   respond to the message at all.  The client MUST include a Client
   Identifier option if the Information-Request message will be
   authenticated.

   The client MUST include an Option Request option (see <a href="#section-22.7">section 22.7</a>)
   to indicate the options the client is interested in receiving.  The
   client MAY include options with data values as hints to the server
   about parameter values the client would like to have returned.

   The first Information-request message from the client on the
   interface MUST be delayed by a random amount of time between 0 and
   INF_MAX_DELAY.  The client transmits the message according to <a href="#section-14">section</a>
   <a href="#section-14">14</a>, using the following parameters:

      IRT   INF_TIMEOUT

      MRT   INF_MAX_RT

      MRC   0

      MRD   0

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/18.1.6.%20Creation%20and%20Transmission%20of%20Release%20Messages"></a><a class="selflink" href="#section-18.1.6" name="section-18.1.6">18.1.6</a>. Creation and Transmission of Release Messages</span>

   To release one or more addresses, a client sends a Release message to
   the server.

   The client sets the "msg-type" field to RELEASE.  The client
   generates a transaction ID and places this value in the
   "transaction-id" field.




<span class="grey">Droms, et al.               Standards Track                    [Page 44]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-45" id="page-45" name="page-45"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


   The client places the identifier of the server that allocated the
   address(es) in a Server Identifier option.

   The client MUST include a Client Identifier option to identify itself
   to the server.  The client includes options containing the IAs for
   the addresses it is releasing in the "options" field.  The addresses
   to be released MUST be included in the IAs.  Any addresses for the
   IAs the client wishes to continue to use MUST NOT be added to the
   IAs.

   The client MUST NOT use any of the addresses it is releasing as the
   source address in the Release message or in any subsequently
   transmitted message.

   Because Release messages may be lost, the client should retransmit
   the Release if no Reply is received.  However, there are scenarios
   where the client may not wish to wait for the normal retransmission
   timeout before giving up (e.g., on power down).  Implementations
   SHOULD retransmit one or more times, but MAY choose to terminate the
   retransmission procedure early.

   The client transmits the message according to <a href="#section-14">section 14</a>, using the
   following parameters:

      IRT   REL_TIMEOUT

      MRT   0

      MRC   REL_MAX_RC

      MRD   0

   The client MUST stop using all of the addresses being released as
   soon as the client begins the Release message exchange process.  If
   addresses are released but the Reply from a DHCP server is lost, the
   client will retransmit the Release message, and the server may
   respond with a Reply indicating a status of NoBinding.  Therefore,
   the client does not treat a Reply message with a status of NoBinding
   in a Release message exchange as if it indicates an error.

   Note that if the client fails to release the addresses, each address
   assigned to the IA will be reclaimed by the server when the valid
   lifetime of that address expires.








<span class="grey">Droms, et al.               Standards Track                    [Page 45]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-46" id="page-46" name="page-46"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/18.1.7.%20Creation%20and%20Transmission%20of%20Decline%20Messages"></a><a class="selflink" href="#section-18.1.7" name="section-18.1.7">18.1.7</a>. Creation and Transmission of Decline Messages</span>

   If a client detects that one or more addresses assigned to it by a
   server are already in use by another node, the client sends a Decline
   message to the server to inform it that the address is suspect.

   The client sets the "msg-type" field to DECLINE.  The client
   generates a transaction ID and places this value in the
   "transaction-id" field.

   The client places the identifier of the server that allocated the
   address(es) in a Server Identifier option.

   The client MUST include a Client Identifier option to identify itself
   to the server.  The client includes options containing the IAs for
   the addresses it is declining in the "options" field.  The addresses
   to be declined MUST be included in the IAs.  Any addresses for the
   IAs the client wishes to continue to use should not be in added to
   the IAs.

   The client MUST NOT use any of the addresses it is declining as the
   source address in the Decline message or in any subsequently
   transmitted message.

   The client transmits the message according to <a href="#section-14">section 14</a>, using the
   following parameters:

      IRT   DEC_TIMEOUT

      MRT   0

      MRC   DEC_MAX_RC

      MRD   0

   If addresses are declined but the Reply from a DHCP server is lost,
   the client will retransmit the Decline message, and the server may
   respond with a Reply indicating a status of NoBinding.  Therefore,
   the client does not treat a Reply message with a status of NoBinding
   in a Decline message exchange as if it indicates an error.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/18.1.8.%20Receipt%20of%20Reply%20Messages"></a><a class="selflink" href="#section-18.1.8" name="section-18.1.8">18.1.8</a>. Receipt of Reply Messages</span>

   Upon the receipt of a valid Reply message in response to a Solicit
   (with a Rapid Commit option), Request, Confirm, Renew, Rebind or
   Information-request message, the client extracts the configuration





<span class="grey">Droms, et al.               Standards Track                    [Page 46]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-47" id="page-47" name="page-47"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


   information contained in the Reply.  The client MAY choose to report
   any status code or message from the status code option in the Reply
   message.

   The client SHOULD perform duplicate address detection [<a href="#ref-17" title='"IPv6 Stateless Address Autoconfiguration"'>17</a>] on each of
   the addresses in any IAs it receives in the Reply message before
   using that address for traffic.  If any of the addresses are found to
   be in use on the link, the client sends a Decline message to the
   server as described in <a href="#section-18.1.7">section 18.1.7</a>.

   If the Reply was received in response to a Solicit (with a Rapid
   Commit option), Request, Renew or Rebind message, the client updates
   the information it has recorded about IAs from the IA options
   contained in the Reply message:

   -  Record T1 and T2 times.

   -  Add any new addresses in the IA option to the IA as recorded by
      the client.

   -  Update lifetimes for any addresses in the IA option that the
      client already has recorded in the IA.

   -  Discard any addresses from the IA, as recorded by the client, that
      have a valid lifetime of 0 in the IA Address option.

   -  Leave unchanged any information about addresses the client has
      recorded in the IA but that were not included in the IA from the
      server.

   Management of the specific configuration information is detailed in
   the definition of each option in <a href="#section-22">section 22</a>.

   If the client receives a Reply message with a Status Code containing
   UnspecFail, the server is indicating that it was unable to process
   the message due to an unspecified failure condition.  If the client
   retransmits the original message to the same server to retry the
   desired operation, the client MUST limit the rate at which it
   retransmits the message and limit the duration of the time during
   which it retransmits the message.

   When the client receives a Reply message with a Status Code option
   with the value UseMulticast, the client records the receipt of the
   message and sends subsequent messages to the server through the
   interface on which the message was received using multicast.  The
   client resends the original message using multicast.





<span class="grey">Droms, et al.               Standards Track                    [Page 47]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-48" id="page-48" name="page-48"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


   When the client receives a NotOnLink status from the server in
   response to a Confirm message, the client performs DHCP server
   solicitation, as described in <a href="#section-17">section 17</a>, and client-initiated
   configuration as described in <a href="#section-18">section 18</a>.  If the client receives any
   Reply messages that do not indicate a NotOnLink status, the client
   can use the addresses in the IA and ignore any messages that indicate
   a NotOnLink status.

   When the client receives a NotOnLink status from the server in
   response to a Request, the client can either re-issue the Request
   without specifying any addresses or restart the DHCP server discovery
   process (see <a href="#section-17">section 17</a>).

   The client examines the status code in each IA individually.  If the
   status code is NoAddrsAvail, the client has received no usable
   addresses in the IA and may choose to try obtaining addresses for the
   IA from another server.  The client uses addresses and other
   information from any IAs that do not contain a Status Code option
   with the NoAddrsAvail code.  If the client receives no addresses in
   any of the IAs, it may either try another server (perhaps restarting
   the DHCP server discovery process) or use the Information-request
   message to obtain other configuration information only.

   When the client receives a Reply message in response to a Renew or
   Rebind message, the client examines each IA independently.  For each
   IA in the original Renew or Rebind message, the client:

   -  sends a Request message if the IA contained a Status Code option
      with the NoBinding status (and does not send any additional
      Renew/Rebind messages)

   -  sends a Renew/Rebind if the IA is not in the Reply message

   -  otherwise accepts the information in the IA

   When the client receives a valid Reply message in response to a
   Release message, the client considers the Release event completed,
   regardless of the Status Code option(s) returned by the server.

   When the client receives a valid Reply message in response to a
   Decline message, the client considers the Decline event completed,
   regardless of the Status Code option(s) returned by the server.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/18.2.%20Server%20Behavior"></a><a class="selflink" href="#section-18.2" name="section-18.2">18.2</a>. Server Behavior</span>

   For this discussion, the Server is assumed to have been configured in
   an implementation specific manner with configuration of interest to
   clients.



<span class="grey">Droms, et al.               Standards Track                    [Page 48]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-49" id="page-49" name="page-49"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


   In most instances, the server will send a Reply in response to a
   client message.  This Reply message MUST always contain the Server
   Identifier option containing the server's DUID and the Client
   Identifier option from the client message if one was present.

   In most Reply messages, the server includes options containing
   configuration information for the client.  The server must be aware
   of the recommendations on packet sizes and the use of fragmentation
   in <a href="rfc2460.html#section-5">section5 of RFC 2460</a>.  If the client included an Option Request
   option in its message, the server includes options in the Reply
   message containing configuration parameters for all of the options
   identified in the Option Request option that the server has been
   configured to return to the client.  The server MAY return additional
   options to the client if it has been configured to do so.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/18.2.1.%20Receipt%20of%20Request%20Messages"></a><a class="selflink" href="#section-18.2.1" name="section-18.2.1">18.2.1</a>. Receipt of Request Messages</span>

   When the server receives a Request message via unicast from a client
   to which the server has not sent a unicast option, the server
   discards the Request message and responds with a Reply message
   containing a Status Code option with the value UseMulticast, a Server
   Identifier option containing the server's DUID, the Client Identifier
   option from the client message, and no other options.

   When the server receives a valid Request message, the server creates
   the bindings for that client according to the server's policy and
   configuration information and records the IAs and other information
   requested by the client.

   The server constructs a Reply message by setting the "msg-type" field
   to REPLY, and copying the transaction ID from the Request message
   into the transaction-id field.

   The server MUST include a Server Identifier option containing the
   server's DUID and the Client Identifier option from the Request
   message in the Reply message.

   If the server finds that the prefix on one or more IP addresses in
   any IA in the message from the client is not appropriate for the link
   to which the client is connected, the server MUST return the IA to
   the client with a Status Code option with the value NotOnLink.

   If the server cannot assign any addresses to an IA in the message
   from the client, the server MUST include the IA in the Reply message
   with no addresses in the IA and a Status Code option in the IA
   containing status code NoAddrsAvail.





<span class="grey">Droms, et al.               Standards Track                    [Page 49]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-50" id="page-50" name="page-50"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


   For any IAs to which the server can assign addresses, the server
   includes the IA with addresses and other configuration parameters,
   and records the IA as a new client binding.

   The server includes a Reconfigure Accept option if the server wants
   to require that the client accept Reconfigure messages.

   The server includes other options containing configuration
   information to be returned to the client as described in <a href="#section-18.2">section</a>
   <a href="#section-18.2">18.2</a>.

   If the server finds that the client has included an IA in the Request
   message for which the server already has a binding that associates
   the IA with the client, the client has resent a Request message for
   which it did not receive a Reply message.  The server either resends
   a previously cached Reply message or sends a new Reply message.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/18.2.2.%20Receipt%20of%20Confirm%20Messages"></a><a class="selflink" href="#section-18.2.2" name="section-18.2.2">18.2.2</a>. Receipt of Confirm Messages</span>

   When the server receives a Confirm message, the server determines
   whether the addresses in the Confirm message are appropriate for the
   link to which the client is attached.  If all of the addresses in the
   Confirm message pass this test, the server returns a status of
   Success.  If any of the addresses do not pass this test, the server
   returns a status of NotOnLink.  If the server is unable to perform
   this test (for example, the server does not have information about
   prefixes on the link to which the client is connected), or there were
   no addresses in any of the IAs sent by the client, the server MUST
   NOT send a reply to the client.

   The server ignores the T1 and T2 fields in the IA options and the
   preferred-lifetime and valid-lifetime fields in the IA Address
   options.

   The server constructs a Reply message by setting the "msg-type" field
   to REPLY, and copying the transaction ID from the Confirm message
   into the transaction-id field.

   The server MUST include a Server Identifier option containing the
   server's DUID and the Client Identifier option from the Confirm
   message in the Reply message.  The server includes a Status Code
   option indicating the status of the Confirm message.









<span class="grey">Droms, et al.               Standards Track                    [Page 50]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-51" id="page-51" name="page-51"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/18.2.3.%20Receipt%20of%20Renew%20Messages"></a><a class="selflink" href="#section-18.2.3" name="section-18.2.3">18.2.3</a>. Receipt of Renew Messages</span>

   When the server receives a Renew message via unicast from a client to
   which the server has not sent a unicast option, the server discards
   the Renew message and responds with a Reply message containing a
   Status Code option with the value UseMulticast, a Server Identifier
   option containing the server's DUID, the Client Identifier option
   from the client message, and no other options.

   When the server receives a Renew message that contains an IA option
   from a client, it locates the client's binding and verifies that the
   information in the IA from the client matches the information stored
   for that client.

   If the server cannot find a client entry for the IA the server
   returns the IA containing no addresses with a Status Code option set
   to NoBinding in the Reply message.

   If the server finds that any of the addresses are not appropriate for
   the link to which the client is attached, the server returns the
   address to the client with lifetimes of 0.

   If the server finds the addresses in the IA for the client then the
   server sends back the IA to the client with new lifetimes and T1/T2
   times.  The server may choose to change the list of addresses and the
   lifetimes of addresses in IAs that are returned to the client.

   The server constructs a Reply message by setting the "msg-type" field
   to REPLY, and copying the transaction ID from the Renew message into
   the transaction-id field.

   The server MUST include a Server Identifier option containing the
   server's DUID and the Client Identifier option from the Renew message
   in the Reply message.

   The server includes other options containing configuration
   information to be returned to the client as described in <a href="#section-18.2">section</a>
   <a href="#section-18.2">18.2</a>.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/18.2.4.%20Receipt%20of%20Rebind%20Messages"></a><a class="selflink" href="#section-18.2.4" name="section-18.2.4">18.2.4</a>. Receipt of Rebind Messages</span>

   When the server receives a Rebind message that contains an IA option
   from a client, it locates the client's binding and verifies that the
   information in the IA from the client matches the information stored
   for that client.






<span class="grey">Droms, et al.               Standards Track                    [Page 51]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-52" id="page-52" name="page-52"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


   If the server cannot find a client entry for the IA and the server
   determines that the addresses in the IA are not appropriate for the
   link to which the client's interface is attached according to the
   server's explicit configuration information, the server MAY send a
   Reply message to the client containing the client's IA, with the
   lifetimes for the addresses in the IA set to zero.  This Reply
   constitutes an explicit notification to the client that the addresses
   in the IA are no longer valid.  In this situation, if the server does
   not send a Reply message it silently discards the Rebind message.

   If the server finds that any of the addresses are no longer
   appropriate for the link to which the client is attached, the server
   returns the address to the client with lifetimes of 0.

   If the server finds the addresses in the IA for the client then the
   server SHOULD send back the IA to the client with new lifetimes and
   T1/T2 times.

   The server constructs a Reply message by setting the "msg-type" field
   to REPLY, and copying the transaction ID from the Rebind message into
   the transaction-id field.

   The server MUST include a Server Identifier option containing the
   server's DUID and the Client Identifier option from the Rebind
   message in the Reply message.

   The server includes other options containing configuration
   information to be returned to the client as described in <a href="#section-18.2">section</a>
   <a href="#section-18.2">18.2</a>.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/18.2.5.%20Receipt%20of%20Information-request%20Messages"></a><a class="selflink" href="#section-18.2.5" name="section-18.2.5">18.2.5</a>. Receipt of Information-request Messages</span>

   When the server receives an Information-request message, the client
   is requesting configuration information that does not include the
   assignment of any addresses.  The server determines all configuration
   parameters appropriate to the client, based on the server
   configuration policies known to the server.

   The server constructs a Reply message by setting the "msg-type" field
   to REPLY, and copying the transaction ID from the Information-request
   message into the transaction-id field.

   The server MUST include a Server Identifier option containing the
   server's DUID in the Reply message.  If the client included a Client
   Identification option in the Information-request message, the server
   copies that option to the Reply message.





<span class="grey">Droms, et al.               Standards Track                    [Page 52]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-53" id="page-53" name="page-53"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


   The server includes options containing configuration information to
   be returned to the client as described in <a href="#section-18.2">section 18.2</a>.

   If the Information-request message received from the client did not
   include a Client Identifier option, the server SHOULD respond with a
   Reply message containing any configuration parameters that are not
   determined by the client's identity.  If the server chooses not to
   respond, the client may continue to retransmit the
   Information-request message indefinitely.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/18.2.6.%20Receipt%20of%20Release%20Messages"></a><a class="selflink" href="#section-18.2.6" name="section-18.2.6">18.2.6</a>. Receipt of Release Messages</span>

   When the server receives a Release message via unicast from a client
   to which the server has not sent a unicast option, the server
   discards the Release message and responds with a Reply message
   containing a Status Code option with value UseMulticast, a Server
   Identifier option containing the server's DUID, the Client Identifier
   option from the client message, and no other options.

   Upon the receipt of a valid Release message, the server examines the
   IAs and the addresses in the IAs for validity.  If the IAs in the
   message are in a binding for the client, and the addresses in the IAs
   have been assigned by the server to those IAs, the server deletes the
   addresses from the IAs and makes the addresses available for
   assignment to other clients.  The server ignores addresses not
   assigned to the IA, although it may choose to log an error.

   After all the addresses have been processed, the server generates a
   Reply message and includes a Status Code option with value Success, a
   Server Identifier option with the server's DUID, and a Client
   Identifier option with the client's DUID.  For each IA in the Release
   message for which the server has no binding information, the server
   adds an IA option using the IAID from the Release message, and
   includes a Status Code option with the value NoBinding in the IA
   option.  No other options are included in the IA option.

   A server may choose to retain a record of assigned addresses and IAs
   after the lifetimes on the addresses have expired to allow the server
   to reassign the previously assigned addresses to a client.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/18.2.7.%20Receipt%20of%20Decline%20Messages"></a><a class="selflink" href="#section-18.2.7" name="section-18.2.7">18.2.7</a>. Receipt of Decline Messages</span>

   When the server receives a Decline message via unicast from a client
   to which the server has not sent a unicast option, the server
   discards the Decline message and responds with a Reply message
   containing a Status Code option with the value UseMulticast, a Server
   Identifier option containing the server's DUID, the Client Identifier
   option from the client message, and no other options.



<span class="grey">Droms, et al.               Standards Track                    [Page 53]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-54" id="page-54" name="page-54"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


   Upon the receipt of a valid Decline message, the server examines the
   IAs and the addresses in the IAs for validity.  If the IAs in the
   message are in a binding for the client, and the addresses in the IAs
   have been assigned by the server to those IAs, the server deletes the
   addresses from the IAs.  The server ignores addresses not assigned to
   the IA (though it may choose to log an error if it finds such an
   address).

   The client has found any addresses in the Decline messages to be
   already in use on its link.  Therefore, the server SHOULD mark the
   addresses declined by the client so that those addresses are not
   assigned to other clients, and MAY choose to make a notification that
   addresses were declined.  Local policy on the server determines when
   the addresses identified in a Decline message may be made available
   for assignment.

   After all the addresses have been processed, the server generates a
   Reply message and includes a Status Code option with the value
   Success, a Server Identifier option with the server's DUID, and a
   Client Identifier option with the client's DUID.  For each IA in the
   Decline message for which the server has no binding information, the
   server adds an IA option using the IAID from the Release message and
   includes a Status Code option with the value NoBinding in the IA
   option.  No other options are included in the IA option.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/18.2.8.%20Transmission%20of%20Reply%20Messages"></a><a class="selflink" href="#section-18.2.8" name="section-18.2.8">18.2.8</a>. Transmission of Reply Messages</span>

   If the original message was received directly by the server, the
   server unicasts the Reply message directly to the client using the
   address in the source address field from the IP datagram in which the
   original message was received.  The Reply message MUST be unicast
   through the interface on which the original message was received.

   If the original message was received in a Relay-forward message, the
   server constructs a Relay-reply message with the Reply message in the
   payload of a Relay Message option (see <a href="#section-22.10">section 22.10</a>).  If the
   Relay-forward messages included an Interface-id option, the server
   copies that option to the Relay-reply message.  The server unicasts
   the Relay-reply message directly to the relay agent using the address
   in the source address field from the IP datagram in which the
   Relay-forward message was received.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/19.%20DHCP%20Server-Initiated%20Configuration%20Exchange"></a><a class="selflink" href="#section-19" name="section-19">19</a>. DHCP Server-Initiated Configuration Exchange</span>

   A server initiates a configuration exchange to cause DHCP clients to
   obtain new addresses and other configuration information.  For
   example, an administrator may use a server-initiated configuration
   exchange when links in the DHCP domain are to be renumbered.  Other



<span class="grey">Droms, et al.               Standards Track                    [Page 54]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-55" id="page-55" name="page-55"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


   examples include changes in the location of directory servers,
   addition of new services such as printing, and availability of new
   software.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/19.1.%20Server%20Behavior"></a><a class="selflink" href="#section-19.1" name="section-19.1">19.1</a>. Server Behavior</span>

   A server sends a Reconfigure message to cause a client to initiate
   immediately a Renew/Reply or Information-request/Reply message
   exchange with the server.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/19.1.1.%20Creation%20and%20Transmission%20of%20Reconfigure%20Messages"></a><a class="selflink" href="#section-19.1.1" name="section-19.1.1">19.1.1</a>. Creation and Transmission of Reconfigure Messages</span>

   The server sets the "msg-type" field to RECONFIGURE.  The server sets
   the transaction-id field to 0.  The server includes a Server
   Identifier option containing its DUID and a Client Identifier option
   containing the client's DUID in the Reconfigure message.

   The server MAY include an Option Request option to inform the client
   of what information has been changed or new information that has been
   added.  In particular, the server specifies the IA option in the
   Option Request option if the server wants the client to obtain new
   address information.  If the server identifies the IA option in the
   Option Request option, the server MUST include an IA option that
   contains no other sub-options to identify each IA that is to be
   reconfigured on the client.

   Because of the risk of denial of service attacks against DHCP
   clients, the use of a security mechanism is mandated in Reconfigure
   messages.  The server MUST use DHCP authentication in the Reconfigure
   message.

   The server MUST include a Reconfigure Message option (defined in
   <a href="#section-22.19">section 22.19</a>) to select whether the client responds with a Renew
   message or an Information-Request message.

   The server MUST NOT include any other options in the Reconfigure
   except as specifically allowed in the definition of individual
   options.

   A server sends each Reconfigure message to a single DHCP client,
   using an IPv6 unicast address of sufficient scope belonging to the
   DHCP client.  If the server does not have an address to which it can
   send the Reconfigure message directly to the client, the server uses
   a Relay-reply message (as described in <a href="#section-20.3">section 20.3</a>) to send the
   Reconfigure message to a relay agent that will relay the message to
   the client.  The server may obtain the address of the client (and the





<span class="grey">Droms, et al.               Standards Track                    [Page 55]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-56" id="page-56" name="page-56"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


   appropriate relay agent, if required) through the information the
   server has about clients that have been in contact with the server,
   or through some external agent.

   To reconfigure more than one client, the server unicasts a separate
   message to each client.  The server may initiate the reconfiguration
   of multiple clients concurrently; for example, a server may send a
   Reconfigure message to additional clients while previous
   reconfiguration message exchanges are still in progress.

   The Reconfigure message causes the client to initiate a Renew/Reply
   or Information-request/Reply message exchange with the server.  The
   server interprets the receipt of a Renew or Information-request
   message (whichever was specified in the original Reconfigure message)
   from the client as satisfying the Reconfigure message request.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/19.1.2.%20Time%20Out%20and%20Retransmission%20of%20Reconfigure%20Messages"></a><a class="selflink" href="#section-19.1.2" name="section-19.1.2">19.1.2</a>. Time Out and Retransmission of Reconfigure Messages</span>

   If the server does not receive a Renew or Information-request message
   from the client in REC_TIMEOUT milliseconds, the server retransmits
   the Reconfigure message, doubles the REC_TIMEOUT value and waits
   again.  The server continues this process until REC_MAX_RC
   unsuccessful attempts have been made, at which point the server
   SHOULD abort the reconfigure process for that client.

   Default and initial values for REC_TIMEOUT and REC_MAX_RC are
   documented in <a href="#section-5.5">section 5.5</a>.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/19.2.%20Receipt%20of%20Renew%20Messages"></a><a class="selflink" href="#section-19.2" name="section-19.2">19.2</a>. Receipt of Renew Messages</span>

   The server generates and sends a Reply message to the client as
   described in sections <a href="#section-18.2.3">18.2.3</a> and <a href="#section-18.2.8">18.2.8</a>, including options for
   configuration parameters.

   The server MAY include options containing the IAs and new values for
   other configuration parameters in the Reply message, even if those
   IAs and parameters were not requested in the Renew message from the
   client.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/19.3.%20Receipt%20of%20Information-request%20Messages"></a><a class="selflink" href="#section-19.3" name="section-19.3">19.3</a>. Receipt of Information-request Messages</span>

   The server generates and sends a Reply message to the client as
   described in sections <a href="#section-18.2.5">18.2.5</a> and <a href="#section-18.2.8">18.2.8</a>, including options for
   configuration parameters.







<span class="grey">Droms, et al.               Standards Track                    [Page 56]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-57" id="page-57" name="page-57"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


   The server MAY include options containing new values for other
   configuration parameters in the Reply message, even if those
   parameters were not requested in the Information-request message from
   the client.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/19.4.%20Client%20Behavior"></a><a class="selflink" href="#section-19.4" name="section-19.4">19.4</a>. Client Behavior</span>

   A client receives Reconfigure messages sent to the UDP port 546 on
   interfaces for which it has acquired configuration information
   through DHCP.  These messages may be sent at any time.  Since the
   results of a reconfiguration event may affect application layer
   programs, the client SHOULD log these events, and MAY notify these
   programs of the change through an implementation-specific interface.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/19.4.1.%20Receipt%20of%20Reconfigure%20Messages"></a><a class="selflink" href="#section-19.4.1" name="section-19.4.1">19.4.1</a>. Receipt of Reconfigure Messages</span>

   Upon receipt of a valid Reconfigure message, the client responds with
   either a Renew message or an Information-request message as indicated
   by the Reconfigure Message option (as defined in <a href="#section-22.19">section 22.19</a>).  The
   client ignores the transaction-id field in the received Reconfigure
   message.  While the transaction is in progress, the client silently
   discards any Reconfigure messages it receives.

   DISCUSSION:

      The Reconfigure message acts as a trigger that signals the client
      to complete a successful message exchange.  Once the client has
      received a Reconfigure, the client proceeds with the message
      exchange (retransmitting the Renew or Information-request message
      if necessary); the client ignores any additional Reconfigure
      messages until the exchange is complete.  Subsequent Reconfigure
      messages cause the client to initiate a new exchange.

      How does this mechanism work in the face of duplicated or
      retransmitted Reconfigure messages?  Duplicate messages will be
      ignored because the client will begin the exchange after the
      receipt of the first Reconfigure.  Retransmitted messages will
      either trigger the exchange (if the first Reconfigure was not
      received by the client) or will be ignored.  The server can
      discontinue retransmission of Reconfigure messages to the client
      once the server receives the Renew or Information-request message
      from the client.

      It might be possible for a duplicate or retransmitted Reconfigure
      to be sufficiently delayed (and delivered out of order) to arrive
      at the client after the exchange (initiated by the original
      Reconfigure) has been completed.  In this case, the client would
      initiate a redundant exchange.  The likelihood of delayed and out



<span class="grey">Droms, et al.               Standards Track                    [Page 57]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-58" id="page-58" name="page-58"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


      of order delivery is small enough to be ignored.  The consequence
      of the redundant exchange is inefficiency rather than incorrect
      operation.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/19.4.2.%20Creation%20and%20Transmission%20of%20Renew%20Messages"></a><a class="selflink" href="#section-19.4.2" name="section-19.4.2">19.4.2</a>. Creation and Transmission of Renew Messages</span>

   When responding to a Reconfigure, the client creates and sends the
   Renew message in exactly the same manner as outlined in <a href="#section-18.1.3">section</a>
   <a href="#section-18.1.3">18.1.3</a>, with the exception that the client copies the Option Request
   option and any IA options from the Reconfigure message into the Renew
   message.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/19.4.3.%20Creation%20and%20Transmission%20of%20Information-request%20Messages"></a><a class="selflink" href="#section-19.4.3" name="section-19.4.3">19.4.3</a>. Creation and Transmission of Information-request Messages</span>

   When responding to a Reconfigure, the client creates and sends the
   Information-request message in exactly the same manner as outlined in
   <a href="#section-18.1.5">section 18.1.5</a>, with the exception that the client includes a Server
   Identifier option with the identifier from the Reconfigure message to
   which the client is responding.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/19.4.4.%20Time%20Out%20and%20Retransmission%20of%20Renew%20or%20Information-request"></a><a class="selflink" href="#section-19.4.4" name="section-19.4.4">19.4.4</a>. Time Out and Retransmission of Renew or Information-request</span>
<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/Messages"></a>        Messages</span>

   The client uses the same variables and retransmission algorithm as it
   does with Renew or Information-request messages generated as part of
   a client-initiated configuration exchange.  See sections <a href="#section-18.1.3">18.1.3</a> and
   18.1.5 for details.  If the client does not receive a response from
   the server by the end of the retransmission process, the client
   ignores and discards the Reconfigure message.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/19.4.5.%20Receipt%20of%20Reply%20Messages"></a><a class="selflink" href="#section-19.4.5" name="section-19.4.5">19.4.5</a>. Receipt of Reply Messages</span>

   Upon the receipt of a valid Reply message, the client processes the
   options and sets (or resets) configuration parameters appropriately.
   The client records and updates the lifetimes for any addresses
   specified in IAs in the Reply message.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/20.%20Relay%20Agent%20Behavior"></a><a class="selflink" href="#section-20" name="section-20">20</a>. Relay Agent Behavior</span>

   The relay agent MAY be configured to use a list of destination
   addresses, which MAY include unicast addresses, the All_DHCP_Servers
   multicast address, or other addresses selected by the network
   administrator.  If the relay agent has not been explicitly
   configured, it MUST use the All_DHCP_Servers multicast address as the
   default.






<span class="grey">Droms, et al.               Standards Track                    [Page 58]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-59" id="page-59" name="page-59"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


   If the relay agent relays messages to the All_DHCP_Servers multicast
   address or other multicast addresses, it sets the Hop Limit field to
   32.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/20.1.%20Relaying%20a%20Client%20Message%20or%20a%20Relay-forward%20Message"></a><a class="selflink" href="#section-20.1" name="section-20.1">20.1</a>. Relaying a Client Message or a Relay-forward Message</span>

   A relay agent relays both messages from clients and Relay-forward
   messages from other relay agents.  When a relay agent receives a
   valid message to be relayed, it constructs a new Relay-forward
   message.  The relay agent copies the source address from the header
   of the IP datagram in which the message was received to the
   peer-address field of the Relay-forward message.  The relay agent
   copies the received DHCP message (excluding any IP or UDP headers)
   into a Relay Message option in the new message.  The relay agent adds
   to the Relay-forward message any other options it is configured to
   include.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/20.1.1.%20Relaying%20a%20Message%20from%20a%20Client"></a><a class="selflink" href="#section-20.1.1" name="section-20.1.1">20.1.1</a>. Relaying a Message from a Client</span>

   If the relay agent received the message to be relayed from a client,
   the relay agent places a global or site-scoped address with a prefix
   assigned to the link on which the client should be assigned an
   address in the link-address field.  This address will be used by the
   server to determine the link from which the client should be assigned
   an address and other configuration information.  The hop-count in the
   Relay-forward message is set to 0.

   If the relay agent cannot use the address in the link-address field
   to identify the interface through which the response to the client
   will be relayed, the relay agent MUST include an Interface-id option
   (see <a href="#section-22.18">section 22.18</a>) in the Relay-forward message.  The server will
   include the Interface-id option in its Relay-reply message.  The
   relay agent fills in the link-address field as described in the
   previous paragraph regardless of whether the relay agent includes an
   Interface-id option in the Relay-forward message.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/20.1.2.%20Relaying%20a%20Message%20from%20a%20Relay%20Agent"></a><a class="selflink" href="#section-20.1.2" name="section-20.1.2">20.1.2</a>. Relaying a Message from a Relay Agent</span>

   If the message received by the relay agent is a Relay-forward message
   and the hop-count in the message is greater than or equal to
   HOP_COUNT_LIMIT, the relay agent discards the received message.

   The relay agent copies the source address from the IP datagram in
   which the message was received from the client into the peer-address
   field in the Relay-forward message and sets the hop-count field to
   the value of the hop-count field in the received message incremented
   by 1.




<span class="grey">Droms, et al.               Standards Track                    [Page 59]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-60" id="page-60" name="page-60"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


   If the source address from the IP datagram header of the received
   message is a global or site-local address (and the device on which
   the relay agent is running belongs to only one site), the relay agent
   sets the link-address field to 0; otherwise the relay agent sets the
   link-address field to a global or site-local address assigned to the
   interface on which the message was received, or includes an
   Interface-ID option to identify the interface on which the message
   was received.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/20.2.%20Relaying%20a%20Relay-reply%20Message"></a><a class="selflink" href="#section-20.2" name="section-20.2">20.2</a>. Relaying a Relay-reply Message</span>

   The relay agent processes any options included in the Relay-reply
   message in addition to the Relay Message option, and then discards
   those options.

   The relay agent extracts the message from the Relay Message option
   and relays it to the address contained in the peer-address field of
   the Relay-reply message.

   If the Relay-reply message includes an Interface-id option, the relay
   agent relays the message from the server to the client on the link
   identified by the Interface-id option.  Otherwise, if the
   link-address field is not set to zero, the relay agent relays the
   message on the link identified by the link-address field.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/20.3.%20Construction%20of%20Relay-reply%20Messages"></a><a class="selflink" href="#section-20.3" name="section-20.3">20.3</a>. Construction of Relay-reply Messages</span>

   A server uses a Relay-reply message to return a response to a client
   if the original message from the client was relayed to the server in
   a Relay-forward message or to send a Reconfigure message to a client
   if the server does not have an address it can use to send the message
   directly to the client.

   A response to the client MUST be relayed through the same relay
   agents as the original client message.  The server causes this to
   happen by creating a Relay-reply message that includes a Relay
   Message option containing the message for the next relay agent in the
   return path to the client.  The contained Relay-reply message
   contains another Relay Message option to be sent to the next relay
   agent, and so on.  The server must record the contents of the
   peer-address fields in the received message so it can construct the
   appropriate Relay-reply message carrying the response from the
   server.








<span class="grey">Droms, et al.               Standards Track                    [Page 60]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-61" id="page-61" name="page-61"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


   For example, if client C sent a message that was relayed by relay
   agent A to relay agent B and then to the server, the server would
   send the following Relay-Reply message to relay agent B:

   msg-type:       RELAY-REPLY
   hop-count:      1
   link-address:   0
   peer-address:   A
   Relay Message option, containing:
     msg-type:     RELAY-REPLY
     hop-count:    0
     link-address: address from link to which C is attached
     peer-address: C
     Relay Message option: &lt;response from server&gt;

   When sending a Reconfigure message to a client through a relay agent,
   the server creates a Relay-reply message that includes a Relay
   Message option containing the Reconfigure message for the next relay
   agent in the return path to the client.  The server sets the
   peer-address field in the Relay-reply message header to the address
   of the client, and sets the link-address field as required by the
   relay agent to relay the Reconfigure message to the client.  The
   server obtains the addresses of the client and the relay agent
   through prior interaction with the client or through some external
   mechanism.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/21.%20Authentication%20of%20DHCP%20Messages"></a><a class="selflink" href="#section-21" name="section-21">21</a>. Authentication of DHCP Messages</span>

   Some network administrators may wish to provide authentication of the
   source and contents of DHCP messages.  For example, clients may be
   subject to denial of service attacks through the use of bogus DHCP
   servers, or may simply be misconfigured due to unintentionally
   instantiated DHCP servers.  Network administrators may wish to
   constrain the allocation of addresses to authorized hosts to avoid
   denial of service attacks in "hostile" environments where the network
   medium is not physically secured, such as wireless networks or
   college residence halls.

   The DHCP authentication mechanism is based on the design of
   authentication for DHCPv4 [<a href="#ref-4" title='"Authentication for DHCP Messages"'>4</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/21.1.%20Security%20of%20Messages%20Sent%20Between%20Servers%20and%20Relay%20Agents"></a><a class="selflink" href="#section-21.1" name="section-21.1">21.1</a>. Security of Messages Sent Between Servers and Relay Agents</span>

   Relay agents and servers that exchange messages securely use the
   IPsec mechanisms for IPv6 [<a href="#ref-7" title='"Security Architecture for the Internet Protocol"'>7</a>].  If a client message is relayed
   through multiple relay agents, each of the relay agents must have
   established independent, pairwise trust relationships.  That is, if
   messages from client C will be relayed by relay agent A to relay



<span class="grey">Droms, et al.               Standards Track                    [Page 61]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-62" id="page-62" name="page-62"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


   agent B and then to the server, relay agents A and B must be
   configured to use IPSec for the messages they exchange, and relay
   agent B and the server must be configured to use IPSec for the
   messages they exchange.

   Relay agents and servers that support secure relay agent to server or
   relay agent to relay agent communication use IPsec under the
   following conditions:

      Selectors        Relay agents are manually configured with the
                       addresses of the relay agent or server to which
                       DHCP messages are to be forwarded.  Each relay
                       agent and server that will be using IPsec for
                       securing DHCP messages must also be configured
                       with a list of the relay agents to which messages
                       will be returned.  The selectors for the relay
                       agents and servers will be the pairs of addresses
                       defining relay agents and servers that exchange
                       DHCP messages on the DHCPv6 UDP ports 546 and
                       547.

      Mode             Relay agents and servers use transport mode and
                       ESP. The information in DHCP messages is not
                       generally considered confidential, so encryption
                       need not be used (i.e., NULL encryption can be
                       used).

      Key management   Because the relay agents and servers are used
                       within an organization, public key schemes are
                       not necessary.  Because the relay agents and
                       servers must be manually configured, manually
                       configured key management may suffice, but does
                       not provide defense against replayed messages.
                       Accordingly, IKE with preshared secrets SHOULD be
                       supported.  IKE with public keys MAY be
                       supported.

      Security policy  DHCP messages between relay agents and servers
                       should only be accepted from DHCP peers as
                       identified in the local configuration.

      Authentication   Shared keys, indexed to the source IP address of
                       the received DHCP message, are adequate in this
                       application.

      Availability     Appropriate IPsec implementations are likely to
                       be available for servers and for relay agents in
                       more featureful devices used in enterprise and



<span class="grey">Droms, et al.               Standards Track                    [Page 62]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-63" id="page-63" name="page-63"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


                       core ISP networks.  IPsec is less likely to be
                       available for relay agents in low end devices
                       primarily used in the home or small office
                       markets.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/21.2.%20Summary%20of%20DHCP%20Authentication"></a><a class="selflink" href="#section-21.2" name="section-21.2">21.2</a>. Summary of DHCP Authentication</span>

   Authentication of DHCP messages is accomplished through the use of
   the Authentication option (see <a href="#section-22.11">section 22.11</a>).  The authentication
   information carried in the Authentication option can be used to
   reliably identify the source of a DHCP message and to confirm that
   the contents of the DHCP message have not been tampered with.

   The Authentication option provides a framework for multiple
   authentication protocols.  Two such protocols are defined here.
   Other protocols defined in the future will be specified in separate
   documents.

   Any DHCP message MUST NOT include more than one Authentication
   option.

   The protocol field in the Authentication option identifies the
   specific protocol used to generate the authentication information
   carried in the option.  The algorithm field identifies a specific
   algorithm within the authentication protocol; for example, the
   algorithm field specifies the hash algorithm used to generate the
   message authentication code (MAC) in the authentication option.  The
   replay detection method (RDM) field specifies the type of replay
   detection used in the replay detection field.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/21.3.%20Replay%20Detection"></a><a class="selflink" href="#section-21.3" name="section-21.3">21.3</a>. Replay Detection</span>

   The Replay Detection Method (RDM) field determines the type of replay
   detection used in the Replay Detection field.

   If the RDM field contains 0x00, the replay detection field MUST be
   set to the value of a monotonically increasing counter.  Using a
   counter value, such as the current time of day (for example, an NTP-
   format timestamp [<a href="#ref-9" title='"Network Time Protocol (Version 3) Specification, Implementation"'>9</a>]), can reduce the danger of replay attacks.  This
   method MUST be supported by all protocols.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/21.4.%20Delayed%20Authentication%20Protocol"></a><a class="selflink" href="#section-21.4" name="section-21.4">21.4</a>. Delayed Authentication Protocol</span>

   If the protocol field is 2, the message is using the "delayed
   authentication" mechanism.  In delayed authentication, the client
   requests authentication in its Solicit message, and the server
   replies with an Advertise message that includes authentication




<span class="grey">Droms, et al.               Standards Track                    [Page 63]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-64" id="page-64" name="page-64"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


   information.  This authentication information contains a nonce value
   generated by the source as a message authentication code (MAC) to
   provide message authentication and entity authentication.

   The use of a particular technique based on the HMAC protocol [<a href="#ref-8" title='"HMAC: Keyed-Hashing for Message Authentication"'>8</a>]
   using the MD5 hash [<a href="#ref-16" title='"The MD5 Message-Digest Algorithm"'>16</a>] is defined here.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/21.4.1.%20Use%20of%20the%20Authentication%20Option%20in%20the%20Delayed%20Authentication"></a><a class="selflink" href="#section-21.4.1" name="section-21.4.1">21.4.1</a>. Use of the Authentication Option in the Delayed Authentication</span>
<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/Protocol"></a>        Protocol</span>

   In a Solicit message, the client fills in the protocol, algorithm and
   RDM fields in the Authentication option with the client's
   preferences.  The client sets the replay detection field to zero and
   omits the authentication information field.  The client sets the
   option-len field to 11.

   In all other messages, the protocol and algorithm fields identify the
   method used to construct the contents of the authentication
   information field.  The RDM field identifies the method used to
   construct the contents of the replay detection field.

   The format of the Authentication information is:

     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                          DHCP realm                           |
    |                      (variable length)                        |
    .                                                               .
    .                                                               .
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                            key ID                             |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                                                               |
    |                           HMAC-MD5                            |
    |                          (128 bits)                           |
    |                                                               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

      DHCP realm  The DHCP realm that identifies the key used to
                  generate the HMAC-MD5 value.

      key ID      The key identifier that identified the key used to
                  generate the HMAC-MD5 value.

      HMAC-MD5    The message authentication code generated by applying
                  MD5 to the DHCP message using the key identified by
                  the DHCP realm, client DUID, and key ID.



<span class="grey">Droms, et al.               Standards Track                    [Page 64]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-65" id="page-65" name="page-65"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


   The sender computes the MAC using the HMAC generation algorithm [<a href="#ref-8" title='"HMAC: Keyed-Hashing for Message Authentication"'>8</a>]
   and the MD5 hash function [<a href="#ref-16" title='"The MD5 Message-Digest Algorithm"'>16</a>].  The entire DHCP message (setting the
   MAC field of the authentication option to zero), including the DHCP
   message header and the options field, is used as input to the HMAC-
   MD5 computation function.

   DISCUSSION:

      Algorithm 1 specifies the use of HMAC-MD5.  Use of a different
      technique, such as HMAC-SHA, will be specified as a separate
      protocol.

      The DHCP realm used to identify authentication keys is chosen to
      be unique among administrative domains.  Use of the DHCP realm
      allows DHCP administrators to avoid conflict in the use of key
      identifiers, and allows a host using DHCP to use authenticated
      DHCP while roaming among DHCP administrative domains.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/21.4.2.%20Message%20Validation"></a><a class="selflink" href="#section-21.4.2" name="section-21.4.2">21.4.2</a>. Message Validation</span>

   Any DHCP message that includes more than one authentication option
   MUST be discarded.

   To validate an incoming message, the receiver first checks that the
   value in the replay detection field is acceptable according to the
   replay detection method specified by the RDM field.  Next, the
   receiver computes the MAC as described in [<a href="#ref-8" title='"HMAC: Keyed-Hashing for Message Authentication"'>8</a>].  The entire DHCP
   message (setting the MAC field of the authentication option to 0) is
   used as input to the HMAC-MD5 computation function.  If the MAC
   computed by the receiver does not match the MAC contained in the
   authentication option, the receiver MUST discard the DHCP message.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/21.4.3.%20Key%20Utilization"></a><a class="selflink" href="#section-21.4.3" name="section-21.4.3">21.4.3</a>. Key Utilization</span>

   Each DHCP client has a set of keys.  Each key is identified by &lt;DHCP
   realm, client DUID, key id&gt;.  Each key also has a lifetime.  The key
   may not be used past the end of its lifetime.  The client's keys are
   initially distributed to the client through some out-of-band
   mechanism.  The lifetime for each key is distributed with the key.
   Mechanisms for key distribution and lifetime specification are beyond
   the scope of this document.

   The client and server use one of the client's keys to authenticate
   DHCP messages during a session (until the next Solicit message sent
   by the client).






<span class="grey">Droms, et al.               Standards Track                    [Page 65]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-66" id="page-66" name="page-66"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/21.4.4.%20Client%20Considerations%20for%20Delayed%20Authentication%20Protocol"></a><a class="selflink" href="#section-21.4.4" name="section-21.4.4">21.4.4</a>. Client Considerations for Delayed Authentication Protocol</span>

   The client announces its intention to use DHCP authentication by
   including an Authentication option in its Solicit message.  The
   server selects a key for the client based on the client's DUID.  The
   client and server use that key to authenticate all DHCP messages
   exchanged during the session.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/21.4.4.1.%20Sending%20Solicit%20Messages"></a><a class="selflink" href="#section-21.4.4.1" name="section-21.4.4.1">21.4.4.1</a>. Sending Solicit Messages</span>

   When the client sends a Solicit message and wishes to use
   authentication, it includes an Authentication option with the desired
   protocol, algorithm and RDM as described in <a href="#section-21.4">section 21.4</a>.  The client
   does not include any replay detection or authentication information
   in the Authentication option.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/21.4.4.2.%20Receiving%20Advertise%20Messages"></a><a class="selflink" href="#section-21.4.4.2" name="section-21.4.4.2">21.4.4.2</a>. Receiving Advertise Messages</span>

   The client validates any Advertise messages containing an
   Authentication option specifying the delayed authentication protocol
   using the validation test described in <a href="#section-21.4.2">section 21.4.2</a>.

   Client behavior, if no Advertise messages include authentication
   information or pass the validation test, is controlled by local
   policy on the client.  According to client policy, the client MAY
   choose to respond to an Advertise message that has not been
   authenticated.

   The decision to set local policy to accept unauthenticated messages
   should be made with care.  Accepting an unauthenticated Advertise
   message can make the client vulnerable to spoofing and other attacks.
   If local users are not explicitly informed that the client has
   accepted an unauthenticated Advertise message, the users may
   incorrectly assume that the client has received an authenticated
   address and is not subject to DHCP attacks through unauthenticated
   messages.

   A client MUST be configurable to discard unauthenticated messages,
   and SHOULD be configured by default to discard unauthenticated
   messages if the client has been configured with an authentication key
   or other authentication information.  A client MAY choose to
   differentiate between Advertise messages with no authentication
   information and Advertise messages that do not pass the validation
   test; for example, a client might accept the former and discard the
   latter.  If a client does accept an unauthenticated message, the
   client SHOULD inform any local users and SHOULD log the event.





<span class="grey">Droms, et al.               Standards Track                    [Page 66]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-67" id="page-67" name="page-67"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/21.4.4.3.%20Sending%20Request%2C%20Confirm%2C%20Renew%2C%20Rebind%2C%20Decline%20or%20Release"></a><a class="selflink" href="#section-21.4.4.3" name="section-21.4.4.3">21.4.4.3</a>. Sending Request, Confirm, Renew, Rebind, Decline or Release</span>
<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/Messages"></a>          Messages</span>

   If the client authenticated the Advertise message through which the
   client selected the server, the client MUST generate authentication
   information for subsequent Request, Confirm, Renew, Rebind or Release
   messages sent to the server, as described in <a href="#section-21.4">section 21.4</a>.  When the
   client sends a subsequent message, it MUST use the same key used by
   the server to generate the authentication information.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/21.4.4.4.%20Sending%20Information-request%20Messages"></a><a class="selflink" href="#section-21.4.4.4" name="section-21.4.4.4">21.4.4.4</a>. Sending Information-request Messages</span>

   If the server has selected a key for the client in a previous message
   exchange (see <a href="#section-21.4.5.1">section 21.4.5.1</a>), the client MUST use the same key to
   generate the authentication information throughout the session.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/21.4.4.5.%20Receiving%20Reply%20Messages"></a><a class="selflink" href="#section-21.4.4.5" name="section-21.4.4.5">21.4.4.5</a>. Receiving Reply Messages</span>

   If the client authenticated the Advertise it accepted, the client
   MUST validate the associated Reply message from the server.  The
   client MUST discard the Reply if the message fails to pass the
   validation test and MAY log the validation failure.  If the Reply
   fails to pass the validation test, the client MUST restart the DHCP
   configuration process by sending a Solicit message.

   If the client accepted an Advertise message that did not include
   authentication information or did not pass the validation test, the
   client MAY accept an unauthenticated Reply message from the server.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/21.4.4.6.%20Receiving%20Reconfigure%20Messages"></a><a class="selflink" href="#section-21.4.4.6" name="section-21.4.4.6">21.4.4.6</a>. Receiving Reconfigure Messages</span>

   The client MUST discard the Reconfigure if the message fails to pass
   the validation test and MAY log the validation failure.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/21.4.5.%20Server%20Considerations%20for%20Delayed%20Authentication%20Protocol"></a><a class="selflink" href="#section-21.4.5" name="section-21.4.5">21.4.5</a>. Server Considerations for Delayed Authentication Protocol</span>

   After receiving a Solicit message that contains an Authentication
   option, the server selects a key for the client, based on the
   client's DUID and key selection policies with which the server has
   been configured.  The server identifies the selected key in the
   Advertise message and uses the key to validate subsequent messages
   between the client and the server.









<span class="grey">Droms, et al.               Standards Track                    [Page 67]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-68" id="page-68" name="page-68"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/21.4.5.1.%20Receiving%20Solicit%20Messages%20and%20Sending%20Advertise%20Messages"></a><a class="selflink" href="#section-21.4.5.1" name="section-21.4.5.1">21.4.5.1</a>. Receiving Solicit Messages and Sending Advertise Messages</span>

   The server selects a key for the client and includes authentication
   information in the Advertise message returned to the client as
   specified in <a href="#section-21.4">section 21.4</a>.  The server MUST record the identifier of
   the key selected for the client and use that same key for validating
   subsequent messages with the client.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/21.4.5.2.%20Receiving%20Request%2C%20Confirm%2C%20Renew%2C%20Rebind%20or%20Release%20Messages"></a><a class="selflink" href="#section-21.4.5.2" name="section-21.4.5.2">21.4.5.2</a>. Receiving Request, Confirm, Renew, Rebind or Release Messages</span>
<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/and%20Sending%20Reply%20Messages"></a>          and Sending Reply Messages</span>

   The server uses the key identified in the message and validates the
   message as specified in <a href="#section-21.4.2">section 21.4.2</a>.  If the message fails to pass
   the validation test or the server does not know the key identified by
   the 'key ID' field, the server MUST discard the message and MAY
   choose to log the validation failure.

   If the message passes the validation test, the server responds to the
   specific message as described in <a href="#section-18.2">section 18.2</a>.  The server MUST
   include authentication information generated using the key identified
   in the received message, as specified in <a href="#section-21.4">section 21.4</a>.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/21.5.%20Reconfigure%20Key%20Authentication%20Protocol"></a><a class="selflink" href="#section-21.5" name="section-21.5">21.5</a>. Reconfigure Key Authentication Protocol</span>

   The Reconfigure key authentication protocol provides protection
   against misconfiguration of a client caused by a Reconfigure message
   sent by a malicious DHCP server.  In this protocol, a DHCP server
   sends a Reconfigure Key to the client in the initial exchange of DHCP
   messages.  The client records the Reconfigure Key for use in
   authenticating subsequent Reconfigure messages from that server.  The
   server then includes an HMAC computed from the Reconfigure Key in
   subsequent Reconfigure messages.

   Both the Reconfigure Key sent from the server to the client and the
   HMAC in subsequent Reconfigure messages are carried as the
   Authentication information in an Authentication option.  The format
   of the Authentication information is defined in the following
   section.

   The Reconfigure Key protocol is used (initiated by the server) only
   if the client and server are not using any other authentication
   protocol and the client and server have negotiated to use Reconfigure
   messages.








<span class="grey">Droms, et al.               Standards Track                    [Page 68]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-69" id="page-69" name="page-69"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/21.5.1.%20Use%20of%20the%20Authentication%20Option%20in%20the%20Reconfigure%20Key"></a><a class="selflink" href="#section-21.5.1" name="section-21.5.1">21.5.1</a>. Use of the Authentication Option in the Reconfigure Key</span>
<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/Authentication%20Protocol"></a>        Authentication Protocol</span>

   The following fields are set in an Authentication option for the
   Reconfigure Key Authentication Protocol:

      protocol    3

      algorithm   1

      RDM         0

   The format of the Authentication information for the Reconfigure Key
   Authentication Protocol is:

     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |     Type      |                 Value (128 bits)              |
    +-+-+-+-+-+-+-+-+                                               |
    .                                                               .
    .                                                               .
    .                                               +-+-+-+-+-+-+-+-+
    |                                               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

      Type    Type of data in Value field carried in this option:

                 1   Reconfigure Key value (used in Reply message).

                 2   HMAC-MD5 digest of the message (used in Reconfigure
                     message).

      Value   Data as defined by field.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/21.5.2.%20Server%20considerations%20for%20Reconfigure%20Key%20protocol"></a><a class="selflink" href="#section-21.5.2" name="section-21.5.2">21.5.2</a>. Server considerations for Reconfigure Key protocol</span>

   The server selects a Reconfigure Key for a client during the
   Request/Reply, Solicit/Reply or Information-request/Reply message
   exchange.  The server records the Reconfigure Key and transmits that
   key to the client in an Authentication option in the Reply message.

   The Reconfigure Key is 128 bits long, and MUST be a cryptographically
   strong random or pseudo-random number that cannot easily be
   predicted.






<span class="grey">Droms, et al.               Standards Track                    [Page 69]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-70" id="page-70" name="page-70"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


   To provide authentication for a Reconfigure message, the server
   selects a replay detection value according to the RDM selected by the
   server, and computes an HMAC-MD5 of the Reconfigure message using the
   Reconfigure Key for the client.  The server computes the HMAC-MD5
   over the entire DHCP Reconfigure message, including the
   Authentication option; the HMAC-MD5 field in the Authentication
   option is set to zero for the HMAC-MD5 computation.  The server
   includes the HMAC-MD5 in the authentication information field in an
   Authentication option included in the Reconfigure message sent to the
   client.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/21.5.3.%20Client%20considerations%20for%20Reconfigure%20Key%20protocol"></a><a class="selflink" href="#section-21.5.3" name="section-21.5.3">21.5.3</a>. Client considerations for Reconfigure Key protocol</span>

   The client will receive a Reconfigure Key from the server in the
   initial Reply message from the server.  The client records the
   Reconfigure Key for use in authenticating subsequent Reconfigure
   messages.

   To authenticate a Reconfigure message, the client computes an
   HMAC-MD5 over the DHCP Reconfigure message, using the Reconfigure Key
   received from the server.  If this computed HMAC-MD5 matches the
   value in the Authentication option, the client accepts the
   Reconfigure message.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/22.%20DHCP%20Options"></a><a class="selflink" href="#section-22" name="section-22">22</a>. DHCP Options</span>

   Options are used to carry additional information and parameters in
   DHCP messages.  Every option shares a common base format, as
   described in <a href="#section-22.1">section 22.1</a>.  All values in options are represented in
   network byte order.

   This document describes the DHCP options defined as part of the base
   DHCP specification.  Other options may be defined in the future in
   separate documents.

   Unless otherwise noted, each option may appear only in the options
   area of a DHCP message and may appear only once.  If an option does
   appear multiple times, each instance is considered separate and the
   data areas of the options MUST NOT be concatenated or otherwise
   combined.











<span class="grey">Droms, et al.               Standards Track                    [Page 70]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-71" id="page-71" name="page-71"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/22.1.%20Format%20of%20DHCP%20Options"></a><a class="selflink" href="#section-22.1" name="section-22.1">22.1</a>. Format of DHCP Options</span>

   The format of DHCP options is:

       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |          option-code          |           option-len          |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                          option-data                          |
      |                      (option-len octets)                      |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

      option-code   An unsigned integer identifying the specific option
                    type carried in this option.

      option-len    An unsigned integer giving the length of the
                    option-data field in this option in octets.

      option-data   The data for the option; the format of this data
                    depends on the definition of the option.

   DHCPv6 options are scoped by using encapsulation.  Some options apply
   generally to the client, some are specific to an IA, and some are
   specific to the addresses within an IA.  These latter two cases are
   discussed in sections <a href="#section-22.4">22.4</a> and <a href="#section-22.6">22.6</a>.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/22.2.%20Client%20Identifier%20Option"></a><a class="selflink" href="#section-22.2" name="section-22.2">22.2</a>. Client Identifier Option</span>

   The Client Identifier option is used to carry a DUID (see <a href="#section-9">section 9</a>)
   identifying a client between a client and a server.  The format of
   the Client Identifier option is:

       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |        OPTION_CLIENTID        |          option-len           |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      .                                                               .
      .                              DUID                             .
      .                        (variable length)                      .
      .                                                               .
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

      option-code   OPTION_CLIENTID (1).

      option-len    Length of DUID in octets.




<span class="grey">Droms, et al.               Standards Track                    [Page 71]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-72" id="page-72" name="page-72"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


      DUID          The DUID for the client.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/22.3.%20Server%20Identifier%20Option"></a><a class="selflink" href="#section-22.3" name="section-22.3">22.3</a>. Server Identifier Option</span>

   The Server Identifier option is used to carry a DUID (see <a href="#section-9">section 9</a>)
   identifying a server between a client and a server.  The format of
   the Server Identifier option is:

       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |        OPTION_SERVERID        |          option-len           |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      .                                                               .
      .                              DUID                             .
      .                        (variable length)                      .
      .                                                               .
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

      option-code   OPTION_SERVERID (2).

      option-len    Length of DUID in octets.

      DUID          The DUID for the server.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/22.4.%20Identity%20Association%20for%20Non-temporary%20Addresses%20Option"></a><a class="selflink" href="#section-22.4" name="section-22.4">22.4</a>. Identity Association for Non-temporary Addresses Option</span>

   The Identity Association for Non-temporary Addresses option (IA_NA
   option) is used to carry an IA_NA, the parameters associated with the
   IA_NA, and the non-temporary addresses associated with the IA_NA.

   Addresses appearing in an IA_NA option are not temporary addresses
   (see <a href="#section-22.5">section 22.5</a>).


















<span class="grey">Droms, et al.               Standards Track                    [Page 72]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-73" id="page-73" name="page-73"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


   The format of the IA_NA option is:

       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |          OPTION_IA_NA         |          option-len           |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                        IAID (4 octets)                        |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                              T1                               |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                              T2                               |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                                                               |
      .                         IA_NA-options                         .
      .                                                               .
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

      option-code          OPTION_IA_NA (3).

      option-len           12 + length of IA_NA-options field.

      IAID                 The unique identifier for this IA_NA; the
                           IAID must be unique among the identifiers for
                           all of this client's IA_NAs.  The number
                           space for IA_NA IAIDs is separate from the
                           number space for IA_TA IAIDs.

      T1                   The time at which the client contacts the
                           server from which the addresses in the IA_NA
                           were obtained to extend the lifetimes of the
                           addresses assigned to the IA_NA; T1 is a
                           time duration relative to the current time
                           expressed in units of seconds.

      T2                   The time at which the client contacts any
                           available server to extend the lifetimes of
                           the addresses assigned to the IA_NA; T2 is a
                           time duration relative to the current time
                           expressed in units of seconds.

      IA_NA-options        Options associated with this IA_NA.

   The IA_NA-options field encapsulates those options that are specific
   to this IA_NA.  For example, all of the IA Address Options carrying
   the addresses associated with this IA_NA are in the IA_NA-options
   field.




<span class="grey">Droms, et al.               Standards Track                    [Page 73]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-74" id="page-74" name="page-74"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


   An IA_NA option may only appear in the options area of a DHCP
   message.  A DHCP message may contain multiple IA_NA options.

   The status of any operations involving this IA_NA is indicated in a
   Status Code option in the IA_NA-options field.

   Note that an IA_NA has no explicit "lifetime" or "lease length" of
   its own.  When the valid lifetimes of all of the addresses in an
   IA_NA have expired, the IA_NA can be considered as having expired.
   T1 and T2 are included to give servers explicit control over when a
   client recontacts the server about a specific IA_NA.

   In a message sent by a client to a server, values in the T1 and T2
   fields indicate the client's preference for those parameters.  The
   client sets T1 and T2 to 0 if it has no preference for those values.
   In a message sent by a server to a client, the client MUST use the
   values in the T1 and T2 fields for the T1 and T2 parameters, unless
   those values in those fields are 0.  The values in the T1 and T2
   fields are the number of seconds until T1 and T2.

   The server selects the T1 and T2 times to allow the client to extend
   the lifetimes of any addresses in the IA_NA before the lifetimes
   expire, even if the server is unavailable for some short period of
   time.  Recommended values for T1 and T2 are .5 and .8 times the
   shortest preferred lifetime of the addresses in the IA that the
   server is willing to extend, respectively.  If the "shortest"
   preferred lifetime is 0xffffffff ("infinity"), the recommended T1 and
   T2 values are also 0xffffffff.  If the time at which the addresses in
   an IA_NA are to be renewed is to be left to the discretion of the
   client, the server sets T1 and T2 to 0.

   If a server receives an IA_NA with T1 greater than T2, and both T1
   and T2 are greater than 0, the server ignores the invalid values of
   T1 and T2 and processes the IA_NA as though the client had set T1 and
   T2 to 0.

   If a client receives an IA_NA with T1 greater than T2, and both T1
   and T2 are greater than 0, the client discards the IA_NA option and
   processes the remainder of the message as though the server had not
   included the invalid IA_NA option.

   Care should be taken in setting T1 or T2 to 0xffffffff ("infinity").
   A client will never attempt to extend the lifetimes of any addresses
   in an IA with T1 set to 0xffffffff.  A client will never attempt to
   use a Rebind message to locate a different server to extend the
   lifetimes of any addresses in an IA with T2 set to 0xffffffff.





<span class="grey">Droms, et al.               Standards Track                    [Page 74]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-75" id="page-75" name="page-75"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/22.5.%20Identity%20Association%20for%20Temporary%20Addresses%20Option"></a><a class="selflink" href="#section-22.5" name="section-22.5">22.5</a>. Identity Association for Temporary Addresses Option</span>

   The Identity Association for the Temporary Addresses (IA_TA) option
   is used to carry an IA_TA, the parameters associated with the IA_TA
   and the addresses associated with the IA_TA.  All of the addresses in
   this option are used by the client as temporary addresses, as defined
   in <a href="rfc3041.html">RFC 3041</a> [<a href="#ref-12" title='"Privacy Extensions for Stateless Address Autoconfiguration in IPv6"'>12</a>].  The format of the IA_TA option is:

       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |         OPTION_IA_TA          |          option-len           |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                        IAID (4 octets)                        |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                                                               |
      .                         IA_TA-options                         .
      .                                                               .
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

      option-code          OPTION_IA_TA (4).

      option-len           4 + length of IA_TA-options field.

      IAID                 The unique identifier for this IA_TA; the
                           IAID must be unique among the identifiers
                           for all of this client's IA_TAs.  The number
                           space for IA_TA IAIDs is separate from the
                           number space for IA_NA IAIDs.

      IA_TA-options        Options associated with this IA_TA.

   The IA_TA-Options field encapsulates those options that are specific
   to this IA_TA.  For example, all of the IA Address Options carrying
   the addresses associated with this IA_TA are in the IA_TA-options
   field.

   Each IA_TA carries one "set" of temporary addresses; that is, at most
   one address from each prefix assigned to the link to which the client
   is attached.

   An IA_TA option may only appear in the options area of a DHCP
   message.  A DHCP message may contain multiple IA_TA options.

   The status of any operations involving this IA_TA is indicated in a
   Status Code option in the IA_TA-options field.





<span class="grey">Droms, et al.               Standards Track                    [Page 75]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-76" id="page-76" name="page-76"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


   Note that an IA has no explicit "lifetime" or "lease length" of its
   own.  When the valid lifetimes of all of the addresses in an IA_TA
   have expired, the IA can be considered as having expired.

   An IA_TA option does not include values for T1 and T2.  A client MAY
   request that the lifetimes on temporary addresses be extended by
   including the addresses in a IA_TA option sent in a Renew or Rebind
   message to a server.  For example, a client would request an
   extension on the lifetime of a temporary address to allow an
   application to continue to use an established TCP connection.

   The client obtains new temporary addresses by sending an IA_TA option
   with a new IAID to a server.  Requesting new temporary addresses from
   the server is the equivalent of generating new temporary addresses as
   described in <a href="rfc3041.html">RFC 3041</a>.  The server will generate new temporary
   addresses and return them to the client.  The client should request
   new temporary addresses before the lifetimes on the previously
   assigned addresses expire.

   A server MUST return the same set of temporary address for the same
   IA_TA (as identified by the IAID) as long as those addresses are
   still valid.  After the lifetimes of the addresses in an IA_TA have
   expired, the IAID may be reused to identify a new IA_TA with new
   temporary addresses.

   This option MAY appear in a Confirm message if the lifetimes on the
   temporary addresses in the associated IA have not expired.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/22.6.%20IA%20Address%20Option"></a><a class="selflink" href="#section-22.6" name="section-22.6">22.6</a>. IA Address Option</span>

   The IA Address option is used to specify IPv6 addresses associated
   with an IA_NA or an IA_TA.  The IA Address option must be
   encapsulated in the Options field of an IA_NA or IA_TA option.  The
   Options field encapsulates those options that are specific to this
   address.
















<span class="grey">Droms, et al.               Standards Track                    [Page 76]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-77" id="page-77" name="page-77"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


   The format of the IA Address option is:

       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |          OPTION_IAADDR        |          option-len           |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                                                               |
      |                         IPv6 address                          |
      |                                                               |
      |                                                               |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                      preferred-lifetime                       |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                        valid-lifetime                         |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      .                                                               .
      .                        IAaddr-options                         .
      .                                                               .
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

      option-code   OPTION_IAADDR (5).

      option-len    24 + length of IAaddr-options field.

      IPv6 address  An IPv6 address.

      preferred-lifetime The preferred lifetime for the IPv6 address in
                    the option, expressed in units of seconds.

      valid-lifetime The valid lifetime for the IPv6 address in the
                    option, expressed in units of seconds.

      IAaddr-options Options associated with this address.

   In a message sent by a client to a server, values in the preferred
   and valid lifetime fields indicate the client's preference for those
   parameters.  The client may send 0 if it has no preference for the
   preferred and valid lifetimes.  In a message sent by a server to a
   client, the client MUST use the values in the preferred and valid
   lifetime fields for the preferred and valid lifetimes.  The values in
   the preferred and valid lifetimes are the number of seconds remaining
   in each lifetime.








<span class="grey">Droms, et al.               Standards Track                    [Page 77]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-78" id="page-78" name="page-78"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


   A client discards any addresses for which the preferred lifetime is
   greater than the valid lifetime.  A server ignores the lifetimes set
   by the client if the preferred lifetime is greater than the valid
   lifetime and ignores the values for T1 and T2 set by the client if
   those values are greater than the preferred lifetime.

   Care should be taken in setting the valid lifetime of an address to
   0xffffffff ("infinity"), which amounts to a permanent assignment of
   an address to a client.

   An IA Address option may appear only in an IA_NA option or an IA_TA
   option.  More than one IA Address Option can appear in an IA_NA
   option or an IA_TA option.

   The status of any operations involving this IA Address is indicated
   in a Status Code option in the IAaddr-options field.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/22.7.%20Option%20Request%20Option"></a><a class="selflink" href="#section-22.7" name="section-22.7">22.7</a>. Option Request Option</span>

   The Option Request option is used to identify a list of options in a
   message between a client and a server.  The format of the Option
   Request option is:

       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |           OPTION_ORO          |           option-len          |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |    requested-option-code-1    |    requested-option-code-2    |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                              ...                              |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

      option-code   OPTION_ORO (6).

      option-len    2 * number of requested options.

      requested-option-code-n The option code for an option requested by
                    the client.

   A client MAY include an Option Request option in a Solicit, Request,
   Renew, Rebind, Confirm or Information-request message to inform the
   server about options the client wants the server to send to the
   client.  A server MAY include an Option Request option in a
   Reconfigure option to indicate which options the client should
   request from the server.





<span class="grey">Droms, et al.               Standards Track                    [Page 78]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-79" id="page-79" name="page-79"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/22.8.%20Preference%20Option"></a><a class="selflink" href="#section-22.8" name="section-22.8">22.8</a>. Preference Option</span>

   The Preference option is sent by a server to a client to affect the
   selection of a server by the client.

   The format of the Preference option is:

       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |       OPTION_PREFERENCE       |          option-len           |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |  pref-value   |
      +-+-+-+-+-+-+-+-+

      option-code   OPTION_PREFERENCE (7).

      option-len    1.

      pref-value    The preference value for the server in this message.

   A server MAY include a Preference option in an Advertise message to
   control the selection of a server by the client.  See <a href="#section-17.1.3">section 17.1.3</a>
   for the use of the Preference option by the client and the
   interpretation of Preference option data value.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/22.9.%20Elapsed%20Time%20Option"></a><a class="selflink" href="#section-22.9" name="section-22.9">22.9</a>. Elapsed Time Option</span>

       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |      OPTION_ELAPSED_TIME      |           option-len          |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |          elapsed-time         |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

      option-code   OPTION_ELAPSED_TIME (8).

      option-len    2.

      elapsed-time  The amount of time since the client began its
                    current DHCP transaction.  This time is expressed in
                    hundredths of a second (10^-2 seconds).

   A client MUST include an Elapsed Time option in messages to indicate
   how long the client has been trying to complete a DHCP message
   exchange.  The elapsed time is measured from the time at which the
   client sent the first message in the message exchange, and the



<span class="grey">Droms, et al.               Standards Track                    [Page 79]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-80" id="page-80" name="page-80"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


   elapsed-time field is set to 0 in the first message in the message
   exchange.  Servers and Relay Agents use the data value in this option
   as input to policy controlling how a server responds to a client
   message.  For example, the elapsed time option allows a secondary
   DHCP server to respond to a request when a primary server has not
   answered in a reasonable time.  The elapsed time value is an
   unsigned, 16 bit integer.  The client uses the value 0xffff to
   represent any elapsed time values greater than the largest time value
   that can be represented in the Elapsed Time option.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/22.10.%20Relay%20Message%20Option"></a><a class="selflink" href="#section-22.10" name="section-22.10">22.10</a>. Relay Message Option</span>

   The Relay Message option carries a DHCP message in a Relay-forward or
   Relay-reply message.

   The format of the Relay Message option is:

       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |        OPTION_RELAY_MSG       |           option-len          |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                                                               |
      .                       DHCP-relay-message                      .
      .                                                               .
      .                                                               .
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

      option-code   OPTION_RELAY_MSG (9)

      option-len    Length of DHCP-relay-message

      DHCP-relay-message In a Relay-forward message, the received
                    message, relayed verbatim to the next relay agent
                    or server; in a Relay-reply message, the message to
                    be copied and relayed to the relay agent or client
                    whose address is in the peer-address field of the
                    Relay-reply message













<span class="grey">Droms, et al.               Standards Track                    [Page 80]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-81" id="page-81" name="page-81"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/22.11.%20Authentication%20Option"></a><a class="selflink" href="#section-22.11" name="section-22.11">22.11</a>. Authentication Option</span>

   The Authentication option carries authentication information to
   authenticate the identity and contents of DHCP messages.  The use of
   the Authentication option is described in <a href="#section-21">section 21</a>.  The format of
   the Authentication option is:

     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |          OPTION_AUTH          |          option-len           |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |   protocol    |   algorithm   |      RDM      |               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+               |
    |                                                               |
    |          replay detection (64 bits)           +-+-+-+-+-+-+-+-+
    |                                               |   auth-info   |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+               |
    .                   authentication information                  .
    .                       (variable length)                       .
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

      option-code                  OPTION_AUTH (11)

      option-len                   11 + length of authentication
                                   information field

      protocol                     The authentication protocol used in
                                   this authentication option

      algorithm                    The algorithm used in the
                                   authentication protocol

      RDM                          The replay detection method used in
                                   this authentication option

      Replay detection             The replay detection information for
                                   the RDM

      authentication information   The authentication information,
                                   as specified by the protocol and
                                   algorithm used in this authentication
                                   option








<span class="grey">Droms, et al.               Standards Track                    [Page 81]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-82" id="page-82" name="page-82"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/22.12.%20Server%20Unicast%20Option"></a><a class="selflink" href="#section-22.12" name="section-22.12">22.12</a>. Server Unicast Option</span>

   The server sends this option to a client to indicate to the client
   that it is allowed to unicast messages to the server.  The format of
   the Server Unicast option is:

     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |          OPTION_UNICAST       |        option-len             |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                                                               |
    |                       server-address                          |
    |                                                               |
    |                                                               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

      option-code     OPTION_UNICAST (12).

      option-len      16.

      server-address  The IP address to which the client should send
                      messages delivered using unicast.

   The server specifies the IPv6 address to which the client is to send
   unicast messages in the server-address field.  When a client receives
   this option, where permissible and appropriate, the client sends
   messages directly to the server using the IPv6 address specified in
   the server-address field of the option.

   When the server sends a Unicast option to the client, some messages
   from the client will not be relayed by Relay Agents, and will not
   include Relay Agent options from the Relay Agents.  Therefore, a
   server should only send a Unicast option to a client when Relay
   Agents are not sending Relay Agent options.  A DHCP server rejects
   any messages sent inappropriately using unicast to ensure that
   messages are relayed by Relay Agents when Relay Agent options are in
   use.

   Details about when the client may send messages to the server using
   unicast are in <a href="#section-18">section 18</a>.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/22.13.%20Status%20Code%20Option"></a><a class="selflink" href="#section-22.13" name="section-22.13">22.13</a>. Status Code Option</span>

   This option returns a status indication related to the DHCP message
   or option in which it appears.  The format of the Status Code option
   is:




<span class="grey">Droms, et al.               Standards Track                    [Page 82]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-83" id="page-83" name="page-83"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |       OPTION_STATUS_CODE      |         option-len            |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |          status-code          |                               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |
    .                                                               .
    .                        status-message                         .
    .                                                               .
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

      option-code          OPTION_STATUS_CODE (13).

      option-len           2 + length of status-message.

      status-code          The numeric code for the status encoded in
                           this option.  The status codes are defined in
                           <a href="#section-24.4">section 24.4</a>.

      status-message       A UTF-8 encoded text string suitable for
                           display to an end user, which MUST NOT be
                           null-terminated.

   A Status Code option may appear in the options field of a DHCP
   message and/or in the options field of another option.  If the Status
   Code option does not appear in a message in which the option could
   appear, the status of the message is assumed to be Success.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/22.14.%20Rapid%20Commit%20Option"></a><a class="selflink" href="#section-22.14" name="section-22.14">22.14</a>. Rapid Commit Option</span>

   The Rapid Commit option is used to signal the use of the two message
   exchange for address assignment.  The format of the Rapid Commit
   option is:

     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |      OPTION_RAPID_COMMIT      |               0               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

      option-code     OPTION_RAPID_COMMIT (14).

      option-len      0.

   A client MAY include this option in a Solicit message if the client
   is prepared to perform the Solicit-Reply message exchange described
   in <a href="#section-17.1.1">section 17.1.1</a>.



<span class="grey">Droms, et al.               Standards Track                    [Page 83]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-84" id="page-84" name="page-84"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


   A server MUST include this option in a Reply message sent in response
   to a Solicit message when completing the Solicit-Reply message
   exchange.

   DISCUSSION:

      Each server that responds with a Reply to a Solicit that includes
      a Rapid Commit option will commit the assigned addresses in the
      Reply message to the client, and will not receive any confirmation
      that the client has received the Reply message.  Therefore, if
      more than one server responds to a Solicit that includes a Rapid
      Commit option, some servers will commit addresses that are not
      actually used by the client.

      The problem of unused addresses can be minimized, for example, by
      designing the DHCP service so that only one server responds to the
      Solicit or by using relatively short lifetimes for assigned
      addresses.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/22.15.%20User%20Class%20Option"></a><a class="selflink" href="#section-22.15" name="section-22.15">22.15</a>. User Class Option</span>

   The User Class option is used by a client to identify the type or
   category of user or applications it represents.

   The format of the User Class option is:

       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |       OPTION_USER_CLASS       |          option-len           |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      .                                                               .
      .                          user-class-data                      .
      .                                                               .
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

      option-code          OPTION_USER_CLASS (15).

      option-len           Length of user class data field.

      user-class-data      The user classes carried by the client.

   The information contained in the data area of this option is
   contained in one or more opaque fields that represent the user class
   or classes of which the client is a member.  A server selects
   configuration information for the client based on the classes
   identified in this option.  For example, the User Class option can be
   used to configure all clients of people in the accounting department




<span class="grey">Droms, et al.               Standards Track                    [Page 84]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-85" id="page-85" name="page-85"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


   with a different printer than clients of people in the marketing
   department.  The user class information carried in this option MUST
   be configurable on the client.

   The data area of the user class option MUST contain one or more
   instances of user class data.  Each instance of the user class data
   is formatted as follows:

      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-...-+-+-+-+-+-+-+
      |        user-class-len         |          opaque-data          |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-...-+-+-+-+-+-+-+

   The user-class-len is two octets long and specifies the length of the
   opaque user class data in network byte order.

   A server interprets the classes identified in this option according
   to its configuration to select the appropriate configuration
   information for the client.  A server may use only those user classes
   that it is configured to interpret in selecting configuration
   information for a client and ignore any other user classes.  In
   response to a message containing a User Class option, a server
   includes a User Class option containing those classes that were
   successfully interpreted by the server, so that the client can be
   informed of the classes interpreted by the server.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/22.16.%20Vendor%20Class%20Option"></a><a class="selflink" href="#section-22.16" name="section-22.16">22.16</a>. Vendor Class Option</span>

   This option is used by a client to identify the vendor that
   manufactured the hardware on which the client is running.  The
   information contained in the data area of this option is contained in
   one or more opaque fields that identify details of the hardware
   configuration.  The format of the Vendor Class option is:

       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |      OPTION_VENDOR_CLASS      |           option-len          |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                       enterprise-number                       |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      .                                                               .
      .                       vendor-class-data                       .
      .                             . . .                             .
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

      option-code          OPTION_VENDOR_CLASS (16).

      option-len           4 + length of vendor class data field.




<span class="grey">Droms, et al.               Standards Track                    [Page 85]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-86" id="page-86" name="page-86"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


      enterprise-number    The vendor's registered Enterprise Number as
                           registered with IANA [<a href="#ref-6">6</a>].

      vendor-class-data    The hardware configuration of the host on
                           which the client is running.

   The vendor-class-data is composed of a series of separate items, each
   of which describes some characteristic of the client's hardware
   configuration.  Examples of vendor-class-data instances might include
   the version of the operating system the client is running or the
   amount of memory installed on the client.

   Each instance of the vendor-class-data is formatted as follows:

      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-...-+-+-+-+-+-+-+
      |       vendor-class-len        |          opaque-data          |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-...-+-+-+-+-+-+-+

   The vendor-class-len is two octets long and specifies the length of
   the opaque vendor class data in network byte order.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/22.17.%20Vendor-specific%20Information%20Option"></a><a class="selflink" href="#section-22.17" name="section-22.17">22.17</a>. Vendor-specific Information Option</span>

   This option is used by clients and servers to exchange
   vendor-specific information.

   The format of the Vendor-specific Information option is:

       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |      OPTION_VENDOR_OPTS       |           option-len          |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                       enterprise-number                       |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      .                                                               .
      .                          option-data                          .
      .                                                               .
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

      option-code          OPTION_VENDOR_OPTS (17)

      option-len           4 + length of option-data field

      enterprise-number    The vendor's registered Enterprise Number as
                           registered with IANA [<a href="#ref-6">6</a>].






<span class="grey">Droms, et al.               Standards Track                    [Page 86]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-87" id="page-87" name="page-87"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


      option-data          An opaque object of option-len octets,
                           interpreted by vendor-specific code on the
                           clients and servers

   The definition of the information carried in this option is vendor
   specific.  The vendor is indicated in the enterprise-number field.
   Use of vendor-specific information allows enhanced operation,
   utilizing additional features in a vendor's DHCP implementation.  A
   DHCP client that does not receive requested vendor-specific
   information will still configure the host device's IPv6 stack to be
   functional.

   The encapsulated vendor-specific options field MUST be encoded as a
   sequence of code/length/value fields of identical format to the DHCP
   options field.  The option codes are defined by the vendor identified
   in the enterprise-number field and are not managed by IANA.  Each of
   the encapsulated options is formatted as follows:

       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |          opt-code             |             option-len        |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      .                                                               .
      .                          option-data                          .
      .                                                               .
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

      opt-code             The code for the encapsulated option.

      option-len           An unsigned integer giving the length of the
                           option-data field in this encapsulated option
                           in octets.

      option-data          The data area for the encapsulated option.

   Multiple instances of the Vendor-specific Information option may
   appear in a DHCP message.  Each instance of the option is interpreted
   according to the option codes defined by the vendor identified by the
   Enterprise Number in that option.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/22.18.%20Interface-Id%20Option"></a><a class="selflink" href="#section-22.18" name="section-22.18">22.18</a>. Interface-Id Option</span>

   The relay agent MAY send the Interface-id option to identify the
   interface on which the client message was received.  If a relay agent
   receives a Relay-reply message with an Interface-id option, the relay
   agent relays the message to the client through the interface
   identified by the option.




<span class="grey">Droms, et al.               Standards Track                    [Page 87]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-88" id="page-88" name="page-88"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


   The format of the Interface ID option is:

     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |      OPTION_INTERFACE_ID      |         option-len            |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    .                                                               .
    .                         interface-id                          .
    .                                                               .
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

      option-code          OPTION_INTERFACE_ID (18).

      option-len           Length of interface-id field.

      interface-id         An opaque value of arbitrary length generated
                           by the relay agent to identify one of the
                           relay agent's interfaces.

   The server MUST copy the Interface-Id option from the Relay-Forward
   message into the Relay-Reply message the server sends to the relay
   agent in response to the Relay-Forward message.  This option MUST NOT
   appear in any message except a Relay-Forward or Relay-Reply message.

   Servers MAY use the Interface-ID for parameter assignment policies.
   The Interface-ID SHOULD be considered an opaque value, with policies
   based on exact match only; that is, the Interface-ID SHOULD NOT be
   internally parsed by the server.  The Interface-ID value for an
   interface SHOULD be stable and remain unchanged, for example, after
   the relay agent is restarted; if the Interface-ID changes, a server
   will not be able to use it reliably in parameter assignment policies.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/22.19.%20Reconfigure%20Message%20Option"></a><a class="selflink" href="#section-22.19" name="section-22.19">22.19</a>. Reconfigure Message Option</span>

   A server includes a Reconfigure Message option in a Reconfigure
   message to indicate to the client whether the client responds with a
   Renew message or an Information-request message.  The format of this
   option is:

     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |      OPTION_RECONF_MSG        |         option-len            |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |    msg-type   |
    +-+-+-+-+-+-+-+-+




<span class="grey">Droms, et al.               Standards Track                    [Page 88]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-89" id="page-89" name="page-89"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


      option-code          OPTION_RECONF_MSG (19).

      option-len           1.

      msg-type             5 for Renew message, 11 for
                           Information-request message.

   The Reconfigure Message option can only appear in a Reconfigure
   message.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/22.20.%20Reconfigure%20Accept%20Option"></a><a class="selflink" href="#section-22.20" name="section-22.20">22.20</a>. Reconfigure Accept Option</span>

   A client uses the Reconfigure Accept option to announce to the server
   whether the client is willing to accept Reconfigure messages, and a
   server uses this option to tell the client whether or not to accept
   Reconfigure messages.  The default behavior, in the absence of this
   option, means unwillingness to accept Reconfigure messages, or
   instruction not to accept Reconfigure messages, for the client and
   server messages, respectively.  The following figure gives the format
   of the Reconfigure Accept option:

     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |     OPTION_RECONF_ACCEPT      |               0               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

      option-code   OPTION_RECONF_ACCEPT (20).

      option-len    0.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/23.%20Security%20Considerations"></a><a class="selflink" href="#section-23" name="section-23">23</a>. Security Considerations</span>

   The threat to DHCP is inherently an insider threat (assuming a
   properly configured network where DHCPv6 ports are blocked on the
   perimeter gateways of the enterprise).  Regardless of the gateway
   configuration, however, the potential attacks by insiders and
   outsiders are the same.

   Use of manually configured preshared keys for IPsec between relay
   agents and servers does not defend against replayed DHCP messages.
   Replayed messages can represent a DOS attack through exhaustion of
   processing resources, but not through mis-configuration or exhaustion
   of other resources such as assignable addresses.

   One attack specific to a DHCP client is the establishment of a
   malicious server with the intent of providing incorrect configuration
   information to the client.  The motivation for doing so may be to



<span class="grey">Droms, et al.               Standards Track                    [Page 89]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-90" id="page-90" name="page-90"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


   mount a "man in the middle" attack that causes the client to
   communicate with a malicious server instead of a valid server for
   some service such as DNS or NTP.  The malicious server may also mount
   a denial of service attack through misconfiguration of the client
   that causes all network communication from the client to fail.

   There is another threat to DHCP clients from mistakenly or
   accidentally configured DHCP servers that answer DHCP client requests
   with unintentionally incorrect configuration parameters.

   A DHCP client may also be subject to attack through the receipt of a
   Reconfigure message from a malicious server that causes the client to
   obtain incorrect configuration information from that server.  Note
   that although a client sends its response (Renew or
   Information-request message) through a relay agent and, therefore,
   that response will only be received by servers to which DHCP messages
   are relayed, a malicious server could send a Reconfigure message to a
   client, followed (after an appropriate delay) by a Reply message that
   would be accepted by the client.  Thus, a malicious server that is
   not on the network path between the client and the server may still
   be able to mount a Reconfigure attack on a client.  The use of
   transaction IDs that are cryptographically sound and cannot easily be
   predicted will also reduce the probability that such an attack will
   be successful.

   The threat specific to a DHCP server is an invalid client
   masquerading as a valid client.  The motivation for this may be for
   theft of service, or to circumvent auditing for any number of
   nefarious purposes.

   The threat common to both the client and the server is the resource
   "denial of service" (DoS) attack.  These attacks typically involve
   the exhaustion of available addresses, or the exhaustion of CPU or
   network bandwidth, and are present anytime there is a shared
   resource.

   In the case where relay agents add additional options to Relay
   Forward messages, the messages exchanged between relay agents and
   servers may be used to mount a "man in the middle" or denial of
   service attack.

   This threat model does not consider the privacy of the contents of
   DHCP messages to be important.  DHCP is not used to exchange
   authentication or configuration information that must be kept secret
   from other networks nodes.






<span class="grey">Droms, et al.               Standards Track                    [Page 90]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-91" id="page-91" name="page-91"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


   DHCP authentication provides for authentication of the identity of
   DHCP clients and servers, and for the integrity of messages delivered
   between DHCP clients and servers.  DHCP authentication does not
   provide any privacy for the contents of DHCP messages.

   The Delayed Authentication protocol described in <a href="#section-21.4">section 21.4</a> uses a
   secret key that is shared between a client and a server.  The use of
   a "DHCP realm" in the shared key allows identification of
   administrative domains so that a client can select the appropriate
   key or keys when roaming between administrative domains.  However,
   the Delayed Authentication protocol does not define any mechanism for
   sharing of keys, so a client may require separate keys for each
   administrative domain it encounters.  The use of shared keys may not
   scale well and does not provide for repudiation of compromised keys.
   This protocol is focused on solving the intradomain problem where the
   out-of-band exchange of a shared key is feasible.

   Because of the opportunity for attack through the Reconfigure
   message, a DHCP client MUST discard any Reconfigure message that does
   not include authentication or that does not pass the validation
   process for the authentication protocol.

   The Reconfigure Key protocol described in <a href="#section-21.5">section 21.5</a> provides
   protection against the use of a Reconfigure message by a malicious
   DHCP server to mount a denial of service or man-in-the-middle attack
   on a client.  This protocol can be compromised by an attacker that
   can intercept the initial message in which the DHCP server sends the
   key to the client.

   Communication between a server and a relay agent, and communication
   between relay agents, can be secured through the use of IPSec, as
   described in <a href="#section-21.1">section 21.1</a>.  The use of manual configuration and
   installation of static keys are acceptable in this instance because
   relay agents and the server will belong to the same administrative
   domain and the relay agents will require other specific configuration
   (for example, configuration of the DHCP server address) as well as
   the IPSec configuration.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/24.%20IANA%20Considerations"></a><a class="selflink" href="#section-24" name="section-24">24</a>. IANA Considerations</span>

   This document defines several new name spaces associated with DHCPv6
   and DHCPv6 options:

      -  Message types

      -  Status codes

      -  DUID



<span class="grey">Droms, et al.               Standards Track                    [Page 91]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-92" id="page-92" name="page-92"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


      -  Option codes

   IANA has established a registry of values for each of these name
   spaces, which are described in the remainder of this section.  These
   name spaces will be managed by the IANA and all will be managed
   separately from the name spaces defined for DHCPv4.

   New multicast addresses, message types, status codes, and DUID types
   are assigned via Standards Action [<a href="#ref-11" title='"Guidelines for Writing an IANA Considerations Section in RFCs"'>11</a>].

   New DHCP option codes are tentatively assigned after the
   specification for the associated option, published as an Internet
   Draft, has received expert review by a designated expert [<a href="#ref-11" title='"Guidelines for Writing an IANA Considerations Section in RFCs"'>11</a>].  The
   final assignment of DHCP option codes is through Standards Action, as
   defined in <a href="rfc2434.html">RFC 2434</a> [<a href="#ref-11" title='"Guidelines for Writing an IANA Considerations Section in RFCs"'>11</a>].

   This document also references three name spaces in <a href="#section-21">section 21</a> that
   are associated with the Authentication Option (<a href="#section-22.11">section 22.11</a>).  These
   name spaces are defined by the authentication mechanism for DHCPv4 in
   <a href="rfc3118.html">RFC 3118</a> [<a href="#ref-4" title='"Authentication for DHCP Messages"'>4</a>].

   The authentication name spaces currently registered by IANA will
   apply to both DHCPv6 and DHCPv4.  In the future, specifications that
   define new Protocol, Algorithm and RDM mechanisms will explicitly
   define whether the new mechanisms are used with DHCPv4, DHCPv6 or
   both.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/24.1.%20Multicast%20Addresses"></a><a class="selflink" href="#section-24.1" name="section-24.1">24.1</a>. Multicast Addresses</span>

   <a href="#section-5.1">Section 5.1</a> defines the following multicast addresses, which have
   been assigned by IANA for use by DHCPv6:

      All_DHCP_Relay_Agents_and_Servers address:   FF02::1:2

      All_DHCP_Servers address:                    FF05::1:3
















<span class="grey">Droms, et al.               Standards Track                    [Page 92]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-93" id="page-93" name="page-93"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/24.2.%20DHCP%20Message%20Types"></a><a class="selflink" href="#section-24.2" name="section-24.2">24.2</a>. DHCP Message Types</span>

   IANA has recorded the following message types (defined in <a href="#section-5.3">section</a>
   <a href="#section-5.3">5.3</a>).  IANA will maintain the registry of DHCP message types.

      SOLICIT               1

      ADVERTISE             2

      REQUEST               3

      CONFIRM               4

      RENEW                 5

      REBIND                6

      REPLY                 7

      RELEASE               8

      DECLINE               9

      RECONFIGURE           10

      INFORMATION-REQUEST   11

      RELAY-FORW            12

      RELAY-REPL            13





















<span class="grey">Droms, et al.               Standards Track                    [Page 93]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-94" id="page-94" name="page-94"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/24.3.%20DHCP%20Options"></a><a class="selflink" href="#section-24.3" name="section-24.3">24.3</a>. DHCP Options</span>

   IANA has recorded the following option-codes (as defined in <a href="#section-22">section</a>
   <a href="#section-22">22</a>).  IANA will maintain the registry of DHCP option codes.

      OPTION_CLIENTID       1

      OPTION_SERVERID       2

      OPTION_IA_NA          3

      OPTION_IA_TA          4

      OPTION_IAADDR         5

      OPTION_ORO            6

      OPTION_PREFERENCE     7

      OPTION_ELAPSED_TIME   8

      OPTION_RELAY_MSG      9

      OPTION_AUTH           11

      OPTION_UNICAST        12

      OPTION_STATUS_CODE    13

      OPTION_RAPID_COMMIT   14

      OPTION_USER_CLASS     15

      OPTION_VENDOR_CLASS   16

      OPTION_VENDOR_OPTS    17

      OPTION_INTERFACE_ID   18

      OPTION_RECONF_MSG     19

      OPTION_RECONF_ACCEPT  20









<span class="grey">Droms, et al.               Standards Track                    [Page 94]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-95" id="page-95" name="page-95"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/24.4.%20Status%20Codes"></a><a class="selflink" href="#section-24.4" name="section-24.4">24.4</a>. Status Codes</span>

   IANA has recorded the status codes defined in the following table.
   IANA will manage the definition of additional status codes in the
   future.

   Name         Code Description
   ----------   ---- -----------
   Success         0 Success.
   UnspecFail      1 Failure, reason unspecified; this
                     status code is sent by either a client
                     or a server to indicate a failure
                     not explicitly specified in this
                     document.
   NoAddrsAvail    2 Server has no addresses available to assign to
                     the IA(s).
   NoBinding       3 Client record (binding) unavailable.
   NotOnLink       4 The prefix for the address is not appropriate for
                     the link to which the client is attached.
   UseMulticast    5 Sent by a server to a client to force the
                     client to send messages to the server.
                     using the All_DHCP_Relay_Agents_and_Servers
                     address.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/24.5.%20DUID"></a><a class="selflink" href="#section-24.5" name="section-24.5">24.5</a>. DUID</span>

   IANA has recorded the following DUID types (as defined in <a href="#section-9.1">section</a>
   <a href="#section-9.1">9.1</a>).  IANA will manage the definition of additional DUID types in
   the future.

      DUID-LLT                       1

      DUID-EN                        2

      DUID-LL                        3

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/25.%20Acknowledgments"></a><a class="selflink" href="#section-25" name="section-25">25</a>. Acknowledgments</span>

   Thanks to the DHC Working Group and the members of the IETF for their
   time and input into the specification.  In particular, thanks also
   for the consistent input, ideas, and review by (in alphabetical
   order) Bernard Aboba, Bill Arbaugh, Thirumalesh Bhat, Steve Bellovin,
   A. K. Vijayabhaskar, Brian Carpenter, Matt Crawford, Francis Dupont,
   Richard Hussong, Kim Kinnear, Fredrik Lindholm, Tony Lindstrom, Josh
   Littlefield, Gerald Maguire, Jack McCann, Shin Miyakawa, Thomas
   Narten, Erik Nordmark, Jarno Rajahalme, Yakov Rekhter, Mark Stapp,
   Matt Thomas, Sue Thomson, Tatuya Jinmei and Phil Wells.




<span class="grey">Droms, et al.               Standards Track                    [Page 95]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-96" id="page-96" name="page-96"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


   Thanks to Steve Deering and Bob Hinden, who have consistently taken
   the time to discuss the more complex parts of the IPv6
   specifications.

   And, thanks to Steve Deering for pointing out at IETF 51 in London
   that the DHCPv6 specification has the highest revision number of any
   Internet Draft.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/26.%20References"></a><a class="selflink" href="#section-26" name="section-26">26</a>. References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/26.1.%20Normative%20References"></a><a class="selflink" href="#section-26.1" name="section-26.1">26.1</a>. Normative References</span>

   [<a id="ref-1" name="ref-1">1</a>]  Bradner, S., "Key words for use in RFCs to Indicate Requirement
        Levels", <a href="http://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.

   [<a id="ref-2" name="ref-2">2</a>]  Crawford, M., "Transmission of IPv6 Packets over Ethernet
        Networks", <a href="rfc2464.html">RFC 2464</a>, December 1998.

   [<a id="ref-3" name="ref-3">3</a>]  Deering, S. and R. Hinden, "Internet Protocol, Version 6 (IPv6)
        Specification", <a href="rfc2460.html">RFC 2460</a>, December 1998.

   [<a id="ref-4" name="ref-4">4</a>]  Droms, R., Ed. and W. Arbaugh, Ed., "Authentication for DHCP
        Messages", <a href="rfc3118.html">RFC 3118</a>, June 2001.

   [<a id="ref-5" name="ref-5">5</a>]  Hinden, R. and S. Deering, "IP Version 6 Addressing
        Architecture", <a href="rfc2373.html">RFC 2373</a>, July 1998.

   [<a id="ref-6" name="ref-6">6</a>]  IANA.  Private Enterprise Numbers.
        <a href="http://www.iana.org/assignments/enterprise-numbers.html">http://www.iana.org/assignments/enterprise-numbers.html</a>.

   [<a id="ref-7" name="ref-7">7</a>]  Kent, S. and R. Atkinson, "Security Architecture for the
        Internet Protocol", <a href="rfc2401.html">RFC 2401</a>, November 1998.

   [<a id="ref-8" name="ref-8">8</a>]  Krawczyk, H., Bellare, M. and R. Canetti, "HMAC: Keyed-Hashing
        for Message Authentication", <a href="rfc2104.html">RFC 2104</a>, February 1997.

   [<a id="ref-9" name="ref-9">9</a>]  Mills, D., "Network Time Protocol (Version 3) Specification,
        Implementation", <a href="rfc1305.html">RFC 1305</a>, March 1992.

   [<a id="ref-10" name="ref-10">10</a>] Mockapetris, P., "Domain names - implementation and
        specification", <a href="rfc1035.html">RFC 1035</a>, November 1987.

   [<a id="ref-11" name="ref-11">11</a>] Narten, T. and H. Alvestrand, "Guidelines for Writing an IANA
        Considerations Section in RFCs", <a href="http://tools.ietf.org/html/bcp26">BCP 26</a>, <a href="rfc2434.html">RFC 2434</a>, October 1998.

   [<a id="ref-12" name="ref-12">12</a>] Narten, T. and R. Draves, "Privacy Extensions for Stateless
        Address Autoconfiguration in IPv6", <a href="rfc3041.html">RFC 3041</a>, January 2001.




<span class="grey">Droms, et al.               Standards Track                    [Page 96]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-97" id="page-97" name="page-97"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


   [<a id="ref-13" name="ref-13">13</a>] Narten, T., Nordmark, E. and W. Simpson, "Neighbor Discovery for
        IP Version 6 (IPv6)", <a href="rfc2461.html">RFC 2461</a>, December 1998.

   [<a id="ref-14" name="ref-14">14</a>] Plummer, D.C., "Ethernet Address Resolution Protocol:  Or
        converting network protocol addresses to 48.bit Ethernet address
        for transmission on Ethernet hardware", STD 37, <a href="rfc826.html">RFC 826</a>,
        November 1982.

   [<a id="ref-15" name="ref-15">15</a>] Postel, J., "User Datagram Protocol", STD 6, <a href="rfc768.html">RFC 768</a>, August
        1980.

   [<a id="ref-16" name="ref-16">16</a>] Rivest, R., "The MD5 Message-Digest Algorithm", <a href="rfc1321.html">RFC 1321</a>, April
        1992.

   [<a id="ref-17" name="ref-17">17</a>] Thomson, S. and T. Narten, "IPv6 Stateless Address
        Autoconfiguration", <a href="rfc2462.html">RFC 2462</a>, December 1998.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/26.2.%20Informative%20References"></a><a class="selflink" href="#section-26.2" name="section-26.2">26.2</a>. Informative References</span>

   [<a id="ref-18" name="ref-18">18</a>] Alexander, S. and R. Droms, "DHCP Options and BOOTP Vendor
        Extensions", <a href="rfc2132.html">RFC 2132</a>, March 1997.

   [<a id="ref-19" name="ref-19">19</a>] Droms, R., "Dynamic Host Configuration Protocol", <a href="rfc2131.html">RFC 2131</a>,
        March 1997.

   [<a id="ref-20" name="ref-20">20</a>] R. Droms, Ed.  DNS Configuration options for DHCPv6.  April
        2002.  Work in Progress.

   [<a id="ref-21" name="ref-21">21</a>] A. K. Vijayabhaskar.  Time Configuration Options for DHCPv6.
        May 2002.  Work in Progress.

   [<a id="ref-22" name="ref-22">22</a>] Vixie, P., Ed., Thomson, S., Rekhter, Y. and J. Bound, "Dynamic
        Updates in the Domain Name System (DNS UPDATE)", <a href="rfc2136.html">RFC 2136</a>, April
        1997.

















<span class="grey">Droms, et al.               Standards Track                    [Page 97]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-98" id="page-98" name="page-98"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


<span class="h1"><a class="selflink" href="#appendix-A" name="appendix-A">A</a>. Appearance of Options in Message Types</span>

   The following table indicates with a "*" the options are allowed in
   each DHCP message type:

           Client Server IA_NA  Option Pref  Time Relay Auth. Server
             ID     ID   IA_TA  Request            Msg.       Unica.
   Solicit   *             *      *           *           *
   Advert.   *      *      *            *                 *
   Request   *      *      *      *           *           *
   Confirm   *             *      *           *           *
   Renew     *      *      *      *           *           *
   Rebind    *             *      *           *           *
   Decline   *      *      *      *           *           *
   Release   *      *      *      *           *           *
   Reply     *      *      *            *                 *     *
   Reconf.   *      *             *                       *
   Inform.   * (see note)         *           *           *
   R-forw.                                          *     *
   R-repl.                                          *     *

   NOTE:

      Only included in Information-Request messages that are sent
      in response to a Reconfigure (see <a href="#section-19.4.3">section 19.4.3</a>).

            Status  Rap. User  Vendor Vendor Inter. Recon. Recon.
             Code  Comm. Class Class  Spec.    ID    Msg.  Accept
   Solicit           *     *     *      *                    *
   Advert.    *            *     *      *                    *
   Request                 *     *      *                    *
   Confirm                 *     *      *
   Renew                   *     *      *                    *
   Rebind                  *     *      *                    *
   Decline                 *     *      *
   Release                 *     *      *
   Reply      *      *     *     *      *                    *
   Reconf.                                            *
   Inform.                 *     *      *                    *
   R-forw.                 *     *      *      *
   R-repl.                 *     *      *      *










<span class="grey">Droms, et al.               Standards Track                    [Page 98]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-99" id="page-99" name="page-99"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


<span class="h1"><a class="selflink" href="#appendix-B" name="appendix-B">B</a>. Appearance of Options in the Options Field of DHCP Options</span>

   The following table indicates with a "*" where options can appear in
   the options field of other options:

                Option  IA_NA/ IAADDR Relay  Relay
                Field   IA_TA         Forw.  Reply
   Client ID      *
   Server ID      *
   IA_NA/IA_TA    *
   IAADDR                 *
   ORO            *
   Preference     *
   Elapsed Time   *
   Relay Message                        *      *
   Authentic.     *
   Server Uni.    *
   Status Code    *       *       *
   Rapid Comm.    *
   User Class     *
   Vendor Class   *
   Vendor Info.   *
   Interf. ID                           *      *
   Reconf. MSG.   *
   Reconf. Accept *

   Note: "Relay Forw" / "Relay Reply" options appear in the options
   field of the message but may only appear in these messages.

Chair's Address

   The working group can be contacted via the current chair:

   Ralph Droms
   Cisco Systems
   1414 Massachusetts Avenue
   Boxborough, MA 01719

   Phone: (978) 936-1674
   EMail: rdroms@cisco.com











<span class="grey">Droms, et al.               Standards Track                    [Page 99]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-100" id="page-100" name="page-100"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


Authors' Addresses

   Jim Bound
   Hewlett Packard Corporation
   ZK3-3/W20
   110 Spit Brook Road
   Nashua, NH 03062-2698
   USA

   Phone:  +1 603 884 0062
   EMail:  Jim.Bound@hp.com

   Bernie Volz
   116 Hawkins Pond Road
   Center Harbor, NH  03226-3103
   USA

   Phone:  +1-508-259-3734
   EMail:  volz@metrocast.net

   Ted Lemon
   Nominum, Inc.
   950 Charter Street
   Redwood City, CA 94043
   USA

   EMail:  Ted.Lemon@nominum.com

   Charles E. Perkins
   Communications Systems Lab
   Nokia Research Center
   313 Fairchild Drive
   Mountain View, California 94043
   USA

   Phone:  +1-650 625-2986
   EMail:  charles.perkins@nokia.com

   Mike Carney
   Sun Microsystems, Inc
   17 Network Circle
   Menlo Park, CA 94025
   USA

   Phone:  +1-650-786-4171
   EMail:  michael.carney@sun.com





<span class="grey">Droms, et al.               Standards Track                   [Page 100]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-101" id="page-101" name="page-101"> </a>
<span class="grey"><a href="rfc3315.html">RFC 3315</a>                     DHCP for IPv6                     July 2003</span>


Full Copyright Statement

   Copyright (C) The Internet Society (2003).  All Rights Reserved.

   This document and translations of it may be copied and furnished to
   others, and derivative works that comment on or otherwise explain it
   or assist in its implementation may be prepared, copied, published
   and distributed, in whole or in part, without restriction of any
   kind, provided that the above copyright notice and this paragraph are
   included on all such copies and derivative works.  However, this
   document itself may not be modified in any way, such as by removing
   the copyright notice or references to the Internet Society or other
   Internet organizations, except as needed for the purpose of
   developing Internet standards in which case the procedures for
   copyrights defined in the Internet Standards process must be
   followed, or as required to translate it into languages other than
   English.

   The limited permissions granted above are perpetual and will not be
   revoked by the Internet Society or its successors or assigns.

   This document and the information contained herein is provided on an
   "AS IS" basis and THE INTERNET SOCIETY AND THE INTERNET ENGINEERING
   TASK FORCE DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED, INCLUDING
   BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE INFORMATION
   HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED WARRANTIES OF
   MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

Acknowledgement

   Funding for the RFC Editor function is currently provided by the
   Internet Society.



















Droms, et al.               Standards Track                   [Page 101]

</pre><br/>
<span class="noprint"><small><small>Html markup produced by rfcmarkup 1.107, available from
<a href="http://tools.ietf.org/tools/rfcmarkup/">http://tools.ietf.org/tools/rfcmarkup/</a>
</small></small></span>



</body><!-- Mirrored from tools.ietf.org/html/rfc3315 by HTTrack Website Copier/3.x [XR&CO'2013], Sat, 07 Jun 2014 20:18:50 GMT --></html>