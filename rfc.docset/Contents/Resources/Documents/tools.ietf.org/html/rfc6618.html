<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head profile="http://dublincore.org/documents/2008/08/04/dc-html/">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="robots" content="index,follow" />
    <meta name="creator" content="rfcmarkup version 1.107" />
    <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" />
<meta name="DC.Relation.Replaces" content="draft-korhonen-mext-mip6-altsec" />
<meta name="DC.Identifier" content="urn:ietf:rfc:6618" />
<meta name="DC.Date.Issued" content="May, 2012" />
<meta name="DC.Creator" content="Kroeselberg, Dirk" />
<meta name="DC.Creator" content="Patil, Basavaraj" />
<meta name="DC.Creator" content="Tschofenig, Hannes" />
<meta name="DC.Creator" content="Korhonen, Jouni" />
<meta name="DC.Description.Abstract" content="Mobile IPv6 signaling between a Mobile Node (MN) and its Home Agent\n(HA) is secured using IPsec. The security association (SA) between an\nMN and the HA is established using Internet Key Exchange Protocol\n(IKE) version 1 or 2. The security model specified for Mobile IPv6,\nwhich relies on IKE/IPsec, requires interaction between the Mobile\nIPv6 protocol component and the IKE/IPsec module of the IP stack. This\ndocument proposes an alternate security framework for Mobile IPv6 and\nDual-Stack Mobile IPv6, which relies on Transport Layer Security for\nestablishing keying material and other bootstrapping parameters\nrequired to protect Mobile IPv6 signaling and data traffic between the\nMN and HA. This document defines an Experimental Protocol for the\nInternet community." />
<meta name="DC.Title" content="Mobile IPv6 Security Framework Using Transport Layer Security for Communication between the Mobile Node and Home Agent" />

    <link rel="icon" href="http://tools.ietf.org/images/rfc.png" type="image/png" />
    <link rel="shortcut icon" href="http://tools.ietf.org/images/rfc.png" type="image/png" />
    <title>RFC 6618 - Mobile IPv6 Security Framework Using Transport Layer Security for Communication between the Mobile Node and Home Agent</title>
    
    
    <style type="text/css">
	body {
	    margin: 0px 8px;
            font-size: 1em;
	}
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
   <div style="height: 13px;">
      <div onmouseover="this.style.cursor='pointer';"
         onclick="showElem('legend');"
         onmouseout="hideElem('legend')"
	 style="height: 6px; position: absolute;"
         class="pre noprint docinfo bgyellow"
         title="Click for colour legend." >                                                                        </div>
      <div id="legend"
           class="docinfo noprint pre legend"
           style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; "
           onmouseover="showElem('legend');"
           onmouseout="hideElem('legend');">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="http://tools.ietf.org/rfc/rfc6618.txt" title="Plaintext version of this document">txt</a>|<a href="http://tools.ietf.org/pdf/rfc6618" title="PDF version of this document">pdf</a>] [<a href="http://tools.ietf.org/html/draft-ietf-mext-mip6-tls" title="draft-ietf-mext-mip6-tls">draft-ietf-mext-m...</a>] [<a href="http://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc6618" title="Inline diff (wdiff)">Diff1</a>] [<a href="http://tools.ietf.org/rfcdiff?url2=rfc6618" title="Side-by-side diff">Diff2</a>]                 </span><br />
<span class="pre noprint docinfo">                                                                        </span><br />
<span class="pre noprint docinfo">                                                            EXPERIMENTAL</span><br />
<span class="pre noprint docinfo">                                                                        </span><br />
<pre>
Internet Engineering Task Force (IETF)                  J. Korhonen, Ed.
Request for Comments: 6618                        Nokia Siemens Networks
Category: Experimental                                          B. Patil
ISSN: 2070-1721                                                    Nokia
                                                           H. Tschofenig
                                                  Nokia Siemens Networks
                                                          D. Kroeselberg
                                                                 Siemens
                                                                May 2012


     <span class="h1">Mobile IPv6 Security Framework Using Transport Layer Security</span>
        <span class="h1">for Communication between the Mobile Node and Home Agent</span>

Abstract

   Mobile IPv6 signaling between a Mobile Node (MN) and its Home Agent
   (HA) is secured using IPsec.  The security association (SA) between
   an MN and the HA is established using Internet Key Exchange Protocol
   (IKE) version 1 or 2.  The security model specified for Mobile IPv6,
   which relies on IKE/IPsec, requires interaction between the Mobile
   IPv6 protocol component and the IKE/IPsec module of the IP stack.
   This document proposes an alternate security framework for Mobile
   IPv6 and Dual-Stack Mobile IPv6, which relies on Transport Layer
   Security for establishing keying material and other bootstrapping
   parameters required to protect Mobile IPv6 signaling and data traffic
   between the MN and HA.

Status of This Memo

   This document is not an Internet Standards Track specification; it is
   published for examination, experimental implementation, and
   evaluation.

   This document defines an Experimental Protocol for the Internet
   community.  This document is a product of the Internet Engineering
   Task Force (IETF).  It represents the consensus of the IETF
   community.  It has received public review and has been approved for
   publication by the Internet Engineering Steering Group (IESG).  Not
   all documents approved by the IESG are a candidate for any level of
   Internet Standard; see <a href="rfc5741.html#section-2">Section&nbsp;2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc6618">http://www.rfc-editor.org/info/rfc6618</a>.






<span class="grey">Korhonen, et al.              Experimental                      [Page 1]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-2" id="page-2" href="#page-2" class="invisible"> </a>
<span class="grey"><a href="rfc6618.html">RFC 6618</a>           TLS-Based MIPv6 Security Framework           May 2012</span>


Copyright Notice

   Copyright (c) 2012 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="http://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in <a href="#section-4">Section 4</a>.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-3">3</a>
   <a href="#section-2">2</a>. Terminology and Abbreviations ...................................<a href="#page-4">4</a>
   <a href="#section-3">3</a>. Background ......................................................<a href="#page-5">5</a>
   <a href="#section-4">4</a>. TLS-Based Security Establishment ................................<a href="#page-5">5</a>
      <a href="#section-4.1">4.1</a>. Overview ...................................................<a href="#page-5">5</a>
      <a href="#section-4.2">4.2</a>. Architecture ...............................................<a href="#page-7">7</a>
      <a href="#section-4.3">4.3</a>. Security Association Management ............................<a href="#page-7">7</a>
      <a href="#section-4.4">4.4</a>. Bootstrapping of Additional Mobile IPv6 Parameters .........<a href="#page-9">9</a>
      <a href="#section-4.5">4.5</a>. Protecting Traffic between Mobile Node and Home Agent .....<a href="#page-10">10</a>
   <a href="#section-5">5</a>. MN-to-HAC Communication ........................................<a href="#page-10">10</a>
      <a href="#section-5.1">5.1</a>. Request-Response Message Framing over TLS-Tunnel ..........<a href="#page-10">10</a>
      <a href="#section-5.2">5.2</a>. Request-Response Message Content Encoding .................<a href="#page-11">11</a>
      <a href="#section-5.3">5.3</a>. Request-Response Message Exchange .........................<a href="#page-12">12</a>
      <a href="#section-5.4">5.4</a>. Home Agent Controller Discovery ...........................<a href="#page-13">13</a>
      <a href="#section-5.5">5.5</a>. Generic Request-Response Parameters .......................<a href="#page-13">13</a>
           <a href="#section-5.5.1">5.5.1</a>. Mobile Node Identifier .............................<a href="#page-13">13</a>
           <a href="#section-5.5.2">5.5.2</a>. Authentication Method ..............................<a href="#page-13">13</a>
           <a href="#section-5.5.3">5.5.3</a>. Extensible Authentication Protocol Payload .........<a href="#page-14">14</a>
           <a href="#section-5.5.4">5.5.4</a>. Status Code ........................................<a href="#page-14">14</a>
           <a href="#section-5.5.5">5.5.5</a>. Message Authenticator ..............................<a href="#page-14">14</a>
           <a href="#section-5.5.6">5.5.6</a>. Retry After ........................................<a href="#page-14">14</a>
           <a href="#section-5.5.7">5.5.7</a>. End of Message Content .............................<a href="#page-14">14</a>
           <a href="#section-5.5.8">5.5.8</a>. Random Values ......................................<a href="#page-15">15</a>
      <a href="#section-5.6">5.6</a>. Security Association Configuration Parameters .............<a href="#page-15">15</a>
           <a href="#section-5.6.1">5.6.1</a>. Security Parameter Index ...........................<a href="#page-15">15</a>
           <a href="#section-5.6.2">5.6.2</a>. MN-HA Shared Keys ..................................<a href="#page-16">16</a>
           <a href="#section-5.6.3">5.6.3</a>. Security Association Validity Time .................<a href="#page-16">16</a>
           <a href="#section-5.6.4">5.6.4</a>. Security Association Scope (SAS) ...................<a href="#page-16">16</a>
           <a href="#section-5.6.5">5.6.5</a>. Ciphersuites and Ciphersuite-to-Algorithm Mapping ..<a href="#page-17">17</a>
      <a href="#section-5.7">5.7</a>. Mobile IPv6 Bootstrapping Parameters ......................<a href="#page-18">18</a>
           <a href="#section-5.7.1">5.7.1</a>. Home Agent Address .................................<a href="#page-18">18</a>



<span class="grey">Korhonen, et al.              Experimental                      [Page 2]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-3" id="page-3" href="#page-3" class="invisible"> </a>
<span class="grey"><a href="rfc6618.html">RFC 6618</a>           TLS-Based MIPv6 Security Framework           May 2012</span>


           <a href="#section-5.7.2">5.7.2</a>. Mobile IPv6 Service Port Number ....................<a href="#page-18">18</a>
           <a href="#section-5.7.3">5.7.3</a>. Home Addresses and Home Network Prefix .............<a href="#page-18">18</a>
           <a href="#section-5.7.4">5.7.4</a>. DNS Server .........................................<a href="#page-19">19</a>
      <a href="#section-5.8">5.8</a>. Authentication of the Mobile Node .........................<a href="#page-19">19</a>
      <a href="#section-5.9">5.9</a>. Extensible Authentication Protocol Methods ................<a href="#page-22">22</a>
   <a href="#section-6">6</a>. Mobile Node to Home Agent Communication ........................<a href="#page-23">23</a>
      <a href="#section-6.1">6.1</a>. General ...................................................<a href="#page-23">23</a>
      <a href="#section-6.2">6.2</a>. PType and Security Parameter Index ........................<a href="#page-25">25</a>
      <a href="#section-6.3">6.3</a>. Binding Management Message Formats ........................<a href="#page-25">25</a>
      <a href="#section-6.4">6.4</a>. Reverse-Tunneled User Data Packet Formats .................<a href="#page-27">27</a>
   <a href="#section-7">7</a>. Route Optimization .............................................<a href="#page-29">29</a>
   <a href="#section-8">8</a>. IANA Considerations ............................................<a href="#page-29">29</a>
      <a href="#section-8.1">8.1</a>. New Registry: Packet Type .................................<a href="#page-29">29</a>
      <a href="#section-8.2">8.2</a>. Status Codes ..............................................<a href="#page-29">29</a>
      <a href="#section-8.3">8.3</a>. Port Numbers ..............................................<a href="#page-29">29</a>
   <a href="#section-9">9</a>. Security Considerations ........................................<a href="#page-30">30</a>
      <a href="#section-9.1">9.1</a>. Discovery of the HAC ......................................<a href="#page-30">30</a>
      9.2. Authentication and Key Exchange Executed between
           the MN and the HAC ........................................<a href="#page-30">30</a>
      <a href="#section-9.3">9.3</a>. Protection of MN and HA Communication .....................<a href="#page-33">33</a>
      <a href="#section-9.4">9.4</a>. AAA Interworking ..........................................<a href="#page-35">35</a>
   <a href="#section-10">10</a>. Acknowledgements ..............................................<a href="#page-35">35</a>
   <a href="#section-11">11</a>. References ....................................................<a href="#page-35">35</a>
      <a href="#section-11.1">11.1</a>. Normative References .....................................<a href="#page-35">35</a>
      <a href="#section-11.2">11.2</a>. Informative References ...................................<a href="#page-36">36</a>

<span class="h2"><a class="selflink" name="section-1" href="#section-1">1</a>.  Introduction</span>

   Mobile IPv6 (MIPv6) [<a href="rfc6275.html" title="&quot;Mobility Support in IPv6&quot;">RFC6275</a>] signaling, and optionally user traffic,
   between a Mobile Node (MN) and Home Agent (HA) are secured by IPsec
   [<a href="rfc4301.html" title="&quot;Security Architecture for the Internet Protocol&quot;">RFC4301</a>].  The current Mobile IPv6 security architecture is
   specified in [<a href="rfc3776.html" title="&quot;Using IPsec to Protect Mobile IPv6 Signaling Between Mobile Nodes and Home Agents&quot;">RFC3776</a>] and [<a href="rfc4877.html" title="&quot;Mobile IPv6 Operation with IKEv2 and the Revised IPsec Architecture&quot;">RFC4877</a>].  This security model requires a
   tight coupling between the Mobile IPv6 protocol part and the IKE(v2)/
   IPsec part of the IP stack.  Client implementation experience has
   shown that the use of IKE(v2)/IPsec with Mobile IPv6 is fairly
   complex.

   This document proposes an alternate security framework for Mobile
   IPv6 and Dual-Stack Mobile IPv6.  The objective is to simplify
   implementations as well as make it easy to deploy the protocol
   without compromising on security.  Transport Layer Security (TLS)
   [<a href="rfc5246.html" title="&quot;The Transport Layer Security (TLS) Protocol Version 1.2&quot;">RFC5246</a>] is widely implemented in almost all major operating systems
   and extensively used by various applications.  Instead of using IKEv2
   to establish security associations, the security framework proposed
   in this document is based on TLS-protected messages to exchange keys
   and bootstrapping parameters between the MN and a new functional
   entity called the "Home Agent Controller" (HAC).  The Mobile IPv6
   signaling between the mobile node and home agent is subsequently



<span class="grey">Korhonen, et al.              Experimental                      [Page 3]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-4" id="page-4" href="#page-4" class="invisible"> </a>
<span class="grey"><a href="rfc6618.html">RFC 6618</a>           TLS-Based MIPv6 Security Framework           May 2012</span>


   secured using the resulting keys and negotiated ciphersuite.  The HAC
   can be co-located with the HA, or it can be an independent entity.
   For the latter case, communication between the HAC and HA is not
   defined by this document.  Such communication could be built on top
   of AAA protocols such as Diameter.

   The primary advantage of using TLS for the establishment of Mobile
   IPv6 security associations as compared to the use of IKEv2 is the
   ease of implementation (especially on the mobile nodes) while
   providing an equivalent level of security.  A solution which
   decouples Mobile IPv6 security from IPsec, for securing signaling
   messages and user plane traffic, is proposed herein that reduces
   client implementation complexity.

   The security framework proposed in this document is not intended to
   replace the currently specified architecture that relies on IPsec and
   IKEv2.  It provides an alternative solution that is more optimal for
   certain deployment scenarios.  This and other alternative security
   models have been considered by the MEXT working group at the IETF,
   and it has been decided that the alternative solutions should be
   published as Experimental RFCs, so that more implementation and
   deployment experience with these models can be gathered.  The status
   of this proposal may be reconsidered in the future if it becomes
   clear that it is superior to others.

<span class="h2"><a class="selflink" name="section-2" href="#section-2">2</a>.  Terminology and Abbreviations</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [<a href="rfc2119.html" title="&quot;Key words for use in RFCs to Indicate Requirement Levels&quot;">RFC2119</a>].

   Home Agent Controller (HAC):

      The home agent controller is a node responsible for bootstrapping
      Mobile IPv6 security associations between a mobile node and one or
      more home agents.  The home agent controller also provides key
      distribution to both mobile nodes and home agents.  Mobile IPv6
      bootstrapping is also performed by the HA in addition to the
      security association bootstrapping between the mobile node and
      home agent controller.

   Binding Management Messages:

      Mobile IPv6 signaling messages between a mobile node and a home
      agent, correspondent node, or mobility access point to manage the
      bindings are referred to as binding management messages.  Binding
      Updates (BUs) and Binding Acknowledgement (BA) messages are
      examples of binding management messages.



<span class="grey">Korhonen, et al.              Experimental                      [Page 4]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-5" id="page-5" href="#page-5" class="invisible"> </a>
<span class="grey"><a href="rfc6618.html">RFC 6618</a>           TLS-Based MIPv6 Security Framework           May 2012</span>


<span class="h2"><a class="selflink" name="section-3" href="#section-3">3</a>.  Background</span>

   Mobile IPv6 design and specification began in the mid-to-late 90s.
   The security architecture of Mobile IPv6 was based on the
   understanding that IPsec is an inherent and integral part of the IPv6
   stack and any protocol that needs security should use IPsec unless
   there is a good reason not to.  As a result of this mindset, the
   Mobile IP6 protocol relied on the use of IPsec for security between
   the MN and HA.  Reusing security components that are an integral part
   of the IP stack is a good design objective for any protocol; however,
   in the case of Mobile IPv6, it increases implementation complexity.
   It should be noted that Mobile IPv4 [<a href="rfc5944.html" title="&quot;IP Mobility Support for IPv4, Revised&quot;">RFC5944</a>], for example, does not
   use IPsec for security and instead has specified its own security
   solution.  Mobile IPv4 has been implemented and deployed on a
   reasonably large scale and the security model has proven itself to be
   sound.

   Mobile IPv6 standardization was completed in 2005 along with the
   security architecture using IKE/IPsec specified in <a href="rfc3776.html">RFC 3776</a>
   [<a href="rfc3776.html" title="&quot;Using IPsec to Protect Mobile IPv6 Signaling Between Mobile Nodes and Home Agents&quot;">RFC3776</a>].  With the evolution to IKEv2 [<a href="rfc5996.html" title="&quot;Internet Key Exchange Protocol Version 2 (IKEv2)&quot;">RFC5996</a>], Mobile IPv6
   security has also been updated to rely on the use of IKEv2 [<a href="rfc4877.html" title="&quot;Mobile IPv6 Operation with IKEv2 and the Revised IPsec Architecture&quot;">RFC4877</a>].
   Implementation exercises of Mobile IPv6 and Dual-Stack Mobile IPv6
   [<a href="rfc5555.html" title="&quot;Mobile IPv6 Support for Dual Stack Hosts and Routers&quot;">RFC5555</a>] have identified the complexity of using IPsec and IKEv2 in
   conjunction with Mobile IPv6.  Implementing Mobile IPv6 with IPsec
   and IKEv2 requires modifications to both the IPsec and IKEv2
   components, due to the communication models that Mobile IPv6 uses and
   the changing IP addresses.  For further details, see <a href="rfc3776.html#section-7.1">Section&nbsp;7.1 in
   [RFC3776]</a>.

   This document proposes a security framework based on TLS-protected
   establishment of Mobile IPv6 security associations, which reduces
   implementation complexity while maintaining an equivalent (to IKEv2/
   IPsec) level of security.

<span class="h2"><a class="selflink" name="section-4" href="#section-4">4</a>.  TLS-Based Security Establishment</span>

<span class="h3"><a class="selflink" name="section-4.1" href="#section-4.1">4.1</a>.  Overview</span>

   The security architecture proposed in this document relies on a
   secure TLS session established between the MN and the HAC for mutual
   authentication and MN-HA security association bootstrapping.
   Authentication of the HAC is done via standard TLS operation wherein
   the HAC uses a TLS server certificate as its credentials.  MN
   authentication is done by the HAC via signaling messages that are
   secured by the TLS connection.  Any Extensible Authentication
   Protocol (EAP) method or Pre-Shared Key (PSK) can be used for
   authenticating the MN to the HAC.  Upon successful completion of
   authentication, the HAC generates keys that are delivered to the MN



<span class="grey">Korhonen, et al.              Experimental                      [Page 5]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-6" id="page-6" href="#page-6" class="invisible"> </a>
<span class="grey"><a href="rfc6618.html">RFC 6618</a>           TLS-Based MIPv6 Security Framework           May 2012</span>


   through the secure TLS channel.  The same keys are also provided to
   the assigned HA.  The HAC also provides the MN with MIPv6
   bootstrapping information such as the IPv6 and IPv4 address of the
   HA, the home network prefix, the IPv6 and/or IPv4 Home Address (HoA),
   and DNS server address.

   The MN and HA use security associations based on the keys and
   Security Parameter Indexes (SPIs) generated by the HAC and delivered
   to the MN and HA to secure signaling and optionally user plane
   traffic.  Figure 1 below is an illustration of the process.

   Signaling messages and user plane traffic between the MN and HA are
   always UDP encapsulated.  The packet formats for the signaling and
   user plane traffic is described in Sections <a href="#section-6.3">6.3</a> and <a href="#section-6.4">6.4</a>.

   MN                            HAC                 HA
   --                            ---                 --
    |                             |                   |
    | /-------------------------\ |                   |
    |/                           \|                   |
    |\    TLS session setup      /|                   |
    | \-------------------------/ |                   |
    |                             |                   |
    | /-------------------------\ |                   |
    |/     MN Authentication     \|                   |
    |\                           /|                   |
    | \-------------------------/ |                   |
    |                             |                   |
    | /-------------------------\ |                   |
    |/   HAC provisions the MN   \|                   |
    |\  keys, SPI, &amp; MIPv6 parms /|                   |
    | \-------------------------/ |                   |
    |                             |--MNID, keys, SPI-&gt;|
    |                             |                   |
    | /--------------------------------------------\  |
    |/     MN-HA SA established; Secures            \ |
    |\     signaling and optionally user traffic    / |
    | \--------------------------------------------/  |
    |                                                 |
    |------------BU(encrypted)-----------------------&gt;|
    |                                                 |
    |&lt;---------BAck(encrypted)------------------------|

                     Figure 1: High-Level Architecture







<span class="grey">Korhonen, et al.              Experimental                      [Page 6]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-7" id="page-7" href="#page-7" class="invisible"> </a>
<span class="grey"><a href="rfc6618.html">RFC 6618</a>           TLS-Based MIPv6 Security Framework           May 2012</span>


<span class="h3"><a class="selflink" name="section-4.2" href="#section-4.2">4.2</a>.  Architecture</span>

   The TLS-based security architecture is shown in Figure 2.  The
   signaling message exchange between the MN and the HAC is protected by
   TLS.  It should be noted that an HAC, a AAA server, and an HA are
   logically separate entities and can be collocated in all possible
   combinations.  There MUST be a strong trust relationship between the
   HA and the HAC, and the communication between them MUST be both
   integrity and confidentially protected.

   +------+             +------+            +------+
   |Mobile|     TLS     |Home  |    AAA     | AAA  |
   | Node |&lt;-----------&gt;|Agent |&lt;----------&gt;|Server|
   |      |             |Contrl|            |      |
   +------+             +------+            +------+
      ^                     ^                   ^
      |                     |                   |
      | BU/BA/../           | e.g., AAA         | AAA
      | (Data)              |                   |
      |                     v                   |
      |                +---------+              |
      |                | MIPv6   |              |
      +---------------&gt;| Home    |&lt;-------------+
                       | Agent(s)|
                       +---------+

            Figure 2: TLS-Based Security Architecture Overview

<span class="h3"><a class="selflink" name="section-4.3" href="#section-4.3">4.3</a>.  Security Association Management</span>

   Once the MN has contacted the HAC and mutual authentication has taken
   place between the MN and the HAC, the HAC securely provisions the MN
   with all security-related information inside the TLS protected
   tunnel.  This security-related information constitutes a security
   association (SA) between the MN and the HA.  The created SA MUST NOT
   be tied to the Care-of Address (CoA) of the MN.

   The HAC may proactively distribute the SA information to HAs, or the
   HA may query the SA information from the HAC once the MN contacts the
   HA.  If the HA requests SA information from the HAC, then the HA MUST
   be able to query/index the SA information from the HAC based on the
   SPI identifying the correct security association between the MN and
   the HA.








<span class="grey">Korhonen, et al.              Experimental                      [Page 7]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-8" id="page-8" href="#page-8" class="invisible"> </a>
<span class="grey"><a href="rfc6618.html">RFC 6618</a>           TLS-Based MIPv6 Security Framework           May 2012</span>


   The HA may want the MN to re-establish the SA even if the existing SA
   is still valid.  The HA can indicate this to the MN using a dedicated
   Status Code in a BA (value set to REINIT_SA_WITH_HAC).  As a result,
   the MN SHOULD contact the HAC prior to the SA timing out, and the HAC
   would provision the MN and HAs with a new SA to be used subsequently.

   The SA established between MN and HAC SHALL contain at least the
   following information:

   Mobility SPI:

      This parameter is an SPI used by the MN and the HA to index the SA
      between the MN and the HA.  The HAC is responsible for assigning
      SPIs to MNs.  There is only one SPI for both binding management
      messaging and possible user data protection.  The same SPI is used
      for both directions between the MN and the HA.  The SPI values are
      assigned by the HAC.  The HAC MUST ensure uniqueness of the SPI
      values across all MNs controlled by the HAC.

   MN-HA keys for ciphering:

      A pair of symmetric keys (MN -&gt; HA, HA -&gt; MN) used for ciphering
      Mobile IPv6 traffic between the MN and the HA.  The HAC is
      responsible for generating these keys.  The key generation
      algorithm is specific to the HAC implementation.

   MN-HA shared key for integrity protection:

      A pair of symmetric keys (MN -&gt; HA, HA -&gt; MN) used for integrity
      protecting Mobile IPv6 traffic between the MN and the HA.  This
      includes both binding management messages and reverse-tunneled
      user data traffic between the MN and the HA.  The HAC is
      responsible for generating these keys.  The key generation
      algorithm is specific to the HAC implementation.  In the case of
      combined algorithms, a separate integrity protection key is not
      needed and may be omitted, i.e., the encryption keys SHALL be
      used.

   Security association validity time:

      This parameter represents the validity time for the security
      association.  The HAC is responsible for defining the lifetime
      value based on its policies.  The lifetime may be in the order of
      hours or weeks.  The MN MUST re-contact the HAC before the SA
      validity time ends.






<span class="grey">Korhonen, et al.              Experimental                      [Page 8]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-9" id="page-9" href="#page-9" class="invisible"> </a>
<span class="grey"><a href="rfc6618.html">RFC 6618</a>           TLS-Based MIPv6 Security Framework           May 2012</span>


   Security association scope:

      This parameter defines whether the security association is applied
      to Mobile IPv6 signaling messages only or to both Mobile IPv6
      signaling messages and data traffic.

   Selected ciphersuite:

      This parameter is the ciphersuite used to protect the traffic
      between the MN and the HA.  This includes both binding management
      messages and reverse-tunneled user data traffic between the MN and
      the HA.  The selected algorithms SHOULD be one of the mutually
      supported ciphersuites of the negotiated TLS version between the
      MN and the HAC.  The HAC is responsible for choosing the mutually
      supported ciphersuite that complies with the policy of the HAC.
      Obviously, the HAs under HAC's management must have at least one
      ciphersuite with the HAC in common and need to be aware of the
      implemented ciphersuites.  The selected ciphersuite is the same
      for both directions (MN -&gt; HA and HA -&gt; MN).

   Sequence numbers:

      A monotonically increasing unsigned sequence number used in all
      protected packets exchanged between the MN and the HA in the same
      direction.  Sequence numbers are maintained per direction, so each
      SA includes two independent sequence numbers (MN -&gt; HA, HA -&gt; MN).
      The initial sequence number for each direction MUST always be set
      to 0 (zero).  Sequence numbers cycle to 0 (zero) when increasing
      beyond their maximum defined value.

<span class="h3"><a class="selflink" name="section-4.4" href="#section-4.4">4.4</a>.  Bootstrapping of Additional Mobile IPv6 Parameters</span>

   When the MN contacts the HAC to distribute the security-related
   information, the HAC may also provision the MN with various MIPv6-
   related bootstrapping information.  Bootstrapping of the following
   information SHOULD at least be possible:

   Home Agent IP Address:

      The IPv6 and IPv4 address of the home agent assigned by the HAC.

   Mobile IPv6 Service Port Number:

      The port number where the HA is listening to UDP [<a href="http://tools.ietf.org/html/rfc0768" title="&quot;User Datagram Protocol&quot;">RFC0768</a>]
      packets.






<span class="grey">Korhonen, et al.              Experimental                      [Page 9]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-10" id="page-10" href="#page-10" class="invisible"> </a>
<span class="grey"><a href="rfc6618.html">RFC 6618</a>           TLS-Based MIPv6 Security Framework           May 2012</span>


   Home Address:

      The IPv6 and/or IPv4 home address assigned to the mobile node by
      the HAC.

   Home Link Prefix:

      Concerns the IPv6 Home link prefix and the associated prefix
      length.

   DNS Server Address:

      The address of a DNS server that can be reached via the HA.  DNS
      queries in certain cases cannot be routed to the DNS servers
      assigned by the access network to which the MN is attached; hence,
      an additional DNS server address that is reachable via the HA
      needs to be configured.

   The MIPv6-related bootstrapping information is delivered from the HAC
   to the MN over the same TLS protected tunnel as the security related
   information.

<span class="h3"><a class="selflink" name="section-4.5" href="#section-4.5">4.5</a>.  Protecting Traffic between Mobile Node and Home Agent</span>

   The same integrity and confidentiality algorithms MUST be used to
   protect both binding management messages and reverse-tunneled user
   data traffic between the MN and the HA.  Generally, all binding
   management messages (BUs, BAs, and so on) MUST be integrity protected
   and SHOULD be confidentially protected.  The reverse-tunneled user
   data traffic SHOULD be equivalently protected.  Generally, the
   requirements stated in [<a href="rfc6275.html" title="&quot;Mobility Support in IPv6&quot;">RFC6275</a>] concerning the protection of the
   traffic between the MN and the HA also apply to the mechanisms
   defined by this specification.

<span class="h2"><a class="selflink" name="section-5" href="#section-5">5</a>.  MN-to-HAC Communication</span>

<span class="h3"><a class="selflink" name="section-5.1" href="#section-5.1">5.1</a>.  Request-Response Message Framing over TLS-Tunnel</span>

   The MN and the HAC communicate with each other using a simple
   lockstep request-response protocol that is run inside the protected
   TLS-tunnel.  A generic message container framing for the request
   messages and for the response messages is defined.  The message
   containers are only meant to be exchanged on top of a connection-
   oriented TLS-layer.  Therefore, the end of message exchange is
   determined by the other end closing the transport connection
   (assuming the "application layer" has also indicated the completion
   of the message exchange).  The peer initiating the TLS connection is




<span class="grey">Korhonen, et al.              Experimental                     [Page 10]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-11" id="page-11" href="#page-11" class="invisible"> </a>
<span class="grey"><a href="rfc6618.html">RFC 6618</a>           TLS-Based MIPv6 Security Framework           May 2012</span>


   always sending "Requests", and the peer accepting the TLS connection
   is always sending "Responses".  The format of the message container
   is shown in Figure 3.

   All data inside the Content portion of the message container MUST be
   encoded using octets.  Fragmentation of message containers is not
   supported, which means one request or response at the "application
   layer" MUST NOT exceed the maximum size allowed by the message
   container format.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   | Ver |  Rsrvd  | Identifier    | Length                        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   | Content portion..                                             ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

               Figure 3: Request-Response Message Container

   The 3-bit Ver field identifies the protocol version.  The current
   version is 0, i.e., all bits are set to a value of 0 (zero).

   The Rsrvd field MUST be set to a value of 0 (zero),

   The Identifier field is meant to match requests and responses.  The
   valid Identifier values are between 1-255.  The value 0 MUST NOT be
   used.  The first request for each communication session between the
   MN and the HAC MUST have the Identifier values set to 1.

   The Length field tells the length of the Content portion of the
   container (i.e., Reserved octet, Identifier octet, and Length field
   are excluded).  The Content portion length MUST always be at least
   one octet and up to 65535 octets.  The value is in network order.

<span class="h3"><a class="selflink" name="section-5.2" href="#section-5.2">5.2</a>.  Request-Response Message Content Encoding</span>

   The encoding of the message content is similar to HTTP header
   encoding and complies with the augmented Backus-Naur Form (BNF)
   defined in <a href="rfc2616.html#section-2.1">Section&nbsp;2.1 of [RFC2616]</a>.  All presented hexadecimal
   numbers are in network byte order.  From now on, we use the TypeValue
   header (TV-header) term to refer to request-response message content
   HTTP-like headers.








<span class="grey">Korhonen, et al.              Experimental                     [Page 11]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-12" id="page-12" href="#page-12" class="invisible"> </a>
<span class="grey"><a href="rfc6618.html">RFC 6618</a>           TLS-Based MIPv6 Security Framework           May 2012</span>


<span class="h3"><a class="selflink" name="section-5.3" href="#section-5.3">5.3</a>.  Request-Response Message Exchange</span>

   The message exchange between the MN and the HAC is a simple lockstep
   request-response type as stated in <a href="#section-5.1">Section 5.1</a>.  A request message
   includes a monotonically increasing Identifier value that is copied
   to the corresponding response message.  Each request MUST have a
   different Identifier value.  Hence, a reliable connection-oriented
   transport below the message container framing is assumed.  The number
   of request-response message exchanges MUST NOT exceed 255.

   Each new communication session between the MN and the HAC MUST reset
   the Identifier value to 1.  The MN is also the peer that always sends
   only request messages and the HAC only sends response messages.  Once
   the request-response message exchange completes, the HAC and the MN
   MUST close the transport connection and the corresponding TLS-tunnel.

   In the case of an HAC-side error, the HAC MUST send a response back
   to an MN with an appropriate status code and then close the transport
   connection.

   The first request message - MHAuth-Init - (i.e., the Identifier is 1)
   MUST always contain at least the following parameters:

      MN-Identity - See <a href="#section-5.5.1">Section 5.5.1</a>.

      Authentication Method - See <a href="#section-5.5.2">Section 5.5.2</a>.

   The first response message - MHAuth-Init - (i.e., the Identifier is
   1) MUST contain at minimum the following parameters:

      Selected authentication Method - See <a href="#section-5.5.2">Section 5.5.2</a>.

   The last request message from the MN side - MHAuth-Done - MUST
   contain the following parameters:

      Security association scope - See <a href="#section-5.6.4">Section 5.6.4</a>.

      Proposed ciphersuites - See <a href="#section-5.6.5">Section 5.6.5</a>.

      Message Authenticator - See <a href="#section-5.5.5">Section 5.5.5</a>.

   The last response message - MHAuth-Done - that ends the request-
   response message exchange MUST contain the following parameters:

      Status Code - See <a href="#section-5.5.4">Section 5.5.4</a>.

      Message Authenticator - See <a href="#section-5.5.5">Section 5.5.5</a>.




<span class="grey">Korhonen, et al.              Experimental                     [Page 12]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-13" id="page-13" href="#page-13" class="invisible"> </a>
<span class="grey"><a href="rfc6618.html">RFC 6618</a>           TLS-Based MIPv6 Security Framework           May 2012</span>


   In the case of successful authentication, the following additional
   parameters:

      Selected ciphersuite - See <a href="#section-5.6.5">Section 5.6.5</a>.

      Security association scope - See <a href="#section-5.6.4">Section 5.6.4</a>.

      The rest of the security association data - See <a href="#section-5.6">Section 5.6</a>.

<span class="h3"><a class="selflink" name="section-5.4" href="#section-5.4">5.4</a>.  Home Agent Controller Discovery</span>

   All bootstrapping information, whether for setting up the SA or for
   bootstrapping MIPv6-specific information, is exchanged between the MN
   and the HAC using the framing protocol defined in <a href="#section-5.1">Section 5.1</a>.  The
   IP address of the HAC MAY be statically configured in the MN or
   alternatively MAY be dynamically discovered using DNS.  In the case
   of DNS-based HAC discovery, the MN queries either an A/AAAA or a SRV
   record for the HAC IP address.  The actual domain name used in
   queries is up to the deployment to decide and out of scope of this
   specification.

<span class="h3"><a class="selflink" name="section-5.5" href="#section-5.5">5.5</a>.  Generic Request-Response Parameters</span>

   The grammar used in the following sections is the augmented Backus-
   Naur Form (BNF), the same as that used by HTTP [<a href="rfc2616.html" title="&quot;Hypertext Transfer Protocol -- HTTP/1.1&quot;">RFC2616</a>].

<span class="h4"><a class="selflink" name="section-5.5.1" href="#section-5.5.1">5.5.1</a>.  Mobile Node Identifier</span>

   An identifier that identifies an MN.  The Mobile Node Identifier is
   in the form of a Network Access Identifier (NAI) [<a href="rfc4282.html" title="&quot;The Network Access Identifier&quot;">RFC4282</a>].

      mn-id = "mn-id" ":" <a href="rfc4282.html">RFC4282</a>-NAI CRLF

<span class="h4"><a class="selflink" name="section-5.5.2" href="#section-5.5.2">5.5.2</a>.  Authentication Method</span>

   The HAC is the peer that mandates the authentication method.  The MN
   sends its authentication method proposal to the HAC.  The HAC, upon
   receipt of the MN proposal, returns the selected authentication
   method.  The MN MUST propose at least one authentication method.  The
   HAC MUST select exactly one authentication method or return an error
   and then close the connection.

      auth-method = "auth-method" ":" a-method *("," a-method) CRLF
      a-method =
           "psk" ; PSK-based authentication
         | "eap" ; EAP-based authentication





<span class="grey">Korhonen, et al.              Experimental                     [Page 13]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-14" id="page-14" href="#page-14" class="invisible"> </a>
<span class="grey"><a href="rfc6618.html">RFC 6618</a>           TLS-Based MIPv6 Security Framework           May 2012</span>


<span class="h4"><a class="selflink" name="section-5.5.3" href="#section-5.5.3">5.5.3</a>.  Extensible Authentication Protocol Payload</span>

   Each Extensible Authentication Protocol (EAP) [<a href="rfc3748.html" title="&quot;Extensible Authentication Protocol (EAP)&quot;">RFC3748</a>] message is an
   encoded string of hexadecimal numbers.  The "eap-payload" is
   completely transparent as to which EAP-method or EAP message is
   carried inside it.  The "eap-payload" can appear in both request and
   response messages:

      eap-payload = "eap-payload" ":" 1*(HEX HEX) CRLF

<span class="h4"><a class="selflink" name="section-5.5.4" href="#section-5.5.4">5.5.4</a>.  Status Code</span>

   The "status-code" MUST only be present in the response message that
   ends the request-response message exchange.  The "status-code"
   follows the principles of HTTP and the definitions found in <a href="#section-10">Section</a>
   <a href="#section-10">10</a> of <a href="rfc2616.html">RFC 2616</a> also apply for these status codes listed below:

      status-code = "status-code" ":" status-value CRLF
      status-value =
           "100" ; Continue
         | "200" ; OK
         | "400" ; Bad Request
         | "401" ; Unauthorized
         | "500" ; Internal Server Error
         | "501" ; Not Implemented
         | "503" ; Service Unavailable
         | "504" ; Gateway Time-out

<span class="h4"><a class="selflink" name="section-5.5.5" href="#section-5.5.5">5.5.5</a>.  Message Authenticator</span>

   The "auth" header contains data used for authentication purposes.  It
   MUST be the last TV-header in the message and calculated over the
   whole message till the start of the "msg-header":

      msg-auth = "auth" ":" 1*(HEX HEX) CRLF

<span class="h4"><a class="selflink" name="section-5.5.6" href="#section-5.5.6">5.5.6</a>.  Retry After</span>

      retry-after = "retry-after" ":" <a href="rfc1123.html">rfc1123</a>-date CRLF

<span class="h4"><a class="selflink" name="section-5.5.7" href="#section-5.5.7">5.5.7</a>.  End of Message Content</span>

      end-of-message = 2CRLF








<span class="grey">Korhonen, et al.              Experimental                     [Page 14]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-15" id="page-15" href="#page-15" class="invisible"> </a>
<span class="grey"><a href="rfc6618.html">RFC 6618</a>           TLS-Based MIPv6 Security Framework           May 2012</span>


<span class="h4"><a class="selflink" name="section-5.5.8" href="#section-5.5.8">5.5.8</a>.  Random Values</span>

   Random numbers generated by the MN and the HAC, respectively.  The
   length of the random number MUST be 32 octets (before TV-header
   encoding):

      mn-rand = "mn-rand" ":" 32(HEX HEX) CRLF
      hac-rand = "hac-rand" ":" 32(HEX HEX) CRLF

<span class="h3"><a class="selflink" name="section-5.6" href="#section-5.6">5.6</a>.  Security Association Configuration Parameters</span>

   During the Mobile IPv6 bootstrapping, the MN and the HAC negotiate a
   single ciphersuite for protecting the traffic between the MN and the
   HA.  The allowed ciphersuites for this specification are a subset of
   those in TLS version 1.2 (see <a href="rfc5246.html#appendix-A.5">Appendix&nbsp;A.5 of [RFC5246]</a>) per
   <a href="#section-5.6.5">Section 5.6.5</a>.  This might appear as a constraint as the HA and the
   HAC may have implemented different ciphersuites.  These two nodes
   are, however, assumed to belong to the same administrative domain.
   In order to avoid exchanging supported MN-HA ciphersuites in the MN-
   HAC protocol and to reuse the TLS ciphersuite negotiation procedure,
   we make this simplifying assumption.  The selected ciphersuite MUST
   provide integrity and confidentiality protection.

   <a href="#section-5.6.5">Section 5.6.5</a> provides the mapping from the TLS ciphersuites to the
   integrity and encryption algorithms allowed for MN-HA protection.
   This mapping mainly ignores the authentication algorithm part that is
   not required within the context of this specification.  For example,
   [<a href="rfc5246.html" title="&quot;The Transport Layer Security (TLS) Protocol Version 1.2&quot;">RFC5246</a>] defines a number of AES-based ciphersuites for TLS
   including 'TLS_RSA_WITH_AES_128_CBC_SHA'.  For this specification,
   the relevant part is 'AES_128_CBC_SHA'.

   All the parameters described in the following sections apply only to
   a request-response protocol response message to the MN.  The MN has
   no way of affecting the provisioning decision of the HAC.

<span class="h4"><a class="selflink" name="section-5.6.1" href="#section-5.6.1">5.6.1</a>.  Security Parameter Index</span>

   The 28-bit unsigned SPI number identifies the SA used between the MN
   and the HA.  The value 0 (zero) is reserved and MUST NOT be used.
   Therefore, values ranging from 1 to 268435455 are valid.

   The TV-header corresponding to the SPI number is as follows:

      mip6-spi = "mip6-spi" ":" 1*DIGIT CRLF







<span class="grey">Korhonen, et al.              Experimental                     [Page 15]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-16" id="page-16" href="#page-16" class="invisible"> </a>
<span class="grey"><a href="rfc6618.html">RFC 6618</a>           TLS-Based MIPv6 Security Framework           May 2012</span>


<span class="h4"><a class="selflink" name="section-5.6.2" href="#section-5.6.2">5.6.2</a>.  MN-HA Shared Keys</span>

   The MN-HA shared integrity (ikey) and encryption (ekey) keys are used
   to protect the traffic between the MN and the HA.  The length of
   these keys depend on the selected ciphersuite.

   The TV-headers that carry these two parameters are the following:

      mip6-mn-to-ha-ikey = "mip6-mn-to-ha-ikey" ":" 1*(HEX HEX) CRLF
      mip6-ha-to-mn-ikey = "mip6-ha-to-mn-ikey" ":" 1*(HEX HEX) CRLF
      mip6-mn-to-ha-ekey = "mip6-mn-to-ha-ekey" ":" 1*(HEX HEX) CRLF
      mip6-ha-to-mn-ekey = "mip6-ha-to-mn-ekey" ":" 1*(HEX HEX) CRLF

<span class="h4"><a class="selflink" name="section-5.6.3" href="#section-5.6.3">5.6.3</a>.  Security Association Validity Time</span>

   The end of the SA validity time is encoded using the "<a href="rfc1123.html">rfc1123</a>-date"
   format, as defined in <a href="rfc2616.html#section-3.3.1">Section&nbsp;3.3.1 of [RFC2616]</a>.

   The TV-header corresponding to the SA validity time value is as
   follows:

   mip6-sa-validity-end = "mip6-sa-validity-end" ":" <a href="rfc1123.html">rfc1123</a>-date CRLF

<span class="h4"><a class="selflink" name="section-5.6.4" href="#section-5.6.4">5.6.4</a>.  Security Association Scope (SAS)</span>

   The SA is applied either to Mobile IPv6 signaling messages only or to
   both Mobile IPv6 signaling messages and data traffic.  This policy
   MUST be agreed between the MN and HA prior to using the SA.
   Otherwise, the receiving side will be unaware of whether the SA
   applies to data traffic and hence unable to decide how to act when
   receiving unprotected packets of PType 1 (see <a href="#section-6.4">Section 6.4</a>).

      mip6-sas = "mip6-sas" ":" 1DIGIT CRLF

   where a value of "O" indicates that the SA does not protect data
   traffic and a value of "1" indicates that all data traffic MUST be
   protected by the SA.  If the mip6-sas value of an SA is set to 1, any
   packet received with a PType value that does not match the mip6-sas
   value of the SA MUST be silently discarded.

   The HAC is the peer that mandates the used security association
   scope.  The MN sends its proposal to the HAC, but eventually the
   security association scope returned from the HAC defines the used
   scope.







<span class="grey">Korhonen, et al.              Experimental                     [Page 16]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-17" id="page-17" href="#page-17" class="invisible"> </a>
<span class="grey"><a href="rfc6618.html">RFC 6618</a>           TLS-Based MIPv6 Security Framework           May 2012</span>


<span class="h4"><a class="selflink" name="section-5.6.5" href="#section-5.6.5">5.6.5</a>.  Ciphersuites and Ciphersuite-to-Algorithm Mapping</span>

   The ciphersuite negotiation between HAC and MN uses a subset of the
   TLS 1.2 ciphersuites and follows the TLS 1.2 numeric representation
   defined in <a href="rfc5246.html#appendix-A.5">Appendix&nbsp;A.5 of [RFC5246]</a>.  The TV-headers corresponding
   to the selected ciphersuite and ciphersuite list are the following:

      mip6-ciphersuite = "mip6-ciphersuite" ":" csuite CRLF
      csuite = "{" suite "}"
      suite =
           "00" "," "02" ; CipherSuite NULL_SHA           = {0x00,0x02}
         | "00" "," "3B" ; CipherSuite NULL_SHA256        = {0x00,0x3B}
         | "00" "," "0A" ; CipherSuite 3DES_EDE_CBC_SHA   = {0x00,0x0A}
         | "00" "," "2F" ; CipherSuite AES_128_CBC_SHA    = {0x00,0x2F}
         | "00" "," "3C" ; CipherSuite AES_128_CBC_SHA256 = {0x00,0x3C}

      mip6-suitelist = "mip6-suitelist" ":" csuite *("," csuite) CRLF

   All other Ciphersuite values are reserved.

   The following integrity algorithms MUST be supported by all
   implementations:

      HMAC-SHA1-96                    [<a href="rfc2404.html" title="&quot;The Use of HMAC-SHA-1-96 within ESP and AH&quot;">RFC2404</a>]
      AES-XCBC-MAC-96                 [<a href="rfc3566.html" title="&quot;The AES-XCBC-MAC-96 Algorithm and Its Use With IPsec&quot;">RFC3566</a>]

   The binding management messages between the MN and HA MUST be
   integrity protected.  Implementations MUST NOT use a NULL integrity
   algorithm.

   The following encryption algorithms MUST be supported:

      NULL                            [<a href="rfc2410.html" title="&quot;The NULL Encryption Algorithm and Its Use With IPsec&quot;">RFC2410</a>]
      TripleDES-CBC                   [<a href="rfc2451.html" title="&quot;The ESP CBC-Mode Cipher Algorithms&quot;">RFC2451</a>]
      AES-CBC with 128-bit keys       [<a href="rfc3602.html" title="&quot;The AES-CBC Cipher Algorithm and Its Use with IPsec&quot;">RFC3602</a>]

   Traffic between MN and HA MAY be encrypted.  Any integrity-only
   Ciphersuite makes use of the NULL encryption algorithm.

   Note: This document does not consider combined algorithms.  The
   following table provides the mapping of each ciphersuite to a
   combination of integrity and encryption algorithms that are part of
   the negotiated SA between MN and HA.








<span class="grey">Korhonen, et al.              Experimental                     [Page 17]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-18" id="page-18" href="#page-18" class="invisible"> </a>
<span class="grey"><a href="rfc6618.html">RFC 6618</a>           TLS-Based MIPv6 Security Framework           May 2012</span>


   +-------------------+-----------------+--------------------------+
   |Ciphersuite        |Integ. Algorithm |Encr. Algorithm           |
   +-------------------+-----------------+--------------------------+
   |NULL_SHA           |HMAC-SHA1-96     |NULL                      |
   |NULL_SHA256        |AES-XCBC-MAC-96  |NULL                      |
   |3DES_EDE_CBC_SHA   |HMAC-SHA1-96     |TripleDES-CBC             |
   |AES_128_CBC_SHA    |HMAC-SHA1-96     |AES-CBC with 128-bit keys |
   |AES_128_CBC_SHA256 |AES-XCBC-MAC-96  |AES-CBC with 128-bit keys |
   +-------------------+----------------+---------------------------+

                     Ciphersuite-to-Algorithm Mapping

<span class="h3"><a class="selflink" name="section-5.7" href="#section-5.7">5.7</a>.  Mobile IPv6 Bootstrapping Parameters</span>

   In parallel with the SA bootstrapping, the HAC SHOULD provision the
   MN with relevant MIPv6-related bootstrapping information.

   The following generic BNFs are used to form IP addresses and
   prefixes.  They are used in subsequent sections.

      ip6-addr   = 7( word ":" ) word CRLF
      word       = 1*4HEX
      ip6-prefix = ip6-addr "/" 1*2DIGIT
      ip4-addr   = 1*3DIGIT "." 1*3DIGIT "." 1*3DIGIT "." 1*3DIGIT
      ip4-subnet = ip4-addr "/" 1*2DIGIT

<span class="h4"><a class="selflink" name="section-5.7.1" href="#section-5.7.1">5.7.1</a>.  Home Agent Address</span>

   The HAC MAY provision the MN with an IPv4 or an IPv6 address of an
   HA, or both.

      mip6-haa-ip6 = "mip6-haa-ip6" ":" ip6-addr CRLF
      mip6-haa-ip4 = "mip6-haa-ip4" ":" ip4-addr CRLF

<span class="h4"><a class="selflink" name="section-5.7.2" href="#section-5.7.2">5.7.2</a>.  Mobile IPv6 Service Port Number</span>

   The HAC SHOULD provision the MN with an UDP port number, where the HA
   expects to receive UDP packets.  If this parameter is not present,
   then the IANA reserved port number (mipv6tls) MUST be used instead.

      mip6-port = "mip6-port" ":" 1*5DIGIT CRLF

<span class="h4"><a class="selflink" name="section-5.7.3" href="#section-5.7.3">5.7.3</a>.  Home Addresses and Home Network Prefix</span>

   The HAC MAY provision the MN with an IPv4 or an IPv6 home address, or
   both.  The HAC MAY also provision the MN with its home network
   prefix.




<span class="grey">Korhonen, et al.              Experimental                     [Page 18]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-19" id="page-19" href="#page-19" class="invisible"> </a>
<span class="grey"><a href="rfc6618.html">RFC 6618</a>           TLS-Based MIPv6 Security Framework           May 2012</span>


      mip6-ip6-hoa = "mip6-ip6-hoa" ":" ip6-addr CRLF
      mip6-ip4-hoa = "mip6-ip4-hoa" ":" ip4-addr CRLF
      mip6-ip6-hnp = "mip6-ip6-hnp" ":" ip6-prefix CRLF
      mip6-ip4-hnp = "mip6-ip4-hnp" ":" ip4-subnet CRLF

<span class="h4"><a class="selflink" name="section-5.7.4" href="#section-5.7.4">5.7.4</a>.  DNS Server</span>

   The HAC may also provide the MN with DNS server configuration
   options.  These DNS servers are reachable via the home agent.

      dns-ip6 = "dns-ip6" ":" ip6-addr CRLF
      dns-ip4 = "dns-ip4" ":" ip4-addr CRLF

<span class="h3"><a class="selflink" name="section-5.8" href="#section-5.8">5.8</a>.  Authentication of the Mobile Node</span>

   This section describes the basic operation required for the MN-HAC
   mutual authentication and the channel binding.  The authentication
   protocol described as part of this section is a simple exchange that
   follows the Generalized Pre-Shared Key (GPSK) exchange used by EAP-
   GPSK [<a href="rfc5433.html" title="&quot;Extensible Authentication Protocol - Generalized Pre-Shared Key (EAP-GPSK) Method&quot;">RFC5433</a>].  It is secured by the TLS tunnel and is
   cryptographically bound to the TLS tunnel through channel binding
   based on [<a href="rfc5056.html" title="&quot;On the Use of Channel Bindings to Secure Channels&quot;">RFC5056</a>] and on the channel binding type 'tls-server-
   endpoint' described in [<a href="rfc5929.html" title="&quot;Channel Bindings for TLS&quot;">RFC5929</a>].  As a result of the channel binding
   type, this method can only be used with TLS ciphersuites that use
   server certificates and the Certificate handshake message.  For
   example, TLS ciphersuites based on PSK or anonymous authentication
   cannot be used.

   The authentication exchange MUST be performed through the encrypted
   TLS tunnel.  It performs mutual authentication between the MN and the
   HAC based on a PSK or based on an EAP-method (see <a href="#section-5.9">Section 5.9</a>).  Note
   that an HAC MUST NOT allow MNs to renegotiate TLS sessions.  The PSK
   protocol is described in this section.  It consists of the message
   exchanges (MHAuth-Init, MHAuth-Mid, MHAuth-Done) in which both sides
   exchange nonces and their identities, and compute and exchange a
   message authenticator 'auth' over the previously exchanged values,
   keyed with the pre-shared key.  The MHAuth-Done messages are used to
   deal with error situations.  Key binding with the TLS tunnel is
   ensured by channel binding of the type "tls-server-endpoint" as
   described by [<a href="rfc5929.html" title="&quot;Channel Bindings for TLS&quot;">RFC5929</a>] where the hash of the TLS server certificate
   serves as input to the 'auth' calculation of the MHAuth messages.

   Note: The authentication exchange is based on the GPSK exchange used
   by EAP-GPSK.  In comparison to GPSK, it does not support exchanging
   an encrypted container (it always runs through an already protected
   TLS tunnel).  Furthermore, the initial request of the authentication
   exchange (MHAuth-Init) is sent by the MN (client side) and is




<span class="grey">Korhonen, et al.              Experimental                     [Page 19]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-20" id="page-20" href="#page-20" class="invisible"> </a>
<span class="grey"><a href="rfc6618.html">RFC 6618</a>           TLS-Based MIPv6 Security Framework           May 2012</span>


   comparable to EAP-Response/Identity, which reverses the roles of
   request and response messages compared to EAP-GPSK.  Figure 4 shows a
   successful protocol exchange.

   MN                                                      HAC
    |                                                       |
    | Request/MHAuth-Init (...)                             |
    |------------------------------------------------------&gt;|
    |                                                       |
    |                            Response/MHAuth-Init (...) |
    |&lt;------------------------------------------------------|
    |                                                       |
    | Request/MHAuth-Done (...)                             |
    |------------------------------------------------------&gt;|
    |                                                       |
    |                            Response/MHAuth-Done (...) |
    |&lt;------------------------------------------------------|
    |                                                       |

     Figure 4: Authentication of the Mobile Node Using Shared Secrets

   1)  Request/MHAuth-Init: (MN -&gt; HAC)

          mn-id, mn-rand, auth-method=psk

   2)  Response/MHAuth-Init: (MN &lt;- HAC)

          [mn-rand, hac-rand, auth-method=psk, [status],] auth

   3)  Request/MHAuth-Done: (MN -&gt; HAC)

          mn-rand, hac-rand, sa-scope, ciphersuite-list, auth

   4)  Response/MHAuth-Done: (MN &lt;- HAC)

          [sa-scope, sa-data, ciphersuite, bootstrapping-data,] mn-rand,
          hac-rand, status, auth

   Where 'auth' for MN -&gt; HAC direction is as follows:

      auth = HMAC-SHA256(PSK, "MN" | msg-octets | CB-octets)

   Where 'auth' for MN &lt;- HAC direction is as follows:

      auth = HMAC-SHA256(PSK, "HAC" | msg-octets | CB-octets)

   In the above, "MN" is 2 ASCII characters without null termination and
   "HAC" is 3 ASCII characters without null termination.



<span class="grey">Korhonen, et al.              Experimental                     [Page 20]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-21" id="page-21" href="#page-21" class="invisible"> </a>
<span class="grey"><a href="rfc6618.html">RFC 6618</a>           TLS-Based MIPv6 Security Framework           May 2012</span>


   The length "mn-rand", "hac-rand" is 32 octets.  Note that "|"
   indicates concatenation and optional parameters are shown in square
   brackets [..].  The square brackets can be nested.

   The shared secret PSK can be variable length. 'msg-octets' includes
   all payload parameters of the respective message to be signed except
   the 'auth' payload.  CB-octets is the channel binding input to the
   auth calculation that is the "TLS-server-endpoint" channel binding
   type.  The content and algorithm (only required for the "TLS-server-
   endpoint" type) are the same as described in [<a href="rfc5929.html" title="&quot;Channel Bindings for TLS&quot;">RFC5929</a>].

   The MN starts by selecting a random number 'mn-rand' and choosing a
   list of supported authentication methods coded in 'auth-method'.  The
   MN sends its identity 'mn-id', 'mn-rand', and 'auth-method' to the
   HAC in MHAuth-Init.  The decision of which authentication method to
   offer and which to pick is policy and implementation dependent and,
   therefore, outside the scope of this document.

   In MHAuth-Done, the HAC sends a random number 'hac-rand' and the
   selected ciphersuite.  The selection MUST be one of the MN-supported
   ciphersuites as received in 'ciphersuite-list'.  Furthermore, it
   repeats the received parameters of the MHAuth-Init message 'mn-rand'.
   It computes a message authenticator 'auth' over all the transmitted
   parameters except 'auth' itself.  The HAC calculates 'auth' over all
   parameters and appends it to the message.

   The MN verifies the received Message Authentication Code (MAC) and
   the consistency of the identities, nonces, and ciphersuite parameters
   transmitted in MHAuth-Auth.  In case of successful verification, the
   MN computes a MAC over the session parameter and returns it to the
   HAC in MHAuth-Done.  The HAC verifies the received MAC and the
   consistency of the identities, nonces, and ciphersuite parameters
   transmitted in MHAuth-Init.  If the verification is successful,
   MHAuth-Done is prepared and sent by the HAC to confirm successful
   completion of the exchange.
















<span class="grey">Korhonen, et al.              Experimental                     [Page 21]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-22" id="page-22" href="#page-22" class="invisible"> </a>
<span class="grey"><a href="rfc6618.html">RFC 6618</a>           TLS-Based MIPv6 Security Framework           May 2012</span>


<span class="h3"><a class="selflink" name="section-5.9" href="#section-5.9">5.9</a>.  Extensible Authentication Protocol Methods</span>

   Basic operation required for the MN-HAC mutual authentication using
   EAP-based methods.

   MN                                                      HAC
    |                                                       |
    | Request/MHAuth-Init (...)                             |
    |------------------------------------------------------&gt;|
    |                                                       |
    |                            Response/MHAuth-Init (..., |
    |                     eap-payload=EAP-Request/Identity) |
    |&lt;------------------------------------------------------|
    |                                                       |
    | Request/MHAuth-Mid (eap-payload=                      |
    |              EAP-Response/Identity)                   |
    |------------------------------------------------------&gt;|
    |                                                       |
    |     Response/MHAuth-Mid (eap-payload=EAP-Request/...) |
    |&lt;------------------------------------------------------|
    |                                                       |
    :                                                       :
    :        ..EAP-method specific exchanges..              :
    :                                                       :
    |                                                       |
    | Request/MHAuth-Done (eap-payload=EAP-Response/...,    |
    |                      ..., auth)                       |
    |------------------------------------------------------&gt;|
    |                                                       |
    |        Response/MHAuth-Done (eap-payload=EAP-Success, |
    |                              ..., auth)               |
    |&lt;------------------------------------------------------|
    |                                                       |

           Figure 5: Authentication of the Mobile Node Using EAP

   1)  Request/MHAuth-Init: (MN -&gt; HAC)

          mn-id, mn-rand, auth-method=eap

   2)  Response/MHAuth-Init: (MN &lt;- HAC)

          [auth-method=eap, eap, [status,]] auth

   3)  Request/MHAuth-Mid: (MN -&gt; HAC)

          eap, auth




<span class="grey">Korhonen, et al.              Experimental                     [Page 22]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-23" id="page-23" href="#page-23" class="invisible"> </a>
<span class="grey"><a href="rfc6618.html">RFC 6618</a>           TLS-Based MIPv6 Security Framework           May 2012</span>


   4)  Response/MHAuth-Mid: (MN &lt;- HAC)

          eap, auth

       MHAuth-Mid exchange is repeated as many times as needed by the
       used EAP-method.

   5)  Request/MHAuth-Done: (MN -&gt; HAC)

          sa-scope, ciphersuite-list, eap, auth

   6)  Response/MHAuth-Done: (MN &lt;- HAC)

          [sa-scope, sa-data, ciphersuite, bootstrapping-data,] eap,
          status, auth

   Where 'auth' for MN -&gt; HAC direction is as follows:

      auth = HMAC-SHA256(shared-key, "MN" | msg-octets | CB-octets)

   Where 'auth' for MN &lt;- HAC direction is as follows:

      auth = HMAC-SHA256(shared-key, "HAC" | msg-octets | CB-octets)

   In the above, "MN" is 2 ASCII characters without null termination and
   "HAC" is 3 ASCII characters without null termination.

   In MHAuth-Init and MHAuth-Mid messages, shared-key is set to "1".  If
   the EAP-method is key-deriving and creates a shared Master Session
   Key (MSK) as a side effect of Authentication shared-key MUST be the
   MSK in all MHAuth-Done messages.  This MSK MUST NOT be used for any
   other purpose.  In case the EAP method does not generate an MSK,
   shared-key is set to "1".

   'msg-octets' includes all payload parameters of the respective
   message to be signed except the 'auth' payload.  CB-octets is the
   channel binding input to the AUTH calculation that is the "TLS-
   server-endpoint" channel binding type.  The content and algorithm
   (only required for the "TLS-server-endpoint" type) are the same as
   described in [<a href="rfc5929.html" title="&quot;Channel Bindings for TLS&quot;">RFC5929</a>].

<span class="h2"><a class="selflink" name="section-6" href="#section-6">6</a>.  Mobile Node to Home Agent Communication</span>

<span class="h3"><a class="selflink" name="section-6.1" href="#section-6.1">6.1</a>.  General</span>

   The following subsections describe the packet formats used for the
   traffic between the MN and the HA.  This traffic includes binding
   management messages (for example, BU and BA messages), reverse-



<span class="grey">Korhonen, et al.              Experimental                     [Page 23]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-24" id="page-24" href="#page-24" class="invisible"> </a>
<span class="grey"><a href="rfc6618.html">RFC 6618</a>           TLS-Based MIPv6 Security Framework           May 2012</span>


   tunneled and encrypted user data, and reverse-tunneled plaintext user
   data.  This specification defines a generic packet format, where
   everything is encapsulated inside UDP.  See Sections <a href="#section-6.3">6.3</a> and <a href="#section-6.4">6.4</a> for
   detailed illustrations of the corresponding packet formats.

   The Mobile IPv6 service port number is where the HA expects to
   receive UDP packets.  The same port number is used for both binding
   management messages and user data packets.  The reason for
   multiplexing data and control messages over the same port number is
   due to the possibility of Network Address and Port Translators
   located along the path between the MN and the HA.  The Mobile IPv6
   service MAY use any ephemeral port number as the UDP source port, and
   it MUST use the Mobile IPv6 service port number as the UDP
   destination port.  The Mobile IPv6 service port is dynamically
   assigned to the MN during the bootstrapping phase (i.e., the mip6-
   port parameter) or, in absence of the bootstrapping parameter, the
   IANA reserved port (mipv6tls) MUST be used.

   The encapsulating UDP header is immediately followed by a 4-bit
   Packet Type (PType) field that defines whether the packet contains an
   encrypted mobility management message, an encrypted user data packet,
   or a plaintext user data packet.

   The Packet Type field is followed by a 28-bit SPI value, which
   identifies the correct SA concerning the encrypted packet.  For any
   packet that is neither integrity protected nor encrypted (i.e., no SA
   is applied by the originator), the SPI MUST be set to 0 (zero).
   Mobility management messages MUST always be at least integrity
   protected.  Hence, mobility management messages MUST NOT be sent with
   an SPI value of 0 (zero).

   There is always only one SPI per MN-HA mobility session and the same
   SPI is used for all types of protected packets independent of the
   direction.

   The SPI value is followed by a 32-bit Sequence Number value that is
   used to identify retransmissions of protected messages (integrity
   protected or both integrity protected and encrypted, see Figures 7
   and 8) .  Each endpoint in the security association maintains two
   "current" Sequence Numbers: the next one to be used for a packet it
   initiates and the next one it expects to see in a packet from the
   other end.  If the MN and the HA ends initiate very different numbers
   of messages, the Sequence Numbers in the two directions can be very
   different.  In the case data protection is not used (see Figure 9),
   the Sequence Number MUST be set to 0 (zero).  Note that the HA SHOULD
   initiate a re-establishment of the SA before any of the Sequence
   Number cycle.




<span class="grey">Korhonen, et al.              Experimental                     [Page 24]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-25" id="page-25" href="#page-25" class="invisible"> </a>
<span class="grey"><a href="rfc6618.html">RFC 6618</a>           TLS-Based MIPv6 Security Framework           May 2012</span>


   Finally, the Sequence Number field is followed by the data portion,
   whose content is identified by the Packet Type.  The data portion may
   be protected.

<span class="h3"><a class="selflink" name="section-6.2" href="#section-6.2">6.2</a>.  PType and Security Parameter Index</span>

   The PType is a 4-bit field that indicates the Packet Type (PType) of
   the UDP encapsulated packet.  The PType is followed by a 28-bit SPI
   value.  The PType and the SPI fields are treated as one 32-bit field
   during the integrity protection calculation.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   | PType |                        SPI                            |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

            Figure 6: Security Parameter Index with Packet Type

   A SPI value of 0 (zero) indicates a plaintext packet.  If the packet
   is integrity protected or both integrity protected and encrypted, the
   SPI value MUST be different from 0.  When the SPI value is set to 0,
   then the PType MUST also be 0.

<span class="h3"><a class="selflink" name="section-6.3" href="#section-6.3">6.3</a>.  Binding Management Message Formats</span>

   The binding management messages that are only meant to be exchanged
   between the MN and the HA MUST be integrity protected and MAY be
   encrypted.  They MUST use the packet format shown in Figure 7.

   All packets that are specific to the Mobile IPv6 protocol, contain a
   Mobility Header (as defined in <a href="rfc6275.html#section-6.1.1">Section&nbsp;6.1.1. of RFC 6275</a>) and are
   used between the MN and the HA shall use the packet format shown in
   Figure 7.  (This means that some Mobile IPv6 mobility management
   messages, such as the Home Test Init (HoTI) message, are treated as
   data packets and using encapsulation described in <a href="#section-6.4">Section 6.4</a> and
   shown in Figures 8 and 9).














<span class="grey">Korhonen, et al.              Experimental                     [Page 25]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-26" id="page-26" href="#page-26" class="invisible"> </a>
<span class="grey"><a href="rfc6618.html">RFC 6618</a>           TLS-Based MIPv6 Security Framework           May 2012</span>


 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
:         IPv4 or IPv6 header (src-addr=Xa, dst-addr=Ya)        :
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
:            UDP header (src-port=Xp,dst-port=Yp)               :
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ------
|PType=8|                    SPI                                | ^Int.
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ |Cov-
|                      Sequence Number                          | |ered
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ | ----
|                    Payload Data  (variable)                   | |   ^
:                                                               : |   |
|                                                               | |Conf.
+               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ |Cov-
|               |     Padding (0-255 bytes)                     | |ered
+-+-+-+-+-+-+-+-+               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ |   |
|                               |  Pad Length   | Next Header   | v   v
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ------
|         Integrity Check Value-ICV   (variable)                |
:                                                               :
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

       Figure 7: UDP-Encapsulated Binding Management Message Format

   The PType value 8 (eight) identifies that the UDP-encapsulated packet
   contains a Mobility Header (defined by <a href="rfc6275.html">RFC 6275</a>) and other relevant
   IPv6 extension headers.  Note, there is no additional IP header
   inside the encapsulated part.  The Next Header field MUST be set to
   value of the first encapsulated header.  The encapsulated headers
   follow the natural IPv6 and Mobile IPv6 extension header alignment
   and formatting rules.

   The Padding, Pad Length, Next Header, and ICV fields follow the rules
   of <a href="#section-2.4">Section 2.4</a> to 2.8 of [<a href="rfc4303.html" title="&quot;IP Encapsulating Security Payload (ESP)&quot;">RFC4303</a>] unless otherwise stated in this
   document.  For an SPI value of 0 (zero) that indicates an unprotected
   packet, the Padding, Pad Length, Next Header, and ICV fields MUST NOT
   be present.

   The source and destination IP addresses of the outer IP header (i.e.,
   the src-addr and the dst-addr in Figure 7) use the current CoA of the
   MN and the HA address.




<span class="grey">Korhonen, et al.              Experimental                     [Page 26]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-27" id="page-27" href="#page-27" class="invisible"> </a>
<span class="grey"><a href="rfc6618.html">RFC 6618</a>           TLS-Based MIPv6 Security Framework           May 2012</span>


<span class="h3"><a class="selflink" name="section-6.4" href="#section-6.4">6.4</a>.  Reverse-Tunneled User Data Packet Formats</span>

   There are two types of reverse-tunneled user data packets between the
   MN and the HA: those that are integrity protected and/or encrypted
   and those that are sent in the clear.  The MN or the HA decides
   whether to apply integrity protection and/or encryption to a packet
   or to send it in the clear based on the mip6-sas value in the SA.  If
   the mip6-sas is set to 1, the originator MUST NOT send any user data
   packets in the clear, and the receiver MUST silently discard any
   packet with the PType set to 0 (unprotected).  It is RECOMMENDED that
   confidentiality and integrity protection of user data traffic be
   applied.  The reverse-tunneled IPv4 or IPv6 user data packets are
   encapsulated as is inside the 'Payload Data' shown in Figures 8 and
   9.

 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
:         IPv4 or IPv6 header (src-addr=Xa, dst-addr=Ya)        :
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
:            UDP header (src-port=Xp,dst-port=Yp)               :
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|PType=1|                    SPI                                | ^Int.
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ |Cov-
|                      Sequence Number                          | |ered
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ | ----
|                    Payload Data  (variable)                   | |   ^
:                                                               : |   |
|                                                               | |Conf.
+               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ |Cov-
|               |     Padding (0-255 bytes)                     | |ered
+-+-+-+-+-+-+-+-+               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ |   |
|                               |  Pad Length   | Next Header   | v   v
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ------
|         Integrity Check Value-ICV   (variable)                |
:                                                               :
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

       Figure 8: UDP-Encapsulated Protected User Data Packet Format







<span class="grey">Korhonen, et al.              Experimental                     [Page 27]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-28" id="page-28" href="#page-28" class="invisible"> </a>
<span class="grey"><a href="rfc6618.html">RFC 6618</a>           TLS-Based MIPv6 Security Framework           May 2012</span>


   The PType value 1 (one) identifies that the UDP-encapsulated packet
   contains an encrypted-tunneled IPv4/IPv6 user data packet.  The Next
   Header field header MUST be set to value corresponding the tunneled
   IP packet (e.g., 41 for IPv6).

   The Padding, Pad Length, Next Header, and ICV fields follow the rules
   of <a href="#section-2.4">Section 2.4</a> to 2.8 of [<a href="rfc4303.html" title="&quot;IP Encapsulating Security Payload (ESP)&quot;">RFC4303</a>] unless otherwise stated in this
   document.  For an SPI value of 0 (zero) that indicates an unprotected
   packet, the Padding, Pad Length, Next Header, and ICV fields MUST NOT
   be present.

   The source and destination IP addresses of the outer IP header (i.e.,
   the src-addr and the dst-addr in Figure 8) use the current CoA of the
   MN and the HA address.  The ESP-protected inner IP header, which is
   not shown in Figure 8, uses the home address of the MN and the
   correspondent node (CN) address.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   :         IPv4 or IPv6 header (src-addr=Xa, dst-addr=Ya)        :
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   :            UDP header (src-port=Xp,dst-port=Yp)               :
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |PType=0|                        0                              |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                0                              |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   :           Payload Data (plain IPv4 or IPv6 Packet)            :
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

     Figure 9: UDP-Encapsulated Non-Protected User Data Packet Format

   The PType value 0 (zero) identifies that the UDP-encapsulated packet
   contains a plaintext-tunneled IPv4/IPv6 user data packet.  Also, the
   SPI and the Sequence Number fields MUST be set to 0 (zero).

   The source and destination IP addresses of the outer IP header (i.e.,
   the src-addr and the dst-addr in Figure 9) use the current CoA of the
   MN and the HA address.  The plaintext inner IP header uses the home
   address of the MN and the CN address.




<span class="grey">Korhonen, et al.              Experimental                     [Page 28]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-29" id="page-29" href="#page-29" class="invisible"> </a>
<span class="grey"><a href="rfc6618.html">RFC 6618</a>           TLS-Based MIPv6 Security Framework           May 2012</span>


<span class="h2"><a class="selflink" name="section-7" href="#section-7">7</a>.  Route Optimization</span>

   Mobile IPv6 route optimization as described in [<a href="rfc6275.html" title="&quot;Mobility Support in IPv6&quot;">RFC6275</a>] is not
   affected by this specification.  Route optimization is possible only
   between an IPv6 MN and CN.  UDP encapsulation of signaling and data
   traffic is only between the MN and HA.  The return routability
   signaling messages such as HoTI/HoT and CoTI/CoT [<a href="rfc6275.html" title="&quot;Mobility Support in IPv6&quot;">RFC6275</a>] are
   treated as data packets and encapsulation, when needed, is per the
   description in <a href="#section-6.4">Section 6.4</a> of this specification.  The data packets
   between an MN and CN that have successfully completed the return
   routability test and created the appropriate entries in their binding
   cache are not UDP encapsulated using the packet formats defined in
   this specification but follow the [<a href="rfc6275.html" title="&quot;Mobility Support in IPv6&quot;">RFC6275</a>] specification.

<span class="h2"><a class="selflink" name="section-8" href="#section-8">8</a>.  IANA Considerations</span>

<span class="h3"><a class="selflink" name="section-8.1" href="#section-8.1">8.1</a>.  New Registry: Packet Type</span>

   IANA has created a new registry under the [<a href="rfc6275.html" title="&quot;Mobility Support in IPv6&quot;">RFC6275</a>] Mobile IPv6
   parameters registry for the Packet Type as described in <a href="#section-6.1">Section 6.1</a>.

   Description                       | Value
   ----------------------------------+----------------------------------
   non-encrypted IP packet           | 0
   encrypted IP packet               | 1
   mobility header                   | 8

   Following the allocation policies from [<a href="rfc5226.html" title="&quot;Guidelines for Writing an IANA Considerations Section in RFCs&quot;">RFC5226</a>], new values for the
   Packet Type AVP MUST be assigned based on the "RFC Required" policy.

<span class="h3"><a class="selflink" name="section-8.2" href="#section-8.2">8.2</a>.  Status Codes</span>

   A new Status Code (to be used in BA messages) is reserved for the
   cases where the HA wants to indicate to the MN that it needs to
   re-establish the SA information with the HAC.  The following value is
   reserved in the [<a href="rfc6275.html" title="&quot;Mobility Support in IPv6&quot;">RFC6275</a>] Status Codes registry:

       REINIT_SA_WITH_HAC       176

<span class="h3"><a class="selflink" name="section-8.3" href="#section-8.3">8.3</a>.  Port Numbers</span>

   A new port number (mipv6tls) for UDP packets is reserved from the
   existing PORT NUMBERS registry.

       mipv6tls 7872






<span class="grey">Korhonen, et al.              Experimental                     [Page 29]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-30" id="page-30" href="#page-30" class="invisible"> </a>
<span class="grey"><a href="rfc6618.html">RFC 6618</a>           TLS-Based MIPv6 Security Framework           May 2012</span>


<span class="h2"><a class="selflink" name="section-9" href="#section-9">9</a>.  Security Considerations</span>

   This document describes and uses a number of building blocks that
   introduce security mechanisms and need to interwork in a secure
   manner.

   The following building blocks are considered from a security point of
   view:

   1.  Discovery of the HAC

   2.  Authentication and MN-HA SA establishment executed between the MN
       and the HAC (PSK- or EAP-based) through a TLS tunnel

   3.  Protection of MN-HA communication

   4.  AAA interworking

<span class="h3"><a class="selflink" name="section-9.1" href="#section-9.1">9.1</a>.  Discovery of the HAC</span>

   No dynamic procedure for discovering the HAC by the MN is described
   in this document.  As such, no specific security considerations apply
   to the scope of this document.

<span class="h3"><a class="selflink" name="section-9.2" href="#section-9.2">9.2</a>.  Authentication and Key Exchange Executed between the MN and the</span>
<span class="h3">      HAC</span>

   This document describes a simple authentication and MN-HA SA
   negotiation exchange over TLS.  The TLS procedures remain unchanged;
   however, channel binding is provided.

   Authentication:  Server-side certificate-based authentication MUST be
      performed using TLS version 1.2 [<a href="rfc5246.html" title="&quot;The Transport Layer Security (TLS) Protocol Version 1.2&quot;">RFC5246</a>].  The MN MUST verify the
      HAC's TLS server certificate, using either the subjectAltName
      extension [<a href="rfc5280.html" title="&quot;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile&quot;">RFC5280</a>] dNSName identities as described in [<a href="rfc6125.html" title="&quot;Representation and Verification of Domain-Based Application Service Identity within Internet Public Key Infrastructure Using X.509 (PKIX) Certificates in the Context of Transport Layer Security (TLS)&quot;">RFC6125</a>]
      or subjectAltName iPAddress identities.  In case of iPAddress
      identities, the MN MUST check the IP address of the TLS connection
      against these iPAddress identities and SHOULD reject the
      connection if none of the iPAddress identities match the
      connection.  In case of dNSName identities, the rules and
      guidelines defined in [<a href="rfc6125.html" title="&quot;Representation and Verification of Domain-Based Application Service Identity within Internet Public Key Infrastructure Using X.509 (PKIX) Certificates in the Context of Transport Layer Security (TLS)&quot;">RFC6125</a>] apply here, with the following
      considerations:

      *  Support for DNS-ID identifier type (the dNSName identity in the
         subjectAltName extension) is REQUIRED in the HAC and the MN TLS
         implementations.





<span class="grey">Korhonen, et al.              Experimental                     [Page 30]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-31" id="page-31" href="#page-31" class="invisible"> </a>
<span class="grey"><a href="rfc6618.html">RFC 6618</a>           TLS-Based MIPv6 Security Framework           May 2012</span>


      *  DNS names in the HAC server certificates MUST NOT contain the
         wildcard character "*".

      *  The CN-ID MUST NOT be used for authentication within the rules
         described in [<a href="rfc6125.html" title="&quot;Representation and Verification of Domain-Based Application Service Identity within Internet Public Key Infrastructure Using X.509 (PKIX) Certificates in the Context of Transport Layer Security (TLS)&quot;">RFC6125</a>].

      *  The MN MUST set its "reference identifier" to the DNS name of
         the HAC.

      The client-side authentication may depend on the specific
      deployment and is therefore not mandated.  Note that TLS-PSK
      [<a href="rfc4279.html" title="&quot;Pre-Shared Key Ciphersuites for Transport Layer Security (TLS)&quot;">RFC4279</a>] cannot be used in conjunction with the methods described
      in Sections <a href="#section-5.8">5.8</a> and <a href="#section-5.9">5.9</a> of this document due to the limitations of
      the channel binding type used.

      Through the protected TLS tunnel, an additional authentication
      exchange is performed that provides client-side or mutual
      authentication and exchanges SA parameters and optional
      configuration data to be used in the subsequent protection of
      MN-HA communication.  The additional authentication exchange can
      be either PSK-based (<a href="#section-5.8">Section 5.8</a>) or EAP-based (<a href="#section-5.9">Section 5.9</a>).
      Both exchanges are always performed within the protected TLS
      tunnel and MUST NOT be used as standalone protocols.

      The simple PSK-based authentication exchange provides mutual
      authentication and follows the GPSK exchange used by EAP-GPSK
      [<a href="rfc5433.html" title="&quot;Extensible Authentication Protocol - Generalized Pre-Shared Key (EAP-GPSK) Method&quot;">RFC5433</a>] and has similar properties, although some features of
      GPSK like the exchange of a protected container are not supported.

      The EAP-based authentication exchange simply defines message
      containers to allow carrying the EAP packets between the MN and
      the HAC.  In principle, any EAP method can be used.  However, it
      is strongly recommended to use only EAP methods that provide
      mutual authentication and that derive keys including an MSK in
      compliance with [<a href="rfc3748.html" title="&quot;Extensible Authentication Protocol (EAP)&quot;">RFC3748</a>].

      Both exchanges use channel binding with the TLS tunnel.  The
      channel binding type 'TLS-server-endpoint' per [<a href="rfc5929.html" title="&quot;Channel Bindings for TLS&quot;">RFC5929</a>] MUST be
      used.

   Dictionary Attacks:  All messages of the authentication exchanges
      specified in this document are protected by TLS.  However, any
      implementation SHOULD assume that the properties of the
      authentication exchange are the same as for GPSK [<a href="rfc5433.html" title="&quot;Extensible Authentication Protocol - Generalized Pre-Shared Key (EAP-GPSK) Method&quot;">RFC5433</a>], in
      case the PSK-based method per <a href="#section-5.8">Section 5.8</a> is used, and are the
      same as those of the underlying EAP method, in case the EAP-based
      exchange per <a href="#section-5.9">Section 5.9</a> is used.




<span class="grey">Korhonen, et al.              Experimental                     [Page 31]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-32" id="page-32" href="#page-32" class="invisible"> </a>
<span class="grey"><a href="rfc6618.html">RFC 6618</a>           TLS-Based MIPv6 Security Framework           May 2012</span>


   Replay Protection:  The underlying TLS protection provides protection
      against replays.

   Key Derivation and Key Strength:  For TLS, the TLS-specific
      considerations apply unchanged.  For the authentication exchanges
      defined in this document, no key derivation step is performed as
      the MN-HA keys are generated by the HAC and are distributed to the
      MN through the secure TLS connection.

   Key Control:  No joint key control for MN-HA keys is provided by this
      version of the specification.

   Lifetime:  The TLS-protected authentication exchange between the MN
      and the HAC is only to bootstrap keys and other parameters for
      usage with MN-HA security.  The SAs that contain the keys have an
      associated lifetime.  The usage of Transport Layer Security (TLS)
      Session Resumption without Server-Side State, described in
      [<a href="rfc5077.html" title="&quot;Transport Layer Security (TLS) Session Resumption without Server-Side State&quot;">RFC5077</a>], provides the ability for the MN to minimize the latency
      of future exchanges towards the HA without having to keep state at
      the HA itself.

   Denial-of-Service (DoS) Resistance:  The level of resistance against
      DoS attacks SHOULD be considered the same as for common TLS
      operation, as TLS is used unchanged.  For the PSK-based
      authentication exchange, no additional factors are known.  For the
      EAP-based authentication exchange, any considerations regarding
      DoS resistance specific to the chosen EAP method are expected to
      be applicable and need to be taken into account.

   Session Independence:  Each individual TLS protocol run is
      independent from any previous exchange based on the security
      properties of the TLS handshake protocol.  However, several PSK-
      or EAP-based authentication exchanges can be performed across the
      same TLS connection.

   Fragmentation:  TLS runs on top of TCP and no fragmentation-specific
      considerations apply to the MN-HAC authentication exchanges.

   Channel Binding:  Both the PSK and the EAP-based exchanges use
      channel binding with the TLS tunnel.  The channel binding type
      'TLS-server-endpoint' per [<a href="rfc5929.html" title="&quot;Channel Bindings for TLS&quot;">RFC5929</a>] MUST be used.

   Fast Reconnect:  This protocol provides session resumption as part of
      TLS and optionally the support for [<a href="rfc5077.html" title="&quot;Transport Layer Security (TLS) Session Resumption without Server-Side State&quot;">RFC5077</a>].  No fast reconnect
      is supported for the PSK-based authentication exchange.  For the
      EAP-based authentication exchange, availability of fast reconnect
      depends on the EAP method used.




<span class="grey">Korhonen, et al.              Experimental                     [Page 32]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-33" id="page-33" href="#page-33" class="invisible"> </a>
<span class="grey"><a href="rfc6618.html">RFC 6618</a>           TLS-Based MIPv6 Security Framework           May 2012</span>


   Identity Protection:  Based on the security properties of the TLS
      tunnel, passive user identity protection is provided.  An attacker
      acting as man-in-the-middle in the TLS connection would be able to
      observe the MN identity value sent in MHAuth-Init messages.

   Protected Ciphersuite Negotiation:  This protocol provides
      ciphersuite negotiation based on TLS.

   Confidentiality:  Confidentiality protection of payloads exchanged
      between the MN and the HAC are protected with the TLS Record
      Layer.  TLS ciphersuites with confidentiality and integrity
      protection MUST be negotiated and used in order to exchange
      security sensitive material inside the TLS connection.

   Cryptographic Binding:  No cryptographic bindings are provided by
      this protocol specified in this document.

   Perfect Forward Secrecy:  Perfect forward secrecy is provided with
      appropriate TLS ciphersuites.

   Key confirmation:  Key confirmation of the keys established with TLS
      is provided by the TLS Record Layer when the keys are used to
      protect the subsequent TLS exchange.

<span class="h3"><a class="selflink" name="section-9.3" href="#section-9.3">9.3</a>.  Protection of MN and HA Communication</span>

   Authentication:  Data origin authentication is provided for the
      communication between the MN and the HA.  The chosen level of
      security of this authentication depends on the selected
      ciphersuite.  Entity authentication is offered by the MN to HAC
      protocol exchange.

   Dictionary Attacks:  The concept of dictionary attacks is not
      applicable to the MN-HA communication as the keying material used
      for this communication is randomly created by the HAC and its
      length depends on the chosen cryptographic algorithms.

   Replay Protection:  Replay protection for the communication between
      the MN and the HA is provided based on sequence numbers and
      follows the design of IPsec ESP.

   Key Derivation and Key Strength:  The strength of the keying material
      established for the communication between the MN and the HA is
      selected based on the negotiated ciphersuite (based on the MN-HAC
      exchange) and the key created by the HAC.  The randomness
      requirements for security described in [<a href="rfc4086.html" title="&quot;Randomness Requirements for Security&quot;">RFC4086</a>] are applicable to
      the key generation by the HAC.




<span class="grey">Korhonen, et al.              Experimental                     [Page 33]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-34" id="page-34" href="#page-34" class="invisible"> </a>
<span class="grey"><a href="rfc6618.html">RFC 6618</a>           TLS-Based MIPv6 Security Framework           May 2012</span>


   Key Control:  The keying material established during the MN-HAC
      protocol exchange for subsequent protection of the MN-HA
      communication is created by the HA and therefore no joint key
      control is provided for it.

   Key Naming:  For the MN-HA communication, the security associations
      are indexed with the help of the SPI and additionally based on the
      direction (inbound communication or outbound communication).

   Lifetime:  The lifetime of the MN-HA security associations is based
      on the value in the mip6-sa-validity-end header field exchanged
      during the MN-HAC exchange.  The HAC controls the SA lifetime.

   DoS Resistance:  For the communication between the MN and the HA,
      there are no heavy cryptographic operations (such as public key
      computations).  As such, there are no DoS concerns.

   Session Independence:  Sessions are independent from each other when
      new keys are created via the MN-HAC protocol.  A new MN-HAC
      protocol run produces fresh and unique keying material for
      protection of the MN-HA communication.

   Fragmentation:  There is no additional fragmentation support provided
      beyond what is offered by the network layer.

   Channel Binding:  Channel binding is not applicable to the MN-HA
      communication.

   Fast Reconnect:  The concept of fast reconnect is not applicable to
      the MN-HA communication.

   Identity Protection:  User identities SHOULD NOT be exchanged between
      the MN and the HA.  In the case where binding management messages
      contain the user identity, the messages SHOULD be confidentiality
      protected.

   Protected Ciphersuite Negotiation:  The MN-HAC protocol provides
      protected ciphersuite negotiation through a secure TLS connection.

   Confidentiality:  Confidentiality protection of payloads exchanged
      between the MN and the HAC (for Mobile IPv6 signaling and
      optionally for the data traffic) is provided utilizing algorithms
      negotiated during the MN-HAC exchange.

   Cryptographic Binding:  No cryptographic bindings are provided by
      this protocol specified in this document.





<span class="grey">Korhonen, et al.              Experimental                     [Page 34]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-35" id="page-35" href="#page-35" class="invisible"> </a>
<span class="grey"><a href="rfc6618.html">RFC 6618</a>           TLS-Based MIPv6 Security Framework           May 2012</span>


   Perfect Forward Secrecy:  Perfect forward secrecy is provided when
      the MN bootstraps new keying material with the help of the MN-HAC
      protocol (assuming that a proper TLS ciphersuite is used).

   Key Confirmation:  Key confirmation of the MN-HA keying material
      conveyed from the HAC to the MN is provided when the first packets
      are exchanged between the MN and the HA (in both directions as two
      different keys are used).

<span class="h3"><a class="selflink" name="section-9.4" href="#section-9.4">9.4</a>.  AAA Interworking</span>

   The AAA backend infrastructure interworking is not defined in this
   document and is therefore out of scope.

<span class="h2"><a class="selflink" name="section-10" href="#section-10">10</a>.  Acknowledgements</span>

   The authors would like to thank Pasi Eronen, Domagoj Premec, Julien
   Laganier, Jari Arkko, Stephen Farrell, Peter Saint-Andre and
   Christian Bauer for their comments.

<span class="h2"><a class="selflink" name="section-11" href="#section-11">11</a>.  References</span>

<span class="h3"><a class="selflink" name="section-11.1" href="#section-11.1">11.1</a>.  Normative References</span>

   [<a name="ref-RFC2119" id="ref-RFC2119">RFC2119</a>]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="http://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.

   [<a name="ref-RFC2404" id="ref-RFC2404">RFC2404</a>]  Madson, C. and R. Glenn, "The Use of HMAC-SHA-1-96 within
              ESP and AH", <a href="rfc2404.html">RFC 2404</a>, November 1998.

   [<a name="ref-RFC2410" id="ref-RFC2410">RFC2410</a>]  Glenn, R. and S. Kent, "The NULL Encryption Algorithm and
              Its Use With IPsec", <a href="rfc2410.html">RFC 2410</a>, November 1998.

   [<a name="ref-RFC2451" id="ref-RFC2451">RFC2451</a>]  Pereira, R. and R. Adams, "The ESP CBC-Mode Cipher
              Algorithms", <a href="rfc2451.html">RFC 2451</a>, November 1998.

   [<a name="ref-RFC2616" id="ref-RFC2616">RFC2616</a>]  Fielding, R., Gettys, J., Mogul, J., Frystyk, H.,
              Masinter, L., Leach, P., and T. Berners-Lee, "Hypertext
              Transfer Protocol -- HTTP/1.1", <a href="rfc2616.html">RFC 2616</a>, June 1999.

   [<a name="ref-RFC3566" id="ref-RFC3566">RFC3566</a>]  Frankel, S. and H. Herbert, "The AES-XCBC-MAC-96 Algorithm
              and Its Use With IPsec", <a href="rfc3566.html">RFC 3566</a>, September 2003.

   [<a name="ref-RFC3602" id="ref-RFC3602">RFC3602</a>]  Frankel, S., Glenn, R., and S. Kelly, "The AES-CBC Cipher
              Algorithm and Its Use with IPsec", <a href="rfc3602.html">RFC 3602</a>,
              September 2003.





<span class="grey">Korhonen, et al.              Experimental                     [Page 35]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-36" id="page-36" href="#page-36" class="invisible"> </a>
<span class="grey"><a href="rfc6618.html">RFC 6618</a>           TLS-Based MIPv6 Security Framework           May 2012</span>


   [<a name="ref-RFC4282" id="ref-RFC4282">RFC4282</a>]  Aboba, B., Beadles, M., Arkko, J., and P. Eronen, "The
              Network Access Identifier", <a href="rfc4282.html">RFC 4282</a>, December 2005.

   [<a name="ref-RFC5056" id="ref-RFC5056">RFC5056</a>]  Williams, N., "On the Use of Channel Bindings to Secure
              Channels", <a href="rfc5056.html">RFC 5056</a>, November 2007.

   [<a name="ref-RFC5226" id="ref-RFC5226">RFC5226</a>]  Narten, T. and H. Alvestrand, "Guidelines for Writing an
              IANA Considerations Section in RFCs", <a href="http://tools.ietf.org/html/bcp26">BCP 26</a>, <a href="rfc5226.html">RFC 5226</a>,
              May 2008.

   [<a name="ref-RFC5246" id="ref-RFC5246">RFC5246</a>]  Dierks, T. and E. Rescorla, "The Transport Layer Security
              (TLS) Protocol Version 1.2", <a href="rfc5246.html">RFC 5246</a>, August 2008.

   [<a name="ref-RFC5280" id="ref-RFC5280">RFC5280</a>]  Cooper, D., Santesson, S., Farrell, S., Boeyen, S.,
              Housley, R., and W. Polk, "Internet X.509 Public Key
              Infrastructure Certificate and Certificate Revocation List
              (CRL) Profile", <a href="rfc5280.html">RFC 5280</a>, May 2008.

   [<a name="ref-RFC5929" id="ref-RFC5929">RFC5929</a>]  Altman, J., Williams, N., and L. Zhu, "Channel Bindings
              for TLS", <a href="rfc5929.html">RFC 5929</a>, July 2010.

   [<a name="ref-RFC6275" id="ref-RFC6275">RFC6275</a>]  Perkins, C., Johnson, D., and J. Arkko, "Mobility Support
              in IPv6", <a href="rfc6275.html">RFC 6275</a>, July 2011.

<span class="h3"><a class="selflink" name="section-11.2" href="#section-11.2">11.2</a>.  Informative References</span>

   [<a name="ref-RFC0768" id="ref-RFC0768">RFC0768</a>]  Postel, J., "User Datagram Protocol", STD 6, <a href="rfc768.html">RFC 768</a>,
              August 1980.

   [<a name="ref-RFC3748" id="ref-RFC3748">RFC3748</a>]  Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H.
              Levkowetz, "Extensible Authentication Protocol (EAP)",
              <a href="rfc3748.html">RFC 3748</a>, June 2004.

   [<a name="ref-RFC3776" id="ref-RFC3776">RFC3776</a>]  Arkko, J., Devarapalli, V., and F. Dupont, "Using IPsec to
              Protect Mobile IPv6 Signaling Between Mobile Nodes and
              Home Agents", <a href="rfc3776.html">RFC 3776</a>, June 2004.

   [<a name="ref-RFC4086" id="ref-RFC4086">RFC4086</a>]  Eastlake, D., Schiller, J., and S. Crocker, "Randomness
              Requirements for Security", <a href="http://tools.ietf.org/html/bcp106">BCP 106</a>, <a href="rfc4086.html">RFC 4086</a>, June 2005.

   [<a name="ref-RFC4279" id="ref-RFC4279">RFC4279</a>]  Eronen, P. and H. Tschofenig, "Pre-Shared Key Ciphersuites
              for Transport Layer Security (TLS)", <a href="rfc4279.html">RFC 4279</a>,
              December 2005.

   [<a name="ref-RFC4301" id="ref-RFC4301">RFC4301</a>]  Kent, S. and K. Seo, "Security Architecture for the
              Internet Protocol", <a href="rfc4301.html">RFC 4301</a>, December 2005.





<span class="grey">Korhonen, et al.              Experimental                     [Page 36]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-37" id="page-37" href="#page-37" class="invisible"> </a>
<span class="grey"><a href="rfc6618.html">RFC 6618</a>           TLS-Based MIPv6 Security Framework           May 2012</span>


   [<a name="ref-RFC4303" id="ref-RFC4303">RFC4303</a>]  Kent, S., "IP Encapsulating Security Payload (ESP)",
              <a href="rfc4303.html">RFC 4303</a>, December 2005.

   [<a name="ref-RFC4877" id="ref-RFC4877">RFC4877</a>]  Devarapalli, V. and F. Dupont, "Mobile IPv6 Operation with
              IKEv2 and the Revised IPsec Architecture", <a href="rfc4877.html">RFC 4877</a>,
              April 2007.

   [<a name="ref-RFC5077" id="ref-RFC5077">RFC5077</a>]  Salowey, J., Zhou, H., Eronen, P., and H. Tschofenig,
              "Transport Layer Security (TLS) Session Resumption without
              Server-Side State", <a href="rfc5077.html">RFC 5077</a>, January 2008.

   [<a name="ref-RFC5433" id="ref-RFC5433">RFC5433</a>]  Clancy, T. and H. Tschofenig, "Extensible Authentication
              Protocol - Generalized Pre-Shared Key (EAP-GPSK) Method",
              <a href="rfc5433.html">RFC 5433</a>, February 2009.

   [<a name="ref-RFC5555" id="ref-RFC5555">RFC5555</a>]  Soliman, H., "Mobile IPv6 Support for Dual Stack Hosts and
              Routers", <a href="rfc5555.html">RFC 5555</a>, June 2009.

   [<a name="ref-RFC5944" id="ref-RFC5944">RFC5944</a>]  Perkins, C., "IP Mobility Support for IPv4, Revised",
              <a href="rfc5944.html">RFC 5944</a>, November 2010.

   [<a name="ref-RFC5996" id="ref-RFC5996">RFC5996</a>]  Kaufman, C., Hoffman, P., Nir, Y., and P. Eronen,
              "Internet Key Exchange Protocol Version 2 (IKEv2)",
              <a href="rfc5996.html">RFC 5996</a>, September 2010.

   [<a name="ref-RFC6125" id="ref-RFC6125">RFC6125</a>]  Saint-Andre, P. and J. Hodges, "Representation and
              Verification of Domain-Based Application Service Identity
              within Internet Public Key Infrastructure Using X.509
              (PKIX) Certificates in the Context of Transport Layer
              Security (TLS)", <a href="rfc6125.html">RFC 6125</a>, March 2011.





















<span class="grey">Korhonen, et al.              Experimental                     [Page 37]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-38" id="page-38" href="#page-38" class="invisible"> </a>
<span class="grey"><a href="rfc6618.html">RFC 6618</a>           TLS-Based MIPv6 Security Framework           May 2012</span>


Authors' Addresses

   Jouni Korhonen (editor)
   Nokia Siemens Networks
   Linnoitustie 6
   Espoo  FIN-02600
   Finland

   EMail: jouni.nospam@gmail.com


   Basavaraj Patil
   Nokia
   6021 Connection Drive
   Irving, TX  75039
   USA

   EMail: basavaraj.patil@nokia.com


   Hannes Tschofenig
   Nokia Siemens Networks
   Linnoitustie 6
   Espoo  02600
   Finland

   Phone: +358 (50) 4871445
   EMail: Hannes.Tschofenig@gmx.net


   Dirk Kroeselberg
   Siemens
   Otto-Hahn-Ring 6
   Munich  81739
   Germany

   EMail: dirk.kroeselberg@siemens.com














Korhonen, et al.              Experimental                     [Page 38]

</pre><br />
<span class="noprint"><small><small>Html markup produced by rfcmarkup 1.107, available from
<a href="http://tools.ietf.org/tools/rfcmarkup/">http://tools.ietf.org/tools/rfcmarkup/</a>
</small></small></span>
</body>
<!-- Mirrored from tools.ietf.org/html/rfc6618 by HTTrack Website Copier/3.x [XR&CO'2010], Wed, 19 Mar 2014 18:33:17 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8"><!-- /Added by HTTrack -->
</html>
