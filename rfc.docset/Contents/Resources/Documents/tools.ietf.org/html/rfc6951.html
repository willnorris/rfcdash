<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head profile="http://dublincore.org/documents/2008/08/04/dc-html/">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="robots" content="index,follow" />
    <meta name="creator" content="rfcmarkup version 1.107" />
    <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" />
<meta name="DC.Identifier" content="urn:ietf:rfc:6951" />
<meta name="DC.Description.Abstract" content="This document describes a simple method of encapsulating Stream\nControl Transmission Protocol (SCTP) packets into UDP packets and its\nlimitations. This allows the usage of SCTP in networks with legacy\nNATs that do not support SCTP. It can also be used to implement SCTP\non hosts without directly accessing the IP layer, for example,\nimplementing it as part of the application without requiring special\nprivileges.  Please note that this document only describes the\nfunctionality required within an SCTP stack to add on UDP\nencapsulation, providing only those mechanisms for two end-hosts to\ncommunicate with each other over UDP ports. In particular, it does not\nprovide mechanisms to determine whether UDP encapsulation is being\nused by the peer, nor the mechanisms for determining which remote UDP\nport number can be used. These functions are out of scope for this\ndocument.  This document covers only end-hosts and not tunneling\n(egress or ingress) endpoints." />
<meta name="DC.Creator" content="Tuexen, Michael" />
<meta name="DC.Creator" content="Stewart, Randall" />
<meta name="DC.Date.Issued" content="May, 2013" />
<meta name="DC.Title" content="UDP Encapsulation of Stream Control Transmission Protocol (SCTP) Packets for End-Host to End-Host Communication" />

    <link rel="icon" href="http://tools.ietf.org/images/rfc.png" type="image/png" />
    <link rel="shortcut icon" href="http://tools.ietf.org/images/rfc.png" type="image/png" />
    <title>RFC 6951 - UDP Encapsulation of Stream Control Transmission Protocol (SCTP) Packets for End-Host to End-Host Communication</title>
    
    
    <style type="text/css">
	body {
	    margin: 0px 8px;
            font-size: 1em;
	}
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
   <div style="height: 13px;">
      <div onmouseover="this.style.cursor='pointer';"
         onclick="showElem('legend');"
         onmouseout="hideElem('legend')"
	 style="height: 6px; position: absolute;"
         class="pre noprint docinfo bgblue"
         title="Click for colour legend." >                                                                        </div>
      <div id="legend"
           class="docinfo noprint pre legend"
           style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; "
           onmouseover="showElem('legend');"
           onmouseout="hideElem('legend');">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="http://tools.ietf.org/rfc/rfc6951.txt" title="Plaintext version of this document">txt</a>|<a href="http://tools.ietf.org/pdf/rfc6951" title="PDF version of this document">pdf</a>] [<a href="http://tools.ietf.org/html/draft-ietf-tsvwg-sctp-udp-encaps" title="draft-ietf-tsvwg-sctp-udp-encaps">draft-ietf-tsvwg-...</a>] [<a href="http://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc6951" title="Inline diff (wdiff)">Diff1</a>] [<a href="http://tools.ietf.org/rfcdiff?url2=rfc6951" title="Side-by-side diff">Diff2</a>]                 </span><br />
<span class="pre noprint docinfo">                                                                        </span><br />
<span class="pre noprint docinfo">                                                       PROPOSED STANDARD</span><br />
<span class="pre noprint docinfo">                                                                        </span><br />
<pre>
Internet Engineering Task Force (IETF)                         M. Tuexen
Request for Comments: 6951              Muenster Univ. of Appl. Sciences
Category: Standards Track                                     R. Stewart
ISSN: 2070-1721                                           Adara Networks
                                                                May 2013


UDP Encapsulation of Stream Control Transmission Protocol (SCTP) Packets
                 for End-Host to End-Host Communication

Abstract

   This document describes a simple method of encapsulating Stream
   Control Transmission Protocol (SCTP) packets into UDP packets and its
   limitations.  This allows the usage of SCTP in networks with legacy
   NATs that do not support SCTP.  It can also be used to implement SCTP
   on hosts without directly accessing the IP layer, for example,
   implementing it as part of the application without requiring special
   privileges.

   Please note that this document only describes the functionality
   required within an SCTP stack to add on UDP encapsulation, providing
   only those mechanisms for two end-hosts to communicate with each
   other over UDP ports.  In particular, it does not provide mechanisms
   to determine whether UDP encapsulation is being used by the peer, nor
   the mechanisms for determining which remote UDP port number can be
   used.  These functions are out of scope for this document.

   This document covers only end-hosts and not tunneling (egress or
   ingress) endpoints.

Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in <a href="rfc5741.html#section-2">Section&nbsp;2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc6951">http://www.rfc-editor.org/info/rfc6951</a>.







<span class="grey">Tuexen &amp; Stewart             Standards Track                    [Page 1]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-2" id="page-2" href="#page-2" class="invisible"> </a>
<span class="grey"><a href="rfc6951.html">RFC 6951</a>            UDP Encapsulation of SCTP Packets           May 2013</span>


Copyright Notice

   Copyright (c) 2013 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="http://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in <a href="#section-4">Section 4</a>.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   <a href="#section-1">1</a>.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-3">3</a>
   <a href="#section-2">2</a>.  Conventions . . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-3">3</a>
   <a href="#section-3">3</a>.  Use Cases . . . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-3">3</a>
     <a href="#section-3.1">3.1</a>.  Portable SCTP Implementations . . . . . . . . . . . . . .   <a href="#page-3">3</a>
     <a href="#section-3.2">3.2</a>.  Legacy NAT Traversal  . . . . . . . . . . . . . . . . . .   <a href="#page-4">4</a>
   <a href="#section-4">4</a>.  Unilateral Self-Address Fixing (UNSAF) Considerations . . . .   <a href="#page-4">4</a>
   <a href="#section-5">5</a>.  SCTP over UDP . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-4">4</a>
     <a href="#section-5.1">5.1</a>.  Architectural Considerations  . . . . . . . . . . . . . .   <a href="#page-4">4</a>
     <a href="#section-5.2">5.2</a>.  Packet Format . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-5">5</a>
     <a href="#section-5.3">5.3</a>.  Encapsulation Procedure . . . . . . . . . . . . . . . . .   <a href="#page-6">6</a>
     <a href="#section-5.4">5.4</a>.  Decapsulation Procedure . . . . . . . . . . . . . . . . .   <a href="#page-7">7</a>
     <a href="#section-5.5">5.5</a>.  ICMP Considerations . . . . . . . . . . . . . . . . . . .   <a href="#page-7">7</a>
     <a href="#section-5.6">5.6</a>.  Path MTU Considerations . . . . . . . . . . . . . . . . .   <a href="#page-7">7</a>
     <a href="#section-5.7">5.7</a>.  Handling of Embedded IP Addresses . . . . . . . . . . . .   <a href="#page-8">8</a>
     <a href="#section-5.8">5.8</a>.  Explicit Congestion Notification (ECN) Considerations . .   <a href="#page-8">8</a>
   <a href="#section-6">6</a>.  Socket API Considerations . . . . . . . . . . . . . . . . . .   <a href="#page-8">8</a>
     6.1.  Get or Set the Remote UDP Encapsulation Port Number
           (SCTP_REMOTE_UDP_ENCAPS_PORT) . . . . . . . . . . . . . .   <a href="#page-9">9</a>
   <a href="#section-7">7</a>.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .   <a href="#page-9">9</a>
   <a href="#section-8">8</a>.  Security Considerations . . . . . . . . . . . . . . . . . . .   <a href="#page-9">9</a>
   <a href="#section-9">9</a>.  Acknowledgments . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-10">10</a>
   <a href="#section-10">10</a>. References  . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-10">10</a>
     <a href="#section-10.1">10.1</a>.  Normative References . . . . . . . . . . . . . . . . . .  <a href="#page-10">10</a>
     <a href="#section-10.2">10.2</a>.  Informative References . . . . . . . . . . . . . . . . .  <a href="#page-11">11</a>










<span class="grey">Tuexen &amp; Stewart             Standards Track                    [Page 2]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-3" id="page-3" href="#page-3" class="invisible"> </a>
<span class="grey"><a href="rfc6951.html">RFC 6951</a>            UDP Encapsulation of SCTP Packets           May 2013</span>


<span class="h2"><a class="selflink" name="section-1" href="#section-1">1</a>.  Introduction</span>

   This document describes a simple method of encapsulating SCTP packets
   into UDP packets.  SCTP, as defined in [<a href="rfc4960.html" title="&quot;Stream Control Transmission Protocol&quot;">RFC4960</a>], runs directly over
   IPv4 or IPv6.  There are two main reasons for encapsulating SCTP
   packets:

   o  To allow SCTP traffic to pass through legacy NATs, which do not
      provide native SCTP support as specified in [<a href="#ref-BEHAVE" title="&quot;Stream Control Transmission Protocol (SCTP) Network Address Translation&quot;">BEHAVE</a>] and
      [<a href="#ref-NATSUPP" title="&quot;Stream Control Transmission Protocol (SCTP) Network Address Translation Support&quot;">NATSUPP</a>].

   o  To allow SCTP to be implemented on hosts that do not provide
      direct access to the IP layer.  In particular, applications can
      use their own SCTP implementation if the operating system does not
      provide one.

   SCTP provides the necessary congestion control and reliability
   service that UDP does not perform.

<span class="h2"><a class="selflink" name="section-2" href="#section-2">2</a>.  Conventions</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [<a href="rfc2119.html" title="&quot;Key words for use in RFCs to Indicate Requirement Levels&quot;">RFC2119</a>].

<span class="h2"><a class="selflink" name="section-3" href="#section-3">3</a>.  Use Cases</span>

   This section discusses two important use cases for encapsulating SCTP
   into UDP.

<span class="h3"><a class="selflink" name="section-3.1" href="#section-3.1">3.1</a>.  Portable SCTP Implementations</span>

   Some operating systems support SCTP natively.  For other operating
   systems, implementations are available but require special privileges
   to install and/or use them.  In some cases, a kernel implementation
   might not be available at all.  When providing an SCTP implementation
   as part of a user process, most operating systems require special
   privileges to access the IP layer directly.

   Using UDP encapsulation makes it possible to provide an SCTP
   implementation as part of a user process that does not require any
   special privileges.

   A crucial point for implementing SCTP in user space is that the
   source address of outgoing packets needs to be controlled.  This is
   not an issue if the SCTP stack can use all addresses configured at





<span class="grey">Tuexen &amp; Stewart             Standards Track                    [Page 3]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-4" id="page-4" href="#page-4" class="invisible"> </a>
<span class="grey"><a href="rfc6951.html">RFC 6951</a>            UDP Encapsulation of SCTP Packets           May 2013</span>


   the IP layer as source addresses.  However, it is an issue when also
   using the address management required for NAT traversal, described in
   <a href="#section-5.7">Section 5.7</a>.

<span class="h3"><a class="selflink" name="section-3.2" href="#section-3.2">3.2</a>.  Legacy NAT Traversal</span>

   Using UDP encapsulation allows SCTP communication when traversing
   legacy NATs (i.e, those NATs not supporting SCTP as described in
   [<a href="#ref-BEHAVE" title="&quot;Stream Control Transmission Protocol (SCTP) Network Address Translation&quot;">BEHAVE</a>] and [<a href="#ref-NATSUPP" title="&quot;Stream Control Transmission Protocol (SCTP) Network Address Translation Support&quot;">NATSUPP</a>]).  For single-homed associations, IP addresses
   MUST NOT be listed in the INIT and INIT-ACK chunks.  To use multiple
   addresses, the dynamic address reconfiguration extension described in
   [<a href="rfc5061.html" title="&quot;Stream Control Transmission Protocol (SCTP) Dynamic Address Reconfiguration&quot;">RFC5061</a>] MUST be used only with wildcard addresses in the ASCONF
   chunks (Address Configuration Change Chunks) in combination with
   [<a href="rfc4895.html" title="&quot;Authenticated Chunks for the Stream Control Transmission Protocol (SCTP)&quot;">RFC4895</a>].

   For multihomed SCTP associations, the address management as described
   in <a href="#section-5.7">Section 5.7</a> MUST be performed.

   SCTP sends periodic HEARTBEAT chunks on all idle paths.  These can
   keep the NAT state alive.

<span class="h2"><a class="selflink" name="section-4" href="#section-4">4</a>.  Unilateral Self-Address Fixing (UNSAF) Considerations</span>

   As [<a href="rfc3424.html" title="&quot;IAB Considerations for UNilateral Self- Address Fixing (UNSAF) Across Network Address Translation&quot;">RFC3424</a>] requires a limited scope, this document only covers SCTP
   endpoints dealing with legacy constraints as described in <a href="#section-3">Section 3</a>.
   It doesn't cover generic tunneling endpoints.

   Obviously, the exit strategy is to use hosts supporting SCTP natively
   and middleboxes supporting SCTP as specified in [<a href="#ref-BEHAVE" title="&quot;Stream Control Transmission Protocol (SCTP) Network Address Translation&quot;">BEHAVE</a>] and
   [<a href="#ref-NATSUPP" title="&quot;Stream Control Transmission Protocol (SCTP) Network Address Translation Support&quot;">NATSUPP</a>].

<span class="h2"><a class="selflink" name="section-5" href="#section-5">5</a>.  SCTP over UDP</span>

<span class="h3"><a class="selflink" name="section-5.1" href="#section-5.1">5.1</a>.  Architectural Considerations</span>

   UDP-encapsulated SCTP is normally communicated between SCTP stacks
   using the IANA-assigned UDP port number 9899 (sctp-tunneling) on both
   ends.  There are circumstances where other ports may be used on
   either end: As stated earlier, implementations in the application
   space might be required to use ports other than the registered port.
   Since NAT boxes might change UDP port numbers, the receiver might
   observe other UDP port numbers than were used by the sender.
   Discovery of alternate ports is outside of the scope of this
   document, but this section describes considerations for SCTP stack
   design in light of their potential use.

   Each SCTP stack uses a single local UDP encapsulation port number as
   the destination port for all its incoming SCTP packets.  While the



<span class="grey">Tuexen &amp; Stewart             Standards Track                    [Page 4]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-5" id="page-5" href="#page-5" class="invisible"> </a>
<span class="grey"><a href="rfc6951.html">RFC 6951</a>            UDP Encapsulation of SCTP Packets           May 2013</span>


   uniqueness of the local UDP encapsulation port number is not
   necessarily required for the protocol, this greatly simplifies
   implementation design, since different ports for each address would
   require a sender implementation to choose the appropriate port while
   doing source address selection.  Using a single local UDP
   encapsulation port number per host is not possible if the SCTP stack
   is implemented as part of each application, there are multiple
   applications, and some of the applications want to use the same IP
   address.

   An SCTP implementation supporting UDP encapsulation MUST maintain a
   remote UDP encapsulation port number per destination address for each
   SCTP association.  Again, because the remote stack may be using ports
   other than the well-known port, each port may be different from each
   stack.  However, because of remapping of ports by NATs, the remote
   ports associated with different remote IP addresses may not be
   identical, even if they are associated with the same stack.

   Implementation note: Because the well-known port might not be used,
   implementations need to allow other port numbers to be specified as a
   local or remote UDP encapsulation port number through APIs.

<span class="h3"><a class="selflink" name="section-5.2" href="#section-5.2">5.2</a>.  Packet Format</span>

   To encapsulate an SCTP packet, a UDP header as defined in [<a href="http://tools.ietf.org/html/rfc0768" title="&quot;User Datagram Protocol&quot;">RFC0768</a>]
   is inserted between the IP header as defined in [<a href="http://tools.ietf.org/html/rfc0791" title="&quot;Internet Protocol&quot;">RFC0791</a>] and the
   SCTP common header as defined in [<a href="rfc4960.html" title="&quot;Stream Control Transmission Protocol&quot;">RFC4960</a>].

   Figure 1 shows the packet format of an encapsulated SCTP packet when
   IPv4 is used.

       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                         IPv4 Header                           |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                         UDP Header                            |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                      SCTP Common Header                       |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                        SCTP Chunk #1                          |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                           ...                                 |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                        SCTP Chunk #n                          |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                     Figure 1: An SCTP/UDP/IPv4 Packet



<span class="grey">Tuexen &amp; Stewart             Standards Track                    [Page 5]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-6" id="page-6" href="#page-6" class="invisible"> </a>
<span class="grey"><a href="rfc6951.html">RFC 6951</a>            UDP Encapsulation of SCTP Packets           May 2013</span>


   The packet format for an encapsulated SCTP packet when using IPv6 as
   defined in [<a href="rfc2460.html" title="&quot;Internet Protocol, Version 6 (IPv6) Specification&quot;">RFC2460</a>] is shown in Figure 2.  Please note that the
   number m of IPv6 extension headers can be 0.

       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                      IPv6 Base Header                         |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                    IPv6 Extension Header #1                   |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                           ...                                 |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                    IPv6 Extension Header #m                   |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                         UDP Header                            |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                      SCTP Common Header                       |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                        SCTP Chunk #1                          |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                           ...                                 |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                        SCTP Chunk #n                          |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                     Figure 2: An SCTP/UDP/IPv6 Packet

<span class="h3"><a class="selflink" name="section-5.3" href="#section-5.3">5.3</a>.  Encapsulation Procedure</span>

   Within the UDP header, the source port MUST be the local UDP
   encapsulation port number of the SCTP stack, and the destination port
   MUST be the remote UDP encapsulation port number maintained for the
   association and the destination address to which the packet is sent
   (see <a href="#section-5.1">Section 5.1</a>).

   Because the SCTP packet is the UDP payload, the length of the UDP
   packet MUST be the length of the SCTP packet plus the size of the UDP
   header.

   The SCTP checksum MUST be computed for IPv4 and IPv6, and the UDP
   checksum SHOULD be computed for IPv4 and IPv6.  (See [<a href="http://tools.ietf.org/html/rfc0768" title="&quot;User Datagram Protocol&quot;">RFC0768</a>]
   regarding IPv4; see [<a href="rfc2460.html" title="&quot;Internet Protocol, Version 6 (IPv6) Specification&quot;">RFC2460</a>] and [<a href="rfc6936.html" title="&quot;Applicability Statement for the Use of IPv6 UDP Datagrams with Zero Checksums&quot;">RFC6936</a>] regarding IPv6.)
   Although UDP with a zero checksum over IPv6 is allowed under certain
   constraints [<a href="rfc6936.html" title="&quot;Applicability Statement for the Use of IPv6 UDP Datagrams with Zero Checksums&quot;">RFC6936</a>], this document does not specify mechanisms for
   this mode.  Deployed support may be limited; also, at the time of
   writing, the use of a zero UDP checksum would be counter to the goal
   of legacy NAT traversal.



<span class="grey">Tuexen &amp; Stewart             Standards Track                    [Page 6]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-7" id="page-7" href="#page-7" class="invisible"> </a>
<span class="grey"><a href="rfc6951.html">RFC 6951</a>            UDP Encapsulation of SCTP Packets           May 2013</span>


<span class="h3"><a class="selflink" name="section-5.4" href="#section-5.4">5.4</a>.  Decapsulation Procedure</span>

   When an encapsulated packet is received, the UDP header is removed.
   Then, the generic lookup is performed, as done by an SCTP stack
   whenever a packet is received, to find the association for the
   received SCTP packet.  After finding the SCTP association (which
   includes checking the verification tag), the UDP source port MUST be
   stored as the encapsulation port for the destination address the SCTP
   packet is received from (see <a href="#section-5.1">Section 5.1</a>).

   When a non-encapsulated SCTP packet is received by the SCTP stack,
   the encapsulation of outgoing packets belonging to the same
   association and the corresponding destination address MUST be
   disabled.

<span class="h3"><a class="selflink" name="section-5.5" href="#section-5.5">5.5</a>.  ICMP Considerations</span>

   When receiving ICMP or ICMPv6 response packets, there might not be
   enough bytes in the payload to identify the SCTP association that the
   SCTP packet triggering the ICMP or ICMPv6 packet belongs to.  If a
   received ICMP or ICMPv6 packet cannot be related to a specific SCTP
   association or the verification tag cannot be verified, it MUST be
   discarded silently.  In particular, this means that the SCTP stack
   MUST NOT rely on receiving ICMP or ICMPv6 messages.  Implementation
   constraints could prevent processing received ICMP or ICMPv6
   messages.

   If received ICMP or ICMPv6 messages are processed, the following
   mapping SHOULD apply:

   1.  ICMP messages with type 'Destination Unreachable' and code 'Port
       Unreachable' SHOULD be treated as ICMP messages with type
       'Destination Unreachable' and code 'Protocol Unreachable'.  See
       [<a href="http://tools.ietf.org/html/rfc0792" title="&quot;Internet Control Message Protocol&quot;">RFC0792</a>] for more details.

   2.  ICMPv6 messages with type 'Destination Unreachable' and code
       'Port Unreachable' SHOULD be treated as ICMPv6 messages with type
       'Parameter Problem' and code 'unrecognized Next Header type
       encountered'.  See [<a href="rfc4443.html" title="&quot;Internet Control Message Protocol (ICMPv6) for the Internet Protocol Version 6 (IPv6) Specification&quot;">RFC4443</a>] for more details.

<span class="h3"><a class="selflink" name="section-5.6" href="#section-5.6">5.6</a>.  Path MTU Considerations</span>

   If an SCTP endpoint starts to encapsulate the packets of a path, it
   MUST decrease the Path MTU of that path by the size of the UDP
   header.  If it stops encapsulating them, the Path MTU SHOULD be
   increased by the size of the UDP header.





<span class="grey">Tuexen &amp; Stewart             Standards Track                    [Page 7]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-8" id="page-8" href="#page-8" class="invisible"> </a>
<span class="grey"><a href="rfc6951.html">RFC 6951</a>            UDP Encapsulation of SCTP Packets           May 2013</span>


   When performing Path MTU discovery as described in [<a href="rfc4820.html" title="&quot;Padding Chunk and Parameter for the Stream Control Transmission Protocol (SCTP)&quot;">RFC4820</a>] and
   [<a href="rfc4821.html" title="&quot;Packetization Layer Path MTU Discovery&quot;">RFC4821</a>], it MUST be taken into account that one cannot rely on the
   feedback provided by ICMP or ICMPv6 due to the limitation laid out in
   <a href="#section-5.5">Section 5.5</a>.

   If the implementation does not allow control of the Don't Fragment
   (DF) bit contained in the IPv4 header, then Path MTU discovery can't
   be used.  In this case, an implementation-specific value should be
   used instead.

<span class="h3"><a class="selflink" name="section-5.7" href="#section-5.7">5.7</a>.  Handling of Embedded IP Addresses</span>

   When using UDP encapsulation for legacy NAT traversal, IP addresses
   that might require translation MUST NOT be put into any SCTP packet.

   This means that a multihomed SCTP association is set up initially as
   a single-homed one, and the protocol extension [<a href="rfc5061.html" title="&quot;Stream Control Transmission Protocol (SCTP) Dynamic Address Reconfiguration&quot;">RFC5061</a>] in
   combination with [<a href="rfc4895.html" title="&quot;Authenticated Chunks for the Stream Control Transmission Protocol (SCTP)&quot;">RFC4895</a>] is used to add the other addresses.  Only
   wildcard addresses are put into the SCTP packet.

   When addresses are changed during the lifetime of an association, the
   protocol extension [<a href="rfc5061.html" title="&quot;Stream Control Transmission Protocol (SCTP) Dynamic Address Reconfiguration&quot;">RFC5061</a>] MUST be used with wildcard addresses
   only.  If an SCTP endpoint receives an ABORT with the T-bit set, it
   MAY use this as an indication that the addresses seen by the peer
   might have changed.

<span class="h3"><a class="selflink" name="section-5.8" href="#section-5.8">5.8</a>.  Explicit Congestion Notification (ECN) Considerations</span>

   If the implementation supports the sending and receiving of the ECN
   bits for the IP protocols being used by an SCTP association, the ECN
   bits MUST NOT be changed during sending and receiving.

<span class="h2"><a class="selflink" name="section-6" href="#section-6">6</a>.  Socket API Considerations</span>

   This section describes how the socket API defined in [<a href="rfc6458.html" title="&quot;Sockets API Extensions for the Stream Control Transmission Protocol (SCTP)&quot;">RFC6458</a>] needs
   to be extended to provide a way for the application to control the
   UDP encapsulation.

   Please note that this section is informational only.

   A socket API implementation based on [<a href="rfc6458.html" title="&quot;Sockets API Extensions for the Stream Control Transmission Protocol (SCTP)&quot;">RFC6458</a>] is extended by
   supporting one new read/write socket option.









<span class="grey">Tuexen &amp; Stewart             Standards Track                    [Page 8]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-9" id="page-9" href="#page-9" class="invisible"> </a>
<span class="grey"><a href="rfc6951.html">RFC 6951</a>            UDP Encapsulation of SCTP Packets           May 2013</span>


<span class="h3"><a class="selflink" name="section-6.1" href="#section-6.1">6.1</a>.  Get or Set the Remote UDP Encapsulation Port Number</span>
      (SCTP_REMOTE_UDP_ENCAPS_PORT)

   This socket option can be used to set and retrieve the UDP
   encapsulation port number.  This allows an endpoint to encapsulate
   initial packets.

   struct sctp_udpencaps {
     sctp_assoc_t sue_assoc_id;
     struct sockaddr_storage sue_address;
     uint16_t sue_port;
   };

   sue_assoc_id:  This parameter is ignored for one-to-one style
      sockets.  For one-to-many style sockets, the application may fill
      in an association identifier or SCTP_FUTURE_ASSOC for this query.
      It is an error to use SCTP_{CURRENT|ALL}_ASSOC in sue_assoc_id.

   sue_address:  This specifies which address is of interest.  If a
      wildcard address is provided, it applies only to future paths.

   sue_port:  The UDP port number in network byte order; used as the
      destination port number for UDP encapsulation.  Providing a value
      of 0 disables UDP encapsulation.

<span class="h2"><a class="selflink" name="section-7" href="#section-7">7</a>.  IANA Considerations</span>

   This document refers to the already assigned UDP port 9899 (sctp-
   tunneling).  IANA has updated this assignment to refer to this
   document.  As per [<a href="rfc6335.html" title="&quot;Internet Assigned Numbers Authority (IANA) Procedures for the Management of the Service Name and Transport Protocol Port Number Registry&quot;">RFC6335</a>], the Assignee is [IESG] and the Contact
   is [IETF_Chair].

   Please note that the TCP port 9899 (sctp-tunneling) assignment is not
   needed anymore, and IANA has removed this TCP port number assignment
   and marked TCP port 9899 as "Reserved".

<span class="h2"><a class="selflink" name="section-8" href="#section-8">8</a>.  Security Considerations</span>

   Encapsulating SCTP into UDP does not add any additional security
   considerations to the ones given in [<a href="rfc4960.html" title="&quot;Stream Control Transmission Protocol&quot;">RFC4960</a>] and [<a href="rfc5061.html" title="&quot;Stream Control Transmission Protocol (SCTP) Dynamic Address Reconfiguration&quot;">RFC5061</a>].

   Firewalls inspecting SCTP packets must also be aware of the
   encapsulation and apply corresponding rules to the encapsulated
   packets.

   An attacker might send a malicious UDP packet towards an SCTP
   endpoint to change the encapsulation port for a single remote address
   of a particular SCTP association.  However, as specified in



<span class="grey">Tuexen &amp; Stewart             Standards Track                    [Page 9]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-10" id="page-10" href="#page-10" class="invisible"> </a>
<span class="grey"><a href="rfc6951.html">RFC 6951</a>            UDP Encapsulation of SCTP Packets           May 2013</span>


   <a href="#section-5.4">Section 5.4</a>, this requires the usage of one of the two negotiated
   verification tags.  This protects against blind attackers the same
   way as described in [<a href="rfc4960.html" title="&quot;Stream Control Transmission Protocol&quot;">RFC4960</a>] for SCTP over IPv4 or IPv6.  Non-blind
   attackers can affect SCTP association using the UDP encapsulation
   described in this document in the same way as SCTP associations not
   using the UDP encapsulation of SCTP described here.

<span class="h2"><a class="selflink" name="section-9" href="#section-9">9</a>.  Acknowledgments</span>

   The authors wish to thank Stewart Bryant, Dave Crocker, Gorry
   Fairhurst, Tero Kivinen, Barry Leiba, Pete Resnick, Martin
   Stiemerling, Irene Ruengeler, and Dan Wing for their invaluable
   comments.

<span class="h2"><a class="selflink" name="section-10" href="#section-10">10</a>.  References</span>

<span class="h3"><a class="selflink" name="section-10.1" href="#section-10.1">10.1</a>.  Normative References</span>

   [<a name="ref-RFC0768" id="ref-RFC0768">RFC0768</a>]  Postel, J., "User Datagram Protocol", STD 6, <a href="rfc768.html">RFC 768</a>,
              August 1980.

   [<a name="ref-RFC0791" id="ref-RFC0791">RFC0791</a>]  Postel, J., "Internet Protocol", STD 5, <a href="rfc791.html">RFC 791</a>, September
              1981.

   [<a name="ref-RFC0792" id="ref-RFC0792">RFC0792</a>]  Postel, J., "Internet Control Message Protocol", STD 5,
              <a href="rfc792.html">RFC 792</a>, September 1981.

   [<a name="ref-RFC2119" id="ref-RFC2119">RFC2119</a>]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="http://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.

   [<a name="ref-RFC2460" id="ref-RFC2460">RFC2460</a>]  Deering, S.E. and R.M. Hinden, "Internet Protocol, Version
              6 (IPv6) Specification", <a href="rfc2460.html">RFC 2460</a>, December 1998.

   [<a name="ref-RFC4443" id="ref-RFC4443">RFC4443</a>]  Conta, A., Deering, S., and M. Gupta, "Internet Control
              Message Protocol (ICMPv6) for the Internet Protocol
              Version 6 (IPv6) Specification", <a href="rfc4443.html">RFC 4443</a>, March 2006.

   [<a name="ref-RFC4820" id="ref-RFC4820">RFC4820</a>]  Tuexen, M., Stewart, R., and P. Lei, "Padding Chunk and
              Parameter for the Stream Control Transmission Protocol
              (SCTP)", <a href="rfc4820.html">RFC 4820</a>, March 2007.

   [<a name="ref-RFC4821" id="ref-RFC4821">RFC4821</a>]  Mathis, M. and J. Heffner, "Packetization Layer Path MTU
              Discovery", <a href="rfc4821.html">RFC 4821</a>, March 2007.

   [<a name="ref-RFC4895" id="ref-RFC4895">RFC4895</a>]  Tuexen, M., Stewart, R., Lei, P., and E. Rescorla,
              "Authenticated Chunks for the Stream Control Transmission
              Protocol (SCTP)", <a href="rfc4895.html">RFC 4895</a>, August 2007.




<span class="grey">Tuexen &amp; Stewart             Standards Track                   [Page 10]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-11" id="page-11" href="#page-11" class="invisible"> </a>
<span class="grey"><a href="rfc6951.html">RFC 6951</a>            UDP Encapsulation of SCTP Packets           May 2013</span>


   [<a name="ref-RFC4960" id="ref-RFC4960">RFC4960</a>]  Stewart, R., "Stream Control Transmission Protocol", <a href="rfc4960.html">RFC</a>
              <a href="rfc4960.html">4960</a>, September 2007.

   [<a name="ref-RFC5061" id="ref-RFC5061">RFC5061</a>]  Stewart, R., Xie, Q., Tuexen, M., Maruyama, S., and M.
              Kozuka, "Stream Control Transmission Protocol (SCTP)
              Dynamic Address Reconfiguration", <a href="rfc5061.html">RFC 5061</a>, September
              2007.

<span class="h3"><a class="selflink" name="section-10.2" href="#section-10.2">10.2</a>.  Informative References</span>

   [<a name="ref-BEHAVE" id="ref-BEHAVE">BEHAVE</a>]   Stewart, R., Tuexen, M., and I. Ruengeler, "Stream Control
              Transmission Protocol (SCTP) Network Address Translation",
              Work in Progress, February 2013.

   [<a name="ref-NATSUPP" id="ref-NATSUPP">NATSUPP</a>]  Stewart, R., Tuexen, M., and I. Ruengeler, "Stream Control
              Transmission Protocol (SCTP) Network Address Translation
              Support", Work in Progress, February 2013.

   [<a name="ref-RFC3424" id="ref-RFC3424">RFC3424</a>]  Daigle, L. IAB, "IAB Considerations for UNilateral Self-
              Address Fixing (UNSAF) Across Network Address
              Translation", <a href="rfc3424.html">RFC 3424</a>, November 2002.

   [<a name="ref-RFC6335" id="ref-RFC6335">RFC6335</a>]  Cotton, M., Eggert, L., Touch, J., Westerlund, M., and S.
              Cheshire, "Internet Assigned Numbers Authority (IANA)
              Procedures for the Management of the Service Name and
              Transport Protocol Port Number Registry", <a href="http://tools.ietf.org/html/bcp165">BCP 165</a>, <a href="rfc6335.html">RFC</a>
              <a href="rfc6335.html">6335</a>, August 2011.

   [<a name="ref-RFC6458" id="ref-RFC6458">RFC6458</a>]  Stewart, R., Tuexen, M., Poon, K., Lei, P., and V.
              Yasevich, "Sockets API Extensions for the Stream Control
              Transmission Protocol (SCTP)", <a href="rfc6458.html">RFC 6458</a>, December 2011.

   [<a name="ref-RFC6936" id="ref-RFC6936">RFC6936</a>]  Fairhurst, G. and M. Westerlund, "Applicability Statement
              for the Use of IPv6 UDP Datagrams with Zero Checksums",
              <a href="rfc6936.html">RFC 6936</a>, April 2013.
















<span class="grey">Tuexen &amp; Stewart             Standards Track                   [Page 11]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-12" id="page-12" href="#page-12" class="invisible"> </a>
<span class="grey"><a href="rfc6951.html">RFC 6951</a>            UDP Encapsulation of SCTP Packets           May 2013</span>


Authors' Addresses

   Michael Tuexen
   Muenster University of Applied Sciences
   Stegerwaldstrasse 39
   48565 Steinfurt
   DE

   EMail: tuexen@fh-muenster.de


   Randall R. Stewart
   Adara Networks
   Chapin, SC  29036
   US

   EMail: randall@lakerest.net


































Tuexen &amp; Stewart             Standards Track                   [Page 12]

</pre><br />
<span class="noprint"><small><small>Html markup produced by rfcmarkup 1.107, available from
<a href="http://tools.ietf.org/tools/rfcmarkup/">http://tools.ietf.org/tools/rfcmarkup/</a>
</small></small></span>
</body>
<!-- Mirrored from tools.ietf.org/html/rfc6951 by HTTrack Website Copier/3.x [XR&CO'2010], Wed, 19 Mar 2014 18:32:24 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8"><!-- /Added by HTTrack -->
</html>
