<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc3910 by HTTrack Website Copier/3.x [XR&CO'2013], Sat, 07 Jun 2014 20:18:48 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.107" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="draft-faynberg-spirits-protocol" name="DC.Relation.Replaces"/>
<meta content="urn:ietf:rfc:3910" name="DC.Identifier"/>
<meta content="October, 2004" name="DC.Date.Issued"/>
<meta content="Gato, Jorge" name="DC.Creator"/>
<meta content="Brusilovsky, Alec" name="DC.Creator"/>
<meta content="Unmehopa, Musa" name="DC.Creator"/>
<meta content="This document describes the Services in PSTN (Public Switched\nTelephone Network) requesting Internet Services (SPIRITS) protocol.\nThe purpose of the SPIRITS protocol is to support services that\noriginate in the cellular or wireline PSTN and necessitate\ninteractions between the PSTN and the Internet. On the PSTN side, the\nSPIRITS services are most often initiated from the Intelligent Network\n(IN) entities. Internet Call Waiting and Internet Caller-ID Delivery\nare examples of SPIRITS services, as are location-based services on\nthe cellular network. The protocol defines the building blocks from\nwhich many other services can be built. [STANDARDS-TRACK]" name="DC.Description.Abstract"/>
<meta content="The SPIRITS (Services in PSTN requesting Internet Services) Protocol" name="DC.Title"/>

    <link href="http://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="http://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 3910 - The SPIRITS (Services in PSTN requesting Internet Services) Protocol</title>
    
    
    <style type="text/css">
	body {
	    margin: 0px 8px;
            font-size: 1em;
	}
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgblue" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="http://tools.ietf.org/rfc/rfc3910.txt" title="Plaintext version of this document">txt</a>|<a href="http://tools.ietf.org/pdf/rfc3910" title="PDF version of this document">pdf</a>] [<a href="http://tools.ietf.org/html/draft-ietf-spirits-protocol" title="draft-ietf-spirits-protocol">draft-ietf-spirit...</a>] [<a href="http://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc3910" title="Inline diff (wdiff)">Diff1</a>] [<a href="http://tools.ietf.org/rfcdiff?url2=rfc3910" title="Side-by-side diff">Diff2</a>]                 </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                       PROPOSED STANDARD</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<pre>Network Working Group                                    V. Gurbani, Ed.
Request for Comments: 3910                                A. Brusilovsky
Category: Standards Track                                    I. Faynberg
                                               Lucent Technologies, Inc.
                                                                 J. Gato
                                                         Vodafone Espana
                                                                   H. Lu
                                           Bell Labs/Lucent Technologies
                                                             M. Unmehopa
                                               Lucent Technologies, Inc.
                                                            October 2004


  <span class="h1">The SPIRITS (Services in PSTN requesting Internet Services) Protocol</span>

Status of this Memo

   This document specifies an Internet standards track protocol for the
   Internet community, and requests discussion and suggestions for
   improvements.  Please refer to the current edition of the "Internet
   Official Protocol Standards" (STD 1) for the standardization state
   and status of this protocol.  Distribution of this memo is unlimited.

Copyright Notice

   Copyright (C) The Internet Society (2004).

Abstract

   This document describes the Services in PSTN (Public Switched
   Telephone Network) requesting Internet Services (SPIRITS) protocol.
   The purpose of the SPIRITS protocol is to support services that
   originate in the cellular or wireline PSTN and necessitate
   interactions between the PSTN and the Internet.  On the PSTN side,
   the SPIRITS services are most often initiated from the Intelligent
   Network (IN) entities.  Internet Call Waiting and Internet Caller-ID
   Delivery are examples of SPIRITS services, as are location-based
   services on the cellular network.  The protocol defines the building
   blocks from which many other services can be built.

Table of Contents

   <a href="#section-1">1</a>.   Introduction  . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-3">3</a>
        <a href="#section-1.1">1.1</a>.   Conventions used in this document. . . . . . . . . . .  <a href="#page-3">3</a>
   <a href="#section-2">2</a>.   Overview of operations. . . . . . . . . . . . . . . . . . . .  <a href="#page-3">3</a>
        <a href="#section-2.1">2.1</a>.   Terminology. . . . . . . . . . . . . . . . . . . . . .  <a href="#page-6">6</a>
   <a href="#section-3">3</a>.   Using XML for subscription and notification . . . . . . . . .  <a href="#page-7">7</a>
   <a href="#section-4">4</a>.   XML format definition . . . . . . . . . . . . . . . . . . . .  <a href="#page-8">8</a>



<span class="grey">Gurbani, et al.             Standards Track                     [Page 1]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc3910.html">RFC 3910</a>                    SPIRITS Protocol                October 2004</span>


   <a href="#section-5">5</a>.   Call-related events . . . . . . . . . . . . . . . . . . . . . <a href="#page-10">10</a>
        <a href="#section-5.1">5.1</a>.   IN-specific requirements . . . . . . . . . . . . . . . <a href="#page-11">11</a>
        <a href="#section-5.2">5.2</a>.   Detection points and required parameters . . . . . . . <a href="#page-12">12</a>
               <a href="#section-5.2.1">5.2.1</a>.   Originating-side DPs. . . . . . . . . . . . . <a href="#page-12">12</a>
               <a href="#section-5.2.2">5.2.2</a>.   Terminating-side DPs. . . . . . . . . . . . . <a href="#page-14">14</a>
        <a href="#section-5.3">5.3</a>.   Services through dynamic DPs . . . . . . . . . . . . . <a href="#page-15">15</a>
               <a href="#section-5.3.1">5.3.1</a>.   Normative usage . . . . . . . . . . . . . . . <a href="#page-15">15</a>
               <a href="#section-5.3.2">5.3.2</a>.   Event package name. . . . . . . . . . . . . . <a href="#page-16">16</a>
               <a href="#section-5.3.3">5.3.3</a>.   Event package parameters. . . . . . . . . . . <a href="#page-16">16</a>
               <a href="#section-5.3.4">5.3.4</a>.   SUBSCRIBE bodies. . . . . . . . . . . . . . . <a href="#page-16">16</a>
               <a href="#section-5.3.5">5.3.5</a>.   Subscription duration . . . . . . . . . . . . <a href="#page-17">17</a>
               <a href="#section-5.3.6">5.3.6</a>.   NOTIFY bodies . . . . . . . . . . . . . . . . <a href="#page-17">17</a>
               <a href="#section-5.3.7">5.3.7</a>.   Notifier processing of SUBSCRIBE requests . . <a href="#page-18">18</a>
               <a href="#section-5.3.8">5.3.8</a>.   Notifier generation of NOTIFY requests. . . . <a href="#page-18">18</a>
               <a href="#section-5.3.9">5.3.9</a>.   Subscriber processing of NOTIFY requests. . . <a href="#page-19">19</a>
               <a href="#section-5.3.10">5.3.10</a>.  Handling of forked requests . . . . . . . . . <a href="#page-19">19</a>
               <a href="#section-5.3.11">5.3.11</a>.  Rate of notifications . . . . . . . . . . . . <a href="#page-19">19</a>
               <a href="#section-5.3.12">5.3.12</a>.  State Agents. . . . . . . . . . . . . . . . . <a href="#page-20">20</a>
               <a href="#section-5.3.13">5.3.13</a>.  Examples. . . . . . . . . . . . . . . . . . . <a href="#page-20">20</a>
               <a href="#section-5.3.14">5.3.14</a>.  Use of URIs to retrieve state . . . . . . . . <a href="#page-25">25</a>
        <a href="#section-5.4">5.4</a>.   Services through static DPs. . . . . . . . . . . . . . <a href="#page-25">25</a>
               <a href="#section-5.4.1">5.4.1</a>.   Internet Call Waiting . . . . . . . . . . . . <a href="#page-26">26</a>
               <a href="#section-5.4.2">5.4.2</a>.   Call disposition choices. . . . . . . . . . . <a href="#page-26">26</a>
               <a href="#section-5.4.3">5.4.3</a>.   Accepting an ICW session using VoIP . . . . . <a href="#page-28">28</a>
   <a href="#section-6">6</a>.   Non-call related events . . . . . . . . . . . . . . . . . . . <a href="#page-29">29</a>
        <a href="#section-6.1">6.1</a>.   Non-call events and their required parameters. . . . . <a href="#page-29">29</a>
        <a href="#section-6.2">6.2</a>.   Normative usage. . . . . . . . . . . . . . . . . . . . <a href="#page-30">30</a>
        <a href="#section-6.3">6.3</a>.   Event package name . . . . . . . . . . . . . . . . . . <a href="#page-30">30</a>
        <a href="#section-6.4">6.4</a>.   Event package parameters . . . . . . . . . . . . . . . <a href="#page-31">31</a>
        <a href="#section-6.5">6.5</a>.   SUBSCRIBE bodies . . . . . . . . . . . . . . . . . . . <a href="#page-31">31</a>
        <a href="#section-6.6">6.6</a>.   Subscription duration. . . . . . . . . . . . . . . . . <a href="#page-31">31</a>
        <a href="#section-6.7">6.7</a>.   NOTIFY bodies. . . . . . . . . . . . . . . . . . . . . <a href="#page-32">32</a>
        <a href="#section-6.8">6.8</a>.   Notifier processing of SUBSCRIBE requests. . . . . . . <a href="#page-32">32</a>
        <a href="#section-6.9">6.9</a>.   Notifier generation of NOTIFY requests . . . . . . . . <a href="#page-32">32</a>
        <a href="#section-6.10">6.10</a>.  Subscriber processing of NOTIFY requests . . . . . . . <a href="#page-33">33</a>
        <a href="#section-6.11">6.11</a>.  Handling of forked requests. . . . . . . . . . . . . . <a href="#page-33">33</a>
        <a href="#section-6.12">6.12</a>.  Rate of notifications. . . . . . . . . . . . . . . . . <a href="#page-33">33</a>
        <a href="#section-6.13">6.13</a>.  State Agents . . . . . . . . . . . . . . . . . . . . . <a href="#page-33">33</a>
        <a href="#section-6.14">6.14</a>.  Examples . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-33">33</a>
        <a href="#section-6.15">6.15</a>.  Use of URIs to retrieve state. . . . . . . . . . . . . <a href="#page-37">37</a>
   <a href="#section-7">7</a>.   IANA Considerations . . . . . . . . . . . . . . . . . . . . . <a href="#page-38">38</a>
        <a href="#section-7.1">7.1</a>.   Registering event packages . . . . . . . . . . . . . . <a href="#page-38">38</a>
        <a href="#section-7.2">7.2</a>.   Registering MIME type. . . . . . . . . . . . . . . . . <a href="#page-38">38</a>
        <a href="#section-7.3">7.3</a>.   Registering URN. . . . . . . . . . . . . . . . . . . . <a href="#page-39">39</a>
        <a href="#section-7.4">7.4</a>.   Registering XML schema . . . . . . . . . . . . . . . . <a href="#page-40">40</a>
   <a href="#section-8">8</a>.   Security Considerations . . . . . . . . . . . . . . . . . . . <a href="#page-40">40</a>
   <a href="#section-9">9</a>.   XML schema definition . . . . . . . . . . . . . . . . . . . . <a href="#page-42">42</a>
   <a href="#section-10">10</a>.  Acknowledgements. . . . . . . . . . . . . . . . . . . . . . . <a href="#page-45">45</a>



<span class="grey">Gurbani, et al.             Standards Track                     [Page 2]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc3910.html">RFC 3910</a>                    SPIRITS Protocol                October 2004</span>


   <a href="#section-11">11</a>.  Acronyms. . . . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-45">45</a>
   <a href="#section-12">12</a>.  References. . . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-46">46</a>
   <a href="#section-13">13</a>.  Contributors. . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-48">48</a>
   <a href="#section-14">14</a>.  Authors' Addresses. . . . . . . . . . . . . . . . . . . . . . <a href="#page-48">48</a>
   <a href="#section-15">15</a>.  Full Copyright Statement. . . . . . . . . . . . . . . . . . . <a href="#page-50">50</a>

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>. Introduction</span>

   SPIRITS (Services in the PSTN Requesting Internet Services) is an
   IETF architecture and an associated protocol that enables call
   processing elements in the telephone network to make service requests
   that are then processed on Internet hosted servers.  The term Public
   Switched Telephone Network (PSTN) is used here to include the
   wireline circuit-switched network, as well as the wireless circuit-
   switched network.

   The earlier IETF work on the PSTN/Internet Interworking (PINT)
   resulted in the protocol (<a href="rfc2848.html">RFC 2848</a>) in support of the services
   initiated in the reverse direction - from the Internet to PSTN.

   This document has been written in response to the SPIRITS WG chairs
   call for SPIRITS Protocol proposals.  Among other contributions, this
   document is based on:

      o  Informational  "Pre-SPIRITS implementations" [<a href="#ref-10" title='"Pre-Spirits Implementations of PSTN-initiated Services"'>10</a>]
      o  Informational  "The SPIRITS Architecture" [<a href="#ref-1" title='"The SPIRITS Architecture"'>1</a>]
      o  Informational  "SPIRITS Protocol Requirements" [<a href="#ref-4" title='"Service in the Public Switched Telephone Network/Intelligent Network (PSTN/IN) Requesting InTernet Service (SPIRITS) Protocol Requirements"'>4</a>]

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.1.%20%20Conventions%20used%20in%20this%20document"></a><a class="selflink" href="#section-1.1" name="section-1.1">1.1</a>.  Conventions used in this document</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED",  "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in <a href="http://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a> [<a href="#ref-2" title='"Key words for use in RFCs to Indicate Requirement Levels"'>2</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Overview%20of%20operations"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Overview of operations</span>

   The purpose of the SPIRITS protocol is to enable the execution of
   services in the Internet based on certain events occurring in the
   PSTN.  The term PSTN is used here to include all manner of switching;
   i.e. wireline circuit-switched network, as well as the wireless
   circuit-switched network.

   In general terms, an Internet host is interested in getting
   notifications of certain events occurring in the PSTN.  When the
   event of interest occurs, the PSTN notifies the Internet host.  The
   Internet host can execute appropriate services based on these
   notifications.




<span class="grey">Gurbani, et al.             Standards Track                     [Page 3]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc3910.html">RFC 3910</a>                    SPIRITS Protocol                October 2004</span>


                             +------+
                             | PSTN |
                             |Events|
                             +------+
                            /       \
                           /         \
                  +-------+           +--------+
                  |Call   |           |Non-Call|
                  |Related|           |Related |
                  +-------+           +--+-----+
                 /        \              |
                /          \             |
           +---/--+     +---\---+     +--+-----------------+
           |Static|     |Dynamic|     |Mobility Management/|
           |      |     |       |     |Registration/De-    |
           +------+     +-------+     |registration        |
                                      +--------------------+

                     Figure 1: The SPIRITS Hierarchy.

   Figure 1 contains the SPIRITS events hierarchy, including their
   subdivision in two discrete classes for service execution: events
   related to the setup, teardown and maintenance of a call and events
   un-related to call setup, teardown or maintenance.  Example of the
   latter class of events are geo-location mobility events that are
   tracked by the cellular PSTN.  SPIRITS will specify the framework to
   provide services for both of these types of events.

   Call-related events, its further subdivisions, and how they enable
   services in the Internet is contained in <a href="#section-5">Section 5</a>.  Services enabled
   from events not related to call setup, teardown, or maintenance are
   covered in detail in <a href="#section-6">Section 6</a>.

   For reference, the SPIRITS architecture from [<a href="#ref-1" title='"The SPIRITS Architecture"'>1</a>] is reproduced below.
   This document is focused on interfaces B and C only.  Interface D is
   a matter of local policy; the PSTN operator may have a functional
   interface between the SPIRITS client or a message passing interface.
   This document does not discuss interface D in any detail.













<span class="grey">Gurbani, et al.             Standards Track                     [Page 4]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc3910.html">RFC 3910</a>                    SPIRITS Protocol                October 2004</span>


             +--------------+
             | Subscriber's |
             |   IP Host    |              +--------------+
             |              |              |              |
             | +----------+ |              | +----------+ |
             | | PINT     | |      A       | | PINT     | |
             | |  Client  +&lt;-------/--------&gt;+  Gateway +&lt;-----+
             | +----------+ |              | +----------+ |    |
             |              |              |              |    |
             | +----------+ |              | +----------+ |    |
             | | SPIRITS  | |      B       | | SPIRITS  | |    |
             | |  Server  +&lt;-------/--------&gt;+  Gateway | |    |
             | +----------+ |              | +--------+-+ |    |
             |              |              |          ^   |    |
             +--------------+              +----------|---+    |
                                                      |        |
                                      IP Network      |        |
            ------------------------------------------|--------|---
                                      PSTN            / C      / E
                                                      |        |
                                                      v        |
                                                 +----+------+ |
                                                 | SPIRITS   | |
                                                 |   Client  | v
               +-------------------+         +---+-----D-----+-++
               | Service Switching |INAP/SS7 | Service Control  |
               |    Function       +---------+     Function     |
               +----+--------------+         +------------------+
                    |
                    |line
                   +-+
                   [0] Subscriber's telephone

                    Figure 2: The SPIRITS Architecture.

     (Note: The interfaces A-E are described in detail in the SPIRITS
                        Architecture document [<a href="#ref-1" title='"The SPIRITS Architecture"'>1</a>].)

   The PSTN today supports service models such as the Intelligent
   Network (IN), whereby some features are executed locally on switching
   elements called Service Switching Points (SSPs).  Other features are
   executed on service elements called Service Control Points (SCPs).
   The SPIRITS architecture [<a href="#ref-1" title='"The SPIRITS Architecture"'>1</a>] permits these SCP elements to act as
   intelligent entities to leverage and use Internet hosts and
   capabilities to further enhance the telephone end-user's experience.






<span class="grey">Gurbani, et al.             Standards Track                     [Page 5]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc3910.html">RFC 3910</a>                    SPIRITS Protocol                October 2004</span>


   The protocol used on interfaces B and C consists of the SPIRITS
   protocol, and is based on SIP and SIP event notification [<a href="#ref-3" title='"Session Initiation Protocol (SIP)-Specific Event Notification"'>3</a>].  The
   requirements of a SPIRITS protocol and the choice of using SIP as an
   enabler are detailed in [<a href="#ref-4" title='"Service in the Public Switched Telephone Network/Intelligent Network (PSTN/IN) Requesting InTernet Service (SPIRITS) Protocol Requirements"'>4</a>].

   The SPIRITS protocol is a set of two "event packages" [<a href="#ref-3" title='"Session Initiation Protocol (SIP)-Specific Event Notification"'>3</a>].  It
   contains the procedural rules and semantic context that must be
   applied to these rules for processing SIP transactions.  The SPIRITS
   protocol has to carry subscriptions for events from the SPIRITS
   server to the SPIRITS client and notifications of these events from
   the SPIRITS client to the SPIRITS server.  Extensible Markup Language
   (XML) [<a href="#ref-12" title='"XML Schema Part 1: Structures"'>12</a>] is used to codify the subscriptions and notifications.

   Finally, in the context of ensuing discussion, the terms "SPIRITS
   server" and "SPIRITS client" are somewhat confusing since the roles
   appear reversed; to wit, the "SPIRITS server" issues a subscription
   which is accepted by a "SPIRITS client".  To mitigate such ambiguity,
   from now on, we will refer to the "SPIRITS server" as a "SPIRITS
   subscriber" and to the "SPIRITS client" as a "SPIRITS notifier".
   This convention adheres to the nomenclature outlined in [<a href="#ref-3" title='"Session Initiation Protocol (SIP)-Specific Event Notification"'>3</a>]; the
   SPIRITS server in Figure 2 is a subscriber (issues subscriptions to
   events), and the SPIRITS client in Figure 2 is a notifier (issues
   notifications whenever the event of interest occurs).

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.1.%20%20Terminology"></a><a class="selflink" href="#section-2.1" name="section-2.1">2.1</a>.  Terminology</span>

   For ease of reference, we provide a terminology of the SPIRITS actors
   discussed in the preceding above:

   Service Control Function (SCF): A PSTN entity that executes service
   logic.  It provides capabilities to influence the call processing
   occurring in the Service Switching Function (SSF).  For more
   information on how a SCF participates in the SPIRITS architecture,
   please see Sections <a href="#section-5">5</a> and <a href="#section-5.1">5.1</a>.

   SPIRITS client: see SPIRITS notifier.

   SPIRITS server: see SPIRITS subscriber.

   SPIRITS notifier: A User Agent (UA) in the PSTN that accepts
   subscriptions from SPIRITS subscribers.  These subscriptions contain
   events that the SPIRITS subscribers are interested in receiving a
   notification for.  The SPIRITS notifier interfaces with the Service
   Control Function such that when the said event occurs, a notification
   will be sent to the relevant SPIRITS subscriber.






<span class="grey">Gurbani, et al.             Standards Track                     [Page 6]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc3910.html">RFC 3910</a>                    SPIRITS Protocol                October 2004</span>


   SPIRITS subscriber: A UA in the Internet that issues a subscription
   containing events in the PSTN that it is interested in receiving a
   notification for.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20Using%20XML%20for%20subscription%20and%20notification"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  Using XML for subscription and notification</span>

   The SPIRITS protocol requirements mandate that "SPIRITS-related
   parameters be carried in a manner consistent with SIP practices"
   (<a href="rfc3298.html">RFC3298</a>:<a href="#section-3">Section 3</a>).  SIP already provides payload description
   capabilities through the use of headers (Content-Type, Content-
   Length).  This document defines a new MIME type --
   "application/spirits-event+xml" -- and registers it with IANA
   (<a href="#section-7">Section 7</a>).  This MIME type MUST be present in the "Content-Type"
   header of SPIRITS requests and responses, and it describes an XML
   document that contains SPIRITS-related information.

   This document defines a base XML schema for subscriptions to PSTN
   events.  The list of events that can be subscribed to is defined in
   the SPIRITS protocol requirements document [<a href="#ref-4" title='"Service in the Public Switched Telephone Network/Intelligent Network (PSTN/IN) Requesting InTernet Service (SPIRITS) Protocol Requirements"'>4</a>] and this document
   provides an XML schema for it.  All SPIRITS subscribers (any SPIRITS
   entity capable of issuing a SUBSCRIBE, REGISTER, or INVITE request)
   MUST support this schema.  All SPIRITS notifiers (any SPIRITS entity
   capable of receiving and processing a SUBSCRIBE, REGISTER, or INVITE
   request) MUST support this schema.  The schema is defined in <a href="#section-9">Section</a>
   <a href="#section-9">9</a>.

      The support for the SIP REGISTER request is included for PINT
      compatibility (<a href="rfc3298.html">RFC3298</a>:<a href="#section-6">Section 6</a>).

      The support for the SIP INVITE request is mandated because pre-
      existing SPIRITS implementations did not use the SIP event
      notification scheme.  Instead, the initial PSTN detection point
      always arrived via the SIP INVITE request.

   This document also defines a base XML schema for notifications of
   events (<a href="#section-9">Section 9</a>).  All SPIRITS notifiers MUST generate XML
   documents that correspond to the base notification  schema.  All
   SPIRITS subscribers MUST support XML documents that correspond to
   this schema.

   The set of events that can be subscribed to and the amount of
   notification that is returned by the PSTN entity may vary among
   different PSTN operators.  Some PSTN operators may have a rich set of
   events that can be subscribed to, while others have only the
   primitive set of events outlined in the SPIRITS protocol requirements
   document [<a href="#ref-4" title='"Service in the Public Switched Telephone Network/Intelligent Network (PSTN/IN) Requesting InTernet Service (SPIRITS) Protocol Requirements"'>4</a>].  This document defines a base XML schema (in <a href="#section-9">Section 9</a>)
   which MUST be used for the subscription and notification of the
   primitive set of events.  In order to support a richer set of event



<span class="grey">Gurbani, et al.             Standards Track                     [Page 7]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc3910.html">RFC 3910</a>                    SPIRITS Protocol                October 2004</span>


   subscription and notification, implementations MAY use additional XML
   namespaces corresponding to alternate schemas in a SPIRITS XML
   document.  However, all implementations MUST support the base XML
   schema defined in <a href="#section-9">Section 9</a> of this document.  Use of the base schema
   ensures interoperability across implementations, and the inclusion of
   additional XML namespaces allows for customization.

   A logical flow of the SPIRITS protocol is depicted below (note: this
   example shows a temporal flow; XML documents and related SPIRITS
   protocol syntax is specified in later sections of this document).  In
   the flow below, S is the SPIRITS subscriber and N is the SPIRITS
   notifier.  The SPIRIT Gateway is presumed to have a pure proxying
   functionality and thus is omitted for simplicity:


   1  S-&gt;N Subscribe (events of interest in an XML document instance
                      using base subscription schema)
   2  N-&gt;S 200 OK (Subscribe)
   3  N-&gt;S Notify
   4  S-&gt;N 200 OK (Notify communicating current resource state)
   5  ...
   6  N-&gt;S Notify (Notify communicating change in resource state;
                   payload is an XML document instance using
                   XML extensions to the base notification schema)
   7  S-&gt;N 200 OK (Notify)

   In line 1, the SPIRITS subscriber subscribes to certain events using
   an XML document based on the base schema defined in this document.
   In line 6, the SPIRITS notifier notifies the SPIRITS subscriber of
   the occurrence of the event using extensions to the base notification
   schema.  Note that this document defines a base schema for event
   notification as well; the SPIRITS notifier could have availed itself
   of these.  Instead, it chooses to pass to the SPIRITS subscriber an
   XML document composed of extensions to the base notification schema.
   The SPIRITS subscriber, if it understands the extensions, can
   interpret the XML document accordingly.  However, in the event that
   the SPIRITS subscriber is not programmed to understand the
   extensions, it MUST search the XML document for the mandatory
   elements.  These elements MUST be present in all notification schemas
   and are detailed in <a href="#section-9">Section 9</a>.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20XML%20format%20definition"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  XML format definition</span>

   This section defines the XML-encoded SPIRITS payload format.  Such a
   payload is a well formed XML document and is produced by SPIRITS
   notifiers and SPIRITS subscribers.





<span class="grey">Gurbani, et al.             Standards Track                     [Page 8]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc3910.html">RFC 3910</a>                    SPIRITS Protocol                October 2004</span>


   The namespace URI for elements defined in this document is a Uniform
   Resource Name (URN) [<a href="#ref-14" title='"URN Syntax"'>14</a>], using the namespace identifier 'ietf'
   defined in [<a href="#ref-15" title='"A URN Namespace for IETF Documents"'>15</a>] and extended by [<a href="#ref-16" title='"The IETF XML Registry"'>16</a>]:

      urn:ietf:params:xml:ns:spirits-1.0

   SPIRITS XML documents may have a default namespace, or they may be
   associated with a namespace prefix following the convention
   established in XML namespaces [<a href="#ref-17" title='"Namespaces in XML"'>17</a>].  Regardless, the elements and
   attributes of SPIRITS XML documents MUST conform to the SPIRITS XML
   schema specified in <a href="#section-9">Section 9</a>.

   The &lt;spirits-event&gt; element
      The root of a SPIRITS XML document (characterized by a Content-
      Type header of "application/spirits-event+xml"&gt;) is the &lt;spirits-
      event&gt; element.  This element MUST contain a namespace declaration
      ('xmlns') to indicate the namespace on which the XML document is
      based.  XML documents compliant to the SPIRITS protocol MUST
      contain the URN "urn:ietf:params:xml:ns:spirits-1.0" in the
      namespace declaration.  Other namespaces may be specified as
      needed.

      &lt;spirits-event&gt; element MUST contain at least one &lt;Event&gt; element,
      and MAY contain more than one.

   The &lt;Event&gt; element
      The &lt;Event&gt; element contains three attributes, two of which are
      mandatory.  The first mandatory attribute is a 'type' attribute
      whose value is either "INDPs" or "userprof".

      These types correspond, respectively, to call-related events
      described in <a href="#section-5">Section 5</a> and non-call related events described in
      <a href="#section-6">Section 6</a>.

      The second mandatory attribute is a 'name' attribute.  Values for
      this attribute MUST be limited to the SPIRITS mnemonics defined in
      <a href="#section-5.2.1">Section 5.2.1</a>, <a href="#section-5.2.2">Section 5.2.2</a>, and <a href="#section-6.1">Section 6.1</a>.

      The third attribute, which is optional, is a 'mode' attribute.
      The value of 'mode' is either "N" or "R", corresponding
      respectively to (N)otification or (R)equest (<a href="rfc3298.html">RFC3298</a>:<a href="#section-4">Section 4</a>).
      The default value of this attribute is "N".

      If the 'type' attribute of the &lt;Event&gt; element is "INDPs", then it
      MUST contain at least one or more of the following elements
      (unknown elements MAY be ignored):  &lt;CallingPartyNumber&gt;,
      &lt;CalledPartyNumber&gt;, &lt;DialledDigits&gt;, or &lt;Cause&gt;.  These elements




<span class="grey">Gurbani, et al.             Standards Track                     [Page 9]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc3910.html">RFC 3910</a>                    SPIRITS Protocol                October 2004</span>


      are defined in <a href="#section-5.2">Section 5.2</a>; they MUST not contain any attributes
      and MUST not be used further as parent elements.  These elements
      contain a string value as described in <a href="#section-5.2.1">Section 5.2.1</a> and 5.2.2.

      If the 'type' attribute of the &lt;Event&gt; element is "userprof", then
      it MUST contain a &lt;CalledPartyNumber&gt; element and it MAY contain a
      &lt;Cell-ID&gt; element.  None of these elements contain any attributes
      and neither must be used further as a parent element.  These
      elements contain a string value as described in <a href="#section-6.1">Section 6.1</a>.  All
      other elements MAY be ignored if not understood.

   A SPIRITS-compliant XML document using the XML namespace defined in
   this document might look like the following example:

   &lt;?xml version="1.0" encoding="UTF-8"?&gt;
   &lt;spirits-event xmlns="urn:ietf:params:xml:ns:spirits-1.0"&gt;
      &lt;Event type="INDPs" name="OD" mode="N"&gt;
         &lt;CallingPartyNumber&gt;5551212&lt;/CallingPartyNumber&gt;
      &lt;/Event&gt;
      &lt;Event type="INDPs" name="OAB" mode="N"&gt;
         &lt;CallingPartyNumber&gt;5551212&lt;/CallingPartyNumber&gt;
      &lt;/Event&gt;
   &lt;/spirits-event&gt;

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20Call-related%20events"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  Call-related events</span>

   For readers who may not be familiar with the service execution
   aspects of PSTN/IN, we provide a brief tutorial next.  Interested
   readers are urged to consult [<a href="#ref-19" title='"The Intelligent Network Standards: Their Application to Services"'>19</a>] for a detailed treatment of this
   subject.

   Services in the PSTN/IN are executed based on a call model.  A call
   model is a finite state machine used in SSPs and other call
   processing elements that accurately and concisely reflects the
   current state of a call at any given point in time.  Call models
   consist of states called PICs (Points In Call) and transitions
   between states.  Inter-state transitions pass through elements called
   Detection Points or DPs.  DPs house one or more triggers.  Every
   trigger has a firing criteria associated with it.  When a trigger is
   armed (made active), and its associated firing criteria are
   satisfied, it fires.  The particulars of firing criteria may vary
   based on the call model being supported.

   When a trigger fires, a message is formatted with call state
   information and transmitted by the SSP to the SCP.  The SCP then
   reads this call related data and generates a response which the SSP
   then uses in further call processing.




<span class="grey">Gurbani, et al.             Standards Track                    [Page 10]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc3910.html">RFC 3910</a>                    SPIRITS Protocol                October 2004</span>


   Detection Points are of two types: TDPs (or Trigger Detection
   Points), and EDPs (or Event Detection Points).  TDPs are provisioned
   with statically armed triggers (armed through Service Management
   Tools).  EDPs are dynamically armed triggers (armed by the SCP as
   call processing proceeds).  DPs may also be classified as "Request"
   or "Notification" DPs.  Thus, one can have TDP-R's, TDP-N's, EDP-R's
   and EDP-N's.

   The "-R" type of DPs require the SSP to suspend call processing when
   communication with the SCP is initiated.  Call processing resumes
   when a response is received.  The "-N" type of DPs enable the SSP to
   continue with call processing when the trigger fires, after it sends
   out the message to the SCP, notifying it that a certain event has
   occurred.

   Call models typically support different types of detection points.
   Note that while INAP and the IN Capability Set (CS)-2 [<a href="#ref-7">7</a>] call model
   are used in this document as examples, and for ease of explanation,
   other call models possess similar properties.  For example, the
   Wireless Intelligent Network (WIN) call model also supports the
   dynamic arming of triggers.  Thus, the essence of this discussion
   applies not just to the wireline domain, but applies equally well to
   the wireless domain as well.

   When the SCP receives the INAP formatted message from the SSP, if the
   SCP supports the SPIRITS architecture, it can encode the INAP message
   contents into a SPIRITS protocol message which is then transmitted to
   SPIRITS-capable elements in the IP network.  Similarly, when it
   receives responses back from said SPIRITS capable elements, it can
   reformat the response content into the INAP format and forward these
   messages back to SSPs.  Thus the process of inter-conversion and/or
   encoding between the INAP parameters and the SPIRITS protocol is of
   primary interest.

   An SCP is a physical manifestation of the Service Control Function.
   An SSP is a physical manifestation of the Service Switching Function
   (and the Call Control Function).  To support uniformity of
   nomenclature between the various SPIRITS drafts, we shall use the
   terms SCP and SCF, and SSP and SSF interchangeably in this document.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.1.%20%20IN-specific%20requirements"></a><a class="selflink" href="#section-5.1" name="section-5.1">5.1</a>.  IN-specific requirements</span>

   Section 4 of [<a href="#ref-4" title='"Service in the Public Switched Telephone Network/Intelligent Network (PSTN/IN) Requesting InTernet Service (SPIRITS) Protocol Requirements"'>4</a>] outlines the IN-related requirements on the SPIRITS
   protocol.  The SUBSCRIBE request arriving at the SPIRITS notifier
   MUST contain the events to be monitored (in the form of a DP list),
   the mode (request or a notification, the difference being that for a





<span class="grey">Gurbani, et al.             Standards Track                    [Page 11]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc3910.html">RFC 3910</a>                    SPIRITS Protocol                October 2004</span>


   request, the SPIRITS subscriber can influence subsequent call
   processing and for a notification, no further influence is needed),
   and any DP-related parameters.

   Section 4 of [<a href="#ref-4" title='"Service in the Public Switched Telephone Network/Intelligent Network (PSTN/IN) Requesting InTernet Service (SPIRITS) Protocol Requirements"'>4</a>] also enumerates a list of Capability Set 3 (CS-3)
   DPs for SPIRITS services.  It is a requirement (<a href="rfc3298.html">RFC3298</a>:<a href="#section-4">Section 4</a>)
   that the SPIRITS protocol specify the relevant parameters of the DPs.
   These DPs and their relevant parameters to be carried in a SUBSCRIBE
   request are codified in an XML schema.  All SPIRITS subscribers MUST
   understand this schema for subscribing to the DPs in the PSTN.  The
   schema is defined in <a href="#section-9">Section 9</a>.

   When a DP fires, a notification -- using a SIP NOTIFY request -- is
   transmitted from the SPIRITS notifier to the SPIRITS subscriber.  The
   NOTIFY request contains an XML document which describes the DP that
   fired and any relevant parameters.  The DPs and their relevant
   parameters to be carried in a NOTIFY request are codified in an XML
   schema.  All SPIRITS notifiers MUST understand this schema; this
   schema MAY be extended.  The schema is defined in <a href="#section-9">Section 9</a>.

   In addition, Appendices A and B of [<a href="#ref-6" title='"On selection of IN parameters to be carried by the SPIRITS Protocol"'>6</a>] contain a select subset of
   CS-2 DPs that may be of interest to the reader.  However, this
   document will only refer to CS-3 DPs outlined in [<a href="#ref-4" title='"Service in the Public Switched Telephone Network/Intelligent Network (PSTN/IN) Requesting InTernet Service (SPIRITS) Protocol Requirements"'>4</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.2.%20%20Detection%20points%20and%20required%20parameters"></a><a class="selflink" href="#section-5.2" name="section-5.2">5.2</a>.  Detection points and required parameters</span>

   The IN CS-3 DPs envisioned for SPIRITS services (<a href="rfc3298.html">RFC3298</a>:<a href="#section-4">Section 4</a>)
   are described next.  IN DPs are characterized by many parameters,
   however, not all such parameters are required -- or even needed -- by
   SPIRITS.  This section, thus, serves to list the mandatory parameters
   for each DP that MUST be specified in subscriptions and
   notifications.  Implementations can specify additional parameters as
   XML extensions associated with a private (or public and standardized)
   namespace.

   The exhaustive list of IN CS-3 DPs and their parameters can be found
   in reference [<a href="#ref-13" title='"Interface recommendations for intelligent network capability set 3: SCF-SSF interface"'>13</a>].

   Each DP is given a SPIRITS-specific mnemonic for use in the
   subscriptions and notifications.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.2.1.%20%20Originating-side%20DPs"></a><a class="selflink" href="#section-5.2.1" name="section-5.2.1">5.2.1</a>.  Originating-side DPs</span>

   Origination Attempt Authorized
   SPIRITS mnemonic: OAA
   Mandatory parameter in SUBSCRIBE: CallingPartyNumber
   Mandatory parameters in NOTIFY: CallingPartyNumber, CalledPartyNumber




<span class="grey">Gurbani, et al.             Standards Track                    [Page 12]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc3910.html">RFC 3910</a>                    SPIRITS Protocol                October 2004</span>


   CallingPartyNumber: A string used to identify the calling party for
   the call.  The actual length and encoding of this parameter depend on
   the particulars of the dialing plan used.

   CalledPartyNumber: A string containing the number (e.g., called
   directory number) used to identify the called party.  The actual
   length and encoding of this parameter depend on the particulars of
   the dialing plan used.

   Collected Information
   SPIRITS mnemonic: OCI
   Mandatory parameter in SUBSCRIBE: CallingPartyNumber
   Mandatory parameters in NOTIFY: CallingPartyNumber, DialledDigits

   DialledDigits: This parameter contains non-translated address
   information collected/received from the originating user/line/trunk

   Analyzed Information
   SPIRITS mnemonic: OAI
   Mandatory parameter in SUBSCRIBE: CallingPartyNumber
   Mandatory parameters in NOTIFY: CallingPartyNumber, DialledDigits

   Origination Answer
   SPIRITS mnemonic: OA
   Mandatory parameter in SUBSCRIBE: CallingPartyNumber
   Mandatory parameters in NOTIFY: CallingPartyNumber, CalledPartyNumber

   Origination Term Seized
   SPIRITS mnemonic: OTS
   Mandatory parameter in SUBSCRIBE: CallingPartyNumber
   Mandatory parameter in NOTIFY: CallingPartyNumber, CalledPartyNumber

   Origination No Answer
   SPIRITS mnemonic: ONA
   Mandatory parameter in SUBSCRIBE: CallingPartyNumber
   Mandatory parameter in NOTIFY: CallingPartyNumber, CalledPartyNumber

   Origination Called Party Busy
   SPIRITS mnemonic: OCPB
   Mandatory parameter in SUBSCRIBE: CallingPartyNumber
   Mandatory parameters in NOTIFY: CallingPartyNumber, CalledPartyNumber

   Route Select Failure
   SPIRITS mnemonic: ORSF
   Mandatory parameter in SUBSCRIBE: CallingPartyNumber
   Mandatory parameter in NOTIFY: CallingPartyNumber, CalledPartyNumber





<span class="grey">Gurbani, et al.             Standards Track                    [Page 13]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc3910.html">RFC 3910</a>                    SPIRITS Protocol                October 2004</span>


   Origination Mid Call
   SPIRITS mnemonic: OMC
   Mandatory parameter in SUBSCRIBE: CallingPartyNumber
   Mandatory parameter in NOTIFY: CallingPartyNumber

   Origination Abandon
   SPIRITS mnemonic: OAB

   Mandatory parameter in SUBSCRIBE: CallingPartyNumber
   Mandatory parameter in NOTIFY: CallingPartyNumber

   Origination Disconnect
   SPIRITS mnemonic: OD
   Mandatory parameter in SUBSCRIBE: CallingPartyNumber
   Mandatory parameter in NOTIFY: CallingPartyNumber, CalledPartyNumber

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.2.2.%20%20Terminating-side%20DPs"></a><a class="selflink" href="#section-5.2.2" name="section-5.2.2">5.2.2</a>.  Terminating-side DPs</span>

   Termination Answer
   SPIRITS mnemonic: TA
   Mandatory parameter in SUBSCRIBE: CalledPartyNumber
   Mandatory parameters in NOTIFY: CallingPartyNumber, CalledPartyNumber

   Termination No Answer
   SPIRITS mnemonic: TNA Mandatory parameter in SUBSCRIBE:
   CalledPartyNumber
   Mandatory parameters in NOTIFY: CallingPartyNumber, CalledPartyNumber

   Termination Mid-Call
   SPIRITS mnemonic: TMC
   Mandatory parameter in SUBSCRIBE: CalledPartyNumber
   Mandatory parameter in NOTIFY: CalledPartyNumber

   Termination Abandon
   SPIRITS mnemonic: TAB
   Mandatory parameter in SUBSCRIBE: CalledPartyNumber
   Mandatory parameter in NOTIFY: CalledPartyNumber

   Termination Disconnect
   SPIRITS mnemonic: TD
   Mandatory parameter in SUBSCRIBE: CalledPartyNumber
   Mandatory parameters in NOTIFY: CalledPartyNumber, CallingPartyNumber

   Termination Attempt Authorized
   SPIRITS mnemonic: TAA
   Mandatory parameter in SUBSCRIBE: CalledPartyNumber
   Mandatory parameters in NOTIFY: CalledPartyNumber, CallingPartyNumber




<span class="grey">Gurbani, et al.             Standards Track                    [Page 14]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc3910.html">RFC 3910</a>                    SPIRITS Protocol                October 2004</span>


   Termination Facility Selected and Available
   SPIRITS mnemonic: TFSA
   Mandatory parameter in SUBSCRIBE: CalledPartyNumber
   Mandatory parameter in NOTIFY: CalledPartyNumber

   Termination Busy
   SPIRITS mnemonic: TB
   Mandatory parameter in SUBSCRIBE: CalledPartyNumber
   Mandatory parameters in NOTIFY: CalledPartyNumber,
   CallingPartyNumber, Cause

   Cause: This parameter contains a string value of either "Busy" or
   "Unreachable".  The difference between these is translated as a
   requirement (<a href="rfc3298.html">RFC3298</a>:<a href="#section-5">Section 5</a>) to aid in the SPIRITS subscriber in
   determining if the called party is indeed busy (engaged), or if the
   called party is unavailable (as it would be if it were on the
   cellular PSTN and the mobile subscriber was not registered with the
   network).

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.3.%20%20Services%20through%20dynamic%20DPs"></a><a class="selflink" href="#section-5.3" name="section-5.3">5.3</a>.  Services through dynamic DPs</span>

   Triggers in the PSTN can be armed dynamically, often outside the
   context of a call.  The SIP event notification mechanism [<a href="#ref-3" title='"Session Initiation Protocol (SIP)-Specific Event Notification"'>3</a>] is,
   therefore, a convenient means to exploit in those cases where
   triggers housed in EDPs fire (see section 3 of [<a href="#ref-4" title='"Service in the Public Switched Telephone Network/Intelligent Network (PSTN/IN) Requesting InTernet Service (SPIRITS) Protocol Requirements"'>4</a>]).  Note that [<a href="#ref-4" title='"Service in the Public Switched Telephone Network/Intelligent Network (PSTN/IN) Requesting InTernet Service (SPIRITS) Protocol Requirements"'>4</a>]
   uses the term "persistent" to refer to call-related DP arming and
   associated interactions.

   The SIP Events Package enables IP endpoints (or hosts) to subscribe
   to and receive subsequent notification of events occurring in the
   PSTN.  With reference to Figure 2, this includes communication on the
   interfaces marked "B" and "C".

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.3.1.%20%20Normative%20usage"></a><a class="selflink" href="#section-5.3.1" name="section-5.3.1">5.3.1</a>.  Normative usage</span>

   A subscriber will issue a SUBSCRIBE request which identifies a set of
   events (DPs) it is interested in getting the notification of.  This
   set MUST contain at least one DP, it MAY contain more than one.  The
   SUBSCRIBE request is routed to the notifier, where it is accepted,
   pending a successful authentication.

   When any of the DPs identified in the set of events fires, the
   notifier will format a NOTIFY request and direct it towards the
   subscriber.  The NOTIFY request will contain information pertinent to
   the event that was triggered.  The un-encountered DPs MUST be
   subsequently dis-armed by the SPIRITS notifier and/or the SCF.





<span class="grey">Gurbani, et al.             Standards Track                    [Page 15]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-16" id="page-16" name="page-16"> </a>
<span class="grey"><a href="rfc3910.html">RFC 3910</a>                    SPIRITS Protocol                October 2004</span>


   The dialog established by the SUBSCRIBE terminates when the event of
   interest occurs and this notification is passed to the subscriber
   through a NOTIFY request.  If the subscriber is interested in the
   future occurrence of the same event, it MUST issue a new SUBSCRIBE
   request, establishing a new dialog.

   When the subscriber receives a NOTIFY request, it can subsequently
   choose to act in a manner appropriate to the notification.

   The remaining sections fill in the specific package responsibilities
   raised in <a href="rfc3265.html">RFC3265</a> [<a href="#ref-3" title='"Session Initiation Protocol (SIP)-Specific Event Notification"'>3</a>], Section 4.4.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.3.2.%20%20Event%20package%20name"></a><a class="selflink" href="#section-5.3.2" name="section-5.3.2">5.3.2</a>.  Event package name</span>

   This document defines two event packages; the first of these is
   defined in this section and is called "spirits-INDPs".  This package
   MUST be used for events corresponding to IN detection points in the
   cellular or wireline PSTN.  All entities that implement the SPIRITS
   protocol and support IN detection points MUST set the "Event" request
   header [<a href="#ref-3" title='"Session Initiation Protocol (SIP)-Specific Event Notification"'>3</a>] to "spirits-INDPs."  The "Allow-Events" general header [<a href="#ref-3" title='"Session Initiation Protocol (SIP)-Specific Event Notification"'>3</a>]
   MUST include the token "spirits-INDPs" if the entity implements the
   SPIRITS protocol and supports IN detection points.

      Event: spirits-INDPs
      Allow-Events: spirits-INDPs

   The second event package is defined and discussed in <a href="#section-6">Section 6</a>.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.3.3.%20%20Event%20package%20parameters"></a><a class="selflink" href="#section-5.3.3" name="section-5.3.3">5.3.3</a>.  Event package parameters</span>

   The "spirits-INDPs" event package does not support any additional
   parameters to the Event header.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.3.4.%20%20SUBSCRIBE%20bodies"></a><a class="selflink" href="#section-5.3.4" name="section-5.3.4">5.3.4</a>.  SUBSCRIBE bodies</span>

   SUBSCRIBE requests that serve to terminate the subscription MAY
   contain an empty body; however, SUBSCRIBE requests that establish a
   dialog MUST contain a body which encodes three pieces of information:

      (1) The set of events (DPs) that is being subscribed to.  A
      subscriber MAY subscribe to multiple DPs in one SUBSCRIBE request,
      or MAY issue a different SUBSCRIBE request for each DP it is
      interested in receiving a notification for.  The protocol allows
      for both forms of representation, however, it recommends the
      former manner of subscribing to DPs if the service depends on any
      of the DPs being triggered.





<span class="grey">Gurbani, et al.             Standards Track                    [Page 16]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-17" id="page-17" name="page-17"> </a>
<span class="grey"><a href="rfc3910.html">RFC 3910</a>                    SPIRITS Protocol                October 2004</span>


      (2) Because of the requirement [<a href="#ref-4" title='"Service in the Public Switched Telephone Network/Intelligent Network (PSTN/IN) Requesting InTernet Service (SPIRITS) Protocol Requirements"'>4</a>] that IN be informed whether the
      detection point is set as the request or notification, all events
      in the "spirits-INDPs" package (but not in the "spirits-user-prof"
      package) are required to provide a "mode" parameter, whose values
      are "R" (for Request) and "N" for notification.

      (3) A list of the values of the parameters associated with the
      event detection point (Note: the term "event" here refers to the
      IN usage -- a dynamically armed DP is called an Event Detection
      Point).  Please see <a href="#section-5.2.1">Section 5.2.1</a> and <a href="#section-5.2.2">Section 5.2.2</a> for a list of
      parameters associated with each DP.

   The default body type for SUBSCRIBEs in SPIRITS is denoted by the
   MIME type "application/spirits-event+xml".  The "Accept" header, if
   present, MUST include this MIME type.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.3.5.%20%20Subscription%20duration"></a><a class="selflink" href="#section-5.3.5" name="section-5.3.5">5.3.5</a>.  Subscription duration</span>

   For package "spirits-INDPs", the purpose of the SUBSCRIBE request is
   to arm the DP, since as far as IN is concerned, being armed is the
   first essential pre-requisite.  A DP maybe armed either statically
   (for instance, through service provisioning), or dynamically (by the
   SCF).  A statically armed DP remains armed until it is disarmed
   proactively.  A dynamically armed DP remains armed for the duration
   of a call (or more appropriately, no longer than the duration of a
   particular SSF-SCF relationship).

   Dynamically armed DPs are automatically disarmed when the event of
   interest occurs in the notifier.  It is up to the subscriber to re-
   arm the DPs within the context of a call, if it so desires.

   Statically armed DPs are considered outside the scope of the SPIRITS
   protocol requirements [<a href="#ref-4" title='"Service in the Public Switched Telephone Network/Intelligent Network (PSTN/IN) Requesting InTernet Service (SPIRITS) Protocol Requirements"'>4</a>] and thus will not be considered any
   further.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.3.6.%20%20NOTIFY%20bodies"></a><a class="selflink" href="#section-5.3.6" name="section-5.3.6">5.3.6</a>.  NOTIFY bodies</span>

   Bodies in NOTIFY requests for the "spirits-INDPs" package are
   optional.  If present, they MUST be of the MIME type
   "application/spirits-event+xml".  The body in a NOTIFY request
   encapsulates the following pieces of information which can be used by
   the subscriber:

      (1) The event that resulted in the NOTIFY being generated
      (typically, but not always, this will be the same event present in
      the corresponding SUBSCRIBE request).





<span class="grey">Gurbani, et al.             Standards Track                    [Page 17]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-18" id="page-18" name="page-18"> </a>
<span class="grey"><a href="rfc3910.html">RFC 3910</a>                    SPIRITS Protocol                October 2004</span>


      (2) The "mode" parameter; it is simply reflected back from the
      corresponding SUBSCRIBE request.

      (3) A list of values of the parameters associated with the event
      that the NOTIFY is being generated for.  Depending on the actual
      event, the list of the parameters will vary.

   If the subscriber armed multiple DPs as part of a single SUBSCRIBE
   request, all the un-encountered DPs that were part of the same
   SUBSCRIBE dialog MUST be dis-armed by the SPIRITS notifier and/or the
   SCF/SCP.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.3.7.%20%20Notifier%20processing%20of%20SUBSCRIBE%20requests"></a><a class="selflink" href="#section-5.3.7" name="section-5.3.7">5.3.7</a>.  Notifier processing of SUBSCRIBE requests</span>

   When the notifier receives a SUBSCRIBE request, it MUST authenticate
   the request and ensure that the subscriber is authorized to access
   the resource being subscribed to, in this case, PSTN/IN events on a
   certain PSTN line.

   Once the SUBSCRIBE request has been authenticated and authorized, the
   notifier interfaces with the SCF over interface D to arm the
   detection points corresponding to the PSTN line contained in the
   SUBSCRIBE body.  The particulars about interface D is out of scope
   for this document; here we will simply assume that the notifier can
   affect the arming (and disarming) of triggers in the PSTN through
   interface D.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.3.8.%20%20Notifier%20generation%20of%20NOTIFY%20requests"></a><a class="selflink" href="#section-5.3.8" name="section-5.3.8">5.3.8</a>.  Notifier generation of NOTIFY requests</span>

   If the notifier expects the arming of triggers to take more than 200
   ms, it MUST send a 202 response to the SUBSCRIBE request immediately,
   accepting the subscription.  It should then send a NOTIFY request
   with an empty body.  This NOTIFY request MUST have a "Subscription-
   State" header with a value of "pending".

         This immediate NOTIFY with an empty body is needed since the
         resource identified in the SUBSCRIBE request does not have as
         yet a meaningful state.

   Once the notifier has successfully interfaced with the SCF, it MUST
   send a subsequent NOTIFY request with an empty body and a
   "Subscription-State" header with a value of "active."

   When the event of interest identified in the SUBSCRIBE request
   occurs, the notifier sends out a new NOTIFY request which MUST
   contain a body (see <a href="#section-5.3.6">Section 5.3.6</a>).  The NOTIFY request MUST have a
   "Subscription-State" header and its value MUST be set to "terminated"
   with a reason parameter of "fired".



<span class="grey">Gurbani, et al.             Standards Track                    [Page 18]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-19" id="page-19" name="page-19"> </a>
<span class="grey"><a href="rfc3910.html">RFC 3910</a>                    SPIRITS Protocol                October 2004</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.3.9.%20%20Subscriber%20processing%20of%20NOTIFY%20requests"></a><a class="selflink" href="#section-5.3.9" name="section-5.3.9">5.3.9</a>.  Subscriber processing of NOTIFY requests</span>

   The exact steps executed at the subscriber when it gets a NOTIFY
   request will depend on the service being implemented.  As a
   generality, the UA associated with the subscriber should somehow
   impart this information to the user by visual or auditory means, if
   at all possible.

   If the NOTIFY request contained a "Subscription-State" header with a
   value of "terminated" and a reason parameter of "fired", the UA
   associated with the subscriber MAY initiate a new subscription for
   the event that was just reported through the NOTIFY request.

         Whether or not to initiate a new subscription when an existing
         one expires is up to the context of the service that is being
         implemented.  For instance, a user may configure her UA to
         always re-subscribe to the same event when it fires, but this
         is not necessarily the normative case.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.3.10.%20%20Handling%20of%20forked%20requests"></a><a class="selflink" href="#section-5.3.10" name="section-5.3.10">5.3.10</a>.  Handling of forked requests</span>

   Forking of SUBSCRIBE requests is prohibited.  Since the SUBSCRIBE
   request is targeted towards the PSTN, highly irregular behaviors
   occur if the request is allowed to fork.  The normal SIP DNS lookup
   and routing rules [<a href="#ref-11" title='"Session Initiation Protocol (SIP): Locating SIP Servers"'>11</a>] should result in a target set with exactly one
   element: the notifier.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.3.11.%20%20Rate%20of%20notifications"></a><a class="selflink" href="#section-5.3.11" name="section-5.3.11">5.3.11</a>.  Rate of notifications</span>

   For reasons of security more than network traffic, it is RECOMMENDED
   that the notifier issue two or, at most three NOTIFY requests for a
   subscription.  If the subscription was accepted with a 202 response,
   a NOTIFY will be sent immediately towards the subscriber.  This
   NOTIFY serves to inform the subscriber that the request has been
   accepted and is being acted on.

   Once the resource (detection points) identified in the SUBSCRIBE
   request have been initialized, the notifier MUST send a second NOTIFY
   request.  This request contains the base state of the resource.

   When an event of interest occurs which leads to the firing of the
   trigger associated with the detection points identified in the
   SUBSCRIBE request, a final NOTIFY is sent to the subscriber.  This
   NOTIFY request contains more information about the event of interest.







<span class="grey">Gurbani, et al.             Standards Track                    [Page 19]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-20" id="page-20" name="page-20"> </a>
<span class="grey"><a href="rfc3910.html">RFC 3910</a>                    SPIRITS Protocol                October 2004</span>


   If the subscription was accepted with a 200 response, the notifier
   simply sends two NOTIFY requests: one containing the base state of
   the resource, and the other containing information that lead to the
   firing of the detection point.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.3.12.%20%20State%20agents"></a><a class="selflink" href="#section-5.3.12" name="section-5.3.12">5.3.12</a>.  State agents</span>

   State agents are not used in SPIRITS.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.3.13.%20%20Examples"></a><a class="selflink" href="#section-5.3.13" name="section-5.3.13">5.3.13</a>.  Examples</span>

   This section contains example call flows for a SPIRITS service called
   Internet Caller-ID Delivery (ICID).  One of the benchmark SPIRITS
   service, as described in section 2.2 of [<a href="#ref-1" title='"The SPIRITS Architecture"'>1</a>] is Internet Caller-ID
   delivery:

      This service allows the subscriber to see the caller's number or
      name or both while being connected to the Internet.  If the
      subscriber has only one telephone line and is using the very line
      for the Internet connection, the service is a subset of the ICW
      service and follows the relevant description in <a href="#section-2.1">Section 2.1</a>.
      Otherwise, the subscriber's IP host serves as an auxiliary device
      of the telephone to which the call is first sent.

   We present an example of a SPIRITS call flow to realize this service.
   Note that this is an example only, not a normative description of the
   Internet Caller-ID service.

   Further text and details of SIP messages below refer to the call flow
   provided in Figure 3.  Figure 3 depicts the 4 entities that are an
   integral part of any SPIRITS service (the headings of the entities
   refer to the names established in Figure 1 in [<a href="#ref-1" title='"The SPIRITS Architecture"'>1</a>]) -- the SPIRITS
   subscriber, the SPIRITS notifier and the SCF.  Note that the SPIRITS
   gateway is not included in this figure; logically, SPIRITS messages
   flow between the SPIRITS server and the SPIRITS client.  A gateway,
   if present, may act as a proxy.















<span class="grey">Gurbani, et al.             Standards Track                    [Page 20]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-21" id="page-21" name="page-21"> </a>
<span class="grey"><a href="rfc3910.html">RFC 3910</a>                    SPIRITS Protocol                October 2004</span>


      SPIRITS server       SPIRITS client      SCF
      ("subscriber")        ("notifier")
         S                      N
         |                      |                |
         | F1 SUBSCRIBE         |                |
         +---------------------&gt;+                |
         |                      |                |
         |                      | F2 Arm DP      |
         |     F3 200 OK (SUBS) +---------------&gt;|
         |&lt;---------------------|                |
         |                      |                |
         |            F4 NOTIFY |                |
         |&lt;---------------------+                |
         |                      |                |
         |      F5 200 OK (NOT) |                |
         +---------------------&gt;|                |
         |                      |                |
         ~                      ~                ~
         ~                      ~                ~
         |                      |  F6 Evt. Not.  |
         |                      |&lt;---------------+
         |            F7 NOTIFY +                |
         |&lt;---------------------|                |
         |                      |                |
         |      F8 200 OK (NOT) |                |
         +---------------------&gt;|                |
         |                      |                |
         |                      |                |
        \|/                    \|/              \|/
         v                      v                v

                        Figure 3: Sample call flow

   This call flow depicts an overall operation of a "subscriber"
   successfully subscribing to the IN Termination_Attempt_Authorized DP
   (the "subscriber" is assumed to be a user, possibly at work, who is
   interested in knowing when he/she gets a phone call to his/her home
   phone number) -- this interaction is captured in messages F1 through
   F8 in Figure 3.  The user sends (F1) a SIP SUBSCRIBE request
   identifying the DP it is interested in along with zero or more
   parameters relevant to that DP (in this example, the
   Termination_Attempt_DP will be employed).  The SPIRITS notifier in
   turns interacts with the SCF to arm the Termination_Attempt_DP for
   the service (F2).  An immediate NOTIFY with the current state
   information is send to the subscriber (F4, F5).






<span class="grey">Gurbani, et al.             Standards Track                    [Page 21]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-22" id="page-22" name="page-22"> </a>
<span class="grey"><a href="rfc3910.html">RFC 3910</a>                    SPIRITS Protocol                October 2004</span>


   At some point  after the above sequence of events has transpired, the
   PSTN gets a call to the users phone.  The SSF informs the SCF of this
   event when it encounters an armed Termination_Attempt_DP (not shown
   in Figure 3).  The SCF informs the SPIRITS notifier of this event
   (F6).

   When the SPIRITS notifier receives this event, it forms a SIP NOTIFY
   request and directs it to the SPIRITS subscriber (F7).  This NOTIFY
   will contain all the information elements necessary to identify the
   caller to the subscriber.  The subscriber, upon receiving the
   notification (F8) may pop open a window with the date/time and the
   number of the caller.

   The rest of this section contains the details of the SIP messages in
   Figure 3.  The call flow details below assume that the SPIRITS
   gateway is, for the purpose of this example, a SIP proxy that serves
   as the default outbound proxy for the notifier and an ingress host of
   the myprovider.com domain for the subscriber.  The subscriber and
   notifier may be in separate administrative domains.

   F1: S-&gt;N

   SUBSCRIBE sip:myprovider.com SIP/2.0
   From: &lt;sip:vkg@example.com&gt;;tag=8177-afd-991
   To: &lt;sip:16302240216@myprovider.com&gt;
   CSeq: 18992 SUBSCRIBE
   Call-ID: 3329as77@host.example.com
   Contact: &lt;sip:vkg@host.example.com&gt;
   Via: SIP/2.0/UDP host.example.com;branch=z9hG4bK776asdhds
   Expires: 3600
   Event: spirits-INDPs
   Allow-Events: spirits-INDPs, spirits-user-prof
   Accept: application/spirits-event+xml
   Content-Type: application/spirits-event+xml
   Content-Length: ...

   &lt;?xml version="1.0" encoding="UTF-8"?&gt;
   &lt;spirits-event xmlns="urn:ietf:params:xml:ns:spirits-1.0"&gt;
      &lt;Event type="INDPs" name="TAA" mode="N"&gt;
            &lt;CalledPartyNumber&gt;6302240216&lt;/CalledPartyNumber&gt;
      &lt;/Event&gt;
   &lt;/spirits-event&gt;

   The subscriber forms a SIP SUBSCRIBE request which identifies the DP
   that it wants to subscribe to (in this case, the TAA DP) and the
   actual line it wants that DP armed for (in this case, the line





<span class="grey">Gurbani, et al.             Standards Track                    [Page 22]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-23" id="page-23" name="page-23"> </a>
<span class="grey"><a href="rfc3910.html">RFC 3910</a>                    SPIRITS Protocol                October 2004</span>


   associated with the phone number 6302240216).  This request
   eventually arrives at the SIPRITS notifier, N, which authenticates it
   (not shown) and sends a successful response to the subscriber:

   F3: N-&gt;S

   SIP/2.0 200 OK
   From: &lt;sip:vkg@example.com&gt;;tag=8177-afd-991
   To: &lt;sip:16302240216@myprovider.com&gt;;tag=SPIRITS-TAA-6302240216
   CSeq: 18992 SUBSCRIBE
   Call-ID: 3329as77@host.example.com
   Contact: &lt;sip:notifier.myprovider.com&gt;
   Via: SIP/2.0/UDP host.example.com;branch=z9hG4bK776asdhds
   Expires: 3600
   Accept: application/spirits-event+xml
   Content-Length: 0

   The notifier interacts with the SCF to arm the DP and also sends an
   immediate NOTIFY towards the subscriber informing the subscriber of
   the current state of the notification:

   F4: N-&gt;S

   NOTIFY sip:vkg@host.example.com SIP/2.0
   From: &lt;sip:16302240216@myprovider.com&gt;;tag=SPIRITS-TAA-6302240216
   To: &lt;sip:vkg@example.com&gt;;tag=8177-afd-991
   Via: SIP/2.0/UDP gateway.myprovider.com;branch=z9hG4bK-9$0-1
   Via: SIP/2.0/UDP notifier.myprovider.com;branch=z9hG4bKqo--9
   Call-ID: 3329as77@host.example.com
   Contact: &lt;sip:notifier.myprovider.com&gt;
   Subscription-State: active
   CSeq: 3299 NOTIFY
   Accept: application/spirits-event+xml
   Content-Length: 0

   F5: S-&gt;N

   SIP/2.0 200 OK
   From: &lt;sip:16302240216@myprovider.com&gt;;tag=SPIRITS-TAA-6302240216
   To: &lt;sip:vkg@example.com&gt;;tag=8177-afd-991
   Via: SIP/2.0/UDP gateway.myprovider.com;branch=z9hG4bK-9$0-1
   Via: SIP/2.0/UDP notifier.myprovider.com;branch=z9hG4bKqo--9
   Call-ID: 3329as77@host.example.com
   Contact: &lt;sip:vkg@host.example.com&gt;
   CSeq: 3299 NOTIFY
   Accept: application/spirits-event+xml
   Content-Length: 0




<span class="grey">Gurbani, et al.             Standards Track                    [Page 23]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-24" id="page-24" name="page-24"> </a>
<span class="grey"><a href="rfc3910.html">RFC 3910</a>                    SPIRITS Protocol                October 2004</span>


   At some later point in time (before the subscription established in
   F1 expires at the notifier), a call arrives at the number identified
   in XML-encoded body of F1 -- 6302240216.  The SCF notifies the
   notifier (F6).  Included in this notification is the relevant
   information from the PSTN, namely, the phone number of the party
   attempting to call 6302240216.  The notifier uses this information to
   create a SIP NOTIFY request and sends it to the subscriber.  The SIP
   NOTIFY request has a XML-encoded body with the relevant information
   from the PSTN:

   F7: N-&gt;S

   NOTIFY sip:vkg@host.example.com SIP/2.0
   From: &lt;sip:16302240216@myprovider.com&gt;;tag=SPIRITS-TAA-6302240216
   To: &lt;sip:vkg@example.com&gt;;tag=8177-afd-991
   Via: SIP/2.0/UDP notifier.myprovider.com;branch=z9hG4bK9inn-=u7
   Call-ID: 3329as77@host.example.com
   Contact: &lt;sip:notifier.myprovider.com&gt;
   CSeq: 3300 NOTIFY
   Subscription-State: terminated;reason=fired
   Accept: application/spirits-event+xml
   Event: spirits-INDPs
   Allow-Events: spirits-INDPs, spirits-user-prof
   Content-Type: application/spirits-event+xml
   Content-Length: ...

   &lt;?xml version="1.0" encoding="UTF-8"?&gt;
   &lt;spirits-event xmlns="urn:ietf:params:xml:ns:spirits-1.0"&gt;
      &lt;Event type="INDPs" name="TAA" mode="N"&gt;
            &lt;CalledPartyNumber&gt;6302240216&lt;/CalledPartyNumber&gt;
            &lt;CallingPartyNumber&gt;3125551212&lt;/CallingPartyNumber&gt;
      &lt;/Event&gt;
   &lt;/spirits-event&gt;

   There are two important issues to note in the call flows for F7:

      (1) The body of the NOTIFY request contains the information passed
          to the SPIRITS notifier from the SCF.  In this particular
          example, this is the phone number of the party (3125551212)
          that attempted to call 6302240216.

      (2) Since the notification occurred, the subscription established
          in F1 terminated (as evident by the Subscription-State
          header).  The subscription terminated normally due to the DP
          associated with TAA firing (hence the reason code of "fired"
          in the Subscription-State header).  If the subscriber





<span class="grey">Gurbani, et al.             Standards Track                    [Page 24]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-25" id="page-25" name="page-25"> </a>
<span class="grey"><a href="rfc3910.html">RFC 3910</a>                    SPIRITS Protocol                October 2004</span>


          wants to get notified of another attempt to call the number
          6302240216, he/she should send a new SUBSCRIBE request to the
          notifier.

   The subscriber can take any appropriate action upon the receipt of
   the NOTIFY in F7.  A reasonable implementation may pop up a window
   populated with the information contained in the body of F12, along
   with a button asking the subscriber if they would like to re-
   subscribe to the same event.  Alternatively, a re-subscription could
   be generated automatically by the subscriber's UA based on his/her
   preferences.

   To complete the protocol, the subscriber also sends a 200 OK message
   towards the notifier:

   F8: S-&gt;N

   200 OK SIP/2.0
   From: &lt;sip:16302240216@myprovider.com&gt;;tag=SPIRITS-TAA-6302240216
   To: &lt;sip:vkg@example.com&gt;;tag=8177-afd-991
   Via: SIP/2.0/UDP notifier.myprovider.com;z9hG4bK9inn-=u7
   Call-ID: 3329as77@host.example.com
   CSeq: 3300 NOTIFY
   Content-Length: 0

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.3.14.%20%20Use%20of%20URIs%20to%20retrieve%20state"></a><a class="selflink" href="#section-5.3.14" name="section-5.3.14">5.3.14</a>.  Use of URIs to retrieve state</span>

   The "spirits-INDPs" package MUST NOT use URIs to retrieve state.  It
   is expected that most state information for this package is compact
   enough to fit in a SIP message.  However, to err on the side of
   caution, implementations MUST follow the convention outlined in
   Section 18.1.1 of [<a href="#ref-5" title='"SIP: Session Initiation Protocol"'>5</a>] and use a congestion controlled transport if
   the size of the request is within 200 bytes of the path MTU if known,
   or if the request size is larger than 1300 bytes and the path MTU is
   unknown.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.4.%20%20Services%20through%20static%20DPs"></a><a class="selflink" href="#section-5.4" name="section-5.4">5.4</a>.  Services through static DPs</span>

   We mentioned in <a href="#section-5.1">Section 5.1</a> that the first trigger that fires during
   call processing is typically a TDP since there isn't any pre-existing
   control relationship between the SSF and the SCF.  Some Internet
   hosts may have expressed an interest in executing services based on
   TDPs (through an a-priori arrangement, which is not a part of this
   specification).  Thus, the PSTN will notify such hosts.  To do so, it
   will send a SIP request (typically an INVITE) towards the Internet
   host.  The body of the SIP request MUST contain multi-part MIME with
   two MIME components: the first part corresponding to the normal
   payload, if any, of the request; and the second part will contain



<span class="grey">Gurbani, et al.             Standards Track                    [Page 25]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-26" id="page-26" name="page-26"> </a>
<span class="grey"><a href="rfc3910.html">RFC 3910</a>                    SPIRITS Protocol                October 2004</span>


   SPIRITS-specific information (e.g., the DP that fired).  Responses to
   the INVITE request, or subsequent SUBSCRIBE messages from the
   Internet host to the PSTN within a current call context may result in
   EDPs being armed.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.4.1.%20%20Internet%20Call%20Waiting%20%28ICW%29"></a><a class="selflink" href="#section-5.4.1" name="section-5.4.1">5.4.1</a>.  Internet Call Waiting (ICW)</span>

   ICW as a benchmark SPIRITS service actually predates SPIRITS itself.
   Pre-SPIRITS implementations of ICW are detailed in [<a href="#ref-10" title='"Pre-Spirits Implementations of PSTN-initiated Services"'>10</a>].  However, as
   the document notes, while a diversity of implementations exists,
   these implementations are not interoperable.  At the time [<a href="#ref-10" title='"Pre-Spirits Implementations of PSTN-initiated Services"'>10</a>] was
   published, the industry did not have the depth of experience with SIP
   as is the case now.  The use of SIP in [<a href="#ref-10" title='"Pre-Spirits Implementations of PSTN-initiated Services"'>10</a>] does not constitute
   normative usage of SIP as described in [<a href="#ref-5" title='"SIP: Session Initiation Protocol"'>5</a>]; for instance, no mention
   is made of the SDP (if any) in the initial INVITE (especially since
   this pertains to "accept the call using VoIP" case).  Thus this
   section serves to provide a normative description of ICW in SPIRITS.

   The description of ICW is deceptively simple: it is a service most
   useful for single line phone subscribers that use the line to
   establish an Internet session.  In a nutshell, the service enables a
   subscriber engaged in an Internet dial-up session to

      o  be notified of an incoming call to the very same telephone line
         that is being used for the Internet connection,

      o  specify the desirable treatment of the call, and

      o  have the call handled as specified.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.4.2.%20%20Call%20disposition%20choices"></a><a class="selflink" href="#section-5.4.2" name="section-5.4.2">5.4.2</a>.  Call disposition choices</span>

   Section 2 of [<a href="#ref-10" title='"Pre-Spirits Implementations of PSTN-initiated Services"'>10</a>] details the call disposition outcome of a ICW
   session.  They are reproduced here as a numbered list for further
   discussion:

      1. Accepting the call over the PSTN line, thus terminating the
      Internet (modem) connection

      2. Accepting the call over the Internet using Voice over IP (VoIP)

      3.  Rejecting the call

      4. Playing a pre-recorded message to the calling party and
      disconnecting the call

      5. Forwarding the call to voice mail




<span class="grey">Gurbani, et al.             Standards Track                    [Page 26]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-27" id="page-27" name="page-27"> </a>
<span class="grey"><a href="rfc3910.html">RFC 3910</a>                    SPIRITS Protocol                October 2004</span>


      6. Forwarding the call to another number

      7. Rejecting (or Forwarding) on no Response - If the subscriber
      fails to respond within a certain period of time after the dialog
      box has been displayed, the incoming call can be either rejected
      or handled based on the treatment pre-defined by the subscriber.

   It should be pointed out for the sake of completeness that ICW as a
   SPIRITS service is not possible without making the SCP aware of the
   fact that the subscriber line is being used for an Internet session.
   That awareness, however, is not a part of the ICW service, but solely
   a pre-requisite.  One of the following three methods MUST be utilized
   to impart this information to the SCP:

      A. ICW subscriber based method: the ICW client on the subscriber's
      PC notifies the SCP of the Internet session by issuing a SIP
      REGISTER request.

      B. IN based method: SCP maintains a list of Internet Service
      Provider (ISP) access numbers for a geographical area; when one of
      these numbers is dialed and connected to, it (the SCP) assumes
      that the calling party is engaged in an Internet session.

      C. Any combination of methods A and B.

   ICW depends on a TDP to be provisioned in the SSP.  When the said TDP
   is encountered, the SSP suspends processing of the call and sends a
   request to the SPIRITS-capable SCP.  The SCP determines that the
   subscriber line is being used for an Internet session.  It instructs
   the SPIRITS notifier on the SCP to create a SIP INVITE request and
   send it to the SPIRITS subscriber running on the subscriber's IP
   host.

   The SPIRITS subscriber MUST return one of the possible call
   disposition outcomes catalogued in <a href="#section-5.4.2">Section 5.4.2</a>.  Note that outcomes
   1 and 4 through 7 can all be coalesced into one case, namely
   redirecting (using the SIP 3xx response code) the call to an
   alternative SIP URI.  In case of 1, the URI of the redirected call
   MUST match the very same number being used by the customer to get
   online.  Rejecting the call implies sending a non-2xx and non-3xx
   final response; the remaining outcomes result in the call being
   redirected to an alternate URI which provides the desired service
   (i.e., play a pre-recorded announcement, or record a voice message).








<span class="grey">Gurbani, et al.             Standards Track                    [Page 27]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-28" id="page-28" name="page-28"> </a>
<span class="grey"><a href="rfc3910.html">RFC 3910</a>                    SPIRITS Protocol                October 2004</span>


   Further processing of a SPIRITS notifier when it receives a final
   response can be summarized by the following steps:

      1. If the response is a 4xx, 5xx, or 6xx class of response,
      generate and transmit an ACK request and instruct the SSP to play
      a busy tone to the caller.

      2. Else, for all 3xx responses, generate and transmit an ACK
      request, and compare the redirected URI to the subscriber's line
      number:

         2a.  If the comparison indicates a match, instruct the SSP to
         hold onto the call for just enough time to allow the SPIRITS
         subscriber to disconnect the modem, thus freeing up the line;
         and then continue with normal call processing, which will
         result in the subscriber's phone to ring.

         2b.  If the comparison fails, instruct the SSP to route the
         call to the redirected URI.

      3. Else, for a 2xx response, follow the steps in <a href="#section-5.4.3">section 5.4.3</a>.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.4.3.%20%20Accepting%20an%20ICW%20session%20using%20VoIP"></a><a class="selflink" href="#section-5.4.3" name="section-5.4.3">5.4.3</a>.  Accepting an ICW session using VoIP</span>

   One call handling option in ICW is to "accept an incoming call using
   VoIP".  The SPIRITS notifier has no way of knowing a-priori if the
   subscriber (callee) will be choosing this option; nonetheless, it has
   to account for such a choice by adding a SDP in the body of the
   INVITE request.  A possible way of accomplishing this is to have the
   SPIRITS notifier control a PSTN gateway and allocate appropriate
   resources on it.  Once this is done, the SPIRITS notifier adds
   network information (IP address of the gateway and port numbers where
   media will be received) and codec information as the SDP portion of
   the body in the INVITE request.  SPIRITS requires the DP information
   to be carried in the request body as well.  To that extent, the
   SPIRITS notifier MUST also add the information associated with the
   TDP that triggered the service.  Thus, the body of the INVITE MUST
   contain multi-part MIME, with two components.

   The SPIRITS notifier transmits the INVITE request to the subscriber
   and now waits for a final response.  Further processing when the
   SPIRITS subscriber returns a 200 OK MUST be handled as follows:

      On the receipt of a 200 OK containing the SDP of the subscriber's
      UA, the SPIRITS notifier will instruct the SSP to terminate the
      call on a pre-allocated port on the gateway.  This port MUST be
      correlated by the gateway to the SDP that was sent in the earlier
      INVITE.



<span class="grey">Gurbani, et al.             Standards Track                    [Page 28]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-29" id="page-29" name="page-29"> </a>
<span class="grey"><a href="rfc3910.html">RFC 3910</a>                    SPIRITS Protocol                October 2004</span>


   The end result is that the caller and callee hold a voice session
   with part of the session occurring over VoIP.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20Non-call%20related%20events"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  Non-call related events</span>

   There are network events that are not related to setting up,
   maintaining, or tearing down voice calls.  Such events occur on the
   cellular wireless network and can be used by SPIRITS to provide
   services.  The SPIRITS protocol requirement explicitly includes the
   following events for which SPIRITS notification is needed
   (<a href="rfc3298.html">RFC3298</a>:<a href="#section-5">Section 5</a>(b)):

   1. Location update in the same Visitor Location Register (VLR)
      service area

   2. Location update in another VLR service area

   3. International Mobile Subscriber Identity (IMSI) attach

   4. Mobile Subscriber (MS) initiated IMSI detach

   5. Network initiated IMSI detach

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.1.%20%20Non-call%20events%20and%20their%20required%20parameters"></a><a class="selflink" href="#section-6.1" name="section-6.1">6.1</a>.  Non-call events and their required parameters</span>

   Each of the five non-call related event is given a SPIRITS-specific
   mnemonic for use in subscriptions and notifications.

   Location update in the same VLR area
   SPIRITS mnemonic: LUSV
   Mandatory parameter in SUBSCRIBE: CalledPartyNumber
   Mandatory parameter in NOTIFY: CalledPartyNumber, Cell-ID

   Cell-ID: A string used to identify the serving Cell-ID.  The actual
   length and representation of this parameter depend on the particulars
   of the cellular provider's network.

   Location update in different VLR area
   SPIRITS mnemonic: LUDV
   Mandatory parameter in SUBSCRIBE: CalledPartyNumber
   Mandatory parameter in NOTIFY: CalledPartyNumber, Cell-ID

   IMSI attach
   SPIRITS mnemonic: REG
   Mandatory parameter in SUBSCRIBE: CalledPartyNumber
   Mandatory parameter in NOTIFY: CalledPartyNumber, Cell-ID





<span class="grey">Gurbani, et al.             Standards Track                    [Page 29]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-30" id="page-30" name="page-30"> </a>
<span class="grey"><a href="rfc3910.html">RFC 3910</a>                    SPIRITS Protocol                October 2004</span>


   MS initiated IMSI detach
   SPIRITS mnemonic: UNREGMS
   Mandatory parameter in SUBSCRIBE: CalledPartyNumber
   Mandatory parameter in NOTIFY: CalledPartyNumber

   Network initiated IMSI detach
   SPIRITS mnemonic: UNREGNTWK
   Mandatory parameter in SUBSCRIBE: CalledPartyNumber
   Mandatory parameter in NOTIFY: CalledPartyNumber

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.2.%20%20Normative%20usage"></a><a class="selflink" href="#section-6.2" name="section-6.2">6.2</a>.  Normative usage</span>

   A subscriber will issue a SUBSCRIBE request which identifies a set of
   non-call related PSTN events it is interested in getting the
   notification of.  This set MAY contain exactly one event, or it MAY
   contain multiple events.  The SUBSCRIBE request is routed to the
   notifier where it is accepted, pending a successful authentication.

   When any of the events identified in the set occurs, the notifier
   will format a NOTIFY request and direct it towards the subscriber.
   The NOTIFY request will contain information pertinent to the one of
   the event whose notification was requested.

   The dialog established by the SUBSCRIBE persists until it expires
   normally, or is explicitly expired by the subscriber.  This behavior
   is different than the behavior for subscriptions associated with the
   "spirits-INDPs" package.  In the cellular network, the events
   subscribed for may occur at a far greater frequency than those
   compared to the wireline network (consider location updates as a
   cellular user moves around).  Thus it is far more expedient to allow
   the subscription to expire normally.

   When a subscriber receives a NOTIFY request, it can subsequently
   choose to act in a manner appropriate to the notification.

   The remaining sections fill in the specific package responsibilities
   raised in <a href="rfc3265.html">RFC3265</a> [<a href="#ref-3" title='"Session Initiation Protocol (SIP)-Specific Event Notification"'>3</a>], Section 4.4.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.3.%20%20Event%20package%20name"></a><a class="selflink" href="#section-6.3" name="section-6.3">6.3</a>.  Event package name</span>

   This document defines two event packages; the first was defined in
   <a href="#section-5.3">Section 5.3</a>.  The second package, defined in this section is called
   "spirits-user-prof".  This package MUST be used for events
   corresponding to non-call related events in the cellular network.
   All entities that implement the SPIRITS protocol and support the
   non-call related events outlined in the SPIRITS protocol requirements





<span class="grey">Gurbani, et al.             Standards Track                    [Page 30]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-31" id="page-31" name="page-31"> </a>
<span class="grey"><a href="rfc3910.html">RFC 3910</a>                    SPIRITS Protocol                October 2004</span>


   (<a href="rfc3298.html">RFC3298</a>:<a href="#section-5">Section 5</a>(b)) MUST set the "Event" header request header[3]
   to "spirits-user-prof."  The "Allow-Events" general header [<a href="#ref-3" title='"Session Initiation Protocol (SIP)-Specific Event Notification"'>3</a>] MUST
   include the token "spirits-user-prof" as well.

   Example:

   Event: spirits-user-prof
   Allow-Events: spirits-user-prof, spirits-INDPs

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.4.%20%20Event%20package%20parameters"></a><a class="selflink" href="#section-6.4" name="section-6.4">6.4</a>.  Event package parameters</span>

   The "spirits-user-prof" event package does not support any additional
   parameters to the Event header

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.5.%20%20SUBSCRIBE%20bodies"></a><a class="selflink" href="#section-6.5" name="section-6.5">6.5</a>.  SUBSCRIBE bodies</span>

   SUBSCRIBE requests that serve to terminate the subscriptions MAY
   contain an empty body; however, SUBSCRIBE requests that establish a
   dialog MUST contain a body which encodes two pieces of information:

      (1) The set of events that is being subscribed to.  A subscriber
      MAY subscribe to multiple events in one SUBSCRIBE request, or MAY
      issue a different SUBSCRIBE request for each event it is
      interested in receiving a notification for.  The protocol allows
      for both forms of representation.  However, note that if one
      SUBSCRIBE is used to subscribe to multiple events, then an expiry
      for the dialog associated with that subscription affects all such
      events.

      (2) A list of values of the parameters associated with the event.
      Please see <a href="#section-6.1">Section 6.1</a> for a list of parameters associated with
      each event.

   The default body type for SUBSCRIBEs in SPIRITS is denoted by the
   MIME type "application/spirits-event+xml".  The "Accept" header, if
   present, MUST include this MIME type.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.6.%20%20Subscription%20duration"></a><a class="selflink" href="#section-6.6" name="section-6.6">6.6</a>.  Subscription duration</span>

   The duration of a dialog established by a SUBSCRIBE request is
   limited to the expiration time negotiated between the subscriber and
   notifier when the dialog was established.  The subscriber MUST send a
   new SUBSCRIBE to refresh the dialog if it is interested in keeping it
   alive.  A dialog can be terminated by sending a new SUBSCRIBE request
   with an "Expires" header value of 0, as outlined in [<a href="#ref-3" title='"Session Initiation Protocol (SIP)-Specific Event Notification"'>3</a>].






<span class="grey">Gurbani, et al.             Standards Track                    [Page 31]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-32" id="page-32" name="page-32"> </a>
<span class="grey"><a href="rfc3910.html">RFC 3910</a>                    SPIRITS Protocol                October 2004</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.7.%20%20NOTIFY%20bodies"></a><a class="selflink" href="#section-6.7" name="section-6.7">6.7</a>.  NOTIFY bodies</span>

   Bodies in NOTIFY requests for the "spirits-user-prof" package are
   optional.  If present, they MUST be of the MIME type
   "application/spirits-event+xml".  The body in a NOTIFY request
   encapsulates the following pieces of information which can be used by
   the subscriber:

      (1) The event that resulted in the NOTIFY being generated
      (typically, but not always, this will be the same event present in
      the corresponding SUBSCRIBE request).

      (2) A list of values of the parameters associated with the event
      that the NOTIFY is being generated for.  Depending on the actual
      event, the list of the parameters will vary.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.8.%20%20Notifier%20processing%20of%20SUBSCRIBE%20requests"></a><a class="selflink" href="#section-6.8" name="section-6.8">6.8</a>.  Notifier processing of SUBSCRIBE requests</span>

   When the notifier receives a SUBSCRIBE request, it MUST authenticate
   the request and ensure that the subscriber is authorized to access
   the resource being subscribed to, in this case, non-call related
   cellular events for a mobile phone.

   Once the SUBSCRIBE request has been authenticated and authorized, the
   notifier interfaces with the SCF over interface D to set marks in the
   HLR corresponding to the mobile phone number contained in the
   SUBSCRIBE body.  The particulars of interface D are outside the scope
   of this document; here we simply assume that the notifier is able to
   set the appropriate marks in the HLR.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.9.%20%20Notifier%20generation%20of%20NOTIFY%20requests"></a><a class="selflink" href="#section-6.9" name="section-6.9">6.9</a>.  Notifier generation of NOTIFY requests</span>

   If the notifier expects the setting of marks in the HLR to take more
   than 200 ms, it MUST send a 202 response to the SUBSCRIBE request
   immediately, accepting the subscription.  It should then send a
   NOTIFY request with an empty body.  This NOTIFY request MUST have a
   "Subscription-State" header with a value of "pending".

      This immediate NOTIFY with an empty body is needed since the
      resource identified in the SUBSCRIBE request does not have as yet
      a meaningful state.

   Once the notifier has successfully interfaced with the SCF, it MUST
   send a subsequent NOTIFY request with an empty body and a
   "Subscription-State" header with a value of "active."






<span class="grey">Gurbani, et al.             Standards Track                    [Page 32]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-33" id="page-33" name="page-33"> </a>
<span class="grey"><a href="rfc3910.html">RFC 3910</a>                    SPIRITS Protocol                October 2004</span>


   When the event of interest identified in the SUBSCRIBE request
   occurs, the notifier sends out a new NOTIFY request which MUST
   contain a body as described in <a href="#section-6.7">Section 6.7</a>.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.10.%20%20Subscriber%20processing%20of%20NOTIFY%20requests"></a><a class="selflink" href="#section-6.10" name="section-6.10">6.10</a>.  Subscriber processing of NOTIFY requests</span>

   The exact steps executed at the subscriber when it receives a NOTIFY
   request depend on the nature of the service that is being
   implemented.  As a generality, the UA associated with the subscriber
   should somehow impart this information to the user by visual or
   auditory means, if at all possible.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.11.%20%20Handling%20of%20forked%20requests"></a><a class="selflink" href="#section-6.11" name="section-6.11">6.11</a>.  Handling of forked requests</span>

   Forking of SUBSCRIBE requests is prohibited.  Since the SUBSCRIBE
   request is targeted towards the PSTN, highly irregular behaviors
   occur if the request is allowed to fork.  The normal SIP DNS lookup
   and routing rules [<a href="#ref-11" title='"Session Initiation Protocol (SIP): Locating SIP Servers"'>11</a>] should result in a target set with exactly one
   element: the notifier.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.12.%20%20Rate%20of%20notifications"></a><a class="selflink" href="#section-6.12" name="section-6.12">6.12</a>.  Rate of notifications</span>

   For reasons of congestion control, it is important that the rate of
   notifications not become excessive.  For instance, if a subscriber
   subscribes to the location update event for a notifier moving through
   the cellular network at a high enough velocity, it is entirely
   conceivable that the notifier may generate many NOTIFY requests in a
   small time frame.  Thus, within this package, the location update
   event needs an appropriate throttling mechanism.

   Whenever a SPIRITS notifier sends a location update NOTIFY, it MUST
   start a timer (Tn) with a value of 15 seconds.  If a subsequent
   location update NOTIFY request needs to be sent out before the timer
   has expired, it MUST be discarded.  Any future location update NOTIFY
   requests MUST be transmitted only if Tn has expired (i.e. 15 seconds
   have passed since the last NOTIFY request was send out).  If a
   location update NOTIFY is send out, Tn should be reset to go off
   again in 15 seconds.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.13.%20%20State%20agents"></a><a class="selflink" href="#section-6.13" name="section-6.13">6.13</a>.  State agents</span>

   State agents are not used in SPIRITS.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.14.%20%20Examples"></a><a class="selflink" href="#section-6.14" name="section-6.14">6.14</a>.  Examples</span>

   This section contains an example of a SPIRITS service that may be
   used to update the presence status of a mobile user.  The call flow
   is depicted in Figure 4 below.



<span class="grey">Gurbani, et al.             Standards Track                    [Page 33]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-34" id="page-34" name="page-34"> </a>
<span class="grey"><a href="rfc3910.html">RFC 3910</a>                    SPIRITS Protocol                October 2004</span>


      SPIRITS server       SPIRITS client      SCF
      ("subscriber")        ("notifier")
         S                      N
         |                      |                |
         | F1 SUBSCRIBE         |                |
         +---------------------&gt;+                |
         |                      |                |
         |                      | F2 Set HLR mark|
         |     F3 200 OK (SUBS) +---------------&gt;|
         |&lt;---------------------|                |
         |                      |                |
         |            F4 NOTIFY |                |
         |&lt;---------------------+                |
         |                      |                |
         |      F5 200 OK (NOT) |                |
         +---------------------&gt;|                |
         |                      |                |
         ~                      ~                ~
         ~                      ~                ~
         |                      |  F6 Evt. Not.  |
         |                      |&lt;---------------+
         |            F7 NOTIFY +                |
         |&lt;---------------------|                |
         |                      |                |
         |      F8 200 OK (NOT) |                |
         +---------------------&gt;|                |
         |                      |                |
         |                      |                |
        \|/                    \|/              \|/
         v                      v                v

                     Figure 4: Sample call flow

   In F1 of Figure 4, the subscriber indicates an interest in receiving
   a notification when a mobile user registers with the cellular
   network.  The cellular network notes this event (F2) and confirms the
   subscription (F3-F5).  When the mobile user turns on her cell phone
   and registers with the network, this event is detected (F6).  The
   cellular network then sends out a notification to the subscriber
   informing it of this event (F7-F8).

   We present the details of the call flow next.

   In F1, the subscriber subscribes to the registration event (REG) of a
   cellular phone number.






<span class="grey">Gurbani, et al.             Standards Track                    [Page 34]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-35" id="page-35" name="page-35"> </a>
<span class="grey"><a href="rfc3910.html">RFC 3910</a>                    SPIRITS Protocol                October 2004</span>


   F1: S-&gt;N
   SUBSCRIBE sip:myprovider.com SIP/2.0
   From: &lt;sip:vkg@example.com&gt;;tag=8177-afd-991
   To: &lt;sip:16302240216@myprovider.com&gt;
   CSeq: 18992 SUBSCRIBE
   Call-ID: 3329as77@host.example.com
   Contact: &lt;sip:vkg@host.example.com&gt;
   Via: SIP/2.0/UDP host.example.com;branch=z9hG4bK776asdhdsa8
   Expires: 3600
   Event: spirits-user-prof
   Allow-Events: spirits-INDPs, spirits-user-prof
   Accept: application/spirits-event+xml
   Content-Type: application/spirits-event+xml
   Content-Length: ...

   &lt;?xml version="1.0" encoding="UTF-8"?&gt;
   &lt;spirits-event xmlns="urn:ietf:params:xml:ns:spirits-1.0"&gt;
      &lt;Event type="userprof" name="REG"&gt;
            &lt;CalledPartyNumber&gt;6302240216&lt;/CalledPartyNumber&gt;
      &lt;/Event&gt;
   &lt;/spirits-event&gt;

   The subscription reaches the notifier which authenticates the request
   (not shown) and interacts with the SCF to update the subscribers
   database for this event.  The notifier sends out a successful
   response to the subscription:

   F3: N-&gt;S
   SIP/2.0 200 OK
   From: &lt;sip:vkg@example.com&gt;;tag=8177-afd-991
   To: &lt;sip:16302240216@myprovider.com&gt;;tag=SPIRITS-REG-16302240216
   CSeq: 18992 SUBSCRIBE
   Call-ID: 3329as77@host.example.com
   Contact: &lt;sip:notifier.myprovider.com&gt;
   Via: SIP/2.0/UDP host.example.com;branch=z9hG4bK776asdhdsa8
   Expires: 3600
   Allow-Events: spirits-INDPs, spirits-user-prof
   Accept: application/spirits-event+xml
   Content-Length: 0

   The notifier also sends out a NOTIFY request confirming the
   subscription:

   F4: N-&gt;S
   NOTIFY sip:vkg@host.example.com SIP/2.0
   To: &lt;sip:vkg@example.com&gt;;tag=8177-afd-991
   From: &lt;sip:16302240216@myprovider.com&gt;;tag=SPIRITS-REG-16302240216
   CSeq: 9121 NOTIFY



<span class="grey">Gurbani, et al.             Standards Track                    [Page 35]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-36" id="page-36" name="page-36"> </a>
<span class="grey"><a href="rfc3910.html">RFC 3910</a>                    SPIRITS Protocol                October 2004</span>


   Call-ID: 3329as77@host.example.com
   Contact: &lt;sip:notifier.myprovider.com&gt;
   Subscription-State: active
   Via: SIP/2.0/UDP notifier.myprovider.com;branch=z9hG4bK7007-091a
   Allow-Events: spirits-INDPs, spirits-user-prof
   Accept: application/spirits-event+xml
   Content-Length: 0

   The subscriber confirms the receipt of the NOTIFY request:

   F5: S-&gt;N
   SIP/2.0 200 OK
   To: &lt;sip:vkg@example.com&gt;;tag=8177-afd-991
   From: &lt;sip:16302240216@myprovider.com&gt;;tag=SPIRITS-REG-16302240216
   CSeq: 9121 NOTIFY
   Call-ID: 3329as77@host.example.com
   Contact: &lt;sip:vkg@host.example.com&gt;
   Via: SIP/2.0/UDP notifier.myprovider.com;branch=z9hG4bK7007-091a
   Content-Length: 0

   In F6, the mobile user identified by the PSTN number "6302240216"
   turns the mobile phone on, thus causing it to register with the
   cellular network.  The cellular network detects this event, and since
   a subscriber has indicated an interest in receiving a notification of
   this event, a SIP NOTIFY request is transmitted towards the
   subscriber:

   F7: N-&gt;S
   NOTIFY sip:vkg@host.example.com SIP/2.0
   To: &lt;sip:vkg@example.com&gt;;tag=8177-afd-991
   From: &lt;sip:16302240216@myprovider.com&gt;;tag=SPIRITS-REG-16302240216
   CSeq: 9122 NOTIFY
   Call-ID: 3329as77@host.example.com
   Contact: &lt;sip:notifier.myprovider.com&gt;
   Subscription-State: terminated;reason=fired
   Via: SIP/2.0/UDP notifier.myprovider.com;branch=z9hG4bK7yi-p12
   Event: spirits-user-prof
   Allow-Events: spirits-INDPs, spirits-user-prof
   Accept: application/spirits-event+xml
   Content-Type: application/spirits-event+xml
   Content-Length: ...










<span class="grey">Gurbani, et al.             Standards Track                    [Page 36]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-37" id="page-37" name="page-37"> </a>
<span class="grey"><a href="rfc3910.html">RFC 3910</a>                    SPIRITS Protocol                October 2004</span>


   &lt;?xml version="1.0" encoding="UTF-8"?&gt;
   &lt;spirits-event xmlns="urn:ietf:params:xml:ns:spirits-1.0"&gt;
      &lt;Event type="userprof" name="REG"&gt;
            &lt;CalledPartyNumber&gt;6302240216&lt;/CalledPartyNumber&gt;
            &lt;Cell-ID&gt;45987&lt;/Cell-ID&gt;
      &lt;/Event&gt;
   &lt;/spirits-event&gt;

   The subscriber receives the notification and acknowledges it by
   sending a response:

   F8: S-&gt;N

   SIP/2.0 200 OK
   To: &lt;sip:vkg@example.com&gt;;tag=8177-afd-991
   From: &lt;sip:16302240216@myprovider.com&gt;;tag=SPIRITS-REG-16302240216
   CSeq: 9122 NOTIFY
   Call-ID: 3329as77@host.example.com
   Via: SIP/2.0/UDP notifier.myprovider.com;branch=z9hG4bK7yi-p12
   Content-Length: 0

   Note that once the subscriber has received this notification, it can
   execute appropriate services.  In this particular instance, an
   appropriate service may consist of the subscriber acting as a
   composer of a presence service and turning the presence status of the
   user associated with the phone number "6302240216" to "on".  Also
   note in F7 that the notifier included a Cell ID in the notification.

   The Cell ID can be used as a basis for location specific services;
   however, a discussion of such services is out of the scope of this
   document.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.15.%20%20Use%20of%20URIs%20to%20retrieve%20state"></a><a class="selflink" href="#section-6.15" name="section-6.15">6.15</a>.  Use of URIs to retrieve state</span>

   The "spirits-user-prof" package MUST NOT use URIs to retrieve state.
   It is expected that most state information for this package is
   compact enough to fit in a SIP message.  However, to err on the side
   of caution, implementations MUST follow the convention outlined in
   Section 18.1.1 of [<a href="#ref-5" title='"SIP: Session Initiation Protocol"'>5</a>] and use a congestion controlled transport if
   the size of the request is within 200 bytes of the path MTU if known,
   or if the request size is larger than 1300 bytes and the path MTU is
   unknown.









<span class="grey">Gurbani, et al.             Standards Track                    [Page 37]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-38" id="page-38" name="page-38"> </a>
<span class="grey"><a href="rfc3910.html">RFC 3910</a>                    SPIRITS Protocol                October 2004</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20IANA%20Considerations"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  IANA Considerations</span>

   This document calls for IANA to:

      o register two new SIP Event Packages per [<a href="#ref-3" title='"Session Initiation Protocol (SIP)-Specific Event Notification"'>3</a>].

      o register a new MIME type per [<a href="#ref-20" title='"Multipurpose Internet Mail Extensions (MIME) Part One: Format of Internet Message Bodies"'>20</a>].

      o register a new namespace URN per [<a href="#ref-16" title='"The IETF XML Registry"'>16</a>].

      o register a new XML schema per [<a href="#ref-16" title='"The IETF XML Registry"'>16</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.1.%20%20Registering%20event%20packages"></a><a class="selflink" href="#section-7.1" name="section-7.1">7.1</a>.  Registering event packages</span>

   Package Name: spirits-INDPs

   Type: package

   Contact: Vijay K. Gurbani, vkg@lucent.com

   Reference: <a href="rfc3910.html">RFC 3910</a>

   Package Name: spirits-user-prof

   Type: package

   Contact: Vijay K. Gurbani, vkg@lucent.com

   Reference: <a href="rfc3910.html">RFC 3910</a>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.2.%20%20Registering%20MIME%20type"></a><a class="selflink" href="#section-7.2" name="section-7.2">7.2</a>.  Registering MIME type</span>

   MIME media type name: application

   MIME subtype name: spirits-event+xml

   Mandatory parameters: none

   Optional parameters: charset (same semantics of charset parameter in
   application/xml [<a href="#ref-9" title='"XML Media Types"'>9</a>])

   Encoding considerations: same as considerations outlined for
   application/xml in [<a href="#ref-9" title='"XML Media Types"'>9</a>].

   Security considerations: Section 10 of [<a href="#ref-9" title='"XML Media Types"'>9</a>] and <a href="#section-8">Section 8</a> of this
   document.

   Interoperability considerations: none.



<span class="grey">Gurbani, et al.             Standards Track                    [Page 38]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-39" id="page-39" name="page-39"> </a>
<span class="grey"><a href="rfc3910.html">RFC 3910</a>                    SPIRITS Protocol                October 2004</span>


   Published specifications: this document.

   Applications which use this media type: SPIRITS aware entities which
   adhere to this document.

   Additional information:

      Magic number(s): none.

      File extension(s): none.

      Macintosh file type code(s): none.

      Object Identifier(s) or OID(s): none.

   Person and email address for further information: Vijay K. Gurbani,
   &lt;vkg@lucent.com&gt;

   Intended usage: Common

   Author/Change controller: The IETF

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.3.%20%20Registering%20URN"></a><a class="selflink" href="#section-7.3" name="section-7.3">7.3</a>.  Registering URN</span>

   URI
      urn:ietf:params:xml:ns:spirits-1.0

   Description
   This is the XML namespace URI for XML elements defined by this
   document.  Such elements describe the SPIRITS information in the
   "application/ spirits-event+xml" content type.

   Registrant Contact
   IESG.

   XML
     BEGIN
       &lt;?xml version="1.0"?&gt;
       &lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML Basic 1.0//EN"
                 "<a href="http://www.w3.org/TR/xhtml-basic/xhtml-basic10.dtd">http://www.w3.org/TR/xhtml-basic/xhtml-basic10.dtd</a>"&gt;
       &lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;
       &lt;head&gt;
         &lt;meta http-equiv="content-type"
            content="text/html;charset=utf-8"/&gt;
         &lt;title&gt;Namespace for SPIRITS-related information&lt;/title&gt;
       &lt;/head&gt;
       &lt;body&gt;
         &lt;h1&gt;Namespace for SPIRITS-related information&lt;/h1&gt;



<span class="grey">Gurbani, et al.             Standards Track                    [Page 39]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-40" id="page-40" name="page-40"> </a>
<span class="grey"><a href="rfc3910.html">RFC 3910</a>                    SPIRITS Protocol                October 2004</span>


         &lt;h2&gt;application/spirits-event+xml&lt;/h2&gt;
         &lt;p&gt;See &lt;a href="[[[URL of published RFC]]]"&gt;<a href="rfc3910.html">RFC3910</a>&lt;/a&gt;.&lt;/p&gt;
       &lt;/body&gt;
       &lt;/html&gt;
     END

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.4.%20%20Registering%20XML%20schema"></a><a class="selflink" href="#section-7.4" name="section-7.4">7.4</a>.  Registering XML schema</span>

   URI
      urn:ietf:params:xml:schema:spirits-1.0

   Description
   XML base schema for SPIRITS entities.

   Registrant Contact
   IESG.

   XML
   Please see XML schema definition in <a href="#section-9">Section 9</a> of this document.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/8.%20%20Security%20Considerations"></a><a class="selflink" href="#section-8" name="section-8">8</a>.  Security Considerations</span>

   This section focuses on security considerations which are unique to
   SPIRITS.  SIP security mechanisms are discussed in detail in the core
   SIP specification [<a href="#ref-5" title='"SIP: Session Initiation Protocol"'>5</a>] and are outside the scope of this document.
   SPIRITS security mechanisms are based on and strengthen SIP security
   [<a href="#ref-5" title='"SIP: Session Initiation Protocol"'>5</a>], for example, SPIRITS mandates the support of S/MIME.  Beyond
   that, any other security solutions specified in [<a href="#ref-5" title='"SIP: Session Initiation Protocol"'>5</a>], i.e., TLS or
   HTTP Digest authentication, may be utilized by SPIRITS operators.

   As outlined in Chapter 9 (Security Consideration) of <a href="rfc3298.html">RFC3298</a> [<a href="#ref-4" title='"Service in the Public Switched Telephone Network/Intelligent Network (PSTN/IN) Requesting InTernet Service (SPIRITS) Protocol Requirements"'>4</a>], the
   following security aspects are applicable to the SPIRITS protocol:

      Authentication

      Integrity

      Confidentiality

      Non-repudiation

   The SPIRITS architecture in Figure 1 contains 5 interfaces -- A, B,
   C, D, and E.  Of these, only two -- B and C -- are of interest to
   SPIRITS.  Interfaces A and E are PINT interfaces and are thus assumed
   secured by the PINT RFC [<a href="#ref-8" title='"The PINT Service Protocol: Extensions to SIP and SDP for IP Access to Telephone Call Services"'>8</a>].  Security for interface D is out of
   scope in this document since it deals primarily with the PSTN
   infrastructure.  We will discuss security aspects on interfaces B and
   C predicated on certain assumptions.



<span class="grey">Gurbani, et al.             Standards Track                    [Page 40]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-41" id="page-41" name="page-41"> </a>
<span class="grey"><a href="rfc3910.html">RFC 3910</a>                    SPIRITS Protocol                October 2004</span>


   A driving assumption for SPIRITS security is that the SPIRITS gateway
   is owned by the same PSTN operator that owns the SPIRITS notifier.
   Thus, it is attractive to simply relegate security of interface C to
   the PSTN operator, and in fact, there are merits to doing just that
   since interface C crosses the IP Network and PSTN boundaries.
   However, a closer inspection reveals that both interfaces B and C
   transmit the SPIRITS protocol; thus, any security arrangement we
   arrive at for interface B can be suitably applied to interface C as
   well.  This makes it possible to secure interface C in case the
   SPIRITS gateway is not owned by the same PSTN operator that owns the
   SPIRITS notifier.

   The ensuing security discussion assumes that the SPIRITS subscriber
   is communicating directly to the SPIRITS notifier (and vice-versa)
   and specifies a security apparatus for this arrangement.  However,
   the same apparatus can be used to secure the communication between a
   SPIRITS subscriber and an intermediary (like the SPIRITS gateway),
   and the same intermediary and the SPIRITS notifier.

   Confidentiality of the SPIRITS protocol is essential since the
   information carried in the protocol data units is of a sensitive
   nature and may lead to privacy concerns if revealed to non-authorized
   parties.  The communication path between the SPIRITS notifier and the
   SPIRITS subscriber should be secured through S/MIME [<a href="#ref-18" title='"Secure/Multipurpose Internet Mail Extensions (S/MIME) Version 3.1 Message Specification"'>18</a>] to alleviate
   privacy concerns, as is described in the Security Consideration
   section of the core SIP specification [<a href="#ref-5" title='"SIP: Session Initiation Protocol"'>5</a>].

      S/MIME is an end-to-end security mechanism which encrypts the
      SPIRITS bodies for transit across an open network.  Intermediaries
      need not be cognizant of S/MIME in order to route the messages
      (routing headers travel in the clear).

   S/MIME provides all the security aspects for SPIRITS outlined at the
   beginning of this section: authentication, message integrity,
   confidentiality, and non-repudiation.  Authentication properties
   provided by S/MIME would allow the recipient of a SPIRITS message to
   ensure that the SPIRITS payload was generated by an authorized
   entity.  Encryption would ensure that only those SPIRITS entities
   possessing a particular decryption key are capable of inspecting
   encapsulated SPIRITS bodies in a SIP request.

   All SPIRITS endpoints MUST support S/MIME signatures (CMS SignedData)
   and MUST support encryption (CMS EnvelopedData).

   If the B and C interfaces are owned by the same PSTN operator, it is
   possible that public keys will be installed in the SPIRITS endpoints.





<span class="grey">Gurbani, et al.             Standards Track                    [Page 41]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-42" id="page-42" name="page-42"> </a>
<span class="grey"><a href="rfc3910.html">RFC 3910</a>                    SPIRITS Protocol                October 2004</span>


   S/MIME supports two methods -- issuerAndSerialNumber and
   subjectKeyIdentifier -- of naming the public key needed to validate a
   signature.  Between these, subjectKeyIdentifier works with X.509
   certificates and other schemes as well, while issuerAndSerialNumber
   works with X.509 certificates only.  If the administrator configures
   the necessary public keys, providing integrity through procedural
   means, then S/MIME can be used without X.509 certificates.

   All requests (and responses) between SPIRITS entities MUST be
   encrypted.

   When a request arrives at a SPIRITS notifier from a SPIRITS
   subscriber, the SPIRITS notifier MUST authenticate the request.  The
   subscription (or registration) from a SPIRITS subscriber MUST be
   rejected if the authentication fails.  If the SPIRITS subscriber
   successfully authenticated itself to the SPIRITS notifier, the
   SPIRITS notifier MUST, at the very least, ensure that the SPIRITS
   subscriber is indeed allowed to receive notifications of the events
   it is subscribing to.

      Note that this document does not proscribe how the SPIRITS
      notifier achieves this.  In practice, it could be through access
      control lists (ACL) that are populated by a service management
      system in the PSTN, or through a web interface of some sort.

   Requests from the SPIRITS notifier to the SPIRITS subscribers MUST
   also be authenticated, lest a malicious party attempts to
   fraudulently pose as a SPIRITS notifier to hijack a session.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/9.%20%20XML%20schema%20definition"></a><a class="selflink" href="#section-9" name="section-9">9</a>.  XML schema definition</span>

   The SPIRITS payload is specified in XML; this section defines the
   base XML schema for documents that make up the SPIRITS payload.  All
   SPIRITS entities that transport a payload characterized by the MIME
   type "application/spirits-event+xml" MUST support documents
   corresponding to the base schema below.

   Multiple versions of the base schema are not expected; rather, any
   additional functionality (e.g., conveying new PSTN events) must be
   accomplished through the definition of a new XML namespace and a
   corresponding schema.  Elements from the new XML namespace will then
   co-exist with elements from the base schema in a document.









<span class="grey">Gurbani, et al.             Standards Track                    [Page 42]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-43" id="page-43" name="page-43"> </a>
<span class="grey"><a href="rfc3910.html">RFC 3910</a>                    SPIRITS Protocol                October 2004</span>


&lt;xs:schema targetNamespace="urn:ietf:params:xml:ns:spirits-1.0"
       xmlns:tns="urn:ietf:params:xml:ns:spirits-1.0"
       xmlns:xs="http://www.w3.org/2001/XMLSchema"
       elementFormDefault="qualified"
       attributeFormDefault="unqualified"&gt;

     &lt;!-- This import brings in the XML language attribute xml:lang--&gt;
     &lt;xs:import namespace="http://www.w3.org/XML/1998/namespace"
                schemaLocation="http://www.w3.org/2001/xml.xsd"/&gt;

     &lt;xs:annotation&gt;
        &lt;xs:documentation xml:lang="en"&gt;
              Describes SPIRITS events.
        &lt;/xs:documentation&gt;
     &lt;/xs:annotation&gt;

     &lt;xs:element name="spirits-event" type="tns:SpiritsEventType"/&gt;

     &lt;xs:complexType name="SpiritsEventType"&gt;
        &lt;xs:sequence&gt;
           &lt;xs:element name="Event" type="tns:EventType" minOccurs="1"
               maxOccurs="unbounded"/&gt;
           &lt;xs:any namespace="##other" processContents="lax"
               maxOccurs="unbounded"/&gt;
        &lt;/xs:sequence&gt;
     &lt;/xs:complexType&gt;

     &lt;xs:complexType name="EventType"&gt;
        &lt;xs:sequence&gt;
           &lt;xs:element name="CalledPartyNumber" type="xs:token"
               minOccurs="0" maxOccurs="1"/&gt;
           &lt;xs:element name="CallingPartyNumber" type="xs:token"
               minOccurs="0" maxOccurs="1"/&gt;
           &lt;xs:element name="DialledDigits" type="xs:token"
               minOccurs="0" maxOccurs="1"/&gt;
           &lt;xs:element name="Cell-ID" type="xs:token"
               minOccurs="0" maxOccurs="1"/&gt;
           &lt;xs:element name="Cause" type="tns:CauseType"
               minOccurs="0" maxOccurs="1"/&gt;
        &lt;/xs:sequence&gt;
        &lt;xs:attribute name="type" type="tns:PayloadType"
            use="required"/&gt;
        &lt;xs:attribute name="name" type="tns:EventNameType"
            use="required"/&gt;
        &lt;xs:attribute name="mode" type="tns:ModeType"
            use="optional" default="N"/&gt;
     &lt;/xs:complexType&gt;




<span class="grey">Gurbani, et al.             Standards Track                    [Page 43]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-44" id="page-44" name="page-44"> </a>
<span class="grey"><a href="rfc3910.html">RFC 3910</a>                    SPIRITS Protocol                October 2004</span>


     &lt;xs:simpleType name="PayloadType"&gt;
        &lt;!-- The &lt;spirits-event&gt; will contain either a list of --&gt;
        &lt;!-- INDPs events or a list of userprof events --&gt;
        &lt;xs:restriction base="xs:string"&gt;
           &lt;xs:enumeration value="INDPs"/&gt;
           &lt;xs:enumeration value="userprof"/&gt;
        &lt;/xs:restriction&gt;
     &lt;/xs:simpleType&gt;

     &lt;xs:simpleType name="EventNameType"&gt;
        &lt;xs:restriction base="xs:string"&gt;
           &lt;!-- These are the call related events (DPs).  If the --&gt;
           &lt;!-- PaylaodType is "INDPs", then the value of the "name" --&gt;
           &lt;!-- attribute is one of these; example --&gt;
           &lt;!-- &lt;spirits-event type="INDPs" name="OCI"&gt; --&gt;
           &lt;xs:enumeration value="OAA"/&gt;
           &lt;xs:enumeration value="OCI"/&gt;
           &lt;xs:enumeration value="OAI"/&gt;
           &lt;xs:enumeration value="OA"/&gt;
           &lt;xs:enumeration value="OTS"/&gt;
           &lt;xs:enumeration value="ONA"/&gt;
           &lt;xs:enumeration value="OCPB"/&gt;
           &lt;xs:enumeration value="ORSF"/&gt;
           &lt;xs:enumeration value="OMC"/&gt;
           &lt;xs:enumeration value="OAB"/&gt;
           &lt;xs:enumeration value="OD"/&gt;
           &lt;xs:enumeration value="TA"/&gt;
           &lt;xs:enumeration value="TMC"/&gt;
           &lt;xs:enumeration value="TAB"/&gt;
           &lt;xs:enumeration value="TD"/&gt;
           &lt;xs:enumeration value="TAA"/&gt;
           &lt;xs:enumeration value="TFSA"/&gt;
           &lt;xs:enumeration value="TB"/&gt;
           &lt;!-- These are the non-call related events.  If the --&gt;
           &lt;!-- PayloadType is "user-prof", then the value of the --&gt;
           &lt;!-- "name" attribute is one of these; example --&gt;
           &lt;!-- &lt;spirits-event type="userprof" name="LUDV"&gt; --&gt;
           &lt;xs:enumeration value="LUSV"/&gt;
           &lt;xs:enumeration value="LUDV"/&gt;
           &lt;xs:enumeration value="REG"/&gt;
           &lt;xs:enumeration value="UNREGMS"/&gt;
           &lt;xs:enumeration value="UNREGNTWK"/&gt;
        &lt;/xs:restriction&gt;
     &lt;/xs:simpleType&gt;

     &lt;xs:simpleType name="ModeType"&gt;
        &lt;!-- One of two values: "N"otification or "R"equest --&gt;
        &lt;xs:restriction base="xs:string"&gt;



<span class="grey">Gurbani, et al.             Standards Track                    [Page 44]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-45" id="page-45" name="page-45"> </a>
<span class="grey"><a href="rfc3910.html">RFC 3910</a>                    SPIRITS Protocol                October 2004</span>


           &lt;xs:enumeration value="N"/&gt;
           &lt;xs:enumeration value="R"/&gt;
        &lt;/xs:restriction&gt;
     &lt;/xs:simpleType&gt;

     &lt;xs:simpleType name="CauseType"&gt;
        &lt;xs:restriction base="xs:string"&gt;
           &lt;xs:enumeration value="Busy"/&gt;
           &lt;xs:enumeration value="Unreachable"/&gt;
        &lt;/xs:restriction&gt;
     &lt;/xs:simpleType&gt;
&lt;/xs:schema&gt;

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/10.%20%20Acknowledgements"></a><a class="selflink" href="#section-10" name="section-10">10</a>.  Acknowledgements</span>

   The authors are grateful to participants in the SPIRITS WG for the
   discussion that contributed to this work.  These include J-L. Bakker,
   J. Bjorkner, J. Buller, J-E. Chapron, B. Chatras, O. Cleuziou,
   L. Conroy, R. Forbes, F. Haerens, J. Humphrey, J. Kozik,
   W. Montgomery, S. Nyckelgard, M. O'Doherty, A. Roach, J. Rosenberg,
   H. Sinnreich, L. Slutsman, D. Varney, and W. Zeuch.  The authors also
   acknowledge Steve Bellovin, Allison Mankin and Jon Peterson for help
   provided on the Security section.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/11.%20%20Acronyms"></a><a class="selflink" href="#section-11" name="section-11">11</a>.  Acronyms</span>

   ACL                  Access Control List
   CS                   Capability Set
   DP                   Detection Point
   DTD                  Document Type Definition
   EDP                  Event Detection Point
   EDP-N                Event Detection Point "Notification"
   EDP-R                Event Detection Point "Request"
   IANA                 Internet Assigned Numbers Authority
   ICW                  Internet Call Waiting
   IMSI                 International Mobile Subscriber Identity
   IN                   Intelligent Network
   INAP                 Intelligent Network Application Protocol
   IP                   Internet Protocol
   ISP                  Internet Service Provider
   ITU                  International Telecommunications Union
   MIME                 Multipurpose Internet Mail Extensions
   MS                   Mobile Station (or Mobile Subscriber)
   OBCSM                Originating Basic Call State Model
   PIC                  Point In Call
   PINT                 PSTN/Internet Interworking
   PSTN                 Public Switched Telephone Network
   SCF                  Service Control Function



<span class="grey">Gurbani, et al.             Standards Track                    [Page 45]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-46" id="page-46" name="page-46"> </a>
<span class="grey"><a href="rfc3910.html">RFC 3910</a>                    SPIRITS Protocol                October 2004</span>


   SCP                  Service Control Point
   SDP                  Session Description Protocol
   SIP                  Session Initiation Protocol
   SIP-T                SIP for Telephones
   SPIRITS              Services in the PSTN/IN Requesting InTernet
                            Services
   SSF                  Service Switching Function
   SSP                  Service Switching Point
   STD                  State Transition Diagram
   TBCSM                Terminating Basic Call State Model
   TDP                  Trigger Detection Point
   TDP-N                Trigger Detection Point "Notification"
   TDP-R                Trigger Detection Point "Request"
   TLS                  Transport Layer Security
   UA                   User Agent
   VLR                  Visitor Location Register
   WIN                  Wireless Intelligent Network
   XML                  Extensible Markup Language

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/12.%20%20References"></a><a class="selflink" href="#section-12" name="section-12">12</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/12.1.%20%20Normative%20References"></a><a class="selflink" href="#section-12.1" name="section-12.1">12.1</a>.  Normative References</span>

   [<a id="ref-1" name="ref-1">1</a>]  Slutsman, L., Faynberg, I., Lu, H., and M. Weissman, "The
        SPIRITS Architecture", <a href="rfc3136.html">RFC 3136</a>, June 2001.

   [<a id="ref-2" name="ref-2">2</a>]  Bradner, S., "Key words for use in RFCs to Indicate Requirement
        Levels", <a href="http://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.

   [<a id="ref-3" name="ref-3">3</a>]  Roach, A., "Session Initiation Protocol (SIP)-Specific Event
        Notification", <a href="rfc3265.html">RFC 3265</a>, June 2002.

   [<a id="ref-4" name="ref-4">4</a>]  Faynberg, I., Gato, J., Lu, H., and L. Slutsman, "Service in the
        Public Switched Telephone Network/Intelligent Network (PSTN/IN)
        Requesting InTernet Service (SPIRITS) Protocol Requirements",
        <a href="rfc3298.html">RFC 3298</a>, August 2002.

   [<a id="ref-5" name="ref-5">5</a>]  Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A.,
        Peterson, J., Sparks, R., Handley, M., and E. Schooler, "SIP:
        Session Initiation Protocol", <a href="rfc3261.html">RFC 3261</a>, June 2002.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/12.2.%20Informative%20References"></a><a class="selflink" href="#section-12.2" name="section-12.2">12.2</a>. Informative References</span>

   [<a id="ref-6" name="ref-6">6</a>]  M. Unmehopa, K. Vemuri, A. Brusilovsky, E. Dacloush, A. Zaki, F.
        Haerens, J-L. Bakker, B. Chatras, and J. Dobrowolski, "On
        selection of IN parameters to be carried by the SPIRITS
        Protocol", Work In Progress, January 2003.




<span class="grey">Gurbani, et al.             Standards Track                    [Page 46]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-47" id="page-47" name="page-47"> </a>
<span class="grey"><a href="rfc3910.html">RFC 3910</a>                    SPIRITS Protocol                October 2004</span>


   [<a id="ref-7" name="ref-7">7</a>]  Intelligent Network Capability Set 2. ITU-T, Recommendation
        Q.1228.

   [<a id="ref-8" name="ref-8">8</a>]  Petrack, S. and L. Conroy, "The PINT Service Protocol:
        Extensions to SIP and SDP for IP Access to Telephone Call
        Services", <a href="rfc2848.html">RFC 2848</a>, June 2000.

   [<a id="ref-9" name="ref-9">9</a>]  Murata, M., St.Laurent, S., and D. Kohn, "XML Media Types", <a href="rfc3023.html">RFC</a>
        <a href="rfc3023.html">3023</a>, January 2001.

   [<a id="ref-10" name="ref-10">10</a>] Lu, H., Faynberg, I., Voelker, J., Weissman, M., Zhang, W.,
        Rhim, S., Hwang, J., Ago, S., Moeenuddin, S., Hadvani, S.,
        Nyckelgard, S., Yoakum, J., and L. Robart, "Pre-Spirits
        Implementations of PSTN-initiated Services", <a href="rfc2995.html">RFC 2995</a>, November
        2000.

   [<a id="ref-11" name="ref-11">11</a>] Rosenberg, J. and H. Schulzrinne, "Session Initiation Protocol
        (SIP): Locating SIP Servers", <a href="rfc3263.html">RFC 3263</a>, June 2002.

   [<a id="ref-12" name="ref-12">12</a>] Thompson, H., Beech, D., Maloney, M. and N. Mendelsohn, "XML
        Schema Part 1: Structures", W3C REC REC-xmlschema-1-20010502,
        May 2001.  &lt;<a href="http://www.w3c.org/XML/">http://www.w3c.org/XML/</a>&gt;.

   [<a id="ref-13" name="ref-13">13</a>] "Interface recommendations for intelligent network capability
        set 3: SCF-SSF interface", ITU-T Recommendation Q.1238.2, June
        2000.

   [<a id="ref-14" name="ref-14">14</a>] Moats, R., "URN Syntax", <a href="rfc2141.html">RFC 2141</a>, May 1997.

   [<a id="ref-15" name="ref-15">15</a>] Moats, R., "A URN Namespace for IETF Documents", <a href="rfc2648.html">RFC 2648</a>,
        August 1999.

   [<a id="ref-16" name="ref-16">16</a>] Mealling, M., "The IETF XML Registry", <a href="http://tools.ietf.org/html/bcp81">BCP 81</a>, <a href="rfc3688.html">RFC 3688</a>, January
        2004.

   [<a id="ref-17" name="ref-17">17</a>] Tim Bray, Dave Hollander, and Andrew Layman, "Namespaces in
        XML", W3C recommendation: xml-names, 14th January 1999,
        &lt;<a href="http://www.w3.org/">http://www.w3.org/</a> TR/REC-xml-names&gt;.

   [<a id="ref-18" name="ref-18">18</a>] Ramsdell, B., "Secure/Multipurpose Internet Mail Extensions
        (S/MIME) Version 3.1 Message Specification", <a href="rfc3851.html">RFC 3851</a>, July
        2004.

   [<a id="ref-19" name="ref-19">19</a>] Faynberg, I., L. Gabuzda, M. Kaplan, and N.Shah, "The
        Intelligent Network Standards: Their Application to Services",
        McGraw-Hill, 1997.





<span class="grey">Gurbani, et al.             Standards Track                    [Page 47]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-48" id="page-48" name="page-48"> </a>
<span class="grey"><a href="rfc3910.html">RFC 3910</a>                    SPIRITS Protocol                October 2004</span>


   [<a id="ref-20" name="ref-20">20</a>] Freed, N. and N. Borenstein, "Multipurpose Internet Mail
        Extensions (MIME) Part One: Format of Internet Message Bodies",
        <a href="rfc2045.html">RFC 2045</a>, November 1996.

        Freed, N. and N. Borenstein, "Multipurpose Internet Mail
        Extensions (MIME) Part Two: Media Types", <a href="rfc2046.html">RFC 2046</a>, November
        1996.

        Moore, K., "MIME (Multipurpose Internet Mail Extensions) Part
        Three:  Message Header Extensions for Non-ASCII Text ", <a href="rfc2047.html">RFC</a>
        <a href="rfc2047.html">2047</a>, November 1996.

        Freed, N., Klensin, J., and J. Postel, "Multipurpose Internet
        Mail Extensions (MIME) Part Four: Registration Procedures", <a href="http://tools.ietf.org/html/bcp13">BCP</a>
        <a href="http://tools.ietf.org/html/bcp13">13</a>, <a href="rfc2048.html">RFC 2048</a>, November 1996.

        Freed, N. and N. Borenstein, "Multipurpose Internet Mail
        Extensions (MIME) Part Five: Conformance Criteria and Examples",
        <a href="rfc2049.html">RFC 2049</a>, November 1996.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/13.%20%20Contributors"></a><a class="selflink" href="#section-13" name="section-13">13</a>.  Contributors</span>

   Kumar Vemuri
   Lucent Technologies, Inc.
   2000 Naperville Rd.
   Naperville, IL 60566
   USA

   EMail: vvkumar@lucent.com

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/14.%20%20Authors%27%20Addresses"></a><a class="selflink" href="#section-14" name="section-14">14</a>.  Authors' Addresses</span>

   Vijay K. Gurbani, Editor
   2000 Lucent Lane
   Rm 6G-440
   Naperville, IL 60566
   USA

   EMail: vkg@lucent.com


   Alec Brusilovsky
   2601 Lucent Lane
   Lisle, IL 60532-3640
   USA

   EMail: abrusilovsky@lucent.com




<span class="grey">Gurbani, et al.             Standards Track                    [Page 48]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-49" id="page-49" name="page-49"> </a>
<span class="grey"><a href="rfc3910.html">RFC 3910</a>                    SPIRITS Protocol                October 2004</span>


   Igor Faynberg
   Lucent Technologies, Inc.
   101 Crawfords Corner Rd.
   Holmdel, NJ 07733
   USA

   EMail: faynberg@lucent.com


   Jorge Gato
   Vodafone Espana
   Isabel Colbrand, 22
   28050 Madrid
   Spain

   EMail: jorge.gato@vodafone.com


   Hui-Lan Lu
   Bell Labs/Lucent Technologies
   Room 4C-607A, 101 Crawfords Corner Road
   Holmdel, New Jersey, 07733

   Phone: (732) 949-0321
   EMail: huilanlu@lucent.com


   Musa Unmehopa
   Lucent Technologies, Inc.
   Larenseweg 50,
   Postbus 1168
   1200 BD, Hilversum,
   The Netherlands

   EMail: unmehopa@lucent.com
















<span class="grey">Gurbani, et al.             Standards Track                    [Page 49]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-50" id="page-50" name="page-50"> </a>
<span class="grey"><a href="rfc3910.html">RFC 3910</a>                    SPIRITS Protocol                October 2004</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/15.%20%20Full%20Copyright%20Statement"></a><a class="selflink" href="#section-15" name="section-15">15</a>.  Full Copyright Statement</span>

   Copyright (C) The Internet Society (2004).

   This document is subject to the rights, licenses and restrictions
   contained in <a href="http://tools.ietf.org/html/bcp78">BCP 78</a>, and except as set forth therein, the authors
   retain all their rights.

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/S HE
   REPRESENTS OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY AND THE
   INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS OR
   IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF
   THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

Intellectual Property

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the IETF's procedures with respect to rights in IETF Documents can
   be found in <a href="http://tools.ietf.org/html/bcp78">BCP 78</a> and <a href="http://tools.ietf.org/html/bcp79">BCP 79</a>.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   <a href="http://www.ietf.org/ipr">http://www.ietf.org/ipr</a>.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at ietf-
   ipr@ietf.org.

Acknowledgement

   Funding for the RFC Editor function is currently provided by the
   Internet Society.







Gurbani, et al.             Standards Track                    [Page 50]

</pre><br/>
<span class="noprint"><small><small>Html markup produced by rfcmarkup 1.107, available from
<a href="http://tools.ietf.org/tools/rfcmarkup/">http://tools.ietf.org/tools/rfcmarkup/</a>
</small></small></span>



</body><!-- Mirrored from tools.ietf.org/html/rfc3910 by HTTrack Website Copier/3.x [XR&CO'2013], Sat, 07 Jun 2014 20:18:48 GMT --></html>