<html><head></head><body><pre>Internet Engineering Task Force (IETF)                       B. Trammell
Request for Comments: 7013                                    ETH Zurich
BCP: 184                                                       B. Claise
Category: Best Current Practice                      Cisco Systems, Inc.
ISSN: 2070-1721                                           September 2013


                <span class="h1">Guidelines for Authors and Reviewers of</span>
        <span class="h1">IP Flow Information Export (IPFIX) Information Elements</span>

Abstract

   This document provides guidelines for how to write definitions of new
   Information Elements for the IP Flow Information Export (IPFIX)
   protocol.  It provides instructions on using the proper conventions
   for Information Elements to be registered in the IANA IPFIX
   Information Element registry, and provides guidelines for expert
   reviewers to evaluate new registrations.

Status of This Memo

   This memo documents an Internet Best Current Practice.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   BCPs is available in <a href="./rfc5741#section-2">Section 2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc7013">http://www.rfc-editor.org/info/rfc7013</a>.

Copyright Notice

   Copyright (c) 2013 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://www.rfc-editor.org/bcp/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.




<span class="grey">Trammell &amp; Claise         Best Current Practice                 [Page 1]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-2"></span>
<span class="grey"><a href="./rfc7013">RFC 7013</a>                    IPFIX IE-DOCTORS              September 2013</span>


Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-3">3</a>
      <a href="#section-1.1">1.1</a>. Intended Audience and Usage ................................<a href="#page-3">3</a>
      <a href="#section-1.2">1.2</a>. Overview of Relevant IPFIX Documents .......................<a href="#page-4">4</a>
   <a href="#section-2">2</a>. Terminology .....................................................<a href="#page-4">4</a>
   <a href="#section-3">3</a>. How to Apply IPFIX ..............................................<a href="#page-5">5</a>
   <a href="#section-4">4</a>. Defining New Information Elements ...............................<a href="#page-6">6</a>
      <a href="#section-4.1">4.1</a>. Information Element Naming .................................<a href="#page-7">7</a>
      <a href="#section-4.2">4.2</a>. Information Element Data Types .............................<a href="#page-7">7</a>
      <a href="#section-4.3">4.3</a>. Information Element Numbering ..............................<a href="#page-8">8</a>
      <a href="#section-4.4">4.4</a>. Ancillary Information Element Properties ...................<a href="#page-9">9</a>
      <a href="#section-4.5">4.5</a>. Internal Structure in Information Elements .................<a href="#page-9">9</a>
      <a href="#section-4.6">4.6</a>. Information Element Multiplicity ..........................<a href="#page-10">10</a>
      <a href="#section-4.7">4.7</a>. Enumerated Values and Subregistries .......................<a href="#page-11">11</a>
      <a href="#section-4.8">4.8</a>. Reversibility as per <a href="./rfc5103">RFC 5103</a> .............................<a href="#page-11">11</a>
      <a href="#section-4.9">4.9</a>. Avoiding Bad Ideas in Information Element Design ..........<a href="#page-11">11</a>
   <a href="#section-5">5</a>. The Information Element Life Cycle .............................<a href="#page-13">13</a>
      <a href="#section-5.1">5.1</a>. The Process for Review by the IE-DOCTORS ..................<a href="#page-13">13</a>
      <a href="#section-5.2">5.2</a>. Revising Information Elements .............................<a href="#page-14">14</a>
      <a href="#section-5.3">5.3</a>. Deprecating Information Elements ..........................<a href="#page-15">15</a>
   <a href="#section-6">6</a>. When Not to Define New Information Elements ....................<a href="#page-16">16</a>
      <a href="#section-6.1">6.1</a>. Maximizing Reuse of Existing Information Elements .........<a href="#page-16">16</a>
      <a href="#section-6.2">6.2</a>. Applying Enterprise-Specific Information Elements .........<a href="#page-18">18</a>
   <a href="#section-7">7</a>. Information Element Definition Checklist .......................<a href="#page-18">18</a>
   <a href="#section-8">8</a>. Applying IPFIX to Non-Flow Applications ........................<a href="#page-21">21</a>
   <a href="#section-9">9</a>. Writing Internet-Drafts for IPFIX Applications .................<a href="#page-21">21</a>
      <a href="#section-9.1">9.1</a>. Example Information Element Definition ....................<a href="#page-22">22</a>
      <a href="#section-9.2">9.2</a>. Defining Recommended Templates ............................<a href="#page-22">22</a>
   10. A Textual Format for Specifying Information Elements
       and Templates .................................................<a href="#page-23">23</a>
      <a href="#section-10.1">10.1</a>. Information Element Specifiers ...........................<a href="#page-24">24</a>
      <a href="#section-10.2">10.2</a>. Specifying Templates .....................................<a href="#page-26">26</a>
      <a href="#section-10.3">10.3</a>. Specifying IPFIX Structured Data .........................<a href="#page-27">27</a>
   <a href="#section-11">11</a>. Security Considerations .......................................<a href="#page-27">27</a>
   <a href="#section-12">12</a>. Acknowledgments ...............................................<a href="#page-28">28</a>
   <a href="#section-13">13</a>. References ....................................................<a href="#page-29">29</a>
      <a href="#section-13.1">13.1</a>. Normative References .....................................<a href="#page-29">29</a>
      <a href="#section-13.2">13.2</a>. Informative References ...................................<a href="#page-29">29</a>
   <a href="#appendix-A">Appendix A</a>. Example Information Element Definitions ...............<a href="#page-31">31</a>
     <a href="#appendix-A.1">A.1</a>. sipResponseStatus ..........................................<a href="#page-31">31</a>
     <a href="#appendix-A.2">A.2</a>. duplicatePacketDeltaCount ..................................<a href="#page-31">31</a>
     <a href="#appendix-A.3">A.3</a>. ambientTemperature .........................................<a href="#page-32">32</a>








<span class="grey">Trammell &amp; Claise         Best Current Practice                 [Page 2]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-3"></span>
<span class="grey"><a href="./rfc7013">RFC 7013</a>                    IPFIX IE-DOCTORS              September 2013</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" id="section-1">1</a>.  Introduction</span>

   This document provides guidelines for the definition of new IPFIX
   Information Elements beyond those currently in the IANA IPFIX
   Information Element Registry [<a href="#ref-IANA-IPFIX">IANA-IPFIX</a>].  Given the self-describing
   nature of the data export format used by IPFIX, the definition of new
   Information Elements is often sufficient to allow the application of
   IPFIX to new network measurement and management use cases.

   We intend this document to enable the application of IPFIX to new
   areas by experts in the IETF Working Group or Area Directorate, the
   IETF community, or organization external to the IETF, concerned with
   the technical details of the protocol or application to be measured
   or managed using IPFIX.  This expansion occurs with the consultation
   of IPFIX experts informally called IE-DOCTORS.  It provides
   guidelines both for those defining new Information Elements as well
   as the IE-DOCTORS reviewing them.

   This document essentially codifies two meta-guidelines: (1) "define
   new Information Elements that look like existing Information
   Elements" and (2) "don't define Information Elements unless you need
   to".

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/1.1.%20%20Intended%20Audience%20and%20Usage"></a><a class="selflink" href="#section-1.1" id="section-1.1">1.1</a>.  Intended Audience and Usage</span>

   This document is meant for two separate audiences.  For those
   defining new Information Elements, it provides specifications and
   best practices to be used in deciding which Information Elements are
   necessary for a given existing or new application, instructions for
   writing the definitions for these Information Elements, and
   information on the supporting documentation required for the new
   application (up to and including the publication of one or more RFCs
   describing it).  For the IPFIX experts appointed as IE-DOCTORS, and
   for IANA personnel changing the IANA IPFIX Information Element
   Registry [<a href="#ref-IANA-IPFIX">IANA-IPFIX</a>], it defines a set of acceptance criteria
   against which these proposed Information Elements should be
   evaluated.

   This document is not intended to guide the extension of the IPFIX
   protocol itself, e.g., through new export mechanisms, data types, or
   the like; these activities should be pursued through the publication
   of Standards Track RFCs within the IPFIX Working Group.

   This document, together with [<a href="./rfc7012" title='"Information Model for IP Flow Information Export (IPFIX)"'>RFC7012</a>], defines the procedures for
   management of the IANA IPFIX Information Element Registry
   [<a href="#ref-IANA-IPFIX">IANA-IPFIX</a>].  The practices outlined in this document are intended





<span class="grey">Trammell &amp; Claise         Best Current Practice                 [Page 3]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-4"></span>
<span class="grey"><a href="./rfc7013">RFC 7013</a>                    IPFIX IE-DOCTORS              September 2013</span>


   to guide experts when reviewing additions or changes to the
   Information Elements in the registry under Expert Review (as defined
   in [<a href="./rfc5226" title="">RFC5226</a>]).

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/1.2.%20%20Overview%20of%20Relevant%20IPFIX%20Documents"></a><a class="selflink" href="#section-1.2" id="section-1.2">1.2</a>.  Overview of Relevant IPFIX Documents</span>

   [<a id="ref-RFC7011">RFC7011</a>] defines the IPFIX protocol, the IPFIX-specific terminology
   used by this document, and the data type encodings for each of the
   data types supported by IPFIX.

   [<a id="ref-RFC7012">RFC7012</a>] defines the basis of the IPFIX Information Model, referring
   to [<a href="#ref-IANA-IPFIX">IANA-IPFIX</a>] for the specific Information Element definitions.  It
   states that new Information Elements may be added to the Information
   Model on the basis of Expert Review, delegates the appointment of
   experts to an IESG Area Director, and refers to this document for
   details on the extension process.  This document is intended to
   further codify the best practices to be followed by these experts, in
   order to improve the efficiency of this process.

   [<a id="ref-RFC5103">RFC5103</a>] defines a method for exporting bidirectional Flow
   information using IPFIX; this document should be followed when
   extending IPFIX to represent information about bidirectional network
   interactions in general.  Additionally, new Information Elements
   should be annotated for their reversibility or lack thereof as per
   this document.

   [<a id="ref-RFC5610">RFC5610</a>] defines a method for exporting information about
   Information Elements inline within IPFIX.  In doing so, it explicitly
   defines a set of restrictions, implied in [<a href="./rfc7011" title='"Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of Flow Information"'>RFC7011</a>] and [<a href="./rfc7012" title='"Information Model for IP Flow Information Export (IPFIX)"'>RFC7012</a>], on
   the use of data types and semantic; these restrictions must be
   observed in the definition of new Information Elements, as in
   <a href="#section-4.4">Section 4.4</a>.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/2.%20%20Terminology"></a><a class="selflink" href="#section-2" id="section-2">2</a>.  Terminology</span>

   Capitalized terms used in this document that are defined in the
   Terminology section of [<a href="./rfc7011" title='"Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of Flow Information"'>RFC7011</a>] are to be interpreted as defined
   there.

   An "application", as used in this document, refers to a candidate
   protocol, task, or domain to which IPFIX export, collection, and/or
   storage is applied.  By this definition, the IPFIX applicability
   statement [<a href="./rfc5472" title='"IP Flow Information Export (IPFIX) Applicability"'>RFC5472</a>] defined the initial applications of IPFIX, and
   Packet Sampling (PSAMP) [<a href="./rfc5476" title='"Packet Sampling (PSAMP) Protocol Specifications"'>RFC5476</a>] was the first new IPFIX application
   after the publication of the IPFIX protocol itself.

   "IANA IE registry", as used in this document, unless otherwise noted,
   refers to the IANA IPFIX Information Element Registry [<a href="#ref-IANA-IPFIX">IANA-IPFIX</a>].



<span class="grey">Trammell &amp; Claise         Best Current Practice                 [Page 4]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-5"></span>
<span class="grey"><a href="./rfc7013">RFC 7013</a>                    IPFIX IE-DOCTORS              September 2013</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.%20%20How%20to%20Apply%20IPFIX"></a><a class="selflink" href="#section-3" id="section-3">3</a>.  How to Apply IPFIX</span>

   Though originally specified for the export of IP Flow information,
   the message format, template mechanism, and data model specified by
   IPFIX led to it being applicable to a wide variety of network
   management situations.  In addition to Flow information export, for
   which it was designed, and packet information export as specified by
   PSAMP [<a href="./rfc5476" title='"Packet Sampling (PSAMP) Protocol Specifications"'>RFC5476</a>], any application with the following characteristics
   is a good candidate for an IPFIX application:

   o  The application's data Flow is fundamentally unidirectional.
      IPFIX is a "push" protocol, supporting only the export of
      information from a sender (an Exporting Process) to a receiver (a
      Collecting Process).  Request-response interactions are not
      supported by IPFIX.

   o  The application handles discrete event information, or information
      to be periodically reported.  IPFIX is particularly well suited to
      representing events, which can be scoped in time.

   o  The application handles information about network entities.
      IPFIX's information model is network-oriented, so network
      management applications have many opportunities for information
      model reuse.

   o  The application requires a small number of arrangements of data
      structures relative to the number of records it handles.  The
      template-driven self-description mechanism used by IPFIX excels at
      handling large volumes of identically structured data, compared to
      representations that define structure inline with data (such as
      XML).

   Most applications meeting these criteria can be supported over IPFIX.
   Once it has been determined that IPFIX is a good fit, the next step
   is determining which Information Elements are necessary to represent
   the information required by the application.  Especially for network-
   centric applications, the IANA IE registry may already contain all
   the necessary Information Elements (see <a href="#section-6.1">Section 6.1</a> for guidelines on
   maximizing Information Element reuse).  In this case, no work within
   the IETF is necessary: simply define Templates and start exporting.

   It is expected, however, that most applications will be able to reuse
   some existing Information Elements, but may need to define some
   additional Information Elements to support all their requirements.
   In this case, see <a href="#section-4">Section 4</a> for best practices to be followed in
   defining Information Elements.





<span class="grey">Trammell &amp; Claise         Best Current Practice                 [Page 5]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-6"></span>
<span class="grey"><a href="./rfc7013">RFC 7013</a>                    IPFIX IE-DOCTORS              September 2013</span>


   Optionally, a Working Group or individual contributor may choose to
   write an Internet-Draft for publication as an RFC, detailing the new
   IPFIX application.  Such an RFC should contain discussion of the new
   application, the Information Element definitions as in <a href="#section-4">Section 4</a>, as
   well as suggested Templates and examples of the use of those
   Templates within the new application as in <a href="#section-9.2">Section 9.2</a>.  <a href="#section-10">Section 10</a>
   defines a compact textual Information Element notation to be used in
   describing these suggested Templates and/or the use of IPFIX
   Structured Data [<a href="./rfc6313" title='"Export of Structured Data in IP Flow Information Export (IPFIX)"'>RFC6313</a>] within the new application.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/4.%20%20Defining%20New%20Information%20Elements"></a><a class="selflink" href="#section-4" id="section-4">4</a>.  Defining New Information Elements</span>

   In many cases, a new application will require nothing more than a new
   Information Element or set of Information Elements to be exportable
   using IPFIX.  An Information Element meeting the following criteria,
   as evaluated by the IE-DOCTORS, is eligible for inclusion in the IANA
   IE registry:

   o  The Information Element must be unique within the registry, and
      its description must represent a substantially different meaning
      from that of any existing Information Element.  An existing
      Information Element that can be reused for a given purpose should
      be reused.

   o  The Information Element should contain as little internal
      structure as possible.  Instead of representing complex
      information by overlaying internal structure on a simple data type
      such as octetArray, such information should be represented with
      multiple simple Information Elements to be exported in parallel or
      using IPFIX Structured Data [<a href="./rfc6313" title='"Export of Structured Data in IP Flow Information Export (IPFIX)"'>RFC6313</a>], as in <a href="#section-4.5">Section 4.5</a>.  The
      internal structure of a proposed IE may be evaluated by the IE-
      DOCTORS with an eye toward interoperability and/or backward
      compatibility with existing methods of exporting similar data on a
      case-by-case basis.

   o  Information Elements representing information about proprietary or
      nonstandard applications should not be registered in the IANA IE
      registry.  These can be represented using enterprise-specific
      Information Elements as detailed in <a href="./rfc7011#section-3.2">Section 3.2 of [RFC7011]</a>,
      instead.

   The definition of new Information Elements requires a descriptive
   name, a specification of the data type from the IPFIX Data Type
   subregistry in the IANA IE registry (defined in [<a href="./rfc7012" title='"Information Model for IP Flow Information Export (IPFIX)"'>RFC7012</a>] as itself
   extensible via Standards Action as per [<a href="./rfc5226" title="">RFC5226</a>]), and a human-
   readable description written in English.  This section provides





<span class="grey">Trammell &amp; Claise         Best Current Practice                 [Page 6]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-7"></span>
<span class="grey"><a href="./rfc7013">RFC 7013</a>                    IPFIX IE-DOCTORS              September 2013</span>


   guidelines on each of these components of an Information Element
   definition, referring to existing documentation such as [<a href="./rfc7012" title='"Information Model for IP Flow Information Export (IPFIX)"'>RFC7012</a>] as
   appropriate.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/4.1.%20%20Information%20Element%20Naming"></a><a class="selflink" href="#section-4.1" id="section-4.1">4.1</a>.  Information Element Naming</span>

   As the name of an Information Element is the first thing a potential
   implementor will use when determining whether it is suitable for a
   given application, it is important to be as precise and descriptive
   as possible.  Names of Information Elements:

   o  must be chosen carefully to describe the use of the Information
      Element within the context in which it will be used.

   o  must be unique within the IANA IE registry.

   o  start with lowercase letters.

   o  use capital letters for the first letter of each component except
      for the first one (aka "camel case").  All other letters are
      lowercase, even for acronyms.  Exceptions are made for acronyms
      containing a mixture of lowercase and capital letters, such as
      'IPv4' and 'IPv6'.  Examples are "sourceMacAddress" and
      "destinationIPv4Address".

   In addition, new Information Elements pertaining to a specific
   protocol should name the protocol in the first word in order to ease
   searching by name (e.g., "sipMethod" for a SIP method, as would be
   used in a logging format for SIP based on IPFIX).  Similarly, new
   Information Elements pertaining to a specific application should name
   the application in the first word.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/4.2.%20%20Information%20Element%20Data%20Types"></a><a class="selflink" href="#section-4.2" id="section-4.2">4.2</a>.  Information Element Data Types</span>

   IPFIX provides a set of data types covering most primitives used in
   network measurement and management applications.  The most
   appropriate data type should be chosen for the Information Element
   type, IPFIX informationElementDataTypes subregistry at [<a href="#ref-IANA-IPFIX">IANA-IPFIX</a>].
   This subregistry may be extended from time to time by a Standards
   Action [<a href="./rfc5226" title="">RFC5226</a>], as defined in [<a href="./rfc5610" title='"Exporting Type Information for IP Flow Information Export (IPFIX) Information Elements"'>RFC5610</a>].

   Information Elements representing an integral value with a natural
   width should be defined with the appropriate integral data type.
   This applies especially to values taken directly from fixed-width
   fields in a measured protocol.  For example, tcpControlBits, the TCP
   flags byte, is an unsigned8, and tcpSequenceNumber is an unsigned32.





<span class="grey">Trammell &amp; Claise         Best Current Practice                 [Page 7]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-8"></span>
<span class="grey"><a href="./rfc7013">RFC 7013</a>                    IPFIX IE-DOCTORS              September 2013</span>


   Information Elements representing counters or identifiers should be
   defined as signed64 or unsigned64, as appropriate, to maximize the
   range of values available; applications can use reduced-size encoding
   as defined in <a href="./rfc7011#section-6.2">Section 6.2 of [RFC7011]</a> in cases where fewer than 2^64
   values are necessary.

   Information Elements representing time values must be defined with
   appropriate precision.  For example, an Information Element for a
   time measured at second-level precision should be defined as having a
   dateTimeSeconds data type, instead of dateTimeMilliseconds.

   Information Elements of type string or octetArray that have length
   constraints (fixed length, minimum and/or maximum length) must note
   these constraints in their description.

   The type of an Information Element must match the type of the data it
   represents.  More specifically, information that could be represented
   as a string but that better matches one of the other data types
   (e.g., an integral type for a number or enumerated type, an address
   type for an address) must be represented by the best-matching type,
   even if the data was represented using a different type in the
   source.  For example, an IPFIX application that exports Options
   Template Records mapping IP addresses to additional information about
   each host from an external database must use Information Elements of
   an address type to represent the addresses, even if the source
   database represented these as strings.

   Strings and octetArrays must not be used to encode data that would be
   more properly represented using multiple Information Elements and/or
   IPFIX Structured Data [<a href="./rfc6313" title='"Export of Structured Data in IP Flow Information Export (IPFIX)"'>RFC6313</a>]; see <a href="#section-4.5">Section 4.5</a> for more.

   This document does not cover the addition of new Data Types or Data
   Type Semantics to the IPFIX protocol.  As such changes have important
   interoperability considerations and require implementation on both
   Collecting and Exporting Processes, they require a Standards Action
   as per [<a href="./rfc5610" title='"Exporting Type Information for IP Flow Information Export (IPFIX) Information Elements"'>RFC5610</a>].  However, note that the set of primitive types
   provided by IPFIX are applicable to almost any appropriate
   application, so extending the type system is generally not necessary.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/4.3.%20%20Information%20Element%20Numbering"></a><a class="selflink" href="#section-4.3" id="section-4.3">4.3</a>.  Information Element Numbering</span>

   Each Information Element has a unique identifier in the IANA
   registry.

   When adding newly registered Information Elements to the IANA IE
   registry, IANA should assign the lowest available Information Element
   identifier (the value column in [<a href="#ref-IANA-IPFIX">IANA-IPFIX</a>]) in the range 128-32767.




<span class="grey">Trammell &amp; Claise         Best Current Practice                 [Page 8]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-9"></span>
<span class="grey"><a href="./rfc7013">RFC 7013</a>                    IPFIX IE-DOCTORS              September 2013</span>


   Information Elements with identifiers in the range 1-127 are reserved
   for compatibility with corresponding fields in NetFlow version 9, as
   described in [<a href="./rfc3954" title='"Cisco Systems NetFlow Services Export Version 9"'>RFC3954</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/4.4.%20%20Ancillary%20Information%20Element%20Properties"></a><a class="selflink" href="#section-4.4" id="section-4.4">4.4</a>.  Ancillary Information Element Properties</span>

   Information Elements to which special semantics apply should refer to
   one of the values in the Information Element Semantics subregistry of
   the IANA IE registry, as described in <a href="./rfc7012#section-3.2">Section 3.2 of [RFC7012]</a>,
   subject to the restrictions given in <a href="./rfc5610#section-3.10">Section 3.10 of [RFC5610]</a>; in
   other words, the semantics and the type must be consistent.

   When defining Information Elements representing a dimensioned
   quantity or entity count, the units of that quantity should be
   defined in the units field.  This field takes its values from the
   IANA Information Element Units subregistry of the IANA IE registry.
   If an Information Element expresses a quantity in units not yet in
   this subregistry, then the unit must be added to the Units
   subregistry at the same time the Information Element is added to the
   IANA IE registry.  Note that the Units subregistry as defined in
   [<a href="./rfc5610" title='"Exporting Type Information for IP Flow Information Export (IPFIX) Information Elements"'>RFC5610</a>] is maintained on an Expert Review basis.

   Additionally, when the range of values an Information Element can
   take is smaller than the range implied by its data type, the range
   should be defined within the Information Element's entry in the IANA
   IE registry.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/4.5.%20%20Internal%20Structure%20in%20Information%20Elements"></a><a class="selflink" href="#section-4.5" id="section-4.5">4.5</a>.  Internal Structure in Information Elements</span>

   The definition of Information Elements with an internal structure
   that is defined in the Description field is not recommended, except
   in the following cases:

   1.  The Information Element is a direct copy of a structured entity
       in a measured protocol (e.g., the tcpControlBits Information
       Element for the flags byte from the TCP header).

   2.  The Information Element represents a section of a packet of
       protocol entity, in raw form as captured from the wire (e.g., the
       mplsLabelStackSection Information Element for the MPLS label
       stack).

   3.  The Information Element represents a set of flags that are
       tightly semantically related, where representing the flags as
       separate one-byte booleans would be inefficient, and that should
       always appear together in a data record (e.g., the
       anonymizationFlags Information Element for specifying optional
       features of anonymization techniques).



<span class="grey">Trammell &amp; Claise         Best Current Practice                 [Page 9]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-10"></span>
<span class="grey"><a href="./rfc7013">RFC 7013</a>                    IPFIX IE-DOCTORS              September 2013</span>


   4.  The Information Element contains internal structure by reference
       to an external data type or specification containing internal
       structure (e.g., a MIME type or URL), for interoperability and
       backward-compatibility purposes.

   Additional exceptions to the above list should be made through
   publication of an RFC.

   In other cases, candidate Information Elements with internal
   structure should be decomposed into multiple primitive Information
   Elements to be used in parallel.  For more complicated semantics,
   where the structure is not identical from Data Record to Data Record,
   or where there is semantic dependency between multiple decomposed
   primitive Information Elements, use the IPFIX Structured Data
   [<a href="./rfc6313" title='"Export of Structured Data in IP Flow Information Export (IPFIX)"'>RFC6313</a>] extension instead.

   As an example of Information Element decomposition, consider an
   application-level identifier called an "endpoint", which represents a
   {host, port, protocol} tuple.  Instead of allocating an opaque,
   structured "source endpoint" Information Element, the source endpoint
   should be represented by three separate Information Elements: "source
   address", "source port", "transport protocol".  In this example, the
   required Information Elements already exist in the IANA IE registry:
   sourceIPv4Address or sourceIPv6Address, sourceTransportPort,
   protocolIdentifier.  Indeed, as well as being good practice, this
   normalization down to non-structured Information Elements also
   increases opportunities for reuse as in <a href="#section-6.1">Section 6.1</a>.

   The decomposition of data with internal structure should avoid the
   definition of Information Elements that have a meaning too specific
   to be generally useful or that would result in a multitude of
   templates to handle different multiplicities.  More information on
   multiplicities is given in the following section.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/4.6.%20%20Information%20Element%20Multiplicity"></a><a class="selflink" href="#section-4.6" id="section-4.6">4.6</a>.  Information Element Multiplicity</span>

   Some Information Elements may represent information with a
   multiplicity other than one, i.e., items that may occur multiple
   times within the data to be represented in a single IPFIX record.  In
   this case, there are several options, depending on the circumstances:

   1.  As specified in <a href="./rfc7011#section-8">Section 8 of [RFC7011]</a>: "if an Information
       Element is required more than once in a Template, the different
       occurrences of this Information Element should follow the logical
       order of their treatments by the Metering Process."  In other
       words, in cases where the items have a natural order (e.g., the
       order in which they occur in the packet), and the multiplicity is
       the same for each record, the information can be modeled by



<span class="grey">Trammell &amp; Claise         Best Current Practice                [Page 10]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-11"></span>
<span class="grey"><a href="./rfc7013">RFC 7013</a>                    IPFIX IE-DOCTORS              September 2013</span>


       containing multiple instances of the Information Element
       representing a single item within the Template Record describing
       the Data Records.

   2.  In cases where the items have a variable multiplicity, a
       basicList of the Information Element representing a single item
       can be used as in the IPFIX Structured Data [<a href="./rfc6313" title='"Export of Structured Data in IP Flow Information Export (IPFIX)"'>RFC6313</a>] extension.

   3.  If the multiple-item structure is taken directly from bytes
       observed on the wire by the Metering Process or otherwise taken
       from the application being measured (e.g., a TCP options stack),
       the multiple-item structure can be exported as a variable-length
       octetArray Information Element holding the raw content.

   Specifically, a new Information Element should not encode any
   multiplicity or ordinality information into the definition of the
   Information Element itself.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/4.7.%20%20Enumerated%20Values%20and%20Subregistries"></a><a class="selflink" href="#section-4.7" id="section-4.7">4.7</a>.  Enumerated Values and Subregistries</span>

   When defining an Information Element that takes an enumerated value
   from a set of values that may change in the future, this enumeration
   must be defined by an IANA IE registry or subregistry.  For
   situations where an existing registry defines the enumeration (e.g.,
   the IANA Protocol Numbers registry for the protocolIdentifier
   Information Element), that registry must be used.  Otherwise, a new
   subregistry of the IANA IPFIX registry must be defined for the
   enumerated value, to be modified subject to Expert Review [<a href="./rfc5226" title="">RFC5226</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/4.8.%20%20Reversibility%20as%20per%20RFC%205103"></a><a class="selflink" href="#section-4.8" id="section-4.8">4.8</a>.  Reversibility as per <a href="./rfc5103">RFC 5103</a></span>

   [<a id="ref-RFC5103">RFC5103</a>] defines a method for exporting bidirectional Flows using a
   special Private Enterprise Number to define reverse-direction
   variants of IANA Information Elements, and a set of criteria for
   determining whether an Information Element may be reversed using this
   method.  Since almost all Information Elements are reversible,
   [<a href="./rfc5103" title='"Bidirectional Flow Export Using IP Flow Information Export (IPFIX)"'>RFC5103</a>] enumerates those Information Elements that were defined at
   the time of its publication that are NOT reversible.

   New non-reversible Information Elements must contain a note in the
   description stating that they are not reversible.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/4.9.%20%20Avoiding%20Bad%20Ideas%20in%20Information%20Element%20Design"></a><a class="selflink" href="#section-4.9" id="section-4.9">4.9</a>.  Avoiding Bad Ideas in Information Element Design</span>

   In general, the existence of a similarly defined Information Element
   in the IANA IE registry sets a precedent that may be followed to
   determine whether a given proposed Information Element "fits" within
   the registry.  Indeed, the rules specified by this document could be



<span class="grey">Trammell &amp; Claise         Best Current Practice                [Page 11]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-12"></span>
<span class="grey"><a href="./rfc7013">RFC 7013</a>                    IPFIX IE-DOCTORS              September 2013</span>


   interpreted to mean "make new Information Elements that look like
   existing Information Elements".  However, for reasons of history,
   there are several Information Elements within the IANA IE registry
   that do not follow best practices in Information Element design.

   These Information Elements are not necessarily so flawed so as to
   require deprecation, but they should be explicitly ignored when
   looking for guidance as to whether a new Information Element should
   be added.  Here we provide a set of representative examples taken
   from the IANA IE registry; in general, entries in the IANA IE
   registry that do not follow the guidelines in this document should
   not be used as examples for new Information Element definitions.

   Before registering a new Information Element, it must be determined
   that it would be sufficiently unique within the IANA IE registry.
   This evaluation has not always been done in the past, and the
   existence of the Information Elements defined without this evaluation
   should not be taken as an example that such Information Element
   definition practices should be followed in the future.  Specific
   examples of such Information Elements include initiatorOctets and
   responderOctets (which duplicate octetDeltaCount and its reverse per
   [<a href="./rfc5103" title='"Bidirectional Flow Export Using IP Flow Information Export (IPFIX)"'>RFC5103</a>]) and initiatorPackets and responderPackets (the same, for
   packetDeltaCount).

   As mentioned in <a href="#section-4.2">Section 4.2</a>, the type of an Information Element
   should match the type of data the Information Element represents.  An
   example of how not to do this is presented by the p2pTechnology,
   tunnelTechnology, and encryptedTechnology Information Elements: these
   represent a three-state enumeration using a String.  The example set
   by these Information Elements should not be followed in the
   definition of new Information Elements.

   As mentioned in <a href="#section-4.6">Section 4.6</a>, an Information Element definition should
   not include any ordinality or multiplicity information.  The only
   example of this within the IANA IE registry the following list of
   assigned IPFIX Information Elements: mplsTopLabelStackSection,
   mplsLabelStackSection2, mplsLabelStackSection3,
   mplsLabelStackSection4, mplsLabelStackSection5,
   mplsLabelStackSection6 mplsLabelStackSection7,
   mplsLabelStackSection8, mplsLabelStackSection9, and
   mplsLabelStackSection10.  The only distinction between those almost-
   identical Information Elements is the position within the MPLS stack.
   This Information Element design pattern met an early requirement of
   the definition of IPFIX that was not carried forward into the final
   specification -- namely, that no semantic dependency was allowed
   between Information Elements in the same Record -- and as such should
   not be followed in the definition of new Information Elements.  In
   this case, since the size of the MPLS stack will vary from Flow to



<span class="grey">Trammell &amp; Claise         Best Current Practice                [Page 12]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-13"></span>
<span class="grey"><a href="./rfc7013">RFC 7013</a>                    IPFIX IE-DOCTORS              September 2013</span>


   Flow, it should be exported using IPFIX Structured Data [<a href="./rfc6313" title='"Export of Structured Data in IP Flow Information Export (IPFIX)"'>RFC6313</a>]
   where supported, as a basicList of MPLS label entries, or as a raw
   MPLS label stack using the variable-length
   mplsLabelStackSection Information Element.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.%20%20The%20Information%20Element%20Life%20Cycle"></a><a class="selflink" href="#section-5" id="section-5">5</a>.  The Information Element Life Cycle</span>

   Once an Information Element or set of Information Elements has been
   identified for a given application, Information Element
   specifications in accordance with <a href="#section-4">Section 4</a> are submitted to IANA to
   follow the process for review by the IE-DOCTORS, as defined below.
   This process is also used for other changes to the IANA IE registry,
   such as deprecation or revision, as described later in this section.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.1.%20%20The%20Process%20for%20Review%20by%20the%20IE-DOCTORS"></a><a class="selflink" href="#section-5.1" id="section-5.1">5.1</a>.  The Process for Review by the IE-DOCTORS</span>

   Requests to change the IANA IE registry or a linked subregistry are
   submitted to IANA, which forwards the request to a designated group
   of experts (IE-DOCTORS) appointed by the IESG; these are the
   reviewers called for by the Expert Review [<a href="./rfc5226" title="">RFC5226</a>] policy defined
   for the IANA IE registry by [<a href="./rfc7012" title='"Information Model for IP Flow Information Export (IPFIX)"'>RFC7012</a>].  The IE-DOCTORS review the
   request for such things as compliance with this document, compliance
   with other applicable IPFIX-related RFCs, and consistency with the
   currently defined set of Information Elements.

   Authors are expected to review compliance with the specifications in
   this document to check their submissions before sending them to IANA.

   The IE-DOCTORS should endeavor to complete referred reviews in a
   timely manner.  If the request is acceptable, the IE-DOCTORS signify
   their approval to IANA, which changes the IANA IE registry.  If the
   request is not acceptable, the IE-DOCTORS can coordinate with the
   requestor to change the request to be compliant.  The IE-DOCTORS may
   also choose in exceptional circumstances to reject clearly frivolous
   or inappropriate change requests outright.

   This process should not in any way be construed as allowing the IE-
   DOCTORS to overrule IETF consensus.  Specifically, Information
   Elements in the IANA IE registry that were added with IETF consensus
   require IETF consensus for revision or deprecation.

   Decisions by the IE-DOCTORS may be appealed as in <a href="./rfc5226#section-7">Section 7 of
   [RFC5226]</a>.








<span class="grey">Trammell &amp; Claise         Best Current Practice                [Page 13]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-14"></span>
<span class="grey"><a href="./rfc7013">RFC 7013</a>                    IPFIX IE-DOCTORS              September 2013</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.2.%20%20Revising%20Information%20Elements"></a><a class="selflink" href="#section-5.2" id="section-5.2">5.2</a>.  Revising Information Elements</span>

   The Information Element status field in the IANA IE registry is
   defined in [<a href="./rfc7012" title='"Information Model for IP Flow Information Export (IPFIX)"'>RFC7012</a>] to allow Information Elements to be 'current' or
   'deprecated'.  No Information Elements are as of this writing
   deprecated.  [<a href="./rfc5102" title='"Information Model for IP Flow Information Export"'>RFC5102</a>] additionally specified an 'obsolete' status;
   however, this has been removed on revision as it served no
   operational purpose.

   In addition, no policy is defined for revising IANA IE registry
   entries or addressing errors therein.  To be certain, changes and
   deprecations within the IANA IE registry are not encouraged, and
   should be avoided to the extent possible.  However, in recognition
   that change is inevitable, this section is intended to remedy this
   situation.

   Changes are initiated by sending a new Information Element definition
   to IANA, as in <a href="#section-5.1">Section 5.1</a>, for an already-existing Information
   Element.

   The primary requirement in the definition of a policy for managing
   changes to existing Information Elements is avoidance of
   interoperability problems; IE-DOCTORS must work to maintain
   interoperability above all else.  Changes to Information Elements
   already in use may only be done in an interoperable way; necessary
   changes that cannot be done in a way to allow interoperability with
   unchanged implementations must result in deprecation.

   A change to an Information Element is held to be interoperable only
   when:

   1.  it involves the correction of an error that is obviously only
       editorial; or

   2.  it corrects an ambiguity in the Information Element's definition,
       which itself leads to non-interoperability severe enough to
       prevent the Information Element's usage as originally defined
       (e.g., a prior change to ipv6ExtensionHeaders); or

   3.  it expands the Information Element's data type without changing
       how it is represented (e.g., changing unsigned32 to unsigned64,
       as with a prior change to selectorId); or

   4.  it corrects missing information in the Information Element's
       definition without changing its meaning (e.g., the explicit
       definition of 'quantity' semantics for numeric Information
       Elements without a Data Type Semantics value); or




<span class="grey">Trammell &amp; Claise         Best Current Practice                [Page 14]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-15"></span>
<span class="grey"><a href="./rfc7013">RFC 7013</a>                    IPFIX IE-DOCTORS              September 2013</span>


   5.  it defines a previously undefined or reserved enumerated value,
       or one or more previously reserved bits in an Information Element
       with flag semantics; or

   6.  it expands the set of permissible values in the Information
       Element's range; or

   7.  it harmonizes with an external reference that was itself
       corrected.

   If a change is deemed permissible by the IE-DOCTORS, IANA makes the
   change in the IANA IE registry.  The requestor of the change is
   appended to the requestor in the registry.

   Each Information Element in the IANA IE registry has a revision
   number, starting at zero.  Each change to an Information Element
   following this process increments the revision number by one.  Since
   any revision must be interoperable according to the criteria above,
   there is no need for the IANA IE registry to store information about
   old revisions.

   When a revised Information Element is accepted into the registry, the
   date of acceptance of the most recent revision is placed into the
   revision Date column of the registry for that Information Element.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.3.%20%20Deprecating%20Information%20Elements"></a><a class="selflink" href="#section-5.3" id="section-5.3">5.3</a>.  Deprecating Information Elements</span>

   Changes that are not permissible by these criteria may only be
   handled by deprecation.  An Information Element MAY be deprecated and
   replaced when:

   1.  the Information Element definition has an error or shortcoming
       that cannot be permissibly changed as in <a href="#section-5.2">Section 5.2</a>; or

   2.  the deprecation harmonizes with an external reference that was
       itself deprecated through that reference's accepted deprecation
       method; or

   3.  changes in the IPFIX protocol or its extensions, or in community
       understanding thereof, allow the information represented by the
       Information Element to be represented in a more efficient or
       convenient way.  Deprecation in this circumstance requires a
       Standards Action.

   A request for deprecation is sent to IANA, which passes it to the IE-
   DOCTORS for review, as in <a href="#section-5.1">Section 5.1</a>.  When deprecating an
   Information Element, the Information Element description in the IANA




<span class="grey">Trammell &amp; Claise         Best Current Practice                [Page 15]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-16"></span>
<span class="grey"><a href="./rfc7013">RFC 7013</a>                    IPFIX IE-DOCTORS              September 2013</span>


   IE registry must be updated to explain the deprecation, as well as to
   refer to any new Information Elements created to replace the
   deprecated Information Element.

   The revision number of an Information Element is incremented upon
   deprecation, and the revision Date updated, as with any revision.

   Deprecated Information Elements should continue to be supported by
   Collecting Processes, but should not be exported by Exporting
   Processes.  The use of deprecated Information Elements should result
   in a log entry or human-readable warning at the Exporting and
   Collecting Processes.

   Names and elementIDs of deprecated Information Elements must not be
   reused.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/6.%20%20When%20Not%20to%20Define%20New%20Information%20Elements"></a><a class="selflink" href="#section-6" id="section-6">6</a>.  When Not to Define New Information Elements</span>

   Due to the relatively limited number space of Information Elements in
   the IANA IE registry, and the fact that the difficulty of managing
   and understanding the registry increases with its size, avoiding
   redundancy and clutter in the registry is important in defining new
   applications.  New Information Elements should not be added to the
   IANA IE registry unless there is an intent to implement and deploy
   applications using them; research or experimental applications should
   use enterprise-specific Information Elements as in <a href="#section-6.2">Section 6.2</a>
   instead.

   The subsections below provide guidelines for reuse of existing
   Information Elements, as well as guidelines on using enterprise-
   specific Information Elements instead of adding Information Elements
   in the IANA IE registry.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/6.1.%20%20Maximizing%20Reuse%20of%20Existing%20Information%20Elements"></a><a class="selflink" href="#section-6.1" id="section-6.1">6.1</a>.  Maximizing Reuse of Existing Information Elements</span>

   Whenever possible, new applications should prefer usage of existing
   IPFIX Information Elements to the creation of new Information
   Elements.  IPFIX already provides Information Elements for every
   common Layer 4 and Layer 3 packet header field in the IETF protocol
   suite, basic Layer 2 information, basic counters, timestamps and time
   ranges, and so on.  When defining a new Information Element similar
   to an existing one, reviewers should ensure that the existing one is
   not applicable.

   Note that this guideline to maximize reuse does not imply that an
   Information Element that represents the same information from a
   packet as an existing Information Element should not be added to the
   IANA IE registry.  For example, consider the ipClassOfService



<span class="grey">Trammell &amp; Claise         Best Current Practice                [Page 16]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-17"></span>
<span class="grey"><a href="./rfc7013">RFC 7013</a>                    IPFIX IE-DOCTORS              September 2013</span>


   (Element ID 5), ipDiffServCodePoint (Element ID 98), and ipPrecedence
   (Element ID 196) Information Elements.  These all represent subsets
   of the same field in an IP version 4 packet header, but different
   uses of these bits.  The representation in one or another of these
   Information Elements contains information in itself as to how the
   bits were interpreted by the Metering Process.

   On the other hand, simply changing the context in which an
   Information Element will be used is insufficient reason for the
   definition of a new Information Element.  For example, an extension
   of IPFIX to log detailed information about HTTP transactions
   alongside network-level information should not define
   httpClientAddress and httpServerAddress Information Elements,
   preferring instead the use of sourceIPv[46]Address and
   destinationIPv[46]Address.

   Applications dealing with bidirectional interactions should use
   Bidirectional Flow Support for IPFIX [<a href="./rfc5103" title='"Bidirectional Flow Export Using IP Flow Information Export (IPFIX)"'>RFC5103</a>] to represent these
   interactions.

   Existing timestamp and time range Information Elements should be
   reused for any situation requiring simple time stamping of an event:
   for single observations, the observationTime* Information Elements
   from PSAMP are provided, and for events with a duration, the
   flowStart* and flowEnd* Information Elements suffice.  This
   arrangement allows minimal generic time handling by existing
   Collecting Processes and analysis workflows.  New timestamp
   Information Elements should ONLY be defined for semantically distinct
   timing information (e.g., an IPFIX-exported record containing
   information about an event to be scheduled in the future).

   In all cases, the use of absolute timestamp Information Elements
   (e.g., flowStartMilliseconds) is recommended, as these Information
   Elements allow for maximum flexibility in processing with minimal
   overhead.  Timestamps based on the Export Time header in the
   enclosing IPFIX Message (e.g., flowStartTimeDeltaMicroseconds) MAY be
   used if high-precision timing is important, export bandwidth or
   storage space is limited, timestamps comprise a relatively large
   fraction of record size, and the application naturally groups records
   into IPFIX Messages.  Timestamps based on information that must be
   exported in a separate Data Record defined by an Options Template
   (e.g., flowStartSysUpTime) MAY be used only in the context of an
   existing practice of using runtime-defined epochs for the given
   application.  New applications should avoid these structures when
   possible.






<span class="grey">Trammell &amp; Claise         Best Current Practice                [Page 17]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-18"></span>
<span class="grey"><a href="./rfc7013">RFC 7013</a>                    IPFIX IE-DOCTORS              September 2013</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/6.2.%20%20Applying%20Enterprise-Specific%20Information%20Elements"></a><a class="selflink" href="#section-6.2" id="section-6.2">6.2</a>.  Applying Enterprise-Specific Information Elements</span>

   IPFIX provides a mechanism for defining enterprise-specific
   Information Elements, as in <a href="./rfc7011#section-3.2">Section 3.2 of [RFC7011]</a>.  These are
   scoped to a vendor's or organization's Structure of Management
   Information (SMI) Private Enterprise Number, and are under complete
   control of the organization assigning them.

   For situations in which interoperability is unimportant, new
   information should be exported using enterprise-specific Information
   Elements instead of adding new Information Elements to the IANA IE
   registry.  These situations include:

   o  export of implementation-specific information, or

   o  export of information supporting research or experiments within a
      single organization or closed community, or

   o  export of information derived in a commercially sensitive or
      proprietary method, or

   o  export of information or meta-information specific to a
      commercially sensitive or proprietary application.

   While work within the IETF generally does not fall into these
   categories, enterprise-specific Information Elements are also useful
   for pre-standardization testing of a new IPFIX application.  While
   performing initial development and interoperability testing of a new
   application, the Information Elements used by the application should
   not be submitted to IANA for inclusion in the IANA IE registry.
   Instead, these experimental Information Elements should be
   represented as enterprise-specific until their definitions are
   finalized.

   As this document contains best practices for defining new Information
   Elements, organizations using enterprise-specific Information
   Elements are advised to follow the guidelines set forth here even if
   not submitting Information Elements for inclusion in the IANA IE
   registry.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/7.%20%20Information%20Element%20Definition%20Checklist"></a><a class="selflink" href="#section-7" id="section-7">7</a>.  Information Element Definition Checklist</span>

   The following three checklists, condensed from the rest of this
   document, can be used when defining and reviewing Information
   Elements; they refer back to the section of this document from which
   they are taken.  These checklists are intended for the definition of





<span class="grey">Trammell &amp; Claise         Best Current Practice                [Page 18]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-19"></span>
<span class="grey"><a href="./rfc7013">RFC 7013</a>                    IPFIX IE-DOCTORS              September 2013</span>


   new Information Elements; revision should follow the process defined
   in <a href="#section-5.2">Section 5.2</a>, and deprecation should follow the process defined in
   <a href="#section-5.3">Section 5.3</a>.

   Though many of the considerations in this document require the
   subjective judgement of Information Element authors, reviewers, and
   IANA, certain parts of the process may be made simpler through tool
   support.  Items on these checklists that could be easily automated or
   assisted by tools are annotated with "(tool support)".  Other items
   on these checklists require some level of subjective judgement;
   checks for semantic uniqueness may additionally be supported by
   textual analysis of descriptions in the future.

   Checklist 1 contains conditions that must be met by all proposed
   Information Elements:

   1.  The name must be unique within the IANA IE registry, and the name
       of any current or deprecated Information Element must not be
       reused. (<a href="#section-4.1">Section 4.1</a>) (tool support)

   2.  The description must be sufficiently semantically unique within
       the IANA IE registry, representing a substantially different
       meaning from any current or deprecated Information Element.
       (<a href="#section-4">Section 4</a>)

   3.  The name must start with a lowercase letter. (<a href="#section-4.1">Section 4.1</a>) (tool
       support)

   4.  Names composed of more than one word must use capital letters for
       the first letter of each component except for the first one; all
       other letters are lowercase, even for acronyms.  Exceptions are
       made for acronyms containing a mixture of lowercase and capital
       letters, such as 'IPv4' and 'IPv6'. (<a href="#section-4.1">Section 4.1</a>) (tool support)

   5.  The data type must match the type of the data being represented.
       (<a href="#section-4.2">Section 4.2</a>)

   6.  Data type semantics must be appropriate for the data type.
       (<a href="#section-4.4">Section 4.4</a>) (tool support)

   7.  The Information Element identifier assigned by IANA must be
       unique. (<a href="#section-4.3">Section 4.3</a>) (tool support)

   8.  The Information Element must be reviewed for the potential of
       information leakage or other misuse that could reduce the
       security of the measured system; security considerations specific
       to the Information Element must be discussed in the description
       or in a supporting RFC.  (<a href="#section-11">Section 11</a>)



<span class="grey">Trammell &amp; Claise         Best Current Practice                [Page 19]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-20"></span>
<span class="grey"><a href="./rfc7013">RFC 7013</a>                    IPFIX IE-DOCTORS              September 2013</span>


   Checklist 2 contains conditions that must be met by proposed
   Information Elements with certain properties, as noted:

   1.  Time values must be defined with appropriate precision.
       (<a href="#section-4.2">Section 4.2</a>)

   2.  Strings and octet arrays with length restrictions must note those
       length restrictions in their descriptions. (<a href="#section-4.2">Section 4.2</a>)

   3.  Enumerations must refer to an IANA IE registry or subregistry, or
       a registry maintained by an external standards organization.  If
       no suitable registry or subregistry exists, a new subregistry of
       the IPFIX Information Element registry must be created for the
       enumeration, to be modified subject to Expert Review [<a href="./rfc5226" title="">RFC5226</a>].
       (<a href="#section-4.7">Section 4.7</a>)

   Checklist 3 contains conditions that should be met by proposed
   Information Elements:

   1.   The name of an Information Element pertaining to a specific
        protocol or application should contain the name of the protocol
        or application as the first word. (<a href="#section-4.1">Section 4.1</a>)

   2.   Information Elements representing integral values should use a
        data type for the appropriate width for the value.
        (<a href="#section-4.2">Section 4.2</a>)

   3.   Information Elements representing counters or identifiers should
        be represented as signed64 or unsigned64, unless they are
        naturally represented with narrower integral types, as
        appropriate. (<a href="#section-4.2">Section 4.2</a>)

   4.   An Information Element should not contain internal structure,
        subject to the exceptions in <a href="#section-4.5">Section 4.5</a>; candidate Information
        Elements with internal structure should be decomposed into
        multiple Information Elements. (<a href="#section-4.5">Section 4.5</a>)

   5.   An Information Element should not contain multiplicity or
        ordinality information within the definition of the Information
        Element itself. (<a href="#section-4.6">Section 4.6</a>)

   6.   Data type semantics should be defined, if appropriate.
        (<a href="#section-4.4">Section 4.4</a>) (tool support)

   7.   Units should be defined, if appropriate, with new units added to
        the Information Element Units subregistry if necessary.
        (<a href="#section-4.4">Section 4.4</a>) (tool support)




<span class="grey">Trammell &amp; Claise         Best Current Practice                [Page 20]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-21"></span>
<span class="grey"><a href="./rfc7013">RFC 7013</a>                    IPFIX IE-DOCTORS              September 2013</span>


   8.   Ranges should be defined, if appropriate. (<a href="#section-4.4">Section 4.4</a>) (tool
        support)

   9.   Non-reversible Information Elements (see [<a href="./rfc5103" title='"Bidirectional Flow Export Using IP Flow Information Export (IPFIX)"'>RFC5103</a>]) should note
        non-reversibility in the description. (<a href="#section-4.8">Section 4.8</a>)

   10.  Information Elements to be registered with IANA should be
        intended for implementation and deployment on production
        networks.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/8.%20%20Applying%20IPFIX%20to%20Non-Flow%20Applications"></a><a class="selflink" href="#section-8" id="section-8">8</a>.  Applying IPFIX to Non-Flow Applications</span>

   At the core of IPFIX is its definition of a Flow, a set of packets
   sharing some common properties crossing an Observation Point within a
   certain time window.  However, the reliance on this definition does
   not preclude the application of IPFIX to domains that are not
   obviously handling Flow data according to this definition.  Most
   network management data collection tasks, those to which IPFIX is
   most applicable, have at their core the movement of packets from one
   place to another; by a liberal interpretation of the common
   properties defining the Flow, then, almost any event handled by these
   can be held to concern data records conforming to the IPFIX
   definition of a Flow.

   Non-Flow information defining associations or key-value pairs, on the
   other hand, are defined by IPFIX Options Templates.  Here, the
   Information Elements within an Options Template Record are divided
   into Scope Information Elements that define the key and non-scope
   Information Elements that define the values associated with that key.
   Unlike Flows, Data Records defined by Options Templates are not
   necessarily scoped in time; these Data Records are generally held to
   be in effect until a new set of values for a specific set of keys is
   exported.  While this mechanism is often used by IPFIX to export
   metadata about the collection infrastructure, it is applicable to any
   association information.

   An IPFIX application can mix Data Records described either type of
   template in an IPFIX Message or Message stream, and exploit
   relationships among the Flow Keys, values, and Scopes to create
   interrelated data structures.  See [<a href="./rfc5473" title='"Reducing Redundancy in IP Flow Information Export (IPFIX) and Packet Sampling (PSAMP) Reports"'>RFC5473</a>] for an example
   application of this.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/9.%20%20Writing%20Internet-Drafts%20for%20IPFIX%20Applications"></a><a class="selflink" href="#section-9" id="section-9">9</a>.  Writing Internet-Drafts for IPFIX Applications</span>

   When a new application is complex enough to require additional
   clarification or specification as to the use of the defined
   Information Elements, this may be given in an Internet-Draft.




<span class="grey">Trammell &amp; Claise         Best Current Practice                [Page 21]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-22"></span>
<span class="grey"><a href="./rfc7013">RFC 7013</a>                    IPFIX IE-DOCTORS              September 2013</span>


   Internet-Drafts for new IPFIX applications are best submitted to a
   Working Group with expertise in the area of the new application, or
   to the Independent Submission stream.

   When defining new Information Elements in an Internet-Draft, the
   Internet-Draft should contain a section (or subsection) for each
   Information Element, which contains the attributes in <a href="#section-4">Section 4</a> in
   human-readable form.  An example subsection is given below.  These
   Information Element descriptions should not assign Information
   Element numbers, instead using placeholder identifiers for these
   numbers (e.g., "TBD1", "TBD2", "TBD3") and a note to IANA in the IANA
   Considerations section to replace those placeholders in the document
   with Information Element numbers when the numbers are assigned.  The
   use of these placeholder definitions allows references to the numbers
   in, e.g., box-and-line diagrams or template definitions as in
   <a href="#section-10">Section 10</a>.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/9.1.%20%20Example%20Information%20Element%20Definition"></a><a class="selflink" href="#section-9.1" id="section-9.1">9.1</a>.  Example Information Element Definition</span>

   This is an example of an Information Element definition that would
   appear in an Internet-Draft.  The name appears in the section title.

   Description:   Description goes here.; obligatory

   Data Type:   Data type goes here; obligatory

   Data Type Semantics:   Data type semantics, if any, go here; optional

   Units:   Units, if any, go here; optional

   Range:   Range, if not implied by the data type, goes here; optional

   References:   References to other RFCs or documents outside the IETF,
      in which additional information is given, or which are referenced
      by the description, go here; optional

   ElementId:   ElementId, if known, or "TBD" if it will be assigned by
      IANA and filled in at publication time.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/9.2.%20%20Defining%20Recommended%20Templates"></a><a class="selflink" href="#section-9.2" id="section-9.2">9.2</a>.  Defining Recommended Templates</span>

   New IPFIX applications should not, in the general case, define fixed
   templates for export, as this throws away much of the flexibility
   afforded by IPFIX.  However, fixed template export is permissible in
   the case that the export implementation must operate in a resource-
   constrained environment, and/or that the application is replacing an
   existing fixed-format binary export format in a maximally compatible




<span class="grey">Trammell &amp; Claise         Best Current Practice                [Page 22]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-23"></span>
<span class="grey"><a href="./rfc7013">RFC 7013</a>                    IPFIX IE-DOCTORS              September 2013</span>


   way.  In any case, Collecting Processes for such applications should
   support the collection Templates with Information Elements in any
   order, or Templates with additional Information Elements.

   An Internet-Draft clarifying the use of new Information Elements
   should include any recommended Template or Options Template Records
   necessary for supporting the application, as well as examples of
   records exported using these Template Records.  In defining these
   Template Records, such Internet-Drafts should mention, subject to
   rare exceptions:

   1.  that the order of different Information Elements within a
       Template is not significant;

   2.  that Templates on the wire for the application may also contain
       additional Information Elements beyond those specified in the
       recommended Template;

   3.  that a stream of IPFIX Messages supporting the application may
       also contain Data Records not described by the recommended
       Templates; and

   4.  that any reader of IPFIX Messages supporting the application must
       accept these conditions.

   Definitions of recommended Template Records for Flow-like
   information, where the Flow Key is well-defined, should indicate
   which of the Information Elements in the recommended Template are
   Flow Keys.

   Recommended Templates are defined, for example, in [<a href="./rfc5476" title='"Packet Sampling (PSAMP) Protocol Specifications"'>RFC5476</a>] for
   PSAMP packet reports (<a href="#section-6.4.1">Section 6.4.1</a>) and extended packet reports
   (<a href="#section-6.4.2">Section 6.4.2</a>).  Recommended Options Templates are defined
   extensively throughout the IPFIX documents, including in the protocol
   document itself [<a href="./rfc7011" title='"Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of Flow Information"'>RFC7011</a>] for exporting export statistics; in the
   file format [<a href="./rfc5655" title='"Specification of the IP Flow Information Export (IPFIX) File Format"'>RFC5655</a>] for exporting file metadata; and in
   intermediate process definitions such as [<a href="./rfc6235" title='"IP Flow Anonymization Support"'>RFC6235</a>] for intermediate
   process metadata.  The discussion in these examples is a good model
   for recommended template definitions.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/10.%20%20A%20Textual%20Format%20for%20Specifying%20Information%20Elements%20and%20Templates"></a><a class="selflink" href="#section-10" id="section-10">10</a>.  A Textual Format for Specifying Information Elements and Templates</span>

   Example Templates given in existing IPFIX documents are generally
   expressed using bitmap diagrams of the respective Templates.  These
   are illustrative of the wire representation of simple Templates, but
   not particularly readable for more complicated recommended Templates,
   provide no support for rapid implementation of new Templates, and do
   not adequately convey the optional nature of ordering and additional



<span class="grey">Trammell &amp; Claise         Best Current Practice                [Page 23]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-24"></span>
<span class="grey"><a href="./rfc7013">RFC 7013</a>                    IPFIX IE-DOCTORS              September 2013</span>


   Information Elements.  Therefore, we define a recommended textual
   format for specifying Information Elements and Templates in Internet-
   Drafts in this section.

   Here we define a simple textual syntax for describing IPFIX
   Information Elements and IPFIX Templates, with human readability,
   human writability, compactness, and ease of parser/generator
   implementation without requiring external XML support as design
   goals.  It is intended for use both in human communication (e.g., in
   new Internet-Drafts containing higher-level descriptions of IPFIX
   Templates, or describing sets of new IPFIX Information Elements for
   supporting new applications of the protocol) as well as at runtime by
   IPFIX implementations.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/10.1.%20%20Information%20Element%20Specifiers"></a><a class="selflink" href="#section-10.1" id="section-10.1">10.1</a>.  Information Element Specifiers</span>

   The basis of this format is the textual Information Element
   Specifier, or IESpec.  An IESpec contains each of the four important
   aspects of an Information Element: its name, its number, its type,
   and its size, separated by simple markup based on various types of
   brackets.  Fully qualified IESpecs may be used to specify existing or
   new Information Elements within an Information Model, while either
   fully qualified or partial IESpecs may be used to define fields in a
   Template.

   Bare words are used for Information Element names, and each aspect of
   information associated with an Information Element is associated with
   a type of brackets:

   o  () parentheses for Information Element numbers,

   o  &lt;&gt; angle brackets for Information Element data types, and

   o  [] square brackets for Information Element sizes.

   o  {} curly braces contain an optional space-separated list of
      context identifiers to be associated with an Information Element,
      as described in more detail in <a href="#section-10.2">Section 10.2</a>

   The symbol + is reserved for Information Elements nesting within
   structured data elements; these are described in <a href="#section-10.3">Section 10.3</a>.

   Whitespace in IESpecs is insignificant; spaces can be added after
   each element in order, e.g., to align columns for better readability.







<span class="grey">Trammell &amp; Claise         Best Current Practice                [Page 24]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-25"></span>
<span class="grey"><a href="./rfc7013">RFC 7013</a>                    IPFIX IE-DOCTORS              September 2013</span>


   The basic form of a fully qualified IESpec for an IANA-registered
   Information Element is as follows:

   name(number)&lt;type&gt;[size]

   where 'name' is the name of the Information Element in UTF-8,
   'number' is the Information Element as a decimal integer, 'type' is
   the name of the data type as in the IANA informationElementDataTypes
   registry, and 'size' is the length of the Information Element in
   octets as a decimal integer, where 65535 or the string 'v' signifies
   a variable-length Information Element. [size] may be omitted.  In
   this case, the data type's native or default size is assumed.

   The basic form of a fully qualified IESpec for an enterprise-specific
   Information Element is as follows:

   name(pen/number)&lt;type&gt;[size]

   where 'pen' is the Private Enterprise Number as a decimal integer.

   A fully qualified IESpec is intended to express enough information
   about an Information Element to decode and display Data Records
   defined by Templates containing that Information Element.  Range,
   unit, semantic, and description information, as in [<a href="./rfc5610" title='"Exporting Type Information for IP Flow Information Export (IPFIX) Information Elements"'>RFC5610</a>], is not
   supported by this syntax.

   Example fully qualified IESpecs follow:

      octetDeltaCount(1)&lt;unsigned64&gt;[8]

      octetDeltaCount(1)&lt;unsigned64&gt; (unsigned64 is natively 8 octets
      long)

      sourceIPv4Address(8)&lt;ipv4Address&gt;

      wlanSSID(146)&lt;string&gt;[v]

      sipRequestURI(35566/403)&lt;string&gt;[65535]

   A partial IESpec is any IESpec that is not fully qualified; these are
   useful when defining templates.  A partial IESpec is assumed to take
   missing values from its canonical definition in the IANA IE registry.
   At minimum, a partial IESpec must contain a name, or a number.  Any
   name, number, or type information given with a partial IESpec must
   match the values given in the Information Model; however, size
   information in a partial IESpec overrides size information in the
   Information Model; in this way, IESpecs can be used to express
   reduced-size encoding for Information Elements.



<span class="grey">Trammell &amp; Claise         Best Current Practice                [Page 25]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-26"></span>
<span class="grey"><a href="./rfc7013">RFC 7013</a>                    IPFIX IE-DOCTORS              September 2013</span>


   Example partial IESpecs follow:

   o  octetDeltaCount

   o  octetDeltaCount[4] (reduced-size encoding)

   o  (1)

   o  (1)[4] (reduced-size encoding; note that this is exactly
      equivalent to an Information Element specifier in a Template)

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/10.2.%20%20Specifying%20Templates"></a><a class="selflink" href="#section-10.2" id="section-10.2">10.2</a>.  Specifying Templates</span>

   A Template can then be defined simply as an ordered, newline-
   separated sequence of IESpecs.  IESpecs in example Templates
   illustrating a new application of IPFIX should be fully qualified.
   Flow Keys may be optionally annotated by appending the {key} context
   to the end of each Flow Key specifier.  A template counting packets
   and octets per 5-tuple with millisecond precision in IESpec syntax is
   shown in Figure 1.

   flowStartMilliseconds(152)&lt;dateTimeMilliseconds&gt;[8]
   flowEndMilliseconds(153)&lt;dateTimeMilliseconds&gt;[8]
   octetDeltaCount(1)&lt;unsigned64&gt;[8]
   packetDeltaCount(2)&lt;unsigned64&gt;[8]
   sourceIPv4Address(8)&lt;ipv4Address&gt;[4]{key}
   destinationIPv4Address(12)&lt;ipv4Address&gt;[4]{key}
   sourceTransportPort(7)&lt;unsigned16&gt;[2]{key}
   destinationTransportPort(11)&lt;unsigned16&gt;[2]{key}
   protocolIdentifier(4)&lt;unsigned8&gt;[1]{key}

      Figure 1: Sample Flow Template in IESpec Syntax

   An Options Template is specified similarly.  Scope is specified
   appending the {scope} context to the end of each IESpec for a Scope
   IE.  Due to the way Information Elements are represented in Options
   Templates, all {scope} IESpecs must appear before any non-scope
   IESpec.  The Flow Key Options Template defined in <a href="./rfc7011#section-4.4">Section 4.4 of
   [RFC7011]</a> in IESpec syntax is shown in Figure 2.

   templateId(145)&lt;unsigned16&gt;[2]{scope}
   flowKeyIndicator(173)&lt;unsigned64&gt;[8]

      Figure 2: Flow Key Options Template in IESpec Syntax







<span class="grey">Trammell &amp; Claise         Best Current Practice                [Page 26]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-27"></span>
<span class="grey"><a href="./rfc7013">RFC 7013</a>                    IPFIX IE-DOCTORS              September 2013</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/10.3.%20%20Specifying%20IPFIX%20Structured%20Data"></a><a class="selflink" href="#section-10.3" id="section-10.3">10.3</a>.  Specifying IPFIX Structured Data</span>

   IESpecs can also be used to illustrate the structure of the
   information exported using the IPFIX Structured Data extension
   [<a href="./rfc6313" title='"Export of Structured Data in IP Flow Information Export (IPFIX)"'>RFC6313</a>].  Here, the semantics of the structured data elements are
   specified using contexts, and the Information Elements within each
   structured data element follow the structured data element, prefixed
   with + to show they are contained therein.  Arbitrary nesting of
   structured data elements is possible by using multiple + signs in the
   prefix.  For example, a basic list of IP addresses with "one or more"
   semantics would be expressed using partially qualified IESpecs as
   shown in Figure 3.

   basicList{oneOrMoreOf}
   +sourceIPv4Address(8)[4]

      Figure 3: Sample basicList in IESpec Syntax

   And an example subTemplateList itself containing a basicList is shown
   in Figure 4.

   subTemplateList{allOf}
   +basicList{oneOrMoreOf}
   ++sourceIPv4Address(8)[4]
   +destinationIPv4Address(12)[4]

      Figure 4: Sample subTemplateList in IESpec Syntax

   This describes a subTemplateMultilist containing all of the expressed
   set of source-destination pairs, where the source address itself
   could be one of any number in a basicList (e.g., in the case of SCTP
   multihoming).

   The contexts associable with structured data Information Elements are
   the semantics, as defined in <a href="./rfc6313#section-4.4">Section 4.4 of [RFC6313]</a>; a structured
   data Information Element without any context is taken to have
   undefined semantics.  More information on the application of
   structured data is available in [<a href="./rfc6313" title='"Export of Structured Data in IP Flow Information Export (IPFIX)"'>RFC6313</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/11.%20%20Security%20Considerations"></a><a class="selflink" href="#section-11" id="section-11">11</a>.  Security Considerations</span>

   The IE-DOCTORS must evaluate the security aspects of new Information
   Elements in light of the information they could provide to support
   potential attacks against the measured network or entities about
   which information is exported.  Specific security aspects to evaluate
   include whether the exported information contains personally
   identifiable information, or information that should be kept
   confidential about the described entities (e.g., partial payload, or



<span class="grey">Trammell &amp; Claise         Best Current Practice                [Page 27]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-28"></span>
<span class="grey"><a href="./rfc7013">RFC 7013</a>                    IPFIX IE-DOCTORS              September 2013</span>


   configuration information that could be exploited).  This is not to
   say that such Information Elements should not be defined, but there
   must be an evaluation of the security risk versus the utility of the
   exported information for the intended application.  For example, "A
   Framework for Packet Selection and Reporting" [<a href="./rfc5474" title='"A Framework for Packet Selection and Reporting"'>RFC5474</a>] concluded in
   <a href="#section-12.3.2">Section 12.3.2</a> that the hash function's private parameters should not
   be exported within IPFIX.

   Security considerations specific to an Information Element must be
   addressed in the Security Considerations section of the Internet-
   Draft describing the Information Element, or in the Information
   Element description itself in case the Information Element is not
   defined in an Internet-Draft.  Information Elements with specific
   security considerations should be described in an Internet-Draft.

   For example, the ipHeaderPacketSection in the IPFIX IE registry
   mentions: "This Information Element, which may have a variable
   length, carries a series of octets from the start of the IP header of
   a sampled packet.  With sufficient length, this element also reports
   octets from the IP payload, subject to [<a href="./rfc2804" title='"IETF Policy on Wiretapping"'>RFC2804</a>].  See the Security
   Considerations section".  Another example can be seen in the "Packet
   Sampling (PSAMP) Protocols Specification" [<a href="./rfc5476" title='"Packet Sampling (PSAMP) Protocol Specifications"'>RFC5476</a>]: "In the basic
   Packet Report, a PSAMP Device exports some number of contiguous bytes
   from the start of the packet, including the packet header (which
   includes link layer, network layer, and other encapsulation headers)
   and some subsequent bytes of the packet payload.  The PSAMP Device
   SHOULD NOT export the full payload of conversations, as this would
   mean wiretapping [<a href="./rfc2804" title='"IETF Policy on Wiretapping"'>RFC2804</a>].  The PSAMP Device MUST respect local
   privacy laws."

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/12.%20%20Acknowledgments"></a><a class="selflink" href="#section-12" id="section-12">12</a>.  Acknowledgments</span>

   Thanks to Paul Aitken, Andrew Feren, Dan Romascanu, and David
   Harrington for their reviews and feedback.  Thanks as well to Roni
   Even and Yoav Nir for their area reviews; and to Pete Resnick, Adrian
   Farrel, Stephen Farrell, Stewart Bryant, and Barry Leiba for their
   contributions during IESG discussions.  This work is materially
   supported by the European Union Seventh Framework Programme under
   grant agreement 257315 (DEMONS).












<span class="grey">Trammell &amp; Claise         Best Current Practice                [Page 28]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-29"></span>
<span class="grey"><a href="./rfc7013">RFC 7013</a>                    IPFIX IE-DOCTORS              September 2013</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/13.%20%20References"></a><a class="selflink" href="#section-13" id="section-13">13</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/13.1.%20%20Normative%20References"></a><a class="selflink" href="#section-13.1" id="section-13.1">13.1</a>.  Normative References</span>

   [<a id="ref-RFC5103">RFC5103</a>]  Trammell, B. and E. Boschi, "Bidirectional Flow Export
              Using IP Flow Information Export (IPFIX)", <a href="./rfc5103">RFC 5103</a>,
              January 2008.

   [<a id="ref-RFC5610">RFC5610</a>]  Boschi, E., Trammell, B., Mark, L., and T. Zseby,
              "Exporting Type Information for IP Flow Information Export
              (IPFIX) Information Elements", <a href="./rfc5610">RFC 5610</a>, July 2009.

   [<a id="ref-RFC5226">RFC5226</a>]  Narten, T. and H. Alvestrand, "Guidelines for Writing an
              IANA Considerations Section in RFCs", <a href="https://www.rfc-editor.org/bcp/bcp26">BCP 26</a>, <a href="./rfc5226">RFC 5226</a>,
              May 2008.

   [<a id="ref-RFC6313">RFC6313</a>]  Claise, B., Dhandapani, G., Aitken, P., and S. Yates,
              "Export of Structured Data in IP Flow Information Export
              (IPFIX)", <a href="./rfc6313">RFC 6313</a>, July 2011.

   [<a id="ref-RFC7011">RFC7011</a>]  Claise, B., Ed., Trammell, B., Ed., and P. Aitken,
              "Specification of the IP Flow Information Export (IPFIX)
              Protocol for the Exchange of Flow Information", STD 77,
              <a href="./rfc7011">RFC 7011</a>, September 2013.

   [<a id="ref-RFC7012">RFC7012</a>]  Claise, B., Ed. and B. Trammell, Ed., "Information Model
              for IP Flow Information Export (IPFIX)", <a href="./rfc7012">RFC 7012</a>,
              September 2013.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/13.2.%20%20Informative%20References"></a><a class="selflink" href="#section-13.2" id="section-13.2">13.2</a>.  Informative References</span>

   [<a id="ref-RFC2804">RFC2804</a>]  IAB IESG, "IETF Policy on Wiretapping", <a href="./rfc2804">RFC 2804</a>, May
              2000.

   [<a id="ref-RFC3261">RFC3261</a>]  Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston,
              A., Peterson, J., Sparks, R., Handley, M., and E.
              Schooler, "SIP: Session Initiation Protocol", <a href="./rfc3261">RFC 3261</a>,
              June 2002.

   [<a id="ref-RFC3954">RFC3954</a>]  Claise, B., "Cisco Systems NetFlow Services Export Version
              9", <a href="./rfc3954">RFC 3954</a>, October 2004.

   [<a id="ref-RFC5102">RFC5102</a>]  Quittek, J., Bryant, S., Claise, B., Aitken, P., and J.
              Meyer, "Information Model for IP Flow Information Export",
              <a href="./rfc5102">RFC 5102</a>, January 2008.






<span class="grey">Trammell &amp; Claise         Best Current Practice                [Page 29]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-30"></span>
<span class="grey"><a href="./rfc7013">RFC 7013</a>                    IPFIX IE-DOCTORS              September 2013</span>


   [<a id="ref-RFC5472">RFC5472</a>]  Zseby, T., Boschi, E., Brownlee, N., and B. Claise, "IP
              Flow Information Export (IPFIX) Applicability", <a href="./rfc5472">RFC 5472</a>,
              March 2009.

   [<a id="ref-RFC5473">RFC5473</a>]  Boschi, E., Mark, L., and B. Claise, "Reducing Redundancy
              in IP Flow Information Export (IPFIX) and Packet Sampling
              (PSAMP) Reports", <a href="./rfc5473">RFC 5473</a>, March 2009.

   [<a id="ref-RFC5474">RFC5474</a>]  Duffield, N., Chiou, D., Claise, B., Greenberg, A.,
              Grossglauser, M., and J. Rexford, "A Framework for Packet
              Selection and Reporting", <a href="./rfc5474">RFC 5474</a>, March 2009.

   [<a id="ref-RFC5476">RFC5476</a>]  Claise, B., Johnson, A., and J. Quittek, "Packet Sampling
              (PSAMP) Protocol Specifications", <a href="./rfc5476">RFC 5476</a>, March 2009.

   [<a id="ref-RFC5560">RFC5560</a>]  Uijterwaal, H., "A One-Way Packet Duplication Metric", <a href="./rfc5560">RFC</a>
              <a href="./rfc5560">5560</a>, May 2009.

   [<a id="ref-RFC5655">RFC5655</a>]  Trammell, B., Boschi, E., Mark, L., Zseby, T., and A.
              Wagner, "Specification of the IP Flow Information Export
              (IPFIX) File Format", <a href="./rfc5655">RFC 5655</a>, October 2009.

   [<a id="ref-RFC6235">RFC6235</a>]  Boschi, E. and B. Trammell, "IP Flow Anonymization
              Support", <a href="./rfc6235">RFC 6235</a>, May 2011.

   [<a id="ref-IANA-IPFIX">IANA-IPFIX</a>]
              IANA, "IP Flow Information Export (IPFIX) Entities",
              &lt;<a href="http://www.iana.org/assignments/ipfix">http://www.iana.org/assignments/ipfix</a>&gt;.























<span class="grey">Trammell &amp; Claise         Best Current Practice                [Page 30]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-31"></span>
<span class="grey"><a href="./rfc7013">RFC 7013</a>                    IPFIX IE-DOCTORS              September 2013</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/Appendix%20A.%20%20Example%20Information%20Element%20Definitions"></a><a class="selflink" href="#appendix-A" id="appendix-A">Appendix A</a>.  Example Information Element Definitions</span>

   This section contains a few example Information Element definitions
   as they would appear in an Internet-Draft.  Note the conformance of
   these examples to the guidelines in <a href="#section-4">Section 4</a>.

   The sipResponseStatus Information Element (Appendix A.1) illustrates
   the addition of an Information Element representing Layer 7
   application information, with a reference to the registry containing
   the allowable values.  The duplicatePacketDeltaCount Information
   Element (Appendix A.2) illustrates the addition of a new metric, with
   a reference to the RFC defining the metric.  The ambientTemperature
   Information Element (Appendix A.3) illustrates the addition of a new
   measured value outside the area of traditional networking
   applications.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/A.1.%20%20sipResponseStatus"></a><a class="selflink" href="#appendix-A.1" id="appendix-A.1">A.1</a>.  sipResponseStatus</span>

   Description:   The SIP Response code as an integer, as in the
      Response Codes registry at <a href="http://www.iana.org/assignments/sip-parameters">http://www.iana.org/assignments/sip-</a>
      <a href="http://www.iana.org/assignments/sip-parameters">parameters</a> defined in [<a href="./rfc3261" title='"SIP: Session Initiation Protocol"'>RFC3261</a>] and amended in subsequent RFCs.
      The presence of this Information Element in a SIP Message record
      marks it as describing a SIP response; if absent, the record
      describes a SIP request.

   Data Type:   unsigned16

   Data Type Semantics:   identifier

   References:   [<a href="./rfc3261" title='"SIP: Session Initiation Protocol"'>RFC3261</a>]

   ElementId:   TBD1

   Replaces Enterprise-Specific Element:  35566 / 412

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/A.2.%20%20duplicatePacketDeltaCount"></a><a class="selflink" href="#appendix-A.2" id="appendix-A.2">A.2</a>.  duplicatePacketDeltaCount</span>

   Description:   The number of uncorrupted and identical additional
      copies of each individual packet in the Flow arriving at the
      destination since the previous Data Record for this Flow (if any),
      as measured at the Observation Point.  This is measured as the
      Type-P-one-way-packet-duplication metric defined in <a href="./rfc5560#section-3">Section 3 of
      [RFC5560]</a>.

   Data Type:   unsigned64

   Data Type Semantics:   deltaCounter




<span class="grey">Trammell &amp; Claise         Best Current Practice                [Page 31]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-32"></span>
<span class="grey"><a href="./rfc7013">RFC 7013</a>                    IPFIX IE-DOCTORS              September 2013</span>


   Units:   packets

   References:   [<a href="./rfc5560" title='"A One-Way Packet Duplication Metric"'>RFC5560</a>]

   ElementId:   TBD2

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/A.3.%20%20ambientTemperature"></a><a class="selflink" href="#appendix-A.3" id="appendix-A.3">A.3</a>.  ambientTemperature</span>

   Description:   An ambient temperature observed by measurement
      equipment at an Observation Point, positioned such that it
      measures the temperature of the surroundings (i.e., not including
      any heat generated by the measuring or measured equipment),
      expressed in degrees Celsius.

   Data Type:   float

   Units:   degrees Celsius

   Range:   -273.15 - +inf

   ElementId:   TBD3

Authors' Addresses

   Brian Trammell
   Swiss Federal Institute of Technology Zurich
   Gloriastrasse 35
   8092 Zurich
   Switzerland

   Phone: +41 44 632 70 13
   EMail: trammell@tik.ee.ethz.ch


   Benoit Claise
   Cisco Systems, Inc.
   De Kleetlaan 6a b1
   1831 Diegem
   Belgium

   Phone: +32 2 704 5622
   EMail: bclaise@cisco.com









Trammell &amp; Claise         Best Current Practice                [Page 32]
</pre>
</body></html>