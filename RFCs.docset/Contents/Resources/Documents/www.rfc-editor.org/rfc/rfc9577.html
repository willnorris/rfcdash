<!DOCTYPE html>
<html class="RFC" lang="en"><head>
<meta charset="utf-8"/>
<meta content="Common,Latin" name="scripts"/>
<meta content="initial-scale=1.0" name="viewport"/>
<title>RFC 9577: The Privacy Pass HTTP Authentication Scheme</title>
<meta content="Tommy Pauly" name="author"/>
<meta content="Steven Valdez" name="author"/>
<meta content="Christopher A. Wood" name="author"/>
<meta content="
       This document defines an HTTP authentication scheme for Privacy Pass,
a privacy-preserving authentication mechanism used for authorization.
The authentication scheme specified in this document can be used by Clients
to redeem Privacy Pass tokens with an Origin. It can also be used by
Origins to challenge Clients to present Privacy Pass tokens. 
    " name="description"/>
<meta content="xml2rfc 3.21.0" name="generator"/>
<meta content="anonymous" name="keyword"/>
<meta content="authorization" name="keyword"/>
<meta content="crypto" name="keyword"/>
<meta content="9577" name="rfc.number"/>
<!-- Generator version information:
  xml2rfc 3.21.0
    Python 3.9.15
    ConfigArgParse 1.5.3
    google-i18n-address 3.0.0
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 4.9.0
    platformdirs 3.8.0
    pycountry 22.3.5
    PyYAML 6.0
    requests 2.28.0
    setuptools 44.1.1
    six 1.16.0
    wcwidth 0.2.5
    weasyprint 56.1
-->
<link href="rfc9577.xml" rel="alternate" type="application/rfc+xml"/>
<link href="#copyright" rel="license"/>
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necessary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

:root {
  --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
  --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
  --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
}

@viewport {
  zoom: 1.0;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: var(--font-sans);
  line-height: 1.6;
  scroll-behavior: smooth;
  overflow-wrap: break-word;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
svg[font-family~="serif" i], svg [font-family~="serif" i] {
  font-family: var(--font-serif);
}
svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
  font-family: var(--font-sans);
}
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre {
  background-color: #f9f9f9;
  font-family: var(--font-mono);
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
blockquote > *:last-child {
  margin-bottom: 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}
.xref {
  overflow-wrap: normal;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.refSubseries {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: var(--font-sans);
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  .breakable pre {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The following is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
.sourcecode pre,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .artwork > pre,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background slightly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottom margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the compact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div.sourcecode:first-child,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type:only-child {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css"/>
<link href="https://datatracker.ietf.org/doc/draft-ietf-privacypass-auth-scheme-15" rel="prev"/>
  <link href="https://dx.doi.org/10.17487/rfc9577" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  </head>
<body class="xml2rfc">
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 9577</td>
<td class="center">Privacy Pass Authentication</td>
<td class="right">June 2024</td>
</tr></thead>
<tfoot><tr>
<td class="left">Pauly, et al.</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div class="document-information" id="external-metadata"></div>
<div class="document-information" id="internal-metadata">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a class="eref" href="https://www.rfc-editor.org/rfc/rfc9577">9577</a></dd>
<dt class="label-category">Category:</dt>
<dd class="category">Standards Track</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time class="published" datetime="2024-06">June 2024</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">T. Pauly</div>
<div class="org">Apple Inc.</div>
</div>
<div class="author">
      <div class="author-name">S. Valdez</div>
<div class="org">Google LLC</div>
</div>
<div class="author">
      <div class="author-name">C. A. Wood</div>
<div class="org">Cloudflare</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 9577</h1>
<h1 id="title">The Privacy Pass HTTP Authentication Scheme</h1>
<section id="section-abstract">
      <h2 id="abstract"><a class="selfRef" href="#abstract">Abstract</a></h2>
<p id="section-abstract-1">This document defines an HTTP authentication scheme for Privacy Pass,
a privacy-preserving authentication mechanism used for authorization.
The authentication scheme specified in this document can be used by Clients
to redeem Privacy Pass tokens with an Origin. It can also be used by
Origins to challenge Clients to present Privacy Pass tokens.<a class="pilcrow" href="#section-abstract-1">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a class="section-name selfRef" href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This is an Internet Standards Track document.<a class="pilcrow" href="#section-boilerplate.1-1">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.<a class="pilcrow" href="#section-boilerplate.1-2">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc9577">https://www.rfc-editor.org/info/rfc9577</a></span>.<a class="pilcrow" href="#section-boilerplate.1-3">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a class="section-name selfRef" href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2024 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a class="pilcrow" href="#section-boilerplate.2-1">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a class="pilcrow" href="#section-boilerplate.2-2">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a class="toplink" href="#" onclick="scroll(0,0)">▲</a><h2 id="name-table-of-contents">
<a class="section-name selfRef" href="#name-table-of-contents">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p class="keepWithNext" id="section-toc.1-1.1.1"><a class="auto internal xref" href="#section-1">1</a>.  <a class="internal xref" href="#name-introduction">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p class="keepWithNext" id="section-toc.1-1.1.2.1.1"><a class="auto internal xref" href="#section-1.1">1.1</a>.  <a class="internal xref" href="#name-terminology">Terminology</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a class="auto internal xref" href="#section-2">2</a>.  <a class="internal xref" href="#name-http-authentication-scheme">HTTP Authentication Scheme</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a class="auto internal xref" href="#section-2.1">2.1</a>.  <a class="internal xref" href="#name-token-challenge">Token Challenge</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.1">
                    <p class="keepWithNext" id="section-toc.1-1.2.2.1.2.1.1"><a class="auto internal xref" href="#section-2.1.1">2.1.1</a>.  <a class="internal xref" href="#name-token-challenge-structure">Token Challenge Structure</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.2">
                    <p id="section-toc.1-1.2.2.1.2.2.1"><a class="auto internal xref" href="#section-2.1.2">2.1.2</a>.  <a class="internal xref" href="#name-sending-token-challenges">Sending Token Challenges</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.3">
                    <p id="section-toc.1-1.2.2.1.2.3.1"><a class="auto internal xref" href="#section-2.1.3">2.1.3</a>.  <a class="internal xref" href="#name-processing-token-challenges">Processing Token Challenges</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.4">
                    <p id="section-toc.1-1.2.2.1.2.4.1"><a class="auto internal xref" href="#section-2.1.4">2.1.4</a>.  <a class="internal xref" href="#name-token-caching">Token Caching</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a class="auto internal xref" href="#section-2.2">2.2</a>.  <a class="internal xref" href="#name-token-redemption">Token Redemption</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.1">
                    <p id="section-toc.1-1.2.2.2.2.1.1"><a class="auto internal xref" href="#section-2.2.1">2.2.1</a>.  <a class="internal xref" href="#name-token-structure">Token Structure</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.2">
                    <p id="section-toc.1-1.2.2.2.2.2.1"><a class="auto internal xref" href="#section-2.2.2">2.2.2</a>.  <a class="internal xref" href="#name-sending-tokens">Sending Tokens</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.3">
                    <p id="section-toc.1-1.2.2.2.2.3.1"><a class="auto internal xref" href="#section-2.2.3">2.2.3</a>.  <a class="internal xref" href="#name-token-verification">Token Verification</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a class="auto internal xref" href="#section-3">3</a>.  <a class="internal xref" href="#name-client-behavior">Client Behavior</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a class="auto internal xref" href="#section-3.1">3.1</a>.  <a class="internal xref" href="#name-choosing-to-redeem-tokens">Choosing to Redeem Tokens</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a class="auto internal xref" href="#section-3.2">3.2</a>.  <a class="internal xref" href="#name-choosing-between-multiple-c">Choosing between Multiple Challenges</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a class="auto internal xref" href="#section-4">4</a>.  <a class="internal xref" href="#name-origin-behavior">Origin Behavior</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a class="auto internal xref" href="#section-4.1">4.1</a>.  <a class="internal xref" href="#name-greasing">Greasing</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a class="auto internal xref" href="#section-5">5</a>.  <a class="internal xref" href="#name-security-considerations">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a class="auto internal xref" href="#section-5.1">5.1</a>.  <a class="internal xref" href="#name-randomness-requirements">Randomness Requirements</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a class="auto internal xref" href="#section-5.2">5.2</a>.  <a class="internal xref" href="#name-replay-attacks">Replay Attacks</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a class="auto internal xref" href="#section-5.3">5.3</a>.  <a class="internal xref" href="#name-reflection-attacks">Reflection Attacks</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a class="auto internal xref" href="#section-5.4">5.4</a>.  <a class="internal xref" href="#name-token-exhaustion-attacks">Token Exhaustion Attacks</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5">
                <p id="section-toc.1-1.5.2.5.1"><a class="auto internal xref" href="#section-5.5">5.5</a>.  <a class="internal xref" href="#name-timing-correlation-attacks">Timing Correlation Attacks</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.6">
                <p id="section-toc.1-1.5.2.6.1"><a class="auto internal xref" href="#section-5.6">5.6</a>.  <a class="internal xref" href="#name-cross-context-linkability-a">Cross-Context Linkability Attacks</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a class="auto internal xref" href="#section-6">6</a>.  <a class="internal xref" href="#name-iana-considerations">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a class="auto internal xref" href="#section-6.1">6.1</a>.  <a class="internal xref" href="#name-authentication-scheme">Authentication Scheme</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a class="auto internal xref" href="#section-6.2">6.2</a>.  <a class="internal xref" href="#name-privacy-pass-token-types-re">Privacy Pass Token Types Registry</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.1">
                    <p id="section-toc.1-1.6.2.2.2.1.1"><a class="auto internal xref" href="#section-6.2.1">6.2.1</a>.  <a class="internal xref" href="#name-reserved-values">Reserved Values</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a class="auto internal xref" href="#section-7">7</a>.  <a class="internal xref" href="#name-references">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a class="auto internal xref" href="#section-7.1">7.1</a>.  <a class="internal xref" href="#name-normative-references">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a class="auto internal xref" href="#section-7.2">7.2</a>.  <a class="internal xref" href="#name-informative-references">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a class="auto internal xref" href="#appendix-A">Appendix A</a>.  <a class="internal xref" href="#name-test-vectors">Test Vectors</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a class="auto internal xref" href="#appendix-A.1">A.1</a>.  <a class="internal xref" href="#name-challenge-and-redemption-st">Challenge and Redemption Structure Test Vectors</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a class="auto internal xref" href="#appendix-A.2">A.2</a>.  <a class="internal xref" href="#name-http-header-test-vectors">HTTP Header Test Vectors</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a class="auto internal xref" href="#appendix-B"></a><a class="internal xref" href="#name-authors-addresses">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a class="section-number selfRef" href="#section-1">1. </a><a class="section-name selfRef" href="#name-introduction">Introduction</a>
      </h2>
<p id="section-1-1">Privacy Pass tokens are unlinkable authenticators that can be used to
anonymously authorize a Client (see
<span>[<a class="cite xref" href="#RFC9576">ARCHITECTURE</a>]</span>).
Tokens are generated by token Issuers, on the basis of authentication,
attestation, or some previous action such as solving a CAPTCHA. A Client
possessing such a token is able to prove that it was able to get a token
issued, without allowing the relying party redeeming the Client's token
(the Origin) to link it with the issuance flow.<a class="pilcrow" href="#section-1-1">¶</a></p>
<p id="section-1-2">Different types of authenticators, using different token issuance protocols,
can be used as Privacy Pass tokens.<a class="pilcrow" href="#section-1-2">¶</a></p>
<p id="section-1-3">This document defines a common HTTP authentication scheme
(<span>[<a class="cite xref" href="#RFC9110">HTTP</a>], <a class="relref" href="https://rfc-editor.org/rfc/rfc9110#section-11">Section 11</a></span>), "PrivateToken", that allows Clients to redeem various
kinds of Privacy Pass tokens.<a class="pilcrow" href="#section-1-3">¶</a></p>
<p id="section-1-4">Clients and relying parties (Origins) interact using this scheme to perform the
token challenge and token redemption flow. In particular, Origins challenge
Clients for a token with an HTTP authentication challenge (using the
<code>WWW-Authenticate</code> response header field). Clients can then react to that
challenge by issuing a new request with a corresponding token (using the <code>Authorization</code>
request header field). Clients generate tokens that match the Origin's token
challenge by running one of the token issuance protocols defined in
<span>[<a class="cite xref" href="#RFC9578">ISSUANCE</a>]</span>. The act of presenting a token in an
<code>Authorization</code> request header field is referred to as "token redemption". This
interaction between the Client and Origin is shown below.<a class="pilcrow" href="#section-1-4">¶</a></p>
<span id="name-challenge-and-redemption-pr"></span><div id="fig-overview">
<figure id="figure-1">
        <div id="section-1-5.1">
          <div class="alignLeft art-svg artwork" id="section-1-5.1.1">
<svg class="diagram" font-family="monospace" font-size="13px" height="192" stroke-linecap="round" text-anchor="middle" version="1.1" viewBox="0 0 456 192" width="456" xmlns="http://www.w3.org/2000/svg">
              <path d="M 8,32 L 8,64" fill="none" stroke="black"></path>
              <path d="M 40,64 L 40,176" fill="none" stroke="black"></path>
              <path d="M 80,32 L 80,64" fill="none" stroke="black"></path>
              <path d="M 328,32 L 328,64" fill="none" stroke="black"></path>
              <path d="M 360,64 L 360,112" fill="none" stroke="black"></path>
              <path d="M 360,144 L 360,176" fill="none" stroke="black"></path>
              <path d="M 400,32 L 400,64" fill="none" stroke="black"></path>
              <path d="M 8,32 L 80,32" fill="none" stroke="black"></path>
              <path d="M 328,32 L 400,32" fill="none" stroke="black"></path>
              <path d="M 8,64 L 80,64" fill="none" stroke="black"></path>
              <path d="M 328,64 L 400,64" fill="none" stroke="black"></path>
              <path d="M 40,96 L 56,96" fill="none" stroke="black"></path>
              <path d="M 336,96 L 352,96" fill="none" stroke="black"></path>
              <path d="M 48,160 L 96,160" fill="none" stroke="black"></path>
              <path d="M 280,160 L 360,160" fill="none" stroke="black"></path>
              <polygon class="arrowhead" fill="black" points="360,96 348,90.4 348,101.6" transform="rotate(0,352,96)"></polygon>
              <polygon class="arrowhead" fill="black" points="56,160 44,154.4 44,165.6" transform="rotate(180,48,160)"></polygon>
              <g class="text">
                <text x="44" y="52">Origin</text>
                <text x="364" y="52">Client</text>
                <text x="136" y="100">WWW-Authenticate:</text>
                <text x="268" y="100">TokenChallenge</text>
                <text x="284" y="132">(Run</text>
                <text x="340" y="132">issuance</text>
                <text x="416" y="132">protocol)</text>
                <text x="164" y="164">Authorization:</text>
                <text x="248" y="164">token</text>
              </g>
            </svg><a class="pilcrow" href="#section-1-5.1.1">¶</a>
</div>
</div>
<figcaption><a class="selfRef" href="#figure-1">Figure 1</a>:
<a class="selfRef" href="#name-challenge-and-redemption-pr">Challenge and Redemption Protocol Flow</a>
        </figcaption></figure>
</div>
<p id="section-1-6">In addition to working with different token issuance protocols, this scheme
optionally supports the use of tokens that are associated with Origin-chosen
contexts and specific Origin names. Relying parties that request and redeem
tokens can choose a specific kind of token, as appropriate for its use case.
These options (1) allow for different deployment models to prevent double-spending and (2) allow for both interactive (online challenges) and non-interactive (pre-fetched) tokens.<a class="pilcrow" href="#section-1-6">¶</a></p>
<div id="terminology">
<section id="section-1.1">
        <h3 id="name-terminology">
<a class="section-number selfRef" href="#section-1.1">1.1. </a><a class="section-name selfRef" href="#name-terminology">Terminology</a>
        </h3>
<p id="section-1.1-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>",
         "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>",
         "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>",
         "<span class="bcp14">SHOULD NOT</span>",
         "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
         "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document
         are to be interpreted as described in BCP 14
         <span>[<a class="cite xref" href="#RFC2119">RFC2119</a>]</span> <span>[<a class="cite xref" href="#RFC8174">RFC8174</a>]</span> when, and only
         when, they appear in all capitals, as shown here.<a class="pilcrow" href="#section-1.1-1">¶</a></p>
<p id="section-1.1-2">Unless otherwise specified, this document encodes protocol messages in TLS
notation from
<span>[<a class="cite xref" href="#RFC8446">TLS13</a>], <a class="relref" href="https://rfc-editor.org/rfc/rfc8446#section-3">Section 3</a></span>.<a class="pilcrow" href="#section-1.1-2">¶</a></p>
<p id="section-1.1-3">This document uses the terms "Client", "Origin", "Issuer", "issuance protocol",
and "Token" as defined in <span>[<a class="cite xref" href="#RFC9576">ARCHITECTURE</a>]</span>. It additionally
uses the following terms in more specific ways:<a class="pilcrow" href="#section-1.1-3">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-1.1-4">
          <dt id="section-1.1-4.1">Issuer key:</dt>
          <dd id="section-1.1-4.2" style="margin-left: 1.5em">Keying material that can be used with an issuance protocol
to create a signed token.<a class="pilcrow" href="#section-1.1-4.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-4.3">Token challenge:</dt>
          <dd id="section-1.1-4.4" style="margin-left: 1.5em">A request for tokens sent from an Origin to a Client, using
the <code>WWW-Authenticate</code> HTTP header field. This challenge identifies a specific
token Issuer and issuance protocol. Token challenges optionally include
one or both of the following: a redemption context (see <a class="auto internal xref" href="#context-construction">Section 2.1.1.2</a>) and
a list of associated Origins. These optional values can then
be bound to the token that is issued.<a class="pilcrow" href="#section-1.1-4.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-4.5">Token redemption:</dt>
          <dd id="section-1.1-4.6" style="margin-left: 1.5em">An action by which a Client presents a token to an Origin
in an HTTP request, using the <code>Authorization</code> HTTP header field.<a class="pilcrow" href="#section-1.1-4.6">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="challenge-redemption">
<section id="section-2">
      <h2 id="name-http-authentication-scheme">
<a class="section-number selfRef" href="#section-2">2. </a><a class="section-name selfRef" href="#name-http-authentication-scheme">HTTP Authentication Scheme</a>
      </h2>
<p id="section-2-1">Token redemption is performed using HTTP authentication
(<span>[<a class="cite xref" href="#RFC9110">HTTP</a>], <a class="relref" href="https://rfc-editor.org/rfc/rfc9110#section-11">Section 11</a></span>), with the scheme "PrivateToken". Origins challenge
Clients to present a token from a specific Issuer (<a class="auto internal xref" href="#challenge">Section 2.1</a>). Once a
Client has received a token from that Issuer or already has a valid token
available, it presents the token to the Origin (<a class="auto internal xref" href="#redemption">Section 2.2</a>). The process of
presenting a token as authentication to an Origin is also referred to
as "spending" a token.<a class="pilcrow" href="#section-2-1">¶</a></p>
<p id="section-2-2">In order to prevent linkability across different transactions, Clients
will often present a particular "PrivateToken" only once. Origins can link multiple
transactions to the same Client if that Client spends the same token value more
than once. As such, Origins ought to expect at most one unique token
value, carried in one request, for each challenge.<a class="pilcrow" href="#section-2-2">¶</a></p>
<p id="section-2-3">The rest of this section describes the token challenge and redemption interactions
in more detail.<a class="pilcrow" href="#section-2-3">¶</a></p>
<div id="challenge">
<section id="section-2.1">
        <h3 id="name-token-challenge">
<a class="section-number selfRef" href="#section-2.1">2.1. </a><a class="section-name selfRef" href="#name-token-challenge">Token Challenge</a>
        </h3>
<p id="section-2.1-1">Origins send a token challenge to Clients in a <code>WWW-Authenticate</code> header field
with the "PrivateToken" scheme. This authentication scheme has two mandatory parameters:
one containing a token challenge and another containing the <code>token-key</code> used for
producing (and verifying) a corresponding token.<a class="pilcrow" href="#section-2.1-1">¶</a></p>
<p id="section-2.1-2">Origins that support the "PrivateToken" authentication scheme need to handle
the following tasks in constructing the <code>WWW-Authenticate</code> header field:<a class="pilcrow" href="#section-2.1-2">¶</a></p>
<ol class="normal type-1" id="section-2.1-3" start="1" type="1">
<li id="section-2.1-3.1">Select which Issuer to use, and configure the Issuer name and <code>token-key</code> to
include in <code>WWW-Authenticate</code> token challenges. The Issuer name is included in
the token challenge, and the Issuer <code>token-key</code> is used to populate the
<code>WWW-Authenticate</code> header parameter.<a class="pilcrow" href="#section-2.1-3.1">¶</a>
</li>
          <li id="section-2.1-3.2">Determine a redemption context construction to include in the
token challenge, as discussed in <a class="auto internal xref" href="#context-construction">Section 2.1.1.2</a>.<a class="pilcrow" href="#section-2.1-3.2">¶</a>
</li>
          <li id="section-2.1-3.3">Select the Origin information to include in the token challenge. This can
be empty to allow fully cross-Origin tokens, a single Origin name that
matches the Origin itself for per-Origin tokens, or a list of Origin names
containing the Origin itself. See <span><a class="relref" href="https://rfc-editor.org/rfc/rfc9576#section-3.4">Section 3.4</a> of [<a class="cite xref" href="#RFC9576">ARCHITECTURE</a>]</span> for more
information about the difference between cross-Origin and per-Origin tokens.<a class="pilcrow" href="#section-2.1-3.3">¶</a>
</li>
        </ol>
<p id="section-2.1-4">Once these decisions are made, Origins construct the <code>WWW-Authenticate</code> header
by first constructing the token challenge as described in <a class="auto internal xref" href="#challenge-structure">Section 2.1.1</a>.
Origins send challenges as described in <a class="auto internal xref" href="#send-challenge">Section 2.1.2</a>, and Clients process
them as described in Sections <a class="auto internal xref" href="#process-challenge">2.1.3</a> and <a class="auto internal xref" href="#caching">2.1.4</a>.<a class="pilcrow" href="#section-2.1-4">¶</a></p>
<div id="challenge-structure">
<section id="section-2.1.1">
          <h4 id="name-token-challenge-structure">
<a class="section-number selfRef" href="#section-2.1.1">2.1.1. </a><a class="section-name selfRef" href="#name-token-challenge-structure">Token Challenge Structure</a>
          </h4>
<p id="section-2.1.1-1">This document defines the default challenge structure that can be used across
token types, although future token types <span class="bcp14">MAY</span> extend or modify the structure
of the challenge; see <a class="auto internal xref" href="#token-types">Section 6.2</a> for the registry information
that establishes and defines the relationship between <code>token_type</code> and the
contents of the TokenChallenge message.<a class="pilcrow" href="#section-2.1.1-1">¶</a></p>
<p id="section-2.1.1-2">All token challenges <span class="bcp14">MUST</span> begin with a 2-octet integer that defines the
token type, in network byte order. This type indicates the issuance protocol
used to generate the token and determines the structure and semantics of the rest of
the structure. Values are registered in an IANA registry; see <a class="auto internal xref" href="#token-types">Section 6.2</a>. Clients <span class="bcp14">MUST</span>
ignore challenges with token types they do not support.<a class="pilcrow" href="#section-2.1.1-2">¶</a></p>
<p id="section-2.1.1-3">Even when a given token type uses the default challenge structure,
the requirements on the presence or interpretation of the fields can differ
across token types. For example, some token types might require that <code>origin_info</code>
is non-empty, while others allow it to be empty.<a class="pilcrow" href="#section-2.1.1-3">¶</a></p>
<p id="section-2.1.1-4">The default TokenChallenge message has the following structure:<a class="pilcrow" href="#section-2.1.1-4">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.1.1-5">
<pre>struct {
    uint16_t token_type;
    opaque issuer_name&lt;1..2^16-1&gt;;
    opaque redemption_context&lt;0..32&gt;;
    opaque origin_info&lt;0..2^16-1&gt;;
} TokenChallenge;
</pre><a class="pilcrow" href="#section-2.1.1-5">¶</a>
</div>
<p id="section-2.1.1-6">The structure fields are defined as follows:<a class="pilcrow" href="#section-2.1.1-6">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1.1-7.1">
              <code>token_type</code> is a 2-octet integer, in network byte order, as described
above.<a class="pilcrow" href="#section-2.1.1-7.1">¶</a>
</li>
            <li class="normal" id="section-2.1.1-7.2">
              <code>issuer_name</code> is an ASCII string that identifies the Issuer, using the format of a
server name as defined in <a class="auto internal xref" href="#server-name">Section 2.1.1.1</a>. This name identifies the Issuer that is allowed to
issue tokens that can be redeemed by this Origin. The field that stores this string in the challenge
is prefixed with a 2-octet integer indicating the length, in network byte order.<a class="pilcrow" href="#section-2.1.1-7.2">¶</a>
</li>
            <li class="normal" id="section-2.1.1-7.3">
              <code>redemption_context</code> is a field that is either 0 or 32 bytes, prefixed with a single
octet indicating the length (either 0 or 32). If the value is non-empty, it is a 32-byte value
generated by the Origin that allows the Origin to require that Clients fetch tokens
bound to a specific context, as opposed to reusing tokens that were fetched for other
contexts. See <a class="auto internal xref" href="#context-construction">Section 2.1.1.2</a> for example contexts that might be useful in
practice. Challenges with <code>redemption_context</code> values of invalid lengths <span class="bcp14">MUST</span> be ignored.<a class="pilcrow" href="#section-2.1.1-7.3">¶</a>
</li>
            <li class="normal" id="section-2.1.1-7.4">
              <code>origin_info</code> is an ASCII string that either is empty or contains one or more
Origin names that allow a token to be scoped to a specific set of Origins. Each
Origin name uses the format of a server name as defined in <a class="auto internal xref" href="#server-name">Section 2.1.1.1</a>. The string
is prefixed with a 2-octet integer indicating the length, in network byte order.
If empty, any non-Origin-specific token can be redeemed. If the string contains
multiple Origin names, they are delimited with commas (",") without any whitespace.
If this field is not empty, the Origin <span class="bcp14">MUST</span> include its own name as one of the
names in the list.<a class="pilcrow" href="#section-2.1.1-7.4">¶</a>
</li>
          </ul>
<p id="section-2.1.1-8">If <code>origin_info</code> contains multiple Origin names, this means the challenge is valid
for any of the Origins in the list, including the Origin that issued the challenge
(which must always be present in the list if it is non-empty; see <a class="auto internal xref" href="#process-challenge">Section 2.1.3</a>).
This can be useful in settings where Clients pre-fetch and cache tokens for a particular
challenge -- including the <code>origin_info</code> field -- and then later redeem these tokens
with one of the Origins in the list. See <a class="auto internal xref" href="#caching">Section 2.1.4</a> for more discussion about
token caching.<a class="pilcrow" href="#section-2.1.1-8">¶</a></p>
<div id="server-name">
<section id="section-2.1.1.1">
            <h5 id="name-server-name-encoding">
<a class="section-number selfRef" href="#section-2.1.1.1">2.1.1.1. </a><a class="section-name selfRef" href="#name-server-name-encoding">Server Name Encoding</a>
            </h5>
<p id="section-2.1.1.1-1">Server names contained in a token challenge are ASCII strings that contain a hostname
and optional port, where the port is implied to be "443" if missing. The names use the
format of the authority portion of a URI as defined in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc3986#section-3.2">Section 3.2</a> of [<a class="cite xref" href="#RFC3986">URI</a>]</span>.
The names <span class="bcp14">MUST NOT</span> include a "userinfo" portion of an authority. For example, a valid
server name might be "issuer.example.com" or "issuer.example.com:8443",
but not "issuer@example.com".<a class="pilcrow" href="#section-2.1.1.1-1">¶</a></p>
</section>
</div>
<div id="context-construction">
<section id="section-2.1.1.2">
            <h5 id="name-redemption-context-construc">
<a class="section-number selfRef" href="#section-2.1.1.2">2.1.1.2. </a><a class="section-name selfRef" href="#name-redemption-context-construc">Redemption Context Construction</a>
            </h5>
<p id="section-2.1.1.2-1">The TokenChallenge redemption context allows the Origin to determine the
context in which a given token can be redeemed. This value can be a unique
per-request nonce, constructed from 32 freshly generated random bytes. It
can also represent state or properties of the Client session. Some example
properties and methods for constructing the corresponding context are below.
This list is not exhaustive.<a class="pilcrow" href="#section-2.1.1.2-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2.1.1.2-2">
              <dt id="section-2.1.1.2-2.1">Context bound to a given time window:</dt>
              <dd id="section-2.1.1.2-2.2" style="margin-left: 1.5em">Construct the redemption context as
F(current time window), where F is a pseudorandom function.<a class="pilcrow" href="#section-2.1.1.2-2.2">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-2.1.1.2-2.3">Context bound to a Client network based on Autonomous System Number (ASN):</dt>
              <dd id="section-2.1.1.2-2.4" style="margin-left: 1.5em">Construct the redemption context as
F(Client ASN), where F is a pseudorandom function.<a class="pilcrow" href="#section-2.1.1.2-2.4">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-2.1.1.2-2.5">Context bound to a given time window and Client network:</dt>
              <dd id="section-2.1.1.2-2.6" style="margin-left: 1.5em">Construct the redemption
context as F(current time window, Client ASN), where F is a pseudorandom function.<a class="pilcrow" href="#section-2.1.1.2-2.6">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
<p id="section-2.1.1.2-3">Preventing double-spending on tokens requires the Origin to keep state
associated with the redemption context. An empty redemption context is not
bound to any property of the Client request, so state to prevent double-spending
needs to be stored and shared across all Origin servers that can accept tokens until
<code>token-key</code> expiration or rotation. For a non-empty redemption context, the
double-spend state only needs to be stored across the set of Origin servers that will
accept tokens with that redemption context.<a class="pilcrow" href="#section-2.1.1.2-3">¶</a></p>
<p id="section-2.1.1.2-4">Origins that share redemption contexts, i.e., by using the same redemption
context, choosing the same Issuer, and providing the same <code>origin_info</code> field in
the TokenChallenge, must necessarily share state required to enforce
double-spend prevention. Origins should consider the operational complexity of this
shared state before choosing to share redemption contexts. Failure to
successfully synchronize this state and use it for double-spend prevention can
allow Clients to redeem tokens to one Origin that were issued after an
interaction with another Origin that shares the context.<a class="pilcrow" href="#section-2.1.1.2-4">¶</a></p>
</section>
</div>
</section>
</div>
<div id="send-challenge">
<section id="section-2.1.2">
          <h4 id="name-sending-token-challenges">
<a class="section-number selfRef" href="#section-2.1.2">2.1.2. </a><a class="section-name selfRef" href="#name-sending-token-challenges">Sending Token Challenges</a>
          </h4>
<p id="section-2.1.2-1">When used in an authentication challenge, the "PrivateToken" scheme uses the
following parameters:<a class="pilcrow" href="#section-2.1.2-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1.2-2.1">
              <code>challenge</code>, which contains a base64url TokenChallenge value, encoded per <span>[<a class="cite xref" href="#RFC4648">RFC4648</a>]</span>. This document follows the default padding behavior described in
<span><a class="relref" href="https://rfc-editor.org/rfc/rfc4648#section-3.2">Section 3.2</a> of [<a class="cite xref" href="#RFC4648">RFC4648</a>]</span>, so the base64url value <span class="bcp14">MUST</span> include padding.
As an authentication parameter (<code>auth-param</code> from <span>[<a class="cite xref" href="#RFC9110">HTTP</a>], <a class="relref" href="https://rfc-editor.org/rfc/rfc9110#section-11.2">Section 11.2</a></span>),
the value can be either a token or a quoted-string and might be required to
be a quoted-string if the base64url string includes "=" characters. This
parameter is required for all challenges.<a class="pilcrow" href="#section-2.1.2-2.1">¶</a>
</li>
            <li class="normal" id="section-2.1.2-2.2">
              <code>token-key</code>, which contains a base64url encoding of the public key for
use with the issuance protocol indicated by the challenge. See <span>[<a class="cite xref" href="#RFC9578">ISSUANCE</a>]</span>
for more information about how this public key is used by the issuance protocols
described in that specification. The encoding of
the public key is determined by the token type; see <a class="auto internal xref" href="#token-types">Section 6.2</a>.
As with <code>challenge</code>, the base64url value <span class="bcp14">MUST</span> include padding. As an
authentication parameter (<code>auth-param</code> from <span>[<a class="cite xref" href="#RFC9110">HTTP</a>], <a class="relref" href="https://rfc-editor.org/rfc/rfc9110#section-11.2">Section 11.2</a></span>), the
value can be either a token or a quoted-string and might be required to be a
quoted-string if the base64url string includes "=" characters. This parameter
<span class="bcp14">MAY</span> be omitted in deployments where Clients are able to retrieve the Issuer key
using an out-of-band mechanism.<a class="pilcrow" href="#section-2.1.2-2.2">¶</a>
</li>
            <li class="normal" id="section-2.1.2-2.3">
              <code>max-age</code>, which is an optional parameter that consists of the number of seconds for
which the challenge will be accepted by the Origin.<a class="pilcrow" href="#section-2.1.2-2.3">¶</a>
</li>
          </ul>
<p id="section-2.1.2-3">The header field <span class="bcp14">MAY</span> also include the standard <code>realm</code> parameter, if desired.
Issuance protocols <span class="bcp14">MAY</span> define other parameters, some of which might be required.
Clients <span class="bcp14">MUST</span> ignore parameters in challenges that are not defined for the issuance
protocol corresponding to the token type in the challenge.<a class="pilcrow" href="#section-2.1.2-3">¶</a></p>
<p id="section-2.1.2-4">As an example, the <code>WWW-Authenticate</code> header field could look like this:<a class="pilcrow" href="#section-2.1.2-4">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.1.2-5">
<pre>WWW-Authenticate:
  PrivateToken challenge="abc...", token-key="123..."
</pre><a class="pilcrow" href="#section-2.1.2-5">¶</a>
</div>
<div id="sending-multiple-token-challenges">
<section id="section-2.1.2.1">
            <h5 id="name-sending-multiple-token-chal">
<a class="section-number selfRef" href="#section-2.1.2.1">2.1.2.1. </a><a class="section-name selfRef" href="#name-sending-multiple-token-chal">Sending Multiple Token Challenges</a>
            </h5>
<p id="section-2.1.2.1-1">It is possible for the <code>WWW-Authenticate</code> header field to include multiple
challenges (<span>[<a class="cite xref" href="#RFC9110">HTTP</a>], <a class="relref" href="https://rfc-editor.org/rfc/rfc9110#section-11.6.1">Section 11.6.1</a></span>). This allows the Origin to indicate
support for different token types or different Issuers, or to include multiple redemption
contexts. For example, the <code>WWW-Authenticate</code> header field could look like this:<a class="pilcrow" href="#section-2.1.2.1-1">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.1.2.1-2">
<pre>WWW-Authenticate:
  PrivateToken challenge="abc...", token-key="123...",
  PrivateToken challenge="def...", token-key="234..."
</pre><a class="pilcrow" href="#section-2.1.2.1-2">¶</a>
</div>
<p id="section-2.1.2.1-3">Origins should only include challenges for different types of issuance
protocols with functionally equivalent properties. For instance, both issuance
protocols in <span>[<a class="cite xref" href="#RFC9578">ISSUANCE</a>]</span> have the same functional properties, albeit with
different mechanisms for verifying the resulting tokens during redemption.
Since Clients are free to choose which challenge they want to consume when
presented with options, mixing multiple challenges with different functional
properties for one use case is nonsensical. If the Origin has a preference
for one challenge over another (for example, if one uses a token type
that is faster to verify), it can sort it to be first in the list
of challenges as a hint to the Client.<a class="pilcrow" href="#section-2.1.2.1-3">¶</a></p>
</section>
</div>
</section>
</div>
<div id="process-challenge">
<section id="section-2.1.3">
          <h4 id="name-processing-token-challenges">
<a class="section-number selfRef" href="#section-2.1.3">2.1.3. </a><a class="section-name selfRef" href="#name-processing-token-challenges">Processing Token Challenges</a>
          </h4>
<p id="section-2.1.3-1">Upon receipt of a challenge, a Client validates the TokenChallenge structure
before taking any action, such as fetching a new token or redeeming a token
in a new request. Validation requirements are as follows:<a class="pilcrow" href="#section-2.1.3-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1.3-2.1">The <code>token_type</code> is recognized and supported by the Client;<a class="pilcrow" href="#section-2.1.3-2.1">¶</a>
</li>
            <li class="normal" id="section-2.1.3-2.2">The TokenChallenge structure is well-formed; and<a class="pilcrow" href="#section-2.1.3-2.2">¶</a>
</li>
            <li class="normal" id="section-2.1.3-2.3">If the <code>origin_info</code> field is non-empty, the name of the Origin that issued the
authentication challenge is included in the list of Origin names. Comparison
of the Origin name that issued the authentication challenge against elements
in the <code>origin_info</code> list is done via case-insensitive equality checks.<a class="pilcrow" href="#section-2.1.3-2.3">¶</a>
</li>
          </ul>
<p id="section-2.1.3-3">If validation fails, the Client <span class="bcp14">MUST NOT</span> fetch or redeem a token based on the
challenge. Clients <span class="bcp14">MAY</span> have further restrictions and requirements around
validating when a challenge is considered acceptable or valid. For example,
Clients can choose to ignore challenges that list Origin names for which the
current connection is not authoritative (according to the TLS certificate).<a class="pilcrow" href="#section-2.1.3-3">¶</a></p>
<p id="section-2.1.3-4">Caching and pre-fetching of tokens are discussed in <a class="auto internal xref" href="#caching">Section 2.1.4</a>.<a class="pilcrow" href="#section-2.1.3-4">¶</a></p>
</section>
</div>
<div id="caching">
<section id="section-2.1.4">
          <h4 id="name-token-caching">
<a class="section-number selfRef" href="#section-2.1.4">2.1.4. </a><a class="section-name selfRef" href="#name-token-caching">Token Caching</a>
          </h4>
<p id="section-2.1.4-1">Clients can generate multiple tokens from a single TokenChallenge and cache
them for future use. This improves privacy by separating the time of token
issuance from the time of token redemption, and also allows Clients to avoid
the overhead of receiving new tokens via the issuance protocol.<a class="pilcrow" href="#section-2.1.4-1">¶</a></p>
<p id="section-2.1.4-2">Cached tokens can only be redeemed when they match all of the fields in the
TokenChallenge: <code>token_type</code>, <code>issuer_name</code>, <code>redemption_context</code>, and <code>origin_info</code>.
Clients ought to store cached tokens based on all of these fields, to
avoid trying to redeem a token that does not match. Note that each token
has a unique Client nonce, which is sent in token redemption (<a class="auto internal xref" href="#redemption">Section 2.2</a>).<a class="pilcrow" href="#section-2.1.4-2">¶</a></p>
<p id="section-2.1.4-3">If a Client fetches a batch of multiple tokens for future use that are bound
to a specific redemption context (the <code>redemption_context</code> in the TokenChallenge
was not empty), Clients <span class="bcp14">SHOULD</span> discard these tokens upon flushing state such as
HTTP cookies <span>[<a class="cite xref" href="#I-D.ietf-httpbis-rfc6265bis">COOKIES</a>]</span>, or if there is a network
change and the Client does not have any Origin-specific state like HTTP cookies.
Using these tokens in a context that otherwise would not be linkable to the
original context could allow the Origin to recognize a Client.<a class="pilcrow" href="#section-2.1.4-3">¶</a></p>
</section>
</div>
</section>
</div>
<div id="redemption">
<section id="section-2.2">
        <h3 id="name-token-redemption">
<a class="section-number selfRef" href="#section-2.2">2.2. </a><a class="section-name selfRef" href="#name-token-redemption">Token Redemption</a>
        </h3>
<p id="section-2.2-1">The output of the issuance protocol is a token that corresponds to the Origin's
challenge (see <a class="auto internal xref" href="#challenge">Section 2.1</a>).<a class="pilcrow" href="#section-2.2-1">¶</a></p>
<div id="token-structure">
<section id="section-2.2.1">
          <h4 id="name-token-structure">
<a class="section-number selfRef" href="#section-2.2.1">2.2.1. </a><a class="section-name selfRef" href="#name-token-structure">Token Structure</a>
          </h4>
<p id="section-2.2.1-1">A token is a structure that begins with a 2-octet field that indicates a token
type, which <span class="bcp14">MUST</span> match the <code>token_type</code> in the TokenChallenge structure. This value
determines the structure and semantics of the rest of the token structure.<a class="pilcrow" href="#section-2.2.1-1">¶</a></p>
<p id="section-2.2.1-2">This document defines the default token structure that can be used across
token types, although future token types <span class="bcp14">MAY</span> extend or modify the structure
of the token; see <a class="auto internal xref" href="#token-types">Section 6.2</a> for the registry information that
establishes and defines the relationship between <code>token_type</code> and the contents
of the token structure.<a class="pilcrow" href="#section-2.2.1-2">¶</a></p>
<p id="section-2.2.1-3">The default token message has the following structure:<a class="pilcrow" href="#section-2.2.1-3">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.1-4">
<pre>struct {
    uint16_t token_type;
    uint8_t nonce[32];
    uint8_t challenge_digest[32];
    uint8_t token_key_id[Nid];
    uint8_t authenticator[Nk];
} Token;
</pre><a class="pilcrow" href="#section-2.2.1-4">¶</a>
</div>
<p id="section-2.2.1-5">The structure fields are defined as follows:<a class="pilcrow" href="#section-2.2.1-5">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.1-6.1">
              <code>token_type</code> is a 2-octet integer, in network byte order, as described
above.<a class="pilcrow" href="#section-2.2.1-6.1">¶</a>
</li>
            <li class="normal" id="section-2.2.1-6.2">
              <code>nonce</code> is a 32-octet value containing a Client-generated random nonce.<a class="pilcrow" href="#section-2.2.1-6.2">¶</a>
</li>
            <li class="normal" id="section-2.2.1-6.3">
              <code>challenge_digest</code> is a 32-octet value containing the hash of the
original TokenChallenge, SHA-256(TokenChallenge), where SHA-256 is as defined
in <span>[<a class="cite xref" href="#SHS">SHS</a>]</span>. Changing the hash function to something
other than SHA-256 would require defining a new token type and token structure
(since the contents of <code>challenge_digest</code> would be computed differently),
which can be done in a future specification.<a class="pilcrow" href="#section-2.2.1-6.3">¶</a>
</li>
            <li class="normal" id="section-2.2.1-6.4">
              <code>token_key_id</code> is a Nid-octet identifier for the token authentication
key. The value of this field is defined by the <code>token_type</code> and corresponding
issuance protocol.<a class="pilcrow" href="#section-2.2.1-6.4">¶</a>
</li>
            <li class="normal" id="section-2.2.1-6.5">
              <code>authenticator</code> is a Nk-octet authenticator that is cryptographically bound
to the preceding fields in the token; see <a class="auto internal xref" href="#verification">Section 2.2.3</a> for more information
about how this field is used in verifying a token. The <code>token_type</code> and corresponding
issuance protocol determine the value of the <code>authenticator</code> field and how it is computed.
The value of constant Nk depends on <code>token_type</code>, as defined in <a class="auto internal xref" href="#token-types">Section 6.2</a>.<a class="pilcrow" href="#section-2.2.1-6.5">¶</a>
</li>
          </ul>
<p id="section-2.2.1-7">The <code>authenticator</code> value in the token structure is computed over the <code>token_type</code>,
<code>nonce</code>, <code>challenge_digest</code>, and <code>token_key_id</code> fields. A token is considered valid
if token verification succeeds; see <a class="auto internal xref" href="#verification">Section 2.2.3</a> for details about
verifying the token and its <code>authenticator</code> value.<a class="pilcrow" href="#section-2.2.1-7">¶</a></p>
</section>
</div>
<div id="sending-tokens">
<section id="section-2.2.2">
          <h4 id="name-sending-tokens">
<a class="section-number selfRef" href="#section-2.2.2">2.2.2. </a><a class="section-name selfRef" href="#name-sending-tokens">Sending Tokens</a>
          </h4>
<p id="section-2.2.2-1">When used for Client authorization, the "PrivateToken" authentication
scheme defines one parameter, <code>token</code>, which contains the base64url-encoded
token structure. As with the challenge parameters (<a class="auto internal xref" href="#challenge">Section 2.1</a>), the base64url
value <span class="bcp14">MUST</span> include padding. As an authentication parameter (<code>auth-param</code> from
<span>[<a class="cite xref" href="#RFC9110">HTTP</a>], <a class="relref" href="https://rfc-editor.org/rfc/rfc9110#section-11.2">Section 11.2</a></span>), the value can be either a token or a
quoted-string and might be required to be a quoted-string if the base64url
string includes "=" characters. All unknown or unsupported parameters to
"PrivateToken" authentication credentials <span class="bcp14">MUST</span> be ignored.<a class="pilcrow" href="#section-2.2.2-1">¶</a></p>
<p id="section-2.2.2-2">Clients present this token structure to Origins in a new HTTP request using
the <code>Authorization</code> header field as follows:<a class="pilcrow" href="#section-2.2.2-2">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.2-3">
<pre>Authorization: PrivateToken token="abc..."
</pre><a class="pilcrow" href="#section-2.2.2-3">¶</a>
</div>
<p id="section-2.2.2-4">For context-bound tokens, Origins store or reconstruct the contexts of previous
TokenChallenge structures in order to validate the token. A TokenChallenge can
be bound to a specific TLS session with a Client, but Origins can also accept
tokens for valid challenges in new sessions. Origins <span class="bcp14">SHOULD</span> implement some form
of double-spend prevention that prevents a token with the same nonce from being
redeemed twice. Double-spend prevention ensures that Clients cannot replay tokens
for previous challenges. See <a class="auto internal xref" href="#replay-attacks">Section 5.2</a> for more information about replay
attacks. For context-bound tokens, this double-spend prevention can require no state
or minimal state, since the context can be used to verify token uniqueness.<a class="pilcrow" href="#section-2.2.2-4">¶</a></p>
</section>
</div>
<div id="verification">
<section id="section-2.2.3">
          <h4 id="name-token-verification">
<a class="section-number selfRef" href="#section-2.2.3">2.2.3. </a><a class="section-name selfRef" href="#name-token-verification">Token Verification</a>
          </h4>
<p id="section-2.2.3-1">A token consists of some input cryptographically bound to an <code>authenticator</code>
value, such as a digital signature. Verifying a token consists of checking that
the <code>authenticator</code> value is correct.<a class="pilcrow" href="#section-2.2.3-1">¶</a></p>
<p id="section-2.2.3-2">The <code>authenticator</code> value is as computed when running and finalizing the issuance
protocol corresponding to the token type with the following values as the input:<a class="pilcrow" href="#section-2.2.3-2">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.3-3">
<pre>struct {
    uint16_t token_type;
    uint8_t nonce[32];
    uint8_t challenge_digest[32];
    uint8_t token_key_id[Nid];
} AuthenticatorInput;
</pre><a class="pilcrow" href="#section-2.2.3-3">¶</a>
</div>
<p id="section-2.2.3-4">The values of these fields are as described in <a class="auto internal xref" href="#token-structure">Section 2.2.1</a>. The cryptographic
verification check depends on the token type; see
Sections <a class="relref" href="https://rfc-editor.org/rfc/rfc9578#section-5.4">5.4</a> and <a class="relref" href="https://rfc-editor.org/rfc/rfc9578#section-6.4">6.4</a> of <span>[<a class="cite xref" href="#RFC9578">ISSUANCE</a>]</span> for verification instructions for the issuance
protocols described in that specification. As such, the security properties of the
token, e.g., the probability that one can forge an <code>authenticator</code> value without
invoking the issuance protocol, depend on the cryptographic algorithm used by
the issuance protocol as determined by the token type.<a class="pilcrow" href="#section-2.2.3-4">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="client-behavior">
<section id="section-3">
      <h2 id="name-client-behavior">
<a class="section-number selfRef" href="#section-3">3. </a><a class="section-name selfRef" href="#name-client-behavior">Client Behavior</a>
      </h2>
<p id="section-3-1">When a Client receives one or more token challenges in response to a request,
the Client has a set of choices to make:<a class="pilcrow" href="#section-3-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-2.1">Whether or not to redeem a token via a new request to the Origin.<a class="pilcrow" href="#section-3-2.1">¶</a>
</li>
        <li class="normal" id="section-3-2.2">Whether to redeem a previously issued and cached token or redeem a token freshly issued from the issuance protocol.<a class="pilcrow" href="#section-3-2.2">¶</a>
</li>
        <li class="normal" id="section-3-2.3">If multiple challenges were sent, which challenge to use for redeeming a
token on a subsequent request.<a class="pilcrow" href="#section-3-2.3">¶</a>
</li>
      </ul>
<p id="section-3-3">The approach to these choices depends on the use case of the application, as
well as the deployment model (see <span><a class="relref" href="https://rfc-editor.org/rfc/rfc9576#section-4">Section 4</a> of [<a class="cite xref" href="#RFC9576">ARCHITECTURE</a>]</span> for discussion
of the different deployment models).<a class="pilcrow" href="#section-3-3">¶</a></p>
<div id="choosing-to-redeem-tokens">
<section id="section-3.1">
        <h3 id="name-choosing-to-redeem-tokens">
<a class="section-number selfRef" href="#section-3.1">3.1. </a><a class="section-name selfRef" href="#name-choosing-to-redeem-tokens">Choosing to Redeem Tokens</a>
        </h3>
<p id="section-3.1-1">Some applications of tokens might require Clients to always present a token
as authentication in order to successfully make requests. For example, a restricted
service that wants to only allow access to valid users but wants to do so without learning
specific user credential information could use tokens that are based on attesting user
credentials. In these kinds of use cases, Clients will need to always redeem a
token in order to successfully make a request.<a class="pilcrow" href="#section-3.1-1">¶</a></p>
<p id="section-3.1-2">Many other use cases for Privacy Pass tokens involve open services that must work
with any Client, including those that either cannot redeem tokens or can only sometimes redeem
tokens. For example, a service can use tokens as a way to reduce the incidence of
presenting CAPTCHAs to users. In such use cases, services will regularly encounter
Clients that cannot redeem a token or choose not to. In order to mitigate the risk
of these services relying on always receiving tokens, Clients that are capable of
redeeming tokens can ignore token challenges (and instead behave as if they were a Client
that either doesn't support redeeming tokens or is unable to generate a new token, by not
sending a new request that contains a token to redeem) with some
non-trivial probability. See <span><a class="relref" href="https://rfc-editor.org/rfc/rfc9576#section-5.1">Section 5.1</a> of [<a class="cite xref" href="#RFC9576">ARCHITECTURE</a>]</span> for further considerations
regarding avoiding discriminatory behavior across Clients when using Privacy Pass tokens.<a class="pilcrow" href="#section-3.1-2">¶</a></p>
<p id="section-3.1-3">Clients might also choose to not redeem tokens in subsequent requests when the
token challenges indicate erroneous or malicious behavior on the part of the
challenging Origin. For example, if a Client's ability to generate tokens via an
Attester and Issuer is limited to a certain rate, a malicious Origin could send
an excessive number of token challenges with unique redemption contexts
in order to (1) cause the Client to exhaust its ability to generate new tokens or (2) overwhelm issuance servers. Based on the specific deployment, the limits here will vary, but Clients <span class="bcp14">SHOULD</span> have some implementation-specific policy to minimize the number of tokens that can be retrieved by Origins.<a class="pilcrow" href="#section-3.1-3">¶</a></p>
</section>
</div>
<div id="choosing-between-multiple-challenges">
<section id="section-3.2">
        <h3 id="name-choosing-between-multiple-c">
<a class="section-number selfRef" href="#section-3.2">3.2. </a><a class="section-name selfRef" href="#name-choosing-between-multiple-c">Choosing between Multiple Challenges</a>
        </h3>
<p id="section-3.2-1">A single response from an Origin can include multiple token challenges.
For example, a set of challenges could include different token types
and Issuers, to allow Clients to choose a preferred Issuer or type.<a class="pilcrow" href="#section-3.2-1">¶</a></p>
<p id="section-3.2-2">If Clients choose to respond, Clients should satisfy exactly one of
the challenges presented. The choice of which challenge to use for redeeming
tokens is up to Client policy. This can involve which token types are
supported or preferred, which Issuers are supported or preferred, or whether
or not the Client is able to use cached tokens based on the redemption context
or Origin information in the challenge. See <a class="auto internal xref" href="#caching">Section 2.1.4</a> for more discussion
on token caching. Regardless of how the choice is made, it <span class="bcp14">SHOULD</span> be done in a
consistent manner to ensure that the choice does not reveal information about the
specific Client; see <span><a class="relref" href="https://rfc-editor.org/rfc/rfc9576#section-6.2">Section 6.2</a> of [<a class="cite xref" href="#RFC9576">ARCHITECTURE</a>]</span> for more details on the privacy
implications of issuance consistency.<a class="pilcrow" href="#section-3.2-2">¶</a></p>
</section>
</div>
</section>
</div>
<div id="origin-behavior">
<section id="section-4">
      <h2 id="name-origin-behavior">
<a class="section-number selfRef" href="#section-4">4. </a><a class="section-name selfRef" href="#name-origin-behavior">Origin Behavior</a>
      </h2>
<p id="section-4-1">Origins choose what token challenges to send to Clients; these token challenges will vary,
depending on the use case and deployment model. The Origin chooses
which token types, Issuers, redemption contexts, and Origin information to include
in challenges. If an Origin sends multiple challenges, each challenge <span class="bcp14">SHOULD</span>
be equivalent in terms of acceptability for token redemption, since Clients
are free to choose to generate tokens based on any of the challenges.<a class="pilcrow" href="#section-4-1">¶</a></p>
<p id="section-4-2">Origins ought to consider the time involved in token issuance. Particularly,
a challenge that includes a unique redemption context will prevent a Client
from using cached tokens and thus can add more delay before the Client
is able to redeem a token.<a class="pilcrow" href="#section-4-2">¶</a></p>
<p id="section-4-3">Origins <span class="bcp14">SHOULD</span> minimize the number of challenges sent to a particular Client
context (referred to as the "redemption context" in
<span><a class="relref" href="https://rfc-editor.org/rfc/rfc9576#section-3.3">Section 3.3</a> of [<a class="cite xref" href="#RFC9576">ARCHITECTURE</a>]</span>), to avoid overwhelming Clients and Issuers
with token requests that might cause Clients to hit rate limits.<a class="pilcrow" href="#section-4-3">¶</a></p>
<div id="greasing">
<section id="section-4.1">
        <h3 id="name-greasing">
<a class="section-number selfRef" href="#section-4.1">4.1. </a><a class="section-name selfRef" href="#name-greasing">Greasing</a>
        </h3>
<p id="section-4.1-1">In order to prevent Clients from becoming incompatible with new token challenges,
Origins <span class="bcp14">SHOULD</span> include random token types, from the reserved list of "greased"
types (defined in <a class="auto internal xref" href="#token-types">Section 6.2</a>), with some non-trivial probability.<a class="pilcrow" href="#section-4.1-1">¶</a></p>
<p id="section-4.1-2">Additionally, for deployments where tokens are not required (such as when tokens
are used as a way to avoid showing CAPTCHAs), Origins <span class="bcp14">SHOULD</span> randomly
choose to not challenge Clients for tokens with some non-trivial probability.
This helps Origins ensure that their behavior for handling Clients that cannot
redeem tokens is maintained and exercised consistently.<a class="pilcrow" href="#section-4.1-2">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-considerations">
<section id="section-5">
      <h2 id="name-security-considerations">
<a class="section-number selfRef" href="#section-5">5. </a><a class="section-name selfRef" href="#name-security-considerations">Security Considerations</a>
      </h2>
<p id="section-5-1">This section contains security considerations for the "PrivateToken" authentication
scheme described in this document.<a class="pilcrow" href="#section-5-1">¶</a></p>
<div id="randomness-requirements">
<section id="section-5.1">
        <h3 id="name-randomness-requirements">
<a class="section-number selfRef" href="#section-5.1">5.1. </a><a class="section-name selfRef" href="#name-randomness-requirements">Randomness Requirements</a>
        </h3>
<p id="section-5.1-1">All random values in the challenge and token <span class="bcp14">MUST</span> be
generated using a cryptographically secure source of randomness <span>[<a class="cite xref" href="#RFC4086">RFC4086</a>]</span>.<a class="pilcrow" href="#section-5.1-1">¶</a></p>
</section>
</div>
<div id="replay-attacks">
<section id="section-5.2">
        <h3 id="name-replay-attacks">
<a class="section-number selfRef" href="#section-5.2">5.2. </a><a class="section-name selfRef" href="#name-replay-attacks">Replay Attacks</a>
        </h3>
<p id="section-5.2-1">Applications <span class="bcp14">SHOULD</span> constrain tokens to a single Origin unless the use case can
accommodate replay attacks. Replaying tokens is not necessarily a security
or privacy problem. As an example, it is reasonable for Clients to replay tokens
in contexts where token redemption does not induce side effects and in which
Client requests are already linkable. One possible setting where this applies
is where tokens are sent as part of 0-RTT data.<a class="pilcrow" href="#section-5.2-1">¶</a></p>
<p id="section-5.2-2">If successful token redemption produces side effects, Origins <span class="bcp14">SHOULD</span> implement an
anti-replay mechanism to mitigate the harm of such replays. See <span>[<a class="cite xref" href="#RFC8446">TLS13</a>], <a class="relref" href="https://rfc-editor.org/rfc/rfc8446#section-8">Section 8</a></span>
and <span>[<a class="cite xref" href="#RFC9001">RFC9001</a>], <a class="relref" href="https://rfc-editor.org/rfc/rfc9001#section-9.2">Section 9.2</a></span> for details about anti-replay mechanisms, as well as
<span>[<a class="cite xref" href="#RFC8470">RFC8470</a>], <a class="relref" href="https://rfc-editor.org/rfc/rfc8470#section-3">Section 3</a></span> for discussion about safety considerations for 0-RTT
HTTP data.<a class="pilcrow" href="#section-5.2-2">¶</a></p>
</section>
</div>
<div id="reflection-attacks">
<section id="section-5.3">
        <h3 id="name-reflection-attacks">
<a class="section-number selfRef" href="#section-5.3">5.3. </a><a class="section-name selfRef" href="#name-reflection-attacks">Reflection Attacks</a>
        </h3>
<p id="section-5.3-1">The security properties of token challenges vary, depending on whether the
challenge contains a redemption context or not, as well as whether the
challenge is a per-Origin challenge or not. For example, cross-Origin tokens with empty
contexts can be reflected from one party by another, as shown below.<a class="pilcrow" href="#section-5.3-1">¶</a></p>
<span id="name-reflection-attack-example"></span><div id="fig-replay">
<figure id="figure-2">
          <div id="section-5.3-2.1">
            <div class="alignLeft art-svg artwork" id="section-5.3-2.1.1">
<svg class="diagram" font-family="monospace" font-size="13px" height="176" stroke-linecap="round" text-anchor="middle" version="1.1" viewBox="0 0 488 176" width="488" xmlns="http://www.w3.org/2000/svg">
                <path d="M 8,32 L 8,64" fill="none" stroke="black"></path>
                <path d="M 40,64 L 40,160" fill="none" stroke="black"></path>
                <path d="M 80,32 L 80,64" fill="none" stroke="black"></path>
                <path d="M 184,32 L 184,64" fill="none" stroke="black"></path>
                <path d="M 224,64 L 224,160" fill="none" stroke="black"></path>
                <path d="M 272,32 L 272,64" fill="none" stroke="black"></path>
                <path d="M 408,32 L 408,64" fill="none" stroke="black"></path>
                <path d="M 440,64 L 440,160" fill="none" stroke="black"></path>
                <path d="M 480,32 L 480,64" fill="none" stroke="black"></path>
                <path d="M 8,32 L 80,32" fill="none" stroke="black"></path>
                <path d="M 184,32 L 272,32" fill="none" stroke="black"></path>
                <path d="M 408,32 L 480,32" fill="none" stroke="black"></path>
                <path d="M 8,64 L 80,64" fill="none" stroke="black"></path>
                <path d="M 184,64 L 272,64" fill="none" stroke="black"></path>
                <path d="M 408,64 L 480,64" fill="none" stroke="black"></path>
                <path d="M 40,96 L 64,96" fill="none" stroke="black"></path>
                <path d="M 200,96 L 216,96" fill="none" stroke="black"></path>
                <path d="M 224,112 L 240,112" fill="none" stroke="black"></path>
                <path d="M 416,112 L 432,112" fill="none" stroke="black"></path>
                <path d="M 232,128 L 296,128" fill="none" stroke="black"></path>
                <path d="M 360,128 L 440,128" fill="none" stroke="black"></path>
                <path d="M 48,144 L 64,144" fill="none" stroke="black"></path>
                <path d="M 208,144 L 224,144" fill="none" stroke="black"></path>
                <polygon class="arrowhead" fill="black" points="440,112 428,106.4 428,117.6" transform="rotate(0,432,112)"></polygon>
                <polygon class="arrowhead" fill="black" points="240,128 228,122.4 228,133.6" transform="rotate(180,232,128)"></polygon>
                <polygon class="arrowhead" fill="black" points="224,96 212,90.4 212,101.6" transform="rotate(0,216,96)"></polygon>
                <polygon class="arrowhead" fill="black" points="56,144 44,138.4 44,149.6" transform="rotate(180,48,144)"></polygon>
                <g class="text">
                  <text x="44" y="52">Origin</text>
                  <text x="228" y="52">Attacker</text>
                  <text x="444" y="52">Client</text>
                  <text x="132" y="100">TokenChallenge</text>
                  <text x="284" y="116">(reflect</text>
                  <text x="364" y="116">challenge)</text>
                  <text x="328" y="132">Token</text>
                  <text x="108" y="148">(reflect</text>
                  <text x="172" y="148">token)</text>
                </g>
              </svg><a class="pilcrow" href="#section-5.3-2.1.1">¶</a>
</div>
</div>
<figcaption><a class="selfRef" href="#figure-2">Figure 2</a>:
<a class="selfRef" href="#name-reflection-attack-example">Reflection Attack Example</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="token-exhaustion-attacks">
<section id="section-5.4">
        <h3 id="name-token-exhaustion-attacks">
<a class="section-number selfRef" href="#section-5.4">5.4. </a><a class="section-name selfRef" href="#name-token-exhaustion-attacks">Token Exhaustion Attacks</a>
        </h3>
<p id="section-5.4-1">When a Client holds cross-Origin tokens with empty contexts, it
is possible for any Origin in the cross-Origin set to deplete that Client's
set of tokens. To prevent this from happening, tokens can be scoped to single
Origins (with non-empty <code>origin_info</code>) such that they can only be redeemed for
a single Origin. Alternatively, if tokens are cross-Origin tokens, Clients can use
alternate methods to prevent many tokens from being redeemed at once. For
example, if the Origin requests an excess of tokens, the Client could choose to
not present any tokens for verification if a redemption had already
occurred in a given time window.<a class="pilcrow" href="#section-5.4-1">¶</a></p>
<p id="section-5.4-2">Token challenges that include non-empty <code>origin_info</code> bind tokens to one or more
specific Origins. As described in <a class="auto internal xref" href="#process-challenge">Section 2.1.3</a>, Clients only accept such
challenges from Origin names listed in the <code>origin_info</code> string if it is non-empty. Even if multiple
Origins are listed, a token can only be redeemed for an Origin if the challenge
has a match for the <code>origin_info</code>. For example, if "a.example.com" issues
a challenge with an <code>origin_info</code> string of "a.example.com,b.example.com", a
Client could redeem a token fetched for this challenge if and only if
"b.example.com" also included an <code>origin_info</code> string of
"a.example.com,b.example.com". On the other hand, if "b.example.com" had an
<code>origin_info</code> string of "b.example.com", "b.example.com,a.example.com", or
"a.example.com,b.example.com,c.example.com", the string would not match, and the
Client would need to use a different token.<a class="pilcrow" href="#section-5.4-2">¶</a></p>
</section>
</div>
<div id="timing-correlation-attacks">
<section id="section-5.5">
        <h3 id="name-timing-correlation-attacks">
<a class="section-number selfRef" href="#section-5.5">5.5. </a><a class="section-name selfRef" href="#name-timing-correlation-attacks">Timing Correlation Attacks</a>
        </h3>
<p id="section-5.5-1">Context-bound token challenges require Clients to obtain matching tokens when
challenged, rather than presenting a token that was obtained from a different
context in the past. This can make it more likely that issuance and redemption
events will occur at approximately the same time. For example, if a Client is
challenged for a token with a unique context at time T1 and then subsequently
obtains a token at time T2, a colluding Issuer and Origin can link this to the
same Client if T2 is unique to the Client. This linkability is less feasible as
the number of issuance events at time T2 increases. Depending on the <code>max-age</code>
token challenge parameter, Clients <span class="bcp14">MAY</span> try to add delay to the time between
being challenged and redeeming a token to make this sort of linkability more
difficult. For more discussion on correlation risks between token issuance and
redemption, see <span><a class="relref" href="https://rfc-editor.org/rfc/rfc9576#section-6.3">Section 6.3</a> of [<a class="cite xref" href="#RFC9576">ARCHITECTURE</a>]</span>.<a class="pilcrow" href="#section-5.5-1">¶</a></p>
</section>
</div>
<div id="cross-context-linkability-attacks">
<section id="section-5.6">
        <h3 id="name-cross-context-linkability-a">
<a class="section-number selfRef" href="#section-5.6">5.6. </a><a class="section-name selfRef" href="#name-cross-context-linkability-a">Cross-Context Linkability Attacks</a>
        </h3>
<p id="section-5.6-1">As discussed in <a class="auto internal xref" href="#challenge">Section 2.1</a>, Clients <span class="bcp14">SHOULD</span> discard any context-bound tokens
upon flushing cookies or changing networks, to prevent an Origin from using the
redemption context state as a cookie to recognize Clients.<a class="pilcrow" href="#section-5.6-1">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana">
<section id="section-6">
      <h2 id="name-iana-considerations">
<a class="section-number selfRef" href="#section-6">6. </a><a class="section-name selfRef" href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<div id="authentication-scheme">
<section id="section-6.1">
        <h3 id="name-authentication-scheme">
<a class="section-number selfRef" href="#section-6.1">6.1. </a><a class="section-name selfRef" href="#name-authentication-scheme">Authentication Scheme</a>
        </h3>
<p id="section-6.1-1">IANA has registered the "PrivateToken" authentication scheme in the
"HTTP Authentication Schemes" subregistry of the "Hypertext Transfer Protocol (HTTP) Authentication Scheme Registry" as defined
in <span>[<a class="cite xref" href="#RFC9110">HTTP</a>], <a class="relref" href="https://rfc-editor.org/rfc/rfc9110#section-16.4">Section 16.4</a></span>.<a class="pilcrow" href="#section-6.1-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-6.1-2">
          <dt id="section-6.1-2.1">Authentication Scheme Name:</dt>
          <dd id="section-6.1-2.2" style="margin-left: 1.5em">PrivateToken<a class="pilcrow" href="#section-6.1-2.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-2.3">Reference:</dt>
          <dd id="section-6.1-2.4" style="margin-left: 1.5em">RFC 9577, <a class="auto internal xref" href="#challenge-redemption">Section 2</a><a class="pilcrow" href="#section-6.1-2.4">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="token-types">
<section id="section-6.2">
        <h3 id="name-privacy-pass-token-types-re">
<a class="section-number selfRef" href="#section-6.2">6.2. </a><a class="section-name selfRef" href="#name-privacy-pass-token-types-re">Privacy Pass Token Types Registry</a>
        </h3>
<p id="section-6.2-1">IANA has created a new "Privacy Pass Token Types" registry in a new
"Privacy Pass" page to list identifiers for issuance protocols
defined for use with the Privacy Pass token authentication scheme. These
identifiers are 2-byte values, so the maximum possible value is
0xFFFF = 65535.<a class="pilcrow" href="#section-6.2-1">¶</a></p>
<p id="section-6.2-2">New registrations need to list the following attributes:<a class="pilcrow" href="#section-6.2-2">¶</a></p>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-6.2-3">
          <dt id="section-6.2-3.1">Value:</dt>
          <dd id="section-6.2-3.2" style="margin-left: 1.5em">
            The 2-byte identifier for the algorithm.<a class="pilcrow" href="#section-6.2-3.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-3.3">Name:</dt>
          <dd id="section-6.2-3.4" style="margin-left: 1.5em">Name of the issuance protocol.<a class="pilcrow" href="#section-6.2-3.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-3.5">Token Structure:</dt>
          <dd id="section-6.2-3.6" style="margin-left: 1.5em">The contents of the token structure; see <a class="auto internal xref" href="#redemption">Section 2.2</a>.<a class="pilcrow" href="#section-6.2-3.6">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-3.7">Token Key Encoding:</dt>
          <dd id="section-6.2-3.8" style="margin-left: 1.5em">The encoding of the <code>token-key</code> parameter; see <a class="auto internal xref" href="#send-challenge">Section 2.1.2</a>.<a class="pilcrow" href="#section-6.2-3.8">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-3.9">TokenChallenge Structure:</dt>
          <dd id="section-6.2-3.10" style="margin-left: 1.5em">The contents of the TokenChallenge structure; see <a class="auto internal xref" href="#challenge">Section 2.1</a>.<a class="pilcrow" href="#section-6.2-3.10">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-3.11">Publicly Verifiable:</dt>
          <dd id="section-6.2-3.12" style="margin-left: 1.5em">A Y/N value indicating if the output tokens have the
public verifiability property; see <span><a class="relref" href="https://rfc-editor.org/rfc/rfc9576#section-3.5">Section 3.5</a> of [<a class="cite xref" href="#RFC9576">ARCHITECTURE</a>]</span>
for more details about this property.<a class="pilcrow" href="#section-6.2-3.12">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-3.13">Public Metadata:</dt>
          <dd id="section-6.2-3.14" style="margin-left: 1.5em">A Y/N value indicating if the output tokens can contain
public metadata; see <span><a class="relref" href="https://rfc-editor.org/rfc/rfc9576#section-3.5">Section 3.5</a> of [<a class="cite xref" href="#RFC9576">ARCHITECTURE</a>]</span>
for more details about this property.<a class="pilcrow" href="#section-6.2-3.14">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-3.15">Private Metadata:</dt>
          <dd id="section-6.2-3.16" style="margin-left: 1.5em">A Y/N value indicating if the output tokens can contain
private metadata; see <span><a class="relref" href="https://rfc-editor.org/rfc/rfc9576#section-3.5">Section 3.5</a> of [<a class="cite xref" href="#RFC9576">ARCHITECTURE</a>]</span>
for more details about this property.<a class="pilcrow" href="#section-6.2-3.16">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-3.17">Nk:</dt>
          <dd id="section-6.2-3.18" style="margin-left: 1.5em">The length in bytes of an output authenticator.<a class="pilcrow" href="#section-6.2-3.18">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-3.19">Nid:</dt>
          <dd id="section-6.2-3.20" style="margin-left: 1.5em">The length of the token key identifier.<a class="pilcrow" href="#section-6.2-3.20">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-3.21">Change Controller:</dt>
          <dd id="section-6.2-3.22" style="margin-left: 1.5em">The entity that is responsible for the definition of the registration.<a class="pilcrow" href="#section-6.2-3.22">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-3.23">Reference:</dt>
          <dd id="section-6.2-3.24" style="margin-left: 1.5em">Where this algorithm is defined.<a class="pilcrow" href="#section-6.2-3.24">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-3.25">Notes:</dt>
          <dd id="section-6.2-3.26" style="margin-left: 1.5em">Any notes associated with the entry.<a class="pilcrow" href="#section-6.2-3.26">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-6.2-4">New entries in this registry are subject to the Specification Required
registration policy (<span>[<a class="cite xref" href="#RFC8126">RFC8126</a>], <a class="relref" href="https://rfc-editor.org/rfc/rfc8126#section-4.6">Section 4.6</a></span>). Designated experts need to
ensure that the token type is defined to be used for both token issuance and
redemption. Additionally, the experts can reject registrations on the basis
that they do not meet the security and privacy requirements for issuance
protocols defined in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc9576#section-3.2">Section 3.2</a> of [<a class="cite xref" href="#RFC9576">ARCHITECTURE</a>]</span>.<a class="pilcrow" href="#section-6.2-4">¶</a></p>
<p id="section-6.2-5"><span>[<a class="cite xref" href="#RFC9578">ISSUANCE</a>]</span> defines entries for this registry.<a class="pilcrow" href="#section-6.2-5">¶</a></p>
<div id="reserved-values">
<section id="section-6.2.1">
          <h4 id="name-reserved-values">
<a class="section-number selfRef" href="#section-6.2.1">6.2.1. </a><a class="section-name selfRef" href="#name-reserved-values">Reserved Values</a>
          </h4>
<p id="section-6.2.1-1">This document defines several reserved values, which can be used by Clients
and servers to send "greased" values in token challenges and redemptions to
ensure that implementations remain able to handle unknown token types
gracefully (this technique is inspired by <span>[<a class="cite xref" href="#RFC8701">RFC8701</a>]</span>). Implementations <span class="bcp14">SHOULD</span>
select reserved values at random when including them in greased messages.
Servers can include these in TokenChallenge structures, either as the only
challenge when no real token type is desired or as one challenge in a list of
challenges that include real values. Clients can include these in token
structures when they are not able to present a real token. The
contents of the token structure <span class="bcp14">SHOULD</span> be filled with random bytes when
using greased values.<a class="pilcrow" href="#section-6.2.1-1">¶</a></p>
<p id="section-6.2.1-2">The initial contents of this registry consist of multiple reserved values,
with the following attributes, which are repeated for each registration:<a class="pilcrow" href="#section-6.2.1-2">¶</a></p>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-6.2.1-3">
            <dt id="section-6.2.1-3.1">Value:</dt>
            <dd id="section-6.2.1-3.2" style="margin-left: 1.5em">0x0000, 0x02AA, 0x1132, 0x2E96, 0x3CD3, 0x4473, 0x5A63, 0x6D32, 0x7F3F,
0x8D07, 0x916B, 0xA6A4, 0xBEAB, 0xC3F3, 0xDA42, 0xE944, 0xF057<a class="pilcrow" href="#section-6.2.1-3.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-6.2.1-3.3">Name:</dt>
            <dd id="section-6.2.1-3.4" style="margin-left: 1.5em">RESERVED<a class="pilcrow" href="#section-6.2.1-3.4">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-6.2.1-3.5">Token Structure:</dt>
            <dd id="section-6.2.1-3.6" style="margin-left: 1.5em">Random bytes<a class="pilcrow" href="#section-6.2.1-3.6">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-6.2.1-3.7">Token Key Encoding:</dt>
            <dd id="section-6.2.1-3.8" style="margin-left: 1.5em">Random bytes<a class="pilcrow" href="#section-6.2.1-3.8">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-6.2.1-3.9">TokenChallenge Structure:</dt>
            <dd id="section-6.2.1-3.10" style="margin-left: 1.5em">Random bytes<a class="pilcrow" href="#section-6.2.1-3.10">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-6.2.1-3.11">Publicly Verifiable:</dt>
            <dd id="section-6.2.1-3.12" style="margin-left: 1.5em">N/A<a class="pilcrow" href="#section-6.2.1-3.12">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-6.2.1-3.13">Public Metadata:</dt>
            <dd id="section-6.2.1-3.14" style="margin-left: 1.5em">N/A<a class="pilcrow" href="#section-6.2.1-3.14">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-6.2.1-3.15">Private Metadata:</dt>
            <dd id="section-6.2.1-3.16" style="margin-left: 1.5em">N/A<a class="pilcrow" href="#section-6.2.1-3.16">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-6.2.1-3.17">Nk:</dt>
            <dd id="section-6.2.1-3.18" style="margin-left: 1.5em">N/A<a class="pilcrow" href="#section-6.2.1-3.18">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-6.2.1-3.19">Nid:</dt>
            <dd id="section-6.2.1-3.20" style="margin-left: 1.5em">N/A<a class="pilcrow" href="#section-6.2.1-3.20">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-6.2.1-3.21">Change Controller:</dt>
            <dd id="section-6.2.1-3.22" style="margin-left: 1.5em">IETF<a class="pilcrow" href="#section-6.2.1-3.22">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-6.2.1-3.23">Reference:</dt>
            <dd id="section-6.2.1-3.24" style="margin-left: 1.5em">RFC 9577<a class="pilcrow" href="#section-6.2.1-3.24">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-6.2.1-3.25">Notes:</dt>
            <dd id="section-6.2.1-3.26" style="margin-left: 1.5em">None<a class="pilcrow" href="#section-6.2.1-3.26">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
</section>
</div>
<section id="section-7">
      <h2 id="name-references">
<a class="section-number selfRef" href="#section-7">7. </a><a class="section-name selfRef" href="#name-references">References</a>
      </h2>
<section id="section-7.1">
        <h3 id="name-normative-references">
<a class="section-number selfRef" href="#section-7.1">7.1. </a><a class="section-name selfRef" href="#name-normative-references">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC9576">[ARCHITECTURE]</dt>
        <dd>
<span class="refAuthor">Davidson, A.</span>, <span class="refAuthor">Iyengar, J.</span>, and <span class="refAuthor">C. A. Wood</span>, <span class="refTitle">"The Privacy Pass Architecture"</span>, <span class="seriesInfo">RFC 9576</span>, <span class="seriesInfo">DOI 10.17487/RFC9576</span>, <time class="refDate" datetime="2024-06">June 2024</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9576">https://www.rfc-editor.org/info/rfc9576</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9110">[HTTP]</dt>
        <dd>
<span class="refAuthor">Fielding, R., Ed.</span>, <span class="refAuthor">Nottingham, M., Ed.</span>, and <span class="refAuthor">J. Reschke, Ed.</span>, <span class="refTitle">"HTTP Semantics"</span>, <span class="seriesInfo">STD 97</span>, <span class="seriesInfo">RFC 9110</span>, <span class="seriesInfo">DOI 10.17487/RFC9110</span>, <time class="refDate" datetime="2022-06">June 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9110">https://www.rfc-editor.org/info/rfc9110</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time class="refDate" datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4648">[RFC4648]</dt>
        <dd>
<span class="refAuthor">Josefsson, S.</span>, <span class="refTitle">"The Base16, Base32, and Base64 Data Encodings"</span>, <span class="seriesInfo">RFC 4648</span>, <span class="seriesInfo">DOI 10.17487/RFC4648</span>, <time class="refDate" datetime="2006-10">October 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4648">https://www.rfc-editor.org/info/rfc4648</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time class="refDate" datetime="2017-06">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time class="refDate" datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SHS">[SHS]</dt>
        <dd>
<span class="refAuthor">National Institute of Standards and Technology</span>, <span class="refTitle">"Secure Hash Standard (SHS)"</span>, <span class="seriesInfo">NIST FIPS Publication 180-4</span>, <span class="seriesInfo">DOI 10.6028/NIST.FIPS.180-4</span>, <time class="refDate" datetime="2015-08">August 2015</time>, <span>&lt;<a href="https://doi.org/10.6028/nist.fips.180-4">https://doi.org/10.6028/nist.fips.180-4</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[TLS13]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time class="refDate" datetime="2018-08">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3986">[URI]</dt>
      <dd>
<span class="refAuthor">Berners-Lee, T.</span>, <span class="refAuthor">Fielding, R.</span>, and <span class="refAuthor">L. Masinter</span>, <span class="refTitle">"Uniform Resource Identifier (URI): Generic Syntax"</span>, <span class="seriesInfo">STD 66</span>, <span class="seriesInfo">RFC 3986</span>, <span class="seriesInfo">DOI 10.17487/RFC3986</span>, <time class="refDate" datetime="2005-01">January 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3986">https://www.rfc-editor.org/info/rfc3986</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-7.2">
        <h3 id="name-informative-references">
<a class="section-number selfRef" href="#section-7.2">7.2. </a><a class="section-name selfRef" href="#name-informative-references">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-httpbis-rfc6265bis">[COOKIES]</dt>
        <dd>
<span class="refAuthor">Bingler, S., Ed.</span>, <span class="refAuthor">West, M., Ed.</span>, and <span class="refAuthor">J. Wilander, Ed.</span>, <span class="refTitle">"Cookies: HTTP State Management Mechanism"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-httpbis-rfc6265bis-14</span>, <time class="refDate" datetime="2024-05-02">2 May 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-httpbis-rfc6265bis-14">https://datatracker.ietf.org/doc/html/draft-ietf-httpbis-rfc6265bis-14</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9578">[ISSUANCE]</dt>
        <dd>
<span class="refAuthor">Celi, S.</span>, <span class="refAuthor">Davidson, A.</span>, <span class="refAuthor">Valdez, S.</span>, and <span class="refAuthor">C. A. Wood</span>, <span class="refTitle">"Privacy Pass Issuance Protocols"</span>, <span class="seriesInfo">RFC 9578</span>, <span class="seriesInfo">DOI 10.17487/RFC9578</span>, <time class="refDate" datetime="2024-06">June 2024</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9578">https://www.rfc-editor.org/info/rfc9578</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4086">[RFC4086]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span>, <span class="refAuthor">Schiller, J.</span>, and <span class="refAuthor">S. Crocker</span>, <span class="refTitle">"Randomness Requirements for Security"</span>, <span class="seriesInfo">BCP 106</span>, <span class="seriesInfo">RFC 4086</span>, <span class="seriesInfo">DOI 10.17487/RFC4086</span>, <time class="refDate" datetime="2005-06">June 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4086">https://www.rfc-editor.org/info/rfc4086</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8470">[RFC8470]</dt>
        <dd>
<span class="refAuthor">Thomson, M.</span>, <span class="refAuthor">Nottingham, M.</span>, and <span class="refAuthor">W. Tarreau</span>, <span class="refTitle">"Using Early Data in HTTP"</span>, <span class="seriesInfo">RFC 8470</span>, <span class="seriesInfo">DOI 10.17487/RFC8470</span>, <time class="refDate" datetime="2018-09">September 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8470">https://www.rfc-editor.org/info/rfc8470</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8701">[RFC8701]</dt>
        <dd>
<span class="refAuthor">Benjamin, D.</span>, <span class="refTitle">"Applying Generate Random Extensions And Sustain Extensibility (GREASE) to TLS Extensibility"</span>, <span class="seriesInfo">RFC 8701</span>, <span class="seriesInfo">DOI 10.17487/RFC8701</span>, <time class="refDate" datetime="2020-01">January 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8701">https://www.rfc-editor.org/info/rfc8701</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9001">[RFC9001]</dt>
      <dd>
<span class="refAuthor">Thomson, M., Ed.</span> and <span class="refAuthor">S. Turner, Ed.</span>, <span class="refTitle">"Using TLS to Secure QUIC"</span>, <span class="seriesInfo">RFC 9001</span>, <span class="seriesInfo">DOI 10.17487/RFC9001</span>, <time class="refDate" datetime="2021-05">May 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9001">https://www.rfc-editor.org/info/rfc9001</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="test-vectors">
<section id="appendix-A">
      <h2 id="name-test-vectors">
<a class="section-number selfRef" href="#appendix-A">Appendix A. </a><a class="section-name selfRef" href="#name-test-vectors">Test Vectors</a>
      </h2>
<p id="appendix-A-1">This section includes test vectors for the HTTP authentication scheme specified
in this document. It consists of the following types of test vectors:<a class="pilcrow" href="#appendix-A-1">¶</a></p>
<ol class="normal type-1" id="appendix-A-2" start="1" type="1">
<li id="appendix-A-2.1">Test vectors for the challenge and redemption protocols. Implementations can
use these test vectors for verifying code that builds and encodes
TokenChallenge structures, as well as code that produces a well-formed token
bound to a TokenChallenge.<a class="pilcrow" href="#appendix-A-2.1">¶</a>
</li>
        <li id="appendix-A-2.2">Test vectors for the HTTP headers used for authentication. Implementations
can use these test vectors for validating whether they parse HTTP
authentication headers correctly to produce TokenChallenge structures and the
other associated parameters, such as the <code>token-key</code> and <code>max-age</code> values.<a class="pilcrow" href="#appendix-A-2.2">¶</a>
</li>
      </ol>
<div id="challenge-and-redemption-structure-test-vectors">
<section id="appendix-A.1">
        <h3 id="name-challenge-and-redemption-st">
<a class="section-number selfRef" href="#appendix-A.1">A.1. </a><a class="section-name selfRef" href="#name-challenge-and-redemption-st">Challenge and Redemption Structure Test Vectors</a>
        </h3>
<p id="appendix-A.1-1">This section includes test vectors for the challenge and redemption
functionalities described in Sections <a class="auto internal xref" href="#challenge">2.1</a> and <a class="auto internal xref" href="#redemption">2.2</a>. Each test vector
lists the following values:<a class="pilcrow" href="#appendix-A.1-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="appendix-A.1-2">
          <dt id="appendix-A.1-2.1">
<code>token_type</code>:</dt>
          <dd id="appendix-A.1-2.2" style="margin-left: 1.5em">The type of token issuance protocol -- a value from
<a class="auto internal xref" href="#token-types">Section 6.2</a>. For these test vectors, <code>token_type</code> is <code>0x0002</code>, corresponding
to the issuance protocol discussed in Section <span><a class="relref" href="https://rfc-editor.org/rfc/rfc9578#section-6">6</a> (<a class="relref" href="https://rfc-editor.org/rfc/rfc9578#section-6">"Issuance Protocol for Publicly Verifiable Tokens"</a>)</span> of <span>[<a class="cite xref" href="#RFC9578">ISSUANCE</a>]</span>.<a class="pilcrow" href="#appendix-A.1-2.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="appendix-A.1-2.3">
<code>issuer_name</code>:</dt>
          <dd id="appendix-A.1-2.4" style="margin-left: 1.5em"> The name of the Issuer in the TokenChallenge structure,
represented as a hexadecimal string.<a class="pilcrow" href="#appendix-A.1-2.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="appendix-A.1-2.5">
<code>redemption_context</code>:</dt>
          <dd id="appendix-A.1-2.6" style="margin-left: 1.5em">The redemption context in the TokenChallenge structure,
represented as a hexadecimal string.<a class="pilcrow" href="#appendix-A.1-2.6">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="appendix-A.1-2.7">
<code>origin_info</code>:</dt>
          <dd id="appendix-A.1-2.8" style="margin-left: 1.5em"> The Origin information in the TokenChallenge structure, represented as
a hexadecimal string.<a class="pilcrow" href="#appendix-A.1-2.8">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="appendix-A.1-2.9">
<code>nonce</code>:</dt>
          <dd id="appendix-A.1-2.10" style="margin-left: 1.5em">The nonce in the token structure, represented as a hexadecimal string.<a class="pilcrow" href="#appendix-A.1-2.10">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="appendix-A.1-2.11">
<code>token_key_id</code>:</dt>
          <dd id="appendix-A.1-2.12" style="margin-left: 1.5em">The public token key, encoded based on the corresponding token
type, represented as a hexadecimal string.<a class="pilcrow" href="#appendix-A.1-2.12">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="appendix-A.1-2.13">
<code>token_authenticator_input</code>:</dt>
          <dd id="appendix-A.1-2.14" style="margin-left: 1.5em">The values in the token structure used to compute
the token authenticator value, represented as a hexadecimal string.<a class="pilcrow" href="#appendix-A.1-2.14">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="appendix-A.1-3">Test vectors are provided for each of the following TokenChallenge
configurations:<a class="pilcrow" href="#appendix-A.1-3">¶</a></p>
<ol class="normal type-1" id="appendix-A.1-4" start="1" type="1">
<li id="appendix-A.1-4.1">TokenChallenge with a single Origin and a non-empty redemption context.<a class="pilcrow" href="#appendix-A.1-4.1">¶</a>
</li>
          <li id="appendix-A.1-4.2">TokenChallenge with a single Origin and empty redemption context.<a class="pilcrow" href="#appendix-A.1-4.2">¶</a>
</li>
          <li id="appendix-A.1-4.3">TokenChallenge with an empty Origin and redemption context.<a class="pilcrow" href="#appendix-A.1-4.3">¶</a>
</li>
          <li id="appendix-A.1-4.4">TokenChallenge with an empty Origin and a non-empty redemption context.<a class="pilcrow" href="#appendix-A.1-4.4">¶</a>
</li>
          <li id="appendix-A.1-4.5">TokenChallenge with multiple Origins and a non-empty redemption context.<a class="pilcrow" href="#appendix-A.1-4.5">¶</a>
</li>
          <li id="appendix-A.1-4.6">TokenChallenge for greasing.<a class="pilcrow" href="#appendix-A.1-4.6">¶</a>
</li>
        </ol>
<p id="appendix-A.1-5">These test vectors are below.<a class="pilcrow" href="#appendix-A.1-5">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.1-6">
<pre>// Test vector 1:
//   token_type(0002), issuer_name(issuer.example),
//   origin_info(origin.example), redemption_context(non-empty)
token_type: 0002
issuer_name: 6973737565722e6578616d706c65
redemption_context:
476ac2c935f458e9b2d7af32dacfbd22dd6023ef5887a789f1abe004e79bb5bb
origin_info: 6f726967696e2e6578616d706c65
nonce:
e01978182c469e5e026d66558ee186568614f235e41ef7e2378e6f202688abab
token_key_id:
ca572f8982a9ca248a3056186322d93ca147266121ddeb5632c07f1f71cd2708
token_authenticator_input: 0002e01978182c469e5e026d66558ee1865686
14f235e41ef7e2378e6f202688abab8e1d5518ec82964255526efd8f9db88205a
8ddd3ffb1db298fcc3ad36c42388fca572f8982a9ca248a3056186322d93ca147
266121ddeb5632c07f1f71cd2708

// Test vector 2:
//   token_type(0002), issuer_name(issuer.example),
//   origin_info(origin.example), redemption_context(empty)
token_type: 0002
issuer_name: 6973737565722e6578616d706c65
redemption_context:
origin_info: 6f726967696e2e6578616d706c65
nonce:
e01978182c469e5e026d66558ee186568614f235e41ef7e2378e6f202688abab
token_key_id:
ca572f8982a9ca248a3056186322d93ca147266121ddeb5632c07f1f71cd2708
token_authenticator_input: 0002e01978182c469e5e026d66558ee1865686
14f235e41ef7e2378e6f202688abab11e15c91a7c2ad02abd66645802373db1d8
23bea80f08d452541fb2b62b5898bca572f8982a9ca248a3056186322d93ca147
266121ddeb5632c07f1f71cd2708

// Test vector 3:
//   token_type(0002), issuer_name(issuer.example),
//   origin_info(), redemption_context(empty)
token_type: 0002
issuer_name: 6973737565722e6578616d706c65
redemption_context:
origin_info:
nonce:
e01978182c469e5e026d66558ee186568614f235e41ef7e2378e6f202688abab
token_key_id:
ca572f8982a9ca248a3056186322d93ca147266121ddeb5632c07f1f71cd2708
token_authenticator_input: 0002e01978182c469e5e026d66558ee1865686
14f235e41ef7e2378e6f202688ababb741ec1b6fd05f1e95f8982906aec161289
6d9ca97d53eef94ad3c9fe023f7a4ca572f8982a9ca248a3056186322d93ca147
266121ddeb5632c07f1f71cd2708

// Test vector 4:
//   token_type(0002), issuer_name(issuer.example),
//   origin_info(), redemption_context(non-empty)
token_type: 0002
issuer_name: 6973737565722e6578616d706c65
redemption_context:
476ac2c935f458e9b2d7af32dacfbd22dd6023ef5887a789f1abe004e79bb5bb
origin_info:
nonce:
e01978182c469e5e026d66558ee186568614f235e41ef7e2378e6f202688abab
token_key_id:
ca572f8982a9ca248a3056186322d93ca147266121ddeb5632c07f1f71cd2708
token_authenticator_input: 0002e01978182c469e5e026d66558ee1865686
14f235e41ef7e2378e6f202688ababb85fb5bc06edeb0e8e8bdb5b3bea8c4fa40
837c82e8bcaf5882c81e14817ea18ca572f8982a9ca248a3056186322d93ca147
266121ddeb5632c07f1f71cd2708

// Test vector 5:
//   token_type(0002), issuer_name(issuer.example),
//   origin_info(foo.example,bar.example),
//   redemption_context(non-empty)
token_type: 0002
issuer_name: 6973737565722e6578616d706c65
redemption_context:
476ac2c935f458e9b2d7af32dacfbd22dd6023ef5887a789f1abe004e79bb5bb
origin_info: 666f6f2e6578616d706c652c6261722e6578616d706c65
nonce:
e01978182c469e5e026d66558ee186568614f235e41ef7e2378e6f202688abab
token_key_id:
ca572f8982a9ca248a3056186322d93ca147266121ddeb5632c07f1f71cd2708
token_authenticator_input: 0002e01978182c469e5e026d66558ee1865686
14f235e41ef7e2378e6f202688ababa2a775866b6ae0f98944910c8f48728d8a2
735b9157762ddbf803f70e2e8ba3eca572f8982a9ca248a3056186322d93ca147
266121ddeb5632c07f1f71cd2708

// Test vector 6:
//   token_type(0000), structure(random_bytes)
token_type: 0000
token_authenticator_input: 000058405ad31e286e874cb42d0ef9d50461ae
703bb71a21178beb429c43c0effe587456d856f0f2bdfc216ef93d5c225e2a93e
84cb686e63919788087f7ab1054aa817f09dcb919a0ed6f90fe887e8b08cd1eee
44d5be8d813eda9f2656db61c932db8d73f8690604ded0120157923bbd19d5549
e639e4de07530aee1d370f5187b678685715bd878dde24346751eb532a87b71ea
40bbe5a13218658e303c648eb03817453690bfcbe8255081bf27ff0891cd02ee2
483e48a2c494bdef696f943fa992a65303292c25d0d3f62da86a70d0b020f0ff5
b90d0ff0f6abdb097d321fde04f3a1994e63bcd35a88c21236c7dc67600482223
f54b25e39a250439f27ecb5ae9eb8ed548a3ec1f1d6f510d08281929c8fe08834
2959e35ea9b3b6f6a96fc1a8edba4ed297f4cf02d0e4482b79a11f671745d7b7d
b120eddd8a4c2b6501bbc895b2160b8071615d9c1b18f32e056bfee29deac6a7d
6cf7b522a5badd63b9cb
</pre><a class="pilcrow" href="#appendix-A.1-6">¶</a>
</div>
</section>
</div>
<div id="http-header-test-vectors">
<section id="appendix-A.2">
        <h3 id="name-http-header-test-vectors">
<a class="section-number selfRef" href="#appendix-A.2">A.2. </a><a class="section-name selfRef" href="#name-http-header-test-vectors">HTTP Header Test Vectors</a>
        </h3>
<p id="appendix-A.2-1">This section includes test vectors for the contents of the HTTP authentication
headers. Each test vector consists of one or more challenges that comprise
a <code>WWW-Authenticate</code> header; see
<a class="auto internal xref" href="#choosing-between-multiple-challenges">Section 3.2</a>.
For each challenge, the token-type, <code>token-key</code>, <code>max-age</code>, and <code>token-challenge</code>
parameters are listed. Each challenge also includes an unknown (unspecified)
parameter that implementations are meant to ignore.<a class="pilcrow" href="#appendix-A.2-1">¶</a></p>
<p id="appendix-A.2-2">The parameters for each challenge are indexed by their position
in the <code>WWW-Authenticate</code> challenge list. For example, <code>token-key-0</code> denotes
the <code>token-key</code> parameter for the first challenge in the list, whereas
<code>token-key-1</code> denotes the <code>token-key</code> for the second challenge in the list.<a class="pilcrow" href="#appendix-A.2-2">¶</a></p>
<p id="appendix-A.2-3">The resulting wire-encoded <code>WWW-Authenticate</code> header based on this
list of challenges is then listed at the end. Line folding is only
used to fit the document-formatting constraints and is not supported
in actual requests.<a class="pilcrow" href="#appendix-A.2-3">¶</a></p>
<p id="appendix-A.2-4">The last challenge in this list includes Basic authentication, a grease
challenge, and a valid challenge for token type <code>0x0001</code>. Correct Client
implementations will ignore the Basic and grease challenges.<a class="pilcrow" href="#appendix-A.2-4">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.2-5">
<pre>token-type-0: 0x0002
token-key-0: 30820152303d06092a864886f70d01010a3030a00d300b060960864
8016503040202a11a301806092a864886f70d010108300b060960864801650304020
2a2030201300382010f003082010a0282010100cb1aed6b6a95f5b1ce013a4cfcab2
5b94b2e64a23034e4250a7eab43c0df3a8c12993af12b111908d4b471bec31d4b6c9
ad9cdda90612a2ee903523e6de5a224d6b02f09e5c374d0cfe01d8f529c500a78a2f
67908fa682b5a2b430c81eaf1af72d7b5e794fc98a3139276879757ce453b526ef9b
f6ceb99979b8423b90f4461a22af37aab0cf5733f7597abe44d31c732db68a181c6c
bbe607d8c0e52e0655fd9996dc584eca0be87afbcd78a337d17b1dba9e828bbd81e2
91317144e7ff89f55619709b096cbb9ea474cead264c2073fe49740c01f00e109106
066983d21e5f83f086e2e823c879cd43cef700d2a352a9babd612d03cad02db134b7
e225a5f0203010001
max-age-0: 10
token-challenge-0: 0002000e6973737565722e6578616d706c65208a3e83a33d9
8005d2f30bef419fa6bf4cd5c6005e36b1285bbb4ccd40fa4b383000e6f726967696
e2e6578616d706c65

WWW-Authenticate: PrivateToken challenge="AAIADmlzc3Vlci5leGFtcGxlII
o-g6M9mABdLzC-9Bn6a_TNXGAF42sShbu0zNQPpLODAA5vcmlnaW4uZXhhbXBsZQ==",
 token-key="MIIBUjA9BgkqhkiG9w0BAQowMKANMAsGCWCGSAFlAwQCAqEaMBgGCSqG
SIb3DQEBCDALBglghkgBZQMEAgKiAwIBMAOCAQ8AMIIBCgKCAQEAyxrta2qV9bHOATpM
_KsluUsuZKIwNOQlCn6rQ8DfOowSmTrxKxEZCNS0cb7DHUtsmtnN2pBhKi7pA1I-beWi
JNawLwnlw3TQz-Adj1KcUAp4ovZ5CPpoK1orQwyB6vGvcte155T8mKMTknaHl1fORTtS
bvm_bOuZl5uEI7kPRGGiKvN6qwz1cz91l6vkTTHHMttooYHGy75gfYwOUuBlX9mZbcWE
7KC-h6-814ozfRex26noKLvYHikTFxROf_ifVWGXCbCWy7nqR0zq0mTCBz_kl0DAHwDh
CRBgZpg9IeX4PwhuLoI8h5zUPO9wDSo1Kpur1hLQPK0C2xNLfiJaXwIDAQAB",unknow
nChallengeAttribute="ignore-me", max-age="10"

token-type-0: 0x0002
token-key-0: 30820152303d06092a864886f70d01010a3030a00d300b060960864
8016503040202a11a301806092a864886f70d010108300b060960864801650304020
2a2030201300382010f003082010a0282010100cb1aed6b6a95f5b1ce013a4cfcab2
5b94b2e64a23034e4250a7eab43c0df3a8c12993af12b111908d4b471bec31d4b6c9
ad9cdda90612a2ee903523e6de5a224d6b02f09e5c374d0cfe01d8f529c500a78a2f
67908fa682b5a2b430c81eaf1af72d7b5e794fc98a3139276879757ce453b526ef9b
f6ceb99979b8423b90f4461a22af37aab0cf5733f7597abe44d31c732db68a181c6c
bbe607d8c0e52e0655fd9996dc584eca0be87afbcd78a337d17b1dba9e828bbd81e2
91317144e7ff89f55619709b096cbb9ea474cead264c2073fe49740c01f00e109106
066983d21e5f83f086e2e823c879cd43cef700d2a352a9babd612d03cad02db134b7
e225a5f0203010001
max-age-0: 10
token-challenge-0: 0002000e6973737565722e6578616d706c65208a3e83a33d9
8005d2f30bef419fa6bf4cd5c6005e36b1285bbb4ccd40fa4b383000e6f726967696
e2e6578616d706c65
token-type-1: 0x0001
token-key-1: ebb1fed338310361c08d0c7576969671296e05e99a17d7926dfc28a
53fabd489fac0f82bca86249a668f3a5bfab374c9
max-age-1: 10
token-challenge-1: 0001000e6973737565722e6578616d706c65208a3e83a33d9
8005d2f30bef419fa6bf4cd5c6005e36b1285bbb4ccd40fa4b383000e6f726967696
e2e6578616d706c65

WWW-Authenticate: PrivateToken challenge="AAIADmlzc3Vlci5leGFtcGxlII
o-g6M9mABdLzC-9Bn6a_TNXGAF42sShbu0zNQPpLODAA5vcmlnaW4uZXhhbXBsZQ==",
 token-key="MIIBUjA9BgkqhkiG9w0BAQowMKANMAsGCWCGSAFlAwQCAqEaMBgGCSqG
SIb3DQEBCDALBglghkgBZQMEAgKiAwIBMAOCAQ8AMIIBCgKCAQEAyxrta2qV9bHOATpM
_KsluUsuZKIwNOQlCn6rQ8DfOowSmTrxKxEZCNS0cb7DHUtsmtnN2pBhKi7pA1I-beWi
JNawLwnlw3TQz-Adj1KcUAp4ovZ5CPpoK1orQwyB6vGvcte155T8mKMTknaHl1fORTtS
bvm_bOuZl5uEI7kPRGGiKvN6qwz1cz91l6vkTTHHMttooYHGy75gfYwOUuBlX9mZbcWE
7KC-h6-814ozfRex26noKLvYHikTFxROf_ifVWGXCbCWy7nqR0zq0mTCBz_kl0DAHwDh
CRBgZpg9IeX4PwhuLoI8h5zUPO9wDSo1Kpur1hLQPK0C2xNLfiJaXwIDAQAB",unknow
nChallengeAttribute="ignore-me", max-age="10", PrivateToken challeng
e="AAEADmlzc3Vlci5leGFtcGxlIIo-g6M9mABdLzC-9Bn6a_TNXGAF42sShbu0zNQPp
LODAA5vcmlnaW4uZXhhbXBsZQ==", token-key="67H-0zgxA2HAjQx1dpaWcSluBem
aF9eSbfwopT-r1In6wPgryoYkmmaPOlv6s3TJ",unknownChallengeAttribute="ig
nore-me", max-age="10"

token-type-0: 0x0000
token-key-0: 856de3c710b892e7cca1ae5eb121af42ca8e779137a11224228c9b9
9b0729bf84d5057d030000309b8f0d06ccffa17561f9eacd4c312e985a6bc60ffbea
0610264dcb1726255313da81d665692686a1d8644f1516bf612cea009e6dff6d9a9a
959fb538e1b5b2343c092992942382bdde22d5b324b1e4618ed21d7806286c2ce
token-challenge-0: 0000acc3b25795c636fd9dd8b12982394abba8777d35978e8
77fc8848892a217233045ac25a3d55c07c54efe6372973fee0073e77fc61bf19ab88
0f20edf5d627502
token-type-1: 0x0001
token-key-1: ebb1fed338310361c08d0c7576969671296e05e99a17d7926dfc28a
53fabd489fac0f82bca86249a668f3a5bfab374c9
max-age-1: 10
token-challenge-1: 0001000e6973737565722e6578616d706c65208a3e83a33d9
8005d2f30bef419fa6bf4cd5c6005e36b1285bbb4ccd40fa4b383000e6f726967696
e2e6578616d706c65

WWW-Authenticate: Basic realm="grease", PrivateToken challenge="AACs
w7JXlcY2_Z3YsSmCOUq7qHd9NZeOh3_IhIiSohcjMEWsJaPVXAfFTv5jcpc_7gBz53_G
G_GauIDyDt9dYnUC", token-key="hW3jxxC4kufMoa5esSGvQsqOd5E3oRIkIoybmbB
ym_hNUFfQMAADCbjw0GzP-hdWH56s1MMS6YWmvGD_vqBhAmTcsXJiVTE9qB1mVpJoah2
GRPFRa_YSzqAJ5t_22ampWftTjhtbI0PAkpkpQjgr3eItWzJLHkYY7SHXgGKGws4=",
PrivateToken challenge="AAEADmlzc3Vlci5leGFtcGxlIIo-g6M9mABdLzC-9Bn6
a_TNXGAF42sShbu0zNQPpLODAA5vcmlnaW4uZXhhbXBsZQ==", token-key="67H-0z
gxA2HAjQx1dpaWcSluBemaF9eSbfwopT-r1In6wPgryoYkmmaPOlv6s3TJ",unknownC
hallengeAttribute="ignore-me", max-age="10"
</pre><a class="pilcrow" href="#appendix-A.2-5">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-addresses">
<a class="section-name selfRef" href="#name-authors-addresses">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Tommy Pauly</span></div>
<div class="left" dir="auto"><span class="org">Apple Inc.</span></div>
<div class="left" dir="auto"><span class="street-address">One Apple Park Way</span></div>
<div class="left" dir="auto">
<span class="locality">Cupertino</span>, <span class="region">California</span> <span class="postal-code">95014</span>
</div>
<div class="left" dir="auto"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:tpauly@apple.com">tpauly@apple.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Steven Valdez</span></div>
<div class="left" dir="auto"><span class="org">Google LLC</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:svaldez@chromium.org">svaldez@chromium.org</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Christopher A. Wood</span></div>
<div class="left" dir="auto"><span class="org">Cloudflare</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:caw@heapingbits.net">caw@heapingbits.net</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>


</body></html>