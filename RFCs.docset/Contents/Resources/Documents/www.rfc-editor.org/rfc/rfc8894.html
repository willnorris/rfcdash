<!DOCTYPE html>
<html class="RFC" lang="en"><head>
<meta charset="utf-8"/>
<meta content="Common,Latin" name="scripts"/>
<meta content="initial-scale=1.0" name="viewport"/>
<title>RFC 8894: Simple Certificate Enrolment Protocol</title>
<meta content="Peter Gutmann" name="author"/>
<meta content="
       

This document specifies the Simple Certificate Enrolment Protocol (SCEP), a
PKI protocol that leverages existing technology by using Cryptographic Message
Syntax (CMS, formerly known as PKCS #7) and PKCS #10 over HTTP.  SCEP is the
evolution of the enrolment
protocol sponsored by Cisco Systems, which enjoys wide support in both client
and server implementations, as well as being relied upon by numerous other
industry standards that work with certificates.

       
    " name="description"/>
<meta content="xml2rfc 3.0.0" name="generator"/>
<meta content="8894" name="rfc.number"/>
<link href="rfc8894.xml" rel="alternate" type="application/rfc+xml"/>
<link href="#copyright" rel="license"/>
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css"/>
<link href="https://dx.doi.org/10.17487/rfc8894" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <link href="https://datatracker.ietf.org/doc/draft-gutmann-scep-16" rel="prev"/>
  </head>
<body>
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 8894</td>
<td class="center">SCEP</td>
<td class="right">September 2020</td>
</tr></thead>
<tfoot><tr>
<td class="left">Gutmann</td>
<td class="center">Informational</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div class="document-information" id="external-metadata"></div>
<div class="document-information" id="internal-metadata">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a class="eref" href="https://www.rfc-editor.org/rfc/rfc8894">8894</a></dd>
<dt class="label-category">Category:</dt>
<dd class="category">Informational</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time class="published" datetime="2020-09">September 2020</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">P. Gutmann</div>
<div class="org">University of Auckland</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 8894</h1>
<h1 id="title">Simple Certificate Enrolment Protocol</h1>
<section id="section-abstract">
      <h2 id="abstract"><a class="selfRef" href="#abstract">Abstract</a></h2>
<p id="section-abstract-1">

This document specifies the Simple Certificate Enrolment Protocol (SCEP), a
PKI protocol that leverages existing technology by using Cryptographic Message
Syntax (CMS, formerly known as PKCS #7) and PKCS #10 over HTTP.  SCEP is the
evolution of the enrolment
protocol sponsored by Cisco Systems, which enjoys wide support in both client
and server implementations, as well as being relied upon by numerous other
industry standards that work with certificates.<a class="pilcrow" href="#section-abstract-1">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a class="section-name selfRef" href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This document is not an Internet Standards Track specification; it is
            published for informational purposes.<a class="pilcrow" href="#section-boilerplate.1-1">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by the
            Internet Engineering Steering Group (IESG).  Not all documents
            approved by the IESG are candidates for any level of Internet
            Standard; see Section 2 of RFC 7841.<a class="pilcrow" href="#section-boilerplate.1-2">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc8894">https://www.rfc-editor.org/info/rfc8894</a></span>.<a class="pilcrow" href="#section-boilerplate.1-3">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a class="section-name selfRef" href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2020 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a class="pilcrow" href="#section-boilerplate.2-1">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a class="pilcrow" href="#section-boilerplate.2-2">¶</a></p>
<p id="section-boilerplate.2-3">
            This document may contain material from IETF Documents or IETF
            Contributions published or made publicly available before November
            10, 2008. The person(s) controlling the copyright in some of this
            material may not have granted the IETF Trust the right to allow
            modifications of such material outside the IETF Standards Process.
            Without obtaining an adequate license from the person(s)
            controlling the copyright in such materials, this document may not
            be modified outside the IETF Standards Process, and derivative
            works of it may not be created outside the IETF Standards Process,
            except to format it for publication as an RFC or to translate it
            into languages other than English.<a class="pilcrow" href="#section-boilerplate.2-3">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a class="toplink" href="#" onclick="scroll(0,0)">▲</a><h2 id="name-table-of-contents">
<a class="section-name selfRef" href="#name-table-of-contents">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.1">
            <p class="keepWithNext" id="section-toc.1-1.1.1"><a class="xref" href="#section-1">1</a>.  <a class="xref" href="#name-introduction">Introduction</a><a class="pilcrow" href="#section-toc.1-1.1.1">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.1.2.1">
                <p class="keepWithNext" id="section-toc.1-1.1.2.1.1"><a class="xref" href="#section-1.1">1.1</a>.  <a class="xref" href="#name-conventions-used-in-this-do">Conventions Used in This Document</a><a class="pilcrow" href="#section-toc.1-1.1.2.1.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a class="xref" href="#section-2">2</a>.  <a class="xref" href="#name-scep-overview">SCEP Overview</a><a class="pilcrow" href="#section-toc.1-1.2.1">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a class="xref" href="#section-2.1">2.1</a>.  <a class="xref" href="#name-scep-entities">SCEP Entities</a><a class="pilcrow" href="#section-toc.1-1.2.2.1.1">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.2.2.1.2.1">
                    <p class="keepWithNext" id="section-toc.1-1.2.2.1.2.1.1"><a class="xref" href="#section-2.1.1">2.1.1</a>.  <a class="xref" href="#name-client">Client</a><a class="pilcrow" href="#section-toc.1-1.2.2.1.2.1.1">¶</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.2.2.1.2.2">
                    <p id="section-toc.1-1.2.2.1.2.2.1"><a class="xref" href="#section-2.1.2">2.1.2</a>.  <a class="xref" href="#name-certificate-authority">Certificate Authority</a><a class="pilcrow" href="#section-toc.1-1.2.2.1.2.2.1">¶</a></p>
</li>
                </ul>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a class="xref" href="#section-2.2">2.2</a>.  <a class="xref" href="#name-ca-certificate-distribution">CA Certificate Distribution</a><a class="pilcrow" href="#section-toc.1-1.2.2.2.1">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a class="xref" href="#section-2.3">2.3</a>.  <a class="xref" href="#name-client-authentication">Client Authentication</a><a class="pilcrow" href="#section-toc.1-1.2.2.3.1">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.2.2.4">
                <p id="section-toc.1-1.2.2.4.1"><a class="xref" href="#section-2.4">2.4</a>.  <a class="xref" href="#name-enrolment-authorisation">Enrolment Authorisation</a><a class="pilcrow" href="#section-toc.1-1.2.2.4.1">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.2.2.5">
                <p id="section-toc.1-1.2.2.5.1"><a class="xref" href="#section-2.5">2.5</a>.  <a class="xref" href="#name-certificate-enrolment-renew">Certificate Enrolment/Renewal</a><a class="pilcrow" href="#section-toc.1-1.2.2.5.1">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.2.2.5.2.1">
                    <p id="section-toc.1-1.2.2.5.2.1.1"><a class="xref" href="#section-2.5.1">2.5.1</a>.  <a class="xref" href="#name-client-state-transitions">Client State Transitions</a><a class="pilcrow" href="#section-toc.1-1.2.2.5.2.1.1">¶</a></p>
</li>
                </ul>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.2.2.6">
                <p id="section-toc.1-1.2.2.6.1"><a class="xref" href="#section-2.6">2.6</a>.  <a class="xref" href="#name-certificate-access">Certificate Access</a><a class="pilcrow" href="#section-toc.1-1.2.2.6.1">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.2.2.7">
                <p id="section-toc.1-1.2.2.7.1"><a class="xref" href="#section-2.7">2.7</a>.  <a class="xref" href="#name-crl-access">CRL Access</a><a class="pilcrow" href="#section-toc.1-1.2.2.7.1">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.2.2.8">
                <p id="section-toc.1-1.2.2.8.1"><a class="xref" href="#section-2.8">2.8</a>.  <a class="xref" href="#name-certificate-revocation">Certificate Revocation</a><a class="pilcrow" href="#section-toc.1-1.2.2.8.1">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.2.2.9">
                <p id="section-toc.1-1.2.2.9.1"><a class="xref" href="#section-2.9">2.9</a>.  <a class="xref" href="#name-mandatory-to-implement-func">Mandatory-to-Implement Functionality</a><a class="pilcrow" href="#section-toc.1-1.2.2.9.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a class="xref" href="#section-3">3</a>.  <a class="xref" href="#name-scep-secure-message-objects">SCEP Secure Message Objects</a><a class="pilcrow" href="#section-toc.1-1.3.1">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a class="xref" href="#section-3.1">3.1</a>.  <a class="xref" href="#name-scep-message-object-process">SCEP Message Object Processing</a><a class="pilcrow" href="#section-toc.1-1.3.2.1.1">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a class="xref" href="#section-3.2">3.2</a>.  <a class="xref" href="#name-scep-pkimessage">SCEP pkiMessage</a><a class="pilcrow" href="#section-toc.1-1.3.2.2.1">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.3.2.2.2.1">
                    <p id="section-toc.1-1.3.2.2.2.1.1"><a class="xref" href="#section-3.2.1">3.2.1</a>.  <a class="xref" href="#name-signed-transaction-attribut">Signed Transaction Attributes</a><a class="pilcrow" href="#section-toc.1-1.3.2.2.2.1.1">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.3.2.2.2.1.2.1">
                        <p id="section-toc.1-1.3.2.2.2.1.2.1.1"><a class="xref" href="#section-3.2.1.1">3.2.1.1</a>.  <a class="xref" href="#name-transactionid">transactionID</a><a class="pilcrow" href="#section-toc.1-1.3.2.2.2.1.2.1.1">¶</a></p>
</li>
                      <li class="toc ulEmpty compact" id="section-toc.1-1.3.2.2.2.1.2.2">
                        <p id="section-toc.1-1.3.2.2.2.1.2.2.1"><a class="xref" href="#section-3.2.1.2">3.2.1.2</a>.  <a class="xref" href="#name-messagetype">messageType</a><a class="pilcrow" href="#section-toc.1-1.3.2.2.2.1.2.2.1">¶</a></p>
</li>
                      <li class="toc ulEmpty compact" id="section-toc.1-1.3.2.2.2.1.2.3">
                        <p id="section-toc.1-1.3.2.2.2.1.2.3.1"><a class="xref" href="#section-3.2.1.3">3.2.1.3</a>.  <a class="xref" href="#name-pkistatus">pkiStatus</a><a class="pilcrow" href="#section-toc.1-1.3.2.2.2.1.2.3.1">¶</a></p>
</li>
                      <li class="toc ulEmpty compact" id="section-toc.1-1.3.2.2.2.1.2.4">
                        <p id="section-toc.1-1.3.2.2.2.1.2.4.1"><a class="xref" href="#section-3.2.1.4">3.2.1.4</a>.  <a class="xref" href="#name-failinfo-and-failinfotext">failInfo and failInfoText</a><a class="pilcrow" href="#section-toc.1-1.3.2.2.2.1.2.4.1">¶</a></p>
</li>
                      <li class="toc ulEmpty compact" id="section-toc.1-1.3.2.2.2.1.2.5">
                        <p id="section-toc.1-1.3.2.2.2.1.2.5.1"><a class="xref" href="#section-3.2.1.5">3.2.1.5</a>.  <a class="xref" href="#name-sendernonce-and-recipientno">senderNonce and recipientNonce</a><a class="pilcrow" href="#section-toc.1-1.3.2.2.2.1.2.5.1">¶</a></p>
</li>
                    </ul>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.3.2.2.2.2">
                    <p id="section-toc.1-1.3.2.2.2.2.1"><a class="xref" href="#section-3.2.2">3.2.2</a>.  <a class="xref" href="#name-scep-pkcspkienvelope">SCEP pkcsPKIEnvelope</a><a class="pilcrow" href="#section-toc.1-1.3.2.2.2.2.1">¶</a></p>
</li>
                </ul>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a class="xref" href="#section-3.3">3.3</a>.  <a class="xref" href="#name-scep-pkimessage-types">SCEP pkiMessage types</a><a class="pilcrow" href="#section-toc.1-1.3.2.3.1">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.3.2.3.2.1">
                    <p id="section-toc.1-1.3.2.3.2.1.1"><a class="xref" href="#section-3.3.1">3.3.1</a>.  <a class="xref" href="#name-pkcsreq-renewalreq">PKCSReq/RenewalReq</a><a class="pilcrow" href="#section-toc.1-1.3.2.3.2.1.1">¶</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.3.2.3.2.2">
                    <p id="section-toc.1-1.3.2.3.2.2.1"><a class="xref" href="#section-3.3.2">3.3.2</a>.  <a class="xref" href="#name-certrep">CertRep</a><a class="pilcrow" href="#section-toc.1-1.3.2.3.2.2.1">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.3.2.3.2.2.2.1">
                        <p id="section-toc.1-1.3.2.3.2.2.2.1.1"><a class="xref" href="#section-3.3.2.1">3.3.2.1</a>.  <a class="xref" href="#name-certrep-success">CertRep SUCCESS</a><a class="pilcrow" href="#section-toc.1-1.3.2.3.2.2.2.1.1">¶</a></p>
</li>
                      <li class="toc ulEmpty compact" id="section-toc.1-1.3.2.3.2.2.2.2">
                        <p id="section-toc.1-1.3.2.3.2.2.2.2.1"><a class="xref" href="#section-3.3.2.2">3.3.2.2</a>.  <a class="xref" href="#name-certrep-failure">CertRep FAILURE</a><a class="pilcrow" href="#section-toc.1-1.3.2.3.2.2.2.2.1">¶</a></p>
</li>
                      <li class="toc ulEmpty compact" id="section-toc.1-1.3.2.3.2.2.2.3">
                        <p id="section-toc.1-1.3.2.3.2.2.2.3.1"><a class="xref" href="#section-3.3.2.3">3.3.2.3</a>.  <a class="xref" href="#name-certrep-pending">CertRep PENDING</a><a class="pilcrow" href="#section-toc.1-1.3.2.3.2.2.2.3.1">¶</a></p>
</li>
                    </ul>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.3.2.3.2.3">
                    <p id="section-toc.1-1.3.2.3.2.3.1"><a class="xref" href="#section-3.3.3">3.3.3</a>.  <a class="xref" href="#name-certpoll-getcertinitial">CertPoll (GetCertInitial)</a><a class="pilcrow" href="#section-toc.1-1.3.2.3.2.3.1">¶</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.3.2.3.2.4">
                    <p id="section-toc.1-1.3.2.3.2.4.1"><a class="xref" href="#section-3.3.4">3.3.4</a>.  <a class="xref" href="#name-getcert-and-getcrl">GetCert and GetCRL</a><a class="pilcrow" href="#section-toc.1-1.3.2.3.2.4.1">¶</a></p>
</li>
                </ul>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a class="xref" href="#section-3.4">3.4</a>.  <a class="xref" href="#name-degenerate-certificates-onl">Degenerate certificates-only CMS SignedData</a><a class="pilcrow" href="#section-toc.1-1.3.2.4.1">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a class="xref" href="#section-3.5">3.5</a>.  <a class="xref" href="#name-ca-capabilities">CA Capabilities</a><a class="pilcrow" href="#section-toc.1-1.3.2.5.1">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.3.2.5.2.1">
                    <p id="section-toc.1-1.3.2.5.2.1.1"><a class="xref" href="#section-3.5.1">3.5.1</a>.  <a class="xref" href="#name-getcacaps-http-message-form">GetCACaps HTTP Message Format</a><a class="pilcrow" href="#section-toc.1-1.3.2.5.2.1.1">¶</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.3.2.5.2.2">
                    <p id="section-toc.1-1.3.2.5.2.2.1"><a class="xref" href="#section-3.5.2">3.5.2</a>.  <a class="xref" href="#name-ca-capabilities-response-fo">CA Capabilities Response Format</a><a class="pilcrow" href="#section-toc.1-1.3.2.5.2.2.1">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a class="xref" href="#section-4">4</a>.  <a class="xref" href="#name-scep-transactions">SCEP Transactions</a><a class="pilcrow" href="#section-toc.1-1.4.1">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a class="xref" href="#section-4.1">4.1</a>.  <a class="xref" href="#name-http-post-and-get-message-f">HTTP POST and GET Message Formats</a><a class="pilcrow" href="#section-toc.1-1.4.2.1.1">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a class="xref" href="#section-4.2">4.2</a>.  <a class="xref" href="#name-get-ca-certificate">Get CA Certificate</a><a class="pilcrow" href="#section-toc.1-1.4.2.2.1">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a class="xref" href="#section-4.2.1">4.2.1</a>.  <a class="xref" href="#name-get-ca-certificate-response">Get CA Certificate Response Message Format</a><a class="pilcrow" href="#section-toc.1-1.4.2.2.2.1.1">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.4.2.2.2.1.2.1">
                        <p id="section-toc.1-1.4.2.2.2.1.2.1.1"><a class="xref" href="#section-4.2.1.1">4.2.1.1</a>.  <a class="xref" href="#name-ca-certificate-response-mes">CA Certificate Response Message Format</a><a class="pilcrow" href="#section-toc.1-1.4.2.2.2.1.2.1.1">¶</a></p>
</li>
                      <li class="toc ulEmpty compact" id="section-toc.1-1.4.2.2.2.1.2.2">
                        <p id="section-toc.1-1.4.2.2.2.1.2.2.1"><a class="xref" href="#section-4.2.1.2">4.2.1.2</a>.  <a class="xref" href="#name-ca-certificate-chain-respon">CA Certificate Chain Response Message Format</a><a class="pilcrow" href="#section-toc.1-1.4.2.2.2.1.2.2.1">¶</a></p>
</li>
                    </ul>
</li>
                </ul>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a class="xref" href="#section-4.3">4.3</a>.  <a class="xref" href="#name-certificate-enrolment-renewa">Certificate Enrolment/Renewal</a><a class="pilcrow" href="#section-toc.1-1.4.2.3.1">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.4.2.3.2.1">
                    <p id="section-toc.1-1.4.2.3.2.1.1"><a class="xref" href="#section-4.3.1">4.3.1</a>.  <a class="xref" href="#name-certificate-enrolment-renewal">Certificate Enrolment/Renewal Response Message</a><a class="pilcrow" href="#section-toc.1-1.4.2.3.2.1.1">¶</a></p>
</li>
                </ul>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a class="xref" href="#section-4.4">4.4</a>.  <a class="xref" href="#name-poll-for-client-initial-cer">Poll for Client Initial Certificate</a><a class="pilcrow" href="#section-toc.1-1.4.2.4.1">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.4.2.4.2.1">
                    <p id="section-toc.1-1.4.2.4.2.1.1"><a class="xref" href="#section-4.4.1">4.4.1</a>.  <a class="xref" href="#name-polling-response-message-fo">Polling Response Message Format</a><a class="pilcrow" href="#section-toc.1-1.4.2.4.2.1.1">¶</a></p>
</li>
                </ul>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a class="xref" href="#section-4.5">4.5</a>.  <a class="xref" href="#name-certificate-access-2">Certificate Access</a><a class="pilcrow" href="#section-toc.1-1.4.2.5.1">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.4.2.5.2.1">
                    <p id="section-toc.1-1.4.2.5.2.1.1"><a class="xref" href="#section-4.5.1">4.5.1</a>.  <a class="xref" href="#name-certificate-access-response">Certificate Access Response Message Format</a><a class="pilcrow" href="#section-toc.1-1.4.2.5.2.1.1">¶</a></p>
</li>
                </ul>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.4.2.6">
                <p id="section-toc.1-1.4.2.6.1"><a class="xref" href="#section-4.6">4.6</a>.  <a class="xref" href="#name-crl-access-2">CRL Access</a><a class="pilcrow" href="#section-toc.1-1.4.2.6.1">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.4.2.6.2.1">
                    <p id="section-toc.1-1.4.2.6.2.1.1"><a class="xref" href="#section-4.6.1">4.6.1</a>.  <a class="xref" href="#name-crl-access-response-message">CRL Access Response Message Format</a><a class="pilcrow" href="#section-toc.1-1.4.2.6.2.1.1">¶</a></p>
</li>
                </ul>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.4.2.7">
                <p id="section-toc.1-1.4.2.7.1"><a class="xref" href="#section-4.7">4.7</a>.  <a class="xref" href="#name-get-next-certificate-author">Get Next Certificate Authority Certificate</a><a class="pilcrow" href="#section-toc.1-1.4.2.7.1">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.4.2.7.2.1">
                    <p id="section-toc.1-1.4.2.7.2.1.1"><a class="xref" href="#section-4.7.1">4.7.1</a>.  <a class="xref" href="#name-get-next-ca-response-messag">Get Next CA Response Message Format</a><a class="pilcrow" href="#section-toc.1-1.4.2.7.2.1.1">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a class="xref" href="#section-5">5</a>.  <a class="xref" href="#name-scep-transaction-examples">SCEP Transaction Examples</a><a class="pilcrow" href="#section-toc.1-1.5.1">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a class="xref" href="#section-5.1">5.1</a>.  <a class="xref" href="#name-successful-transactions">Successful Transactions</a><a class="pilcrow" href="#section-toc.1-1.5.2.1.1">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a class="xref" href="#section-5.2">5.2</a>.  <a class="xref" href="#name-transactions-with-errors">Transactions with Errors</a><a class="pilcrow" href="#section-toc.1-1.5.2.2.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a class="xref" href="#section-6">6</a>.  <a class="xref" href="#name-iana-considerations">IANA Considerations</a><a class="pilcrow" href="#section-toc.1-1.6.1">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a class="xref" href="#section-6.1">6.1</a>.  <a class="xref" href="#name-registration-of-the-applica">Registration of the application/x-x509-ca-cert Media Type</a><a class="pilcrow" href="#section-toc.1-1.6.2.1.1">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a class="xref" href="#section-6.2">6.2</a>.  <a class="xref" href="#name-registration-of-the-applicat">Registration of the application/x-x509-ca-ra-cert Media Type</a><a class="pilcrow" href="#section-toc.1-1.6.2.2.1">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a class="xref" href="#section-6.3">6.3</a>.  <a class="xref" href="#name-registration-of-the-applicati">Registration of the application/x-x509-next-ca-cert Media Type</a><a class="pilcrow" href="#section-toc.1-1.6.2.3.1">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a class="xref" href="#section-6.4">6.4</a>.  <a class="xref" href="#name-registration-of-the-applicatio">Registration of the application/x-pki-message Media Type</a><a class="pilcrow" href="#section-toc.1-1.6.2.4.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a class="xref" href="#section-7">7</a>.  <a class="xref" href="#name-security-considerations">Security Considerations</a><a class="pilcrow" href="#section-toc.1-1.7.1">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a class="xref" href="#section-7.1">7.1</a>.  <a class="xref" href="#name-general-security">General Security</a><a class="pilcrow" href="#section-toc.1-1.7.2.1.1">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a class="xref" href="#section-7.2">7.2</a>.  <a class="xref" href="#name-use-of-the-ca-private-key">Use of the CA Private Key</a><a class="pilcrow" href="#section-toc.1-1.7.2.2.1">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a class="xref" href="#section-7.3">7.3</a>.  <a class="xref" href="#name-challengepassword-shared-se">ChallengePassword Shared Secret Value</a><a class="pilcrow" href="#section-toc.1-1.7.2.3.1">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a class="xref" href="#section-7.4">7.4</a>.  <a class="xref" href="#name-lack-of-certificate-issue-c">Lack of Certificate Issue Confirmation</a><a class="pilcrow" href="#section-toc.1-1.7.2.4.1">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.7.2.5">
                <p id="section-toc.1-1.7.2.5.1"><a class="xref" href="#section-7.5">7.5</a>.  <a class="xref" href="#name-getcacaps-issues">GetCACaps Issues</a><a class="pilcrow" href="#section-toc.1-1.7.2.5.1">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.7.2.6">
                <p id="section-toc.1-1.7.2.6.1"><a class="xref" href="#section-7.6">7.6</a>.  <a class="xref" href="#name-lack-of-pop-in-renewal-requ">Lack of PoP in Renewal Requests</a><a class="pilcrow" href="#section-toc.1-1.7.2.6.1">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.7.2.7">
                <p id="section-toc.1-1.7.2.7.1"><a class="xref" href="#section-7.7">7.7</a>.  <a class="xref" href="#name-traffic-monitoring">Traffic Monitoring</a><a class="pilcrow" href="#section-toc.1-1.7.2.7.1">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.7.2.8">
                <p id="section-toc.1-1.7.2.8.1"><a class="xref" href="#section-7.8">7.8</a>.  <a class="xref" href="#name-unnecessary-cryptography">Unnecessary Cryptography</a><a class="pilcrow" href="#section-toc.1-1.7.2.8.1">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.7.2.9">
                <p id="section-toc.1-1.7.2.9.1"><a class="xref" href="#section-7.9">7.9</a>.  <a class="xref" href="#name-use-of-sha-1">Use of SHA-1</a><a class="pilcrow" href="#section-toc.1-1.7.2.9.1">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.7.2.10">
                <p id="section-toc.1-1.7.2.10.1"><a class="xref" href="#section-7.10">7.10</a>. <a class="xref" href="#name-use-of-http">Use of HTTP</a><a class="pilcrow" href="#section-toc.1-1.7.2.10.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a class="xref" href="#section-8">8</a>.  <a class="xref" href="#name-references">References</a><a class="pilcrow" href="#section-toc.1-1.8.1">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a class="xref" href="#section-8.1">8.1</a>.  <a class="xref" href="#name-normative-references">Normative References</a><a class="pilcrow" href="#section-toc.1-1.8.2.1.1">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a class="xref" href="#section-8.2">8.2</a>.  <a class="xref" href="#name-informative-references">Informative References</a><a class="pilcrow" href="#section-toc.1-1.8.2.2.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a class="xref" href="#section-appendix.a">Appendix A</a>.  <a class="xref" href="#name-background-notes">Background Notes</a><a class="pilcrow" href="#section-toc.1-1.9.1">¶</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a class="xref" href="#section-appendix.b"></a><a class="xref" href="#name-acknowledgements">Acknowledgements</a><a class="pilcrow" href="#section-toc.1-1.10.1">¶</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a class="xref" href="#section-appendix.c"></a><a class="xref" href="#name-authors-address">Author's Address</a><a class="pilcrow" href="#section-toc.1-1.11.1">¶</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a class="section-number selfRef" href="#section-1">1. </a><a class="section-name selfRef" href="#name-introduction">Introduction</a>
      </h2>
<p id="section-1-1">

X.509 certificates serve as the basis for several standardised security
protocols such as <span><a class="xref" href="#RFC8446">TLS</a> [<a class="xref" href="#RFC8446">RFC8446</a>]</span>, <span><a class="xref" href="#RFC8551">S/MIME</a> [<a class="xref" href="#RFC8551">RFC8551</a>]</span>, and <span><a class="xref" href="#RFC7296">IKE/IPsec</a> [<a class="xref" href="#RFC7296">RFC7296</a>]</span>.  When an X.509
certificate is issued, there typically is a need for a certificate management
protocol to enable a PKI client to request or renew a certificate from a
Certificate Authority (CA).  This specification defines a protocol, the Simple
Certificate Enrolment Protocol (SCEP), for certificate management and
certificate and CRL queries.<a class="pilcrow" href="#section-1-1">¶</a></p>
<p id="section-1-2">

The SCEP protocol supports the following general operations:<a class="pilcrow" href="#section-1-2">¶</a></p>
<ul class="compact">
<li class="compact" id="section-1-3.1">CA public key distribution<a class="pilcrow" href="#section-1-3.1">¶</a>
</li>
        <li class="compact" id="section-1-3.2">Certificate enrolment and issue<a class="pilcrow" href="#section-1-3.2">¶</a>
</li>
        <li class="compact" id="section-1-3.3">Certificate renewal<a class="pilcrow" href="#section-1-3.3">¶</a>
</li>
        <li class="compact" id="section-1-3.4">Certificate query<a class="pilcrow" href="#section-1-3.4">¶</a>
</li>
        <li class="compact" id="section-1-3.5">CRL query<a class="pilcrow" href="#section-1-3.5">¶</a>
</li>
      </ul>
<p id="section-1-4">

SCEP makes extensive use of <span><a class="xref" href="#RFC5652">CMS</a> [<a class="xref" href="#RFC5652">RFC5652</a>]</span>
and <span><a class="xref" href="#RFC2986">PKCS #10</a> [<a class="xref" href="#RFC2986">RFC2986</a>]</span>.<a class="pilcrow" href="#section-1-4">¶</a></p>
<div id="mustshouldmay">
<section id="section-1.1">
        <h3 id="name-conventions-used-in-this-do">
<a class="section-number selfRef" href="#section-1.1">1.1. </a><a class="section-name selfRef" href="#name-conventions-used-in-this-do">Conventions Used in This Document</a>
        </h3>
<p id="section-1.1-1">
   The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>",
   "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>",
   "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
   "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document
   are to be interpreted as
   described in BCP 14 <span>[<a class="xref" href="#RFC2119">RFC2119</a>]</span> <span>[<a class="xref" href="#RFC8174">RFC8174</a>]</span> 
   when, and only when, they appear in all capitals, as shown here.<a class="pilcrow" href="#section-1.1-1">¶</a></p>
<p id="section-1.1-2">This document uses the Augmented Backus-Naur Form (ABNF) notation
        as specified in <span>[<a class="xref" href="#RFC5234">RFC5234</a>]</span> for defining formal syntax of
 commands.  Non-terminals not defined in <span>[<a class="xref" href="#RFC5234">RFC5234</a>]</span> are
 defined in <a class="xref" href="#HTTP-GET-POST">Section 4.1</a>.<a class="pilcrow" href="#section-1.1-2">¶</a></p>
</section>
</div>
</section>
</div>
<div id="overview">
<section id="section-2">
      <h2 id="name-scep-overview">
<a class="section-number selfRef" href="#section-2">2. </a><a class="section-name selfRef" href="#name-scep-overview">SCEP Overview</a>
      </h2>
<p id="section-2-1">

This section provides an overview of the functionality of SCEP.<a class="pilcrow" href="#section-2-1">¶</a></p>
<div id="overview-entities">
<section id="section-2.1">
        <h3 id="name-scep-entities">
<a class="section-number selfRef" href="#section-2.1">2.1. </a><a class="section-name selfRef" href="#name-scep-entities">SCEP Entities</a>
        </h3>
<p id="section-2.1-1">

The entity types defined in SCEP are a client requesting a certificate and a
Certificate Authority (CA) that issues the certificate.  These are described
in the following sections.<a class="pilcrow" href="#section-2.1-1">¶</a></p>
<div id="overview-client">
<section id="section-2.1.1">
          <h4 id="name-client">
<a class="section-number selfRef" href="#section-2.1.1">2.1.1. </a><a class="section-name selfRef" href="#name-client">Client</a>
          </h4>
<p id="section-2.1.1-1">

A client <span class="bcp14">MUST</span> have the following information locally configured:<a class="pilcrow" href="#section-2.1.1-1">¶</a></p>
<ol class="normal type-1" id="section-2.1.1-2" start="1" type="1">
            <li id="section-2.1.1-2.1">The CA's fully qualified domain name or IP address.<a class="pilcrow" href="#section-2.1.1-2.1">¶</a>
</li>
            <li id="section-2.1.1-2.2">Any identification and/or authorisation information required by
 the CA before a certificate will be issued, as described in
 <a class="xref" href="#PKCSReq">Section 3.3.1</a>.<a class="pilcrow" href="#section-2.1.1-2.2">¶</a>
</li>
            <li id="section-2.1.1-2.3">The identifying information that is used for authentication of
 the CA in <a class="xref" href="#GetCACert-resp">Section 4.2.1</a>, typically a certificate
 fingerprint.<a class="pilcrow" href="#section-2.1.1-2.3">¶</a>
</li>
          </ol>
</section>
</div>
<div id="overview-ca">
<section id="section-2.1.2">
          <h4 id="name-certificate-authority">
<a class="section-number selfRef" href="#section-2.1.2">2.1.2. </a><a class="section-name selfRef" href="#name-certificate-authority">Certificate Authority</a>
          </h4>
<p id="section-2.1.2-1">
A SCEP CA is the entity that signs client certificates.  A CA may enforce
policies and apply them to certificate requests, and it may reject a request for
any reason.<a class="pilcrow" href="#section-2.1.2-1">¶</a></p>
<p id="section-2.1.2-2">
Since the client is expected to perform signature verification and optionally
encryption using the CA certificate, the keyUsage extension in the CA
certificate <span class="bcp14">MUST</span> indicate that it is valid for digitalSignature and
keyEncipherment (if the key is to be used for en/decryption) alongside the
usual CA usages of keyCertSign and/or cRLSign.<a class="pilcrow" href="#section-2.1.2-2">¶</a></p>
</section>
</div>
</section>
</div>
<div id="overview-cert-dist">
<section id="section-2.2">
        <h3 id="name-ca-certificate-distribution">
<a class="section-number selfRef" href="#section-2.2">2.2. </a><a class="section-name selfRef" href="#name-ca-certificate-distribution">CA Certificate Distribution</a>
        </h3>
<p id="section-2.2-1">
If the CA certificate(s) have not previously been acquired by the client
through some other means, the client <span class="bcp14">MUST</span> retrieve them before any PKI
operation (<a class="xref" href="#message-obj">Section 3</a>) can be started.  Since no public key
has yet been exchanged between the client and the CA, the messages cannot be
secured using CMS, and the CA certificate request and response data is instead
transferred in the clear.<a class="pilcrow" href="#section-2.2-1">¶</a></p>
<p id="section-2.2-2">
If an intermediate CA is in use, a certificates-only CMS SignedData message
with a certificate chain consisting of all CA certificates is returned.
Otherwise, the CA certificate itself is returned.<a class="pilcrow" href="#section-2.2-2">¶</a></p>
<p id="section-2.2-3">
The CA certificate <span class="bcp14">MAY</span> be provided out of band to the client.  Alternatively,
the CA certificate fingerprint <span class="bcp14">MAY</span> be used to authenticate a CA certificate
distributed by the GetCACert response (<a class="xref" href="#GetCACert">Section 4.2</a>) or via
<span><a class="xref" href="#RFC4387">HTTP certificate-store access</a> [<a class="xref" href="#RFC4387">RFC4387</a>]</span>.  The
fingerprint is created by calculating a SHA-256 hash over the whole CA
certificate. (For legacy reasons, a SHA-1 hash may be used by some
implementations.)<a class="pilcrow" href="#section-2.2-3">¶</a></p>
<p id="section-2.2-4">

After the client gets the CA certificate, it <span class="bcp14">SHOULD</span> authenticate it in some
manner unless this is deemed unnecessary, for example, because the device is
being provisioned inside a trusted environment.  For example, the client could compare
the certificate's fingerprint with locally configured, out-of-band distributed, identifying
information, or by some equivalent means such as a direct comparison with a
locally stored copy of the certificate.<a class="pilcrow" href="#section-2.2-4">¶</a></p>
<p id="section-2.2-5">

Intermediate CA certificates, if any, are signed by a higher-level CA, so there
is no need to authenticate them against the out-of-band data.  Since
intermediate CA certificates are rolled over more frequently than long-lived
top-level CA certificates, clients <span class="bcp14">MUST</span> verify intermediate-level CA
certificates before use during protocol exchanges in case the intermediate CA
certificate has expired or otherwise been invalidated.<a class="pilcrow" href="#section-2.2-5">¶</a></p>
<p id="section-2.2-6">

When a CA certificate expires, certificates that have been signed by it may no
longer be regarded as valid.  CA key rollover provides a mechanism by which
the CA can distribute a new CA certificate that will be valid in the future once
the current certificate has expired.  This is done via the GetNextCACert
message (<a class="xref" href="#get-next-CA">Section 4.7</a>).<a class="pilcrow" href="#section-2.2-6">¶</a></p>
</section>
</div>
<div id="overview-req-auth">
<section id="section-2.3">
        <h3 id="name-client-authentication">
<a class="section-number selfRef" href="#section-2.3">2.3. </a><a class="section-name selfRef" href="#name-client-authentication">Client Authentication</a>
        </h3>
<p id="section-2.3-1">

As with every protocol that uses public-key cryptography, the association
between the public keys used in the protocol and the identities with which
they are associated must be authenticated in a cryptographically secure
manner.  Communications between the client and the CA are secured using SCEP
Secure Message Objects as explained in <a class="xref" href="#message-obj">Section 3</a>, which
specifies how CMS is used to encrypt and sign the data.  In order to perform
the signing operation, the client uses an appropriate local certificate:<a class="pilcrow" href="#section-2.3-1">¶</a></p>
<ol class="normal type-1" id="section-2.3-2" start="1" type="1">
          <li id="section-2.3-2.1">If the client does not have an appropriate existing certificate,
   then a locally generated self-signed certificate <span class="bcp14">MUST</span> be used.  The
   keyUsage extension in the certificate <span class="bcp14">MUST</span> indicate that it is valid
   for digitalSignature and keyEncipherment (if available).  The
   self-signed certificate <span class="bcp14">SHOULD</span> use the same subject name and key as
   in the PKCS #10 request.  In this case, the messageType is PKCSReq
   (see <a class="xref" href="#messageType">Section 3.2.1.2</a>).<a class="pilcrow" href="#section-2.3-2.1">¶</a>
</li>
          <li id="section-2.3-2.2">If the client already has a certificate issued by the SCEP CA, and
   the CA supports renewal (see <a class="xref" href="#overview-cert-enrol">Section 2.5</a>),
   that certificate <span class="bcp14">SHOULD</span> be used. In this case, the messageType is
   RenewalReq (see <a class="xref" href="#messageType">Section 3.2.1.2</a>).<a class="pilcrow" href="#section-2.3-2.2">¶</a>
</li>
          <li id="section-2.3-2.3">Alternatively, if the client has no certificate issued by the
   SCEP CA but has credentials from an alternate CA, then the
   certificate issued by the alternate CA <span class="bcp14">MAY</span> be used in a renewal
   request as described above.  The SCEP CA's policy will determine
   whether the request can be accepted or not.<a class="pilcrow" href="#section-2.3-2.3">¶</a>
</li>
        </ol>
<p id="section-2.3-3">
Note that although the above text describes several different types of
operations, for historical reasons, most implementations always apply the first
one, even if an existing certificate already exists.  For this reason, support
for the first case is mandatory while support for the latter ones are optional
(see <a class="xref" href="#MTI">Section 2.9</a>).<a class="pilcrow" href="#section-2.3-3">¶</a></p>
<p id="section-2.3-4">
During the certificate-enrolment process, the client <span class="bcp14">MUST</span> use
the selected certificate's key when signing the CMS envelope (see <a class="xref" href="#message-obj">Section 3</a>).  This certificate will be either the
self-signed one matching the PKCS #10 request or the CA-issued one used to
authorise a renewal, and it <span class="bcp14">MUST</span> be included in the signedData
certificates field (possibly as part of a full certificate chain).  If the key
being certified allows encryption, then the CA's CertResp will use the same
certificate's public key when encrypting the response.<a class="pilcrow" href="#section-2.3-4">¶</a></p>
<p id="section-2.3-5">
Note that, in the case of renewal operations, this means that the request will
be signed and authenticated with the key in the previously issued certificate
rather than the key in the PKCS #10 request, and the response may similarly be
returned encrypted with the key in the previously issued certificate.  This
has security implications; see <a class="xref" href="#security-no-pop">Section 7.6</a>.<a class="pilcrow" href="#section-2.3-5">¶</a></p>
</section>
</div>
<div id="overview-enrol-auth">
<section id="section-2.4">
        <h3 id="name-enrolment-authorisation">
<a class="section-number selfRef" href="#section-2.4">2.4. </a><a class="section-name selfRef" href="#name-enrolment-authorisation">Enrolment Authorisation</a>
        </h3>
<p id="section-2.4-1">

<span><a class="xref" href="#RFC2986">PKCS #10</a> [<a class="xref" href="#RFC2986">RFC2986</a>]</span> specifies a <span><a class="xref" href="#RFC2985">PKCS
#9</a> [<a class="xref" href="#RFC2985">RFC2985</a>]</span> challengePassword attribute to be sent as part of the enrolment
request.  When utilising the challengePassword, the CA distributes a shared
secret to the client, which will be used to authenticate the request from the
client.  It is <span class="bcp14">RECOMMENDED</span> that the challengePassword be a
one-time
authenticator value to limit the ability of an attacker who can capture the
authenticator from the client or CA and reuse it to request further
certificates.<a class="pilcrow" href="#section-2.4-1">¶</a></p>
<p id="section-2.4-2">

Inclusion of the challengePassword by the SCEP client is
<span class="bcp14">RECOMMENDED</span>; however,
its omission allows for unauthenticated authorisation of enrolment requests
(which may, however, require manual approval of each certificate issue if
other security measures to control issue aren't in place; see below).
Inclusion is <span class="bcp14">OPTIONAL</span> for renewal requests that are authenticated by being
signed with an existing certificate.  The CMS envelope protects the privacy of
the challengePassword.<a class="pilcrow" href="#section-2.4-2">¶</a></p>
<p id="section-2.4-3">

A client that is performing certificate renewal as per <a class="xref" href="#overview-cert-enrol">Section 2.5</a> <span class="bcp14">SHOULD</span> omit the challengePassword but <span class="bcp14">MAY</span> send
the originally distributed shared secret in the challengePassword attribute.
The SCEP CA <span class="bcp14">MAY</span> authenticate the request using the
challengePassword in addition to the previously issued certificate that signs
the request. The SCEP CA <span class="bcp14">MUST NOT</span> attempt to authenticate a
client based on a self-signed certificate unless it has been verified through
out-of-band means such as a certificate fingerprint.<a class="pilcrow" href="#section-2.4-3">¶</a></p>
<p id="section-2.4-4">

To perform the authorisation in manual mode, the client's request is placed in
the PENDING state until the CA operator authorises or rejects it.  Manual
authorisation is used when the client has only a self-signed certificate that
hasn't been previously authenticated by the CA and/or a challengePassword is
not available.  The SCEP CA <span class="bcp14">MAY</span> either reject unauthorised requests or mark
them for manual authorisation according to CA policy.<a class="pilcrow" href="#section-2.4-4">¶</a></p>
</section>
</div>
<div id="overview-cert-enrol">
<section id="section-2.5">
        <h3 id="name-certificate-enrolment-renew">
<a class="section-number selfRef" href="#section-2.5">2.5. </a><a class="section-name selfRef" href="#name-certificate-enrolment-renew">Certificate Enrolment/Renewal</a>
        </h3>
<p id="section-2.5-1">
A client starts an enrolment transaction (<a class="xref" href="#PKCSReq">Section 3.3.1</a>) by creating a
certificate request using PKCS #10 and sends the request to the CA enveloped
using CMS (<a class="xref" href="#message-obj">Section 3</a>).<a class="pilcrow" href="#section-2.5-1">¶</a></p>
<p id="section-2.5-2">

If the CA supports certificate renewal and the CA policy permits, then a new
certificate with new validity dates can be issued, even though the old one is
still valid.  To renew an existing certificate, the client uses the RenewalReq
message (see <a class="xref" href="#pkiMessage-types">Section 3.3</a>) and signs it with the existing
client certificate.  The client <span class="bcp14">SHOULD</span> use a new keypair when requesting a new
certificate but <span class="bcp14">MAY</span> request a new certificate using the old keypair.<a class="pilcrow" href="#section-2.5-2">¶</a></p>
<p id="section-2.5-3">

If the CA returns a CertRep message (<a class="xref" href="#CertRep">Section 3.3.2</a>) with status set
to PENDING, the client enters into polling mode by periodically sending a
CertPoll message (<a class="xref" href="#CertPoll">Section 3.3.3</a>) to the CA until the CA operator
completes the manual authentication (approving or denying the request). The
frequency of the polling operation is a CA/client configuration issue and may
range from seconds or minutes when the issue process is automatic but not
instantaneous, through to hours or days if the certificate-issue operation
requires manual approval.<a class="pilcrow" href="#section-2.5-3">¶</a></p>
<p id="section-2.5-4">

If polling mode is being used, then the client will send a single
PKCSReq/RenewalReq message (<a class="xref" href="#PKCSReq">Section 3.3.1</a>), followed by 0 or more
CertPoll messages (<a class="xref" href="#CertPoll">Section 3.3.3</a>).  The CA will, in return, send 0
or more CertRep messages (<a class="xref" href="#CertRep">Section 3.3.2</a>) with status set to PENDING
in response to CertPolls, followed by a single CertRep message (<a class="xref" href="#CertRep">Section 3.3.2</a>) with status set to either SUCCESS or
FAILURE.<a class="pilcrow" href="#section-2.5-4">¶</a></p>
<div id="overview-client-state">
<section id="section-2.5.1">
          <h4 id="name-client-state-transitions">
<a class="section-number selfRef" href="#section-2.5.1">2.5.1. </a><a class="section-name selfRef" href="#name-client-state-transitions">Client State Transitions</a>
          </h4>
<p id="section-2.5.1-1">

The client state transitions during the SCEP process are indicated in <a class="xref" href="#state-diagram">Figure 1</a>.<a class="pilcrow" href="#section-2.5.1-1">¶</a></p>
<span id="name-state-transition-diagram"></span><div id="state-diagram">
<figure id="figure-1">
            <div class="artwork art-text alignLeft" id="section-2.5.1-2.1">
<pre>                                CertPoll
                              +-----&lt;----+
                              |          |
                              |          | CertRep(PENDING)
                              |          |
[CERT-NONEXISTENT] ------&gt; [CERT-REQ-PENDING] --------&gt; [CERT-ISSUED]
      ^            PKCSReq    |           CertRep(SUCCESS)
      |          RenewalReq   |
      |                       |
      +-----------------------+
      CertRep(FAILURE) or
      Max-time/max-polls exceeded
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-1">Figure 1</a>:
<a class="selfRef" href="#name-state-transition-diagram">State Transition Diagram</a>
            </figcaption></figure>
</div>
<p id="section-2.5.1-3">

The certificate-issue process starts at state CERT-NONEXISTENT.  Sending a
PKCSReq/RenewalReq message changes the state to CERT-REQ-PENDING.<a class="pilcrow" href="#section-2.5.1-3">¶</a></p>
<p id="section-2.5.1-4">

If the CA returns a CertRep message with pkiStatus set to SUCCESS, then the
state changes to CERT-ISSUED.<a class="pilcrow" href="#section-2.5.1-4">¶</a></p>
<p id="section-2.5.1-5">

If the CA returns a CertRep message with pkiStatus set to FAILURE or there is
no response, then the state reverts back to CERT-NONEXISTENT.<a class="pilcrow" href="#section-2.5.1-5">¶</a></p>
<p id="section-2.5.1-6">

If the CA returns a CertRep message with pkiStatus set to PENDING, then the
client will keep polling by sending a CertPoll message until either a CertRep
message with status set to SUCCESS or FAILURE is received, a timeout occurs,
or the maximum number of polls has been exceeded.<a class="pilcrow" href="#section-2.5.1-6">¶</a></p>
<p id="section-2.5.1-7"><a class="xref" href="#automatic">Figure 2</a> shows a successful transaction in
   automatic mode<a class="pilcrow" href="#section-2.5.1-7">¶</a></p>
<span id="name-automatic-mode"></span><div id="automatic">
<figure id="figure-2">
            <div class="artwork art-text alignLeft" id="section-2.5.1-8.1">
<pre>    CLIENT                              CA SERVER

PKCSReq: PKI cert. enrolment message
--------------------------------&gt; CertRep: pkiStatus = SUCCESS
                                  Certificate attached
                                  &lt;------------------------------
Receive issued certificate.
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-2">Figure 2</a>:
<a class="selfRef" href="#name-automatic-mode">Automatic Mode</a>
            </figcaption></figure>
</div>
<p id="section-2.5.1-9"><a class="xref" href="#manual">Figure 3</a> shows a successful transaction in manual
   mode:<a class="pilcrow" href="#section-2.5.1-9">¶</a></p>
<span id="name-manual-mode"></span><div id="manual">
<figure id="figure-3">
            <div class="artwork art-text alignLeft" id="section-2.5.1-10.1">
<pre>    CLIENT                              CA SERVER

PKCSReq: PKI cert. enrolment message
--------------------------------&gt; CertRep: pkiStatus = PENDING
                                  &lt;------------------------------
CertPoll: Polling message
--------------------------------&gt; CertRep: pkiStatus = PENDING
                                  &lt;------------------------------
................ &lt;Manual identity authentication&gt; ...............

CertPoll: Polling message
--------------------------------&gt; CertRep: pkiStatus = SUCCESS
                                  Certificate attached
                                  &lt;------------------------------
Receive issued certificate.
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-3">Figure 3</a>:
<a class="selfRef" href="#name-manual-mode">Manual Mode</a>
            </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="overview-cert-access">
<section id="section-2.6">
        <h3 id="name-certificate-access">
<a class="section-number selfRef" href="#section-2.6">2.6. </a><a class="section-name selfRef" href="#name-certificate-access">Certificate Access</a>
        </h3>
<p id="section-2.6-1">

A certificate query message is defined for clients to retrieve a copy of their
own certificate from the CA.  It allows clients that do not store their
certificates locally to obtain a copy when needed.  This functionality is not
intended to provide a general-purpose certificate-access service, which may be
achieved instead via <span><a class="xref" href="#RFC4387">HTTP certificate-store
access</a> [<a class="xref" href="#RFC4387">RFC4387</a>]</span> or Lightweight Directory Access Protocol (LDAP).<a class="pilcrow" href="#section-2.6-1">¶</a></p>
<p id="section-2.6-2">

To retrieve a certificate from the CA, a client sends a request consisting of
the certificate's issuer name and serial number.  This assumes that the client
has saved the issuer name and the serial number of the issued certificate from
the previous enrolment transaction.  The transaction to retrieve a certificate
consists of one GetCert (<a class="xref" href="#GetCertCRL">Section 3.3.4</a>) message and one CertRep
(<a class="xref" href="#CertRep">Section 3.3.2</a>) message, as shown in <a class="xref" href="#retrieve">Figure 4</a>.<a class="pilcrow" href="#section-2.6-2">¶</a></p>
<span id="name-retrieving-a-certificate"></span><div id="retrieve">
<figure id="figure-4">
          <div class="artwork art-text alignLeft" id="section-2.6-3.1">
<pre>   CLIENT                               CA SERVER

GetCert: PKI certificate query message
-------------------------------&gt; CertRep: pkiStatus = SUCCESS
                                 Certificate attached
                                 &lt;-----------------------------
Receive the certificate.
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-4">Figure 4</a>:
<a class="selfRef" href="#name-retrieving-a-certificate">Retrieving a Certificate</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="overview-CRL-access">
<section id="section-2.7">
        <h3 id="name-crl-access">
<a class="section-number selfRef" href="#section-2.7">2.7. </a><a class="section-name selfRef" href="#name-crl-access">CRL Access</a>
        </h3>
<p id="section-2.7-1">

SCEP clients <span class="bcp14">MAY</span> request a CRL via one of three methods:<a class="pilcrow" href="#section-2.7-1">¶</a></p>
<ol class="normal type-1" id="section-2.7-2" start="1" type="1">
          <li id="section-2.7-2.1">If the CA supports the <span><a class="xref" href="#RFC5280">CRL Distribution
   Points (CRLDPs) extension</a> [<a class="xref" href="#RFC5280">RFC5280</a>]</span> in issued certificates, then the
   CRL <span class="bcp14">MAY</span> be retrieved via the mechanism specified in the CRLDP.<a class="pilcrow" href="#section-2.7-2.1">¶</a>
</li>
          <li id="section-2.7-2.2">If the CA supports <span><a class="xref" href="#RFC4387">HTTP
   certificate-store access</a> [<a class="xref" href="#RFC4387">RFC4387</a>]</span>, then the CRL <span class="bcp14">MAY</span> be retrieved via
   the <span><a class="xref" href="#RFC5280">AuthorityInfoAcces</a> [<a class="xref" href="#RFC5280">RFC5280</a>]</span> location specified
   in the certificate.<a class="pilcrow" href="#section-2.7-2.2">¶</a>
</li>
          <li id="section-2.7-2.3">Only if the CA does not support CRLDPs or HTTP access should a
   CRL query be composed by creating a GetCRL message consisting of the
   issuer name and serial number from the certificate whose revocation
   status is being queried.<a class="pilcrow" href="#section-2.7-2.3">¶</a>
</li>
        </ol>
<p id="section-2.7-3">

The message is sent to the SCEP CA in the same way as the other SCEP requests.
The transaction to retrieve a CRL consists of one GetCRL PKI message and one
CertRep PKI message, which contains only the CRL (no certificates) in a
degenerate certificates-only CMS SignedData message
(<a class="xref" href="#certs-only">Section 3.4</a>), as shown in <a class="xref" href="#retrieve-CRL">Figure 5</a>.<a class="pilcrow" href="#section-2.7-3">¶</a></p>
<span id="name-retrieving-a-crl"></span><div id="retrieve-CRL">
<figure id="figure-5">
          <div class="artwork art-text alignLeft" id="section-2.7-4.1">
<pre>       CLIENT                           CA SERVER

   GetCRL: PKI CRL query message
----------------------------------&gt;
                                  CertRep: CRL attached
                                  &lt;-----------------------------
Receive the CRL
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-5">Figure 5</a>:
<a class="selfRef" href="#name-retrieving-a-crl">Retrieving a CRL</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="overview-cert-rev">
<section id="section-2.8">
        <h3 id="name-certificate-revocation">
<a class="section-number selfRef" href="#section-2.8">2.8. </a><a class="section-name selfRef" href="#name-certificate-revocation">Certificate Revocation</a>
        </h3>
<p id="section-2.8-1">

SCEP does not specify a method to request certificate revocation.  In order to
revoke a certificate, the client must contact the CA using a non-SCEP-defined mechanism.<a class="pilcrow" href="#section-2.8-1">¶</a></p>
</section>
</div>
<div id="MTI">
<section id="section-2.9">
        <h3 id="name-mandatory-to-implement-func">
<a class="section-number selfRef" href="#section-2.9">2.9. </a><a class="section-name selfRef" href="#name-mandatory-to-implement-func">Mandatory-to-Implement Functionality</a>
        </h3>
<p id="section-2.9-1">

At a minimum, all SCEP implementations compliant with this specification <span class="bcp14">MUST</span>
support <span><a class="xref" href="#CA-caps-HTTP">GetCACaps</a> (<a class="xref" href="#CA-caps-HTTP">Section 3.5.1</a>)</span>,
<span><a class="xref" href="#GetCACert">GetCACert</a> (<a class="xref" href="#GetCACert">Section 4.2</a>)</span>,
<span><a class="xref" href="#PKCSReq">PKCSReq</a> (<a class="xref" href="#PKCSReq">Section 3.3.1</a>)</span> (and its associated response messages),
communication of binary data via <span><a class="xref" href="#HTTP-GET-POST">HTTP
POST</a> (<a class="xref" href="#HTTP-GET-POST">Section 4.1</a>)</span>, and the <span><a class="xref" href="#AES">AES128-CBC</a> [<a class="xref" href="#AES">AES</a>]</span> and
<span><a class="xref" href="#SHA2">SHA-256</a> [<a class="xref" href="#SHA2">SHA2</a>]</span> algorithms to secure
<span><a class="xref" href="#pkiMessage">pkiMessages</a> (<a class="xref" href="#pkiMessage">Section 3.2</a>)</span>.<a class="pilcrow" href="#section-2.9-1">¶</a></p>
<p id="section-2.9-2">

For historical reasons, implementations <span class="bcp14">MAY</span> support communications of binary
data via <span><a class="xref" href="#HTTP-GET-POST">HTTP GET</a> (<a class="xref" href="#HTTP-GET-POST">Section 4.1</a>)</span>, and the triple DES-CBC
and SHA-1 algorithms to secure <span><a class="xref" href="#pkiMessage">pkiMessages</a> (<a class="xref" href="#pkiMessage">Section 3.2</a>)</span>.
Implementations <span class="bcp14">MUST NOT</span> support the obsolete and/or insecure single DES and
MD5 algorithms used in earlier versions of this specification, since the
unsecured nature of GetCACaps means that an in-path attacker can trivially
roll back the encryption used to these insecure algorithms; see <a class="xref" href="#security-getcacaps">Section 7.5</a>.<a class="pilcrow" href="#section-2.9-2">¶</a></p>
</section>
</div>
</section>
</div>
<div id="message-obj">
<section id="section-3">
      <h2 id="name-scep-secure-message-objects">
<a class="section-number selfRef" href="#section-3">3. </a><a class="section-name selfRef" href="#name-scep-secure-message-objects">SCEP Secure Message Objects</a>
      </h2>
<p id="section-3-1">

CMS is a general enveloping mechanism that enables both signed and encrypted
transmission of arbitrary data.  SCEP messages that require confidentiality
use two layers of CMS, as shown using ASN.1-like pseudocode in
<a class="xref" href="#cms-layering">Figure 6</a>.  By applying both enveloping and signing
transformations, the SCEP message is protected both for the integrity of its
end-to-end transaction information and the confidentiality of its information
portion.<a class="pilcrow" href="#section-3-1">¶</a></p>
<span id="name-cms-layering"></span><div id="cms-layering">
<figure id="figure-6">
        <div id="section-3-2.1">
<pre class="sourcecode lang-pseudocode">pkiMessage {
  contentType = signedData { pkcs-7 2 },
  content {
    digestAlgorithms,
    encapsulatedContentInfo {
      eContentType = data { pkcs-7 1 },
      eContent {           -- pkcsPKIEnvelope, optional
        contentType = envelopedData { pkcs-7 3 },
        content {
          recipientInfo,
          encryptedContentInfo {
            contentType = data { pkcs-7 1 },
            contentEncrAlgorithm,
            encryptedContent {
              messageData  -- Typically PKCS #10 request
              }
            }
          }
        }
      },
    certificates,          -- Optional
    crls,                  -- Optional
    signerInfo {
      signedAttrs {
        transactionID,
        messageType,
        pkiStatus,
        failInfo,          -- Optional
        senderNonce / recipientNonce,
        },
      signature
      }
    }
  }
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-6">Figure 6</a>:
<a class="selfRef" href="#name-cms-layering">CMS Layering</a>
        </figcaption></figure>
</div>
<p id="section-3-3">

When a particular SCEP message carries data, this data is carried in the
messageData.  CertRep messages will lack any signed content and consist only
of a pkcsPKIEnvelope (<a class="xref" href="#pkcsPKIEnvelope">Section 3.2.2</a>).<a class="pilcrow" href="#section-3-3">¶</a></p>
<p id="section-3-4">

The remainder of this document will refer only to "messageData", but it is
understood to always be encapsulated in the pkcsPKIEnvelope (<a class="xref" href="#pkcsPKIEnvelope">Section 3.2.2</a>).  The format of the data in the messageData is
defined by the messageType attribute (see <a class="xref" href="#pkiMessage">Section 3.2</a>) of the
SignedData.  If there is no messageData to be transmitted, the entire
pkcsPKIEnvelope <span class="bcp14">MUST</span> be omitted.<a class="pilcrow" href="#section-3-4">¶</a></p>
<p id="section-3-5">

Samples of SCEP messages are available through the
<span><a class="xref" href="#JSCEP">JSCEP project</a> [<a class="xref" href="#JSCEP">JSCEP</a>]</span> in the src/samples directory.<a class="pilcrow" href="#section-3-5">¶</a></p>
<div id="message-processing">
<section id="section-3.1">
        <h3 id="name-scep-message-object-process">
<a class="section-number selfRef" href="#section-3.1">3.1. </a><a class="section-name selfRef" href="#name-scep-message-object-process">SCEP Message Object Processing</a>
        </h3>
<p id="section-3.1-1">

Creating a SCEP message consists of several stages.  The content to be
conveyed (in other words, the messageData) is first encrypted, and the
encrypted content is then signed.<a class="pilcrow" href="#section-3.1-1">¶</a></p>
<p id="section-3.1-2">

The form of encryption to be applied depends on the capabilities of the
recipient's public key.  If the key is encryption capable (for example, RSA),
then the messageData is encrypted using the recipient's public key with the
CMS KeyTransRecipientInfo mechanism.  If the key is not encryption capable
(for example, DSA or ECDSA), then
the messageData is encrypted using the
challengePassword with the CMS PasswordRecipientInfo mechanism.<a class="pilcrow" href="#section-3.1-2">¶</a></p>
<p id="section-3.1-3">

Once the messageData has been encrypted, it is signed with the sender's public
key.  This completes the SCEP message, which is then sent to the recipient.<a class="pilcrow" href="#section-3.1-3">¶</a></p>
<p id="section-3.1-4">

Note that some early implementations of this specification dealt with keys
that were not encryption capable by omitting the encryption stage, based on the
text in <a class="xref" href="#message-obj">Section 3</a> that indicated that "the EnvelopedData is
omitted".  This alternative processing mechanism <span class="bcp14">SHOULD NOT</span> be used since it
exposes in cleartext the challengePassword used to authorise the certificate
issue.<a class="pilcrow" href="#section-3.1-4">¶</a></p>
<p id="section-3.1-5"></p>
</section>
</div>
<div id="pkiMessage">
<section id="section-3.2">
        <h3 id="name-scep-pkimessage">
<a class="section-number selfRef" href="#section-3.2">3.2. </a><a class="section-name selfRef" href="#name-scep-pkimessage">SCEP pkiMessage</a>
        </h3>
<p id="section-3.2-1">

The basic building block of all secured SCEP messages is the SCEP pkiMessage.
It consists of a CMS SignedData content type.  The following restrictions
apply:<a class="pilcrow" href="#section-3.2-1">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3.2-2.1">The eContentType in encapsulatedContentInfo <span class="bcp14">MUST</span> be data ({pkcs-7
      1}).<a class="pilcrow" href="#section-3.2-2.1">¶</a>
</li>
          <li class="compact" id="section-3.2-2.2">The signed content, if present (FAILURE and PENDING CertRep
  messages will lack any signed content),
  <span class="bcp14">MUST</span> be a pkcsPKIEnvelope
  (<a class="xref" href="#pkcsPKIEnvelope">Section 3.2.2</a>)
  and <span class="bcp14">MUST</span> match the
  messageType attribute.<a class="pilcrow" href="#section-3.2-2.2">¶</a>
</li>
          <li class="compact" id="section-3.2-2.3">The SignerInfo <span class="bcp14">MUST</span> contain a set of authenticatedAttributes
  (<a class="xref" href="#signed-attrs">Section 3.2.1</a>).<a class="pilcrow" href="#section-3.2-2.3">¶</a>
</li>
        </ul>
<div id="signed-attrs">
<section id="section-3.2.1">
          <h4 id="name-signed-transaction-attribut">
<a class="section-number selfRef" href="#section-3.2.1">3.2.1. </a><a class="section-name selfRef" href="#name-signed-transaction-attribut">Signed Transaction Attributes</a>
          </h4>
<p id="section-3.2.1-1">

At a minimum, all messages <span class="bcp14">MUST</span> contain the following authenticatedAttributes:<a class="pilcrow" href="#section-3.2.1-1">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3.2.1-2.1">A transactionID attribute (see <a class="xref" href="#transactionID">Section 3.2.1.1</a>).<a class="pilcrow" href="#section-3.2.1-2.1">¶</a>
</li>
            <li class="compact" id="section-3.2.1-2.2">A messageType attribute (see <a class="xref" href="#messageType">Section 3.2.1.2</a>).<a class="pilcrow" href="#section-3.2.1-2.2">¶</a>
</li>
            <li class="compact" id="section-3.2.1-2.3">A fresh senderNonce attribute (see <a class="xref" href="#nonces">Section 3.2.1.5</a>).  However, note the comment about
     senderNonces and polling in <a class="xref" href="#CertRep">Section 3.3.2</a><a class="pilcrow" href="#section-3.2.1-2.3">¶</a>
</li>
            <li class="compact" id="section-3.2.1-2.4">Any attributes required by CMS.<a class="pilcrow" href="#section-3.2.1-2.4">¶</a>
</li>
          </ul>
<p id="section-3.2.1-3">

If the message is a CertRep, it <span class="bcp14">MUST</span> also include the following
authenticatedAttributes:<a class="pilcrow" href="#section-3.2.1-3">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3.2.1-4.1">A pkiStatus attribute (see <a class="xref" href="#pkiStatus">Section 3.2.1.3</a>).<a class="pilcrow" href="#section-3.2.1-4.1">¶</a>
</li>
            <li class="compact" id="section-3.2.1-4.2">failInfo and optional failInfoText attributes (see <a class="xref" href="#failInfo">Section 3.2.1.4</a>) if pkiStatus = FAILURE.<a class="pilcrow" href="#section-3.2.1-4.2">¶</a>
</li>
            <li class="compact" id="section-3.2.1-4.3">A recipientNonce attribute (see <a class="xref" href="#nonces">Section 3.2.1.5</a>) copied
     from the senderNonce in the request that this is a response
     to.<a class="pilcrow" href="#section-3.2.1-4.3">¶</a>
</li>
          </ul>
<p id="section-3.2.1-5">

The following transaction attributes are encoded as authenticated attributes
and carried in the SignerInfo for this SignedData.<a class="pilcrow" href="#section-3.2.1-5">¶</a></p>
<span id="name-scep-attributes"></span><table class="left" id="table-1">
            <caption>
<a class="selfRef" href="#table-1">Table 1</a>:
<a class="selfRef" href="#name-scep-attributes">SCEP Attributes</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" colspan="1" rowspan="1">Attribute</th>
                <th class="text-left" colspan="1" rowspan="1">Encoding</th>
                <th class="text-left" colspan="1" rowspan="1">Comment</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">transactionID</td>
                <td class="text-left" colspan="1" rowspan="1">PrintableString</td>
                <td class="text-left" colspan="1" rowspan="1">Unique ID for this
 transaction as a text string</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">messageType</td>
                <td class="text-left" colspan="1" rowspan="1">PrintableString</td>
                <td class="text-left" colspan="1" rowspan="1">Decimal value as a
 numeric text string</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">pkiStatus</td>
                <td class="text-left" colspan="1" rowspan="1">PrintableString</td>
                <td class="text-left" colspan="1" rowspan="1">Decimal value as a
 numeric text string</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">failInfo</td>
                <td class="text-left" colspan="1" rowspan="1">PrintableString</td>
                <td class="text-left" colspan="1" rowspan="1">Decimal value as a
 numeric text string</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">failInfoText</td>
                <td class="text-left" colspan="1" rowspan="1">UTF8String</td>
                <td class="text-left" colspan="1" rowspan="1">Descriptive text for the
 failInfo value</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">senderNonce</td>
                <td class="text-left" colspan="1" rowspan="1">OCTET STRING</td>
                <td class="text-left" colspan="1" rowspan="1">Random nonce as a 16-byte
 binary data string</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">recipientNonce</td>
                <td class="text-left" colspan="1" rowspan="1">OCTET STRING</td>
                <td class="text-left" colspan="1" rowspan="1">Random nonce as a
 16-byte binary data string</td>
              </tr>
            </tbody>
          </table>
<p id="section-3.2.1-7">The OIDs used for these attributes are as
           follows:<a class="pilcrow" href="#section-3.2.1-7">¶</a></p>
<span id="name-scep-attribute-oids"></span><table class="left" id="table-2">
            <caption>
<a class="selfRef" href="#table-2">Table 2</a>:
<a class="selfRef" href="#name-scep-attribute-oids">SCEP Attribute OIDs</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" colspan="1" rowspan="1">Name</th>
                <th class="text-left" colspan="1" rowspan="1">ASN.1 Definition</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">id-VeriSign</td>
                <td class="text-left" colspan="1" rowspan="1">OBJECT_IDENTIFIER ::= {2 16 US(840) 1
    VeriSign(113733)}</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">id-pki</td>
                <td class="text-left" colspan="1" rowspan="1">OBJECT_IDENTIFIER ::= {id-VeriSign pki(1)}</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">id-attributes</td>
                <td class="text-left" colspan="1" rowspan="1">OBJECT_IDENTIFIER ::= {id-pki
    attributes(9)}</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">id-transactionID</td>
                <td class="text-left" colspan="1" rowspan="1">OBJECT_IDENTIFIER ::= {id-attributes
    transactionID(7)}</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">id-messageType</td>
                <td class="text-left" colspan="1" rowspan="1">OBJECT_IDENTIFIER ::= {id-attributes
    messageType(2)}</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">id-pkiStatus</td>
                <td class="text-left" colspan="1" rowspan="1">OBJECT_IDENTIFIER ::= {id-attributes
    pkiStatus(3)}</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">id-failInfo</td>
                <td class="text-left" colspan="1" rowspan="1">OBJECT_IDENTIFIER ::= {id-attributes
    failInfo(4)}</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">id-senderNonce</td>
                <td class="text-left" colspan="1" rowspan="1">OBJECT_IDENTIFIER ::= {id-attributes
    senderNonce(5)}</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">id-recipientNonce</td>
                <td class="text-left" colspan="1" rowspan="1">OBJECT_IDENTIFIER ::= {id-attributes
 recipientNonce(6)}</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">id-scep</td>
                <td class="text-left" colspan="1" rowspan="1">OBJECT IDENTIFIER ::= {id-pkix 24}</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">id-scep-failInfoText</td>
                <td class="text-left" colspan="1" rowspan="1">OBJECT IDENTIFIER ::= {id-scep 1}</td>
              </tr>
            </tbody>
          </table>
<p id="section-3.2.1-9">

The attributes are detailed in the following sections.<a class="pilcrow" href="#section-3.2.1-9">¶</a></p>
<div id="transactionID">
<section id="section-3.2.1.1">
            <h5 id="name-transactionid">
<a class="section-number selfRef" href="#section-3.2.1.1">3.2.1.1. </a><a class="section-name selfRef" href="#name-transactionid">transactionID</a>
            </h5>
<p id="section-3.2.1.1-1">

A PKI operation is a transaction consisting of the messages exchanged between
a client and the CA.  The transactionID is a text string provided by the
client when starting a transaction.  The client <span class="bcp14">MUST</span> use a unique string as
the transaction identifier, encoded as a PrintableString, which <span class="bcp14">MUST</span> be used
for all PKI messages exchanged for a given operation, such as a certificate
issue.<a class="pilcrow" href="#section-3.2.1.1-1">¶</a></p>
<p id="section-3.2.1.1-2">

Note that the transactionID must be unique, but not necessarily randomly
generated.  For example, it may be a value assigned by the CA to allow the
client to be identified by their transactionID, using a value such as the
client device's Extended Unique Identifier (EUI), Remote Terminal Unit (RTU) ID, or a similar unique
identifier.  This can be
useful when the client doesn't have a preassigned Distinguished Name through
which the CA can identify their request -- for example, when enrolling
Supervisory Control and Data Acquisition (SCADA) devices.<a class="pilcrow" href="#section-3.2.1.1-2">¶</a></p>
</section>
</div>
<div id="messageType">
<section id="section-3.2.1.2">
            <h5 id="name-messagetype">
<a class="section-number selfRef" href="#section-3.2.1.2">3.2.1.2. </a><a class="section-name selfRef" href="#name-messagetype">messageType</a>
            </h5>
<p id="section-3.2.1.2-1">
The messageType attribute specifies the type of operation performed by the
transaction.  This attribute <span class="bcp14">MUST</span> be included in all PKI messages.  The
following message types are defined:<a class="pilcrow" href="#section-3.2.1.2-1">¶</a></p>
<span id="name-scep-message-types"></span><div id="scep-message-types">
<table class="center" id="table-3">
              <caption>
<a class="selfRef" href="#table-3">Table 3</a>:
<a class="selfRef" href="#name-scep-message-types">SCEP Message Types</a>
              </caption>
<thead>
                <tr>
                  <th class="text-left" colspan="1" rowspan="1">Value</th>
                  <th class="text-left" colspan="1" rowspan="1">Name</th>
                  <th class="text-left" colspan="1" rowspan="1">Description</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">0</td>
                  <td class="text-left" colspan="1" rowspan="1">Reserved</td>
                  <td class="text-left" colspan="1" rowspan="1"></td>
                </tr>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">3</td>
                  <td class="text-left" colspan="1" rowspan="1">CertRep</td>
                  <td class="text-left" colspan="1" rowspan="1">Response to certificate or CRL request.</td>
                </tr>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">17</td>
                  <td class="text-left" colspan="1" rowspan="1">RenewalReq</td>
                  <td class="text-left" colspan="1" rowspan="1">PKCS #10 certificate request authenticated with an existing certificate.</td>
                </tr>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">19</td>
                  <td class="text-left" colspan="1" rowspan="1">PKCSReq</td>
                  <td class="text-left" colspan="1" rowspan="1">PKCS #10 certificate request authenticated with a shared secret.</td>
                </tr>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">20</td>
                  <td class="text-left" colspan="1" rowspan="1">CertPoll</td>
                  <td class="text-left" colspan="1" rowspan="1">Certificate polling in manual enrolment.</td>
                </tr>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">21</td>
                  <td class="text-left" colspan="1" rowspan="1">GetCert</td>
                  <td class="text-left" colspan="1" rowspan="1">Retrieve a certificate.</td>
                </tr>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">22</td>
                  <td class="text-left" colspan="1" rowspan="1">GetCRL</td>
                  <td class="text-left" colspan="1" rowspan="1">Retrieve a CRL.</td>
                </tr>
              </tbody>
            </table>
</div>
<p id="section-3.2.1.2-3">
Message types not defined above <span class="bcp14">MUST</span> be treated as errors unless their use
has been negotiated through <span><a class="xref" href="#CA-caps-HTTP">GetCACaps</a> (<a class="xref" href="#CA-caps-HTTP">Section 3.5.1</a>)</span>.<a class="pilcrow" href="#section-3.2.1.2-3">¶</a></p>
</section>
</div>
<div id="pkiStatus">
<section id="section-3.2.1.3">
            <h5 id="name-pkistatus">
<a class="section-number selfRef" href="#section-3.2.1.3">3.2.1.3. </a><a class="section-name selfRef" href="#name-pkistatus">pkiStatus</a>
            </h5>
<p id="section-3.2.1.3-1">

All response messages <span class="bcp14">MUST</span> include transaction status information, which is
defined as a pkiStatus attribute:<a class="pilcrow" href="#section-3.2.1.3-1">¶</a></p>
<span id="name-pkistatus-attributes"></span><div id="tab-pkiStatus">
<table class="center" id="table-4">
              <caption>
<a class="selfRef" href="#table-4">Table 4</a>:
<a class="selfRef" href="#name-pkistatus-attributes">pkiStatus Attributes</a>
              </caption>
<thead>
                <tr>
                  <th class="text-left" colspan="1" rowspan="1">Value</th>
                  <th class="text-left" colspan="1" rowspan="1">Name</th>
                  <th class="text-left" colspan="1" rowspan="1">Description</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">0</td>
                  <td class="text-left" colspan="1" rowspan="1">SUCCESS</td>
                  <td class="text-left" colspan="1" rowspan="1">Request granted.</td>
                </tr>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">2</td>
                  <td class="text-left" colspan="1" rowspan="1">FAILURE</td>
                  <td class="text-left" colspan="1" rowspan="1">Request rejected.  In this case, the failInfo attribute, as defined
      in <a class="xref" href="#failInfo">Section 3.2.1.4</a>, <span class="bcp14">MUST</span> also
      be present.</td>
                </tr>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">3</td>
                  <td class="text-left" colspan="1" rowspan="1">PENDING</td>
                  <td class="text-left" colspan="1" rowspan="1">Request pending for manual approval.</td>
                </tr>
              </tbody>
            </table>
</div>
<p id="section-3.2.1.3-3">
PKI status values not defined above <span class="bcp14">MUST</span> be treated as errors unless their
use has been negotiated through <span><a class="xref" href="#CA-caps-HTTP">GetCACaps</a> (<a class="xref" href="#CA-caps-HTTP">Section 3.5.1</a>)</span>.<a class="pilcrow" href="#section-3.2.1.3-3">¶</a></p>
</section>
</div>
<div id="failInfo">
<section id="section-3.2.1.4">
            <h5 id="name-failinfo-and-failinfotext">
<a class="section-number selfRef" href="#section-3.2.1.4">3.2.1.4. </a><a class="section-name selfRef" href="#name-failinfo-and-failinfotext">failInfo and failInfoText</a>
            </h5>
<p id="section-3.2.1.4-1">
The failInfo attribute <span class="bcp14">MUST</span> contain one of the following failure reasons:<a class="pilcrow" href="#section-3.2.1.4-1">¶</a></p>
<span id="name-failinfo-attributes"></span><div id="tab-failInfo">
<table class="center" id="table-5">
              <caption>
<a class="selfRef" href="#table-5">Table 5</a>:
<a class="selfRef" href="#name-failinfo-attributes">failInfo Attributes</a>
              </caption>
<thead>
                <tr>
                  <th class="text-left" colspan="1" rowspan="1">Value</th>
                  <th class="text-left" colspan="1" rowspan="1">Name</th>
                  <th class="text-left" colspan="1" rowspan="1">Description</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">0</td>
                  <td class="text-left" colspan="1" rowspan="1">badAlg</td>
                  <td class="text-left" colspan="1" rowspan="1">Unrecognised or unsupported algorithm.</td>
                </tr>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">1</td>
                  <td class="text-left" colspan="1" rowspan="1">badMessageCheck</td>
                  <td class="text-left" colspan="1" rowspan="1">Integrity check (meaning signature verification of the CMS message) failed.</td>
                </tr>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">2</td>
                  <td class="text-left" colspan="1" rowspan="1">badRequest</td>
                  <td class="text-left" colspan="1" rowspan="1">Transaction not permitted or supported.</td>
                </tr>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">3</td>
                  <td class="text-left" colspan="1" rowspan="1">badTime</td>
                  <td class="text-left" colspan="1" rowspan="1">The signingTime attribute from the CMS authenticatedAttributes was
      not sufficiently close to the system time.  This condition may occur if
      the CA is concerned about replays of old messages.</td>
                </tr>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">4</td>
                  <td class="text-left" colspan="1" rowspan="1">badCertId</td>
                  <td class="text-left" colspan="1" rowspan="1">No certificate could be identified matching the provided criteria.</td>
                </tr>
              </tbody>
            </table>
</div>
<p id="section-3.2.1.4-3">
Failure reasons not defined above <span class="bcp14">MUST</span> be treated as errors unless their use
has been negotiated through <span><a class="xref" href="#CA-caps-HTTP">GetCACaps</a> (<a class="xref" href="#CA-caps-HTTP">Section 3.5.1</a>)</span>.<a class="pilcrow" href="#section-3.2.1.4-3">¶</a></p>
<p id="section-3.2.1.4-4">
The failInfoText is a free-form UTF-8 text string that provides further
information in the case of pkiStatus = FAILURE.  In particular, it may be used
to provide details on why a certificate request was not granted that go beyond
what's provided by the near-universal failInfo = badRequest status.  Since
this is a free-form text string intended for interpretation by humans,
implementations <span class="bcp14">SHOULD NOT</span> assume that it has any type of machine-processable
content.<a class="pilcrow" href="#section-3.2.1.4-4">¶</a></p>
</section>
</div>
<div id="nonces">
<section id="section-3.2.1.5">
            <h5 id="name-sendernonce-and-recipientno">
<a class="section-number selfRef" href="#section-3.2.1.5">3.2.1.5. </a><a class="section-name selfRef" href="#name-sendernonce-and-recipientno">senderNonce and recipientNonce</a>
            </h5>
<p id="section-3.2.1.5-1">
The senderNonce and recipientNonce attributes are each a 16-byte random number
generated for each transaction.  These are intended to prevent replay attacks.<a class="pilcrow" href="#section-3.2.1.5-1">¶</a></p>
<p id="section-3.2.1.5-2">
When a sender sends a PKI message to a recipient, a fresh senderNonce <span class="bcp14">MUST</span> be
included in the message.  The recipient <span class="bcp14">MUST</span> copy the senderNonce into the
recipientNonce of the reply as a proof of liveliness.  The original sender
<span class="bcp14">MUST</span> verify that the recipientNonce of the reply matches the senderNonce it
sent in the request.  If the nonce does not match, then the message <span class="bcp14">MUST</span> be
rejected.<a class="pilcrow" href="#section-3.2.1.5-2">¶</a></p>
<p id="section-3.2.1.5-3">
Note that since SCEP exchanges consist of a single request followed by a
single response, the use of distinct sender and recipient nonces is redundant,
since the client sends a nonce in its request and the CA responds with the
same nonce in its reply.  In effect, there's just a single nonce, identified as
senderNonce in the client's request and recipientNonce in the CA's reply.<a class="pilcrow" href="#section-3.2.1.5-3">¶</a></p>
</section>
</div>
</section>
</div>
<div id="pkcsPKIEnvelope">
<section id="section-3.2.2">
          <h4 id="name-scep-pkcspkienvelope">
<a class="section-number selfRef" href="#section-3.2.2">3.2.2. </a><a class="section-name selfRef" href="#name-scep-pkcspkienvelope">SCEP pkcsPKIEnvelope</a>
          </h4>
<p id="section-3.2.2-1">

The information portion of a SCEP message is carried inside an EnvelopedData
content type, as defined in CMS, with the following restrictions:<a class="pilcrow" href="#section-3.2.2-1">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3.2.2-2.1">contentType in encryptedContentInfo <span class="bcp14">MUST</span> be data ({pkcs-7
    1}).<a class="pilcrow" href="#section-3.2.2-2.1">¶</a>
</li>
            <li class="compact" id="section-3.2.2-2.2">encryptedContent <span class="bcp14">MUST</span> be the SCEP message being transported
    (see <a class="xref" href="#SCEP-trans">Section 4</a>)
    and <span class="bcp14">MUST</span> match the
    messageType authenticated Attribute in the pkiMessage.<a class="pilcrow" href="#section-3.2.2-2.2">¶</a>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="pkiMessage-types">
<section id="section-3.3">
        <h3 id="name-scep-pkimessage-types">
<a class="section-number selfRef" href="#section-3.3">3.3. </a><a class="section-name selfRef" href="#name-scep-pkimessage-types">SCEP pkiMessage types</a>
        </h3>
<p id="section-3.3-1">

All of the messages in this section are pkiMessages (<a class="xref" href="#pkiMessage">Section 3.2</a>), where the type of the message <span class="bcp14">MUST</span> be specified in the
"messageType" authenticated Attribute.  Each section defines a valid message
type, the corresponding messageData formats, and mandatory authenticated
attributes for that type.<a class="pilcrow" href="#section-3.3-1">¶</a></p>
<div id="PKCSReq">
<section id="section-3.3.1">
          <h4 id="name-pkcsreq-renewalreq">
<a class="section-number selfRef" href="#section-3.3.1">3.3.1. </a><a class="section-name selfRef" href="#name-pkcsreq-renewalreq">PKCSReq/RenewalReq</a>
          </h4>
<p id="section-3.3.1-1">

The messageData for this type consists of a PKCS #10 Certificate Request.  The
certificate request <span class="bcp14">MUST</span> contain at least the following items:<a class="pilcrow" href="#section-3.3.1-1">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3.3.1-2.1">The subject Distinguished Name.<a class="pilcrow" href="#section-3.3.1-2.1">¶</a>
</li>
            <li class="compact" id="section-3.3.1-2.2">The subject public key.<a class="pilcrow" href="#section-3.3.1-2.2">¶</a>
</li>
            <li class="compact" id="section-3.3.1-2.3">For a PKCSReq, if authorisation based on a shared secret is
     being used, a challengePassword attribute.<a class="pilcrow" href="#section-3.3.1-2.3">¶</a>
</li>
          </ul>
<p id="section-3.3.1-3">

In addition, the message must contain the authenticatedAttributes specified in
<a class="xref" href="#signed-attrs">Section 3.2.1</a>.<a class="pilcrow" href="#section-3.3.1-3">¶</a></p>
</section>
</div>
<div id="CertRep">
<section id="section-3.3.2">
          <h4 id="name-certrep">
<a class="section-number selfRef" href="#section-3.3.2">3.3.2. </a><a class="section-name selfRef" href="#name-certrep">CertRep</a>
          </h4>
<p id="section-3.3.2-1">

The messageData for this type consists of a degenerate certificates-only CMS
SignedData message (<a class="xref" href="#certs-only">Section 3.4</a>).  The exact content required
for the reply depends on the type of request that this message is a response
to.  The request types are detailed in Sections <a class="xref" href="#CertRep-success">3.3.2.1</a> and <a class="xref" href="#SCEP-trans">4</a>.  In
addition, the message must contain the
authenticatedAttributes specified in <a class="xref" href="#signed-attrs">Section 3.2.1</a>.<a class="pilcrow" href="#section-3.3.2-1">¶</a></p>
<p id="section-3.3.2-2">
Earlier draft versions of this specification required that this message include a
senderNonce alongside the recipientNonce, which was to be used to chain to
subsequent polling operations.  However, if a single message was lost during
the potentially extended interval over which polling could take place (see
<a class="xref" href="#state-trans">Section 5</a> for an example of this), then if the
implementation were to enforce this requirement, the overall transaction would
fail, even though nothing had actually gone wrong.  Because of this issue,
implementations mostly ignored the requirement to either carry this nonce over to
subsequent polling messages or verify its presence.  More recent versions
of the specification no longer require the chaining of nonces across polling
operations.<a class="pilcrow" href="#section-3.3.2-2">¶</a></p>
<div id="CertRep-success">
<section id="section-3.3.2.1">
            <h5 id="name-certrep-success">
<a class="section-number selfRef" href="#section-3.3.2.1">3.3.2.1. </a><a class="section-name selfRef" href="#name-certrep-success">CertRep SUCCESS</a>
            </h5>
<p id="section-3.3.2.1-1">

When the pkiStatus attribute is set to SUCCESS, the messageData for this
message consists of a degenerate certificates-only CMS SignedData message
(<a class="xref" href="#certs-only">Section 3.4</a>).  The content of this degenerate
certificates-only SignedData message depends on what the original request was, as
outlined in <a class="xref" href="#success">Table 6</a>.<a class="pilcrow" href="#section-3.3.2.1-1">¶</a></p>
<span id="name-certrep-response-types"></span><div id="success">
<table class="left" id="table-6">
              <caption>
<a class="selfRef" href="#table-6">Table 6</a>:
<a class="selfRef" href="#name-certrep-response-types">CertRep Response Types</a>
              </caption>
<thead>
                <tr>
                  <th class="text-left" colspan="1" rowspan="1">Request-type</th>
                  <th class="text-left" colspan="1" rowspan="1">Reply-contents</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">PKCSReq</td>
                  <td class="text-left" colspan="1" rowspan="1">The reply <span class="bcp14">MUST</span> contain at least the issued
   certificate in the certificates field of the SignedData.
   The reply <span class="bcp14">MAY</span> contain additional certificates, but the issued
   certificate <span class="bcp14">MUST</span> be the leaf certificate.</td>
                </tr>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">RenewalReq</td>
                  <td class="text-left" colspan="1" rowspan="1">Same as PKCSReq</td>
                </tr>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">CertPoll</td>
                  <td class="text-left" colspan="1" rowspan="1">Same as PKCSReq</td>
                </tr>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">GetCert</td>
                  <td class="text-left" colspan="1" rowspan="1">The reply <span class="bcp14">MUST</span> contain at least the requested
  certificate in the certificates field of the SignedData.
  The reply <span class="bcp14">MAY</span> contain additional certificates, but the
  requested certificate <span class="bcp14">MUST</span> be the leaf certificate.</td>
                </tr>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">GetCRL</td>
                  <td class="text-left" colspan="1" rowspan="1">The reply <span class="bcp14">MUST</span> contain the
   CRL in the crls field of the SignedData.</td>
                </tr>
              </tbody>
            </table>
</div>
</section>
</div>
<div id="CertRep-failure">
<section id="section-3.3.2.2">
            <h5 id="name-certrep-failure">
<a class="section-number selfRef" href="#section-3.3.2.2">3.3.2.2. </a><a class="section-name selfRef" href="#name-certrep-failure">CertRep FAILURE</a>
            </h5>
<p id="section-3.3.2.2-1">

When the pkiStatus attribute is set to FAILURE, the reply <span class="bcp14">MUST</span> also contain a
failInfo (<a class="xref" href="#failInfo">Section 3.2.1.4</a>) attribute set to the appropriate error
condition describing the failure.  The reply <span class="bcp14">MAY</span> also contain a failInfoText
attribute providing extended details on why the operation failed, typically to
expand on the catchall failInfo = badRequest status.  The pkcsPKIEnvelope
(<a class="xref" href="#pkcsPKIEnvelope">Section 3.2.2</a>) <span class="bcp14">MUST</span> be omitted.<a class="pilcrow" href="#section-3.3.2.2-1">¶</a></p>
</section>
</div>
<div id="CertRep-pending">
<section id="section-3.3.2.3">
            <h5 id="name-certrep-pending">
<a class="section-number selfRef" href="#section-3.3.2.3">3.3.2.3. </a><a class="section-name selfRef" href="#name-certrep-pending">CertRep PENDING</a>
            </h5>
<p id="section-3.3.2.3-1">

When the pkiStatus attribute is set to PENDING, the pkcsPKIEnvelope (<a class="xref" href="#pkcsPKIEnvelope">Section 3.2.2</a>) <span class="bcp14">MUST</span> be omitted.<a class="pilcrow" href="#section-3.3.2.3-1">¶</a></p>
</section>
</div>
</section>
</div>
<div id="CertPoll">
<section id="section-3.3.3">
          <h4 id="name-certpoll-getcertinitial">
<a class="section-number selfRef" href="#section-3.3.3">3.3.3. </a><a class="section-name selfRef" href="#name-certpoll-getcertinitial">CertPoll (GetCertInitial)</a>
          </h4>
<p id="section-3.3.3-1">
This message is used for certificate polling.  For unknown reasons, it was
referred to as "GetCertInitial" in earlier draft versions of this specification.
The messageData for this type consists of an IssuerAndSubject:<a class="pilcrow" href="#section-3.3.3-1">¶</a></p>
<div id="section-3.3.3-2">
<pre class="sourcecode">issuerAndSubject ::= SEQUENCE {
    issuer     Name,
    subject    Name
    }
</pre><a class="pilcrow" href="#section-3.3.3-2">¶</a>
</div>
<p id="section-3.3.3-3">
The issuer is set to the subjectName of the CA (in other words, the intended
issuerName of the certificate that's being requested).  The subject is set to
the subjectName used when requesting the certificate.<a class="pilcrow" href="#section-3.3.3-3">¶</a></p>
<p id="section-3.3.3-4">
Note that both of these fields are redundant; the CA is identified by the
recipientInfo in the pkcsPKIEnvelope (or in most cases, simply by the server
that the message is being sent to), and the client/transaction being polled is
identified by the transactionID.  Both of these fields can be processed by the
CA without going through the cryptographically expensive process of unwrapping
and processing the issuerAndSubject.  For this reason, implementations <span class="bcp14">SHOULD</span>
assume that the polling operation will be controlled by the recipientInfo and
transactionID rather than the contents of the messageData.  In addition, the
message must contain the authenticatedAttributes specified in <a class="xref" href="#signed-attrs">Section 3.2.1</a>.<a class="pilcrow" href="#section-3.3.3-4">¶</a></p>
</section>
</div>
<div id="GetCertCRL">
<section id="section-3.3.4">
          <h4 id="name-getcert-and-getcrl">
<a class="section-number selfRef" href="#section-3.3.4">3.3.4. </a><a class="section-name selfRef" href="#name-getcert-and-getcrl">GetCert and GetCRL</a>
          </h4>
<p id="section-3.3.4-1">

The messageData for these types consist of an IssuerAndSerialNumber, as defined
in CMS, that uniquely identifies the certificate being requested, either the
certificate itself for GetCert or its revocation status via a CRL for GetCRL.
In addition, the message must contain the authenticatedAttributes specified
in <a class="xref" href="#signed-attrs">Section 3.2.1</a>.<a class="pilcrow" href="#section-3.3.4-1">¶</a></p>
<p id="section-3.3.4-2">

These message types, while included here for completeness, apply unnecessary
cryptography and messaging overhead to the simple task of transferring a
certificate or CRL (see <a class="xref" href="#security-unnecessary">Section 7.8</a>).
Implementations <span class="bcp14">SHOULD</span> prefer
<span><a class="xref" href="#RFC4387">HTTP certificate-store access</a> [<a class="xref" href="#RFC4387">RFC4387</a>]</span> or LDAP
over the use of these messages.<a class="pilcrow" href="#section-3.3.4-2">¶</a></p>
</section>
</div>
</section>
</div>
<div id="certs-only">
<section id="section-3.4">
        <h3 id="name-degenerate-certificates-onl">
<a class="section-number selfRef" href="#section-3.4">3.4. </a><a class="section-name selfRef" href="#name-degenerate-certificates-onl">Degenerate certificates-only CMS SignedData</a>
        </h3>
<p id="section-3.4-1">
CMS includes a degenerate case of the SignedData content type in which there
are no signers.  The use of such a degenerate case is to disseminate
certificates and CRLs.  For SCEP, the content field of the ContentInfo value of
a degenerate certificates-only SignedData <span class="bcp14">MUST</span> be omitted.  When carrying
certificates, the certificates are included in the certificates field of the
SignedData.  When carrying a CRL, the CRL is included in the crls field of
the SignedData.<a class="pilcrow" href="#section-3.4-1">¶</a></p>
</section>
</div>
<div id="CA-caps">
<section id="section-3.5">
        <h3 id="name-ca-capabilities">
<a class="section-number selfRef" href="#section-3.5">3.5. </a><a class="section-name selfRef" href="#name-ca-capabilities">CA Capabilities</a>
        </h3>
<p id="section-3.5-1">

In order to provide support for future enhancements to the protocol, CAs <span class="bcp14">MUST</span>
implement the GetCACaps message to allow clients to query which functionality
is available from the CA.<a class="pilcrow" href="#section-3.5-1">¶</a></p>
<div id="CA-caps-HTTP">
<section id="section-3.5.1">
          <h4 id="name-getcacaps-http-message-form">
<a class="section-number selfRef" href="#section-3.5.1">3.5.1. </a><a class="section-name selfRef" href="#name-getcacaps-http-message-form">GetCACaps HTTP Message Format</a>
          </h4>
<p id="section-3.5.1-1">This message requests capabilities from a CA, with the
   format as described in <a class="xref" href="#HTTP-GET-POST">Section 4.1</a>:<a class="pilcrow" href="#section-3.5.1-1">¶</a></p>
<div id="section-3.5.1-2">
<pre class="sourcecode">"GET" SP SCEPPATH "?operation=GetCACaps" SP HTTP-version CRLF
</pre><a class="pilcrow" href="#section-3.5.1-2">¶</a>
</div>
</section>
</div>
<div id="CA-caps-resp">
<section id="section-3.5.2">
          <h4 id="name-ca-capabilities-response-fo">
<a class="section-number selfRef" href="#section-3.5.2">3.5.2. </a><a class="section-name selfRef" href="#name-ca-capabilities-response-fo">CA Capabilities Response Format</a>
          </h4>
<p id="section-3.5.2-1">The response for a GetCACaps message is a list of CA
   capabilities, in plain text and in any order, separated
   by &lt;CR&gt;&lt;LF&gt; or &lt;LF&gt; characters.  This
   specification defines the following keywords (quotation
   marks are not sent):<a class="pilcrow" href="#section-3.5.2-1">¶</a></p>
<span id="name-getcacaps-response-keywords"></span><div id="keywords">
<table class="left" id="table-7">
            <caption>
<a class="selfRef" href="#table-7">Table 7</a>:
<a class="selfRef" href="#name-getcacaps-response-keywords">GetCACaps Response Keywords</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" colspan="1" rowspan="1">Keyword</th>
                <th class="text-left" colspan="1" rowspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">AES</td>
                <td class="text-left" colspan="1" rowspan="1">CA supports the AES128-CBC encryption
    algorithm.</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">DES3</td>
                <td class="text-left" colspan="1" rowspan="1">CA supports the triple DES-CBC encryption
    algorithm.</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">GetNextCACert</td>
                <td class="text-left" colspan="1" rowspan="1">CA supports the GetNextCACert
 message.</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">POSTPKIOperation</td>
                <td class="text-left" colspan="1" rowspan="1">CA supports PKIOPeration messages sent
    via HTTP POST.</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">Renewal</td>
                <td class="text-left" colspan="1" rowspan="1">CA supports the Renewal CA operation.</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">SHA-1</td>
                <td class="text-left" colspan="1" rowspan="1">CA supports the SHA-1 hashing algorithm.</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">SHA-256</td>
                <td class="text-left" colspan="1" rowspan="1">CA supports the SHA-256 hashing algorithm.</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">SHA-512</td>
                <td class="text-left" colspan="1" rowspan="1">CA supports the SHA-512 hashing algorithm.</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">SCEPStandard</td>
                <td class="text-left" colspan="1" rowspan="1">CA supports all mandatory-to-implement
 sections of the SCEP standard.  This keyword implies "AES",
 "POSTPKIOperation", and "SHA-256", as well as the provisions of
 <a class="xref" href="#MTI">Section 2.9</a>.</td>
              </tr>
            </tbody>
          </table>
</div>
<p id="section-3.5.2-3">

<a class="xref" href="#keywords">Table 7</a> lists all of the keywords that are defined in this
specification.  A CA <span class="bcp14">MAY</span> provide additional keywords advertising further
capabilities and functionality.  A client <span class="bcp14">MUST</span> be able to accept and ignore
any unknown keywords that might be sent by a CA.<a class="pilcrow" href="#section-3.5.2-3">¶</a></p>
<p id="section-3.5.2-4">
The CA <span class="bcp14">MUST</span> use the text case specified here, but clients
<span class="bcp14">SHOULD</span> ignore the text case when processing this message. 
Clients <span class="bcp14">MUST</span> accept the standard
HTTP-style text delimited by &lt;CR&gt;&lt;LF&gt; as well as the
text delimited by &lt;LF&gt; specified in an earlier draft version of this
specification.<a class="pilcrow" href="#section-3.5.2-4">¶</a></p>
<p id="section-3.5.2-5">
The client <span class="bcp14">SHOULD</span> use SHA-256 in preference to SHA-1 hashing and AES128-CBC in
preference to triple DES-CBC if they are supported by the CA.  Although the
CMS format allows any form of  AES and SHA-2 to be specified, in the interests
of interoperability the de facto universal standards of AES128-CBC and SHA-256
<span class="bcp14">SHOULD</span> be used.<a class="pilcrow" href="#section-3.5.2-5">¶</a></p>
<p id="section-3.5.2-6">
Announcing some of these capabilities individually is redundant, since they're
required as mandatory-to-implement functionality (see <a class="xref" href="#MTI">Section 2.9</a>)
whose presence as a whole is signalled by the "SCEPStandard" capability. However,
it may be useful to announce them in order to deal with older implementations
that would otherwise default to obsolete, insecure algorithms and mechanisms.<a class="pilcrow" href="#section-3.5.2-6">¶</a></p>
<p id="section-3.5.2-7">

If the CA supports none of the above capabilities, it <span class="bcp14">SHOULD</span> return an empty
message.  A CA <span class="bcp14">MAY</span> simply return an HTTP error.  A client that receives an
empty message or an HTTP error <span class="bcp14">SHOULD</span> interpret the response as if none of the
capabilities listed are supported by the CA.<a class="pilcrow" href="#section-3.5.2-7">¶</a></p>
<p id="section-3.5.2-8">

Note that at least one widely deployed server implementation supports several
of the above operations but doesn't support the GetCACaps message to indicate
that it supports them, and it will close the connection if sent a GetCACaps
message.  This means that the equivalent of GetCACaps must be performed
through server fingerprinting, which can be done using the ID string
"Microsoft-IIS".  Newer versions of the same server, if sent a SCEP request
using AES and SHA-2, will respond with an invalid response that can't be
decrypted, requiring the use of 3DES and SHA-1 in order to obtain a response
that can be processed, even if AES and/or SHA-2 are allegedly supported.  In
addition, the server will generate CA certificates that only have one, but not
both, of the keyEncipherment and digitalSignature keyUsage flags set,
requiring that the client ignore the keyUsage flags in order to use the
certificates for SCEP.<a class="pilcrow" href="#section-3.5.2-8">¶</a></p>
<p id="section-3.5.2-9">

The Content-type of the reply <span class="bcp14">SHOULD</span> be "text/plain".  Clients
<span class="bcp14">SHOULD</span> ignore
the Content-type, as older implementations of SCEP may send various
Content-types.<a class="pilcrow" href="#section-3.5.2-9">¶</a></p>
<p id="section-3.5.2-10">Example:<a class="pilcrow" href="#section-3.5.2-10">¶</a></p>
<div id="section-3.5.2-11">
<pre class="sourcecode">GET /cgi-bin/pkiclient.exe?operation=GetCACaps HTTP/1.1
</pre><a class="pilcrow" href="#section-3.5.2-11">¶</a>
</div>
<p id="section-3.5.2-12">might return:<a class="pilcrow" href="#section-3.5.2-12">¶</a></p>
<div id="section-3.5.2-13">
<pre class="sourcecode">AES
GetNextCACert
POSTPKIOperation
SCEPStandard
SHA-256
</pre><a class="pilcrow" href="#section-3.5.2-13">¶</a>
</div>
<p id="section-3.5.2-14">

This means that the CA supports modern crypto algorithms, and the GetNextCACert
message allows PKIOperation messages (PKCSReq/RenewalReq, GetCert, CertPoll,
...) to be sent using HTTP POST and is compliant with the final version of
the SCEP standard.<a class="pilcrow" href="#section-3.5.2-14">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="SCEP-trans">
<section id="section-4">
      <h2 id="name-scep-transactions">
<a class="section-number selfRef" href="#section-4">4. </a><a class="section-name selfRef" href="#name-scep-transactions">SCEP Transactions</a>
      </h2>
<p id="section-4-1">

This section describes the SCEP Transactions and their
<span><a class="xref" href="#RFC7230">HTTP</a> [<a class="xref" href="#RFC7230">RFC7230</a>]</span> transport mechanism.<a class="pilcrow" href="#section-4-1">¶</a></p>
<p id="section-4-2">

Note that SCEP doesn't follow best current practices on usage of HTTP.  In
particular, it recommends ignoring some media types and hard-codes specific URI
paths.  Guidance on the appropriate application of HTTP in these circumstances
may be found in <span>[<a class="xref" href="#I-D.ietf-httpbis-bcp56bis">HTTP</a>]</span>.<a class="pilcrow" href="#section-4-2">¶</a></p>
<div id="HTTP-GET-POST">
<section id="section-4.1">
        <h3 id="name-http-post-and-get-message-f">
<a class="section-number selfRef" href="#section-4.1">4.1. </a><a class="section-name selfRef" href="#name-http-post-and-get-message-f">HTTP POST and GET Message Formats</a>
        </h3>
<p id="section-4.1-1">

SCEP uses the HTTP POST and GET methods <span>[<a class="xref" href="#RFC7230">RFC7230</a>]</span> to
exchange information with the CA.  The following defines the ABNF syntax of
HTTP POST and GET methods sent from a client to a CA:<a class="pilcrow" href="#section-4.1-1">¶</a></p>
<div id="section-4.1-2">
<pre class="sourcecode lang-abnf">POSTREQUEST = "POST" SP SCEPPATH "?operation=" OPERATION
              SP HTTP-version CRLF

GETREQUEST = "GET" SP SCEPPATH "?operation=" OPERATION
             "&amp;message=" MESSAGE SP HTTP-version CRLF
</pre><a class="pilcrow" href="#section-4.1-2">¶</a>
</div>
<p id="section-4.1-3">
where:<a class="pilcrow" href="#section-4.1-3">¶</a></p>
<ul class="compact">
<li class="compact" id="section-4.1-4.1">SCEPPATH is the HTTP URL path for accessing the CA. Clients
   <span class="bcp14">SHOULD</span> set SCEPPATH to the fixed string "/cgi-bin/pkiclient.exe"
   unless directed to do otherwise by the CA.<a class="pilcrow" href="#section-4.1-4.1">¶</a>
</li>
          <li class="compact" id="section-4.1-4.2">OPERATION depends on the SCEP transaction and is defined in the
   following sections.<a class="pilcrow" href="#section-4.1-4.2">¶</a>
</li>
          <li class="compact" id="section-4.1-4.3">HTTP-version is the HTTP version string, which is "HTTP/1.1" for
   <span>[<a class="xref" href="#RFC7230">RFC7230</a>]</span>.<a class="pilcrow" href="#section-4.1-4.3">¶</a>
</li>
          <li class="compact" id="section-4.1-4.4">SP and CRLF are space and carriage return/linefeed, as defined in
   <span>[<a class="xref" href="#RFC5234">RFC5234</a>]</span>.<a class="pilcrow" href="#section-4.1-4.4">¶</a>
</li>
        </ul>
<p id="section-4.1-5">

The CA will typically ignore SCEPPATH, since it's unlikely to be issuing
certificates via a web server.  Clients <span class="bcp14">SHOULD</span> set SCEPPATH to the fixed
string "/cgi-bin/pkiclient.exe" unless directed to do otherwise by the CA.
The CA <span class="bcp14">SHOULD</span> ignore the SCEPPATH unless its precise format is critical to the
CA's operation.<a class="pilcrow" href="#section-4.1-5">¶</a></p>
<p id="section-4.1-6">
Early SCEP drafts performed all communications via GET messages, including
non-idempotent ones that should have been sent via POST messages; see
<span>[<a class="xref" href="#I-D.ietf-httpbis-bcp56bis">HTTP</a>]</span> for details.  This has caused problems because of
the way that the (supposedly) idempotent GET interacts with caches and
proxies, and because the extremely large GET requests created by encoding CMS
messages may be truncated in transit.  These issues are typically not visible
when testing on a LAN, but crop up during deployment over WANs.  If the remote
CA supports POST, the CMS-encoded SCEP messages <span class="bcp14">MUST</span> be sent via HTTP POST
instead of HTTP GET.  This applies to any SCEP message except GetCACert,
GetNextCACert, and GetCACaps and avoids the need for base64 and URL encoding
that's required for GET messaging.  The client can verify that the CA supports
SCEP messages via POST by looking for the "SCEPStandard" or "POSTPKIOperation"
capability (see <a class="xref" href="#CA-caps-resp">Section 3.5.2</a>).<a class="pilcrow" href="#section-4.1-6">¶</a></p>
<p id="section-4.1-7">
If a client or CA uses HTTP GET and encounters HTTP-related problems such as
messages being truncated, seeing errors such as HTTP 414 ("Request-URI too
long"), or simply having the message not sent/received at all when standard
requests to the server (for example, via a web browser) work, then this is a
symptom of the problematic use of HTTP GET.  The solution to this problem is
to update the implementation to use HTTP POST instead.  In addition, when using
GET, it's recommended to test the implementation from as many different network
locations as possible to determine whether the use of GET will cause problems
with communications.<a class="pilcrow" href="#section-4.1-7">¶</a></p>
<p id="section-4.1-8">

When using GET messages to communicate binary data, base64 encoding as
specified in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc4648#section-4">Section 4</a> of [<a class="xref" href="#RFC4648">RFC4648</a>]</span>
          <span class="bcp14">MUST</span> be used.  The base64-encoded data is distinct from
"base64url" and may contain URI reserved
characters; thus, it <span class="bcp14">MUST</span> be escaped as specified in <span>[<a class="xref" href="#RFC3986">RFC3986</a>]</span> in addition to being base64 encoded.
Finally, the encoded data is inserted into
the MESSAGE portion of the HTTP GET request.<a class="pilcrow" href="#section-4.1-8">¶</a></p>
</section>
</div>
<div id="GetCACert">
<section id="section-4.2">
        <h3 id="name-get-ca-certificate">
<a class="section-number selfRef" href="#section-4.2">4.2. </a><a class="section-name selfRef" href="#name-get-ca-certificate">Get CA Certificate</a>
        </h3>
<p id="section-4.2-1">

To get the CA certificate(s), the client sends a GetCACert message to the CA.
The OPERATION <span class="bcp14">MUST</span> be set to "GetCACert".  There is no request data associated
with this message.<a class="pilcrow" href="#section-4.2-1">¶</a></p>
<div id="GetCACert-resp">
<section id="section-4.2.1">
          <h4 id="name-get-ca-certificate-response">
<a class="section-number selfRef" href="#section-4.2.1">4.2.1. </a><a class="section-name selfRef" href="#name-get-ca-certificate-response">Get CA Certificate Response Message Format</a>
          </h4>
<p id="section-4.2.1-1">

The response for GetCACert is different between the case where the CA directly
communicates with the client during the enrolment and the case where an
intermediate CA exists and the client communicates with this CA during the
enrolment.<a class="pilcrow" href="#section-4.2.1-1">¶</a></p>
<div id="GetCACert-resp-format">
<section id="section-4.2.1.1">
            <h5 id="name-ca-certificate-response-mes">
<a class="section-number selfRef" href="#section-4.2.1.1">4.2.1.1. </a><a class="section-name selfRef" href="#name-ca-certificate-response-mes">CA Certificate Response Message Format</a>
            </h5>
<p id="section-4.2.1.1-1">

If the CA does not have any intermediate CA certificates, the response
consists of a single X.509 CA certificate.  The response will have a
Content-Type of "application/x-x509-ca-cert".<a class="pilcrow" href="#section-4.2.1.1-1">¶</a></p>
<div id="section-4.2.1.1-2">
<pre class="sourcecode">"Content-Type: application/x-x509-ca-cert"

&lt;binary X.509&gt;
</pre><a class="pilcrow" href="#section-4.2.1.1-2">¶</a>
</div>
</section>
</div>
<div id="GetCACertChain-resp-format">
<section id="section-4.2.1.2">
            <h5 id="name-ca-certificate-chain-respon">
<a class="section-number selfRef" href="#section-4.2.1.2">4.2.1.2. </a><a class="section-name selfRef" href="#name-ca-certificate-chain-respon">CA Certificate Chain Response Message Format</a>
            </h5>
<p id="section-4.2.1.2-1">
If the CA has intermediate CA certificates, the response consists of a
degenerate certificates-only CMS SignedData message (<a class="xref" href="#certs-only">Section 3.4</a>) containing the certificates, with the intermediate CA
certificate(s) as the leaf certificate(s).  The response will have a
Content-Type of "application/x-x509-ca-ra-cert".  Note that this designation
is used for historical reasons due to its use in older versions of this
specification -- no special meaning should be attached to the label.<a class="pilcrow" href="#section-4.2.1.2-1">¶</a></p>
<div id="section-4.2.1.2-2">
<pre class="sourcecode">"Content-Type: application/x-x509-ca-ra-cert"

&lt;binary CMS&gt;
</pre><a class="pilcrow" href="#section-4.2.1.2-2">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="cert-enrolment">
<section id="section-4.3">
        <h3 id="name-certificate-enrolment-renewa">
<a class="section-number selfRef" href="#section-4.3">4.3. </a><a class="section-name selfRef" href="#name-certificate-enrolment-renewa">Certificate Enrolment/Renewal</a>
        </h3>
<p id="section-4.3-1">
A PKCSReq/RenewalReq (<a class="xref" href="#PKCSReq">Section 3.3.1</a>) message is used to perform a
certificate enrolment or renewal transaction.  The OPERATION <span class="bcp14">MUST</span> be set to
"PKIOperation".  Note that when used with HTTP POST, the only OPERATION
possible is "PKIOperation", so many CAs don't check this value or even notice
its absence.  When implemented using HTTP POST, the message is sent with a
Content-Type of "application/x-pki-message" and might look as follows:<a class="pilcrow" href="#section-4.3-1">¶</a></p>
<div id="section-4.3-2">
<pre class="sourcecode">POST /cgi-bin/pkiclient.exe?operation=PKIOperation HTTP/1.1
Content-Length: &lt;length of data&gt;
Content-Type: application/x-pki-message

&lt;binary CMS data&gt;
</pre><a class="pilcrow" href="#section-4.3-2">¶</a>
</div>
<p id="section-4.3-3">
   When implemented using HTTP GET, this might look as follows:<a class="pilcrow" href="#section-4.3-3">¶</a></p>
<div id="section-4.3-4">
<pre class="sourcecode">GET /cgi-bin/pkiclient.exe?operation=PKIOperation&amp; \
message=MIAGCSqGSIb3DQEHA6CAMIACAQAxgDCBzAIBADB2MG \
IxETAPBgNVBAcTCE......AAAAAA== HTTP/1.1
</pre><a class="pilcrow" href="#section-4.3-4">¶</a>
</div>
<div id="cert-enrolment-resp">
<section id="section-4.3.1">
          <h4 id="name-certificate-enrolment-renewal">
<a class="section-number selfRef" href="#section-4.3.1">4.3.1. </a><a class="section-name selfRef" href="#name-certificate-enrolment-renewal">Certificate Enrolment/Renewal Response Message</a>
          </h4>
<p id="section-4.3.1-1">

If the request is granted, a CertRep SUCCESS message
(<a class="xref" href="#CertRep-success">Section 3.3.2.1</a>) is returned.  If the request is rejected, a
CertRep FAILURE message (<a class="xref" href="#CertRep-failure">Section 3.3.2.2</a>) is returned.  If
the CA is configured to manually authenticate the client, a CertRep PENDING
message (<a class="xref" href="#CertRep-pending">Section 3.3.2.3</a>) <span class="bcp14">MAY</span> be returned.  The CA <span class="bcp14">MAY</span> return
a PENDING for other reasons.<a class="pilcrow" href="#section-4.3.1-1">¶</a></p>
<p id="section-4.3.1-2">
The response will have a Content-Type of "application/x-pki-message".<a class="pilcrow" href="#section-4.3.1-2">¶</a></p>
<div id="section-4.3.1-3">
<pre class="sourcecode">"Content-Type: application/x-pki-message"

&lt;binary CertRep message&gt;
</pre><a class="pilcrow" href="#section-4.3.1-3">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="poll-resp">
<section id="section-4.4">
        <h3 id="name-poll-for-client-initial-cer">
<a class="section-number selfRef" href="#section-4.4">4.4. </a><a class="section-name selfRef" href="#name-poll-for-client-initial-cer">Poll for Client Initial Certificate</a>
        </h3>
<p id="section-4.4-1">

When the client receives a CertRep message with pkiStatus set to PENDING, it
will enter the polling state by periodically sending CertPoll messages to the
CA until either the request is granted and the certificate is sent back or the
request is rejected or some preconfigured time limit for polling or maximum
number of polls is exceeded.  The OPERATION <span class="bcp14">MUST</span> be set to "PKIOperation".<a class="pilcrow" href="#section-4.4-1">¶</a></p>
<p id="section-4.4-2">

CertPoll messages exchanged during the polling period <span class="bcp14">MUST</span> carry the same
transactionID attribute as the previous PKCSReq/RenewalReq.  A CA receiving a
CertPoll for which it does not have a matching PKCSReq/RenewalReq <span class="bcp14">MUST</span> reject
this request.<a class="pilcrow" href="#section-4.4-2">¶</a></p>
<p id="section-4.4-3">

Since at this time the certificate has not been issued, the client can only
use its own subject name (which was contained in the original PKCS# 10 sent
via PKCSReq/RenewalReq) to identify the polled certificate request (but see
the note on identification during polling in <a class="xref" href="#CertPoll">Section 3.3.3</a>).  In
theory, there can be multiple outstanding requests from one client (for
example, if different keys and different key usages were used to request
multiple certificates), so the transactionID must also be included to
disambiguate between multiple requests.  In practice, however, the client <span class="bcp14">SHOULD NOT</span> have multiple requests outstanding at any one time, since this tends to
confuse some CAs.<a class="pilcrow" href="#section-4.4-3">¶</a></p>
<div id="poll-resp-format">
<section id="section-4.4.1">
          <h4 id="name-polling-response-message-fo">
<a class="section-number selfRef" href="#section-4.4.1">4.4.1. </a><a class="section-name selfRef" href="#name-polling-response-message-fo">Polling Response Message Format</a>
          </h4>
<p id="section-4.4.1-1">

The response messages for CertPoll are the same as in <a class="xref" href="#cert-enrolment-resp">Section 4.3.1</a>.<a class="pilcrow" href="#section-4.4.1-1">¶</a></p>
</section>
</div>
</section>
</div>
<div id="cert-access">
<section id="section-4.5">
        <h3 id="name-certificate-access-2">
<a class="section-number selfRef" href="#section-4.5">4.5. </a><a class="section-name selfRef" href="#name-certificate-access-2">Certificate Access</a>
        </h3>
<p id="section-4.5-1">

A client can query an issued certificate from the SCEP CA, as long as the
client knows the issuer name and the issuer-assigned certificate serial
number.<a class="pilcrow" href="#section-4.5-1">¶</a></p>
<p id="section-4.5-2">

This transaction consists of one GetCert (<a class="xref" href="#GetCertCRL">Section 3.3.4</a>) message
sent to the CA by a client and one CertRep (<a class="xref" href="#CertRep">Section 3.3.2</a>) message
sent back from the CA.  The OPERATION <span class="bcp14">MUST</span> be set to "PKIOperation".<a class="pilcrow" href="#section-4.5-2">¶</a></p>
<div id="cert-access-resp">
<section id="section-4.5.1">
          <h4 id="name-certificate-access-response">
<a class="section-number selfRef" href="#section-4.5.1">4.5.1. </a><a class="section-name selfRef" href="#name-certificate-access-response">Certificate Access Response Message Format</a>
          </h4>
<p id="section-4.5.1-1">

In this case, the CertRep from the CA is same as in <a class="xref" href="#cert-enrolment-resp">Section 4.3.1</a>, except that the CA will either grant the
request (SUCCESS) or reject it (FAILURE).<a class="pilcrow" href="#section-4.5.1-1">¶</a></p>
</section>
</div>
</section>
</div>
<div id="CRL-access">
<section id="section-4.6">
        <h3 id="name-crl-access-2">
<a class="section-number selfRef" href="#section-4.6">4.6. </a><a class="section-name selfRef" href="#name-crl-access-2">CRL Access</a>
        </h3>
<p id="section-4.6-1">

Clients can request a CRL from the SCEP CA, as described in <a class="xref" href="#overview-CRL-access">Section 2.7</a>.  The OPERATION
<span class="bcp14">MUST</span> be set to "PKIOperation".<a class="pilcrow" href="#section-4.6-1">¶</a></p>
<div id="CRL-access-resp">
<section id="section-4.6.1">
          <h4 id="name-crl-access-response-message">
<a class="section-number selfRef" href="#section-4.6.1">4.6.1. </a><a class="section-name selfRef" href="#name-crl-access-response-message">CRL Access Response Message Format</a>
          </h4>
<p id="section-4.6.1-1">

The CRL is sent back to the client in a CertRep (<a class="xref" href="#CertRep">Section 3.3.2</a>)
message.  The information portion of this message is a degenerate
certificates-only SignedData (<a class="xref" href="#certs-only">Section 3.4</a>) that contains only
the most recent CRL in the crls field of the SignedData.<a class="pilcrow" href="#section-4.6.1-1">¶</a></p>
</section>
</div>
</section>
</div>
<div id="get-next-CA">
<section id="section-4.7">
        <h3 id="name-get-next-certificate-author">
<a class="section-number selfRef" href="#section-4.7">4.7. </a><a class="section-name selfRef" href="#name-get-next-certificate-author">Get Next Certificate Authority Certificate</a>
        </h3>
<p id="section-4.7-1">

When a CA certificate is about to expire, clients need to retrieve the CA's
next CA certificate (i.e., the rollover certificate). This is done via the
GetNextCACert message.  The OPERATION <span class="bcp14">MUST</span> be set to "GetNextCACert".  There
is no request data associated with this message.<a class="pilcrow" href="#section-4.7-1">¶</a></p>
<div id="get-next-CA-format">
<section id="section-4.7.1">
          <h4 id="name-get-next-ca-response-messag">
<a class="section-number selfRef" href="#section-4.7.1">4.7.1. </a><a class="section-name selfRef" href="#name-get-next-ca-response-messag">Get Next CA Response Message Format</a>
          </h4>
<p id="section-4.7.1-1">

The response consists of a SignedData CMS message, signed by the current CA
signing key.  Clients <span class="bcp14">MUST</span> validate the signature on the message before
trusting any of its contents.  The response will have a Content-Type of
"application/x-x509-next-ca-cert".<a class="pilcrow" href="#section-4.7.1-1">¶</a></p>
<div id="section-4.7.1-2">
<pre class="sourcecode">"Content-Type: application/x-x509-next-ca-cert"

&lt;binary CMS&gt;
</pre><a class="pilcrow" href="#section-4.7.1-2">¶</a>
</div>
<p id="section-4.7.1-3">

The content of the SignedData message is a degenerate certificates-only
SignedData message (<a class="xref" href="#certs-only">Section 3.4</a>) containing the new CA
certificate(s) to be used when the current CA certificate expires.<a class="pilcrow" href="#section-4.7.1-3">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="state-trans">
<section id="section-5">
      <h2 id="name-scep-transaction-examples">
<a class="section-number selfRef" href="#section-5">5. </a><a class="section-name selfRef" href="#name-scep-transaction-examples">SCEP Transaction Examples</a>
      </h2>
<p id="section-5-1">

The following section gives several examples of client-to-CA transactions.
Client actions are indicated in the left column, CA actions are indicated in
the right column, and the transactionID is given in parentheses. For ease of
reading, small integer values have been used; in practice, full transaction IDs
would be used.  The first transaction, for example, would read like this:<a class="pilcrow" href="#section-5-1">¶</a></p>
<blockquote id="section-5-2">
Client Sends PKCSReq message with transactionID 1 to the CA.  The CA signs
the certificate and constructs a CertRep Message containing the signed
certificate with a transaction ID 1.  The client receives the message and
installs the certificate locally.<a class="pilcrow" href="#section-5-2">¶</a>
</blockquote>
<section id="section-5.1">
        <h3 id="name-successful-transactions">
<a class="section-number selfRef" href="#section-5.1">5.1. </a><a class="section-name selfRef" href="#name-successful-transactions">Successful Transactions</a>
        </h3>
<span id="name-successful-enrolment-case-a"></span><figure id="figure-7">
          <div class="artwork art-text alignLeft" id="section-5.1-1.1">
<pre>PKCSReq (1)             ----------&gt; CA issues certificate
                        &lt;---------- CertRep (1) SUCCESS
Client installs certificate
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-7">Figure 7</a>:
<a class="selfRef" href="#name-successful-enrolment-case-a">Successful Enrolment Case: Automatic Processing</a>
          </figcaption></figure>
<span id="name-successful-enrolment-case-m"></span><figure id="figure-8">
          <div class="artwork art-text alignLeft" id="section-5.1-2.1">
<pre>PKCSReq (2)             ----------&gt; Cert request goes into queue
                        &lt;---------- CertRep (2) PENDING
CertPoll (2)            ----------&gt; Still pending
                        &lt;---------- CertRep (2) PENDING
CertPoll (2)            ----------&gt; CA issues certificate
                        &lt;---------- CertRep (2) SUCCESS
Client installs certificate
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-8">Figure 8</a>:
<a class="selfRef" href="#name-successful-enrolment-case-m">Successful Enrolment Case: Manual Authentication Required</a>
          </figcaption></figure>
<span id="name-ca-certificate-rollover-cas"></span><figure id="figure-9">
          <div class="artwork art-text alignLeft" id="section-5.1-3.1">
<pre>GetNextCACert         ----------&gt;
                      &lt;---------- New CA certificate

PKCSReq*              ----------&gt; CA issues certificate with
                                  new key
                      &lt;---------- CertRep SUCCESS
Client stores certificate
for installation when
existing certificate expires.
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-9">Figure 9</a>:
<a class="selfRef" href="#name-ca-certificate-rollover-cas">CA Certificate Rollover Case</a>
          </figcaption></figure>
<p id="section-5.1-4">* Enveloped for the new CA certificate.  The CA will use
    the envelope to determine which key to use to issue the
    client certificate.<a class="pilcrow" href="#section-5.1-4">¶</a></p>
</section>
<section id="section-5.2">
        <h3 id="name-transactions-with-errors">
<a class="section-number selfRef" href="#section-5.2">5.2. </a><a class="section-name selfRef" href="#name-transactions-with-errors">Transactions with Errors</a>
        </h3>
<p id="section-5.2-1">

In the case of polled transactions that aren't completed automatically, there
are two potential options for dealing with a transaction that's interrupted
due to network or software/hardware issues.  The first is for the client to
preserve its transaction state and resume the CertPoll polling when normal
service is restored. The second is for the client to begin a new transaction
by sending a new PKCSReq/RenewalReq, rather than continuing the previous
CertPoll.  Both options have their own advantages and disadvantages.<a class="pilcrow" href="#section-5.2-1">¶</a></p>
<p id="section-5.2-2">

The CertPoll continuation requires that the client maintain its transaction
state for the time when it resumes polling.  This is relatively simple if the
problem is a brief network outage, but less simple when the problem is a
client crash and restart.  In addition, the CA may treat a lost network
connection as the end of a transaction, so that a new connection followed by a
CertPoll will be treated as an error.<a class="pilcrow" href="#section-5.2-2">¶</a></p>
<p id="section-5.2-3">

The PKCSReq/RenewalReq continuation doesn't require any state to be maintained,
since it's a new transaction. However, it may cause problems on the CA side if
the certificate was successfully issued but the client never received it,
since the resumed transaction attempt will appear to be a request for a
duplicate certificate (see <a class="xref" href="#security-no-conf">Section 7.4</a> for more on why
this is a problem).  In this case, the CA may refuse the transaction or
require manual intervention to remove/revoke the previous certificate before
the client can request another one.<a class="pilcrow" href="#section-5.2-3">¶</a></p>
<p id="section-5.2-4">

Since the new-transaction resume is more robust in the presence of errors and
doesn't require special-case handling by either the client or CA, clients
<span class="bcp14">SHOULD</span> use the new-transaction option in preference to the resumed-CertPoll
option to recover from errors.<a class="pilcrow" href="#section-5.2-4">¶</a></p>
<p id="section-5.2-5">Resync Case 1: Client resyncs via new PKCSReq
 (recommended):<a class="pilcrow" href="#section-5.2-5">¶</a></p>
<span id="name-resync-case-1"></span><figure id="figure-10">
          <div class="artwork art-text alignLeft" id="section-5.2-6.1">
<pre>PKCSReq (3)           ----------&gt; Cert request goes into queue
                      &lt;---------- CertRep (3) PENDING
CertPoll (3)          ----------&gt; Still pending
                        X-------- CertRep(3) PENDING
(Network outage)
(Client reconnects)
PKCSReq (4)           ----------&gt;
                      &lt;---------- CertRep (4) PENDING
etc...
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-10">Figure 10</a>:
<a class="selfRef" href="#name-resync-case-1">Resync Case 1</a>
          </figcaption></figure>
<p id="section-5.2-7">Resync Case 2: Client resyncs via resumed CertPoll after a
 network outage (not recommended; use PKCSReq to
 resync):<a class="pilcrow" href="#section-5.2-7">¶</a></p>
<span id="name-resync-case-2"></span><figure id="figure-11">
          <div class="artwork art-text alignLeft" id="section-5.2-8.1">
<pre>PKCSReq (5)           ----------&gt; Cert request goes into queue
                      &lt;---------- CertRep (5) PENDING
CertPoll (5)          ----------&gt; Still pending
                        X-------- CertRep(5) PENDING
(Network outage)
(Client reconnects)
CertPoll (5)          ----------&gt; CA issues certificate
                      &lt;---------- CertRep (5) SUCCESS
Client installs certificate
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-11">Figure 11</a>:
<a class="selfRef" href="#name-resync-case-2">Resync Case 2</a>
          </figcaption></figure>
<p id="section-5.2-9">Resync Case 3: Special-case variation of Case 2 where the
 CertRep SUCCESS rather than the CertRep PENDING is
 lost (recommended):<a class="pilcrow" href="#section-5.2-9">¶</a></p>
<span id="name-resync-case-3"></span><figure id="figure-12">
          <div class="artwork art-text alignLeft" id="section-5.2-10.1">
<pre>PKCSReq (6)           ----------&gt; Cert request goes into queue
                      &lt;---------- CertRep (6) PENDING
CertPoll (6)          ----------&gt; Still pending
                      &lt;---------- CertRep (6) PENDING
CertPoll (6)          ----------&gt; CA issues certificate
                        X-------- CertRep(6) SUCCESS
(Network outage)
(Client reconnects)
PKCSReq (7)           ----------&gt; There is already a valid
                                  certificate with this
                                  Distinguished Name (DN).
                      &lt;---------- CertRep (7) FAILURE
                                  Admin revokes certificate
PKCSReq (8)           ----------&gt; CA issues new certificate
                      &lt;---------- CertRep (8) SUCCESS
Client installs certificate
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-12">Figure 12</a>:
<a class="selfRef" href="#name-resync-case-3">Resync Case 3</a>
          </figcaption></figure>
<p id="section-5.2-11">Resync Case 4: Special-case variation of Case 1 where the
 CertRep SUCCESS rather than the CertRep PENDING is lost
 (not recommended; use PKCSReq to resync):<a class="pilcrow" href="#section-5.2-11">¶</a></p>
<span id="name-resync-case-4"></span><figure id="figure-13">
          <div class="artwork art-text alignLeft" id="section-5.2-12.1">
<pre>PKCSReq (9)           ----------&gt; Cert request goes into queue
                      &lt;---------- CertRep (9) PENDING
CertPoll (9)          ----------&gt; Still pending
                      &lt;---------- CertRep (9) PENDING
CertPoll (9)          ----------&gt; CA issues certificate
                        X-------- CertRep(9) SIGNED CERT
(Network outage)
(Client reconnects)
CertPoll (9)          ----------&gt; Certificate already issued
                      &lt;---------- CertRep (9) SUCCESS
Client installs certificate
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-13">Figure 13</a>:
<a class="selfRef" href="#name-resync-case-4">Resync Case 4</a>
          </figcaption></figure>
<p id="section-5.2-13">

As these examples indicate, resumption from an error via a resumed CertPoll is
tricky due to the state that needs to be held by both the client and/or the
CA.  A PKCSReq/RenewalReq resume is the easiest to implement, since it's
stateless and is identical for both polled and nonpolled transactions, whereas
a CertPoll resume treats the two differently. (A nonpolled transaction is
resumed with a PKCSReq/RenewalReq; a polled transaction is resumed with a
CertPoll.)  For this reason, error recovery <span class="bcp14">SHOULD</span> be handled via a new PKCSReq
rather than a resumed CertPoll.<a class="pilcrow" href="#section-5.2-13">¶</a></p>
</section>
</section>
</div>
<div id="iana">
<section id="section-6">
      <h2 id="name-iana-considerations">
<a class="section-number selfRef" href="#section-6">6. </a><a class="section-name selfRef" href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<p id="section-6-1">
An object identifier for an arc to assign SCEP Attribute Identifiers has been
assigned in the "SMI Security for PKIX" registry (1.3.6.1.5.5.7).  This object
identifer, Simple Certificate Enrollment Protocol Attributes, is denoted as
id-scep:<a class="pilcrow" href="#section-6-1">¶</a></p>
<div id="section-6-2">
<pre class="sourcecode">id-scep OBJECT IDENTIFIER ::= { id-pkix 24 }
</pre><a class="pilcrow" href="#section-6-2">¶</a>
</div>
<p id="section-6-3">
IANA created the "SMI Security for SCEP Attribute Identifiers" registry
(1.3.6.1.5.5.7.24) with the following entries with references to
this document:<a class="pilcrow" href="#section-6-3">¶</a></p>
<div id="section-6-4">
<pre class="sourcecode">id-scep-failInfoText OBJECT IDENTIFIER ::= { id-scep 1 }
</pre><a class="pilcrow" href="#section-6-4">¶</a>
</div>
<p id="section-6-5">
Entries in the registry are assigned according to the "Specification Required"
policy defined in <span>[<a class="xref" href="#RFC8126">RFC8126</a>]</span>.<a class="pilcrow" href="#section-6-5">¶</a></p>
<p id="section-6-6">
<a class="xref" href="#messageType">Section 3.2.1.2</a> describes an "SCEP Message Type" registry, and
<a class="xref" href="#CA-caps">Section 3.5</a> describes an "SCEP CA Capabilities"
registry; these registries are maintained by IANA and define a number of such
code-point identifiers. Entries in the registry are assigned according
to the "Specification Required" policy defined in <span>[<a class="xref" href="#RFC8126">RFC8126</a>]</span>.<a class="pilcrow" href="#section-6-6">¶</a></p>
<p id="section-6-7">
The "SCEP Message Types" registry has "Value", "Name", "Description", and
"Reference" columns.  The "Value" entry is a small positive integer; value
"0" is reserved.<a class="pilcrow" href="#section-6-7">¶</a></p>
<p id="section-6-8">
The "SCEP CA Capabilities" registry has "Keyword", "Description", and
"Reference" columns.  Although implementations <span class="bcp14">SHOULD</span> use the "SCEP CA Capabilities"
registry, SCEP is often employed in situations where this isn't possible.  In
this case, private-use CA capabilities may be specified using a unique prefix
such as an organisation identifier or domain name under the control of the
entity that defines the capability.  For example, the prefix would be
"Example.com-", and the complete capability would be
"Example.com-CapabilityName".<a class="pilcrow" href="#section-6-8">¶</a></p>
<p id="section-6-9">
IANA has registered four media types as defined in this document:<a class="pilcrow" href="#section-6-9">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6-10.1">application/x-x509-ca-cert<a class="pilcrow" href="#section-6-10.1">¶</a>
</li>
        <li class="normal" id="section-6-10.2">application/x-x509-ca-ra-cert<a class="pilcrow" href="#section-6-10.2">¶</a>
</li>
        <li class="normal" id="section-6-10.3">application/x-x509-next-ca-cert<a class="pilcrow" href="#section-6-10.3">¶</a>
</li>
        <li class="normal" id="section-6-10.4">application/x-pki-message<a class="pilcrow" href="#section-6-10.4">¶</a>
</li>
      </ul>
<p id="section-6-11">
Note that these are grandfathered media types registered as per <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc6838#appendix-A">Appendix A</a> of [<a class="xref" href="#RFC6838">RFC6838</a>]</span>.  Templates
for registrations are specified below.<a class="pilcrow" href="#section-6-11">¶</a></p>
<section id="section-6.1">
        <h3 id="name-registration-of-the-applica">
<a class="section-number selfRef" href="#section-6.1">6.1. </a><a class="section-name selfRef" href="#name-registration-of-the-applica">Registration of the application/x-x509-ca-cert Media Type</a>
        </h3>
<span class="break"></span><dl class="dlParallel" id="section-6.1-1">
          <dt id="section-6.1-1.1">Type name:</dt>
          <dd id="section-6.1-1.2" style="margin-left: 1.5em">application<a class="pilcrow" href="#section-6.1-1.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-1.3">Subtype name:</dt>
          <dd id="section-6.1-1.4" style="margin-left: 1.5em">x-x509-ca-cert<a class="pilcrow" href="#section-6.1-1.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-1.5">Required parameters:</dt>
          <dd id="section-6.1-1.6" style="margin-left: 1.5em">none<a class="pilcrow" href="#section-6.1-1.6">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-1.7">Optional parameters:</dt>
          <dd id="section-6.1-1.8" style="margin-left: 1.5em">none<a class="pilcrow" href="#section-6.1-1.8">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-1.9">Encoding considerations:</dt>
          <dd id="section-6.1-1.10" style="margin-left: 1.5em">binary<a class="pilcrow" href="#section-6.1-1.10">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-1.11">Security considerations:</dt>
          <dd id="section-6.1-1.12" style="margin-left: 1.5em">This media type contains a certificate; see the
Security Considerations section of <span>[<a class="xref" href="#RFC5280">RFC5280</a>]</span>. There is no executable content.<a class="pilcrow" href="#section-6.1-1.12">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-1.13">Interoperability considerations:</dt>
          <dd id="section-6.1-1.14" style="margin-left: 1.5em">This is a grandfathered registration of an alias to application/pkix-cert
(basically a single DER-encoded Certification Authority certificate), which is
only used in SCEP.<a class="pilcrow" href="#section-6.1-1.14">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-1.15">Published specification:</dt>
          <dd id="section-6.1-1.16" style="margin-left: 1.5em">RFC 8894<a class="pilcrow" href="#section-6.1-1.16">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-1.17">Applications that use this media type:</dt>
          <dd id="section-6.1-1.18" style="margin-left: 1.5em">SCEP uses this media type when returning a CA certificate.<a class="pilcrow" href="#section-6.1-1.18">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-1.19">Fragment identifier considerations:</dt>
          <dd id="section-6.1-1.20" style="margin-left: 1.5em">N/A<a class="pilcrow" href="#section-6.1-1.20">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-1.21">Additional information:</dt>
          <dd id="section-6.1-1.22" style="margin-left: 1.5em">
            <p id="section-6.1-1.22.1"><br/></p>
<span class="break"></span><dl class="dlParallel" id="section-6.1-1.22.2">
              <dt id="section-6.1-1.22.2.1">Deprecated alias names for this type:</dt>
              <dd id="section-6.1-1.22.2.2" style="margin-left: 1.5em">N/A<a class="pilcrow" href="#section-6.1-1.22.2.2">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-6.1-1.22.2.3">Magic number(s):</dt>
              <dd id="section-6.1-1.22.2.4" style="margin-left: 1.5em">none<a class="pilcrow" href="#section-6.1-1.22.2.4">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-6.1-1.22.2.5">File extension(s):</dt>
              <dd id="section-6.1-1.22.2.6" style="margin-left: 1.5em">N/A<a class="pilcrow" href="#section-6.1-1.22.2.6">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-6.1-1.22.2.7">Macintosh file type code(s):</dt>
              <dd id="section-6.1-1.22.2.8" style="margin-left: 1.5em">N/A<a class="pilcrow" href="#section-6.1-1.22.2.8">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-1.23">Person and email address to contact for further information:</dt>
          <dd id="section-6.1-1.24" style="margin-left: 1.5em">See the Authors' Addresses section of RFC 8894.<a class="pilcrow" href="#section-6.1-1.24">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-1.25">Intended usage:</dt>
          <dd id="section-6.1-1.26" style="margin-left: 1.5em">LIMITED USE<a class="pilcrow" href="#section-6.1-1.26">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-1.27">Restrictions on usage:</dt>
          <dd id="section-6.1-1.28" style="margin-left: 1.5em">SCEP protocol<a class="pilcrow" href="#section-6.1-1.28">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-1.29">Author:</dt>
          <dd id="section-6.1-1.30" style="margin-left: 1.5em">See the Authors' Addresses section of RFC 8894<a class="pilcrow" href="#section-6.1-1.30">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-1.31">Change controller:</dt>
          <dd id="section-6.1-1.32" style="margin-left: 1.5em">IETF<a class="pilcrow" href="#section-6.1-1.32">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-1.33">Provisional registration?</dt>
          <dd id="section-6.1-1.34" style="margin-left: 1.5em">No<a class="pilcrow" href="#section-6.1-1.34">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
<section id="section-6.2">
        <h3 id="name-registration-of-the-applicat">
<a class="section-number selfRef" href="#section-6.2">6.2. </a><a class="section-name selfRef" href="#name-registration-of-the-applicat">Registration of the application/x-x509-ca-ra-cert Media Type</a>
        </h3>
<span class="break"></span><dl class="dlParallel" id="section-6.2-1">
          <dt id="section-6.2-1.1">Type name:</dt>
          <dd id="section-6.2-1.2" style="margin-left: 1.5em">application<a class="pilcrow" href="#section-6.2-1.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-1.3">Subtype name:</dt>
          <dd id="section-6.2-1.4" style="margin-left: 1.5em">x-x509-ca-ra-cert<a class="pilcrow" href="#section-6.2-1.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-1.5">Required parameters:</dt>
          <dd id="section-6.2-1.6" style="margin-left: 1.5em">none<a class="pilcrow" href="#section-6.2-1.6">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-1.7">Optional parameters:</dt>
          <dd id="section-6.2-1.8" style="margin-left: 1.5em">none<a class="pilcrow" href="#section-6.2-1.8">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-1.9">Encoding considerations:</dt>
          <dd id="section-6.2-1.10" style="margin-left: 1.5em">binary<a class="pilcrow" href="#section-6.2-1.10">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-1.11">Security considerations:</dt>
          <dd id="section-6.2-1.12" style="margin-left: 1.5em">This media type consists of a degenerate
certificates-only CMS SignedData message (<a class="xref" href="#certs-only">Section 3.4</a>) containing the certificates, with the intermediate CA
certificate(s) as the leaf certificate(s). There is no executable
content.<a class="pilcrow" href="#section-6.2-1.12">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-1.13">Interoperability considerations:</dt>
          <dd id="section-6.2-1.14" style="margin-left: 1.5em">This is a grandfathered registration that is only used in SCEP.<a class="pilcrow" href="#section-6.2-1.14">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-1.15">Published specification:</dt>
          <dd id="section-6.2-1.16" style="margin-left: 1.5em">RFC 8894<a class="pilcrow" href="#section-6.2-1.16">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-1.17">Applications that use this media type:</dt>
          <dd id="section-6.2-1.18" style="margin-left: 1.5em">SCEP uses this media type when returning CA Certificate Chain
Response.<a class="pilcrow" href="#section-6.2-1.18">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-1.19">Fragment identifier considerations:</dt>
          <dd id="section-6.2-1.20" style="margin-left: 1.5em">N/A<a class="pilcrow" href="#section-6.2-1.20">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-1.21">Additional information:</dt>
          <dd id="section-6.2-1.22" style="margin-left: 1.5em">
            <p id="section-6.2-1.22.1"><br/></p>
<span class="break"></span><dl class="dlParallel" id="section-6.2-1.22.2">
              <dt id="section-6.2-1.22.2.1">Deprecated alias names for this type:</dt>
              <dd id="section-6.2-1.22.2.2" style="margin-left: 1.5em">N/A<a class="pilcrow" href="#section-6.2-1.22.2.2">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-6.2-1.22.2.3">Magic number(s):</dt>
              <dd id="section-6.2-1.22.2.4" style="margin-left: 1.5em">none<a class="pilcrow" href="#section-6.2-1.22.2.4">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-6.2-1.22.2.5">File extension(s):</dt>
              <dd id="section-6.2-1.22.2.6" style="margin-left: 1.5em">N/A<a class="pilcrow" href="#section-6.2-1.22.2.6">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-6.2-1.22.2.7">Macintosh file type code(s):</dt>
              <dd id="section-6.2-1.22.2.8" style="margin-left: 1.5em">N/A<a class="pilcrow" href="#section-6.2-1.22.2.8">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-1.23">Person and email address to contact for further information:</dt>
          <dd id="section-6.2-1.24" style="margin-left: 1.5em">See the Authors' Addresses section of RFC 8894.<a class="pilcrow" href="#section-6.2-1.24">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-1.25">Intended usage:</dt>
          <dd id="section-6.2-1.26" style="margin-left: 1.5em">LIMITED USE<a class="pilcrow" href="#section-6.2-1.26">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-1.27">Restrictions on usage:</dt>
          <dd id="section-6.2-1.28" style="margin-left: 1.5em">SCEP protocol<a class="pilcrow" href="#section-6.2-1.28">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-1.29">Author:</dt>
          <dd id="section-6.2-1.30" style="margin-left: 1.5em">See the Authors' Addresses section of RFC 8894.<a class="pilcrow" href="#section-6.2-1.30">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-1.31">Change controller:</dt>
          <dd id="section-6.2-1.32" style="margin-left: 1.5em">IETF<a class="pilcrow" href="#section-6.2-1.32">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-1.33">Provisional registration?</dt>
          <dd id="section-6.2-1.34" style="margin-left: 1.5em">no<a class="pilcrow" href="#section-6.2-1.34">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
<section id="section-6.3">
        <h3 id="name-registration-of-the-applicati">
<a class="section-number selfRef" href="#section-6.3">6.3. </a><a class="section-name selfRef" href="#name-registration-of-the-applicati">Registration of the application/x-x509-next-ca-cert Media Type</a>
        </h3>
<span class="break"></span><dl class="dlParallel" id="section-6.3-1">
          <dt id="section-6.3-1.1">Type name:</dt>
          <dd id="section-6.3-1.2" style="margin-left: 1.5em">application<a class="pilcrow" href="#section-6.3-1.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.3-1.3">Subtype name:</dt>
          <dd id="section-6.3-1.4" style="margin-left: 1.5em">x-x509-next-ca-cert<a class="pilcrow" href="#section-6.3-1.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.3-1.5">Required parameters:</dt>
          <dd id="section-6.3-1.6" style="margin-left: 1.5em">none<a class="pilcrow" href="#section-6.3-1.6">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.3-1.7">Optional parameters:</dt>
          <dd id="section-6.3-1.8" style="margin-left: 1.5em">none<a class="pilcrow" href="#section-6.3-1.8">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.3-1.9">Encoding considerations:</dt>
          <dd id="section-6.3-1.10" style="margin-left: 1.5em">binary<a class="pilcrow" href="#section-6.3-1.10">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.3-1.11">Security considerations:</dt>
          <dd id="section-6.3-1.12" style="margin-left: 1.5em">This media type consists of a SignedData CMS message, signed by the
current CA signing key. There is no executable content.<a class="pilcrow" href="#section-6.3-1.12">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.3-1.13">Interoperability considerations:</dt>
          <dd id="section-6.3-1.14" style="margin-left: 1.5em">This is a grandfathered registration that is only used in SCEP.<a class="pilcrow" href="#section-6.3-1.14">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.3-1.15">Published specification:</dt>
          <dd id="section-6.3-1.16" style="margin-left: 1.5em">RFC 8894<a class="pilcrow" href="#section-6.3-1.16">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.3-1.17">Applications that use this media type:</dt>
          <dd id="section-6.3-1.18" style="margin-left: 1.5em">SCEP uses this media type when returning a Get Next CA response.<a class="pilcrow" href="#section-6.3-1.18">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.3-1.19">Fragment identifier considerations:</dt>
          <dd id="section-6.3-1.20" style="margin-left: 1.5em">N/A<a class="pilcrow" href="#section-6.3-1.20">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.3-1.21">Additional information:</dt>
          <dd id="section-6.3-1.22" style="margin-left: 1.5em">
            <p id="section-6.3-1.22.1"><br/></p>
<span class="break"></span><dl class="dlParallel" id="section-6.3-1.22.2">
              <dt id="section-6.3-1.22.2.1">Deprecated alias names for this type:</dt>
              <dd id="section-6.3-1.22.2.2" style="margin-left: 1.5em">N/A<a class="pilcrow" href="#section-6.3-1.22.2.2">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-6.3-1.22.2.3">Magic number(s):</dt>
              <dd id="section-6.3-1.22.2.4" style="margin-left: 1.5em">none<a class="pilcrow" href="#section-6.3-1.22.2.4">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-6.3-1.22.2.5">File extension(s):</dt>
              <dd id="section-6.3-1.22.2.6" style="margin-left: 1.5em">N/A<a class="pilcrow" href="#section-6.3-1.22.2.6">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-6.3-1.22.2.7">Macintosh file type code(s):</dt>
              <dd id="section-6.3-1.22.2.8" style="margin-left: 1.5em">N/A<a class="pilcrow" href="#section-6.3-1.22.2.8">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</dd>
          <dd class="break"></dd>
<dt id="section-6.3-1.23">Person and email address to contact for further information:</dt>
          <dd id="section-6.3-1.24" style="margin-left: 1.5em">See the Authors' Addresses section of RFC 8894.<a class="pilcrow" href="#section-6.3-1.24">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.3-1.25">Intended usage:</dt>
          <dd id="section-6.3-1.26" style="margin-left: 1.5em">LIMITED USE<a class="pilcrow" href="#section-6.3-1.26">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.3-1.27">Restrictions on usage:</dt>
          <dd id="section-6.3-1.28" style="margin-left: 1.5em">SCEP protocol<a class="pilcrow" href="#section-6.3-1.28">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.3-1.29">Author:</dt>
          <dd id="section-6.3-1.30" style="margin-left: 1.5em">See the Authors' Addresses section of RFC 8894.<a class="pilcrow" href="#section-6.3-1.30">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.3-1.31">Change controller:</dt>
          <dd id="section-6.3-1.32" style="margin-left: 1.5em">IETF<a class="pilcrow" href="#section-6.3-1.32">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.3-1.33">Provisional registration?</dt>
          <dd id="section-6.3-1.34" style="margin-left: 1.5em">no<a class="pilcrow" href="#section-6.3-1.34">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
<section id="section-6.4">
        <h3 id="name-registration-of-the-applicatio">
<a class="section-number selfRef" href="#section-6.4">6.4. </a><a class="section-name selfRef" href="#name-registration-of-the-applicatio">Registration of the application/x-pki-message Media Type</a>
        </h3>
<span class="break"></span><dl class="dlParallel" id="section-6.4-1">
          <dt id="section-6.4-1.1">Type name:</dt>
          <dd id="section-6.4-1.2" style="margin-left: 1.5em">application<a class="pilcrow" href="#section-6.4-1.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.4-1.3">Subtype name:</dt>
          <dd id="section-6.4-1.4" style="margin-left: 1.5em">x-pki-message<a class="pilcrow" href="#section-6.4-1.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.4-1.5">Required parameters:</dt>
          <dd id="section-6.4-1.6" style="margin-left: 1.5em">none<a class="pilcrow" href="#section-6.4-1.6">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.4-1.7">Optional parameters:</dt>
          <dd id="section-6.4-1.8" style="margin-left: 1.5em">none<a class="pilcrow" href="#section-6.4-1.8">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.4-1.9">Encoding considerations:</dt>
          <dd id="section-6.4-1.10" style="margin-left: 1.5em">binary<a class="pilcrow" href="#section-6.4-1.10">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.4-1.11">Security considerations:</dt>
          <dd id="section-6.4-1.12" style="margin-left: 1.5em">This media type consists of a degenerate certificates-only CMS SignedData
message. There is no executable content.<a class="pilcrow" href="#section-6.4-1.12">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.4-1.13">Interoperability considerations:</dt>
          <dd id="section-6.4-1.14" style="margin-left: 1.5em">This is a grandfathered registration that is only used in SCEP.<a class="pilcrow" href="#section-6.4-1.14">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.4-1.15">Published specification:</dt>
          <dd id="section-6.4-1.16" style="margin-left: 1.5em">RFC 8894<a class="pilcrow" href="#section-6.4-1.16">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.4-1.17">Applications that use this media type:</dt>
          <dd id="section-6.4-1.18" style="margin-left: 1.5em">SCEP uses this media type when returning a Certificate Enrolment/Renewal
Response.<a class="pilcrow" href="#section-6.4-1.18">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.4-1.19">Fragment identifier considerations:</dt>
          <dd id="section-6.4-1.20" style="margin-left: 1.5em">N/A<a class="pilcrow" href="#section-6.4-1.20">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.4-1.21">Additional information:</dt>
          <dd id="section-6.4-1.22" style="margin-left: 1.5em">
            <p id="section-6.4-1.22.1"><br/></p>
<span class="break"></span><dl class="dlParallel" id="section-6.4-1.22.2">
              <dt id="section-6.4-1.22.2.1">Deprecated alias names for this type:</dt>
              <dd id="section-6.4-1.22.2.2" style="margin-left: 1.5em">N/A<a class="pilcrow" href="#section-6.4-1.22.2.2">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-6.4-1.22.2.3">Magic number(s):</dt>
              <dd id="section-6.4-1.22.2.4" style="margin-left: 1.5em">none<a class="pilcrow" href="#section-6.4-1.22.2.4">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-6.4-1.22.2.5">File extension(s):</dt>
              <dd id="section-6.4-1.22.2.6" style="margin-left: 1.5em">N/A<a class="pilcrow" href="#section-6.4-1.22.2.6">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-6.4-1.22.2.7">Macintosh file type code(s):</dt>
              <dd id="section-6.4-1.22.2.8" style="margin-left: 1.5em">N/A<a class="pilcrow" href="#section-6.4-1.22.2.8">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</dd>
          <dd class="break"></dd>
<dt id="section-6.4-1.23">Person and email address to contact for further information:</dt>
          <dd id="section-6.4-1.24" style="margin-left: 1.5em">See the Authors' Addresses section of RFC 8894.<a class="pilcrow" href="#section-6.4-1.24">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.4-1.25">Intended usage:</dt>
          <dd id="section-6.4-1.26" style="margin-left: 1.5em">LIMITED USE<a class="pilcrow" href="#section-6.4-1.26">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.4-1.27">Restrictions on usage:</dt>
          <dd id="section-6.4-1.28" style="margin-left: 1.5em">SCEP protocol<a class="pilcrow" href="#section-6.4-1.28">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.4-1.29">Author:</dt>
          <dd id="section-6.4-1.30" style="margin-left: 1.5em">See the Authors' Addresses section of RFC 8894.<a class="pilcrow" href="#section-6.4-1.30">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.4-1.31">Change controller:</dt>
          <dd id="section-6.4-1.32" style="margin-left: 1.5em">IETF<a class="pilcrow" href="#section-6.4-1.32">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.4-1.33">Provisional registration?</dt>
          <dd id="section-6.4-1.34" style="margin-left: 1.5em">no<a class="pilcrow" href="#section-6.4-1.34">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</section>
</div>
<div id="security">
<section id="section-7">
      <h2 id="name-security-considerations">
<a class="section-number selfRef" href="#section-7">7. </a><a class="section-name selfRef" href="#name-security-considerations">Security Considerations</a>
      </h2>
<p id="section-7-1">
The security goal of SCEP is that no adversary can subvert the public
key/identity binding from that intended.  An adversary is any entity other
than the client and the CA participating in the protocol.<a class="pilcrow" href="#section-7-1">¶</a></p>
<p id="section-7-2">
This goal is met through the use of CMS and PKCS #10 encryption and digital
signatures using authenticated public keys.  The CA's public key is
authenticated via out-of-band means such as the checking of the CA fingerprint,
and the SCEP client's public key is authenticated through manual or preshared
secret authentication.<a class="pilcrow" href="#section-7-2">¶</a></p>
<section id="section-7.1">
        <h3 id="name-general-security">
<a class="section-number selfRef" href="#section-7.1">7.1. </a><a class="section-name selfRef" href="#name-general-security">General Security</a>
        </h3>
<p id="section-7.1-1">
Common key-management considerations such as keeping private keys truly
private and using adequate lengths for symmetric and asymmetric keys must be
followed in order to maintain the security of this protocol.  This is
especially true for CA keys which, when compromised, compromise the security
of all relying parties.<a class="pilcrow" href="#section-7.1-1">¶</a></p>
</section>
<section id="section-7.2">
        <h3 id="name-use-of-the-ca-private-key">
<a class="section-number selfRef" href="#section-7.2">7.2. </a><a class="section-name selfRef" href="#name-use-of-the-ca-private-key">Use of the CA Private Key</a>
        </h3>
<p id="section-7.2-1">
A CA private key is generally meant for, and usually flagged as, being
usable for certificate (and CRL) signing exclusively rather than data signing
or encryption.  The SCEP protocol, however, uses the CA private key to both sign
and optionally encrypt CMS transport messages.  This is generally considered
undesirable, as it widens the possibility of an implementation weakness and
provides an additional location where the private key must be used (and hence
is slightly more vulnerable to exposure) and where a side-channel attack might
be applied.<a class="pilcrow" href="#section-7.2-1">¶</a></p>
</section>
<section id="section-7.3">
        <h3 id="name-challengepassword-shared-se">
<a class="section-number selfRef" href="#section-7.3">7.3. </a><a class="section-name selfRef" href="#name-challengepassword-shared-se">ChallengePassword Shared Secret Value</a>
        </h3>
<p id="section-7.3-1">
The security measures that should be applied to the challengePassword shared
secret depend on the manner in which SCEP is employed.  In the simplest case,
with SCEP used to provision devices with certificates in the manufacturing
facility, the physical security of the facility may be enough to protect the
certificate issue process with no additional measures explicitly required.  In
general, though, the security of the issue process depends on the security
employed around the use of the challengePassword shared secret.  While it's
not possible to enumerate every situation in which SCEP may be utilised, the
following security measures should be considered.<a class="pilcrow" href="#section-7.3-1">¶</a></p>
<ul class="compact">
<li class="compact" id="section-7.3-2.1">
The challengePassword, despite its name, shouldn't be a conventional password
but a high-entropy shared-secret authentication string.  Using the base64
encoding of a keying value generated or exchanged as part of standard device
authentication protocols like the Extensible Authentication Protocol (EAP) or
DNP3 Secure Authentication (DNP3-SA) makes for a good
challengePassword.  The use of high-entropy shared secrets is particularly
important when the PasswordRecipientInfo option is used to encrypt SCEP
messages; see <a class="xref" href="#message-processing">Section 3.1</a>.<a class="pilcrow" href="#section-7.3-2.1">¶</a>
</li>
          <li class="compact" id="section-7.3-2.2">
If feasible, the challengePassword should be a one-time value used to
authenticate the issue of a single certificate (subsequent certificate
requests will be authenticated by being signed with the initial certificate).
If the challengePassword is single use, then the arrival of subsequent requests
using the same challengePassword can then be used to indicate a security
breach.<a class="pilcrow" href="#section-7.3-2.2">¶</a>
</li>
          <li class="compact" id="section-7.3-2.3">
The lifetime of a challengePassword can be limited, so that it can be used
during initial device provisioning but will have expired at a later date if an
attacker manages to compromise the challengePassword value -- for example, by
compromising the device that it's stored in.<a class="pilcrow" href="#section-7.3-2.3">¶</a>
</li>
          <li class="compact" id="section-7.3-2.4">
The CA should take appropriate measures to protect the
challengePassword. Examples of possible measures include: physical security
measures; storing it as a salted iterated hash or equivalent memory-hard
function; storing it as a keyed MAC value if it's not being used for
encryption; and storing it in encrypted form if it is being used for encryption.<a class="pilcrow" href="#section-7.3-2.4">¶</a>
</li>
        </ul>
</section>
<div id="security-no-conf">
<section id="section-7.4">
        <h3 id="name-lack-of-certificate-issue-c">
<a class="section-number selfRef" href="#section-7.4">7.4. </a><a class="section-name selfRef" href="#name-lack-of-certificate-issue-c">Lack of Certificate Issue Confirmation</a>
        </h3>
<p id="section-7.4-1">
SCEP provides no confirmation that the issued certificate was successfully
received and processed by the client.  This means that if the CertRep message
is lost or can't be processed by the client, then the CA will consider the
certificate successfully issued while the client won't.  If this situation is
of concern, then the correct issuance of the certificate will need to be
verified by out-of-band means, for example, through the client sending a
message signed by the newly issued certificate to the CA.  This also provides
the proof of possession that's not present in the case of a renewal operation;
see <a class="xref" href="#security-no-pop">Section 7.6</a>.<a class="pilcrow" href="#section-7.4-1">¶</a></p>
</section>
</div>
<div id="security-getcacaps">
<section id="section-7.5">
        <h3 id="name-getcacaps-issues">
<a class="section-number selfRef" href="#section-7.5">7.5. </a><a class="section-name selfRef" href="#name-getcacaps-issues">GetCACaps Issues</a>
        </h3>
<p id="section-7.5-1">
The GetCACaps response is not authenticated by the CA.  This allows an
attacker to perform downgrade attacks on the cryptographic capabilities of the
client/CA exchange.  In particular, if the server were to support MD5 and
single DES, then an in-path attacker could trivially roll back the encryption
to use these insecure algorithms.  By taking advantage of the presence of
large amounts of static known plaintext in the SCEP messages, as of 2017, a DES
rainbow table attack can recover most encryption keys in under a minute, and
MD5 chosen-prefix collisions can be calculated for a few tens of cents of
computing time using tools like HashClash.  It is for this reason that this
specification makes single DES and MD5 a <span class="bcp14">MUST NOT</span> feature.  Note that all
known servers support at least triple DES and SHA-1 (regardless of whether
"DES3" and "SHA-1" are indicated in GetCACaps), so there should never be a
reason to fall all the way back to single DES and MD5.<a class="pilcrow" href="#section-7.5-1">¶</a></p>
<p id="section-7.5-2">
One simple countermeasure to a GetCACaps downgrade attack is for clients that
are operating in an environment where on-path attacks are possible and that
expect the "SCEPStandard" capability to be indicated by the CA but don't see
it in the GetCACaps response to treat its absence as a security issue, and
either discontinue the exchange or continue as if "SCEPStandard" had been
returned.  This requires a certain trade-off between compatibility with old
servers and security against active attacks.<a class="pilcrow" href="#section-7.5-2">¶</a></p>
</section>
</div>
<div id="security-no-pop">
<section id="section-7.6">
        <h3 id="name-lack-of-pop-in-renewal-requ">
<a class="section-number selfRef" href="#section-7.6">7.6. </a><a class="section-name selfRef" href="#name-lack-of-pop-in-renewal-requ">Lack of PoP in Renewal Requests</a>
        </h3>
<p id="section-7.6-1">
Renewal operations (but not standard certificate-issue operations) are
processed via a previously issued certificate and its associated private key,
not the key in the PKCS #10 request.  This means that a client no longer
demonstrates proof of possession (PoP) of the private key corresponding to the
public key in the PKCS #10 request.  It is therefore possible for a client to
recertify an existing key used by a third party, so that two or more
certificates exist for the same key.  By switching out the certificate in a
signature, an attacker can appear to have a piece of data signed by their
certificate rather than the original signer's certificate.  This, and other,
attacks are described in <span><a class="xref" href="#RFC2634">S/MIME ESS</a> [<a class="xref" href="#RFC2634">RFC2634</a>]</span>.<a class="pilcrow" href="#section-7.6-1">¶</a></p>
<p id="section-7.6-2">
Avoiding these types of attacks requires situation-specific measures.  For
example, CMS/SMIME implementations may use the ESSCertID attribute from <span><a class="xref" href="#RFC2634">S/MIME ESS</a> [<a class="xref" href="#RFC2634">RFC2634</a>]</span> or its successor, <span><a class="xref" href="#RFC5035">S/MIME
ESSv2</a> [<a class="xref" href="#RFC5035">RFC5035</a>]</span>, to unambiguously identify the signing certificate.  However, since
other mechanisms and protocols that the certificates will be used with
typically don't defend against this problem, it's unclear whether this is an
actual issue with SCEP.<a class="pilcrow" href="#section-7.6-2">¶</a></p>
</section>
</div>
<div id="traffic-monitoring">
<section id="section-7.7">
        <h3 id="name-traffic-monitoring">
<a class="section-number selfRef" href="#section-7.7">7.7. </a><a class="section-name selfRef" href="#name-traffic-monitoring">Traffic Monitoring</a>
        </h3>
<p id="section-7.7-1">
SCEP messages are signed with certificates that may contain identifying
information.  If these are sent over the public Internet and real identity
information (rather than placeholder values or arbitrary device IDs) is
included in the signing certificate data, an attacker may be able to monitor
the identities of the entities submitting the certificate requests.  If this
is an issue, then <span>[<a class="xref" href="#RFC7258">RFC7258</a>]</span> should be consulted for guidance.<a class="pilcrow" href="#section-7.7-1">¶</a></p>
</section>
</div>
<div id="security-unnecessary">
<section id="section-7.8">
        <h3 id="name-unnecessary-cryptography">
<a class="section-number selfRef" href="#section-7.8">7.8. </a><a class="section-name selfRef" href="#name-unnecessary-cryptography">Unnecessary Cryptography</a>
        </h3>
<p id="section-7.8-1">
Some of the SCEP exchanges use unnecessary signing and encryption operations.
In particular, the GetCert and GetCRL exchanges are encrypted and signed in
both directions.  The information requested is public, and thus encrypting the
requests is of questionable value.  In addition, CRLs and certificates sent in
responses are already signed by the CA and can be verified by the recipient
without requiring additional signing and encryption.  More lightweight means
of retrieving certificates and CRLs such as <span><a class="xref" href="#RFC4387">HTTP
certificate-store access</a> [<a class="xref" href="#RFC4387">RFC4387</a>]</span> and LDAP are recommended for this reason.<a class="pilcrow" href="#section-7.8-1">¶</a></p>
</section>
</div>
<div id="security-sha1">
<section id="section-7.9">
        <h3 id="name-use-of-sha-1">
<a class="section-number selfRef" href="#section-7.9">7.9. </a><a class="section-name selfRef" href="#name-use-of-sha-1">Use of SHA-1</a>
        </h3>
<p id="section-7.9-1">
The majority of the large number of devices that use SCEP today default to
SHA-1, with many supporting only that hash algorithm with no ability to
upgrade to a newer one.  SHA-1 is no longer regarded as secure in all
situations, but as used in SCEP, it's still safe.  There are three reasons for
this.  The first is that attacking SCEP would require creating a fully general
SHA-1 collision in close to real time alongside breaking AES (more
specifically, it would require creating a fully general SHA-1 collision for
the PKCS #10 request, breaking the AES encryption around the PKCS #10 request,
and then creating a second SHA-1 collision for the signature on the encrypted
data), which won't be feasible for a long time.<a class="pilcrow" href="#section-7.9-1">¶</a></p>
<p id="section-7.9-2">
The second reason is that the signature over the message -- in other words, the
SHA-1 hash that isn't protected by encryption -- doesn't serve any critical
cryptographic purpose: The PKCS #10 data itself is authenticated through its
own signature, protected by encryption, and the overall request is authorised
by the (encrypted) shared secret.  The sole exception to this will be the
small number of implementations that support the Renewal operation, which may
be authorised purely through a signature, but presumably any implementation
recent enough to support Renewal also supports SHA-2.  Any legacy
implementation that supports the historic core SCEP protocol would not be
affected.<a class="pilcrow" href="#section-7.9-2">¶</a></p>
<p id="section-7.9-3">
The third reason is that SCEP uses the same key for encryption and signing, so
that even if an attacker were able to capture an outgoing renewal request that
didn't include a shared secret (in other words, one that was only authorised
through a signature), break the AES encryption, forge the SHA-1 hash in real
time, and forward the forged request to the CA, they couldn't decrypt the
returned certificate, which is protected with the same key that was used to
generate the signature.  While <a class="xref" href="#security-unnecessary">Section 7.8</a> points
out that SCEP uses unnecessary cryptography in places, the additional level of
security provided by the extra crypto makes it immune to any issues with
SHA-1.<a class="pilcrow" href="#section-7.9-3">¶</a></p>
<p id="section-7.9-4">
This doesn't mean that SCEP implementations should continue to use SHA-1 in
perpetuity, merely that there's no need for a panicked switch to SHA-2.<a class="pilcrow" href="#section-7.9-4">¶</a></p>
</section>
</div>
<section id="section-7.10">
        <h3 id="name-use-of-http">
<a class="section-number selfRef" href="#section-7.10">7.10. </a><a class="section-name selfRef" href="#name-use-of-http">Use of HTTP</a>
        </h3>
<p id="section-7.10-1">
SCEP is an encrypted, authenticated certificate enrollment protocol that uses
HTTP as a simple transport mechanism. Since SCEP messages are already
cryptographically secured, it does not require transport layer security. Where
HTTPS is elected, a performance hit may result from the TLS overhead,
operational problems may result due to the more complex configuration, and
potential security vulnerability may result due to the addition of an entire
TLS protocol stack alongside the basic SCEP protocol.<a class="pilcrow" href="#section-7.10-1">¶</a></p>
<p id="section-7.10-2"> 
In particular, experience has shown that the issue of configuring
certificates, CAs, and trust for both TLS and SCEP often leads to
interoperability problems because different certificates and trust models are
used in each.  Use of HTTPS to authenticate the server does not enable
omission of the ChallengePassword or similar authenticator in the SCEP message
on the assumption that using HTTPS instead of HTTP will somehow make this
insecure usage secure again. HTTPS is not soy sauce for security and is
unnecessary for SCEP, which uses cryptographically secured messages and does
not require transport layer security.<a class="pilcrow" href="#section-7.10-2">¶</a></p>
</section>
</section>
</div>
<section id="section-8">
      <h2 id="name-references">
<a class="section-number selfRef" href="#section-8">8. </a><a class="section-name selfRef" href="#name-references">References</a>
      </h2>
<section id="section-8.1">
        <h3 id="name-normative-references">
<a class="section-number selfRef" href="#section-8.1">8.1. </a><a class="section-name selfRef" href="#name-normative-references">Normative References</a>
        </h3>
<dl class="references">
<dt id="AES">[AES]</dt>
        <dd>
<span class="refAuthor">Technology, U. N. I. O. S. A.</span>, <span class="refTitle">"The Advanced Encryption Standard (AES)"</span>, <span class="seriesInfo">FIPS 197</span>, <span class="seriesInfo">DOI 10.6028/NIST.FIPS.197</span>, <time class="refDate" datetime="2001-11">November 2001</time>, <span>&lt;<a href="https://doi.org/10.6028/NIST.FIPS.197">https://doi.org/10.6028/NIST.FIPS.197</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time class="refDate" datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2985">[RFC2985]</dt>
        <dd>
<span class="refAuthor">Nystrom, M.</span><span class="refAuthor"> and B. Kaliski</span>, <span class="refTitle">"PKCS #9: Selected Object Classes and Attribute Types Version 2.0"</span>, <span class="seriesInfo">RFC 2985</span>, <span class="seriesInfo">DOI 10.17487/RFC2985</span>, <time class="refDate" datetime="2000-11">November 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2985">https://www.rfc-editor.org/info/rfc2985</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2986">[RFC2986]</dt>
        <dd>
<span class="refAuthor">Nystrom, M.</span><span class="refAuthor"> and B. Kaliski</span>, <span class="refTitle">"PKCS #10: Certification Request Syntax Specification Version 1.7"</span>, <span class="seriesInfo">RFC 2986</span>, <span class="seriesInfo">DOI 10.17487/RFC2986</span>, <time class="refDate" datetime="2000-11">November 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2986">https://www.rfc-editor.org/info/rfc2986</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3986">[RFC3986]</dt>
        <dd>
<span class="refAuthor">Berners-Lee, T.</span><span class="refAuthor">, Fielding, R.</span><span class="refAuthor">, and L. Masinter</span>, <span class="refTitle">"Uniform Resource Identifier (URI): Generic Syntax"</span>, <span class="seriesInfo">STD 66</span>, <span class="seriesInfo">RFC 3986</span>, <span class="seriesInfo">DOI 10.17487/RFC3986</span>, <time class="refDate" datetime="2005-01">January 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3986">https://www.rfc-editor.org/info/rfc3986</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4648">[RFC4648]</dt>
        <dd>
<span class="refAuthor">Josefsson, S.</span>, <span class="refTitle">"The Base16, Base32, and Base64 Data Encodings"</span>, <span class="seriesInfo">RFC 4648</span>, <span class="seriesInfo">DOI 10.17487/RFC4648</span>, <time class="refDate" datetime="2006-10">October 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4648">https://www.rfc-editor.org/info/rfc4648</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5234">[RFC5234]</dt>
        <dd>
<span class="refAuthor">Crocker, D., Ed.</span><span class="refAuthor"> and P. Overell</span>, <span class="refTitle">"Augmented BNF for Syntax Specifications: ABNF"</span>, <span class="seriesInfo">STD 68</span>, <span class="seriesInfo">RFC 5234</span>, <span class="seriesInfo">DOI 10.17487/RFC5234</span>, <time class="refDate" datetime="2008-01">January 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5234">https://www.rfc-editor.org/info/rfc5234</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5280">[RFC5280]</dt>
        <dd>
<span class="refAuthor">Cooper, D.</span><span class="refAuthor">, Santesson, S.</span><span class="refAuthor">, Farrell, S.</span><span class="refAuthor">, Boeyen, S.</span><span class="refAuthor">, Housley, R.</span><span class="refAuthor">, and W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time class="refDate" datetime="2008-05">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5280">https://www.rfc-editor.org/info/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5652">[RFC5652]</dt>
        <dd>
<span class="refAuthor">Housley, R.</span>, <span class="refTitle">"Cryptographic Message Syntax (CMS)"</span>, <span class="seriesInfo">STD 70</span>, <span class="seriesInfo">RFC 5652</span>, <span class="seriesInfo">DOI 10.17487/RFC5652</span>, <time class="refDate" datetime="2009-09">September 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5652">https://www.rfc-editor.org/info/rfc5652</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6838">[RFC6838]</dt>
        <dd>
<span class="refAuthor">Freed, N.</span><span class="refAuthor">, Klensin, J.</span><span class="refAuthor">, and T. Hansen</span>, <span class="refTitle">"Media Type Specifications and Registration Procedures"</span>, <span class="seriesInfo">BCP 13</span>, <span class="seriesInfo">RFC 6838</span>, <span class="seriesInfo">DOI 10.17487/RFC6838</span>, <time class="refDate" datetime="2013-01">January 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6838">https://www.rfc-editor.org/info/rfc6838</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7230">[RFC7230]</dt>
        <dd>
<span class="refAuthor">Fielding, R., Ed.</span><span class="refAuthor"> and J. Reschke, Ed.</span>, <span class="refTitle">"Hypertext Transfer Protocol (HTTP/1.1): Message Syntax and Routing"</span>, <span class="seriesInfo">RFC 7230</span>, <span class="seriesInfo">DOI 10.17487/RFC7230</span>, <time class="refDate" datetime="2014-06">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7230">https://www.rfc-editor.org/info/rfc7230</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7258">[RFC7258]</dt>
        <dd>
<span class="refAuthor">Farrell, S.</span><span class="refAuthor"> and H. Tschofenig</span>, <span class="refTitle">"Pervasive Monitoring Is an Attack"</span>, <span class="seriesInfo">BCP 188</span>, <span class="seriesInfo">RFC 7258</span>, <span class="seriesInfo">DOI 10.17487/RFC7258</span>, <time class="refDate" datetime="2014-05">May 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7258">https://www.rfc-editor.org/info/rfc7258</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span><span class="refAuthor">, Leiba, B.</span><span class="refAuthor">, and T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time class="refDate" datetime="2017-06">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time class="refDate" datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SHA2">[SHA2]</dt>
      <dd>
<span class="refAuthor">Technology, U. N. I. O. S. A.</span>, <span class="refTitle">"Secure Hash Standard (SHS)"</span>, <span class="seriesInfo">FIPS 180-3</span>, <time class="refDate" datetime="2008-10">October 2008</time>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-8.2">
        <h3 id="name-informative-references">
<a class="section-number selfRef" href="#section-8.2">8.2. </a><a class="section-name selfRef" href="#name-informative-references">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-httpbis-bcp56bis">[HTTP]</dt>
        <dd>
<span class="refAuthor">Nottingham, M.</span>, <span class="refTitle">"Building Protocols with HTTP"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-httpbis-bcp56bis-09</span>, <time class="refDate" datetime="2019-11-01">November 1, 2019</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-httpbis-bcp56bis-09">https://tools.ietf.org/html/draft-ietf-httpbis-bcp56bis-09</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="JSCEP">[JSCEP]</dt>
        <dd>
<span class="refTitle">"A Java implementation of the Simple Certificate Enrolment Protocol"</span>, <span class="seriesInfo">commit 7410332</span>, <time class="refDate" datetime="2020-01">January 2020</time>, <span>&lt;<a href="https://github.com/jscep/jscep">https://github.com/jscep/jscep</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2634">[RFC2634]</dt>
        <dd>
<span class="refAuthor">Hoffman, P., Ed.</span>, <span class="refTitle">"Enhanced Security Services for S/MIME"</span>, <span class="seriesInfo">RFC 2634</span>, <span class="seriesInfo">DOI 10.17487/RFC2634</span>, <time class="refDate" datetime="1999-06">June 1999</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2634">https://www.rfc-editor.org/info/rfc2634</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4387">[RFC4387]</dt>
        <dd>
<span class="refAuthor">Gutmann, P., Ed.</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Operational Protocols: Certificate Store Access via HTTP"</span>, <span class="seriesInfo">RFC 4387</span>, <span class="seriesInfo">DOI 10.17487/RFC4387</span>, <time class="refDate" datetime="2006-02">February 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4387">https://www.rfc-editor.org/info/rfc4387</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5035">[RFC5035]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"Enhanced Security Services (ESS) Update: Adding CertID Algorithm Agility"</span>, <span class="seriesInfo">RFC 5035</span>, <span class="seriesInfo">DOI 10.17487/RFC5035</span>, <time class="refDate" datetime="2007-08">August 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5035">https://www.rfc-editor.org/info/rfc5035</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7296">[RFC7296]</dt>
        <dd>
<span class="refAuthor">Kaufman, C.</span><span class="refAuthor">, Hoffman, P.</span><span class="refAuthor">, Nir, Y.</span><span class="refAuthor">, Eronen, P.</span><span class="refAuthor">, and T. Kivinen</span>, <span class="refTitle">"Internet Key Exchange Protocol Version 2 (IKEv2)"</span>, <span class="seriesInfo">STD 79</span>, <span class="seriesInfo">RFC 7296</span>, <span class="seriesInfo">DOI 10.17487/RFC7296</span>, <time class="refDate" datetime="2014-10">October 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7296">https://www.rfc-editor.org/info/rfc7296</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time class="refDate" datetime="2018-08">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8551">[RFC8551]</dt>
      <dd>
<span class="refAuthor">Schaad, J.</span><span class="refAuthor">, Ramsdell, B.</span><span class="refAuthor">, and S. Turner</span>, <span class="refTitle">"Secure/Multipurpose Internet Mail Extensions (S/MIME) Version 4.0 Message Specification"</span>, <span class="seriesInfo">RFC 8551</span>, <span class="seriesInfo">DOI 10.17487/RFC8551</span>, <time class="refDate" datetime="2019-04">April 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8551">https://www.rfc-editor.org/info/rfc8551</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="background">
<section id="section-appendix.a">
      <h2 id="name-background-notes">
<a class="section-number selfRef" href="#section-appendix.a">Appendix A. </a><a class="section-name selfRef" href="#name-background-notes">Background Notes</a>
      </h2>
<p id="section-appendix.a-1">

This specification has spent over twenty years in the draft stage.  Its
original goal, provisioning IPsec routers with certificates, has long since
changed to general device/embedded system/IoT use.  To fit this role, extra
features were bolted on in a haphazard manner through the addition of a
growing list of appendices and by inserting additional, often conflicting,
paragraphs in various locations in the body text.  Since existing features
were never updated as newer ones were added, the specification accumulated
large amounts of historical baggage over time.  If OpenPGP was described as "a
museum of 1990s crypto", then the SCEP document was its graveyard.<a class="pilcrow" href="#section-appendix.a-1">¶</a></p>
<p id="section-appendix.a-2">

About five years ago, the specification, which even at that point had seen only
sporadic reposts of the existing document, was more or less abandoned by its
original sponsors.  Due to its widespread use in large segments of the
industry, the specification was rebooted in 2015, cleaning up fifteen years'
worth of accumulated cruft, fixing errors, clarifying ambiguities, and
bringing the algorithms and standards used into the current century (prior to
the update, the de facto lowest-common-denominator algorithms used for
interoperability were the insecure forty-year-old single DES and broken MD5
hash algorithms).<a class="pilcrow" href="#section-appendix.a-2">¶</a></p>
<p id="section-appendix.a-3">

Note that although the text of the current specification has changed
significantly due to the consolidation of features and appendices into the
main document, the protocol that it describes is identical on the wire to the
original (with the unavoidable exception of the switch from single DES and MD5
to AES and SHA-2).  The only two changes introduced, the "SCEPStandard"
indicator in GetCACaps and the failInfoText attribute, are both optional
values and would be ignored by older implementations that don't support them,
or can be omitted from messages if they are found to cause problems.<a class="pilcrow" href="#section-appendix.a-3">¶</a></p>
<p id="section-appendix.a-4">

Other changes include:<a class="pilcrow" href="#section-appendix.a-4">¶</a></p>
<ul class="normal">
<li class="normal" id="section-appendix.a-5.1">Resolved contradictions in the text -- for example, a requirement
 given as a <span class="bcp14">MUST</span> in one paragraph and a
 <span class="bcp14">SHOULD</span> in the next, a <span class="bcp14">MUST NOT</span>
 in one paragraph and a <span class="bcp14">MAY</span> a few paragraphs later, a
 <span class="bcp14">SHOULD NOT</span> contradicted later by a <span class="bcp14">MAY</span>, and so on.<a class="pilcrow" href="#section-appendix.a-5.1">¶</a>
</li>
        <li class="normal" id="section-appendix.a-5.2">Merged several later fragmentary addenda placed in appendices (for
 example, the handling of certificate renewal) with the body of the
 text.<a class="pilcrow" href="#section-appendix.a-5.2">¶</a>
</li>
        <li class="normal" id="section-appendix.a-5.3">Merged the "SCEP Transactions" and "SCEP Transport" sections, since the
 latter mostly duplicated (with occasional inconsistencies) the
 former.<a class="pilcrow" href="#section-appendix.a-5.3">¶</a>
</li>
        <li class="normal" id="section-appendix.a-5.4">Updated the algorithms to ones dating from at least this
 century.<a class="pilcrow" href="#section-appendix.a-5.4">¶</a>
</li>
        <li class="normal" id="section-appendix.a-5.5">Did the same for normative references to other standards.<a class="pilcrow" href="#section-appendix.a-5.5">¶</a>
</li>
        <li class="normal" id="section-appendix.a-5.6">Updated the text to use consistent terminology for the client and
 CA rather than a mixture of client, requester, requesting system, end
 entity, server, certificate authority, certification authority, and
 CA.<a class="pilcrow" href="#section-appendix.a-5.6">¶</a>
</li>
        <li class="normal" id="section-appendix.a-5.7">Corrected incorrect references to other standards, e.g.,
 IssuerAndSerial -&gt; IssuerAndSerialNumber.<a class="pilcrow" href="#section-appendix.a-5.7">¶</a>
</li>
        <li class="normal" id="section-appendix.a-5.8">Corrected errors such as a statement that when both signature and
 encryption certificates existed, the signature certificate was used
 for encryption.<a class="pilcrow" href="#section-appendix.a-5.8">¶</a>
</li>
        <li class="normal" id="section-appendix.a-5.9">Condensed redundant discussions of the same topic spread across
 multiple sections into a single location.  For example, the description
 of intermediate CA handling previously existed in three different
 locations, with slightly different requirements in each one.<a class="pilcrow" href="#section-appendix.a-5.9">¶</a>
</li>
        <li class="normal" id="section-appendix.a-5.10">Added a description of how pkiMessages were processed, which was
 never made explicit in the original specification.  This led to
 creative interpretations that had security problems but were employed
 anyway due to the lack of specific guidance on what to do.<a class="pilcrow" href="#section-appendix.a-5.10">¶</a>
</li>
        <li class="normal" id="section-appendix.a-5.11">Relaxed some requirements that didn't serve any obvious purpose and
 that major implementations didn't seem to be enforcing.  For example,
 the requirement that the self-signed certificate used with a request
 <span class="bcp14">MUST</span> contain a subject name that matched the one in the PKCS #10
 request was relaxed to a <span class="bcp14">SHOULD</span>, because a number of implementations
 either ignored the issue entirely or at worst performed some minor
 action like creating a log entry, after which they continued
 anyway.<a class="pilcrow" href="#section-appendix.a-5.11">¶</a>
</li>
        <li class="normal" id="section-appendix.a-5.12">Removed discussion of the transactionID from the security
 considerations, since the instructions there were directly
 contradicted by the discussion of the use of the transactionID in
 <a class="xref" href="#state-trans">Section 5</a>.<a class="pilcrow" href="#section-appendix.a-5.12">¶</a>
</li>
        <li class="normal" id="section-appendix.a-5.13">Added a requirement that the signed message include the signing
 certificate(s) in the signedData certificates field.  This was
 implicit in the original specification (without it, the message
 couldn't be verified by the CA) and was handled by the fact that most
 PKCS #7/CMS libraries do this by default, but was never explicitly
 mentioned.<a class="pilcrow" href="#section-appendix.a-5.13">¶</a>
</li>
        <li class="normal" id="section-appendix.a-5.14">Clarified sections that were unclear or even made no sense -- for
 example, the requirement for a "hash on the public key" [sic] encoded
 as a PrintableString.<a class="pilcrow" href="#section-appendix.a-5.14">¶</a>
</li>
        <li class="normal" id="section-appendix.a-5.15">Renamed "RA certificates" to "intermediate CA certificates".  The
 original document at some point added mention of RA certificates
 without specifying how the client was to determine that an RA was in
 use, how the RA operations were identified in the protocol, or how it
 was used.  It's unclear whether what was meant was a true RA or merely
 an intermediate CA, as opposed to the default practice of having
 certificates issued directly from a single root CA certificate.  This
 update uses the term "intermediate CA certificates", since this seems
 to have been the original intent of the text.<a class="pilcrow" href="#section-appendix.a-5.15">¶</a>
</li>
        <li class="normal" id="section-appendix.a-5.16">Redid the PKIMessage diagram to match what was specified in CMS;
 the original diagram omitted a number of fields and nested data
 structures, which meant that the diagram didn't match either the text
 or the CMS specification.<a class="pilcrow" href="#section-appendix.a-5.16">¶</a>
</li>
        <li class="normal" id="section-appendix.a-5.17">Removed the requirement for a CertPoll to contain a recipientNonce,
 since CertPoll is a client message and will never be sent in response
 to a message containing a senderNonce.  See also the note in
 <a class="xref" href="#CertRep">Section 3.3.2</a>.<a class="pilcrow" href="#section-appendix.a-5.17">¶</a>
</li>
        <li class="normal" id="section-appendix.a-5.18">Clarified certificate renewal.  This represents a capability that
 was bolted onto the original protocol with (at best) vaguely defined
 semantics, including a requirement by the CA to guess whether a
 particular request was a renewal or not.  In response to developer
 feedback that they either avoided renewal entirely because of this
 uncertainty or hard-coded in particular behaviour on a per-CA basis,
 this specification explicitly identifies renewal requests as such and
 provides proper semantics for them.<a class="pilcrow" href="#section-appendix.a-5.18">¶</a>
</li>
        <li class="normal" id="section-appendix.a-5.19">Corrected the requirement that "undefined message types are treated
 as an error", since this negates the effect of GetCACaps, which is used
 to define new message types.  In particular, operations such as
 GetCACaps "Renewal" would be impossible if enforced as written,
 because the Renewal operation was an undefined message type at the
 time.<a class="pilcrow" href="#section-appendix.a-5.19">¶</a>
</li>
        <li class="normal" id="section-appendix.a-5.20">In line with the above, added IANA registries for several entries
 that had previously been defined in an ad hoc manner in different
 locations in the text.<a class="pilcrow" href="#section-appendix.a-5.20">¶</a>
</li>
        <li class="normal" id="section-appendix.a-5.21">Added the "SCEPStandard" keyword to GetCACaps to indicate that the
 CA complies with the final version of the SCEP standard, since the
 definition of what constitutes SCEP standards compliance has changed
 significantly over the years.<a class="pilcrow" href="#section-appendix.a-5.21">¶</a>
</li>
        <li class="normal" id="section-appendix.a-5.22">Added the optional failInfoText attribute to deal with the fact
 that failInfo was incapable of adequately communicating to clients why
 a certificate request operation had been rejected.<a class="pilcrow" href="#section-appendix.a-5.22">¶</a>
</li>
        <li class="normal" id="section-appendix.a-5.23">Removed the discussion in the security considerations of revocation
 issues, since SCEP doesn't support revocation as part of the
 protocol.<a class="pilcrow" href="#section-appendix.a-5.23">¶</a>
</li>
        <li class="normal" id="section-appendix.a-5.24">Clarified the use of nonces, which if applied as originally
 specified would have made the use of polling in the presence of a lost
 message impossible.<a class="pilcrow" href="#section-appendix.a-5.24">¶</a>
</li>
        <li class="normal" id="section-appendix.a-5.25">Removed the discussion of generating a given transactionID by
 hashing the public key, since this implied that there was some special
 significance in the value generated this way.  Since it was neither a
 <span class="bcp14">MUST</span> nor a <span class="bcp14">MAY</span>, it was unsound
 to imply that servers could rely on the
 value being generated a certain way.  In addition, it wouldn't work if
 multiple transactions as discussed in <a class="xref" href="#poll-resp">Section 4.4</a> were
 initiated, since the deterministic generation via hashing would lead
 to duplicate transactionIDs.<a class="pilcrow" href="#section-appendix.a-5.25">¶</a>
</li>
        <li class="normal" id="section-appendix.a-5.26">Added examples of SCEP messages to give implementers something to
 aim for.<a class="pilcrow" href="#section-appendix.a-5.26">¶</a>
</li>
      </ul>
</section>
</div>
<div id="ack">
<section id="section-appendix.b">
      <h2 id="name-acknowledgements">
<a class="section-name selfRef" href="#name-acknowledgements">Acknowledgements</a>
      </h2>
<p id="section-appendix.b-1">
The editor would like to thank all of the previous editors, authors, and
contributors for their work maintaining the
document over the years: <span class="contact-name">Cheryl Madson</span>, <span class="contact-name">Xiaoyi Liu</span>, <span class="contact-name">David McGrew</span>, <span class="contact-name">David Cooper</span>, <span class="contact-name">Andy Nourse</span>, <span class="contact-name">Max Pritikin</span>, <span class="contact-name">Jan Vilhuber</span>, and others.  The IETF reviewers provided
much useful feedback that
helped improve the document, and in particular spotted a number of things that
were present in SCEP through established practice rather than by being
explicitly described in the text.  Numerous other people have contributed
during the long life cycle of the document, and all deserve thanks.  In addition,
several PKCS #7 / CMS libraries contributed to interoperability by doing the
right thing despite what earlier SCEP documents required.<a class="pilcrow" href="#section-appendix.b-1">¶</a></p>
<p id="section-appendix.b-2">
The authors of earlier draft versions of this document would like to thank
<span class="contact-name">Peter William</span> of ValiCert, Inc. (formerly of VeriSign,
  Inc.), <span class="contact-name">Alex Deacon</span> of
VeriSign, Inc., and <span class="contact-name">Christopher Welles</span> of IRE, Inc. for their contributions to
early versions of this protocol and this document.<a class="pilcrow" href="#section-appendix.b-2">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="section-appendix.c">
      <h2 id="name-authors-address">
<a class="section-name selfRef" href="#name-authors-address">Author's Address</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Peter Gutmann</span></div>
<div class="left" dir="auto"><span class="org">University of Auckland</span></div>
<div class="left" dir="auto"><span class="street-address">Department of Computer Science</span></div>
<div class="left" dir="auto">
<span class="locality">Auckland</span> </div>
<div class="left" dir="auto"><span class="country-name">New Zealand</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:pgut001@cs.auckland.ac.nz">pgut001@cs.auckland.ac.nz</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>


</body></html>