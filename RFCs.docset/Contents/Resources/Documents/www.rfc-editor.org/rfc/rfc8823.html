<!DOCTYPE html>
<html class="RFC" lang="en"><head>
<meta charset="utf-8"/>
<meta content="Common,Latin" name="scripts"/>
<meta content="initial-scale=1.0" name="viewport"/>
<title>RFC 8823: Extensions to Automatic Certificate Management Environment for End-User S/MIME Certificates</title>
<meta content="Alexey Melnikov" name="author"/>
<meta content="
       
    This document specifies identifiers and challenges required to enable
    the Automated Certificate Management Environment (ACME) to issue
    certificates for use by email users
    that want to use S/⁠MIME.
       
    " name="description"/>
<meta content="xml2rfc 3.7.0" name="generator"/>
<meta content="ACME" name="keyword"/>
<meta content="S/MIME" name="keyword"/>
<meta content="8823" name="rfc.number"/>
<!-- Generator version information:
  xml2rfc 3.7.0
    Python 3.6.10
    appdirs 1.4.4
    ConfigArgParse 1.2.3
    google-i18n-address 2.3.5
    html5lib 1.0.1
    intervaltree 3.0.2
    Jinja2 2.11.2
    kitchen 1.2.6
    lxml 4.4.2
    pycairo 1.19.0
    pycountry 19.8.18
    pyflakes 2.1.1
    PyYAML 5.3.1
    requests 2.22.0
    setuptools 40.6.2
    six 1.14.0
    WeasyPrint 51
-->
<link href="rfc8823.xml" rel="alternate" type="application/rfc+xml"/>
<link href="#copyright" rel="license"/>
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css"/>
<link href="https://dx.doi.org/10.17487/rfc8823" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <link href="https://datatracker.ietf.org/doc/draft-ietf-acme-email-smime-14" rel="prev"/>
  </head>
<body>
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 8823</td>
<td class="center">ACME for S/MIME</td>
<td class="right">April 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Melnikov</td>
<td class="center">Informational</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div class="document-information" id="external-metadata"></div>
<div class="document-information" id="internal-metadata">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a class="eref" href="https://www.rfc-editor.org/rfc/rfc8823">8823</a></dd>
<dt class="label-category">Category:</dt>
<dd class="category">Informational</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time class="published" datetime="2021-04">April 2021</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">A. Melnikov</div>
<div class="org">Isode Ltd</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 8823</h1>
<h1 id="title">Extensions to Automatic Certificate Management Environment for End-User S/MIME Certificates</h1>
<section id="section-abstract">
      <h2 id="abstract"><a class="selfRef" href="#abstract">Abstract</a></h2>
<p id="section-abstract-1">
    This document specifies identifiers and challenges required to enable
    the Automated Certificate Management Environment (ACME) to issue
    certificates for use by email users
    that want to use S/⁠MIME.<a class="pilcrow" href="#section-abstract-1">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a class="section-name selfRef" href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This document is not an Internet Standards Track specification; it is
            published for informational purposes.<a class="pilcrow" href="#section-boilerplate.1-1">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by the
            Internet Engineering Steering Group (IESG).  Not all documents
            approved by the IESG are candidates for any level of Internet
            Standard; see Section 2 of RFC 7841.<a class="pilcrow" href="#section-boilerplate.1-2">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc8823">https://www.rfc-editor.org/info/rfc8823</a></span>.<a class="pilcrow" href="#section-boilerplate.1-3">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a class="section-name selfRef" href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a class="pilcrow" href="#section-boilerplate.2-1">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a class="pilcrow" href="#section-boilerplate.2-2">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a class="toplink" href="#" onclick="scroll(0,0)">▲</a><h2 id="name-table-of-contents">
<a class="section-name selfRef" href="#name-table-of-contents">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.1">
            <p class="keepWithNext" id="section-toc.1-1.1.1"><a class="xref" href="#section-1">1</a>.  <a class="xref" href="#name-introduction">Introduction</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.2">
            <p class="keepWithNext" id="section-toc.1-1.2.1"><a class="xref" href="#section-2">2</a>.  <a class="xref" href="#name-conventions-used-in-this-do">Conventions Used in This Document</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a class="xref" href="#section-3">3</a>.  <a class="xref" href="#name-use-of-acme-for-issuing-end">Use of ACME for Issuing End-User S/MIME Certificates</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.3.2.1">
                <p class="keepWithNext" id="section-toc.1-1.3.2.1.1"><a class="xref" href="#section-3.1">3.1</a>.  <a class="xref" href="#name-acme-challenge-email">ACME "Challenge" Email</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a class="xref" href="#section-3.2">3.2</a>.  <a class="xref" href="#name-acme-response-email">ACME "Response" Email</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a class="xref" href="#section-3.3">3.3</a>.  <a class="xref" href="#name-generating-encryption-only-">Generating Encryption-Only or Signing-Only S/MIME Certificates</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a class="xref" href="#section-4">4</a>.  <a class="xref" href="#name-internationalization-consid">Internationalization Considerations</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a class="xref" href="#section-5">5</a>.  <a class="xref" href="#name-iana-considerations">IANA Considerations</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a class="xref" href="#section-5.1">5.1</a>.  <a class="xref" href="#name-acme-identifier-type">ACME Identifier Type</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a class="xref" href="#section-5.2">5.2</a>.  <a class="xref" href="#name-acme-challenge-type">ACME Challenge Type</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a class="xref" href="#section-6">6</a>.  <a class="xref" href="#name-security-considerations">Security Considerations</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a class="xref" href="#section-7">7</a>.  <a class="xref" href="#name-references">References</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a class="xref" href="#section-7.1">7.1</a>.  <a class="xref" href="#name-normative-references">Normative References</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a class="xref" href="#section-7.2">7.2</a>.  <a class="xref" href="#name-informative-references">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a class="xref" href="#section-appendix.a"></a><a class="xref" href="#name-acknowledgements">Acknowledgements</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a class="xref" href="#section-appendix.b"></a><a class="xref" href="#name-authors-address">Author's Address</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<section id="section-1">
      <h2 id="name-introduction">
<a class="section-number selfRef" href="#section-1">1. </a><a class="section-name selfRef" href="#name-introduction">Introduction</a>
      </h2>
<p id="section-1-1">
        ACME <span>[<a class="xref" href="#RFC8555">RFC8555</a>]</span> is a mechanism for automating certificate
        management on the Internet.  It enables administrative entities to
        prove effective control over resources like domain names, and it
        automates the process of generating and issuing certificates.<a class="pilcrow" href="#section-1-1">¶</a></p>
<p id="section-1-2">
        This document describes an extension to ACME for use by S/MIME.
        <a class="xref" href="#smime">Section 3</a> defines extensions for issuing end-user S/MIME <span>[<a class="xref" href="#RFC8550">RFC8550</a>]</span> certificates.<a class="pilcrow" href="#section-1-2">¶</a></p>
<p id="section-1-3">
        This document aims to support both:<a class="pilcrow" href="#section-1-3">¶</a></p>
<ol class="normal type-1" id="section-1-4" start="1" type="1">
 <li id="section-1-4.1">A Mail User Agent (MUA) that has a built-in ACME client that is aware 
 of the extension described in this document. (We will call such MUAs "ACME-email-aware".) 
 Such an MUA can present a nice user interface to the user and automate certificate issuance.<a class="pilcrow" href="#section-1-4.1">¶</a>
</li>
        <li id="section-1-4.2">An MUA that is not ACME aware, with a separate ACME client implemented in a command-line tool or as a part of a website. While S/MIME certificate issuance is not going to 
 be as painless as in the case of the ACME-email-aware MUA, the extra burden on a user is 
 going to be minimal.<a class="pilcrow" href="#section-1-4.2">¶</a>
</li>
      </ol>
</section>
<section id="section-2">
      <h2 id="name-conventions-used-in-this-do">
<a class="section-number selfRef" href="#section-2">2. </a><a class="section-name selfRef" href="#name-conventions-used-in-this-do">Conventions Used in This Document</a>
      </h2>
<p id="section-2-1">
    The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
    "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
    described in BCP 14 <span>[<a class="xref" href="#RFC2119">RFC2119</a>]</span> <span>[<a class="xref" href="#RFC8174">RFC8174</a>]</span> 
    when, and only when, they appear in all capitals, as shown here.<a class="pilcrow" href="#section-2-1">¶</a></p>
</section>
<div id="smime">
<section id="section-3">
      <h2 id="name-use-of-acme-for-issuing-end">
<a class="section-number selfRef" href="#section-3">3. </a><a class="section-name selfRef" href="#name-use-of-acme-for-issuing-end">Use of ACME for Issuing End-User S/MIME Certificates</a>
      </h2>
<p id="section-3-1">
      ACME <span>[<a class="xref" href="#RFC8555">RFC8555</a>]</span> defines a "dns" identifier type that is used to verify that a particular entity
      has control over a domain or specific service associated with the domain.
      In order to be able to issue end-user S/MIME certificates, ACME needs a new identifier type that
      proves ownership of an email address.<a class="pilcrow" href="#section-3-1">¶</a></p>
<p id="section-3-2">
      This document defines a new identifier type, "email", which corresponds to an email address.
      The address can be all ASCII <span>[<a class="xref" href="#RFC5321">RFC5321</a>]</span> or internationalized <span>[<a class="xref" href="#RFC6531">RFC6531</a>]</span>;
      when an internationalized email address is used, the domain part can contain both U-labels and A-labels <span>[<a class="xref" href="#RFC5890">RFC5890</a>]</span>.
      This can be used with S/MIME or another similar service that requires possession of a certificate tied to an email address.<a class="pilcrow" href="#section-3-2">¶</a></p>
<p id="section-3-3">
      Any identifier of type "email" in a newOrder request <span class="bcp14">MUST NOT</span> have a wildcard ("*") character in its value.<a class="pilcrow" href="#section-3-3">¶</a></p>
<p id="section-3-4">
      A new challenge type, "email-reply-00", is used with the "email" identifier type,
      which provides proof that an ACME client has control over an email address.<a class="pilcrow" href="#section-3-4">¶</a></p>
<p id="section-3-5">
      The process of issuing an S/MIME certificate works as follows. Note that the ACME client can be a standalone
      application (if the MUA is not ACME-email-aware) or can be a component of the MUA.<a class="pilcrow" href="#section-3-5">¶</a></p>
<ol class="normal type-1" id="section-3-6" start="1" type="1">
 <li id="section-3-6.1">An end user initiates issuance of an S/MIME certificate for one of their email addresses.
          This might be done by using an email client UI, by running a command-line tool, by
          visiting a certificate authority web page, etc.
   This document doesn't prescribe a specific UI
          used to initiate S/MIME certificate issuance or where the ACME client is located.<a class="pilcrow" href="#section-3-6.1">¶</a>
</li>
        <li id="section-3-6.2">
          The ACME-email-aware client component begins the certificate issuance process by sending a POST
          request to the server's newOrder resource, including the identifier of type "email".
          See <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8555#section-7.4">Section 7.4</a> of [<a class="xref" href="#RFC8555">RFC8555</a>]</span> for more details.<a class="pilcrow" href="#section-3-6.2">¶</a>
</li>
        <li id="section-3-6.3">
          <p id="section-3-6.3.1">
          The ACME server
          responds to the POST request, including an "authorizations" URL for the requested email address.
          The ACME client then retrieves information about the corresponding "email-reply-00" challenge,
          as specified in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8555#section-7.5">Section 7.5</a> of [<a class="xref" href="#RFC8555">RFC8555</a>]</span>.
          The "token" field of the corresponding challenge object (from the "challenges" array)
          contains token-part2. token-part2 should contain at least 128 bits of entropy.
          The "type" field of the challenge object is "email-reply-00". The challenge object
          also contains the "from" field, with the email address that would be used in the From header field
          of the "challenge" email message (see the next step).<a class="pilcrow" href="#section-3-6.3.1">¶</a></p>
<p id="section-3-6.3.2">An example challenge object might look like this:<a class="pilcrow" href="#section-3-6.3.2">¶</a></p>
<div id="section-3-6.3.3">
<pre class="sourcecode">    {
      "type": "email-reply-00",
      "url": "https://example.com/acme/chall/ABprV_B7yEyA4f",
      "from": "acme-challenge+2i211oi1204310@example.com",
      "token": "DGyRejmCefe7v4NfDGDKfA"
    }
</pre><a class="pilcrow" href="#section-3-6.3.3">¶</a>
</div>
</li>
        <li id="section-3-6.4">
          After responding to the authorization request, the ACME server
          generates another token and a "challenge" email message with the subject "ACME: &lt;token-part1&gt;",
          where &lt;token-part1&gt; is the base64url-encoded <span>[<a class="xref" href="#RFC4648">RFC4648</a>]</span> form of the token.
          The ACME server <span class="bcp14">MUST</span> generate a fresh token for each S/MIME issuance request (authorization request),
          and token-part1 <span class="bcp14">MUST</span> contain at least 128 bits of entropy.
          The "challenge" email message structure is described in more details in <a class="xref" href="#acme-smime-challenge-email">Section 3.1</a>.<a class="pilcrow" href="#section-3-6.4">¶</a>
</li>
        <li id="section-3-6.5">
          The MUA retrieves and parses the "challenge" email message.
          
          If the MUA is ACME-email-aware, it ignores any "challenge" email that is not expected,
          e.g., if there is no ACME certificate issuance pending.
          The ACME-email-aware MUA also ignores any "challenge" email that has the Subject header field
          that indicates that it is an email reply, e.g., a subject starting with the reply prefix "Re:".<a class="pilcrow" href="#section-3-6.5">¶</a>
</li>
        <li id="section-3-6.6">
          The ACME client concatenates "token-part1" (received over email) and "token-part2"
          (received over HTTPS <span>[<a class="xref" href="#RFC2818">RFC2818</a>]</span>) to create the ACME "token" and calculates
          keyAuthorization (as per <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8555#section-8.1">Section 8.1</a> of [<a class="xref" href="#RFC8555">RFC8555</a>]</span>).
          Then, it returns the base64url-encoded SHA-256 digest <span>[<a class="xref" href="#RFC6234">RFC6234</a>]</span> of the key authorization.
          The MUA returns the base64url-encoded SHA-256 digest obtained from the ACME client
          in the body of a "response" email message. The "response" email message structure
          is described in more details in <a class="xref" href="#acme-smime-response-email">Section 3.2</a>.
          If the MUA is ACME-email-aware, it <span class="bcp14">MUST NOT</span> respond to the same "challenge" email more than once.<a class="pilcrow" href="#section-3-6.6">¶</a>
</li>
        <li id="section-3-6.7">
          Once the MUA sends the "response" email, the ACME client notifies the ACME server
          by POST to the challenge URL ("url" field).<a class="pilcrow" href="#section-3-6.7">¶</a>
</li>
        <li id="section-3-6.8">
          The ACME client can start polling the authorization URL
          (using POST-as-GET requests) to see if the ACME server received and validated the "response" email message. (See <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8555#section-7.5.1">Section 7.5.1</a> of [<a class="xref" href="#RFC8555">RFC8555</a>]</span> for more details.)
          
          If the "status" field of the challenge switches to "valid",
          then the ACME client can proceed with request finalization.
          The Certificate Signing Request (CSR) <span class="bcp14">MUST</span> indicate the exact same
          set of requested identifiers as the initial newOrder request.
          For an identifier of type "email", the PKCS#10 <span>[<a class="xref" href="#RFC2986">RFC2986</a>]</span>
          CSR <span class="bcp14">MUST</span> contain the requested email address in an extensionRequest
          attribute <span>[<a class="xref" href="#RFC2985">RFC2985</a>]</span> requesting a subjectAltName extension.
          The email address <span class="bcp14">MUST</span> also match the From header field value of the "response" email message.<a class="pilcrow" href="#section-3-6.8">¶</a>
</li>
        <li id="section-3-6.9">
          In order to request generation of signing-only or encryption-only S/MIME certificates
          (as opposed to requesting generation of S/MIME certificates suitable for both),
          the CSR needs to include the key usage extension (see <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8550#section-4.4.2">Section 4.4.2</a> of [<a class="xref" href="#RFC8550">RFC8550</a>]</span>).
          This is described in more details in <a class="xref" href="#acme-smime-sign-or-encrypt-only">Section 3.3</a>.<a class="pilcrow" href="#section-3-6.9">¶</a>
</li>
        <li id="section-3-6.10">
          If a request to finalize an order is successful, the ACME server will
          return a 200 (OK) with an updated order object.
          If the certificate is issued successfully, i.e., if the order "status"
          is "valid", then the ACME client can download the issued S/MIME certificate
          from the URL specified in the "certificate" field.<a class="pilcrow" href="#section-3-6.10">¶</a>
</li>
      </ol>
<div id="acme-smime-challenge-email">
<section id="section-3.1">
        <h3 id="name-acme-challenge-email">
<a class="section-number selfRef" href="#section-3.1">3.1. </a><a class="section-name selfRef" href="#name-acme-challenge-email">ACME "Challenge" Email</a>
        </h3>
<p id="section-3.1-1">
          A "challenge" email message <span class="bcp14">MUST</span> have the following structure:<a class="pilcrow" href="#section-3.1-1">¶</a></p>
<ol class="normal type-1" id="section-3.1-2" start="1" type="1">
   <li id="section-3.1-2.1">
            The Subject header field has the following syntax: "ACME: &lt;token-part1&gt;",
            where the prefix "ACME:" is followed by folding white space (FWS; see <span>[<a class="xref" href="#RFC5322">RFC5322</a>]</span>)
            and then by &lt;token-part1&gt;, which is the base64url-encoded first part of the ACME token
            that <span class="bcp14">MUST</span> be at least 128 bits long after decoding.
            Due to the recommended 78-octet line-length limit
            in <span>[<a class="xref" href="#RFC5322">RFC5322</a>]</span>, the subject line can be folded, so white spaces (if any) within
            the &lt;token-part1&gt; <span class="bcp14">MUST</span> be ignored. <span>[<a class="xref" href="#RFC2231">RFC2231</a>]</span> encoding of the Subject header field <span class="bcp14">MUST</span> be supported,
            and, when used, only the "UTF-8" and "US-ASCII" charsets are allowed; other charsets <span class="bcp14">MUST NOT</span> be used. The US-ASCII charset <span class="bcp14">SHOULD</span> be used.<a class="pilcrow" href="#section-3.1-2.1">¶</a>
</li>
          <li id="section-3.1-2.2">
            The From header field <span class="bcp14">MUST</span> be the same email address as specified in the "from" field of the challenge object.<a class="pilcrow" href="#section-3.1-2.2">¶</a>
</li>
          <li id="section-3.1-2.3">
            The To header field <span class="bcp14">MUST</span> be the email address of the entity that requested the S/MIME certificate to be generated.<a class="pilcrow" href="#section-3.1-2.3">¶</a>
</li>
          <li id="section-3.1-2.4">The message <span class="bcp14">MAY</span> contain a Reply-To and/or CC header field.<a class="pilcrow" href="#section-3.1-2.4">¶</a>
</li>
          <li id="section-3.1-2.5">
            The message <span class="bcp14">MUST</span> include the Auto-Submitted header field with the value "auto-generated" <span>[<a class="xref" href="#RFC3834">RFC3834</a>]</span>.
            To aid in debugging (and, for some implementations, to make automated processing easier), the Auto-Submitted header field <span class="bcp14">SHOULD</span> include the "type=acme" parameter.
            It <span class="bcp14">MAY</span> include other optional parameters, as allowed by the syntax of the Auto-Submitted header field.<a class="pilcrow" href="#section-3.1-2.5">¶</a>
</li>
          <li id="section-3.1-2.6">
            <p id="section-3.1-2.6.1">
            In order to prove authenticity of a challenge message, it <span class="bcp14">MUST</span> be signed using either DomainKeys Identified Mail (DKIM) <span>[<a class="xref" href="#RFC6376">RFC6376</a>]</span>
            or S/MIME <span>[<a class="xref" href="#RFC8551">RFC8551</a>]</span>.<a class="pilcrow" href="#section-3.1-2.6.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-2.6.2.1">
              If DKIM signing is used, the resulting DKIM-Signature header field <span class="bcp14">MUST</span> contain the "h=" tag that includes
              at least the From, Sender, Reply-To, To, CC, Subject, Date, In-Reply-To, References,
              Message-ID, Auto-Submitted, Content-Type, and Content-Transfer-Encoding header fields.
              The DKIM-Signature header field's "h=" tag <span class="bcp14">SHOULD</span> also include the
              Resent-Date, Resent-From, Resent-To, Resent-Cc, List-Id, List-Help, List-Unsubscribe,
              List-Subscribe, List-Post, List-Owner, List-Archive, and List-Unsubscribe-Post header fields.
              The domain from the "d=" tag of the DKIM-Signature header field <span class="bcp14">MUST</span> be the same as the domain from
              the From header field of the "challenge" email.<a class="pilcrow" href="#section-3.1-2.6.2.1">¶</a>
</li>
              <li class="normal" id="section-3.1-2.6.2.2">
              If S/MIME signing is used, the certificate corresponding to the signer <span class="bcp14">MUST</span> have an rfc822Name subjectAltName extension
              with the value equal to the From header field email address of the "challenge" email.<a class="pilcrow" href="#section-3.1-2.6.2.2">¶</a>
</li>
            </ul>
</li>
          <li id="section-3.1-2.7">
            The body of the challenge message is not used for automated processing, so it can be any media type.
            (However, there are extra requirements on S/MIME signing, if used. See below.)
            Typically, it is text/plain or text/html containing a human-readable explanation of the purpose of the message.
            If S/MIME signing is used to prove authenticity of the challenge message,
            then the multipart/signed or "application/pkcs7-mime; smime-type=signed-data;" media type should be used.
            Either way, it <span class="bcp14">MUST</span> use S/MIME header protection.<a class="pilcrow" href="#section-3.1-2.7">¶</a>
</li>
        </ol>
<p id="section-3.1-3">
        An email client compliant with this specification that detects that a particular "challenge" email
        fails the validation described above <span class="bcp14">MUST</span> ignore the challenge and thus will not generate a "response" email.
        To aid in debugging, such failed validations <span class="bcp14">SHOULD</span> be logged.<a class="pilcrow" href="#section-3.1-3">¶</a></p>
<p class="keepWithNext" id="section-3.1-4">
          Here is an example of an ACME "challenge" email (note that, for simplicity, DKIM-related header fields are not included).<a class="pilcrow" href="#section-3.1-4">¶</a></p>
<figure id="figure-1">
          <div class="artwork art-text alignLeft" id="section-3.1-5.1">
<pre>  Auto-Submitted: auto-generated; type=acme
  Date: Sat, 5 Dec 2020 10:08:55 +0100
  Message-ID: &lt;A2299BB.FF7788@example.org&gt;
  From: acme-generator@example.org
  To: alexey@example.com
  Subject: ACME: LgYemJLy3F1LDkiJrdIGbEzyFJyOyf6vBdyZ1TG3sME=
  Content-Type: text/plain
  MIME-Version: 1.0

  This is an automatically generated ACME challenge for email address
  "alexey@example.com". If you haven't requested an S/MIME
  certificate generation for this email address, be very afraid.
  If you did request it, your email client might be able to process
  this request automatically, or you might have to paste the first
  token part into an external program.
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-1">Figure 1</a></figcaption></figure>
<p class="keepWithPrevious" id="section-3.1-6"></p>
</section>
</div>
<div id="acme-smime-response-email">
<section id="section-3.2">
        <h3 id="name-acme-response-email">
<a class="section-number selfRef" href="#section-3.2">3.2. </a><a class="section-name selfRef" href="#name-acme-response-email">ACME "Response" Email</a>
        </h3>
<p id="section-3.2-1">
          A valid "response" email message <span class="bcp14">MUST</span> have the following structure:<a class="pilcrow" href="#section-3.2-1">¶</a></p>
<ol class="normal type-1" id="section-3.2-2" start="1" type="1">
            <li id="section-3.2-2.1">
            The Subject header field is formed as a reply to the ACME "challenge" email
            (see <a class="xref" href="#acme-smime-challenge-email">Section 3.1</a>).
            Its syntax is the same as that of the challenge message except that it may be prefixed
            by a US-ASCII reply prefix (typically "Re:") and FWS (see <span>[<a class="xref" href="#RFC5322">RFC5322</a>]</span>), as is normal in reply messages. When
            parsing the subject, ACME servers <span class="bcp14">MUST</span> decode <span>[<a class="xref" href="#RFC2231">RFC2231</a>]</span> encoding (if any), and
            then they can ignore any prefix before the "ACME:" label.<a class="pilcrow" href="#section-3.2-2.1">¶</a>
</li>
          <li id="section-3.2-2.2">The From header field contains the email address of the user that is requesting S/MIME certificate issuance.<a class="pilcrow" href="#section-3.2-2.2">¶</a>
</li>
          <li id="section-3.2-2.3">The To header field of the response contains the value from the Reply-To header field from the
   challenge message (if set). Otherwise, it contains the value from the From header field of the
   challenge message.<a class="pilcrow" href="#section-3.2-2.3">¶</a>
</li>
          <li id="section-3.2-2.4">The Cc header field is ignored if present in the "response" email message.<a class="pilcrow" href="#section-3.2-2.4">¶</a>
</li>
          <li id="section-3.2-2.5">The In-Reply-To header field <span class="bcp14">SHOULD</span> be set to the Message-ID header field of the challenge message
            according to rules in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc5322#section-3.6.4">Section 3.6.4</a> of [<a class="xref" href="#RFC5322">RFC5322</a>]</span>.<a class="pilcrow" href="#section-3.2-2.5">¶</a>
</li>
          <li id="section-3.2-2.6">List-* header fields <span>[<a class="xref" href="#RFC4021">RFC4021</a>]</span><span>[<a class="xref" href="#RFC8058">RFC8058</a>]</span> <span class="bcp14">MUST</span> be absent (i.e., the reply can't come from a mailing list).<a class="pilcrow" href="#section-3.2-2.6">¶</a>
</li>
          <li id="section-3.2-2.7">
            <p id="section-3.2-2.7.1">The media type of the "response" email message is either text/plain or multipart/alternative <span>[<a class="xref" href="#RFC2046">RFC2046</a>]</span>, containing
            text/plain as one of the alternatives. (Note that the requirement to support multipart/alternative is to allow use of ACME-unaware MUAs,
            which can't always generate pure text/plain, e.g., if they reply to a text/html).
            The text/plain body part (whether or not it is inside multipart/alternative)
            <span class="bcp14">MUST</span> contain a block of lines starting with the line "-----BEGIN ACME RESPONSE-----", followed by one
            or more lines containing the base64url-encoded SHA-256 digest <span>[<a class="xref" href="#RFC6234">RFC6234</a>]</span>
            of the key authorization, calculated from concatenated token-part1 (received over email)
            and token-part2 (received over HTTPS), as outlined in the 5th bullet in <a class="xref" href="#smime">Section 3</a>.
            (Note that each line of text/plain is terminated by CRLF. Bare LFs or bare CRs are not allowed.)
            Due to historical line-length limitations in email, line endings (CRLFs)
            can be freely inserted in the middle of the encoded digest,
            so they <span class="bcp14">MUST</span> be ignored when processing it. The final line of the encoded digest
            is followed by a line containing:<a class="pilcrow" href="#section-3.2-2.7.1">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.2-2.7.2">
<pre>-----END ACME RESPONSE-----
</pre><a class="pilcrow" href="#section-3.2-2.7.2">¶</a>
</div>
<p id="section-3.2-2.7.3">Any text before and after this block is ignored. For example, such text might explain what
            to do with it for ACME-unaware clients.<a class="pilcrow" href="#section-3.2-2.7.3">¶</a></p>
</li>
          <li id="section-3.2-2.8">There is no need to use any Content-Transfer-Encoding other than 7bit for the text/plain body part.
            Use of quoted-printable or base64 in a "response" email message is not necessary and should be avoided,
            though it is permitted.<a class="pilcrow" href="#section-3.2-2.8">¶</a>
</li>
          <li id="section-3.2-2.9">
            In order to prove authenticity of a response message, it <span class="bcp14">MUST</span> be DKIM <span>[<a class="xref" href="#RFC6376">RFC6376</a>]</span>
            signed. The resulting DKIM-Signature header field <span class="bcp14">MUST</span> contain the "h=" tag that includes
            at least the From, Sender, Reply-To, To, CC, Subject, Date, In-Reply-To, References,
            Message-ID, Content-Type, and Content-Transfer-Encoding header fields.
            The DKIM-Signature header field's "h=" tag <span class="bcp14">SHOULD</span> also include the
            Resent-Date, Resent-From, Resent-To, Resent-Cc, List-Id, List-Help, List-Unsubscribe,
            List-Subscribe, List-Post, List-Owner, List-Archive, and List-Unsubscribe-Post header fields.
            The domain from the "d=" tag of DKIM-Signature header field <span class="bcp14">MUST</span> be the same as the domain from
            the From header field of the "response" email.<a class="pilcrow" href="#section-3.2-2.9">¶</a>
</li>
        </ol>
<p class="keepWithNext" id="section-3.2-3">
          Here is an example of an ACME "response" email (note that, for simplicity, DKIM-related header fields are not included).<a class="pilcrow" href="#section-3.2-3">¶</a></p>
<figure id="figure-2">
          <div class="artwork art-text alignLeft" id="section-3.2-4.1">
<pre>   Date: Sat, 5 Dec 2020 12:01:45 +0100
   Message-ID: &lt;111-22222-3333333@example.com&gt;
   In-Reply-To: &lt;A2299BB.FF7788@example.org&gt;
   From: alexey@example.com
   To: acme-generator@example.org
   Subject: Re: ACME: LgYemJLy3F1LDkiJrdIGbEzyFJyOyf6vBdyZ1TG3sME=
   Content-Type: text/plain
   MIME-Version: 1.0

   -----BEGIN ACME RESPONSE-----
   LoqXcYV8q5ONbJQxbmR7SCTNo3tiAXDfowy
   jxAjEuX0=
   -----END ACME RESPONSE-----
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-2">Figure 2</a></figcaption></figure>
<p class="keepWithPrevious" id="section-3.2-5"></p>
</section>
</div>
<div id="acme-smime-sign-or-encrypt-only">
<section id="section-3.3">
        <h3 id="name-generating-encryption-only-">
<a class="section-number selfRef" href="#section-3.3">3.3. </a><a class="section-name selfRef" href="#name-generating-encryption-only-">Generating Encryption-Only or Signing-Only S/MIME Certificates</a>
        </h3>
<p id="section-3.3-1">
          ACME extensions specified in this document can be used to request signing-only or
          encryption-only S/MIME certificates.<a class="pilcrow" href="#section-3.3-1">¶</a></p>
<p id="section-3.3-2">
          In order to request signing-only S/MIME certificates, the CSR <span class="bcp14">MUST</span> include the key usage
          extension with digitalSignature and/or nonRepudiation bits set and no other bits set.<a class="pilcrow" href="#section-3.3-2">¶</a></p>
<p id="section-3.3-3">
          In order to request encryption-only S/MIME certificates, the CSR <span class="bcp14">MUST</span> include the key usage
          extension with keyEncipherment or keyAgreement bits set and no other bits set.<a class="pilcrow" href="#section-3.3-3">¶</a></p>
<p id="section-3.3-4">
          Presence of both of the above sets of key usage bits in the CSR,
          as well as absence of the key usage extension in the CSR,
          signals to the ACME server to issue an S/MIME certificate suitable for both signing
          and encryption.<a class="pilcrow" href="#section-3.3-4">¶</a></p>
</section>
</div>
</section>
</div>
<section id="section-4">
      <h2 id="name-internationalization-consid">
<a class="section-number selfRef" href="#section-4">4. </a><a class="section-name selfRef" href="#name-internationalization-consid">Internationalization Considerations</a>
      </h2>
<p id="section-4-1">
      <span>[<a class="xref" href="#RFC8616">RFC8616</a>]</span> updated/clarified use of DKIM with internationalized email addresses <span>[<a class="xref" href="#RFC6531">RFC6531</a>]</span>.
        Please consult <span>[<a class="xref" href="#RFC8616">RFC8616</a>]</span> in regards to any changes that need to be implemented.<a class="pilcrow" href="#section-4-1">¶</a></p>
<p id="section-4-2">
        Use of non-ASCII characters in left-hand sides of internationalized email addresses requires putting
        internationalized email addresses in X.509 certificates <span>[<a class="xref" href="#RFC8398">RFC8398</a>]</span>.<a class="pilcrow" href="#section-4-2">¶</a></p>
</section>
<section id="section-5">
      <h2 id="name-iana-considerations">
<a class="section-number selfRef" href="#section-5">5. </a><a class="section-name selfRef" href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<section id="section-5.1">
        <h3 id="name-acme-identifier-type">
<a class="section-number selfRef" href="#section-5.1">5.1. </a><a class="section-name selfRef" href="#name-acme-identifier-type">ACME Identifier Type</a>
        </h3>
<p id="section-5.1-1">
        IANA has registered a new identifier type in the "ACME Identifier
        Types" registry defined in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8555#section-9.7.7">Section 9.7.7</a> of [<a class="xref" href="#RFC8555">RFC8555</a>]</span> with Label "email" and a Reference to this document,
        <span>[<a class="xref" href="#RFC5321">RFC5321</a>]</span>, and <span>[<a class="xref" href="#RFC6531">RFC6531</a>]</span>.  The new identifier type corresponds to an (all
        ASCII) email address <span>[<a class="xref" href="#RFC5321">RFC5321</a>]</span> or
        internationalized email addresses <span>[<a class="xref" href="#RFC6531">RFC6531</a>]</span>.<a class="pilcrow" href="#section-5.1-1">¶</a></p>
</section>
<section id="section-5.2">
        <h3 id="name-acme-challenge-type">
<a class="section-number selfRef" href="#section-5.2">5.2. </a><a class="section-name selfRef" href="#name-acme-challenge-type">ACME Challenge Type</a>
        </h3>
<p id="section-5.2-1">
          IANA has registered a new entry in the "ACME Validation Methods" registry
          defined in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8555#section-9.7.8">Section 9.7.8</a> of [<a class="xref" href="#RFC8555">RFC8555</a>]</span>.
          This entry is as follows:<a class="pilcrow" href="#section-5.2-1">¶</a></p>
<table class="center" id="table-1">
          <caption><a class="selfRef" href="#table-1">Table 1</a></caption>
<thead>
            <tr>
              <th class="text-center" colspan="1" rowspan="1">Label</th>
              <th class="text-center" colspan="1" rowspan="1">Identifier Type</th>
              <th class="text-center" colspan="1" rowspan="1">ACME</th>
              <th class="text-center" colspan="1" rowspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-center" colspan="1" rowspan="1">email-reply-00</td>
              <td class="text-center" colspan="1" rowspan="1">email</td>
              <td class="text-center" colspan="1" rowspan="1">Y</td>
              <td class="text-center" colspan="1" rowspan="1">RFC 8823</td>
            </tr>
          </tbody>
        </table>
</section>
</section>
<div id="seccons">
<section id="section-6">
      <h2 id="name-security-considerations">
<a class="section-number selfRef" href="#section-6">6. </a><a class="section-name selfRef" href="#name-security-considerations">Security Considerations</a>
      </h2>
<p id="section-6-1">
        Please see the Security Considerations section of <span>[<a class="xref" href="#RFC8555">RFC8555</a>]</span> for general security
        considerations related to the use of ACME. This challenge/response
        protocol demonstrates that an entity that controls the private key
        (corresponding to the public key in the certificate) also controls the
        named email account.  The ACME server is confirming that the requested
        email address belongs to the entity that requested the certificate,
        but this makes no claim to address correctness or fitness for purpose.
        If such claims are needed, they must be obtained by some other
        mechanism.<a class="pilcrow" href="#section-6-1">¶</a></p>
<p id="section-6-2">
        The security of the "email-reply-00" challenge type depends on the security of the email system.
        A third party that can read and reply to user's email messages (by possessing a user's password
        or a secret derived from it that can give read and reply access, such as "password equivalent" information,
        or by being given permissions to act on a user's behalf using email delegation features common
        in some email systems) can request S/MIME certificates using the protocol specified in this document
        and is indistinguishable from the email account owner.
        This has several possible implications:<a class="pilcrow" href="#section-6-2">¶</a></p>
<ol class="normal type-1" id="section-6-3" start="1" type="1">
 <li id="section-6-3.1">An entity that compromised an email account would be able to request S/MIME certificates
          using the protocol specified in this document, and such entity couldn't be distinguished from
          the legitimate email account owner (unless some external sources of information are consulted).<a class="pilcrow" href="#section-6-3.1">¶</a>
</li>
        <li id="section-6-3.2">For email addresses with legitimate shared access/control by
        multiple users, any such user would be able to request S/MIME
        certificates using the protocol specified in this document; such
        requests can't be attributed to a specific user without consulting
        external systems (such as IMAP/SMTP access logs).<a class="pilcrow" href="#section-6-3.2">¶</a>
</li>
        <li id="section-6-3.3">The protocol specified in this document is not suitable for use with email addresses
          associated with mailing lists <span>[<a class="xref" href="#RFC5321">RFC5321</a>]</span>. While it is not always
          possible to guarantee that a particular S/MIME certificate request is not from a mailing list
          address, prohibition on inclusion of List-* header fields helps certificate issuers
          to handle most common cases.<a class="pilcrow" href="#section-6-3.3">¶</a>
</li>
      </ol>
<p id="section-6-4">
        An email system in its turn depends on DNS. A third party that can manipulate DNS MX records
        for a domain might be able to redirect an email and can get (at least temporary) read and reply access to it.
        Similar considerations apply to DKIM TXT records in DNS.
        Use of DNSSEC by email system administrators is recommended to avoid making it easy to spoof
        DNS records affecting an email system. However, use of DNSSEC is not ubiquitous at the time of
        publishing of this document, so it is not required here.

        Also, many existing systems that rely on verification of ownership of an email address --
        for example, 2-factor authentication systems used by banks or traditional certificate issuance
        systems -- send email messages to email addresses, expecting the owner to click on the link supplied
        in them (or to reply to a message), without requiring use of DNSSEC. So the risk of not requiring
        DNSSEC is presumed acceptable in this document.<a class="pilcrow" href="#section-6-4">¶</a></p>
<p id="section-6-5">
      An ACME email challenge message can be forged by an attacker.
      
      As per requirements on an ACME-email-aware MUA specified in <a class="xref" href="#smime">Section 3</a>,
      the MUA will not respond to requests it is not expecting.
      Even if the attacker causes the erroneous "response" email to go to
      an attacker-controlled email address, very little information is leaked --
      the SHA-256 hash of the key authorization would be leaked, not the key
      authorization itself, so no parts of the token or the account key
      thumbprint are leaked.<a class="pilcrow" href="#section-6-5">¶</a></p>
<p id="section-6-6">
      An attacker that can read the "response" email has only one chance to guess the
      token-part2. Even if the attacker can guess it right, it still needs to know
      the ACME account key to be able to make use of the intercepted SHA-256 hash of
      the key authorization.<a class="pilcrow" href="#section-6-6">¶</a></p>
<p id="section-6-7">
        Also see the Security Considerations section of <span>[<a class="xref" href="#RFC6376">RFC6376</a>]</span> for details on how DKIM depends
        on the DNS and the respective vulnerabilities this dependence has.<a class="pilcrow" href="#section-6-7">¶</a></p>
</section>
</div>
<section id="section-7">
      <h2 id="name-references">
<a class="section-number selfRef" href="#section-7">7. </a><a class="section-name selfRef" href="#name-references">References</a>
      </h2>
<section id="section-7.1">
        <h3 id="name-normative-references">
<a class="section-number selfRef" href="#section-7.1">7.1. </a><a class="section-name selfRef" href="#name-normative-references">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2046">[RFC2046]</dt>
        <dd>
<span class="refAuthor">Freed, N.</span> and <span class="refAuthor">N. Borenstein</span>, <span class="refTitle">"Multipurpose Internet Mail Extensions (MIME) Part Two: Media Types"</span>, <span class="seriesInfo">RFC 2046</span>, <span class="seriesInfo">DOI 10.17487/RFC2046</span>, <time class="refDate" datetime="1996-11">November 1996</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2046">https://www.rfc-editor.org/info/rfc2046</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time class="refDate" datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2231">[RFC2231]</dt>
        <dd>
<span class="refAuthor">Freed, N.</span> and <span class="refAuthor">K. Moore</span>, <span class="refTitle">"MIME Parameter Value and Encoded Word Extensions: Character Sets, Languages, and Continuations"</span>, <span class="seriesInfo">RFC 2231</span>, <span class="seriesInfo">DOI 10.17487/RFC2231</span>, <time class="refDate" datetime="1997-11">November 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2231">https://www.rfc-editor.org/info/rfc2231</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2818">[RFC2818]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"HTTP Over TLS"</span>, <span class="seriesInfo">RFC 2818</span>, <span class="seriesInfo">DOI 10.17487/RFC2818</span>, <time class="refDate" datetime="2000-05">May 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2818">https://www.rfc-editor.org/info/rfc2818</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2985">[RFC2985]</dt>
        <dd>
<span class="refAuthor">Nystrom, M.</span> and <span class="refAuthor">B. Kaliski</span>, <span class="refTitle">"PKCS #9: Selected Object Classes and Attribute Types Version 2.0"</span>, <span class="seriesInfo">RFC 2985</span>, <span class="seriesInfo">DOI 10.17487/RFC2985</span>, <time class="refDate" datetime="2000-11">November 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2985">https://www.rfc-editor.org/info/rfc2985</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2986">[RFC2986]</dt>
        <dd>
<span class="refAuthor">Nystrom, M.</span> and <span class="refAuthor">B. Kaliski</span>, <span class="refTitle">"PKCS #10: Certification Request Syntax Specification Version 1.7"</span>, <span class="seriesInfo">RFC 2986</span>, <span class="seriesInfo">DOI 10.17487/RFC2986</span>, <time class="refDate" datetime="2000-11">November 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2986">https://www.rfc-editor.org/info/rfc2986</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3834">[RFC3834]</dt>
        <dd>
<span class="refAuthor">Moore, K.</span>, <span class="refTitle">"Recommendations for Automatic Responses to Electronic Mail"</span>, <span class="seriesInfo">RFC 3834</span>, <span class="seriesInfo">DOI 10.17487/RFC3834</span>, <time class="refDate" datetime="2004-08">August 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3834">https://www.rfc-editor.org/info/rfc3834</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4648">[RFC4648]</dt>
        <dd>
<span class="refAuthor">Josefsson, S.</span>, <span class="refTitle">"The Base16, Base32, and Base64 Data Encodings"</span>, <span class="seriesInfo">RFC 4648</span>, <span class="seriesInfo">DOI 10.17487/RFC4648</span>, <time class="refDate" datetime="2006-10">October 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4648">https://www.rfc-editor.org/info/rfc4648</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5321">[RFC5321]</dt>
        <dd>
<span class="refAuthor">Klensin, J.</span>, <span class="refTitle">"Simple Mail Transfer Protocol"</span>, <span class="seriesInfo">RFC 5321</span>, <span class="seriesInfo">DOI 10.17487/RFC5321</span>, <time class="refDate" datetime="2008-10">October 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5321">https://www.rfc-editor.org/info/rfc5321</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5322">[RFC5322]</dt>
        <dd>
<span class="refAuthor">Resnick, P., Ed.</span>, <span class="refTitle">"Internet Message Format"</span>, <span class="seriesInfo">RFC 5322</span>, <span class="seriesInfo">DOI 10.17487/RFC5322</span>, <time class="refDate" datetime="2008-10">October 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5322">https://www.rfc-editor.org/info/rfc5322</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5890">[RFC5890]</dt>
        <dd>
<span class="refAuthor">Klensin, J.</span>, <span class="refTitle">"Internationalized Domain Names for Applications (IDNA): Definitions and Document Framework"</span>, <span class="seriesInfo">RFC 5890</span>, <span class="seriesInfo">DOI 10.17487/RFC5890</span>, <time class="refDate" datetime="2010-08">August 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5890">https://www.rfc-editor.org/info/rfc5890</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6234">[RFC6234]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span> and <span class="refAuthor">T. Hansen</span>, <span class="refTitle">"US Secure Hash Algorithms (SHA and SHA-based HMAC and HKDF)"</span>, <span class="seriesInfo">RFC 6234</span>, <span class="seriesInfo">DOI 10.17487/RFC6234</span>, <time class="refDate" datetime="2011-05">May 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6234">https://www.rfc-editor.org/info/rfc6234</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6376">[RFC6376]</dt>
        <dd>
<span class="refAuthor">Crocker, D., Ed.</span>, <span class="refAuthor">Hansen, T., Ed.</span>, and <span class="refAuthor">M. Kucherawy, Ed.</span>, <span class="refTitle">"DomainKeys Identified Mail (DKIM) Signatures"</span>, <span class="seriesInfo">STD 76</span>, <span class="seriesInfo">RFC 6376</span>, <span class="seriesInfo">DOI 10.17487/RFC6376</span>, <time class="refDate" datetime="2011-09">September 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6376">https://www.rfc-editor.org/info/rfc6376</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6531">[RFC6531]</dt>
        <dd>
<span class="refAuthor">Yao, J.</span> and <span class="refAuthor">W. Mao</span>, <span class="refTitle">"SMTP Extension for Internationalized Email"</span>, <span class="seriesInfo">RFC 6531</span>, <span class="seriesInfo">DOI 10.17487/RFC6531</span>, <time class="refDate" datetime="2012-02">February 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6531">https://www.rfc-editor.org/info/rfc6531</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time class="refDate" datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8398">[RFC8398]</dt>
        <dd>
<span class="refAuthor">Melnikov, A., Ed.</span> and <span class="refAuthor">W. Chuang, Ed.</span>, <span class="refTitle">"Internationalized Email Addresses in X.509 Certificates"</span>, <span class="seriesInfo">RFC 8398</span>, <span class="seriesInfo">DOI 10.17487/RFC8398</span>, <time class="refDate" datetime="2018-05">May 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8398">https://www.rfc-editor.org/info/rfc8398</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8550">[RFC8550]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refAuthor">Ramsdell, B.</span>, and <span class="refAuthor">S. Turner</span>, <span class="refTitle">"Secure/Multipurpose Internet Mail Extensions (S/MIME) Version 4.0 Certificate Handling"</span>, <span class="seriesInfo">RFC 8550</span>, <span class="seriesInfo">DOI 10.17487/RFC8550</span>, <time class="refDate" datetime="2019-04">April 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8550">https://www.rfc-editor.org/info/rfc8550</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8551">[RFC8551]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refAuthor">Ramsdell, B.</span>, and <span class="refAuthor">S. Turner</span>, <span class="refTitle">"Secure/Multipurpose Internet Mail Extensions (S/MIME) Version 4.0 Message Specification"</span>, <span class="seriesInfo">RFC 8551</span>, <span class="seriesInfo">DOI 10.17487/RFC8551</span>, <time class="refDate" datetime="2019-04">April 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8551">https://www.rfc-editor.org/info/rfc8551</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8555">[RFC8555]</dt>
        <dd>
<span class="refAuthor">Barnes, R.</span>, <span class="refAuthor">Hoffman-Andrews, J.</span>, <span class="refAuthor">McCarney, D.</span>, and <span class="refAuthor">J. Kasten</span>, <span class="refTitle">"Automatic Certificate Management Environment (ACME)"</span>, <span class="seriesInfo">RFC 8555</span>, <span class="seriesInfo">DOI 10.17487/RFC8555</span>, <time class="refDate" datetime="2019-03">March 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8555">https://www.rfc-editor.org/info/rfc8555</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8616">[RFC8616]</dt>
      <dd>
<span class="refAuthor">Levine, J.</span>, <span class="refTitle">"Email Authentication for Internationalized Mail"</span>, <span class="seriesInfo">RFC 8616</span>, <span class="seriesInfo">DOI 10.17487/RFC8616</span>, <time class="refDate" datetime="2019-06">June 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8616">https://www.rfc-editor.org/info/rfc8616</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-7.2">
        <h3 id="name-informative-references">
<a class="section-number selfRef" href="#section-7.2">7.2. </a><a class="section-name selfRef" href="#name-informative-references">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC4021">[RFC4021]</dt>
        <dd>
<span class="refAuthor">Klyne, G.</span> and <span class="refAuthor">J. Palme</span>, <span class="refTitle">"Registration of Mail and MIME Header Fields"</span>, <span class="seriesInfo">RFC 4021</span>, <span class="seriesInfo">DOI 10.17487/RFC4021</span>, <time class="refDate" datetime="2005-03">March 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4021">https://www.rfc-editor.org/info/rfc4021</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8058">[RFC8058]</dt>
      <dd>
<span class="refAuthor">Levine, J.</span> and <span class="refAuthor">T. Herkula</span>, <span class="refTitle">"Signaling One-Click Functionality for List Email Headers"</span>, <span class="seriesInfo">RFC 8058</span>, <span class="seriesInfo">DOI 10.17487/RFC8058</span>, <time class="refDate" datetime="2017-01">January 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8058">https://www.rfc-editor.org/info/rfc8058</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<section id="section-appendix.a">
      <h2 id="name-acknowledgements">
<a class="section-name selfRef" href="#name-acknowledgements">Acknowledgements</a>
      </h2>
<p id="section-appendix.a-1">Thank you to <span class="contact-name">Andreas Schulze</span>, <span class="contact-name">Gerd v. Egidy</span>, 
      <span class="contact-name">James A. Baker</span>, <span class="contact-name">Ben Schwartz</span>,
      <span class="contact-name">Peter Yee</span>, <span class="contact-name">Hilarie Orman</span>, 
      <span class="contact-name">Michael Jenkins</span>, <span class="contact-name">Barry Leiba</span>, 
      <span class="contact-name">Fraser Tweedale</span>, <span class="contact-name">Daniel Kahn Gillmor</span>, and 
      <span class="contact-name">Benjamin Kaduk</span> for their suggestions, comments, and corrections of this document.<a class="pilcrow" href="#section-appendix.a-1">¶</a></p>
</section>
<div id="authors-addresses">
<section id="section-appendix.b">
      <h2 id="name-authors-address">
<a class="section-name selfRef" href="#name-authors-address">Author's Address</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Alexey Melnikov</span></div>
<div class="left" dir="auto"><span class="org">Isode Ltd</span></div>
<div class="left" dir="auto"><span class="street-address">14 Castle Mews</span></div>
<div class="left" dir="auto"><span class="locality">Hampton, Middlesex</span></div>
<div class="left" dir="auto"><span class="postal-code">TW12 2NP</span></div>
<div class="left" dir="auto"><span class="country-name">United Kingdom</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:alexey.melnikov@isode.com">alexey.melnikov@isode.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>


</body></html>