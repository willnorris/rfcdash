<!DOCTYPE html>
<html class="RFC" lang="en"><head>
<meta charset="utf-8"/>
<meta content="Common,Latin" name="scripts"/>
<meta content="initial-scale=1.0" name="viewport"/>
<title>RFC 9496: The ristretto255 and decaf448 Groups</title>
<meta content="Henry de Valence" name="author"/>
<meta content="Jack Grigg" name="author"/>
<meta content="Mike Hamburg" name="author"/>
<meta content="Isis Lovecruft" name="author"/>
<meta content="George Tankersley" name="author"/>
<meta content="Filippo Valsorda" name="author"/>
<meta content="
       This memo specifies two prime-order groups, ristretto255 and decaf448,
suitable for safely implementing higher-level and complex
cryptographic protocols. The ristretto255 group can be implemented
using Curve25519, allowing existing Curve25519 implementations to be
reused and extended to provide a prime-order group. Likewise, the
decaf448 group can be implemented using edwards448. 
       This document is a product of the Crypto Forum Research Group (CFRG) in the IRTF. 
    " name="description"/>
<meta content="xml2rfc 3.19.0" name="generator"/>
<meta content="cryptographic group" name="keyword"/>
<meta content="cryptography" name="keyword"/>
<meta content="Curve25519" name="keyword"/>
<meta content="ecc" name="keyword"/>
<meta content="edwards448" name="keyword"/>
<meta content="elliptic curve" name="keyword"/>
<meta content="elliptic curve cryptography" name="keyword"/>
<meta content="nonmalleable encodings" name="keyword"/>
<meta content="prime-order" name="keyword"/>
<meta content="prime order" name="keyword"/>
<meta content="9496" name="rfc.number"/>
<!-- Generator version information:
  xml2rfc 3.19.0
    Python 3.9.15
    ConfigArgParse 1.5.3
    google-i18n-address 3.0.0
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 4.9.0
    platformdirs 3.8.0
    pycountry 22.3.5
    PyYAML 6.0
    requests 2.28.0
    setuptools 44.1.1
    six 1.16.0
    wcwidth 0.2.5
    weasyprint 56.1
-->
<link href="rfc9496.xml" rel="alternate" type="application/rfc+xml"/>
<link href="#copyright" rel="license"/>
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necessary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

:root {
  --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
  --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
  --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
}

@viewport {
  zoom: 1.0;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: var(--font-sans);
  line-height: 1.6;
  scroll-behavior: smooth;
  overflow-wrap: break-word;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
svg[font-family~="serif" i], svg [font-family~="serif" i] {
  font-family: var(--font-serif);
}
svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
  font-family: var(--font-sans);
}
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre {
  background-color: #f9f9f9;
  font-family: var(--font-mono);
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
blockquote > *:last-child {
  margin-bottom: 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: var(--font-sans);
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  .breakable pre {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The following is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
.sourcecode pre,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .artwork > pre,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background slightly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottom margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the compact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div.sourcecode:first-child,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type:only-child {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css"/>
<link href="https://datatracker.ietf.org/doc/draft-irtf-cfrg-ristretto255-decaf448-08" rel="prev"/>
  <link href="https://dx.doi.org/10.17487/rfc9496" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  </head>
<body class="xml2rfc">
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 9496</td>
<td class="center">ristretto255-decaf448</td>
<td class="right">December 2023</td>
</tr></thead>
<tfoot><tr>
<td class="left">de Valence, et al.</td>
<td class="center">Informational</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div class="document-information" id="external-metadata"></div>
<div class="document-information" id="internal-metadata">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Research Task Force (IRTF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a class="eref" href="https://www.rfc-editor.org/rfc/rfc9496">9496</a></dd>
<dt class="label-category">Category:</dt>
<dd class="category">Informational</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time class="published" datetime="2023-12">December 2023</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">H. de Valence</div>
</div>
<div class="author">
      <div class="author-name">J. Grigg</div>
</div>
<div class="author">
      <div class="author-name">M. Hamburg</div>
</div>
<div class="author">
      <div class="author-name">I. Lovecruft</div>
</div>
<div class="author">
      <div class="author-name">G. Tankersley</div>
</div>
<div class="author">
      <div class="author-name">F. Valsorda</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 9496</h1>
<h1 id="title">The ristretto255 and decaf448 Groups</h1>
<section id="section-abstract">
      <h2 id="abstract"><a class="selfRef" href="#abstract">Abstract</a></h2>
<p id="section-abstract-1">This memo specifies two prime-order groups, ristretto255 and decaf448,
suitable for safely implementing higher-level and complex
cryptographic protocols. The ristretto255 group can be implemented
using Curve25519, allowing existing Curve25519 implementations to be
reused and extended to provide a prime-order group. Likewise, the
decaf448 group can be implemented using edwards448.<a class="pilcrow" href="#section-abstract-1">¶</a></p>
<p id="section-abstract-2">This document is a product of the Crypto Forum Research Group (CFRG) in the IRTF.<a class="pilcrow" href="#section-abstract-2">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a class="section-name selfRef" href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This document is not an Internet Standards Track specification; it is
            published for informational purposes.<a class="pilcrow" href="#section-boilerplate.1-1">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Research Task Force
            (IRTF).  The IRTF publishes the results of Internet-related
            research and development activities.  These results might not be
            suitable for deployment.  This RFC represents the consensus of the Crypto Forum
            Research Group of the Internet Research Task Force (IRTF).
            Documents approved for publication by the IRSG are not
            candidates for any level of Internet Standard; see Section 2 of RFC
            7841.<a class="pilcrow" href="#section-boilerplate.1-2">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc9496">https://www.rfc-editor.org/info/rfc9496</a></span>.<a class="pilcrow" href="#section-boilerplate.1-3">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a class="section-name selfRef" href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2023 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a class="pilcrow" href="#section-boilerplate.2-1">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document.<a class="pilcrow" href="#section-boilerplate.2-2">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a class="toplink" href="#" onclick="scroll(0,0)">▲</a><h2 id="name-table-of-contents">
<a class="section-name selfRef" href="#name-table-of-contents">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p class="keepWithNext" id="section-toc.1-1.1.1"><a class="auto internal xref" href="#section-1">1</a>.  <a class="internal xref" href="#name-introduction">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a class="auto internal xref" href="#section-2">2</a>.  <a class="internal xref" href="#name-notation-and-conventions-us">Notation and Conventions Used in This Document</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p class="keepWithNext" id="section-toc.1-1.2.2.1.1"><a class="auto internal xref" href="#section-2.1">2.1</a>.  <a class="internal xref" href="#name-negative-field-elements">Negative Field Elements</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p class="keepWithNext" id="section-toc.1-1.2.2.2.1"><a class="auto internal xref" href="#section-2.2">2.2</a>.  <a class="internal xref" href="#name-constant-time-operations">Constant-Time Operations</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a class="auto internal xref" href="#section-3">3</a>.  <a class="internal xref" href="#name-the-group-abstraction">The Group Abstraction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a class="auto internal xref" href="#section-4">4</a>.  <a class="internal xref" href="#name-ristretto255">ristretto255</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a class="auto internal xref" href="#section-4.1">4.1</a>.  <a class="internal xref" href="#name-implementation-constants">Implementation Constants</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a class="auto internal xref" href="#section-4.2">4.2</a>.  <a class="internal xref" href="#name-square-root-of-a-ratio-of-f">Square Root of a Ratio of Field Elements</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a class="auto internal xref" href="#section-4.3">4.3</a>.  <a class="internal xref" href="#name-ristretto255-group-operatio">ristretto255 Group Operations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.1">
                    <p id="section-toc.1-1.4.2.3.2.1.1"><a class="auto internal xref" href="#section-4.3.1">4.3.1</a>.  <a class="internal xref" href="#name-decode">Decode</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.2">
                    <p id="section-toc.1-1.4.2.3.2.2.1"><a class="auto internal xref" href="#section-4.3.2">4.3.2</a>.  <a class="internal xref" href="#name-encode">Encode</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.3">
                    <p id="section-toc.1-1.4.2.3.2.3.1"><a class="auto internal xref" href="#section-4.3.3">4.3.3</a>.  <a class="internal xref" href="#name-equals">Equals</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.4">
                    <p id="section-toc.1-1.4.2.3.2.4.1"><a class="auto internal xref" href="#section-4.3.4">4.3.4</a>.  <a class="internal xref" href="#name-element-derivation">Element Derivation</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a class="auto internal xref" href="#section-4.4">4.4</a>.  <a class="internal xref" href="#name-scalar-field">Scalar Field</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a class="auto internal xref" href="#section-5">5</a>.  <a class="internal xref" href="#name-decaf448">decaf448</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a class="auto internal xref" href="#section-5.1">5.1</a>.  <a class="internal xref" href="#name-implementation-constants-2">Implementation Constants</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a class="auto internal xref" href="#section-5.2">5.2</a>.  <a class="internal xref" href="#name-square-root-of-a-ratio-of-fi">Square Root of a Ratio of Field Elements</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a class="auto internal xref" href="#section-5.3">5.3</a>.  <a class="internal xref" href="#name-decaf448-group-operations">decaf448 Group Operations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.1">
                    <p id="section-toc.1-1.5.2.3.2.1.1"><a class="auto internal xref" href="#section-5.3.1">5.3.1</a>.  <a class="internal xref" href="#name-decode-2">Decode</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.2">
                    <p id="section-toc.1-1.5.2.3.2.2.1"><a class="auto internal xref" href="#section-5.3.2">5.3.2</a>.  <a class="internal xref" href="#name-encode-2">Encode</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.3">
                    <p id="section-toc.1-1.5.2.3.2.3.1"><a class="auto internal xref" href="#section-5.3.3">5.3.3</a>.  <a class="internal xref" href="#name-equals-2">Equals</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.4">
                    <p id="section-toc.1-1.5.2.3.2.4.1"><a class="auto internal xref" href="#section-5.3.4">5.3.4</a>.  <a class="internal xref" href="#name-element-derivation-2">Element Derivation</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a class="auto internal xref" href="#section-5.4">5.4</a>.  <a class="internal xref" href="#name-scalar-field-2">Scalar Field</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a class="auto internal xref" href="#section-6">6</a>.  <a class="internal xref" href="#name-api-considerations">API Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a class="auto internal xref" href="#section-7">7</a>.  <a class="internal xref" href="#name-iana-considerations">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a class="auto internal xref" href="#section-8">8</a>.  <a class="internal xref" href="#name-security-considerations">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a class="auto internal xref" href="#section-9">9</a>.  <a class="internal xref" href="#name-references">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a class="auto internal xref" href="#section-9.1">9.1</a>.  <a class="internal xref" href="#name-normative-references">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a class="auto internal xref" href="#section-9.2">9.2</a>.  <a class="internal xref" href="#name-informative-references">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a class="auto internal xref" href="#appendix-A">Appendix A</a>.  <a class="internal xref" href="#name-test-vectors-for-ristretto2">Test Vectors for ristretto255</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a class="auto internal xref" href="#appendix-A.1">A.1</a>.  <a class="internal xref" href="#name-multiples-of-the-generator">Multiples of the Generator</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a class="auto internal xref" href="#appendix-A.2">A.2</a>.  <a class="internal xref" href="#name-invalid-encodings">Invalid Encodings</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.3">
                <p id="section-toc.1-1.10.2.3.1"><a class="auto internal xref" href="#appendix-A.3">A.3</a>.  <a class="internal xref" href="#name-group-elements-from-uniform">Group Elements from Uniform Byte Strings</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.4">
                <p id="section-toc.1-1.10.2.4.1"><a class="auto internal xref" href="#appendix-A.4">A.4</a>.  <a class="internal xref" href="#name-square-root-of-a-ratio-of-fie">Square Root of a Ratio of Field Elements</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a class="auto internal xref" href="#appendix-B">Appendix B</a>.  <a class="internal xref" href="#name-test-vectors-for-decaf448">Test Vectors for decaf448</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a class="auto internal xref" href="#appendix-B.1">B.1</a>.  <a class="internal xref" href="#name-multiples-of-the-generator-2">Multiples of the Generator</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a class="auto internal xref" href="#appendix-B.2">B.2</a>.  <a class="internal xref" href="#name-invalid-encodings-2">Invalid Encodings</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.3">
                <p id="section-toc.1-1.11.2.3.1"><a class="auto internal xref" href="#appendix-B.3">B.3</a>.  <a class="internal xref" href="#name-group-elements-from-uniform-">Group Elements from Uniform Byte Strings</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a class="auto internal xref" href="#appendix-C"></a><a class="internal xref" href="#name-acknowledgements">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a class="auto internal xref" href="#appendix-D"></a><a class="internal xref" href="#name-authors-addresses">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a class="section-number selfRef" href="#section-1">1. </a><a class="section-name selfRef" href="#name-introduction">Introduction</a>
      </h2>
<p id="section-1-1">Decaf <span>[<a class="cite xref" href="#Decaf">Decaf</a>]</span> is a technique for constructing prime-order groups
with nonmalleable encodings from non-prime-order elliptic curves.
Ristretto extends this technique to support cofactor-8 curves such as
Curve25519 <span>[<a class="cite xref" href="#RFC7748">RFC7748</a>]</span>. In particular, this allows an existing
Curve25519 library to provide a prime-order group with only a thin
abstraction layer.<a class="pilcrow" href="#section-1-1">¶</a></p>
<p id="section-1-2">Many group-based cryptographic protocols require the number of
elements in the group (the group order) to be prime. Prime-order
groups are useful because every non-identity element of the group
is a generator of the entire group. This means the group has a
cofactor of 1, and all elements are equivalent from the perspective
of hardness of the discrete logarithm problem.<a class="pilcrow" href="#section-1-2">¶</a></p>
<p id="section-1-3">Edwards curves provide a number of implementation benefits for
cryptography. These benefits include formulas for curve operations
that are among the fastest currently known, and for which the
addition formulas are complete with no exceptional points.
However, the group of points on the curve is not of prime order,
i.e., it has a cofactor larger than 1. This abstraction mismatch is
usually handled, if it is handled at all, by means of ad hoc protocol
tweaks such as multiplying by the cofactor in an appropriate place.<a class="pilcrow" href="#section-1-3">¶</a></p>
<p id="section-1-4">Even for simple protocols such as signatures, these tweaks can cause
subtle issues. For instance, Ed25519 implementations may have
different validation behavior between batched and singleton
verification, and at least as specified in <span>[<a class="cite xref" href="#RFC8032">RFC8032</a>]</span>, the set of
valid signatures is not defined precisely <span>[<a class="cite xref" href="#Ed25519ValidCrit">Ed25519ValidCrit</a>]</span>.<a class="pilcrow" href="#section-1-4">¶</a></p>
<p id="section-1-5">For more complex protocols, careful analysis is required as the
original security proofs may no longer apply, and the tweaks for one
protocol may have disastrous effects when applied to another (for
instance, the octuple-spend vulnerability described in <span>[<a class="cite xref" href="#MoneroVuln">MoneroVuln</a>]</span>).<a class="pilcrow" href="#section-1-5">¶</a></p>
<p id="section-1-6">Decaf and Ristretto fix this abstraction mismatch in one place for
all protocols, providing an abstraction to protocol implementors that
matches the abstraction commonly assumed in protocol specifications
while still allowing the use of high-performance curve
implementations internally. The abstraction layer imposes minor
overhead but only in the encoding and decoding phases.<a class="pilcrow" href="#section-1-6">¶</a></p>
<p id="section-1-7">While Ristretto is a general method and can be used in conjunction
with any Edwards curve with cofactor 4 or 8, this document specifies
the ristretto255 group, which can be implemented using Curve25519,
and the decaf448 group, which can be implemented using edwards448.<a class="pilcrow" href="#section-1-7">¶</a></p>
<p id="section-1-8">There are other elliptic curves that can be used internally to
implement ristretto255 or decaf448; those implementations would be
interoperable with one based on Curve25519 or edwards448, but those
constructions are out of scope for this document.<a class="pilcrow" href="#section-1-8">¶</a></p>
<p id="section-1-9">The Ristretto construction is described and justified in detail at
<span>[<a class="cite xref" href="#RistrettoGroup">RistrettoGroup</a>]</span>.<a class="pilcrow" href="#section-1-9">¶</a></p>
<p id="section-1-10">This document represents the consensus of the Crypto Forum Research Group (CFRG).
This document is not an IETF product and is not a standard.<a class="pilcrow" href="#section-1-10">¶</a></p>
</section>
</div>
<div id="notation-and-conventions-used-in-this-document">
<section id="section-2">
      <h2 id="name-notation-and-conventions-us">
<a class="section-number selfRef" href="#section-2">2. </a><a class="section-name selfRef" href="#name-notation-and-conventions-us">Notation and Conventions Used in This Document</a>
      </h2>
<p id="section-2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>",
"<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>",
"<span class="bcp14">NOT RECOMMENDED</span>", "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document
are to be interpreted as described in BCP 14 <span>[<a class="cite xref" href="#RFC2119">RFC2119</a>]</span> <span>[<a class="cite xref" href="#RFC8174">RFC8174</a>]</span>
when, and only when, they appear in all capitals, as shown here.<a class="pilcrow" href="#section-2-1">¶</a></p>
<p id="section-2-2">Readers are cautioned that the term "Curve25519" has varying
interpretations in the literature and that the canonical meaning of the
term has shifted over time. Originally, it referred to a specific
Diffie-Hellman key exchange mechanism. Use shifted over time, and
"Curve25519" has been used to refer to the abstract underlying
curve, its concrete representation in Montgomery form, or the
specific Diffie-Hellman mechanism. This document uses the term
"Curve25519" to refer to the abstract underlying curve, as recommended
in <span>[<a class="cite xref" href="#Naming">Naming</a>]</span>. The abstract Edwards form of the curve we refer to here
as "Curve25519" is referred to in <span>[<a class="cite xref" href="#RFC7748">RFC7748</a>]</span> as "edwards25519",
and the Montgomery form that is isogenous to the Edwards form is
referred to in <span>[<a class="cite xref" href="#RFC7748">RFC7748</a>]</span> as "curve25519".<a class="pilcrow" href="#section-2-2">¶</a></p>
<p id="section-2-3">Elliptic curve points in this document are represented in extended
Edwards coordinates in the <code>(x, y, z, t)</code> format <span>[<a class="cite xref" href="#Twisted">Twisted</a>]</span>, also called
extended homogeneous coordinates in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc8032#section-5.1.4">Section 5.1.4</a> of [<a class="cite xref" href="#RFC8032">RFC8032</a>]</span>. Field
elements are values modulo p, the Curve25519 prime 2<sup>255</sup> - 19 or the
edwards448 prime 2<sup>448</sup> - 2<sup>224</sup> - 1, as specified in Sections
<a class="relref" href="https://rfc-editor.org/rfc/rfc7748#section-4.1">4.1</a> and <a class="relref" href="https://rfc-editor.org/rfc/rfc7748#section-4.2">4.2</a> of <span>[<a class="cite xref" href="#RFC7748">RFC7748</a>]</span>, respectively. All
formulas specify field operations unless otherwise noted. The symbol
<code>^</code> denotes exponentiation.<a class="pilcrow" href="#section-2-3">¶</a></p>
<p id="section-2-4">The <code>|</code> symbol represents a constant-time logical OR.<a class="pilcrow" href="#section-2-4">¶</a></p>
<p id="section-2-5">The notation <code>array[A:B]</code> means the elements of <code>array</code> from <code>A</code>
to <code>B-1</code>. That is, it is exclusive of <code>B</code>. Arrays are indexed
starting from 0.<a class="pilcrow" href="#section-2-5">¶</a></p>
<p id="section-2-6">A byte is an 8-bit entity (also known as "octet"), and a byte string
is an ordered sequence of bytes. An N-byte string is a byte string of
N bytes in length.<a class="pilcrow" href="#section-2-6">¶</a></p>
<p id="section-2-7">Element encodings are presented as hex-encoded byte strings with
whitespace added for readability.<a class="pilcrow" href="#section-2-7">¶</a></p>
<div id="negative-field-elements">
<section id="section-2.1">
        <h3 id="name-negative-field-elements">
<a class="section-number selfRef" href="#section-2.1">2.1. </a><a class="section-name selfRef" href="#name-negative-field-elements">Negative Field Elements</a>
        </h3>
<p id="section-2.1-1">As in <span>[<a class="cite xref" href="#RFC8032">RFC8032</a>]</span>, given a field element e, define <code>IS_NEGATIVE(e)</code> as
TRUE if the least nonnegative integer representing e is odd and
FALSE if it is even. This <span class="bcp14">SHOULD</span> be implemented in constant time.<a class="pilcrow" href="#section-2.1-1">¶</a></p>
</section>
</div>
<div id="constant-time-operations">
<section id="section-2.2">
        <h3 id="name-constant-time-operations">
<a class="section-number selfRef" href="#section-2.2">2.2. </a><a class="section-name selfRef" href="#name-constant-time-operations">Constant-Time Operations</a>
        </h3>
<p id="section-2.2-1">We assume that the field element implementation supports the following
operations, which <span class="bcp14">SHOULD</span> be implemented in constant time:<a class="pilcrow" href="#section-2.2-1">¶</a></p>
<ul class="compact">
<li class="compact" id="section-2.2-2.1">
            <code>CT_EQ(u, v)</code>: return TRUE if u = v, FALSE otherwise.<a class="pilcrow" href="#section-2.2-2.1">¶</a>
</li>
          <li class="compact" id="section-2.2-2.2">
            <code>CT_SELECT(v IF cond ELSE u)</code>: return v if cond is TRUE, else return u.<a class="pilcrow" href="#section-2.2-2.2">¶</a>
</li>
          <li class="compact" id="section-2.2-2.3">
            <code>CT_ABS(u)</code>: return -u if <code>IS_NEGATIVE(u)</code>, else return u.<a class="pilcrow" href="#section-2.2-2.3">¶</a>
</li>
        </ul>
<p id="section-2.2-3">Note that <code>CT_ABS</code> <span class="bcp14">MAY</span> be implemented as:<a class="pilcrow" href="#section-2.2-3">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2-4">
<pre>CT_SELECT(-u IF IS_NEGATIVE(u) ELSE u)
</pre><a class="pilcrow" href="#section-2.2-4">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="interface">
<section id="section-3">
      <h2 id="name-the-group-abstraction">
<a class="section-number selfRef" href="#section-3">3. </a><a class="section-name selfRef" href="#name-the-group-abstraction">The Group Abstraction</a>
      </h2>
<p id="section-3-1">Ristretto and Decaf implement an abstract prime-order group interface
that exposes only the behavior that is useful to higher-level protocols,
without leaking curve-related details and pitfalls.<a class="pilcrow" href="#section-3-1">¶</a></p>
<p id="section-3-2">Each abstract group exposes operations on abstract element and abstract
scalar types. The operations defined on these types include: decoding, encoding,
equality, addition, negation, subtraction, and (multi-)scalar multiplication.
Each abstract group also exposes a deterministic function to derive abstract
elements from fixed-length byte strings. A description of each of these
operations is below.<a class="pilcrow" href="#section-3-2">¶</a></p>
<p id="section-3-3">Decoding is a function from byte strings to abstract elements with
built-in validation, so that only the canonical encodings of valid
elements are accepted. The built-in validation avoids the need for
explicit invalid curve checks.<a class="pilcrow" href="#section-3-3">¶</a></p>
<p id="section-3-4">Encoding is a function from abstract elements to byte strings.  Internally,
an abstract element might have more than one possible representation; for
example, the implementation might use projective coordinates.  When encoding,
all equivalent representations of the same element are encoded as identical
byte strings. Decoding the output of the encoding function always
succeeds and returns an element equivalent to the encoding input.<a class="pilcrow" href="#section-3-4">¶</a></p>
<p id="section-3-5">The equality check reports whether two representations of an abstract
element are equivalent.<a class="pilcrow" href="#section-3-5">¶</a></p>
<p id="section-3-6">The element derivation function maps deterministically from byte strings of
a fixed length to abstract elements.  It has two important properties.  First,
if the input is a uniformly random byte string, then the output is (within
a negligible statistical distance of) a uniformly random abstract group
element.  This means the function is suitable for selecting random group
elements.<a class="pilcrow" href="#section-3-6">¶</a></p>
<p id="section-3-7">Second, although the element derivation function is many-to-one and therefore
not strictly invertible, it is not pre-image resistant.  On the contrary,
given an arbitrary abstract group element <code>P</code>, there is an efficient algorithm
to randomly sample from byte strings that map to <code>P</code>.  In some contexts, this
property would be a weakness, but it is important in some contexts: in particular,
it means that a combination of a cryptographic hash function and the element
derivation function is suitable to define encoding functions such as
<code>hash_to_ristretto255</code> (<span><a class="relref" href="https://rfc-editor.org/rfc/rfc9380#appendix-B">Appendix B</a> of [<a class="cite xref" href="#RFC9380">RFC9380</a>]</span>) and <code>hash_to_decaf448</code>
(<span><a class="relref" href="https://rfc-editor.org/rfc/rfc9380#appendix-C">Appendix C</a> of [<a class="cite xref" href="#RFC9380">RFC9380</a>]</span>).<a class="pilcrow" href="#section-3-7">¶</a></p>
<p id="section-3-8">Addition is the group operation. The group has an identity element and
prime order <code>l</code>. Adding together <code>l</code> copies of the same element gives the
identity. Adding the identity element to
any element returns that element unchanged. Negation returns an element
that, when added to the negation input, gives the identity element.
Subtraction is the addition of a negated element, and scalar
multiplication is the repeated addition of an element.<a class="pilcrow" href="#section-3-8">¶</a></p>
</section>
</div>
<div id="ristretto255">
<section id="section-4">
      <h2 id="name-ristretto255">
<a class="section-number selfRef" href="#section-4">4. </a><a class="section-name selfRef" href="#name-ristretto255">ristretto255</a>
      </h2>
<p id="section-4-1">ristretto255 is an instantiation of the abstract prime-order group
interface defined in <a class="auto internal xref" href="#interface">Section 3</a>. This document describes how to
implement the ristretto255 prime-order group using Curve25519 points as
internal representations.<a class="pilcrow" href="#section-4-1">¶</a></p>
<p id="section-4-2">A "ristretto255 group element" is the abstract element of the
prime-order group. An "element encoding" is the unique reversible encoding
of a group element. An "internal representation" is a point on the
curve used to implement ristretto255. Each group element can have
multiple equivalent internal representations.<a class="pilcrow" href="#section-4-2">¶</a></p>
<p id="section-4-3">Encoding, decoding, equality, and the element derivation function are defined in
<a class="auto internal xref" href="#functions255">Section 4.3</a>. Element addition, subtraction, negation, and scalar
multiplication are implemented by applying the corresponding operations
directly to the internal representation.<a class="pilcrow" href="#section-4-3">¶</a></p>
<p id="section-4-4">The group order is the same as the order of the Curve25519 prime-order subgroup:<a class="pilcrow" href="#section-4-4">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4-5">
<pre>l = 2^252 + 27742317777372353535851937790883648493
</pre><a class="pilcrow" href="#section-4-5">¶</a>
</div>
<p id="section-4-6">Since ristretto255 is a prime-order group, every element except the
identity is a generator.  However, for interoperability, a canonical
generator is selected, which can be internally represented by the
Curve25519 base point, enabling reuse of existing precomputation for
scalar multiplication. The encoding of this canonical generator, as
produced by the function specified in <a class="auto internal xref" href="#encoding255">Section 4.3.2</a>, is:<a class="pilcrow" href="#section-4-6">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4-7">
<pre>e2f2ae0a 6abc4e71 a884a961 c500515f 58e30b6a a582dd8d b6a65945 e08d2d76
</pre><a class="pilcrow" href="#section-4-7">¶</a>
</div>
<div id="constants255">
<section id="section-4.1">
        <h3 id="name-implementation-constants">
<a class="section-number selfRef" href="#section-4.1">4.1. </a><a class="section-name selfRef" href="#name-implementation-constants">Implementation Constants</a>
        </h3>
<p id="section-4.1-1">This document references the following constant field element values
that are used for the implementation of group operations.<a class="pilcrow" href="#section-4.1-1">¶</a></p>
<ul class="compact">
<li class="compact" id="section-4.1-2.1">
            <p id="section-4.1-2.1.1"><code>D</code> = 37095705934669439343138083508754565189542113879843219016388785533085940283555<a class="pilcrow" href="#section-4.1-2.1.1">¶</a></p>
<ul class="compact">
<li class="compact" id="section-4.1-2.1.2.1">This is the Edwards d parameter for Curve25519, as specified in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc7748#section-4.1">Section 4.1</a> of [<a class="cite xref" href="#RFC7748">RFC7748</a>]</span>.<a class="pilcrow" href="#section-4.1-2.1.2.1">¶</a>
</li>
            </ul>
</li>
          <li class="compact" id="section-4.1-2.2">
            <code>SQRT_M1</code> = 19681161376707505956807079304988542015446066515923890162744021073123829784752<a class="pilcrow" href="#section-4.1-2.2">¶</a>
</li>
          <li class="compact" id="section-4.1-2.3">
            <code>SQRT_AD_MINUS_ONE</code> = 25063068953384623474111414158702152701244531502492656460079210482610430750235<a class="pilcrow" href="#section-4.1-2.3">¶</a>
</li>
          <li class="compact" id="section-4.1-2.4">
            <code>INVSQRT_A_MINUS_D</code> = 54469307008909316920995813868745141605393597292927456921205312896311721017578<a class="pilcrow" href="#section-4.1-2.4">¶</a>
</li>
          <li class="compact" id="section-4.1-2.5">
            <code>ONE_MINUS_D_SQ</code> = 1159843021668779879193775521855586647937357759715417654439879720876111806838<a class="pilcrow" href="#section-4.1-2.5">¶</a>
</li>
          <li class="compact" id="section-4.1-2.6">
            <code>D_MINUS_ONE_SQ</code> = 40440834346308536858101042469323190826248399146238708352240133220865137265952<a class="pilcrow" href="#section-4.1-2.6">¶</a>
</li>
        </ul>
</section>
</div>
<div id="sqrtratio255">
<section id="section-4.2">
        <h3 id="name-square-root-of-a-ratio-of-f">
<a class="section-number selfRef" href="#section-4.2">4.2. </a><a class="section-name selfRef" href="#name-square-root-of-a-ratio-of-f">Square Root of a Ratio of Field Elements</a>
        </h3>
<p id="section-4.2-1">The following function is defined on field elements and is used to
implement other ristretto255 functions. This function is only used internally
to implement some of the group operations.<a class="pilcrow" href="#section-4.2-1">¶</a></p>
<p id="section-4.2-2">On input field elements u and v, the function <code>SQRT_RATIO_M1(u, v)</code> returns:<a class="pilcrow" href="#section-4.2-2">¶</a></p>
<ul class="compact">
<li class="compact" id="section-4.2-3.1">
            <code>(TRUE, +sqrt(u/v))</code> if u and v are nonzero and u/v is square in the field;<a class="pilcrow" href="#section-4.2-3.1">¶</a>
</li>
          <li class="compact" id="section-4.2-3.2">
            <code>(TRUE, zero)</code> if u is zero;<a class="pilcrow" href="#section-4.2-3.2">¶</a>
</li>
          <li class="compact" id="section-4.2-3.3">
            <code>(FALSE, zero)</code> if v is zero and u is nonzero; and<a class="pilcrow" href="#section-4.2-3.3">¶</a>
</li>
          <li class="compact" id="section-4.2-3.4">
            <code>(FALSE, +sqrt(SQRT_M1*(u/v)))</code> if u and v are nonzero and u/v is
non-square in the field (so <code>SQRT_M1*(u/v)</code> is square in the field),<a class="pilcrow" href="#section-4.2-3.4">¶</a>
</li>
        </ul>
<p id="section-4.2-4">where <code>+sqrt(x)</code> indicates the nonnegative square root of x in the
field.<a class="pilcrow" href="#section-4.2-4">¶</a></p>
<p id="section-4.2-5">The computation is similar to what is described in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc8032#section-5.1.3">Section 5.1.3</a> of [<a class="cite xref" href="#RFC8032">RFC8032</a>]</span>, with the
difference that, if the input is non-square, the function returns a
result with a defined relationship to the inputs. This result is used
for efficient implementation of the derivation function. The function
can be refactored from an existing Ed25519 implementation.<a class="pilcrow" href="#section-4.2-5">¶</a></p>
<p id="section-4.2-6"><code>SQRT_RATIO_M1(u, v)</code> is defined as follows:<a class="pilcrow" href="#section-4.2-6">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2-7">
<pre>r = (u * v^3) * (u * v^7)^((p-5)/8) // Note: (p - 5) / 8 is an integer.
check = v * r^2

correct_sign_sqrt   = CT_EQ(check,          u)
flipped_sign_sqrt   = CT_EQ(check,         -u)
flipped_sign_sqrt_i = CT_EQ(check, -u*SQRT_M1)

r_prime = SQRT_M1 * r
r = CT_SELECT(r_prime IF flipped_sign_sqrt | flipped_sign_sqrt_i ELSE r)

// Choose the nonnegative square root.
r = CT_ABS(r)

was_square = correct_sign_sqrt | flipped_sign_sqrt

return (was_square, r)
</pre><a class="pilcrow" href="#section-4.2-7">¶</a>
</div>
</section>
</div>
<div id="functions255">
<section id="section-4.3">
        <h3 id="name-ristretto255-group-operatio">
<a class="section-number selfRef" href="#section-4.3">4.3. </a><a class="section-name selfRef" href="#name-ristretto255-group-operatio">ristretto255 Group Operations</a>
        </h3>
<p id="section-4.3-1">This section describes the implementation of the external functions
exposed by the ristretto255 prime-order group.<a class="pilcrow" href="#section-4.3-1">¶</a></p>
<div id="decoding255">
<section id="section-4.3.1">
          <h4 id="name-decode">
<a class="section-number selfRef" href="#section-4.3.1">4.3.1. </a><a class="section-name selfRef" href="#name-decode">Decode</a>
          </h4>
<p id="section-4.3.1-1">All elements are encoded as 32-byte strings. Decoding proceeds as follows:<a class="pilcrow" href="#section-4.3.1-1">¶</a></p>
<ol class="compact type-1" id="section-4.3.1-2" start="1" type="1">
<li id="section-4.3.1-2.1">Interpret the string as an unsigned integer s in little-endian
representation. If the length of the string is not 32 bytes or if
the resulting value is &gt;= p, decoding fails.<a class="pilcrow" href="#section-4.3.1-2.1">¶</a>
</li>
          </ol>
<aside id="section-4.3.1-3">
            <p id="section-4.3.1-3.1">Note: Unlike the field element decoding described in <span>[<a class="cite xref" href="#RFC7748">RFC7748</a>]</span>, the most significant
bit is not masked, and non-canonical values are rejected.
The test vectors in <a class="auto internal xref" href="#invalid255">Appendix A.2</a> exercise these edge cases.<a class="pilcrow" href="#section-4.3.1-3.1">¶</a></p>
</aside>
<ol class="compact type-1" id="section-4.3.1-4" start="2" type="1">
<li id="section-4.3.1-4.1">If <code>IS_NEGATIVE(s)</code> returns TRUE, decoding fails.<a class="pilcrow" href="#section-4.3.1-4.1">¶</a>
</li>
            <li id="section-4.3.1-4.2">Process s as follows:<a class="pilcrow" href="#section-4.3.1-4.2">¶</a>
</li>
          </ol>
<div class="alignLeft art-text artwork" id="section-4.3.1-5">
<pre>ss = s^2
u1 = 1 - ss
u2 = 1 + ss
u2_sqr = u2^2

v = -(D * u1^2) - u2_sqr

(was_square, invsqrt) = SQRT_RATIO_M1(1, v * u2_sqr)

den_x = invsqrt * u2
den_y = invsqrt * den_x * v

x = CT_ABS(2 * s * den_x)
y = u1 * den_y
t = x * y
</pre><a class="pilcrow" href="#section-4.3.1-5">¶</a>
</div>
<ol class="compact type-1" id="section-4.3.1-6" start="4" type="1">
<li id="section-4.3.1-6.1">If was_square is FALSE, <code>IS_NEGATIVE(t)</code> returns TRUE, or y =
0, decoding fails. Otherwise, return the group element represented
by the internal representation <code>(x, y, 1, t)</code> as the result of
decoding.<a class="pilcrow" href="#section-4.3.1-6.1">¶</a>
</li>
          </ol>
</section>
</div>
<div id="encoding255">
<section id="section-4.3.2">
          <h4 id="name-encode">
<a class="section-number selfRef" href="#section-4.3.2">4.3.2. </a><a class="section-name selfRef" href="#name-encode">Encode</a>
          </h4>
<p id="section-4.3.2-1">A group element with internal representation <code>(x0, y0, z0, t0)</code> is
encoded as follows:<a class="pilcrow" href="#section-4.3.2-1">¶</a></p>
<ol class="compact type-1" id="section-4.3.2-2" start="1" type="1">
<li id="section-4.3.2-2.1">Process the internal representation into a field element s as follows:<a class="pilcrow" href="#section-4.3.2-2.1">¶</a>
</li>
          </ol>
<div class="alignLeft art-text artwork" id="section-4.3.2-3">
<pre>u1 = (z0 + y0) * (z0 - y0)
u2 = x0 * y0

// Ignore was_square since this is always square.
(_, invsqrt) = SQRT_RATIO_M1(1, u1 * u2^2)

den1 = invsqrt * u1
den2 = invsqrt * u2
z_inv = den1 * den2 * t0

ix0 = x0 * SQRT_M1
iy0 = y0 * SQRT_M1
enchanted_denominator = den1 * INVSQRT_A_MINUS_D

rotate = IS_NEGATIVE(t0 * z_inv)

// Conditionally rotate x and y.
x = CT_SELECT(iy0 IF rotate ELSE x0)
y = CT_SELECT(ix0 IF rotate ELSE y0)
z = z0
den_inv = CT_SELECT(enchanted_denominator IF rotate ELSE den2)

y = CT_SELECT(-y IF IS_NEGATIVE(x * z_inv) ELSE y)

s = CT_ABS(den_inv * (z - y))
</pre><a class="pilcrow" href="#section-4.3.2-3">¶</a>
</div>
<ol class="compact type-1" id="section-4.3.2-4" start="2" type="1">
<li id="section-4.3.2-4.1">Return the 32-byte little-endian encoding of s.  More specifically,
this is the encoding of the canonical representation of s as an integer
between 0 and p-1, inclusive.<a class="pilcrow" href="#section-4.3.2-4.1">¶</a>
</li>
          </ol>
<p id="section-4.3.2-5">Note that decoding and then re-encoding a valid group element will
yield an identical byte string.<a class="pilcrow" href="#section-4.3.2-5">¶</a></p>
</section>
</div>
<div id="equals255">
<section id="section-4.3.3">
          <h4 id="name-equals">
<a class="section-number selfRef" href="#section-4.3.3">4.3.3. </a><a class="section-name selfRef" href="#name-equals">Equals</a>
          </h4>
<p id="section-4.3.3-1">The equality function returns TRUE when two internal representations
correspond to the same group element. Note that internal representations
<span class="bcp14">MUST NOT</span> be compared in any way other than specified here.<a class="pilcrow" href="#section-4.3.3-1">¶</a></p>
<p id="section-4.3.3-2">For two internal representations <code>(x1, y1, z1, t1)</code> and <code>(x2, y2, z2, t2)</code>,
if<a class="pilcrow" href="#section-4.3.3-2">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.3.3-3">
<pre>CT_EQ(x1 * y2, y1 * x2) | CT_EQ(y1 * y2, x1 * x2)
</pre><a class="pilcrow" href="#section-4.3.3-3">¶</a>
</div>
<p id="section-4.3.3-4">evaluates to TRUE, then return TRUE. Otherwise, return FALSE.<a class="pilcrow" href="#section-4.3.3-4">¶</a></p>
<p id="section-4.3.3-5">Note that the equality function always returns TRUE when applied to an
internal representation and to the internal representation obtained by
encoding and then re-decoding it. However, the internal
representations themselves might not be identical.<a class="pilcrow" href="#section-4.3.3-5">¶</a></p>
<p id="section-4.3.3-6">Implementations <span class="bcp14">MAY</span> also perform constant-time byte comparisons on the encodings
of group elements (produced by <a class="auto internal xref" href="#encoding255">Section 4.3.2</a>) for an equivalent, although
less efficient, result.<a class="pilcrow" href="#section-4.3.3-6">¶</a></p>
</section>
</div>
<div id="from_bytes_uniform255">
<section id="section-4.3.4">
          <h4 id="name-element-derivation">
<a class="section-number selfRef" href="#section-4.3.4">4.3.4. </a><a class="section-name selfRef" href="#name-element-derivation">Element Derivation</a>
          </h4>
<p id="section-4.3.4-1">The element derivation function operates on 64-byte strings.
To obtain such an input from an arbitrary-length byte string, applications
should use a domain-separated hash construction, the choice of which
is out of scope for this document.<a class="pilcrow" href="#section-4.3.4-1">¶</a></p>
<p id="section-4.3.4-2">The element derivation function on an input string b proceeds as follows:<a class="pilcrow" href="#section-4.3.4-2">¶</a></p>
<ol class="compact type-1" id="section-4.3.4-3" start="1" type="1">
<li id="section-4.3.4-3.1">Compute P1 as <code>MAP(b[0:32])</code>.<a class="pilcrow" href="#section-4.3.4-3.1">¶</a>
</li>
            <li id="section-4.3.4-3.2">Compute P2 as <code>MAP(b[32:64])</code>.<a class="pilcrow" href="#section-4.3.4-3.2">¶</a>
</li>
            <li id="section-4.3.4-3.3">Return P1 + P2.<a class="pilcrow" href="#section-4.3.4-3.3">¶</a>
</li>
          </ol>
<p id="section-4.3.4-4">The MAP function is defined on 32-byte strings as:<a class="pilcrow" href="#section-4.3.4-4">¶</a></p>
<ol class="compact type-1" id="section-4.3.4-5" start="1" type="1">
<li id="section-4.3.4-5.1">
              <p id="section-4.3.4-5.1.1">Mask the most significant bit in the final byte of the string,
and interpret the string as an unsigned integer r in little-endian
representation. Reduce r modulo p to obtain a field element t.<a class="pilcrow" href="#section-4.3.4-5.1.1">¶</a></p>
<ul class="compact">
<li class="compact" id="section-4.3.4-5.1.2.1">Masking the most significant bit is equivalent to interpreting the
whole string as an unsigned integer in little-endian representation and then
reducing it modulo 2<sup>255</sup>.<a class="pilcrow" href="#section-4.3.4-5.1.2.1">¶</a>
</li>
              </ul>
</li>
          </ol>
<aside id="section-4.3.4-6">
            <p id="section-4.3.4-6.1">Note: Similar to the field element decoding described in <span>[<a class="cite xref" href="#RFC7748">RFC7748</a>]</span>, and unlike
the field element decoding described in <a class="auto internal xref" href="#decoding255">Section 4.3.1</a>, the most significant bit
is masked, and non-canonical values are accepted.<a class="pilcrow" href="#section-4.3.4-6.1">¶</a></p>
</aside>
<ol class="compact type-1" id="section-4.3.4-7" start="2" type="1">
<li id="section-4.3.4-7.1">Process t as follows:<a class="pilcrow" href="#section-4.3.4-7.1">¶</a>
</li>
          </ol>
<div class="alignLeft art-text artwork" id="section-4.3.4-8">
<pre>r = SQRT_M1 * t^2
u = (r + 1) * ONE_MINUS_D_SQ
v = (-1 - r*D) * (r + D)

(was_square, s) = SQRT_RATIO_M1(u, v)
s_prime = -CT_ABS(s*t)
s = CT_SELECT(s IF was_square ELSE s_prime)
c = CT_SELECT(-1 IF was_square ELSE r)

N = c * (r - 1) * D_MINUS_ONE_SQ - v

w0 = 2 * s * v
w1 = N * SQRT_AD_MINUS_ONE
w2 = 1 - s^2
w3 = 1 + s^2
</pre><a class="pilcrow" href="#section-4.3.4-8">¶</a>
</div>
<ol class="compact type-1" id="section-4.3.4-9" start="3" type="1">
<li id="section-4.3.4-9.1">Return the group element represented by the internal representation
<code>(w0*w3, w2*w1, w1*w3, w0*w2)</code>.<a class="pilcrow" href="#section-4.3.4-9.1">¶</a>
</li>
          </ol>
</section>
</div>
</section>
</div>
<div id="scalar-field">
<section id="section-4.4">
        <h3 id="name-scalar-field">
<a class="section-number selfRef" href="#section-4.4">4.4. </a><a class="section-name selfRef" href="#name-scalar-field">Scalar Field</a>
        </h3>
<p id="section-4.4-1">The scalars for the ristretto255 group are integers modulo the order <code>l</code>
of the ristretto255 group. Note that this is the same scalar field as
Curve25519, allowing existing implementations to be reused.<a class="pilcrow" href="#section-4.4-1">¶</a></p>
<p id="section-4.4-2">Scalars are encoded as 32-byte strings in little-endian order.
Implementations <span class="bcp14">SHOULD</span> check that any scalar s falls in the range
0 &lt;= s &lt; <code>l</code> when parsing them and reject non-canonical scalar
encodings. Implementations <span class="bcp14">SHOULD</span> reduce scalars modulo <code>l</code> when
encoding them as byte strings. Omitting these strict range checks is
<span class="bcp14">NOT RECOMMENDED</span> but is allowed to enable reuse of scalar
arithmetic implementations in existing Curve25519 libraries.<a class="pilcrow" href="#section-4.4-2">¶</a></p>
<p id="section-4.4-3">Given a uniformly distributed 64-byte string b, implementations can
obtain a uniformly distributed scalar by interpreting the 64-byte
string as a 512-bit unsigned integer in little-endian order and reducing the
integer modulo <code>l</code>, as in <span>[<a class="cite xref" href="#RFC8032">RFC8032</a>]</span>. To obtain such an input from an
arbitrary-length byte string, applications should use a domain-separated
hash construction, the choice of which is out of scope for this document.<a class="pilcrow" href="#section-4.4-3">¶</a></p>
</section>
</div>
</section>
</div>
<div id="decaf448">
<section id="section-5">
      <h2 id="name-decaf448">
<a class="section-number selfRef" href="#section-5">5. </a><a class="section-name selfRef" href="#name-decaf448">decaf448</a>
      </h2>
<p id="section-5-1">decaf448 is an instantiation of the abstract prime-order group
interface defined in <a class="auto internal xref" href="#interface">Section 3</a>. This document describes how to
implement the decaf448 prime-order group using edwards448 points as
internal representations.<a class="pilcrow" href="#section-5-1">¶</a></p>
<p id="section-5-2">A "decaf448 group element" is the abstract element of the prime-order
group. An "element encoding" is the unique reversible encoding of a
group element. An "internal representation" is a point on the curve
used to implement decaf448. Each group element can have multiple
equivalent internal representations.<a class="pilcrow" href="#section-5-2">¶</a></p>
<p id="section-5-3">Encoding, decoding, equality, and the element derivation functions are defined in
<a class="auto internal xref" href="#functions448">Section 5.3</a>. Element addition, subtraction, negation, and scalar
multiplication are implemented by applying the corresponding operations
directly to the internal representation.<a class="pilcrow" href="#section-5-3">¶</a></p>
<p id="section-5-4">The group order is the same as the order of the edwards448 prime-order subgroup:<a class="pilcrow" href="#section-5-4">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5-5">
<pre>l = 2^446 -
  13818066809895115352007386748515426880336692474882178609894547503885
</pre><a class="pilcrow" href="#section-5-5">¶</a>
</div>
<p id="section-5-6">Since decaf448 is a prime-order group, every element except the
identity is a generator; however, for interoperability, a canonical
generator is selected. This generator can be internally represented
by 2*<code>B</code>, where <code>B</code> is the edwards448 base point, enabling reuse of
existing precomputation for scalar multiplication. The encoding of
this canonical generator, as produced by the function specified in
<a class="auto internal xref" href="#encoding448">Section 5.3.2</a>, is:<a class="pilcrow" href="#section-5-6">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5-7">
<pre>66666666 66666666 66666666 66666666 66666666 66666666 66666666
33333333 33333333 33333333 33333333 33333333 33333333 33333333
</pre><a class="pilcrow" href="#section-5-7">¶</a>
</div>
<p id="section-5-8">This repetitive constant is equal to <code>1/sqrt(5)</code> in decaf448's field,
corresponding to the curve448 base point with x = 5.<a class="pilcrow" href="#section-5-8">¶</a></p>
<div id="constants448">
<section id="section-5.1">
        <h3 id="name-implementation-constants-2">
<a class="section-number selfRef" href="#section-5.1">5.1. </a><a class="section-name selfRef" href="#name-implementation-constants-2">Implementation Constants</a>
        </h3>
<p id="section-5.1-1">This document references the following constant field element values
that are used for the implementation of group operations.<a class="pilcrow" href="#section-5.1-1">¶</a></p>
<ul class="compact">
<li class="compact" id="section-5.1-2.1">
            <p id="section-5.1-2.1.1"><code>D</code> = 726838724295606890549323807888004534353641360687318060281490199180612328166730772686396383698676545930088884461843637361053498018326358<a class="pilcrow" href="#section-5.1-2.1.1">¶</a></p>
<ul class="compact">
<li class="compact" id="section-5.1-2.1.2.1">This is the Edwards d parameter for edwards448, as specified in
<span><a class="relref" href="https://rfc-editor.org/rfc/rfc7748#section-4.2">Section 4.2</a> of [<a class="cite xref" href="#RFC7748">RFC7748</a>]</span>, and is equal to -39081 in the field.<a class="pilcrow" href="#section-5.1-2.1.2.1">¶</a>
</li>
            </ul>
</li>
          <li class="compact" id="section-5.1-2.2">
            <code>ONE_MINUS_D</code> = 39082<a class="pilcrow" href="#section-5.1-2.2">¶</a>
</li>
          <li class="compact" id="section-5.1-2.3">
            <code>ONE_MINUS_TWO_D</code> = 78163<a class="pilcrow" href="#section-5.1-2.3">¶</a>
</li>
          <li class="compact" id="section-5.1-2.4">
            <code>SQRT_MINUS_D</code> = 98944233647732219769177004876929019128417576295529901074099889598043702116001257856802131563896515373927712232092845883226922417596214<a class="pilcrow" href="#section-5.1-2.4">¶</a>
</li>
          <li class="compact" id="section-5.1-2.5">
            <code>INVSQRT_MINUS_D</code> = 315019913931389607337177038330951043522456072897266928557328499619017160722351061360252776265186336876723201881398623946864393857820716<a class="pilcrow" href="#section-5.1-2.5">¶</a>
</li>
        </ul>
</section>
</div>
<div id="sqrtratio448">
<section id="section-5.2">
        <h3 id="name-square-root-of-a-ratio-of-fi">
<a class="section-number selfRef" href="#section-5.2">5.2. </a><a class="section-name selfRef" href="#name-square-root-of-a-ratio-of-fi">Square Root of a Ratio of Field Elements</a>
        </h3>
<p id="section-5.2-1">The following function is defined on field elements and is used to
implement other decaf448 functions. This function is only used internally
to implement some of the group operations.<a class="pilcrow" href="#section-5.2-1">¶</a></p>
<p id="section-5.2-2">On input field elements u and v, the function <code>SQRT_RATIO_M1(u, v)</code> returns:<a class="pilcrow" href="#section-5.2-2">¶</a></p>
<ul class="compact">
<li class="compact" id="section-5.2-3.1">
            <code>(TRUE, +sqrt(u/v))</code> if u and v are nonzero and u/v is square in the field;<a class="pilcrow" href="#section-5.2-3.1">¶</a>
</li>
          <li class="compact" id="section-5.2-3.2">
            <code>(TRUE, zero)</code> if u is zero;<a class="pilcrow" href="#section-5.2-3.2">¶</a>
</li>
          <li class="compact" id="section-5.2-3.3">
            <code>(FALSE, zero)</code> if v is zero and u is nonzero; and<a class="pilcrow" href="#section-5.2-3.3">¶</a>
</li>
          <li class="compact" id="section-5.2-3.4">
            <code>(FALSE, +sqrt(-u/v))</code> if u and v are nonzero and u/v is
non-square in the field (so <code>-(u/v)</code> is square in the field),<a class="pilcrow" href="#section-5.2-3.4">¶</a>
</li>
        </ul>
<p id="section-5.2-4">where <code>+sqrt(x)</code> indicates the nonnegative square root of x in
the field.<a class="pilcrow" href="#section-5.2-4">¶</a></p>
<p id="section-5.2-5">The computation is similar to what is described in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc8032#section-5.2.3">Section 5.2.3</a> of [<a class="cite xref" href="#RFC8032">RFC8032</a>]</span>, with the
difference that, if the input is non-square, the function returns a
result with a defined relationship to the inputs. This result is used
for efficient implementation of the derivation function. The function
can be refactored from an existing edwards448 implementation.<a class="pilcrow" href="#section-5.2-5">¶</a></p>
<p id="section-5.2-6"><code>SQRT_RATIO_M1(u, v)</code> is defined as follows:<a class="pilcrow" href="#section-5.2-6">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2-7">
<pre>r = u * (u * v)^((p - 3) / 4) // Note: (p - 3) / 4 is an integer.

check = v * r^2
was_square = CT_EQ(check, u)

// Choose the nonnegative square root.
r = CT_ABS(r)

return (was_square, r)
</pre><a class="pilcrow" href="#section-5.2-7">¶</a>
</div>
</section>
</div>
<div id="functions448">
<section id="section-5.3">
        <h3 id="name-decaf448-group-operations">
<a class="section-number selfRef" href="#section-5.3">5.3. </a><a class="section-name selfRef" href="#name-decaf448-group-operations">decaf448 Group Operations</a>
        </h3>
<p id="section-5.3-1">This section describes the implementation of the external functions
exposed by the decaf448 prime-order group.<a class="pilcrow" href="#section-5.3-1">¶</a></p>
<div id="decoding448">
<section id="section-5.3.1">
          <h4 id="name-decode-2">
<a class="section-number selfRef" href="#section-5.3.1">5.3.1. </a><a class="section-name selfRef" href="#name-decode-2">Decode</a>
          </h4>
<p id="section-5.3.1-1">All elements are encoded as 56-byte strings. Decoding proceeds as follows:<a class="pilcrow" href="#section-5.3.1-1">¶</a></p>
<ol class="compact type-1" id="section-5.3.1-2" start="1" type="1">
<li id="section-5.3.1-2.1">Interpret the string as an unsigned integer s in little-endian
representation. If the length of the string is not 56 bytes or if
the resulting value is &gt;= p, decoding fails.<a class="pilcrow" href="#section-5.3.1-2.1">¶</a>
</li>
          </ol>
<aside id="section-5.3.1-3">
            <p id="section-5.3.1-3.1">Note: Unlike the field element decoding described in <span>[<a class="cite xref" href="#RFC7748">RFC7748</a>]</span>, non-canonical
values are rejected. The test vectors in <a class="auto internal xref" href="#invalid448">Appendix B.2</a> exercise
these edge cases.<a class="pilcrow" href="#section-5.3.1-3.1">¶</a></p>
</aside>
<ol class="compact type-1" id="section-5.3.1-4" start="2" type="1">
<li id="section-5.3.1-4.1">If <code>IS_NEGATIVE(s)</code> returns TRUE, decoding fails.<a class="pilcrow" href="#section-5.3.1-4.1">¶</a>
</li>
            <li id="section-5.3.1-4.2">Process s as follows:<a class="pilcrow" href="#section-5.3.1-4.2">¶</a>
</li>
          </ol>
<div class="alignLeft art-text artwork" id="section-5.3.1-5">
<pre>ss = s^2
u1 = 1 + ss

u2 = u1^2 - 4 * D * ss

(was_square, invsqrt) = SQRT_RATIO_M1(1, u2 * u1^2)

u3 = CT_ABS(2 * s * invsqrt * u1 * SQRT_MINUS_D)

x = u3 * invsqrt * u2 * INVSQRT_MINUS_D
y = (1 - ss) * invsqrt * u1
t = x * y
</pre><a class="pilcrow" href="#section-5.3.1-5">¶</a>
</div>
<ol class="compact type-1" id="section-5.3.1-6" start="4" type="1">
<li id="section-5.3.1-6.1">If was_square is FALSE, then decoding fails. Otherwise,
return the group element represented by the internal representation
<code>(x, y, 1, t)</code> as the result of decoding.<a class="pilcrow" href="#section-5.3.1-6.1">¶</a>
</li>
          </ol>
</section>
</div>
<div id="encoding448">
<section id="section-5.3.2">
          <h4 id="name-encode-2">
<a class="section-number selfRef" href="#section-5.3.2">5.3.2. </a><a class="section-name selfRef" href="#name-encode-2">Encode</a>
          </h4>
<p id="section-5.3.2-1">A group element with internal representation <code>(x0, y0, z0, t0)</code> is
encoded as follows:<a class="pilcrow" href="#section-5.3.2-1">¶</a></p>
<ol class="compact type-1" id="section-5.3.2-2" start="1" type="1">
<li id="section-5.3.2-2.1">Process the internal representation into a field element s as follows:<a class="pilcrow" href="#section-5.3.2-2.1">¶</a>
</li>
          </ol>
<div class="alignLeft art-text artwork" id="section-5.3.2-3">
<pre>u1 = (x0 + t0) * (x0 - t0)

// Ignore was_square since this is always square.
(_, invsqrt) = SQRT_RATIO_M1(1, u1 * ONE_MINUS_D * x0^2)

ratio = CT_ABS(invsqrt * u1 * SQRT_MINUS_D)
u2 = INVSQRT_MINUS_D * ratio * z0 - t0
s = CT_ABS(ONE_MINUS_D * invsqrt * x0 * u2)
</pre><a class="pilcrow" href="#section-5.3.2-3">¶</a>
</div>
<ol class="compact type-1" id="section-5.3.2-4" start="2" type="1">
<li id="section-5.3.2-4.1">Return the 56-byte little-endian encoding of s.  More specifically,
this is the encoding of the canonical representation of s as an integer
between 0 and p-1, inclusive.<a class="pilcrow" href="#section-5.3.2-4.1">¶</a>
</li>
          </ol>
<p id="section-5.3.2-5">Note that decoding and then re-encoding a valid group element will
yield an identical byte string.<a class="pilcrow" href="#section-5.3.2-5">¶</a></p>
</section>
</div>
<div id="equals448">
<section id="section-5.3.3">
          <h4 id="name-equals-2">
<a class="section-number selfRef" href="#section-5.3.3">5.3.3. </a><a class="section-name selfRef" href="#name-equals-2">Equals</a>
          </h4>
<p id="section-5.3.3-1">The equality function returns TRUE when two internal representations
correspond to the same group element. Note that internal representations
<span class="bcp14">MUST NOT</span> be compared in any way other than specified here.<a class="pilcrow" href="#section-5.3.3-1">¶</a></p>
<p id="section-5.3.3-2">For two internal representations <code>(x1, y1, z1, t1)</code> and <code>(x2, y2, z2, t2)</code>,
if<a class="pilcrow" href="#section-5.3.3-2">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.3.3-3">
<pre>CT_EQ(x1 * y2, y1 * x2)
</pre><a class="pilcrow" href="#section-5.3.3-3">¶</a>
</div>
<p id="section-5.3.3-4">evaluates to TRUE, then return TRUE. Otherwise, return FALSE.<a class="pilcrow" href="#section-5.3.3-4">¶</a></p>
<p id="section-5.3.3-5">Note that the equality function always returns TRUE when applied to an
internal representation and to the internal representation obtained by
encoding and then re-decoding it. However, the internal
representations themselves might not be identical.<a class="pilcrow" href="#section-5.3.3-5">¶</a></p>
<p id="section-5.3.3-6">Implementations <span class="bcp14">MAY</span> also perform constant-time byte comparisons on the encodings
of group elements (produced by <a class="auto internal xref" href="#encoding448">Section 5.3.2</a>) for an equivalent, although
less efficient, result.<a class="pilcrow" href="#section-5.3.3-6">¶</a></p>
</section>
</div>
<div id="from_bytes_uniform448">
<section id="section-5.3.4">
          <h4 id="name-element-derivation-2">
<a class="section-number selfRef" href="#section-5.3.4">5.3.4. </a><a class="section-name selfRef" href="#name-element-derivation-2">Element Derivation</a>
          </h4>
<p id="section-5.3.4-1">The element derivation function operates on 112-byte strings.
To obtain such an input from an arbitrary-length byte string, applications
should use a domain-separated hash construction, the choice of which
is out of scope for this document.<a class="pilcrow" href="#section-5.3.4-1">¶</a></p>
<p id="section-5.3.4-2">The element derivation function on an input string b proceeds as follows:<a class="pilcrow" href="#section-5.3.4-2">¶</a></p>
<ol class="compact type-1" id="section-5.3.4-3" start="1" type="1">
<li id="section-5.3.4-3.1">Compute P1 as <code>MAP(b[0:56])</code>.<a class="pilcrow" href="#section-5.3.4-3.1">¶</a>
</li>
            <li id="section-5.3.4-3.2">Compute P2 as <code>MAP(b[56:112])</code>.<a class="pilcrow" href="#section-5.3.4-3.2">¶</a>
</li>
            <li id="section-5.3.4-3.3">Return P1 + P2.<a class="pilcrow" href="#section-5.3.4-3.3">¶</a>
</li>
          </ol>
<p id="section-5.3.4-4">The MAP function is defined on 56-byte strings as:<a class="pilcrow" href="#section-5.3.4-4">¶</a></p>
<ol class="compact type-1" id="section-5.3.4-5" start="1" type="1">
<li id="section-5.3.4-5.1">Interpret the string as an unsigned integer r in little-endian representation.
Reduce r modulo p to obtain a field element t.<a class="pilcrow" href="#section-5.3.4-5.1">¶</a>
</li>
          </ol>
<aside id="section-5.3.4-6">
            <p id="section-5.3.4-6.1">Note: Similar to the field element decoding described in <span>[<a class="cite xref" href="#RFC7748">RFC7748</a>]</span>, and unlike
the field element decoding described in <a class="auto internal xref" href="#decoding448">Section 5.3.1</a>, non-canonical values are
accepted.<a class="pilcrow" href="#section-5.3.4-6.1">¶</a></p>
</aside>
<ol class="compact type-1" id="section-5.3.4-7" start="2" type="1">
<li id="section-5.3.4-7.1">Process t as follows:<a class="pilcrow" href="#section-5.3.4-7.1">¶</a>
</li>
          </ol>
<div class="alignLeft art-text artwork" id="section-5.3.4-8">
<pre>r = -t^2
u0 = d * (r-1)
u1 = (u0 + 1) * (u0 - r)

(was_square, v) = SQRT_RATIO_M1(ONE_MINUS_TWO_D, (r + 1) * u1)
v_prime = CT_SELECT(v IF was_square ELSE t * v)
sgn     = CT_SELECT(1 IF was_square ELSE -1)
s = v_prime * (r + 1)

w0 = 2 * CT_ABS(s)
w1 = s^2 + 1
w2 = s^2 - 1
w3 = v_prime * s * (r - 1) * ONE_MINUS_TWO_D + sgn
</pre><a class="pilcrow" href="#section-5.3.4-8">¶</a>
</div>
<ol class="compact type-1" id="section-5.3.4-9" start="3" type="1">
<li id="section-5.3.4-9.1">Return the group element represented by the internal representation
<code>(w0*w3, w2*w1, w1*w3, w0*w2)</code>.<a class="pilcrow" href="#section-5.3.4-9.1">¶</a>
</li>
          </ol>
</section>
</div>
</section>
</div>
<div id="scalar-field-1">
<section id="section-5.4">
        <h3 id="name-scalar-field-2">
<a class="section-number selfRef" href="#section-5.4">5.4. </a><a class="section-name selfRef" href="#name-scalar-field-2">Scalar Field</a>
        </h3>
<p id="section-5.4-1">The scalars for the decaf448 group are integers modulo the order <code>l</code>
of the decaf448 group. Note that this is the same scalar field as
edwards448, allowing existing implementations to be reused.<a class="pilcrow" href="#section-5.4-1">¶</a></p>
<p id="section-5.4-2">Scalars are encoded as 56-byte strings in little-endian order.
Implementations <span class="bcp14">SHOULD</span> check that any scalar s falls in the range
0 &lt;= s &lt; <code>l</code> when parsing them and reject non-canonical scalar
encodings. Implementations <span class="bcp14">SHOULD</span> reduce scalars modulo <code>l</code> when
encoding them as byte strings. Omitting these strict range checks is
<span class="bcp14">NOT RECOMMENDED</span> but is allowed to enable reuse of scalar
arithmetic implementations in existing edwards448 libraries.<a class="pilcrow" href="#section-5.4-2">¶</a></p>
<p id="section-5.4-3">Given a uniformly distributed 64-byte string b, implementations can
obtain a uniformly distributed scalar by interpreting the 64-byte
string as a 512-bit unsigned integer in little-endian order and reducing the
integer modulo <code>l</code>. To obtain such an input from an arbitrary-length
byte string, applications should use a domain-separated hash
construction, the choice of which is out of scope for this document.<a class="pilcrow" href="#section-5.4-3">¶</a></p>
</section>
</div>
</section>
</div>
<div id="api">
<section id="section-6">
      <h2 id="name-api-considerations">
<a class="section-number selfRef" href="#section-6">6. </a><a class="section-name selfRef" href="#name-api-considerations">API Considerations</a>
      </h2>
<p id="section-6-1">ristretto255 and decaf448 are abstractions that implement two prime-order
groups. Their elements are represented by curve points, but are not curve
points, and implementations <span class="bcp14">SHOULD</span> reflect that fact. That is, the type
representing an element of the group <span class="bcp14">SHOULD</span> be opaque to the caller,
meaning they do not expose the underlying curve point or field elements.
Moreover, implementations <span class="bcp14">SHOULD NOT</span> expose any internal constants
or functions used in the implementation of the group operations.<a class="pilcrow" href="#section-6-1">¶</a></p>
<p id="section-6-2">The reason for this encapsulation is that ristretto255 and decaf448 implementations
can change their underlying curve without causing any breaking change. The ristretto255
and decaf448 constructions are carefully designed so that this will be the
case, as long as implementations do not expose internal representations or
operate on them except as described in this document. In particular,
implementations <span class="bcp14">SHOULD NOT</span> define any external ristretto255 or decaf448
interface as operating on arbitrary curve points, and they <span class="bcp14">SHOULD NOT</span>
construct group elements except via decoding, the element derivation function,
or group operations on other valid group elements per <a class="auto internal xref" href="#interface">Section 3</a>. However, they are
allowed to apply any optimization strategy to the internal
representations as long as it doesn't change the exposed behavior of the
API.<a class="pilcrow" href="#section-6-2">¶</a></p>
<p id="section-6-3">It is <span class="bcp14">RECOMMENDED</span> that implementations not perform a decoding and
encoding operation for each group operation, as it is inefficient and
unnecessary. Implementations <span class="bcp14">SHOULD</span> instead provide an opaque type
to hold the internal representation through multiple operations.<a class="pilcrow" href="#section-6-3">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-7">
      <h2 id="name-iana-considerations">
<a class="section-number selfRef" href="#section-7">7. </a><a class="section-name selfRef" href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<p id="section-7-1">This document has no IANA actions.<a class="pilcrow" href="#section-7-1">¶</a></p>
</section>
</div>
<div id="security-considerations">
<section id="section-8">
      <h2 id="name-security-considerations">
<a class="section-number selfRef" href="#section-8">8. </a><a class="section-name selfRef" href="#name-security-considerations">Security Considerations</a>
      </h2>
<p id="section-8-1">The ristretto255 and decaf448 groups provide higher-level protocols with
the abstraction they expect: a prime-order group. Therefore, it's expected
to be safer for use in any situation where Curve25519 or edwards448 is used
to implement a protocol requiring a prime-order group. Note that the safety
of the abstraction can be defeated by implementations that do not follow
the guidance in <a class="auto internal xref" href="#api">Section 6</a>.<a class="pilcrow" href="#section-8-1">¶</a></p>
<p id="section-8-2">There is no function to test whether an elliptic curve point is a
valid internal representation of a group element. The decoding
function always returns a valid internal representation or an error, and
operations exposed by the group per <a class="auto internal xref" href="#interface">Section 3</a> return valid internal
representations when applied to valid internal representations.
In this way, an implementation can maintain
the invariant that an internal representation is always valid, so that
checking is never necessary, and invalid states are unrepresentable.<a class="pilcrow" href="#section-8-2">¶</a></p>
</section>
</div>
<section id="section-9">
      <h2 id="name-references">
<a class="section-number selfRef" href="#section-9">9. </a><a class="section-name selfRef" href="#name-references">References</a>
      </h2>
<section id="section-9.1">
        <h3 id="name-normative-references">
<a class="section-number selfRef" href="#section-9.1">9.1. </a><a class="section-name selfRef" href="#name-normative-references">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time class="refDate" datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
      <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time class="refDate" datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-9.2">
        <h3 id="name-informative-references">
<a class="section-number selfRef" href="#section-9.2">9.2. </a><a class="section-name selfRef" href="#name-informative-references">Informative References</a>
        </h3>
<dl class="references">
<dt id="Decaf">[Decaf]</dt>
        <dd>
<span class="refAuthor">Hamburg, M.</span>, <span class="refTitle">"Decaf: Eliminating cofactors through point compression"</span>, <time class="refDate" datetime="2015">2015</time>, <span>&lt;<a href="https://www.shiftleft.org/papers/decaf/decaf.pdf">https://www.shiftleft.org/papers/decaf/decaf.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Ed25519ValidCrit">[Ed25519ValidCrit]</dt>
        <dd>
<span class="refAuthor">de Valence, H.</span>, <span class="refTitle">"It's 255:19AM. Do you know what your validation criteria are?"</span>, <time class="refDate" datetime="2020-10-04">4 October 2020</time>, <span>&lt;<a href="https://hdevalence.ca/blog/2020-10-04-its-25519am">https://hdevalence.ca/blog/2020-10-04-its-25519am</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="MoneroVuln">[MoneroVuln]</dt>
        <dd>
<span class="refAuthor">Nick, J.</span>, <span class="refTitle">"Exploiting Low Order Generators in One-Time Ring Signatures"</span>, <time class="refDate" datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://jonasnick.github.io/blog/2017/05/23/exploiting-low-order-generators-in-one-time-ring-signatures/">https://jonasnick.github.io/blog/2017/05/23/exploiting-low-order-generators-in-one-time-ring-signatures/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Naming">[Naming]</dt>
        <dd>
<span class="refAuthor">Bernstein, D. J.</span>, <span class="refTitle">"Subject: [Cfrg] 25519 naming"</span>, <span class="refContent">message to the Cfrg mailing list</span>, <time class="refDate" datetime="2014-08-26">26 August 2014</time>, <span>&lt;<a href="https://mailarchive.ietf.org/arch/msg/cfrg/-9LEdnzVrE5RORux3Oo_oDDRksU/">https://mailarchive.ietf.org/arch/msg/cfrg/-9LEdnzVrE5RORux3Oo_oDDRksU/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7748">[RFC7748]</dt>
        <dd>
<span class="refAuthor">Langley, A.</span>, <span class="refAuthor">Hamburg, M.</span>, and <span class="refAuthor">S. Turner</span>, <span class="refTitle">"Elliptic Curves for Security"</span>, <span class="seriesInfo">RFC 7748</span>, <span class="seriesInfo">DOI 10.17487/RFC7748</span>, <time class="refDate" datetime="2016-01">January 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7748">https://www.rfc-editor.org/info/rfc7748</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8032">[RFC8032]</dt>
        <dd>
<span class="refAuthor">Josefsson, S.</span> and <span class="refAuthor">I. Liusvaara</span>, <span class="refTitle">"Edwards-Curve Digital Signature Algorithm (EdDSA)"</span>, <span class="seriesInfo">RFC 8032</span>, <span class="seriesInfo">DOI 10.17487/RFC8032</span>, <time class="refDate" datetime="2017-01">January 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8032">https://www.rfc-editor.org/info/rfc8032</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9380">[RFC9380]</dt>
        <dd>
<span class="refAuthor">Faz-Hernandez, A.</span>, <span class="refAuthor">Scott, S.</span>, <span class="refAuthor">Sullivan, N.</span>, <span class="refAuthor">Wahby, R. S.</span>, and <span class="refAuthor">C. A. Wood</span>, <span class="refTitle">"Hashing to Elliptic Curves"</span>, <span class="seriesInfo">RFC 9380</span>, <span class="seriesInfo">DOI 10.17487/RFC9380</span>, <time class="refDate" datetime="2023-08">August 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9380">https://www.rfc-editor.org/info/rfc9380</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RistrettoGroup">[RistrettoGroup]</dt>
        <dd>
<span class="refAuthor">de Valence, H.</span>, <span class="refAuthor">Lovecruft, I.</span>, <span class="refAuthor">Arcieri, T.</span>, and <span class="refAuthor">M. Hamburg</span>, <span class="refTitle">"The Ristretto Group"</span>, <span>&lt;<a href="https://ristretto.group">https://ristretto.group</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Twisted">[Twisted]</dt>
      <dd>
<span class="refAuthor">Hisil, H.</span>, <span class="refAuthor">Wong, K. K.</span>, <span class="refAuthor">Carter, G.</span>, and <span class="refAuthor">E. Dawson</span>, <span class="refTitle">"Twisted Edwards Curves Revisited"</span>, <span class="refContent">Cryptology ePrint Archive, Paper 2008/522</span>, <time class="refDate" datetime="2008-12">December 2008</time>, <span>&lt;<a href="https://eprint.iacr.org/2008/522">https://eprint.iacr.org/2008/522</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="test-vectors-for-ristretto255">
<section id="appendix-A">
      <h2 id="name-test-vectors-for-ristretto2">
<a class="section-number selfRef" href="#appendix-A">Appendix A. </a><a class="section-name selfRef" href="#name-test-vectors-for-ristretto2">Test Vectors for ristretto255</a>
      </h2>
<p id="appendix-A-1">This section contains test vectors for ristretto255. The octets are
hex encoded, and whitespace is inserted for readability.<a class="pilcrow" href="#appendix-A-1">¶</a></p>
<div id="multiples-of-the-generator">
<section id="appendix-A.1">
        <h3 id="name-multiples-of-the-generator">
<a class="section-number selfRef" href="#appendix-A.1">A.1. </a><a class="section-name selfRef" href="#name-multiples-of-the-generator">Multiples of the Generator</a>
        </h3>
<p id="appendix-A.1-1">The following are the encodings of the multiples 0 to 15 of the
canonical generator, represented as an array of elements. That is,
the first entry is the encoding of the identity element, and each
successive entry is obtained by adding the generator to the previous entry.<a class="pilcrow" href="#appendix-A.1-1">¶</a></p>
<div class="lang-test-vectors sourcecode" id="appendix-A.1-2">
<pre>B[ 0]: 00000000 00000000 00000000 00000000 00000000 00000000 00000000
       00000000
B[ 1]: e2f2ae0a 6abc4e71 a884a961 c500515f 58e30b6a a582dd8d b6a65945
       e08d2d76
B[ 2]: 6a493210 f7499cd1 7fecb510 ae0cea23 a110e8d5 b901f8ac add3095c
       73a3b919
B[ 3]: 94741f5d 5d52755e ce4f23f0 44ee27d5 d1ea1e2b d196b462 166b1615
       2a9d0259
B[ 4]: da808627 73358b46 6ffadfe0 b3293ab3 d9fd53c5 ea6c9553 58f56832
       2daf6a57
B[ 5]: e882b131 016b52c1 d3337080 187cf768 423efccb b517bb49 5ab812c4
       160ff44e
B[ 6]: f64746d3 c92b1305 0ed8d802 36a7f000 7c3b3f96 2f5ba793 d19a601e
       bb1df403
B[ 7]: 44f53520 926ec81f bd5a3878 45beb7df 85a96a24 ece18738 bdcfa6a7
       822a176d
B[ 8]: 903293d8 f2287ebe 10e2374d c1a53e0b c887e592 699f02d0 77d5263c
       dd55601c
B[ 9]: 02622ace 8f7303a3 1cafc63f 8fc48fdc 16e1c8c8 d234b2f0 d6685282
       a9076031
B[10]: 20706fd7 88b2720a 1ed2a5da d4952b01 f413bcf0 e7564de8 cdc81668
       9e2db95f
B[11]: bce83f8b a5dd2fa5 72864c24 ba1810f9 522bc600 4afe9587 7ac73241
       cafdab42
B[12]: e4549ee1 6b9aa030 99ca208c 67adafca fa4c3f3e 4e5303de 6026e3ca
       8ff84460
B[13]: aa52e000 df2e16f5 5fb1032f c33bc427 42dad6bd 5a8fc0be 0167436c
       5948501f
B[14]: 46376b80 f409b29d c2b5f6f0 c5259199 0896e571 6f41477c d30085ab
       7f10301e
B[15]: e0c418f7 c8d9c4cd d7395b93 ea124f3a d99021bb 681dfc33 02a9d99a
       2e53e64e
</pre><a class="pilcrow" href="#appendix-A.1-2">¶</a>
</div>
<p id="appendix-A.1-3">Note that because<a class="pilcrow" href="#appendix-A.1-3">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.1-4">
<pre>B[i+1] = B[i] + B[1]
</pre><a class="pilcrow" href="#appendix-A.1-4">¶</a>
</div>
<p id="appendix-A.1-5">these test vectors allow testing of the encoding function and
the implementation of addition simultaneously.<a class="pilcrow" href="#appendix-A.1-5">¶</a></p>
</section>
</div>
<div id="invalid255">
<section id="appendix-A.2">
        <h3 id="name-invalid-encodings">
<a class="section-number selfRef" href="#appendix-A.2">A.2. </a><a class="section-name selfRef" href="#name-invalid-encodings">Invalid Encodings</a>
        </h3>
<p id="appendix-A.2-1">These are examples of encodings that <span class="bcp14">MUST</span> be rejected according to
<a class="auto internal xref" href="#decoding255">Section 4.3.1</a>.<a class="pilcrow" href="#appendix-A.2-1">¶</a></p>
<div class="breakable lang-test-vectors sourcecode" id="appendix-A.2-2">
<pre># Non-canonical field encodings.
00ffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff
ffffffff

ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff
ffffff7f

f3ffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff
ffffff7f

edffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff
ffffff7f

# Negative field elements.
01000000 00000000 00000000 00000000 00000000 00000000 00000000
00000000

01ffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff
ffffff7f

ed57ffd8 c914fb20 1471d1c3 d245ce3c 746fcbe6 3a3679d5 1b6a516e
bebe0e20

c34c4e18 26e5d403 b78e246e 88aa051c 36ccf0aa febffe13 7d148a2b
f9104562

c940e5a4 404157cf b1628b10 8db051a8 d439e1a4 21394ec4 ebccb9ec
92a8ac78

47cfc549 7c53dc8e 61c91d17 fd626ffb 1c49e2bc a94eed05 2281b510
b1117a24

f1c6165d 33367351 b0da8f6e 4511010c 68174a03 b6581212 c71c0e1d
026c3c72

87260f7a 2f124951 18360f02 c26a470f 450dadf3 4a413d21 042b43b9
d93e1309

# Non-square x^2.
26948d35 ca62e643 e26a8317 7332e6b6 afeb9d08 e4268b65 0f1f5bbd
8d81d371

4eac077a 713c57b4 f4397629 a4145982 c661f480 44dd3f96 427d40b1
47d9742f

de6a7b00 deadc788 eb6b6c8d 20c0ae96 c2f20190 78fa604f ee5b87d6
e989ad7b

bcab477b e20861e0 1e4a0e29 5284146a 510150d9 817763ca f1a6f4b4
22d67042

2a292df7 e32cabab bd9de088 d1d1abec 9fc0440f 637ed2fb a145094d
c14bea08

f4a9e534 fc0d216c 44b218fa 0c42d996 35a0127e e2e53c71 2f706096
49fdff22

8268436f 8c412619 6cf64b3c 7ddbda90 746a3786 25f9813d d9b84570
77256731

2810e5cb c2cc4d4e ece54f61 c6f69758 e289aa7a b440b3cb eaa21995
c2f4232b

# Negative x * y value.
3eb858e7 8f5a7254 d8c97311 74a94f76 755fd394 1c0ac937 35c07ba1
4579630e

a45fdc55 c76448c0 49a1ab33 f17023ed fb2be358 1e9c7aad e8a61252
15e04220

d483fe81 3c6ba647 ebbfd3ec 41adca1c 6130c2be eee9d9bf 065c8d15
1c5f396e

8a2e1d30 050198c6 5a544831 23960ccc 38aef684 8e1ec8f5 f780e852
3769ba32

32888462 f8b486c6 8ad7dd96 10be5192 bbeaf3b4 43951ac1 a8118419
d9fa097b

22714250 1b9d4355 ccba2904 04bde415 75b03769 3cef1f43 8c47f8fb
f35d1165

5c37cc49 1da847cf eb9281d4 07efc41e 15144c87 6e0170b4 99a96a22
ed31e01e

44542511 7cb8c90e dcbc7c1c c0e74f74 7f2c1efa 5630a967 c64f2877
92a48a4b

# s = -1, which causes y = 0.
ecffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff
ffffff7f
</pre><a class="pilcrow" href="#appendix-A.2-2">¶</a>
</div>
</section>
</div>
<div id="group-elements-from-uniform-byte-strings">
<section id="appendix-A.3">
        <h3 id="name-group-elements-from-uniform">
<a class="section-number selfRef" href="#appendix-A.3">A.3. </a><a class="section-name selfRef" href="#name-group-elements-from-uniform">Group Elements from Uniform Byte Strings</a>
        </h3>
<p id="appendix-A.3-1">The following pairs are inputs to the element derivation function of
<a class="auto internal xref" href="#from_bytes_uniform255">Section 4.3.4</a> and their encoded outputs.<a class="pilcrow" href="#appendix-A.3-1">¶</a></p>
<div class="lang-test-vectors sourcecode" id="appendix-A.3-2">
<pre>I: 5d1be09e3d0c82fc538112490e35701979d99e06ca3e2b5b54bffe8b4dc772c1
   4d98b696a1bbfb5ca32c436cc61c16563790306c79eaca7705668b47dffe5bb6
O: 3066f82a 1a747d45 120d1740 f1435853 1a8f04bb ffe6a819 f86dfe50
   f44a0a46

I: f116b34b8f17ceb56e8732a60d913dd10cce47a6d53bee9204be8b44f6678b27
   0102a56902e2488c46120e9276cfe54638286b9e4b3cdb470b542d46c2068d38
O: f26e5b6f 7d362d2d 2a94c5d0 e7602cb4 773c95a2 e5c31a64 f133189f
   a76ed61b

I: 8422e1bbdaab52938b81fd602effb6f89110e1e57208ad12d9ad767e2e25510c
   27140775f9337088b982d83d7fcf0b2fa1edffe51952cbe7365e95c86eaf325c
O: 006ccd2a 9e6867e6 a2c5cea8 3d3302cc 9de128dd 2a9a57dd 8ee7b9d7
   ffe02826

I: ac22415129b61427bf464e17baee8db65940c233b98afce8d17c57beeb7876c2
   150d15af1cb1fb824bbd14955f2b57d08d388aab431a391cfc33d5bafb5dbbaf
O: f8f0c87c f237953c 5890aec3 99816900 5dae3eca 1fbb0454 8c635953
   c817f92a

I: 165d697a1ef3d5cf3c38565beefcf88c0f282b8e7dbd28544c483432f1cec767
   5debea8ebb4e5fe7d6f6e5db15f15587ac4d4d4a1de7191e0c1ca6664abcc413
O: ae81e7de df20a497 e10c304a 765c1767 a42d6e06 029758d2 d7e8ef7c
   c4c41179

I: a836e6c9a9ca9f1e8d486273ad56a78c70cf18f0ce10abb1c7172ddd605d7fd2
   979854f47ae1ccf204a33102095b4200e5befc0465accc263175485f0e17ea5c
O: e2705652 ff9f5e44 d3e841bf 1c251cf7 dddb77d1 40870d1a b2ed64f1
   a9ce8628

I: 2cdc11eaeb95daf01189417cdddbf95952993aa9cb9c640eb5058d09702c7462
   2c9965a697a3b345ec24ee56335b556e677b30e6f90ac77d781064f866a3c982
O: 80bd0726 2511cdde 4863f8a7 434cef69 6750681c b9510eea 557088f7
   6d9e5065
</pre><a class="pilcrow" href="#appendix-A.3-2">¶</a>
</div>
<p id="appendix-A.3-3">The following element derivation function inputs all produce the same encoded
output.<a class="pilcrow" href="#appendix-A.3-3">¶</a></p>
<div class="lang-test-vectors sourcecode" id="appendix-A.3-4">
<pre>I: edffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
   1200000000000000000000000000000000000000000000000000000000000000
I: edffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f
   ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
I: 0000000000000000000000000000000000000000000000000000000000000080
   ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f
I: 0000000000000000000000000000000000000000000000000000000000000000
   1200000000000000000000000000000000000000000000000000000000000080

O: 30428279 1023b731 28d277bd cb5c7746 ef2eac08 dde9f298 3379cb8e
   5ef0517f
</pre><a class="pilcrow" href="#appendix-A.3-4">¶</a>
</div>
</section>
</div>
<div id="square-root-of-a-ratio-of-field-elements">
<section id="appendix-A.4">
        <h3 id="name-square-root-of-a-ratio-of-fie">
<a class="section-number selfRef" href="#appendix-A.4">A.4. </a><a class="section-name selfRef" href="#name-square-root-of-a-ratio-of-fie">Square Root of a Ratio of Field Elements</a>
        </h3>
<p id="appendix-A.4-1">The following are inputs and outputs of <code>SQRT_RATIO_M1(u, v)</code> defined
in <a class="auto internal xref" href="#sqrtratio255">Section 4.2</a>. The values are little-endian encodings of field
elements.<a class="pilcrow" href="#appendix-A.4-1">¶</a></p>
<div class="lang-test-vectors sourcecode" id="appendix-A.4-2">
<pre>u: 0000000000000000000000000000000000000000000000000000000000000000
v: 0000000000000000000000000000000000000000000000000000000000000000
was_square: TRUE
r: 0000000000000000000000000000000000000000000000000000000000000000

u: 0000000000000000000000000000000000000000000000000000000000000000
v: 0100000000000000000000000000000000000000000000000000000000000000
was_square: TRUE
r: 0000000000000000000000000000000000000000000000000000000000000000

u: 0100000000000000000000000000000000000000000000000000000000000000
v: 0000000000000000000000000000000000000000000000000000000000000000
was_square: FALSE
r: 0000000000000000000000000000000000000000000000000000000000000000

u: 0200000000000000000000000000000000000000000000000000000000000000
v: 0100000000000000000000000000000000000000000000000000000000000000
was_square: FALSE
r: 3c5ff1b5d8e4113b871bd052f9e7bcd0582804c266ffb2d4f4203eb07fdb7c54

u: 0400000000000000000000000000000000000000000000000000000000000000
v: 0100000000000000000000000000000000000000000000000000000000000000
was_square: TRUE
r: 0200000000000000000000000000000000000000000000000000000000000000

u: 0100000000000000000000000000000000000000000000000000000000000000
v: 0400000000000000000000000000000000000000000000000000000000000000
was_square: TRUE
r: f6ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff3f
</pre><a class="pilcrow" href="#appendix-A.4-2">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="test-vectors-for-decaf448">
<section id="appendix-B">
      <h2 id="name-test-vectors-for-decaf448">
<a class="section-number selfRef" href="#appendix-B">Appendix B. </a><a class="section-name selfRef" href="#name-test-vectors-for-decaf448">Test Vectors for decaf448</a>
      </h2>
<p id="appendix-B-1">This section contains test vectors for decaf448. The octets are
hex encoded, and whitespace is inserted for readability.<a class="pilcrow" href="#appendix-B-1">¶</a></p>
<div id="multiples-of-the-generator-1">
<section id="appendix-B.1">
        <h3 id="name-multiples-of-the-generator-2">
<a class="section-number selfRef" href="#appendix-B.1">B.1. </a><a class="section-name selfRef" href="#name-multiples-of-the-generator-2">Multiples of the Generator</a>
        </h3>
<p id="appendix-B.1-1">The following are the encodings of the multiples 0 to 15 of the
canonical generator, represented as an array of elements. That is,
the first entry is the encoding of the identity element, and each
successive entry is obtained by adding the generator to the previous entry.<a class="pilcrow" href="#appendix-B.1-1">¶</a></p>
<div class="lang-test-vectors sourcecode" id="appendix-B.1-2">
<pre>B[ 0]: 00000000 00000000 00000000 00000000 00000000 00000000 00000000
       00000000 00000000 00000000 00000000 00000000 00000000 00000000
B[ 1]: 66666666 66666666 66666666 66666666 66666666 66666666 66666666
       33333333 33333333 33333333 33333333 33333333 33333333 33333333
B[ 2]: c898eb4f 87f97c56 4c6fd61f c7e49689 314a1f81 8ec85eeb 3bd5514a
       c816d387 78f69ef3 47a89fca 817e66de fdedce17 8c7cc709 b2116e75
B[ 3]: a0c09bf2 ba7208fd a0f4bfe3 d0f5b29a 54301230 6d43831b 5adc6fe7
       f8596fa3 08763db1 5468323b 11cf6e4a eb8c18fe 44678f44 545a69bc
B[ 4]: b46f1836 aa287c0a 5a5653f0 ec5ef9e9 03f436e2 1c1570c2 9ad9e5f5
       96da97ee af17150a e30bcb31 74d04bc2 d712c8c7 789d7cb4 fda138f4
B[ 5]: 1c5bbecf 4741dfaa e79db72d face00ea aac502c2 060934b6 eaaeca6a
       20bd3da9 e0be8777 f7d02033 d1b15884 232281a4 1fc7f80e ed04af5e
B[ 6]: 86ff0182 d40f7f9e db786251 5821bd67 bfd6165a 3c44de95 d7df79b8
       779ccf64 60e3c68b 70c16aaa 280f2d7b 3f22d745 b97a8990 6cfc476c
B[ 7]: 502bcb68 42eb06f0 e49032ba e87c554c 031d6d4d 2d7694ef bf9c468d
       48220c50 f8ca2884 3364d70c ee92d6fe 246e6144 8f9db980 8b3b2408
B[ 8]: 0c9810f1 e2ebd389 caa78937 4d780079 74ef4d17 227316f4 0e578b33
       6827da3f 6b482a47 94eb6a39 75b971b5 e1388f52 e91ea2f1 bcb0f912
B[ 9]: 20d41d85 a18d5657 a2964032 1563bbd0 4c2ffbd0 a37a7ba4 3a4f7d26
       3ce26faf 4e1f74f9 f4b590c6 9229ae57 1fe37fa6 39b5b8eb 48bd9a55
B[10]: e6b4b8f4 08c7010d 0601e7ed a0c309a1 a42720d6 d06b5759 fdc4e1ef
       e22d076d 6c44d42f 508d67be 462914d2 8b8edce3 2e709430 5164af17
B[11]: be88bbb8 6c59c13d 8e9d09ab 98105f69 c2d1dd13 4dbcd3b0 863658f5
       3159db64 c0e139d1 80f3c89b 8296d0ae 324419c0 6fa87fc7 daaf34c1
B[12]: a456f936 9769e8f0 8902124a 0314c7a0 6537a06e 32411f4f 93415950
       a17badfa 7442b621 7434a3a0 5ef45be5 f10bd7b2 ef8ea00c 431edec5
B[13]: 186e452c 4466aa43 83b4c002 10d52e79 22dbf977 1e8b47e2 29a9b7b7
       3c8d10fd 7ef0b6e4 1530f91f 24a3ed9a b71fa38b 98b2fe47 46d51d68
B[14]: 4ae7fdca e9453f19 5a8ead5c be1a7b96 99673b52 c40ab279 27464887
       be53237f 7f3a21b9 38d40d0e c9e15b1d 5130b13f fed81373 a53e2b43
B[15]: 841981c3 bfeec3f6 0cfeca75 d9d8dc17 f46cf010 6f2422b5 9aec580a
       58f34227 2e3a5e57 5a055ddb 051390c5 4c24c6ec b1e0aceb 075f6056
</pre><a class="pilcrow" href="#appendix-B.1-2">¶</a>
</div>
</section>
</div>
<div id="invalid448">
<section id="appendix-B.2">
        <h3 id="name-invalid-encodings-2">
<a class="section-number selfRef" href="#appendix-B.2">B.2. </a><a class="section-name selfRef" href="#name-invalid-encodings-2">Invalid Encodings</a>
        </h3>
<p id="appendix-B.2-1">These are examples of encodings that <span class="bcp14">MUST</span> be rejected according to
<a class="auto internal xref" href="#decoding448">Section 5.3.1</a>.<a class="pilcrow" href="#appendix-B.2-1">¶</a></p>
<div class="breakable lang-test-vectors sourcecode" id="appendix-B.2-2">
<pre># Non-canonical field encodings.
8e24f838 059ee9fe f1e20912 6defe53d cd74ef9b 6304601c 6966099e
ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff

86fcc721 2bd4a0b9 80928666 dc28c444 a605ef38 e09fb569 e28d4443
ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff

866d54bd 4c4ff41a 55d4eefd beca73cb d653c7bd 3135b383 708ec0bd
ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff

4a380ccd ab9c8636 4a89e77a 464d64f9 157538cf dfa686ad c0d5ece4
ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff

f22d9d4c 945dd44d 11e0b1d3 d3d358d9 59b4844d 83b08c44 e659d79f
ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff

8cdffc68 1aa99e9c 818c8ef4 c3808b58 e86acdef 1ab68c84 77af185b
ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff

0e1c12ac 7b5920ef fbd044e8 97c57634 e2d05b5c 27f8fa3d f8a086a1
ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff

# Negative field elements.
15141bd2 121837ef 71a0016b d11be757 507221c2 6542244f 23806f3f
d3496b7d 4c368262 76f3bf5d eea2c60c 4fa4cec6 9946876d a497e795

455d3802 38434ab7 40a56267 f4f46b7d 2eb2dd8e e905e51d 7b0ae8a6
cb2bae50 1e67df34 ab21fa45 946068c9 f233939b 1d9521a9 98b7cb93

810b1d8e 8bf3a9c0 23294bbf d3d905a9 7531709b dc0f4239 0feedd70
10f77e98 686d400c 9c86ed25 0ceecd9d e0a18888 ffecda0f 4ea1c60d

d3af9cc4 1be0e5de 83c0c627 3bedcb93 51970110 044a9a41 c7b9b226
7cdb9d7b f4dc9c2f db8bed32 87818460 4f1d9944 305a8df4 274ce301

9312bcab 09009e43 30ff89c4 bc1e9e00 0d863efc 3c863d3b 6c507a40
fd2cdefd e1bf0892 b4b5ed97 80b91ed1 398fb4a7 344c605a a5efda74

53d11bce 9e62a29d 63ed82ae 93761bdd 76e38c21 e2822d6e bee5eb1c
5b8a03ea f9df749e 2490eda9 d8ac27d1 f71150de 93668074 d18d1c3a

697c1aed 3cd88585 15d4be8a c158b229 fe184d79 cb2b06e4 9210a6f3
a7cd537b cd9bd390 d96c4ab6 a4406da5 d9364072 6285370c fa95df80

# Non-square x^2.
58ad4871 5c9a1025 69b68b88 362a4b06 45781f5a 19eb7e59 c6a4686f
d0f0750f f42e3d7a f1ab38c2 9d69b670 f3125891 9c9fdbf6 093d06c0

8ca37ee2 b15693f0 6e910cf4 3c4e32f1 d5551dda 8b1e48cb 6ddd55e4
40dbc7b2 96b60191 9a4e4069 f59239ca 247ff693 f7daa42f 086122b1

982c0ec7 f43d9f97 c0a74b36 db0abd9c a6bfb981 23a90782 787242c8
a523cdc7 6df14a91 0d544711 27e7662a 1059201f 902940cd 39d57af5

baa9ab82 d07ca282 b968a911 a6c3728d 74bf2fe2 58901925 787f03ee
4be7e3cb 6684fd1b cfe5071a 9a974ad2 49a4aaa8 ca812642 16c68574

2ed9ffe2 ded67a37 2b181ac5 24996402 c4297062 9db03f5e 8636cbaf
6074b523 d154a7a8 c4472c4c 353ab88c d6fec7da 7780834c c5bd5242

f063769e 4241e76d 815800e4 933a3a14 4327a30e c40758ad 3723a788
388399f7 b3f5d45b 6351eb8e ddefda7d 5bff4ee9 20d338a8 b89d8b63

5a0104f1 f55d152c eb68bc13 81824998 91d90ee8 f09b4003 8ccc1e07
cb621fd4 62f781d0 45732a4f 0bda73f0 b2acf943 55424ff0 388d4b9c
</pre><a class="pilcrow" href="#appendix-B.2-2">¶</a>
</div>
</section>
</div>
<div id="group-elements-from-uniform-byte-strings-1">
<section id="appendix-B.3">
        <h3 id="name-group-elements-from-uniform-">
<a class="section-number selfRef" href="#appendix-B.3">B.3. </a><a class="section-name selfRef" href="#name-group-elements-from-uniform-">Group Elements from Uniform Byte Strings</a>
        </h3>
<p id="appendix-B.3-1">The following pairs are inputs to the element derivation function of
<a class="auto internal xref" href="#from_bytes_uniform448">Section 5.3.4</a> and their encoded outputs.<a class="pilcrow" href="#appendix-B.3-1">¶</a></p>
<div class="lang-test-vectors sourcecode" id="appendix-B.3-2">
<pre>I: cbb8c991fd2f0b7e1913462d6463e4fd2ce4ccdd28274dc2ca1f4165
   d5ee6cdccea57be3416e166fd06718a31af45a2f8e987e301be59ae6
   673e963001dbbda80df47014a21a26d6c7eb4ebe0312aa6fffb8d1b2
   6bc62ca40ed51f8057a635a02c2b8c83f48fa6a2d70f58a1185902c0
O: 0c709c96 07dbb01c 94513358 745b7c23 953d03b3 3e39c723 4e268d1d
   6e24f340 14ccbc22 16b965dd 231d5327 e591dc3c 0e8844cc fd568848

I: b6d8da654b13c3101d6634a231569e6b85961c3f4b460a08ac4a5857
   069576b64428676584baa45b97701be6d0b0ba18ac28d443403b4569
   9ea0fbd1164f5893d39ad8f29e48e399aec5902508ea95e33bc1e9e4
   620489d684eb5c26bc1ad1e09aba61fabc2cdfee0b6b6862ffc8e55a
O: 76ab794e 28ff1224 c727fa10 16bf7f1d 329260b7 218a39ae a2fdb17d
   8bd91190 17b093d6 41cedf74 328c3271 84dc6f2a 64bd90ed dccfcdab

I: 36a69976c3e5d74e4904776993cbac27d10f25f5626dd45c51d15dcf
   7b3e6a5446a6649ec912a56895d6baa9dc395ce9e34b868d9fb2c1fc
   72eb6495702ea4f446c9b7a188a4e0826b1506b0747a6709f37988ff
   1aeb5e3788d5076ccbb01a4bc6623c92ff147a1e21b29cc3fdd0e0f4
O: c8d7ac38 4143500e 50890a1c 25d64334 3accce58 4caf2544 f9249b2b
   f4a69210 82be0e7f 3669bb5e c24535e6 c45621e1 f6dec676 edd8b664

I: d5938acbba432ecd5617c555a6a777734494f176259bff9dab844c81
   aadcf8f7abd1a9001d89c7008c1957272c1786a4293bb0ee7cb37cf3
   988e2513b14e1b75249a5343643d3c5e5545a0c1a2a4d3c685927c38
   bc5e5879d68745464e2589e000b31301f1dfb7471a4f1300d6fd0f99
O: 62beffc6 b8ee11cc d79dbaac 8f0252c7 50eb052b 192f41ee ecb12f29
   79713b56 3caf7d22 588eca5e 80995241 ef963e7a d7cb7962 f343a973

I: 4dec58199a35f531a5f0a9f71a53376d7b4bdd6bbd2904234a8ea65b
   bacbce2a542291378157a8f4be7b6a092672a34d85e473b26ccfbd4c
   dc6739783dc3f4f6ee3537b7aed81df898c7ea0ae89a15b5559596c2
   a5eeacf8b2b362f3db2940e3798b63203cae77c4683ebaed71533e51
O: f4ccb31d 263731ab 88bed634 304956d2 603174c6 6da38742 053fa37d
   d902346c 3862155d 68db63be 87439e3d 68758ad7 268e239d 39c4fd3b

I: df2aa1536abb4acab26efa538ce07fd7bca921b13e17bc5ebcba7d1b
   6b733deda1d04c220f6b5ab35c61b6bcb15808251cab909a01465b8a
   e3fc770850c66246d5a9eae9e2877e0826e2b8dc1bc08009590bc677
   8a84e919fbd28e02a0f9c49b48dc689eb5d5d922dc01469968ee81b5
O: 7e79b00e 8e0a76a6 7c0040f6 2713b8b8 c6d6f05e 9c6d0259 2e8a22ea
   896f5dea cc7c7df5 ed42beae 6fedb900 0285b482 aa504e27 9fd49c32

I: e9fb440282e07145f1f7f5ecf3c273212cd3d26b836b41b02f108431
   488e5e84bd15f2418b3d92a3380dd66a374645c2a995976a015632d3
   6a6c2189f202fc766e1c82f50ad9189be190a1f0e8f9b9e69c9c18cc
   98fdd885608f68bf0fdedd7b894081a63f70016a8abf04953affbefa
O: 20b171cb 16be977f 15e013b9 752cf86c 54c631c4 fc8cbf7c 03c4d3ac
   9b8e8640 e7b0e930 0b987fe0 ab504466 9314f6ed 1650ae03 7db853f1
</pre><a class="pilcrow" href="#appendix-B.3-2">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="acknowledgements">
<section id="appendix-C">
      <h2 id="name-acknowledgements">
<a class="section-name selfRef" href="#name-acknowledgements">Acknowledgements</a>
      </h2>
<p id="appendix-C-1">The authors would like to thank <span class="contact-name">Daira Emma Hopwood</span>, <span class="contact-name">Riad S. Wahby</span>, <span class="contact-name">Christopher Wood</span>,
and <span class="contact-name">Thomas Pornin</span> for their comments on the document.<a class="pilcrow" href="#appendix-C-1">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-D">
      <h2 id="name-authors-addresses">
<a class="section-name selfRef" href="#name-authors-addresses">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Henry de Valence</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:ietf@hdevalence.ca">ietf@hdevalence.ca</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Jack Grigg</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:ietf@jackgrigg.com">ietf@jackgrigg.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Mike Hamburg</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:ietf@shiftleft.org">ietf@shiftleft.org</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Isis Lovecruft</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:ietf@en.ciph.re">ietf@en.ciph.re</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">George Tankersley</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:ietf@gtank.cc">ietf@gtank.cc</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Filippo Valsorda</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:ietf@filippo.io">ietf@filippo.io</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>


</body></html>