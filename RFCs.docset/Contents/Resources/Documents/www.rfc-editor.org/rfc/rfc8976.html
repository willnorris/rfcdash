<!DOCTYPE html>
<html class="RFC" lang="en"><head>
<meta charset="utf-8"/>
<meta content="Common,Latin" name="scripts"/>
<meta content="initial-scale=1.0" name="viewport"/>
<title>RFC 8976: Message Digest for DNS Zones</title>
<meta content="Duane Wessels" name="author"/>
<meta content="Piet Barber" name="author"/>
<meta content="Matt Weinberg" name="author"/>
<meta content="Warren Kumari" name="author"/>
<meta content="Wes Hardaker" name="author"/>
<meta content="
       
        This document describes a protocol and new DNS Resource Record that
        provides a cryptographic message digest over DNS zone data at rest.
        The ZONEMD Resource Record conveys the digest data in the zone itself.
        When used in combination with DNSSEC, ZONEMD allows recipients to
        verify the zone contents for data integrity and origin authenticity.
        This provides assurance that received zone data matches published
        data, regardless of how the zone data has been transmitted and
        received.  When used without DNSSEC, ZONEMD functions as a checksum,
        guarding only against unintentional changes.
       
       

        ZONEMD does not replace DNSSEC:
        DNSSEC protects individual RRsets (DNS data with
        fine granularity), whereas ZONEMD protects a zone's data
        as a whole, whether consumed by authoritative name
        servers, recursive name servers, or any other applications.
       
       
        As specified herein, ZONEMD is impractical
        for large, dynamic zones due to the time and resources
        required for digest calculation.
        However, the ZONEMD record is extensible
        so that new digest schemes may be added in the future to support large, dynamic
        zones.
       
    " name="description"/>
<meta content="xml2rfc 3.5.0" name="generator"/>
<meta content="DNS" name="keyword"/>
<meta content="DNSSEC" name="keyword"/>
<meta content="Checksum" name="keyword"/>
<meta content="Hash" name="keyword"/>
<meta content="Zone Transfer" name="keyword"/>
<meta content="8976" name="rfc.number"/>
<!-- Generator version information:
  xml2rfc 3.5.0
    Python 3.6.10
    appdirs 1.4.4
    ConfigArgParse 1.2.3
    google-i18n-address 2.3.5
    html5lib 1.0.1
    intervaltree 3.0.2
    Jinja2 2.11.2
    kitchen 1.2.6
    lxml 4.4.2
    pycairo 1.19.0
    pycountry 19.8.18
    pyflakes 2.1.1
    PyYAML 5.3.1
    requests 2.22.0
    setuptools 40.6.2
    six 1.14.0
    WeasyPrint 51
-->
<link href="rfc8976.xml" rel="alternate" type="application/rfc+xml"/>
<link href="#copyright" rel="license"/>
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css"/>
<link href="https://dx.doi.org/10.17487/rfc8976" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <link href="https://datatracker.ietf.org/doc/draft-ietf-dnsop-dns-zone-digest-14" rel="prev"/>
  </head>
<body>
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 8976</td>
<td class="center">DNS Zone Digest</td>
<td class="right">February 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Wessels, et al.</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div class="document-information" id="external-metadata"></div>
<div class="document-information" id="internal-metadata">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a class="eref" href="https://www.rfc-editor.org/rfc/rfc8976">8976</a></dd>
<dt class="label-category">Category:</dt>
<dd class="category">Standards Track</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time class="published" datetime="2021-02">February 2021</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">D. Wessels</div>
<div class="org">Verisign</div>
</div>
<div class="author">
      <div class="author-name">P. Barber</div>
<div class="org">Verisign</div>
</div>
<div class="author">
      <div class="author-name">M. Weinberg</div>
<div class="org">Amazon</div>
</div>
<div class="author">
      <div class="author-name">W. Kumari</div>
<div class="org">Google</div>
</div>
<div class="author">
      <div class="author-name">W. Hardaker</div>
<div class="org">USC/ISI</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 8976</h1>
<h1 id="title">Message Digest for DNS Zones</h1>
<section id="section-abstract">
      <h2 id="abstract"><a class="selfRef" href="#abstract">Abstract</a></h2>
<p id="section-abstract-1">
        This document describes a protocol and new DNS Resource Record that
        provides a cryptographic message digest over DNS zone data at rest.
        The ZONEMD Resource Record conveys the digest data in the zone itself.
        When used in combination with DNSSEC, ZONEMD allows recipients to
        verify the zone contents for data integrity and origin authenticity.
        This provides assurance that received zone data matches published
        data, regardless of how the zone data has been transmitted and
        received.  When used without DNSSEC, ZONEMD functions as a checksum,
        guarding only against unintentional changes.<a class="pilcrow" href="#section-abstract-1">¶</a></p>
<p id="section-abstract-2">

        ZONEMD does not replace DNSSEC:
        DNSSEC protects individual RRsets (DNS data with
        fine granularity), whereas ZONEMD protects a zone's data
        as a whole, whether consumed by authoritative name
        servers, recursive name servers, or any other applications.<a class="pilcrow" href="#section-abstract-2">¶</a></p>
<p id="section-abstract-3">
        As specified herein, ZONEMD is impractical
        for large, dynamic zones due to the time and resources
        required for digest calculation.
        However, the ZONEMD record is extensible
        so that new digest schemes may be added in the future to support large, dynamic
        zones.<a class="pilcrow" href="#section-abstract-3">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a class="section-name selfRef" href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This is an Internet Standards Track document.<a class="pilcrow" href="#section-boilerplate.1-1">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.<a class="pilcrow" href="#section-boilerplate.1-2">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc8976">https://www.rfc-editor.org/info/rfc8976</a></span>.<a class="pilcrow" href="#section-boilerplate.1-3">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a class="section-name selfRef" href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a class="pilcrow" href="#section-boilerplate.2-1">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a class="pilcrow" href="#section-boilerplate.2-2">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a class="toplink" href="#" onclick="scroll(0,0)">▲</a><h2 id="name-table-of-contents">
<a class="section-name selfRef" href="#name-table-of-contents">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a class="xref" href="#section-1">1</a>.  <a class="xref" href="#name-introduction">Introduction</a><a class="pilcrow" href="#section-toc.1-1.1.1">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.1.2.1">
                <p class="keepWithNext" id="section-toc.1-1.1.2.1.1"><a class="xref" href="#section-1.1">1.1</a>.  <a class="xref" href="#name-motivation">Motivation</a><a class="pilcrow" href="#section-toc.1-1.1.2.1.1">¶</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.1.2.2">
                <p class="keepWithNext" id="section-toc.1-1.1.2.2.1"><a class="xref" href="#section-1.2">1.2</a>.  <a class="xref" href="#name-alternative-approaches">Alternative Approaches</a><a class="pilcrow" href="#section-toc.1-1.1.2.2.1">¶</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.1.2.3">
                <p class="keepWithNext" id="section-toc.1-1.1.2.3.1"><a class="xref" href="#section-1.3">1.3</a>.  <a class="xref" href="#name-design-overview">Design Overview</a><a class="pilcrow" href="#section-toc.1-1.1.2.3.1">¶</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.1.2.4">
                <p id="section-toc.1-1.1.2.4.1"><a class="xref" href="#section-1.4">1.4</a>.  <a class="xref" href="#name-use-cases">Use Cases</a><a class="pilcrow" href="#section-toc.1-1.1.2.4.1">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.1.2.4.2.1">
                    <p id="section-toc.1-1.1.2.4.2.1.1"><a class="xref" href="#section-1.4.1">1.4.1</a>.  <a class="xref" href="#name-root-zone">Root Zone</a><a class="pilcrow" href="#section-toc.1-1.1.2.4.2.1.1">¶</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.1.2.4.2.2">
                    <p id="section-toc.1-1.1.2.4.2.2.1"><a class="xref" href="#section-1.4.2">1.4.2</a>.  <a class="xref" href="#name-providers-secondaries-and-a">Providers, Secondaries, and Anycast</a><a class="pilcrow" href="#section-toc.1-1.1.2.4.2.2.1">¶</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.1.2.4.2.3">
                    <p id="section-toc.1-1.1.2.4.2.3.1"><a class="xref" href="#section-1.4.3">1.4.3</a>.  <a class="xref" href="#name-response-policy-zones">Response Policy Zones</a><a class="pilcrow" href="#section-toc.1-1.1.2.4.2.3.1">¶</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.1.2.4.2.4">
                    <p id="section-toc.1-1.1.2.4.2.4.1"><a class="xref" href="#section-1.4.4">1.4.4</a>.  <a class="xref" href="#name-centralized-zone-data-servi">Centralized Zone Data Service</a><a class="pilcrow" href="#section-toc.1-1.1.2.4.2.4.1">¶</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.1.2.4.2.5">
                    <p id="section-toc.1-1.1.2.4.2.5.1"><a class="xref" href="#section-1.4.5">1.4.5</a>.  <a class="xref" href="#name-general-purpose-comparison-">General Purpose Comparison Check</a><a class="pilcrow" href="#section-toc.1-1.1.2.4.2.5.1">¶</a></p>
</li>
                </ul>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.1.2.5">
                <p id="section-toc.1-1.1.2.5.1"><a class="xref" href="#section-1.5">1.5</a>.  <a class="xref" href="#name-terminology">Terminology</a><a class="pilcrow" href="#section-toc.1-1.1.2.5.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a class="xref" href="#section-2">2</a>.  <a class="xref" href="#name-the-zonemd-resource-record">The ZONEMD Resource Record</a><a class="pilcrow" href="#section-toc.1-1.2.1">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a class="xref" href="#section-2.1">2.1</a>.  <a class="xref" href="#name-non-apex-zonemd-records">Non-apex ZONEMD Records</a><a class="pilcrow" href="#section-toc.1-1.2.2.1.1">¶</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a class="xref" href="#section-2.2">2.2</a>.  <a class="xref" href="#name-zonemd-rdata-wire-format">ZONEMD RDATA Wire Format</a><a class="pilcrow" href="#section-toc.1-1.2.2.2.1">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.2.2.2.2.1">
                    <p id="section-toc.1-1.2.2.2.2.1.1"><a class="xref" href="#section-2.2.1">2.2.1</a>.  <a class="xref" href="#name-the-serial-field">The Serial Field</a><a class="pilcrow" href="#section-toc.1-1.2.2.2.2.1.1">¶</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.2.2.2.2.2">
                    <p id="section-toc.1-1.2.2.2.2.2.1"><a class="xref" href="#section-2.2.2">2.2.2</a>.  <a class="xref" href="#name-the-scheme-field">The Scheme Field</a><a class="pilcrow" href="#section-toc.1-1.2.2.2.2.2.1">¶</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.2.2.2.2.3">
                    <p id="section-toc.1-1.2.2.2.2.3.1"><a class="xref" href="#section-2.2.3">2.2.3</a>.  <a class="xref" href="#name-the-hash-algorithm-field">The Hash Algorithm Field</a><a class="pilcrow" href="#section-toc.1-1.2.2.2.2.3.1">¶</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.2.2.2.2.4">
                    <p id="section-toc.1-1.2.2.2.2.4.1"><a class="xref" href="#section-2.2.4">2.2.4</a>.  <a class="xref" href="#name-the-digest-field">The Digest Field</a><a class="pilcrow" href="#section-toc.1-1.2.2.2.2.4.1">¶</a></p>
</li>
                </ul>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a class="xref" href="#section-2.3">2.3</a>.  <a class="xref" href="#name-zonemd-presentation-format">ZONEMD Presentation Format</a><a class="pilcrow" href="#section-toc.1-1.2.2.3.1">¶</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.2.2.4">
                <p id="section-toc.1-1.2.2.4.1"><a class="xref" href="#section-2.4">2.4</a>.  <a class="xref" href="#name-zonemd-example">ZONEMD Example</a><a class="pilcrow" href="#section-toc.1-1.2.2.4.1">¶</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.2.2.5">
                <p id="section-toc.1-1.2.2.5.1"><a class="xref" href="#section-2.5">2.5</a>.  <a class="xref" href="#name-including-zonemd-rrs-in-a-z">Including ZONEMD RRs in a Zone</a><a class="pilcrow" href="#section-toc.1-1.2.2.5.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a class="xref" href="#section-3">3</a>.  <a class="xref" href="#name-calculating-the-digest">Calculating the Digest</a><a class="pilcrow" href="#section-toc.1-1.3.1">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a class="xref" href="#section-3.1">3.1</a>.  <a class="xref" href="#name-add-zonemd-placeholder">Add ZONEMD Placeholder</a><a class="pilcrow" href="#section-toc.1-1.3.2.1.1">¶</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a class="xref" href="#section-3.2">3.2</a>.  <a class="xref" href="#name-optionally-sign-the-zone">Optionally, Sign the Zone</a><a class="pilcrow" href="#section-toc.1-1.3.2.2.1">¶</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a class="xref" href="#section-3.3">3.3</a>.  <a class="xref" href="#name-scheme-specific-processing">Scheme-Specific Processing</a><a class="pilcrow" href="#section-toc.1-1.3.2.3.1">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.3.2.3.2.1">
                    <p id="section-toc.1-1.3.2.3.2.1.1"><a class="xref" href="#section-3.3.1">3.3.1</a>.  <a class="xref" href="#name-the-simple-scheme">The SIMPLE Scheme</a><a class="pilcrow" href="#section-toc.1-1.3.2.3.2.1.1">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.3.2.3.2.1.2.1">
                        <p id="section-toc.1-1.3.2.3.2.1.2.1.1"><a class="xref" href="#section-3.3.1.1">3.3.1.1</a>.  <a class="xref" href="#name-simple-scheme-inclusion-exc">SIMPLE Scheme Inclusion/Exclusion Rules</a><a class="pilcrow" href="#section-toc.1-1.3.2.3.2.1.2.1.1">¶</a></p>
</li>
                      <li class="toc compact ulEmpty" id="section-toc.1-1.3.2.3.2.1.2.2">
                        <p id="section-toc.1-1.3.2.3.2.1.2.2.1"><a class="xref" href="#section-3.3.1.2">3.3.1.2</a>.  <a class="xref" href="#name-simple-scheme-digest-calcul">SIMPLE Scheme Digest Calculation</a><a class="pilcrow" href="#section-toc.1-1.3.2.3.2.1.2.2.1">¶</a></p>
</li>
                    </ul>
</li>
                </ul>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a class="xref" href="#section-3.4">3.4</a>.  <a class="xref" href="#name-update-zonemd-rr">Update ZONEMD RR</a><a class="pilcrow" href="#section-toc.1-1.3.2.4.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a class="xref" href="#section-4">4</a>.  <a class="xref" href="#name-verifying-zone-digest">Verifying Zone Digest</a><a class="pilcrow" href="#section-toc.1-1.4.1">¶</a></p>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a class="xref" href="#section-5">5</a>.  <a class="xref" href="#name-iana-considerations">IANA Considerations</a><a class="pilcrow" href="#section-toc.1-1.5.1">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a class="xref" href="#section-5.1">5.1</a>.  <a class="xref" href="#name-zonemd-rrtype">ZONEMD RRtype</a><a class="pilcrow" href="#section-toc.1-1.5.2.1.1">¶</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a class="xref" href="#section-5.2">5.2</a>.  <a class="xref" href="#name-zonemd-scheme">ZONEMD Scheme</a><a class="pilcrow" href="#section-toc.1-1.5.2.2.1">¶</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a class="xref" href="#section-5.3">5.3</a>.  <a class="xref" href="#name-zonemd-hash-algorithms">ZONEMD Hash Algorithms</a><a class="pilcrow" href="#section-toc.1-1.5.2.3.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a class="xref" href="#section-6">6</a>.  <a class="xref" href="#name-security-considerations">Security Considerations</a><a class="pilcrow" href="#section-toc.1-1.6.1">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a class="xref" href="#section-6.1">6.1</a>.  <a class="xref" href="#name-using-zone-digest-without-d">Using Zone Digest without DNSSEC</a><a class="pilcrow" href="#section-toc.1-1.6.2.1.1">¶</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a class="xref" href="#section-6.2">6.2</a>.  <a class="xref" href="#name-attacks-against-the-zone-di">Attacks against the Zone Digest</a><a class="pilcrow" href="#section-toc.1-1.6.2.2.1">¶</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a class="xref" href="#section-6.3">6.3</a>.  <a class="xref" href="#name-use-of-multiple-zonemd-hash">Use of Multiple ZONEMD Hash Algorithms</a><a class="pilcrow" href="#section-toc.1-1.6.2.3.1">¶</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a class="xref" href="#section-6.4">6.4</a>.  <a class="xref" href="#name-dnssec-timing-consideration">DNSSEC Timing Considerations</a><a class="pilcrow" href="#section-toc.1-1.6.2.4.1">¶</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.6.2.5">
                <p id="section-toc.1-1.6.2.5.1"><a class="xref" href="#section-6.5">6.5</a>.  <a class="xref" href="#name-attacks-utilizing-zonemd-qu">Attacks Utilizing ZONEMD Queries</a><a class="pilcrow" href="#section-toc.1-1.6.2.5.1">¶</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.6.2.6">
                <p id="section-toc.1-1.6.2.6.1"><a class="xref" href="#section-6.6">6.6</a>.  <a class="xref" href="#name-resilience-and-fragility">Resilience and Fragility</a><a class="pilcrow" href="#section-toc.1-1.6.2.6.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a class="xref" href="#section-7">7</a>.  <a class="xref" href="#name-performance-considerations">Performance Considerations</a><a class="pilcrow" href="#section-toc.1-1.7.1">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a class="xref" href="#section-7.1">7.1</a>.  <a class="xref" href="#name-simple-sha384">SIMPLE SHA384</a><a class="pilcrow" href="#section-toc.1-1.7.2.1.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a class="xref" href="#section-8">8</a>.  <a class="xref" href="#name-privacy-considerations">Privacy Considerations</a><a class="pilcrow" href="#section-toc.1-1.8.1">¶</a></p>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a class="xref" href="#section-9">9</a>.  <a class="xref" href="#name-references">References</a><a class="pilcrow" href="#section-toc.1-1.9.1">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a class="xref" href="#section-9.1">9.1</a>.  <a class="xref" href="#name-normative-references">Normative References</a><a class="pilcrow" href="#section-toc.1-1.9.2.1.1">¶</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a class="xref" href="#section-9.2">9.2</a>.  <a class="xref" href="#name-informative-references">Informative References</a><a class="pilcrow" href="#section-toc.1-1.9.2.2.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a class="xref" href="#section-appendix.a">Appendix A</a>.  <a class="xref" href="#name-example-zones-with-digests">Example Zones with Digests</a><a class="pilcrow" href="#section-toc.1-1.10.1">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a class="xref" href="#section-a.1">A.1</a>.  <a class="xref" href="#name-simple-example-zone">Simple EXAMPLE Zone</a><a class="pilcrow" href="#section-toc.1-1.10.2.1.1">¶</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a class="xref" href="#section-a.2">A.2</a>.  <a class="xref" href="#name-complex-example-zone">Complex EXAMPLE Zone</a><a class="pilcrow" href="#section-toc.1-1.10.2.2.1">¶</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.10.2.3">
                <p id="section-toc.1-1.10.2.3.1"><a class="xref" href="#section-a.3">A.3</a>.  <a class="xref" href="#name-example-zone-with-multiple-">EXAMPLE Zone with Multiple Digests</a><a class="pilcrow" href="#section-toc.1-1.10.2.3.1">¶</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.10.2.4">
                <p id="section-toc.1-1.10.2.4.1"><a class="xref" href="#section-a.4">A.4</a>.  <a class="xref" href="#name-the-uriarpa-zone">The URI.ARPA Zone</a><a class="pilcrow" href="#section-toc.1-1.10.2.4.1">¶</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.10.2.5">
                <p id="section-toc.1-1.10.2.5.1"><a class="xref" href="#section-a.5">A.5</a>.  <a class="xref" href="#name-the-root-serversnet-zone">The ROOT-SERVERS.NET Zone</a><a class="pilcrow" href="#section-toc.1-1.10.2.5.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a class="xref" href="#section-appendix.b">Appendix B</a>.  <a class="xref" href="#name-implementation-status">Implementation Status</a><a class="pilcrow" href="#section-toc.1-1.11.1">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a class="xref" href="#section-b.1">B.1</a>.  <a class="xref" href="#name-authors-implementation">Authors' Implementation</a><a class="pilcrow" href="#section-toc.1-1.11.2.1.1">¶</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a class="xref" href="#section-b.2">B.2</a>.  <a class="xref" href="#name-shane-kerrs-implementation">Shane Kerr's Implementation</a><a class="pilcrow" href="#section-toc.1-1.11.2.2.1">¶</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.11.2.3">
                <p id="section-toc.1-1.11.2.3.1"><a class="xref" href="#section-b.3">B.3</a>.  <a class="xref" href="#name-nic-chile-labs-implementati">NIC Chile Lab's Implementation</a><a class="pilcrow" href="#section-toc.1-1.11.2.3.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a class="xref" href="#section-appendix.c"></a><a class="xref" href="#name-acknowledgments">Acknowledgments</a><a class="pilcrow" href="#section-toc.1-1.12.1">¶</a></p>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a class="xref" href="#section-appendix.d"></a><a class="xref" href="#name-authors-addresses">Authors' Addresses</a><a class="pilcrow" href="#section-toc.1-1.13.1">¶</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<section id="section-1">
      <h2 id="name-introduction">
<a class="section-number selfRef" href="#section-1">1. </a><a class="section-name selfRef" href="#name-introduction">Introduction</a>
      </h2>
<p id="section-1-1">
        In the DNS, a zone is the collection of authoritative resource records
        (RRs) sharing a common origin (<span>[<a class="xref" href="#RFC8499">RFC8499</a>]</span>).  Zones are often stored as files in the so-called
        "master file format" (<span>[<a class="xref" href="#RFC1034">RFC1034</a>]</span>).  Zones
        are generally distributed among name servers using the zone transfer
        (AXFR) (<span>[<a class="xref" href="#RFC5936">RFC5936</a>]</span>) and incremental zone
        transfer (IXFR) (<span>[<a class="xref" href="#RFC1995">RFC1995</a>]</span>) protocols.
        They can also be distributed outside of the DNS with any file transfer
        protocol such as FTP, HTTP, and rsync, or even as email attachments.
        Currently, there is no standard way to compute a hash or message
        digest for a stand-alone zone.<a class="pilcrow" href="#section-1-1">¶</a></p>
<p id="section-1-2">
        This document specifies an RR type that provides a cryptographic
        message digest of the data in a zone.  It allows a receiver of the
        zone to verify the zone's integrity and authenticity when used in
        combination with DNSSEC.  The digest RR is a part of the zone itself,
        allowing verification of the zone, no matter how it is transmitted.
        The digest uses the wire format of zone data in a canonical ordering.
        Thus, it is independent of presentation format such as whitespace,
        capitalization, and comments.<a class="pilcrow" href="#section-1-2">¶</a></p>
<p id="section-1-3">
        This specification is <span class="bcp14">OPTIONAL</span> to implement by both publishers
        and consumers of zone data.<a class="pilcrow" href="#section-1-3">¶</a></p>
<section id="section-1.1">
        <h3 id="name-motivation">
<a class="section-number selfRef" href="#section-1.1">1.1. </a><a class="section-name selfRef" href="#name-motivation">Motivation</a>
        </h3>
<p id="section-1.1-1">
          The primary motivation for this protocol enhancement is the desire
          to verify the data integrity and origin authenticity of a
          stand-alone zone, regardless of how it is transmitted.  A consumer
          of zone data should be able to verify that it is as published by the
          zone operator.<a class="pilcrow" href="#section-1.1-1">¶</a></p>
<p id="section-1.1-2">
          Note, however, that integrity and authenticity can only be
          assured when the zone is signed.
          DNSSEC provides three strong security guarantees relevant
          to this protocol:<a class="pilcrow" href="#section-1.1-2">¶</a></p>
<ol class="normal type-1" id="section-1.1-3" start="1" type="1">
<li id="section-1.1-3.1">whether or not to expect DNSSEC
        records in the zone,<a class="pilcrow" href="#section-1.1-3.1">¶</a>
</li>
          <li id="section-1.1-3.2">whether or not to expect a ZONEMD record in a signed zone, and<a class="pilcrow" href="#section-1.1-3.2">¶</a>
</li>
          <li id="section-1.1-3.3">whether or not the ZONEMD record has been altered since it was signed.<a class="pilcrow" href="#section-1.1-3.3">¶</a>
</li>
        </ol>
<p id="section-1.1-4">
          A secondary motivation is to provide the equivalent of a checksum,
          allowing a zone recipient to check for unintended changes and
          operational errors such as accidental truncation.<a class="pilcrow" href="#section-1.1-4">¶</a></p>
</section>
<section id="section-1.2">
        <h3 id="name-alternative-approaches">
<a class="section-number selfRef" href="#section-1.2">1.2. </a><a class="section-name selfRef" href="#name-alternative-approaches">Alternative Approaches</a>
        </h3>
<p id="section-1.2-1">
          One approach to preventing data tampering and corruption is to
          secure the distribution channel.  The DNS has a number of features
          that are already used for channel security.  Perhaps the most widely
          used is DNS transaction signatures (TSIGs) (<span>[<a class="xref" href="#RFC8945">RFC8945</a>]</span>). A TSIG uses shared secret keys and a message
          digest to protect individual query and response messages. It is
          generally used to authenticate and validate UPDATE (<span>[<a class="xref" href="#RFC2136">RFC2136</a>]</span>), AXFR (<span>[<a class="xref" href="#RFC5936">RFC5936</a>]</span>), and IXFR (<span>[<a class="xref" href="#RFC1995">RFC1995</a>]</span>) messages.<a class="pilcrow" href="#section-1.2-1">¶</a></p>
<p id="section-1.2-2">
          DNS Request and Transaction Signatures (SIG(0)) (<span>[<a class="xref" href="#RFC2931">RFC2931</a>]</span>) is another protocol extension
          that authenticates individual DNS transactions.  Whereas SIG records
          normally cover specific RR types, SIG(0) is used to sign an entire
          DNS message.  Unlike TSIG, SIG(0) uses public key cryptography
          rather than shared secrets.<a class="pilcrow" href="#section-1.2-2">¶</a></p>
<p id="section-1.2-3">
          The Transport Layer Security protocol suite also provides channel
          security.  The DPRIVE Working Group is in the process of specifying
          DNS Zone Transfer-over-TLS (<span>[<a class="xref" href="#I-D.ietf-dprive-xfr-over-tls">DPRIVE-XFR-OVER-TLS</a>]</span>).  One can
          also easily imagine the distribution of zones over HTTPS-enabled web
          servers as well as DNS-over-HTTPS (<span>[<a class="xref" href="#RFC8484">RFC8484</a>]</span>).<a class="pilcrow" href="#section-1.2-3">¶</a></p>
<p id="section-1.2-4">
          Unfortunately, the protections provided by these channel security
          techniques are (in practice) ephemeral and are not retained after
          the data transfer is complete.  They ensure that the client receives
          the data from the expected server and that the data sent by the
          server is not modified during transmission.  However, they do not
          guarantee that the server transmits the data as originally published
          and do not provide any methods to verify data that is read after
          transmission is complete.  For example, a name server loading saved
          zone data upon restart cannot guarantee that the on-disk data has
          not been modified.  Such modification could be the result of an
          accidental corruption of the file or perhaps an incomplete saving of
          the file (<span>[<a class="xref" href="#DISK-FULL-FAILURE">DISK-FULL-FAILURE</a>]</span>).  For
          these reasons, it is preferable to protect the integrity of the data
          itself.<a class="pilcrow" href="#section-1.2-4">¶</a></p>
<p id="section-1.2-5">
          Why not simply rely on DNSSEC, which provides certain data security
          guarantees?  For zones that are signed, a recipient could validate
          all of the signed RRsets.  Additionally, denial-of-existence records
          prove that RRsets have not been added or removed.  However,
          delegations (non-apex NS records) are not signed by DNSSEC and
          neither are any glue records.  ZONEMD protects the integrity of
          delegation, glue, and other records that are not otherwise covered
          by DNSSEC. Furthermore, zones that employ NSEC3 with Opt-Out (<span>[<a class="xref" href="#RFC5155">RFC5155</a>]</span>) are susceptible to the removal
          or addition of names between the signed nodes.  Whereas DNSSEC
          primarily protects consumers of DNS response messages, this protocol
          protects consumers of zones.<a class="pilcrow" href="#section-1.2-5">¶</a></p>
<p id="section-1.2-6">
          There are existing tools and protocols that provide data security,
          such as OpenPGP (<span>[<a class="xref" href="#RFC4880">RFC4880</a>]</span>) and
          S/MIME (<span>[<a class="xref" href="#RFC8551">RFC8551</a>]</span>).  In fact, the
          internic.net site publishes Pretty Good Privacy (PGP) signatures
          alongside the root zone and other files available there.  However,
          this is a detached signature with no strong association to the
          corresponding zone file other than its timestamp.

  Attached signatures are of course possible, but these necessarily change the
  format of the file being distributed; a zone signed with OpenPGP or S/MIME
  no longer looks like a DNS zone and could not directly be loaded into a name
  server.  Once loaded, the signature data is lost, so it cannot be further
  propagated.<a class="pilcrow" href="#section-1.2-6">¶</a></p>
<p id="section-1.2-7">
          It seems the desire for data security in DNS zones was envisioned
          as far back as 1997.
          <span>[<a class="xref" href="#RFC2065">RFC2065</a>]</span> is an obsoleted specification
          of the first generation DNSSEC Security Extensions.  It
          describes a zone transfer signature, identified as the AXFR SIG, which
          is similar to the technique proposed by this document.
          That is, it proposes ordering all (signed) RRsets in a zone,
          hashing their contents, and then signing the zone hash.
          The AXFR SIG is described only for use during zone
          transfers.  It did not postulate the need to validate
          zone data distributed outside of the DNS.

  Furthermore, its successor, <span>[<a class="xref" href="#RFC2535">RFC2535</a>]</span>, omits the AXFR SIG while at the same time introducing an
  IXFR SIG.  (Note: RFC 2535 was obsoleted by <span>[<a class="xref" href="#RFC4033">RFC4033</a>]</span>, <span>[<a class="xref" href="#RFC4034">RFC4034</a>]</span>, and <span>[<a class="xref" href="#RFC4035">RFC4035</a>]</span>.)<a class="pilcrow" href="#section-1.2-7">¶</a></p>
</section>
<section id="section-1.3">
        <h3 id="name-design-overview">
<a class="section-number selfRef" href="#section-1.3">1.3. </a><a class="section-name selfRef" href="#name-design-overview">Design Overview</a>
        </h3>
<p id="section-1.3-1">
          This document specifies a new Resource Record type
          to convey a message digest of the content of a zone.
          The digest is calculated at the time of zone publication.
          If the zone is signed with DNSSEC, any
          modifications of the digest can be detected.  The procedures for
          digest calculation and DNSSEC signing are similar.  Both require
          data to be processed in a well-defined order and format.
          It may be possible to perform DNSSEC signing and
          digest calculation in parallel.<a class="pilcrow" href="#section-1.3-1">¶</a></p>
<p id="section-1.3-2">
          The zone digest is designed to be used on zones that
          have infrequent updates.  As specified herein,
          the digest is recalculated over the entire zone
          content each time the zone is updated.  This specification does not provide
          an efficient mechanism for updating the digest on incremental updates of zone
          data.  It is, however, extensible so that
          future schemes may be defined to support efficient incremental
          digest updates.<a class="pilcrow" href="#section-1.3-2">¶</a></p>
<p id="section-1.3-3">
          It is expected that verification of a zone digest will be
          implemented in name server software.  That is, a name server
          can verify the zone data it was given and refuse to serve a
          zone that fails verification.  For signed zones, the name
          server needs a trust anchor to perform DNSSEC validation.
          For signed non-root zones, the name server may need to send
          queries to validate a chain of trust.  Digest verification
          could also be performed externally.<a class="pilcrow" href="#section-1.3-3">¶</a></p>
</section>
<section id="section-1.4">
        <h3 id="name-use-cases">
<a class="section-number selfRef" href="#section-1.4">1.4. </a><a class="section-name selfRef" href="#name-use-cases">Use Cases</a>
        </h3>
<section id="section-1.4.1">
          <h4 id="name-root-zone">
<a class="section-number selfRef" href="#section-1.4.1">1.4.1. </a><a class="section-name selfRef" href="#name-root-zone">Root Zone</a>
          </h4>
<p id="section-1.4.1-1">
            The root zone (<span>[<a class="xref" href="#InterNIC">InterNIC</a>]</span>) is one of
            the most widely distributed DNS zones on the Internet, served by
            more than 1000 separate instances (<span>[<a class="xref" href="#ROOT-SERVERS">ROOT-SERVERS</a>]</span>) at the time of this writing.  Additionally,
            many organizations configure their own name servers to serve the
            root zone locally.  Reasons for doing so include privacy and
            reduced access time. <span>[<a class="xref" href="#RFC8806">RFC8806</a>]</span>
            describes one way to do this.  As the root zone spreads beyond its
            traditional deployment boundaries, the verification of the
            completeness of the zone contents becomes more important.<a class="pilcrow" href="#section-1.4.1-1">¶</a></p>
</section>
<section id="section-1.4.2">
          <h4 id="name-providers-secondaries-and-a">
<a class="section-number selfRef" href="#section-1.4.2">1.4.2. </a><a class="section-name selfRef" href="#name-providers-secondaries-and-a">Providers, Secondaries, and Anycast</a>
          </h4>
<p id="section-1.4.2-1">
            Since its very early days, the developers of the DNS recognized
            the importance of secondary name servers and service diversity.
            However, modern DNS service has complex provisioning that includes
            multiple third-party providers (<span>[<a class="xref" href="#RFC8901">RFC8901</a>]</span>) and hundreds of anycast instances (<span>[<a class="xref" href="#RFC3258">RFC3258</a>]</span>).  Instead of a simple
            primary-to-secondary zone distribution system, today it is
            possible to have multiple levels, multiple parties, and multiple
            protocols involved in the distribution of zone data.  This
            complexity introduces new places for problems to arise.  The zone
            digest protects the integrity of data that flows through such
            systems.<a class="pilcrow" href="#section-1.4.2-1">¶</a></p>
</section>
<section id="section-1.4.3">
          <h4 id="name-response-policy-zones">
<a class="section-number selfRef" href="#section-1.4.3">1.4.3. </a><a class="section-name selfRef" href="#name-response-policy-zones">Response Policy Zones</a>
          </h4>
<p id="section-1.4.3-1">
            A Response Policy Zone (RPZ) is "a mechanism to introduce a
            customized policy in Domain Name System servers, so that recursive
            resolvers return possibly modified results" (<span>[<a class="xref" href="#RPZ">RPZ</a>]</span>).  The policy information is carried inside
            specially constructed DNS zones.  A number of companies provide
            RPZ feeds, which are consumed by name server and firewall
            products.  While RPZs can be signed with DNSSEC, the data is
            not queried directly and would not be subject to DNSSEC
            validation.<a class="pilcrow" href="#section-1.4.3-1">¶</a></p>
</section>
<section id="section-1.4.4">
          <h4 id="name-centralized-zone-data-servi">
<a class="section-number selfRef" href="#section-1.4.4">1.4.4. </a><a class="section-name selfRef" href="#name-centralized-zone-data-servi">Centralized Zone Data Service</a>
          </h4>
<p id="section-1.4.4-1">
            ICANN operates the Centralized Zone Data Service (<span>[<a class="xref" href="#CZDS">CZDS</a>]</span>), which is a repository of
            top-level domain zone files.  Users that have been granted access
            are then able to download zone data.  Adding a zone digest to
            these would provide CZDS users with assurances that the data has
            not been modified between origination and retrieval.  Note that
            ZONEMD could be added to zone data supplied to CZDS without
            requiring it to be present in the zone data served by production
            name servers, since the digest is inherently attached to the
            specific copy of the zone.<a class="pilcrow" href="#section-1.4.4-1">¶</a></p>
</section>
<section id="section-1.4.5">
          <h4 id="name-general-purpose-comparison-">
<a class="section-number selfRef" href="#section-1.4.5">1.4.5. </a><a class="section-name selfRef" href="#name-general-purpose-comparison-">General Purpose Comparison Check</a>
          </h4>
<p id="section-1.4.5-1">
            Since the zone digest calculation does not depend on presentation
            format, it could be used to compare multiple copies of
            a zone received from different sources, or copies
            generated by different processes.  In this case, it serves
            as a checksum and can be useful even for unsigned zones.<a class="pilcrow" href="#section-1.4.5-1">¶</a></p>
</section>
</section>
<section id="section-1.5">
        <h3 id="name-terminology">
<a class="section-number selfRef" href="#section-1.5">1.5. </a><a class="section-name selfRef" href="#name-terminology">Terminology</a>
        </h3>
<p id="section-1.5-1">
    The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>",
    "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>",
    "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
    "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are
    to be interpreted as described in BCP 14 <span>[<a class="xref" href="#RFC2119">RFC2119</a>]</span>
          <span>[<a class="xref" href="#RFC8174">RFC8174</a>]</span> when, and only when, they appear in all capitals,
    as shown here.<a class="pilcrow" href="#section-1.5-1">¶</a></p>
<p id="section-1.5-2">
          The terms Private Use, Reserved, Unassigned, and Specification
          Required are to be interpreted as defined in <span>[<a class="xref" href="#RFC8126">RFC8126</a>]</span>.<a class="pilcrow" href="#section-1.5-2">¶</a></p>
</section>
</section>
<div id="rrtype">
<section id="section-2">
      <h2 id="name-the-zonemd-resource-record">
<a class="section-number selfRef" href="#section-2">2. </a><a class="section-name selfRef" href="#name-the-zonemd-resource-record">The ZONEMD Resource Record</a>
      </h2>
<p id="section-2-1">
        This section describes the ZONEMD Resource Record, including its fields, wire format, and presentation format.
        The Type value for the ZONEMD RR is 63.
        The ZONEMD RR is class independent.
        The RDATA of the resource record consists of four fields: Serial, Scheme, Hash Algorithm, and Digest.<a class="pilcrow" href="#section-2-1">¶</a></p>
<section id="section-2.1">
        <h3 id="name-non-apex-zonemd-records">
<a class="section-number selfRef" href="#section-2.1">2.1. </a><a class="section-name selfRef" href="#name-non-apex-zonemd-records">Non-apex ZONEMD Records</a>
        </h3>
<p id="section-2.1-1">
          This document specifies ZONEMD RRs located at the
          zone apex.  Non-apex ZONEMD RRs are not forbidden, but
          have no meaning in this specification.
          Non-apex ZONEMD RRs <span class="bcp14">MUST NOT</span> be used for verification.<a class="pilcrow" href="#section-2.1-1">¶</a></p>
<p id="section-2.1-2">
          During digest calculation,
          non-apex ZONEMD RRs are treated as ordinary RRs.
          They are digested as is, and the RR is not replaced
          by a placeholder RR.<a class="pilcrow" href="#section-2.1-2">¶</a></p>
<p id="section-2.1-3">
          Unless explicitly stated otherwise, "ZONEMD" always refers
          to apex records throughout this document.<a class="pilcrow" href="#section-2.1-3">¶</a></p>
</section>
<section id="section-2.2">
        <h3 id="name-zonemd-rdata-wire-format">
<a class="section-number selfRef" href="#section-2.2">2.2. </a><a class="section-name selfRef" href="#name-zonemd-rdata-wire-format">ZONEMD RDATA Wire Format</a>
        </h3>
<p id="section-2.2-1">The ZONEMD RDATA wire format is encoded as follows:<a class="pilcrow" href="#section-2.2-1">¶</a></p>
<div class="artwork art-text alignLeft" id="section-2.2-2">
<pre>                     1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 3 3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                             Serial                            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|    Scheme     |Hash Algorithm |                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |
|                             Digest                            |
/                                                               /
/                                                               /
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a class="pilcrow" href="#section-2.2-2">¶</a>
</div>
<section id="section-2.2.1">
          <h4 id="name-the-serial-field">
<a class="section-number selfRef" href="#section-2.2.1">2.2.1. </a><a class="section-name selfRef" href="#name-the-serial-field">The Serial Field</a>
          </h4>
<p id="section-2.2.1-1">
            The Serial field is a 32-bit unsigned integer in network byte
            order. It is the serial number from the zone's SOA record (<span>[<a class="xref" href="#RFC1035">RFC1035</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc1035#section-3.3.13">Section 3.3.13</a></span>) for
            which the zone digest was generated.<a class="pilcrow" href="#section-2.2.1-1">¶</a></p>
<p id="section-2.2.1-2">
            It is included here to clearly bind the ZONEMD RR to a particular
            version of the zone's content.  Without the serial number, a
            stand-alone ZONEMD digest has no obvious association to any
            particular instance of a zone.<a class="pilcrow" href="#section-2.2.1-2">¶</a></p>
</section>
<section id="section-2.2.2">
          <h4 id="name-the-scheme-field">
<a class="section-number selfRef" href="#section-2.2.2">2.2.2. </a><a class="section-name selfRef" href="#name-the-scheme-field">The Scheme Field</a>
          </h4>
<p id="section-2.2.2-1">
            The Scheme field is an 8-bit unsigned integer that identifies
            the methods by which data is collated and presented
            as input to the hashing function.<a class="pilcrow" href="#section-2.2.2-1">¶</a></p>
<p id="section-2.2.2-2">
            Herein, SIMPLE, with Scheme value 1, is the only standardized
            Scheme defined for ZONEMD records and it <span class="bcp14">MUST</span> be
            supported by implementations.  The "ZONEMD Schemes" registry is further
            described in <a class="xref" href="#iana">Section 5</a>.<a class="pilcrow" href="#section-2.2.2-2">¶</a></p>
<p id="section-2.2.2-3">
            Scheme values 240-254 are allocated for Private Use.<a class="pilcrow" href="#section-2.2.2-3">¶</a></p>
</section>
<section id="section-2.2.3">
          <h4 id="name-the-hash-algorithm-field">
<a class="section-number selfRef" href="#section-2.2.3">2.2.3. </a><a class="section-name selfRef" href="#name-the-hash-algorithm-field">The Hash Algorithm Field</a>
          </h4>
<p id="section-2.2.3-1">
            The Hash Algorithm field is an 8-bit unsigned integer
            that identifies the cryptographic hash algorithm
            used to construct the digest.<a class="pilcrow" href="#section-2.2.3-1">¶</a></p>
<p id="section-2.2.3-2">
            Herein, SHA384 (<span>[<a class="xref" href="#RFC6234">RFC6234</a>]</span>), with
            Hash Algorithm value 1, is the only standardized Hash Algorithm
            defined for ZONEMD records that <span class="bcp14">MUST</span> be supported
            by implementations.  When SHA384 is used, the size of the Digest
            field is 48 octets.  The result of the SHA384 digest algorithm
            <span class="bcp14">MUST NOT</span> be truncated, and the entire 48-octet
            digest is published in the ZONEMD record.<a class="pilcrow" href="#section-2.2.3-2">¶</a></p>
<p id="section-2.2.3-3">
            SHA512 (<span>[<a class="xref" href="#RFC6234">RFC6234</a>]</span>), with Hash
            Algorithm value 2, is also defined for ZONEMD records and
            <span class="bcp14">SHOULD</span> be supported by implementations.  When
            SHA512 is used, the size of the Digest field is 64 octets.  The
            result of the SHA512 digest algorithm <span class="bcp14">MUST NOT</span> be
            truncated, and the entire 64-octet digest is published in the
            ZONEMD record.<a class="pilcrow" href="#section-2.2.3-3">¶</a></p>
<p id="section-2.2.3-4">
            Hash Algorithm values 240-254 are allocated for Private Use.<a class="pilcrow" href="#section-2.2.3-4">¶</a></p>
<p id="section-2.2.3-5">
            The "ZONEMD Hash Algorithms" registry
            is further described in <a class="xref" href="#iana">Section 5</a>.<a class="pilcrow" href="#section-2.2.3-5">¶</a></p>
</section>
<section id="section-2.2.4">
          <h4 id="name-the-digest-field">
<a class="section-number selfRef" href="#section-2.2.4">2.2.4. </a><a class="section-name selfRef" href="#name-the-digest-field">The Digest Field</a>
          </h4>
<p id="section-2.2.4-1">
            The Digest field is a variable-length sequence of octets
            containing the output of the hash algorithm.
            The length of the Digest field is determined by deducting
            the fixed size of the Serial, Scheme, and Hash Algorithm
            fields from the RDATA size in the ZONEMD RR header.<a class="pilcrow" href="#section-2.2.4-1">¶</a></p>
<p id="section-2.2.4-2">
            The Digest field <span class="bcp14">MUST NOT</span> be shorter than 12
            octets.  Digests for the SHA384 and SHA512 hash algorithms
            specified herein are never truncated.  Digests for future hash
            algorithms <span class="bcp14">MAY</span> be truncated but <span class="bcp14">MUST NOT</span> be truncated to a length that results in less than 96
            bits (12 octets) of equivalent strength.<a class="pilcrow" href="#section-2.2.4-2">¶</a></p>
<p id="section-2.2.4-3">
            <a class="xref" href="#calculating">Section 3</a>
            describes how to calculate the digest for a zone.
            <a class="xref" href="#verifying">Section 4</a> describes how to use the digest to
            verify the contents of a zone.<a class="pilcrow" href="#section-2.2.4-3">¶</a></p>
</section>
</section>
<section id="section-2.3">
        <h3 id="name-zonemd-presentation-format">
<a class="section-number selfRef" href="#section-2.3">2.3. </a><a class="section-name selfRef" href="#name-zonemd-presentation-format">ZONEMD Presentation Format</a>
        </h3>
<p id="section-2.3-1">
          The presentation format of the RDATA portion is as follows:<a class="pilcrow" href="#section-2.3-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.3-2.1">
          The Serial field is represented as an unsigned decimal integer.<a class="pilcrow" href="#section-2.3-2.1">¶</a>
</li>
          <li class="normal" id="section-2.3-2.2">
          The Scheme field is represented as an unsigned decimal integer.<a class="pilcrow" href="#section-2.3-2.2">¶</a>
</li>
          <li class="normal" id="section-2.3-2.3">
          The Hash Algorithm field is represented as an unsigned decimal
          integer.<a class="pilcrow" href="#section-2.3-2.3">¶</a>
</li>
          <li class="normal" id="section-2.3-2.4">
          The Digest is represented as a sequence of case-insensitive
          hexadecimal digits.  Whitespace is allowed within the hexadecimal
          text.<a class="pilcrow" href="#section-2.3-2.4">¶</a>
</li>
        </ul>
</section>
<section id="section-2.4">
        <h3 id="name-zonemd-example">
<a class="section-number selfRef" href="#section-2.4">2.4. </a><a class="section-name selfRef" href="#name-zonemd-example">ZONEMD Example</a>
        </h3>
<p id="section-2.4-1">
          The following example shows a ZONEMD RR in presentation format:<a class="pilcrow" href="#section-2.4-1">¶</a></p>
<div id="section-2.4-2">
<pre class="sourcecode lang-dns-rr">example.com. 86400 IN ZONEMD 2018031500 1 1 (
    FEBE3D4CE2EC2FFA4BA99D46CD69D6D29711E55217057BEE
    7EB1A7B641A47BA7FED2DD5B97AE499FAFA4F22C6BD647DE )
</pre><a class="pilcrow" href="#section-2.4-2">¶</a>
</div>
</section>
<section id="section-2.5">
        <h3 id="name-including-zonemd-rrs-in-a-z">
<a class="section-number selfRef" href="#section-2.5">2.5. </a><a class="section-name selfRef" href="#name-including-zonemd-rrs-in-a-z">Including ZONEMD RRs in a Zone</a>
        </h3>
<p id="section-2.5-1">
          The zone operator chooses an appropriate hash algorithm and
          scheme and includes the calculated zone digest in the apex
          ZONEMD RRset.
          The zone operator <span class="bcp14">MAY</span> choose any of the defined hash algorithms
          and schemes, including the Private Use code points.<a class="pilcrow" href="#section-2.5-1">¶</a></p>
<p id="section-2.5-2">
          The ZONEMD RRset <span class="bcp14">MAY</span> contain multiple records to support algorithm
          agility (<span>[<a class="xref" href="#BCP201">BCP201</a>]</span>).

          When multiple ZONEMD RRs are present, each <span class="bcp14">MUST</span>
          specify a unique Scheme and Hash Algorithm tuple.  It is
          <span class="bcp14">RECOMMENDED</span> that a zone include only one ZONEMD RR,
          unless the zone operator is in the process of transitioning to a new
          scheme or hash algorithm.<a class="pilcrow" href="#section-2.5-2">¶</a></p>
</section>
</section>
</div>
<div id="calculating">
<section id="section-3">
      <h2 id="name-calculating-the-digest">
<a class="section-number selfRef" href="#section-3">3. </a><a class="section-name selfRef" href="#name-calculating-the-digest">Calculating the Digest</a>
      </h2>
<p id="section-3-1">
        The algorithm described in this section is designed for the
        common case of offline DNSSEC signing.
        Slight deviations may be permitted or necessary in other
        situations, such as with unsigned zones or online DNSSEC signing.
        Implementations that deviate from the described algorithm are
        advised to ensure that it produces ZONEMD RRs, signatures,
        and denial-of-existence records that are identical to the
        ones generated by this procedure.<a class="pilcrow" href="#section-3-1">¶</a></p>
<div id="placeholder">
<section id="section-3.1">
        <h3 id="name-add-zonemd-placeholder">
<a class="section-number selfRef" href="#section-3.1">3.1. </a><a class="section-name selfRef" href="#name-add-zonemd-placeholder">Add ZONEMD Placeholder</a>
        </h3>
<p id="section-3.1-1">
          In preparation for calculating the zone digest(s), any existing ZONEMD records
          (and covering RRSIGs)
          at the zone apex
          are first deleted.<a class="pilcrow" href="#section-3.1-1">¶</a></p>
<p id="section-3.1-2">
          Prior to calculation of the digest, and prior to signing with
          DNSSEC, one or more placeholder ZONEMD records are added to the
          zone apex.  This
          ensures that
          denial-of-existence (NSEC, NSEC3) records are created correctly
          if the zone is signed with DNSSEC.  If placeholders were not added prior to
          signing, the later addition of ZONEMD records would also require updating the
          Type Bit Maps field of any apex NSEC/NSEC3 RRs, which then invalidates
          the calculated digest value.<a class="pilcrow" href="#section-3.1-2">¶</a></p>
<p id="section-3.1-3">
          When multiple ZONEMD RRs are published in the zone, e.g.,
          during an algorithm rollover, each <span class="bcp14">MUST</span> specify a unique Scheme
          and Hash Algorithm tuple.<a class="pilcrow" href="#section-3.1-3">¶</a></p>
<p id="section-3.1-4">
          It is <span class="bcp14">RECOMMENDED</span> that the TTL of the ZONEMD record
          match the TTL of the Start of Authority (SOA).  However, the TTL of
          the ZONEMD record may be safely ignored during verification in all
          cases.<a class="pilcrow" href="#section-3.1-4">¶</a></p>
<p id="section-3.1-5">
          In the placeholder record, the Serial field is
          set to the current SOA Serial.
          The Scheme field is set to the value for the chosen collation scheme.
          The Hash Algorithm field is set
          to the value for the chosen hash algorithm.
          Since apex ZONEMD records are excluded from digest calculation,
          the value of the Digest field does not matter at this point
          in the process.<a class="pilcrow" href="#section-3.1-5">¶</a></p>
</section>
</div>
<section id="section-3.2">
        <h3 id="name-optionally-sign-the-zone">
<a class="section-number selfRef" href="#section-3.2">3.2. </a><a class="section-name selfRef" href="#name-optionally-sign-the-zone">Optionally, Sign the Zone</a>
        </h3>
<p id="section-3.2-1">
          Following the addition of placeholder records, the zone may be
          signed with DNSSEC.  When the digest calculation is complete, and
          the ZONEMD record is updated, the signature(s) for the ZONEMD RRset
          <span class="bcp14">MUST</span> be recalculated and updated as well.  Therefore,
          the signer is not required to calculate a signature over the
          placeholder record at this step in the process, but it is harmless
          to do so.<a class="pilcrow" href="#section-3.2-1">¶</a></p>
</section>
<div id="collate-iterate">
<section id="section-3.3">
        <h3 id="name-scheme-specific-processing">
<a class="section-number selfRef" href="#section-3.3">3.3. </a><a class="section-name selfRef" href="#name-scheme-specific-processing">Scheme-Specific Processing</a>
        </h3>
<p id="section-3.3-1">
          Herein, only the SIMPLE collation scheme is defined.
          Additional schemes may be defined in future updates to this document.<a class="pilcrow" href="#section-3.3-1">¶</a></p>
<div id="scheme-simple">
<section id="section-3.3.1">
          <h4 id="name-the-simple-scheme">
<a class="section-number selfRef" href="#section-3.3.1">3.3.1. </a><a class="section-name selfRef" href="#name-the-simple-scheme">The SIMPLE Scheme</a>
          </h4>
<p id="section-3.3.1-1">
            For the SIMPLE scheme, the digest is calculated over the zone as
            a whole.  This means that a change to a single RR in the zone
            requires iterating over all RRs in the zone to recalculate
            the digest.  SIMPLE is a good choice for zones that are small
            and/or stable, but it is probably not good for zones that are
            large and/or dynamic.<a class="pilcrow" href="#section-3.3.1-1">¶</a></p>
<p id="section-3.3.1-2">
            Calculation of a zone digest requires RRs to be processed in a
            consistent format and ordering.  This specification uses DNSSEC's
            canonical on-the-wire RR format (without name compression) and
            ordering as specified in Sections <a class="relref" href="https://www.rfc-editor.org/rfc/rfc4034#section-6.1">6.1</a>, <a class="relref" href="https://www.rfc-editor.org/rfc/rfc4034#section-6.2">6.2</a>, and <a class="relref" href="https://www.rfc-editor.org/rfc/rfc4034#section-6.3">6.3</a> of <span>[<a class="xref" href="#RFC4034">RFC4034</a>]</span> with the additional provision that RRsets
            having the same owner name <span class="bcp14">MUST</span> be numerically
            ordered, in ascending order, by their numeric RR TYPE.<a class="pilcrow" href="#section-3.3.1-2">¶</a></p>
<div id="simple-inclusion-exclusion">
<section id="section-3.3.1.1">
            <h5 id="name-simple-scheme-inclusion-exc">
<a class="section-number selfRef" href="#section-3.3.1.1">3.3.1.1. </a><a class="section-name selfRef" href="#name-simple-scheme-inclusion-exc">SIMPLE Scheme Inclusion/Exclusion Rules</a>
            </h5>
<p id="section-3.3.1.1-1">
              When iterating over records in the zone, the following
              inclusion/exclusion rules apply:<a class="pilcrow" href="#section-3.3.1.1-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3.1.1-2.1">All records in the zone, including glue records,
              <span class="bcp14">MUST</span> be included unless excluded by a subsequent
              rule.<a class="pilcrow" href="#section-3.3.1.1-2.1">¶</a>
</li>
              <li class="normal" id="section-3.3.1.1-2.2">Occluded data (<span>[<a class="xref" href="#RFC5936">RFC5936</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc5936#section-3.5">Section 3.5</a></span>) <span class="bcp14">MUST</span> be included.<a class="pilcrow" href="#section-3.3.1.1-2.2">¶</a>
</li>
              <li class="normal" id="section-3.3.1.1-2.3">If there are duplicate RRs with equal owner, class, type,
              and RDATA, only one instance is included (<span>[<a class="xref" href="#RFC4034">RFC4034</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc4034#section-6.3">Section 6.3</a></span>) and the duplicates
              <span class="bcp14">MUST</span> be omitted.<a class="pilcrow" href="#section-3.3.1.1-2.3">¶</a>
</li>
              <li class="normal" id="section-3.3.1.1-2.4">The placeholder apex ZONEMD RR(s) <span class="bcp14">MUST NOT</span> be included.<a class="pilcrow" href="#section-3.3.1.1-2.4">¶</a>
</li>
              <li class="normal" id="section-3.3.1.1-2.5">If the zone is signed, DNSSEC RRs <span class="bcp14">MUST</span> be included, except:<a class="pilcrow" href="#section-3.3.1.1-2.5">¶</a>
</li>
              <li class="normal" id="section-3.3.1.1-2.6">The RRSIG covering the apex ZONEMD RRset <span class="bcp14">MUST NOT</span> be included
                because the RRSIG will be updated after all digests have been calculated.<a class="pilcrow" href="#section-3.3.1.1-2.6">¶</a>
</li>
            </ul>
</section>
</div>
<section id="section-3.3.1.2">
            <h5 id="name-simple-scheme-digest-calcul">
<a class="section-number selfRef" href="#section-3.3.1.2">3.3.1.2. </a><a class="section-name selfRef" href="#name-simple-scheme-digest-calcul">SIMPLE Scheme Digest Calculation</a>
            </h5>
<p id="section-3.3.1.2-1">
              A zone digest using the SIMPLE scheme is calculated by
              concatenating all RRs in the zone, in the format and order
              described in <a class="xref" href="#scheme-simple">Section 3.3.1</a>
              subject to the inclusion/exclusion rules described in <a class="xref" href="#simple-inclusion-exclusion">Section 3.3.1.1</a>, and then
              applying the chosen hash algorithm:<a class="pilcrow" href="#section-3.3.1.2-1">¶</a></p>
<div id="section-3.3.1.2-2">
<pre class="sourcecode lang-pseudocode">digest = hash( RR(1) | RR(2) | RR(3) | ... )

where "|" denotes concatenation.
</pre><a class="pilcrow" href="#section-3.3.1.2-2">¶</a>
</div>
</section>
</section>
</div>
</section>
</div>
<section id="section-3.4">
        <h3 id="name-update-zonemd-rr">
<a class="section-number selfRef" href="#section-3.4">3.4. </a><a class="section-name selfRef" href="#name-update-zonemd-rr">Update ZONEMD RR</a>
        </h3>
<p id="section-3.4-1">
          The calculated zone digest is inserted into the placeholder ZONEMD
          RR.  Repeat for each digest if multiple digests are to be published.<a class="pilcrow" href="#section-3.4-1">¶</a></p>
<p id="section-3.4-2">
          If the zone is signed with DNSSEC, the RRSIG record(s) covering the ZONEMD
          RRset <span class="bcp14">MUST</span> then be added or updated.  Because the ZONEMD placeholder was added prior to signing,
          the zone will already have the appropriate denial-of-existence (NSEC, NSEC3) records.<a class="pilcrow" href="#section-3.4-2">¶</a></p>
<p id="section-3.4-3">
          Some DNSSEC implementations (especially "online signing") might
          update the SOA serial number whenever
          a new signature is made.  To preserve the calculated digest,
          generation of a ZONEMD signature <span class="bcp14">MUST NOT</span> also result in
          a change to the SOA serial number.  The ZONEMD RR and the
          matching SOA <span class="bcp14">MUST</span> be published at the same time.<a class="pilcrow" href="#section-3.4-3">¶</a></p>
</section>
</section>
</div>
<div id="verifying">
<section id="section-4">
      <h2 id="name-verifying-zone-digest">
<a class="section-number selfRef" href="#section-4">4. </a><a class="section-name selfRef" href="#name-verifying-zone-digest">Verifying Zone Digest</a>
      </h2>
<p id="section-4-1">
        The recipient of a zone that has a ZONEMD RR verifies the zone by
        calculating the digest as follows:<a class="pilcrow" href="#section-4-1">¶</a></p>
<aside id="section-4-2">
        <p id="section-4-2.1">Note: If multiple ZONEMD RRs are present in the zone, e.g., during an
algorithm rollover, a match using any one of the recipient's supported Schemes
and Hash Algorithms is sufficient to verify the zone.  The verifier
<span class="bcp14">MAY</span> ignore a ZONEMD RR if its Scheme and Hash Algorithm
violates local policy.<a class="pilcrow" href="#section-4-2.1">¶</a></p>
</aside>
<ol class="normal type-1" id="section-4-3" start="1" type="1">
<li id="section-4-3.1">
<div id="verify-check-dnssec"> The
      verifier <span class="bcp14">MUST</span> first determine whether or not to expect
      DNSSEC records in the zone.  By examining locally configured trust
      anchors and, if necessary, querying for and validating Delegation Signer
      (DS) RRs in the parent zone, the verifier knows whether or not the zone
      to be verified should include DNSSEC keys and signatures.  For zones
      where signatures are not expected, or if DNSSEC validation is not
      performed, digest verification continues at step <a class="xref" href="#verify-check-digest-count">4</a> below.<a class="pilcrow" href="#verify-check-dnssec">¶</a>
</div>
        </li>
<li id="section-4-3.2">
<div id="verify-check-existence">
            For zones where signatures are expected, the existence of the apex
            ZONEMD record <span class="bcp14">MUST</span> be validated.  If the DNSSEC
            data proves the ZONEMD RRset does not exist, digest verification
            cannot occur.  If the DNSSEC data proves the ZONEMD does exist,
            but is not found in the zone, digest verification <span class="bcp14">MUST NOT</span> be considered successful.<a class="pilcrow" href="#verify-check-existence">¶</a>
</div>
        </li>
<li id="section-4-3.3">
<div id="verify-dnssec-validate">
            For zones where signatures are expected, the SOA and ZONEMD RRsets
            <span class="bcp14">MUST</span> have valid signatures, chaining up to a trust
            anchor.  If DNSSEC validation of the SOA or ZONEMD RRsets fails,
            digest verification <span class="bcp14">MUST NOT</span> be considered
            successful.<a class="pilcrow" href="#verify-dnssec-validate">¶</a>
</div>
        </li>
<li id="section-4-3.4">
<div id="verify-check-digest-count">
            When multiple ZONEMD RRs are present, each <span class="bcp14">MUST</span>
            specify a unique Scheme and Hash Algorithm tuple.  If the ZONEMD
            RRset contains more than one RR with the same Scheme and Hash
            Algorithm, digest verification for those ZONEMD RRs <span class="bcp14">MUST NOT</span> be considered successful.<a class="pilcrow" href="#verify-check-digest-count">¶</a>
</div>
        </li>
<li id="section-4-3.5">
          <p id="section-4-3.5.1">
            Loop over all apex ZONEMD RRs and perform the following steps:<a class="pilcrow" href="#section-4-3.5.1">¶</a></p>
<ol class="normal type-a" id="section-4-3.5.2" start="1" type="a">
<li id="section-4-3.5.2.1">
<div id="verify-check-serials"> The
          SOA Serial field <span class="bcp14">MUST</span> exactly match the ZONEMD Serial
          field.  If the fields do not match, digest verification <span class="bcp14">MUST NOT</span> be considered successful with this ZONEMD RR.<a class="pilcrow" href="#verify-check-serials">¶</a>
</div>
            </li>
<li id="section-4-3.5.2.2">
                The Scheme field <span class="bcp14">MUST</span> be checked.  If the
                verifier does not support the given scheme, verification
                <span class="bcp14">MUST NOT</span> be considered successful with this
                ZONEMD RR.<a class="pilcrow" href="#section-4-3.5.2.2">¶</a>
</li>
            <li id="section-4-3.5.2.3">
                The Hash Algorithm field <span class="bcp14">MUST</span> be checked.  If
                the verifier does not support the given hash algorithm,
                verification <span class="bcp14">MUST NOT</span> be considered successful
                with this ZONEMD RR.<a class="pilcrow" href="#section-4-3.5.2.3">¶</a>
</li>
            <li id="section-4-3.5.2.4">
                The Digest field size <span class="bcp14">MUST</span> be checked.  If the
                size of the given Digest field is smaller than 12 octets, or
                if the size is not equal to the size expected for the
                corresponding Hash Algorithm, verification <span class="bcp14">MUST NOT</span> be considered successful with this ZONEMD RR.<a class="pilcrow" href="#section-4-3.5.2.4">¶</a>
</li>
            <li id="section-4-3.5.2.5">
                The zone digest is computed over the zone data as described in
                <a class="xref" href="#collate-iterate">Section 3.3</a> using the
                Scheme and Hash Algorithm for the current ZONEMD RR.<a class="pilcrow" href="#section-4-3.5.2.5">¶</a>
</li>
            <li id="section-4-3.5.2.6">
                The computed digest is compared to the received digest.  If
                the two digest values match, verification is considered
                successful.  Otherwise, verification <span class="bcp14">MUST NOT</span>
                be considered successful for this ZONEMD RR.<a class="pilcrow" href="#section-4-3.5.2.6">¶</a>
</li>
          </ol>
</li>
      </ol>
<p id="section-4-4">
        Each time zone verification is performed, the verifier <span class="bcp14">SHOULD</span>
        report the status as either successful or unsuccessful.
        When unsuccessful, the verifier <span class="bcp14">SHOULD</span> report the reason(s) that
        verification did not succeed.<a class="pilcrow" href="#section-4-4">¶</a></p>
</section>
</div>
<div id="iana">
<section id="section-5">
      <h2 id="name-iana-considerations">
<a class="section-number selfRef" href="#section-5">5. </a><a class="section-name selfRef" href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<section id="section-5.1">
        <h3 id="name-zonemd-rrtype">
<a class="section-number selfRef" href="#section-5.1">5.1. </a><a class="section-name selfRef" href="#name-zonemd-rrtype">ZONEMD RRtype</a>
        </h3>
<p id="section-5.1-1">
          This document defines a new DNS RR type, ZONEMD, whose
          value 63 has been allocated by IANA from the "Resource
          Record (RR) TYPEs" subregistry of the "Domain Name System
          (DNS) Parameters" registry:<a class="pilcrow" href="#section-5.1-1">¶</a></p>
<span class="break"></span><dl class="dlParallel dlCompact" id="section-5.1-2">
          <dt id="section-5.1-2.1">Type:
</dt>
          <dd id="section-5.1-2.2" style="margin-left: 1.5em">ZONEMD<a class="pilcrow" href="#section-5.1-2.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-2.3">Value:
</dt>
          <dd id="section-5.1-2.4" style="margin-left: 1.5em">63<a class="pilcrow" href="#section-5.1-2.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-2.5">Meaning:
</dt>
          <dd id="section-5.1-2.6" style="margin-left: 1.5em">Message Digest Over Zone Data<a class="pilcrow" href="#section-5.1-2.6">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-2.7">Reference:
</dt>
          <dd id="section-5.1-2.8" style="margin-left: 1.5em">[RFC8976]<a class="pilcrow" href="#section-5.1-2.8">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
<section id="section-5.2">
        <h3 id="name-zonemd-scheme">
<a class="section-number selfRef" href="#section-5.2">5.2. </a><a class="section-name selfRef" href="#name-zonemd-scheme">ZONEMD Scheme</a>
        </h3>
<p id="section-5.2-1">
          IANA has created a new subregistry in the "Domain Name
          System (DNS) Parameters" registry as follows:<a class="pilcrow" href="#section-5.2-1">¶</a></p>
<span class="break"></span><dl class="dlParallel dlCompact" id="section-5.2-2">
          <dt id="section-5.2-2.1">Registry Name:
</dt>
          <dd id="section-5.2-2.2" style="margin-left: 1.5em">ZONEMD Schemes<a class="pilcrow" href="#section-5.2-2.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.2-2.3">Registration Procedure:
</dt>
          <dd id="section-5.2-2.4" style="margin-left: 1.5em">Specification Required<a class="pilcrow" href="#section-5.2-2.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.2-2.5">Reference:
</dt>
          <dd id="section-5.2-2.6" style="margin-left: 1.5em">[RFC8976]<a class="pilcrow" href="#section-5.2-2.6">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<span id="name-zonemd-scheme-registry"></span><div id="scheme-table">
<table class="center" id="table-1">
          <caption>
<a class="selfRef" href="#table-1">Table 1</a>:
<a class="selfRef" href="#name-zonemd-scheme-registry">ZONEMD Scheme Registry</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Value</th>
              <th class="text-left" colspan="1" rowspan="1">Description</th>
              <th class="text-left" colspan="1" rowspan="1">Mnemonic</th>
              <th class="text-left" colspan="1" rowspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">Reserved</td>
              <td class="text-left" colspan="1" rowspan="1"></td>
              <td class="text-left" colspan="1" rowspan="1">[RFC8976]</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">1</td>
              <td class="text-left" colspan="1" rowspan="1">Simple ZONEMD collation</td>
              <td class="text-left" colspan="1" rowspan="1">SIMPLE</td>
              <td class="text-left" colspan="1" rowspan="1">[RFC8976]</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">2-239</td>
              <td class="text-left" colspan="1" rowspan="1">Unassigned</td>
              <td class="text-left" colspan="1" rowspan="1"></td>
              <td class="text-left" colspan="1" rowspan="1"></td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">240-254</td>
              <td class="text-left" colspan="1" rowspan="1">Private Use</td>
              <td class="text-left" colspan="1" rowspan="1">N/A</td>
              <td class="text-left" colspan="1" rowspan="1">[RFC8976]</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">255</td>
              <td class="text-left" colspan="1" rowspan="1">Reserved</td>
              <td class="text-left" colspan="1" rowspan="1"></td>
              <td class="text-left" colspan="1" rowspan="1">[RFC8976]</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
<div id="hash-alg-registry">
<section id="section-5.3">
        <h3 id="name-zonemd-hash-algorithms">
<a class="section-number selfRef" href="#section-5.3">5.3. </a><a class="section-name selfRef" href="#name-zonemd-hash-algorithms">ZONEMD Hash Algorithms</a>
        </h3>
<p id="section-5.3-1">
          IANA has created a new subregistry in the "Domain Name
          System (DNS) Parameters" registry as follows:<a class="pilcrow" href="#section-5.3-1">¶</a></p>
<span class="break"></span><dl class="dlParallel dlCompact" id="section-5.3-2">
          <dt id="section-5.3-2.1">Registry Name:
</dt>
          <dd id="section-5.3-2.2" style="margin-left: 1.5em">ZONEMD Hash Algorithms<a class="pilcrow" href="#section-5.3-2.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.3-2.3">Registration Procedure:
</dt>
          <dd id="section-5.3-2.4" style="margin-left: 1.5em">Specification Required<a class="pilcrow" href="#section-5.3-2.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.3-2.5">Reference:
</dt>
          <dd id="section-5.3-2.6" style="margin-left: 1.5em">[RFC8976]<a class="pilcrow" href="#section-5.3-2.6">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<span id="name-zonemd-hash-algorithms-regi"></span><div id="digest-type-table">
<table class="center" id="table-2">
          <caption>
<a class="selfRef" href="#table-2">Table 2</a>:
<a class="selfRef" href="#name-zonemd-hash-algorithms-regi">ZONEMD Hash Algorithms Registry</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Value</th>
              <th class="text-left" colspan="1" rowspan="1">Description</th>
              <th class="text-left" colspan="1" rowspan="1">Mnemonic</th>
              <th class="text-left" colspan="1" rowspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">Reserved</td>
              <td class="text-left" colspan="1" rowspan="1"></td>
              <td class="text-left" colspan="1" rowspan="1">[RFC8976]</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">1</td>
              <td class="text-left" colspan="1" rowspan="1">SHA-384</td>
              <td class="text-left" colspan="1" rowspan="1">SHA384</td>
              <td class="text-left" colspan="1" rowspan="1">[RFC8976]</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">2</td>
              <td class="text-left" colspan="1" rowspan="1">SHA-512</td>
              <td class="text-left" colspan="1" rowspan="1">SHA512</td>
              <td class="text-left" colspan="1" rowspan="1">[RFC8976]</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">3-239</td>
              <td class="text-left" colspan="1" rowspan="1">Unassigned</td>
              <td class="text-left" colspan="1" rowspan="1"></td>
              <td class="text-left" colspan="1" rowspan="1"></td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">240-254</td>
              <td class="text-left" colspan="1" rowspan="1">Private Use</td>
              <td class="text-left" colspan="1" rowspan="1">N/A</td>
              <td class="text-left" colspan="1" rowspan="1">[RFC8976]</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">255</td>
              <td class="text-left" colspan="1" rowspan="1">Reserved</td>
              <td class="text-left" colspan="1" rowspan="1"></td>
              <td class="text-left" colspan="1" rowspan="1">[RFC8976]</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
</section>
</div>
<div id="security">
<section id="section-6">
      <h2 id="name-security-considerations">
<a class="section-number selfRef" href="#section-6">6. </a><a class="section-name selfRef" href="#name-security-considerations">Security Considerations</a>
      </h2>
<section id="section-6.1">
        <h3 id="name-using-zone-digest-without-d">
<a class="section-number selfRef" href="#section-6.1">6.1. </a><a class="section-name selfRef" href="#name-using-zone-digest-without-d">Using Zone Digest without DNSSEC</a>
        </h3>
<p id="section-6.1-1">
          Users of ZONEMD with unsigned zones are advised that
          it provides no real protection against attacks.
          While zone digests can be used in the absence of
          DNSSEC, this only provides protection against accidental
          zone corruption such as transmission errors and truncation. When used in this
          manner, it effectively serves only as a checksum.
          For zones not signed with DNSSEC, an attacker
          can make any zone modifications appear to be valid
          by recomputing the Digest field of a ZONEMD RR.<a class="pilcrow" href="#section-6.1-1">¶</a></p>
</section>
<section id="section-6.2">
        <h3 id="name-attacks-against-the-zone-di">
<a class="section-number selfRef" href="#section-6.2">6.2. </a><a class="section-name selfRef" href="#name-attacks-against-the-zone-di">Attacks against the Zone Digest</a>
        </h3>
<p id="section-6.2-1">
          An attacker, whose goal is to modify zone content before it is used
          by the victim, may consider a number of different approaches.<a class="pilcrow" href="#section-6.2-1">¶</a></p>
<p id="section-6.2-2">
          The attacker might perform a downgrade attack to an unsigned
          zone.  This is why <a class="xref" href="#verifying">Section 4</a> talks about
          determining whether or not to expect DNSSEC
          signatures for the zone in step <a class="xref" href="#verify-check-dnssec">1</a>.<a class="pilcrow" href="#section-6.2-2">¶</a></p>
<p id="section-6.2-3">
          The attacker might perform a downgrade attack by removing
          one or more ZONEMD records.  Such a removal is detectable only with DNSSEC
          validation and is why <a class="xref" href="#verifying">Section 4</a>
          talks about checking denial-of-existence
          proofs in step <a class="xref" href="#verify-check-existence">2</a>
          and signature validation in step <a class="xref" href="#verify-dnssec-validate">3</a>.<a class="pilcrow" href="#section-6.2-3">¶</a></p>
<p id="section-6.2-4">
          The attacker might alter the Scheme, Hash Algorithm, or Digest fields
          of the ZONEMD record.  Such modifications are detectable
          only with DNSSEC validation.<a class="pilcrow" href="#section-6.2-4">¶</a></p>
<p id="section-6.2-5">
          As stated in <span>[<a class="xref" href="#BCP201">BCP201</a>]</span>,
          cryptographic algorithms age and become weaker as cryptanalysis
          techniques and computing resources improve with time.  Implementors
          and publishers of zone digests should anticipate the need for
          algorithm agility on long timescales.<a class="pilcrow" href="#section-6.2-5">¶</a></p>
</section>
<section id="section-6.3">
        <h3 id="name-use-of-multiple-zonemd-hash">
<a class="section-number selfRef" href="#section-6.3">6.3. </a><a class="section-name selfRef" href="#name-use-of-multiple-zonemd-hash">Use of Multiple ZONEMD Hash Algorithms</a>
        </h3>
<p id="section-6.3-1">
          When a zone publishes multiple ZONEMD RRs, the overall security is
          only as good as the weakest hash algorithm in use.  For this reason, 
          <a class="xref" href="#rrtype">Section 2</a> recommends only publishing multiple ZONEMD RRs
          when transitioning to a new scheme or hash algorithm.  Once the transition
          is complete, the old scheme or hash algorithm should be removed from
          the ZONEMD RRset.<a class="pilcrow" href="#section-6.3-1">¶</a></p>
</section>
<section id="section-6.4">
        <h3 id="name-dnssec-timing-consideration">
<a class="section-number selfRef" href="#section-6.4">6.4. </a><a class="section-name selfRef" href="#name-dnssec-timing-consideration">DNSSEC Timing Considerations</a>
        </h3>
<p id="section-6.4-1">
          As with all DNSSEC signatures, the ability to perform signature
          validation of a ZONEMD record is limited in time.
          If the DS record(s) or trust anchors for the zone to be verified
          are no longer available, the recipient cannot validate
          the ZONEMD RRset.
          This could happen even if the ZONEMD signature is still current
          (not expired), since the zone's DS record(s)
          may have been withdrawn following a Key Signing Key (KSK) rollover.<a class="pilcrow" href="#section-6.4-1">¶</a></p>
<p id="section-6.4-2">
          For zones where it may be important to validate a ZONEMD
          RRset through its entire signature validity period, the zone
          operator should ensure that KSK rollover timing takes this
          into consideration.<a class="pilcrow" href="#section-6.4-2">¶</a></p>
</section>
<section id="section-6.5">
        <h3 id="name-attacks-utilizing-zonemd-qu">
<a class="section-number selfRef" href="#section-6.5">6.5. </a><a class="section-name selfRef" href="#name-attacks-utilizing-zonemd-qu">Attacks Utilizing ZONEMD Queries</a>
        </h3>
<p id="section-6.5-1">
          Nothing in this specification prevents clients from making,
          and servers from responding to, ZONEMD queries.
          Servers <span class="bcp14">SHOULD NOT</span> calculate zone digests dynamically (for
          each query) as this can be used as a CPU resource exhaustion
          attack.<a class="pilcrow" href="#section-6.5-1">¶</a></p>
<p id="section-6.5-2">
          ZONEMD responses could be used in
          a distributed denial-of-service amplification attack.
          The ZONEMD RR is moderately sized, much like the DS RR.

          A single ZONEMD RR contributes approximately 65 to 95
          octets to a DNS response for digest
          types defined herein.  Other RR types, such as DNS Public Key (DNSKEY), can result in larger
          amplification effects.<a class="pilcrow" href="#section-6.5-2">¶</a></p>
</section>
<section id="section-6.6">
        <h3 id="name-resilience-and-fragility">
<a class="section-number selfRef" href="#section-6.6">6.6. </a><a class="section-name selfRef" href="#name-resilience-and-fragility">Resilience and Fragility</a>
        </h3>
<p id="section-6.6-1">
          ZONEMD is used to detect incomplete or corrupted zone data prior to
          its use, thereby increasing resilience by not using corrupt data,
          but also introduces some denial-of-service fragility by making good
          data in a zone unavailable if some other data is missing or corrupt.
          Publishers and consumers of zones containing ZONEMD records should
          be aware of these trade-offs.  While the intention is to secure the
          zone data, misconfigurations or implementation bugs are generally
          indistinguishable from intentional tampering and could lead to
          service failures when verification is performed automatically.<a class="pilcrow" href="#section-6.6-1">¶</a></p>
<p id="section-6.6-2">
          Zone publishers may want to deploy ZONEMD gradually perhaps
          by utilizing one of the Private Use hash algorithm code points listed
          in <a class="xref" href="#hash-alg-registry">Section 5.3</a>.  Similarly, recipients
          may want to initially configure verification failures only as
          a warning, and later as an error after gaining experience and
          confidence with the feature.<a class="pilcrow" href="#section-6.6-2">¶</a></p>
</section>
</section>
</div>
<div id="performance">
<section id="section-7">
      <h2 id="name-performance-considerations">
<a class="section-number selfRef" href="#section-7">7. </a><a class="section-name selfRef" href="#name-performance-considerations">Performance Considerations</a>
      </h2>
<p id="section-7-1">
        This section is provided to make zone publishers aware of the
        performance requirements and implications of including ZONEMD
        RRs in a zone.<a class="pilcrow" href="#section-7-1">¶</a></p>
<section id="section-7.1">
        <h3 id="name-simple-sha384">
<a class="section-number selfRef" href="#section-7.1">7.1. </a><a class="section-name selfRef" href="#name-simple-sha384">SIMPLE SHA384</a>
        </h3>
<p id="section-7.1-1">
          As mentioned previously, the SIMPLE scheme may be
          impractical for use in zones that are either large or
          highly dynamic.
          Zone publishers should carefully consider the use of ZONEMD
          in such zones since it might cause consumers of zone data
          (e.g., secondary name servers) to expend resources on digest
          calculation.
          For such use cases, it is recommended that ZONEMD
          only be used when digest calculation time is significantly
          less than propagation times and update intervals.<a class="pilcrow" href="#section-7.1-1">¶</a></p>
<p id="section-7.1-2">
          The authors' implementation (<a class="xref" href="#authors-implementation">Appendix B.1</a>) includes an option to record and report CPU
          usage of its operation.  The software was used to generate digests
          for more than 800 Top-Level Domain (TLD) zones available from <span>[<a class="xref" href="#CZDS">CZDS</a>]</span>.  The table below summarizes the
          results for the SIMPLE scheme and SHA384 hash algorithm grouped by
          zone size.  The Rate column is the mean amount of time per RR to
          calculate the digest, running on commodity hardware in early 2020.<a class="pilcrow" href="#section-7.1-2">¶</a></p>
<table class="center" id="table-3">
          <caption><a class="selfRef" href="#table-3">Table 3</a></caption>
<thead>
            <tr>
              <th class="text-right" colspan="1" rowspan="1">Zone Size (RRs)</th>
              <th class="text-right" colspan="1" rowspan="1">Rate (msec/RR)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">10 - 99</td>
              <td class="text-right" colspan="1" rowspan="1">0.00683</td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">100 - 999</td>
              <td class="text-right" colspan="1" rowspan="1">0.00551</td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">1000 - 9999</td>
              <td class="text-right" colspan="1" rowspan="1">0.00505</td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">10000 - 99999</td>
              <td class="text-right" colspan="1" rowspan="1">0.00602</td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">100000 - 999999</td>
              <td class="text-right" colspan="1" rowspan="1">0.00845</td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">1000000 - 9999999</td>
              <td class="text-right" colspan="1" rowspan="1">0.0108</td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">10000000 - 99999999</td>
              <td class="text-right" colspan="1" rowspan="1">0.0148</td>
            </tr>
          </tbody>
        </table>
<p id="section-7.1-4">
          For example, based on the above table, it takes approximately
          0.13 seconds to calculate a SIMPLE SHA384 digest for a zone with
          22,000 RRs, and about 2.5 seconds for a zone with 300,000 RRs.<a class="pilcrow" href="#section-7.1-4">¶</a></p>
<p id="section-7.1-5">
          These benchmarks attempt to emulate a worst-case scenario and take
          into account the time required to canonicalize the zone for
          processing.  Each of the 800+ zones were measured three times and
          then averaged, with a different random sorting of the input data
          prior to each measurement.<a class="pilcrow" href="#section-7.1-5">¶</a></p>
</section>
</section>
</div>
<div id="privacy">
<section id="section-8">
      <h2 id="name-privacy-considerations">
<a class="section-number selfRef" href="#section-8">8. </a><a class="section-name selfRef" href="#name-privacy-considerations">Privacy Considerations</a>
      </h2>
<p id="section-8-1">This specification has no impact on user privacy.<a class="pilcrow" href="#section-8-1">¶</a></p>
</section>
</div>
<section id="section-9">
      <h2 id="name-references">
<a class="section-number selfRef" href="#section-9">9. </a><a class="section-name selfRef" href="#name-references">References</a>
      </h2>
<section id="section-9.1">
        <h3 id="name-normative-references">
<a class="section-number selfRef" href="#section-9.1">9.1. </a><a class="section-name selfRef" href="#name-normative-references">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC1034">[RFC1034]</dt>
        <dd>
<span class="refAuthor">Mockapetris, P.</span>, <span class="refTitle">"Domain names - concepts and facilities"</span>, <span class="seriesInfo">STD 13</span>, <span class="seriesInfo">RFC 1034</span>, <span class="seriesInfo">DOI 10.17487/RFC1034</span>, <time class="refDate" datetime="1987-11">November 1987</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1034">https://www.rfc-editor.org/info/rfc1034</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1035">[RFC1035]</dt>
        <dd>
<span class="refAuthor">Mockapetris, P.</span>, <span class="refTitle">"Domain names - implementation and specification"</span>, <span class="seriesInfo">STD 13</span>, <span class="seriesInfo">RFC 1035</span>, <span class="seriesInfo">DOI 10.17487/RFC1035</span>, <time class="refDate" datetime="1987-11">November 1987</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1035">https://www.rfc-editor.org/info/rfc1035</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time class="refDate" datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4034">[RFC4034]</dt>
        <dd>
<span class="refAuthor">Arends, R.</span><span class="refAuthor">, Austein, R.</span><span class="refAuthor">, Larson, M.</span><span class="refAuthor">, Massey, D.</span><span class="refAuthor">, and S. Rose</span>, <span class="refTitle">"Resource Records for the DNS Security Extensions"</span>, <span class="seriesInfo">RFC 4034</span>, <span class="seriesInfo">DOI 10.17487/RFC4034</span>, <time class="refDate" datetime="2005-03">March 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4034">https://www.rfc-editor.org/info/rfc4034</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6234">[RFC6234]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span><span class="refAuthor"> and T. Hansen</span>, <span class="refTitle">"US Secure Hash Algorithms (SHA and SHA-based HMAC and HKDF)"</span>, <span class="seriesInfo">RFC 6234</span>, <span class="seriesInfo">DOI 10.17487/RFC6234</span>, <time class="refDate" datetime="2011-05">May 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6234">https://www.rfc-editor.org/info/rfc6234</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
      <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time class="refDate" datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-9.2">
        <h3 id="name-informative-references">
<a class="section-number selfRef" href="#section-9.2">9.2. </a><a class="section-name selfRef" href="#name-informative-references">Informative References</a>
        </h3>
<dl class="references">
<dt id="BCP201">[BCP201]</dt>
        <dd>
<div class="refInstance" id="RFC7696">
            <span class="refAuthor">Housley, R.</span>, <span class="refTitle">"Guidelines for Cryptographic Algorithm Agility and Selecting Mandatory-to-Implement Algorithms"</span>, <span class="seriesInfo">BCP 201</span>, <span class="seriesInfo">RFC 7696</span>, <time class="refDate" datetime="2015-11">November 2015</time>. </div>
<span>&lt;<a href="https://www.rfc-editor.org/info/bcp201">https://www.rfc-editor.org/info/bcp201</a>&gt;</span>
</dd>
<dd class="break"></dd>
<dt id="CZDS">[CZDS]</dt>
        <dd>
<span class="refAuthor">Internet Corporation for Assigned Names and Numbers (ICANN)</span>, <span class="refTitle">"Centralized Zone Data Service"</span>, <time class="refDate" datetime="2018-10">October 2018</time>, <span>&lt;<a href="https://czds.icann.org/">https://czds.icann.org/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="DISK-FULL-FAILURE">[DISK-FULL-FAILURE]</dt>
        <dd>
<span class="refAuthor">DENIC</span>, <span class="refTitle">"Background of the Partial Failure of the Name Service for .de Domains"</span>, <time class="refDate" datetime="2010-05">May 2010</time>, <span>&lt;<a href="https://web.archive.org/web/20100618032705/https://www.denic.de/en/denic-in-dialogue/news/2733.html">https://web.archive.org/web/20100618032705/https://www.denic.de/en/denic-in-dialogue/news/2733.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="DNS-TOOLS">[DNS-TOOLS]</dt>
        <dd>
<span class="refTitle">"DNS tools for zone signature (file, pkcs11-hsm) and validation, and zone digest (ZONEMD)"</span>, <span class="refContent">commit 489de21</span>, <time class="refDate" datetime="2020-12">December 2020</time>, <span>&lt;<a href="https://github.com/niclabs/dns-tools">https://github.com/niclabs/dns-tools</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-dprive-xfr-over-tls">[DPRIVE-XFR-OVER-TLS]</dt>
        <dd>
<span class="refAuthor">Toorop, W.</span><span class="refAuthor">, Dickinson, S.</span><span class="refAuthor">, Sahib, S.</span><span class="refAuthor">, Aras, P.</span><span class="refAuthor">, and A. Mankin</span>, <span class="refTitle">"DNS Zone Transfer-over-TLS"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-dprive-xfr-over-tls-05</span>, <time class="refDate" datetime="2021-01-20">20 January 2021</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-dprive-xfr-over-tls-05">https://tools.ietf.org/html/draft-ietf-dprive-xfr-over-tls-05</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="InterNIC">[InterNIC]</dt>
        <dd>
<span class="refAuthor">InterNIC</span>, <span class="refTitle">"Index of ftp://rs.internic.net/"</span>, <time class="refDate" datetime="2018-05">May 2018</time>, <span>&lt;<a href="ftp://ftp.internic.net/domain/">ftp://ftp.internic.net/domain/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="LDNS-ZONE-DIGEST">[LDNS-ZONE-DIGEST]</dt>
        <dd>
<span class="refTitle">"Implementation of Message Digests for DNS Zones using the ldns library"</span>, <span class="refContent">commit 71c0cd1</span>, <time class="refDate" datetime="2021-01">January 2021</time>, <span>&lt;<a href="https://github.com/verisign/ldns-zone-digest">https://github.com/verisign/ldns-zone-digest</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1995">[RFC1995]</dt>
        <dd>
<span class="refAuthor">Ohta, M.</span>, <span class="refTitle">"Incremental Zone Transfer in DNS"</span>, <span class="seriesInfo">RFC 1995</span>, <span class="seriesInfo">DOI 10.17487/RFC1995</span>, <time class="refDate" datetime="1996-08">August 1996</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1995">https://www.rfc-editor.org/info/rfc1995</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2065">[RFC2065]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span><span class="refAuthor"> and C. Kaufman</span>, <span class="refTitle">"Domain Name System Security Extensions"</span>, <span class="seriesInfo">RFC 2065</span>, <span class="seriesInfo">DOI 10.17487/RFC2065</span>, <time class="refDate" datetime="1997-01">January 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2065">https://www.rfc-editor.org/info/rfc2065</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2136">[RFC2136]</dt>
        <dd>
<span class="refAuthor">Vixie, P., Ed.</span><span class="refAuthor">, Thomson, S.</span><span class="refAuthor">, Rekhter, Y.</span><span class="refAuthor">, and J. Bound</span>, <span class="refTitle">"Dynamic Updates in the Domain Name System (DNS UPDATE)"</span>, <span class="seriesInfo">RFC 2136</span>, <span class="seriesInfo">DOI 10.17487/RFC2136</span>, <time class="refDate" datetime="1997-04">April 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2136">https://www.rfc-editor.org/info/rfc2136</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2535">[RFC2535]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span>, <span class="refTitle">"Domain Name System Security Extensions"</span>, <span class="seriesInfo">RFC 2535</span>, <span class="seriesInfo">DOI 10.17487/RFC2535</span>, <time class="refDate" datetime="1999-03">March 1999</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2535">https://www.rfc-editor.org/info/rfc2535</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2931">[RFC2931]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span>, <span class="refTitle">"DNS Request and Transaction Signatures ( SIG(0)s )"</span>, <span class="seriesInfo">RFC 2931</span>, <span class="seriesInfo">DOI 10.17487/RFC2931</span>, <time class="refDate" datetime="2000-09">September 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2931">https://www.rfc-editor.org/info/rfc2931</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3258">[RFC3258]</dt>
        <dd>
<span class="refAuthor">Hardie, T.</span>, <span class="refTitle">"Distributing Authoritative Name Servers via Shared Unicast Addresses"</span>, <span class="seriesInfo">RFC 3258</span>, <span class="seriesInfo">DOI 10.17487/RFC3258</span>, <time class="refDate" datetime="2002-04">April 2002</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3258">https://www.rfc-editor.org/info/rfc3258</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4033">[RFC4033]</dt>
        <dd>
<span class="refAuthor">Arends, R.</span><span class="refAuthor">, Austein, R.</span><span class="refAuthor">, Larson, M.</span><span class="refAuthor">, Massey, D.</span><span class="refAuthor">, and S. Rose</span>, <span class="refTitle">"DNS Security Introduction and Requirements"</span>, <span class="seriesInfo">RFC 4033</span>, <span class="seriesInfo">DOI 10.17487/RFC4033</span>, <time class="refDate" datetime="2005-03">March 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4033">https://www.rfc-editor.org/info/rfc4033</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4035">[RFC4035]</dt>
        <dd>
<span class="refAuthor">Arends, R.</span><span class="refAuthor">, Austein, R.</span><span class="refAuthor">, Larson, M.</span><span class="refAuthor">, Massey, D.</span><span class="refAuthor">, and S. Rose</span>, <span class="refTitle">"Protocol Modifications for the DNS Security Extensions"</span>, <span class="seriesInfo">RFC 4035</span>, <span class="seriesInfo">DOI 10.17487/RFC4035</span>, <time class="refDate" datetime="2005-03">March 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4035">https://www.rfc-editor.org/info/rfc4035</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4880">[RFC4880]</dt>
        <dd>
<span class="refAuthor">Callas, J.</span><span class="refAuthor">, Donnerhacke, L.</span><span class="refAuthor">, Finney, H.</span><span class="refAuthor">, Shaw, D.</span><span class="refAuthor">, and R. Thayer</span>, <span class="refTitle">"OpenPGP Message Format"</span>, <span class="seriesInfo">RFC 4880</span>, <span class="seriesInfo">DOI 10.17487/RFC4880</span>, <time class="refDate" datetime="2007-11">November 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4880">https://www.rfc-editor.org/info/rfc4880</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5155">[RFC5155]</dt>
        <dd>
<span class="refAuthor">Laurie, B.</span><span class="refAuthor">, Sisson, G.</span><span class="refAuthor">, Arends, R.</span><span class="refAuthor">, and D. Blacka</span>, <span class="refTitle">"DNS Security (DNSSEC) Hashed Authenticated Denial of Existence"</span>, <span class="seriesInfo">RFC 5155</span>, <span class="seriesInfo">DOI 10.17487/RFC5155</span>, <time class="refDate" datetime="2008-03">March 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5155">https://www.rfc-editor.org/info/rfc5155</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5936">[RFC5936]</dt>
        <dd>
<span class="refAuthor">Lewis, E.</span><span class="refAuthor"> and A. Hoenes, Ed.</span>, <span class="refTitle">"DNS Zone Transfer Protocol (AXFR)"</span>, <span class="seriesInfo">RFC 5936</span>, <span class="seriesInfo">DOI 10.17487/RFC5936</span>, <time class="refDate" datetime="2010-06">June 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5936">https://www.rfc-editor.org/info/rfc5936</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span><span class="refAuthor">, Leiba, B.</span><span class="refAuthor">, and T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time class="refDate" datetime="2017-06">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8484">[RFC8484]</dt>
        <dd>
<span class="refAuthor">Hoffman, P.</span><span class="refAuthor"> and P. McManus</span>, <span class="refTitle">"DNS Queries over HTTPS (DoH)"</span>, <span class="seriesInfo">RFC 8484</span>, <span class="seriesInfo">DOI 10.17487/RFC8484</span>, <time class="refDate" datetime="2018-10">October 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8484">https://www.rfc-editor.org/info/rfc8484</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8499">[RFC8499]</dt>
        <dd>
<span class="refAuthor">Hoffman, P.</span><span class="refAuthor">, Sullivan, A.</span><span class="refAuthor">, and K. Fujiwara</span>, <span class="refTitle">"DNS Terminology"</span>, <span class="seriesInfo">BCP 219</span>, <span class="seriesInfo">RFC 8499</span>, <span class="seriesInfo">DOI 10.17487/RFC8499</span>, <time class="refDate" datetime="2019-01">January 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8499">https://www.rfc-editor.org/info/rfc8499</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8551">[RFC8551]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span><span class="refAuthor">, Ramsdell, B.</span><span class="refAuthor">, and S. Turner</span>, <span class="refTitle">"Secure/Multipurpose Internet Mail Extensions (S/MIME) Version 4.0 Message Specification"</span>, <span class="seriesInfo">RFC 8551</span>, <span class="seriesInfo">DOI 10.17487/RFC8551</span>, <time class="refDate" datetime="2019-04">April 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8551">https://www.rfc-editor.org/info/rfc8551</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8806">[RFC8806]</dt>
        <dd>
<span class="refAuthor">Kumari, W.</span><span class="refAuthor"> and P. Hoffman</span>, <span class="refTitle">"Running a Root Server Local to a Resolver"</span>, <span class="seriesInfo">RFC 8806</span>, <span class="seriesInfo">DOI 10.17487/RFC8806</span>, <time class="refDate" datetime="2020-06">June 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8806">https://www.rfc-editor.org/info/rfc8806</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8901">[RFC8901]</dt>
        <dd>
<span class="refAuthor">Huque, S.</span><span class="refAuthor">, Aras, P.</span><span class="refAuthor">, Dickinson, J.</span><span class="refAuthor">, Vcelak, J.</span><span class="refAuthor">, and D. Blacka</span>, <span class="refTitle">"Multi-Signer DNSSEC Models"</span>, <span class="seriesInfo">RFC 8901</span>, <span class="seriesInfo">DOI 10.17487/RFC8901</span>, <time class="refDate" datetime="2020-09">September 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8901">https://www.rfc-editor.org/info/rfc8901</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8945">[RFC8945]</dt>
        <dd>
<span class="refAuthor">Dupont, F.</span><span class="refAuthor">, Morris, S.</span><span class="refAuthor">, Vixie, P.</span><span class="refAuthor">, Eastlake 3rd, D.</span><span class="refAuthor">, Gudmundsson, O.</span><span class="refAuthor">, and B. Wellington</span>, <span class="refTitle">"Secret Key Transaction Authentication for DNS (TSIG)"</span>, <span class="seriesInfo">STD 93</span>, <span class="seriesInfo">RFC 8945</span>, <span class="seriesInfo">DOI 10.17487/RFC8945</span>, <time class="refDate" datetime="2020-11">November 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8945">https://www.rfc-editor.org/info/rfc8945</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ROOT-SERVERS">[ROOT-SERVERS]</dt>
        <dd>
<span class="refAuthor">Root Server Operators</span>, <span class="refTitle">"root-servers.org"</span>, <time class="refDate" datetime="2018-07">July 2018</time>, <span>&lt;<a href="https://www.root-servers.org/">https://www.root-servers.org/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RPZ">[RPZ]</dt>
        <dd>
<span class="refAuthor">Wikipedia</span>, <span class="refTitle">"Response policy zone"</span>, <time class="refDate" datetime="2020-05">May 2020</time>, <span>&lt;<a href="https://en.wikipedia.org/w/index.php?title=Response_policy_zone&amp;oldid=960043728">https://en.wikipedia.org/w/index.php?title=Response_policy_zone&amp;oldid=960043728</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ZONE-DIGEST-HACKATHON">[ZONE-DIGEST-HACKATHON]</dt>
        <dd>
<span class="refTitle">"Prototype implementation of ZONEMD for the IETF 102 hackathon"</span>, <span class="refContent">commit 76ad7a7</span>, <time class="refDate" datetime="2019-08">August 2019</time>, <span>&lt;<a href="https://github.com/shane-kerr/ZoneDigestHackathon">https://github.com/shane-kerr/ZoneDigestHackathon</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ZONE-DIGEST-TESTS">[ZONE-DIGEST-TESTS]</dt>
      <dd>
<span class="refAuthor">IETF</span>, <span class="refTitle">"RFC 8976 ZONEMD Test Cases"</span>, <time class="refDate" datetime="2021-01">January 2021</time>, <span>&lt;<a href="https://trac.ietf.org/trac/dnsop/wiki/RFC8976ZONEMDTestCases">https://trac.ietf.org/trac/dnsop/wiki/RFC8976ZONEMDTestCases</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<section id="section-appendix.a">
      <h2 id="name-example-zones-with-digests">
<a class="section-number selfRef" href="#section-appendix.a">Appendix A. </a><a class="section-name selfRef" href="#name-example-zones-with-digests">Example Zones with Digests</a>
      </h2>
<p id="section-appendix.a-1">
        This appendix contains example zones with accurate ZONEMD records.
        These can be used to verify an implementation of the zone digest
        protocol. Additional and more extensive test cases can be found via
        the ZONEMD Tests Wiki (<span>[<a class="xref" href="#ZONE-DIGEST-TESTS">ZONE-DIGEST-TESTS</a>]</span>) maintained by
        the IETF DNSOP Working Group.<a class="pilcrow" href="#section-appendix.a-1">¶</a></p>
<section id="section-a.1">
        <h2 id="name-simple-example-zone">
<a class="section-number selfRef" href="#section-a.1">A.1. </a><a class="section-name selfRef" href="#name-simple-example-zone">Simple EXAMPLE Zone</a>
        </h2>
<p id="section-a.1-1">
          Here, the EXAMPLE zone contains an SOA record, NS and glue records, and a ZONEMD record.<a class="pilcrow" href="#section-a.1-1">¶</a></p>
<div id="section-a.1-2">
<pre class="sourcecode lang-dns-rr">example.      86400  IN  SOA     ns1 admin 2018031900 (
                                 1800 900 604800 86400 )
              86400  IN  NS      ns1
              86400  IN  NS      ns2
              86400  IN  ZONEMD  2018031900 1 1 (
                                 c68090d90a7aed71
                                 6bc459f9340e3d7c
                                 1370d4d24b7e2fc3
                                 a1ddc0b9a87153b9
                                 a9713b3c9ae5cc27
                                 777f98b8e730044c )
ns1           3600   IN  A       203.0.113.63
ns2           3600   IN  AAAA    2001:db8::63
</pre><a class="pilcrow" href="#section-a.1-2">¶</a>
</div>
</section>
<section id="section-a.2">
        <h2 id="name-complex-example-zone">
<a class="section-number selfRef" href="#section-a.2">A.2. </a><a class="section-name selfRef" href="#name-complex-example-zone">Complex EXAMPLE Zone</a>
        </h2>
<p id="section-a.2-1">
          Here, the EXAMPLE zone contains duplicate RRs, an occluded RR, uppercase names, a wildcard, a multi-record RRset, a non-apex ZONEMD RR, and one out-of-zone RR.<a class="pilcrow" href="#section-a.2-1">¶</a></p>
<div id="section-a.2-2">
<pre class="sourcecode lang-dns-rr">example.      86400  IN  SOA     ns1 admin 2018031900 (
                                 1800 900 604800 86400 )
              86400  IN  NS      ns1
              86400  IN  NS      ns2
              86400  IN  ZONEMD  2018031900 1 1 (
                                 a3b69bad980a3504
                                 e1cffcb0fd6397f9
                                 3848071c93151f55
                                 2ae2f6b1711d4bd2
                                 d8b39808226d7b9d
                                 b71e34b72077f8fe )
ns1           3600   IN  A       203.0.113.63
NS2           3600   IN  AAAA    2001:db8::63
occluded.sub  7200   IN  TXT     "I'm occluded but must be digested"
sub           7200   IN  NS      ns1
duplicate     300    IN  TXT     "I must be digested just once"
duplicate     300    IN  TXT     "I must be digested just once"
foo.test.     555    IN  TXT     "out-of-zone data must be excluded"
UPPERCASE     3600   IN  TXT     "canonicalize uppercase owner names"
*             777    IN  PTR     dont-forget-about-wildcards
mail          3600   IN  MX      20 MAIL1
mail          3600   IN  MX      10 Mail2.Example.
sortme        3600   IN  AAAA    2001:db8::5:61
sortme        3600   IN  AAAA    2001:db8::3:62
sortme        3600   IN  AAAA    2001:db8::4:63
sortme        3600   IN  AAAA    2001:db8::1:65
sortme        3600   IN  AAAA    2001:db8::2:64
non-apex      900    IN  ZONEMD  2018031900 1 1 (
                                 616c6c6f77656420
                                 6275742069676e6f
                                 7265642e20616c6c
                                 6f77656420627574
                                 2069676e6f726564
                                 2e20616c6c6f7765 )
</pre><a class="pilcrow" href="#section-a.2-2">¶</a>
</div>
</section>
<section id="section-a.3">
        <h2 id="name-example-zone-with-multiple-">
<a class="section-number selfRef" href="#section-a.3">A.3. </a><a class="section-name selfRef" href="#name-example-zone-with-multiple-">EXAMPLE Zone with Multiple Digests</a>
        </h2>
<p id="section-a.3-1">
          Here, the EXAMPLE zone contains multiple ZONEMD records. It has both
          SHA384 and SHA512 digests using the SIMPLE scheme.  It also includes
          ZONEMD records with Scheme and Hash Algorithm
          values in the private range (240-254).  These additional
          private-range digests are not verifiable.<a class="pilcrow" href="#section-a.3-1">¶</a></p>
<div id="section-a.3-2">
<pre class="sourcecode lang-dns-rr">example.      86400  IN  SOA     ns1 admin 2018031900 (
                                 1800 900 604800 86400 )
example.      86400  IN  NS      ns1.example.
example.      86400  IN  NS      ns2.example.
example.      86400  IN  ZONEMD  2018031900 1 1 (
                                 62e6cf51b02e54b9
                                 b5f967d547ce4313
                                 6792901f9f88e637
                                 493daaf401c92c27
                                 9dd10f0edb1c56f8
                                 080211f8480ee306 )
example.      86400  IN  ZONEMD  2018031900 1 2 (
                                 08cfa1115c7b948c
                                 4163a901270395ea
                                 226a930cd2cbcf2f
                                 a9a5e6eb85f37c8a
                                 4e114d884e66f176
                                 eab121cb02db7d65
                                 2e0cc4827e7a3204
                                 f166b47e5613fd27 )
example.      86400  IN  ZONEMD  2018031900 1 240 (
                                 e2d523f654b9422a
                                 96c5a8f44607bbee )
example.      86400  IN  ZONEMD  2018031900 241 1 (
                                 e1846540e33a9e41
                                 89792d18d5d131f6
                                 05fc283e )
ns1.example.  3600   IN  A       203.0.113.63
ns2.example.  86400  IN  TXT     "This example has multiple digests"
NS2.EXAMPLE.  3600   IN  AAAA    2001:db8::63
</pre><a class="pilcrow" href="#section-a.3-2">¶</a>
</div>
</section>
<section id="section-a.4">
        <h2 id="name-the-uriarpa-zone">
<a class="section-number selfRef" href="#section-a.4">A.4. </a><a class="section-name selfRef" href="#name-the-uriarpa-zone">The URI.ARPA Zone</a>
        </h2>
<p id="section-a.4-1">
          The following sample zone is the URI.ARPA zone retrieved 2021-01-21.  Note this sample zone has
          been re-signed with unpublished keys, so that the added ZONEMD RR also has a signature.<a class="pilcrow" href="#section-a.4-1">¶</a></p>
<div id="section-a.4-2">
<pre class="sourcecode lang-dns-rr">uri.arpa.       3600    IN      SOA     sns.dns.icann.org. (
   noc.dns.icann.org. 2018100702 10800 3600 1209600 3600 )
uri.arpa.       3600    IN      RRSIG   SOA 8 2 3600 (
    20210217232440 20210120232440 37444 uri.arpa.
    GzQw+QzwLDJr13REPGVmpEChjD1D2XlX0ie1DnWHpgaEw1E/dhs3lCN3+B
    mHd4Kx3tffTRgiyq65HxR6feQ5v7VmAifjyXUYB1DZur1eP5q0Ms2ygCB3
    byoeMgCNsFS1oKZ2LdzNBRpy3oace8xQn1SpmHGfyrsgg+WbHKCT1dY= )
uri.arpa.       86400   IN      NS      a.iana-servers.net.
uri.arpa.       86400   IN      NS      b.iana-servers.net.
uri.arpa.       86400   IN      NS      c.iana-servers.net.
uri.arpa.       86400   IN      NS      ns2.lacnic.net.
uri.arpa.       86400   IN      NS      sec3.apnic.net.
uri.arpa.       86400   IN      RRSIG   NS 8 2 86400 (
    20210217232440 20210120232440 37444 uri.arpa.
    M+Iei2lcewWGaMtkPlrhM9FpUAHXFkCHTVpeyrjxjEONeNgKtHZor5e4V4
    qJBOzNqo8go/qJpWlFBm+T5Hn3asaBZVstFIYky38/C8UeRLPKq1hTTHAR
    YUlFrexr5fMtSUAVOgOQPSBfH3xBq/BgSccTdRb9clD+HE7djpqrLS4= )
uri.arpa.       600     IN      MX      10 pechora.icann.org.
uri.arpa.       600     IN      RRSIG   MX 8 2 600 (
    20210217232440 20210120232440 37444 uri.arpa.
    kQAJQivmv6A5hqYBK8h6Z13ESY69gmosXwKI6WE09I8RFetfrxr24ecdnY
    d0lpnDtgNNSoHkYRSOoB+C4+zuJsoyAAzGo9uoWMWj97/2xeGhf3PTC9me
    Q9Ohi6hul9By7OR76XYmGhdWX8PBi60RUmZ1guslFBfQ8izwPqzuphs= )
uri.arpa.       3600    IN      DNSKEY  256 3 8 (
    AwEAAbMxuFuLeVDuOwIMzYOTD/bTREjLflo7wOi6ieIJhqltEzgjNzmWJf
    9kGwwDmzxU7kbthMEhBNBZNn84zmcyRSCMzuStWveL7xmqqUlE3swL8kLO
    vdZvc75XnmpHrk3ndTyEb6eZM7slh2C63Oh6K8VR5VkiZAkEGg0uZIT3Nj
    sF )
uri.arpa.       3600    IN      DNSKEY  257 3 8 (
    AwEAAdkTaWkZtZuRh7/OobBUFxM+ytTst+bCu0r9w+rEwXD7GbDs0pIMhM
    enrZzoAvmv1fQxw2MGs6Ri6yPKfNULcFOSt9l8i6BVBLI+SKTY6XXeDUQp
    SEmSaxohHeRPMQFzpysfjxINp/L2rGtZ7yPmxY/XRiFPSO0myqwGJa9r06
    Zw9CHM5UDHKWV/E+zxPFq/I7CfPbrrzbUotBX7Z6Vh3Sarllbe8cGUB2UF
    NaTRgwB0TwDBPRD5ER3w2Dzbry9NhbElTr7vVfhaGWeOGuqAUXwlXEg6Cr
    NkmJXJ2F1Rzr9WHUzhp7uWxhAbmJREGfi2dEyPAbUAyCjBqhFaqglknvc= )
uri.arpa.       3600    IN      DNSKEY  257 3 8 (
    AwEAAenQaBoFmDmvRT+/H5oNbm0Tr5FmNRNDEun0Jpj/ELkzeUrTWhNpQm
    ZeIMC8I0kZ185tEvOnRvn8OvV39B17QIdrvvKGIh2HlgeDRCLolhaojfn2
    QM0DStjF/WWHpxJOmE6CIuvhqYEU37yoJscGAPpPVPzNvnL1HhYTaao1VR
    YWQ/maMrJ+bfHg+YX1N6M/8MnRjIKBif1FWjbCKvsn6dnuGGL9oCWYUFJ3
    DwofXuhgPyZMkzPc88YkJj5EMvbMH4wtelbCwC+ivx732l0w/rXJn0ciQS
    OgoeVvDio8dIJmWQITWQAuP+q/ZHFEFHPlrP3gvQh5mcVS48eLX71Bq7c= )
uri.arpa.       3600    IN      RRSIG   DNSKEY 8 2 3600 (
    20210217232440 20210120232440 12670 uri.arpa.
    DBE2gkKAoxJCfz47KKxzoImN/0AKArhIVHE7TyTwy0DdRPo44V5R+vL6th
    UxlQ1CJi2Rw0jwAXymx5Y3Q873pOEllH+4bJoIT4dmoBmPXfYWW7Clvw9U
    PKHRP0igKHmCVwIeBYDTU3gfLcMTbR4nEWPDN0GxlL1Mf7ITaC2Ioabo79
    Ip3M/MR8I3Vx/xZ4ZKKPHtLn3xUuJluPNanqJrED2gTslL2xWZ1tqjsAjJ
    v7JnJo2HJ8XVRB5zBto0IaJ2oBlqcjdcQ/0VlyoM8uOy1pDwHQ2BJl7322
    gNMHBP9HSiUPIOaIDNUCwW8eUcW6DIUk+s9u3GN1uTqwWzsYB/rA== )
uri.arpa.       3600    IN      RRSIG   DNSKEY 8 2 3600 (
    20210217232440 20210120232440 30577 uri.arpa.
    Kx6HwP4UlkGc1UZ7SERXtQjPajOF4iUvkwDj7MEG1xbQFB1KoJiEb/eiW0
    qmSWdIhMDv8myhgauejRLyJxwxz8HDRV4xOeHWnRGfWBk4XGYwkejVzOHz
    oIArVdUVRbr2JKigcTOoyFN+uu52cNB7hRYu7dH5y1hlc6UbOnzRpMtGxc
    gVyKQ+/ARbIqGG3pegdEOvV49wTPWEiyY65P2urqhvnRg5ok/jzwAdMx4X
    Gshiib7Ojq0sRVl2ZIzj4rFgY/qsSO8SEXEhMo2VuSkoJNiofVzYoqpxEe
    GnANkIT7Tx2xJL1BWyJxyc7E8Wr2QSgCcc+rYL6IkHDtJGHy7TaQ== )
uri.arpa.       3600    IN      ZONEMD  2018100702 1 1 (
    0dbc3c4dbfd75777c12ca19c337854b1577799901307c482e9d91d5d15
    cd934d16319d98e30c4201cf25a1d5a0254960 )
uri.arpa.       3600    IN      RRSIG   ZONEMD 8 2 3600 (
    20210217232440 20210120232440 37444 uri.arpa.
    QDo4XZcL3HMyn8aAHyCUsu/Tqj4Gkth8xY1EqByOb8XOTwVtA4ZNQORE1s
    iqNqjtJUbeJPtJSbLNqCL7rCq0CzNNnBscv6IIf4gnqJZjlGtHO30ohXtK
    vEc4z7SU3IASsi6bB3nLmEAyERdYSeU6UBfx8vatQDIRhkgEnnWUTh4= )
uri.arpa.       3600    IN      NSEC    ftp.uri.arpa. (
    NS SOA MX RRSIG NSEC DNSKEY ZONEMD )
uri.arpa.       3600    IN      RRSIG   NSEC 8 2 3600 (
    20210217232440 20210120232440 37444 uri.arpa.
    dU/rXLM/naWd1+1PiWiYVaNJyCkiuyZJSccr91pJI673T8r3685B4ODMYF
    afZRboVgwnl3ZrXddY6xOhZL3n9V9nxXZwjLJ2HJUojFoKcXTlpnUyYUYv
    VQ2kj4GHAo6fcGCEp5QFJ2KbCpeJoS+PhKGRRx28icCiNT4/uXQvO2E= )
ftp.uri.arpa.   604800  IN      NAPTR   0 0 "" "" (
    "!^ftp://([^:/?#]*).*$!\\1!i" . )
ftp.uri.arpa.   604800  IN      RRSIG   NAPTR 8 3 604800 (
    20210217232440 20210120232440 37444 uri.arpa.
    EygekDgl+Lyyq4NMSEpPyOrOywYf9Y3FAB4v1DT44J3R5QGidaH8l7ZFjH
    oYFI8sY64iYOCV4sBnX/dh6C1L5NgpY+8l5065Xu3vvjyzbtuJ2k6YYwJr
    rCbvl5DDn53zAhhO2hL9uLgyLraZGi9i7TFGd0sm3zNyUF/EVL0CcxU= )
ftp.uri.arpa.   3600    IN      NSEC    http.uri.arpa. (
    NAPTR RRSIG NSEC )
ftp.uri.arpa.   3600    IN      RRSIG   NSEC 8 3 3600 (
    20210217232440 20210120232440 37444 uri.arpa.
    pbP4KxevPXCu/bDqcvXiuBppXyFEmtHyiy0eAN5gS7mi6mp9Z9bWFjx/Ld
    H9+6oFGYa5vGmJ5itu/4EDMe8iQeZbI8yrpM4TquB7RR/MGfBnTd8S+sjy
    QtlRYG7yqEu77Vd78Fme22BKPJ+MVqjS0JHMUE/YUGomPkAjLJJwwGw= )
http.uri.arpa.  604800  IN      NAPTR   0 0 "" "" (
    "!^http://([^:/?#]*).*$!\\1!i" . )
http.uri.arpa.  604800  IN      RRSIG   NAPTR 8 3 604800 (
    20210217232440 20210120232440 37444 uri.arpa.
    eTqbWvt1GvTeXozuvm4ebaAfkXFQKrtdu0cEiExto80sHIiCbO0WL8UDa/
    J3cDivtQca7LgUbOb6c17NESsrsVkc6zNPx5RK2tG7ZQYmhYmtqtfg1oU5
    BRdHZ5TyqIXcHlw9Blo2pir1Y9IQgshhD7UOGkbkEmvB1Lrd0aHhAAg= )
http.uri.arpa.  3600    IN      NSEC    mailto.uri.arpa. (
    NAPTR RRSIG NSEC )
http.uri.arpa.  3600    IN      RRSIG   NSEC 8 3 3600 (
    20210217232440 20210120232440 37444 uri.arpa.
    R9rlNzw1CVz2N08q6DhULzcsuUm0UKcPaGAWEU40tr81jEDHsFHNM+khCd
    OI8nDstzA42aee4rwCEgijxJpRCcY9hrO1Ysrrr2fdqNz60JikMdarvU5O
    0p0VXeaaJDfJQT44+o+YXaBwI7Qod3FTMx7aRib8i7istvPm1Rr7ixA= )
mailto.uri.arpa.        604800  IN      NAPTR   0 0 "" "" (
    "!^mailto:(.*)@(.*)$!\\2!i" . )
mailto.uri.arpa.        604800  IN      RRSIG   NAPTR 8 3 604800 (
    20210217232440 20210120232440 37444 uri.arpa.
    Ch2zTG2F1plEvQPyIH4Yd80XXLjXOPvMbiqDjpJBcnCJsV8QF7kr0wTLnU
    T3dB+asQudOjPyzaHGwFlMzmrrAsszN4XAMJ6htDtFJdsgTMP/NkHhYRSm
    Vv6rLeAhd+mVfObY12M//b/GGVTjeUI/gJaLW0fLVZxr1Fp5U5CRjyw= )
mailto.uri.arpa.        3600    IN      NSEC    urn.uri.arpa. (
    NAPTR RRSIG NSEC )
mailto.uri.arpa.        3600    IN      RRSIG   NSEC 8 3 3600 (
    20210217232440 20210120232440 37444 uri.arpa.
    fQUbSIE6E7JDi2rosah4SpCOTrKufeszFyj5YEavbQuYlQ5cNFvtm8KuE2
    xXMRgRI4RGvM2leVqcoDw5hS3m2pOJLxH8l2WE72YjYvWhvnwc5Rofe/8y
    B/vaSK9WCnqN8y2q6Vmy73AGP0fuiwmuBra7LlkOiqmyx3amSFizwms= )
urn.uri.arpa.   604800  IN      NAPTR   0 0 "" "" (
    "/urn:([^:]+)/\\1/i" . )
urn.uri.arpa.   604800  IN      RRSIG   NAPTR 8 3 604800 (
    20210217232440 20210120232440 37444 uri.arpa.
    CVt2Tgz0e5ZmaSXqRfNys/8OtVCk9nfP0zhezhN8Bo6MDt6yyKZ2kEEWJP
    jkN7PCYHjO8fGjnUn0AHZI2qBNv7PKHcpR42VY03q927q85a65weOO1YE0
    vPYMzACpua9TOtfNnynM2Ws0uN9URxUyvYkXBdqOC81N3sx1dVELcwc= )
urn.uri.arpa.   3600    IN      NSEC    uri.arpa. NAPTR RRSIG NSEC
urn.uri.arpa.   3600    IN      RRSIG   NSEC 8 3 3600 (
    20210217232440 20210120232440 37444 uri.arpa.
    JuKkMiC3/j9iM3V8/izcouXWAVGnSZjkOgEgFPhutMqoylQNRcSkbEZQzF
    K8B/PIVdzZF0Y5xkO6zaKQjOzz6OkSaNPIo1a7Vyyl3wDY/uLCRRAHRJfp
    knuY7O+AUNXvVVIEYJqZggd4kl/Rjh1GTzPYZTRrVi5eQidI1LqCOeg= )
</pre><a class="pilcrow" href="#section-a.4-2">¶</a>
</div>
</section>
<section id="section-a.5">
        <h2 id="name-the-root-serversnet-zone">
<a class="section-number selfRef" href="#section-a.5">A.5. </a><a class="section-name selfRef" href="#name-the-root-serversnet-zone">The ROOT-SERVERS.NET Zone</a>
        </h2>
<p id="section-a.5-1">
          The following sample zone is the ROOT-SERVERS.NET zone retrieved 2018-10-21.<a class="pilcrow" href="#section-a.5-1">¶</a></p>
<div id="section-a.5-2">
<pre class="sourcecode lang-dns-rr">root-servers.net.     3600000 IN  SOA     a.root-servers.net. (
    nstld.verisign-grs.com. 2018091100 14400 7200 1209600 3600000 )
root-servers.net.     3600000 IN  NS      a.root-servers.net.
root-servers.net.     3600000 IN  NS      b.root-servers.net.
root-servers.net.     3600000 IN  NS      c.root-servers.net.
root-servers.net.     3600000 IN  NS      d.root-servers.net.
root-servers.net.     3600000 IN  NS      e.root-servers.net.
root-servers.net.     3600000 IN  NS      f.root-servers.net.
root-servers.net.     3600000 IN  NS      g.root-servers.net.
root-servers.net.     3600000 IN  NS      h.root-servers.net.
root-servers.net.     3600000 IN  NS      i.root-servers.net.
root-servers.net.     3600000 IN  NS      j.root-servers.net.
root-servers.net.     3600000 IN  NS      k.root-servers.net.
root-servers.net.     3600000 IN  NS      l.root-servers.net.
root-servers.net.     3600000 IN  NS      m.root-servers.net.
a.root-servers.net.   3600000 IN  AAAA    2001:503:ba3e::2:30
a.root-servers.net.   3600000 IN  A       198.41.0.4
b.root-servers.net.   3600000 IN  MX      20 mail.isi.edu.
b.root-servers.net.   3600000 IN  AAAA    2001:500:200::b
b.root-servers.net.   3600000 IN  A       199.9.14.201
c.root-servers.net.   3600000 IN  AAAA    2001:500:2::c
c.root-servers.net.   3600000 IN  A       192.33.4.12
d.root-servers.net.   3600000 IN  AAAA    2001:500:2d::d
d.root-servers.net.   3600000 IN  A       199.7.91.13
e.root-servers.net.   3600000 IN  AAAA    2001:500:a8::e
e.root-servers.net.   3600000 IN  A       192.203.230.10
f.root-servers.net.   3600000 IN  AAAA    2001:500:2f::f
f.root-servers.net.   3600000 IN  A       192.5.5.241
g.root-servers.net.   3600000 IN  AAAA    2001:500:12::d0d
g.root-servers.net.   3600000 IN  A       192.112.36.4
h.root-servers.net.   3600000 IN  AAAA    2001:500:1::53
h.root-servers.net.   3600000 IN  A       198.97.190.53
i.root-servers.net.   3600000 IN  MX      10 mx.i.root-servers.org.
i.root-servers.net.   3600000 IN  AAAA    2001:7fe::53
i.root-servers.net.   3600000 IN  A       192.36.148.17
j.root-servers.net.   3600000 IN  AAAA    2001:503:c27::2:30
j.root-servers.net.   3600000 IN  A       192.58.128.30
k.root-servers.net.   3600000 IN  AAAA    2001:7fd::1
k.root-servers.net.   3600000 IN  A       193.0.14.129
l.root-servers.net.   3600000 IN  AAAA    2001:500:9f::42
l.root-servers.net.   3600000 IN  A       199.7.83.42
m.root-servers.net.   3600000 IN  AAAA    2001:dc3::35
m.root-servers.net.   3600000 IN  A       202.12.27.33
root-servers.net.     3600000 IN  SOA     a.root-servers.net. (
    nstld.verisign-grs.com. 2018091100 14400 7200 1209600 3600000 )
root-servers.net.     3600000 IN  ZONEMD  2018091100 1 1 (
    f1ca0ccd91bd5573d9f431c00ee0101b2545c97602be0a97
    8a3b11dbfc1c776d5b3e86ae3d973d6b5349ba7f04340f79 )
</pre><a class="pilcrow" href="#section-a.5-2">¶</a>
</div>
</section>
</section>
<div id="Implementation">
<section id="section-appendix.b">
      <h2 id="name-implementation-status">
<a class="section-number selfRef" href="#section-appendix.b">Appendix B. </a><a class="section-name selfRef" href="#name-implementation-status">Implementation Status</a>
      </h2>
<p id="section-appendix.b-1">
        This section records the status of known implementations of the
        protocol defined by this specification at the time of publication, and is inspired by the
        concepts described in RFC 7942.<a class="pilcrow" href="#section-appendix.b-1">¶</a></p>
<p id="section-appendix.b-2">
        Please note that the listing of any
        individual implementation here does not imply endorsement by the
        IETF.  Furthermore, no effort has been spent to verify the
        information presented here that was supplied by IETF contributors.
        This is not intended as, and must not be construed to be, a
        catalog of available implementations or their features.  Readers
        are advised to note that other implementations may exist.<a class="pilcrow" href="#section-appendix.b-2">¶</a></p>
<div id="authors-implementation">
<section id="section-b.1">
        <h2 id="name-authors-implementation">
<a class="section-number selfRef" href="#section-b.1">B.1. </a><a class="section-name selfRef" href="#name-authors-implementation">Authors' Implementation</a>
        </h2>
<p id="section-b.1-1">
          The authors have an open-source implementation in C, using the ldns
          library (<span>[<a class="xref" href="#LDNS-ZONE-DIGEST">LDNS-ZONE-DIGEST</a>]</span>).  This
          implementation is able to perform the following functions:<a class="pilcrow" href="#section-b.1-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-b.1-2.1">Read an input zone and output a zone with the ZONEMD placeholder.<a class="pilcrow" href="#section-b.1-2.1">¶</a>
</li>
          <li class="normal" id="section-b.1-2.2">Compute the zone digest over the signed zone and update the ZONEMD
          record.<a class="pilcrow" href="#section-b.1-2.2">¶</a>
</li>
          <li class="normal" id="section-b.1-2.3">Recompute DNSSEC signatures over the ZONEMD record.<a class="pilcrow" href="#section-b.1-2.3">¶</a>
</li>
          <li class="normal" id="section-b.1-2.4">Verify the zone digest from an input zone.<a class="pilcrow" href="#section-b.1-2.4">¶</a>
</li>
        </ul>
<p id="section-b.1-3">
          This implementation does not:<a class="pilcrow" href="#section-b.1-3">¶</a></p>
<ul class="normal">
<li class="normal" id="section-b.1-4.1">Perform DNSSEC validation of the ZONEMD record during verification.<a class="pilcrow" href="#section-b.1-4.1">¶</a>
</li>
        </ul>
</section>
</div>
<section id="section-b.2">
        <h2 id="name-shane-kerrs-implementation">
<a class="section-number selfRef" href="#section-b.2">B.2. </a><a class="section-name selfRef" href="#name-shane-kerrs-implementation">Shane Kerr's Implementation</a>
        </h2>
<p id="section-b.2-1"><span class="contact-name">Shane Kerr</span> wrote an implementation of this
        specification during the IETF 102 hackathon (<span>[<a class="xref" href="#ZONE-DIGEST-HACKATHON">ZONE-DIGEST-HACKATHON</a>]</span>).  This implementation
        is in Python and is able to perform the following functions:<a class="pilcrow" href="#section-b.2-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-b.2-2.1">Read an input zone and output a zone with ZONEMD record.<a class="pilcrow" href="#section-b.2-2.1">¶</a>
</li>
          <li class="normal" id="section-b.2-2.2">Verify the zone digest from an input zone.<a class="pilcrow" href="#section-b.2-2.2">¶</a>
</li>
          <li class="normal" id="section-b.2-2.3">Output the ZONEMD record in its defined presentation format.<a class="pilcrow" href="#section-b.2-2.3">¶</a>
</li>
        </ul>
<p id="section-b.2-3">
          This implementation does not:<a class="pilcrow" href="#section-b.2-3">¶</a></p>
<ul class="normal">
<li class="normal" id="section-b.2-4.1">Recompute DNSSEC signatures over the ZONEMD record.<a class="pilcrow" href="#section-b.2-4.1">¶</a>
</li>
          <li class="normal" id="section-b.2-4.2">Perform DNSSEC validation of the ZONEMD record.<a class="pilcrow" href="#section-b.2-4.2">¶</a>
</li>
        </ul>
</section>
<section id="section-b.3">
        <h2 id="name-nic-chile-labs-implementati">
<a class="section-number selfRef" href="#section-b.3">B.3. </a><a class="section-name selfRef" href="#name-nic-chile-labs-implementati">NIC Chile Lab's Implementation</a>
        </h2>
<p id="section-b.3-1">
          NIC Chile Labs wrote an implementation of this specification
          as part of "dns-tools" suite (<span>[<a class="xref" href="#DNS-TOOLS">DNS-TOOLS</a>]</span>),
          which besides digesting, can also sign and verify zones. This
          implementation is in Go and is able to perform the following
          functions:<a class="pilcrow" href="#section-b.3-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-b.3-2.1">Compute zone digest over signed zone and update the ZONEMD record.<a class="pilcrow" href="#section-b.3-2.1">¶</a>
</li>
          <li class="normal" id="section-b.3-2.2">Verify the zone digest from an input zone.<a class="pilcrow" href="#section-b.3-2.2">¶</a>
</li>
          <li class="normal" id="section-b.3-2.3">Perform DNSSEC validation of the ZONEMD record during verification.<a class="pilcrow" href="#section-b.3-2.3">¶</a>
</li>
          <li class="normal" id="section-b.3-2.4">Recompute DNSSEC signatures over the ZONEMD record.<a class="pilcrow" href="#section-b.3-2.4">¶</a>
</li>
        </ul>
</section>
</section>
</div>
<div id="acknowledgments">
<section id="section-appendix.c">
      <h2 id="name-acknowledgments">
<a class="section-name selfRef" href="#name-acknowledgments">Acknowledgments</a>
      </h2>
<p id="section-appendix.c-1">

        The authors wish to thank <span class="contact-name">David Blacka</span>, <span class="contact-name">Scott Hollenbeck</span>, and <span class="contact-name">Rick Wilhelm</span>
        for providing feedback on early drafts of this document.
        Additionally, they thank <span class="contact-name">Joe Abley</span>, <span class="contact-name">Mark Andrews</span>, <span class="contact-name">Ralph Dolmans</span>,
        <span class="contact-name">Donald Eastlake 3rd</span>, <span class="contact-name">Richard         Gibson</span>, <span class="contact-name">Olafur Gudmundsson</span>, <span class="contact-name">Bob Harold</span>, <span class="contact-name">Paul Hoffman</span>, <span class="contact-name">Evan Hunt</span>, <span class="contact-name">Shumon Huque</span>, <span class="contact-name">Tatuya Jinmei</span>, <span class="contact-name">Mike St. Johns</span>,
        <span class="contact-name">Burt Kaliski</span>, <span class="contact-name">Shane Kerr</span>,
        <span class="contact-name">Matt Larson</span>, <span class="contact-name">Barry Leiba</span>,
        <span class="contact-name">John Levine</span>, <span class="contact-name">Ed Lewis</span>,
        <span class="contact-name">Matt Pounsett</span>, <span class="contact-name">Mukund         Sivaraman</span>, <span class="contact-name">Petr Spacek</span>, <span class="contact-name">Ondrej Sury</span>, <span class="contact-name">Willem Toorop</span>,
        <span class="contact-name">Florian Weimer</span>, <span class="contact-name">Tim         Wicinski</span>, <span class="contact-name">Wouter Wijngaards</span>, <span class="contact-name">Paul Wouters</span>, and other members of the DNSOP Working
        Group for their input.<a class="pilcrow" href="#section-appendix.c-1">¶</a></p>
<p id="section-appendix.c-2">The authors would again like to thank <span class="contact-name">Tim Wicinski</span>, who served as the Document
Shepherd for this document.<a class="pilcrow" href="#section-appendix.c-2">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="section-appendix.d">
      <h2 id="name-authors-addresses">
<a class="section-name selfRef" href="#name-authors-addresses">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Duane Wessels</span></div>
<div class="left" dir="auto"><span class="org">Verisign</span></div>
<div class="left" dir="auto"><span class="street-address">12061 Bluemont Way</span></div>
<div class="left" dir="auto">
<span class="locality">Reston</span>, <span class="region">VA</span> <span class="postal-code">20190</span>
</div>
<div class="left" dir="auto"><span class="country-name">United States of America</span></div>
<div class="tel">
<span>Phone:</span>
<a class="tel" href="tel:+1%20703%20948-3200">+1 703 948-3200</a>
</div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:dwessels@verisign.com">dwessels@verisign.com</a>
</div>
<div class="url">
<span>URI:</span>
<a class="url" href="https://verisign.com">https://verisign.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Piet Barber</span></div>
<div class="left" dir="auto"><span class="org">Verisign</span></div>
<div class="left" dir="auto"><span class="street-address">12061 Bluemont Way</span></div>
<div class="left" dir="auto">
<span class="locality">Reston</span>, <span class="region">VA</span> <span class="postal-code">20190</span>
</div>
<div class="left" dir="auto"><span class="country-name">United States of America</span></div>
<div class="tel">
<span>Phone:</span>
<a class="tel" href="tel:+1%20703%20948-3200">+1 703 948-3200</a>
</div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:pbarber@verisign.com">pbarber@verisign.com</a>
</div>
<div class="url">
<span>URI:</span>
<a class="url" href="https://verisign.com">https://verisign.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Matt Weinberg</span></div>
<div class="left" dir="auto"><span class="org">Amazon</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:matweinb@amazon.com">matweinb@amazon.com</a>
</div>
<div class="url">
<span>URI:</span>
<a class="url" href="https://amazon.com">https://amazon.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Warren Kumari</span></div>
<div class="left" dir="auto"><span class="org">Google</span></div>
<div class="left" dir="auto"><span class="street-address">1600 Amphitheatre Parkway</span></div>
<div class="left" dir="auto">
<span class="locality">Mountain View</span>, <span class="region">CA</span> <span class="postal-code">94043</span>
</div>
<div class="left" dir="auto"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:warren@kumari.net">warren@kumari.net</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Wes Hardaker</span></div>
<div class="left" dir="auto"><span class="org">USC/ISI</span></div>
<div class="left" dir="auto"><span class="street-address">P.O. Box 382</span></div>
<div class="left" dir="auto">
<span class="locality">Davis</span>, <span class="region">CA</span> <span class="postal-code">95617</span>
</div>
<div class="left" dir="auto"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:ietf@hardakers.net">ietf@hardakers.net</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>


</body></html>