<!DOCTYPE html>
<html class="RFC" lang="en"><head>
<meta charset="utf-8"/>
<meta content="Common,Latin" name="scripts"/>
<meta content="initial-scale=1.0" name="viewport"/>
<title>RFC 8805: A Format for Self-Published IP Geolocation Feeds</title>
<meta content="Erik Kline" name="author"/>
<meta content="Krzysztof Duleba" name="author"/>
<meta content="Zoltan Szamonek" name="author"/>
<meta content="Stefan Moser" name="author"/>
<meta content="Warren Kumari" name="author"/>
<meta content='
       This document records a format whereby a network operator can publish
      a mapping of IP address prefixes to simplified geolocation information,
      colloquially termed a "geolocation feed".  Interested parties can poll
      and parse these feeds to update or merge with other geolocation data
      sources and procedures.  This format intentionally only allows specifying
      coarse-level location. 
       Some technical organizations operating networks that move from one
      conference location to the next have already experimentally published
      small geolocation feeds. 
       This document describes a currently deployed format. At
      least one consumer (Google) has incorporated these feeds into a
      geolocation data pipeline, and a significant number of ISPs are
      using it to inform them where their prefixes should be geolocated. 
    ' name="description"/>
<meta content="xml2rfc 2.47.0" name="generator"/>
<meta content="8805" name="rfc.number"/>
<link href="rfc8805.xml" rel="alternate" type="application/rfc+xml"/>
<link href="#copyright" rel="license"/>
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css"/>
<link href="https://dx.doi.org/10.17487/rfc8805" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <link href="https://datatracker.ietf.org/doc/draft-google-self-published-geofeeds-09" rel="prev"/>
  </head>
<body>
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 8805</td>
<td class="center">Self-Published IP Geofeeds</td>
<td class="right">August 2020</td>
</tr></thead>
<tfoot><tr>
<td class="left">Kline, et al.</td>
<td class="center">Informational</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div class="document-information" id="external-metadata"></div>
<div class="document-information" id="internal-metadata">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Independent Submission</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a class="eref" href="https://www.rfc-editor.org/rfc/rfc8805">8805</a></dd>
<dt class="label-category">Category:</dt>
<dd class="category">Informational</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time class="published" datetime="2020-08">August 2020</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">E. Kline</div>
<div class="org">Loon LLC</div>
</div>
<div class="author">
      <div class="author-name">K. Duleba</div>
<div class="org">Google</div>
</div>
<div class="author">
      <div class="author-name">Z. Szamonek</div>
<div class="org">Google Switzerland GmbH</div>
</div>
<div class="author">
      <div class="author-name">S. Moser</div>
<div class="org">Google Switzerland GmbH</div>
</div>
<div class="author">
      <div class="author-name">W. Kumari</div>
<div class="org">Google</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 8805</h1>
<h1 id="title">A Format for Self-Published IP Geolocation Feeds</h1>
<section id="section-abstract">
      <h2 id="abstract"><a class="selfRef" href="#abstract">Abstract</a></h2>
<p id="section-abstract-1">This document records a format whereby a network operator can publish
      a mapping of IP address prefixes to simplified geolocation information,
      colloquially termed a "geolocation feed".  Interested parties can poll
      and parse these feeds to update or merge with other geolocation data
      sources and procedures.  This format intentionally only allows specifying
      coarse-level location.<a class="pilcrow" href="#section-abstract-1">¶</a></p>
<p id="section-abstract-2">Some technical organizations operating networks that move from one
      conference location to the next have already experimentally published
      small geolocation feeds.<a class="pilcrow" href="#section-abstract-2">¶</a></p>
<p id="section-abstract-3">This document describes a currently deployed format. At
      least one consumer (Google) has incorporated these feeds into a
      geolocation data pipeline, and a significant number of ISPs are
      using it to inform them where their prefixes should be geolocated.<a class="pilcrow" href="#section-abstract-3">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a class="section-name selfRef" href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This document is not an Internet Standards Track specification; it is
            published for informational purposes.<a class="pilcrow" href="#section-boilerplate.1-1">¶</a></p>
<p id="section-boilerplate.1-2">
            This is a contribution to the RFC Series, independently of any
            other RFC stream.  The RFC Editor has chosen to publish this
            document at its discretion and makes no statement about its value
            for implementation or deployment.  Documents approved for
            publication by the RFC Editor are not candidates for any level of
            Internet Standard; see Section 2 of RFC 7841.<a class="pilcrow" href="#section-boilerplate.1-2">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc8805">https://www.rfc-editor.org/info/rfc8805</a></span>.<a class="pilcrow" href="#section-boilerplate.1-3">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a class="section-name selfRef" href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2020 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a class="pilcrow" href="#section-boilerplate.2-1">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document.<a class="pilcrow" href="#section-boilerplate.2-2">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a class="toplink" href="#" onclick="scroll(0,0)">▲</a><h2 id="name-table-of-contents">
<a class="section-name selfRef" href="#name-table-of-contents">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a class="xref" href="#section-1">1</a>.  <a class="xref" href="#name-introduction">Introduction</a><a class="pilcrow" href="#section-toc.1-1.1.1">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.1.2.1">
                <p class="keepWithNext" id="section-toc.1-1.1.2.1.1"><a class="xref" href="#section-1.1">1.1</a>.  <a class="xref" href="#name-motivation">Motivation</a><a class="pilcrow" href="#section-toc.1-1.1.2.1.1">¶</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.1.2.2">
                <p class="keepWithNext" id="section-toc.1-1.1.2.2.1"><a class="xref" href="#section-1.2">1.2</a>.  <a class="xref" href="#name-requirements-notation">Requirements Notation</a><a class="pilcrow" href="#section-toc.1-1.1.2.2.1">¶</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.1.2.3">
                <p class="keepWithNext" id="section-toc.1-1.1.2.3.1"><a class="xref" href="#section-1.3">1.3</a>.  <a class="xref" href="#name-assumptions-about-publicati">Assumptions about Publication</a><a class="pilcrow" href="#section-toc.1-1.1.2.3.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a class="xref" href="#section-2">2</a>.  <a class="xref" href="#name-self-published-ip-geolocati">Self-Published IP Geolocation Feeds</a><a class="pilcrow" href="#section-toc.1-1.2.1">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a class="xref" href="#section-2.1">2.1</a>.  <a class="xref" href="#name-specification">Specification</a><a class="pilcrow" href="#section-toc.1-1.2.2.1.1">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.2.2.1.2.1">
                    <p id="section-toc.1-1.2.2.1.2.1.1"><a class="xref" href="#section-2.1.1">2.1.1</a>.  <a class="xref" href="#name-geolocation-feed-individual">Geolocation Feed Individual Entry Fields</a><a class="pilcrow" href="#section-toc.1-1.2.2.1.2.1.1">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.2.2.1.2.1.2.1">
                        <p id="section-toc.1-1.2.2.1.2.1.2.1.1"><a class="xref" href="#section-2.1.1.1">2.1.1.1</a>.  <a class="xref" href="#name-ip-prefix">IP Prefix</a><a class="pilcrow" href="#section-toc.1-1.2.2.1.2.1.2.1.1">¶</a></p>
</li>
                      <li class="toc compact ulEmpty" id="section-toc.1-1.2.2.1.2.1.2.2">
                        <p id="section-toc.1-1.2.2.1.2.1.2.2.1"><a class="xref" href="#section-2.1.1.2">2.1.1.2</a>.  <a class="xref" href="#name-alpha2code-previously-count">Alpha2code (Previously: 'country')</a><a class="pilcrow" href="#section-toc.1-1.2.2.1.2.1.2.2.1">¶</a></p>
</li>
                      <li class="toc compact ulEmpty" id="section-toc.1-1.2.2.1.2.1.2.3">
                        <p id="section-toc.1-1.2.2.1.2.1.2.3.1"><a class="xref" href="#section-2.1.1.3">2.1.1.3</a>.  <a class="xref" href="#name-region">Region</a><a class="pilcrow" href="#section-toc.1-1.2.2.1.2.1.2.3.1">¶</a></p>
</li>
                      <li class="toc compact ulEmpty" id="section-toc.1-1.2.2.1.2.1.2.4">
                        <p id="section-toc.1-1.2.2.1.2.1.2.4.1"><a class="xref" href="#section-2.1.1.4">2.1.1.4</a>.  <a class="xref" href="#name-city">City</a><a class="pilcrow" href="#section-toc.1-1.2.2.1.2.1.2.4.1">¶</a></p>
</li>
                      <li class="toc compact ulEmpty" id="section-toc.1-1.2.2.1.2.1.2.5">
                        <p id="section-toc.1-1.2.2.1.2.1.2.5.1"><a class="xref" href="#section-2.1.1.5">2.1.1.5</a>.  <a class="xref" href="#name-postal-code">Postal Code</a><a class="pilcrow" href="#section-toc.1-1.2.2.1.2.1.2.5.1">¶</a></p>
</li>
                    </ul>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.2.2.1.2.2">
                    <p id="section-toc.1-1.2.2.1.2.2.1"><a class="xref" href="#section-2.1.2">2.1.2</a>.  <a class="xref" href="#name-prefixes-with-no-geolocatio">Prefixes with No Geolocation Information</a><a class="pilcrow" href="#section-toc.1-1.2.2.1.2.2.1">¶</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.2.2.1.2.3">
                    <p id="section-toc.1-1.2.2.1.2.3.1"><a class="xref" href="#section-2.1.3">2.1.3</a>.  <a class="xref" href="#name-additional-parsing-requirem">Additional Parsing Requirements</a><a class="pilcrow" href="#section-toc.1-1.2.2.1.2.3.1">¶</a></p>
</li>
                </ul>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a class="xref" href="#section-2.2">2.2</a>.  <a class="xref" href="#name-examples">Examples</a><a class="pilcrow" href="#section-toc.1-1.2.2.2.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a class="xref" href="#section-3">3</a>.  <a class="xref" href="#name-consuming-self-published-ip">Consuming Self-Published IP Geolocation Feeds</a><a class="pilcrow" href="#section-toc.1-1.3.1">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a class="xref" href="#section-3.1">3.1</a>.  <a class="xref" href="#name-feed-integrity">Feed Integrity</a><a class="pilcrow" href="#section-toc.1-1.3.2.1.1">¶</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a class="xref" href="#section-3.2">3.2</a>.  <a class="xref" href="#name-verification-of-authority">Verification of Authority</a><a class="pilcrow" href="#section-toc.1-1.3.2.2.1">¶</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a class="xref" href="#section-3.3">3.3</a>.  <a class="xref" href="#name-verification-of-accuracy">Verification of Accuracy</a><a class="pilcrow" href="#section-toc.1-1.3.2.3.1">¶</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a class="xref" href="#section-3.4">3.4</a>.  <a class="xref" href="#name-refreshing-feed-information">Refreshing Feed Information</a><a class="pilcrow" href="#section-toc.1-1.3.2.4.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a class="xref" href="#section-4">4</a>.  <a class="xref" href="#name-privacy-considerations">Privacy Considerations</a><a class="pilcrow" href="#section-toc.1-1.4.1">¶</a></p>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a class="xref" href="#section-5">5</a>.  <a class="xref" href="#name-relation-to-other-work">Relation to Other Work</a><a class="pilcrow" href="#section-toc.1-1.5.1">¶</a></p>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a class="xref" href="#section-6">6</a>.  <a class="xref" href="#name-security-considerations">Security Considerations</a><a class="pilcrow" href="#section-toc.1-1.6.1">¶</a></p>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a class="xref" href="#section-7">7</a>.  <a class="xref" href="#name-planned-future-work">Planned Future Work</a><a class="pilcrow" href="#section-toc.1-1.7.1">¶</a></p>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a class="xref" href="#section-8">8</a>.  <a class="xref" href="#name-finding-self-published-ip-g">Finding Self-Published IP Geolocation Feeds</a><a class="pilcrow" href="#section-toc.1-1.8.1">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a class="xref" href="#section-8.1">8.1</a>.  <a class="xref" href="#name-ad-hoc-well-known-uris">Ad Hoc 'Well-Known' URIs</a><a class="pilcrow" href="#section-toc.1-1.8.2.1.1">¶</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a class="xref" href="#section-8.2">8.2</a>.  <a class="xref" href="#name-other-mechanisms">Other Mechanisms</a><a class="pilcrow" href="#section-toc.1-1.8.2.2.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a class="xref" href="#section-9">9</a>.  <a class="xref" href="#name-iana-considerations">IANA Considerations</a><a class="pilcrow" href="#section-toc.1-1.9.1">¶</a></p>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a class="xref" href="#section-10">10</a>. <a class="xref" href="#name-references">References</a><a class="pilcrow" href="#section-toc.1-1.10.1">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a class="xref" href="#section-10.1">10.1</a>.  <a class="xref" href="#name-normative-references">Normative References</a><a class="pilcrow" href="#section-toc.1-1.10.2.1.1">¶</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a class="xref" href="#section-10.2">10.2</a>.  <a class="xref" href="#name-informative-references">Informative References</a><a class="pilcrow" href="#section-toc.1-1.10.2.2.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a class="xref" href="#section-appendix.a">Appendix A</a>.  <a class="xref" href="#name-sample-python-validation-co">Sample Python Validation Code</a><a class="pilcrow" href="#section-toc.1-1.11.1">¶</a></p>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a class="xref" href="#section-appendix.b"></a><a class="xref" href="#name-acknowledgements">Acknowledgements</a><a class="pilcrow" href="#section-toc.1-1.12.1">¶</a></p>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a class="xref" href="#section-appendix.c"></a><a class="xref" href="#name-authors-addresses">Authors' Addresses</a><a class="pilcrow" href="#section-toc.1-1.13.1">¶</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<section id="section-1">
      <h2 id="name-introduction">
<a class="section-number selfRef" href="#section-1">1. </a><a class="section-name selfRef" href="#name-introduction">Introduction</a>
      </h2>
<section id="section-1.1">
        <h3 id="name-motivation">
<a class="section-number selfRef" href="#section-1.1">1.1. </a><a class="section-name selfRef" href="#name-motivation">Motivation</a>
        </h3>
<p id="section-1.1-1">Providers of services over the Internet have grown to depend on
        best-effort geolocation information to improve the user experience.
        Locality information can aid in directing traffic to the nearest
        serving location, inferring likely native language, and providing
        additional context for services involving search queries.<a class="pilcrow" href="#section-1.1-1">¶</a></p>
<p id="section-1.1-2">When an ISP, for example, changes the location where an IP prefix
        is deployed, services that make use of geolocation information may
        begin to suffer degraded performance. This can lead to customer
        complaints, possibly to the ISP directly. Dissemination of correct
        geolocation data is complicated by the lack of any centralized means
        to coordinate and communicate geolocation information to all
        interested consumers of the data.<a class="pilcrow" href="#section-1.1-2">¶</a></p>
<p id="section-1.1-3">This document records a format whereby a network operator (an ISP,
        an enterprise, or any organization that deems the geolocation of its
        IP prefixes to be of concern) can publish a mapping of IP address
        prefixes to simplified geolocation information, colloquially termed a
        "geolocation feed". Interested parties can poll and parse these feeds
        to update or merge with other geolocation data sources and
        procedures.<a class="pilcrow" href="#section-1.1-3">¶</a></p>
<p id="section-1.1-4">This document describes a currently deployed format. At
        least one consumer (Google) has incorporated these feeds into a
        geolocation data pipeline, and a significant number of ISPs are
        using it to inform them where their prefixes should be geolocated.<a class="pilcrow" href="#section-1.1-4">¶</a></p>
</section>
<section id="section-1.2">
        <h3 id="name-requirements-notation">
<a class="section-number selfRef" href="#section-1.2">1.2. </a><a class="section-name selfRef" href="#name-requirements-notation">Requirements Notation</a>
        </h3>
<p id="section-1.2-1">
    The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>",
    "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>",
    "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>", 
    "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are
    to be interpreted as 
    described in BCP 14 <span>[<a class="xref" href="#RFC2119">RFC2119</a>]</span> <span>[<a class="xref" href="#RFC8174">RFC8174</a>]</span> 
    when, and only when, they appear in all capitals, as shown here.<a class="pilcrow" href="#section-1.2-1">¶</a></p>
<p id="section-1.2-2">As this is an informational document about a data format and set of
        operational practices presently in use, requirements notation captures
        the design goals of the authors and implementors.<a class="pilcrow" href="#section-1.2-2">¶</a></p>
</section>
<section id="section-1.3">
        <h3 id="name-assumptions-about-publicati">
<a class="section-number selfRef" href="#section-1.3">1.3. </a><a class="section-name selfRef" href="#name-assumptions-about-publicati">Assumptions about Publication</a>
        </h3>
<p id="section-1.3-1">This document describes both a format and a mechanism for
        publishing data, with the assumption that the network operator to whom
        operational responsibility has been delegated for any published data
        wishes it to be public. Any privacy risk is bounded by the format, and
        feed publishers <span class="bcp14">MAY</span> omit prefixes or any location field associated with
        a given prefix to further protect privacy (see <a class="xref" href="#spec">Section 2.1</a>
        for details about which fields exactly may be omitted). Feed publishers
        assume the responsibility of determining which data should be made
        public.<a class="pilcrow" href="#section-1.3-1">¶</a></p>
<p id="section-1.3-2">This document does not incorporate a mechanism to communicate
        acceptable use policies for self-published data. Publication itself is
        inferred as a desire by the publisher for the data to be usefully
        consumed, similar to the publication of information like host names,
        cryptographic keys, and Sender Policy Framework (SPF) records <span>[<a class="xref" href="#RFC7208">RFC7208</a>]</span> in the DNS.<a class="pilcrow" href="#section-1.3-2">¶</a></p>
</section>
</section>
<section id="section-2">
      <h2 id="name-self-published-ip-geolocati">
<a class="section-number selfRef" href="#section-2">2. </a><a class="section-name selfRef" href="#name-self-published-ip-geolocati">Self-Published IP Geolocation Feeds</a>
      </h2>
<p id="section-2-1">The format described here was developed to address the need of
      network operators to rapidly and usefully share geolocation information
      changes. Originally, there arose a specific case where regional
      operators found it desirable to publish location changes rather than
      wait for geolocation algorithms to "learn" about them. Later, technical
      conferences that frequently use the same network prefixes advertised
      from different conference locations experimented by publishing
      geolocation feeds updated in advance of network location changes in
      order to better serve conference attendees.<a class="pilcrow" href="#section-2-1">¶</a></p>
<p id="section-2-2">At its simplest, the mechanism consists of a network operator
      publishing a file (the "geolocation feed") that contains several text
      entries, one per line. Each entry is keyed by a unique (within the feed)
      IP prefix (or single IP address) followed by a sequence of network
      locality attributes to be ascribed to the given prefix.<a class="pilcrow" href="#section-2-2">¶</a></p>
<div id="spec">
<section id="section-2.1">
        <h3 id="name-specification">
<a class="section-number selfRef" href="#section-2.1">2.1. </a><a class="section-name selfRef" href="#name-specification">Specification</a>
        </h3>
<p id="section-2.1-1">For operational simplicity, every feed should contain data about
        all IP addresses the provider wants to publish. Alternatives, like
        publishing only entries for IP addresses whose geolocation data has
        changed or differ from current observed geolocation behavior "at
        large", are likely to be too operationally complex.<a class="pilcrow" href="#section-2.1-1">¶</a></p>
<p id="section-2.1-2">Feeds <span class="bcp14">MUST</span> use UTF-8 <span>[<a class="xref" href="#RFC3629">RFC3629</a>]</span> character encoding. 
        Lines are delimited by a line break (CRLF) (as specified in
        <span>[<a class="xref" href="#RFC4180">RFC4180</a>]</span>), and blank lines are ignored.
        Text from a '#' character to the end of the current line is treated
        as a comment only and is similarly ignored (note that this does not
        strictly follow <span>[<a class="xref" href="#RFC4180">RFC4180</a>]</span>, which has no
 support for comments).<a class="pilcrow" href="#section-2.1-2">¶</a></p>
<p id="section-2.1-3">Feed lines that are not comments <span class="bcp14">MUST</span> be formatted
 as comma-separated values (CSV), as described in <span>[<a class="xref" href="#RFC4180">RFC4180</a>]</span>. Each feed entry is a text line of
 the form:<a class="pilcrow" href="#section-2.1-3">¶</a></p>
<div class="artwork art-text alignLeft" id="section-2.1-4">
<pre>ip_prefix,alpha2code,region,city,postal_code
</pre><a class="pilcrow" href="#section-2.1-4">¶</a>
</div>
<p id="section-2.1-5">The IP prefix field is <span class="bcp14">REQUIRED</span>, all others are
 <span class="bcp14">OPTIONAL</span> (can be empty), though the requisite minimum
 number of commas <span class="bcp14">SHOULD</span> be present.<a class="pilcrow" href="#section-2.1-5">¶</a></p>
<section id="section-2.1.1">
          <h4 id="name-geolocation-feed-individual">
<a class="section-number selfRef" href="#section-2.1.1">2.1.1. </a><a class="section-name selfRef" href="#name-geolocation-feed-individual">Geolocation Feed Individual Entry Fields</a>
          </h4>
<section id="section-2.1.1.1">
            <h5 id="name-ip-prefix">
<a class="section-number selfRef" href="#section-2.1.1.1">2.1.1.1. </a><a class="section-name selfRef" href="#name-ip-prefix">IP Prefix</a>
            </h5>
<p id="section-2.1.1.1-1"><span class="bcp14">REQUIRED</span>: Each IP prefix field
     <span class="bcp14">MUST</span> be either a single IP address or an IP prefix
     in Classless Inter-Domain Routing (CIDR) notation in conformance
     with <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc4632#section-3.1">Section 3.1</a> of [<a class="xref" href="#RFC4632">RFC4632</a>]</span> for
     IPv4 or <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc4291#section-2.3">Section 2.3</a> of [<a class="xref" href="#RFC4291">RFC4291</a>]</span>
     for IPv6.<a class="pilcrow" href="#section-2.1.1.1-1">¶</a></p>
<p id="section-2.1.1.1-2">Examples include "192.0.2.1" and "192.0.2.0/24" for IPv4 and
            "2001:db8::1" and "2001:db8::/32" for IPv6.<a class="pilcrow" href="#section-2.1.1.1-2">¶</a></p>
</section>
<section id="section-2.1.1.2">
            <h5 id="name-alpha2code-previously-count">
<a class="section-number selfRef" href="#section-2.1.1.2">2.1.1.2. </a><a class="section-name selfRef" href="#name-alpha2code-previously-count">Alpha2code (Previously: 'country')</a>
            </h5>
<p id="section-2.1.1.2-1"><span class="bcp14">OPTIONAL</span>: The alpha2code field, if non-empty,
     <span class="bcp14">MUST</span> be a 2-letter 
            ISO country code conforming to ISO 3166-1 alpha 2 <span>[<a class="xref" href="#ISO.3166.1alpha2">ISO.3166.1alpha2</a>]</span>. Parsers
     <span class="bcp14">SHOULD</span> treat this field 
            case-insensitively.<a class="pilcrow" href="#section-2.1.1.2-1">¶</a></p>
<p id="section-2.1.1.2-2">Earlier versions of this document called this field "country",
     and it may still be referred to as such in existing
     tools/interfaces.<a class="pilcrow" href="#section-2.1.1.2-2">¶</a></p>
<p id="section-2.1.1.2-3">Parsers <span class="bcp14">MAY</span> additionally support other 2-letter
     codes outside the ISO 3166-1 alpha 2 codes, such as the 2-letter
     codes from the "Exceptionally reserved codes" <span>[<a class="xref" href="#ISO-GLOSSARY">ISO-GLOSSARY</a>]</span> set.<a class="pilcrow" href="#section-2.1.1.2-3">¶</a></p>
<p id="section-2.1.1.2-4">Examples include "US" for the United States, "JP" for Japan,
     and "PL" for Poland.<a class="pilcrow" href="#section-2.1.1.2-4">¶</a></p>
</section>
<section id="section-2.1.1.3">
            <h5 id="name-region">
<a class="section-number selfRef" href="#section-2.1.1.3">2.1.1.3. </a><a class="section-name selfRef" href="#name-region">Region</a>
            </h5>
<p id="section-2.1.1.3-1"><span class="bcp14">OPTIONAL</span>: The region field, if non-empty,
     <span class="bcp14">MUST</span> be an ISO region code conforming to ISO 3166-2
     <span>[<a class="xref" href="#ISO.3166.2">ISO.3166.2</a>]</span>. Parsers
     <span class="bcp14">SHOULD</span> treat this field case-insensitively.<a class="pilcrow" href="#section-2.1.1.3-1">¶</a></p>
<p id="section-2.1.1.3-2">Examples include "ID-RI" for the Riau province of Indonesia and
            "NG-RI" for the Rivers province in Nigeria.<a class="pilcrow" href="#section-2.1.1.3-2">¶</a></p>
</section>
<section id="section-2.1.1.4">
            <h5 id="name-city">
<a class="section-number selfRef" href="#section-2.1.1.4">2.1.1.4. </a><a class="section-name selfRef" href="#name-city">City</a>
            </h5>
<p id="section-2.1.1.4-1"><span class="bcp14">OPTIONAL</span>: The city field, if non-empty,
     <span class="bcp14">SHOULD</span> be free UTF-8 
            text, excluding the comma (',') character.<a class="pilcrow" href="#section-2.1.1.4-1">¶</a></p>
<p id="section-2.1.1.4-2">Examples include "Dublin", "New York", and "Sao Paulo"
            (specifically "S" followed by 0xc3, 0xa3, and "o Paulo").<a class="pilcrow" href="#section-2.1.1.4-2">¶</a></p>
</section>
<div id="postal">
<section id="section-2.1.1.5">
            <h5 id="name-postal-code">
<a class="section-number selfRef" href="#section-2.1.1.5">2.1.1.5. </a><a class="section-name selfRef" href="#name-postal-code">Postal Code</a>
            </h5>
<p id="section-2.1.1.5-1"><span class="bcp14">OPTIONAL</span>, DEPRECATED: The postal code field, if
     non-empty, <span class="bcp14">SHOULD</span> be free UTF-8 text, excluding the
     comma (',') character. The use of this field is deprecated;
     consumers of feeds should be able to parse feeds containing these
     fields, but new feeds <span class="bcp14">SHOULD NOT</span> include this
     field due to the granularity of this information. See <a class="xref" href="#privacy">Section 4</a> for additional discussion.<a class="pilcrow" href="#section-2.1.1.5-1">¶</a></p>
<p id="section-2.1.1.5-2">Examples include "106-6126" (in Minato ward, Tokyo, Japan).<a class="pilcrow" href="#section-2.1.1.5-2">¶</a></p>
</section>
</div>
</section>
<section id="section-2.1.2">
          <h4 id="name-prefixes-with-no-geolocatio">
<a class="section-number selfRef" href="#section-2.1.2">2.1.2. </a><a class="section-name selfRef" href="#name-prefixes-with-no-geolocatio">Prefixes with No Geolocation Information</a>
          </h4>
<p id="section-2.1.2-1">Feed publishers may indicate that some IP prefixes should not
          have any associated geolocation information. It may be that some
          prefixes under their administrative control are reserved, not yet
          allocated or deployed, or in the process of being redeployed
          elsewhere and existing geolocation information can, from the
          perspective of the publisher, safely be discarded.<a class="pilcrow" href="#section-2.1.2-1">¶</a></p>
<p id="section-2.1.2-2">This special case can be indicated by explicitly leaving blank
          all fields that specify any degree of geolocation information. For
          example:<a class="pilcrow" href="#section-2.1.2-2">¶</a></p>
<div class="artwork art-text alignLeft" id="section-2.1.2-3">
<pre>192.0.2.0/24,,,,
2001:db8:1::/48,,,,
2001:db8:2::/48,,,,
</pre><a class="pilcrow" href="#section-2.1.2-3">¶</a>
</div>
<p id="section-2.1.2-4">Historically, the user-assigned alpha2code identifier of "ZZ" has
   been used for this same purpose. This is not necessarily preferred,
   and no specific interpretation of any of the other user-assigned
   alpha2code codes is currently defined.<a class="pilcrow" href="#section-2.1.2-4">¶</a></p>
</section>
<section id="section-2.1.3">
          <h4 id="name-additional-parsing-requirem">
<a class="section-number selfRef" href="#section-2.1.3">2.1.3. </a><a class="section-name selfRef" href="#name-additional-parsing-requirem">Additional Parsing Requirements</a>
          </h4>
<p id="section-2.1.3-1">Feed entries that do not have an IP address or prefix field or have an
   IP address or prefix field that fails to parse correctly
   <span class="bcp14">MUST</span> be discarded.<a class="pilcrow" href="#section-2.1.3-1">¶</a></p>
<p id="section-2.1.3-2">While publishers <span class="bcp14">SHOULD</span> follow <span>[<a class="xref" href="#RFC5952">RFC5952</a>]</span> for IPv6 prefix fields,
   consumers <span class="bcp14">MUST</span> nevertheless accept all valid string
   representations.<a class="pilcrow" href="#section-2.1.3-2">¶</a></p>
<p id="section-2.1.3-3">Duplicate IP address or prefix entries <span class="bcp14">MUST</span> be
   considered an error, and consumer implementations
   <span class="bcp14">SHOULD</span> log the repeated entries for further
   administrative review. Publishers <span class="bcp14">SHOULD</span> take
   measures to ensure there is one and only one entry per IP address
   and prefix.<a class="pilcrow" href="#section-2.1.3-3">¶</a></p>
<p id="section-2.1.3-4">Multiple entries that constitute nested prefixes are
   permitted. Consumers <span class="bcp14">SHOULD</span> consider the entry with
   the longest matching prefix (i.e., the "most specific") to be the
   best matching entry for a given IP address.<a class="pilcrow" href="#section-2.1.3-4">¶</a></p>
<p id="section-2.1.3-5">Feed entries with non-empty optional fields that fail to parse,
          either in part or in full, <span class="bcp14">SHOULD</span> be discarded. It is
   <span class="bcp14">RECOMMENDED</span> that they also be logged for further
   administrative review.<a class="pilcrow" href="#section-2.1.3-5">¶</a></p>
<p id="section-2.1.3-6">For compatibility with future additional fields, a parser
   <span class="bcp14">MUST</span> ignore any fields beyond those it expects. The
   data from fields that are expected and that parse successfully
   <span class="bcp14">MUST</span> still be considered valid. Per <a class="xref" href="#future_work">Section 7</a>, no extensions to this format
   are in use nor are any anticipated.<a class="pilcrow" href="#section-2.1.3-6">¶</a></p>
</section>
</section>
</div>
<section id="section-2.2">
        <h3 id="name-examples">
<a class="section-number selfRef" href="#section-2.2">2.2. </a><a class="section-name selfRef" href="#name-examples">Examples</a>
        </h3>
<p id="section-2.2-1">Example entries using different IP address formats and describing
 locations at alpha2code ("country code"), region, and city granularity
 level, respectively:<a class="pilcrow" href="#section-2.2-1">¶</a></p>
<div class="artwork art-text alignLeft" id="section-2.2-2">
<pre>192.0.2.0/25,US,US-AL,,
192.0.2.5,US,US-AL,Alabaster,
192.0.2.128/25,PL,PL-MZ,,
2001:db8::/32,PL,,,
2001:db8:cafe::/48,PL,PL-MZ,,
</pre><a class="pilcrow" href="#section-2.2-2">¶</a>
</div>
<p id="section-2.2-3">The IETF network publishes geolocation information for the meeting
        prefixes, and generally just comment out the last meeting information
        and append the new meeting information. The <span>[<a class="xref" href="#GEO_IETF">GEO_IETF</a>]</span>, at the time of this writing, contains:<a class="pilcrow" href="#section-2.2-3">¶</a></p>
<div class="artwork art-text alignLeft" id="section-2.2-4">
<pre># IETF106 (Singapore) - November 2019 - Singapore, SG
130.129.0.0/16,SG,SG-01,Singapore,
2001:df8::/32,SG,SG-01,Singapore,
31.133.128.0/18,SG,SG-01,Singapore,
31.130.224.0/20,SG,SG-01,Singapore,
2001:67c:1230::/46,SG,SG-01,Singapore,
2001:67c:370::/48,SG,SG-01,Singapore,
</pre><a class="pilcrow" href="#section-2.2-4">¶</a>
</div>
<p id="section-2.2-5">Experimentally, RIPE has published geolocation information for
        their conference network prefixes, which change location in accordance
        with each new event. <span>[<a class="xref" href="#GEO_RIPE_NCC">GEO_RIPE_NCC</a>]</span>, at the time of
        writing, contains:<a class="pilcrow" href="#section-2.2-5">¶</a></p>
<div class="artwork art-text alignLeft" id="section-2.2-6">
<pre>193.0.24.0/21,NL,NL-ZH,Rotterdam,
2001:67c:64::/48,NL,NL-ZH,Rotterdam,
</pre><a class="pilcrow" href="#section-2.2-6">¶</a>
</div>
<p id="section-2.2-7">Similarly, ICANN has published geolocation information for their
        portable conference network prefixes. <span>[<a class="xref" href="#GEO_ICANN">GEO_ICANN</a>]</span>, at
        the time of writing, contains:<a class="pilcrow" href="#section-2.2-7">¶</a></p>
<div class="artwork art-text alignLeft" id="section-2.2-8">
<pre>199.91.192.0/21,MA,MA-07,Marrakech
2620:f:8000::/48,MA,MA-07,Marrakech
</pre><a class="pilcrow" href="#section-2.2-8">¶</a>
</div>
<p id="section-2.2-9">A longer example is the <span>[<a class="xref" href="#GEO_Google">GEO_Google</a>]</span> Google Corp
        Geofeed, which lists the geolocation information for Google corporate
        offices.<a class="pilcrow" href="#section-2.2-9">¶</a></p>
<p id="section-2.2-10">At the time of writing, Google processes approximately 400 feeds
        comprising more than 750,000 IPv4 and IPv6 prefixes.<a class="pilcrow" href="#section-2.2-10">¶</a></p>
</section>
</section>
<div id="consumers">
<section id="section-3">
      <h2 id="name-consuming-self-published-ip">
<a class="section-number selfRef" href="#section-3">3. </a><a class="section-name selfRef" href="#name-consuming-self-published-ip">Consuming Self-Published IP Geolocation Feeds</a>
      </h2>
<p id="section-3-1">Consumers <span class="bcp14">MAY</span> treat published feed data as a hint only
      and <span class="bcp14">MAY</span> choose 
      to prefer other sources of geolocation information for any given IP
      prefix. Regardless of a consumer's stance with respect to a given
      published feed, there are some points of note for sensibly and
      effectively consuming published feeds.<a class="pilcrow" href="#section-3-1">¶</a></p>
<div id="integrity">
<section id="section-3.1">
        <h3 id="name-feed-integrity">
<a class="section-number selfRef" href="#section-3.1">3.1. </a><a class="section-name selfRef" href="#name-feed-integrity">Feed Integrity</a>
        </h3>
<p id="section-3.1-1">The integrity of published information <span class="bcp14">SHOULD</span> be
 protected by securing the means of publication, for example, by using
 HTTP over TLS <span>[<a class="xref" href="#RFC2818">RFC2818</a>]</span>. Whenever
 possible, consumers <span class="bcp14">SHOULD</span> prefer retrieving
 geolocation feeds in a manner that guarantees integrity of the
 feed.<a class="pilcrow" href="#section-3.1-1">¶</a></p>
</section>
</div>
<div id="authority">
<section id="section-3.2">
        <h3 id="name-verification-of-authority">
<a class="section-number selfRef" href="#section-3.2">3.2. </a><a class="section-name selfRef" href="#name-verification-of-authority">Verification of Authority</a>
        </h3>
<p id="section-3.2-1">Consumers of self-published IP geolocation feeds <span class="bcp14">SHOULD</span> perform
        some form of verification that the publisher is in fact authoritative
        for the addresses in the feed. The actual means of verification is
        likely dependent upon the way in which the feed is discovered. Ad hoc
        shared URIs, for example, will likely require an ad hoc verification
        process. Future automated means of feed discovery <span class="bcp14">SHOULD</span> have an
        accompanying automated means of verification.<a class="pilcrow" href="#section-3.2-1">¶</a></p>
<p id="section-3.2-2">A consumer should only trust geolocation information for IP addresses
        or prefixes for which the publisher has been verified as
        administratively authoritative. All other geolocation feed entries
        should be ignored and logged for further administrative review.<a class="pilcrow" href="#section-3.2-2">¶</a></p>
</section>
</div>
<div id="accuracy">
<section id="section-3.3">
        <h3 id="name-verification-of-accuracy">
<a class="section-number selfRef" href="#section-3.3">3.3. </a><a class="section-name selfRef" href="#name-verification-of-accuracy">Verification of Accuracy</a>
        </h3>
<p id="section-3.3-1">Errors and inaccuracies may occur at many levels, and publication
        and consumption of geolocation data are no exceptions. To the extent
        practical, consumers <span class="bcp14">SHOULD</span> take steps to verify the accuracy of
        published locality. Verification methodology, resolution of
        discrepancies, and preference for alternative sources of data are left
        to the discretion of the feed consumer.<a class="pilcrow" href="#section-3.3-1">¶</a></p>
<p id="section-3.3-2">Consumers <span class="bcp14">SHOULD</span> decide on discrepancy thresholds
 and <span class="bcp14">SHOULD</span> flag, for administrative review, feed entries
 that exceed set thresholds.<a class="pilcrow" href="#section-3.3-2">¶</a></p>
</section>
</div>
<section id="section-3.4">
        <h3 id="name-refreshing-feed-information">
<a class="section-number selfRef" href="#section-3.4">3.4. </a><a class="section-name selfRef" href="#name-refreshing-feed-information">Refreshing Feed Information</a>
        </h3>
<p id="section-3.4-1">As a publisher can change geolocation data at any time and without
        notification, consumers <span class="bcp14">SHOULD</span> implement mechanisms to periodically
        refresh local copies of feed data. In the absence of any other refresh
        timing information, it is recommended that consumers <span class="bcp14">SHOULD</span> refresh
        feeds no less often than weekly and no more often than is likely
        to cause issues to the publisher.<a class="pilcrow" href="#section-3.4-1">¶</a></p>
<p id="section-3.4-2">For feeds available via HTTPS (or HTTP), the publisher <span class="bcp14">MAY</span>
        communicate refresh timing information by means of the standard HTTP
        expiration model (<span>[<a class="xref" href="#RFC7234">RFC7234</a>]</span>). Specifically, publishers can 
        include either an Expires header (<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc7234#section-5.3">Section 5.3</a> of [<a class="xref" href="#RFC7234">RFC7234</a>]</span>) or a Cache-Control header (<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc7234#section-5.2">Section 5.2</a> of [<a class="xref" href="#RFC7234">RFC7234</a>]</span>) specifying the
 max-age. Where practical, consumers <span class="bcp14">SHOULD</span> refresh feed
 information before the expiry time is reached.<a class="pilcrow" href="#section-3.4-2">¶</a></p>
</section>
</section>
</div>
<div id="privacy">
<section id="section-4">
      <h2 id="name-privacy-considerations">
<a class="section-number selfRef" href="#section-4">4. </a><a class="section-name selfRef" href="#name-privacy-considerations">Privacy Considerations</a>
      </h2>
<p id="section-4-1">Publishers of geolocation feeds are advised to have fully considered
      any and all privacy implications of the disclosure of such information
      for the users of the described networks prior to publication. A thorough
      comprehension of the security considerations (<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc6772#section-13">Section 13</a> of [<a class="xref" href="#RFC6772">RFC6772</a>]</span>) of a chosen geolocation policy is
      highly recommended, including an understanding of some of the
      limitations of information obscurity (<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc6772#section-13.5">Section 13.5</a> of [<a class="xref" href="#RFC6772">RFC6772</a>]</span>) (see also <span>[<a class="xref" href="#RFC6772">RFC6772</a>]</span>).<a class="pilcrow" href="#section-4-1">¶</a></p>
<p id="section-4-2">As noted in <a class="xref" href="#spec">Section 2.1</a>, each location
      field in an entry is 
      optional, in order to support expressing only the level of specificity
      that the publisher has deemed acceptable. There is no requirement that
      the level of specificity be consistent across all entries within a feed.
      In particular, the Postal Code field (<a class="xref" href="#postal">Section 2.1.1.5</a>) can
      provide very specific geolocation, sometimes within a building. Such
      specific Postal Code values <span class="bcp14">MUST NOT</span> be published in geofeeds without
      the express consent of the parties being located.<a class="pilcrow" href="#section-4-2">¶</a></p>
<p id="section-4-3">Operators who publish geolocation information are strongly encouraged
      to inform affected users/customers of this fact and of the potential
      privacy-related consequences and trade-offs.<a class="pilcrow" href="#section-4-3">¶</a></p>
</section>
</div>
<section id="section-5">
      <h2 id="name-relation-to-other-work">
<a class="section-number selfRef" href="#section-5">5. </a><a class="section-name selfRef" href="#name-relation-to-other-work">Relation to Other Work</a>
      </h2>
<p id="section-5-1">While not originally done in conjunction with the GEOPRIV
      Working Group <span>[<a class="xref" href="#GEOPRIV">GEOPRIV</a>]</span>, Richard Barnes
      observed that this work 
      is nevertheless consistent with that which the group has defined, both
      for address format and for privacy. The data elements in geolocation
      feeds are equivalent to the following XML structure (<span>[<a class="xref" href="#RFC5139">RFC5139</a>]</span> <span>[<a class="xref" href="#W3C.REC-xml-20081126">W3C.REC-xml-20081126</a>]</span>):<a class="pilcrow" href="#section-5-1">¶</a></p>
<div id="section-5-2">
<pre class="sourcecode lang-xml">&lt;civicAddress&gt;
  &lt;country&gt;country&lt;/country&gt;
  &lt;A1&gt;region&lt;/A1&gt;
  &lt;A2&gt;city&lt;/A2&gt;
  &lt;PC&gt;postal_code&lt;/PC&gt;
&lt;/civicAddress&gt;
</pre><a class="pilcrow" href="#section-5-2">¶</a>
</div>
<p id="section-5-3">Providing geolocation information to this granularity is equivalent
      to the following privacy policy (the definition of the 'building'
      <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc6772#section-6.5.1">Section 6.5.1</a> of [<a class="xref" href="#RFC6772">RFC6772</a>]</span> level of
      disclosure):<a class="pilcrow" href="#section-5-3">¶</a></p>
<div id="section-5-4">
<pre class="sourcecode lang-xml">&lt;ruleset&gt;
  &lt;rule&gt;
    &lt;conditions/&gt;
    &lt;actions/&gt;
    &lt;transformations&gt;
      &lt;provide-location profile="civic-transformation"&gt;
        &lt;provide-civic&gt;building&lt;/provide-civic&gt;
      &lt;/provide-location&gt;
    &lt;/transformations&gt;
  &lt;/rule&gt;
&lt;/ruleset&gt;
</pre><a class="pilcrow" href="#section-5-4">¶</a>
</div>
</section>
<div id="Security">
<section id="section-6">
      <h2 id="name-security-considerations">
<a class="section-number selfRef" href="#section-6">6. </a><a class="section-name selfRef" href="#name-security-considerations">Security Considerations</a>
      </h2>
<p id="section-6-1">As there is no true security in the obscurity of the location of any
      given IP address, self-publication of this data fundamentally opens no
      new attack vectors. For publishers, self-published data may increase
      the ease with which such location data might be exploited (it can, for
      example, make easy the discovery of prefixes populated with customers
      as distinct from prefixes not generally in use).<a class="pilcrow" href="#section-6-1">¶</a></p>
<p id="section-6-2">For consumers, feed retrieval processes may receive input from
      potentially hostile sources (e.g., in the event of hijacked traffic). As
      such, proper input validation and defense measures <span class="bcp14">MUST</span> be taken (see
      the discussion in <a class="xref" href="#integrity">Section 3.1</a>).<a class="pilcrow" href="#section-6-2">¶</a></p>
<p id="section-6-3">Similarly, consumers who do not perform sufficient verification of
      published data bear the same risks as from other forms of geolocation
      configuration errors (see the discussion in Sections <a class="xref" href="#authority">3.2</a> 
      and <a class="xref" href="#accuracy">3.3</a>).<a class="pilcrow" href="#section-6-3">¶</a></p>
<p id="section-6-4">Validation of a feed's contents includes verifying that the publisher
      is authoritative for the IP prefixes included in the feed. Failure to
      verify IP prefix authority would, for example, allow ISP Bob to make
      geolocation statements about IP space held by ISP Alice. At this time,
      only out-of-band verification methods are implemented (i.e., an ISP's
      feed may be verified against publicly available IP allocation data).<a class="pilcrow" href="#section-6-4">¶</a></p>
</section>
</div>
<div id="future_work">
<section id="section-7">
      <h2 id="name-planned-future-work">
<a class="section-number selfRef" href="#section-7">7. </a><a class="section-name selfRef" href="#name-planned-future-work">Planned Future Work</a>
      </h2>
<p id="section-7-1">In order to more flexibly support future extensions, use of a more
      expressive feed format has been suggested. Use of JavaScript Object
      Notation (JSON) <span>[<a class="xref" href="#RFC8259">RFC8259</a>]</span>,
      specifically, has been 
      discussed. However, at the time of writing, no such specification nor
      implementation exists. Nevertheless, work on extensions is deferred
      until a more suitable format has been selected.<a class="pilcrow" href="#section-7-1">¶</a></p>
<p id="section-7-2">The authors are planning on writing a document describing such a
      new format. This document describes a currently deployed and used
      format. Given the extremely limited extensibility of the present format
      no extensions to it are anticipated. Extensibility requirements are
      instead expected to be integral to the development of a new format.<a class="pilcrow" href="#section-7-2">¶</a></p>
</section>
</div>
<section id="section-8">
      <h2 id="name-finding-self-published-ip-g">
<a class="section-number selfRef" href="#section-8">8. </a><a class="section-name selfRef" href="#name-finding-self-published-ip-g">Finding Self-Published IP Geolocation Feeds</a>
      </h2>
<p id="section-8-1">The issue of finding, and later verifying, geolocation feeds is not
      formally specified in this document. At this time, only ad hoc feed
      discovery and verification has a modicum of established practice (see
      below); discussion of other mechanisms has been removed for clarity.<a class="pilcrow" href="#section-8-1">¶</a></p>
<section id="section-8.1">
        <h3 id="name-ad-hoc-well-known-uris">
<a class="section-number selfRef" href="#section-8.1">8.1. </a><a class="section-name selfRef" href="#name-ad-hoc-well-known-uris">Ad Hoc 'Well-Known' URIs</a>
        </h3>
<p id="section-8.1-1">To date, geolocation feeds have been shared informally in the form
        of HTTPS URIs exchanged in email threads. Three example URIs (<span>[<a class="xref" href="#GEO_IETF">GEO_IETF</a>]</span>, <span>[<a class="xref" href="#GEO_RIPE_NCC">GEO_RIPE_NCC</a>]</span>, and <span>[<a class="xref" href="#GEO_ICANN">GEO_ICANN</a>]</span>)
 describe networks that change locations periodically, the operators
 and operational practices of which are well known within their
 respective technical communities.<a class="pilcrow" href="#section-8.1-1">¶</a></p>
<p id="section-8.1-2">The contents of the feeds are verified by a similarly ad hoc
        process, including:<a class="pilcrow" href="#section-8.1-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.1-3.1">personal knowledge of the parties involved in the exchange
   and<a class="pilcrow" href="#section-8.1-3.1">¶</a>
</li>
          <li class="normal" id="section-8.1-3.2">comparison of feed-advertised prefixes with the BGP-advertised
   prefixes of Autonomous System Numbers known to be operated by the
   publishers.<a class="pilcrow" href="#section-8.1-3.2">¶</a>
</li>
        </ul>
<p id="section-8.1-4">Ad hoc mechanisms, while useful for early experimentation by
        producers and consumers, are unlikely to be adequate for long-term,
        widespread use by multiple parties. Future versions of any such
        self-published geolocation feed mechanism <span class="bcp14">SHOULD</span> address scalability
        concerns by defining a means for automated discovery and verification
        of operational authority of advertised prefixes.<a class="pilcrow" href="#section-8.1-4">¶</a></p>
</section>
<section id="section-8.2">
        <h3 id="name-other-mechanisms">
<a class="section-number selfRef" href="#section-8.2">8.2. </a><a class="section-name selfRef" href="#name-other-mechanisms">Other Mechanisms</a>
        </h3>
<p id="section-8.2-1">Previous versions of this document referenced use of the
        WHOIS service <span>[<a class="xref" href="#RFC3912">RFC3912</a>]</span> operated by
 Regional Internet Registries (RIRs), as well as
        possible DNS-based schemes to discover and validate geofeeds.
        To the authors' knowledge, support for such mechanisms has never been
        implemented, and this speculative text has been removed to avoid
        ambiguity.<a class="pilcrow" href="#section-8.2-1">¶</a></p>
</section>
</section>
<section id="section-9">
      <h2 id="name-iana-considerations">
<a class="section-number selfRef" href="#section-9">9. </a><a class="section-name selfRef" href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<p id="section-9-1">This document has no IANA actions.<a class="pilcrow" href="#section-9-1">¶</a></p>
</section>
<section id="section-10">
      <h2 id="name-references">
<a class="section-number selfRef" href="#section-10">10. </a><a class="section-name selfRef" href="#name-references">References</a>
      </h2>
<section id="section-10.1">
        <h3 id="name-normative-references">
<a class="section-number selfRef" href="#section-10.1">10.1. </a><a class="section-name selfRef" href="#name-normative-references">Normative References</a>
        </h3>
<dl class="references">
<dt id="ISO.3166.1alpha2">[ISO.3166.1alpha2]</dt>
        <dd>
<span class="refAuthor">ISO</span>, <span class="refTitle">"ISO 3166-1 decoding table"</span>, <span>&lt;<a href="http://www.iso.org/iso/home/standards/country_codes/iso-3166-1_decoding_table.htm">http://www.iso.org/iso/home/standards/country_codes/iso-3166-1_decoding_table.htm</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ISO.3166.2">[ISO.3166.2]</dt>
        <dd>
<span class="refAuthor">ISO</span>, <span class="refTitle">"ISO 3166-2:2007"</span>, <span>&lt;<a href="http://www.iso.org/iso/home/standards/country_codes.htm#2012_iso3166-2">http://www.iso.org/iso/home/standards/country_codes.htm#2012_iso3166-2</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time class="refDate" datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3629">[RFC3629]</dt>
        <dd>
<span class="refAuthor">Yergeau, F.</span>, <span class="refTitle">"UTF-8, a transformation format of ISO 10646"</span>, <span class="seriesInfo">STD 63</span>, <span class="seriesInfo">RFC 3629</span>, <span class="seriesInfo">DOI 10.17487/RFC3629</span>, <time class="refDate" datetime="2003-11">November 2003</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3629">https://www.rfc-editor.org/info/rfc3629</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4180">[RFC4180]</dt>
        <dd>
<span class="refAuthor">Shafranovich, Y.</span>, <span class="refTitle">"Common Format and MIME Type for Comma-Separated Values (CSV) Files"</span>, <span class="seriesInfo">RFC 4180</span>, <span class="seriesInfo">DOI 10.17487/RFC4180</span>, <time class="refDate" datetime="2005-10">October 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4180">https://www.rfc-editor.org/info/rfc4180</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4291">[RFC4291]</dt>
        <dd>
<span class="refAuthor">Hinden, R.</span><span class="refAuthor"> and S. Deering</span>, <span class="refTitle">"IP Version 6 Addressing Architecture"</span>, <span class="seriesInfo">RFC 4291</span>, <span class="seriesInfo">DOI 10.17487/RFC4291</span>, <time class="refDate" datetime="2006-02">February 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4291">https://www.rfc-editor.org/info/rfc4291</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4632">[RFC4632]</dt>
        <dd>
<span class="refAuthor">Fuller, V.</span><span class="refAuthor"> and T. Li</span>, <span class="refTitle">"Classless Inter-domain Routing (CIDR): The Internet Address Assignment and Aggregation Plan"</span>, <span class="seriesInfo">BCP 122</span>, <span class="seriesInfo">RFC 4632</span>, <span class="seriesInfo">DOI 10.17487/RFC4632</span>, <time class="refDate" datetime="2006-08">August 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4632">https://www.rfc-editor.org/info/rfc4632</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5952">[RFC5952]</dt>
        <dd>
<span class="refAuthor">Kawamura, S.</span><span class="refAuthor"> and M. Kawashima</span>, <span class="refTitle">"A Recommendation for IPv6 Address Text Representation"</span>, <span class="seriesInfo">RFC 5952</span>, <span class="seriesInfo">DOI 10.17487/RFC5952</span>, <time class="refDate" datetime="2010-08">August 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5952">https://www.rfc-editor.org/info/rfc5952</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7234">[RFC7234]</dt>
        <dd>
<span class="refAuthor">Fielding, R., Ed.</span><span class="refAuthor">, Nottingham, M., Ed.</span><span class="refAuthor">, and J. Reschke, Ed.</span>, <span class="refTitle">"Hypertext Transfer Protocol (HTTP/1.1): Caching"</span>, <span class="seriesInfo">RFC 7234</span>, <span class="seriesInfo">DOI 10.17487/RFC7234</span>, <time class="refDate" datetime="2014-06">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7234">https://www.rfc-editor.org/info/rfc7234</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time class="refDate" datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="W3C.REC-xml-20081126">[W3C.REC-xml-20081126]</dt>
      <dd>
<span class="refAuthor">Bray, T.</span><span class="refAuthor">, Paoli, J.</span><span class="refAuthor">, Sperberg-McQueen, M.</span><span class="refAuthor">, Maler, E.</span><span class="refAuthor">, and F. Yergeau</span>, <span class="refTitle">"Extensible Markup Language (XML) 1.0 (Fifth Edition)"</span>, <span class="seriesInfo">World Wide Web Consortium Recommendation REC-xml-20081126</span>, <time class="refDate" datetime="2008-11">November 2008</time>, <span>&lt;<a href="http://www.w3.org/TR/2008/REC-xml-20081126">http://www.w3.org/TR/2008/REC-xml-20081126</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-10.2">
        <h3 id="name-informative-references">
<a class="section-number selfRef" href="#section-10.2">10.2. </a><a class="section-name selfRef" href="#name-informative-references">Informative References</a>
        </h3>
<dl class="references">
<dt id="GEOPRIV">[GEOPRIV]</dt>
        <dd>
<span class="refAuthor">IETF</span>, <span class="refTitle">"Geographic Location/Privacy (geopriv)"</span>, <span></span>, <span>&lt;<a href="http://datatracker.ietf.org/wg/geopriv/">http://datatracker.ietf.org/wg/geopriv/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="GEO_Google">[GEO_Google]</dt>
        <dd>
<span class="refAuthor">Google, LLC</span>, <span class="refTitle">"Google Corp Geofeed"</span>, <span>&lt;<a href="https://www.gstatic.com/geofeed/corp_external">https://www.gstatic.com/geofeed/corp_external</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="GEO_ICANN">[GEO_ICANN]</dt>
        <dd>
<span class="refAuthor">ICANN</span>, <span class="refTitle">"ICANN Meeting Geolocation Data"</span>, <span>&lt;<a href="https://meeting-services.icann.org/geo/google.csv">https://meeting-services.icann.org/geo/google.csv</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="GEO_IETF">[GEO_IETF]</dt>
        <dd>
<span class="refAuthor">Kumari, W.</span>, <span class="refTitle">"IETF Meeting Network Geolocation Data"</span>, <span>&lt;<a href="https://noc.ietf.org/geo/google.csv">https://noc.ietf.org/geo/google.csv</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="GEO_RIPE_NCC">[GEO_RIPE_NCC]</dt>
        <dd>
<span class="refAuthor">Schepers, M.</span>, <span class="refTitle">"RIPE NCC Meeting Geolocation Data"</span>, <span>&lt;<a href="https://meetings.ripe.net/geo/google.csv">https://meetings.ripe.net/geo/google.csv</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IPADDR_PY">[IPADDR_PY]</dt>
        <dd>
<span class="refAuthor">Shields, M.</span><span class="refAuthor"> and P. Moody</span>, <span class="refTitle">"Google's Python IP address manipulation library"</span>, <span></span>, <span>&lt;<a href="http://code.google.com/p/ipaddr-py/">http://code.google.com/p/ipaddr-py/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ISO-GLOSSARY">[ISO-GLOSSARY]</dt>
        <dd>
<span class="refAuthor">ISO</span>, <span class="refTitle">"Glossary for ISO 3166"</span>, <span></span>, <span>&lt;<a href="https://www.iso.org/glossary-for-iso-3166.html">https://www.iso.org/glossary-for-iso-3166.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2818">[RFC2818]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"HTTP Over TLS"</span>, <span class="seriesInfo">RFC 2818</span>, <span class="seriesInfo">DOI 10.17487/RFC2818</span>, <time class="refDate" datetime="2000-05">May 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2818">https://www.rfc-editor.org/info/rfc2818</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3912">[RFC3912]</dt>
        <dd>
<span class="refAuthor">Daigle, L.</span>, <span class="refTitle">"WHOIS Protocol Specification"</span>, <span class="seriesInfo">RFC 3912</span>, <span class="seriesInfo">DOI 10.17487/RFC3912</span>, <time class="refDate" datetime="2004-09">September 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3912">https://www.rfc-editor.org/info/rfc3912</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5139">[RFC5139]</dt>
        <dd>
<span class="refAuthor">Thomson, M.</span><span class="refAuthor"> and J. Winterbottom</span>, <span class="refTitle">"Revised Civic Location Format for Presence Information Data Format Location Object (PIDF-LO)"</span>, <span class="seriesInfo">RFC 5139</span>, <span class="seriesInfo">DOI 10.17487/RFC5139</span>, <time class="refDate" datetime="2008-02">February 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5139">https://www.rfc-editor.org/info/rfc5139</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6772">[RFC6772]</dt>
        <dd>
<span class="refAuthor">Schulzrinne, H., Ed.</span><span class="refAuthor">, Tschofenig, H., Ed.</span><span class="refAuthor">, Cuellar, J.</span><span class="refAuthor">, Polk, J.</span><span class="refAuthor">, Morris, J.</span><span class="refAuthor">, and M. Thomson</span>, <span class="refTitle">"Geolocation Policy: A Document Format for Expressing Privacy Preferences for Location Information"</span>, <span class="seriesInfo">RFC 6772</span>, <span class="seriesInfo">DOI 10.17487/RFC6772</span>, <time class="refDate" datetime="2013-01">January 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6772">https://www.rfc-editor.org/info/rfc6772</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7208">[RFC7208]</dt>
        <dd>
<span class="refAuthor">Kitterman, S.</span>, <span class="refTitle">"Sender Policy Framework (SPF) for Authorizing Use of Domains in Email, Version 1"</span>, <span class="seriesInfo">RFC 7208</span>, <span class="seriesInfo">DOI 10.17487/RFC7208</span>, <time class="refDate" datetime="2014-04">April 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7208">https://www.rfc-editor.org/info/rfc7208</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8259">[RFC8259]</dt>
      <dd>
<span class="refAuthor">Bray, T., Ed.</span>, <span class="refTitle">"The JavaScript Object Notation (JSON) Data Interchange Format"</span>, <span class="seriesInfo">STD 90</span>, <span class="seriesInfo">RFC 8259</span>, <span class="seriesInfo">DOI 10.17487/RFC8259</span>, <time class="refDate" datetime="2017-12">December 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8259">https://www.rfc-editor.org/info/rfc8259</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<section id="section-appendix.a">
      <h2 id="name-sample-python-validation-co">
<a class="section-number selfRef" href="#section-appendix.a">Appendix A. </a><a class="section-name selfRef" href="#name-sample-python-validation-co">Sample Python Validation Code</a>
      </h2>
<p id="section-appendix.a-1">Included here is a simple format validator in Python for
      self-published ipgeo feeds. This tool reads CSV data in the
      self-published ipgeo feed format from the standard input and performs
      basic validation.  It is intended for use by feed publishers before
      launching a feed. Note that this validator does not verify the
      uniqueness of every IP prefix entry within the feed as a whole but only
      verifies the syntax of each single line from within the feed. A complete
      validator <span class="bcp14">MUST</span> also ensure IP prefix uniqueness.<a class="pilcrow" href="#section-appendix.a-1">¶</a></p>
<p id="section-appendix.a-2">The main source file "ipgeo_feed_validator.py" follows. It requires
      use of the open source ipaddr Python library for IP address and CIDR
      parsing and validation <span>[<a class="xref" href="#IPADDR_PY">IPADDR_PY</a>]</span>.<a class="pilcrow" href="#section-appendix.a-2">¶</a></p>
<div id="section-appendix.a-3">
<pre class="sourcecode lang-python">&lt;CODE BEGINS&gt;
#!/usr/bin/python
#
# Copyright (c) 2012 IETF Trust and the persons identified as
# authors of the code.  All rights reserved.  Redistribution and use
# in source and binary forms, with or without modification, is
# permitted pursuant to, and subject to the license terms contained
# in, the Simplified BSD License set forth in Section 4.c of the
# IETF Trust's Legal Provisions Relating to IETF
# Documents (http://trustee.ietf.org/license-info).

"""Simple format validator for self-published ipgeo feeds.

This tool reads CSV data in the self-published ipgeo feed format
from the standard input and performs basic validation.  It is
intended for use by feed publishers before launching a feed.
"""

import csv
import ipaddr
import re
import sys


class IPGeoFeedValidator(object):
  def __init__(self):
    self.prefixes = {}
    self.line_number = 0
    self.output_log = {}
    self.SetOutputStream(sys.stderr)

  def Validate(self, feed):
    """Check validity of an IPGeo feed.

    Args:
      feed: iterable with feed lines
    """

    for line in feed:
      self._ValidateLine(line)

  def SetOutputStream(self, logfile):
    """Controls where the output messages go do (STDERR by default).

    Use None to disable logging.

    Args:
      logfile: a file object (e.g., sys.stdout) or None.
    """
    self.output_stream = logfile

  def CountErrors(self, severity):
    """How many ERRORs or WARNINGs were generated."""
    return len(self.output_log.get(severity, []))

  ############################################################
  def _ValidateLine(self, line):
    line = line.rstrip('\r\n')
    self.line_number += 1
    self.line = line.split('#')[0]
    self.is_correct_line = True

    if self._ShouldIgnoreLine(line):
      return

    fields = [field for field in csv.reader([line])][0]

    self._ValidateFields(fields)
    self._FlushOutputStream()

  def _ShouldIgnoreLine(self, line):
    line = line.strip()
    if line.startswith('#'):
      return True
    return len(line) == 0

  ############################################################
  def _ValidateFields(self, fields):
    assert(len(fields) &gt; 0)

    is_correct = self._IsIPAddressOrPrefixCorrect(fields[0])

    if len(fields) &gt; 1:
      if not self._IsAlpha2CodeCorrect(fields[1]):
        is_correct = False

    if len(fields) &gt; 2 and not self._IsRegionCodeCorrect(fields[2]):
      is_correct = False

    if len(fields) != 5:
      self._ReportWarning('5 fields were expected (got %d).'
                          % len(fields))

  ############################################################
  def _IsIPAddressOrPrefixCorrect(self, field):
    if '/' in field:
      return self._IsCIDRCorrect(field)
    return self._IsIPAddressCorrect(field)

  def _IsCIDRCorrect(self, cidr):
    try:
      ipprefix = ipaddr.IPNetwork(cidr)
      if ipprefix.network._ip != ipprefix._ip:
        self._ReportError('Incorrect IP Network.')
        return False
      if ipprefix.is_private:
        self._ReportError('IP Address must not be private.')
        return False
    except:
      self._ReportError('Incorrect IP Network.')
      return False
    return True

  def _IsIPAddressCorrect(self, ipaddress):
    try:
      ip = ipaddr.IPAddress(ipaddress)
    except:
      self._ReportError('Incorrect IP Address.')
      return False
    if ip.is_private:
      self._ReportError('IP Address must not be private.')
      return False
    return True

  ############################################################
  def _IsAlpha2CodeCorrect(self, alpha2code):
    if len(alpha2code) == 0:
      return True
    if len(alpha2code) != 2 or not alpha2code.isalpha():
      self._ReportError(
          'Alpha 2 code must be in the ISO 3166-1 alpha 2 format.')
      return False
    return True

  def _IsRegionCodeCorrect(self, region_code):
    if len(region_code) == 0:
      return True
    if '-' not in region_code:
      self._ReportError('Region code must be in ISO 3166-2 format.')
      return False

    parts = region_code.split('-')
    if not self._IsAlpha2CodeCorrect(parts[0]):
      return False
    return True

  ############################################################
  def _ReportError(self, message):
    self._ReportWithSeverity('ERROR', message)

  def _ReportWarning(self, message):
    self._ReportWithSeverity('WARNING', message)

  def _ReportWithSeverity(self, severity, message):
    self.is_correct_line = False
    output_line = '%s: %s\n' % (severity, message)

    if severity not in self.output_log:
      self.output_log[severity] = []
    self.output_log[severity].append(output_line)

    if self.output_stream is not None:
      self.output_stream.write(output_line)

  def _FlushOutputStream(self):
    if self.is_correct_line: return
    if self.output_stream is None: return

    self.output_stream.write('line %d: %s\n\n'
                             % (self.line_number, self.line))


############################################################
def main():
   feed_validator = IPGeoFeedValidator()
   feed_validator.Validate(sys.stdin)

   if feed_validator.CountErrors('ERROR'):
     sys.exit(1)

if __name__ == '__main__':
  main()

&lt;CODE ENDS&gt;</pre><a class="pilcrow" href="#section-appendix.a-3">¶</a>
</div>
<p id="section-appendix.a-4">A unit test file, "ipgeo_feed_validator_test.py" is provided as well.
      It provides basic test coverage of the code above, though does not test
      correct handling of non-ASCII UTF-8 strings.<a class="pilcrow" href="#section-appendix.a-4">¶</a></p>
<div id="section-appendix.a-5">
<pre class="sourcecode lang-python">&lt;CODE BEGINS&gt;
#!/usr/bin/python
#
# Copyright (c) 2012 IETF Trust and the persons identified as
# authors of the code.  All rights reserved.  Redistribution and use
# in source and binary forms, with or without modification, is
# permitted pursuant to, and subject to the license terms contained
# in, the Simplified BSD License set forth in Section 4.c of the
# IETF Trust's Legal Provisions Relating to IETF
# Documents (http://trustee.ietf.org/license-info).

import sys
from ipgeo_feed_validator import IPGeoFeedValidator

class IPGeoFeedValidatorTest(object):
  def __init__(self):
    self.validator = IPGeoFeedValidator()
    self.validator.SetOutputStream(None)
    self.successes = 0
    self.failures = 0

  def Run(self):
    self.TestFeedLine('# asdf', 0, 0)
    self.TestFeedLine('   ', 0, 0)
    self.TestFeedLine('', 0, 0)

    self.TestFeedLine('asdf', 1, 1)
    self.TestFeedLine('asdf,US,,,', 1, 0)
    self.TestFeedLine('aaaa::,US,,,', 0, 0)
    self.TestFeedLine('zzzz::,US', 1, 1)
    self.TestFeedLine(',US,,,', 1, 0)
    self.TestFeedLine('55.66.77', 1, 1)
    self.TestFeedLine('55.66.77.888', 1, 1)
    self.TestFeedLine('55.66.77.asdf', 1, 1)

    self.TestFeedLine('2001:db8:cafe::/48,PL,PL-MZ,,02-784', 0, 0)
    self.TestFeedLine('2001:db8:cafe::/48', 0, 1)

    self.TestFeedLine('55.66.77.88,PL', 0, 1)
    self.TestFeedLine('55.66.77.88,PL,,,', 0, 0)
    self.TestFeedLine('55.66.77.88,,,,', 0, 0)
    self.TestFeedLine('55.66.77.88,ZZ,,,', 0, 0)
    self.TestFeedLine('55.66.77.88,US,,,', 0, 0)
    self.TestFeedLine('55.66.77.88,USA,,,', 1, 0)
    self.TestFeedLine('55.66.77.88,99,,,', 1, 0)

    self.TestFeedLine('55.66.77.88,US,US-CA,,', 0, 0)
    self.TestFeedLine('55.66.77.88,US,USA-CA,,', 1, 0)
    self.TestFeedLine('55.66.77.88,USA,USA-CA,,', 2, 0)

    self.TestFeedLine('55.66.77.88,US,US-CA,Mountain View,', 0, 0)
    self.TestFeedLine('55.66.77.88,US,US-CA,Mountain View,94043',
                      0, 0)
    self.TestFeedLine('55.66.77.88,US,US-CA,Mountain View,94043,'
                      '1600 Ampthitheatre Parkway', 0, 1)

    self.TestFeedLine('55.66.77.0/24,US,,,', 0, 0)
    self.TestFeedLine('55.66.77.88/24,US,,,', 1, 0)
    self.TestFeedLine('55.66.77.88/32,US,,,', 0, 0)
    self.TestFeedLine('55.66.77/24,US,,,', 1, 0)
    self.TestFeedLine('55.66.77.0/35,US,,,', 1, 0)

    self.TestFeedLine('172.15.30.1,US,,,', 0, 0)
    self.TestFeedLine('172.28.30.1,US,,,', 1, 0)
    self.TestFeedLine('192.167.100.1,US,,,', 0, 0)
    self.TestFeedLine('192.168.100.1,US,,,', 1, 0)
    self.TestFeedLine('10.0.5.9,US,,,', 1, 0)
    self.TestFeedLine('10.0.5.0/24,US,,,', 1, 0)
    self.TestFeedLine('fc00::/48,PL,,,', 1, 0)
    self.TestFeedLine('fe00::/48,PL,,,', 0, 0)

    print ('%d tests passed, %d failed'
      % (self.successes, self.failures))

  def IsOutputLogCorrectAtSeverity(self, severity,
    expected_msg_count):
    msg_count = self.validator.CountErrors(severity)

    if msg_count != expected_msg_count:
      print ('TEST FAILED: %s\nexpected %d %s[s], observed %d\n%s\n'
         % (self.validator.line, expected_msg_count, severity,
           msg_count,
          str(self.validator.output_log[severity])))
      return False
    return True

  def IsOutputLogCorrect(self, new_errors, new_warnings):
    retval = True

    if not self.IsOutputLogCorrectAtSeverity('ERROR', new_errors):
      retval = False
    if not self.IsOutputLogCorrectAtSeverity('WARNING',
                                             new_warnings):
      retval = False

    return retval

  def TestFeedLine(self, line, warning_count, error_count):
    self.validator.output_log['WARNING'] = []
    self.validator.output_log['ERROR'] = []
    self.validator._ValidateLine(line)

    if not self.IsOutputLogCorrect(warning_count, error_count):
      self.failures += 1
      return False

    self.successes += 1
    return True


if __name__ == '__main__':
  IPGeoFeedValidatorTest().Run()

&lt;CODE ENDS&gt;</pre><a class="pilcrow" href="#section-appendix.a-5">¶</a>
</div>
</section>
<section id="section-appendix.b">
      <h2 id="name-acknowledgements">
<a class="section-name selfRef" href="#name-acknowledgements">Acknowledgements</a>
      </h2>
<p id="section-appendix.b-1">The authors would like to express their gratitude to reviewers and
      early implementors, including but not limited to <span class="contact-name">Mikael Abrahamsson</span>, <span class="contact-name">Andrew Alston</span>,
      <span class="contact-name">Ray Bellis</span>, <span class="contact-name">John Bond</span>,
      <span class="contact-name">Alissa Cooper</span>, <span class="contact-name">Andras Erdei</span>,
      <span class="contact-name">Stephen Farrell</span>, <span class="contact-name">Marco       Hogewoning</span>, <span class="contact-name">Mike Joseph</span>, <span class="contact-name">Maciej Kuzniar</span>, <span class="contact-name">George Michaelson</span>,
      <span class="contact-name">Menno Schepers</span>, <span class="contact-name">Justyna       Sidorska</span>, <span class="contact-name">Pim van Pelt</span>, and <span class="contact-name">Bjoern A. Zeeb</span>.<a class="pilcrow" href="#section-appendix.b-1">¶</a></p>
<p id="section-appendix.b-2">In particular, <span class="contact-name">Richard L. Barnes</span> and <span class="contact-name">Andy Newton</span> contributed substantial review,
      text, and advice.<a class="pilcrow" href="#section-appendix.b-2">¶</a></p>
</section>
<div id="authors-addresses">
<section id="section-appendix.c">
      <h2 id="name-authors-addresses">
<a class="section-name selfRef" href="#name-authors-addresses">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Erik Kline</span></div>
<div class="left" dir="auto"><span class="org">Loon LLC</span></div>
<div class="left" dir="auto"><span class="street-address">1600 Amphitheatre Parkway</span></div>
<div class="left" dir="auto">
<span class="locality">Mountain View</span>, <span class="region">CA</span> <span class="postal-code">94043</span>
</div>
<div class="left" dir="auto"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:ek@loon.com">ek@loon.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Krzysztof Duleba</span></div>
<div class="left" dir="auto"><span class="org">Google</span></div>
<div class="left" dir="auto"><span class="street-address">1600 Amphitheatre Parkway</span></div>
<div class="left" dir="auto">
<span class="locality">Mountain View</span>, <span class="region">CA</span> <span class="postal-code">94043</span>
</div>
<div class="left" dir="auto"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:kduleba@google.com">kduleba@google.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Zoltan Szamonek</span></div>
<div class="left" dir="auto"><span class="org">Google Switzerland GmbH</span></div>
<div class="left" dir="auto"><span class="street-address">Brandschenkestrasse 110</span></div>
<div class="left" dir="auto">CH-<span class="postal-code">8002</span> <span class="locality">Zürich</span>
</div>
<div class="left" dir="auto"><span class="country-name">Switzerland</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:zszami@google.com">zszami@google.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Stefan Moser</span></div>
<div class="left" dir="auto"><span class="org">Google Switzerland GmbH</span></div>
<div class="left" dir="auto"><span class="street-address">Brandschenkestrasse 110</span></div>
<div class="left" dir="auto">CH-<span class="postal-code">8002</span> <span class="locality">Zürich</span>
</div>
<div class="left" dir="auto"><span class="country-name">Switzerland</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:smoser@google.com">smoser@google.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Warren Kumari</span></div>
<div class="left" dir="auto"><span class="org">Google</span></div>
<div class="left" dir="auto"><span class="street-address">1600 Amphitheatre Parkway</span></div>
<div class="left" dir="auto">
<span class="locality">Mountain View</span>, <span class="region">CA</span> <span class="postal-code">94043</span>
</div>
<div class="left" dir="auto"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:warren@kumari.net">warren@kumari.net</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>


</body></html>