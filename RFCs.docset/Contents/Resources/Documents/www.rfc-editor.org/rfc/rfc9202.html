<!DOCTYPE html>
<html class="RFC" lang="en"><head>
<meta charset="utf-8"/>
<meta content="Common,Latin" name="scripts"/>
<meta content="initial-scale=1.0" name="viewport"/>
<title>RFC 9202: Datagram Transport Layer Security (DTLS) Profile for Authentication and Authorization for Constrained Environments (ACE)</title>
<meta content="Stefanie Gerdes" name="author"/>
<meta content="Olaf Bergmann" name="author"/>
<meta content="Carsten Bormann" name="author"/>
<meta content="GÃ¶ran Selander" name="author"/>
<meta content="Ludwig Seitz" name="author"/>
<meta content="
       This specification defines a profile of the Authentication and Authorization for
      Constrained Environments (ACE) framework that allows constrained
      servers to delegate client authentication and authorization.  The protocol
      relies on DTLS version 1.2 or later for communication security between entities in a
      constrained network using either raw public keys or pre-shared keys. A
      resource-constrained server can use this protocol to delegate
      management of authorization information to a trusted host with less-severe 
      limitations regarding processing power and memory. 
    " name="description"/>
<meta content="xml2rfc 3.14.2" name="generator"/>
<meta content="Internet of Things (IoT)" name="keyword"/>
<meta content="Internet of Things" name="keyword"/>
<meta content="IOT" name="keyword"/>
<meta content="OAuth" name="keyword"/>
<meta content="Access Token" name="keyword"/>
<meta content="9202" name="rfc.number"/>
<!-- Generator version information:
  xml2rfc 3.14.2
    Python 3.9.13
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.1
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 3.1.2
    kitchen 1.2.6
    lxml 4.9.0
    MarkupSafe 2.1.1
    pycountry 22.3.5
    PyYAML 6.0
    requests 2.28.0
    setuptools 44.1.1
    six 1.16.0
    weasyprint 56.1
-->
<link href="rfc9202.xml" rel="alternate" type="application/rfc+xml"/>
<link href="#copyright" rel="license"/>
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  pre.breakable {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css"/>
<link href="https://dx.doi.org/10.17487/rfc9202" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <link href="https://datatracker.ietf.org/doc/draft-ietf-ace-dtls-authorize-18" rel="prev"/>
  </head>
<body>
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 9202</td>
<td class="center">DTLS Profile for ACE</td>
<td class="right">August 2022</td>
</tr></thead>
<tfoot><tr>
<td class="left">Gerdes, et al.</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div class="document-information" id="external-metadata"></div>
<div class="document-information" id="internal-metadata">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a class="eref" href="https://www.rfc-editor.org/rfc/rfc9202">9202</a></dd>
<dt class="label-category">Category:</dt>
<dd class="category">Standards Track</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time class="published" datetime="2022-08">August 2022</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">S. Gerdes</div>
<div class="org">UniversitÃ¤t Bremen TZI</div>
</div>
<div class="author">
      <div class="author-name">O. Bergmann</div>
<div class="org">UniversitÃ¤t Bremen TZI</div>
</div>
<div class="author">
      <div class="author-name">C. Bormann</div>
<div class="org">UniversitÃ¤t Bremen TZI</div>
</div>
<div class="author">
      <div class="author-name">G. Selander</div>
<div class="org">Ericsson AB</div>
</div>
<div class="author">
      <div class="author-name">L. Seitz</div>
<div class="org">Combitech</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 9202</h1>
<h1 id="title">Datagram Transport Layer Security (DTLS) Profile for Authentication and Authorization for Constrained Environments (ACE)</h1>
<section id="section-abstract">
      <h2 id="abstract"><a class="selfRef" href="#abstract">Abstract</a></h2>
<p id="section-abstract-1">This specification defines a profile of the Authentication and Authorization for
      Constrained Environments (ACE) framework that allows constrained
      servers to delegate client authentication and authorization.  The protocol
      relies on DTLS version 1.2 or later for communication security between entities in a
      constrained network using either raw public keys or pre-shared keys. A
      resource-constrained server can use this protocol to delegate
      management of authorization information to a trusted host with less-severe 
      limitations regarding processing power and memory.<a class="pilcrow" href="#section-abstract-1">Â¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a class="section-name selfRef" href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This is an Internet Standards Track document.<a class="pilcrow" href="#section-boilerplate.1-1">Â¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.<a class="pilcrow" href="#section-boilerplate.1-2">Â¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc9202">https://www.rfc-editor.org/info/rfc9202</a></span>.<a class="pilcrow" href="#section-boilerplate.1-3">Â¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a class="section-name selfRef" href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2022 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a class="pilcrow" href="#section-boilerplate.2-1">Â¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a class="pilcrow" href="#section-boilerplate.2-2">Â¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a class="toplink" href="#" onclick="scroll(0,0)">â²</a><h2 id="name-table-of-contents">
<a class="section-name selfRef" href="#name-table-of-contents">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p class="keepWithNext" id="section-toc.1-1.1.1"><a class="xref" href="#section-1">1</a>.Â Â <a class="xref" href="#name-introduction">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p class="keepWithNext" id="section-toc.1-1.1.2.1.1"><a class="xref" href="#section-1.1">1.1</a>.Â Â <a class="xref" href="#name-terminology">Terminology</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p class="keepWithNext" id="section-toc.1-1.2.1"><a class="xref" href="#section-2">2</a>.Â Â <a class="xref" href="#name-protocol-overview">Protocol Overview</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a class="xref" href="#section-3">3</a>.Â Â <a class="xref" href="#name-protocol-flow">Protocol Flow</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a class="xref" href="#section-3.1">3.1</a>.Â Â <a class="xref" href="#name-communication-between-the-c">Communication between the Client and the Authorization Server</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a class="xref" href="#section-3.2">3.2</a>.Â Â <a class="xref" href="#name-raw-public-key-mode">Raw Public Key Mode</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.1">
                    <p id="section-toc.1-1.3.2.2.2.1.1"><a class="xref" href="#section-3.2.1">3.2.1</a>.Â Â <a class="xref" href="#name-access-token-retrieval-from">Access Token Retrieval from the Authorization Server</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.2">
                    <p id="section-toc.1-1.3.2.2.2.2.1"><a class="xref" href="#section-3.2.2">3.2.2</a>.Â Â <a class="xref" href="#name-dtls-channel-setup-between-">DTLS Channel Setup between the Client and Resource Server</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a class="xref" href="#section-3.3">3.3</a>.Â Â <a class="xref" href="#name-pre-shared-key-mode">Pre-shared Key Mode</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.1">
                    <p id="section-toc.1-1.3.2.3.2.1.1"><a class="xref" href="#section-3.3.1">3.3.1</a>.Â Â <a class="xref" href="#name-access-token-retrieval-from-">Access Token Retrieval from the Authorization Server</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.2">
                    <p id="section-toc.1-1.3.2.3.2.2.1"><a class="xref" href="#section-3.3.2">3.3.2</a>.Â Â <a class="xref" href="#name-dtls-channel-setup-between-t">DTLS Channel Setup between the Client and Resource Server</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a class="xref" href="#section-3.4">3.4</a>.Â Â <a class="xref" href="#name-resource-access">Resource Access</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a class="xref" href="#section-4">4</a>.Â Â <a class="xref" href="#name-dynamic-update-of-authoriza">Dynamic Update of Authorization Information</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a class="xref" href="#section-5">5</a>.Â Â <a class="xref" href="#name-token-expiration">Token Expiration</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a class="xref" href="#section-6">6</a>.Â Â <a class="xref" href="#name-secure-communication-with-a">Secure Communication with an Authorization Server</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a class="xref" href="#section-7">7</a>.Â Â <a class="xref" href="#name-security-considerations">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a class="xref" href="#section-7.1">7.1</a>.Â Â <a class="xref" href="#name-reuse-of-existing-sessions">Reuse of Existing Sessions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a class="xref" href="#section-7.2">7.2</a>.Â Â <a class="xref" href="#name-multiple-access-tokens">Multiple Access Tokens</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a class="xref" href="#section-7.3">7.3</a>.Â Â <a class="xref" href="#name-out-of-band-configuration">Out-of-Band Configuration</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a class="xref" href="#section-8">8</a>.Â Â <a class="xref" href="#name-privacy-considerations">Privacy Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a class="xref" href="#section-9">9</a>.Â Â <a class="xref" href="#name-iana-considerations">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a class="xref" href="#section-10">10</a>.Â <a class="xref" href="#name-references">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a class="xref" href="#section-10.1">10.1</a>.Â Â <a class="xref" href="#name-normative-references">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a class="xref" href="#section-10.2">10.2</a>.Â Â <a class="xref" href="#name-informative-references">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a class="xref" href="#appendix-A"></a><a class="xref" href="#name-acknowledgments">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a class="xref" href="#appendix-B"></a><a class="xref" href="#name-authors-addresses">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a class="section-number selfRef" href="#section-1">1. </a><a class="section-name selfRef" href="#name-introduction">Introduction</a>
      </h2>
<p id="section-1-1">This specification defines a profile of the ACE framework
<span>[<a class="xref" href="#RFC9200">RFC9200</a>]</span>.  In this profile, a client (C) and a
resource server (RS) use the Constrained Application Protocol (CoAP) <span>[<a class="xref" href="#RFC7252">RFC7252</a>]</span> over DTLS version 1.2 <span>[<a class="xref" href="#RFC6347">RFC6347</a>]</span>
to communicate. This specification
uses DTLS 1.2 terminology, but later versions such as DTLS 1.3 <span>[<a class="xref" href="#RFC9147">RFC9147</a>]</span> can be
used instead. The client obtains an access token bound to a key
(the proof-of-possession (PoP) key) from an authorization server (AS) to prove
its authorization to access protected resources hosted by the resource
server. Also, the client and the resource server are provided by the
authorization server with the necessary keying material to establish a
DTLS session. The communication between the client and authorization
server may also be secured with DTLS.  This specification supports
DTLS with raw public keys (RPKs) <span>[<a class="xref" href="#RFC7250">RFC7250</a>]</span> and with pre-shared keys
(PSKs) <span>[<a class="xref" href="#RFC4279">RFC4279</a>]</span>. How token introspection <span>[<a class="xref" href="#RFC7662">RFC7662</a>]</span> is performed
between the RS and AS is out of scope for this specification.<a class="pilcrow" href="#section-1-1">Â¶</a></p>
<p id="section-1-2">The ACE framework requires that the client and server mutually
authenticate each other before any application data is exchanged.
DTLS enables mutual authentication if both the client and server prove
their ability to use certain keying material in the DTLS handshake.
The authorization server assists in this process on the server side by
incorporating keying material (or information about keying material)
into the access token, which is considered a proof-of-possession
token.<a class="pilcrow" href="#section-1-2">Â¶</a></p>
<p id="section-1-3">In the RPK mode, the client proves that it can use the RPK bound to
the token and the server shows that it can use a certain RPK.<a class="pilcrow" href="#section-1-3">Â¶</a></p>
<p id="section-1-4">The resource server needs access to the token in order to complete
this exchange.  For the RPK mode, the client must upload the access
token to the resource server before initiating the handshake, as
described in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9200#section-5.10.1">Section 5.10.1</a> of the ACE framework [<a class="xref" href="#RFC9200">RFC9200</a>]</span>.<a class="pilcrow" href="#section-1-4">Â¶</a></p>
<p id="section-1-5">In the PSK mode, the client and server show with the DTLS handshake that
they can use the keying material that is bound to the access token.
To transfer the access token from the client to the resource server,
the <code>psk_identity</code> parameter in the DTLS PSK handshake may be used
instead of uploading the token prior to the handshake.<a class="pilcrow" href="#section-1-5">Â¶</a></p>
<p id="section-1-6">As recommended in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9200#section-5.8">Section 5.8</a> of [<a class="xref" href="#RFC9200">RFC9200</a>]</span>, this
specification uses Concise Binary Object Representation (CBOR) web tokens to convey claims within an access
token issued by the server.  While other formats could be used as well,
those are out of scope for this document.<a class="pilcrow" href="#section-1-6">Â¶</a></p>
<div id="terminology">
<section id="section-1.1">
        <h3 id="name-terminology">
<a class="section-number selfRef" href="#section-1.1">1.1. </a><a class="section-name selfRef" href="#name-terminology">Terminology</a>
        </h3>
<p id="section-1.1-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>",
"<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>", "<span class="bcp14">MAY</span>", and
"<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as described in BCPÂ 14 <span>[<a class="xref" href="#RFC2119">RFC2119</a>]</span> <span>[<a class="xref" href="#RFC8174">RFC8174</a>]</span> when, and only when, they appear in all
capitals, as shown here.<a class="pilcrow" href="#section-1.1-1">Â¶</a></p>
<p id="section-1.1-2">Readers are expected to be familiar with the terms and concepts
described in <span>[<a class="xref" href="#RFC9200">RFC9200</a>]</span> and <span>[<a class="xref" href="#RFC9201">RFC9201</a>]</span>.<a class="pilcrow" href="#section-1.1-2">Â¶</a></p>
<p id="section-1.1-3">The authorization information (authz-info) resource refers to the authorization information endpoint, as specified in <span>[<a class="xref" href="#RFC9200">RFC9200</a>]</span>.
The term <code>claim</code> is used in this document with the same semantics
as in <span>[<a class="xref" href="#RFC9200">RFC9200</a>]</span>, i.e., it denotes information carried
in the access token or returned from introspection.<a class="pilcrow" href="#section-1.1-3">Â¶</a></p>
<p id="section-1.1-4">Throughout this document, examples for CBOR data items are expressed in
           CBOR extended diagnostic notation as defined in
           <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8949#section-8">Section 8</a> of [<a class="xref" href="#RFC8949">RFC8949</a>]</span> and
           <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8610#appendix-G">Appendix G</a> of [<a class="xref" href="#RFC8610">RFC8610</a>]</span>
           ("diagnostic notation"), unless noted otherwise.
           We often use diagnostic notation comments to provide
           a textual representation of the numeric parameter names and values.<a class="pilcrow" href="#section-1.1-4">Â¶</a></p>
</section>
</div>
</section>
</div>
<div id="overview">
<section id="section-2">
      <h2 id="name-protocol-overview">
<a class="section-number selfRef" href="#section-2">2. </a><a class="section-name selfRef" href="#name-protocol-overview">Protocol Overview</a>
      </h2>
<p id="section-2-1">The CoAP-DTLS profile for ACE specifies the transfer of authentication
information and, if necessary, authorization information between the
client (C) and the resource server (RS) during setup of a DTLS session
for CoAP messaging. It also specifies how the client can use CoAP over
DTLS to retrieve an access token from the authorization server (AS)
for a protected resource hosted on the resource server.  As specified
in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9200#section-6.7">Section 6.7</a> of [<a class="xref" href="#RFC9200">RFC9200</a>]</span>, use of DTLS for one or
both of these interactions is completely independent.<a class="pilcrow" href="#section-2-1">Â¶</a></p>
<p id="section-2-2">This profile requires the client to retrieve an access token for the
protected resource(s) it wants to access on the resource server, as
specified in <span>[<a class="xref" href="#RFC9200">RFC9200</a>]</span>. <a class="xref" href="#at-retrieval">Figure 1</a> shows the
typical message flow in this scenario (messages in square brackets are
optional):<a class="pilcrow" href="#section-2-2">Â¶</a></p>
<span id="name-retrieving-an-access-token"></span><div id="at-retrieval">
<figure id="figure-1">
        <div class="alignLeft art-text artwork" id="section-2-3.1">
<pre>   C                                RS                   AS
   | [---- Resource Request ------&gt;]|                     |
   |                                |                     |
   | [&lt;-AS Request Creation Hints-] |                     |
   |                                |                     |
   | ------- Token Request  ----------------------------&gt; |
   |                                |                     |
   | &lt;---------------------------- Access Token --------- |
   |                               + Access Information   |
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-1">Figure 1</a>:
<a class="selfRef" href="#name-retrieving-an-access-token">Retrieving an Access Token</a>
        </figcaption></figure>
</div>
<p id="section-2-4">To determine the authorization server in charge of a resource hosted
at the resource server, the client can send an initial Unauthorized
Resource Request message to the resource server. The resource server
then denies the request and sends an AS Request Creation Hints message
containing the address of its authorization server back to the client,
as specified in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9200#section-5.3">Section 5.3</a> of [<a class="xref" href="#RFC9200">RFC9200</a>]</span>.<a class="pilcrow" href="#section-2-4">Â¶</a></p>
<p id="section-2-5">Once the client knows the authorization server's address, it can send
an access token request to the token endpoint at the authorization
server, as specified in <span>[<a class="xref" href="#RFC9200">RFC9200</a>]</span>. As the access
token request and the response may contain confidential data,
the communication between the client and the authorization server must
be confidentiality protected and ensure authenticity. The client is
expected to have been registered at the authorization server, as
outlined in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9200#section-4">Section 4</a> of [<a class="xref" href="#RFC9200">RFC9200</a>]</span>.<a class="pilcrow" href="#section-2-5">Â¶</a></p>
<p id="section-2-6">The access token returned by the authorization server can then be used
by the client to establish a new DTLS session with the resource
server. When the client intends to use an asymmetric proof-of-possession key in the
DTLS handshake with the resource server, the client <span class="bcp14">MUST</span> upload the
access token to the authz-info resource, i.e., the authz-info endpoint,
on the resource server before
starting the DTLS handshake, as described in
<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9200#section-5.10.1">Section 5.10.1</a> of [<a class="xref" href="#RFC9200">RFC9200</a>]</span>. In case the client uses a symmetric proof-of-possession
key in the DTLS handshake, the procedure above <span class="bcp14">MAY</span> be used, or alternatively
 the access token <span class="bcp14">MAY</span> instead be transferred in the
DTLS ClientKeyExchange message (see <a class="xref" href="#psk-dtls-channel">Section 3.3.2</a>).
In any case, DTLS <span class="bcp14">MUST</span> be used in a mode that provides replay
protection.<a class="pilcrow" href="#section-2-6">Â¶</a></p>
<p id="section-2-7"><a class="xref" href="#protocol-overview">Figure 2</a> depicts the common protocol flow for the DTLS
profile after the client has retrieved the access token from the
authorization server (AS).<a class="pilcrow" href="#section-2-7">Â¶</a></p>
<span id="name-protocol-overview-2"></span><div id="protocol-overview">
<figure id="figure-2">
        <div class="alignLeft art-text artwork" id="section-2-8.1">
<pre>   C                            RS                   AS
   | [--- Access Token ------&gt;] |                     |
   |                            |                     |
   | &lt;== DTLS channel setup ==&gt; |                     |
   |                            |                     |
   | == Authorized Request ===&gt; |                     |
   |                            |                     |
   | &lt;=== Protected Resource == |                     |
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-2">Figure 2</a>:
<a class="selfRef" href="#name-protocol-overview-2">Protocol Overview</a>
        </figcaption></figure>
</div>
</section>
</div>
<div id="protocol-flow">
<section id="section-3">
      <h2 id="name-protocol-flow">
<a class="section-number selfRef" href="#section-3">3. </a><a class="section-name selfRef" href="#name-protocol-flow">Protocol Flow</a>
      </h2>
<p id="section-3-1">The following sections specify how CoAP is used to interchange
access-related data between the resource server, the client, and the
authorization server so that the authorization server can provide the
client and the resource server with sufficient information to
establish a secure channel and convey authorization information
specific for this communication relationship to the resource server.<a class="pilcrow" href="#section-3-1">Â¶</a></p>
<p id="section-3-2"><a class="xref" href="#C-AS-comm">Section 3.1</a> describes how the communication between
      the client (C) and the authorization server (AS) must be secured.
      Depending on the CoAP security mode used (see also
      <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc7252#section-9">Section 9</a> of [<a class="xref" href="#RFC7252">RFC7252</a>]</span>),
      the client-to-AS request, AS-to-client response, and DTLS session
      establishment carry slightly different information. <a class="xref" href="#rpk-mode">Section 3.2</a> addresses the use of raw public keys, while <a class="xref" href="#psk-mode">Section 3.3</a> defines how pre-shared keys are used in this profile.<a class="pilcrow" href="#section-3-2">Â¶</a></p>
<div id="C-AS-comm">
<section id="section-3.1">
        <h3 id="name-communication-between-the-c">
<a class="section-number selfRef" href="#section-3.1">3.1. </a><a class="section-name selfRef" href="#name-communication-between-the-c">Communication between the Client and the Authorization Server</a>
        </h3>
<p id="section-3.1-1">To retrieve an access token for the resource that the client wants to
 access, the client requests an access token from the authorization
 server. Before the client can request the access token, the client and
 the authorization server <span class="bcp14">MUST</span> establish
 a secure communication channel. This profile assumes that the keying
 material to secure this communication channel has securely been obtained
 either by manual configuration or in an automated provisioning process.
 The following requirements, in alignment with <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9200#section-6.5">Section 6.5</a> of [<a class="xref" href="#RFC9200">RFC9200</a>]</span>, therefore must be met:<a class="pilcrow" href="#section-3.1-1">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-2.1">The client <span class="bcp14">MUST</span> securely have obtained keying material to
   communicate with the authorization server.<a class="pilcrow" href="#section-3.1-2.1">Â¶</a>
</li>
          <li class="normal" id="section-3.1-2.2">Furthermore, the client <span class="bcp14">MUST</span> verify that the authorization
   server is authorized to provide access tokens (including authorization
   information) about the resource server to the client and that
   this authorization information about the authorization server is still valid.<a class="pilcrow" href="#section-3.1-2.2">Â¶</a>
</li>
          <li class="normal" id="section-3.1-2.3">Also, the authorization server <span class="bcp14">MUST</span> securely have obtained keying
   material for the client and obtained authorization rules approved
   by the resource owner (RO) concerning the client and the resource
   server that relate to this keying material.<a class="pilcrow" href="#section-3.1-2.3">Â¶</a>
</li>
        </ul>
<p id="section-3.1-3">The client and the authorization server <span class="bcp14">MUST</span> use their respective
 keying material for all exchanged messages. How the security
 association between the client and the authorization server is
 bootstrapped is not part of this document. The client and the
 authorization server must ensure the confidentiality, integrity, and
 authenticity of all exchanged messages within the ACE protocol.<a class="pilcrow" href="#section-3.1-3">Â¶</a></p>
<p id="section-3.1-4"><a class="xref" href="#as-commsec">Section 6</a> specifies how communication with the authorization server is secured.<a class="pilcrow" href="#section-3.1-4">Â¶</a></p>
</section>
</div>
<div id="rpk-mode">
<section id="section-3.2">
        <h3 id="name-raw-public-key-mode">
<a class="section-number selfRef" href="#section-3.2">3.2. </a><a class="section-name selfRef" href="#name-raw-public-key-mode">Raw Public Key Mode</a>
        </h3>
<p id="section-3.2-1">When the client uses raw public key authentication, the procedure is as
described in the following.<a class="pilcrow" href="#section-3.2-1">Â¶</a></p>
<div id="access-token-retrieval-from-the-authorization-server">
<section id="section-3.2.1">
          <h4 id="name-access-token-retrieval-from">
<a class="section-number selfRef" href="#section-3.2.1">3.2.1. </a><a class="section-name selfRef" href="#name-access-token-retrieval-from">Access Token Retrieval from the Authorization Server</a>
          </h4>
<p id="section-3.2.1-1">After the client and the authorization server mutually authenticated each other and validated each
other's authorization, the client sends a token request to the authorization server's token endpoint.
The client <span class="bcp14">MUST</span> add a <code>req_cnf</code> object carrying either its raw public key
or a unique identifier for a public key that it has previously made
known to the authorization server. It is <span class="bcp14">RECOMMENDED</span> that
the client uses DTLS with the same keying material to secure the
communication with the authorization server, proving possession of the key
as part of the token request. Other mechanisms for proving possession of
the key may be defined in the future.<a class="pilcrow" href="#section-3.2.1-1">Â¶</a></p>
<p id="section-3.2.1-2">An example access token request from the client to the authorization
server is depicted in <a class="xref" href="#rpk-authorization-message-example">Figure 3</a>.<a class="pilcrow" href="#section-3.2.1-2">Â¶</a></p>
<span id="name-access-token-request-exampl"></span><div id="rpk-authorization-message-example">
<figure id="figure-3">
            <div id="section-3.2.1-3.1">
<pre class="lang-cbor-diag sourcecode">   POST coaps://as.example.com/token
   Content-Format: application/ace+cbor
   Payload:
   {
     / grant_type / 33 : / client_credentials / 2,
     / audience /    5 : "tempSensor4711",
     / req_cnf /     4 : {
       / COSE_Key / 1 : {
         / kty /  1 : / EC2 /   2,
         / crv / -1 : / P-256 / 1,
         / x /   -2 : h'e866c35f4c3c81bb96a1/.../',
         / y /   -3 : h'2e25556be097c8778a20/.../'
       }
     }
   }
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-3">Figure 3</a>:
<a class="selfRef" href="#name-access-token-request-exampl">Access Token Request Example for RPK Mode</a>
            </figcaption></figure>
</div>
<p id="section-3.2.1-4">The example shows an access token request for the resource identified
by the string "tempSensor4711" on the authorization server
using a raw public key.<a class="pilcrow" href="#section-3.2.1-4">Â¶</a></p>
<p id="section-3.2.1-5">The authorization server <span class="bcp14">MUST</span> check if the client that it communicates
with is associated with the RPK in the <code>req_cnf</code> parameter before
issuing an access token to it.  If the authorization server determines
that the request is to be authorized according to the respective
authorization rules, it generates an access token response for the
client. The access token <span class="bcp14">MUST</span> be bound to the RPK of the client by
means of the <code>cnf</code> claim.<a class="pilcrow" href="#section-3.2.1-5">Â¶</a></p>
<p id="section-3.2.1-6">The response <span class="bcp14">MUST</span> contain an <code>ace_profile</code> parameter if
   the <code>ace_profile</code> parameter in the request is empty and <span class="bcp14">MAY</span>
   contain this parameter otherwise (see 
   <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9200#section-5.8.2">Section 5.8.2</a> of [<a class="xref" href="#RFC9200">RFC9200</a>]</span>). This parameter is set
   to <code>coap_dtls</code> to
   indicate that this profile <span class="bcp14">MUST</span> be used for communication between the
   client and the resource server. The response
   also contains an access token with information for the resource server
   about the client's public key. The authorization server <span class="bcp14">MUST</span> return
   in its response the parameter <code>rs_cnf</code> unless it is certain that the
   client already knows the public key of the resource server.  The
   authorization server <span class="bcp14">MUST</span> ascertain that the RPK specified in
   <code>rs_cnf</code> belongs to the resource server that the client wants to communicate
   with. The authorization server <span class="bcp14">MUST</span> protect the integrity of the
   access token such that the resource server can detect unauthorized
   changes.  If the access token contains confidential data, the
   authorization server <span class="bcp14">MUST</span> also protect the confidentiality of the
   access token.<a class="pilcrow" href="#section-3.2.1-6">Â¶</a></p>
<p id="section-3.2.1-7">The client <span class="bcp14">MUST</span> ascertain that the access token response belongs
   to a certain, previously sent access token request, as the request may specify the
   resource server with which the client wants to communicate.<a class="pilcrow" href="#section-3.2.1-7">Â¶</a></p>
<p id="section-3.2.1-8">An example access token response from the authorization server to the client
   is depicted in <a class="xref" href="#rpk-authorization-response-example">Figure 4</a>. Here, the
   contents of the <code>access_token</code> claim have been truncated to improve
   readability. For the client, the response comprises Access Information
   that contains the server's public key in the <code>rs_cnf</code> parameter.
   Caching proxies process the Max-Age option in the CoAP response, which
   has a default value of 60 seconds (<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc7252#section-5.6.1">Section 5.6.1</a> of [<a class="xref" href="#RFC7252">RFC7252</a>]</span>).
   The authorization server <span class="bcp14">SHOULD</span>
   adjust the Max-Age option such that it does not exceed the
   <code>expires_in</code> parameter to avoid stale responses.<a class="pilcrow" href="#section-3.2.1-8">Â¶</a></p>
<span id="name-access-token-response-examp"></span><div id="rpk-authorization-response-example">
<figure id="figure-4">
            <div id="section-3.2.1-9.1">
<pre class="lang-cbor-diag sourcecode">   2.01 Created
   Content-Format: application/ace+cbor
   Max-Age: 3560
   Payload:
   {
     / access_token / 1 : b64'SlAV32hk'/...
      (remainder of CWT omitted for brevity;
      CWT contains the client's RPK in the cnf claim)/,
     / expires_in /  2 : 3600,
     / rs_cnf /     41 : {
       / COSE_Key /  1 : {
         / kty /  1 : / EC2 /   2,
         / crv / -1 : / P-256 / 1,
         / x /   -2 : h'd7cc072de2205bdc1537/.../',
         / y /   -3 : h'f95e1d4b851a2cc80fff/.../'
       }
     }
   }
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-4">Figure 4</a>:
<a class="selfRef" href="#name-access-token-response-examp">Access Token Response Example for RPK Mode</a>
            </figcaption></figure>
</div>
</section>
</div>
<div id="rpk-dtls-channel">
<section id="section-3.2.2">
          <h4 id="name-dtls-channel-setup-between-">
<a class="section-number selfRef" href="#section-3.2.2">3.2.2. </a><a class="section-name selfRef" href="#name-dtls-channel-setup-between-">DTLS Channel Setup between the Client and Resource Server</a>
          </h4>
<p id="section-3.2.2-1">Before the client initiates the DTLS handshake with the resource
server, the client <span class="bcp14">MUST</span> send a <code>POST</code> request containing the obtained
access token to the authz-info resource hosted by the resource
server. After the client receives a confirmation that the resource
server has accepted the access token, it proceeds to establish a
new DTLS channel with the resource server.  The client <span class="bcp14">MUST</span> use its
correct public key in the DTLS handshake. If the authorization server
has specified a <code>cnf</code> field in the access token response, the client
<span class="bcp14">MUST</span> use this key. Otherwise, the client <span class="bcp14">MUST</span> use the public key that
it specified in the <code>req_cnf</code> of the access token request. The client
<span class="bcp14">MUST</span> specify this public key in the SubjectPublicKeyInfo structure of
the DTLS handshake, as described in <span>[<a class="xref" href="#RFC7250">RFC7250</a>]</span>.<a class="pilcrow" href="#section-3.2.2-1">Â¶</a></p>
<p id="section-3.2.2-2">If the client does not have the keying material belonging to the
public key, the client <span class="bcp14">MAY</span> try to send an access token request to the
AS, where the client specifies its public key in the <code>req_cnf</code> parameter. If
the AS still specifies a public key in the response that the client
does not have, the client <span class="bcp14">SHOULD</span> re-register with the authorization
server to establish a new client public key. This process is out of
scope for this document.<a class="pilcrow" href="#section-3.2.2-2">Â¶</a></p>
<p id="section-3.2.2-3">To be consistent with <span>[<a class="xref" href="#RFC7252">RFC7252</a>]</span>, which allows for shortened Message Authentication Code (MAC) tags
in constrained environments,
an implementation that supports the RPK mode of this profile <span class="bcp14">MUST</span> at
least support the cipher suite
TLS_ECDHE_ECDSA_WITH_AES_128_CCM_8 <span>[<a class="xref" href="#RFC7251">RFC7251</a>]</span>.
As discussed in <span>[<a class="xref" href="#RFC7748">RFC7748</a>]</span>, new Elliptic Curve Cryptography (ECC)
  curves have been defined recently that are considered superior to 
  the so-called NIST curves. Implementations of this profile <span class="bcp14">MUST</span> therefore
  implement support for curve25519 (cf.Â <span>[<a class="xref" href="#RFC8032">RFC8032</a>]</span>, <span>[<a class="xref" href="#RFC8422">RFC8422</a>]</span>),
  as this curve is said to be efficient and less dangerous,
  regarding implementation errors, than the secp256r1 curve mandated in
  <span>[<a class="xref" href="#RFC7252">RFC7252</a>]</span>.<a class="pilcrow" href="#section-3.2.2-3">Â¶</a></p>
<p id="section-3.2.2-4">The resource server <span class="bcp14">MUST</span> check if the access token is still valid, if
the resource server is the intended destination (i.e., the audience)
of the token, and if the token was issued by an authorized
authorization server (see also
<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9200#section-5.10.1.1">Section 5.10.1.1</a> of [<a class="xref" href="#RFC9200">RFC9200</a>]</span>).
The access token is constructed by the
authorization server such that the resource server can associate the
access token with the client's public key.  The <code>cnf</code> claim <span class="bcp14">MUST</span>
contain either the client's RPK or, if the key is already known by the
resource server (e.g., from previous communication), a reference to
this key. If the authorization server has no certain knowledge that
the client's key is already known to the resource server, the client's
public key <span class="bcp14">MUST</span> be included in the access token's <code>cnf</code> parameter. If
CBOR web tokens <span>[<a class="xref" href="#RFC8392">RFC8392</a>]</span> are used (as recommended in
<span>[<a class="xref" href="#RFC9200">RFC9200</a>]</span>), keys <span class="bcp14">MUST</span> be encoded as specified in
<span>[<a class="xref" href="#RFC8747">RFC8747</a>]</span>. A resource server <span class="bcp14">MUST</span> have the capacity to store one
access token for every proof-of-possession key of every authorized client.<a class="pilcrow" href="#section-3.2.2-4">Â¶</a></p>
<p id="section-3.2.2-5">The raw public key used in the DTLS handshake with the client <span class="bcp14">MUST</span>
belong to the resource server. If the resource server has several raw
public keys, it needs to determine which key to use. The authorization
server can help with this decision by including a <code>cnf</code> parameter in
the access token that is associated with this communication.  In this
case, the resource server <span class="bcp14">MUST</span> use the information from the <code>cnf</code>
field to select the proper keying material.<a class="pilcrow" href="#section-3.2.2-5">Â¶</a></p>
<p id="section-3.2.2-6">Thus, the handshake only finishes if the client and the resource
server are able to use their respective keying material.<a class="pilcrow" href="#section-3.2.2-6">Â¶</a></p>
</section>
</div>
</section>
</div>
<div id="psk-mode">
<section id="section-3.3">
        <h3 id="name-pre-shared-key-mode">
<a class="section-number selfRef" href="#section-3.3">3.3. </a><a class="section-name selfRef" href="#name-pre-shared-key-mode">Pre-shared Key Mode</a>
        </h3>
<p id="section-3.3-1">When the client uses pre-shared key authentication, the procedure is
as described in the following.<a class="pilcrow" href="#section-3.3-1">Â¶</a></p>
<div id="access-token-retrieval-from-the-authorization-server-1">
<section id="section-3.3.1">
          <h4 id="name-access-token-retrieval-from-">
<a class="section-number selfRef" href="#section-3.3.1">3.3.1. </a><a class="section-name selfRef" href="#name-access-token-retrieval-from-">Access Token Retrieval from the Authorization Server</a>
          </h4>
<p id="section-3.3.1-1">To retrieve an access token for the resource that the client wants to
access, the client <span class="bcp14">MAY</span> include a <code>req_cnf</code> object carrying an identifier
for a symmetric key in its access token request to the authorization
server.  This identifier can be used by the authorization server to
determine the shared secret to construct the proof-of-possession
token.  The authorization server <span class="bcp14">MUST</span> check if the identifier refers
to a symmetric key that was previously generated by the authorization
server as a shared secret for the communication between this client
and the resource server. If no such symmetric key was found, the
authorization server <span class="bcp14">MUST</span> generate a new symmetric key that is
returned in its response to the client.<a class="pilcrow" href="#section-3.3.1-1">Â¶</a></p>
<p id="section-3.3.1-2">The authorization server <span class="bcp14">MUST</span> determine the authorization rules
   for the client it communicates with, as defined by the resource owner, and
   generate the access token accordingly.  If the authorization server
   authorizes the client, it returns an AS-to-client response. If the
   <code>ace_profile</code> parameter is present, it is set to <code>coap_dtls</code>. The
   authorization server <span class="bcp14">MUST</span> ascertain that the access token is
   generated for the resource server that the client wants to communicate
   with. Also, the authorization server <span class="bcp14">MUST</span> protect the integrity of
   the access token to ensure that the resource server can detect
   unauthorized changes.  If the token contains confidential data, such as
   the symmetric key, the confidentiality of the token <span class="bcp14">MUST</span> also be
   protected. Depending on the requested token type and algorithm in the
   access token request, the authorization server adds Access Information
   to the response that provides the client with sufficient information
   to set up a DTLS channel with the resource server. The authorization
   server adds a <code>cnf</code> parameter to the Access Information carrying a
   <code>COSE_Key</code> object that informs the client about the shared secret that
   is to be used between the client and the resource server. To convey
   the same secret to the resource server, the authorization server
   can include it directly in the access token by means of the <code>cnf</code>
   claim or provide sufficient information to enable the resource
   server to derive the shared secret from the access token. As an
   alternative, the resource server <span class="bcp14">MAY</span> use token introspection to
   retrieve the keying material for this access token directly from the
   authorization server.<a class="pilcrow" href="#section-3.3.1-2">Â¶</a></p>
<p id="section-3.3.1-3">An example access token request for an access token with a symmetric
proof-of-possession key is illustrated in <a class="xref" href="#at-request">Figure 5</a>.<a class="pilcrow" href="#section-3.3.1-3">Â¶</a></p>
<span id="name-example-access-token-reques"></span><div id="at-request">
<figure id="figure-5">
            <div id="section-3.3.1-4.1">
<pre class="lang-cbor-diag sourcecode">   POST coaps://as.example.com/token
   Content-Format: application/ace+cbor
   Payload:
   {
     / audience / 5 : "smokeSensor1807"
   }
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-5">Figure 5</a>:
<a class="selfRef" href="#name-example-access-token-reques">Example Access Token Request, (Implicit) Symmetric PoP Key</a>
            </figcaption></figure>
</div>
<p id="section-3.3.1-5">A corresponding example access token response is illustrated in
<a class="xref" href="#at-response">Figure 6</a>.  In this example, the authorization server returns a
2.01 response containing a new access token (truncated to improve
readability) and information for the client, including the symmetric
key in the <code>cnf</code> claim.  The information is transferred as a CBOR data
structure as specified in <span>[<a class="xref" href="#RFC9200">RFC9200</a>]</span>.<a class="pilcrow" href="#section-3.3.1-5">Â¶</a></p>
<span id="name-example-access-token-respon"></span><div id="at-response">
<figure id="figure-6">
            <div id="section-3.3.1-6.1">
<pre class="lang-cbor-diag sourcecode">   2.01 Created
   Content-Format: application/ace+cbor
   Max-Age: 85800
   Payload:
   {
      / access_token /  1 : h'd08343a1/...
        (remainder of CWT omitted for brevity)/',
      / token_type /   34 : / PoP / 2,
      / expires_in /    2 : 86400,
      / ace_profile /  38 : / coap_dtls / 1,
      / cnf /           8 : {
        / COSE_Key / 1 : {
          / kty / 1 : / symmetric / 4,
          / kid / 2 : h'3d027833fc6267ce',
          / k /  -1 : h'73657373696f6e6b6579'
        }
      }
   }
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-6">Figure 6</a>:
<a class="selfRef" href="#name-example-access-token-respon">Example Access Token Response, Symmetric PoP Key</a>
            </figcaption></figure>
</div>
<p id="section-3.3.1-7">The access token also comprises a <code>cnf</code> claim. This claim usually
contains a <code>COSE_Key</code> object <span>[<a class="xref" href="#RFC8152">RFC8152</a>]</span> that carries either the symmetric key
itself or a key identifier that can be used by the resource server to
determine the secret key it shares with the client. If the access
token carries a symmetric key, the access token <span class="bcp14">MUST</span> be encrypted
using a <code>COSE_Encrypt0</code> structure (see <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8392#section-7.1">Section 7.1</a> of [<a class="xref" href="#RFC8392">RFC8392</a>]</span>). The
authorization server <span class="bcp14">MUST</span> use
the keying material shared with the resource server to encrypt the
token.<a class="pilcrow" href="#section-3.3.1-7">Â¶</a></p>
<p id="section-3.3.1-8">The <code>cnf</code> structure in the access token is provided in <a class="xref" href="#kdf-cnf">Figure 7</a>.<a class="pilcrow" href="#section-3.3.1-8">Â¶</a></p>
<span id="name-access-token-without-keying"></span><div id="kdf-cnf">
<figure id="figure-7">
            <div id="section-3.3.1-9.1">
<pre class="lang-cbor-diag sourcecode">/ cnf / 8 : {
  / COSE_Key / 1 : {
    / kty / 1 : / symmetric / 4,
    / kid / 2 : h'3d027833fc6267ce'
  }
}
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-7">Figure 7</a>:
<a class="selfRef" href="#name-access-token-without-keying">Access Token without Keying Material</a>
            </figcaption></figure>
</div>
<p id="section-3.3.1-10">A response that declines any operation on the requested resource is
constructed according to <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc6749#section-5.2">Section 5.2</a> of [<a class="xref" href="#RFC6749">RFC6749</a>]</span>
(cf.Â <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9200#section-5.8.3">Section 5.8.3</a> of [<a class="xref" href="#RFC9200">RFC9200</a>]</span>). <a class="xref" href="#token-reject">Figure 8</a>
shows an example for a request that has been rejected due to invalid
request parameters.<a class="pilcrow" href="#section-3.3.1-10">Â¶</a></p>
<span id="name-example-access-token-respons"></span><div id="token-reject">
<figure id="figure-8">
            <div id="section-3.3.1-11.1">
<pre class="lang-cbor-diag sourcecode">    4.00 Bad Request
    Content-Format: application/ace+cbor
    Payload:
    {
      / error / 30 : / invalid_request / 1
    }
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-8">Figure 8</a>:
<a class="selfRef" href="#name-example-access-token-respons">Example Access Token Response with Reject</a>
            </figcaption></figure>
</div>
<p id="section-3.3.1-12">The method for how the resource server determines the symmetric key
from an access token containing only a key identifier is
application specific; the remainder of this section provides one
example.<a class="pilcrow" href="#section-3.3.1-12">Â¶</a></p>
<p id="section-3.3.1-13">The authorization server and the resource server are assumed to share
a key derivation key used to derive the symmetric key shared with the
client from the key identifier in the access token.  The key
derivation key may be derived from some other secret key shared
between the authorization server and the resource server. This key
needs to be securely stored and processed in the same way as the key
used to protect the communication between the authorization server and
the resource server.<a class="pilcrow" href="#section-3.3.1-13">Â¶</a></p>
<p id="section-3.3.1-14">Knowledge of the symmetric key shared with the client must not reveal
any information about the key derivation key or other secret keys
shared between the authorization server and resource server.<a class="pilcrow" href="#section-3.3.1-14">Â¶</a></p>
<p id="section-3.3.1-15">In order to generate a new symmetric key to be used by the client and
resource server, the authorization server generates a new key
identifier that <span class="bcp14">MUST</span> be unique among all key identifiers used by the
authorization server for this resource server. The authorization server then uses the key
derivation key shared with the resource server to derive the symmetric
key, as specified below.  Instead of providing the keying material in
the access token, the authorization server includes the key identifier
in the <code>kid</code> parameter (see <a class="xref" href="#kdf-cnf">Figure 7</a>). This key identifier enables
the resource server to calculate the symmetric key used for the
communication with the client using the key derivation key and a key derivation function (KDF)
to be defined by the application, for example, HKDF-SHA-256. The key
identifier picked by the authorization server <span class="bcp14">MUST</span> be unique for
each access token where a unique symmetric key is required.<a class="pilcrow" href="#section-3.3.1-15">Â¶</a></p>
<p id="section-3.3.1-16">In this example, the HMAC-based key derivation function (HKDF) consists of the composition of the HKDF-Extract
and HKDF-Expand steps <span>[<a class="xref" href="#RFC5869">RFC5869</a>]</span>. The symmetric key is derived from the
key identifier, the key derivation key, and other data:<a class="pilcrow" href="#section-3.3.1-16">Â¶</a></p>
<p id="section-3.3.1-17" style="margin-left: 1.5em">OKM = HKDF(salt, IKM, info, L),<a class="pilcrow" href="#section-3.3.1-17">Â¶</a></p>
<p id="section-3.3.1-18">where:<a class="pilcrow" href="#section-3.3.1-18">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3.1-19.1">OKM, the output keying material, is the derived symmetric key<a class="pilcrow" href="#section-3.3.1-19.1">Â¶</a>
</li>
            <li class="normal" id="section-3.3.1-19.2">salt is the empty byte string<a class="pilcrow" href="#section-3.3.1-19.2">Â¶</a>
</li>
            <li class="normal" id="section-3.3.1-19.3">IKM, the input keying material, is the key derivation key, as defined
     above<a class="pilcrow" href="#section-3.3.1-19.3">Â¶</a>
</li>
            <li class="normal" id="section-3.3.1-19.4">
              <p id="section-3.3.1-19.4.1">info is the serialization of a CBOR array consisting of <span>[<a class="xref" href="#RFC8610">RFC8610</a>]</span>:<a class="pilcrow" href="#section-3.3.1-19.4.1">Â¶</a></p>
<div id="section-3.3.1-19.4.2">
<pre class="lang-cddl sourcecode">      info = [
        type : tstr,
        L    : uint,
        access_token : bytes
      ]
</pre><a class="pilcrow" href="#section-3.3.1-19.4.2">Â¶</a>
</div>
<p id="section-3.3.1-19.4.3">where:<a class="pilcrow" href="#section-3.3.1-19.4.3">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3.1-19.4.4.1">type is set to the constant text string "ACE-CoAP-DTLS-key-derivation"<a class="pilcrow" href="#section-3.3.1-19.4.4.1">Â¶</a>
</li>
                <li class="normal" id="section-3.3.1-19.4.4.2">L is the size of the symmetric key in bytes<a class="pilcrow" href="#section-3.3.1-19.4.4.2">Â¶</a>
</li>
                <li class="normal" id="section-3.3.1-19.4.4.3">access_token is the content of the <code>access_token</code> field, as
     transferred from the authorization server to the resource server.<a class="pilcrow" href="#section-3.3.1-19.4.4.3">Â¶</a>
</li>
              </ul>
</li>
          </ul>
<p id="section-3.3.1-20">All CBOR data types are encoded in CBOR using preferred serialization
   and deterministic encoding, as specified in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8949#section-4">Section 4</a> of [<a class="xref" href="#RFC8949">RFC8949</a>]</span>.
   In particular, this implies that the <code>type</code> and <code>L</code> components use the
   minimum length encoding. The content of the <code>access_token</code> field is
   treated as opaque data for the purpose of key derivation.<a class="pilcrow" href="#section-3.3.1-20">Â¶</a></p>
<p id="section-3.3.1-21">Use of a unique (per-resource-server) <code>kid</code> and the use of a key
   derivation IKM that <span class="bcp14">MUST</span> be unique
   per AS/RS pair, as specified above, will ensure that
   the derived key is not shared across multiple clients.  However, to provide
   variation in the derived key across different tokens used by the same client, it
   is additionally <span class="bcp14">RECOMMENDED</span> to include the <code>iat</code> claim and either the
   <code>exp</code> or <code>exi</code> claims in the access token.<a class="pilcrow" href="#section-3.3.1-21">Â¶</a></p>
</section>
</div>
<div id="psk-dtls-channel">
<section id="section-3.3.2">
          <h4 id="name-dtls-channel-setup-between-t">
<a class="section-number selfRef" href="#section-3.3.2">3.3.2. </a><a class="section-name selfRef" href="#name-dtls-channel-setup-between-t">DTLS Channel Setup between the Client and Resource Server</a>
          </h4>
<p id="section-3.3.2-1">When a client receives an access token response from an authorization
server, the client <span class="bcp14">MUST</span> check if the access token response is bound to
a certain, previously sent access token request, as the request may
specify the resource server with which the client wants to
communicate.<a class="pilcrow" href="#section-3.3.2-1">Â¶</a></p>
<p id="section-3.3.2-2">The client checks if the payload of the access token response contains
   an <code>access_token</code> parameter and a <code>cnf</code> parameter. With this
   information, the client can initiate the establishment of a new DTLS
   channel with a resource server. To use DTLS with pre-shared keys, the
   client follows the PSK key exchange algorithm specified in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc4279#section-2">Section 2</a> of [<a class="xref" href="#RFC4279">RFC4279</a>]</span>, using the key conveyed in the <code>cnf</code>
   parameter of the AS response as a PSK when constructing the premaster secret. To be
   consistent with the recommendations in <span>[<a class="xref" href="#RFC7252">RFC7252</a>]</span>, a
   client in the PSK mode <span class="bcp14">MUST</span> support the cipher suite
   TLS_PSK_WITH_AES_128_CCM_8 <span>[<a class="xref" href="#RFC6655">RFC6655</a>]</span>.<a class="pilcrow" href="#section-3.3.2-2">Â¶</a></p>
<p id="section-3.3.2-3">In PreSharedKey mode, the knowledge of the shared secret by the client
   and the resource server is used for mutual authentication between both
   peers. Therefore, the resource server must be able to determine the
   shared secret from the access token. Following the general ACE
   authorization framework, the client can upload the access token to the
   resource server's authz-info resource before starting the DTLS
   handshake.  The client then needs to indicate during the DTLS
   handshake which previously uploaded access token it intends to use.
   To do so, it <span class="bcp14">MUST</span> create a <code>COSE_Key</code> structure with the
   <code>kid</code> that was conveyed in the <code>rs_cnf</code> claim in the token response
   from the authorization server and the key type <code>symmetric</code>.  This structure
   then is included as the only element in the <code>cnf</code> structure whose CBOR
   serialization is used as value for <code>psk_identity</code>, as shown in <a class="xref" href="#psk_identity-cnf">Figure 9</a>.<a class="pilcrow" href="#section-3.3.2-3">Â¶</a></p>
<span id="name-access-token-containing-a-s"></span><div id="psk_identity-cnf">
<figure id="figure-9">
            <div id="section-3.3.2-4.1">
<pre class="lang-cbor-diag sourcecode">{ / cnf / 8 : {
   / COSE_Key / 1 : {
      / kty / 1 : / symmetric / 4,
      / kid / 2 : h'3d027833fc6267ce'
    }
  }
}
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-9">Figure 9</a>:
<a class="selfRef" href="#name-access-token-containing-a-s">Access Token Containing a Single <code>kid</code> Parameter</a>
            </figcaption></figure>
</div>
<p id="section-3.3.2-5">The actual CBOR serialization for the data structure from
   <a class="xref" href="#psk_identity-cnf">Figure 9</a> as a sequence of bytes in
   hexadecimal notation will be:<a class="pilcrow" href="#section-3.3.2-5">Â¶</a></p>
<div id="section-3.3.2-6">
<pre class="sourcecode">A1 08 A1 01 A2 01 04 02 48 3D 02 78 33 FC 62 67 CE
</pre><a class="pilcrow" href="#section-3.3.2-6">Â¶</a>
</div>
<p id="section-3.3.2-7">As an alternative to the access token upload, the client can provide
the most recent access token in the <code>psk_identity</code> field of the
ClientKeyExchange message. To do so, the client <span class="bcp14">MUST</span> treat the
contents of the <code>access_token</code> field from the AS-to-client response as
opaque data, as specified in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc7925#section-4.2">Section 4.2</a> of [<a class="xref" href="#RFC7925">RFC7925</a>]</span>, and not perform
any recoding. This allows the resource server to retrieve the shared
secret directly from the <code>cnf</code> claim of the access token.<a class="pilcrow" href="#section-3.3.2-7">Â¶</a></p>
<p id="section-3.3.2-8">DTLS 1.3 <span>[<a class="xref" href="#RFC9147">RFC9147</a>]</span> does not use the ClientKeyExchange message; for DTLS 1.3,
   the access token is placed in the <code>identity</code> field of a <code>PSKIdentity</code>
   within the <code>PreSharedKeyExtension</code> of the <code>ClientHello</code>.<a class="pilcrow" href="#section-3.3.2-8">Â¶</a></p>
<p id="section-3.3.2-9">If a resource server receives a ClientKeyExchange message that
contains a <code>psk_identity</code> with a length greater than zero, it <span class="bcp14">MUST</span>
parse the contents of the <code>psk_identity</code> field as a CBOR data structure
and process the contents as following:<a class="pilcrow" href="#section-3.3.2-9">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3.2-10.1">If the data contains a <code>cnf</code> field with a <code>COSE_Key</code> structure with
a <code>kid</code>, the resource server continues the DTLS handshake with the
associated key that corresponds to this kid.<a class="pilcrow" href="#section-3.3.2-10.1">Â¶</a>
</li>
            <li class="normal" id="section-3.3.2-10.2">If the data comprises additional CWT information, this information
must be stored as an access token for this DTLS association before
continuing with the DTLS handshake.<a class="pilcrow" href="#section-3.3.2-10.2">Â¶</a>
</li>
          </ul>
<p id="section-3.3.2-11">If the contents of the <code>psk_identity</code> do not yield sufficient
information to select a valid access token for the requesting client,
the resource server aborts the DTLS handshake with an
<code>illegal_parameter</code> alert.<a class="pilcrow" href="#section-3.3.2-11">Â¶</a></p>
<p id="section-3.3.2-12">When the resource server receives an access token, it <span class="bcp14">MUST</span> check if
the access token is still valid, if the resource server is the
intended destination (i.e., the audience of the token), and if the
token was issued by an authorized authorization server.  This
specification implements access tokens as proof-of-possession tokens.
Therefore, the access token is bound to a symmetric PoP key
that is used as a shared secret between the client and the resource
server. A resource server <span class="bcp14">MUST</span> have the capacity to store one
access token for every proof-of-possession key of every authorized client.
The resource server may use token introspection <span>[<a class="xref" href="#RFC7662">RFC7662</a>]</span> on
the access token to retrieve more information about the specific
token. The use of introspection is out of scope for this
specification.<a class="pilcrow" href="#section-3.3.2-12">Â¶</a></p>
<p id="section-3.3.2-13">While the client can retrieve the shared secret from the contents of
the <code>cnf</code> parameter in the AS-to-client response, the resource server
uses the information contained in the <code>cnf</code> claim of the access token
to determine the actual secret when no explicit <code>kid</code> was provided in
the <code>psk_identity</code> field. If key derivation is used, the <code>cnf</code> claim
<span class="bcp14">MUST</span> contain a <code>kid</code> parameter to be used by the server as the IKM for
key derivation, as described above.<a class="pilcrow" href="#section-3.3.2-13">Â¶</a></p>
</section>
</div>
</section>
</div>
<div id="resource-access">
<section id="section-3.4">
        <h3 id="name-resource-access">
<a class="section-number selfRef" href="#section-3.4">3.4. </a><a class="section-name selfRef" href="#name-resource-access">Resource Access</a>
        </h3>
<p id="section-3.4-1">Once a DTLS channel has been established as described in either Sections <a class="xref" href="#rpk-mode">3.2</a>
or <a class="xref" href="#psk-mode">3.3</a>, respectively, the client is authorized to access
resources covered by the access token it has uploaded to the
authz-info resource that is hosted by the resource server.<a class="pilcrow" href="#section-3.4-1">Â¶</a></p>
<p id="section-3.4-2">With the successful establishment of the DTLS channel, the client and
the resource server have proven that they can use their respective
keying material. An access token that is bound to the client's keying
material is associated with the channel. According to
<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9200#section-5.10.1">Section 5.10.1</a> of [<a class="xref" href="#RFC9200">RFC9200</a>]</span>, there should be only one access token
for each client. New access tokens issued by the authorization server
<span class="bcp14">SHOULD</span> replace previously issued access tokens for the
respective client. The resource server therefore needs a common
understanding with the authorization server about how access tokens are
ordered. The authorization server may, e.g., specify a <code>cti</code> claim for
the access token (see <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9200#section-5.9.2">Section 5.9.2</a> of [<a class="xref" href="#RFC9200">RFC9200</a>]</span>) to
employ a strict order.<a class="pilcrow" href="#section-3.4-2">Â¶</a></p>
<p id="section-3.4-3">Any request that the resource server receives on a DTLS channel that
is tied to an access token via its keying material 
<span class="bcp14">MUST</span> be checked against the authorization rules that can be determined
with the access token. The resource server
<span class="bcp14">MUST</span> check for every request if the access token is still valid.
If the token has expired, the resource server <span class="bcp14">MUST</span> remove it.
Incoming CoAP requests that are not authorized with respect
to any access token that is associated with the client <span class="bcp14">MUST</span> be
rejected by the resource server with a 4.01 response. The response
<span class="bcp14">SHOULD</span> include AS Request Creation Hints, as described in
<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9200#section-5.2">Section 5.2</a> of [<a class="xref" href="#RFC9200">RFC9200</a>]</span>.<a class="pilcrow" href="#section-3.4-3">Â¶</a></p>
<p id="section-3.4-4">The resource server <span class="bcp14">MUST NOT</span> accept an incoming CoAP request as
authorized if any of the following fails:<a class="pilcrow" href="#section-3.4-4">Â¶</a></p>
<ol class="normal type-1" id="section-3.4-5" start="1" type="1">
   <li id="section-3.4-5.1">The message was received on a secure channel that has been
   established using the procedure defined in this document.<a class="pilcrow" href="#section-3.4-5.1">Â¶</a>
</li>
          <li id="section-3.4-5.2">The authorization information tied to the sending client is valid.<a class="pilcrow" href="#section-3.4-5.2">Â¶</a>
</li>
          <li id="section-3.4-5.3">The request is destined for the resource server.<a class="pilcrow" href="#section-3.4-5.3">Â¶</a>
</li>
          <li id="section-3.4-5.4">The resource URI specified in the request is covered by the
   authorization information.<a class="pilcrow" href="#section-3.4-5.4">Â¶</a>
</li>
          <li id="section-3.4-5.5">The request method is an authorized action on the resource with
   respect to the authorization information.<a class="pilcrow" href="#section-3.4-5.5">Â¶</a>
</li>
        </ol>
<p id="section-3.4-6">Incoming CoAP requests received on a secure DTLS channel that are not
 thus authorized <span class="bcp14">MUST</span> be
 rejected according to <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9200#section-5.10.2">Section 5.10.2</a> of [<a class="xref" href="#RFC9200">RFC9200</a>]</span>:<a class="pilcrow" href="#section-3.4-6">Â¶</a></p>
<ol class="normal type-1" id="section-3.4-7" start="1" type="1">
   <li id="section-3.4-7.1">with response code 4.03 (Forbidden) when the resource URI specified
   in the request is not covered by the authorization information and<a class="pilcrow" href="#section-3.4-7.1">Â¶</a>
</li>
          <li id="section-3.4-7.2">with response code 4.05 (Method Not Allowed) when the resource URI
   specified in the request is covered by the authorization information but
   not the requested action.<a class="pilcrow" href="#section-3.4-7.2">Â¶</a>
</li>
        </ol>
<p id="section-3.4-8">The client <span class="bcp14">MUST</span> ascertain that its keying material is still valid
before sending a request or processing a response. If the client
recently has updated the access token (see <a class="xref" href="#update">Section 4</a>), it must be
prepared that its request is still handled according to the previous
authorization rules, as there is no strict ordering between access
token uploads and resource access messages. See also
<a class="xref" href="#multiple-access-tokens">Section 7.2</a> for a discussion of access token
processing.<a class="pilcrow" href="#section-3.4-8">Â¶</a></p>
<p id="section-3.4-9">If the client gets an error response
containing AS Request Creation Hints (cf.Â <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9200#section-5.3">Section 5.3</a> of [<a class="xref" href="#RFC9200">RFC9200</a>]</span>)
as a response to its requests, it <span class="bcp14">SHOULD</span> request a new access token from
the authorization server in order to continue communication with the
resource server.<a class="pilcrow" href="#section-3.4-9">Â¶</a></p>
<p id="section-3.4-10">Unauthorized requests that have been received over a DTLS session
<span class="bcp14">SHOULD</span> be treated as nonfatal by the resource server, i.e., the DTLS
session <span class="bcp14">SHOULD</span> be kept alive until the associated access token has
expired.<a class="pilcrow" href="#section-3.4-10">Â¶</a></p>
</section>
</div>
</section>
</div>
<div id="update">
<section id="section-4">
      <h2 id="name-dynamic-update-of-authoriza">
<a class="section-number selfRef" href="#section-4">4. </a><a class="section-name selfRef" href="#name-dynamic-update-of-authoriza">Dynamic Update of Authorization Information</a>
      </h2>
<p id="section-4-1">Resource servers must only use a new access token to update the
authorization information for a DTLS session if the keying material
that is bound to the token is the same that was used in the DTLS
handshake. By associating the access tokens with the identifier of an
existing DTLS session, the authorization information can be updated
without changing the cryptographic keys for the DTLS communication
between the client and the resource server, i.e., an existing session
can be used with updated permissions.<a class="pilcrow" href="#section-4-1">Â¶</a></p>
<p id="section-4-2">The client can therefore update the authorization information stored at the
resource server at any time without changing an established DTLS
session. To do so, the client requests a
new access token from the authorization server 
for the intended action on the respective resource
and uploads this access token to the authz-info resource on the
resource server.<a class="pilcrow" href="#section-4-2">Â¶</a></p>
<p id="section-4-3"><a class="xref" href="#update-overview">Figure 10</a> depicts the message flow where the client requests
a new access token after a security association between the client and
the resource server has been established using this protocol. If the
client wants to update the authorization information, the token
request <span class="bcp14">MUST</span> specify the key identifier of the proof-of-possession key
used for the existing DTLS channel between the client and the resource
server in the <code>kid</code> parameter of the client-to-AS request. The
authorization server <span class="bcp14">MUST</span> verify that the specified <code>kid</code> denotes a
valid verifier for a proof-of-possession token that has previously
been issued to the requesting client. Otherwise, the client-to-AS
request <span class="bcp14">MUST</span> be declined with the error code <code>unsupported_pop_key</code>, as
defined in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9200#section-5.8.3">Section 5.8.3</a> of [<a class="xref" href="#RFC9200">RFC9200</a>]</span>.<a class="pilcrow" href="#section-4-3">Â¶</a></p>
<p id="section-4-4">When the authorization server issues a new access token to update
existing authorization information, it <span class="bcp14">MUST</span> include the specified <code>kid</code>
parameter in this access token. A resource server <span class="bcp14">MUST</span> replace the
authorization information of any existing DTLS session that is identified
by this key identifier with the updated authorization information.<a class="pilcrow" href="#section-4-4">Â¶</a></p>
<span id="name-overview-of-dynamic-update-"></span><div id="update-overview">
<figure id="figure-10">
        <div class="alignLeft art-text artwork" id="section-4-5.1">
<pre>   C                            RS                   AS
   | &lt;===== DTLS channel =====&gt; |                     |
   |        + Access Token      |                     |
   |                            |                     |
   | --- Token Request  ----------------------------&gt; |
   |                            |                     |
   | &lt;---------------------------- New Access Token - |
   |                           + Access Information   |
   |                            |                     |
   | --- Update /authz-info --&gt; |                     |
   |     New Access Token       |                     |
   |                            |                     |
   | == Authorized Request ===&gt; |                     |
   |                            |                     |
   | &lt;=== Protected Resource == |                     |
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-10">Figure 10</a>:
<a class="selfRef" href="#name-overview-of-dynamic-update-">Overview of Dynamic Update Operation</a>
        </figcaption></figure>
</div>
</section>
</div>
<div id="teardown">
<section id="section-5">
      <h2 id="name-token-expiration">
<a class="section-number selfRef" href="#section-5">5. </a><a class="section-name selfRef" href="#name-token-expiration">Token Expiration</a>
      </h2>
<p id="section-5-1">The resource server <span class="bcp14">MUST</span> delete access tokens that are no longer
      valid.  DTLS associations that have been set up in accordance with
      this profile are always tied to specific tokens (which may be
      exchanged with a dynamic update, as described in <a class="xref" href="#update">Section 4</a>). As tokens
      may become invalid at any time (e.g., because they have expired), the
      association may become useless at some point.  A resource server therefore
      <span class="bcp14">MUST</span> terminate existing DTLS association after the last access token
      associated with this association has expired.<a class="pilcrow" href="#section-5-1">Â¶</a></p>
<p id="section-5-2">As specified in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9200#section-5.10.3">Section 5.10.3</a> of [<a class="xref" href="#RFC9200">RFC9200</a>]</span>,
the resource server <span class="bcp14">MUST</span> notify the client with an error response with
code 4.01 (Unauthorized) for any long-running request before
terminating the association.<a class="pilcrow" href="#section-5-2">Â¶</a></p>
</section>
</div>
<div id="as-commsec">
<section id="section-6">
      <h2 id="name-secure-communication-with-a">
<a class="section-number selfRef" href="#section-6">6. </a><a class="section-name selfRef" href="#name-secure-communication-with-a">Secure Communication with an Authorization Server</a>
      </h2>
<p id="section-6-1">As specified in the ACE framework (Sections <a class="relref" href="https://www.rfc-editor.org/rfc/rfc9200#section-5.8">5.8</a> and <a class="relref" href="https://www.rfc-editor.org/rfc/rfc9200#section-5.9">5.9</a> of
<span>[<a class="xref" href="#RFC9200">RFC9200</a>]</span>), the requesting entity (the resource
server and/or the client) and the authorization server communicate via
the token endpoint or introspection endpoint.  The use of CoAP and
DTLS for this communication is <span class="bcp14">RECOMMENDED</span> in this profile. Other
protocols fulfilling the security requirements defined in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9200#section-5">Section 5</a> of [<a class="xref" href="#RFC9200">RFC9200</a>]</span> <span class="bcp14">MAY</span> be used instead.<a class="pilcrow" href="#section-6-1">Â¶</a></p>
<p id="section-6-2">How credentials (e.g., PSK, RPK, X.509 cert) for using DTLS with the
authorization server are established is out of scope for this profile.<a class="pilcrow" href="#section-6-2">Â¶</a></p>
<p id="section-6-3">If other means of securing the communication with the authorization
server are used, the communication security requirements from <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9200#section-6.2">Section 6.2</a> of [<a class="xref" href="#RFC9200">RFC9200</a>]</span> remain applicable.<a class="pilcrow" href="#section-6-3">Â¶</a></p>
</section>
</div>
<div id="security-considerations">
<section id="section-7">
      <h2 id="name-security-considerations">
<a class="section-number selfRef" href="#section-7">7. </a><a class="section-name selfRef" href="#name-security-considerations">Security Considerations</a>
      </h2>
<p id="section-7-1">This document specifies a profile for the Authentication and
Authorization for Constrained Environments (ACE) framework
<span>[<a class="xref" href="#RFC9200">RFC9200</a>]</span>. As it follows this framework's general
approach, the general security considerations from <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9200#section-6">Section 6</a> of [<a class="xref" href="#RFC9200">RFC9200</a>]</span> also apply to this profile.<a class="pilcrow" href="#section-7-1">Â¶</a></p>
<p id="section-7-2">The authorization server must ascertain that the keying material for
the client that it provides to the resource server actually is
associated with this client.  Malicious clients may hand over access
tokens containing their own access permissions to other entities. This
problem cannot be completely eliminated. Nevertheless, in RPK mode, it
should not be possible for clients to request access tokens for
arbitrary public keys; if the client can cause the authorization
server to issue a token for a public key without proving possession of
the corresponding private key, this allows for identity misbinding
attacks, where the issued token is usable by an entity other than the
intended one. At some point, the authorization server therefore needs
to validate that the client can actually use the private key
corresponding to the client's public key.<a class="pilcrow" href="#section-7-2">Â¶</a></p>
<p id="section-7-3">When using pre-shared keys provisioned by the authorization server,
the security level depends on the randomness of PSKs and the security
of the TLS cipher suite and key exchange algorithm.  As this
specification targets constrained environments, message payloads
exchanged between the client and the resource server are expected to
be small and rare.  CoAP <span>[<a class="xref" href="#RFC7252">RFC7252</a>]</span> mandates the implementation of
cipher suites with abbreviated, 8-byte tags for message integrity
protection. For consistency, this profile requires implementation of
the same cipher suites. For application scenarios where the cost of
full-width authentication tags is low compared to the overall amount
of data being transmitted, the use of cipher suites with 16-byte
integrity protection tags is preferred.<a class="pilcrow" href="#section-7-3">Â¶</a></p>
<p id="section-7-4">The PSK mode of this profile offers a distribution mechanism to convey
      authorization tokens together with a shared secret to a client and a
      server. As this specification aims at constrained devices and uses
      CoAP <span>[<a class="xref" href="#RFC7252">RFC7252</a>]</span> as the transfer protocol, at least the
      cipher suite TLS_PSK_WITH_AES_128_CCM_8 <span>[<a class="xref" href="#RFC6655">RFC6655</a>]</span>
      should be supported. The
      access tokens and the corresponding shared secrets generated by the
      authorization server are expected to be sufficiently short-lived to
      provide similar forward-secrecy properties to using ephemeral
      Diffie-Hellman (DHE) key exchange mechanisms. For longer-lived access
      tokens, DHE cipher suites should be used, i.e., cipher suites of the
      form TLS_DHE_PSK_* or TLS_ECDHE_PSK_*.<a class="pilcrow" href="#section-7-4">Â¶</a></p>
<p id="section-7-5">Constrained devices that use DTLS <span>[<a class="xref" href="#RFC6347">RFC6347</a>]</span> <span>[<a class="xref" href="#RFC9147">RFC9147</a>]</span> are inherently
vulnerable to Denial of Service (DoS) attacks, as the handshake
protocol requires creation of internal state within the device.  This
is specifically of concern where an adversary is able to intercept the
initial cookie exchange and interject forged messages with a valid
cookie to continue with the handshake. A similar issue exists with the
unprotected authorization information endpoint when the resource
server needs to keep valid access tokens for a long time. Adversaries
could fill up the constrained resource server's internal storage for a
very long time with intercepted or otherwise retrieved valid access
tokens.  To mitigate against this, the resource server should set a
time boundary until an access token that has not been used until then
will be deleted.<a class="pilcrow" href="#section-7-5">Â¶</a></p>
<p id="section-7-6">The protection of access tokens that are stored in the authorization
information endpoint depends on the keying material that is used between
the authorization server and the resource server; the resource server
must ensure that it processes only access tokens that are integrity protected (and encrypted) by an authorization server that is authorized
to provide access tokens for the resource server.<a class="pilcrow" href="#section-7-6">Â¶</a></p>
<div id="reuse-of-existing-sessions">
<section id="section-7.1">
        <h3 id="name-reuse-of-existing-sessions">
<a class="section-number selfRef" href="#section-7.1">7.1. </a><a class="section-name selfRef" href="#name-reuse-of-existing-sessions">Reuse of Existing Sessions</a>
        </h3>
<p id="section-7.1-1">To avoid the overhead of a repeated DTLS handshake, <span>[<a class="xref" href="#RFC7925">RFC7925</a>]</span> recommends
session resumption <span>[<a class="xref" href="#RFC8446">RFC8446</a>]</span> to reuse session state from
an earlier DTLS association and thus requires client-side
implementation.  In this specification, the DTLS session is subject to
the authorization rules denoted by the access token that was used for
the initial setup of the DTLS association. Enabling session resumption
would require the server to transfer the authorization information
with the session state in an encrypted SessionTicket to the
client. Assuming that the server uses long-lived keying material, this
could open up attacks due to the lack of forward secrecy. Moreover,
using this mechanism, a client can resume a DTLS session without
proving the possession of the PoP key again. Therefore, session
resumption should be used only in combination with reasonably
short-lived PoP keys.<a class="pilcrow" href="#section-7.1-1">Â¶</a></p>
<p id="section-7.1-2">Since renegotiation of DTLS associations is prone to attacks as well, <span>[<a class="xref" href="#RFC7925">RFC7925</a>]</span> requires that clients decline any
 renegotiation attempt. A server that wants to initiate rekeying therefore
 <span class="bcp14">SHOULD</span> periodically force a full handshake.<a class="pilcrow" href="#section-7.1-2">Â¶</a></p>
</section>
</div>
<div id="multiple-access-tokens">
<section id="section-7.2">
        <h3 id="name-multiple-access-tokens">
<a class="section-number selfRef" href="#section-7.2">7.2. </a><a class="section-name selfRef" href="#name-multiple-access-tokens">Multiple Access Tokens</a>
        </h3>
<p id="section-7.2-1">Implementers <span class="bcp14">SHOULD</span> avoid using multiple access tokens for a
client (see also <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9200#section-5.10.1">Section 5.10.1</a> of [<a class="xref" href="#RFC9200">RFC9200</a>]</span>).<a class="pilcrow" href="#section-7.2-1">Â¶</a></p>
<p id="section-7.2-2">Even when a single access token per client is used, an attacker could
compromise the dynamic update mechanism for existing DTLS connections
by delaying or reordering packets destined for the authz-info
endpoint. Thus, the order in which operations occur at the resource
server (and thus which authorization info is used to process a given
client request) cannot be guaranteed.  Especially in the presence of
later-issued access tokens that reduce the client's permissions from
the initial access token, it is impossible to guarantee that the
reduction in authorization will take effect prior to the expiration of
the original token.<a class="pilcrow" href="#section-7.2-2">Â¶</a></p>
</section>
</div>
<div id="out-of-band-configuration">
<section id="section-7.3">
        <h3 id="name-out-of-band-configuration">
<a class="section-number selfRef" href="#section-7.3">7.3. </a><a class="section-name selfRef" href="#name-out-of-band-configuration">Out-of-Band Configuration</a>
        </h3>
<p id="section-7.3-1">To communicate securely, the authorization server, the client, and the
resource server require certain information that must be exchanged
outside the protocol flow described in this document. The
authorization server must have obtained authorization information
concerning the client and the resource server that is approved by the
resource owner, as well as corresponding keying material. The resource
server must have received authorization information approved by the
resource owner concerning its authorization managers and the
respective keying material. The client must have obtained
authorization information concerning the authorization server approved
by its owner, as well as the corresponding keying material. Also, the
client's owner must have approved of the client's communication with
the resource server. The client and the authorization server must have
obtained a common understanding about how this resource server is identified
to ensure that the client obtains access tokens and keying material for
the correct resource server. If the client is provided with a raw
public key for the resource server, it must be ascertained to which
resource server (which identifier and authorization information) the
key is associated.  All authorization information and keying material
must be kept up to date.<a class="pilcrow" href="#section-7.3-1">Â¶</a></p>
</section>
</div>
</section>
</div>
<div id="privacy-considerations">
<section id="section-8">
      <h2 id="name-privacy-considerations">
<a class="section-number selfRef" href="#section-8">8. </a><a class="section-name selfRef" href="#name-privacy-considerations">Privacy Considerations</a>
      </h2>
<p id="section-8-1">This privacy considerations from <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9200#section-7">Section 7</a> of [<a class="xref" href="#RFC9200">RFC9200</a>]</span> apply also to this profile.<a class="pilcrow" href="#section-8-1">Â¶</a></p>
<p id="section-8-2">An unprotected response to an unauthorized request may disclose
information about the resource server and/or its existing relationship
with the client. It is advisable to include as little information as
possible in an unencrypted response. When a DTLS session between an authenticated
client and the resource server already exists, more detailed
information <span class="bcp14">MAY</span> be included with an error response to provide the
client with sufficient information to react on that particular error.<a class="pilcrow" href="#section-8-2">Â¶</a></p>
<p id="section-8-3">Also, unprotected requests to the resource server may reveal
information about the client, e.g., which resources the client
attempts to request or the data that the client wants to provide to
the resource server. The client <span class="bcp14">SHOULD NOT</span> send confidential data in
an unprotected request.<a class="pilcrow" href="#section-8-3">Â¶</a></p>
<p id="section-8-4">Note that some information might still leak after the DTLS session is
established, due to observable message sizes, the source, and the
destination addresses.<a class="pilcrow" href="#section-8-4">Â¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-9">
      <h2 id="name-iana-considerations">
<a class="section-number selfRef" href="#section-9">9. </a><a class="section-name selfRef" href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<p id="section-9-1">The following registration has been made in the "ACE Profiles"
registry, following the procedure specified in
<span>[<a class="xref" href="#RFC9200">RFC9200</a>]</span>.<a class="pilcrow" href="#section-9-1">Â¶</a></p>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-9-2">
        <dt id="section-9-2.1">Name:</dt>
        <dd id="section-9-2.2" style="margin-left: 1.5em">coap_dtls<a class="pilcrow" href="#section-9-2.2">Â¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-9-2.3">Description:</dt>
        <dd id="section-9-2.4" style="margin-left: 1.5em">Profile for delegating client Authentication and
      Authorization for Constrained Environments by establishing a Datagram
      Transport Layer Security (DTLS) channel between resource-constrained
      nodes.<a class="pilcrow" href="#section-9-2.4">Â¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-9-2.5">CBOR Value:</dt>
        <dd id="section-9-2.6" style="margin-left: 1.5em">1<a class="pilcrow" href="#section-9-2.6">Â¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-9-2.7">Reference:</dt>
        <dd id="section-9-2.8" style="margin-left: 1.5em">RFC 9202<a class="pilcrow" href="#section-9-2.8">Â¶</a>
</dd>
      <dd class="break"></dd>
</dl>
</section>
</div>
<section id="section-10">
      <h2 id="name-references">
<a class="section-number selfRef" href="#section-10">10. </a><a class="section-name selfRef" href="#name-references">References</a>
      </h2>
<section id="section-10.1">
        <h3 id="name-normative-references">
<a class="section-number selfRef" href="#section-10.1">10.1. </a><a class="section-name selfRef" href="#name-normative-references">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time class="refDate" datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4279">[RFC4279]</dt>
        <dd>
<span class="refAuthor">Eronen, P., Ed.</span> and <span class="refAuthor">H. Tschofenig, Ed.</span>, <span class="refTitle">"Pre-Shared Key Ciphersuites for Transport Layer Security (TLS)"</span>, <span class="seriesInfo">RFC 4279</span>, <span class="seriesInfo">DOI 10.17487/RFC4279</span>, <time class="refDate" datetime="2005-12">December 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4279">https://www.rfc-editor.org/info/rfc4279</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6347">[RFC6347]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span> and <span class="refAuthor">N. Modadugu</span>, <span class="refTitle">"Datagram Transport Layer Security Version 1.2"</span>, <span class="seriesInfo">RFC 6347</span>, <span class="seriesInfo">DOI 10.17487/RFC6347</span>, <time class="refDate" datetime="2012-01">January 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6347">https://www.rfc-editor.org/info/rfc6347</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6749">[RFC6749]</dt>
        <dd>
<span class="refAuthor">Hardt, D., Ed.</span>, <span class="refTitle">"The OAuth 2.0 Authorization Framework"</span>, <span class="seriesInfo">RFC 6749</span>, <span class="seriesInfo">DOI 10.17487/RFC6749</span>, <time class="refDate" datetime="2012-10">October 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6749">https://www.rfc-editor.org/info/rfc6749</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7250">[RFC7250]</dt>
        <dd>
<span class="refAuthor">Wouters, P., Ed.</span>, <span class="refAuthor">Tschofenig, H., Ed.</span>, <span class="refAuthor">Gilmore, J.</span>, <span class="refAuthor">Weiler, S.</span>, and <span class="refAuthor">T. Kivinen</span>, <span class="refTitle">"Using Raw Public Keys in Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)"</span>, <span class="seriesInfo">RFC 7250</span>, <span class="seriesInfo">DOI 10.17487/RFC7250</span>, <time class="refDate" datetime="2014-06">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7250">https://www.rfc-editor.org/info/rfc7250</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7251">[RFC7251]</dt>
        <dd>
<span class="refAuthor">McGrew, D.</span>, <span class="refAuthor">Bailey, D.</span>, <span class="refAuthor">Campagna, M.</span>, and <span class="refAuthor">R. Dugal</span>, <span class="refTitle">"AES-CCM Elliptic Curve Cryptography (ECC) Cipher Suites for TLS"</span>, <span class="seriesInfo">RFC 7251</span>, <span class="seriesInfo">DOI 10.17487/RFC7251</span>, <time class="refDate" datetime="2014-06">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7251">https://www.rfc-editor.org/info/rfc7251</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7252">[RFC7252]</dt>
        <dd>
<span class="refAuthor">Shelby, Z.</span>, <span class="refAuthor">Hartke, K.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"The Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 7252</span>, <span class="seriesInfo">DOI 10.17487/RFC7252</span>, <time class="refDate" datetime="2014-06">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7252">https://www.rfc-editor.org/info/rfc7252</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7925">[RFC7925]</dt>
        <dd>
<span class="refAuthor">Tschofenig, H., Ed.</span> and <span class="refAuthor">T. Fossati</span>, <span class="refTitle">"Transport Layer Security (TLS) / Datagram Transport Layer Security (DTLS) Profiles for the Internet of Things"</span>, <span class="seriesInfo">RFC 7925</span>, <span class="seriesInfo">DOI 10.17487/RFC7925</span>, <time class="refDate" datetime="2016-07">July 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7925">https://www.rfc-editor.org/info/rfc7925</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8152">[RFC8152]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE)"</span>, <span class="seriesInfo">RFC 8152</span>, <span class="seriesInfo">DOI 10.17487/RFC8152</span>, <time class="refDate" datetime="2017-07">July 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8152">https://www.rfc-editor.org/info/rfc8152</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time class="refDate" datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8392">[RFC8392]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Wahlstroem, E.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"CBOR Web Token (CWT)"</span>, <span class="seriesInfo">RFC 8392</span>, <span class="seriesInfo">DOI 10.17487/RFC8392</span>, <time class="refDate" datetime="2018-05">May 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8392">https://www.rfc-editor.org/info/rfc8392</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8422">[RFC8422]</dt>
        <dd>
<span class="refAuthor">Nir, Y.</span>, <span class="refAuthor">Josefsson, S.</span>, and <span class="refAuthor">M. Pegourie-Gonnard</span>, <span class="refTitle">"Elliptic Curve Cryptography (ECC) Cipher Suites for Transport Layer Security (TLS) Versions 1.2 and Earlier"</span>, <span class="seriesInfo">RFC 8422</span>, <span class="seriesInfo">DOI 10.17487/RFC8422</span>, <time class="refDate" datetime="2018-08">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8422">https://www.rfc-editor.org/info/rfc8422</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8747">[RFC8747]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Seitz, L.</span>, <span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"Proof-of-Possession Key Semantics for CBOR Web Tokens (CWTs)"</span>, <span class="seriesInfo">RFC 8747</span>, <span class="seriesInfo">DOI 10.17487/RFC8747</span>, <time class="refDate" datetime="2020-03">March 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8747">https://www.rfc-editor.org/info/rfc8747</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8949">[RFC8949]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span> and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR)"</span>, <span class="seriesInfo">STD 94</span>, <span class="seriesInfo">RFC 8949</span>, <span class="seriesInfo">DOI 10.17487/RFC8949</span>, <time class="refDate" datetime="2020-12">December 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8949">https://www.rfc-editor.org/info/rfc8949</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9147">[RFC9147]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refAuthor">Tschofenig, H.</span>, and <span class="refAuthor">N. Modadugu</span>, <span class="refTitle">"The Datagram Transport Layer Security (DTLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 9147</span>, <span class="seriesInfo">DOI 10.17487/RFC9147</span>, <time class="refDate" datetime="2022-04">April 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9147">https://www.rfc-editor.org/info/rfc9147</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9200">[RFC9200]</dt>
        <dd>
<span class="refAuthor">Seitz, L.</span>, <span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Wahlstroem, E.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"Authentication and Authorization for Constrained Environments (ACE) Using the OAuth 2.0 Framework (ACE-OAuth)"</span>, <span class="seriesInfo">RFC 9200</span>, <span class="seriesInfo">DOI 10.17487/RFC9200</span>, <time class="refDate" datetime="2022-08">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9200">https://www.rfc-editor.org/info/rfc9200</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9201">[RFC9201]</dt>
      <dd>
<span class="refAuthor">Seitz, L.</span>, <span class="refTitle">"Additional OAuth Parameters for Authentication and Authorization for Constrained Environments (ACE)"</span>, <span class="seriesInfo">RFC 9201</span>, <span class="seriesInfo">DOI 10.17487/RFC9201</span>, <time class="refDate" datetime="2022-08">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9201">https://www.rfc-editor.org/info/rfc9201</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-10.2">
        <h3 id="name-informative-references">
<a class="section-number selfRef" href="#section-10.2">10.2. </a><a class="section-name selfRef" href="#name-informative-references">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC5869">[RFC5869]</dt>
        <dd>
<span class="refAuthor">Krawczyk, H.</span> and <span class="refAuthor">P. Eronen</span>, <span class="refTitle">"HMAC-based Extract-and-Expand Key Derivation Function (HKDF)"</span>, <span class="seriesInfo">RFC 5869</span>, <span class="seriesInfo">DOI 10.17487/RFC5869</span>, <time class="refDate" datetime="2010-05">May 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5869">https://www.rfc-editor.org/info/rfc5869</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6655">[RFC6655]</dt>
        <dd>
<span class="refAuthor">McGrew, D.</span> and <span class="refAuthor">D. Bailey</span>, <span class="refTitle">"AES-CCM Cipher Suites for Transport Layer Security (TLS)"</span>, <span class="seriesInfo">RFC 6655</span>, <span class="seriesInfo">DOI 10.17487/RFC6655</span>, <time class="refDate" datetime="2012-07">July 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6655">https://www.rfc-editor.org/info/rfc6655</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7662">[RFC7662]</dt>
        <dd>
<span class="refAuthor">Richer, J., Ed.</span>, <span class="refTitle">"OAuth 2.0 Token Introspection"</span>, <span class="seriesInfo">RFC 7662</span>, <span class="seriesInfo">DOI 10.17487/RFC7662</span>, <time class="refDate" datetime="2015-10">October 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7662">https://www.rfc-editor.org/info/rfc7662</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7748">[RFC7748]</dt>
        <dd>
<span class="refAuthor">Langley, A.</span>, <span class="refAuthor">Hamburg, M.</span>, and <span class="refAuthor">S. Turner</span>, <span class="refTitle">"Elliptic Curves for Security"</span>, <span class="seriesInfo">RFC 7748</span>, <span class="seriesInfo">DOI 10.17487/RFC7748</span>, <time class="refDate" datetime="2016-01">January 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7748">https://www.rfc-editor.org/info/rfc7748</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8032">[RFC8032]</dt>
        <dd>
<span class="refAuthor">Josefsson, S.</span> and <span class="refAuthor">I. Liusvaara</span>, <span class="refTitle">"Edwards-Curve Digital Signature Algorithm (EdDSA)"</span>, <span class="seriesInfo">RFC 8032</span>, <span class="seriesInfo">DOI 10.17487/RFC8032</span>, <time class="refDate" datetime="2017-01">January 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8032">https://www.rfc-editor.org/info/rfc8032</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time class="refDate" datetime="2018-08">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8610">[RFC8610]</dt>
      <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Vigano, C.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"Concise Data Definition Language (CDDL): A Notational Convention to Express Concise Binary Object Representation (CBOR) and JSON Data Structures"</span>, <span class="seriesInfo">RFC 8610</span>, <span class="seriesInfo">DOI 10.17487/RFC8610</span>, <time class="refDate" datetime="2019-06">June 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8610">https://www.rfc-editor.org/info/rfc8610</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="acknowledgments">
<section id="appendix-A">
      <h2 id="name-acknowledgments">
<a class="section-name selfRef" href="#name-acknowledgments">Acknowledgments</a>
      </h2>
<p id="appendix-A-1">Special thanks to <span class="contact-name">Jim Schaad</span> for his contributions and reviews of this
document and to <span class="contact-name">Ben Kaduk</span> for his thorough reviews of this
document. Thanks also to <span class="contact-name">Paul Kyzivat</span> for his review. The authors also
would like to thank <span class="contact-name">Marco Tiloca</span> for his contributions.<a class="pilcrow" href="#appendix-A-1">Â¶</a></p>
<p id="appendix-A-2"><span class="contact-name">Ludwig Seitz</span> worked on this document as part of the CelticNext
projects CyberWI and CRITISEC with funding from Vinnova.<a class="pilcrow" href="#appendix-A-2">Â¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-addresses">
<a class="section-name selfRef" href="#name-authors-addresses">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Stefanie Gerdes</span></div>
<div class="left" dir="auto"><span class="org">UniversitÃ¤t Bremen TZI</span></div>
<div class="left" dir="auto"><span class="street-address">Postfach 330440</span></div>
<div class="left" dir="auto">
<span class="postal-code">D-28359</span> <span class="locality">Bremen</span>
</div>
<div class="left" dir="auto"><span class="country-name">Germany</span></div>
<div class="tel">
<span>Phone:</span>
<a class="tel" href="tel:+49-421-218-63906">+49-421-218-63906</a>
</div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:gerdes@tzi.org">gerdes@tzi.org</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Olaf Bergmann</span></div>
<div class="left" dir="auto"><span class="org">UniversitÃ¤t Bremen TZI</span></div>
<div class="left" dir="auto"><span class="street-address">Postfach 330440</span></div>
<div class="left" dir="auto">
<span class="postal-code">D-28359</span> <span class="locality">Bremen</span>
</div>
<div class="left" dir="auto"><span class="country-name">Germany</span></div>
<div class="tel">
<span>Phone:</span>
<a class="tel" href="tel:+49-421-218-63904">+49-421-218-63904</a>
</div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:bergmann@tzi.org">bergmann@tzi.org</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Carsten Bormann</span></div>
<div class="left" dir="auto"><span class="org">UniversitÃ¤t Bremen TZI</span></div>
<div class="left" dir="auto"><span class="street-address">Postfach 330440</span></div>
<div class="left" dir="auto">
<span class="postal-code">D-28359</span> <span class="locality">Bremen</span>
</div>
<div class="left" dir="auto"><span class="country-name">Germany</span></div>
<div class="tel">
<span>Phone:</span>
<a class="tel" href="tel:+49-421-218-63921">+49-421-218-63921</a>
</div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:cabo@tzi.org">cabo@tzi.org</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">GÃ¶ran Selander</span></div>
<div class="left" dir="auto"><span class="org">Ericsson AB</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:goran.selander@ericsson.com">goran.selander@ericsson.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Ludwig Seitz</span></div>
<div class="left" dir="auto"><span class="org">Combitech</span></div>
<div class="left" dir="auto"><span class="street-address">DjÃ¤knegatan 31</span></div>
<div class="left" dir="auto">SE-<span class="postal-code">211 35</span> <span class="locality">MalmÃ¶</span>
</div>
<div class="left" dir="auto"><span class="country-name">Sweden</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:ludwig.seitz@combitech.com">ludwig.seitz@combitech.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>


</body></html>