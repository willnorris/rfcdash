<!DOCTYPE html>
<html class="RFC" lang="en"><head>
<meta charset="utf-8"/>
<meta content="Common,Latin" name="scripts"/>
<meta content="initial-scale=1.0" name="viewport"/>
<title>RFC 9442: Static Context Header Compression (SCHC) over Sigfox Low-Power Wide Area Network (LPWAN)</title>
<meta content="Juan Carlos Zúñiga" name="author"/>
<meta content="Carles Gomez" name="author"/>
<meta content="Sergio Aguilar" name="author"/>
<meta content="Laurent Toutain" name="author"/>
<meta content="Sandra Céspedes" name="author"/>
<meta content="Diego Wistuba" name="author"/>
<meta content="Julien Boite" name="author"/>
<meta content="
       The Static Context Header Compression (SCHC) and fragmentation specification (RFC 8724) describes a generic framework for application header compression and fragmentation modes designed for Low-Power Wide Area Network (LPWAN) technologies.
        This document defines a profile of SCHC over Sigfox LPWAN and provides optimal parameter values and modes of operation.
       
    " name="description"/>
<meta content="xml2rfc 3.17.4" name="generator"/>
<meta content="IoT" name="keyword"/>
<meta content="Sigfox" name="keyword"/>
<meta content="SCHC" name="keyword"/>
<meta content="LPWAN" name="keyword"/>
<meta content="fragmentation" name="keyword"/>
<meta content="Reliable Delivery" name="keyword"/>
<meta content="Link Layer Protocols" name="keyword"/>
<meta content="Cross-Layer Protocols" name="keyword"/>
<meta content="Adaptation Layer" name="keyword"/>
<meta content="9442" name="rfc.number"/>
<!-- Generator version information:
  xml2rfc 3.17.4
    Python 3.9.15
    ConfigArgParse 1.5.3
    google-i18n-address 3.0.0
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 4.9.0
    platformdirs 3.8.0
    pycountry 22.3.5
    PyYAML 6.0
    requests 2.28.0
    setuptools 44.1.1
    six 1.16.0
    wcwidth 0.2.5
    weasyprint 56.1
-->
<link href="rfc9442.xml" rel="alternate" type="application/rfc+xml"/>
<link href="#copyright" rel="license"/>
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necessary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

:root {
  --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
  --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
  --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
}

@viewport {
  zoom: 1.0;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: var(--font-sans);
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
svg[font-family~="serif" i], svg [font-family~="serif" i] {
  font-family: var(--font-serif);
}
svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
  font-family: var(--font-sans);
}
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef,
.iref + a[href].internal {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre {
  background-color: #f9f9f9;
  font-family: var(--font-mono);
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: var(--font-sans);
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  .breakable pre {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The following is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
.sourcecode pre,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .artwork > pre,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background slightly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottom margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the compact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div.sourcecode:first-child,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type:only-child {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css"/>
<link href="https://dx.doi.org/10.17487/rfc9442" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <link href="https://datatracker.ietf.org/doc/draft-ietf-lpwan-schc-over-sigfox-23" rel="prev"/>
  </head>
<body class="xml2rfc">
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 9442</td>
<td class="center">SCHC over Sigfox LPWAN</td>
<td class="right">July 2023</td>
</tr></thead>
<tfoot><tr>
<td class="left">Zúñiga, et al.</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div class="document-information" id="external-metadata"></div>
<div class="document-information" id="internal-metadata">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a class="eref" href="https://www.rfc-editor.org/rfc/rfc9442">9442</a></dd>
<dt class="label-category">Category:</dt>
<dd class="category">Standards Track</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time class="published" datetime="2023-07">July 2023</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">JC. Zúñiga</div>
</div>
<div class="author">
      <div class="author-name">C. Gomez</div>
<div class="org">Universitat Politècnica de Catalunya</div>
</div>
<div class="author">
      <div class="author-name">S. Aguilar</div>
<div class="org">Universitat Politècnica de Catalunya</div>
</div>
<div class="author">
      <div class="author-name">L. Toutain</div>
<div class="org">IMT-Atlantique</div>
</div>
<div class="author">
      <div class="author-name">S. Céspedes</div>
<div class="org">Concordia University</div>
</div>
<div class="author">
      <div class="author-name">D. Wistuba</div>
<div class="org">NIC Labs, Universidad de Chile</div>
</div>
<div class="author">
      <div class="author-name">J. Boite</div>
<div class="org">Unabiz (Sigfox)</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 9442</h1>
<h1 id="title">Static Context Header Compression (SCHC) over Sigfox Low-Power Wide Area Network (LPWAN)</h1>
<section id="section-abstract">
      <h2 id="abstract"><a class="selfRef" href="#abstract">Abstract</a></h2>
<p id="section-abstract-1">The Static Context Header Compression (SCHC) and fragmentation specification (RFC 8724) describes a generic framework for application header compression and fragmentation modes designed for Low-Power Wide Area Network (LPWAN) technologies.
        This document defines a profile of SCHC over Sigfox LPWAN and provides optimal parameter values and modes of operation.<a class="pilcrow" href="#section-abstract-1">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a class="section-name selfRef" href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This is an Internet Standards Track document.<a class="pilcrow" href="#section-boilerplate.1-1">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.<a class="pilcrow" href="#section-boilerplate.1-2">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc9442">https://www.rfc-editor.org/info/rfc9442</a></span>.<a class="pilcrow" href="#section-boilerplate.1-3">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a class="section-name selfRef" href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2023 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a class="pilcrow" href="#section-boilerplate.2-1">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a class="pilcrow" href="#section-boilerplate.2-2">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a class="toplink" href="#" onclick="scroll(0,0)">▲</a><h2 id="name-table-of-contents">
<a class="section-name selfRef" href="#name-table-of-contents">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p class="keepWithNext" id="section-toc.1-1.1.1"><a class="auto internal xref" href="#section-1">1</a>.  <a class="internal xref" href="#name-introduction">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p class="keepWithNext" id="section-toc.1-1.2.1"><a class="auto internal xref" href="#section-2">2</a>.  <a class="internal xref" href="#name-terminology">Terminology</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a class="auto internal xref" href="#section-3">3</a>.  <a class="internal xref" href="#name-schc-over-sigfox">SCHC over Sigfox</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p class="keepWithNext" id="section-toc.1-1.3.2.1.1"><a class="auto internal xref" href="#section-3.1">3.1</a>.  <a class="internal xref" href="#name-network-architecture">Network Architecture</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a class="auto internal xref" href="#section-3.2">3.2</a>.  <a class="internal xref" href="#name-uplink">Uplink</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a class="auto internal xref" href="#section-3.3">3.3</a>.  <a class="internal xref" href="#name-downlink">Downlink</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.1">
                    <p id="section-toc.1-1.3.2.3.2.1.1"><a class="auto internal xref" href="#section-3.3.1">3.3.1</a>.  <a class="internal xref" href="#name-schc-ack-on-downlink">SCHC ACK on Downlink</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a class="auto internal xref" href="#section-3.4">3.4</a>.  <a class="internal xref" href="#name-schc-rules">SCHC Rules</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a class="auto internal xref" href="#section-3.5">3.5</a>.  <a class="internal xref" href="#name-fragmentation">Fragmentation</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5.2.1">
                    <p id="section-toc.1-1.3.2.5.2.1.1"><a class="auto internal xref" href="#section-3.5.1">3.5.1</a>.  <a class="internal xref" href="#name-uplink-fragmentation">Uplink Fragmentation</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5.2.2">
                    <p id="section-toc.1-1.3.2.5.2.2.1"><a class="auto internal xref" href="#section-3.5.2">3.5.2</a>.  <a class="internal xref" href="#name-downlink-fragmentation">Downlink Fragmentation</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6">
                <p id="section-toc.1-1.3.2.6.1"><a class="auto internal xref" href="#section-3.6">3.6</a>.  <a class="internal xref" href="#name-schc-over-sigfox-f-r-messag">SCHC over Sigfox F/R Message Formats</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6.2.1">
                    <p id="section-toc.1-1.3.2.6.2.1.1"><a class="auto internal xref" href="#section-3.6.1">3.6.1</a>.  <a class="internal xref" href="#name-uplink-no-ack-mode-single-by">Uplink No-ACK Mode: Single-Byte SCHC Header</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6.2.2">
                    <p id="section-toc.1-1.3.2.6.2.2.1"><a class="auto internal xref" href="#section-3.6.2">3.6.2</a>.  <a class="internal xref" href="#name-uplink-ack-on-error-mode-sin">Uplink ACK-on-Error Mode: Single-Byte SCHC Header</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6.2.3">
                    <p id="section-toc.1-1.3.2.6.2.3.1"><a class="auto internal xref" href="#section-3.6.3">3.6.3</a>.  <a class="internal xref" href="#name-uplink-ack-on-error-mode-two-">Uplink ACK-on-Error Mode: Two-Byte SCHC Header Option 1</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6.2.4">
                    <p id="section-toc.1-1.3.2.6.2.4.1"><a class="auto internal xref" href="#section-3.6.4">3.6.4</a>.  <a class="internal xref" href="#name-uplink-ack-on-error-mode-two-b">Uplink ACK-on-Error Mode: Two-Byte SCHC Header Option 2</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6.2.5">
                    <p id="section-toc.1-1.3.2.6.2.5.1"><a class="auto internal xref" href="#section-3.6.5">3.6.5</a>.  <a class="internal xref" href="#name-downlink-ack-always-mode-si">Downlink ACK-Always Mode: Single-Byte SCHC Header</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.7">
                <p id="section-toc.1-1.3.2.7.1"><a class="auto internal xref" href="#section-3.7">3.7</a>.  <a class="internal xref" href="#name-padding">Padding</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a class="auto internal xref" href="#section-4">4</a>.  <a class="internal xref" href="#name-fragmentation-rules-example">Fragmentation Rules Examples</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a class="auto internal xref" href="#section-4.1">4.1</a>.  <a class="internal xref" href="#name-uplink-fragmentation-rules-">Uplink Fragmentation Rules Examples</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a class="auto internal xref" href="#section-4.2">4.2</a>.  <a class="internal xref" href="#name-downlink-fragmentation-rule">Downlink Fragmentation Rules Example</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a class="auto internal xref" href="#section-5">5</a>.  <a class="internal xref" href="#name-fragmentation-sequence-exam">Fragmentation Sequence Examples</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a class="auto internal xref" href="#section-5.1">5.1</a>.  <a class="internal xref" href="#name-uplink-no-ack-examples">Uplink No-ACK Examples</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a class="auto internal xref" href="#section-5.2">5.2</a>.  <a class="internal xref" href="#name-uplink-ack-on-error-example">Uplink ACK-on-Error Examples: Single-Byte SCHC Header</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a class="auto internal xref" href="#section-5.3">5.3</a>.  <a class="internal xref" href="#name-schc-abort-examples">SCHC Abort Examples</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a class="auto internal xref" href="#section-6">6</a>.  <a class="internal xref" href="#name-security-considerations">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a class="auto internal xref" href="#section-7">7</a>.  <a class="internal xref" href="#name-iana-considerations">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a class="auto internal xref" href="#section-8">8</a>.  <a class="internal xref" href="#name-references">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a class="auto internal xref" href="#section-8.1">8.1</a>.  <a class="internal xref" href="#name-normative-references">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a class="auto internal xref" href="#section-8.2">8.2</a>.  <a class="internal xref" href="#name-informative-references">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a class="auto internal xref" href="#appendix-A"></a><a class="internal xref" href="#name-acknowledgements">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a class="auto internal xref" href="#appendix-B"></a><a class="internal xref" href="#name-authors-addresses">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="Introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a class="section-number selfRef" href="#section-1">1. </a><a class="section-name selfRef" href="#name-introduction">Introduction</a>
      </h2>
<p id="section-1-1">The Generic Framework for Static Context Header Compression (SCHC) and Fragmentation specification <span>[<a class="cite xref" href="#RFC8724">RFC8724</a>]</span> can be used in conjunction with any of the four LPWAN technologies
described in <span>[<a class="cite xref" href="#RFC8376">RFC8376</a>]</span>. These LPWANs have similar characteristics, such as star-oriented
topologies, network architecture, connected devices with built-in applications, etc.<a class="pilcrow" href="#section-1-1">¶</a></p>
<p id="section-1-2">SCHC offers a considerable degree of flexibility to accommodate all these LPWAN technologies. Even though there are a great number of similarities between
them, some differences exist with respect to the transmission characteristics, payload sizes, etc. Hence, there are optimal parameters and modes of operation 
that can be used when SCHC is used in conjunction with a specific LPWAN technology.<a class="pilcrow" href="#section-1-2">¶</a></p>
<p id="section-1-3">
    Sigfox is an LPWAN technology that offers energy-efficient connectivity for devices at a very low cost.
    Complete Sigfox documentation can be found in <span>[<a class="cite xref" href="#sigfox-docs">sigfox-docs</a>]</span>.
    Sigfox aims to provide a very wide area network composed of Base Stations that receive short Uplink messages (up to 12 bytes in size) sent by devices over the long-range Sigfox radio protocol, as described in <span>[<a class="cite xref" href="#RFC8376">RFC8376</a>]</span>.
    Base Stations then forward messages to the Sigfox Cloud infrastructure for further processing (e.g., to offer geolocation services) and final delivery to the customer.
        Base Stations also relay Downlink messages (with a fixed 8-byte size) sent by the Sigfox Cloud to the devices,  i.e., Downlink messages are being generated when devices explicitly request these messages with a flag in an Uplink message.
    With SCHC functionalities, the Sigfox network offers more reliable communications (including recovery of lost messages) and is able to convey extended-size payloads (allowing for fragmentation/reassembly of
messages) <span>[<a class="cite xref" href="#sigfox-spec">sigfox-spec</a>]</span>.<a class="pilcrow" href="#section-1-3">¶</a></p>
<p id="section-1-4">This document describes the parameters, settings, and modes of operation to be used when SCHC is implemented over a Sigfox LPWAN. The set of parameters forms a "SCHC over Sigfox Profile".
    The SCHC over Sigfox Profile is applicable to the Sigfox Radio specification versions up to v1.6/March
2022 <span>[<a class="cite xref" href="#sigfox-spec">sigfox-spec</a>]</span>  (support for future versions would have to be assessed).<a class="pilcrow" href="#section-1-4">¶</a></p>
</section>
</div>
<div id="terminology">
<section id="section-2">
      <h2 id="name-terminology">
<a class="section-number selfRef" href="#section-2">2. </a><a class="section-name selfRef" href="#name-terminology">Terminology</a>
      </h2>
<p id="section-2-1">
    The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
    "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
    described in BCP 14 <span>[<a class="cite xref" href="#RFC2119">RFC2119</a>]</span> <span>[<a class="cite xref" href="#RFC8174">RFC8174</a>]</span> 
    when, and only when, they appear in all capitals, as shown here.<a class="pilcrow" href="#section-2-1">¶</a></p>
<p id="section-2-2">It is assumed that the reader is familiar with the terms and mechanisms defined in <span>[<a class="cite xref" href="#RFC8376">RFC8376</a>]</span> and <span>[<a class="cite xref" href="#RFC8724">RFC8724</a>]</span>. Also, it is assumed that the reader is familiar with Sigfox terminology <span>[<a class="cite xref" href="#sigfox-spec">sigfox-spec</a>]</span>.<a class="pilcrow" href="#section-2-2">¶</a></p>
</section>
</div>
<div id="schc-over-sigfox">
<section id="section-3">
      <h2 id="name-schc-over-sigfox">
<a class="section-number selfRef" href="#section-3">3. </a><a class="section-name selfRef" href="#name-schc-over-sigfox">SCHC over Sigfox</a>
      </h2>
<p id="section-3-1">The Generic SCHC Framework described in <span>[<a class="cite xref" href="#RFC8724">RFC8724</a>]</span> takes advantage of previous knowledge of traffic flows existing in LPWAN applications to avoid context synchronization.<a class="pilcrow" href="#section-3-1">¶</a></p>
<p id="section-3-2">Contexts need to be stored and pre-configured on both ends.
    This can be done either by using a provisioning protocol, by out-of-band means, or by
    pre-provisioning them (e.g., at manufacturing time).
    For example, the context exchange can be done by using the Network Configuration Protocol (NETCONF) <span>[<a class="cite xref" href="#RFC6241">RFC6241</a>]</span> with Secure Shell (SSH), RESTCONF <span>[<a class="cite xref" href="#RFC8040">RFC8040</a>]</span> with secure HTTP methods, and CoAP Management Interface (CORECONF) <span>[<a class="cite xref" href="#I-D.ietf-core-comi">CORE-COMI</a>]</span> with the Constrained Application Protocol (CoAP) <span>[<a class="cite xref" href="#RFC7252">RFC7252</a>]</span> as provisioning protocols. The contexts can be encoded in XML under NETCONF, in JSON <span>[<a class="cite xref" href="#RFC8259">RFC8259</a>]</span> under RESTCONF, and in Concise Binary Object Representation (CBOR) <span>[<a class="cite xref" href="#RFC8949">RFC8949</a>]</span> under CORECONF.
    The way contexts are configured and stored on both ends is out of the scope of this document.<a class="pilcrow" href="#section-3-2">¶</a></p>
<div id="network-arch">
<section id="section-3.1">
        <h3 id="name-network-architecture">
<a class="section-number selfRef" href="#section-3.1">3.1. </a><a class="section-name selfRef" href="#name-network-architecture">Network Architecture</a>
        </h3>
<p id="section-3.1-1"><a class="auto internal xref" href="#Fig-archi">Figure 1</a> represents the architecture for Compression/Decompression (C/D) and Fragmentation/Reassembly (F/R) based
on the terminology defined in <span>[<a class="cite xref" href="#RFC8376">RFC8376</a>]</span>, where the Radio Gateway (RGW) is a Sigfox Base Station and the Network Gateway (NGW) is the
Sigfox cloud-based Network.<a class="pilcrow" href="#section-3.1-1">¶</a></p>
<span id="name-network-architecture-2"></span><div id="Fig-archi">
<figure id="figure-1">
          <div class="alignCenter art-text artwork" id="section-3.1-2.1">
<pre>  Sigfox Device                                           Application
+----------------+                                     +--------------+
| APP1 APP2 APP3 |                                     |APP1 APP2 APP3|
+----------------+                                     +--------------+
|   UDP  |       |                                     |     |  UDP   |
|  IPv6  |       |                                     |     | IPv6   |
+--------+       |                                     |     +--------+
| SCHC C/D &amp; F/R |                                     |              |
|                |                                     |              |
+-------+--------+                                     +--------+-----+
        $                                                       .
        $   +---------+     +--------------+     +---------+    .
        $   |         |     |   Network    |     | Network |    .
        +~~ |Sigfox BS|     |   Gateway    |     |  SCHC   |    .
            |  (RGW)  | === |    (NGW)     | ... |C/D &amp; F/R|.....
            |         |     | Sigfox Cloud |     |         |   IP-based
            +---------+     +--------------+     +---------+   Network
------- Uplink message ------&gt;
                                       &lt;------- Downlink message ------
Legend:
$, ~ : Radio link
= : Internal Sigfox Network
. : External IP-based Network
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-1">Figure 1</a>:
<a class="selfRef" href="#name-network-architecture-2">Network Architecture</a>
          </figcaption></figure>
</div>
<p id="section-3.1-3">In the case of the global Sigfox network, RGWs (or Base Stations) are distributed over multiple countries wherever the Sigfox LPWAN service is provided.
The NGW (or cloud-based Sigfox Core Network) is a single entity that connects to all RGWs (Sigfox Base Stations) in the world, hence providing a global single star Network topology.<a class="pilcrow" href="#section-3.1-3">¶</a></p>
<p id="section-3.1-4">The Sigfox Device sends application packets that are compressed and/or fragmented by a SCHC C/D + F/R to reduce header size and/or fragment the packet.
The resulting SCHC message is sent over a layer two (L2) Sigfox frame to the Sigfox Base Stations, which then forward the SCHC message to the NGW.
The NGW then delivers the SCHC message and associated gathered metadata to the Network SCHC C/D + F/R.<a class="pilcrow" href="#section-3.1-4">¶</a></p>
<p id="section-3.1-5">The Sigfox cloud-based Network communicates with the Network SCHC C/D + F/R for compression/decompression and/or for fragmentation/reassembly. The Network SCHC C/D + F/R shares the same set of Rules 
as the device SCHC C/D + F/R. The Network SCHC C/D + F/R can be collocated with the NGW or it could be located in a different place, as long as a tunnel or secured communication is established between
the NGW and the SCHC C/D + F/R functions. After decompression and/or reassembly, the packet can be forwarded over the Internet to one (or several) LPWAN Application Server(s) (App(s)).<a class="pilcrow" href="#section-3.1-5">¶</a></p>
<p id="section-3.1-6">The SCHC C/D + F/R processes are bidirectional, so the same principles are applicable on both Uplink (UL) and Downlink (DL).<a class="pilcrow" href="#section-3.1-6">¶</a></p>
</section>
</div>
<div id="uplink">
<section id="section-3.2">
        <h3 id="name-uplink">
<a class="section-number selfRef" href="#section-3.2">3.2. </a><a class="section-name selfRef" href="#name-uplink">Uplink</a>
        </h3>
<p id="section-3.2-1">Uplink Sigfox transmissions occur in repetitions over different times and frequencies. 
Besides time and frequency diversities, the Sigfox network also provides spatial diversity, as potentially an Uplink message will be received by several Base Stations. The Uplink message application payload size can be up to 12 bytes.<a class="pilcrow" href="#section-3.2-1">¶</a></p>
<p id="section-3.2-2">Since all messages are self-contained and Base Stations forward all these messages back to the same Sigfox network, multiple input copies can be 
combined at the NGW, providing for extra reliability based on the triple diversity (i.e., time, space, and frequency).<a class="pilcrow" href="#section-3.2-2">¶</a></p>
<p id="section-3.2-3">
A detailed description of the Sigfox radio protocol can be found in <span>[<a class="cite xref" href="#sigfox-spec">sigfox-spec</a>]</span>.<a class="pilcrow" href="#section-3.2-3">¶</a></p>
<p id="section-3.2-4">Messages sent from the device to the Network are delivered by the Sigfox cloud-based Network to the Network SCHC C/D + F/R through a  callback/API with the following information:<a class="pilcrow" href="#section-3.2-4">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-5.1">Device ID<a class="pilcrow" href="#section-3.2-5.1">¶</a>
</li>
          <li class="normal" id="section-3.2-5.2">Message Sequence Number<a class="pilcrow" href="#section-3.2-5.2">¶</a>
</li>
          <li class="normal" id="section-3.2-5.3">Message Payload<a class="pilcrow" href="#section-3.2-5.3">¶</a>
</li>
          <li class="normal" id="section-3.2-5.4">Message Timestamp<a class="pilcrow" href="#section-3.2-5.4">¶</a>
</li>
          <li class="normal" id="section-3.2-5.5">Device Geolocation (optional)<a class="pilcrow" href="#section-3.2-5.5">¶</a>
</li>
          <li class="normal" id="section-3.2-5.6">Received Signal Strength Indicator (RSSI) (optional)<a class="pilcrow" href="#section-3.2-5.6">¶</a>
</li>
          <li class="normal" id="section-3.2-5.7">Device Temperature (optional)<a class="pilcrow" href="#section-3.2-5.7">¶</a>
</li>
          <li class="normal" id="section-3.2-5.8">Device Battery Voltage (optional)<a class="pilcrow" href="#section-3.2-5.8">¶</a>
</li>
        </ul>
<p id="section-3.2-6">The Device ID is a globally unique identifier assigned to the device, which is included in the Sigfox header of every message. The Message Sequence Number is a monotonically 
increasing number identifying the specific transmission of this Uplink message, and it is also part of the Sigfox header. The Message Payload corresponds to the payload that the
device has sent in the Uplink transmission.
 Battery Voltage, Device Temperature, and RSSI values are sent in the confirmation control message, which is mandatorily sent by the device after the successful reception of a Downlink message (see <span>[<a class="cite xref" href="#sigfox-callbacks">sigfox-callbacks</a>]</span>, Section 5.2).<a class="pilcrow" href="#section-3.2-6">¶</a></p>
<p id="section-3.2-7">The Message Timestamp, Device Geolocation, RSSI, Device Temperature, and Device Battery Voltage are metadata parameters provided by the Network.<a class="pilcrow" href="#section-3.2-7">¶</a></p>
<p id="section-3.2-8">A detailed description of the Sigfox callbacks/APIs can be found in <span>[<a class="cite xref" href="#sigfox-callbacks">sigfox-callbacks</a>]</span>.<a class="pilcrow" href="#section-3.2-8">¶</a></p>
<p id="section-3.2-9">Only messages that have passed the L2 Cyclic Redundancy Check (CRC) at Network reception are delivered by the Sigfox network to the Network SCHC C/D + F/R.<a class="pilcrow" href="#section-3.2-9">¶</a></p>
<p id="section-3.2-10">The L2 Word size used by Sigfox is 1 byte (8 bits).<a class="pilcrow" href="#section-3.2-10">¶</a></p>
<p id="section-3.2-11"><a class="auto internal xref" href="#SCHC-Message">Figure 2</a> shows a SCHC message sent over Sigfox, where the SCHC message could be a full SCHC Packet (e.g., compressed)
or a SCHC Fragment (e.g., a piece of a bigger SCHC Packet).<a class="pilcrow" href="#section-3.2-11">¶</a></p>
<span id="name-schc-message-in-sigfox"></span><div id="SCHC-Message">
<figure id="figure-2">
          <div class="alignCenter art-text artwork" id="section-3.2-12.1">
<pre>| Sigfox Header | Sigfox Payload  |
+---------------+---------------- +
                |   SCHC Message  |
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-2">Figure 2</a>:
<a class="selfRef" href="#name-schc-message-in-sigfox">SCHC Message in Sigfox</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="downlink">
<section id="section-3.3">
        <h3 id="name-downlink">
<a class="section-number selfRef" href="#section-3.3">3.3. </a><a class="section-name selfRef" href="#name-downlink">Downlink</a>
        </h3>
<p id="section-3.3-1">
   Downlink transmissions are device-driven and can only take place
   following an Uplink communication that indicates Downlink communication can be performed. Hence, a Sigfox Device explicitly indicates its intention to receive a Downlink message (with a size of 8 bytes)
using a Downlink request flag when sending the preceding Uplink message to the Network. The Downlink request flag is part of the Sigfox protocol headers. After completing the Uplink transmission, the device opens a fixed window for Downlink reception.
The delay and duration of the reception opportunity window have fixed values. If there is a Downlink message to be sent for this given device (e.g., either
a response to the Uplink message or queued information waiting to be transmitted), the Network transmits this message to the device during the reception window. If no message is received by the device after
the reception opportunity window has elapsed, the device closes the reception window opportunity and gets back to the normal mode (e.g., continue Uplink transmissions, sleep, standby, etc.).<a class="pilcrow" href="#section-3.3-1">¶</a></p>
<p id="section-3.3-2">When a Downlink message is sent to a device, a reception acknowledgement is generated by the device, sent back to the Network through the Sigfox radio protocol, and reported in the Sigfox network backend.<a class="pilcrow" href="#section-3.3-2">¶</a></p>
<p id="section-3.3-3">
A detailed description of the Sigfox radio protocol can be found in <span>[<a class="cite xref" href="#sigfox-spec">sigfox-spec</a>]</span>, and a detailed description of the Sigfox callbacks/APIs can be found in <span>[<a class="cite xref" href="#sigfox-callbacks">sigfox-callbacks</a>]</span>. A Downlink request flag can be included in the information exchange between the Sigfox network and Network SCHC.<a class="pilcrow" href="#section-3.3-3">¶</a></p>
<div id="dl_ack">
<section id="section-3.3.1">
          <h4 id="name-schc-ack-on-downlink">
<a class="section-number selfRef" href="#section-3.3.1">3.3.1. </a><a class="section-name selfRef" href="#name-schc-ack-on-downlink">SCHC ACK on Downlink</a>
          </h4>
<p id="section-3.3.1-1">
As explained previously, Downlink transmissions are driven by devices and can only take place following a specific Uplink transmission that indicates and allows a following Downlink opportunity.
For this reason, when SCHC bidirectional services are used (e.g., ACK-on-Error fragmentation mode), the SCHC protocol implementation needs to consider the times when a Downlink message
(e.g., SCHC Acknowledgement (ACK)) can be sent and/or received.<a class="pilcrow" href="#section-3.3.1-1">¶</a></p>
<p id="section-3.3.1-2">
For the Uplink ACK-on-Error fragmentation mode, a Downlink opportunity <span class="bcp14">MUST</span> be indicated by the last fragment of every window, which is signalled by a specific value of the Fragment Compressed Number (FCN) value, i.e., FCN = All-0 or FCN = All-1. The FCN is the tile index in a specific window. The combination of the FCN and the window number uniquely identifies a SCHC Fragment, as explained in <span>[<a class="cite xref" href="#RFC8724">RFC8724</a>]</span>.
    The device sends the fragments in sequence and, after
transmitting FCN = All-0 or FCN = All-1, it opens up a reception opportunity. The Network SCHC can then decide to respond at that opportunity (or wait for a further one) with a SCHC ACK, indicating that there are missing fragments from the current or previous windows. If there is no SCHC ACK to be sent, or if the Network decides to wait for a further Downlink transmission opportunity, then no
Downlink transmission takes place at that opportunity and the Uplink transmissions continue after a timeout.
   Intermediate SCHC Fragments with FCNs that are different from All-0 or All-1 <span class="bcp14">MUST NOT</span> use the Downlink request flag to request a SCHC ACK.<a class="pilcrow" href="#section-3.3.1-2">¶</a></p>
</section>
</div>
</section>
</div>
<div id="schc-rules">
<section id="section-3.4">
        <h3 id="name-schc-rules">
<a class="section-number selfRef" href="#section-3.4">3.4. </a><a class="section-name selfRef" href="#name-schc-rules">SCHC Rules</a>
        </h3>
<p id="section-3.4-1">
The RuleID <span class="bcp14">MUST</span> be included in the SCHC header. The total number of Rules to be used directly affects the RuleID field size, and therefore
the total size of the fragmentation header. For this reason, it is <span class="bcp14">RECOMMENDED</span> to keep the number of Rules that are defined for a specific device to the minimum possible.
    Large RuleID sizes (and thus larger fragmentation headers) are acceptable for devices without significant energy constraints (e.g., a sensor that is powered by the electricity grid).<a class="pilcrow" href="#section-3.4-1">¶</a></p>
<p id="section-3.4-2">
RuleIDs can be used to differentiate data traffic classes (e.g.,  QoS, control vs. data, etc.) and data sessions.
They can also be used to interleave simultaneous fragmentation sessions between a device and the Network.<a class="pilcrow" href="#section-3.4-2">¶</a></p>
</section>
</div>
<div id="Frag">
<section id="section-3.5">
        <h3 id="name-fragmentation">
<a class="section-number selfRef" href="#section-3.5">3.5. </a><a class="section-name selfRef" href="#name-fragmentation">Fragmentation</a>
        </h3>
<p id="section-3.5-1">
The SCHC specification <span>[<a class="cite xref" href="#RFC8724">RFC8724</a>]</span> defines a generic fragmentation functionality that
allows sending data packets or files larger than the maximum size of a Sigfox payload. The functionality also defines a mechanism to reliably send multiple messages by allowing to selectively resend any lost fragments.<a class="pilcrow" href="#section-3.5-1">¶</a></p>
<p id="section-3.5-2">
The SCHC fragmentation supports several modes of operation. These modes have different advantages and disadvantages, depending 
on the specifics of the underlying LPWAN technology and application use case. This section describes how the SCHC fragmentation functionality 
should optimally be implemented when used over a Sigfox LPWAN for the most typical use case applications.<a class="pilcrow" href="#section-3.5-2">¶</a></p>
<p id="section-3.5-3">As described in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8724#section-8.2.3">Section 8.2.3</a> of [<a class="cite xref" href="#RFC8724">RFC8724</a>]</span>, the integrity of the fragmentation-reassembly process of a SCHC Packet <span class="bcp14">MUST</span> be 
checked at the receiver end. Since only Uplink/Downlink messages/fragments that have passed the Sigfox CRC-check are delivered to the Network/Sigfox Device SCHC C/D + F/R,
integrity can be guaranteed when no consecutive messages are missing from the sequence and all FCN bitmaps are complete.  With this functionality
in mind, and in order to save protocol and processing overhead, the use of a Reassembly Check Sequence (RCS), as described in 
<a class="auto internal xref" href="#all-1-behaviour">Section 3.5.1.5</a>, <span class="bcp14">MUST</span> be used.<a class="pilcrow" href="#section-3.5-3">¶</a></p>
<div id="uplink-fragmentation">
<section id="section-3.5.1">
          <h4 id="name-uplink-fragmentation">
<a class="section-number selfRef" href="#section-3.5.1">3.5.1. </a><a class="section-name selfRef" href="#name-uplink-fragmentation">Uplink Fragmentation</a>
          </h4>
<p id="section-3.5.1-1">Sigfox Uplink transmissions are completely asynchronous and take place in any random frequency of the allowed Uplink bandwidth allocation.
In addition, devices may go to deep sleep mode and then wake up and transmit whenever there is a need to send information to the Network, as there is no need to perform any Network attachment, synchronization, or other procedures before transmitting a data packet.<a class="pilcrow" href="#section-3.5.1-1">¶</a></p>
<p id="section-3.5.1-2">Since Uplink transmissions are asynchronous, a SCHC Fragment can be transmitted at any given time by the device. Sigfox Uplink messages
are fixed in size, and as described in <span>[<a class="cite xref" href="#RFC8376">RFC8376</a>]</span>, they can carry a payload of 0-12 bytes (0-96 bits). Hence, a single SCHC Tile size, per fragmentation 
mode, can be defined so that every Sigfox message always carries one SCHC Tile.<a class="pilcrow" href="#section-3.5.1-2">¶</a></p>
<p id="section-3.5.1-3">When the ACK-on-Error mode is used for Uplink fragmentation, the SCHC Compound ACK defined in <span>[<a class="cite xref" href="#RFC9441">RFC9441</a>]</span> <span class="bcp14">MUST</span> be used in the Downlink responses.<a class="pilcrow" href="#section-3.5.1-3">¶</a></p>
<div id="schc_sender_abort">
<section id="section-3.5.1.1">
            <h5 id="name-schc-sender-abort">
<a class="section-number selfRef" href="#section-3.5.1.1">3.5.1.1. </a><a class="section-name selfRef" href="#name-schc-sender-abort">SCHC Sender-Abort</a>
            </h5>
<p id="section-3.5.1.1-1">As defined in <span>[<a class="cite xref" href="#RFC8724">RFC8724</a>]</span>, a SCHC Sender-Abort can be triggered when the number of SCHC ACK REQ attempts is greater than or equal to MAX_ACK_REQUESTS.
In the case of SCHC over Sigfox, a SCHC Sender-Abort <span class="bcp14">MUST</span> be sent if the number of repeated All-1s sent in sequence, without a Compound ACK reception in between, is greater than or equal to MAX_ACK_REQUESTS.<a class="pilcrow" href="#section-3.5.1.1-1">¶</a></p>
</section>
</div>
<div id="schc_receiver_abort">
<section id="section-3.5.1.2">
            <h5 id="name-schc-receiver-abort">
<a class="section-number selfRef" href="#section-3.5.1.2">3.5.1.2. </a><a class="section-name selfRef" href="#name-schc-receiver-abort">SCHC Receiver-Abort</a>
            </h5>
<p id="section-3.5.1.2-1">As defined in <span>[<a class="cite xref" href="#RFC8724">RFC8724</a>]</span>, a SCHC Receiver-Abort is triggered when the receiver has no RuleID and DTag pairs available for a new session.
In the case of this profile, a SCHC Receiver-Abort <span class="bcp14">MUST</span> be sent if, for a single device, all the RuleIDs are being processed by the receiver (i.e., have an active session)
at a certain time and a new one is requested or if the RuleID of the fragment is not valid.<a class="pilcrow" href="#section-3.5.1.2-1">¶</a></p>
<p id="section-3.5.1.2-2">A SCHC Receiver-Abort <span class="bcp14">MUST</span> be triggered when the Inactivity Timer expires.<a class="pilcrow" href="#section-3.5.1.2-2">¶</a></p>
<p id="section-3.5.1.2-3">MAX_ACK_REQUESTS can be increased when facing high error rates.<a class="pilcrow" href="#section-3.5.1.2-3">¶</a></p>
<p id="section-3.5.1.2-4">Although a SCHC Receiver-Abort can be triggered at any point in time, a SCHC Receiver-Abort Downlink message <span class="bcp14">MUST</span> only be sent when there is a Downlink transmission opportunity.<a class="pilcrow" href="#section-3.5.1.2-4">¶</a></p>
</section>
</div>
<div id="single-byte-schc-header">
<section id="section-3.5.1.3">
            <h5 id="name-single-byte-schc-header-for">
<a class="section-number selfRef" href="#section-3.5.1.3">3.5.1.3. </a><a class="section-name selfRef" href="#name-single-byte-schc-header-for">Single-Byte SCHC Header for Uplink Fragmentation</a>
            </h5>
<div id="no-ack-mode">
<section id="section-3.5.1.3.1">
              <h6 id="name-uplink-no-ack-mode-single-b">
<a class="section-number selfRef" href="#section-3.5.1.3.1">3.5.1.3.1. </a><a class="section-name selfRef" href="#name-uplink-no-ack-mode-single-b">Uplink No-ACK Mode: Single-Byte SCHC Header</a>
              </h6>
<p id="section-3.5.1.3.1-1">Single-byte SCHC Header No-ACK mode <span class="bcp14">MUST</span> be used for transmitting short, non-critical packets that require fragmentation and do not require full reliability.
This mode can be used by Uplink-only devices that do not support Downlink communications or by bidirectional devices when they send non-critical
data.
Note that sending non-critical data by using a reliable fragmentation mode (which is only possible for bidirectional devices) may incur unnecessary overhead.<a class="pilcrow" href="#section-3.5.1.3.1-1">¶</a></p>
<p id="section-3.5.1.3.1-2">Since there are no multiple windows in the No-ACK mode, the W bit is not present.
    However, it <span class="bcp14">MUST</span> use the FCN field to indicate the
size of the data packet. In this sense, the data packet would need to be split into X fragments and, similarly to the other fragmentation modes,
the first transmitted fragment would need to be marked with FCN = X-1. Consecutive fragments <span class="bcp14">MUST</span> be marked with decreasing FCN values, having the 
last fragment marked with FCN = (All-1). Hence, even though the No-ACK mode does not allow recovering missing fragments, it allows implicitly indicating 
the size of the expected packet to the Network and hence detects whether all fragments have been received or not at the receiver side.
In case the FCN field is not used to indicate the size of the data packet, the Network can detect whether all fragments have been received or not by using the integrity check.<a class="pilcrow" href="#section-3.5.1.3.1-2">¶</a></p>
<p id="section-3.5.1.3.1-3">When using the Single-byte SCHC Header for Uplink fragmentation, the
       fragmentation header <span class="bcp14">MUST</span> be 8 bits in size and is composed as follows:<a class="pilcrow" href="#section-3.5.1.3.1-3">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5.1.3.1-4.1">RuleID size: 3 bits<a class="pilcrow" href="#section-3.5.1.3.1-4.1">¶</a>
</li>
                <li class="normal" id="section-3.5.1.3.1-4.2">DTag size (T): 0 bits<a class="pilcrow" href="#section-3.5.1.3.1-4.2">¶</a>
</li>
                <li class="normal" id="section-3.5.1.3.1-4.3">Fragment Compressed Number (FCN) size (N): 5 bits<a class="pilcrow" href="#section-3.5.1.3.1-4.3">¶</a>
</li>
              </ul>
<p id="section-3.5.1.3.1-5">Other F/R parameters <span class="bcp14">MUST</span> be configured as follows:<a class="pilcrow" href="#section-3.5.1.3.1-5">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5.1.3.1-6.1">As per <span>[<a class="cite xref" href="#RFC8724">RFC8724</a>]</span>, in the No-ACK mode, the W (window) field is not present.<a class="pilcrow" href="#section-3.5.1.3.1-6.1">¶</a>
</li>
                <li class="normal" id="section-3.5.1.3.1-6.2">Regular tile size: 11 bytes<a class="pilcrow" href="#section-3.5.1.3.1-6.2">¶</a>
</li>
                <li class="normal" id="section-3.5.1.3.1-6.3">All-1 tile size: 0 to 10 bytes<a class="pilcrow" href="#section-3.5.1.3.1-6.3">¶</a>
</li>
                <li class="normal" id="section-3.5.1.3.1-6.4">Inactivity Timer: Application-dependent. The default value is 12 hours.<a class="pilcrow" href="#section-3.5.1.3.1-6.4">¶</a>
</li>
                <li class="normal" id="section-3.5.1.3.1-6.5">RCS size: 5 bits<a class="pilcrow" href="#section-3.5.1.3.1-6.5">¶</a>
</li>
              </ul>
<p id="section-3.5.1.3.1-7">The maximum SCHC Packet size is 340 bytes.<a class="pilcrow" href="#section-3.5.1.3.1-7">¶</a></p>
<p id="section-3.5.1.3.1-8"><a class="auto internal xref" href="#UL-NoACK-single-byte">Section 3.6.1</a> presents SCHC Fragment format examples, and <a class="auto internal xref" href="#no-ack-examples">Section 5.1</a> provides fragmentation examples, using Single-byte SCHC Header No-ACK mode.<a class="pilcrow" href="#section-3.5.1.3.1-8">¶</a></p>
</section>
</div>
<div id="ack-on-error-mode-1">
<section id="section-3.5.1.3.2">
              <h6 id="name-uplink-ack-on-error-mode-si">
<a class="section-number selfRef" href="#section-3.5.1.3.2">3.5.1.3.2. </a><a class="section-name selfRef" href="#name-uplink-ack-on-error-mode-si">Uplink ACK-on-Error Mode: Single-Byte SCHC Header</a>
              </h6>
<p id="section-3.5.1.3.2-1">ACK-on-Error with a single-byte header <span class="bcp14">MUST</span> be used for short- to medium-sized packets that need to be sent
   reliably. ACK-on-Error is optimal for reliable SCHC Packet transmission over Sigfox transmissions, since it leads to a reduced number of ACKs
   in the lower-capacity Downlink channel. Also, Downlink messages can be sent asynchronously and opportunistically.
    In contrast, ACK-Always would not minimize the number of ACKs, and No-ACK would not allow reliable transmission.<a class="pilcrow" href="#section-3.5.1.3.2-1">¶</a></p>
<p id="section-3.5.1.3.2-2">Allowing transmission of packets/files up to 300 bytes long, the SCHC Uplink fragmentation header size is 8 bits in size and is composed as follows:<a class="pilcrow" href="#section-3.5.1.3.2-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5.1.3.2-3.1">RuleID size: 3 bits<a class="pilcrow" href="#section-3.5.1.3.2-3.1">¶</a>
</li>
                <li class="normal" id="section-3.5.1.3.2-3.2">DTag size (T): 0 bits<a class="pilcrow" href="#section-3.5.1.3.2-3.2">¶</a>
</li>
                <li class="normal" id="section-3.5.1.3.2-3.3">Window index (W) size (M): 2 bits<a class="pilcrow" href="#section-3.5.1.3.2-3.3">¶</a>
</li>
                <li class="normal" id="section-3.5.1.3.2-3.4">Fragment Compressed Number (FCN) size (N): 3 bits<a class="pilcrow" href="#section-3.5.1.3.2-3.4">¶</a>
</li>
              </ul>
<p id="section-3.5.1.3.2-4">Other F/R parameters <span class="bcp14">MUST</span> be configured as follows:<a class="pilcrow" href="#section-3.5.1.3.2-4">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5.1.3.2-5.1">MAX_ACK_REQUESTS: 5<a class="pilcrow" href="#section-3.5.1.3.2-5.1">¶</a>
</li>
                <li class="normal" id="section-3.5.1.3.2-5.2">WINDOW_SIZE: 7 (i.e., the maximum FCN value is 0b110)<a class="pilcrow" href="#section-3.5.1.3.2-5.2">¶</a>
</li>
                <li class="normal" id="section-3.5.1.3.2-5.3">Regular tile size: 11 bytes<a class="pilcrow" href="#section-3.5.1.3.2-5.3">¶</a>
</li>
                <li class="normal" id="section-3.5.1.3.2-5.4">All-1 tile size: 0 to 10 bytes<a class="pilcrow" href="#section-3.5.1.3.2-5.4">¶</a>
</li>
                <li class="normal" id="section-3.5.1.3.2-5.5">Retransmission Timer: Application-dependent. The default value is 12 hours.<a class="pilcrow" href="#section-3.5.1.3.2-5.5">¶</a>
</li>
                <li class="normal" id="section-3.5.1.3.2-5.6">Inactivity Timer: Application-dependent. The default value is 12 hours.<a class="pilcrow" href="#section-3.5.1.3.2-5.6">¶</a>
</li>
                <li class="normal" id="section-3.5.1.3.2-5.7">RCS size: 3 bits<a class="pilcrow" href="#section-3.5.1.3.2-5.7">¶</a>
</li>
              </ul>
<p id="section-3.5.1.3.2-6"><a class="auto internal xref" href="#UL-ACKoE-single-byte">Section 3.6.2</a> presents SCHC Fragment format examples, and <a class="auto internal xref" href="#ack-on-error-examples-1B-header">Section 5.2</a> provides fragmentation examples, using ACK-on-Error with a single-byte header.<a class="pilcrow" href="#section-3.5.1.3.2-6">¶</a></p>
</section>
</div>
</section>
</div>
<div id="two-byte-schc-header">
<section id="section-3.5.1.4">
            <h5 id="name-two-byte-schc-header-for-up">
<a class="section-number selfRef" href="#section-3.5.1.4">3.5.1.4. </a><a class="section-name selfRef" href="#name-two-byte-schc-header-for-up">Two-Byte SCHC Header for Uplink Fragmentation</a>
            </h5>
<p id="section-3.5.1.4-1">ACK-on-Error with a two-byte header <span class="bcp14">MUST</span> be used for medium- to large-sized packets that need to be sent
   reliably.  ACK-on-Error is optimal for reliable SCHC Packet transmission over Sigfox, since it
   leads to a reduced number of ACKs in the lower-capacity Downlink
   channel. Also, Downlink messages can be sent asynchronously and
   opportunistically. In contrast, ACK-Always would not minimize the number of ACKs, and No-ACK would not allow reliable transmission.<a class="pilcrow" href="#section-3.5.1.4-1">¶</a></p>
<div id="ack-on-error-mode-2">
<section id="section-3.5.1.4.1">
              <h6 id="name-uplink-ack-on-error-mode-tw">
<a class="section-number selfRef" href="#section-3.5.1.4.1">3.5.1.4.1. </a><a class="section-name selfRef" href="#name-uplink-ack-on-error-mode-tw">Uplink ACK-on-Error Mode: Two-Byte SCHC Header Option 1</a>
              </h6>
<p id="section-3.5.1.4.1-1">In order to allow transmission of medium to large packets/files up to 480 bytes long, the SCHC Uplink fragmentation header size is 16 bits in size and is composed as follows:<a class="pilcrow" href="#section-3.5.1.4.1-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5.1.4.1-2.1">RuleID size: 6 bits<a class="pilcrow" href="#section-3.5.1.4.1-2.1">¶</a>
</li>
                <li class="normal" id="section-3.5.1.4.1-2.2">DTag size (T): 0 bits<a class="pilcrow" href="#section-3.5.1.4.1-2.2">¶</a>
</li>
                <li class="normal" id="section-3.5.1.4.1-2.3">Window index (W) size (M): 2 bits<a class="pilcrow" href="#section-3.5.1.4.1-2.3">¶</a>
</li>
                <li class="normal" id="section-3.5.1.4.1-2.4">Fragment Compressed Number (FCN) size (N): 4 bits<a class="pilcrow" href="#section-3.5.1.4.1-2.4">¶</a>
</li>
                <li class="normal" id="section-3.5.1.4.1-2.5">RCS size: 4 bits<a class="pilcrow" href="#section-3.5.1.4.1-2.5">¶</a>
</li>
              </ul>
<p id="section-3.5.1.4.1-3">Other F/R parameters <span class="bcp14">MUST</span> be configured as follows:<a class="pilcrow" href="#section-3.5.1.4.1-3">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5.1.4.1-4.1">MAX_ACK_REQUESTS: 5<a class="pilcrow" href="#section-3.5.1.4.1-4.1">¶</a>
</li>
                <li class="normal" id="section-3.5.1.4.1-4.2">WINDOW_SIZE: 12 (with a maximum value of FCN=0b1011)<a class="pilcrow" href="#section-3.5.1.4.1-4.2">¶</a>
</li>
                <li class="normal" id="section-3.5.1.4.1-4.3">Regular tile size: 10 bytes<a class="pilcrow" href="#section-3.5.1.4.1-4.3">¶</a>
</li>
                <li class="normal" id="section-3.5.1.4.1-4.4">All-1 tile size: 1 to 10 bytes<a class="pilcrow" href="#section-3.5.1.4.1-4.4">¶</a>
</li>
                <li class="normal" id="section-3.5.1.4.1-4.5">Retransmission Timer: Application-dependent. The default value is 12 hours.<a class="pilcrow" href="#section-3.5.1.4.1-4.5">¶</a>
</li>
                <li class="normal" id="section-3.5.1.4.1-4.6">Inactivity Timer: Application-dependent. The default value is 12 hours.<a class="pilcrow" href="#section-3.5.1.4.1-4.6">¶</a>
</li>
              </ul>
<p id="section-3.5.1.4.1-5">Note that WINDOW_SIZE is limited to 12. This is because 4 windows (M = 2) with bitmaps of size 12 can be fitted in a
single SCHC Compound ACK.<a class="pilcrow" href="#section-3.5.1.4.1-5">¶</a></p>
<p id="section-3.5.1.4.1-6"><a class="auto internal xref" href="#UL-ACKoE-two-byte-opt-1">Section 3.6.3</a> presents SCHC Fragment format examples, using ACK-on-Error with two-byte header Option 1.<a class="pilcrow" href="#section-3.5.1.4.1-6">¶</a></p>
</section>
</div>
<div id="ack-on-error-mode-3">
<section id="section-3.5.1.4.2">
              <h6 id="name-uplink-ack-on-error-mode-two">
<a class="section-number selfRef" href="#section-3.5.1.4.2">3.5.1.4.2. </a><a class="section-name selfRef" href="#name-uplink-ack-on-error-mode-two">Uplink ACK-on-Error Mode: Two-Byte SCHC Header Option 2</a>
              </h6>
<p id="section-3.5.1.4.2-1">In order to allow transmission of very large packets/files up to 2400 bytes long, the SCHC Uplink fragmentation header size is 16 bits in size and is composed as follows:<a class="pilcrow" href="#section-3.5.1.4.2-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5.1.4.2-2.1">RuleID size: 8 bits<a class="pilcrow" href="#section-3.5.1.4.2-2.1">¶</a>
</li>
                <li class="normal" id="section-3.5.1.4.2-2.2">DTag size (T): 0 bits<a class="pilcrow" href="#section-3.5.1.4.2-2.2">¶</a>
</li>
                <li class="normal" id="section-3.5.1.4.2-2.3">Window index (W) size (M): 3 bits<a class="pilcrow" href="#section-3.5.1.4.2-2.3">¶</a>
</li>
                <li class="normal" id="section-3.5.1.4.2-2.4">Fragment Compressed Number (FCN) size (N): 5 bits<a class="pilcrow" href="#section-3.5.1.4.2-2.4">¶</a>
</li>
                <li class="normal" id="section-3.5.1.4.2-2.5">RCS size: 5 bits<a class="pilcrow" href="#section-3.5.1.4.2-2.5">¶</a>
</li>
              </ul>
<p id="section-3.5.1.4.2-3">Other F/R parameters <span class="bcp14">MUST</span> be configured as follows:<a class="pilcrow" href="#section-3.5.1.4.2-3">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5.1.4.2-4.1">MAX_ACK_REQUESTS: 5<a class="pilcrow" href="#section-3.5.1.4.2-4.1">¶</a>
</li>
                <li class="normal" id="section-3.5.1.4.2-4.2">WINDOW_SIZE: 31 (with a maximum value of FCN=0b11110)<a class="pilcrow" href="#section-3.5.1.4.2-4.2">¶</a>
</li>
                <li class="normal" id="section-3.5.1.4.2-4.3">Regular tile size: 10 bytes<a class="pilcrow" href="#section-3.5.1.4.2-4.3">¶</a>
</li>
                <li class="normal" id="section-3.5.1.4.2-4.4">All-1 tile size: 0 to 9 bytes<a class="pilcrow" href="#section-3.5.1.4.2-4.4">¶</a>
</li>
                <li class="normal" id="section-3.5.1.4.2-4.5">Retransmission Timer: Application-dependent. The default value is 12 hours.<a class="pilcrow" href="#section-3.5.1.4.2-4.5">¶</a>
</li>
                <li class="normal" id="section-3.5.1.4.2-4.6">Inactivity Timer: Application-dependent. The default value is 12 hours.<a class="pilcrow" href="#section-3.5.1.4.2-4.6">¶</a>
</li>
              </ul>
<p id="section-3.5.1.4.2-5"><a class="auto internal xref" href="#UL-ACKoE-two-byte">Section 3.6.4</a> presents SCHC Fragment format examples, using ACK-on-Error with two-byte header Option 2.<a class="pilcrow" href="#section-3.5.1.4.2-5">¶</a></p>
</section>
</div>
</section>
</div>
<div id="all-1-behaviour">
<section id="section-3.5.1.5">
            <h5 id="name-all-1-schc-fragment-and-rcs">
<a class="section-number selfRef" href="#section-3.5.1.5">3.5.1.5. </a><a class="section-name selfRef" href="#name-all-1-schc-fragment-and-rcs">All-1 SCHC Fragment and RCS Behavior</a>
            </h5>
<p id="section-3.5.1.5-1">For ACK-on-Error, as defined in <span>[<a class="cite xref" href="#RFC8724">RFC8724</a>]</span>, it is expected that the last SCHC Fragment of the last window will always be delivered 
with an All-1 FCN. Since this last window may not be full (i.e., it may be composed of fewer than WINDOW_SIZE fragments), an All-1 fragment
may follow a value of FCN higher than 1 (0b01). In this case, the receiver cannot determine from the FCN values alone
whether there are or are not any missing fragments right before the All-1 fragment.<a class="pilcrow" href="#section-3.5.1.5-1">¶</a></p>
<p id="section-3.5.1.5-2">For Rules where the number of fragments in the last window is unknown, an RCS field <span class="bcp14">MUST</span> be used, indicating the number of fragments 
in the last window, including the All-1. With this RCS value, the receiver can detect if there are missing fragments before the All-1 and hence
construct the corresponding SCHC ACK Bitmap accordingly and send it in response to the All-1.<a class="pilcrow" href="#section-3.5.1.5-2">¶</a></p>
</section>
</div>
</section>
</div>
<div id="downlink-fragmentation">
<section id="section-3.5.2">
          <h4 id="name-downlink-fragmentation">
<a class="section-number selfRef" href="#section-3.5.2">3.5.2. </a><a class="section-name selfRef" href="#name-downlink-fragmentation">Downlink Fragmentation</a>
          </h4>
<p id="section-3.5.2-1">In some LPWAN technologies, as part of energy-saving techniques, Downlink transmission is only possible immediately after an Uplink
transmission. This allows the device to go in a very deep sleep mode and preserve battery without the need to listen to any information 
from the Network. This is the case for Sigfox-enabled devices, which can only listen to Downlink communications after performing an
Uplink transmission and requesting a Downlink.<a class="pilcrow" href="#section-3.5.2-1">¶</a></p>
<p id="section-3.5.2-2">When there are fragments to be transmitted in the Downlink, an Uplink message is required to trigger the Downlink communication.
In order to avoid a potentially high delay for fragmented datagram transmission in the Downlink, the fragment receiver <span class="bcp14">MAY</span> perform an
Uplink transmission as soon as possible after reception of a Downlink fragment that is not the last one. Such an Uplink transmission
<span class="bcp14">MAY</span> be triggered by sending a SCHC message, such as a SCHC ACK. However, other data messages can equally be used to trigger Downlink
communications.
The fragment receiver <span class="bcp14">MUST</span> send an Uplink transmission (e.g., empty message) and request a Downlink every 24 hours when no SCHC session is started. Whether this Uplink transmission is used (and the transmission rate, if used) depends on application-specific requirements.<a class="pilcrow" href="#section-3.5.2-2">¶</a></p>
<p id="section-3.5.2-3">Sigfox Downlink messages are fixed in size, and as described in <span>[<a class="cite xref" href="#RFC8376">RFC8376</a>]</span> they can carry a payload of 0-8 bytes (0-64 bits). Hence, a
single SCHC Tile size per mode can be defined so that every Sigfox message always carries one SCHC Tile.<a class="pilcrow" href="#section-3.5.2-3">¶</a></p>
<p id="section-3.5.2-4">For reliable Downlink fragment transmission, the ACK-Always mode <span class="bcp14">SHOULD</span> be used.
Note that ACK-on-Error does not guarantee Uplink feedback (since no SCHC ACK will be sent when no errors occur in a window), and No-ACK would not allow reliable transmission.<a class="pilcrow" href="#section-3.5.2-4">¶</a></p>
<p id="section-3.5.2-5">The SCHC Downlink fragmentation header size is 8 bits in size and is composed as follows:<a class="pilcrow" href="#section-3.5.2-5">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5.2-6.1">RuleID size: 3 bits<a class="pilcrow" href="#section-3.5.2-6.1">¶</a>
</li>
            <li class="normal" id="section-3.5.2-6.2">DTag size (T): 0 bits<a class="pilcrow" href="#section-3.5.2-6.2">¶</a>
</li>
            <li class="normal" id="section-3.5.2-6.3">Window index (W) size (M): 0 bits<a class="pilcrow" href="#section-3.5.2-6.3">¶</a>
</li>
            <li class="normal" id="section-3.5.2-6.4">Fragment Compressed Number (FCN) size (N): 5 bits<a class="pilcrow" href="#section-3.5.2-6.4">¶</a>
</li>
          </ul>
<p id="section-3.5.2-7">Other F/R parameters <span class="bcp14">MUST</span> be configured as follows:<a class="pilcrow" href="#section-3.5.2-7">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5.2-8.1">MAX_ACK_REQUESTS: 5<a class="pilcrow" href="#section-3.5.2-8.1">¶</a>
</li>
            <li class="normal" id="section-3.5.2-8.2">WINDOW_SIZE: 31 (with a maximum value of FCN=0b11110)<a class="pilcrow" href="#section-3.5.2-8.2">¶</a>
</li>
            <li class="normal" id="section-3.5.2-8.3">Regular tile size: 7 bytes<a class="pilcrow" href="#section-3.5.2-8.3">¶</a>
</li>
            <li class="normal" id="section-3.5.2-8.4">All-1 tile size: 0 to 6 bytes<a class="pilcrow" href="#section-3.5.2-8.4">¶</a>
</li>
            <li class="normal" id="section-3.5.2-8.5">Retransmission Timer: Application-dependent. The default value is 12 hours.<a class="pilcrow" href="#section-3.5.2-8.5">¶</a>
</li>
            <li class="normal" id="section-3.5.2-8.6">Inactivity Timer: Application-dependent. The default value is 12 hours.<a class="pilcrow" href="#section-3.5.2-8.6">¶</a>
</li>
            <li class="normal" id="section-3.5.2-8.7">RCS size: 5 bits<a class="pilcrow" href="#section-3.5.2-8.7">¶</a>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="schc-sigfox-message-formats">
<section id="section-3.6">
        <h3 id="name-schc-over-sigfox-f-r-messag">
<a class="section-number selfRef" href="#section-3.6">3.6. </a><a class="section-name selfRef" href="#name-schc-over-sigfox-f-r-messag">SCHC over Sigfox F/R Message Formats</a>
        </h3>
<p id="section-3.6-1">This section depicts the different formats of SCHC Fragment, SCHC ACK (including the SCHC Compound ACK 
defined in <span>[<a class="cite xref" href="#RFC9441">RFC9441</a>]</span>), and SCHC Abort used in SCHC over Sigfox.<a class="pilcrow" href="#section-3.6-1">¶</a></p>
<div id="UL-NoACK-single-byte">
<section id="section-3.6.1">
          <h4 id="name-uplink-no-ack-mode-single-by">
<a class="section-number selfRef" href="#section-3.6.1">3.6.1. </a><a class="section-name selfRef" href="#name-uplink-no-ack-mode-single-by">Uplink No-ACK Mode: Single-Byte SCHC Header</a>
          </h4>
<div id="no-ack-regular-1byte-schc-fragment">
<section id="section-3.6.1.1">
            <h5 id="name-regular-schc-fragment">
<a class="section-number selfRef" href="#section-3.6.1.1">3.6.1.1. </a><a class="section-name selfRef" href="#name-regular-schc-fragment">Regular SCHC Fragment</a>
            </h5>
<p id="section-3.6.1.1-1"><a class="auto internal xref" href="#no-ack-reg-1byte-frag">Figure 3</a> shows an example of a Regular SCHC Fragment for all fragments except the last one.
     As tiles are 11 bytes in size, padding <span class="bcp14">MUST NOT</span> be added.
The penultimate tile of a SCHC Packet is of regular size.<a class="pilcrow" href="#section-3.6.1.1-1">¶</a></p>
<span id="name-regular-schc-fragment-forma"></span><div id="no-ack-reg-1byte-frag">
<figure id="figure-3">
              <div class="alignCenter art-text artwork" id="section-3.6.1.1-2.1">
<pre>|- SCHC Fragment Header -|
+------------------------+---------+
|   RuleID   |    FCN    | Payload |
+------------+-----------+---------+
|   3 bits   |  5 bits   | 88 bits |
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-3">Figure 3</a>:
<a class="selfRef" href="#name-regular-schc-fragment-forma">Regular SCHC Fragment Format for All Fragments except the Last One</a>
              </figcaption></figure>
</div>
</section>
</div>
<div id="no-ack-all-1-1byte-schc-fragment">
<section id="section-3.6.1.2">
            <h5 id="name-all-1-schc-fragment">
<a class="section-number selfRef" href="#section-3.6.1.2">3.6.1.2. </a><a class="section-name selfRef" href="#name-all-1-schc-fragment">All-1 SCHC Fragment</a>
            </h5>
<p id="section-3.6.1.2-1"><a class="auto internal xref" href="#no-ack-all-1-1byte">Figure 4</a> shows an example of the All-1 message.
The All-1 message <span class="bcp14">MAY</span> contain the last tile of the SCHC Packet.
  Padding <span class="bcp14">MUST NOT</span> be
  added, as the resulting size is a multiple of an L2 Word.<a class="pilcrow" href="#section-3.6.1.2-1">¶</a></p>
<p id="section-3.6.1.2-2">
   The All-1 messages Fragment Header includes a 5-bit RCS, and 3 bits are added as padding to complete 2 bytes.
    The payload size of the All-1 message ranges from 0 to 80 bits.<a class="pilcrow" href="#section-3.6.1.2-2">¶</a></p>
<span id="name-all-1-schc-message-format-w"></span><div id="no-ack-all-1-1byte">
<figure id="figure-4">
              <div class="alignCenter art-text artwork" id="section-3.6.1.2-3.1">
<pre>|--------  SCHC Fragment Header -------|
+--------------------------------------+--------------+
| RuleID | FCN=ALL-1 |  RCS   |  b'000 |   Payload    |
+--------+-----------+--------+--------+--------------+
| 3 bits |  5 bits   | 5 bits | 3 bits | 0 to 80 bits |
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-4">Figure 4</a>:
<a class="selfRef" href="#name-all-1-schc-message-format-w">All-1 SCHC Message Format with the Last Tile</a>
              </figcaption></figure>
</div>
<p id="section-3.6.1.2-4">As per <span>[<a class="cite xref" href="#RFC8724">RFC8724</a>]</span>, the All-1 must be distinguishable from a SCHC Sender-Abort message (with the same RuleID and N values).
The All-1 <span class="bcp14">MAY</span> have the last tile of the SCHC Packet.
The SCHC Sender-Abort message header size is 1 byte with no padding bits.<a class="pilcrow" href="#section-3.6.1.2-4">¶</a></p>
<p id="section-3.6.1.2-5">For the All-1 message to be distinguishable from the Sender-Abort message, the Sender-Abort message <span class="bcp14">MUST</span> be 1 byte (only header with no padding).
This way, the minimum size of the All-1 is 2 bytes, and the Sender-Abort message is 1 byte.<a class="pilcrow" href="#section-3.6.1.2-5">¶</a></p>
</section>
</div>
<div id="no-ack-snd-abort-msg-format">
<section id="section-3.6.1.3">
            <h5 id="name-schc-sender-abort-message-f">
<a class="section-number selfRef" href="#section-3.6.1.3">3.6.1.3. </a><a class="section-name selfRef" href="#name-schc-sender-abort-message-f">SCHC Sender-Abort Message Format</a>
            </h5>
<span id="name-schc-sender-abort-message-fo"></span><div id="no-ack-snd-abort-msg">
<figure id="figure-5">
              <div class="alignCenter art-text artwork" id="section-3.6.1.3-1.1">
<pre>     Sender-Abort
|------ Header ------|
+--------------------+
| RuleID | FCN=ALL-1 |
+--------+-----------+
| 3 bits |  5 bits   |
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-5">Figure 5</a>:
<a class="selfRef" href="#name-schc-sender-abort-message-fo">SCHC Sender-Abort Message Format</a>
              </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="UL-ACKoE-single-byte">
<section id="section-3.6.2">
          <h4 id="name-uplink-ack-on-error-mode-sin">
<a class="section-number selfRef" href="#section-3.6.2">3.6.2. </a><a class="section-name selfRef" href="#name-uplink-ack-on-error-mode-sin">Uplink ACK-on-Error Mode: Single-Byte SCHC Header</a>
          </h4>
<div id="regular-1byte-schc-fragment">
<section id="section-3.6.2.1">
            <h5 id="name-regular-schc-fragment-2">
<a class="section-number selfRef" href="#section-3.6.2.1">3.6.2.1. </a><a class="section-name selfRef" href="#name-regular-schc-fragment-2">Regular SCHC Fragment</a>
            </h5>
<p id="section-3.6.2.1-1"><a class="auto internal xref" href="#reg-1byte-frag">Figure 6</a> shows an example of a Regular SCHC Fragment for all fragments except the last one. 
As tiles are 11 bytes in size, padding <span class="bcp14">MUST NOT</span> be added.<a class="pilcrow" href="#section-3.6.2.1-1">¶</a></p>
<span id="name-regular-schc-fragment-format"></span><div id="reg-1byte-frag">
<figure id="figure-6">
              <div class="alignCenter art-text artwork" id="section-3.6.2.1-2.1">
<pre>|-- SCHC Fragment Header --|
+--------------------------+---------+
| RuleID |   W    |  FCN   | Payload |
+--------+--------+--------+---------+
| 3 bits | 2 bits | 3 bits | 88 bits |
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-6">Figure 6</a>:
<a class="selfRef" href="#name-regular-schc-fragment-format">Regular SCHC Fragment Format for All Fragments except the Last One</a>
              </figcaption></figure>
</div>
<p id="section-3.6.2.1-3">The SCHC ACK REQ <span class="bcp14">MUST NOT</span> be used, instead the All-1 SCHC Fragment <span class="bcp14">MUST</span> be used to request a SCHC ACK from the receiver (Network SCHC).
As per <span>[<a class="cite xref" href="#RFC8724">RFC8724</a>]</span>, the All-0 message is distinguishable from the SCHC ACK REQ (All-1 message). 
The penultimate tile of a SCHC Packet is of regular size.<a class="pilcrow" href="#section-3.6.2.1-3">¶</a></p>
</section>
</div>
<div id="all-1-1byte-schc-fragment">
<section id="section-3.6.2.2">
            <h5 id="name-all-1-schc-fragment-2">
<a class="section-number selfRef" href="#section-3.6.2.2">3.6.2.2. </a><a class="section-name selfRef" href="#name-all-1-schc-fragment-2">All-1 SCHC Fragment</a>
            </h5>
<p id="section-3.6.2.2-1"><a class="auto internal xref" href="#all-1-1byte">Figure 7</a> shows an example of the All-1 message. 
The All-1 message <span class="bcp14">MAY</span> contain the last tile of the SCHC Packet.
Padding <span class="bcp14">MUST NOT</span> be added, as the resulting size is L2-word-multiple.<a class="pilcrow" href="#section-3.6.2.2-1">¶</a></p>
<span id="name-all-1-schc-message-format-wi"></span><div id="all-1-1byte">
<figure id="figure-7">
              <div class="alignCenter art-text artwork" id="section-3.6.2.2-2.1">
<pre>|-------------  SCHC Fragment Header -----------|
+-----------------------------------------------+--------------+
| RuleID |   W    | FCN=ALL-1 |  RCS   |b'00000 |   Payload    |
+--------+--------+-----------+--------+--------+--------------+
| 3 bits | 2 bits |  3 bits   | 3 bits | 5 bits | 0 to 80 bits |
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-7">Figure 7</a>:
<a class="selfRef" href="#name-all-1-schc-message-format-wi">All-1 SCHC Message Format with the Last Tile</a>
              </figcaption></figure>
</div>
<p id="section-3.6.2.2-3">As per <span>[<a class="cite xref" href="#RFC8724">RFC8724</a>]</span>, the All-1 must be distinguishable from a SCHC Sender-Abort message (with same RuleID, M, and N values).
The All-1 <span class="bcp14">MAY</span> have the last tile of the SCHC Packet.
The SCHC Sender-Abort message header size is 1 byte with no padding bits.<a class="pilcrow" href="#section-3.6.2.2-3">¶</a></p>
<p id="section-3.6.2.2-4">For the All-1 message to be distinguishable from the Sender-Abort message, the Sender-Abort message <span class="bcp14">MUST</span> be 1 byte (only header with no padding).
This way, the minimum size of the All-1 is 2 bytes, and the Sender-Abort message is 1 byte.<a class="pilcrow" href="#section-3.6.2.2-4">¶</a></p>
</section>
</div>
<div id="schc-ack-format-1B">
<section id="section-3.6.2.3">
            <h5 id="name-schc-ack-format">
<a class="section-number selfRef" href="#section-3.6.2.3">3.6.2.3. </a><a class="section-name selfRef" href="#name-schc-ack-format">SCHC ACK Format</a>
            </h5>
<p id="section-3.6.2.3-1"><a class="auto internal xref" href="#success-ack-1byte">Figure 8</a> shows the SCHC ACK format when all fragments have been correctly received (C=1). 
Padding <span class="bcp14">MUST</span> be added to complete the 64-bit Sigfox Downlink frame payload size.<a class="pilcrow" href="#section-3.6.2.3-1">¶</a></p>
<span id="name-schc-success-ack-message-fo"></span><div id="success-ack-1byte">
<figure id="figure-8">
              <div class="alignCenter art-text artwork" id="section-3.6.2.3-2.1">
<pre>|---- SCHC ACK Header ----|
+-------------------------+---------+
| RuleID |    W   | C=b'1 | b'0-pad |
+--------+--------+-------+---------+
| 3 bits | 2 bits | 1 bit | 58 bits |
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-8">Figure 8</a>:
<a class="selfRef" href="#name-schc-success-ack-message-fo">SCHC Success ACK Message Format</a>
              </figcaption></figure>
</div>
<p id="section-3.6.2.3-3">In case SCHC Fragment losses are found in any of the windows of the SCHC Packet (C=0), the SCHC Compound ACK defined in <span>[<a class="cite xref" href="#RFC9441">RFC9441</a>]</span> <span class="bcp14">MUST</span> be used.
The SCHC Compound ACK message format is shown in <a class="auto internal xref" href="#compound-ack-1byte">Figure 9</a>.<a class="pilcrow" href="#section-3.6.2.3-3">¶</a></p>
<span id="name-schc-compound-ack-message-f"></span><div id="compound-ack-1byte">
<figure id="figure-9">
              <div class="alignCenter art-text artwork" id="section-3.6.2.3-4.1">
<pre>|--- SCHC ACK Header ---|- W=w1 -|...|----- W=wi ------|
+------+--------+-------+--------+...+--------+--------+------+-------+
|RuleID| W=b'w1 | C=b'0 | Bitmap |...| W=b'wi | Bitmap | b'00 |b'0-pad|
+------+--------+-------+--------+...+--------+--------+------+-------+
|3 bits| 2 bits | 1 bit | 7 bits |...| 2 bits | 7 bits |2 bits|
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-9">Figure 9</a>:
<a class="selfRef" href="#name-schc-compound-ack-message-f">SCHC Compound ACK Message Format</a>
              </figcaption></figure>
</div>
<p id="section-3.6.2.3-5">Losses are found in windows W = w1,...,wi, where w1 &lt; w2 &lt;...&lt; wi.<a class="pilcrow" href="#section-3.6.2.3-5">¶</a></p>
</section>
</div>
<div id="snd-abort-msg-format">
<section id="section-3.6.2.4">
            <h5 id="name-schc-sender-abort-message-for">
<a class="section-number selfRef" href="#section-3.6.2.4">3.6.2.4. </a><a class="section-name selfRef" href="#name-schc-sender-abort-message-for">SCHC Sender-Abort Message Format</a>
            </h5>
<span id="name-schc-sender-abort-message-form"></span><div id="snd-abort-msg">
<figure id="figure-10">
              <div class="alignCenter art-text artwork" id="section-3.6.2.4-1.1">
<pre>|---- Sender-Abort Header ----|
+-----------------------------+
| RuleID | W=b'11 | FCN=ALL-1 |
+--------+--------+-----------+
| 3 bits | 2 bits |  3 bits   |
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-10">Figure 10</a>:
<a class="selfRef" href="#name-schc-sender-abort-message-form">SCHC Sender-Abort Message Format</a>
              </figcaption></figure>
</div>
</section>
</div>
<div id="rcv-abort-msg-format">
<section id="section-3.6.2.5">
            <h5 id="name-schc-receiver-abort-message">
<a class="section-number selfRef" href="#section-3.6.2.5">3.6.2.5. </a><a class="section-name selfRef" href="#name-schc-receiver-abort-message">SCHC Receiver-Abort Message Format</a>
            </h5>
<span id="name-schc-receiver-abort-message-"></span><div id="rcv-abort-msg">
<figure id="figure-11">
              <div class="alignCenter art-text artwork" id="section-3.6.2.5-1.1">
<pre>|- Receiver-Abort Header -|
+---------------------------------+-----------------+---------+
| RuleID | W=b'11 | C=b'1 |  b'11 |  0xFF (all 1's) | b'0-pad |
+--------+--------+-------+-------+-----------------+---------+
| 3 bits | 2 bits | 1 bit | 2 bit |  8 bit          | 48 bits |
          next L2 Word boundary -&gt;| &lt;-- L2 Word --&gt; |
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-11">Figure 11</a>:
<a class="selfRef" href="#name-schc-receiver-abort-message-">SCHC Receiver-Abort Message Format</a>
              </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="UL-ACKoE-two-byte-opt-1">
<section id="section-3.6.3">
          <h4 id="name-uplink-ack-on-error-mode-two-">
<a class="section-number selfRef" href="#section-3.6.3">3.6.3. </a><a class="section-name selfRef" href="#name-uplink-ack-on-error-mode-two-">Uplink ACK-on-Error Mode: Two-Byte SCHC Header Option 1</a>
          </h4>
<div id="opt-1-regular-2byte-schc-fragment">
<section id="section-3.6.3.1">
            <h5 id="name-regular-schc-fragment-3">
<a class="section-number selfRef" href="#section-3.6.3.1">3.6.3.1. </a><a class="section-name selfRef" href="#name-regular-schc-fragment-3">Regular SCHC Fragment</a>
            </h5>
<p id="section-3.6.3.1-1"><a class="auto internal xref" href="#opt-1-reg-2byte-frag">Figure 12</a> shows an example of a Regular SCHC Fragment for all fragments except the last one.
The penultimate tile of a SCHC Packet is of the regular size.<a class="pilcrow" href="#section-3.6.3.1-1">¶</a></p>
<span id="name-regular-schc-fragment-format-"></span><div id="opt-1-reg-2byte-frag">
<figure id="figure-12">
              <div class="alignCenter art-text artwork" id="section-3.6.3.1-2.1">
<pre>|------- SCHC Fragment Header ------|
+-----------------------------------+---------+
| RuleID |    W   |  FCN   | b'0000 | Payload |
+--------+--------+--------+--------+---------+
| 6 bits | 2 bits | 4 bits | 4 bits | 80 bits |
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-12">Figure 12</a>:
<a class="selfRef" href="#name-regular-schc-fragment-format-">Regular SCHC Fragment Format for All Fragments except the Last One</a>
              </figcaption></figure>
</div>
<p id="section-3.6.3.1-3">The SCHC ACK REQ <span class="bcp14">MUST NOT</span> be used, instead the All-1 SCHC Fragment <span class="bcp14">MUST</span> be used to request a SCHC ACK from the receiver (Network SCHC).
As per <span>[<a class="cite xref" href="#RFC8724">RFC8724</a>]</span>, the All-0 message is distinguishable from the SCHC ACK REQ (All-1 message).<a class="pilcrow" href="#section-3.6.3.1-3">¶</a></p>
</section>
</div>
<div id="opt-1-all-1-2B-schc-fragment">
<section id="section-3.6.3.2">
            <h5 id="name-all-1-schc-fragment-3">
<a class="section-number selfRef" href="#section-3.6.3.2">3.6.3.2. </a><a class="section-name selfRef" href="#name-all-1-schc-fragment-3">All-1 SCHC Fragment</a>
            </h5>
<p id="section-3.6.3.2-1"><a class="auto internal xref" href="#opt-1-all-1-2B">Figure 13</a> shows an example of the All-1 message.
The All-1 message <span class="bcp14">MUST</span> contain the last tile of the SCHC Packet.<a class="pilcrow" href="#section-3.6.3.2-1">¶</a></p>
<p id="section-3.6.3.2-2">The All-1 message Fragment Header contains an RCS of 4 bits to complete the two-byte size.
   The size of the last tile ranges from 8 to 80 bits.<a class="pilcrow" href="#section-3.6.3.2-2">¶</a></p>
<span id="name-all-1-schc-message-format-wit"></span><div id="opt-1-all-1-2B">
<figure id="figure-13">
              <div class="alignCenter art-text artwork" id="section-3.6.3.2-3.1">
<pre>|--------- SCHC Fragment Header -------|
+--------------------------------------+--------------+
| RuleID |    W   | FCN=ALL-1 |  RCS   |    Payload   |
+--------+--------+-----------+--------+--------------+
| 6 bits | 2 bits |  4 bits   | 4 bits | 8 to 80 bits |
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-13">Figure 13</a>:
<a class="selfRef" href="#name-all-1-schc-message-format-wit">All-1 SCHC Message Format with the Last Tile</a>
              </figcaption></figure>
</div>
<p id="section-3.6.3.2-4">As per <span>[<a class="cite xref" href="#RFC8724">RFC8724</a>]</span>, the All-1 must be distinguishable from the SCHC Sender-Abort message (with same RuleID, M, and N values).
The All-1 <span class="bcp14">MUST</span> have the last tile of the SCHC Packet that <span class="bcp14">MUST</span> be at least 1 byte.
The SCHC Sender-Abort message header size is 2 bytes with no padding bits.<a class="pilcrow" href="#section-3.6.3.2-4">¶</a></p>
<p id="section-3.6.3.2-5">For the All-1 message to be distinguishable from the Sender-Abort message, the Sender-Abort message <span class="bcp14">MUST</span> be 2 bytes (only header with no padding).
This way, the minimum size of the All-1 is 3 bytes, and the Sender-Abort message is 2 bytes.<a class="pilcrow" href="#section-3.6.3.2-5">¶</a></p>
</section>
</div>
<div id="opt-1-schc-ack-format-2B">
<section id="section-3.6.3.3">
            <h5 id="name-schc-ack-format-2">
<a class="section-number selfRef" href="#section-3.6.3.3">3.6.3.3. </a><a class="section-name selfRef" href="#name-schc-ack-format-2">SCHC ACK Format</a>
            </h5>
<p id="section-3.6.3.3-1"> <a class="auto internal xref" href="#opt-1-success-ack-2B">Figure 14</a> shows the SCHC ACK format when all fragments have been correctly received (C=1).
Padding <span class="bcp14">MUST</span> be added to complete the 64-bit Sigfox Downlink frame payload size.<a class="pilcrow" href="#section-3.6.3.3-1">¶</a></p>
<span id="name-schc-success-ack-message-for"></span><div id="opt-1-success-ack-2B">
<figure id="figure-14">
              <div class="alignCenter art-text artwork" id="section-3.6.3.3-2.1">
<pre>|---- SCHC ACK Header ----|
+-------------------------+---------+
| RuleID |    W   | C=b'1 | b'0-pad |
+--------+--------+-------+---------+
| 6 bits | 2 bits | 1 bit | 55 bits |
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-14">Figure 14</a>:
<a class="selfRef" href="#name-schc-success-ack-message-for">SCHC Success ACK Message Format</a>
              </figcaption></figure>
</div>
<p id="section-3.6.3.3-3">The SCHC Compound ACK message <span class="bcp14">MUST</span> be used in case SCHC Fragment losses are found in any window of the SCHC Packet (C=0).
The SCHC Compound ACK message format is shown in <a class="auto internal xref" href="#opt-1-schc-compound-ack-2B">Figure 15</a>.
The SCHC Compound ACK can report up to 4 windows with losses, as shown in <a class="auto internal xref" href="#opt-1-schc-compound-ack-2B-example-losses-all-windows">Figure 16</a>.<a class="pilcrow" href="#section-3.6.3.3-3">¶</a></p>
<p id="section-3.6.3.3-4">When sent in the Downlink, the SCHC Compound ACK <span class="bcp14">MUST</span> be 0 padded (padding bits must be 0) to complement the 64 bits required by the Sigfox payload.<a class="pilcrow" href="#section-3.6.3.3-4">¶</a></p>
<span id="name-schc-compound-ack-message-fo"></span><div id="opt-1-schc-compound-ack-2B">
<figure id="figure-15">
              <div class="alignCenter art-text artwork" id="section-3.6.3.3-5.1">
<pre>|--- SCHC ACK Header ---|- W=w1 -|...|---- W=wi -----|
+--------+------+-------+--------+...+------+--------+------+-------+
| RuleID |W=b'w1| C=b'0 | Bitmap |...|W=b'wi| Bitmap | b'00 |b'0-pad|
+--------+------+-------+--------+...+------+--------+------+-------+
| 6 bits |2 bits| 1 bit | 12 bits|...|2 bits| 12 bits|2 bits|
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-15">Figure 15</a>:
<a class="selfRef" href="#name-schc-compound-ack-message-fo">SCHC Compound ACK Message Format</a>
              </figcaption></figure>
</div>
<p id="section-3.6.3.3-6">Losses are found in windows W = w1,...,wi, where w1 &lt; w2 &lt;...&lt; wi.<a class="pilcrow" href="#section-3.6.3.3-6">¶</a></p>
<span id="name-schc-compound-ack-message-for"></span><div id="opt-1-schc-compound-ack-2B-example-losses-all-windows">
<figure id="figure-16">
              <div class="alignCenter art-text artwork" id="section-3.6.3.3-7.1">
<pre>|- SCHC ACK Header -|- W=0 -|      |- W=1 -|...
+------+------+-----+-------+------+-------+...
|RuleID|W=b'00|C=b'0|Bitmap |W=b'01|Bitmap |...
+------+------+-----+-------+------+-------+...
|6 bits|2 bits|1 bit|12 bits|2 bits|12 bits|...

            ...       |- W=2 -|      |- W=3 -|
            ...+------+-------+------+-------+---+
            ...|W=b'10|Bitmap |W=b'11|Bitmap |b'0|
            ...+------+-------+------+-------+---+
            ...|2 bits|12 bits|2 bits|12 bits|
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-16">Figure 16</a>:
<a class="selfRef" href="#name-schc-compound-ack-message-for">SCHC Compound ACK Message Format Example with Losses in All Windows</a>
              </figcaption></figure>
</div>
<p id="section-3.6.3.3-8">Losses are found in windows W = w1,...,wi, where w1 &lt; w2 &lt;...&lt; wi.<a class="pilcrow" href="#section-3.6.3.3-8">¶</a></p>
</section>
</div>
<div id="opt-1-snd-abort-msg-2B">
<section id="section-3.6.3.4">
            <h5 id="name-schc-sender-abort-message-forma">
<a class="section-number selfRef" href="#section-3.6.3.4">3.6.3.4. </a><a class="section-name selfRef" href="#name-schc-sender-abort-message-forma">SCHC Sender-Abort Message Format</a>
            </h5>
<span id="name-schc-sender-abort-message-format"></span><div id="opt-1-snd-abort-msg-format-2B">
<figure id="figure-17">
              <div class="alignCenter art-text artwork" id="section-3.6.3.4-1.1">
<pre>|---- Sender-Abort Header ----|
+-----------------------------+
| RuleID |   W    | FCN=ALL-1 |
+--------+--------+-----------+
| 6 bits | 2 bits |  4 bits   |
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-17">Figure 17</a>:
<a class="selfRef" href="#name-schc-sender-abort-message-format">SCHC Sender-Abort Message Format</a>
              </figcaption></figure>
</div>
</section>
</div>
<div id="opt-1-rcv-abort-msg-2B">
<section id="section-3.6.3.5">
            <h5 id="name-schc-receiver-abort-message-f">
<a class="section-number selfRef" href="#section-3.6.3.5">3.6.3.5. </a><a class="section-name selfRef" href="#name-schc-receiver-abort-message-f">SCHC Receiver-Abort Message Format</a>
            </h5>
<span id="name-schc-receiver-abort-message-fo"></span><div id="opt-1-rcv-abort-msg-format-2B">
<figure id="figure-18">
              <div class="alignCenter art-text artwork" id="section-3.6.3.5-1.1">
<pre>|- Receiver-Abort Header -|
+---------------------------------+-----------------+---------+
| RuleID | W=b'11 | C=b'1 |  0x7F |  0xFF (all 1's) | b'0-pad |
+--------+--------+-------+-------+-----------------+---------+
| 6 bits | 2 bits | 1 bit | 7 bit |  8 bit          | 40 bits |
          next L2 Word boundary -&gt;| &lt;-- L2 Word --&gt; |
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-18">Figure 18</a>:
<a class="selfRef" href="#name-schc-receiver-abort-message-fo">SCHC Receiver-Abort Message Format</a>
              </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="UL-ACKoE-two-byte">
<section id="section-3.6.4">
          <h4 id="name-uplink-ack-on-error-mode-two-b">
<a class="section-number selfRef" href="#section-3.6.4">3.6.4. </a><a class="section-name selfRef" href="#name-uplink-ack-on-error-mode-two-b">Uplink ACK-on-Error Mode: Two-Byte SCHC Header Option 2</a>
          </h4>
<div id="opt-2regular-2byte-schc-fragment">
<section id="section-3.6.4.1">
            <h5 id="name-regular-schc-fragment-4">
<a class="section-number selfRef" href="#section-3.6.4.1">3.6.4.1. </a><a class="section-name selfRef" href="#name-regular-schc-fragment-4">Regular SCHC Fragment</a>
            </h5>
<p id="section-3.6.4.1-1"><a class="auto internal xref" href="#opt-2-reg-2byte-frag">Figure 19</a> shows an example of a Regular SCHC Fragment for all fragments except the last one.
The penultimate tile of a SCHC Packet is of the regular size.<a class="pilcrow" href="#section-3.6.4.1-1">¶</a></p>
<span id="name-regular-schc-fragment-format-f"></span><div id="opt-2-reg-2byte-frag">
<figure id="figure-19">
              <div class="alignCenter art-text artwork" id="section-3.6.4.1-2.1">
<pre>|-- SCHC Fragment Header --|
+--------------------------+---------+
| RuleID |   W    | FCN    | Payload |
+--------+--------+--------+---------+
| 8 bits | 3 bits | 5 bits | 80 bits |
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-19">Figure 19</a>:
<a class="selfRef" href="#name-regular-schc-fragment-format-f">Regular SCHC Fragment Format for All Fragments except the Last One</a>
              </figcaption></figure>
</div>
<p id="section-3.6.4.1-3">The SCHC ACK REQ <span class="bcp14">MUST NOT</span> be used, instead the All-1 SCHC Fragment <span class="bcp14">MUST</span> be used to request a SCHC ACK from the receiver (Network SCHC).
As per <span>[<a class="cite xref" href="#RFC8724">RFC8724</a>]</span>, the All-0 message is distinguishable from the SCHC ACK REQ (All-1 message).<a class="pilcrow" href="#section-3.6.4.1-3">¶</a></p>
</section>
</div>
<div id="opt-2-all-1-2B-schc-fragment">
<section id="section-3.6.4.2">
            <h5 id="name-all-1-schc-fragment-4">
<a class="section-number selfRef" href="#section-3.6.4.2">3.6.4.2. </a><a class="section-name selfRef" href="#name-all-1-schc-fragment-4">All-1 SCHC Fragment</a>
            </h5>
<p id="section-3.6.4.2-1"><a class="auto internal xref" href="#opt-2-all-1-2B">Figure 20</a> shows an example of the All-1 message.
The All-1 message <span class="bcp14">MAY</span> contain the last tile of the SCHC Packet.<a class="pilcrow" href="#section-3.6.4.2-1">¶</a></p>
<p id="section-3.6.4.2-2">The All-1 message Fragment Header contains an RCS of 5 bits and 3 padding bits to complete a 3-byte Fragment Header.
   The size of the last tile, if present, ranges from 8 to 72 bits.<a class="pilcrow" href="#section-3.6.4.2-2">¶</a></p>
<span id="name-all-1-schc-message-format-with"></span><div id="opt-2-all-1-2B">
<figure id="figure-20">
              <div class="alignCenter art-text artwork" id="section-3.6.4.2-3.1">
<pre>|-------------- SCHC Fragment Header -----------|
+-----------------------------------------------+--------------+
| RuleID |    W   | FCN=ALL-1 |  RCS   | b'000  |    Payload   |
+--------+--------+-----------+--------+--------+--------------+
| 8 bits | 3 bits |  5 bits   | 5 bits | 3 bits | 8 to 72 bits |
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-20">Figure 20</a>:
<a class="selfRef" href="#name-all-1-schc-message-format-with">All-1 SCHC Message Format with the Last Tile</a>
              </figcaption></figure>
</div>
<p id="section-3.6.4.2-4">As per <span>[<a class="cite xref" href="#RFC8724">RFC8724</a>]</span>, the All-1 must be distinguishable from the SCHC Sender-Abort message (with same RuleID, M, and N values).
The SCHC Sender-Abort message header size is 2 bytes with no padding bits.<a class="pilcrow" href="#section-3.6.4.2-4">¶</a></p>
<p id="section-3.6.4.2-5">For the All-1 message to be distinguishable from the Sender-Abort message, the Sender-Abort message <span class="bcp14">MUST</span> be 2 bytes (only header with no padding).
This way, the minimum size of the All-1 is 3 bytes, and the Sender-Abort message is 2 bytes.<a class="pilcrow" href="#section-3.6.4.2-5">¶</a></p>
</section>
</div>
<div id="opt-2-schc-ack-format-2B">
<section id="section-3.6.4.3">
            <h5 id="name-schc-ack-format-3">
<a class="section-number selfRef" href="#section-3.6.4.3">3.6.4.3. </a><a class="section-name selfRef" href="#name-schc-ack-format-3">SCHC ACK Format</a>
            </h5>
<p id="section-3.6.4.3-1"> <a class="auto internal xref" href="#opt-2-success-ack-2B">Figure 21</a> shows the SCHC ACK format when all fragments have been correctly received (C=1).
Padding <span class="bcp14">MUST</span> be added to complete the 64-bit Sigfox Downlink frame payload size.<a class="pilcrow" href="#section-3.6.4.3-1">¶</a></p>
<span id="name-schc-success-ack-message-form"></span><div id="opt-2-success-ack-2B">
<figure id="figure-21">
              <div class="alignCenter art-text artwork" id="section-3.6.4.3-2.1">
<pre>|---- SCHC ACK Header ----|
+-------------------------+---------+
| RuleID |    W   | C=b'1 | b'0-pad |
+--------+--------+-------+---------+
| 8 bits | 3 bits | 1 bit | 52 bits |
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-21">Figure 21</a>:
<a class="selfRef" href="#name-schc-success-ack-message-form">SCHC Success ACK Message Format</a>
              </figcaption></figure>
</div>
<p id="section-3.6.4.3-3">The SCHC Compound ACK message <span class="bcp14">MUST</span> be used in case SCHC Fragment losses are found in any window of the SCHC Packet (C=0).
The SCHC Compound ACK message format is shown in <a class="auto internal xref" href="#opt-2-schc-compound-ack-2B">Figure 22</a>.
The SCHC Compound ACK can report up to 3 windows with losses.<a class="pilcrow" href="#section-3.6.4.3-3">¶</a></p>
<p id="section-3.6.4.3-4">When sent in the Downlink, the SCHC Compound ACK <span class="bcp14">MUST</span> be 0 padded (padding bits must be 0) to complement the 64 bits required by
the Sigfox payload.<a class="pilcrow" href="#section-3.6.4.3-4">¶</a></p>
<span id="name-schc-compound-ack-message-form"></span><div id="opt-2-schc-compound-ack-2B">
<figure id="figure-22">
              <div class="alignCenter art-text artwork" id="section-3.6.4.3-5.1">
<pre>|-- SCHC ACK Header --|- W=w1 -|...|---- W=wi -----|
+------+------+-------+--------+...+------+--------+------+-------+
|RuleID|W=b'w1| C=b'0 | Bitmap |...|W=b'wi| Bitmap | 000  |b'0-pad|
+------+------+-------+--------+...+------+--------+------+-------+
|8 bits|3 bits| 1 bit | 31 bits|...|3 bits| 31 bits|3 bits|
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-22">Figure 22</a>:
<a class="selfRef" href="#name-schc-compound-ack-message-form">SCHC Compound ACK Message Format</a>
              </figcaption></figure>
</div>
<p id="section-3.6.4.3-6">Losses are found in windows W = w1,...,wi, where w1 &lt; w2 &lt;...&lt; wi.<a class="pilcrow" href="#section-3.6.4.3-6">¶</a></p>
</section>
</div>
<div id="snd-abort-msg-2B">
<section id="section-3.6.4.4">
            <h5 id="name-schc-sender-abort-message-format-2">
<a class="section-number selfRef" href="#section-3.6.4.4">3.6.4.4. </a><a class="section-name selfRef" href="#name-schc-sender-abort-message-format-2">SCHC Sender-Abort Message Format</a>
            </h5>
<span id="name-schc-sender-abort-message-format-3"></span><div id="snd-abort-msg-format-2B">
<figure id="figure-23">
              <div class="alignCenter art-text artwork" id="section-3.6.4.4-1.1">
<pre>|---- Sender-Abort Header ----|
+-----------------------------+
| RuleID |   W    | FCN=ALL-1 |
+--------+--------+-----------+
| 8 bits | 3 bits |  5 bits   |
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-23">Figure 23</a>:
<a class="selfRef" href="#name-schc-sender-abort-message-format-3">SCHC Sender-Abort Message Format</a>
              </figcaption></figure>
</div>
</section>
</div>
<div id="rcv-abort-msg-2B">
<section id="section-3.6.4.5">
            <h5 id="name-schc-receiver-abort-message-for">
<a class="section-number selfRef" href="#section-3.6.4.5">3.6.4.5. </a><a class="section-name selfRef" href="#name-schc-receiver-abort-message-for">SCHC Receiver-Abort Message Format</a>
            </h5>
<span id="name-schc-receiver-abort-message-form"></span><div id="rcv-abort-msg-format-2B">
<figure id="figure-24">
              <div class="alignCenter art-text artwork" id="section-3.6.4.5-1.1">
<pre>|-- Receiver-Abort Header -|
+-----------------------------------+-----------------+---------+
| RuleID | W=b'111 | C=b'1 | b'1111 |  0xFF (all 1's) | b'0-pad |
+--------+---------+-------+--------+-----------------+---------+
| 8 bits |  3 bits | 1 bit | 4 bit  |  8 bit          | 40 bits |
            next L2 Word boundary -&gt;| &lt;-- L2 Word --&gt; |
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-24">Figure 24</a>:
<a class="selfRef" href="#name-schc-receiver-abort-message-form">SCHC Receiver-Abort Message Format</a>
              </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="DL-ACK-Always">
<section id="section-3.6.5">
          <h4 id="name-downlink-ack-always-mode-si">
<a class="section-number selfRef" href="#section-3.6.5">3.6.5. </a><a class="section-name selfRef" href="#name-downlink-ack-always-mode-si">Downlink ACK-Always Mode: Single-Byte SCHC Header</a>
          </h4>
<div id="DL-ACK-Always-1byte-schc-fragment">
<section id="section-3.6.5.1">
            <h5 id="name-regular-schc-fragment-5">
<a class="section-number selfRef" href="#section-3.6.5.1">3.6.5.1. </a><a class="section-name selfRef" href="#name-regular-schc-fragment-5">Regular SCHC Fragment</a>
            </h5>
<p id="section-3.6.5.1-1"><a class="auto internal xref" href="#DL-ACK-Always-1byte-frag">Figure 25</a> shows an example of a Regular SCHC Fragment for all fragments except the last one.
The penultimate tile of a SCHC Packet is of the regular size.<a class="pilcrow" href="#section-3.6.5.1-1">¶</a></p>
<span id="name-regular-schc-fragment-format-fo"></span><div id="DL-ACK-Always-1byte-frag">
<figure id="figure-25">
              <div class="alignCenter art-text artwork" id="section-3.6.5.1-2.1">
<pre>   SCHC Fragment
|--    Header   --|
+-----------------+---------+
| RuleID |  FCN   | Payload |
+--------+--------+---------+
| 3 bits | 5 bits | 56 bits |
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-25">Figure 25</a>:
<a class="selfRef" href="#name-regular-schc-fragment-format-fo">Regular SCHC Fragment Format for All Fragments except the Last One</a>
              </figcaption></figure>
</div>
<p id="section-3.6.5.1-3">The SCHC ACK <span class="bcp14">MUST NOT</span> be used, instead the All-1 SCHC Fragment <span class="bcp14">MUST</span> be used to request a SCHC ACK from the receiver.
As per <span>[<a class="cite xref" href="#RFC8724">RFC8724</a>]</span>, the All-0 message is distinguishable from the SCHC ACK REQ (All-1 message).<a class="pilcrow" href="#section-3.6.5.1-3">¶</a></p>
</section>
</div>
<div id="DL-ACK-Always-1B-all-1-schc-fragment">
<section id="section-3.6.5.2">
            <h5 id="name-all-1-schc-fragment-5">
<a class="section-number selfRef" href="#section-3.6.5.2">3.6.5.2. </a><a class="section-name selfRef" href="#name-all-1-schc-fragment-5">All-1 SCHC Fragment</a>
            </h5>
<p id="section-3.6.5.2-1"><a class="auto internal xref" href="#DL-ACK-Always-1B-all-1">Figure 26</a> shows an example of the All-1 message.
The All-1 message <span class="bcp14">MAY</span> contain the last tile of the SCHC Packet.<a class="pilcrow" href="#section-3.6.5.2-1">¶</a></p>
<p id="section-3.6.5.2-2">The All-1 message Fragment Header contains an RCS of 5 bits and 3 padding bits to complete a 2-byte Fragment Header.
   The size of the last tile, if present, ranges from 8 to 48 bits.<a class="pilcrow" href="#section-3.6.5.2-2">¶</a></p>
<span id="name-all-1-schc-message-format-with-"></span><div id="DL-ACK-Always-1B-all-1">
<figure id="figure-26">
              <div class="alignCenter art-text artwork" id="section-3.6.5.2-3.1">
<pre>|--------- SCHC Fragment Header -------|
+--------------------------------------+--------------+
| RuleID | FCN=ALL-1 |  RCS   | b'000  |    Payload   |
+--------+-----------+--------+--------+--------------+
| 3 bits |  5 bits   | 5 bits | 3 bits | 0 to 48 bits |
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-26">Figure 26</a>:
<a class="selfRef" href="#name-all-1-schc-message-format-with-">All-1 SCHC Message Format with the Last Tile</a>
              </figcaption></figure>
</div>
<p id="section-3.6.5.2-4">As per <span>[<a class="cite xref" href="#RFC8724">RFC8724</a>]</span>, the All-1 must be distinguishable from the SCHC Sender-Abort message (with same RuleID and N values).
The SCHC Sender-Abort message header size is 1 byte with no padding bits.<a class="pilcrow" href="#section-3.6.5.2-4">¶</a></p>
<p id="section-3.6.5.2-5">For the All-1 message to be distinguishable from the Sender-Abort message, the Sender-Abort message <span class="bcp14">MUST</span> be 1 byte (only header with no padding).
This way, the minimum size of the All-1 is 2 bytes, and the Sender-Abort message is 1 bytes.<a class="pilcrow" href="#section-3.6.5.2-5">¶</a></p>
</section>
</div>
<div id="DL-ACK-Always-1B-schc-ack-format">
<section id="section-3.6.5.3">
            <h5 id="name-schc-ack-format-4">
<a class="section-number selfRef" href="#section-3.6.5.3">3.6.5.3. </a><a class="section-name selfRef" href="#name-schc-ack-format-4">SCHC ACK Format</a>
            </h5>
<p id="section-3.6.5.3-1"> <a class="auto internal xref" href="#DL-ACK-Always-1B-success-ack">Figure 27</a> shows the SCHC ACK format when all fragments have been correctly received (C=1).
Padding <span class="bcp14">MUST</span> be added to complete 2 bytes.<a class="pilcrow" href="#section-3.6.5.3-1">¶</a></p>
<span id="name-schc-success-ack-message-forma"></span><div id="DL-ACK-Always-1B-success-ack">
<figure id="figure-27">
              <div class="alignCenter art-text artwork" id="section-3.6.5.3-2.1">
<pre>     SCHC ACK
|--   Header   --|
+----------------+---------+
| RuleID | C=b'1 | b'0-pad |
+--------+-------+---------+
| 3 bits | 1 bit |  4 bits |
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-27">Figure 27</a>:
<a class="selfRef" href="#name-schc-success-ack-message-forma">SCHC Success ACK Message Format</a>
              </figcaption></figure>
</div>
<p id="section-3.6.5.3-3">
The SCHC ACK message format is shown in <a class="auto internal xref" href="#DL-ACK-Always-1B-schc-compound-ack">Figure 28</a>.<a class="pilcrow" href="#section-3.6.5.3-3">¶</a></p>
<span id="name-schc-compound-ack-message-forma"></span><div id="DL-ACK-Always-1B-schc-compound-ack">
<figure id="figure-28">
              <div class="alignCenter art-text artwork" id="section-3.6.5.3-4.1">
<pre>|---- SCHC ACK Header ----|
+--------+-------+--------+---------+
| RuleID | C=b'0 | Bitmap | b'0-pad |
+--------+-------+--------+---------+
| 3 bits | 1 bit | 31 bits|  5 bits |
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-28">Figure 28</a>:
<a class="selfRef" href="#name-schc-compound-ack-message-forma">SCHC Compound ACK Message Format</a>
              </figcaption></figure>
</div>
</section>
</div>
<div id="DL-ACK-Always-1B-snd-abort-msg">
<section id="section-3.6.5.4">
            <h5 id="name-schc-sender-abort-message-format-4">
<a class="section-number selfRef" href="#section-3.6.5.4">3.6.5.4. </a><a class="section-name selfRef" href="#name-schc-sender-abort-message-format-4">SCHC Sender-Abort Message Format</a>
            </h5>
<span id="name-schc-sender-abort-message-format-5"></span><div id="DL-ACK-Always-1B-snd-abort-msg-format">
<figure id="figure-29">
              <div class="alignCenter art-text artwork" id="section-3.6.5.4-1.1">
<pre>     Sender-Abort
|----   Header   ----|
+--------------------+
| RuleID | FCN=ALL-1 |
+--------+-----------+
| 3 bits |  5 bits   |
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-29">Figure 29</a>:
<a class="selfRef" href="#name-schc-sender-abort-message-format-5">SCHC Sender-Abort Message Format</a>
              </figcaption></figure>
</div>
</section>
</div>
<div id="DL-ACK-Always-1B-rcv-abort-msg">
<section id="section-3.6.5.5">
            <h5 id="name-schc-receiver-abort-message-forma">
<a class="section-number selfRef" href="#section-3.6.5.5">3.6.5.5. </a><a class="section-name selfRef" href="#name-schc-receiver-abort-message-forma">SCHC Receiver-Abort Message Format</a>
            </h5>
<span id="name-schc-receiver-abort-message-format"></span><div id="DL-ACK-Always-1B-rcv-abort-msg-format">
<figure id="figure-30">
              <div class="alignCenter art-text artwork" id="section-3.6.5.5-1.1">
<pre>  Receiver-Abort
|---  Header  ---|
+----------------+--------+-----------------+
| RuleID | C=b'1 | b'1111 |  0xFF (all 1's) |
+--------+-------+--------+-----------------+
| 3 bits | 1 bit | 4 bit  |  8 bit          |
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-30">Figure 30</a>:
<a class="selfRef" href="#name-schc-receiver-abort-message-format">SCHC Receiver-Abort Message Format</a>
              </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="padding">
<section id="section-3.7">
        <h3 id="name-padding">
<a class="section-number selfRef" href="#section-3.7">3.7. </a><a class="section-name selfRef" href="#name-padding">Padding</a>
        </h3>
<p id="section-3.7-1">The Sigfox payload fields have different characteristics in Uplink and Downlink.<a class="pilcrow" href="#section-3.7-1">¶</a></p>
<p id="section-3.7-2">Uplink messages can contain a payload size from 0 to 12 bytes. The Sigfox radio protocol allows sending zero bits,
one single bit of information for binary applications (e.g., status), or an integer number of bytes.
Therefore, for 2 or more bits of payload, it is required to add padding to the next integer number of bytes. The reason for this 
flexibility is to optimize transmission time and hence save battery consumption at the device.<a class="pilcrow" href="#section-3.7-2">¶</a></p>
<p id="section-3.7-3">On the other hand, Downlink frames have a fixed length. The payload length <span class="bcp14">MUST</span> be 64 bits (i.e., 8 bytes). Hence, if less
information bits are to be transmitted, padding <span class="bcp14">MUST</span> be used with bits equal to 0.
    The receiver <span class="bcp14">MUST</span> remove the added padding bits before the SCHC reassembly process.<a class="pilcrow" href="#section-3.7-3">¶</a></p>
</section>
</div>
</section>
</div>
<div id="fragmentation-rules-examples">
<section id="section-4">
      <h2 id="name-fragmentation-rules-example">
<a class="section-number selfRef" href="#section-4">4. </a><a class="section-name selfRef" href="#name-fragmentation-rules-example">Fragmentation Rules Examples</a>
      </h2>
<p id="section-4-1">This section provides an example of RuleID configuration for interoperability between the F/R modes presented in this document.
    Note that the RuleID space for Uplink F/R is different than the one for Downlink F/R; therefore, this section is divided in two subsections: Rules for Uplink fragmentation and Rules for Downlink fragmentation.<a class="pilcrow" href="#section-4-1">¶</a></p>
<p id="section-4-2">For Uplink F/R, multiple header lengths were described in <a class="auto internal xref" href="#Frag">Section 3.5</a>.
    All of them are part of the SCHC over Sigfox Profile and offer not only low protocol overhead for small payloads (single byte header) but also extensibility to transport larger payloads with more overhead (2-byte header, Options 1 and 2).
    The usage of the RuleID space for each header length is an implementation choice, but we provide an example of it in the following section.
    This illustrates implementation choices made in order to 1) identify the different header length and 2) finally parse the RuleID field to identify the RuleID value and execute the associated treatment.<a class="pilcrow" href="#section-4-2">¶</a></p>
<div id="uplink-fragmentation-rules-examples">
<section id="section-4.1">
        <h3 id="name-uplink-fragmentation-rules-">
<a class="section-number selfRef" href="#section-4.1">4.1. </a><a class="section-name selfRef" href="#name-uplink-fragmentation-rules-">Uplink Fragmentation Rules Examples</a>
        </h3>
<p id="section-4.1-1">
      The RuleID field for Uplink F/R modes has different sizes depending on the header length.
In order to identify the header length and then the value of the RuleID, the RuleID field
 is interpreted as follows:<a class="pilcrow" href="#section-4.1-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-2.1">The RuleID field is the first one to be parsed in the SCHC header, starting from the leftmost bits.<a class="pilcrow" href="#section-4.1-2.1">¶</a>
</li>
          <li class="normal" id="section-4.1-2.2">
            <p id="section-4.1-2.2.1">For Single-byte SCHC Header F/R modes, a RuleID field of 3 bits is expected:<a class="pilcrow" href="#section-4.1-2.2.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-2.2.2.1">If the first 3 leftmost bits have a value different than 0b'111, then it signals a Single-byte SCHC Header F/R mode.<a class="pilcrow" href="#section-4.1-2.2.2.1">¶</a>
</li>
              <li class="normal" id="section-4.1-2.2.2.2">If their value is 0b'111, then it signals a Two-byte SCHC Header F/R mode.<a class="pilcrow" href="#section-4.1-2.2.2.2">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-4.1-2.3">
            <p id="section-4.1-2.3.1">For Single-byte SCHC Header F/R modes:<a class="pilcrow" href="#section-4.1-2.3.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-2.3.2.1">There are 7 RuleIDs available (with values from 0b'000-0b'110); the RuleID with value 0b'111 is reserved to indicate a Two-byte SCHC Header.<a class="pilcrow" href="#section-4.1-2.3.2.1">¶</a>
</li>
              <li class="normal" id="section-4.1-2.3.2.2">This set of Rules is called "standard rules", and it is used to implement Single-byte SCHC Header modes.<a class="pilcrow" href="#section-4.1-2.3.2.2">¶</a>
</li>
              <li class="normal" id="section-4.1-2.3.2.3">Each RuleID is associated with a set of properties defining if Uplink F/R is used and which Uplink F/R mode is used. As an example, the RuleID 0b'000 is mapped onto Uplink No-ACK Mode: Single-byte SCHC Header, and the RuleIDs 0b'001 and 0b'002 are mapped onto Uplink ACK-on-Error mode: Single-byte SCHC Header (2 RuleIDs to allow for SCHC Packet interleaving).<a class="pilcrow" href="#section-4.1-2.3.2.3">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-4.1-2.4">
            <p id="section-4.1-2.4.1">For Two-byte SCHC Header F/R modes, at least 6 bits for the RuleID field are expected:<a class="pilcrow" href="#section-4.1-2.4.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-2.4.2.1">
                <p id="section-4.1-2.4.2.1.1">The 3 first leftmost bits are always 0b'111.<a class="pilcrow" href="#section-4.1-2.4.2.1.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-2.4.2.1.2.1">If the following 3 bits have a different value than 0b'111, then it signals the Two-byte SCHC Header Option 1.<a class="pilcrow" href="#section-4.1-2.4.2.1.2.1">¶</a>
</li>
                  <li class="normal" id="section-4.1-2.4.2.1.2.2">If the following 3 bits are 0b'111, then it signals the Two-byte SCHC Header Option 2.<a class="pilcrow" href="#section-4.1-2.4.2.1.2.2">¶</a>
</li>
                </ul>
</li>
              <li class="normal" id="section-4.1-2.4.2.2">For the Two-byte SCHC Header Option 1, there are 7 RuleIDs available (0b'111000-0b'111110), 0b'111111 being reserved to indicate the Two-byte SCHC Header Option 2. This set of Rules is called "extended rules", and it is used to implement the Uplink ACK-on-Error mode: Two-byte SCHC Header Option 1.<a class="pilcrow" href="#section-4.1-2.4.2.2">¶</a>
</li>
              <li class="normal" id="section-4.1-2.4.2.3">For the Two-byte SCHC Header Option 2, there are 2 additional bits to parse as the RuleID, so 4 RuleIDs are available (0b'11111100-0b'11111111). This set of Rules is used to cover specific cases that previous RuleIDs do not cover. As an example, RuleID 0b'00111111 is used to transport uncompressed IPv6 packets using the Uplink ACK-on-Error mode: Two-byte SCHC Header Option 2.<a class="pilcrow" href="#section-4.1-2.4.2.3">¶</a>
</li>
            </ul>
</li>
        </ul>
</section>
</div>
<div id="downlink-fragmentation-rules-examples">
<section id="section-4.2">
        <h3 id="name-downlink-fragmentation-rule">
<a class="section-number selfRef" href="#section-4.2">4.2. </a><a class="section-name selfRef" href="#name-downlink-fragmentation-rule">Downlink Fragmentation Rules Example</a>
        </h3>
<p id="section-4.2-1">For the Downlink ACK-Always Mode: Single-byte SCHC Header, RuleIDs can get values in ranges from 0b'000 to 0b'111.<a class="pilcrow" href="#section-4.2-1">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sequence-examples">
<section id="section-5">
      <h2 id="name-fragmentation-sequence-exam">
<a class="section-number selfRef" href="#section-5">5. </a><a class="section-name selfRef" href="#name-fragmentation-sequence-exam">Fragmentation Sequence Examples</a>
      </h2>
<p id="section-5-1">In this section, some sequence diagrams depict message exchanges for different fragmentation modes and use cases are shown. 
In the examples, 'Seq' indicates the Sigfox Sequence Number of the frame carrying a fragment.<a class="pilcrow" href="#section-5-1">¶</a></p>
<div id="no-ack-examples">
<section id="section-5.1">
        <h3 id="name-uplink-no-ack-examples">
<a class="section-number selfRef" href="#section-5.1">5.1. </a><a class="section-name selfRef" href="#name-uplink-no-ack-examples">Uplink No-ACK Examples</a>
        </h3>
<p id="section-5.1-1">The FCN field indicates the size of the data packet. 
The first fragment is marked with FCN = X-1, where X is the number of fragments the message is split into.
All fragments are marked with decreasing FCN values.
 The last packet fragment is marked with FCN = All-1 (1111).<a class="pilcrow" href="#section-5.1-1">¶</a></p>
<p id="section-5.1-2"><strong>Case No Losses - All fragments are sent and received successfully.</strong><a class="pilcrow" href="#section-5.1-2">¶</a></p>
<span id="name-uplink-no-ack-no-losses"></span><div id="UL-No-ACK-NL">
<figure id="figure-31">
          <div class="alignCenter art-text artwork" id="section-5.1-3.1">
<pre>Sender                     Receiver
  |-------FCN=6,Seq=1--------&gt;|
  |-------FCN=5,Seq=2--------&gt;|
  |-------FCN=4,Seq=3--------&gt;|
  |-------FCN=3,Seq=4--------&gt;|
  |-------FCN=2,Seq=5--------&gt;|
  |-------FCN=1,Seq=6--------&gt;|
  |-------FCN=15,Seq=7-------&gt;| All fragments received
(End)
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-31">Figure 31</a>:
<a class="selfRef" href="#name-uplink-no-ack-no-losses">Uplink No-ACK No-Losses</a>
          </figcaption></figure>
</div>
<p id="section-5.1-4">When the first SCHC Fragment is received, the receiver can calculate the 
total number of SCHC Fragments that the SCHC Packet is composed of.
For example, if the first fragment is numbered with FCN=6, the receiver can 
expect six more messages/fragments (i.e., with FCN going from 5 downwards and the last fragment with an
FCN equal to 15).<a class="pilcrow" href="#section-5.1-4">¶</a></p>
<p id="section-5.1-5"><strong>Case Losses on Any Fragment except the First</strong><a class="pilcrow" href="#section-5.1-5">¶</a></p>
<span id="name-uplink-no-ack-losses-scenar"></span><div id="UL-No-ACK-L-1">
<figure id="figure-32">
          <div class="alignCenter art-text artwork" id="section-5.1-6.1">
<pre>Sender                     Receiver
  |-------FCN=6,Seq=1--------&gt;|
  |-------FCN=5,Seq=2----X    |
  |-------FCN=4,Seq=3--------&gt;|
  |-------FCN=3,Seq=4--------&gt;|
  |-------FCN=2,Seq=5--------&gt;|
  |-------FCN=1,Seq=6--------&gt;|
  |-------FCN=15,Seq=7-------&gt;| Missing Fragment Unable to reassemble
(End)
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-32">Figure 32</a>:
<a class="selfRef" href="#name-uplink-no-ack-losses-scenar">Uplink No-ACK Losses (Scenario 1)</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="ack-on-error-examples-1B-header">
<section id="section-5.2">
        <h3 id="name-uplink-ack-on-error-example">
<a class="section-number selfRef" href="#section-5.2">5.2. </a><a class="section-name selfRef" href="#name-uplink-ack-on-error-example">Uplink ACK-on-Error Examples: Single-Byte SCHC Header</a>
        </h3>
<p id="section-5.2-1">The Single-byte SCHC Header ACK-on-Error mode allows sending up to 28 fragments and packet sizes up to
300 bytes. The SCHC Fragments may be delivered asynchronously, and Downlink ACK can be sent opportunistically.<a class="pilcrow" href="#section-5.2-1">¶</a></p>
<p id="section-5.2-2"><strong>Case No Losses</strong><a class="pilcrow" href="#section-5.2-2">¶</a></p>
<p id="section-5.2-3">The Downlink flag must be enabled in the sender Uplink message to allow a Downlink message from the receiver.
The Downlink Enable in the figures shows where the sender <span class="bcp14">MUST</span> enable the Downlink and
 wait for an ACK.<a class="pilcrow" href="#section-5.2-3">¶</a></p>
<span id="name-uplink-ack-on-error-no-loss"></span><div id="UL-ACKoE-NL">
<figure id="figure-33">
          <div class="alignCenter art-text artwork" id="section-5.2-4.1">
<pre>        Sender                    Receiver
          |-----W=0,FCN=6,Seq=1-----&gt;|
          |-----W=0,FCN=5,Seq=2-----&gt;|
          |-----W=0,FCN=4,Seq=3-----&gt;|
          |-----W=0,FCN=3,Seq=4-----&gt;|
          |-----W=0,FCN=2,Seq=5-----&gt;|
          |-----W=0,FCN=1,Seq=6-----&gt;|
DL Enable |-----W=0,FCN=0,Seq=7-----&gt;|
      (no ACK)
          |-----W=1,FCN=6,Seq=8-----&gt;|
          |-----W=1,FCN=5,Seq=9-----&gt;|
          |-----W=1,FCN=4,Seq=10----&gt;|
DL Enable |-----W=1,FCN=7,Seq=11----&gt;| All fragments received
          |&lt;- Compound ACK,W=1,C=1 --| C=1
        (End)
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-33">Figure 33</a>:
<a class="selfRef" href="#name-uplink-ack-on-error-no-loss">Uplink ACK-on-Error No-Losses</a>
          </figcaption></figure>
</div>
<p id="section-5.2-5"><strong>Case Fragment Losses in the First Window</strong><a class="pilcrow" href="#section-5.2-5">¶</a></p>
<p id="section-5.2-6">In this case, fragments are lost in the first window (W=0). 
After the first All-0 message arrives, the receiver
leverages the opportunity and sends a SCHC ACK with the corresponding bitmap and C=0.<a class="pilcrow" href="#section-5.2-6">¶</a></p>
<p id="section-5.2-7">After the loss fragments from the first window (W=0) are resent, the sender continues 
transmitting the fragments of the following window (W=1) without opening a reception opportunity.
Finally, the All-1 fragment is sent, the Downlink is enabled, and the SCHC ACK is received with C=1.
 Note that the SCHC Compound ACK also uses a Sequence Number.<a class="pilcrow" href="#section-5.2-7">¶</a></p>
<span id="name-uplink-ack-on-error-losses-"></span><div id="UL-ACKoE-LW1">
<figure id="figure-34">
          <div class="alignCenter art-text artwork" id="section-5.2-8.1">
<pre>        Sender                    Receiver
          |-----W=0,FCN=6,Seq=1-----&gt;|
          |-----W=0,FCN=5,Seq=2--X   |
          |-----W=0,FCN=4,Seq=3-----&gt;|
          |-----W=0,FCN=3,Seq=4-----&gt;|
          |-----W=0,FCN=2,Seq=5--X   |                    __
          |-----W=0,FCN=1,Seq=6-----&gt;|                   | W=0
DL Enable |-----W=0,FCN=0,Seq=7-----&gt;| Missing Fragments&lt;- FCN=5,Seq=2
          |&lt;- Compound ACK,W=0,C=0 --| Bitmap:1011011    | FCN=2,Seq=5
          |-----W=0,FCN=5,Seq=9-----&gt;|                    --
          |-----W=0,FCN=2,Seq=10----&gt;|
          |-----W=1,FCN=6,Seq=11----&gt;|
          |-----W=1,FCN=5,Seq=12----&gt;|
          |-----W=1,FCN=4,Seq=13----&gt;|
DL Enable |-----W=1,FCN=7,Seq=14----&gt;| All fragments received
          |&lt;-Compound ACK,W=1,C=1 ---| C=1
        (End)
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-34">Figure 34</a>:
<a class="selfRef" href="#name-uplink-ack-on-error-losses-">Uplink ACK-on-Error Losses in the First Window</a>
          </figcaption></figure>
</div>
<p id="section-5.2-9"><strong>Case Fragment All-0 Lost in the First Window (W=0)</strong><a class="pilcrow" href="#section-5.2-9">¶</a></p>
<p id="section-5.2-10">In this example, the All-0 of the first window (W=0) is lost. Therefore, 
the receiver waits for the next All-0 message of intermediate windows or All-1 message of last window to generate 
the corresponding SCHC ACK, which indicates that the All-0 of window 0 is absent.<a class="pilcrow" href="#section-5.2-10">¶</a></p>
<p id="section-5.2-11">The sender resends the missing All-0 messages (with any other missing 
fragment from window 0) without opening a reception opportunity.<a class="pilcrow" href="#section-5.2-11">¶</a></p>
<span id="name-uplink-ack-on-error-all-0-l"></span><div id="UL-ACKoE-LA0W1">
<figure id="figure-35">
          <div class="alignCenter art-text artwork" id="section-5.2-12.1">
<pre>        Sender                    Receiver
          |-----W=0,FCN=6,Seq=1-----&gt;|
          |-----W=0,FCN=5,Seq=2-----&gt;|
          |-----W=0,FCN=4,Seq=3-----&gt;|
          |-----W=0,FCN=3,Seq=4-----&gt;|
          |-----W=0,FCN=2,Seq=5-----&gt;|
          |-----W=0,FCN=1,Seq=6-----&gt;| DL Enable
          |-----W=0,FCN=0,Seq=7--X   |
      (no ACK)
          |-----W=1,FCN=6,Seq=8-----&gt;|
          |-----W=1,FCN=5,Seq=9-----&gt;|                    __
          |-----W=1,FCN=4,Seq=10----&gt;|                   |W=0
DL Enable |-----W=1,FCN=7,Seq=11----&gt;| Missing Fragment&lt;- FCN=0,Seq=7
          |&lt;-Compound ACK,W=0,C=0 ---| Bitmap:1111110    |__
          |-----W=0,FCN=0,Seq=13----&gt;| All fragments received
DL Enable |-----W=1,FCN=7,Seq=14----&gt;|
          |&lt;-Compound ACK,W=1,C=1 ---| C=1
        (End)
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-35">Figure 35</a>:
<a class="selfRef" href="#name-uplink-ack-on-error-all-0-l">Uplink ACK-on-Error All-0 Lost in the First Window</a>
          </figcaption></figure>
</div>
<p id="section-5.2-13">In the following diagram, besides the All-0, there are other fragment losses in the first window (W=0).<a class="pilcrow" href="#section-5.2-13">¶</a></p>
<span id="name-uplink-ack-on-error-all-0-a"></span><div id="UL-ACKoE-LA0FW1">
<figure id="figure-36">
          <div class="alignCenter art-text artwork" id="section-5.2-14.1">
<pre>        Sender                    Receiver
          |-----W=0,FCN=6,Seq=1-----&gt;|
          |-----W=0,FCN=5,Seq=2--X   |
          |-----W=0,FCN=4,Seq=3-----&gt;|
          |-----W=0,FCN=3,Seq=4--X   |
          |-----W=0,FCN=2,Seq=5-----&gt;|
          |-----W=0,FCN=1,Seq=6-----&gt;|
DL Enable |-----W=0,FCN=0,Seq=7--X   |
      (no ACK)
          |-----W=1,FCN=6,Seq=8-----&gt;|
          |-----W=1,FCN=5,Seq=9-----&gt;|                    __
          |-----W=1,FCN=4,Seq=10----&gt;|                   |W=0
DL Enable |-----W=1,FCN=7,Seq=11----&gt;| Missing Fragment&lt;- FCN=5,Seq=2
          |&lt;--Compound ACK,W=0,C=0 --| Bitmap:1010110    |FCN=3,Seq=4
          |-----W=0,FCN=5,Seq=13----&gt;|                   |FCN=0,Seq=7
          |-----W=0,FCN=3,Seq=14----&gt;|                    --
          |-----W=0,FCN=0,Seq=15----&gt;| All fragments received
DL Enable |-----W=1,FCN=7,Seq=16----&gt;|
          |&lt;-Compound ACK,W=1,C=1 ---| C=1
        (End)
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-36">Figure 36</a>:
<a class="selfRef" href="#name-uplink-ack-on-error-all-0-a">Uplink ACK-on-Error All-0 and Other Fragments Lost in the First Window</a>
          </figcaption></figure>
</div>
<p id="section-5.2-15">In the next examples, there are fragment losses in both the first (W=0) and second (W=1) windows.
The retransmission cycles after the All-1 is sent (i.e., not in intermediate windows) <span class="bcp14">MUST</span>
always finish with an All-1, as it serves as an ACK Request message to confirm the correct reception
of the retransmitted fragments.<a class="pilcrow" href="#section-5.2-15">¶</a></p>
<span id="name-uplink-ack-on-error-all-0-an"></span><div id="UL-ACKoE-LFW12-1">
<figure id="figure-37">
          <div class="alignCenter art-text artwork" id="section-5.2-16.1">
<pre>        Sender                    Receiver
          |-----W=0,FCN=6,Seq=1-----&gt;|
          |-----W=0,FCN=5,Seq=2--X   |
          |-----W=0,FCN=4,Seq=3-----&gt;|
          |-----W=0,FCN=3,Seq=4--X   |                    __
          |-----W=0,FCN=2,Seq=5-----&gt;|                   |W=0
          |-----W=0,FCN=1,Seq=6-----&gt;|                   |FCN=5,Seq=2
DL Enable |-----W=0,FCN=0,Seq=7--X   |                   |FCN=3,Seq=4
     (no ACK)                                            |FCN=0,Seq=7
          |-----W=1,FCN=6,Seq=8--X   |                   |W=1
          |-----W=1,FCN=5,Seq=9-----&gt;|                   |FCN=6,Seq=8
          |-----W=1,FCN=4,Seq=10-X   |                   |FCN=4,Seq=10
DL Enable |-----W=1,FCN=7,Seq=11----&gt;| Missing Fragment&lt;-|__
          |&lt;-Compound ACK,W=0,1,C=0--| Bitmap W=0:1010110
          |-----W=0,FCN=5,Seq=13----&gt;|        W=1:0100001
          |-----W=0,FCN=3,Seq=14----&gt;|
          |-----W=0,FCN=0,Seq=15----&gt;|
          |-----W=1,FCN=6,Seq=16----&gt;|
          |-----W=1,FCN=4,Seq=17----&gt;| All fragments received
DL Enable |-----W=1,FCN=7,Seq=18----&gt;|
          |&lt;-Compound ACK,W=1,C=1----| C=1
        (End)
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-37">Figure 37</a>:
<a class="selfRef" href="#name-uplink-ack-on-error-all-0-an">Uplink ACK-on-Error All-0 and Other Fragments Lost in the First and Second Windows (1)</a>
          </figcaption></figure>
</div>
<p id="section-5.2-17">The figure below is a similar case as above but with fewer fragments in the second window (W=1).<a class="pilcrow" href="#section-5.2-17">¶</a></p>
<span id="name-uplink-ack-on-error-all-0-and"></span><div id="UL-ACKoE-LFW12-2">
<figure id="figure-38">
          <div class="alignCenter art-text artwork" id="section-5.2-18.1">
<pre>        Sender                    Receiver
          |-----W=0,FCN=6,Seq=1-----&gt;|
          |-----W=0,FCN=5,Seq=2--X   |
          |-----W=0,FCN=4,Seq=3-----&gt;|
          |-----W=0,FCN=3,Seq=4--X   |
          |-----W=0,FCN=2,Seq=5-----&gt;|                     __
          |-----W=0,FCN=1,Seq=6-----&gt;|                    |W=0
DL Enable |-----W=0,FCN=0,Seq=7--X   |                    |FCN=5,Seq=2
       (no ACK)                                           |FCN=3,Seq=4
          |-----W=1,FCN=6,Seq=8--X   |                    |FCN=0,Seq=7
DL Enable |-----W=1,FCN=7,Seq=9-----&gt;| Missing Fragment--&gt; W=1
          |&lt;-Compound ACK,W=0,1, C=0-| Bitmap W=0:1010110,|FCN=6,Seq=8
          |-----W=0,FCN=5,Seq=11----&gt;|        W=1:0000001 |__
          |-----W=0,FCN=3,Seq=12----&gt;|
          |-----W=0,FCN=0,Seq=13----&gt;|
          |-----W=1,FCN=6,Seq=14----&gt;| All fragments received
DL Enable |-----W=1,FCN=7,Seq=15----&gt;|
          |&lt;-Compound ACK, W=1,C=1---| C=1
        (End)
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-38">Figure 38</a>:
<a class="selfRef" href="#name-uplink-ack-on-error-all-0-and">Uplink ACK-on-Error All-0 and Other Fragments Lost in the First and Second Windows (2)</a>
          </figcaption></figure>
</div>
<p id="section-5.2-19"><strong>Case SCHC ACK is Lost</strong><a class="pilcrow" href="#section-5.2-19">¶</a></p>
<p id="section-5.2-20">SCHC over Sigfox does not implement the SCHC ACK REQ message. Instead, it uses the SCHC All-1 message to request a SCHC ACK when required.<a class="pilcrow" href="#section-5.2-20">¶</a></p>
<span id="name-uplink-ack-on-error-ack-los"></span><div id="UL-ACKoE-ACKL">
<figure id="figure-39">
          <div class="alignCenter art-text artwork" id="section-5.2-21.1">
<pre>       Sender                     Receiver
          |-----W=0,FCN=6,Seq=1-----&gt;|
          |-----W=0,FCN=5,Seq=2-----&gt;|
          |-----W=0,FCN=4,Seq=3-----&gt;|
          |-----W=0,FCN=3,Seq=4-----&gt;|
          |-----W=0,FCN=2,Seq=5-----&gt;|
          |-----W=0,FCN=1,Seq=6-----&gt;|
DL Enable |-----W=0,FCN=0,Seq=7-----&gt;|
      (no ACK)
          |-----W=1,FCN=6,Seq=8-----&gt;|
          |-----W=1,FCN=5,Seq=9-----&gt;|
          |-----W=1,FCN=4,Seq=10----&gt;|
DL Enable |-----W=1,FCN=7,Seq=11----&gt;| All fragments received
          | X--Compound ACK,W=1,C=1 -| C=1
DL Enable |-----W=1,FCN=7,Seq=13----&gt;| RESEND ACK
          |&lt;-Compound ACK,W=1,C=1 ---| C=1
        (End)
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-39">Figure 39</a>:
<a class="selfRef" href="#name-uplink-ack-on-error-ack-los">Uplink ACK-on-Error ACK Lost</a>
          </figcaption></figure>
</div>
<p id="section-5.2-22"><strong>Case SCHC Compound ACK at the End</strong><a class="pilcrow" href="#section-5.2-22">¶</a></p>
<p id="section-5.2-23">In this example, SCHC Fragment losses are found in both windows 0 and 1. However, the sender does not send a
SCHC Compound ACK after the All-0 of window 0. Instead, it sends a SCHC Compound ACK indicating fragment losses on both windows.<a class="pilcrow" href="#section-5.2-23">¶</a></p>
<span id="name-uplink-ack-on-error-fragmen"></span><div id="UL-ACKoE-LFW12-3">
<figure id="figure-40">
          <div class="alignCenter art-text artwork" id="section-5.2-24.1">
<pre>        Sender                    Receiver
          |-----W=0,FCN=6,Seq=1-----&gt;|
          |-----W=0,FCN=5,Seq=2--X   |
          |-----W=0,FCN=4,Seq=3-----&gt;|
          |-----W=0,FCN=3,Seq=4--X   |
          |-----W=0,FCN=2,Seq=5-----&gt;|
          |-----W=0,FCN=1,Seq=6-----&gt;|                     __
DL Enable |-----W=0,FCN=0,Seq=7-----&gt;| Waits for          |W=0
       (no ACK)                       next DL opportunity |FCN=5,Seq=2
          |-----W=1,FCN=6,Seq=8--X   |                    |FCN=3,Seq=4
DL Enable |-----W=1,FCN=7,Seq=9-----&gt;| Missing Fragment&lt;-- W=1
          |&lt;-Compound ACK,W=0,1, C=0-| Bitmap W=0:1010110 |FCN=6,Seq=8
          |-----W=0,FCN=5,Seq=11----&gt;|        W=1:0000001  --
          |-----W=0,FCN=3,Seq=12----&gt;|
          |-----W=1,FCN=6,Seq=13----&gt;| All fragments received
DL Enable |-----W=1,FCN=7,Seq=14----&gt;|
          |&lt;-Compound ACK, W=1, C=1 -| C=1
        (End)
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-40">Figure 40</a>:
<a class="selfRef" href="#name-uplink-ack-on-error-fragmen">Uplink ACK-on-Error Fragments Lost in the First and Second Windows with One Compound ACK</a>
          </figcaption></figure>
</div>
<p id="section-5.2-25">The number of times the same SCHC ACK message will be retransmitted is determined by the
 MAX_ACK_REQUESTS.<a class="pilcrow" href="#section-5.2-25">¶</a></p>
</section>
</div>
<div id="abort-examples">
<section id="section-5.3">
        <h3 id="name-schc-abort-examples">
<a class="section-number selfRef" href="#section-5.3">5.3. </a><a class="section-name selfRef" href="#name-schc-abort-examples">SCHC Abort Examples</a>
        </h3>
<p id="section-5.3-1"><strong>Case SCHC Sender-Abort</strong><a class="pilcrow" href="#section-5.3-1">¶</a></p>
<p id="section-5.3-2">The sender may need to send a Sender-Abort to stop the current communication. For example, this may happen if the All-1 has been sent MAX_ACK_REQUESTS times.<a class="pilcrow" href="#section-5.3-2">¶</a></p>
<span id="name-uplink-ack-on-error-sender-"></span><div id="UL-ACKoE-SndAbt">
<figure id="figure-41">
          <div class="alignCenter art-text artwork" id="section-5.3-3.1">
<pre>        Sender                    Receiver
          |-----W=0,FCN=6,Seq=1-----&gt;|
          |-----W=0,FCN=5,Seq=2-----&gt;|
          |-----W=0,FCN=4,Seq=3-----&gt;|
          |-----W=0,FCN=3,Seq=4-----&gt;|
          |-----W=0,FCN=2,Seq=5-----&gt;|
          |-----W=0,FCN=1,Seq=6-----&gt;|
DL Enable |-----W=0,FCN=0,Seq=7-----&gt;|
      (no ACK)
          |-----W=1,FCN=6,Seq=8-----&gt;|
          |-----W=1,FCN=5,Seq=9-----&gt;|
          |-----W=1,FCN=4,Seq=10----&gt;|
DL Enable |-----W=1,FCN=7,Seq=11----&gt;| All fragments received
          | X--Compound ACK,W=1,C=1 -| C=1
DL Enable |-----W=1,FCN=7,Seq=13----&gt;| RESEND ACK  (1)
          | X--Compound ACK,W=1,C=1 -| C=1
DL Enable |-----W=1,FCN=7,Seq=15----&gt;| RESEND ACK  (2)
          | X--Compound ACK,W=1,C=1 -| C=1
DL Enable |-----W=1,FCN=7,Seq=17----&gt;| RESEND ACK  (3)
          | X--Compound ACK,W=1,C=1 -| C=1
DL Enable |-----W=1,FCN=7,Seq=18----&gt;| RESEND ACK  (4)
          | X--Compound ACK,W=1,C=1 -| C=1
DL Enable |-----W=1,FCN=7,Seq=19----&gt;| RESEND ACK  (5)
          | X--Compound ACK,W=1,C=1 -| C=1
DL Enable |----Sender-Abort,Seq=20--&gt;| exit with error condition
        (End)
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-41">Figure 41</a>:
<a class="selfRef" href="#name-uplink-ack-on-error-sender-">Uplink ACK-on-Error Sender-Abort</a>
          </figcaption></figure>
</div>
<p id="section-5.3-4"><strong>Case Receiver-Abort</strong><a class="pilcrow" href="#section-5.3-4">¶</a></p>
<p id="section-5.3-5">The receiver may need to send a Receiver-Abort to stop the current communication.
This message can only be sent after a Downlink Enable.<a class="pilcrow" href="#section-5.3-5">¶</a></p>
<span id="name-uplink-ack-on-error-receive"></span><div id="UL-ACKoE-RcvAbt">
<figure id="figure-42">
          <div class="alignCenter art-text artwork" id="section-5.3-6.1">
<pre>        Sender                    Receiver
          |-----W=0,FCN=6,Seq=1-----&gt;|
          |-----W=0,FCN=5,Seq=2-----&gt;|
          |-----W=0,FCN=4,Seq=3-----&gt;|
          |-----W=0,FCN=3,Seq=4-----&gt;|
          |-----W=0,FCN=2,Seq=5-----&gt;|
          |-----W=0,FCN=1,Seq=6-----&gt;|
DL Enable |-----W=0,FCN=0,Seq=7-----&gt;|
          |&lt;------  RECV ABORT ------| under-resourced
       (Error)
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-42">Figure 42</a>:
<a class="selfRef" href="#name-uplink-ack-on-error-receive">Uplink ACK-on-Error Receiver-Abort</a>
          </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-6">
      <h2 id="name-security-considerations">
<a class="section-number selfRef" href="#section-6">6. </a><a class="section-name selfRef" href="#name-security-considerations">Security Considerations</a>
      </h2>
<p id="section-6-1">The radio protocol authenticates and ensures the integrity of each message.
    This is achieved by using a unique Device ID and an AES-128-based message authentication code,
ensuring that the message has been generated and sent by the device (see <span>[<a class="cite xref" href="#sigfox-spec">sigfox-spec</a>]</span>, Section 3.8)  or Network (see <span>[<a class="cite xref" href="#sigfox-spec">sigfox-spec</a>]</span>, Section 4.3) with the ID claimed in the message <span>[<a class="cite xref" href="#sigfox-spec">sigfox-spec</a>]</span>.<a class="pilcrow" href="#section-6-1">¶</a></p>
<p id="section-6-2">Application data may or may  not  be encrypted at the application layer, depending on the criticality of the use case.
This flexibility allows a balance between cost and effort versus risk.
AES-128 in counter mode is used for encryption.  Cryptographic keys are independent for each device. These keys are associated with the Device ID, and separate integrity and 
encryption keys are pre-provisioned.
    An encryption key is only provisioned if confidentiality is to be used (see <span>[<a class="cite xref" href="#sigfox-spec">sigfox-spec</a>]</span>, Section 5.3; note that further documentation is available at Sigfox upon request).<a class="pilcrow" href="#section-6-2">¶</a></p>
<p id="section-6-3">The radio protocol has protections against replay attacks, and the cloud-based core Network provides firewall protection against undesired incoming communications <span>[<a class="cite xref" href="#sigfox-spec">sigfox-spec</a>]</span>.<a class="pilcrow" href="#section-6-3">¶</a></p>
<p id="section-6-4">The previously described security mechanisms do not guarantee end-to-end security between the device SCHC C/D + F/R and the Network SCHC C/D + F/R; potential security threats described in <span>[<a class="cite xref" href="#RFC8724">RFC8724</a>]</span> are applicable to the profile specified in this document.<a class="pilcrow" href="#section-6-4">¶</a></p>
<p id="section-6-5">In some circumstances, sending device location information is
privacy sensitive. The Device Geolocation parameter provided by the
Network
   is optional; therefore, it can be omitted to protect this aspect of
the device privacy.<a class="pilcrow" href="#section-6-5">¶</a></p>
</section>
</div>
<div id="ianaconsiderations">
<section id="section-7">
      <h2 id="name-iana-considerations">
<a class="section-number selfRef" href="#section-7">7. </a><a class="section-name selfRef" href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<p id="section-7-1">This document has no IANA actions.<a class="pilcrow" href="#section-7-1">¶</a></p>
</section>
</div>
<section id="section-8">
      <h2 id="name-references">
<a class="section-number selfRef" href="#section-8">8. </a><a class="section-name selfRef" href="#name-references">References</a>
      </h2>
<section id="section-8.1">
        <h3 id="name-normative-references">
<a class="section-number selfRef" href="#section-8.1">8.1. </a><a class="section-name selfRef" href="#name-normative-references">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time class="refDate" datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time class="refDate" datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8724">[RFC8724]</dt>
        <dd>
<span class="refAuthor">Minaburo, A.</span>, <span class="refAuthor">Toutain, L.</span>, <span class="refAuthor">Gomez, C.</span>, <span class="refAuthor">Barthel, D.</span>, and <span class="refAuthor">JC. Zuniga</span>, <span class="refTitle">"SCHC: Generic Framework for Static Context Header Compression and Fragmentation"</span>, <span class="seriesInfo">RFC 8724</span>, <span class="seriesInfo">DOI 10.17487/RFC8724</span>, <time class="refDate" datetime="2020-04">April 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8724">https://www.rfc-editor.org/info/rfc8724</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9441">[RFC9441]</dt>
        <dd>
<span class="refAuthor">Zúñiga, JC.</span>, <span class="refAuthor">Gomez, C.</span>, <span class="refAuthor">Aguilar, S.</span>, <span class="refAuthor">Toutain, L.</span>, <span class="refAuthor">Céspedes, S.</span>, and <span class="refAuthor">D. Wistuba</span>, <span class="refTitle">"Static Context Header Compression (SCHC) Compound Acknowledgement (ACK)"</span>, <span class="seriesInfo">RFC 9441</span>, <span class="seriesInfo">DOI 10.17487/RFC9441</span>, <time class="refDate" datetime="2023-07">July 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9441">https://www.rfc-editor.org/info/rfc9441</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="sigfox-spec">[sigfox-spec]</dt>
      <dd>
<span class="refAuthor">Sigfox</span>, <span class="refTitle">"Sigfox Device Radio Specifications"</span>, <span>&lt;<a href="https://build.sigfox.com/sigfox-device-radio-specifications">https://build.sigfox.com/sigfox-device-radio-specifications</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-8.2">
        <h3 id="name-informative-references">
<a class="section-number selfRef" href="#section-8.2">8.2. </a><a class="section-name selfRef" href="#name-informative-references">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-core-comi">[CORE-COMI]</dt>
        <dd>
<span class="refAuthor">Veillette, M., Ed.</span>, <span class="refAuthor">van der Stok, P., Ed.</span>, <span class="refAuthor">Pelov, A.</span>, <span class="refAuthor">Bierman, A.</span>, and <span class="refAuthor">C. Bormann, Ed.</span>, <span class="refTitle">"CoAP Management Interface (CORECONF)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-core-comi-12</span>, <time class="refDate" datetime="2023-03-13">13 March 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-comi-12">https://datatracker.ietf.org/doc/html/draft-ietf-core-comi-12</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6241">[RFC6241]</dt>
        <dd>
<span class="refAuthor">Enns, R., Ed.</span>, <span class="refAuthor">Bjorklund, M., Ed.</span>, <span class="refAuthor">Schoenwaelder, J., Ed.</span>, and <span class="refAuthor">A. Bierman, Ed.</span>, <span class="refTitle">"Network Configuration Protocol (NETCONF)"</span>, <span class="seriesInfo">RFC 6241</span>, <span class="seriesInfo">DOI 10.17487/RFC6241</span>, <time class="refDate" datetime="2011-06">June 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6241">https://www.rfc-editor.org/info/rfc6241</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7252">[RFC7252]</dt>
        <dd>
<span class="refAuthor">Shelby, Z.</span>, <span class="refAuthor">Hartke, K.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"The Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 7252</span>, <span class="seriesInfo">DOI 10.17487/RFC7252</span>, <time class="refDate" datetime="2014-06">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7252">https://www.rfc-editor.org/info/rfc7252</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8040">[RFC8040]</dt>
        <dd>
<span class="refAuthor">Bierman, A.</span>, <span class="refAuthor">Bjorklund, M.</span>, and <span class="refAuthor">K. Watsen</span>, <span class="refTitle">"RESTCONF Protocol"</span>, <span class="seriesInfo">RFC 8040</span>, <span class="seriesInfo">DOI 10.17487/RFC8040</span>, <time class="refDate" datetime="2017-01">January 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8040">https://www.rfc-editor.org/info/rfc8040</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8259">[RFC8259]</dt>
        <dd>
<span class="refAuthor">Bray, T., Ed.</span>, <span class="refTitle">"The JavaScript Object Notation (JSON) Data Interchange Format"</span>, <span class="seriesInfo">STD 90</span>, <span class="seriesInfo">RFC 8259</span>, <span class="seriesInfo">DOI 10.17487/RFC8259</span>, <time class="refDate" datetime="2017-12">December 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8259">https://www.rfc-editor.org/info/rfc8259</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8376">[RFC8376]</dt>
        <dd>
<span class="refAuthor">Farrell, S., Ed.</span>, <span class="refTitle">"Low-Power Wide Area Network (LPWAN) Overview"</span>, <span class="seriesInfo">RFC 8376</span>, <span class="seriesInfo">DOI 10.17487/RFC8376</span>, <time class="refDate" datetime="2018-05">May 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8376">https://www.rfc-editor.org/info/rfc8376</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8949">[RFC8949]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span> and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR)"</span>, <span class="seriesInfo">STD 94</span>, <span class="seriesInfo">RFC 8949</span>, <span class="seriesInfo">DOI 10.17487/RFC8949</span>, <time class="refDate" datetime="2020-12">December 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8949">https://www.rfc-editor.org/info/rfc8949</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="sigfox-callbacks">[sigfox-callbacks]</dt>
        <dd>
<span class="refAuthor">Sigfox</span>, <span class="refTitle">"Sigfox Callbacks"</span>, <span>&lt;<a href="https://support.sigfox.com/docs/callbacks-documentation">https://support.sigfox.com/docs/callbacks-documentation</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="sigfox-docs">[sigfox-docs]</dt>
      <dd>
<span class="refAuthor">Sigfox</span>, <span class="refTitle">"Sigfox Documentation"</span>, <span>&lt;<a href="https://support.sigfox.com/docs">https://support.sigfox.com/docs</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="acknowledgements">
<section id="appendix-A">
      <h2 id="name-acknowledgements">
<a class="section-name selfRef" href="#name-acknowledgements">Acknowledgements</a>
      </h2>
<p id="appendix-A-1"><span class="contact-name">Carles Gomez</span> has been funded in part by the Spanish Government
   through the TEC2016-79988-P grant and the PID2019-106808RA-I00 grant
   (funded by MCIN / AEI / 10.13039/501100011033) and by Secretaria
   d'Universitats i Recerca del Departament d'Empresa i Coneixement de
   la Generalitat de Catalunya through 2017 grant SGR 376 and 2021 grant SGR 00330.<a class="pilcrow" href="#appendix-A-1">¶</a></p>
<p id="appendix-A-2"><span class="contact-name">Sergio Aguilar</span> has been funded by the ERDF and the Spanish Government through project TEC2016-79988-P and project PID2019-106808RA-I00, AEI/FEDER, EU (funded by MCIN / AEI / 10.13039/501100011033).<a class="pilcrow" href="#appendix-A-2">¶</a></p>
<p id="appendix-A-3"><span class="contact-name">Sandra Cespedes</span> has been funded in part by the ANID Chile Project FONDECYT Regular 1201893 and Basal Project FB0008.<a class="pilcrow" href="#appendix-A-3">¶</a></p>
<p id="appendix-A-4"><span class="contact-name">Diego Wistuba</span> has been funded by the ANID Chile Project FONDECYT Regular 1201893.<a class="pilcrow" href="#appendix-A-4">¶</a></p>
<p id="appendix-A-5">The authors would like to thank <span class="contact-name">Ana Minaburo</span>, <span class="contact-name">Clement Mannequin</span>, <span class="contact-name">Rafael Vidal</span>, <span class="contact-name">Julien Boite</span>, <span class="contact-name">Renaud Marty</span>, and <span class="contact-name">Antonis Platis</span> for their useful comments and implementation design considerations.<a class="pilcrow" href="#appendix-A-5">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-addresses">
<a class="section-name selfRef" href="#name-authors-addresses">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Juan Carlos Zúñiga</span></div>
<div class="left" dir="auto">
<span class="locality">Montreal</span> <span class="region">QC</span> </div>
<div class="left" dir="auto"><span class="country-name">Canada</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:j.c.zuniga@ieee.org">j.c.zuniga@ieee.org</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Carles Gomez</span></div>
<div class="left" dir="auto"><span class="org">Universitat Politècnica de Catalunya</span></div>
<div class="left" dir="auto"><span class="street-address">C/Esteve Terradas, 7</span></div>
<div class="left" dir="auto">
<span class="postal-code">08860</span> <span class="locality">Castelldefels</span> </div>
<div class="left" dir="auto"><span class="country-name">Spain</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:carles.gomez@upc.edu">carles.gomez@upc.edu</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Sergio Aguilar</span></div>
<div class="left" dir="auto"><span class="org">Universitat Politècnica de Catalunya</span></div>
<div class="left" dir="auto"><span class="street-address">C/Esteve Terradas, 7</span></div>
<div class="left" dir="auto">
<span class="postal-code">08860</span> <span class="locality">Castelldefels</span> </div>
<div class="left" dir="auto"><span class="country-name">Spain</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:sergio.aguilar.romero@upc.edu">sergio.aguilar.romero@upc.edu</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Laurent Toutain</span></div>
<div class="left" dir="auto"><span class="org">IMT-Atlantique</span></div>
<div class="left" dir="auto"><span class="extended-address">CS 17607</span></div>
<div class="left" dir="auto"><span class="street-address">2 rue de la Chataigneraie</span></div>
<div class="left" dir="auto">
<span class="postal-code">35576</span> <span class="locality">Cesson-Sevigne Cedex</span>
</div>
<div class="left" dir="auto"><span class="country-name">France</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:Laurent.Toutain@imt-atlantique.fr">Laurent.Toutain@imt-atlantique.fr</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Sandra Céspedes</span></div>
<div class="left" dir="auto"><span class="org">Concordia University</span></div>
<div class="left" dir="auto"><span class="street-address">1455 De Maisonneuve Blvd. W.</span></div>
<div class="left" dir="auto">
<span class="locality">Montreal</span> <span class="region">QC</span> <span class="postal-code">H3G 1M8</span>
</div>
<div class="left" dir="auto"><span class="country-name">Canada</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:sandra.cespedes@concordia.ca">sandra.cespedes@concordia.ca</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Diego Wistuba</span></div>
<div class="left" dir="auto"><span class="org">NIC Labs, Universidad de Chile</span></div>
<div class="left" dir="auto"><span class="street-address">Av. Almte. Blanco Encalada 1975</span></div>
<div class="left" dir="auto"><span class="locality">Santiago</span></div>
<div class="left" dir="auto"><span class="country-name">Chile</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:research@witu.cl">research@witu.cl</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Julien Boite</span></div>
<div class="left" dir="auto"><span class="org">Unabiz (Sigfox)</span></div>
<div class="left" dir="auto"><span class="locality">Labege</span></div>
<div class="left" dir="auto"><span class="country-name">France</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:juboite@free.fr">juboite@free.fr</a>
</div>
<div class="url">
<span>URI:</span>
<a class="url" href="https://www.sigfox.com/">https://www.sigfox.com/</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>


</body></html>