<!DOCTYPE html>
<html class="RFC" lang="en"><head>
<meta charset="utf-8"/>
<meta content="Common,Latin" name="scripts"/>
<meta content="initial-scale=1.0" name="viewport"/>
<title>RFC 9312: Manageability of the QUIC Transport Protocol</title>
<meta content="Mirja KÃ¼hlewind" name="author"/>
<meta content="Brian Trammell" name="author"/>
<meta content="
       This document discusses manageability of the QUIC transport protocol and focuses
on the implications of QUIC's design and wire image on network operations
involving QUIC traffic. It is intended as a &quot;user's manual&quot; for the wire image to
provide guidance for network operators and equipment vendors who rely on the
use of transport-aware network functions. 
    " name="description"/>
<meta content="xml2rfc 3.15.0" name="generator"/>
<meta content="network management" name="keyword"/>
<meta content="wire image" name="keyword"/>
<meta content="9312" name="rfc.number"/>
<!-- Generator version information:
  xml2rfc 3.15.0
    Python 3.9.13
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.1
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 3.1.2
    kitchen 1.2.6
    lxml 4.9.0
    MarkupSafe 2.1.1
    pycountry 22.3.5
    PyYAML 6.0
    requests 2.28.0
    setuptools 44.1.1
    six 1.16.0
    weasyprint 56.1
-->
<link href="rfc9312.xml" rel="alternate" type="application/rfc+xml"/>
<link href="#copyright" rel="license"/>
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  pre.breakable {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css"/>
<link href="https://dx.doi.org/10.17487/rfc9312" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <link href="https://datatracker.ietf.org/doc/draft-ietf-quic-manageability-18" rel="prev"/>
  </head>
<body class="xml2rfc">
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 9312</td>
<td class="center">QUIC Manageability</td>
<td class="right">September 2022</td>
</tr></thead>
<tfoot><tr>
<td class="left">KÃ¼hlewind &amp; Trammell</td>
<td class="center">Informational</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div class="document-information" id="external-metadata"></div>
<div class="document-information" id="internal-metadata">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a class="eref" href="https://www.rfc-editor.org/rfc/rfc9312">9312</a></dd>
<dt class="label-category">Category:</dt>
<dd class="category">Informational</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time class="published" datetime="2022-09">September 2022</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">M. KÃ¼hlewind</div>
<div class="org">Ericsson</div>
</div>
<div class="author">
      <div class="author-name">B. Trammell</div>
<div class="org">Google Switzerland GmbH</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 9312</h1>
<h1 id="title">Manageability of the QUIC Transport Protocol</h1>
<section id="section-abstract">
      <h2 id="abstract"><a class="selfRef" href="#abstract">Abstract</a></h2>
<p id="section-abstract-1">This document discusses manageability of the QUIC transport protocol and focuses
on the implications of QUIC's design and wire image on network operations
involving QUIC traffic. It is intended as a "user's manual" for the wire image to
provide guidance for network operators and equipment vendors who rely on the
use of transport-aware network functions.<a class="pilcrow" href="#section-abstract-1">Â¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a class="section-name selfRef" href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This document is not an Internet Standards Track specification; it is
            published for informational purposes.<a class="pilcrow" href="#section-boilerplate.1-1">Â¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by the
            Internet Engineering Steering Group (IESG).  Not all documents
            approved by the IESG are candidates for any level of Internet
            Standard; see Section 2 of RFC 7841.<a class="pilcrow" href="#section-boilerplate.1-2">Â¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc9312">https://www.rfc-editor.org/info/rfc9312</a></span>.<a class="pilcrow" href="#section-boilerplate.1-3">Â¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a class="section-name selfRef" href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2022 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a class="pilcrow" href="#section-boilerplate.2-1">Â¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a class="pilcrow" href="#section-boilerplate.2-2">Â¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a class="toplink" href="#" onclick="scroll(0,0)">â²</a><h2 id="name-table-of-contents">
<a class="section-name selfRef" href="#name-table-of-contents">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p class="keepWithNext" id="section-toc.1-1.1.1"><a class="auto internal xref" href="#section-1">1</a>.Â Â <a class="internal xref" href="#name-introduction">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a class="auto internal xref" href="#section-2">2</a>.Â Â <a class="internal xref" href="#name-features-of-the-quic-wire-i">Features of the QUIC Wire Image</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p class="keepWithNext" id="section-toc.1-1.2.2.1.1"><a class="auto internal xref" href="#section-2.1">2.1</a>.Â Â <a class="internal xref" href="#name-quic-packet-header-structur">QUIC Packet Header Structure</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p class="keepWithNext" id="section-toc.1-1.2.2.2.1"><a class="auto internal xref" href="#section-2.2">2.2</a>.Â Â <a class="internal xref" href="#name-coalesced-packets">Coalesced Packets</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a class="auto internal xref" href="#section-2.3">2.3</a>.Â Â <a class="internal xref" href="#name-use-of-port-numbers">Use of Port Numbers</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.4">
                <p id="section-toc.1-1.2.2.4.1"><a class="auto internal xref" href="#section-2.4">2.4</a>.Â Â <a class="internal xref" href="#name-the-quic-handshake">The QUIC Handshake</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.5">
                <p id="section-toc.1-1.2.2.5.1"><a class="auto internal xref" href="#section-2.5">2.5</a>.Â Â <a class="internal xref" href="#name-integrity-protection-of-the">Integrity Protection of the Wire Image</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.6">
                <p id="section-toc.1-1.2.2.6.1"><a class="auto internal xref" href="#section-2.6">2.6</a>.Â Â <a class="internal xref" href="#name-connection-id-and-rebinding">Connection ID and Rebinding</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.7">
                <p id="section-toc.1-1.2.2.7.1"><a class="auto internal xref" href="#section-2.7">2.7</a>.Â Â <a class="internal xref" href="#name-packet-numbers">Packet Numbers</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.8">
                <p id="section-toc.1-1.2.2.8.1"><a class="auto internal xref" href="#section-2.8">2.8</a>.Â Â <a class="internal xref" href="#name-version-negotiation-and-gre">Version Negotiation and Greasing</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a class="auto internal xref" href="#section-3">3</a>.Â Â <a class="internal xref" href="#name-network-visible-information">Network-Visible Information about QUIC Flows</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a class="auto internal xref" href="#section-3.1">3.1</a>.Â Â <a class="internal xref" href="#name-identifying-quic-traffic">Identifying QUIC Traffic</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.1">
                    <p id="section-toc.1-1.3.2.1.2.1.1"><a class="auto internal xref" href="#section-3.1.1">3.1.1</a>.Â Â <a class="internal xref" href="#name-identifying-negotiated-vers">Identifying Negotiated Version</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.2">
                    <p id="section-toc.1-1.3.2.1.2.2.1"><a class="auto internal xref" href="#section-3.1.2">3.1.2</a>.Â Â <a class="internal xref" href="#name-first-packet-identification">First Packet Identification for Garbage Rejection</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a class="auto internal xref" href="#section-3.2">3.2</a>.Â Â <a class="internal xref" href="#name-connection-confirmation">Connection Confirmation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a class="auto internal xref" href="#section-3.3">3.3</a>.Â Â <a class="internal xref" href="#name-distinguishing-acknowledgme">Distinguishing Acknowledgment Traffic</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a class="auto internal xref" href="#section-3.4">3.4</a>.Â Â <a class="internal xref" href="#name-server-name-indication-sni">Server Name Indication (SNI)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4.2.1">
                    <p id="section-toc.1-1.3.2.4.2.1.1"><a class="auto internal xref" href="#section-3.4.1">3.4.1</a>.Â Â <a class="internal xref" href="#name-extracting-server-name-indi">Extracting Server Name Indication (SNI) Information</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a class="auto internal xref" href="#section-3.5">3.5</a>.Â Â <a class="internal xref" href="#name-flow-association">Flow Association</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6">
                <p id="section-toc.1-1.3.2.6.1"><a class="auto internal xref" href="#section-3.6">3.6</a>.Â Â <a class="internal xref" href="#name-flow-teardown">Flow Teardown</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.7">
                <p id="section-toc.1-1.3.2.7.1"><a class="auto internal xref" href="#section-3.7">3.7</a>.Â Â <a class="internal xref" href="#name-flow-symmetry-measurement">Flow Symmetry Measurement</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.8">
                <p id="section-toc.1-1.3.2.8.1"><a class="auto internal xref" href="#section-3.8">3.8</a>.Â Â <a class="internal xref" href="#name-round-trip-time-rtt-measure">Round-Trip Time (RTT) Measurement</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.8.2.1">
                    <p id="section-toc.1-1.3.2.8.2.1.1"><a class="auto internal xref" href="#section-3.8.1">3.8.1</a>.Â Â <a class="internal xref" href="#name-measuring-initial-rtt">Measuring Initial RTT</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.8.2.2">
                    <p id="section-toc.1-1.3.2.8.2.2.1"><a class="auto internal xref" href="#section-3.8.2">3.8.2</a>.Â Â <a class="internal xref" href="#name-using-the-spin-bit-for-pass">Using the Spin Bit for Passive RTT Measurement</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a class="auto internal xref" href="#section-4">4</a>.Â Â <a class="internal xref" href="#name-specific-network-management">Specific Network Management Tasks</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a class="auto internal xref" href="#section-4.1">4.1</a>.Â Â <a class="internal xref" href="#name-passive-network-performance">Passive Network Performance Measurement and Troubleshooting</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a class="auto internal xref" href="#section-4.2">4.2</a>.Â Â <a class="internal xref" href="#name-stateful-treatment-of-quic-">Stateful Treatment of QUIC Traffic</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a class="auto internal xref" href="#section-4.3">4.3</a>.Â Â <a class="internal xref" href="#name-address-rewriting-to-ensure">Address Rewriting to Ensure Routing Stability</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a class="auto internal xref" href="#section-4.4">4.4</a>.Â Â <a class="internal xref" href="#name-server-cooperation-with-loa">Server Cooperation with Load Balancers</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a class="auto internal xref" href="#section-4.5">4.5</a>.Â Â <a class="internal xref" href="#name-filtering-behavior">Filtering Behavior</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.6">
                <p id="section-toc.1-1.4.2.6.1"><a class="auto internal xref" href="#section-4.6">4.6</a>.Â Â <a class="internal xref" href="#name-udp-blocking-throttling-and">UDP Blocking, Throttling, and NAT Binding</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.7">
                <p id="section-toc.1-1.4.2.7.1"><a class="auto internal xref" href="#section-4.7">4.7</a>.Â Â <a class="internal xref" href="#name-ddos-detection-and-mitigati">DDoS Detection and Mitigation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.8">
                <p id="section-toc.1-1.4.2.8.1"><a class="auto internal xref" href="#section-4.8">4.8</a>.Â Â <a class="internal xref" href="#name-quality-of-service-handling">Quality of Service Handling and ECMP Routing</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.9">
                <p id="section-toc.1-1.4.2.9.1"><a class="auto internal xref" href="#section-4.9">4.9</a>.Â Â <a class="internal xref" href="#name-handling-icmp-messages">Handling ICMP Messages</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.10">
                <p id="section-toc.1-1.4.2.10.1"><a class="auto internal xref" href="#section-4.10">4.10</a>.Â <a class="internal xref" href="#name-guiding-path-mtu">Guiding Path MTU</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a class="auto internal xref" href="#section-5">5</a>.Â Â <a class="internal xref" href="#name-iana-considerations">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a class="auto internal xref" href="#section-6">6</a>.Â Â <a class="internal xref" href="#name-security-considerations">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a class="auto internal xref" href="#section-7">7</a>.Â Â <a class="internal xref" href="#name-references">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a class="auto internal xref" href="#section-7.1">7.1</a>.Â Â <a class="internal xref" href="#name-normative-references">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a class="auto internal xref" href="#section-7.2">7.2</a>.Â Â <a class="internal xref" href="#name-informative-references">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a class="auto internal xref" href="#appendix-A"></a><a class="internal xref" href="#name-acknowledgments">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a class="auto internal xref" href="#appendix-B"></a><a class="internal xref" href="#name-contributors">Contributors</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a class="auto internal xref" href="#appendix-C"></a><a class="internal xref" href="#name-authors-addresses">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a class="section-number selfRef" href="#section-1">1. </a><a class="section-name selfRef" href="#name-introduction">Introduction</a>
      </h2>
<p id="section-1-1">QUIC <span>[<a class="cite xref" href="#RFC9000">QUIC-TRANSPORT</a>]</span> is a new transport protocol
that is encapsulated in UDP. QUIC integrates TLS
<span>[<a class="cite xref" href="#RFC9001">QUIC-TLS</a>]</span> to encrypt all payload data and most control
information. QUIC version 1 was designed primarily as a transport for HTTP with
the resulting protocol being known as HTTP/3 <span>[<a class="cite xref" href="#RFC9114">QUIC-HTTP</a>]</span>.<a class="pilcrow" href="#section-1-1">Â¶</a></p>
<p id="section-1-2">This document provides guidance for network operations that manage QUIC
traffic. This includes guidance on how to interpret and utilize information that
is exposed by QUIC to the network, requirements and assumptions of the QUIC
design with respect to network treatment, and a description of how common
network management practices will be impacted by QUIC.<a class="pilcrow" href="#section-1-2">Â¶</a></p>
<p id="section-1-3">QUIC is an end-to-end transport protocol; therefore, no information in
the protocol header is intended to be mutable by the network. This
property is
enforced through integrity protection of the wire image <span>[<a class="cite xref" href="#RFC8546">WIRE-IMAGE</a>]</span>.
Encryption of most transport-layer control signaling means that less information
is visible to the network in comparison to TCP.<a class="pilcrow" href="#section-1-3">Â¶</a></p>
<p id="section-1-4">Integrity protection can also simplify troubleshooting at the end points as none
of the nodes on the network path can modify transport layer information.
However, it means in-network operations that depend on modification of data
(for examples, see <span>[<a class="cite xref" href="#RFC9065">RFC9065</a>]</span>) are not possible without the cooperation of
a QUIC endpoint. Such cooperation might be possible with the introduction of
a proxy that authenticates as an endpoint. Proxy operations are not in scope
for this document.<a class="pilcrow" href="#section-1-4">Â¶</a></p>
<p id="section-1-5">Network management is not a one-size-fits-all endeavor; for example, practices considered
necessary or even mandatory within enterprise networks with certain compliance
requirements would be impermissible on other networks without
those requirements. Therefore, presence of a particular practice in this document
should not be construed as a recommendation to apply it. For each
practice, this document describes what is and is not possible with the QUIC
transport protocol as defined.<a class="pilcrow" href="#section-1-5">Â¶</a></p>
<p id="section-1-6">This document focuses solely on network management practices that observe
traffic on the wire. For example, replacement of troubleshooting based on observation
with active measurement techniques is therefore out of scope.
A more generalized treatment of network management operations on encrypted
transports is given in <span>[<a class="cite xref" href="#RFC9065">RFC9065</a>]</span>.<a class="pilcrow" href="#section-1-6">Â¶</a></p>
<p id="section-1-7">QUIC-specific terminology used in this document is defined
in <span>[<a class="cite xref" href="#RFC9000">QUIC-TRANSPORT</a>]</span>.<a class="pilcrow" href="#section-1-7">Â¶</a></p>
</section>
</div>
<div id="sec-wire-image">
<section id="section-2">
      <h2 id="name-features-of-the-quic-wire-i">
<a class="section-number selfRef" href="#section-2">2. </a><a class="section-name selfRef" href="#name-features-of-the-quic-wire-i">Features of the QUIC Wire Image</a>
      </h2>
<p id="section-2-1">This section discusses aspects of the QUIC transport protocol that
have an impact on the design and operation of devices that forward QUIC packets.
Therefore, this section is primarily considering the unencrypted part of QUIC's
wire image <span>[<a class="cite xref" href="#RFC8546">WIRE-IMAGE</a>]</span>, which is defined as the information available in the
packet header in each QUIC packet, and the dynamics of that information. Since
QUIC is a versioned protocol, the wire image of the header format can also
change from version to version. However, the field that identifies the QUIC
version in some packets and the format of the Version Negotiation packet
are both inspectable and invariant
<span>[<a class="cite xref" href="#RFC8999">QUIC-INVARIANTS</a>]</span>.<a class="pilcrow" href="#section-2-1">Â¶</a></p>
<p id="section-2-2">This document addresses version 1 of the QUIC protocol, whose wire image
is fully defined in <span>[<a class="cite xref" href="#RFC9000">QUIC-TRANSPORT</a>]</span> and <span>[<a class="cite xref" href="#RFC9001">QUIC-TLS</a>]</span>. Features of the wire
image described herein may change in future versions of the protocol except
when specified as an invariant <span>[<a class="cite xref" href="#RFC8999">QUIC-INVARIANTS</a>]</span>
and cannot be used to identify QUIC as a protocol or
to infer the behavior of future versions of QUIC.<a class="pilcrow" href="#section-2-2">Â¶</a></p>
<div id="public-header">
<section id="section-2.1">
        <h3 id="name-quic-packet-header-structur">
<a class="section-number selfRef" href="#section-2.1">2.1. </a><a class="section-name selfRef" href="#name-quic-packet-header-structur">QUIC Packet Header Structure</a>
        </h3>
<p id="section-2.1-1">QUIC packets may have either a long header or a short header. The first bit
of the QUIC header is the Header Form bit and indicates which type of header
is present. The purpose of this bit is invariant across QUIC versions.<a class="pilcrow" href="#section-2.1-1">Â¶</a></p>
<p id="section-2.1-2">The long header exposes more information. It contains a version number, as well
as Source and Destination Connection IDs for associating packets with a QUIC
connection. The definition and location of these fields in the QUIC long header
are invariant for future versions of QUIC, although future versions of QUIC may
provide additional fields in the long header <span>[<a class="cite xref" href="#RFC8999">QUIC-INVARIANTS</a>]</span>.<a class="pilcrow" href="#section-2.1-2">Â¶</a></p>
<p id="section-2.1-3">In version 1 of QUIC, the long header is used during connection establishment
to transmit CRYPTO handshake data, perform version negotiation, retry, and
send 0-RTT data.<a class="pilcrow" href="#section-2.1-3">Â¶</a></p>
<p id="section-2.1-4">Short headers are used after a connection establishment in version 1 of QUIC
and expose only an optional Destination Connection ID and the initial flags
byte with the spin bit for RTT measurement.<a class="pilcrow" href="#section-2.1-4">Â¶</a></p>
<p id="section-2.1-5">The following information is exposed in QUIC packet headers in all versions of
QUIC (as specified in <span>[<a class="cite xref" href="#RFC8999">QUIC-INVARIANTS</a>]</span>):<a class="pilcrow" href="#section-2.1-5">Â¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2.1-6">
          <dt id="section-2.1-6.1">version number:</dt>
          <dd id="section-2.1-6.2" style="margin-left: 1.5em">The version number is present in the long header and
identifies the version used for that packet. During Version
Negotiation (see <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9000#section-17.2.1">Section 17.2.1</a> of [<a class="cite xref" href="#RFC9000">QUIC-TRANSPORT</a>]</span> and <a class="auto internal xref" href="#version">Section 2.8</a>), the
Version field has a special value (0x00000000) that identifies the
packet as a Version Negotiation packet. QUIC
version 1 uses version 0x00000001. Operators should expect to observe
packets with other version numbers as a result of various Internet
experiments, future standards, and greasing <span>[<a class="cite xref" href="#RFC7801">RFC7801</a>]</span>. An IANA registry
contains the values of all standardized versions of QUIC, and may contain some
proprietary versions (see <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9000#section-22.2">Section 22.2</a> of [<a class="cite xref" href="#RFC9000">QUIC-TRANSPORT</a>]</span>). 
However, other versions of QUIC can be expected to be seen in the Internet at any given time.<a class="pilcrow" href="#section-2.1-6.2">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-6.3">Source and Destination Connection ID:</dt>
          <dd id="section-2.1-6.4" style="margin-left: 1.5em">Short and long headers carry a
Destination Connection ID, which is a variable-length field. If the Destination Connection ID is not zero length,
it can be used to
identify the connection associated with a QUIC packet for load balancing and
NAT rebinding purposes; see Sections <a class="auto internal xref" href="#sec-loadbalancing">4.4</a> and <a class="auto internal xref" href="#rebinding">2.6</a>. Long 
packet headers additionally carry a Source Connection ID. The Source 
Connection ID is only present on long 
headers and indicates the Destination Connection
ID that the other endpoint should use when sending packets.
On long header packets, the length of the connection 
IDs is also present; on short header packets, the length of the Destination 
Connection ID is implicit, as it is known from preceding long header 
packets.<a class="pilcrow" href="#section-2.1-6.4">Â¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-2.1-7">In version 1 of QUIC, the following additional information is exposed:<a class="pilcrow" href="#section-2.1-7">Â¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2.1-8">
          <dt id="section-2.1-8.1">"Fixed Bit":</dt>
          <dd id="section-2.1-8.2" style="margin-left: 1.5em">In version 1 of QUIC, the second-most-significant bit of the first octet 
is set to 1, unless the packet is a Version Negotiation packet or
an extension is used that modifies the usage of this bit. 
If the bit is set to 1, it enables endpoints to easily demultiplex 
with other UDP-encapsulated protocols. Even though this bit is fixed in the
version 1 specification, endpoints might use an extension that varies the bit
<span>[<a class="cite xref" href="#RFC9287">QUIC-GREASE</a>]</span>. Therefore, observers cannot reliably use it as an identifier
for QUIC.<a class="pilcrow" href="#section-2.1-8.2">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-8.3">latency spin bit:</dt>
          <dd id="section-2.1-8.4" style="margin-left: 1.5em">The third-most-significant bit of the first octet in the
short header for version 1. The spin bit is set by endpoints such that
tracking edge transitions can be used to passively observe end-to-end RTT. See
<a class="auto internal xref" href="#spin-usage">Section 3.8.2</a> for further details.<a class="pilcrow" href="#section-2.1-8.4">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-8.5">header type:</dt>
          <dd id="section-2.1-8.6" style="margin-left: 1.5em">The long header has a 2-bit packet type field following the
Header Form and Fixed Bits. Header types correspond to stages of the
handshake; see <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9000#section-17.2">Section 17.2</a> of [<a class="cite xref" href="#RFC9000">QUIC-TRANSPORT</a>]</span> for details.<a class="pilcrow" href="#section-2.1-8.6">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-8.7">length:</dt>
          <dd id="section-2.1-8.8" style="margin-left: 1.5em">The length of the remaining QUIC packet after the Length field
present on long headers. This field is used to implement coalesced packets
during the handshake (see <a class="auto internal xref" href="#coalesced">Section 2.2</a>).<a class="pilcrow" href="#section-2.1-8.8">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-8.9">token:</dt>
          <dd id="section-2.1-8.10" style="margin-left: 1.5em"> Initial packets may contain a token, a variable-length opaque value
optionally sent from client to server, used for validating the client's
address. Retry packets also contain a token, which can be used by the client
in an Initial packet on a subsequent connection attempt. The length of the
token is explicit in both cases.<a class="pilcrow" href="#section-2.1-8.10">Â¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-2.1-9">Retry (<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9000#section-17.2.5">Section 17.2.5</a> of [<a class="cite xref" href="#RFC9000">QUIC-TRANSPORT</a>]</span>) and Version Negotiation (<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9000#section-17.2.1">Section 17.2.1</a> of [<a class="cite xref" href="#RFC9000">QUIC-TRANSPORT</a>]</span>) packets are not encrypted. Retry packets are
integrity protected.  Transport parameters are used to 
authenticate the contents of Retry packets later in the handshake. For other
kinds of packets, version 1 of QUIC cryptographically protects other
information in the packet headers:<a class="pilcrow" href="#section-2.1-9">Â¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2.1-10">
          <dt id="section-2.1-10.1">Packet Number:</dt>
          <dd id="section-2.1-10.2" style="margin-left: 1.5em">All packets except Version Negotiation and
Retry packets have an associated packet number; however, this packet number
is encrypted, and therefore not of use to on-path observers. The offset of the
packet number can be decoded in long headers while it
is implicit (depending on Destination Connection ID length) in short headers.
The length of the packet number is cryptographically protected.<a class="pilcrow" href="#section-2.1-10.2">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-10.3">Key Phase:</dt>
          <dd id="section-2.1-10.4" style="margin-left: 1.5em">The Key Phase bit (present in short headers) specifies the keys
used to encrypt the packet to support key rotation. The Key Phase bit is
cryptographically protected.<a class="pilcrow" href="#section-2.1-10.4">Â¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="coalesced">
<section id="section-2.2">
        <h3 id="name-coalesced-packets">
<a class="section-number selfRef" href="#section-2.2">2.2. </a><a class="section-name selfRef" href="#name-coalesced-packets">Coalesced Packets</a>
        </h3>
<p id="section-2.2-1">Multiple QUIC packets may be coalesced into a single UDP datagram
with a datagram
carrying one or more long header packets followed by zero or one short header
packets. When packets are coalesced, the Length fields in the long headers are
used to separate QUIC packets; see <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9000#section-12.2">Section 12.2</a> of [<a class="cite xref" href="#RFC9000">QUIC-TRANSPORT</a>]</span>.
The Length field is a variable-length field, and its position in the header
also varies depending on the lengths of the Source and Destination Connection
IDs; see <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9000#section-17.2">Section 17.2</a> of [<a class="cite xref" href="#RFC9000">QUIC-TRANSPORT</a>]</span>.<a class="pilcrow" href="#section-2.2-1">Â¶</a></p>
</section>
</div>
<div id="use-of-port-numbers">
<section id="section-2.3">
        <h3 id="name-use-of-port-numbers">
<a class="section-number selfRef" href="#section-2.3">2.3. </a><a class="section-name selfRef" href="#name-use-of-port-numbers">Use of Port Numbers</a>
        </h3>
<p id="section-2.3-1">Applications that have a mapping for TCP and QUIC are expected to
use the same port number for both services. However, as for all other IETF
transports <span>[<a class="cite xref" href="#RFC7605">RFC7605</a>]</span>, there is no guarantee that a specific application
will use a given registered port or that a given port carries traffic belonging
to the respective registered service, especially when application layer
information is encrypted. For example, <span>[<a class="cite xref" href="#RFC9114">QUIC-HTTP</a>]</span> specifies the use of the
HTTP Alternative Services mechanism <span>[<a class="cite xref" href="#RFC7838">RFC7838</a>]</span> for discovery of HTTP/3
services on other ports.<a class="pilcrow" href="#section-2.3-1">Â¶</a></p>
<p id="section-2.3-2">Further, as QUIC has a connection ID, it is also possible to maintain multiple
QUIC connections over one 5-tuple (protocol, source, and destination IP address and 
source and destination port). However, if the connection ID is zero length,
all packets of the 5-tuple likely belong to the same QUIC connection.<a class="pilcrow" href="#section-2.3-2">Â¶</a></p>
</section>
</div>
<div id="handshake">
<section id="section-2.4">
        <h3 id="name-the-quic-handshake">
<a class="section-number selfRef" href="#section-2.4">2.4. </a><a class="section-name selfRef" href="#name-the-quic-handshake">The QUIC Handshake</a>
        </h3>
<p id="section-2.4-1">New QUIC connections are established using a handshake that is distinguishable
on the wire (see <a class="auto internal xref" href="#sec-identifying">Section 3.1</a> for details) and contains some information
that can be passively observed.<a class="pilcrow" href="#section-2.4-1">Â¶</a></p>
<p id="section-2.4-2">To illustrate the information visible in the QUIC wire image during the
handshake, we first show the general communication pattern visible in the UDP
datagrams containing the QUIC handshake. Then, we examine each of the datagrams in
detail.<a class="pilcrow" href="#section-2.4-2">Â¶</a></p>
<p id="section-2.4-3">The QUIC handshake can normally be recognized on the wire through four flights
of datagrams labeled "Client Initial", "Server Initial", "Client Completion",
and "Server Completion" as illustrated in <a class="auto internal xref" href="#fig-handshake">Figure 1</a>.<a class="pilcrow" href="#section-2.4-3">Â¶</a></p>
<p id="section-2.4-4">A handshake starts with the client sending one or more datagrams containing
Initial packets (detailed in <a class="auto internal xref" href="#fig-client-initial">Figure 2</a>), which elicits the
Server Initial response (detailed in <a class="auto internal xref" href="#fig-server-initial">Figure 3</a>), which typically contains three types of packets: Initial packet(s) with the beginning of the server's
side of the TLS handshake, Handshake packet(s) with the rest of the server's
portion of the TLS handshake, and 1-RTT packet(s), if present.<a class="pilcrow" href="#section-2.4-4">Â¶</a></p>
<span id="name-general-communication-patte"></span><div id="fig-handshake">
<figure id="figure-1">
          <div class="alignLeft art-text artwork" id="section-2.4-5.1">
<pre>Client                                    Server
  |                                          |
  +----Client Initial-----------------------&gt;|
  +----(zero or more 0-RTT)-----------------&gt;|
  |                                          |
  |&lt;-----------------------Server Initial----+
  |&lt;--------(1-RTT encrypted data starts)----+
  |                                          |
  +----Client Completion--------------------&gt;|
  +----(1-RTT encrypted data starts)--------&gt;|
  |                                          |
  |&lt;--------------------Server Completion----+
  |                                          |</pre>
</div>
<figcaption><a class="selfRef" href="#figure-1">Figure 1</a>:
<a class="selfRef" href="#name-general-communication-patte">General Communication Pattern Visible in the QUIC Handshake</a>
          </figcaption></figure>
</div>
<p id="section-2.4-6">As shown here, the client can send 0-RTT data as soon as it has sent its 
ClientHello and the server can send 1-RTT data as soon as it has sent its ServerHello. 
The Client Completion flight contains at least one Handshake packet and
could also include an Initial packet. During the handshake, QUIC packets in separate contexts can be coalesced (see <a class="auto internal xref" href="#coalesced">Section 2.2</a>) in order to reduce the
number of UDP datagrams sent during the handshake.<a class="pilcrow" href="#section-2.4-6">Â¶</a></p>
<p id="section-2.4-7">Handshake packets can arrive out-of-order without impacting the handshake as
long as the reordering was not accompanied by extensive delays that trigger a
spurious Probe Timeout (<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9002#section-6.2">Section 6.2</a> of [<a class="cite xref" href="#RFC9002">QUIC-RECOVERY</a>]</span>).
If QUIC packets get lost or reordered, packets belonging
to the same flight might not be observed in close time succession, though
the sequence of the flights will not change because one flight depends
upon the peer's previous flight.<a class="pilcrow" href="#section-2.4-7">Â¶</a></p>
<p id="section-2.4-8">Datagrams that contain an Initial packet (Client Initial, Server
Initial, and some Client Completion) contain at least 1200 octets of UDP
payload. This protects against amplification attacks and verifies that the
network path meets the requirements for the minimum QUIC IP packet size;
see <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9000#section-14">Section 14</a> of [<a class="cite xref" href="#RFC9000">QUIC-TRANSPORT</a>]</span>. This is accomplished by either adding
PADDING frames within the Initial packet, coalescing other packets with the
Initial packet, or leaving unused payload in the UDP packet after the Initial
packet. A network path needs to be able to forward packets of at least this size
for QUIC to be used.<a class="pilcrow" href="#section-2.4-8">Â¶</a></p>
<p id="section-2.4-9">The content of Initial packets is encrypted using Initial Secrets,
which are derived from a per-version constant and the client's
Destination Connection ID. That content is therefore observable by
any on-path device that knows the per-version constant and is
considered visible in this illustration.  The content of QUIC
Handshake packets is encrypted using keys established during the
initial handshake exchange and is therefore not visible.<a class="pilcrow" href="#section-2.4-9">Â¶</a></p>
<p id="section-2.4-10">Initial, Handshake, and 1-RTT packets belong to different cryptographic and
transport contexts. The Client Completion (<a class="auto internal xref" href="#fig-init-complete">Figure 4</a>) and the
Server Completion (<a class="auto internal xref" href="#fig-hs-complete">Figure 5</a>) flights conclude the Initial
and Handshake contexts by sending final acknowledgments and
CRYPTO frames.<a class="pilcrow" href="#section-2.4-10">Â¶</a></p>
<span id="name-example-client-initial-data"></span><div id="fig-client-initial">
<figure id="figure-2">
          <div class="alignLeft art-text artwork" id="section-2.4-11.1">
<pre>+----------------------------------------------------------+
| UDP header (source and destination UDP ports)            |
+----------------------------------------------------------+
| QUIC long header (type = Initial, Version, DCID, SCID) (Length)
+----------------------------------------------------------+  |
| QUIC CRYPTO frame header                                 |  |
+----------------------------------------------------------+  |
| | TLS ClientHello (incl. TLS SNI)                     |  |  |
+----------------------------------------------------------+  |
| QUIC PADDING frames                                      |  |
+----------------------------------------------------------+&lt;-+</pre>
</div>
<figcaption><a class="selfRef" href="#figure-2">Figure 2</a>:
<a class="selfRef" href="#name-example-client-initial-data">Example Client Initial Datagram Without 0-RTT</a>
          </figcaption></figure>
</div>
<p id="section-2.4-12">A Client Initial packet exposes the Version, Source, and Destination
Connection IDs without encryption. The payload of the Initial
packet is protected using the Initial secret.  The complete TLS
ClientHello, including any TLS Server Name Indication (SNI)
present, is sent in one or more CRYPTO frames across one or more
QUIC Initial packets.<a class="pilcrow" href="#section-2.4-12">Â¶</a></p>
<span id="name-coalesced-server-initial-da"></span><div id="fig-server-initial">
<figure id="figure-3">
          <div class="alignLeft art-text artwork" id="section-2.4-13.1">
<pre>+------------------------------------------------------------+
| UDP header (source and destination UDP ports)              |
+------------------------------------------------------------+
| QUIC long header (type = Initial, Version, DCID, SCID)   (Length)
+------------------------------------------------------------+  |
| QUIC CRYPTO frame header                                   |  |
+------------------------------------------------------------+  |
| TLS ServerHello                                            |  |
+------------------------------------------------------------+  |
| QUIC ACK frame (acknowledging client hello)                |  |
+------------------------------------------------------------+&lt;-+
| QUIC long header (type = Handshake, Version, DCID, SCID) (Length)
+------------------------------------------------------------+  |
| encrypted payload (presumably CRYPTO frames)               |  |
+------------------------------------------------------------+&lt;-+
| QUIC short header                                          |
+------------------------------------------------------------+
| 1-RTT encrypted payload                                    |
+------------------------------------------------------------+</pre>
</div>
<figcaption><a class="selfRef" href="#figure-3">Figure 3</a>:
<a class="selfRef" href="#name-coalesced-server-initial-da">Coalesced Server Initial Datagram Pattern</a>
          </figcaption></figure>
</div>
<p id="section-2.4-14">The Server Initial datagram also exposes the version number and the Source and Destination
Connection IDs in the clear; the payload of the Initial packet is
protected using the Initial secret.<a class="pilcrow" href="#section-2.4-14">Â¶</a></p>
<span id="name-coalesced-client-completion"></span><div id="fig-init-complete">
<figure id="figure-4">
          <div class="alignLeft art-text artwork" id="section-2.4-15.1">
<pre>+------------------------------------------------------------+
| UDP header (source and destination UDP ports)              |
+------------------------------------------------------------+
| QUIC long header (type = Initial, Version, DCID, SCID)   (Length)
+------------------------------------------------------------+  |
| QUIC ACK frame (acknowledging Server Initial)              |  |
+------------------------------------------------------------+&lt;-+
| QUIC long header (type = Handshake, Version, DCID, SCID) (Length)
+------------------------------------------------------------+  |
| encrypted payload (presumably CRYPTO/ACK frames)           |  |
+------------------------------------------------------------+&lt;-+
| QUIC short header                                          |
+------------------------------------------------------------+
| 1-RTT encrypted payload                                    |
+------------------------------------------------------------+</pre>
</div>
<figcaption><a class="selfRef" href="#figure-4">Figure 4</a>:
<a class="selfRef" href="#name-coalesced-client-completion">Coalesced Client Completion Datagram Pattern</a>
          </figcaption></figure>
</div>
<p id="section-2.4-16">The Client Completion flight does not expose any additional information;
however, as the Destination Connection ID is server-selected, it usually
is not the same ID that is sent in the Client Initial. Client Completion
flights contain 1-RTT packets that indicate the handshake has completed
(see <a class="auto internal xref" href="#sec-confirm">Section 3.2</a>) on the client and for three-way handshake RTT
estimation as in <a class="auto internal xref" href="#sec-rtt">Section 3.8</a>.<a class="pilcrow" href="#section-2.4-16">Â¶</a></p>
<span id="name-coalesced-server-completion"></span><div id="fig-hs-complete">
<figure id="figure-5">
          <div class="alignLeft art-text artwork" id="section-2.4-17.1">
<pre>+------------------------------------------------------------+
| UDP header (source and destination UDP ports)              |
+------------------------------------------------------------+
| QUIC long header (type = Handshake, Version, DCID, SCID) (Length)
+------------------------------------------------------------+  |
| encrypted payload (presumably ACK frame)                   |  |
+------------------------------------------------------------+&lt;-+
| QUIC short header                                          |
+------------------------------------------------------------+
| 1-RTT encrypted payload                                    |
+------------------------------------------------------------+</pre>
</div>
<figcaption><a class="selfRef" href="#figure-5">Figure 5</a>:
<a class="selfRef" href="#name-coalesced-server-completion">Coalesced Server Completion Datagram Pattern</a>
          </figcaption></figure>
</div>
<p id="section-2.4-18">Similar to Client Completion, Server Completion does not expose additional
information; observing it serves only to determine that the handshake has
completed.<a class="pilcrow" href="#section-2.4-18">Â¶</a></p>
<p id="section-2.4-19">When the client uses 0-RTT data, the Client Initial
flight can also include one or more 0-RTT packets as shown in
<a class="auto internal xref" href="#fig-client-initial-0rtt">Figure 6</a>.<a class="pilcrow" href="#section-2.4-19">Â¶</a></p>
<span id="name-coalesced-0-rtt-client-init"></span><div id="fig-client-initial-0rtt">
<figure id="figure-6">
          <div class="alignLeft art-text artwork" id="section-2.4-20.1">
<pre>+----------------------------------------------------------+
| UDP header (source and destination UDP ports)            |
+----------------------------------------------------------+
| QUIC long header (type = Initial, Version, DCID, SCID) (Length)
+----------------------------------------------------------+  |
| QUIC CRYPTO frame header                                 |  |
+----------------------------------------------------------+  |
| TLS ClientHello (incl. TLS SNI)                          |  |
+----------------------------------------------------------+&lt;-+
| QUIC long header (type = 0-RTT, Version, DCID, SCID)   (Length)
+----------------------------------------------------------+  |
| 0-RTT encrypted payload                                  |  |
+----------------------------------------------------------+&lt;-+</pre>
</div>
<figcaption><a class="selfRef" href="#figure-6">Figure 6</a>:
<a class="selfRef" href="#name-coalesced-0-rtt-client-init">Coalesced 0-RTT Client Initial Datagram</a>
          </figcaption></figure>
</div>
<p id="section-2.4-21">When a 0-RTT packet is coalesced with an Initial packet, the datagram
will be padded to 1200 bytes. Additional datagrams containing only 0-RTT
packets with long headers can be sent after the client Initial packet, which contains more 0-RTT data. The amount of 0-RTT protected data that
can be sent in the first flight is limited by the initial congestion
window, typically to around 10 packets (see <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9002#section-7.2">Section 7.2</a> of [<a class="cite xref" href="#RFC9002">QUIC-RECOVERY</a>]</span>).<a class="pilcrow" href="#section-2.4-21">Â¶</a></p>
</section>
</div>
<div id="wire-integrity">
<section id="section-2.5">
        <h3 id="name-integrity-protection-of-the">
<a class="section-number selfRef" href="#section-2.5">2.5. </a><a class="section-name selfRef" href="#name-integrity-protection-of-the">Integrity Protection of the Wire Image</a>
        </h3>
<p id="section-2.5-1">As soon as the cryptographic context is established, all information in the QUIC
header, including exposed information, is integrity protected. Further,
information that was exposed in packets sent before the cryptographic context
was established is validated during the cryptographic handshake. Therefore,
devices on path cannot alter any information or bits in QUIC packets. Such
alterations would cause the integrity check to fail, which results in the
receiver discarding the packet. Some parts of Initial packets could be altered
by removing and reapplying the authenticated encryption without immediate
discard at the receiver. However, the cryptographic handshake validates most
fields and any modifications in those fields will result in a connection
establishment failure later.<a class="pilcrow" href="#section-2.5-1">Â¶</a></p>
</section>
</div>
<div id="rebinding">
<section id="section-2.6">
        <h3 id="name-connection-id-and-rebinding">
<a class="section-number selfRef" href="#section-2.6">2.6. </a><a class="section-name selfRef" href="#name-connection-id-and-rebinding">Connection ID and Rebinding</a>
        </h3>
<p id="section-2.6-1">The connection ID in the QUIC packet headers allows association of QUIC
packets using information independent of the 5-tuple. This allows
rebinding of a connection after one of the endpoints (usually the
client) has experienced an address change. Further, it can be used by
in-network devices to ensure that related 5-tuple flows are appropriately
balanced together (see <a class="auto internal xref" href="#sec-loadbalancing">Section 4.4</a>).<a class="pilcrow" href="#section-2.6-1">Â¶</a></p>
<p id="section-2.6-2">Client and server each choose a connection ID during the handshake; for
example, a server might request that a client use a connection ID, whereas the
client might choose a zero-length value. Connection IDs for either endpoint may
change during the lifetime of a connection, with the new connection ID being
supplied via encrypted frames (see <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9000#section-5.1">Section 5.1</a> of [<a class="cite xref" href="#RFC9000">QUIC-TRANSPORT</a>]</span>).
Therefore, observing a new connection ID does not necessarily indicate a new
connection.<a class="pilcrow" href="#section-2.6-2">Â¶</a></p>
<p id="section-2.6-3"><span>[<a class="cite xref" href="#I-D.ietf-quic-load-balancers">QUIC-LB</a>]</span> specifies algorithms for
encoding the server mapping in a connection ID in order to share this
information with selected on-path devices such as load balancers. Server
mappings should only be exposed to selected entities. Uncontrolled exposure
would allow linkage of multiple IP addresses to the same host if the server
also supports migration that opens an attack vector on specific servers or
pools. The best way to obscure an encoding is to appear random to any other
observers, which is most rigorously achieved with encryption. As a result,
any attempt to infer information from specific parts of a connection ID is
unlikely to be useful.<a class="pilcrow" href="#section-2.6-3">Â¶</a></p>
</section>
</div>
<div id="packetnumber">
<section id="section-2.7">
        <h3 id="name-packet-numbers">
<a class="section-number selfRef" href="#section-2.7">2.7. </a><a class="section-name selfRef" href="#name-packet-numbers">Packet Numbers</a>
        </h3>
<p id="section-2.7-1">The Packet Number field is always present in the QUIC packet header in version
1; however, it is always encrypted. The encryption key for packet number
protection on Initial packets (which are sent before cryptographic context
establishment) is specific to the QUIC version while packet number protection
on subsequent packets uses secrets derived from the end-to-end cryptographic
context. Packet numbers are therefore not part of the wire image that is visible
to on-path observers.<a class="pilcrow" href="#section-2.7-1">Â¶</a></p>
</section>
</div>
<div id="version">
<section id="section-2.8">
        <h3 id="name-version-negotiation-and-gre">
<a class="section-number selfRef" href="#section-2.8">2.8. </a><a class="section-name selfRef" href="#name-version-negotiation-and-gre">Version Negotiation and Greasing</a>
        </h3>
<p id="section-2.8-1">Version Negotiation packets are used by the server to indicate that a requested
version from the client is not supported (see <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9000#section-6">Section 6</a> of [<a class="cite xref" href="#RFC9000">QUIC-TRANSPORT</a>]</span>).
Version Negotiation packets are not intrinsically protected, but future QUIC
versions could use later encrypted messages to verify that they were authentic.
Therefore, any modification of this list will be detected and may cause the
endpoints to terminate the connection attempt.<a class="pilcrow" href="#section-2.8-1">Â¶</a></p>
<p id="section-2.8-2">Also note that the list of versions in the Version Negotiation packet may
contain reserved versions. This mechanism is used to avoid ossification in the
implementation of the selection mechanism. Further, a client may send an Initial
packet with a reserved version number to trigger version negotiation. In
the Version Negotiation packet, the connection IDs of the client's
Initial packet
are reflected to provide a proof of return-routability. Therefore, changing this
information will also cause the connection to fail.<a class="pilcrow" href="#section-2.8-2">Â¶</a></p>
<p id="section-2.8-3">QUIC is expected to evolve rapidly. Therefore, new versions (both experimental and IETF
standard versions) will be deployed on the Internet more often than with
other commonly deployed Internet and transport-layer protocols. Use
of the Version field for traffic recognition will therefore behave
differently than with these protocols. Using a particular version number
to recognize valid QUIC traffic is likely to persistently miss a fraction of
QUIC flows
and completely fail in the near future. Reliance on the Version field for the purpose of
admission control is also likely to lead to 
unintended failure modes. Admission of QUIC traffic regardless of version
avoids these failure modes, avoids unnecessary deployment delays, and
supports continuous version-based evolution.<a class="pilcrow" href="#section-2.8-3">Â¶</a></p>
</section>
</div>
</section>
</div>
<div id="network-visible-information-about-quic-flows">
<section id="section-3">
      <h2 id="name-network-visible-information">
<a class="section-number selfRef" href="#section-3">3. </a><a class="section-name selfRef" href="#name-network-visible-information">Network-Visible Information about QUIC Flows</a>
      </h2>
<p id="section-3-1">This section addresses the different kinds of observations and inferences that
can be made about QUIC flows by a passive observer in the network based on the
wire image in <a class="auto internal xref" href="#sec-wire-image">Section 2</a>. Here, we assume a bidirectional observer (one
that can see packets in both directions in the sequence in which they are
carried on the wire) unless noted, but typically without access to any keying
information.<a class="pilcrow" href="#section-3-1">Â¶</a></p>
<div id="sec-identifying">
<section id="section-3.1">
        <h3 id="name-identifying-quic-traffic">
<a class="section-number selfRef" href="#section-3.1">3.1. </a><a class="section-name selfRef" href="#name-identifying-quic-traffic">Identifying QUIC Traffic</a>
        </h3>
<p id="section-3.1-1">The QUIC wire image is not specifically designed to be distinguishable
from other UDP traffic by a passive observer in the network. While certain
QUIC applications may be heuristically identifiable on a per-application
basis, there is no general method for distinguishing QUIC traffic from
otherwise unclassifiable UDP traffic on a given link. Therefore, any unrecognized UDP
traffic may be QUIC traffic.<a class="pilcrow" href="#section-3.1-1">Â¶</a></p>
<p id="section-3.1-2">At the time of writing, two application bindings for QUIC have been published
or adopted by the IETF: HTTP/3 <span>[<a class="cite xref" href="#RFC9114">QUIC-HTTP</a>]</span> and DNS over Dedicated QUIC
Connections <span>[<a class="cite xref" href="#RFC9250">RFC9250</a>]</span>. These are both known to have active Internet deployments, so an assumption that all
QUIC traffic is HTTP/3 is not valid. HTTP/3 uses UDP port 443 by
convention but various methods can be used to specify alternate port numbers.
Other applications (e.g., Microsoft's SMB over QUIC) also use UDP port 443 by
default. Therefore, simple assumptions about whether a given flow is using
QUIC (or indeed which application might be using QUIC) based solely upon
a UDP port number may not hold; see <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc7605#section-5">Section 5</a> of [<a class="cite xref" href="#RFC7605">RFC7605</a>]</span>.<a class="pilcrow" href="#section-3.1-2">Â¶</a></p>
<p id="section-3.1-3">While the second-most-significant bit (0x40) of the first octet is set to 1 in
most QUIC packets of the current version (see <a class="auto internal xref" href="#public-header">Section 2.1</a> and <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9000#section-17">Section 17</a> of [<a class="cite xref" href="#RFC9000">QUIC-TRANSPORT</a>]</span>), this method of recognizing QUIC traffic is not reliable.
First, it only provides one bit of information and is prone to collision with
UDP-based protocols other than those considered in <span>[<a class="cite xref" href="#RFC7983">RFC7983</a>]</span>. Second, this
feature of the wire image is not invariant <span>[<a class="cite xref" href="#RFC8999">QUIC-INVARIANTS</a>]</span> and may change in
future versions of the protocol or even be negotiated during the handshake via
the use of an extension <span>[<a class="cite xref" href="#RFC9287">QUIC-GREASE</a>]</span>.<a class="pilcrow" href="#section-3.1-3">Â¶</a></p>
<p id="section-3.1-4">Even though transport parameters transmitted in the client's Initial packet are
observable by the network, they cannot be modified by the network without
causing a connection failure. Further, the reply from the server cannot be
observed, so observers on the network cannot know which parameters are actually
in use.<a class="pilcrow" href="#section-3.1-4">Â¶</a></p>
<div id="identifying-negotiated-version">
<section id="section-3.1.1">
          <h4 id="name-identifying-negotiated-vers">
<a class="section-number selfRef" href="#section-3.1.1">3.1.1. </a><a class="section-name selfRef" href="#name-identifying-negotiated-vers">Identifying Negotiated Version</a>
          </h4>
<p id="section-3.1.1-1">An in-network observer assuming that a set of packets belongs to a QUIC flow
might infer the version number in use by observing the handshake. If the
version number in an Initial packet of the server response is subsequently
seen in a packet from the client, that version has been accepted by both
endpoints to be used for the rest of the connection (see
<span><a class="relref" href="https://datatracker.ietf.org/doc/html/draft-ietf-quic-version-negotiation-10#section-2">Section 2</a> of [<a class="cite xref" href="#I-D.ietf-quic-version-negotiation">QUIC-VERSION-NEGOTIATION</a>]</span>).<a class="pilcrow" href="#section-3.1.1-1">Â¶</a></p>
<p id="section-3.1.1-2">The negotiated version cannot be identified for flows in which a handshake is
not observed, such as in the case of connection migration. However, it might be
possible to associate a flow with a flow for which a version has been
identified; see <a class="auto internal xref" href="#sec-flow-association">Section 3.5</a>.<a class="pilcrow" href="#section-3.1.1-2">Â¶</a></p>
</section>
</div>
<div id="sec-garbage">
<section id="section-3.1.2">
          <h4 id="name-first-packet-identification">
<a class="section-number selfRef" href="#section-3.1.2">3.1.2. </a><a class="section-name selfRef" href="#name-first-packet-identification">First Packet Identification for Garbage Rejection</a>
          </h4>
<p id="section-3.1.2-1">A related question is whether the first packet of a given flow on a port known
to be associated with QUIC is a valid QUIC packet.  This determination supports
in-network filtering of garbage UDP packets (reflection attacks, random
backscatter, etc.). While heuristics based on the first byte of the packet
(packet type) could be used to separate valid from invalid first packet types,
the deployment of such heuristics is not recommended as bits in the first byte
may have different meanings in future versions of the protocol.<a class="pilcrow" href="#section-3.1.2-1">Â¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-confirm">
<section id="section-3.2">
        <h3 id="name-connection-confirmation">
<a class="section-number selfRef" href="#section-3.2">3.2. </a><a class="section-name selfRef" href="#name-connection-confirmation">Connection Confirmation</a>
        </h3>
<p id="section-3.2-1">This document focuses on QUIC version 1, and this Connection Confirmation
section applies only to packets belonging to QUIC version 1 flows; for purposes
of on-path observation, it assumes that these packets have been identified as
such through the observation of a version number exchange as described above.<a class="pilcrow" href="#section-3.2-1">Â¶</a></p>
<p id="section-3.2-2">Connection establishment uses Initial and Handshake packets containing a
TLS handshake and Retry packets that do not contain parts of the handshake.
Connection establishment can therefore be detected using heuristics similar to
those used to detect TLS over TCP. A client initiating a connection may
also send data in 0-RTT packets directly after the Initial
packet containing the TLS ClientHello. Since packets may be reordered or lost
in the network, 0-RTT packets could be seen before the Initial
packet.<a class="pilcrow" href="#section-3.2-2">Â¶</a></p>
<p id="section-3.2-3">Note that in this version of QUIC, clients send Initial packets before servers
do, servers send Handshake packets before clients do, and only clients send
Initial packets with tokens. Therefore, an endpoint can be identified as a
client or server by an on-path observer. An attempted connection after Retry can
be detected by correlating the contents of the Retry packet with the Token and
the Destination Connection ID fields of the new Initial packet.<a class="pilcrow" href="#section-3.2-3">Â¶</a></p>
</section>
</div>
<div id="distinguishing-acknowledgment-traffic">
<section id="section-3.3">
        <h3 id="name-distinguishing-acknowledgme">
<a class="section-number selfRef" href="#section-3.3">3.3. </a><a class="section-name selfRef" href="#name-distinguishing-acknowledgme">Distinguishing Acknowledgment Traffic</a>
        </h3>
<p id="section-3.3-1">Some deployed in-network functions distinguish packets that carry only
acknowledgment (ACK-only) information
from packets carrying upper-layer data in order to attempt to enhance
performance (for example, by queuing ACKs differently or manipulating ACK
signaling <span>[<a class="cite xref" href="#RFC3449">RFC3449</a>]</span>). Distinguishing ACK packets is possible in TCP,
but is not supported by
QUIC since acknowledgment signaling is carried inside QUIC's encrypted payload
and ACK manipulation is impossible. Specifically, heuristics attempting to
distinguish ACK-only packets from payload-carrying packets based on packet size
are likely to fail and are not recommended to use as a way to construe
internals of QUIC's operation as those mechanisms can change, e.g., due to the
use of extensions.<a class="pilcrow" href="#section-3.3-1">Â¶</a></p>
</section>
</div>
<div id="sec-server">
<section id="section-3.4">
        <h3 id="name-server-name-indication-sni">
<a class="section-number selfRef" href="#section-3.4">3.4. </a><a class="section-name selfRef" href="#name-server-name-indication-sni">Server Name Indication (SNI)</a>
        </h3>
<p id="section-3.4-1">The client's TLS ClientHello may contain a Server Name Indication (SNI)
extension <span>[<a class="cite xref" href="#RFC6066">RFC6066</a>]</span> by which the client reveals the name of the server it
intends to connect to in order to allow the server to present a certificate
based on that name. If present, SNI information is available to unidirectional observers
on the client-to-server path if it.<a class="pilcrow" href="#section-3.4-1">Â¶</a></p>
<p id="section-3.4-2">The TLS ClientHello may also contain an Application-Layer Protocol
Negotiation (ALPN) extension <span>[<a class="cite xref" href="#RFC7301">RFC7301</a>]</span>, by which the client exposes the names
of application-layer protocols it supports; an observer can deduce that one of
those protocols will be used if the connection continues.<a class="pilcrow" href="#section-3.4-2">Â¶</a></p>
<p id="section-3.4-3">Work is currently underway in the TLS working group to encrypt the contents of
the ClientHello in TLS 1.3 <span>[<a class="cite xref" href="#I-D.ietf-tls-esni">TLS-ECH</a>]</span>. This would make
SNI-based application identification impossible by on-path observation for QUIC
and other protocols that use TLS.<a class="pilcrow" href="#section-3.4-3">Â¶</a></p>
<div id="extracting-server-name-indication-sni-information">
<section id="section-3.4.1">
          <h4 id="name-extracting-server-name-indi">
<a class="section-number selfRef" href="#section-3.4.1">3.4.1. </a><a class="section-name selfRef" href="#name-extracting-server-name-indi">Extracting Server Name Indication (SNI) Information</a>
          </h4>
<p id="section-3.4.1-1">If the ClientHello is not encrypted, SNI can be derived from the client's
Initial packets by calculating the Initial secret to decrypt the packet
payload and parsing the QUIC CRYPTO frames containing the TLS ClientHello.<a class="pilcrow" href="#section-3.4.1-1">Â¶</a></p>
<p id="section-3.4.1-2">As both the derivation of the Initial secret and the structure of the Initial
packet itself are version specific, the first step is always to parse the
version number (the second through fifth bytes of the long header). Note that
only long header packets carry the version number, so it is necessary to also
check if the first bit of the QUIC packet is set to 1, which indicates a long header.<a class="pilcrow" href="#section-3.4.1-2">Â¶</a></p>
<p id="section-3.4.1-3">Note that proprietary QUIC versions that have been deployed before
standardization might not set the first bit in a QUIC long header packet to
1. However, it is expected that these versions will
gradually disappear over time and therefore do not require any special
consideration or treatment.<a class="pilcrow" href="#section-3.4.1-3">Â¶</a></p>
<p id="section-3.4.1-4">When the version has been identified as QUIC version 1, the packet type needs to
be verified as an Initial packet by checking that the third and fourth bits of
the header are both set to 0. Then, the Destination Connection ID needs to be
extracted from the packet. The Initial secret is calculated using the
version-specific Initial salt as described in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9001#section-5.2">Section 5.2</a> of [<a class="cite xref" href="#RFC9001">QUIC-TLS</a>]</span>.
The length of the connection ID is indicated in the 6th byte of the header
followed by the connection ID itself.<a class="pilcrow" href="#section-3.4.1-4">Â¶</a></p>
<p id="section-3.4.1-5">Note that subsequent Initial packets might contain a Destination Connection ID
other than the one used to generate the Initial secret. Therefore, attempts to
decrypt these packets using the procedure above might fail unless the Initial
secret is retained by the observer.<a class="pilcrow" href="#section-3.4.1-5">Â¶</a></p>
<p id="section-3.4.1-6">To determine the end of the packet header and find the start of the payload,
the Packet Number Length, the Source Connection ID Length, and the Token Length
need to be extracted. The Packet Number Length is defined by the seventh and
eighth bits of the header as described in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9000#section-17.2">Section 17.2</a> of [<a class="cite xref" href="#RFC9000">QUIC-TRANSPORT</a>]</span>,
but is protected as described in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9001#section-5.4">Section 5.4</a> of [<a class="cite xref" href="#RFC9001">QUIC-TLS</a>]</span>. The Source
Connection ID Length is specified in the byte after the Destination
Connection ID. The Token Length, which follows the Source Connection ID, is
a variable-length integer as specified in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9000#section-16">Section 16</a> of [<a class="cite xref" href="#RFC9000">QUIC-TRANSPORT</a>]</span>.<a class="pilcrow" href="#section-3.4.1-6">Â¶</a></p>
<p id="section-3.4.1-7">After decryption, the client's Initial packets can be parsed to detect the
CRYPTO frames that contain the TLS ClientHello, which then can be parsed
similarly to TLS over TCP connections. Note that there can be multiple CRYPTO
frames spread out over one or more Initial packets and they might not be in
order, so reassembling the CRYPTO stream by parsing offsets and lengths is
required. Further, the client's Initial packets may contain other frames,
so the first bytes of each frame need to be checked to identify the frame
type and determine whether the frame can be skipped over. Note that the
length of the frames is dependent on the frame type; see
<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9000#section-18">Section 18</a> of [<a class="cite xref" href="#RFC9000">QUIC-TRANSPORT</a>]</span>.
For example, PADDING frames (each consisting of a single zero byte) may occur before,
after, or between CRYPTO frames. However, extensions might define additional
frame types. If an unknown frame type is encountered, it is impossible to
know the length of that frame, which prevents skipping over it; therefore,
parsing fails.<a class="pilcrow" href="#section-3.4.1-7">Â¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-flow-association">
<section id="section-3.5">
        <h3 id="name-flow-association">
<a class="section-number selfRef" href="#section-3.5">3.5. </a><a class="section-name selfRef" href="#name-flow-association">Flow Association</a>
        </h3>
<p id="section-3.5-1">The QUIC connection ID (see <a class="auto internal xref" href="#rebinding">Section 2.6</a>) is designed to allow a coordinating
on-path device, such as a load balancer, to associate two flows when one of the
endpoints changes address.  This change can be due to NAT rebinding or address
migration.<a class="pilcrow" href="#section-3.5-1">Â¶</a></p>
<p id="section-3.5-2">The connection ID must change upon intentional address change by an endpoint
and connection ID negotiation is encrypted; therefore, it is not possible for a
passive observer to link intended changes of address using the connection ID.<a class="pilcrow" href="#section-3.5-2">Â¶</a></p>
<p id="section-3.5-3">When one endpoint's address unintentionally changes, as is the case with NAT
rebinding, an on-path observer may be able to use the connection ID to
associate the flow on the new address with the flow on the old address.<a class="pilcrow" href="#section-3.5-3">Â¶</a></p>
<p id="section-3.5-4">A network function that attempts to use the connection ID to associate flows
must be robust to the failure of this technique. Since the connection ID may
change multiple times during the lifetime of a connection, packets with the
same 5-tuple but different connection IDs might or might not belong to
the same connection. Likewise, packets with the same connection ID but
different 5-tuples might not belong to the same connection either.<a class="pilcrow" href="#section-3.5-4">Â¶</a></p>
<p id="section-3.5-5">Connection IDs should be treated as opaque; see <a class="auto internal xref" href="#sec-loadbalancing">Section 4.4</a>
for caveats regarding connection ID selection at servers.<a class="pilcrow" href="#section-3.5-5">Â¶</a></p>
</section>
</div>
<div id="sec-teardown">
<section id="section-3.6">
        <h3 id="name-flow-teardown">
<a class="section-number selfRef" href="#section-3.6">3.6. </a><a class="section-name selfRef" href="#name-flow-teardown">Flow Teardown</a>
        </h3>
<p id="section-3.6-1">QUIC does not expose the end of a connection; the only indication to on-path
devices that a flow has ended is that packets are no longer observed. Therefore, stateful
devices on path such as NATs and firewalls must use idle timeouts to
determine when to drop state for QUIC flows; see <a class="auto internal xref" href="#sec-stateful">Section 4.2</a>.<a class="pilcrow" href="#section-3.6-1">Â¶</a></p>
</section>
</div>
<div id="sec-symmetry">
<section id="section-3.7">
        <h3 id="name-flow-symmetry-measurement">
<a class="section-number selfRef" href="#section-3.7">3.7. </a><a class="section-name selfRef" href="#name-flow-symmetry-measurement">Flow Symmetry Measurement</a>
        </h3>
<p id="section-3.7-1">QUIC explicitly exposes which side of a connection is a client and which side is
a server during the handshake. In addition, the symmetry of a flow (whether it is
primarily client-to-server, primarily server-to-client, or roughly
bidirectional, as input to basic traffic classification techniques) can be
inferred through the measurement of data rate in each direction.
Note that QUIC packets containing only control frames (such as
ACK-only packets) may be padded. Padding, though optional,
may conceal connection roles or flow symmetry information.<a class="pilcrow" href="#section-3.7-1">Â¶</a></p>
</section>
</div>
<div id="sec-rtt">
<section id="section-3.8">
        <h3 id="name-round-trip-time-rtt-measure">
<a class="section-number selfRef" href="#section-3.8">3.8. </a><a class="section-name selfRef" href="#name-round-trip-time-rtt-measure">Round-Trip Time (RTT) Measurement</a>
        </h3>
<p id="section-3.8-1">The round-trip time (RTT) of QUIC flows can be inferred
by observation once per flow
during the handshake in passive TCP measurement; this requires parsing of
the QUIC packet header and recognition of the handshake, as illustrated in
<a class="auto internal xref" href="#handshake">Section 2.4</a>. It can also be inferred during the flow's lifetime if the
endpoints use the spin bit facility described below and in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9000#section-17.3.1">Section 17.3.1</a> of [<a class="cite xref" href="#RFC9000">QUIC-TRANSPORT</a>]</span>. RTT measurement is available to unidirectional observers
when the spin bit is enabled.<a class="pilcrow" href="#section-3.8-1">Â¶</a></p>
<div id="measuring-initial-rtt">
<section id="section-3.8.1">
          <h4 id="name-measuring-initial-rtt">
<a class="section-number selfRef" href="#section-3.8.1">3.8.1. </a><a class="section-name selfRef" href="#name-measuring-initial-rtt">Measuring Initial RTT</a>
          </h4>
<p id="section-3.8.1-1">In the common case, the delay between the client's Initial packet (containing
the TLS ClientHello) and the server's Initial packet (containing the TLS
ServerHello) represents the RTT component on the path between the observer and
the server. The delay between the server's first Handshake packet and the
Handshake packet sent by the client represents the RTT component on the path
between the observer and the client. While the client may send 0-RTT packets
after the Initial packet during connection re-establishment, these can be
ignored for RTT measurement purposes.<a class="pilcrow" href="#section-3.8.1-1">Â¶</a></p>
<p id="section-3.8.1-2">Handshake RTT can be measured by adding the client-to-observer and
observer-to-server RTT components together. This measurement necessarily
includes all transport- and application-layer delay at both endpoints.<a class="pilcrow" href="#section-3.8.1-2">Â¶</a></p>
</section>
</div>
<div id="spin-usage">
<section id="section-3.8.2">
          <h4 id="name-using-the-spin-bit-for-pass">
<a class="section-number selfRef" href="#section-3.8.2">3.8.2. </a><a class="section-name selfRef" href="#name-using-the-spin-bit-for-pass">Using the Spin Bit for Passive RTT Measurement</a>
          </h4>
<p id="section-3.8.2-1">The spin bit provides a version-specific method to measure per-flow RTT from
observation points on the network path throughout the duration of a connection.
See <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9000#section-17.4">Section 17.4</a> of [<a class="cite xref" href="#RFC9000">QUIC-TRANSPORT</a>]</span> for the definition of the spin bit in
Version 1 of QUIC. Endpoint participation in spin bit signaling is optional. While its location is fixed in this version of QUIC, an endpoint can
unilaterally choose to not support "spinning" the bit.<a class="pilcrow" href="#section-3.8.2-1">Â¶</a></p>
<p id="section-3.8.2-2">Use of the spin bit for RTT measurement by devices on path is only possible when
both endpoints enable it. Some endpoints may disable use of the spin bit by
default, others only in specific deployment scenarios, e.g., for servers and
clients where the RTT would reveal the presence of a VPN or proxy. To avoid
making these connections identifiable based on the usage of the spin bit, all
endpoints randomly disable "spinning" for at least one eighth of connections,
even if otherwise enabled by default. An endpoint not participating in spin bit
signaling for a given connection can use a fixed spin value for the duration of
the connection or can set the bit randomly on each packet sent.<a class="pilcrow" href="#section-3.8.2-2">Â¶</a></p>
<p id="section-3.8.2-3">When in use, the latency spin bit in each direction changes value once per
RTT any time that both endpoints are sending packets
continuously. An on-path observer can observe the time difference between edges
(changes from 1 to 0 or 0 to 1) in the spin bit signal in a single direction to
measure one sample of end-to-end RTT. This mechanism follows the principles of
protocol measurability laid out in <span>[<a class="cite xref" href="#IPIM">IPIM</a>]</span>.<a class="pilcrow" href="#section-3.8.2-3">Â¶</a></p>
<p id="section-3.8.2-4">Note that this measurement, as with passive RTT measurement for TCP, includes
all transport protocol delay (e.g., delayed sending of acknowledgments) and/or
application layer delay (e.g., waiting for a response to be generated). It
therefore provides devices on path a good instantaneous estimate of the RTT as
experienced by the application.<a class="pilcrow" href="#section-3.8.2-4">Â¶</a></p>
<p id="section-3.8.2-5">However, application-limited and flow-control-limited senders can have
application- and transport-layer delay, respectively, that are much greater than
network RTT. For example, if the sender only sends small 
amounts of application traffic periodically, where the periodicity is longer than the 
RTT, spin bit measurements provide information about the application period rather
than network RTT.<a class="pilcrow" href="#section-3.8.2-5">Â¶</a></p>
<p id="section-3.8.2-6">Since the spin bit logic at each endpoint considers only samples from packets
that advance the largest packet number, signal generation itself is
resistant to reordering. However, reordering can cause problems at an observer
by causing spurious edge detection and therefore inaccurate (i.e., lower) RTT
estimates, if reordering occurs across a spin bit flip in the stream.<a class="pilcrow" href="#section-3.8.2-6">Â¶</a></p>
<p id="section-3.8.2-7">Simple heuristics based on the observed data rate per flow or changes in the RTT
series can be used to reject bad RTT samples due to lost or reordered edges in
the spin signal, as well as application or flow control limitation; for example,
QoF <span>[<a class="cite xref" href="#TMA-QOF">TMA-QOF</a>]</span> rejects component RTTs significantly higher than RTTs over the
history of the flow. These heuristics may use the handshake RTT as an initial
RTT estimate for a given flow. Usually such heuristics would also detect if
the spin is either constant or randomly set for a connection.<a class="pilcrow" href="#section-3.8.2-7">Â¶</a></p>
<p id="section-3.8.2-8">An on-path observer that can see traffic in both directions (from client to
server and from server to client) can also use the spin bit to measure
"upstream" and "downstream" component RTT; i.e, the component of the
end-to-end RTT attributable to the paths between the observer and the server
and between the observer and the client, respectively. It does this by measuring the
delay between a spin edge observed in the upstream direction and that observed
in the downstream direction, and vice versa.<a class="pilcrow" href="#section-3.8.2-8">Â¶</a></p>
<p id="section-3.8.2-9">Raw RTT samples generated using these techniques can be processed in various
ways to generate useful network performance metrics. A simple linear smoothing
or moving minimum filter can be applied to the stream of RTT samples to get a
more stable estimate of application-experienced RTT. RTT samples measured from
the spin bit can also be used to generate RTT distribution information,
including minimum RTT (which approximates network RTT over longer time windows)
and RTT variance (which approximates one-way packet delay variance as seen
by an application end-point).<a class="pilcrow" href="#section-3.8.2-9">Â¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="specific-network-management-tasks">
<section id="section-4">
      <h2 id="name-specific-network-management">
<a class="section-number selfRef" href="#section-4">4. </a><a class="section-name selfRef" href="#name-specific-network-management">Specific Network Management Tasks</a>
      </h2>
<p id="section-4-1">In this section, we review specific network management and measurement
techniques and how QUIC's design impacts them.<a class="pilcrow" href="#section-4-1">Â¶</a></p>
<div id="passive-network-performance-measurement-and-troubleshooting">
<section id="section-4.1">
        <h3 id="name-passive-network-performance">
<a class="section-number selfRef" href="#section-4.1">4.1. </a><a class="section-name selfRef" href="#name-passive-network-performance">Passive Network Performance Measurement and Troubleshooting</a>
        </h3>
<p id="section-4.1-1">Limited RTT measurement is possible by passive observation of QUIC traffic;
see <a class="auto internal xref" href="#sec-rtt">Section 3.8</a>. No passive measurement of loss is possible with the present
wire image. Limited observation of upstream congestion may be
possible via the observation of Congestion Experienced (CE) markings in the
IP header <span>[<a class="cite xref" href="#RFC3168">RFC3168</a>]</span> on ECN-enabled QUIC traffic.<a class="pilcrow" href="#section-4.1-1">Â¶</a></p>
<p id="section-4.1-2">On-path devices can also make measurements of RTT, loss, and other
performance metrics when information is carried in an additional network-layer
packet header (<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9065#section-6">Section 6</a> of [<a class="cite xref" href="#RFC9065">RFC9065</a>]</span> describes the use of Operations,
Administration, and Management (OAM) information).
Using network-layer approaches also has the advantage that common observation
and analysis tools can be consistently used for multiple transport protocols;
however, these techniques are often limited to measurements within one or
multiple cooperating domains.<a class="pilcrow" href="#section-4.1-2">Â¶</a></p>
</section>
</div>
<div id="sec-stateful">
<section id="section-4.2">
        <h3 id="name-stateful-treatment-of-quic-">
<a class="section-number selfRef" href="#section-4.2">4.2. </a><a class="section-name selfRef" href="#name-stateful-treatment-of-quic-">Stateful Treatment of QUIC Traffic</a>
        </h3>
<p id="section-4.2-1">Stateful treatment of QUIC traffic (e.g., at a firewall or NAT middlebox) is
possible through QUIC traffic and version identification (<a class="auto internal xref" href="#sec-identifying">Section 3.1</a>)
and observation of the handshake for connection confirmation (<a class="auto internal xref" href="#sec-confirm">Section 3.2</a>).
The lack of any visible end-of-flow signal (<a class="auto internal xref" href="#sec-teardown">Section 3.6</a>) means that this
state must be purged either through timers or least-recently-used
eviction depending on application requirements.<a class="pilcrow" href="#section-4.2-1">Â¶</a></p>
<p id="section-4.2-2">While QUIC has no clear network-visible end-of-flow signal and therefore
does require timer-based state removal, the QUIC handshake indicates
confirmation by both ends of a valid bidirectional transmission. As soon
as the handshake completed, timers should be set long enough to also
allow for short idle time during a valid transmission.<a class="pilcrow" href="#section-4.2-2">Â¶</a></p>
<p id="section-4.2-3"><span>[<a class="cite xref" href="#RFC4787">RFC4787</a>]</span> requires a network state timeout that is not less than 2 minutes
for most UDP traffic.  However, in practice, a QUIC endpoint can experience
lower timeouts in the range of 30 to 60 seconds <span>[<a class="cite xref" href="#QUIC-TIMEOUT">QUIC-TIMEOUT</a>]</span>.<a class="pilcrow" href="#section-4.2-3">Â¶</a></p>
<p id="section-4.2-4">In contrast, <span>[<a class="cite xref" href="#RFC5382">RFC5382</a>]</span> recommends a state timeout of more than 2
hours for TCP given that TCP is a connection-oriented protocol with
well-defined closure semantics.
Even though QUIC has explicitly been designed to tolerate NAT rebindings,
decreasing the NAT timeout is not recommended as it may negatively impact
application performance or incentivize endpoints to send very frequent
keep-alive packets.<a class="pilcrow" href="#section-4.2-4">Â¶</a></p>
<p id="section-4.2-5">Therefore, 
a state timeout of at least two minutes is recommended for 
QUIC traffic, even when lower state timeouts 
are used for other UDP traffic.<a class="pilcrow" href="#section-4.2-5">Â¶</a></p>
<p id="section-4.2-6">If state is removed too early, this could lead to black-holing of incoming
packets after a short idle period. To detect this situation, a timer at the
client needs to expire before a re-establishment can happen (if at all), which
would lead to unnecessarily long delays in an otherwise working connection.<a class="pilcrow" href="#section-4.2-6">Â¶</a></p>
<p id="section-4.2-7">Furthermore, not all endpoints use routing architectures where connections
will survive a port or address change. Even when the client revives the
connection, a NAT rebinding can cause a routing mismatch where a packet
is not even delivered to the server that might support address migration.
For these reasons, the limits in <span>[<a class="cite xref" href="#RFC4787">RFC4787</a>]</span> are important to avoid
black-holing of packets (and hence avoid interrupting the flow of data to the
client), especially where devices are able to distinguish QUIC traffic from
other UDP payloads.<a class="pilcrow" href="#section-4.2-7">Â¶</a></p>
<p id="section-4.2-8">The QUIC header optionally contains a connection ID, which could provide
additional entropy beyond the 5-tuple. The QUIC handshake needs
to be observed in order to understand whether the connection ID is present and
what length it has. However, connection IDs may be renegotiated
after the handshake, and this renegotiation is not visible to the path.
Therefore, using the connection ID as a flow key field for stateful treatment
of flows is not recommended as connection ID changes will cause undetectable
and unrecoverable loss of state in the middle of a connection. In particular,
the use of the connection ID for functions that require state to make a
forwarding decision is not viable as it will break connectivity, or at minimum,
cause long timeout-based delays before this problem is detected by the
endpoints and the connection can potentially be re-established.<a class="pilcrow" href="#section-4.2-8">Â¶</a></p>
<p id="section-4.2-9">Use of connection IDs is specifically discouraged for NAT applications.
If a NAT hits an operational limit, it is recommended to rather drop the
initial packets of a flow (see also <a class="auto internal xref" href="#sec-filtering">Section 4.5</a>),
which potentially triggers TCP fallback. Use of the connection ID to
multiplex multiple connections on the same IP address/port pair is not a
viable solution as it risks connectivity breakage in case the connection
ID changes.<a class="pilcrow" href="#section-4.2-9">Â¶</a></p>
</section>
</div>
<div id="address-rewriting-to-ensure-routing-stability">
<section id="section-4.3">
        <h3 id="name-address-rewriting-to-ensure">
<a class="section-number selfRef" href="#section-4.3">4.3. </a><a class="section-name selfRef" href="#name-address-rewriting-to-ensure">Address Rewriting to Ensure Routing Stability</a>
        </h3>
<p id="section-4.3-1">While QUIC's migration capability makes it possible for a connection to survive
client address changes, this does not work if the routers or switches in the
server infrastructure route using the address-port 4-tuple. If infrastructure
routes on addresses only, NAT rebinding or address migration will cause packets
to be delivered to the wrong server. <span>[<a class="cite xref" href="#I-D.ietf-quic-load-balancers">QUIC-LB</a>]</span> describes a way to addresses
this problem by coordinating the selection and use of connection IDs between
load balancers and servers.<a class="pilcrow" href="#section-4.3-1">Â¶</a></p>
<p id="section-4.3-2">Applying address translation at a middlebox to maintain a stable
address-port mapping for flows based on connection ID might seem like a solution to this problem. However, hiding information about the
change of the IP address or port conceals important and security-relevant
information from QUIC endpoints, and as such, would facilitate amplification
attacks (see <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9000#section-8">Section 8</a> of [<a class="cite xref" href="#RFC9000">QUIC-TRANSPORT</a>]</span>). A NAT function that hides
peer address changes prevents the other end from
detecting and mitigating attacks as the endpoint cannot verify connectivity
to the new address using QUIC PATH_CHALLENGE and PATH_RESPONSE frames.<a class="pilcrow" href="#section-4.3-2">Â¶</a></p>
<p id="section-4.3-3">In addition, a change of IP address or port is also an input signal to other
internal mechanisms in QUIC. When a path change is detected, path-dependent
variables like congestion control parameters will be reset, which protects
the new path from overload.<a class="pilcrow" href="#section-4.3-3">Â¶</a></p>
</section>
</div>
<div id="sec-loadbalancing">
<section id="section-4.4">
        <h3 id="name-server-cooperation-with-loa">
<a class="section-number selfRef" href="#section-4.4">4.4. </a><a class="section-name selfRef" href="#name-server-cooperation-with-loa">Server Cooperation with Load Balancers</a>
        </h3>
<p id="section-4.4-1">In the case of networking architectures that include load balancers,
the connection ID can be used as a way for the server to signal information
about the desired treatment of a flow to the load balancers. Guidance on
assigning connection IDs is given in
<span>[<a class="cite xref" href="#RFC9308">QUIC-APPLICABILITY</a>]</span>. <span>[<a class="cite xref" href="#I-D.ietf-quic-load-balancers">QUIC-LB</a>]</span>
describes a system for coordinating selection and use of connection IDs between
load balancers and servers.<a class="pilcrow" href="#section-4.4-1">Â¶</a></p>
</section>
</div>
<div id="sec-filtering">
<section id="section-4.5">
        <h3 id="name-filtering-behavior">
<a class="section-number selfRef" href="#section-4.5">4.5. </a><a class="section-name selfRef" href="#name-filtering-behavior">Filtering Behavior</a>
        </h3>
<p id="section-4.5-1"><span>[<a class="cite xref" href="#RFC4787">RFC4787</a>]</span> describes
        possible packet-filtering behaviors that relate to NATs but are often
        also used in other scenarios where packet filtering is desired.
        Though the guidance there holds, a particularly unwise behavior admits
        a handful of UDP packets and then makes a decision to whether or not
        filter later packets in the same connection.  QUIC applications are
        encouraged to fall back to TCP if early packets do not arrive at their
        destination <span>[<a class="cite xref" href="#RFC9308">QUIC-APPLICABILITY</a>]</span>, as QUIC is
        based on UDP and there are known blocks of UDP traffic (see <a class="auto internal xref" href="#sec-udp-1312">Section 4.6</a>).  Admitting a few packets allows the QUIC
        endpoint to determine that the path accepts QUIC. Sudden drops
        afterwards will result in slow and costly timeouts before abandoning
        the connection.<a class="pilcrow" href="#section-4.5-1">Â¶</a></p>
</section>
</div>
<div id="sec-udp-1312">
<section id="section-4.6">
        <h3 id="name-udp-blocking-throttling-and">
<a class="section-number selfRef" href="#section-4.6">4.6. </a><a class="section-name selfRef" href="#name-udp-blocking-throttling-and">UDP Blocking, Throttling, and NAT Binding</a>
        </h3>
<p id="section-4.6-1">Today, UDP is the most prevalent DDoS vector, since it is easy for compromised
non-admin applications to send a flood of large UDP packets (while with TCP the
attacker gets throttled by the congestion controller) or to craft reflection and
amplification attacks; therefore, some networks block UDP traffic.
With increased deployment of QUIC, there is also an increased need to allow
UDP traffic on ports used for QUIC. However, if UDP is generally enabled on
these ports, UDP flood attacks may also use the same ports. One possible
response to this threat is to throttle UDP traffic on the network, allocating a
fixed portion of the network capacity to UDP and blocking UDP datagrams over
that cap. As the portion of QUIC traffic compared to TCP is also expected to
increase over time, using such a limit is not recommended; if this is done,
limits might need to be adapted dynamically.<a class="pilcrow" href="#section-4.6-1">Â¶</a></p>
<p id="section-4.6-2">Further, if UDP traffic is desired to be throttled, it is recommended to
block individual
QUIC flows entirely rather than dropping packets indiscriminately.
When the handshake is blocked, QUIC-capable applications may fall back
to TCP. However, blocking a random fraction of QUIC packets across
4-tuples will allow many QUIC handshakes to complete, preventing TCP fallback, but
these connections will suffer from
severe packet loss (see also <a class="auto internal xref" href="#sec-filtering">Section 4.5</a>). Therefore, UDP throttling
should be realized by per-flow policing as opposed to per-packet
policing. Note that this per-flow policing should be stateless to avoid
problems with stateful treatment of QUIC flows (see <a class="auto internal xref" href="#sec-stateful">Section 4.2</a>),
for example, blocking a portion of the space of values of a hash function
over the addresses and ports in the UDP datagram.
While QUIC endpoints are often able to survive address changes, e.g., by NAT
rebindings, blocking a portion of the traffic based on 5-tuple hashing increases
the risk of black-holing an active connection when the address changes.<a class="pilcrow" href="#section-4.6-2">Â¶</a></p>
<p id="section-4.6-3">Note that some source ports are assumed to be reflection attack vectors by some
servers; see <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9308#section-8.1">Section 8.1</a> of [<a class="cite xref" href="#RFC9308">QUIC-APPLICABILITY</a>]</span>. As a result, NAT
binding to these source ports can result in that traffic being blocked.<a class="pilcrow" href="#section-4.6-3">Â¶</a></p>
</section>
</div>
<div id="sec-ddos-dec">
<section id="section-4.7">
        <h3 id="name-ddos-detection-and-mitigati">
<a class="section-number selfRef" href="#section-4.7">4.7. </a><a class="section-name selfRef" href="#name-ddos-detection-and-mitigati">DDoS Detection and Mitigation</a>
        </h3>
<p id="section-4.7-1">On-path observation of the transport headers of packets can be used for various
security functions. For example, Denial of Service (DoS) and Distributed DoS
(DDoS) attacks against the infrastructure or against an endpoint can be
detected and mitigated by characterizing anomalous traffic.
Other uses include support for security audits (e.g., verifying the
compliance with cipher suites), client and application fingerprinting for
inventory, and providing alerts for network intrusion detection and other
next-generation firewall functions.<a class="pilcrow" href="#section-4.7-1">Â¶</a></p>
<p id="section-4.7-2">Current practices in detection and mitigation of DDoS
attacks generally involve classification of incoming traffic (as
packets, flows, or some other aggregate) into "good" (productive) and "bad"
(DDoS) traffic, and then differential treatment of this traffic to forward only
good traffic. This operation is often done in a separate specialized mitigation
environment through which all traffic is filtered; a generalized architecture
for separation of concerns in mitigation is given in
<span>[<a class="cite xref" href="#RFC8811">DOTS-ARCH</a>]</span>.<a class="pilcrow" href="#section-4.7-2">Â¶</a></p>
<p id="section-4.7-3">Efficient classification of this DDoS traffic in the mitigation environment
is key to the success of this approach. Limited first packet garbage detection
as in <a class="auto internal xref" href="#sec-garbage">Section 3.1.2</a> and stateful tracking of QUIC traffic as mentioned in
<a class="auto internal xref" href="#sec-stateful">Section 4.2</a> above may be useful during classification.<a class="pilcrow" href="#section-4.7-3">Â¶</a></p>
<p id="section-4.7-4">Note that using a connection ID to support connection migration renders
5-tuple-based filtering insufficient to detect active flows and requires more
state to be maintained by DDoS defense systems if support of migration of QUIC
flows is desired. For the common case of NAT rebinding, where the client's
address changes without the client's intent or knowledge, DDoS defense systems
can detect a change in the client's endpoint address by linking flows based on
the server's connection IDs. However, QUIC's linkability resistance ensures that
a deliberate connection migration is accompanied by a change in the connection
ID. In this case, the connection ID cannot be used to distinguish valid, active
traffic from new attack traffic.<a class="pilcrow" href="#section-4.7-4">Â¶</a></p>
<p id="section-4.7-5">It is also possible for
endpoints to directly support security functions such as DoS
classification and mitigation.
Endpoints can cooperate with an in-network device directly by e.g.,
sharing information about connection IDs.<a class="pilcrow" href="#section-4.7-5">Â¶</a></p>
<p id="section-4.7-6">Another potential method could use an
on-path network device that relies on pattern inferences in the traffic and
heuristics or machine learning instead of processing observed header
information.<a class="pilcrow" href="#section-4.7-6">Â¶</a></p>
<p id="section-4.7-7">However, it is questionable whether connection migrations must be supported
during a DDoS attack. While unintended migration without a connection ID
change can be supported much easier, it might be acceptable to not
support migrations of active QUIC connections that are not visible to
the network functions performing the DDoS detection.
As soon as the connection blocking is detected by the client,
the client may be able to rely on the 0-RTT data mechanism
provided by QUIC. When clients migrate to a new path, they should be prepared
for the migration to fail and attempt to reconnect quickly.<a class="pilcrow" href="#section-4.7-7">Â¶</a></p>
<p id="section-4.7-8">Beyond in-network DDoS protection mechanisms, TCP SYN cookies <span>[<a class="cite xref" href="#RFC4987">RFC4987</a>]</span>
are a well-established method of mitigating some
kinds of TCP DDoS attacks. QUIC Retry packets are the functional analogue to
SYN cookies, forcing clients to prove possession of their IP address before
committing server state.  However, there are safeguards in QUIC against
unsolicited injection of these packets by intermediaries who do not have consent
of the end server. See <span>[<a class="cite xref" href="#I-D.ietf-quic-retry-offload">QUIC-RETRY</a>]</span> for standard
ways for intermediaries to send Retry packets on behalf of consenting servers.<a class="pilcrow" href="#section-4.7-8">Â¶</a></p>
</section>
</div>
<div id="quality-of-service-handling-and-ecmp-routing">
<section id="section-4.8">
        <h3 id="name-quality-of-service-handling">
<a class="section-number selfRef" href="#section-4.8">4.8. </a><a class="section-name selfRef" href="#name-quality-of-service-handling">Quality of Service Handling and ECMP Routing</a>
        </h3>
<p id="section-4.8-1">It is expected that any QoS handling in the network, e.g., based on use of
Diffserv Code Points (DSCPs) <span>[<a class="cite xref" href="#RFC2475">RFC2475</a>]</span> as well as Equal-Cost
Multi-Path (ECMP) routing, is applied on a per-flow basis (and not per-packet)
and as such that all packets belonging to the same active QUIC connection
get uniform treatment.<a class="pilcrow" href="#section-4.8-1">Â¶</a></p>
<p id="section-4.8-2">Using ECMP to distribute packets from a single flow across multiple
network paths or any other nonuniform treatment of packets belong to the same
connection could result in variations in order, delivery rate, and drop rate.
As feedback about loss or delay of each packet is used as input to
the congestion controller, these variations could adversely affect performance.
Depending on the loss recovery mechanism that is implemented, QUIC may be
more tolerant of packet reordering than typical TCP traffic (see
<a class="auto internal xref" href="#packetnumber">Section 2.7</a>). However, the recovery mechanism used by a flow cannot be
known by the network and therefore reordering tolerance should be
considered as unknown.<a class="pilcrow" href="#section-4.8-2">Â¶</a></p>
<p id="section-4.8-3">Note that the 5-tuple of a QUIC connection can change due to migration.
In this case different flows are observed by the path and may be treated
differently, as congestion control is usually reset on migration (see also
<a class="auto internal xref" href="#sec-flow-association">Section 3.5</a>).<a class="pilcrow" href="#section-4.8-3">Â¶</a></p>
</section>
</div>
<div id="handling-icmp-messages">
<section id="section-4.9">
        <h3 id="name-handling-icmp-messages">
<a class="section-number selfRef" href="#section-4.9">4.9. </a><a class="section-name selfRef" href="#name-handling-icmp-messages">Handling ICMP Messages</a>
        </h3>
<p id="section-4.9-1">Datagram Packetization Layer PMTU Discovery (DPLPMTUD) can be used by QUIC to
probe for the supported PMTU. DPLPMTUD optionally uses ICMP messages (e.g.,
IPv6 Packet Too Big (PTB) messages). Given known attacks with the use of ICMP
messages, the use of DPLPMTUD in QUIC has been designed to safely use but
not rely on receiving ICMP feedback (see
<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9000#section-14.2.1">Section 14.2.1</a> of [<a class="cite xref" href="#RFC9000">QUIC-TRANSPORT</a>]</span>).<a class="pilcrow" href="#section-4.9-1">Â¶</a></p>
<p id="section-4.9-2">Networks are recommended to forward these ICMP messages and retain as much of
the original packet as possible without exceeding the minimum MTU for the IP
version when generating ICMP messages as recommended in <span>[<a class="cite xref" href="#RFC1812">RFC1812</a>]</span>
and <span>[<a class="cite xref" href="#RFC4443">RFC4443</a>]</span>.<a class="pilcrow" href="#section-4.9-2">Â¶</a></p>
</section>
</div>
<div id="guiding-path-mtu">
<section id="section-4.10">
        <h3 id="name-guiding-path-mtu">
<a class="section-number selfRef" href="#section-4.10">4.10. </a><a class="section-name selfRef" href="#name-guiding-path-mtu">Guiding Path MTU</a>
        </h3>
<p id="section-4.10-1">Some network segments support 1500-byte packets,
but can only do so by fragmenting at a
lower layer before traversing a network segment with a smaller MTU,
and then reassembling within the network segment.
This is permissible even when the IP layer is IPv6 or IPv4 with the Don't Fragment (DF) bit set,
because fragmentation occurs below the IP layer.
However, this process can add to compute
and memory costs, leading to a bottleneck that limits network capacity. In such
networks, this generates a desire to influence a majority of senders to use
smaller packets to avoid exceeding limited reassembly capacity.<a class="pilcrow" href="#section-4.10-1">Â¶</a></p>
<p id="section-4.10-2">For TCP, Maximum Segment Size (MSS) clamping (<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc4459#section-3.2">Section 3.2</a> of [<a class="cite xref" href="#RFC4459">RFC4459</a>]</span>) is often used to change
the sender's TCP maximum segment size, but QUIC requires a different approach.
<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9000#section-14">Section 14</a> of [<a class="cite xref" href="#RFC9000">QUIC-TRANSPORT</a>]</span> advises senders to probe larger sizes using DPLPMTUD <span>[<a class="cite xref" href="#RFC8899">DPLPMTUD</a>]</span> or Path
Maximum Transmission Unit Discovery (PMTUD) <span>[<a class="cite xref" href="#RFC1191">RFC1191</a>]</span> <span>[<a class="cite xref" href="#RFC8201">RFC8201</a>]</span>.
This mechanism encourages senders to approach the maximum packet size, which
could then cause fragmentation within a network segment of which
they may not be aware.<a class="pilcrow" href="#section-4.10-2">Â¶</a></p>
<p id="section-4.10-3">If path performance is limited when forwarding larger packets, an on-path
device should support a maximum packet size for a specific transport flow
and then consistently drop all packets that exceed the configured size
when the inner IPv4 packet has DF set or IPv6 is used.<a class="pilcrow" href="#section-4.10-3">Â¶</a></p>
<p id="section-4.10-4">Networks with configurations that would lead to fragmentation of large
packets within a network segment should drop such packets rather than
fragmenting them. Network operators who plan to implement a more
selective policy may start by focusing on QUIC.<a class="pilcrow" href="#section-4.10-4">Â¶</a></p>
<p id="section-4.10-5">QUIC flows cannot always be easily distinguished from other UDP traffic, but
we assume at least some portion of QUIC traffic can be identified
(see <a class="auto internal xref" href="#sec-identifying">Section 3.1</a>). For networks supporting QUIC, it is recommended
that a path drops any packet larger than the fragmentation size.
When a QUIC endpoint uses DPLPMTUD, it will use a QUIC probe packet to
discover the PMTU. If this probe is lost, it will not impact the flow of
QUIC data.<a class="pilcrow" href="#section-4.10-5">Â¶</a></p>
<p id="section-4.10-6">IPv4 routers generate an ICMP message when a packet is dropped because the
link MTU was exceeded. <span>[<a class="cite xref" href="#RFC8504">RFC8504</a>]</span> specifies how an IPv6 node generates an
ICMPv6 PTB in this case. PMTUD relies upon an
endpoint receiving such PTB messages <span>[<a class="cite xref" href="#RFC8201">RFC8201</a>]</span>, whereas DPLPMTUD does not
reply upon these messages, but can still optionally use these to improve
performance <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8899#section-4.6">Section 4.6</a> of [<a class="cite xref" href="#RFC8899">DPLPMTUD</a>]</span>.<a class="pilcrow" href="#section-4.10-6">Â¶</a></p>
<p id="section-4.10-7">A network cannot know in advance which discovery method is used by a QUIC
endpoint, so it should send a PTB message in addition to dropping an
oversized packet. A generated PTB message should be compliant with the
validation requirements of <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9000#section-14.2.1">Section 14.2.1</a> of [<a class="cite xref" href="#RFC9000">QUIC-TRANSPORT</a>]</span>, otherwise
it will be ignored for PMTU discovery. This provides a signal to the
endpoint to prevent the packet size from growing too large, which can
entirely avoid network segment fragmentation for that flow.<a class="pilcrow" href="#section-4.10-7">Â¶</a></p>
<p id="section-4.10-8">Endpoints can cache PMTU information in the IP-layer cache. This short-term
consistency between the PMTU for flows can help avoid an endpoint using a
PMTU that is inefficient. The IP cache can also influence the PMTU value of
other IP flows that use the same path <span>[<a class="cite xref" href="#RFC8201">RFC8201</a>]</span> <span>[<a class="cite xref" href="#RFC8899">DPLPMTUD</a>]</span>,
including IP packets carrying
protocols other than QUIC. The representation of an IP path is
implementation specific <span>[<a class="cite xref" href="#RFC8201">RFC8201</a>]</span>.<a class="pilcrow" href="#section-4.10-8">Â¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-5">
      <h2 id="name-iana-considerations">
<a class="section-number selfRef" href="#section-5">5. </a><a class="section-name selfRef" href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<p id="section-5-1">This document has no actions for IANA.<a class="pilcrow" href="#section-5-1">Â¶</a></p>
</section>
</div>
<div id="security-considerations">
<section id="section-6">
      <h2 id="name-security-considerations">
<a class="section-number selfRef" href="#section-6">6. </a><a class="section-name selfRef" href="#name-security-considerations">Security Considerations</a>
      </h2>
<p id="section-6-1">QUIC is an encrypted and authenticated transport. That means once the
cryptographic handshake is complete, QUIC endpoints discard most packets that
are not authenticated, greatly limiting the ability of an attacker to interfere
with existing connections.<a class="pilcrow" href="#section-6-1">Â¶</a></p>
<p id="section-6-2">However, some information is still observable as supporting manageability of
QUIC traffic inherently involves trade-offs with the confidentiality of QUIC's
control information; this entire document is therefore security-relevant.<a class="pilcrow" href="#section-6-2">Â¶</a></p>
<p id="section-6-3">More security considerations for QUIC are discussed in <span>[<a class="cite xref" href="#RFC9000">QUIC-TRANSPORT</a>]</span>
and <span>[<a class="cite xref" href="#RFC9001">QUIC-TLS</a>]</span>, which generally consider active or passive attackers in the
network as well as attacks on specific QUIC mechanism.<a class="pilcrow" href="#section-6-3">Â¶</a></p>
<p id="section-6-4">Version Negotiation packets do not contain any mechanism to prevent version
downgrade attacks. However, future versions of QUIC that use Version Negotiation
packets are required to define a mechanism that is robust against version
downgrade attacks. Therefore, a network node should not attempt to impact
version selection, as version downgrade may result in connection failure.<a class="pilcrow" href="#section-6-4">Â¶</a></p>
</section>
</div>
<section id="section-7">
      <h2 id="name-references">
<a class="section-number selfRef" href="#section-7">7. </a><a class="section-name selfRef" href="#name-references">References</a>
      </h2>
<section id="section-7.1">
        <h3 id="name-normative-references">
<a class="section-number selfRef" href="#section-7.1">7.1. </a><a class="section-name selfRef" href="#name-normative-references">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC9001">[QUIC-TLS]</dt>
        <dd>
<span class="refAuthor">Thomson, M., Ed.</span> and <span class="refAuthor">S. Turner, Ed.</span>, <span class="refTitle">"Using TLS to Secure QUIC"</span>, <span class="seriesInfo">RFC 9001</span>, <span class="seriesInfo">DOI 10.17487/RFC9001</span>, <time class="refDate" datetime="2021-05">May 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9001">https://www.rfc-editor.org/info/rfc9001</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9000">[QUIC-TRANSPORT]</dt>
      <dd>
<span class="refAuthor">Iyengar, J., Ed.</span> and <span class="refAuthor">M. Thomson, Ed.</span>, <span class="refTitle">"QUIC: A UDP-Based Multiplexed and Secure Transport"</span>, <span class="seriesInfo">RFC 9000</span>, <span class="seriesInfo">DOI 10.17487/RFC9000</span>, <time class="refDate" datetime="2021-05">May 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9000">https://www.rfc-editor.org/info/rfc9000</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-7.2">
        <h3 id="name-informative-references">
<a class="section-number selfRef" href="#section-7.2">7.2. </a><a class="section-name selfRef" href="#name-informative-references">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC8811">[DOTS-ARCH]</dt>
        <dd>
<span class="refAuthor">Mortensen, A., Ed.</span>, <span class="refAuthor">Reddy.K, T., Ed.</span>, <span class="refAuthor">Andreasen, F.</span>, <span class="refAuthor">Teague, N.</span>, and <span class="refAuthor">R. Compton</span>, <span class="refTitle">"DDoS Open Threat Signaling (DOTS) Architecture"</span>, <span class="seriesInfo">RFC 8811</span>, <span class="seriesInfo">DOI 10.17487/RFC8811</span>, <time class="refDate" datetime="2020-08">August 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8811">https://www.rfc-editor.org/info/rfc8811</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8899">[DPLPMTUD]</dt>
        <dd>
<span class="refAuthor">Fairhurst, G.</span>, <span class="refAuthor">Jones, T.</span>, <span class="refAuthor">TÃ¼xen, M.</span>, <span class="refAuthor">RÃ¼ngeler, I.</span>, and <span class="refAuthor">T. VÃ¶lker</span>, <span class="refTitle">"Packetization Layer Path MTU Discovery for Datagram Transports"</span>, <span class="seriesInfo">RFC 8899</span>, <span class="seriesInfo">DOI 10.17487/RFC8899</span>, <time class="refDate" datetime="2020-09">September 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8899">https://www.rfc-editor.org/info/rfc8899</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IPIM">[IPIM]</dt>
        <dd>
<span class="refAuthor">Allman, M.</span>, <span class="refAuthor">Beverly, R.</span>, and <span class="refAuthor">B. Trammell</span>, <span class="refTitle">"Principles for Measurability in Protocol Design"</span>, <time class="refDate" datetime="2016-12-09">9 December 2016</time>, <span>&lt;<a href="https://arxiv.org/abs/1612.02902">https://arxiv.org/abs/1612.02902</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9308">[QUIC-APPLICABILITY]</dt>
        <dd>
<span class="refAuthor">KÃ¼hlewind, M.</span> and <span class="refAuthor">B. Trammell</span>, <span class="refTitle">"Applicability of the QUIC Transport Protocol"</span>, <span class="seriesInfo">RFC 9308</span>, <span class="seriesInfo">DOI 10.17487/RFC9308</span>, <time class="refDate" datetime="2022-09">September 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9308">https://www.rfc-editor.org/info/rfc9308</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9287">[QUIC-GREASE]</dt>
        <dd>
<span class="refAuthor">Thomson, M.</span>, <span class="refTitle">"Greasing the QUIC Bit"</span>, <span class="seriesInfo">RFC 9287</span>, <span class="seriesInfo">DOI 10.17487/RFC9287</span>, <time class="refDate" datetime="2022-08">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9287">https://www.rfc-editor.org/info/rfc9287</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9114">[QUIC-HTTP]</dt>
        <dd>
<span class="refAuthor">Bishop, M., Ed.</span>, <span class="refTitle">"HTTP/3"</span>, <span class="seriesInfo">RFC 9114</span>, <span class="seriesInfo">DOI 10.17487/RFC9114</span>, <time class="refDate" datetime="2022-06">June 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9114">https://www.rfc-editor.org/info/rfc9114</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8999">[QUIC-INVARIANTS]</dt>
        <dd>
<span class="refAuthor">Thomson, M.</span>, <span class="refTitle">"Version-Independent Properties of QUIC"</span>, <span class="seriesInfo">RFC 8999</span>, <span class="seriesInfo">DOI 10.17487/RFC8999</span>, <time class="refDate" datetime="2021-05">May 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8999">https://www.rfc-editor.org/info/rfc8999</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-quic-load-balancers">[QUIC-LB]</dt>
        <dd>
<span class="refAuthor">Duke, M.</span>, <span class="refAuthor">Banks, N.</span>, and <span class="refAuthor">C. Huitema</span>, <span class="refTitle">"QUIC-LB: Generating Routable QUIC Connection IDs"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-quic-load-balancers-14</span>, <time class="refDate" datetime="2022-07-11">11 July 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-quic-load-balancers-14">https://datatracker.ietf.org/doc/html/draft-ietf-quic-load-balancers-14</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9002">[QUIC-RECOVERY]</dt>
        <dd>
<span class="refAuthor">Iyengar, J., Ed.</span> and <span class="refAuthor">I. Swett, Ed.</span>, <span class="refTitle">"QUIC Loss Detection and Congestion Control"</span>, <span class="seriesInfo">RFC 9002</span>, <span class="seriesInfo">DOI 10.17487/RFC9002</span>, <time class="refDate" datetime="2021-05">May 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9002">https://www.rfc-editor.org/info/rfc9002</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-quic-retry-offload">[QUIC-RETRY]</dt>
        <dd>
<span class="refAuthor">Duke, M.</span> and <span class="refAuthor">N. Banks</span>, <span class="refTitle">"QUIC Retry Offload"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-quic-retry-offload-00</span>, <time class="refDate" datetime="2022-05-25">25 May 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-quic-retry-offload-00">https://datatracker.ietf.org/doc/html/draft-ietf-quic-retry-offload-00</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="QUIC-TIMEOUT">[QUIC-TIMEOUT]</dt>
        <dd>
<span class="refAuthor">Roskind, J.</span>, <span class="refTitle">"QUIC"</span>, <span class="refContent">IETF-88 TSV Area Presentation</span>, <time class="refDate" datetime="2013-11-07">7 November 2013</time>, <span>&lt;<a href="https://www.ietf.org/proceedings/88/slides/slides-88-tsvarea-10.pdf">https://www.ietf.org/proceedings/88/slides/slides-88-tsvarea-10.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-quic-version-negotiation">[QUIC-VERSION-NEGOTIATION]</dt>
        <dd>
<span class="refAuthor">Schinazi, D.</span> and <span class="refAuthor">E. Rescorla</span>, <span class="refTitle">"Compatible Version Negotiation for QUIC"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-quic-version-negotiation-10</span>, <time class="refDate" datetime="2022-09-27">27 September 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-quic-version-negotiation-10">https://datatracker.ietf.org/doc/html/draft-ietf-quic-version-negotiation-10</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1191">[RFC1191]</dt>
        <dd>
<span class="refAuthor">Mogul, J.</span> and <span class="refAuthor">S. Deering</span>, <span class="refTitle">"Path MTU discovery"</span>, <span class="seriesInfo">RFC 1191</span>, <span class="seriesInfo">DOI 10.17487/RFC1191</span>, <time class="refDate" datetime="1990-11">November 1990</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1191">https://www.rfc-editor.org/info/rfc1191</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1812">[RFC1812]</dt>
        <dd>
<span class="refAuthor">Baker, F., Ed.</span>, <span class="refTitle">"Requirements for IP Version 4 Routers"</span>, <span class="seriesInfo">RFC 1812</span>, <span class="seriesInfo">DOI 10.17487/RFC1812</span>, <time class="refDate" datetime="1995-06">June 1995</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1812">https://www.rfc-editor.org/info/rfc1812</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2475">[RFC2475]</dt>
        <dd>
<span class="refAuthor">Blake, S.</span>, <span class="refAuthor">Black, D.</span>, <span class="refAuthor">Carlson, M.</span>, <span class="refAuthor">Davies, E.</span>, <span class="refAuthor">Wang, Z.</span>, and <span class="refAuthor">W. Weiss</span>, <span class="refTitle">"An Architecture for Differentiated Services"</span>, <span class="seriesInfo">RFC 2475</span>, <span class="seriesInfo">DOI 10.17487/RFC2475</span>, <time class="refDate" datetime="1998-12">December 1998</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2475">https://www.rfc-editor.org/info/rfc2475</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3168">[RFC3168]</dt>
        <dd>
<span class="refAuthor">Ramakrishnan, K.</span>, <span class="refAuthor">Floyd, S.</span>, and <span class="refAuthor">D. Black</span>, <span class="refTitle">"The Addition of Explicit Congestion Notification (ECN) to IP"</span>, <span class="seriesInfo">RFC 3168</span>, <span class="seriesInfo">DOI 10.17487/RFC3168</span>, <time class="refDate" datetime="2001-09">September 2001</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3168">https://www.rfc-editor.org/info/rfc3168</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3449">[RFC3449]</dt>
        <dd>
<span class="refAuthor">Balakrishnan, H.</span>, <span class="refAuthor">Padmanabhan, V.</span>, <span class="refAuthor">Fairhurst, G.</span>, and <span class="refAuthor">M. Sooriyabandara</span>, <span class="refTitle">"TCP Performance Implications of Network Path Asymmetry"</span>, <span class="seriesInfo">BCP 69</span>, <span class="seriesInfo">RFC 3449</span>, <span class="seriesInfo">DOI 10.17487/RFC3449</span>, <time class="refDate" datetime="2002-12">December 2002</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3449">https://www.rfc-editor.org/info/rfc3449</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4443">[RFC4443]</dt>
        <dd>
<span class="refAuthor">Conta, A.</span>, <span class="refAuthor">Deering, S.</span>, and <span class="refAuthor">M. Gupta, Ed.</span>, <span class="refTitle">"Internet Control Message Protocol (ICMPv6) for the Internet Protocol Version 6 (IPv6) Specification"</span>, <span class="seriesInfo">STD 89</span>, <span class="seriesInfo">RFC 4443</span>, <span class="seriesInfo">DOI 10.17487/RFC4443</span>, <time class="refDate" datetime="2006-03">March 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4443">https://www.rfc-editor.org/info/rfc4443</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4459">[RFC4459]</dt>
        <dd>
<span class="refAuthor">Savola, P.</span>, <span class="refTitle">"MTU and Fragmentation Issues with In-the-Network Tunneling"</span>, <span class="seriesInfo">RFC 4459</span>, <span class="seriesInfo">DOI 10.17487/RFC4459</span>, <time class="refDate" datetime="2006-04">April 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4459">https://www.rfc-editor.org/info/rfc4459</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4787">[RFC4787]</dt>
        <dd>
<span class="refAuthor">Audet, F., Ed.</span> and <span class="refAuthor">C. Jennings</span>, <span class="refTitle">"Network Address Translation (NAT) Behavioral Requirements for Unicast UDP"</span>, <span class="seriesInfo">BCP 127</span>, <span class="seriesInfo">RFC 4787</span>, <span class="seriesInfo">DOI 10.17487/RFC4787</span>, <time class="refDate" datetime="2007-01">January 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4787">https://www.rfc-editor.org/info/rfc4787</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4987">[RFC4987]</dt>
        <dd>
<span class="refAuthor">Eddy, W.</span>, <span class="refTitle">"TCP SYN Flooding Attacks and Common Mitigations"</span>, <span class="seriesInfo">RFC 4987</span>, <span class="seriesInfo">DOI 10.17487/RFC4987</span>, <time class="refDate" datetime="2007-08">August 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4987">https://www.rfc-editor.org/info/rfc4987</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5382">[RFC5382]</dt>
        <dd>
<span class="refAuthor">Guha, S., Ed.</span>, <span class="refAuthor">Biswas, K.</span>, <span class="refAuthor">Ford, B.</span>, <span class="refAuthor">Sivakumar, S.</span>, and <span class="refAuthor">P. Srisuresh</span>, <span class="refTitle">"NAT Behavioral Requirements for TCP"</span>, <span class="seriesInfo">BCP 142</span>, <span class="seriesInfo">RFC 5382</span>, <span class="seriesInfo">DOI 10.17487/RFC5382</span>, <time class="refDate" datetime="2008-10">October 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5382">https://www.rfc-editor.org/info/rfc5382</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6066">[RFC6066]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span>, <span class="refTitle">"Transport Layer Security (TLS) Extensions: Extension Definitions"</span>, <span class="seriesInfo">RFC 6066</span>, <span class="seriesInfo">DOI 10.17487/RFC6066</span>, <time class="refDate" datetime="2011-01">January 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6066">https://www.rfc-editor.org/info/rfc6066</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7301">[RFC7301]</dt>
        <dd>
<span class="refAuthor">Friedl, S.</span>, <span class="refAuthor">Popov, A.</span>, <span class="refAuthor">Langley, A.</span>, and <span class="refAuthor">E. Stephan</span>, <span class="refTitle">"Transport Layer Security (TLS) Application-Layer Protocol Negotiation Extension"</span>, <span class="seriesInfo">RFC 7301</span>, <span class="seriesInfo">DOI 10.17487/RFC7301</span>, <time class="refDate" datetime="2014-07">July 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7301">https://www.rfc-editor.org/info/rfc7301</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7605">[RFC7605]</dt>
        <dd>
<span class="refAuthor">Touch, J.</span>, <span class="refTitle">"Recommendations on Using Assigned Transport Port Numbers"</span>, <span class="seriesInfo">BCP 165</span>, <span class="seriesInfo">RFC 7605</span>, <span class="seriesInfo">DOI 10.17487/RFC7605</span>, <time class="refDate" datetime="2015-08">August 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7605">https://www.rfc-editor.org/info/rfc7605</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7801">[RFC7801]</dt>
        <dd>
<span class="refAuthor">Dolmatov, V., Ed.</span>, <span class="refTitle">"GOST R 34.12-2015: Block Cipher "Kuznyechik""</span>, <span class="seriesInfo">RFC 7801</span>, <span class="seriesInfo">DOI 10.17487/RFC7801</span>, <time class="refDate" datetime="2016-03">March 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7801">https://www.rfc-editor.org/info/rfc7801</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7838">[RFC7838]</dt>
        <dd>
<span class="refAuthor">Nottingham, M.</span>, <span class="refAuthor">McManus, P.</span>, and <span class="refAuthor">J. Reschke</span>, <span class="refTitle">"HTTP Alternative Services"</span>, <span class="seriesInfo">RFC 7838</span>, <span class="seriesInfo">DOI 10.17487/RFC7838</span>, <time class="refDate" datetime="2016-04">April 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7838">https://www.rfc-editor.org/info/rfc7838</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7983">[RFC7983]</dt>
        <dd>
<span class="refAuthor">Petit-Huguenin, M.</span> and <span class="refAuthor">G. Salgueiro</span>, <span class="refTitle">"Multiplexing Scheme Updates for Secure Real-time Transport Protocol (SRTP) Extension for Datagram Transport Layer Security (DTLS)"</span>, <span class="seriesInfo">RFC 7983</span>, <span class="seriesInfo">DOI 10.17487/RFC7983</span>, <time class="refDate" datetime="2016-09">September 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7983">https://www.rfc-editor.org/info/rfc7983</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8201">[RFC8201]</dt>
        <dd>
<span class="refAuthor">McCann, J.</span>, <span class="refAuthor">Deering, S.</span>, <span class="refAuthor">Mogul, J.</span>, and <span class="refAuthor">R. Hinden, Ed.</span>, <span class="refTitle">"Path MTU Discovery for IP version 6"</span>, <span class="seriesInfo">STD 87</span>, <span class="seriesInfo">RFC 8201</span>, <span class="seriesInfo">DOI 10.17487/RFC8201</span>, <time class="refDate" datetime="2017-07">July 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8201">https://www.rfc-editor.org/info/rfc8201</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8504">[RFC8504]</dt>
        <dd>
<span class="refAuthor">Chown, T.</span>, <span class="refAuthor">Loughney, J.</span>, and <span class="refAuthor">T. Winters</span>, <span class="refTitle">"IPv6 Node Requirements"</span>, <span class="seriesInfo">BCP 220</span>, <span class="seriesInfo">RFC 8504</span>, <span class="seriesInfo">DOI 10.17487/RFC8504</span>, <time class="refDate" datetime="2019-01">January 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8504">https://www.rfc-editor.org/info/rfc8504</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9065">[RFC9065]</dt>
        <dd>
<span class="refAuthor">Fairhurst, G.</span> and <span class="refAuthor">C. Perkins</span>, <span class="refTitle">"Considerations around Transport Header Confidentiality, Network Operations, and the Evolution of Internet Transport Protocols"</span>, <span class="seriesInfo">RFC 9065</span>, <span class="seriesInfo">DOI 10.17487/RFC9065</span>, <time class="refDate" datetime="2021-07">July 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9065">https://www.rfc-editor.org/info/rfc9065</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9250">[RFC9250]</dt>
        <dd>
<span class="refAuthor">Huitema, C.</span>, <span class="refAuthor">Dickinson, S.</span>, and <span class="refAuthor">A. Mankin</span>, <span class="refTitle">"DNS over Dedicated QUIC Connections"</span>, <span class="seriesInfo">RFC 9250</span>, <span class="seriesInfo">DOI 10.17487/RFC9250</span>, <time class="refDate" datetime="2022-05">May 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9250">https://www.rfc-editor.org/info/rfc9250</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-tls-esni">[TLS-ECH]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refAuthor">Oku, K.</span>, <span class="refAuthor">Sullivan, N.</span>, and <span class="refAuthor">C. A. Wood</span>, <span class="refTitle">"TLS Encrypted Client Hello"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-tls-esni-14</span>, <time class="refDate" datetime="2022-02-13">13 February 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-tls-esni-14">https://datatracker.ietf.org/doc/html/draft-ietf-tls-esni-14</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TMA-QOF">[TMA-QOF]</dt>
        <dd>
<span class="refAuthor">Trammell, B.</span>, <span class="refAuthor">Gugelmann, D.</span>, and <span class="refAuthor">N. Brownlee</span>, <span class="refTitle">"Inline Data Integrity Signals for Passive Measurement"</span>, <span class="refContent">Traffic Measurement and Analysis, TMA 2014, Lecture Notes in Computer Science, vol. 8406, pp. 15-25</span>, <span class="seriesInfo">DOI 10.1007/978-3-642-54999-1_2</span>, <time class="refDate" datetime="2014-04">April 2014</time>, <span>&lt;<a href="https://link.springer.com/chapter/10.1007/978-3-642-54999-1_2">https://link.springer.com/chapter/10.1007/978-3-642-54999-1_2</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8546">[WIRE-IMAGE]</dt>
      <dd>
<span class="refAuthor">Trammell, B.</span> and <span class="refAuthor">M. Kuehlewind</span>, <span class="refTitle">"The Wire Image of a Network Protocol"</span>, <span class="seriesInfo">RFC 8546</span>, <span class="seriesInfo">DOI 10.17487/RFC8546</span>, <time class="refDate" datetime="2019-04">April 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8546">https://www.rfc-editor.org/info/rfc8546</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="acknowledgments">
<section id="appendix-A">
      <h2 id="name-acknowledgments">
<a class="section-name selfRef" href="#name-acknowledgments">Acknowledgments</a>
      </h2>
<p id="appendix-A-1">Special thanks to last call reviewers <span class="contact-name">Elwyn       Davies</span>, <span class="contact-name">Barry Leiba</span>, <span class="contact-name">Al       Morton</span>, and <span class="contact-name">Peter Saint-Andre</span>.<a class="pilcrow" href="#appendix-A-1">Â¶</a></p>
<p id="appendix-A-2">This work was partially supported by the European Commission under
      Horizon 2020 grant agreement no. 688421 Measurement and Architecture for
      a Middleboxed Internet (MAMI), and by the Swiss State Secretariat for
      Education, Research, and Innovation under contract no. 15.0268. This
      support does not imply endorsement.<a class="pilcrow" href="#appendix-A-2">Â¶</a></p>
</section>
</div>
<div id="contributors">
<section id="appendix-B">
      <h2 id="name-contributors">
<a class="section-name selfRef" href="#name-contributors">Contributors</a>
      </h2>
<p id="appendix-B-1">The following people have contributed significant text to and/or
      feedback on this document:<a class="pilcrow" href="#appendix-B-1">Â¶</a></p>
<address class="vcard">
<div class="left" dir="auto"><span class="fn nameRole">Chris Box</span></div>
</address>
<address class="vcard">
<div class="left" dir="auto"><span class="fn nameRole">Dan Druta</span></div>
</address>
<address class="vcard">
<div class="left" dir="auto"><span class="fn nameRole">David Schinazi</span></div>
</address>
<address class="vcard">
<div class="left" dir="auto"><span class="fn nameRole">Gorry Fairhurst</span></div>
</address>
<address class="vcard">
<div class="left" dir="auto"><span class="fn nameRole">Ian Swett</span></div>
</address>
<address class="vcard">
<div class="left" dir="auto"><span class="fn nameRole">Igor Lubashev</span></div>
</address>
<address class="vcard">
<div class="left" dir="auto"><span class="fn nameRole">Jana Iyengar</span></div>
</address>
<address class="vcard">
<div class="left" dir="auto"><span class="fn nameRole">Jared Mauch</span></div>
</address>
<address class="vcard">
<div class="left" dir="auto"><span class="fn nameRole">Lars Eggert</span></div>
</address>
<address class="vcard">
<div class="left" dir="auto"><span class="fn nameRole">Lucas Purdue</span></div>
</address>
<address class="vcard">
<div class="left" dir="auto"><span class="fn nameRole">Marcus Ihlar</span></div>
</address>
<address class="vcard">
<div class="left" dir="auto"><span class="fn nameRole">Mark Nottingham</span></div>
</address>
<address class="vcard">
<div class="left" dir="auto"><span class="fn nameRole">Martin Duke</span></div>
</address>
<address class="vcard">
<div class="left" dir="auto"><span class="fn nameRole">Martin Thomson</span></div>
</address>
<address class="vcard">
<div class="left" dir="auto"><span class="fn nameRole">Matt Joras</span></div>
</address>
<address class="vcard">
<div class="left" dir="auto"><span class="fn nameRole">Mike Bishop</span></div>
</address>
<address class="vcard">
<div class="left" dir="auto"><span class="fn nameRole">Nick Banks</span></div>
</address>
<address class="vcard">
<div class="left" dir="auto"><span class="fn nameRole">Thomas Fossati</span></div>
</address>
<address class="vcard">
<div class="left" dir="auto"><span class="fn nameRole">Sean Turner</span></div>
</address>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-C">
      <h2 id="name-authors-addresses">
<a class="section-name selfRef" href="#name-authors-addresses">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Mirja KÃ¼hlewind</span></div>
<div class="left" dir="auto"><span class="org">Ericsson</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:mirja.kuehlewind@ericsson.com">mirja.kuehlewind@ericsson.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Brian Trammell</span></div>
<div class="left" dir="auto"><span class="org">Google Switzerland GmbH</span></div>
<div class="left" dir="auto"><span class="street-address">Gustav-Gull-Platz 1</span></div>
<div class="left" dir="auto">CH-<span class="postal-code">8004</span> <span class="locality">Zurich</span>
</div>
<div class="left" dir="auto"><span class="country-name">Switzerland</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:ietf@trammell.ch">ietf@trammell.ch</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>


</body></html>