<html><head></head><body><pre>Internet Engineering Task Force (IETF)                           J. Elie
Request for Comments: 8143                                    April 2017
Updates: <a href="./rfc4642">4642</a>
Category: Standards Track
ISSN: 2070-1721


                  <span class="h1">Using Transport Layer Security (TLS)</span>
               <span class="h1">with Network News Transfer Protocol (NNTP)</span>

Abstract

   This document provides recommendations for improving the security of
   the Network News Transfer Protocol (NNTP) when using Transport Layer
   Security (TLS).  It modernizes the NNTP usage of TLS to be consistent
   with TLS best current practices.  This document updates <a href="./rfc4642">RFC 4642</a>.

Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in <a href="./rfc7841#section-2">Section 2 of RFC 7841</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc8143">http://www.rfc-editor.org/info/rfc8143</a>.

Copyright Notice

   Copyright (c) 2017 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://www.rfc-editor.org/bcp/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.






<span class="grey">Elie                         Standards Track                    [Page 1]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-2"></span>
<span class="grey"><a href="./rfc8143">RFC 8143</a>                   Using TLS with NNTP                April 2017</span>


Table of Contents

   <a href="#section-1">1</a>.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-2">2</a>
     <a href="#section-1.1">1.1</a>.  Conventions Used in This Document . . . . . . . . . . . .   <a href="#page-3">3</a>
   <a href="#section-2">2</a>.  Updates/Changes to <a href="./rfc4642">RFC 4642</a> . . . . . . . . . . . . . . . . .   <a href="#page-3">3</a>
   <a href="#section-3">3</a>.  Recommendations . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-4">4</a>
     <a href="#section-3.1">3.1</a>.  Compression . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-4">4</a>
     <a href="#section-3.2">3.2</a>.  Protocol Versions and Security Preferences  . . . . . . .   <a href="#page-4">4</a>
     <a href="#section-3.3">3.3</a>.  Server Name Indication  . . . . . . . . . . . . . . . . .   <a href="#page-5">5</a>
     <a href="#section-3.4">3.4</a>.  Prevention of SSL Stripping . . . . . . . . . . . . . . .   <a href="#page-5">5</a>
     <a href="#section-3.5">3.5</a>.  Authenticated Connections . . . . . . . . . . . . . . . .   <a href="#page-5">5</a>
     <a href="#section-3.6">3.6</a>.  Human Factors . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-6">6</a>
   <a href="#section-4">4</a>.  Security Considerations . . . . . . . . . . . . . . . . . . .   <a href="#page-7">7</a>
   <a href="#section-5">5</a>.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .   <a href="#page-7">7</a>
   <a href="#section-6">6</a>.  References  . . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-7">7</a>
     <a href="#section-6.1">6.1</a>.  Normative References  . . . . . . . . . . . . . . . . . .   <a href="#page-7">7</a>
     <a href="#section-6.2">6.2</a>.  Informative References  . . . . . . . . . . . . . . . . .   <a href="#page-9">9</a>
   <a href="#appendix-A">Appendix A</a>.  Detailed Changes to <a href="./rfc4642">RFC 4642</a> . . . . . . . . . . . .  <a href="#page-11">11</a>
     <a href="#appendix-A.1">A.1</a>.  Related to TLS-Level Compression  . . . . . . . . . . . .  <a href="#page-11">11</a>
     <a href="#appendix-A.2">A.2</a>.  Related to Implicit TLS . . . . . . . . . . . . . . . . .  <a href="#page-11">11</a>
     <a href="#appendix-A.3">A.3</a>.  Related to RC4 Cipher Suites  . . . . . . . . . . . . . .  <a href="#page-12">12</a>
     <a href="#appendix-A.4">A.4</a>.  Related to Server Name Indication . . . . . . . . . . . .  <a href="#page-12">12</a>
     <a href="#appendix-A.5">A.5</a>.  Related to Certificate Verification . . . . . . . . . . .  <a href="#page-12">12</a>
     <a href="#appendix-A.6">A.6</a>.  Related to Other Obsolete Wording . . . . . . . . . . . .  <a href="#page-13">13</a>
   Acknowledgments . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-13">13</a>
   Author's Address  . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-13">13</a>

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" id="section-1">1</a>.  Introduction</span>

   The Network News Transfer Protocol (NNTP) [<a href="./rfc3977" title='"Network News Transfer Protocol (NNTP)"'>RFC3977</a>] has been using
   Transport Layer Security (TLS) [<a href="./rfc5246" title='"The Transport Layer Security (TLS) Protocol Version 1.2"'>RFC5246</a>] along with its precursor,
   Secure Sockets Layer (SSL), since at least the year 2000.  The use of
   TLS in NNTP was formalized in [<a href="./rfc4642" title='"Using Transport Layer Security (TLS) with Network News Transfer Protocol (NNTP)"'>RFC4642</a>], providing implementation
   recommendations at the same time.  In order to address the evolving
   threat model on the Internet today, this document provides stronger
   recommendations regarding that use.

   In particular, this document updates [<a href="./rfc4642" title='"Using Transport Layer Security (TLS) with Network News Transfer Protocol (NNTP)"'>RFC4642</a>] by specifying that
   NNTP implementations and deployments MUST follow the best current
   practices documented in [<a href="#ref-BCP195" title='"Recommendations for Secure Use of Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)"'>BCP195</a>], which currently consists of <a href="./rfc7525">RFC</a>
   <a href="./rfc7525">7525</a> ("Recommendations for Secure Use of Transport Layer Security
   (TLS) and Datagram Transport Layer Security (DTLS)").  This includes
   stronger recommendations regarding SSL/TLS protocol versions,
   fallback to lower versions, TLS negotiation, TLS-level compression,
   TLS session resumption, cipher suites, public key lengths, forward
   secrecy, hostname validation, certificate verification, and other
   aspects of using TLS with NNTP.




<span class="grey">Elie                         Standards Track                    [Page 2]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-3"></span>
<span class="grey"><a href="./rfc8143">RFC 8143</a>                   Using TLS with NNTP                April 2017</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/1.1.%20%20Conventions%20Used%20in%20This%20Document"></a><a class="selflink" href="#section-1.1" id="section-1.1">1.1</a>.  Conventions Used in This Document</span>

   Any term not defined in this document has the same meaning as it does
   in [<a href="./rfc4642" title='"Using Transport Layer Security (TLS) with Network News Transfer Protocol (NNTP)"'>RFC4642</a>] or the NNTP core specification [<a href="./rfc3977" title='"Network News Transfer Protocol (NNTP)"'>RFC3977</a>].

   When this document uses the term "implicit TLS", it refers to TLS
   negotiation immediately upon connection on a separate port.

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in <a href="./rfc2119">RFC</a>
   <a href="./rfc2119">2119</a> [<a href="#ref-BCP14" title='"Key words for use in RFCs to Indicate Requirement Levels"'>BCP14</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/2.%20%20Updates%2FChanges%20to%20RFC%204642"></a><a class="selflink" href="#section-2" id="section-2">2</a>.  Updates/Changes to <a href="./rfc4642">RFC 4642</a></span>

   This document updates [<a href="./rfc4642" title='"Using Transport Layer Security (TLS) with Network News Transfer Protocol (NNTP)"'>RFC4642</a>] in the following aspects:

   o  NNTP implementations and deployments SHOULD disable TLS-level
      compression (<a href="./rfc7525#section-3.3">Section 3.3 of RFC 7525</a> [<a href="#ref-BCP195" title='"Recommendations for Secure Use of Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)"'>BCP195</a>]), thus no longer
      using TLS as a means to provide data compression (contrary to the
      Abstract and <a href="./rfc4642#section-2.2.2">Section 2.2.2 of [RFC4642]</a>).

   o  NNTP implementations and deployments SHOULD prefer implicit TLS,
      and therefore use strict TLS configuration (Section 3.2 of <a href="./rfc7525">RFC</a>
      <a href="./rfc7525">7525</a> [<a href="#ref-BCP195" title='"Recommendations for Secure Use of Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)"'>BCP195</a>]).  That is to say, they SHOULD use a port dedicated
      to NNTP over TLS and begin the TLS negotiation immediately upon
      connection (contrary to a dynamic upgrade from unencrypted to TLS-
      protected traffic via the use of the STARTTLS command, as
      <a href="./rfc4642#section-1">Section 1 of [RFC4642]</a> was encouraging).  Implicit TLS is the
      preferred way of using TLS with NNTP for the same reasons,
      transposed to NNTP, as those given in <a href="#appendix-A">Appendix A</a> of [<a href="#ref-MUA-STS" title='"Mail User Agent Strict Transport Security (MUA-STS)"'>MUA-STS</a>].
      (Note that [<a href="#ref-MUA-STS" title='"Mail User Agent Strict Transport Security (MUA-STS)"'>MUA-STS</a>] and [<a href="./rfc4642" title='"Using Transport Layer Security (TLS) with Network News Transfer Protocol (NNTP)"'>RFC4642</a>] have one author in common.)

   o  NNTP implementations and deployments MUST NOT negotiate RC4 cipher
      suites ([<a href="./rfc7465" title='"Prohibiting RC4 Cipher Suites"'>RFC7465</a>]); this is contrary to <a href="./rfc4642#section-5">Section 5 of [RFC4642]</a>,
      which required them to implement the TLS_RSA_WITH_RC4_128_MD5
      cipher suite so as to ensure that any two NNTP-compliant
      implementations can be configured to interoperate.  This document
      removes that requirement, so that NNTP client and server
      implementations follow the recommendations given in Sections <a href="#section-4.2">4.2</a>
      and 4.2.1 of <a href="./rfc7525">RFC 7525</a> [<a href="#ref-BCP195" title='"Recommendations for Secure Use of Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)"'>BCP195</a>] instead.  The mandatory-to-
      implement cipher suite or cipher suites depend on the TLS protocol
      version.  For instance, when TLS 1.2 is used, the
      TLS_RSA_WITH_AES_128_CBC_SHA cipher suite MUST be implemented
      (<a href="./rfc5246#section-9">Section 9 of [RFC5246]</a>).






<span class="grey">Elie                         Standards Track                    [Page 3]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-4"></span>
<span class="grey"><a href="./rfc8143">RFC 8143</a>                   Using TLS with NNTP                April 2017</span>


   o  All NNTP clients and any NNTP server that is known by multiple
      names MUST support the Server Name Indication (SNI) extension
      defined in <a href="./rfc6066#section-3">Section 3 of [RFC6066]</a>, in conformance with <a href="./rfc7525#section-3.6">Section 3.6
      of RFC 7525</a> [<a href="#ref-BCP195" title='"Recommendations for Secure Use of Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)"'>BCP195</a>].  It was only a "SHOULD" in <a href="./rfc4642#section-2.2.2">Section 2.2.2 of
      [RFC4642]</a>.

   o  NNTP implementations and deployments MUST follow the rules and
      guidelines defined in [<a href="./rfc6125" title='"Representation and Verification of Domain-Based Application Service Identity within Internet Public Key Infrastructure Using X.509 (PKIX) Certificates in the Context of Transport Layer Security (TLS)"'>RFC6125</a>] and [<a href="./rfc5280" title='"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"'>RFC5280</a>] for hostname
      validation and certificate verification.  Part of <a href="./rfc4642#section-5">Section 5 of
      [RFC4642]</a> is, therefore, rationalized in favor of following those
      two documents.

   <a href="#appendix-A">Appendix A</a> of this document gives detailed changes with regard to the
   wording of [<a href="./rfc4642" title='"Using Transport Layer Security (TLS) with Network News Transfer Protocol (NNTP)"'>RFC4642</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.%20%20Recommendations"></a><a class="selflink" href="#section-3" id="section-3">3</a>.  Recommendations</span>

   The best current practices documented in [<a href="#ref-BCP195" title='"Recommendations for Secure Use of Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)"'>BCP195</a>] apply here.
   Therefore, NNTP implementations and deployments compliant with this
   document are REQUIRED to comply with [<a href="#ref-BCP195" title='"Recommendations for Secure Use of Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)"'>BCP195</a>] as well.

   Instead of repeating those recommendations here, this document mostly
   provides supplementary information regarding secure implementation
   and deployment of NNTP technologies.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.1.%20%20Compression"></a><a class="selflink" href="#section-3.1" id="section-3.1">3.1</a>.  Compression</span>

   NNTP supports the use of the COMPRESS command, defined in <a href="./rfc8054#section-2.2">Section 2.2
   of [RFC8054]</a>, to compress data between an NNTP client and server.
   Although this NNTP extension might have slightly stronger security
   properties than TLS-level compression [<a href="./rfc3749" title='"Transport Layer Security Protocol Compression Methods"'>RFC3749</a>] (since NNTP
   compression can be activated after authentication has completed, thus
   reducing the chances that authentication credentials can be leaked
   via, for instance, a Compression Ratio Info-leak Made Easy (CRIME)
   attack, as described in Section 2.6 of [<a href="#ref-CRIME" title='"The CRIME Attack"'>CRIME</a>]), this document
   neither encourages nor discourages the use of the NNTP COMPRESS
   extension.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.2.%20%20Protocol%20Versions%20and%20Security%20Preferences"></a><a class="selflink" href="#section-3.2" id="section-3.2">3.2</a>.  Protocol Versions and Security Preferences</span>

   NNTP implementations of news servers are encouraged to support
   options to configure 1) the minimal TLS protocol version to accept
   and 2) which cipher suites, signature algorithms, or groups (like
   elliptic curves) to use for incoming connections.  Additional options
   can naturally also be supported.  The goal is to enable
   administrators of news servers to easily and quickly strengthen
   security, if needed (for instance, by rejecting cipher suites
   considered unsafe with regard to local policy).



<span class="grey">Elie                         Standards Track                    [Page 4]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-5"></span>
<span class="grey"><a href="./rfc8143">RFC 8143</a>                   Using TLS with NNTP                April 2017</span>


   News clients may also support similar options, either configurable by
   the user or enforced by the news reader.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.3.%20%20Server%20Name%20Indication"></a><a class="selflink" href="#section-3.3" id="section-3.3">3.3</a>.  Server Name Indication</span>

   The TLS extension for Server Name Indication (SNI) defined in
   <a href="./rfc6066#section-3">Section 3 of [RFC6066]</a> MUST be implemented by all news clients.  It
   also MUST be implemented by any news server that is known by multiple
   names.  (Otherwise, it is not possible for a server with several
   hostnames to present the correct certificate to the client.)

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.4.%20%20Prevention%20of%20SSL%20Stripping"></a><a class="selflink" href="#section-3.4" id="section-3.4">3.4</a>.  Prevention of SSL Stripping</span>

   In order to help prevent SSL Stripping attacks (<a href="./rfc7457#section-2.1">Section 2.1 of
   [RFC7457]</a>), NNTP implementations and deployments MUST follow the
   recommendations provided in <a href="./rfc7525#section-3.2">Section 3.2 of RFC 7525</a> [<a href="#ref-BCP195" title='"Recommendations for Secure Use of Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)"'>BCP195</a>].
   Notably, in case implicit TLS is not used, news clients SHOULD
   attempt to negotiate TLS even if the server does not advertise the
   STARTTLS capability label in response to the CAPABILITIES command
   (<a href="./rfc4642#section-2.1">Section 2.1 of [RFC4642]</a>).

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.5.%20%20Authenticated%20Connections"></a><a class="selflink" href="#section-3.5" id="section-3.5">3.5</a>.  Authenticated Connections</span>

   [<a id="ref-RFC4642">RFC4642</a>] already provides recommendations and requirements for
   certificate validation in the context of checking the client or the
   server's identity.  Those requirements are strengthened by
   <a href="#appendix-A.5">Appendix A.5</a> of this document.

   Wherever possible, it is best to prefer certificate-based
   authentication (along with Simple Authentication and Security Layer
   (SASL) [<a href="./rfc4422" title='"Simple Authentication and Security Layer (SASL)"'>RFC4422</a>]), and ensure that:

   o  Clients authenticate servers.

   o  Servers authenticate clients.

   o  Servers authenticate other peer servers.

   This document does not mandate certificate-based authentication,
   although such authentication is strongly preferred.  As mentioned in
   <a href="./rfc4642#section-2.2.2">Section 2.2.2 of [RFC4642]</a>, the AUTHINFO SASL command (<a href="./rfc4643#section-2.4">Section 2.4 of
   [RFC4643]</a>) with the EXTERNAL mechanism (Appendix A of [<a href="./rfc4422" title='"Simple Authentication and Security Layer (SASL)"'>RFC4422</a>]) MAY
   be used to authenticate a client once its TLS credentials have been
   successfully exchanged.

   Given the pervasiveness of eavesdropping [<a href="./rfc7258" title='"Pervasive Monitoring Is an Attack"'>RFC7258</a>], even an encrypted
   but unauthenticated connection might be better than an unencrypted
   connection (this is similar to the "better-than-nothing security"



<span class="grey">Elie                         Standards Track                    [Page 5]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-6"></span>
<span class="grey"><a href="./rfc8143">RFC 8143</a>                   Using TLS with NNTP                April 2017</span>


   approach for IPsec [<a href="./rfc5386" title='"Better-Than-Nothing Security: An Unauthenticated Mode of IPsec"'>RFC5386</a>], and in accordance with opportunistic
   security principles [<a href="./rfc7435" title='"Opportunistic Security: Some Protection Most of the Time"'>RFC7435</a>]).  Encrypted but unauthenticated
   connections include connections negotiated using anonymous Diffie-
   Hellman mechanisms or using self-signed certificates, among others.

   Note: when an NNTP server receives a Netnews article, it MAY add a
   &lt;diag-match&gt; (<a href="./rfc5536#section-3.1.5">Section 3.1.5 of [RFC5536]</a>), which appears as "!!" in
   the Path header field of that article, to indicate that it verified
   the identity of the client or peer server.  This document encourages
   the construction of such Path header fields, as described in
   <a href="./rfc5537#section-3.2.1">Section 3.2.1 of [RFC5537]</a>.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.6.%20%20Human%20Factors"></a><a class="selflink" href="#section-3.6" id="section-3.6">3.6</a>.  Human Factors</span>

   NNTP clients SHOULD provide ways for end users (and NNTP servers
   SHOULD provide ways for administrators) to complete at least the
   following tasks:

   o  Determine if a given incoming or outgoing connection is encrypted
      using a security layer (either using TLS or an SASL mechanism that
      negotiates a security layer).

   o  Be warned if the version of TLS used for encryption of a given
      stream is not secure enough.

   o  If authenticated encryption is used, determine how the connection
      was authenticated or verified.

   o  Be warned if the certificate offered by an NNTP server cannot be
      verified.

   o  Be warned if the cipher suite used to encrypt a connection is not
      secure enough.

   o  Be warned if the certificate changes for a given server.

   o  When a security layer is not already in place, be warned if a
      given server stops advertising the STARTTLS capability label in
      response to the CAPABILITIES command (<a href="./rfc4642#section-2.1">Section 2.1 of [RFC4642]</a>),
      whereas it advertised the STARTTLS capability label during any
      previous connection within a (possibly configurable) time frame.
      (Otherwise, a human might not see the warning the first time, and
      the warning would disappear immediately after that.)

   o  Be warned if a failure response to the STARTTLS command is
      received from the server, whereas the STARTTLS capability label
      was advertised.




<span class="grey">Elie                         Standards Track                    [Page 6]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-7"></span>
<span class="grey"><a href="./rfc8143">RFC 8143</a>                   Using TLS with NNTP                April 2017</span>


   Note that the last two tasks cannot occur when implicit TLS is used,
   and that the penultimate task helps prevent an attack known as "SSL
   Stripping" (<a href="./rfc7457#section-2.1">Section 2.1 of [RFC7457]</a>).

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/4.%20%20Security%20Considerations"></a><a class="selflink" href="#section-4" id="section-4">4</a>.  Security Considerations</span>

   Beyond the security considerations already described in [<a href="./rfc4642" title='"Using Transport Layer Security (TLS) with Network News Transfer Protocol (NNTP)"'>RFC4642</a>],
   [<a href="./rfc6125" title='"Representation and Verification of Domain-Based Application Service Identity within Internet Public Key Infrastructure Using X.509 (PKIX) Certificates in the Context of Transport Layer Security (TLS)"'>RFC6125</a>], and [<a href="#ref-BCP195" title='"Recommendations for Secure Use of Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)"'>BCP195</a>], the following caveat is worth mentioning
   when not using implicit TLS: NNTP servers need to ensure that they
   are not vulnerable to the STARTTLS command injection vulnerability
   (<a href="./rfc7457#section-2.2">Section 2.2 of [RFC7457]</a>).  Though this command MUST NOT be
   pipelined, an attacker could pipeline it.  Therefore, NNTP servers
   MUST discard any NNTP command received between the use of STARTTLS
   and the end of TLS negotiation.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.%20%20IANA%20Considerations"></a><a class="selflink" href="#section-5" id="section-5">5</a>.  IANA Considerations</span>

   This document does not change the formal definition of the STARTTLS
   extension (<a href="./rfc4642#section-6">Section 6 of [RFC4642]</a>).  Nonetheless, as implementations
   of the STARTTLS extension should follow this document, IANA has added
   reference to this document to the existing STARTTLS label in the
   "NNTP Capability Labels" registry contained in the "Network News
   Transfer Protocol (NNTP) Parameters" registry:

       +----------+--------------------------+--------------------+
       | Label    | Meaning                  | Reference          |
       +----------+--------------------------+--------------------+
       | STARTTLS | Transport layer security | [<a href="./rfc4642" title='"Using Transport Layer Security (TLS) with Network News Transfer Protocol (NNTP)"'>RFC4642</a>][RFC8143] |
       +----------+--------------------------+--------------------+

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/6.%20%20References"></a><a class="selflink" href="#section-6" id="section-6">6</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/6.1.%20%20Normative%20References"></a><a class="selflink" href="#section-6.1" id="section-6.1">6.1</a>.  Normative References</span>

   [<a id="ref-BCP14">BCP14</a>]    Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="https://www.rfc-editor.org/bcp/bcp14">BCP 14</a>, <a href="./rfc2119">RFC 2119</a>, March 1997,
              &lt;<a href="http://www.rfc-editor.org/info/bcp14">http://www.rfc-editor.org/info/bcp14</a>&gt;.

   [<a id="ref-BCP195">BCP195</a>]   Sheffer, Y., Holz, R., and P. Saint-Andre,
              "Recommendations for Secure Use of Transport Layer
              Security (TLS) and Datagram Transport Layer Security
              (DTLS)", <a href="https://www.rfc-editor.org/bcp/bcp195">BCP 195</a>, <a href="./rfc7525">RFC 7525</a>, May 2015,
              &lt;<a href="https://www.rfc-editor.org/info/bcp195">https://www.rfc-editor.org/info/bcp195</a>&gt;.

   [<a id="ref-RFC3977">RFC3977</a>]  Feather, C., "Network News Transfer Protocol (NNTP)",
              <a href="./rfc3977">RFC 3977</a>, DOI 10.17487/RFC3977, October 2006,
              &lt;<a href="http://www.rfc-editor.org/info/rfc3977">http://www.rfc-editor.org/info/rfc3977</a>&gt;.




<span class="grey">Elie                         Standards Track                    [Page 7]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-8"></span>
<span class="grey"><a href="./rfc8143">RFC 8143</a>                   Using TLS with NNTP                April 2017</span>


   [<a id="ref-RFC4422">RFC4422</a>]  Melnikov, A., Ed. and K. Zeilenga, Ed., "Simple
              Authentication and Security Layer (SASL)", <a href="./rfc4422">RFC 4422</a>,
              DOI 10.17487/RFC4422, June 2006,
              &lt;<a href="http://www.rfc-editor.org/info/rfc4422">http://www.rfc-editor.org/info/rfc4422</a>&gt;.

   [<a id="ref-RFC4642">RFC4642</a>]  Murchison, K., Vinocur, J., and C. Newman, "Using
              Transport Layer Security (TLS) with Network News Transfer
              Protocol (NNTP)", <a href="./rfc4642">RFC 4642</a>, DOI 10.17487/RFC4642, October
              2006, &lt;<a href="http://www.rfc-editor.org/info/rfc4642">http://www.rfc-editor.org/info/rfc4642</a>&gt;.

   [<a id="ref-RFC4643">RFC4643</a>]  Vinocur, J. and K. Murchison, "Network News Transfer
              Protocol (NNTP) Extension for Authentication", <a href="./rfc4643">RFC 4643</a>,
              DOI 10.17487/RFC4643, October 2006,
              &lt;<a href="http://www.rfc-editor.org/info/rfc4643">http://www.rfc-editor.org/info/rfc4643</a>&gt;.

   [<a id="ref-RFC5246">RFC5246</a>]  Dierks, T. and E. Rescorla, "The Transport Layer Security
              (TLS) Protocol Version 1.2", <a href="./rfc5246">RFC 5246</a>,
              DOI 10.17487/RFC5246, August 2008,
              &lt;<a href="http://www.rfc-editor.org/info/rfc5246">http://www.rfc-editor.org/info/rfc5246</a>&gt;.

   [<a id="ref-RFC5280">RFC5280</a>]  Cooper, D., Santesson, S., Farrell, S., Boeyen, S.,
              Housley, R., and W. Polk, "Internet X.509 Public Key
              Infrastructure Certificate and Certificate Revocation List
              (CRL) Profile", <a href="./rfc5280">RFC 5280</a>, DOI 10.17487/RFC5280, May 2008,
              &lt;<a href="http://www.rfc-editor.org/info/rfc5280">http://www.rfc-editor.org/info/rfc5280</a>&gt;.

   [<a id="ref-RFC5536">RFC5536</a>]  Murchison, K., Ed., Lindsey, C., and D. Kohn, "Netnews
              Article Format", <a href="./rfc5536">RFC 5536</a>, DOI 10.17487/RFC5536, November
              2009, &lt;<a href="http://www.rfc-editor.org/info/rfc5536">http://www.rfc-editor.org/info/rfc5536</a>&gt;.

   [<a id="ref-RFC5537">RFC5537</a>]  Allbery, R., Ed. and C. Lindsey, "Netnews Architecture and
              Protocols", <a href="./rfc5537">RFC 5537</a>, DOI 10.17487/RFC5537, November 2009,
              &lt;<a href="http://www.rfc-editor.org/info/rfc5537">http://www.rfc-editor.org/info/rfc5537</a>&gt;.

   [<a id="ref-RFC6066">RFC6066</a>]  Eastlake 3rd, D., "Transport Layer Security (TLS)
              Extensions: Extension Definitions", <a href="./rfc6066">RFC 6066</a>,
              DOI 10.17487/RFC6066, January 2011,
              &lt;<a href="http://www.rfc-editor.org/info/rfc6066">http://www.rfc-editor.org/info/rfc6066</a>&gt;.

   [<a id="ref-RFC6125">RFC6125</a>]  Saint-Andre, P. and J. Hodges, "Representation and
              Verification of Domain-Based Application Service Identity
              within Internet Public Key Infrastructure Using X.509
              (PKIX) Certificates in the Context of Transport Layer
              Security (TLS)", <a href="./rfc6125">RFC 6125</a>, DOI 10.17487/RFC6125, March
              2011, &lt;<a href="http://www.rfc-editor.org/info/rfc6125">http://www.rfc-editor.org/info/rfc6125</a>&gt;.






<span class="grey">Elie                         Standards Track                    [Page 8]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-9"></span>
<span class="grey"><a href="./rfc8143">RFC 8143</a>                   Using TLS with NNTP                April 2017</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/6.2.%20%20Informative%20References"></a><a class="selflink" href="#section-6.2" id="section-6.2">6.2</a>.  Informative References</span>

   [<a id="ref-CRIME">CRIME</a>]    Rizzo, J. and T. Duong, "The CRIME Attack", Ekoparty
              Security Conference, 2012.

   [<a id="ref-MUA-STS">MUA-STS</a>]  Moore, K. and C. Newman, "Mail User Agent Strict Transport
              Security (MUA-STS)", Work in Progress,
              <a href="./draft-ietf-uta-email-deep-06">draft-ietf-uta-email-deep-06</a>, March 2017.

   [<a id="ref-PKI-CERT">PKI-CERT</a>] Housley, R., Ford, W., Polk, T., and D. Solo, "Internet
              X.509 Public Key Infrastructure Certificate and
              Certificate Revocation List (CRL) Profile", <a href="./rfc3280">RFC 3280</a>,
              DOI 10.17487/RFC3280, April 2002,
              &lt;<a href="http://www.rfc-editor.org/info/rfc3280">http://www.rfc-editor.org/info/rfc3280</a>&gt;.

   [<a id="ref-RFC3749">RFC3749</a>]  Hollenbeck, S., "Transport Layer Security Protocol
              Compression Methods", <a href="./rfc3749">RFC 3749</a>, DOI 10.17487/RFC3749, May
              2004, &lt;<a href="http://www.rfc-editor.org/info/rfc3749">http://www.rfc-editor.org/info/rfc3749</a>&gt;.

   [<a id="ref-RFC4301">RFC4301</a>]  Kent, S. and K. Seo, "Security Architecture for the
              Internet Protocol", <a href="./rfc4301">RFC 4301</a>, DOI 10.17487/RFC4301,
              December 2005, &lt;<a href="http://www.rfc-editor.org/info/rfc4301">http://www.rfc-editor.org/info/rfc4301</a>&gt;.

   [<a id="ref-RFC5386">RFC5386</a>]  Williams, N. and M. Richardson, "Better-Than-Nothing
              Security: An Unauthenticated Mode of IPsec", <a href="./rfc5386">RFC 5386</a>,
              DOI 10.17487/RFC5386, November 2008,
              &lt;<a href="http://www.rfc-editor.org/info/rfc5386">http://www.rfc-editor.org/info/rfc5386</a>&gt;.

   [<a id="ref-RFC7258">RFC7258</a>]  Farrell, S. and H. Tschofenig, "Pervasive Monitoring Is an
              Attack", <a href="https://www.rfc-editor.org/bcp/bcp188">BCP 188</a>, <a href="./rfc7258">RFC 7258</a>, DOI 10.17487/RFC7258, May
              2014, &lt;<a href="http://www.rfc-editor.org/info/rfc7258">http://www.rfc-editor.org/info/rfc7258</a>&gt;.

   [<a id="ref-RFC7435">RFC7435</a>]  Dukhovni, V., "Opportunistic Security: Some Protection
              Most of the Time", <a href="./rfc7435">RFC 7435</a>, DOI 10.17487/RFC7435,
              December 2014, &lt;<a href="http://www.rfc-editor.org/info/rfc7435">http://www.rfc-editor.org/info/rfc7435</a>&gt;.

   [<a id="ref-RFC7457">RFC7457</a>]  Sheffer, Y., Holz, R., and P. Saint-Andre, "Summarizing
              Known Attacks on Transport Layer Security (TLS) and
              Datagram TLS (DTLS)", <a href="./rfc7457">RFC 7457</a>, DOI 10.17487/RFC7457,
              February 2015, &lt;<a href="http://www.rfc-editor.org/info/rfc7457">http://www.rfc-editor.org/info/rfc7457</a>&gt;.

   [<a id="ref-RFC7465">RFC7465</a>]  Popov, A., "Prohibiting RC4 Cipher Suites", <a href="./rfc7465">RFC 7465</a>,
              DOI 10.17487/RFC7465, February 2015,
              &lt;<a href="http://www.rfc-editor.org/info/rfc7465">http://www.rfc-editor.org/info/rfc7465</a>&gt;.







<span class="grey">Elie                         Standards Track                    [Page 9]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-10"></span>
<span class="grey"><a href="./rfc8143">RFC 8143</a>                   Using TLS with NNTP                April 2017</span>


   [<a id="ref-RFC7590">RFC7590</a>]  Saint-Andre, P. and T. Alkemade, "Use of Transport Layer
              Security (TLS) in the Extensible Messaging and Presence
              Protocol (XMPP)", <a href="./rfc7590">RFC 7590</a>, DOI 10.17487/RFC7590, June
              2015, &lt;<a href="http://www.rfc-editor.org/info/rfc7590">http://www.rfc-editor.org/info/rfc7590</a>&gt;.

   [<a id="ref-RFC8054">RFC8054</a>]  Murchison, K. and J. Elie, "Network News Transfer Protocol
              (NNTP) Extension for Compression", <a href="./rfc8054">RFC 8054</a>,
              DOI 10.17487/RFC8054, January 2017,
              &lt;<a href="http://www.rfc-editor.org/info/rfc8054">http://www.rfc-editor.org/info/rfc8054</a>&gt;.










































<span class="grey">Elie                         Standards Track                   [Page 10]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-11"></span>
<span class="grey"><a href="./rfc8143">RFC 8143</a>                   Using TLS with NNTP                April 2017</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/Appendix%20A.%20%20Detailed%20Changes%20to%20RFC%204642"></a><a class="selflink" href="#appendix-A" id="appendix-A">Appendix A</a>.  Detailed Changes to <a href="./rfc4642">RFC 4642</a></span>

   This section lists the detailed changes that this document applies to
   [<a href="./rfc4642" title='"Using Transport Layer Security (TLS) with Network News Transfer Protocol (NNTP)"'>RFC4642</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/A.1.%20%20Related%20to%20TLS-Level%20Compression"></a><a class="selflink" href="#appendix-A.1" id="appendix-A.1">A.1</a>.  Related to TLS-Level Compression</span>

   The second sentence in the Abstract in [<a href="./rfc4642" title='"Using Transport Layer Security (TLS) with Network News Transfer Protocol (NNTP)"'>RFC4642</a>] is replaced with the
   following text:

      The primary goal is to provide encryption for single-link
      confidentiality purposes, but data integrity, and (optional)
      certificate-based peer entity authentication are also possible.

   The second sentence of the first paragraph in <a href="./rfc4642#section-2.2.2">Section 2.2.2 of
   [RFC4642]</a> is replaced with the following text:

      The STARTTLS command is usually used to initiate session security,
      although it can also be used for client and/or server certificate
      authentication.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/A.2.%20%20Related%20to%20Implicit%20TLS"></a><a class="selflink" href="#appendix-A.2" id="appendix-A.2">A.2</a>.  Related to Implicit TLS</span>

   The third and fourth paragraphs in <a href="./rfc4642#section-1">Section 1 of [RFC4642]</a> are
   replaced with the following text:

      TCP port 563 is dedicated to NNTP over TLS, and registered in the
      IANA Service Name and Transport Protocol Port Number Registry for
      that usage.  NNTP implementations using TCP port 563 begin the TLS
      negotiation immediately upon connection and then continue with the
      initial steps of an NNTP session.  This immediate TLS negotiation
      on a separate port (referred to in this document as "implicit
      TLS") is the preferred way of using TLS with NNTP.

      If a host wishes to offer separate servers for transit and reading
      clients (<a href="#section-3.4.1">Section 3.4.1</a> of [NNTP]), TCP port 563 SHOULD be used for
      implicit TLS with the reading server, and an unused port of its
      choice different than TCP port 433 SHOULD be used for implicit TLS
      with the transit server.  The ports used for implicit TLS should
      be clearly communicated to the clients, and specifically that no
      plaintext communication occurs before the TLS session is
      negotiated.

      As some existing implementations negotiate TLS via a dynamic
      upgrade from unencrypted to TLS-protected traffic during an NNTP
      session on well-known TCP ports 119 or 433, this specification





<span class="grey">Elie                         Standards Track                   [Page 11]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-12"></span>
<span class="grey"><a href="./rfc8143">RFC 8143</a>                   Using TLS with NNTP                April 2017</span>


      formalizes the STARTTLS command in use for that purpose.  However,
      as already mentioned above, implementations SHOULD use implicit
      TLS on a separate port.

      Note: a common alternative to protect NNTP exchanges with transit
      servers that do not implement TLS is the use of IPsec with
      encryption [<a href="./rfc4301" title='"Security Architecture for the Internet Protocol"'>RFC4301</a>].

   An additional informative reference to [<a href="./rfc4301" title='"Security Architecture for the Internet Protocol"'>RFC4301</a>] is, therefore, added
   to <a href="./rfc4642#section-7.2">Section 7.2 of [RFC4642]</a>.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/A.3.%20%20Related%20to%20RC4%20Cipher%20Suites"></a><a class="selflink" href="#appendix-A.3" id="appendix-A.3">A.3</a>.  Related to RC4 Cipher Suites</span>

   The third paragraph in <a href="./rfc4642#section-5">Section 5 of [RFC4642]</a> is removed.
   Consequently, NNTP no longer requires the implementation of any
   cipher suites, other than those prescribed by TLS (<a href="./rfc5246#section-9">Section 9 of
   [RFC5246]</a>), and Sections <a href="#section-4.2">4.2</a> and <a href="#section-4.2.1">4.2.1</a> of <a href="./rfc7525">RFC 7525</a> [<a href="#ref-BCP195" title='"Recommendations for Secure Use of Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)"'>BCP195</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/A.4.%20%20Related%20to%20Server%20Name%20Indication"></a><a class="selflink" href="#appendix-A.4" id="appendix-A.4">A.4</a>.  Related to Server Name Indication</span>

   The last two sentences of the seventh paragraph in <a href="./rfc4642#section-2.2.2">Section 2.2.2 of
   [RFC4642]</a> are removed.  <a href="./rfc7525#section-3.6">Section 3.6 of RFC 7525</a> [<a href="#ref-BCP195" title='"Recommendations for Secure Use of Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)"'>BCP195</a>] applies.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/A.5.%20%20Related%20to%20Certificate%20Verification"></a><a class="selflink" href="#appendix-A.5" id="appendix-A.5">A.5</a>.  Related to Certificate Verification</span>

   The text between "During the TLS negotiation" and "identity
   bindings)." in <a href="./rfc4642#section-5">Section 5 of [RFC4642]</a> is replaced with the following
   text:

      During TLS negotiation, the client MUST verify the server's
      identity in order to prevent man-in-the-middle attacks.  The
      client MUST follow the rules and guidelines defined in [<a href="./rfc6125" title='"Representation and Verification of Domain-Based Application Service Identity within Internet Public Key Infrastructure Using X.509 (PKIX) Certificates in the Context of Transport Layer Security (TLS)"'>RFC6125</a>],
      where the reference identifier MUST be the server hostname that
      the client used to open the connection, and that is also specified
      in the TLS "server_name" extension [<a href="./rfc6066" title='"Transport Layer Security (TLS) Extensions: Extension Definitions"'>RFC6066</a>].  The following NNTP-
      specific consideration applies: DNS domain names in server
      certificates MAY contain the wildcard character "*" as the
      complete leftmost label within the identifier.

      If the match fails, the client MUST follow the recommendations in
      <a href="./rfc6125#section-6.6">Section 6.6 of [RFC6125]</a> regarding certificate pinning and
      fallback.

      Beyond server identity checking, clients also MUST apply the
      procedures specified in [<a href="./rfc5280" title='"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"'>RFC5280</a>] for general certificate
      validation (e.g., certificate integrity, signing, and path
      validation).




<span class="grey">Elie                         Standards Track                   [Page 12]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-13"></span>
<span class="grey"><a href="./rfc8143">RFC 8143</a>                   Using TLS with NNTP                April 2017</span>


   Additional normative references to [<a href="./rfc5280" title='"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"'>RFC5280</a>] (replacing [<a href="#ref-PKI-CERT" title='"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"'>PKI-CERT</a>],
   which it obsoletes), [<a href="./rfc6066" title='"Transport Layer Security (TLS) Extensions: Extension Definitions"'>RFC6066</a>], and [<a href="./rfc6125" title='"Representation and Verification of Domain-Based Application Service Identity within Internet Public Key Infrastructure Using X.509 (PKIX) Certificates in the Context of Transport Layer Security (TLS)"'>RFC6125</a>] are, therefore, added
   to <a href="./rfc4642#section-7.1">Section 7.1 of [RFC4642]</a>.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/A.6.%20%20Related%20to%20Other%20Obsolete%20Wording"></a><a class="selflink" href="#appendix-A.6" id="appendix-A.6">A.6</a>.  Related to Other Obsolete Wording</span>

   The first two sentences of the seventh paragraph in <a href="./rfc4642#section-2.2.2">Section 2.2.2 of
   [RFC4642]</a> are removed.  There is no special requirement for NNTP with
   regard to TLS Client Hello messages.  <a href="#section-7.4.1.2">Section 7.4.1.2</a> and <a href="./rfc5246#appendix-E">Appendix E
   of [RFC5246]</a> apply.

Acknowledgments

   This document draws heavily on ideas in [<a href="./rfc7590" title='"Use of Transport Layer Security (TLS) in the Extensible Messaging and Presence Protocol (XMPP)"'>RFC7590</a>] by Peter Saint-
   Andre and Thijs Alkemade; a large portion of this text was borrowed
   from that specification.

   The author would like to thank the following individuals for
   contributing their ideas and support for writing this specification:
   Stephane Bortzmeyer, Ben Campbell, Viktor Dukhovni, Stephen Farrell,
   Sabahattin Gucukoglu, Richard Kettlewell, Jouni Korhonen, Mirja
   Kuehlewind, David Eric Mandelberg, Matija Nalis, Chris Newman, and
   Peter Saint-Andre.

   Special thanks to Michael Baeuerle, for shepherding this document,
   and to the Responsible Area Director, Alexey Melnikov, for sponsoring
   it.  They both significantly helped to increase its quality.

Author's Address

   Julien Elie
   10 allee Clovis
   Noisy-le-Grand  93160
   France

   Email: julien@trigofacile.com
   URI:   <a href="http://www.trigofacile.com/">http://www.trigofacile.com/</a>














Elie                         Standards Track                   [Page 13]
</pre>
</body></html>