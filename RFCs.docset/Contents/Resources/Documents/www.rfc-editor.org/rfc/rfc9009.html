<!DOCTYPE html>
<html class="RFC" lang="en"><head>
<meta charset="utf-8"/>
<meta content="Common,Latin" name="scripts"/>
<meta content="initial-scale=1.0" name="viewport"/>
<title>RFC 9009: Efficient Route Invalidation</title>
<meta content="Rahul Arvind Jadhav" name="author"/>
<meta content="Pascal Thubert" name="author"/>
<meta content="Rabi Narayan Sahoo" name="author"/>
<meta content="Zhen Cao" name="author"/>
<meta content='
       
        This document explains the problems associated with the use of
        No-Path Destination Advertisement Object (NPDAO) messaging in RFC 6550 and also discusses the requirements for an optimized
        route invalidation messaging scheme. Further, this document specifies a new proactive route
        invalidation message called the "Destination Cleanup Object" (DCO),
        which fulfills requirements for optimized route
        invalidation messaging.
       
    ' name="description"/>
<meta content="xml2rfc 3.7.0" name="generator"/>
<meta content="NPDAO" name="keyword"/>
<meta content="DCO" name="keyword"/>
<meta content="no-path" name="keyword"/>
<meta content="route" name="keyword"/>
<meta content="cleanup" name="keyword"/>
<meta content="9009" name="rfc.number"/>
<!-- Generator version information:
  xml2rfc 3.7.0
    Python 3.6.10
    appdirs 1.4.4
    ConfigArgParse 1.2.3
    google-i18n-address 2.3.5
    html5lib 1.0.1
    intervaltree 3.0.2
    Jinja2 2.11.2
    kitchen 1.2.6
    lxml 4.4.2
    pycairo 1.19.0
    pycountry 19.8.18
    pyflakes 2.1.1
    PyYAML 5.3.1
    requests 2.22.0
    setuptools 40.6.2
    six 1.14.0
    WeasyPrint 51
-->
<link href="rfc9009.xml" rel="alternate" type="application/rfc+xml"/>
<link href="#copyright" rel="license"/>
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css"/>
<link href="https://dx.doi.org/10.17487/rfc9009" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <link href="https://datatracker.ietf.org/doc/draft-ietf-roll-efficient-npdao-18" rel="prev"/>
  </head>
<body>
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 9009</td>
<td class="center">Efficient Route Invalidation</td>
<td class="right">April 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Jadhav, et al.</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div class="document-information" id="external-metadata"></div>
<div class="document-information" id="internal-metadata">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a class="eref" href="https://www.rfc-editor.org/rfc/rfc9009">9009</a></dd>
<dt class="label-category">Category:</dt>
<dd class="category">Standards Track</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time class="published" datetime="2021-04">April 2021</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">R.A. Jadhav, <span class="editor">Ed.</span>
</div>
<div class="org">Huawei</div>
</div>
<div class="author">
      <div class="author-name">P. Thubert</div>
<div class="org">Cisco</div>
</div>
<div class="author">
      <div class="author-name">R.N. Sahoo</div>
<div class="org">Huawei</div>
</div>
<div class="author">
      <div class="author-name">Z. Cao</div>
<div class="org">Huawei</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 9009</h1>
<h1 id="title">Efficient Route Invalidation</h1>
<section id="section-abstract">
      <h2 id="abstract"><a class="selfRef" href="#abstract">Abstract</a></h2>
<p id="section-abstract-1">
        This document explains the problems associated with the use of
        No-Path Destination Advertisement Object (NPDAO) messaging in RFC 6550 and also discusses the requirements for an optimized
        route invalidation messaging scheme. Further, this document specifies a new proactive route
        invalidation message called the "Destination Cleanup Object" (DCO),
        which fulfills requirements for optimized route
        invalidation messaging.<a class="pilcrow" href="#section-abstract-1">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a class="section-name selfRef" href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This is an Internet Standards Track document.<a class="pilcrow" href="#section-boilerplate.1-1">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.<a class="pilcrow" href="#section-boilerplate.1-2">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc9009">https://www.rfc-editor.org/info/rfc9009</a></span>.<a class="pilcrow" href="#section-boilerplate.1-3">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a class="section-name selfRef" href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a class="pilcrow" href="#section-boilerplate.2-1">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a class="pilcrow" href="#section-boilerplate.2-2">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a class="toplink" href="#" onclick="scroll(0,0)">▲</a><h2 id="name-table-of-contents">
<a class="section-name selfRef" href="#name-table-of-contents">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulEmpty">
<li class="compact toc ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a class="xref" href="#section-1">1</a>.  <a class="xref" href="#name-introduction">Introduction</a></p>
<ul class="compact toc ulEmpty">
<li class="compact toc ulEmpty" id="section-toc.1-1.1.2.1">
                <p class="keepWithNext" id="section-toc.1-1.1.2.1.1"><a class="xref" href="#section-1.1">1.1</a>.  <a class="xref" href="#name-requirements-language-and-t">Requirements Language and Terminology</a></p>
</li>
              <li class="compact toc ulEmpty" id="section-toc.1-1.1.2.2">
                <p class="keepWithNext" id="section-toc.1-1.1.2.2.1"><a class="xref" href="#section-1.2">1.2</a>.  <a class="xref" href="#name-rpl-npdao-messaging">RPL NPDAO Messaging</a></p>
</li>
              <li class="compact toc ulEmpty" id="section-toc.1-1.1.2.3">
                <p class="keepWithNext" id="section-toc.1-1.1.2.3.1"><a class="xref" href="#section-1.3">1.3</a>.  <a class="xref" href="#name-why-is-npdao-messaging-impo">Why Is NPDAO Messaging Important?</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a class="xref" href="#section-2">2</a>.  <a class="xref" href="#name-problems-with-the-rpl-npdao">Problems with the RPL NPDAO Messaging</a></p>
<ul class="compact toc ulEmpty">
<li class="compact toc ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a class="xref" href="#section-2.1">2.1</a>.  <a class="xref" href="#name-lost-npdao-due-to-link-brea">Lost NPDAO Due to Link Break to the Previous Parent</a></p>
</li>
              <li class="compact toc ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a class="xref" href="#section-2.2">2.2</a>.  <a class="xref" href="#name-invalidating-routes-of-depe">Invalidating Routes of Dependent Nodes</a></p>
</li>
              <li class="compact toc ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a class="xref" href="#section-2.3">2.3</a>.  <a class="xref" href="#name-possible-route-downtime-cau">Possible Route Downtime Caused by Asynchronous Operation of the NPDAO and DAO</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a class="xref" href="#section-3">3</a>.  <a class="xref" href="#name-requirements-for-npdao-opti">Requirements for NPDAO Optimization</a></p>
<ul class="compact toc ulEmpty">
<li class="compact toc ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a class="xref" href="#section-3.1">3.1</a>.  <a class="xref" href="#name-req-1-remove-messaging-depe">Req. #1: Remove Messaging Dependency on the Link to the Previous  Parent</a></p>
</li>
              <li class="compact toc ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a class="xref" href="#section-3.2">3.2</a>.  <a class="xref" href="#name-req-2-route-invalidation-fo">Req. #2: Route Invalidation for Dependent Nodes at the Parent Switching Node</a></p>
</li>
              <li class="compact toc ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a class="xref" href="#section-3.3">3.3</a>.  <a class="xref" href="#name-req-3-route-invalidation-sh">Req. #3: Route Invalidation Should Not Impact Data Traffic</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a class="xref" href="#section-4">4</a>.  <a class="xref" href="#name-changes-to-rpl-signaling">Changes to RPL Signaling</a></p>
<ul class="compact toc ulEmpty">
<li class="compact toc ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a class="xref" href="#section-4.1">4.1</a>.  <a class="xref" href="#name-change-in-rpl-route-invalid">Change in RPL Route Invalidation Semantics</a></p>
</li>
              <li class="compact toc ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a class="xref" href="#section-4.2">4.2</a>.  <a class="xref" href="#name-transit-information-option-">Transit Information Option Changes</a></p>
</li>
              <li class="compact toc ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a class="xref" href="#section-4.3">4.3</a>.  <a class="xref" href="#name-destination-cleanup-object-">Destination Cleanup Object (DCO)</a></p>
<ul class="compact toc ulEmpty">
<li class="compact toc ulEmpty" id="section-toc.1-1.4.2.3.2.1">
                    <p id="section-toc.1-1.4.2.3.2.1.1"><a class="xref" href="#section-4.3.1">4.3.1</a>.  <a class="xref" href="#name-secure-dco">Secure DCO</a></p>
</li>
                  <li class="compact toc ulEmpty" id="section-toc.1-1.4.2.3.2.2">
                    <p id="section-toc.1-1.4.2.3.2.2.1"><a class="xref" href="#section-4.3.2">4.3.2</a>.  <a class="xref" href="#name-dco-options">DCO Options</a></p>
</li>
                  <li class="compact toc ulEmpty" id="section-toc.1-1.4.2.3.2.3">
                    <p id="section-toc.1-1.4.2.3.2.3.1"><a class="xref" href="#section-4.3.3">4.3.3</a>.  <a class="xref" href="#name-path-sequence-in-the-dco">Path Sequence in the DCO</a></p>
</li>
                  <li class="compact toc ulEmpty" id="section-toc.1-1.4.2.3.2.4">
                    <p id="section-toc.1-1.4.2.3.2.4.1"><a class="xref" href="#section-4.3.4">4.3.4</a>.  <a class="xref" href="#name-destination-cleanup-option-">Destination Cleanup Option Acknowledgment (DCO-ACK)</a></p>
</li>
                  <li class="compact toc ulEmpty" id="section-toc.1-1.4.2.3.2.5">
                    <p id="section-toc.1-1.4.2.3.2.5.1"><a class="xref" href="#section-4.3.5">4.3.5</a>.  <a class="xref" href="#name-secure-dco-ack">Secure DCO-ACK</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a class="xref" href="#section-4.4">4.4</a>.  <a class="xref" href="#name-dco-base-rules">DCO Base Rules</a></p>
</li>
              <li class="compact toc ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a class="xref" href="#section-4.5">4.5</a>.  <a class="xref" href="#name-unsolicited-dco">Unsolicited DCO</a></p>
</li>
              <li class="compact toc ulEmpty" id="section-toc.1-1.4.2.6">
                <p id="section-toc.1-1.4.2.6.1"><a class="xref" href="#section-4.6">4.6</a>.  <a class="xref" href="#name-other-considerations">Other Considerations</a></p>
<ul class="compact toc ulEmpty">
<li class="compact toc ulEmpty" id="section-toc.1-1.4.2.6.2.1">
                    <p id="section-toc.1-1.4.2.6.2.1.1"><a class="xref" href="#section-4.6.1">4.6.1</a>.  <a class="xref" href="#name-invalidation-of-dependent-n">Invalidation of Dependent Nodes</a></p>
</li>
                  <li class="compact toc ulEmpty" id="section-toc.1-1.4.2.6.2.2">
                    <p id="section-toc.1-1.4.2.6.2.2.1"><a class="xref" href="#section-4.6.2">4.6.2</a>.  <a class="xref" href="#name-npdao-and-dco-in-the-same-n">NPDAO and DCO in the Same Network</a></p>
</li>
                  <li class="compact toc ulEmpty" id="section-toc.1-1.4.2.6.2.3">
                    <p id="section-toc.1-1.4.2.6.2.3.1"><a class="xref" href="#section-4.6.3">4.6.3</a>.  <a class="xref" href="#name-considerations-for-dco-retr">Considerations for DCO Retries</a></p>
</li>
                  <li class="compact toc ulEmpty" id="section-toc.1-1.4.2.6.2.4">
                    <p id="section-toc.1-1.4.2.6.2.4.1"><a class="xref" href="#section-4.6.4">4.6.4</a>.  <a class="xref" href="#name-dco-with-multiple-preferred">DCO with Multiple Preferred Parents</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a class="xref" href="#section-5">5</a>.  <a class="xref" href="#name-iana-considerations">IANA Considerations</a></p>
<ul class="compact toc ulEmpty">
<li class="compact toc ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a class="xref" href="#section-5.1">5.1</a>.  <a class="xref" href="#name-new-registry-for-the-destin">New Registry for the Destination Cleanup Object (DCO) Flags</a></p>
</li>
              <li class="compact toc ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a class="xref" href="#section-5.2">5.2</a>.  <a class="xref" href="#name-new-registry-for-the-destina">New Registry for the Destination Cleanup Object (DCO) Acknowledgment Flags</a></p>
</li>
              <li class="compact toc ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a class="xref" href="#section-5.3">5.3</a>.  <a class="xref" href="#name-rpl-rejection-status-values">RPL Rejection Status Values</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a class="xref" href="#section-6">6</a>.  <a class="xref" href="#name-security-considerations">Security Considerations</a></p>
</li>
          <li class="compact toc ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a class="xref" href="#section-7">7</a>.  <a class="xref" href="#name-normative-references">Normative References</a></p>
</li>
          <li class="compact toc ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a class="xref" href="#section-appendix.a">Appendix A</a>.  <a class="xref" href="#name-example-messaging">Example Messaging</a></p>
<ul class="compact toc ulEmpty">
<li class="compact toc ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a class="xref" href="#section-a.1">A.1</a>.  <a class="xref" href="#name-example-dco-messaging">Example DCO Messaging</a></p>
</li>
              <li class="compact toc ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a class="xref" href="#section-a.2">A.2</a>.  <a class="xref" href="#name-example-dco-messaging-with-">Example DCO Messaging with Multiple Preferred Parents</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a class="xref" href="#section-appendix.b"></a><a class="xref" href="#name-acknowledgments">Acknowledgments</a></p>
</li>
          <li class="compact toc ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a class="xref" href="#section-appendix.c"></a><a class="xref" href="#name-authors-addresses">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<section id="section-1">
      <h2 id="name-introduction">
<a class="section-number selfRef" href="#section-1">1. </a><a class="section-name selfRef" href="#name-introduction">Introduction</a>
      </h2>
<p id="section-1-1">
            RPL (the Routing Protocol for Low-Power and Lossy Networks) as defined in
            <span>[<a class="xref" href="#RFC6550">RFC6550</a>]</span>
            specifies a proactive distance-vector-based routing
            scheme. RPL has optional messaging in the form of DAO
            (Destination Advertisement Object) messages, which the 6LBR (6LoWPAN Border Router) and 6LR (6LoWPAN Router) can use to learn a route
            towards the downstream nodes. ("6LoWPAN" stands for "IPv6 over Low-Power Wireless Personal Area Network".) In Storing mode, DAO messages would
            result in routing entries being created on all intermediate 6LRs
            from a node's parent all the way towards the 6LBR.<a class="pilcrow" href="#section-1-1">¶</a></p>
<p id="section-1-2">
            RPL allows the use of No-Path DAO (NPDAO) messaging to invalidate a
            routing path corresponding to the given target, thus releasing
            resources utilized on that path. An NPDAO is a DAO message with a
            route lifetime of zero.  It originates at the target node and always
            flows upstream towards the 6LBR. This document explains the
            problems associated with the use of NPDAO messaging in <span>[<a class="xref" href="#RFC6550">RFC6550</a>]</span> and
            also discusses the requirements for an optimized route invalidation
            messaging scheme. Further, this document specifies a new proactive route invalidation
            message called the "Destination Cleanup Object" (DCO),
            which fulfills requirements for optimized route invalidation
            messaging.<a class="pilcrow" href="#section-1-2">¶</a></p>
<p id="section-1-3">
            This document only caters to RPL's Storing Mode of Operation
            (MOP). The Non-Storing MOP does not require the use of an NPDAO for route
            invalidation, since routing entries are not maintained on 6LRs.<a class="pilcrow" href="#section-1-3">¶</a></p>
<section id="section-1.1">
        <h3 id="name-requirements-language-and-t">
<a class="section-number selfRef" href="#section-1.1">1.1. </a><a class="section-name selfRef" href="#name-requirements-language-and-t">Requirements Language and Terminology</a>
        </h3>
<p id="section-1.1-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>",
        "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>",
        "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>",
        "<span class="bcp14">SHOULD NOT</span>",
        "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
        "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document
        are to be interpreted as described in BCP 14
        <span>[<a class="xref" href="#RFC2119">RFC2119</a>]</span> <span>[<a class="xref" href="#RFC8174">RFC8174</a>]</span> when, and only
        when, they appear in all capitals, as shown here.<a class="pilcrow" href="#section-1.1-1">¶</a></p>
<p id="section-1.1-2">
                This specification requires readers to be familiar with all the
                terms and concepts that are discussed in "RPL: IPv6 Routing
                Protocol for Low-Power and Lossy Networks" <span>[<a class="xref" href="#RFC6550">RFC6550</a>]</span>.<a class="pilcrow" href="#section-1.1-2">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-1.1-3">
          <dt id="section-1.1-3.1">Low-Power and Lossy Network (LLN):</dt>
          <dd id="section-1.1-3.2" style="margin-left: 1.5em">
              A network in which both the routers and their
              interconnects are constrained. LLN routers typically
              operate with constraints on processing power, memory,
              and energy (battery power). Their interconnects are
              characterized by high loss rates, low data rates, and
              instability.<a class="pilcrow" href="#section-1.1-3.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-3.3">6LoWPAN Router (6LR):</dt>
          <dd id="section-1.1-3.4" style="margin-left: 1.5em">
              An intermediate router that is able to send and receive Router
              Advertisements (RAs) and Router Solicitations (RSs) as well as
              forward and route IPv6 packets.<a class="pilcrow" href="#section-1.1-3.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-3.5">Directed Acyclic Graph (DAG):</dt>
          <dd id="section-1.1-3.6" style="margin-left: 1.5em">
              A directed graph having the property that all edges are
              oriented in such a way that no cycles exist.<a class="pilcrow" href="#section-1.1-3.6">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-3.7">Destination-Oriented DAG (DODAG):</dt>
          <dd id="section-1.1-3.8" style="margin-left: 1.5em">
              A DAG rooted at a single destination, i.e., at a single
              DAG root with no outgoing edges.<a class="pilcrow" href="#section-1.1-3.8">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-3.9">6LoWPAN Border Router (6LBR):</dt>
          <dd id="section-1.1-3.10" style="margin-left: 1.5em">
              A border router that is a DODAG root and is the edge
              node for traffic flowing in and out of the 6LoWPAN.<a class="pilcrow" href="#section-1.1-3.10">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-3.11">Destination Advertisement Object (DAO):</dt>
          <dd id="section-1.1-3.12" style="margin-left: 1.5em">
              DAO messaging allows downstream routes to the nodes to
              be established.<a class="pilcrow" href="#section-1.1-3.12">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-3.13">DODAG Information Object (DIO):</dt>
          <dd id="section-1.1-3.14" style="margin-left: 1.5em">
              DIO messaging allows upstream routes to the 6LBR to be
              established. DIO messaging is initiated at the DAO
              root.<a class="pilcrow" href="#section-1.1-3.14">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-3.15">Common ancestor node:</dt>
          <dd id="section-1.1-3.16" style="margin-left: 1.5em">
              A 6LR/6LBR node that is the first common node between
              two paths of a target node.<a class="pilcrow" href="#section-1.1-3.16">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-3.17">No-Path DAO (NPDAO):</dt>
          <dd id="section-1.1-3.18" style="margin-left: 1.5em">
              A DAO message that has a target with a lifetime of 0. Used for
              the purpose of route invalidation.<a class="pilcrow" href="#section-1.1-3.18">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-3.19">Destination Cleanup Object (DCO):</dt>
          <dd id="section-1.1-3.20" style="margin-left: 1.5em">
              A new RPL control message code defined by this
              document. DCO messaging improves proactive route
              invalidation in RPL.<a class="pilcrow" href="#section-1.1-3.20">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-3.21">Regular DAO:</dt>
          <dd id="section-1.1-3.22" style="margin-left: 1.5em">
              A DAO message with a non-zero lifetime. Routing
              adjacencies are created or updated based on this
              message.<a class="pilcrow" href="#section-1.1-3.22">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-3.23">Target node:</dt>
          <dd id="section-1.1-3.24" style="margin-left: 1.5em">
              The node switching its parent whose routing adjacencies
              are updated (created/removed).<a class="pilcrow" href="#section-1.1-3.24">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
<div id="current_npdao">
<section id="section-1.2">
        <h3 id="name-rpl-npdao-messaging">
<a class="section-number selfRef" href="#section-1.2">1.2. </a><a class="section-name selfRef" href="#name-rpl-npdao-messaging">RPL NPDAO Messaging</a>
        </h3>
<p id="section-1.2-1">
                RPL uses NPDAO messaging in Storing mode so that the node
                changing its routing adjacencies can invalidate the previous
                route. This is needed so that nodes along the previous path can
                release any resources (such as the routing entry) they maintain
                on behalf of the target node.<a class="pilcrow" href="#section-1.2-1">¶</a></p>
<p id="section-1.2-2">
        Throughout this document, we will refer to the topology shown in <a class="xref" href="#sample_top">Figure 1</a>:<a class="pilcrow" href="#section-1.2-2">¶</a></p>
<span id="name-sample-topology"></span><div id="sample_top">
<figure id="figure-1">
          <div class="artwork art-text alignCenter" id="section-1.2-3.1">
<pre>   (6LBR)
     |
     |
     |
    (A)
    / \
   /   \
  /     \
(G)     (H)
 |       |
 |       |
 |       |
(B)     (C)
  \      ;
   \    ;
    \  ;
     (D)
     / \
    /   \
   /     \
 (E)     (F)</pre>
</div>
<figcaption><a class="selfRef" href="#figure-1">Figure 1</a>:
<a class="selfRef" href="#name-sample-topology">Sample Topology</a>
          </figcaption></figure>
</div>
<p id="section-1.2-4">
                Node D is connected via preferred parent B. D has an
                alternate path via C towards the 6LBR. Node A is the common
                ancestor for D for paths through B-G and C-H. When
                D switches from B to C, RPL allows sending an NPDAO to B
                and a regular DAO to C.<a class="pilcrow" href="#section-1.2-4">¶</a></p>
</section>
</div>
<section id="section-1.3">
        <h3 id="name-why-is-npdao-messaging-impo">
<a class="section-number selfRef" href="#section-1.3">1.3. </a><a class="section-name selfRef" href="#name-why-is-npdao-messaging-impo">Why Is NPDAO Messaging Important?</a>
        </h3>
<p id="section-1.3-1">
                Resources in LLN nodes are typically constrained. There is limited
                memory available, and routing entry records are one of the
                primary elements occupying dynamic memory in the nodes. Route
                invalidation helps 6LR nodes to decide which routing entries can be
                discarded for better use of the limited resources. Thus, it
                becomes necessary to have an efficient route invalidation
                mechanism. Also note that a single parent switch may result in
                a "subtree" switching from one parent to another. Thus, the
                route invalidation needs to be done on behalf of the subtree
                and not the switching node alone. In the above example, when
                Node D switches its parent, route updates need to be done
                for the routing table entries of C, H, A, G, and B with
                destinations D, E, and F. Without efficient route
                invalidation, a 6LR may have to hold a lot of stale route
                entries.<a class="pilcrow" href="#section-1.3-1">¶</a></p>
</section>
</section>
<div id="current_npdao_problems">
<section id="section-2">
      <h2 id="name-problems-with-the-rpl-npdao">
<a class="section-number selfRef" href="#section-2">2. </a><a class="section-name selfRef" href="#name-problems-with-the-rpl-npdao">Problems with the RPL NPDAO Messaging</a>
      </h2>
<section id="section-2.1">
        <h3 id="name-lost-npdao-due-to-link-brea">
<a class="section-number selfRef" href="#section-2.1">2.1. </a><a class="section-name selfRef" href="#name-lost-npdao-due-to-link-brea">Lost NPDAO Due to Link Break to the Previous Parent</a>
        </h3>
<p id="section-2.1-1">
                When a node switches its parent, the NPDAO is to be sent to
                its previous parent and a regular DAO to its new parent. In
                cases where the node switches its parent because of transient
                or permanent parent link/node failure, the NPDAO message may
                not be received by the parent.<a class="pilcrow" href="#section-2.1-1">¶</a></p>
</section>
<section id="section-2.2">
        <h3 id="name-invalidating-routes-of-depe">
<a class="section-number selfRef" href="#section-2.2">2.2. </a><a class="section-name selfRef" href="#name-invalidating-routes-of-depe">Invalidating Routes of Dependent Nodes</a>
        </h3>
<p id="section-2.2-1">
                RPL does not specify how route invalidation will work for
                dependent nodes in the switching node subDAG, resulting in
                stale routing entries of the dependent nodes. The only way for a
                6LR to invalidate the route entries for dependent nodes would
                be to use route lifetime expiry, which could be substantially
                high for LLNs.<a class="pilcrow" href="#section-2.2-1">¶</a></p>
<p id="section-2.2-2">
                In the example topology, when Node D switches its parent,
                Node D generates an NPDAO on its own behalf. There is no NPDAO
                generated by the dependent child Nodes E and F, through the
                previous path via D to B and G, resulting in stale
                entries on Nodes B and G for Nodes E and F.<a class="pilcrow" href="#section-2.2-2">¶</a></p>
</section>
<section id="section-2.3">
        <h3 id="name-possible-route-downtime-cau">
<a class="section-number selfRef" href="#section-2.3">2.3. </a><a class="section-name selfRef" href="#name-possible-route-downtime-cau">Possible Route Downtime Caused by Asynchronous Operation of the NPDAO and DAO</a>
        </h3>
<p id="section-2.3-1">
                A switching node may generate both an NPDAO and a DAO via two
                different paths at almost the same time. It is possible
                that the NPDAO may invalidate the previous route and
                the regular DAO sent via the new path gets lost on the way.
                This may result in route downtime, impacting downward
                traffic for the switching node.<a class="pilcrow" href="#section-2.3-1">¶</a></p>
<p id="section-2.3-2">
                In the example topology, say that Node D switches from parent
                B to C. An NPDAO sent via the previous route may invalidate
                the previous route, whereas there is no way to determine whether
                the new DAO has successfully updated the route entries on the
                new path.<a class="pilcrow" href="#section-2.3-2">¶</a></p>
</section>
</section>
</div>
<div id="requirements">
<section id="section-3">
      <h2 id="name-requirements-for-npdao-opti">
<a class="section-number selfRef" href="#section-3">3. </a><a class="section-name selfRef" href="#name-requirements-for-npdao-opti">Requirements for NPDAO Optimization</a>
      </h2>
<section id="section-3.1">
        <h3 id="name-req-1-remove-messaging-depe">
<a class="section-number selfRef" href="#section-3.1">3.1. </a><a class="section-name selfRef" href="#name-req-1-remove-messaging-depe">Req. #1: Remove Messaging Dependency on the Link to the Previous  Parent</a>
        </h3>
<p id="section-3.1-1">
                When the switching node sends the NPDAO message to the previous
                parent, it is normal that the link to the previous parent is
                prone to failure (that's why the node decided to switch).
                Therefore, it is required that the route invalidation does not
                depend on the previous link, which is prone to failure. The
                previous link referred to here represents the link between the
                node and its previous parent (from which the node is now
                disassociating).<a class="pilcrow" href="#section-3.1-1">¶</a></p>
</section>
<section id="section-3.2">
        <h3 id="name-req-2-route-invalidation-fo">
<a class="section-number selfRef" href="#section-3.2">3.2. </a><a class="section-name selfRef" href="#name-req-2-route-invalidation-fo">Req. #2: Route Invalidation for Dependent Nodes at the Parent Switching Node</a>
        </h3>
<p id="section-3.2-1">
                It should be possible to do route invalidation for dependent
                nodes rooted at the switching node.<a class="pilcrow" href="#section-3.2-1">¶</a></p>
</section>
<section id="section-3.3">
        <h3 id="name-req-3-route-invalidation-sh">
<a class="section-number selfRef" href="#section-3.3">3.3. </a><a class="section-name selfRef" href="#name-req-3-route-invalidation-sh">Req. #3: Route Invalidation Should Not Impact Data Traffic</a>
        </h3>
<p id="section-3.3-1">
                While sending the NPDAO and DAO messages, it is possible that
                the NPDAO successfully invalidates the previous path, while the
                newly sent DAO gets lost (new path not set up successfully).
                This will result in downstream unreachability to the node
                switching paths. Therefore, it is desirable that the route
                invalidation is synchronized with the DAO to avoid the risk of
                route downtime.<a class="pilcrow" href="#section-3.3-1">¶</a></p>
</section>
</section>
</div>
<section id="section-4">
      <h2 id="name-changes-to-rpl-signaling">
<a class="section-number selfRef" href="#section-4">4. </a><a class="section-name selfRef" href="#name-changes-to-rpl-signaling">Changes to RPL Signaling</a>
      </h2>
<section id="section-4.1">
        <h3 id="name-change-in-rpl-route-invalid">
<a class="section-number selfRef" href="#section-4.1">4.1. </a><a class="section-name selfRef" href="#name-change-in-rpl-route-invalid">Change in RPL Route Invalidation Semantics</a>
        </h3>
<p id="section-4.1-1">
                As described in <a class="xref" href="#current_npdao">Section 1.2</a>, the NPDAO
                originates at the node changing to a new parent and traverses
                upstream towards the root. In order to solve the problems
                discussed in <a class="xref" href="#current_npdao_problems">Section 2</a>, this
                document adds a new proactive route invalidation message
                called the "Destination Cleanup Object" (DCO), which originates at a
                common ancestor node and flows downstream the
                old path. The common ancestor node generates a DCO when removing
                a next hop to a target -- for instance, as a delayed response to
                receiving a regular DAO from another child node with a Path
                Sequence for the target that is the same or newer, in which case the DCO transmission is canceled.<a class="pilcrow" href="#section-4.1-1">¶</a></p>
<p id="section-4.1-2">
                The 6LRs in the path for the DCO take such action as route
                invalidation based on the DCO information and subsequently send
                another DCO with the same information downstream to the next
                hop(s). This operation is similar to how the DAOs are handled on
                intermediate 6LRs in the Storing MOP <span>[<a class="xref" href="#RFC6550">RFC6550</a>]</span>.
                Just like the DAO in the Storing MOP, the DCO is sent using link-local
                unicast source and destination IPv6 addresses. Unlike the DAO, which
                always travels upstream, the DCO always travels downstream.<a class="pilcrow" href="#section-4.1-2">¶</a></p>
<p id="section-4.1-3">
                In <a class="xref" href="#sample_top">Figure 1</a>, when child Node D decides to
                switch the path from parent B to parent C, it sends a regular DAO to Node C
                with reachability information containing the address of D as
                the target and an incremented Path Sequence. Node C will update
                the routing table based on the reachability information in the
                DAO and will in turn generate another DAO with the same reachability
                information and forward it to H. Node H recursively follows the same
                procedure as Node C and forwards it to Node A. When Node A
                receives the regular DAO, it finds that it already has a
                routing table entry on behalf of the Target Address of Node D.
                It finds, however, that the next-hop information for reaching
                Node D has changed, i.e., Node D has decided to change the
                paths. In this case, Node A, which is the common ancestor node
                for Node D along the two paths (previous and new), can
                generate a DCO that traverses the network downwards over the
                old path to the target. Node A handles normal DAO forwarding to
                the 6LBR as required by <span>[<a class="xref" href="#RFC6550">RFC6550</a>]</span>.<a class="pilcrow" href="#section-4.1-3">¶</a></p>
</section>
<div id="transit_opt_changes">
<section id="section-4.2">
        <h3 id="name-transit-information-option-">
<a class="section-number selfRef" href="#section-4.2">4.2. </a><a class="section-name selfRef" href="#name-transit-information-option-">Transit Information Option Changes</a>
        </h3>
<p id="section-4.2-1">
                Every RPL message is divided into base message fields and
                additional options, as described in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc6550#section-6">Section 6</a> of [<a class="xref" href="#RFC6550">RFC6550</a>]</span>. The base fields apply to the message as a
                whole, and options are appended to add message-specific /
                use-case-specific
                attributes. As an example, a DAO message may be attributed by
                one or more "RPL Target" options that specify that the reachability
                information is for the given targets. Similarly, a Transit
                Information option may be associated with a set of RPL Target
                options.<a class="pilcrow" href="#section-4.2-1">¶</a></p>
<p id="section-4.2-2">
                This document specifies a change in the Transit Information option to
                contain the "Invalidate previous route" (I) flag. This 'I' flag signals
                the common ancestor node to generate a DCO on behalf of the
                target node with a RPL Status of 195, indicating that the address
                has moved. The 'I' flag is carried in the Transit Information
                option, which augments the reachability information for a given
                set of one or more RPL Targets. A Transit Information option with the 'I' flag
                set should be carried in the DAO message when route
                invalidation is sought for the corresponding target or targets.<a class="pilcrow" href="#section-4.2-2">¶</a></p>
<p id="section-4.2-3">
                Value 195 represents the 'U' and 'A' bits in RPL Status, to be set as
                per Figure 6 of <span>[<a class="xref" href="#RFC9010">RFC9010</a>]</span>,
                with the lower 6 bits set to the 6LoWPAN Neighbor Discovery (ND)
                Extended Address Registration Option (EARO) Status value of 3
                indicating 'Moved' as per Table 1 of <span>[<a class="xref" href="#RFC8505">RFC8505</a>]</span>.<a class="pilcrow" href="#section-4.2-3">¶</a></p>
<span id="name-updated-transit-information"></span><div id="transit_info_with_i">
<figure id="figure-2">
          <div class="artwork art-text alignCenter" id="section-4.2-4.1">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Type = 0x06 | Option Length |E|I|  Flags    | Path Control  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Path Sequence | Path Lifetime |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</pre>
</div>
<figcaption><a class="selfRef" href="#figure-2">Figure 2</a>:
<a class="selfRef" href="#name-updated-transit-information">Updated Transit Information Option (New 'I' Flag Added)</a>
          </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4.2-5">
          <dt id="section-4.2-5.1">I (Invalidate previous route) flag:</dt>
          <dd id="section-4.2-5.2" style="margin-left: 1.5em">The 'I' flag is set by the
                target node to indicate to the common ancestor node that it
                wishes to invalidate any previous route between the two paths.<a class="pilcrow" href="#section-4.2-5.2">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.2-6">
                <span>[<a class="xref" href="#RFC6550">RFC6550</a>]</span> allows the parent address to be sent in
                the Transit Information option, depending on the MOP.
                In the case of the Storing MOP, the field is
                usually not needed. In the case of a DCO, the Parent Address field
                <span class="bcp14">MUST NOT</span> be included.<a class="pilcrow" href="#section-4.2-6">¶</a></p>
<p id="section-4.2-7">
                Upon receiving a DAO message with a Transit Information option that has the 'I' flag set,
                and as a delayed response removing a routing adjacency to the target indicated in the Transit Information option,
                the common ancestor node <span class="bcp14">SHOULD</span> generate a DCO message
                to the next hop associated to that adjacency. The 'I' flag is
                intended to give the target node control over its own route
                invalidation, serving as a signal to request DCO generation.<a class="pilcrow" href="#section-4.2-7">¶</a></p>
</section>
</div>
<section id="section-4.3">
        <h3 id="name-destination-cleanup-object-">
<a class="section-number selfRef" href="#section-4.3">4.3. </a><a class="section-name selfRef" href="#name-destination-cleanup-object-">Destination Cleanup Object (DCO)</a>
        </h3>
<p id="section-4.3-1">
                A new ICMPv6 RPL control message code is defined by this
                specification and is referred to as the "Destination Cleanup Object"
                (DCO), which is used for proactive cleanup of state and routing
                information held on behalf of the target node by 6LRs. The DCO
                message always traverses downstream and cleans up route
                information and other state information associated with the
                given target.  The format of the DCO message is shown in
                <a class="xref" href="#dco_obj">Figure 3</a>.<a class="pilcrow" href="#section-4.3-1">¶</a></p>
<span id="name-dco-base-object"></span><div id="dco_obj">
<figure id="figure-3">
          <div class="artwork art-text alignCenter" id="section-4.3-2.1">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| RPLInstanceID |K|D|   Flags   |   RPL Status  | DCOSequence   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
+                                                               +
|                                                               |
+                      DODAGID (optional)                       +
|                                                               |
+                                                               +
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Option(s)...
+-+-+-+-+-+-+-+-+</pre>
</div>
<figcaption><a class="selfRef" href="#figure-3">Figure 3</a>:
<a class="selfRef" href="#name-dco-base-object">DCO Base Object</a>
          </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4.3-3">
          <dt id="section-4.3-3.1"> RPLInstanceID:</dt>
          <dd id="section-4.3-3.2" style="margin-left: 1.5em">8-bit field indicating the topology instance
                associated with the DODAG, as learned from the DIO.<a class="pilcrow" href="#section-4.3-3.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.3-3.3">
                K:</dt>
          <dd id="section-4.3-3.4" style="margin-left: 1.5em">The 'K' flag indicates that the recipient of a DCO message is
                expected to send a DCO-ACK back. If the DCO-ACK is not received
                even after setting the 'K' flag, an implementation may retry
                the DCO at a later time. The number of retries is
                implementation and deployment dependent and is expected to be
                kept similar to the number of DAO retries <span>[<a class="xref" href="#RFC6550">RFC6550</a>]</span>. <a class="xref" href="#dco_retry">Section 4.6.3</a> specifies
                the considerations for DCO retries. A node receiving a DCO
                message without the 'K' flag set <span class="bcp14">MAY</span> respond with a DCO-ACK,
                especially to report an error condition. An example error
                condition could be that the node sending the DCO-ACK does not
                find the routing entry for the indicated target. When the
                sender does not set the 'K' flag, it is an indication that the
                sender does not expect a response, and the sender <span class="bcp14">SHOULD NOT</span>
                retry the DCO.<a class="pilcrow" href="#section-4.3-3.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.3-3.5">
                D:</dt>
          <dd id="section-4.3-3.6" style="margin-left: 1.5em">The 'D' flag indicates that the DODAGID field is present.
                This flag <span class="bcp14">MUST</span> be set when a local RPLInstanceID is used.<a class="pilcrow" href="#section-4.3-3.6">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.3-3.7">
                Flags:</dt>
          <dd id="section-4.3-3.8" style="margin-left: 1.5em">The 6 bits remaining unused in the Flags field are
                reserved for future use. These bits <span class="bcp14">MUST</span> be initialized to zero by
                the sender and <span class="bcp14">MUST</span> be ignored by the receiver.<a class="pilcrow" href="#section-4.3-3.8">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.3-3.9">
                RPL Status:</dt>
          <dd id="section-4.3-3.10" style="margin-left: 1.5em">As defined in <span>[<a class="xref" href="#RFC6550">RFC6550</a>]</span> and updated
                in <span>[<a class="xref" href="#RFC9010">RFC9010</a>]</span>. The root or
                common parent that generates a DCO is authoritative for setting
                the status information, and the information is unchanged as
                propagated down the DODAG. This document does not specify a
                differentiated action based on the RPL Status.<a class="pilcrow" href="#section-4.3-3.10">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.3-3.11">
                DCOSequence:</dt>
          <dd id="section-4.3-3.12" style="margin-left: 1.5em">8-bit field incremented at each unique DCO message
                from a node and echoed in the DCO-ACK message. The initial
                DCOSequence can be chosen randomly by the node. <a class="xref" href="#base_rules">Section 4.4</a> explains the handling of the
                DCOSequence.<a class="pilcrow" href="#section-4.3-3.12">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.3-3.13">
                DODAGID (optional):</dt>
          <dd id="section-4.3-3.14" style="margin-left: 1.5em">128-bit unsigned integer set by a DODAG
                root that uniquely identifies a DODAG. This field <span class="bcp14">MUST</span> be
                present when the 'D' flag is set and <span class="bcp14">MUST NOT</span> be present if the 'D'
                flag is not set. The DODAGID is used when a local RPLInstanceID is
                in use, in order to identify the DODAGID that is associated
                with the RPLInstanceID.<a class="pilcrow" href="#section-4.3-3.14">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<section id="section-4.3.1">
          <h4 id="name-secure-dco">
<a class="section-number selfRef" href="#section-4.3.1">4.3.1. </a><a class="section-name selfRef" href="#name-secure-dco">Secure DCO</a>
          </h4>
<p id="section-4.3.1-1">
          A Secure DCO message follows the format shown in <span>[<a class="xref" href="#RFC6550">RFC6550</a>]</span>, Figure 7, where the base message
          format is the DCO message shown in <a class="xref" href="#dco_obj">Figure 3</a>
          of this document.<a class="pilcrow" href="#section-4.3.1-1">¶</a></p>
</section>
<section id="section-4.3.2">
          <h4 id="name-dco-options">
<a class="section-number selfRef" href="#section-4.3.2">4.3.2. </a><a class="section-name selfRef" href="#name-dco-options">DCO Options</a>
          </h4>
<p id="section-4.3.2-1">
          The DCO message <span class="bcp14">MUST</span> carry at least one RPL Target and the
          Transit Information option and <span class="bcp14">MAY</span> carry other valid
          options. This specification allows for the DCO message to
          carry the following options:<a class="pilcrow" href="#section-4.3.2-1">¶</a></p>
<span class="break"></span><dl class="dlParallel dlCompact" id="section-4.3.2-2">
            <dt id="section-4.3.2-2.1">0x00</dt>
            <dd id="section-4.3.2-2.2" style="margin-left: 1.5em">Pad1<a class="pilcrow" href="#section-4.3.2-2.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.2-2.3">0x01</dt>
            <dd id="section-4.3.2-2.4" style="margin-left: 1.5em">PadN<a class="pilcrow" href="#section-4.3.2-2.4">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.2-2.5">0x05</dt>
            <dd id="section-4.3.2-2.6" style="margin-left: 1.5em">RPL Target<a class="pilcrow" href="#section-4.3.2-2.6">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.2-2.7">0x06</dt>
            <dd id="section-4.3.2-2.8" style="margin-left: 1.5em">Transit Information<a class="pilcrow" href="#section-4.3.2-2.8">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.2-2.9">0x09</dt>
            <dd id="section-4.3.2-2.10" style="margin-left: 1.5em">RPL Target Descriptor<a class="pilcrow" href="#section-4.3.2-2.10">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-4.3.2-3">
          <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc6550#section-6.7">Section 6.7</a> of [<a class="xref" href="#RFC6550">RFC6550</a>]</span> defines all the
          above-mentioned options. The DCO carries a RPL Target
          option and an associated Transit Information option with a
          lifetime of 0x00000000 to indicate a loss of reachability
          to that target.<a class="pilcrow" href="#section-4.3.2-3">¶</a></p>
</section>
<section id="section-4.3.3">
          <h4 id="name-path-sequence-in-the-dco">
<a class="section-number selfRef" href="#section-4.3.3">4.3.3. </a><a class="section-name selfRef" href="#name-path-sequence-in-the-dco">Path Sequence in the DCO</a>
          </h4>
<p id="section-4.3.3-1">
          A DCO message includes a Transit Information option for each invalidated path.
          The value of the Path Sequence counter in the Transit Information option allows identification of the freshness of the DCO
          message versus the newest known to the 6LRs along the path being removed.
          If the DCO is generated by a common parent in response to a DAO message, then the Transit Information option in
          the DCO <span class="bcp14">MUST</span> use the value of the Path Sequence as found
          in the newest Transit Information option that was received for that target by the common parent.
          If a 6LR down the path receives a DCO with a Path Sequence that is not newer than
          the Path Sequence as known from a Transit Information option in a DAO message, then the 6LR
          <span class="bcp14">MUST NOT</span> remove its current routing state, and it <span class="bcp14">MUST NOT</span> forward the DCO
          down a path where it is not newer. If the DCO is newer, the 6LR may
          retain a temporary state to ensure that a DAO that is received later
          with a Transit Information option with an older sequence number is ignored. A Transit Information option in a DAO message
          that is as new as or newer than that in a DCO wins, meaning that the path indicated in the DAO is installed and the DAO is propagated. When the DCO is propagated upon a
          DCO from an upstream parent, the Path Sequence <span class="bcp14">MUST</span> be copied
          from the received DCO.<a class="pilcrow" href="#section-4.3.3-1">¶</a></p>
</section>
<section id="section-4.3.4">
          <h4 id="name-destination-cleanup-option-">
<a class="section-number selfRef" href="#section-4.3.4">4.3.4. </a><a class="section-name selfRef" href="#name-destination-cleanup-option-">Destination Cleanup Option Acknowledgment (DCO-ACK)</a>
          </h4>
<p id="section-4.3.4-1">
          The DCO-ACK message <span class="bcp14">SHOULD</span> be sent as a unicast packet by a
          DCO recipient in response to a unicast DCO message with the 'K'
          flag set. If the 'K' flag is not set, then the receiver of the
          DCO message <span class="bcp14">MAY</span> send a DCO-ACK, especially to report an error
          condition. The format of the DCO-ACK message is shown in
          <a class="xref" href="#dco_ack">Figure 4</a>.<a class="pilcrow" href="#section-4.3.4-1">¶</a></p>
<span id="name-dco-ack-base-object"></span><div id="dco_ack">
<figure id="figure-4">
            <div class="artwork art-text alignCenter" id="section-4.3.4-2.1">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| RPLInstanceID |D|   Flags     |  DCOSequence  | DCO-ACK Status|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
+                                                               +
|                                                               |
+                      DODAGID (optional)                       +
|                                                               |
+                                                               +
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</pre>
</div>
<figcaption><a class="selfRef" href="#figure-4">Figure 4</a>:
<a class="selfRef" href="#name-dco-ack-base-object">DCO-ACK Base Object</a>
            </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4.3.4-3">
            <dt id="section-4.3.4-3.1">
          RPLInstanceID:</dt>
            <dd id="section-4.3.4-3.2" style="margin-left: 1.5em">8-bit field indicating the topology instance
          associated with the DODAG, as learned from the DIO.<a class="pilcrow" href="#section-4.3.4-3.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.4-3.3">
          D:</dt>
            <dd id="section-4.3.4-3.4" style="margin-left: 1.5em">The 'D' flag indicates that the DODAGID field is present.
          This flag <span class="bcp14">MUST</span> be set when a local RPLInstanceID is used.<a class="pilcrow" href="#section-4.3.4-3.4">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.4-3.5">
          Flags:</dt>
            <dd id="section-4.3.4-3.6" style="margin-left: 1.5em">7-bit unused field. The field <span class="bcp14">MUST</span> be initialized to
          zero by the sender and <span class="bcp14">MUST</span> be ignored by the receiver.<a class="pilcrow" href="#section-4.3.4-3.6">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.4-3.7">
          DCOSequence:</dt>
            <dd id="section-4.3.4-3.8" style="margin-left: 1.5em">8-bit field. The DCOSequence in the DCO-ACK is
          copied from the DCOSequence received in the DCO message.<a class="pilcrow" href="#section-4.3.4-3.8">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.4-3.9">
          DCO-ACK Status:</dt>
            <dd id="section-4.3.4-3.10" style="margin-left: 1.5em">Indicates completion status. The DCO-ACK Status field is defined based on Figure 6 of <span>[<a class="xref" href="#RFC9010">RFC9010</a>]</span> defining the RPL Status Format. A StatusValue of 0 along with the 'U' bit set to 0 indicates Success / Unqualified acceptance as per Figure 6 of <span>[<a class="xref" href="#RFC9010">RFC9010</a>]</span>. A StatusValue of 1 with the 'U' bit set to 1 indicates 'No routing entry' as defined in <a class="xref" href="#rpl_reject_status">Section 5.3</a> of this document.<a class="pilcrow" href="#section-4.3.4-3.10">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.4-3.11">
          DODAGID (optional):</dt>
            <dd id="section-4.3.4-3.12" style="margin-left: 1.5em">128-bit unsigned integer set by a DODAG
          root that uniquely identifies a DODAG. This field <span class="bcp14">MUST</span> be
          present when the 'D' flag is set and <span class="bcp14">MUST NOT</span> be present
          when the 'D' flag is not set. The DODAGID is used when a local
          RPLInstanceID is in use, in order to identify the DODAGID
          that is associated with the RPLInstanceID.<a class="pilcrow" href="#section-4.3.4-3.12">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
<section id="section-4.3.5">
          <h4 id="name-secure-dco-ack">
<a class="section-number selfRef" href="#section-4.3.5">4.3.5. </a><a class="section-name selfRef" href="#name-secure-dco-ack">Secure DCO-ACK</a>
          </h4>
<p id="section-4.3.5-1">
          A Secure DCO-ACK message follows the format shown in <span>[<a class="xref" href="#RFC6550">RFC6550</a>]</span>, Figure 7, where the base message
          format is the DCO-ACK message shown in <a class="xref" href="#dco_ack">Figure 4</a> of this document.<a class="pilcrow" href="#section-4.3.5-1">¶</a></p>
</section>
</section>
<div id="base_rules">
<section id="section-4.4">
        <h3 id="name-dco-base-rules">
<a class="section-number selfRef" href="#section-4.4">4.4. </a><a class="section-name selfRef" href="#name-dco-base-rules">DCO Base Rules</a>
        </h3>
<ol class="normal type-1" id="section-4.4-1" start="1" type="1">
<li id="section-4.4-1.1">
              If a node sends a DCO message with newer or different
              information than the prior DCO message transmission, it
              <span class="bcp14">MUST</span> increment the DCOSequence field by at least one.
              A DCO message transmission that is identical to the
              prior DCO message transmission <span class="bcp14">MAY</span> increment the
              DCOSequence field. The DCOSequence counter follows the
              sequence counter operation as defined in
              <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc6550#section-7.2">Section 7.2</a> of [<a class="xref" href="#RFC6550">RFC6550</a>]</span>.<a class="pilcrow" href="#section-4.4-1.1">¶</a>
</li>
          <li id="section-4.4-1.2">
              The RPLInstanceID and DODAGID fields of a DCO message
              <span class="bcp14">MUST</span> have the same values as those contained in the DAO message in
              response to which the DCO is generated on the common
              ancestor node.<a class="pilcrow" href="#section-4.4-1.2">¶</a>
</li>
          <li id="section-4.4-1.3">
              A node <span class="bcp14">MAY</span> set the 'K' flag in a unicast DCO message to
              solicit a unicast DCO-ACK in response, in order to
              confirm the attempt.<a class="pilcrow" href="#section-4.4-1.3">¶</a>
</li>
          <li id="section-4.4-1.4">
              A node receiving a unicast DCO message with the 'K'
              flag set <span class="bcp14">SHOULD</span> respond with a DCO-ACK. A node
              receiving a DCO message without the 'K' flag set <span class="bcp14">MAY</span>
              respond with a DCO-ACK, especially to report an error
              condition.<a class="pilcrow" href="#section-4.4-1.4">¶</a>
</li>
          <li id="section-4.4-1.5">
              A node receiving a unicast DCO message <span class="bcp14">MUST</span> verify the
              stored Path Sequence in context to the given target. If
              the stored Path Sequence is as new as or newer than
              the Path Sequence received in the DCO, then the DCO
              <span class="bcp14">MUST</span> be dropped.<a class="pilcrow" href="#section-4.4-1.5">¶</a>
</li>
          <li id="section-4.4-1.6">
              A node that sets the 'K' flag in a unicast DCO message
              but does not receive a DCO-ACK in response <span class="bcp14">MAY</span> reschedule
              the DCO message transmission for another attempt, up
              until an implementation-specific number of retries.<a class="pilcrow" href="#section-4.4-1.6">¶</a>
</li>
          <li id="section-4.4-1.7">
              A node receiving a unicast DCO message with its own
              address in the RPL Target option <span class="bcp14">MUST</span> strip off that
              Target option. If this Target option is the only one in
              the DCO message, then the DCO message <span class="bcp14">MUST</span> be dropped.<a class="pilcrow" href="#section-4.4-1.7">¶</a>
</li>
        </ol>
<p id="section-4.4-2">
                The scope of DCOSequence values is unique to the node that
                generates them.<a class="pilcrow" href="#section-4.4-2">¶</a></p>
</section>
</div>
<section id="section-4.5">
        <h3 id="name-unsolicited-dco">
<a class="section-number selfRef" href="#section-4.5">4.5. </a><a class="section-name selfRef" href="#name-unsolicited-dco">Unsolicited DCO</a>
        </h3>
<p id="section-4.5-1">
                A 6LR may generate an unsolicited DCO to unilaterally clean up
                the path on behalf of the target entry. The 6LR has all the
                state information, namely, the Target Address and the Path
                Sequence, required for generating a DCO in its routing table.
                The conditions under which a 6LR may generate an unsolicited DCO are
                beyond the scope of this document, but possible reasons
                could be as follows:<a class="pilcrow" href="#section-4.5-1">¶</a></p>
<ol class="normal type-1" id="section-4.5-2" start="1" type="1">
<li id="section-4.5-2.1">
              On route expiry of an entry, a 6LR may decide to
              graciously clean up the entry by initiating a DCO.<a class="pilcrow" href="#section-4.5-2.1">¶</a>
</li>
          <li id="section-4.5-2.2">
              A 6LR needs to entertain higher-priority entries in case
              the routing table is full, thus resulting in eviction
              of an existing routing entry. In this case, the eviction
              can be handled graciously by using a DCO.<a class="pilcrow" href="#section-4.5-2.2">¶</a>
</li>
        </ol>
<p id="section-4.5-3">
          A DCO that is generated asynchronously to a DAO message and is meant to
          discard all state along the path regardless of the Path Sequence <span class="bcp14">MUST</span>
          use a Path Sequence value of 240 (see <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc6550#section-7.2">Section 7.2</a> of [<a class="xref" href="#RFC6550">RFC6550</a>]</span>).
          This value allows the DCO to win against any established DAO path but
          to lose against a DAO path that is being installed.
          Note that if an ancestor initiates a unilateral path cleanup on an
          established path using a DCO with a Path Sequence value of 240, the
          DCO will eventually reach the target node, which will thus be informed
          of the path invalidation.<a class="pilcrow" href="#section-4.5-3">¶</a></p>
</section>
<section id="section-4.6">
        <h3 id="name-other-considerations">
<a class="section-number selfRef" href="#section-4.6">4.6. </a><a class="section-name selfRef" href="#name-other-considerations">Other Considerations</a>
        </h3>
<section id="section-4.6.1">
          <h4 id="name-invalidation-of-dependent-n">
<a class="section-number selfRef" href="#section-4.6.1">4.6.1. </a><a class="section-name selfRef" href="#name-invalidation-of-dependent-n">Invalidation of Dependent Nodes</a>
          </h4>
<p id="section-4.6.1-1">
          The RPL specification <span>[<a class="xref" href="#RFC6550">RFC6550</a>]</span> does not provide a
          mechanism for route invalidation for dependent nodes. This
          document allows the invalidation of dependent nodes. Dependent
          nodes will generate their respective DAOs to update their
          paths, and the previous route invalidation for those nodes
          should work in a manner similar to what is described for a switching
          node. The dependent node may set the 'I' flag in the Transit
          Information option as part of a regular DAO so as to
          request invalidation of the previous route from the common
          ancestor node.<a class="pilcrow" href="#section-4.6.1-1">¶</a></p>
<p id="section-4.6.1-2">
          Dependent nodes do not have any indication regarding whether any
          of their parents have in turn decided to switch their
          parent. Thus, for route invalidation, the dependent nodes may
          choose to always set the 'I' flag in all their DAO messages'
          Transit Information options. Note that setting the 'I' flag is
          not counterproductive even if there is no previous
          route to be invalidated.<a class="pilcrow" href="#section-4.6.1-2">¶</a></p>
</section>
<section id="section-4.6.2">
          <h4 id="name-npdao-and-dco-in-the-same-n">
<a class="section-number selfRef" href="#section-4.6.2">4.6.2. </a><a class="section-name selfRef" href="#name-npdao-and-dco-in-the-same-n">NPDAO and DCO in the Same Network</a>
          </h4>
<p id="section-4.6.2-1">
          The NPDAO mechanism provided in <span>[<a class="xref" href="#RFC6550">RFC6550</a>]</span> can
          still be used in the same network where a DCO is used.
          NPDAO messaging can be used, for example, on route lifetime
          expiry of the target or when the node simply decides to
          gracefully terminate the RPL session on graceful node
          shutdown. Moreover, a deployment can have a mix of nodes
          supporting the DCO and the existing NPDAO mechanism. It is
          also possible that the same node supports both NPDAO
          and DCO signaling for route invalidation.<a class="pilcrow" href="#section-4.6.2-1">¶</a></p>
<p id="section-4.6.2-2">
          <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc6550#section-9.8">Section 9.8</a> of [<a class="xref" href="#RFC6550">RFC6550</a>]</span> states, "When a
          node removes a node from its DAO parent set, it <span class="bcp14">SHOULD</span>
          send a No-Path DAO message (Section 6.4.3) to that removed DAO parent to
          invalidate the existing route." This document introduces
          an alternative and more optimized way to perform route invalidation,
          but it also allows existing NPDAO messaging to work. Thus,
          an implementation has two choices to make when a route
          invalidation is to be initiated:<a class="pilcrow" href="#section-4.6.2-2">¶</a></p>
<ol class="normal type-1" id="section-4.6.2-3" start="1" type="1">
<li id="section-4.6.2-3.1">
                  Use an NPDAO to invalidate the previous route, and
                  send a regular DAO on the new path.<a class="pilcrow" href="#section-4.6.2-3.1">¶</a>
</li>
            <li id="section-4.6.2-3.2">
                  Send a regular DAO on the new path with the 'I'
                  flag set in the Transit Information option such
                  that the common ancestor node initiates the DCO
                  message downstream to invalidate the previous
                  route.<a class="pilcrow" href="#section-4.6.2-3.2">¶</a>
</li>
          </ol>
<p id="section-4.6.2-4">
          This document recommends using option 2, for the reasons
          specified in <a class="xref" href="#requirements">Section 3</a>
          of this document.<a class="pilcrow" href="#section-4.6.2-4">¶</a></p>
<p id="section-4.6.2-5">
          This document assumes that all the 6LRs in the network
          support this specification. If there are 6LR nodes that do not support this document that are in the path of the DCO message transmission, then the
          route invalidation for the corresponding targets (targets that are in the DCO message) may not work
          or may work partially. Alternatively, a node
          could generate an NPDAO if it does not receive a DCO with
          itself as the target within a specified time limit. The specified
          time limit is deployment specific and depends upon the
          maximum depth of the network and per-hop average latency.
          Note that sending an NPDAO and a DCO for the same operation
          would not result in unwanted side effects because the
          acceptability of an NPDAO or a DCO depends upon the Path
          Sequence freshness.<a class="pilcrow" href="#section-4.6.2-5">¶</a></p>
</section>
<div id="dco_retry">
<section id="section-4.6.3">
          <h4 id="name-considerations-for-dco-retr">
<a class="section-number selfRef" href="#section-4.6.3">4.6.3. </a><a class="section-name selfRef" href="#name-considerations-for-dco-retr">Considerations for DCO Retries</a>
          </h4>
<p id="section-4.6.3-1">
          A DCO message could be retried by a sender if it sets the
          'K' flag and does not receive a DCO-ACK. The DCO retry time
          could be dependent on the maximum depth of the network and
          average per-hop latency. This could range from 2 seconds to
          120 seconds, depending on the deployment. If the
          latency limits are not known, an implementation <span class="bcp14">MUST NOT</span>
          retry more than once in 3 seconds and <span class="bcp14">MUST NOT</span> retry more
          than three times.<a class="pilcrow" href="#section-4.6.3-1">¶</a></p>
<p id="section-4.6.3-2">
          The number of retries could also be set depending on how
          critical the route invalidation could be for the deployment
          and the link-layer retry configuration. For networks
          supporting only Multi-Point to Point (MP2P) and Point-to-Multipoint (P2MP) flows, such as in Advanced Metering Infrastructure (AMI) and
          telemetry applications, the 6LRs may not be very keen to
          invalidate routes, unless they are highly
          memory constrained. For home and building automation
          networks that may have substantial P2P traffic, the 6LRs
          might be keen to invalidate efficiently because it may
          additionally impact forwarding efficiency.<a class="pilcrow" href="#section-4.6.3-2">¶</a></p>
</section>
</div>
<section id="section-4.6.4">
          <h4 id="name-dco-with-multiple-preferred">
<a class="section-number selfRef" href="#section-4.6.4">4.6.4. </a><a class="section-name selfRef" href="#name-dco-with-multiple-preferred">DCO with Multiple Preferred Parents</a>
          </h4>
<p id="section-4.6.4-1">
          <span>[<a class="xref" href="#RFC6550">RFC6550</a>]</span> allows a node to select multiple
          preferred parents for route establishment.
          <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc6550#section-9.2.1">Section 9.2.1</a> of [<a class="xref" href="#RFC6550">RFC6550</a>]</span> specifies, "All DAOs generated
          at the same time for the same target <span class="bcp14">MUST</span> be sent with the
          same Path Sequence in the Transit Information."
          Subsequently, when route invalidation has to be initiated,
          an NPDAO, which can be initiated with an
          updated Path Sequence to all the parent nodes through which
          the route is to be invalidated, can be used; see <span>[<a class="xref" href="#RFC6550">RFC6550</a>]</span>.<a class="pilcrow" href="#section-4.6.4-1">¶</a></p>
<p id="section-4.6.4-2">
          With a DCO, the target node itself does not initiate the
          route invalidation; this is left to the common ancestor
          node. A common ancestor node when it discovers an updated
          DAO from a new next hop, it initiates a DCO. It is recommended
          that an implementation initiate a DCO after a time period (DelayDCO) such that
          the common ancestor node may receive updated DAOs from all
          possible next hops. This will help to reduce DCO control
          overhead, i.e., the common ancestor can wait for updated
          DAOs from all possible directions before initiating a DCO
          for route invalidation. After timeout, the DCO needs to be
          generated for all the next hops for which the route
          invalidation needs to be done.<a class="pilcrow" href="#section-4.6.4-2">¶</a></p>
<p id="section-4.6.4-3">
          This document recommends using a DelayDCO timer value of
          1 second. This value is inspired by the default DelayDAO timer value
          of 1 second <span>[<a class="xref" href="#RFC6550">RFC6550</a>]</span>. Here, the hypothesis is
          that the DAOs from all possible parent sets would be
          received on the common ancestor within this time period.<a class="pilcrow" href="#section-4.6.4-3">¶</a></p>
<p id="section-4.6.4-4">
          It is still possible that a DCO is generated before all the
          updated DAOs from all the paths are received. In this case,
          the ancestor node would start the invalidation procedure
          for paths from which the updated DAO is not received. The
          DCO generated in this case would start invalidating the
          segments along these paths on which the updated DAOs are
          not received. But once the DAO reaches these segments, the
          routing state would be updated along these segments; this
          should not lead to any inconsistent routing states.<a class="pilcrow" href="#section-4.6.4-4">¶</a></p>
<p id="section-4.6.4-5">
          Note that there is no requirement for synchronization
          between a DCO and DAOs. The DelayDCO timer simply ensures
          that DCO control overhead can be reduced and is only
          needed when the network contains nodes using multiple
          preferred parents.<a class="pilcrow" href="#section-4.6.4-5">¶</a></p>
</section>
</section>
</section>
<div id="IANA">
<section id="section-5">
      <h2 id="name-iana-considerations">
<a class="section-number selfRef" href="#section-5">5. </a><a class="section-name selfRef" href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<p id="section-5-1">
      IANA has allocated codes for the DCO and DCO-ACK
      messages from the "RPL Control Codes" registry.<a class="pilcrow" href="#section-5-1">¶</a></p>
<span id="name-new-codes-for-dco-and-dco-a"></span><table class="center" id="table-1">
        <caption>
<a class="selfRef" href="#table-1">Table 1</a>:
<a class="selfRef" href="#name-new-codes-for-dco-and-dco-a">New Codes for DCO and DCO-ACK Messages</a>
        </caption>
<thead>
          <tr>
            <th class="text-center" colspan="1" rowspan="1">Code</th>
            <th class="text-center" colspan="1" rowspan="1">Description</th>
            <th class="text-center" colspan="1" rowspan="1">Reference</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-center" colspan="1" rowspan="1">0x07</td>
            <td class="text-center" colspan="1" rowspan="1">Destination Cleanup Object</td>
            <td class="text-center" colspan="1" rowspan="1">This document</td>
          </tr>
          <tr>
            <td class="text-center" colspan="1" rowspan="1">0x08</td>
            <td class="text-center" colspan="1" rowspan="1">Destination Cleanup Object Acknowledgment</td>
            <td class="text-center" colspan="1" rowspan="1">This document</td>
          </tr>
          <tr>
            <td class="text-center" colspan="1" rowspan="1">0x87</td>
            <td class="text-center" colspan="1" rowspan="1">Secure Destination Cleanup Object</td>
            <td class="text-center" colspan="1" rowspan="1">This document</td>
          </tr>
          <tr>
            <td class="text-center" colspan="1" rowspan="1">0x88</td>
            <td class="text-center" colspan="1" rowspan="1">Secure Destination Cleanup Object Acknowledgment</td>
            <td class="text-center" colspan="1" rowspan="1">This document</td>
          </tr>
        </tbody>
      </table>
<p id="section-5-3">
            IANA has allocated bit 1 from the "Transit Information
            Option Flags" registry for the 'I' flag (Invalidate previous route; see <a class="xref" href="#transit_opt_changes">Section 4.2</a>).<a class="pilcrow" href="#section-5-3">¶</a></p>
<section id="section-5.1">
        <h3 id="name-new-registry-for-the-destin">
<a class="section-number selfRef" href="#section-5.1">5.1. </a><a class="section-name selfRef" href="#name-new-registry-for-the-destin">New Registry for the Destination Cleanup Object (DCO) Flags</a>
        </h3>
<p id="section-5.1-1">
                IANA has created a registry for the 8-bit Destination Cleanup
                Object (DCO) Flags field. The "Destination Cleanup Object
                (DCO) Flags" registry is located in the "Routing Protocol for
                Low Power and Lossy Networks (RPL)" registry.<a class="pilcrow" href="#section-5.1-1">¶</a></p>
<p id="section-5.1-2">
                New bit numbers may be allocated only by IETF Review
                <span>[<a class="xref" href="#RFC8126">RFC8126</a>]</span>. Each
                bit is tracked with the following qualities:<a class="pilcrow" href="#section-5.1-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1-3.1">Bit number (counting from bit 0 as the most significant bit)<a class="pilcrow" href="#section-5.1-3.1">¶</a>
</li>
          <li class="normal" id="section-5.1-3.2">Capability description<a class="pilcrow" href="#section-5.1-3.2">¶</a>
</li>
          <li class="normal" id="section-5.1-3.3">Defining RFC<a class="pilcrow" href="#section-5.1-3.3">¶</a>
</li>
        </ul>
<p id="section-5.1-4">
                The following bits are currently defined:<a class="pilcrow" href="#section-5.1-4">¶</a></p>
<span id="name-dco-base-flags"></span><table class="center" id="table-2">
          <caption>
<a class="selfRef" href="#table-2">Table 2</a>:
<a class="selfRef" href="#name-dco-base-flags">DCO Base Flags</a>
          </caption>
<thead>
            <tr>
              <th class="text-center" colspan="1" rowspan="1">Bit number</th>
              <th class="text-center" colspan="1" rowspan="1">Description</th>
              <th class="text-center" colspan="1" rowspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-center" colspan="1" rowspan="1">0</td>
              <td class="text-center" colspan="1" rowspan="1">DCO-ACK request (K)</td>
              <td class="text-center" colspan="1" rowspan="1">This document</td>
            </tr>
            <tr>
              <td class="text-center" colspan="1" rowspan="1">1</td>
              <td class="text-center" colspan="1" rowspan="1">DODAGID field is present (D)</td>
              <td class="text-center" colspan="1" rowspan="1">This document</td>
            </tr>
          </tbody>
        </table>
</section>
<section id="section-5.2">
        <h3 id="name-new-registry-for-the-destina">
<a class="section-number selfRef" href="#section-5.2">5.2. </a><a class="section-name selfRef" href="#name-new-registry-for-the-destina">New Registry for the Destination Cleanup Object (DCO) Acknowledgment Flags</a>
        </h3>
<p id="section-5.2-1">
                IANA has created a registry for the 8-bit
                Destination Cleanup Object (DCO) Acknowledgment Flags field.
                The "Destination Cleanup Object (DCO) Acknowledgment Flags" registry
                is located in the
                "Routing Protocol for Low Power and Lossy Networks (RPL)" registry.<a class="pilcrow" href="#section-5.2-1">¶</a></p>
<p id="section-5.2-2">
                New bit numbers may be allocated only by IETF Review
                <span>[<a class="xref" href="#RFC8126">RFC8126</a>]</span>. Each
                bit is tracked with the following qualities:<a class="pilcrow" href="#section-5.2-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2-3.1">Bit number (counting from bit 0 as the most significant bit)<a class="pilcrow" href="#section-5.2-3.1">¶</a>
</li>
          <li class="normal" id="section-5.2-3.2">Capability description<a class="pilcrow" href="#section-5.2-3.2">¶</a>
</li>
          <li class="normal" id="section-5.2-3.3">Defining RFC<a class="pilcrow" href="#section-5.2-3.3">¶</a>
</li>
        </ul>
<p id="section-5.2-4">
                The following bit is currently defined:<a class="pilcrow" href="#section-5.2-4">¶</a></p>
<span id="name-dco-ack-base-flag"></span><table class="center" id="table-3">
          <caption>
<a class="selfRef" href="#table-3">Table 3</a>:
<a class="selfRef" href="#name-dco-ack-base-flag">DCO-ACK Base Flag</a>
          </caption>
<thead>
            <tr>
              <th class="text-center" colspan="1" rowspan="1">Bit number</th>
              <th class="text-center" colspan="1" rowspan="1">Description</th>
              <th class="text-center" colspan="1" rowspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-center" colspan="1" rowspan="1">0</td>
              <td class="text-center" colspan="1" rowspan="1">DODAGID field is present (D)</td>
              <td class="text-center" colspan="1" rowspan="1">This document</td>
            </tr>
          </tbody>
        </table>
</section>
<div id="rpl_reject_status">
<section id="section-5.3">
        <h3 id="name-rpl-rejection-status-values">
<a class="section-number selfRef" href="#section-5.3">5.3. </a><a class="section-name selfRef" href="#name-rpl-rejection-status-values">RPL Rejection Status Values</a>
        </h3>
<p id="section-5.3-1">
           This document adds a new status value to the "RPL Rejection Status" subregistry initially created per <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9010#section-12.6">Section 12.6</a> of [<a class="xref" href="#RFC9010">RFC9010</a>]</span>.<a class="pilcrow" href="#section-5.3-1">¶</a></p>
<span id="name-rejection-value-of-the-rpl-"></span><table class="center" id="table-4">
          <caption>
<a class="selfRef" href="#table-4">Table 4</a>:
<a class="selfRef" href="#name-rejection-value-of-the-rpl-">Rejection Value of the RPL Status</a>
          </caption>
<thead>
            <tr>
              <th class="text-center" colspan="1" rowspan="1">Value</th>
              <th class="text-center" colspan="1" rowspan="1">Meaning</th>
              <th class="text-center" colspan="1" rowspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-center" colspan="1" rowspan="1">1</td>
              <td class="text-center" colspan="1" rowspan="1">No routing entry</td>
              <td class="text-center" colspan="1" rowspan="1">This document</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
</section>
</div>
<div id="Security">
<section id="section-6">
      <h2 id="name-security-considerations">
<a class="section-number selfRef" href="#section-6">6. </a><a class="section-name selfRef" href="#name-security-considerations">Security Considerations</a>
      </h2>
<p id="section-6-1">
            This document introduces the ability for a common ancestor node to
            invalidate a route on behalf of the target node. The common
            ancestor node could be directed to do so by the target node, using
            the 'I' flag in a DCO's Transit Information option. However, the common
            ancestor node is in a position to unilaterally initiate the route
            invalidation, since it possesses all the required state information,
            namely, the Target Address and the corresponding Path Sequence.
            Thus, a rogue common ancestor node could initiate such an
            invalidation and impact the traffic to the target node.<a class="pilcrow" href="#section-6-1">¶</a></p>
<p id="section-6-2"> The DCO carries a RPL Status value, which is informative. New Status
            values may be created over time, and a node will ignore an unknown
            Status value. This enables the RPL Status field to be
            used as a cover channel. But the channel only works once, since the
            message destroys its own medium, i.e., the existing route that it
            is removing.<a class="pilcrow" href="#section-6-2">¶</a></p>
<p id="section-6-3">
            This document also introduces an 'I' flag, which is set by the target
            node and used by the ancestor node to initiate a DCO if the
            ancestor sees an update in the routing adjacency. However,
            this flag could be spoofed by a malicious 6LR in the path and can
            cause invalidation of an existing active path. Note that invalidation
            will work only if the Path Sequence condition is also met for the
            target for which the invalidation is attempted. Having said that, such a malicious 6LR may
            spoof a DAO on behalf of the (sub) child with the 'I' flag set and
            can cause route invalidation on behalf of the (sub) child node.
            Note that by using existing mechanisms offered by <span>[<a class="xref" href="#RFC6550">RFC6550</a>]</span>, a malicious 6LR might also spoof a DAO with a
            lifetime of zero or otherwise cause denial of service by dropping
            traffic entirely, so the new mechanism described in this document
            does not present a substantially increased risk of disruption.<a class="pilcrow" href="#section-6-3">¶</a></p>
<p id="section-6-4">
            This document assumes that the security mechanisms as defined in
            <span>[<a class="xref" href="#RFC6550">RFC6550</a>]</span> are followed, which means that the common
            ancestor node and all the 6LRs are part of the RPL network because
            they have the required credentials. A non-secure RPL network needs
            to take into consideration the risks highlighted in this section as
            well as those highlighted in <span>[<a class="xref" href="#RFC6550">RFC6550</a>]</span>.<a class="pilcrow" href="#section-6-4">¶</a></p>
<p id="section-6-5">
            All RPL messages support a secure version of messages; this allows
            integrity protection using either a Message Authentication Code (MAC) or a signature. Optionally,
            secured RPL messages also have encryption protection for
            confidentiality.<a class="pilcrow" href="#section-6-5">¶</a></p>
<p id="section-6-6">
            This document adds new messages (DCO and DCO-ACK) that are
            syntactically similar to existing RPL messages such as DAO and
            DAO-ACK. Secure versions of DCO and DCO-ACK messages are added in a way that is similar to the technique used for other RPL messages (such as DAO and DAO-ACK).<a class="pilcrow" href="#section-6-6">¶</a></p>
<p id="section-6-7">
            RPL supports three security modes, as mentioned in
            <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc6550#section-10.1">Section 10.1</a> of [<a class="xref" href="#RFC6550">RFC6550</a>]</span>:<a class="pilcrow" href="#section-6-7">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-6-8">
        <dt id="section-6-8.1">Unsecured:</dt>
        <dd id="section-6-8.2" style="margin-left: 1.5em">In this mode, it is expected that the RPL control messages
          are secured by other security mechanisms, such as
          link-layer security. In this mode, the RPL control messages,
          including DCO and DCO-ACK messages, do not have Security sections.
          Also note that unsecured mode does not imply that all
          messages are sent without any protection.<a class="pilcrow" href="#section-6-8.2">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-6-8.3">Preinstalled:</dt>
        <dd id="section-6-8.4" style="margin-left: 1.5em">In this mode, RPL uses secure messages. Thus,
          secure versions of DCO and DCO-ACK messages <span class="bcp14">MUST</span> be used in this mode.<a class="pilcrow" href="#section-6-8.4">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-6-8.5">Authenticated:</dt>
        <dd id="section-6-8.6" style="margin-left: 1.5em">In this mode, RPL uses secure messages. Thus,
          secure versions of DCO and DCO-ACK messages <span class="bcp14">MUST</span> be used in this mode.<a class="pilcrow" href="#section-6-8.6">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
</section>
</div>
<section id="section-7">
      <h2 id="name-normative-references">
<a class="section-number selfRef" href="#section-7">7. </a><a class="section-name selfRef" href="#name-normative-references">Normative References</a>
      </h2>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
      <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time class="refDate" datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6550">[RFC6550]</dt>
      <dd>
<span class="refAuthor">Winter, T., Ed.</span>, <span class="refAuthor">Thubert, P., Ed.</span>, <span class="refAuthor">Brandt, A.</span>, <span class="refAuthor">Hui, J.</span>, <span class="refAuthor">Kelsey, R.</span>, <span class="refAuthor">Levis, P.</span>, <span class="refAuthor">Pister, K.</span>, <span class="refAuthor">Struik, R.</span>, <span class="refAuthor">Vasseur, JP.</span>, and <span class="refAuthor">R. Alexander</span>, <span class="refTitle">"RPL: IPv6 Routing Protocol for Low-Power and Lossy Networks"</span>, <span class="seriesInfo">RFC 6550</span>, <span class="seriesInfo">DOI 10.17487/RFC6550</span>, <time class="refDate" datetime="2012-03">March 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6550">https://www.rfc-editor.org/info/rfc6550</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
      <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time class="refDate" datetime="2017-06">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
      <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time class="refDate" datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8505">[RFC8505]</dt>
      <dd>
<span class="refAuthor">Thubert, P., Ed.</span>, <span class="refAuthor">Nordmark, E.</span>, <span class="refAuthor">Chakrabarti, S.</span>, and <span class="refAuthor">C. Perkins</span>, <span class="refTitle">"Registration Extensions for IPv6 over Low-Power Wireless Personal Area Network (6LoWPAN) Neighbor Discovery"</span>, <span class="seriesInfo">RFC 8505</span>, <span class="seriesInfo">DOI 10.17487/RFC8505</span>, <time class="refDate" datetime="2018-11">November 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8505">https://www.rfc-editor.org/info/rfc8505</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9010">[RFC9010]</dt>
    <dd>
<span class="refAuthor">Thubert, P., Ed.</span> and <span class="refAuthor">M. Richardson</span>, <span class="refTitle">"Routing for RPL (Routing Protocol for Low-Power and Lossy Networks) Leaves"</span>, <span class="seriesInfo">RFC 9010</span>, <span class="seriesInfo">DOI 10.17487/RFC9010</span>, <time class="refDate" datetime="2021-04">April 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9010">https://www.rfc-editor.org/info/rfc9010</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<div id="app-additional">
<section id="section-appendix.a">
      <h2 id="name-example-messaging">
<a class="section-number selfRef" href="#section-appendix.a">Appendix A. </a><a class="section-name selfRef" href="#name-example-messaging">Example Messaging</a>
      </h2>
<section id="section-a.1">
        <h2 id="name-example-dco-messaging">
<a class="section-number selfRef" href="#section-a.1">A.1. </a><a class="section-name selfRef" href="#name-example-dco-messaging">Example DCO Messaging</a>
        </h2>
<p id="section-a.1-1">
            In this example, Node D (<a class="xref" href="#sample_top">Figure 1</a>)
            switches its parent from
            B to C. This example assumes that Node D has already
            established its own route via Node B-G-A-6LBR using pathseq=x. The
            example uses DAO and DCO messaging conventions and specifies only
            the required parameters to explain the example, namely, the
            parameter 'tgt', which stands for "Target option"; the value of this
            parameter specifies the address of the target node. The parameter
            'pathseq' specifies the Path Sequence value carried in the
            Transit Information option, and the parameter 'I_flag' specifies the
            'I' flag in the Transit Information option. The
            sequence of actions is as follows:<a class="pilcrow" href="#section-a.1-1">¶</a></p>
<ol class="normal type-1" id="section-a.1-2" start="1" type="1">
<li id="section-a.1-2.1">Node D switches its parent from Node B to Node C.<a class="pilcrow" href="#section-a.1-2.1">¶</a>
</li>
          <li id="section-a.1-2.2">D sends a regular DAO(tgt=D,pathseq=x+1,I_flag=1) in the
          updated path to C.<a class="pilcrow" href="#section-a.1-2.2">¶</a>
</li>
          <li id="section-a.1-2.3">C checks for a routing entry on behalf of D; since it cannot
          find an entry on behalf of D, it creates a new routing entry
          and forwards the reachability information of the target D
          to H in a DAO(tgt=D,pathseq=x+1,I_flag=1).<a class="pilcrow" href="#section-a.1-2.3">¶</a>
</li>
          <li id="section-a.1-2.4">Similar to C, Node H checks for a routing entry on behalf of
          D, cannot find an entry, and hence creates a new routing
          entry and forwards the reachability information of the
          target D to A in a DAO(tgt=D,pathseq=x+1,I_flag=1).<a class="pilcrow" href="#section-a.1-2.4">¶</a>
</li>
          <li id="section-a.1-2.5">
          Node A receives the DAO(tgt=D,pathseq=x+1,I_flag=1) and
          checks for a routing entry on behalf of D. It finds a
          routing entry but checks that the next hop for target D is
          different (i.e., Node G). Node A checks the I_flag and
          generates the DCO(tgt=D,pathseq=x+1) to the previous next hop for
          target D, which is G. Subsequently, Node A updates the
          routing entry and forwards the reachability information of
          target D upstream using the DAO(tgt=D,pathseq=x+1,I_flag=1).<a class="pilcrow" href="#section-a.1-2.5">¶</a>
</li>
          <li id="section-a.1-2.6">
          Node G receives the DCO(tgt=D,pathseq=x+1). It checks to see if
          the received Path Sequence is later than the stored Path
          Sequence. If it is later, Node G invalidates the routing entry
          of target D and forwards the (un)reachability information
          downstream to B in the DCO(tgt=D,pathseq=x+1).<a class="pilcrow" href="#section-a.1-2.6">¶</a>
</li>
          <li id="section-a.1-2.7">
          Similarly, B processes the DCO(tgt=D,pathseq=x+1) by
          invalidating the routing entry of target D and forwards the
          (un)reachability information downstream to D.<a class="pilcrow" href="#section-a.1-2.7">¶</a>
</li>
          <li id="section-a.1-2.8">
          D ignores the DCO(tgt=D,pathseq=x+1), since the target is
          itself.<a class="pilcrow" href="#section-a.1-2.8">¶</a>
</li>
          <li id="section-a.1-2.9">
          The propagation of the DCO will stop at any node where the
          node does not have routing information associated with
          the target. If cached routing information is present and
          the cached Path Sequence is higher than the value in the
          DCO, then the DCO is dropped.<a class="pilcrow" href="#section-a.1-2.9">¶</a>
</li>
        </ol>
</section>
<section id="section-a.2">
        <h2 id="name-example-dco-messaging-with-">
<a class="section-number selfRef" href="#section-a.2">A.2. </a><a class="section-name selfRef" href="#name-example-dco-messaging-with-">Example DCO Messaging with Multiple Preferred Parents</a>
        </h2>
<p id="section-a.2-1">
                As shown in <a class="xref" href="#sample_top_mpp">Figure 5</a>, node (N41) selects multiple
                preferred parents (N32) and (N33).
                The sequence of actions is listed below the figure.<a class="pilcrow" href="#section-a.2-1">¶</a></p>
<span id="name-sample-topology-2"></span><div id="sample_top_mpp">
<figure id="figure-5">
          <div class="artwork art-text alignCenter" id="section-a.2-2.1">
<pre>       (6LBR)
         |
         |
         |
       (N11)
        / \
       /   \
      /     \
   (N21)   (N22)
     /      / \
    /      /   \
   /      /     \
(N31)  (N32)  (N33)
    :    |    /
     :   |   /
      :  |  /
       (N41)</pre>
</div>
<figcaption><a class="selfRef" href="#figure-5">Figure 5</a>:
<a class="selfRef" href="#name-sample-topology-2">Sample Topology 2</a>
          </figcaption></figure>
</div>
<ol class="normal type-1" id="section-a.2-3" start="1" type="1">
<li id="section-a.2-3.1">
              (N41) sends a DAO(tgt=N41,PS=x,I_flag=1) to (N32) and (N33).
              Here, 'I_flag' refers to the Invalidation flag, and 'PS' refers to
              the Path Sequence in the Transit Information option.<a class="pilcrow" href="#section-a.2-3.1">¶</a>
</li>
          <li id="section-a.2-3.2">
              (N32) sends the DAO(tgt=N41,PS=x,I_flag=1) to (N22). (N33) also
              sends the DAO(tgt=N41,PS=x,I_flag=1) to (N22). (N22) learns
              multiple routes for the same destination (N41) through
              multiple next hops. (N22) may receive the DAOs from
              (N32) and (N33) in any order with the I_flag set. The
              implementation should use the DelayDCO timer to wait to
              initiate the DCO. If (N22) receives an updated DAO from
              all the paths, then the DCO need not be initiated in
              this case. Thus, the routing table at N22 should contain
              (Dst,NextHop,PS): { (N41,N32,x), (N41,N33,x) }.<a class="pilcrow" href="#section-a.2-3.2">¶</a>
</li>
          <li id="section-a.2-3.3">
              (N22) sends the DAO(tgt=N41,PS=x,I_flag=1) to (N11).<a class="pilcrow" href="#section-a.2-3.3">¶</a>
</li>
          <li id="section-a.2-3.4">
              (N11) sends the DAO(tgt=N41,PS=x,I_flag=1) to (6LBR). Thus, the
              complete path is established.<a class="pilcrow" href="#section-a.2-3.4">¶</a>
</li>
          <li id="section-a.2-3.5">
              (N41) decides to change the preferred parent set from
              { N32, N33 } to { N31, N32 }.<a class="pilcrow" href="#section-a.2-3.5">¶</a>
</li>
          <li id="section-a.2-3.6">
              (N41) sends the DAO(tgt=N41,PS=x+1,I_flag=1) to (N32). (N41)
              sends the DAO(tgt=N41,PS=x+1,I_flag=1) to (N31).<a class="pilcrow" href="#section-a.2-3.6">¶</a>
</li>
          <li id="section-a.2-3.7">
              (N32) sends the DAO(tgt=N41,PS=x+1,I_flag=1) to (N22).
              (N22) has multiple routes to destination (N41). It sees
              that a new Path Sequence for Target=N41 is received and
              thus waits for a predetermined time period (the DelayDCO
              time period) to invalidate another route
              { (N41),(N33),x }.  After the time period, (N22) sends the
              DCO(tgt=N41,PS=x+1) to (N33). Also (N22) sends the
              regular DAO(tgt=N41,PS=x+1,I_flag=1) to (N11).<a class="pilcrow" href="#section-a.2-3.7">¶</a>
</li>
          <li id="section-a.2-3.8">
              (N33) receives the DCO(tgt=N41,PS=x+1). The received Path
              Sequence is the latest and thus invalidates the entry
              associated with the target (N41). (N33) then sends the
              DCO(tgt=N41,PS=x+1) to (N41). (N41) sees itself as the
              target and drops the DCO.<a class="pilcrow" href="#section-a.2-3.8">¶</a>
</li>
          <li id="section-a.2-3.9">
              From Step 6 above, (N31) receives the
              DAO(tgt=N41,PS=x+1,I_flag=1). It creates a routing
              entry and sends the DAO(tgt=N41,PS=x+1,I_flag=1) to
              (N21). Similarly, (N21) receives the DAO and
              subsequently sends the DAO(tgt=N41,PS=x+1,I_flag=1) to
              (N11).<a class="pilcrow" href="#section-a.2-3.9">¶</a>
</li>
          <li id="section-a.2-3.10">
              (N11) receives the DAO(tgt=N41,PS=x+1,I_flag=1) from (N21).
              It waits for the DelayDCO timer, since it has multiple
              routes to (N41). (N41) will receive the
              DAO(tgt=N41,PS=x+1,I_flag=1) from (N22) from Step 7
              above. Thus, (N11) has received the regular
              DAO(tgt=N41,PS=x+1,I_flag=1) from all paths and thus
              does not initiate the DCO.<a class="pilcrow" href="#section-a.2-3.10">¶</a>
</li>
          <li id="section-a.2-3.11">
              (N11) forwards the DAO(tgt=N41,PS=x+1,I_flag=1) to (6LBR),
              and the full path is established.<a class="pilcrow" href="#section-a.2-3.11">¶</a>
</li>
        </ol>
</section>
</section>
</div>
<div id="Acknowledgments">
<section id="section-appendix.b">
      <h2 id="name-acknowledgments">
<a class="section-name selfRef" href="#name-acknowledgments">Acknowledgments</a>
      </h2>
<p id="section-appendix.b-1">
      Many thanks to <span class="contact-name">Alvaro Retana</span>, <span class="contact-name">Cenk Gundogan</span>, <span class="contact-name">Simon Duquennoy</span>, <span class="contact-name">Georgios Papadopoulos</span>, and <span class="contact-name">Peter van der Stok</span> for their review and comments.
            <span class="contact-name">Alvaro Retana</span> helped shape this document's final version with
            critical review comments.<a class="pilcrow" href="#section-appendix.b-1">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="section-appendix.c">
      <h2 id="name-authors-addresses">
<a class="section-name selfRef" href="#name-authors-addresses">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Rahul Arvind Jadhav (<span class="role">editor</span>)</span></div>
<div class="left" dir="auto"><span class="org">Huawei</span></div>
<div class="left" dir="auto"><span class="extended-address">Whitefield</span></div>
<div class="left" dir="auto"><span class="street-address">Kundalahalli Village</span></div>
<div class="left" dir="auto">
<span class="locality">Bangalore</span> <span class="postal-code">560037</span>
</div>
<div class="left" dir="auto"><span class="region">Karnataka</span></div>
<div class="left" dir="auto"><span class="country-name">India</span></div>
<div class="tel">
<span>Phone:</span>
<a class="tel" href="tel:+91-080-49160700">+91-080-49160700</a>
</div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:rahul.ietf@gmail.com">rahul.ietf@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Pascal Thubert</span></div>
<div class="left" dir="auto"><span class="org">Cisco Systems, Inc.</span></div>
<div class="left" dir="auto"><span class="extended-address">Building D</span></div>
<div class="left" dir="auto"><span class="street-address">45 Allee des Ormes - BP1200</span></div>
<div class="left" dir="auto">
<span class="postal-code">06254</span> <span class="locality">MOUGINS - Sophia Antipolis</span>
</div>
<div class="left" dir="auto"><span class="country-name">France</span></div>
<div class="tel">
<span>Phone:</span>
<a class="tel" href="tel:+33-497-23-26-34">+33-497-23-26-34</a>
</div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:pthubert@cisco.com">pthubert@cisco.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Rabi Narayan Sahoo</span></div>
<div class="left" dir="auto"><span class="org">Huawei</span></div>
<div class="left" dir="auto"><span class="extended-address">Whitefield</span></div>
<div class="left" dir="auto"><span class="street-address">Kundalahalli Village</span></div>
<div class="left" dir="auto">
<span class="locality">Bangalore</span> <span class="postal-code">560037</span>
</div>
<div class="left" dir="auto"><span class="region">Karnataka</span></div>
<div class="left" dir="auto"><span class="country-name">India</span></div>
<div class="tel">
<span>Phone:</span>
<a class="tel" href="tel:+91-080-49160700">+91-080-49160700</a>
</div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:rabinarayans0828@gmail.com">rabinarayans0828@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Zhen Cao</span></div>
<div class="left" dir="auto"><span class="org">Huawei</span></div>
<div class="left" dir="auto"><span class="street-address">W Chang'an Ave</span></div>
<div class="left" dir="auto"><span class="locality">Beijing</span></div>
<div class="left" dir="auto"><span class="country-name">China</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:zhencao.ietf@gmail.com">zhencao.ietf@gmail.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>


</body></html>