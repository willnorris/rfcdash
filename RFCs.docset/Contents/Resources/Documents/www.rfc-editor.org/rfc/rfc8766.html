<!DOCTYPE html>
<html class="RFC" lang="en"><head>
<meta charset="utf-8"/>
<meta content="Common,Latin" name="scripts"/>
<meta content="initial-scale=1.0" name="viewport"/>
<title>RFC 8766: Discovery Proxy for Multicast DNS-Based Service Discovery</title>
<meta content="Stuart Cheshire" name="author"/>
<meta content="
       This document specifies a network proxy that uses Multicast DNS
      to automatically populate the wide-area unicast Domain Name System
      namespace
      with records describing devices and services found on the local
      link. 
    " name="description"/>
<meta content="xml2rfc 2.45.3" name="generator"/>
<meta content="Multicast DNS" name="keyword"/>
<meta content="DNS-Based Service Discovery" name="keyword"/>
<meta content="8766" name="rfc.number"/>
<link href="rfc8766.xml" rel="alternate" type="application/rfc+xml"/>
<link href="#copyright" rel="license"/>
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Avoid wrapping of URLs in references */
@media screen {
  .references a {
    white-space: nowrap;
  }
}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css"/>
<link href="https://dx.doi.org/10.17487/rfc8766" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <link href="https://datatracker.ietf.org/doc/draft-ietf-dnssd-hybrid-10" rel="prev"/>
  </head>
<body>
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 8766</td>
<td class="center">Multicast Service Discovery Proxy</td>
<td class="right">June 2020</td>
</tr></thead>
<tfoot><tr>
<td class="left">Cheshire</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div class="document-information" id="external-metadata"></div>
<div class="document-information" id="internal-metadata">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a class="eref" href="https://www.rfc-editor.org/rfc/rfc8766">8766</a></dd>
<dt class="label-category">Category:</dt>
<dd class="category">Standards Track</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time class="published" datetime="2020-06">June 2020</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">S. Cheshire</div>
<div class="org">Apple Inc.</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 8766</h1>
<h1 id="title">Discovery Proxy for Multicast DNS-Based Service Discovery</h1>
<section id="section-abstract">
      <h2 id="abstract"><a class="selfRef" href="#abstract">Abstract</a></h2>
<p id="section-abstract-1">This document specifies a network proxy that uses Multicast DNS
      to automatically populate the wide-area unicast Domain Name System
      namespace
      with records describing devices and services found on the local
      link.<a class="pilcrow" href="#section-abstract-1">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a class="section-name selfRef" href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This is an Internet Standards Track document.<a class="pilcrow" href="#section-boilerplate.1-1">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.<a class="pilcrow" href="#section-boilerplate.1-2">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc8766">https://www.rfc-editor.org/info/rfc8766</a></span>.<a class="pilcrow" href="#section-boilerplate.1-3">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a class="section-name selfRef" href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2020 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a class="pilcrow" href="#section-boilerplate.2-1">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a class="pilcrow" href="#section-boilerplate.2-2">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a class="toplink" href="#" onclick="scroll(0,0)">▲</a><h2 id="name-table-of-contents">
<a class="section-name selfRef" href="#name-table-of-contents">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.1">
            <p class="keepWithNext" id="section-toc.1-1.1.1"><a class="xref" href="#section-1">1</a>.  <a class="xref" href="#name-introduction">Introduction</a><a class="pilcrow" href="#section-toc.1-1.1.1">¶</a></p>
</li>
<li class="ulEmpty toc compact" id="section-toc.1-1.2">
            <p class="keepWithNext" id="section-toc.1-1.2.1"><a class="xref" href="#section-2">2</a>.  <a class="xref" href="#name-operational-analogy">Operational Analogy</a><a class="pilcrow" href="#section-toc.1-1.2.1">¶</a></p>
</li>
<li class="ulEmpty toc compact" id="section-toc.1-1.3">
            <p class="keepWithNext" id="section-toc.1-1.3.1"><a class="xref" href="#section-3">3</a>.  <a class="xref" href="#name-conventions-and-terminology">Conventions and Terminology Used in This Document</a><a class="pilcrow" href="#section-toc.1-1.3.1">¶</a></p>
</li>
<li class="ulEmpty toc compact" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a class="xref" href="#section-4">4</a>.  <a class="xref" href="#name-compatibility-consideration">Compatibility Considerations</a><a class="pilcrow" href="#section-toc.1-1.4.1">¶</a></p>
</li>
<li class="ulEmpty toc compact" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a class="xref" href="#section-5">5</a>.  <a class="xref" href="#name-discovery-proxy-operation">Discovery Proxy Operation</a><a class="pilcrow" href="#section-toc.1-1.5.1">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a class="xref" href="#section-5.1">5.1</a>.  <a class="xref" href="#name-delegated-subdomain-for-dns">Delegated Subdomain for DNS-based Service Discovery
 Records</a><a class="pilcrow" href="#section-toc.1-1.5.2.1.1">¶</a></p>
</li>
<li class="ulEmpty toc compact" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a class="xref" href="#section-5.2">5.2</a>.  <a class="xref" href="#name-domain-enumeration">Domain Enumeration</a><a class="pilcrow" href="#section-toc.1-1.5.2.2.1">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.5.2.2.2.1">
                    <p id="section-toc.1-1.5.2.2.2.1.1"><a class="xref" href="#section-5.2.1">5.2.1</a>.  <a class="xref" href="#name-domain-enumeration-via-unic">Domain Enumeration via Unicast Queries</a><a class="pilcrow" href="#section-toc.1-1.5.2.2.2.1.1">¶</a></p>
</li>
<li class="ulEmpty toc compact" id="section-toc.1-1.5.2.2.2.2">
                    <p id="section-toc.1-1.5.2.2.2.2.1"><a class="xref" href="#section-5.2.2">5.2.2</a>.  <a class="xref" href="#name-domain-enumeration-via-mult">Domain Enumeration via Multicast Queries</a><a class="pilcrow" href="#section-toc.1-1.5.2.2.2.2.1">¶</a></p>
</li>
</ul>
</li>
<li class="ulEmpty toc compact" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a class="xref" href="#section-5.3">5.3</a>.  <a class="xref" href="#name-delegated-subdomain-for-ldh">Delegated Subdomain for LDH Host Names</a><a class="pilcrow" href="#section-toc.1-1.5.2.3.1">¶</a></p>
</li>
<li class="ulEmpty toc compact" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a class="xref" href="#section-5.4">5.4</a>.  <a class="xref" href="#name-delegated-subdomain-for-rev">Delegated Subdomain for Reverse Mapping</a><a class="pilcrow" href="#section-toc.1-1.5.2.4.1">¶</a></p>
</li>
<li class="ulEmpty toc compact" id="section-toc.1-1.5.2.5">
                <p id="section-toc.1-1.5.2.5.1"><a class="xref" href="#section-5.5">5.5</a>.  <a class="xref" href="#name-data-translation">Data Translation</a><a class="pilcrow" href="#section-toc.1-1.5.2.5.1">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.5.2.5.2.1">
                    <p id="section-toc.1-1.5.2.5.2.1.1"><a class="xref" href="#section-5.5.1">5.5.1</a>.  <a class="xref" href="#name-dns-ttl-limiting">DNS TTL Limiting</a><a class="pilcrow" href="#section-toc.1-1.5.2.5.2.1.1">¶</a></p>
</li>
<li class="ulEmpty toc compact" id="section-toc.1-1.5.2.5.2.2">
                    <p id="section-toc.1-1.5.2.5.2.2.1"><a class="xref" href="#section-5.5.2">5.5.2</a>.  <a class="xref" href="#name-suppressing-unusable-record">Suppressing Unusable Records</a><a class="pilcrow" href="#section-toc.1-1.5.2.5.2.2.1">¶</a></p>
</li>
<li class="ulEmpty toc compact" id="section-toc.1-1.5.2.5.2.3">
                    <p id="section-toc.1-1.5.2.5.2.3.1"><a class="xref" href="#section-5.5.3">5.5.3</a>.  <a class="xref" href="#name-nsec-and-nsec3-queries">NSEC and NSEC3 Queries</a><a class="pilcrow" href="#section-toc.1-1.5.2.5.2.3.1">¶</a></p>
</li>
<li class="ulEmpty toc compact" id="section-toc.1-1.5.2.5.2.4">
                    <p id="section-toc.1-1.5.2.5.2.4.1"><a class="xref" href="#section-5.5.4">5.5.4</a>.  <a class="xref" href="#name-no-text-encoding-translatio">No Text-Encoding Translation</a><a class="pilcrow" href="#section-toc.1-1.5.2.5.2.4.1">¶</a></p>
</li>
<li class="ulEmpty toc compact" id="section-toc.1-1.5.2.5.2.5">
                    <p id="section-toc.1-1.5.2.5.2.5.1"><a class="xref" href="#section-5.5.5">5.5.5</a>.  <a class="xref" href="#name-application-specific-data-t">Application-Specific Data Translation</a><a class="pilcrow" href="#section-toc.1-1.5.2.5.2.5.1">¶</a></p>
</li>
</ul>
</li>
<li class="ulEmpty toc compact" id="section-toc.1-1.5.2.6">
                <p id="section-toc.1-1.5.2.6.1"><a class="xref" href="#section-5.6">5.6</a>.  <a class="xref" href="#name-answer-aggregation">Answer Aggregation</a><a class="pilcrow" href="#section-toc.1-1.5.2.6.1">¶</a></p>
</li>
</ul>
</li>
<li class="ulEmpty toc compact" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a class="xref" href="#section-6">6</a>.  <a class="xref" href="#name-administrative-dns-records">Administrative DNS Records</a><a class="pilcrow" href="#section-toc.1-1.6.1">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a class="xref" href="#section-6.1">6.1</a>.  <a class="xref" href="#name-dns-soa-start-of-authority-">DNS SOA (Start of Authority) Record</a><a class="pilcrow" href="#section-toc.1-1.6.2.1.1">¶</a></p>
</li>
<li class="ulEmpty toc compact" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a class="xref" href="#section-6.2">6.2</a>.  <a class="xref" href="#name-dns-ns-records">DNS NS Records</a><a class="pilcrow" href="#section-toc.1-1.6.2.2.1">¶</a></p>
</li>
<li class="ulEmpty toc compact" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a class="xref" href="#section-6.3">6.3</a>.  <a class="xref" href="#name-dns-delegation-records">DNS Delegation Records</a><a class="pilcrow" href="#section-toc.1-1.6.2.3.1">¶</a></p>
</li>
<li class="ulEmpty toc compact" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a class="xref" href="#section-6.4">6.4</a>.  <a class="xref" href="#name-dns-srv-records">DNS SRV Records</a><a class="pilcrow" href="#section-toc.1-1.6.2.4.1">¶</a></p>
</li>
<li class="ulEmpty toc compact" id="section-toc.1-1.6.2.5">
                <p id="section-toc.1-1.6.2.5.1"><a class="xref" href="#section-6.5">6.5</a>.  <a class="xref" href="#name-domain-enumeration-records">Domain Enumeration Records</a><a class="pilcrow" href="#section-toc.1-1.6.2.5.1">¶</a></p>
</li>
</ul>
</li>
<li class="ulEmpty toc compact" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a class="xref" href="#section-7">7</a>.  <a class="xref" href="#name-dnssec-considerations">DNSSEC Considerations</a><a class="pilcrow" href="#section-toc.1-1.7.1">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a class="xref" href="#section-7.1">7.1</a>.  <a class="xref" href="#name-online-signing-only">Online Signing Only</a><a class="pilcrow" href="#section-toc.1-1.7.2.1.1">¶</a></p>
</li>
<li class="ulEmpty toc compact" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a class="xref" href="#section-7.2">7.2</a>.  <a class="xref" href="#name-nsec-and-nsec3-records">NSEC and NSEC3 Records</a><a class="pilcrow" href="#section-toc.1-1.7.2.2.1">¶</a></p>
</li>
</ul>
</li>
<li class="ulEmpty toc compact" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a class="xref" href="#section-8">8</a>.  <a class="xref" href="#name-ipv6-considerations">IPv6 Considerations</a><a class="pilcrow" href="#section-toc.1-1.8.1">¶</a></p>
</li>
<li class="ulEmpty toc compact" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a class="xref" href="#section-9">9</a>.  <a class="xref" href="#name-security-considerations">Security Considerations</a><a class="pilcrow" href="#section-toc.1-1.9.1">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a class="xref" href="#section-9.1">9.1</a>.  <a class="xref" href="#name-authenticity">Authenticity</a><a class="pilcrow" href="#section-toc.1-1.9.2.1.1">¶</a></p>
</li>
<li class="ulEmpty toc compact" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a class="xref" href="#section-9.2">9.2</a>.  <a class="xref" href="#name-privacy">Privacy</a><a class="pilcrow" href="#section-toc.1-1.9.2.2.1">¶</a></p>
</li>
<li class="ulEmpty toc compact" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a class="xref" href="#section-9.3">9.3</a>.  <a class="xref" href="#name-denial-of-service">Denial of Service</a><a class="pilcrow" href="#section-toc.1-1.9.2.3.1">¶</a></p>
</li>
</ul>
</li>
<li class="ulEmpty toc compact" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a class="xref" href="#section-10">10</a>. <a class="xref" href="#name-iana-considerations">IANA Considerations</a><a class="pilcrow" href="#section-toc.1-1.10.1">¶</a></p>
</li>
<li class="ulEmpty toc compact" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a class="xref" href="#section-11">11</a>. <a class="xref" href="#name-references">References</a><a class="pilcrow" href="#section-toc.1-1.11.1">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a class="xref" href="#section-11.1">11.1</a>.  <a class="xref" href="#name-normative-references">Normative References</a><a class="pilcrow" href="#section-toc.1-1.11.2.1.1">¶</a></p>
</li>
<li class="ulEmpty toc compact" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a class="xref" href="#section-11.2">11.2</a>.  <a class="xref" href="#name-informative-references">Informative References</a><a class="pilcrow" href="#section-toc.1-1.11.2.2.1">¶</a></p>
</li>
</ul>
</li>
<li class="ulEmpty toc compact" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a class="xref" href="#section-appendix.a">Appendix A</a>.  <a class="xref" href="#name-implementation-status">Implementation Status</a><a class="pilcrow" href="#section-toc.1-1.12.1">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a class="xref" href="#section-a.1">A.1</a>.  <a class="xref" href="#name-already-implemented-and-dep">Already Implemented and Deployed</a><a class="pilcrow" href="#section-toc.1-1.12.2.1.1">¶</a></p>
</li>
<li class="ulEmpty toc compact" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a class="xref" href="#section-a.2">A.2</a>.  <a class="xref" href="#name-already-implemented">Already Implemented</a><a class="pilcrow" href="#section-toc.1-1.12.2.2.1">¶</a></p>
</li>
<li class="ulEmpty toc compact" id="section-toc.1-1.12.2.3">
                <p id="section-toc.1-1.12.2.3.1"><a class="xref" href="#section-a.3">A.3</a>.  <a class="xref" href="#name-partially-implemented">Partially Implemented</a><a class="pilcrow" href="#section-toc.1-1.12.2.3.1">¶</a></p>
</li>
</ul>
</li>
<li class="ulEmpty toc compact" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a class="xref" href="#section-appendix.b"></a><a class="xref" href="#name-acknowledgments">Acknowledgments</a><a class="pilcrow" href="#section-toc.1-1.13.1">¶</a></p>
</li>
<li class="ulEmpty toc compact" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a class="xref" href="#section-appendix.c"></a><a class="xref" href="#name-authors-address">Author's Address</a><a class="pilcrow" href="#section-toc.1-1.14.1">¶</a></p>
</li>
</ul>
</nav>
</section>
</div>
<section id="section-1">
      <h2 id="name-introduction">
<a class="section-number selfRef" href="#section-1">1. </a><a class="section-name selfRef" href="#name-introduction">Introduction</a>
      </h2>
<p id="section-1-1">Multicast DNS <span>[<a class="xref" href="#RFC6762">RFC6762</a>]</span> and its
      companion technology DNS-based Service Discovery <span>[<a class="xref" href="#RFC6763">RFC6763</a>]</span> were created to provide IP networking with the ease
      of use and autoconfiguration for which AppleTalk was well known <span>[<a class="xref" href="#RFC6760">RFC6760</a>]</span> <span>[<a class="xref" href="#ZC">ZC</a>]</span>
        <span>[<a class="xref" href="#I-D.cheshire-dnssd-roadmap">ROADMAP</a>]</span>.<a class="pilcrow" href="#section-1-1">¶</a></p>
<p id="section-1-2">For a small home network consisting of just a single link (or a few
      physical links bridged together to appear as a single logical link from
      the point of view of IP), Multicast DNS <span>[<a class="xref" href="#RFC6762">RFC6762</a>]</span> is sufficient for client devices
      to look up the ".local" host names of peers on the same home network,
      and to use Multicast DNS-based
      Service Discovery (DNS-SD) <span>[<a class="xref" href="#RFC6763">RFC6763</a>]</span> to discover services offered on that
      home network.<a class="pilcrow" href="#section-1-2">¶</a></p>
<p id="section-1-3">For a larger network consisting of multiple links that are
      interconnected using IP-layer routing instead of link-layer bridging,
      link-local Multicast DNS alone is insufficient because link-local
      Multicast DNS packets, by design, are not propagated onto other
      links.<a class="pilcrow" href="#section-1-3">¶</a></p>
<p id="section-1-4">Using link-local multicast packets for Multicast DNS was a conscious
      design choice <span>[<a class="xref" href="#RFC6762">RFC6762</a>]</span>.  Even when
      limited to a single link, multicast traffic is still generally
      considered to be more expensive than unicast, because multicast traffic
      impacts many devices instead of just a single recipient.  In addition,
      with some technologies like Wi-Fi <span>[<a class="xref" href="#IEEE-11">IEEE-11</a>]</span>, multicast traffic is inherently less
      efficient and less reliable than unicast, because Wi-Fi multicast
      traffic is sent at lower data rates, and is not acknowledged <span>[<a class="xref" href="#I-D.ietf-mboned-ieee802-mcast-problems">MCAST</a>]</span>.
      Increasing the amount of expensive multicast traffic by flooding it
      across multiple links would make the traffic load even worse.<a class="pilcrow" href="#section-1-4">¶</a></p>
<p id="section-1-5">Partitioning the network into many small links curtails the spread
      of expensive multicast traffic but limits the discoverability of
      services.
      At the opposite end of the spectrum, using a very large local link with
      thousands of hosts enables better
      service discovery but at the cost of larger amounts of multicast
      traffic.<a class="pilcrow" href="#section-1-5">¶</a></p>
<p id="section-1-6">Performing DNS-based Service Discovery using purely Unicast DNS is
      more efficient and doesn't require large multicast domains but does
      require that the relevant data be available in the Unicast DNS
      namespace.
      The Unicast DNS namespace in question could fall within a traditionally
      assigned globally unique domain name, or it could be within a private
      local
      unicast domain name such as ".home.arpa" <span>[<a class="xref" href="#RFC8375">RFC8375</a>]</span>.<a class="pilcrow" href="#section-1-6">¶</a></p>
<p id="section-1-7">In the DNS-SD specification <span>[<a class="xref" href="#RFC6763">RFC6763</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc6763#section-10">Section 10</a></span> ("Populating
      the DNS with Information") discusses various possible ways that a
      service's PTR, SRV, TXT, and address records can make their way into the
      Unicast DNS namespace, including manual zone file configuration <span>[<a class="xref" href="#RFC1034">RFC1034</a>]</span> <span>[<a class="xref" href="#RFC1035">RFC1035</a>]</span>, DNS Update <span>[<a class="xref" href="#RFC2136">RFC2136</a>]</span> <span>[<a class="xref" href="#RFC3007">RFC3007</a>]</span>, and
      proxies
      of various kinds.<a class="pilcrow" href="#section-1-7">¶</a></p>
<p id="section-1-8">One option is to make the relevant data available in the Unicast DNS
      namespace by
      manual DNS configuration. This option has been used for
      many years at IETF meetings to advertise the IETF terminal room printer.
      Details of this example are given in <span><a class="relref" href="https://tools.ietf.org/html/draft-cheshire-dnssd-roadmap-03#appendix-A">Appendix A</a> of the
      Roadmap document [<a class="xref" href="#I-D.cheshire-dnssd-roadmap">ROADMAP</a>]</span>.  However, this manual DNS configuration is
      labor intensive, error prone, and requires a reasonable degree of DNS
      expertise.<a class="pilcrow" href="#section-1-8">¶</a></p>
<p id="section-1-9">Another option is to populate the Unicast DNS namespace by having
      the devices offering the services do that themselves, using DNS Update
      <span>[<a class="xref" href="#I-D.sctl-service-registration">REG-PROT</a>]</span>
        <span>[<a class="xref" href="#I-D.sekar-dns-ul">DNS-UL</a>]</span>.
      However, this requires configuration
      of DNS Update keys on those devices, which has proven onerous and
      impractical for simple devices like printers and network cameras.<a class="pilcrow" href="#section-1-9">¶</a></p>
<p id="section-1-10">Hence, to facilitate efficient and reliable DNS-based Service
      Discovery,
      a hybrid is needed that combines the ease of use of
      Multicast DNS with the efficiency and scalability of Unicast DNS.<a class="pilcrow" href="#section-1-10">¶</a></p>
<p id="section-1-11">This document specifies a type of proxy called a "Discovery Proxy"
      that uses Multicast DNS <span>[<a class="xref" href="#RFC6762">RFC6762</a>]</span>
      to discover
      Multicast DNS records on its local link on demand, and makes
      corresponding
      DNS records visible in the Unicast DNS namespace.<a class="pilcrow" href="#section-1-11">¶</a></p>
<p id="section-1-12">In principle, similar mechanisms could be defined
      for other local discovery protocols, by creating a proxy that
      (i) uses the protocol in question to discover local information on
      demand, and then
      (ii) makes corresponding DNS records visible in the Unicast
      DNS namespace. Such mechanisms for other local discovery
      protocols could be addressed in future documents.<a class="pilcrow" href="#section-1-12">¶</a></p>
<p id="section-1-13">The design of the Discovery Proxy is guided by the previously
      published DNS-based Service Discovery requirements document
      <span>[<a class="xref" href="#RFC7558">RFC7558</a>]</span>.<a class="pilcrow" href="#section-1-13">¶</a></p>
<p id="section-1-14">In simple terms, a descriptive DNS name is chosen for
      each link in an organization.
      Using a DNS NS record, responsibility for that DNS name is delegated to
      a Discovery Proxy physically attached to that link.
      When a remote client issues a unicast query for a name falling
      within
      the delegated subdomain, the normal DNS delegation mechanism
      results in the unicast query arriving at the Discovery Proxy,
      since it has been declared authoritative for those names.
      Now, instead of consulting a textual zone file on disk to discover
      the answer to the query as a traditional authoritative DNS server would,
      a Discovery Proxy consults its local link, using Multicast DNS,
      to find the answer to the question.<a class="pilcrow" href="#section-1-14">¶</a></p>
<p id="section-1-15">For fault tolerance reasons, there may be more than one
      Discovery Proxy serving a given link.<a class="pilcrow" href="#section-1-15">¶</a></p>
<p id="section-1-16">Note that the Discovery Proxy uses a "pull" model.
      Until some remote client has requested data,
      the local link is not queried using Multicast DNS.
      In the idle state, in the absence
      of client requests, the Discovery Proxy sends no packets and imposes
      no burden on the network. It operates purely "on demand".<a class="pilcrow" href="#section-1-16">¶</a></p>
<p id="section-1-17">An alternative proposal that has been discussed is a proxy that
      performs DNS updates to a remote DNS server on behalf of the Multicast
      DNS devices on the local network.  The difficulty with this is that
      Multicast DNS devices do not routinely announce their records on the
      network. Generally, they remain silent until queried.  This means that
      the complete set of Multicast DNS records in use on a link can only be
      discovered by active querying, not by passive listening.  Because of
      this, a proxy can only know what names exist on a link by issuing
      queries for them, and since it would be impractical to issue queries for
      every possible name just to find out which names exist and which do not,
      there is no reasonable way for a proxy to programmatically learn all the
      answers it would need to push up to the remote DNS server using DNS
      Update.  Even if such a mechanism were possible, it would risk
      generating high load on the network continuously, even when there are no
      clients with any interest in that data.<a class="pilcrow" href="#section-1-17">¶</a></p>
<p id="section-1-18">Hence, having a model where the query comes to the Discovery Proxy
      is much more efficient than
      a model where the Discovery Proxy pushes the answers out
      to some other remote DNS server.<a class="pilcrow" href="#section-1-18">¶</a></p>
<p id="section-1-19">A client seeking to discover services and other information performs
      this by sending traditional DNS queries to the Discovery Proxy or by
      sending DNS Push Notification subscription requests <span>[<a class="xref" href="#RFC8765">RFC8765</a>]</span>.<a class="pilcrow" href="#section-1-19">¶</a></p>
<p id="section-1-20">How a client discovers what domain name(s) to use for its
      DNS-based Service Discovery queries
      (and, consequently, what Discovery Proxy or Proxies to use)
      is described in <a class="xref" href="#dom-enum">Section 5.2</a>.<a class="pilcrow" href="#section-1-20">¶</a></p>
<p id="section-1-21">The diagram below illustrates a network topology using a
      Discovery Proxy to provide discovery service to a remote client.<a class="pilcrow" href="#section-1-21">¶</a></p>
<span id="name-example-deployment"></span><figure id="figure-1">
        <div class="artwork art-text alignCenter" id="section-1-22.1">
<pre> +--------+   Unicast     +-----------+  +---------+  +---------+
 | Remote | Communication | Discovery |  | Network |  | Network |
 | Client |---- . . . ----|   Proxy   |  | Printer |  | Camera  |
 +--------+               +-----------+  +---------+  +---------+
      |                         |             |            |
------------            --------------------------------------------
                       Multicast-capable LAN segment (e.g., Ethernet)

</pre>
</div>
<figcaption><a class="selfRef" href="#figure-1">Figure 1</a>:
<a class="selfRef" href="#name-example-deployment">Example Deployment</a>
        </figcaption></figure>
<p id="section-1-23">Note that there need not be any Discovery Proxy on the link
      to which the remote client is directly attached.
      The remote client communicates directly with the Discovery Proxy
      using normal unicast TCP/IP communication mechanisms,
      potentially spanning multiple IP hops,
      possibly including VPN tunnels and other similar
      long-distance communication channels.<a class="pilcrow" href="#section-1-23">¶</a></p>
</section>
<section id="section-2">
      <h2 id="name-operational-analogy">
<a class="section-number selfRef" href="#section-2">2. </a><a class="section-name selfRef" href="#name-operational-analogy">Operational Analogy</a>
      </h2>
<p id="section-2-1">A Discovery Proxy does not operate as a multicast relay or multicast
      forwarder.  There is no danger of multicast forwarding loops that result
      in traffic storms, because no multicast packets are forwarded.  A
      Discovery Proxy operates as a <em>proxy</em> for remote clients,
      performing
      queries on their behalf and reporting the results back.<a class="pilcrow" href="#section-2-1">¶</a></p>
<p id="section-2-2">A reasonable analogy is making a telephone call to a colleague at
      your workplace and saying, "I'm out of the office right now. Would you
      mind bringing up a printer browser window and telling me the names of
      the printers you see?" That entails no risk of a forwarding loop causing
      a traffic storm, because no multicast packets are sent over the
      telephone call.<a class="pilcrow" href="#section-2-2">¶</a></p>
<p id="section-2-3">A similar analogy, instead of enlisting another human being
      to initiate the service discovery operation on your behalf, is
      to log in to your own desktop work computer using screen sharing
      and then run the printer browser yourself to see the list of printers.
      Or, log in using Secure Shell (ssh) and type "dns-sd -B _ipp._tcp" and
      observe the
      list of discovered printer names. In neither case is there any risk
      of a forwarding loop causing a traffic storm, because no multicast
      packets are being sent over the screen-sharing or ssh connection.<a class="pilcrow" href="#section-2-3">¶</a></p>
<p id="section-2-4">The Discovery Proxy provides another way of performing remote
      queries,
      which uses a different protocol instead of screen sharing or ssh.
      The Discovery Proxy mechanism can be thought of as a custom Remote
      Procedure Call (RPC) protocol that allows a remote client to exercise
      the Multicast DNS APIs on the Discovery Proxy device, just as a local
      client running on the Discovery Proxy device would use those APIs.<a class="pilcrow" href="#section-2-4">¶</a></p>
<p id="section-2-5">When the Discovery Proxy software performs Multicast DNS
      operations, the exact same Multicast DNS caching mechanisms are
      applied as when any other client software on that Discovery Proxy
      device performs Multicast DNS operations, regardless of whether that be
      running
      a printer browser client locally, a remote user running the
      printer browser client via a screen-sharing connection, a remote
      user logged in via ssh running a command-line tool like "dns-sd",
      or a remote user sending DNS requests that cause a Discovery Proxy
      to perform discovery operations on its behalf.<a class="pilcrow" href="#section-2-5">¶</a></p>
</section>
<section id="section-3">
      <h2 id="name-conventions-and-terminology">
<a class="section-number selfRef" href="#section-3">3. </a><a class="section-name selfRef" href="#name-conventions-and-terminology">Conventions and Terminology Used in This Document</a>
      </h2>
<p id="section-3-1">
    The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>",
    "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>",
    "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
    "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are
    to be interpreted as
    described in BCP 14 <span>[<a class="xref" href="#RFC2119">RFC2119</a>]</span> <span>[<a class="xref" href="#RFC8174">RFC8174</a>]</span> 
    when, and only when, they appear in all capitals, as shown here.<a class="pilcrow" href="#section-3-1">¶</a></p>
<p id="section-3-2">The Discovery Proxy builds on Multicast DNS,
      which works between hosts on the same link.
      For the purposes of this document,
      a set of hosts is considered to be "on the same link" if:<a class="pilcrow" href="#section-3-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-3.1">when any host from that set sends a packet to any other host
        in that set, using unicast, multicast, or broadcast, the entire
        link-layer packet payload arrives unmodified, and<a class="pilcrow" href="#section-3-3.1">¶</a>
</li>
<li class="normal" id="section-3-3.2">a broadcast sent over that link, by any host from that set of
 hosts,
        can be received by every other host in that set.<a class="pilcrow" href="#section-3-3.2">¶</a>
</li>
</ul>
<p id="section-3-4">

      The link-layer <em>header</em> may be modified, such as in Token Ring
      Source Routing
      <span>[<a class="xref" href="#IEEE-5">IEEE-5</a>]</span>,
      but not the link-layer <em>payload</em>.
      In particular, if any device forwarding a packet modifies any
      part of the IP header or IP payload, then the packet is no longer
      considered to be on the same link. This means that the packet may
      pass through devices such as repeaters, bridges, hubs, or switches
      and still be considered to be on the same link for the purpose of
      this document, but not through a device such as an IP router that
      decrements the IP TTL or otherwise modifies the IP header.<a class="pilcrow" href="#section-3-4">¶</a></p>
</section>
<div id="compatibility">
<section id="section-4">
      <h2 id="name-compatibility-consideration">
<a class="section-number selfRef" href="#section-4">4. </a><a class="section-name selfRef" href="#name-compatibility-consideration">Compatibility Considerations</a>
      </h2>
<p id="section-4-1">No changes to existing devices are required to work with a Discovery
      Proxy.<a class="pilcrow" href="#section-4-1">¶</a></p>
<p id="section-4-2">Existing devices that advertise services using Multicast DNS work
      with a Discovery Proxy.<a class="pilcrow" href="#section-4-2">¶</a></p>
<p id="section-4-3">Existing clients that support DNS-based Service Discovery over
      Unicast DNS work with a Discovery Proxy.  DNS-based Service Discovery
      over Unicast
      DNS was introduced in Mac OS X 10.4 Tiger in April 2005 and has been
      included in
      Apple products introduced since then, including the iPhone and iPad.
      It has also been included in
      products from other vendors, such as Microsoft Windows 10.<a class="pilcrow" href="#section-4-3">¶</a></p>
<p id="section-4-4">An overview of the larger collection of associated DNS-based Service
      Discovery
      technologies, and how the Discovery Proxy technology relates to those,
      is given in the
      Service Discovery Road Map document <span>[<a class="xref" href="#I-D.cheshire-dnssd-roadmap">ROADMAP</a>]</span>.<a class="pilcrow" href="#section-4-4">¶</a></p>
</section>
</div>
<div id="operation">
<section id="section-5">
      <h2 id="name-discovery-proxy-operation">
<a class="section-number selfRef" href="#section-5">5. </a><a class="section-name selfRef" href="#name-discovery-proxy-operation">Discovery Proxy Operation</a>
      </h2>
<p id="section-5-1">In a typical configuration, a Discovery Proxy is configured
      to be authoritative <span>[<a class="xref" href="#RFC1034">RFC1034</a>]</span> <span>[<a class="xref" href="#RFC1035">RFC1035</a>]</span>
      for four or more DNS subdomains, listed below.
      Authority for these subdomains is delegated
      from the parent domain to the Discovery Proxy
      in the usual way for DNS delegation, via NS records.<a class="pilcrow" href="#section-5-1">¶</a></p>
<dl class="dlNewline" id="section-5-2">
        <dt id="section-5-2.1">A DNS subdomain for DNS-based Service Discovery records.</dt>
<dd id="section-5-2.2">
          This subdomain name may contain rich text, including
          spaces and other punctuation. This is because this
          subdomain name is used only in graphical user interfaces,
          where rich text is appropriate.<a class="pilcrow" href="#section-5-2.2">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-5-2.3">A DNS subdomain for host name records.</dt>
<dd id="section-5-2.4">
          This subdomain name <span class="bcp14">SHOULD</span> be limited to letters,
     digits, and
         hyphens in order to facilitate the convenient use of host
 names in
     command-line
           interfaces.<a class="pilcrow" href="#section-5-2.4">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-5-2.5">One or more DNS subdomains for IPv4 Reverse Mapping records.</dt>
<dd id="section-5-2.6">
          These subdomains will have names that end in "in-addr.arpa".<a class="pilcrow" href="#section-5-2.6">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-5-2.7">One or more DNS subdomains for IPv6 Reverse Mapping records.</dt>
<dd id="section-5-2.8">
          These subdomains will have names that end in "ip6.arpa".<a class="pilcrow" href="#section-5-2.8">¶</a>
</dd>
<dd class="break"></dd>
</dl>
<p id="section-5-3">In an enterprise network, the naming and delegation of these
      subdomains
      is typically performed by conscious action of the network administrator.
      In a home network, naming and delegation would typically be performed
      using some automatic configuration mechanism such as Home Networking
      Control Protocol (HNCP)
      <span>[<a class="xref" href="#RFC7788">RFC7788</a>]</span>.<a class="pilcrow" href="#section-5-3">¶</a></p>
<p id="section-5-4">These three varieties of delegated subdomains
      (service discovery, host names, and reverse mapping) are described below
      in Sections <a class="xref" href="#dom-sd">5.1</a>, <a class="xref" href="#dom-host">5.3</a>, and <a class="xref" href="#dom-rev">5.4</a>.<a class="pilcrow" href="#section-5-4">¶</a></p>
<p id="section-5-5">How a client discovers where to issue its DNS-based Service Discovery
      queries
      is described in <a class="xref" href="#dom-enum">Section 5.2</a>.<a class="pilcrow" href="#section-5-5">¶</a></p>
<div id="dom-sd">
<section id="section-5.1">
        <h3 id="name-delegated-subdomain-for-dns">
<a class="section-number selfRef" href="#section-5.1">5.1. </a><a class="section-name selfRef" href="#name-delegated-subdomain-for-dns">Delegated Subdomain for DNS-based Service Discovery
 Records</a>
        </h3>
<p id="section-5.1-1">In its simplest form, each link in an organization
      is assigned a unique Unicast DNS domain name such as
      "Building 1.example.com" or
      "2nd Floor.Building 3.example.com".
      Grouping multiple links under a single Unicast DNS domain
      name is to be specified in a future companion document, but for
      the purposes of this document, assume that each link has its own
      unique Unicast DNS domain name.
      In a graphical user interface these names are not displayed
      as strings with dots as shown above, but something more
      akin to a typical file browser graphical user interface
      (which is harder to illustrate in a text-only document)
      showing folders, subfolders, and files in a file system.<a class="pilcrow" href="#section-5.1-1">¶</a></p>
<span id="name-illustrative-gui"></span><div id="browser">
<figure id="figure-2">
          <div class="artwork art-text alignCenter" id="section-5.1-2.1">
<pre> +---------------+--------------+-------------+-------------------+
 | *example.com* |  Building 1  |  1st Floor  | Alice's printer   |
 |               |  Building 2  | *2nd Floor* | Bob's printer     |
 |               | *Building 3* |  3rd Floor  | Charlie's printer |
 |               |  Building 4  |  4th Floor  |                   |
 |               |  Building 5  |             |                   |
 |               |  Building 6  |             |                   |
 +---------------+--------------+-------------+-------------------+

</pre>
</div>
<figcaption><a class="selfRef" href="#figure-2">Figure 2</a>:
<a class="selfRef" href="#name-illustrative-gui">Illustrative GUI</a>
          </figcaption></figure>
</div>
<p id="section-5.1-3">Each named link in an organization has one or more Discovery
        Proxies that serve it. This Discovery Proxy function
        could be performed by a device like a router or switch that is
        physically attached to that link.  In the parent domain, NS records
        are used to delegate ownership of each defined link name
        (e.g., "Building 1.example.com") to one or more
        Discovery Proxies that serve the named link.  In other words, the
        Discovery Proxies are the authoritative name servers for that
        subdomain.  As in the rest of DNS-based Service Discovery, all names
        are represented as-is using plain UTF-8 encoding and, as described in
        <a class="xref" href="#notrans">Section 5.5.4</a>, no text-encoding
        translations are performed.<a class="pilcrow" href="#section-5.1-3">¶</a></p>
<p id="section-5.1-4">With appropriate VLAN
        configuration <span>[<a class="xref" href="#IEEE-1Q">IEEE-1Q</a>]</span>, a
 single Discovery Proxy device could have a
        logical presence on many links and serve as the Discovery Proxy for
        all those links.  In such a configuration, the Discovery Proxy device
        would have a single physical Ethernet <span>[<a class="xref" href="#IEEE-3">IEEE-3</a>]</span> port, configured as a VLAN trunk
        port, which would appear to software on that device as multiple
        virtual Ethernet interfaces, one connected to each of the VLAN
        links.<a class="pilcrow" href="#section-5.1-4">¶</a></p>
<p id="section-5.1-5">As an alternative to using VLAN technology, using a Multicast DNS
 Discovery Relay
      <span>[<a class="xref" href="#I-D.sctl-dnssd-mdns-relay">RELAY</a>]</span>
      is another way that a Discovery Proxy can have
      a "virtual" presence on a remote link.<a class="pilcrow" href="#section-5.1-5">¶</a></p>
<p id="section-5.1-6">When a DNS-SD client issues a Unicast DNS query to discover
        services in a particular Unicast DNS subdomain
        (e.g., "_ipp._tcp.Building 1.example.com. PTR ?"),
        the normal DNS delegation mechanism results in that query being
        forwarded until it reaches the delegated authoritative name server for
        that subdomain, namely, the Discovery Proxy on the link in question.
        Like a conventional Unicast DNS server, a Discovery Proxy implements
        the usual Unicast DNS protocol <span>[<a class="xref" href="#RFC1034">RFC1034</a>]</span> <span>[<a class="xref" href="#RFC1035">RFC1035</a>]</span> over UDP
        and TCP.  However, unlike a conventional Unicast DNS server that
        generates answers from the data in its manually configured zone file,
        a Discovery Proxy learns answers using Multicast DNS.  A Discovery
        Proxy does this by consulting its Multicast DNS cache and/or issuing
        Multicast DNS queries, as appropriate according to the usual protocol
        rules of Multicast DNS <span>[<a class="xref" href="#RFC6762">RFC6762</a>]</span>,
        for the corresponding Multicast DNS name, type, and class, with the
        delegated zone part of the name replaced with ".local" (e.g., in
        this case, "_ipp._tcp.local. PTR ?").  Then, from the
        received Multicast DNS data, the Discovery Proxy synthesizes the
        appropriate Unicast DNS response, with the ".local" top-level label
        of the owner name
        replaced with the name of the delegated zone.
        Further details of the name translation rules are
        described in <a class="xref" href="#translation">Section 5.5</a>.
        Rules specifying how long the Discovery
        Proxy should wait to accumulate Multicast DNS responses before sending
        its unicast reply are described in <a class="xref" href="#aggregation">Section 5.6</a>.<a class="pilcrow" href="#section-5.1-6">¶</a></p>
<p id="section-5.1-7">The existing Multicast DNS caching mechanism is used to minimize
        unnecessary Multicast DNS queries on the wire.  The Discovery Proxy is
        acting as a client of the underlying Multicast DNS subsystem and
        benefits from the same caching and efficiency measures as any other
        client using that subsystem.<a class="pilcrow" href="#section-5.1-7">¶</a></p>
<p id="section-5.1-8">Note that the contents of the delegated zone, generated as it is by
        performing ".local" Multicast DNS queries, mirrors the records
        available on the local link via Multicast DNS very closely, but not
        precisely.  There is not a full bidirectional equivalence between the
        two.  Certain records that are available via Multicast DNS may not
        have equivalents in the delegated zone possibly because they are
        invalid or not relevant in the delegated zone or because they are
        being suppressed because they are unusable outside the local link (see
        <a class="xref" href="#unusable">Section 5.5.2</a>).  Conversely, certain
        records that appear in the delegated zone may not have corresponding
        records available on the local link via Multicast DNS.  In particular,
        there are certain administrative SRV records (see <a class="xref" href="#admin">Section 6</a>) that logically fall within the delegated zone but
        semantically represent metadata <em>about</em> the zone rather than
 records
        <em>within</em> the zone. Consequently, these administrative records
 in
        the delegated zone do not have any corresponding counterparts in the
        Multicast DNS namespace of the local link.<a class="pilcrow" href="#section-5.1-8">¶</a></p>
</section>
</div>
<div id="dom-enum">
<section id="section-5.2">
        <h3 id="name-domain-enumeration">
<a class="section-number selfRef" href="#section-5.2">5.2. </a><a class="section-name selfRef" href="#name-domain-enumeration">Domain Enumeration</a>
        </h3>
<p id="section-5.2-1">A DNS-SD client performs Domain Enumeration <span>[<a class="xref" href="#RFC6763">RFC6763</a>]</span> via certain PTR queries, using both unicast and
        multicast.<a class="pilcrow" href="#section-5.2-1">¶</a></p>
<p id="section-5.2-2">If a DNS-SD client receives a Domain Name configuration via DHCP
 then it issues
        unicast queries derived from this domain name.  It also issues unicast
 queries using
        names derived from its IPv4 subnet address(es) and IPv6 prefix(es).
        These unicast Domain Enumeration queries are described
        in <a class="xref" href="#unicast">Section 5.2.1</a>.
        A DNS-SD client
        also issues multicast Domain Enumeration queries in the "local" domain
        <span>[<a class="xref" href="#RFC6762">RFC6762</a>]</span>, as described in
        <a class="xref" href="#multicast">Section 5.2.2</a>.  The results of all the
        Domain Enumeration queries are combined for DNS-based Service
 Discovery
        purposes.<a class="pilcrow" href="#section-5.2-2">¶</a></p>
<div id="unicast">
<section id="section-5.2.1">
          <h4 id="name-domain-enumeration-via-unic">
<a class="section-number selfRef" href="#section-5.2.1">5.2.1. </a><a class="section-name selfRef" href="#name-domain-enumeration-via-unic">Domain Enumeration via Unicast Queries</a>
          </h4>
<p id="section-5.2.1-1">The (human or automated) administrator creates
          Unicast DNS Domain Enumeration PTR records <span>[<a class="xref" href="#RFC6763">RFC6763</a>]</span> to inform clients of available
          service discovery domains.  Two varieties of such Unicast DNS Domain
     Enumeration
          PTR records exist: those with names derived from the domain name
          communicated to the clients via
          <span><a class="xref" href="#RFC2132">DHCP option 15</a> [<a class="xref" href="#RFC2132">RFC2132</a>]</span>,
          and those with names derived
          from either IPv4 subnet address(es) or IPv6 prefix(es) in use by the
          clients.  Below is an example showing the name-based variety,
          where the DHCP server configured the client with the domain name
          "example.com":<a class="pilcrow" href="#section-5.2.1-1">¶</a></p>
<div class="artwork art-text alignCenter" id="section-5.2.1-2">
<pre>    b._dns-sd._udp.example.com.    PTR   Building 1.example.com.
                                   PTR   Building 2.example.com.
                                   PTR   Building 3.example.com.
                                   PTR   Building 4.example.com.

    db._dns-sd._udp.example.com.   PTR   Building 1.example.com.

    lb._dns-sd._udp.example.com.   PTR   Building 1.example.com.</pre><a class="pilcrow" href="#section-5.2.1-2">¶</a>
</div>
<p id="section-5.2.1-3">The meaning of these records is defined in the <span><a class="xref" href="#RFC6763">DNS-based Service
          Discovery specification</a> [<a class="xref" href="#RFC6763">RFC6763</a>]</span> but, for convenience, is repeated
     here.
          The "b" ("browse") records tell the client device the list of
          browsing domains to display for the user to select from.  The "db"
          ("default browse") record tells the client device which domain in
          that list should be selected by default.  The "db" domain
          <span class="bcp14">MUST</span> be one of the domains in the "b" list; if not,
          then no domain is selected by default.  The "lb" ("legacy browse")
          record tells the client device which domain to automatically browse
          on behalf of applications that don't implement user interface for
     multi-domain
          browsing (which is most of them at the time of writing).  The "lb"
          domain is often the same as the "db" domain, or sometimes the "db"
          domain plus one or more others that should be included in the list
          of automatic browsing domains for legacy clients.<a class="pilcrow" href="#section-5.2.1-3">¶</a></p>
<p id="section-5.2.1-4">Note that in the example above, for clarity, space characters in
          names are shown as actual spaces.  If this data is manually entered
          into a textual zone file for authoritative server software such as
          BIND, care must be taken because the space character is used as a
          field separator, and other characters like dot ('.'), semicolon
          (';'), dollar ('$'), backslash ('\'), etc., also have special
          meaning.  These characters have to be escaped when entered into a
          textual zone file, following the rules in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc1035#section-5.1">Section 5.1</a> of the DNS specification [<a class="xref" href="#RFC1035">RFC1035</a>]</span>.  For
          example, a literal space in a name is represented in the textual
          zone file using '\032', so "Building 1.example.com" is entered
          as "Building\0321.example.com".<a class="pilcrow" href="#section-5.2.1-4">¶</a></p>
<p id="section-5.2.1-5">DNS responses are limited to a maximum size of 65535 bytes.
        This limits the maximum number of domains that can be returned for
        a Domain Enumeration query as follows:<a class="pilcrow" href="#section-5.2.1-5">¶</a></p>
<p id="section-5.2.1-6">A DNS response header is 12 bytes.
        That's typically followed by a single qname (up to 256 bytes)
        plus qtype (2 bytes) and qclass (2 bytes), leaving 65275
        for the Answer Section.<a class="pilcrow" href="#section-5.2.1-6">¶</a></p>
<p id="section-5.2.1-7">An Answer Section Resource Record consists of:<a class="pilcrow" href="#section-5.2.1-7">¶</a></p>
<ul class="compact">
<li class="compact" id="section-5.2.1-8.1">Owner name, encoded as a compression pointer, 2 bytes<a class="pilcrow" href="#section-5.2.1-8.1">¶</a>
</li>
<li class="compact" id="section-5.2.1-8.2">RRTYPE (type PTR), 2 bytes<a class="pilcrow" href="#section-5.2.1-8.2">¶</a>
</li>
<li class="compact" id="section-5.2.1-8.3">RRCLASS (class IN), 2 bytes<a class="pilcrow" href="#section-5.2.1-8.3">¶</a>
</li>
<li class="compact" id="section-5.2.1-8.4">TTL, 4 bytes<a class="pilcrow" href="#section-5.2.1-8.4">¶</a>
</li>
<li class="compact" id="section-5.2.1-8.5">RDLENGTH, 2 bytes<a class="pilcrow" href="#section-5.2.1-8.5">¶</a>
</li>
<li class="compact" id="section-5.2.1-8.6">RDATA (domain name), up to 256 bytes<a class="pilcrow" href="#section-5.2.1-8.6">¶</a>
</li>
</ul>
<p id="section-5.2.1-9">This means that each Resource Record in the Answer Section can
        take up to 268 bytes total, which means that the Answer Section
        can contain, in the worst case, no more than 243 domains.<a class="pilcrow" href="#section-5.2.1-9">¶</a></p>
<p id="section-5.2.1-10">In a more typical scenario, where the domain names are not all
        maximum-sized names, and there is some similarity between names
        so that reasonable name compression is possible, each Answer
        Section Resource Record may average 140 bytes, which means that
        the Answer Section can contain up to 466 domains.<a class="pilcrow" href="#section-5.2.1-10">¶</a></p>
<p id="section-5.2.1-11">It is anticipated that this should be sufficient for even a large
        corporate network or university campus.<a class="pilcrow" href="#section-5.2.1-11">¶</a></p>
</section>
</div>
<div id="multicast">
<section id="section-5.2.2">
          <h4 id="name-domain-enumeration-via-mult">
<a class="section-number selfRef" href="#section-5.2.2">5.2.2. </a><a class="section-name selfRef" href="#name-domain-enumeration-via-mult">Domain Enumeration via Multicast Queries</a>
          </h4>
<p id="section-5.2.2-1">In the case where Discovery Proxy functionality is widely
          deployed within an enterprise (either by having a Discovery Proxy
     physically on
          each link, or by having a Discovery Proxy with a remote "virtual"
          presence on each link using VLANs or Multicast DNS Discovery Relays
          <span>[<a class="xref" href="#I-D.sctl-dnssd-mdns-relay">RELAY</a>]</span>),
          this offers an additional way to provide Domain Enumeration
     configuration data for
          clients.<a class="pilcrow" href="#section-5.2.2-1">¶</a></p>
<p id="section-5.2.2-2">Note that this function of the Discovery Proxy is
          supplementary to the primary purpose of the Discovery Proxy,
          which is to facilitate <em>remote</em> clients discovering services
          on the Discovery Proxy's local link.
          This publication of Domain Enumeration configuration data
          via link-local multicast on the Discovery
          Proxy's local link is performed for the benefit of <em>local</em>
     clients
          attached to that link, and typically directs those clients to
          contact other distant Discovery Proxies attached to other links.
          Generally, a client does not need to use the local Discovery
          Proxy on its own link, because a client is generally able to
          perform its own Multicast DNS queries on that link.
          (The exception to this is when the local Wi-Fi access point is
          blocking or filtering local multicast traffic, requiring even local
          clients to use their local Discovery Proxy to perform local
     discovery.)<a class="pilcrow" href="#section-5.2.2-2">¶</a></p>
<p id="section-5.2.2-3">A Discovery Proxy can be configured to generate Multicast DNS
     responses
        for the following Multicast DNS Domain Enumeration queries issued by
 clients:<a class="pilcrow" href="#section-5.2.2-3">¶</a></p>
<div class="artwork art-text alignLeft" id="section-5.2.2-4">
<pre>    b._dns-sd._udp.local.    PTR   ?
    db._dns-sd._udp.local.   PTR   ?
    lb._dns-sd._udp.local.   PTR   ?</pre><a class="pilcrow" href="#section-5.2.2-4">¶</a>
</div>
<p id="section-5.2.2-5">This provides the ability for Discovery Proxies to indicate
          recommended browsing domains to DNS-SD clients on a per-link
          granularity. In some enterprises, it may be preferable to provide
          this per-link configuration information in the form of Discovery
     Proxy
          configuration data rather than by populating the Unicast DNS servers
     with
          the same data (in the "ip6.arpa" or "in-addr.arpa" domains).<a class="pilcrow" href="#section-5.2.2-5">¶</a></p>
<p id="section-5.2.2-6">Regardless of how the network operator chooses to provide this
     configuration
        data, clients will perform Domain Enumeration via both unicast and
 multicast
        queries and then combine the results of these queries.<a class="pilcrow" href="#section-5.2.2-6">¶</a></p>
</section>
</div>
</section>
</div>
<div id="dom-host">
<section id="section-5.3">
        <h3 id="name-delegated-subdomain-for-ldh">
<a class="section-number selfRef" href="#section-5.3">5.3. </a><a class="section-name selfRef" href="#name-delegated-subdomain-for-ldh">Delegated Subdomain for LDH Host Names</a>
        </h3>
<p id="section-5.3-1">DNS-SD service instance names and domains are allowed
        to contain arbitrary Net-Unicode text <span>[<a class="xref" href="#RFC5198">RFC5198</a>]</span>,
        encoded as precomposed UTF-8 <span>[<a class="xref" href="#RFC3629">RFC3629</a>]</span>.<a class="pilcrow" href="#section-5.3-1">¶</a></p>
<p id="section-5.3-2">Users typically interact with service discovery software by
        viewing a list of discovered service instance names on a display
        and selecting one of them by pointing, touching, or clicking.
        Similarly, in software that provides a multi-domain DNS-SD user
        interface, users view a list of offered domains on the display
        and select one of them by pointing, touching, or clicking.
        To use a service, users don't have to remember domain or instance
        names, or type them; users just have to be able to recognize what
        they see on the display and touch or click on the thing they want.<a class="pilcrow" href="#section-5.3-2">¶</a></p>
<p id="section-5.3-3">In contrast, host names are often remembered and typed.  Also, host
        names have historically been used in command-line interfaces where
        spaces can be inconvenient. For this reason, host names have
        traditionally been restricted to letters, digits, and hyphens (LDH)
        with no spaces or other punctuation.<a class="pilcrow" href="#section-5.3-3">¶</a></p>
<p id="section-5.3-4">While we do want to allow
        rich text for DNS-SD service instance names and domains, it is
        advisable, for maximum compatibility with existing usage, to restrict
        host names to the traditional letter-digit-hyphen rules.  This means
        that while the service name
        "My Printer._ipp._tcp.Building 1.example.com" is acceptable
        and desirable (it is displayed in a graphical user interface as an
        instance called "My Printer" in the domain "Building 1" at
        "example.com"), the host name "My-Printer.Building 1.example.com"
        is less desirable (because of the space in "Building 1").<a class="pilcrow" href="#section-5.3-4">¶</a></p>
<p id="section-5.3-5">To accommodate this difference in allowable characters, a Discovery
        Proxy <span class="bcp14">SHOULD</span> support having two separate subdomains
        delegated to it for each link it serves: one whose name is allowed to
        contain arbitrary Net-Unicode text <span>[<a class="xref" href="#RFC5198">RFC5198</a>]</span>, and a second more constrained subdomain whose name
        is restricted to contain only letters, digits, and hyphens, to be used
        for host name records (names of 'A' and 'AAAA' address records).  The
        restricted names may be any valid name consisting of only letters,
        digits, and hyphens, including Punycode-encoded names <span>[<a class="xref" href="#RFC3492">RFC3492</a>]</span>.<a class="pilcrow" href="#section-5.3-5">¶</a></p>
<p id="section-5.3-6">For example, a Discovery Proxy could have the two subdomains
        "Building 1.example.com" and "bldg‑1.example.com" delegated
 to it.
        The Discovery Proxy would then translate these two Multicast DNS
 records:<a class="pilcrow" href="#section-5.3-6">¶</a></p>
<div class="artwork art-text alignLeft" id="section-5.3-7">
<pre>   My Printer._ipp._tcp.local. SRV 0 0 631 prnt.local.
   prnt.local.                 A   203.0.113.2</pre><a class="pilcrow" href="#section-5.3-7">¶</a>
</div>
<p id="section-5.3-8">into Unicast DNS records as follows:<a class="pilcrow" href="#section-5.3-8">¶</a></p>
<div class="artwork art-text alignLeft" id="section-5.3-9">
<pre>   My Printer._ipp._tcp.Building 1.example.com.
                               SRV 0 0 631 prnt.bldg-1.example.com.
   prnt.bldg-1.example.com.     A   203.0.113.2</pre><a class="pilcrow" href="#section-5.3-9">¶</a>
</div>
<p id="section-5.3-10">Note that the SRV record name is translated using the rich-text
        domain name ("Building 1.example.com"), and the address record
        name is translated using the LDH domain ("bldg‑1.example.com").
        Further details of the name translation rules are
        described in <a class="xref" href="#translation">Section 5.5</a>.<a class="pilcrow" href="#section-5.3-10">¶</a></p>
<p id="section-5.3-11">A Discovery Proxy <span class="bcp14">MAY</span> support only a single
        rich-text Net-Unicode domain and use that domain for all records,
        including 'A' and 'AAAA' address records, but implementers choosing
        this option should be aware that this choice may produce host names
        that are awkward to use in command-line environments.  Whether or not
 this is
        an issue depends on whether users in the target environment are
        expected to be using command-line interfaces.<a class="pilcrow" href="#section-5.3-11">¶</a></p>
<p id="section-5.3-12">A Discovery Proxy <span class="bcp14">MUST NOT</span> be restricted to support
 only a
 letter-digit-hyphen
        subdomain, because that results in an unnecessarily poor user
 experience.<a class="pilcrow" href="#section-5.3-12">¶</a></p>
<p id="section-5.3-13">As described in <a class="xref" href="#unicast">Section 5.2.1</a>, for
        clarity, in examples here space characters in names are shown as
 actual spaces.  If
        this dynamically discovered data were to be manually entered into a
 textual zone file (which
        it isn't), then spaces would need to be represented using '\032', so
        "My Printer._ipp._tcp.Building 1.example.com" would become
        "My\032Printer._ipp._tcp.Building\0321.example.com".<a class="pilcrow" href="#section-5.3-13">¶</a></p>
<p id="section-5.3-14">
Note that the '\032' representation does not appear in DNS messages
sent over the air.  In the wire format of DNS messages, spaces are sent as
spaces, not as '\032', and likewise, in a graphical user interface at the
client device, spaces are shown as spaces, not as '\032'.<a class="pilcrow" href="#section-5.3-14">¶</a></p>
</section>
</div>
<div id="dom-rev">
<section id="section-5.4">
        <h3 id="name-delegated-subdomain-for-rev">
<a class="section-number selfRef" href="#section-5.4">5.4. </a><a class="section-name selfRef" href="#name-delegated-subdomain-for-rev">Delegated Subdomain for Reverse Mapping</a>
        </h3>
<p id="section-5.4-1">A Discovery Proxy can facilitate easier management of reverse
        mapping domains, particularly for IPv6 addresses where manual
        management may be more onerous than it is for IPv4 addresses.<a class="pilcrow" href="#section-5.4-1">¶</a></p>
<p id="section-5.4-2">To achieve this, in the parent domain, NS records are used to
        delegate ownership of the appropriate reverse mapping domain to
        the Discovery Proxy. In other words, the Discovery Proxy becomes the
        authoritative name server for the reverse mapping domain.
        For fault tolerance reasons, there may be more than one
        Discovery Proxy serving a given link.<a class="pilcrow" href="#section-5.4-2">¶</a></p>
<p id="section-5.4-3">If a given link is using the IPv4 subnet 203.0.113/24, 
        then the domain "113.0.203.in-addr.arpa" 
        is delegated to the Discovery Proxy for that link.<a class="pilcrow" href="#section-5.4-3">¶</a></p>
<p id="section-5.4-4">If a given link is using the 
        IPv6 prefix 2001:0DB8:1234:5678::/64, 
        then the domain "8.7.6.5.4.3.2.1.8.b.d.0.1.0.0.2.ip6.arpa" 
        is delegated to the Discovery Proxy for that link.<a class="pilcrow" href="#section-5.4-4">¶</a></p>
<p id="section-5.4-5">When a reverse mapping query arrives at the Discovery Proxy, it
        issues the identical query on its local link, as a Multicast DNS
 query.
        The mechanism to force an apparently unicast name to be resolved using
        link-local Multicast DNS varies depending on the API set being used.
        For example, in the "dns_sd.h" APIs (available on macOS, iOS, Bonjour
        for Windows, Linux, and Android), using kDNSServiceFlagsForceMulticast
        indicates that the DNSServiceQueryRecord() call should perform the
        query using Multicast DNS.  Other API sets have different ways of
        forcing multicast queries.  When the host owning that IPv4 or IPv6
        address responds with a name of the form "something.local", the
        Discovery Proxy rewrites it to use its configured LDH host name
        domain instead of ".local" and returns the response to the caller.<a class="pilcrow" href="#section-5.4-5">¶</a></p>
<p id="section-5.4-6">For example, a Discovery Proxy with the two subdomains
        "113.0.203.in‑addr.arpa" and "bldg‑1.example.com" delegated
 to it
        would translate this Multicast DNS record:<a class="pilcrow" href="#section-5.4-6">¶</a></p>
<div class="artwork art-text alignLeft" id="section-5.4-7">
<pre>   2.113.0.203.in-addr.arpa. PTR prnt.local.</pre><a class="pilcrow" href="#section-5.4-7">¶</a>
</div>
<p id="section-5.4-8">into this Unicast DNS response:<a class="pilcrow" href="#section-5.4-8">¶</a></p>
<div class="artwork art-text alignLeft" id="section-5.4-9">
<pre>   2.113.0.203.in-addr.arpa. PTR prnt.bldg-1.example.com.</pre><a class="pilcrow" href="#section-5.4-9">¶</a>
</div>
<p id="section-5.4-10">In this example the "prnt.local" host name is translated
        using the delegated LDH subdomain, as described in
        <a class="xref" href="#translation">Section 5.5</a>.<a class="pilcrow" href="#section-5.4-10">¶</a></p>
<p id="section-5.4-11">Subsequent queries for the prnt.bldg‑1.example.com address
        record, falling as it does within the bldg‑1.example.com domain,
        which is delegated to this Discovery Proxy, will arrive at this
        Discovery Proxy where they are answered by issuing Multicast DNS
 queries
        and using the received Multicast DNS answers to synthesize Unicast
        DNS responses, as described above.<a class="pilcrow" href="#section-5.4-11">¶</a></p>
<p id="section-5.4-12">Note that this description assumes that all addresses on a given
        IPv4 subnet or IPv6 prefix are mapped to host names using the
 Discovery
 Proxy mechanism.
        It would be possible to implement a Discovery Proxy that can be
 configured
        so that some address-to-name mappings are performed using Multicast
 DNS
        on the local link, while other address-to-name mappings within the
 same
        IPv4 subnet or IPv6 prefix are configured manually.<a class="pilcrow" href="#section-5.4-12">¶</a></p>
</section>
</div>
<div id="translation">
<section id="section-5.5">
        <h3 id="name-data-translation">
<a class="section-number selfRef" href="#section-5.5">5.5. </a><a class="section-name selfRef" href="#name-data-translation">Data Translation</a>
        </h3>
<p id="section-5.5-1">For the delegated rich-text and LDH subdomains,
        generating appropriate Multicast DNS queries
        involves translating from the configured DNS domain
        (e.g., "Building 1.example.com") on the Unicast DNS side
        to ".local" on the Multicast DNS side.<a class="pilcrow" href="#section-5.5-1">¶</a></p>
<p id="section-5.5-2">For the delegated reverse-mapping subdomain,
        generating appropriate Multicast DNS queries
        involves using the appropriate API mechanism to
        indicate that a query should be performed using
        Multicast DNS, as described in
        <a class="xref" href="#dom-rev">Section 5.4</a>.<a class="pilcrow" href="#section-5.5-2">¶</a></p>
<p id="section-5.5-3">Generating appropriate Unicast DNS responses from the
        received Multicast DNS answers involves translating back
        from ".local" to the appropriate configured Unicast DNS
        domain as necessary, as described below.<a class="pilcrow" href="#section-5.5-3">¶</a></p>
<p id="section-5.5-4">In the examples below, the delegated subdomains are as follows:<a class="pilcrow" href="#section-5.5-4">¶</a></p>
<div class="artwork art-text alignLeft" id="section-5.5-5">
<pre>Delegated subdomain for rich-text names       Building 1.example.com.
Delegated subdomain for LDH names                 bldg‑1.example.com.
Delegated subdomain for IPv4 reverse mapping  113.0.203.in-addr.arpa.</pre><a class="pilcrow" href="#section-5.5-5">¶</a>
</div>
<p id="section-5.5-6">Names in Multicast DNS answers that do not end in ".local"
        do not require any translation.<a class="pilcrow" href="#section-5.5-6">¶</a></p>
<p id="section-5.5-7">Names in Multicast DNS answers that end in ".local"
        are only meaningful on the local link, and require translation
        to make them useable by clients outside the local link.<a class="pilcrow" href="#section-5.5-7">¶</a></p>
<p id="section-5.5-8">Names that end in ".local" may appear both as the
        owner names of received Multicast DNS answer records,
        and in the RDATA of received Multicast DNS answer records.<a class="pilcrow" href="#section-5.5-8">¶</a></p>
<p id="section-5.5-9">In a received Multicast DNS answer record,
        if the owner name ends with ".local",
        then the ".local" top-level label is replaced with the name
        of the delegated subdomain as was used in the originating query.<a class="pilcrow" href="#section-5.5-9">¶</a></p>
<p id="section-5.5-10">In a received Multicast DNS answer record,
        if a name in the RDATA ends with ".local",
        then the name is translated according to the delegated subdomain
        that was used in the originating query, as explained below.<a class="pilcrow" href="#section-5.5-10">¶</a></p>
<p id="section-5.5-11">For queries in subdomains delegated for LDH host names,
        ".local" names in RDATA
        are translated to that delegated LDH subdomain.
        For example, a query for "thing.bldg‑1.example.com" will be
 translated to a
        Multicast DNS query for "thing.local". If that query returns this
 CNAME record:<a class="pilcrow" href="#section-5.5-11">¶</a></p>
<div class="artwork art-text alignLeft" id="section-5.5-12">
<pre>  thing.local.               CNAME  prnt.local.</pre><a class="pilcrow" href="#section-5.5-12">¶</a>
</div>
<p id="section-5.5-13">then both the owner name and the name in the RDATA
        are translated from ".local" to the LDH subdomain
 "bldg‑1.example.com":<a class="pilcrow" href="#section-5.5-13">¶</a></p>
<div class="artwork art-text alignLeft" id="section-5.5-14">
<pre>  thing.bldg‑1.example.com.  CNAME  prnt.bldg‑1.example.com.</pre><a class="pilcrow" href="#section-5.5-14">¶</a>
</div>
<p id="section-5.5-15">For queries in subdomains delegated for reverse mapping names,
        ".local" names in RDATA
        are translated to the delegated LDH subdomain, if one is configured,
        or to the delegated rich-text subdomain otherwise.
        For example, consider a reverse mapping query that returns this PTR
 record:<a class="pilcrow" href="#section-5.5-15">¶</a></p>
<div class="artwork art-text alignLeft" id="section-5.5-16">
<pre>  2.113.0.203.in-addr.arpa.  PTR  prnt.local.</pre><a class="pilcrow" href="#section-5.5-16">¶</a>
</div>
<p id="section-5.5-17">The owner name is not translated because it does not end in
 ".local".
        The name in the RDATA is
        translated from ".local" to the LDH subdomain
 "bldg‑1.example.com":<a class="pilcrow" href="#section-5.5-17">¶</a></p>
<div class="artwork art-text alignLeft" id="section-5.5-18">
<pre>  2.113.0.203.in-addr.arpa.  PTR  prnt.bldg‑1.example.com.</pre><a class="pilcrow" href="#section-5.5-18">¶</a>
</div>
<p id="section-5.5-19">For queries in subdomains delegated for rich-text names,
        ".local" names in RDATA
        are translated according to whether or not they represent host names
        (i.e., RDATA names that are the owner names of A and AAAA DNS
 records).
        RDATA names ending in ".local" that represent host names
        are translated to the delegated LDH subdomain, if one is configured,
        or to the delegated rich-text subdomain otherwise.
        All other RDATA names ending in ".local"
        are translated to the delegated rich-text subdomain.
        For example, consider a DNS-SD service browsing PTR query
        that returns this PTR record for IPP printing:<a class="pilcrow" href="#section-5.5-19">¶</a></p>
<div class="artwork art-text alignLeft" id="section-5.5-20">
<pre>  _ipp._tcp.local.  PTR  My Printer._ipp._tcp.local.</pre><a class="pilcrow" href="#section-5.5-20">¶</a>
</div>
<p id="section-5.5-21">Both the owner name and the name in the RDATA
        are translated from ".local" to the rich-text subdomain:<a class="pilcrow" href="#section-5.5-21">¶</a></p>
<div class="artwork art-text alignLeft" id="section-5.5-22">
<pre>  _ipp._tcp.Building 1.example.com.
                    PTR  My Printer._ipp._tcp.Building 1.example.com.</pre><a class="pilcrow" href="#section-5.5-22">¶</a>
</div>
<p id="section-5.5-23">In contrast, consider a query
        that returns this SRV record for a specific IPP printing instance:<a class="pilcrow" href="#section-5.5-23">¶</a></p>
<div class="artwork art-text alignLeft" id="section-5.5-24">
<pre>  My Printer._ipp._tcp.local.  SRV  0 0 631 prnt.local.</pre><a class="pilcrow" href="#section-5.5-24">¶</a>
</div>
<p id="section-5.5-25">As for all queries, the owner name
        is translated to the delegated subdomain of the originating query,
        the delegated rich-text subdomain "Building 1.example.com".
        However, the ".local" name in the RDATA
        is the target host name field of an SRV record,
        a field that is used exclusively for host names.
        Consequently it is translated to the LDH subdomain
 "bldg‑1.example.com",
        if configured, instead of the rich-text subdomain:<a class="pilcrow" href="#section-5.5-25">¶</a></p>
<div class="artwork art-text alignLeft" id="section-5.5-26">
<pre>  My Printer._ipp._tcp.Building 1.example.com.
                               SRV  0 0 631 prnt.bldg‑1.example.com.</pre><a class="pilcrow" href="#section-5.5-26">¶</a>
</div>
<p id="section-5.5-27">Other beneficial translation and filtering operations are described
 below.<a class="pilcrow" href="#section-5.5-27">¶</a></p>
<div id="ttl">
<section id="section-5.5.1">
          <h4 id="name-dns-ttl-limiting">
<a class="section-number selfRef" href="#section-5.5.1">5.5.1. </a><a class="section-name selfRef" href="#name-dns-ttl-limiting">DNS TTL Limiting</a>
          </h4>
<p id="section-5.5.1-1">For efficiency, Multicast DNS typically uses moderately high DNS
          TTL values. For example, the typical TTL on DNS-SD service browsing
     PTR records is 75
          minutes. What makes these moderately high TTLs acceptable is the
          cache coherency mechanisms built in to the Multicast DNS protocol,
          which protect against stale data persisting for too long.  When a
          service shuts down gracefully, it sends goodbye packets to remove
          its service browsing PTR record(s) immediately from neighboring
     caches.  If a service
          shuts down abruptly without sending goodbye packets, the Passive
          Observation Of Failures (POOF) mechanism described in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc6762#section-10.5">Section 10.5</a> of the Multicast DNS
          specification [<a class="xref" href="#RFC6762">RFC6762</a>]</span> comes into play to purge the cache of stale
     data.<a class="pilcrow" href="#section-5.5.1-1">¶</a></p>
<p id="section-5.5.1-2">A traditional Unicast DNS client on a distant remote link does
          not get to participate in these Multicast DNS cache coherency
          mechanisms on the local link.  For traditional Unicast DNS queries
          (those received without using Long-Lived Queries (LLQ) <span>[<a class="xref" href="#RFC8764">RFC8764</a>]</span> or DNS Push
          Notification subscriptions <span>[<a class="xref" href="#RFC8765">RFC8765</a>]</span>), the DNS TTLs reported in the resulting Unicast
          DNS response <span class="bcp14">MUST</span> be capped to be no more than ten
          seconds.<a class="pilcrow" href="#section-5.5.1-2">¶</a></p>
<p id="section-5.5.1-3">Similarly, for negative responses, the negative caching TTL
          indicated in the SOA record <span>[<a class="xref" href="#RFC2308">RFC2308</a>]</span> should also be ten seconds (see <a class="xref" href="#soa">Section 6.1</a>).<a class="pilcrow" href="#section-5.5.1-3">¶</a></p>
<p id="section-5.5.1-4">This value of ten seconds is chosen based on user-experience
       considerations.<a class="pilcrow" href="#section-5.5.1-4">¶</a></p>
<p id="section-5.5.1-5">For negative caching, suppose a user is attempting to access a
          remote device (e.g., a printer), and they are unsuccessful because
          that device is powered off. Suppose they then place a telephone call
          and ask for the device to be powered on. We want the device to
          become available to the user within a reasonable time period. It is
          reasonable to expect it to take on the order of ten seconds for a
          simple device with a simple embedded operating system to power
          on. Once the device is powered on and has announced its presence on
          the network via Multicast DNS, we would like it to take no more than
          a further ten seconds for stale negative cache entries to expire
          from Unicast DNS caches, making the device available to the user
          desiring to access it.<a class="pilcrow" href="#section-5.5.1-5">¶</a></p>
<p id="section-5.5.1-6">Similar reasoning applies to capping positive TTLs at ten
       seconds.
          In the event of a device moving location, getting a new DHCP
       address,
          or other renumbering events, we would like the updated information
       to
          be available to remote clients in a relatively timely fashion.<a class="pilcrow" href="#section-5.5.1-6">¶</a></p>
<p id="section-5.5.1-7">However, network administrators should be aware that many
       recursive
          resolvers by default are configured to impose a minimum
       TTL of
          30 seconds. If stale data appears to be persisting in the network to
       the
          extent that it adversely impacts user experience, network
       administrators
          are advised to check the configuration of their recursive
     resolvers.<a class="pilcrow" href="#section-5.5.1-7">¶</a></p>
<p id="section-5.5.1-8">For received Unicast DNS queries that use LLQ <span>[<a class="xref" href="#RFC8764">RFC8764</a>]</span> or
          DNS Push Notifications <span>[<a class="xref" href="#RFC8765">RFC8765</a>]</span>,
     the Multicast DNS
         record's TTL <span class="bcp14">SHOULD</span> be
          returned unmodified, because the notification channel exists
          to inform the remote client as records come and go.
          For further details about Long-Lived Queries and its newer
       replacement,
          DNS Push Notifications, see <a class="xref" href="#aggregation">Section 5.6</a>.<a class="pilcrow" href="#section-5.5.1-8">¶</a></p>
</section>
</div>
<div id="unusable">
<section id="section-5.5.2">
          <h4 id="name-suppressing-unusable-record">
<a class="section-number selfRef" href="#section-5.5.2">5.5.2. </a><a class="section-name selfRef" href="#name-suppressing-unusable-record">Suppressing Unusable Records</a>
          </h4>
<p id="section-5.5.2-1">A Discovery Proxy <span class="bcp14">SHOULD</span> offer a configurable
     option,
          enabled by default, to suppress Unicast DNS answers
          for records that are not useful outside the local link.
          When the option to suppress unusable records is enabled:<a class="pilcrow" href="#section-5.5.2-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.5.2-2.1">For a Discovery Proxy that is serving only clients outside the
         local link,
              DNS A and AAAA records for
              IPv4 link-local addresses <span>[<a class="xref" href="#RFC3927">RFC3927</a>]</span>
              and
              IPv6 link-local addresses <span>[<a class="xref" href="#RFC4862">RFC4862</a>]</span>
              <span class="bcp14">SHOULD</span> be suppressed.<a class="pilcrow" href="#section-5.5.2-2.1">¶</a>
</li>
<li class="normal" id="section-5.5.2-2.2">Similarly, for sites that have multiple private address
               realms <span>[<a class="xref" href="#RFC1918">RFC1918</a>]</span>,
              in cases where the Discovery Proxy can determine that the
                   querying client
              is in a different address realm, private addresses <span class="bcp14">SHOULD NOT</span> be
              communicated to that client.<a class="pilcrow" href="#section-5.5.2-2.2">¶</a>
</li>
<li class="normal" id="section-5.5.2-2.3">
              IPv6 Unique Local Addresses <span>[<a class="xref" href="#RFC4193">RFC4193</a>]</span>
              <span class="bcp14">SHOULD</span> be suppressed
              in cases where the Discovery Proxy can determine that the
                   querying client
              is in a different IPv6 address realm.<a class="pilcrow" href="#section-5.5.2-2.3">¶</a>
</li>
<li class="normal" id="section-5.5.2-2.4">By the same logic, DNS SRV records that reference target host
              names that have no addresses usable by the requester should be
              suppressed, and likewise, DNS-SD service browsing PTR records
             that point to unusable
              SRV records should similarly be suppressed.<a class="pilcrow" href="#section-5.5.2-2.4">¶</a>
</li>
</ul>
</section>
</div>
<section id="section-5.5.3">
          <h4 id="name-nsec-and-nsec3-queries">
<a class="section-number selfRef" href="#section-5.5.3">5.5.3. </a><a class="section-name selfRef" href="#name-nsec-and-nsec3-queries">NSEC and NSEC3 Queries</a>
          </h4>
<p id="section-5.5.3-1">Multicast DNS devices do not routinely announce their records
          on the network. Generally, they remain silent until queried.
          This means that the complete set of Multicast DNS records in use on
       a
          link can only be discovered by active querying, not by passive
       listening.
          Because of this, a Discovery Proxy can only know what names exist on
       a link
          by issuing queries for them, and since it would be impractical to
          issue queries for every possible name just to find out which names
          exist and which do not, a Discovery Proxy cannot programmatically
          generate the traditional Unicast DNS
          NSEC <span>[<a class="xref" href="#RFC4034">RFC4034</a>]</span> and
          NSEC3 <span>[<a class="xref" href="#RFC5155">RFC5155</a>]</span> records
          that assert the nonexistence of a large range of names.<a class="pilcrow" href="#section-5.5.3-1">¶</a></p>
<p id="section-5.5.3-2">When queried for an NSEC or NSEC3 record type, the Discovery
       Proxy issues
          a qtype "ANY" query using Multicast DNS on the local link and then
          generates an NSEC or NSEC3 response with a Type Bit Map signifying
          which record types do and do not exist for just the specific name
       queried,
          and no other names.<a class="pilcrow" href="#section-5.5.3-2">¶</a></p>
<p id="section-5.5.3-3">Multicast DNS NSEC records received on the local link
          <span class="bcp14">MUST NOT</span> be forwarded unmodified to a unicast
     querier, because there
         are
          slight differences in the NSEC record data.
          In particular, Multicast DNS NSEC records do not have the NSEC
          bit set in the Type Bit Map, whereas conventional Unicast DNS
          NSEC records do have the NSEC bit set.<a class="pilcrow" href="#section-5.5.3-3">¶</a></p>
</section>
<div id="notrans">
<section id="section-5.5.4">
          <h4 id="name-no-text-encoding-translatio">
<a class="section-number selfRef" href="#section-5.5.4">5.5.4. </a><a class="section-name selfRef" href="#name-no-text-encoding-translatio">No Text-Encoding Translation</a>
          </h4>
<p id="section-5.5.4-1">A Discovery Proxy does no translation between text encodings.
          Specifically, a Discovery Proxy does no translation between Punycode
       encoding <span>[<a class="xref" href="#RFC3492">RFC3492</a>]</span> and UTF-8 encoding <span>[<a class="xref" href="#RFC3629">RFC3629</a>]</span>, either in
          the owner name of DNS records or anywhere in the RDATA of DNS
          records (such as the RDATA of PTR records, SRV records, NS records,
          or other record types like TXT, where it is ambiguous whether the
          RDATA may contain DNS names).  All bytes are treated as-is with no
          attempt at text-encoding translation.  A client implementing
          DNS-based Service Discovery <span>[<a class="xref" href="#RFC6763">RFC6763</a>]</span> will use UTF-8 encoding for its unicast DNS-based
     Service Discovery
          queries, which the Discovery Proxy passes through without any
          text-encoding translation to the Multicast DNS subsystem.  Responses
          from the Multicast DNS subsystem are similarly returned, without any
          text-encoding translation, back to the requesting unicast
     client.<a class="pilcrow" href="#section-5.5.4-1">¶</a></p>
</section>
</div>
<section id="section-5.5.5">
          <h4 id="name-application-specific-data-t">
<a class="section-number selfRef" href="#section-5.5.5">5.5.5. </a><a class="section-name selfRef" href="#name-application-specific-data-t">Application-Specific Data Translation</a>
          </h4>
<p id="section-5.5.5-1">There may be cases where Application-Specific Data Translation is
       appropriate.<a class="pilcrow" href="#section-5.5.5-1">¶</a></p>
<p id="section-5.5.5-2">For example, AirPrint printers tend to advertise fairly verbose
          information about their capabilities in their DNS-SD TXT record.
          TXT record sizes in the range of 500-1000 bytes are not uncommon.
          This information is a legacy from lineprinter (LPR) printing,
          because LPR does not have in-band capability negotiation, so all of
          this information is conveyed using the DNS-SD TXT record instead.
          Internet Printing Protocol (IPP) printing does have in-band
          capability negotiation, but for convenience, printers tend to
     include
          the same capability information in their IPP DNS-SD TXT records as
          well. For local Multicast DNS (mDNS) use, this extra TXT record
     information is
          wasteful but not fatal.  However, when a Discovery Proxy
          aggregates data from multiple printers on a link, and sends it via
          unicast (via UDP or TCP), this amount of unnecessary TXT record
          information can result in large responses.  A DNS reply over TCP
          carrying information about 70 printers with an average of 700 bytes
          per printer adds up to about 50 kilobytes of data.  Therefore, a
          Discovery Proxy that is aware of the specifics of an
          application-layer protocol such as AirPrint (which uses IPP) can
          elide unnecessary key/value pairs from the DNS-SD TXT record for
          better network efficiency.<a class="pilcrow" href="#section-5.5.5-2">¶</a></p>
<p id="section-5.5.5-3">Also, the DNS-SD TXT record for many printers contains an
          "adminurl" key (e.g.,
          "adminurl=http://printername.local/status.html").  For this URL to
     be
          useful outside the local link, the embedded ".local" host name needs
          to be translated to an appropriate name with larger scope.  It is
          easy to translate ".local" names when they appear in well-defined
          places: as a record's owner name, or in domain name fields in the
     RDATA of record types
          like PTR and SRV.  In the printing case, some application-specific
          knowledge about the semantics of the "adminurl" key is needed for
          the Discovery Proxy to know that it contains a name that needs to be
          translated.  This is somewhat analogous to the need for NAT gateways
          to contain ALGs (Application-Level Gateways) to facilitate the
          correct translation of protocols that embed addresses in unexpected
          places.<a class="pilcrow" href="#section-5.5.5-3">¶</a></p>
<p id="section-5.5.5-4">To avoid the need for application-specific knowledge about the
          semantics of particular TXT record keys, protocol designers are
          advised to avoid placing link-local names or link-local IP addresses
          in TXT record keys if translation of those names or addresses would
          be required for off-link operation.  In the printing case, the
          consequence of failing to translate the "adminurl" key
          correctly would be that, when accessed from a different link,
     printing
          will still work, but clicking the "Admin" user interface button will
     fail to
          open the printer's administration page.  Rather than duplicating the
          host name from the service's SRV record in its "adminurl" key,
          thereby having the same host name appear in two places, a better
          design might have been to omit the host name from the "adminurl"
          key and instead have the client implicitly substitute the target
          host name from the service's SRV record in place of a missing host
          name in the "adminurl" key.  That way, the desired host name only
          appears once and is in a well-defined place where software like
          the Discovery Proxy is expecting to find it.<a class="pilcrow" href="#section-5.5.5-4">¶</a></p>
<p id="section-5.5.5-5">Note that this kind of Application-Specific Data Translation is
          expected to be very rare; it is the exception rather than the rule.
          This is an example of a common theme in computing.  It is frequently
          the case that it is wise to start with a clean, layered design with
          clear boundaries. Then, in certain special cases, those layer
          boundaries may be violated where the performance and efficiency
          benefits outweigh the inelegance of the layer violation.<a class="pilcrow" href="#section-5.5.5-5">¶</a></p>
<p id="section-5.5.5-6">These layer violations are optional. They are done primarily for
          efficiency reasons and generally should not be required for correct
          operation.  A Discovery Proxy <span class="bcp14">MAY</span> operate solely at
          the mDNS layer without any knowledge of semantics at the DNS-SD
          layer or above.<a class="pilcrow" href="#section-5.5.5-6">¶</a></p>
</section>
</section>
</div>
<div id="aggregation">
<section id="section-5.6">
        <h3 id="name-answer-aggregation">
<a class="section-number selfRef" href="#section-5.6">5.6. </a><a class="section-name selfRef" href="#name-answer-aggregation">Answer Aggregation</a>
        </h3>
<p id="section-5.6-1">In a simple analysis, simply gathering multicast answers and
        forwarding them in a unicast response seems adequate, but it raises
        the question of how long the Discovery Proxy should wait to be sure
        that it has received all the Multicast DNS answers it needs to form a
        complete Unicast DNS response.  If it waits too little time, then it
        risks its Unicast DNS response being incomplete.  If it waits too
        long, then it creates a poor user experience at the client end.  In
        fact, there may be no time that is both short enough to produce a
        good user experience and at the same time long enough to reliably
        produce complete results.<a class="pilcrow" href="#section-5.6-1">¶</a></p>
<p id="section-5.6-2">Similarly, the Discovery Proxy (the authoritative name server for
        the subdomain in question) needs to decide what DNS TTL to report
        for these records.  If the TTL is too long, then the recursive
        resolvers issuing queries on behalf of their clients risk
        caching stale data for too long. If the TTL is too short, then the
        amount of network traffic will be more than necessary.  In fact, there
        may be no TTL that is both short enough to avoid undesirable stale
        data and, at the same time, long enough to be efficient on the
        network.<a class="pilcrow" href="#section-5.6-2">¶</a></p>
<p id="section-5.6-3">Both these dilemmas are solved by the use of DNS Long-Lived Queries
 (LLQ)
        <span>[<a class="xref" href="#RFC8764">RFC8764</a>]</span> or its newer replacement,
        DNS Push Notifications <span>[<a class="xref" href="#RFC8765">RFC8765</a>]</span>.<a class="pilcrow" href="#section-5.6-3">¶</a></p>
<p id="section-5.6-4">Clients supporting unicast DNS-based Service Discovery
 <span class="bcp14">SHOULD</span> implement
        DNS Push Notifications <span>[<a class="xref" href="#RFC8765">RFC8765</a>]</span>
        for improved user experience.<a class="pilcrow" href="#section-5.6-4">¶</a></p>
<p id="section-5.6-5">Clients and Discovery Proxies <span class="bcp14">MAY</span> support both
        LLQ and DNS Push Notifications, and when talking to a
        Discovery Proxy that supports both, the client may use either
        protocol, as it chooses, though it is expected that only
        DNS Push Notifications will continue to be supported in the long
        run.<a class="pilcrow" href="#section-5.6-5">¶</a></p>
<p id="section-5.6-6">When a Discovery Proxy receives a query using LLQ
        or DNS Push Notifications, it responds immediately using the Multicast
        DNS records it already has in its cache (if any).  This provides a
        good client user experience by providing a near-instantaneous
        response. Simultaneously, the Discovery Proxy issues a Multicast DNS
        query on the local link to discover if there are any additional
        Multicast DNS records it did not already know about. Should additional
        Multicast DNS responses be received, these are then delivered to the
        client using additional LLQ or DNS Push Notification update
        messages.  The timeliness of such update messages is limited only by
        the timeliness of the device responding to the Multicast DNS query. If
        the Multicast DNS device responds quickly, then the update message is
        delivered quickly. If the Multicast DNS device responds slowly, then
        the update message is delivered slowly.  The benefit of using multiple
 update
        messages to deliver results as they become available is that the
 Discovery
        Proxy can respond promptly because it doesn't have to deliver all the
        results in a single response that needs to be delayed to allow for the
        expected worst-case delay for receiving all the Multicast DNS
 responses.<a class="pilcrow" href="#section-5.6-6">¶</a></p>
<p id="section-5.6-7">With a proxy that supported only standard DNS queries, even if it
        were to try to provide reliability by assuming an
        excessively pessimistic worst-case time (thereby giving a very poor
        user experience), there would still be the risk of a slow Multicast
        DNS device taking even longer than that worst-case time (e.g., a
 device that is not
        even powered on until ten seconds after the initial query is
 received),
        resulting in incomplete responses.
        Using update messages to deliver subsequent asynchronous replies
 solves this
        dilemma: even very late responses are not lost; they are delivered in
        subsequent update messages.<a class="pilcrow" href="#section-5.6-7">¶</a></p>
<p id="section-5.6-8">Note that while normal DNS queries are generally received via the
 client's configured
        recursive resolver, LLQ and DNS Push Notification subscriptions may be
        received directly from the client.<a class="pilcrow" href="#section-5.6-8">¶</a></p>
<p id="section-5.6-9">There are two factors that determine how unicast responses
        are generated:<a class="pilcrow" href="#section-5.6-9">¶</a></p>
<p id="section-5.6-10">The first factor is whether or not the Discovery Proxy already has
        at least one record in its cache that answers the question.<a class="pilcrow" href="#section-5.6-10">¶</a></p>
<p id="section-5.6-11">
    The second factor is whether the client used a normal DNS query,
    or established a subscription using LLQ or DNS Push Notifications.
    Normal DNS queries
    are typically used for one-shot operations like SRV or address record
    queries.
    LLQ and DNS Push Notification subscriptions
    are typically used for long-lived service browsing PTR queries.
    Normal DNS queries and LLQ each have different response timing depending
    on the cache state, yielding the first four cases listed below.
    DNS Push Notifications, the newer protocol, has uniform behavior
    regardless of cache state, yielding the fifth case listed below.<a class="pilcrow" href="#section-5.6-11">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.6-12.1">
            <p id="section-5.6-12.1.1">Standard DNS query; no answer in
             cache:<a class="pilcrow" href="#section-5.6-12.1.1">¶</a></p>
<p id="section-5.6-12.1.2">
            Issue an mDNS query on the local link, exactly as a local client
            would issue an mDNS query, for the desired record name, type, and
            class, including retransmissions, as appropriate, according to the
            established mDNS retransmission schedule <span>[<a class="xref" href="#RFC6762">RFC6762</a>]</span>. The Discovery Proxy awaits Multicast DNS
         responses.<a class="pilcrow" href="#section-5.6-12.1.2">¶</a></p>
<p id="section-5.6-12.1.3">
            As soon as any Multicast DNS response packet
            is received that contains one or more positive answers to that
            question (with or without the Cache Flush bit <span>[<a class="xref" href="#RFC6762">RFC6762</a>]</span> set) or a negative answer
            (signified via a Multicast DNS NSEC record <span>[<a class="xref" href="#RFC6762">RFC6762</a>]</span>), the Discovery Proxy generates a Unicast DNS
            response message containing the corresponding (filtered and
            translated) answers and sends it to the remote client.<a class="pilcrow" href="#section-5.6-12.1.3">¶</a></p>
<p id="section-5.6-12.1.4">
            If after
            six seconds no relevant Multicast DNS answers have been received,
         cancel
            the mDNS query and return a negative response to the remote
            client.  Six seconds is enough time
            for the underlying Multicast DNS subsystem
            to transmit three mDNS queries
            and allow some time for responses to arrive.<a class="pilcrow" href="#section-5.6-12.1.4">¶</a></p>
<p id="section-5.6-12.1.5">
            (Reasoning: Queries not using LLQ or Push Notifications are
             generally queries
            that expect an answer from only one device,
            so the first response is also the only response.)<a class="pilcrow" href="#section-5.6-12.1.5">¶</a></p>
<p id="section-5.6-12.1.6">
            DNS TTLs in responses <span class="bcp14">MUST</span> be capped to at most ten
             seconds.<a class="pilcrow" href="#section-5.6-12.1.6">¶</a></p>
</li>
<li class="normal" id="section-5.6-12.2">
            <p id="section-5.6-12.2.1">Standard DNS query; at least one answer in
             cache:<a class="pilcrow" href="#section-5.6-12.2.1">¶</a></p>
<p id="section-5.6-12.2.2">
            No local mDNS queries are performed.<a class="pilcrow" href="#section-5.6-12.2.2">¶</a></p>
<p id="section-5.6-12.2.3">
            The Discovery Proxy generates a Unicast DNS
            response message containing the answer(s) from the cache right
         away, to minimize delay.<a class="pilcrow" href="#section-5.6-12.2.3">¶</a></p>
<p id="section-5.6-12.2.4">
            (Reasoning: Queries not using LLQ or Push Notifications are
             generally queries
            that expect an answer from only one device.
            Given RRSet TTL harmonization, if the proxy has
            one Multicast DNS answer in its cache, it can reasonably
            assume that it has the whole set.)<a class="pilcrow" href="#section-5.6-12.2.4">¶</a></p>
<p id="section-5.6-12.2.5">
            DNS TTLs in responses <span class="bcp14">MUST</span> be capped to at most ten
             seconds.<a class="pilcrow" href="#section-5.6-12.2.5">¶</a></p>
</li>
<li class="normal" id="section-5.6-12.3">
            <p id="section-5.6-12.3.1">Long-Lived Query (LLQ); no answer in cache:<a class="pilcrow" href="#section-5.6-12.3.1">¶</a></p>
<p id="section-5.6-12.3.2">
            As in the case above with no answer in the cache, plan to perform
         mDNS
            querying for six seconds, returning an LLQ response message to the
         remote
            client as soon as any relevant mDNS response is received.<a class="pilcrow" href="#section-5.6-12.3.2">¶</a></p>
<p id="section-5.6-12.3.3">
            If after six seconds no relevant mDNS answers have been received,
            and the client has not cancelled its Long-Lived Query,
            return a negative LLQ response message to the remote client.<a class="pilcrow" href="#section-5.6-12.3.3">¶</a></p>
<p id="section-5.6-12.3.4">
            (Reasoning: We don't need to rush to send an empty
             answer.)<a class="pilcrow" href="#section-5.6-12.3.4">¶</a></p>
<p id="section-5.6-12.3.5">
            Regardless of whether or not a relevant mDNS response is received
         within
            six seconds, the Long-Lived Query remains active for as long as
         the
            client maintains the LLQ state, and results in the ongoing
            transmission of mDNS queries until the Long-Lived Query is
         cancelled.
            If the set of mDNS answers changes, LLQ Event Response messages
         are sent.<a class="pilcrow" href="#section-5.6-12.3.5">¶</a></p>
<p id="section-5.6-12.3.6">
            DNS TTLs in responses are returned unmodified.<a class="pilcrow" href="#section-5.6-12.3.6">¶</a></p>
</li>
<li class="normal" id="section-5.6-12.4">
            <p id="section-5.6-12.4.1">Long-Lived Query (LLQ); at least one answer in
             cache:<a class="pilcrow" href="#section-5.6-12.4.1">¶</a></p>
<p id="section-5.6-12.4.2">
            As in the case above with at least one answer in the cache,
            the Discovery Proxy generates a unicast LLQ
            response message containing the answer(s) from the cache right
         away, to minimize delay.<a class="pilcrow" href="#section-5.6-12.4.2">¶</a></p>
<p id="section-5.6-12.4.3">
            The Long-Lived Query remains active for as long as the client
         maintains the LLQ state,
            and results in the transmission of mDNS queries
            (with appropriate Known Answer lists)
            to determine if further answers are available.
            If the set of mDNS answers changes, LLQ Event Response messages
         are sent.<a class="pilcrow" href="#section-5.6-12.4.3">¶</a></p>
<p id="section-5.6-12.4.4">
            (Reasoning: We want a user interface that is displayed very
         rapidly yet
            continues to remain accurate even as the network environment
            changes.)<a class="pilcrow" href="#section-5.6-12.4.4">¶</a></p>
<p id="section-5.6-12.4.5">
            DNS TTLs in responses are returned unmodified.<a class="pilcrow" href="#section-5.6-12.4.5">¶</a></p>
</li>
<li class="normal" id="section-5.6-12.5">
            <p id="section-5.6-12.5.1">Push Notification Subscription<a class="pilcrow" href="#section-5.6-12.5.1">¶</a></p>
<p id="section-5.6-12.5.2">
            The Discovery Proxy acknowledges the subscription request
         immediately.<a class="pilcrow" href="#section-5.6-12.5.2">¶</a></p>
<p id="section-5.6-12.5.3">
            If one or more answers are already available in the cache,
            those answers are then sent in an immediately following DNS PUSH
         message.<a class="pilcrow" href="#section-5.6-12.5.3">¶</a></p>
<p id="section-5.6-12.5.4">
            The Push Notification subscription remains active until the client
         cancels the subscription,
            and results in the transmission of mDNS queries
            (with appropriate Known Answer lists)
            to determine if further answers are available.
            If the set of mDNS answers changes, further DNS PUSH messages are
         sent.<a class="pilcrow" href="#section-5.6-12.5.4">¶</a></p>
<p id="section-5.6-12.5.5">
            (Reasoning: We want a user interface that is displayed very
         rapidly yet
            continues to remain accurate even as the network environment
            changes.)<a class="pilcrow" href="#section-5.6-12.5.5">¶</a></p>
<p id="section-5.6-12.5.6">
            DNS TTLs in responses are returned unmodified.<a class="pilcrow" href="#section-5.6-12.5.6">¶</a></p>
</li>
</ul>
<p id="section-5.6-13">Where the text above refers to returning "a negative response to
        the remote client", it is describing returning a "no error no answer"
        negative response, not NXDOMAIN.  This is because the Discovery Proxy
        cannot know all the Multicast DNS domain names that may exist on a
        link at any given time, so any name with no answers may have child
        names that do exist, making it an "empty non-terminal" name.<a class="pilcrow" href="#section-5.6-13">¶</a></p>
<p id="section-5.6-14">Note that certain aspects of the behavior described here
        do not have to be implemented overtly by the Discovery Proxy;
        they occur naturally as a result of using existing Multicast DNS
 APIs.<a class="pilcrow" href="#section-5.6-14">¶</a></p>
<p id="section-5.6-15">For example, in the first case above (standard DNS query and no
        answers in the cache), if a new Multicast DNS query is requested
        (either by a local client on the Discovery Proxy device, or by the
        Discovery Proxy software on that device on behalf of a remote client),
        and there is not already an identical Multicast DNS query active and
        there are no matching answers already in the Multicast DNS cache on
        the Discovery Proxy device, then this will cause a series of Multicast
        DNS query packets to be issued with exponential backoff.  The
        exponential backoff sequence in some implementations starts at one
        second and then doubles for each retransmission (0, 1, 3, 7 seconds,
        etc.), and in others, it starts at one second and then triples for
        each retransmission (0, 1, 4, 13 seconds, etc.).  In either case, if
        no response has been received after six seconds, that is long enough
        that the underlying Multicast DNS implementation will have sent three
        query packets without receiving any response.  At that point, the
        Discovery Proxy cancels its Multicast DNS query (so no further
        Multicast DNS query packets will be sent for this query) and returns a
        negative response to the remote client via unicast.<a class="pilcrow" href="#section-5.6-15">¶</a></p>
<p id="section-5.6-16">The six-second delay is chosen to be long enough to give enough
        time for devices to respond, yet short enough not to be too onerous
        for a human user waiting for a response.  For example, using the "dig"
        DNS debugging tool, the current default settings result in it waiting
        a total of 15 seconds for a reply (three transmissions of the DNS UDP
        query packet, with a wait of 5 seconds after each packet), which is
        ample time for it to have received a negative reply from a Discovery
        Proxy after six seconds.<a class="pilcrow" href="#section-5.6-16">¶</a></p>
<p id="section-5.6-17">The text above states that for a standard DNS query,
        if at least one answer is already available in the cache, then a
        Discovery Proxy should not issue additional mDNS query packets.
        This also occurs naturally as a result of using existing
        Multicast DNS APIs. 
   If a new Multicast DNS query is requested
   (either locally, or by the Discovery Proxy on behalf of a remote client)
   for which there are relevant answers already in the Multicast DNS
   cache on the Discovery Proxy device, and after the answers are
   delivered the Multicast DNS query is immediately cancelled, then
   no Multicast DNS query packets will be generated for this query.<a class="pilcrow" href="#section-5.6-17">¶</a></p>
</section>
</div>
</section>
</div>
<div id="admin">
<section id="section-6">
      <h2 id="name-administrative-dns-records">
<a class="section-number selfRef" href="#section-6">6. </a><a class="section-name selfRef" href="#name-administrative-dns-records">Administrative DNS Records</a>
      </h2>
<div id="soa">
<section id="section-6.1">
        <h3 id="name-dns-soa-start-of-authority-">
<a class="section-number selfRef" href="#section-6.1">6.1. </a><a class="section-name selfRef" href="#name-dns-soa-start-of-authority-">DNS SOA (Start of Authority) Record</a>
        </h3>
<p id="section-6.1-1">The MNAME field <span class="bcp14">SHOULD</span> contain the host name of the
 Discovery Proxy
 device
        (i.e., the same domain name as the RDATA of the NS record delegating
 the
        relevant zone(s) to this Discovery Proxy device).<a class="pilcrow" href="#section-6.1-1">¶</a></p>
<p id="section-6.1-2">The RNAME field <span class="bcp14">SHOULD</span> contain the mailbox of the
 person
 responsible
        for administering this Discovery Proxy device.<a class="pilcrow" href="#section-6.1-2">¶</a></p>
<p id="section-6.1-3">The SERIAL field <span class="bcp14">MUST</span> be zero.<a class="pilcrow" href="#section-6.1-3">¶</a></p>
<p id="section-6.1-4">Zone transfers are undefined for Discovery Proxy zones, and
        consequently, the REFRESH, RETRY, and EXPIRE fields have no useful
        meaning for Discovery Proxy zones.  These fields <span class="bcp14">SHOULD</span>
        contain reasonable default values.  The <span class="bcp14">RECOMMENDED</span>
        values are: REFRESH 7200, RETRY 3600, and EXPIRE 86400.<a class="pilcrow" href="#section-6.1-4">¶</a></p>
<p id="section-6.1-5">The MINIMUM field (used to control the lifetime of negative cache
 entries)
        <span class="bcp14">SHOULD</span> contain the value 10.
        This value is chosen based on user-experience
 considerations
        (see <a class="xref" href="#ttl">Section 5.5.1</a>).<a class="pilcrow" href="#section-6.1-5">¶</a></p>
<p id="section-6.1-6">In the event that there are multiple Discovery Proxy devices on a
        link for fault tolerance reasons, this will result in clients
        receiving inconsistent SOA records (different MNAME and possibly
        RNAME) depending on which Discovery Proxy answers their SOA query.
        However, since clients generally have no reason to use the MNAME or
        RNAME data, this is unlikely to cause any problems.<a class="pilcrow" href="#section-6.1-6">¶</a></p>
</section>
</div>
<div id="ns">
<section id="section-6.2">
        <h3 id="name-dns-ns-records">
<a class="section-number selfRef" href="#section-6.2">6.2. </a><a class="section-name selfRef" href="#name-dns-ns-records">DNS NS Records</a>
        </h3>
<p id="section-6.2-1">In the event that there are multiple Discovery Proxy devices on a
        link for fault tolerance reasons, the parent zone <span class="bcp14">MUST</span>
        be configured with NS records giving the names
        of all the Discovery Proxy devices on the link.<a class="pilcrow" href="#section-6.2-1">¶</a></p>
<p id="section-6.2-2">Each Discovery Proxy device <span class="bcp14">MUST</span> be configured to
 answer NS queries
        for the zone apex name by giving its own NS record,
        and the NS records of its fellow Discovery Proxy devices on the same
        link, so that it can return the correct answers for NS queries.<a class="pilcrow" href="#section-6.2-2">¶</a></p>
<p id="section-6.2-3">The target host name in the RDATA of an NS record <span class="bcp14">MUST NOT</span>
 reference
        a name that falls within any zone delegated to a Discovery Proxy.
        Apart from the zone apex name,
        all other host names (names of A and AAAA DNS records)
        that fall within a zone delegated to a Discovery
 Proxy
        correspond to local Multicast DNS host names,
        which logically belong to the respective Multicast DNS hosts defending
 those names,
        not the Discovery Proxy.
        Generally speaking, the Discovery Proxy does not own or control the
 delegated zone;
        it is merely a conduit to the corresponding ".local" namespace,
        which is controlled by the Multicast DNS hosts on that link.
        If an NS record were to reference a manually determined host name
        that falls within a delegated zone,
        that manually determined host name may inadvertently conflict with a
 corresponding
        ".local" host name that is owned and controlled by some device on that
 link.<a class="pilcrow" href="#section-6.2-3">¶</a></p>
</section>
</div>
<div id="delegation">
<section id="section-6.3">
        <h3 id="name-dns-delegation-records">
<a class="section-number selfRef" href="#section-6.3">6.3. </a><a class="section-name selfRef" href="#name-dns-delegation-records">DNS Delegation Records</a>
        </h3>
<p id="section-6.3-1">Since the <span><a class="xref" href="#RFC6762">Multicast DNS
        specification</a> [<a class="xref" href="#RFC6762">RFC6762</a>]</span> states that there can be no delegation
        (subdomains) within a ".local" namespace, this implies that any name
        within a zone delegated to a Discovery Proxy (except for the zone apex
        name itself) cannot have any answers for any DNS queries for RRTYPEs
        SOA, NS, or DS.  Consequently:<a class="pilcrow" href="#section-6.3-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.3-2.1">for any query for the zone apex name of a zone delegated to a
          Discovery Proxy, the Discovery Proxy <span class="bcp14">MUST</span> generate
          the appropriate immediate answers as described above, and<a class="pilcrow" href="#section-6.3-2.1">¶</a>
</li>
<li class="normal" id="section-6.3-2.2">
          for any query for any name below the zone apex, for RRTYPEs SOA, NS,
     or DS,
          the Discovery Proxy <span class="bcp14">MUST</span> generate
          an immediate negative answer.<a class="pilcrow" href="#section-6.3-2.2">¶</a>
</li>
</ul>
</section>
</div>
<div id="srv">
<section id="section-6.4">
        <h3 id="name-dns-srv-records">
<a class="section-number selfRef" href="#section-6.4">6.4. </a><a class="section-name selfRef" href="#name-dns-srv-records">DNS SRV Records</a>
        </h3>
<p id="section-6.4-1">There are certain special DNS records that logically fall within
        the delegated Unicast DNS subdomain, but rather than mapping to their
        corresponding ".local" namesakes, they actually contain metadata
        pertaining to the operation of the delegated Unicast DNS subdomain
        itself.  They do not exist in the corresponding ".local" namespace of
        the local link.  For these queries, a Discovery Proxy
        <span class="bcp14">MUST</span> generate immediate answers, whether positive or
        negative, to avoid delays while clients wait for their query to be
        answered.<a class="pilcrow" href="#section-6.4-1">¶</a></p>
<p id="section-6.4-2">For example, if a Discovery Proxy implements Long-Lived Queries
        <span>[<a class="xref" href="#RFC8764">RFC8764</a>]</span>, then it
        <span class="bcp14">MUST</span> positively respond to
        <code>_dns‑llq._udp.&lt;zone&gt; SRV</code> queries,
        <code>_dns‑llq._tcp.&lt;zone&gt; SRV</code> queries, and
        <code>_dns‑llq‑tls._tcp.&lt;zone&gt; SRV</code> queries as
        appropriate.  If it does not implement Long-Lived Queries, it
        <span class="bcp14">MUST</span> return an immediate negative answer for those
        queries, instead of passing those queries through to the local network
        as Multicast DNS queries and then waiting unsuccessfully for answers
        that will not be forthcoming.<a class="pilcrow" href="#section-6.4-2">¶</a></p>
<p id="section-6.4-3">If a Discovery Proxy implements
        DNS Push Notifications <span>[<a class="xref" href="#RFC8765">RFC8765</a>]</span>,
        then it <span class="bcp14">MUST</span> positively respond to
        <code>_dns‑push‑tls._tcp.&lt;zone&gt;</code>
 queries.
        Otherwise, it <span class="bcp14">MUST</span> return an immediate negative answer
 for those
 queries.<a class="pilcrow" href="#section-6.4-3">¶</a></p>
<p id="section-6.4-4">A Discovery Proxy <span class="bcp14">MUST</span> return an immediate negative
 answer for
        <code>_dns‑update._udp.&lt;zone&gt; SRV</code>
 queries,
        <code>_dns‑update._tcp.&lt;zone&gt; SRV</code>
 queries, and
        <code>_dns‑update-tls._tcp.&lt;zone&gt; SRV</code>
 queries,
        since using DNS Update <span>[<a class="xref" href="#RFC2136">RFC2136</a>]</span>
 to change
        zones generated dynamically from local Multicast DNS data is not
 possible.<a class="pilcrow" href="#section-6.4-4">¶</a></p>
</section>
</div>
<section id="section-6.5">
        <h3 id="name-domain-enumeration-records">
<a class="section-number selfRef" href="#section-6.5">6.5. </a><a class="section-name selfRef" href="#name-domain-enumeration-records">Domain Enumeration Records</a>
        </h3>
<p id="section-6.5-1">If the network operator chooses to use address-based
        unicast Domain Enumeration queries for client configuration
        (see <a class="xref" href="#unicast">Section 5.2.1</a>),
        and the network operator also chooses to delegate the enclosing
        reverse mapping subdomain to a Discovery Proxy,
        then that Discovery Proxy becomes responsible for serving
        the answers to those address-based unicast Domain Enumeration
 queries.<a class="pilcrow" href="#section-6.5-1">¶</a></p>
<p id="section-6.5-2">As with the SRV metadata records described above, a Discovery Proxy
        configured with delegated reverse mapping subdomains is responsible
        for generating immediate (positive or negative) answers for
        address-based unicast Domain Enumeration queries, rather than
        passing them though to the underlying Multicast DNS subsystem and
        then waiting unsuccessfully for answers that will not be
 forthcoming.<a class="pilcrow" href="#section-6.5-2">¶</a></p>
</section>
</section>
</div>
<div id="DNSSEC">
<section id="section-7">
      <h2 id="name-dnssec-considerations">
<a class="section-number selfRef" href="#section-7">7. </a><a class="section-name selfRef" href="#name-dnssec-considerations">DNSSEC Considerations</a>
      </h2>
<section id="section-7.1">
        <h3 id="name-online-signing-only">
<a class="section-number selfRef" href="#section-7.1">7.1. </a><a class="section-name selfRef" href="#name-online-signing-only">Online Signing Only</a>
        </h3>
<p id="section-7.1-1">The Discovery Proxy acts as the authoritative name server for
        designated subdomains, and if DNSSEC is to be used, the Discovery
        Proxy needs to possess a copy of the signing keys in order to
        generate authoritative signed data from the local Multicast DNS
        responses it receives.  Offline signing is not applicable to
        Discovery Proxy.<a class="pilcrow" href="#section-7.1-1">¶</a></p>
</section>
<section id="section-7.2">
        <h3 id="name-nsec-and-nsec3-records">
<a class="section-number selfRef" href="#section-7.2">7.2. </a><a class="section-name selfRef" href="#name-nsec-and-nsec3-records">NSEC and NSEC3 Records</a>
        </h3>
<p id="section-7.2-1">In DNSSEC,
        NSEC and NSEC3 records
        are used to assert the nonexistence of certain names,
        also described as "authenticated denial of existence"
        <span>[<a class="xref" href="#RFC4034">RFC4034</a>]</span>
          <span>[<a class="xref" href="#RFC5155">RFC5155</a>]</span>.<a class="pilcrow" href="#section-7.2-1">¶</a></p>
<p id="section-7.2-2">Since a Discovery Proxy only knows what names exist on the local
        link by issuing queries for them, and since it would be impractical to
        issue queries for every possible name just to find out which names
        exist and which do not, a Discovery Proxy cannot programmatically
        synthesize the traditional NSEC and NSEC3 records that assert the
        nonexistence of a large range of names.  Instead, when generating a
        negative response, a Discovery Proxy programmatically synthesizes a
        single NSEC record asserting the nonexistence of just the specific
        name queried and no others.  Since the Discovery Proxy has the zone
        signing key, it can do this on demand.  Since the NSEC record asserts
        the nonexistence of only a single name, zone walking is not a concern,
        and NSEC3 is therefore not necessary.<a class="pilcrow" href="#section-7.2-2">¶</a></p>
<p id="section-7.2-3">Note that this applies only to traditional immediate DNS queries,
        which may return immediate negative answers when no immediate positive
        answer is available.  When used with a DNS Push Notification
        subscription <span>[<a class="xref" href="#RFC8765">RFC8765</a>]</span>, there are no negative answers, merely the
        absence of answers so far, which may change in the future if answers
        become available.<a class="pilcrow" href="#section-7.2-3">¶</a></p>
</section>
</section>
</div>
<section id="section-8">
      <h2 id="name-ipv6-considerations">
<a class="section-number selfRef" href="#section-8">8. </a><a class="section-name selfRef" href="#name-ipv6-considerations">IPv6 Considerations</a>
      </h2>
<p id="section-8-1">An IPv4-only host and an IPv6-only host behave as "ships that pass in
      the night". Even if they are on the same Ethernet <span>[<a class="xref" href="#IEEE-3">IEEE-3</a>]</span>, neither is aware of the other's traffic. For
      this reason, each link may have <em>two</em> unrelated ".local." zones:
      one for
      IPv4 and one for IPv6.  Since, for practical purposes, a group of
      IPv4-only hosts and a group of IPv6-only hosts on the same Ethernet act
      as if they were on two entirely separate Ethernet segments, it is
      unsurprising that their use of the ".local." zone should occur exactly
      as it would if they really were on two entirely separate Ethernet
      segments.<a class="pilcrow" href="#section-8-1">¶</a></p>
<p id="section-8-2">It will be desirable to have a mechanism to "stitch" together
      these two unrelated ".local." zones so that they appear as one.
      Such a mechanism will need to be able to differentiate between a
      dual-stack (v4/v6) host participating in both ".local."
      zones, and two different hosts: one IPv4-only and the other IPv6-only,
      which are both trying to use the same name(s). Such a mechanism
      will be specified in a future companion document.<a class="pilcrow" href="#section-8-2">¶</a></p>
<p id="section-8-3">At present, it is <span class="bcp14">RECOMMENDED</span> that a Discovery Proxy
      be configured
      with a single domain name for both the IPv4 and IPv6 ".local." zones
      on the local link, and when a unicast query is received, it should
      issue Multicast DNS queries using both IPv4 and IPv6 on the local link
      and then combine the results.<a class="pilcrow" href="#section-8-3">¶</a></p>
</section>
<section id="section-9">
      <h2 id="name-security-considerations">
<a class="section-number selfRef" href="#section-9">9. </a><a class="section-name selfRef" href="#name-security-considerations">Security Considerations</a>
      </h2>
<section id="section-9.1">
        <h3 id="name-authenticity">
<a class="section-number selfRef" href="#section-9.1">9.1. </a><a class="section-name selfRef" href="#name-authenticity">Authenticity</a>
        </h3>
<p id="section-9.1-1">A service proves its presence on a link by its ability to
        answer link-local multicast queries on that link.
        If greater security is desired, then the Discovery Proxy mechanism
        should not be used, and something with stronger security should
        be used instead such as authenticated secure DNS Update
        <span>[<a class="xref" href="#RFC2136">RFC2136</a>]</span> <span>[<a class="xref" href="#RFC3007">RFC3007</a>]</span>.<a class="pilcrow" href="#section-9.1-1">¶</a></p>
</section>
<section id="section-9.2">
        <h3 id="name-privacy">
<a class="section-number selfRef" href="#section-9.2">9.2. </a><a class="section-name selfRef" href="#name-privacy">Privacy</a>
        </h3>
<p id="section-9.2-1">The Domain Name System is, generally speaking,
        a global public database.  Records that exist in the Domain Name
        System name hierarchy can be queried by name from, in principle,
        anywhere in the world.  If services on a mobile device (like a laptop
        computer) are made visible via the Discovery Proxy mechanism, then
        when those services become visible in a domain such as
        "My House.example.com", it might indicate to (potentially
        hostile) observers that the mobile device is in the owner's home.
 When those
        services disappear from "My House.example.com", that change could
        be used by observers to infer when the mobile device (and possibly its
        owner) may have left the house.  The privacy of this information may
        be protected using techniques like firewalls, split-view DNS, and
        Virtual Private Networks (VPNs), as are customarily used today to
        protect the privacy of corporate DNS information.<a class="pilcrow" href="#section-9.2-1">¶</a></p>
<p id="section-9.2-2">The privacy issue is particularly serious for the IPv4 and IPv6
 reverse zones.
        If the public delegation of the reverse zones points to the
        Discovery Proxy, and the Discovery Proxy is reachable globally,
        then it could leak a significant amount of information.
        Attackers could discover hosts that otherwise might
        not be easy to identify, and learn their host names.
        Attackers could also discover the existence of links
        where hosts frequently come and go.<a class="pilcrow" href="#section-9.2-2">¶</a></p>
<p id="section-9.2-3">The Discovery Proxy could provide sensitive records only to
 authenticated
        users. This is a general DNS problem, not specific to the Discovery
 Proxy.
        Work is underway in the IETF to tackle this problem <span>[<a class="xref" href="#RFC7626">RFC7626</a>]</span>.<a class="pilcrow" href="#section-9.2-3">¶</a></p>
</section>
<section id="section-9.3">
        <h3 id="name-denial-of-service">
<a class="section-number selfRef" href="#section-9.3">9.3. </a><a class="section-name selfRef" href="#name-denial-of-service">Denial of Service</a>
        </h3>
<p id="section-9.3-1">A remote attacker could use a rapid series of unique Unicast DNS
        queries to induce a Discovery Proxy to generate a rapid series of
        corresponding Multicast DNS queries on one or more of its local links.
        Multicast traffic is generally more expensive than unicast traffic,
        especially on Wi-Fi links
        <span>[<a class="xref" href="#I-D.ietf-mboned-ieee802-mcast-problems">MCAST</a>]</span>,
        which makes this attack particularly
        serious.  To limit the damage that can be caused by such attacks, a
        Discovery Proxy (or the underlying Multicast DNS subsystem that it
        utilizes) <span class="bcp14">MUST</span> implement Multicast DNS query rate
        limiting appropriate to the link technology in question. For today's
        802.11b/g/n/ac Wi-Fi links (for which approximately 200 multicast
        packets per second is sufficient to consume approximately 100% of the
        wireless spectrum), a limit of 20 Multicast DNS query packets per
        second is <span class="bcp14">RECOMMENDED</span>.  On other link technologies like
        Gigabit Ethernet, higher limits may be appropriate.  A consequence of
        this rate limiting is that a rogue remote client could issue an
        excessive number of queries resulting in denial of service to other
        legitimate remote clients attempting to use that Discovery Proxy.
        However, this is preferable to a rogue remote client being able to
        inflict even greater harm on the local network, which could impact the
        correct operation of all local clients on that network.<a class="pilcrow" href="#section-9.3-1">¶</a></p>
</section>
</section>
<section id="section-10">
      <h2 id="name-iana-considerations">
<a class="section-number selfRef" href="#section-10">10. </a><a class="section-name selfRef" href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<p id="section-10-1">This document has no IANA actions.<a class="pilcrow" href="#section-10-1">¶</a></p>
</section>
<section id="section-11">
      <h2 id="name-references">
<a class="section-number selfRef" href="#section-11">11. </a><a class="section-name selfRef" href="#name-references">References</a>
      </h2>
<section id="section-11.1">
        <h3 id="name-normative-references">
<a class="section-number selfRef" href="#section-11.1">11.1. </a><a class="section-name selfRef" href="#name-normative-references">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC1034">[RFC1034]</dt>
<dd>
<span class="refAuthor">Mockapetris, P.</span>, <span class="refTitle">"Domain names - concepts and facilities"</span>, <span class="seriesInfo">STD 13</span>, <span class="seriesInfo">RFC 1034</span>, <span class="seriesInfo">DOI 10.17487/RFC1034</span>, <time datetime="1987-11">November 1987</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1034">https://www.rfc-editor.org/info/rfc1034</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1035">[RFC1035]</dt>
<dd>
<span class="refAuthor">Mockapetris, P.</span>, <span class="refTitle">"Domain names - implementation and specification"</span>, <span class="seriesInfo">STD 13</span>, <span class="seriesInfo">RFC 1035</span>, <span class="seriesInfo">DOI 10.17487/RFC1035</span>, <time datetime="1987-11">November 1987</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1035">https://www.rfc-editor.org/info/rfc1035</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1918">[RFC1918]</dt>
<dd>
<span class="refAuthor">Rekhter, Y.</span><span class="refAuthor">, Moskowitz, B.</span><span class="refAuthor">, Karrenberg, D.</span><span class="refAuthor">, de Groot, G. J.</span><span class="refAuthor">, and E. Lear</span>, <span class="refTitle">"Address Allocation for Private Internets"</span>, <span class="seriesInfo">BCP 5</span>, <span class="seriesInfo">RFC 1918</span>, <span class="seriesInfo">DOI 10.17487/RFC1918</span>, <time datetime="1996-02">February 1996</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1918">https://www.rfc-editor.org/info/rfc1918</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
<dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2308">[RFC2308]</dt>
<dd>
<span class="refAuthor">Andrews, M.</span>, <span class="refTitle">"Negative Caching of DNS Queries (DNS NCACHE)"</span>, <span class="seriesInfo">RFC 2308</span>, <span class="seriesInfo">DOI 10.17487/RFC2308</span>, <time datetime="1998-03">March 1998</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2308">https://www.rfc-editor.org/info/rfc2308</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3629">[RFC3629]</dt>
<dd>
<span class="refAuthor">Yergeau, F.</span>, <span class="refTitle">"UTF-8, a transformation format of ISO 10646"</span>, <span class="seriesInfo">STD 63</span>, <span class="seriesInfo">RFC 3629</span>, <span class="seriesInfo">DOI 10.17487/RFC3629</span>, <time datetime="2003-11">November 2003</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3629">https://www.rfc-editor.org/info/rfc3629</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3927">[RFC3927]</dt>
<dd>
<span class="refAuthor">Cheshire, S.</span><span class="refAuthor">, Aboba, B.</span><span class="refAuthor">, and E. Guttman</span>, <span class="refTitle">"Dynamic Configuration of IPv4 Link-Local Addresses"</span>, <span class="seriesInfo">RFC 3927</span>, <span class="seriesInfo">DOI 10.17487/RFC3927</span>, <time datetime="2005-05">May 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3927">https://www.rfc-editor.org/info/rfc3927</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4034">[RFC4034]</dt>
<dd>
<span class="refAuthor">Arends, R.</span><span class="refAuthor">, Austein, R.</span><span class="refAuthor">, Larson, M.</span><span class="refAuthor">, Massey, D.</span><span class="refAuthor">, and S. Rose</span>, <span class="refTitle">"Resource Records for the DNS Security Extensions"</span>, <span class="seriesInfo">RFC 4034</span>, <span class="seriesInfo">DOI 10.17487/RFC4034</span>, <time datetime="2005-03">March 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4034">https://www.rfc-editor.org/info/rfc4034</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4862">[RFC4862]</dt>
<dd>
<span class="refAuthor">Thomson, S.</span><span class="refAuthor">, Narten, T.</span><span class="refAuthor">, and T. Jinmei</span>, <span class="refTitle">"IPv6 Stateless Address Autoconfiguration"</span>, <span class="seriesInfo">RFC 4862</span>, <span class="seriesInfo">DOI 10.17487/RFC4862</span>, <time datetime="2007-09">September 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4862">https://www.rfc-editor.org/info/rfc4862</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5155">[RFC5155]</dt>
<dd>
<span class="refAuthor">Laurie, B.</span><span class="refAuthor">, Sisson, G.</span><span class="refAuthor">, Arends, R.</span><span class="refAuthor">, and D. Blacka</span>, <span class="refTitle">"DNS Security (DNSSEC) Hashed Authenticated Denial of Existence"</span>, <span class="seriesInfo">RFC 5155</span>, <span class="seriesInfo">DOI 10.17487/RFC5155</span>, <time datetime="2008-03">March 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5155">https://www.rfc-editor.org/info/rfc5155</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5198">[RFC5198]</dt>
<dd>
<span class="refAuthor">Klensin, J.</span><span class="refAuthor"> and M. Padlipsky</span>, <span class="refTitle">"Unicode Format for Network Interchange"</span>, <span class="seriesInfo">RFC 5198</span>, <span class="seriesInfo">DOI 10.17487/RFC5198</span>, <time datetime="2008-03">March 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5198">https://www.rfc-editor.org/info/rfc5198</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6762">[RFC6762]</dt>
<dd>
<span class="refAuthor">Cheshire, S.</span><span class="refAuthor"> and M. Krochmal</span>, <span class="refTitle">"Multicast DNS"</span>, <span class="seriesInfo">RFC 6762</span>, <span class="seriesInfo">DOI 10.17487/RFC6762</span>, <time datetime="2013-02">February 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6762">https://www.rfc-editor.org/info/rfc6762</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6763">[RFC6763]</dt>
<dd>
<span class="refAuthor">Cheshire, S.</span><span class="refAuthor"> and M. Krochmal</span>, <span class="refTitle">"DNS-Based Service Discovery"</span>, <span class="seriesInfo">RFC 6763</span>, <span class="seriesInfo">DOI 10.17487/RFC6763</span>, <time datetime="2013-02">February 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6763">https://www.rfc-editor.org/info/rfc6763</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
<dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8490">[RFC8490]</dt>
<dd>
<span class="refAuthor">Bellis, R.</span><span class="refAuthor">, Cheshire, S.</span><span class="refAuthor">, Dickinson, J.</span><span class="refAuthor">, Dickinson, S.</span><span class="refAuthor">, Lemon, T.</span><span class="refAuthor">, and T. Pusateri</span>, <span class="refTitle">"DNS Stateful Operations"</span>, <span class="seriesInfo">RFC 8490</span>, <span class="seriesInfo">DOI 10.17487/RFC8490</span>, <time datetime="2019-03">March 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8490">https://www.rfc-editor.org/info/rfc8490</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8765">[RFC8765]</dt>
<dd>
<span class="refAuthor">Pusateri, T.</span><span class="refAuthor"> and S. Cheshire</span>, <span class="refTitle">"DNS Push Notifications"</span>, <span class="seriesInfo">RFC 8765</span>, <span class="seriesInfo">DOI 10.17487/RFC8765</span>, <time datetime="2020-06">June 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8765">https://www.rfc-editor.org/info/rfc8765</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-11.2">
        <h3 id="name-informative-references">
<a class="section-number selfRef" href="#section-11.2">11.2. </a><a class="section-name selfRef" href="#name-informative-references">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.sekar-dns-ul">[DNS-UL]</dt>
<dd>
<span class="refAuthor">Cheshire, S.</span><span class="refAuthor"> and T. Lemon</span>, <span class="refTitle">"Dynamic DNS Update Leases"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-sekar-dns-ul-02</span>, <time datetime="2018-08-02">2 August 2018</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-sekar-dns-ul-02">https://tools.ietf.org/html/draft-sekar-dns-ul-02</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IEEE-1Q">[IEEE-1Q]</dt>
<dd>
<span class="refAuthor">IEEE</span>, <span class="refTitle">"IEEE Standard for Local and metropolitan area networks -- Bridges and Bridged Networks"</span>, <span class="seriesInfo">IEEE Std 802.1Q-2014</span>, <span class="seriesInfo">DOI 10.1109/IEEESTD.2014.6991462</span>, <time datetime="2014">2014</time>, <span>&lt;<a href="https://ieeexplore.ieee.org/document/6991462">https://ieeexplore.ieee.org/document/6991462</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IEEE-3">[IEEE-3]</dt>
<dd>
<span class="refAuthor">IEEE</span>, <span class="refTitle">"IEEE Standard for Ethernet"</span>, <span class="seriesInfo">DOI 10.1109/IEEESTD.2018.8457469</span>, <span class="seriesInfo">IEEE Std 802.3-2018</span>, <time datetime="2008-12">December 2008</time>, <span>&lt;<a href="https://ieeexplore.ieee.org/document/8457469">https://ieeexplore.ieee.org/document/8457469</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IEEE-5">[IEEE-5]</dt>
<dd>
<span class="refAuthor">IEEE</span>, <span class="refTitle">"Telecommunications and information exchange between systems - Local and metropolitan area networks - Part 5: Token ring access method and physical layer specifications"</span>, <span class="seriesInfo">IEEE Std 802.5-1998</span>, <time datetime="1998">1998</time>, <span>&lt;<a href="https://standards.ieee.org/standard/802_5-1998.html">https://standards.ieee.org/standard/802_5-1998.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IEEE-11">[IEEE-11]</dt>
<dd>
<span class="refAuthor">IEEE</span>, <span class="refTitle">"Information technology - Telecommunications and information exchange between systems - Local and metropolitan area networks - Specific requirements - Part 11: Wireless LAN Medium Access Control (MAC) and Physical Layer (PHY) Specifications"</span>, <span class="seriesInfo">IEEE Std 802.11-2016</span>, <time datetime="2016-12">December 2016</time>, <span>&lt;<a href="https://standards.ieee.org/standard/802_11-2016.html">https://standards.ieee.org/standard/802_11-2016.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-mboned-ieee802-mcast-problems">[MCAST]</dt>
<dd>
<span class="refAuthor">Perkins, C.</span><span class="refAuthor">, McBride, M.</span><span class="refAuthor">, Stanley, D.</span><span class="refAuthor">, Kumari, W.</span><span class="refAuthor">, and J. Zuniga</span>, <span class="refTitle">"Multicast Considerations over IEEE 802 Wireless Media"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-mboned-ieee802-mcast-problems-11</span>, <time datetime="2019-12-11">11 December 2019</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-mboned-ieee802-mcast-problems-11">https://tools.ietf.org/html/draft-ietf-mboned-ieee802-mcast-problems-11</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="OHP">[OHP]</dt>
<dd>
<span class="refTitle">"ohybridproxy - an mDNS/DNS hybrid-proxy based on mDNSResponder"</span>, <span class="refContent">commit 464d6c9</span>, <time datetime="2017-06">June 2017</time>, <span>&lt;<a href="https://github.com/sbyx/ohybridproxy/">https://github.com/sbyx/ohybridproxy/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.sctl-service-registration">[REG-PROT]</dt>
<dd>
<span class="refAuthor">Cheshire, S.</span><span class="refAuthor"> and T. Lemon</span>, <span class="refTitle">"Service Registration Protocol for DNS-Based Service Discovery"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-sctl-service-registration-02</span>, <time datetime="2018-07-15">15 July 2018</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-sctl-service-registration-02">https://tools.ietf.org/html/draft-sctl-service-registration-02</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.sctl-dnssd-mdns-relay">[RELAY]</dt>
<dd>
<span class="refAuthor">Cheshire, S.</span><span class="refAuthor"> and T. Lemon</span>, <span class="refTitle">"Multicast DNS Discovery Relay"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-sctl-dnssd-mdns-relay-04</span>, <time datetime="2018-03-21">21 March 2018</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-sctl-dnssd-mdns-relay-04">https://tools.ietf.org/html/draft-sctl-dnssd-mdns-relay-04</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2132">[RFC2132]</dt>
<dd>
<span class="refAuthor">Alexander, S.</span><span class="refAuthor"> and R. Droms</span>, <span class="refTitle">"DHCP Options and BOOTP Vendor Extensions"</span>, <span class="seriesInfo">RFC 2132</span>, <span class="seriesInfo">DOI 10.17487/RFC2132</span>, <time datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2132">https://www.rfc-editor.org/info/rfc2132</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2136">[RFC2136]</dt>
<dd>
<span class="refAuthor">Vixie, P., Ed.</span><span class="refAuthor">, Thomson, S.</span><span class="refAuthor">, Rekhter, Y.</span><span class="refAuthor">, and J. Bound</span>, <span class="refTitle">"Dynamic Updates in the Domain Name System (DNS UPDATE)"</span>, <span class="seriesInfo">RFC 2136</span>, <span class="seriesInfo">DOI 10.17487/RFC2136</span>, <time datetime="1997-04">April 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2136">https://www.rfc-editor.org/info/rfc2136</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3007">[RFC3007]</dt>
<dd>
<span class="refAuthor">Wellington, B.</span>, <span class="refTitle">"Secure Domain Name System (DNS) Dynamic Update"</span>, <span class="seriesInfo">RFC 3007</span>, <span class="seriesInfo">DOI 10.17487/RFC3007</span>, <time datetime="2000-11">November 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3007">https://www.rfc-editor.org/info/rfc3007</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3492">[RFC3492]</dt>
<dd>
<span class="refAuthor">Costello, A.</span>, <span class="refTitle">"Punycode: A Bootstring encoding of Unicode for Internationalized Domain Names in Applications (IDNA)"</span>, <span class="seriesInfo">RFC 3492</span>, <span class="seriesInfo">DOI 10.17487/RFC3492</span>, <time datetime="2003-03">March 2003</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3492">https://www.rfc-editor.org/info/rfc3492</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4193">[RFC4193]</dt>
<dd>
<span class="refAuthor">Hinden, R.</span><span class="refAuthor"> and B. Haberman</span>, <span class="refTitle">"Unique Local IPv6 Unicast Addresses"</span>, <span class="seriesInfo">RFC 4193</span>, <span class="seriesInfo">DOI 10.17487/RFC4193</span>, <time datetime="2005-10">October 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4193">https://www.rfc-editor.org/info/rfc4193</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6760">[RFC6760]</dt>
<dd>
<span class="refAuthor">Cheshire, S.</span><span class="refAuthor"> and M. Krochmal</span>, <span class="refTitle">"Requirements for a Protocol to Replace the AppleTalk Name Binding Protocol (NBP)"</span>, <span class="seriesInfo">RFC 6760</span>, <span class="seriesInfo">DOI 10.17487/RFC6760</span>, <time datetime="2013-02">February 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6760">https://www.rfc-editor.org/info/rfc6760</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7558">[RFC7558]</dt>
<dd>
<span class="refAuthor">Lynn, K.</span><span class="refAuthor">, Cheshire, S.</span><span class="refAuthor">, Blanchet, M.</span><span class="refAuthor">, and D. Migault</span>, <span class="refTitle">"Requirements for Scalable DNS-Based Service Discovery (DNS-SD) / Multicast DNS (mDNS) Extensions"</span>, <span class="seriesInfo">RFC 7558</span>, <span class="seriesInfo">DOI 10.17487/RFC7558</span>, <time datetime="2015-07">July 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7558">https://www.rfc-editor.org/info/rfc7558</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7626">[RFC7626]</dt>
<dd>
<span class="refAuthor">Bortzmeyer, S.</span>, <span class="refTitle">"DNS Privacy Considerations"</span>, <span class="seriesInfo">RFC 7626</span>, <span class="seriesInfo">DOI 10.17487/RFC7626</span>, <time datetime="2015-08">August 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7626">https://www.rfc-editor.org/info/rfc7626</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7788">[RFC7788]</dt>
<dd>
<span class="refAuthor">Stenberg, M.</span><span class="refAuthor">, Barth, S.</span><span class="refAuthor">, and P. Pfister</span>, <span class="refTitle">"Home Networking Control Protocol"</span>, <span class="seriesInfo">RFC 7788</span>, <span class="seriesInfo">DOI 10.17487/RFC7788</span>, <time datetime="2016-04">April 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7788">https://www.rfc-editor.org/info/rfc7788</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8375">[RFC8375]</dt>
<dd>
<span class="refAuthor">Pfister, P.</span><span class="refAuthor"> and T. Lemon</span>, <span class="refTitle">"Special-Use Domain 'home.arpa.'"</span>, <span class="seriesInfo">RFC 8375</span>, <span class="seriesInfo">DOI 10.17487/RFC8375</span>, <time datetime="2018-05">May 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8375">https://www.rfc-editor.org/info/rfc8375</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8764">[RFC8764]</dt>
<dd>
<span class="refAuthor">Cheshire, S.</span><span class="refAuthor"> and M. Krochmal</span>, <span class="refTitle">"Apple's DNS Long-Lived Queries Protocol"</span>, <span class="seriesInfo">RFC 8764</span>, <span class="seriesInfo">DOI 10.17487/RFC8764</span>, <time datetime="2020-06">June 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8764">https://www.rfc-editor.org/info/rfc8764</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.cheshire-dnssd-roadmap">[ROADMAP]</dt>
<dd>
<span class="refAuthor">Cheshire, S.</span>, <span class="refTitle">"Service Discovery Road Map"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-cheshire-dnssd-roadmap-03</span>, <time datetime="2018-10-23">23 October 2018</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-cheshire-dnssd-roadmap-03">https://tools.ietf.org/html/draft-cheshire-dnssd-roadmap-03</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ZC">[ZC]</dt>
<dd>
<span class="refAuthor">Cheshire, S.</span><span class="refAuthor"> and D.H. Steinberg</span>, <span class="refTitle">"Zero Configuration Networking: The Definitive Guide"</span>, <span class="refContent">O'Reilly Media, Inc.</span>, <span class="seriesInfo">ISBN 0-596-10100-7</span>, <time datetime="2005-12">December 2005</time>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="implementation">
<section id="section-appendix.a">
      <h2 id="name-implementation-status">
<a class="section-number selfRef" href="#section-appendix.a">Appendix A. </a><a class="section-name selfRef" href="#name-implementation-status">Implementation Status</a>
      </h2>
<p id="section-appendix.a-1">Some aspects of the mechanism specified in this document already
      exist in
      deployed software. Some aspects are new. This section outlines which
      aspects
      already exist and which are new.<a class="pilcrow" href="#section-appendix.a-1">¶</a></p>
<section id="section-a.1">
        <h2 id="name-already-implemented-and-dep">
<a class="section-number selfRef" href="#section-a.1">A.1. </a><a class="section-name selfRef" href="#name-already-implemented-and-dep">Already Implemented and Deployed</a>
        </h2>
<p id="section-a.1-1">Domain enumeration by the client
        ("b._dns-sd._udp.&lt;zone&gt;" queries) is already implemented and
 deployed.<a class="pilcrow" href="#section-a.1-1">¶</a></p>
<p id="section-a.1-2">Performing unicast queries to the indicated discovery domain is
 already
        implemented and deployed.<a class="pilcrow" href="#section-a.1-2">¶</a></p>
<p id="section-a.1-3">These are implemented and deployed in Mac OS X 10.4 Tiger and later
        (including all versions of Apple iOS, on all models of iPhones, iPads,
 Apple TVs and HomePods),
        in Bonjour for Windows,
        and in Android 4.1 "Jelly Bean" (API Level 16) and later.<a class="pilcrow" href="#section-a.1-3">¶</a></p>
<p id="section-a.1-4">Domain enumeration and unicast querying have been
        used for several years at IETF meetings to make terminal room
        printers discoverable from outside the terminal room. When an IETF
        attendee presses "Cmd‑P" on a Mac, or selects AirPrint on an iPad
        or iPhone, and the terminal room printers appear, it is because
        the client is sending Unicast DNS queries to the IETF DNS servers.
        A walk-through giving the details of this particular specific example
        is given in <span><a class="relref" href="https://tools.ietf.org/html/draft-cheshire-dnssd-roadmap-03#appendix-A">Appendix A</a> of the Roadmap
 document [<a class="xref" href="#I-D.cheshire-dnssd-roadmap">ROADMAP</a>]</span>.<a class="pilcrow" href="#section-a.1-4">¶</a></p>
<p id="section-a.1-5">The Long-Lived Query mechanism <span>[<a class="xref" href="#RFC8764">RFC8764</a>]</span>
        referred to in this specification exists and is deployed
        but was not standardized by the IETF.
        The IETF has developed a superior Long-Lived Query mechanism
        called DNS Push Notifications <span>[<a class="xref" href="#RFC8765">RFC8765</a>]</span>,
        which is built on DNS Stateful Operations <span>[<a class="xref" href="#RFC8490">RFC8490</a>]</span>.
        DNS Push Notifications is implemented and deployed in Mac OS X 10.15
 and later,
        and iOS 13 and later.<a class="pilcrow" href="#section-a.1-5">¶</a></p>
</section>
<section id="section-a.2">
        <h2 id="name-already-implemented">
<a class="section-number selfRef" href="#section-a.2">A.2. </a><a class="section-name selfRef" href="#name-already-implemented">Already Implemented</a>
        </h2>
<p id="section-a.2-1">A minimal portable Discovery Proxy implementation has been produced
 by
        Markus Stenberg and Steven Barth, which runs on OS X and several Linux
        variants including OpenWrt <span>[<a class="xref" href="#OHP">OHP</a>]</span>.
        It was demonstrated at the Berlin IETF in July 2013.<a class="pilcrow" href="#section-a.2-1">¶</a></p>
<p id="section-a.2-2">Tom Pusateri has an implementation that runs on any Unix/Linux
 system. It
        has a RESTful interface for management and an experimental demo
        command-line interface (CLI) and web interface.<a class="pilcrow" href="#section-a.2-2">¶</a></p>
<p id="section-a.2-3">Ted Lemon also has produced a portable implementation of Discovery
 Proxy,
        which is available in the mDNSResponder open source code.<a class="pilcrow" href="#section-a.2-3">¶</a></p>
</section>
<section id="section-a.3">
        <h2 id="name-partially-implemented">
<a class="section-number selfRef" href="#section-a.3">A.3. </a><a class="section-name selfRef" href="#name-partially-implemented">Partially Implemented</a>
        </h2>
<p id="section-a.3-1">At the time of writing,
        existing APIs make multiple domains visible to client software,
        but most client user interfaces lump all discovered services
        into a single flat list. This is largely a chicken-and-egg
        problem. Application writers were naturally reluctant to spend
        time writing domain-aware user interface code when few customers would
        benefit from it. If Discovery Proxy deployment becomes common, then
        application writers will have a reason to provide a better user
 experience.
        Existing applications will work with the Discovery Proxy but will
        show all services in a single flat list. Applications with
        improved user interfaces will show services grouped by domain.<a class="pilcrow" href="#section-a.3-1">¶</a></p>
</section>
</section>
</div>
<section id="section-appendix.b">
      <h2 id="name-acknowledgments">
<a class="section-name selfRef" href="#name-acknowledgments">Acknowledgments</a>
      </h2>
<p id="section-appendix.b-1">Thanks to <span class="contact-name">Markus Stenberg</span> for helping develop
      the policy
      regarding the four styles of unicast response according to what
      data is immediately available in the cache.
      Thanks to
      <span class="contact-name">Anders Brandt</span>,
      <span class="contact-name">Ben Campbell</span>,
      <span class="contact-name">Tim Chown</span>,
       <span class="contact-name">Alissa Cooper</span>,
       <span class="contact-name">Spencer Dawkins</span>,
       <span class="contact-name">Ralph Droms</span>,
       <span class="contact-name">Joel Halpern</span>,
       <span class="contact-name">Ray Hunter</span>,
       <span class="contact-name">Joel Jaeggli</span>,
       <span class="contact-name">Warren Kumari</span>,
       <span class="contact-name">Ted Lemon</span>,
       <span class="contact-name">Alexey Melnikov</span>,
       <span class="contact-name">Kathleen Moriarty</span>,
       <span class="contact-name">Tom Pusateri</span>,
       <span class="contact-name">Eric Rescorla</span>,
       <span class="contact-name">Adam Roach</span>,
       <span class="contact-name">David Schinazi</span>,
       <span class="contact-name">Markus Stenberg</span>,
       <span class="contact-name">Dave Thaler</span>,
      and  <span class="contact-name">Andrew Yourtchenko</span> for their comments.<a class="pilcrow" href="#section-appendix.b-1">¶</a></p>
</section>
<div id="authors-addresses">
<section id="section-appendix.c">
      <h2 id="name-authors-address">
<a class="section-name selfRef" href="#name-authors-address">Author's Address</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Stuart Cheshire</span></div>
<div class="left" dir="auto"><span class="org">Apple Inc.</span></div>
<div class="left" dir="auto"><span class="street-address">One Apple Park Way</span></div>
<div class="left" dir="auto">
<span class="locality">Cupertino</span>, <span class="region">California</span> <span class="postal-code">95014</span>
</div>
<div class="left" dir="auto"><span class="country-name">United States of America</span></div>
<div class="tel">
<span>Phone:</span>
<a class="tel" href="tel:+1%20(408)%20996-1010">+1 (408) 996-1010</a>
</div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:cheshire@apple.com">cheshire@apple.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>


</body></html>