<!DOCTYPE html>
<html class="RFC BCP" lang="en"><head>
<meta charset="utf-8"/>
<meta content="Common,Latin" name="scripts"/>
<meta content="initial-scale=1.0" name="viewport"/>
<title>RFC 8906: A Common Operational Problem in DNS Servers: Failure to Communicate</title>
<meta content="M. Andrews" name="author"/>
<meta content="Ray Bellis" name="author"/>
<meta content="
       
        The DNS is a query/response protocol.  Failing to respond
        to queries, or responding incorrectly, causes both immediate
        operational problems and long-term problems with protocol
        development.
       
       
        This document identifies a number of common kinds of queries
        to which some servers either fail to respond or respond
        incorrectly.  This document also suggests procedures for
        zone operators to apply to identify and remediate the problem.
       
       
        The document does not look at the DNS data itself, just the
        structure of the responses.
       
    " name="description"/>
<meta content="xml2rfc 3.1.1" name="generator"/>
<meta content="8906" name="rfc.number"/>
<link href="rfc8906.xml" rel="alternate" type="application/rfc+xml"/>
<link href="#copyright" rel="license"/>
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css"/>
<link href="https://dx.doi.org/10.17487/rfc8906" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <link href="https://datatracker.ietf.org/doc/draft-ietf-dnsop-no-response-issue-23" rel="prev"/>
  </head>
<body>
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 8906</td>
<td class="center">Failure to Communicate</td>
<td class="right">September 2020</td>
</tr></thead>
<tfoot><tr>
<td class="left">Andrews &amp; Bellis</td>
<td class="center">Best Current Practice</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div class="document-information" id="external-metadata"></div>
<div class="document-information" id="internal-metadata">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a class="eref" href="https://www.rfc-editor.org/rfc/rfc8906">8906</a></dd>
<dt class="label-bcp">BCP:</dt>
<dd class="bcp">231</dd>
<dt class="label-category">Category:</dt>
<dd class="category">Best Current Practice</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time class="published" datetime="2020-09">September 2020</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">M. Andrews</div>
<div class="org">ISC</div>
</div>
<div class="author">
      <div class="author-name">R. Bellis</div>
<div class="org">ISC</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 8906</h1>
<h1 id="title">A Common Operational Problem in DNS Servers: Failure to Communicate</h1>
<section id="section-abstract">
      <h2 id="abstract"><a class="selfRef" href="#abstract">Abstract</a></h2>
<p id="section-abstract-1">
        The DNS is a query/response protocol.  Failing to respond
        to queries, or responding incorrectly, causes both immediate
        operational problems and long-term problems with protocol
        development.<a class="pilcrow" href="#section-abstract-1">¶</a></p>
<p id="section-abstract-2">
        This document identifies a number of common kinds of queries
        to which some servers either fail to respond or respond
        incorrectly.  This document also suggests procedures for
        zone operators to apply to identify and remediate the problem.<a class="pilcrow" href="#section-abstract-2">¶</a></p>
<p id="section-abstract-3">
        The document does not look at the DNS data itself, just the
        structure of the responses.<a class="pilcrow" href="#section-abstract-3">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a class="section-name selfRef" href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This memo documents an Internet Best Current Practice.<a class="pilcrow" href="#section-boilerplate.1-1">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further information
            on BCPs is available in Section 2 of RFC 7841.<a class="pilcrow" href="#section-boilerplate.1-2">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc8906">https://www.rfc-editor.org/info/rfc8906</a></span>.<a class="pilcrow" href="#section-boilerplate.1-3">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a class="section-name selfRef" href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2020 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a class="pilcrow" href="#section-boilerplate.2-1">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a class="pilcrow" href="#section-boilerplate.2-2">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a class="toplink" href="#" onclick="scroll(0,0)">▲</a><h2 id="name-table-of-contents">
<a class="section-name selfRef" href="#name-table-of-contents">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact ulEmpty toc">
<li class="compact ulEmpty toc" id="section-toc.1-1.1">
            <p class="keepWithNext" id="section-toc.1-1.1.1"><a class="xref" href="#section-1">1</a>.  <a class="xref" href="#name-introduction">Introduction</a><a class="pilcrow" href="#section-toc.1-1.1.1">¶</a></p>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.2">
            <p class="keepWithNext" id="section-toc.1-1.2.1"><a class="xref" href="#section-2">2</a>.  <a class="xref" href="#name-consequences">Consequences</a><a class="pilcrow" href="#section-toc.1-1.2.1">¶</a></p>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a class="xref" href="#section-3">3</a>.  <a class="xref" href="#name-common-kinds-of-queries-tha">Common Kinds of Queries That Result in No or Bad Responses</a><a class="pilcrow" href="#section-toc.1-1.3.1">¶</a></p>
<ul class="compact ulEmpty toc">
<li class="compact ulEmpty toc" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a class="xref" href="#section-3.1">3.1</a>.  <a class="xref" href="#name-basic-dns-queries">Basic DNS Queries</a><a class="pilcrow" href="#section-toc.1-1.3.2.1.1">¶</a></p>
<ul class="compact ulEmpty toc">
<li class="compact ulEmpty toc" id="section-toc.1-1.3.2.1.2.1">
                    <p class="keepWithNext" id="section-toc.1-1.3.2.1.2.1.1"><a class="xref" href="#section-3.1.1">3.1.1</a>.  <a class="xref" href="#name-zone-existence">Zone Existence</a><a class="pilcrow" href="#section-toc.1-1.3.2.1.2.1.1">¶</a></p>
</li>
                  <li class="compact ulEmpty toc" id="section-toc.1-1.3.2.1.2.2">
                    <p id="section-toc.1-1.3.2.1.2.2.1"><a class="xref" href="#section-3.1.2">3.1.2</a>.  <a class="xref" href="#name-unknown-unsupported-type-qu">Unknown/Unsupported Type Queries</a><a class="pilcrow" href="#section-toc.1-1.3.2.1.2.2.1">¶</a></p>
</li>
                  <li class="compact ulEmpty toc" id="section-toc.1-1.3.2.1.2.3">
                    <p id="section-toc.1-1.3.2.1.2.3.1"><a class="xref" href="#section-3.1.3">3.1.3</a>.  <a class="xref" href="#name-dns-flags">DNS Flags</a><a class="pilcrow" href="#section-toc.1-1.3.2.1.2.3.1">¶</a></p>
</li>
                  <li class="compact ulEmpty toc" id="section-toc.1-1.3.2.1.2.4">
                    <p id="section-toc.1-1.3.2.1.2.4.1"><a class="xref" href="#section-3.1.4">3.1.4</a>.  <a class="xref" href="#name-unknown-dns-opcodes">Unknown DNS Opcodes</a><a class="pilcrow" href="#section-toc.1-1.3.2.1.2.4.1">¶</a></p>
</li>
                  <li class="compact ulEmpty toc" id="section-toc.1-1.3.2.1.2.5">
                    <p id="section-toc.1-1.3.2.1.2.5.1"><a class="xref" href="#section-3.1.5">3.1.5</a>.  <a class="xref" href="#name-tcp-queries">TCP Queries</a><a class="pilcrow" href="#section-toc.1-1.3.2.1.2.5.1">¶</a></p>
</li>
                </ul>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a class="xref" href="#section-3.2">3.2</a>.  <a class="xref" href="#name-edns-queries">EDNS Queries</a><a class="pilcrow" href="#section-toc.1-1.3.2.2.1">¶</a></p>
<ul class="compact ulEmpty toc">
<li class="compact ulEmpty toc" id="section-toc.1-1.3.2.2.2.1">
                    <p id="section-toc.1-1.3.2.2.2.1.1"><a class="xref" href="#section-3.2.1">3.2.1</a>.  <a class="xref" href="#name-edns-queries-version-indepe">EDNS Queries: Version Independent</a><a class="pilcrow" href="#section-toc.1-1.3.2.2.2.1.1">¶</a></p>
</li>
                  <li class="compact ulEmpty toc" id="section-toc.1-1.3.2.2.2.2">
                    <p id="section-toc.1-1.3.2.2.2.2.1"><a class="xref" href="#section-3.2.2">3.2.2</a>.  <a class="xref" href="#name-edns-queries-version-specif">EDNS Queries: Version Specific</a><a class="pilcrow" href="#section-toc.1-1.3.2.2.2.2.1">¶</a></p>
</li>
                  <li class="compact ulEmpty toc" id="section-toc.1-1.3.2.2.2.3">
                    <p id="section-toc.1-1.3.2.2.2.3.1"><a class="xref" href="#section-3.2.3">3.2.3</a>.  <a class="xref" href="#name-edns-options">EDNS Options</a><a class="pilcrow" href="#section-toc.1-1.3.2.2.2.3.1">¶</a></p>
</li>
                  <li class="compact ulEmpty toc" id="section-toc.1-1.3.2.2.2.4">
                    <p id="section-toc.1-1.3.2.2.2.4.1"><a class="xref" href="#section-3.2.4">3.2.4</a>.  <a class="xref" href="#name-edns-flags">EDNS Flags</a><a class="pilcrow" href="#section-toc.1-1.3.2.2.2.4.1">¶</a></p>
</li>
                  <li class="compact ulEmpty toc" id="section-toc.1-1.3.2.2.2.5">
                    <p id="section-toc.1-1.3.2.2.2.5.1"><a class="xref" href="#section-3.2.5">3.2.5</a>.  <a class="xref" href="#name-truncated-edns-responses">Truncated EDNS Responses</a><a class="pilcrow" href="#section-toc.1-1.3.2.2.2.5.1">¶</a></p>
</li>
                  <li class="compact ulEmpty toc" id="section-toc.1-1.3.2.2.2.6">
                    <p id="section-toc.1-1.3.2.2.2.6.1"><a class="xref" href="#section-3.2.6">3.2.6</a>.  <a class="xref" href="#name-do1-handling">DO=1 Handling</a><a class="pilcrow" href="#section-toc.1-1.3.2.2.2.6.1">¶</a></p>
</li>
                  <li class="compact ulEmpty toc" id="section-toc.1-1.3.2.2.2.7">
                    <p id="section-toc.1-1.3.2.2.2.7.1"><a class="xref" href="#section-3.2.7">3.2.7</a>.  <a class="xref" href="#name-edns-over-tcp">EDNS over TCP</a><a class="pilcrow" href="#section-toc.1-1.3.2.2.2.7.1">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a class="xref" href="#section-4">4</a>.  <a class="xref" href="#name-firewalls-and-load-balancer">Firewalls and Load Balancers</a><a class="pilcrow" href="#section-toc.1-1.4.1">¶</a></p>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a class="xref" href="#section-5">5</a>.  <a class="xref" href="#name-packet-scrubbing-services">Packet Scrubbing Services</a><a class="pilcrow" href="#section-toc.1-1.5.1">¶</a></p>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a class="xref" href="#section-6">6</a>.  <a class="xref" href="#name-whole-answer-caches">Whole Answer Caches</a><a class="pilcrow" href="#section-toc.1-1.6.1">¶</a></p>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a class="xref" href="#section-7">7</a>.  <a class="xref" href="#name-response-code-selection">Response Code Selection</a><a class="pilcrow" href="#section-toc.1-1.7.1">¶</a></p>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a class="xref" href="#section-8">8</a>.  <a class="xref" href="#name-testing">Testing</a><a class="pilcrow" href="#section-toc.1-1.8.1">¶</a></p>
<ul class="compact ulEmpty toc">
<li class="compact ulEmpty toc" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a class="xref" href="#section-8.1">8.1</a>.  <a class="xref" href="#name-testing-basic-dns">Testing: Basic DNS</a><a class="pilcrow" href="#section-toc.1-1.8.2.1.1">¶</a></p>
<ul class="compact ulEmpty toc">
<li class="compact ulEmpty toc" id="section-toc.1-1.8.2.1.2.1">
                    <p id="section-toc.1-1.8.2.1.2.1.1"><a class="xref" href="#section-8.1.1">8.1.1</a>.  <a class="xref" href="#name-is-the-server-configured-fo">Is the server configured for the zone?</a><a class="pilcrow" href="#section-toc.1-1.8.2.1.2.1.1">¶</a></p>
</li>
                  <li class="compact ulEmpty toc" id="section-toc.1-1.8.2.1.2.2">
                    <p id="section-toc.1-1.8.2.1.2.2.1"><a class="xref" href="#section-8.1.2">8.1.2</a>.  <a class="xref" href="#name-testing-unknown-types">Testing Unknown Types</a><a class="pilcrow" href="#section-toc.1-1.8.2.1.2.2.1">¶</a></p>
</li>
                  <li class="compact ulEmpty toc" id="section-toc.1-1.8.2.1.2.3">
                    <p id="section-toc.1-1.8.2.1.2.3.1"><a class="xref" href="#section-8.1.3">8.1.3</a>.  <a class="xref" href="#name-testing-header-bits">Testing Header Bits</a><a class="pilcrow" href="#section-toc.1-1.8.2.1.2.3.1">¶</a></p>
</li>
                  <li class="compact ulEmpty toc" id="section-toc.1-1.8.2.1.2.4">
                    <p id="section-toc.1-1.8.2.1.2.4.1"><a class="xref" href="#section-8.1.4">8.1.4</a>.  <a class="xref" href="#name-testing-unknown-opcodes">Testing Unknown Opcodes</a><a class="pilcrow" href="#section-toc.1-1.8.2.1.2.4.1">¶</a></p>
</li>
                  <li class="compact ulEmpty toc" id="section-toc.1-1.8.2.1.2.5">
                    <p id="section-toc.1-1.8.2.1.2.5.1"><a class="xref" href="#section-8.1.5">8.1.5</a>.  <a class="xref" href="#name-testing-tcp">Testing TCP</a><a class="pilcrow" href="#section-toc.1-1.8.2.1.2.5.1">¶</a></p>
</li>
                </ul>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a class="xref" href="#section-8.2">8.2</a>.  <a class="xref" href="#name-testing-extended-dns">Testing: Extended DNS</a><a class="pilcrow" href="#section-toc.1-1.8.2.2.1">¶</a></p>
<ul class="compact ulEmpty toc">
<li class="compact ulEmpty toc" id="section-toc.1-1.8.2.2.2.1">
                    <p id="section-toc.1-1.8.2.2.2.1.1"><a class="xref" href="#section-8.2.1">8.2.1</a>.  <a class="xref" href="#name-testing-minimal-edns">Testing Minimal EDNS</a><a class="pilcrow" href="#section-toc.1-1.8.2.2.2.1.1">¶</a></p>
</li>
                  <li class="compact ulEmpty toc" id="section-toc.1-1.8.2.2.2.2">
                    <p id="section-toc.1-1.8.2.2.2.2.1"><a class="xref" href="#section-8.2.2">8.2.2</a>.  <a class="xref" href="#name-testing-edns-version-negoti">Testing EDNS Version Negotiation</a><a class="pilcrow" href="#section-toc.1-1.8.2.2.2.2.1">¶</a></p>
</li>
                  <li class="compact ulEmpty toc" id="section-toc.1-1.8.2.2.2.3">
                    <p id="section-toc.1-1.8.2.2.2.3.1"><a class="xref" href="#section-8.2.3">8.2.3</a>.  <a class="xref" href="#name-testing-unknown-edns-option">Testing Unknown EDNS Options</a><a class="pilcrow" href="#section-toc.1-1.8.2.2.2.3.1">¶</a></p>
</li>
                  <li class="compact ulEmpty toc" id="section-toc.1-1.8.2.2.2.4">
                    <p id="section-toc.1-1.8.2.2.2.4.1"><a class="xref" href="#section-8.2.4">8.2.4</a>.  <a class="xref" href="#name-testing-unknown-edns-flags">Testing Unknown EDNS Flags</a><a class="pilcrow" href="#section-toc.1-1.8.2.2.2.4.1">¶</a></p>
</li>
                  <li class="compact ulEmpty toc" id="section-toc.1-1.8.2.2.2.5">
                    <p id="section-toc.1-1.8.2.2.2.5.1"><a class="xref" href="#section-8.2.5">8.2.5</a>.  <a class="xref" href="#name-testing-edns-version-negotia">Testing EDNS Version Negotiation with Unknown EDNS Flags</a><a class="pilcrow" href="#section-toc.1-1.8.2.2.2.5.1">¶</a></p>
</li>
                  <li class="compact ulEmpty toc" id="section-toc.1-1.8.2.2.2.6">
                    <p id="section-toc.1-1.8.2.2.2.6.1"><a class="xref" href="#section-8.2.6">8.2.6</a>.  <a class="xref" href="#name-testing-edns-version-negotiat">Testing EDNS Version Negotiation with Unknown EDNS Options</a><a class="pilcrow" href="#section-toc.1-1.8.2.2.2.6.1">¶</a></p>
</li>
                  <li class="compact ulEmpty toc" id="section-toc.1-1.8.2.2.2.7">
                    <p id="section-toc.1-1.8.2.2.2.7.1"><a class="xref" href="#section-8.2.7">8.2.7</a>.  <a class="xref" href="#name-testing-truncated-responses">Testing Truncated Responses</a><a class="pilcrow" href="#section-toc.1-1.8.2.2.2.7.1">¶</a></p>
</li>
                  <li class="compact ulEmpty toc" id="section-toc.1-1.8.2.2.2.8">
                    <p id="section-toc.1-1.8.2.2.2.8.1"><a class="xref" href="#section-8.2.8">8.2.8</a>.  <a class="xref" href="#name-testing-do1-handling">Testing DO=1 Handling</a><a class="pilcrow" href="#section-toc.1-1.8.2.2.2.8.1">¶</a></p>
</li>
                  <li class="compact ulEmpty toc" id="section-toc.1-1.8.2.2.2.9">
                    <p id="section-toc.1-1.8.2.2.2.9.1"><a class="xref" href="#section-8.2.9">8.2.9</a>.  <a class="xref" href="#name-testing-edns-version-negotiati">Testing EDNS Version Negotiation with DO=1</a><a class="pilcrow" href="#section-toc.1-1.8.2.2.2.9.1">¶</a></p>
</li>
                  <li class="compact ulEmpty toc" id="section-toc.1-1.8.2.2.2.10">
                    <p id="section-toc.1-1.8.2.2.2.10.1"><a class="xref" href="#section-8.2.10">8.2.10</a>. <a class="xref" href="#name-testing-with-multiple-defin">Testing with Multiple Defined EDNS Options</a><a class="pilcrow" href="#section-toc.1-1.8.2.2.2.10.1">¶</a></p>
</li>
                </ul>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a class="xref" href="#section-8.3">8.3</a>.  <a class="xref" href="#name-when-edns-is-not-supported">When EDNS Is Not Supported</a><a class="pilcrow" href="#section-toc.1-1.8.2.3.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a class="xref" href="#section-9">9</a>.  <a class="xref" href="#name-remediation">Remediation</a><a class="pilcrow" href="#section-toc.1-1.9.1">¶</a></p>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a class="xref" href="#section-10">10</a>. <a class="xref" href="#name-security-considerations">Security Considerations</a><a class="pilcrow" href="#section-toc.1-1.10.1">¶</a></p>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a class="xref" href="#section-11">11</a>. <a class="xref" href="#name-iana-considerations">IANA Considerations</a><a class="pilcrow" href="#section-toc.1-1.11.1">¶</a></p>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a class="xref" href="#section-12">12</a>. <a class="xref" href="#name-references">References</a><a class="pilcrow" href="#section-toc.1-1.12.1">¶</a></p>
<ul class="compact ulEmpty toc">
<li class="compact ulEmpty toc" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a class="xref" href="#section-12.1">12.1</a>.  <a class="xref" href="#name-normative-references">Normative References</a><a class="pilcrow" href="#section-toc.1-1.12.2.1.1">¶</a></p>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a class="xref" href="#section-12.2">12.2</a>.  <a class="xref" href="#name-informative-references">Informative References</a><a class="pilcrow" href="#section-toc.1-1.12.2.2.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a class="xref" href="#section-appendix.a"></a><a class="xref" href="#name-acknowledgements">Acknowledgements</a><a class="pilcrow" href="#section-toc.1-1.13.1">¶</a></p>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a class="xref" href="#section-appendix.b"></a><a class="xref" href="#name-authors-addresses">Authors' Addresses</a><a class="pilcrow" href="#section-toc.1-1.14.1">¶</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="intro">
<section id="section-1">
      <h2 id="name-introduction">
<a class="section-number selfRef" href="#section-1">1. </a><a class="section-name selfRef" href="#name-introduction">Introduction</a>
      </h2>
<p id="section-1-1">The DNS <span>[<a class="xref" href="#RFC1034">RFC1034</a>]</span> <span>[<a class="xref" href="#RFC1035">RFC1035</a>]</span> is a query/response protocol.
      Failing to respond to queries or responding incorrectly causes both
      immediate operational problems and long-term problems with protocol
      development.<a class="pilcrow" href="#section-1-1">¶</a></p>
<p id="section-1-2">
        Failure to respond to a query is indistinguishable from
        packet loss without doing an analysis of query-response
        patterns.  Additionally, failure to respond results in
        unnecessary queries being made by DNS clients and
        introduces delays to the resolution process.<a class="pilcrow" href="#section-1-2">¶</a></p>
<p id="section-1-3">
        Due to the inability to distinguish between packet loss and
        nameservers or middleboxes dropping Extension Mechanisms for DNS
 (EDNS) <span>[<a class="xref" href="#RFC6891">RFC6891</a>]</span> 
        queries, packet loss is sometimes misclassified as lack of EDNS
        support, which can lead to DNSSEC validation failures.<a class="pilcrow" href="#section-1-3">¶</a></p>
<p id="section-1-4">
        The existence of servers that fail to respond to queries
        results in developers being hesitant to deploy new standards.
        Such servers need to be identified and remediated.<a class="pilcrow" href="#section-1-4">¶</a></p>
<p id="section-1-5">
        The DNS has response codes that cover almost any conceivable
        query response.  A nameserver should be able to respond to
        any conceivable query using them.  There should be no need
        to drop queries because a nameserver does not understand
        them.<a class="pilcrow" href="#section-1-5">¶</a></p>
<p id="section-1-6">
        Unless a nameserver is under attack, it should respond to
        all DNS requests directed to it.  When a nameserver is under
        attack, it may wish to drop packets.  A common attack is to
        use a nameserver as an amplifier by sending spoofed packets.
        This is done because response packets are bigger than the
        queries and large amplification factors are available, especially
        if EDNS is supported.  Limiting the rate of responses is
        reasonable when this is occurring, and the client should
        retry.  However, this only works if legitimate clients are
        not being forced to guess whether or not EDNS queries are accepted.  As long as there is still a pool of servers that don't
        respond to EDNS requests, clients have no way to know if
        the lack of response is due to packet loss, EDNS packets
        not being supported, or rate limiting due to the server being
        under attack.  Misclassification of server behaviour is
        unavoidable when rate limiting is used until the population
        of servers that fail to respond to well-formed queries
        drops to near zero.<a class="pilcrow" href="#section-1-6">¶</a></p>
<p id="section-1-7">
        Nameservers should respond to queries even if the queried
        name is not for any name the server is configured to answer
        for.  Misconfigured nameservers are a common occurrence in the
        DNS, and receiving queries for zones that the server is not
        configured for is not necessarily an indication that the
        server is under attack.  Parent zone operators are advised
        to regularly check that the delegating NS records are
        consistent with those of the delegated zone and to correct
        them when they are not (<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc1034#section-4.2.2">Section 4.2.2</a> of [<a class="xref" href="#RFC1034">RFC1034</a>]</span>,
        Paragraph 3).
 Doing this regularly should reduce the instances
        of broken delegations.<a class="pilcrow" href="#section-1-7">¶</a></p>
<p id="section-1-8">
        This document does not try to identify all possible errors
        nor does it supply an exhaustive list of tests.<a class="pilcrow" href="#section-1-8">¶</a></p>
</section>
</div>
<div id="consequences">
<section id="section-2">
      <h2 id="name-consequences">
<a class="section-number selfRef" href="#section-2">2. </a><a class="section-name selfRef" href="#name-consequences">Consequences</a>
      </h2>
<p id="section-2-1">
        Failure to follow the guidance in relevant DNS RFCs has multiple adverse
        consequences.  Some are caused directly by the non-compliant
        behaviour and others as a result of workarounds forced on
        recursive servers.  Addressing known issues now will reduce
        future interoperability issues as the DNS protocol continues
        to evolve and clients make use of newly introduced DNS
        features.  In particular, the base DNS specification
        <span>[<a class="xref" href="#RFC1034">RFC1034</a>]</span> <span>[<a class="xref" href="#RFC1035">RFC1035</a>]</span> and the
        EDNS specification <span>[<a class="xref" href="#RFC6891">RFC6891</a>]</span>, when implemented,
        need to be followed.<a class="pilcrow" href="#section-2-1">¶</a></p>
<p id="section-2-2">
        Some examples of known consequences include the following:<a class="pilcrow" href="#section-2-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-3.1">
            The AD (Authenticated Data) bit in a response
            cannot be trusted to mean anything, as some servers
            incorrectly copy the flag bit from the request to the
            response <span>[<a class="xref" href="#RFC1035">RFC1035</a>]</span> <span>[<a class="xref" href="#RFC4035">RFC4035</a>]</span>. 
            The use of the AD bit in requests is defined in
            <span>[<a class="xref" href="#RFC6840">RFC6840</a>]</span>.<a class="pilcrow" href="#section-2-3.1">¶</a>
</li>
        <li class="normal" id="section-2-3.2">
            Widespread non-response to EDNS queries has led to
            recursive servers having to assume that EDNS is not
            supported and that fallback to plain DNS is required,
            potentially causing DNSSEC validation failures.<a class="pilcrow" href="#section-2-3.2">¶</a>
</li>
        <li class="normal" id="section-2-3.3">
            Widespread non-response to EDNS options requires
            recursive servers to decide whether to probe
            to see if it is the specific EDNS option or the use of
            EDNS in general that is causing the non-response.  In
            the limited amount of time required to resolve a query
            before the client times out, this is not possible.<a class="pilcrow" href="#section-2-3.3">¶</a>
</li>
        <li class="normal" id="section-2-3.4">
            Incorrectly returning FORMERR to an EDNS option being
            present leads to the recursive server not being able
            to determine if the server is just broken in the handling
            of the EDNS option or if it doesn't support EDNS at all.<a class="pilcrow" href="#section-2-3.4">¶</a>
</li>
        <li class="normal" id="section-2-3.5">
            Mishandling of unknown query types has contributed
            to the abandonment of the transition of the SPF type.<a class="pilcrow" href="#section-2-3.5">¶</a>
</li>
        <li class="normal" id="section-2-3.6">
            Mishandling of unknown query types has slowed up the
            development of DNS-Based Authentication of Named Entities (DANE)
     and resulted in additional rules 
            being specified to reduce the probability of interacting
            with a broken server when making TLSA queries.<a class="pilcrow" href="#section-2-3.6">¶</a>
</li>
      </ul>
<p id="section-2-4">
        The consequences of servers not following the RFCs will
        only grow if measures are not put in place to remove non-compliant
 servers from the ecosystem.  Working around issues 
        due to non-compliance with RFCs is not sustainable.<a class="pilcrow" href="#section-2-4">¶</a></p>
<p id="section-2-5">
        Most (if not all) of these consequences could have been
        avoided if action had been taken to remove non-compliant
        servers as soon as people were aware of them, i.e., to actively
        seek out broken implementations and servers and inform their
        developers and operators that they need to fix their servers.<a class="pilcrow" href="#section-2-5">¶</a></p>
</section>
</div>
<div id="query-kinds">
<section id="section-3">
      <h2 id="name-common-kinds-of-queries-tha">
<a class="section-number selfRef" href="#section-3">3. </a><a class="section-name selfRef" href="#name-common-kinds-of-queries-tha">Common Kinds of Queries That Result in No or Bad Responses</a>
      </h2>
<p id="section-3-1">
        This section is broken down into Basic DNS requests and EDNS requests.<a class="pilcrow" href="#section-3-1">¶</a></p>
<section id="section-3.1">
        <h3 id="name-basic-dns-queries">
<a class="section-number selfRef" href="#section-3.1">3.1. </a><a class="section-name selfRef" href="#name-basic-dns-queries">Basic DNS Queries</a>
        </h3>
<div id="existence">
<section id="section-3.1.1">
          <h4 id="name-zone-existence">
<a class="section-number selfRef" href="#section-3.1.1">3.1.1. </a><a class="section-name selfRef" href="#name-zone-existence">Zone Existence</a>
          </h4>
<p id="section-3.1.1-1">
            If a zone is delegated to a server, that server should
            respond to a SOA query for that zone with an SOA record.
            Failing to respond at all is always incorrect, regardless
            of the configuration of the server.  Responding with
            anything other than an SOA record in the answer section
            indicates a bad delegation.<a class="pilcrow" href="#section-3.1.1-1">¶</a></p>
</section>
</div>
<div id="unknown">
<section id="section-3.1.2">
          <h4 id="name-unknown-unsupported-type-qu">
<a class="section-number selfRef" href="#section-3.1.2">3.1.2. </a><a class="section-name selfRef" href="#name-unknown-unsupported-type-qu">Unknown/Unsupported Type Queries</a>
          </h4>
<p id="section-3.1.2-1">
            Some servers fail to respond to unknown or unsupported
            types.  If a server receives a query for a type that
            it doesn't recognise, or doesn't implement, it is
            expected to return the appropriate response as if it
            did recognise the type but does not have any data for
            that type, i.e., either NOERROR or NXDOMAIN.  The exceptions
            to this are queries for Meta-RR types, which may return
            NOTIMP.<a class="pilcrow" href="#section-3.1.2-1">¶</a></p>
</section>
</div>
<div id="dns-flags">
<section id="section-3.1.3">
          <h4 id="name-dns-flags">
<a class="section-number selfRef" href="#section-3.1.3">3.1.3. </a><a class="section-name selfRef" href="#name-dns-flags">DNS Flags</a>
          </h4>
<p id="section-3.1.3-1">
            Some servers fail to respond to DNS queries with various
            DNS flags set, regardless of whether they are defined or
            still reserved.  At the time of writing, there are servers
            that fail to respond to queries with the AD flag set to 1
            and servers that fail to respond to queries with the last
            reserved flag set.<a class="pilcrow" href="#section-3.1.3-1">¶</a></p>
<p id="section-3.1.3-2">Servers should respond to such queries.  If the server does not
   know the meaning of a flag, it must not copy it to the response
   (<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc1035#section-4.1.1">Section 4.1.1</a> of [<a class="xref" href="#RFC1035">RFC1035</a>]</span>). If
   the server does not understand the meaning of a request, it should
   reply with a FORMERR response with unknown flags set to zero.<a class="pilcrow" href="#section-3.1.3-2">¶</a></p>
<div id="recursion">
<section id="section-3.1.3.1">
            <h5 id="name-recursive-queries">
<a class="section-number selfRef" href="#section-3.1.3.1">3.1.3.1. </a><a class="section-name selfRef" href="#name-recursive-queries">Recursive Queries</a>
            </h5>
<p id="section-3.1.3.1-1">
              A non-recursive server is supposed to respond to recursive
              queries as if the Recursion Desired (RD) bit is not set <span>[<a class="xref" href="#RFC1034">RFC1034</a>]</span>.<a class="pilcrow" href="#section-3.1.3.1-1">¶</a></p>
</section>
</div>
</section>
</div>
<div id="opcode">
<section id="section-3.1.4">
          <h4 id="name-unknown-dns-opcodes">
<a class="section-number selfRef" href="#section-3.1.4">3.1.4. </a><a class="section-name selfRef" href="#name-unknown-dns-opcodes">Unknown DNS Opcodes</a>
          </h4>
<p id="section-3.1.4-1">
            The use of previously undefined opcodes is to be expected.
            Since the DNS was first defined, two new opcodes have been
            added, UPDATE and NOTIFY.<a class="pilcrow" href="#section-3.1.4-1">¶</a></p>
<p id="section-3.1.4-2">
            NOTIMP is the expected rcode to an unknown or unimplemented
            opcode.<a class="pilcrow" href="#section-3.1.4-2">¶</a></p>
<aside id="section-3.1.4-3">
            <p id="section-3.1.4-3.1">
            NOTE: while new opcodes will most probably use the current
            layout structure for the rest of the message, there is no
            requirement that anything other than the DNS header match.<a class="pilcrow" href="#section-3.1.4-3.1">¶</a></p>
</aside>
</section>
</div>
<div id="tcp">
<section id="section-3.1.5">
          <h4 id="name-tcp-queries">
<a class="section-number selfRef" href="#section-3.1.5">3.1.5. </a><a class="section-name selfRef" href="#name-tcp-queries">TCP Queries</a>
          </h4>
<p id="section-3.1.5-1">
            All DNS servers are supposed to respond to queries over
            TCP <span>[<a class="xref" href="#RFC7766">RFC7766</a>]</span>.  While firewalls should not
            block TCP connection attempts, those that do should
            cleanly terminate the connection by sending TCP RESET
            or sending ICMP/ICMPv6 Administratively Prohibited
            messages. Dropping TCP connections introduces excessive
            delays to the resolution process.<a class="pilcrow" href="#section-3.1.5-1">¶</a></p>
</section>
</div>
</section>
<section id="section-3.2">
        <h3 id="name-edns-queries">
<a class="section-number selfRef" href="#section-3.2">3.2. </a><a class="section-name selfRef" href="#name-edns-queries">EDNS Queries</a>
        </h3>
<p id="section-3.2-1">
           EDNS queries are specified in <span>[<a class="xref" href="#RFC6891">RFC6891</a>]</span>.<a class="pilcrow" href="#section-3.2-1">¶</a></p>
<div id="edns-independent">
<section id="section-3.2.1">
          <h4 id="name-edns-queries-version-indepe">
<a class="section-number selfRef" href="#section-3.2.1">3.2.1. </a><a class="section-name selfRef" href="#name-edns-queries-version-indepe">EDNS Queries: Version Independent</a>
          </h4>
<p id="section-3.2.1-1">
            Identifying servers that fail to respond to EDNS queries
            can be done by first confirming that the server responds
            to regular DNS queries, followed by a series of otherwise
            identical queries using EDNS, then making the original
            query again.  A series of EDNS queries is needed, as at
            least one DNS implementation responds to the first EDNS
            query with FORMERR but fails to respond to subsequent
            queries from the same address for a period until a
            regular DNS query is made.  The EDNS query should specify
            a UDP buffer size of 512 bytes to avoid false classification
            of not supporting EDNS due to response packet size.<a class="pilcrow" href="#section-3.2.1-1">¶</a></p>
<p id="section-3.2.1-2">
            If the server responds to the first and last queries
            but fails to respond to most or all of the EDNS queries,
            it is probably faulty.  The test should be repeated a
            number of times to eliminate the likelihood of a false
            positive due to packet loss.<a class="pilcrow" href="#section-3.2.1-2">¶</a></p>
<p id="section-3.2.1-3">
            Firewalls may also block larger EDNS responses, but there
            is no easy way to check authoritative servers to see
            if the firewall is misconfigured.<a class="pilcrow" href="#section-3.2.1-3">¶</a></p>
</section>
</div>
<div id="edns-specific">
<section id="section-3.2.2">
          <h4 id="name-edns-queries-version-specif">
<a class="section-number selfRef" href="#section-3.2.2">3.2.2. </a><a class="section-name selfRef" href="#name-edns-queries-version-specif">EDNS Queries: Version Specific</a>
          </h4>
<p id="section-3.2.2-1">
            Some servers respond correctly to EDNS version 0 queries
            but fail to respond to EDNS queries with version numbers
            that are higher than zero.  Servers should respond with
            BADVERS to EDNS queries with version numbers that they
            do not support.<a class="pilcrow" href="#section-3.2.2-1">¶</a></p>
<p id="section-3.2.2-2">
            Some servers respond correctly to EDNS version 0 queries
            but fail to set QR=1 when responding to EDNS versions
            they do not support.  Such responses may be discarded
            as invalid (as QR is not 1) or treated as requests (when the
            source port of the original request was port 53).<a class="pilcrow" href="#section-3.2.2-2">¶</a></p>
</section>
</div>
<div id="edns-options">
<section id="section-3.2.3">
          <h4 id="name-edns-options">
<a class="section-number selfRef" href="#section-3.2.3">3.2.3. </a><a class="section-name selfRef" href="#name-edns-options">EDNS Options</a>
          </h4>
<p id="section-3.2.3-1">
            Some servers fail to respond to EDNS queries with EDNS
            options set.  The original EDNS specification left this
            behaviour undefined <span>[<a class="xref" href="#RFC2671">RFC2671</a>]</span>, but the
            correct behaviour was clarified in <span>[<a class="xref" href="#RFC6891">RFC6891</a>]</span>.
            Unknown EDNS options are supposed to be ignored by the server.<a class="pilcrow" href="#section-3.2.3-1">¶</a></p>
</section>
</div>
<div id="edns-flags">
<section id="section-3.2.4">
          <h4 id="name-edns-flags">
<a class="section-number selfRef" href="#section-3.2.4">3.2.4. </a><a class="section-name selfRef" href="#name-edns-flags">EDNS Flags</a>
          </h4>
<p id="section-3.2.4-1">
            Some servers fail to respond to EDNS queries with EDNS
            flags set.  Servers should ignore EDNS flags they do not
            understand and must not add them to the response <span>[<a class="xref" href="#RFC6891">RFC6891</a>]</span>.<a class="pilcrow" href="#section-3.2.4-1">¶</a></p>
</section>
</div>
<div id="truncated-edns">
<section id="section-3.2.5">
          <h4 id="name-truncated-edns-responses">
<a class="section-number selfRef" href="#section-3.2.5">3.2.5. </a><a class="section-name selfRef" href="#name-truncated-edns-responses">Truncated EDNS Responses</a>
          </h4>
<p id="section-3.2.5-1">
            Some EDNS-aware servers fail to include an OPT record when a
            truncated response is sent.  An OPT record is supposed to be
            included in a truncated response <span>[<a class="xref" href="#RFC6891">RFC6891</a>]</span>.<a class="pilcrow" href="#section-3.2.5-1">¶</a></p>
<p id="section-3.2.5-2">
            Some EDNS-aware servers fail to honour the advertised EDNS
            UDP buffer size and send oversized responses
            <span>[<a class="xref" href="#RFC6891">RFC6891</a>]</span>.  Servers must send UDP responses
            no larger than the advertised EDNS UDP buffer size.<a class="pilcrow" href="#section-3.2.5-2">¶</a></p>
</section>
</div>
<div id="dobit">
<section id="section-3.2.6">
          <h4 id="name-do1-handling">
<a class="section-number selfRef" href="#section-3.2.6">3.2.6. </a><a class="section-name selfRef" href="#name-do1-handling">DO=1 Handling</a>
          </h4>
<p id="section-3.2.6-1">
            Some nameservers incorrectly only return an EDNS response
            when the DNSSEC OK (DO) bit <span>[<a class="xref" href="#RFC3225">RFC3225</a>]</span> is 1 in the
            query.  Servers that support EDNS should always respond to
            EDNS requests with EDNS responses.<a class="pilcrow" href="#section-3.2.6-1">¶</a></p>
<p id="section-3.2.6-2">
            Some nameservers fail to copy the DO bit to the response
            despite clearly supporting DNSSEC by returning an RRSIG
            records to EDNS queries with DO=1.  Nameservers that support
            DNSSEC are expected to copy the DO bit from the request to
            the response.<a class="pilcrow" href="#section-3.2.6-2">¶</a></p>
</section>
</div>
<div id="tcp-edns">
<section id="section-3.2.7">
          <h4 id="name-edns-over-tcp">
<a class="section-number selfRef" href="#section-3.2.7">3.2.7. </a><a class="section-name selfRef" href="#name-edns-over-tcp">EDNS over TCP</a>
          </h4>
<p id="section-3.2.7-1">
            Some EDNS-aware servers incorrectly limit the TCP response
            sizes to the advertised UDP response size.  This breaks DNS
            resolution to clients where the response sizes exceed the
            advertised UDP response size despite the server and the client
            being capable of sending and receiving larger TCP responses,
            respectively.  It effectively defeats setting TC=1 in UDP
            responses.<a class="pilcrow" href="#section-3.2.7-1">¶</a></p>
</section>
</div>
</section>
</section>
</div>
<section id="section-4">
      <h2 id="name-firewalls-and-load-balancer">
<a class="section-number selfRef" href="#section-4">4. </a><a class="section-name selfRef" href="#name-firewalls-and-load-balancer">Firewalls and Load Balancers</a>
      </h2>
<p id="section-4-1">
        Firewalls and load balancers can affect the externally
        visible behaviour of a nameserver.  Tests for conformance
        should to be done from outside of any firewall so that the
        system is tested as a whole.<a class="pilcrow" href="#section-4-1">¶</a></p>
<p id="section-4-2">
        Firewalls and load balancers should not drop DNS packets
        that they don't understand.  They should either pass
        the packets or generate an appropriate error response.<a class="pilcrow" href="#section-4-2">¶</a></p>
<p id="section-4-3">
        Requests for unknown query types are normal client behaviour
        and should not be construed as an attack.  Nameservers have
        always been expected to be able to handle such queries.<a class="pilcrow" href="#section-4-3">¶</a></p>
<p id="section-4-4">
        Requests for unknown query classes are normal client behaviour
        and should not be construed as an attack.  Nameservers have
        always been expected to be able to handle such queries.<a class="pilcrow" href="#section-4-4">¶</a></p>
<p id="section-4-5">
        Requests with unknown opcodes are normal client behaviour
        and should not be construed as an attack.  Nameservers have
        always been expected to be able to handle such queries.<a class="pilcrow" href="#section-4-5">¶</a></p>
<p id="section-4-6">Requests with unassigned flags set (DNS or EDNS) are expected client
      behaviour and should not be construed as an attack. The behaviour for
      unassigned flags is to ignore them in the request and to not set them in
      the response.  Dropping DNS/EDNS packets with unassigned flags makes it
      difficult to deploy extensions that make use of them due to the need to
      reconfigure and update firewalls.<a class="pilcrow" href="#section-4-6">¶</a></p>
<p id="section-4-7">
        Requests with unknown EDNS options are expected client
        behaviour and should not be construed as an attack.  The
        correct behaviour for unknown EDNS options is to ignore
        their presence when constructing a reply.<a class="pilcrow" href="#section-4-7">¶</a></p>
<p id="section-4-8">
        Requests with unknown EDNS versions are expected client
        behaviour and should not be construed as an attack.  The
        correct behaviour for unknown EDNS versions is to return
        BADVERS along with the highest EDNS version the server
        supports.  Dropping EDNS packets breaks EDNS version
        negotiation.<a class="pilcrow" href="#section-4-8">¶</a></p>
<p id="section-4-9">
        Firewalls should not assume that there will only be a single
        response message to a request.  There have been proposals
        to use EDNS to signal that multiple DNS messages be returned
        rather than a single UDP message that is fragmented at the
        IP layer.<a class="pilcrow" href="#section-4-9">¶</a></p>
<p id="section-4-10">
        DNS, and EDNS in particular, are designed to allow clients to
        be able to use new features against older servers without
        having to validate every option.  Indiscriminate blocking
        of messages breaks that design.<a class="pilcrow" href="#section-4-10">¶</a></p>
<p id="section-4-11">
        However, there may be times when a nameserver mishandles
        messages with a particular flag, EDNS option, EDNS version
        field, opcode, type or class field, or combination thereof
        to the point where the integrity of the nameserver is
        compromised.  Firewalls should offer the ability to selectively
        reject messages using an appropriately constructed response
        based on all these fields while awaiting a fix from the
        nameserver vendor.  Returning FORMERR or REFUSED are two
        potential error codes to return.<a class="pilcrow" href="#section-4-11">¶</a></p>
</section>
<div id="scrubbing">
<section id="section-5">
      <h2 id="name-packet-scrubbing-services">
<a class="section-number selfRef" href="#section-5">5. </a><a class="section-name selfRef" href="#name-packet-scrubbing-services">Packet Scrubbing Services</a>
      </h2>
<p id="section-5-1">
        Packet scrubbing services are used to filter out undesired traffic,
        including but not limited to denial-of-service traffic.  This is
        often done using heuristic analysis of the traffic.<a class="pilcrow" href="#section-5-1">¶</a></p>
<p id="section-5-2">
        Packet scrubbing services can affect the externally visible behaviour
        of a nameserver in a similar way to firewalls.  If an operator
        uses a packet scrubbing service, they should check that legitimate
        queries are not being blocked.<a class="pilcrow" href="#section-5-2">¶</a></p>
<p id="section-5-3">
        Packet scrubbing services, unlike firewalls, are also turned on
        and off in response to denial-of-service attacks.  One needs
        to take care when choosing a scrubbing service.<a class="pilcrow" href="#section-5-3">¶</a></p>
<p id="section-5-4">
        Ideally, operators should run these tests against a packet scrubbing
        service to ensure that these tests are not seen as attack
        vectors.<a class="pilcrow" href="#section-5-4">¶</a></p>
</section>
</div>
<section id="section-6">
      <h2 id="name-whole-answer-caches">
<a class="section-number selfRef" href="#section-6">6. </a><a class="section-name selfRef" href="#name-whole-answer-caches">Whole Answer Caches</a>
      </h2>
<p id="section-6-1">
        Whole answer caches take a previously constructed answer
        and return it to a subsequent query for the same question.
        However, they can return the wrong response if they do not
        take all of the relevant attributes of the query into account.<a class="pilcrow" href="#section-6-1">¶</a></p>
<p id="section-6-2">
        In addition to the standard tuple of &lt;qname,qtype,qclass&gt;,
        a non-exhaustive set of attributes that must be considered
        include: RD, AD, CD, OPT record, DO, EDNS buffer size, EDNS
        version, EDNS options, and transport.<a class="pilcrow" href="#section-6-2">¶</a></p>
</section>
<div id="response">
<section id="section-7">
      <h2 id="name-response-code-selection">
<a class="section-number selfRef" href="#section-7">7. </a><a class="section-name selfRef" href="#name-response-code-selection">Response Code Selection</a>
      </h2>
<p id="section-7-1">
        Choosing the correct response code when responding to DNS
        queries is important.  Response codes should be chosen
        considering how clients will handle them.<a class="pilcrow" href="#section-7-1">¶</a></p>
<p id="section-7-2">
        For unimplemented opcodes, NOTIMP is the expected response code.
        Note: newly implemented opcodes may change the message format by
        extending the header, changing the structure of the records,
        etc.  Servers are not expected to be able to parse these
        and should respond with a response code of NOTIMP rather
        than FORMERR (which would be expected if there was a parse error
        with a known opcode).<a class="pilcrow" href="#section-7-2">¶</a></p>
<p id="section-7-3">
        For unimplemented type codes, and in the absence of other
        errors, the only valid response is NOERROR if the qname
        exists and NXDOMAIN otherwise.  

 For Meta-RRs, NOTIMP may be returned instead.<a class="pilcrow" href="#section-7-3">¶</a></p>
<p id="section-7-4">If a zone cannot be loaded because it contains unimplemented type
      codes that are not encoded as unknown record types according to <span>[<a class="xref" href="#RFC3597">RFC3597</a>]</span>, then the expected response is
      SERVFAIL, as the whole zone should be rejected (<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc1035#section-5.2">Section 5.2</a> of [<a class="xref" href="#RFC1035">RFC1035</a>]</span>).  If a zone loads, then <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc1034#section-4.3.2">Section 4.3.2</a> of [<a class="xref" href="#RFC1034">RFC1034</a>]</span> applies.<a class="pilcrow" href="#section-7-4">¶</a></p>
<p id="section-7-5">
        If the server supports EDNS and receives a query with an
        unsupported EDNS version, the correct response is BADVERS
        <span>[<a class="xref" href="#RFC6891">RFC6891</a>]</span>.<a class="pilcrow" href="#section-7-5">¶</a></p>
<p id="section-7-6">
        If the server does not support EDNS at all, FORMERR is
        the expected error code.  That said, a minimal EDNS
        server implementation requires parsing the OPT records
        and responding with an empty OPT record in the additional
        section in most cases.  There is no need to interpret any
        EDNS options present in the request, as unsupported EDNS
        options are expected to be ignored <span>[<a class="xref" href="#RFC6891">RFC6891</a>]</span>.
        Additionally, EDNS flags can be ignored.  The only part of the
        OPT record that needs to be examined is the version field
        to determine if BADVERS needs to be sent or not.<a class="pilcrow" href="#section-7-6">¶</a></p>
</section>
</div>
<div id="testing">
<section id="section-8">
      <h2 id="name-testing">
<a class="section-number selfRef" href="#section-8">8. </a><a class="section-name selfRef" href="#name-testing">Testing</a>
      </h2>
<p id="section-8-1">
        Testing is divided into two sections:  "Basic DNS", which all
        servers should meet, and "Extended DNS", which should be met
        by all servers that support EDNS (a server is deemed to
        support EDNS if it gives a valid EDNS response to any EDNS
        query).  If a server does not support EDNS, it should still
        respond to all the tests, albeit with error responses.<a class="pilcrow" href="#section-8-1">¶</a></p>
<p id="section-8-2">
        These tests query for records at the apex of a zone that the
        server is nominally configured to serve.  All tests should
        use the same zone.<a class="pilcrow" href="#section-8-2">¶</a></p>
<p id="section-8-3">
        It is advisable to run all of the tests below in parallel
        so as to minimise the delays due to multiple timeouts when
        the servers do not respond.  There are 16 queries directed
        to each nameserver (assuming no packet loss) testing different
        aspects of Basic DNS and Extended DNS.<a class="pilcrow" href="#section-8-3">¶</a></p>
<p id="section-8-4">
        The tests below use dig from BIND 9.11.0 <span>[<a class="xref" href="#ISC">ISC</a>]</span>.
        Replace $zone with the name of the zone being used for testing.
        Replace $server with the name or address of the server being tested.<a class="pilcrow" href="#section-8-4">¶</a></p>
<p id="section-8-5">
        When testing, recursive servers set RD=1 and choose a zone
        name that is known to exist and is not being served by the
        recursive server.  The root zone (".") is often a good
        candidate, as it is DNSSEC signed.  RD=1, rather than RD=0,
        should be present in the responses for all test involving 
        the opcode QUERY.  Non-authoritative answers (AA=0) are
        expected when talking to a recursive server.  AD=1 is only
        expected if the server is validating responses and
        one or both AD=1 or DO=1 is set in the request, otherwise
        AD=0 is expected.<a class="pilcrow" href="#section-8-5">¶</a></p>
<div id="testing-basic">
<section id="section-8.1">
        <h3 id="name-testing-basic-dns">
<a class="section-number selfRef" href="#section-8.1">8.1. </a><a class="section-name selfRef" href="#name-testing-basic-dns">Testing: Basic DNS</a>
        </h3>
<p id="section-8.1-1">
          This first set of tests cover Basic DNS server behaviour
          and all servers should pass these tests.<a class="pilcrow" href="#section-8.1-1">¶</a></p>
<section id="section-8.1.1">
          <h4 id="name-is-the-server-configured-fo">
<a class="section-number selfRef" href="#section-8.1.1">8.1.1. </a><a class="section-name selfRef" href="#name-is-the-server-configured-fo">Is the server configured for the zone?</a>
          </h4>
<p id="section-8.1.1-1">
            Ask for the SOA record of the configured zone.  This
            query is made with no DNS flag bits set and without
            EDNS.<a class="pilcrow" href="#section-8.1.1-1">¶</a></p>
<p id="section-8.1.1-2">
            We expect the SOA record for the zone to be returned
            in the answer section, the rcode to be set to NOERROR, and
            the Authoritative Answer (AA) and Query/Response (QR) bits to be
     set in the header; the Recursion Available (RA) bits may also be
     set <span>[<a class="xref" href="#RFC1034">RFC1034</a>]</span>.  We 
     do not expect an OPT record to be returned <span>[<a class="xref" href="#RFC6891">RFC6891</a>]</span>.<a class="pilcrow" href="#section-8.1.1-2">¶</a></p>
<p class="keepWithNext" id="section-8.1.1-3">
                Verify the server is configured for the zone:<a class="pilcrow" href="#section-8.1.1-3">¶</a></p>
<div id="section-8.1.1-4">
<pre class="sourcecode">dig +noedns +noad +norec soa $zone @$server

expect: status: NOERROR
expect: the SOA record to be present in the answer section
expect: flag: aa to be present
expect: flag: rd to NOT be present
expect: flag: ad to NOT be present
expect: the OPT record to NOT be present
</pre><a class="pilcrow" href="#section-8.1.1-4">¶</a>
</div>
</section>
<section id="section-8.1.2">
          <h4 id="name-testing-unknown-types">
<a class="section-number selfRef" href="#section-8.1.2">8.1.2. </a><a class="section-name selfRef" href="#name-testing-unknown-types">Testing Unknown Types</a>
          </h4>
<p id="section-8.1.2-1">

     
            Identifying servers that fail to respond to unknown or
            unsupported types can be done by making an initial DNS
            query for an A record, making a number of queries for an
            unallocated type, then making a query for an A record
            again.  IANA maintains a registry of allocated types <span>[<a class="xref" href="#IANA-DNS">IANA-DNS</a>]</span>.<a class="pilcrow" href="#section-8.1.2-1">¶</a></p>
<p id="section-8.1.2-2">
            If the server responds to the first and last queries but
            fails to respond to the queries for the unallocated type,
            it is probably faulty.  The test should be repeated a
            number of times to eliminate the likelihood of a false
            positive due to packet loss.<a class="pilcrow" href="#section-8.1.2-2">¶</a></p>
<p id="section-8.1.2-3">
            Ask for the TYPE1000 RRset at the configured zone's
            name.  This query is made with no DNS flag bits set and
            without EDNS.  TYPE1000 has been chosen for this purpose,
            as IANA is unlikely to allocate this type in the near
            future and it is not in a range reserved for private
            use <span>[<a class="xref" href="#RFC6895">RFC6895</a>]</span>.  Any unallocated type code
            could be chosen for this test.<a class="pilcrow" href="#section-8.1.2-3">¶</a></p>
<p id="section-8.1.2-4">
            We expect no records to be returned in the answer
            section, the rcode to be set to NOERROR, and the AA and
            QR bits to be set in the header; RA may also be set
            <span>[<a class="xref" href="#RFC1034">RFC1034</a>]</span>.  We do not expect an OPT record
            to be returned <span>[<a class="xref" href="#RFC6891">RFC6891</a>]</span>.<a class="pilcrow" href="#section-8.1.2-4">¶</a></p>
<p class="keepWithNext" id="section-8.1.2-5">
                Check that queries for an unknown type work:<a class="pilcrow" href="#section-8.1.2-5">¶</a></p>
<div id="section-8.1.2-6">
<pre class="sourcecode">dig +noedns +noad +norec type1000 $zone @$server

expect: status: NOERROR
expect: an empty answer section.
expect: flag: aa to be present
expect: flag: rd to NOT be present
expect: flag: ad to NOT be present
expect: the OPT record to NOT be present
</pre><a class="pilcrow" href="#section-8.1.2-6">¶</a>
</div>
</section>
<section id="section-8.1.3">
          <h4 id="name-testing-header-bits">
<a class="section-number selfRef" href="#section-8.1.3">8.1.3. </a><a class="section-name selfRef" href="#name-testing-header-bits">Testing Header Bits</a>
          </h4>
<section id="section-8.1.3.1">
            <h5 id="name-testing-cd1-queries">
<a class="section-number selfRef" href="#section-8.1.3.1">8.1.3.1. </a><a class="section-name selfRef" href="#name-testing-cd1-queries">Testing CD=1 Queries</a>
            </h5>
<p id="section-8.1.3.1-1">
              Ask for the SOA record of the configured zone.
              This query is made with only the CD DNS flag bit set,
              with all other DNS bits clear, and without EDNS.<a class="pilcrow" href="#section-8.1.3.1-1">¶</a></p>
<p id="section-8.1.3.1-2">
              We expect the SOA record for the zone to be returned
              in the answer section, the rcode to be set to NOERROR,
              and the AA and QR bits to be set in the header.  We
              do not expect an OPT record to be returned.<a class="pilcrow" href="#section-8.1.3.1-2">¶</a></p>
<p id="section-8.1.3.1-3">
              If the server supports DNSSEC, CD should be set in
              the response <span>[<a class="xref" href="#RFC4035">RFC4035</a>]</span>; otherwise, CD
              should be clear <span>[<a class="xref" href="#RFC1034">RFC1034</a>]</span>.<a class="pilcrow" href="#section-8.1.3.1-3">¶</a></p>
<p class="keepWithNext" id="section-8.1.3.1-4">
                  Check that queries with CD=1 work:<a class="pilcrow" href="#section-8.1.3.1-4">¶</a></p>
<div id="section-8.1.3.1-5">
<pre class="sourcecode">dig +noedns +noad +norec +cd soa $zone @$server

expect: status: NOERROR
expect: the SOA record to be present in the answer section
expect: flag: aa to be present
expect: flag: rd to NOT be present
expect: flag: ad to NOT be present
expect: the OPT record to NOT be present
</pre><a class="pilcrow" href="#section-8.1.3.1-5">¶</a>
</div>
</section>
<section id="section-8.1.3.2">
            <h5 id="name-testing-ad1-queries">
<a class="section-number selfRef" href="#section-8.1.3.2">8.1.3.2. </a><a class="section-name selfRef" href="#name-testing-ad1-queries">Testing AD=1 Queries</a>
            </h5>
<p id="section-8.1.3.2-1">Ask for the SOA record of the configured zone.  This query is
     made with only the AD DNS flag bit set, with all other DNS bits clear,
     and without EDNS.<a class="pilcrow" href="#section-8.1.3.2-1">¶</a></p>
<p id="section-8.1.3.2-2">
              We expect the SOA record for the zone to be returned
              in the answer section, the rcode to be set to NOERROR,
              and the AA and QR bits to be set in the header.  We
              do not expect an OPT record to be returned.  The
              purpose of this query is to detect blocking of queries
              with the AD bit present, not the specific value of
              AD in the response.<a class="pilcrow" href="#section-8.1.3.2-2">¶</a></p>
<p class="keepWithNext" id="section-8.1.3.2-3">
                  Check that queries with AD=1 work:<a class="pilcrow" href="#section-8.1.3.2-3">¶</a></p>
<div id="section-8.1.3.2-4">
<pre class="sourcecode">dig +noedns +norec +ad soa $zone @$server

expect: status: NOERROR
expect: the SOA record to be present in the answer section
expect: flag: aa to be present
expect: flag: rd to NOT be present
expect: the OPT record to NOT be present
</pre><a class="pilcrow" href="#section-8.1.3.2-4">¶</a>
</div>
<p class="keepWithPrevious" id="section-8.1.3.2-5">
                  AD use in queries is defined in <span>[<a class="xref" href="#RFC6840">RFC6840</a>]</span>.<a class="pilcrow" href="#section-8.1.3.2-5">¶</a></p>
</section>
<section id="section-8.1.3.3">
            <h5 id="name-testing-reserved-bit">
<a class="section-number selfRef" href="#section-8.1.3.3">8.1.3.3. </a><a class="section-name selfRef" href="#name-testing-reserved-bit">Testing Reserved Bit</a>
            </h5>
<p id="section-8.1.3.3-1">
              Ask for the SOA record of the configured zone.  This
              query is made with only the final reserved DNS flag
              bit set, with all other DNS bits clear, and without EDNS.<a class="pilcrow" href="#section-8.1.3.3-1">¶</a></p>
<p id="section-8.1.3.3-2">
              We expect the SOA record for the zone to be returned
              in the answer section, the rcode to be set to NOERROR,
              and the AA and QR bits to be set in the header; RA
              may be set.  The final reserved bit must not be set
              <span>[<a class="xref" href="#RFC1034">RFC1034</a>]</span>.  We do not expect an OPT
              record to be returned <span>[<a class="xref" href="#RFC6891">RFC6891</a>]</span>.<a class="pilcrow" href="#section-8.1.3.3-2">¶</a></p>
<p class="keepWithNext" id="section-8.1.3.3-3">
                  Check that queries with the last unassigned DNS
                  header flag work and that the flag bit is not
                  copied to the response:<a class="pilcrow" href="#section-8.1.3.3-3">¶</a></p>
<div id="section-8.1.3.3-4">
<pre class="sourcecode">dig +noedns +noad +norec +zflag soa $zone @$server

expect: status: NOERROR
expect: the SOA record to be present in the answer section
expect: MBZ to NOT be in the response (see below)
expect: flag: aa to be present
expect: flag: rd to NOT be present
expect: flag: ad to NOT be present
expect: the OPT record to NOT be present
</pre><a class="pilcrow" href="#section-8.1.3.3-4">¶</a>
</div>
<p class="keepWithPrevious" id="section-8.1.3.3-5"> MBZ (Must Be Zero) is a dig-specific
     indication that the flag bit has been incorrectly copied.  See
     <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc1035#section-4.1.1">Section 4.1.1</a> of [<a class="xref" href="#RFC1035">RFC1035</a>]</span>:<a class="pilcrow" href="#section-8.1.3.3-5">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-8.1.3.3-6">
              <dt id="section-8.1.3.3-6.1">"Z</dt>
              <dd id="section-8.1.3.3-6.2" style="margin-left: 1.5em">Reserved for future use.  Must be zero in all queries and responses."<a class="pilcrow" href="#section-8.1.3.3-6.2">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</section>
<section id="section-8.1.3.4">
            <h5 id="name-testing-recursive-queries">
<a class="section-number selfRef" href="#section-8.1.3.4">8.1.3.4. </a><a class="section-name selfRef" href="#name-testing-recursive-queries">Testing Recursive Queries</a>
            </h5>
<p id="section-8.1.3.4-1">
              Ask for the SOA record of the configured zone.  This
              query is made with only the RD DNS flag bit set and
              without EDNS.<a class="pilcrow" href="#section-8.1.3.4-1">¶</a></p>
<p id="section-8.1.3.4-2">
              We expect the SOA record for the zone to be returned
              in the answer section, the rcode to be set to NOERROR, and
              the AA, QR and RD bits to be set in the header; RA
              may also be set <span>[<a class="xref" href="#RFC1034">RFC1034</a>]</span>.  We do not
              expect an OPT record to be returned <span>[<a class="xref" href="#RFC6891">RFC6891</a>]</span>.<a class="pilcrow" href="#section-8.1.3.4-2">¶</a></p>
<p class="keepWithNext" id="section-8.1.3.4-3">
                  Check that recursive queries work:<a class="pilcrow" href="#section-8.1.3.4-3">¶</a></p>
<div id="section-8.1.3.4-4">
<pre class="sourcecode">dig +noedns +noad +rec soa $zone @$server

expect: status: NOERROR
expect: the SOA record to be present in the answer section
expect: flag: aa to be present
expect: flag: rd to be present
expect: flag: ad to NOT be present
expect: the OPT record to NOT be present
</pre><a class="pilcrow" href="#section-8.1.3.4-4">¶</a>
</div>
</section>
</section>
<section id="section-8.1.4">
          <h4 id="name-testing-unknown-opcodes">
<a class="section-number selfRef" href="#section-8.1.4">8.1.4. </a><a class="section-name selfRef" href="#name-testing-unknown-opcodes">Testing Unknown Opcodes</a>
          </h4>
<p id="section-8.1.4-1">
            Construct a DNS message that consists of only a DNS
            header with opcode set to 15 (currently not allocated),
            no DNS header bits set, and empty question, answer,
            authority, and additional sections.<a class="pilcrow" href="#section-8.1.4-1">¶</a></p>
<p class="keepWithNext" id="section-8.1.4-2">
                Check that new opcodes are handled:<a class="pilcrow" href="#section-8.1.4-2">¶</a></p>
<div id="section-8.1.4-3">
<pre class="sourcecode">dig +noedns +noad +opcode=15 +norec +header-only @$server

expect: status: NOTIMP
expect: opcode: 15
expect: all sections to be empty
expect: flag: aa to NOT be present
expect: flag: rd to NOT be present
expect: flag: ad to NOT be present
expect: the OPT record to NOT be present
</pre><a class="pilcrow" href="#section-8.1.4-3">¶</a>
</div>
</section>
<section id="section-8.1.5">
          <h4 id="name-testing-tcp">
<a class="section-number selfRef" href="#section-8.1.5">8.1.5. </a><a class="section-name selfRef" href="#name-testing-tcp">Testing TCP</a>
          </h4>
<p id="section-8.1.5-1">
            Whether a server accepts TCP connections can be tested
            by first checking that it responds to UDP queries to
            confirm that it is up and operating, then attempting the
            same query over TCP.  An additional query should be made
            over UDP if the TCP connection attempt fails to confirm
            that the server under test is still operating.<a class="pilcrow" href="#section-8.1.5-1">¶</a></p>
<p id="section-8.1.5-2">
            Ask for the SOA record of the configured zone.  This
            query is made with no DNS flag bits set and without
            EDNS.  This query is to be sent using TCP.<a class="pilcrow" href="#section-8.1.5-2">¶</a></p>
<p id="section-8.1.5-3">
            We expect the SOA record for the zone to be returned
            in the answer section, the rcode to be set to NOERROR, and
            the AA and QR bits to be set in the header; RA may
            also be set <span>[<a class="xref" href="#RFC1034">RFC1034</a>]</span>.  We do not expect
            an OPT record to be returned <span>[<a class="xref" href="#RFC6891">RFC6891</a>]</span>.<a class="pilcrow" href="#section-8.1.5-3">¶</a></p>
<p class="keepWithNext" id="section-8.1.5-4">
                Check that TCP queries work:<a class="pilcrow" href="#section-8.1.5-4">¶</a></p>
<div id="section-8.1.5-5">
<pre class="sourcecode">dig +noedns +noad +norec +tcp soa $zone @$server

expect: status: NOERROR
expect: the SOA record to be present in the answer section
expect: flag: aa to be present
expect: flag: rd to NOT be present
expect: flag: ad to NOT be present
expect: the OPT record to NOT be present
</pre><a class="pilcrow" href="#section-8.1.5-5">¶</a>
</div>
<p class="keepWithPrevious" id="section-8.1.5-6">
                The requirement that TCP be supported is defined
                in <span>[<a class="xref" href="#RFC7766">RFC7766</a>]</span>.<a class="pilcrow" href="#section-8.1.5-6">¶</a></p>
</section>
</section>
</div>
<div id="testing-edns">
<section id="section-8.2">
        <h3 id="name-testing-extended-dns">
<a class="section-number selfRef" href="#section-8.2">8.2. </a><a class="section-name selfRef" href="#name-testing-extended-dns">Testing: Extended DNS</a>
        </h3>
<p id="section-8.2-1">
          The next set of tests cover various aspects of EDNS
          behaviour.  If any of these tests succeed (indicating
          at least some EDNS support), then all of them should
          succeed.  There are servers that support EDNS but fail
          to handle plain EDNS queries correctly, so a plain EDNS
          query is not a good indicator of lack of EDNS support.<a class="pilcrow" href="#section-8.2-1">¶</a></p>
<section id="section-8.2.1">
          <h4 id="name-testing-minimal-edns">
<a class="section-number selfRef" href="#section-8.2.1">8.2.1. </a><a class="section-name selfRef" href="#name-testing-minimal-edns">Testing Minimal EDNS</a>
          </h4>
<p id="section-8.2.1-1">
            Ask for the SOA record of the configured zone.  This
            query is made with no DNS flag bits set.  EDNS version
            0 is used without any EDNS options or EDNS flags set.<a class="pilcrow" href="#section-8.2.1-1">¶</a></p>
<p id="section-8.2.1-2">
            We expect the SOA record for the zone to be returned
            in the answer section, the rcode to be set to NOERROR, and
            the AA and QR bits to be set in the header; RA may
            also be set <span>[<a class="xref" href="#RFC1034">RFC1034</a>]</span>.  We expect
            an OPT record to be returned.  There should be no EDNS
            flags present in the response.  The EDNS version field
            should be 0, and there should be no EDNS options present
            <span>[<a class="xref" href="#RFC6891">RFC6891</a>]</span>.<a class="pilcrow" href="#section-8.2.1-2">¶</a></p>
<p class="keepWithNext" id="section-8.2.1-3">
                Check that plain EDNS queries work:<a class="pilcrow" href="#section-8.2.1-3">¶</a></p>
<div id="section-8.2.1-4">
<pre class="sourcecode">dig +nocookie +edns=0 +noad +norec soa $zone @$server

expect: status: NOERROR
expect: the SOA record to be present in the answer section
expect: an OPT record to be present in the additional section
expect: EDNS Version 0 in response
expect: flag: aa to be present
expect: flag: ad to NOT be present
</pre><a class="pilcrow" href="#section-8.2.1-4">¶</a>
</div>
<p class="keepWithPrevious" id="section-8.2.1-5">
                +nocookie disables sending an EDNS COOKIE option, which
                is otherwise enabled by default in BIND 9.11.0 (and
                later).<a class="pilcrow" href="#section-8.2.1-5">¶</a></p>
</section>
<section id="section-8.2.2">
          <h4 id="name-testing-edns-version-negoti">
<a class="section-number selfRef" href="#section-8.2.2">8.2.2. </a><a class="section-name selfRef" href="#name-testing-edns-version-negoti">Testing EDNS Version Negotiation</a>
          </h4>
<p id="section-8.2.2-1">
            Ask for the SOA record of a zone the server is nominally
            configured to serve.  This query is made with no DNS flag
            bits set.  EDNS version 1 is used without any EDNS options
            or EDNS flags set.<a class="pilcrow" href="#section-8.2.2-1">¶</a></p>
<p id="section-8.2.2-2">
            We expect the SOA record for the zone to NOT be returned
            in the answer section with the extended rcode set to
            BADVERS and the QR bit to be set in the header; RA
            may also be set <span>[<a class="xref" href="#RFC1034">RFC1034</a>]</span>.  We expect
            an OPT record to be returned.  There should be no EDNS
            flags present in the response.  The EDNS version field
            should be 0 in the response, as no other EDNS version
            has as yet been specified <span>[<a class="xref" href="#RFC6891">RFC6891</a>]</span>.<a class="pilcrow" href="#section-8.2.2-2">¶</a></p>
<p class="keepWithNext" id="section-8.2.2-3">
                Check that EDNS version 1 queries work (EDNS supported):<a class="pilcrow" href="#section-8.2.2-3">¶</a></p>
<div id="section-8.2.2-4">
<pre class="sourcecode">dig +nocookie +edns=1 +noednsneg +noad +norec soa $zone @$server

expect: status: BADVERS
expect: the SOA record to NOT be present in the answer section
expect: an OPT record to be present in the additional section
expect: EDNS Version 0 in response
expect: flag: aa to NOT be present
expect: flag: ad to NOT be present
</pre><a class="pilcrow" href="#section-8.2.2-4">¶</a>
</div>
<p class="keepWithPrevious" id="section-8.2.2-5">
                +noednsneg has been set, as dig supports EDNS version
                negotiation, and we want to see only the response to the
                initial EDNS version 1 query.<a class="pilcrow" href="#section-8.2.2-5">¶</a></p>
</section>
<section id="section-8.2.3">
          <h4 id="name-testing-unknown-edns-option">
<a class="section-number selfRef" href="#section-8.2.3">8.2.3. </a><a class="section-name selfRef" href="#name-testing-unknown-edns-option">Testing Unknown EDNS Options</a>
          </h4>
<p id="section-8.2.3-1">
            Ask for the SOA record of the configured zone.  This
            query is made with no DNS flag bits set.  EDNS version
            0 is used without any EDNS flags.  An EDNS option is
            present with a value that has not yet been assigned by
            IANA.  We have picked an unassigned code of 100 for
            the example below.  Any unassigned EDNS option code
            could have been chosen for this test.<a class="pilcrow" href="#section-8.2.3-1">¶</a></p>
<p id="section-8.2.3-2">
            We expect the SOA record for the zone to be returned
            in the answer section, the rcode to be set to NOERROR, and
            the AA and QR bits to be set in the header; RA may
            also be set <span>[<a class="xref" href="#RFC1034">RFC1034</a>]</span>.  We expect
            an OPT record to be returned.  There should be no EDNS
            flags present in the response.  The EDNS version field
            should be 0, as EDNS versions other than 0 are yet to
            be specified, and there should be no EDNS options present,
            as unknown EDNS options are supposed to be ignored by the
            server (<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc6891#section-6.1.1">Section 6.1.1</a> of [<a class="xref" href="#RFC6891">RFC6891</a>]</span>).<a class="pilcrow" href="#section-8.2.3-2">¶</a></p>
<p class="keepWithNext" id="section-8.2.3-3">
                Check that EDNS queries with an unknown option work (EDNS supported):<a class="pilcrow" href="#section-8.2.3-3">¶</a></p>
<div id="section-8.2.3-4">
<pre class="sourcecode">dig +nocookie +edns=0 +noad +norec +ednsopt=100 soa $zone @$server

expect: status: NOERROR
expect: the SOA record to be present in the answer section
expect: an OPT record to be present in the additional section
expect: OPT=100 to NOT be present
expect: EDNS Version 0 in response
expect: flag: aa to be present
expect: flag: ad to NOT be present
</pre><a class="pilcrow" href="#section-8.2.3-4">¶</a>
</div>
</section>
<section id="section-8.2.4">
          <h4 id="name-testing-unknown-edns-flags">
<a class="section-number selfRef" href="#section-8.2.4">8.2.4. </a><a class="section-name selfRef" href="#name-testing-unknown-edns-flags">Testing Unknown EDNS Flags</a>
          </h4>
<p id="section-8.2.4-1">
            Ask for the SOA record of the configured zone.  This
            query is made with no DNS flag bits set.  EDNS version
            0 is used without any EDNS options.  An unassigned EDNS
            flag bit is set (0x40 in this case).<a class="pilcrow" href="#section-8.2.4-1">¶</a></p>
<p id="section-8.2.4-2">
            We expect the SOA record for the zone to be returned
            in the answer section, the rcode to be set to NOERROR, and
            the AA and QR bits to be set in the header; RA may
            also be set <span>[<a class="xref" href="#RFC1034">RFC1034</a>]</span>.  We expect
            an OPT record to be returned.  There should be no EDNS
            flags present in the response, as unknown EDNS flags are
            supposed to be ignored.  The EDNS version field
            should be 0, and there should be no EDNS options present
            <span>[<a class="xref" href="#RFC6891">RFC6891</a>]</span>.<a class="pilcrow" href="#section-8.2.4-2">¶</a></p>
<p class="keepWithNext" id="section-8.2.4-3">
                Check that EDNS queries with unknown flags work (EDNS supported):<a class="pilcrow" href="#section-8.2.4-3">¶</a></p>
<div id="section-8.2.4-4">
<pre class="sourcecode">dig +nocookie +edns=0 +noad +norec +ednsflags=0x40 soa $zone @$server

expect: status: NOERROR
expect: the SOA record to be present in the answer section
expect: an OPT record to be present in the additional section
expect: MBZ not to be present
expect: EDNS Version 0 in response
expect: flag: aa to be present
expect: flag: ad to NOT be present
</pre><a class="pilcrow" href="#section-8.2.4-4">¶</a>
</div>
<p class="keepWithPrevious" id="section-8.2.4-5">
                MBZ (Must Be Zero) is a dig-specific indication that
                a flag bit has been incorrectly copied, as per
                <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc6891#section-6.1.4">Section 6.1.4</a> of [<a class="xref" href="#RFC6891">RFC6891</a>]</span>.<a class="pilcrow" href="#section-8.2.4-5">¶</a></p>
</section>
<section id="section-8.2.5">
          <h4 id="name-testing-edns-version-negotia">
<a class="section-number selfRef" href="#section-8.2.5">8.2.5. </a><a class="section-name selfRef" href="#name-testing-edns-version-negotia">Testing EDNS Version Negotiation with Unknown EDNS Flags</a>
          </h4>
<p id="section-8.2.5-1">
            Ask for the SOA record of the configured zone.  This
            query is made with no DNS flag bits set.  EDNS version
            1 is used without any EDNS options.  An unassigned EDNS
            flag bit is set (0x40 in this case).<a class="pilcrow" href="#section-8.2.5-1">¶</a></p>
<p id="section-8.2.5-2">
            We expect the SOA record for the zone to NOT be returned
            in the answer section with the extended rcode set to
            BADVERS and the QR bit to be set in the header; RA
            may also be set <span>[<a class="xref" href="#RFC1034">RFC1034</a>]</span>.  We expect
            an OPT record to be returned.  There should be no EDNS
            flags present in the response, as unknown EDNS flags are
            supposed to be ignored.  The EDNS version field should
            be 0, as EDNS versions other than 0 are yet to be
            specified, and there should be no EDNS options present
            <span>[<a class="xref" href="#RFC6891">RFC6891</a>]</span>.<a class="pilcrow" href="#section-8.2.5-2">¶</a></p>
<p class="keepWithNext" id="section-8.2.5-3">
                Check that EDNS version 1 queries with unknown flags work (EDNS supported):<a class="pilcrow" href="#section-8.2.5-3">¶</a></p>
<div id="section-8.2.5-4">
<pre class="sourcecode">dig +nocookie +edns=1 +noednsneg +noad +norec +ednsflags=0x40 soa \
    $zone @$server

expect: status: BADVERS
expect: SOA record to NOT be present
expect: an OPT record to be present in the additional section
expect: MBZ not to be present
expect: EDNS Version 0 in response
expect: flag: aa to NOT be present
expect: flag: ad to NOT be present
</pre><a class="pilcrow" href="#section-8.2.5-4">¶</a>
</div>
</section>
<section id="section-8.2.6">
          <h4 id="name-testing-edns-version-negotiat">
<a class="section-number selfRef" href="#section-8.2.6">8.2.6. </a><a class="section-name selfRef" href="#name-testing-edns-version-negotiat">Testing EDNS Version Negotiation with Unknown EDNS Options</a>
          </h4>
<p id="section-8.2.6-1">
            Ask for the SOA record of the configured zone.  This
            query is made with no DNS flag bits set.  EDNS version
            1 is used.  An unknown EDNS option is present.  We have
            picked an unassigned code of 100 for the example below.
            Any unassigned EDNS option code could have been chosen for
            this test.<a class="pilcrow" href="#section-8.2.6-1">¶</a></p>
<p id="section-8.2.6-2">
            We expect the SOA record for the zone to NOT be returned
            in the answer section with the extended rcode set to
            BADVERS and the QR bit to be set in the header; RA
            may also be set <span>[<a class="xref" href="#RFC1034">RFC1034</a>]</span>.  We expect
            an OPT record to be returned.  There should be no EDNS
            flags present in the response.  The EDNS version field
            should be 0, as EDNS versions other than 0 are yet
            to be specified, and there should be no EDNS options
            present <span>[<a class="xref" href="#RFC6891">RFC6891</a>]</span>.<a class="pilcrow" href="#section-8.2.6-2">¶</a></p>
<p class="keepWithNext" id="section-8.2.6-3">
                Check that EDNS version 1 queries with unknown options work (EDNS supported):<a class="pilcrow" href="#section-8.2.6-3">¶</a></p>
<div id="section-8.2.6-4">
<pre class="sourcecode">dig +nocookie +edns=1 +noednsneg +noad +norec +ednsopt=100 soa \
    $zone @$server

expect: status: BADVERS
expect: SOA record to NOT be present
expect: an OPT record to be present in the additional section
expect: OPT=100 to NOT be present
expect: EDNS Version 0 in response
expect: flag: aa to NOT be present
expect: flag: ad to NOT be present
</pre><a class="pilcrow" href="#section-8.2.6-4">¶</a>
</div>
</section>
<section id="section-8.2.7">
          <h4 id="name-testing-truncated-responses">
<a class="section-number selfRef" href="#section-8.2.7">8.2.7. </a><a class="section-name selfRef" href="#name-testing-truncated-responses">Testing Truncated Responses</a>
          </h4>
<p id="section-8.2.7-1">
            Ask for the DNSKEY records of the configured zone, which
            must be a DNSSEC signed zone.  This query is made with
            no DNS flag bits set.  EDNS version 0 is used without
            any EDNS options.  The only EDNS flag set is DO.  The
            EDNS UDP buffer size is set to 512.  The intention of
            this query is to elicit a truncated response from the
            server.  Most signed DNSKEY responses are bigger than
            512 bytes.  This test will not give a valid result if
            the zone is not signed.<a class="pilcrow" href="#section-8.2.7-1">¶</a></p>
<p id="section-8.2.7-2">We expect a response, the rcode to be set to NOERROR, and the AA
   and QR bits to be set. AD may be set in the response if the server
   supports DNSSEC; otherwise it should be clear; TC and RA may also be
   set <span>[<a class="xref" href="#RFC1035">RFC1035</a>]</span> <span>[<a class="xref" href="#RFC4035">RFC4035</a>]</span>.  We expect an OPT record to be present in the
   response.  There should be no EDNS flags other than DO present in
   the response.  The EDNS version field should be 0, and there should
   be no EDNS options present <span>[<a class="xref" href="#RFC6891">RFC6891</a>]</span>.<a class="pilcrow" href="#section-8.2.7-2">¶</a></p>
<p id="section-8.2.7-3">
            If TC is not set, it is not possible to confirm that the
            server correctly adds the OPT record to the truncated
            responses or not.<a class="pilcrow" href="#section-8.2.7-3">¶</a></p>
<div id="section-8.2.7-4">
<pre class="sourcecode">dig +norec +dnssec +bufsize=512 +ignore dnskey $zone @$server
expect: NOERROR
expect: OPT record with version set to 0
</pre><a class="pilcrow" href="#section-8.2.7-4">¶</a>
</div>
</section>
<section id="section-8.2.8">
          <h4 id="name-testing-do1-handling">
<a class="section-number selfRef" href="#section-8.2.8">8.2.8. </a><a class="section-name selfRef" href="#name-testing-do1-handling">Testing DO=1 Handling</a>
          </h4>
<p id="section-8.2.8-1">
            Ask for the SOA record of the configured zone, which
            does not need to be DNSSEC signed.  This query is made
            with no DNS flag bits set.  EDNS version 0 is used
            without any EDNS options.  The only EDNS flag set is
            DO.<a class="pilcrow" href="#section-8.2.8-1">¶</a></p>
<p id="section-8.2.8-2">We expect the SOA record for the zone to be returned in the
   answer section, the rcode to be set to NOERROR, and the AA and QR
   bits to be set in the response. AD may be set in the response if the
   server supports DNSSEC, otherwise it should be clear; RA may also be
   set <span>[<a class="xref" href="#RFC1034">RFC1034</a>]</span>.  We expect an OPT
   record to be returned.  There should be no EDNS flags other than DO
   present in the response, which should be present if the server
   supports DNSSEC.  The EDNS version field should be 0, and there
   should be no EDNS options present <span>[<a class="xref" href="#RFC6891">RFC6891</a>]</span>.<a class="pilcrow" href="#section-8.2.8-2">¶</a></p>
<p class="keepWithNext" id="section-8.2.8-3">
                Check that DO=1 queries work (EDNS supported):<a class="pilcrow" href="#section-8.2.8-3">¶</a></p>
<div id="section-8.2.8-4">
<pre class="sourcecode">dig +nocookie +edns=0 +noad +norec +dnssec soa $zone @$server

expect: status: NOERROR
expect: the SOA record to be present in the answer section
expect: an OPT record to be present in the additional section
expect: DO=1 to be present if an RRSIG is in the response
expect: EDNS Version 0 in response
expect: flag: aa to be present
</pre><a class="pilcrow" href="#section-8.2.8-4">¶</a>
</div>
</section>
<section id="section-8.2.9">
          <h4 id="name-testing-edns-version-negotiati">
<a class="section-number selfRef" href="#section-8.2.9">8.2.9. </a><a class="section-name selfRef" href="#name-testing-edns-version-negotiati">Testing EDNS Version Negotiation with DO=1</a>
          </h4>
<p id="section-8.2.9-1">
            Ask for the SOA record of the configured zone, which does
            not need to be DNSSEC signed.  This query is made with no
            DNS flag bits set.  EDNS version 1 is used without any EDNS
            options.  The only EDNS flag set is DO.<a class="pilcrow" href="#section-8.2.9-1">¶</a></p>
<p id="section-8.2.9-2">We expect the SOA record for the zone NOT to be returned in the answer
section, the extended rcode to be set to BADVERS, and the QR bit to be set in
the header; RA may also be set <span>[<a class="xref" href="#RFC1034">RFC1034</a>]</span>.  
   
   We expect an OPT record to be returned.  There
   should be no EDNS flags other than DO present in the response, which
   should be there if the server supports DNSSEC.  The EDNS version
   field should be 0, and there should be no EDNS options present <span>[<a class="xref" href="#RFC6891">RFC6891</a>]</span>.<a class="pilcrow" href="#section-8.2.9-2">¶</a></p>
<p class="keepWithNext" id="section-8.2.9-3">
                Check that EDNS version 1, DO=1 queries work (EDNS supported):<a class="pilcrow" href="#section-8.2.9-3">¶</a></p>
<div id="section-8.2.9-4">
<pre class="sourcecode">dig +nocookie +edns=1 +noednsneg +noad +norec +dnssec soa \
    $zone @$server

expect: status: BADVERS
expect: SOA record to NOT be present
expect: an OPT record to be present in the additional section
expect: DO=1 to be present if the EDNS version 0 DNSSEC query test
        returned DO=1
expect: EDNS Version 0 in response
expect: flag: aa to NOT be present
</pre><a class="pilcrow" href="#section-8.2.9-4">¶</a>
</div>
</section>
<section id="section-8.2.10">
          <h4 id="name-testing-with-multiple-defin">
<a class="section-number selfRef" href="#section-8.2.10">8.2.10. </a><a class="section-name selfRef" href="#name-testing-with-multiple-defin">Testing with Multiple Defined EDNS Options</a>
          </h4>
<p id="section-8.2.10-1">Ask for the SOA record of the configured zone.  This query is
   made with no DNS flag bits set.  EDNS version 0 is used.  A number
   of defined EDNS options are present (NSID <span>[<a class="xref" href="#RFC5001">RFC5001</a>]</span>, DNS COOKIE <span>[<a class="xref" href="#RFC7873">RFC7873</a>]</span>, EDNS Client Subnet <span>[<a class="xref" href="#RFC7871">RFC7871</a>]</span>, and EDNS Expire <span>[<a class="xref" href="#RFC7314">RFC7314</a>]</span>).<a class="pilcrow" href="#section-8.2.10-1">¶</a></p>
<p id="section-8.2.10-2">
            We expect the SOA record for the zone to be returned
            in the answer section, the rcode to be set to NOERROR, and
            the AA and QR bits to be set in the header; RA may
            also be set <span>[<a class="xref" href="#RFC1034">RFC1034</a>]</span>.  We expect an OPT
            record to be returned.  There should be no EDNS flags
            present in the response.  The EDNS version field should
            be 0.  Any of the requested EDNS options supported
            by the server and permitted server configuration may
            be returned <span>[<a class="xref" href="#RFC6891">RFC6891</a>]</span>.<a class="pilcrow" href="#section-8.2.10-2">¶</a></p>
<p class="keepWithNext" id="section-8.2.10-3">
                Check that EDNS queries with multiple defined EDNS options work:<a class="pilcrow" href="#section-8.2.10-3">¶</a></p>
<div id="section-8.2.10-4">
<pre class="sourcecode">dig +edns=0 +noad +norec +cookie +nsid +expire +subnet=0.0.0.0/0 \
    soa $zone @$server

expect: status: NOERROR
expect: the SOA record to be present in the answer section
expect: an OPT record to be present in the additional section
expect: EDNS Version 0 in response
expect: flag: aa to be present
expect: flag: ad to NOT be present
</pre><a class="pilcrow" href="#section-8.2.10-4">¶</a>
</div>
</section>
</section>
</div>
<section id="section-8.3">
        <h3 id="name-when-edns-is-not-supported">
<a class="section-number selfRef" href="#section-8.3">8.3. </a><a class="section-name selfRef" href="#name-when-edns-is-not-supported">When EDNS Is Not Supported</a>
        </h3>
<p id="section-8.3-1">
          If EDNS is not supported by the nameserver, we expect a
          response to each of the above queries.  That response may
          be a FORMERR error response, or the OPT record may just
          be ignored.<a class="pilcrow" href="#section-8.3-1">¶</a></p>
<p id="section-8.3-2">
          Some nameservers only return an EDNS response when a
          particular EDNS option or flag (e.g., DO=1) is present in
          the request. This behaviour is not compliant behaviour
          and may hide other incorrect behaviour from the above
          tests.  Retesting with the triggering option/flag
          present will expose this misbehaviour.<a class="pilcrow" href="#section-8.3-2">¶</a></p>
</section>
</section>
</div>
<div id="remediation">
<section id="section-9">
      <h2 id="name-remediation">
<a class="section-number selfRef" href="#section-9">9. </a><a class="section-name selfRef" href="#name-remediation">Remediation</a>
      </h2>
<p id="section-9-1">
        Nameserver operators are generally expected to test their
        own infrastructure for compliance to standards. The above
        tests should be run when new systems are brought online
        and should be repeated periodically to ensure continued
        interoperability.<a class="pilcrow" href="#section-9-1">¶</a></p>
<p id="section-9-2">
        Domain registrants who do not maintain their own DNS
        infrastructure are entitled to a DNS service that conforms
        to standards and interoperates well.  Registrants who become
        aware that their DNS operator does not have a well-maintained
        or compliant infrastructure should insist that their service
        provider correct issues and switch providers if they do
        not.<a class="pilcrow" href="#section-9-2">¶</a></p>
<p id="section-9-3">
        In the event that an operator experiences problems due to
        the behaviour of nameservers outside their control, the
        above tests will help in narrowing down the precise issue(s),
        which can then be reported to the relevant party.<a class="pilcrow" href="#section-9-3">¶</a></p>
<p id="section-9-4">
        If contact information for the operator of a misbehaving
        nameserver is not already known, the following methods of
        communication could be considered:<a class="pilcrow" href="#section-9-4">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9-5.1">
            the RNAME of the zone authoritative for the name of the
            misbehaving server<a class="pilcrow" href="#section-9-5.1">¶</a>
</li>
        <li class="normal" id="section-9-5.2">
            the RNAME of zones for which the offending server is
            authoritative<a class="pilcrow" href="#section-9-5.2">¶</a>
</li>
        <li class="normal" id="section-9-5.3">
            administrative or technical contacts listed in the
            registration information for the parent domain of the
            name of the misbehaving server or for zones for which
            the nameserver is authoritative<a class="pilcrow" href="#section-9-5.3">¶</a>
</li>
        <li class="normal" id="section-9-5.4">
            the registrar or registry for such zones<a class="pilcrow" href="#section-9-5.4">¶</a>
</li>
        <li class="normal" id="section-9-5.5">
            DNS-specific, operational fora (e.g., mailing lists)<a class="pilcrow" href="#section-9-5.5">¶</a>
</li>
      </ul>
<p id="section-9-6">
        Operators of parent zones may wish to regularly test the
        authoritative nameservers of their child zones.  However,
        parent operators can have widely varying capabilities in
        terms of notification or remediation depending on whether
        they have a direct relationship with the child operator.
        Many Top-Level Domain (TLD) registries, for example, cannot directly contact
        their registrants and may instead need to communicate through
        the relevant registrar.  In such cases, it may be most
        efficient for registrars to take on the responsibility for
        testing the nameservers of their registrants, since they
        have a direct relationship.<a class="pilcrow" href="#section-9-6">¶</a></p>
<p id="section-9-7">
        When notification is not effective at correcting problems
        with a misbehaving nameserver, parent operators can choose
        to remove NS record sets (and glue records below) that refer
        to the faulty server until the servers are fixed.  This should
        only be done as a last resort and with due consideration, as
        removal of a delegation can have unanticipated side effects.
        For example, other parts of the DNS tree may depend on names
        below the removed zone cut, and the parent operator may find
        themselves responsible for causing new DNS failures to occur.<a class="pilcrow" href="#section-9-7">¶</a></p>
</section>
</div>
<div id="seccon">
<section id="section-10">
      <h2 id="name-security-considerations">
<a class="section-number selfRef" href="#section-10">10. </a><a class="section-name selfRef" href="#name-security-considerations">Security Considerations</a>
      </h2>
<p id="section-10-1">
        Testing protocol compliance can potentially result in false
        reports of attempts to attack services from Intrusion Detection
        Services and firewalls.  All of the tests are well-formed
        (though not necessarily common) DNS queries.  None of the tests
        listed above should cause any harm to a protocol-compliant
        server.<a class="pilcrow" href="#section-10-1">¶</a></p>
<p id="section-10-2">
        Relaxing firewall settings to ensure EDNS compliance could
        potentially expose a critical implementation flaw in the
        nameserver.  Nameservers should be tested for conformance
        before relaxing firewall settings.<a class="pilcrow" href="#section-10-2">¶</a></p>
<p id="section-10-3">
        When removing delegations for non-compliant servers, there
        can be a knock-on effect on other zones that require these
        zones to be operational for the nameservers addresses to be
        resolved.<a class="pilcrow" href="#section-10-3">¶</a></p>
</section>
</div>
<div id="iana">
<section id="section-11">
      <h2 id="name-iana-considerations">
<a class="section-number selfRef" href="#section-11">11. </a><a class="section-name selfRef" href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<p id="section-11-1">This document has no IANA actions.<a class="pilcrow" href="#section-11-1">¶</a></p>
</section>
</div>
<section id="section-12">
      <h2 id="name-references">
<a class="section-number selfRef" href="#section-12">12. </a><a class="section-name selfRef" href="#name-references">References</a>
      </h2>
<section id="section-12.1">
        <h3 id="name-normative-references">
<a class="section-number selfRef" href="#section-12.1">12.1. </a><a class="section-name selfRef" href="#name-normative-references">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC1034">[RFC1034]</dt>
        <dd>
<span class="refAuthor">Mockapetris, P.</span>, <span class="refTitle">"Domain names - concepts and facilities"</span>, <span class="seriesInfo">STD 13</span>, <span class="seriesInfo">RFC 1034</span>, <span class="seriesInfo">DOI 10.17487/RFC1034</span>, <time class="refDate" datetime="1987-11">November 1987</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1034">https://www.rfc-editor.org/info/rfc1034</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1035">[RFC1035]</dt>
        <dd>
<span class="refAuthor">Mockapetris, P.</span>, <span class="refTitle">"Domain names - implementation and specification"</span>, <span class="seriesInfo">STD 13</span>, <span class="seriesInfo">RFC 1035</span>, <span class="seriesInfo">DOI 10.17487/RFC1035</span>, <time class="refDate" datetime="1987-11">November 1987</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1035">https://www.rfc-editor.org/info/rfc1035</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3225">[RFC3225]</dt>
        <dd>
<span class="refAuthor">Conrad, D.</span>, <span class="refTitle">"Indicating Resolver Support of DNSSEC"</span>, <span class="seriesInfo">RFC 3225</span>, <span class="seriesInfo">DOI 10.17487/RFC3225</span>, <time class="refDate" datetime="2001-12">December 2001</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3225">https://www.rfc-editor.org/info/rfc3225</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4035">[RFC4035]</dt>
        <dd>
<span class="refAuthor">Arends, R.</span><span class="refAuthor">, Austein, R.</span><span class="refAuthor">, Larson, M.</span><span class="refAuthor">, Massey, D.</span><span class="refAuthor">, and S. Rose</span>, <span class="refTitle">"Protocol Modifications for the DNS Security Extensions"</span>, <span class="seriesInfo">RFC 4035</span>, <span class="seriesInfo">DOI 10.17487/RFC4035</span>, <time class="refDate" datetime="2005-03">March 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4035">https://www.rfc-editor.org/info/rfc4035</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6840">[RFC6840]</dt>
        <dd>
<span class="refAuthor">Weiler, S., Ed.</span><span class="refAuthor"> and D. Blacka, Ed.</span>, <span class="refTitle">"Clarifications and Implementation Notes for DNS Security (DNSSEC)"</span>, <span class="seriesInfo">RFC 6840</span>, <span class="seriesInfo">DOI 10.17487/RFC6840</span>, <time class="refDate" datetime="2013-02">February 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6840">https://www.rfc-editor.org/info/rfc6840</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6891">[RFC6891]</dt>
        <dd>
<span class="refAuthor">Damas, J.</span><span class="refAuthor">, Graff, M.</span><span class="refAuthor">, and P. Vixie</span>, <span class="refTitle">"Extension Mechanisms for DNS (EDNS(0))"</span>, <span class="seriesInfo">STD 75</span>, <span class="seriesInfo">RFC 6891</span>, <span class="seriesInfo">DOI 10.17487/RFC6891</span>, <time class="refDate" datetime="2013-04">April 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6891">https://www.rfc-editor.org/info/rfc6891</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6895">[RFC6895]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span>, <span class="refTitle">"Domain Name System (DNS) IANA Considerations"</span>, <span class="seriesInfo">BCP 42</span>, <span class="seriesInfo">RFC 6895</span>, <span class="seriesInfo">DOI 10.17487/RFC6895</span>, <time class="refDate" datetime="2013-04">April 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6895">https://www.rfc-editor.org/info/rfc6895</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7766">[RFC7766]</dt>
      <dd>
<span class="refAuthor">Dickinson, J.</span><span class="refAuthor">, Dickinson, S.</span><span class="refAuthor">, Bellis, R.</span><span class="refAuthor">, Mankin, A.</span><span class="refAuthor">, and D. Wessels</span>, <span class="refTitle">"DNS Transport over TCP - Implementation Requirements"</span>, <span class="seriesInfo">RFC 7766</span>, <span class="seriesInfo">DOI 10.17487/RFC7766</span>, <time class="refDate" datetime="2016-03">March 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7766">https://www.rfc-editor.org/info/rfc7766</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-12.2">
        <h3 id="name-informative-references">
<a class="section-number selfRef" href="#section-12.2">12.2. </a><a class="section-name selfRef" href="#name-informative-references">Informative References</a>
        </h3>
<dl class="references">
<dt id="IANA-DNS">[IANA-DNS]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Domain Name System (DNS) Parameters"</span>, <span>&lt;<a href="https://www.iana.org/assignments/dns-parameters/">https://www.iana.org/assignments/dns-parameters/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ISC">[ISC]</dt>
        <dd>
<span class="refTitle">"Internet Systems Consortuim"</span>, <span>&lt;<a href="https://www.isc.org/">https://www.isc.org/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2671">[RFC2671]</dt>
        <dd>
<span class="refAuthor">Vixie, P.</span>, <span class="refTitle">"Extension Mechanisms for DNS (EDNS0)"</span>, <span class="seriesInfo">RFC 2671</span>, <span class="seriesInfo">DOI 10.17487/RFC2671</span>, <time class="refDate" datetime="1999-08">August 1999</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2671">https://www.rfc-editor.org/info/rfc2671</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3597">[RFC3597]</dt>
        <dd>
<span class="refAuthor">Gustafsson, A.</span>, <span class="refTitle">"Handling of Unknown DNS Resource Record (RR) Types"</span>, <span class="seriesInfo">RFC 3597</span>, <span class="seriesInfo">DOI 10.17487/RFC3597</span>, <time class="refDate" datetime="2003-09">September 2003</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3597">https://www.rfc-editor.org/info/rfc3597</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5001">[RFC5001]</dt>
        <dd>
<span class="refAuthor">Austein, R.</span>, <span class="refTitle">"DNS Name Server Identifier (NSID) Option"</span>, <span class="seriesInfo">RFC 5001</span>, <span class="seriesInfo">DOI 10.17487/RFC5001</span>, <time class="refDate" datetime="2007-08">August 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5001">https://www.rfc-editor.org/info/rfc5001</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7314">[RFC7314]</dt>
        <dd>
<span class="refAuthor">Andrews, M.</span>, <span class="refTitle">"Extension Mechanisms for DNS (EDNS) EXPIRE Option"</span>, <span class="seriesInfo">RFC 7314</span>, <span class="seriesInfo">DOI 10.17487/RFC7314</span>, <time class="refDate" datetime="2014-07">July 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7314">https://www.rfc-editor.org/info/rfc7314</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7871">[RFC7871]</dt>
        <dd>
<span class="refAuthor">Contavalli, C.</span><span class="refAuthor">, van der Gaast, W.</span><span class="refAuthor">, Lawrence, D.</span><span class="refAuthor">, and W. Kumari</span>, <span class="refTitle">"Client Subnet in DNS Queries"</span>, <span class="seriesInfo">RFC 7871</span>, <span class="seriesInfo">DOI 10.17487/RFC7871</span>, <time class="refDate" datetime="2016-05">May 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7871">https://www.rfc-editor.org/info/rfc7871</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7873">[RFC7873]</dt>
      <dd>
<span class="refAuthor">Eastlake 3rd, D.</span><span class="refAuthor"> and M. Andrews</span>, <span class="refTitle">"Domain Name System (DNS) Cookies"</span>, <span class="seriesInfo">RFC 7873</span>, <span class="seriesInfo">DOI 10.17487/RFC7873</span>, <time class="refDate" datetime="2016-05">May 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7873">https://www.rfc-editor.org/info/rfc7873</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<section id="section-appendix.a">
      <h2 id="name-acknowledgements">
<a class="section-name selfRef" href="#name-acknowledgements">Acknowledgements</a>
      </h2>
<p id="section-appendix.a-1">The contributions of <span class="contact-name">Matthew Pounsett</span> and
      <span class="contact-name">Tim Wicinski</span> are gratefully acknowledged.<a class="pilcrow" href="#section-appendix.a-1">¶</a></p>
</section>
<div id="authors-addresses">
<section id="section-appendix.b">
      <h2 id="name-authors-addresses">
<a class="section-name selfRef" href="#name-authors-addresses">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">M. Andrews</span></div>
<div class="left" dir="auto"><span class="org">Internet Systems Consortium</span></div>
<div class="left" dir="auto"><span class="street-address">PO Box 360</span></div>
<div class="left" dir="auto">
<span class="locality">Newmarket</span>, <span class="region">NH</span> <span class="postal-code">03857</span>
</div>
<div class="left" dir="auto"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:marka@isc.org">marka@isc.org</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Ray Bellis</span></div>
<div class="left" dir="auto"><span class="org">Internet Systems Consortium</span></div>
<div class="left" dir="auto"><span class="street-address">PO Box 360</span></div>
<div class="left" dir="auto">
<span class="locality">Newmarket</span>, <span class="region">NH</span> <span class="postal-code">03857</span>
</div>
<div class="left" dir="auto"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:ray@isc.org">ray@isc.org</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>


</body></html>