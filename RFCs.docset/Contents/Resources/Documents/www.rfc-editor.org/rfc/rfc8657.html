<!DOCTYPE html>
<html class="RFC" lang="en"><head>
<meta charset="utf-8"/>
<meta content="Common,Latin" name="scripts"/>
<meta content="initial-scale=1.0" name="viewport"/>
<title>RFC 8657: Certification Authority Authorization (CAA) Record Extensions for Account URI and Automatic Certificate Management Environment (ACME) Method Binding</title>
<meta content="Hugo Landau" name="author"/>
<meta content="
       The Certification Authority Authorization (CAA) DNS record allows a domain to
communicate an issuance policy to Certification Authorities (CAs) but only allows
a domain to define a policy with CA-level granularity. However, the CAA
specification (RFC 8659) also provides facilities for an extension to admit a
more granular, CA-specific policy. This specification defines two such
parameters: one allowing specific accounts of a CA to be identified by URIs
and one allowing specific methods of domain control validation as defined by
the Automatic Certificate Management Environment (ACME) protocol to be
required. 
    " name="description"/>
<meta content="xml2rfc 2.35.0" name="generator"/>
<meta content="8657" name="rfc.number"/>
<link href="rfc8657.xml" rel="alternate" type="application/rfc+xml"/>
<link href="#copyright" rel="license"/>
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Avoid wrapping of URLs in references */
@media screen {
  .references a {
    white-space: nowrap;
  }
}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin: 0 0 0.25em 0;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .sourcecode {
    margin-bottom: 1em;
  }
}</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css"/>
<link href="https://dx.doi.org/10.17487/rfc8657" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <link href="https://datatracker.ietf.org/doc/draft-ietf-acme-caa-10" rel="prev"/>
  </head>
<body>
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 8657</td>
<td class="center">ACME-CAA</td>
<td class="right">November 2019</td>
</tr></thead>
<tfoot><tr>
<td class="left">Landau</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div class="document-information" id="external-metadata"></div>
<div class="document-information" id="internal-metadata">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a class="eref" href="https://www.rfc-editor.org/rfc/rfc8657">8657</a></dd>
<dt class="label-category">Category:</dt>
<dd class="category">Standards Track</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time class="published" datetime="2019-11">November 2019</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">H. Landau</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 8657</h1>
<h1 id="title">Certification Authority Authorization (CAA) Record Extensions for Account URI and Automatic Certificate Management Environment (ACME) Method Binding</h1>
<section id="section-abstract">
      <h2 id="abstract"><a class="selfRef" href="#abstract">Abstract</a></h2>
<p id="section-abstract-1">The Certification Authority Authorization (CAA) DNS record allows a domain to
communicate an issuance policy to Certification Authorities (CAs) but only allows
a domain to define a policy with CA-level granularity. However, the CAA
specification (RFC 8659) also provides facilities for an extension to admit a
more granular, CA-specific policy. This specification defines two such
parameters: one allowing specific accounts of a CA to be identified by URIs
and one allowing specific methods of domain control validation as defined by
the Automatic Certificate Management Environment (ACME) protocol to be
required.<a class="pilcrow" href="#section-abstract-1">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a class="section-name selfRef" href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This is an Internet Standards Track document.<a class="pilcrow" href="#section-boilerplate.1-1">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.<a class="pilcrow" href="#section-boilerplate.1-2">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc8657">https://www.rfc-editor.org/info/rfc8657</a></span>.<a class="pilcrow" href="#section-boilerplate.1-3">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a class="section-name selfRef" href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2019 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a class="pilcrow" href="#section-boilerplate.2-1">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a class="pilcrow" href="#section-boilerplate.2-2">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a class="toplink" href="#" onclick="scroll(0,0)">▲</a><h2 id="name-table-of-contents">
<a class="section-name selfRef" href="#name-table-of-contents">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a class="xref" href="#section-1">1</a>.  <a class="xref" href="#name-introduction">Introduction</a><a class="pilcrow" href="#section-toc.1-1.1.1">¶</a></p>
</li>
          <li class="toc ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a class="xref" href="#section-2">2</a>.  <a class="xref" href="#name-terminology">Terminology</a><a class="pilcrow" href="#section-toc.1-1.2.1">¶</a></p>
</li>
          <li class="toc ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a class="xref" href="#section-3">3</a>.  <a class="xref" href="#name-extensions-to-the-caa-recor">Extensions to the CAA Record: The "accounturi" Parameter</a><a class="pilcrow" href="#section-toc.1-1.3.1">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a class="xref" href="#section-3.1">3.1</a>.  <a class="xref" href="#name-use-with-acme">Use with ACME</a><a class="pilcrow" href="#section-toc.1-1.3.2.1.1">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a class="xref" href="#section-3.2">3.2</a>.  <a class="xref" href="#name-use-without-acme">Use without ACME</a><a class="pilcrow" href="#section-toc.1-1.3.2.2.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a class="xref" href="#section-4">4</a>.  <a class="xref" href="#name-extensions-to-the-caa-record">Extensions to the CAA Record: The "validationmethods" Parameter</a><a class="pilcrow" href="#section-toc.1-1.4.1">¶</a></p>
</li>
          <li class="toc ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a class="xref" href="#section-5">5</a>.  <a class="xref" href="#name-security-considerations">Security Considerations</a><a class="pilcrow" href="#section-toc.1-1.5.1">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a class="xref" href="#section-5.1">5.1</a>.  <a class="xref" href="#name-limited-to-cas-processing-c">Limited to CAs Processing CAA Records</a><a class="pilcrow" href="#section-toc.1-1.5.2.1.1">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a class="xref" href="#section-5.2">5.2</a>.  <a class="xref" href="#name-restrictions-ineffective-wi">Restrictions Ineffective without CA Recognition</a><a class="pilcrow" href="#section-toc.1-1.5.2.2.1">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a class="xref" href="#section-5.3">5.3</a>.  <a class="xref" href="#name-mandatory-consistency-in-ca">Mandatory Consistency in CA Recognition</a><a class="pilcrow" href="#section-toc.1-1.5.2.3.1">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a class="xref" href="#section-5.4">5.4</a>.  <a class="xref" href="#name-uri-ambiguity">URI Ambiguity</a><a class="pilcrow" href="#section-toc.1-1.5.2.4.1">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-toc.1-1.5.2.5">
                <p id="section-toc.1-1.5.2.5.1"><a class="xref" href="#section-5.5">5.5</a>.  <a class="xref" href="#name-authorization-freshness">Authorization Freshness</a><a class="pilcrow" href="#section-toc.1-1.5.2.5.1">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-toc.1-1.5.2.6">
                <p id="section-toc.1-1.5.2.6.1"><a class="xref" href="#section-5.6">5.6</a>.  <a class="xref" href="#name-use-with-and-without-dnssec">Use with and without DNSSEC</a><a class="pilcrow" href="#section-toc.1-1.5.2.6.1">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-toc.1-1.5.2.7">
                <p id="section-toc.1-1.5.2.7.1"><a class="xref" href="#section-5.7">5.7</a>.  <a class="xref" href="#name-restrictions-supersedable-b">Restrictions Supersedable by DNS Delegation</a><a class="pilcrow" href="#section-toc.1-1.5.2.7.1">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-toc.1-1.5.2.8">
                <p id="section-toc.1-1.5.2.8.1"><a class="xref" href="#section-5.8">5.8</a>.  <a class="xref" href="#name-misconfiguration-hazards">Misconfiguration Hazards</a><a class="pilcrow" href="#section-toc.1-1.5.2.8.1">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-toc.1-1.5.2.9">
                <p id="section-toc.1-1.5.2.9.1"><a class="xref" href="#section-5.9">5.9</a>.  <a class="xref" href="#name-revelation-of-account-uris">Revelation of Account URIs</a><a class="pilcrow" href="#section-toc.1-1.5.2.9.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a class="xref" href="#section-6">6</a>.  <a class="xref" href="#name-iana-considerations">IANA Considerations</a><a class="pilcrow" href="#section-toc.1-1.6.1">¶</a></p>
</li>
          <li class="toc ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a class="xref" href="#section-7">7</a>.  <a class="xref" href="#name-normative-references">Normative References</a><a class="pilcrow" href="#section-toc.1-1.7.1">¶</a></p>
</li>
          <li class="toc ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a class="xref" href="#section-appendix.a">Appendix A</a>.  <a class="xref" href="#name-examples">Examples</a><a class="pilcrow" href="#section-toc.1-1.8.1">¶</a></p>
</li>
          <li class="toc ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a class="xref" href="#section-appendix.b"></a><a class="xref" href="#name-authors-address">Author's Address</a><a class="pilcrow" href="#section-toc.1-1.9.1">¶</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a class="section-number selfRef" href="#section-1">1. </a><a class="section-name selfRef" href="#name-introduction">Introduction</a>
      </h2>
<p id="section-1-1">This specification defines two parameters for the "issue" and "issuewild"
Properties of the Certification Authority Authorization (CAA) DNS resource
record <span>[<a class="xref" href="#RFC8659">RFC8659</a>]</span>. The first, "accounturi", allows
authorization conferred by a CAA policy to be restricted to specific accounts
of a Certification Authority (CA), which are identified by URIs. The second, "validationmethods", allows
the set of validation methods supported by a CA to validate domain control to
be limited to a subset of the full set of methods that it supports.<a class="pilcrow" href="#section-1-1">¶</a></p>
</section>
</div>
<div id="terminology">
<section id="section-2">
      <h2 id="name-terminology">
<a class="section-number selfRef" href="#section-2">2. </a><a class="section-name selfRef" href="#name-terminology">Terminology</a>
      </h2>
<p id="section-2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>",
"<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>",
"<span class="bcp14">NOT RECOMMENDED</span>", "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document
are to be interpreted as described in BCP 14
<span>[<a class="xref" href="#RFC2119">RFC2119</a>]</span> <span>[<a class="xref" href="#RFC8174">RFC8174</a>]</span> when,
and only when, they appear in all capitals, as shown here.<a class="pilcrow" href="#section-2-1">¶</a></p>
</section>
</div>
<div id="extensions-to-the-caa-record-accounturi-parameter">
<section id="section-3">
      <h2 id="name-extensions-to-the-caa-recor">
<a class="section-number selfRef" href="#section-3">3. </a><a class="section-name selfRef" href="#name-extensions-to-the-caa-recor">Extensions to the CAA Record: The "accounturi" Parameter</a>
      </h2>
<p id="section-3-1">This document defines the "accounturi" CAA parameter for the "issue" and
"issuewild" Properties defined by <span>[<a class="xref" href="#RFC8659">RFC8659</a>]</span>. The value of this
parameter, if specified, <span class="bcp14">MUST</span> be a URI <span>[<a class="xref" href="#RFC3986">RFC3986</a>]</span> identifying a
specific CA account.<a class="pilcrow" href="#section-3-1">¶</a></p>
<p id="section-3-2">"CA account" means an object that is maintained by a specific CA, that may request
the issuance of certificates, and that represents a specific entity or group of
related entities.<a class="pilcrow" href="#section-3-2">¶</a></p>
<p id="section-3-3">The presence of this parameter constrains the Property to which it is attached.
Where a CAA Property has an "accounturi" parameter, a CA <span class="bcp14">MUST</span> only consider
that Property to authorize issuance in the context of a given certificate
issuance request if the CA recognizes the URI specified in the value portion of
that parameter as identifying the account making that request.<a class="pilcrow" href="#section-3-3">¶</a></p>
<p id="section-3-4">A Property without an "accounturi" parameter matches any account. A Property
with an invalid or unrecognized "accounturi" parameter is unsatisfiable. A
Property with multiple "accounturi" parameters is unsatisfiable.<a class="pilcrow" href="#section-3-4">¶</a></p>
<p id="section-3-5">The presence of an "accounturi" parameter does not replace or supersede the
need to validate the domain name specified in an "issue" or "issuewild" record
in the manner described in the CAA
   specification <span>[<a class="xref" href="#RFC8659">RFC8659</a>]</span>. CAs <span class="bcp14">MUST</span> still perform such
validation. For example, a CAA "issue" Property that specifies a domain name
belonging to CA A and an "accounturi" parameter identifying an account at CA B
is unsatisfiable.<a class="pilcrow" href="#section-3-5">¶</a></p>
<div id="use-with-acme">
<section id="section-3.1">
        <h3 id="name-use-with-acme">
<a class="section-number selfRef" href="#section-3.1">3.1. </a><a class="section-name selfRef" href="#name-use-with-acme">Use with ACME</a>
        </h3>
<p id="section-3.1-1">An Automatic Certificate Management Environment (ACME) <span>[<a class="xref" href="#RFC8555">RFC8555</a>]</span> account object <span class="bcp14">MAY</span> be identified by setting the
"accounturi" parameter to the URI of the ACME account object.<a class="pilcrow" href="#section-3.1-1">¶</a></p>
<p id="section-3.1-2">Implementations of this specification that also implement ACME <span class="bcp14">MUST</span> recognize
such URIs.<a class="pilcrow" href="#section-3.1-2">¶</a></p>
</section>
</div>
<div id="use-without-acme">
<section id="section-3.2">
        <h3 id="name-use-without-acme">
<a class="section-number selfRef" href="#section-3.2">3.2. </a><a class="section-name selfRef" href="#name-use-without-acme">Use without ACME</a>
        </h3>
<p id="section-3.2-1">The "accounturi" specification provides a general mechanism to identify
entities that may request certificate issuance via URIs. The use of specific
kinds of URIs may be specified in future RFCs, and CAs not implementing ACME <span class="bcp14">MAY</span>
assign and recognize their own URIs arbitrarily.<a class="pilcrow" href="#section-3.2-1">¶</a></p>
</section>
</div>
</section>
</div>
<div id="extensions-to-the-caa-record-validationmethods-parameter">
<section id="section-4">
      <h2 id="name-extensions-to-the-caa-record">
<a class="section-number selfRef" href="#section-4">4. </a><a class="section-name selfRef" href="#name-extensions-to-the-caa-record">Extensions to the CAA Record: The "validationmethods" Parameter</a>
      </h2>
<p id="section-4-1">This document also defines the "validationmethods" CAA parameter for the "issue" and
"issuewild" Properties. The value of this parameter, if specified, <span class="bcp14">MUST</span> be a
comma-separated string of zero or more validation method labels.<a class="pilcrow" href="#section-4-1">¶</a></p>
<p id="section-4-2">A validation method label identifies a validation method. A validation method
is a particular way in which a CA can validate control over a domain.<a class="pilcrow" href="#section-4-2">¶</a></p>
<p id="section-4-3">The presence of this parameter constrains the Property to which it is attached.
A CA <span class="bcp14">MUST</span> only consider a Property with the "validationmethods" parameter to
authorize issuance where the validation method being used is identified by one
of the validation method labels listed in the comma-separated list.<a class="pilcrow" href="#section-4-3">¶</a></p>
<p id="section-4-4">Each validation method label <span class="bcp14">MUST</span> be either the label of a method defined in
the "ACME Validation Methods" IANA registry
<span>[<a class="xref" href="#RFC8555">RFC8555</a>]</span> or a CA‑specific non-ACME validation
method label as defined below.<a class="pilcrow" href="#section-4-4">¶</a></p>
<p id="section-4-5">Where a CA supports both the "validationmethods" parameter and one or more
non-ACME validation methods, it <span class="bcp14">MUST</span> assign labels to those methods. If
appropriate non-ACME labels are not present in the "ACME Validation Methods" IANA
registry, the CA <span class="bcp14">MUST</span> use labels beginning with the string "ca-", which are
defined to have CA-specific meaning.<a class="pilcrow" href="#section-4-5">¶</a></p>
<p id="section-4-6">The value of the "validationmethods" parameter <span class="bcp14">MUST</span> comply with the following
ABNF <span>[<a class="xref" href="#RFC5234">RFC5234</a>]</span>:<a class="pilcrow" href="#section-4-6">¶</a></p>
<div id="section-4-7">
<pre class="sourcecode lang-abnf">   value = [*(label ",") label]
   label = 1*(ALPHA / DIGIT / "-") </pre><a class="pilcrow" href="#section-4-7">¶</a>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-5">
      <h2 id="name-security-considerations">
<a class="section-number selfRef" href="#section-5">5. </a><a class="section-name selfRef" href="#name-security-considerations">Security Considerations</a>
      </h2>
<p id="section-5-1">This specification describes an extension to the CAA record specification,
increasing the granularity at which a CAA policy can be expressed. This allows
the set of entities capable of successfully requesting issuance of certificates
for a given domain to be restricted beyond the set of entities would otherwise
be possible, while still allowing issuance for specific accounts of a CA. This
improves the security of issuance for domains that choose to employ it, when
combined with a CA that implements this specification.<a class="pilcrow" href="#section-5-1">¶</a></p>
<div id="limited-to-cas-processing-caa-records">
<section id="section-5.1">
        <h3 id="name-limited-to-cas-processing-c">
<a class="section-number selfRef" href="#section-5.1">5.1. </a><a class="section-name selfRef" href="#name-limited-to-cas-processing-c">Limited to CAs Processing CAA Records</a>
        </h3>
<p id="section-5.1-1">All of the security considerations listed in <span>[<a class="xref" href="#RFC8659">RFC8659</a>]</span> are inherited by
this document. This specification merely enables a domain with an existing
relationship with a CA to further constrain that CA in its issuance practices,
where that CA implements this specification. In particular, it provides no
additional security above that provided by using the unextended CAA
specification alone as concerns matters relating to any other CA. The capacity
of any other CA to issue certificates for the given domain is completely
unchanged.<a class="pilcrow" href="#section-5.1-1">¶</a></p>
<p id="section-5.1-2">As such, a domain that, via CAA records, authorizes only CAs adopting this
specification and that constrains its policy by means of this specification,
remains vulnerable to unauthorized issuance by CAs that do not honor CAA
records or that honor them only on an advisory basis. Where a domain uses
DNSSEC, it also remains vulnerable to CAs that honor CAA records but that do
not validate CAA records by means of a trusted DNSSEC-validating resolver.<a class="pilcrow" href="#section-5.1-2">¶</a></p>
</section>
</div>
<div id="restrictions-ineffective-without-ca-recognition">
<section id="section-5.2">
        <h3 id="name-restrictions-ineffective-wi">
<a class="section-number selfRef" href="#section-5.2">5.2. </a><a class="section-name selfRef" href="#name-restrictions-ineffective-wi">Restrictions Ineffective without CA Recognition</a>
        </h3>
<p id="section-5.2-1">Because the parameters of "issue" or "issuewild" CAA Properties constitute a
CA-specific namespace, the CA identified by an "issue" or "issuewild" Property
decides what parameters to recognize and their semantics. Accordingly, the CAA
parameters defined in this specification rely on their being recognized by the
CA named by an "issue" or "issuewild" CAA Property and are not an effective
means of control over issuance unless a CA's support for the parameters is
established beforehand.<a class="pilcrow" href="#section-5.2-1">¶</a></p>
<p id="section-5.2-2">CAs that implement this specification <span class="bcp14">SHOULD</span> make available documentation
indicating as such, including explicit statements as to which parameters are
supported. Domains configuring CAA records for a CA <span class="bcp14">MUST NOT</span> assume that the
restrictions implied by the "accounturi" and "validationmethods" parameters are
effective in the absence of explicit indication as such from that CA.<a class="pilcrow" href="#section-5.2-2">¶</a></p>
<p id="section-5.2-3">CAs <span class="bcp14">SHOULD</span> also document whether they implement DNSSEC validation for DNS
lookups done for validation purposes, as this affects the security of the
"accounturi" and "validationmethods" parameters.<a class="pilcrow" href="#section-5.2-3">¶</a></p>
</section>
</div>
<div id="mandatory-consistency-in-ca-recognition">
<section id="section-5.3">
        <h3 id="name-mandatory-consistency-in-ca">
<a class="section-number selfRef" href="#section-5.3">5.3. </a><a class="section-name selfRef" href="#name-mandatory-consistency-in-ca">Mandatory Consistency in CA Recognition</a>
        </h3>
<p id="section-5.3-1">A CA <span class="bcp14">MUST</span> ensure that its support for the "accounturi" and "validationmethods"
parameters is fully consistent for a given domain name that a CA recognizes as
identifying itself in a CAA "issue" or "issuewild" Property. If a CA has
multiple issuance systems (for example, an ACME-based issuance system and a
non-ACME-based issuance system, or two different issuance systems resulting
from a corporate merger), it <span class="bcp14">MUST</span> ensure that all issuance systems recognize
the same parameters.<a class="pilcrow" href="#section-5.3-1">¶</a></p>
<p id="section-5.3-2">A CA that is unable to do this <span class="bcp14">MAY</span> still implement the parameters by splitting
the CA into two domain names for the purposes of CAA processing. For example, a
CA "example.com" with an ACME-based issuance system and a non-ACME-based
issuance system could recognize only "acme.example.com" for the former and
"example.com" for the latter, and then implement support for the "accounturi"
and "validationmethods" parameters for "acme.example.com" only.<a class="pilcrow" href="#section-5.3-2">¶</a></p>
<p id="section-5.3-3">A CA that is unable to ensure consistent processing of the "accounturi"
parameter or the 
"validationmethods" parameter for a given CA domain name as specifiable in CAA
"issue" or "issuewild" Properties <span class="bcp14">MUST NOT</span> implement support for these
parameters. Failure to do so would result in an implementation of these
parameters that does not provide effective security.<a class="pilcrow" href="#section-5.3-3">¶</a></p>
</section>
</div>
<div id="uri-ambiguity">
<section id="section-5.4">
        <h3 id="name-uri-ambiguity">
<a class="section-number selfRef" href="#section-5.4">5.4. </a><a class="section-name selfRef" href="#name-uri-ambiguity">URI Ambiguity</a>
        </h3>
<p id="section-5.4-1">Suppose that CA A recognizes "a.example.com" as identifying itself and
CA B is a subsidiary of CA A that recognizes both "a.example.com" and "b.example.com" as
identifying itself.<a class="pilcrow" href="#section-5.4-1">¶</a></p>
<p id="section-5.4-2">Suppose that both CA A and CA B issue account URIs of the form:<a class="pilcrow" href="#section-5.4-2">¶</a></p>
<div class="artwork art-text alignLeft" id="section-5.4-3">
<pre>   "urn:example:account-id:1234" </pre><a class="pilcrow" href="#section-5.4-3">¶</a>
</div>
<p id="section-5.4-4">If the CA domain name in a CAA record is specified as "a.example.com", then this
could be construed as identifying account number 1234 at CA A or at CA B. These
may be different accounts, creating ambiguity.<a class="pilcrow" href="#section-5.4-4">¶</a></p>
<p id="section-5.4-5">Thus, CAs <span class="bcp14">MUST</span> ensure that the URIs they recognize as pertaining to a specific
account of that CA are unique within the scope of all domain names that they
recognize as identifying that CA for the purpose of CAA record validation.<a class="pilcrow" href="#section-5.4-5">¶</a></p>
<p id="section-5.4-6">CAs <span class="bcp14">SHOULD</span> satisfy this requirement by using URIs that include an authority
(see <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc3986#section-3.2">Section 3.2</a> of [<a class="xref" href="#RFC3986">RFC3986</a>]</span>):<a class="pilcrow" href="#section-5.4-6">¶</a></p>
<div class="artwork art-text alignLeft" id="section-5.4-7">
<pre>   "https://a.example.com/account/1234" </pre><a class="pilcrow" href="#section-5.4-7">¶</a>
</div>
</section>
</div>
<div id="authorization-freshness">
<section id="section-5.5">
        <h3 id="name-authorization-freshness">
<a class="section-number selfRef" href="#section-5.5">5.5. </a><a class="section-name selfRef" href="#name-authorization-freshness">Authorization Freshness</a>
        </h3>
<p id="section-5.5-1">The CAA specification <span>[<a class="xref" href="#RFC8659">RFC8659</a>]</span> governs the act of issuance by a CA. In some cases, a CA
may establish authorization for an account to request certificate issuance for
a specific domain separately from the act of issuance itself. Such authorization
may occur substantially prior to a certificate issuance request. The CAA policy
expressed by a domain may have changed in the meantime, creating the risk that
a CA will issue certificates in a manner inconsistent with the presently
published CAA policy.<a class="pilcrow" href="#section-5.5-1">¶</a></p>
<p id="section-5.5-2">CAs <span class="bcp14">SHOULD</span> adopt practices to reduce the risk of such circumstances. Possible
countermeasures include issuing authorizations with very limited validity
periods, such as an hour, or revalidating the CAA policy for a domain at
certificate issuance time.<a class="pilcrow" href="#section-5.5-2">¶</a></p>
</section>
</div>
<div id="use-with-and-without-dnssec">
<section id="section-5.6">
        <h3 id="name-use-with-and-without-dnssec">
<a class="section-number selfRef" href="#section-5.6">5.6. </a><a class="section-name selfRef" href="#name-use-with-and-without-dnssec">Use with and without DNSSEC</a>
        </h3>
<p id="section-5.6-1">The "domain validation" model of validation commonly used for certificate
issuance cannot ordinarily protect against adversaries who can conduct global
man-in-the-middle attacks against a particular domain. A global
man-in-the-middle attack is an attack that can intercept traffic to or from a
given domain, regardless of the origin or destination of that traffic. Such an
adversary can intercept all validation traffic initiated by a CA and thus
appear to have control of the given domain.<a class="pilcrow" href="#section-5.6-1">¶</a></p>
<p id="section-5.6-2">Where a domain is signed using DNSSEC, the authenticity of its DNS data can be
assured, providing that a given CA makes all DNS resolutions via a trusted
DNSSEC-validating resolver. A domain can use this Property to protect itself
from the threat posed by an adversary capable of performing a global
man-in-the-middle attack against that domain.<a class="pilcrow" href="#section-5.6-2">¶</a></p>
<p id="section-5.6-3">In order to facilitate this, a CA validation process must either rely solely on
information obtained via DNSSEC or meaningfully bind the other parts of the
validation transaction using material obtained via DNSSEC.<a class="pilcrow" href="#section-5.6-3">¶</a></p>
<p id="section-5.6-4">The CAA parameters described in this specification can be used to ensure that
only validation methods meeting these criteria are used. In particular, a
domain secured via DNSSEC <span class="bcp14">SHOULD</span> either:<a class="pilcrow" href="#section-5.6-4">¶</a></p>
<ol class="normal" id="section-5.6-5" start="1" type="1">
          <li id="section-5.6-5.1">Use the "accounturi" parameter to ensure that only accounts that it
controls are authorized to obtain certificates, or<a class="pilcrow" href="#section-5.6-5.1">¶</a>
</li>
          <li id="section-5.6-5.2">Exclusively use validation methods that rely solely on information
obtained via DNSSEC and use the "validationmethods" parameter to ensure
that only such methods are used.<a class="pilcrow" href="#section-5.6-5.2">¶</a>
</li>
        </ol>
<p id="section-5.6-6">A CA supporting the "accounturi" parameter or the "validationmethods" parameter <span class="bcp14">MUST</span> perform
CAA validation using a trusted DNSSEC‑validating resolver.<a class="pilcrow" href="#section-5.6-6">¶</a></p>
<p id="section-5.6-7">"Trusted" in this context means that the CA both trusts the resolver itself and
ensures that the communications path between the resolver and the system
performing CAA validation is secure. It is <span class="bcp14">RECOMMENDED</span> that a CA ensure this
by using a DNSSEC-validating resolver running on the same machine as the system
performing CAA validation.<a class="pilcrow" href="#section-5.6-7">¶</a></p>
<p id="section-5.6-8">The use of the "accounturi" parameter or the "validationmethods" parameter does not confer
additional security against an attacker capable of performing a
man-in-the-middle attack against all validation attempts made by a given CA
that is authorized by CAA where:<a class="pilcrow" href="#section-5.6-8">¶</a></p>
<ol class="normal" id="section-5.6-9" start="1" type="1">
          <li id="section-5.6-9.1">A domain does not secure its nameservers using DNSSEC, or<a class="pilcrow" href="#section-5.6-9.1">¶</a>
</li>
          <li id="section-5.6-9.2">That CA does not perform CAA validation using a trusted DNSSEC‑validating
resolver.<a class="pilcrow" href="#section-5.6-9.2">¶</a>
</li>
        </ol>
<p id="section-5.6-10">Moreover, the use of the "accounturi" parameter or the "validationmethods" parameter does not
mitigate man-in-the-middle attacks against CAs that do not validate
CAA records or that do not do so using a trusted DNSSEC-validating resolver,
regardless of whether or not those CAs are authorized by CAA; see
<a class="xref" href="#limited-to-cas-processing-caa-records">Section 5.1</a>.<a class="pilcrow" href="#section-5.6-10">¶</a></p>
<p id="section-5.6-11">In these cases, the "accounturi" and "validationmethods" parameters still
provide an effective means of administrative control over issuance, except
where control over DNS is subdelegated (see below).<a class="pilcrow" href="#section-5.6-11">¶</a></p>
</section>
</div>
<div id="restrictions-supersedable-by-dns-delegation">
<section id="section-5.7">
        <h3 id="name-restrictions-supersedable-b">
<a class="section-number selfRef" href="#section-5.7">5.7. </a><a class="section-name selfRef" href="#name-restrictions-supersedable-b">Restrictions Supersedable by DNS Delegation</a>
        </h3>
<p id="section-5.7-1">CAA records are located during validation by walking up the DNS hierarchy until
one or more records are found. CAA records are therefore not an effective way
of restricting or controlling issuance for subdomains of a domain, where
control over those subdomains is delegated to another party (such as via DNS
delegation or by providing limited access to manage subdomain DNS records).<a class="pilcrow" href="#section-5.7-1">¶</a></p>
</section>
</div>
<div id="misconfiguration-hazards">
<section id="section-5.8">
        <h3 id="name-misconfiguration-hazards">
<a class="section-number selfRef" href="#section-5.8">5.8. </a><a class="section-name selfRef" href="#name-misconfiguration-hazards">Misconfiguration Hazards</a>
        </h3>
<p id="section-5.8-1">Because the "accounturi" and "validationmethods" parameters express restrictive
security policies, misconfiguration of said parameters may result in legitimate
issuance requests being refused.<a class="pilcrow" href="#section-5.8-1">¶</a></p>
</section>
</div>
<div id="revelation-of-account-uris">
<section id="section-5.9">
        <h3 id="name-revelation-of-account-uris">
<a class="section-number selfRef" href="#section-5.9">5.9. </a><a class="section-name selfRef" href="#name-revelation-of-account-uris">Revelation of Account URIs</a>
        </h3>
<p id="section-5.9-1">Because CAA records are publicly accessible, the use of the "accounturi"
parameter enables third parties to observe the authorized account URIs for a
domain. This may allow third parties to identify a correlation between domains
if those domains use the same account URIs.<a class="pilcrow" href="#section-5.9-1">¶</a></p>
<p id="section-5.9-2">CAs are encouraged to select and process account URIs under the assumption that
untrusted third parties may learn of them.<a class="pilcrow" href="#section-5.9-2">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-6">
      <h2 id="name-iana-considerations">
<a class="section-number selfRef" href="#section-6">6. </a><a class="section-name selfRef" href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<p id="section-6-1">This document has no IANA actions. As per <span>[<a class="xref" href="#RFC8659">RFC8659</a>]</span>, the parameter namespace for the CAA "issue"
and "issuewild" Properties has CA-defined semantics, and the identifiers within
that namespace may be freely and arbitrarily assigned by a CA. This document
merely specifies recommended semantics for parameters of the names "accounturi"
and "validationmethods", which CAs may choose to adopt.<a class="pilcrow" href="#section-6-1">¶</a></p>
</section>
</div>
<section id="section-7">
      <h2 id="name-normative-references">
<a class="section-number selfRef" href="#section-7">7. </a><a class="section-name selfRef" href="#name-normative-references">Normative References</a>
      </h2>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
      <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dt id="RFC3986">[RFC3986]</dt>
      <dd>
<span class="refAuthor">Berners-Lee, T.</span><span class="refAuthor">, Fielding, R.</span><span class="refAuthor">, and L. Masinter</span>, <span class="refTitle">"Uniform Resource Identifier (URI): Generic Syntax"</span>, <span class="seriesInfo">STD 66</span>, <span class="seriesInfo">RFC 3986</span>, <span class="seriesInfo">DOI 10.17487/RFC3986</span>, <time datetime="2005-01">January 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3986">https://www.rfc-editor.org/info/rfc3986</a>&gt;</span>. </dd>
<dt id="RFC5234">[RFC5234]</dt>
      <dd>
<span class="refAuthor">Crocker, D., Ed.</span><span class="refAuthor"> and P. Overell</span>, <span class="refTitle">"Augmented BNF for Syntax Specifications: ABNF"</span>, <span class="seriesInfo">STD 68</span>, <span class="seriesInfo">RFC 5234</span>, <span class="seriesInfo">DOI 10.17487/RFC5234</span>, <time datetime="2008-01">January 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5234">https://www.rfc-editor.org/info/rfc5234</a>&gt;</span>. </dd>
<dt id="RFC8174">[RFC8174]</dt>
      <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dt id="RFC8555">[RFC8555]</dt>
      <dd>
<span class="refAuthor">Barnes, R.</span><span class="refAuthor">, Hoffman-Andrews, J.</span><span class="refAuthor">, McCarney, D.</span><span class="refAuthor">, and J. Kasten</span>, <span class="refTitle">"Automatic Certificate Management Environment (ACME)"</span>, <span class="seriesInfo">RFC 8555</span>, <span class="seriesInfo">DOI 10.17487/RFC8555</span>, <time datetime="2019-03">March 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8555">https://www.rfc-editor.org/info/rfc8555</a>&gt;</span>. </dd>
<dt id="RFC8659">[RFC8659]</dt>
    <dd>
<span class="refAuthor">Hallam-Baker, P.</span><span class="refAuthor">, Stradling, R.</span><span class="refAuthor">, and J. Hoffman-Andrews</span>, <span class="refTitle">"DNS Certification Authority Authorization (CAA) Resource Record"</span>, <span class="seriesInfo">RFC 8659</span>, <span class="seriesInfo">DOI 10.17487/RFC8659</span>, <time datetime="2019-11">November 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8659">https://www.rfc-editor.org/info/rfc8659</a>&gt;</span>. </dd>
</dl>
</section>
<div id="examples">
<section id="section-appendix.a">
      <h2 id="name-examples">
<a class="section-number selfRef" href="#section-appendix.a">Appendix A. </a><a class="section-name selfRef" href="#name-examples">Examples</a>
      </h2>
<p id="section-appendix.a-1">The following shows an example DNS zone file fragment that nominates two
account URIs as authorized to issue certificates for the domain "example.com".
Issuance is restricted to the CA "example.net".<a class="pilcrow" href="#section-appendix.a-1">¶</a></p>
<div class="artwork art-text alignLeft" id="section-appendix.a-2">
<pre>example.com. IN CAA 0 issue "example.net; \
  accounturi=https://example.net/account/1234"
example.com. IN CAA 0 issue "example.net; \
  accounturi=https://example.net/account/2345" </pre><a class="pilcrow" href="#section-appendix.a-2">¶</a>
</div>
<p id="section-appendix.a-3">The following shows a zone file fragment that restricts the ACME methods that
can be used; only ACME methods "dns-01" and "xyz-01" can be used.<a class="pilcrow" href="#section-appendix.a-3">¶</a></p>
<div class="artwork art-text alignLeft" id="section-appendix.a-4">
<pre>example.com. IN CAA 0 issue "example.net; \
  validationmethods=dns-01,xyz-01" </pre><a class="pilcrow" href="#section-appendix.a-4">¶</a>
</div>
<p id="section-appendix.a-5">The following shows an equivalent way of expressing the same restriction:<a class="pilcrow" href="#section-appendix.a-5">¶</a></p>
<div class="artwork art-text alignLeft" id="section-appendix.a-6">
<pre>example.com. IN CAA 0 issue "example.net; validationmethods=dns-01"
example.com. IN CAA 0 issue "example.net; validationmethods=xyz-01" </pre><a class="pilcrow" href="#section-appendix.a-6">¶</a>
</div>
<p id="section-appendix.a-7">The following shows a zone file fragment in which one account can be used to
issue with the "dns-01" method and one account can be used to issue with the
"http-01" method.<a class="pilcrow" href="#section-appendix.a-7">¶</a></p>
<div class="artwork art-text alignLeft" id="section-appendix.a-8">
<pre>example.com. IN CAA 0 issue "example.net; \
  accounturi=https://example.net/account/1234; \
  validationmethods=dns-01"
example.com. IN CAA 0 issue "example.net; \
  accounturi=https://example.net/account/2345; \
  validationmethods=http-01" </pre><a class="pilcrow" href="#section-appendix.a-8">¶</a>
</div>
<p id="section-appendix.a-9">The following shows a zone file fragment in which only ACME method "dns-01" or
a CA-specific method "ca-foo" can be used.<a class="pilcrow" href="#section-appendix.a-9">¶</a></p>
<div class="artwork art-text alignLeft" id="section-appendix.a-10">
<pre>example.com. IN CAA 0 issue "example.net; \
  validationmethods=dns-01,ca-foo" </pre><a class="pilcrow" href="#section-appendix.a-10">¶</a>
</div>
</section>
</div>
<div id="authors-addresses">
<section id="section-appendix.b">
      <h2 id="name-authors-address">
<a class="section-name selfRef" href="#name-authors-address">Author's Address</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Hugo Landau</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:hlandau@devever.net">hlandau@devever.net</a>
</div>
</address>
</section>
</div>
<script>var toc = document.getElementById("toc");
var tocToggle = toc.querySelector("h2");
var tocNav = toc.querySelector("nav");

// mobile menu toggle
tocToggle.onclick = function(event) {
    if (window.innerWidth < 1024) {
 var tocNavDisplay = tocNav.currentStyle ? tocNav.currentStyle.display : getComputedStyle(tocNav, null).display;
 if (tocNavDisplay == "none") {
     tocNav.style.display = "block";
 } else {
     tocNav.style.display = "none";
 }
    }
}

// toc anchor scroll to anchor
tocNav.addEventListener("click", function (event) {
    event.preventDefault();
    if (event.target.nodeName == 'A') {
 if (window.innerWidth < 1024) {
     tocNav.style.display = "none";
 }
 var href = event.target.getAttribute("href");
 var anchorId = href.substr(1);
 var anchor =  document.getElementById(anchorId);
 anchor.scrollIntoView(true);
 window.history.pushState("","",href);
    }
});

// switch toc mode when window resized
window.onresize = function () {
    if (window.innerWidth < 1024) {
 tocNav.style.display = "none";
    } else {
 tocNav.style.display = "block";
    }
}
</script>


</body></html>