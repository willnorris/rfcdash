<!DOCTYPE html>
<html class="RFC" lang="en"><head>
<meta charset="utf-8"/>
<meta content="Common,Latin" name="scripts"/>
<meta content="initial-scale=1.0" name="viewport"/>
<title>RFC 9146: Connection Identifier for DTLS 1.2</title>
<meta content="Eric Rescorla" name="author"/>
<meta content="Hannes Tschofenig" name="author"/>
<meta content="Thomas Fossati" name="author"/>
<meta content="Achim Kraus" name="author"/>
<meta content='
       This document specifies the Connection ID (CID) construct for the Datagram Transport
Layer Security (DTLS) protocol version 1.2. 
       A CID is an identifier carried in the record layer header that gives the
recipient additional information for selecting the appropriate security association.
In "classical" DTLS, selecting a security association of an incoming DTLS record
is accomplished with the help of the 5-tuple. If the source IP address and/or
source port changes during the lifetime of an ongoing DTLS session, then the
receiver will be unable to locate the correct security context. 
       The new ciphertext record format with the CID also provides content type encryption
and record layer padding. 
       This document updates RFC 6347. 
    ' name="description"/>
<meta content="xml2rfc 3.12.2" name="generator"/>
<meta content="NAT rebinding" name="keyword"/>
<meta content="9146" name="rfc.number"/>
<!-- Generator version information:
  xml2rfc 3.12.2
    Python 3.6.15
    appdirs 1.4.4
    ConfigArgParse 1.4.1
    google-i18n-address 2.4.0
    html5lib 1.0.1
    intervaltree 3.0.2
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.4.2
    pycairo 1.15.1
    pycountry 19.8.18
    pyflakes 2.1.1
    PyYAML 5.4.1
    requests 2.24.0
    setuptools 40.5.0
    six 1.14.0
    WeasyPrint 52.5
-->
<link href="rfc9146.xml" rel="alternate" type="application/rfc+xml"/>
<link href="#copyright" rel="license"/>
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css"/>
<link href="https://dx.doi.org/10.17487/rfc9146" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <link href="https://datatracker.ietf.org/doc/draft-ietf-tls-dtls-connection-id-13" rel="prev"/>
  </head>
<body>
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 9146</td>
<td class="center">DTLS 1.2 Connection ID</td>
<td class="right">March 2022</td>
</tr></thead>
<tfoot><tr>
<td class="left">Rescorla, et al.</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div class="document-information" id="external-metadata"></div>
<div class="document-information" id="internal-metadata">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a class="eref" href="https://www.rfc-editor.org/rfc/rfc9146">9146</a></dd>
<dt class="label-updates">Updates:</dt>
<dd class="updates">
<a class="eref" href="https://www.rfc-editor.org/rfc/rfc6347">6347</a> </dd>
<dt class="label-category">Category:</dt>
<dd class="category">Standards Track</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time class="published" datetime="2022-03">March 2022</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">E. Rescorla, <span class="editor">Ed.</span>
</div>
<div class="org">Mozilla</div>
</div>
<div class="author">
      <div class="author-name">H. Tschofenig, <span class="editor">Ed.</span>
</div>
<div class="org">Arm Limited</div>
</div>
<div class="author">
      <div class="author-name">T. Fossati</div>
<div class="org">Arm Limited</div>
</div>
<div class="author">
      <div class="author-name">A. Kraus</div>
<div class="org">Bosch.IO GmbH</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 9146</h1>
<h1 id="title">Connection Identifier for DTLS 1.2</h1>
<section id="section-abstract">
      <h2 id="abstract"><a class="selfRef" href="#abstract">Abstract</a></h2>
<p id="section-abstract-1">This document specifies the Connection ID (CID) construct for the Datagram Transport
Layer Security (DTLS) protocol version 1.2.<a class="pilcrow" href="#section-abstract-1">¶</a></p>
<p id="section-abstract-2">A CID is an identifier carried in the record layer header that gives the
recipient additional information for selecting the appropriate security association.
In "classical" DTLS, selecting a security association of an incoming DTLS record
is accomplished with the help of the 5-tuple. If the source IP address and/or
source port changes during the lifetime of an ongoing DTLS session, then the
receiver will be unable to locate the correct security context.<a class="pilcrow" href="#section-abstract-2">¶</a></p>
<p id="section-abstract-3">The new ciphertext record format with the CID also provides content type encryption
and record layer padding.<a class="pilcrow" href="#section-abstract-3">¶</a></p>
<p id="section-abstract-4">This document updates RFC 6347.<a class="pilcrow" href="#section-abstract-4">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a class="section-name selfRef" href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This is an Internet Standards Track document.<a class="pilcrow" href="#section-boilerplate.1-1">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.<a class="pilcrow" href="#section-boilerplate.1-2">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc9146">https://www.rfc-editor.org/info/rfc9146</a></span>.<a class="pilcrow" href="#section-boilerplate.1-3">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a class="section-name selfRef" href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2022 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a class="pilcrow" href="#section-boilerplate.2-1">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a class="pilcrow" href="#section-boilerplate.2-2">¶</a></p>
<p id="section-boilerplate.2-3">
            This document may contain material from IETF Documents or IETF
            Contributions published or made publicly available before November
            10, 2008. The person(s) controlling the copyright in some of this
            material may not have granted the IETF Trust the right to allow
            modifications of such material outside the IETF Standards Process.
            Without obtaining an adequate license from the person(s)
            controlling the copyright in such materials, this document may not
            be modified outside the IETF Standards Process, and derivative
            works of it may not be created outside the IETF Standards Process,
            except to format it for publication as an RFC or to translate it
            into languages other than English.<a class="pilcrow" href="#section-boilerplate.2-3">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a class="toplink" href="#" onclick="scroll(0,0)">▲</a><h2 id="name-table-of-contents">
<a class="section-name selfRef" href="#name-table-of-contents">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p class="keepWithNext" id="section-toc.1-1.1.1"><a class="xref" href="#section-1">1</a>.  <a class="xref" href="#name-introduction">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p class="keepWithNext" id="section-toc.1-1.2.1"><a class="xref" href="#section-2">2</a>.  <a class="xref" href="#name-conventions-and-terminology">Conventions and Terminology</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p class="keepWithNext" id="section-toc.1-1.3.1"><a class="xref" href="#section-3">3</a>.  <a class="xref" href="#name-the-connection_id-extension">The "connection_id" Extension</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a class="xref" href="#section-4">4</a>.  <a class="xref" href="#name-record-layer-extensions">Record Layer Extensions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a class="xref" href="#section-5">5</a>.  <a class="xref" href="#name-record-payload-protection">Record Payload Protection</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a class="xref" href="#section-5.1">5.1</a>.  <a class="xref" href="#name-block-ciphers">Block Ciphers</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a class="xref" href="#section-5.2">5.2</a>.  <a class="xref" href="#name-block-ciphers-with-encrypt-">Block Ciphers with Encrypt-then-MAC Processing</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a class="xref" href="#section-5.3">5.3</a>.  <a class="xref" href="#name-aead-ciphers">AEAD Ciphers</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a class="xref" href="#section-6">6</a>.  <a class="xref" href="#name-peer-address-update">Peer Address Update</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a class="xref" href="#section-7">7</a>.  <a class="xref" href="#name-example">Example</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a class="xref" href="#section-8">8</a>.  <a class="xref" href="#name-privacy-considerations">Privacy Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a class="xref" href="#section-9">9</a>.  <a class="xref" href="#name-security-considerations">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a class="xref" href="#section-10">10</a>. <a class="xref" href="#name-iana-considerations">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a class="xref" href="#section-10.1">10.1</a>.  <a class="xref" href="#name-extra-column-added-to-the-t">Extra Column Added to the TLS ExtensionType Values Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a class="xref" href="#section-10.2">10.2</a>.  <a class="xref" href="#name-new-entry-in-the-tls-extens">New Entry in the TLS ExtensionType Values Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.3">
                <p id="section-toc.1-1.10.2.3.1"><a class="xref" href="#section-10.3">10.3</a>.  <a class="xref" href="#name-new-entry-in-the-tls-conten">New Entry in the TLS ContentType Registry</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a class="xref" href="#section-11">11</a>. <a class="xref" href="#name-references">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a class="xref" href="#section-11.1">11.1</a>.  <a class="xref" href="#name-normative-references">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a class="xref" href="#section-11.2">11.2</a>.  <a class="xref" href="#name-informative-references">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a class="xref" href="#appendix-A"></a><a class="xref" href="#name-acknowledgements">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a class="xref" href="#appendix-B"></a><a class="xref" href="#name-contributors">Contributors</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a class="xref" href="#appendix-C"></a><a class="xref" href="#name-authors-addresses">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a class="section-number selfRef" href="#section-1">1. </a><a class="section-name selfRef" href="#name-introduction">Introduction</a>
      </h2>
<p id="section-1-1">The Datagram Transport Layer Security (DTLS) protocol <span>[<a class="xref" href="#RFC6347">RFC6347</a>]</span> was designed for
securing data sent over datagram transports (e.g., UDP). DTLS, like TLS, starts
with a handshake, which can be computationally demanding (particularly
when public key cryptography is used). After a successful handshake,
symmetric key cryptography is used to apply data origin
authentication, integrity, and confidentiality protection. This
two-step approach allows endpoints to amortize the cost of the initial
handshake across subsequent application data protection. Ideally, the
second phase where application data is protected lasts over a long
period of time, since the established keys will only need to be updated
once the key lifetime expires.<a class="pilcrow" href="#section-1-1">¶</a></p>
<p id="section-1-2">In DTLS as specified in RFC 6347, the IP address and port of the peer are used to
identify the DTLS association. Unfortunately, in some cases, such as NAT rebinding,
these values are insufficient. This is a particular issue in the Internet of Things
when devices enter extended sleep periods to increase their battery lifetime. The
NAT rebinding leads to connection failure, with the resulting cost of a new handshake.<a class="pilcrow" href="#section-1-2">¶</a></p>
<p id="section-1-3">This document defines an extension to DTLS 1.2 to add a Connection ID (CID) to the
DTLS record layer. The presence of the CID is negotiated via a DTLS
extension.<a class="pilcrow" href="#section-1-3">¶</a></p>
<p id="section-1-4">Adding a CID to the ciphertext record format presents an opportunity to make
other changes to the record format.  In keeping with the best practices
established by TLS 1.3, the type of the record is encrypted, and
a mechanism is provided for adding padding to obfuscate the plaintext length.<a class="pilcrow" href="#section-1-4">¶</a></p>
</section>
</div>
<div id="conventions-and-terminology">
<section id="section-2">
      <h2 id="name-conventions-and-terminology">
<a class="section-number selfRef" href="#section-2">2. </a><a class="section-name selfRef" href="#name-conventions-and-terminology">Conventions and Terminology</a>
      </h2>
<p id="section-2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>",
       "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>",
       "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>",
       "<span class="bcp14">SHOULD NOT</span>",
       "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
       "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document
       are to be interpreted as described in BCP 14
       <span>[<a class="xref" href="#RFC2119">RFC2119</a>]</span> <span>[<a class="xref" href="#RFC8174">RFC8174</a>]</span> when, and only
       when, they appear in all capitals, as shown here.<a class="pilcrow" href="#section-2-1">¶</a></p>
<p id="section-2-2">This document assumes familiarity with DTLS 1.2 <span>[<a class="xref" href="#RFC6347">RFC6347</a>]</span>. The presentation language
used in this document is described in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8446#section-3">Section 3</a> of [<a class="xref" href="#RFC8446">RFC8446</a>]</span>.<a class="pilcrow" href="#section-2-2">¶</a></p>
</section>
</div>
<div id="the-connectionid-extension">
<section id="section-3">
      <h2 id="name-the-connection_id-extension">
<a class="section-number selfRef" href="#section-3">3. </a><a class="section-name selfRef" href="#name-the-connection_id-extension">The "connection_id" Extension</a>
      </h2>
<p id="section-3-1">This document defines the "connection_id" extension, which
is used in ClientHello and ServerHello messages.<a class="pilcrow" href="#section-3-1">¶</a></p>
<p id="section-3-2">The extension type is specified as follows.<a class="pilcrow" href="#section-3-2">¶</a></p>
<div id="section-3-3">
<pre class="lang-tls-presentation sourcecode">  enum {
     connection_id(54), (65535)
  } ExtensionType;
</pre><a class="pilcrow" href="#section-3-3">¶</a>
</div>
<p id="section-3-4">The extension_data field of this extension, when included in the
ClientHello, <span class="bcp14">MUST</span> contain the ConnectionId structure. This structure
contains the CID value the client wishes the server to use when sending
messages to the client. A zero-length CID value indicates that the client
is prepared to send using a CID but does not wish the server to use one when
sending.<a class="pilcrow" href="#section-3-4">¶</a></p>
<div id="section-3-5">
<pre class="lang-tls-presentation sourcecode">  struct {
      opaque cid&lt;0..2^8-1&gt;;
  } ConnectionId;
</pre><a class="pilcrow" href="#section-3-5">¶</a>
</div>
<p id="section-3-6">A server willing to use CIDs will respond with a "connection_id"
extension in the ServerHello, containing the CID it wishes the
client to use when sending messages towards it. A zero-length value
indicates that the server will send using the client's CID but does not
wish the client to include a CID when sending.<a class="pilcrow" href="#section-3-6">¶</a></p>
<p id="section-3-7">Because each party sends the value in the "connection_id" extension it wants to
receive as a CID in encrypted records, it is possible
for an endpoint to use a deployment-specific constant length for such connection
identifiers.  This can in turn ease parsing and connection lookup --
for example, by having the length in question be a compile-time constant.
Such implementations <span class="bcp14">MUST</span> still be able to send
CIDs of different lengths to other parties.
Since the CID length information is not included in the record itself,
implementations that want to use variable-length CIDs are responsible
for constructing the CID in such a way that its length can be determined
on reception.<a class="pilcrow" href="#section-3-7">¶</a></p>
<p id="section-3-8">In DTLS 1.2, CIDs are exchanged at the beginning of the DTLS
session only. There is no dedicated "CID update" message
that allows new CIDs to be established mid-session, because
DTLS 1.2 in general does not allow TLS 1.3-style post-handshake messages
that do not themselves begin other handshakes. When a DTLS session is
resumed or renegotiated, the "connection_id" extension is negotiated afresh.<a class="pilcrow" href="#section-3-8">¶</a></p>
<p id="section-3-9">If DTLS peers have not negotiated the use of CIDs, or a zero-length
CID has been advertised for a given direction, then the record format and content type defined in RFC 6347 <span class="bcp14">MUST</span> be used to send in
the indicated direction(s).<a class="pilcrow" href="#section-3-9">¶</a></p>
<p id="section-3-10">If DTLS peers have negotiated the use of a non-zero-length CID for a
given direction, then once encryption is enabled, they <span class="bcp14">MUST</span> send with
the record format defined in <a class="xref" href="#dtls-ciphertext">Figure 3</a> (see <a class="xref" href="#record-layer-extensions">Section 4</a>) with the
new Message Authentication Code (MAC) computation defined in <a class="xref" href="#mac">Section 5</a> and the content type tls12_cid.
Plaintext payloads never use the new record format or the CID content
type.<a class="pilcrow" href="#section-3-10">¶</a></p>
<p id="section-3-11">When receiving, if the tls12_cid content type is set, then the CID is
used to look up the connection and the security association. If the
tls12_cid content type is not set, then the connection and the security
association are looked up by the 5-tuple and a check <span class="bcp14">MUST</span> be made to
determine whether a non-zero-length CID is expected.
If a non-zero-length CID is expected for the retrieved association,
then the datagram <span class="bcp14">MUST</span> be treated as invalid, as described
in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc6347#section-4.1.2.1">Section 4.1.2.1</a> of [<a class="xref" href="#RFC6347">RFC6347</a>]</span>.<a class="pilcrow" href="#section-3-11">¶</a></p>
<p id="section-3-12">When receiving a datagram with the tls12_cid content type,
the new MAC computation defined in <a class="xref" href="#mac">Section 5</a> <span class="bcp14">MUST</span> be used. When receiving a datagram
with the record format defined in RFC 6347, the MAC calculation defined in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc6347#section-4.1.2">Section 4.1.2</a> of [<a class="xref" href="#RFC6347">RFC6347</a>]</span> <span class="bcp14">MUST</span> be used.<a class="pilcrow" href="#section-3-12">¶</a></p>
</section>
</div>
<div id="record-layer-extensions">
<section id="section-4">
      <h2 id="name-record-layer-extensions">
<a class="section-number selfRef" href="#section-4">4. </a><a class="section-name selfRef" href="#name-record-layer-extensions">Record Layer Extensions</a>
      </h2>
<p id="section-4-1">This specification defines the CID-enhanced record layer format for DTLS 1.2, and
<span>[<a class="xref" href="#I-D.ietf-tls-dtls13">DTLS13</a>]</span> specifies how to carry the CID in DTLS 1.3.<a class="pilcrow" href="#section-4-1">¶</a></p>
<p id="section-4-2">To allow a receiver to determine whether a record has a CID or not,
connections that have negotiated this extension use a distinguished
record type tls12_cid(25). The use of this content type has the following
three implications:<a class="pilcrow" href="#section-4-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-3.1">The CID field is present and contains one or more bytes.<a class="pilcrow" href="#section-4-3.1">¶</a>
</li>
        <li class="normal" id="section-4-3.2">The MAC calculation follows the process described in <a class="xref" href="#mac">Section 5</a>.<a class="pilcrow" href="#section-4-3.2">¶</a>
</li>
        <li class="normal" id="section-4-3.3">The real content type is inside the encryption envelope, as described
below.<a class="pilcrow" href="#section-4-3.3">¶</a>
</li>
      </ul>
<p id="section-4-4">Plaintext records are not impacted by this extension. Hence, the format
of the DTLSPlaintext structure is left unchanged, as shown in <a class="xref" href="#dtls-plaintext">Figure 1</a>.<a class="pilcrow" href="#section-4-4">¶</a></p>
<span id="name-dtls-12-plaintext-record-pa"></span><div id="dtls-plaintext">
<figure id="figure-1">
        <div id="section-4-5.1">
<pre class="lang-tls-presentation sourcecode">     struct {
         ContentType type;
         ProtocolVersion version;
         uint16 epoch;
         uint48 sequence_number;
         uint16 length;
         opaque fragment[DTLSPlaintext.length];
     } DTLSPlaintext;
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-1">Figure 1</a>:
<a class="selfRef" href="#name-dtls-12-plaintext-record-pa">DTLS 1.2 Plaintext Record Payload</a>
        </figcaption></figure>
</div>
<p id="section-4-6">When CIDs are being used, the content to be sent
is first wrapped along with its content type and optional padding into a
DTLSInnerPlaintext structure. This newly introduced structure is shown in
<a class="xref" href="#dtls-innerplaintext">Figure 2</a>.<a class="pilcrow" href="#section-4-6">¶</a></p>
<span id="name-new-dtlsinnerplaintext-payl"></span><div id="dtls-innerplaintext">
<figure id="figure-2">
        <div id="section-4-7.1">
<pre class="lang-tls-presentation sourcecode">     struct {
         opaque content[length];
         ContentType real_type;
         uint8 zeros[length_of_padding];
     } DTLSInnerPlaintext;
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-2">Figure 2</a>:
<a class="selfRef" href="#name-new-dtlsinnerplaintext-payl">New DTLSInnerPlaintext Payload Structure</a>
        </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4-8">
        <dt id="section-4-8.1">
content:</dt>
        <dd id="section-4-8.2" style="margin-left: 1.5em">
          <p id="section-4-8.2.1">Corresponds to the fragment of a given length.<a class="pilcrow" href="#section-4-8.2.1">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-4-8.3">
real_type:</dt>
        <dd id="section-4-8.4" style="margin-left: 1.5em">
          <p id="section-4-8.4.1">The content type describing the cleartext payload.<a class="pilcrow" href="#section-4-8.4.1">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-4-8.5">
zeros:</dt>
        <dd id="section-4-8.6" style="margin-left: 1.5em">
          <p id="section-4-8.6.1">An arbitrary-length run of zero-valued bytes may appear in
the cleartext after the type field.  This provides an opportunity
for senders to pad any DTLS record by a chosen amount as long as
the total stays within record size limits.  See <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8446#section-5.4">Section 5.4</a> of [<a class="xref" href="#RFC8446">RFC8446</a>]</span> for more details. (Note that the term TLSInnerPlaintext in
RFC 8446 refers to DTLSInnerPlaintext in this specification.)<a class="pilcrow" href="#section-4-8.6.1">¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-4-9">The DTLSInnerPlaintext byte sequence is then encrypted. To create the
DTLSCiphertext structure shown in <a class="xref" href="#dtls-ciphertext">Figure 3</a>, the CID is added.<a class="pilcrow" href="#section-4-9">¶</a></p>
<span id="name-dtls-12-cid-enhanced-cipher"></span><div id="dtls-ciphertext">
<figure id="figure-3">
        <div id="section-4-10.1">
<pre class="lang-tls-presentation sourcecode">     struct {
         ContentType outer_type = tls12_cid;
         ProtocolVersion version;
         uint16 epoch;
         uint48 sequence_number;
         opaque cid[cid_length];               // New field
         uint16 length;
         opaque enc_content[DTLSCiphertext.length];
     } DTLSCiphertext;
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-3">Figure 3</a>:
<a class="selfRef" href="#name-dtls-12-cid-enhanced-cipher">DTLS 1.2 CID-Enhanced Ciphertext Record</a>
        </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4-11">
        <dt id="section-4-11.1">
outer_type:</dt>
        <dd id="section-4-11.2" style="margin-left: 1.5em">
          <p id="section-4-11.2.1">The outer content type of a DTLSCiphertext record carrying a CID
is always set to tls12_cid(25). The real content
type of the record is found in DTLSInnerPlaintext.real_type after
decryption.<a class="pilcrow" href="#section-4-11.2.1">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-4-11.3">
cid:</dt>
        <dd id="section-4-11.4" style="margin-left: 1.5em">
          <p id="section-4-11.4.1">The CID value, cid_length bytes long, as agreed at the time the extension
has been negotiated.  Recall that each peer chooses
the CID value it will receive and use to identify the connection, so an
implementation can choose to always receive CIDs of a fixed length.  If,
however, an implementation chooses to receive CIDs of different lengths,
the assigned CID values must be self-delineating, since there is no other
mechanism available to determine what connection (and thus, what CID length)
is in use.<a class="pilcrow" href="#section-4-11.4.1">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-4-11.5">
enc_content:</dt>
        <dd id="section-4-11.6" style="margin-left: 1.5em">
          <p id="section-4-11.6.1">The encrypted form of the serialized DTLSInnerPlaintext structure.<a class="pilcrow" href="#section-4-11.6.1">¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-4-12">All other fields are as defined in RFC 6347.<a class="pilcrow" href="#section-4-12">¶</a></p>
</section>
</div>
<div id="mac">
<section id="section-5">
      <h2 id="name-record-payload-protection">
<a class="section-number selfRef" href="#section-5">5. </a><a class="section-name selfRef" href="#name-record-payload-protection">Record Payload Protection</a>
      </h2>
<p id="section-5-1">Several types of ciphers have been defined for use with TLS and DTLS, and the
MAC calculations for those ciphers differ slightly.<a class="pilcrow" href="#section-5-1">¶</a></p>
<p id="section-5-2">This specification modifies the MAC calculation as defined in <span>[<a class="xref" href="#RFC6347">RFC6347</a>]</span> and
<span>[<a class="xref" href="#RFC7366">RFC7366</a>]</span>, as well as the definition of the additional data used with Authenticated Encryption with Associated Data (AEAD)
ciphers provided in <span>[<a class="xref" href="#RFC6347">RFC6347</a>]</span>, for records with content type tls12_cid.  The
modified algorithm <span class="bcp14">MUST NOT</span> be applied to records that do not carry a CID, i.e.,
records with content type other than tls12_cid.<a class="pilcrow" href="#section-5-2">¶</a></p>
<p id="section-5-3">The following fields are defined in this document; all other fields are as
defined in the cited documents.<a class="pilcrow" href="#section-5-3">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5-4">
        <dt id="section-5-4.1">
cid:</dt>
        <dd id="section-5-4.2" style="margin-left: 1.5em">
          <p id="section-5-4.2.1">Value of the negotiated CID (variable length).<a class="pilcrow" href="#section-5-4.2.1">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-5-4.3">
cid_length:</dt>
        <dd id="section-5-4.4" style="margin-left: 1.5em">
          <p id="section-5-4.4.1">The length (in bytes) of the negotiated CID (one-byte integer).<a class="pilcrow" href="#section-5-4.4.1">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-5-4.5">
length_of_DTLSInnerPlaintext:</dt>
        <dd id="section-5-4.6" style="margin-left: 1.5em">
          <p id="section-5-4.6.1">The length (in bytes) of the serialized DTLSInnerPlaintext (two-byte integer).
The length <span class="bcp14">MUST NOT</span> exceed 2^14.<a class="pilcrow" href="#section-5-4.6.1">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-5-4.7">
seq_num_placeholder:</dt>
        <dd id="section-5-4.8" style="margin-left: 1.5em">
          <p id="section-5-4.8.1">8 bytes of 0xff.<a class="pilcrow" href="#section-5-4.8.1">¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-5-5">Note that "+" denotes concatenation.<a class="pilcrow" href="#section-5-5">¶</a></p>
<div id="block-ciphers">
<section id="section-5.1">
        <h3 id="name-block-ciphers">
<a class="section-number selfRef" href="#section-5.1">5.1. </a><a class="section-name selfRef" href="#name-block-ciphers">Block Ciphers</a>
        </h3>
<p id="section-5.1-1">The following MAC algorithm applies to block ciphers
that do not use the Encrypt-then-MAC processing
described in <span>[<a class="xref" href="#RFC7366">RFC7366</a>]</span>.<a class="pilcrow" href="#section-5.1-1">¶</a></p>
<div id="section-5.1-2">
<pre class="lang-tls-presentation sourcecode">    MAC(MAC_write_key,
        seq_num_placeholder +
        tls12_cid +
        cid_length +
        tls12_cid +
        DTLSCiphertext.version +
        epoch +
        sequence_number +
        cid +
        length_of_DTLSInnerPlaintext +
        DTLSInnerPlaintext.content +
        DTLSInnerPlaintext.real_type +
        DTLSInnerPlaintext.zeros
    );
</pre><a class="pilcrow" href="#section-5.1-2">¶</a>
</div>
<p id="section-5.1-3">The rationale behind this construction is to separate the MAC input
for DTLS without the connection ID from the MAC input with the
connection ID. The former always consists of a sequence number
followed by some content type other than tls12_cid; the latter
always consists of the seq_num_placeholder followed by tls12_cid.
Although 2^64-1 is potentially a valid sequence number, tls12_cid
will never be a valid content type when the connection ID is not in use.
In addition, the epoch and sequence_number are now fed into
the MAC in the same order as they appear on the wire.<a class="pilcrow" href="#section-5.1-3">¶</a></p>
</section>
</div>
<div id="block-ciphers-with-encrypt-then-mac-processing">
<section id="section-5.2">
        <h3 id="name-block-ciphers-with-encrypt-">
<a class="section-number selfRef" href="#section-5.2">5.2. </a><a class="section-name selfRef" href="#name-block-ciphers-with-encrypt-">Block Ciphers with Encrypt-then-MAC Processing</a>
        </h3>
<p id="section-5.2-1">The following MAC algorithm applies to block ciphers
that use the Encrypt-then-MAC processing
described in <span>[<a class="xref" href="#RFC7366">RFC7366</a>]</span>.<a class="pilcrow" href="#section-5.2-1">¶</a></p>
<div id="section-5.2-2">
<pre class="lang-tls-presentation sourcecode">    MAC(MAC_write_key,
        seq_num_placeholder +
        tls12_cid +
        cid_length +
        tls12_cid +
        DTLSCiphertext.version +
        epoch +
        sequence_number +
        cid +
        DTLSCiphertext.length +
        IV +
        ENC(content + padding + padding_length)
    );
</pre><a class="pilcrow" href="#section-5.2-2">¶</a>
</div>
</section>
</div>
<div id="aead-ciphers">
<section id="section-5.3">
        <h3 id="name-aead-ciphers">
<a class="section-number selfRef" href="#section-5.3">5.3. </a><a class="section-name selfRef" href="#name-aead-ciphers">AEAD Ciphers</a>
        </h3>
<p id="section-5.3-1">For ciphers utilizing AEAD,
the following modification is made to the additional data calculation.<a class="pilcrow" href="#section-5.3-1">¶</a></p>
<div id="section-5.3-2">
<pre class="lang-tls-presentation sourcecode">    additional_data = seq_num_placeholder +
                      tls12_cid +
                      cid_length +
                      tls12_cid +
                      DTLSCiphertext.version +
                      epoch +
                      sequence_number +
                      cid +
                      length_of_DTLSInnerPlaintext;
</pre><a class="pilcrow" href="#section-5.3-2">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="peer-address-update">
<section id="section-6">
      <h2 id="name-peer-address-update">
<a class="section-number selfRef" href="#section-6">6. </a><a class="section-name selfRef" href="#name-peer-address-update">Peer Address Update</a>
      </h2>
<p id="section-6-1">When a record with a CID is received that has a source address
different from the one currently associated with the DTLS connection,
the receiver <span class="bcp14">MUST NOT</span> replace the address it uses for sending records
to its peer with the source address specified in the received datagram,
unless the following three conditions are met:<a class="pilcrow" href="#section-6-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6-2.1">The received datagram has been cryptographically verified using
the DTLS record layer processing procedures.<a class="pilcrow" href="#section-6-2.1">¶</a>
</li>
        <li class="normal" id="section-6-2.2">The received datagram is "newer" (in terms of both epoch and sequence
number) than the newest datagram received. Reordered datagrams that are
sent prior to a change in a peer address might otherwise cause a valid
address change to be reverted. This also limits the ability of an attacker
to use replayed datagrams to force a spurious address change, which
could result in denial of service. An attacker might be able to succeed
in changing a peer address if they are able to rewrite source addresses
and if replayed packets are able to arrive before any original.<a class="pilcrow" href="#section-6-2.2">¶</a>
</li>
        <li class="normal" id="section-6-2.3">There is a strategy for ensuring that the new peer address is able to
receive and process DTLS records. No strategy is mandated by this specification,
but see note (*) below.<a class="pilcrow" href="#section-6-2.3">¶</a>
</li>
      </ul>
<p id="section-6-3">The conditions above are necessary to protect against attacks that use datagrams with
spoofed addresses or replayed datagrams to trigger attacks. Note that there
is no requirement for the use of the anti-replay window mechanism defined in
<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc6347#section-4.1.2.6">Section 4.1.2.6</a> of [<a class="xref" href="#RFC6347">RFC6347</a>]</span>. Both solutions, the "anti-replay window" or
"newer" algorithm, will prevent address updates from replay attacks while the
latter will only apply to peer address updates and the former applies to any
application layer traffic.<a class="pilcrow" href="#section-6-3">¶</a></p>
<p id="section-6-4">Note that datagrams that pass the DTLS cryptographic verification procedures
but do not trigger a change of peer address are still valid DTLS records and
are still to be passed to the application.<a class="pilcrow" href="#section-6-4">¶</a></p>
<p id="section-6-5" style="margin-left: 1.5em">(*) Note: Application protocols that implement protection against spoofed addresses
depend on being aware of changes in peer addresses so that they can engage the necessary
mechanisms. When delivered such an event, an address validation mechanism specific to the application layer can be triggered -- for example, one that is based on
successful exchange of a minimal amount of ping-pong traffic with the peer.
Alternatively, a DTLS-specific mechanism may be used, as described in
<span>[<a class="xref" href="#DTLS-RRC">DTLS-RRC</a>]</span>.<a class="pilcrow" href="#section-6-5">¶</a></p>
<p id="section-6-6">DTLS implementations <span class="bcp14">MUST</span> silently discard records with bad MACs or that are
otherwise invalid.<a class="pilcrow" href="#section-6-6">¶</a></p>
</section>
</div>
<div id="examples">
<section id="section-7">
      <h2 id="name-example">
<a class="section-number selfRef" href="#section-7">7. </a><a class="section-name selfRef" href="#name-example">Example</a>
      </h2>
<p id="section-7-1"><a class="xref" href="#dtls-example2">Figure 4</a> shows an example exchange where a CID is
used unidirectionally from the client to the server. To indicate that
a zero-length CID is present in the "connection_id" extension,
we use the notation 'connection_id=empty'.<a class="pilcrow" href="#section-7-1">¶</a></p>
<span id="name-example-dtls-12-exchange-wi"></span><div id="dtls-example2">
<figure id="figure-4">
        <div class="alignLeft art-text artwork" id="section-7-2.1">
<pre>Client                                             Server
------                                             ------

ClientHello                 --------&gt;
(connection_id=empty)


                            &lt;--------      HelloVerifyRequest
                                                     (cookie)

ClientHello                 --------&gt;
(connection_id=empty)
(cookie)

                                                  ServerHello
                                          (connection_id=100)
                                                  Certificate
                                            ServerKeyExchange
                                           CertificateRequest
                            &lt;--------         ServerHelloDone

Certificate
ClientKeyExchange
CertificateVerify
[ChangeCipherSpec]
Finished                    --------&gt;
&lt;CID=100&gt;

                                           [ChangeCipherSpec]
                            &lt;--------                Finished


Application Data            ========&gt;
&lt;CID=100&gt;

                            &lt;========        Application Data

Legend:

&lt;...&gt; indicates that a connection ID is used in the record layer
(...) indicates an extension
[...] indicates a payload other than a handshake message
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-4">Figure 4</a>:
<a class="selfRef" href="#name-example-dtls-12-exchange-wi">Example DTLS 1.2 Exchange with CID</a>
        </figcaption></figure>
</div>
<p id="section-7-3" style="margin-left: 1.5em">Note: In the example exchange, the CID is included in the record layer
once encryption is enabled. In DTLS 1.2, only one handshake message is
encrypted, namely the Finished message. Since the example shows how to
use the CID for payloads sent from the client to the server, only the
record layer payloads containing the Finished message or application data
include a CID.<a class="pilcrow" href="#section-7-3">¶</a></p>
</section>
</div>
<div id="priv-cons">
<section id="section-8">
      <h2 id="name-privacy-considerations">
<a class="section-number selfRef" href="#section-8">8. </a><a class="section-name selfRef" href="#name-privacy-considerations">Privacy Considerations</a>
      </h2>
<p id="section-8-1">The CID replaces the previously used 5-tuple and, as such, introduces
an identifier that remains persistent during the lifetime of a DTLS connection.
Every identifier introduces the risk of linkability, as explained in <span>[<a class="xref" href="#RFC6973">RFC6973</a>]</span>.<a class="pilcrow" href="#section-8-1">¶</a></p>
<p id="section-8-2">An on-path adversary observing the DTLS protocol exchanges between the
DTLS client and the DTLS server is able to link the observed payloads to all
subsequent payloads carrying the same ID pair (for bidirectional
communication).  Without multihoming or mobility, the use of the CID
exposes the same information as the 5-tuple.<a class="pilcrow" href="#section-8-2">¶</a></p>
<p id="section-8-3">With multihoming, a passive attacker is able to correlate the communication
interaction over the two paths. The lack of a CID update mechanism
in DTLS 1.2 makes this extension unsuitable for mobility scenarios where
correlation must be considered. Deployments that use DTLS in multihoming
environments and are concerned about these aspects <span class="bcp14">SHOULD</span> refuse to use CIDs in
DTLS 1.2 and switch to DTLS 1.3 where a CID update mechanism is provided and
sequence number encryption is available.<a class="pilcrow" href="#section-8-3">¶</a></p>
<p id="section-8-4">This specification introduces record padding for the CID-enhanced record layer,
which is a privacy feature not available with the original DTLS 1.2 specification.
Padding allows the size of the ciphertext to be inflated, making traffic analysis
more difficult. More details about record padding can be found in
Section <a class="relref" href="https://www.rfc-editor.org/rfc/rfc8446#section-5.4">5.4</a> and Appendix <a class="relref" href="https://www.rfc-editor.org/rfc/rfc8446#appendix-E.3">E.3</a> of <span>[<a class="xref" href="#RFC8446">RFC8446</a>]</span>.<a class="pilcrow" href="#section-8-4">¶</a></p>
<p id="section-8-5">Finally, endpoints can use the CID to attach arbitrary per-connection metadata
to each record they receive on a given connection. This may be used as a mechanism to communicate
per-connection information to on-path observers. There is no straightforward way to
address this concern with CIDs that contain arbitrary values. Implementations
concerned about this aspect <span class="bcp14">SHOULD</span> refuse to use CIDs.<a class="pilcrow" href="#section-8-5">¶</a></p>
</section>
</div>
<div id="sec-cons">
<section id="section-9">
      <h2 id="name-security-considerations">
<a class="section-number selfRef" href="#section-9">9. </a><a class="section-name selfRef" href="#name-security-considerations">Security Considerations</a>
      </h2>
<p id="section-9-1">An on-path adversary can create reflection attacks
against third parties because a DTLS peer has no means to distinguish a
genuine address update event (for example, due to a NAT rebinding) from one
that is malicious. This attack is of particular concern when the request is small
and the response large. See <a class="xref" href="#peer-address-update">Section 6</a> for more
on address updates.<a class="pilcrow" href="#section-9-1">¶</a></p>
<p id="section-9-2">Additionally, an attacker able to observe the data traffic exchanged between
two DTLS peers is able to replay datagrams with modified IP addresses / port numbers.<a class="pilcrow" href="#section-9-2">¶</a></p>
<p id="section-9-3">The topic of peer address updates is discussed in <a class="xref" href="#peer-address-update">Section 6</a>.<a class="pilcrow" href="#section-9-3">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-10">
      <h2 id="name-iana-considerations">
<a class="section-number selfRef" href="#section-10">10. </a><a class="section-name selfRef" href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<p id="section-10-1">This document implements three IANA updates.<a class="pilcrow" href="#section-10-1">¶</a></p>
<div id="extra-column-to-tls-extensiontype-values-registry">
<section id="section-10.1">
        <h3 id="name-extra-column-added-to-the-t">
<a class="section-number selfRef" href="#section-10.1">10.1. </a><a class="section-name selfRef" href="#name-extra-column-added-to-the-t">Extra Column Added to the TLS ExtensionType Values Registry</a>
        </h3>
<p id="section-10.1-1">IANA has added an extra column named "DTLS-Only" to the
"TLS ExtensionType Values" registry to indicate whether an extension is only
applicable to DTLS and to include this document as an additional reference
for the registry.<a class="pilcrow" href="#section-10.1-1">¶</a></p>
</section>
</div>
<div id="entry-to-the-tls-extensiontype-values-registry">
<section id="section-10.2">
        <h3 id="name-new-entry-in-the-tls-extens">
<a class="section-number selfRef" href="#section-10.2">10.2. </a><a class="section-name selfRef" href="#name-new-entry-in-the-tls-extens">New Entry in the TLS ExtensionType Values Registry</a>
        </h3>
<p id="section-10.2-1">IANA has allocated an entry in the existing "TLS ExtensionType
Values" registry for connection_id(54), as described
in the table below. Although the value 53 had been allocated by early allocation for a previous version of this document, it
is incompatible with this document.
Therefore, the early allocation has been deprecated
in favor of this assignment.<a class="pilcrow" href="#section-10.2-1">¶</a></p>
<div id="iana-tls-ext-entry">
<table class="center" id="table-1">
          <caption><a class="selfRef" href="#table-1">Table 1</a></caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Value</th>
              <th class="text-left" colspan="1" rowspan="1">Extension Name</th>
              <th class="text-left" colspan="1" rowspan="1">TLS 1.3</th>
              <th class="text-left" colspan="1" rowspan="1">DTLS-Only</th>
              <th class="text-left" colspan="1" rowspan="1">Recommended</th>
              <th class="text-left" colspan="1" rowspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">54</td>
              <td class="text-left" colspan="1" rowspan="1">connection_id</td>
              <td class="text-left" colspan="1" rowspan="1">CH, SH</td>
              <td class="text-left" colspan="1" rowspan="1">Y</td>
              <td class="text-left" colspan="1" rowspan="1">N</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9146</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-10.2-3">A new column, "DTLS-Only", has been added to the registry.
The valid entries are "Y" if the extension is only applicable to DTLS, "N" otherwise.
All the pre-existing entries are given the value "N".<a class="pilcrow" href="#section-10.2-3">¶</a></p>
<p id="section-10.2-4" style="margin-left: 1.5em">Note: The value "N" in the "Recommended" column is set because this
extension is intended only for specific use cases. This document describes
the behavior of this extension for DTLS 1.2 only; it is not applicable to TLS, and
its usage for DTLS 1.3 is described in <span>[<a class="xref" href="#I-D.ietf-tls-dtls13">DTLS13</a>]</span>.<a class="pilcrow" href="#section-10.2-4">¶</a></p>
</section>
</div>
<div id="entry-to-the-tls-contenttype-registry">
<section id="section-10.3">
        <h3 id="name-new-entry-in-the-tls-conten">
<a class="section-number selfRef" href="#section-10.3">10.3. </a><a class="section-name selfRef" href="#name-new-entry-in-the-tls-conten">New Entry in the TLS ContentType Registry</a>
        </h3>
<p id="section-10.3-1">IANA has allocated tls12_cid(25) in the "TLS ContentType"
registry. The tls12_cid content type is only applicable to DTLS 1.2.<a class="pilcrow" href="#section-10.3-1">¶</a></p>
</section>
</div>
</section>
</div>
<section id="section-11">
      <h2 id="name-references">
<a class="section-number selfRef" href="#section-11">11. </a><a class="section-name selfRef" href="#name-references">References</a>
      </h2>
<section id="section-11.1">
        <h3 id="name-normative-references">
<a class="section-number selfRef" href="#section-11.1">11.1. </a><a class="section-name selfRef" href="#name-normative-references">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time class="refDate" datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6347">[RFC6347]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span> and <span class="refAuthor">N. Modadugu</span>, <span class="refTitle">"Datagram Transport Layer Security Version 1.2"</span>, <span class="seriesInfo">RFC 6347</span>, <span class="seriesInfo">DOI 10.17487/RFC6347</span>, <time class="refDate" datetime="2012-01">January 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6347">https://www.rfc-editor.org/info/rfc6347</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7366">[RFC7366]</dt>
        <dd>
<span class="refAuthor">Gutmann, P.</span>, <span class="refTitle">"Encrypt-then-MAC for Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)"</span>, <span class="seriesInfo">RFC 7366</span>, <span class="seriesInfo">DOI 10.17487/RFC7366</span>, <time class="refDate" datetime="2014-09">September 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7366">https://www.rfc-editor.org/info/rfc7366</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time class="refDate" datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
      <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time class="refDate" datetime="2018-08">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-11.2">
        <h3 id="name-informative-references">
<a class="section-number selfRef" href="#section-11.2">11.2. </a><a class="section-name selfRef" href="#name-informative-references">Informative References</a>
        </h3>
<dl class="references">
<dt id="DTLS-RRC">[DTLS-RRC]</dt>
        <dd>
<span class="refAuthor">Tschofenig, H., Ed.</span> and <span class="refAuthor">T. Fossati</span>, <span class="refTitle">"Return Routability Check for DTLS 1.2 and DTLS 1.3"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-tls-dtls-rrc-05</span>, <time class="refDate" datetime="2022-03-07">7 March 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-tls-dtls-rrc-05">https://datatracker.ietf.org/doc/html/draft-ietf-tls-dtls-rrc-05</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-tls-dtls13">[DTLS13]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refAuthor">Tschofenig, H.</span>, and <span class="refAuthor">N. Modadugu</span>, <span class="refTitle">"The Datagram Transport Layer Security (DTLS) Protocol Version 1.3"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-tls-dtls13-43</span>, <time class="refDate" datetime="2021-04-30">30 April 2021</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-tls-dtls13-43">https://datatracker.ietf.org/doc/html/draft-ietf-tls-dtls13-43</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6973">[RFC6973]</dt>
      <dd>
<span class="refAuthor">Cooper, A.</span>, <span class="refAuthor">Tschofenig, H.</span>, <span class="refAuthor">Aboba, B.</span>, <span class="refAuthor">Peterson, J.</span>, <span class="refAuthor">Morris, J.</span>, <span class="refAuthor">Hansen, M.</span>, and <span class="refAuthor">R. Smith</span>, <span class="refTitle">"Privacy Considerations for Internet Protocols"</span>, <span class="seriesInfo">RFC 6973</span>, <span class="seriesInfo">DOI 10.17487/RFC6973</span>, <time class="refDate" datetime="2013-07">July 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6973">https://www.rfc-editor.org/info/rfc6973</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="acknowledgements">
<section id="appendix-A">
      <h2 id="name-acknowledgements">
<a class="section-name selfRef" href="#name-acknowledgements">Acknowledgements</a>
      </h2>
<p id="appendix-A-1">We would like to thank <span class="contact-name">Hanno Becker</span>, <span class="contact-name">Martin Duke</span>, <span class="contact-name">Lars Eggert</span>, <span class="contact-name">Ben Kaduk</span>, <span class="contact-name">Warren Kumari</span>,
<span class="contact-name">Francesca Palombini</span>, <span class="contact-name">Tom Petch</span>, <span class="contact-name">John Scudder</span>, <span class="contact-name">Sean Turner</span>, <span class="contact-name">Éric Vyncke</span>, and <span class="contact-name">Robert Wilton</span>
for their review comments.<a class="pilcrow" href="#appendix-A-1">¶</a></p>
<p id="appendix-A-2">Finally, we want to thank the IETF TLS Working Group chairs, <span class="contact-name">Chris Wood</span>, <span class="contact-name">Joseph Salowey</span>, and
<span class="contact-name">Sean Turner</span>, for their patience, support, and feedback.<a class="pilcrow" href="#appendix-A-2">¶</a></p>
</section>
</div>
<div id="contributors">
<section id="appendix-B">
      <h2 id="name-contributors">
<a class="section-name selfRef" href="#name-contributors">Contributors</a>
      </h2>
<p id="appendix-B-1">Many people have contributed to this specification, and we would like to thank
the following individuals for their contributions:<a class="pilcrow" href="#appendix-B-1">¶</a></p>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Yin Xinxing</span></div>
<div class="left" dir="auto"><span class="org">Huawei</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:yinxinxing@huawei.com">yinxinxing@huawei.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Nikos Mavrogiannopoulos</span></div>
<div class="left" dir="auto"><span class="org">RedHat</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:nmav@redhat.com">nmav@redhat.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Tobias Gondrom</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:tobias.gondrom@gondrom.org">tobias.gondrom@gondrom.org</a>
</div>
</address>
<p id="appendix-B-2">Additionally, we would like to thank the Connection ID task force team members:<a class="pilcrow" href="#appendix-B-2">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-3.1">
          <p id="appendix-B-3.1.1"><span class="contact-name">Martin Thomson</span> (Mozilla)<a class="pilcrow" href="#appendix-B-3.1.1">¶</a></p>
</li>
        <li class="normal" id="appendix-B-3.2">
          <p id="appendix-B-3.2.1"><span class="contact-name">Christian Huitema</span> (Private Octopus Inc.)<a class="pilcrow" href="#appendix-B-3.2.1">¶</a></p>
</li>
        <li class="normal" id="appendix-B-3.3">
          <p id="appendix-B-3.3.1"><span class="contact-name">Jana Iyengar</span> (Google)<a class="pilcrow" href="#appendix-B-3.3.1">¶</a></p>
</li>
        <li class="normal" id="appendix-B-3.4">
          <p id="appendix-B-3.4.1"><span class="contact-name">Daniel Kahn Gillmor</span> (ACLU)<a class="pilcrow" href="#appendix-B-3.4.1">¶</a></p>
</li>
        <li class="normal" id="appendix-B-3.5">
          <p id="appendix-B-3.5.1"><span class="contact-name">Patrick McManus</span> (Mozilla)<a class="pilcrow" href="#appendix-B-3.5.1">¶</a></p>
</li>
        <li class="normal" id="appendix-B-3.6">
          <p id="appendix-B-3.6.1"><span class="contact-name">Ian Swett</span> (Google)<a class="pilcrow" href="#appendix-B-3.6.1">¶</a></p>
</li>
        <li class="normal" id="appendix-B-3.7">
          <p id="appendix-B-3.7.1"><span class="contact-name">Mark Nottingham</span> (Fastly)<a class="pilcrow" href="#appendix-B-3.7.1">¶</a></p>
</li>
      </ul>
<p id="appendix-B-4">The task force team discussed various design ideas, including cryptographically generated session
IDs using hash chains and public key encryption, but dismissed them due to their
inefficiency. The approach described in this specification is the
simplest possible design that works, given the limitations of DTLS 1.2. DTLS 1.3 provides
better privacy features, and developers are encouraged to switch to the new version of DTLS.<a class="pilcrow" href="#appendix-B-4">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-C">
      <h2 id="name-authors-addresses">
<a class="section-name selfRef" href="#name-authors-addresses">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Eric Rescorla (<span class="role">editor</span>)</span></div>
<div class="left" dir="auto"><span class="org">Mozilla</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:ekr@rtfm.com">ekr@rtfm.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Hannes Tschofenig (<span class="role">editor</span>)</span></div>
<div class="left" dir="auto"><span class="org">Arm Limited</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:hannes.tschofenig@arm.com">hannes.tschofenig@arm.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Thomas Fossati</span></div>
<div class="left" dir="auto"><span class="org">Arm Limited</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:thomas.fossati@arm.com">thomas.fossati@arm.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Achim Kraus</span></div>
<div class="left" dir="auto"><span class="org">Bosch.IO GmbH</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:achim.kraus@bosch.io">achim.kraus@bosch.io</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>


</body></html>