<!DOCTYPE html>
<html class="RFC" lang="en"><head>
<meta charset="utf-8"/>
<meta content="Common,Latin" name="scripts"/>
<meta content="initial-scale=1.0" name="viewport"/>
<title>RFC 8844: Unknown Key-Share Attacks on Uses of TLS with the Session Description Protocol (SDP)</title>
<meta content="Martin Thomson" name="author"/>
<meta content="Eric Rescorla" name="author"/>
<meta content="
       This document describes unknown key-share attacks on the use of
      Datagram Transport Layer Security for the Secure Real-Time Transport
      Protocol (DTLS-SRTP). Similar attacks are described on the use of
      DTLS-SRTP with the identity bindings used in Web Real-Time
      Communications (WebRTC) and SIP identity.  These attacks are difficult
      to mount, but they cause a victim to be misled about the identity of a
      communicating peer.  This document defines mitigation techniques that
      implementations of RFC 8122 are encouraged to deploy. 
    " name="description"/>
<meta content="xml2rfc 3.5.0" name="generator"/>
<meta content="Unknown Key-Share Attack" name="keyword"/>
<meta content="SDP" name="keyword"/>
<meta content="DTLS-SRTP" name="keyword"/>
<meta content="WebRTC" name="keyword"/>
<meta content="SIP identity" name="keyword"/>
<meta content="8844" name="rfc.number"/>
<!-- Generator version information:
  xml2rfc 3.5.0
    Python 3.6.10
    appdirs 1.4.4
    ConfigArgParse 1.2.3
    google-i18n-address 2.3.5
    html5lib 1.0.1
    intervaltree 3.0.2
    Jinja2 2.11.2
    kitchen 1.2.6
    lxml 4.4.2
    pycairo 1.19.0
    pycountry 19.8.18
    pyflakes 2.1.1
    PyYAML 5.3.1
    requests 2.22.0
    setuptools 40.6.2
    six 1.14.0
    WeasyPrint 51
-->
<link href="rfc8844.xml" rel="alternate" type="application/rfc+xml"/>
<link href="#copyright" rel="license"/>
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css"/>
<link href="https://dx.doi.org/10.17487/rfc8844" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <link href="https://datatracker.ietf.org/doc/draft-ietf-mmusic-sdp-uks-07" rel="prev"/>
  </head>
<body>
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 8844</td>
<td class="center">SDP UKS</td>
<td class="right">January 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Thomson &amp; Rescorla</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div class="document-information" id="external-metadata"></div>
<div class="document-information" id="internal-metadata">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a class="eref" href="https://www.rfc-editor.org/rfc/rfc8844">8844</a></dd>
<dt class="label-updates">Updates:</dt>
<dd class="updates">
<a class="eref" href="https://www.rfc-editor.org/rfc/rfc8122">8122</a> </dd>
<dt class="label-category">Category:</dt>
<dd class="category">Standards Track</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time class="published" datetime="2021-01">January 2021</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">M. Thomson</div>
<div class="org">Mozilla</div>
</div>
<div class="author">
      <div class="author-name">E. Rescorla</div>
<div class="org">Mozilla</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 8844</h1>
<h1 id="title">Unknown Key-Share Attacks on Uses of TLS with the Session Description Protocol (SDP)</h1>
<section id="section-abstract">
      <h2 id="abstract"><a class="selfRef" href="#abstract">Abstract</a></h2>
<p id="section-abstract-1">This document describes unknown key-share attacks on the use of
      Datagram Transport Layer Security for the Secure Real-Time Transport
      Protocol (DTLS-SRTP). Similar attacks are described on the use of
      DTLS-SRTP with the identity bindings used in Web Real-Time
      Communications (WebRTC) and SIP identity.  These attacks are difficult
      to mount, but they cause a victim to be misled about the identity of a
      communicating peer.  This document defines mitigation techniques that
      implementations of RFC 8122 are encouraged to deploy.<a class="pilcrow" href="#section-abstract-1">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a class="section-name selfRef" href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This is an Internet Standards Track document.<a class="pilcrow" href="#section-boilerplate.1-1">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.<a class="pilcrow" href="#section-boilerplate.1-2">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc8844">https://www.rfc-editor.org/info/rfc8844</a></span>.<a class="pilcrow" href="#section-boilerplate.1-3">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a class="section-name selfRef" href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a class="pilcrow" href="#section-boilerplate.2-1">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a class="pilcrow" href="#section-boilerplate.2-2">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a class="toplink" href="#" onclick="scroll(0,0)">▲</a><h2 id="name-table-of-contents">
<a class="section-name selfRef" href="#name-table-of-contents">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.1">
            <p class="keepWithNext" id="section-toc.1-1.1.1"><a class="xref" href="#section-1">1</a>.  <a class="xref" href="#name-introduction">Introduction</a><a class="pilcrow" href="#section-toc.1-1.1.1">¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a class="xref" href="#section-2">2</a>.  <a class="xref" href="#name-unknown-key-share-attack">Unknown Key-Share Attack</a><a class="pilcrow" href="#section-toc.1-1.2.1">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.2.2.1">
                <p class="keepWithNext" id="section-toc.1-1.2.2.1.1"><a class="xref" href="#section-2.1">2.1</a>.  <a class="xref" href="#name-limits-on-attack-feasibilit">Limits on Attack Feasibility</a><a class="pilcrow" href="#section-toc.1-1.2.2.1.1">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.2.2.2">
                <p class="keepWithNext" id="section-toc.1-1.2.2.2.1"><a class="xref" href="#section-2.2">2.2</a>.  <a class="xref" href="#name-interactions-with-key-conti">Interactions with Key Continuity</a><a class="pilcrow" href="#section-toc.1-1.2.2.2.1">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a class="xref" href="#section-2.3">2.3</a>.  <a class="xref" href="#name-third-party-call-control">Third-Party Call Control</a><a class="pilcrow" href="#section-toc.1-1.2.2.3.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a class="xref" href="#section-3">3</a>.  <a class="xref" href="#name-unknown-key-share-attack-wi">Unknown Key-Share Attack with Identity Bindings</a><a class="pilcrow" href="#section-toc.1-1.3.1">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a class="xref" href="#section-3.1">3.1</a>.  <a class="xref" href="#name-example">Example</a><a class="pilcrow" href="#section-toc.1-1.3.2.1.1">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a class="xref" href="#section-3.2">3.2</a>.  <a class="xref" href="#name-the-external_id_hash-tls-ex">The <code>external_id_hash</code> TLS Extension</a><a class="pilcrow" href="#section-toc.1-1.3.2.2.1">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.3.2.2.2.1">
                    <p id="section-toc.1-1.3.2.2.2.1.1"><a class="xref" href="#section-3.2.1">3.2.1</a>.  <a class="xref" href="#name-calculating-external_id_has">Calculating <code>external_id_hash</code> for WebRTC Identity</a><a class="pilcrow" href="#section-toc.1-1.3.2.2.2.1.1">¶</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.3.2.2.2.2">
                    <p id="section-toc.1-1.3.2.2.2.2.1"><a class="xref" href="#section-3.2.2">3.2.2</a>.  <a class="xref" href="#name-calculating-external_id_hash">Calculating external_id_hash for PASSporT</a><a class="pilcrow" href="#section-toc.1-1.3.2.2.2.2.1">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a class="xref" href="#section-4">4</a>.  <a class="xref" href="#name-unknown-key-share-attack-wit">Unknown Key-Share Attack with Fingerprints</a><a class="pilcrow" href="#section-toc.1-1.4.1">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a class="xref" href="#section-4.1">4.1</a>.  <a class="xref" href="#name-example-2">Example</a><a class="pilcrow" href="#section-toc.1-1.4.2.1.1">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a class="xref" href="#section-4.2">4.2</a>.  <a class="xref" href="#name-unique-session-identity-sol">Unique Session Identity Solution</a><a class="pilcrow" href="#section-toc.1-1.4.2.2.1">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a class="xref" href="#section-4.3">4.3</a>.  <a class="xref" href="#name-the-external_session_id-tls">The external_session_id TLS Extension</a><a class="pilcrow" href="#section-toc.1-1.4.2.3.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a class="xref" href="#section-5">5</a>.  <a class="xref" href="#name-session-concatenation">Session Concatenation</a><a class="pilcrow" href="#section-toc.1-1.5.1">¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a class="xref" href="#section-6">6</a>.  <a class="xref" href="#name-security-considerations">Security Considerations</a><a class="pilcrow" href="#section-toc.1-1.6.1">¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a class="xref" href="#section-7">7</a>.  <a class="xref" href="#name-iana-considerations">IANA Considerations</a><a class="pilcrow" href="#section-toc.1-1.7.1">¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a class="xref" href="#section-8">8</a>.  <a class="xref" href="#name-references">References</a><a class="pilcrow" href="#section-toc.1-1.8.1">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a class="xref" href="#section-8.1">8.1</a>.  <a class="xref" href="#name-normative-references">Normative References</a><a class="pilcrow" href="#section-toc.1-1.8.2.1.1">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a class="xref" href="#section-8.2">8.2</a>.  <a class="xref" href="#name-informative-references">Informative References</a><a class="pilcrow" href="#section-toc.1-1.8.2.2.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a class="xref" href="#section-appendix.a"></a><a class="xref" href="#name-acknowledgements">Acknowledgements</a><a class="pilcrow" href="#section-toc.1-1.9.1">¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a class="xref" href="#section-appendix.b"></a><a class="xref" href="#name-authors-addresses">Authors' Addresses</a><a class="pilcrow" href="#section-toc.1-1.10.1">¶</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a class="section-number selfRef" href="#section-1">1. </a><a class="section-name selfRef" href="#name-introduction">Introduction</a>
      </h2>
<p id="section-1-1">The use of Transport Layer Security (TLS) <span>[<a class="xref" href="#RFC8446">TLS13</a>]</span> with the Session Description Protocol (SDP) <span>[<a class="xref" href="#RFC4566">SDP</a>]</span> is defined in <span>[<a class="xref" href="#RFC8122">FINGERPRINT</a>]</span>.  Further use with Datagram Transport Layer Security
      (DTLS) <span>[<a class="xref" href="#RFC6347">DTLS</a>]</span> and the Secure
      Real-time Transport Protocol (SRTP) <span>[<a class="xref" href="#RFC3711">SRTP</a>]</span> is defined as DTLS-SRTP <span>[<a class="xref" href="#RFC5763">DTLS-SRTP</a>]</span>.<a class="pilcrow" href="#section-1-1">¶</a></p>
<p id="section-1-2">In these specifications, key agreement is performed using TLS or DTLS, with
authentication being tied back to the session description (or SDP) through the
use of certificate fingerprints.  Communication peers check that a hash, or
fingerprint, provided in the SDP matches the certificate that is used in the TLS
or DTLS handshake.<a class="pilcrow" href="#section-1-2">¶</a></p>
<p id="section-1-3">WebRTC identity (see <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8827#section-7">Section 7</a> of [<a class="xref" href="#RFC8827">WEBRTC-SEC</a>]</span>)
and SIP identity <span>[<a class="xref" href="#RFC8224">SIP-ID</a>]</span> both provide a mechanism that binds an
external identity to the certificate fingerprints from a session description.
However, this binding is not integrity protected and is therefore vulnerable to an
identity misbinding attack, also known as an unknown key-share (UKS) attack, where the
attacker binds their identity to the fingerprint of another entity.  A
successful attack leads to the creation of sessions where peers are confused
about the identity of the participants.<a class="pilcrow" href="#section-1-3">¶</a></p>
<p id="section-1-4">This document describes a TLS extension that can be used in combination with
these identity bindings to prevent this attack.<a class="pilcrow" href="#section-1-4">¶</a></p>
<p id="section-1-5">A similar attack is possible with the use of certificate fingerprints alone.
   Though attacks in this setting are likely infeasible in existing
   deployments due to the narrow preconditions
(see <a class="xref" href="#limits">Section 2.1</a>), this document also
describes mitigations for this attack.<a class="pilcrow" href="#section-1-5">¶</a></p>
<p id="section-1-6">The mechanisms defined in this document are intended to strengthen the protocol
by preventing the use of unknown key-share attacks in combination with other protocol
or implementation vulnerabilities.  RFC 8122 <span>[<a class="xref" href="#RFC8122">FINGERPRINT</a>]</span> is updated by this
document to recommend the use of these mechanisms.<a class="pilcrow" href="#section-1-6">¶</a></p>
<p id="section-1-7">This document assumes that signaling is integrity protected.  However, as
<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8122#section-7">Section 7</a> of [<a class="xref" href="#RFC8122">FINGERPRINT</a>]</span> explains, many deployments that use SDP do not
guarantee integrity of session signaling and so are vulnerable to other attacks.
<span>[<a class="xref" href="#RFC8122">FINGERPRINT</a>]</span> offers key continuity mechanisms as a potential means of
reducing exposure to attack in the absence of integrity protection.
<a class="xref" href="#continuity">Section 2.2</a> provides some analysis of the effect of key continuity in
relation to the described attacks.<a class="pilcrow" href="#section-1-7">¶</a></p>
<p id="section-1-8">
    The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
    "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
    described in BCP 14 <span>[<a class="xref" href="#RFC2119">RFC2119</a>]</span> <span>[<a class="xref" href="#RFC8174">RFC8174</a>]</span>
    when, and only when, they appear in all capitals, as shown here.<a class="pilcrow" href="#section-1-8">¶</a></p>
</section>
</div>
<div id="uks">
<section id="section-2">
      <h2 id="name-unknown-key-share-attack">
<a class="section-number selfRef" href="#section-2">2. </a><a class="section-name selfRef" href="#name-unknown-key-share-attack">Unknown Key-Share Attack</a>
      </h2>
<p id="section-2-1">In an unknown key-share attack <span>[<a class="xref" href="#UKS">UKS</a>]</span>, a malicious participant in a protocol
claims to control a key that is in reality controlled by some other actor.  This
arises when the identity associated with a key is not properly bound to the key.<a class="pilcrow" href="#section-2-1">¶</a></p>
<p id="section-2-2">An endpoint that can acquire the certificate fingerprint of another entity can
advertise that fingerprint as their own in SDP.
   An attacker can use a copy of that fingerprint to cause a victim to
   communicate with another unaware victim, even though the first victim believes
   that it is communicating with the attacker.<a class="pilcrow" href="#section-2-2">¶</a></p>
<p id="section-2-3">When the identity of communicating peers is established by higher-layer
signaling constructs, such as those in SIP identity <span>[<a class="xref" href="#RFC8224">SIP-ID</a>]</span> or WebRTC
<span>[<a class="xref" href="#RFC8827">WEBRTC-SEC</a>]</span>, this allows an attacker to bind their own identity to a session
with any other entity.<a class="pilcrow" href="#section-2-3">¶</a></p>
<p id="section-2-4">The attacker obtains an identity assertion for an identity it controls, but
binds that to the fingerprint of one peer.  The attacker is then able to cause a
TLS connection to be established where two victim endpoints communicate.  The
victim that has its fingerprint copied by the attack correctly believes that it
is communicating with the other victim; however, the other victim incorrectly
believes that it is communicating with the attacker.<a class="pilcrow" href="#section-2-4">¶</a></p>
<p id="section-2-5">An unknown key-share attack does not result in the attacker having access to any
confidential information exchanged between victims.  However, the failure in
mutual authentication can enable other attacks.  A victim might send information
to the wrong entity as a result.  Where information is interpreted in context,
misrepresenting that context could lead to the information being misinterpreted.<a class="pilcrow" href="#section-2-5">¶</a></p>
<p id="section-2-6">A similar attack can be mounted based solely on the SDP <code>fingerprint</code> attribute
<span>[<a class="xref" href="#RFC8122">FINGERPRINT</a>]</span> without compromising the integrity of the signaling channel.<a class="pilcrow" href="#section-2-6">¶</a></p>
<p id="section-2-7">This attack is an aspect of SDP-based protocols upon which the technique known as
third-party call control (3PCC) <span>[<a class="xref" href="#RFC3725">RFC3725</a>]</span> relies.  3PCC exploits the
potential for the identity of a signaling peer to be different than the media
peer, allowing the media peer to be selected by the signaling peer.
<a class="xref" href="#byebye-3pcc">Section 2.3</a> describes the consequences of the mitigations described here for
systems that use 3PCC.<a class="pilcrow" href="#section-2-7">¶</a></p>
<div id="limits">
<section id="section-2.1">
        <h3 id="name-limits-on-attack-feasibilit">
<a class="section-number selfRef" href="#section-2.1">2.1. </a><a class="section-name selfRef" href="#name-limits-on-attack-feasibilit">Limits on Attack Feasibility</a>
        </h3>
<p id="section-2.1-1">The use of TLS with SDP depends on the integrity of session signaling.  Assuming
signaling integrity limits the capabilities of an attacker in several ways.  In
particular:<a class="pilcrow" href="#section-2.1-1">¶</a></p>
<ol class="normal type-1" id="section-2.1-2" start="1" type="1">
          <li id="section-2.1-2.1">An attacker can only modify the parts of the session signaling that they are
responsible for producing, namely their own offers and answers.<a class="pilcrow" href="#section-2.1-2.1">¶</a>
</li>
          <li id="section-2.1-2.2">No entity will successfully establish a session with a peer unless they are
willing to participate in a session with that peer.<a class="pilcrow" href="#section-2.1-2.2">¶</a>
</li>
        </ol>
<p id="section-2.1-3">The combination of these two constraints make the spectrum of possible attacks
quite limited.  An attacker is only able to switch its own certificate
fingerprint for a valid certificate that is acceptable to its peer.  Attacks
therefore rely on joining two separate sessions into a single session. <a class="xref" href="#fp">Section 4</a>
describes an attack on SDP signaling under these constraints.<a class="pilcrow" href="#section-2.1-3">¶</a></p>
<p id="section-2.1-4">Systems that rely on strong identity bindings, such as those defined in
<span>[<a class="xref" href="#WEBRTC">WEBRTC</a>]</span> or <span>[<a class="xref" href="#RFC8224">SIP-ID</a>]</span>, have a different threat model, which admits the
possibility of attack by an entity with access to the signaling channel.
Attacks under these conditions are more feasible as an attacker is assumed to be
able both to observe and to modify signaling messages.  <a class="xref" href="#id">Section 3</a> describes an attack
that assumes this threat model.<a class="pilcrow" href="#section-2.1-4">¶</a></p>
</section>
</div>
<div id="continuity">
<section id="section-2.2">
        <h3 id="name-interactions-with-key-conti">
<a class="section-number selfRef" href="#section-2.2">2.2. </a><a class="section-name selfRef" href="#name-interactions-with-key-conti">Interactions with Key Continuity</a>
        </h3>
<p id="section-2.2-1">Systems that use key continuity (as defined in
<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc6189#section-15.1">Section 15.1</a> of [<a class="xref" href="#RFC6189">ZRTP</a>]</span>
or as recommended in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8122#section-7">Section 7</a> of [<a class="xref" href="#RFC8122">FINGERPRINT</a>]</span>) might be able to detect an
unknown key-share attack if a session with either the attacker or the genuine
peer (i.e., the victim whose fingerprint was copied by an attacker) was
established in the past.  Whether this is possible depends on how key continuity
is implemented.<a class="pilcrow" href="#section-2.2-1">¶</a></p>
<p id="section-2.2-2">Implementations that maintain a single database of identities with an index of
peer keys could discover that the identity saved for the peer key does not match
the claimed identity.  Such an implementation could notice the disparity between
the actual keys (those copied from a victim) and the expected keys (those of the
attacker).<a class="pilcrow" href="#section-2.2-2">¶</a></p>
<p id="section-2.2-3">In comparison, implementations that first match based on peer identity could
treat an unknown key-share attack as though their peer had used a
newly configured device.  The apparent addition of a new device could generate
user-visible notices (e.g., "Mallory appears to have a new device").  However,
such an event is not always considered alarming; some implementations might
silently save a new key.<a class="pilcrow" href="#section-2.2-3">¶</a></p>
</section>
</div>
<div id="byebye-3pcc">
<section id="section-2.3">
        <h3 id="name-third-party-call-control">
<a class="section-number selfRef" href="#section-2.3">2.3. </a><a class="section-name selfRef" href="#name-third-party-call-control">Third-Party Call Control</a>
        </h3>
<p id="section-2.3-1">Third-party call control (3PCC) <span>[<a class="xref" href="#RFC3725">RFC3725</a>]</span> is a technique where a signaling
peer establishes a call that is terminated by a different entity.  An unknown
key-share attack is very similar in effect to some 3PCC practices, so use of
3PCC could appear to be an attack.  However, 3PCC that follows RFC 3725 guidance
is unaffected, and peers that are aware of changes made by a 3PCC controller can
correctly distinguish actions of a 3PCC controller from an attack.<a class="pilcrow" href="#section-2.3-1">¶</a></p>
<p id="section-2.3-2">3PCC as described in RFC 3725 is incompatible with SIP identity <span>[<a class="xref" href="#RFC8224">SIP-ID</a>]</span>, as
SIP Identity relies on creating a binding between SIP requests and SDP.  The
controller is the only entity that generates SIP requests in RFC 3725.
Therefore, in a 3PCC context, only the use of the <code>fingerprint</code> attribute
without additional bindings or WebRTC identity <span>[<a class="xref" href="#RFC8827">WEBRTC-SEC</a>]</span> is possible.<a class="pilcrow" href="#section-2.3-2">¶</a></p>
<p id="section-2.3-3">The attack mitigation mechanisms described in this document will prevent the use
of 3PCC if peers have different views of the involved identities or the value
of SDP <code>tls-id</code> attributes.<a class="pilcrow" href="#section-2.3-3">¶</a></p>
<p id="section-2.3-4">For 3PCC to work with the proposed mechanisms, TLS peers need to be aware of the
signaling so that they can correctly generate and check the TLS extensions.  For
a connection to be successfully established, a 3PCC controller needs either to
forward SDP without modification or to avoid modifications to <code>fingerprint</code>,
<code>tls-id</code>, and <code>identity</code> attributes.  A controller that follows the best
practices in RFC 3725 is expected to forward SDP without modification, thus
ensuring the integrity of these attributes.<a class="pilcrow" href="#section-2.3-4">¶</a></p>
</section>
</div>
</section>
</div>
<div id="id">
<section id="section-3">
      <h2 id="name-unknown-key-share-attack-wi">
<a class="section-number selfRef" href="#section-3">3. </a><a class="section-name selfRef" href="#name-unknown-key-share-attack-wi">Unknown Key-Share Attack with Identity Bindings</a>
      </h2>
<p id="section-3-1">The identity assertions used for WebRTC
(<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8827#section-7">Section 7</a> of [<a class="xref" href="#RFC8827">WEBRTC-SEC</a>]</span>) and the
Personal Assertion Token (PASSporT) used in SIP identity (<span>[<a class="xref" href="#RFC8224">SIP-ID</a>]</span>, <span>[<a class="xref" href="#RFC8225">PASSPORT</a>]</span>) are bound
to the certificate fingerprint of an endpoint.  An attacker can cause an identity
binding to be created that binds an identity they control to the fingerprint of
a first victim.<a class="pilcrow" href="#section-3-1">¶</a></p>
<p id="section-3-2">An attacker can thereby cause a second victim to believe that they are
communicating with an attacker-controlled identity, when they are really talking
to the first victim.  The attacker does this by creating an identity assertion
that covers a certificate fingerprint of the first victim.<a class="pilcrow" href="#section-3-2">¶</a></p>
<p id="section-3-3">A variation on the same technique can be used to cause both victims to
believe they are talking to the attacker when they are talking to each other.
In this case, the attacker performs the identity misbinding once for each
victim.<a class="pilcrow" href="#section-3-3">¶</a></p>
<p id="section-3-4">The authority certifying the identity binding is not required to
   verify that the entity requesting the binding actually controls the
   keys associated with the fingerprints, and this might appear to be
   the cause of the problem.  SIP and WebRTC identity providers are not
   required to perform this validation.<a class="pilcrow" href="#section-3-4">¶</a></p>
<p id="section-3-5">A simple solution to this problem is suggested by <span>[<a class="xref" href="#SIGMA">SIGMA</a>]</span>.  The identity of
endpoints is included under a message authentication code (MAC) during the
cryptographic handshake.  Endpoints then validate that their peer has provided
an identity that matches their expectations.  In TLS, the Finished message
provides a MAC over the entire handshake, so that including the identity in a
TLS extension is sufficient to implement this solution.<a class="pilcrow" href="#section-3-5">¶</a></p>
<p id="section-3-6">Rather than include a complete identity binding, which could be
sizable, a collision- and preimage-resistant hash of the binding is included
in a TLS extension as described in <a class="xref" href="#external_id_hash">Section 3.2</a>.  Endpoints then need
only validate that the extension contains a hash of the identity binding they
received in signaling.  If the identity binding is successfully validated, the
identity of a peer is verified and bound to the session.<a class="pilcrow" href="#section-3-6">¶</a></p>
<p id="section-3-7">This form of unknown key-share attack is possible without compromising signaling
integrity, unless the defenses described in <a class="xref" href="#fp">Section 4</a> are used.  In order to
prevent both forms of attack, endpoints <span class="bcp14">MUST</span> use the <code>external_session_id</code>
extension (see <a class="xref" href="#external_session_id">Section 4.3</a>) in addition to the <code>external_id_hash</code>
(<a class="xref" href="#external_id_hash">Section 3.2</a>) so that two calls between the same parties can't be
altered by an attacker.<a class="pilcrow" href="#section-3-7">¶</a></p>
<div id="id-example">
<section id="section-3.1">
        <h3 id="name-example">
<a class="section-number selfRef" href="#section-3.1">3.1. </a><a class="section-name selfRef" href="#name-example">Example</a>
        </h3>
<p id="section-3.1-1">In the example shown in <a class="xref" href="#identity-attack">Figure 1</a>, it is assumed that the attacker
also controls the signaling channel.<a class="pilcrow" href="#section-3.1-1">¶</a></p>
<p id="section-3.1-2">Mallory (the attacker) presents two victims, Norma and Patsy, with two separate
sessions.  In the first session, Norma is presented with the option to
communicate with Mallory; a second session with Norma is presented to Patsy.<a class="pilcrow" href="#section-3.1-2">¶</a></p>
<span id="name-example-attack-on-identity-"></span><div id="identity-attack">
<figure id="figure-1">
          <div class="artwork art-text alignLeft" id="section-3.1-3.1">
<pre>  Norma                   Mallory                   Patsy
  (fp=N)                   -----                    (fp=P)
    |                        |                        |
    |&lt;---- Signaling1 ------&gt;|                        |
    |   Norma=N Mallory=P    |                        |
    |                        |&lt;---- Signaling2 ------&gt;|
    |                        |   Norma=N Patsy=P      |
    |                                                 |
    |&lt;=================DTLS (fp=N,P)=================&gt;|
    |                                                 |
  (peer = Mallory!)                         (peer = Norma)
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-1">Figure 1</a>:
<a class="selfRef" href="#name-example-attack-on-identity-">Example Attack on Identity Bindings</a>
          </figcaption></figure>
</div>
<p id="section-3.1-4">The attack requires that Mallory obtain an identity binding for her own identity
with the fingerprints presented by Patsy (P), which Mallory might have obtained
previously.  This false binding is then presented to Norma ('Signaling1' in
<a class="xref" href="#identity-attack">Figure 1</a>).<a class="pilcrow" href="#section-3.1-4">¶</a></p>
<p id="section-3.1-5">Patsy could be similarly duped, but in this example, a correct binding between
Norma's identity and fingerprint (N) is faithfully presented by Mallory.  This
session ('Signaling2' in <a class="xref" href="#identity-attack">Figure 1</a>) can be entirely legitimate.<a class="pilcrow" href="#section-3.1-5">¶</a></p>
<p id="section-3.1-6">A DTLS session is established directly between Norma and Patsy.
   In order for this to happen, Mallory can substitute transport-level
   information in both sessions, though this is not necessary if Mallory
   is on the network path between Norma and Patsy.<a class="pilcrow" href="#section-3.1-6">¶</a></p>
<p id="section-3.1-7">As a result, Patsy correctly believes that she is communicating with Norma.
However, Norma incorrectly believes that she is talking to Mallory.  As stated in
<a class="xref" href="#uks">Section 2</a>, Mallory cannot access media, but Norma might send information to Patsy
that Norma might not intend or that Patsy might misinterpret.<a class="pilcrow" href="#section-3.1-7">¶</a></p>
</section>
</div>
<div id="external_id_hash">
<section id="section-3.2">
        <h3 id="name-the-external_id_hash-tls-ex">
<a class="section-number selfRef" href="#section-3.2">3.2. </a><a class="section-name selfRef" href="#name-the-external_id_hash-tls-ex">The <code>external_id_hash</code> TLS Extension</a>
        </h3>
<p id="section-3.2-1">The <code>external_id_hash</code> TLS extension carries a hash of the identity assertion
that the endpoint sending the extension has asserted to its peer.  Both peers
include a hash of their own identity assertion.<a class="pilcrow" href="#section-3.2-1">¶</a></p>
<p id="section-3.2-2">The <code>extension_data</code> for the <code>external_id_hash</code> extension contains a
<code>ExternalIdentityHash</code> struct, described below using the syntax defined in
<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8446#section-3">Section 3</a> of [<a class="xref" href="#RFC8446">TLS13</a>]</span>:<a class="pilcrow" href="#section-3.2-2">¶</a></p>
<div id="section-3.2-3">
<pre class="sourcecode lang-tls-presentation">   struct {
      opaque binding_hash&lt;0..32&gt;;
   } ExternalIdentityHash;
</pre><a class="pilcrow" href="#section-3.2-3">¶</a>
</div>
<p id="section-3.2-4">Where an identity assertion has been asserted by a peer, this extension includes
a SHA-⁠256 hash of the assertion.  An empty value is used to indicate support for
the extension.<a class="pilcrow" href="#section-3.2-4">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.2-5">
          <dt id="section-3.2-5.1">Note:</dt>
          <dd id="section-3.2-5.2" style="margin-left: 1.5em">
  For both types of identity assertion, if SHA-⁠256 should prove to be inadequate
in the future (see <span>[<a class="xref" href="#RFC7696">AGILITY</a>]</span>), a new TLS extension
that uses a different hash function can be defined.<a class="pilcrow" href="#section-3.2-5.2">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-3.2-6">Identity bindings might be provided by only one peer.  An endpoint that does not
produce an identity binding <span class="bcp14">MUST</span> generate an empty <code>external_id_hash</code> extension
in its ClientHello or -- if a client provides the extension -- in ServerHello or
EncryptedExtensions.  An empty extension has a zero-length <code>binding_hash</code> field.<a class="pilcrow" href="#section-3.2-6">¶</a></p>
<p id="section-3.2-7">A peer that receives an <code>external_id_hash</code> extension that does not match the
value of the identity binding from its peer <span class="bcp14">MUST</span> immediately fail the TLS
handshake with an <code>illegal_parameter</code> alert.  The absence of an identity binding
does not relax this requirement; if a peer provided no identity binding, a
zero-length extension <span class="bcp14">MUST</span> be present to be considered valid.<a class="pilcrow" href="#section-3.2-7">¶</a></p>
<p id="section-3.2-8">Implementations written prior to the definition of the extensions in this
document will not support this extension for some time.  A peer that receives an
identity binding but does not receive an <code>external_id_hash</code> extension <span class="bcp14">MAY</span> accept
a TLS connection rather than fail a connection where the extension is absent.<a class="pilcrow" href="#section-3.2-8">¶</a></p>
<p id="section-3.2-9">
   The endpoint performs the validation of the <code>external_id_hash</code> extension
   in addition to the validation required by <span>[<a class="xref" href="#RFC8122">FINGERPRINT</a>]</span> and any verification
   of the identity assertion <span>[<a class="xref" href="#RFC8827">WEBRTC-SEC</a>]</span> <span>[<a class="xref" href="#RFC8224">SIP-ID</a>]</span>.
   An endpoint <span class="bcp14">MUST</span> validate any external_session_id value that is present; see <a class="xref" href="#external_session_id">Section 4.3</a>.<a class="pilcrow" href="#section-3.2-9">¶</a></p>
<p id="section-3.2-10">An <code>external_id_hash</code> extension with a <code>binding_hash</code> field
that is any length other than 0 or 32 is invalid
and <span class="bcp14">MUST</span> cause the receiving endpoint to generate a fatal <code>decode_error</code> alert.<a class="pilcrow" href="#section-3.2-10">¶</a></p>
<p id="section-3.2-11">In TLS 1.3, an <code>external_id_hash</code> extension sent by a server <span class="bcp14">MUST</span> be sent in the
EncryptedExtensions message.<a class="pilcrow" href="#section-3.2-11">¶</a></p>
<div id="calculating-externalidhash-for-webrtc-identity">
<section id="section-3.2.1">
          <h4 id="name-calculating-external_id_has">
<a class="section-number selfRef" href="#section-3.2.1">3.2.1. </a><a class="section-name selfRef" href="#name-calculating-external_id_has">Calculating <code>external_id_hash</code> for WebRTC Identity</a>
          </h4>
<p id="section-3.2.1-1">A WebRTC identity assertion
(<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8827#section-7">Section 7</a> of [<a class="xref" href="#RFC8827">WEBRTC-SEC</a>]</span>) is provided as a JSON
<span>[<a class="xref" href="#RFC8259">JSON</a>]</span> object that is encoded into a JSON text.  The JSON text is
encoded using UTF-8 <span>[<a class="xref" href="#RFC3629">UTF8</a>]</span> as described by
<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8259#section-8.1">Section 8.1</a> of [<a class="xref" href="#RFC8259">JSON</a>]</span>.
The content of the <code>external_id_hash</code> extension is produced by hashing the
resulting octets with SHA-⁠256 <span>[<a class="xref" href="#RFC6234">SHA</a>]</span>.  This produces the 32 octets of
the <code>binding_hash</code> parameter, which is the sole contents of the extension.<a class="pilcrow" href="#section-3.2.1-1">¶</a></p>
<p id="section-3.2.1-2">The SDP <code>identity</code> attribute includes the base64 <span>[<a class="xref" href="#RFC4648">BASE64</a>]</span> encoding of
the UTF-8 encoding of the same JSON text.  The <code>external_id_hash</code> extension is
validated by performing base64 decoding on the value of the SDP <code>identity</code>
attribute, hashing the resulting octets using SHA-⁠256, and comparing the results
with the content of the extension.  In pseudocode form, using the
<code>identity-assertion-value</code> field from the SDP <code>identity</code> attribute grammar as
defined in <span>[<a class="xref" href="#RFC8827">WEBRTC-SEC</a>]</span>:<a class="pilcrow" href="#section-3.2.1-2">¶</a></p>
<div id="section-3.2.1-3">
<pre class="sourcecode lang-pseudocode">external_id_hash = SHA-256(b64decode(identity-assertion-value))
</pre><a class="pilcrow" href="#section-3.2.1-3">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-3.2.1-4">
            <dt id="section-3.2.1-4.1">Note:</dt>
            <dd id="section-3.2.1-4.2" style="margin-left: 1.5em">
  The base64 of the SDP <code>identity</code> attribute is decoded to avoid capturing
variations in padding.  The base64-decoded identity assertion could include
leading or trailing whitespace octets.  WebRTC identity assertions are not
canonicalized; all octets are hashed.<a class="pilcrow" href="#section-3.2.1-4.2">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="calculating-externalidhash-for-passport">
<section id="section-3.2.2">
          <h4 id="name-calculating-external_id_hash">
<a class="section-number selfRef" href="#section-3.2.2">3.2.2. </a><a class="section-name selfRef" href="#name-calculating-external_id_hash">Calculating external_id_hash for PASSporT</a>
          </h4>
<p id="section-3.2.2-1">Where the compact form of PASSporT <span>[<a class="xref" href="#RFC8225">PASSPORT</a>]</span>
is used, it <span class="bcp14">MUST</span> be expanded
into the full form.  The base64 encoding used in the SIP Identity (or 'y')
header field <span class="bcp14">MUST</span> be decoded then used as input to SHA-⁠256.  This produces the
32-octet <code>binding_hash</code> value used for creating or validating the extension.  In
pseudocode, using the <code>signed-identity-digest</code> parameter from the <code>Identity</code> header field grammar
defined <span>[<a class="xref" href="#RFC8224">SIP-ID</a>]</span>:<a class="pilcrow" href="#section-3.2.2-1">¶</a></p>
<div id="section-3.2.2-2">
<pre class="sourcecode lang-pseudocode">external_id_hash = SHA-256(b64decode(signed-identity-digest))
</pre><a class="pilcrow" href="#section-3.2.2-2">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="fp">
<section id="section-4">
      <h2 id="name-unknown-key-share-attack-wit">
<a class="section-number selfRef" href="#section-4">4. </a><a class="section-name selfRef" href="#name-unknown-key-share-attack-wit">Unknown Key-Share Attack with Fingerprints</a>
      </h2>
<p id="section-4-1">An attack on DTLS-SRTP is possible because the identity of peers involved is not
established prior to establishing the call.  Endpoints use certificate
fingerprints as a proxy for authentication, but as long as fingerprints are used
in multiple calls, they are vulnerable to attack.<a class="pilcrow" href="#section-4-1">¶</a></p>
<p id="section-4-2">Even if the integrity of session signaling can be relied upon, an attacker might
still be able to create a session where there is confusion about the
communicating endpoints by substituting the fingerprint of a communicating
endpoint.<a class="pilcrow" href="#section-4-2">¶</a></p>
<p id="section-4-3">An endpoint that is configured to reuse a certificate can be attacked if it is
willing to initiate two calls at the same time, one of which is with an
attacker.  The attacker can arrange for the victim to incorrectly believe that
it is calling the attacker when it is in fact calling a second party.  The
second party correctly believes that it is talking to the victim.<a class="pilcrow" href="#section-4-3">¶</a></p>
<p id="section-4-4">As with the attack on identity bindings, this can be used to cause two victims
to both believe they are talking to the attacker when they are talking to each
other.<a class="pilcrow" href="#section-4-4">¶</a></p>
<div id="fp-example">
<section id="section-4.1">
        <h3 id="name-example-2">
<a class="section-number selfRef" href="#section-4.1">4.1. </a><a class="section-name selfRef" href="#name-example-2">Example</a>
        </h3>
<p id="section-4.1-1">To mount this attack, two sessions need to be created with the same endpoint at
almost precisely the same time.  One of those sessions is initiated with the
attacker, the second session is created toward another honest endpoint.  The
attacker convinces the first endpoint that their session with the attacker has
been successfully established, but media is exchanged with the other honest
endpoint.  The attacker permits the session with the other honest endpoint to
complete only to the extent necessary to convince the other honest endpoint to
participate in the attacked session.<a class="pilcrow" href="#section-4.1-1">¶</a></p>
<p id="section-4.1-2">In addition to the constraints described in <a class="xref" href="#limits">Section 2.1</a>, the attacker in this
example also needs the ability to view and drop packets between victims.
That is, the attacker needs to be on path for media.<a class="pilcrow" href="#section-4.1-2">¶</a></p>
<p id="section-4.1-3">The attack shown in <a class="xref" href="#implausible-attack">Figure 2</a> depends on a somewhat implausible set
of conditions.  It is intended to demonstrate what sort of attack is possible
and what conditions are necessary to exploit this weakness in the protocol.<a class="pilcrow" href="#section-4.1-3">¶</a></p>
<span id="name-example-attack-scenario-usi"></span><div id="implausible-attack">
<figure id="figure-2">
          <div class="artwork art-text alignLeft" id="section-4.1-4.1">
<pre>  Norma                   Mallory                 Patsy
  (fp=N)                   -----                  (fp=P)
    |                        |                      |
    +---Signaling1 (fp=N)---&gt;|                      |
    +-----Signaling2 (fp=N)------------------------&gt;|
    |&lt;-------------------------Signaling2 (fp=P)----+
    |&lt;---Signaling1 (fp=P)---+                      |
    |                        |                      |
    |=======DTLS1=======&gt;(Forward)======DTLS1======&gt;|
    |&lt;======DTLS2========(Forward)&lt;=====DTLS2=======|
    |=======Media1======&gt;(Forward)======Media1=====&gt;|
    |&lt;======Media2=======(Forward)&lt;=====Media2======|
    |                       |                       |
    |=======DTLS2========&gt;(Drop)                    |
    |                       |                       |
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-2">Figure 2</a>:
<a class="selfRef" href="#name-example-attack-scenario-usi">Example Attack Scenario Using Fingerprints</a>
          </figcaption></figure>
</div>
<p id="section-4.1-5">In this scenario, there are two sessions initiated at the same time by Norma.
Signaling is shown with single lines ('-'), DTLS and media with double lines
('=').<a class="pilcrow" href="#section-4.1-5">¶</a></p>
<p id="section-4.1-6">The first session is established with Mallory, who falsely uses Patsy's
certificate fingerprint (denoted with 'fp=P').  A second session is initiated
between Norma and Patsy.  Signaling for both sessions is permitted to complete.<a class="pilcrow" href="#section-4.1-6">¶</a></p>
<p id="section-4.1-7">Once signaling is complete on the first session, a DTLS connection is
established. Ostensibly, this connection is between Mallory and Norma, but
Mallory forwards DTLS and media packets sent to her by Norma to Patsy.  These
packets are denoted 'DTLS1' because Norma associates these with the first
signaling session ('Signaling1').<a class="pilcrow" href="#section-4.1-7">¶</a></p>
<p id="section-4.1-8">Mallory also intercepts packets from Patsy and forwards those to Norma at the
transport address that Norma associates with Mallory.  These packets are denoted
'DTLS2' to indicate that Patsy associates these with the second signaling
session ('Signaling2'); however, Norma will interpret these as being associated
with the first signaling session ('Signaling1').<a class="pilcrow" href="#section-4.1-8">¶</a></p>
<p id="section-4.1-9">The second signaling exchange ('Signaling2'), which is between Norma and Patsy, is
permitted to continue to the point where Patsy believes that it has succeeded.
This ensures that Patsy believes that she is communicating with Norma.  In the
end, Norma believes that she is communicating with Mallory, when she is really
communicating with Patsy.  Just like the example in <a class="xref" href="#id-example">Section 3.1</a>, Mallory
cannot access media, but Norma might send information to Patsy that Norma
might not intend or that Patsy might misinterpret.<a class="pilcrow" href="#section-4.1-9">¶</a></p>
<p id="section-4.1-10">Though Patsy needs to believe that the second signaling session has been
successfully established, Mallory has no real interest in seeing that session
also be established.  Mallory only needs to ensure that Patsy maintains the
active session and does not abandon the session prematurely.  For this reason,
it might be necessary to permit the signaling from Patsy to reach Norma in order to allow
Patsy to receive a call setup completion signal, such as a SIP ACK.  Once the
second session is established, Mallory might cause DTLS packets sent by Norma to
Patsy to be dropped.  However, if Mallory allows DTLS packets to pass, it is
likely that Patsy will discard them as Patsy will already have a successful DTLS
connection established.<a class="pilcrow" href="#section-4.1-10">¶</a></p>
<p id="section-4.1-11">For the attacked session to be sustained beyond the point that Norma detects
errors in the second session, Mallory also needs to block any signaling that
Norma might send to Patsy asking for the call to be abandoned.  Otherwise, Patsy
might receive a notice that the call has failed and thereby abort the call.<a class="pilcrow" href="#section-4.1-11">¶</a></p>
<p id="section-4.1-12">This attack creates an asymmetry in the beliefs about the identity of peers.
However, this attack is only possible if the victim (Norma) is willing to
conduct two sessions nearly simultaneously; if the attacker (Mallory) is on the
network path between the victims; and if the same certificate -- and therefore
the SDP <code>fingerprint</code> attribute value -- is used by Norma for both sessions.<a class="pilcrow" href="#section-4.1-12">¶</a></p>
<p id="section-4.1-13">Where Interactive Connectivity Establishment (ICE) <span>[<a class="xref" href="#RFC8445">ICE</a>]</span>
is used, Mallory also needs to ensure that
connectivity checks between Patsy and Norma succeed, either by forwarding checks
or by answering and generating the necessary messages.<a class="pilcrow" href="#section-4.1-13">¶</a></p>
</section>
</div>
<div id="sess-id">
<section id="section-4.2">
        <h3 id="name-unique-session-identity-sol">
<a class="section-number selfRef" href="#section-4.2">4.2. </a><a class="section-name selfRef" href="#name-unique-session-identity-sol">Unique Session Identity Solution</a>
        </h3>
<p id="section-4.2-1">The solution to this problem is to assign a new identifier to communicating
peers.  Each endpoint assigns their peer a unique identifier during call
signaling.  The peer echoes that identifier in the TLS handshake, binding that
identity into the session.  Including this new identity in the TLS handshake
means that it will be covered by the TLS Finished message, which is necessary to
authenticate it (see <span>[<a class="xref" href="#SIGMA">SIGMA</a>]</span>).<a class="pilcrow" href="#section-4.2-1">¶</a></p>
<p id="section-4.2-2">Successfully validating that the identifier matches the expected value means that
the connection corresponds to the signaled session and is therefore established
between the correct two endpoints.<a class="pilcrow" href="#section-4.2-2">¶</a></p>
<p id="section-4.2-3">This solution relies on the unique identifier given to DTLS sessions using the
SDP <code>tls-id</code> attribute <span>[<a class="xref" href="#RFC8842">DTLS-SDP</a>]</span>.  This field is
already required to be unique.  Thus, no two offers or answers from the same
client will have the same value.<a class="pilcrow" href="#section-4.2-3">¶</a></p>
<p id="section-4.2-4">A new <code>external_session_id</code> extension is added to the TLS or DTLS handshake for
connections that are established as part of the same call or real-time session.
This carries the value of the <code>tls-id</code> attribute and provides integrity
protection for its exchange as part of the TLS or DTLS handshake.<a class="pilcrow" href="#section-4.2-4">¶</a></p>
</section>
</div>
<div id="external_session_id">
<section id="section-4.3">
        <h3 id="name-the-external_session_id-tls">
<a class="section-number selfRef" href="#section-4.3">4.3. </a><a class="section-name selfRef" href="#name-the-external_session_id-tls">The external_session_id TLS Extension</a>
        </h3>
<p id="section-4.3-1">The <code>external_session_id</code> TLS extension carries the unique identifier that an
endpoint selects.  When used with SDP, the value <span class="bcp14">MUST</span> include the <code>tls-id</code>
attribute from the SDP that the endpoint generated when negotiating the session.
This document only defines use of this extension for SDP; other methods of
external session negotiation can use this extension to include a unique session
identifier.<a class="pilcrow" href="#section-4.3-1">¶</a></p>
<p id="section-4.3-2">The <code>extension_data</code> for the <code>external_session_id</code> extension contains an
ExternalSessionId struct, described below using the syntax defined in
<span>[<a class="xref" href="#RFC8446">TLS13</a>]</span>:<a class="pilcrow" href="#section-4.3-2">¶</a></p>
<div id="section-4.3-3">
<pre class="sourcecode lang-tls-presentation">   struct {
      opaque session_id&lt;20..255&gt;;
   } ExternalSessionId;
</pre><a class="pilcrow" href="#section-4.3-3">¶</a>
</div>
<p id="section-4.3-4">For SDP, the <code>session_id</code> field of the extension includes the value of the
<code>tls-id</code> SDP attribute as defined in <span>[<a class="xref" href="#RFC8842">DTLS-SDP</a>]</span>
(that is, the <code>tls-id-value</code> ABNF production).  The value of the <code>tls-id</code>
attribute is encoded using ASCII <span>[<a class="xref" href="#RFC0020">ASCII</a>]</span>.<a class="pilcrow" href="#section-4.3-4">¶</a></p>
<p id="section-4.3-5">Where RTP and RTCP <span>[<a class="xref" href="#RFC3550">RTP</a>]</span> are not multiplexed, it is possible that the
two separate DTLS connections carrying RTP and RTCP can be switched.  This is
considered benign since these protocols are designed to be distinguishable as
SRTP <span>[<a class="xref" href="#RFC3711">SRTP</a>]</span> provides key separation.  Using RTP/RTCP multiplexing
<span>[<a class="xref" href="#RFC5761">RTCP-MUX</a>]</span> further avoids this problem.<a class="pilcrow" href="#section-4.3-5">¶</a></p>
<p id="section-4.3-6">The <code>external_session_id</code> extension is included in a ClientHello, and if the
extension is present in the ClientHello, either ServerHello (for TLS and DTLS
versions older than 1.3) or EncryptedExtensions (for TLS 1.3).<a class="pilcrow" href="#section-4.3-6">¶</a></p>
<p id="section-4.3-7">Endpoints <span class="bcp14">MUST</span> check that the <code>session_id</code> parameter in the extension that they
receive includes the <code>tls-id</code> attribute value that they received in their peer's
session description.  Endpoints can perform string comparison by ASCII decoding
the TLS extension value and comparing it to the SDP attribute value or by comparing
the encoded TLS extension octets with the encoded SDP attribute value.  An
endpoint that receives an <code>external_session_id</code> extension that is not identical
to the value that it expects <span class="bcp14">MUST</span> abort the connection with a fatal
<code>illegal_parameter</code> alert.<a class="pilcrow" href="#section-4.3-7">¶</a></p>
<p id="section-4.3-8">
   The endpoint performs the validation of the <code>external_id_hash</code> extension in
   addition to the validation required by <span>[<a class="xref" href="#RFC8122">FINGERPRINT</a>]</span>.<a class="pilcrow" href="#section-4.3-8">¶</a></p>
<p id="section-4.3-9">If an endpoint communicates with a peer that does not support this
extension, it will receive a ClientHello, ServerHello, or EncryptedExtensions message that
does not include this extension.  An endpoint <span class="bcp14">MAY</span> choose to continue a session
without this extension in order to interoperate with peers that do not implement
this specification.<a class="pilcrow" href="#section-4.3-9">¶</a></p>
<p id="section-4.3-10">In TLS 1.3, an <code>external_session_id</code> extension sent by a server <span class="bcp14">MUST</span> be sent in
the EncryptedExtensions message.<a class="pilcrow" href="#section-4.3-10">¶</a></p>
<p id="section-4.3-11">This defense is not effective if an attacker can rewrite <code>tls-id</code> values in
signaling.  Only the mechanism in <code>external_id_hash</code> is able to defend against
an attacker that can compromise session integrity.<a class="pilcrow" href="#section-4.3-11">¶</a></p>
</section>
</div>
</section>
</div>
<div id="concat">
<section id="section-5">
      <h2 id="name-session-concatenation">
<a class="section-number selfRef" href="#section-5">5. </a><a class="section-name selfRef" href="#name-session-concatenation">Session Concatenation</a>
      </h2>
<p id="section-5-1">Use of session identifiers does not prevent an attacker from
establishing two concurrent sessions with different peers and
forwarding signaling from those peers to each other.  Concatenating
two signaling sessions in this way creates two signaling sessions,
with two session identifiers, but only the TLS connections from a
single session are established as a result.  In doing so, the
attacker creates a situation where both peers believe that they are
talking to the attacker when they are talking to each other.<a class="pilcrow" href="#section-5-1">¶</a></p>
<p id="section-5-2">In the absence of any higher-level concept of peer identity, an
attacker who is able to copy the session identifier from
one signaling session to another can cause the peers to establish a
direct TLS connection even while they think that they are connecting
to the attacker. This differs from the attack described in the
previous section in that there is only one TLS connection rather than
two.  This kind of attack is prevented by systems that enable peer
authentication, such as WebRTC identity <span>[<a class="xref" href="#RFC8827">WEBRTC-SEC</a>]</span> or SIP identity
<span>[<a class="xref" href="#RFC8224">SIP-ID</a>]</span>; however, these systems do not prevent establishing
two back-to-back connections as described in the previous paragraph.<a class="pilcrow" href="#section-5-2">¶</a></p>
<p id="section-5-3">Use of the <code>external_session_id</code> does not guarantee that the identity of the
peer at the TLS layer is the same as the identity of the signaling peer.  The
advantage that an attacker gains by concatenating sessions is limited unless data is
exchanged based on the assumption that signaling and TLS peers are the same.  If a
secondary protocol uses the signaling channel with the assumption that the
signaling and TLS peers are the same, then that protocol is vulnerable to attack.
While out of scope for this document, a signaling system that can defend against session concatenation
requires that the signaling layer is authenticated and bound to any TLS connections.<a class="pilcrow" href="#section-5-3">¶</a></p>
<p id="section-5-4">It is important to note that multiple connections can be created within the same
signaling session.  An attacker might concatenate only part of a session,
choosing to terminate some connections (and optionally forward data) while
arranging to have peers interact directly for other connections.  It is even
possible to have different peers interact for each connection.  This means that
the actual identity of the peer for one connection might differ from the peer on
another connection.<a class="pilcrow" href="#section-5-4">¶</a></p>
<p id="section-5-5">Critically, information about the identity of TLS peers provides no assurances
about the identity of signaling peers and does not transfer between TLS
connections in the same session.  Information extracted from a TLS connection
therefore <span class="bcp14">MUST NOT</span> be used in a secondary protocol outside of that connection if
that protocol assumes that the signaling protocol has the same peers.
Similarly, security-sensitive information from one TLS connection <span class="bcp14">MUST NOT</span> be
used in other TLS connections even if they are established as a result of the
same signaling session.<a class="pilcrow" href="#section-5-5">¶</a></p>
</section>
</div>
<div id="security-considerations">
<section id="section-6">
      <h2 id="name-security-considerations">
<a class="section-number selfRef" href="#section-6">6. </a><a class="section-name selfRef" href="#name-security-considerations">Security Considerations</a>
      </h2>
<p id="section-6-1">When combined with identity assertions, the mitigations in this document ensure
that there is no opportunity to misrepresent the identity of TLS peers.  This
assurance is provided even if an attacker can modify signaling messages.<a class="pilcrow" href="#section-6-1">¶</a></p>
<p id="section-6-2">Without identity assertions, the mitigations in this document prevent the
session splicing attack described in <a class="xref" href="#fp">Section 4</a>.  Defense against session
concatenation (<a class="xref" href="#concat">Section 5</a>) additionally requires that protocol peers are not able to
claim the certificate fingerprints of other entities.<a class="pilcrow" href="#section-6-2">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-7">
      <h2 id="name-iana-considerations">
<a class="section-number selfRef" href="#section-7">7. </a><a class="section-name selfRef" href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<p id="section-7-1">This document registers two extensions in the "TLS ExtensionType Values"
registry established in <span>[<a class="xref" href="#RFC8446">TLS13</a>]</span>:<a class="pilcrow" href="#section-7-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7-2.1">The <code>external_id_hash</code> extension defined in <a class="xref" href="#external_id_hash">Section 3.2</a> has been
assigned a code point of 55; it is recommended and is marked as "CH, EE"
in TLS 1.3.<a class="pilcrow" href="#section-7-2.1">¶</a>
</li>
        <li class="normal" id="section-7-2.2">The <code>external_session_id</code> extension defined in <a class="xref" href="#external_session_id">Section 4.3</a> has
been assigned a code point of 56; it is recommended and is marked as
"CH, EE" in TLS 1.3.<a class="pilcrow" href="#section-7-2.2">¶</a>
</li>
      </ul>
</section>
</div>
<section id="section-8">
      <h2 id="name-references">
<a class="section-number selfRef" href="#section-8">8. </a><a class="section-name selfRef" href="#name-references">References</a>
      </h2>
<section id="section-8.1">
        <h3 id="name-normative-references">
<a class="section-number selfRef" href="#section-8.1">8.1. </a><a class="section-name selfRef" href="#name-normative-references">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC0020">[ASCII]</dt>
        <dd>
<span class="refAuthor">Cerf, V.</span>, <span class="refTitle">"ASCII format for network interchange"</span>, <span class="seriesInfo">STD 80</span>, <span class="seriesInfo">RFC 20</span>, <span class="seriesInfo">DOI 10.17487/RFC0020</span>, <time class="refDate" datetime="1969-10">October 1969</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc20">https://www.rfc-editor.org/info/rfc20</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4648">[BASE64]</dt>
        <dd>
<span class="refAuthor">Josefsson, S.</span>, <span class="refTitle">"The Base16, Base32, and Base64 Data Encodings"</span>, <span class="seriesInfo">RFC 4648</span>, <span class="seriesInfo">DOI 10.17487/RFC4648</span>, <time class="refDate" datetime="2006-10">October 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4648">https://www.rfc-editor.org/info/rfc4648</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6347">[DTLS]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span><span class="refAuthor"> and N. Modadugu</span>, <span class="refTitle">"Datagram Transport Layer Security Version 1.2"</span>, <span class="seriesInfo">RFC 6347</span>, <span class="seriesInfo">DOI 10.17487/RFC6347</span>, <time class="refDate" datetime="2012-01">January 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6347">https://www.rfc-editor.org/info/rfc6347</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8842">[DTLS-SDP]</dt>
        <dd>
<span class="refAuthor">Holmberg, C.</span><span class="refAuthor"> and R. Shpount</span>, <span class="refTitle">"Session Description Protocol (SDP) Offer/Answer Considerations for Datagram Transport Layer Security (DTLS) and Transport Layer Security (TLS)"</span>, <span class="seriesInfo">RFC 8842</span>, <span class="seriesInfo">DOI 10.17487/RFC8842</span>, <time class="refDate" datetime="2021-01">January 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8842">https://www.rfc-editor.org/info/rfc8842</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5763">[DTLS-SRTP]</dt>
        <dd>
<span class="refAuthor">Fischl, J.</span><span class="refAuthor">, Tschofenig, H.</span><span class="refAuthor">, and E. Rescorla</span>, <span class="refTitle">"Framework for Establishing a Secure Real-time Transport Protocol (SRTP) Security Context Using Datagram Transport Layer Security (DTLS)"</span>, <span class="seriesInfo">RFC 5763</span>, <span class="seriesInfo">DOI 10.17487/RFC5763</span>, <time class="refDate" datetime="2010-05">May 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5763">https://www.rfc-editor.org/info/rfc5763</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8122">[FINGERPRINT]</dt>
        <dd>
<span class="refAuthor">Lennox, J.</span><span class="refAuthor"> and C. Holmberg</span>, <span class="refTitle">"Connection-Oriented Media Transport over the Transport Layer Security (TLS) Protocol in the Session Description Protocol (SDP)"</span>, <span class="seriesInfo">RFC 8122</span>, <span class="seriesInfo">DOI 10.17487/RFC8122</span>, <time class="refDate" datetime="2017-03">March 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8122">https://www.rfc-editor.org/info/rfc8122</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8259">[JSON]</dt>
        <dd>
<span class="refAuthor">Bray, T., Ed.</span>, <span class="refTitle">"The JavaScript Object Notation (JSON) Data Interchange Format"</span>, <span class="seriesInfo">STD 90</span>, <span class="seriesInfo">RFC 8259</span>, <span class="seriesInfo">DOI 10.17487/RFC8259</span>, <time class="refDate" datetime="2017-12">December 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8259">https://www.rfc-editor.org/info/rfc8259</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8225">[PASSPORT]</dt>
        <dd>
<span class="refAuthor">Wendt, C.</span><span class="refAuthor"> and J. Peterson</span>, <span class="refTitle">"PASSporT: Personal Assertion Token"</span>, <span class="seriesInfo">RFC 8225</span>, <span class="seriesInfo">DOI 10.17487/RFC8225</span>, <time class="refDate" datetime="2018-02">February 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8225">https://www.rfc-editor.org/info/rfc8225</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time class="refDate" datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time class="refDate" datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4566">[SDP]</dt>
        <dd>
<span class="refAuthor">Handley, M.</span><span class="refAuthor">, Jacobson, V.</span><span class="refAuthor">, and C. Perkins</span>, <span class="refTitle">"SDP: Session Description Protocol"</span>, <span class="seriesInfo">RFC 4566</span>, <span class="seriesInfo">DOI 10.17487/RFC4566</span>, <time class="refDate" datetime="2006-07">July 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4566">https://www.rfc-editor.org/info/rfc4566</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6234">[SHA]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span><span class="refAuthor"> and T. Hansen</span>, <span class="refTitle">"US Secure Hash Algorithms (SHA and SHA-based HMAC and HKDF)"</span>, <span class="seriesInfo">RFC 6234</span>, <span class="seriesInfo">DOI 10.17487/RFC6234</span>, <time class="refDate" datetime="2011-05">May 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6234">https://www.rfc-editor.org/info/rfc6234</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8224">[SIP-ID]</dt>
        <dd>
<span class="refAuthor">Peterson, J.</span><span class="refAuthor">, Jennings, C.</span><span class="refAuthor">, Rescorla, E.</span><span class="refAuthor">, and C. Wendt</span>, <span class="refTitle">"Authenticated Identity Management in the Session Initiation Protocol (SIP)"</span>, <span class="seriesInfo">RFC 8224</span>, <span class="seriesInfo">DOI 10.17487/RFC8224</span>, <time class="refDate" datetime="2018-02">February 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8224">https://www.rfc-editor.org/info/rfc8224</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3711">[SRTP]</dt>
        <dd>
<span class="refAuthor">Baugher, M.</span><span class="refAuthor">, McGrew, D.</span><span class="refAuthor">, Naslund, M.</span><span class="refAuthor">, Carrara, E.</span><span class="refAuthor">, and K. Norrman</span>, <span class="refTitle">"The Secure Real-time Transport Protocol (SRTP)"</span>, <span class="seriesInfo">RFC 3711</span>, <span class="seriesInfo">DOI 10.17487/RFC3711</span>, <time class="refDate" datetime="2004-03">March 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3711">https://www.rfc-editor.org/info/rfc3711</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[TLS13]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time class="refDate" datetime="2018-08">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3629">[UTF8]</dt>
        <dd>
<span class="refAuthor">Yergeau, F.</span>, <span class="refTitle">"UTF-8, a transformation format of ISO 10646"</span>, <span class="seriesInfo">STD 63</span>, <span class="seriesInfo">RFC 3629</span>, <span class="seriesInfo">DOI 10.17487/RFC3629</span>, <time class="refDate" datetime="2003-11">November 2003</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3629">https://www.rfc-editor.org/info/rfc3629</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8827">[WEBRTC-SEC]</dt>
      <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"WebRTC Security Architecture"</span>, <span class="seriesInfo">RFC 8827</span>, <span class="seriesInfo">DOI 10.17487/RFC8827</span>, <time class="refDate" datetime="2021-01">January 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8827">https://www.rfc-editor.org/info/rfc8827</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-8.2">
        <h3 id="name-informative-references">
<a class="section-number selfRef" href="#section-8.2">8.2. </a><a class="section-name selfRef" href="#name-informative-references">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC7696">[AGILITY]</dt>
        <dd>
<span class="refAuthor">Housley, R.</span>, <span class="refTitle">"Guidelines for Cryptographic Algorithm Agility and Selecting Mandatory-to-Implement Algorithms"</span>, <span class="seriesInfo">BCP 201</span>, <span class="seriesInfo">RFC 7696</span>, <span class="seriesInfo">DOI 10.17487/RFC7696</span>, <time class="refDate" datetime="2015-11">November 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7696">https://www.rfc-editor.org/info/rfc7696</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8445">[ICE]</dt>
        <dd>
<span class="refAuthor">Keranen, A.</span><span class="refAuthor">, Holmberg, C.</span><span class="refAuthor">, and J. Rosenberg</span>, <span class="refTitle">"Interactive Connectivity Establishment (ICE): A Protocol for Network Address Translator (NAT) Traversal"</span>, <span class="seriesInfo">RFC 8445</span>, <span class="seriesInfo">DOI 10.17487/RFC8445</span>, <time class="refDate" datetime="2018-07">July 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8445">https://www.rfc-editor.org/info/rfc8445</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3725">[RFC3725]</dt>
        <dd>
<span class="refAuthor">Rosenberg, J.</span><span class="refAuthor">, Peterson, J.</span><span class="refAuthor">, Schulzrinne, H.</span><span class="refAuthor">, and G. Camarillo</span>, <span class="refTitle">"Best Current Practices for Third Party Call Control (3pcc) in the Session Initiation Protocol (SIP)"</span>, <span class="seriesInfo">BCP 85</span>, <span class="seriesInfo">RFC 3725</span>, <span class="seriesInfo">DOI 10.17487/RFC3725</span>, <time class="refDate" datetime="2004-04">April 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3725">https://www.rfc-editor.org/info/rfc3725</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5761">[RTCP-MUX]</dt>
        <dd>
<span class="refAuthor">Perkins, C.</span><span class="refAuthor"> and M. Westerlund</span>, <span class="refTitle">"Multiplexing RTP Data and Control Packets on a Single Port"</span>, <span class="seriesInfo">RFC 5761</span>, <span class="seriesInfo">DOI 10.17487/RFC5761</span>, <time class="refDate" datetime="2010-04">April 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5761">https://www.rfc-editor.org/info/rfc5761</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3550">[RTP]</dt>
        <dd>
<span class="refAuthor">Schulzrinne, H.</span><span class="refAuthor">, Casner, S.</span><span class="refAuthor">, Frederick, R.</span><span class="refAuthor">, and V. Jacobson</span>, <span class="refTitle">"RTP: A Transport Protocol for Real-Time Applications"</span>, <span class="seriesInfo">STD 64</span>, <span class="seriesInfo">RFC 3550</span>, <span class="seriesInfo">DOI 10.17487/RFC3550</span>, <time class="refDate" datetime="2003-07">July 2003</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3550">https://www.rfc-editor.org/info/rfc3550</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SIGMA">[SIGMA]</dt>
        <dd>
<span class="refAuthor">Krawczyk, H.</span>, <span class="refTitle">"SIGMA: The 'SIGn-and-MAc' Approach to Authenticated Diffie-Hellman and Its Use in the IKE Protocols"</span>, <span class="refContent">Advances in Cryptology -- CRYPTO 2003</span>, <span class="refContent">Lecture Notes in Computer Science</span>, <span class="refContent">Vol. 2729</span>, <span class="seriesInfo">DOI 10.1007/978-3-540-45146-4_24</span>, <time class="refDate" datetime="2003-08">August 2003</time>, <span>&lt;<a href="https://doi.org/10.1007/978-3-540-45146-4_24">https://doi.org/10.1007/978-3-540-45146-4_24</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="UKS">[UKS]</dt>
        <dd>
<span class="refAuthor">Blake-Wilson, S.</span><span class="refAuthor"> and A. Menezes</span>, <span class="refTitle">"Unknown Key-Share Attacks on the Station-to-Station (STS) Protocol"</span>, <span class="refContent">Public Key Cryptography</span>, <span class="refContent">Lecture Notes in Computer Science</span>, <span class="refContent">Vol. 1560</span>, <span class="seriesInfo">DOI 10.1007/3-540-49162-7_12</span>, <time class="refDate" datetime="1999-03">March 1999</time>, <span>&lt;<a href="https://doi.org/10.1007/3-540-49162-7_12">https://doi.org/10.1007/3-540-49162-7_12</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="WEBRTC">[WEBRTC]</dt>
        <dd>
<span class="refAuthor">Jennings, C.</span><span class="refAuthor">, Boström, H.</span><span class="refAuthor">, and J-I. Bruaroey</span>, <span class="refTitle">"WebRTC 1.0: Real-time Communication Between Browsers"</span>, <span class="refContent">W3C Proposed Recommendation</span>, <span>&lt;<a href="https://www.w3.org/TR/webrtc/">https://www.w3.org/TR/webrtc/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6189">[ZRTP]</dt>
      <dd>
<span class="refAuthor">Zimmermann, P.</span><span class="refAuthor">, Johnston, A., Ed.</span><span class="refAuthor">, and J. Callas</span>, <span class="refTitle">"ZRTP: Media Path Key Agreement for Unicast Secure RTP"</span>, <span class="seriesInfo">RFC 6189</span>, <span class="seriesInfo">DOI 10.17487/RFC6189</span>, <time class="refDate" datetime="2011-04">April 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6189">https://www.rfc-editor.org/info/rfc6189</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="acknowledgements">
<section id="section-appendix.a">
      <h2 id="name-acknowledgements">
<a class="section-name selfRef" href="#name-acknowledgements">Acknowledgements</a>
      </h2>
<p id="section-appendix.a-1">This problem would not have been discovered if it weren't for
      discussions with <span class="contact-name">Sam Scott</span>, <span class="contact-name">Hugo Krawczyk</span>, and <span class="contact-name">Richard Barnes</span>.  A
      solution similar to the one presented here was first proposed by
      <span class="contact-name">Karthik Bhargavan</span>, who provided valuable input on
      this document.  <span class="contact-name">Thyla van der Merwe</span> assisted with
      a formal model of the solution.  <span class="contact-name">Adam Roach</span> and
      <span class="contact-name">Paul E. Jones</span> provided significant review and
      input.<a class="pilcrow" href="#section-appendix.a-1">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="section-appendix.b">
      <h2 id="name-authors-addresses">
<a class="section-name selfRef" href="#name-authors-addresses">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Martin Thomson</span></div>
<div class="left" dir="auto"><span class="org">Mozilla</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:mt@lowentropy.net">mt@lowentropy.net</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Eric Rescorla</span></div>
<div class="left" dir="auto"><span class="org">Mozilla</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:ekr@rtfm.com">ekr@rtfm.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>


</body></html>