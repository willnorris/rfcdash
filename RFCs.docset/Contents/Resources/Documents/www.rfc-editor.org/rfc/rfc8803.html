<!DOCTYPE html>
<html class="RFC" lang="en"><head>
<meta charset="utf-8"/>
<meta content="Common,Latin" name="scripts"/>
<meta content="initial-scale=1.0" name="viewport"/>
<title>RFC 8803: 0-RTT TCP Convert Protocol</title>
<meta content="Olivier Bonaventure" name="author"/>
<meta content="Mohamed Boucadair" name="author"/>
<meta content="Sri Gundavelli" name="author"/>
<meta content="SungHoon Seo" name="author"/>
<meta content="Benjamin Hesmans" name="author"/>
<meta content="
       This document specifies an application proxy, called Transport
      Converter, to assist the deployment of TCP extensions such as Multipath
      TCP. A Transport Converter may provide conversion service for one or
      more TCP extensions. The conversion service is provided by means of the
      0-RTT TCP Convert Protocol (Convert). 
       This protocol provides 0-RTT (Zero Round-Trip Time) conversion
      service since no extra delay is induced by the protocol compared to
      connections that are not proxied. Also, the Convert Protocol does not
      require any encapsulation (no tunnels whatsoever). 
       This specification assumes an explicit model, where the Transport
      Converter is explicitly configured on hosts. As a sample applicability
      use case, this document specifies how the Convert Protocol applies for
      Multipath TCP. 
    " name="description"/>
<meta content="xml2rfc 2.47.0" name="generator"/>
<meta content="Hybrid access" name="keyword"/>
<meta content="aggregation" name="keyword"/>
<meta content="transport evolution" name="keyword"/>
<meta content="future internet" name="keyword"/>
<meta content="extension" name="keyword"/>
<meta content="Trafic Steering" name="keyword"/>
<meta content="ATSSS" name="keyword"/>
<meta content="Multipath TCP" name="keyword"/>
<meta content="8803" name="rfc.number"/>
<link href="rfc8803.xml" rel="alternate" type="application/rfc+xml"/>
<link href="#copyright" rel="license"/>
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css"/>
<link href="https://dx.doi.org/10.17487/rfc8803" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <link href="https://datatracker.ietf.org/doc/draft-ietf-tcpm-converters-19" rel="prev"/>
  </head>
<body>
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 8803</td>
<td class="center">Convert Protocol</td>
<td class="right">July 2020</td>
</tr></thead>
<tfoot><tr>
<td class="left">Bonaventure, et al.</td>
<td class="center">Experimental</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div class="document-information" id="external-metadata"></div>
<div class="document-information" id="internal-metadata">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a class="eref" href="https://www.rfc-editor.org/rfc/rfc8803">8803</a></dd>
<dt class="label-category">Category:</dt>
<dd class="category">Experimental</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time class="published" datetime="2020-07">July 2020</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">O. Bonaventure, <span class="editor">Ed.</span>
</div>
<div class="org">Tessares</div>
</div>
<div class="author">
      <div class="author-name">M. Boucadair, <span class="editor">Ed.</span>
</div>
<div class="org">Orange</div>
</div>
<div class="author">
      <div class="author-name">S. Gundavelli</div>
<div class="org">Cisco</div>
</div>
<div class="author">
      <div class="author-name">S. Seo</div>
<div class="org">Korea Telecom</div>
</div>
<div class="author">
      <div class="author-name">B. Hesmans</div>
<div class="org">Tessares</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 8803</h1>
<h1 id="title">0-RTT TCP Convert Protocol</h1>
<section id="section-abstract">
      <h2 id="abstract"><a class="selfRef" href="#abstract">Abstract</a></h2>
<p id="section-abstract-1">This document specifies an application proxy, called Transport
      Converter, to assist the deployment of TCP extensions such as Multipath
      TCP. A Transport Converter may provide conversion service for one or
      more TCP extensions. The conversion service is provided by means of the
      0-RTT TCP Convert Protocol (Convert).<a class="pilcrow" href="#section-abstract-1">¶</a></p>
<p id="section-abstract-2">This protocol provides 0-RTT (Zero Round-Trip Time) conversion
      service since no extra delay is induced by the protocol compared to
      connections that are not proxied. Also, the Convert Protocol does not
      require any encapsulation (no tunnels whatsoever).<a class="pilcrow" href="#section-abstract-2">¶</a></p>
<p id="section-abstract-3">This specification assumes an explicit model, where the Transport
      Converter is explicitly configured on hosts. As a sample applicability
      use case, this document specifies how the Convert Protocol applies for
      Multipath TCP.<a class="pilcrow" href="#section-abstract-3">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a class="section-name selfRef" href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This document is not an Internet Standards Track specification; it is
            published for examination, experimental implementation, and
            evaluation.<a class="pilcrow" href="#section-boilerplate.1-1">¶</a></p>
<p id="section-boilerplate.1-2">
            This document defines an Experimental Protocol for the Internet
            community.  This document is a product of the Internet Engineering
            Task Force (IETF).  It represents the consensus of the IETF community.
            It has received public review and has been approved for publication
            by the Internet Engineering Steering Group (IESG).  Not all documents
            approved by the IESG are candidates for any level of Internet
            Standard; see Section 2 of RFC 7841.<a class="pilcrow" href="#section-boilerplate.1-2">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc8803">https://www.rfc-editor.org/info/rfc8803</a></span>.<a class="pilcrow" href="#section-boilerplate.1-3">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a class="section-name selfRef" href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2020 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a class="pilcrow" href="#section-boilerplate.2-1">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a class="pilcrow" href="#section-boilerplate.2-2">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a class="toplink" href="#" onclick="scroll(0,0)">▲</a><h2 id="name-table-of-contents">
<a class="section-name selfRef" href="#name-table-of-contents">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a class="xref" href="#section-1">1</a>.  <a class="xref" href="#name-introduction">Introduction</a><a class="pilcrow" href="#section-toc.1-1.1.1">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.1.2.1">
                <p class="keepWithNext" id="section-toc.1-1.1.2.1.1"><a class="xref" href="#section-1.1">1.1</a>.  <a class="xref" href="#name-the-problem">The Problem</a><a class="pilcrow" href="#section-toc.1-1.1.2.1.1">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.1.2.2">
                <p class="keepWithNext" id="section-toc.1-1.1.2.2.1"><a class="xref" href="#section-1.2">1.2</a>.  <a class="xref" href="#name-network-assisted-connection">Network-Assisted Connections: The Rationale</a><a class="pilcrow" href="#section-toc.1-1.1.2.2.1">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.1.2.3">
                <p class="keepWithNext" id="section-toc.1-1.1.2.3.1"><a class="xref" href="#section-1.3">1.3</a>.  <a class="xref" href="#name-applicability-scope">Applicability Scope</a><a class="pilcrow" href="#section-toc.1-1.1.2.3.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a class="xref" href="#section-2">2</a>.  <a class="xref" href="#name-conventions-and-definitions">Conventions and Definitions</a><a class="pilcrow" href="#section-toc.1-1.2.1">¶</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a class="xref" href="#section-3">3</a>.  <a class="xref" href="#name-differences-with-socksv5">Differences with SOCKSv5</a><a class="pilcrow" href="#section-toc.1-1.3.1">¶</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a class="xref" href="#section-4">4</a>.  <a class="xref" href="#name-architecture-and-behaviors">Architecture and Behaviors</a><a class="pilcrow" href="#section-toc.1-1.4.1">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a class="xref" href="#section-4.1">4.1</a>.  <a class="xref" href="#name-functional-elements">Functional Elements</a><a class="pilcrow" href="#section-toc.1-1.4.2.1.1">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a class="xref" href="#section-4.2">4.2</a>.  <a class="xref" href="#name-theory-of-operation">Theory of Operation</a><a class="pilcrow" href="#section-toc.1-1.4.2.2.1">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a class="xref" href="#section-4.3">4.3</a>.  <a class="xref" href="#name-data-processing-at-the-tran">Data Processing at the Transport Converter</a><a class="pilcrow" href="#section-toc.1-1.4.2.3.1">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a class="xref" href="#section-4.4">4.4</a>.  <a class="xref" href="#name-address-preservation-vs-add">Address Preservation vs. Address Sharing</a><a class="pilcrow" href="#section-toc.1-1.4.2.4.1">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.4.2.4.2.1">
                    <p id="section-toc.1-1.4.2.4.2.1.1"><a class="xref" href="#section-4.4.1">4.4.1</a>.  <a class="xref" href="#name-address-preservation">Address Preservation</a><a class="pilcrow" href="#section-toc.1-1.4.2.4.2.1.1">¶</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.4.2.4.2.2">
                    <p id="section-toc.1-1.4.2.4.2.2.1"><a class="xref" href="#section-4.4.2">4.4.2</a>.  <a class="xref" href="#name-address-prefix-sharing">Address/Prefix Sharing</a><a class="pilcrow" href="#section-toc.1-1.4.2.4.2.2.1">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a class="xref" href="#section-5">5</a>.  <a class="xref" href="#name-sample-examples">Sample Examples</a><a class="pilcrow" href="#section-toc.1-1.5.1">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a class="xref" href="#section-5.1">5.1</a>.  <a class="xref" href="#name-outgoing-converter-assisted">Outgoing Converter-Assisted Multipath TCP Connections</a><a class="pilcrow" href="#section-toc.1-1.5.2.1.1">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a class="xref" href="#section-5.2">5.2</a>.  <a class="xref" href="#name-incoming-converter-assisted">Incoming Converter-Assisted Multipath TCP Connection</a><a class="pilcrow" href="#section-toc.1-1.5.2.2.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a class="xref" href="#section-6">6</a>.  <a class="xref" href="#name-the-convert-protocol-conver">The Convert Protocol (Convert)</a><a class="pilcrow" href="#section-toc.1-1.6.1">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a class="xref" href="#section-6.1">6.1</a>.  <a class="xref" href="#name-the-convert-fixed-header">The Convert Fixed Header</a><a class="pilcrow" href="#section-toc.1-1.6.2.1.1">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a class="xref" href="#section-6.2">6.2</a>.  <a class="xref" href="#name-convert-tlvs">Convert TLVs</a><a class="pilcrow" href="#section-toc.1-1.6.2.2.1">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.6.2.2.2.1">
                    <p id="section-toc.1-1.6.2.2.2.1.1"><a class="xref" href="#section-6.2.1">6.2.1</a>.  <a class="xref" href="#name-generic-convert-tlv-format">Generic Convert TLV Format</a><a class="pilcrow" href="#section-toc.1-1.6.2.2.2.1.1">¶</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.6.2.2.2.2">
                    <p id="section-toc.1-1.6.2.2.2.2.1"><a class="xref" href="#section-6.2.2">6.2.2</a>.  <a class="xref" href="#name-summary-of-supported-conver">Summary of Supported Convert TLVs</a><a class="pilcrow" href="#section-toc.1-1.6.2.2.2.2.1">¶</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.6.2.2.2.3">
                    <p id="section-toc.1-1.6.2.2.2.3.1"><a class="xref" href="#section-6.2.3">6.2.3</a>.  <a class="xref" href="#name-the-info-tlv">The Info TLV</a><a class="pilcrow" href="#section-toc.1-1.6.2.2.2.3.1">¶</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.6.2.2.2.4">
                    <p id="section-toc.1-1.6.2.2.2.4.1"><a class="xref" href="#section-6.2.4">6.2.4</a>.  <a class="xref" href="#name-supported-tcp-extensions-tl">Supported TCP Extensions TLV</a><a class="pilcrow" href="#section-toc.1-1.6.2.2.2.4.1">¶</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.6.2.2.2.5">
                    <p id="section-toc.1-1.6.2.2.2.5.1"><a class="xref" href="#section-6.2.5">6.2.5</a>.  <a class="xref" href="#name-connect-tlv">Connect TLV</a><a class="pilcrow" href="#section-toc.1-1.6.2.2.2.5.1">¶</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.6.2.2.2.6">
                    <p id="section-toc.1-1.6.2.2.2.6.1"><a class="xref" href="#section-6.2.6">6.2.6</a>.  <a class="xref" href="#name-extended-tcp-header-tlv">Extended TCP Header TLV</a><a class="pilcrow" href="#section-toc.1-1.6.2.2.2.6.1">¶</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.6.2.2.2.7">
                    <p id="section-toc.1-1.6.2.2.2.7.1"><a class="xref" href="#section-6.2.7">6.2.7</a>.  <a class="xref" href="#name-the-cookie-tlv">The Cookie TLV</a><a class="pilcrow" href="#section-toc.1-1.6.2.2.2.7.1">¶</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.6.2.2.2.8">
                    <p id="section-toc.1-1.6.2.2.2.8.1"><a class="xref" href="#section-6.2.8">6.2.8</a>.  <a class="xref" href="#name-error-tlv">Error TLV</a><a class="pilcrow" href="#section-toc.1-1.6.2.2.2.8.1">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a class="xref" href="#section-7">7</a>.  <a class="xref" href="#name-compatibility-of-specific-t">Compatibility of Specific TCP Options with the Conversion Service</a><a class="pilcrow" href="#section-toc.1-1.7.1">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a class="xref" href="#section-7.1">7.1</a>.  <a class="xref" href="#name-base-tcp-options">Base TCP Options</a><a class="pilcrow" href="#section-toc.1-1.7.2.1.1">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a class="xref" href="#section-7.2">7.2</a>.  <a class="xref" href="#name-window-scale-ws">Window Scale (WS)</a><a class="pilcrow" href="#section-toc.1-1.7.2.2.1">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a class="xref" href="#section-7.3">7.3</a>.  <a class="xref" href="#name-selective-acknowledgments">Selective Acknowledgments</a><a class="pilcrow" href="#section-toc.1-1.7.2.3.1">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a class="xref" href="#section-7.4">7.4</a>.  <a class="xref" href="#name-timestamp">Timestamp</a><a class="pilcrow" href="#section-toc.1-1.7.2.4.1">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.7.2.5">
                <p id="section-toc.1-1.7.2.5.1"><a class="xref" href="#section-7.5">7.5</a>.  <a class="xref" href="#name-multipath-tcp">Multipath TCP</a><a class="pilcrow" href="#section-toc.1-1.7.2.5.1">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.7.2.6">
                <p id="section-toc.1-1.7.2.6.1"><a class="xref" href="#section-7.6">7.6</a>.  <a class="xref" href="#name-tcp-fast-open">TCP Fast Open</a><a class="pilcrow" href="#section-toc.1-1.7.2.6.1">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.7.2.7">
                <p id="section-toc.1-1.7.2.7.1"><a class="xref" href="#section-7.7">7.7</a>.  <a class="xref" href="#name-tcp-ao">TCP-AO</a><a class="pilcrow" href="#section-toc.1-1.7.2.7.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a class="xref" href="#section-8">8</a>.  <a class="xref" href="#name-interactions-with-middlebox">Interactions with Middleboxes</a><a class="pilcrow" href="#section-toc.1-1.8.1">¶</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a class="xref" href="#section-9">9</a>.  <a class="xref" href="#name-security-considerations">Security Considerations</a><a class="pilcrow" href="#section-toc.1-1.9.1">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a class="xref" href="#section-9.1">9.1</a>.  <a class="xref" href="#name-privacy-ingress-filtering">Privacy &amp; Ingress Filtering</a><a class="pilcrow" href="#section-toc.1-1.9.2.1.1">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a class="xref" href="#section-9.2">9.2</a>.  <a class="xref" href="#name-authentication-and-authoriz">Authentication and Authorization Considerations</a><a class="pilcrow" href="#section-toc.1-1.9.2.2.1">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a class="xref" href="#section-9.3">9.3</a>.  <a class="xref" href="#name-denial-of-service">Denial of Service</a><a class="pilcrow" href="#section-toc.1-1.9.2.3.1">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.9.2.4">
                <p id="section-toc.1-1.9.2.4.1"><a class="xref" href="#section-9.4">9.4</a>.  <a class="xref" href="#name-traffic-theft">Traffic Theft</a><a class="pilcrow" href="#section-toc.1-1.9.2.4.1">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.9.2.5">
                <p id="section-toc.1-1.9.2.5.1"><a class="xref" href="#section-9.5">9.5</a>.  <a class="xref" href="#name-logging">Logging</a><a class="pilcrow" href="#section-toc.1-1.9.2.5.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a class="xref" href="#section-10">10</a>. <a class="xref" href="#name-iana-considerations">IANA Considerations</a><a class="pilcrow" href="#section-toc.1-1.10.1">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a class="xref" href="#section-10.1">10.1</a>.  <a class="xref" href="#name-convert-service-name">Convert Service Name</a><a class="pilcrow" href="#section-toc.1-1.10.2.1.1">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a class="xref" href="#section-10.2">10.2</a>.  <a class="xref" href="#name-the-convert-protocol-convert">The Convert Protocol (Convert) Parameters</a><a class="pilcrow" href="#section-toc.1-1.10.2.2.1">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.10.2.2.2.1">
                    <p id="section-toc.1-1.10.2.2.2.1.1"><a class="xref" href="#section-10.2.1">10.2.1</a>.  <a class="xref" href="#name-convert-versions">Convert Versions</a><a class="pilcrow" href="#section-toc.1-1.10.2.2.2.1.1">¶</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.10.2.2.2.2">
                    <p id="section-toc.1-1.10.2.2.2.2.1"><a class="xref" href="#section-10.2.2">10.2.2</a>.  <a class="xref" href="#name-convert-tlvs-2">Convert TLVs</a><a class="pilcrow" href="#section-toc.1-1.10.2.2.2.2.1">¶</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.10.2.2.2.3">
                    <p id="section-toc.1-1.10.2.2.2.3.1"><a class="xref" href="#section-10.2.3">10.2.3</a>.  <a class="xref" href="#name-convert-error-messages">Convert Error Messages</a><a class="pilcrow" href="#section-toc.1-1.10.2.2.2.3.1">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a class="xref" href="#section-11">11</a>. <a class="xref" href="#name-references">References</a><a class="pilcrow" href="#section-toc.1-1.11.1">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a class="xref" href="#section-11.1">11.1</a>.  <a class="xref" href="#name-normative-references">Normative References</a><a class="pilcrow" href="#section-toc.1-1.11.2.1.1">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a class="xref" href="#section-11.2">11.2</a>.  <a class="xref" href="#name-informative-references">Informative References</a><a class="pilcrow" href="#section-toc.1-1.11.2.2.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a class="xref" href="#section-appendix.a">Appendix A</a>.  <a class="xref" href="#name-example-socket-api-changes-">Example Socket API Changes to Support the 0-RTT TCP Convert Protocol</a><a class="pilcrow" href="#section-toc.1-1.12.1">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a class="xref" href="#section-a.1">A.1</a>.  <a class="xref" href="#name-active-open-client-side">Active Open (Client Side)</a><a class="pilcrow" href="#section-toc.1-1.12.2.1.1">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a class="xref" href="#section-a.2">A.2</a>.  <a class="xref" href="#name-passive-open-converter-side">Passive Open (Converter Side)</a><a class="pilcrow" href="#section-toc.1-1.12.2.2.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a class="xref" href="#section-appendix.b"></a><a class="xref" href="#name-acknowledgments">Acknowledgments</a><a class="pilcrow" href="#section-toc.1-1.13.1">¶</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a class="xref" href="#section-appendix.c"></a><a class="xref" href="#name-contributors">Contributors</a><a class="pilcrow" href="#section-toc.1-1.14.1">¶</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a class="xref" href="#section-appendix.d"></a><a class="xref" href="#name-authors-addresses">Authors' Addresses</a><a class="pilcrow" href="#section-toc.1-1.15.1">¶</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="intro">
<section id="section-1">
      <h2 id="name-introduction">
<a class="section-number selfRef" href="#section-1">1. </a><a class="section-name selfRef" href="#name-introduction">Introduction</a>
      </h2>
<div id="pb">
<section id="section-1.1">
        <h3 id="name-the-problem">
<a class="section-number selfRef" href="#section-1.1">1.1. </a><a class="section-name selfRef" href="#name-the-problem">The Problem</a>
        </h3>
<p id="section-1.1-1">Transport protocols like TCP evolve regularly <span>[<a class="xref" href="#RFC7414">RFC7414</a>]</span>. TCP has been improved in
        different ways.  Some improvements such as changing the initial window
        size <span>[<a class="xref" href="#RFC6928">RFC6928</a>]</span> or modifying the
        congestion control scheme can be applied independently on Clients and
        Servers. Other improvements such as Selective Acknowledgments <span>[<a class="xref" href="#RFC2018">RFC2018</a>]</span> or large windows <span>[<a class="xref" href="#RFC7323">RFC7323</a>]</span> require a new TCP option or
        changing the semantics of some fields in the TCP header. These
        modifications must be deployed on both Clients and Servers to be
        actually used on the Internet. Experience with the latter class of TCP
        extensions reveals that their deployment can require many
        years. Fukuda reports in <span>[<a class="xref" href="#Fukuda2011">Fukuda2011</a>]</span>
        results of a decade of measurements showing the deployment of
        Selective Acknowledgments, Window Scale, and TCP Timestamps. <span>[<a class="xref" href="#ANRW17">ANRW17</a>]</span> describes measurements showing that
        TCP Fast Open (TFO) <span>[<a class="xref" href="#RFC7413">RFC7413</a>]</span> is still
        not widely deployed.<a class="pilcrow" href="#section-1.1-1">¶</a></p>
<p id="section-1.1-2">There are some situations where the transport stack used on Clients
        (or Servers) can be upgraded at a faster pace than the transport stack
        running on Servers (or Clients). 


 In those situations, Clients (or Servers) would typically want to benefit
 from the features of an improved transport protocol even if the Servers (or
 Clients) have not yet been upgraded.



Some assistance from the network to make use of these features is
valuable. For example, Performance Enhancing Proxies <span>[<a class="xref" href="#RFC3135">RFC3135</a>]</span> and other service functions have been deployed as solutions
to improve TCP performance over links with specific characteristics.<a class="pilcrow" href="#section-1.1-2">¶</a></p>
<p id="section-1.1-3">Recent examples of TCP extensions include Multipath TCP (MPTCP)
        <span>[<a class="xref" href="#RFC8684">RFC8684</a>]</span> or tcpcrypt <span>[<a class="xref" href="#RFC8548">RFC8548</a>]</span>. Those extensions
        provide features that are interesting for Clients such as wireless
        devices. With Multipath TCP, those devices could seamlessly use
        Wireless Local Area Network (WLAN) and cellular networks for bonding
        purposes, faster hand-overs, or better resiliency. Unfortunately,
        deploying those extensions on both a wide range of Clients and Servers
        remains difficult.<a class="pilcrow" href="#section-1.1-3">¶</a></p>
<p id="section-1.1-4">More recently, 5G bonding experimentation has been conducted into
        global range of the incumbent 4G (LTE) connectivity using newly
        devised Clients and a Multipath TCP proxy. Even if the 5G and 4G
        bonding (that relies upon Multipath TCP) increases the bandwidth, it
        is also crucial to minimize latency entirely between end hosts
        regardless of whether intermediate nodes are inside or outside of the
        mobile core. In order to handle Ultra-Reliable Low Latency
        Communication (URLLC) for the next-generation mobile network,
        Multipath TCP and its proxy mechanism such as the one used to provide
        Access Traffic Steering, Switching, and Splitting (ATSSS) must be
        optimized to reduce latency <span>[<a class="xref" href="#TS23501">TS23501</a>]</span>.<a class="pilcrow" href="#section-1.1-4">¶</a></p>
</section>
</div>
<div id="network-assisted-connections-the-rationale">
<section id="section-1.2">
        <h3 id="name-network-assisted-connection">
<a class="section-number selfRef" href="#section-1.2">1.2. </a><a class="section-name selfRef" href="#name-network-assisted-connection">Network-Assisted Connections: The Rationale</a>
        </h3>
<p id="section-1.2-1">This document specifies an application proxy called Transport
        Converter. A Transport Converter is a function that is installed by a
        network operator to aid the deployment of TCP extensions and to
        provide the benefits of such extensions to Clients in particular. A
        Transport Converter may provide conversion service for one or more TCP
        extensions. Which TCP extensions are eligible for the conversion
        service is deployment specific. The conversion service is provided by
        means of the 0-RTT TCP Convert Protocol (Convert), which is an
        application-layer protocol that uses a specific TCP port number on
        the Converter.<a class="pilcrow" href="#section-1.2-1">¶</a></p>
<p id="section-1.2-2">The Convert Protocol provides Zero Round-Trip Time (0-RTT)
        conversion service since no extra delay is induced by the protocol
        compared to connections that are not proxied. Particularly, the
        Convert Protocol does not require extra signaling setup delays before
        making use of the conversion service. The Convert Protocol does not
        require any encapsulation (no tunnels, whatsoever).<a class="pilcrow" href="#section-1.2-2">¶</a></p>
<p id="section-1.2-3">The Transport Converter adheres to the main steps drawn in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc1919#section-3">Section 3</a> of [<a class="xref" href="#RFC1919">RFC1919</a>]</span>. In particular, a
        Transport Converter achieves the following:<a class="pilcrow" href="#section-1.2-3">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.2-4.1">Listening for Client sessions;<a class="pilcrow" href="#section-1.2-4.1">¶</a>
</li>
          <li class="normal" id="section-1.2-4.2">Receiving the address of the Server from the Client;<a class="pilcrow" href="#section-1.2-4.2">¶</a>
</li>
          <li class="normal" id="section-1.2-4.3">Setting up a session to the Server;<a class="pilcrow" href="#section-1.2-4.3">¶</a>
</li>
          <li class="normal" id="section-1.2-4.4">Relaying control messages and data between the Client and the
            Server;<a class="pilcrow" href="#section-1.2-4.4">¶</a>
</li>
          <li class="normal" id="section-1.2-4.5">Performing access controls according to local policies.<a class="pilcrow" href="#section-1.2-4.5">¶</a>
</li>
        </ul>
<p id="section-1.2-5">The main advantage of network-assisted conversion services is that
        they enable new TCP extensions to be used on a subset of the path
        between endpoints, which encourages the deployment of these
        extensions. Furthermore, the Transport Converter allows the Client and
        the Server to directly negotiate TCP extensions for the sake of native
        support along the full path.<a class="pilcrow" href="#section-1.2-5">¶</a></p>
<p id="section-1.2-6">The Convert Protocol is a generic mechanism to provide 0-RTT
        conversion service. As a sample applicability use case, this document
        specifies how the Convert Protocol applies for Multipath TCP. It is
        out of scope of this document to provide a comprehensive list of all
        potential conversion services. Applicability documents may be defined
        in the future.<a class="pilcrow" href="#section-1.2-6">¶</a></p>
<p id="section-1.2-7">This document does not assume that all the traffic is eligible for
        the network-assisted conversion service. Only a subset of the traffic
        will be forwarded to a Transport Converter according to a set of
        policies. These policies, and how they are communicated to endpoints,
        are out of scope. Furthermore, it is possible to bypass the Transport
        Converter to connect directly to the Servers that already support the
        required TCP extension(s).<a class="pilcrow" href="#section-1.2-7">¶</a></p>
<p id="section-1.2-8">This document assumes an explicit model in which a Client is
        configured with one or a list of Transport Converters (statically or
        through protocols such as <span>[<a class="xref" href="#I-D.boucadair-tcpm-dhc-converter">DHC-CONVERTER</a>]</span>). Configuration
        means are outside the scope of this document.<a class="pilcrow" href="#section-1.2-8">¶</a></p>
<p id="section-1.2-9">The use of a Transport Converter means that there is no end-to-end
        transport connection between the Client and Server. This could
        potentially create problems in some scenarios such as those discussed
        in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc3135#section-4">Section 4</a> of [<a class="xref" href="#RFC3135">RFC3135</a>]</span>. Some of these problems
        may not be applicable. For example, a Transport Converter can inform a
        Client by means of Network Failure (65) or Destination Unreachable
        (97) error messages (<a class="xref" href="#sec-error">Section 6.2.8</a>) that it
        encounters a failure problem; the Client can react accordingly. An
        endpoint, or its network administrator, can assess the benefit
        provided by the Transport Converter service versus the risk. This is
        one reason why the Transport Converter functionality has to be
        explicitly requested by an endpoint.<a class="pilcrow" href="#section-1.2-9">¶</a></p>
<p id="section-1.2-10">
This document is organized as follows:<a class="pilcrow" href="#section-1.2-10">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-1.2-11.1">
            <a class="xref" href="#sec-socks">Section 3</a> provides a brief overview of the differences
     between the well-known SOCKS protocol and the 0-RTT TCP Convert Protocol.<a class="pilcrow" href="#section-1.2-11.1">¶</a>
</li>
          <li class="normal ulEmpty" id="section-1.2-11.2">
            <a class="xref" href="#sec-arch">Section 4</a>  provides a brief explanation of the operation of Transport
     Converters.<a class="pilcrow" href="#section-1.2-11.2">¶</a>
</li>
          <li class="normal ulEmpty" id="section-1.2-11.3">
            <a class="xref" href="#sample-examples">Section 5</a> includes a set of sample examples to illustrate the overall
    behavior.<a class="pilcrow" href="#section-1.2-11.3">¶</a>
</li>
          <li class="normal ulEmpty" id="section-1.2-11.4">
            <a class="xref" href="#sec-protocol">Section 6</a> describes the Convert Protocol.<a class="pilcrow" href="#section-1.2-11.4">¶</a>
</li>
          <li class="normal ulEmpty" id="section-1.2-11.5">
            <a class="xref" href="#sec-tcpoptions">Section 7</a> discusses how Transport Converters can be used to support
     different TCP extensions.<a class="pilcrow" href="#section-1.2-11.5">¶</a>
</li>
          <li class="normal ulEmpty" id="section-1.2-11.6">
            <a class="xref" href="#sec-middleboxes">Section 8</a> then discusses the interactions with middleboxes.<a class="pilcrow" href="#section-1.2-11.6">¶</a>
</li>
          <li class="normal ulEmpty" id="section-1.2-11.7">
            <a class="xref" href="#sec-security">Section 9</a> focuses on security considerations.<a class="pilcrow" href="#section-1.2-11.7">¶</a>
</li>
          <li class="normal ulEmpty" id="section-1.2-11.8">
            <a class="xref" href="#sec-api">Appendix A</a> describes how a TCP stack would need to support the
       protocol described in this document.<a class="pilcrow" href="#section-1.2-11.8">¶</a>
</li>
        </ul>
</section>
</div>
<section id="section-1.3">
        <h3 id="name-applicability-scope">
<a class="section-number selfRef" href="#section-1.3">1.3. </a><a class="section-name selfRef" href="#name-applicability-scope">Applicability Scope</a>
        </h3>
<p id="section-1.3-1">The 0-RTT TCP Convert Protocol specified in this document <span class="bcp14">MUST</span> be used
        in a single administrative domain deployment model. That is, the
        entity offering the connectivity service to a Client is also the entity
        that owns and operates the Transport Converter, with no transit over
        a third-party network.<a class="pilcrow" href="#section-1.3-1">¶</a></p>
<p id="section-1.3-2">Future deployment of Transport Converters by third parties
        <span class="bcp14">MUST</span> adhere to the mutual authentication requirements
        in <a class="xref" href="#authorization">Section 9.2</a> to prevent
        illegitimate traffic interception (<a class="xref" href="#traffic-theft">Section 9.4</a>) in particular.<a class="pilcrow" href="#section-1.3-2">¶</a></p>
</section>
</section>
</div>
<div id="conventions-and-definitions">
<section id="section-2">
      <h2 id="name-conventions-and-definitions">
<a class="section-number selfRef" href="#section-2">2. </a><a class="section-name selfRef" href="#name-conventions-and-definitions">Conventions and Definitions</a>
      </h2>
<p id="section-2-1">
    The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
    "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
    described in BCP 14 <span>[<a class="xref" href="#RFC2119">RFC2119</a>]</span> <span>[<a class="xref" href="#RFC8174">RFC8174</a>]</span> 
    when, and only when, they appear in all capitals, as shown here.<a class="pilcrow" href="#section-2-1">¶</a></p>
</section>
</div>
<div id="sec-socks">
<section id="section-3">
      <h2 id="name-differences-with-socksv5">
<a class="section-number selfRef" href="#section-3">3. </a><a class="section-name selfRef" href="#name-differences-with-socksv5">Differences with SOCKSv5</a>
      </h2>
<p id="section-3-1">Several IETF protocols provide proxy services, the closest to the
      0-RTT TCP Convert Protocol being the SOCKSv5 protocol <span>[<a class="xref" href="#RFC1928">RFC1928</a>]</span>. This protocol is already used to deploy Multipath
      TCP in some cellular networks (<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8041#section-2.2">Section 2.2</a> of [<a class="xref" href="#RFC8041">RFC8041</a>]</span>).<a class="pilcrow" href="#section-3-1">¶</a></p>
<p id="section-3-2">A SOCKS Client creates a connection to a SOCKS Proxy, exchanges
      authentication information, and indicates the IP address and port number
      of the target Server. At this point, the SOCKS Proxy creates a
      connection towards the target Server and relays all data between the two
      proxied connections. The operation of an implementation based on SOCKSv5
      (without authentication) is illustrated in <a class="xref" href="#fig-socks5">Figure 1</a>.<a class="pilcrow" href="#section-3-2">¶</a></p>
<span id="name-establishment-of-a-tcp-conn"></span><div id="fig-socks5">
<figure id="figure-1">
        <div class="artwork art-text alignLeft" id="section-3-3.1">
<pre>Client                SOCKS Proxy               Server
   |                       |                       |
   | --------------------&gt; |                       |
   |         SYN           |                       |
   | &lt;-------------------- |                       |
   |       SYN+ACK         |                       |
   | --------------------&gt; |                       |
   |         ACK           |                       |
   |                       |                       |
   | --------------------&gt; |                       |
   |Version=5, Auth Methods|                       |
   | &lt;-------------------- |                       |
   |       Method          |                       |
   | --------------------&gt; |                       |
   |Auth Request (unless "No auth" method negotiated)
   | &lt;-------------------- |                       |
   |     Auth Response     |                       |
   | --------------------&gt; |                       |
   | Connect Server:Port   | --------------------&gt; |
   |                       |          SYN          |
   |                       | &lt;-------------------- |
   |                       |        SYN+ACK        |
   | &lt;-------------------- |                       |
   |      Succeeded        |                       |
   | --------------------&gt; |                       |
   |       Data1           |                       |
   |                       | --------------------&gt; |
   |                       |         Data1         |
   |                       | &lt;-------------------- |
   |                       |         Data2         |
   | &lt;-------------------- |                       |
   |          Data2        |                       |
                         ...
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-1">Figure 1</a>:
<a class="selfRef" href="#name-establishment-of-a-tcp-conn">Establishment of a TCP Connection through a SOCKS Proxy without Authentication</a>
        </figcaption></figure>
</div>
<p id="section-3-4">When SOCKS is used, an "end-to-end" connection between a Client and a
      Server becomes a sequence of two TCP connections that are glued together
      on the SOCKS Proxy. The SOCKS Client and Server exchange control
      information at the beginning of the bytestream on the Client-Proxy
      connection. The SOCKS Proxy then creates the connection with the target
      Server and then glues the two connections together so that all bytes
      sent by the application (Client) to the SOCKS Proxy are relayed to the
      Server and vice versa.<a class="pilcrow" href="#section-3-4">¶</a></p>
<p id="section-3-5">The Convert Protocol is also used on TCP proxies that relay data
      between an upstream and a downstream connection, but there are important
      differences with SOCKSv5. A first difference is that the 0-RTT TCP
      Convert Protocol exchanges all the control information during the
      initial RTT.  This reduces the connection establishment delay compared
      to SOCKS, which requires two or more round-trip times before the
      establishment of the downstream connection towards the final
      destination. In today's Internet, latency is an important metric, and
      various protocols have been tuned to reduce their latency <span>[<a class="xref" href="#I-D.arkko-arch-low-latency">LOW-LATENCY</a>]</span>. A recently
      proposed extension to SOCKS leverages the TCP Fast Open (TFO) option
      <span>[<a class="xref" href="#I-D.olteanu-intarea-socks-6">INTAREA-SOCKS</a>]</span> to reduce
      this delay.<a class="pilcrow" href="#section-3-5">¶</a></p>
<p id="section-3-6">A second difference is that the Convert Protocol explicitly takes the
      TCP extensions into account. By using the Convert Protocol, the Client
      can learn whether a given TCP extension is supported by the destination
      Server. This enables the Client to bypass the Transport Converter when
      the Server supports the required TCP extension(s). Neither SOCKSv5 <span>[<a class="xref" href="#RFC1928">RFC1928</a>]</span> nor the proposed SOCKSv6 <span>[<a class="xref" href="#I-D.olteanu-intarea-socks-6">INTAREA-SOCKS</a>]</span> provide such a
      feature.<a class="pilcrow" href="#section-3-6">¶</a></p>
<p id="section-3-7">A third difference is that a Transport Converter will only confirm
      the establishment of the connection initiated by the Client provided
      that the downstream connection has already been accepted by the Server.
      If the Server refuses the connection establishment attempt from the
      Transport Converter, then the upstream connection from the Client is
      rejected as well. This feature is important for applications that check
      the availability of a Server or use the time to connect as a hint on the
      selection of a Server <span>[<a class="xref" href="#RFC8305">RFC8305</a>]</span>.<a class="pilcrow" href="#section-3-7">¶</a></p>
<p id="section-3-8">A fourth difference is that the 0-RTT TCP Convert Protocol only allows
      the Client to specify the IP address/port number of the destination
      Server and not a DNS name. We evaluated an alternate design that
      included the DNS name of the remote peer instead of its IP address as in
      SOCKS <span>[<a class="xref" href="#RFC1928">RFC1928</a>]</span>. However, that design
      was not adopted because it induces both an extra load and increased
      delays on the Transport Converter to handle and manage DNS resolution
      requests.  Note that the name resolution at the Converter may fail
      (e.g., private names discussed in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc6731#section-2.1">Section 2.1</a> of [<a class="xref" href="#RFC6731">RFC6731</a>]</span>) or may not match the one that would
      be returned by a Client's resolution library (e.g., <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc6731#section-2.2">Section 2.2</a> of [<a class="xref" href="#RFC6731">RFC6731</a>]</span>).<a class="pilcrow" href="#section-3-8">¶</a></p>
</section>
</div>
<div id="sec-arch">
<section id="section-4">
      <h2 id="name-architecture-and-behaviors">
<a class="section-number selfRef" href="#section-4">4. </a><a class="section-name selfRef" href="#name-architecture-and-behaviors">Architecture and Behaviors</a>
      </h2>
<div id="functional-elements">
<section id="section-4.1">
        <h3 id="name-functional-elements">
<a class="section-number selfRef" href="#section-4.1">4.1. </a><a class="section-name selfRef" href="#name-functional-elements">Functional Elements</a>
        </h3>
<p id="section-4.1-1">The Convert Protocol considers three functional elements:<a class="pilcrow" href="#section-4.1-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-2.1">Clients<a class="pilcrow" href="#section-4.1-2.1">¶</a>
</li>
          <li class="normal" id="section-4.1-2.2">Transport Converters<a class="pilcrow" href="#section-4.1-2.2">¶</a>
</li>
          <li class="normal" id="section-4.1-2.3">Servers<a class="pilcrow" href="#section-4.1-2.3">¶</a>
</li>
        </ul>
<p id="section-4.1-3">A Transport Converter is a network function that proxies all data
        exchanged over one upstream connection to one downstream connection
        and vice versa (<a class="xref" href="#figtc">Figure 2</a>). Thus, the Transport
        Converter maintains state that associates one upstream
        connection to a corresponding downstream connection.<a class="pilcrow" href="#section-4.1-3">¶</a></p>
<p id="section-4.1-4">A connection can be initiated from both sides of the Transport
        Converter (External realm, Internal realm).<a class="pilcrow" href="#section-4.1-4">¶</a></p>
<span id="name-a-transport-converter-proxi"></span><div id="figtc">
<figure id="figure-2">
          <div class="artwork art-text alignLeft" id="section-4.1-5.1">
<pre>                           |
                           :
                           |
                     +------------+
Client &lt;- upstream -&gt;| Transport  |&lt;- downstream -&gt; Server
         connection  | Converter  |   connection
                     +------------+
                           |
            Internal realm : External realm
                           |
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-2">Figure 2</a>:
<a class="selfRef" href="#name-a-transport-converter-proxi">A Transport Converter Proxies Data between Pairs of TCP Connections</a>
          </figcaption></figure>
</div>
<p id="section-4.1-6">"Client" refers to a software instance embedded on a host that can
        reach a Transport Converter in the internal realm. The "Client" can
        initiate connections via a Transport Converter (referred to as
        outgoing connections). Also, the "Client" can accept incoming
        connections via a Transport Converter (referred to as incoming
        connections).<a class="pilcrow" href="#section-4.1-6">¶</a></p>
<p id="section-4.1-7">A Transport Converter can be embedded in a standalone device or be
        activated as a service on a router. How such a function is enabled is
        deployment specific.<a class="pilcrow" href="#section-4.1-7">¶</a></p>
<p id="section-4.1-8">The architecture assumes that new software will be installed on the
        Client hosts to interact with one or more Transport Converters.
        Furthermore, the architecture allows for making use of new TCP
        extensions even if those are not supported by a given Server.<a class="pilcrow" href="#section-4.1-8">¶</a></p>
<p id="section-4.1-9">A Client is configured, through means that are outside the scope of
        this document, with the names and/or addresses of one or more
        Transport Converters and the TCP extensions that they support. The
        procedure for selecting a Transport Converter among a list of
        configured Transport Converters is outside the scope of this
        document.<a class="pilcrow" href="#section-4.1-9">¶</a></p>
<p id="section-4.1-10">One of the benefits of this design is that different transport
        protocol extensions can be used on the upstream and the downstream
        connections. This encourages the deployment of new TCP extensions
        until they are widely supported, in particular,  by Servers.<a class="pilcrow" href="#section-4.1-10">¶</a></p>
<p id="section-4.1-11">The architecture does not mandate anything on the Server side.<a class="pilcrow" href="#section-4.1-11">¶</a></p>
<p id="section-4.1-12">Similar to SOCKS, the architecture does not interfere with
        end-to-end TLS connections <span>[<a class="xref" href="#RFC8446">RFC8446</a>]</span> between the
        Client and the Server (<a class="xref" href="#figtls">Figure 3</a>). In other words,
        end-to-end TLS is supported in the presence of a Converter.<a class="pilcrow" href="#section-4.1-12">¶</a></p>
<span id="name-end-to-end-tls-via-a-transp"></span><div id="figtls">
<figure id="figure-3">
          <div class="artwork art-text alignLeft" id="section-4.1-13.1">
<pre>    Client             Transport                Server
       |               Converter                  |
       |                   |                      |
       /==========================================\
      |            End-to-end TLS                  |
       \==========================================/

    * TLS messages exchanged between the Client
      and the Server are not shown.
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-3">Figure 3</a>:
<a class="selfRef" href="#name-end-to-end-tls-via-a-transp">End-to-end TLS via a Transport Converter</a>
          </figcaption></figure>
</div>
<p id="section-4.1-14">It is out of scope of this document to elaborate on specific
        considerations related to the use of TLS in the Client-Converter
        connection leg to exchange Convert messages (in addition to the
        end-to-end TLS connection). In particular, (1) assessment of whether
        0-RTT data mode discussed in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8446#section-2.3">Section 2.3</a> of [<a class="xref" href="#RFC8446">RFC8446</a>]</span> is safe under replay and (2)
        specification of a profile for its use (<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8446#appendix-E.5">Appendix E.5</a> of [<a class="xref" href="#RFC8446">RFC8446</a>]</span>) are out of scope.<a class="pilcrow" href="#section-4.1-14">¶</a></p>
</section>
</div>
<div id="sec-to">
<section id="section-4.2">
        <h3 id="name-theory-of-operation">
<a class="section-number selfRef" href="#section-4.2">4.2. </a><a class="section-name selfRef" href="#name-theory-of-operation">Theory of Operation</a>
        </h3>
<p id="section-4.2-1">At a high level, the objective of the Transport Converter is to
        allow the use a specific extension, e.g., Multipath TCP, on a subset
        of the path even if the peer does not support this extension. This is
        illustrated in <a class="xref" href="#fig-highlevel">Figure 4</a> where the Client
        initiates a Multipath TCP connection with the Transport Converter
        (packets belonging to the Multipath TCP connection are shown with
        "===") while the Transport Converter uses a TCP connection with the
        Server.<a class="pilcrow" href="#section-4.2-1">¶</a></p>
<span id="name-an-example-of-0-rtt-network"></span><div id="fig-highlevel">
<figure id="figure-4">
          <div class="artwork art-text alignLeft" id="section-4.2-2.1">
<pre>    Client             Transport                Server
       |               Converter                  |
       |                   |                      |
       |==================&gt;|---------------------&gt;|
       |                   |                      |
       |&lt;==================|&lt;---------------------|
       |                   |                      |
      Multipath TCP packets     TCP packets
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-4">Figure 4</a>:
<a class="selfRef" href="#name-an-example-of-0-rtt-network">An Example of 0-RTT Network-Assisted Outgoing MPTCP Connection</a>
          </figcaption></figure>
</div>
<p id="section-4.2-3">The packets belonging to a connection established through a
        Transport Converter may follow a different path than the packets
        directly exchanged between the Client and the Server. Deployments
        should minimize the possible additional delay by carefully selecting
        the location of the Transport Converter used to reach a given
        destination.<a class="pilcrow" href="#section-4.2-3">¶</a></p>
<p id="section-4.2-4">When establishing a connection, the Client can, depending on local
        policies, either contact the Server directly (e.g., by sending a TCP
        SYN towards the Server) or create the connection via a Transport
        Converter. In the latter case (that is, the conversion service is
        used), the Client initiates a connection towards the Transport
        Converter and indicates the IP address and port number of the Server
        within the connection establishment packet. Doing so enables the
        Transport Converter to immediately initiate a connection towards that
        Server without experiencing an extra delay. The Transport Converter
        waits until the receipt of the confirmation that the Server agrees to
        establish the connection before confirming it to the Client.<a class="pilcrow" href="#section-4.2-4">¶</a></p>
<p id="section-4.2-5">The Client places the destination address and port number of the
        Server in the payload of the SYN sent to the Transport Converter to
        minimize connection establishment delays. The Transport Converter
        maintains two connections that are combined together:<a class="pilcrow" href="#section-4.2-5">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2-6.1">The upstream connection is the one between the Client and the
            Transport Converter.<a class="pilcrow" href="#section-4.2-6.1">¶</a>
</li>
          <li class="normal" id="section-4.2-6.2">The downstream connection is the one between the Transport
            Converter and the Server.<a class="pilcrow" href="#section-4.2-6.2">¶</a>
</li>
        </ul>
<p id="section-4.2-7">Any user data received by the Transport Converter over the upstream
        (or downstream) connection is proxied over the downstream (or
        upstream) connection.<a class="pilcrow" href="#section-4.2-7">¶</a></p>
<p id="section-4.2-8"><a class="xref" href="#fig-estab">Figure 5</a> illustrates the establishment of
        an outgoing TCP connection by a Client through a Transport
        Converter.<a class="pilcrow" href="#section-4.2-8">¶</a></p>
<aside id="section-4.2-9">
          <p id="section-4.2-9.1">
          Note: The information shown between brackets in <a class="xref" href="#fig-estab">Figure 5</a> (and other figures in the
   document) refers to Convert Protocol messages described in <a class="xref" href="#sec-protocol">Section 6</a>.<a class="pilcrow" href="#section-4.2-9.1">¶</a></p>
</aside>
<span id="name-establishment-of-an-outgoin"></span><div id="fig-estab">
<figure id="figure-5">
          <div class="artwork art-text alignLeft" id="section-4.2-10.1">
<pre>                        Transport
    Client              Converter              Server
       |                   |                      |
       |SYN [-&gt;Server:port]|         SYN          |
       |------------------&gt;|---------------------&gt;|
       |&lt;------------------|&lt;---------------------|
       |    SYN+ACK [ ]    |        SYN+ACK       |
       |        ...        |          ...         |
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-5">Figure 5</a>:
<a class="selfRef" href="#name-establishment-of-an-outgoin">Establishment of an Outgoing TCP Connection through a Transport Converter</a>
          </figcaption></figure>
</div>
<p id="section-4.2-11">The Client sends a SYN destined to the Transport Converter. The
        payload of this SYN contains the address and port number of the
        Server. The Transport Converter does not reply immediately to this
        SYN. It first tries to create a TCP connection towards the target
        Server. If this upstream connection succeeds, the Transport Converter
        confirms the establishment of the connection to the Client by
        returning a SYN+ACK and the first bytes of the bytestream contain
        information about the TCP options that were negotiated with the
        Server. Also, a state entry is instantiated for this connection. This
        state entry is used by the Converter to handle subsequent messages
        belonging to the connection.<a class="pilcrow" href="#section-4.2-11">¶</a></p>
<p id="section-4.2-12">The connection can also be established from the Internet towards a
        Client via a Transport Converter (<a class="xref" href="#fig-estab2">Figure 6</a>).  This is typically the case when the Client hosts
        an application Server that listens to a specific port number. When the
        Converter receives an incoming SYN from a remote host, it checks if it
        can provide the conversion service for the destination IP address and
        destination port number of that SYN. The Transport Converter receives
        this SYN because it is, for example, on the path between the remote
        host and the Client or it provides address-sharing service for the
        Client (<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc6269#section-2">Section 2</a> of [<a class="xref" href="#RFC6269">RFC6269</a>]</span>). If
        the check fails, the packet is silently ignored by the Converter. If
        the check is successful, the Converter tries to initiate a TCP
        connection towards the Client from its own address and using its
        configured TCP options. In the SYN that corresponds to this connection
        attempt, the Transport Convert inserts a TLV message that indicates
        the source address and port number of the remote host. A transport
        session entry is created by the Converter for this connection. SYN+ACK
        and ACK will then be exchanged between the Client, the Converter, and
        remote host to confirm the establishment of the connection. The
        Converter uses the transport session entry to proxy packets belonging
        to the connection.<a class="pilcrow" href="#section-4.2-12">¶</a></p>
<span id="name-establishment-of-an-incomin"></span><div id="fig-estab2">
<figure id="figure-6">
          <div class="artwork art-text alignLeft" id="section-4.2-13.1">
<pre>  Transport              Remote
    Client              Converter             Host (RH)
       |                   |                      |
       |SYN [&lt;-RH IP@:port]|         SYN          |
       |&lt;------------------|&lt;---------------------|
       |------------------&gt;|---------------------&gt;|
       |    SYN+ACK [ ]    |        SYN+ACK       |
       |        ...        |          ...         |

</pre>
</div>
<figcaption><a class="selfRef" href="#figure-6">Figure 6</a>:
<a class="selfRef" href="#name-establishment-of-an-incomin">Establishment of an Incoming TCP Connection through a Transport Converter</a>
          </figcaption></figure>
</div>
<p id="section-4.2-14">Standard TCP (<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc793#section-3.4">Section 3.4</a> of [<a class="xref" href="#RFC0793">RFC0793</a>]</span>) allows a
        SYN packet to carry data inside its payload but forbids the receiver
        from delivering it to the application until completion of the
        three-way-handshake. To enable applications to exchange data in a TCP
        handshake, this specification follows an approach similar to TCP Fast
        Open <span>[<a class="xref" href="#RFC7413">RFC7413</a>]</span> and thus, removes the constraint by
        allowing data in SYN packets to be delivered to the Transport
        Converter application.<a class="pilcrow" href="#section-4.2-14">¶</a></p>
<p id="section-4.2-15">As discussed in <span>[<a class="xref" href="#RFC7413">RFC7413</a>]</span>, such
        change to TCP semantics raises two issues. First, duplicate SYNs can
        cause problems for applications that rely on TCP; whether or not a
        given application is affected depends on the details of that
        application protocol.  Second, TCP suffers from SYN flooding attacks
        <span>[<a class="xref" href="#RFC4987">RFC4987</a>]</span>. TFO solves these two
        problems for applications that can tolerate replays by using the TCP
        Fast Open option that includes a cookie. However, the utilization of
        this option consumes space in the limited TCP header. Furthermore,
        there are situations, as noted in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc7413#section-7.3">Section 7.3</a> of [<a class="xref" href="#RFC7413">RFC7413</a>]</span>, where it is possible to accept the
        payload of SYN packets without creating additional security risks such
        as a network where addresses cannot be spoofed and the Transport
        Converter only serves a set of hosts that are identified by these
        addresses.<a class="pilcrow" href="#section-4.2-15">¶</a></p>
<p id="section-4.2-16">For these reasons, this specification does not mandate the use of
        the TCP Fast Open option when the Client sends a connection
        establishment packet towards a Transport Converter. The Convert
        Protocol includes an optional Cookie TLV that provides similar
        protection as the TCP Fast Open option without consuming space in the
        TCP header. Furthermore, this design allows for the use of longer
        cookies than <span>[<a class="xref" href="#RFC7413">RFC7413</a>]</span>.<a class="pilcrow" href="#section-4.2-16">¶</a></p>
<p id="section-4.2-17">If the downstream (or upstream) connection fails for some reason
        (excessive retransmissions, reception of an RST segment, etc.), then
        the Converter reacts by forcing the teardown of the upstream (or
        downstream) connection. In particular, if an ICMP error message that
        indicates a hard error is received on the downstream connection, the
        Converter echoes the Code field of that ICMP message in a Destination
        Unreachable Error TLV (see <a class="xref" href="#sec-error">Section 6.2.8</a>) that it
        transmits to the Client. Note that if an ICMP error message that
        indicates a soft error is received on the downstream connection, the
        Converter will retransmit the corresponding data until it is
        acknowledged or the connection times out. A classification of ICMP
        soft and hard errors is provided in Table 1 of <span>[<a class="xref" href="#RFC5461">RFC5461</a>]</span>.<a class="pilcrow" href="#section-4.2-17">¶</a></p>
<p id="section-4.2-18">The same reasoning applies when the upstream connection ends with
        an exchange of FIN segments. In this case, the Converter will also
        terminate the downstream connection by using FIN segments. If the
        downstream connection terminates with the exchange of FIN segments,
        the Converter should initiate a graceful termination of the upstream
        connection.<a class="pilcrow" href="#section-4.2-18">¶</a></p>
</section>
</div>
<div id="sec-dbb">
<section id="section-4.3">
        <h3 id="name-data-processing-at-the-tran">
<a class="section-number selfRef" href="#section-4.3">4.3. </a><a class="section-name selfRef" href="#name-data-processing-at-the-tran">Data Processing at the Transport Converter</a>
        </h3>
<p id="section-4.3-1">As mentioned in <a class="xref" href="#sec-to">Section 4.2</a>, the Transport
        Converter acts as a TCP proxy between the upstream connection (i.e.,
        between the Client and the Transport Converter) and the downstream
        connection (i.e., between the Transport Converter and the Server).<a class="pilcrow" href="#section-4.3-1">¶</a></p>
<p id="section-4.3-2">The control messages (i.e., the Convert messages discussed in <a class="xref" href="#sec-protocol">Section 6</a>) establish state (called transport session entry)
        in the Transport Converter that will enable it to proxy between the
        two TCP connections.<a class="pilcrow" href="#section-4.3-2">¶</a></p>
<p id="section-4.3-3">The Transport Converter uses the transport session entry to proxy
        packets belonging to the connection. An implementation example of a
        transport session entry for TCP connections is shown in <a class="xref" href="#fig-dbt">Figure 7</a>.<a class="pilcrow" href="#section-4.3-3">¶</a></p>
<span id="name-an-example-of-transport-ses"></span><div id="fig-dbt">
<figure id="figure-7">
          <div class="artwork art-text alignLeft" id="section-4.3-4.1">
<pre>                   (C,c) &lt;--&gt; (T,t), (S,s), Lifetime
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-7">Figure 7</a>:
<a class="selfRef" href="#name-an-example-of-transport-ses">An Example of Transport Session Entry</a>
          </figcaption></figure>
</div>
<p id="section-4.3-5">   Where:<a class="pilcrow" href="#section-4.3-5">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3-6.1">C and c are the source IP address and source port number used by the
Client for the upstream connection.<a class="pilcrow" href="#section-4.3-6.1">¶</a>
</li>
          <li class="normal" id="section-4.3-6.2">S and s are the Server's IP address and port number.<a class="pilcrow" href="#section-4.3-6.2">¶</a>
</li>
          <li class="normal" id="section-4.3-6.3">T and t are the source IP address and source port number used by the
Transport Converter to proxy the connection.<a class="pilcrow" href="#section-4.3-6.3">¶</a>
</li>
          <li class="normal" id="section-4.3-6.4">Lifetime is a timer that tracks the remaining lifetime of the entry as
assigned by the Converter. When the timer expires, the entry is deleted.<a class="pilcrow" href="#section-4.3-6.4">¶</a>
</li>
        </ul>
<p id="section-4.3-7">Clients send packets bound to connections eligible for the
        conversion service to the provisioned Transport Converter and
        destination port number. This applies for both control messages and
        data. Additional information is supplied by Clients to the Transport
        Converter by means of Convert messages as detailed in <a class="xref" href="#sec-protocol">Section 6</a>. User data can be included in
        SYN or non-SYN messages. User data is unambiguously distinguished from
        Convert TLVs by a Transport Converter owing to the Convert Fixed
        Header in the Convert messages (<a class="xref" href="#sec-header">Section 6.1</a>).  These Convert TLVs are destined to the Transport
        Convert and are, thus, removed by the Transport Converter when
        proxying between the two connections.<a class="pilcrow" href="#section-4.3-7">¶</a></p>
<p id="section-4.3-8">Upon receipt of a packet that belongs to an existing connection
        between a Client and the Transport Converter, the Converter proxies the
        user data to the Server using the information stored in the
        corresponding transport session entry. For example, in reference to
        <a class="xref" href="#fig-dbt">Figure 7</a>, the Transport Converter proxies the
        data received from (C,⁠c) downstream using (T,t) as source transport
        address and (S,s) as destination transport address.<a class="pilcrow" href="#section-4.3-8">¶</a></p>
<p id="section-4.3-9">A similar process happens for data sent from the Server. The
        Converter acts as a TCP proxy and sends the data to the Client relying
        upon the information stored in a transport session entry. The
        Converter associates a lifetime with state entries used to bind an
        upstream connection with its downstream connection.<a class="pilcrow" href="#section-4.3-9">¶</a></p>
<p id="section-4.3-10">When Multipath TCP is used between the Client and the Transport
        Converter, the Converter maintains more state (e.g., information about
        the subflows) for each Multipath TCP connection. The procedure
        described above continues to apply except that the Converter needs to
        manage the establishment/termination of subflows and schedule packets
        among the established ones. These operations are part of the Multipath
        TCP implementation. They are independent of the Convert Protocol that
        only processes the Convert messages in the beginning of the
        bytestream.<a class="pilcrow" href="#section-4.3-10">¶</a></p>
<p id="section-4.3-11">A Transport Converter may operate in address preservation mode
        (that is, the Converter does not rewrite the source IP address (i.e.,
        C==T)) or address-sharing mode (that is, an address pool is shared
        among all Clients serviced by the Converter (i.e., C!=T)); refer to
        <a class="xref" href="#sec-add">Section 4.4</a> for more details. Which
        behavior to use by a Transport Converter is deployment specific. If
        address-sharing mode is enabled, the Transport Converter
        <span class="bcp14">MUST</span> adhere to REQ-2 of <span>[<a class="xref" href="#RFC6888">RFC6888</a>]</span>, which implies a default "IP address pooling"
        behavior of "Paired" (as defined in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc4787#section-4.1">Section 4.1</a> of [<a class="xref" href="#RFC4787">RFC4787</a>]</span>) <span class="bcp14">MUST</span> be
        supported. This behavior is meant to avoid breaking applications that
        depend on the source address remaining constant.<a class="pilcrow" href="#section-4.3-11">¶</a></p>
</section>
</div>
<div id="sec-add">
<section id="section-4.4">
        <h3 id="name-address-preservation-vs-add">
<a class="section-number selfRef" href="#section-4.4">4.4. </a><a class="section-name selfRef" href="#name-address-preservation-vs-add">Address Preservation vs. Address Sharing</a>
        </h3>
<p id="section-4.4-1">The Transport Converter is provided with instructions about the
        behavior to adopt with regard to the processing of source addresses
        of outgoing packets. The following subsections discuss two
        deployment models for illustration purposes. It is out of the scope of
        this document to make a recommendation.<a class="pilcrow" href="#section-4.4-1">¶</a></p>
<div id="sec-addp">
<section id="section-4.4.1">
          <h4 id="name-address-preservation">
<a class="section-number selfRef" href="#section-4.4.1">4.4.1. </a><a class="section-name selfRef" href="#name-address-preservation">Address Preservation</a>
          </h4>
<p id="section-4.4.1-1">In this model, the visible source IP address of a packet proxied
          by a Transport Converter to a Server is an IP address of the end
          host (Client). No dedicated IP address pool is provisioned to the
          Transport Converter, but the Transport Converter is located on the
          path between the Client and the Server.<a class="pilcrow" href="#section-4.4.1-1">¶</a></p>
<p id="section-4.4.1-2">For Multipath TCP, the Transport Converter preserves the source
          IP address used by the Client when establishing the initial subflow.
          Data conveyed in secondary subflows will be proxied by the Transport
          Converter using the source IP address of the initial subflow. An
          example of a proxied Multipath TCP connection with address
          preservation is shown in <a class="xref" href="#fig-addp">Figure 8</a>.<a class="pilcrow" href="#section-4.4.1-2">¶</a></p>
<span id="name-example-of-address-preserva"></span><div id="fig-addp">
<figure id="figure-8">
            <div class="artwork art-text alignLeft" id="section-4.4.1-3.1">
<pre>                                      Transport
       Client                        Converter          Server

        @:C1,C2                        @:Tc                @:S
           ||                            |                  |
           |src:C1     SYN         dst:Tc|src:C1       dst:S|
           |-------MPC [-&gt;S:port]-------&gt;|-------SYN-------&gt;|
           ||                            |                  |
           ||dst:C1                src:Tc|dst:C1       src:S|
           |&lt;---------SYN/ACK------------|&lt;-----SYN/ACK-----|
           ||                            |                  |
           |src:C1                 dst:Tc|src:C1       dst:S|
           |------------ACK-------------&gt;|-------ACK-------&gt;|
           |                             |                  |
           |src:C2          ...    dst:Tc|       ...        |
           ||&lt;-----Secondary Subflow----&gt;|src:C1       dst:S|
           ||                            |-------data------&gt;|
           |               ..            |    ...           |

Legend:
  Tc: IP address used by the Transport Converter on the internal
      realm.
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-8">Figure 8</a>:
<a class="selfRef" href="#name-example-of-address-preserva">Example of Address Preservation</a>
            </figcaption></figure>
</div>
<p id="section-4.4.1-4">The Transport Converter must be on the forwarding path of
          incoming traffic. Because the same (destination) IP address is used
          for both proxied and non-proxied connections, the Transport
          Converter should not drop incoming packets it intercepts if no
          matching entry is found for the packets. Unless explicitly
          configured otherwise, such packets are forwarded according to the
          instructions of a local forwarding table.<a class="pilcrow" href="#section-4.4.1-4">¶</a></p>
</section>
</div>
<div id="sec-adds">
<section id="section-4.4.2">
          <h4 id="name-address-prefix-sharing">
<a class="section-number selfRef" href="#section-4.4.2">4.4.2. </a><a class="section-name selfRef" href="#name-address-prefix-sharing">Address/Prefix Sharing</a>
          </h4>
<p id="section-4.4.2-1">A pool of global IPv4 addresses is provisioned to the Transport
          Converter along with possible instructions about the address-sharing
          ratio to apply (see <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc6269#appendix-B">Appendix B</a> of [<a class="xref" href="#RFC6269">RFC6269</a>]</span>).
          An address is thus shared among multiple Clients.<a class="pilcrow" href="#section-4.4.2-1">¶</a></p>
<p id="section-4.4.2-2">Likewise, rewriting the source IPv6 prefix <span>[<a class="xref" href="#RFC6296">RFC6296</a>]</span> may be used to ease redirection of incoming
          IPv6 traffic towards the appropriate Transport Converter. A pool of
          IPv6 prefixes is then provisioned to the Transport Converter for
          this purpose.<a class="pilcrow" href="#section-4.4.2-2">¶</a></p>
<p id="section-4.4.2-3">Adequate forwarding policies are enforced so that traffic
          destined to an address of such a pool is intercepted by the
          appropriate Transport Converter. Unlike <a class="xref" href="#sec-addp">Section 4.4.1</a>, the Transport Converter drops incoming packets
          that do not match an active transport session entry.<a class="pilcrow" href="#section-4.4.2-3">¶</a></p>
<p id="section-4.4.2-4">An example is shown in <a class="xref" href="#fig-adds">Figure 9</a>.<a class="pilcrow" href="#section-4.4.2-4">¶</a></p>
<span id="name-address-sharing"></span><div id="fig-adds">
<figure id="figure-9">
            <div class="artwork art-text alignLeft" id="section-4.4.2-5.1">
<pre>                                     Transport
      Client                         Converter          Server

         @:C                        @:Tc|Te                @:S
          |                             |                  |
          |src:C                  dst:Tc|src:Te       dst:S|
          |-------SYN [-&gt;S:port]-------&gt;|-------SYN-------&gt;|
          |                             |                  |
          |dst:C                  src:Tc|dst:Te       src:S|
          |&lt;---------SYN/ACK------------|&lt;-----SYN/ACK-----|
          |                             |                  |
          |src:C                  dst:Tc|src:Te       dst:S|
          |------------ACK-------------&gt;|-------ACK-------&gt;|
          |                             |                  |
          |              ...            |    ...           |

Legend:
  Tc: IP address used by the Transport Converter on the internal
      realm.
  Te: IP address used by the Transport Converter on the external
      realm.
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-9">Figure 9</a>:
<a class="selfRef" href="#name-address-sharing">Address Sharing</a>
            </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="sample-examples">
<section id="section-5">
      <h2 id="name-sample-examples">
<a class="section-number selfRef" href="#section-5">5. </a><a class="section-name selfRef" href="#name-sample-examples">Sample Examples</a>
      </h2>
<div id="outgoing-converter-assisted-multipath-tcp-connections">
<section id="section-5.1">
        <h3 id="name-outgoing-converter-assisted">
<a class="section-number selfRef" href="#section-5.1">5.1. </a><a class="section-name selfRef" href="#name-outgoing-converter-assisted">Outgoing Converter-Assisted Multipath TCP Connections</a>
        </h3>
<p id="section-5.1-1">As an example, let us consider how the Convert Protocol can help
        the deployment of Multipath TCP. We assume that both the Client and
        the Transport Converter support Multipath TCP but consider two
        different cases depending on whether or not the Server supports Multipath TCP.<a class="pilcrow" href="#section-5.1-1">¶</a></p>
<p id="section-5.1-2">As a reminder, a Multipath TCP connection is created by placing the
        MP_CAPABLE (MPC) option in the SYN sent by the Client.<a class="pilcrow" href="#section-5.1-2">¶</a></p>
<p id="section-5.1-3"><a class="xref" href="#fig-mpestab">Figure 10</a> describes the operation of the
        Transport Converter if the Server does not support Multipath TCP.<a class="pilcrow" href="#section-5.1-3">¶</a></p>
<span id="name-establishment-of-a-multipat"></span><div id="fig-mpestab">
<figure id="figure-10">
          <div class="artwork art-text alignLeft" id="section-5.1-4.1">
<pre>                        Transport
    Client              Converter              Server
       |SYN, MPC           |                      |
       |[-&gt;Server:port]    |         SYN, MPC     |
       |------------------&gt;|---------------------&gt;|
       |&lt;------------------|&lt;---------------------|
       |  SYN+ACK,MPC [.]  |      SYN+ACK         |
       |------------------&gt;|---------------------&gt;|
       |     ACK, MPC      |          ACK         |
       |        ...        |          ...         |
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-10">Figure 10</a>:
<a class="selfRef" href="#name-establishment-of-a-multipat">Establishment of a Multipath TCP Connection through a
          Transport Converter towards a Server That Does Not support Multipath
          TCP</a>
          </figcaption></figure>
</div>
<p id="section-5.1-5">The Client tries to initiate a Multipath TCP connection by sending
        a SYN with the MP_CAPABLE option (MPC in <a class="xref" href="#fig-mpestab">Figure 10</a>). The SYN includes the address and port
        number of the target Server, that are extracted and used by the
        Transport Converter to initiate a Multipath TCP connection towards
        this Server. Since the Server does not support Multipath TCP, it
        replies with a SYN+ACK that does not contain the MP_CAPABLE option.
        The Transport Converter notes that the connection with the Server does
        not support Multipath TCP and returns the extended TCP header received
        from the Server to the Client.<a class="pilcrow" href="#section-5.1-5">¶</a></p>
<p id="section-5.1-6">Note that, if the TCP connection is reset for some reason, the
        Converter tears down the Multipath TCP connection by transmitting an
        MP_FASTCLOSE. Likewise, if the Multipath TCP connection ends with the
        transmission of DATA_FINs, the Converter terminates the TCP connection
        by using FIN segments. As a side note, given that with Multipath TCP,
        RST only has the scope of the subflow and will only close the
        concerned subflow but not affect the remaining subflows, the Converter
        does not terminate the downstream TCP connection upon receipt of an
        RST over a Multipath subflow.<a class="pilcrow" href="#section-5.1-6">¶</a></p>
<p id="section-5.1-7"><a class="xref" href="#fig-mpestabok">Figure 11</a> considers a Server that
        supports Multipath TCP. In this case, it replies to the SYN sent by
        the Transport Converter with the MP_CAPABLE option. Upon reception of
        this SYN+ACK, the Transport Converter confirms the establishment of
        the connection to the Client and indicates to the Client that the
        Server supports Multipath TCP. With this information, the Client has
        discovered that the Server supports Multipath TCP. This will enable
        the Client to bypass the Transport Converter for the subsequent
        Multipath TCP connections that it will initiate towards this
        Server.<a class="pilcrow" href="#section-5.1-7">¶</a></p>
<span id="name-establishment-of-a-multipath"></span><div id="fig-mpestabok">
<figure id="figure-11">
          <div class="artwork art-text alignLeft" id="section-5.1-8.1">
<pre>                        Transport
    Client              Converter              Server
       |SYN, MPC           |                      |
       |[-&gt;Server:port]    |         SYN, MPC     |
       |------------------&gt;|---------------------&gt;|
       |&lt;------------------|&lt;---------------------|
       |SYN+ACK, MPC       |      SYN+ACK, MPC    |
       |[MPC supported]    |                      |
       |------------------&gt;|---------------------&gt;|
       |     ACK, MPC      |        ACK, MPC      |
       |        ...        |          ...         |

</pre>
</div>
<figcaption><a class="selfRef" href="#figure-11">Figure 11</a>:
<a class="selfRef" href="#name-establishment-of-a-multipath">Establishment of a Multipath TCP Connection through a
          Converter towards an MPTCP-Capable Server</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="incoming-converter-assisted-multipath-tcp-connection">
<section id="section-5.2">
        <h3 id="name-incoming-converter-assisted">
<a class="section-number selfRef" href="#section-5.2">5.2. </a><a class="section-name selfRef" href="#name-incoming-converter-assisted">Incoming Converter-Assisted Multipath TCP Connection</a>
        </h3>
<p id="section-5.2-1">An example of an incoming Converter-assisted Multipath TCP
        connection is depicted in <a class="xref" href="#fig-inestab">Figure 12</a>. In order to support incoming connections from
        remote hosts, the Client may use the Port Control Protocol (PCP) <span>[<a class="xref" href="#RFC6887">RFC6887</a>]</span> to instruct the Transport
        Converter to create dynamic mappings. Those mappings will be used by
        the Transport Converter to intercept an incoming TCP connection
        destined to the Client and convert it into a Multipath TCP
        connection.<a class="pilcrow" href="#section-5.2-1">¶</a></p>
<p id="section-5.2-2">Typically, the Client sends a PCP request to the Converter asking
        to create an explicit TCP mapping for the internal IP address and
        internal port number. The Converter accepts the request by creating a
        TCP mapping for the internal IP address, internal port number,
        external IP address, and external port number. The external IP
        address, external port number, and assigned lifetime are returned back
        to the Client in the PCP response. The external IP address and
        external port number will then be advertised by the Client (or the
        user) using an out-of-band mechanism so that remote hosts can initiate
        TCP connections to the Client via the Converter. Note that the
        external and internal information may be the same.<a class="pilcrow" href="#section-5.2-2">¶</a></p>
<p id="section-5.2-3">Then, when the Converter receives an incoming SYN, it checks its
        mapping table to verify if there is an active mapping matching the
        destination IP address and destination port of that SYN. If no entry
        is found, the Converter silently ignores the message. If an entry is
        found, the Converter inserts an MP_CAPABLE option and Connect TLV in
        the SYN packet, and rewrites the source IP address to one of its IP
        addresses and, eventually, the destination IP address and port number
        in accordance with the information stored in the mapping. SYN+ACK and
        ACK will then be exchanged between the Client and the Converter to
        confirm the establishment of the initial subflow. The Client can add
        new subflows following normal Multipath TCP procedures.<a class="pilcrow" href="#section-5.2-3">¶</a></p>
<span id="name-establishment-of-an-incoming"></span><div id="fig-inestab">
<figure id="figure-12">
          <div class="artwork art-text alignLeft" id="section-5.2-4.1">
<pre>                        Transport             Remote
    Client              Converter              Host
      |                     |                    |
      |&lt;--------------------|&lt;-------------------|
      |SYN, MPC             |         SYN        |
      |[Remote Host:port]   |                    |
      |--------------------&gt;|-------------------&gt;|
      |      SYN+ACK, MPC   |       SYN+ACK      |
      |&lt;--------------------|&lt;-------------------|
      |       ACK, MPC      |           ACK      |
      |        ...          |          ...       |
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-12">Figure 12</a>:
<a class="selfRef" href="#name-establishment-of-an-incoming">Establishment of an Incoming Multipath TCP Connection through a Transport Converter</a>
          </figcaption></figure>
</div>
<p id="section-5.2-5">It is out of scope of this document to define specific Convert TLVs
        to manage incoming connections (that is, TLVs that mimic PCP
        messages). These TLVs can be defined in a separate document.<a class="pilcrow" href="#section-5.2-5">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-protocol">
<section id="section-6">
      <h2 id="name-the-convert-protocol-conver">
<a class="section-number selfRef" href="#section-6">6. </a><a class="section-name selfRef" href="#name-the-convert-protocol-conver">The Convert Protocol (Convert)</a>
      </h2>
<p id="section-6-1">This section defines the Convert Protocol (Convert, for short)
      messages that are exchanged between a Client and a Transport
      Converter.<a class="pilcrow" href="#section-6-1">¶</a></p>
<p id="section-6-2">The Transport Converter listens on a specific TCP port number for
      Convert messages from Clients. That port number is configured by an
      administrator. Absent any policy, the Transport Converter <span class="bcp14">SHOULD</span>
      silently ignore SYNs with no Convert TLVs.<a class="pilcrow" href="#section-6-2">¶</a></p>
<p id="section-6-3">Convert messages may appear only in SYN, SYN+ACK, or ACK.<a class="pilcrow" href="#section-6-3">¶</a></p>
<p id="section-6-4">Convert messages <span class="bcp14">MUST</span> be included as the first bytes
      of the bytestream. All Convert messages start with a fixed header that
      is 32 bits long (<a class="xref" href="#sec-header">Section 6.1</a>) followed
      by one or more Convert TLVs (Type, Length, Value) (<a class="xref" href="#sec-tlv">Section 6.2</a>).<a class="pilcrow" href="#section-6-4">¶</a></p>
<p id="section-6-5">If the initial SYN message contains user data in its payload (e.g., see
      <span>[<a class="xref" href="#RFC7413">RFC7413</a>]</span>), that data <span class="bcp14">MUST</span> be placed right after
      the Convert TLVs when generating the SYN.<a class="pilcrow" href="#section-6-5">¶</a></p>
<p id="section-6-6">The protocol can be extended by defining new TLVs or bumping the
      version number if a different message format is needed. If a future
      version is defined but with a different message format, the version
      negotiation procedure defined in <a class="xref" href="#sec-error">Section 6.2.8</a> (see
      "Unsupported Version") is meant to agree on a version that is supported
      by both peers.<a class="pilcrow" href="#section-6-6">¶</a></p>
<aside id="section-6-7">
        <p id="section-6-7.1">Implementation note 1: Several implementers expressed concerns
        about the use of TFO. As a reminder, the Fast Open Cookie protects from some
        attack scenarios that affect open servers like web servers. The
        Convert Protocol is different and, as discussed in <span>[<a class="xref" href="#RFC7413">RFC7413</a>]</span>, there are different ways to protect from such
        attacks. Instead of using a Fast Open Cookie inside the TCP options, which
        consumes precious space in the extended TCP header, the Convert
        Protocol supports the utilization of a Cookie that is placed in the
        SYN payload. This provides the same level of protection as a Fast Open
        Cookie in environments were such protection is required.<a class="pilcrow" href="#section-6-7.1">¶</a></p>
<p id="section-6-7.2">Implementation note 2: Error messages are not included in RST but
          sent in the bytestream. Implementers have indicated that processing
          RST on Clients was difficult on some platforms. This design
          simplifies Client implementations.<a class="pilcrow" href="#section-6-7.2">¶</a></p>
</aside>
<div id="sec-header">
<section id="section-6.1">
        <h3 id="name-the-convert-fixed-header">
<a class="section-number selfRef" href="#section-6.1">6.1. </a><a class="section-name selfRef" href="#name-the-convert-fixed-header">The Convert Fixed Header</a>
        </h3>
<p id="section-6.1-1">The Convert Protocol uses a fixed header that is 32 bits long sent
        by both the Client and the Transport Converter over each established
        connection. This header indicates both the version of the protocol
        used and the length of the Convert message.<a class="pilcrow" href="#section-6.1-1">¶</a></p>
<p id="section-6.1-2">The Client and the Transport Converter <span class="bcp14">MUST</span> send the fixed-sized
        header, shown in <a class="xref" href="#fig-header">Figure 13</a>, as the first four
        bytes of the bytestream.<a class="pilcrow" href="#section-6.1-2">¶</a></p>
<span id="name-the-convert-fixed-header-2"></span><div id="fig-header">
<figure id="figure-13">
          <div class="artwork art-text alignLeft" id="section-6.1-3.1">
<pre>                     1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+-------------------------------+
|  Version      |  Total Length |          Magic Number         |
+---------------+---------------+-------------------------------+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-13">Figure 13</a>:
<a class="selfRef" href="#name-the-convert-fixed-header-2">The Convert Fixed Header</a>
          </figcaption></figure>
</div>
<p id="section-6.1-4">The version is encoded as an 8-bit unsigned integer value. This
        document specifies version 1. Version 0 is reserved by this document
        and <span class="bcp14">MUST NOT</span> be used.<a class="pilcrow" href="#section-6.1-4">¶</a></p>
<aside id="section-6.1-5">
          <p id="section-6.1-5.1">
            Note: Early versions of this specification don't use a
            dedicated port number but only rely upon the IP address of the
            Converter. Having a bit set in the Version field together with the
            Total Length field avoids misinterpreting data in a SYN as Convert
     TLVs. Since the design was updated to use a specific
            service port, that constraint was relaxed. Version 0 would work,
            but given existing implementations already use Version 1, the use
            of Version 0 is maintained as reserved.<a class="pilcrow" href="#section-6.1-5.1">¶</a></p>
</aside>
<p id="section-6.1-6">The Total Length is the number of 32-bit words, including the
        header, of the bytestream that are consumed by the Convert messages.
        Since Total Length is also an 8-bit unsigned integer, those messages
        cannot consume more than 1020 bytes of data. This limits the number of
        bytes that a Transport Converter needs to process. A Total Length of
        zero is invalid and the connection <span class="bcp14">MUST</span> be reset upon reception of a
        header with such a total length.<a class="pilcrow" href="#section-6.1-6">¶</a></p>
<p id="section-6.1-7">The Magic Number field <span class="bcp14">MUST</span> be set to 0x2263. This
 field is meant to further strengthen the protocol to unambiguously
 distinguish any data supplied by an application from Convert TLVs.<a class="pilcrow" href="#section-6.1-7">¶</a></p>
<p id="section-6.1-8">The Total Length field unambiguously marks the number of 32-bit
        words that carry Convert TLVs in the beginning of the bytestream.<a class="pilcrow" href="#section-6.1-8">¶</a></p>
</section>
</div>
<div id="sec-tlv">
<section id="section-6.2">
        <h3 id="name-convert-tlvs">
<a class="section-number selfRef" href="#section-6.2">6.2. </a><a class="section-name selfRef" href="#name-convert-tlvs">Convert TLVs</a>
        </h3>
<div id="generic-convert-tlv-format">
<section id="section-6.2.1">
          <h4 id="name-generic-convert-tlv-format">
<a class="section-number selfRef" href="#section-6.2.1">6.2.1. </a><a class="section-name selfRef" href="#name-generic-convert-tlv-format">Generic Convert TLV Format</a>
          </h4>
<p id="section-6.2.1-1">The Convert Protocol uses variable length messages that are
          encoded using the generic TLV format depicted in <a class="xref" href="#fi-generictlv">Figure 14</a>.<a class="pilcrow" href="#section-6.2.1-1">¶</a></p>
<p id="section-6.2.1-2">The length of all TLVs used by the Convert Protocol is always a
          multiple of four bytes. All TLVs are aligned on 32-bit boundaries.
          All TLV fields are encoded using the network byte order.<a class="pilcrow" href="#section-6.2.1-2">¶</a></p>
<span id="name-convert-generic-tlv-format"></span><div id="fi-generictlv">
<figure id="figure-14">
            <div class="artwork art-text alignLeft" id="section-6.2.1-3.1">
<pre>                        1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +---------------+---------------+-------------------------------+
   |     Type      |     Length    |             Value  ...        |
   +---------------+---------------+-------------------------------+
   //              ...   (optional) Value                         //
   +---------------------------------------------------------------+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-14">Figure 14</a>:
<a class="selfRef" href="#name-convert-generic-tlv-format">Convert Generic TLV Format</a>
            </figcaption></figure>
</div>
<p id="section-6.2.1-4">The Length field covers Type, Length, and Value fields. It is
          expressed in units of 32-bit words. If necessary, Value <span class="bcp14">MUST</span> be
          padded with zeroes so that the length of the TLV is a multiple of 32
          bits.<a class="pilcrow" href="#section-6.2.1-4">¶</a></p>
<p id="section-6.2.1-5">A given TLV <span class="bcp14">MUST</span> only appear once on a connection. If a Client
          receives two or more instances of the same TLV over a Convert
          connection, it <span class="bcp14">MUST</span> reset the associated TCP connection. If a
          Converter receives two or more instances of the same TLV over a
          Convert connection, it <span class="bcp14">MUST</span> return a Malformed Message Error TLV and
          close the associated TCP connection.<a class="pilcrow" href="#section-6.2.1-5">¶</a></p>
</section>
</div>
<div id="summary-of-supported-convert-tlvs">
<section id="section-6.2.2">
          <h4 id="name-summary-of-supported-conver">
<a class="section-number selfRef" href="#section-6.2.2">6.2.2. </a><a class="section-name selfRef" href="#name-summary-of-supported-conver">Summary of Supported Convert TLVs</a>
          </h4>
<p id="section-6.2.2-1">This document specifies the following Convert TLVs:<a class="pilcrow" href="#section-6.2.2-1">¶</a></p>
<span id="name-the-tlvs-used-by-the-conver"></span><div id="tab-converter-tlv">
<table class="center" id="table-1">
            <caption>
<a class="selfRef" href="#table-1">Table 1</a>:
<a class="selfRef" href="#name-the-tlvs-used-by-the-conver">The TLVs Used by the Convert Protocol</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" colspan="1" rowspan="1">Type</th>
                <th class="text-left" colspan="1" rowspan="1">Hex</th>
                <th class="text-left" colspan="1" rowspan="1">Length</th>
                <th class="text-left" colspan="1" rowspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">1</td>
                <td class="text-left" colspan="1" rowspan="1">0x1</td>
                <td class="text-left" colspan="1" rowspan="1">1</td>
                <td class="text-left" colspan="1" rowspan="1">Info TLV</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">10</td>
                <td class="text-left" colspan="1" rowspan="1">0xA</td>
                <td class="text-left" colspan="1" rowspan="1">Variable</td>
                <td class="text-left" colspan="1" rowspan="1">Connect TLV</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">20</td>
                <td class="text-left" colspan="1" rowspan="1">0x14</td>
                <td class="text-left" colspan="1" rowspan="1">Variable</td>
                <td class="text-left" colspan="1" rowspan="1">Extended TCP Header TLV</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">21</td>
                <td class="text-left" colspan="1" rowspan="1">0x15</td>
                <td class="text-left" colspan="1" rowspan="1">Variable</td>
                <td class="text-left" colspan="1" rowspan="1">Supported TCP Extensions TLV</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">22</td>
                <td class="text-left" colspan="1" rowspan="1">0x16</td>
                <td class="text-left" colspan="1" rowspan="1">Variable</td>
                <td class="text-left" colspan="1" rowspan="1">Cookie TLV</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">30</td>
                <td class="text-left" colspan="1" rowspan="1">0x1E</td>
                <td class="text-left" colspan="1" rowspan="1">Variable</td>
                <td class="text-left" colspan="1" rowspan="1">Error TLV</td>
              </tr>
            </tbody>
          </table>
</div>
<p id="section-6.2.2-3">Type 0x0 is a reserved value. If a Client receives a TLV of type
          0x0, it <span class="bcp14">MUST</span> reset the associated TCP connection. If a Converter
          receives a TLV of type 0x0, it <span class="bcp14">MUST</span> return an Unsupported Message
          Error TLV and close the associated TCP connection.<a class="pilcrow" href="#section-6.2.2-3">¶</a></p>
<p id="section-6.2.2-4">The Client typically sends, in the first connection it established
          with a Transport Converter, the Info TLV (<a class="xref" href="#sec-bootstrap-tlv">Section 6.2.3</a>) to learn its
          capabilities.  Assuming the Client is authorized to invoke the
          Transport Converter, the latter replies with the Supported TCP
          Extensions TLV (<a class="xref" href="#sec-supported">Section 6.2.4</a>).<a class="pilcrow" href="#section-6.2.2-4">¶</a></p>
<p id="section-6.2.2-5">The Client can request the establishment of connections to
          Servers by using the Connect TLV (<a class="xref" href="#sec-connect">Section 6.2.5</a>). If the connection can be established with the
          final Server, the Transport Converter replies with the Extended TCP
          Header TLV (<a class="xref" href="#sec-ext-header">Section 6.2.6</a>). If
          not, the Transport Converter <span class="bcp14">MUST</span> return an Error TLV
          (<a class="xref" href="#sec-error">Section 6.2.8</a>) and then close the
          connection. The Transport Converter <span class="bcp14">MUST NOT</span> send an
          RST immediately after the detection of an error to let the Error TLV
          reach the Client. As explained later, the Client will send an RST
          regardless upon reception of the Error TLV.<a class="pilcrow" href="#section-6.2.2-5">¶</a></p>
</section>
</div>
<div id="sec-bootstrap-tlv">
<section id="section-6.2.3">
          <h4 id="name-the-info-tlv">
<a class="section-number selfRef" href="#section-6.2.3">6.2.3. </a><a class="section-name selfRef" href="#name-the-info-tlv">The Info TLV</a>
          </h4>
<p id="section-6.2.3-1">The Info TLV (<a class="xref" href="#fig-bootstrap">Figure 15</a>) is
          an optional TLV that can be sent by a Client to request the TCP
          extensions that are supported by a Transport Converter. It is
          typically sent on the first connection that a Client establishes
          with a Transport Converter to learn its capabilities. Assuming a
          Client is entitled to invoke the Transport Converter, the latter
          replies with the Supported TCP Extensions TLV described in <a class="xref" href="#sec-supported">Section 6.2.4</a>.<a class="pilcrow" href="#section-6.2.3-1">¶</a></p>
<span id="name-the-info-tlv-2"></span><div id="fig-bootstrap">
<figure id="figure-15">
            <div class="artwork art-text alignLeft" id="section-6.2.3-2.1">
<pre>                     1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+-------------------------------+
|     Type=0x1  |     Length    |             Zero              |
+---------------+---------------+-------------------------------+

</pre>
</div>
<figcaption><a class="selfRef" href="#figure-15">Figure 15</a>:
<a class="selfRef" href="#name-the-info-tlv-2">The Info TLV</a>
            </figcaption></figure>
</div>
</section>
</div>
<div id="sec-supported">
<section id="section-6.2.4">
          <h4 id="name-supported-tcp-extensions-tl">
<a class="section-number selfRef" href="#section-6.2.4">6.2.4. </a><a class="section-name selfRef" href="#name-supported-tcp-extensions-tl">Supported TCP Extensions TLV</a>
          </h4>
<p id="section-6.2.4-1">The Supported TCP Extensions TLV (<a class="xref" href="#fig-supported">Figure 16</a>) is used by a Transport Converter to announce the
          TCP options for which it provides a conversion service.  A Transport
          Converter <span class="bcp14">SHOULD</span> include in this list the TCP options
          that it supports in outgoing SYNs.<a class="pilcrow" href="#section-6.2.4-1">¶</a></p>
<p id="section-6.2.4-2">Each supported TCP option is encoded with its TCP option Kind
          listed in the "Transmission Control Protocol (TCP) Parameters"
          registry maintained by IANA <span>[<a class="xref" href="#IANA-CONVERT">IANA-CONVERT</a>]</span>. The Unassigned field
          <span class="bcp14">MUST</span> be set to zero by the Transport Converter and
          ignored by the Client.<a class="pilcrow" href="#section-6.2.4-2">¶</a></p>
<span id="name-the-supported-tcp-extension"></span><div id="fig-supported">
<figure id="figure-16">
            <div class="artwork art-text alignLeft" id="section-6.2.4-3.1">
<pre>                      1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +---------------+---------------+-------------------------------+
 |     Type=0x15 |     Length    |           Unassigned          |
 +---------------+---------------+-------------------------------+
 |     Kind #1   |     Kind #2   |           ...                 |
 +---------------+---------------+-------------------------------+
 /                              ...                              /
 /                                                               /
 +---------------------------------------------------------------+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-16">Figure 16</a>:
<a class="selfRef" href="#name-the-supported-tcp-extension">The Supported TCP Extensions TLV</a>
            </figcaption></figure>
</div>
<p id="section-6.2.4-4">TCP option Kinds 1 and 2 defined in <span>[<a class="xref" href="#RFC0793">RFC0793</a>]</span> are supported by all TCP implementations and
          thus, <span class="bcp14">MUST NOT</span> appear in this list.<a class="pilcrow" href="#section-6.2.4-4">¶</a></p>
<p id="section-6.2.4-5">The list of Supported TCP Extensions is padded with 0 to end on a
          32-bit boundary.<a class="pilcrow" href="#section-6.2.4-5">¶</a></p>
<p id="section-6.2.4-6">For example, if the Transport Converter supports Multipath TCP,
          Kind=30 will be present in the Supported TCP Extensions TLV that it
          returns in response to the Info TLV.<a class="pilcrow" href="#section-6.2.4-6">¶</a></p>
</section>
</div>
<div id="sec-connect">
<section id="section-6.2.5">
          <h4 id="name-connect-tlv">
<a class="section-number selfRef" href="#section-6.2.5">6.2.5. </a><a class="section-name selfRef" href="#name-connect-tlv">Connect TLV</a>
          </h4>
<p id="section-6.2.5-1">The Connect TLV (<a class="xref" href="#fig-connect">Figure 17</a>) is used to
          request the establishment of a connection via a Transport Converter.
          This connection can be from or to a Client.<a class="pilcrow" href="#section-6.2.5-1">¶</a></p>
<p id="section-6.2.5-2">The Remote Peer Port and Remote Peer IP Address fields
          contain the destination port number and IP address of the Server,
          for outgoing connections. For incoming connections destined to a
          Client serviced via a Transport Converter, these fields convey the
          source port number and IP address of the SYN packet received by the
          Transport Converter from the Server.<a class="pilcrow" href="#section-6.2.5-2">¶</a></p>
<p id="section-6.2.5-3">The Remote Peer IP Address <span class="bcp14">MUST</span> be encoded as an
          IPv6 address.  IPv4 addresses <span class="bcp14">MUST</span> be encoded using
          the IPv4-mapped IPv6 address format defined in <span>[<a class="xref" href="#RFC4291">RFC4291</a>]</span>. Further, the Remote Peer IP
          Address field <span class="bcp14">MUST NOT</span> include multicast, broadcast,
          or host loopback addresses <span>[<a class="xref" href="#RFC6890">RFC6890</a>]</span>. If a Converter receives a Connect TLV with such
          invalid addresses, it <span class="bcp14">MUST</span> reply with a Malformed
          Message Error TLV and close the associated TCP connection.<a class="pilcrow" href="#section-6.2.5-3">¶</a></p>
<p id="section-6.2.5-4">We distinguish two types of Connect TLV based on their length:
          (1) the Base Connect TLV has a length set to 5 (i.e., 20 bytes) and
          contains a remote address and a remote port (<a class="xref" href="#fig-connect">Figure 17</a>), and (2) the Extended Connect TLV spans
          more than 20 bytes and also includes the optional TCP Options
          field (<a class="xref" href="#fig-econnect">Figure 18</a>). This field is used to
          request the advertisement of specific TCP options to the Server.<a class="pilcrow" href="#section-6.2.5-4">¶</a></p>
<span id="name-the-base-connect-tlv"></span><div id="fig-connect">
<figure id="figure-17">
            <div class="artwork art-text alignLeft" id="section-6.2.5-5.1">
<pre>                      1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +---------------+---------------+-------------------------------+
 |     Type=0xA  |     Length    |      Remote Peer Port         |
 +---------------+---------------+-------------------------------+
 |                                                               |
 |         Remote Peer IP Address (128 bits)                     |
 |                                                               |
 |                                                               |
 +---------------------------------------------------------------+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-17">Figure 17</a>:
<a class="selfRef" href="#name-the-base-connect-tlv">The Base Connect TLV</a>
            </figcaption></figure>
</div>
<span id="name-the-extended-connect-tlv"></span><div id="fig-econnect">
<figure id="figure-18">
            <div class="artwork art-text alignLeft" id="section-6.2.5-6.1">
<pre>                      1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +---------------+---------------+-------------------------------+
 |     Type=0xA  |     Length    |      Remote Peer Port         |
 +---------------+---------------+-------------------------------+
 |                                                               |
 |         Remote Peer IP Address (128 bits)                     |
 |                                                               |
 |                                                               |
 +---------------------------------------------------------------+
 /                          TCP Options (Variable)               /
 /                              ...                              /
 +---------------------------------------------------------------+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-18">Figure 18</a>:
<a class="selfRef" href="#name-the-extended-connect-tlv">The Extended Connect TLV</a>
            </figcaption></figure>
</div>
<p id="section-6.2.5-7">The TCP Options field is a variable length field that carries a
          list of TCP option fields (<a class="xref" href="#fig-tcpopt">Figure 19</a>). Each TCP option field is encoded as a block of
          2+n bytes where the first byte is the TCP option Kind and the second
          byte is the length of the TCP option as specified in <span>[<a class="xref" href="#RFC0793">RFC0793</a>]</span>. The minimum value for the TCP
          option Length is 2. The TCP options that do not include a length
          sub-field, i.e., option types 0 (EOL) and 1 (NOP) defined in <span>[<a class="xref" href="#RFC0793">RFC0793</a>]</span> <span class="bcp14">MUST NOT</span> be
          placed inside the TCP options field of the Connect TLV. The optional
          Value field contains the variable-length part of the TCP option. A
          length of 2 indicates the absence of the Value field. The TCP
          options field always ends on a 32-bit boundary after being padded
          with zeros.<a class="pilcrow" href="#section-6.2.5-7">¶</a></p>
<span id="name-the-tcp-options-field"></span><div id="fig-tcpopt">
<figure id="figure-19">
            <div class="artwork art-text alignLeft" id="section-6.2.5-8.1">
<pre>                     1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +---------------+---------------+---------------+---------------+
 |  TCPOpt kind  | TCPOpt Length | Value  (opt)  |  ....         |
 +---------------+---------------+---------------+---------------+
 |                             ....                              |
 +---------------------------------------------------------------+
 |                              ...                              |
 +---------------------------------------------------------------+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-19">Figure 19</a>:
<a class="selfRef" href="#name-the-tcp-options-field">The TCP Options Field</a>
            </figcaption></figure>
</div>
<p id="section-6.2.5-9">Upon reception of a Base Connect TLV, and absent any policy
          (e.g., rate-limit) or resource exhaustion conditions, a Transport
          Converter attempts to establish a connection to the address and port
          that it contains. The Transport Converter <span class="bcp14">MUST</span> use by default the
          TCP options that correspond to its local policy to establish this
          connection.<a class="pilcrow" href="#section-6.2.5-9">¶</a></p>
<p id="section-6.2.5-10">Upon reception of an Extended Connect TLV, a Transport Converter
          first checks whether or not it supports the TCP Options listed in the TCP
          Options field. If not, it returns an error TLV set to "Unsupported
          TCP Option" (<a class="xref" href="#sec-error">Section 6.2.8</a>). If the above check
          succeeded, and absent any rate-limit policy or resource exhaustion
          conditions, a Transport Converter <span class="bcp14">MUST</span> attempt to establish a
          connection to the address and port that it contains. It <span class="bcp14">MUST</span> include
          in the SYN that it sends to the Server the options listed in the
          TCP Options subfield and the TCP options that it would have used
          according to its local policies. For the TCP options that are
          included in the TCP Options field without an optional value, the
          Transport Converter <span class="bcp14">MUST</span> generate its own value. For the TCP options
          that are included in the TCP Options field with an optional value,
          it <span class="bcp14">MUST</span> copy the entire option in the SYN sent to the remote Server.
          This procedure is designed with TFO in mind. Particularly, this
          procedure allows to successfully exchange a Fast Open Cookie between the
          Client and the Server. See <a class="xref" href="#sec-tcpoptions">Section 7</a> for
          a detailed discussion of the different types of TCP options.<a class="pilcrow" href="#section-6.2.5-10">¶</a></p>
<p id="section-6.2.5-11">The Transport Converter may refuse a Connect TLV request for
          various reasons (e.g., authorization failed, out of resources,
          invalid address type, or unsupported TCP option). An error message
          indicating the encountered error is returned to the requesting
          Client (<a class="xref" href="#sec-error">Section 6.2.8</a>). In order to prevent
          denial-of-service attacks, error messages sent to a Client <span class="bcp14">SHOULD</span> be
          rate-limited.<a class="pilcrow" href="#section-6.2.5-11">¶</a></p>
</section>
</div>
<div id="sec-ext-header">
<section id="section-6.2.6">
          <h4 id="name-extended-tcp-header-tlv">
<a class="section-number selfRef" href="#section-6.2.6">6.2.6. </a><a class="section-name selfRef" href="#name-extended-tcp-header-tlv">Extended TCP Header TLV</a>
          </h4>
<p id="section-6.2.6-1">The Extended TCP Header TLV (<a class="xref" href="#fig-tcpheader">Figure 20</a>) is used by the Transport Converter to return to
          the Client the TCP options that were returned by the Server in the
          SYN+ACK packet. A Transport Converter <span class="bcp14">MUST</span> return
          this TLV if the Client sent an Extended Connect TLV and the
          connection was accepted by the Server.<a class="pilcrow" href="#section-6.2.6-1">¶</a></p>
<span id="name-the-extended-tcp-header-tlv"></span><div id="fig-tcpheader">
<figure id="figure-20">
            <div class="artwork art-text alignLeft" id="section-6.2.6-2.1">
<pre>                      1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +---------------+---------------+-------------------------------+
 |     Type=0x14 |     Length    |           Unassigned          |
 +---------------+---------------+-------------------------------+
 /               Returned Extended TCP header                    /
 /                              ...                              /
 +---------------------------------------------------------------+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-20">Figure 20</a>:
<a class="selfRef" href="#name-the-extended-tcp-header-tlv">The Extended TCP Header TLV</a>
            </figcaption></figure>
</div>
<p id="section-6.2.6-3">The Returned Extended TCP header field is a copy of the TCP
          Options that were included in the SYN+ACK received by the Transport
          Converter.<a class="pilcrow" href="#section-6.2.6-3">¶</a></p>
<p id="section-6.2.6-4">The Unassigned field <span class="bcp14">MUST</span> be set to zero by the sender and
          ignored by the receiver.<a class="pilcrow" href="#section-6.2.6-4">¶</a></p>
</section>
</div>
<div id="sec-cookie-tlv">
<section id="section-6.2.7">
          <h4 id="name-the-cookie-tlv">
<a class="section-number selfRef" href="#section-6.2.7">6.2.7. </a><a class="section-name selfRef" href="#name-the-cookie-tlv">The Cookie TLV</a>
          </h4>
<p id="section-6.2.7-1">The Cookie TLV (<a class="xref" href="#fig-cookie">Figure 21</a>) is
          an optional TLV that is similar to the TCP Fast Open Cookie <span>[<a class="xref" href="#RFC7413">RFC7413</a>]</span>. A Transport Converter may want
          to verify that a Client can receive the packets that it sends to
          prevent attacks from spoofed addresses. This verification can be
          done by using a Cookie that is bound to, for example, the IP
          address(es) of the Client. This Cookie can be configured on the
          Client by means that are outside of this document or provided by the
          Transport Converter.<a class="pilcrow" href="#section-6.2.7-1">¶</a></p>
<p id="section-6.2.7-2">A Transport Converter that has been configured to use the
          optional Cookie TLV <span class="bcp14">MUST</span> verify the presence of this
          TLV in the payload of the received SYN. If this TLV is present, the
          Transport Converter <span class="bcp14">MUST</span> validate the Cookie by means
          similar to those in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc7413#section-4.1.2">Section 4.1.2</a> of [<a class="xref" href="#RFC7413">RFC7413</a>]</span> (i.e., IsCookieValid). If the Cookie is valid, the
          connection establishment procedure can continue. Otherwise, the
          Transport Converter <span class="bcp14">MUST</span> return an Error TLV set to
          "Not Authorized" and close the connection.<a class="pilcrow" href="#section-6.2.7-2">¶</a></p>
<p id="section-6.2.7-3">If the received SYN did not contain a Cookie TLV, and cookie
          validation is required, the Transport Converter <span class="bcp14">MAY</span> compute a Cookie
          bound to this Client address. In such case, the Transport Converter
          <span class="bcp14">MUST</span> return an Error TLV set to "Missing Cookie" and the computed
          Cookie and close the connection. The Client will react to this error
          by first issuing a reset to terminate the connection. It also stores
          the received Cookie in its cache and attempts to reestablish a new
          connection to the Transport Converter that includes the Cookie
          TLV.<a class="pilcrow" href="#section-6.2.7-3">¶</a></p>
<p id="section-6.2.7-4">The format of the Cookie TLV is shown in <a class="xref" href="#fig-cookie">Figure 21</a>.<a class="pilcrow" href="#section-6.2.7-4">¶</a></p>
<span id="name-the-cookie-tlv-2"></span><div id="fig-cookie">
<figure id="figure-21">
            <div class="artwork art-text alignLeft" id="section-6.2.7-5.1">
<pre>                      1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +---------------+---------------+-------------------------------+
 |     Type=0x16 |     Length    |             Zero              |
 +---------------+---------------+-------------------------------+
 /                        Opaque  Cookie                         /
 /                              ...                              /
 +---------------------------------------------------------------+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-21">Figure 21</a>:
<a class="selfRef" href="#name-the-cookie-tlv-2">The Cookie TLV</a>
            </figcaption></figure>
</div>
</section>
</div>
<div id="sec-error">
<section id="section-6.2.8">
          <h4 id="name-error-tlv">
<a class="section-number selfRef" href="#section-6.2.8">6.2.8. </a><a class="section-name selfRef" href="#name-error-tlv">Error TLV</a>
          </h4>
<p id="section-6.2.8-1">The Error TLV (<a class="xref" href="#fig-error">Figure 22</a>) is meant to
          provide information about some errors that occurred during the
          processing of a Convert message. This TLV has a variable length.
          Upon reception of an Error TLV, a Client <span class="bcp14">MUST</span> reset the associated
          connection.<a class="pilcrow" href="#section-6.2.8-1">¶</a></p>
<p id="section-6.2.8-2">An Error TLV can be included in the SYN+ACK or an ACK.<a class="pilcrow" href="#section-6.2.8-2">¶</a></p>
<span id="name-the-error-tlv"></span><div id="fig-error">
<figure id="figure-22">
            <div class="artwork art-text alignLeft" id="section-6.2.8-3.1">
<pre>                      1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +---------------+---------------+----------------+--------------+
 |     Type=0x1E |     Length    |    Error Code  |  Value       |
 +---------------+---------------+----------------+--------------+
 //              ...   (optional) Value                         //
 +---------------------------------------------------------------+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-22">Figure 22</a>:
<a class="selfRef" href="#name-the-error-tlv">The Error TLV</a>
            </figcaption></figure>
</div>
<p id="section-6.2.8-4">Different types of errors can occur while processing Convert
          messages. Each error is identified by an Error Code represented as
          an unsigned integer. Four classes of error codes are defined:<a class="pilcrow" href="#section-6.2.8-4">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-6.2.8-5">
            <dt id="section-6.2.8-5.1">Message validation and processing errors (0-31 range):</dt>
            <dd id="section-6.2.8-5.2">Returned upon reception of an invalid message (including valid
              messages but with invalid or unknown TLVs).<a class="pilcrow" href="#section-6.2.8-5.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-6.2.8-5.3">Client-side errors (32-63 range):</dt>
            <dd id="section-6.2.8-5.4">The Client sent a request
              that could not be accepted by the Transport Converter (e.g.,
              unsupported operation).<a class="pilcrow" href="#section-6.2.8-5.4">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-6.2.8-5.5">Converter-side errors (64-95 range):</dt>
            <dd id="section-6.2.8-5.6"> Problems encountered on
              the Transport Converter (e.g., lack of resources) that prevent
              it from fulfilling the Client's request.<a class="pilcrow" href="#section-6.2.8-5.6">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-6.2.8-5.7">Errors caused by the destination Server (96-127 range):</dt>
            <dd id="section-6.2.8-5.8">The
              final destination could not be reached or it replied with a
              reset.<a class="pilcrow" href="#section-6.2.8-5.8">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-6.2.8-6">The following error codes are defined in this document:<a class="pilcrow" href="#section-6.2.8-6">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-6.2.8-7">
            <dt id="section-6.2.8-7.1">Unsupported Version (0):</dt>
            <dd id="section-6.2.8-7.2">
              <p id="section-6.2.8-7.2.1">The version number indicated in the
              fixed header of a message received from a peer is not supported.<a class="pilcrow" href="#section-6.2.8-7.2.1">¶</a></p>
<p id="section-6.2.8-7.2.2"> This error code <span class="bcp14">MUST</span> be generated by a
              peer (e.g., Transport Converter) when it receives a request
              having a version number that it does not support.<a class="pilcrow" href="#section-6.2.8-7.2.2">¶</a></p>
<p id="section-6.2.8-7.2.3"> The Value field <span class="bcp14">MUST</span> be set to the version
              supported by the peer. When multiple versions are supported by
              the peer, it includes the list of supported versions in the Value
              field; each version is encoded in 8 bits. The list of supported
              versions <span class="bcp14">MUST</span> be padded with zeros to end on a 32-bit boundary.<a class="pilcrow" href="#section-6.2.8-7.2.3">¶</a></p>
<p id="section-6.2.8-7.2.4"> Upon receipt of this error code, the
              remote peer (e.g., Client) checks whether it supports one of the
              versions returned by the peer. 

The highest commonly supported version number <span class="bcp14">MUST</span> be used by the remote
peer in subsequent exchanges with the peer.<a class="pilcrow" href="#section-6.2.8-7.2.4">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-6.2.8-7.3">Malformed Message (1):</dt>
            <dd id="section-6.2.8-7.4">
              <p id="section-6.2.8-7.4.1">This error code is sent to
            indicate that a message received from a peer cannot be
            successfully parsed and validated.<a class="pilcrow" href="#section-6.2.8-7.4.1">¶</a></p>
<p id="section-6.2.8-7.4.2"> Typically, this error code is sent by the Transport
              Converter if it receives a Connect TLV enclosing a multicast,
              broadcast, or loopback IP address.<a class="pilcrow" href="#section-6.2.8-7.4.2">¶</a></p>
<p id="section-6.2.8-7.4.3"> To ease troubleshooting, the Value field <span class="bcp14">MUST</span>
              echo the received message using the format depicted in <a class="xref" href="#shift">Figure 23</a>. This format allows keeping
              the original alignment of the message that triggered the
              error.<a class="pilcrow" href="#section-6.2.8-7.4.3">¶</a></p>
<span id="name-error-tlv-to-ease-message-c"></span><div id="shift">
<figure id="figure-23">
                <div class="artwork art-text alignLeft" id="section-6.2.8-7.4.4.1">
<pre>                      1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +---------------+---------------+----------------+--------------+
 |     Type=0x1E |     Length    |    Error Code  |  Zeros       |
 +---------------+---------------+----------------+--------------+
 //        Echo the message that triggered the error            //
 +---------------------------------------------------------------+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-23">Figure 23</a>:
<a class="selfRef" href="#name-error-tlv-to-ease-message-c">Error TLV to Ease Message Correlation</a>
                </figcaption></figure>
</div>
</dd>
            <dd class="break"></dd>
<dt id="section-6.2.8-7.5">Unsupported Message (2):</dt>
            <dd id="section-6.2.8-7.6">
              <p id="section-6.2.8-7.6.1">This error code is sent to indicate
              that a message type received from a Client is not supported.<a class="pilcrow" href="#section-6.2.8-7.6.1">¶</a></p>
<p id="section-6.2.8-7.6.2"> To ease troubleshooting, the Value field <span class="bcp14">MUST</span>
              echo the received message using the format shown in <a class="xref" href="#shift">Figure 23</a>.<a class="pilcrow" href="#section-6.2.8-7.6.2">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-6.2.8-7.7">Missing Cookie (3):</dt>
            <dd id="section-6.2.8-7.8">
              <p id="section-6.2.8-7.8.1">If a Transport Converter requires the
              utilization of Cookies to prevent spoofing attacks and a Cookie
              TLV was not included in the Convert message, the Transport
              Converter <span class="bcp14">MUST</span> return this error to the requesting Client only
              if it computes a cookie for this Client. The first byte of the
              Value field <span class="bcp14">MUST</span> be set to zero and the remaining bytes of the
              Error TLV contain the Cookie computed by the Transport Converter
              for this Client.<a class="pilcrow" href="#section-6.2.8-7.8.1">¶</a></p>
<p id="section-6.2.8-7.8.2"> A Client that receives this error code
              <span class="bcp14">SHOULD</span> cache the received Cookie and include it
              in subsequent Convert messages sent to that Transport
              Converter.<a class="pilcrow" href="#section-6.2.8-7.8.2">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-6.2.8-7.9">Not Authorized (32):</dt>
            <dd id="section-6.2.8-7.10">
              <p id="section-6.2.8-7.10.1">This error code indicates that the
              Transport Converter refused to create a connection because of a
              lack of authorization (e.g., administratively prohibited,
              authorization failure, or invalid Cookie TLV). The Value field <span class="bcp14">MUST</span>
              be set to zero.<a class="pilcrow" href="#section-6.2.8-7.10.1">¶</a></p>
<p id="section-6.2.8-7.10.2"> This error code <span class="bcp14">MUST</span>
              be sent by the Transport Converter when a request cannot be
              successfully processed because the authorization failed.<a class="pilcrow" href="#section-6.2.8-7.10.2">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-6.2.8-7.11">Unsupported TCP Option (33):</dt>
            <dd id="section-6.2.8-7.12">
              <p id="section-6.2.8-7.12.1">A TCP option that the Client
              requested to advertise to the final Server cannot be safely
              used.<a class="pilcrow" href="#section-6.2.8-7.12.1">¶</a></p>
<p id="section-6.2.8-7.12.2"> The Value field is set to the
              type of the unsupported TCP option. If several unsupported TCP
              options were specified in the Connect TLV, then the list of
              unsupported TCP options is returned. The list of unsupported TCP
              options <span class="bcp14">MUST</span> be padded with zeros to end on a 32-bit
              boundary.<a class="pilcrow" href="#section-6.2.8-7.12.2">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-6.2.8-7.13">Resource Exceeded (64):</dt>
            <dd id="section-6.2.8-7.14">
              <p id="section-6.2.8-7.14.1">This error indicates that the
              Transport Converter does not have enough resources to perform
              the request.<a class="pilcrow" href="#section-6.2.8-7.14.1">¶</a></p>
<p id="section-6.2.8-7.14.2"> This error <span class="bcp14">MUST</span> be sent
              by the Transport Converter when it does not have sufficient
              resources to handle a new connection. The Transport Converter
              may indicate in the Value field the suggested delay (in seconds)
              that the Client <span class="bcp14">SHOULD</span> wait before soliciting the Transport
              Converter for a new proxied connection. A Value of zero
              corresponds to a default delay of at least 30 seconds.<a class="pilcrow" href="#section-6.2.8-7.14.2">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-6.2.8-7.15">Network Failure (65):</dt>
            <dd id="section-6.2.8-7.16">
              <p id="section-6.2.8-7.16.1">This error indicates that the Transport
              Converter is experiencing a network failure to proxy the
              request.<a class="pilcrow" href="#section-6.2.8-7.16.1">¶</a></p>
<p id="section-6.2.8-7.16.2"> The Transport Converter <span class="bcp14">MUST</span>
              send this error code when it experiences forwarding issues to
              proxy a connection. The Transport Converter may indicate in the
              Value field the suggested delay (in seconds) that the Client
              <span class="bcp14">SHOULD</span> wait before soliciting the Transport Converter for a new
              proxied connection. A Value of zero corresponds to a default
              delay of at least 30 seconds.<a class="pilcrow" href="#section-6.2.8-7.16.2">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-6.2.8-7.17">Connection Reset (96):</dt>
            <dd id="section-6.2.8-7.18">This error indicates that the final
              destination responded with an RST segment. The Value field <span class="bcp14">MUST</span>
              be set to zero.<a class="pilcrow" href="#section-6.2.8-7.18">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-6.2.8-7.19">Destination Unreachable (97):</dt>
            <dd id="section-6.2.8-7.20">
              <p id="section-6.2.8-7.20.1">This error indicates that an
              ICMP message indicating a hard error (e.g., destination
              unreachable, port unreachable, or network unreachable) was
              received by the Transport Converter. The Value field <span class="bcp14">MUST</span> echo
              the Code field of the received ICMP message.<a class="pilcrow" href="#section-6.2.8-7.20.1">¶</a></p>
<p id="section-6.2.8-7.20.2">As a reminder, TCP implementations are supposed
              to act on an ICMP error message passed up from the IP layer,
              directing it to the connection that triggered the error using
              the demultiplexing information included in the payload of that
              ICMP message. Such a demultiplexing issue does not apply for
              handling the "Destination Unreachable" Error TLV because the
              error is sent in-band. For this reason, the payload of the ICMP
              message is not echoed in the Destination Unreachable Error
              TLV.<a class="pilcrow" href="#section-6.2.8-7.20.2">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-6.2.8-8"><a class="xref" href="#tab-error-types">Table 2</a> summarizes the different
          error codes.<a class="pilcrow" href="#section-6.2.8-8">¶</a></p>
<span id="name-convert-error-values"></span><div id="tab-error-types">
<table class="center" id="table-2">
            <caption>
<a class="selfRef" href="#table-2">Table 2</a>:
<a class="selfRef" href="#name-convert-error-values">Convert Error Values</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" colspan="1" rowspan="1">Error</th>
                <th class="text-left" colspan="1" rowspan="1">Hex</th>
                <th class="text-left" colspan="1" rowspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">0</td>
                <td class="text-left" colspan="1" rowspan="1">0x00</td>
                <td class="text-left" colspan="1" rowspan="1">Unsupported Version</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">1</td>
                <td class="text-left" colspan="1" rowspan="1">0x01</td>
                <td class="text-left" colspan="1" rowspan="1">Malformed Message</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">2</td>
                <td class="text-left" colspan="1" rowspan="1">0x02</td>
                <td class="text-left" colspan="1" rowspan="1">Unsupported Message</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">3</td>
                <td class="text-left" colspan="1" rowspan="1">0x03</td>
                <td class="text-left" colspan="1" rowspan="1">Missing Cookie</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">32</td>
                <td class="text-left" colspan="1" rowspan="1">0x20</td>
                <td class="text-left" colspan="1" rowspan="1">Not Authorized</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">33</td>
                <td class="text-left" colspan="1" rowspan="1">0x21</td>
                <td class="text-left" colspan="1" rowspan="1">Unsupported TCP Option</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">64</td>
                <td class="text-left" colspan="1" rowspan="1">0x40</td>
                <td class="text-left" colspan="1" rowspan="1">Resource Exceeded</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">65</td>
                <td class="text-left" colspan="1" rowspan="1">0x41</td>
                <td class="text-left" colspan="1" rowspan="1">Network Failure</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">96</td>
                <td class="text-left" colspan="1" rowspan="1">0x60</td>
                <td class="text-left" colspan="1" rowspan="1">Connection Reset</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">97</td>
                <td class="text-left" colspan="1" rowspan="1">0x61</td>
                <td class="text-left" colspan="1" rowspan="1">Destination Unreachable</td>
              </tr>
            </tbody>
          </table>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="sec-tcpoptions">
<section id="section-7">
      <h2 id="name-compatibility-of-specific-t">
<a class="section-number selfRef" href="#section-7">7. </a><a class="section-name selfRef" href="#name-compatibility-of-specific-t">Compatibility of Specific TCP Options with the Conversion Service</a>
      </h2>
<p id="section-7-1">In this section, we discuss how several deployed Standards Track TCP
      options can be supported through the Convert Protocol. The other TCP
      options will be discussed in other documents.<a class="pilcrow" href="#section-7-1">¶</a></p>
<div id="base-tcp-options">
<section id="section-7.1">
        <h3 id="name-base-tcp-options">
<a class="section-number selfRef" href="#section-7.1">7.1. </a><a class="section-name selfRef" href="#name-base-tcp-options">Base TCP Options</a>
        </h3>
<p id="section-7.1-1">Three TCP options were initially defined in <span>[<a class="xref" href="#RFC0793">RFC0793</a>]</span>: End-of-Option List (Kind=0), No-Operation (Kind=1),
        and Maximum Segment Size (Kind=2). The first two options are mainly
        used to pad the TCP header. There is no reason for a Client to request
        a Transport Converter to specifically send these options towards the
        final destination.<a class="pilcrow" href="#section-7.1-1">¶</a></p>
<p id="section-7.1-2">The Maximum Segment Size option (Kind=2) is used by a host to
        indicate the largest segment that it can receive over each connection.
        This value is a function of the stack that terminates the TCP
        connection. There is no reason for a Client to request a Transport
        Converter to advertise a specific Maximum Segment Size (MSS) value to a remote Server.<a class="pilcrow" href="#section-7.1-2">¶</a></p>
<p id="section-7.1-3">A Transport Converter <span class="bcp14">MUST</span> ignore options with Kind=0, 1, or 2 if
        they appear in a Connect TLV. It <span class="bcp14">MUST NOT</span> announce them in a Supported
        TCP Extensions TLV.<a class="pilcrow" href="#section-7.1-3">¶</a></p>
</section>
</div>
<div id="window-scale-ws">
<section id="section-7.2">
        <h3 id="name-window-scale-ws">
<a class="section-number selfRef" href="#section-7.2">7.2. </a><a class="section-name selfRef" href="#name-window-scale-ws">Window Scale (WS)</a>
        </h3>
<p id="section-7.2-1">The Window Scale (WS) option (Kind=3) is defined in <span>[<a class="xref" href="#RFC7323">RFC7323</a>]</span>. As for the MSS option, the window
        scale factor that is used for a connection strongly depends on the TCP
        stack that handles the connection. When a Transport Converter opens a
        TCP connection towards a remote Server on behalf of a Client, it
        <span class="bcp14">SHOULD</span> use a WS option with a scaling factor that
        corresponds to the configuration of its stack. A local configuration
        <span class="bcp14">MAY</span> allow for a WS option in the proxied message to be
        a function of the scaling factor of the incoming connection.<a class="pilcrow" href="#section-7.2-1">¶</a></p>
<p id="section-7.2-2">From a deployment viewpoint, there is no benefit in enabling a
        Client of a Transport Converter to specifically request the
        utilization of the WS option (Kind=3) with a specific scaling factor
        towards a remote Server. For this reason, a Transport Converter <span class="bcp14">MUST</span>
        ignore option Kind=3 if it appears in a Connect TLV. 

The Transport Converter <span class="bcp14">MUST NOT</span> announce a WS option (Kind=3)
in a Supported TCP Extensions TLV.<a class="pilcrow" href="#section-7.2-2">¶</a></p>
</section>
</div>
<div id="selective-acknowledgments">
<section id="section-7.3">
        <h3 id="name-selective-acknowledgments">
<a class="section-number selfRef" href="#section-7.3">7.3. </a><a class="section-name selfRef" href="#name-selective-acknowledgments">Selective Acknowledgments</a>
        </h3>
<p id="section-7.3-1">Two distinct TCP options were defined to support Selective
        Acknowledgment (SACK) in <span>[<a class="xref" href="#RFC2018">RFC2018</a>]</span>. This first one,
        SACK-Permitted (Kind=4), is used to negotiate the utilization of
        Selective Acknowledgments during the three-way handshake. The second
        one, SACK (Kind=5), carries the Selective Acknowledgments inside
        regular segments.<a class="pilcrow" href="#section-7.3-1">¶</a></p>
<p id="section-7.3-2">The SACK-Permitted option (Kind=4) <span class="bcp14">MAY</span> be advertised by a Transport
        Converter in the Supported TCP Extensions TLV. Clients connected to
        this Transport Converter <span class="bcp14">MAY</span> include the SACK-Permitted option in the
        Connect TLV.<a class="pilcrow" href="#section-7.3-2">¶</a></p>
<p id="section-7.3-3">The SACK option (Kind=5) cannot be used during the three-way
        handshake. For this reason, a Transport Converter <span class="bcp14">MUST</span> ignore option
        Kind=5 if it appears in a Connect TLV. It <span class="bcp14">MUST NOT</span> announce it in a
        TCP Supported Extensions TLV.<a class="pilcrow" href="#section-7.3-3">¶</a></p>
</section>
</div>
<div id="timestamp">
<section id="section-7.4">
        <h3 id="name-timestamp">
<a class="section-number selfRef" href="#section-7.4">7.4. </a><a class="section-name selfRef" href="#name-timestamp">Timestamp</a>
        </h3>
<p id="section-7.4-1">The Timestamp option <span>[<a class="xref" href="#RFC7323">RFC7323</a>]</span> can be used
        during the three-way handshake to negotiate the utilization of
        timestamps during the TCP connection. It is notably used to improve
        round-trip-time estimations and to provide Protection Against Wrapped
        Sequences (PAWS). As for the WS option, the timestamps are a
        property of a connection and there is limited benefit in enabling a
        Client to request a Transport Converter to use the timestamp option
        when establishing a connection to a remote Server. Furthermore, the
        timestamps that are used by TCP stacks are specific to each stack and
        there is no benefit in enabling a Client to specify the timestamp
        value that a Transport Converter could use to establish a connection
        to a remote Server.<a class="pilcrow" href="#section-7.4-1">¶</a></p>
<p id="section-7.4-2">A Transport Converter <span class="bcp14">MAY</span> advertise the Timestamp option (Kind=8)
        in the TCP Supported Extensions TLV. The Clients connected to this
        Transport Converter <span class="bcp14">MAY</span> include the Timestamp option in the Connect
        TLV but without any timestamp.<a class="pilcrow" href="#section-7.4-2">¶</a></p>
</section>
</div>
<div id="multipath-tcp">
<section id="section-7.5">
        <h3 id="name-multipath-tcp">
<a class="section-number selfRef" href="#section-7.5">7.5. </a><a class="section-name selfRef" href="#name-multipath-tcp">Multipath TCP</a>
        </h3>
<p id="section-7.5-1">The Multipath TCP options are defined in <span>[<a class="xref" href="#RFC8684">RFC8684</a>]</span>, which defines one
        variable length TCP option (Kind=30) that includes a sub-type field to
        support several Multipath TCP options. There are several operational
        use cases where Clients would like to use Multipath TCP through a
        Transport Converter <span>[<a class="xref" href="#IETFJ16">IETFJ16</a>]</span>. However, none of
        these use cases require the Client to specify the content of the
        Multipath TCP option that the Transport Converter should send to a
        remote Server.<a class="pilcrow" href="#section-7.5-1">¶</a></p>
<p id="section-7.5-2">A Transport Converter that supports Multipath TCP conversion
        service <span class="bcp14">MUST</span> advertise the Multipath TCP option (Kind=30) in the
        Supported TCP Extensions TLV. Clients serviced by this Transport
        Converter may include the Multipath TCP option in the Connect TLV but
        without any content.<a class="pilcrow" href="#section-7.5-2">¶</a></p>
</section>
</div>
<div id="tcp-fast-open">
<section id="section-7.6">
        <h3 id="name-tcp-fast-open">
<a class="section-number selfRef" href="#section-7.6">7.6. </a><a class="section-name selfRef" href="#name-tcp-fast-open">TCP Fast Open</a>
        </h3>
<p id="section-7.6-1">The TCP Fast Open Cookie option (Kind=34) is defined in <span>[<a class="xref" href="#RFC7413">RFC7413</a>]</span>. There are two different usages of this
        option that need to be supported by Transport Converters. The first
        utilization of the TCP Fast Open Cookie option is to request a cookie
        from the Server. In this case, the option is sent with an empty cookie
        by the Client, and the Server returns the cookie. The second
        utilization of the TCP Fast Open Cookie option is to send a cookie to
        the Server. In this case, the option contains a cookie.<a class="pilcrow" href="#section-7.6-1">¶</a></p>
<p id="section-7.6-2">A Transport Converter <span class="bcp14">MAY</span> advertise the TCP Fast Open Cookie option
        (Kind=34) in the Supported TCP Extensions TLV. If a Transport
        Converter has advertised the support for TCP Fast Open in its
        Supported TCP Extensions TLV, it needs to be able to process two types
        of Connect TLV.<a class="pilcrow" href="#section-7.6-2">¶</a></p>
<p id="section-7.6-3">If such a Transport Converter receives a Connect TLV with the TCP
        Fast Open Cookie option that does not contain a cookie, it
        <span class="bcp14">MUST</span> add an empty TCP Fast Open Cookie option in the
        SYN sent to the remote Server. If the remote Server supports TFO, it
        responds with a SYN-ACK according to the procedure in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc7413#section-4.1.2">Section 4.1.2</a> of [<a class="xref" href="#RFC7413">RFC7413</a>]</span>. This SYN-ACK
        may contain a Fast Open option with a cookie. Upon receipt of the
        SYN-ACK by the Converter, it relays the Fast Open option with the cookie
        to the Client.<a class="pilcrow" href="#section-7.6-3">¶</a></p>
<p id="section-7.6-4">If such a Transport Converter receives a Connect TLV with the TCP
        Fast Open Cookie option that contains a cookie, it <span class="bcp14">MUST</span> copy the TCP
        Fast Open Cookie option in the SYN sent to the remote Server.<a class="pilcrow" href="#section-7.6-4">¶</a></p>
</section>
</div>
<div id="tcp-ao">
<section id="section-7.7">
        <h3 id="name-tcp-ao">
<a class="section-number selfRef" href="#section-7.7">7.7. </a><a class="section-name selfRef" href="#name-tcp-ao">TCP-AO</a>
        </h3>
<p id="section-7.7-1">The TCP Authentication Option (TCP-AO) <span>[<a class="xref" href="#RFC5925">RFC5925</a>]</span> provides a technique to authenticate all the
        packets exchanged over a TCP connection. Given the nature of this
        extension, it is unlikely that the applications that require their
        packets to be authenticated end to end would want their connections to
        pass through a converter. For this reason, we do not recommend the
        support of the TCP-AO by Transport Converters. The only use
        cases where it could make sense to combine TCP-AO and the solution in
        this document are those where the TCP-AO-NAT extension <span>[<a class="xref" href="#RFC6978">RFC6978</a>]</span> is in use.<a class="pilcrow" href="#section-7.7-1">¶</a></p>
<p id="section-7.7-2">A Transport Converter <span class="bcp14">MUST NOT</span> advertise the TCP-AO
        (Kind=29) in the Supported TCP Extensions TLV. If a Transport
        Converter receives a Connect TLV that contains the TCP-AO, it
        <span class="bcp14">MUST</span> reject the establishment of the connection with
        error code set to "Unsupported TCP Option", except if the TCP-AO-NAT
        option is used.  Nevertheless, given that TCP-AO-NAT is Experimental,
        its usage is not currently defined and must be specified by some other
        document before it can be used.<a class="pilcrow" href="#section-7.7-2">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-middleboxes">
<section id="section-8">
      <h2 id="name-interactions-with-middlebox">
<a class="section-number selfRef" href="#section-8">8. </a><a class="section-name selfRef" href="#name-interactions-with-middlebox">Interactions with Middleboxes</a>
      </h2>
<p id="section-8-1">The Convert Protocol is designed to be used in networks that do not
      contain middleboxes that interfere with TCP. Under such conditions, it
      is assumed that the network provider ensures that all involved on-path
      nodes are not breaking TCP signals (e.g., strip TCP options, discard
      some SYNs, etc.).<a class="pilcrow" href="#section-8-1">¶</a></p>
<p id="section-8-2">Nevertheless, and in order to allow for a robust service, this
      section describes how a Client can detect middlebox interference and
      stop using the Transport Converter affected by this interference.<a class="pilcrow" href="#section-8-2">¶</a></p>
<p id="section-8-3">Internet measurements <span>[<a class="xref" href="#IMC11">IMC11</a>]</span> have shown that
      middleboxes can affect the deployment of TCP extensions. In this
      section, we focus the middleboxes that modify the payload since the
      Convert Protocol places its messages at the beginning of the
      bytestream.<a class="pilcrow" href="#section-8-3">¶</a></p>
<p id="section-8-4">Consider a middlebox that removes the SYN payload. The Client can
      detect this problem by looking at the acknowledgment number field of the
      SYN+ACK if returned by the Transport Converter. The Client <span class="bcp14">MUST</span> stop to
      use this Transport Converter given the middlebox interference.<a class="pilcrow" href="#section-8-4">¶</a></p>
<p id="section-8-5">Consider now a middlebox that drops SYN/ACKs with a payload. The
      Client won't be able to establish a connection via the Transport
      Converter. The case of a middlebox that removes the payload of SYN+ACKs
      or from the packet that follows the SYN+ACK (but not the payload of SYN)
      can be detected by a Client. This is hinted by the absence of a valid
      Convert message in the response.<a class="pilcrow" href="#section-8-5">¶</a></p>
<p id="section-8-6">As explained in <span>[<a class="xref" href="#RFC7413">RFC7413</a>]</span>, some
      Carrier Grade NATs (CGNs) can affect the operation of TFO if they assign
      different IP addresses to the same end host. Such CGNs could affect the
      operation of the cookie validation used by the Convert Protocol. As a
      reminder, CGNs that are enabled on the path between a Client and a Transport
      Converter must adhere to the address preservation defined in <span>[<a class="xref" href="#RFC6888">RFC6888</a>]</span>. See also the discussion in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc7413#section-7.1">Section 7.1</a> of [<a class="xref" href="#RFC7413">RFC7413</a>]</span>.<a class="pilcrow" href="#section-8-6">¶</a></p>
</section>
</div>
<div id="sec-security">
<section id="section-9">
      <h2 id="name-security-considerations">
<a class="section-number selfRef" href="#section-9">9. </a><a class="section-name selfRef" href="#name-security-considerations">Security Considerations</a>
      </h2>
<p id="section-9-1">An implementation <span class="bcp14">MUST</span> check that the Convert TLVs are properly
      framed within the boundary indicated by the Total Length in the fixed
      header (<a class="xref" href="#sec-header">Section 6.1</a>).<a class="pilcrow" href="#section-9-1">¶</a></p>
<p id="section-9-2">Additional security considerations are discussed in the following
      subsections.<a class="pilcrow" href="#section-9-2">¶</a></p>
<div id="privacy-ingress-filtering">
<section id="section-9.1">
        <h3 id="name-privacy-ingress-filtering">
<a class="section-number selfRef" href="#section-9.1">9.1. </a><a class="section-name selfRef" href="#name-privacy-ingress-filtering">Privacy &amp; Ingress Filtering</a>
        </h3>
<p id="section-9.1-1">The Transport Converter may have access to privacy-related
        information (e.g., subscriber credentials). The Transport Converter is
        designed to not leak such sensitive information outside a local
        domain.<a class="pilcrow" href="#section-9.1-1">¶</a></p>
<p id="section-9.1-2">Given its function and location in the network, a Transport
        Converter is in a position to observe all packets that it processes,
        to include payloads and metadata, and has the ability to profile and
        conduct some traffic analysis of user behavior. The Transport
        Converter <span class="bcp14">MUST</span> be as protected as a core IP router
        (e.g., <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc1812#section-10">Section 10</a> of [<a class="xref" href="#RFC1812">RFC1812</a>]</span>).<a class="pilcrow" href="#section-9.1-2">¶</a></p>
<p id="section-9.1-3">Furthermore, ingress filtering policies <span class="bcp14">MUST</span> be enforced at the
        network boundaries <span>[<a class="xref" href="#RFC2827">RFC2827</a>]</span>.<a class="pilcrow" href="#section-9.1-3">¶</a></p>
<p id="section-9.1-4">This document assumes that all network attachments are managed by
        the same administrative entity. Therefore, enforcing anti-spoofing
        filters at these networks is a guard that hosts are not sending traffic
        with spoofed source IP addresses.<a class="pilcrow" href="#section-9.1-4">¶</a></p>
</section>
</div>
<div id="authorization">
<section id="section-9.2">
        <h3 id="name-authentication-and-authoriz">
<a class="section-number selfRef" href="#section-9.2">9.2. </a><a class="section-name selfRef" href="#name-authentication-and-authoriz">Authentication and Authorization Considerations</a>
        </h3>
<p id="section-9.2-1">The Convert Protocol is <span class="bcp14">RECOMMENDED</span> for use in a managed network
        where end hosts can be securely identified by their IP address. If
        such control is not exerted and there is a more open network
        environment, a strong mutual authentication scheme <span class="bcp14">MUST</span> be defined to
        use the Convert Protocol.<a class="pilcrow" href="#section-9.2-1">¶</a></p>
<p id="section-9.2-2">One possibility for mutual authentication is to use TLS to perform
        mutual authentication between the Client and the Converter. That is,
        use TLS when a Client retrieves a Cookie from the Converter and rely
        on certificate-based, pre-shared key-based <span>[<a class="xref" href="#RFC4279">RFC4279</a>]</span>, or raw public key-based Client
        authentication <span>[<a class="xref" href="#RFC7250">RFC7250</a>]</span> to secure
        this connection. If the authentication succeeds, the Converter returns
        a cookie to the Client.  Subsequent Connect messages will be
        authorized as a function of the content of the Cookie TLV. An attacker
        from within the network between a Client and a Transport Converter may
        intercept the Cookie and use it to be granted access to the conversion
        service. Such an attack is only possible if the attacker spoofs the IP
        address of the Client and the network does not filter packets with
        source-spoofed IP addresses.<a class="pilcrow" href="#section-9.2-2">¶</a></p>
<p id="section-9.2-3">The operator that manages the various network attachments
        (including the Transport Converters) has various options for enforcing
        authentication and authorization policies. For example, a
        non-exhaustive list of methods to achieve authorization is provided
        hereafter:<a class="pilcrow" href="#section-9.2-3">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.2-4.1">The network provider may enforce a policy based on the
            International Mobile Subscriber Identity (IMSI) to verify that a
            user is allowed to benefit from the TCP converter service. If that
            authorization fails, the Packet Data Protocol (PDP) context/bearer
            will not be mounted. This method does not require any interaction
            with the Transport Converter for authorization matters.<a class="pilcrow" href="#section-9.2-4.1">¶</a>
</li>
          <li class="normal" id="section-9.2-4.2">The network provider may enforce a policy based upon Access
            Control Lists (ACLs), e.g., at a Broadband Network Gateway (BNG)
            to control the hosts that are authorized to communicate with a
            Transport Converter. These ACLs may be installed as a result of
            RADIUS exchanges, e.g., <span>[<a class="xref" href="#I-D.boucadair-opsawg-tcpm-converter">TCPM-CONVERTER</a>]</span>. This method
            does not require any interaction with the Transport Converter for
            authorization matters.<a class="pilcrow" href="#section-9.2-4.2">¶</a>
</li>
          <li class="normal" id="section-9.2-4.3">A device that embeds a Transport Converter may also host a
          RADIUS Client that will solicit a AAA Server to check whether or
          not connections received from a given source IP address are
          authorized <span>[<a class="xref" href="#I-D.boucadair-opsawg-tcpm-converter">TCPM-CONVERTER</a>]</span>.<a class="pilcrow" href="#section-9.2-4.3">¶</a>
</li>
        </ul>
<p id="section-9.2-5">A first safeguard against the misuse of Transport Converter
        resources by illegitimate users (e.g., users with access networks that
        are not managed by the same provider that operates the Transport
        Converter) is the Transport Converter to reject Convert connections
        received in the external realm. Only Convert connections received in
        the internal realm of a Transport Converter will be accepted.<a class="pilcrow" href="#section-9.2-5">¶</a></p>
<p id="section-9.2-6">In deployments where network-assisted connections are not allowed
        between hosts of a domain (i.e., hairpinning), the Converter may be
        instructed to discard such connections. Hairpinned connections are
        thus rejected by the Transport Converter by returning an Error TLV set
        to "Not Authorized". Otherwise, absent explicit configuration,
        hairpinning is enabled by the Converter (see <a class="xref" href="#fig-hairp">Figure 24</a>).<a class="pilcrow" href="#section-9.2-6">¶</a></p>
<span id="name-hairpinning-example"></span><div id="fig-hairp">
<figure id="figure-24">
          <div class="artwork art-text alignLeft" id="section-9.2-7.1">
<pre>          &lt;===Network Provider===&gt;

   +----+ from X1:x1 to X2':x2'   +-----+ X1':x1'
   | C1 |&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;--+---
   +----+                         |  v  |
                                  |  v  |
                                  |  v  |
                                  |  v  |
   +----+ from X1':x1' to X2:x2   |  v  | X2':x2'
   | C2 |&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;--+---
   +----+                         +-----+
                                 Converter

   Note: X2':x2' may be equal to
         X2:x2
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-24">Figure 24</a>:
<a class="selfRef" href="#name-hairpinning-example">Hairpinning Example</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="denial-of-service">
<section id="section-9.3">
        <h3 id="name-denial-of-service">
<a class="section-number selfRef" href="#section-9.3">9.3. </a><a class="section-name selfRef" href="#name-denial-of-service">Denial of Service</a>
        </h3>
<p id="section-9.3-1">Another possible risk is amplification attacks, since a Transport
        Converter sends a SYN towards a remote Server upon reception of a SYN
        from a Client. This could lead to amplification attacks if the SYN
        sent by the Transport Converter were larger than the SYN received from
        the Client, or if the Transport Converter retransmits the SYN. To
        mitigate such attacks, the Transport Converter <span class="bcp14">SHOULD</span>
        rate-limit the number of pending requests for a given Client. It
        <span class="bcp14">SHOULD</span> also avoid sending SYNs that are significantly
        longer than the SYN received from the Client, to remote
        Servers.  Finally, the Transport Converter <span class="bcp14">SHOULD</span> only
        retransmit a SYN to a Server after having received a retransmitted SYN
        from the corresponding Client. Means to protect against SYN flooding
        attacks should also be enabled (e.g., <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc4987#section-3">Section 3</a> of [<a class="xref" href="#RFC4987">RFC4987</a>]</span>).<a class="pilcrow" href="#section-9.3-1">¶</a></p>
<p id="section-9.3-2">Attacks from within the network between a Client and a Transport
        Converter (including attacks that change the protocol version) are yet
        another threat. Means to ensure that illegitimate nodes cannot connect
        to a network should be implemented.<a class="pilcrow" href="#section-9.3-2">¶</a></p>
</section>
</div>
<div id="traffic-theft">
<section id="section-9.4">
        <h3 id="name-traffic-theft">
<a class="section-number selfRef" href="#section-9.4">9.4. </a><a class="section-name selfRef" href="#name-traffic-theft">Traffic Theft</a>
        </h3>
<p id="section-9.4-1">Traffic theft is a risk if an illegitimate Converter is inserted in
        the path. Indeed, inserting an illegitimate Converter in the
        forwarding path allows traffic interception and can therefore provide
        access to sensitive data issued by or destined to a host. Converter
        discovery and configuration are out of scope of this document.<a class="pilcrow" href="#section-9.4-1">¶</a></p>
</section>
</div>
<section id="section-9.5">
        <h3 id="name-logging">
<a class="section-number selfRef" href="#section-9.5">9.5. </a><a class="section-name selfRef" href="#name-logging">Logging</a>
        </h3>
<p id="section-9.5-1">If the Converter is configured to behave in the address-sharing
        mode (<a class="xref" href="#sec-adds">Section 4.4.2</a>), the logging recommendations
        discussed in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc6888#section-4">Section 4</a> of [<a class="xref" href="#RFC6888">RFC6888</a>]</span> need to be
        considered. Security-related issues encountered in address-sharing
        environments are documented in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc6269#section-13">Section 13</a> of [<a class="xref" href="#RFC6269">RFC6269</a>]</span>.<a class="pilcrow" href="#section-9.5-1">¶</a></p>
</section>
</section>
</div>
<div id="sec-iana">
<section id="section-10">
      <h2 id="name-iana-considerations">
<a class="section-number selfRef" href="#section-10">10. </a><a class="section-name selfRef" href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<div id="sec-service">
<section id="section-10.1">
        <h3 id="name-convert-service-name">
<a class="section-number selfRef" href="#section-10.1">10.1. </a><a class="section-name selfRef" href="#name-convert-service-name">Convert Service Name</a>
        </h3>
<p id="section-10.1-1">IANA has assigned a
        service name for the Convert Protocol from the "Service Name and
        Transport Protocol Port Number Registry" available at
        &lt;<span><a href="https://www.iana.org/assignments/service-names-port-numbers">https://www.iana.org/assignments/service-names-port-numbers</a></span>&gt;.<a class="pilcrow" href="#section-10.1-1">¶</a></p>
<span class="break"></span><dl class="dlParallel dlCompact" id="section-10.1-2">
          <dt id="section-10.1-2.1">Service Name:</dt>
          <dd id="section-10.1-2.2" style="margin-left: 12.5em">convert<a class="pilcrow" href="#section-10.1-2.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-10.1-2.3">Port Number:</dt>
          <dd id="section-10.1-2.4" style="margin-left: 12.5em">N/A<a class="pilcrow" href="#section-10.1-2.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-10.1-2.5">Transport Protocol(s):</dt>
          <dd id="section-10.1-2.6" style="margin-left: 12.5em">TCP<a class="pilcrow" href="#section-10.1-2.6">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-10.1-2.7">Description:</dt>
          <dd id="section-10.1-2.8" style="margin-left: 12.5em">0-RTT TCP Convert Protocol<a class="pilcrow" href="#section-10.1-2.8">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-10.1-2.9">Assignee:</dt>
          <dd id="section-10.1-2.10" style="margin-left: 12.5em">IESG &lt;iesg@ietf.org&gt;<a class="pilcrow" href="#section-10.1-2.10">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-10.1-2.11">Contact:</dt>
          <dd id="section-10.1-2.12" style="margin-left: 12.5em">IETF Chair &lt;chair@ietf.org&gt;<a class="pilcrow" href="#section-10.1-2.12">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-10.1-2.13">Reference:</dt>
          <dd id="section-10.1-2.14" style="margin-left: 12.5em">RFC 8803<a class="pilcrow" href="#section-10.1-2.14">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-10.1-3">Clients may use this service name to feed the procedure defined in
        <span>[<a class="xref" href="#RFC2782">RFC2782</a>]</span> to discover the IP address(es) and the
        port number used by the Transport Converters of a domain.<a class="pilcrow" href="#section-10.1-3">¶</a></p>
</section>
</div>
<div id="the-convert-protocol-convert-parameters">
<section id="section-10.2">
        <h3 id="name-the-convert-protocol-convert">
<a class="section-number selfRef" href="#section-10.2">10.2. </a><a class="section-name selfRef" href="#name-the-convert-protocol-convert">The Convert Protocol (Convert) Parameters</a>
        </h3>
<p id="section-10.2-1">IANA has created a new "TCP Convert Protocol
        (Convert) Parameters" registry.<a class="pilcrow" href="#section-10.2-1">¶</a></p>
<p id="section-10.2-2">The following subsections detail new registries within the "Convert
        Protocol (Convert) Parameters" registry.<a class="pilcrow" href="#section-10.2-2">¶</a></p>
<p id="section-10.2-3">The designated expert is expected to ascertain the existence of
        suitable documentation as described in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8126#section-4.6">Section 4.6</a> of [<a class="xref" href="#RFC8126">RFC8126</a>]</span> and to verify that the document is
        permanently and publicly available. The designated expert is also
        expected to check the clarity of purpose and use of the requested code
        points.<a class="pilcrow" href="#section-10.2-3">¶</a></p>
<p id="section-10.2-4">Also, criteria that should be applied by the designated experts
        includes determining whether the proposed registration
        duplicates existing functionality, whether it is likely to be of
        general applicability or useful only for private use, and whether 
        the registration description is clear. 

All requests should be directed to the review mailing list.  For both the
"Convert TLVs" and "Convert Errors" subregistries, IANA must only accept
registry updates in the 128-191 range from the designated experts.  It is
suggested that multiple designated experts be appointed.

        In cases where a registration decision could be perceived as creating
        a conflict of interest for a particular expert, that expert should
        defer to the judgment of the other experts.<a class="pilcrow" href="#section-10.2-4">¶</a></p>
<div id="convert-versions">
<section id="section-10.2.1">
          <h4 id="name-convert-versions">
<a class="section-number selfRef" href="#section-10.2.1">10.2.1. </a><a class="section-name selfRef" href="#name-convert-versions">Convert Versions</a>
          </h4>
<p id="section-10.2.1-1">IANA has created the "Convert Versions" subregistry.
          New values are assigned via IETF Review (<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8126#section-4.8">Section 4.8</a> of [<a class="xref" href="#RFC8126">RFC8126</a>]</span>).<a class="pilcrow" href="#section-10.2.1-1">¶</a></p>
<p id="section-10.2.1-2">The initial values of the registry
          are as follows:<a class="pilcrow" href="#section-10.2.1-2">¶</a></p>
<span id="name-current-convert-versions"></span><div id="ver">
<table class="center" id="table-3">
            <caption>
<a class="selfRef" href="#table-3">Table 3</a>:
<a class="selfRef" href="#name-current-convert-versions">Current Convert Versions</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" colspan="1" rowspan="1">Version</th>
                <th class="text-left" colspan="1" rowspan="1">Description</th>
                <th class="text-left" colspan="1" rowspan="1">Reference</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">0</td>
                <td class="text-left" colspan="1" rowspan="1">Reserved</td>
                <td class="text-left" colspan="1" rowspan="1">RFC 8803</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">1</td>
                <td class="text-left" colspan="1" rowspan="1">Assigned</td>
                <td class="text-left" colspan="1" rowspan="1">RFC 8803</td>
              </tr>
            </tbody>
          </table>
</div>
</section>
</div>
<div id="convert-tlvs">
<section id="section-10.2.2">
          <h4 id="name-convert-tlvs-2">
<a class="section-number selfRef" href="#section-10.2.2">10.2.2. </a><a class="section-name selfRef" href="#name-convert-tlvs-2">Convert TLVs</a>
          </h4>
<p id="section-10.2.2-1">IANA has created the "Convert TLVs" subregistry. The
          procedures for assigning values from this registry are as follows:<a class="pilcrow" href="#section-10.2.2-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-10.2.2-2">
            <dt id="section-10.2.2-2.1">1-127:</dt>
            <dd id="section-10.2.2-2.2" style="margin-left: 5.0em">IETF Review<a class="pilcrow" href="#section-10.2.2-2.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.2.2-2.3">128-191:</dt>
            <dd id="section-10.2.2-2.4" style="margin-left: 5.0em">Specification Required<a class="pilcrow" href="#section-10.2.2-2.4">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.2.2-2.5">192-255:</dt>
            <dd id="section-10.2.2-2.6" style="margin-left: 5.0em">Private Use<a class="pilcrow" href="#section-10.2.2-2.6">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-10.2.2-3">The initial values of the registry
          are as follows:<a class="pilcrow" href="#section-10.2.2-3">¶</a></p>
<span id="name-initial-convert-tlvs"></span><div id="tlvs">
<table class="center" id="table-4">
            <caption>
<a class="selfRef" href="#table-4">Table 4</a>:
<a class="selfRef" href="#name-initial-convert-tlvs">Initial Convert TLVs</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" colspan="1" rowspan="1">Code</th>
                <th class="text-left" colspan="1" rowspan="1">Name</th>
                <th class="text-left" colspan="1" rowspan="1">Reference</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">0</td>
                <td class="text-left" colspan="1" rowspan="1">Reserved</td>
                <td class="text-left" colspan="1" rowspan="1">RFC 8803</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">1</td>
                <td class="text-left" colspan="1" rowspan="1">Info TLV</td>
                <td class="text-left" colspan="1" rowspan="1">RFC 8803</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">10</td>
                <td class="text-left" colspan="1" rowspan="1">Connect TLV</td>
                <td class="text-left" colspan="1" rowspan="1">RFC 8803</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">20</td>
                <td class="text-left" colspan="1" rowspan="1">Extended TCP Header TLV</td>
                <td class="text-left" colspan="1" rowspan="1">RFC 8803</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">21</td>
                <td class="text-left" colspan="1" rowspan="1">Supported TCP Extension TLV</td>
                <td class="text-left" colspan="1" rowspan="1">RFC 8803</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">22</td>
                <td class="text-left" colspan="1" rowspan="1">Cookie TLV</td>
                <td class="text-left" colspan="1" rowspan="1">RFC 8803</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">30</td>
                <td class="text-left" colspan="1" rowspan="1">Error TLV</td>
                <td class="text-left" colspan="1" rowspan="1">RFC 8803</td>
              </tr>
            </tbody>
          </table>
</div>
</section>
</div>
<div id="convert-error-messages">
<section id="section-10.2.3">
          <h4 id="name-convert-error-messages">
<a class="section-number selfRef" href="#section-10.2.3">10.2.3. </a><a class="section-name selfRef" href="#name-convert-error-messages">Convert Error Messages</a>
          </h4>
<p id="section-10.2.3-1">IANA has created the "Convert Errors" subregistry.
          Codes in this registry are assigned as a function of the error type.
          Four types are defined; the following ranges are reserved for each
          of these types:<a class="pilcrow" href="#section-10.2.3-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-10.2.3-2">
            <dt id="section-10.2.3-2.1">0-31:</dt>
            <dd id="section-10.2.3-2.2" style="margin-left: 5.0em">Message validation and processing errors<a class="pilcrow" href="#section-10.2.3-2.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.2.3-2.3">32-63:</dt>
            <dd id="section-10.2.3-2.4" style="margin-left: 5.0em">Client-side errors<a class="pilcrow" href="#section-10.2.3-2.4">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.2.3-2.5">64-95:</dt>
            <dd id="section-10.2.3-2.6" style="margin-left: 5.0em">Transport Converter-side errors<a class="pilcrow" href="#section-10.2.3-2.6">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.2.3-2.7">96-127:</dt>
            <dd id="section-10.2.3-2.8" style="margin-left: 5.0em">Errors caused by destination Server<a class="pilcrow" href="#section-10.2.3-2.8">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-10.2.3-3">The procedures for assigning values from this subregistry are as
          follows:<a class="pilcrow" href="#section-10.2.3-3">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-10.2.3-4">
            <dt id="section-10.2.3-4.1">0-127:</dt>
            <dd id="section-10.2.3-4.2" style="margin-left: 5.0em">IETF Review<a class="pilcrow" href="#section-10.2.3-4.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.2.3-4.3">128-191:</dt>
            <dd id="section-10.2.3-4.4" style="margin-left: 5.0em">Specification Required<a class="pilcrow" href="#section-10.2.3-4.4">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.2.3-4.5">192-255:</dt>
            <dd id="section-10.2.3-4.6" style="margin-left: 5.0em">Private Use<a class="pilcrow" href="#section-10.2.3-4.6">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-10.2.3-5">The initial values of the registry
          are as follows:<a class="pilcrow" href="#section-10.2.3-5">¶</a></p>
<span id="name-initial-convert-error-codes"></span><div id="tab-error-summary">
<table class="center" id="table-5">
            <caption>
<a class="selfRef" href="#table-5">Table 5</a>:
<a class="selfRef" href="#name-initial-convert-error-codes">Initial Convert Error Codes</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" colspan="1" rowspan="1">Error</th>
                <th class="text-left" colspan="1" rowspan="1">Description</th>
                <th class="text-left" colspan="1" rowspan="1">Reference</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">0</td>
                <td class="text-left" colspan="1" rowspan="1">Unsupported Version</td>
                <td class="text-left" colspan="1" rowspan="1">RFC 8803</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">1</td>
                <td class="text-left" colspan="1" rowspan="1">Malformed Message</td>
                <td class="text-left" colspan="1" rowspan="1">RFC 8803</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">2</td>
                <td class="text-left" colspan="1" rowspan="1">Unsupported Message</td>
                <td class="text-left" colspan="1" rowspan="1">RFC 8803</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">3</td>
                <td class="text-left" colspan="1" rowspan="1">Missing Cookie</td>
                <td class="text-left" colspan="1" rowspan="1">RFC 8803</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">32</td>
                <td class="text-left" colspan="1" rowspan="1">Not Authorized</td>
                <td class="text-left" colspan="1" rowspan="1">RFC 8803</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">33</td>
                <td class="text-left" colspan="1" rowspan="1">Unsupported TCP Option</td>
                <td class="text-left" colspan="1" rowspan="1">RFC 8803</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">64</td>
                <td class="text-left" colspan="1" rowspan="1">Resource Exceeded</td>
                <td class="text-left" colspan="1" rowspan="1">RFC 8803</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">65</td>
                <td class="text-left" colspan="1" rowspan="1">Network Failure</td>
                <td class="text-left" colspan="1" rowspan="1">RFC 8803</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">96</td>
                <td class="text-left" colspan="1" rowspan="1">Connection Reset</td>
                <td class="text-left" colspan="1" rowspan="1">RFC 8803</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">97</td>
                <td class="text-left" colspan="1" rowspan="1">Destination Unreachable</td>
                <td class="text-left" colspan="1" rowspan="1">RFC 8803</td>
              </tr>
            </tbody>
          </table>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<section id="section-11">
      <h2 id="name-references">
<a class="section-number selfRef" href="#section-11">11. </a><a class="section-name selfRef" href="#name-references">References</a>
      </h2>
<section id="section-11.1">
        <h3 id="name-normative-references">
<a class="section-number selfRef" href="#section-11.1">11.1. </a><a class="section-name selfRef" href="#name-normative-references">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC0793">[RFC0793]</dt>
        <dd>
<span class="refAuthor">Postel, J.</span>, <span class="refTitle">"Transmission Control Protocol"</span>, <span class="seriesInfo">STD 7</span>, <span class="seriesInfo">RFC 793</span>, <span class="seriesInfo">DOI 10.17487/RFC0793</span>, <time class="refDate" datetime="1981-09">September 1981</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc793">https://www.rfc-editor.org/info/rfc793</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2018">[RFC2018]</dt>
        <dd>
<span class="refAuthor">Mathis, M.</span><span class="refAuthor">, Mahdavi, J.</span><span class="refAuthor">, Floyd, S.</span><span class="refAuthor">, and A. Romanow</span>, <span class="refTitle">"TCP Selective Acknowledgment Options"</span>, <span class="seriesInfo">RFC 2018</span>, <span class="seriesInfo">DOI 10.17487/RFC2018</span>, <time class="refDate" datetime="1996-10">October 1996</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2018">https://www.rfc-editor.org/info/rfc2018</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time class="refDate" datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2827">[RFC2827]</dt>
        <dd>
<span class="refAuthor">Ferguson, P.</span><span class="refAuthor"> and D. Senie</span>, <span class="refTitle">"Network Ingress Filtering: Defeating Denial of Service Attacks which employ IP Source Address Spoofing"</span>, <span class="seriesInfo">BCP 38</span>, <span class="seriesInfo">RFC 2827</span>, <span class="seriesInfo">DOI 10.17487/RFC2827</span>, <time class="refDate" datetime="2000-05">May 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2827">https://www.rfc-editor.org/info/rfc2827</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4291">[RFC4291]</dt>
        <dd>
<span class="refAuthor">Hinden, R.</span><span class="refAuthor"> and S. Deering</span>, <span class="refTitle">"IP Version 6 Addressing Architecture"</span>, <span class="seriesInfo">RFC 4291</span>, <span class="seriesInfo">DOI 10.17487/RFC4291</span>, <time class="refDate" datetime="2006-02">February 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4291">https://www.rfc-editor.org/info/rfc4291</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4787">[RFC4787]</dt>
        <dd>
<span class="refAuthor">Audet, F., Ed.</span><span class="refAuthor"> and C. Jennings</span>, <span class="refTitle">"Network Address Translation (NAT) Behavioral Requirements for Unicast UDP"</span>, <span class="seriesInfo">BCP 127</span>, <span class="seriesInfo">RFC 4787</span>, <span class="seriesInfo">DOI 10.17487/RFC4787</span>, <time class="refDate" datetime="2007-01">January 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4787">https://www.rfc-editor.org/info/rfc4787</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4987">[RFC4987]</dt>
        <dd>
<span class="refAuthor">Eddy, W.</span>, <span class="refTitle">"TCP SYN Flooding Attacks and Common Mitigations"</span>, <span class="seriesInfo">RFC 4987</span>, <span class="seriesInfo">DOI 10.17487/RFC4987</span>, <time class="refDate" datetime="2007-08">August 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4987">https://www.rfc-editor.org/info/rfc4987</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5925">[RFC5925]</dt>
        <dd>
<span class="refAuthor">Touch, J.</span><span class="refAuthor">, Mankin, A.</span><span class="refAuthor">, and R. Bonica</span>, <span class="refTitle">"The TCP Authentication Option"</span>, <span class="seriesInfo">RFC 5925</span>, <span class="seriesInfo">DOI 10.17487/RFC5925</span>, <time class="refDate" datetime="2010-06">June 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5925">https://www.rfc-editor.org/info/rfc5925</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6888">[RFC6888]</dt>
        <dd>
<span class="refAuthor">Perreault, S., Ed.</span><span class="refAuthor">, Yamagata, I.</span><span class="refAuthor">, Miyakawa, S.</span><span class="refAuthor">, Nakagawa, A.</span><span class="refAuthor">, and H. Ashida</span>, <span class="refTitle">"Common Requirements for Carrier-Grade NATs (CGNs)"</span>, <span class="seriesInfo">BCP 127</span>, <span class="seriesInfo">RFC 6888</span>, <span class="seriesInfo">DOI 10.17487/RFC6888</span>, <time class="refDate" datetime="2013-04">April 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6888">https://www.rfc-editor.org/info/rfc6888</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6890">[RFC6890]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span><span class="refAuthor">, Vegoda, L.</span><span class="refAuthor">, Bonica, R., Ed.</span><span class="refAuthor">, and B. Haberman</span>, <span class="refTitle">"Special-Purpose IP Address Registries"</span>, <span class="seriesInfo">BCP 153</span>, <span class="seriesInfo">RFC 6890</span>, <span class="seriesInfo">DOI 10.17487/RFC6890</span>, <time class="refDate" datetime="2013-04">April 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6890">https://www.rfc-editor.org/info/rfc6890</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7323">[RFC7323]</dt>
        <dd>
<span class="refAuthor">Borman, D.</span><span class="refAuthor">, Braden, B.</span><span class="refAuthor">, Jacobson, V.</span><span class="refAuthor">, and R. Scheffenegger, Ed.</span>, <span class="refTitle">"TCP Extensions for High Performance"</span>, <span class="seriesInfo">RFC 7323</span>, <span class="seriesInfo">DOI 10.17487/RFC7323</span>, <time class="refDate" datetime="2014-09">September 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7323">https://www.rfc-editor.org/info/rfc7323</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7413">[RFC7413]</dt>
        <dd>
<span class="refAuthor">Cheng, Y.</span><span class="refAuthor">, Chu, J.</span><span class="refAuthor">, Radhakrishnan, S.</span><span class="refAuthor">, and A. Jain</span>, <span class="refTitle">"TCP Fast Open"</span>, <span class="seriesInfo">RFC 7413</span>, <span class="seriesInfo">DOI 10.17487/RFC7413</span>, <time class="refDate" datetime="2014-12">December 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7413">https://www.rfc-editor.org/info/rfc7413</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span><span class="refAuthor">, Leiba, B.</span><span class="refAuthor">, and T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time class="refDate" datetime="2017-06">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time class="refDate" datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8684">[RFC8684]</dt>
      <dd>
<span class="refAuthor">Ford, A.</span><span class="refAuthor">, Raiciu, C.</span><span class="refAuthor">, Handley, M.</span><span class="refAuthor">, Bonaventure, O.</span><span class="refAuthor">, and C. Paasch</span>, <span class="refTitle">"TCP Extensions for Multipath Operation with Multiple Addresses"</span>, <span class="seriesInfo">RFC 8684</span>, <span class="seriesInfo">DOI 10.17487/RFC8684</span>, <time class="refDate" datetime="2020-03">March 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8684">https://www.rfc-editor.org/info/rfc8684</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-11.2">
        <h3 id="name-informative-references">
<a class="section-number selfRef" href="#section-11.2">11.2. </a><a class="section-name selfRef" href="#name-informative-references">Informative References</a>
        </h3>
<dl class="references">
<dt id="ANRW17">[ANRW17]</dt>
        <dd>
<span class="refAuthor">Trammell, B.</span><span class="refAuthor">, Kuehlewind, M.</span><span class="refAuthor">, De Vaere, P.</span><span class="refAuthor">, Learmonth, I.</span><span class="refAuthor">, and G. Fairhurst</span>, <span class="refTitle">"Tracking transport-layer evolution with PATHspider"</span>, <span class="refContent">Applied Networking Research Workshop 2017 (ANRW17)</span>, <time class="refDate" datetime="2017-07">July 2017</time>. </dd>
<dd class="break"></dd>
<dt id="I-D.boucadair-tcpm-dhc-converter">[DHC-CONVERTER]</dt>
        <dd>
<span class="refAuthor">Boucadair, M.</span><span class="refAuthor">, Jacquenet, C.</span><span class="refAuthor">, and T. Reddy.K</span>, <span class="refTitle">"DHCP Options for 0-RTT TCP Converters"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-boucadair-tcpm-dhc-converter-03</span>, <time class="refDate" datetime="2019-10-07">7 October 2019</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-boucadair-tcpm-dhc-converter-03">https://tools.ietf.org/html/draft-boucadair-tcpm-dhc-converter-03</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Fukuda2011">[Fukuda2011]</dt>
        <dd>
<span class="refAuthor">Fukuda, K.</span>, <span class="refTitle">"An Analysis of Longitudinal TCP Passive Measurements (Short Paper)"</span>, <span class="refContent">Traffic Monitoring and Analysis</span>, <span class="refContent">TMA 2011</span>, <span class="refContent">Lecture Notes in Computer Science, vol. 6613</span>, <time class="refDate" datetime="2011">2011</time>. </dd>
<dd class="break"></dd>
<dt id="HOT-MIDDLEBOX13">[HOT-MIDDLEBOX13]</dt>
        <dd>
<span class="refAuthor">Detal, G.</span><span class="refAuthor">, Paasch, C.</span><span class="refAuthor">, and O. Bonaventure</span>, <span class="refTitle">"Multipath in the Middle(Box)"</span>, <span class="refContent">HotMiddlebox'13</span>, <span class="seriesInfo">DOI 10.1145/2535828.2535829</span>, <time class="refDate" datetime="2013-12">December 2013</time>, <span>&lt;<a href="https://inl.info.ucl.ac.be/publications/multipath-middlebox">https://inl.info.ucl.ac.be/publications/multipath-middlebox</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA-CONVERT">[IANA-CONVERT]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"TCP Convert Protocol (Convert) Parameters"</span>, <span>&lt;<a href="https://www.iana.org/assignments/tcp-convert-protocol-parameters">https://www.iana.org/assignments/tcp-convert-protocol-parameters</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IETFJ16">[IETFJ16]</dt>
        <dd>
<span class="refAuthor">Bonaventure, O.</span><span class="refAuthor"> and S. Seo</span>, <span class="refTitle">"Multipath TCP Deployments"</span>, <span class="refContent">IETF Journal</span>, <span class="refContent">Vol. 12, Issue 2</span>, <time class="refDate" datetime="2016-11">November 2016</time>. </dd>
<dd class="break"></dd>
<dt id="IMC11">[IMC11]</dt>
        <dd>
<span class="refAuthor">Honda, K.</span><span class="refAuthor">, Nishida, Y.</span><span class="refAuthor">, Raiciu, C.</span><span class="refAuthor">, Greenhalgh, A.</span><span class="refAuthor">, Handley, M.</span><span class="refAuthor">, and T. Hideyuki</span>, <span class="refTitle">"Is it still possible to extend TCP?"</span>, <span class="refContent">Proceedings of the 2011 ACM SIGCOMM conference on
     Internet measurement conference
          </span>, <span class="seriesInfo">DOI 10.1145/2068816.2068834</span>, <time class="refDate" datetime="2011-11">November 2011</time>, <span>&lt;<a href="https://doi.org/10.1145/2068816.2068834">https://doi.org/10.1145/2068816.2068834</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.olteanu-intarea-socks-6">[INTAREA-SOCKS]</dt>
        <dd>
<span class="refAuthor">Olteanu, V.</span><span class="refAuthor"> and D. Niculescu</span>, <span class="refTitle">"SOCKS Protocol Version 6"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-olteanu-intarea-socks-6-10</span>, <time class="refDate" datetime="2020-07-13">13 July 2020</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-olteanu-intarea-socks-6-10">https://tools.ietf.org/html/draft-olteanu-intarea-socks-6-10</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.arkko-arch-low-latency">[LOW-LATENCY]</dt>
        <dd>
<span class="refAuthor">Arkko, J.</span><span class="refAuthor"> and J. Tantsura</span>, <span class="refTitle">"Low Latency Applications and the Internet Architecture"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-arkko-arch-low-latency-02</span>, <time class="refDate" datetime="2017-10-30">30 October 2017</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-arkko-arch-low-latency-02">https://tools.ietf.org/html/draft-arkko-arch-low-latency-02</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.boucadair-mptcp-plain-mode">[MPTCP-PLAIN]</dt>
        <dd>
<span class="refAuthor">Boucadair, M.</span><span class="refAuthor">, Jacquenet, C.</span><span class="refAuthor">, Bonaventure, O.</span><span class="refAuthor">, Behaghel, D.</span><span class="refAuthor">, Secci, S.</span><span class="refAuthor">, Henderickx, W.</span><span class="refAuthor">, Skog, R.</span><span class="refAuthor">, Vinapamula, S.</span><span class="refAuthor">, Seo, S.</span><span class="refAuthor">, Cloetens, W.</span><span class="refAuthor">, Meyer, U.</span><span class="refAuthor">, Contreras, L.</span><span class="refAuthor">, and B. Peirens</span>, <span class="refTitle">"Extensions for Network-Assisted MPTCP Deployment Models"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-boucadair-mptcp-plain-mode-10</span>, <time class="refDate" datetime="2017-03">March 2017</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-boucadair-mptcp-plain-mode-10">https://tools.ietf.org/html/draft-boucadair-mptcp-plain-mode-10</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.peirens-mptcp-transparent">[MPTCP-TRANSPARENT]</dt>
        <dd>
<span class="refAuthor">Peirens, B.</span><span class="refAuthor">, Detal, G.</span><span class="refAuthor">, Barre, S.</span><span class="refAuthor">, and O. Bonaventure</span>, <span class="refTitle">"Link bonding with transparent Multipath TCP"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-peirens-mptcp-transparent-00</span>, <time class="refDate" datetime="2016-07-08">8 July 2016</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-peirens-mptcp-transparent-00">https://tools.ietf.org/html/draft-peirens-mptcp-transparent-00</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1812">[RFC1812]</dt>
        <dd>
<span class="refAuthor">Baker, F., Ed.</span>, <span class="refTitle">"Requirements for IP Version 4 Routers"</span>, <span class="seriesInfo">RFC 1812</span>, <span class="seriesInfo">DOI 10.17487/RFC1812</span>, <time class="refDate" datetime="1995-06">June 1995</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1812">https://www.rfc-editor.org/info/rfc1812</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1919">[RFC1919]</dt>
        <dd>
<span class="refAuthor">Chatel, M.</span>, <span class="refTitle">"Classical versus Transparent IP Proxies"</span>, <span class="seriesInfo">RFC 1919</span>, <span class="seriesInfo">DOI 10.17487/RFC1919</span>, <time class="refDate" datetime="1996-03">March 1996</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1919">https://www.rfc-editor.org/info/rfc1919</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1928">[RFC1928]</dt>
        <dd>
<span class="refAuthor">Leech, M.</span><span class="refAuthor">, Ganis, M.</span><span class="refAuthor">, Lee, Y.</span><span class="refAuthor">, Kuris, R.</span><span class="refAuthor">, Koblas, D.</span><span class="refAuthor">, and L. Jones</span>, <span class="refTitle">"SOCKS Protocol Version 5"</span>, <span class="seriesInfo">RFC 1928</span>, <span class="seriesInfo">DOI 10.17487/RFC1928</span>, <time class="refDate" datetime="1996-03">March 1996</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1928">https://www.rfc-editor.org/info/rfc1928</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2782">[RFC2782]</dt>
        <dd>
<span class="refAuthor">Gulbrandsen, A.</span><span class="refAuthor">, Vixie, P.</span><span class="refAuthor">, and L. Esibov</span>, <span class="refTitle">"A DNS RR for specifying the location of services (DNS SRV)"</span>, <span class="seriesInfo">RFC 2782</span>, <span class="seriesInfo">DOI 10.17487/RFC2782</span>, <time class="refDate" datetime="2000-02">February 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2782">https://www.rfc-editor.org/info/rfc2782</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3135">[RFC3135]</dt>
        <dd>
<span class="refAuthor">Border, J.</span><span class="refAuthor">, Kojo, M.</span><span class="refAuthor">, Griner, J.</span><span class="refAuthor">, Montenegro, G.</span><span class="refAuthor">, and Z. Shelby</span>, <span class="refTitle">"Performance Enhancing Proxies Intended to Mitigate Link-Related Degradations"</span>, <span class="seriesInfo">RFC 3135</span>, <span class="seriesInfo">DOI 10.17487/RFC3135</span>, <time class="refDate" datetime="2001-06">June 2001</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3135">https://www.rfc-editor.org/info/rfc3135</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4279">[RFC4279]</dt>
        <dd>
<span class="refAuthor">Eronen, P., Ed.</span><span class="refAuthor"> and H. Tschofenig, Ed.</span>, <span class="refTitle">"Pre-Shared Key Ciphersuites for Transport Layer Security (TLS)"</span>, <span class="seriesInfo">RFC 4279</span>, <span class="seriesInfo">DOI 10.17487/RFC4279</span>, <time class="refDate" datetime="2005-12">December 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4279">https://www.rfc-editor.org/info/rfc4279</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5461">[RFC5461]</dt>
        <dd>
<span class="refAuthor">Gont, F.</span>, <span class="refTitle">"TCP's Reaction to Soft Errors"</span>, <span class="seriesInfo">RFC 5461</span>, <span class="seriesInfo">DOI 10.17487/RFC5461</span>, <time class="refDate" datetime="2009-02">February 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5461">https://www.rfc-editor.org/info/rfc5461</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6269">[RFC6269]</dt>
        <dd>
<span class="refAuthor">Ford, M., Ed.</span><span class="refAuthor">, Boucadair, M.</span><span class="refAuthor">, Durand, A.</span><span class="refAuthor">, Levis, P.</span><span class="refAuthor">, and P. Roberts</span>, <span class="refTitle">"Issues with IP Address Sharing"</span>, <span class="seriesInfo">RFC 6269</span>, <span class="seriesInfo">DOI 10.17487/RFC6269</span>, <time class="refDate" datetime="2011-06">June 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6269">https://www.rfc-editor.org/info/rfc6269</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6296">[RFC6296]</dt>
        <dd>
<span class="refAuthor">Wasserman, M.</span><span class="refAuthor"> and F. Baker</span>, <span class="refTitle">"IPv6-to-IPv6 Network Prefix Translation"</span>, <span class="seriesInfo">RFC 6296</span>, <span class="seriesInfo">DOI 10.17487/RFC6296</span>, <time class="refDate" datetime="2011-06">June 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6296">https://www.rfc-editor.org/info/rfc6296</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6731">[RFC6731]</dt>
        <dd>
<span class="refAuthor">Savolainen, T.</span><span class="refAuthor">, Kato, J.</span><span class="refAuthor">, and T. Lemon</span>, <span class="refTitle">"Improved Recursive DNS Server Selection for Multi-Interfaced Nodes"</span>, <span class="seriesInfo">RFC 6731</span>, <span class="seriesInfo">DOI 10.17487/RFC6731</span>, <time class="refDate" datetime="2012-12">December 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6731">https://www.rfc-editor.org/info/rfc6731</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6887">[RFC6887]</dt>
        <dd>
<span class="refAuthor">Wing, D., Ed.</span><span class="refAuthor">, Cheshire, S.</span><span class="refAuthor">, Boucadair, M.</span><span class="refAuthor">, Penno, R.</span><span class="refAuthor">, and P. Selkirk</span>, <span class="refTitle">"Port Control Protocol (PCP)"</span>, <span class="seriesInfo">RFC 6887</span>, <span class="seriesInfo">DOI 10.17487/RFC6887</span>, <time class="refDate" datetime="2013-04">April 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6887">https://www.rfc-editor.org/info/rfc6887</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6928">[RFC6928]</dt>
        <dd>
<span class="refAuthor">Chu, J.</span><span class="refAuthor">, Dukkipati, N.</span><span class="refAuthor">, Cheng, Y.</span><span class="refAuthor">, and M. Mathis</span>, <span class="refTitle">"Increasing TCP's Initial Window"</span>, <span class="seriesInfo">RFC 6928</span>, <span class="seriesInfo">DOI 10.17487/RFC6928</span>, <time class="refDate" datetime="2013-04">April 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6928">https://www.rfc-editor.org/info/rfc6928</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6978">[RFC6978]</dt>
        <dd>
<span class="refAuthor">Touch, J.</span>, <span class="refTitle">"A TCP Authentication Option Extension for NAT Traversal"</span>, <span class="seriesInfo">RFC 6978</span>, <span class="seriesInfo">DOI 10.17487/RFC6978</span>, <time class="refDate" datetime="2013-07">July 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6978">https://www.rfc-editor.org/info/rfc6978</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7250">[RFC7250]</dt>
        <dd>
<span class="refAuthor">Wouters, P., Ed.</span><span class="refAuthor">, Tschofenig, H., Ed.</span><span class="refAuthor">, Gilmore, J.</span><span class="refAuthor">, Weiler, S.</span><span class="refAuthor">, and T. Kivinen</span>, <span class="refTitle">"Using Raw Public Keys in Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)"</span>, <span class="seriesInfo">RFC 7250</span>, <span class="seriesInfo">DOI 10.17487/RFC7250</span>, <time class="refDate" datetime="2014-06">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7250">https://www.rfc-editor.org/info/rfc7250</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7414">[RFC7414]</dt>
        <dd>
<span class="refAuthor">Duke, M.</span><span class="refAuthor">, Braden, R.</span><span class="refAuthor">, Eddy, W.</span><span class="refAuthor">, Blanton, E.</span><span class="refAuthor">, and A. Zimmermann</span>, <span class="refTitle">"A Roadmap for Transmission Control Protocol (TCP) Specification Documents"</span>, <span class="seriesInfo">RFC 7414</span>, <span class="seriesInfo">DOI 10.17487/RFC7414</span>, <time class="refDate" datetime="2015-02">February 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7414">https://www.rfc-editor.org/info/rfc7414</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8041">[RFC8041]</dt>
        <dd>
<span class="refAuthor">Bonaventure, O.</span><span class="refAuthor">, Paasch, C.</span><span class="refAuthor">, and G. Detal</span>, <span class="refTitle">"Use Cases and Operational Experience with Multipath TCP"</span>, <span class="seriesInfo">RFC 8041</span>, <span class="seriesInfo">DOI 10.17487/RFC8041</span>, <time class="refDate" datetime="2017-01">January 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8041">https://www.rfc-editor.org/info/rfc8041</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8305">[RFC8305]</dt>
        <dd>
<span class="refAuthor">Schinazi, D.</span><span class="refAuthor"> and T. Pauly</span>, <span class="refTitle">"Happy Eyeballs Version 2: Better Connectivity Using Concurrency"</span>, <span class="seriesInfo">RFC 8305</span>, <span class="seriesInfo">DOI 10.17487/RFC8305</span>, <time class="refDate" datetime="2017-12">December 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8305">https://www.rfc-editor.org/info/rfc8305</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time class="refDate" datetime="2018-08">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8548">[RFC8548]</dt>
        <dd>
<span class="refAuthor">Bittau, A.</span><span class="refAuthor">, Giffin, D.</span><span class="refAuthor">, Handley, M.</span><span class="refAuthor">, Mazieres, D.</span><span class="refAuthor">, Slack, Q.</span><span class="refAuthor">, and E. Smith</span>, <span class="refTitle">"Cryptographic Protection of TCP Streams (tcpcrypt)"</span>, <span class="seriesInfo">RFC 8548</span>, <span class="seriesInfo">DOI 10.17487/RFC8548</span>, <time class="refDate" datetime="2019-05">May 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8548">https://www.rfc-editor.org/info/rfc8548</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.boucadair-opsawg-tcpm-converter">[TCPM-CONVERTER]</dt>
        <dd>
<span class="refAuthor">Boucadair, M.</span><span class="refAuthor"> and C. Jacquenet</span>, <span class="refTitle">"RADIUS Extensions for 0-RTT TCP Converters"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-boucadair-opsawg-tcpm-converter-01</span>, <time class="refDate" datetime="2020-02-28">28 February 2020</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-boucadair-opsawg-tcpm-converter-01">https://tools.ietf.org/html/draft-boucadair-opsawg-tcpm-converter-01</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TS23501">[TS23501]</dt>
      <dd>
<span class="refAuthor">3GPP (3rd Generation Partnership Project)</span>, <span class="refTitle">"Technical Specification Group Services and System Aspects; System architecture for the 5G System; Stage 2 (Release 16)"</span>, <time class="refDate" datetime="2019">2019</time>, <span>&lt;<a href="https://www.3gpp.org/ftp/Specs/archive/23_series/23.501/">https://www.3gpp.org/ftp/Specs/archive/23_series/23.501/</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="sec-api">
<section id="section-appendix.a">
      <h2 id="name-example-socket-api-changes-">
<a class="section-number selfRef" href="#section-appendix.a">Appendix A. </a><a class="section-name selfRef" href="#name-example-socket-api-changes-">Example Socket API Changes to Support the 0-RTT TCP Convert Protocol</a>
      </h2>
<div id="active-open-client-side">
<section id="section-a.1">
        <h2 id="name-active-open-client-side">
<a class="section-number selfRef" href="#section-a.1">A.1. </a><a class="section-name selfRef" href="#name-active-open-client-side">Active Open (Client Side)</a>
        </h2>
<p id="section-a.1-1">On the Client side, the support of the 0-RTT Converter protocol
        does not require any other changes than those identified in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc7413#appendix-A">Appendix A</a> of [<a class="xref" href="#RFC7413">RFC7413</a>]</span>. Those modifications
        are already supported by multiple TCP stacks.<a class="pilcrow" href="#section-a.1-1">¶</a></p>
<p id="section-a.1-2">As an example, on Linux, a Client can send the 0-RTT Convert
        message inside a SYN by using sendto with the MSG_FASTOPEN flag as
        shown in the example below:<a class="pilcrow" href="#section-a.1-2">¶</a></p>
<div class="artwork art-text alignLeft" id="section-a.1-3">
<pre>  s = socket(AF_INET, SOCK_STREAM, 0);

  sendto(s, buffer, buffer_len, MSG_FASTOPEN,
                 (struct sockaddr *) &amp;server_addr, addr_len);
</pre><a class="pilcrow" href="#section-a.1-3">¶</a>
</div>
<p id="section-a.1-4">The Client side of the Linux TFO can be used in two different
        modes depending on the host configuration (sysctl tcp_fastopen
        variable):<a class="pilcrow" href="#section-a.1-4">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-a.1-5">
          <dt id="section-a.1-5.1">0x1:</dt>
          <dd id="section-a.1-5.2">(client) enables sending data in the opening SYN on the
            Client.<a class="pilcrow" href="#section-a.1-5.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-a.1-5.3">0x4:</dt>
          <dd id="section-a.1-5.4">(client) enables sending data in the opening SYN regardless of cookie
            availability and without a cookie option.<a class="pilcrow" href="#section-a.1-5.4">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-a.1-6">By setting this configuration variable to 0x5, a Linux Client using
        the above code would send data inside the SYN without using a TFO
        option.<a class="pilcrow" href="#section-a.1-6">¶</a></p>
</section>
</div>
<div id="passive-open-converter-side">
<section id="section-a.2">
        <h2 id="name-passive-open-converter-side">
<a class="section-number selfRef" href="#section-a.2">A.2. </a><a class="section-name selfRef" href="#name-passive-open-converter-side">Passive Open (Converter Side)</a>
        </h2>
<p id="section-a.2-1">The Converter needs to enable the reception of data inside the SYN
        independently of the utilization of the TFO option. This implies that
        the Transport Converter application cannot rely on the Fast Open Cookies to
        validate the reachability of the IP address that sent the SYN. It must
        rely on other techniques, such as the Cookie TLV described in this
        document, to verify this reachability.<a class="pilcrow" href="#section-a.2-1">¶</a></p>
<p id="section-a.2-2"><span>[<a class="xref" href="#RFC7413">RFC7413</a>]</span> suggested the utilization of a
        TCP_FASTOPEN socket option to enable the reception of SYNs containing
        data. Later, <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc7413#appendix-A">Appendix A</a> of [<a class="xref" href="#RFC7413">RFC7413</a>]</span>
        mentioned:<a class="pilcrow" href="#section-a.2-2">¶</a></p>
<blockquote id="section-a.2-3">    
  Traditionally, accept() returns only after a socket is connected.
  But, for a Fast Open connection, accept() returns upon receiving
  a SYN with a valid Fast Open cookie and data, and the data is 
  available to be read through, e.g., recvmsg(), read().<a class="pilcrow" href="#section-a.2-3">¶</a>
</blockquote>
<p id="section-a.2-4">To support the 0-RTT TCP Convert Protocol, this behavior should be
        modified as follows:<a class="pilcrow" href="#section-a.2-4">¶</a></p>
<blockquote id="section-a.2-5">
  Traditionally, accept() returns only after a socket is connected.
  But, for a Fast Open connection, accept() returns upon receiving a
  SYN with data, and the data is available to be read through, e.g.,
  recvmsg(), read(). The application that receives such SYNs with 
  data must be able to validate the reachability of the source of 
  the SYN and also deal with replayed SYNs.<a class="pilcrow" href="#section-a.2-5">¶</a>
</blockquote>
<p id="section-a.2-6">The Linux Server side can be configured with the following
        sysctls:<a class="pilcrow" href="#section-a.2-6">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-a.2-7">
          <dt id="section-a.2-7.1">0x2:</dt>
          <dd id="section-a.2-7.2">(server) enables the Server support, i.e., allowing data
            in a SYN packet to be accepted and passed to the application
            before a 3-way handshake finishes.<a class="pilcrow" href="#section-a.2-7.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-a.2-7.3">0x200:</dt>
          <dd id="section-a.2-7.4">(server) accepts data-in-SYN w/o any cookie option
            present.<a class="pilcrow" href="#section-a.2-7.4">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-a.2-8">However, this configuration is system wide. This is convenient for
        typical Transport Converter deployments where no other applications
        relying on TFO are collocated on the same device.<a class="pilcrow" href="#section-a.2-8">¶</a></p>
<p id="section-a.2-9">Recently, the TCP_FASTOPEN_NO_COOKIE socket option has been added
        to provide the same behavior on a per-socket basis. This enables a
        single host to support both Servers that require the Fast Open Cookie and
        Servers that do not use it.<a class="pilcrow" href="#section-a.2-9">¶</a></p>
</section>
</div>
</section>
</div>
<div id="acknowledgments">
<section id="section-appendix.b">
      <h2 id="name-acknowledgments">
<a class="section-name selfRef" href="#name-acknowledgments">Acknowledgments</a>
      </h2>
<p id="section-appendix.b-1">Although they could disagree with the contents of the document, we
      would like to thank <span class="contact-name">Joe Touch</span> and <span class="contact-name">Juliusz       Chroboczek</span>, whose comments on the MPTCP mailing list have forced us to
      reconsider the design of the solution several times.<a class="pilcrow" href="#section-appendix.b-1">¶</a></p>
<p id="section-appendix.b-2">We would like to thank <span class="contact-name">Raphael Bauduin</span>,
      <span class="contact-name">Stefano Secci</span>, <span class="contact-name">Anandatirtha       Nandugudi</span>, and <span class="contact-name">Gregory Vander Schueren</span> for their help in preparing this
      document. <span class="contact-name">Nandini Ganesh</span> provided valuable feedback about the handling
      of TFO and the error codes. <span class="contact-name">Yuchung Cheng</span> and
      <span class="contact-name">Praveen Balasubramanian</span>
      helped to clarify the discussion on supplying data in SYNs. <span class="contact-name">Phil Eardley</span>
      and <span class="contact-name">Michael Scharf</span> helped to clarify different parts of the text.
      Thanks to <span class="contact-name">Éric Vyncke</span>, <span class="contact-name">Roman       Danyliw</span>, <span class="contact-name">Benjamin Kaduk</span>, and <span class="contact-name">Alexey       Melnikov</span> for the IESG review, and <span class="contact-name">Christian Huitema</span> for the Security
      Directorate review.<a class="pilcrow" href="#section-appendix.b-2">¶</a></p>
<p id="section-appendix.b-3">Many thanks to <span class="contact-name">Mirja Kühlewind</span> for the detailed AD review.<a class="pilcrow" href="#section-appendix.b-3">¶</a></p>
<p id="section-appendix.b-4">This document builds upon earlier documents that proposed various
      forms of Multipath TCP proxies: <span>[<a class="xref" href="#I-D.boucadair-mptcp-plain-mode">MPTCP-PLAIN</a>]</span>, <span>[<a class="xref" href="#I-D.peirens-mptcp-transparent">MPTCP-TRANSPARENT</a>]</span>, and <span>[<a class="xref" href="#HOT-MIDDLEBOX13">HOT-MIDDLEBOX13</a>]</span>.<a class="pilcrow" href="#section-appendix.b-4">¶</a></p>
<p id="section-appendix.b-5">From <span>[<a class="xref" href="#I-D.boucadair-mptcp-plain-mode">MPTCP-PLAIN</a>]</span>:<a class="pilcrow" href="#section-appendix.b-5">¶</a></p>
<p id="section-appendix.b-6">Many thanks to <span class="contact-name">Chi Dung Phung</span>, <span class="contact-name">Mingui Zhang</span>, <span class="contact-name">Rao Shoaib</span>, <span class="contact-name">Yoshifumi       Nishida</span>, and <span class="contact-name">Christoph Paasch</span> for their valuable comments.<a class="pilcrow" href="#section-appendix.b-6">¶</a></p>
<p id="section-appendix.b-7">Thanks to <span class="contact-name">Ian Farrer</span>, <span class="contact-name">Mikael       Abrahamsson</span>, <span class="contact-name">Alan Ford</span>, <span class="contact-name">Dan       Wing</span>, and <span class="contact-name">Sri Gundavelli</span> for the fruitful
      discussions at IETF 95 (Buenos Aires).<a class="pilcrow" href="#section-appendix.b-7">¶</a></p>
<p id="section-appendix.b-8">Special thanks to <span class="contact-name">Pierrick Seite</span>, <span class="contact-name">Yannick Le Goff</span>, <span class="contact-name">Fred Klamm</span>, and
      <span class="contact-name">Xavier Grall</span> for their input.<a class="pilcrow" href="#section-appendix.b-8">¶</a></p>
<p id="section-appendix.b-9">Thanks also to <span class="contact-name">Olaf Schleusing</span>, <span class="contact-name">Martin Gysi</span>, <span class="contact-name">Thomas Zasowski</span>,
      <span class="contact-name">Andreas       Burkhard</span>, <span class="contact-name">Silka Simmen</span>, <span class="contact-name">Sandro Berger</span>, <span class="contact-name">Michael Melloul</span>,
      <span class="contact-name">Jean-Yves       Flahaut</span>, <span class="contact-name">Adrien Desportes</span>, <span class="contact-name">Gregory Detal</span>, <span class="contact-name">Benjamin David</span>,
      <span class="contact-name">Arun       Srinivasan</span>, and <span class="contact-name">Raghavendra Mallya</span> for their input.<a class="pilcrow" href="#section-appendix.b-9">¶</a></p>
</section>
</div>
<div id="contributors">
<section id="section-appendix.c">
      <h2 id="name-contributors">
<a class="section-name selfRef" href="#name-contributors">Contributors</a>
      </h2>
<p id="section-appendix.c-1"><span class="contact-name">Bart Peirens</span> contributed to an early draft version of this document.<a class="pilcrow" href="#section-appendix.c-1">¶</a></p>
<p id="section-appendix.c-2">As noted above, this document builds on two previous documents.<a class="pilcrow" href="#section-appendix.c-2">¶</a></p>
<p id="section-appendix.c-3">The authors of <span>[<a class="xref" href="#I-D.boucadair-mptcp-plain-mode">MPTCP-PLAIN</a>]</span>
      were:<a class="pilcrow" href="#section-appendix.c-3">¶</a></p>
<ul class="normal">
<li class="normal" id="section-appendix.c-4.1">
          <p id="section-appendix.c-4.1.1"><span class="contact-name">Mohamed Boucadair</span><a class="pilcrow" href="#section-appendix.c-4.1.1">¶</a></p>
</li>
        <li class="normal" id="section-appendix.c-4.2">
          <p id="section-appendix.c-4.2.1"><span class="contact-name">Christian Jacquenet</span><a class="pilcrow" href="#section-appendix.c-4.2.1">¶</a></p>
</li>
        <li class="normal" id="section-appendix.c-4.3">
          <p id="section-appendix.c-4.3.1"><span class="contact-name">Olivier Bonaventure</span><a class="pilcrow" href="#section-appendix.c-4.3.1">¶</a></p>
</li>
        <li class="normal" id="section-appendix.c-4.4">
          <p id="section-appendix.c-4.4.1"><span class="contact-name">Denis Behaghel</span><a class="pilcrow" href="#section-appendix.c-4.4.1">¶</a></p>
</li>
        <li class="normal" id="section-appendix.c-4.5">
          <p id="section-appendix.c-4.5.1"><span class="contact-name">Stefano Secci</span><a class="pilcrow" href="#section-appendix.c-4.5.1">¶</a></p>
</li>
        <li class="normal" id="section-appendix.c-4.6">
          <p id="section-appendix.c-4.6.1"><span class="contact-name">Wim Henderickx</span><a class="pilcrow" href="#section-appendix.c-4.6.1">¶</a></p>
</li>
        <li class="normal" id="section-appendix.c-4.7">
          <p id="section-appendix.c-4.7.1"><span class="contact-name">Robert Skog</span><a class="pilcrow" href="#section-appendix.c-4.7.1">¶</a></p>
</li>
        <li class="normal" id="section-appendix.c-4.8">
          <p id="section-appendix.c-4.8.1"><span class="contact-name">Suresh Vinapamula</span><a class="pilcrow" href="#section-appendix.c-4.8.1">¶</a></p>
</li>
        <li class="normal" id="section-appendix.c-4.9">
          <p id="section-appendix.c-4.9.1"><span class="contact-name">SungHoon Seo</span><a class="pilcrow" href="#section-appendix.c-4.9.1">¶</a></p>
</li>
        <li class="normal" id="section-appendix.c-4.10">
          <p id="section-appendix.c-4.10.1"><span class="contact-name">Wouter Cloetens</span><a class="pilcrow" href="#section-appendix.c-4.10.1">¶</a></p>
</li>
        <li class="normal" id="section-appendix.c-4.11">
          <p id="section-appendix.c-4.11.1"><span class="contact-name">Ullrich Meyer</span><a class="pilcrow" href="#section-appendix.c-4.11.1">¶</a></p>
</li>
        <li class="normal" id="section-appendix.c-4.12">
          <p id="section-appendix.c-4.12.1"><span class="contact-name">Luis M. Contreras</span><a class="pilcrow" href="#section-appendix.c-4.12.1">¶</a></p>
</li>
        <li class="normal" id="section-appendix.c-4.13">
          <p id="section-appendix.c-4.13.1"><span class="contact-name">Bart Peirens</span><a class="pilcrow" href="#section-appendix.c-4.13.1">¶</a></p>
</li>
      </ul>
<p id="section-appendix.c-5">The authors of <span>[<a class="xref" href="#I-D.peirens-mptcp-transparent">MPTCP-TRANSPARENT</a>]</span>
      were:<a class="pilcrow" href="#section-appendix.c-5">¶</a></p>
<ul class="normal">
<li class="normal" id="section-appendix.c-6.1">
          <p id="section-appendix.c-6.1.1"><span class="contact-name">Bart Peirens</span><a class="pilcrow" href="#section-appendix.c-6.1.1">¶</a></p>
</li>
        <li class="normal" id="section-appendix.c-6.2">
          <p id="section-appendix.c-6.2.1"><span class="contact-name">Gregory Detal</span><a class="pilcrow" href="#section-appendix.c-6.2.1">¶</a></p>
</li>
        <li class="normal" id="section-appendix.c-6.3">
          <p id="section-appendix.c-6.3.1"><span class="contact-name">Sebastien Barre</span><a class="pilcrow" href="#section-appendix.c-6.3.1">¶</a></p>
</li>
        <li class="normal" id="section-appendix.c-6.4">
          <p id="section-appendix.c-6.4.1"><span class="contact-name">Olivier Bonaventure</span><a class="pilcrow" href="#section-appendix.c-6.4.1">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="authors-addresses">
<section id="section-appendix.d">
      <h2 id="name-authors-addresses">
<a class="section-name selfRef" href="#name-authors-addresses">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Olivier Bonaventure (<span class="role">editor</span>)</span></div>
<div class="left" dir="auto"><span class="org">Tessares</span></div>
<div class="left" dir="auto"><span class="street-address">Avenue Jean Monnet 1</span></div>
<div class="left" dir="auto"><span class="locality">B-1348 Louvain-la-Neuve</span></div>
<div class="left" dir="auto"><span class="country-name">Belgium</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:Olivier.Bonaventure@tessares.net">Olivier.Bonaventure@tessares.net</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Mohamed Boucadair (<span class="role">editor</span>)</span></div>
<div class="left" dir="auto"><span class="org">Orange</span></div>
<div class="left" dir="auto"><span class="street-address">Clos Courtel</span></div>
<div class="left" dir="auto">
<span class="postal-code">35000</span> <span class="locality">Rennes</span>
</div>
<div class="left" dir="auto"><span class="country-name">France</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:mohamed.boucadair@orange.com">mohamed.boucadair@orange.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Sri Gundavelli</span></div>
<div class="left" dir="auto"><span class="org">Cisco</span></div>
<div class="left" dir="auto"><span class="street-address">170 West Tasman Drive</span></div>
<div class="left" dir="auto">
<span class="locality">San Jose</span>, <span class="region">CA</span> <span class="postal-code">95134</span>
</div>
<div class="left" dir="auto"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:sgundave@cisco.com">sgundave@cisco.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">SungHoon Seo</span></div>
<div class="left" dir="auto"><span class="org">Korea Telecom</span></div>
<div class="left" dir="auto"><span class="street-address">151 Taebong-ro</span></div>
<div class="left" dir="auto"><span class="locality">Seocho-gu, Seoul, 06763</span></div>
<div class="left" dir="auto"><span class="country-name">Republic of Korea</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:sh.seo@kt.com">sh.seo@kt.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Benjamin Hesmans</span></div>
<div class="left" dir="auto"><span class="org">Tessares</span></div>
<div class="left" dir="auto"><span class="street-address">Avenue Jean Monnet 1</span></div>
<div class="left" dir="auto"><span class="locality">B-1348 Louvain-la-Neuve</span></div>
<div class="left" dir="auto"><span class="country-name">Belgium</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:Benjamin.Hesmans@tessares.net">Benjamin.Hesmans@tessares.net</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>


</body></html>