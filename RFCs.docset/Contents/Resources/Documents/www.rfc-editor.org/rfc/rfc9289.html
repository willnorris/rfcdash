<!DOCTYPE html>
<html class="RFC" lang="en"><head>
<meta charset="utf-8"/>
<meta content="Common,Latin" name="scripts"/>
<meta content="initial-scale=1.0" name="viewport"/>
<title>RFC 9289: Towards Remote Procedure Call Encryption by Default</title>
<meta content="Trond Myklebust" name="author"/>
<meta content="Charles Lever" name="author"/>
<meta content="
       
This document describes a mechanism that, through the use of opportunistic
Transport Layer Security (TLS), enables encryption of Remote Procedure Call
(RPC) transactions while they are in transit.  The proposed mechanism
interoperates with Open Network Computing (ONC) RPC implementations that do
not support it.  This document updates RFC 5531.
 
    " name="description"/>
<meta content="xml2rfc 3.14.2" name="generator"/>
<meta content="network file system" name="keyword"/>
<meta content="remote procedure call" name="keyword"/>
<meta content="transport layer security" name="keyword"/>
<meta content="X.509" name="keyword"/>
<meta content="9289" name="rfc.number"/>
<!-- Generator version information:
  xml2rfc 3.14.2
    Python 3.9.13
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.1
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 3.1.2
    kitchen 1.2.6
    lxml 4.9.0
    MarkupSafe 2.1.1
    pycountry 22.3.5
    PyYAML 6.0
    requests 2.28.0
    setuptools 44.1.1
    six 1.16.0
    weasyprint 56.1
-->
<link href="rfc9289.xml" rel="alternate" type="application/rfc+xml"/>
<link href="#copyright" rel="license"/>
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  pre.breakable {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css"/>
<link href="https://dx.doi.org/10.17487/rfc9289" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <link href="https://datatracker.ietf.org/doc/draft-ietf-nfsv4-rpc-tls-11" rel="prev"/>
  </head>
<body>
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 9289</td>
<td class="center">RPC-With-TLS</td>
<td class="right">September 2022</td>
</tr></thead>
<tfoot><tr>
<td class="left">Myklebust &amp; Lever</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div class="document-information" id="external-metadata"></div>
<div class="document-information" id="internal-metadata">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a class="eref" href="https://www.rfc-editor.org/rfc/rfc9289">9289</a></dd>
<dt class="label-updates">Updates:</dt>
<dd class="updates">
<a class="eref" href="https://www.rfc-editor.org/rfc/rfc5531">5531</a> </dd>
<dt class="label-category">Category:</dt>
<dd class="category">Standards Track</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time class="published" datetime="2022-09">September 2022</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">T. Myklebust</div>
<div class="org">Hammerspace</div>
</div>
<div class="author">
      <div class="author-name">C. Lever, <span class="editor">Ed.</span>
</div>
<div class="org">Oracle</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 9289</h1>
<h1 id="title">Towards Remote Procedure Call Encryption by Default</h1>
<section id="section-abstract">
      <h2 id="abstract"><a class="selfRef" href="#abstract">Abstract</a></h2>
<p id="section-abstract-1">
This document describes a mechanism that, through the use of opportunistic
Transport Layer Security (TLS), enables encryption of Remote Procedure Call
(RPC) transactions while they are in transit.  The proposed mechanism
interoperates with Open Network Computing (ONC) RPC implementations that do
not support it.  This document updates RFC 5531.<a class="pilcrow" href="#section-abstract-1">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a class="section-name selfRef" href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This is an Internet Standards Track document.<a class="pilcrow" href="#section-boilerplate.1-1">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.<a class="pilcrow" href="#section-boilerplate.1-2">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc9289">https://www.rfc-editor.org/info/rfc9289</a></span>.<a class="pilcrow" href="#section-boilerplate.1-3">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a class="section-name selfRef" href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2022 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a class="pilcrow" href="#section-boilerplate.2-1">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a class="pilcrow" href="#section-boilerplate.2-2">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a class="toplink" href="#" onclick="scroll(0,0)">▲</a><h2 id="name-table-of-contents">
<a class="section-name selfRef" href="#name-table-of-contents">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p class="keepWithNext" id="section-toc.1-1.1.1"><a class="xref" href="#section-1">1</a>.  <a class="xref" href="#name-introduction">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p class="keepWithNext" id="section-toc.1-1.2.1"><a class="xref" href="#section-2">2</a>.  <a class="xref" href="#name-requirements-language">Requirements Language</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p class="keepWithNext" id="section-toc.1-1.3.1"><a class="xref" href="#section-3">3</a>.  <a class="xref" href="#name-terminology">Terminology</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a class="xref" href="#section-4">4</a>.  <a class="xref" href="#name-rpc-with-tls-in-operation">RPC-with-TLS in Operation</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a class="xref" href="#section-4.1">4.1</a>.  <a class="xref" href="#name-discovering-server-side-tls">Discovering Server-Side TLS Support</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a class="xref" href="#section-4.2">4.2</a>.  <a class="xref" href="#name-authentication">Authentication</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a class="xref" href="#section-4.2.1">4.2.1</a>.  <a class="xref" href="#name-using-tls-with-rpcsec_gss">Using TLS with RPCSEC_GSS</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a class="xref" href="#section-5">5</a>.  <a class="xref" href="#name-tls-requirements">TLS Requirements</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a class="xref" href="#section-5.1">5.1</a>.  <a class="xref" href="#name-base-transport-consideratio">Base Transport Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.1">
                    <p id="section-toc.1-1.5.2.1.2.1.1"><a class="xref" href="#section-5.1.1">5.1.1</a>.  <a class="xref" href="#name-protected-operation-on-tcp">Protected Operation on TCP</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.2">
                    <p id="section-toc.1-1.5.2.1.2.2.1"><a class="xref" href="#section-5.1.2">5.1.2</a>.  <a class="xref" href="#name-protected-operation-on-udp">Protected Operation on UDP</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.3">
                    <p id="section-toc.1-1.5.2.1.2.3.1"><a class="xref" href="#section-5.1.3">5.1.3</a>.  <a class="xref" href="#name-protected-operation-on-othe">Protected Operation on Other Transports</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a class="xref" href="#section-5.2">5.2</a>.  <a class="xref" href="#name-tls-peer-authentication">TLS Peer Authentication</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.1">
                    <p id="section-toc.1-1.5.2.2.2.1.1"><a class="xref" href="#section-5.2.1">5.2.1</a>.  <a class="xref" href="#name-x509-certificates-using-pki">X.509 Certificates Using PKIX Trust</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.1.2.1">
                        <p id="section-toc.1-1.5.2.2.2.1.2.1.1"><a class="xref" href="#section-5.2.1.1">5.2.1.1</a>.  <a class="xref" href="#name-extended-key-usage-values">Extended Key Usage Values</a></p>
</li>
                    </ul>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.2">
                    <p id="section-toc.1-1.5.2.2.2.2.1"><a class="xref" href="#section-5.2.2">5.2.2</a>.  <a class="xref" href="#name-pre-shared-keys">Pre-shared Keys</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a class="xref" href="#section-6">6</a>.  <a class="xref" href="#name-security-considerations">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a class="xref" href="#section-6.1">6.1</a>.  <a class="xref" href="#name-the-limitations-of-opportun">The Limitations of Opportunistic Security</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.1">
                    <p id="section-toc.1-1.6.2.1.2.1.1"><a class="xref" href="#section-6.1.1">6.1.1</a>.  <a class="xref" href="#name-striptls-attacks">STRIPTLS Attacks</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.2">
                    <p id="section-toc.1-1.6.2.1.2.2.1"><a class="xref" href="#section-6.1.2">6.1.2</a>.  <a class="xref" href="#name-privacy-leakage-before-sess">Privacy Leakage before Session Establishment</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a class="xref" href="#section-6.2">6.2</a>.  <a class="xref" href="#name-tls-identity-management-on-">TLS Identity Management on Clients</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a class="xref" href="#section-6.3">6.3</a>.  <a class="xref" href="#name-security-considerations-for">Security Considerations for AUTH_SYS on TLS</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a class="xref" href="#section-6.4">6.4</a>.  <a class="xref" href="#name-best-security-policy-practi">Best Security Policy Practices</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a class="xref" href="#section-7">7</a>.  <a class="xref" href="#name-iana-considerations">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a class="xref" href="#section-7.1">7.1</a>.  <a class="xref" href="#name-rpc-authentication-flavor">RPC Authentication Flavor</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a class="xref" href="#section-7.2">7.2</a>.  <a class="xref" href="#name-alpn-identifier-for-sunrpc">ALPN Identifier for SunRPC</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a class="xref" href="#section-7.3">7.3</a>.  <a class="xref" href="#name-object-identifier-for-pkix-">Object Identifier for PKIX Extended Key Usage</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a class="xref" href="#section-7.4">7.4</a>.  <a class="xref" href="#name-object-identifier-for-asn1-">Object Identifier for ASN.1 Module</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a class="xref" href="#section-8">8</a>.  <a class="xref" href="#name-references">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a class="xref" href="#section-8.1">8.1</a>.  <a class="xref" href="#name-normative-references">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a class="xref" href="#section-8.2">8.2</a>.  <a class="xref" href="#name-informative-references">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a class="xref" href="#appendix-A">Appendix A</a>.  <a class="xref" href="#name-known-weaknesses-of-the-aut">Known Weaknesses of the AUTH_SYS Authentication Flavor</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a class="xref" href="#appendix-B">Appendix B</a>.  <a class="xref" href="#name-asn1-module">ASN.1 Module</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a class="xref" href="#appendix-C"></a><a class="xref" href="#name-acknowledgments">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a class="xref" href="#appendix-D"></a><a class="xref" href="#name-authors-addresses">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="section_8F035331-8EB8-4FBC-973A-673FBA5FE952">
<section id="section-1">
      <h2 id="name-introduction">
<a class="section-number selfRef" href="#section-1">1. </a><a class="section-name selfRef" href="#name-introduction">Introduction</a>
      </h2>
<p id="section-1-1">
In 2014 the IETF published a document entitled "Pervasive Monitoring Is an
Attack" <span>[<a class="xref" href="#RFC7258">RFC7258</a>]</span>, which
recognized that unauthorized observation of network traffic had become
widespread and was a subversive threat to all who make use of the Internet at
large.  It strongly recommended that newly defined Internet protocols should
make a genuine effort to mitigate monitoring attacks.  Typically, this
mitigation includes encrypting data in transit.<a class="pilcrow" href="#section-1-1">¶</a></p>
<p id="section-1-2">
The Remote Procedure Call version 2 protocol has been a Proposed Standard for
three decades (see
<span>[<a class="xref" href="#RFC5531">RFC5531</a>]</span>
and its antecedents).  Over twenty years ago, Eisler et al. first introduced
RPCSEC_GSS as an in-transit encryption mechanism for RPC <span>[<a class="xref" href="#RFC2203">RFC2203</a>]</span>.  However, experience
has shown that RPCSEC_GSS with in-transit encryption can be challenging to use
in practice due to the following:<a class="pilcrow" href="#section-1-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-3.1">
Parts of each RPC header remain in cleartext,
constituting a loss of metadata confidentiality.<a class="pilcrow" href="#section-1-3.1">¶</a>
</li>
        <li class="normal" id="section-1-3.2">
Offloading the Generic Security Service (GSS) privacy service is not practical
in large multi-user deployments
since each message is encrypted using a key based
on the issuing RPC user.<a class="pilcrow" href="#section-1-3.2">¶</a>
</li>
      </ul>
<p id="section-1-4">
However strong GSS-provided confidentiality is,
it cannot provide any security if the challenges
of using it result in choosing not to deploy it at all.<a class="pilcrow" href="#section-1-4">¶</a></p>
<p id="section-1-5">
Moreover, the use of AUTH_SYS
remains common despite the adverse effects
that acceptance of User Identifiers (UIDs) and Group Identifiers (GIDs)
from unauthenticated clients brings with it.
Continued use is in part because:<a class="pilcrow" href="#section-1-5">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-6.1">
Per-client deployment and administrative costs
for the only well-defined alternative to AUTH_SYS
are expensive at scale.
For instance, administrators must provide keying material
for each RPC client, including transient clients.<a class="pilcrow" href="#section-1-6.1">¶</a>
</li>
        <li class="normal" id="section-1-6.2">
GSS host identity management and user identity management typically must be
enforced in the same security realm.  However, cloud providers, for instance,
might prefer to remain authoritative for host identity but allow tenants to
manage user identities within their private networks.<a class="pilcrow" href="#section-1-6.2">¶</a>
</li>
      </ul>
<p id="section-1-7">
In view of the challenges with the currently available mechanisms for
authenticating and protecting the confidentiality of RPC transactions, this
document specifies a transport-layer security mechanism that complements the
existing ones.  The TLS <span>[<a class="xref" href="#RFC8446">RFC8446</a>]</span> and Datagram Transport Layer Security (DTLS)
<span>[<a class="xref" href="#RFC9147">RFC9147</a>]</span>
protocols are well-established Internet building blocks that protect many
standard Internet protocols such as the Hypertext Transfer Protocol (HTTP)
<span>[<a class="xref" href="#RFC9110">RFC9110</a>]</span>.<a class="pilcrow" href="#section-1-7">¶</a></p>
<p id="section-1-8">
Encrypting at the RPC transport layer accords several significant benefits:<a class="pilcrow" href="#section-1-8">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-1-9">
        <dt id="section-1-9.1">Encryption by Default:</dt>
        <dd id="section-1-9.2" style="margin-left: 1.5em">
Transport encryption can be enabled
without additional administrative tasks such as
identifying client systems to a trust authority
and
providing each with keying material.<a class="pilcrow" href="#section-1-9.2">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-1-9.3">Encryption Offload:</dt>
        <dd id="section-1-9.4" style="margin-left: 1.5em">
Hardware support for the GSS privacy service has not appeared in the marketplace.
However, the use of a well-established transport encryption mechanism
that is employed by other ubiquitous network protocols
makes it more likely that encryption offload for RPC
is practicable.<a class="pilcrow" href="#section-1-9.4">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-1-9.5">Securing AUTH_SYS:</dt>
        <dd id="section-1-9.6" style="margin-left: 1.5em">
Most critically, transport encryption can
significantly reduce several security issues
inherent in the current widespread use of AUTH_SYS
(i.e., acceptance of UIDs and GIDs
generated by an unauthenticated client).<a class="pilcrow" href="#section-1-9.6">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-1-9.7">Decoupled User and Host Identities:</dt>
        <dd id="section-1-9.8" style="margin-left: 1.5em">
TLS can be used to authenticate peer hosts
while other security mechanisms can handle user authentication.<a class="pilcrow" href="#section-1-9.8">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-1-9.9">Compatibility:</dt>
        <dd id="section-1-9.10" style="margin-left: 1.5em">
The imposition of encryption at the transport layer
protects any upper-layer protocol that employs RPC,
without alteration of the upper-layer protocol.<a class="pilcrow" href="#section-1-9.10">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-1-10">
Further,
<a class="xref" href="#section_2AE49383-E6B2-4830-8407-995FEBF727F2">Section 6</a>
of the current document defines policies in line with
<span>[<a class="xref" href="#RFC7435">RFC7435</a>]</span>
that enable RPC-with-TLS to be deployed opportunistically in environments that
contain RPC implementations that do not support TLS.  However, specifications
for RPC-based upper-layer protocols should choose to require even stricter
policies that guarantee encryption and host authentication are used for all RPC
transactions to mitigate against pervasive monitoring attacks <span>[<a class="xref" href="#RFC7258">RFC7258</a>]</span>.  Enforcing the use of
RPC-with-TLS is of particular importance for existing upper-layer protocols
whose security infrastructure is weak.<a class="pilcrow" href="#section-1-10">¶</a></p>
<p id="section-1-11">
The protocol specification in the current document assumes that support for
ONC RPC <span>[<a class="xref" href="#RFC5531">RFC5531</a>]</span>, TLS
<span>[<a class="xref" href="#RFC8446">RFC8446</a>]</span>, PKIX <span>[<a class="xref" href="#RFC5280">RFC5280</a>]</span>, DNSSEC/DNS-Based
Authentication of Named Entities (DANE) <span>[<a class="xref" href="#RFC6698">RFC6698</a>]</span>, and optionally RPCSEC_GSS
<span>[<a class="xref" href="#RFC2203">RFC2203</a>]</span>
is available within the platform
where RPC-with-TLS support is to be added.<a class="pilcrow" href="#section-1-11">¶</a></p>
</section>
</div>
<div id="section_024237C9-5504-49B4-A2D3-2D2A5EFBB967">
<section id="section-2">
      <h2 id="name-requirements-language">
<a class="section-number selfRef" href="#section-2">2. </a><a class="section-name selfRef" href="#name-requirements-language">Requirements Language</a>
      </h2>
<p id="section-2-1">
The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>",
"<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>",
"<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>",
"<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be
interpreted as described in BCP 14
<span>[<a class="xref" href="#RFC2119">RFC2119</a>]</span>
        <span>[<a class="xref" href="#RFC8174">RFC8174</a>]</span>
when, and only when, they appear in all capitals, as shown here.<a class="pilcrow" href="#section-2-1">¶</a></p>
</section>
</div>
<div id="section_0EB1100E-DAA8-4B2C-98AE-94258CFDCB1B">
<section id="section-3">
      <h2 id="name-terminology">
<a class="section-number selfRef" href="#section-3">3. </a><a class="section-name selfRef" href="#name-terminology">Terminology</a>
      </h2>
<p id="section-3-1">
This document adopts the terminology introduced in
<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc6973#section-3">Section 3</a> of [<a class="xref" href="#RFC6973">RFC6973</a>]</span>
and assumes a working knowledge of
the RPC version 2 protocol
<span>[<a class="xref" href="#RFC5531">RFC5531</a>]</span>
and
the TLS version 1.3 protocol
<span>[<a class="xref" href="#RFC8446">RFC8446</a>]</span>.<a class="pilcrow" href="#section-3-1">¶</a></p>
<p id="section-3-2">
Note also that the NFS community long ago adopted the
use of the term "privacy" from documents such as
<span>[<a class="xref" href="#RFC2203">RFC2203</a>]</span>.
In the current document, the authors use the term
"privacy" only when referring specifically
to the historic GSS privacy service defined in
<span>[<a class="xref" href="#RFC2203">RFC2203</a>]</span>.
Otherwise, the authors use the term "confidentiality",
following the practices of contemporary security communities.<a class="pilcrow" href="#section-3-2">¶</a></p>
<p id="section-3-3">
We adhere to the convention that a "client"
is a network host that actively initiates an association,
and
a "server" is a network host that passively accepts an association request.<a class="pilcrow" href="#section-3-3">¶</a></p>
<p id="section-3-4">
RPC documentation historically refers to
the authentication of a connecting host as "machine authentication"
or "host authentication".
TLS documentation refers to the same as "peer authentication".
In the current document, there is little distinction between these terms.<a class="pilcrow" href="#section-3-4">¶</a></p>
<p id="section-3-5">
The term "user authentication" in the current document refers specifically to
the RPC caller's credential, provided in the "cred" and "verf" fields in each
RPC Call.<a class="pilcrow" href="#section-3-5">¶</a></p>
</section>
</div>
<div id="section_EC3FEED5-1DE0-454B-9AB3-CE47BA901583">
<section id="section-4">
      <h2 id="name-rpc-with-tls-in-operation">
<a class="section-number selfRef" href="#section-4">4. </a><a class="section-name selfRef" href="#name-rpc-with-tls-in-operation">RPC-with-TLS in Operation</a>
      </h2>
<div id="section_0A03673B-14BA-4228-8A8A-F76AA318CA73">
<section id="section-4.1">
        <h3 id="name-discovering-server-side-tls">
<a class="section-number selfRef" href="#section-4.1">4.1. </a><a class="section-name selfRef" href="#name-discovering-server-side-tls">Discovering Server-Side TLS Support</a>
        </h3>
<p id="section-4.1-1">
The mechanism described in the current document
interoperates fully with RPC implementations
that do not support RPC-with-TLS.
When an RPC-with-TLS-enabled peer encounters a peer that
does not support RPC-with-TLS,
policy settings on the RPC-with-TLS-enabled peer determine
whether RPC operation continues without the use of TLS
or is discontinued altogether.<a class="pilcrow" href="#section-4.1-1">¶</a></p>
<p id="section-4.1-2">
To achieve this interoperability,
we introduce a new RPC authentication flavor called AUTH_TLS.
The AUTH_TLS authentication flavor signals that the client wants
to initiate TLS negotiation if the server supports it.
Except for the modifications described in this section,
the RPC protocol is unaware of security encapsulation
at the transport layer.
The value of AUTH_TLS is defined in
<a class="xref" href="#section_2CD51855-CE40-4B8D-A220-F211C477964F">Section 7.1</a>.<a class="pilcrow" href="#section-4.1-2">¶</a></p>
<p id="section-4.1-3">
An RPC client begins its communication with an RPC server
by selecting a transport and destination port.
The choice of transport and port is
typically based on the RPC program that is to be used.
The RPC client might query the RPC server's RPCBIND service
to make this selection
(The RPCBIND service is described in
<span>[<a class="xref" href="#RFC1833">RFC1833</a>]</span>).
The mechanism described in the current document
does not support RPC transports other than TCP and UDP.
In all cases, an RPC server <span class="bcp14">MUST</span> listen on the same ports
for (D)TLS-protected RPC programs
as the ports used when (D)TLS is not available.<a class="pilcrow" href="#section-4.1-3">¶</a></p>
<p id="section-4.1-4">
To protect RPC traffic to a TCP port,
the RPC client opens a TCP connection to that port
and sends a NULL RPC procedure
with an auth_flavor of AUTH_TLS on that connection.
To protect RPC traffic to a UDP port,
the RPC client sends a UDP datagram to that port
containing a NULL RPC procedure with an auth_flavor of AUTH_TLS.
The client constructs this RPC procedure as follows:<a class="pilcrow" href="#section-4.1-4">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-5.1">
The length of the opaque data constituting the credential
sent in the RPC Call message <span class="bcp14">MUST</span> be zero.<a class="pilcrow" href="#section-4.1-5.1">¶</a>
</li>
          <li class="normal" id="section-4.1-5.2">
The verifier accompanying the credential <span class="bcp14">MUST</span> be an AUTH_NONE
verifier of length zero.<a class="pilcrow" href="#section-4.1-5.2">¶</a>
</li>
          <li class="normal" id="section-4.1-5.3">
The flavor value of the verifier in the RPC Reply message
received from the server <span class="bcp14">MUST</span> be AUTH_NONE.<a class="pilcrow" href="#section-4.1-5.3">¶</a>
</li>
          <li class="normal" id="section-4.1-5.4">
The length of the verifier's body field is eight.<a class="pilcrow" href="#section-4.1-5.4">¶</a>
</li>
          <li class="normal" id="section-4.1-5.5">
The bytes of the verifier's body field encode the ASCII characters
"STARTTLS" as a fixed-length opaque.<a class="pilcrow" href="#section-4.1-5.5">¶</a>
</li>
        </ul>
<p id="section-4.1-6">
The RPC server signals its corresponding support for RPC-with-TLS
by replying with
a reply_stat of MSG_ACCEPTED
and
an AUTH_NONE verifier containing the "STARTTLS" token.
The client <span class="bcp14">SHOULD</span> proceed with TLS session establishment,
even if the Reply's accept_stat is not SUCCESS.
If the AUTH_TLS probe was done via TCP,
the RPC client <span class="bcp14">MUST</span> send the "ClientHello" message
on the same connection.
If the AUTH_TLS probe was done via UDP,
the RPC client <span class="bcp14">MUST</span> send the "ClientHello" message
to the same UDP destination port.<a class="pilcrow" href="#section-4.1-6">¶</a></p>
<p id="section-4.1-7">
Conversely,
if the Reply's reply_stat is not MSG_ACCEPTED,
if its verifier flavor is not AUTH_NONE,
or if its verifier does not contain the "STARTTLS" token,
the RPC client <span class="bcp14">MUST NOT</span> send a "ClientHello" message.
RPC operation may continue,
depending on local policy, but without
confidentiality,
integrity,
or
peer authentication protection
from (D)TLS.<a class="pilcrow" href="#section-4.1-7">¶</a></p>
<p id="section-4.1-8">
If, after a successful RPC AUTH_TLS probe,
the subsequent (D)TLS handshake should fail for any reason,
the RPC client reports this failure
to the upper-layer application
the same way it reports an AUTH_ERROR rejection
from the RPC server.<a class="pilcrow" href="#section-4.1-8">¶</a></p>
<p id="section-4.1-9">
If an RPC client uses the AUTH_TLS authentication flavor
on any procedure other than the NULL procedure,
or an RPC client sends an RPC AUTH_TLS probe within
an existing (D)TLS session,
the RPC server <span class="bcp14">MUST</span> reject that RPC Call
by returning a reply_stat of MSG_DENIED
with a reject_stat of AUTH_ERROR
and an auth_stat of AUTH_BADCRED.<a class="pilcrow" href="#section-4.1-9">¶</a></p>
<p id="section-4.1-10">
Once the TLS session handshake is complete,
the RPC client and server have established
a secure channel for exchanging RPC transactions.
A successful AUTH_TLS probe on one particular port/transport tuple
does not imply that RPC-with-TLS is available on that same server
using a different port/transport tuple,
nor does it imply that
RPC-with-TLS will be available in the future
using the successfully probed port.<a class="pilcrow" href="#section-4.1-10">¶</a></p>
</section>
</div>
<div id="section_6EDEF553-C95A-47D7-ABBA-0B537FE3A959">
<section id="section-4.2">
        <h3 id="name-authentication">
<a class="section-number selfRef" href="#section-4.2">4.2. </a><a class="section-name selfRef" href="#name-authentication">Authentication</a>
        </h3>
<p id="section-4.2-1">
There is some overlap between the authentication
capabilities of RPC and TLS.
The goal of interoperability with implementations
that do not support TLS requires
limiting the combinations that are allowed
and
precisely specifying the role that each layer plays.<a class="pilcrow" href="#section-4.2-1">¶</a></p>
<p id="section-4.2-2">
Each RPC server that supports RPC-with-TLS <span class="bcp14">MUST</span> possess a unique global identity
(e.g., a certificate that is signed by a well-known trust anchor).
Such an RPC server <span class="bcp14">MUST</span> request a TLS peer identity from each client
upon first contact.
There are two different modes of client deployment:<a class="pilcrow" href="#section-4.2-2">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4.2-3">
          <dt id="section-4.2-3.1">Server-Only Host Authentication</dt>
          <dd id="section-4.2-3.2" style="margin-left: 1.5em">
In this type of deployment,
the client can authenticate the server host
using the presented server peer TLS identity,
but the server cannot authenticate the client.
In this situation,
RPC-with-TLS clients are anonymous.
They present no globally unique identifier to the server peer.<a class="pilcrow" href="#section-4.2-3.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-3.3">Mutual Host Authentication</dt>
          <dd id="section-4.2-3.4" style="margin-left: 1.5em">
In this type of deployment, the client possesses an identity that is backed by
a trusted entity (e.g., a pre-shared key or a certificate validated with a
certification path).  As part of the TLS handshake, both peers authenticate
using the presented TLS identities.  If authentication of either peer fails,
or if authorization based on those identities blocks access to the server, the
peers <span class="bcp14">MUST</span> reject the association. Further explanation appears in <a class="xref" href="#section_936921ED-67BB-46BF-B316-6740E07F6652">Section 5.2</a>.<a class="pilcrow" href="#section-4.2-3.4">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.2-4">
In either of these modes, RPC user authentication is not affected by the use
of transport layer security.  When a client presents a TLS peer identity to an
RPC server, the protocol extension described in the current document provides
no way for the server to know whether that identity represents one RPC user on
that client or is shared amongst many RPC users.  Therefore, a server
implementation cannot utilize the remote TLS peer identity to authenticate RPC
users.<a class="pilcrow" href="#section-4.2-4">¶</a></p>
<div id="section_12D92596-F310-48C8-A4E0-B6CA038524E5">
<section id="section-4.2.1">
          <h4 id="name-using-tls-with-rpcsec_gss">
<a class="section-number selfRef" href="#section-4.2.1">4.2.1. </a><a class="section-name selfRef" href="#name-using-tls-with-rpcsec_gss">Using TLS with RPCSEC_GSS</a>
          </h4>
<p id="section-4.2.1-1">
To use GSS, an RPC server has to possess a GSS service principal.
On a TLS session, GSS mutual (peer) authentication occurs as usual,
but only after a TLS session has been established for communication.
Authentication of RPCSEC_GSS users is unchanged by the use of TLS.<a class="pilcrow" href="#section-4.2.1-1">¶</a></p>
<p id="section-4.2.1-2">
RPCSEC_GSS can also perform per-request integrity or confidentiality
protection.  When operating over a TLS session, these GSS services become
largely redundant.  An RPC implementation capable of concurrently using TLS
and RPCSEC_GSS <span class="bcp14">MUST</span> use Generic Security Service Application
Program Interface (GSS-API) channel binding, as defined in <span>[<a class="xref" href="#RFC5056">RFC5056</a>]</span>, to determine when an
underlying transport provides a sufficient degree of confidentiality.
RPC-with-TLS implementations <span class="bcp14">MUST</span> provide the "tls-exporter"
channel binding type, as defined in <span>[<a class="xref" href="#RFC9266">RFC9266</a>]</span>.<a class="pilcrow" href="#section-4.2.1-2">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="section_D93526DA-7B9D-419B-BE84-4AD8DA48577E">
<section id="section-5">
      <h2 id="name-tls-requirements">
<a class="section-number selfRef" href="#section-5">5. </a><a class="section-name selfRef" href="#name-tls-requirements">TLS Requirements</a>
      </h2>
<p id="section-5-1">
When peers negotiate a TLS session that is to transport RPC,
the following restrictions apply:<a class="pilcrow" href="#section-5-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-2.1">
Implementations <span class="bcp14">MUST NOT</span> negotiate TLS versions prior to 1.3
(for TLS
<span>[<a class="xref" href="#RFC8446">RFC8446</a>]</span>
or DTLS <span>[<a class="xref" href="#RFC9147">RFC9147</a>]</span>,
respectively).  Support for mandatory-to-implement cipher suites for the
negotiated TLS version is <span class="bcp14">REQUIRED</span>.<a class="pilcrow" href="#section-5-2.1">¶</a>
</li>
        <li class="normal" id="section-5-2.2">
Implementations <span class="bcp14">MUST</span> conform to the recommendations for TLS
usage specified in BCP 195 <span>[<a class="xref" href="#RFC7525">RFC7525</a>]</span>.  
Although RFC 7525 permits the use of TLS 1.2, the
requirement to use TLS 1.3 or later for RPC-with-TLS takes precedence.
Further, because TLS 1.3 ciphers are qualitatively different than cipher
suites in previous versions of TLS, and RFC 7525 predates TLS 1.3, the cipher
suite recommendations in RFC 7525 do not apply to RPC-with-(D)TLS.  A strict
TLS mode for RPC-with-TLS that protects against STRIPTLS attacks is discussed
in detail in <a class="xref" href="#section_8894BDD2-0E0B-47A3-A2CB-70E4D93B55B0">Section 6.1.1</a>.<a class="pilcrow" href="#section-5-2.2">¶</a>
</li>
        <li class="normal" id="section-5-2.3">
Implementations <span class="bcp14">MUST</span> support certificate-based mutual
authentication.  Support for Pre-Shared Key (PSK) mutual authentication is
<span class="bcp14">OPTIONAL</span>; see
<a class="xref" href="#section_6DA9ED5F-BAD9-4126-95B7-E2331655A01E">Section 5.2.2</a>
for further details.<a class="pilcrow" href="#section-5-2.3">¶</a>
</li>
        <li class="normal" id="section-5-2.4">
Negotiation of a cipher suite providing confidentiality as
well as integrity protection is <span class="bcp14">REQUIRED</span>.<a class="pilcrow" href="#section-5-2.4">¶</a>
</li>
      </ul>
<p id="section-5-3">
Client implementations <span class="bcp14">MUST</span> include the
"application_layer_protocol_negotiation(16)" extension
<span>[<a class="xref" href="#RFC7301">RFC7301</a>]</span>
in their "ClientHello" message
and <span class="bcp14">MUST</span> include the protocol identifier
defined in
<a class="xref" href="#section_58905D7A-06B1-4469-964A-DAC607DAC500">Section 7.2</a>
in that message's ProtocolNameList value.<a class="pilcrow" href="#section-5-3">¶</a></p>
<p id="section-5-4">
Similarly, in response to the "ClientHello" message,
server implementations <span class="bcp14">MUST</span> include the
"application_layer_protocol_negotiation(16)" extension
<span>[<a class="xref" href="#RFC7301">RFC7301</a>]</span>
in their "ServerHello" message
and <span class="bcp14">MUST</span> include only the protocol identifier
defined in
<a class="xref" href="#section_58905D7A-06B1-4469-964A-DAC607DAC500">Section 7.2</a>
in that message's ProtocolNameList value.<a class="pilcrow" href="#section-5-4">¶</a></p>
<p id="section-5-5">
If the server responds incorrectly
(for instance, if the "ServerHello" message does not conform to the above requirements),
the client <span class="bcp14">MUST NOT</span> establish a TLS session for use with RPC
on this connection.
See
<span>[<a class="xref" href="#RFC7301">RFC7301</a>]</span>
for further details about how to form these messages properly.<a class="pilcrow" href="#section-5-5">¶</a></p>
<div id="section_CC204592-F561-49BD-B1C9-DE0FF7F0E7AB">
<section id="section-5.1">
        <h3 id="name-base-transport-consideratio">
<a class="section-number selfRef" href="#section-5.1">5.1. </a><a class="section-name selfRef" href="#name-base-transport-consideratio">Base Transport Considerations</a>
        </h3>
<p id="section-5.1-1">
There is frequently a strong association between an RPC program and a
particular destination port number.  The use of TLS or DTLS does not change that
association.  Thus, it is frequently, though not always, the case that a
single TLS session carries traffic for only one RPC program.<a class="pilcrow" href="#section-5.1-1">¶</a></p>
<div id="section_74B43C7E-5ADC-4FBD-B4EA-FF8F470994A8">
<section id="section-5.1.1">
          <h4 id="name-protected-operation-on-tcp">
<a class="section-number selfRef" href="#section-5.1.1">5.1.1. </a><a class="section-name selfRef" href="#name-protected-operation-on-tcp">Protected Operation on TCP</a>
          </h4>
<p id="section-5.1.1-1">
The use of the TLS protocol
<span>[<a class="xref" href="#RFC8446">RFC8446</a>]</span>
protects RPC on TCP connections.
Typically,
once an RPC client completes the TCP handshake,
it uses the mechanism described in
<a class="xref" href="#section_0A03673B-14BA-4228-8A8A-F76AA318CA73">Section 4.1</a>
to discover RPC-with-TLS support for that RPC program on that connection.
Until an AUTH_TLS probe is done on a connection,
the RPC server treats all traffic as RPC messages.
If spurious traffic appears on a TCP connection
between the initial cleartext AUTH_TLS probe
and
the TLS session handshake,
receivers <span class="bcp14">MUST</span> discard that data without response
and then <span class="bcp14">SHOULD</span> drop the connection.<a class="pilcrow" href="#section-5.1.1-1">¶</a></p>
<p id="section-5.1.1-2">
The protocol convention specified in the current document
assumes there can be no more than one concurrent TLS session
per TCP connection.
This is true of current generations of TLS,
but might be different in a future version of TLS.<a class="pilcrow" href="#section-5.1.1-2">¶</a></p>
<p id="section-5.1.1-3">
Once a TLS session is established on a TCP connection,
no further cleartext communication can occur on that connection
until the session is terminated.
The use of TLS does not alter RPC record framing used on TCP transports.<a class="pilcrow" href="#section-5.1.1-3">¶</a></p>
<p id="section-5.1.1-4">
Furthermore,
if an RPC server responds with PROG_UNAVAIL
to an RPC Call within an established TLS session,
that does not imply that RPC server will subsequently
reject the same RPC program on a different TCP connection.<a class="pilcrow" href="#section-5.1.1-4">¶</a></p>
<p id="section-5.1.1-5">
Reverse-direction operation occurs only on connected transports such as TCP
(see <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8167#section-2">Section 2</a> of [<a class="xref" href="#RFC8167">RFC8167</a>]</span>).  To protect reverse-direction RPC operations, the RPC
server does not establish a separate TLS session on the TCP connection but
instead uses the existing TLS session on that connection to protect these
operations.<a class="pilcrow" href="#section-5.1.1-5">¶</a></p>
<p id="section-5.1.1-6">
When operation is complete,
an RPC peer terminates a TLS session by sending a TLS closure alert.
It may then close the TCP connection.<a class="pilcrow" href="#section-5.1.1-6">¶</a></p>
</section>
</div>
<div id="section_B8BF600E-96DC-4C82-AADF-D593826E9B75">
<section id="section-5.1.2">
          <h4 id="name-protected-operation-on-udp">
<a class="section-number selfRef" href="#section-5.1.2">5.1.2. </a><a class="section-name selfRef" href="#name-protected-operation-on-udp">Protected Operation on UDP</a>
          </h4>
<p id="section-5.1.2-1">
The use of the DTLS protocol
<span>[<a class="xref" href="#RFC9147">RFC9147</a>]</span>
protects RPC carried in UDP datagrams.
As soon as a client initializes a UDP socket
for use with an RPC service,
it uses the mechanism described in
<a class="xref" href="#section_0A03673B-14BA-4228-8A8A-F76AA318CA73">Section 4.1</a>
to discover RPC-with-DTLS support for that RPC program on that port.
If spurious traffic appears on a 5-tuple between
the initial cleartext AUTH_TLS probe
and
the DTLS association handshake,
receivers
<span class="bcp14">MUST</span>
discard that traffic without response.<a class="pilcrow" href="#section-5.1.2-1">¶</a></p>
<p id="section-5.1.2-2">
Using DTLS does not introduce
reliable
or
in-order
semantics to RPC on UDP.
The use of DTLS record replay protection is <span class="bcp14">REQUIRED</span>
when transporting RPC traffic.<a class="pilcrow" href="#section-5.1.2-2">¶</a></p>
<p id="section-5.1.2-3">
Each RPC message <span class="bcp14">MUST</span> fit in a single DTLS record.
DTLS encapsulation has overhead,
which reduces the Packetization Layer Path MTU (PLPMTU)
and thus the maximum RPC payload size.
A possible PLPMTU discovery mechanism is offered in
<span>[<a class="xref" href="#RFC8899">RFC8899</a>]</span>.<a class="pilcrow" href="#section-5.1.2-3">¶</a></p>
<p id="section-5.1.2-4">
The current document does not specify a mechanism
that enables a server to distinguish between
DTLS traffic
and
unprotected RPC traffic
directed to the same port.
To make this distinction,
each peer matches ingress datagrams
that appear to be DTLS traffic to existing DTLS session state.
A peer treats any datagram that fails the matching process as an RPC message.<a class="pilcrow" href="#section-5.1.2-4">¶</a></p>
<p id="section-5.1.2-5">
Multihomed RPC clients and servers may send protected RPC messages
via network interfaces that were not involved in the handshake that
established the DTLS session.
Therefore, when protecting RPC traffic,
each DTLS handshake <span class="bcp14">MUST</span> include the "connection_id(54)" extension
described in
<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9147#section-9">Section 9</a> of [<a class="xref" href="#RFC9147">RFC9147</a>]</span>,
and RPC-with-DTLS peer endpoints
<span class="bcp14">MUST</span>
provide a ConnectionID
with a nonzero length.
Endpoints implementing RPC programs
that expect a significant number of concurrent clients
<span class="bcp14">SHOULD</span>
employ ConnectionIDs of at least 4 bytes in length.<a class="pilcrow" href="#section-5.1.2-5">¶</a></p>
<p id="section-5.1.2-6">
Sending a TLS closure alert terminates a DTLS session.  Because neither DTLS
nor UDP provide in-order delivery, after session closure there can be
ambiguity as to whether a datagram should be interpreted as DTLS protected or
not.  Therefore, receivers <span class="bcp14">MUST</span> discard datagrams exchanged
using the same 5-tuple that just terminated the DTLS session for a sufficient
length of time to ensure that retransmissions have ceased and packets already
in the network have been delivered.  In the absence of more specific data, a
period of 60 seconds is expected to suffice.<a class="pilcrow" href="#section-5.1.2-6">¶</a></p>
</section>
</div>
<div id="section_BFCC24B1-E6D4-4ABC-A5F3-B71E8E96878F">
<section id="section-5.1.3">
          <h4 id="name-protected-operation-on-othe">
<a class="section-number selfRef" href="#section-5.1.3">5.1.3. </a><a class="section-name selfRef" href="#name-protected-operation-on-othe">Protected Operation on Other Transports</a>
          </h4>
<p id="section-5.1.3-1">
Transports that provide intrinsic TLS-level security
(e.g., QUIC)
need to be addressed separately from the current document.
In such cases, the use of TLS is not opportunistic
as it can be for TCP or UDP.<a class="pilcrow" href="#section-5.1.3-1">¶</a></p>
<p id="section-5.1.3-2">

RPC-over-RDMA can make use of transport layer security
below the RDMA transport layer
<span>[<a class="xref" href="#RFC8166">RFC8166</a>]</span>.
The exact mechanism is not within the scope of the current document.
Because there might not be other provisions
to exchange client and server certificates,
authentication material exchange
needs to be provided by facilities
within a future version
of the RPC-over-RDMA transport protocol.<a class="pilcrow" href="#section-5.1.3-2">¶</a></p>
</section>
</div>
</section>
</div>
<div id="section_936921ED-67BB-46BF-B316-6740E07F6652">
<section id="section-5.2">
        <h3 id="name-tls-peer-authentication">
<a class="section-number selfRef" href="#section-5.2">5.2. </a><a class="section-name selfRef" href="#name-tls-peer-authentication">TLS Peer Authentication</a>
        </h3>
<p id="section-5.2-1">
TLS can perform peer authentication
using any of the following mechanisms.<a class="pilcrow" href="#section-5.2-1">¶</a></p>
<div id="section_7A68F518-2C02-4705-8218-4F13E51372F4">
<section id="section-5.2.1">
          <h4 id="name-x509-certificates-using-pki">
<a class="section-number selfRef" href="#section-5.2.1">5.2.1. </a><a class="section-name selfRef" href="#name-x509-certificates-using-pki">X.509 Certificates Using PKIX Trust</a>
          </h4>
<p id="section-5.2.1-1">
X.509 certificates are specified in
<span>[<a class="xref" href="#X.509">X.509</a>]</span>.
<span>[<a class="xref" href="#RFC5280">RFC5280</a>]</span>
provides a profile of Internet PKI X.509 public key infrastructure.
RPC-with-TLS implementations are
<span class="bcp14">REQUIRED</span>
to support the PKIX mechanism described in
<span>[<a class="xref" href="#RFC5280">RFC5280</a>]</span>.<a class="pilcrow" href="#section-5.2.1-1">¶</a></p>
<p id="section-5.2.1-2">
The rules and guidelines defined in
<span>[<a class="xref" href="#RFC6125">RFC6125</a>]</span>
apply to RPC-with-TLS certificates
with the following considerations:<a class="pilcrow" href="#section-5.2.1-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.1-3.1">
The DNS-ID identifier type is a subjectAltName extension that contains a
dNSName, as defined in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc5280#section-4.2.1.6">Section 4.2.1.6</a> of [<a class="xref" href="#RFC5280">RFC5280</a>]</span>. Support for the DNS-ID identifier type
is <span class="bcp14">REQUIRED</span> in RPC-with-TLS client and server implementations.
Certification authorities that issue such certificates <span class="bcp14">MUST</span>
support the DNS-ID identifier type.<a class="pilcrow" href="#section-5.2.1-3.1">¶</a>
</li>
            <li class="normal" id="section-5.2.1-3.2">
To specify the identity of an RPC peer as a domain name, the certificate
<span class="bcp14">MUST</span> contain a subjectAltName extension that contains a
dNSName. DNS domain names in RPC-with-TLS certificates <span class="bcp14">MUST NOT</span>
contain the wildcard character '*' within the identifier.<a class="pilcrow" href="#section-5.2.1-3.2">¶</a>
</li>
            <li class="normal" id="section-5.2.1-3.3">
To specify the identity of an RPC peer as a network identifier (netid) or a universal network address (uaddr), the certificate <span class="bcp14">MUST</span> contain a subjectAltName extension that contains an iPAddress.<a class="pilcrow" href="#section-5.2.1-3.3">¶</a>
</li>
          </ul>
<p id="section-5.2.1-4">
When validating a server certificate,
an RPC-with-TLS client implementation
takes the following into account:<a class="pilcrow" href="#section-5.2.1-4">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.1-5.1">
Certificate validation
<span class="bcp14">MUST</span>
include the verification rules as per
<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc5280#section-6">Section 6</a> of [<a class="xref" href="#RFC5280">RFC5280</a>]</span>
and
<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc6125#section-6">Section 6</a> of [<a class="xref" href="#RFC6125">RFC6125</a>]</span>.<a class="pilcrow" href="#section-5.2.1-5.1">¶</a>
</li>
            <li class="normal" id="section-5.2.1-5.2">
Server certificate validation
<span class="bcp14">MUST</span>
include a check on whether
the locally configured expected
DNS-ID
or
iPAddress subjectAltName
of the server that is contacted
matches its presented certificate.<a class="pilcrow" href="#section-5.2.1-5.2">¶</a>
</li>
            <li class="normal" id="section-5.2.1-5.3">
For RPC services accessed by their
netids
and
uaddrs,
the iPAddress subjectAltName
<span class="bcp14">MUST</span>
be present in the certificate
and
<span class="bcp14">MUST</span>
exactly match the address represented by the universal network address.<a class="pilcrow" href="#section-5.2.1-5.3">¶</a>
</li>
          </ul>
<p id="section-5.2.1-6">
An RPC client's domain name and IP address are often assigned dynamically;
thus, RPC servers cannot rely on those to verify client certificates.
Therefore, when an RPC-with-TLS client presents a certificate to an
RPC-with-TLS server, the server takes the following into account:<a class="pilcrow" href="#section-5.2.1-6">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.1-7.1">
The server <span class="bcp14">MUST</span> use a procedure conformant to <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc5280#section-6">Section 6</a> of [<a class="xref" href="#RFC5280">RFC5280</a>]</span> to
validate the client certificate's certification path.<a class="pilcrow" href="#section-5.2.1-7.1">¶</a>
</li>
            <li class="normal" id="section-5.2.1-7.2">
The tuple (serial number of the presented certificate; Issuer) uniquely
identifies the RPC client.  The meaning and syntax of these fields is defined
in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc5280#section-4">Section 4</a> of [<a class="xref" href="#RFC5280">RFC5280</a>]</span>.<a class="pilcrow" href="#section-5.2.1-7.2">¶</a>
</li>
          </ul>
<p id="section-5.2.1-8">
RPC-with-TLS implementations
<span class="bcp14">MAY</span>
allow the configuration
of a set of additional properties of the certificate
to check for a peer's authorization to communicate
(e.g.,
a set of allowed values in subjectAltName:URI,
a set of allowed X.509v3 Certificate Policies,
or
a set of extended key usages).<a class="pilcrow" href="#section-5.2.1-8">¶</a></p>
<p id="section-5.2.1-9">
When the configured set of trust anchors changes (e.g., removal of a
Certification Authority (CA) from the list of trusted CAs; issuance of a new Certificate Revocation List (CRL)
for a given CA), implementations <span class="bcp14">SHOULD</span> reevaluate the
certificate originally presented in the context of the new configuration and
terminate the TLS session if the certificate is no longer trustworthy.<a class="pilcrow" href="#section-5.2.1-9">¶</a></p>
<div id="section_685D3F88-94FF-4C91-8CCB-860DBA602B2F">
<section id="section-5.2.1.1">
            <h5 id="name-extended-key-usage-values">
<a class="section-number selfRef" href="#section-5.2.1.1">5.2.1.1. </a><a class="section-name selfRef" href="#name-extended-key-usage-values">Extended Key Usage Values</a>
            </h5>
<p id="section-5.2.1.1-1">
<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc5280#section-4.2.1.12">Section 4.2.1.12</a> of [<a class="xref" href="#RFC5280">RFC5280</a>]</span>
specifies the extended key usage X.509 certificate extension.
This extension, which may appear in end-entity certificates,
indicates one or more purposes for which the certified public key may be used
in addition to or in place of the basic purposes indicated in the key usage extension.<a class="pilcrow" href="#section-5.2.1.1-1">¶</a></p>
<p id="section-5.2.1.1-2">
The current document defines two new KeyPurposeId values:
one that identifies the RPC-with-TLS peer as an RPC client,
and
one that identifies the RPC-with-TLS peer as an RPC server.<a class="pilcrow" href="#section-5.2.1.1-2">¶</a></p>
<p id="section-5.2.1.1-3">
The inclusion of the RPC server value (id-kp-rpcTLSServer)
indicates that the certificate has been issued
for allowing the holder to process RPC transactions.<a class="pilcrow" href="#section-5.2.1.1-3">¶</a></p>
<p id="section-5.2.1.1-4">
The inclusion of the RPC client value (id-kp-rpcTLSClient)
indicates that the certificate has been issued
for allowing the holder to request RPC transactions.<a class="pilcrow" href="#section-5.2.1.1-4">¶</a></p>
</section>
</div>
</section>
</div>
<div id="section_6DA9ED5F-BAD9-4126-95B7-E2331655A01E">
<section id="section-5.2.2">
          <h4 id="name-pre-shared-keys">
<a class="section-number selfRef" href="#section-5.2.2">5.2.2. </a><a class="section-name selfRef" href="#name-pre-shared-keys">Pre-shared Keys</a>
          </h4>
<p id="section-5.2.2-1">
This mechanism is <span class="bcp14">OPTIONAL</span> to implement.  In this mode, the RPC
peer can be uniquely identified by keying material that has been shared
out of band (see <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8446#section-2.2">Section 2.2</a> of [<a class="xref" href="#RFC8446">RFC8446</a>]</span>). The PSK Identifier <span class="bcp14">SHOULD</span> be exposed at the RPC layer.<a class="pilcrow" href="#section-5.2.2-1">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="section_2AE49383-E6B2-4830-8407-995FEBF727F2">
<section id="section-6">
      <h2 id="name-security-considerations">
<a class="section-number selfRef" href="#section-6">6. </a><a class="section-name selfRef" href="#name-security-considerations">Security Considerations</a>
      </h2>
<p id="section-6-1">
One purpose of the mechanism described in the current document
is to protect RPC-based applications against threats
to the confidentiality of RPC transactions
and
RPC user identities.
A taxonomy of these threats appears in
<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc6973#section-5">Section 5</a> of [<a class="xref" href="#RFC6973">RFC6973</a>]</span>.
Also,
<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc7525#section-6">Section 6</a> of [<a class="xref" href="#RFC7525">RFC7525</a>]</span>
contains a detailed discussion
of technologies used in conjunction with TLS.
<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc5280#section-8">Section 8</a> of [<a class="xref" href="#RFC5280">RFC5280</a>]</span>
covers important considerations about handling certificate material securely.
Implementers should familiarize themselves with these materials.<a class="pilcrow" href="#section-6-1">¶</a></p>
<p id="section-6-2">
Once a TLS session is established,
the RPC payload carried on TLS version 1.3 is forward secure.
However, implementers need to be aware that replay attacks
can occur during session establishment.
Remedies for such attacks are discussed in detail in
<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8446#section-8">Section 8</a> of [<a class="xref" href="#RFC8446">RFC8446</a>]</span>.
Further, the current document does not
provide a profile that defines the use of 0-RTT data
(see
<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8446#appendix-E.5">Appendix E.5</a> of [<a class="xref" href="#RFC8446">RFC8446</a>]</span>).
Therefore, RPC-with-TLS implementations <span class="bcp14">MUST NOT</span>
use 0-RTT data.<a class="pilcrow" href="#section-6-2">¶</a></p>
<div id="section_51737BB5-2B65-441E-AD1D-7EBF5123C079">
<section id="section-6.1">
        <h3 id="name-the-limitations-of-opportun">
<a class="section-number selfRef" href="#section-6.1">6.1. </a><a class="section-name selfRef" href="#name-the-limitations-of-opportun">The Limitations of Opportunistic Security</a>
        </h3>
<p id="section-6.1-1">
Readers can find the definition of Opportunistic Security in
<span>[<a class="xref" href="#RFC7435">RFC7435</a>]</span>.
A discussion of its underlying principles
appears in Section <a class="relref" href="https://www.rfc-editor.org/rfc/rfc7435#section-3">3</a> of that document.<a class="pilcrow" href="#section-6.1-1">¶</a></p>
<p id="section-6.1-2">
The purpose of using an explicitly opportunistic approach
is to enable interoperation
with implementations that do not support RPC-with-TLS.
A range of options is allowed by this approach,
from "no peer authentication or encryption"
to
"server-only authentication with encryption"
to
"mutual authentication with encryption".
The actual security level may indeed
be selected based on policy and without user intervention.<a class="pilcrow" href="#section-6.1-2">¶</a></p>
<p id="section-6.1-3">
In environments where interoperability is a priority,
the security benefits of TLS are partially or entirely waived.
Implementations of the mechanism described in the current document
must take care to accurately represent to all RPC consumers
the level of security that is actually in effect,
and are <span class="bcp14">REQUIRED</span> to provide an audit log
of RPC-with-TLS security mode selection.<a class="pilcrow" href="#section-6.1-3">¶</a></p>
<p id="section-6.1-4">
In all other cases,
the adoption, implementation, and deployment of
RPC-based upper-layer protocols that enforce the use of
TLS authentication and encryption
(when similar RPCSEC_GSS services are not in use)
is strongly encouraged.<a class="pilcrow" href="#section-6.1-4">¶</a></p>
<div id="section_8894BDD2-0E0B-47A3-A2CB-70E4D93B55B0">
<section id="section-6.1.1">
          <h4 id="name-striptls-attacks">
<a class="section-number selfRef" href="#section-6.1.1">6.1.1. </a><a class="section-name selfRef" href="#name-striptls-attacks">STRIPTLS Attacks</a>
          </h4>
<p id="section-6.1.1-1">
The initial AUTH_TLS probe occurs in cleartext.
An on-path attacker can alter a cleartext handshake to make it
appear as though TLS support is not available on one or both peers.

Client implementers can choose from the following to mitigate
STRIPTLS attacks:<a class="pilcrow" href="#section-6.1.1-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1.1-2.1">
A TLSA record
<span>[<a class="xref" href="#RFC6698">RFC6698</a>]</span>
can alert clients that TLS is expected to work, and provide a binding of
a hostname to the X.509 identity.  If TLS cannot be negotiated or authentication
fails, the client disconnects and reports the problem.  When an opportunistic
security policy is in place, a client <span class="bcp14">SHOULD</span> check for the
existence of a TLSA record for the target server before initiating an
RPC-with-TLS association.<a class="pilcrow" href="#section-6.1.1-2.1">¶</a>
</li>
            <li class="normal" id="section-6.1.1-2.2">
Client security policy can require
that a TLS session is established on every connection.
If an attacker spoofs the handshake,
the client disconnects and reports the problem.

This policy prevents an attacker from causing the association to
fall back to cleartext silently.

If TLSA records are not available, this approach is strongly encouraged.<a class="pilcrow" href="#section-6.1.1-2.2">¶</a>
</li>
          </ul>
</section>
</div>
<div id="section_9C03417D-1D3D-4D43-BC43-6F7387736AF7">
<section id="section-6.1.2">
          <h4 id="name-privacy-leakage-before-sess">
<a class="section-number selfRef" href="#section-6.1.2">6.1.2. </a><a class="section-name selfRef" href="#name-privacy-leakage-before-sess">Privacy Leakage before Session Establishment</a>
          </h4>
<p id="section-6.1.2-1">
As mentioned earlier,
communication between an RPC client and server
appears in the clear on the network
prior to the establishment of a TLS session.
This cleartext information usually includes
transport connection handshake exchanges,
the RPC NULL procedure probing support for TLS,
and the initial parts of TLS session establishment.
<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8446#appendix-C">Appendix C</a> of [<a class="xref" href="#RFC8446">RFC8446</a>]</span>
discusses precautions that can mitigate exposure during the exchange of
connection handshake information and TLS certificate material that might
enable attackers to track the RPC client.  Note that when PSK authentication
is used, the PSK identifier is exposed during the TLS handshake and can be
used to track the RPC client.<a class="pilcrow" href="#section-6.1.2-1">¶</a></p>
<p id="section-6.1.2-2">
Any RPC traffic that appears on the network before
a TLS session has been established is vulnerable to
monitoring or undetected modification.
A secure client implementation limits or prevents
any RPC exchanges that are not protected.<a class="pilcrow" href="#section-6.1.2-2">¶</a></p>
<p id="section-6.1.2-3">
The exception to this edict is
the initial RPC NULL procedure that acts as a STARTTLS message,
which cannot be protected.
This RPC NULL procedure contains no arguments or results,
and the AUTH_TLS authentication flavor it uses
does not contain user information,
so there is negligible privacy impact from this exception.<a class="pilcrow" href="#section-6.1.2-3">¶</a></p>
</section>
</div>
</section>
</div>
<div id="section_B9F8A982-CB0E-40FC-9460-680E89DB0001">
<section id="section-6.2">
        <h3 id="name-tls-identity-management-on-">
<a class="section-number selfRef" href="#section-6.2">6.2. </a><a class="section-name selfRef" href="#name-tls-identity-management-on-">TLS Identity Management on Clients</a>
        </h3>
<p id="section-6.2-1">
The goal of RPC-with-TLS is to hide the content of RPC requests while they are
in transit. RPC-with-TLS protocol by itself cannot protect against
exposure of a user's RPC requests to other users on the same client.<a class="pilcrow" href="#section-6.2-1">¶</a></p>
<p id="section-6.2-2">
Moreover, client implementations are free to transmit RPC requests
for more than one RPC user using the same TLS session.
Depending on the details of the client RPC implementation,
this means that the client's TLS credentials
are potentially visible to every RPC user that shares a TLS session.
Privileged users may also be able to access this TLS identity.<a class="pilcrow" href="#section-6.2-2">¶</a></p>
<p id="section-6.2-3">
As a result,
client implementations need to carefully segregate
TLS credentials so that local access to it
is restricted to only the local users that are authorized
to perform operations on the remote RPC server.<a class="pilcrow" href="#section-6.2-3">¶</a></p>
</section>
</div>
<div id="section_552B02A0-F19E-4B46-809C-672A6AE931A1">
<section id="section-6.3">
        <h3 id="name-security-considerations-for">
<a class="section-number selfRef" href="#section-6.3">6.3. </a><a class="section-name selfRef" href="#name-security-considerations-for">Security Considerations for AUTH_SYS on TLS</a>
        </h3>
<p id="section-6.3-1">
Using a TLS-protected transport
when the AUTH_SYS authentication flavor is in use
addresses several longstanding weaknesses in AUTH_SYS
(as detailed in
<a class="xref" href="#section_C7FB9DB5-5F4F-45AD-8BF7-74FFCA08BEBB">Appendix A</a>).
TLS augments AUTH_SYS by providing both
integrity protection and confidentiality
that AUTH_SYS lacks.
TLS protects
data payloads,
RPC headers,
and
user identities
against monitoring and alteration while in transit.<a class="pilcrow" href="#section-6.3-1">¶</a></p>
<p id="section-6.3-2">
TLS guards against in-transit insertion and deletion of RPC messages, thus
ensuring the integrity of the message stream between RPC client and server.
DTLS does not provide full message stream protection, but it does enable
receivers to reject nonparticipant messages.  In particular, transport-layer
encryption plus peer authentication protects receiving eXternal Data
Representation (XDR) decoders from deserializing untrusted data, a common
coding vulnerability.  However, these decoders would still be exposed to
untrusted input in the case of the compromise of a trusted peer or Certification
Authority.<a class="pilcrow" href="#section-6.3-2">¶</a></p>
<p id="section-6.3-3">
The use of TLS enables strong authentication
of the communicating RPC peers,
providing a degree of non-repudiation.
When AUTH_SYS is used with TLS,
but the RPC client is unauthenticated,
the RPC server still acts on RPC requests
for which there is no trustworthy authentication.
In-transit traffic is protected, but the RPC client itself
can still misrepresent user identity without server detection.
TLS without authentication is an improvement
from AUTH_SYS without encryption,
but it leaves a critical security exposure.<a class="pilcrow" href="#section-6.3-3">¶</a></p>
<p id="section-6.3-4">
In light of the above, when AUTH_SYS is used,
the use of a TLS mutual authentication mechanism is
<span class="bcp14">RECOMMENDED</span>
to prove that the RPC client is known to the RPC server.
The server can then determine whether the UIDs and GIDs
in AUTH_SYS requests from that client can be accepted,
based on the authenticated identity of the client.<a class="pilcrow" href="#section-6.3-4">¶</a></p>
<p id="section-6.3-5">
The use of TLS does not enable RPC clients to detect compromise
that leads to the impersonation of RPC users.
Also, there continues to be a requirement
that the mapping of 32-bit user and group ID values
to user identities
is the same on both the RPC client and server.<a class="pilcrow" href="#section-6.3-5">¶</a></p>
</section>
</div>
<div id="section_55D006D3-8CA6-4D7F-AF0D-BFB0FFEF7595">
<section id="section-6.4">
        <h3 id="name-best-security-policy-practi">
<a class="section-number selfRef" href="#section-6.4">6.4. </a><a class="section-name selfRef" href="#name-best-security-policy-practi">Best Security Policy Practices</a>
        </h3>
<p id="section-6.4-1">
RPC-with-TLS implementations and deployments
are strongly encouraged to adhere to the following policies
to achieve the strongest possible security with RPC-with-TLS.<a class="pilcrow" href="#section-6.4-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.4-2.1">
When using AUTH_NULL or AUTH_SYS, both peers are
<span class="bcp14">RECOMMENDED</span>
to have DNSSEC TLSA records,
keys with which to perform mutual peer authentication
using one of the methods described in
<a class="xref" href="#section_936921ED-67BB-46BF-B316-6740E07F6652">Section 5.2</a>,
and
a security policy that requires mutual peer authentication
and
rejection of a connection when host authentication fails.<a class="pilcrow" href="#section-6.4-2.1">¶</a>
</li>
          <li class="normal" id="section-6.4-2.2">
RPCSEC_GSS provides integrity and privacy services that are largely redundant
when TLS is in use.  These services <span class="bcp14">SHOULD</span> be disabled in that
case.<a class="pilcrow" href="#section-6.4-2.2">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="section_7B126473-2A13-453B-9BCA-66BC11B7B018">
<section id="section-7">
      <h2 id="name-iana-considerations">
<a class="section-number selfRef" href="#section-7">7. </a><a class="section-name selfRef" href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<div id="section_2CD51855-CE40-4B8D-A220-F211C477964F">
<section id="section-7.1">
        <h3 id="name-rpc-authentication-flavor">
<a class="section-number selfRef" href="#section-7.1">7.1. </a><a class="section-name selfRef" href="#name-rpc-authentication-flavor">RPC Authentication Flavor</a>
        </h3>
<p id="section-7.1-1">
Following <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc5531#appendix-B">Appendix B</a> of [<a class="xref" href="#RFC5531">RFC5531</a>]</span>, an entry has been added to the "RPC
Authentication Flavor Numbers" registry.  The purpose of the new authentication
flavor is to signal the use of TLS with RPC.  This new flavor is not a
pseudo-flavor.<a class="pilcrow" href="#section-7.1-1">¶</a></p>
<p id="section-7.1-2">
The fields in the new entry have been assigned as follows:<a class="pilcrow" href="#section-7.1-2">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-7.1-3">
          <dt id="section-7.1-3.1">Identifier String:</dt>
          <dd id="section-7.1-3.2" style="margin-left: 1.5em">
AUTH_TLS<a class="pilcrow" href="#section-7.1-3.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-7.1-3.3">Flavor Name:</dt>
          <dd id="section-7.1-3.4" style="margin-left: 1.5em">
TLS<a class="pilcrow" href="#section-7.1-3.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-7.1-3.5">Value:</dt>
          <dd id="section-7.1-3.6" style="margin-left: 1.5em">
7<a class="pilcrow" href="#section-7.1-3.6">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-7.1-3.7">Description:</dt>
          <dd id="section-7.1-3.8" style="margin-left: 1.5em">
Indicates support for RPC-with-TLS<a class="pilcrow" href="#section-7.1-3.8">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-7.1-3.9">Reference:</dt>
          <dd id="section-7.1-3.10" style="margin-left: 1.5em">
RFC 9289<a class="pilcrow" href="#section-7.1-3.10">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="section_58905D7A-06B1-4469-964A-DAC607DAC500">
<section id="section-7.2">
        <h3 id="name-alpn-identifier-for-sunrpc">
<a class="section-number selfRef" href="#section-7.2">7.2. </a><a class="section-name selfRef" href="#name-alpn-identifier-for-sunrpc">ALPN Identifier for SunRPC</a>
        </h3>
<p id="section-7.2-1">
Following
<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc7301#section-6">Section 6</a> of [<a class="xref" href="#RFC7301">RFC7301</a>]</span>,
the following value has been allocated
in the "TLS Application-Layer Protocol Negotiation (ALPN) Protocol IDs" registry.
The "sunrpc" string identifies SunRPC when used over TLS.<a class="pilcrow" href="#section-7.2-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-7.2-2">
          <dt id="section-7.2-2.1">Protocol:</dt>
          <dd id="section-7.2-2.2" style="margin-left: 1.5em">
SunRPC<a class="pilcrow" href="#section-7.2-2.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-7.2-2.3">Identification Sequence:</dt>
          <dd id="section-7.2-2.4" style="margin-left: 1.5em">
0x73 0x75 0x6e 0x72 0x70 0x63 ("sunrpc")<a class="pilcrow" href="#section-7.2-2.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-7.2-2.5">Reference:</dt>
          <dd id="section-7.2-2.6" style="margin-left: 1.5em">
RFC 9289<a class="pilcrow" href="#section-7.2-2.6">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="section_62E5E930-706A-4216-9A32-D7AC5952A507">
<section id="section-7.3">
        <h3 id="name-object-identifier-for-pkix-">
<a class="section-number selfRef" href="#section-7.3">7.3. </a><a class="section-name selfRef" href="#name-object-identifier-for-pkix-">Object Identifier for PKIX Extended Key Usage</a>
        </h3>
<p id="section-7.3-1">
Per the Specification Required policy defined in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8126#section-4.6">Section 4.6</a> of [<a class="xref" href="#RFC8126">RFC8126</a>]</span>, the following new values
have been registered in the "SMI Security for PKIX Extended Key Purpose"
registry (1.3.6.1.5.5.7.3) (see
<a class="xref" href="#section_685D3F88-94FF-4C91-8CCB-860DBA602B2F">Section 5.2.1.1</a>
and
<a class="xref" href="#section_B08B45C1-1E10-4F7A-935B-1198BAF255C0">Appendix B</a>).<a class="pilcrow" href="#section-7.3-1">¶</a></p>
<table class="center" id="table-1">
          <caption><a class="selfRef" href="#table-1">Table 1</a></caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Decimal</th>
              <th class="text-left" colspan="1" rowspan="1">Description</th>
              <th class="text-left" colspan="1" rowspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">33</td>
              <td class="text-left" colspan="1" rowspan="1">id-kp-rpcTLSClient</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9289</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">34</td>
              <td class="text-left" colspan="1" rowspan="1">id-kp-rpcTLSServer</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9289</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
<div id="section_1FB29AC3-A737-4822-B396-D33919905567">
<section id="section-7.4">
        <h3 id="name-object-identifier-for-asn1-">
<a class="section-number selfRef" href="#section-7.4">7.4. </a><a class="section-name selfRef" href="#name-object-identifier-for-asn1-">Object Identifier for ASN.1 Module</a>
        </h3>
<p id="section-7.4-1">
Per the Specification Required policy defined in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8126#section-4.6">Section 4.6</a> of [<a class="xref" href="#RFC8126">RFC8126</a>]</span>, the following new value has been registered in the "SMI Security for PKIX Module Identifier" registry (1.3.6.1.5.5.7.0) (see <a class="xref" href="#section_B08B45C1-1E10-4F7A-935B-1198BAF255C0">Appendix B</a>).<a class="pilcrow" href="#section-7.4-1">¶</a></p>
<table class="center" id="table-2">
          <caption><a class="selfRef" href="#table-2">Table 2</a></caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Decimal</th>
              <th class="text-left" colspan="1" rowspan="1">Description</th>
              <th class="text-left" colspan="1" rowspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">105</td>
              <td class="text-left" colspan="1" rowspan="1">id-mod-rpcWithTLS-2021</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9289</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
</section>
</div>
<section id="section-8">
      <h2 id="name-references">
<a class="section-number selfRef" href="#section-8">8. </a><a class="section-name selfRef" href="#name-references">References</a>
      </h2>
<section id="section-8.1">
        <h3 id="name-normative-references">
<a class="section-number selfRef" href="#section-8.1">8.1. </a><a class="section-name selfRef" href="#name-normative-references">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time class="refDate" datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5056">[RFC5056]</dt>
        <dd>
<span class="refAuthor">Williams, N.</span>, <span class="refTitle">"On the Use of Channel Bindings to Secure Channels"</span>, <span class="seriesInfo">RFC 5056</span>, <span class="seriesInfo">DOI 10.17487/RFC5056</span>, <time class="refDate" datetime="2007-11">November 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5056">https://www.rfc-editor.org/info/rfc5056</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5280">[RFC5280]</dt>
        <dd>
<span class="refAuthor">Cooper, D.</span>, <span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Boeyen, S.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time class="refDate" datetime="2008-05">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5280">https://www.rfc-editor.org/info/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5531">[RFC5531]</dt>
        <dd>
<span class="refAuthor">Thurlow, R.</span>, <span class="refTitle">"RPC: Remote Procedure Call Protocol Specification Version 2"</span>, <span class="seriesInfo">RFC 5531</span>, <span class="seriesInfo">DOI 10.17487/RFC5531</span>, <time class="refDate" datetime="2009-05">May 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5531">https://www.rfc-editor.org/info/rfc5531</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6125">[RFC6125]</dt>
        <dd>
<span class="refAuthor">Saint-Andre, P.</span> and <span class="refAuthor">J. Hodges</span>, <span class="refTitle">"Representation and Verification of Domain-Based Application Service Identity within Internet Public Key Infrastructure Using X.509 (PKIX) Certificates in the Context of Transport Layer Security (TLS)"</span>, <span class="seriesInfo">RFC 6125</span>, <span class="seriesInfo">DOI 10.17487/RFC6125</span>, <time class="refDate" datetime="2011-03">March 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6125">https://www.rfc-editor.org/info/rfc6125</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7301">[RFC7301]</dt>
        <dd>
<span class="refAuthor">Friedl, S.</span>, <span class="refAuthor">Popov, A.</span>, <span class="refAuthor">Langley, A.</span>, and <span class="refAuthor">E. Stephan</span>, <span class="refTitle">"Transport Layer Security (TLS) Application-Layer Protocol Negotiation Extension"</span>, <span class="seriesInfo">RFC 7301</span>, <span class="seriesInfo">DOI 10.17487/RFC7301</span>, <time class="refDate" datetime="2014-07">July 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7301">https://www.rfc-editor.org/info/rfc7301</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7525">[RFC7525]</dt>
        <dd>
<span class="refAuthor">Sheffer, Y.</span>, <span class="refAuthor">Holz, R.</span>, and <span class="refAuthor">P. Saint-Andre</span>, <span class="refTitle">"Recommendations for Secure Use of Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)"</span>, <span class="seriesInfo">BCP 195</span>, <span class="seriesInfo">RFC 7525</span>, <span class="seriesInfo">DOI 10.17487/RFC7525</span>, <time class="refDate" datetime="2015-05">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7525">https://www.rfc-editor.org/info/rfc7525</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time class="refDate" datetime="2017-06">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time class="refDate" datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time class="refDate" datetime="2018-08">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9147">[RFC9147]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refAuthor">Tschofenig, H.</span>, and <span class="refAuthor">N. Modadugu</span>, <span class="refTitle">"The Datagram Transport Layer Security (DTLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 9147</span>, <span class="seriesInfo">DOI 10.17487/RFC9147</span>, <time class="refDate" datetime="2022-04">April 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9147">https://www.rfc-editor.org/info/rfc9147</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9266">[RFC9266]</dt>
        <dd>
<span class="refAuthor">Whited, S.</span>, <span class="refTitle">"Channel Bindings for TLS 1.3"</span>, <span class="seriesInfo">RFC 9266</span>, <span class="seriesInfo">DOI 10.17487/RFC9266</span>, <time class="refDate" datetime="2022-07">July 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9266">https://www.rfc-editor.org/info/rfc9266</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="X.509">[X.509]</dt>
        <dd>
<span class="refAuthor">International Telecommunication Union</span>, <span class="refTitle">"Information technology - Open Systems Interconnection - The Directory: Public-key and attribute certificate frameworks"</span>, <span class="seriesInfo">ISO/IEC 9594-8</span>, <span class="seriesInfo">ITU-T Recommendation X.509</span>, <time class="refDate" datetime="2019-10">October 2019</time>. </dd>
<dd class="break"></dd>
<dt id="X.680">[X.680]</dt>
        <dd>
<span class="refAuthor">ITU-T</span>, <span class="refTitle">"Information technology - Abstract Syntax Notation One (ASN.1): Specification of basic notation"</span>, <span class="seriesInfo">ITU-T Recommendation X.680</span>, <time class="refDate" datetime="2021-02">February 2021</time>, <span>&lt;<a href="https://www.itu.int/rec/T-REC-X.680">https://www.itu.int/rec/T-REC-X.680</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="X.690">[X.690]</dt>
      <dd>
<span class="refAuthor">ITU-T</span>, <span class="refTitle">"Information technology - ASN.1 encoding rules: Specification of Basic Encoding Rules (BER), Canonical Encoding Rules (CER) and Distinguished Encoding Rules (DER)"</span>, <span class="seriesInfo">ITU-T Recommendation X.690</span>, <time class="refDate" datetime="2021-02">February 2021</time>, <span>&lt;<a href="https://www.itu.int/rec/T-REC-X.690">https://www.itu.int/rec/T-REC-X.690</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-8.2">
        <h3 id="name-informative-references">
<a class="section-number selfRef" href="#section-8.2">8.2. </a><a class="section-name selfRef" href="#name-informative-references">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC1833">[RFC1833]</dt>
        <dd>
<span class="refAuthor">Srinivasan, R.</span>, <span class="refTitle">"Binding Protocols for ONC RPC Version 2"</span>, <span class="seriesInfo">RFC 1833</span>, <span class="seriesInfo">DOI 10.17487/RFC1833</span>, <time class="refDate" datetime="1995-08">August 1995</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1833">https://www.rfc-editor.org/info/rfc1833</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2203">[RFC2203]</dt>
        <dd>
<span class="refAuthor">Eisler, M.</span>, <span class="refAuthor">Chiu, A.</span>, and <span class="refAuthor">L. Ling</span>, <span class="refTitle">"RPCSEC_GSS Protocol Specification"</span>, <span class="seriesInfo">RFC 2203</span>, <span class="seriesInfo">DOI 10.17487/RFC2203</span>, <time class="refDate" datetime="1997-09">September 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2203">https://www.rfc-editor.org/info/rfc2203</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6698">[RFC6698]</dt>
        <dd>
<span class="refAuthor">Hoffman, P.</span> and <span class="refAuthor">J. Schlyter</span>, <span class="refTitle">"The DNS-Based Authentication of Named Entities (DANE) Transport Layer Security (TLS) Protocol: TLSA"</span>, <span class="seriesInfo">RFC 6698</span>, <span class="seriesInfo">DOI 10.17487/RFC6698</span>, <time class="refDate" datetime="2012-08">August 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6698">https://www.rfc-editor.org/info/rfc6698</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6973">[RFC6973]</dt>
        <dd>
<span class="refAuthor">Cooper, A.</span>, <span class="refAuthor">Tschofenig, H.</span>, <span class="refAuthor">Aboba, B.</span>, <span class="refAuthor">Peterson, J.</span>, <span class="refAuthor">Morris, J.</span>, <span class="refAuthor">Hansen, M.</span>, and <span class="refAuthor">R. Smith</span>, <span class="refTitle">"Privacy Considerations for Internet Protocols"</span>, <span class="seriesInfo">RFC 6973</span>, <span class="seriesInfo">DOI 10.17487/RFC6973</span>, <time class="refDate" datetime="2013-07">July 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6973">https://www.rfc-editor.org/info/rfc6973</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7258">[RFC7258]</dt>
        <dd>
<span class="refAuthor">Farrell, S.</span> and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"Pervasive Monitoring Is an Attack"</span>, <span class="seriesInfo">BCP 188</span>, <span class="seriesInfo">RFC 7258</span>, <span class="seriesInfo">DOI 10.17487/RFC7258</span>, <time class="refDate" datetime="2014-05">May 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7258">https://www.rfc-editor.org/info/rfc7258</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7435">[RFC7435]</dt>
        <dd>
<span class="refAuthor">Dukhovni, V.</span>, <span class="refTitle">"Opportunistic Security: Some Protection Most of the Time"</span>, <span class="seriesInfo">RFC 7435</span>, <span class="seriesInfo">DOI 10.17487/RFC7435</span>, <time class="refDate" datetime="2014-12">December 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7435">https://www.rfc-editor.org/info/rfc7435</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8166">[RFC8166]</dt>
        <dd>
<span class="refAuthor">Lever, C., Ed.</span>, <span class="refAuthor">Simpson, W.</span>, and <span class="refAuthor">T. Talpey</span>, <span class="refTitle">"Remote Direct Memory Access Transport for Remote Procedure Call Version 1"</span>, <span class="seriesInfo">RFC 8166</span>, <span class="seriesInfo">DOI 10.17487/RFC8166</span>, <time class="refDate" datetime="2017-06">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8166">https://www.rfc-editor.org/info/rfc8166</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8167">[RFC8167]</dt>
        <dd>
<span class="refAuthor">Lever, C.</span>, <span class="refTitle">"Bidirectional Remote Procedure Call on RPC-over-RDMA Transports"</span>, <span class="seriesInfo">RFC 8167</span>, <span class="seriesInfo">DOI 10.17487/RFC8167</span>, <time class="refDate" datetime="2017-06">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8167">https://www.rfc-editor.org/info/rfc8167</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8899">[RFC8899]</dt>
        <dd>
<span class="refAuthor">Fairhurst, G.</span>, <span class="refAuthor">Jones, T.</span>, <span class="refAuthor">Tüxen, M.</span>, <span class="refAuthor">Rüngeler, I.</span>, and <span class="refAuthor">T. Völker</span>, <span class="refTitle">"Packetization Layer Path MTU Discovery for Datagram Transports"</span>, <span class="seriesInfo">RFC 8899</span>, <span class="seriesInfo">DOI 10.17487/RFC8899</span>, <time class="refDate" datetime="2020-09">September 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8899">https://www.rfc-editor.org/info/rfc8899</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9110">[RFC9110]</dt>
      <dd>
<span class="refAuthor">Fielding, R., Ed.</span>, <span class="refAuthor">Nottingham, M., Ed.</span>, and <span class="refAuthor">J. Reschke, Ed.</span>, <span class="refTitle">"HTTP Semantics"</span>, <span class="seriesInfo">STD 97</span>, <span class="seriesInfo">RFC 9110</span>, <span class="seriesInfo">DOI 10.17487/RFC9110</span>, <time class="refDate" datetime="2022-06">June 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9110">https://www.rfc-editor.org/info/rfc9110</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="section_C7FB9DB5-5F4F-45AD-8BF7-74FFCA08BEBB">
<section id="appendix-A">
      <h2 id="name-known-weaknesses-of-the-aut">
<a class="section-number selfRef" href="#appendix-A">Appendix A. </a><a class="section-name selfRef" href="#name-known-weaknesses-of-the-aut">Known Weaknesses of the AUTH_SYS Authentication Flavor</a>
      </h2>
<p id="appendix-A-1">

The ONC RPC protocol, as specified in <span>[<a class="xref" href="#RFC5531">RFC5531</a>]</span>, 
provides several modes of security, commonly
referred to as "authentication flavors".  Some of these flavors provide much
more than an authentication service.  We refer to these as authentication
flavors, security flavors, or simply, flavors.  One of the earliest and most
basic flavors is AUTH_SYS, also known as AUTH_UNIX.
<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc5531#appendix-A">Appendix A</a> of [<a class="xref" href="#RFC5531">RFC5531</a>]</span>
specifies AUTH_SYS.<a class="pilcrow" href="#appendix-A-1">¶</a></p>
<p id="appendix-A-2">
AUTH_SYS assumes that the RPC client and server
both use POSIX-style user and group identifiers
(each user and group can be distinctly represented
as a 32-bit unsigned integer).
It also assumes that the client and server
both use the same mapping of user and group to an integer.
One user ID, one primary group ID, and up to 16 supplemental group IDs
are associated with each RPC request.
The combination of these identifies the entity on the client
that is making the request.<a class="pilcrow" href="#appendix-A-2">¶</a></p>
<p id="appendix-A-3">
A string identifies peers (hosts) in each RPC request.
<span>[<a class="xref" href="#RFC5531">RFC5531</a>]</span>
does not specify any requirements for this string
other than that it is no longer than 255 octets.
It does not have to be the same from request to request.
Also, it does not have to match the DNS hostname of the sending host.
For these reasons,
even though most implementations fill in their hostname in this field,
receivers typically ignore its content.<a class="pilcrow" href="#appendix-A-3">¶</a></p>
<p id="appendix-A-4">
<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc5531#appendix-A">Appendix A</a> of [<a class="xref" href="#RFC5531">RFC5531</a>]</span>
contains a brief explanation of security considerations:<a class="pilcrow" href="#appendix-A-4">¶</a></p>
<blockquote id="appendix-A-5">
It should be noted that use of this flavor of authentication does not
guarantee any security for the users or providers of a service, in
itself.  The authentication provided by this scheme can be considered
legitimate only when applications using this scheme and the network
can be secured externally, and privileged transport addresses are
used for the communicating end-points (an example of this is the use
of privileged TCP/UDP ports in UNIX systems -- note that not all
systems enforce privileged transport address mechanisms).<a class="pilcrow" href="#appendix-A-5">¶</a>
</blockquote>
<p id="appendix-A-6">
It should be clear, therefore, that AUTH_SYS by itself
(i.e., without strong client authentication)
offers little to no communication security:<a class="pilcrow" href="#appendix-A-6">¶</a></p>
<ol class="normal type-1" id="appendix-A-7" start="1" type="1">
<li id="appendix-A-7.1">
It does not protect the confidentiality or integrity of
RPC requests,
users,
or
payloads,
relying instead on "external" security.<a class="pilcrow" href="#appendix-A-7.1">¶</a>
</li>
        <li id="appendix-A-7.2">
It does not provide authentication of RPC peer machines,
other than inclusion of an unprotected domain name.<a class="pilcrow" href="#appendix-A-7.2">¶</a>
</li>
        <li id="appendix-A-7.3">
The use of 32-bit unsigned integers as user and group identifiers
is problematic because these data types are
not cryptographically signed or otherwise verified by any authority.
In addition, the mapping of these integers to users and groups
has to be consistent amongst a server and its cohort of clients.<a class="pilcrow" href="#appendix-A-7.3">¶</a>
</li>
        <li id="appendix-A-7.4">
Because the user and group ID fields are not integrity protected,
AUTH_SYS does not provide non-repudiation.<a class="pilcrow" href="#appendix-A-7.4">¶</a>
</li>
      </ol>
</section>
</div>
<div id="section_B08B45C1-1E10-4F7A-935B-1198BAF255C0">
<section id="appendix-B">
      <h2 id="name-asn1-module">
<a class="section-number selfRef" href="#appendix-B">Appendix B. </a><a class="section-name selfRef" href="#name-asn1-module">ASN.1 Module</a>
      </h2>
<p id="appendix-B-1">
  The following module adheres to ASN.1 specifications <span>[<a class="xref" href="#X.680">X.680</a>]</span> and <span>[<a class="xref" href="#X.690">X.690</a>]</span>.<a class="pilcrow" href="#appendix-B-1">¶</a></p>
<div id="appendix-B-2">
<pre class="lang-asn.1 sourcecode">&lt;CODE BEGINS&gt;


RPCwithTLS-2021
  { iso(1) identified-organization(3) dod(6) internet(1)
  security(5) mechanisms(5) pkix(7) id-mod(0)
  id-mod-rpcWithTLS-2021(105) }

DEFINITIONS IMPLICIT TAGS ::=
BEGIN

-- OID Arc

id-kp OBJECT IDENTIFIER ::=
  { iso(1) identified-organization(3) dod(6) internet(1)
    security(5) mechanisms(5) pkix(7) kp(3) }

-- Extended Key Usage Values

id-kp-rpcTLSClient OBJECT IDENTIFIER ::= { id-kp 33 }
id-kp-rpcTLSServer OBJECT IDENTIFIER ::= { id-kp 34 }

END


&lt;CODE ENDS&gt;</pre><a class="pilcrow" href="#appendix-B-2">¶</a>
</div>
</section>
</div>
<div id="section_4959412F-37AD-42B8-9169-D477148F81A8">
<section id="appendix-C">
      <h2 id="name-acknowledgments">
<a class="section-name selfRef" href="#name-acknowledgments">Acknowledgments</a>
      </h2>
<p id="appendix-C-1">
Special mention goes to
<span class="contact-name">Charles Fisher</span>,
author of
<a href="https://www.linuxjournal.com/content/encrypting-nfsv4-stunnel-tls">
"Encrypting NFSv4 with Stunnel TLS"</a>.  His article inspired the
mechanism described in the current document.<a class="pilcrow" href="#appendix-C-1">¶</a></p>
<p id="appendix-C-2">
Many thanks to

<span class="contact-name">Benjamin Coddington</span>,
<span class="contact-name">Tigran Mkrtchyan</span>,
and
<span class="contact-name">Rick Macklem</span>
for their work on prototype implementations and feedback on the current document.

Also, thanks to
<span class="contact-name">Benjamin Kaduk</span>
for his expert guidance on the use of PKIX and TLS
and to <span class="contact-name">Russ Housley</span> for his ASN.1 expertise and for providing other proper finishing touches.
In addition, the authors thank the other members of the IESG for
their astute review comments. These contributors made this a significantly better document.<a class="pilcrow" href="#appendix-C-2">¶</a></p>
<p id="appendix-C-3">
Thanks to
<span class="contact-name">Derrell Piper</span>
for numerous suggestions that improved both
this simple mechanism
and
the current document's security-related discussion.<a class="pilcrow" href="#appendix-C-3">¶</a></p>
<p id="appendix-C-4">
Many thanks to
Transport Area Director
<span class="contact-name">Magnus Westerlund</span>
for his sharp questions and careful reading
of the final revisions of the current document.
The text of
<a class="xref" href="#section_B8BF600E-96DC-4C82-AADF-D593826E9B75">Section 5.1.2</a>
is mostly his contribution.<a class="pilcrow" href="#appendix-C-4">¶</a></p>
<p id="appendix-C-5">
The authors are additionally grateful to
<span class="contact-name">Bill Baker</span>,
<span class="contact-name">David Black</span>,
<span class="contact-name">Alan DeKok</span>,
<span class="contact-name">Lars Eggert</span>,
<span class="contact-name">Olga Kornievskaia</span>,
<span class="contact-name">Greg Marsden</span>,
<span class="contact-name">Alex McDonald</span>,
<span class="contact-name">Justin Mazzola Paluska</span>,
<span class="contact-name">Tom Talpey</span>,
<span class="contact-name">Martin Thomson</span>,
and
<span class="contact-name">Nico Williams</span>
for their input and support of this work.<a class="pilcrow" href="#appendix-C-5">¶</a></p>
<p id="appendix-C-6">
Finally, special thanks to
NFSV4 Working Group Chair and document shepherd
<span class="contact-name">David Noveck</span>,
NFSV4 Working Group Chairs
<span class="contact-name">Spencer Shepler</span>
and <span class="contact-name">Brian Pawlowski</span>, and NFSV4 Working Group Secretary
<span class="contact-name">Thomas Haynes</span>
for their guidance and oversight.<a class="pilcrow" href="#appendix-C-6">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-D">
      <h2 id="name-authors-addresses">
<a class="section-name selfRef" href="#name-authors-addresses">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Trond Myklebust</span></div>
<div class="left" dir="auto"><span class="org">Hammerspace Inc.</span></div>
<div class="left" dir="auto"><span class="street-address">4300 El Camino Real, Suite 105</span></div>
<div class="left" dir="auto">
<span class="locality">Los Altos</span>, <span class="region">CA</span> <span class="postal-code">94022</span>
</div>
<div class="left" dir="auto"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:trond.myklebust@hammerspace.com">trond.myklebust@hammerspace.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Charles Lever (<span class="role">editor</span>)</span></div>
<div class="left" dir="auto"><span class="org">Oracle Corporation</span></div>
<div class="left" dir="auto"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:chuck.lever@oracle.com">chuck.lever@oracle.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>


</body></html>