<!DOCTYPE html>
<html class="RFC" lang="en"><head>
<meta charset="utf-8"/>
<meta content="Common,Latin" name="scripts"/>
<meta content="initial-scale=1.0" name="viewport"/>
<title>RFC 9588: Kerberos Simple Password-Authenticated Key Exchange (SPAKE) Preâ€‘authentication</title>
<meta content="Nathaniel McCallum" name="author"/>
<meta content="Simo Sorce" name="author"/>
<meta content="Robbie Harwood" name="author"/>
<meta content="Greg Hudson" name="author"/>
<meta content="
       This document defines a new pre-authentication mechanism for
      the Kerberos protocol.  The mechanism uses a
      password-authenticated key exchange (PAKE) to prevent brute-force
      password attacks, and it may incorporate a second factor.
       
    " name="description"/>
<meta content="xml2rfc 3.23.0" name="generator"/>
<meta content="example" name="keyword"/>
<meta content="9588" name="rfc.number"/>
<!-- Generator version information:
  xml2rfc 3.23.0
    Python 3.9.15
    ConfigArgParse 1.5.3
    google-i18n-address 3.0.0
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 4.9.0
    platformdirs 3.8.0
    pycountry 22.3.5
    pydyf 0.10.0
    PyYAML 6.0
    requests 2.28.0
    setuptools 44.1.1
    wcwidth 0.2.5
    weasyprint 62.3
-->
<link href="rfc9588.xml" rel="alternate" type="application/rfc+xml"/>
<link href="#copyright" rel="license"/>
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necessary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

:root {
  --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
  --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
  --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
}

@viewport {
  zoom: 1.0;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: var(--font-sans);
  line-height: 1.6;
  scroll-behavior: smooth;
  overflow-wrap: break-word;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
svg[font-family~="serif" i], svg [font-family~="serif" i] {
  font-family: var(--font-serif);
}
svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
  font-family: var(--font-sans);
}
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre {
  background-color: #f9f9f9;
  font-family: var(--font-mono);
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
blockquote > *:last-child {
  margin-bottom: 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}
.xref {
  overflow-wrap: normal;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.refSubseries {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: var(--font-sans);
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  .breakable pre {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The following is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
.sourcecode pre,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .artwork > pre,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: upper-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background slightly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottom margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code, dt tt, dt code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the compact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div.sourcecode:first-child,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type:only-child {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css"/>
<link href="https://datatracker.ietf.org/doc/draft-ietf-kitten-krb-spake-preauth-13" rel="prev"/>
  <link href="https://dx.doi.org/10.17487/rfc9588" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  </head>
<body class="xml2rfc">
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 9588</td>
<td class="center">Kerberos SPAKE Pre-authentication</td>
<td class="right">August 2024</td>
</tr></thead>
<tfoot><tr>
<td class="left">McCallum, et al.</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div class="document-information" id="external-metadata"></div>
<div class="document-information" id="internal-metadata">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a class="eref" href="https://www.rfc-editor.org/rfc/rfc9588">9588</a></dd>
<dt class="label-category">Category:</dt>
<dd class="category">Standards Track</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time class="published" datetime="2024-08">August 2024</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">N. McCallum</div>
<div class="org">Red Hat, Inc.</div>
</div>
<div class="author">
      <div class="author-name">S. Sorce</div>
<div class="org">Red Hat, Inc.</div>
</div>
<div class="author">
      <div class="author-name">R. Harwood</div>
<div class="org">Red Hat, Inc.</div>
</div>
<div class="author">
      <div class="author-name">G. Hudson</div>
<div class="org">MIT</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 9588</h1>
<h1 id="title">Kerberos Simple Password-Authenticated Key Exchange (SPAKE) Preâ€‘authentication</h1>
<section id="section-abstract">
      <h2 id="abstract"><a class="selfRef" href="#abstract">Abstract</a></h2>
<p id="section-abstract-1">This document defines a new pre-authentication mechanism for
      the Kerberos protocol.  The mechanism uses a
      password-authenticated key exchange (PAKE) to prevent brute-force
      password attacks, and it may incorporate a second factor.<a class="pilcrow" href="#section-abstract-1">Â¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a class="section-name selfRef" href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This is an Internet Standards Track document.<a class="pilcrow" href="#section-boilerplate.1-1">Â¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.<a class="pilcrow" href="#section-boilerplate.1-2">Â¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc9588">https://www.rfc-editor.org/info/rfc9588</a></span>.<a class="pilcrow" href="#section-boilerplate.1-3">Â¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a class="section-name selfRef" href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2024 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a class="pilcrow" href="#section-boilerplate.2-1">Â¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a class="pilcrow" href="#section-boilerplate.2-2">Â¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a class="toplink" href="#" onclick="scroll(0,0)">â–²</a><h2 id="name-table-of-contents">
<a class="section-name selfRef" href="#name-table-of-contents">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a class="auto internal xref" href="#section-1">1</a>.Â Â <a class="internal xref" href="#name-introduction">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p class="keepWithNext" id="section-toc.1-1.1.2.1.1"><a class="auto internal xref" href="#section-1.1">1.1</a>.Â Â <a class="internal xref" href="#name-properties-of-pake">Properties of PAKE</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p class="keepWithNext" id="section-toc.1-1.1.2.2.1"><a class="auto internal xref" href="#section-1.2">1.2</a>.Â Â <a class="internal xref" href="#name-pake-algorithm-selection">PAKE Algorithm Selection</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.3">
                <p class="keepWithNext" id="section-toc.1-1.1.2.3.1"><a class="auto internal xref" href="#section-1.3">1.3</a>.Â Â <a class="internal xref" href="#name-pake-and-two-factor-authent">PAKE and Two-Factor Authentication</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.4">
                <p id="section-toc.1-1.1.2.4.1"><a class="auto internal xref" href="#section-1.4">1.4</a>.Â Â <a class="internal xref" href="#name-spake-overview">SPAKE Overview</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a class="auto internal xref" href="#section-2">2</a>.Â Â <a class="internal xref" href="#name-document-conventions">Document Conventions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a class="auto internal xref" href="#section-3">3</a>.Â Â <a class="internal xref" href="#name-prerequisites">Prerequisites</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a class="auto internal xref" href="#section-3.1">3.1</a>.Â Â <a class="internal xref" href="#name-pa-etype-info2">PA-ETYPE-INFO2</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a class="auto internal xref" href="#section-3.2">3.2</a>.Â Â <a class="internal xref" href="#name-cookie-support">Cookie Support</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a class="auto internal xref" href="#section-3.3">3.3</a>.Â Â <a class="internal xref" href="#name-more-pre-authentication-dat">More Pre-authentication Data Required</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a class="auto internal xref" href="#section-4">4</a>.Â Â <a class="internal xref" href="#name-spake-pre-authentication-me">SPAKE Pre-authentication Message Protocol</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a class="auto internal xref" href="#section-4.1">4.1</a>.Â Â <a class="internal xref" href="#name-first-pass">First Pass</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a class="auto internal xref" href="#section-4.2">4.2</a>.Â Â <a class="internal xref" href="#name-second-pass">Second Pass</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a class="auto internal xref" href="#section-4.3">4.3</a>.Â Â <a class="internal xref" href="#name-third-pass">Third Pass</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a class="auto internal xref" href="#section-4.4">4.4</a>.Â Â <a class="internal xref" href="#name-subsequent-passes">Subsequent Passes</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a class="auto internal xref" href="#section-4.5">4.5</a>.Â Â <a class="internal xref" href="#name-reply-key-strengthening">Reply Key Strengthening</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.6">
                <p id="section-toc.1-1.4.2.6.1"><a class="auto internal xref" href="#section-4.6">4.6</a>.Â Â <a class="internal xref" href="#name-optimizations">Optimizations</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a class="auto internal xref" href="#section-5">5</a>.Â Â <a class="internal xref" href="#name-spake-parameters-and-conver">SPAKE Parameters and Conversions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a class="auto internal xref" href="#section-6">6</a>.Â Â <a class="internal xref" href="#name-transcript-hash">Transcript Hash</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a class="auto internal xref" href="#section-7">7</a>.Â Â <a class="internal xref" href="#name-key-derivation">Key Derivation</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a class="auto internal xref" href="#section-8">8</a>.Â Â <a class="internal xref" href="#name-second-factor-types">Second-Factor Types</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a class="auto internal xref" href="#section-9">9</a>.Â Â <a class="internal xref" href="#name-hint-for-authentication-set">Hint for Authentication Sets</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a class="auto internal xref" href="#section-10">10</a>.Â <a class="internal xref" href="#name-security-considerations">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a class="auto internal xref" href="#section-10.1">10.1</a>.Â Â <a class="internal xref" href="#name-spake-computations">SPAKE Computations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a class="auto internal xref" href="#section-10.2">10.2</a>.Â Â <a class="internal xref" href="#name-unauthenticated-plaintext">Unauthenticated Plaintext</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.3">
                <p id="section-toc.1-1.10.2.3.1"><a class="auto internal xref" href="#section-10.3">10.3</a>.Â Â <a class="internal xref" href="#name-side-channels">Side Channels</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.4">
                <p id="section-toc.1-1.10.2.4.1"><a class="auto internal xref" href="#section-10.4">10.4</a>.Â Â <a class="internal xref" href="#name-kdc-state">KDC State</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.5">
                <p id="section-toc.1-1.10.2.5.1"><a class="auto internal xref" href="#section-10.5">10.5</a>.Â Â <a class="internal xref" href="#name-dictionary-attacks">Dictionary Attacks</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.6">
                <p id="section-toc.1-1.10.2.6.1"><a class="auto internal xref" href="#section-10.6">10.6</a>.Â Â <a class="internal xref" href="#name-brute-force-attacks">Brute-Force Attacks</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.7">
                <p id="section-toc.1-1.10.2.7.1"><a class="auto internal xref" href="#section-10.7">10.7</a>.Â Â <a class="internal xref" href="#name-denial-of-service-attacks">Denial-of-Service Attacks</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.8">
                <p id="section-toc.1-1.10.2.8.1"><a class="auto internal xref" href="#section-10.8">10.8</a>.Â Â <a class="internal xref" href="#name-reflection-attacks">Reflection Attacks</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.9">
                <p id="section-toc.1-1.10.2.9.1"><a class="auto internal xref" href="#section-10.9">10.9</a>.Â Â <a class="internal xref" href="#name-reply-key-encryption-type">Reply Key Encryption Type</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.10">
                <p id="section-toc.1-1.10.2.10.1"><a class="auto internal xref" href="#section-10.10">10.10</a>.Â <a class="internal xref" href="#name-kdc-authentication">KDC Authentication</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a class="auto internal xref" href="#section-11">11</a>.Â <a class="internal xref" href="#name-assigned-constants">Assigned Constants</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a class="auto internal xref" href="#section-12">12</a>.Â <a class="internal xref" href="#name-iana-considerations">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a class="auto internal xref" href="#section-12.1">12.1</a>.Â Â <a class="internal xref" href="#name-kerberos-second-factor-type">Kerberos Second-Factor Types</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1.2.1">
                    <p id="section-toc.1-1.12.2.1.2.1.1"><a class="auto internal xref" href="#section-12.1.1">12.1.1</a>.Â Â <a class="internal xref" href="#name-registration-template">Registration Template</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1.2.2">
                    <p id="section-toc.1-1.12.2.1.2.2.1"><a class="auto internal xref" href="#section-12.1.2">12.1.2</a>.Â Â <a class="internal xref" href="#name-initial-registry-contents">Initial Registry Contents</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a class="auto internal xref" href="#section-12.2">12.2</a>.Â Â <a class="internal xref" href="#name-kerberos-spake-groups">Kerberos SPAKE Groups</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2.2.1">
                    <p id="section-toc.1-1.12.2.2.2.1.1"><a class="auto internal xref" href="#section-12.2.1">12.2.1</a>.Â Â <a class="internal xref" href="#name-registration-template-2">Registration Template</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2.2.2">
                    <p id="section-toc.1-1.12.2.2.2.2.1"><a class="auto internal xref" href="#section-12.2.2">12.2.2</a>.Â Â <a class="internal xref" href="#name-initial-registry-contents-2">Initial Registry Contents</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a class="auto internal xref" href="#section-13">13</a>.Â <a class="internal xref" href="#name-references">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a class="auto internal xref" href="#section-13.1">13.1</a>.Â Â <a class="internal xref" href="#name-normative-references">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a class="auto internal xref" href="#section-13.2">13.2</a>.Â Â <a class="internal xref" href="#name-informative-references">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a class="auto internal xref" href="#appendix-A">Appendix A</a>.Â Â <a class="internal xref" href="#name-asn1-module">ASN.1 Module</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a class="auto internal xref" href="#appendix-B">Appendix B</a>.Â Â <a class="internal xref" href="#name-spake-m-and-n-value-selecti">SPAKE M and N Value Selection</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a class="auto internal xref" href="#appendix-C">Appendix C</a>.Â Â <a class="internal xref" href="#name-test-vectors">Test Vectors</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17">
            <p id="section-toc.1-1.17.1"><a class="auto internal xref" href="#appendix-D"></a><a class="internal xref" href="#name-acknowledgements">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18">
            <p id="section-toc.1-1.18.1"><a class="auto internal xref" href="#appendix-E"></a><a class="internal xref" href="#name-authors-addresses">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<section id="section-1">
      <h2 id="name-introduction">
<a class="section-number selfRef" href="#section-1">1. </a><a class="section-name selfRef" href="#name-introduction">Introduction</a>
      </h2>
<p id="section-1-1">The Kerberos protocol <span>[<a class="cite xref" href="#RFC4120">RFC4120</a>]</span> commonly uses
      password-derived long-term keys to secure the initial authentication
      exchange between a Kerberos client and a Key Distribution Center (KDC).
      As noted in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc4120#section-10">Section 10</a> of [<a class="cite xref" href="#RFC4120">RFC4120</a>]</span>, an attacker can
      perform an offline dictionary attack against the password; this is performed either by
      initiating an authentication exchange to a principal for which the KDC
      does not require pre-authentication or after eavesdropping on a
      legitimate authentication exchange that uses encrypted timestamp
      pre-authentication (<span><a class="relref" href="https://rfc-editor.org/rfc/rfc4120#section-5.2.7.2">Section 5.2.7.2</a> of [<a class="cite xref" href="#RFC4120">RFC4120</a>]</span>).<a class="pilcrow" href="#section-1-1">Â¶</a></p>
<p id="section-1-2">This document defines a pre-authentication mechanism that
      authenticates using long-term keys but is resistant to offline dictionary
      attacks. The mechanism additionally enables the use of second-factor
      authentication without the need for a separately established secure
      channel, by leveraging the trust relationship established by the shared
      long-term key.<a class="pilcrow" href="#section-1-2">Â¶</a></p>
<section id="section-1.1">
        <h3 id="name-properties-of-pake">
<a class="section-number selfRef" href="#section-1.1">1.1. </a><a class="section-name selfRef" href="#name-properties-of-pake">Properties of PAKE</a>
        </h3>
<p id="section-1.1-1">Password-authenticated key exchange (PAKE) algorithms <span>[<a class="cite xref" href="#RFC8125">RFC8125</a>]</span> provide several properties that defend against
        offline dictionary attacks and make them ideal for use in a Kerberos
        pre-authentication mechanism.<a class="pilcrow" href="#section-1.1-1">Â¶</a></p>
<ol class="normal type-1" id="section-1.1-2" start="1" type="1">
          <li id="section-1.1-2.1">Each side of the exchange contributes entropy.<a class="pilcrow" href="#section-1.1-2.1">Â¶</a>
</li>
          <li id="section-1.1-2.2">Passive attackers cannot determine the shared key.<a class="pilcrow" href="#section-1.1-2.2">Â¶</a>
</li>
          <li id="section-1.1-2.3">Active attackers cannot perform a machine-in-the-middle
          attack.<a class="pilcrow" href="#section-1.1-2.3">Â¶</a>
</li>
        </ol>
<p id="section-1.1-3">These properties of PAKE allow us to establish high-entropy
        encryption keys resistant to offline brute-force attacks, even when
        the passwords used are weak (low entropy).<a class="pilcrow" href="#section-1.1-3">Â¶</a></p>
</section>
<section id="section-1.2">
        <h3 id="name-pake-algorithm-selection">
<a class="section-number selfRef" href="#section-1.2">1.2. </a><a class="section-name selfRef" href="#name-pake-algorithm-selection">PAKE Algorithm Selection</a>
        </h3>
<p id="section-1.2-1">The SPAKE algorithm (defined in <span>[<a class="cite xref" href="#SPAKE">SPAKE</a>]</span>) works by
        encrypting the public keys of a Diffie-Hellman (DH) key exchange with a
        shared secret. SPAKE is selected for this pre-authentication mechanism
        for the following properties:<a class="pilcrow" href="#section-1.2-1">Â¶</a></p>
<ol class="normal type-1" id="section-1.2-2" start="1" type="1">
          <li id="section-1.2-2.1">SPAKE's encryption method ensures that the result is a
          member of the underlying group, so it can be used with elliptic curve
          cryptography, which is believed to provide equivalent security levels
          to finite-field DH key exchange at much smaller key sizes.<a class="pilcrow" href="#section-1.2-2.1">Â¶</a>
</li>
          <li id="section-1.2-2.2">It can compute the shared key after just one message from each
          party, minimizing the need for additional round trips and state.<a class="pilcrow" href="#section-1.2-2.2">Â¶</a>
</li>
          <li id="section-1.2-2.3">It requires a small number of group operations; therefore, it can
          be implemented simply and efficiently.<a class="pilcrow" href="#section-1.2-2.3">Â¶</a>
</li>
        </ol>
</section>
<section id="section-1.3">
        <h3 id="name-pake-and-two-factor-authent">
<a class="section-number selfRef" href="#section-1.3">1.3. </a><a class="section-name selfRef" href="#name-pake-and-two-factor-authent">PAKE and Two-Factor Authentication</a>
        </h3>
<p id="section-1.3-1">Using PAKE in a pre-authentication mechanism also has another
        benefit when used as a component of two-factor authentication (2FA).
        2FA methods often require the secure transfer of plaintext material to
        the KDC for verification. This includes one-time passwords,
        challenge/response signatures, and biometric data. Encrypting this data
        using the long-term secret results in packets that are vulnerable to
        offline brute-force attacks on the password, using either an
        authentication tag or statistical properties of the 2FA credentials to
        determine whether a password guess is correct.<a class="pilcrow" href="#section-1.3-1">Â¶</a></p>
<p id="section-1.3-2">In "One-Time Password (OTP) Pre-Authentication"
        <span>[<a class="cite xref" href="#RFC6560">RFC6560</a>]</span>, this problem is mitigated 
        using flexible authentication secure tunneling (FAST) (<span><a class="relref" href="https://rfc-editor.org/rfc/rfc6113#section-5.4">Section 5.4</a> of [<a class="cite xref" href="#RFC6113">RFC6113</a>]</span>), which uses a
        secondary trust relationship to create a secure encryption channel
        within which pre-authentication data can be sent. However, the
        requirement for a secondary trust relationship has proven to be
        cumbersome to deploy and often introduces third parties into the trust
        chain (such as certification authorities). These requirements make it
        difficult to enable FAST without manual configuration of client
        hosts. In contrast, SPAKE pre-authentication, can create a secure
        encryption channel implicitly, using the key exchange to negotiate a
        high-entropy encryption key. This key can then be used to securely
        encrypt 2FA plaintext data without the need for a secondary trust
        relationship. Further, if the second-factor verifiers are sent at the
        same time as the first-factor verifier, and the KDC is careful to
        prevent timing attacks, then an online brute-force attack cannot be
        used to attack the factors separately.<a class="pilcrow" href="#section-1.3-2">Â¶</a></p>
<p id="section-1.3-3">For these reasons, this document departs from the advice given in
        <span><a class="relref" href="https://rfc-editor.org/rfc/rfc6113#section-1">Section 1</a> of [<a class="cite xref" href="#RFC6113">RFC6113</a>]</span>, which states:
        "Mechanism designers should design FAST factors, instead of new
        pre-authentication mechanisms outside of FAST." However, the SPAKE
        pre-authentication mechanism does not intend to replace FAST and may
        be used with it to further conceal the metadata of the Kerberos
        messages.<a class="pilcrow" href="#section-1.3-3">Â¶</a></p>
</section>
<section id="section-1.4">
        <h3 id="name-spake-overview">
<a class="section-number selfRef" href="#section-1.4">1.4. </a><a class="section-name selfRef" href="#name-spake-overview">SPAKE Overview</a>
        </h3>
<p id="section-1.4-1">The SPAKE algorithm can be broadly described in a series of four
        steps:<a class="pilcrow" href="#section-1.4-1">Â¶</a></p>
<ol class="normal type-1" id="section-1.4-2" start="1" type="1">
          <li id="section-1.4-2.1">Calculation and exchange of the public key<a class="pilcrow" href="#section-1.4-2.1">Â¶</a>
</li>
          <li id="section-1.4-2.2">Calculation of the shared secret (K)<a class="pilcrow" href="#section-1.4-2.2">Â¶</a>
</li>
          <li id="section-1.4-2.3">Derivation of an encryption key (K')<a class="pilcrow" href="#section-1.4-2.3">Â¶</a>
</li>
          <li id="section-1.4-2.4">Verification of the derived encryption key (K')<a class="pilcrow" href="#section-1.4-2.4">Â¶</a>
</li>
        </ol>
<p id="section-1.4-3">In this mechanism, key verification happens implicitly by a
        successful decryption of the 2FA data or of a placeholder value when
        no second factor is required. This mechanism uses a tailored method of
        deriving encryption keys from the calculated shared secret K, for
        several reasons:<a class="pilcrow" href="#section-1.4-3">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.4-4.1">to fit within the framework of <span>[<a class="cite xref" href="#RFC3961">RFC3961</a>]</span>,<a class="pilcrow" href="#section-1.4-4.1">Â¶</a>
</li>
          <li class="normal" id="section-1.4-4.2">to ensure negotiation integrity using a transcript
        hash,<a class="pilcrow" href="#section-1.4-4.2">Â¶</a>
</li>
          <li class="normal" id="section-1.4-4.3">to derive different keys for each use, and<a class="pilcrow" href="#section-1.4-4.3">Â¶</a>
</li>
          <li class="normal" id="section-1.4-4.4">to bind the KDC-REQ-BODY to the pre-authentication exchange.<a class="pilcrow" href="#section-1.4-4.4">Â¶</a>
</li>
        </ul>
</section>
</section>
<div id="conventions">
<section id="section-2">
      <h2 id="name-document-conventions">
<a class="section-number selfRef" href="#section-2">2. </a><a class="section-name selfRef" href="#name-document-conventions">Document Conventions</a>
      </h2>
<p id="section-2-1">
    The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
    "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
    described in BCPÂ 14 <span>[<a class="cite xref" href="#RFC2119">RFC2119</a>]</span> <span>[<a class="cite xref" href="#RFC8174">RFC8174</a>]</span> 
    when, and only when, they appear in all capitals, as shown here.<a class="pilcrow" href="#section-2-1">Â¶</a></p>
<p id="section-2-2">This document refers to numerous terms and protocol messages defined
      in <span>[<a class="cite xref" href="#RFC4120">RFC4120</a>]</span>.<a class="pilcrow" href="#section-2-2">Â¶</a></p>
<p id="section-2-3">The terms "encryption type", "key generation seed length", and
      "random-to-key" are defined in <span>[<a class="cite xref" href="#RFC3961">RFC3961</a>]</span>.<a class="pilcrow" href="#section-2-3">Â¶</a></p>
<p id="section-2-4">The terms "FAST", "PA-FX-COOKIE", "KDC_ERR_PREAUTH_EXPIRED",
      "KDC_ERR_MORE_PREAUTH_DATA_REQUIRED", "KDC_ERR_PREAUTH_FAILED",
      "pre-authentication facility", and "authentication set" are defined in
      <span>[<a class="cite xref" href="#RFC6113">RFC6113</a>]</span>.<a class="pilcrow" href="#section-2-4">Â¶</a></p>
<p id="section-2-5"><span>[<a class="cite xref" href="#SPAKE">SPAKE</a>]</span> defines SPAKE as a family of two key-exchange algorithms differing only in derivation of the final key. This
      mechanism uses a derivation similar to the second algorithm (SPAKE2). For
      simplicity, this document refers to the algorithm as "SPAKE".<a class="pilcrow" href="#section-2-5">Â¶</a></p>
<p id="section-2-6">The terms "Abstract Syntax Notation One (ASN.1)" and "Distinguished Encoding Rules (DER)" are defined in <span>[<a class="cite xref" href="#ITU-T.X680.2021">ITU-T.X680.2021</a>]</span> and <span>[<a class="cite xref" href="#ITU-T.X690.2021">ITU-T.X690.2021</a>]</span>,
      respectively.<a class="pilcrow" href="#section-2-6">Â¶</a></p>
<p id="section-2-7">When discussing operations within algebraic groups, this document
      uses additive notation (as described in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc6090#section-2.2">Section 2.2</a> of [<a class="cite xref" href="#RFC6090">RFC6090</a>]</span>). Group elements are denoted with
      uppercase letters, while scalar multiplier values are denoted with
      lowercase letters.<a class="pilcrow" href="#section-2-7">Â¶</a></p>
</section>
</div>
<section id="section-3">
      <h2 id="name-prerequisites">
<a class="section-number selfRef" href="#section-3">3. </a><a class="section-name selfRef" href="#name-prerequisites">Prerequisites</a>
      </h2>
<section id="section-3.1">
        <h3 id="name-pa-etype-info2">
<a class="section-number selfRef" href="#section-3.1">3.1. </a><a class="section-name selfRef" href="#name-pa-etype-info2">PA-ETYPE-INFO2</a>
        </h3>
<p id="section-3.1-1">This mechanism requires the initial KDC pre-authentication state to
        contain a singular reply key. Therefore, a KDC that offers SPAKE
        pre-authentication as a stand-alone mechanism <span class="bcp14">MUST</span>
        supply a PA-ETYPE-INFO2 value containing a single ETYPE-INFO2-ENTRY,
        following the guidance in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc6113#section-2.1">Section 2.1</a> of [<a class="cite xref" href="#RFC6113">RFC6113</a>]</span>. PA-ETYPE-INFO2 is specified in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc4120#section-5.2.7.5">Section 5.2.7.5</a> of [<a class="cite xref" href="#RFC4120">RFC4120</a>]</span>.<a class="pilcrow" href="#section-3.1-1">Â¶</a></p>
</section>
<section id="section-3.2">
        <h3 id="name-cookie-support">
<a class="section-number selfRef" href="#section-3.2">3.2. </a><a class="section-name selfRef" href="#name-cookie-support">Cookie Support</a>
        </h3>
<p id="section-3.2-1">KDCs that implement SPAKE pre-authentication <span class="bcp14">MUST</span>
        have some secure mechanism for retaining state between authentication service requests (AS-REQs). For
        stateless KDC implementations, this method will most commonly be an
        encrypted PA-FX-COOKIE. Clients that implement SPAKE
        pre-authentication <span class="bcp14">MUST</span> support PA-FX-COOKIE, as
        described in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc6113#section-5.2">Section 5.2</a> of [<a class="cite xref" href="#RFC6113">RFC6113</a>]</span>.<a class="pilcrow" href="#section-3.2-1">Â¶</a></p>
</section>
<section id="section-3.3">
        <h3 id="name-more-pre-authentication-dat">
<a class="section-number selfRef" href="#section-3.3">3.3. </a><a class="section-name selfRef" href="#name-more-pre-authentication-dat">More Pre-authentication Data Required</a>
        </h3>
<p id="section-3.3-1">Both KDCs and clients that implement SPAKE pre-authentication <span class="bcp14">MUST</span>
        support the use of KDC_ERR_MORE_PREAUTH_DATA_REQUIRED, as described in
        <span><a class="relref" href="https://rfc-editor.org/rfc/rfc6113#section-5.2">Section 5.2</a> of [<a class="cite xref" href="#RFC6113">RFC6113</a>]</span>.<a class="pilcrow" href="#section-3.3-1">Â¶</a></p>
</section>
</section>
<section id="section-4">
      <h2 id="name-spake-pre-authentication-me">
<a class="section-number selfRef" href="#section-4">4. </a><a class="section-name selfRef" href="#name-spake-pre-authentication-me">SPAKE Pre-authentication Message Protocol</a>
      </h2>
<p id="section-4-1">This mechanism uses the reply key and provides the client
      authentication and strengthening reply key pre-authentication facilities
      (<span><a class="relref" href="https://rfc-editor.org/rfc/rfc6113#section-3">Section 3</a> of [<a class="cite xref" href="#RFC6113">RFC6113</a>]</span>). When the mechanism completes
      successfully, the client will have proved knowledge of the original
      reply key and possibly a second factor, and the reply key will be
      strengthened to a more uniform distribution based on the PAKE
      exchange. This mechanism also ensures the integrity of the KDC-REQ-BODY
      contents. This mechanism can be used in an authentication set; no
      pa-hint value is required or defined.<a class="pilcrow" href="#section-4-1">Â¶</a></p>
<p id="section-4-2">This mechanism negotiates a choice of group for the SPAKE algorithm.
      Groups are defined in the "Kerberos SPAKE Groups" registry created
      by this document (see <a class="auto internal xref" href="#SPAKE-Groups">Section 12.2</a>). Each group definition specifies an associated hash
      function, which will be used for transcript protection and key
      derivation. Clients and KDCs <span class="bcp14">MUST</span> implement the edwards25519 group, but they
      <span class="bcp14">MAY</span> choose not to offer or accept it by default.<a class="pilcrow" href="#section-4-2">Â¶</a></p>
<p id="section-4-3">The subsections that follow will describe the flow of messages when performing SPAKE
      pre-authentication. We will begin by explaining the most verbose version
      of the protocol, which all implementations <span class="bcp14">MUST</span> support. Then, we will
      describe several optional optimizations to reduce round trips.<a class="pilcrow" href="#section-4-3">Â¶</a></p>
<p id="section-4-4">Mechanism messages are communicated using PA-DATA elements within the
      padata field of KDC-REQ messages or within the METHOD-DATA in the e-data
      field of KRB-ERROR messages. All PA-DATA elements for this mechanism
      <span class="bcp14">MUST</span> use the following padata-type:<a class="pilcrow" href="#section-4-4">Â¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4-5">
        <dt id="section-4-5.1">PA-SPAKE</dt>
        <dd id="section-4-5.2" style="margin-left: 1.5em">151<a class="pilcrow" href="#section-4-5.2">Â¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-4-6">
      The padata-value for all PA-SPAKE PA-DATA values <span class="bcp14">MUST</span> be empty or
      contain a DER encoding for the ASN.1 type PA-SPAKE.<a class="pilcrow" href="#section-4-6">Â¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-4-7">
<pre>PA-SPAKE ::= CHOICE {
    support     [0] SPAKESupport,
    challenge   [1] SPAKEChallenge,
    response    [2] SPAKEResponse,
    encdata     [3] EncryptedData,
    ...
}
</pre><a class="pilcrow" href="#section-4-7">Â¶</a>
</div>
<section id="section-4.1">
        <h3 id="name-first-pass">
<a class="section-number selfRef" href="#section-4.1">4.1. </a><a class="section-name selfRef" href="#name-first-pass">First Pass</a>
        </h3>
<p id="section-4.1-1">The SPAKE pre-authentication exchange begins when the client sends
        an initial authentication service request (AS-REQ) without
        pre-authentication data. Upon receipt of this AS-REQ, a KDC that
        requires pre-authentication and supports SPAKE <span class="bcp14">SHOULD</span>
        (unless configuration indicates otherwise) reply with a
        KDC_ERR_PREAUTH_REQUIRED error, with METHOD-DATA containing an empty
        PA-SPAKE PA-DATA element (possibly in addition to other PA-DATA
        elements). This message indicates to the client that the KDC supports
        SPAKE pre-authentication.<a class="pilcrow" href="#section-4.1-1">Â¶</a></p>
</section>
<section id="section-4.2">
        <h3 id="name-second-pass">
<a class="section-number selfRef" href="#section-4.2">4.2. </a><a class="section-name selfRef" href="#name-second-pass">Second Pass</a>
        </h3>
<p id="section-4.2-1">Once the client knows that the KDC supports SPAKE pre-authentication
        and the client wants to use it, the client will generate a new
        AS-REQ message containing a PA-SPAKE PA-DATA element using the support
        choice. This message indicates to the KDC which groups the client
        prefers for the SPAKE operation. The group numbers are defined in the 
        "Kerberos SPAKE Groups" registry (see <a class="auto internal xref" href="#SPAKE-Groups">Section 12.2</a>). The group's
        sequence is ordered from the most preferred group to the least preferred
        group.<a class="pilcrow" href="#section-4.2-1">Â¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-4.2-2">
<pre>SPAKESupport ::= SEQUENCE {
    groups      [0] SEQUENCE (SIZE(1..MAX)) OF Int32,
    ...
}
</pre><a class="pilcrow" href="#section-4.2-2">Â¶</a>
</div>
<p id="section-4.2-3">Upon receipt of the support message, the KDC will select a
        group. The KDC <span class="bcp14">SHOULD</span> choose a group from the groups provided by the
        support message. However, if the support message does not contain any
        group that is supported by the KDC, the KDC <span class="bcp14">MAY</span> select another group in
        hopes that the client might support it. Otherwise, the KDC <span class="bcp14">MUST</span> respond
        with a KDC_ERR_PREAUTH_FAILED error.<a class="pilcrow" href="#section-4.2-3">Â¶</a></p>
<p id="section-4.2-4">The group selection determines the group order, which shall be a
        large prime p multiplied by a small cofactor h (possibly 1), 
        a generator P of a prime-order subgroup, and two masking points M and
        N. The KDC selects a random integer x in the range 0 &lt;= x &lt; h*p,
        which <span class="bcp14">MUST</span> be divisible by h. The KDC computes a public key T=x*P+w*M,
        where w is computed from the initial reply key according to <a class="auto internal xref" href="#spakeparams">Section 5</a>.<a class="pilcrow" href="#section-4.2-4">Â¶</a></p>
<p id="section-4.2-5">The KDC will reply to the client with a
        KDC_ERR_MORE_PREAUTH_DATA_REQUIRED error containing a PA-SPAKE PA-DATA
        element using the challenge choice.<a class="pilcrow" href="#section-4.2-5">Â¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-4.2-6">
<pre>SPAKEChallenge ::= SEQUENCE {
    group       [0] Int32,
    pubkey      [1] OCTET STRING,
    factors     [2] SEQUENCE (SIZE(1..MAX)) OF SPAKESecondFactor,
    ...
}
</pre><a class="pilcrow" href="#section-4.2-6">Â¶</a>
</div>
<p id="section-4.2-7">The group field indicates the KDC-selected group 
        used for all SPAKE calculations as defined in the "Kerberos SPAKE
        Groups" registry (see <a class="auto internal xref" href="#SPAKE-Groups">Section 12.2</a>).<a class="pilcrow" href="#section-4.2-7">Â¶</a></p>
<p id="section-4.2-8">The pubkey field indicates the KDC's public key T, serialized
        according to <a class="auto internal xref" href="#spakeparams">Section 5</a>.<a class="pilcrow" href="#section-4.2-8">Â¶</a></p>
<p id="section-4.2-9">The factors field contains an unordered list of second factors,
        which can be used to complete the authentication. Each second factor
        is represented by a SPAKESecondFactor.<a class="pilcrow" href="#section-4.2-9">Â¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-4.2-10">
<pre>SPAKESecondFactor ::= SEQUENCE {
    type        [0] Int32,
    data        [1] OCTET STRING OPTIONAL
}
</pre><a class="pilcrow" href="#section-4.2-10">Â¶</a>
</div>
<p id="section-4.2-11">The type field is a unique integer that identifies the second-factor type. The factors field of SPAKEChallenge <span class="bcp14">MUST NOT</span> contain more than one SPAKESecondFactor with the same type
        value.<a class="pilcrow" href="#section-4.2-11">Â¶</a></p>
<p id="section-4.2-12">The data field contains optional challenge data. The contents in
        this field will depend upon the second-factor type chosen. Note that
        this challenge is initially transmitted as unauthenticated plaintext;
        see <a class="auto internal xref" href="#unauthtext">Section 10.2</a>.<a class="pilcrow" href="#section-4.2-12">Â¶</a></p>
<p id="section-4.2-13">The client and KDC will each initialize a transcript hash (<a class="auto internal xref" href="#transcript">Section 6</a>) using the hash function associated with the
        chosen group and update it with the concatenation of the DER-encoded
        PA-SPAKE messages sent by the client and the KDC.<a class="pilcrow" href="#section-4.2-13">Â¶</a></p>
</section>
<section id="section-4.3">
        <h3 id="name-third-pass">
<a class="section-number selfRef" href="#section-4.3">4.3. </a><a class="section-name selfRef" href="#name-third-pass">Third Pass</a>
        </h3>
<p id="section-4.3-1">Upon receipt of the challenge message, the client observes which
        group was selected by the KDC and deserializes the KDC's public key
        T. The client selects a random integer y in the range 0 &lt;= x &lt;
        h*p, which <span class="bcp14">MUST</span> be divisible by h. The client computes a public key
        S=y*P+w*N, where w is computed from the initial reply key according to
        <a class="auto internal xref" href="#spakeparams">Section 5</a>. The client computes a shared group
        element K=y*(T-w*M).<a class="pilcrow" href="#section-4.3-1">Â¶</a></p>
<p id="section-4.3-2">The client will then choose one of the second-factor types listed in
        the factors field of the challenge message and gather whatever data is
        required for the chosen second-factor type, possibly using the
        associated challenge data. Finally, the client will send an AS-REQ
        containing a PA-SPAKE PA-DATA element using the response choice.<a class="pilcrow" href="#section-4.3-2">Â¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-4.3-3">
<pre>SPAKEResponse ::= SEQUENCE {
    pubkey      [0] OCTET STRING,
    factor      [1] EncryptedData, -- SPAKESecondFactor
    ...
}
</pre><a class="pilcrow" href="#section-4.3-3">Â¶</a>
</div>
<p id="section-4.3-4">The client and KDC will update the transcript hash with the pubkey
        value and use the resulting hash for all encryption key
        derivations.<a class="pilcrow" href="#section-4.3-4">Â¶</a></p>
<p id="section-4.3-5">The pubkey field indicates the client's public key S, serialized
        according to <a class="auto internal xref" href="#spakeparams">Section 5</a>.<a class="pilcrow" href="#section-4.3-5">Â¶</a></p>
<p id="section-4.3-6">The factor field indicates the client's chosen second-factor data.
        The key for this field is K'[1] (specified in <a class="auto internal xref" href="#keyderiv">Section 7</a>). The kvno field of the EncryptedData sequence is
        omitted. The key usage number for the encryption is
        KEY_USAGE_SPAKE. The plaintext inside the EncryptedData is an encoding
        of the SPAKESecondFactor. Once decoded, the SPAKESecondFactor provides the
        type of the second factor and any optional data used. The contents of
        the data field will depend on the second-factor type chosen. The client
        <span class="bcp14">MUST NOT</span> send a response containing a second-factor type that was not
        listed in the factors field of the challenge message.<a class="pilcrow" href="#section-4.3-6">Â¶</a></p>
<p id="section-4.3-7">When the KDC receives the response message from the client, it
        deserializes the client's public key S, and computes the shared group
        element K=x*(S-w*N). The KDC derives K'[1] and decrypts the factors
        field. If decryption is successful, the first factor is successfully
        validated. The KDC then validates the second factor. If either factor
        fails to validate, the KDC <span class="bcp14">MUST</span> respond with a KDC_ERR_PREAUTH_FAILED
        error.<a class="pilcrow" href="#section-4.3-7">Â¶</a></p>
<p id="section-4.3-8">If validation of the second factor requires further round trips, the
        KDC <span class="bcp14">MUST</span> reply to the client with a KDC_ERR_MORE_PREAUTH_DATA_REQUIRED error
        containing a PA-SPAKE PA-DATA element using the encdata choice. The
        kvno field of the EncryptedData sequence is omitted. The key for the
        EncryptedData value is K'[2] (specified in <a class="auto internal xref" href="#keyderiv">Section 7</a>),
        and the key usage number is KEY_USAGE_SPAKE. The plaintext of this
        message contains a DER-encoded SPAKESecondFactor message. As before,
        the type field of this message will contain the second-factor type and
        the data field will, optionally, contain data specific to the second-factor type.<a class="pilcrow" href="#section-4.3-8">Â¶</a></p>
</section>
<section id="section-4.4">
        <h3 id="name-subsequent-passes">
<a class="section-number selfRef" href="#section-4.4">4.4. </a><a class="section-name selfRef" href="#name-subsequent-passes">Subsequent Passes</a>
        </h3>
<p id="section-4.4-1">Any number of additional round trips may occur using the encdata
        choice. The contents of the plaintexts are specific to the second-factor type.

 If a client receives a PA-SPAKE PA-DATA element using the
        encdata choice from the KDC, it <span class="bcp14">MUST</span> reply with a subsequent AS-REQ
        with a PA-SPAKE PA-DATA element using the encdata choice or abort the AS
        exchange.<a class="pilcrow" href="#section-4.4-1">Â¶</a></p>
<p id="section-4.4-2">The key for client-originated encdata messages in subsequent passes
        is K'[3] (specified in <a class="auto internal xref" href="#keyderiv">Section 7</a>) for the first
        subsequent pass, K'[5] for the second, and so on. The key for
        KDC-originated encdata messages is K'[4] for the first subsequent
        pass, K'[6] for the second, and so on.<a class="pilcrow" href="#section-4.4-2">Â¶</a></p>
</section>
<section id="section-4.5">
        <h3 id="name-reply-key-strengthening">
<a class="section-number selfRef" href="#section-4.5">4.5. </a><a class="section-name selfRef" href="#name-reply-key-strengthening">Reply Key Strengthening</a>
        </h3>
<p id="section-4.5-1">When the KDC has successfully validated both factors, the reply key
        is strengthened and the mechanism is complete.  The strengthening of
        the reply key is accomplished by the client and KDC replacing it with
        K'[0] (as specified in <a class="auto internal xref" href="#keyderiv">Section 7</a>). The KDC then replies
        with a KDC-REP message or continues on to the next mechanism in the
        authentication set. There is no final PA-SPAKE PA-DATA message from
        the KDC to the client.<a class="pilcrow" href="#section-4.5-1">Â¶</a></p>
<p id="section-4.5-2">Reply key strengthening occurs only once: at the end of the exchange. The client and KDC <span class="bcp14">MUST</span> use the initial reply key as the
        base key for all K'[n] derivations.<a class="pilcrow" href="#section-4.5-2">Â¶</a></p>
</section>
<div id="optimizations">
<section id="section-4.6">
        <h3 id="name-optimizations">
<a class="section-number selfRef" href="#section-4.6">4.6. </a><a class="section-name selfRef" href="#name-optimizations">Optimizations</a>
        </h3>
<p id="section-4.6-1">The full protocol has two possible optimizations.<a class="pilcrow" href="#section-4.6-1">Â¶</a></p>
<p id="section-4.6-2">First, the KDC <span class="bcp14">MAY</span> reply to the initial AS-REQ (containing no
        pre-authentication data) with a PA-SPAKE PA-DATA element using the
        challenge choice instead of an empty padata-value. In this case, the
        KDC optimistically selects a group that the client may not
        support. If the group chosen by the challenge message is supported by
        the client, the client <span class="bcp14">MUST</span> skip to the third pass by issuing an
        AS-REQ with a PA-SPAKE message using the response choice. In this case,
        no SPAKESupport message is sent by the client, so the first update to
        the transcript hash contains only the KDC's optimistic challenge. If
        the KDC's chosen group is not supported by the client, the client <span class="bcp14">MUST</span>
        continue to the second pass. In this case, both the client and KDC <span class="bcp14">MUST</span>
        reinitialize the transcript hash for the client's support message.
        Clients <span class="bcp14">MUST</span> support this optimization.<a class="pilcrow" href="#section-4.6-2">Â¶</a></p>
<p id="section-4.6-3">Second, clients <span class="bcp14">MAY</span> skip the first pass and send an AS-REQ with a
        PA-SPAKE PA-DATA element using the support choice. If the KDC accepts
        the support message and generates a challenge, it <span class="bcp14">MUST</span> include a
        PA-ETYPE-INFO2 value within the METHOD-DATA of the
        KDC_ERR_MORE_PREAUTH_DATA_REQUIRED error response, as the client may
        not otherwise be able to compute the initial reply key. If the KDC
        cannot continue with SPAKE (either because the initial reply key type is
        incompatible with SPAKE or because it does not support any of the
        client's groups) but can offer other pre-authentication mechanisms, the KDC
        <span class="bcp14">MUST</span> respond with a KDC_ERR_PREAUTH_FAILED error containing METHOD-DATA
        for the available mechanisms. A client supporting this optimization
        <span class="bcp14">MUST</span> continue after a KDC_ERR_PREAUTH_FAILED error as described in
        <span><a class="relref" href="https://rfc-editor.org/rfc/rfc6113#section-2">Section 2</a> of [<a class="cite xref" href="#RFC6113">RFC6113</a>]</span>. KDCs <span class="bcp14">MUST</span> support this
        optimization.<a class="pilcrow" href="#section-4.6-3">Â¶</a></p>
</section>
</div>
</section>
<div id="spakeparams">
<section id="section-5">
      <h2 id="name-spake-parameters-and-conver">
<a class="section-number selfRef" href="#section-5">5. </a><a class="section-name selfRef" href="#name-spake-parameters-and-conver">SPAKE Parameters and Conversions</a>
      </h2>
<p id="section-5-1">Group elements are converted to and from octet strings using the
      serialization method defined in the "Kerberos SPAKE Groups" registry
       (see <a class="auto internal xref" href="#SPAKE-Groups">Section 12.2</a>).<a class="pilcrow" href="#section-5-1">Â¶</a></p>
<p id="section-5-2">The SPAKE algorithm requires constants M and N for each group. These
      constants are defined in the "Kerberos SPAKE Groups" registry
      (see <a class="auto internal xref" href="#SPAKE-Groups">Section 12.2</a>).<a class="pilcrow" href="#section-5-2">Â¶</a></p>
<p id="section-5-3">The SPAKE algorithm requires a shared secret input w to be used as a
      scalar multiplier. This value <span class="bcp14">MUST</span> be produced from the initial reply key
      as follows:<a class="pilcrow" href="#section-5-3">Â¶</a></p>
<ol class="normal type-1" id="section-5-4" start="1" type="1">
        <li id="section-5-4.1">Determine the length of the multiplier octet string as defined in
        the "Kerberos SPAKE Groups" registry (see <a class="auto internal xref" href="#SPAKE-Groups">Section 12.2</a>).<a class="pilcrow" href="#section-5-4.1">Â¶</a>
</li>
        <li id="section-5-4.2">Compose a pepper string by concatenating the string "SPAKEsecret"
        and the group number as a big-endian four-byte two's complement binary
        number.<a class="pilcrow" href="#section-5-4.2">Â¶</a>
</li>
        <li id="section-5-4.3">Produce an octet string of the required length using PRF+(K,
        pepper), where K is the initial reply key and PRF+ is as defined in
        <span><a class="relref" href="https://rfc-editor.org/rfc/rfc6113#section-5.1">Section 5.1</a> of [<a class="cite xref" href="#RFC6113">RFC6113</a>]</span>.<a class="pilcrow" href="#section-5-4.3">Â¶</a>
</li>
        <li id="section-5-4.4">Convert the octet string to a multiplier scalar using the
        multiplier conversion method defined in the "Kerberos SPAKE
        Groups" registry (see <a class="auto internal xref" href="#SPAKE-Groups">Section 12.2</a>).<a class="pilcrow" href="#section-5-4.4">Â¶</a>
</li>
      </ol>
<p id="section-5-5">The KDC chooses a secret scalar value x and the client chooses a
      secret scalar value y. As required by the SPAKE algorithm, these values
      are chosen randomly and uniformly. The KDC and client <span class="bcp14">MUST NOT</span> reuse x
      or y values for authentications involving different initial reply
      keys (see <a class="auto internal xref" href="#kdcstate">Section 10.4</a>).<a class="pilcrow" href="#section-5-5">Â¶</a></p>
</section>
</div>
<div id="transcript">
<section id="section-6">
      <h2 id="name-transcript-hash">
<a class="section-number selfRef" href="#section-6">6. </a><a class="section-name selfRef" href="#name-transcript-hash">Transcript Hash</a>
      </h2>
<p id="section-6-1">The transcript hash is an octet string of length equal to the output
      length of the hash function associated with the selected group. All bits are set to zero in the initial value.<a class="pilcrow" href="#section-6-1">Â¶</a></p>
<p id="section-6-2">When the transcript hash is updated with an octet string input, the
      new value is the hash function computed over the concatenation of the
      old value and the input.<a class="pilcrow" href="#section-6-2">Â¶</a></p>
<p id="section-6-3">In the normal message flow or with the second optimization described
      in <a class="auto internal xref" href="#optimizations">Section 4.6</a>, the transcript hash is:<a class="pilcrow" href="#section-6-3">Â¶</a></p>
<ol class="normal type-1" id="section-6-4" start="1" type="1">
<li id="section-6-4.1">updated
      with the concatenation of the client's support message and the KDC's
      challenge, then<a class="pilcrow" href="#section-6-4.1">Â¶</a>
</li>
        <li id="section-6-4.2">updated a second time with the client's pubkey
      value.<a class="pilcrow" href="#section-6-4.2">Â¶</a>
</li>
      </ol>
<p id="section-6-5">Therefore, it incorporates the client's supported groups, the
      KDC's chosen group, the KDC's initial second-factor messages, and the
      client and KDC public values. Once the transcript hash is finalized, it
      is used without change for all key derivations (<a class="auto internal xref" href="#keyderiv">Section 7</a>). In particular, encrypted second-factor messages are
      not included in the transcript hash.<a class="pilcrow" href="#section-6-5">Â¶</a></p>
<p id="section-6-6">If the first optimization described in <a class="auto internal xref" href="#optimizations">Section 4.6</a>
      is used successfully, the transcript hash is first updated with the
      KDC's challenge message and updated a second time with the client's pubkey value.<a class="pilcrow" href="#section-6-6">Â¶</a></p>
<p id="section-6-7">If the first optimization is used unsuccessfully (i.e., the client does
      not accept the KDC's selected group), the transcript hash is computed as
      in the normal message flow, without including the KDC's optimistic
      challenge.<a class="pilcrow" href="#section-6-7">Â¶</a></p>
</section>
</div>
<div id="keyderiv">
<section id="section-7">
      <h2 id="name-key-derivation">
<a class="section-number selfRef" href="#section-7">7. </a><a class="section-name selfRef" href="#name-key-derivation">Key Derivation</a>
      </h2>
<p id="section-7-1">Implementations <span class="bcp14">MUST NOT</span> use the shared group element (denoted by K)
      directly for any cryptographic operation. Instead, the SPAKE result is
      used to derive keys K'[n] (defined in this section).<a class="pilcrow" href="#section-7-1">Â¶</a></p>
<p id="section-7-2">First, compute the hash function associated with the selected group
      over the concatenation of the following values:<a class="pilcrow" href="#section-7-2">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-7-3.1">The fixed string "SPAKEkey".<a class="pilcrow" href="#section-7-3.1">Â¶</a>
</li>
        <li class="normal" id="section-7-3.2">The group number as a big-endian four-byte two's complement binary
        number.<a class="pilcrow" href="#section-7-3.2">Â¶</a>
</li>
        <li class="normal" id="section-7-3.3">The encryption type of the initial reply key as a big-endian
        four-byte two's complement binary number.<a class="pilcrow" href="#section-7-3.3">Â¶</a>
</li>
        <li class="normal" id="section-7-3.4">The PRF+ output used to compute the initial secret input w (as specified in <a class="auto internal xref" href="#spakeparams">Section 5</a>).<a class="pilcrow" href="#section-7-3.4">Â¶</a>
</li>
        <li class="normal" id="section-7-3.5">The SPAKE result K, converted to an octet string (as specified in
        <a class="auto internal xref" href="#spakeparams">Section 5</a>).<a class="pilcrow" href="#section-7-3.5">Â¶</a>
</li>
        <li class="normal" id="section-7-3.6">The transcript hash.<a class="pilcrow" href="#section-7-3.6">Â¶</a>
</li>
        <li class="normal" id="section-7-3.7">The KDC-REQ-BODY encoding for the request being sent or responded
        to. Within a FAST channel, the inner KDC-REQ-BODY encoding <span class="bcp14">MUST</span> be
        used.<a class="pilcrow" href="#section-7-3.7">Â¶</a>
</li>
        <li class="normal" id="section-7-3.8">The value n as a big-endian, four-byte, and unsigned binary number.<a class="pilcrow" href="#section-7-3.8">Â¶</a>
</li>
        <li class="normal" id="section-7-3.9">A single-byte block counter with the initial value 0x01.<a class="pilcrow" href="#section-7-3.9">Â¶</a>
</li>
      </ul>
<p id="section-7-4">
      If the hash output is too small for the encryption type's key generation
      seed length, the block counter value is incremented and the hash
      function is recomputed to produce as many blocks as are required. The
      result is truncated to the key generation seed length, and the
      random-to-key function is used to produce an intermediate key with the
      same encryption type as the initial reply key.<a class="pilcrow" href="#section-7-4">Â¶</a></p>
<p id="section-7-5">The key K'[n] has the same encryption type as the initial reply key,
      and has the value KRB-FX-CF2(initial-reply-key, intermediate-key,
      "SPAKE", "keyderiv"), where KRB-FX-CF2 is defined in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc6113#section-5.1">Section 5.1</a> of [<a class="cite xref" href="#RFC6113">RFC6113</a>]</span>.<a class="pilcrow" href="#section-7-5">Â¶</a></p>
</section>
</div>
<section id="section-8">
      <h2 id="name-second-factor-types">
<a class="section-number selfRef" href="#section-8">8. </a><a class="section-name selfRef" href="#name-second-factor-types">Second-Factor Types</a>
      </h2>
<p id="section-8-1">This document defines one second-factor type:<a class="pilcrow" href="#section-8-1">Â¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-8-2">
        <dt id="section-8-2.1">SF-NONE</dt>
        <dd id="section-8-2.2" style="margin-left: 1.5em">1<a class="pilcrow" href="#section-8-2.2">Â¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-8-3">This second-factor type indicates that no second factor is used.
      Whenever a SPAKESecondFactor is used with SF-NONE, the data field <span class="bcp14">MUST</span> be
      omitted. The SF-NONE second factor always successfully validates.<a class="pilcrow" href="#section-8-3">Â¶</a></p>
</section>
<section id="section-9">
      <h2 id="name-hint-for-authentication-set">
<a class="section-number selfRef" href="#section-9">9. </a><a class="section-name selfRef" href="#name-hint-for-authentication-set">Hint for Authentication Sets</a>
      </h2>
<p id="section-9-1">If a KDC offers SPAKE pre-authentication as part of an authentication
      set (<span><a class="relref" href="https://rfc-editor.org/rfc/rfc6113#section-5.3">Section 5.3</a> of [<a class="cite xref" href="#RFC6113">RFC6113</a>]</span>), it <span class="bcp14">SHOULD</span> provide a
      pa-hint value containing the DER encoding of the ASN.1 type
      PA-SPAKE-HINT. This helps the client determine whether SPAKE
      pre-authentication is likely to succeed if the authentication set is
      chosen.<a class="pilcrow" href="#section-9-1">Â¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-9-2">
<pre>PA-SPAKE-HINT ::= SEQUENCE {
    groups      [0] SEQUENCE (SIZE(1..MAX)) OF Int32,
    factors     [1] SEQUENCE (SIZE(1..MAX)) OF SPAKESecondFactor
}
</pre><a class="pilcrow" href="#section-9-2">Â¶</a>
</div>
<p id="section-9-3">The groups field indicates the KDC's supported groups. The factors
      field indicates the KDC's supported second factors. The KDC <span class="bcp14">MAY</span> omit the
      data field of values in the factors list.<a class="pilcrow" href="#section-9-3">Â¶</a></p>
<p id="section-9-4">A KDC <span class="bcp14">MUST NOT</span> include a PA-SPAKE-HINT message directly in a pa-value
      field; hints must only be provided within authentication sets. A KDC
      <span class="bcp14">SHOULD</span> include a hint if SPAKE pre-authentication is offered as the
      second or later element of an authentication set.<a class="pilcrow" href="#section-9-4">Â¶</a></p>
<p id="section-9-5">The PA-SPAKE-HINT message is not part of the transcript, and it does not
      replace any part of the SPAKE message flow.<a class="pilcrow" href="#section-9-5">Â¶</a></p>
</section>
<section id="section-10">
      <h2 id="name-security-considerations">
<a class="section-number selfRef" href="#section-10">10. </a><a class="section-name selfRef" href="#name-security-considerations">Security Considerations</a>
      </h2>
<section id="section-10.1">
        <h3 id="name-spake-computations">
<a class="section-number selfRef" href="#section-10.1">10.1. </a><a class="section-name selfRef" href="#name-spake-computations">SPAKE Computations</a>
        </h3>
<p id="section-10.1-1">The deserialized public keys S and T <span class="bcp14">MUST</span> be verified to be elements
        of the group to prevent invalid curve attacks. It is not necessary to
        verify that they are members of the prime-order subgroup; the
        computation of K by both parties involves a multiplication by the
        cofactor h.<a class="pilcrow" href="#section-10.1-1">Â¶</a></p>
<p id="section-10.1-2">The aforementioned cofactor multiplication is accomplished by
        choosing private scalars x and y, which are divisible by the
        cofactor. If the client or KDC chooses a scalar that might not be
        divisible by the cofactor, an attacker might be able to coerce values
        of K that are not members of the prime-order subgroup and deduce a
        limited amount of information about w from the order of K.<a class="pilcrow" href="#section-10.1-2">Â¶</a></p>
<p id="section-10.1-3">The scalars x and y <span class="bcp14">MUST</span> be chosen uniformly. They <span class="bcp14">MUST NOT</span> be reused
        for different initial reply keys. If an x or y value is reused for
        pre-authentications involving two different initial reply keys, an
        attacker who observes both authentications and knows one of the initial
        reply keys can conduct an offline dictionary attack to recover the
        other one.<a class="pilcrow" href="#section-10.1-3">Â¶</a></p>
<p id="section-10.1-4">The M and N values for a group <span class="bcp14">MUST NOT</span> have known discrete logs. An
        attacker who knows the discrete log of M or N can perform an offline
        dictionary attack on passwords. Therefore, it is important to
        demonstrate that the M and N values for each group were computed
        without multiplying a known value by the generator P.<a class="pilcrow" href="#section-10.1-4">Â¶</a></p>
</section>
<div id="unauthtext">
<section id="section-10.2">
        <h3 id="name-unauthenticated-plaintext">
<a class="section-number selfRef" href="#section-10.2">10.2. </a><a class="section-name selfRef" href="#name-unauthenticated-plaintext">Unauthenticated Plaintext</a>
        </h3>
<p id="section-10.2-1">This mechanism includes unauthenticated plaintext in the support and
        challenge messages. Beginning with the third pass, the integrity of
        this plaintext is ensured by incorporating the transcript hash into
        the derivation of the final reply key and second-factor encryption
        keys. Downgrade attacks on support and challenge messages will result
        in the client and KDC deriving different reply keys and EncryptedData
        keys. The KDC-REQ-BODY contents are also incorporated into key
        derivation, ensuring their integrity. The unauthenticated plaintext in
        the KDC-REP message is not protected by this mechanism.<a class="pilcrow" href="#section-10.2-1">Â¶</a></p>
<p id="section-10.2-2">Unless FAST is used, the factors field of a challenge message is not
        integrity protected until the response is verified. Second-factor types
        <span class="bcp14">MUST</span> account for this when specifying the semantics of the data
        field. In particular, second-factor data in the challenge should not be
        included in user prompts: it could be modified by an attacker to
        contain misleading or offensive information.<a class="pilcrow" href="#section-10.2-2">Â¶</a></p>
<p id="section-10.2-3">Unless FAST is used, the factors field of a challenge message is
        visible to an attacker, who can use it to determine whether a second
        factor is required for the client.<a class="pilcrow" href="#section-10.2-3">Â¶</a></p>
<p id="section-10.2-4">Subsequent factor data, including the data in the response, are
        encrypted in a derivative of the shared secret K. Therefore, it is not
        possible to exploit the untrustworthiness of the challenge to turn the
        client into an encryption or signing oracle for the second-factor
        credentials, unless the attacker knows the client's long-term key.<a class="pilcrow" href="#section-10.2-4">Â¶</a></p>
<p id="section-10.2-5">Unless FAST is used, any PA-SPAKE-HINT messages are unauthenticated
        and are not protected by the transcript hash if they are included when
        SPAKE is advertised in authentication sets. Since hints do not replace
        any part of the message flow, manipulation of hint messages can only
        affect the client's decision to use or not use an authentication set,
        which could more easily be accomplished by removing authentication
        sets entirely.<a class="pilcrow" href="#section-10.2-5">Â¶</a></p>
</section>
</div>
<section id="section-10.3">
        <h3 id="name-side-channels">
<a class="section-number selfRef" href="#section-10.3">10.3. </a><a class="section-name selfRef" href="#name-side-channels">Side Channels</a>
        </h3>
<p id="section-10.3-1">An implementation of the SPAKE pre-authentication mechanism can have
        the property of indistinguishability, meaning that an attacker who
        guesses a long-term key and a second-factor value cannot determine
        whether one of the factors was correct unless both are
        correct. Indistinguishability is only maintained if the second factor
        can be validated solely based on the data in the response; the use of
        additional round trips will reveal to the attacker whether the
        long-term key is correct.  Indistinguishability also requires that
        there are no side channels.

 When the KDC processes a response message, whether or not it decrypts
 the factor field, it must reply with the same error fields, take the
 same amount of time, and make the same observable communications to
 other servers.<a class="pilcrow" href="#section-10.3-1">Â¶</a></p>
<p id="section-10.3-2">Both the size of the EncryptedData and the number of EncryptedData
        messages used for second-factor data (including the factor field of the
        SPAKEResponse message and messages using the encdata PA-SPAKE choice)
        may reveal information about the second factor used in an
        authentication. Care should be taken to keep second-factor messages as
        small and as few as possible.<a class="pilcrow" href="#section-10.3-2">Â¶</a></p>
<p id="section-10.3-3">Any side channels in the creation of the shared secret input w, or
        in the multiplications wM and wN, could allow an attacker to recover
        the client long-term key. Implementations <span class="bcp14">MUST</span> take care to avoid side
        channels, particularly timing channels. Generation of the secret scalar
        values x and y need not take constant time, but the amount of time
        taken <span class="bcp14">MUST NOT</span> provide information about the resulting value.<a class="pilcrow" href="#section-10.3-3">Â¶</a></p>
<p id="section-10.3-4">The conversion of the scalar multiplier for the SPAKE w parameter
        may produce a multiplier that is larger than the order of the group.
        Some group implementations may be unable to handle such a multiplier.
        Others may silently accept such a multiplier but proceed to perform
        multiplication that is not constant time. This is only a minor risk in
        most commonly used groups, but it is a more serious risk for P-521 due to
        the extra seven high bits in the input octet string. A common solution
        to this problem is achieved by reducing the multiplier modulo the group
        order, taking care to ensure constant time operation.<a class="pilcrow" href="#section-10.3-4">Â¶</a></p>
</section>
<div id="kdcstate">
<section id="section-10.4">
        <h3 id="name-kdc-state">
<a class="section-number selfRef" href="#section-10.4">10.4. </a><a class="section-name selfRef" href="#name-kdc-state">KDC State</a>
        </h3>
<p id="section-10.4-1">A stateless KDC implementation generally must use a PA-FX-COOKIE
        value to remember its private scalar value x and the transcript hash.
        The KDC <span class="bcp14">MUST</span> maintain confidentiality and integrity of the cookie
        value, perhaps by encrypting it in a key known only to the realm's
        KDCs. Cookie values may be replayed by attackers, perhaps by splicing them
        into different SPAKE exchanges. The KDC <span class="bcp14">SHOULD</span> limit the time window of
        replays using a timestamp, and it <span class="bcp14">SHOULD</span> prevent cookie values from being
        applied to other pre-authentication mechanisms or other client
        principals. Within the validity period of a cookie, an attacker can
        replay the final message of a pre-authentication exchange to any of the
        realm's KDCs and make it appear that the client has authenticated.<a class="pilcrow" href="#section-10.4-1">Â¶</a></p>
<p id="section-10.4-2">The SPAKE pre-authentication mechanism is not designed to provide
        forward secrecy. Nevertheless, some measure of forward secrecy may
        result depending on implementation choices. A passive attacker who
        determines the client long-term key after the exchange generally will
        not be able to recover the ticket session key; however, an attacker who
        also determines the PA-FX-COOKIE encryption key (if the KDC uses an
        encrypted cookie) will be able to recover the ticket session key. If
        the KDC or client retains the x or y value for reuse with the same
        client long-term key, an attacker who recovers the x or y value and the
        long-term key will be able to recover the ticket session key.<a class="pilcrow" href="#section-10.4-2">Â¶</a></p>
</section>
</div>
<section id="section-10.5">
        <h3 id="name-dictionary-attacks">
<a class="section-number selfRef" href="#section-10.5">10.5. </a><a class="section-name selfRef" href="#name-dictionary-attacks">Dictionary Attacks</a>
        </h3>
<p id="section-10.5-1">Although the SPAKE pre-authentication mechanism is designed to
        prevent an offline dictionary attack by an active attacker posing as
        the KDC, such an attacker can attempt to downgrade the client to
        the encrypted timestamp pre-authentication mechanism. Client implementations <span class="bcp14">SHOULD</span> provide a
        configuration option to enable or disable the encrypted timestamp mechanism on a
        per-realm basis to mitigate this attack.<a class="pilcrow" href="#section-10.5-1">Â¶</a></p>
<p id="section-10.5-2">If the user enters the wrong password, the client might fall back
        to the encrypted timestamp mechanism after receiving a
        KDC_ERR_PREAUTH_FAILED error from the KDC, if the encrypted timestamp mechanism
        is offered by the KDC and not disabled by client configuration. This
        fallback will enable a passive attacker to mount an offline dictionary
        attack against the incorrect password, which may be similar to the
        correct password. Client implementations <span class="bcp14">SHOULD</span> assume
        that the encrypted timestamp and encrypted challenge mechanisms are unlikely to
        succeed if SPAKE pre-authentication fails in the second pass and
        SF-NONE was used.<a class="pilcrow" href="#section-10.5-2">Â¶</a></p>
<p id="section-10.5-3">Like any other pre-authentication mechanism using the client
        long-term key, the SPAKE pre-authentication mechanism does not prevent
        online password guessing attacks. The KDC is made aware of unsuccessful
        guesses and can apply facilities such as rate limiting to mitigate the
        risk of online attacks.<a class="pilcrow" href="#section-10.5-3">Â¶</a></p>
</section>
<section id="section-10.6">
        <h3 id="name-brute-force-attacks">
<a class="section-number selfRef" href="#section-10.6">10.6. </a><a class="section-name selfRef" href="#name-brute-force-attacks">Brute-Force Attacks</a>
        </h3>
<p id="section-10.6-1">The selected group's resistance to offline brute-force attacks may
        not correspond to the size of the reply key. For performance reasons, a
        KDC <span class="bcp14">MAY</span> select a group whose brute-force work factor is less than the
        reply key length. A passive attacker who solves the group discrete
        logarithm problem after the exchange will be able to conduct an offline
        attack against the client long-term key. Although the use of password
        policies and costly, salted string-to-key functions may increase the
        cost of such an attack, the resulting cost will likely not be higher
        than the cost of solving the group discrete logarithm.<a class="pilcrow" href="#section-10.6-1">Â¶</a></p>
</section>
<section id="section-10.7">
        <h3 id="name-denial-of-service-attacks">
<a class="section-number selfRef" href="#section-10.7">10.7. </a><a class="section-name selfRef" href="#name-denial-of-service-attacks">Denial-of-Service Attacks</a>
        </h3>
<p id="section-10.7-1">Elliptic curve group operations are more computationally expensive
        than secret-key operations. As a result, the use of this mechanism may
        affect the KDC's performance under normal load and its resistance to
        denial-of-service attacks.<a class="pilcrow" href="#section-10.7-1">Â¶</a></p>
</section>
<section id="section-10.8">
        <h3 id="name-reflection-attacks">
<a class="section-number selfRef" href="#section-10.8">10.8. </a><a class="section-name selfRef" href="#name-reflection-attacks">Reflection Attacks</a>
        </h3>
<p id="section-10.8-1">The encdata choice of PA-SPAKE can be used in either direction;
        the factor-specific plaintext does not necessarily indicate a
        direction. However, each encdata message is encrypted using a derived
        key K'[n], with client-originated messages using only odd values of n
        and KDC-originated messages using only even values. Therefore, an attempted
        reflection attack would result in a failed decryption.<a class="pilcrow" href="#section-10.8-1">Â¶</a></p>
</section>
<section id="section-10.9">
        <h3 id="name-reply-key-encryption-type">
<a class="section-number selfRef" href="#section-10.9">10.9. </a><a class="section-name selfRef" href="#name-reply-key-encryption-type">Reply Key Encryption Type</a>
        </h3>
<p id="section-10.9-1">This mechanism does not upgrade the encryption type of the initial
        reply key and relies on that encryption type for confidentiality,
        integrity, and pseudorandom functions. If the client long-term key
        uses a weak encryption type, an attacker might be able to subvert the
        exchange, and the replaced reply key will also be of the same weak
        encryption type.<a class="pilcrow" href="#section-10.9-1">Â¶</a></p>
</section>
<section id="section-10.10">
        <h3 id="name-kdc-authentication">
<a class="section-number selfRef" href="#section-10.10">10.10. </a><a class="section-name selfRef" href="#name-kdc-authentication">KDC Authentication</a>
        </h3>
<p id="section-10.10-1">This mechanism does not directly provide the KDC Authentication
        pre-authentication facility because it does not send a key
        confirmation from the KDC to the client. When used as a stand-alone
        mechanism, the preexisting KDC authentication provided by the KDC-REP
        enc-part still applies.<a class="pilcrow" href="#section-10.10-1">Â¶</a></p>
</section>
</section>
<section id="section-11">
      <h2 id="name-assigned-constants">
<a class="section-number selfRef" href="#section-11">11. </a><a class="section-name selfRef" href="#name-assigned-constants">Assigned Constants</a>
      </h2>
<p id="section-11-1">The following key usage values are assigned for this mechanism:<a class="pilcrow" href="#section-11-1">Â¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-11-2">
        <dt id="section-11-2.1">KEY_USAGE_SPAKE</dt>
        <dd id="section-11-2.2" style="margin-left: 1.5em">65<a class="pilcrow" href="#section-11-2.2">Â¶</a>
</dd>
      <dd class="break"></dd>
</dl>
</section>
<section id="section-12">
      <h2 id="name-iana-considerations">
<a class="section-number selfRef" href="#section-12">12. </a><a class="section-name selfRef" href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<p id="section-12-1">IANA has assigned the following number for PA-SPAKE in the
      "Pre-authentication and Typed Data" registry:<a class="pilcrow" href="#section-12-1">Â¶</a></p>
<table class="center" id="table-1">
        <caption><a class="selfRef" href="#table-1">Table 1</a></caption>
<thead>
          <tr>
            <th class="text-left" colspan="1" rowspan="1">Type</th>
            <th class="text-left" colspan="1" rowspan="1">Value</th>
            <th class="text-left" colspan="1" rowspan="1">Reference</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">PA-SPAKE</td>
            <td class="text-left" colspan="1" rowspan="1">151</td>
            <td class="text-left" colspan="1" rowspan="1">RFC 9588</td>
          </tr>
        </tbody>
      </table>
<p id="section-12-3">This document establishes two registries (see Sections <a class="auto internal xref" href="#Second-Factor">12.1</a> and <a class="auto internal xref" href="#SPAKE-Groups">12.2</a>) with the following
      procedure, in accordance with <span>[<a class="cite xref" href="#RFC8126">RFC8126</a>]</span>:<a class="pilcrow" href="#section-12-3">Â¶</a></p>
<p id="section-12-4">Registry entries are to be evaluated using the Specification
      Required method. All specifications must be published prior
      to entry inclusion in the registry. Once published, they can be
      submitted directly to the krb5-spake-review@ietf.org mailing
      list, where there will be a three-week-long review period by
      designated experts.<a class="pilcrow" href="#section-12-4">Â¶</a></p>
<p id="section-12-5">The designated experts ensure that the specification is publicly
      available. They may provide additional in-depth
      reviews, but their approval should not be taken as endorsement of the
      specification.<a class="pilcrow" href="#section-12-5">Â¶</a></p>
<p id="section-12-6">Prior to the end of the review period, the designated experts
      must approve or deny the request. This decision is conveyed to
      both IANA and the submitter. Since the mailing list archives are
      not public, it should include both a reasonably detailed
      explanation in the case of a denial as well as whether the
      request can be resubmitted.<a class="pilcrow" href="#section-12-6">Â¶</a></p>
<p id="section-12-7">IANA must only accept registry updates from the designated experts
      and should direct all requests for registration to the review mailing
      list.<a class="pilcrow" href="#section-12-7">Â¶</a></p>
<div id="Second-Factor">
<section id="section-12.1">
        <h3 id="name-kerberos-second-factor-type">
<a class="section-number selfRef" href="#section-12.1">12.1. </a><a class="section-name selfRef" href="#name-kerberos-second-factor-type">Kerberos Second-Factor Types</a>
        </h3>
<p id="section-12.1-1">This section specifies the "Kerberos Second-Factor Types"
        registry, which records the number, name, and reference for
        each second-factor protocol.<a class="pilcrow" href="#section-12.1-1">Â¶</a></p>
<section id="section-12.1.1">
          <h4 id="name-registration-template">
<a class="section-number selfRef" href="#section-12.1.1">12.1.1. </a><a class="section-name selfRef" href="#name-registration-template">Registration Template</a>
          </h4>
<span class="break"></span><dl class="dlParallel" id="section-12.1.1-1">
            <dt id="section-12.1.1-1.1">ID Number:</dt>
            <dd id="section-12.1.1-1.2" style="margin-left: 1.5em">
                A value that uniquely identifies this entry.  It is a
                signed integer in the range -2147483648 to 2147483647, inclusive.
                Positive values must be assigned only for algorithms specified
                in accordance with these rules for use with Kerberos and
                related protocols.  Negative values should be used for private
                and experimental algorithms only.  Zero is reserved and must
                not be assigned.  Values should be assigned in increasing
                order.<a class="pilcrow" href="#section-12.1.1-1.2">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-12.1.1-1.3">Name:</dt>
            <dd id="section-12.1.1-1.4" style="margin-left: 1.5em">A brief, unique, human-readable name for this algorithm.<a class="pilcrow" href="#section-12.1.1-1.4">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-12.1.1-1.5">Reference:</dt>
            <dd id="section-12.1.1-1.6" style="margin-left: 1.5em">
                A URI or otherwise unique identifier for where the details of
                this algorithm can be found.  It should be as specific as
                reasonably possible.<a class="pilcrow" href="#section-12.1.1-1.6">Â¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
<section id="section-12.1.2">
          <h4 id="name-initial-registry-contents">
<a class="section-number selfRef" href="#section-12.1.2">12.1.2. </a><a class="section-name selfRef" href="#name-initial-registry-contents">Initial Registry Contents</a>
          </h4>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-12.1.2-1">
            <dt id="section-12.1.2-1.1">ID Number:</dt>
            <dd id="section-12.1.2-1.2" style="margin-left: 1.5em">0<a class="pilcrow" href="#section-12.1.2-1.2">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-12.1.2-1.3">Name:</dt>
            <dd id="section-12.1.2-1.4" style="margin-left: 1.5em">Reserved<a class="pilcrow" href="#section-12.1.2-1.4">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-12.1.2-1.5">Reference:</dt>
            <dd id="section-12.1.2-1.6" style="margin-left: 1.5em">RFC 9588<a class="pilcrow" href="#section-12.1.2-1.6">Â¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-12.1.2-2">
            <dt id="section-12.1.2-2.1">ID Number:</dt>
            <dd id="section-12.1.2-2.2" style="margin-left: 1.5em">1<a class="pilcrow" href="#section-12.1.2-2.2">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-12.1.2-2.3">Name:</dt>
            <dd id="section-12.1.2-2.4" style="margin-left: 1.5em">SF-NONE<a class="pilcrow" href="#section-12.1.2-2.4">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-12.1.2-2.5">Reference:</dt>
            <dd id="section-12.1.2-2.6" style="margin-left: 1.5em">RFC 9588<a class="pilcrow" href="#section-12.1.2-2.6">Â¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</section>
</div>
<div id="SPAKE-Groups">
<section id="section-12.2">
        <h3 id="name-kerberos-spake-groups">
<a class="section-number selfRef" href="#section-12.2">12.2. </a><a class="section-name selfRef" href="#name-kerberos-spake-groups">Kerberos SPAKE Groups</a>
        </h3>
<p id="section-12.2-1">This section specifies the "Kerberos SPAKE Groups" registry, which
        records the number, name, specification, serialization,
        multiplier length, multiplier conversion, SPAKE M and N constants, and
        associated hash function for each SPAKE Group.<a class="pilcrow" href="#section-12.2-1">Â¶</a></p>
<section id="section-12.2.1">
          <h4 id="name-registration-template-2">
<a class="section-number selfRef" href="#section-12.2.1">12.2.1. </a><a class="section-name selfRef" href="#name-registration-template-2">Registration Template</a>
          </h4>
<span class="break"></span><dl class="dlParallel" id="section-12.2.1-1">
            <dt id="section-12.2.1-1.1">ID Number:</dt>
            <dd id="section-12.2.1-1.2" style="margin-left: 1.5em">
                A value that uniquely identifies this entry.  It is a
                signed integer in the range -2147483648 to 2147483647, inclusive.
                Positive values must be assigned only for algorithms specified in
                accordance with these rules for use with Kerberos and related
                protocols.  Negative values should be used for private and
                experimental use only.  Zero is reserved and must not be
                assigned.  Values should be assigned in increasing order.<a class="pilcrow" href="#section-12.2.1-1.2">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-12.2.1-1.3">Name:</dt>
            <dd id="section-12.2.1-1.4" style="margin-left: 1.5em">
                A brief, unique, human-readable name for this entry.<a class="pilcrow" href="#section-12.2.1-1.4">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-12.2.1-1.5">Specification:</dt>
            <dd id="section-12.2.1-1.6" style="margin-left: 1.5em">
                A reference to the definition of the group parameters and operations.<a class="pilcrow" href="#section-12.2.1-1.6">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-12.2.1-1.7">Serialization:</dt>
            <dd id="section-12.2.1-1.8" style="margin-left: 1.5em">
                A reference to the definition of the method used to serialize
                and deserialize group elements.<a class="pilcrow" href="#section-12.2.1-1.8">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-12.2.1-1.9">Multiplier Length:</dt>
            <dd id="section-12.2.1-1.10" style="margin-left: 1.5em">
                The length of the input octet string to multiplication operations.<a class="pilcrow" href="#section-12.2.1-1.10">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-12.2.1-1.11">Multiplier Conversion:</dt>
            <dd id="section-12.2.1-1.12" style="margin-left: 1.5em">
                A reference to the definition of the method used to convert an
                octet string to a multiplier scalar.<a class="pilcrow" href="#section-12.2.1-1.12">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-12.2.1-1.13">SPAKE M Constant:</dt>
            <dd id="section-12.2.1-1.14" style="margin-left: 1.5em">
                The serialized value of the SPAKE M constant in hexadecimal notation.<a class="pilcrow" href="#section-12.2.1-1.14">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-12.2.1-1.15">SPAKE N Constant:</dt>
            <dd id="section-12.2.1-1.16" style="margin-left: 1.5em">
                The serialized value of the SPAKE N constant in hexadecimal notation.<a class="pilcrow" href="#section-12.2.1-1.16">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-12.2.1-1.17">Hash Function:</dt>
            <dd id="section-12.2.1-1.18" style="margin-left: 1.5em">
                The group's associated hash function.<a class="pilcrow" href="#section-12.2.1-1.18">Â¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
<section id="section-12.2.2">
          <h4 id="name-initial-registry-contents-2">
<a class="section-number selfRef" href="#section-12.2.2">12.2.2. </a><a class="section-name selfRef" href="#name-initial-registry-contents-2">Initial Registry Contents</a>
          </h4>
<section id="section-12.2.2.1">
            <h5 id="name-edwards-25519">
<a class="section-number selfRef" href="#section-12.2.2.1">12.2.2.1. </a><a class="section-name selfRef" href="#name-edwards-25519">Edwards 25519</a>
            </h5>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-12.2.2.1-1">
              <dt id="section-12.2.2.1-1.1">ID Number:</dt>
              <dd id="section-12.2.2.1-1.2" style="margin-left: 1.5em">1<a class="pilcrow" href="#section-12.2.2.1-1.2">Â¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-12.2.2.1-1.3">Name:</dt>
              <dd id="section-12.2.2.1-1.4" style="margin-left: 1.5em">edwards25519<a class="pilcrow" href="#section-12.2.2.1-1.4">Â¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-12.2.2.1-1.5">Specification:</dt>
              <dd id="section-12.2.2.1-1.6" style="margin-left: 1.5em">
                <span><a class="relref" href="https://rfc-editor.org/rfc/rfc7748#section-4.1">Section 4.1</a> of [<a class="cite xref" href="#RFC7748">RFC7748</a>]</span> (edwards25519)<a class="pilcrow" href="#section-12.2.2.1-1.6">Â¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-12.2.2.1-1.7">Serialization:</dt>
              <dd id="section-12.2.2.1-1.8" style="margin-left: 1.5em">
                <span><a class="relref" href="https://rfc-editor.org/rfc/rfc8032#section-3.1">Section 3.1</a> of [<a class="cite xref" href="#RFC8032">RFC8032</a>]</span><a class="pilcrow" href="#section-12.2.2.1-1.8">Â¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-12.2.2.1-1.9">Multiplier Length:</dt>
              <dd id="section-12.2.2.1-1.10" style="margin-left: 1.5em">32<a class="pilcrow" href="#section-12.2.2.1-1.10">Â¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-12.2.2.1-1.11">Multiplier Conversion:</dt>
              <dd id="section-12.2.2.1-1.12" style="margin-left: 1.5em">
                <span><a class="relref" href="https://rfc-editor.org/rfc/rfc8032#section-3.1">Section 3.1</a> of [<a class="cite xref" href="#RFC8032">RFC8032</a>]</span><a class="pilcrow" href="#section-12.2.2.1-1.12">Â¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-12.2.2.1-1.13">SPAKE M Constant:</dt>
              <dd id="section-12.2.2.1-1.14" style="margin-left: 1.5em">d048032c6ea0b6d697ddc2e86bda85a33adac920f1bf18e1b0c6d166a5cecdaf<a class="pilcrow" href="#section-12.2.2.1-1.14">Â¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-12.2.2.1-1.15">SPAKE N Constant:</dt>
              <dd id="section-12.2.2.1-1.16" style="margin-left: 1.5em">d3bfb518f44f3430f29d0c92af503865a1ed3281dc69b35dd868ba85f886c4ab<a class="pilcrow" href="#section-12.2.2.1-1.16">Â¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-12.2.2.1-1.17">Hash function:</dt>
              <dd id="section-12.2.2.1-1.18" style="margin-left: 1.5em">SHA-256 <span>[<a class="cite xref" href="#RFC6234">RFC6234</a>]</span><a class="pilcrow" href="#section-12.2.2.1-1.18">Â¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</section>
<section id="section-12.2.2.2">
            <h5 id="name-p-256">
<a class="section-number selfRef" href="#section-12.2.2.2">12.2.2.2. </a><a class="section-name selfRef" href="#name-p-256">P-256</a>
            </h5>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-12.2.2.2-1">
              <dt id="section-12.2.2.2-1.1">ID Number:</dt>
              <dd id="section-12.2.2.2-1.2" style="margin-left: 1.5em">2<a class="pilcrow" href="#section-12.2.2.2-1.2">Â¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-12.2.2.2-1.3">Name:</dt>
              <dd id="section-12.2.2.2-1.4" style="margin-left: 1.5em">P-256<a class="pilcrow" href="#section-12.2.2.2-1.4">Â¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-12.2.2.2-1.5">Specification:</dt>
              <dd id="section-12.2.2.2-1.6" style="margin-left: 1.5em">Section 2.4.2 of <span>[<a class="cite xref" href="#SEC2">SEC2</a>]</span><a class="pilcrow" href="#section-12.2.2.2-1.6">Â¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-12.2.2.2-1.7">Serialization:</dt>
              <dd id="section-12.2.2.2-1.8" style="margin-left: 1.5em">Section 2.3.3 of <span>[<a class="cite xref" href="#SEC1">SEC1</a>]</span> (compressed format)<a class="pilcrow" href="#section-12.2.2.2-1.8">Â¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-12.2.2.2-1.9">Multiplier Length:</dt>
              <dd id="section-12.2.2.2-1.10" style="margin-left: 1.5em">32<a class="pilcrow" href="#section-12.2.2.2-1.10">Â¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-12.2.2.2-1.11">Multiplier Conversion:</dt>
              <dd id="section-12.2.2.2-1.12" style="margin-left: 1.5em">Section 2.3.8 of <span>[<a class="cite xref" href="#SEC1">SEC1</a>]</span><a class="pilcrow" href="#section-12.2.2.2-1.12">Â¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-12.2.2.2-1.13">SPAKE M Constant:</dt>
              <dd id="section-12.2.2.2-1.14" style="margin-left: 1.5em">02886e2f97ace46e55ba9dd7242579f2993b64e16ef3dcab95afd497333d8fa12f<a class="pilcrow" href="#section-12.2.2.2-1.14">Â¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-12.2.2.2-1.15">SPAKE N Constant:</dt>
              <dd id="section-12.2.2.2-1.16" style="margin-left: 1.5em">03d8bbd6c639c62937b04d997f38c3770719c629d7014d49a24b4f98baa1292b49<a class="pilcrow" href="#section-12.2.2.2-1.16">Â¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-12.2.2.2-1.17">Hash function:</dt>
              <dd id="section-12.2.2.2-1.18" style="margin-left: 1.5em">SHA-256 <span>[<a class="cite xref" href="#RFC6234">RFC6234</a>]</span><a class="pilcrow" href="#section-12.2.2.2-1.18">Â¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</section>
<section id="section-12.2.2.3">
            <h5 id="name-p-384">
<a class="section-number selfRef" href="#section-12.2.2.3">12.2.2.3. </a><a class="section-name selfRef" href="#name-p-384">P-384</a>
            </h5>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-12.2.2.3-1">
              <dt id="section-12.2.2.3-1.1">ID Number:</dt>
              <dd id="section-12.2.2.3-1.2" style="margin-left: 1.5em">3<a class="pilcrow" href="#section-12.2.2.3-1.2">Â¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-12.2.2.3-1.3">Name:</dt>
              <dd id="section-12.2.2.3-1.4" style="margin-left: 1.5em">P-384<a class="pilcrow" href="#section-12.2.2.3-1.4">Â¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-12.2.2.3-1.5">Specification:</dt>
              <dd id="section-12.2.2.3-1.6" style="margin-left: 1.5em">Section 2.5.1 of <span>[<a class="cite xref" href="#SEC2">SEC2</a>]</span><a class="pilcrow" href="#section-12.2.2.3-1.6">Â¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-12.2.2.3-1.7">Serialization:</dt>
              <dd id="section-12.2.2.3-1.8" style="margin-left: 1.5em">Section 2.3.3 of <span>[<a class="cite xref" href="#SEC1">SEC1</a>]</span> (compressed format)<a class="pilcrow" href="#section-12.2.2.3-1.8">Â¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-12.2.2.3-1.9">Multiplier Length:</dt>
              <dd id="section-12.2.2.3-1.10" style="margin-left: 1.5em">48<a class="pilcrow" href="#section-12.2.2.3-1.10">Â¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-12.2.2.3-1.11">Multiplier Conversion:</dt>
              <dd id="section-12.2.2.3-1.12" style="margin-left: 1.5em">Section 2.3.8 of <span>[<a class="cite xref" href="#SEC1">SEC1</a>]</span><a class="pilcrow" href="#section-12.2.2.3-1.12">Â¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-12.2.2.3-1.13">SPAKE M Constant:</dt>
              <dd id="section-12.2.2.3-1.14" style="margin-left: 1.5em">030ff0895ae5ebf6187080a82d82b42e2765e3b2f8749c7e05eba366434b363d3dc36f15314739074d2eb8613fceec2853<a class="pilcrow" href="#section-12.2.2.3-1.14">Â¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-12.2.2.3-1.15">SPAKE N Constant:</dt>
              <dd id="section-12.2.2.3-1.16" style="margin-left: 1.5em">02c72cf2e390853a1c1c4ad816a62fd15824f56078918f43f922ca21518f9c543bb252c5490214cf9aa3f0baab4b665c10<a class="pilcrow" href="#section-12.2.2.3-1.16">Â¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-12.2.2.3-1.17">Hash function:</dt>
              <dd id="section-12.2.2.3-1.18" style="margin-left: 1.5em">SHA-384 <span>[<a class="cite xref" href="#RFC6234">RFC6234</a>]</span><a class="pilcrow" href="#section-12.2.2.3-1.18">Â¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</section>
<section id="section-12.2.2.4">
            <h5 id="name-p-521">
<a class="section-number selfRef" href="#section-12.2.2.4">12.2.2.4. </a><a class="section-name selfRef" href="#name-p-521">P-521</a>
            </h5>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-12.2.2.4-1">
              <dt id="section-12.2.2.4-1.1">ID Number:</dt>
              <dd id="section-12.2.2.4-1.2" style="margin-left: 1.5em">4<a class="pilcrow" href="#section-12.2.2.4-1.2">Â¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-12.2.2.4-1.3">Name:</dt>
              <dd id="section-12.2.2.4-1.4" style="margin-left: 1.5em">P-521<a class="pilcrow" href="#section-12.2.2.4-1.4">Â¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-12.2.2.4-1.5">Specification:</dt>
              <dd id="section-12.2.2.4-1.6" style="margin-left: 1.5em">Section 2.6.1 of <span>[<a class="cite xref" href="#SEC2">SEC2</a>]</span><a class="pilcrow" href="#section-12.2.2.4-1.6">Â¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-12.2.2.4-1.7">Serialization:</dt>
              <dd id="section-12.2.2.4-1.8" style="margin-left: 1.5em">Section 2.3.3 of <span>[<a class="cite xref" href="#SEC1">SEC1</a>]</span> (compressed format)<a class="pilcrow" href="#section-12.2.2.4-1.8">Â¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-12.2.2.4-1.9">Multiplier Length:</dt>
              <dd id="section-12.2.2.4-1.10" style="margin-left: 1.5em">48<a class="pilcrow" href="#section-12.2.2.4-1.10">Â¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-12.2.2.4-1.11">Multiplier Conversion:</dt>
              <dd id="section-12.2.2.4-1.12" style="margin-left: 1.5em">Section 2.3.8 of <span>[<a class="cite xref" href="#SEC1">SEC1</a>]</span><a class="pilcrow" href="#section-12.2.2.4-1.12">Â¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-12.2.2.4-1.13">SPAKE M Constant:</dt>
              <dd id="section-12.2.2.4-1.14" style="margin-left: 1.5em">02003f06f38131b2ba2600791e82488e8d20ab889af753a41806c5db18d37d85608cfae06b82e4a72cd744c719193562a653ea1f119eef9356907edc9b56979962d7aa<a class="pilcrow" href="#section-12.2.2.4-1.14">Â¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-12.2.2.4-1.15">SPAKE N Constant:</dt>
              <dd id="section-12.2.2.4-1.16" style="margin-left: 1.5em">0200c7924b9ec017f3094562894336a53c50167ba8c5963876880542bc669e494b2532d76c5b53dfb349fdf69154b9e0048c58a42e8ed04cef052a3bc349d95575cd25<a class="pilcrow" href="#section-12.2.2.4-1.16">Â¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-12.2.2.4-1.17">Hash function:</dt>
              <dd id="section-12.2.2.4-1.18" style="margin-left: 1.5em">SHA-512 <span>[<a class="cite xref" href="#RFC6234">RFC6234</a>]</span><a class="pilcrow" href="#section-12.2.2.4-1.18">Â¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</section>
</section>
</section>
</div>
</section>
<section id="section-13">
      <h2 id="name-references">
<a class="section-number selfRef" href="#section-13">13. </a><a class="section-name selfRef" href="#name-references">References</a>
      </h2>
<section id="section-13.1">
        <h3 id="name-normative-references">
<a class="section-number selfRef" href="#section-13.1">13.1. </a><a class="section-name selfRef" href="#name-normative-references">Normative References</a>
        </h3>
<dl class="references">
<dt id="ITU-T.X680.2021">[ITU-T.X680.2021]</dt>
        <dd>
<span class="refAuthor">ITU-T</span>, <span class="refTitle">"Information technology - Abstract Syntax Notation One (ASN.1): Specification of basic notation"</span>, <span class="seriesInfo">ITU-T Recommendation X.680</span>, <span class="seriesInfo">ISO/IEC 8824-1:2021</span>, <time class="refDate" datetime="2021-02">February 2021</time>. </dd>
<dd class="break"></dd>
<dt id="ITU-T.X690.2021">[ITU-T.X690.2021]</dt>
        <dd>
<span class="refAuthor">ITU-T</span>, <span class="refTitle">"Information technology - ASN.1 encoding rules: Specification of Basic Encoding Rules (BER), Canonical Encoding Rules (CER) and Distinguished Encoding Rules (DER)"</span>, <span class="seriesInfo">ITU-T Recommendation X.690</span>, <span class="seriesInfo">ISO/IEC 8825-1:2021</span>, <time class="refDate" datetime="2021-02">February 2021</time>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time class="refDate" datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3961">[RFC3961]</dt>
        <dd>
<span class="refAuthor">Raeburn, K.</span>, <span class="refTitle">"Encryption and Checksum Specifications for Kerberos 5"</span>, <span class="seriesInfo">RFC 3961</span>, <span class="seriesInfo">DOI 10.17487/RFC3961</span>, <time class="refDate" datetime="2005-02">February 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3961">https://www.rfc-editor.org/info/rfc3961</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4120">[RFC4120]</dt>
        <dd>
<span class="refAuthor">Neuman, C.</span>, <span class="refAuthor">Yu, T.</span>, <span class="refAuthor">Hartman, S.</span>, and <span class="refAuthor">K. Raeburn</span>, <span class="refTitle">"The Kerberos Network Authentication Service (V5)"</span>, <span class="seriesInfo">RFC 4120</span>, <span class="seriesInfo">DOI 10.17487/RFC4120</span>, <time class="refDate" datetime="2005-07">July 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4120">https://www.rfc-editor.org/info/rfc4120</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6113">[RFC6113]</dt>
        <dd>
<span class="refAuthor">Hartman, S.</span> and <span class="refAuthor">L. Zhu</span>, <span class="refTitle">"A Generalized Framework for Kerberos Pre-Authentication"</span>, <span class="seriesInfo">RFC 6113</span>, <span class="seriesInfo">DOI 10.17487/RFC6113</span>, <time class="refDate" datetime="2011-04">April 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6113">https://www.rfc-editor.org/info/rfc6113</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6234">[RFC6234]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span> and <span class="refAuthor">T. Hansen</span>, <span class="refTitle">"US Secure Hash Algorithms (SHA and SHA-based HMAC and HKDF)"</span>, <span class="seriesInfo">RFC 6234</span>, <span class="seriesInfo">DOI 10.17487/RFC6234</span>, <time class="refDate" datetime="2011-05">May 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6234">https://www.rfc-editor.org/info/rfc6234</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7748">[RFC7748]</dt>
        <dd>
<span class="refAuthor">Langley, A.</span>, <span class="refAuthor">Hamburg, M.</span>, and <span class="refAuthor">S. Turner</span>, <span class="refTitle">"Elliptic Curves for Security"</span>, <span class="seriesInfo">RFC 7748</span>, <span class="seriesInfo">DOI 10.17487/RFC7748</span>, <time class="refDate" datetime="2016-01">January 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7748">https://www.rfc-editor.org/info/rfc7748</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8032">[RFC8032]</dt>
        <dd>
<span class="refAuthor">Josefsson, S.</span> and <span class="refAuthor">I. Liusvaara</span>, <span class="refTitle">"Edwards-Curve Digital Signature Algorithm (EdDSA)"</span>, <span class="seriesInfo">RFC 8032</span>, <span class="seriesInfo">DOI 10.17487/RFC8032</span>, <time class="refDate" datetime="2017-01">January 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8032">https://www.rfc-editor.org/info/rfc8032</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time class="refDate" datetime="2017-06">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time class="refDate" datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SEC1">[SEC1]</dt>
        <dd>
<span class="refAuthor">Standards for Efficient Cryptography Group</span>, <span class="refTitle">"SEC 1: Elliptic Curve Cryptography"</span>, <time class="refDate" datetime="2009-05">May 2009</time>. </dd>
<dd class="break"></dd>
<dt id="SEC2">[SEC2]</dt>
      <dd>
<span class="refAuthor">Standards for Efficient Cryptography Group</span>, <span class="refTitle">"SEC 2: Recommended Elliptic Curve Domain Parameters"</span>, <time class="refDate" datetime="2010-01">January 2010</time>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-13.2">
        <h3 id="name-informative-references">
<a class="section-number selfRef" href="#section-13.2">13.2. </a><a class="section-name selfRef" href="#name-informative-references">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC6090">[RFC6090]</dt>
        <dd>
<span class="refAuthor">McGrew, D.</span>, <span class="refAuthor">Igoe, K.</span>, and <span class="refAuthor">M. Salter</span>, <span class="refTitle">"Fundamental Elliptic Curve Cryptography Algorithms"</span>, <span class="seriesInfo">RFC 6090</span>, <span class="seriesInfo">DOI 10.17487/RFC6090</span>, <time class="refDate" datetime="2011-02">February 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6090">https://www.rfc-editor.org/info/rfc6090</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6560">[RFC6560]</dt>
        <dd>
<span class="refAuthor">Richards, G.</span>, <span class="refTitle">"One-Time Password (OTP) Pre-Authentication"</span>, <span class="seriesInfo">RFC 6560</span>, <span class="seriesInfo">DOI 10.17487/RFC6560</span>, <time class="refDate" datetime="2012-04">April 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6560">https://www.rfc-editor.org/info/rfc6560</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8125">[RFC8125]</dt>
        <dd>
<span class="refAuthor">Schmidt, J.</span>, <span class="refTitle">"Requirements for Password-Authenticated Key Agreement (PAKE) Schemes"</span>, <span class="seriesInfo">RFC 8125</span>, <span class="seriesInfo">DOI 10.17487/RFC8125</span>, <time class="refDate" datetime="2017-04">April 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8125">https://www.rfc-editor.org/info/rfc8125</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SPAKE">[SPAKE]</dt>
      <dd>
<span class="refAuthor">Abdalla, M.</span> and <span class="refAuthor">D. Pointcheval</span>, <span class="refTitle">"Simple Password-Based Encrypted Key Exchange Protocols"</span>, <span class="refContent">CT-RSA 2005, Lecture Notes in Computer
        Science, Volume 3376, pages 191-208, Springer</span>, <span class="seriesInfo">DOI 10.1007/978-3-540-30574-3_14</span>, <time class="refDate" datetime="2005-02">February 2005</time>, <span>&lt;<a href="https://doi.org/10.1007/978-3-540-30574-3_14">https://doi.org/10.1007/978-3-540-30574-3_14</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<section id="appendix-A">
      <h2 id="name-asn1-module">
<a class="section-number selfRef" href="#appendix-A">Appendix A. </a><a class="section-name selfRef" href="#name-asn1-module">ASN.1 Module</a>
      </h2>
<div class="breakable lang-asn.1 sourcecode" id="appendix-A-1">
<pre>KerberosV5SPAKE {
        iso(1) identified-organization(3) dod(6) internet(1)
        security(5) kerberosV5(2) modules(4) spake(8)
} DEFINITIONS EXPLICIT TAGS ::= BEGIN

IMPORTS
    EncryptedData, Int32
      FROM KerberosV5Spec2 { iso(1) identified-organization(3)
        dod(6) internet(1) security(5) kerberosV5(2) modules(4)
        krb5spec2(2) };
        -- as defined in RFC 4120.

SPAKESupport ::= SEQUENCE {
    groups      [0] SEQUENCE (SIZE(1..MAX)) OF Int32,
    ...
}

SPAKEChallenge ::= SEQUENCE {
    group       [0] Int32,
    pubkey      [1] OCTET STRING,
    factors     [2] SEQUENCE (SIZE(1..MAX)) OF SPAKESecondFactor,
    ...
}

SPAKESecondFactor ::= SEQUENCE {
    type        [0] Int32,
    data        [1] OCTET STRING OPTIONAL
}

SPAKEResponse ::= SEQUENCE {
    pubkey      [0] OCTET STRING,
    factor      [1] EncryptedData, -- SPAKESecondFactor
    ...
}

PA-SPAKE ::= CHOICE {
    support     [0] SPAKESupport,
    challenge   [1] SPAKEChallenge,
    response    [2] SPAKEResponse,
    encdata     [3] EncryptedData,
    ...
}

PA-SPAKE-HINT ::= SEQUENCE {
    groups      [0] SEQUENCE (SIZE(1..MAX)) OF Int32,
    factors     [1] SEQUENCE (SIZE(1..MAX)) OF SPAKESecondFactor
}

END
</pre><a class="pilcrow" href="#appendix-A-1">Â¶</a>
</div>
</section>
<section id="appendix-B">
      <h2 id="name-spake-m-and-n-value-selecti">
<a class="section-number selfRef" href="#appendix-B">Appendix B. </a><a class="section-name selfRef" href="#name-spake-m-and-n-value-selecti">SPAKE M and N Value Selection</a>
      </h2>
<p id="appendix-B-1">The M and N values for the initial contents of the SPAKE group
      registry were generated using the following Python snippet, which assumes
      an elliptic curve implementation following the interface of
      Edwards25519Point.stdbase() and Edwards448Point.stdbase() in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc8032#appendix-A">Appendix A</a> of [<a class="cite xref" href="#RFC8032">RFC8032</a>]</span>:<a class="pilcrow" href="#appendix-B-1">Â¶</a></p>
<div class="lang-python sourcecode" id="appendix-B-2">
<pre>def iterhash(seed, n):
    h = seed
    for i in range(n):
        h = hashlib.sha256(h).digest()
    return h

def bighash(seed, start, sz):
    n = -(-sz // 32)
    hashes = [iterhash(seed, i) for i in range(start, start + n)]
    return b''.join(hashes)[:sz]

def canon_pointstr(ecname, s):
    if ecname == 'edwards25519':
        return s
    elif ecname == 'edwards448':
        return s[:-1] + bytes([s[-1] &amp; 0x80])
    else:
        return bytes([(s[0] &amp; 1) | 2]) + s[1:]

def gen_point(seed, ecname, ec):
    for i in range(1, 1000):
        hval = bighash(seed, i, len(ec.encode()))
        pointstr = canon_pointstr(ecname, hval)
        try:
            p = ec.decode(pointstr)
            if p != ec.zero_elem() and p * p.l() == ec.zero_elem():
                return pointstr, i
        except Exception:
            pass
</pre><a class="pilcrow" href="#appendix-B-2">Â¶</a>
</div>
<p id="appendix-B-3">The initial seed strings are as follows:<a class="pilcrow" href="#appendix-B-3">Â¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-4.1">For group 1 M: edwards25519 point generation seed (M)<a class="pilcrow" href="#appendix-B-4.1">Â¶</a>
</li>
        <li class="normal" id="appendix-B-4.2">For group 1 N: edwards25519 point generation seed (N)<a class="pilcrow" href="#appendix-B-4.2">Â¶</a>
</li>
        <li class="normal" id="appendix-B-4.3">For group 2 M: 1.2.840.10045.3.1.7 point generation seed (M)<a class="pilcrow" href="#appendix-B-4.3">Â¶</a>
</li>
        <li class="normal" id="appendix-B-4.4">For group 2 N: 1.2.840.10045.3.1.7 point generation seed (N)<a class="pilcrow" href="#appendix-B-4.4">Â¶</a>
</li>
        <li class="normal" id="appendix-B-4.5">For group 3 M: 1.3.132.0.34 point generation seed (M)<a class="pilcrow" href="#appendix-B-4.5">Â¶</a>
</li>
        <li class="normal" id="appendix-B-4.6">For group 3 N: 1.3.132.0.34 point generation seed (N)<a class="pilcrow" href="#appendix-B-4.6">Â¶</a>
</li>
        <li class="normal" id="appendix-B-4.7">For group 4 M: 1.3.132.0.35 point generation seed (M)<a class="pilcrow" href="#appendix-B-4.7">Â¶</a>
</li>
        <li class="normal" id="appendix-B-4.8">For group 4 N: 1.3.132.0.35 point generation seed (N)<a class="pilcrow" href="#appendix-B-4.8">Â¶</a>
</li>
      </ul>
</section>
<section id="appendix-C">
      <h2 id="name-test-vectors">
<a class="section-number selfRef" href="#appendix-C">Appendix C. </a><a class="section-name selfRef" href="#name-test-vectors">Test Vectors</a>
      </h2>
<p id="appendix-C-1">For the following text vectors:<a class="pilcrow" href="#appendix-C-1">Â¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-2.1">The key is the string-to-key of "password" with the salt
        "ATHENA.MIT.EDUraeburn" for the designated initial reply key
        encryption type.<a class="pilcrow" href="#appendix-C-2.1">Â¶</a>
</li>
        <li class="normal" id="appendix-C-2.2">x and y were chosen randomly within the order of the
        designated group, then multiplied by the cofactor.<a class="pilcrow" href="#appendix-C-2.2">Â¶</a>
</li>
        <li class="normal" id="appendix-C-2.3">The SPAKESupport message contains only the designated
        group's number.<a class="pilcrow" href="#appendix-C-2.3">Â¶</a>
</li>
        <li class="normal" id="appendix-C-2.4">The SPAKEChallenge message offers only the SF-NONE second-factor type.<a class="pilcrow" href="#appendix-C-2.4">Â¶</a>
</li>
        <li class="normal" id="appendix-C-2.5">The KDC-REQ-BODY message does not contain KDC options, but
        does contain the client principal name "raeburn@ATHENA.MIT.EDU", the
        server principal name "krbtgt/ATHENA.MIT.EDU", the realm
        "ATHENA.MIT.EDU", the till field "19700101000000Z", the nonce zero,
        and an etype list containing only the designated encryption type.<a class="pilcrow" href="#appendix-C-2.5">Â¶</a>
</li>
      </ul>
<div class="breakable lang-test-vector sourcecode" id="appendix-C-3">
<pre>des3-cbc-sha1 edwards25519
key: 850bb51358548cd05e86768c313e3bfef7511937dcf72c3e
w (PRF+ output): 686d84730cb8679ae95416c6567c6a63
                 f2c9cef124f7a3371ae81e11cad42a37
w (reduced multiplier): a1f1a25cbd8e3092667e2fddba8ecd24
                        f2c9cef124f7a3371ae81e11cad42a07
x: 201012d07bfd48ddfa33c4aac4fb1e229fb0d043cfe65ebfb14399091c71a723
y: 500b294797b8b042aca1bedc0f5931a4f52c537b3608b2d05cc8a2372f439f25
X: ec274df1920dc0f690c8741b794127233745444161016ef950ad75c51db58c3e
Y: d90974f1c42dac1cd4454561ac2d49af762f2ac87bf02436d461e7b661b43028
T: 18f511e750c97b592acd30db7d9e5fca660389102e6bf610c1bfbed4616c8362
S: 5d10705e0d1e43d5dbf30240ccfbde4a0230c70d4c79147ab0b317edad2f8ae7
K: 25bde0d875f0feb5755f45ba5e857889d916ecf7476f116aa31dc3e037ec4292
SPAKESupport: a0093007a0053003020101
SPAKEChallenge: a1363034a003020101a122042018f511e750c97b592acd30
                db7d9e5fca660389102e6bf610c1bfbed4616c8362a20930
                073005a003020101
Transcript hash after challenge: 22bb2271e34d329d52073c70b1d11879
                                 73181f0bc7614266bb79ee80d3335175
Final transcript hash after pubkey: eaaa08807d0616026ff51c849efbf35b
                                    a0ce3c5300e7d486da46351b13d4605b
KDC-REQ-BODY: 3075a00703050000000000a1143012a003020101a10b3009
              1b077261656275726ea2101b0e415448454e412e4d49542e
              454455a3233021a003020102a11a30181b066b7262746774
              1b0e415448454e412e4d49542e454455a511180f31393730
              303130313030303030305aa703020100a8053003020110
K'[0]: baf12fae7cd958cbf1a29bfbc71f89ce49e03e295d89dafd
K'[1]: 64f73dd9c41908206bcec1f719026b574f9d13463d7a2520
K'[2]: 0454520b086b152c455829e6baeff78a61dfe9e3d04a895d
K'[3]: 4a92260b25e3ef94c125d5c24c3e5bced5b37976e67f25c4

rc4-hmac edwards25519
key: 8846f7eaee8fb117ad06bdd830b7586c
w (PRF+ output): 7c86659d29cf2b2ea93bfe79c3cefb88
                 50e82215b3ea6fcd896561d48048f49c
w (reduced multiplier): 2713c1583c53861520b849bfef0525cd
                        4fe82215b3ea6fcd896561d48048f40c
x: c8a62e7b626f44cad807b2d695450697e020d230a738c5cd5691cc781dce8754
y: 18fe7c1512708c7fd06db270361f04593775bc634ceaf45347e5c11c38aae017
X: b0bcbbdd25aa031f4608d0442dd4924be7731d49c089a8301859d77343ffb567
Y: 7d1ab8aeda1a2b1f9eab8d11c0fda60b616005d0f37d1224c5f12b8649f579a5
T: 7db465f1c08c64983a19f560bce966fe5306c4b447f70a5bca14612a92da1d63
S: 38f8d4568090148ebc9fd17c241b4cc2769505a7ca6f3f7104417b72b5b5cf54
K: 03e75edd2cd7e7677642dd68736e91700953ac55dc650e3c2a1b3b4acdb800f8
SPAKESupport: a0093007a0053003020101
SPAKEChallenge: a1363034a003020101a12204207db465f1c08c64983a19f5
                60bce966fe5306c4b447f70a5bca14612a92da1d63a20930
                073005a003020101
Transcript hash after challenge: 3cde9ed9b562a09d816885b6c225f733
                                 6d9e2674bb4df903dfc894d963a2af42
Final transcript hash after pubkey: f4b208458017de6ef7f6a307d47d87db
                                    6c2af1d291b726860f68bc08bfef440a
KDC-REQ-BODY: 3075a00703050000000000a1143012a003020101a10b3009
              1b077261656275726ea2101b0e415448454e412e4d49542e
              454455a3233021a003020102a11a30181b066b7262746774
              1b0e415448454e412e4d49542e454455a511180f31393730
              303130313030303030305aa703020100a8053003020117
K'[0]: 770b720c82384cbb693e85411eedecba
K'[1]: 621deec88e2865837c4d3462bb50a1d5
K'[2]: 1cc8f6333b9fa3b42662fd9914fbd5bb
K'[3]: edb4032b7fc3806d5211a534dcbc390c

aes128-cts-hmac-sha1-96 edwards25519
key: fca822951813fb252154c883f5ee1cf4
w (PRF+ output): 0d591b197b667e083c2f5f98ac891d3c
                 9f99e710e464e62f1fb7c9b67936f3eb
w (reduced multiplier): 17c2a9030afb7c37839bd4ae7fdfeb17
                        9e99e710e464e62f1fb7c9b67936f30b
x: 50be049a5a570fa1459fb9f666e6fd80602e4e87790a0e567f12438a2c96c138
y: b877afe8612b406d96be85bd9f19d423e95be96c0e1e0b5824127195c3ed5917
X: e73a443c678913eb4a0cad5cbd3086cf82f65a5a91b611e01e949f5c52efd6dd
Y: 473c5b44ed2be9cb50afe1762b535b3930530489816ea6bd962622cccf39f6e8
T: 9e9311d985c1355e022d7c3c694ad8d6f7ad6d647b68a90b0fe46992818002da
S: fbe08f7f96cd5d4139e7c9eccb95e79b8ace41e270a60198c007df18525b628e
K: c2f7f99997c585e6b686ceb62db42f17cc70932def3bb4cf009e36f22ea5473d
SPAKESupport: a0093007a0053003020101
SPAKEChallenge: a1363034a003020101a12204209e9311d985c1355e022d7c
                3c694ad8d6f7ad6d647b68a90b0fe46992818002daa20930
                073005a003020101
Transcript hash after challenge: 4512310282c01b39dd9aebd0cc2a5e53
                                 2ed077a6c11d4c973c4593d525078797
Final transcript hash after pubkey: 951285f107c87f0169b9c918a1f51f60
                                    cb1a75b9f8bb799a99f53d03add94b5f
KDC-REQ-BODY: 3075a00703050000000000a1143012a003020101a10b3009
              1b077261656275726ea2101b0e415448454e412e4d49542e
              454455a3233021a003020102a11a30181b066b7262746774
              1b0e415448454e412e4d49542e454455a511180f31393730
              303130313030303030305aa703020100a8053003020111
K'[0]: 548022d58a7c47eae8c49dccf6baa407
K'[1]: b2c9ba0e13fc8ab3a9d96b51b601cf4a
K'[2]: 69f0ee5fdb6c237e7fcd38d9f87df1bd
K'[3]: 78f91e2240b5ee528a5cc8d7cbebfba5

aes256-cts-hmac-sha1-96 edwards25519
key: 01b897121d933ab44b47eb5494db15e50eb74530dbdae9b634d65020ff5d88c1
w (PRF+ output): e902341590a1b4bb4d606a1c643cccb3
                 f2108f1b6aa97b381012b9400c9e3f4e
w (reduced multiplier): 35b35ca126156b5bf4ec8b90e9545060
                        f2108f1b6aa97b381012b9400c9e3f0e
x: 88c6c0a4f0241ef217c9788f02c32d00b72e4310748cd8fb5f94717607e6417d
y: 88b859df58ef5c69bacdfe681c582754eaab09a74dc29cff50b328613c232f55
X: 23c48eaff2721051946313840723b38f563c59b92043d6ffd752f95781af0327
Y: 3d51486ec1d9be69bc45386bb675c013db87fd0488f6a9cacf6b43e8c81a0641
T: 6f301aacae1220e91be42868c163c5009aeea1e9d9e28afcfc339cda5e7105b5
S: 9e2cc32908fc46273279ec75354b4aeafa70c3d99a4d507175ed70d80b255dda
K: cf57f58f6e60169d2ecc8f20bb923a8e4c16e5bc95b9e64b5dc870da7026321b
SPAKESupport: a0093007a0053003020101
SPAKEChallenge: a1363034a003020101a12204206f301aacae1220e91be428
                68c163c5009aeea1e9d9e28afcfc339cda5e7105b5a20930
                073005a003020101
Transcript hash after challenge: 23a5e72eb4dedd1ca860f43736c458f0
                                 775c3bb1370a26af8a9374d521d70ec9
Final transcript hash after pubkey: 1c605649d4658b58cbe79a5faf227acc
                                    16c355c58b7dade022f90c158fe5ed8e
KDC-REQ-BODY: 3075a00703050000000000a1143012a003020101a10b3009
              1b077261656275726ea2101b0e415448454e412e4d49542e
              454455a3233021a003020102a11a30181b066b7262746774
              1b0e415448454e412e4d49542e454455a511180f31393730
              303130313030303030305aa703020100a8053003020112
K'[0]: a9bfa71c95c575756f922871524b6528
       8b3f695573ccc0633e87449568210c23
K'[1]: 1865a9ee1ef0640ec28ac007391cac62
       4c42639c714767a974e99aa10003015f
K'[2]: e57781513fefdb978e374e156b0da0c1
       a08148f5eb26b8e157ac3c077e28bf49
K'[3]: 008e6487293c3cc9fabbbcdd8b392d6d
       cb88222317fd7fe52d12fbc44fa047f1

aes256-cts-hmac-sha1-96 P-256
key: 01b897121d933ab44b47eb5494db15e50eb74530dbdae9b634d65020ff5d88c1
w (PRF+ output): eb2984af18703f94dd5288b8596cd369
                 88d0d4e83bfb2b44de14d0e95e2090bd
w (reduced multiplier): eb2984af18703f94dd5288b8596cd369
                        88d0d4e83bfb2b44de14d0e95e2090bd
x: 935ddd725129fb7c6288e1a5cc45782198a6416d1775336d71eacd0549a3e80e
y: e07405eb215663abc1f254b8adc0da7a16febaa011af923d79fdef7c42930b33
X: 03bc802165aea7dbd98cc155056249fe0a37a9c203a7c0f7e872d5bf687bd105e2
Y: 0340b8d91ce3852d0a12ae1f3e82c791fc86df6b346006431e968a1b869af7c735
T: 024f62078ceb53840d02612195494d0d0d88de21feeb81187c71cbf3d01e71788d
S: 021d07dc31266fc7cfd904ce2632111a169b7ec730e5f74a7e79700f86638e13c8
K: 0268489d7a9983f2fde69c6e6a1307e9d252259264f5f2dfc32f58cca19671e79b
SPAKESupport: a0093007a0053003020102
SPAKEChallenge: a1373035a003020102a1230421024f62078ceb53840d0261
                2195494d0d0d88de21feeb81187c71cbf3d01e71788da209
                30073005a003020101
Transcript hash after challenge: 0a142afca77c2e92b066572a90389eac
                                 40a6b1f1ed8b534d342591c0e7727e00
Final transcript hash after pubkey: 20ad3c1a9a90fc037d1963a1c4bfb15a
                                    b4484d7b6cf07b12d24984f14652de60
KDC-REQ-BODY: 3075a00703050000000000a1143012a003020101a10b3009
              1b077261656275726ea2101b0e415448454e412e4d49542e
              454455a3233021a003020102a11a30181b066b7262746774
              1b0e415448454e412e4d49542e454455a511180f31393730
              303130313030303030305aa703020100a8053003020112
K'[0]: 7d3b906f7be49932db22cd3463f032d0
       6c9c078be4b1d076d201fc6e61ef531e
K'[1]: 17d74e36f8993841fbb7feb12fa4f011
       243d3ae4d2ace55b39379294bbc4db2c
K'[2]: d192c9044081a2aa6a97a6c69e2724e8
       e5671c2c9ce073dd439cdbaf96d7dab0
K'[3]: 41e5bad6b67f12c53ce0e2720dd6a988
       7f877bf9463c2d5209c74c36f8d776b7

aes256-cts-hmac-sha1-96 P-384
key: 01b897121d933ab44b47eb5494db15e50eb74530dbdae9b634d65020ff5d88c1
w (PRF+ output): 0304cfc55151c6bbe889653db96dbfe0ba4acafc024c1e88
                 40cb3a486f6d80c16e1b8974016aa4b7fa43042a9b3825b1
w (reduced multiplier): 0304cfc55151c6bbe889653db96dbfe0
                        ba4acafc024c1e8840cb3a486f6d80c1
                        6e1b8974016aa4b7fa43042a9b3825b1
x: f323ca74d344749096fd35d0adf20806e521460637176e84d977e9933c49d76f
   cfc6e62585940927468ff53d864a7a50
y: 5b7c709acb175a5afb82860deabca8d0b341facdff0ac0f1a425799aa905d750
   7e1ea9c573581a81467437419466e472
X: 0211e3334f117b76635dd802d4022f601680a1fd066a56606b7f246493a10351
   7797b81789b225bd5bb1d9ae1da2962250
Y: 0383dfa413496e5e7599fc8c6430f8d6910d37cf326d81421bc92c0939b555c4
   ca2ef6a993f6d3db8cb7407655ef60866e
T: 02a1524603ef14f184696f854229d3397507a66c63f841ba748451056be07879
   ac298912387b1c5cdff6381c264701be57
S: 020d5adfdb92bc377041cf5837412574c5d13e0f4739208a4f0c859a0a302bc6
   a533440a245b9d97a0d34af5016a20053d
K: 0264aa8c61da9600dfb0beb5e46550d63740e4ef29e73f1a30d543eb43c25499
   037ad16538586552761b093cf0e37c703a
SPAKESupport: a0093007a0053003020103
SPAKEChallenge: a1473045a003020103a133043102a1524603ef14f184696f
                854229d3397507a66c63f841ba748451056be07879ac2989
                12387b1c5cdff6381c264701be57a20930073005a0030201
                01
Transcript hash after challenge: 4d4095d9f94552e15015881a3f2cf458
                                 1be83217cf7ad830d2f051dba3ec8caa
                                 6e354eaa85738d7035317ac557f8c294
Final transcript hash after pubkey: 5ac0d99ef9e5a73998797fe64f074673
                                    e3952dec4c7d1aacce8b75f64d2b0276
                                    a901cb8539b4e8ed69e4db0ce805b47b
KDC-REQ-BODY: 3075a00703050000000000a1143012a003020101a10b3009
              1b077261656275726ea2101b0e415448454e412e4d49542e
              454455a3233021a003020102a11a30181b066b7262746774
              1b0e415448454e412e4d49542e454455a511180f31393730
              303130313030303030305aa703020100a8053003020112
K'[0]: b917d37c16dd1d8567fbe379f64e1ee3
       6ca3fd127aa4e60f97e4afa3d9e56d91
K'[1]: 93d40079dab229b9c79366829f4e7e72
       82e6a4b943ac7bac69922d516673f49a
K'[2]: bfc4f16f12f683e71589f9a888e23287
       5ef293ac9793db6c919567cd7b94bcd4
K'[3]: 3630e2b5b99938e7506733141e8ec344
       166f6407e5fc2ef107c156e764d1bc20

aes256-cts-hmac-sha1-96 P-521
key: 01b897121d933ab44b47eb5494db15e50eb74530dbdae9b634d65020ff5d88c1
w (PRF+ output): de3a095a2b2386eff3eb15b735398da1caf95bc8425665d8
                 2370aff58b0471f34a57bccddf1ebf0a2965b58a93ee5b45
                 e85d1a5435d1c8c83662999722d542831f9a
w (reduced multiplier): 003a095a2b2386eff3eb15b735398da1
                        caf95bc8425665d82370aff58b0471f3
                        4cce63791cfed967f0c94c16054b3e17
                        03133681bece1e05219f5426bc944b0f
                        bfb3
x: 017c38701a14b490b6081dfc83524562be7fbb42e0b20426465e3e37952d30bc
   ab0ed857010255d44936a1515607964a870c7c879b741d878f9f9cdf5a865306
   f3f5
y: 003e2e2950656fa231e959acdd984d125e7fa59cec98126cbc8f3888447911eb
   cd49428a1c22d5fdb76a19fbeb1d9edfa3da6cf55b158b53031d05d51433ade9
   b2b4
X: 03003e95272223b210b48cfd908b956a36add04a7ff443511432f94ddd87e064
   1d680ba3b3d532c21fa6046192f6bfae7af81c4b803aa154e12459d1428f8f2f
   56e9f2
Y: 030064916687960df496557ecab08298bf075429eca268c6dabbae24e258d568
   c62841664dc8ecf545369f573ea84548faa22f118128c0a87e1d47315afabb77
   3bb082
T: 02017d3de19a3ec53d0174905665ef37947d142535102cd9809c0dfbd0dfe007
   353d54cf406ce2a59950f2bb540df6fbe75f8bbbef811c9ba06cc275adbd9675
   6696ec
S: 02004d142d87477841f6ba053c8f651f3395ad264b7405ca5911fb9a55abd454
   fef658a5f9ed97d1efac68764e9092fa15b9e0050880d78e95fd03abf5931791
   6822b5
K: 03007c303f62f09282cc849490805bd4457a6793a832cbeb55df427db6a31e99
   b055d5dc99756d24d47b70ad8b6015b0fb8742a718462ed423b90fa3fe631ac1
   3fa916
SPAKESupport: a0093007a0053003020104
SPAKEChallenge: a1593057a003020104a145044302017d3de19a3ec53d0174
                905665ef37947d142535102cd9809c0dfbd0dfe007353d54
                cf406ce2a59950f2bb540df6fbe75f8bbbef811c9ba06cc2
                75adbd96756696eca20930073005a003020101
Transcript hash after challenge: 554405860f8a80944228f1fa2466411d
                                 cf236162aa385e1289131b39e1fd59f2
                                 5e58b4c281ff059c28dc20f5803b87c6
                                 7571ce64cea01b39a21819d1ef1cdc7f
Final transcript hash after pubkey: 8d6a89ae4d80cc4e47b6f4e48ea3e579
                                    19cc69598d0d3dc7c8bd49b6f1db1409
                                    ca0312944cd964e213aba98537041102
                                    237cff5b331e5347a0673869b412302e
KDC-REQ-BODY: 3075a00703050000000000a1143012a003020101a10b3009
              1b077261656275726ea2101b0e415448454e412e4d49542e
              454455a3233021a003020102a11a30181b066b7262746774
              1b0e415448454e412e4d49542e454455a511180f31393730
              303130313030303030305aa703020100a8053003020112
K'[0]: 1eb3d10bee8fab483adcd3eb38f3ebf1
       f4feb8db96ecc035f563cf2e1115d276
K'[1]: 482b92781ce57f49176e4c94153cc622
       fe247a7dbe931d1478315f856f085890
K'[2]: a2c215126dd3df280aab5a27e1e0fb7e
       594192cbff8d6d8e1b6f1818d9bb8fac
K'[3]: cc06603de984324013a01f888de6d43b
       410a4da2dea53509f30e433c352fb668

aes256-cts-hmac-sha1-96 edwards25519, accepted optimistic challenge
key: 01b897121d933ab44b47eb5494db15e50eb74530dbdae9b634d65020ff5d88c1
w (PRF+ output): e902341590a1b4bb4d606a1c643cccb3
                 f2108f1b6aa97b381012b9400c9e3f4e
w (reduced multiplier): 35b35ca126156b5bf4ec8b90e9545060
                        f2108f1b6aa97b381012b9400c9e3f0e
x: 70937207344cafbc53c8a55070e399c584cbafce00b836980dd4e7e74fad2a64
y: 785d6801a2490df028903ac6449b105f2ff0db895b252953cdc2076649526103
X: 13841224ea50438c1d9457159d05f2b7cd9d05daf154888eeed223e79008b47c
Y: d01fc81d5ce20d6ea0939a6bb3e40ccd049f821baaf95e323a3657309ef75d61
T: 83523b35f1565006cbfc4f159885467c2fb9bc6fe23d36cb1da43d199f1a3118
S: 2a8f70f46cee9030700037b77f22cec7970dcc238e3e066d9d726baf183992c6
K: d3c5e4266aa6d1b2873a97ce8af91c7e4d7a7ac456acced7908d34c561ad8fa6
SPAKEChallenge: a1363034a003020101a122042083523b35f1565006cbfc4f
                159885467c2fb9bc6fe23d36cb1da43d199f1a3118a20930
                073005a003020101
Transcript hash after challenge: 0332da8ba3095ccd127c51740cb905ba
                                 c76e90725e769570b9d8338e6d62a7f2
Final transcript hash after pubkey: 26f07f9f8965307434d11ea855461d41
                                    e0cbabcc0a1bab48ecee0c6c1a4292b7
KDC-REQ-BODY: 3075a00703050000000000a1143012a003020101a10b3009
              1b077261656275726ea2101b0e415448454e412e4d49542e
              454455a3233021a003020102a11a30181b066b7262746774
              1b0e415448454e412e4d49542e454455a511180f31393730
              303130313030303030305aa703020100a8053003020112
K'[0]: 4569ec08b5de5c3cc19d941725913ace
       8d74524b521a341dc746acd5c3784d92
K'[1]: 0d96ce1a4ac0f2e280a0cfc31742b064
       61d83d04ae45433db2d80478dd882a4c
K'[2]: 58018c19315a1ba5d5bb9813b58029f0
       aec18a6f9ca59e0847de1c60bc25945c
K'[3]: ed7e9bffd68c54d86fb19cd3c03f317f
       88a71ad9a5e94c28581d93fc4ec72b6a

aes256-cts-hmac-sha1-96 P-521, rejected edwards25519 challenge
key: 01b897121d933ab44b47eb5494db15e50eb74530dbdae9b634d65020ff5d88c1
w (PRF+ output): de3a095a2b2386eff3eb15b735398da1caf95bc8425665d8
                 2370aff58b0471f34a57bccddf1ebf0a2965b58a93ee5b45
                 e85d1a5435d1c8c83662999722d542831f9a
w (reduced multiplier): 003a095a2b2386eff3eb15b735398da1
                        caf95bc8425665d82370aff58b0471f3
                        4cce63791cfed967f0c94c16054b3e17
                        03133681bece1e05219f5426bc944b0f
                        bfb3
x: 01687b59051bf40048d7c31d5a973d792fa12284b7a447e7f5938b5885ca0bb2
   c3f0bd30291a55fea08e143e2e04bdd7d19b753c7c99032f06cab0d9c2aa8f83
   7ef7
y: 01ded675ebf74fe30c9a53710f577e9cf84f09f6048fe245a4600004884cc167
   733f9a9e43108fb83babe8754cd37cbd7025e28bc9ff870f084c7244f536285e
   25b4
X: 03001bed88af987101ef52db5b8876f6287eb49a72163876c2cf99deb94f4c74
   9bfd118f0f400833cc8daad81971fe40498e6075d8ba0a2acfac35eb9ec8530e
   e0edd5
Y: 02007bd3bf214200795ea449852976f241c9f50f445f78ff2714fffe42983f25
   cd9c9094ba3f9d7adadd6c251e9dc0991fc8210547e7769336a0ac406878fb94
   be2f1f
T: 02014cb2e5b592ece5990f0ef30d308c061de1598bc4272b4a6599bed466fd15
   21693642abcf4dbe36ce1a2d13967de45f6c4f8d0fa8e14428bf03fb96ef5f1e
   d3e645
S: 02016c64995e804416f748fd5fa3aa678cbc7cbb596a4f523132dc8af7ce84e5
   41f484a2c74808c6b21dcf7775baefa6753398425becc7b838b210ac5daa0cb0
   b710e2
K: 0200997f4848ae2e7a98c23d14ac662030743ab37fccc2a45f1c721114f40bcc
   80fe6ec6aba49868f8aea1aa994d50e81b86d3e4d3c1130c8695b68907c673d9
   e5886a
Optimistic SPAKEChallenge: a1363034a003020102a122042047ca8c
                           24c3a4a70b6eca228322529dadcfa85c
                           f58faceecf5d5c02907b9e2deba20930
                           073005a003020101
SPAKESupport: a0093007a0053003020104
SPAKEChallenge: a1593057a003020104a145044302014cb2e5b592ece5990f
                0ef30d308c061de1598bc4272b4a6599bed466fd15216936
                42abcf4dbe36ce1a2d13967de45f6c4f8d0fa8e14428bf03
                fb96ef5f1ed3e645a20930073005a003020101
Transcript hash after challenge: cb925b8baeae5e2867ab5b10ae1c941c
                                 4ff4b58a4812c1f7bd1c862ad480a8e1
                                 c6fcd5e88d846a2045e385841c91a75a
                                 d2035f0ff692717608e2a5a90842eff2
Final transcript hash after pubkey: d0efed5e3e2c39c26034756d92a66fec
                                    3082ad793d0197f3f89ad36026f146a3
                                    996e548aa3fc49e2e82f8cac5d132c50
                                    5aa475b39e7be79cded22c26c41aa777
KDC-REQ-BODY: 3075a00703050000000000a1143012a003020101a10b3009
              1b077261656275726ea2101b0e415448454e412e4d49542e
              454455a3233021a003020102a11a30181b066b7262746774
              1b0e415448454e412e4d49542e454455a511180f31393730
              303130313030303030305aa703020100a8053003020112
K'[0]: 631fcc8596e7f40e59045950d72aa0b7
       bac2810a07b767050e983841cf3a2d4c
K'[1]: 881464920117074dbc67155a8f3341d1
       121ef65f78ea0380bfa81a134c1c47b1
K'[2]: 377b72ac3af2caad582d73ae4682fd56
       b531ee56706200dd6c38c42b8219837a
K'[3]: 35ad8e4d580ed3f0d15ad928329773c0
       81bd19f9a56363f3a5f77c7e66108c26
</pre><a class="pilcrow" href="#appendix-C-3">Â¶</a>
</div>
<p id="appendix-C-4">There are currently no encryption types with a seed size large enough
      to require multiple hash blocks during key derivation with any of the
      assigned hash functions. To exercise this possibility, the following
      test vector illustrates what keys would be derived if there were a copy
      of the edwards25519 group with group number -1 and associated hash
      function SHA-1:<a class="pilcrow" href="#appendix-C-4">Â¶</a></p>
<div class="lang-test-vector sourcecode" id="appendix-C-5">
<pre>AES256 edwards25519 SHA-1 group number -1
key: 01b897121d933ab44b47eb5494db15e50eb74530dbdae9b634d65020ff5d88c1
w (PRF+ output): 26da6b118cee6fa5ea795ed32d61490d
                 82b2f11102312f3f2fc04fb01c93df91
w (reduced multiplier): d166c7cc9e72ca8c61f6a9185a987251
                        81b2f11102312f3f2fc04fb01c93df01
x: 606c1b668008ed78fe2eee942e8f08007f3f1dcbef66d37fd69033525bda2030
y: 10fc4e0bb1a902e58f632a1ea0bceb366360ac985f46996d956a02572bfcf050
X: 389621509665abad35eaab26eab3a0f593c7b4380562aa5513c1140fd78ce048
Y: de3ed05986eeac518958b566f9bad065b321402025cd188f3d198dc55c6d6b8d
T: 2289a4f3c613e6e1df95e94aaa3c127dc062b9fceec3f9b62378dc729d61d0e3
S: f9a7fa352930dedb422d567700bfcd39ba221e7f9ac3e6b36f2b63b68b88642c
K: 6f61d6b18323b6c3ddaac7c56712845335384f095d3e116f69feb926a04f1340
SPAKESupport: a0093007a00530030201ff
SPAKEChallenge: a1363034a0030201ffa12204202289a4f3c613e6e1df95e9
                4aaa3c127dc062b9fceec3f9b62378dc729d61d0e3a20930
                073005a003020101
Transcript hash after challenge: f5c051eb75290f92142c
                                 bbe80557ec2c85902c94
Final transcript hash after pubkey: 9e26a3b148400c8f9cb8
                                    545331e4e7dcab399cc0
KDC-REQ-BODY: 3075a00703050000000000a1143012a003020101a10b3009
              1b077261656275726ea2101b0e415448454e412e4d49542e
              454455a3233021a003020102a11a30181b066b7262746774
              1b0e415448454e412e4d49542e454455a511180f31393730
              303130313030303030305aa703020100a8053003020112
K'[0]: 40bceb51bba474fd29ae65950022b704
       17b80d973fa8d8d6cd39833ff89964ad
K'[1]: c29a7315453dc1cce938fa12a9e5c0db
       2894b2194da14c9cd4f7bc3a6a37223d
K'[2]: f261984dba3c230fad99d324f871514e
       5aad670e44f00daef3264870b0851c25
K'[3]: d24b2b46bab7c4d1790017d9116a7eeb
       ca88b0562a5ad8989c826cb7dab715c7
</pre><a class="pilcrow" href="#appendix-C-5">Â¶</a>
</div>
</section>
<section id="appendix-D">
      <h2 id="name-acknowledgements">
<a class="section-name selfRef" href="#name-acknowledgements">Acknowledgements</a>
      </h2>
<p id="appendix-D-1"><span class="contact-name">Nico Williams</span> (Cryptonector)<a class="pilcrow" href="#appendix-D-1">Â¶</a></p>
<p id="appendix-D-2"><span class="contact-name">Taylor Yu</span> (MIT)<a class="pilcrow" href="#appendix-D-2">Â¶</a></p>
</section>
<div id="authors-addresses">
<section id="appendix-E">
      <h2 id="name-authors-addresses">
<a class="section-name selfRef" href="#name-authors-addresses">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Nathaniel McCallum</span></div>
<div class="left" dir="auto"><span class="org">Red Hat, Inc.</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:nathaniel@mccallum.life">nathaniel@mccallum.life</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Simo Sorce</span></div>
<div class="left" dir="auto"><span class="org">Red Hat, Inc.</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:ssorce@redhat.com">ssorce@redhat.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Robbie Harwood</span></div>
<div class="left" dir="auto"><span class="org">Red Hat, Inc.</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:rharwood@pm.me">rharwood@pm.me</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Greg Hudson</span></div>
<div class="left" dir="auto"><span class="org">MIT</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:ghudson@mit.edu">ghudson@mit.edu</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>


</body></html>