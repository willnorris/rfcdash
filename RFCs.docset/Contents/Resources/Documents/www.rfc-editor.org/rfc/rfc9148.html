<!DOCTYPE html>
<html class="RFC" lang="en"><head>
<meta charset="utf-8"/>
<meta content="Common,Latin" name="scripts"/>
<meta content="initial-scale=1.0" name="viewport"/>
<title>RFC 9148: EST-coaps: Enrollment over Secure Transport with the Secure Constrained Application Protocol</title>
<meta content="Peter van der Stok" name="author"/>
<meta content="Panos Kampanakis" name="author"/>
<meta content="Michael C. Richardson" name="author"/>
<meta content="Shahid Raza" name="author"/>
<meta content="
       Enrollment over Secure Transport (EST) is used as a certificate provisioning
   protocol over HTTPS. Low-resource devices often use the lightweight Constrained
   Application Protocol (CoAP) for message exchanges. This document defines how to
   transport EST payloads over secure CoAP (EST-coaps), which allows
   constrained devices to use existing EST functionality for provisioning certificates.

 
    " name="description"/>
<meta content="xml2rfc 3.12.2" name="generator"/>
<meta content="EST" name="keyword"/>
<meta content="CoAPS" name="keyword"/>
<meta content="Constrained-Voucher" name="keyword"/>
<meta content="Constrained-Enrollment" name="keyword"/>
<meta content="BRSKI" name="keyword"/>
<meta content="9148" name="rfc.number"/>
<!-- Generator version information:
  xml2rfc 3.12.2
    Python 3.6.15
    appdirs 1.4.4
    ConfigArgParse 1.4.1
    google-i18n-address 2.4.0
    html5lib 1.0.1
    intervaltree 3.0.2
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.4.2
    pycairo 1.15.1
    pycountry 19.8.18
    pyflakes 2.1.1
    PyYAML 5.4.1
    requests 2.24.0
    setuptools 40.5.0
    six 1.14.0
    WeasyPrint 52.5
-->
<link href="rfc9148.xml" rel="alternate" type="application/rfc+xml"/>
<link href="#copyright" rel="license"/>
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css"/>
<link href="https://dx.doi.org/10.17487/rfc9148" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <link href="https://datatracker.ietf.org/doc/draft-ietf-ace-coap-est-18" rel="prev"/>
  </head>
<body>
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 9148</td>
<td class="center">EST-coaps</td>
<td class="right">April 2022</td>
</tr></thead>
<tfoot><tr>
<td class="left">van der Stok, et al.</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div class="document-information" id="external-metadata"></div>
<div class="document-information" id="internal-metadata">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a class="eref" href="https://www.rfc-editor.org/rfc/rfc9148">9148</a></dd>
<dt class="label-category">Category:</dt>
<dd class="category">Standards Track</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time class="published" datetime="2022-04">April 2022</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">P. van der Stok</div>
<div class="org">Consultant</div>
</div>
<div class="author">
      <div class="author-name">P. Kampanakis</div>
<div class="org">Cisco Systems</div>
</div>
<div class="author">
      <div class="author-name">M. Richardson</div>
<div class="org">SSW</div>
</div>
<div class="author">
      <div class="author-name">S. Raza</div>
<div class="org">RISE Research Institutes of Sweden</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 9148</h1>
<h1 id="title">EST-coaps: Enrollment over Secure Transport with the Secure Constrained Application Protocol</h1>
<section id="section-abstract">
      <h2 id="abstract"><a class="selfRef" href="#abstract">Abstract</a></h2>
<p id="section-abstract-1">Enrollment over Secure Transport (EST) is used as a certificate provisioning
   protocol over HTTPS. Low-resource devices often use the lightweight Constrained
   Application Protocol (CoAP) for message exchanges. This document defines how to
   transport EST payloads over secure CoAP (EST-coaps), which allows
   constrained devices to use existing EST functionality for provisioning certificates.<a class="pilcrow" href="#section-abstract-1">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a class="section-name selfRef" href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This is an Internet Standards Track document.<a class="pilcrow" href="#section-boilerplate.1-1">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.<a class="pilcrow" href="#section-boilerplate.1-2">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc9148">https://www.rfc-editor.org/info/rfc9148</a></span>.<a class="pilcrow" href="#section-boilerplate.1-3">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a class="section-name selfRef" href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2022 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a class="pilcrow" href="#section-boilerplate.2-1">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a class="pilcrow" href="#section-boilerplate.2-2">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a class="toplink" href="#" onclick="scroll(0,0)">▲</a><h2 id="name-table-of-contents">
<a class="section-name selfRef" href="#name-table-of-contents">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p class="keepWithNext" id="section-toc.1-1.1.1"><a class="xref" href="#section-1">1</a>.  <a class="xref" href="#name-introduction">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p class="keepWithNext" id="section-toc.1-1.2.1"><a class="xref" href="#section-2">2</a>.  <a class="xref" href="#name-terminology">Terminology</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p class="keepWithNext" id="section-toc.1-1.3.1"><a class="xref" href="#section-3">3</a>.  <a class="xref" href="#name-dtls-and-conformance-to-rfc">DTLS and Conformance to RFC 7925 Profiles</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a class="xref" href="#section-4">4</a>.  <a class="xref" href="#name-protocol-design">Protocol Design</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a class="xref" href="#section-4.1">4.1</a>.  <a class="xref" href="#name-discovery-and-uris">Discovery and URIs</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a class="xref" href="#section-4.2">4.2</a>.  <a class="xref" href="#name-mandatory-optional-est-func">Mandatory/Optional EST Functions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a class="xref" href="#section-4.3">4.3</a>.  <a class="xref" href="#name-payload-formats">Payload Formats</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a class="xref" href="#section-4.4">4.4</a>.  <a class="xref" href="#name-message-bindings">Message Bindings</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a class="xref" href="#section-4.5">4.5</a>.  <a class="xref" href="#name-coap-response-codes">CoAP Response Codes</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.6">
                <p id="section-toc.1-1.4.2.6.1"><a class="xref" href="#section-4.6">4.6</a>.  <a class="xref" href="#name-message-fragmentation">Message Fragmentation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.7">
                <p id="section-toc.1-1.4.2.7.1"><a class="xref" href="#section-4.7">4.7</a>.  <a class="xref" href="#name-delayed-responses">Delayed Responses</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.8">
                <p id="section-toc.1-1.4.2.8.1"><a class="xref" href="#section-4.8">4.8</a>.  <a class="xref" href="#name-server-side-key-generation">Server-Side Key Generation</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a class="xref" href="#section-5">5</a>.  <a class="xref" href="#name-https-coaps-registrar">HTTPS-CoAPS Registrar</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a class="xref" href="#section-6">6</a>.  <a class="xref" href="#name-parameters">Parameters</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a class="xref" href="#section-7">7</a>.  <a class="xref" href="#name-deployment-limitations">Deployment Limitations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a class="xref" href="#section-8">8</a>.  <a class="xref" href="#name-iana-considerations">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a class="xref" href="#section-8.1">8.1</a>.  <a class="xref" href="#name-content-formats-registry">Content-Formats Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a class="xref" href="#section-8.2">8.2</a>.  <a class="xref" href="#name-resource-type-registry">Resource Type Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a class="xref" href="#section-8.3">8.3</a>.  <a class="xref" href="#name-well-known-uris-registry">Well-Known URIs Registry</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a class="xref" href="#section-9">9</a>.  <a class="xref" href="#name-security-considerations">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a class="xref" href="#section-9.1">9.1</a>.  <a class="xref" href="#name-est-server-considerations">EST Server Considerations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a class="xref" href="#section-9.2">9.2</a>.  <a class="xref" href="#name-https-coaps-registrar-consi">HTTPS-CoAPS Registrar Considerations</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a class="xref" href="#section-10">10</a>. <a class="xref" href="#name-references">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a class="xref" href="#section-10.1">10.1</a>.  <a class="xref" href="#name-normative-references">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a class="xref" href="#section-10.2">10.2</a>.  <a class="xref" href="#name-informative-references">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a class="xref" href="#appendix-A">Appendix A</a>.  <a class="xref" href="#name-est-messages-to-est-coaps">EST Messages to EST-coaps</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a class="xref" href="#appendix-A.1">A.1</a>.  <a class="xref" href="#name-cacerts">cacerts</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a class="xref" href="#appendix-A.2">A.2</a>.  <a class="xref" href="#name-enroll-reenroll">enroll / reenroll</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.3">
                <p id="section-toc.1-1.11.2.3.1"><a class="xref" href="#appendix-A.3">A.3</a>.  <a class="xref" href="#name-serverkeygen">serverkeygen</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.4">
                <p id="section-toc.1-1.11.2.4.1"><a class="xref" href="#appendix-A.4">A.4</a>.  <a class="xref" href="#name-csrattrs">csrattrs</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a class="xref" href="#appendix-B">Appendix B</a>.  <a class="xref" href="#name-est-coaps-block-message-exa">EST-coaps Block Message Examples</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a class="xref" href="#appendix-B.1">B.1</a>.  <a class="xref" href="#name-cacerts-2">cacerts</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a class="xref" href="#appendix-B.2">B.2</a>.  <a class="xref" href="#name-enroll-reenroll-2">enroll / reenroll</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a class="xref" href="#appendix-C">Appendix C</a>.  <a class="xref" href="#name-message-content-breakdown">Message Content Breakdown</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a class="xref" href="#appendix-C.1">C.1</a>.  <a class="xref" href="#name-cacerts-3">cacerts</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a class="xref" href="#appendix-C.2">C.2</a>.  <a class="xref" href="#name-enroll-reenroll-3">enroll / reenroll</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.3">
                <p id="section-toc.1-1.13.2.3.1"><a class="xref" href="#appendix-C.3">C.3</a>.  <a class="xref" href="#name-serverkeygen-2">serverkeygen</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a class="xref" href="#appendix-D"></a><a class="xref" href="#name-acknowledgements">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a class="xref" href="#appendix-E"></a><a class="xref" href="#name-contributors">Contributors</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a class="xref" href="#appendix-F"></a><a class="xref" href="#name-authors-addresses">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="intro">
<section id="section-1">
      <h2 id="name-introduction">
<a class="section-number selfRef" href="#section-1">1. </a><a class="section-name selfRef" href="#name-introduction">Introduction</a>
      </h2>
<p id="section-1-1">"Classical" Enrollment over Secure Transport (EST) <span>[<a class="xref" href="#RFC7030">RFC7030</a>]</span>
 is used for authenticated/authorized endpoint certificate enrollment (and
 optionally key provisioning) through a Certification Authority (CA) or
 Registration Authority (RA). EST transports messages over HTTPS.<a class="pilcrow" href="#section-1-1">¶</a></p>
<p id="section-1-2">This document defines a new transport for EST based on the Constrained
   Application Protocol (CoAP) since some Internet of Things (IoT) devices
   use CoAP instead of HTTP. Therefore, this specification utilizes DTLS
   <span>[<a class="xref" href="#RFC6347">RFC6347</a>]</span> and CoAP <span>[<a class="xref" href="#RFC7252">RFC7252</a>]</span> instead of
   TLS <span>[<a class="xref" href="#RFC8446">RFC8446</a>]</span> and HTTP <span>[<a class="xref" href="#RFC7230">RFC7230</a>]</span>.<a class="pilcrow" href="#section-1-2">¶</a></p>
<p id="section-1-3">EST responses can be relatively large, and for this reason, this
   specification also uses CoAP Block-Wise Transfer <span>[<a class="xref" href="#RFC7959">RFC7959</a>]</span> to
   offer a fragmentation mechanism of EST messages at the CoAP layer.<a class="pilcrow" href="#section-1-3">¶</a></p>
<p id="section-1-4">This document also profiles the use of EST to support
      certificate-based client authentication only. Neither HTTP Basic nor Digest
      authentication (as described in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc7030#section-3.2.3">Section 3.2.3</a> of [<a class="xref" href="#RFC7030">RFC7030</a>]</span>) is supported.<a class="pilcrow" href="#section-1-4">¶</a></p>
</section>
</div>
<div id="terminology">
<section id="section-2">
      <h2 id="name-terminology">
<a class="section-number selfRef" href="#section-2">2. </a><a class="section-name selfRef" href="#name-terminology">Terminology</a>
      </h2>
<p id="section-2-1">
    The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
    "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
    described in BCP 14 <span>[<a class="xref" href="#RFC2119">RFC2119</a>]</span> <span>[<a class="xref" href="#RFC8174">RFC8174</a>]</span> 
    when, and only when, they appear in all capitals, as shown here.<a class="pilcrow" href="#section-2-1">¶</a></p>
<p id="section-2-2">Many of the concepts in this document are taken from <span>[<a class="xref" href="#RFC7030">RFC7030</a>]</span>. Consequently, much text is directly traceable to <span>[<a class="xref" href="#RFC7030">RFC7030</a>]</span>.<a class="pilcrow" href="#section-2-2">¶</a></p>
</section>
</div>
<div id="profile7925">
<section id="section-3">
      <h2 id="name-dtls-and-conformance-to-rfc">
<a class="section-number selfRef" href="#section-3">3. </a><a class="section-name selfRef" href="#name-dtls-and-conformance-to-rfc">DTLS and Conformance to RFC 7925 Profiles</a>
      </h2>
<p id="section-3-1">This section describes how EST-coaps conforms to the profiles of
      low-resource devices described in <span>[<a class="xref" href="#RFC7925">RFC7925</a>]</span>.  EST-coaps can transport certificates and private
      keys. Certificates are responses to (re-)enrollment requests or requests
      for a trusted certificate list. Private keys can be transported as
      responses to a server-side key generation request as described in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc7030#section-4.4">Section 4.4</a> of [<a class="xref" href="#RFC7030">RFC7030</a>]</span> (and subsections)
      and discussed in <a class="xref" href="#serverkey">Section 4.8</a> of this
      document.<a class="pilcrow" href="#section-3-1">¶</a></p>
<p id="section-3-2">EST-coaps depends on a secure transport mechanism that secures the exchanged CoAP messages. DTLS is one such secure protocol. No other changes are necessary regarding the secure transport of EST messages.<a class="pilcrow" href="#section-3-2">¶</a></p>
<span id="name-est-coaps-protocol-layers"></span><div id="est-coaps-layers">
<figure id="figure-1">
        <div class="alignCenter art-text artwork" id="section-3-3.1">
<pre>+------------------------------------------------+
|    EST request/response messages               |
+------------------------------------------------+
|    CoAP for message transfer and signaling     |
+------------------------------------------------+
|    Secure Transport                            |
+------------------------------------------------+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-1">Figure 1</a>:
<a class="selfRef" href="#name-est-coaps-protocol-layers">EST-coaps Protocol Layers</a>
        </figcaption></figure>
</div>
<p id="section-3-4">
    In accordance with Sections <a class="relref" href="https://www.rfc-editor.org/rfc/rfc7925#section-3.3">3.3</a> and <a class="relref" href="https://www.rfc-editor.org/rfc/rfc7925#section-4.4">4.4</a> of <span>[<a class="xref" href="#RFC7925">RFC7925</a>]</span>, the
    mandatory cipher suite for DTLS in EST-coaps is
    TLS_ECDHE_ECDSA_WITH_AES_128_CCM_8 <span>[<a class="xref" href="#RFC7251">RFC7251</a>]</span>.
    Curve secp256r1 <span class="bcp14">MUST</span>
    be supported <span>[<a class="xref" href="#RFC8422">RFC8422</a>]</span>; this curve is equivalent to the
    NIST P-256 curve. After the publication of <span>[<a class="xref" href="#RFC7748">RFC7748</a>]</span>, 
 support for Curve25519 will likely be required in the future by 
 (D)TLS profiles for the Internet of Things <span>[<a class="xref" href="#RFC7925">RFC7925</a>]</span>.<a class="pilcrow" href="#section-3-4">¶</a></p>
<p id="section-3-5">DTLS 1.2 implementations must use the Supported Elliptic Curves and Supported
    Point Formats Extensions in <span>[<a class="xref" href="#RFC8422">RFC8422</a>]</span>. Uncompressed point
    format must also be supported. DTLS 1.3 <span>[<a class="xref" href="#RFC9147">RFC9147</a>]</span>
 implementations differ from DTLS 1.2 
    because they do not support point format negotiation in favor of a single
    point format for each curve. Thus, support for DTLS 1.3 does not mandate
 point format extensions and negotiation. In addition, in DTLS 1.3, the 
    Supported Elliptic Curves extension has been renamed to Supported Groups.<a class="pilcrow" href="#section-3-5">¶</a></p>
<p id="section-3-6">CoAP was designed to avoid IP fragmentation. DTLS is used to secure
      CoAP messages. However, fragmentation is still possible at the DTLS
      layer during the DTLS handshake even when using Elliptic Curve
      Cryptography (ECC) cipher suites. If fragmentation is necessary, "DTLS
      provides a mechanism for fragmenting a handshake message over a number
      of records, each of which can be transmitted separately, thus avoiding
      IP fragmentation" <span>[<a class="xref" href="#RFC6347">RFC6347</a>]</span>.<a class="pilcrow" href="#section-3-6">¶</a></p>
<p id="section-3-7">The authentication of the EST-coaps server by the EST-coaps client is
      based on certificate authentication in the DTLS handshake.  The
      EST-coaps client <span class="bcp14">MUST</span> be configured with at least an
      Implicit Trust Anchor database, which will enable the authentication
      of the server the first time before updating its trust anchor (Explicit
      TA) <span>[<a class="xref" href="#RFC7030">RFC7030</a>]</span>.<a class="pilcrow" href="#section-3-7">¶</a></p>
<p id="section-3-8">The authentication of the EST-coaps client <span class="bcp14">MUST</span> be with a client certificate
 in the DTLS handshake. This can either be:<a class="pilcrow" href="#section-3-8">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-9.1">A previously issued client certificate (e.g., an existing
        certificate issued by the EST CA); this could be a common case for
        simple re-enrollment of clients.<a class="pilcrow" href="#section-3-9.1">¶</a>
</li>
        <li class="normal" id="section-3-9.2">A previously installed certificate (e.g., manufacturer IDevID
        <span>[<a class="xref" href="#IEEE802.1AR">IEEE802.1AR</a>]</span> or a certificate issued
        by some other party). IDevID's are expected to have a very long life,
        as long as the device, but under some conditions could expire. In that
        case, the server <span class="bcp14">MAY</span> authenticate a client certificate
        against its trust store though the certificate is expired (<a class="xref" href="#sec">Section 9</a>).<a class="pilcrow" href="#section-3-9.2">¶</a>
</li>
      </ul>
<p id="section-3-10">EST-coaps supports the certificate types and TAs that
      are specified for EST in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc7030#section-3">Section 3</a> of [<a class="xref" href="#RFC7030">RFC7030</a>]</span>.<a class="pilcrow" href="#section-3-10">¶</a></p>
<p id="section-3-11">As described in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc5272#section-2.1">Section 2.1</a> of [<a class="xref" href="#RFC5272">RFC5272</a>]</span>, proof-of-identity refers to a value that can be used to
      prove that an end entity or client is in the possession of and can use
      the private key corresponding to the certified public key. Additionally,
      channel-binding information can link proof-of-identity with an
      established connection.  Connection-based proof-of-possession is
      <span class="bcp14">OPTIONAL</span> for EST-coaps clients and servers. When
      proof-of-possession is desired, a set of actions are required regarding
      the use of tls-unique, described in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc7030#section-3.5">Section 3.5</a> of [<a class="xref" href="#RFC7030">RFC7030</a>]</span>. The tls-unique information consists
      of the contents of the first Finished message in the (D)TLS handshake
      between server and client <span>[<a class="xref" href="#RFC5929">RFC5929</a>]</span>. The
      client adds the Finished message as a challengePassword in the
      attributes section of the PKCS #10 CertificationRequest <span>[<a class="xref" href="#RFC5967">RFC5967</a>]</span> to prove that the client is indeed
      in control of the private key at the time of the (D)TLS session
      establishment. In the case of handshake message fragmentation, if
      proof-of-possession is desired, the Finished message added as the
      challengePassword in the Certificate Signing Request (CSR) is calculated
      as specified by (D)TLS. We summarize it here for convenience. For DTLS
      1.2, in the event of handshake message fragmentation, the hash of the
      handshake messages used in the Message Authentication Code (MAC)
      calculation of the Finished message must be computed on each reassembled
      message, as if each message had not been fragmented (<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc6347#section-4.2.6">Section 4.2.6</a> of [<a class="xref" href="#RFC6347">RFC6347</a>]</span>). The Finished
      message is calculated as shown in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc5246#section-7.4.9">Section 7.4.9</a> of [<a class="xref" href="#RFC5246">RFC5246</a>]</span>.<a class="pilcrow" href="#section-3-11">¶</a></p>
<p id="section-3-12">For (D)TLS 1.3, <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8446#appendix-C.5">Appendix C.5</a> of [<a class="xref" href="#RFC8446">RFC8446</a>]</span> describes the lack of channel bindings similar to
   tls-unique.
   <span>[<a class="xref" href="#I-D.ietf-kitten-tls-channel-bindings-for-tls13">TLS13-CHANNEL-BINDINGS</a>]</span>
   can be used instead to derive a 32-byte tls-exporter binding from
   the (D)TLS 1.3 master secret by using a PRF negotiated in the (D)TLS
   1.3 handshake, "EXPORTER-Channel-Binding" with no terminating NUL as
   the label, the ClientHello.random and ServerHello.random, and a
   zero-length context string.  When proof-of-possession is desired, the
   client adds the tls-exporter value as a challengePassword in the
   attributes section of the PKCS #10 CertificationRequest <span>[<a class="xref" href="#RFC5967">RFC5967</a>]</span> to prove that the client is
   indeed in control of the private key at the time of the (D)TLS
   session establishment.<a class="pilcrow" href="#section-3-12">¶</a></p>
<p id="section-3-13">In a constrained CoAP environment, endpoints can't always afford to
   establish a DTLS connection for every EST transaction. An EST-coaps DTLS
   connection <span class="bcp14">MAY</span> remain open for sequential EST transactions,
   which was not the case with <span>[<a class="xref" href="#RFC7030">RFC7030</a>]</span>.  For
   example, if a /crts request is followed by a /sen request, both can use the
   same authenticated DTLS connection. However, when a /crts request is
   included in the set of sequential EST transactions, some additional
   security considerations apply regarding the use of the Implicit and
   Explicit TA database as explained in <a class="xref" href="#sec-est">Section 9.1</a>.<a class="pilcrow" href="#section-3-13">¶</a></p>
<p id="section-3-14">Given that after a successful enrollment, it is more likely that a
      new EST transaction will not take place for a significant amount of
      time, the DTLS connections <span class="bcp14">SHOULD</span> only be kept alive for
      EST messages that are relatively close to each other. These could
      include a /sen immediately following a /crts when a device is getting
      bootstrapped. In some cases, like NAT rebinding, keeping the state of a
      connection is not possible when devices sleep for extended periods of
      time. In such occasions, <span>[<a class="xref" href="#RFC9146">RFC9146</a>]</span> negotiates a connection ID that can eliminate the
      need for a new handshake and its additional cost; or, DTLS session
      resumption provides a less costly alternative than redoing a full DTLS
      handshake.<a class="pilcrow" href="#section-3-14">¶</a></p>
</section>
</div>
<div id="design">
<section id="section-4">
      <h2 id="name-protocol-design">
<a class="section-number selfRef" href="#section-4">4. </a><a class="section-name selfRef" href="#name-protocol-design">Protocol Design</a>
      </h2>
<p id="section-4-1">EST-coaps uses CoAP to transfer EST messages, aided by Block-Wise Transfer
 <span>[<a class="xref" href="#RFC7959">RFC7959</a>]</span>, to avoid IP 
 fragmentation. The use of blocks for the transfer of larger
 EST messages is specified in <a class="xref" href="#fragment">Section 4.6</a>. 
 <a class="xref" href="#est-coaps-layers">Figure 1</a> shows the layered EST-coaps
 architecture.<a class="pilcrow" href="#section-4-1">¶</a></p>
<p id="section-4-2">The EST-coaps protocol design follows closely the EST design. The supported 
  message types in EST-coaps are:<a class="pilcrow" href="#section-4-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-3.1">CA certificate retrieval needed to receive the complete set of CA certificates.<a class="pilcrow" href="#section-4-3.1">¶</a>
</li>
        <li class="normal" id="section-4-3.2">Simple enroll and re-enroll for a CA to sign client identity public keys.<a class="pilcrow" href="#section-4-3.2">¶</a>
</li>
        <li class="normal" id="section-4-3.3">Certificate Signing Request (CSR) attribute messages that informs the client 
 of the fields to include in a CSR.<a class="pilcrow" href="#section-4-3.3">¶</a>
</li>
        <li class="normal" id="section-4-3.4">Server-side key generation messages to provide a client identity private key when the client chooses so.<a class="pilcrow" href="#section-4-3.4">¶</a>
</li>
      </ul>
<p id="section-4-4">
  While <span>[<a class="xref" href="#RFC7030">RFC7030</a>]</span> permits a number of the EST functions to be used without
  authentication, this specification requires that the client <span class="bcp14">MUST</span> be authenticated 
  for all functions.<a class="pilcrow" href="#section-4-4">¶</a></p>
<div id="discovery">
<section id="section-4.1">
        <h3 id="name-discovery-and-uris">
<a class="section-number selfRef" href="#section-4.1">4.1. </a><a class="section-name selfRef" href="#name-discovery-and-uris">Discovery and URIs</a>
        </h3>
<p id="section-4.1-1">EST-coaps is targeted for low-resource networks with small packets. Two types of installations are possible: (1) a rigid one, where the address and the supported functions of the EST server(s) are known, and (2) a flexible one, where the EST server and its supported functions need to be discovered.<a class="pilcrow" href="#section-4.1-1">¶</a></p>
<p id="section-4.1-2">For both types of installations, saving header space is important and short EST-coaps URIs are specified in this document. These URIs are shorter than the ones in <span>[<a class="xref" href="#RFC7030">RFC7030</a>]</span>. Two example EST-coaps resource path names are:<a class="pilcrow" href="#section-4.1-2">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1-3">
<pre>coaps://example.com:&lt;port&gt;/.well-known/est/&lt;short-est&gt;
coaps://example.com:&lt;port&gt;/.well-known/est/ArbitraryLabel/&lt;short-est&gt;
</pre><a class="pilcrow" href="#section-4.1-3">¶</a>
</div>
<p id="section-4.1-4">The short-est strings are defined in <a class="xref" href="#est-uri">Table 1</a>. 
   Arbitrary Labels are usually defined and used by EST CAs in order
   to route client requests to the appropriate certificate profile. 
   Implementers should consider using short labels to minimize 
   transmission overhead.<a class="pilcrow" href="#section-4.1-4">¶</a></p>
<p id="section-4.1-5">The EST-coaps server URIs, obtained through discovery of the 
   EST-coaps resource(s) as shown below, are of the form:<a class="pilcrow" href="#section-4.1-5">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1-6">
<pre>coaps://example.com:&lt;port&gt;/&lt;root-resource&gt;/&lt;short-est&gt;
coaps://example.com:&lt;port&gt;/&lt;root-resource&gt;/ArbitraryLabel/&lt;short-est&gt;
</pre><a class="pilcrow" href="#section-4.1-6">¶</a>
</div>
<p id="section-4.1-7">Figure 5 in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc7030#section-3.2.2">Section 3.2.2</a> of [<a class="xref" href="#RFC7030">RFC7030</a>]</span> enumerates the operations and corresponding paths
        that are supported by EST. <a class="xref" href="#est-uri">Table 1</a>
        provides the mapping from the EST URI path to the shorter EST-coaps
        URI path.<a class="pilcrow" href="#section-4.1-7">¶</a></p>
<span id="name-short-est-coaps-uri-path"></span><div id="est-uri">
<table class="center" id="table-1">
          <caption>
<a class="selfRef" href="#table-1">Table 1</a>:
<a class="selfRef" href="#name-short-est-coaps-uri-path">Short EST-coaps URI Path</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">EST</th>
              <th class="text-left" colspan="1" rowspan="1">EST-coaps</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1"> /cacerts  </td>
              <td class="text-left" colspan="1" rowspan="1"> /crts </td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1"> /simpleenroll </td>
              <td class="text-left" colspan="1" rowspan="1"> /sen </td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1"> /simplereenroll </td>
              <td class="text-left" colspan="1" rowspan="1"> /sren </td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1"> /serverkeygen </td>
              <td class="text-left" colspan="1" rowspan="1"> /skg (PKCS #7) </td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1"> /serverkeygen </td>
              <td class="text-left" colspan="1" rowspan="1"> /skc (application/pkix-cert)</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1"> /csrattrs </td>
              <td class="text-left" colspan="1" rowspan="1"> /att </td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-4.1-9">The /skg message is the EST /serverkeygen equivalent where the
        client requests a certificate in PKCS #7 format and a private key. If
        the client prefers a single application/pkix-cert certificate instead
        of PKCS #7, it will make an /skc request. In both cases (i.e., /skg,
        /skc), a private key <span class="bcp14">MUST</span> be returned.<a class="pilcrow" href="#section-4.1-9">¶</a></p>
<p id="section-4.1-10">Clients and servers <span class="bcp14">MUST</span> support the short resource EST-coaps URIs.<a class="pilcrow" href="#section-4.1-10">¶</a></p>
<p id="section-4.1-11">In the context of CoAP, the presence and location of (path to) the
      EST resources are discovered by sending a GET request to
      "/.well-known/core" including a resource type (RT) parameter with the
      value "ace.est*" <span>[<a class="xref" href="#RFC6690">RFC6690</a>]</span>. The example
      below shows the discovery over CoAPS of the presence and location of
      EST-coaps resources. Linefeeds are included only for readability.<a class="pilcrow" href="#section-4.1-11">¶</a></p>
<div id="section-4.1-12">
<pre class="lang-core-link-format sourcecode">  REQ: GET /.well-known/core?rt=ace.est*

  RES: 2.05 Content
&lt;/est/crts&gt;;rt="ace.est.crts";ct="281 287",
&lt;/est/sen&gt;;rt="ace.est.sen";ct="281 287",
&lt;/est/sren&gt;;rt="ace.est.sren";ct="281 287",
&lt;/est/att&gt;;rt="ace.est.att";ct=285,
&lt;/est/skg&gt;;rt="ace.est.skg";ct=62,
&lt;/est/skc&gt;;rt="ace.est.skc";ct=62
</pre><a class="pilcrow" href="#section-4.1-12">¶</a>
</div>
<p id="section-4.1-13">The first three lines, describing ace.est.crts, ace.est.sen, and
      ace.est.sren, of the discovery response above <span class="bcp14">MUST</span> be
      returned if the server supports resource discovery. The last three lines
      are only included if the corresponding EST functions are implemented
      (see <a class="xref" href="#est-implementation">Table 2</a>). The
      Content-Formats in the response allow the client to request one that is
      supported by the server. These are the values that would be sent in the
      client request with an Accept Option.<a class="pilcrow" href="#section-4.1-13">¶</a></p>
<p id="section-4.1-14">Discoverable port numbers can be returned in the response payload. An example response payload for non-default CoAPS server port 61617 follows below. Linefeeds are included only for readability.<a class="pilcrow" href="#section-4.1-14">¶</a></p>
<div id="section-4.1-15">
<pre class="lang-core-link-format sourcecode">  REQ: GET /.well-known/core?rt=ace.est*

  RES: 2.05 Content
&lt;coaps://[2001:db8:3::123]:61617/est/crts&gt;;rt="ace.est.crts";
              ct="281 287",
&lt;coaps://[2001:db8:3::123]:61617/est/sen&gt;;rt="ace.est.sen";
              ct="281 287",
&lt;coaps://[2001:db8:3::123]:61617/est/sren&gt;;rt="ace.est.sren";
              ct="281 287",
&lt;coaps://[2001:db8:3::123]:61617/est/att&gt;;rt="ace.est.att";
              ct=285,
&lt;coaps://[2001:db8:3::123]:61617/est/skg&gt;;rt="ace.est.skg";
              ct=62,
&lt;coaps://[2001:db8:3::123]:61617/est/skc&gt;;rt="ace.est.skc";
              ct=62
</pre><a class="pilcrow" href="#section-4.1-15">¶</a>
</div>
<p id="section-4.1-16">The server <span class="bcp14">MUST</span> support the default /.well-known/est  
   root resource. The server <span class="bcp14">SHOULD</span> support 
   resource discovery when it supports non-default URIs 
   (like /est or /est/ArbitraryLabel) or ports. The client 
   <span class="bcp14">SHOULD</span> use resource discovery when it is unaware 
   of the available EST-coaps resources.<a class="pilcrow" href="#section-4.1-16">¶</a></p>
<p id="section-4.1-17">Throughout this document, the example root resource of /est is used.<a class="pilcrow" href="#section-4.1-17">¶</a></p>
</section>
</div>
<div id="implementation">
<section id="section-4.2">
        <h3 id="name-mandatory-optional-est-func">
<a class="section-number selfRef" href="#section-4.2">4.2. </a><a class="section-name selfRef" href="#name-mandatory-optional-est-func">Mandatory/Optional EST Functions</a>
        </h3>
<p id="section-4.2-1">
This specification contains a set of required-to-implement functions, optional
functions, and not-specified functions. The unspecified functions are deemed
too expensive for low-resource devices in payload and calculation times.<a class="pilcrow" href="#section-4.2-1">¶</a></p>
<p id="section-4.2-2"> <a class="xref" href="#est-implementation">Table 2</a> specifies the
        mandatory-to-implement or optional implementation of the EST-coaps
        functions. Discovery of the existence of optional functions is
        described in <a class="xref" href="#discovery">Section 4.1</a>.<a class="pilcrow" href="#section-4.2-2">¶</a></p>
<span id="name-list-of-est-coaps-functions"></span><div id="est-implementation">
<table class="center" id="table-2">
          <caption>
<a class="selfRef" href="#table-2">Table 2</a>:
<a class="selfRef" href="#name-list-of-est-coaps-functions">List of EST-coaps Functions</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">EST Functions</th>
              <th class="text-left" colspan="1" rowspan="1">EST-coaps Implementation</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1"> /cacerts  </td>
              <td class="text-left" colspan="1" rowspan="1">
                <span class="bcp14">MUST</span> </td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1"> /simpleenroll </td>
              <td class="text-left" colspan="1" rowspan="1">
                <span class="bcp14">MUST</span> </td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1"> /simplereenroll </td>
              <td class="text-left" colspan="1" rowspan="1">
                <span class="bcp14">MUST</span> </td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1"> /fullcmc     </td>
              <td class="text-left" colspan="1" rowspan="1"> Not specified </td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1"> /serverkeygen </td>
              <td class="text-left" colspan="1" rowspan="1">
                <span class="bcp14">OPTIONAL</span> </td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1"> /csrattrs </td>
              <td class="text-left" colspan="1" rowspan="1">
                <span class="bcp14">OPTIONAL</span> </td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="format">
<section id="section-4.3">
        <h3 id="name-payload-formats">
<a class="section-number selfRef" href="#section-4.3">4.3. </a><a class="section-name selfRef" href="#name-payload-formats">Payload Formats</a>
        </h3>
<p id="section-4.3-1">EST-coaps is designed for low-resource devices; hence, it does not need
   to send Base64-encoded data. Simple binary is more efficient (30% smaller payload for DER-encoded ASN.1) and
   well supported by CoAP. Thus, the payload for a given media type follows the ASN.1
   structure of the media type and is transported in binary format.<a class="pilcrow" href="#section-4.3-1">¶</a></p>
<p id="section-4.3-2">The Content-Format (HTTP Content-Type equivalent) of the CoAP message
      determines which EST message is transported in the CoAP payload. The
      media types specified in the HTTP Content-Type header field (<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc7030#section-3.2.4">Section 3.2.4</a> of [<a class="xref" href="#RFC7030">RFC7030</a>]</span>) are specified by
      the Content-Format Option (12) of CoAP. The combination of URI-Path and
      Content-Format in EST-coaps <span class="bcp14">MUST</span> map to an allowed
      combination of URI and media type in EST. The required Content-Formats
      for these requests and response messages are defined in <a class="xref" href="#Content-Formats">Section 8.1</a>. The CoAP response codes are
      defined in <a class="xref" href="#codes">Section 4.5</a>.<a class="pilcrow" href="#section-4.3-2">¶</a></p>
<p id="section-4.3-3">Content-Format 287 can be used in place of 281 to carry a single 
      certificate instead of a PKCS #7 container 
      in a /crts, /sen, /sren, or /skg response. 
      Content-Format 281 <span class="bcp14">MUST</span> be supported by EST-coaps servers. 
   Servers <span class="bcp14">MAY</span> also support Content-Format 287.
   It is up to the client to support only Content-Format 281, 
   287 or both. 
      The client will use 
   a CoAP Accept Option in the request to express the 
   preferred response Content-Format. If an Accept Option is 
      not included in the request, the client is not expressing 
      any preference and the server <span class="bcp14">SHOULD</span> choose format 281.<a class="pilcrow" href="#section-4.3-3">¶</a></p>
<p id="section-4.3-4">Content-Format 286 is used in /sen, /sren, and /skg requests 
   and 285 in /att responses.<a class="pilcrow" href="#section-4.3-4">¶</a></p>
<p id="section-4.3-5">
      A representation with Content-Format identifier 62 contains a collection
      of representations along with their respective Content-Format. The
      Content-Format identifies the media type application/multipart-core
      specified in <span>[<a class="xref" href="#RFC8710">RFC8710</a>]</span>.  For example, a collection, containing two
      representations in response to an EST-coaps server-side key generation
      /skg request, could include a private key in PKCS #8 <span>[<a class="xref" href="#RFC5958">RFC5958</a>]</span> with Content-Format identifier 284
      (0x011C) and a single certificate in a PKCS #7 container with
      Content-Format identifier 281 (0x0119).  Such a collection would look
      like [284,h'0123456789abcdef', 281,h'fedcba9876543210'] in diagnostic
      Concise Binary Object Representation (CBOR) notation. The serialization of such CBOR content would be:<a class="pilcrow" href="#section-4.3-5">¶</a></p>
<span id="name-multipart-skg-response-seri"></span><figure id="figure-2">
          <div id="section-4.3-6.1">
<pre class="lang-cbor-pretty sourcecode">   84                  # array(4)
   19 011C             # unsigned(284)
   48                  # bytes(8)
      0123456789ABCDEF # "\x01#Eg\x89\xAB\xCD\xEF"
   19 0119             # unsigned(281)
   48                  # bytes(8)
      FEDCBA9876543210 # "\xFE\xDC\xBA\x98vT2\x10"
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-2">Figure 2</a>:
<a class="selfRef" href="#name-multipart-skg-response-seri">Multipart /skg Response Serialization</a>
          </figcaption></figure>
<p id="section-4.3-7">When the client makes an /skc request, the certificate returned
        with the private key is a single X.509 certificate (not a PKCS #7
        container) with Content-Format identifier 287 (0x011F) instead of
        281.  In cases where the private key is encrypted with Cryptographic
        Message Syntax (CMS) (as explained in <a class="xref" href="#serverkey">Section 4.8</a>), the Content-Format identifier is 280 (0x0118)
        instead of 284. The Content-Format used in the response is summarized
        in <a class="xref" href="#skg-skc">Table 3</a>.<a class="pilcrow" href="#section-4.3-7">¶</a></p>
<span id="name-response-content-formats-fo"></span><div id="skg-skc">
<table class="center" id="table-3">
          <caption>
<a class="selfRef" href="#table-3">Table 3</a>:
<a class="selfRef" href="#name-response-content-formats-fo">Response Content-Formats for /skg and /skc</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Function</th>
              <th class="text-left" colspan="1" rowspan="1">Response, Part 1</th>
              <th class="text-left" colspan="1" rowspan="1">Response, Part 2</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1"> /skg  </td>
              <td class="text-left" colspan="1" rowspan="1">   284  </td>
              <td class="text-left" colspan="1" rowspan="1">  281</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1"> /skc  </td>
              <td class="text-left" colspan="1" rowspan="1">   280  </td>
              <td class="text-left" colspan="1" rowspan="1">  287</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-4.3-9">The key and certificate representations are DER-encoded ASN.1, 
   in its binary form. An example is shown in <a class="xref" href="#appskg">Appendix A.3</a>.<a class="pilcrow" href="#section-4.3-9">¶</a></p>
</section>
</div>
<section id="section-4.4">
        <h3 id="name-message-bindings">
<a class="section-number selfRef" href="#section-4.4">4.4. </a><a class="section-name selfRef" href="#name-message-bindings">Message Bindings</a>
        </h3>
<p id="section-4.4-1">The general EST-coaps message characteristics are:<a class="pilcrow" href="#section-4.4-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4-2.1">EST-coaps servers sometimes need to provide delayed
   responses, which are preceded by an immediately returned
   empty ACK or an ACK containing response code 5.03 as
   explained in <a class="xref" href="#pending">Section 4.7</a>.
   Thus, it is <span class="bcp14">RECOMMENDED</span> for implementers to
   send EST-coaps requests in Confirmable (CON) CoAP
   messages.<a class="pilcrow" href="#section-4.4-2.1">¶</a>
</li>
          <li class="normal" id="section-4.4-2.2">The CoAP Options used are Uri-Host, Uri-Path, Uri-Port,
          Content-Format, Block1, Block2, and Accept.  These CoAP Options are
          used to communicate the HTTP fields specified in the EST REST
          messages. The Uri-host and Uri-Port Options can be omitted from the
          CoAP message sent on the wire. When omitted, they are logically
          assumed to be the transport protocol destination address and port,
          respectively. Explicit Uri-Host and Uri-Port Options are typically
          used when an endpoint hosts multiple virtual servers and uses the
          Options to route the requests accordingly.  Other CoAP Options
          should be handled in accordance with <span>[<a class="xref" href="#RFC7252">RFC7252</a>]</span>.<a class="pilcrow" href="#section-4.4-2.2">¶</a>
</li>
          <li class="normal" id="section-4.4-2.3">EST URLs are HTTPS based (https://); in CoAP, these are assumed
   to be translated to CoAPS (coaps://).<a class="pilcrow" href="#section-4.4-2.3">¶</a>
</li>
        </ul>
<p id="section-4.4-3"><a class="xref" href="#est-uri">Table 1</a> provides the mapping from the EST URI path to the EST-coaps URI path. 
 <a class="xref" href="#messagebindings">Appendix A</a>  includes some practical examples of EST messages
 translated to CoAP.<a class="pilcrow" href="#section-4.4-3">¶</a></p>
</section>
<div id="codes">
<section id="section-4.5">
        <h3 id="name-coap-response-codes">
<a class="section-number selfRef" href="#section-4.5">4.5. </a><a class="section-name selfRef" href="#name-coap-response-codes">CoAP Response Codes</a>
        </h3>
<p id="section-4.5-1"><span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc7252#section-5.9">Section 5.9</a> of [<a class="xref" href="#RFC7252">RFC7252</a>]</span> and <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8075#section-7">Section 7</a> of [<a class="xref" href="#RFC8075">RFC8075</a>]</span> specify the mapping
        of HTTP response codes to CoAP response codes.  The success code in
        response to an EST-coaps GET request (/crts, /att) is 2.05. Similarly,
        2.04 is used in successful response to EST-coaps POST requests (/sen,
        /sren, /skg, /skc).<a class="pilcrow" href="#section-4.5-1">¶</a></p>
<p id="section-4.5-2">EST makes use of HTTP 204 or 404 responses when a resource is not available 
   for the client. In EST-coaps, 2.04 is used in response to 
   a POST (/sen, /sren, /skg, /skc). 4.04 is 
   used when the resource is not available for the client.<a class="pilcrow" href="#section-4.5-2">¶</a></p>
<p id="section-4.5-3">HTTP response code 202 with a Retry-After header field  
   in <span>[<a class="xref" href="#RFC7030">RFC7030</a>]</span> has no equivalent in CoAP. 
   HTTP 202 with Retry-After is used in EST for delayed server 
   responses. <a class="xref" href="#pending">Section 4.7</a> specifies how EST-coaps 
   handles delayed messages with 5.03 responses with a Max-Age Option.<a class="pilcrow" href="#section-4.5-3">¶</a></p>
<p id="section-4.5-4">Additionally, EST's HTTP 400, 401, 403, 404, and 503 status codes have 
   their equivalent CoAP 4.00, 4.01, 4.03, 4.04, and 5.03 response codes 
   in EST-coaps. 
   <a class="xref" href="#estcoaps-codes">Table 4</a> summarizes the EST-coaps response codes.<a class="pilcrow" href="#section-4.5-4">¶</a></p>
<span id="name-est-coaps-response-codes"></span><div id="estcoaps-codes">
<table class="center" id="table-4">
          <caption>
<a class="selfRef" href="#table-4">Table 4</a>:
<a class="selfRef" href="#name-est-coaps-response-codes">EST-coaps Response Codes</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Operation</th>
              <th class="text-left" colspan="1" rowspan="1">EST-coaps Response Code</th>
              <th class="text-left" colspan="1" rowspan="1">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">/crts, /att</td>
              <td class="text-left" colspan="1" rowspan="1">2.05</td>
              <td class="text-left" colspan="1" rowspan="1">Success. Certs included in the response payload.</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1"> </td>
              <td class="text-left" colspan="1" rowspan="1">4.xx / 5.xx</td>
              <td class="text-left" colspan="1" rowspan="1">Failure.</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">/sen, /skg, /sren, /skc</td>
              <td class="text-left" colspan="1" rowspan="1">2.04 
                                          </td>
              <td class="text-left" colspan="1" rowspan="1">Success. Cert included in the response payload.</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1"> </td>
              <td class="text-left" colspan="1" rowspan="1">5.03</td>
              <td class="text-left" colspan="1" rowspan="1">Retry in Max-Age Option time.</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1"> </td>
              <td class="text-left" colspan="1" rowspan="1">4.xx / 5.xx</td>
              <td class="text-left" colspan="1" rowspan="1">Failure.</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="fragment">
<section id="section-4.6">
        <h3 id="name-message-fragmentation">
<a class="section-number selfRef" href="#section-4.6">4.6. </a><a class="section-name selfRef" href="#name-message-fragmentation">Message Fragmentation</a>
        </h3>
<p id="section-4.6-1">DTLS defines fragmentation only for the handshake and not for
        secure data exchange (DTLS records). <span>[<a class="xref" href="#RFC6347">RFC6347</a>]</span> states that to avoid using IP fragmentation, which
        involves error-prone datagram reconstitution, invokers of the DTLS
        record layer should size DTLS records so that they fit within any Path
        MTU estimates obtained from the record layer. In addition, invokers
        residing on 6LoWPAN (IPv6 over Low-Power Wireless Personal Area Networks)
        over IEEE 802.15.4 networks <span>[<a class="xref" href="#IEEE802.15.4">IEEE802.15.4</a>]</span> are recommended to size CoAP messages such
        that each DTLS record will fit within one or two IEEE 802.15.4
        frames.<a class="pilcrow" href="#section-4.6-1">¶</a></p>
<p id="section-4.6-2">That is not always possible in EST-coaps. Even though ECC
      certificates are small in size, they can vary greatly based on signature
      algorithms, key sizes, and Object Identifier (OID) fields used. For
      256-bit curves, common Elliptic Curve Digital Signature Algorithm
      (ECDSA) cert sizes are 500-1000 bytes, which could fluctuate further
      based on the algorithms, OIDs, Subject Alternative Names (SANs), and cert
      fields. For 384-bit curves, ECDSA certificates increase in size and can
      sometimes reach 1.5KB. Additionally, there are times when the EST
      cacerts response from the server can include multiple certificates that
      amount to large payloads. <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc7252#section-4.6">Section 4.6</a> of [<a class="xref" href="#RFC7252">RFC7252</a>]</span> (CoAP) describes the possible payload sizes: "if nothing
      is known about the size of the headers, good upper bounds are 1152 bytes
      for the message size and 1024 bytes for the payload size". <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc7252#section-4.6">Section 4.6</a> of [<a class="xref" href="#RFC7252">RFC7252</a>]</span> also suggests that
      IPv4 implementations may want to limit themselves to more conservative
      IPv4 datagram sizes such as 576 bytes. Even with ECC, EST-coaps messages
      can still exceed MTU sizes on the Internet or 6LoWPAN <span>[<a class="xref" href="#RFC4919">RFC4919</a>]</span> (<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc7959#section-2">Section 2</a> of [<a class="xref" href="#RFC7959">RFC7959</a>]</span>). EST-coaps needs to be able to
      fragment messages into multiple DTLS datagrams.<a class="pilcrow" href="#section-4.6-2">¶</a></p>
<p id="section-4.6-3">To perform fragmentation in CoAP, <span>[<a class="xref" href="#RFC7959">RFC7959</a>]</span> specifies the Block1 Option for fragmentation of
        the request payload and the Block2 Option for fragmentation of the
        return payload of a CoAP flow. As explained in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc7959#section-1">Section 1</a> of [<a class="xref" href="#RFC7959">RFC7959</a>]</span>, block-wise transfers should be used
        in Confirmable CoAP messages to avoid the exacerbation of lost
        blocks. EST-coaps servers <span class="bcp14">MUST</span> implement Block1 and
        Block2. EST-coaps clients <span class="bcp14">MUST</span> implement
        Block2. EST-coaps clients <span class="bcp14">MUST</span> implement Block1 only if
        they are expecting to send EST-coaps requests with a packet size that
        exceeds the path MTU.<a class="pilcrow" href="#section-4.6-3">¶</a></p>
<p id="section-4.6-4"><span>[<a class="xref" href="#RFC7959">RFC7959</a>]</span> also defines Size1 and
      Size2 Options to provide size information about the resource
      representation in a request and response. The EST-coaps client and server
      <span class="bcp14">MAY</span> support Size1 and Size2 Options.<a class="pilcrow" href="#section-4.6-4">¶</a></p>
<p id="section-4.6-5">Examples of fragmented EST-coaps messages are shown in <a class="xref" href="#blockexamples">Appendix B</a>.<a class="pilcrow" href="#section-4.6-5">¶</a></p>
</section>
</div>
<div id="pending">
<section id="section-4.7">
        <h3 id="name-delayed-responses">
<a class="section-number selfRef" href="#section-4.7">4.7. </a><a class="section-name selfRef" href="#name-delayed-responses">Delayed Responses</a>
        </h3>
<p id="section-4.7-1">Server responses can sometimes be delayed. According to <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc7252#section-5.2.2">Section 5.2.2</a> of [<a class="xref" href="#RFC7252">RFC7252</a>]</span>, a slow server
        can acknowledge the request and respond later with the requested
        resource representation. In particular, a slow server can respond to
        an EST-coaps enrollment request with an empty ACK with code 0.00
        before sending the certificate to the client after a short delay. If
        the certificate response is large, the server will need more than one
        Block2 block to transfer it.<a class="pilcrow" href="#section-4.7-1">¶</a></p>
<p id="section-4.7-2">This situation is shown in <a class="xref" href="#fig-est-short-wait">Figure 3</a>. The client sends an enrollment request that uses
        N1+1 Block1 blocks. The server uses an empty 0.00 ACK to announce the
        delayed response, which is provided later with 2.04 messages
        containing N2+1 Block2 Options.  The first 2.04 is a Confirmable
        message that is acknowledged by the client.  Onwards, the client
        acknowledges all subsequent Block2 blocks. The notation of <a class="xref" href="#fig-est-short-wait">Figure 3</a> is explained in <a class="xref" href="#cacertsblock">Appendix B.1</a>.<a class="pilcrow" href="#section-4.7-2">¶</a></p>
<span id="name-est-coaps-enrollment-with-s"></span><div id="fig-est-short-wait">
<figure id="figure-3">
          <div class="alignLeft art-text artwork" id="section-4.7-3.1">
<pre>POST [2001:db8::2:1]:61616/est/sen (CON)(1:0/1/256)
                   {CSR (frag# 1)} --&gt;
   &lt;-- (ACK) (1:0/1/256) (2.31 Continue)
POST [2001:db8::2:1]:61616/est/sen (CON)(1:1/1/256)
                   {CSR (frag# 2)} --&gt;
   &lt;-- (ACK) (1:1/1/256) (2.31 Continue)
                  .
                  .
                  .
POST [2001:db8::2:1]:61616/est/sen(CON)(1:N1/0/256)
                   {CSR (frag# N1+1)}--&gt;
   &lt;-- (0.00 empty ACK)
                  |
   ... Short delay before the certificate is ready ...
                  |
   &lt;-- (CON) (1:N1/0/256)(2:0/1/256)(2.04 Changed)
                   {Cert resp (frag# 1)}
                                              (ACK)          --&gt;
POST [2001:db8::2:1]:61616/est/sen (CON)(2:1/0/256)          --&gt;
   &lt;-- (ACK) (2:1/1/256) (2.04 Changed) {Cert resp (frag# 2)}
                  .
                  .
                  .
POST [2001:db8::2:1]:61616/est/sen (CON)(2:N2/0/256)          --&gt;
   &lt;-- (ACK) (2:N2/0/256) (2.04 Changed) {Cert resp (frag# N2+1)}
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-3">Figure 3</a>:
<a class="selfRef" href="#name-est-coaps-enrollment-with-s">EST-coaps Enrollment with Short Wait</a>
          </figcaption></figure>
</div>
<p id="section-4.7-4">If the server is very slow (for example, manual intervention is
        required, which would take minutes), it <span class="bcp14">SHOULD</span> respond
        with an ACK containing response code 5.03 (Service unavailable) and a
        Max-Age Option to indicate the time the client <span class="bcp14">SHOULD</span>
        wait before sending another request to obtain the content. After a
        delay of Max-Age, the client <span class="bcp14">SHOULD</span> resend the
        identical CSR to the server.  As long as the server continues to
        respond with response code 5.03 (Service Unavailable) with a Max-Age
        Option, the client will continue to delay for Max-Age and then resend
        the enrollment request until the server responds with the certificate
        or the client abandons the request due to policy or other reasons.<a class="pilcrow" href="#section-4.7-4">¶</a></p>
<p id="section-4.7-5">To demonstrate this scenario, <a class="xref" href="#fig-est-long-wait">Figure 4</a> shows a client sending an enrollment request that
        uses N1+1 Block1 blocks to send the CSR to the server. The server
        needs N2+1 Block2 blocks to respond but also needs to take a long
        delay (minutes) to provide the response. Consequently, the server uses
        a 5.03 ACK response with a Max-Age Option. The client waits for a
        period of Max-Age as many times as it receives the same 5.03 response
        and retransmits the enrollment request until it receives a certificate
        in a fragmented 2.04 response.<a class="pilcrow" href="#section-4.7-5">¶</a></p>
<span id="name-est-coaps-enrollment-with-l"></span><div id="fig-est-long-wait">
<figure id="figure-4">
          <div class="alignLeft art-text artwork" id="section-4.7-6.1">
<pre>POST [2001:db8::2:1]:61616/est/sen (CON)(1:0/1/256)
                   {CSR (frag# 1)}  --&gt;
  &lt;-- (ACK) (1:0/1/256) (2.31 Continue)
POST [2001:db8::2:1]:61616/est/sen (CON)(1:1/1/256)
                   {CSR (frag# 2)}  --&gt;
  &lt;-- (ACK) (1:1/1/256) (2.31 Continue)
                  .
                  .
                  .
POST [2001:db8::2:1]:61616/est/sen(CON)(1:N1/0/256)
                   {CSR (frag# N1+1)}--&gt;
  &lt;-- (ACK) (1:N1/0/256) (5.03 Service Unavailable) (Max-Age)
                  |
                  |
  ... Client tries again after Max-Age with identical payload ...
                  |
                  |
POST [2001:db8::2:1]:61616/est/sen(CON)(1:0/1/256)
                   {CSR (frag# 1)}--&gt;
  &lt;-- (ACK) (1:0/1/256) (2.31 Continue)
POST [2001:db8::2:1]:61616/est/sen (CON)(1:1/1/256)
                   {CSR (frag# 2)}  --&gt;
  &lt;-- (ACK) (1:1/1/256) (2.31 Continue)
                  .
                  .
                  .
POST [2001:db8::2:1]:61616/est/sen(CON)(1:N1/0/256)
                   {CSR (frag# N1+1)}--&gt;
                  |
   ... Immediate response when certificate is ready ...
                  |
  &lt;-- (ACK) (1:N1/0/256) (2:0/1/256) (2.04 Changed)
                   {Cert resp (frag# 1)}
POST [2001:db8::2:1]:61616/est/sen (CON)(2:1/0/256)           --&gt;
  &lt;-- (ACK) (2:1/1/256) (2.04 Changed) {Cert resp (frag# 2)}
                  .
                  .
                  .
POST [2001:db8::2:1]:61616/est/sen (CON)(2:N2/0/256)          --&gt;
  &lt;-- (ACK) (2:N2/0/256) (2.04 Changed) {Cert resp (frag# N2+1)}
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-4">Figure 4</a>:
<a class="selfRef" href="#name-est-coaps-enrollment-with-l">EST-coaps Enrollment with Long Wait</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="serverkey">
<section id="section-4.8">
        <h3 id="name-server-side-key-generation">
<a class="section-number selfRef" href="#section-4.8">4.8. </a><a class="section-name selfRef" href="#name-server-side-key-generation">Server-Side Key Generation</a>
        </h3>
<p id="section-4.8-1">Private keys can be generated on the server to support 
   scenarios where server-side key generation is needed. Such scenarios  
   include those where it is considered more secure to generate the 
   long-lived, random private key that identifies the client at the server, 
   or where the resources spent to generate a random private key at the 
   client are considered scarce, or where the security policy requires 
   that the certificate public and corresponding private keys are 
   centrally generated and controlled. As always, it is necessary 
   to use proper random numbers in various protocols such as (D)TLS (<a class="xref" href="#sec-est">Section 9.1</a>).<a class="pilcrow" href="#section-4.8-1">¶</a></p>
<p id="section-4.8-2">When requesting server-side key generation, the client
      asks for the server or proxy to generate the private key and the certificate, 
      which are transferred back to the client in the server-side key generation
      response. In all respects, the server treats the CSR as it would treat any
      enroll or re-enroll CSR; the only distinction here is that the server
      <span class="bcp14">MUST</span> ignore the public key values and signature in the CSR. These
      are included in the request only to allow reuse of existing
      codebases for generating and parsing such requests.<a class="pilcrow" href="#section-4.8-2">¶</a></p>
<p id="section-4.8-3">The client /skg request is for a certificate in a PKCS #7 container 
   and private key in two application/multipart-core elements. 
   Respectively, an /skc request is for a single application/pkix-cert 
   certificate and a private key. 
   The private key Content-Format requested by the client is indicated in the 
   PKCS #10 CSR request. If the request contains SMIMECapabilities and 
   DecryptKeyIdentifier or AsymmetricDecryptKeyIdentifier, the client 
   is expecting Content-Format 280 for the private key. 
   Then, this private key is encrypted symmetrically or asymmetrically  
   per <span>[<a class="xref" href="#RFC7030">RFC7030</a>]</span>. 
   The symmetric key or the asymmetric keypair establishment method is 
   out of scope of this specification.

   An /skg or /skc request with a CSR without SMIMECapabilities 
   expects an application/multipart-core with an unencrypted PKCS #8 private 
   key with Content-Format 284.<a class="pilcrow" href="#section-4.8-3">¶</a></p>
<p id="section-4.8-4">
     The EST-coaps server-side key generation response is returned with
     Content-Format application/multipart-core <span>[<a class="xref" href="#RFC8710">RFC8710</a>]</span> containing
     a CBOR array with four items (<a class="xref" href="#format">Section 4.3</a>).  The two representations (each consisting of
     two CBOR array items) do not have to be in a particular order
     since each representation is preceded by its Content-Format ID.
     Depending on the request, the private key can be in unprotected
     PKCS #8 format <span>[<a class="xref" href="#RFC5958">RFC5958</a>]</span>
     (Content-Format 284) or protected inside of CMS SignedData
     (Content-Format 280). The SignedData, placed in the outermost
     container, is signed by the party that generated the private key,
     which may be the EST server or the EST CA. SignedData placed
     within the Enveloped Data does not need additional signing as
     explained in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc7030#section-4.4.2">Section 4.4.2</a> of [<a class="xref" href="#RFC7030">RFC7030</a>]</span>. In summary, the symmetrically encrypted key is
     included in the encryptedKey attribute in a KEKRecipientInfo
     structure.  In the case where the asymmetric encryption key is
     suitable for transport key operations, the generated private key is
     encrypted with a symmetric key. The symmetric key itself is
     encrypted by the client-defined (in the CSR) asymmetric public key
     and is carried in an encryptedKey attribute in a
     KeyTransRecipientInfo structure.  Finally, if the asymmetric
     encryption key is suitable for key agreement, the generated
     private key is encrypted with a symmetric key. The symmetric key
     itself is encrypted by the client defined (in the CSR) asymmetric
     public key and is carried in a recipientEncryptedKeys attribute
     in a KeyAgreeRecipientInfo.<a class="pilcrow" href="#section-4.8-4">¶</a></p>
<p id="section-4.8-5"><span>[<a class="xref" href="#RFC7030">RFC7030</a>]</span> recommends the use of
   additional encryption of the returned private key. For the context
   of this specification, clients and servers that choose to support
   server-side key generation <span class="bcp14">MUST</span> support unprotected
   (PKCS #8) private keys (Content-Format 284). Symmetric or asymmetric
   encryption of the private key (CMS EnvelopedData, Content-Format
   280) <span class="bcp14">SHOULD</span> be supported for deployments where
   end-to-end encryption is needed between the client and a
   server. Such cases could include architectures where an entity
   between the client and the CA terminates the DTLS connection
   (Registrar in <a class="xref" href="#RAfig">Figure 5</a>).  Though
   <span>[<a class="xref" href="#RFC7030">RFC7030</a>]</span> strongly recommends that
   clients request the use of CMS encryption on top of the TLS
   channel's protection, this document does not make such a
   recommendation; CMS encryption can still be used when mandated by
   the use case.<a class="pilcrow" href="#section-4.8-5">¶</a></p>
</section>
</div>
</section>
</div>
<div id="proxy">
<section id="section-5">
      <h2 id="name-https-coaps-registrar">
<a class="section-number selfRef" href="#section-5">5. </a><a class="section-name selfRef" href="#name-https-coaps-registrar">HTTPS-CoAPS Registrar</a>
      </h2>
<p id="section-5-1">In real-world deployments, the EST server will not always reside within
 the CoAP boundary. The EST server can exist outside the constrained network,
 in which case it will support TLS/HTTP instead of CoAPS. In such environments,
 EST-coaps is used by the client within the CoAP boundary and TLS is used to
 transport the EST messages outside the CoAP boundary. A Registrar at the edge
 is required to operate between the CoAP environment and the external HTTP
 network as shown in
 <a class="xref" href="#RAfig">Figure 5</a>.<a class="pilcrow" href="#section-5-1">¶</a></p>
<span id="name-est-coaps-to-https-registra"></span><div id="RAfig">
<figure id="figure-5">
        <div class="alignCenter art-text artwork" id="section-5-2.1">
<pre>                                     Constrained Network
.------.                         .----------------------------.
|  CA  |                         |.--------------------------.|
'------'                         ||                          ||
   |                             ||                          ||
.------.  HTTP   .------------------.  CoAPS  .-----------.  ||
| EST  |&lt;-------&gt;|EST-coaps-to-HTTPS|&lt;-------&gt;| EST Client|  ||
|Server|over TLS |   Registrar      |         '-----------'  ||
'------'         '------------------'                        ||
                                 ||                          ||
                                 |'--------------------------'|
                                 '----------------------------'
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-5">Figure 5</a>:
<a class="selfRef" href="#name-est-coaps-to-https-registra">EST-coaps-to-HTTPS Registrar at the CoAP Boundary</a>
        </figcaption></figure>
</div>
<p id="section-5-3">The EST-coaps-to-HTTPS Registrar <span class="bcp14">MUST</span> terminate EST-coaps downstream and
 initiate EST connections over TLS upstream. The Registrar <span class="bcp14">MUST</span> authenticate
 and optionally authorize the client requests while it <span class="bcp14">MUST</span> be authenticated
 by the EST server or CA. The trust relationship between the Registrar
 and the EST server <span class="bcp14">SHOULD</span> be pre-established for the Registrar to proxy
 these connections on behalf of various clients.<a class="pilcrow" href="#section-5-3">¶</a></p>
<p id="section-5-4">When enforcing Proof-of-Possession (POP) linking, the tls-unique or
      tls-exporter value of the session for DTLS 1.2 and DTLS 1.3, respectively,
      is used to prove that the private key corresponding to the public key is
      in the possession of the client and was used to establish the connection
      as explained in <a class="xref" href="#profile7925">Section 3</a>.  The POP
      linking information is lost between the EST-coaps client and the EST
      server when a Registrar is present.  The EST server becomes aware of the
      presence of a Registrar from its TLS client certificate that includes
      the id-kp-cmcRA extended key usage (EKU) extension <span>[<a class="xref" href="#RFC6402">RFC6402</a>]</span>. As explained in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc7030#section-3.7">Section 3.7</a> of [<a class="xref" href="#RFC7030">RFC7030</a>]</span>, the "EST server
      <span class="bcp14">SHOULD</span> apply authorization policy consistent with an RA
      client ... the EST server could be configured to accept POP linking
      information that does not match the current TLS session because the
      authenticated EST client RA has verified this information when acting as
      an EST server".<a class="pilcrow" href="#section-5-4">¶</a></p>
<p id="section-5-5"><a class="xref" href="#est-uri">Table 1</a> contains the URI mappings
      between EST-coaps and EST that the Registrar <span class="bcp14">MUST</span> adhere
      to. <a class="xref" href="#codes">Section 4.5</a> of this specification and
      <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8075#section-7">Section 7</a> of [<a class="xref" href="#RFC8075">RFC8075</a>]</span> define the
      mappings between EST-coaps and HTTP response codes that determine how
      the Registrar <span class="bcp14">MUST</span> translate CoAP response codes from/to
      HTTP status codes. The mapping from CoAP Content-Format to HTTP
      Content-Type is defined in <a class="xref" href="#Content-Formats">Section 8.1</a>.  Additionally, a conversion from CBOR major type 2
      to Base64 encoding <span class="bcp14">MUST</span> take place at the Registrar. If
      CMS end-to-end encryption is employed for the private key, the encrypted
      CMS EnvelopedData blob <span class="bcp14">MUST</span> be converted at the Registrar
      to binary CBOR type 2 downstream to the client. This is a format
      conversion that does not require decryption of the CMS
      EnvelopedData.<a class="pilcrow" href="#section-5-5">¶</a></p>
<p id="section-5-6">A deviation from the mappings in <a class="xref" href="#est-uri">Table 1</a> could take place if clients that leverage server-side
      key generation preferred for the enrolled keys to be generated by the
      Registrar in the case the CA does not support server-side key
      generation. Such a Registrar is responsible for generating a new CSR
      signed by a new key that will be returned to the client along with the
      certificate from the CA. In these cases, the Registrar
      <span class="bcp14">MUST</span> use random number generation with proper
      entropy.<a class="pilcrow" href="#section-5-6">¶</a></p>
<p id="section-5-7">Due to fragmentation of large messages into blocks, an
      EST-coaps-to-HTTP Registrar <span class="bcp14">MUST</span> reassemble the blocks
      before translating the binary content to Base64 and consecutively relay
      the message upstream.<a class="pilcrow" href="#section-5-7">¶</a></p>
<p id="section-5-8">The EST-coaps-to-HTTP Registrar <span class="bcp14">MUST</span> support resource
      discovery according to the rules in <a class="xref" href="#discovery">Section 4.1</a>.<a class="pilcrow" href="#section-5-8">¶</a></p>
</section>
</div>
<section id="section-6">
      <h2 id="name-parameters">
<a class="section-number selfRef" href="#section-6">6. </a><a class="section-name selfRef" href="#name-parameters">Parameters</a>
      </h2>
<p id="section-6-1">This section addresses transmission parameters described in Sections
      <a class="relref" href="https://www.rfc-editor.org/rfc/rfc7252#section-4.7">4.7</a> and <a class="relref" href="https://www.rfc-editor.org/rfc/rfc7252#section-4.8">4.8</a> of <span>[<a class="xref" href="#RFC7252">RFC7252</a>]</span>.  EST does not
      impose any unique values on the CoAP parameters in <span>[<a class="xref" href="#RFC7252">RFC7252</a>]</span>, but the setting of the CoAP
      parameter values may have consequence for the setting of the EST
      parameter values.<a class="pilcrow" href="#section-6-1">¶</a></p>
<p id="section-6-2">
 Implementations should follow the default CoAP configuration
 parameters <span>[<a class="xref" href="#RFC7252">RFC7252</a>]</span>.  However,
 depending on the implementation scenario, retransmissions and timeouts
 can also occur on other networking layers, governed by other
 configuration parameters. When a change in a server parameter has
 taken place, the parameter values in the communicating endpoints
 <span class="bcp14">MUST</span> be adjusted as necessary. Examples of how
 parameters could be adjusted include higher-layer congestion
 protocols, provisioning agents, and configurations included in
 firmware updates.<a class="pilcrow" href="#section-6-2">¶</a></p>
<p id="section-6-3">Some further comments about some specific parameters, mainly from
 Table 2 in <span>[<a class="xref" href="#RFC7252">RFC7252</a>]</span>, include the following:<a class="pilcrow" href="#section-6-3">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-6-4">
        <dt id="section-6-4.1">NSTART:
</dt>
        <dd id="section-6-4.2" style="margin-left: 1.5em">A parameter that controls the number of simultaneous outstanding
interactions that a client maintains to a given server.  An EST-coaps client
is expected to control at most one interaction with a given server, which is
the default NSTART value defined in <span>[<a class="xref" href="#RFC7252">RFC7252</a>]</span>.<a class="pilcrow" href="#section-6-4.2">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-6-4.3">DEFAULT_LEISURE:
</dt>
        <dd id="section-6-4.4" style="margin-left: 1.5em">A setting that is only relevant in multicast scenarios and is outside the scope of
EST-coaps.<a class="pilcrow" href="#section-6-4.4">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-6-4.5">PROBING_RATE:
</dt>
        <dd id="section-6-4.6" style="margin-left: 1.5em">A parameter that specifies the rate of resending Non-confirmable
messages. In the rare situations that Non-confirmable messages are used, the
default PROBING_RATE value defined in <span>[<a class="xref" href="#RFC7252">RFC7252</a>]</span> applies.<a class="pilcrow" href="#section-6-4.6">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-6-5">Finally, the Table 3 parameters in <span>[<a class="xref" href="#RFC7252">RFC7252</a>]</span> are mainly
 derived from Table 2. Directly changing parameters on one table would
 affect parameters on the other.<a class="pilcrow" href="#section-6-5">¶</a></p>
</section>
<div id="deploy-limit">
<section id="section-7">
      <h2 id="name-deployment-limitations">
<a class="section-number selfRef" href="#section-7">7. </a><a class="section-name selfRef" href="#name-deployment-limitations">Deployment Limitations</a>
      </h2>
<p id="section-7-1">Although EST-coaps paves the way for the utilization of EST by constrained devices in constrained networks, some classes of devices <span>[<a class="xref" href="#RFC7228">RFC7228</a>]</span> will not have enough resources to handle the payloads that come with EST-coaps. The specification of EST-coaps is intended to ensure that EST works for networks of constrained devices that choose to limit their communications stack to DTLS/CoAP. It is up to the network designer to decide which devices execute the EST protocol and which do not.<a class="pilcrow" href="#section-7-1">¶</a></p>
</section>
</div>
<div id="iana">
<section id="section-8">
      <h2 id="name-iana-considerations">
<a class="section-number selfRef" href="#section-8">8. </a><a class="section-name selfRef" href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<div id="Content-Formats">
<section id="section-8.1">
        <h3 id="name-content-formats-registry">
<a class="section-number selfRef" href="#section-8.1">8.1. </a><a class="section-name selfRef" href="#name-content-formats-registry">Content-Formats Registry</a>
        </h3>
<p id="section-8.1-1">IANA has registered the following Content-Formats given in <a class="xref" href="#Content-Format">Table 5</a> in the "CoAP Content-Formats" subregistry within the "CoRE Parameters"
 registry <span>[<a class="xref" href="#CORE-PARAMS">CORE-PARAMS</a>]</span>.
 These have been registered in the IETF Review or IESG Approval range (256-9999).<a class="pilcrow" href="#section-8.1-1">¶</a></p>
<span id="name-new-coap-content-formats"></span><div id="Content-Format">
<table class="center" id="table-5">
          <caption>
<a class="selfRef" href="#table-5">Table 5</a>:
<a class="selfRef" href="#name-new-coap-content-formats">New CoAP Content-Formats</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Media Type</th>
              <th class="text-right" colspan="1" rowspan="1">ID</th>
              <th class="text-left" colspan="1" rowspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">application/pkcs7-mime; smime-type=server-generated-key</td>
              <td class="text-right" colspan="1" rowspan="1">280</td>
              <td class="text-left" colspan="1" rowspan="1">
                <span>[<a class="xref" href="#RFC7030">RFC7030</a>]</span> <span>[<a class="xref" href="#RFC8551">RFC8551</a>]</span> RFC 9148</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">application/pkcs7-mime; smime-type=certs-only</td>
              <td class="text-right" colspan="1" rowspan="1">281</td>
              <td class="text-left" colspan="1" rowspan="1">
                <span>[<a class="xref" href="#RFC8551">RFC8551</a>]</span> RFC 9148</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">application/pkcs8</td>
              <td class="text-right" colspan="1" rowspan="1">284</td>
              <td class="text-left" colspan="1" rowspan="1">
                <span>[<a class="xref" href="#RFC5958">RFC5958</a>]</span> <span>[<a class="xref" href="#RFC8551">RFC8551</a>]</span> RFC 9148</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">application/csrattrs</td>
              <td class="text-right" colspan="1" rowspan="1">285</td>
              <td class="text-left" colspan="1" rowspan="1">
                <span>[<a class="xref" href="#RFC7030">RFC7030</a>]</span> RFC 9148</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">application/pkcs10</td>
              <td class="text-right" colspan="1" rowspan="1">286</td>
              <td class="text-left" colspan="1" rowspan="1">
                <span>[<a class="xref" href="#RFC5967">RFC5967</a>]</span> <span>[<a class="xref" href="#RFC8551">RFC8551</a>]</span> RFC 9148</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">application/pkix-cert</td>
              <td class="text-right" colspan="1" rowspan="1">287</td>
              <td class="text-left" colspan="1" rowspan="1">
                <span>[<a class="xref" href="#RFC2585">RFC2585</a>]</span> RFC 9148</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="resource-type">
<section id="section-8.2">
        <h3 id="name-resource-type-registry">
<a class="section-number selfRef" href="#section-8.2">8.2. </a><a class="section-name selfRef" href="#name-resource-type-registry">Resource Type Registry</a>
        </h3>
<p id="section-8.2-1">IANA has registered the following Resource Type (rt=) Link Target Attributes
   given in <a class="xref" href="#rt-table">Table 6</a> in the "Resource Type (rt=) Link Target Attribute Values"
   subregistry under the "Constrained RESTful Environments (CoRE)
   Parameters" registry.<a class="pilcrow" href="#section-8.2-1">¶</a></p>
<span id="name-new-resource-type-rt-link-t"></span><div id="rt-table">
<table class="center" id="table-6">
          <caption>
<a class="selfRef" href="#table-6">Table 6</a>:
<a class="selfRef" href="#name-new-resource-type-rt-link-t">New Resource Type (rt=) Link Target Attributes</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Value</th>
              <th class="text-left" colspan="1" rowspan="1">Description</th>
              <th class="text-left" colspan="1" rowspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">ace.est.crts</td>
              <td class="text-left" colspan="1" rowspan="1">This resource depicts the support of EST GET cacerts.</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9148</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">ace.est.sen</td>
              <td class="text-left" colspan="1" rowspan="1">This resource depicts the support of EST simple enroll.</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9148</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">ace.est.sren</td>
              <td class="text-left" colspan="1" rowspan="1">This resource depicts the support of EST simple reenroll.</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9148</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">ace.est.att</td>
              <td class="text-left" colspan="1" rowspan="1">This resource depicts the support of EST GET CSR attributes.</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9148</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">ace.est.skg</td>
              <td class="text-left" colspan="1" rowspan="1">This resource depicts the support of EST server-side key generation with the returned certificate in a PKCS #7 container.</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9148</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">ace.est.skc</td>
              <td class="text-left" colspan="1" rowspan="1">This resource depicts the support of EST server-side key generation with the returned certificate in application/pkix-cert format.</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9148</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="well-known-uris">
<section id="section-8.3">
        <h3 id="name-well-known-uris-registry">
<a class="section-number selfRef" href="#section-8.3">8.3. </a><a class="section-name selfRef" href="#name-well-known-uris-registry">Well-Known URIs Registry</a>
        </h3>
<p id="section-8.3-1">IANA has added an additional reference to
   the est URI in the "Well-Known URIs" registry:<a class="pilcrow" href="#section-8.3-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-8.3-2">
          <dt id="section-8.3-2.1">URI Suffix:</dt>
          <dd id="section-8.3-2.2" style="margin-left: 1.5em">est<a class="pilcrow" href="#section-8.3-2.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-8.3-2.3">Change Controller:</dt>
          <dd id="section-8.3-2.4" style="margin-left: 1.5em">IETF<a class="pilcrow" href="#section-8.3-2.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-8.3-2.5">References:</dt>
          <dd id="section-8.3-2.6" style="margin-left: 1.5em">
            <span>[<a class="xref" href="#RFC7030">RFC7030</a>]</span> RFC 9148<a class="pilcrow" href="#section-8.3-2.6">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-8.3-2.7">Status:</dt>
          <dd id="section-8.3-2.8" style="margin-left: 1.5em">permanent<a class="pilcrow" href="#section-8.3-2.8">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-8.3-2.9">Related Information:</dt>
          <dd id="section-8.3-2.10" style="margin-left: 1.5em"></dd>
          <dd class="break"></dd>
<dt id="section-8.3-2.11">Date Registered:</dt>
          <dd id="section-8.3-2.12" style="margin-left: 1.5em">2013-08-16<a class="pilcrow" href="#section-8.3-2.12">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-8.3-2.13">Date Modified:</dt>
          <dd id="section-8.3-2.14" style="margin-left: 1.5em">2020-04-29<a class="pilcrow" href="#section-8.3-2.14">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="sec">
<section id="section-9">
      <h2 id="name-security-considerations">
<a class="section-number selfRef" href="#section-9">9. </a><a class="section-name selfRef" href="#name-security-considerations">Security Considerations</a>
      </h2>
<div id="sec-est">
<section id="section-9.1">
        <h3 id="name-est-server-considerations">
<a class="section-number selfRef" href="#section-9.1">9.1. </a><a class="section-name selfRef" href="#name-est-server-considerations">EST Server Considerations</a>
        </h3>
<p id="section-9.1-1">The security considerations in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc7030#section-6">Section 6</a> of [<a class="xref" href="#RFC7030">RFC7030</a>]</span> are only partially valid for the
        purposes of this document. As HTTP Basic Authentication is not
        supported, the considerations expressed for using passwords do not
        apply. The other portions of the security considerations in <span>[<a class="xref" href="#RFC7030">RFC7030</a>]</span> continue to apply.<a class="pilcrow" href="#section-9.1-1">¶</a></p>
<p id="section-9.1-2">Modern security protocols require random numbers to be available
        during the protocol run, for example, for nonces and ephemeral (EC)
        Diffie-Hellman key generation. This capability to generate random
        numbers is also needed when the constrained device generates the
        private key (that corresponds to the public key enrolled in the
        CSR). When server-side key generation is used, the constrained device
        depends on the server to generate the private key randomly, but it
        still needs locally generated random numbers for use in security
        protocols, as explained in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc7925#section-12">Section 12</a> of [<a class="xref" href="#RFC7925">RFC7925</a>]</span>.  Additionally, the transport of keys generated at
        the server is inherently risky.  For those deploying server-side key
        generation, analysis <span class="bcp14">SHOULD</span> be done to establish
        whether server-side key generation increases or decreases the
        probability of digital identity theft.<a class="pilcrow" href="#section-9.1-2">¶</a></p>
<p id="section-9.1-3">It is important to note that, as pointed out in <span>[<a class="xref" href="#PsQs">PsQs</a>]</span>,   sources contributing to the randomness 
      pool used to generate random numbers on laptops or desktop PCs, 
   such as mouse movement, timing of keystrokes, or air turbulence 
   on the movement of hard drive heads,
      are not available on many constrained devices.  
   Other sources have to be used or dedicated hardware has to be added.
      Selecting hardware for an IoT device that is capable of producing
      high-quality random numbers is therefore important <span>[<a class="xref" href="#RSA-FACT">RSA-FACT</a>]</span>.<a class="pilcrow" href="#section-9.1-3">¶</a></p>
<p id="section-9.1-4">As discussed in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc7030#section-6">Section 6</a> of [<a class="xref" href="#RFC7030">RFC7030</a>]</span>, it is<a class="pilcrow" href="#section-9.1-4">¶</a></p>
<blockquote id="section-9.1-5">
          <span class="bcp14">RECOMMENDED</span> that the Implicit Trust Anchor database used for
EST server authentication be carefully managed to reduce the chance of a
third-party CA with poor certification practices from being trusted.
Disabling the Implicit Trust Anchor database after successfully receiving the
Distribution of CA certificates response (<span>[<a class="xref" href="#RFC7030">RFC7030</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc7030#section-6">Section 6</a></span>)
limits any vulnerability to the first TLS exchange.<a class="pilcrow" href="#section-9.1-5">¶</a>
</blockquote>
<p id="section-9.1-6">


  Alternatively, in a case where a /sen request immediately follows a /crts, a
  client <span class="bcp14">MAY</span> choose to keep the connection authenticated by the
  Implicit TA open for efficiency reasons (<a class="xref" href="#profile7925">Section 3</a>). A client that interleaves EST-coaps /crts request with
  other requests in the same DTLS connection <span class="bcp14">SHOULD</span> revalidate
  the server certificate chain against the updated Explicit TA from the /crts
  response before proceeding with the subsequent requests. If the server
  certificate chain does not authenticate against the database, the client
  <span class="bcp14">SHOULD</span> close the connection without completing the rest of
  the requests. The updated Explicit TA <span class="bcp14">MUST</span> continue to be
  used in new DTLS connections.<a class="pilcrow" href="#section-9.1-6">¶</a></p>
<p id="section-9.1-7">In cases where the Initial Device Identifier (IDevID) used to authenticate the client is
        expired, the server <span class="bcp14">MAY</span> still authenticate the client because IDevIDs
        are expected to live as long as the device itself (<a class="xref" href="#profile7925">Section 3</a>). In such occasions, checking
        the certificate revocation status or authorizing the client using
        another method is important for the server to raise its confidence
        that the client can be trusted.<a class="pilcrow" href="#section-9.1-7">¶</a></p>
<p id="section-9.1-8">In accordance with <span>[<a class="xref" href="#RFC7030">RFC7030</a>]</span>, TLS
        cipher suites that include "_EXPORT_" and "_DES_" in their names <span class="bcp14">MUST NOT</span> be used. More recommendations for secure use of TLS and DTLS are
        included in <span>[<a class="xref" href="#BCP195">BCP195</a>]</span>.<a class="pilcrow" href="#section-9.1-8">¶</a></p>
<p id="section-9.1-9">As described in Certificate Management over CMS (CMC), <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc5272#section-6.7">Section 6.7</a> of [<a class="xref" href="#RFC5272">RFC5272</a>]</span>, "For keys that can
      be used as signature keys, signing the certification request with the
      private key serves as a POP on that key pair". In (D)TLS 1.2, the
      inclusion of tls-unique in the certificate request links the
      proof-of-possession to the (D)TLS proof-of-identity. This implies but
      does not prove that only the authenticated client currently has access
      to the private key.<a class="pilcrow" href="#section-9.1-9">¶</a></p>
<p id="section-9.1-10">What's more, CMC POP linking uses tls-unique as it is defined in
      <span>[<a class="xref" href="#RFC5929">RFC5929</a>]</span>. The 3SHAKE attack <span>[<a class="xref" href="#TRIPLESHAKE">TRIPLESHAKE</a>]</span> poses a risk by allowing an
      on-path active attacker to leverage session resumption and
      renegotiation to inject itself between a client and server even when
      channel binding is in use. Implementers should use the Extended Master
      Secret Extension in DTLS <span>[<a class="xref" href="#RFC7627">RFC7627</a>]</span> to
      prevent such attacks.  In the context of this specification, an
      attacker could invalidate the purpose of the POP linking
      challengePassword in the client request by resuming an EST-coaps
      connection. Even though the practical risk of such an attack to
      EST-coaps is not devastating, we would rather use a more secure
      channel-binding mechanism.
   In this specification, we still depend on the tls-unique
      mechanism defined in <span>[<a class="xref" href="#RFC5929">RFC5929</a>]</span> for DTLS 1.2
   because a 3SHAKE attack does not expose messages exchanged
      with EST-coaps. But for DTLS 1.3,
   <span>[<a class="xref" href="#I-D.ietf-kitten-tls-channel-bindings-for-tls13">TLS13-CHANNEL-BINDINGS</a>]</span>
   is used instead to derive a 32-byte tls-exporter binding
   in place of the tls-unique value in the CSR. That would alleviate the risks
   from the 3SHAKE attack <span>[<a class="xref" href="#TRIPLESHAKE">TRIPLESHAKE</a>]</span>.<a class="pilcrow" href="#section-9.1-10">¶</a></p>
<p id="section-9.1-11">Interpreters of ASN.1 structures should be aware of the use of invalid ASN.1
   length fields and should take appropriate measures to guard against buffer overflows,
   stack overruns in particular, and malicious content in general.<a class="pilcrow" href="#section-9.1-11">¶</a></p>
</section>
</div>
<div id="sec-proxy">
<section id="section-9.2">
        <h3 id="name-https-coaps-registrar-consi">
<a class="section-number selfRef" href="#section-9.2">9.2. </a><a class="section-name selfRef" href="#name-https-coaps-registrar-consi">HTTPS-CoAPS Registrar Considerations</a>
        </h3>
<p id="section-9.2-1">The Registrar proposed in <a class="xref" href="#proxy">Section 5</a>
        must be deployed with care and only when direct client-server
        connections are not possible. When POP linking is used, the Registrar
        terminating the DTLS connection establishes a new TLS connection with
        the upstream CA. Thus, it is impossible for POP linking to be enforced
        end to end for the EST transaction. The EST server could be configured
        to accept POP linking information that does not match the current TLS
        session because the authenticated EST Registrar is assumed to have
        verified POP linking downstream to the client.<a class="pilcrow" href="#section-9.2-1">¶</a></p>
<p id="section-9.2-2">The introduction of an EST-coaps-to-HTTP Registrar assumes the   
     client can authenticate 
 the Registrar using its implicit or explicit TA database. It also assumes
 the Registrar has a trust relationship with the upstream EST server in order
 to act on behalf of the clients. When a client uses the Implicit TA
 database for certificate validation, it <span class="bcp14">SHOULD</span> confirm if the server
 is acting as an RA by the presence of the id-kp-cmcRA EKU 
 <span>[<a class="xref" href="#RFC6402">RFC6402</a>]</span> in the server certificate.<a class="pilcrow" href="#section-9.2-2">¶</a></p>
<p id="section-9.2-3">In a server-side key generation case, if no end-to-end encryption
   is used, the Registrar may be able see the private key as it acts as
   a man in the middle.  Thus, the client puts its trust on the
   Registrar not exposing the private key.<a class="pilcrow" href="#section-9.2-3">¶</a></p>
<p id="section-9.2-4">Clients that leverage server-side key generation without end-to-end
        encryption of the private key (<a class="xref" href="#serverkey">Section 4.8</a>) have no knowledge as to whether the Registrar will be
        generating the private key and enrolling the certificates with the CA
        or if the CA will be responsible for generating the key.  In such
        cases, the existence of a Registrar requires the client to put its
        trust on the Registrar when it is generating the private key.<a class="pilcrow" href="#section-9.2-4">¶</a></p>
</section>
</div>
</section>
</div>
<section id="section-10">
      <h2 id="name-references">
<a class="section-number selfRef" href="#section-10">10. </a><a class="section-name selfRef" href="#name-references">References</a>
      </h2>
<section id="section-10.1">
        <h3 id="name-normative-references">
<a class="section-number selfRef" href="#section-10.1">10.1. </a><a class="section-name selfRef" href="#name-normative-references">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time class="refDate" datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2585">[RFC2585]</dt>
        <dd>
<span class="refAuthor">Housley, R.</span> and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Operational Protocols: FTP and HTTP"</span>, <span class="seriesInfo">RFC 2585</span>, <span class="seriesInfo">DOI 10.17487/RFC2585</span>, <time class="refDate" datetime="1999-05">May 1999</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2585">https://www.rfc-editor.org/info/rfc2585</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5246">[RFC5246]</dt>
        <dd>
<span class="refAuthor">Dierks, T.</span> and <span class="refAuthor">E. Rescorla</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.2"</span>, <span class="seriesInfo">RFC 5246</span>, <span class="seriesInfo">DOI 10.17487/RFC5246</span>, <time class="refDate" datetime="2008-08">August 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5246">https://www.rfc-editor.org/info/rfc5246</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5958">[RFC5958]</dt>
        <dd>
<span class="refAuthor">Turner, S.</span>, <span class="refTitle">"Asymmetric Key Packages"</span>, <span class="seriesInfo">RFC 5958</span>, <span class="seriesInfo">DOI 10.17487/RFC5958</span>, <time class="refDate" datetime="2010-08">August 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5958">https://www.rfc-editor.org/info/rfc5958</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5967">[RFC5967]</dt>
        <dd>
<span class="refAuthor">Turner, S.</span>, <span class="refTitle">"The application/pkcs10 Media Type"</span>, <span class="seriesInfo">RFC 5967</span>, <span class="seriesInfo">DOI 10.17487/RFC5967</span>, <time class="refDate" datetime="2010-08">August 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5967">https://www.rfc-editor.org/info/rfc5967</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6347">[RFC6347]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span> and <span class="refAuthor">N. Modadugu</span>, <span class="refTitle">"Datagram Transport Layer Security Version 1.2"</span>, <span class="seriesInfo">RFC 6347</span>, <span class="seriesInfo">DOI 10.17487/RFC6347</span>, <time class="refDate" datetime="2012-01">January 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6347">https://www.rfc-editor.org/info/rfc6347</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6690">[RFC6690]</dt>
        <dd>
<span class="refAuthor">Shelby, Z.</span>, <span class="refTitle">"Constrained RESTful Environments (CoRE) Link Format"</span>, <span class="seriesInfo">RFC 6690</span>, <span class="seriesInfo">DOI 10.17487/RFC6690</span>, <time class="refDate" datetime="2012-08">August 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6690">https://www.rfc-editor.org/info/rfc6690</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7030">[RFC7030]</dt>
        <dd>
<span class="refAuthor">Pritikin, M., Ed.</span>, <span class="refAuthor">Yee, P., Ed.</span>, and <span class="refAuthor">D. Harkins, Ed.</span>, <span class="refTitle">"Enrollment over Secure Transport"</span>, <span class="seriesInfo">RFC 7030</span>, <span class="seriesInfo">DOI 10.17487/RFC7030</span>, <time class="refDate" datetime="2013-10">October 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7030">https://www.rfc-editor.org/info/rfc7030</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7252">[RFC7252]</dt>
        <dd>
<span class="refAuthor">Shelby, Z.</span>, <span class="refAuthor">Hartke, K.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"The Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 7252</span>, <span class="seriesInfo">DOI 10.17487/RFC7252</span>, <time class="refDate" datetime="2014-06">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7252">https://www.rfc-editor.org/info/rfc7252</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7925">[RFC7925]</dt>
        <dd>
<span class="refAuthor">Tschofenig, H., Ed.</span> and <span class="refAuthor">T. Fossati</span>, <span class="refTitle">"Transport Layer Security (TLS) / Datagram Transport Layer Security (DTLS) Profiles for the Internet of Things"</span>, <span class="seriesInfo">RFC 7925</span>, <span class="seriesInfo">DOI 10.17487/RFC7925</span>, <time class="refDate" datetime="2016-07">July 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7925">https://www.rfc-editor.org/info/rfc7925</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7959">[RFC7959]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span> and <span class="refAuthor">Z. Shelby, Ed.</span>, <span class="refTitle">"Block-Wise Transfers in the Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 7959</span>, <span class="seriesInfo">DOI 10.17487/RFC7959</span>, <time class="refDate" datetime="2016-08">August 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7959">https://www.rfc-editor.org/info/rfc7959</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8075">[RFC8075]</dt>
        <dd>
<span class="refAuthor">Castellani, A.</span>, <span class="refAuthor">Loreto, S.</span>, <span class="refAuthor">Rahman, A.</span>, <span class="refAuthor">Fossati, T.</span>, and <span class="refAuthor">E. Dijk</span>, <span class="refTitle">"Guidelines for Mapping Implementations: HTTP to the Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 8075</span>, <span class="seriesInfo">DOI 10.17487/RFC8075</span>, <time class="refDate" datetime="2017-02">February 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8075">https://www.rfc-editor.org/info/rfc8075</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time class="refDate" datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8422">[RFC8422]</dt>
        <dd>
<span class="refAuthor">Nir, Y.</span>, <span class="refAuthor">Josefsson, S.</span>, and <span class="refAuthor">M. Pegourie-Gonnard</span>, <span class="refTitle">"Elliptic Curve Cryptography (ECC) Cipher Suites for Transport Layer Security (TLS) Versions 1.2 and Earlier"</span>, <span class="seriesInfo">RFC 8422</span>, <span class="seriesInfo">DOI 10.17487/RFC8422</span>, <time class="refDate" datetime="2018-08">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8422">https://www.rfc-editor.org/info/rfc8422</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time class="refDate" datetime="2018-08">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8551">[RFC8551]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refAuthor">Ramsdell, B.</span>, and <span class="refAuthor">S. Turner</span>, <span class="refTitle">"Secure/Multipurpose Internet Mail Extensions (S/MIME) Version 4.0 Message Specification"</span>, <span class="seriesInfo">RFC 8551</span>, <span class="seriesInfo">DOI 10.17487/RFC8551</span>, <time class="refDate" datetime="2019-04">April 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8551">https://www.rfc-editor.org/info/rfc8551</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8710">[RFC8710]</dt>
        <dd>
<span class="refAuthor">Fossati, T.</span>, <span class="refAuthor">Hartke, K.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"Multipart Content-Format for the Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 8710</span>, <span class="seriesInfo">DOI 10.17487/RFC8710</span>, <time class="refDate" datetime="2020-02">February 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8710">https://www.rfc-editor.org/info/rfc8710</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9147">[RFC9147]</dt>
      <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refAuthor">Tschofenig, H.</span>, and <span class="refAuthor">N. Modadugu</span>, <span class="refTitle">"The Datagram Transport Layer Security (DTLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 9147</span>, <span class="seriesInfo">DOI 10.17487/RFC9147</span>, <time class="refDate" datetime="2022-04">April 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9147">https://www.rfc-editor.org/info/rfc9147</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-10.2">
        <h3 id="name-informative-references">
<a class="section-number selfRef" href="#section-10.2">10.2. </a><a class="section-name selfRef" href="#name-informative-references">Informative References</a>
        </h3>
<dl class="references">
<dt id="BCP195">[BCP195]</dt>
        <dd>
<div class="refInstance" id="RFC7525">
            <span class="refAuthor">Sheffer, Y.</span>, <span class="refAuthor">Holz, R.</span>, and <span class="refAuthor">P. Saint-Andre</span>, <span class="refTitle">"Recommendations for Secure Use of Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)"</span>, <span class="seriesInfo">BCP 195</span>, <span class="seriesInfo">RFC 7525</span>, <time class="refDate" datetime="2015-05">May 2015</time>. </div>
<span>&lt;<a href="https://www.rfc-editor.org/info/bcp195">https://www.rfc-editor.org/info/bcp195</a>&gt;</span>
</dd>
<dd class="break"></dd>
<dt id="CORE-PARAMS">[CORE-PARAMS]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Constrained RESTful Environments (CoRE) Parameters"</span>, <span>&lt;<a href="https://www.iana.org/assignments/core-parameters/">https://www.iana.org/assignments/core-parameters/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IEEE802.15.4">[IEEE802.15.4]</dt>
        <dd>
<span class="refAuthor">IEEE</span>, <span class="refTitle">"IEEE 802.15.4-2020 - IEEE Standard for Low-Rate Wireless Networks"</span>, <time class="refDate" datetime="2020-05">May 2020</time>. </dd>
<dd class="break"></dd>
<dt id="IEEE802.1AR">[IEEE802.1AR]</dt>
        <dd>
<span class="refAuthor">IEEE</span>, <span class="refTitle">"IEEE Standard for Local and metropolitan area networks - Secure Device Identity"</span>, <time class="refDate" datetime="2009-12">December 2009</time>. </dd>
<dd class="break"></dd>
<dt id="I-D.moskowitz-ecdsa-pki">[PKI-GUIDE]</dt>
        <dd>
<span class="refAuthor">Moskowitz, R.</span>, <span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Xia, L.</span>, and <span class="refAuthor">M. Richardson</span>, <span class="refTitle">"Guide for building an ECC pki"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-moskowitz-ecdsa-pki-10</span>, <time class="refDate" datetime="2021-01-31">31 January 2021</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-moskowitz-ecdsa-pki-10">https://datatracker.ietf.org/doc/html/draft-moskowitz-ecdsa-pki-10</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="PsQs">[PsQs]</dt>
        <dd>
<span class="refAuthor">Heninger, N.</span>, <span class="refAuthor">Durumeric, Z.</span>, <span class="refAuthor">Wustrow, E.</span>, and <span class="refAuthor">J. Alex Halderman</span>, <span class="refTitle">"Mining Your Ps and Qs: Detection of Widespread Weak Keys in Network Devices"</span>, <span class="refContent">USENIX Security Symposium 2012</span>, <span class="seriesInfo">ISBN 978-931971-95-9</span>, <time class="refDate" datetime="2012-08">August 2012</time>. </dd>
<dd class="break"></dd>
<dt id="RFC4919">[RFC4919]</dt>
        <dd>
<span class="refAuthor">Kushalnagar, N.</span>, <span class="refAuthor">Montenegro, G.</span>, and <span class="refAuthor">C. Schumacher</span>, <span class="refTitle">"IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs): Overview, Assumptions, Problem Statement, and Goals"</span>, <span class="seriesInfo">RFC 4919</span>, <span class="seriesInfo">DOI 10.17487/RFC4919</span>, <time class="refDate" datetime="2007-08">August 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4919">https://www.rfc-editor.org/info/rfc4919</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5272">[RFC5272]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span> and <span class="refAuthor">M. Myers</span>, <span class="refTitle">"Certificate Management over CMS (CMC)"</span>, <span class="seriesInfo">RFC 5272</span>, <span class="seriesInfo">DOI 10.17487/RFC5272</span>, <time class="refDate" datetime="2008-06">June 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5272">https://www.rfc-editor.org/info/rfc5272</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5929">[RFC5929]</dt>
        <dd>
<span class="refAuthor">Altman, J.</span>, <span class="refAuthor">Williams, N.</span>, and <span class="refAuthor">L. Zhu</span>, <span class="refTitle">"Channel Bindings for TLS"</span>, <span class="seriesInfo">RFC 5929</span>, <span class="seriesInfo">DOI 10.17487/RFC5929</span>, <time class="refDate" datetime="2010-07">July 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5929">https://www.rfc-editor.org/info/rfc5929</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6402">[RFC6402]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"Certificate Management over CMS (CMC) Updates"</span>, <span class="seriesInfo">RFC 6402</span>, <span class="seriesInfo">DOI 10.17487/RFC6402</span>, <time class="refDate" datetime="2011-11">November 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6402">https://www.rfc-editor.org/info/rfc6402</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7228">[RFC7228]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span>, <span class="refAuthor">Ersue, M.</span>, and <span class="refAuthor">A. Keranen</span>, <span class="refTitle">"Terminology for Constrained-Node Networks"</span>, <span class="seriesInfo">RFC 7228</span>, <span class="seriesInfo">DOI 10.17487/RFC7228</span>, <time class="refDate" datetime="2014-05">May 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7228">https://www.rfc-editor.org/info/rfc7228</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7230">[RFC7230]</dt>
        <dd>
<span class="refAuthor">Fielding, R., Ed.</span> and <span class="refAuthor">J. Reschke, Ed.</span>, <span class="refTitle">"Hypertext Transfer Protocol (HTTP/1.1): Message Syntax and Routing"</span>, <span class="seriesInfo">RFC 7230</span>, <span class="seriesInfo">DOI 10.17487/RFC7230</span>, <time class="refDate" datetime="2014-06">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7230">https://www.rfc-editor.org/info/rfc7230</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7251">[RFC7251]</dt>
        <dd>
<span class="refAuthor">McGrew, D.</span>, <span class="refAuthor">Bailey, D.</span>, <span class="refAuthor">Campagna, M.</span>, and <span class="refAuthor">R. Dugal</span>, <span class="refTitle">"AES-CCM Elliptic Curve Cryptography (ECC) Cipher Suites for TLS"</span>, <span class="seriesInfo">RFC 7251</span>, <span class="seriesInfo">DOI 10.17487/RFC7251</span>, <time class="refDate" datetime="2014-06">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7251">https://www.rfc-editor.org/info/rfc7251</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7299">[RFC7299]</dt>
        <dd>
<span class="refAuthor">Housley, R.</span>, <span class="refTitle">"Object Identifier Registry for the PKIX Working Group"</span>, <span class="seriesInfo">RFC 7299</span>, <span class="seriesInfo">DOI 10.17487/RFC7299</span>, <time class="refDate" datetime="2014-07">July 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7299">https://www.rfc-editor.org/info/rfc7299</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7627">[RFC7627]</dt>
        <dd>
<span class="refAuthor">Bhargavan, K., Ed.</span>, <span class="refAuthor">Delignat-Lavaud, A.</span>, <span class="refAuthor">Pironti, A.</span>, <span class="refAuthor">Langley, A.</span>, and <span class="refAuthor">M. Ray</span>, <span class="refTitle">"Transport Layer Security (TLS) Session Hash and Extended Master Secret Extension"</span>, <span class="seriesInfo">RFC 7627</span>, <span class="seriesInfo">DOI 10.17487/RFC7627</span>, <time class="refDate" datetime="2015-09">September 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7627">https://www.rfc-editor.org/info/rfc7627</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7748">[RFC7748]</dt>
        <dd>
<span class="refAuthor">Langley, A.</span>, <span class="refAuthor">Hamburg, M.</span>, and <span class="refAuthor">S. Turner</span>, <span class="refTitle">"Elliptic Curves for Security"</span>, <span class="seriesInfo">RFC 7748</span>, <span class="seriesInfo">DOI 10.17487/RFC7748</span>, <time class="refDate" datetime="2016-01">January 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7748">https://www.rfc-editor.org/info/rfc7748</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9146">[RFC9146]</dt>
        <dd>
<span class="refAuthor">Rescorla, E., Ed.</span>, <span class="refAuthor">Tschofenig, H., Ed.</span>, <span class="refAuthor">Fossati, T.</span>, and <span class="refAuthor">A. Kraus</span>, <span class="refTitle">"Connection Identifier for DTLS 1.2"</span>, <span class="seriesInfo">RFC 9146</span>, <span class="seriesInfo">DOI 10.17487/RFC9146</span>, <time class="refDate" datetime="2022-03">March 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9146">https://www.rfc-editor.org/info/rfc9146</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RSA-FACT">[RSA-FACT]</dt>
        <dd>
<span class="refAuthor">Bernstein, D.</span>, <span class="refAuthor">Chang, Y.</span>, <span class="refAuthor">Cheng, C.</span>, <span class="refAuthor">Chou, L.</span>, <span class="refAuthor">Heninger, N.</span>, <span class="refAuthor">Lange, T.</span>, and <span class="refAuthor">N. Someren</span>, <span class="refTitle">"Factoring RSA keys from certified smart cards: Coppersmith in the wild"</span>, <span class="refContent">Advances in Cryptology - ASIACRYPT 2013</span>, <time class="refDate" datetime="2013-08">August 2013</time>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-kitten-tls-channel-bindings-for-tls13">[TLS13-CHANNEL-BINDINGS]</dt>
        <dd>
<span class="refAuthor">Whited, S.</span>, <span class="refTitle">"Channel Bindings for TLS 1.3"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-kitten-tls-channel-bindings-for-tls13-15</span>, <time class="refDate" datetime="2022-03-04">4 March 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-kitten-tls-channel-bindings-for-tls13-15">https://datatracker.ietf.org/doc/html/draft-ietf-kitten-tls-channel-bindings-for-tls13-15</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TRIPLESHAKE">[TRIPLESHAKE]</dt>
      <dd>
<span class="refAuthor">Bhargavan, B.</span>, <span class="refAuthor">Delignat-Lavaud, A.</span>, <span class="refAuthor">Fournet, C.</span>, <span class="refAuthor">Pironti, A.</span>, and <span class="refAuthor">P. Strub</span>, <span class="refTitle">"Triple Handshakes and Cookie Cutters: Breaking and Fixing Authentication over TLS"</span>, <span class="seriesInfo">ISBN 978-1-4799-4686-0</span>, <span class="seriesInfo">DOI 10.1109/SP.2014.14</span>, <time class="refDate" datetime="2014-05">May 2014</time>, <span>&lt;<a href="https://doi.org/10.1109/SP.2014.14">https://doi.org/10.1109/SP.2014.14</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="messagebindings">
<section id="appendix-A">
      <h2 id="name-est-messages-to-est-coaps">
<a class="section-number selfRef" href="#appendix-A">Appendix A. </a><a class="section-name selfRef" href="#name-est-messages-to-est-coaps">EST Messages to EST-coaps</a>
      </h2>
<p id="appendix-A-1">This section shows similar examples to the ones presented in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc7030#appendix-A">Appendix A</a> of [<a class="xref" href="#RFC7030">RFC7030</a>]</span>. The payloads in the
      examples are the hex-encoded binary, generated with 'xxd -p', of the PKI
      certificates created following <span>[<a class="xref" href="#I-D.moskowitz-ecdsa-pki">PKI-GUIDE</a>]</span>. Hex is used for visualization purposes because a
      binary representation cannot be rendered well in text.  The hexadecimal
      representations would not be transported in hex, but in binary.  The
      payloads are shown unencrypted. In practice, the message content would be
      transferred over an encrypted DTLS channel.<a class="pilcrow" href="#appendix-A-1">¶</a></p>
<p id="appendix-A-2">The certificate responses included in the examples contain
    Content-Format 281 (application/pkcs7). If the client had requested
    Content-Format 287 (application/pkix-cert), the server would respond with
    a single DER binary certificate. That certificate would be in a
    multipart-core container specifically in the case of a response to a
    /est/skc query.<a class="pilcrow" href="#appendix-A-2">¶</a></p>
<p id="appendix-A-3">These examples assume a short resource path of "/est". Even though
      omitted from the examples for brevity, before making the EST-coaps
      requests, a client would learn about the server supported EST-coaps
      resources with a GET request for /.well-known/core?rt=ace.est* as
      explained in <a class="xref" href="#discovery">Section 4.1</a>.<a class="pilcrow" href="#appendix-A-3">¶</a></p>
<p id="appendix-A-4">The corresponding CoAP headers are only shown in <a class="xref" href="#cacerts">Appendix A.1</a>.
 Creating CoAP headers is assumed to be generally understood.<a class="pilcrow" href="#appendix-A-4">¶</a></p>
<p id="appendix-A-5">The message content is presented in plain text in <a class="xref" href="#cont_breakdown">Appendix C</a>.<a class="pilcrow" href="#appendix-A-5">¶</a></p>
<div id="cacerts">
<section id="appendix-A.1">
        <h3 id="name-cacerts">
<a class="section-number selfRef" href="#appendix-A.1">A.1. </a><a class="section-name selfRef" href="#name-cacerts">cacerts</a>
        </h3>
<p id="appendix-A.1-1">In EST-coaps, a cacerts message can be the following:<a class="pilcrow" href="#appendix-A.1-1">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.1-2">
<pre>GET example.com:9085/est/crts
(Accept:  281)
</pre><a class="pilcrow" href="#appendix-A.1-2">¶</a>
</div>
<p id="appendix-A.1-3">The corresponding CoAP header fields are shown below. The use of
        block and DTLS are shown in <a class="xref" href="#blockexamples">Appendix B</a>.<a class="pilcrow" href="#appendix-A.1-3">¶</a></p>
<div id="appendix-A.1-4">
<pre class="lang-coap sourcecode">  Ver = 1
  T = 0 (CON)
  Code = 0x01 (0.01 is GET)
  Token = 0x9a (client generated)
  Options
  Option (Uri-Host)
     Option Delta = 0x3  (option# 3)
     Option Length = 0xB
     Option Value = "example.com"
  Option (Uri-Port)
     Option Delta = 0x4  (option# 3+4=7)
     Option Length = 0x2
     Option Value = 9085
   Option (Uri-Path)
     Option Delta = 0x4   (option# 7+4=11)
     Option Length = 0x3
     Option Value = "est"
   Option (Uri-Path)
     Option Delta = 0x0   (option# 11+0=11)
     Option Length = 0x4
     Option Value = "crts"
   Option (Accept)
     Option Delta = 0x6   (option# 11+6=17)
     Option Length = 0x2
     Option Value = 281
  Payload = [Empty]
</pre><a class="pilcrow" href="#appendix-A.1-4">¶</a>
</div>
<p id="appendix-A.1-5">As specified in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc7252#section-5.10.1">Section 5.10.1</a> of [<a class="xref" href="#RFC7252">RFC7252</a>]</span>, the Uri-Host and Uri-Port Options can be omitted
        if they coincide with the transport protocol destination address and
        port, respectively.<a class="pilcrow" href="#appendix-A.1-5">¶</a></p>
<p id="appendix-A.1-6">A 2.05 Content response with a cert in EST-coaps will then be the following:<a class="pilcrow" href="#appendix-A.1-6">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.1-7">
<pre>2.05 Content (Content-Format: 281)
   {payload with certificate in binary format}
</pre><a class="pilcrow" href="#appendix-A.1-7">¶</a>
</div>
<p id="appendix-A.1-8">With the following CoAP fields:<a class="pilcrow" href="#appendix-A.1-8">¶</a></p>
<div id="appendix-A.1-9">
<pre class="lang-coap sourcecode">  Ver = 1
  T = 2 (ACK)
  Code = 0x45 (2.05 Content)
  Token = 0x9a   (copied from request by server)
  Options
    Option (Content-Format)
      Option Delta = 0xC  (option# 12)
      Option Length = 0x2
      Option Value = 281

  [ The hexadecimal representation below would NOT be transported
  in hex, but in binary. Hex is used because a binary representation
  cannot be rendered well in text. ]

  Payload =
3082027a06092a864886f70d010702a082026b308202670201013100300b
06092a864886f70d010701a082024d30820249308201efa0030201020208
0b8bb0fe604f6a1e300a06082a8648ce3d0403023067310b300906035504
0613025553310b300906035504080c024341310b300906035504070c024c
4131143012060355040a0c0b4578616d706c6520496e6331163014060355
040b0c0d63657274696669636174696f6e3110300e06035504030c07526f
6f74204341301e170d3139303133313131323730335a170d333930313236
3131323730335a3067310b3009060355040613025553310b300906035504
080c024341310b300906035504070c024c4131143012060355040a0c0b45
78616d706c6520496e6331163014060355040b0c0d636572746966696361
74696f6e3110300e06035504030c07526f6f742043413059301306072a86
48ce3d020106082a8648ce3d030107034200040c1b1e82ba8cc72680973f
97edb8a0c72ab0d405f05d4fe29b997a14ccce89008313d09666b6ce375c
595fcc8e37f8e4354497011be90e56794bd91ad951ab45a3818430818130
1d0603551d0e041604141df1208944d77b5f1d9dcb51ee244a523f3ef5de
301f0603551d230418301680141df1208944d77b5f1d9dcb51ee244a523f
3ef5de300f0603551d130101ff040530030101ff300e0603551d0f0101ff
040403020106301e0603551d110417301581136365727469667940657861
6d706c652e636f6d300a06082a8648ce3d040302034800304502202b891d
d411d07a6d6f621947635ba4c43165296b3f633726f02e51ecf464bd4002
2100b4be8a80d08675f041fbc719acf3b39dedc85dc92b3035868cb2daa8
f05db196a1003100
</pre><a class="pilcrow" href="#appendix-A.1-9">¶</a>
</div>
<p id="appendix-A.1-10">The payload is shown in plain text in <a class="xref" href="#cacertsdis">Appendix C.1</a>.<a class="pilcrow" href="#appendix-A.1-10">¶</a></p>
</section>
</div>
<section id="appendix-A.2">
        <h3 id="name-enroll-reenroll">
<a class="section-number selfRef" href="#appendix-A.2">A.2. </a><a class="section-name selfRef" href="#name-enroll-reenroll">enroll / reenroll</a>
        </h3>
<p id="appendix-A.2-1">
     During the (re-)enroll exchange, the EST-coaps client uses a CSR
     (Content-Format 286) request in the POST request payload.  The
     Accept Option tells the server that the client is expecting
     Content-Format 281 (PKCS #7) in the response.  As shown in <a class="xref" href="#enrolldis">Appendix C.2</a>, the CSR contains a
     challengePassword, which is used for POP linking (<a class="xref" href="#profile7925">Section 3</a>).<a class="pilcrow" href="#appendix-A.2-1">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.2-2">
<pre>POST [2001:db8::2:321]:61616/est/sen
(Token: 0x45)
(Accept: 281)
(Content-Format: 286)

[ The hexadecimal representation below would NOT be transported
in hex, but in binary. Hex is used because a binary representation
cannot be rendered well in text. ]

3082018b30820131020100305c310b3009060355040613025553310b3009
06035504080c024341310b300906035504070c024c413114301206035504
0a0c0b6578616d706c6520496e63310c300a060355040b0c03496f54310f
300d060355040513065774313233343059301306072a8648ce3d02010608
2a8648ce3d03010703420004c8b421f11c25e47e3ac57123bf2d9fdc494f
028bc351cc80c03f150bf50cff958d75419d81a6a245dffae790be95cf75
f602f9152618f816a2b23b5638e59fd9a073303406092a864886f70d0109
0731270c2576437630292a264a4b4a3bc3a2c280c2992f3e3c2e2c3d6b6e
7634332323403d204e787e60303b06092a864886f70d01090e312e302c30
2a0603551d1104233021a01f06082b06010505070804a013301106092b06
010401b43b0a01040401020304300a06082a8648ce3d0403020348003045
02210092563a546463bd9ecff170d0fd1f2ef0d3d012160e5ee90cffedab
ec9b9a38920220179f10a3436109051abad17590a09bc87c4dce5453a6fc
1135a1e84eed754377
</pre><a class="pilcrow" href="#appendix-A.2-2">¶</a>
</div>
<p id="appendix-A.2-3">
     After verification of the CSR by the server, a 2.04 Changed response
 with the issued certificate will be returned to the client.<a class="pilcrow" href="#appendix-A.2-3">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.2-4">
<pre>2.04 Changed
(Token: 0x45)
(Content-Format: 281)

[ The hexadecimal representation below would NOT be transported
in hex, but in binary. Hex is used because a binary representation
cannot be rendered well in text. ]

3082026e06092a864886f70d010702a082025f3082025b0201013100300b
06092a864886f70d010701a08202413082023d308201e2a0030201020208
7e7661d7b54e4632300a06082a8648ce3d040302305d310b300906035504
0613025553310b300906035504080c02434131143012060355040a0c0b45
78616d706c6520496e6331163014060355040b0c0d636572746966696361
74696f6e3113301106035504030c0a3830322e3141522043413020170d31
39303133313131323931365a180f39393939313233313233353935395a30
5c310b3009060355040613025553310b300906035504080c024341310b30
0906035504070c024c4131143012060355040a0c0b6578616d706c652049
6e63310c300a060355040b0c03496f54310f300d06035504051306577431
3233343059301306072a8648ce3d020106082a8648ce3d03010703420004
c8b421f11c25e47e3ac57123bf2d9fdc494f028bc351cc80c03f150bf50c
ff958d75419d81a6a245dffae790be95cf75f602f9152618f816a2b23b56
38e59fd9a3818a30818730090603551d1304023000301d0603551d0e0416
041496600d8716bf7fd0e752d0ac760777ad665d02a0301f0603551d2304
183016801468d16551f951bfc82a431d0d9f08bc2d205b1160300e060355
1d0f0101ff0404030205a0302a0603551d1104233021a01f06082b060105
05070804a013301106092b06010401b43b0a01040401020304300a06082a
8648ce3d0403020349003046022100c0d81996d2507d693f3c48eaa5ee94
91bda6db214099d98117c63b361374cd86022100a774989f4c321a5cf25d
832a4d336a08ad67df20f1506421188a0ade6d349236a1003100
</pre><a class="pilcrow" href="#appendix-A.2-4">¶</a>
</div>
<p id="appendix-A.2-5">The request and response is shown in plain text in <a class="xref" href="#enrolldis">Appendix C.2</a>.<a class="pilcrow" href="#appendix-A.2-5">¶</a></p>
</section>
<div id="appskg">
<section id="appendix-A.3">
        <h3 id="name-serverkeygen">
<a class="section-number selfRef" href="#appendix-A.3">A.3. </a><a class="section-name selfRef" href="#name-serverkeygen">serverkeygen</a>
        </h3>
<p id="appendix-A.3-1">In a serverkeygen exchange, the CoAP POST request looks like the following:<a class="pilcrow" href="#appendix-A.3-1">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.3-2">
<pre>POST 192.0.2.1:8085/est/skg
(Token: 0xa5)
(Accept: 62)
(Content-Format: 286)

[ The hexadecimal representation below would NOT be transported
in hex, but in binary. Hex is used because a binary representation
cannot be rendered well in text. ]

3081d03078020100301631143012060355040a0c0b736b67206578616d70
6c653059301306072a8648ce3d020106082a8648ce3d03010703420004c8
b421f11c25e47e3ac57123bf2d9fdc494f028bc351cc80c03f150bf50cff
958d75419d81a6a245dffae790be95cf75f602f9152618f816a2b23b5638
e59fd9a000300a06082a8648ce3d040302034800304502207c553981b1fe
349249d8a3f50a0346336b7dfaa099cf74e1ec7a37a0a760485902210084
79295398774b2ff8e7e82abb0c17eaef344a5088fa69fd63ee611850c34b
0a
</pre><a class="pilcrow" href="#appendix-A.3-2">¶</a>
</div>
<p id="appendix-A.3-3">The response would follow <span>[<a class="xref" href="#RFC8710">RFC8710</a>]</span> and could look like the following:<a class="pilcrow" href="#appendix-A.3-3">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.3-4">
<pre>2.04 Changed
(Token: 0xa5)
(Content-Format: 62)

[ The hexadecimal representations below would NOT be transported
in hex, but in binary. Hex is used because a binary representation
cannot be rendered well in text. ]

84                                   # array(4)
19 011C                              # unsigned(284)
58 8A                                # bytes(138)
308187020100301306072a8648ce3d020106082a8648ce3d030107046d30
6b020101042061336a86ac6e7af4a96f632830ad4e6aa0837679206094d7
679a01ca8c6f0c37a14403420004c8b421f11c25e47e3ac57123bf2d9fdc
494f028bc351cc80c03f150bf50cff958d75419d81a6a245dffae790be95
cf75f602f9152618f816a2b23b5638e59fd9
19 0119                              # unsigned(281)
59 01D3                              # bytes(467)
308201cf06092a864886f70d010702a08201c0308201bc0201013100300b
06092a864886f70d010701a08201a23082019e30820144a0030201020209
00b3313e8f3fc9538e300a06082a8648ce3d040302301631143012060355
040a0c0b736b67206578616d706c65301e170d3139303930343037343430
335a170d3339303833303037343430335a301631143012060355040a0c0b
736b67206578616d706c653059301306072a8648ce3d020106082a8648ce
3d03010703420004c8b421f11c25e47e3ac57123bf2d9fdc494f028bc351
cc80c03f150bf50cff958d75419d81a6a245dffae790be95cf75f602f915
2618f816a2b23b5638e59fd9a37b307930090603551d1304023000302c06
096086480186f842010d041f161d4f70656e53534c2047656e6572617465
64204365727469666963617465301d0603551d0e0416041496600d8716bf
7fd0e752d0ac760777ad665d02a0301f0603551d2304183016801496600d
8716bf7fd0e752d0ac760777ad665d02a0300a06082a8648ce3d04030203
48003045022100e95bfa25a08976652246f2d96143da39fce0dc4c9b26b9
cce1f24164cc2b12b602201351fd8eea65764e3459d324e4345ff5b2a915
38c04976111796b3698bf6379ca1003100
</pre><a class="pilcrow" href="#appendix-A.3-4">¶</a>
</div>
<p id="appendix-A.3-5">The private key in the response above is without CMS EnvelopedData
   and has no additional encryption beyond DTLS (<a class="xref" href="#serverkey">Section 4.8</a>).<a class="pilcrow" href="#appendix-A.3-5">¶</a></p>
<p id="appendix-A.3-6">The request and response is shown in plain text in <a class="xref" href="#disskgrequest">Appendix C.3</a>.<a class="pilcrow" href="#appendix-A.3-6">¶</a></p>
</section>
</div>
<section id="appendix-A.4">
        <h3 id="name-csrattrs">
<a class="section-number selfRef" href="#appendix-A.4">A.4. </a><a class="section-name selfRef" href="#name-csrattrs">csrattrs</a>
        </h3>
<p id="appendix-A.4-1">The following is a csrattrs exchange:<a class="pilcrow" href="#appendix-A.4-1">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.4-2">
<pre>REQ:
GET example.com:61616/est/att

RES:
2.05 Content
(Content-Format: 285)

[ The hexadecimal representation below would NOT be transported
in hex, but in binary. Hex is used because a binary representation
cannot be rendered well in text. ]

307c06072b06010101011630220603883701311b131950617273652053455
420617320322e3939392e31206461746106092a864886f70d010907302c06
0388370231250603883703060388370413195061727365205345542061732
0322e3939392e32206461746106092b240303020801010b06096086480165
03040202
</pre><a class="pilcrow" href="#appendix-A.4-2">¶</a>
</div>
<p id="appendix-A.4-3">A 2.05 Content response should contain attributes that are
        relevant for the authenticated client. This example is copied from
        <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc7030#appendix-A.2">Appendix A.2</a> of [<a class="xref" href="#RFC7030">RFC7030</a>]</span>, where the
        base64 representation is replaced with a hexadecimal representation of
        the equivalent binary format.  The EST-coaps server returns attributes
        that the client can ignore if they are unknown to the client.<a class="pilcrow" href="#appendix-A.4-3">¶</a></p>
</section>
</section>
</div>
<div id="blockexamples">
<section id="appendix-B">
      <h2 id="name-est-coaps-block-message-exa">
<a class="section-number selfRef" href="#appendix-B">Appendix B. </a><a class="section-name selfRef" href="#name-est-coaps-block-message-exa">EST-coaps Block Message Examples</a>
      </h2>
<p id="appendix-B-1">Two examples are presented in this section:<a class="pilcrow" href="#appendix-B-1">¶</a></p>
<ol class="normal type-1" id="appendix-B-2" start="1" type="1">
        <li id="appendix-B-2.1">A cacerts exchange shows the use of Block2 and the block headers.<a class="pilcrow" href="#appendix-B-2.1">¶</a>
</li>
        <li id="appendix-B-2.2">An enroll exchange shows the Block1 and Block2 size negotiation
        for request and response payloads.<a class="pilcrow" href="#appendix-B-2.2">¶</a>
</li>
      </ol>
<p id="appendix-B-3">The payloads are shown unencrypted. In practice, the message contents
 would be binary formatted and transferred over an encrypted DTLS tunnel.
 The corresponding CoAP headers are only shown in <a class="xref" href="#cacertsblock">Appendix B.1</a>.
 Creating CoAP headers is assumed to be generally known.<a class="pilcrow" href="#appendix-B-3">¶</a></p>
<div id="cacertsblock">
<section id="appendix-B.1">
        <h3 id="name-cacerts-2">
<a class="section-number selfRef" href="#appendix-B.1">B.1. </a><a class="section-name selfRef" href="#name-cacerts-2">cacerts</a>
        </h3>
<p id="appendix-B.1-1">This section provides a detailed example of the messages using DTLS
        and CoAP Option Block2. The example block length is taken as 64,
        which gives an SZX value of 2.<a class="pilcrow" href="#appendix-B.1-1">¶</a></p>
<p id="appendix-B.1-2">The following is an example of a cacerts exchange over DTLS. The
        content length of the cacerts response in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc7030#appendix-A.1">Appendix A.1</a> of [<a class="xref" href="#RFC7030">RFC7030</a>]</span> contains 639 bytes in binary in
        this example. The CoAP message adds around 10 bytes in this example,
        and the DTLS record around 29 bytes. To avoid IP fragmentation, the
        CoAP Block Option is used and an MTU of 127 is assumed to stay within
        one IEEE 802.15.4 packet. To stay below the MTU of 127, the payload is
        split in 9 packets with a payload of 64 bytes each, followed by a
        last tenth packet of 63 bytes. The client sends an IPv6 packet
        containing a UDP datagram with DTLS record protection that
        encapsulates a CoAP request 10 times (one fragment of the request per
        block). The server returns an IPv6 packet containing a UDP datagram
        with the DTLS record that encapsulates the CoAP response. The CoAP
        request-response exchange with block option is shown below. Block
        Option is shown in a decomposed way (block-option:NUM/M/size)
        indicating the kind of Block Option (2 in this case) followed by a
        colon, and then the block number (NUM), the more bit (M = 0 in Block2
        response means it is last block), and block size with exponent
        (2<sup>(SZX+4)</sup>) separated by slashes.  The Length 64 is used with
        SZX=2. The CoAP Request is sent Confirmable (CON), and the
        Content-Format of the response, even though not shown, is 281
        (application/pkcs7-mime; smime-type=certs-only).  The transfer of the
        10 blocks with partially filled block NUM=9 is shown below.<a class="pilcrow" href="#appendix-B.1-2">¶</a></p>
<div id="appendix-B.1-3">
<pre class="lang-coap sourcecode">   GET example.com:9085/est/crts (2:0/0/64)  --&gt;
                 &lt;--   (2:0/1/64) 2.05 Content
   GET example.com:9085/est/crts (2:1/0/64)  --&gt;
                 &lt;--   (2:1/1/64) 2.05 Content
                               |
                               |
                               |
   GET example.com:9085/est/crts (2:9/0/64) --&gt;
                 &lt;--   (2:9/0/64) 2.05 Content
</pre><a class="pilcrow" href="#appendix-B.1-3">¶</a>
</div>
<p id="appendix-B.1-4">The header of the GET request looks like the following:<a class="pilcrow" href="#appendix-B.1-4">¶</a></p>
<div id="appendix-B.1-5">
<pre class="lang-coap sourcecode">  Ver = 1
  T = 0 (CON)
  Code = 0x01 (0.1 GET)
  Token = 0x9a    (client generated)
  Options
   Option (Uri-Host)
     Option Delta = 0x3  (option# 3)
     Option Length = 0xB
     Option Value = "example.com"
   Option (Uri-Port)
     Option Delta = 0x4   (option# 3+4=7)
     Option Length = 0x2
     Option Value = 9085
   Option (Uri-Path)
     Option Delta = 0x4    (option# 7+4=11)
     Option Length = 0x3
     Option Value = "est"
   Option (Uri-Path)Uri-Path)
     Option Delta = 0x0    (option# 11+0=11)
     Option Length = 0x4
     Option Value = "crts"
   Option (Accept)
     Option Delta = 0x6   (option# 11+6=17)
     Option Length = 0x2
     Option Value = 281
  Payload = [Empty]
</pre><a class="pilcrow" href="#appendix-B.1-5">¶</a>
</div>
<p id="appendix-B.1-6">The Uri-Host and Uri-Port Options can be omitted if they coincide
        with the transport protocol destination address and port,
        respectively. Explicit Uri-Host and Uri-Port Options are typically
        used when an endpoint hosts multiple virtual servers and uses the
        Options to route the requests accordingly.<a class="pilcrow" href="#appendix-B.1-6">¶</a></p>
<p id="appendix-B.1-7">To provide further details on the CoAP headers, the first two and the last blocks are
 written out below. The header of the first Block2 response looks like the following:<a class="pilcrow" href="#appendix-B.1-7">¶</a></p>
<div id="appendix-B.1-8">
<pre class="lang-coap sourcecode">  Ver = 1
  T = 2 (ACK)
  Code = 0x45 (2.05 Content)
  Token = 0x9a     (copied from request by server)
  Options
    Option
      Option Delta = 0xC  (option# 12 Content-Format)
      Option Length = 0x2
      Option Value = 281
    Option
      Option Delta = 0xB  (option# 12+11=23 Block2)
      Option Length = 0x1
      Option Value = 0x0A (block#=0, M=1, SZX=2)

  [ The hexadecimal representation below would NOT be transported
  in hex, but in binary. Hex is used because a binary representation
  cannot be rendered well in text. ]

  Payload =
3082027b06092a864886f70d010702a082026c308202680201013100300b
06092a864886f70d010701a082024e3082024a308201f0a0030201020209
009189bc
</pre><a class="pilcrow" href="#appendix-B.1-8">¶</a>
</div>
<p id="appendix-B.1-9">The header of the second Block2 response looks like the following:<a class="pilcrow" href="#appendix-B.1-9">¶</a></p>
<div id="appendix-B.1-10">
<pre class="lang-coap sourcecode">  Ver = 1
  T = 2 (means ACK)
  Code = 0x45 (2.05 Content)
  Token = 0x9a     (copied from request by server)
  Options
    Option
      Option Delta = 0xC  (option# 12 Content-Format)
      Option Length = 0x2
      Option Value = 281
    Option
      Option Delta = 0xB  (option 12+11=23 Block2)
      Option Length = 0x1
      Option Value = 0x1A (block#=1, M=1, SZX=2)

  [ The hexadecimal representation below would NOT be transported
  in hex, but in binary. Hex is used because a binary representation
  cannot be rendered well in text. ]

  Payload =
df9c99244b300a06082a8648ce3d0403023067310b300906035504061302
5553310b300906035504080c024341310b300906035504070c024c413114
30120603
</pre><a class="pilcrow" href="#appendix-B.1-10">¶</a>
</div>
<p id="appendix-B.1-11">The header of the tenth and final Block2 response looks like the following:<a class="pilcrow" href="#appendix-B.1-11">¶</a></p>
<div id="appendix-B.1-12">
<pre class="lang-coap sourcecode">  Ver = 1
  T = 2 (means ACK)
  Code = 0x45      (2.05 Content)
  Token = 0x9a     (copied from request by server)
  Options
    Option
      Option Delta = 0xC  (option# 12 Content-Format)
      Option Length = 0x2
      Option Value = 281
    Option
      Option Delta = 0xB  (option# 12+11=23 Block2 )
      Option Length = 0x1
      Option Value = 0x92 (block#=9, M=0, SZX=2)

  [ The hexadecimal representation below would NOT be transported
  in hex, but in binary. Hex is used because a binary representation
  cannot be rendered well in text. ]

  Payload =
2ec0b4af52d46f3b7ecc9687ddf267bcec368f7b7f1353272f022047a28a
e5c7306163b3c3834bab3c103f743070594c089aaa0ac870cd13b902caa1
003100
</pre><a class="pilcrow" href="#appendix-B.1-12">¶</a>
</div>
</section>
</div>
<div id="enrollblock">
<section id="appendix-B.2">
        <h3 id="name-enroll-reenroll-2">
<a class="section-number selfRef" href="#appendix-B.2">B.2. </a><a class="section-name selfRef" href="#name-enroll-reenroll-2">enroll / reenroll</a>
        </h3>
<p id="appendix-B.2-1">
      In this example, the requested Block2 size of 256 bytes, required by the
      client, is transferred to the server in the very first request
      message. The block size of 256 is equal to (2<sup>(SZX+4)</sup>), which
      gives SZX=4. The notation for block numbering is the same as in <a class="xref" href="#cacertsblock">Appendix B.1</a>. The header fields and the
      payload are omitted for brevity.<a class="pilcrow" href="#appendix-B.2-1">¶</a></p>
<span id="name-est-coaps-enrollment-with-m"></span><div id="fig-est-multiple-block">
<figure id="figure-6">
          <div class="alignLeft art-text artwork" id="appendix-B.2-2.1">
<pre>POST [2001:db8::2:1]:61616/est/sen (CON)(1:0/1/256)
                   {CSR (frag# 1)} --&gt;

       &lt;-- (ACK) (1:0/1/256) (2.31 Continue)
POST [2001:db8::2:1]:61616/est/sen (CON)(1:1/1/256)
                   {CSR (frag# 2)} --&gt;
       &lt;-- (ACK) (1:1/1/256) (2.31 Continue)
                      .
                      .
                      .
POST [2001:db8::2:1]:61616/est/sen (CON)(1:N1/0/256)
                   {CSR(frag# N1+1)}--&gt;
                      |
    ...........Immediate response  .........
                      |
  &lt;-- (ACK) (1:N1/0/256)(2:0/1/256)(2.04 Changed)
                   {Cert resp (frag# 1)}
POST [2001:db8::2:1]:61616/est/sen (CON)(2:1/0/256)           --&gt;
  &lt;-- (ACK) (2:1/1/256)(2.04 Changed)
                   {Cert resp (frag# 2)}
                      .
                      .
                      .
POST [2001:db8::2:321]:61616/est/sen (CON)(2:N2/0/256)          --&gt;
  &lt;-- (ACK) (2:N2/0/256) (2.04 Changed)
                   {Cert resp (frag# N2+1)}
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-6">Figure 6</a>:
<a class="selfRef" href="#name-est-coaps-enrollment-with-m">EST-coaps Enrollment with Multiple Blocks</a>
          </figcaption></figure>
</div>
<p id="appendix-B.2-3">N1+1 blocks have been transferred from client to server, and N2+1 blocks have been
   transferred from server to client.<a class="pilcrow" href="#appendix-B.2-3">¶</a></p>
</section>
</div>
</section>
</div>
<div id="cont_breakdown">
<section id="appendix-C">
      <h2 id="name-message-content-breakdown">
<a class="section-number selfRef" href="#appendix-C">Appendix C. </a><a class="section-name selfRef" href="#name-message-content-breakdown">Message Content Breakdown</a>
      </h2>
<p id="appendix-C-1">This appendix presents the hexadecimal dumps of the binary payloads
      in plain text shown in <a class="xref" href="#messagebindings">Appendix A</a>.<a class="pilcrow" href="#appendix-C-1">¶</a></p>
<div id="cacertsdis">
<section id="appendix-C.1">
        <h3 id="name-cacerts-3">
<a class="section-number selfRef" href="#appendix-C.1">C.1. </a><a class="section-name selfRef" href="#name-cacerts-3">cacerts</a>
        </h3>
<p id="appendix-C.1-1">The cacerts response containing one root CA certificate is
        presented in plain text in the following:<a class="pilcrow" href="#appendix-C.1-1">¶</a></p>
<div id="appendix-C.1-2">
<pre class="lang-asn.1 sourcecode">Certificate:
    Data:
        Version: 3 (0x2)
        Serial Number: 831953162763987486 (0xb8bb0fe604f6a1e)
    Signature Algorithm: ecdsa-with-SHA256
        Issuer: C=US, ST=CA, L=LA, O=Example Inc,
                  OU=certification, CN=Root CA
        Validity
            Not Before: Jan 31 11:27:03 2019 GMT
            Not After : Jan 26 11:27:03 2039 GMT
        Subject: C=US, ST=CA, L=LA, O=Example Inc,
                     OU=certification, CN=Root CA
        Subject Public Key Info:
            Public Key Algorithm: id-ecPublicKey
                Public-Key: (256 bit)
                pub:
                    04:0c:1b:1e:82:ba:8c:c7:26:80:97:3f:97:ed:b8:
                    a0:c7:2a:b0:d4:05:f0:5d:4f:e2:9b:99:7a:14:cc:
                    ce:89:00:83:13:d0:96:66:b6:ce:37:5c:59:5f:cc:
                    8e:37:f8:e4:35:44:97:01:1b:e9:0e:56:79:4b:d9:
                    1a:d9:51:ab:45
                ASN1 OID: prime256v1
                NIST CURVE: P-256
        X509v3 extensions:
            X509v3 Subject Key Identifier:
1D:F1:20:89:44:D7:7B:5F:1D:9D:CB:51:EE:24:4A:52:3F:3E:F5:DE
            X509v3 Authority Key Identifier:
                  keyid:
1D:F1:20:89:44:D7:7B:5F:1D:9D:CB:51:EE:24:4A:52:3F:3E:F5:DE

            X509v3 Basic Constraints: critical
                CA:TRUE
            X509v3 Key Usage: critical
                Certificate Sign, CRL Sign
            X509v3 Subject Alternative Name:
                email:certify@example.com
    Signature Algorithm: ecdsa-with-SHA256
         30:45:02:20:2b:89:1d:d4:11:d0:7a:6d:6f:62:19:47:63:5b:
         a4:c4:31:65:29:6b:3f:63:37:26:f0:2e:51:ec:f4:64:bd:40:
         02:21:00:b4:be:8a:80:d0:86:75:f0:41:fb:c7:19:ac:f3:b3:
         9d:ed:c8:5d:c9:2b:30:35:86:8c:b2:da:a8:f0:5d:b1:96
</pre><a class="pilcrow" href="#appendix-C.1-2">¶</a>
</div>
</section>
</div>
<div id="enrolldis">
<section id="appendix-C.2">
        <h3 id="name-enroll-reenroll-3">
<a class="section-number selfRef" href="#appendix-C.2">C.2. </a><a class="section-name selfRef" href="#name-enroll-reenroll-3">enroll / reenroll</a>
        </h3>
<p id="appendix-C.2-1">The enrollment request is presented in plain text in the
        following:<a class="pilcrow" href="#appendix-C.2-1">¶</a></p>
<div id="appendix-C.2-2">
<pre class="lang-asn.1 sourcecode">Certificate Request:
    Data:
        Version: 0 (0x0)
        Subject: C=US, ST=CA, L=LA, O=example Inc,
                    OU=IoT/serialNumber=Wt1234
        Subject Public Key Info:
            Public Key Algorithm: id-ecPublicKey
                Public-Key: (256 bit)
                pub:
                    04:c8:b4:21:f1:1c:25:e4:7e:3a:c5:71:23:bf:2d:
                    9f:dc:49:4f:02:8b:c3:51:cc:80:c0:3f:15:0b:f5:
                    0c:ff:95:8d:75:41:9d:81:a6:a2:45:df:fa:e7:90:
                    be:95:cf:75:f6:02:f9:15:26:18:f8:16:a2:b2:3b:
                    56:38:e5:9f:d9
                ASN1 OID: prime256v1
                NIST CURVE: P-256
        Attributes:
            challengePassword:   &lt;256-bit POP linking value&gt;
        Requested Extensions:
            X509v3 Subject Alternative Name:
                othername:&lt;unsupported&gt;
    Signature Algorithm: ecdsa-with-SHA256
         30:45:02:21:00:92:56:3a:54:64:63:bd:9e:cf:f1:70:d0:fd:
         1f:2e:f0:d3:d0:12:16:0e:5e:e9:0c:ff:ed:ab:ec:9b:9a:38:
         92:02:20:17:9f:10:a3:43:61:09:05:1a:ba:d1:75:90:a0:9b:
         c8:7c:4d:ce:54:53:a6:fc:11:35:a1:e8:4e:ed:75:43:77
</pre><a class="pilcrow" href="#appendix-C.2-2">¶</a>
</div>
<p id="appendix-C.2-3">The CSR contains a challengePassword, which is used for POP linking
        (<a class="xref" href="#profile7925">Section 3</a>). The CSR also contains
        an id-on-hardwareModuleName hardware identifier to customize the
        returned certificate to the requesting device (See <span>[<a class="xref" href="#RFC7299">RFC7299</a>]</span> and <span>[<a class="xref" href="#I-D.moskowitz-ecdsa-pki">PKI-GUIDE</a>]</span>).<a class="pilcrow" href="#appendix-C.2-3">¶</a></p>
<p id="appendix-C.2-4">The issued certificate presented in plain text in the following:<a class="pilcrow" href="#appendix-C.2-4">¶</a></p>
<div id="appendix-C.2-5">
<pre class="lang-asn.1 sourcecode">Certificate:
    Data:
        Version: 3 (0x2)
        Serial Number: 9112578475118446130 (0x7e7661d7b54e4632)
    Signature Algorithm: ecdsa-with-SHA256
        Issuer: C=US, ST=CA, O=Example Inc,
                      OU=certification, CN=802.1AR CA
        Validity
            Not Before: Jan 31 11:29:16 2019 GMT
            Not After : Dec 31 23:59:59 9999 GMT
        Subject: C=US, ST=CA, L=LA, O=example Inc,
                OU=IoT/serialNumber=Wt1234
        Subject Public Key Info:
            Public Key Algorithm: id-ecPublicKey
                Public-Key: (256 bit)
                pub:
                    04:c8:b4:21:f1:1c:25:e4:7e:3a:c5:71:23:bf:2d:
                    9f:dc:49:4f:02:8b:c3:51:cc:80:c0:3f:15:0b:f5:
                    0c:ff:95:8d:75:41:9d:81:a6:a2:45:df:fa:e7:90:
                    be:95:cf:75:f6:02:f9:15:26:18:f8:16:a2:b2:3b:
                    56:38:e5:9f:d9
                ASN1 OID: prime256v1
                NIST CURVE: P-256
        X509v3 extensions:
            X509v3 Basic Constraints:
                CA:FALSE
            X509v3 Subject Key Identifier:
96:60:0D:87:16:BF:7F:D0:E7:52:D0:AC:76:07:77:AD:66:5D:02:A0
            X509v3 Authority Key Identifier:
                keyid:
68:D1:65:51:F9:51:BF:C8:2A:43:1D:0D:9F:08:BC:2D:20:5B:11:60

            X509v3 Key Usage: critical
                Digital Signature, Key Encipherment
            X509v3 Subject Alternative Name:
                othername:&lt;unsupported&gt;
    Signature Algorithm: ecdsa-with-SHA256
         30:46:02:21:00:c0:d8:19:96:d2:50:7d:69:3f:3c:48:ea:a5:
         ee:94:91:bd:a6:db:21:40:99:d9:81:17:c6:3b:36:13:74:cd:
         86:02:21:00:a7:74:98:9f:4c:32:1a:5c:f2:5d:83:2a:4d:33:
         6a:08:ad:67:df:20:f1:50:64:21:18:8a:0a:de:6d:34:92:36
</pre><a class="pilcrow" href="#appendix-C.2-5">¶</a>
</div>
</section>
</div>
<div id="disskgrequest">
<section id="appendix-C.3">
        <h3 id="name-serverkeygen-2">
<a class="section-number selfRef" href="#appendix-C.3">C.3. </a><a class="section-name selfRef" href="#name-serverkeygen-2">serverkeygen</a>
        </h3>
<p id="appendix-C.3-1">The following is the server-side key generation request presented in plain text:<a class="pilcrow" href="#appendix-C.3-1">¶</a></p>
<div id="appendix-C.3-2">
<pre class="lang-asn.1 sourcecode">Certificate Request:
    Data:
        Version: 0 (0x0)
        Subject: O=skg example
        Subject Public Key Info:
            Public Key Algorithm: id-ecPublicKey
                Public-Key: (256 bit)
                pub:
                    04:c8:b4:21:f1:1c:25:e4:7e:3a:c5:71:23:bf:2d:
                    9f:dc:49:4f:02:8b:c3:51:cc:80:c0:3f:15:0b:f5:
                    0c:ff:95:8d:75:41:9d:81:a6:a2:45:df:fa:e7:90:
                    be:95:cf:75:f6:02:f9:15:26:18:f8:16:a2:b2:3b:
                    56:38:e5:9f:d9
                ASN1 OID: prime256v1
                NIST CURVE: P-256
        Attributes:
            a0:00
    Signature Algorithm: ecdsa-with-SHA256
         30:45:02:20:7c:55:39:81:b1:fe:34:92:49:d8:a3:f5:0a:03:
         46:33:6b:7d:fa:a0:99:cf:74:e1:ec:7a:37:a0:a7:60:48:59:
         02:21:00:84:79:29:53:98:77:4b:2f:f8:e7:e8:2a:bb:0c:17:
         ea:ef:34:4a:50:88:fa:69:fd:63:ee:61:18:50:c3:4b:0a
</pre><a class="pilcrow" href="#appendix-C.3-2">¶</a>
</div>
<p id="appendix-C.3-3">The following is the private key content of the server-side key
        generation response presented in plain text:<a class="pilcrow" href="#appendix-C.3-3">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.3-4">
<pre>Private-Key: (256 bit)
priv:
    61:33:6a:86:ac:6e:7a:f4:a9:6f:63:28:30:ad:4e:
    6a:a0:83:76:79:20:60:94:d7:67:9a:01:ca:8c:6f:
    0c:37
pub:
    04:c8:b4:21:f1:1c:25:e4:7e:3a:c5:71:23:bf:2d:
    9f:dc:49:4f:02:8b:c3:51:cc:80:c0:3f:15:0b:f5:
    0c:ff:95:8d:75:41:9d:81:a6:a2:45:df:fa:e7:90:
    be:95:cf:75:f6:02:f9:15:26:18:f8:16:a2:b2:3b:
    56:38:e5:9f:d9
ASN1 OID: prime256v1
NIST CURVE: P-256
</pre><a class="pilcrow" href="#appendix-C.3-4">¶</a>
</div>
<p id="appendix-C.3-5">The following is the certificate in the server-side key generation
        response payload presented in plain text:<a class="pilcrow" href="#appendix-C.3-5">¶</a></p>
<div id="appendix-C.3-6">
<pre class="lang-asn.1 sourcecode">Certificate:
    Data:
        Version: 3 (0x2)
        Serial Number:
            b3:31:3e:8f:3f:c9:53:8e
    Signature Algorithm: ecdsa-with-SHA256
        Issuer: O=skg example
        Validity
            Not Before: Sep  4 07:44:03 2019 GMT
            Not After : Aug 30 07:44:03 2039 GMT
        Subject: O=skg example
        Subject Public Key Info:
            Public Key Algorithm: id-ecPublicKey
                Public-Key: (256 bit)
                pub:
                    04:c8:b4:21:f1:1c:25:e4:7e:3a:c5:71:23:bf:2d:
                    9f:dc:49:4f:02:8b:c3:51:cc:80:c0:3f:15:0b:f5:
                    0c:ff:95:8d:75:41:9d:81:a6:a2:45:df:fa:e7:90:
                    be:95:cf:75:f6:02:f9:15:26:18:f8:16:a2:b2:3b:
                    56:38:e5:9f:d9
                ASN1 OID: prime256v1
                NIST CURVE: P-256
        X509v3 extensions:
            X509v3 Basic Constraints:
                CA:FALSE
            Netscape Comment:
                OpenSSL Generated Certificate
            X509v3 Subject Key Identifier:
96:60:0D:87:16:BF:7F:D0:E7:52:D0:AC:76:07:77:AD:66:5D:02:A0
            X509v3 Authority Key Identifier:
                keyid:
96:60:0D:87:16:BF:7F:D0:E7:52:D0:AC:76:07:77:AD:66:5D:02:A0

    Signature Algorithm: ecdsa-with-SHA256
         30:45:02:21:00:e9:5b:fa:25:a0:89:76:65:22:46:f2:d9:61:
         43:da:39:fc:e0:dc:4c:9b:26:b9:cc:e1:f2:41:64:cc:2b:12:
         b6:02:20:13:51:fd:8e:ea:65:76:4e:34:59:d3:24:e4:34:5f:
         f5:b2:a9:15:38:c0:49:76:11:17:96:b3:69:8b:f6:37:9c
</pre><a class="pilcrow" href="#appendix-C.3-6">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="ack">
<section id="appendix-D">
      <h2 id="name-acknowledgements">
<a class="section-name selfRef" href="#name-acknowledgements">Acknowledgements</a>
      </h2>
<p id="appendix-D-1">The authors are very grateful to <span class="contact-name">Klaus Hartke</span>
      for his detailed explanations on the use of Block with DTLS and his
      support for the Content-Format specification.  The authors would like to
      thank <span class="contact-name">Esko Dijk</span> and <span class="contact-name">Michael       Verschoor</span> for the valuable discussions that helped in shaping the
      solution. They would also like to thank <span class="contact-name">Peter       Panburana</span> for his feedback on technical details of the
      solution. Constructive comments were received from <span class="contact-name">Benjamin Kaduk</span>, <span class="contact-name">Eliot Lear</span>, <span class="contact-name">Jim Schaad</span>, <span class="contact-name">Hannes Tschofenig</span>,
      <span class="contact-name">Julien Vermillard</span>, <span class="contact-name">John       Manuel</span>, <span class="contact-name">Oliver Pfaff</span>, <span class="contact-name">Pete       Beal</span>, and <span class="contact-name">Carsten Bormann</span>.<a class="pilcrow" href="#appendix-D-1">¶</a></p>
<p id="appendix-D-2">Interop tests were done by <span class="contact-name">Oliver Pfaff</span>,
      <span class="contact-name">Thomas Werner</span>, <span class="contact-name">Oskar Camezind</span>,
 <span class="contact-name">Bjorn Elmers</span>, and <span class="contact-name">Joel Hoglund</span>.<a class="pilcrow" href="#appendix-D-2">¶</a></p>
<p id="appendix-D-3"><span class="contact-name">Robert Moskowitz</span> provided code to create the examples.<a class="pilcrow" href="#appendix-D-3">¶</a></p>
</section>
</div>
<div id="contrib">
<section id="appendix-E">
      <h2 id="name-contributors">
<a class="section-name selfRef" href="#name-contributors">Contributors</a>
      </h2>
<p id="appendix-E-1"><span class="contact-name">Martin Furuhed</span> contributed to the EST-coaps
    specification by providing feedback based on the Nexus EST-over-CoAPS
    server implementation that started in 2015.  <span class="contact-name">Sandeep     Kumar</span> kick-started this specification and was instrumental in drawing
    attention to the importance of the subject.<a class="pilcrow" href="#appendix-E-1">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-F">
      <h2 id="name-authors-addresses">
<a class="section-name selfRef" href="#name-authors-addresses">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Peter van der Stok</span></div>
<div class="left" dir="auto"><span class="org">Consultant</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:stokcons@bbhmail.nl">stokcons@bbhmail.nl</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Panos Kampanakis</span></div>
<div class="left" dir="auto"><span class="org">Cisco Systems</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:pkampana@cisco.com">pkampana@cisco.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Michael C. Richardson</span></div>
<div class="left" dir="auto"><span class="org">Sandelman Software Works</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:mcr+ietf@sandelman.ca">mcr+ietf@sandelman.ca</a>
</div>
<div class="url">
<span>URI:</span>
<a class="url" href="https://www.sandelman.ca/">https://www.sandelman.ca/</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Shahid Raza</span></div>
<div class="left" dir="auto"><span class="org">RISE Research Institutes of Sweden</span></div>
<div class="left" dir="auto"><span class="street-address">Isafjordsgatan 22</span></div>
<div class="left" dir="auto">SE-<span class="postal-code">16440</span> <span class="locality">Kista, Stockholm</span>
</div>
<div class="left" dir="auto"><span class="country-name">Sweden</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:shahid.raza@ri.se">shahid.raza@ri.se</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>


</body></html>