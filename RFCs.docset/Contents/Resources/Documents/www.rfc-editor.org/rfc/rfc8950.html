<!DOCTYPE html>
<html class="RFC" lang="en"><head>
<meta charset="utf-8"/>
<meta content="Common,Latin" name="scripts"/>
<meta content="initial-scale=1.0" name="viewport"/>
<title>RFC 8950: Advertising IPv4 Network Layer Reachability Information (NLRI) with an IPv6 Next Hop</title>
<meta content="Stephane Litkowski" name="author"/>
<meta content="Swadesh Agrawal" name="author"/>
<meta content="Krishna Muddenahally Ananthamurthy" name="author"/>
<meta content="Keyur Patel" name="author"/>
<meta content="
       
    Multiprotocol BGP (MP-BGP) specifies that the set of usable next-hop address families
   is determined by the Address Family Identifier (AFI) and the
   Subsequent Address Family Identifier (SAFI).  The AFI/SAFI
   definitions for the IPv4 address family only have provisions for
   advertising a next-hop address that belongs to the IPv4 protocol when
   advertising IPv4 Network Layer Reachability Information (NLRI) or
   VPN-IPv4 NLRI.  
       
       
   This document specifies the extensions necessary to
   allow the advertising of IPv4 NLRI or VPN-IPv4 NLRI with a next-hop address
   that belongs to the IPv6 protocol.  This comprises an extension of
   the AFI/SAFI definitions to allow the address of the next hop for
   IPv4 NLRI or VPN-IPv4 NLRI to also belong to the IPv6 protocol, the
   encoding of the next hop to determine which of the protocols
   the address actually belongs to, and a BGP Capability allowing
   MP-BGP peers to dynamically discover whether they can exchange IPv4
   NLRI and VPN-IPv4 NLRI with an IPv6 next hop. This document obsoletes RFC 5549.
       
    " name="description"/>
<meta content="xml2rfc 3.5.0" name="generator"/>
<meta content="bgp" name="keyword"/>
<meta content="mvpn" name="keyword"/>
<meta content="vpnv4" name="keyword"/>
<meta content="vpnv6" name="keyword"/>
<meta content="8950" name="rfc.number"/>
<!-- Generator version information:
  xml2rfc 3.5.0
    Python 3.6.10
    appdirs 1.4.4
    ConfigArgParse 1.2.3
    google-i18n-address 2.3.5
    html5lib 1.0.1
    intervaltree 3.0.2
    Jinja2 2.11.2
    kitchen 1.2.6
    lxml 4.4.2
    pycairo 1.19.0
    pycountry 19.8.18
    pyflakes 2.1.1
    PyYAML 5.3.1
    requests 2.22.0
    setuptools 40.6.2
    six 1.14.0
    WeasyPrint 51
-->
<link href="rfc8950.xml" rel="alternate" type="application/rfc+xml"/>
<link href="#copyright" rel="license"/>
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css"/>
<link href="https://dx.doi.org/10.17487/rfc8950" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <link href="https://datatracker.ietf.org/doc/draft-ietf-bess-rfc5549revision-06" rel="prev"/>
  </head>
<body>
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 8950</td>
<td class="center">Advertising IPv4 Reachability with IPv6</td>
<td class="right">November 2020</td>
</tr></thead>
<tfoot><tr>
<td class="left">Litkowski, et al.</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div class="document-information" id="external-metadata"></div>
<div class="document-information" id="internal-metadata">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a class="eref" href="https://www.rfc-editor.org/rfc/rfc8950">8950</a></dd>
<dt class="label-obsoletes">Obsoletes:</dt>
<dd class="obsoletes">
<a class="eref" href="https://www.rfc-editor.org/rfc/rfc5549">5549</a> </dd>
<dt class="label-category">Category:</dt>
<dd class="category">Standards Track</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time class="published" datetime="2020-11">November 2020</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">S. Litkowski</div>
<div class="org">Cisco</div>
</div>
<div class="author">
      <div class="author-name">S. Agrawal</div>
<div class="org">Cisco</div>
</div>
<div class="author">
      <div class="author-name">K. Ananthamurthy</div>
<div class="org">Cisco</div>
</div>
<div class="author">
      <div class="author-name">K. Patel</div>
<div class="org">Arrcus</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 8950</h1>
<h1 id="title">Advertising IPv4 Network Layer Reachability Information (NLRI) with an IPv6 Next Hop</h1>
<section id="section-abstract">
      <h2 id="abstract"><a class="selfRef" href="#abstract">Abstract</a></h2>
<p id="section-abstract-1">
    Multiprotocol BGP (MP-BGP) specifies that the set of usable next-hop address families
   is determined by the Address Family Identifier (AFI) and the
   Subsequent Address Family Identifier (SAFI).  The AFI/SAFI
   definitions for the IPv4 address family only have provisions for
   advertising a next-hop address that belongs to the IPv4 protocol when
   advertising IPv4 Network Layer Reachability Information (NLRI) or
   VPN-IPv4 NLRI.<a class="pilcrow" href="#section-abstract-1">¶</a></p>
<p id="section-abstract-2">
   This document specifies the extensions necessary to
   allow the advertising of IPv4 NLRI or VPN-IPv4 NLRI with a next-hop address
   that belongs to the IPv6 protocol.  This comprises an extension of
   the AFI/SAFI definitions to allow the address of the next hop for
   IPv4 NLRI or VPN-IPv4 NLRI to also belong to the IPv6 protocol, the
   encoding of the next hop to determine which of the protocols
   the address actually belongs to, and a BGP Capability allowing
   MP-BGP peers to dynamically discover whether they can exchange IPv4
   NLRI and VPN-IPv4 NLRI with an IPv6 next hop. This document obsoletes RFC 5549.<a class="pilcrow" href="#section-abstract-2">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a class="section-name selfRef" href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This is an Internet Standards Track document.<a class="pilcrow" href="#section-boilerplate.1-1">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.<a class="pilcrow" href="#section-boilerplate.1-2">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc8950">https://www.rfc-editor.org/info/rfc8950</a></span>.<a class="pilcrow" href="#section-boilerplate.1-3">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a class="section-name selfRef" href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2020 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a class="pilcrow" href="#section-boilerplate.2-1">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a class="pilcrow" href="#section-boilerplate.2-2">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a class="toplink" href="#" onclick="scroll(0,0)">▲</a><h2 id="name-table-of-contents">
<a class="section-name selfRef" href="#name-table-of-contents">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.1">
            <p class="keepWithNext" id="section-toc.1-1.1.1"><a class="xref" href="#section-1">1</a>.  <a class="xref" href="#name-introduction">Introduction</a><a class="pilcrow" href="#section-toc.1-1.1.1">¶</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.1.2.1">
                <p class="keepWithNext" id="section-toc.1-1.1.2.1.1"><a class="xref" href="#section-1.1">1.1</a>.  <a class="xref" href="#name-requirements-language">Requirements Language</a><a class="pilcrow" href="#section-toc.1-1.1.2.1.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.2">
            <p class="keepWithNext" id="section-toc.1-1.2.1"><a class="xref" href="#section-2">2</a>.  <a class="xref" href="#name-changes-compared-to-rfc-554">Changes Compared to RFC 5549</a><a class="pilcrow" href="#section-toc.1-1.2.1">¶</a></p>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a class="xref" href="#section-3">3</a>.  <a class="xref" href="#name-extension-of-afi-safi-defin">Extension of AFI/SAFI Definitions for the IPv4 Address Family</a><a class="pilcrow" href="#section-toc.1-1.3.1">¶</a></p>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a class="xref" href="#section-4">4</a>.  <a class="xref" href="#name-use-of-bgp-capability-adver">Use of BGP Capability Advertisement</a><a class="pilcrow" href="#section-toc.1-1.4.1">¶</a></p>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a class="xref" href="#section-5">5</a>.  <a class="xref" href="#name-operations">Operations</a><a class="pilcrow" href="#section-toc.1-1.5.1">¶</a></p>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a class="xref" href="#section-6">6</a>.  <a class="xref" href="#name-usage-examples">Usage Examples</a><a class="pilcrow" href="#section-toc.1-1.6.1">¶</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a class="xref" href="#section-6.1">6.1</a>.  <a class="xref" href="#name-ipv4-over-ipv6-core">IPv4 over IPv6 Core</a><a class="pilcrow" href="#section-toc.1-1.6.2.1.1">¶</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a class="xref" href="#section-6.2">6.2</a>.  <a class="xref" href="#name-ipv4-vpn-unicast-over-ipv6-">IPv4 VPN Unicast over IPv6 Core</a><a class="pilcrow" href="#section-toc.1-1.6.2.2.1">¶</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a class="xref" href="#section-6.3">6.3</a>.  <a class="xref" href="#name-ipv4-vpn-multicast-over-ipv">IPv4 VPN Multicast over IPv6 Core</a><a class="pilcrow" href="#section-toc.1-1.6.2.3.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a class="xref" href="#section-7">7</a>.  <a class="xref" href="#name-iana-considerations">IANA Considerations</a><a class="pilcrow" href="#section-toc.1-1.7.1">¶</a></p>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a class="xref" href="#section-8">8</a>.  <a class="xref" href="#name-security-considerations">Security Considerations</a><a class="pilcrow" href="#section-toc.1-1.8.1">¶</a></p>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a class="xref" href="#section-9">9</a>.  <a class="xref" href="#name-references">References</a><a class="pilcrow" href="#section-toc.1-1.9.1">¶</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a class="xref" href="#section-9.1">9.1</a>.  <a class="xref" href="#name-normative-references">Normative References</a><a class="pilcrow" href="#section-toc.1-1.9.2.1.1">¶</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a class="xref" href="#section-9.2">9.2</a>.  <a class="xref" href="#name-informative-references">Informative References</a><a class="pilcrow" href="#section-toc.1-1.9.2.2.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a class="xref" href="#section-appendix.a"></a><a class="xref" href="#name-acknowledgments">Acknowledgments</a><a class="pilcrow" href="#section-toc.1-1.10.1">¶</a></p>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a class="xref" href="#section-appendix.b"></a><a class="xref" href="#name-authors-addresses">Authors' Addresses</a><a class="pilcrow" href="#section-toc.1-1.11.1">¶</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="intro">
<section id="section-1">
      <h2 id="name-introduction">
<a class="section-number selfRef" href="#section-1">1. </a><a class="section-name selfRef" href="#name-introduction">Introduction</a>
      </h2>
<p id="section-1-1">
 Multiprotocol BGP (MP-BGP) <span>[<a class="xref" href="#RFC4760">RFC4760</a>]</span> specifies that the set of
   network-layer protocols to which the address carried in the Next Hop
   Address field may belong is determined by the Address Family Identifier (AFI)
   and the Subsequent Address Family Identifier (SAFI).  A number of
   existing AFIs/SAFIs allow the next-hop address to belong to a
   different address family than the Network Layer Reachability
   Information (NLRI).  For example, the AFI/SAFI &lt;25/65&gt; used (as per
   <span>[<a class="xref" href="#RFC6074">RFC6074</a>]</span>) to perform Layer 2 Virtual
   Private Network (L2VPN) auto-discovery allows advertising NLRI that contains the identifier of a Virtual Private
   LAN Service (VPLS) instance or that identifies a particular pool of
   attachment circuits at a given Provider Edge (PE), while the Next Hop
   Address field contains the loopback address of a PE.  Similarly, the AFI/SAFI
   &lt;1/132&gt; (defined in <span>[<a class="xref" href="#RFC4684">RFC4684</a>]</span>) to advertise Route Target
   (RT) membership information allows advertising NLRI that contains
   such RT membership information, while the Next Hop Address field contains the
   address of the advertising router.<a class="pilcrow" href="#section-1-1">¶</a></p>
<p id="section-1-2">
   Furthermore, a number of these existing AFIs/SAFIs allow the next hop
   to belong to either the IPv4 protocol or the IPv6
   protocol and specify the encoding of the next-hop
   information to determine which of the protocols the address
   actually belongs to.

   For example, <span>[<a class="xref" href="#RFC4684">RFC4684</a>]</span> allows the next-hop
   address to be either an IPv4 or IPv6 address and states that the
   Next Hop Address field shall be interpreted as an IPv4 address whenever the length
   of the next-hop address is 4 octets and as an IPv6 address whenever the
   length of the next-hop address is 16 octets.<a class="pilcrow" href="#section-1-2">¶</a></p>
<p id="section-1-3">
   There are situations such as those described in <span>[<a class="xref" href="#RFC4925">RFC4925</a>]</span> and <span>[<a class="xref" href="#RFC5565">RFC5565</a>]</span> where carriers (or large
   enterprise networks acting as a
   carrier for their internal resources) may be required to establish
   connectivity between 'islands' of networks of one address family type
   across a transit core of a differing address family type.  This
   includes both the case of IPv6 islands across an IPv4 core and the
   case of IPv4 islands across an IPv6 core.  Where Multiprotocol BGP
   (MP-BGP) is used to advertise the corresponding reachability
   information, this translates into the requirement for a BGP speaker
   to advertise the NLRI of a given
   address family via a next hop of a different address family (i.e.,
   IPv6 NLRI with an IPv4 next hop and IPv4 NLRI with an IPv6 next hop).<a class="pilcrow" href="#section-1-3">¶</a></p>
<p id="section-1-4">
   The AFI/SAFI definitions for the IPv6 address family assume
   that the next-hop address belongs to the IPv6 address family type.
   Specifically, as per <span>[<a class="xref" href="#RFC2545">RFC2545</a>]</span> and <span>[<a class="xref" href="#RFC8277">RFC8277</a>]</span>, when the &lt;AFI/SAFI&gt; is
   &lt;2/1&gt;, &lt;2/2&gt;, or &lt;2/4&gt;, the next-hop address is assumed
   to be of an IPv6
   type.  As per <span>[<a class="xref" href="#RFC4659">RFC4659</a>]</span>, when the &lt;AFI/SAFI&gt; is &lt;2/128&gt;, the next-hop
   address is assumed to be of a VPN-IPv6 type.<a class="pilcrow" href="#section-1-4">¶</a></p>
<p id="section-1-5">
   However, <span>[<a class="xref" href="#RFC4798">RFC4798</a>]</span> and <span>[<a class="xref" href="#RFC4659">RFC4659</a>]</span>
   specify how an IPv4 address can be
   encoded inside the next-hop IPv6 address field when IPv6 NLRI needs
   to be advertised with an IPv4 next hop.  <span>[<a class="xref" href="#RFC4798">RFC4798</a>]</span> defines how the
   IPv4-mapped IPv6 address format specified in the IPv6 addressing
   architecture (<span>[<a class="xref" href="#RFC4291">RFC4291</a>]</span>) can be
   used for that purpose when the &lt;AFI/SAFI&gt; is &lt;2/1&gt;,
   &lt;2/2&gt;, or &lt;2/4&gt;.  <span>[<a class="xref" href="#RFC4659">RFC4659</a>]</span> defines how the IPv4-mapped IPv6 address format
   as well as a null Route Distinguisher (RD) can
   be used for that purpose when the &lt;AFI/SAFI&gt; is &lt;2/128&gt;.  Thus, there
   are existing solutions for the advertisement of IPv6 NLRI with an
   IPv4 next hop.<a class="pilcrow" href="#section-1-5">¶</a></p>
<p id="section-1-6">
   Similarly, the AFI/SAFI definitions for the advertisement of IPv4
   NLRI or VPN-IPv4 NLRI assume that the next-hop address belongs to the
   IPv4 address family type.  Specifically, as per <span>[<a class="xref" href="#RFC4760">RFC4760</a>]</span> and
   <span>[<a class="xref" href="#RFC8277">RFC8277</a>]</span>, when the &lt;AFI/SAFI&gt; is &lt;1/1&gt;, &lt;1/2&gt;, or &lt;1/4&gt;, the next-hop address is assumed to be of an IPv4 type.  As per <span>[<a class="xref" href="#RFC4364">RFC4364</a>]</span>, when
   the &lt;AFI/SAFI&gt; is &lt;1/128&gt;, the next-hop address is assumed to
   be of a VPN-IPv4 type.  As per <span>[<a class="xref" href="#RFC6513">RFC6513</a>]</span> and <span>[<a class="xref" href="#RFC6514">RFC6514</a>]</span>, when
   the &lt;AFI/SAFI&gt; is &lt;1/129&gt;, the next-hop address is assumed to
   be of a VPN-IPv4 type. There is clearly no generally applicable method for
   encoding an IPv6 address inside the IPv4 address field of the next
   hop.  Hence, there is currently no specified solution for advertising
   IPv4 or VPN-IPv4 NLRI with an IPv6 next hop.<a class="pilcrow" href="#section-1-6">¶</a></p>
<p id="section-1-7">
   This document specifies the extensions necessary to
   allow advertisement of IPv4 NLRI or VPN-IPv4 NLRI with a next-hop address
   that belongs to the IPv6 protocol. This
   comprises an extension of the AFI/SAFI definitions to allow the
   address of the next hop for IPv4 NLRI or VPN-IPv4 NLRI to belong to
   either the IPv4 or the IPv6 protocol, the encoding of the next-hop
   information to determine which of the protocols the address
   actually belongs to, and a BGP Capability allowing MP-BGP peers
   to dynamically discover whether they can exchange IPv4 NLRI and VPN-IPv4 NLRI with an IPv6 next hop.  The BGP Capability allows
   gradual deployment of the functionality of advertising IPv4
   reachability via an IPv6 next hop without any flag day nor any risk
   of traffic black-holing.<a class="pilcrow" href="#section-1-7">¶</a></p>
<p id="section-1-8">This document obsoletes <span>[<a class="xref" href="#RFC5549">RFC5549</a>]</span>.<a class="pilcrow" href="#section-1-8">¶</a></p>
<div id="requirements">
<section id="section-1.1">
        <h3 id="name-requirements-language">
<a class="section-number selfRef" href="#section-1.1">1.1. </a><a class="section-name selfRef" href="#name-requirements-language">Requirements Language</a>
        </h3>
<p id="section-1.1-1">
    The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
    "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
    described in BCP 14 <span>[<a class="xref" href="#RFC2119">RFC2119</a>]</span> <span>[<a class="xref" href="#RFC8174">RFC8174</a>]</span> 
    when, and only when, they appear in all capitals, as shown here.<a class="pilcrow" href="#section-1.1-1">¶</a></p>
</section>
</div>
</section>
</div>
<div id="diff">
<section id="section-2">
      <h2 id="name-changes-compared-to-rfc-554">
<a class="section-number selfRef" href="#section-2">2. </a><a class="section-name selfRef" href="#name-changes-compared-to-rfc-554">Changes Compared to RFC 5549</a>
      </h2>
<p id="section-2-1">This document introduces two significant changes compared to <span>[<a class="xref" href="#RFC5549">RFC5549</a>]</span>:<a class="pilcrow" href="#section-2-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-2.1">In <span>[<a class="xref" href="#RFC5549">RFC5549</a>]</span>, when AFI/SAFI &lt;1/128&gt;
 is used, the next-hop address is encoded as an IPv6 address with a
 length of 16 or 32 bytes. To accommodate all existing implementations
 and bring consistency with VPNv4oIPv4 and VPNv6oIPv6, this document
 modifies how the next-hop address is encoded. The next-hop address is
 now encoded as a VPN-IPv6 address with a length of 24 or 48 bytes
 (see Sections <a class="xref" href="#extension">3</a> and <a class="xref" href="#example-vpnv4unoipv6">6.2</a>). This change
 addresses Erratum ID 5253 (<span>[<a class="xref" href="#Err5253">Err5253</a>]</span>).
 As all known and deployed implementations are interoperable today and use the new proposed encoding, the change does not break existing interoperability.<a class="pilcrow" href="#section-2-2.1">¶</a>
</li>
        <li class="normal" id="section-2-2.2">This document allows AFI/SAFI &lt;1/129&gt; (IPv4 multicast) to use an
 IPv6 underlay using similar encoding and procedures to AFI/SAFI
 &lt;1/128&gt; (see Sections <a class="xref" href="#extension">3</a> and <a class="xref" href="#example-vpnv4multoipv6">6.3</a>).<a class="pilcrow" href="#section-2-2.2">¶</a>
</li>
      </ul>
</section>
</div>
<div id="extension">
<section id="section-3">
      <h2 id="name-extension-of-afi-safi-defin">
<a class="section-number selfRef" href="#section-3">3. </a><a class="section-name selfRef" href="#name-extension-of-afi-safi-defin">Extension of AFI/SAFI Definitions for the IPv4 Address Family</a>
      </h2>
<p id="section-3-1">
 As mentioned earlier, MP-BGP specifies that the set of usable next-hop address families 
 is determined by the AFI and the SAFI.  The following 
   AFI/SAFI definitions for the IPv4 NLRI or VPN-IPv4 NLRI (&lt;1/1&gt;,
   &lt;1/2&gt;, &lt;1/4&gt;, &lt;1/128&gt;, and &lt;1/129&gt;) only have provisions for advertising a
   next-hop address that belongs to the IPv4 protocol.

   This document
   extends the set of usable next-hop address families to include IPv6 in addition to
   IPv4 when advertising an IPv4 or VPN-IPv4 NLRI.<a class="pilcrow" href="#section-3-1">¶</a></p>
<p id="section-3-2">
 Specifically, this document allows advertising the MP_REACH_NLRI attribute <span>[<a class="xref" href="#RFC4760">RFC4760</a>]</span> with this content:<a class="pilcrow" href="#section-3-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-3.1">AFI = 1<a class="pilcrow" href="#section-3-3.1">¶</a>
</li>
        <li class="normal" id="section-3-3.2">SAFI = 1, 2, or 4<a class="pilcrow" href="#section-3-3.2">¶</a>
</li>
        <li class="normal" id="section-3-3.3">Length of Next Hop Address = 16 or 32<a class="pilcrow" href="#section-3-3.3">¶</a>
</li>
        <li class="normal" id="section-3-3.4">Next Hop Address = IPv6 address of a next hop (potentially followed
      by the link-local IPv6 address of the next hop).  This field is to
      be constructed as per <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc2545#section-3">Section 3</a> of [<a class="xref" href="#RFC2545">RFC2545</a>]</span>.<a class="pilcrow" href="#section-3-3.4">¶</a>
</li>
        <li class="normal" id="section-3-3.5">NLRI = NLRI as per the AFI/SAFI definition<a class="pilcrow" href="#section-3-3.5">¶</a>
</li>
      </ul>
<p id="section-3-4">
  It also allows advertising the MP_REACH_NLRI attribute <span>[<a class="xref" href="#RFC4760">RFC4760</a>]</span> with this content:<a class="pilcrow" href="#section-3-4">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-5.1">AFI = 1<a class="pilcrow" href="#section-3-5.1">¶</a>
</li>
        <li class="normal" id="section-3-5.2">SAFI = 128 or 129<a class="pilcrow" href="#section-3-5.2">¶</a>
</li>
        <li class="normal" id="section-3-5.3">Length of Next Hop Address = 24 or 48<a class="pilcrow" href="#section-3-5.3">¶</a>
</li>
        <li class="normal" id="section-3-5.4">Next Hop Address = VPN-IPv6 address of a next hop with an 8-octet RD set to zero (potentially followed
      by the link-local VPN-IPv6 address of the next hop with an 8-octet RD set to zero).<a class="pilcrow" href="#section-3-5.4">¶</a>
</li>
        <li class="normal" id="section-3-5.5">NLRI = NLRI as per the AFI/SAFI definition<a class="pilcrow" href="#section-3-5.5">¶</a>
</li>
      </ul>
<p id="section-3-6">
   This is in addition to the existing mode of operation allowing
   advertisement of NLRI for &lt;AFI/SAFI&gt; of &lt;1/1&gt;, &lt;1/2&gt;, and &lt;1/4&gt; with a
   next-hop address of an IPv4 type and advertisement of NLRI for an
   &lt;AFI/SAFI&gt; of &lt;1/128&gt; and &lt;1/129&gt; with a next-hop address
   of a VPN-IPv4 type.<a class="pilcrow" href="#section-3-6">¶</a></p>
<p id="section-3-7">
   The BGP speaker receiving the advertisement <span class="bcp14">MUST</span> use the Length of
   Next Hop Address field to determine which network-layer protocol the
   next-hop address belongs to.<a class="pilcrow" href="#section-3-7">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-8.1">When the AFI/SAFI is &lt;1/1&gt;, &lt;1/2&gt;, or &lt;1/4&gt;
   and when the Length of Next Hop Address
   field is equal to 16 or 32, the next-hop address is of type IPv6.<a class="pilcrow" href="#section-3-8.1">¶</a>
</li>
        <li class="normal" id="section-3-8.2">When the AFI/SAFI is &lt;1/128&gt; or &lt;1/129&gt;
   and when the Length of Next Hop Address
   field is equal to 24 or 48, the next-hop address is of type VPN-IPv6.<a class="pilcrow" href="#section-3-8.2">¶</a>
</li>
      </ul>
<p id="section-3-9">
   Note that this method of using the Length of Next Hop Address
   field to determine which network-layer protocol the next-hop address
   belongs to (out of the set of protocols allowed by the AFI/SAFI
   definition) is the same as that used in <span>[<a class="xref" href="#RFC4684">RFC4684</a>]</span> and <span>[<a class="xref" href="#RFC6074">RFC6074</a>]</span>.<a class="pilcrow" href="#section-3-9">¶</a></p>
</section>
</div>
<div id="bgp-cap">
<section id="section-4">
      <h2 id="name-use-of-bgp-capability-adver">
<a class="section-number selfRef" href="#section-4">4. </a><a class="section-name selfRef" href="#name-use-of-bgp-capability-adver">Use of BGP Capability Advertisement</a>
      </h2>
<p id="section-4-1">
 <span>[<a class="xref" href="#RFC5492">RFC5492</a>]</span> defines a mechanism to allow two BGP speakers to discover
   if a particular capability is supported by their BGP peer and, thus, whether it can be used with that peer.  This document defines a 
   capability that can be advertised using <span>[<a class="xref" href="#RFC5492">RFC5492</a>]</span>, referred to as the "Extended Next Hop Encoding capability".  This
   capability allows BGP speakers to discover whether, for a given NLRI
   &lt;AFI/SAFI&gt;, a peer supports advertisement with a next hop whose
   network protocol is determined by the value of the Length of Next Hop
   Address field, as specified in <a class="xref" href="#extension">Section 3</a>.<a class="pilcrow" href="#section-4-1">¶</a></p>
<p id="section-4-2">
 A BGP speaker that wishes to advertise an IPv6 next hop for IPv4 NLRI
 or for VPN-IPv4 NLRI to a BGP peer as per this specification <span class="bcp14">MUST</span> use
   the Capability Advertisement procedures defined in <span>[<a class="xref" href="#RFC5492">RFC5492</a>]</span> with the
   Extended Next Hop Encoding capability to determine whether its peer
   supports this for the NLRI AFI/SAFI pair(s) of interest.  The fields
   in the Capabilities Optional Parameter <span class="bcp14">MUST</span> be set as follows:<a class="pilcrow" href="#section-4-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-3.1">The Capability Code field <span class="bcp14">MUST</span> be set to 5 (which indicates the
      Extended Next Hop Encoding capability).<a class="pilcrow" href="#section-4-3.1">¶</a>
</li>
        <li class="normal" id="section-4-3.2">The Capability Length field is set to a variable value that is the
      length of the Capability Value field (which follows).<a class="pilcrow" href="#section-4-3.2">¶</a>
</li>
        <li class="normal" id="section-4-3.3">
          <p id="section-4-3.3.1">The Capability Value field has the following format:<a class="pilcrow" href="#section-4-3.3.1">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4-3.3.2">
<pre>
         +-----------------------------------------------------+
         | NLRI AFI - 1 (2 octets)                             |
         +-----------------------------------------------------+
         | NLRI SAFI - 1 (2 octets)                            |
         +-----------------------------------------------------+
         | Nexthop AFI - 1 (2 octets)                          |
         +-----------------------------------------------------+
         | .....                                               |
         +-----------------------------------------------------+
         | NLRI AFI - N (2 octets)                             |
         +-----------------------------------------------------+
         | NLRI SAFI - N (2 octets)                            |
         +-----------------------------------------------------+
         | Nexthop AFI - N (2 octets)                          |
         +-----------------------------------------------------+

</pre><a class="pilcrow" href="#section-4-3.3.2">¶</a>
</div>
<p id="section-4-3.3.3">
    where:<a class="pilcrow" href="#section-4-3.3.3">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-3.3.4.1">each triple &lt;NLRI AFI, NLRI SAFI, Nexthop AFI&gt; indicates
     that the NLRI of &lt;NLRI AFI / NLRI SAFI&gt; may be advertised with a next-hop address belonging to the network-layer protocol of Nexthop
            AFI.<a class="pilcrow" href="#section-4-3.3.4.1">¶</a>
</li>
            <li class="normal" id="section-4-3.3.4.2">the AFI and SAFI values are defined in the "Address
     Family Numbers"
         and "Subsequent Address Family Identifier (SAFI) Parameters" registries
         (see <span>[<a class="xref" href="#IANA-AFI">IANA-AFI</a>]</span> and <span>[<a class="xref" href="#IANA-SAFI">IANA-SAFI</a>]</span>, respectively).<a class="pilcrow" href="#section-4-3.3.4.2">¶</a>
</li>
          </ul>
</li>
      </ul>
<p id="section-4-4">
   Since this document only concerns itself with the advertisement of
   IPv4 NLRI and VPN-IPv4 NLRI with an IPv6 next hop, this specification
   only allows the following values in the Capability Value field of the
   Extended Next Hop Encoding capability:<a class="pilcrow" href="#section-4-4">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-5.1">NLRI AFI = 1 (IPv4)<a class="pilcrow" href="#section-4-5.1">¶</a>
</li>
        <li class="normal" id="section-4-5.2">NLRI SAFI = 1, 2, 4, 128, or 129<a class="pilcrow" href="#section-4-5.2">¶</a>
</li>
        <li class="normal" id="section-4-5.3">Nexthop AFI = 2 (IPv6)<a class="pilcrow" href="#section-4-5.3">¶</a>
</li>
      </ul>
<p id="section-4-6">
   This document does not specify the use of the Extended Next Hop Encoding capability with any other combinations of &lt;NLRI AFI,
   NLRI SAFI, Nexthop AFI&gt;. For example, the Next Hop Encoding capability specified in this document is not intended to be used for
   NLRI AFIs/SAFIs whose definition already allows use of both IPv4 and
   IPv6 next hops (e.g., AFI/SAFI = &lt;1/132&gt; as defined in <span>[<a class="xref" href="#RFC4684">RFC4684</a>]</span>).
   Similarly, it is not intended that the Extended Next Hop Encoding capability be used for NLRI AFIs/SAFIs for which there is already a solution for advertising a next hop of a different address family
   (e.g., AFI/SAFI = &lt;2/1&gt;, &lt;2/2&gt;, or &lt;2/4&gt; with an IPv4 next hop as per
   <span>[<a class="xref" href="#RFC4798">RFC4798</a>]</span> and AFI/SAFI = &lt;2/128&gt; with
   an IPv4 next hop as per
   <span>[<a class="xref" href="#RFC4659">RFC4659</a>]</span>).<a class="pilcrow" href="#section-4-6">¶</a></p>
<p id="section-4-7">
   It is expected that if new AFIs/SAFIs are defined in the future, their
   definitions will have provisions (where appropriate) for both IPv4 and
   IPv6 next hops from the beginning, with the determination based on the Length of
   Next Hop Address field.  Thus, new AFIs/SAFIs are not expected to make
   use of the Extended Next Hop Encoding capability.<a class="pilcrow" href="#section-4-7">¶</a></p>
<p id="section-4-8">
   A BGP speaker <span class="bcp14">MUST</span> only advertise the IPv4 or VPN-IPv4
   NLRI with an IPv6 next hop to a BGP peer if the BGP speaker has first ascertained
   via the BGP Capability Advertisement that the BGP peer supports the
   Extended Next Hop Encoding capability for the relevant AFI/SAFI pair.<a class="pilcrow" href="#section-4-8">¶</a></p>
<p id="section-4-9">
   The Extended Next Hop Encoding capability provides information about
   next-hop encoding for a given AFI/SAFI, assuming that AFI/SAFI is
   allowed.  It does not influence whether that AFI/SAFI is indeed
   allowed.  Whether an AFI/SAFI can be used between the BGP peers is
   purely determined through the Multiprotocol Extensions capability
   defined in <span>[<a class="xref" href="#RFC4760">RFC4760</a>]</span>.<a class="pilcrow" href="#section-4-9">¶</a></p>
</section>
</div>
<div id="operations">
<section id="section-5">
      <h2 id="name-operations">
<a class="section-number selfRef" href="#section-5">5. </a><a class="section-name selfRef" href="#name-operations">Operations</a>
      </h2>
<p id="section-5-1">
 By default, if a particular BGP session is running over IPvx (where
   IPvx is IPv4 or IPv6) and if the BGP speaker sending an update is
   putting its own address in as the next hop, then the next-hop address
   <span class="bcp14">SHOULD</span> be specified as an IPvx address, using the encoding rules
   specified in the AFI/SAFI definition of the NLRI being updated.  This
   default behavior may be overridden by policy.<a class="pilcrow" href="#section-5-1">¶</a></p>
<p id="section-5-2">
   When a next-hop address needs to be passed along unchanged (e.g., as
   a Route Reflector (RR) would do), its encoding <span class="bcp14">MUST NOT</span> be changed.
   If a particular RR client cannot handle that encoding (as determined
   by the BGP Capability Advertisement), then the NLRI in question
   cannot be distributed to that client.  For sound routing in certain
   scenarios, this will require that all the RR clients be able to
   handle whatever encodings any of them may generate.<a class="pilcrow" href="#section-5-2">¶</a></p>
</section>
</div>
<div id="examples">
<section id="section-6">
      <h2 id="name-usage-examples">
<a class="section-number selfRef" href="#section-6">6. </a><a class="section-name selfRef" href="#name-usage-examples">Usage Examples</a>
      </h2>
<div id="example-ipv4oipv6">
<section id="section-6.1">
        <h3 id="name-ipv4-over-ipv6-core">
<a class="section-number selfRef" href="#section-6.1">6.1. </a><a class="section-name selfRef" href="#name-ipv4-over-ipv6-core">IPv4 over IPv6 Core</a>
        </h3>
<p id="section-6.1-1">
 The extensions defined in this document may be used as discussed in
   <span>[<a class="xref" href="#RFC5565">RFC5565</a>]</span> for the interconnection of IPv4 islands over an IPv6
   backbone.  In this application, Address Family Border Routers (AFBRs;
   as defined in <span>[<a class="xref" href="#RFC4925">RFC4925</a>]</span>) advertise IPv4 NLRI in the MP_REACH_NLRI
   along with an IPv6 next hop.<a class="pilcrow" href="#section-6.1-1">¶</a></p>
<p id="section-6.1-2">
   The MP_REACH_NLRI is encoded with:<a class="pilcrow" href="#section-6.1-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1-3.1">AFI = 1<a class="pilcrow" href="#section-6.1-3.1">¶</a>
</li>
          <li class="normal" id="section-6.1-3.2">SAFI = 1<a class="pilcrow" href="#section-6.1-3.2">¶</a>
</li>
          <li class="normal" id="section-6.1-3.3">Length of Next Hop Address field = 16 (or 32)<a class="pilcrow" href="#section-6.1-3.3">¶</a>
</li>
          <li class="normal" id="section-6.1-3.4">Next Hop Address = IPv6 address of the next hop<a class="pilcrow" href="#section-6.1-3.4">¶</a>
</li>
          <li class="normal" id="section-6.1-3.5">NLRI = IPv4 routes<a class="pilcrow" href="#section-6.1-3.5">¶</a>
</li>
        </ul>
<p id="section-6.1-4">
   During BGP Capability Advertisement, the PE routers would include the following fields in the Capabilities Optional Parameter:<a class="pilcrow" href="#section-6.1-4">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1-5.1">Capability Code set to "Extended Next Hop Encoding"<a class="pilcrow" href="#section-6.1-5.1">¶</a>
</li>
          <li class="normal" id="section-6.1-5.2">Capability Value containing &lt;NLRI AFI=1, NLRI SAFI=1, Nexthop
      AFI=2&gt;<a class="pilcrow" href="#section-6.1-5.2">¶</a>
</li>
        </ul>
</section>
</div>
<div id="example-vpnv4unoipv6">
<section id="section-6.2">
        <h3 id="name-ipv4-vpn-unicast-over-ipv6-">
<a class="section-number selfRef" href="#section-6.2">6.2. </a><a class="section-name selfRef" href="#name-ipv4-vpn-unicast-over-ipv6-">IPv4 VPN Unicast over IPv6 Core</a>
        </h3>
<p id="section-6.2-1">
   The extensions defined in this document may be used for support of
   IPv4 VPNs over an IPv6 backbone.  In this application, PE routers
would advertise VPN-IPv4 NLRI in the MP_REACH_NLRI along with an IPv6
   next hop.<a class="pilcrow" href="#section-6.2-1">¶</a></p>
<p id="section-6.2-2">
   The MP_REACH_NLRI is encoded with:<a class="pilcrow" href="#section-6.2-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2-3.1">AFI = 1<a class="pilcrow" href="#section-6.2-3.1">¶</a>
</li>
          <li class="normal" id="section-6.2-3.2">SAFI = 128<a class="pilcrow" href="#section-6.2-3.2">¶</a>
</li>
          <li class="normal" id="section-6.2-3.3">Length of Next Hop Address field = 24 (or 48)<a class="pilcrow" href="#section-6.2-3.3">¶</a>
</li>
          <li class="normal" id="section-6.2-3.4">Next Hop Address = VPN-IPv6 address of a next hop whose RD is set to zero<a class="pilcrow" href="#section-6.2-3.4">¶</a>
</li>
          <li class="normal" id="section-6.2-3.5">NLRI = IPv4-VPN routes<a class="pilcrow" href="#section-6.2-3.5">¶</a>
</li>
        </ul>
<p id="section-6.2-4">

   During BGP Capability Advertisement, the PE routers would include the
   following fields in the Capabilities Optional Parameter:<a class="pilcrow" href="#section-6.2-4">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2-5.1">Capability Code set to "Extended Next Hop Encoding"<a class="pilcrow" href="#section-6.2-5.1">¶</a>
</li>
          <li class="normal" id="section-6.2-5.2">Capability Value containing &lt;NLRI AFI=1, NLRI SAFI=128, Nexthop
      AFI=2&gt;<a class="pilcrow" href="#section-6.2-5.2">¶</a>
</li>
        </ul>
</section>
</div>
<div id="example-vpnv4multoipv6">
<section id="section-6.3">
        <h3 id="name-ipv4-vpn-multicast-over-ipv">
<a class="section-number selfRef" href="#section-6.3">6.3. </a><a class="section-name selfRef" href="#name-ipv4-vpn-multicast-over-ipv">IPv4 VPN Multicast over IPv6 Core</a>
        </h3>
<p id="section-6.3-1">
   The extensions defined in this document may be used for support of
   IPv4 multicast VPNs over an IPv6 backbone.  In this application, PE routers
would advertise VPN-IPv4 NLRI in the MP_REACH_NLRI along with an IPv6
   next hop.<a class="pilcrow" href="#section-6.3-1">¶</a></p>
<p id="section-6.3-2">
   The MP_REACH_NLRI is encoded with:<a class="pilcrow" href="#section-6.3-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.3-3.1">AFI = 1<a class="pilcrow" href="#section-6.3-3.1">¶</a>
</li>
          <li class="normal" id="section-6.3-3.2">SAFI = 129<a class="pilcrow" href="#section-6.3-3.2">¶</a>
</li>
          <li class="normal" id="section-6.3-3.3">Length of Next Hop Address field = 24 (or 48)<a class="pilcrow" href="#section-6.3-3.3">¶</a>
</li>
          <li class="normal" id="section-6.3-3.4">Next Hop Address = VPN-IPv6 address of a next hop whose RD is set to zero<a class="pilcrow" href="#section-6.3-3.4">¶</a>
</li>
          <li class="normal" id="section-6.3-3.5">NLRI = IPv4-VPN routes<a class="pilcrow" href="#section-6.3-3.5">¶</a>
</li>
        </ul>
<p id="section-6.3-4">

   During BGP Capability Advertisement, the PE routers would include the
   following fields in the Capabilities Optional Parameter:<a class="pilcrow" href="#section-6.3-4">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.3-5.1">Capability Code set to "Extended Next Hop Encoding"<a class="pilcrow" href="#section-6.3-5.1">¶</a>
</li>
          <li class="normal" id="section-6.3-5.2">Capability Value containing &lt;NLRI AFI=1, NLRI SAFI=129, Nexthop
      AFI=2&gt;<a class="pilcrow" href="#section-6.3-5.2">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="IANA">
<section id="section-7">
      <h2 id="name-iana-considerations">
<a class="section-number selfRef" href="#section-7">7. </a><a class="section-name selfRef" href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<p id="section-7-1">This document does not define any new code points from those
      included in <span>[<a class="xref" href="#RFC5549">RFC5549</a>]</span>.<a class="pilcrow" href="#section-7-1">¶</a></p>
<p id="section-7-2"><span>[<a class="xref" href="#RFC5549">RFC5549</a>]</span> added "Extended
      Next Hop Encoding" to the "Capability Codes" registry (<span>[<a class="xref" href="#IANA-CAP-CODE">IANA-CAP-CODE</a>]</span>), which was created by <span>[<a class="xref" href="#RFC5492">RFC5492</a>]</span>.  
 IANA has updated the registration of that entry to refer to this document.  The value allocated for this Capability
   Code is 5.<a class="pilcrow" href="#section-7-2">¶</a></p>
</section>
</div>
<div id="security">
<section id="section-8">
      <h2 id="name-security-considerations">
<a class="section-number selfRef" href="#section-8">8. </a><a class="section-name selfRef" href="#name-security-considerations">Security Considerations</a>
      </h2>
<p id="section-8-1">
    This document does not raise any additional security issues beyond
   those of BGP-4 and the Multiprotocol Extensions for BGP-4.  The same
   security mechanisms are applicable.<a class="pilcrow" href="#section-8-1">¶</a></p>
<p id="section-8-2">
   However, as <span>[<a class="xref" href="#RFC4272">RFC4272</a>]</span> discusses, BGP is vulnerable to traffic diversion attacks.
   The ability to advertise an IPv6 next hop adds a new means by which an
   attacker could cause traffic to be diverted from its normal path.  Such an
   attack differs from preexisting vulnerabilities in that traffic could be
   forwarded to a distant target across an intervening network infrastructure
   (e.g., an IPv6 core), allowing an attack to potentially succeed more
   easily since less infrastructure would have to be subverted.  Potential
   consequences include "hijacking" of traffic or denial of service.<a class="pilcrow" href="#section-8-2">¶</a></p>
<p id="section-8-3">
   Although not expected to be the typical case, the IPv6 address used
   as the BGP next-hop address could be an IPv4-mapped IPv6 address (as
   defined in <span>[<a class="xref" href="#RFC4291">RFC4291</a>]</span>).  Configuration of the security mechanisms
   potentially deployed by the network operator (such as security checks
   on a next-hop address) also need to keep this case in mind.<a class="pilcrow" href="#section-8-3">¶</a></p>
</section>
</div>
<section id="section-9">
      <h2 id="name-references">
<a class="section-number selfRef" href="#section-9">9. </a><a class="section-name selfRef" href="#name-references">References</a>
      </h2>
<section id="section-9.1">
        <h3 id="name-normative-references">
<a class="section-number selfRef" href="#section-9.1">9.1. </a><a class="section-name selfRef" href="#name-normative-references">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time class="refDate" datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2545">[RFC2545]</dt>
        <dd>
<span class="refAuthor">Marques, P.</span><span class="refAuthor"> and F. Dupont</span>, <span class="refTitle">"Use of BGP-4 Multiprotocol Extensions for IPv6 Inter-Domain Routing"</span>, <span class="seriesInfo">RFC 2545</span>, <span class="seriesInfo">DOI 10.17487/RFC2545</span>, <time class="refDate" datetime="1999-03">March 1999</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2545">https://www.rfc-editor.org/info/rfc2545</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4291">[RFC4291]</dt>
        <dd>
<span class="refAuthor">Hinden, R.</span><span class="refAuthor"> and S. Deering</span>, <span class="refTitle">"IP Version 6 Addressing Architecture"</span>, <span class="seriesInfo">RFC 4291</span>, <span class="seriesInfo">DOI 10.17487/RFC4291</span>, <time class="refDate" datetime="2006-02">February 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4291">https://www.rfc-editor.org/info/rfc4291</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4364">[RFC4364]</dt>
        <dd>
<span class="refAuthor">Rosen, E.</span><span class="refAuthor"> and Y. Rekhter</span>, <span class="refTitle">"BGP/MPLS IP Virtual Private Networks (VPNs)"</span>, <span class="seriesInfo">RFC 4364</span>, <span class="seriesInfo">DOI 10.17487/RFC4364</span>, <time class="refDate" datetime="2006-02">February 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4364">https://www.rfc-editor.org/info/rfc4364</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4760">[RFC4760]</dt>
        <dd>
<span class="refAuthor">Bates, T.</span><span class="refAuthor">, Chandra, R.</span><span class="refAuthor">, Katz, D.</span><span class="refAuthor">, and Y. Rekhter</span>, <span class="refTitle">"Multiprotocol Extensions for BGP-4"</span>, <span class="seriesInfo">RFC 4760</span>, <span class="seriesInfo">DOI 10.17487/RFC4760</span>, <time class="refDate" datetime="2007-01">January 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4760">https://www.rfc-editor.org/info/rfc4760</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5492">[RFC5492]</dt>
        <dd>
<span class="refAuthor">Scudder, J.</span><span class="refAuthor"> and R. Chandra</span>, <span class="refTitle">"Capabilities Advertisement with BGP-4"</span>, <span class="seriesInfo">RFC 5492</span>, <span class="seriesInfo">DOI 10.17487/RFC5492</span>, <time class="refDate" datetime="2009-02">February 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5492">https://www.rfc-editor.org/info/rfc5492</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time class="refDate" datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8277">[RFC8277]</dt>
      <dd>
<span class="refAuthor">Rosen, E.</span>, <span class="refTitle">"Using BGP to Bind MPLS Labels to Address Prefixes"</span>, <span class="seriesInfo">RFC 8277</span>, <span class="seriesInfo">DOI 10.17487/RFC8277</span>, <time class="refDate" datetime="2017-10">October 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8277">https://www.rfc-editor.org/info/rfc8277</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-9.2">
        <h3 id="name-informative-references">
<a class="section-number selfRef" href="#section-9.2">9.2. </a><a class="section-name selfRef" href="#name-informative-references">Informative References</a>
        </h3>
<dl class="references">
<dt id="Err5253">[Err5253]</dt>
        <dd>
<span class="refAuthor">RFC Errata</span>, <span class="refTitle">Erratum ID 5253</span>, <span class="refContent">RFC 5549</span>, <span>&lt;<a href="https://www.rfc-editor.org/errata/eid5253">https://www.rfc-editor.org/errata/eid5253</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA-AFI">[IANA-AFI]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Address Family Numbers"</span>, <span>&lt;<a href="https://www.iana.org/assignments/address-family-numbers/">https://www.iana.org/assignments/address-family-numbers/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA-CAP-CODE">[IANA-CAP-CODE]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Capability Codes"</span>, <span>&lt;<a href="https://www.iana.org/assignments/capability-codes/">https://www.iana.org/assignments/capability-codes/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA-SAFI">[IANA-SAFI]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Subsequent Address Family Identifiers (SAFI) Parameters"</span>, <span>&lt;<a href="https://www.iana.org/assignments/safi-namespace/">https://www.iana.org/assignments/safi-namespace/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4272">[RFC4272]</dt>
        <dd>
<span class="refAuthor">Murphy, S.</span>, <span class="refTitle">"BGP Security Vulnerabilities Analysis"</span>, <span class="seriesInfo">RFC 4272</span>, <span class="seriesInfo">DOI 10.17487/RFC4272</span>, <time class="refDate" datetime="2006-01">January 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4272">https://www.rfc-editor.org/info/rfc4272</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4659">[RFC4659]</dt>
        <dd>
<span class="refAuthor">De Clercq, J.</span><span class="refAuthor">, Ooms, D.</span><span class="refAuthor">, Carugi, M.</span><span class="refAuthor">, and F. Le Faucheur</span>, <span class="refTitle">"BGP-MPLS IP Virtual Private Network (VPN) Extension for IPv6 VPN"</span>, <span class="seriesInfo">RFC 4659</span>, <span class="seriesInfo">DOI 10.17487/RFC4659</span>, <time class="refDate" datetime="2006-09">September 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4659">https://www.rfc-editor.org/info/rfc4659</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4684">[RFC4684]</dt>
        <dd>
<span class="refAuthor">Marques, P.</span><span class="refAuthor">, Bonica, R.</span><span class="refAuthor">, Fang, L.</span><span class="refAuthor">, Martini, L.</span><span class="refAuthor">, Raszuk, R.</span><span class="refAuthor">, Patel, K.</span><span class="refAuthor">, and J. Guichard</span>, <span class="refTitle">"Constrained Route Distribution for Border Gateway Protocol/MultiProtocol Label Switching (BGP/MPLS) Internet Protocol (IP) Virtual Private Networks (VPNs)"</span>, <span class="seriesInfo">RFC 4684</span>, <span class="seriesInfo">DOI 10.17487/RFC4684</span>, <time class="refDate" datetime="2006-11">November 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4684">https://www.rfc-editor.org/info/rfc4684</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4798">[RFC4798]</dt>
        <dd>
<span class="refAuthor">De Clercq, J.</span><span class="refAuthor">, Ooms, D.</span><span class="refAuthor">, Prevost, S.</span><span class="refAuthor">, and F. Le Faucheur</span>, <span class="refTitle">"Connecting IPv6 Islands over IPv4 MPLS Using IPv6 Provider Edge Routers (6PE)"</span>, <span class="seriesInfo">RFC 4798</span>, <span class="seriesInfo">DOI 10.17487/RFC4798</span>, <time class="refDate" datetime="2007-02">February 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4798">https://www.rfc-editor.org/info/rfc4798</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4925">[RFC4925]</dt>
        <dd>
<span class="refAuthor">Li, X., Ed.</span><span class="refAuthor">, Dawkins, S., Ed.</span><span class="refAuthor">, Ward, D., Ed.</span><span class="refAuthor">, and A. Durand, Ed.</span>, <span class="refTitle">"Softwire Problem Statement"</span>, <span class="seriesInfo">RFC 4925</span>, <span class="seriesInfo">DOI 10.17487/RFC4925</span>, <time class="refDate" datetime="2007-07">July 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4925">https://www.rfc-editor.org/info/rfc4925</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5549">[RFC5549]</dt>
        <dd>
<span class="refAuthor">Le Faucheur, F.</span><span class="refAuthor"> and E. Rosen</span>, <span class="refTitle">"Advertising IPv4 Network Layer Reachability Information with an IPv6 Next Hop"</span>, <span class="seriesInfo">RFC 5549</span>, <span class="seriesInfo">DOI 10.17487/RFC5549</span>, <time class="refDate" datetime="2009-05">May 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5549">https://www.rfc-editor.org/info/rfc5549</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5565">[RFC5565]</dt>
        <dd>
<span class="refAuthor">Wu, J.</span><span class="refAuthor">, Cui, Y.</span><span class="refAuthor">, Metz, C.</span><span class="refAuthor">, and E. Rosen</span>, <span class="refTitle">"Softwire Mesh Framework"</span>, <span class="seriesInfo">RFC 5565</span>, <span class="seriesInfo">DOI 10.17487/RFC5565</span>, <time class="refDate" datetime="2009-06">June 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5565">https://www.rfc-editor.org/info/rfc5565</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6074">[RFC6074]</dt>
        <dd>
<span class="refAuthor">Rosen, E.</span><span class="refAuthor">, Davie, B.</span><span class="refAuthor">, Radoaca, V.</span><span class="refAuthor">, and W. Luo</span>, <span class="refTitle">"Provisioning, Auto-Discovery, and Signaling in Layer 2 Virtual Private Networks (L2VPNs)"</span>, <span class="seriesInfo">RFC 6074</span>, <span class="seriesInfo">DOI 10.17487/RFC6074</span>, <time class="refDate" datetime="2011-01">January 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6074">https://www.rfc-editor.org/info/rfc6074</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6513">[RFC6513]</dt>
        <dd>
<span class="refAuthor">Rosen, E., Ed.</span><span class="refAuthor"> and R. Aggarwal, Ed.</span>, <span class="refTitle">"Multicast in MPLS/BGP IP VPNs"</span>, <span class="seriesInfo">RFC 6513</span>, <span class="seriesInfo">DOI 10.17487/RFC6513</span>, <time class="refDate" datetime="2012-02">February 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6513">https://www.rfc-editor.org/info/rfc6513</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6514">[RFC6514]</dt>
      <dd>
<span class="refAuthor">Aggarwal, R.</span><span class="refAuthor">, Rosen, E.</span><span class="refAuthor">, Morin, T.</span><span class="refAuthor">, and Y. Rekhter</span>, <span class="refTitle">"BGP Encodings and Procedures for Multicast in MPLS/BGP IP VPNs"</span>, <span class="seriesInfo">RFC 6514</span>, <span class="seriesInfo">DOI 10.17487/RFC6514</span>, <time class="refDate" datetime="2012-02">February 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6514">https://www.rfc-editor.org/info/rfc6514</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="ack">
<section id="section-appendix.a">
      <h2 id="name-acknowledgments">
<a class="section-name selfRef" href="#name-acknowledgments">Acknowledgments</a>
      </h2>
<p id="section-appendix.a-1">The authors would like to thank <span class="contact-name">Francois Le Faucheur</span> and <span class="contact-name">Eric Rosen</span> for their work on <span>[<a class="xref" href="#RFC5549">RFC5549</a>]</span>.<a class="pilcrow" href="#section-appendix.a-1">¶</a></p>
<p id="section-appendix.a-2">
 The authors would like to thank <span class="contact-name">Yakov Rekhter</span>, <span class="contact-name">Pranav Mehta</span>, and <span class="contact-name">John    Scudder</span> for their contributions to the approach defined in <span>[<a class="xref" href="#RFC5549">RFC5549</a>]</span>.<a class="pilcrow" href="#section-appendix.a-2">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="section-appendix.b">
      <h2 id="name-authors-addresses">
<a class="section-name selfRef" href="#name-authors-addresses">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Stephane Litkowski</span></div>
<div class="left" dir="auto"><span class="org">Cisco</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:slitkows@cisco.com">slitkows@cisco.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Swadesh Agrawal</span></div>
<div class="left" dir="auto"><span class="org">Cisco</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:swaagraw@cisco.com">swaagraw@cisco.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Krishna Muddenahally Ananthamurthy</span></div>
<div class="left" dir="auto"><span class="org">Cisco</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:kriswamy@cisco.com">kriswamy@cisco.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Keyur Patel</span></div>
<div class="left" dir="auto"><span class="org">Arrcus</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:keyur@arrcus.com">keyur@arrcus.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>


</body></html>