<html><head></head><body><pre>Internet Engineering Task Force (IETF)                           J. Falk
Request for Comments: 6650                                   Return Path
Updates: <a href="./rfc5965">5965</a>                                          M. Kucherawy, Ed.
Category: Standards Track                                      Cloudmark
ISSN: 2070-1721                                                June 2012


              <span class="h1">Creation and Use of Email Feedback Reports:</span>
    <span class="h1">An Applicability Statement for the Abuse Reporting Format (ARF)</span>

Abstract

   <a href="./rfc5965">RFC 5965</a> defines an extensible, machine-readable format intended for
   mail operators to report feedback about received email to other
   parties.  This applicability statement describes common methods for
   utilizing this format for reporting both abuse and authentication
   failure events.  Mailbox Providers of any size, mail-sending
   entities, and end users can use these methods as a basis to create
   procedures that best suit them.  Some related optional mechanisms are
   also discussed.

Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in <a href="./rfc5741#section-2">Section 2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc6650">http://www.rfc-editor.org/info/rfc6650</a>.

















<span class="grey">Falk &amp; Kucherawy             Standards Track                    [Page 1]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-2"></span>
<span class="grey"><a href="./rfc6650">RFC 6650</a>                         ARF AS                        June 2012</span>


Copyright Notice

   Copyright (c) 2012 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://www.rfc-editor.org/bcp/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-3">3</a>
   <a href="#section-2">2</a>. Definitions .....................................................<a href="#page-4">4</a>
   <a href="#section-3">3</a>. Solicited and Unsolicited Reports ...............................<a href="#page-4">4</a>
   <a href="#section-4">4</a>. Generating and Handling Solicited Abuse Reports .................<a href="#page-4">4</a>
      <a href="#section-4.1">4.1</a>. General Considerations for Feedback Providers ..............<a href="#page-4">4</a>
      <a href="#section-4.2">4.2</a>. Where to Send Reports ......................................<a href="#page-5">5</a>
      <a href="#section-4.3">4.3</a>. What to Put in Reports .....................................<a href="#page-5">5</a>
      <a href="#section-4.4">4.4</a>. General Considerations for Feedback Consumers ..............<a href="#page-5">5</a>
      <a href="#section-4.5">4.5</a>. What to Expect .............................................<a href="#page-6">6</a>
      <a href="#section-4.6">4.6</a>. What to Do with Reports ....................................<a href="#page-6">6</a>
   <a href="#section-5">5</a>. Generating and Handling Unsolicited Abuse Reports ...............<a href="#page-6">6</a>
      <a href="#section-5.1">5.1</a>. General Considerations .....................................<a href="#page-6">6</a>
      <a href="#section-5.2">5.2</a>. When to Generate Reports ...................................<a href="#page-7">7</a>
      <a href="#section-5.3">5.3</a>. Where to Send Reports ......................................<a href="#page-7">7</a>
      <a href="#section-5.4">5.4</a>. What to Put in Reports .....................................<a href="#page-8">8</a>
      <a href="#section-5.5">5.5</a>. What to Do with Reports ....................................<a href="#page-9">9</a>
   <a href="#section-6">6</a>. Generating Automatic Authentication Failure Reports ............<a href="#page-10">10</a>
   <a href="#section-7">7</a>. Security Considerations ........................................<a href="#page-11">11</a>
      <a href="#section-7.1">7.1</a>. Security Considerations in Other Documents ................<a href="#page-11">11</a>
      <a href="#section-7.2">7.2</a>. Forgeries .................................................<a href="#page-11">11</a>
      <a href="#section-7.3">7.3</a>. Amplification Attacks .....................................<a href="#page-11">11</a>
      <a href="#section-7.4">7.4</a>. Automatic Generation ......................................<a href="#page-11">11</a>
      <a href="#section-7.5">7.5</a>. Reporting Multiple Incidents ..............................<a href="#page-12">12</a>
   <a href="#section-8">8</a>. Acknowledgements ...............................................<a href="#page-13">13</a>
   <a href="#section-9">9</a>. References .....................................................<a href="#page-13">13</a>
      <a href="#section-9.1">9.1</a>. Normative References ......................................<a href="#page-13">13</a>
      <a href="#section-9.2">9.2</a>. Informative References ....................................<a href="#page-14">14</a>







<span class="grey">Falk &amp; Kucherawy             Standards Track                    [Page 2]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-3"></span>
<span class="grey"><a href="./rfc6650">RFC 6650</a>                         ARF AS                        June 2012</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" id="section-1">1</a>.  Introduction</span>

   The Abuse Reporting Format (ARF) was initially developed for two very
   specific use cases.  Initially, it was intended to be used for
   reporting feedback between large email operators, or from large email
   operators to end user network access operators, any of whom could be
   presumed to have automated abuse-handling systems.  Secondarily, it
   is used by those same large mail operators to send those same reports
   to other entities, including those involved in sending bulk email for
   commercial purposes.  In either case, the reports would be triggered
   by direct end user action such as clicking on a "report spam" button
   in their email client.

   Though other uses for ARF as defined in [<a href="./rfc5965" title='"An Extensible Format for Email Feedback Reports"'>RFC5965</a>] have been discussed
   (and may be documented similarly in the future), abuse reporting
   remains the primary application, with a small amount of adoption of
   extensions that enable authentication failure reporting.

   This applicability statement provides direction for using ARF in both
   contexts.  It also includes some statements about the use of ARF in
   conjunction with other email technologies.

   The purpose for reporting abusive messages is to stop recurrences.
   The methods described in this document focus on automating abuse
   reporting as much as practical, so as to minimize the work of a
   site's abuse team.  There are further reasons why abuse feedback
   generation is worthwhile, such as instruction of mail filters or
   reputation trackers, or initiation of investigations of particularly
   egregious abuses.  These other applications are not discussed in
   this memo.

   Further introduction to this topic may be found in [<a href="./rfc6449" title='"Complaint Feedback Loop Operational Recommendations"'>RFC6449</a>], which
   has more information about the general topic of abuse reporting.
   Many of the specific ARF guidelines in this document were taken from
   the principles presented in [<a href="./rfc6449" title='"Complaint Feedback Loop Operational Recommendations"'>RFC6449</a>].

   At the time of publication of this document, five feedback types are
   registered.  This document only discusses two of them ("abuse"
   [<a href="./rfc5965" title='"An Extensible Format for Email Feedback Reports"'>RFC5965</a>] and "auth-failure" [<a href="./rfc6591" title='"Authentication Failure Reporting Using the Abuse Reporting Format"'>RFC6591</a>]), as they are seeing
   sufficient use in practice that applicability statements can be made
   about them.  The others, i.e., "fraud" [<a href="./rfc5965" title='"An Extensible Format for Email Feedback Reports"'>RFC5965</a>], "other" [<a href="./rfc5965" title='"An Extensible Format for Email Feedback Reports"'>RFC5965</a>],
   and "not-spam" [<a href="./rfc6430" title='"Email Feedback Report Type Value: not-spam"'>RFC6430</a>], are either too new or too seldom used to be
   included here.








<span class="grey">Falk &amp; Kucherawy             Standards Track                    [Page 3]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-4"></span>
<span class="grey"><a href="./rfc6650">RFC 6650</a>                         ARF AS                        June 2012</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/2.%20%20Definitions"></a><a class="selflink" href="#section-2" id="section-2">2</a>.  Definitions</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [<a href="./rfc2119" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>] and are
   intended to replace the Requirement Levels described in <a href="./rfc2026#section-3.3">Section 3.3
   of [RFC2026]</a>.

   Some of the terminology used in this document is taken from
   [<a href="./rfc5598" title='"Internet Mail Architecture"'>RFC5598</a>].

   "Mailbox Provider" refers to an organization that accepts, stores,
   and offers access to [<a href="./rfc5322" title='"Internet Message Format"'>RFC5322</a>] messages ("email messages") for end
   users.  Such an organization has typically implemented SMTP [<a href="./rfc5321" title='"Simple Mail Transfer Protocol"'>RFC5321</a>]
   and might provide access to messages through IMAP [<a href="./rfc3501" title='"INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1"'>RFC3501</a>], the Post
   Office Protocol (POP) [<a href="./rfc1939" title='"Post Office Protocol - Version 3"'>RFC1939</a>], a proprietary interface designed for
   HTTP [<a href="./rfc2616" title='"Hypertext Transfer Protocol -- HTTP/1.1"'>RFC2616</a>], or a proprietary protocol.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.%20%20Solicited%20and%20Unsolicited%20Reports"></a><a class="selflink" href="#section-3" id="section-3">3</a>.  Solicited and Unsolicited Reports</span>

   The original, and still by far the most common, application of
   [<a href="./rfc5965" title='"An Extensible Format for Email Feedback Reports"'>RFC5965</a>] is when two mail systems make a private agreement to
   exchange abuse reports -- usually reports due to recipients manually
   reporting messages as spam.  We refer to these as solicited reports.

   Other uses for ARF involve such reports sent between parties that
   don't know each other.  These unsolicited reports are sent without
   prior arrangement between the parties as to the context and meaning
   of the reports.  Therefore, the constraints on how these unsolicited
   reports need to be structured such that they are likely to be useful
   to the recipient -- e.g., to what address(es) they can usefully be
   sent, what issues they can be used to report, and how they can be
   handled by the receiver of the report -- are very different.

   The two cases are covered separately in the sections that follow.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/4.%20%20Generating%20and%20Handling%20Solicited%20Abuse%20Reports"></a><a class="selflink" href="#section-4" id="section-4">4</a>.  Generating and Handling Solicited Abuse Reports</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/4.1.%20%20General%20Considerations%20for%20Feedback%20Providers"></a><a class="selflink" href="#section-4.1" id="section-4.1">4.1</a>.  General Considerations for Feedback Providers</span>

   A Mailbox Provider receives reports of abusive or unwanted mail from
   its users, most often by providing a "report spam" button (or similar
   nomenclature) in the MUA (Mail User Agent).  The method of
   transferring this message and any associated metadata from the MUA to
   the Mailbox Provider's ARF processing system is not defined by any
   standards document but is discussed further in <a href="./rfc6449#section-3.2">Section 3.2 of
   [RFC6449]</a>.  Policy concerns related to the collection of this data
   are discussed in <a href="./rfc6449#section-3.4">Section 3.4 of [RFC6449]</a>.



<span class="grey">Falk &amp; Kucherawy             Standards Track                    [Page 4]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-5"></span>
<span class="grey"><a href="./rfc6650">RFC 6650</a>                         ARF AS                        June 2012</span>


   To implement the recommendations of this memo, the reports are
   formatted per [<a href="./rfc5965" title='"An Extensible Format for Email Feedback Reports"'>RFC5965</a>] and transmitted as an email message
   [<a href="./rfc5322" title='"Internet Message Format"'>RFC5322</a>], typically using SMTP [<a href="./rfc5321" title='"Simple Mail Transfer Protocol"'>RFC5321</a>].

   Ongoing maintenance of an ARF processing system is discussed in
   <a href="./rfc6449#section-3.6">Section 3.6 of [RFC6449]</a>.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/4.2.%20%20Where%20to%20Send%20Reports"></a><a class="selflink" href="#section-4.2" id="section-4.2">4.2</a>.  Where to Send Reports</span>

   The Mailbox Provider SHOULD NOT send reports to addresses that have
   not explicitly requested them.  A valid deviation might be the result
   of local policy instructions.  The process whereby such parties may
   request the reports is discussed in <a href="./rfc6449#section-3.5">Section 3.5 of [RFC6449]</a>.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/4.3.%20%20What%20to%20Put%20in%20Reports"></a><a class="selflink" href="#section-4.3" id="section-4.3">4.3</a>.  What to Put in Reports</span>

   The reports SHOULD use "Feedback-Type: abuse" for the report type.
   Although a Mailbox Provider generating the reports can use other
   types appropriate to the nature of the abuse being reported, the
   operator receiving the reports might not treat different feedback
   types differently.

   The following fields are optional in [<a href="./rfc5965" title='"An Extensible Format for Email Feedback Reports"'>RFC5965</a>] but SHOULD be used in
   this context when their corresponding values are available:
   Original-Mail-From, Arrival-Date, Source-IP, and Original-Rcpt-To.
   Other optional fields can be included as deemed appropriate by the
   implementer.

   User-identifiable data MAY be obscured as described in [<a href="./rfc6590" title='"Redaction of Potentially Sensitive Data from Mail Abuse Reports"'>RFC6590</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/4.4.%20%20General%20Considerations%20for%20Feedback%20Consumers"></a><a class="selflink" href="#section-4.4" id="section-4.4">4.4</a>.  General Considerations for Feedback Consumers</span>

   ARF report streams are established proactively between Feedback
   Providers and Feedback Consumers.  Recommendations for preparing to
   request feedback are discussed in <a href="./rfc6449#section-4.1">Section 4.1 of [RFC6449]</a>.

   Operators MUST be able to accept ARF [<a href="./rfc5965" title='"An Extensible Format for Email Feedback Reports"'>RFC5965</a>] reports as email
   messages [<a href="./rfc5322" title='"Internet Message Format"'>RFC5322</a>] over SMTP [<a href="./rfc5321" title='"Simple Mail Transfer Protocol"'>RFC5321</a>].  These messages, and other
   types of email messages that can be received, are discussed in
   <a href="./rfc6449#section-4.2">Section 4.2 of [RFC6449]</a>.

   Recipients of feedback reports that are part of formal feedback
   arrangements have to be capable of handling large volumes of reports.
   This could require automation of report processing as discussed in
   <a href="./rfc6449#section-4.4">Section 4.4 of [RFC6449]</a>.






<span class="grey">Falk &amp; Kucherawy             Standards Track                    [Page 5]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-6"></span>
<span class="grey"><a href="./rfc6650">RFC 6650</a>                         ARF AS                        June 2012</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/4.5.%20%20What%20to%20Expect"></a><a class="selflink" href="#section-4.5" id="section-4.5">4.5</a>.  What to Expect</span>

   The list of valid Feedback-Types is defined in [<a href="./rfc5965" title='"An Extensible Format for Email Feedback Reports"'>RFC5965</a>], which
   created an IANA registry for valid values to allow for extensions.
   However, to allow for handling of new types that are not yet
   supported, an automated report processing system MUST NOT reject (in
   the SMTP sense) a report based solely on an unknown Feedback-Type.
   The automated system can simply set reports of unknown types aside
   for manual handling.  However, Mailbox Providers might only make use
   of the "abuse" Feedback-Type.  Therefore, report receivers might be
   required to do additional analysis to separate different types of
   abuse reports after receipt if they do not have prior specific
   knowledge of the sender of the report.

   Report receivers MUST accept reports that have obscured their user-
   identifiable data as described in [<a href="./rfc6590" title='"Redaction of Potentially Sensitive Data from Mail Abuse Reports"'>RFC6590</a>].  That document also
   discusses the handling of such reports.  This technique is also
   discussed in <a href="./rfc6449#section-4.4">Section 4.4 of [RFC6449]</a>.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/4.6.%20%20What%20to%20Do%20with%20Reports"></a><a class="selflink" href="#section-4.6" id="section-4.6">4.6</a>.  What to Do with Reports</span>

   <a href="./rfc6449#section-4.3">Section 4.3 of [RFC6449]</a> discusses actions that mail operators might
   take upon receiving a report (or multiple reports).

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.%20%20Generating%20and%20Handling%20Unsolicited%20Abuse%20Reports"></a><a class="selflink" href="#section-5" id="section-5">5</a>.  Generating and Handling Unsolicited Abuse Reports</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.1.%20%20General%20Considerations"></a><a class="selflink" href="#section-5.1" id="section-5.1">5.1</a>.  General Considerations</span>

   It is essential for report recipients to be capable of throttling
   reports being sent to avoid damage to their own installations.
   Therefore, Feedback Providers MUST provide a way for report
   recipients to request that no further reports be sent.
   Unfortunately, no standardized mechanism for such requests exists to
   date, and all existing mechanisms for meeting this requirement are
   out-of-band.

   Message authentication is generally a good idea, but it is especially
   important to encourage credibility of, and thus response to,
   unsolicited reports.  Therefore, as with any other message, Feedback
   Providers sending unsolicited reports SHOULD send reports that they
   expect will pass the Sender Policy Framework (SPF) [<a href="./rfc4408" title='"Sender Policy Framework (SPF) for Authorizing Use of Domains in E-Mail, Version 1"'>RFC4408</a>] and/or
   DomainKeys Identified Mail (DKIM) [<a href="./rfc6376" title='"DomainKeys Identified Mail (DKIM) Signatures"'>RFC6376</a>] checks.









<span class="grey">Falk &amp; Kucherawy             Standards Track                    [Page 6]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-7"></span>
<span class="grey"><a href="./rfc6650">RFC 6650</a>                         ARF AS                        June 2012</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.2.%20%20When%20to%20Generate%20Reports"></a><a class="selflink" href="#section-5.2" id="section-5.2">5.2</a>.  When to Generate Reports</span>

   Handling of unsolicited reports has a significant cost to the report
   receiver.  Senders of unsolicited reports, especially those sending
   large volumes of them automatically, SHOULD NOT send reports that
   cannot be used as a basis for action by the recipient, whether this
   is due to the report being sent about an incident that is not abuse-
   related, the report being sent to an email address that won't result
   in action, or the content or format of the report being hard for the
   recipient to read or use.

   Feedback Providers SHOULD NOT report all mail sent from a particular
   sender merely because some of it is determined to be abusive.

   Mechanical reports of mail that "looks like" spam, based solely on
   the results of inline content analysis tools, SHOULD NOT be sent
   since, because of their subjective nature, they are unlikely to
   provide a basis for the recipient to take action.  Complaints
   generated by end users about mail that is determined by them to be
   abusive, or mail delivered to "spam trap" or "honeypot" addresses,
   are far more likely to be accurate and MAY be sent.

   If a Feedback Provider applies SPF [<a href="./rfc4408" title='"Sender Policy Framework (SPF) for Authorizing Use of Domains in E-Mail, Version 1"'>RFC4408</a>] to arriving messages, a
   report SHOULD NOT be generated to the <a href="./rfc5321">RFC5321</a>.MailFrom domain if the
   SPF evaluation produced a "Fail", "SoftFail", "TempError", or
   "PermError" report, as no reliable assertion or assumption can be
   made that use of the domain was authorized.  A valid exception would
   be specific knowledge that the SPF result is not definitive for that
   domain under those circumstances (for example, a message that is also
   signed using DKIM [<a href="./rfc6376" title='"DomainKeys Identified Mail (DKIM) Signatures"'>RFC6376</a>] by the same domain, and that signature
   validates).

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.3.%20%20Where%20to%20Send%20Reports"></a><a class="selflink" href="#section-5.3" id="section-5.3">5.3</a>.  Where to Send Reports</span>

   Rather than generating feedback reports themselves, MUAs SHOULD
   create abuse reports and send these reports back to their Mailbox
   Providers so that they can generate and send ARF messages on behalf
   of end users (see <a href="./rfc6449#section-3.2">Section 3.2 of [RFC6449]</a>).  This allows centralized
   processing and tracking of reports, and provides training input to
   filtering systems.  There is, however, no standard mechanism for this
   signaling between MUAs and Mailbox Providers to trigger abuse
   reports.

   Feedback Providers SHOULD NOT send reports to recipients that are
   uninvolved or only peripherally involved.  For example, they SHOULD
   NOT send reports to the operator of every Autonomous System in the
   path between the apparent originating system and the operator




<span class="grey">Falk &amp; Kucherawy             Standards Track                    [Page 7]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-8"></span>
<span class="grey"><a href="./rfc6650">RFC 6650</a>                         ARF AS                        June 2012</span>


   generating the report.  Instead, they need to send reports to
   recipients that are both responsible for the messages and able to do
   something about them.

   Deciding where to send an unsolicited report will typically rely on
   heuristics.  Abuse addresses in WHOIS [<a href="./rfc3912" title='"WHOIS Protocol Specification"'>RFC3912</a>] records of the IP
   address relaying the subject message and/or of the domain name found
   in the results of a PTR ("reverse lookup") query on that address are
   likely reasonable candidates, as is the abuse@domain role address
   (see [<a href="./rfc2142" title='"Mailbox Names for Common Services, Roles and Functions"'>RFC2142</a>]) of related domains.  Unsolicited reports SHOULD NOT
   be sent to email addresses that are not clearly intended to handle
   abuse reports.  Legitimate candidates include those found in WHOIS
   records or on a web site that either are explicitly described as an
   abuse contact or are of the form "abuse@domain".

   Where an abusive message is authenticated using a domain-level
   authentication technology such as DKIM [<a href="./rfc6376" title='"DomainKeys Identified Mail (DKIM) Signatures"'>RFC6376</a>] or SPF [<a href="./rfc4408" title='"Sender Policy Framework (SPF) for Authorizing Use of Domains in E-Mail, Version 1"'>RFC4408</a>],
   the domain that has been verified by the authentication mechanism is
   often a reasonable candidate for receiving feedback about the
   message.  For DKIM, though, while the authenticated domain has some
   responsibility for the mail sent, it can be a poor contact point for
   abuse issues (for example, it could represent the message's author
   but not its sender, it could identify the bad actor responsible for
   the message, or it could refer to a domain that cannot receive mail
   at all).

   Often, unsolicited reports will have no meaning if sent to abuse
   reporting addresses belonging to the abusive parties themselves.  In
   fact, it is possible that such reports might reveal information about
   complainants.  Reports SHOULD NOT be sent to such addresses if they
   can be identified beforehand, except where the abusive party is known
   to be responsive to such reports.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.4.%20%20What%20to%20Put%20in%20Reports"></a><a class="selflink" href="#section-5.4" id="section-5.4">5.4</a>.  What to Put in Reports</span>

   Reports SHOULD use "Feedback-Type: abuse" but can use other types as
   appropriate.  However, the Mailbox Provider generating the reports
   cannot assume that the operator receiving the reports will treat
   different Feedback-Types differently.

   Reports SHOULD include the following optional fields whenever their
   corresponding values are available and applicable to the report:
   Original-Mail-From, Arrival-Date, Source-IP, and Original-Rcpt-To.
   Other optional fields can be included as deemed appropriate by the
   implementer.






<span class="grey">Falk &amp; Kucherawy             Standards Track                    [Page 8]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-9"></span>
<span class="grey"><a href="./rfc6650">RFC 6650</a>                         ARF AS                        June 2012</span>


   Experience suggests that the use of ARF is advisable in most
   contexts.  Automated recipient systems can handle abuse reports sent
   in ARF at least as well as any other format such as plain text, with
   or without a copy of the message attached.  That holds even for
   systems that did not request ARF reports, assuming such reports are
   generated considering the possibility of recipients that don't use
   automated ARF parsing.  Anyone sending unsolicited reports in ARF can
   legitimately presume that some recipients will only be able to access
   the human-readable (first, text/plain) part of it and SHOULD include
   all information needed also in this part.  Further, they SHOULD
   ensure that the report is readable when viewed as plain text, to give
   low-end ticketing systems as much assistance as possible.  In extreme
   cases, failure to take these steps may result in the report being
   discarded or ignored.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.5.%20%20What%20to%20Do%20with%20Reports"></a><a class="selflink" href="#section-5.5" id="section-5.5">5.5</a>.  What to Do with Reports</span>

   Receivers of unsolicited reports can take advantage of the
   standardized parts of ARF to automate processing.  Independent of the
   sender of the report, they can improve processing by separating valid
   reports from invalid reports by, for example, looking for references
   to IP address ranges, domains, and mailboxes for which the recipient
   organization is responsible in the copy of the reported message, and
   by correlating multiple reports of similar messages to identify bulk
   email senders.

   Per <a href="./rfc6449#section-4.4">Section 4.4 of [RFC6449]</a>, a network service provider MAY use ARF
   data for automated forwarding of feedback messages to the originating
   customer.

   Published abuse mailbox addresses SHOULD NOT reject non-ARF messages
   based solely on the format, as generation of ARF messages can
   occasionally be unavailable or not applicable.  Deviation from this
   requirement could be done due to local policy decisions regarding
   other message criteria.

   Although [<a href="./rfc6449" title='"Complaint Feedback Loop Operational Recommendations"'>RFC6449</a>] suggests that replying to feedback is not useful,
   in the case of receipt of ARF reports where no feedback arrangement
   has been established, a non-automated reply might be desirable to
   indicate what action resulted from the complaint, heading off more
   severe filtering by the Feedback Provider.  In addition, using an
   address that cannot receive replies precludes any requests for
   additional information and increases the likelihood that further
   reports will be discarded or blocked.  Thus, a Feedback Provider
   sending unsolicited reports SHOULD NOT generate reports for which a
   reply cannot be received.  Where an unsolicited report results in the
   establishment of contact with a responsible and responsive party,
   this data can be saved for future complaint handling and possible



<span class="grey">Falk &amp; Kucherawy             Standards Track                    [Page 9]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-10"></span>
<span class="grey"><a href="./rfc6650">RFC 6650</a>                         ARF AS                        June 2012</span>


   establishment of a formal (solicited) feedback arrangement.  See
   <a href="./rfc6449#section-3.5">Section 3.5 of [RFC6449]</a> for a discussion of establishment of
   feedback arrangements.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/6.%20%20Generating%20Automatic%20Authentication%20Failure%20Reports"></a><a class="selflink" href="#section-6" id="section-6">6</a>.  Generating Automatic Authentication Failure Reports</span>

   There are some cases where report generation is caused by automation
   rather than user requests.  A specific example of this is reporting,
   using ARF (or extensions to it), of messages that fail particular
   message authentication checks.  Examples of this include [<a href="./rfc6651" title='"Extensions to DomainKeys Identified Mail (DKIM) for Failure Reporting"'>RFC6651</a>]
   and [<a href="./rfc6652" title='"Sender Policy Framework (SPF) Authentication Failure Reporting Using the Abuse Reporting Format"'>RFC6652</a>].  The considerations presented below apply in those
   cases.

   The applicability statement for this use case is somewhat smaller, as
   many of the issues associated with abuse reports are not relevant to
   reports about authentication failures.

   Automatic feedback generators MUST select actual message recipients
   based on data provided by willing report receivers.  In particular,
   recipients MUST NOT be selected using heuristics.

   If the message under evaluation by the Verifier is an ARF [<a href="./rfc5965" title='"An Extensible Format for Email Feedback Reports"'>RFC5965</a>]
   message, a report MUST NOT be automatically generated.

   The message for a new report sent via SMTP MUST be constructed so as
   to avoid amplification attacks, deliberate or otherwise.  The
   envelope sender address of the report MUST be chosen so that these
   reports will not generate mail loops.  Similar to <a href="./rfc3464#section-2">Section 2 of
   [RFC3464]</a>, the envelope sender address of the report MUST be chosen
   to ensure that no feedback reports will be issued in response to the
   report itself.  Therefore, when an SMTP transaction is used to send a
   report, the MAIL FROM command SHOULD use the NULL reverse-path, i.e.,
   "MAIL FROM:&lt;&gt;".  An exception to this would be the use of a reverse-
   path selected such that SPF checks on the report will pass; in such
   cases, the operator will need to make provisions to avoid the
   amplification attack or mail loop via other means.

   Reports SHOULD use "Feedback-Type: auth-failure" but MAY use other
   types as appropriate.  However, the Mailbox Provider generating the
   reports cannot assume that the operator receiving the reports will
   treat different Feedback-Types differently.

   These reports SHOULD include the following fields, although they are
   optional in [<a href="./rfc5965" title='"An Extensible Format for Email Feedback Reports"'>RFC5965</a>], whenever their corresponding values are
   available: Original-Mail-From, Arrival-Date, Source-IP, and
   Original-Rcpt-To.  Other optional fields can be included as deemed
   appropriate by the implementer.




<span class="grey">Falk &amp; Kucherawy             Standards Track                   [Page 10]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-11"></span>
<span class="grey"><a href="./rfc6650">RFC 6650</a>                         ARF AS                        June 2012</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/7.%20%20Security%20Considerations"></a><a class="selflink" href="#section-7" id="section-7">7</a>.  Security Considerations</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/7.1.%20%20Security%20Considerations%20in%20Other%20Documents"></a><a class="selflink" href="#section-7.1" id="section-7.1">7.1</a>.  Security Considerations in Other Documents</span>

   Implementers are strongly urged to review, at a minimum, the Security
   Considerations sections of [<a href="./rfc5965" title='"An Extensible Format for Email Feedback Reports"'>RFC5965</a>] and [<a href="./rfc6449" title='"Complaint Feedback Loop Operational Recommendations"'>RFC6449</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/7.2.%20%20Forgeries"></a><a class="selflink" href="#section-7.2" id="section-7.2">7.2</a>.  Forgeries</span>

   Feedback Providers that relay user complaints directly, rather than
   by reference to a stored message (e.g., IMAP or POP), could be duped
   into sending a complaint about a message that the complaining user
   never actually received, as an attack on the purported originator of
   the falsified message.  Feedback Providers need to be resilient to
   such attack methods.

   Also, these reports may be forged as easily as ordinary Internet
   electronic mail.  User agents and automatic mail handling facilities
   (such as mail distribution list exploders) that wish to make
   automatic use of reports of any kind should take appropriate
   precautions to minimize the potential damage from denial-of-service
   attacks.

   Perhaps the simplest means of mitigating this threat is to assert
   that these reports should themselves be signed with something like
   DKIM and/or authorized by something like SPF.  Note, however, that if
   there is a problem with the email infrastructure at either end, DKIM
   and/or SPF may result in reports that aren't trusted or even accepted
   by their intended recipients, so it is important to make sure those
   components are properly configured.  The use of both technologies in
   tandem can resolve this concern to a degree, since they generally
   have disjoint failure modes.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/7.3.%20%20Amplification%20Attacks"></a><a class="selflink" href="#section-7.3" id="section-7.3">7.3</a>.  Amplification Attacks</span>

   Failure to comply with the recommendations regarding selection of the
   envelope sender can lead to amplification denial-of-service attacks.
   This is discussed in <a href="#section-6">Section 6</a> as well as in [<a href="./rfc3464" title='"An Extensible Message Format for Delivery Status Notifications"'>RFC3464</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/7.4.%20%20Automatic%20Generation"></a><a class="selflink" href="#section-7.4" id="section-7.4">7.4</a>.  Automatic Generation</span>

   ARF [<a href="./rfc5965" title='"An Extensible Format for Email Feedback Reports"'>RFC5965</a>] reports have historically been generated individually
   as a result of some kind of human request, such as someone clicking a
   "Report Abuse" button in a mail reader.  In contrast, the mechanisms
   described in some extension documents (i.e., [<a href="./rfc6651" title='"Extensions to DomainKeys Identified Mail (DKIM) for Failure Reporting"'>RFC6651</a>] and [<a href="./rfc6652" title='"Sender Policy Framework (SPF) Authentication Failure Reporting Using the Abuse Reporting Format"'>RFC6652</a>])
   are focused around automated reporting.  This obviously implies the





<span class="grey">Falk &amp; Kucherawy             Standards Track                   [Page 11]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-12"></span>
<span class="grey"><a href="./rfc6650">RFC 6650</a>                         ARF AS                        June 2012</span>


   potential for much larger volumes or higher frequency of messages,
   and thus greater mail system load (both for Feedback Providers and
   report receivers).

   Those mechanisms are primarily intended for use in generating reports
   to aid implementers of DKIM [<a href="./rfc6376" title='"DomainKeys Identified Mail (DKIM) Signatures"'>RFC6376</a>], Author Domain Signing
   Practices (ADSP) [<a href="./rfc5617" title='"DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP)"'>RFC5617</a>], and SPF [<a href="./rfc4408" title='"Sender Policy Framework (SPF) for Authorizing Use of Domains in E-Mail, Version 1"'>RFC4408</a>], and other related
   protocols during development and debugging.  They are not generally
   intended for prolonged forensic use, specifically because of these
   load concerns.  However, extended use is possible by ADministrative
   Management Domains (ADMDs) that want to keep a close watch for fraud
   or infrastructure problems.  It is important to consider the impact
   of doing so on both Feedback Providers and the requesting ADMDs.

   A sender requesting these reports can cause its mail servers to be
   overwhelmed if it sends out signed messages whose signatures fail to
   verify for some reason, provoking a large number of reports from
   Feedback Providers.  Similarly, a Feedback Provider could be
   overwhelmed by a large volume of messages requesting reports whose
   signatures fail to validate, as the Feedback Provider now needs to
   send reports back to the Signer.

   Limiting the rate of generation of these messages may be appropriate
   but threatens to inhibit the distribution of important and possibly
   time-sensitive information.

   In general ARF feedback loop terms, it is often suggested that
   Feedback Providers only create these (or any) ARF reports after an
   out-of-band arrangement has been made between two parties.  These
   extension mechanisms provide ways to adjust parameters of an
   authorized abuse report feedback loop that is configured and
   activated by private agreement.  The alternative (sending reports
   automatically based solely on data found in the messages) may have
   unintended consequences.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/7.5.%20%20Reporting%20Multiple%20Incidents"></a><a class="selflink" href="#section-7.5" id="section-7.5">7.5</a>.  Reporting Multiple Incidents</span>

   If it is known that a particular host generates abuse reports upon
   certain incidents, an attacker could forge a high volume of messages
   that will trigger such a report.  The recipient of the report could
   then be inundated with reports.  This could easily be extended to a
   distributed denial-of-service attack by finding a number of report-
   generating servers.

   The incident count referenced in ARF [<a href="./rfc5965" title='"An Extensible Format for Email Feedback Reports"'>RFC5965</a>] provides a limited
   form of mitigation.  The host that generates reports can elect to
   send reports only periodically, with each report representing a
   number of identical or nearly identical incidents.  One might even do



<span class="grey">Falk &amp; Kucherawy             Standards Track                   [Page 12]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-13"></span>
<span class="grey"><a href="./rfc6650">RFC 6650</a>                         ARF AS                        June 2012</span>


   something inverse-exponentially, sending reports for each of the
   first ten incidents, then every tenth incident up to 100, then every
   100th incident up to 1000, etc., until some period of relative quiet
   after which the limitation resets.

   The use of this technique for "nearly identical" incidents in
   particular causes a degradation in reporting quality, however.  If
   for example a large number of pieces of spam arrive from one
   attacker, a reporting agent could decide only to send a report about
   a fraction of those messages.  While this averts a flood of reports
   to a system administrator, the precise details of each incident are
   similarly not sent.

   Other rate-limiting provisions might be considered, such as detecting
   a temporary failure response from the report destination and thus
   halting report generation to that destination for some period, or
   simply imposing or negotiating a hard limit on the number of reports
   to be sent to a particular receiver in a given time frame.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/8.%20%20Acknowledgements"></a><a class="selflink" href="#section-8" id="section-8">8</a>.  Acknowledgements</span>

   The author and editor wish to thank Steve Atkins, John Levine, Shmuel
   Metz, S. Moonesamy, and Alessandro Vesely for their contributions to
   this memo.

   All of the best practices referenced by this document are found in
   [<a href="./rfc6449" title='"Complaint Feedback Loop Operational Recommendations"'>RFC6449</a>], written within the Collaboration Committee of the
   Messaging Anti-Abuse Working Group (MAAWG).

   Finally, the original author wishes to thank the doctors and staff
   at the University of Texas MD Anderson Cancer Center for doing what
   they do.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/9.%20%20References"></a><a class="selflink" href="#section-9" id="section-9">9</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/9.1.%20%20Normative%20References"></a><a class="selflink" href="#section-9.1" id="section-9.1">9.1</a>.  Normative References</span>

   [<a id="ref-RFC2119">RFC2119</a>]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="https://www.rfc-editor.org/bcp/bcp14">BCP 14</a>, <a href="./rfc2119">RFC 2119</a>, March 1997.

   [<a id="ref-RFC5321">RFC5321</a>]  Klensin, J., "Simple Mail Transfer Protocol", <a href="./rfc5321">RFC 5321</a>,
              October 2008.

   [<a id="ref-RFC5322">RFC5322</a>]  Resnick, P., Ed., "Internet Message Format", <a href="./rfc5322">RFC 5322</a>,
              October 2008.

   [<a id="ref-RFC5598">RFC5598</a>]  Crocker, D., "Internet Mail Architecture", <a href="./rfc5598">RFC 5598</a>,
              July 2009.



<span class="grey">Falk &amp; Kucherawy             Standards Track                   [Page 13]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-14"></span>
<span class="grey"><a href="./rfc6650">RFC 6650</a>                         ARF AS                        June 2012</span>


   [<a id="ref-RFC5965">RFC5965</a>]  Shafranovich, Y., Levine, J., and M. Kucherawy, "An
              Extensible Format for Email Feedback Reports", <a href="./rfc5965">RFC 5965</a>,
              August 2010.

   [<a id="ref-RFC6591">RFC6591</a>]  Fontana, H., "Authentication Failure Reporting Using the
              Abuse Reporting Format", <a href="./rfc6591">RFC 6591</a>, April 2012.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/9.2.%20%20Informative%20References"></a><a class="selflink" href="#section-9.2" id="section-9.2">9.2</a>.  Informative References</span>

   [<a id="ref-RFC1939">RFC1939</a>]  Myers, J. and M. Rose, "Post Office Protocol - Version 3",
              STD 53, <a href="./rfc1939">RFC 1939</a>, May 1996.

   [<a id="ref-RFC2026">RFC2026</a>]  Bradner, S., "The Internet Standards Process --
              Revision 3", <a href="https://www.rfc-editor.org/bcp/bcp9">BCP 9</a>, <a href="./rfc2026">RFC 2026</a>, October 1996.

   [<a id="ref-RFC2142">RFC2142</a>]  Crocker, D., "Mailbox Names for Common Services, Roles and
              Functions", <a href="./rfc2142">RFC 2142</a>, May 1997.

   [<a id="ref-RFC2616">RFC2616</a>]  Fielding, R., Gettys, J., Mogul, J., Frystyk, H.,
              Masinter, L., Leach, P., and T. Berners-Lee, "Hypertext
              Transfer Protocol -- HTTP/1.1", <a href="./rfc2616">RFC 2616</a>, June 1999.

   [<a id="ref-RFC3464">RFC3464</a>]  Moore, K. and G. Vaudreuil, "An Extensible Message Format
              for Delivery Status Notifications", <a href="./rfc3464">RFC 3464</a>,
              January 2003.

   [<a id="ref-RFC3501">RFC3501</a>]  Crispin, M., "INTERNET MESSAGE ACCESS PROTOCOL -
              VERSION 4rev1", <a href="./rfc3501">RFC 3501</a>, March 2003.

   [<a id="ref-RFC3912">RFC3912</a>]  Daigle, L., "WHOIS Protocol Specification", <a href="./rfc3912">RFC 3912</a>,
              September 2004.

   [<a id="ref-RFC4408">RFC4408</a>]  Wong, M. and W. Schlitt, "Sender Policy Framework (SPF)
              for Authorizing Use of Domains in E-Mail, Version 1",
              <a href="./rfc4408">RFC 4408</a>, April 2006.

   [<a id="ref-RFC5617">RFC5617</a>]  Allman, E., Fenton, J., Delany, M., and J. Levine,
              "DomainKeys Identified Mail (DKIM) Author Domain Signing
              Practices (ADSP)", <a href="./rfc5617">RFC 5617</a>, August 2009.

   [<a id="ref-RFC6376">RFC6376</a>]  Crocker, D., Ed., Hansen, T., Ed., and M. Kucherawy, Ed.,
              "DomainKeys Identified Mail (DKIM) Signatures", <a href="./rfc6376">RFC 6376</a>,
              September 2011.

   [<a id="ref-RFC6430">RFC6430</a>]  Li, K. and B. Leiba, "Email Feedback Report Type Value:
              not-spam", <a href="./rfc6430">RFC 6430</a>, November 2011.





<span class="grey">Falk &amp; Kucherawy             Standards Track                   [Page 14]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-15"></span>
<span class="grey"><a href="./rfc6650">RFC 6650</a>                         ARF AS                        June 2012</span>


   [<a id="ref-RFC6449">RFC6449</a>]  Falk, J., Ed., "Complaint Feedback Loop Operational
              Recommendations", <a href="./rfc6449">RFC 6449</a>, November 2011.

   [<a id="ref-RFC6590">RFC6590</a>]  Falk, J., Ed., and M. Kucherawy, Ed., "Redaction of
              Potentially Sensitive Data from Mail Abuse Reports",
              <a href="./rfc6590">RFC 6590</a>, April 2012.

   [<a id="ref-RFC6651">RFC6651</a>]  Kucherawy, M., "Extensions to DomainKeys Identified Mail
              (DKIM) for Failure Reporting", <a href="./rfc6651">RFC 6651</a>, June 2012.

   [<a id="ref-RFC6652">RFC6652</a>]  Kitterman, S., "Sender Policy Framework (SPF)
              Authentication Failure Reporting Using the Abuse Reporting
              Format", <a href="./rfc6652">RFC 6652</a>, June 2012.

Authors' Addresses

   J.D. Falk
   Return Path
   100 Mathilda Place, Suite 100
   Sunnyvale, CA  94086
   USA

   URI:   <a href="http://www.returnpath.net/">http://www.returnpath.net/</a>


   Murray S. Kucherawy (editor)
   Cloudmark
   128 King St., 2nd Floor
   San Francisco, CA  94107
   US

   EMail: superuser@gmail.com



















Falk &amp; Kucherawy             Standards Track                   [Page 15]
</pre>
</body></html>