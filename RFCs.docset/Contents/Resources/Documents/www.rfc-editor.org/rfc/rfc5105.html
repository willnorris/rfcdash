<html><head></head><body><pre>Network Working Group                                           O. Lendl
Request for Comments: 5105                                       enum.at
Category: Standards Track                                  December 2007


                <span class="h1">ENUM Validation Token Format Definition</span>

Status of This Memo

   This document specifies an Internet standards track protocol for the
   Internet community, and requests discussion and suggestions for
   improvements.  Please refer to the current edition of the "Internet
   Official Protocol Standards" (STD 1) for the standardization state
   and status of this protocol.  Distribution of this memo is unlimited.

Abstract

   An ENUM domain name is tightly coupled with the underlying E.164
   number.  The process of verifying whether the Registrant of an ENUM
   domain name is identical to the Assignee of the corresponding E.164
   number is commonly called "validation".  This document describes a
   signed XML data format -- the Validation Token -- with which
   Validation Entities can convey successful completion of a validation
   procedure in a secure fashion.

Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-2">2</a>
   <a href="#section-2">2</a>. Data Requirements ...............................................<a href="#page-2">2</a>
   <a href="#section-3">3</a>. Digital Signature ...............................................<a href="#page-3">3</a>
   <a href="#section-4">4</a>. Field Descriptions ..............................................<a href="#page-4">4</a>
      <a href="#section-4.1">4.1</a>. The &lt;validation&gt; Element ...................................<a href="#page-4">4</a>
      <a href="#section-4.2">4.2</a>. The &lt;tokendata&gt; Element ....................................<a href="#page-5">5</a>
   <a href="#section-5">5</a>. Examples ........................................................<a href="#page-6">6</a>
      <a href="#section-5.1">5.1</a>. Unsigned Token without Registrant Information ..............<a href="#page-6">6</a>
      <a href="#section-5.2">5.2</a>. Signed Token ...............................................<a href="#page-6">6</a>
   <a href="#section-6">6</a>. Formal Syntax ...................................................<a href="#page-8">8</a>
      <a href="#section-6.1">6.1</a>. Token Core Schema ..........................................<a href="#page-9">9</a>
      <a href="#section-6.2">6.2</a>. Token Data Schema .........................................<a href="#page-10">10</a>
   <a href="#section-7">7</a>. Other Applications of the Token Concept ........................<a href="#page-12">12</a>
   <a href="#section-8">8</a>. IANA Considerations ............................................<a href="#page-12">12</a>
   <a href="#section-9">9</a>. Security Considerations ........................................<a href="#page-13">13</a>
   <a href="#section-10">10</a>. Acknowledgements ..............................................<a href="#page-14">14</a>
   <a href="#section-11">11</a>. References ....................................................<a href="#page-14">14</a>
      <a href="#section-11.1">11.1</a>. Normative References .....................................<a href="#page-14">14</a>
      <a href="#section-11.2">11.2</a>. Informative References ...................................<a href="#page-15">15</a>





<span class="grey">Lendl                       Standards Track                     [Page 1]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-2"></span>
<span class="grey"><a href="./rfc5105">RFC 5105</a>                 ENUM Validation Token             December 2007</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" id="section-1">1</a>.  Introduction</span>

   In the case where an ENUM (E.164 Number Mapping [<a href="#ref-1" title='"The E.164 to Uniform Resource Identifiers (URI) Dynamic Delegation Discovery System (DDDS) Application (ENUM)"'>1</a>]) domain name
   corresponds to an existing E.164 number [<a href="#ref-2" title='"The international public telecommunication numbering plan"'>2</a>], the delegation of this
   domain needs to be authorized by the Assignee of the corresponding
   E.164 number.  In the role model described in [<a href="#ref-15" title='"ENUM Validation Architecture"'>15</a>], the entity that
   performs this check is called the Validation Entity (VE).

   By conveying an ENUM Validation Token -- a signed XML document -- to
   the Registry, a VE certifies that delegation requirements have been
   met and are current.

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in <a href="./rfc2119">RFC 2119</a> [<a href="#ref-3" title='"Key words for use in RFCs to Indicate Requirement Levels"'>3</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/2.%20%20Data%20Requirements"></a><a class="selflink" href="#section-2" id="section-2">2</a>.  Data Requirements</span>

   In this model, the Token is the only piece of data passed from the VE
   to the Registry.  Therefore, the Token needs to contain at least as
   much information as the Registry requires to grant the delegation of
   the requested ENUM domain according to its registration policy.  As
   such, the Registry will need confirmation that:

   o  the Token was created by an accredited VE,

   o  the Token's duration of validity conforms to the policy,

   o  the validation procedure employed has met minimum requirements as
      set forth by policy,

   o  and that the Token is protected against tampering and replay
      attacks.

   Beyond such mandatory information, the Token may optionally include
   number holder information, in particular, to simplify future
   revalidations.

   For example, if initial validation requires the steps "Check the
   identity of the Registrant" and "Check the ownership of an E.164
   number", then a later revalidation only needs to re-check the
   ownership as the identity of the Registrant does not change.

   As the Token will be included (see e.g., [<a href="#ref-16" title='"ENUM Validation Information Mapping for the Extensible Provisioning Protocol"'>16</a>]) in XML-based Registry/
   Registrar protocols like the Extensible Provisioning Protocol (EPP)
   [<a href="#ref-13" title='"Extensible Provisioning Protocol (EPP)"'>13</a>], it is a natural choice to use XML to encode Validation Tokens.





<span class="grey">Lendl                       Standards Track                     [Page 2]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-3"></span>
<span class="grey"><a href="./rfc5105">RFC 5105</a>                 ENUM Validation Token             December 2007</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.%20%20Digital%20Signature"></a><a class="selflink" href="#section-3" id="section-3">3</a>.  Digital Signature</span>

   According to the architecture model the propriety of an ENUM
   delegation depends on the trust relationship between the Registry and
   the VE.  In general, an untrusted link between the Registry and VE
   should be assumed (for instance, the Token is passed along with the
   registration request by a Registrar, who might have no role in
   asserting the right-to-use).  Therefore, the Token must be protected
   against forgery, tampering, and replay-attacks.

   A digital signature on the token:

   o  asserts that the token was indeed generated by the indicated VE
      (authenticity).

   o  guarantees that the token was not tampered with in transit
      (integrity).

   o  enables auditing the validation process (non-repudiation).

   The cryptographic signature on the token follows <a href="./rfc3275">RFC 3275</a> (XML-DSIG
   [<a href="#ref-4" title='"(Extensible Markup Language) XML-Signature Syntax and Processing"'>4</a>]).  As tokens might be transmitted as part of an already XML based
   protocol, the exclusive XML canonicalization [<a href="#ref-9" title='"Exclusive XML Canonicalization Version 1.0"'>9</a>] MUST be used.  This
   transform guarantees that namespace declarations inherited from the
   surrounding XML do not invalidate the signature.  In order to make
   the signature an integral part of the token, the
   "enveloped"-signature mode is employed.  The signature covers all
   information contained in the Token.

   XML-DSIG offers a number of cryptographic algorithms for digesting
   and signing documents and recommends SHA1/RSA-SHA1.  Recent advances
   in cryptanalysis have cast doubt on the security of SHA1, thus
   rendering this recommendation obsolete (see e.g., the Security
   Considerations of [<a href="#ref-14" title='"Additional Algorithms and Identifiers for RSA Cryptography for use in the Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"'>14</a>]).  <a href="./rfc4051">RFC 4051</a> [<a href="#ref-5" title='"Additional XML Security Uniform Resource Identifiers (URIs)"'>5</a>] defines how additional
   algorithms can be used with XML-DSIG.

   Validation Entities MUST be able to sign tokens according to
   XML-DSIG, MUST support RSA-SHA1 and RSA-SHA256 [<a href="#ref-5" title='"Additional XML Security Uniform Resource Identifiers (URIs)"'>5</a>], MUST support RSA
   key sizes of 1024 and 2048 bits, and MUST be able to embed X.509 [<a href="#ref-10" title='"Information technology - Open Systems Interconnection - The Directory: Public-key and attribute certificate frameworks"'>10</a>]
   certificates.  The Registry MUST define which signature algorithms
   and key sizes it will accept in Validation Tokens as part of its
   local policy.

   The choice of a RSA-based signature does not require a public key
   infrastructure.  Whether the Registry acts as a certification
   authority, accepts certs from a public certification authority, or
   only accepts pre-registered keys is a local policy choice.




<span class="grey">Lendl                       Standards Track                     [Page 3]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-4"></span>
<span class="grey"><a href="./rfc5105">RFC 5105</a>                 ENUM Validation Token             December 2007</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/4.%20%20Field%20Descriptions"></a><a class="selflink" href="#section-4" id="section-4">4</a>.  Field Descriptions</span>

   The Validation Token is structured into three parts: the basic
   validation information, additional information about the Registrant,
   and the digital signature.  The XML schema can be found in <a href="#section-6">Section 6</a>.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/4.1.%20%20The%20%3Cvalidation%3E%20Element"></a><a class="selflink" href="#section-4.1" id="section-4.1">4.1</a>.  The &lt;validation&gt; Element</span>

   A token MUST contain a &lt;validation&gt; element that contains the
   following:

   o  A single validation "serial" attribute identifying a validation
      token for a certain VE.  It must be unique per VE.

   o  A single &lt;E164Number&gt; element containing the underlying E.164
      number in fully qualified (international) format.

   o  An optional &lt;lastE164Number&gt; element.  If present, it indicates
      that the whole number block starting with &lt;E164Number&gt; up to and
      including &lt;lastE164Number&gt; has been validated.  To avoid
      ambiguity, both numbers MUST be of the same length.

   o  A single &lt;validationEntityID&gt; element identifying the VE.

   o  A single &lt;registrarID&gt; element identifying the Registrar on whose
      behalf the validation was performed.

   o  A single &lt;methodID&gt; element identifying the method used by the VE
      for validation.

   o  A single &lt;executionDate&gt; attribute containing the date of
      validation formatted as "full-date" according to <a href="./rfc3339">RFC 3339</a> [<a href="#ref-6" title='"Date and Time on the Internet: Timestamps"'>6</a>].

   o  An optional &lt;expirationDate&gt; attribute marking the expiration date
      of the validation token formatted as "full-date" according to <a href="./rfc3339">RFC</a>
      <a href="./rfc3339">3339</a>.  The Registry will automatically revoke the delegation at
      this date unless a new Token has been submitted that extends the
      lifetime of the validation.  A missing &lt;expirationDate&gt; indicates
      infinite validity of the Token.

   The format and the uniqueness-constraints of these IDs is left to the
   local policy of the Registry.









<span class="grey">Lendl                       Standards Track                     [Page 4]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-5"></span>
<span class="grey"><a href="./rfc5105">RFC 5105</a>                 ENUM Validation Token             December 2007</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/4.2.%20%20The%20%3Ctokendata%3E%20Element"></a><a class="selflink" href="#section-4.2" id="section-4.2">4.2</a>.  The &lt;tokendata&gt; Element</span>

   A token may contain a &lt;tokendata&gt; section containing information
   about the number holder, consisting of the following elements:

   o  A single &lt;organization&gt; element containing the full name of the
      organization to which the Registrant is affiliated.

   o A single &lt;commercialregisternumber&gt; element.  If the Registrant is
      a company, then this field can be used to uniquely identify this
      company by its official registration number within the local
      country.  The interpretation of this field is thus
      country-specific.

   o  A single &lt;title&gt; element.

   o  A single &lt;firstname&gt; element.

   o  A single &lt;lastname&gt; element.

   o  A single &lt;address&gt; section containing the following elements:
      *  A single optional &lt;streetName&gt;
      *  A single optional &lt;houseNumber&gt;
      *  A single optional &lt;postalCode&gt;
      *  A single optional &lt;locality&gt;
      *  A single optional &lt;countyStateOrProvince&gt;
      *  A single optional &lt;ISOcountryCode&gt;

   o  Up to 10 &lt;phone&gt; elements containing full E.164 numbers.

   o  Up to 10 &lt;fax&gt; elements containing full E.164 numbers.

   o  Up to 10 &lt;email&gt; elements.

   All elements directly under &lt;tokendata&gt; are optional.  The
   &lt;ISOcountryCode&gt; element specifies the country using the alpha-2
   country code from ISO 3166-1:2006 [<a href="#ref-11" title='"Codes for the representation of names of countries and their subdivisions -- Part 1: Country codes, 2nd edition"'>11</a>] (including updates published
   by the 3166 Maintenance Agency).  The definition of the first five
   elements within the &lt;address&gt; element conforms to the second version
   of the E.115 Computerized Directory Assistance [<a href="#ref-17" title='"Computerized Directory Assistance Version 2"'>17</a>].











<span class="grey">Lendl                       Standards Track                     [Page 5]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-6"></span>
<span class="grey"><a href="./rfc5105">RFC 5105</a>                 ENUM Validation Token             December 2007</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.%20%20Examples"></a><a class="selflink" href="#section-5" id="section-5">5</a>.  Examples</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.1.%20%20Unsigned%20Token%20without%20Registrant%20Information"></a><a class="selflink" href="#section-5.1" id="section-5.1">5.1</a>.  Unsigned Token without Registrant Information</span>

   This basic Token without any information about the Registrant and
   without the cryptographic signature shows the basic layout of the
   Token.

   &lt;?xml version="1.0" encoding="utf-8" standalone="no" ?&gt;
   &lt;token xmlns="urn:ietf:params:xml:ns:enum-token-1.0" Id="TOKEN"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation=
    "urn:ietf:params:xml:ns:enum-token-1.0 enum-token-1.0.xsd"&gt;
     &lt;validation serial="acmeve-000002"&gt;
       &lt;E164Number&gt;+442079460200&lt;/E164Number&gt;
       &lt;lastE164Number&gt;+442079460499&lt;/lastE164Number&gt;
       &lt;validationEntityID&gt;ACME-VE&lt;/validationEntityID&gt;
       &lt;registrarID&gt;reg-4711&lt;/registrarID&gt;
       &lt;methodID&gt;42&lt;/methodID&gt;
       &lt;executionDate&gt;2007-05-08&lt;/executionDate&gt;
       &lt;expirationDate&gt;2007-11-01&lt;/expirationDate&gt;
     &lt;/validation&gt;
   &lt;/token&gt;

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.2.%20%20Signed%20Token"></a><a class="selflink" href="#section-5.2" id="section-5.2">5.2</a>.  Signed Token</span>

   This example uses an X.509 based signature that includes the
   certificate of the signing validation entity.  Thus, the validity of
   the signature can be verified without the need for a key-server.  A
   valid signature is a necessary, but not sufficient, condition for a
   valid Token.  Any entity evaluating a Token needs to check other
   factors as well, e.g., the certificate and the XML schema.

&lt;?xml version="1.0" encoding="utf-8" standalone="no" ?&gt;
&lt;token xmlns="urn:ietf:params:xml:ns:enum-token-1.0" Id="TOKEN"
 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
 xsi:schemaLocation=
 "urn:ietf:params:xml:ns:enum-token-1.0 enum-token-1.0.xsd"&gt;
  &lt;validation serial="acmeve-000001"&gt;
    &lt;E164Number&gt;+442079460123&lt;/E164Number&gt;
    &lt;validationEntityID&gt;ACME-VE&lt;/validationEntityID&gt;
    &lt;registrarID&gt;reg-4711&lt;/registrarID&gt;
    &lt;methodID&gt;42&lt;/methodID&gt;
    &lt;executionDate&gt;2007-05-08&lt;/executionDate&gt;
  &lt;/validation&gt;
  &lt;tokendata xmlns="urn:ietf:params:xml:ns:enum-tokendata-1.0"
   xsi:schemaLocation=
   "urn:ietf:params:xml:ns:enum-tokendata-1.0 enum-tokendata-1.0.xsd"&gt;



<span class="grey">Lendl                       Standards Track                     [Page 6]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-7"></span>
<span class="grey"><a href="./rfc5105">RFC 5105</a>                 ENUM Validation Token             December 2007</span>


    &lt;contact&gt;
      &lt;organisation&gt;Example Inc.&lt;/organisation&gt;
      &lt;commercialregisternumber&gt;4711&lt;/commercialregisternumber&gt;
      &lt;title&gt;Dr.&lt;/title&gt;
      &lt;firstname&gt;Max&lt;/firstname&gt;
      &lt;lastname&gt;Mustermann&lt;/lastname&gt;
      &lt;address&gt;
        &lt;streetName&gt;Main&lt;/streetName&gt;
        &lt;houseNumber&gt;10&lt;/houseNumber&gt;
        &lt;postalCode&gt;1010&lt;/postalCode&gt;
        &lt;locality&gt;London&lt;/locality&gt;
        &lt;countyStateOrProvince&gt;London&lt;/countyStateOrProvince&gt;
        &lt;ISOcountryCode&gt;GB&lt;/ISOcountryCode&gt;
      &lt;/address&gt;
      &lt;phone&gt;+442079460123&lt;/phone&gt;
      &lt;email&gt;mm@example.com&lt;/email&gt;
    &lt;/contact&gt;
  &lt;/tokendata&gt;
  &lt;Signature xmlns="http://www.w3.org/2000/09/xmldsig#"&gt;
    &lt;SignedInfo&gt;
      &lt;CanonicalizationMethod
       Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/&gt;
      &lt;SignatureMethod
       Algorithm="http://www.w3.org/2001/04/xmldsig-more#rsa-sha256"/&gt;
      &lt;Reference URI="#TOKEN"&gt;
        &lt;Transforms&gt;
          &lt;Transform Algorithm=
           "<a href="http://www.w3.org/2000/09/xmldsig#enveloped-signature">http://www.w3.org/2000/09/xmldsig#enveloped-signature</a>"/&gt;
          &lt;Transform
           Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"&gt;
            &lt;InclusiveNamespaces
             xmlns="http://www.w3.org/2001/10/xml-exc-c14n#"
             PrefixList="enum-token enum-tokendata"/&gt;
          &lt;/Transform&gt;
        &lt;/Transforms&gt;
        &lt;DigestMethod
         Algorithm="http://www.w3.org/2001/04/xmlenc#sha256"/&gt;
        &lt;DigestValue
        &gt;VxqsBxSNPFwPAUlCHts3g3DehcexnB1dqUz+GypLZ0k=&lt;/DigestValue&gt;
      &lt;/Reference&gt;
    &lt;/SignedInfo&gt;
    &lt;SignatureValue&gt;
QKqphKRNPokVZFbenje+HZZV+RLrNweGnlWBw7ngAtH+rtuslR8LhMLmC4DlBb9V
HvKItl+7zLGm3VgYsqfHH8q3jCl1mFxUIuLlIPqtpJs+xAHAJDzZ+vmsF/q2IgrS
K0uMmKuU5V1gydDBOvIipcJx+PrPYyXYZSjQXkWknK8=&lt;/SignatureValue&gt;
  &lt;KeyInfo&gt;
&lt;X509Data&gt;
&lt;X509Certificate&gt;



<span class="grey">Lendl                       Standards Track                     [Page 7]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-8"></span>
<span class="grey"><a href="./rfc5105">RFC 5105</a>                 ENUM Validation Token             December 2007</span>


MIIDZjCCAs+gAwIBAgIBBDANBgkqhkiG9w0BAQQFADB0MQswCQYDVQQGEwJBVDEP
MA0GA1UEBxMGVmllbm5hMRQwEgYDVQQKEwtCT0ZIIENlcnRzLjEbMBkGA1UEAxMS
Q0VSVFMuYm9maC5wcml2LmF0MSEwHwYJKoZIhvcNAQkBFhJjZXJ0c0Bib2ZoLnBy
aXYuYXQwHhcNMDQwNzIwMTMxNTA5WhcNMDUwNzIwMTMxNTA5WjB/MQswCQYDVQQG
EwJBVDEKMAgGA1UECBMBLTEPMA0GA1UEBxMGVmllbm5hMR0wGwYDVQQKExRBY21l
IEVOVU0gVmFsaWRhdGlvbjEQMA4GA1UEAxMHYWNtZS1WRTEiMCAGCSqGSIb3DQEJ
ARYTbm9ib2R5QGVudW0tYWNtZS5hdDCBnzANBgkqhkiG9w0BAQEFAAOBjQAwgYkC
gYEArJPcjMFc54/zwztSdQXGxUtodJT9r1qGI2lQPNjLvtPJg93+7o5SIOsZGSpg
zWbztDAV5qc7PHZWUVIyf6MbM5qSgQDVrjNRhTosNtyqmwi23BH52SKkX3P7eGit
LmqEkiUZRxZhZ6upRbtcqvKSwmXitvW4zXZhkVHYJZ2HuMcCAwEAAaOB/DCB+TAJ
BgNVHRMEAjAAMCwGCWCGSAGG+EIBDQQfFh1PcGVuU1NMIEdlbmVyYXRlZCBDZXJ0
aWZpY2F0ZTAdBgNVHQ4EFgQUyK4otTQtvv6KdSlMBOPT5Ve18JgwgZ4GA1UdIwSB
ljCBk4AUvfPadpm0HhmZx2iAVumQTwgnG2eheKR2MHQxCzAJBgNVBAYTAkFUMQ8w
DQYDVQQHEwZWaWVubmExFDASBgNVBAoTC0JPRkggQ2VydHMuMRswGQYDVQQDExJD
RVJUUy5ib2ZoLnByaXYuYXQxITAfBgkqhkiG9w0BCQEWEmNlcnRzQGJvZmgucHJp
di5hdIIBADANBgkqhkiG9w0BAQQFAAOBgQCB9CHBnIUhrdic4h5Ar4hdxjHSQkDH
sJWd+MYrNcuSrv3TIOsUkUgNpNNhmkZPtiXqfy3388IRdJtJiLWXSOb/XlZHOM9I
MvwKYwhcpQ9UdM/w7VpXQqf+CEj0XSyqxGw65UsHIOijgiG/WyhSj+Lzriw7CTge
P2iAJkJVC4t2XA==
&lt;/X509Certificate&gt;
&lt;/X509Data&gt;
&lt;/KeyInfo&gt;
&lt;/Signature&gt;
&lt;/token&gt;

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/6.%20%20Formal%20Syntax"></a><a class="selflink" href="#section-6" id="section-6">6</a>.  Formal Syntax</span>

   The formal syntax of the validation token is specified using XML
   schema notation [<a href="#ref-7" title='"XML Schema Part 1: Structures"'>7</a>] [<a href="#ref-8" title='"XML Schema Part 2: Datatypes"'>8</a>].  Two schemas are defined: The "token core
   schema" contains mandatory attribute definitions, and the "token data
   schema" defines the format of the optional "tokendata" section.  The
   BEGIN and END tags are not part of the schema; they are used to note
   the beginning and ending of the schema for URI registration purposes.


















<span class="grey">Lendl                       Standards Track                     [Page 8]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-9"></span>
<span class="grey"><a href="./rfc5105">RFC 5105</a>                 ENUM Validation Token             December 2007</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/6.1.%20%20Token%20Core%20Schema"></a><a class="selflink" href="#section-6.1" id="section-6.1">6.1</a>.  Token Core Schema</span>

   BEGIN
   &lt;?xml version="1.0" encoding="UTF-8"?&gt;

   &lt;schema targetNamespace="urn:ietf:params:xml:ns:enum-token-1.0"
     xmlns:enum-token="urn:ietf:params:xml:ns:enum-token-1.0"
     xmlns:enum-tokendata="urn:ietf:params:xml:ns:enum-tokendata-1.0"
     xmlns:ds="http://www.w3.org/2000/09/xmldsig#"
     xmlns="http://www.w3.org/2001/XMLSchema"
     elementFormDefault="qualified"&gt;

   &lt;!--  Import common element types.  --&gt;

     &lt;import namespace="http://www.w3.org/2000/09/xmldsig#"
             schemaLocation="xmldsig-core-schema.xsd"/&gt;
     &lt;import namespace="urn:ietf:params:xml:ns:enum-tokendata-1.0"
             schemaLocation="enum-tokendata-1.0.xsd"/&gt;

     &lt;annotation&gt;
       &lt;documentation&gt;
         Validation Token core schema
       &lt;/documentation&gt;
     &lt;/annotation&gt;

     &lt;element name="token" type="enum-token:tokenBaseType"/&gt;

     &lt;simpleType name="shortTokenType"&gt;
       &lt;restriction base="token"&gt;
         &lt;minLength value="1"/&gt;
         &lt;maxLength value="20"/&gt;
       &lt;/restriction&gt;
     &lt;/simpleType&gt;

     &lt;simpleType name="e164numberType"&gt;
       &lt;restriction base="token"&gt;
         &lt;maxLength value="20"/&gt;
         &lt;pattern value="\+\d\d*"/&gt;
       &lt;/restriction&gt;
     &lt;/simpleType&gt;

     &lt;complexType name="validationDataType"&gt;
       &lt;sequence&gt;
         &lt;element name="E164Number"
                         type="enum-token:e164numberType"/&gt;
         &lt;element name="lastE164Number" minOccurs="0"
                         type="enum-token:e164numberType"/&gt;
         &lt;element name="validationEntityID"



<span class="grey">Lendl                       Standards Track                     [Page 9]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-10"></span>
<span class="grey"><a href="./rfc5105">RFC 5105</a>                 ENUM Validation Token             December 2007</span>


                         type="enum-token:shortTokenType"/&gt;
         &lt;element name="registrarID"
                         type="enum-token:shortTokenType"/&gt;
         &lt;element name="methodID"
                         type="enum-token:shortTokenType"/&gt;
         &lt;element name="executionDate" type="date"/&gt;
         &lt;element name="expirationDate"
                         type="date" minOccurs="0"/&gt;
       &lt;/sequence&gt;
       &lt;attribute name="serial" type="enum-token:shortTokenType"
        use="required"/&gt;
     &lt;/complexType&gt;

     &lt;complexType name="tokenBaseType"&gt;
       &lt;sequence&gt;
         &lt;element name="validation"
          type="enum-token:validationDataType"/&gt;
         &lt;any namespace="urn:ietf:params:xml:ns:enum-tokendata-1.0"
          minOccurs="0"/&gt;
         &lt;any namespace="http://www.w3.org/2000/09/xmldsig#"/&gt;
       &lt;/sequence&gt;
       &lt;attribute name="Id" type="ID" use="required"/&gt;
     &lt;/complexType&gt;
   &lt;/schema&gt;
   END

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/6.2.%20%20Token%20Data%20Schema"></a><a class="selflink" href="#section-6.2" id="section-6.2">6.2</a>.  Token Data Schema</span>

   BEGIN
   &lt;?xml version="1.0" encoding="UTF-8"?&gt;

   &lt;schema targetNamespace="urn:ietf:params:xml:ns:enum-tokendata-1.0"
     xmlns:enum-tokendata="urn:ietf:params:xml:ns:enum-tokendata-1.0"
     xmlns="http://www.w3.org/2001/XMLSchema"
     elementFormDefault="qualified"&gt;

     &lt;element name="tokendata" type="enum-tokendata:tokenDataType"/&gt;

     &lt;simpleType name="E115String"&gt;
       &lt;restriction base="string"&gt;
    &lt;pattern value="[&amp;#x20;-&amp;#x7A;&amp;#xA0;-&amp;#xD7FF;&amp;#xE000;-&amp;#xFFFD;]*"/&gt;
       &lt;/restriction&gt;
     &lt;/simpleType&gt;

     &lt;simpleType name="E115StringUb256"&gt;
       &lt;restriction base="enum-tokendata:E115String"&gt;
         &lt;minLength value="1"/&gt;
         &lt;maxLength value="256"/&gt;



<span class="grey">Lendl                       Standards Track                    [Page 10]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-11"></span>
<span class="grey"><a href="./rfc5105">RFC 5105</a>                 ENUM Validation Token             December 2007</span>


       &lt;/restriction&gt;
     &lt;/simpleType&gt;

     &lt;simpleType name="countryCodeType"&gt;
       &lt;restriction base="token"&gt;
         &lt;minLength value="2"/&gt;
         &lt;maxLength value="2"/&gt;
       &lt;/restriction&gt;
     &lt;/simpleType&gt;

     &lt;simpleType name="TokenType"&gt;
       &lt;restriction base="token"&gt;
         &lt;minLength value="1"/&gt;
         &lt;maxLength value="64"/&gt;
       &lt;/restriction&gt;
     &lt;/simpleType&gt;

     &lt;complexType name="addressType"&gt;
       &lt;all&gt;
         &lt;element name="streetName"     minOccurs="0"
          type="enum-tokendata:E115StringUb256" /&gt;
         &lt;element name="houseNumber"    minOccurs="0"
          type="enum-tokendata:E115StringUb256"/&gt;
         &lt;element name="postalCode"     minOccurs="0"
          type="enum-tokendata:E115StringUb256"/&gt;
         &lt;element name="locality"       minOccurs="0"
          type="enum-tokendata:E115StringUb256"/&gt;
         &lt;element name="countyStateOrProvince" minOccurs="0"
          type="enum-tokendata:E115StringUb256"/&gt;
         &lt;element name="ISOcountryCode" minOccurs="0"
          type="enum-tokendata:countryCodeType"/&gt;
       &lt;/all&gt;
     &lt;/complexType&gt;

     &lt;group name="tokenContactBaseGroup"&gt;
       &lt;sequence&gt;
         &lt;element name="organisation"  minOccurs="0"
          type="enum-tokendata:E115StringUb256"/&gt;
         &lt;element name="commercialregisternumber" minOccurs="0"
          type="enum-tokendata:TokenType"/&gt;
         &lt;element name="title"         minOccurs="0"
          type="enum-tokendata:TokenType"/&gt;
         &lt;element name="firstname"     minOccurs="0"
          type="enum-tokendata:E115StringUb256"/&gt;
         &lt;element name="lastname"      minOccurs="0"
          type="enum-tokendata:E115StringUb256"/&gt;
         &lt;element name="address"       minOccurs="0"
          type="enum-tokendata:addressType"/&gt;



<span class="grey">Lendl                       Standards Track                    [Page 11]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-12"></span>
<span class="grey"><a href="./rfc5105">RFC 5105</a>                 ENUM Validation Token             December 2007</span>


         &lt;element name="phone" type="enum-tokendata:TokenType"
          minOccurs="0" maxOccurs="10" /&gt;
         &lt;element name="fax"   type="enum-tokendata:TokenType"
          minOccurs="0" maxOccurs="10" /&gt;
         &lt;element name="email" type="enum-tokendata:TokenType"
          minOccurs="0" maxOccurs="10" /&gt;
       &lt;/sequence&gt;
     &lt;/group&gt;

     &lt;complexType name="contactType"&gt;
       &lt;sequence&gt;
         &lt;group ref="enum-tokendata:tokenContactBaseGroup"/&gt;
       &lt;/sequence&gt;
     &lt;/complexType&gt;

     &lt;complexType name="tokenDataType"&gt;
       &lt;sequence&gt;
         &lt;element name="contact" type="enum-tokendata:contactType"/&gt;
       &lt;/sequence&gt;
     &lt;/complexType&gt;

   &lt;/schema&gt;
   END

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/7.%20%20Other%20Applications%20of%20the%20Token%20Concept"></a><a class="selflink" href="#section-7" id="section-7">7</a>.  Other Applications of the Token Concept</span>

   The concept of the validation token may be useful in other
   registry-type applications where the proof of an underlying right is
   a condition for a valid registration.

   An example is a Top Level Domain (TLD) where registration is subject
   to proof of some precondition, like a trade mark or the right in a
   name.  Such situations often arise during the introduction of a new
   TLD, e.g., during a "sunrise" phase.

   A Number Portability (NP) database faces very similar verification
   issues.  An NP system based on the Token concept could potentially be
   superior to current methods, and aid in the convergence of NP and
   ENUM.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/8.%20%20IANA%20Considerations"></a><a class="selflink" href="#section-8" id="section-8">8</a>.  IANA Considerations</span>

   This document uses Uniform Resource Names (URNs) to describe XML
   namespaces and XML schemas conforming to a registry mechanism
   described in <a href="./rfc3688">RFC 3688</a> [<a href="#ref-12" title='"The IETF XML Registry"'>12</a>].  IANA has made the following four URI
   assignments.





<span class="grey">Lendl                       Standards Track                    [Page 12]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-13"></span>
<span class="grey"><a href="./rfc5105">RFC 5105</a>                 ENUM Validation Token             December 2007</span>


   1.  Registration for the Token namespace:
       *  URI: urn:ietf:params:xml:ns:enum-token-1.0
       *  Registrant Contact: See the "Author's Address" section of this
          document.
       *  XML: None.  Namespace URIs do not represent an XML
          specification.

   2.  Registration for the Token XML schema:
       *  URI: urn:ietf:params:xml:schema:enum-token-1.0
       *  Registrant Contact: See the "Author's Address" section of this
          document.
       *  XML: See <a href="#section-6.1">Section 6.1</a> of this document.

   3.  Registration for the Token Data namespace:
       *  URI: urn:ietf:params:xml:ns:enum-tokendata-1.0
       *  Registrant Contact: See the "Author's Address" section of this
          document.
       *  XML: None.  Namespace URIs do not represent an XML
          specification.

   4.  Registration for the Token Data XML schema:
       *  URI: urn:ietf:params:xml:schema:enum-tokendata-1.0
       *  Registrant Contact: See the "Author's Address" section of this
          document.
       *  XML: See <a href="#section-6.2">Section 6.2</a> of this document.

   The IDs used in the validationEntityID, RegistrarID, and methodID
   elements are subject to local policy and thus do not require IANA
   registration.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/9.%20%20Security%20Considerations"></a><a class="selflink" href="#section-9" id="section-9">9</a>.  Security Considerations</span>

   The security of the Validation Token depends on the security of the
   underlying XML DSIG algorithms.  As such, all the security
   considerations from [<a href="#ref-4" title='"(Extensible Markup Language) XML-Signature Syntax and Processing"'>4</a>] apply here as well.  Two points from [<a href="#ref-4" title='"(Extensible Markup Language) XML-Signature Syntax and Processing"'>4</a>]
   merit repetition:

   Transforms are used to select the relevant data for signing and
   discarding irrelevant information (e.g., pretty-printing and
   name-space local names).

   The &lt;Reference URI="#TOKEN"&gt; element and attribute combined with the
   Id="TOKEN" attribute in &lt;token&gt; specifies that the signature should
   cover the complete token.  Moving the Id="TOKEN" attribute to e.g.,
   the &lt;tokendata&gt; element would make the signature worthless.






<span class="grey">Lendl                       Standards Track                    [Page 13]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-14"></span>
<span class="grey"><a href="./rfc5105">RFC 5105</a>                 ENUM Validation Token             December 2007</span>


   It is thus critical that the Registry not only checks whether the
   Token passes a generic XML-DSIG signature check, but also that:

      1.  the signature uses approved transforms and cryptographic
          algorithms.
      2.  the signature references the &lt;token&gt; element.
      3.  the key used in the signature belongs to an accredited VE.

   The Token content is not encrypted.  If local policy dictates that
   the information contained within the token should be confidential,
   then this has to be handled through a different mechanism.

   When processing a delegation request, the Registry MUST verify that
   the information contained in the Token matches the delegation
   request.  The &lt;registrarID&gt; element in the Token prevents a malicious
   second Registrar from using an eavesdropped Token to register a
   domain in his name.  The Registry MUST verify that the
   &lt;expirationDate&gt; given (including the case of no given expiration
   date) conforms to the Registry's policy.  To avert replay attacks,
   local policy MUST specify how long after &lt;executionDate&gt; the Token
   can be used to authorize a delegation.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/10.%20%20Acknowledgements"></a><a class="selflink" href="#section-10" id="section-10">10</a>.  Acknowledgements</span>

   The author would like to thank the following persons for their
   valuable suggestions and contributions: Michael Haberler, Alexander
   Mayrhofer, Bernie Hoeneisen, Michael Braunoeder, Staffan Hagnell,
   Lawrence Conroy, and Tony Rutkowski.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/11.%20%20References"></a><a class="selflink" href="#section-11" id="section-11">11</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/11.1.%20%20Normative%20References"></a><a class="selflink" href="#section-11.1" id="section-11.1">11.1</a>.  Normative References</span>

   [<a id="ref-1">1</a>]   Faltstrom, P. and M. Mealling, "The E.164 to Uniform Resource
         Identifiers (URI) Dynamic Delegation Discovery System (DDDS)
         Application (ENUM)", <a href="./rfc3761">RFC 3761</a>, April 2004.

   [<a id="ref-2">2</a>]   ITU-T, "The international public telecommunication numbering
         plan", Recommendation E.164, May 1997.

   [<a id="ref-3">3</a>]   Bradner, S., "Key words for use in RFCs to Indicate Requirement
         Levels", <a href="https://www.rfc-editor.org/bcp/bcp14">BCP 14</a>, <a href="./rfc2119">RFC 2119</a>, March 1997.

   [<a id="ref-4">4</a>]   Eastlake 3rd, D., Reagle, J., and D. Solo, "(Extensible Markup
         Language) XML-Signature Syntax and Processing", <a href="./rfc3275">RFC 3275</a>, March
         2002.





<span class="grey">Lendl                       Standards Track                    [Page 14]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-15"></span>
<span class="grey"><a href="./rfc5105">RFC 5105</a>                 ENUM Validation Token             December 2007</span>


   [<a id="ref-5">5</a>]   Eastlake 3rd, D., "Additional XML Security Uniform Resource
         Identifiers (URIs)", <a href="./rfc4051">RFC 4051</a>, April 2005.

   [<a id="ref-6">6</a>]   Klyne, G. and C. Newman, "Date and Time on the Internet:
         Timestamps", <a href="./rfc3339">RFC 3339</a>, July 2002.

   [<a id="ref-7">7</a>]   Maloney, M., Beech, D., Mendelsohn, N., and H. Thompson, "XML
         Schema Part 1: Structures", W3C REC REC-xmlschema-1-20010502,
         May 2001.

   [<a id="ref-8">8</a>]   Malhotra, A. and P. Biron, "XML Schema Part 2: Datatypes", W3C
         REC REC-xmlschema-2-20010502, May 2001.

   [<a id="ref-9">9</a>]   Eastlake, D., Boyer, J., and J. Reagle, "Exclusive XML
         Canonicalization Version 1.0", W3C REC REC-xml-exc-c14n-
         20020718, July 2002.

   [<a id="ref-10">10</a>]  International Telecommunications Union, "Information technology
         - Open Systems Interconnection - The Directory: Public-key and
         attribute certificate frameworks", ITU-T Recommendation X.509,
         ISO Standard 9594-8, March 2000.

   [<a id="ref-11">11</a>]  International Organization for Standardization, "Codes for the
         representation of names of countries and their subdivisions --
         Part 1: Country codes, 2nd edition", ISO Standard 3166,
         November 2006.

   [<a id="ref-12">12</a>]  Mealling, M., "The IETF XML Registry", <a href="https://www.rfc-editor.org/bcp/bcp81">BCP 81</a>, <a href="./rfc3688">RFC 3688</a>,
         January 2004.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/11.2.%20%20Informative%20References"></a><a class="selflink" href="#section-11.2" id="section-11.2">11.2</a>.  Informative References</span>

   [<a id="ref-13">13</a>]  Hollenbeck, S., "Extensible Provisioning Protocol (EPP)", <a href="./rfc4930">RFC</a>
         <a href="./rfc4930">4930</a>, May 2007.

   [<a id="ref-14">14</a>]  Schaad, J., Kaliski, B., and R. Housley, "Additional Algorithms
         and Identifiers for RSA Cryptography for use in the Internet
         X.509 Public Key Infrastructure Certificate and Certificate
         Revocation List (CRL) Profile", <a href="./rfc4055">RFC 4055</a>, June 2005.

   [<a id="ref-15">15</a>]   Mayrhofer, A. and B. Hoeneisen, "ENUM Validation
         Architecture", <a href="./rfc4725">RFC 4725</a>, November 2006.

   [<a id="ref-16">16</a>]  Hoeneisen, B., "ENUM Validation Information Mapping for the
         Extensible Provisioning Protocol", <a href="./rfc5076">RFC 5076</a>, December 2007.

   [<a id="ref-17">17</a>]  ITU-T, "Computerized Directory Assistance Version 2",
         Recommendation E.115v2, October 2005.



<span class="grey">Lendl                       Standards Track                    [Page 15]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-16"></span>
<span class="grey"><a href="./rfc5105">RFC 5105</a>                 ENUM Validation Token             December 2007</span>


Author's Address

   Otmar Lendl
   enum.at GmbH
   Karlsplatz 1/2/9
   Wien  A-1010
   Austria

   Phone: +43 1 5056416 33
   EMail: otmar.lendl@enum.at
   URI:   <a href="http://www.enum.at/">http://www.enum.at/</a>








































<span class="grey">Lendl                       Standards Track                    [Page 16]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-17"></span>
<span class="grey"><a href="./rfc5105">RFC 5105</a>                 ENUM Validation Token             December 2007</span>


Full Copyright Statement

   Copyright (C) The IETF Trust (2007).

   This document is subject to the rights, licenses and restrictions
   contained in <a href="https://www.rfc-editor.org/bcp/bcp78">BCP 78</a>, and except as set forth therein, the authors
   retain all their rights.

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST AND
   THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS
   OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF
   THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

Intellectual Property

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in <a href="https://www.rfc-editor.org/bcp/bcp78">BCP 78</a> and <a href="https://www.rfc-editor.org/bcp/bcp79">BCP 79</a>.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   <a href="http://www.ietf.org/ipr">http://www.ietf.org/ipr</a>.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at
   ietf-ipr@ietf.org.












Lendl                       Standards Track                    [Page 17]
</pre>
</body></html>