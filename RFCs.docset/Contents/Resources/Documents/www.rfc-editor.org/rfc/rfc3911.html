<html><head></head><body><pre>Network Working Group                                            R. Mahy
Request for Comments: 3911                                     Airespace
Category: Standards Track                                      D. Petrie
                                                                 Pingtel
                                                            October 2004


          <span class="h1">The Session Initiation Protocol (SIP) "Join" Header</span>

Status of this Memo

   This document specifies an Internet standards track protocol for the
   Internet community, and requests discussion and suggestions for
   improvements.  Please refer to the current edition of the "Internet
   Official Protocol Standards" (STD 1) for the standardization state
   and status of this protocol.  Distribution of this memo is unlimited.

Copyright Notice

   Copyright (C) The Internet Society (2004).

Abstract

   This document defines a new header for use with SIP multi-party
   applications and call control.  The Join header is used to logically
   join an existing SIP dialog with a new SIP dialog.  This primitive
   can be used to enable a variety of features, for example: "Barge-In",
   answering-machine-style "Message Screening" and "Call Center
   Monitoring".  Note that definition of these example features is non-
   normative.

Table of Contents

   <a href="#section-1">1</a>.   Introduction . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-2">2</a>
   <a href="#section-2">2</a>.   Conventions  . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-3">3</a>
   <a href="#section-3">3</a>.   Applicability of <a href="./rfc2804">RFC 2804</a> ("Raven"). . . . . . . . . . . . .   <a href="#page-3">3</a>
   <a href="#section-4">4</a>.   User Agent Server Behavior: Receiving a Join Header  . . . .   <a href="#page-4">4</a>
   <a href="#section-5">5</a>.   User Agent Client Behavior: Sending a Join header  . . . . .   <a href="#page-6">6</a>
   <a href="#section-6">6</a>.   Proxy behavior . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-7">7</a>
   <a href="#section-7">7</a>.   Syntax . . . . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-7">7</a>
        <a href="#section-7.1">7.1</a>.  The Join Header  . . . . . . . . . . . . . . . . . . .   <a href="#page-7">7</a>
        <a href="#section-7.2">7.2</a>.  New option tag for Require and Supported headers . . .   <a href="#page-8">8</a>
   <a href="#section-8">8</a>.   Usage Examples . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-8">8</a>
        8.1.  Join accepted and transitioned to central conference .   9
        <a href="#section-8.2">8.2</a>.  Join rejected  . . . . . . . . . . . . . . . . . . . .  <a href="#page-12">12</a>
   <a href="#section-9">9</a>.   Security Considerations  . . . . . . . . . . . . . . . . . .  <a href="#page-13">13</a>
   <a href="#section-10">10</a>.  IANA Considerations  . . . . . . . . . . . . . . . . . . . .  <a href="#page-14">14</a>
        <a href="#section-10.1">10.1</a>. Registration of "Join" SIP header. . . . . . . . . . .  <a href="#page-14">14</a>



<span class="grey">Mahy &amp; Petrie               Standards Track                     [Page 1]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-2"></span>
<span class="grey"><a href="./rfc3911">RFC 3911</a>                        SIP Join                    October 2004</span>


        <a href="#section-10.2">10.2</a>. Registration of "join" SIP Option-tag. . . . . . . . .  <a href="#page-14">14</a>
   <a href="#section-11">11</a>.  Acknowledgments  . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-14">14</a>
   <a href="#section-12">12</a>.  References . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-14">14</a>
        <a href="#section-12.1">12.1</a>. Normative References . . . . . . . . . . . . . . . . .  <a href="#page-14">14</a>
        <a href="#section-12.2">12.2</a>. Informative References . . . . . . . . . . . . . . . .  <a href="#page-15">15</a>
   <a href="#section-13">13</a>.  Authors' Addresses . . . . . . . . . . . . . . . . . . . . .  <a href="#page-16">16</a>
   <a href="#section-14">14</a>.  Full Copyright Statement . . . . . . . . . . . . . . . . . .  <a href="#page-17">17</a>

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/1.%20Introduction"></a><a class="selflink" href="#section-1" id="section-1">1</a>. Introduction</span>

   This document describes a SIP [<a href="#ref-1" title='"SIP: Session Initiation Protocol"'>1</a>] extension header field as part of
   the SIP multiparty applications architecture framework [<a href="#ref-12" title='"A Call Control and Multi-party usage framework for the Session Initiation Protocol (SIP)"'>12</a>].  The
   Join header is used to logically join an existing SIP dialog with a
   new SIP dialog.  This is especially useful in peer-to-peer call
   control environments.

   One use of the "Join" header is to insert a new participant into a
   multimedia conversation (which may be a two-party call or a SIP
   conference [<a href="#ref-15" title='"A Framework for Conferencing with the Session Initiation Protocol"'>15</a>]).  While this functionality is already available
   using 3rd party call control [<a href="#ref-17" title='"Best Current Practices for Third Party Call Control (3pcc) in the Session Initiation Protocol (SIP)"'>17</a>], style call control, the 3pcc model
   requires a central point of control which may not be desirable in
   many environments.  As such, a method of performing these same call
   control primitives in a distributed, peer-to-peer fashion is very
   desirable.

   Use of an explicit Join header is needed in some cases instead of
   addressing an INVITE to a conference URI for the following reasons:

   o  A conference may not yet exist--the new invitation may be trying
      to join an ordinary two-party call.

   o  The party joining may not know if the dialog it wants to join is
      part of a conference.

   o  The party joining may not know the conference URI.

   The Join header enables services such as barge-in, real-time message
   screening, and call center monitoring in a distributed peer-to-peer
   way.  This list of services is not exhaustive.

   For example, the Boss has an established 2-party conversation with a
   Customer, and using some out-of-band mechanism (e.g., voice,
   gestures, or email) asks an Assistant to join the conversation.  The
   Assistant sends an INVITE with a Join header to the Boss with the
   dialog information for the established dialog.  The Assistant
   obtained this information from some other mechanism, for example a
   web-page, an instant message, or from the SIP session dialog package
   [<a href="#ref-13" title='"An INVITE Initiated Dialog Event Package for the Session Initiation Protocol (SIP)"'>13</a>].



<span class="grey">Mahy &amp; Petrie               Standards Track                     [Page 2]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-3"></span>
<span class="grey"><a href="./rfc3911">RFC 3911</a>                        SIP Join                    October 2004</span>


   Assistant     Boss        Customer
   | callid: 4@A |  callid: 7@c |
   |             |              |
   |             |&lt;============&gt;|
   |             |              |
   |INVITE------&gt;|              |
   |Join: 7@c    |              |
   |             |reINVITE-----&gt;|
   |&lt;----200-----|&lt;----200------|
   |-----ACK----&gt;|&lt;----ACK------|
   |             |              |
   |   .. begins mixing ..      |
   |             |              |
   |&lt;===========&gt;|&lt;============&gt;|
   |&lt;::::::::::::::::::::::::::&gt;|

   Note that this operation effectively creates a new conference.  The
   Boss needs to cause a new conference to start (and consequently
   create or obtain a new conference URI).   In our example, the Boss
   mixes all media locally, so it needs to generate a new conference
   URI, return the conference URI as the Contact to the Join INVITE
   (with the "isfocus" Contact header field parameter as defined in [<a href="#ref-6" title='"Indicating User Agent Capabilities in the Session Initiation Protocol (SIP)"'>6</a>],
   and reINVITE or UPDATE [<a href="#ref-22" title='"The Session Initiation Protocol (SIP) UPDATE Method"'>22</a>] the Customer with the conference URI as
   the new Contact.  This scenario is also discussed in more detail in
   [<a href="#ref-16" title='"Session Initiation Protocol Call Control - Conferencing for User Agents"'>16</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/2.%20%20Conventions"></a><a class="selflink" href="#section-2" id="section-2">2</a>.  Conventions</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED",  "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in <a href="./rfc2119">RFC 2119</a> [<a href="#ref-2" title='"Key words for use in RFCs to Indicate Requirement Levels"'>2</a>].

   This document refers frequently to the terms "confirmed dialog" and
   "early dialog".  These are defined in <a href="#section-12">Section 12</a> of SIP [<a href="#ref-1" title='"SIP: Session Initiation Protocol"'>1</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.%20%20Applicability%20of%20RFC%202804%20%28%22Raven%22%29"></a><a class="selflink" href="#section-3" id="section-3">3</a>.  Applicability of <a href="./rfc2804">RFC 2804</a> ("Raven")</span>

   This primitive can be used to create services which are used for
   monitoring purposes, however these services do not meet the
   definition of a wiretap according to <a href="./rfc2804">RFC 2804</a> [<a href="#ref-14" title='"IETF Policy on Wiretapping"'>14</a>].  The definition
   from <a href="./rfc2804">RFC 2804</a> is included here:

      Wiretapping is what occurs when information passed across the
      Internet from one party to one or more other parties is delivered
      to a third party:

      1. Without the sending party knowing about the third party




<span class="grey">Mahy &amp; Petrie               Standards Track                     [Page 3]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-4"></span>
<span class="grey"><a href="./rfc3911">RFC 3911</a>                        SIP Join                    October 2004</span>


      2. Without any of the recipient parties knowing about the delivery
         to the third party

      3. When the normal expectation of the sender is that the
         transmitted information will only be seen by the recipient
         parties or parties obliged to keep the information in
         confidence

      4. When the third party acts deliberately to target the
         transmission of the first party, either because he is of
         interest, or because the second party's reception is of
         interest.

   Specifically, item 2 of this definition does not apply to this
   extension, as one party is always aware of a Join request and can
   even decline such requests.  In addition, in many applications of
   this primitive, some or all of the other items may not apply.  For
   example, in many call centers which handle financial transactions,
   all conversations are recorded with the full knowledge and
   expectation of all parties involved.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/4.%20%20User%20Agent%20Server%20Behavior%3A%20Receiving%20a%20Join%20Header"></a><a class="selflink" href="#section-4" id="section-4">4</a>.  User Agent Server Behavior: Receiving a Join Header</span>

   The Join header contains information used to match an existing SIP
   dialog (call-id, to-tag, and from-tag).  Upon receiving an INVITE
   with a Join header, the UA attempts to match this information with a
   confirmed or early dialog.  The to-tag and from-tag parameters are
   matched as if they were tags present in an incoming request.  In
   other words the to-tag parameter is compared to the local tag, and
   the from-tag parameter is compared to the remote tag.

   If more than one Join header field is present in an INVITE, or if a
   Join header field is present in a request other than INVITE, the UAS
   MUST reject the request with a 400 Bad Request response.

   The Join header has specific call control semantics.  If both a Join
   header field and another header field with contradictory semantics
   (for example a Replaces [<a href="#ref-8" title='"The Session Initiation Protocol (SIP) "'>8</a>] header field) are present in a request,
   the request MUST be rejected with a 400 "Bad Request" response.

   If the Join header field matches more than one dialog, the UA MUST
   act as if no match is found.

   If no match is found, but the Request-URI in the INVITE corresponds
   to a conference URI, the UAS MUST ignore the Join header and continue
   processing the INVITE as if the Join header did not exist.  This
   allows User Agents which receive an INVITE with Join to redirect the
   request directly to a conference URI.



<span class="grey">Mahy &amp; Petrie               Standards Track                     [Page 4]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-5"></span>
<span class="grey"><a href="./rfc3911">RFC 3911</a>                        SIP Join                    October 2004</span>


   Otherwise if no match is found, the UAS rejects the INVITE and
   returns a 481 Call/Transaction Does Not Exist response.  Likewise, if
   the Join header field matches a dialog which was not created with an
   INVITE, the UAS MUST reject the request with a 481 response.

   If the Join header field matches a dialog which has already
   terminated, the UA SHOULD decline the request with a 603 Declined
   response.

   If the Join header field matches an active dialog (n.b. unlike the
   Replaces header, the Join header has no limitation on its use with
   early dialogs), the UA MUST verify that the initiator of the new
   INVITE is authorized to join the matched dialog.  If the initiator of
   the new INVITE has authenticated successfully as equivalent to the
   user who is being joined, then the join is authorized.  For example,
   if the user being joined and the initiator of the joining dialog
   share the same credentials for Digest authentication [<a href="#ref-4" title='"HTTP Authentication: Basic and Digest Access Authentication"'>4</a>], or they
   sign the join request with S/MIME [<a href="#ref-5" title='"Secure/Multipurpose Internet Mail Extensions (S/MIME) Version 3.1 Message Specification"'>5</a>] with the same private key and
   present the (same) corresponding certificate used in the original
   dialog, then the join is authorized.

   Alternatively, the Referred-By mechanism [<a href="#ref-9" title='"The Session Initiation Protocol (SIP) Referred-By Mechanism"'>9</a>] defines a mechanism that
   the UAS can use to verify that a join request was sent on behalf of
   the other participant in the matched dialog (in this case, triggered
   by a REFER request).  If the join request contains a Referred-By
   header which corresponds to the user being joined, the UA SHOULD
   treat the join as if it was authorized by the joined party.  The
   Referred-By header MUST reference a corresponding, valid Refererred-
   By Authenticated Identity Body [<a href="#ref-10" title='"Session Initiation Protocol (SIP) Authenticated Identity Body (AIB) Format"'>10</a>].  The UA MAY apply other local
   policy to authorize the remainder of the request.  In other words,
   the UAS may apply different policy to the joined dialog than was
   applied to the target dialog.

   The UA MAY also maintain a list of authorized entities who are
   allowed to join any dialog with certain characteristics (for example,
   all dialogs placed in the call center context of the UA).  In
   addition, the UA MAY use other authorization mechanisms defined for
   this purpose in standards track extensions.  For example, an
   extension could define a mechanism for transitively asserting
   authorization of a join.

   If authorization is successful, the UA attempts to accept the new
   INVITE, and assign any mixing or conferencing resources necessary to
   complete the join.  If the UA cannot accept the new INVITE (for
   example: it cannot establish required QoS or keying, or it has
   incompatible media), the UA MUST return an appropriate error response
   and MUST leave the matched dialog unchanged.




<span class="grey">Mahy &amp; Petrie               Standards Track                     [Page 5]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-6"></span>
<span class="grey"><a href="./rfc3911">RFC 3911</a>                        SIP Join                    October 2004</span>


   A User Agent that accepts a Join header needs to setup dialogs or
   conferences such that the requesting UAC is logically added to the
   conversation space associated with the matched dialog.  Any dialogs
   which are already logically associated with the matched dialog in the
   same conversation space are included as well.  For a detailed
   description of various conferencing mechanisms that could be used to
   handle a Join, please consult the SIP conferencing framework [<a href="#ref-15" title='"A Framework for Conferencing with the Session Initiation Protocol"'>15</a>].

   If the UAS has sufficient resources to locally handle the Join
   request, the UAS SHOULD accept the Join request and perform the
   appropriate media mixing or combining.  The UAS MAY rearrange
   appropriate dialogs instead as described below, based on some local
   policy.

   If the UAS does not have sufficient resources locally to handle the
   request, or does not wish to use these local resources, but is aware
   of other resources which could be used to satisfy the request (e.g.,
   a centralized conference server), the UA SHOULD create a conference
   using this resource (e.g., INVITE the conference server to obtain a
   conference URI), redirect the requestor to this resource, and request
   other participants in the same conversation space to use this
   resource.  The UA MAY use any appropriate mechanism to transition
   participants to the new resource (e.g., 3xx response, 3rd-party call
   control reinvitiations, REFER requests, or reinvitations to a
   multicast group).  The UA SHOULD only use mechanisms which are
   expected to be acceptable to the other participants.  For example,
   the UA SHOULD NOT attempt to transition the participants to a
   multicast group unless the UA can reasonably expect that all the
   participants can support multicast.

   If the UAS is incapable of satisfying the Join request, it MUST
   return a 488 "Not Acceptable Here" response.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.%20%20User%20Agent%20Client%20Behavior%3A%20Sending%20a%20Join%20header"></a><a class="selflink" href="#section-5" id="section-5">5</a>.  User Agent Client Behavior: Sending a Join header</span>

   A User Agent that wishes to add a new dialog of its own to a single
   existing early or confirmed dialog and any associated dialogs or
   conferences, MAY send the target User Agent an INVITE request
   containing a Join header field.  The UAC places the Call-ID, to-tag,
   and from-tag information for the target dialog in a single Join
   header field and sends the new INVITE to the target.

   If the User Agent receives a 300-class response, and acts on this
   response by sending an INVITE to a Contact in the response, this
   redirected INVITE MUST contain the same Join header which was present
   in the original request.  Although this is unusual, this allows
   INVITE requests with a Join header to be redirected before reaching
   the target UAS.



<span class="grey">Mahy &amp; Petrie               Standards Track                     [Page 6]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-7"></span>
<span class="grey"><a href="./rfc3911">RFC 3911</a>                        SIP Join                    October 2004</span>


   Note that use of the Join mechanism does not provide a way to match
   multiple dialogs, nor does it provide a way to match an entire call,
   an entire transaction, or to follow a chain of proxy forking logic.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/6.%20%20Proxy%20behavior"></a><a class="selflink" href="#section-6" id="section-6">6</a>.  Proxy behavior</span>

   Proxy Servers do not require any new behavior to support this
   extension.  They simply pass the Join header field transparently as
   described in the SIP specification.

   Note that it is possible for a proxy (especially when forking based
   on some application layer logic, such as caller screening or time-
   of-day routing) to forward an INVITE request containing a Join header
   field to a completely orthogonal set of Contacts than the original
   request it was intended to replace.  In this case, the INVITE request
   with the Join header field will fail.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/7.%20%20Syntax"></a><a class="selflink" href="#section-7" id="section-7">7</a>.  Syntax</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/7.1.%20%20The%20Join%20Header"></a><a class="selflink" href="#section-7.1" id="section-7.1">7.1</a>.  The Join Header</span>

   The Join header field indicates that a new dialog (created by the
   INVITE in which the Join header field in contained) should be joined
   with a dialog identified by the header field, and any associated
   dialogs or conferences.  It is a request header only, and defined
   only for INVITE requests.  The Join header field MAY be encrypted as
   part of end-to-end encryption.  Only a single Join header field value
   may be present in a SIP request

   This document adds the following entry to Table 3 of [<a href="#ref-1" title='"SIP: Session Initiation Protocol"'>1</a>].  Additions
   to this table are also provided for extension methods defined at the
   time of publication of this document.  This is provided as a courtesy
   to the reader and is not normative in any way.  MESSAGE, SUBSCRIBE
   and NOTIFY, REFER, INFO, UPDATE, PRACK, and PUBLISH are defined
   respectively in [<a href="#ref-19" title='"Session Initiation Protocol (SIP) Extension for Instant Messaging"'>19</a>], [<a href="#ref-20" title='"Session Initiation Protocol (SIP)-Specific Event Notification"'>20</a>], [<a href="#ref-7" title='"The Session Initiation Protocol (SIP) Refer Method"'>7</a>], [<a href="#ref-21" title='"The SIP INFO Method"'>21</a>], [<a href="#ref-22" title='"The Session Initiation Protocol (SIP) UPDATE Method"'>22</a>], [<a href="#ref-23" title='"Reliability of Provisional Responses in Session Initiation Protocol (SIP)"'>23</a>], and [<a href="#ref-24" title='"SIMPLE Presence Publication Mechanism"'>24</a>].

   Header field    where   proxy   ACK  BYE  CAN  INV  OPT  REG  MSG
   ------------    -----   -----   ---  ---  ---  ---  ---  ---  ---
   Join              R              -    -    -    o    -    -    -


                                   SUB  NOT  REF  INF  UPD  PRA  PUB
                                   ---  ---  ---  ---  ---  ---  ---
   Join              R              -    -    -    -    -    -    -







<span class="grey">Mahy &amp; Petrie               Standards Track                     [Page 7]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-8"></span>
<span class="grey"><a href="./rfc3911">RFC 3911</a>                        SIP Join                    October 2004</span>


   The following syntax specification uses the augmented Backus-Naur
   Form (BNF) as described in <a href="./rfc2234">RFC 2234</a> [<a href="#ref-3" title='"Augmented BNF for Syntax Specifications: ABNF"'>3</a>].

      Join            = "Join" HCOLON callid *(SEMI join-param)
      join-param      = to-tag / from-tag / generic-param
      to-tag          = "to-tag" EQUAL token
      from-tag        = "from-tag" EQUAL token

   A Join header MUST contain exactly one to-tag and exactly one from-
   tag, as they are required for unique dialog matching.  For
   compatibility with dialogs initiated by <a href="./rfc2543">RFC 2543</a> [<a href="#ref-11" title='"SIP: Session Initiation Protocol"'>11</a>] compliant UAs,
   a to-tag of zero matches both a to-tag value of zero and a null to-
   tag.  Likewise, a from-tag of zero matches both a to-tag value of
   zero and a null from-tag.

   Examples:

      Join: 98732@sip.example.com
             ;from-tag=r33th4x0r
             ;to-tag=ff87ff

      Join: 12adf2f34456gs5;to-tag=12345;from-tag=54321

      Join: 87134@192.0.2.23;to-tag=24796;from-tag=0

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/7.2.%20%20New%20option%20tag%20for%20Require%20and%20Supported%20headers"></a><a class="selflink" href="#section-7.2" id="section-7.2">7.2</a>.  New option tag for Require and Supported headers</span>

   This specification defines a new Require/Supported header option tag
   "join".  UAs which support the Join header MUST include the "join"
   option tag in a Supported header field.  UAs that want explicit
   failure notification if Join is not supported MAY include the "join"
   option in a Require header field.

   Example:

      Require: join, 100rel

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/8.%20%20Usage%20Examples"></a><a class="selflink" href="#section-8" id="section-8">8</a>.  Usage Examples</span>

   The following non-normative examples are not intended to enumerate
   all the possibilities for the usage of this extension, but rather to
   provide examples or ideas only.  For more examples, please see
   service-examples [<a href="#ref-18" title='"Session Initiation Protocol Service Examples"'>18</a>].








<span class="grey">Mahy &amp; Petrie               Standards Track                     [Page 8]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-9"></span>
<span class="grey"><a href="./rfc3911">RFC 3911</a>                        SIP Join                    October 2004</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/8.1.%20%20Join%20accepted%20and%20transitioned%20to%20central%20conference"></a><a class="selflink" href="#section-8.1" id="section-8.1">8.1</a>.  Join accepted and transitioned to central conference</span>

   A             B              C            conf
   |             |  callid: 7@c |              |
   |             |              |              |
   |             |&lt;-INVITE------|              | *1
   |             |-----200-----&gt;|              | *2
   |             |&lt;----ACK------|              | *3
   |             |&lt;============&gt;|              |
   |             |              |              |
   |INVITE------&gt;|              |              | *4
   |Join: 7@c    |--INVITE--------------------&gt;| *5
   |             |&lt;----200---------------------| *6
   |             |-----ACK--------------------&gt;|
   |&lt;----302-----|              |              | *7
   |-----ACK----&gt;|              |              |
   |INVITE------------------------------------&gt;| *8
   |&lt;--200-------------------------------------| *9
   |---ACK------------------------------------&gt;|
   |             |--REFER------&gt;|              | *10
   |             |&lt;---202-------|              |
   |             |&lt;--NOTIFY-----|--INVITE-*11-&gt;|
   |             |------200----&gt;|&lt;----200-*12--|
   |             |&lt;--NOTIFY-----|-----ACK-----&gt;|
   |             |------200----&gt;|              |
   |             |---BYE-------&gt;|              |
   |             |&lt;--200--------|              |
   |             |              |              |
   |&lt;=========================================&gt;| mixes the
   |             |&lt;===========================&gt;| three sessions
   |             |              |&lt;============&gt;| together

   The conversation now appears identical to the locally mixed one from
   the example in the Introduction.  Details of how the Join are
   implemented are transparent to A.  B could have used 3rd party call
   control instead to move the necessary sessions.

   Message *1: C -&gt; B

   INVITE sip:bob@example.org SIP/2.0
   To: &lt;bob@example.org&gt;
   From: &lt;carol@example.org&gt;;tag=xyz
   Call-Id: 7@c.example.org
   CSeq 1 INVITE
   Contact: &lt;sip:carol@c.example.org&gt;






<span class="grey">Mahy &amp; Petrie               Standards Track                     [Page 9]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-10"></span>
<span class="grey"><a href="./rfc3911">RFC 3911</a>                        SIP Join                    October 2004</span>


   Message *2: B -&gt; C

   SIP/2.0 200 OK
   To: &lt;bob@example.org&gt;;tag=pdq
   From: &lt;carol@example.org&gt;;tag=xyz
   Call-Id: 7@c.example.org
   CSeq 1 INVITE
   Contact: &lt;sip:bob@b.example.org&gt;


   Message *3: C -&gt; B

   ACK sip:carol@c.example.org SIP/2.0
   To: &lt;bob@example.org&gt;;tag=pdq
   From: &lt;carol@example.org&gt;;tag=xyz
   Call-Id: 7@c.example.org
   CSeq 1 INVITE


   Message *4: A -&gt;  B

   INVITE sip:bob@b.example.org SIP/2.0
   To: &lt;sip:bob@example.org&gt;
   From: &lt;sip:alice@example.org&gt;;tag=iii
   Call-Id: 777@a.example.org
   CSeq: 1 INVITE
   Contact: &lt;sip:alice@a.example.org&gt;
   Join: 7@c.example.org;to-tag=xyz;from-tag=pdq


   Message *5: B -&gt; conf

   INVITE sip:conf-factory@example.org SIP/2.0
   To: &lt;sip:conf-factory@example.org&gt;
   From: &lt;sip:bob@example.org&gt;;tag=abc
   Call-Id: 999@b.example.org
   CSeq: 1INVITE
   Contact: &lt;sip:bob@b.example.org&gt;


   Message *6: conf -&gt; B

   SIP/2.0 200 OK
   To: &lt;sip:conf-factory@example.org&gt;;tag=def
   From: &lt;sip:bob@example.org&gt;;tag=abc
   Call-Id: 999@b.example.org
   CSeq: 1INVITE
   Contact: &lt;sip:conf456@conf-srv2.example.org&gt;;isfocus



<span class="grey">Mahy &amp; Petrie               Standards Track                    [Page 10]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-11"></span>
<span class="grey"><a href="./rfc3911">RFC 3911</a>                        SIP Join                    October 2004</span>


   Message *7: B -&gt; A

   SIP/2.0 302 Moved Temporarily
   To: &lt;sip:bob@example.org&gt;
   From: &lt;sip:alice@example.org&gt;;tag=iii
   Call-Id: 777@a.example.org
   CSeq: 1 INVITE
   Contact: &lt;sip:conf456@conf-srv2.example.org&gt;;isfocus


   Message *8: A -&gt; conf

   INVITE sip:conf456@conf-srv2.example.org SIP/2.0
   To: &lt;sip:bob@example.org&gt;
   From: &lt;sip:alice@example.org&gt;;tag=iii
   Call-Id: 777@a.example.org
   CSeq: 2 INVITE
   Contact: &lt;sip:alice@a.example.org&gt;
   Join: 7@c.example.org;to-tag=xyz;from-tag=pdq


   Message *9: conf -&gt;A

   SIP/2.0 200 OK
   To: &lt;sip:bob@example.org&gt;;tag=jjj
   From: &lt;sip:alice@example.org&gt;;tag=iii
   Call-Id: 777@a.example.org
   CSeq: 2 INVITE
   Contact: &lt;sip:conf456@conf-srv2.example.org&gt;;isfocus


   Message *10: B -&gt; C

   REFER sip:carol@c.example.org SIP/2.0
   To: &lt;carol@example.org&gt;;tag=xyz
   From: &lt;bob@example.org&gt;;tag=pdq
   Call-Id: 7@c.example.org
   CSeq: 1 REFER
   Contact: &lt;sip:bob@b.example.org&gt;
   Refer-To: &lt;sip:conf456@conf-srv2.example.org&gt;
   Referred-By: &lt;sip:bob@b.example.org&gt;


   Message *11: C -&gt; conf

   INVITE sip:conf456@conf-srv2.example.org SIP/2.0
   To: &lt;sip:conf456@conf-srv2.example.org&gt;
   From: &lt;carol@example.org&gt;;tag=mmm



<span class="grey">Mahy &amp; Petrie               Standards Track                    [Page 11]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-12"></span>
<span class="grey"><a href="./rfc3911">RFC 3911</a>                        SIP Join                    October 2004</span>


   Call-Id: 34343@c.example.com
   CSeq: 1 INVITE
   Contact: &lt;sip:carol@c.example.com&gt;
   Referred-By: &lt;sip:bob@b.example.org&gt;


   Message *12: C -&gt; conf

   SIP/2.0 200 OK
   To: &lt;sip:conf456@conf-srv2.example.org&gt;
   From: &lt;carol@example.org&gt;;tag=mmm
   Call-Id: 34343@c.example.com
   CSeq: 1 INVITE
   Contact: &lt;sip:conf456@conf-srv2.example.org&gt;;isfocus
   Referred-By: &lt;sip:bob@b.example.org&gt;

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/8.2.%20%20Join%20rejected"></a><a class="selflink" href="#section-8.2" id="section-8.2">8.2</a>.  Join rejected</span>

   A             B              C
   |             |  callid: 7@c |
   |             |              |
   |             |&lt;============&gt;|
   |             |              |
   |INVITE------&gt;|  *1          |
   |Join: 7@c    |              |
   |             |              |
   |&lt;----486-----|  *2          |
   |-----ACK----&gt;|              |
   |             |              |

   In this example B is Busy (does not want to be disturbed), and
   therefore does not wish to add A.  B could also decline the request
   with a 603 response.

   Message *1: A -&gt;  B

   INVITE sip:bob@b.example.org SIP/2.0
   To: &lt;sip:bob@example.org&gt;
   From: &lt;sip:alice@example.org&gt;;tag=iii
   Call-Id: 777@a.example.org
   CSeq: 1 INVITE
   Contact: &lt;sip:alice@a.example.org&gt;
   Join: 7@c.example.org;to-tag=xyz;from-tag=pdq








<span class="grey">Mahy &amp; Petrie               Standards Track                    [Page 12]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-13"></span>
<span class="grey"><a href="./rfc3911">RFC 3911</a>                        SIP Join                    October 2004</span>


   Message *2: B -&gt; A

   SIP/2.0 486 Busy
   To: &lt;sip:bob@example.org&gt;
   From: &lt;sip:alice@example.org&gt;;tag=iii
   Call-Id: 777@a.example.org
   CSeq: 1 INVITE

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/9.%20%20Security%20Considerations"></a><a class="selflink" href="#section-9" id="section-9">9</a>.  Security Considerations</span>

   The extension specified in this document significantly changes the
   relative security of SIP devices.  Currently in SIP, even if an
   eavesdropper learns the Call-ID, To, and From headers of a dialog,
   they cannot easily modify or destroy that dialog if Digest
   authentication or end-to-end message integrity are used.

   This extension can be used to insert or monitor potentially sensitive
   content in a multimedia conversation.  As such, invitations with the
   Join header MUST only be accepted if the peer requesting replacement
   has been properly authenticated using a standard SIP mechanism
   (Digest or S/MIME), and authorized to be joined with the target
   dialog.  (All SIP implementations are already required to support
   Digest Authentication.)  Generally authorization for joins are
   configured as a matter of local policy as long-duration persistent
   relationships.

   For example, the UAs used by call center agents might be configured
   with a list of identities who could join their calls (supervisors and
   any call center monitoring User Agents).  Alternatively the call
   center agents might rely on transitive authorization assertions from
   a (shorter) list of authorized hosts (e.g., a certificate authority).
   For answering-machine-style message screening this is even easier.
   Presumably the user screening their messages already has some
   credentials with their messaging server.

   Some mechanisms for obtaining the dialog information needed by the
   Join header (Call-ID, to-tag, and from-tag) include URIs on a web
   page, subscriptions to an appropriate event package, and
   notifications after a REFER request.  Use of end-to-end security
   mechanisms to integrity protect and encrypt this information is also
   RECOMMENDED.

   This extension was designed to take advantage of future signature or
   authorization schemes defined by standards track extensions.  In
   general, call control features would benefit considerably from such
   work.





<span class="grey">Mahy &amp; Petrie               Standards Track                    [Page 13]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-14"></span>
<span class="grey"><a href="./rfc3911">RFC 3911</a>                        SIP Join                    October 2004</span>


   <a href="#section-4">Section 4</a> describes specific mechanisms for authorization using
   Digest Authentication and S/MIME (<a href="./rfc3261">RFC 3261</a>) and Referred-by [<a href="#ref-9" title='"The Session Initiation Protocol (SIP) Referred-By Mechanism"'>9</a>], the
   currently available capabilities in SIP.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/10.%20%20IANA%20Considerations"></a><a class="selflink" href="#section-10" id="section-10">10</a>.  IANA Considerations</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/10.1.%20%20Registration%20of%20%22Join%22%20SIP%20header"></a><a class="selflink" href="#section-10.1" id="section-10.1">10.1</a>.  Registration of "Join" SIP header</span>

   Name of Header:          Join

   Short form:              none

   Normative description:   <a href="#section-7.1">section 7.1</a> of this document

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/10.2.%20%20Registration%20of%20%22join%22%20SIP%20Option-tag"></a><a class="selflink" href="#section-10.2" id="section-10.2">10.2</a>.  Registration of "join" SIP Option-tag</span>

   Name of option:          join

   Description:             Support for the SIP Join header

   SIP headers defined:     Join

   Normative description:   This document

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/11.%20%20Acknowledgments"></a><a class="selflink" href="#section-11" id="section-11">11</a>.  Acknowledgments</span>

   Thanks to Robert Sparks, Alan Johnston, and Ben Campbell and many
   other members of the SIP WG for their continued support of the cause
   of distributed call control in SIP.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/12.%20%20References"></a><a class="selflink" href="#section-12" id="section-12">12</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/12.1.%20%20Normative%20References"></a><a class="selflink" href="#section-12.1" id="section-12.1">12.1</a>.  Normative References</span>

   [<a id="ref-1">1</a>]   Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A.,
         Peterson, J., Sparks, R., Handley, M., and E. Schooler, "SIP:
         Session Initiation Protocol", <a href="./rfc3261">RFC 3261</a>, June 2002.

   [<a id="ref-2">2</a>]   Bradner, S., "Key words for use in RFCs to Indicate Requirement
         Levels", <a href="https://www.rfc-editor.org/bcp/bcp14">BCP 14</a>, <a href="./rfc2119">RFC 2119</a>, March 1997.

   [<a id="ref-3">3</a>]   Crocker, D. and P. Overell, "Augmented BNF for Syntax
         Specifications: ABNF", <a href="./rfc2234">RFC 2234</a>, November 1997.

   [<a id="ref-4">4</a>]   Franks, J., Hallam-Baker, P., Hostetler, J., Lawrence, S.,
         Leach, P., Luotonen, A., and L. Stewart, "HTTP Authentication:
         Basic and Digest Access Authentication", <a href="./rfc2617">RFC 2617</a>, June 1999.




<span class="grey">Mahy &amp; Petrie               Standards Track                    [Page 14]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-15"></span>
<span class="grey"><a href="./rfc3911">RFC 3911</a>                        SIP Join                    October 2004</span>


   [<a id="ref-5">5</a>]   Ramsdell, B., "Secure/Multipurpose Internet Mail Extensions
         (S/MIME) Version 3.1 Message Specification", <a href="./rfc3851">RFC 3851</a>, July
         2004.

   [<a id="ref-6">6</a>]   Rosenberg, J., "Indicating User Agent Capabilities in the
         Session Initiation Protocol  (SIP)", <a href="./rfc3840">RFC 3840</a>, August 2004.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/12.2.%20%20Informative%20References"></a><a class="selflink" href="#section-12.2" id="section-12.2">12.2</a>.  Informative References</span>

   [<a id="ref-7">7</a>]   Sparks, R., "The Session Initiation Protocol (SIP) Refer
         Method", <a href="./rfc3515">RFC 3515</a>, April 2003.

   [<a id="ref-8">8</a>]   Dean, R., Biggs, B., and R. Mahy, "The Session Initiation
         Protocol (SIP) "Replaces" Header", <a href="./rfc3891">RFC 3891</a>, September 2004.

   [<a id="ref-9">9</a>]   Sparks, R., "The Session Initiation Protocol (SIP) Referred-By
         Mechanism", <a href="./rfc3892">RFC 3892</a>, September 2004.

   [<a id="ref-10">10</a>]  Peterson, J., "Session Initiation Protocol (SIP) Authenticated
         Identity Body (AIB) Format", <a href="./rfc3893">RFC 3893</a>, September 2004.

   [<a id="ref-11">11</a>]  Handley, M., Schulzrinne, H., Schooler, E., and J. Rosenberg,
         "SIP: Session Initiation Protocol", <a href="./rfc2543">RFC 2543</a>, March 1999.

   [<a id="ref-12">12</a>]  Mahy, R., "A Call Control and Multi-party usage framework for
         the Session  Initiation Protocol (SIP)", Work in Progress,
         March 2003.

   [<a id="ref-13">13</a>]  Rosenberg, J. and H. Schulzrinne, "An INVITE Initiated Dialog
         Event Package for the Session Initiation Protocol (SIP)", Work
         in Progress, March 2003.

   [<a id="ref-14">14</a>]  IAB and IESG, "IETF Policy on Wiretapping", <a href="./rfc2804">RFC 2804</a>, May 2000.

   [<a id="ref-15">15</a>]  Rosenberg, J., "A Framework for Conferencing with the Session
         Initiation Protocol", Work in Progress, May 2003.

   [<a id="ref-16">16</a>]  Johnston, A. and O. Levin, "Session Initiation Protocol Call
         Control - Conferencing for User  Agents", Work in Progress,
         April 2003.

   [<a id="ref-17">17</a>]  Rosenberg, J., Peterson, J., Schulzrinne, H., and G. Camarillo,
         "Best Current Practices for Third Party Call Control (3pcc) in
         the Session Initiation Protocol (SIP)", <a href="https://www.rfc-editor.org/bcp/bcp85">BCP 85</a>, <a href="./rfc3725">RFC 3725</a>, April
         2004.

   [<a id="ref-18">18</a>]  Johnston, A. and S. Donovan, "Session Initiation Protocol
         Service Examples", Work in Progress, March 2003.



<span class="grey">Mahy &amp; Petrie               Standards Track                    [Page 15]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-16"></span>
<span class="grey"><a href="./rfc3911">RFC 3911</a>                        SIP Join                    October 2004</span>


   [<a id="ref-19">19</a>]  Campbell, B., Rosenberg, J., Schulzrinne, H., Huitema, C., and
         D. Gurle, "Session Initiation Protocol (SIP) Extension for
         Instant Messaging", <a href="./rfc3428">RFC 3428</a>, December 2002.

   [<a id="ref-20">20</a>]  Roach, A., "Session Initiation Protocol (SIP)-Specific Event
         Notification", <a href="./rfc3265">RFC 3265</a>, June 2002.

   [<a id="ref-21">21</a>]  Donovan, S., "The SIP INFO Method", <a href="./rfc2976">RFC 2976</a>, October 2000.

   [<a id="ref-22">22</a>]  Rosenberg, J., "The Session Initiation Protocol (SIP) UPDATE
         Method", <a href="./rfc3311">RFC 3311</a>, October 2002.

   [<a id="ref-23">23</a>]  Rosenberg, J. and H. Schulzrinne, "Reliability of Provisional
         Responses in Session Initiation Protocol (SIP)", <a href="./rfc3262">RFC 3262</a>, June
         2002.

   [<a id="ref-24">24</a>]  Campbell, B., <a href="https://www.google.com/search?sitesearch=datatracker.ietf.org%2Fdoc%2Fhtml%2F&amp;q=inurl:draft-+%22SIMPLE+Presence+Publication+Mechanism%22" style="text-decoration: none">"SIMPLE Presence Publication Mechanism"</a>, Work in
         Progress, February 2003.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/13.%20%20Authors%27%20Addresses"></a><a class="selflink" href="#section-13" id="section-13">13</a>.  Authors' Addresses</span>

   Rohan Mahy
   Airespace
   110 Nortech Parkway
   San Jose, CA 95134
   USA

   EMail: rohan@airespace.com


   Dan Petrie
   Pingtel
   400 West Cummings Park, Suite 2200
   Woburn, MA  01801
   USA

   EMail: dpetrie@pingtel.com














<span class="grey">Mahy &amp; Petrie               Standards Track                    [Page 16]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-17"></span>
<span class="grey"><a href="./rfc3911">RFC 3911</a>                        SIP Join                    October 2004</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/14.%20%20Full%20Copyright%20Statement"></a><a class="selflink" href="#section-14" id="section-14">14</a>.  Full Copyright Statement</span>

   Copyright (C) The Internet Society (2004).

   This document is subject to the rights, licenses and restrictions
   contained in <a href="https://www.rfc-editor.org/bcp/bcp78">BCP 78</a>, and except as set forth therein, the authors
   retain all their rights.

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY AND THE INTERNET
   ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS OR IMPLIED,
   INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE
   INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

Intellectual Property

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the IETF's procedures with respect to rights in IETF Documents can
   be found in <a href="https://www.rfc-editor.org/bcp/bcp78">BCP 78</a> and <a href="https://www.rfc-editor.org/bcp/bcp79">BCP 79</a>.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   <a href="http://www.ietf.org/ipr">http://www.ietf.org/ipr</a>.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at ietf-
   ipr@ietf.org.

Acknowledgement

   Funding for the RFC Editor function is currently provided by the
   Internet Society.







Mahy &amp; Petrie               Standards Track                    [Page 17]
</pre>
</body></html>