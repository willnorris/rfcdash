<!DOCTYPE html>
<html class="RFC" lang="en"><head>
<meta charset="utf-8"/>
<meta content="Common,Latin" name="scripts"/>
<meta content="initial-scale=1.0" name="viewport"/>
<title>RFC 8662: Entropy Label for Source Packet Routing in Networking (SPRING) Tunnels</title>
<meta content="Sriganesh Kini" name="author"/>
<meta content="Kireeti Kompella" name="author"/>
<meta content="Siva Sivabalan" name="author"/>
<meta content="Stephane Litkowski" name="author"/>
<meta content="Rob Shakir" name="author"/>
<meta content="Jeff Tantsura" name="author"/>
<meta content="
       
  Segment Routing (SR) leverages the source-routing paradigm.  A node steers a
  packet through an ordered list of instructions, called segments. Segment
  Routing can be applied to the Multiprotocol Label Switching (MPLS) data
  plane.  Entropy labels (ELs) are used in MPLS to improve load-balancing.
  This document examines and describes how ELs are to be applied to Segment
  Routing MPLS.
 
    " name="description"/>
<meta content="xml2rfc 2.35.0" name="generator"/>
<meta content="Flow-aware load balancing" name="keyword"/>
<meta content="ECMP" name="keyword"/>
<meta content="equal-cost multipath" name="keyword"/>
<meta content="8662" name="rfc.number"/>
<link href="rfc8662.xml" rel="alternate" type="application/rfc+xml"/>
<link href="#copyright" rel="license"/>
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Avoid wrapping of URLs in references */
@media screen {
  .references a {
    white-space: nowrap;
  }
}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin: 0 0 0.25em 0;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .sourcecode {
    margin-bottom: 1em;
  }
}</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css"/>
<link href="https://dx.doi.org/10.17487/rfc8662" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <link href="https://datatracker.ietf.org/doc/draft-ietf-mpls-spring-entropy-label-12" rel="prev"/>
  </head>
<body>
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 8662</td>
<td class="center">Entropy Labels for SPRING Tunnels</td>
<td class="right">December 2019</td>
</tr></thead>
<tfoot><tr>
<td class="left">Kini, et al.</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div class="document-information" id="external-metadata"></div>
<div class="document-information" id="internal-metadata">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a class="eref" href="https://www.rfc-editor.org/rfc/rfc8662">8662</a></dd>
<dt class="label-category">Category:</dt>
<dd class="category">Standards Track</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time class="published" datetime="2019-12">December 2019</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">S. Kini</div>
</div>
<div class="author">
      <div class="author-name">K. Kompella</div>
<div class="org">Juniper</div>
</div>
<div class="author">
      <div class="author-name">S. Sivabalan</div>
<div class="org">Cisco</div>
</div>
<div class="author">
      <div class="author-name">S. Litkowski</div>
<div class="org">Orange</div>
</div>
<div class="author">
      <div class="author-name">R. Shakir</div>
<div class="org">Google</div>
</div>
<div class="author">
      <div class="author-name">J. Tantsura</div>
<div class="org">Apstra, Inc.</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 8662</h1>
<h1 id="title">Entropy Label for Source Packet Routing in Networking (SPRING) Tunnels</h1>
<section id="section-abstract">
      <h2 id="abstract"><a class="selfRef" href="#abstract">Abstract</a></h2>
<p id="section-abstract-1">
  Segment Routing (SR) leverages the source-routing paradigm.  A node steers a
  packet through an ordered list of instructions, called segments. Segment
  Routing can be applied to the Multiprotocol Label Switching (MPLS) data
  plane.  Entropy labels (ELs) are used in MPLS to improve load-balancing.
  This document examines and describes how ELs are to be applied to Segment
  Routing MPLS.<a class="pilcrow" href="#section-abstract-1">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a class="section-name selfRef" href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This is an Internet Standards Track document.<a class="pilcrow" href="#section-boilerplate.1-1">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.<a class="pilcrow" href="#section-boilerplate.1-2">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc8662">https://www.rfc-editor.org/info/rfc8662</a></span>.<a class="pilcrow" href="#section-boilerplate.1-3">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a class="section-name selfRef" href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2019 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a class="pilcrow" href="#section-boilerplate.2-1">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a class="pilcrow" href="#section-boilerplate.2-2">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a class="toplink" href="#" onclick="scroll(0,0)">▲</a><h2 id="name-table-of-contents">
<a class="section-name selfRef" href="#name-table-of-contents">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a class="xref" href="#section-1">1</a>.  <a class="xref" href="#name-introduction">Introduction</a><a class="pilcrow" href="#section-toc.1-1.1.1">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1"><a class="xref" href="#section-1.1">1.1</a>.  <a class="xref" href="#name-requirements-language">Requirements Language</a><a class="pilcrow" href="#section-toc.1-1.1.2.1.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a class="xref" href="#section-2">2</a>.  <a class="xref" href="#name-abbreviations-and-terminolo">Abbreviations and Terminology</a><a class="pilcrow" href="#section-toc.1-1.2.1">¶</a></p>
</li>
          <li class="toc ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a class="xref" href="#section-3">3</a>.  <a class="xref" href="#name-use-case-requiring-multipat">Use Case Requiring Multipath Load-Balancing</a><a class="pilcrow" href="#section-toc.1-1.3.1">¶</a></p>
</li>
          <li class="toc ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a class="xref" href="#section-4">4</a>.  <a class="xref" href="#name-entropy-readable-label-dept">Entropy Readable Label Depth</a><a class="pilcrow" href="#section-toc.1-1.4.1">¶</a></p>
</li>
          <li class="toc ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a class="xref" href="#section-5">5</a>.  <a class="xref" href="#name-maximum-sid-depth">Maximum SID Depth</a><a class="pilcrow" href="#section-toc.1-1.5.1">¶</a></p>
</li>
          <li class="toc ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a class="xref" href="#section-6">6</a>.  <a class="xref" href="#name-lsp-stitching-using-the-bin">LSP Stitching Using the Binding SID</a><a class="pilcrow" href="#section-toc.1-1.6.1">¶</a></p>
</li>
          <li class="toc ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a class="xref" href="#section-7">7</a>.  <a class="xref" href="#name-insertion-of-entropy-labels">Insertion of Entropy Labels for SPRING Path</a><a class="pilcrow" href="#section-toc.1-1.7.1">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a class="xref" href="#section-7.1">7.1</a>.  <a class="xref" href="#name-overview">Overview</a><a class="pilcrow" href="#section-toc.1-1.7.2.1.1">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.7.2.1.2.1">
                    <p id="section-toc.1-1.7.2.1.2.1.1"><a class="xref" href="#section-7.1.1">7.1.1</a>.  <a class="xref" href="#name-example-1-the-ingress-node-">Example 1: The Ingress Node Has a Sufficient MSD</a><a class="pilcrow" href="#section-toc.1-1.7.2.1.2.1.1">¶</a></p>
</li>
                  <li class="toc ulEmpty" id="section-toc.1-1.7.2.1.2.2">
                    <p id="section-toc.1-1.7.2.1.2.2.1"><a class="xref" href="#section-7.1.2">7.1.2</a>.  <a class="xref" href="#name-example-2-the-ingress-node-">Example 2: The Ingress Node Does Not Have a Sufficient MSD</a><a class="pilcrow" href="#section-toc.1-1.7.2.1.2.2.1">¶</a></p>
</li>
                </ul>
</li>
              <li class="toc ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a class="xref" href="#section-7.2">7.2</a>.  <a class="xref" href="#name-considerations-for-the-plac">Considerations for the Placement of Entropy Labels</a><a class="pilcrow" href="#section-toc.1-1.7.2.2.1">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.7.2.2.2.1">
                    <p id="section-toc.1-1.7.2.2.2.1.1"><a class="xref" href="#section-7.2.1">7.2.1</a>.  <a class="xref" href="#name-erld-value">ERLD Value</a><a class="pilcrow" href="#section-toc.1-1.7.2.2.2.1.1">¶</a></p>
</li>
                  <li class="toc ulEmpty" id="section-toc.1-1.7.2.2.2.2">
                    <p id="section-toc.1-1.7.2.2.2.2.1"><a class="xref" href="#section-7.2.2">7.2.2</a>.  <a class="xref" href="#name-segment-type">Segment Type</a><a class="pilcrow" href="#section-toc.1-1.7.2.2.2.2.1">¶</a></p>
</li>
                  <li class="toc ulEmpty" id="section-toc.1-1.7.2.2.2.3">
                    <p id="section-toc.1-1.7.2.2.2.3.1"><a class="xref" href="#section-7.2.3">7.2.3</a>.  <a class="xref" href="#name-maximizing-number-of-lsrs-t">Maximizing Number of LSRs That Will Load-Balance</a><a class="pilcrow" href="#section-toc.1-1.7.2.2.2.3.1">¶</a></p>
</li>
                  <li class="toc ulEmpty" id="section-toc.1-1.7.2.2.2.4">
                    <p id="section-toc.1-1.7.2.2.2.4.1"><a class="xref" href="#section-7.2.4">7.2.4</a>.  <a class="xref" href="#name-preference-for-a-part-of-th">Preference for a Part of the Path</a><a class="pilcrow" href="#section-toc.1-1.7.2.2.2.4.1">¶</a></p>
</li>
                  <li class="toc ulEmpty" id="section-toc.1-1.7.2.2.2.5">
                    <p id="section-toc.1-1.7.2.2.2.5.1"><a class="xref" href="#section-7.2.5">7.2.5</a>.  <a class="xref" href="#name-combining-criteria">Combining Criteria</a><a class="pilcrow" href="#section-toc.1-1.7.2.2.2.5.1">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="toc ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a class="xref" href="#section-8">8</a>.  <a class="xref" href="#name-a-simple-example-algorithm">A Simple Example Algorithm</a><a class="pilcrow" href="#section-toc.1-1.8.1">¶</a></p>
</li>
          <li class="toc ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a class="xref" href="#section-9">9</a>.  <a class="xref" href="#name-deployment-considerations">Deployment Considerations</a><a class="pilcrow" href="#section-toc.1-1.9.1">¶</a></p>
</li>
          <li class="toc ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a class="xref" href="#section-10">10</a>. <a class="xref" href="#name-options-considered">Options Considered</a><a class="pilcrow" href="#section-toc.1-1.10.1">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a class="xref" href="#section-10.1">10.1</a>.  <a class="xref" href="#name-single-el-at-the-bottom-of-">Single EL at the Bottom of the Stack</a><a class="pilcrow" href="#section-toc.1-1.10.2.1.1">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a class="xref" href="#section-10.2">10.2</a>.  <a class="xref" href="#name-an-el-per-segment-in-the-st">An EL per Segment in the Stack</a><a class="pilcrow" href="#section-toc.1-1.10.2.2.1">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-toc.1-1.10.2.3">
                <p id="section-toc.1-1.10.2.3.1"><a class="xref" href="#section-10.3">10.3</a>.  <a class="xref" href="#name-a-reusable-el-for-a-stack-o">A Reusable EL for a Stack of Tunnels</a><a class="pilcrow" href="#section-toc.1-1.10.2.3.1">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-toc.1-1.10.2.4">
                <p id="section-toc.1-1.10.2.4.1"><a class="xref" href="#section-10.4">10.4</a>.  <a class="xref" href="#name-el-at-top-of-stack">EL at Top of Stack</a><a class="pilcrow" href="#section-toc.1-1.10.2.4.1">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-toc.1-1.10.2.5">
                <p id="section-toc.1-1.10.2.5.1"><a class="xref" href="#section-10.5">10.5</a>.  <a class="xref" href="#name-els-at-readable-label-stack">ELs at Readable Label Stack Depths</a><a class="pilcrow" href="#section-toc.1-1.10.2.5.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a class="xref" href="#section-11">11</a>. <a class="xref" href="#name-iana-considerations">IANA Considerations</a><a class="pilcrow" href="#section-toc.1-1.11.1">¶</a></p>
</li>
          <li class="toc ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a class="xref" href="#section-12">12</a>. <a class="xref" href="#name-security-considerations">Security Considerations</a><a class="pilcrow" href="#section-toc.1-1.12.1">¶</a></p>
</li>
          <li class="toc ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a class="xref" href="#section-13">13</a>. <a class="xref" href="#name-references">References</a><a class="pilcrow" href="#section-toc.1-1.13.1">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a class="xref" href="#section-13.1">13.1</a>.  <a class="xref" href="#name-normative-references">Normative References</a><a class="pilcrow" href="#section-toc.1-1.13.2.1.1">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a class="xref" href="#section-13.2">13.2</a>.  <a class="xref" href="#name-informative-references">Informative References</a><a class="pilcrow" href="#section-toc.1-1.13.2.2.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a class="xref" href="#section-appendix.a"></a><a class="xref" href="#name-acknowledgements">Acknowledgements</a><a class="pilcrow" href="#section-toc.1-1.14.1">¶</a></p>
</li>
          <li class="toc ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a class="xref" href="#section-appendix.b"></a><a class="xref" href="#name-contributors">Contributors</a><a class="pilcrow" href="#section-toc.1-1.15.1">¶</a></p>
</li>
          <li class="toc ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a class="xref" href="#section-appendix.c"></a><a class="xref" href="#name-authors-addresses">Authors' Addresses</a><a class="pilcrow" href="#section-toc.1-1.16.1">¶</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<section id="section-1">
      <h2 id="name-introduction">
<a class="section-number selfRef" href="#section-1">1. </a><a class="section-name selfRef" href="#name-introduction">Introduction</a>
      </h2>
<p id="section-1-1">
   Segment Routing <span>[<a class="xref" href="#RFC8402">RFC8402</a>]</span> is based on
   source-routed tunnels to steer a packet along a particular path. This path
   is encoded as an ordered list of segments.  When applied to the MPLS data
   plane <span>[<a class="xref" href="#RFC8660">RFC8660</a>]</span>, each segment is an LSP
   (Label Switched Path) with an associated MPLS label value.  Hence, label
   stacking is used to represent the ordered list of segments, and the label
   stack associated with an SR tunnel can be seen as nested LSPs (LSP
   hierarchy) in the MPLS architecture.<a class="pilcrow" href="#section-1-1">¶</a></p>
<p id="section-1-2">
 Using label stacking to encode the list of segments has implications on the label stack depth.<a class="pilcrow" href="#section-1-2">¶</a></p>
<p id="section-1-3">
   Traffic load-balancing over ECMP (Equal-Cost Multipath) or LAGs (Link
   Aggregation Groups) is usually based on a hashing function. The local node
   that performs the load-balancing is required to read some header fields in
   the incoming packets and then compute a hash based on those fields. The
   result of the hash is finally mapped to a list of outgoing next hops.  The
   hashing technique is required to perform a per-flow load-balancing and
   thus, prevents packet misordering. For IP traffic, the usual fields that
   are hashed are the source address, the destination address, the protocol
   type, and, if provided by the upper layer, the source port and destination
   port.<a class="pilcrow" href="#section-1-3">¶</a></p>
<p id="section-1-4">
   The MPLS architecture brings some challenges when an LSR (Label Switching
   Router) tries to look up at header fields. An LSR needs be able to look up
   at header fields that are beyond the MPLS label stack while the MPLS header
   does not provide any information about the upper-layer protocol.  An LSR
   must perform a deeper inspection compared to an ingress router, which could
   be challenging for some hardware.  Entropy labels (ELs) <span>[<a class="xref" href="#RFC6790">RFC6790</a>]</span> are used in the MPLS data
   plane to provide entropy for load-balancing.  The idea behind the entropy
   label is that the ingress router computes a hash based on several fields
   from a given packet and places the result in an additional label named
   "entropy label".  Then, this entropy label can be used as part of the hash
   keys used by an LSR. Using the entropy label as part of the hash keys
   reduces the need for deep packet inspection in the LSR while keeping a good
   level of entropy in the load-balancing.  When the entropy label is used,
   the keys used in the hashing functions are still a local configuration
   matter, and an LSR may use solely the entropy label or a combination of
   multiple fields from the incoming packet.<a class="pilcrow" href="#section-1-4">¶</a></p>
<p id="section-1-5">
   When using LSP
   hierarchies, there are implications on how <span>[<a class="xref" href="#RFC6790">RFC6790</a>]</span> should be
   applied.  The current document addresses the case where a hierarchy
   is created at a single LSR as required by Segment Routing.<a class="pilcrow" href="#section-1-5">¶</a></p>
<p id="section-1-6">
   A use case requiring load-balancing with SR is given in <a class="xref" href="#usecase">Section 3</a>.  A recommended solution is
   described in <a class="xref" href="#solution">Section 7</a> keeping in consideration the limitations of
   implementations when applying <span>[<a class="xref" href="#RFC6790">RFC6790</a>]</span> to deeper label stacks.
   Options that were considered to arrive at the recommended solution
   are documented for historical purposes in <a class="xref" href="#other-options">Section 10</a>.<a class="pilcrow" href="#section-1-6">¶</a></p>
<section id="section-1.1">
        <h3 id="name-requirements-language">
<a class="section-number selfRef" href="#section-1.1">1.1. </a><a class="section-name selfRef" href="#name-requirements-language">Requirements Language</a>
        </h3>
<p id="section-1.1-1">
    The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>",
    "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>",
    "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>",
    "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
    "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be
    interpreted as described in BCP 14 <span>[<a class="xref" href="#RFC2119">RFC2119</a>]</span> <span>[<a class="xref" href="#RFC8174">RFC8174</a>]</span> when, and only when, they appear in all capitals, as
    shown here.<a class="pilcrow" href="#section-1.1-1">¶</a></p>
</section>
</section>
<section id="section-2">
      <h2 id="name-abbreviations-and-terminolo">
<a class="section-number selfRef" href="#section-2">2. </a><a class="section-name selfRef" href="#name-abbreviations-and-terminolo">Abbreviations and Terminology</a>
      </h2>
<dl class="dlParallel" id="section-2-1">
        <dt id="section-2-1.1">Adj-SID</dt>
        <dd id="section-2-1.2" style="margin-left: 5.0em">Adjacency Segment Identifier<a class="pilcrow" href="#section-2-1.2">¶</a>
</dd>
<dt id="section-2-1.3">ECMP</dt>
        <dd id="section-2-1.4" style="margin-left: 5.0em">Equal-Cost Multipath<a class="pilcrow" href="#section-2-1.4">¶</a>
</dd>
<dt id="section-2-1.5">EL</dt>
        <dd id="section-2-1.6" style="margin-left: 5.0em">Entropy Label<a class="pilcrow" href="#section-2-1.6">¶</a>
</dd>
<dt id="section-2-1.7">ELI</dt>
        <dd id="section-2-1.8" style="margin-left: 5.0em">Entropy Label Indicator<a class="pilcrow" href="#section-2-1.8">¶</a>
</dd>
<dt id="section-2-1.9">ELC</dt>
        <dd id="section-2-1.10" style="margin-left: 5.0em">Entropy Label Capability<a class="pilcrow" href="#section-2-1.10">¶</a>
</dd>
<dt id="section-2-1.11">ERLD</dt>
        <dd id="section-2-1.12" style="margin-left: 5.0em">Entropy Readable Label Depth<a class="pilcrow" href="#section-2-1.12">¶</a>
</dd>
<dt id="section-2-1.13">FEC</dt>
        <dd id="section-2-1.14" style="margin-left: 5.0em">Forwarding Equivalence Class<a class="pilcrow" href="#section-2-1.14">¶</a>
</dd>
<dt id="section-2-1.15">LAG</dt>
        <dd id="section-2-1.16" style="margin-left: 5.0em">Link Aggregation Group<a class="pilcrow" href="#section-2-1.16">¶</a>
</dd>
<dt id="section-2-1.17">LSP</dt>
        <dd id="section-2-1.18" style="margin-left: 5.0em">Label Switched Path<a class="pilcrow" href="#section-2-1.18">¶</a>
</dd>
<dt id="section-2-1.19">LSR</dt>
        <dd id="section-2-1.20" style="margin-left: 5.0em">Label Switching Router<a class="pilcrow" href="#section-2-1.20">¶</a>
</dd>
<dt id="section-2-1.21">MPLS</dt>
        <dd id="section-2-1.22" style="margin-left: 5.0em">Multiprotocol Label Switching<a class="pilcrow" href="#section-2-1.22">¶</a>
</dd>
<dt id="section-2-1.23">MSD</dt>
        <dd id="section-2-1.24" style="margin-left: 5.0em">Maximum SID Depth<a class="pilcrow" href="#section-2-1.24">¶</a>
</dd>
<dt id="section-2-1.25">Node SID</dt>
        <dd id="section-2-1.26" style="margin-left: 5.0em">Node Segment Identifier<a class="pilcrow" href="#section-2-1.26">¶</a>
</dd>
<dt id="section-2-1.27">OAM</dt>
        <dd id="section-2-1.28" style="margin-left: 5.0em">Operations, Administration, and Maintenance<a class="pilcrow" href="#section-2-1.28">¶</a>
</dd>
<dt id="section-2-1.29">RLD</dt>
        <dd id="section-2-1.30" style="margin-left: 5.0em">Readable Label Depth<a class="pilcrow" href="#section-2-1.30">¶</a>
</dd>
<dt id="section-2-1.31">SID</dt>
        <dd id="section-2-1.32" style="margin-left: 5.0em">Segment Identifier<a class="pilcrow" href="#section-2-1.32">¶</a>
</dd>
<dt id="section-2-1.33">SPT</dt>
        <dd id="section-2-1.34" style="margin-left: 5.0em">Shortest Path Tree<a class="pilcrow" href="#section-2-1.34">¶</a>
</dd>
<dt id="section-2-1.35">SR</dt>
        <dd id="section-2-1.36" style="margin-left: 5.0em">Segment Routing<a class="pilcrow" href="#section-2-1.36">¶</a>
</dd>
<dt id="section-2-1.37">SRGB</dt>
        <dd id="section-2-1.38" style="margin-left: 5.0em">Segment Routing Global Block<a class="pilcrow" href="#section-2-1.38">¶</a>
</dd>
<dt id="section-2-1.39">VPN</dt>
        <dd id="section-2-1.40" style="margin-left: 5.0em">Virtual Private Network<a class="pilcrow" href="#section-2-1.40">¶</a>
</dd>
</dl>
</section>
<div id="usecase">
<section id="section-3">
      <h2 id="name-use-case-requiring-multipat">
<a class="section-number selfRef" href="#section-3">3. </a><a class="section-name selfRef" href="#name-use-case-requiring-multipat">Use Case Requiring Multipath Load-Balancing</a>
      </h2>
<p id="section-3-1">
Traffic engineering is one of the applications of MPLS and is also a
requirement for Segment Routing <span>[<a class="xref" href="#RFC7855">RFC7855</a>]</span>.  Consider the
topology shown in <a class="xref" href="#fig_TE_use_case">Figure 1</a>.  The LSR S requires data to be sent to LSR D along
a traffic-engineered path that goes over the link L1.  Good load-balancing is
also required across equal-cost paths (including parallel links).  To steer
traffic along a path that crosses link L1, the label stack that LSR S creates
consists of a label to the Node SID of LSR P3 stacked over the label for the
Adj-SID (Adjacency Segment Identifier) of link L1 and that in turn is stacked
over the label to the Node SID of LSR D.  For simplicity, lets assume that all
LSRs use the same label space for Segment Routing (as a reminder, it is called
the SRGB, Segment Routing Global Block).  Let L_N-Px denote the label to be
used to reach the Node SID of LSR Px.  Let L_A-Ln denote the label used for
the Adj-SID for link Ln.  In our example, the LSR S must use the label stack
&lt;L_N-P3, L_A-L1, L_N-D&gt;. However, to achieve good load-balancing over
the equal-cost paths P2-P4-D, P2-P5-D, and the parallel links L3 and L4, a
mechanism such as entropy labels <span>[<a class="xref" href="#RFC6790">RFC6790</a>]</span> should be adapted
for Segment Routing.  Indeed, the Source Packet Routing in Networking (SPRING)
architecture with the MPLS data plane <span>[<a class="xref" href="#RFC8660">RFC8660</a>]</span> uses nested
MPLS LSPs composing the source-routed label stack.<a class="pilcrow" href="#section-3-1">¶</a></p>
<span id="name-traffic-engineering-use-cas"></span><div id="fig_TE_use_case">
<figure id="figure-1">
        <div class="artwork art-text alignLeft" id="section-3-2.1">
<pre>                      +------+
                      |      |
              +-------|  P3  |-----+
              | +-----|      |---+ |
            L3| |L4   +------+ L1| |L2     +----+
              | |                | |    +--| P4 |--+
+-----+     +-----+            +-----+  |  +----+  |  +-----+
|  S  |-----| P1  |------------| P2  |--+          +--|  D  |
|     |     |     |            |     |--+          +--|     |
+-----+     +-----+            +-----+  |  +----+  |  +-----+
                                        +--| P5 |--+
                                           +----+
    Key:
        S = Source LSR
        D = Destination LSR
        P1, P2, P3, P4, P5 = Transit LSRs
        L1, L2, L3, L4 = Links
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-1">Figure 1</a>:
<a class="selfRef" href="#name-traffic-engineering-use-cas">Traffic-Engineering Use Case</a>
        </figcaption></figure>
</div>
<p id="section-3-3">
   An MPLS node may have limitations in the number of labels it can push. It may also have a limitation in the number of labels it can inspect when looking for hash keys during load-balancing.
   While the entropy label is normally inserted at the bottom of the transport tunnel, this may prevent an LSR from taking into account the EL in its load-balancing function if the EL is too deep in the stack.
   In a Segment Routing environment, it is important to define the considerations that need to be taken into account when inserting an EL.
   Multiple ways to apply entropy labels were considered and are
   documented in <a class="xref" href="#other-options">Section 10</a> along with their trade-offs.  A recommended
   solution is described in <a class="xref" href="#solution">Section 7</a>.<a class="pilcrow" href="#section-3-3">¶</a></p>
</section>
</div>
<div id="erld_definition">
<section id="section-4">
      <h2 id="name-entropy-readable-label-dept">
<a class="section-number selfRef" href="#section-4">4. </a><a class="section-name selfRef" href="#name-entropy-readable-label-dept">Entropy Readable Label Depth</a>
      </h2>
<p id="section-4-1">
   The Entropy Readable Label Depth (ERLD) is defined as the number of labels a router can both:<a class="pilcrow" href="#section-4-1">¶</a></p>
<ol class="normal" id="section-4-2" start="1" type="a">
        <li id="section-4-2.1">Read in an MPLS packet received on its incoming interface(s) (starting from the top of the stack).<a class="pilcrow" href="#section-4-2.1">¶</a>
</li>
        <li id="section-4-2.2">Use in its load-balancing function.<a class="pilcrow" href="#section-4-2.2">¶</a>
</li>
      </ol>
<p id="section-4-3">The ERLD means that the router will perform load-balancing using the EL if the EL is placed within the first ERLD labels.<a class="pilcrow" href="#section-4-3">¶</a></p>
<p id="section-4-4">A router capable of reading N labels but not using an EL located within those N labels <span class="bcp14">MUST</span> consider its ERLD to be 0.<a class="pilcrow" href="#section-4-4">¶</a></p>
<p id="section-4-5">
   In a distributed switching architecture, each line card may have a
   different capability in terms of ERLD. For simplicity, an implementation
   <span class="bcp14">MAY</span> use the minimum ERLD of all line cards as the ERLD value for the system.<a class="pilcrow" href="#section-4-5">¶</a></p>
<p id="section-4-6">There may also be a case where a router has a fast switching path
   (handled by an Application-Specific Integrated Circuit, or ASIC, or network processor) and a slow switching path (handled by a CPU) with a different ERLD for each switching path. Again, for simplicity's sake, an implementation <span class="bcp14">MAY</span> use the minimum ERLD as the ERLD value for the system.<a class="pilcrow" href="#section-4-6">¶</a></p>
<p id="section-4-7">The drawback of using a single ERLD for a system lower than the capability of one or more specific components is that it may increase the number of ELI/ELs inserted. This leads to an increase of the label stack size and may have an impact on the capability of the ingress node to push this label stack.<a class="pilcrow" href="#section-4-7">¶</a></p>
<p id="section-4-8">Examples:<a class="pilcrow" href="#section-4-8">¶</a></p>
<span id="name-label-stacks-with-eli-el"></span><div id="fig_label_stacks">
<figure id="figure-2">
        <div class="artwork art-text alignLeft" id="section-4-9.1">
<pre>                                                    | Payload  |
                                                    +----------+ 
                                       | Payload  | |    EL    | P7
                                       +----------+ +----------+ 
                          | Payload  | |    EL    | |    ELI   | 
                          +----------+ +----------+ +----------+ 
             | Payload  | |   EL     | |    ELI   | | Label 50 | 
             +----------+ +----------+ +----------+ +----------+ 
|  Payload | |     EL   | |   ELI    | | Label 40 | | Label 40 |
+----------+ +----------+ +----------+ +----------+ +----------+  
|     EL   | |    ELI   | | Label 30 | | Label 30 | | Label 30 |  
+----------+ +----------+ +----------+ +----------+ +----------+
|    ELI   | | Label 20 | | Label 20 | | Label 20 | | Label 20 | 
+----------+ +----------+ +----------+ +----------+ +----------+
| Label 16 | | Label 16 | | Label 16 | | Label 16 | | Label 16 | P1
+----------+ +----------+ +----------+ +----------+ +----------+
  Packet 1     Packet 2     Packet 3     Packet 4     Packet 5
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-2">Figure 2</a>:
<a class="selfRef" href="#name-label-stacks-with-eli-el">Label Stacks with ELI/EL</a>
        </figcaption></figure>
</div>
<p id="section-4-10">
   In <a class="xref" href="#fig_label_stacks">Figure 2</a>, we consider the displayed packets received on a router interface. We consider also a single ERLD value for the router.<a class="pilcrow" href="#section-4-10">¶</a></p>
<ul>
<li id="section-4-11.1">If the router has an ERLD of 3, it will be able to load-balance Packet 1 displayed in <a class="xref" href="#fig_label_stacks">Figure 2</a> using the EL as part of the load-balancing keys. The ERLD value of 3 means that the router can read and take into account the entropy label for load-balancing if it is placed between position 1 (top of the MPLS label stack) and position 3.<a class="pilcrow" href="#section-4-11.1">¶</a>
</li>
        <li id="section-4-11.2">If the router has an ERLD of 5, it will be able to load-balance Packets
   1 to 3 in <a class="xref" href="#fig_label_stacks">Figure 2</a> using the EL as part of the load-balancing keys. Packets
   4 and 5 have the EL placed at a position greater than 5, so the router is
   not able to read it and use it as part of the load-balancing keys.<a class="pilcrow" href="#section-4-11.2">¶</a>
</li>
        <li id="section-4-11.3">If the router has an ERLD of 10, it will be able to load-balance all the packets displayed in <a class="xref" href="#fig_label_stacks">Figure 2</a> using the EL as part of the load-balancing keys.<a class="pilcrow" href="#section-4-11.3">¶</a>
</li>
      </ul>
<p id="section-4-12">To allow an efficient load-balancing based on entropy labels, a router running SPRING <span class="bcp14">SHOULD</span> advertise its ERLD (or ERLDs), so all the other SPRING routers in the network are aware of its capability. How this advertisement is done is outside the scope of this document (see <a class="xref" href="#erld">Section 7.2.1</a> for potential approaches).<a class="pilcrow" href="#section-4-12">¶</a></p>
<p id="section-4-13">
   To advertise an ERLD value, a SPRING router:<a class="pilcrow" href="#section-4-13">¶</a></p>
<ul>
<li id="section-4-14.1">
          <span class="bcp14">MUST</span> be entropy label capable and, as a consequence, <span class="bcp14">MUST</span> apply the data-plane procedures defined in <span>[<a class="xref" href="#RFC6790">RFC6790</a>]</span>.<a class="pilcrow" href="#section-4-14.1">¶</a>
</li>
        <li id="section-4-14.2">
          <span class="bcp14">MUST</span> be able to read an ELI/EL, which is located within its ERLD value.<a class="pilcrow" href="#section-4-14.2">¶</a>
</li>
        <li id="section-4-14.3">
          <span class="bcp14">MUST</span> take into account an EL within the first ERLD labels in its load-balancing function.<a class="pilcrow" href="#section-4-14.3">¶</a>
</li>
      </ul>
</section>
</div>
<div id="msd">
<section id="section-5">
      <h2 id="name-maximum-sid-depth">
<a class="section-number selfRef" href="#section-5">5. </a><a class="section-name selfRef" href="#name-maximum-sid-depth">Maximum SID Depth</a>
      </h2>
<p id="section-5-1">
   The Maximum SID Depth defines the maximum number of labels that a
   particular node can impose on a packet. This can include any kind of labels
   (service, entropy, transport, etc.).  In an MPLS network, the MSD is a
   limit of the head-end of an SR tunnel or a Binding SID anchor node that
   performs imposition of additional labels on an existing label stack.<a class="pilcrow" href="#section-5-1">¶</a></p>
<p id="section-5-2">
   Depending on the number of MPLS operations (POP, SWAP, etc.) to be performed before the PUSH, the MSD can vary due to hardware or software limitations.
   As for the ERLD, different MSD limits can exist within a single node based
   on the line-card types used in a distributed switching system. Thus, the MSD is a per link and/or per-node property.<a class="pilcrow" href="#section-5-2">¶</a></p>
<p id="section-5-3">
   An external controller can be used to program a label stack on a particular
   node. This node <span class="bcp14">SHOULD</span> advertise its MSD to the controller
   in order to let the controller know the maximum label stack depth of the
   path computed that is supported on the head-end.

   How this advertisement is done is outside the scope of this
   document. (<span>[<a class="xref" href="#RFC8476">RFC8476</a>]</span>, <span>[<a class="xref" href="#RFC8491">RFC8491</a>]</span>, and <span>[<a class="xref" href="#I-D.ietf-idr-bgp-ls-segment-routing-msd">MSD-BGP</a>]</span> provide
   examples of advertisement of the MSD.)  As the controller does not have the
   knowledge of the entire label stack to be pushed by the node, in addition
   to the MSD value, the node <span class="bcp14">SHOULD</span> advertise the type of the
   MSD.  For instance, the MSD value can represent the limit for pushing
   transport labels only while in reality the node can push an additional
   service label. As another example, the MSD value can represent the full
   limit of the node including all label types (transport, service, entropy,
   etc.).  This gives the ability for the controller to program a label stack
   while leaving room for the local node to add more labels (e.g., service,
   entropy, etc.) without reaching the hardware/software limit.  If the node
   does not provide the meaning of the MSD value, the controller could program
   an LSP using a number of labels equal to the full limit of the node. When
   receiving this label stack from the controller, the ingress node may not be
   able to add any service (L2VPN, L3VPN, EVPN, etc.) label on top of this
   label stack.  The consequence could be for the ingress node to drop service
   packets that should have been forwarded over the LSP.<a class="pilcrow" href="#section-5-3">¶</a></p>
<span id="name-topology-illustrating-label"></span><div id="fig_packet">
<figure id="figure-3">
        <div class="artwork art-text alignLeft" id="section-5-4.1">
<pre>              P7 ---- P8 ---- P9
            /                   \
    PE1 --- P1 --- P2 --- P3 --- P4 --- P5 --- P6 --- PE2
                                        |  \            |
----&gt;                                  P10  \           |
IP Pkt                                  |    \          |
                                       P11 --- P12 --- P13
                                           100    10000
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-3">Figure 3</a>:
<a class="selfRef" href="#name-topology-illustrating-label">Topology Illustrating Label Stack Reduction</a>
        </figcaption></figure>
</div>
<p id="section-5-5">
   In <a class="xref" href="#fig_packet">Figure 3</a>, an IP packet comes into the MPLS network at PE1. All metrics
   are considered equal to 1 except P12-P13, which is 10000, and P11-P12,
   which is 100.  PE1 wants to steer the traffic using a SPRING path to PE2
   along PE1 -&gt; P1 -&gt; P7 -&gt; P8 -&gt; P9 -&gt; P4 -&gt; P5 -&gt; P10 -&gt; P11 -&gt; P12 -&gt; P13
   -&gt; PE2.  By using Adj-SIDs only, PE1 (acting as an ingress LSR, also known
   as an I-LSR) will be required to push 10 labels on the IP packet received
   and thus, requires an MSD of 10.  If the IP packet should be carried over
   an MPLS service like a regular layer 3 VPN, an additional service label
   should be imposed requiring an MSD of 11 for PE1.  In addition, if PE1
   wants to insert an ELI/EL for load-balancing purposes, PE1 will need to
   push 13 labels on the IP packet requiring an MSD of 13.<a class="pilcrow" href="#section-5-5">¶</a></p>
<p id="section-5-6">
   In the SPRING architecture, Node SIDs or Binding SIDs can be used to reduce the label stack size. As an example, to steer the traffic on the same path as before, PE1 could use the following label stack: &lt;Node_P9, Node_P5, Binding_P5, Node_PE2&gt;. 
   In this example, we consider a combination of Node SIDs and a Binding SID
   advertised by P5 that will stitch the traffic along the path P10 -&gt; P11
   -&gt; P12 -&gt; P13. The instruction associated with the Binding SID at P5 is thus to swap Binding_P5 to Adj_P12-P13 and then push &lt;Adj_P11-P12, Node_P11&gt;.
   P5 acts as a stitching node that pushes additional labels on an existing label stack; P5's MSD needs also to be taken into account and may limit the number of labels that can be imposed.<a class="pilcrow" href="#section-5-6">¶</a></p>
</section>
</div>
<div id="stitching">
<section id="section-6">
      <h2 id="name-lsp-stitching-using-the-bin">
<a class="section-number selfRef" href="#section-6">6. </a><a class="section-name selfRef" href="#name-lsp-stitching-using-the-bin">LSP Stitching Using the Binding SID</a>
      </h2>
<p id="section-6-1">
   The Binding SID allows binding a segment identifier to an existing LSP. As
   examples, the Binding SID can represent an RSVP-TE tunnel, an LDP path
   (through the Mapping Server Advertisement), or a SPRING path.  Each
   tail-end router of an MPLS LSP associated with a Binding SID has its own
   entropy label capability. The entropy label capability of the associated
   LSP is advertised in the control-plane protocol used to signal the LSP.<a class="pilcrow" href="#section-6-1">¶</a></p>
<p id="section-6-2">
In <a class="xref" href="#fig_stitching_example">Figure 4</a>, we consider that:<a class="pilcrow" href="#section-6-2">¶</a></p>
<ul>
<li id="section-6-3.1">P6, PE2, P10, P11, P12, and P13 are pure LDP routers.<a class="pilcrow" href="#section-6-3.1">¶</a>
</li>
        <li id="section-6-3.2">PE1, P1, P2, P3, P4, P7, P8, and P9 are pure SPRING routers.<a class="pilcrow" href="#section-6-3.2">¶</a>
</li>
        <li id="section-6-3.3">P5 is running SPRING and LDP.<a class="pilcrow" href="#section-6-3.3">¶</a>
</li>
        <li id="section-6-3.4">P5 acts as a Mapping Server and advertises Prefix-SIDs for the LDP FECs: an index value of 20 is used for PE2.<a class="pilcrow" href="#section-6-3.4">¶</a>
</li>
        <li id="section-6-3.5">All SPRING routers use an SRGB of [1000, 1999].<a class="pilcrow" href="#section-6-3.5">¶</a>
</li>
        <li id="section-6-3.6">P6 advertises label 20 for the PE2 FEC.<a class="pilcrow" href="#section-6-3.6">¶</a>
</li>
        <li id="section-6-3.7">Traffic from PE1 to PE2 uses the shortest path.<a class="pilcrow" href="#section-6-3.7">¶</a>
</li>
      </ul>
<span id="name-example-illustrating-need-f"></span><div id="fig_stitching_example">
<figure id="figure-4">
        <div class="artwork art-text alignLeft" id="section-6-4.1">
<pre>        PE1 ----- P1 -- P2 -- P3 -- P4 ---- P5 --- P6 --- PE2
    --&gt;    +----+                   +----+   +----+  +----+
  IP Pkt   | IP |                   | IP |   | IP |  | IP |
           +----+                   +----+   +----+  +----+
           |1020|                   |1020|   | 20 |
           +----+                   +----+   +----+
                                    SPRING    LDP
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-4">Figure 4</a>:
<a class="selfRef" href="#name-example-illustrating-need-f">Example Illustrating Need for ELC Propagation</a>
        </figcaption></figure>
</div>
<p id="section-6-5">In terms of packet forwarding, by learning the Mapping Server Advertisement from P5, PE1 imposes a label 1020 to an IP packet destined to PE2.
 SPRING routers along the shortest path to PE2 will switch the traffic
 until it reaches P5. P5 will perform the LSP stitching by swapping the
 SPRING label 1020 to the LDP label 20 advertised by the next hop P6.
 P6 will finally forward the packet using the LDP label towards PE2.<a class="pilcrow" href="#section-6-5">¶</a></p>
<p id="section-6-6">
 PE1 cannot push an ELI/EL for the Binding SID without knowing that the
 tail end of the LSP associated with the binding (PE2) is entropy label capable.<a class="pilcrow" href="#section-6-6">¶</a></p>
<p id="section-6-7">
 To accommodate the mix of signaling protocols involved during the stitching, the entropy label capability <span class="bcp14">SHOULD</span> be propagated between the signaling domains.
 Each Binding SID <span class="bcp14">SHOULD</span> have its own entropy label capability that <span class="bcp14">MUST</span> be inherited from the entropy label capability of the associated LSP. 
 If the router advertising the Binding SID does not know the ELC state
 of the target FEC, it <span class="bcp14">MUST NOT</span> set the ELC for the
 Binding SID.
 An ingress node <span class="bcp14">MUST NOT</span> push an ELI/EL associated with
 a Binding SID unless this Binding SID has the entropy label capability.
 How the entropy label capability is advertised for a Binding SID is outside the scope of this document (see <a class="xref" href="#erld">Section 7.2.1</a> for potential approaches).<a class="pilcrow" href="#section-6-7">¶</a></p>
<p id="section-6-8">
 In our example, if PE2 is LDP entropy label capable, it will add the
 entropy label capability in its LDP advertisement. When P5 receives
 the FEC/label binding for PE2, it learns about the ELC and can set the
 ELC in the Mapping Server Advertisement. Thus, PE1 learns about the
 ELC of PE2 and may push an ELI/EL associated with the Binding SID.<a class="pilcrow" href="#section-6-8">¶</a></p>
<p id="section-6-9">
 The proposed solution only works if the SPRING router advertising the
 Binding SID is also performing the data-plane LSP stitching. 
 In our example, if the Mapping Server function is hosted on P8 instead
 of P5, P8 does not know about the ELC state of PE2's LDP FEC. As a
 consequence, it does not set the ELC for the associated Binding SID.<a class="pilcrow" href="#section-6-9">¶</a></p>
</section>
</div>
<div id="solution">
<section id="section-7">
      <h2 id="name-insertion-of-entropy-labels">
<a class="section-number selfRef" href="#section-7">7. </a><a class="section-name selfRef" href="#name-insertion-of-entropy-labels">Insertion of Entropy Labels for SPRING Path</a>
      </h2>
<div id="overview">
<section id="section-7.1">
        <h3 id="name-overview">
<a class="section-number selfRef" href="#section-7.1">7.1. </a><a class="section-name selfRef" href="#name-overview">Overview</a>
        </h3>
<p id="section-7.1-1">
 The solution described in this section follows the data-plane processing defined in <span>[<a class="xref" href="#RFC6790">RFC6790</a>]</span>. Within a SPRING path, a node may be ingress, egress, transit (regarding the entropy label processing described in <span>[<a class="xref" href="#RFC6790">RFC6790</a>]</span>), or it can be any combination of those.
 For example:<a class="pilcrow" href="#section-7.1-1">¶</a></p>
<ul>
<li id="section-7.1-2.1">The ingress node of a SPRING domain can be an ingress node from an entropy label perspective.<a class="pilcrow" href="#section-7.1-2.1">¶</a>
</li>
          <li id="section-7.1-2.2">Any LSR terminating a segment of the SPRING path is an egress node (because it terminates the segment) but can also be a transit node if the SPRING path is not terminated because there is a subsequent SPRING MPLS label in the stack.<a class="pilcrow" href="#section-7.1-2.2">¶</a>
</li>
          <li id="section-7.1-2.3">Any LSR processing a Binding SID may be a transit node and an
   ingress node (because it may push additional labels when processing
   the Binding SID).<a class="pilcrow" href="#section-7.1-2.3">¶</a>
</li>
        </ul>
<p id="section-7.1-3">
 As described earlier, an LSR may have a limitation (the ERLD) on the depth of the label stack that it
   can read and process in order to do multipath load-balancing based on entropy labels.<a class="pilcrow" href="#section-7.1-3">¶</a></p>
<p id="section-7.1-4">If an EL does not occur within the ERLD of an
   LSR in the label stack of an MPLS packet that it receives, then it
   would lead to poor load-balancing at that LSR.  Hence, an ELI/EL pair
   must be within the ERLD of the LSR in order for the LSR to use the EL
   during load-balancing.<a class="pilcrow" href="#section-7.1-4">¶</a></p>
<p id="section-7.1-5">
   Adding a single ELI/EL pair for the entire SPRING path can also lead
   to poor load-balancing as well because the ELI/EL may not occur within
   the ERLD of some LSR on the path (if too deep) or may not be present
   in the stack when it reaches some LSRs (if it is too shallow).<a class="pilcrow" href="#section-7.1-5">¶</a></p>
<p id="section-7.1-6">
    In order for the EL to occur within the ERLD of LSRs along the path
   corresponding to a SPRING label stack, multiple &lt;ELI, EL&gt; pairs <span class="bcp14">MAY</span> be
   inserted in this label stack.<a class="pilcrow" href="#section-7.1-6">¶</a></p>
<p id="section-7.1-7">
   The insertion of an ELI/EL <span class="bcp14">MUST</span> occur only with a SPRING
   label advertised by an LSR that advertised an ERLD (the LSR is entropy
   label capable) or with a SPRING label associated with a Binding SID that has the ELC set.<a class="pilcrow" href="#section-7.1-7">¶</a></p>
<p id="section-7.1-8">
   The ELs among multiple &lt;ELI, EL&gt; pairs inserted in the
   stack <span class="bcp14">MAY</span> be the same or different. The LSR that inserts &lt;ELI, EL&gt; pairs
   can have limitations on the number of such pairs that it can insert
   and also the depth at which it can insert them.  If, due to 
   limitations, the inserted ELs are at positions such that an LSR along
   the path receives an MPLS packet without an EL in the label stack
   within that LSR's ERLD, then the load-balancing performed by that LSR
   would be poor. An implementation <span class="bcp14">MAY</span> consider multiple criteria when inserting &lt;ELI, EL&gt; pairs.<a class="pilcrow" href="#section-7.1-8">¶</a></p>
<div id="ex1">
<section id="section-7.1.1">
          <h4 id="name-example-1-the-ingress-node-">
<a class="section-number selfRef" href="#section-7.1.1">7.1.1. </a><a class="section-name selfRef" href="#name-example-1-the-ingress-node-">Example 1: The Ingress Node Has a Sufficient MSD</a>
          </h4>
<span id="name-accommodating-msd-limitatio"></span><div id="fig_ex1">
<figure id="figure-5">
            <div class="artwork art-text alignLeft" id="section-7.1.1-1.1">
<pre>                     ECMP          LAG           LAG
   PE1 --- P1 --- P2 --- P3 --- P4 --- P5 --- P6 --- PE2
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-5">Figure 5</a>:
<a class="selfRef" href="#name-accommodating-msd-limitatio">Accommodating MSD Limitations</a>
            </figcaption></figure>
</div>
<p id="section-7.1.1-2">
 In <a class="xref" href="#fig_ex1">Figure 5</a>, PE1 wants to forward some MPLS VPN traffic over an explicit path to PE2 resulting in the following label stack to be pushed onto the received IP header: &lt;Adj_P1P2, Adj_set_P2P3, Adj_P3P4, Adj_P4P5, Adj_P5P6, Adj_P6PE2, VPN_label&gt;.
PE1 is limited to push a maximum of 11 labels (MSD=11). P2, P3, and P6 have an ERLD of 3 while others have an ERLD of 10.<a class="pilcrow" href="#section-7.1.1-2">¶</a></p>
<p id="section-7.1.1-3">
 PE1 can only add two ELI/EL pairs in the label stack due to its MSD limitation. It should insert them strategically to benefit load-balancing along the longest part of the path.<a class="pilcrow" href="#section-7.1.1-3">¶</a></p>
<p id="section-7.1.1-4">
 PE1 can take into account multiple parameters when inserting ELs; as examples:<a class="pilcrow" href="#section-7.1.1-4">¶</a></p>
<ul>
<li id="section-7.1.1-5.1">The ERLD value advertised by transit nodes.<a class="pilcrow" href="#section-7.1.1-5.1">¶</a>
</li>
            <li id="section-7.1.1-5.2">The requirement of load-balancing for a particular label value.<a class="pilcrow" href="#section-7.1.1-5.2">¶</a>
</li>
            <li id="section-7.1.1-5.3">Any service provider preference: favor beginning of the path or end of the path.<a class="pilcrow" href="#section-7.1.1-5.3">¶</a>
</li>
          </ul>
<p id="section-7.1.1-6">
 In <a class="xref" href="#fig_ex1">Figure 5</a>, a good strategy may be to use the following stack &lt;Adj_P1P2, Adj_set_P2P3, ELI1, EL1, Adj_P3P4, Adj_P4P5, Adj_P5P6, Adj_P6PE2, ELI2, EL2, VPN_label&gt;.
The original stack requests P2 to forward based on an L3 adjacency-set that will require load-balancing. Therefore, it is important to ensure that P2 can load-balance correctly.
As P2 has a limited ERLD of 3, an ELI/EL must be inserted just after the label that P2 will use to forward.
On the path to PE2, P3 has also a limited ERLD, but P3 will forward based on a regular adjacency segment that may not require load-balancing. 
Therefore, it does not seem important to ensure that P3 can do load-balancing despite its limited ERLD.
The next nodes along the forwarding path have a high ERLD that does not cause
any issue, except P6. Moreover, P6 is using some LAGs to PE2 and so is
expected to load-balance. 
It becomes important to insert a new ELI/EL just after the P6 forwarding label.<a class="pilcrow" href="#section-7.1.1-6">¶</a></p>
<p id="section-7.1.1-7">
 In the case above, the ingress node was able to support a sufficient MSD to ensure
 end-to-end load-balancing while taking into account the path attributes.
However, there might be cases where the ingress node may not have the necessary label imposition capacity.<a class="pilcrow" href="#section-7.1.1-7">¶</a></p>
</section>
</div>
<div id="ex2">
<section id="section-7.1.2">
          <h4 id="name-example-2-the-ingress-node-">
<a class="section-number selfRef" href="#section-7.1.2">7.1.2. </a><a class="section-name selfRef" href="#name-example-2-the-ingress-node-">Example 2: The Ingress Node Does Not Have a Sufficient MSD</a>
          </h4>
<span id="name-msd-considerations"></span><div id="fig_ex2">
<figure id="figure-6">
            <div class="artwork art-text alignLeft" id="section-7.1.2-1.1">
<pre>                   ECMP          LAG           ECMP         ECMP
 PE1 --- P1 --- P2 --- P3 --- P4 --- P5 --- P6 --- P7 --- P8 --- PE2
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-6">Figure 6</a>:
<a class="selfRef" href="#name-msd-considerations">MSD Considerations</a>
            </figcaption></figure>
</div>
<p id="section-7.1.2-2">
 In <a class="xref" href="#fig_ex2">Figure 6</a>, PE1 wants to forward MPLS VPN traffic over an explicit path to PE2 resulting in the following label stack to be pushed onto the IP header: &lt;Adj_P1P2, Adj_set_P2P3, Adj_P3P4, Adj_P4P5, Adj_P5P6, Adj_set_P6P7, Adj_P7P8; Adj_set_P8PE2, VPN_label&gt;.
PE1 is limited to push a maximum of 11 labels. P2, P3, and P6 have an ERLD of 3 while others have an ERLD of 15.<a class="pilcrow" href="#section-7.1.2-2">¶</a></p>
<p id="section-7.1.2-3">
 Using a similar strategy as the previous case may lead to a dilemma, as PE1 can only push a single ELI/EL while we may need a minimum of three to load-balance the end-to-end path.
An optimized stack that would enable end-to-end load-balancing may be: &lt;Adj_P1P2, Adj_set_P2P3, ELI1, EL1, Adj_P3P4, Adj_P4P5, Adj_P5P6, Adj_set_P6P7, ELI2, EL2, Adj_P7P8, Adj_set_P8PE2, ELI3, EL3, VPN_label&gt;.<a class="pilcrow" href="#section-7.1.2-3">¶</a></p>
<p id="section-7.1.2-4">
 A decision needs to be taken to favor some part of the path for load-balancing considering that load-balancing may not work on the other parts.
A service provider may decide to place the ELI/EL after the P6 forwarding
label as it will allow P4 and P6 to load-balance. Placing the ELI/EL at the bottom of the stack is also a possibility enabling load-balancing for P4 and P8.<a class="pilcrow" href="#section-7.1.2-4">¶</a></p>
</section>
</div>
</section>
</div>
<div id="el_placement">
<section id="section-7.2">
        <h3 id="name-considerations-for-the-plac">
<a class="section-number selfRef" href="#section-7.2">7.2. </a><a class="section-name selfRef" href="#name-considerations-for-the-plac">Considerations for the Placement of Entropy Labels</a>
        </h3>
<p id="section-7.2-1">
 The sample cases described in the previous section showed that ELI/EL placement when the maximum number of labels to be pushed is limited is not an easy decision, and multiple criteria may be taken into account.<a class="pilcrow" href="#section-7.2-1">¶</a></p>
<p id="section-7.2-2">
 This section describes some considerations that an implementation <span class="bcp14">MAY</span> take into account when placing ELI/ELs. This list of criteria is not considered exhaustive and an implementation <span class="bcp14">MAY</span> take into account additional criteria or tiebreakers that are not documented here.
 As the insertion of ELI/ELs is performed by the ingress node, having ingress nodes that do not use the same criteria does not cause an interoperability issue. However, from a network design and operation perspective, it is better to have all ingress routers using the same criteria.<a class="pilcrow" href="#section-7.2-2">¶</a></p>
<p id="section-7.2-3">
 An implementation <span class="bcp14">SHOULD</span> try to maximize the possibility of load-balancing along the path by inserting an ELI/EL where multiple equal-cost paths are available and minimize the number of ELI/ELs that need to be inserted.
    In case of a trade-off, an implementation <span class="bcp14">SHOULD</span> provide flexibility to the operator to select the criteria to be considered when placing ELI/ELs or specify a subobjective for optimization.<a class="pilcrow" href="#section-7.2-3">¶</a></p>
<span id="name-msd-trade-offs"></span><div id="fig_consid_sample">
<figure id="figure-7">
          <div class="artwork art-text alignLeft" id="section-7.2-4.1">
<pre>                         2      2
   PE1 -- P1 -- P2 --P3 --- P4 --- P5 -- ... -- P8 -- P9 -- PE2
                     |             |
                     P3'--- P4'--- P5'
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-7">Figure 7</a>:
<a class="selfRef" href="#name-msd-trade-offs">MSD Trade-Offs</a>
          </figcaption></figure>
</div>
<p id="section-7.2-5"><a class="xref" href="#fig_consid_sample">Figure 7</a> will be used as reference in the following subsections. All
 metrics are equal to 1 except P3-P4 and P4-P5, which have a metric 2.
 We consider the MSD of nodes to be the full limit of label imposition
 (including service labels, entropy labels, and transport labels).<a class="pilcrow" href="#section-7.2-5">¶</a></p>
<div id="erld">
<section id="section-7.2.1">
          <h4 id="name-erld-value">
<a class="section-number selfRef" href="#section-7.2.1">7.2.1. </a><a class="section-name selfRef" href="#name-erld-value">ERLD Value</a>
          </h4>
<p id="section-7.2.1-1">
 As mentioned in <a class="xref" href="#overview">Section 7.1</a>, the ERLD value is an important parameter to consider when inserting an ELI/EL. If an ELI/EL does not fall within the ERLD of a node on the path, the node will not be able to load-balance the traffic efficiently.<a class="pilcrow" href="#section-7.2.1-1">¶</a></p>
<p id="section-7.2.1-2">
 The ERLD value can be advertised via protocols, and those extensions are described in separate documents (for instance, <span>[<a class="xref" href="#I-D.ietf-isis-mpls-elc">ISIS-ELC</a>]</span> and <span>[<a class="xref" href="#I-D.ietf-ospf-mpls-elc">OSPF-ELC</a>]</span>).<a class="pilcrow" href="#section-7.2.1-2">¶</a></p>
<p id="section-7.2.1-3">
 Let's consider a path from PE1 to PE2 using the following stack pushed by PE1: &lt;Adj_P1P2, Node_P9, Adj_P9PE2, Service_label&gt;.<a class="pilcrow" href="#section-7.2.1-3">¶</a></p>
<p id="section-7.2.1-4">
 Using the ERLD as an input parameter can help to minimize the number of required ELI/EL pairs to be inserted.
        An ERLD value must be retrieved for each SPRING label in the label stack.<a class="pilcrow" href="#section-7.2.1-4">¶</a></p>
<p id="section-7.2.1-5">
 For a label bound to an adjacency segment, the ERLD is the ERLD of the node that has advertised the adjacency segment. In the example above, the ERLD associated with Adj_P1P2 would be the ERLD of router P1, as P1 will perform the forwarding based on the Adj_P1P2 label.<a class="pilcrow" href="#section-7.2.1-5">¶</a></p>
<p id="section-7.2.1-6">
 For a label bound to a node segment, multiple strategies <span class="bcp14">MAY</span> be implemented. An implementation <span class="bcp14">MAY</span> try to evaluate the minimum ERLD value along the node segment path.
If an implementation cannot find the minimum ERLD along the path of the
segment or does not support the computation of the minimum ERLD, it <span class="bcp14">SHOULD</span>
instead use the ERLD of the tail-end node. Using the ERLD of the tail end of the node segment mimics the behavior of <span>[<a class="xref" href="#RFC6790">RFC6790</a>]</span> where the ingress takes only care of the egress of the LSP.  
In the example above, if the implementation supports computation of minimum ERLD along the path, the ERLD associated with label Node_P9 would be the minimum ERLD between nodes {P2,P3,P4 ..., P8}. 
If the implementation does not support the computation of minimum ERLD, it
will consider the ERLD of P9 (tail-end node of Node_P9 SID). While providing
the more optimal ELI/EL placement, evaluating the minimum ERLD increases the
complexity of ELI/EL insertion. As the path to the Node SID may change over time, a recomputation of the minimum ERLD is required for each topology change. This recomputation may require the positions of the ELI/ELs to change.<a class="pilcrow" href="#section-7.2.1-6">¶</a></p>
<p id="section-7.2.1-7">
For a label bound to a Binding Segment, if the Binding Segment describes a
path, an implementation <span class="bcp14">MAY</span> also try to evaluate the minimum ERLD along this
path. If the implementation cannot find the minimum ERLD along the path of the
segment or does not support this evaluation, it <span class="bcp14">SHOULD</span> instead use the ERLD of
the node advertising the Binding SID.  As for the node segment, evaluating the
minimum ERLD adds complexity in the ELI/EL insertion process.<a class="pilcrow" href="#section-7.2.1-7">¶</a></p>
</section>
</div>
<div id="sid-type">
<section id="section-7.2.2">
          <h4 id="name-segment-type">
<a class="section-number selfRef" href="#section-7.2.2">7.2.2. </a><a class="section-name selfRef" href="#name-segment-type">Segment Type</a>
          </h4>
<p id="section-7.2.2-1">
 Depending on the type of segment a particular label is bound
 to, an implementation can deduce that this particular label
 will be subject to load-balancing on the path.<a class="pilcrow" href="#section-7.2.2-1">¶</a></p>
<div id="node-sid">
<section id="section-7.2.2.1">
            <h5 id="name-node-sid">
<a class="section-number selfRef" href="#section-7.2.2.1">7.2.2.1. </a><a class="section-name selfRef" href="#name-node-sid">Node SID</a>
            </h5>
<p id="section-7.2.2.1-1">
 An MPLS label bound to a Node SID represents a path
 that may cross multiple hops.  Load-balancing may be
 needed on the node starting this path but also on any
 node along the path.<a class="pilcrow" href="#section-7.2.2.1-1">¶</a></p>
<p id="section-7.2.2.1-2">
 In <a class="xref" href="#fig_consid_sample">Figure 7</a>, let's consider a path from PE1 to PE2 using the following stack pushed by PE1: &lt;Adj_P1P2, Node_P9, Adj_P9PE2, Service_label&gt;.<a class="pilcrow" href="#section-7.2.2.1-2">¶</a></p>
<p id="section-7.2.2.1-3">
 If, for example, PE1 is limited to push 6 labels, it
 can add a single ELI/EL within the label stack.  An
 operator may want to favor a placement that would
 allow load-balancing along the Node SID path.  In
 <a class="xref" href="#fig_consid_sample">Figure 7</a>,
 P3, which is along the Node SID path,
 requires load-balancing between two equal-cost paths.<a class="pilcrow" href="#section-7.2.2.1-3">¶</a></p>
<p id="section-7.2.2.1-4">
An implementation <span class="bcp14">MAY</span> try to evaluate if load-balancing is really
   required within a node segment path. This could be done by running
   an additional SPT (Shortest Path Tree) computation and analyzing of the node segment path to 
   prevent a node segment that does not really require load-balancing from
   being preferred when placing ELI/ELs.  Such inspection may be time
   consuming for implementations and without a 100% guarantee, as a node
   segment path may use LAGs that are invisible to the IP
   topology.  As a simpler approach, an implementation <span class="bcp14">MAY</span> consider that a label bound
   to a Node SID will be subject to load-balancing and require an
   ELI/⁠EL.<a class="pilcrow" href="#section-7.2.2.1-4">¶</a></p>
</section>
</div>
<div id="adj-sid1">
<section id="section-7.2.2.2">
            <h5 id="name-adjacency-set-sid">
<a class="section-number selfRef" href="#section-7.2.2.2">7.2.2.2. </a><a class="section-name selfRef" href="#name-adjacency-set-sid">Adjacency-Set SID</a>
            </h5>
<p id="section-7.2.2.2-1">
 An adjacency-set is an Adj-SID that refers to a set of
 adjacencies. When an adjacency-set segment is used
 within a label stack, an implementation can deduce
 that load-balancing is expected at the node that
 advertised this adjacency segment.  An implementation
 <span class="bcp14">MAY</span> favor the insertion of an ELI/EL
 after the Adj-SID representing an adjacency-set.<a class="pilcrow" href="#section-7.2.2.2-1">¶</a></p>
</section>
</div>
<div id="adj-sid2">
<section id="section-7.2.2.3">
            <h5 id="name-adjacency-sid-representing-">
<a class="section-number selfRef" href="#section-7.2.2.3">7.2.2.3. </a><a class="section-name selfRef" href="#name-adjacency-sid-representing-">Adjacency SID Representing a Single IP Link</a>
            </h5>
<p id="section-7.2.2.3-1">
 When an adjacency segment representing a single IP link is used within a label stack, an implementation can deduce that load-balancing may not be expected at the node that advertised this adjacency segment.<a class="pilcrow" href="#section-7.2.2.3-1">¶</a></p>
<p id="section-7.2.2.3-2">
 An implementation <span class="bcp14">MAY</span> NOT place an ELI/EL after a regular Adj-SID in order to favor the insertion of ELI/ELs following other segments.<a class="pilcrow" href="#section-7.2.2.3-2">¶</a></p>
<p id="section-7.2.2.3-3">
 Readers should note that an adjacency segment representing a single IP link may require load-balancing. This is the case when a LAG (L2 bundle) is implemented between two IP nodes and the L2 bundle SR extensions <span>[<a class="xref" href="#RFC8668">RFC8668</a>]</span> are not implemented. 
 In such a case, it could be useful to insert an ELI/EL in a readable position for the LSR advertising the label associated with the adjacency segment.
 To communicate the requirement for load-balancing for
 a particular Adjacency SID to ingress nodes, a user can enforce the use of the L2 bundle SR extensions defined in <span>[<a class="xref" href="#RFC8668">RFC8668</a>]</span> or can declare the single adjacency as an adjacency-set.<a class="pilcrow" href="#section-7.2.2.3-3">¶</a></p>
</section>
</div>
<div id="adj-sid3">
<section id="section-7.2.2.4">
            <h5 id="name-adjacency-sid-representing-a">
<a class="section-number selfRef" href="#section-7.2.2.4">7.2.2.4. </a><a class="section-name selfRef" href="#name-adjacency-sid-representing-a">Adjacency SID Representing a Single Link within an L2 Bundle</a>
            </h5>
<p id="section-7.2.2.4-1">
 When the L2 bundle SR extensions <span>[<a class="xref" href="#RFC8668">RFC8668</a>]</span> are used, adjacency segments may be advertised for each member of the bundle.
 In this case, an implementation can deduce that load-balancing is not expected on the LSR advertising this segment and <span class="bcp14">MAY</span> NOT insert an ELI/EL after the corresponding label.<a class="pilcrow" href="#section-7.2.2.4-1">¶</a></p>
</section>
</div>
<div id="adj-sid4">
<section id="section-7.2.2.5">
            <h5 id="name-adjacency-sid-representing-an">
<a class="section-number selfRef" href="#section-7.2.2.5">7.2.2.5. </a><a class="section-name selfRef" href="#name-adjacency-sid-representing-an">Adjacency SID Representing an L2 Bundle</a>
            </h5>
<p id="section-7.2.2.5-1">
 When the L2 bundle SR extensions <span>[<a class="xref" href="#RFC8668">RFC8668</a>]</span> are used, an adjacency segment may be advertised to represent the bundle.
In this case, an implementation can deduce that load-balancing is expected on the LSR advertising this segment and <span class="bcp14">MAY</span> insert an ELI/EL after the corresponding label.<a class="pilcrow" href="#section-7.2.2.5-1">¶</a></p>
</section>
</div>
</section>
</div>
<section id="section-7.2.3">
          <h4 id="name-maximizing-number-of-lsrs-t">
<a class="section-number selfRef" href="#section-7.2.3">7.2.3. </a><a class="section-name selfRef" href="#name-maximizing-number-of-lsrs-t">Maximizing Number of LSRs That Will Load-Balance</a>
          </h4>
<p id="section-7.2.3-1">
 When placing ELI/ELs, an implementation <span class="bcp14">MAY</span>
 optimize the number of LSRs that both need to load-balance
 (i.e., have ECMPs) and that will be able to perform
 load-balancing (i.e., the EL is within their ERLD).<a class="pilcrow" href="#section-7.2.3-1">¶</a></p>
<p id="section-7.2.3-2">
 Let's consider a path from PE1 to PE2 using the following
 stack pushed by PE1: &lt;Adj_P1P2, Node_P9, Adj_P9PE2,
 Service_label&gt;.  All routers have an ERLD of 10 except P1
 and P2, which have an ERLD of 4. PE1 is able to push 6 labels,
 so only a single ELI/EL can be added.<a class="pilcrow" href="#section-7.2.3-2">¶</a></p>
<p id="section-7.2.3-3">
 In the example above, adding an ELI/EL after Adj_P1P2 will
 only allow load-balancing at P1, while inserting it after
 Adj_PE2P9 will allow load-balancing at P2, P3 ... P9 and
 maximize the number of LSRs that can perform load-balancing.<a class="pilcrow" href="#section-7.2.3-3">¶</a></p>
</section>
<section id="section-7.2.4">
          <h4 id="name-preference-for-a-part-of-th">
<a class="section-number selfRef" href="#section-7.2.4">7.2.4. </a><a class="section-name selfRef" href="#name-preference-for-a-part-of-th">Preference for a Part of the Path</a>
          </h4>
<p id="section-7.2.4-1">
 An implementation <span class="bcp14">MAY</span> allow the user to favor a part of the end-to-end path when the number of ELI/ELs that can be pushed is not enough to cover the entire path.
As an example, a service provider may want to favor load-balancing at the
beginning of the path or at the end of the path, so the implementation favors
putting the ELI/ELs near the top or the bottom of the stack.<a class="pilcrow" href="#section-7.2.4-1">¶</a></p>
</section>
<section id="section-7.2.5">
          <h4 id="name-combining-criteria">
<a class="section-number selfRef" href="#section-7.2.5">7.2.5. </a><a class="section-name selfRef" href="#name-combining-criteria">Combining Criteria</a>
          </h4>
<p id="section-7.2.5-1">
 An implementation <span class="bcp14">MAY</span> combine multiple criteria to determine
 the best ELI/ELs placement. However, combining too many
 criteria could lead to implementation complexity and high
 resource consumption.  Each time the network topology changes,
 a new evaluation of the ELI/EL placement will be necessary for
 each impacted LSP.<a class="pilcrow" href="#section-7.2.5-1">¶</a></p>
</section>
</section>
</div>
</section>
</div>
<div id="algo-example">
<section id="section-8">
      <h2 id="name-a-simple-example-algorithm">
<a class="section-number selfRef" href="#section-8">8. </a><a class="section-name selfRef" href="#name-a-simple-example-algorithm">A Simple Example Algorithm</a>
      </h2>
<p id="section-8-1">
 A simple implementation might take into account the ERLD when placing ELI/EL
 while trying to minimize the number of ELI/ELs inserted and trying to
 maximize the number of LSRs that can load-balance.<a class="pilcrow" href="#section-8-1">¶</a></p>
<p id="section-8-2">
 The example algorithm is based on the following considerations:<a class="pilcrow" href="#section-8-2">¶</a></p>
<ul>
<li id="section-8-3.1">An LSR that can insert a limited number of &lt;ELI, EL&gt; pairs should insert such pairs deeper in the stack.<a class="pilcrow" href="#section-8-3.1">¶</a>
</li>
        <li id="section-8-3.2">An LSR should try to insert &lt;ELI, EL&gt; pairs at positions to maximize the number of transit LSRs for which the EL occurs within the ERLD of those LSRs.<a class="pilcrow" href="#section-8-3.2">¶</a>
</li>
        <li id="section-8-3.3">An LSR should try to insert the minimum number of such pairs while trying to satisfy the above criteria.<a class="pilcrow" href="#section-8-3.3">¶</a>
</li>
      </ul>
<p id="section-8-4">
 The pseudocode of the example algorithm is shown below.<a class="pilcrow" href="#section-8-4">¶</a></p>
<span id="name-example-algorithm-to-insert"></span><figure id="figure-8">
        <div id="section-8-5.1">
<pre class="sourcecode lang-pseudocode">   Initialize the current EL insertion point to the
     bottom-most label in the stack that is EL-capable
   while (local-node can push more &lt;ELI,EL&gt; pairs OR
             insertion point is not above label stack) {
       insert an &lt;ELI,EL&gt; pair below current insertion point
       move new insertion point up from current insertion point until
           ((last inserted EL is below the ERLD) AND (ERLD &gt; 2)
                             AND
            (new insertion point is EL-capable))
       set current insertion point to new insertion point
   }
</pre><a class="pilcrow" href="#section-8-5.1">¶</a>
</div>
<figcaption><a class="selfRef" href="#figure-8">Figure 8</a>:
<a class="selfRef" href="#name-example-algorithm-to-insert">Example Algorithm to Insert &lt;ELI, EL&gt; Pairs in a Label Stack</a>
        </figcaption></figure>
<p id="section-8-6">
 When this algorithm is applied to the example described in <a class="xref" href="#usecase">Section 3</a>,
   it will result in ELs being inserted in two positions; one after the
   label L_N-D and another after L_N-P3.  Thus, the resulting label stack
   would be &lt;L_N-P3, ELI, EL, L_A-L1, L_N-D, ELI, EL&gt;.<a class="pilcrow" href="#section-8-6">¶</a></p>
</section>
</div>
<div id="deployment">
<section id="section-9">
      <h2 id="name-deployment-considerations">
<a class="section-number selfRef" href="#section-9">9. </a><a class="section-name selfRef" href="#name-deployment-considerations">Deployment Considerations</a>
      </h2>
<p id="section-9-1">
 As long as LSR node data-plane capabilities are limited (number of labels that can be pushed or number of labels that can be inspected), hop-by-hop load-balancing of SPRING-encapsulated flows will require trade-offs.<a class="pilcrow" href="#section-9-1">¶</a></p>
<p id="section-9-2">
 The entropy label is still a good and usable solution as it allows load-balancing without having to perform deep packet inspection on each LSR: It does not seem reasonable to have an LSR inspecting UDP ports within a GRE tunnel carried over a 15-label SPRING tunnel.<a class="pilcrow" href="#section-9-2">¶</a></p>
<p id="section-9-3">
 Due to the limited capacity of reading a deep stack of MPLS labels, multiple ELI/ELs may be required within the stack, which directly impacts the capacity of the head-end to push a deep stack: each ELI/EL inserted requires two additional labels to be pushed.<a class="pilcrow" href="#section-9-3">¶</a></p>
<p id="section-9-4">
 Placement strategies of ELI/ELs are required to find the best trade-off. Multiple criteria could be taken into account, and some level of customization (by the user) is required to accommodate different deployments.
 Since analyzing the path of each destination to determine the best ELI/EL placement may be time consuming for the control plane, we encourage implementations to find the best trade-off between simplicity, resource consumption, and load-balancing efficiency.<a class="pilcrow" href="#section-9-4">¶</a></p>
<p id="section-9-5">
 In the future, hardware and software capacity may increase data-plane capabilities and may remove some of these limitations, increasing load-balancing capability using entropy labels.<a class="pilcrow" href="#section-9-5">¶</a></p>
</section>
</div>
<div id="other-options">
<section id="section-10">
      <h2 id="name-options-considered">
<a class="section-number selfRef" href="#section-10">10. </a><a class="section-name selfRef" href="#name-options-considered">Options Considered</a>
      </h2>
<p id="section-10-1">Different options that were considered to arrive at the recommended
   solution are documented in this section.<a class="pilcrow" href="#section-10-1">¶</a></p>
<p id="section-10-2">
These options are detailed here only for historical purposes.<a class="pilcrow" href="#section-10-2">¶</a></p>
<section id="section-10.1">
        <h3 id="name-single-el-at-the-bottom-of-">
<a class="section-number selfRef" href="#section-10.1">10.1. </a><a class="section-name selfRef" href="#name-single-el-at-the-bottom-of-">Single EL at the Bottom of the Stack</a>
        </h3>
<p id="section-10.1-1">
 In this option, a single EL is used for the entire label stack.  The
   source LSR S encodes the entropy label at the bottom of the
   label stack.  In the example described in <a class="xref" href="#usecase">Section 3</a>, it will result
   in the label stack at LSR S to look like &lt;L_N-P3, L_A-L1, L_N-D, ELI,
   EL&gt; &lt;remaining packet header&gt;.  Note that the notation in <span>[<a class="xref" href="#RFC6790">RFC6790</a>]</span>
   is used to describe the label stack.  An issue with this approach is
   that as the label stack grows due an increase in the number of SIDs,
   the EL goes correspondingly deeper in the label stack.  Hence, transit
   LSRs have to access a larger number of bytes in the packet header
   when making forwarding decisions.  In the example described in
   <a class="xref" href="#usecase">Section 3</a>, if we consider that the LSR P1 has an ERLD of 3, P1 would 
   load-balance traffic poorly on the
   parallel links L3 and L4 since the EL is below the ERLD of P1.  
   A load-balanced network design using this approach
   must ensure that all intermediate LSRs have the capability to
   read the maximum label stack depth as required for the
   application that uses source-routed stacking.<a class="pilcrow" href="#section-10.1-1">¶</a></p>
<p id="section-10.1-2">
    This option was rejected since there exist a number of hardware
   implementations that have a low maximum readable label depth.
   Choosing this option can lead to a loss of load-balancing using EL in
   a significant part of the network when that is a critical requirement
   in a service-provider network.<a class="pilcrow" href="#section-10.1-2">¶</a></p>
</section>
<section id="section-10.2">
        <h3 id="name-an-el-per-segment-in-the-st">
<a class="section-number selfRef" href="#section-10.2">10.2. </a><a class="section-name selfRef" href="#name-an-el-per-segment-in-the-st">An EL per Segment in the Stack</a>
        </h3>
<p id="section-10.2-1">
 In this option, each segment/label in the stack can be given its own
 EL. When load-balancing is required to direct traffic on a segment,
 the source LSR pushes an &lt;ELI, EL&gt; before pushing the label
 associated to this segment.  In the example described in <a class="xref" href="#usecase">Section 3</a>, the source label stack that is LSR S encoded would
 be &lt;L_N-P3, ELI, EL, L_A-L1, L_N-D, ELI, EL&gt;, where all the ELs
 can be the same.  Accessing the EL at an intermediate LSR is
 independent of the depth of the label stack and hence, independent of
 the specific application that uses source-routed tunnels with label
 stacking.  A drawback is that the depth of the label stack grows
 significantly, almost 3 times as the number of labels in the label
 stack.  The network design should ensure that source LSRs have the
 capability to push such a deep label stack.  Also, the bandwidth
 overhead and potential MTU issues of deep label stacks should be
 considered in the network design.<a class="pilcrow" href="#section-10.2-1">¶</a></p>
<p id="section-10.2-2">
 This option was rejected due to the existence of hardware
   implementations that can push a limited number of labels on the label
   stack.  Choosing this option would result in a hardware requirement
   to push two additional labels per tunnel label.  Hence, it would
   restrict the number of tunnels that can be stacked in an LSP and hence,
   constrain the types of LSPs that can be created.  This was considered
   unacceptable.<a class="pilcrow" href="#section-10.2-2">¶</a></p>
</section>
<section id="section-10.3">
        <h3 id="name-a-reusable-el-for-a-stack-o">
<a class="section-number selfRef" href="#section-10.3">10.3. </a><a class="section-name selfRef" href="#name-a-reusable-el-for-a-stack-o">A Reusable EL for a Stack of Tunnels</a>
        </h3>
<p id="section-10.3-1">
 In this option, an LSR that terminates a tunnel reuses the EL of the
 terminated tunnel for the next inner tunnel.  It does this by storing
 the EL from the outer tunnel when that tunnel is terminated and
 reinserting it below the next inner tunnel label during the label-swap
 operation.  The LSR that stacks tunnels should insert an EL below the
 outermost tunnel.  It should not insert ELs for any inner tunnels.
 Also, the penultimate hop LSR of a segment must not pop the ELI and EL
 even though they are exposed as the top labels since the terminating
 LSR of that segment would reuse the EL for the next segment.<a class="pilcrow" href="#section-10.3-1">¶</a></p>
<p id="section-10.3-2">
 In <a class="xref" href="#usecase">Section 3</a>, the source label stack that is LSR S
 encoded would be &lt;L_N-P3, ELI, EL, L_A-L1, L_N-⁠D&gt;.  At P1, the
 outgoing label stack would be &lt;L_N-P3, ELI, EL, L_A-L1, L_N-D&gt;
 after it has load-balanced to one of the links L3 or L4.  At P3, the
 outgoing label stack would be &lt;L_N-D, ELI, EL&gt;.  At P2, the
 outgoing label stack would be &lt;L_N-D, ELI, EL&gt; and it would
 load-balance to one of the next-hop LSRs P4 or P5.  Accessing the EL at
 an intermediate LSR (e.g., P1) is independent of the depth of the
 label stack and hence, independent of the specific use case to which
 the label stack is applied.<a class="pilcrow" href="#section-10.3-2">¶</a></p>
<p id="section-10.3-3">
 This option was rejected due to the significant change in label-swap
   operations that would be required for existing hardware.<a class="pilcrow" href="#section-10.3-3">¶</a></p>
</section>
<section id="section-10.4">
        <h3 id="name-el-at-top-of-stack">
<a class="section-number selfRef" href="#section-10.4">10.4. </a><a class="section-name selfRef" href="#name-el-at-top-of-stack">EL at Top of Stack</a>
        </h3>
<p id="section-10.4-1">
 A slight variant of the reusable EL option is to keep the EL at the
   top of the stack rather than below the tunnel label.  In this case,
   each LSR that is not terminating a segment should continue to keep
   the received EL at the top of the stack when forwarding the packet
   along the segment.  An LSR that terminates a segment should use the
   EL from the terminated segment at the top of the stack when
   forwarding onto the next segment.<a class="pilcrow" href="#section-10.4-1">¶</a></p>
<p id="section-10.4-2">
 This option was rejected due to the significant change in label swap
   operations that would be required for existing hardware.<a class="pilcrow" href="#section-10.4-2">¶</a></p>
</section>
<section id="section-10.5">
        <h3 id="name-els-at-readable-label-stack">
<a class="section-number selfRef" href="#section-10.5">10.5. </a><a class="section-name selfRef" href="#name-els-at-readable-label-stack">ELs at Readable Label Stack Depths</a>
        </h3>
<p id="section-10.5-1">
 In this option, the source LSR inserts ELs for tunnels in the label
 stack at depths such that each LSR along the path that must load-balance is able to access at least one EL.  Note that the source LSR
 may have to insert multiple ELs in the label stack at different depths
 for this to work since intermediate LSRs may have differing
 capabilities in accessing the depth of a label stack.  The label stack
 depth access value of intermediate LSRs must be known to create such a
 label stack.  How this value is determined is outside the scope of
 this document.  This value can be advertised using a protocol such as
 an IGP.<a class="pilcrow" href="#section-10.5-1">¶</a></p>
<p id="section-10.5-2">
    Applying this method to the example in <a class="xref" href="#usecase">Section 3</a>, if LSR P1
   needs to have the EL within a depth of 4, then the source label stack that
   is LSR S encoded would be &lt;L_N-P3, ELI, EL, L_A-L1, L_N-D, ELI,
   EL&gt;, where all the ELs would typically have the same value.<a class="pilcrow" href="#section-10.5-2">¶</a></p>
<p id="section-10.5-3">
 In the case where the ERLD has different values along the path and the
   LSR that is inserting &lt;ELI, EL&gt; pairs has no limit on how many pairs
   it can insert, and it knows the appropriate positions in the stack
   where they should be inserted, this option is the same as the
 recommended solution in <a class="xref" href="#solution">Section 7</a>.<a class="pilcrow" href="#section-10.5-3">¶</a></p>
<p id="section-10.5-4">
 Note that a refinement of this solution, which balances the number of
   pushed labels against the desired entropy, is the solution described
   in <a class="xref" href="#solution">Section 7</a>.<a class="pilcrow" href="#section-10.5-4">¶</a></p>
</section>
</section>
</div>
<section id="section-11">
      <h2 id="name-iana-considerations">
<a class="section-number selfRef" href="#section-11">11. </a><a class="section-name selfRef" href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<p id="section-11-1"> This document has no IANA actions.<a class="pilcrow" href="#section-11-1">¶</a></p>
</section>
<section id="section-12">
      <h2 id="name-security-considerations">
<a class="section-number selfRef" href="#section-12">12. </a><a class="section-name selfRef" href="#name-security-considerations">Security Considerations</a>
      </h2>
<p id="section-12-1">Compared to <span>[<a class="xref" href="#RFC6790">RFC6790</a>]</span>, this document introduces the notion
of ERLD and MSD, and may require an ingress node to push multiple ELIs/ELs.
These changes do not introduce any new security considerations beyond those
already listed in <span>[<a class="xref" href="#RFC6790">RFC6790</a>]</span>.<a class="pilcrow" href="#section-12-1">¶</a></p>
</section>
<section id="section-13">
      <h2 id="name-references">
<a class="section-number selfRef" href="#section-13">13. </a><a class="section-name selfRef" href="#name-references">References</a>
      </h2>
<section id="section-13.1">
        <h3 id="name-normative-references">
<a class="section-number selfRef" href="#section-13.1">13.1. </a><a class="section-name selfRef" href="#name-normative-references">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC6790">[RFC6790]</dt>
        <dd>
<span class="refAuthor">Kompella, K.</span><span class="refAuthor">, Drake, J.</span><span class="refAuthor">, Amante, S.</span><span class="refAuthor">, Henderickx, W.</span><span class="refAuthor">, and L. Yong</span>, <span class="refTitle">"The Use of Entropy Labels in MPLS Forwarding"</span>, <span class="seriesInfo">RFC 6790</span>, <span class="seriesInfo">DOI 10.17487/RFC6790</span>, <time datetime="2012-11">November 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6790">https://www.rfc-editor.org/info/rfc6790</a>&gt;</span>. </dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dt id="RFC8402">[RFC8402]</dt>
        <dd>
<span class="refAuthor">Filsfils, C., Ed.</span><span class="refAuthor">, Previdi, S., Ed.</span><span class="refAuthor">, Ginsberg, L.</span><span class="refAuthor">, Decraene, B.</span><span class="refAuthor">, Litkowski, S.</span><span class="refAuthor">, and R. Shakir</span>, <span class="refTitle">"Segment Routing Architecture"</span>, <span class="seriesInfo">RFC 8402</span>, <span class="seriesInfo">DOI 10.17487/RFC8402</span>, <time datetime="2018-07">July 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8402">https://www.rfc-editor.org/info/rfc8402</a>&gt;</span>. </dd>
<dt id="RFC8660">[RFC8660]</dt>
      <dd>
<span class="refAuthor">Bashandy, A., Ed.</span><span class="refAuthor">, Filsfils, C., Ed.</span><span class="refAuthor">, Previdi, S.</span><span class="refAuthor">, Litkowski, S.</span><span class="refAuthor">, and R. Shakir</span>, <span class="refTitle">"Segment Routing with the MPLS Data Plane"</span>, <span class="seriesInfo">RFC 8660</span>, <span class="seriesInfo">DOI 10.17487/RFC8660</span>, <time datetime="2019-12">December 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8660">https://www.rfc-editor.org/info/rfc8660</a>&gt;</span>. </dd>
</dl>
</section>
<section id="section-13.2">
        <h3 id="name-informative-references">
<a class="section-number selfRef" href="#section-13.2">13.2. </a><a class="section-name selfRef" href="#name-informative-references">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-isis-mpls-elc">[ISIS-ELC]</dt>
        <dd>
<span class="refAuthor">Xu, X.</span><span class="refAuthor">, Kini, S.</span><span class="refAuthor">, Psenak, P.</span><span class="refAuthor">, Filsfils, C.</span><span class="refAuthor">, Litkowski, S.</span><span class="refAuthor">, and M. Bocci</span>, <span class="refTitle">"Signaling Entropy Label Capability and Entropy Readable Label Depth Using IS-IS"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-isis-mpls-elc-10</span>, <time datetime="2019-10-21">21 October 2019</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-isis-mpls-elc-10">https://tools.ietf.org/html/draft-ietf-isis-mpls-elc-10</a>&gt;</span>. </dd>
<dt id="I-D.ietf-ospf-mpls-elc">[OSPF-ELC]</dt>
        <dd>
<span class="refAuthor">Xu, X.</span><span class="refAuthor">, Kini, S.</span><span class="refAuthor">, Psenak, P.</span><span class="refAuthor">, Filsfils, C.</span><span class="refAuthor">, Litkowski, S.</span><span class="refAuthor">, and M. Bocci</span>, <span class="refTitle">"Signaling Entropy Label Capability and Entropy Readable Label-stack Depth Using OSPF"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-ospf-mpls-elc-12</span>, <time datetime="2019-10-25">25 October 2019</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-ospf-mpls-elc-12">https://tools.ietf.org/html/draft-ietf-ospf-mpls-elc-12</a>&gt;</span>. </dd>
<dt id="RFC8668">[RFC8668]</dt>
        <dd>
<span class="refAuthor">Ginsberg, L.</span><span class="refAuthor">, Bashandy, A.</span><span class="refAuthor">, Filsfils, C.</span><span class="refAuthor">, Nanduri, M.</span><span class="refAuthor">, and E. Aries</span>, <span class="refTitle">"Advertising Layer 2 Bundle Member Link Attributes in IS-IS"</span>, <span class="seriesInfo">RFC 8668</span>, <span class="seriesInfo">DOI 10.17487/RFC8668</span>, <time datetime="2019-12">December 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8668">https://www.rfc-editor.org/info/rfc8668</a>&gt;</span>. </dd>
<dt id="RFC7855">[RFC7855]</dt>
        <dd>
<span class="refAuthor">Previdi, S., Ed.</span><span class="refAuthor">, Filsfils, C., Ed.</span><span class="refAuthor">, Decraene, B.</span><span class="refAuthor">, Litkowski, S.</span><span class="refAuthor">, Horneffer, M.</span><span class="refAuthor">, and R. Shakir</span>, <span class="refTitle">"Source Packet Routing in Networking (SPRING) Problem Statement and Requirements"</span>, <span class="seriesInfo">RFC 7855</span>, <span class="seriesInfo">DOI 10.17487/RFC7855</span>, <time datetime="2016-05">May 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7855">https://www.rfc-editor.org/info/rfc7855</a>&gt;</span>. </dd>
<dt id="RFC8476">[RFC8476]</dt>
        <dd>
<span class="refAuthor">Tantsura, J.</span><span class="refAuthor">, Chunduri, U.</span><span class="refAuthor">, Aldrin, S.</span><span class="refAuthor">, and P. Psenak</span>, <span class="refTitle">"Signaling Maximum SID Depth (MSD) Using OSPF"</span>, <span class="seriesInfo">RFC 8476</span>, <span class="seriesInfo">DOI 10.17487/RFC8476</span>, <time datetime="2018-12">December 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8476">https://www.rfc-editor.org/info/rfc8476</a>&gt;</span>. </dd>
<dt id="RFC8491">[RFC8491]</dt>
        <dd>
<span class="refAuthor">Tantsura, J.</span><span class="refAuthor">, Chunduri, U.</span><span class="refAuthor">, Aldrin, S.</span><span class="refAuthor">, and L. Ginsberg</span>, <span class="refTitle">"Signaling Maximum SID Depth (MSD) Using IS-IS"</span>, <span class="seriesInfo">RFC 8491</span>, <span class="seriesInfo">DOI 10.17487/RFC8491</span>, <time datetime="2018-11">November 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8491">https://www.rfc-editor.org/info/rfc8491</a>&gt;</span>. </dd>
<dt id="I-D.ietf-idr-bgp-ls-segment-routing-msd">[MSD-BGP]</dt>
      <dd>
<span class="refAuthor">Tantsura, J.</span><span class="refAuthor">, Chunduri, U.</span><span class="refAuthor">, Talaulikar, K.</span><span class="refAuthor">, Mirsky, G.</span><span class="refAuthor">, and N. Triantafillis</span>, <span class="refTitle">"Signaling MSD (Maximum SID Depth) using Border Gateway Protocol Link-State"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-idr-bgp-ls-segment-routing-msd-09</span>, <time datetime="2019-10-15">15 October 2019</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-idr-bgp-ls-segment-routing-msd-09">https://tools.ietf.org/html/draft-ietf-idr-bgp-ls-segment-routing-msd-09</a>&gt;</span>. </dd>
</dl>
</section>
</section>
<section id="section-appendix.a">
      <h2 id="name-acknowledgements">
<a class="section-name selfRef" href="#name-acknowledgements">Acknowledgements</a>
      </h2>
<p id="section-appendix.a-1">The authors would like to thank John Drake, Loa Andersson, Curtis
   Villamizar, Greg Mirsky, Markus Jork, Kamran Raza, Carlos Pignataro, Bruno Decraene, Chris Bowers, Nobo Akiya, Daniele Ceccarelli, and Joe Clarke for
   their review, comments, and suggestions.<a class="pilcrow" href="#section-appendix.a-1">¶</a></p>
</section>
<section id="section-appendix.b">
      <h2 id="name-contributors">
<a class="section-name selfRef" href="#name-contributors">Contributors</a>
      </h2>
<div class="artwork art-text alignLeft" id="section-appendix.b-1">
<pre>Xiaohu Xu
Huawei
Email: xuxiaohu@huawei.com
</pre><a class="pilcrow" href="#section-appendix.b-1">¶</a>
</div>
<div class="artwork art-text alignLeft" id="section-appendix.b-2">
<pre>Wim Hendrickx
Nokia
Email: wim.henderickx@nokia.com
</pre><a class="pilcrow" href="#section-appendix.b-2">¶</a>
</div>
<div class="artwork art-text alignLeft" id="section-appendix.b-3">
<pre>Gunter Van de Velde
Nokia
Email: gunter.van_de_velde@nokia.com
</pre><a class="pilcrow" href="#section-appendix.b-3">¶</a>
</div>
<div class="artwork art-text alignLeft" id="section-appendix.b-4">
<pre>Acee Lindem
Cisco
Email: acee@cisco.com
</pre><a class="pilcrow" href="#section-appendix.b-4">¶</a>
</div>
</section>
<div id="authors-addresses">
<section id="section-appendix.c">
      <h2 id="name-authors-addresses">
<a class="section-name selfRef" href="#name-authors-addresses">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Sriganesh Kini</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:sriganeshkini@gmail.com">sriganeshkini@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Kireeti Kompella</span></div>
<div class="left" dir="auto"><span class="org">Juniper</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:kireeti@juniper.net">kireeti@juniper.net</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Siva Sivabalan</span></div>
<div class="left" dir="auto"><span class="org">Cisco</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:msiva@cisco.com">msiva@cisco.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Stephane Litkowski</span></div>
<div class="left" dir="auto"><span class="org">Orange</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:slitkows.ietf@gmail.com">slitkows.ietf@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Rob Shakir</span></div>
<div class="left" dir="auto"><span class="org">Google</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:robjs@google.com">robjs@google.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Jeff Tantsura</span></div>
<div class="left" dir="auto"><span class="org">Apstra, Inc.</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:jefftant.ietf@gmail.com">jefftant.ietf@gmail.com</a>
</div>
</address>
</section>
</div>
<script>var toc = document.getElementById("toc");
var tocToggle = toc.querySelector("h2");
var tocNav = toc.querySelector("nav");

// mobile menu toggle
tocToggle.onclick = function(event) {
    if (window.innerWidth < 1024) {
 var tocNavDisplay = tocNav.currentStyle ? tocNav.currentStyle.display : getComputedStyle(tocNav, null).display;
 if (tocNavDisplay == "none") {
     tocNav.style.display = "block";
 } else {
     tocNav.style.display = "none";
 }
    }
}

// toc anchor scroll to anchor
tocNav.addEventListener("click", function (event) {
    event.preventDefault();
    if (event.target.nodeName == 'A') {
 if (window.innerWidth < 1024) {
     tocNav.style.display = "none";
 }
 var href = event.target.getAttribute("href");
 var anchorId = href.substr(1);
 var anchor =  document.getElementById(anchorId);
 anchor.scrollIntoView(true);
 window.history.pushState("","",href);
    }
});

// switch toc mode when window resized
window.onresize = function () {
    if (window.innerWidth < 1024) {
 tocNav.style.display = "none";
    } else {
 tocNav.style.display = "block";
    }
}
</script>


</body></html>