<html><head></head><body><pre>Independent Submission                                 M. Boucadair, Ed.
Request for Comments: 7620                                    B. Chatras
Category: Informational                                           Orange
ISSN: 2070-1721                                                 T. Reddy
                                                           Cisco Systems
                                                             B. Williams
                                                            Akamai, Inc.
                                                             B. Sarikaya
                                                                  Huawei
                                                             August 2015


            <span class="h1">Scenarios with Host Identification Complications</span>

Abstract

   This document describes a set of scenarios in which complications
   when identifying which policy to apply for a host are encountered.
   This problem is abstracted as "host identification".  Describing
   these scenarios allows commonalities between scenarios to be
   identified, which is helpful during the solution design phase.

   This document does not include any solution-specific discussions.

IESG Note

   This document describes use cases where IP addresses are overloaded
   with both location and identity properties.  Such semantic
   overloading is seen as a contributor to a variety of issues within
   the routing system [<a href="./rfc4984" title='"Report from the IAB Workshop on Routing and Addressing"'>RFC4984</a>].  Additionally, these use cases may be
   seen as a way to justify solutions that are not consistent with IETF
   Best Current Practices on protecting privacy [<a href="#ref-BCP160" title='"An Architecture for Location and Location Privacy in Internet Applications"'>BCP160</a>] [<a href="#ref-BCP188" title='"Pervasive Monitoring Is an Attack"'>BCP188</a>].

Status of This Memo

   This document is not an Internet Standards Track specification; it is
   published for informational purposes.

   This is a contribution to the RFC Series, independently of any other
   RFC stream.  The RFC Editor has chosen to publish this document at
   its discretion and makes no statement about its value for
   implementation or deployment.  Documents approved for publication by
   the RFC Editor are not a candidate for any level of Internet
   Standard; see <a href="./rfc5741#section-2">SectionÂ 2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc7620">http://www.rfc-editor.org/info/rfc7620</a>.



<span class="grey">Boucadair, et al.             Informational                     [Page 1]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-2"></span>
<span class="grey"><a href="./rfc7620">RFC 7620</a>             Host Identification: Scenarios          August 2015</span>


Copyright Notice

   Copyright (c) 2015 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://www.rfc-editor.org/bcp/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.

Table of Contents

   <a href="#section-1">1</a>.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-3">3</a>
   <a href="#section-2">2</a>.  Scope . . . . . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-3">3</a>
   <a href="#section-3">3</a>.  Scenario 1: Carrier-Grade NAT (CGN) . . . . . . . . . . . . .   <a href="#page-4">4</a>
   <a href="#section-4">4</a>.  Scenario 2: Address plus Port (A+P) . . . . . . . . . . . . .   <a href="#page-5">5</a>
   <a href="#section-5">5</a>.  Scenario 3: On-Premise Application Proxy Deployment . . . . .   <a href="#page-6">6</a>
   <a href="#section-6">6</a>.  Scenario 4: Distributed Proxy Deployment  . . . . . . . . . .   <a href="#page-7">7</a>
   <a href="#section-7">7</a>.  Scenario 5: Overlay Network . . . . . . . . . . . . . . . . .   <a href="#page-8">8</a>
   8.  Scenario 6: Policy and Charging Control Architecture (PCC)  .  10
   <a href="#section-9">9</a>.  Scenario 7: Emergency Calls . . . . . . . . . . . . . . . . .  <a href="#page-12">12</a>
   <a href="#section-10">10</a>. Other Deployment Scenarios  . . . . . . . . . . . . . . . . .  <a href="#page-13">13</a>
     <a href="#section-10.1">10.1</a>.  Open WLAN or Provider WLAN . . . . . . . . . . . . . . .  <a href="#page-13">13</a>
     <a href="#section-10.2">10.2</a>.  Cellular Networks  . . . . . . . . . . . . . . . . . . .  <a href="#page-14">14</a>
     <a href="#section-10.3">10.3</a>.  Femtocells . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-14">14</a>
     <a href="#section-10.4">10.4</a>.  Traffic Detection Function (TDF) . . . . . . . . . . . .  <a href="#page-17">17</a>
     <a href="#section-10.5">10.5</a>.  Fixed and Mobile Network Convergence . . . . . . . . . .  <a href="#page-18">18</a>
   <a href="#section-11">11</a>. Synthesis . . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-21">21</a>
   <a href="#section-12">12</a>. Privacy Considerations  . . . . . . . . . . . . . . . . . . .  <a href="#page-21">21</a>
   <a href="#section-13">13</a>. Security Considerations . . . . . . . . . . . . . . . . . . .  <a href="#page-22">22</a>
   <a href="#section-14">14</a>. Informative References  . . . . . . . . . . . . . . . . . . .  <a href="#page-22">22</a>
   Acknowledgments . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-25">25</a>
   Contributors  . . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-25">25</a>
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-26">26</a>















<span class="grey">Boucadair, et al.             Informational                     [Page 2]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-3"></span>
<span class="grey"><a href="./rfc7620">RFC 7620</a>             Host Identification: Scenarios          August 2015</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" id="section-1">1</a>.  Introduction</span>

   The goal of this document is to enumerate scenarios that encounter
   the issue of uniquely identifying a host among those sharing the same
   IP address.  Within this document, a host can be any device directly
   connected to a network operated by a network provider, a Home
   Gateway, or a roaming device located behind a Home Gateway.

   An exhaustive list of encountered issues for the Carrier-Grade NAT
   (CGN), Address plus Port (A+P), and application proxies scenarios are
   documented in [<a href="./rfc6269" title='"Issues with IP Address Sharing"'>RFC6269</a>].  In addition to those issues, some of the
   scenarios described in this document suffer from additional issues
   such as:

   o  Identifying which policy to enforce for a host (e.g., limit access
      to the service based on some counters such as volume-based service
      offerings); enforcing the policy will have an impact on all hosts
      sharing the same IP address.
   o  Needing to correlate between the internal address:port and
      external address:port to generate and therefore enforce policies.
   o  Querying a location server for the location of an emergency caller
      based on the source IP address.

   The goal of this document is to identify scenarios the authors are
   aware of and that share the same complications in identifying which
   policy to apply for a host.  This problem is abstracted as the host
   identification problem.

   The analysis of the scenarios listed in this document indicates
   several root causes for the host identification issue:

   1.  Presence of address sharing (CGN, A+P, application proxies,
       etc.).
   2.  Use of tunnels between two administrative domains.
   3.  Combination of address sharing and presence of tunnels in the
       path.

   Even if these scenarios share the same root causes, describing the
   scenario allows to identify what is common between the scenarios, and
   then this information would help during the solution design phase.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/2.%20%20Scope"></a><a class="selflink" href="#section-2" id="section-2">2</a>.  Scope</span>

   This document can be used as a tool to design a solution(s) that
   mitigates the encountered issues.  Note, [<a href="./rfc6967" title='"Analysis of Potential Solutions for Revealing a Host Identifier (HOST_ID) in Shared Address Deployments"'>RFC6967</a>] focuses only on
   the CGN, A+P, and application proxies cases.  The analysis in
   [<a href="./rfc6967" title='"Analysis of Potential Solutions for Revealing a Host Identifier (HOST_ID) in Shared Address Deployments"'>RFC6967</a>] may not be accurate for some of the scenarios that do not
   span multiple administrative domains (e.g., <a href="#section-10.1">Section 10.1</a>).



<span class="grey">Boucadair, et al.             Informational                     [Page 3]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-4"></span>
<span class="grey"><a href="./rfc7620">RFC 7620</a>             Host Identification: Scenarios          August 2015</span>


   This document does not target means that would lead to exposing a
   host beyond what the original packet, issued from that host, would
   have already exposed.  Such means are not desirable nor required to
   solve the issues encountered in the scenarios discussed in this
   document.  The focus is exclusively on means to restore the
   information conveyed in the original packet issued by a given host.
   These means are intended to help in identifying which policy to apply
   for a given flow.  These means may rely on some bits of the source IP
   address and/or port number(s) used by the host to issue packets.

   To prevent side effects and misuses of such means on privacy, a
   solution specification document(s) should explain, in addition to
   what is already documented in [<a href="./rfc6967" title='"Analysis of Potential Solutions for Revealing a Host Identifier (HOST_ID) in Shared Address Deployments"'>RFC6967</a>], the following:

   o  To what extent the solution can be used to nullify the effect of
      using address sharing to preserve privacy (see, for example,
      [<a href="#ref-EFFOpenWireless">EFFOpenWireless</a>]).  Note, this concern can be mitigated if the
      address-sharing platform is under the responsibility of the host's
      owner and the host does not leak information that would interfere
      with the host's privacy protection tool.

   o  To what extent the solution can be used to expose privacy
      information beyond what the original packet would have already
      exposed.  Note, the solutions discussed in [<a href="./rfc6967" title='"Analysis of Potential Solutions for Revealing a Host Identifier (HOST_ID) in Shared Address Deployments"'>RFC6967</a>] do not allow
      extra information to be revealed other than what is conveyed in
      the original packet.

   This document covers both IPv4 and IPv6.

   This document does not include any solution-specific discussions.  In
   particular, the document does not elaborate whether explicit
   authentication is enabled or not.

   This document does not discuss whether specific information is needed
   to be leaked in packets, whether this is achieved out of band, etc.
   Those considerations are out of scope.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.%20%20Scenario%201%3A%20Carrier-Grade%20NAT%20%28CGN%29"></a><a class="selflink" href="#section-3" id="section-3">3</a>.  Scenario 1: Carrier-Grade NAT (CGN)</span>

   Several flavors of stateful CGN have been defined.  A non-exhaustive
   list is provided below:

   1.  IPv4-to-IPv4 NAT (NAT44) [<a href="./rfc6888" title='"Common Requirements for Carrier-Grade NATs (CGNs)"'>RFC6888</a>] [<a href="#ref-STATELESS-NAT44">STATELESS-NAT44</a>]

   2.  DS-Lite NAT44 [<a href="./rfc6333" title='"Dual- Stack Lite Broadband Deployments Following IPv4 Exhaustion"'>RFC6333</a>]

   3.  Network Address and Protocol Translation from IPv6 Clients to
       IPv4 Servers (NAT64) [<a href="./rfc6146" title='"Stateful NAT64: Network Address and Protocol Translation from IPv6 Clients to IPv4 Servers"'>RFC6146</a>]



<span class="grey">Boucadair, et al.             Informational                     [Page 4]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-5"></span>
<span class="grey"><a href="./rfc7620">RFC 7620</a>             Host Identification: Scenarios          August 2015</span>


   4.  IPv6-to-IPv6 Network Prefix Translation (NPTv6) [<a href="./rfc6296" title='"IPv6-to-IPv6 Network Prefix Translation"'>RFC6296</a>]

   As discussed in [<a href="./rfc6967" title='"Analysis of Potential Solutions for Revealing a Host Identifier (HOST_ID) in Shared Address Deployments"'>RFC6967</a>], remote servers are not able to distinguish
   between hosts sharing the same IP address (Figure 1).  As a reminder,
   remote servers rely on the source IP address for various purposes
   such as access control or abuse management.  The loss of the host
   identification will lead to issues discussed in [<a href="./rfc6269" title='"Issues with IP Address Sharing"'>RFC6269</a>].

   +-----------+
   |  HOST_1   |----+
   +-----------+    |        +--------------------+      +------------+
                    |        |                    |------|  Server 1  |
   +-----------+  +-----+    |                    |      +------------+
   |  HOST_2   |--| CGN |----|      INTERNET      |            ::
   +-----------+  +-----+    |                    |      +------------+
                     |       |                    |------|  Server n  |
   +-----------+     |       +--------------------+      +------------+
   |  HOST_3   |-----+
   +-----------+

                   Figure 1: CGN Reference Architecture

   Some of the above-referenced CGN scenarios will be satisfied by
   eventual completion of the transition to IPv6 across the Internet
   (e.g., NAT64), but this is not true of all CGN scenarios (e.g., NPTv6
   [<a href="./rfc6296" title='"IPv6-to-IPv6 Network Prefix Translation"'>RFC6296</a>]) for which some of the issues discussed in [<a href="./rfc6269" title='"Issues with IP Address Sharing"'>RFC6269</a>] will
   be encountered (e.g., impact on geolocation).

   Privacy-related considerations discussed in [<a href="./rfc6967" title='"Analysis of Potential Solutions for Revealing a Host Identifier (HOST_ID) in Shared Address Deployments"'>RFC6967</a>] apply for this
   scenario.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/4.%20%20Scenario%202%3A%20Address%20plus%20Port%20%28A%2BP%29"></a><a class="selflink" href="#section-4" id="section-4">4</a>.  Scenario 2: Address plus Port (A+P)</span>

   A+P [<a href="./rfc6346" title='"The Address plus Port (A+P) Approach to the IPv4 Address Shortage"'>RFC6346</a>] [<a href="./rfc7596" title='"Lightweight 4over6: An Extension to the Dual- Stack Lite Architecture"'>RFC7596</a>] [<a href="./rfc7597" title='"Mapping of Address and Port with Encapsulation (MAP-E)"'>RFC7597</a>] denotes a flavor of address-sharing
   solutions that does not require any additional NAT function to be
   enabled in the service provider's network.  A+P assumes subscribers
   are assigned with the same IPv4 address together with a port set.
   Subscribers assigned with the same IPv4 address should be assigned
   non-overlapping port sets.  Devices connected to an A+P-enabled
   network should be able to restrict the IPv4 source port to be within
   a configured range of ports.  To forward incoming packets to the
   appropriate host, a dedicated entity called the Port-Range Router
   (PRR) [<a href="./rfc6346" title='"The Address plus Port (A+P) Approach to the IPv4 Address Shortage"'>RFC6346</a>] is needed (Figure 2).

   Similar to the CGN case, remote servers rely on the source IP address
   for various purposes such as access control or abuse management.  The
   loss of the host identification will lead to the issues discussed in




<span class="grey">Boucadair, et al.             Informational                     [Page 5]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-6"></span>
<span class="grey"><a href="./rfc7620">RFC 7620</a>             Host Identification: Scenarios          August 2015</span>


   [<a href="./rfc6269" title='"Issues with IP Address Sharing"'>RFC6269</a>].  In particular, it will be impossible to identify hosts
   sharing the same IP address by remote servers.

   +-----------+
   |  HOST_1   |----+
   +-----------+    |        +--------------------+      +------------+
                    |        |                    |------|  Server 1  |
   +-----------+  +-----+    |                    |      +------------+
   |  HOST_2   |--| PRR |----|      INTERNET      |            ::
   +-----------+  +-----+    |                    |      +------------+
                     |       |                    |------|  Server n  |
   +-----------+     |       +--------------------+      +------------+
   |  HOST_3   |-----+
   +-----------+

                   Figure 2: A+P Reference Architecture

   Privacy-related considerations discussed in [<a href="./rfc6967" title='"Analysis of Potential Solutions for Revealing a Host Identifier (HOST_ID) in Shared Address Deployments"'>RFC6967</a>] apply for this
   scenario.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.%20%20Scenario%203%3A%20On-Premise%20Application%20Proxy%20Deployment"></a><a class="selflink" href="#section-5" id="section-5">5</a>.  Scenario 3: On-Premise Application Proxy Deployment</span>

   This scenario is similar to the CGN scenario (<a href="#section-3">Section 3</a>).

   Remote servers are not able to distinguish hosts located behind the
   proxy.  Applying policies on the perceived external IP address as
   received from the proxy will impact all hosts connected to that
   proxy.

   Figure 3 illustrates a simple configuration involving a proxy.  Note
   several (per-application) proxies may be deployed.  This scenario is
   a typical deployment approach used within enterprise networks.

   +-----------+
   |  HOST_1   |----+
   +-----------+    |        +--------------------+      +------------+
                    |        |                    |------|  Server 1  |
   +-----------+  +-----+    |                    |      +------------+
   |  HOST_2   |--|Proxy|----|      INTERNET      |            ::
   +-----------+  +-----+    |                    |      +------------+
                     |       |                    |------|  Server n  |
   +-----------+     |       +--------------------+      +------------+
   |  HOST_3   |-----+
   +-----------+

                  Figure 3: Proxy Reference Architecture





<span class="grey">Boucadair, et al.             Informational                     [Page 6]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-7"></span>
<span class="grey"><a href="./rfc7620">RFC 7620</a>             Host Identification: Scenarios          August 2015</span>


   The administrator of the proxy may have many reasons for wanting to
   proxy traffic - including caching, policy enforcement, malware
   scanning, reporting on network or user behavior for compliance, or
   security monitoring.

   The same administrator may also wish to selectively hide or expose
   the internal host identity to servers.  He/she may wish to hide the
   identity to protect end-user privacy or to reduce the ability of a
   rogue agent to learn the internal structure of the network.  He/she
   may wish to allow upstream servers to identify hosts to enforce
   access policies (for example, on documents or online databases), to
   enable account identification (on subscription-based services) or to
   prevent spurious misidentification of high-traffic patterns as a DoS
   attack.  Application-specific protocols exist for enabling such
   forwarding on some plaintext protocols (e.g., Forwarded headers on
   HTTP [<a href="./rfc7239" title='"Forwarded HTTP Extension"'>RFC7239</a>] or time-stamp-line headers in SMTP [<a href="./rfc5321" title='"Simple Mail Transfer Protocol"'>RFC5321</a>]).

   Servers not receiving such notifications but wishing to perform host
   or user-specific processing are obliged to use other application-
   specific means of identification (e.g., cookies [<a href="./rfc6265" title='"HTTP State Management Mechanism"'>RFC6265</a>]).

   Packets/connections must be received by the proxy regardless of the
   IP address family in use.  The requirements of this scenario are not
   satisfied by eventual completion of the transition to IPv6 across the
   Internet.  Complications will arise for both IPv4 and IPv6.

   Privacy-related considerations discussed in [<a href="./rfc6967" title='"Analysis of Potential Solutions for Revealing a Host Identifier (HOST_ID) in Shared Address Deployments"'>RFC6967</a>] apply for this
   scenario.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/6.%20%20Scenario%204%3A%20Distributed%20Proxy%20Deployment"></a><a class="selflink" href="#section-6" id="section-6">6</a>.  Scenario 4: Distributed Proxy Deployment</span>

   This scenario is similar to the proxy deployment scenario (<a href="#section-5">Section 5</a>)
   with the same use cases.  However, in this instance part of the
   functionality of the application proxy is located in a remote site.
   This may be desirable to reduce infrastructure and administration
   costs or because the hosts in question are mobile or roaming hosts
   tied to a particular administrative zone of control but not to a
   particular network.

   In some cases, a distributed proxy is required to identify a host on
   whose behalf it is performing the caching, filtering, or other
   desired service - for example, to know which policies to enforce.
   Typically, IP addresses are used as a surrogate.  However, in the
   presence of CGN, this identification becomes difficult.  Alternative
   solutions include the use of cookies, which only work for HTTP
   traffic, tunnels, or proprietary extensions to existing protocols.





<span class="grey">Boucadair, et al.             Informational                     [Page 7]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-8"></span>
<span class="grey"><a href="./rfc7620">RFC 7620</a>             Host Identification: Scenarios          August 2015</span>


      +-----------+             +----------+
      |  HOST_1   |-------------|          |
      +-----------+             |          |   +-------+    +----------+
                                |          |   |       |----| Server 1 |
      +-----------+             |          |   |       |    +----------+
      |  HOST_2   |----+        | INTERNET |---| Proxy |         ::
      +-----------+  +-----+    |          |   |       |    +----------+
                     |Proxy|----|          |   |       |----| Server n |
      +-----------+  +-----+    |          |   +-------+    +----------+
      |  HOST_3   |----+        +----------+
      +-----------+

          Figure 4: Distributed Proxy Reference Architecture (1)

       +-----------+         +---+         +---+  +----------+
       |  HOST_1   +---------+ I |         | I +--+ Server 1 |
       +-----------+         | N |  +---+  | N |  +----------+
                             | T |  | P |  | T |
       +-----------+  +---+  | E |  | r |  | E |  +----------+
       |  HOST_2   +--+ P |  | R +--+ o +--+ R +--+ Server 2 |
       +-----------+  | r |  | N |  | x |  | N |  +----------+
                      | o |--+ E |  | y |  | E |      ::
       +-----------+  | x |  | T |  +---+  | T |  +----------+
       |  HOST_3   +--+ y |  |   |         |   +--+ Server N |
       +-----------+  +---+  +---+         +---+  +----------+

          Figure 5: Distributed Proxy Reference Architecture (2)

   Packets/connections must be received by the proxy regardless of the
   IP address family in use.  The requirements of this scenario are not
   satisfied by eventual completion of the transition to IPv6 across the
   Internet.  Complications will arise for both IPv4 and IPv6.

   If the proxy and the servers are under the responsibility of the same
   administrative entity (Figure 4), no privacy concerns are raised.
   Nevertheless, privacy-related considerations discussed in [<a href="./rfc6967" title='"Analysis of Potential Solutions for Revealing a Host Identifier (HOST_ID) in Shared Address Deployments"'>RFC6967</a>]
   apply if the proxy and the servers are not managed by the same
   administrative entity (Figure 5).

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/7.%20%20Scenario%205%3A%20Overlay%20Network"></a><a class="selflink" href="#section-7" id="section-7">7</a>.  Scenario 5: Overlay Network</span>

   An overlay network is a network of machines distributed throughout
   multiple autonomous systems within the public Internet that can be
   used to improve the performance of data transport (see Figure 6).  IP
   packets from the sender are delivered first to one of the machines
   that make up the overlay network.  That machine then relays the IP





<span class="grey">Boucadair, et al.             Informational                     [Page 8]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-9"></span>
<span class="grey"><a href="./rfc7620">RFC 7620</a>             Host Identification: Scenarios          August 2015</span>


   packets to the receiver via one or more machines in the overlay
   network, applying various performance enhancement methods.

                    +------------------------------------+
                    |                                    |
                    |              INTERNET              |
                    |                                    |
     +-----------+  |  +------------+                    |
     |  HOST_1   |-----| OVRLY_IN_1 |-----------+        |
     +-----------+  |  +------------+           |        |
                    |                           |        |
     +-----------+  |  +------------+     +-----------+  |  +--------+
     |  HOST_2   |-----| OVRLY_IN_2 |-----| OVRLY_OUT |-----| Server |
     +-----------+  |  +------------+     +-----------+  |  +--------+
                    |                           |        |
     +-----------+  |  +------------+           |        |
     |  HOST_3   |-----| OVRLY_IN_3 |-----------+        |
     +-----------+  |  +------------+                    |
                    |                                    |
                    +------------------------------------+

             Figure 6: Overlay Network Reference Architecture

   Such overlay networks are used to improve the performance of content
   delivery [<a href="#ref-IEEE1344002">IEEE1344002</a>].  Overlay networks are also used for
   peer-to-peer data transport [<a href="./rfc5694" title='"Peer-to-Peer (P2P) Architecture: Definition, Taxonomies, Examples, and Applicability"'>RFC5694</a>], and they have been suggested
   for use in both improved scalability for the Internet routing
   infrastructure [<a href="./rfc6179" title='"The Internet Routing Overlay Network (IRON)"'>RFC6179</a>] and provisioning of security services
   (intrusion detection, anti-virus software, etc.) over the public
   Internet [<a href="#ref-IEEE101109">IEEE101109</a>].

   In order for an overlay network to intercept packets and/or
   connections transparently via base Internet connectivity
   infrastructure, the overlay ingress and egress hosts (OVERLAY_IN and
   OVERLAY_OUT) must be reliably in path in both directions between the
   connection-initiating HOST and the SERVER.  When this is not the
   case, packets may be routed around the overlay and sent directly to
   the receiving host, presumably without invoking some of the advanced
   service functions offered by the overlay.

   For public overlay networks, where the ingress and/or egress hosts
   are on the public Internet, packet interception commonly uses network
   address translation for the source (SNAT) or destination (DNAT)
   addresses in such a way that the public IP addresses of the true
   endpoint hosts involved in the data transport are invisible to each
   other (see Figure 7).  For example, the actual sender and receiver
   may use two completely different pairs of source and destination
   addresses to identify the connection on the sending and receiving



<span class="grey">Boucadair, et al.             Informational                     [Page 9]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-10"></span>
<span class="grey"><a href="./rfc7620">RFC 7620</a>             Host Identification: Scenarios          August 2015</span>


   networks in cases where both the ingress and egress hosts are on the
   public Internet.

             IP hdr contains:               IP hdr contains:
   SENDER -&gt; src = sender   --&gt; OVERLAY --&gt; src = overlay2  --&gt; RECEIVER
             dst = overlay1                 dst = receiver

              Figure 7: NAT Operations in an Overlay Network

   In this scenario, the remote server is not able to distinguish among
   hosts using the overlay for transport.  In addition, the remote
   server is not able to determine the overlay ingress point being used
   by the host, which can be useful for diagnosing host connectivity
   issues.

   In some of the above-referenced scenarios, IP packets traverse the
   overlay network fundamentally unchanged, with the overlay network
   functioning much like a CGN (<a href="#section-3">Section 3</a>).  In other cases, connection-
   oriented data flows (e.g., TCP) are terminated by the overlay in
   order to perform object caching and other such transport and
   application-layer optimizations, similar to the proxy scenario
   (<a href="#section-5">Section 5</a>).  In both cases, address sharing is a requirement for
   packet/connection interception, which means that the requirements for
   this scenario are not satisfied by the eventual completion of the
   transition to IPv6 across the Internet.

   More details about this scenario are provided in [<a href="#ref-OVERLAYPATH">OVERLAYPATH</a>].

   This scenario does not introduce privacy concerns since the
   identification of the host is local to a single administrative domain
   (i.e., Content Delivery Network (CDN) Overlay Network) or passed to a
   remote server to help forwarding back the response to the appropriate
   host.  The host identification information is not publicly available
   nor can be disclosed to other hosts connected to the Internet.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/8.%20%20Scenario%206%3A%20Policy%20and%20Charging%20Control%20Architecture%20%28PCC%29"></a><a class="selflink" href="#section-8" id="section-8">8</a>.  Scenario 6: Policy and Charging Control Architecture (PCC)</span>

   This issue is related to the PCC framework defined by 3GPP in
   [<a href="#ref-TS23.203" title='"Policy and charging control architecture (Release 11)"'>TS23.203</a>] when a NAT is located between the Policy and Charging
   Enforcement Function (PCEF) and the Application Function (AF) as
   shown in Figure 8.

   The main issue is: PCEF, the Policy and Charging Rule Function
   (PCRF), and AF all receive information bound to the same User
   Equipment (UE) but without being able to correlate between the piece
   of data visible for each entity.  Concretely,





<span class="grey">Boucadair, et al.             Informational                    [Page 10]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-11"></span>
<span class="grey"><a href="./rfc7620">RFC 7620</a>             Host Identification: Scenarios          August 2015</span>


   o  PCEF is aware of the International Mobile Subscriber Identity
      (IMSI) and an internal IP address assigned to the UE.

   o  AF receives an external IP address and port as assigned by the NAT
      function.

   o  PCRF is not able to correlate between the external IP address/port
      assigned by the NAT (received from the AF) and the internal IP
      address and IMSI of the UE (received from the PCEF).

               +------+
               | PCRF |-----------------+
               +------+                 |
                  |                     |
   +----+      +------+   +-----+    +-----+
   | UE |------| PCEF |---| NAT |----|  AF |
   +----+      +------+   +-----+    +-----+

                 Figure 8: NAT Located between AF and PCEF

   This scenario can be generalized as follows (Figure 9):

   o  Policy Enforcement Point (PEP) [<a href="./rfc2753" title='"A Framework for Policy-based Admission Control"'>RFC2753</a>]

   o  Policy Decision Point (PDP) [<a href="./rfc2753" title='"A Framework for Policy-based Admission Control"'>RFC2753</a>]

               +------+
               | PDP  |-----------------+
               +------+                 |
                  |                     |
   +----+      +------+   +-----+    +------+
   | UE |------| PEP  |---| NAT |----|Server|
   +----+      +------+   +-----+    +------+

             Figure 9: NAT Located between PEP and the Server

   Note that an issue is encountered to enforce per-UE policies when the
   NAT is located before the PEP function (see Figure 10):

                          +------+
                          | PDP  |------+
                          +------+      |
                             |          |
   +----+      +------+   +-----+    +------+
   | UE |------| NAT  |---| PEP |----|Server|
   +----+      +------+   +-----+    +------+

                     Figure 10: NAT Located before PEP



<span class="grey">Boucadair, et al.             Informational                    [Page 11]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-12"></span>
<span class="grey"><a href="./rfc7620">RFC 7620</a>             Host Identification: Scenarios          August 2015</span>


   This scenario does not introduce privacy concerns since the
   identification of the host is local to a single administrative domain
   and is meant to help identify which policy to select for a UE.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/9.%20%20Scenario%207%3A%20Emergency%20Calls"></a><a class="selflink" href="#section-9" id="section-9">9</a>.  Scenario 7: Emergency Calls</span>

   Voice Service Providers (VSPs) operating under certain jurisdictions
   are required to route emergency calls from their subscribers and have
   to include information about the caller's location in signaling
   messages they send towards Public Safety Answering Points (PSAPs)
   [<a href="./rfc6443" title='"Framework for Emergency Calling Using Internet Multimedia"'>RFC6443</a>] via an Emergency Service Routing Proxy (ESRP) [<a href="./rfc6443" title='"Framework for Emergency Calling Using Internet Multimedia"'>RFC6443</a>].
   This information is used both for the determination of the correct
   PSAP and to reveal the caller's location to the selected PSAP.

   In many countries, regulation bodies require that this information be
   provided by the network rather than the user equipment, in which case
   the VSP needs to retrieve this information (by reference or by value)
   from the access network where the caller is attached.

   This requires the VSP call server receiving an emergency call request
   to identify the relevant access network and to query a Location
   Information Server (LIS) in this network using a suitable lookup key.
   In the simplest case, the source IP address of the IP packet carrying
   the call request is used both for identifying the access network
   (thanks to a reverse DNS query) and as a lookup key to query the LIS.
   Obviously, the user-id as known by the VSP (e.g., telephone number or
   email-formatted URI) can't be used as it is not known by the access
   network.

   The above mechanism is broken when there is a NAT between the user
   and the VSP and/or if the emergency call is established over a VPN
   tunnel (e.g., an employee remotely connected to a company Voice over
   IP (VoIP) server through a tunnel wishes to make an emergency call).
   In such cases, the source IP address received by the VSP call server
   will identify the NAT or the address assigned to the caller equipment
   by the VSP (i.e., the address inside the tunnel).  This is similar to
   the CGN case in (<a href="#section-3">Section 3</a>) and overlay network case (<a href="#section-7">Section 7</a>) and
   applies irrespective of the IP versions used on both sides of the NAT
   and/or inside and outside the tunnel.

   Therefore, the VSP needs to receive an additional piece of
   information that can be used to both identify the access network
   where the caller is attached and query the LIS for his/her location.
   This would require the NAT or the tunnel endpoint to insert this
   extra information in the call requests delivered to the VSP call
   servers.  For example, this extra information could be a combination
   of the local IP address assigned by the access network to the




<span class="grey">Boucadair, et al.             Informational                    [Page 12]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-13"></span>
<span class="grey"><a href="./rfc7620">RFC 7620</a>             Host Identification: Scenarios          August 2015</span>


   caller's equipment with some form of identification of this access
   network.

   However, because it shall be possible to set up an emergency call
   regardless of the actual call control protocol used between the user
   and the VSP (e.g., SIP [<a href="./rfc3261" title='"SIP: Session Initiation Protocol"'>RFC3261</a>], Inter-Asterisk eXchange (IAX)
   [<a href="./rfc5456" title='"IAX: Inter-Asterisk eXchange Version 2"'>RFC5456</a>], tunneled over HTTP, or proprietary protocol, possibly
   encrypted), this extra information has to be conveyed outside the
   call request, in the header of lower-layer protocols.

   Privacy-related considerations discussed in [<a href="./rfc6967" title='"Analysis of Potential Solutions for Revealing a Host Identifier (HOST_ID) in Shared Address Deployments"'>RFC6967</a>] apply for this
   scenario.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/10.%20%20Other%20Deployment%20Scenarios"></a><a class="selflink" href="#section-10" id="section-10">10</a>.  Other Deployment Scenarios</span>

   This section lists deployment scenarios that are variants of
   scenarios described in previous sections.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/10.1.%20%20Open%20WLAN%20or%20Provider%20WLAN"></a><a class="selflink" href="#section-10.1" id="section-10.1">10.1</a>.  Open WLAN or Provider WLAN</span>

   In the context of Provider WLAN, a dedicated Service Set Identifier
   (SSID) can be configured and advertised by the Residential Gateway
   (RG) for visiting terminals.  These visiting terminals can be mobile
   terminals, PCs, etc.

   Several deployment scenarios are envisaged:

   1.  Deploy a dedicated node in the service provider's network that
       will be responsible for intercepting all the traffic issued from
       visiting terminals (see Figure 11).  This node may be co-located
       with a CGN function if private IPv4 addresses are assigned to
       visiting terminals.  Similar to the CGN case discussed in
       <a href="#section-3">Section 3</a>, remote servers may not be able to distinguish visiting
       hosts sharing the same IP address (see [<a href="./rfc6269" title='"Issues with IP Address Sharing"'>RFC6269</a>]).

   2.  Unlike the previous deployment scenario, IPv4 addresses are
       managed by the RG without requiring any additional NAT to be
       deployed in the service provider's network for handling traffic
       issued from visiting terminals.  Concretely, a visiting terminal
       is assigned with a private IPv4 address from the IPv4 address
       pool managed by the RG.  Packets issued from a visiting terminal
       are translated using the public IP address assigned to the RG
       (see Figure 12).  This deployment scenario induces the following
       identification concerns:







<span class="grey">Boucadair, et al.             Informational                    [Page 13]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-14"></span>
<span class="grey"><a href="./rfc7620">RFC 7620</a>             Host Identification: Scenarios          August 2015</span>


       *  The provider is not able to distinguish the traffic belonging
          to the visiting terminal from the traffic of the subscriber
          owning the RG.  This is needed to identify which policies are
          to be enforced such as: accounting, Differentiated Services
          Code Point (DSCP) remarking, black list, etc.

       *  Similar to the CGN case <a href="#section-3">Section 3</a>, a misbehaving visiting
          terminal is likely to have some impact on the experienced
          service by the subscriber owning the RG (e.g., some of the
          issues are discussed in [<a href="./rfc6269" title='"Issues with IP Address Sharing"'>RFC6269</a>]).

   +-------------+
   |Local_HOST_1 |----+
   +-------------+    |
                      |     |
   +-------------+  +-----+ |  +-----------+
   |Local_HOST_2 |--| RG  |-|--|Border Node|
   +-------------+  +-----+ |  +----NAT----+
                       |    |
   +-------------+     |    |  Service Provider
   |Visiting Host|-----+
   +-------------+

           Figure 11: NAT Enforced in a Service Provider's Node

   +-------------+
   |Local_HOST_1 |----+
   +-------------+    |
                      |     |
   +-------------+  +-----+ |  +-----------+
   |Local_HOST_2 |--| RG  |-|--|Border Node|
   +-------------+  +-NAT-+ |  +-----------+
                       |    |
   +-------------+     |    |  Service Provider
   |Visiting Host|-----+
   +-------------+

                     Figure 12: NAT Located in the RG

   This scenario does not introduce privacy concerns since the
   identification of the host is local to a single administrative domain
   and is meant to help identify which policy to select for a visiting
   UE.








<span class="grey">Boucadair, et al.             Informational                    [Page 14]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-15"></span>
<span class="grey"><a href="./rfc7620">RFC 7620</a>             Host Identification: Scenarios          August 2015</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/10.2.%20%20Cellular%20Networks"></a><a class="selflink" href="#section-10.2" id="section-10.2">10.2</a>.  Cellular Networks</span>

   Cellular operators allocate private IPv4 addresses to mobile
   terminals and deploy NAT44 function, generally co-located with
   firewalls, to access public IP services.  The NAT function is located
   at the boundaries of the Public Land Mobile Network (PLMN).
   IPv6-only strategy, consisting in allocating IPv6 prefixes only to
   mobile terminals, is considered by various operators.  A NAT64
   function is also considered in order to preserve IPv4 service
   continuity for these customers.

   These NAT44 and NAT64 functions bring some issues that are very
   similar to those mentioned in Figure 1 and <a href="#section-8">Section 8</a>.  These issues
   are particularly encountered if policies are to be applied on the Gi
   interface.

      Note: 3GPP defines the Gi interface as the reference point between
      the Gateway GPRS Support Node (GGSN) and an external Packet Domain
      Network (PDN).  This interface reference point is called SGi in 4G
      networks (i.e., between the PDN Gateway and an external PDN).

   Because private IP addresses are assigned to the mobile terminals,
   there is no correlation between the internal IP address and the
   external address:port assigned by the NAT function, etc.

   Privacy-related considerations discussed in [<a href="./rfc6967" title='"Analysis of Potential Solutions for Revealing a Host Identifier (HOST_ID) in Shared Address Deployments"'>RFC6967</a>] apply for this
   scenario.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/10.3.%20%20Femtocells"></a><a class="selflink" href="#section-10.3" id="section-10.3">10.3</a>.  Femtocells</span>

   This scenario can be seen as a combination of the scenarios described
   in Sections <a href="#section-8">8</a> and <a href="#section-10.1">10.1</a>.

   The reference architecture is shown in Figure 13.

   A Femto Access Point (FAP) is defined as a home base station used to
   graft a local (femto) cell within a user's home to a mobile network.














<span class="grey">Boucadair, et al.             Informational                    [Page 15]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-16"></span>
<span class="grey"><a href="./rfc7620">RFC 7620</a>             Host Identification: Scenarios          August 2015</span>


   +---------------------------+
   | +----+ +--------+  +----+ |   +-----------+  +-------------------+
   | | UE | | Stand- |&lt;=|====|=|===|===========|==|=&gt;+--+ +--+        |
   | +----+ | Alone  |  | RG | |   |           |  |  |  | |  | Mobile |
   |        |  FAP   |  +----+ |   |           |  |  |S | |F | Network|
   |        +--------+  (NAPT) |   | Broadband |  |  |e | |A |        |
   +---------------------------+   |   Fixed   |  |  |G |-|P | +-----+|
                                   |   (BBF)   |  |  |W | |G |-| Core||
   +---------------------------+   |  Network  |  |  |  | |W | | Ntwk||
   | +----+ +------------+     |   |           |  |  |  | |  | +-----+|
   | | UE | | Integrated |&lt;====|===|===========|==|=&gt;+--+ +--+        |
   | +----+ | FAP (NAPT) |     |   +-----------+  +-------------------+
   |        +------------+     |
   +---------------------------+

       &lt;=====&gt;   IPsec Tunnel
       CoreNtwk  Core Network
       FAPGW     FAP Gateway
       NAPT      Network Address Port Translator
       SeGW      Security Gateway

                Figure 13: Femtocell Reference Architecture

   UE is connected to the FAP at the RG, which is routed back to the
   3GPP Evolved Packet Core (EPC).  It is assumed that each UE is
   assigned an IPv4 address by the mobile network.  A mobile operator's
   FAP leverages the IPsec Internet Key Exchange Protocol Version 2
   (IKEv2) to interconnect FAP with the SeGW over the Broadband Fixed
   (BBF) network.  Both the FAP and the SeGW are managed by the mobile
   operator, which may be a different operator for the BBF network.

   An investigated scenario is when the mobile operator passes on its
   mobile subscriber's policies to the BBF to support traffic policy
   control.  But most of today's broadband fixed networks are relying on
   the private IPv4 addressing plan (+NAPT) to support its attached
   devices, including the mobile operator's FAP.  In this scenario, the
   mobile network needs to:

   o  determine the FAP's public IPv4 address to identify the location
      of the FAP to ensure its legitimacy to operate on the license
      spectrum for a given mobile operator prior to the FAP being ready
      to serve its mobile devices.

   o  determine the FAP's public IPv4 address together with the
      translated port number of the UDP header of the encapsulated IPsec
      tunnel for identifying the UE's traffic at the fixed broadband
      network.




<span class="grey">Boucadair, et al.             Informational                    [Page 16]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-17"></span>
<span class="grey"><a href="./rfc7620">RFC 7620</a>             Host Identification: Scenarios          August 2015</span>


   o  determine the corresponding FAP's public IPv4 address associated
      with the UE's inner IPv4 address that is assigned by the mobile
      network to identify the mobile UE, which allows the PCRF to
      retrieve the special UE's policy (e.g., QoS) to be passed onto the
      Broadband Policy Control Function (BPCF) at the BBF network.

   SeGW would have the complete knowledge of such mapping, but the
   reasons for being unable to use SeGW for this purpose are explained
   in Section 2 of [<a href="#ref-IKEv2-CP-EXT">IKEv2-CP-EXT</a>].

   This scenario involves PCRF/BPCF, but it is valid in other deployment
   scenarios making use of Authentication, Authorization, and Accounting
   (AAA) servers.

   The issue of correlating the internal IP address and the public IP
   address is valid even if there is no NAT in the path.

   This scenario does not introduce privacy concerns since the
   identification of the host is local to a single administrative domain
   and is meant to help identify which policy to select for a UE.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/10.4.%20%20Traffic%20Detection%20Function%20%28TDF%29"></a><a class="selflink" href="#section-10.4" id="section-10.4">10.4</a>.  Traffic Detection Function (TDF)</span>

   Operators expect that the traffic subject to the packet inspection is
   routed via the Traffic Detection Function (TDF) as per the
   requirement specified in [<a href="#ref-TS29.212" title='"Policy and Charging Control (PCC); Reference points (Release 11)"'>TS29.212</a>]; otherwise, the traffic may
   bypass the TDF.  This assumption only holds if it is possible to
   identify individual UEs behind the Basic NAT or NAPT invoked in the
   RG connected to the fixed broadband network, as shown in Figure 14.
   As a result, additional mechanisms are needed to enable this
   requirement.




















<span class="grey">Boucadair, et al.             Informational                    [Page 17]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-18"></span>
<span class="grey"><a href="./rfc7620">RFC 7620</a>             Host Identification: Scenarios          August 2015</span>


                                                              +--------+
                                                              |        |
                                                      +-------+  PCRF  |
                                                      |       |        |
                                                      |       +--------+
 +--------+      +--------+       +--------+     +----+----+
 |        |      |        |       |        +-----+         |
 |  ------------------------------------------------------------------
 |        |      |        |       |        |     |  TDF    |    /      \
 |  ****************************************************************** |
 +--------+      +--------+       +--------+     +----+----+   |       |
 |        |      |        +-------+        |         |         |Service|
 |        |      |        |       |        |         |          \      /
 |        |      |        |       |        |         |        +--------+
 |        |      |        |       |        |         +--------+  PDN   |
 |  &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; |
 |  UE    |      |   RG   |       | BNG    +------------------+ Gateway|
 +--------+      +--------+       +--------+                  +--------+

 Legend:
 ---------   3GPP UE User-Plane Traffic Offloaded subject to packet
             inspection

 *********   3GPP UE User-Plane Traffic Offloaded not subject to packet
             inspection

 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;   3GPP UE User-Plane Traffic Home Routed

       BNG   Broadband Network Gateway

                  Figure 14: UE's Traffic Routed with TDF

   This scenario does not introduce privacy concerns since the
   identification of the host is local to a single administrative domain
   and is meant to help identify which policy to select for a UE.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/10.5.%20%20Fixed%20and%20Mobile%20Network%20Convergence"></a><a class="selflink" href="#section-10.5" id="section-10.5">10.5</a>.  Fixed and Mobile Network Convergence</span>

   In the Policy for Convergence of Fixed Mobile Convergence (FMC)
   scenario, the fixed broadband network must partner with the mobile
   network to acquire the policies for the terminals or hosts attaching
   to the fixed broadband network, shown in Figure 15, so that host-
   specific QoS and accounting policies can be applied.

   A UE is connected to the RG, which is routed back to the mobile
   network.  The mobile operator's PCRF needs to maintain the
   interconnect with the BPCF in the BBF network for PCC (<a href="#section-8">Section 8</a>).
   The hosts (i.e., UEs) attaching to a fixed broadband network with a



<span class="grey">Boucadair, et al.             Informational                    [Page 18]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-19"></span>
<span class="grey"><a href="./rfc7620">RFC 7620</a>             Host Identification: Scenarios          August 2015</span>


   Basic NAT or NAPT deployed should be identified.  Based on the UE
   identification, the BPCF can acquire the associated policy rules of
   the identified UE from the PCRF in the mobile network so that it can
   enforce policy rules in the fixed broadband network.  Note, this
   scenario assumes private IPv4 addresses are assigned in the fixed
   broadband network.  Requirements similar to those in <a href="#section-10.3">Section 10.3</a> are
   raised in this scenario.

                +------------------------------+   +-------------+
                |                              |   |             |
                |                   +------+   |   | +------+    |
                |                   | BPCF +---+---+-+ PCRF |    |
                |                   +--+---+   |   | +---+--+    |
     +-------+  |                      |       |   |     |       |
     |HOST_1 | Private IP1          +--+---+   |   | +---+--+    |
     +-------+  | +----+            |      |   |   | |      |    |
                | | RG |            |      |   |   | |      |    |
                | |with+-------------+ BNG  +--------+ PGW  |    |
     +-------+  | | NAT|            |      |   |   | |      |    |
     |HOST_2 |  | +----+            |      |   |   | |      |    |
     +-------+ Private IP2          +------+   |   | +------+    |
                |                              |   |             |
                |                              |   |             |
                |                       Fixed  |   | Mobile      |
                |                   Broadband  |   | Network     |
                |                     Network  |   |             |
                |                              |   |             |
                +------------------------------+   +-------------+

   Figure 15: Reference Architecture for Policy for Convergence in Fixed
                    and Mobile Network Convergence (1)

   In an IPv6 network, similar issues exist when the IPv6 prefix is
   shared between multiple UEs attaching to the RG (see Figure 16).  The
   case applies when RG is assigned a single prefix, the home network
   prefix, e.g., using DHCPv6 Prefix Delegation [<a href="./rfc3633" title='"IPv6 Prefix Options for Dynamic Host Configuration Protocol (DHCP) version 6"'>RFC3633</a>] with the edge
   router, and BNG acts as the Delegating Router (DR).  RG uses the home
   network prefix in the address configuration using stateful (DHCPv6)
   or stateless address autoconfiguration (SLAAC) techniques.












<span class="grey">Boucadair, et al.             Informational                    [Page 19]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-20"></span>
<span class="grey"><a href="./rfc7620">RFC 7620</a>             Host Identification: Scenarios          August 2015</span>


                +------------------------------+   +-------------+
                |                              |   |             |
                |                              |   | +------+    |
                |                      +-------------+ PCRF |    |
                |                      |       |   | +---+--+    |
     +-------+  |                      |       |   |     |       |
     |HOST_1 |--+                   +--+---+   |   | +---+--+    |
     +-------+  | +----+            |      |   |   | |      |    |
                | | RG |            |      |   |   | |      |    |
                | |    +------------+ BNG  +---------+ PGW  |    |
     +-------+  | |    |            |      |   |   | |      |    |
     |HOST_2 |--+ +----+            |      |   |   | |      |    |
     +-------+  |                   +------+   |   | +------+    |
                |                              |   |             |
                |                              |   |             |
                |                       Fixed  |   | Mobile      |
                |                   Broadband  |   | Network     |
                |                     Network  |   |             |
                |                              |   |             |
                +------------------------------+   +-------------+

   Figure 16: Reference Architecture for Policy for Convergence in Fixed
                    and Mobile Network Convergence (2)

   BNG acting as PCEF initiates an IP Connectivity Access Network
   (IP-CAN) session with the policy server, a.k.a. Policy and Charging
   Rules Function (PCRF), to receive the Quality of Service (QoS)
   parameters and charging rules.  BNG provides the PCRF with the IPv6
   prefix assigned to the host; in this case, it's the home network
   prefix and an ID that has to be equal to the RG-specific home network
   line ID.

   HOST_1 in Figure 16 creates a 128-bit IPv6 address using this prefix
   and adding its interface ID.  Having completed the address
   configuration, the host can start communication with a remote host
   over the Internet.  However, no specific IP-CAN session can be
   assigned to HOST_1, and consequently the QoS and accounting performed
   will be based on RG subscription.

   Another host, e.g., HOST_2, attaches to the RG and also establishes
   an IPv6 address using the home network prefix.  The edge router, or
   BNG, is not involved with this or any other such address assignments.

   This leads to the case where no specific IP-CAN session/sub-session
   can be assigned to the hosts, HOST_1, HOST_2, etc., and consequently
   the QoS and accounting performed can only be based on RG subscription
   and is not host specific.  Therefore, IPv6 prefix sharing in the
   Policy for Convergence scenario leads to similar issues as the



<span class="grey">Boucadair, et al.             Informational                    [Page 20]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-21"></span>
<span class="grey"><a href="./rfc7620">RFC 7620</a>             Host Identification: Scenarios          August 2015</span>


   address sharing as explained in the previous scenarios in this
   document.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/11.%20%20Synthesis"></a><a class="selflink" href="#section-11" id="section-11">11</a>.  Synthesis</span>

   The following table shows whether each scenario is valid for IPv4/
   IPv6 and if it is within one single administrative domain or spans
   multiple domains.  The table also identifies the root cause of the
   identification issues.

   The IPv6 column indicates for each scenario whether IPv6 is supported
   at the client's side and/or server's side.

   +-------------------+----+-------------+------+-----------------+
   |                   |    |    IPv6     |Single|    Root Cause   |
   |      Scenario     |    |------+------|Domain+-------+---------+
   |                   |IPv4|Client|Server|      |Address|Tunneling|
   |                   |    |      |      |      |sharing|         |
   +-------------------+----+------+------+------+-------+---------+
   |        CGN        |Yes |Yes(1)|  No  |  No  |  Yes  |   No    |
   |        A+P        |Yes |  No  |  No  |  No  |  Yes  |   No    |
   | Application Proxy |Yes | Yes  | Yes  |  No  |  Yes  |   No    |
   | Distributed Proxy |Yes | Yes  | Yes  |Yes/No|  Yes  |   No    |
   |  Overlay Networks |Yes |Yes(2)|Yes(2)|  No  |  Yes  |   No    |
   |        PCC        |Yes |Yes(1)|  No  | Yes  |  Yes  |   No    |
   |  Emergency Calls  |Yes | Yes  | Yes  |  No  |  Yes  |   No    |
   |   Provider WLAN   |Yes |  No  |  No  | Yes  |  Yes  |   No    |
   | Cellular Networks |Yes |Yes(1)|  No  | Yes  |  Yes  |   No    |
   |     Femtocells    |Yes |  No  |  No  |  No  |  Yes  |  Yes    |
   |        TDF        |Yes | Yes  |  No  | Yes  |  Yes  |   No    |
   |        FMC        |Yes |Yes(1)|  No  |  No  |  Yes  |   No    |
   +-------------------+----+------+------+------+-------+---------+

    Notes:
      (1) For example, NAT64
      (2) This scenario is a combination of CGN and application proxies

                          Table 1: Synthesis

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/12.%20%20Privacy%20Considerations"></a><a class="selflink" href="#section-12" id="section-12">12</a>.  Privacy Considerations</span>

   Privacy-related considerations that apply to means to reveal a host
   identifier are discussed in [<a href="./rfc6967" title='"Analysis of Potential Solutions for Revealing a Host Identifier (HOST_ID) in Shared Address Deployments"'>RFC6967</a>].  This document does not
   introduce additional privacy issues than those discussed in
   [<a href="./rfc6967" title='"Analysis of Potential Solutions for Revealing a Host Identifier (HOST_ID) in Shared Address Deployments"'>RFC6967</a>].

   None of the scenarios inventoried in this document aim at revealing a
   customer identifier, account identifier, profile identifier, etc.



<span class="grey">Boucadair, et al.             Informational                    [Page 21]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-22"></span>
<span class="grey"><a href="./rfc7620">RFC 7620</a>             Host Identification: Scenarios          August 2015</span>


   Particularly, none of these scenarios are endorsing the functionality
   provided by the following proprietary headers (but not limited to)
   that are known to be used to leak subscription-related information:
   HTTP_MSISDN, HTTP_X_MSISDN, HTTP_X_UP_CALLING_LINE_ID,
   HTTP_X_NOKIA_MSISDN, HTTP_X_HTS_CLID, HTTP_X_MSP_CLID,
   HTTP_X_NX_CLID, HTTP__RAPMIN, HTTP_X_WAP_MSISDN, HTTP_COOKIE,
   HTTP_X_UP_LSID, HTTP_X_H3G_MSISDN, HTTP_X_JINNY_CID,
   HTTP_X_NETWORK_INFO, etc.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/13.%20%20Security%20Considerations"></a><a class="selflink" href="#section-13" id="section-13">13</a>.  Security Considerations</span>

   This document does not define an architecture nor a protocol; as such
   it does not raise any security concerns.  Security considerations
   that are related to the host identifier are discussed in [<a href="./rfc6967" title='"Analysis of Potential Solutions for Revealing a Host Identifier (HOST_ID) in Shared Address Deployments"'>RFC6967</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/14.%20%20Informative%20References"></a><a class="selflink" href="#section-14" id="section-14">14</a>.  Informative References</span>

   [<a id="ref-BCP160">BCP160</a>]   Barnes, R., Lepinski, M., Cooper, A., Morris, J.,
              Tschofenig, H., and H. Schulzrinne, "An Architecture for
              Location and Location Privacy in Internet Applications",
              <a href="https://www.rfc-editor.org/bcp/bcp160">BCP 160</a>, <a href="./rfc6280">RFC 6280</a>, July 2011.

   [<a id="ref-BCP188">BCP188</a>]   Farrell, S. and H. Tschofenig, "Pervasive Monitoring Is an
              Attack", <a href="https://www.rfc-editor.org/bcp/bcp188">BCP 188</a>, <a href="./rfc7258">RFC 7258</a>, May 2014.

   [<a id="ref-EFFOpenWireless">EFFOpenWireless</a>]
              EFF, "Open Wireless", 2014, &lt;<a href="https://www.eff.org/issues/open-wireless">https://www.eff.org/issues/</a>
              <a href="https://www.eff.org/issues/open-wireless">open-wireless</a>&gt;.

   [<a id="ref-IEEE101109">IEEE101109</a>]
              Salah, K., Calero, J., Zeadally, S., Almulla, S., and M.
              ZAaabi, "Using Cloud Computing to Implement a Security
              Overlay Network", IEEE Computer Society Digital Library,
              IEEE Security &amp; Privacy, Vol. 11, Issue 1, pp. 44-53,
              DOI 10.1109/MSP.2012.88, Jan-Feb 2013.

   [<a id="ref-IEEE1344002">IEEE1344002</a>]
              Byers, J., Considine, J., Mitzenmacher, M., and S. Rost,
              "Informed content delivery across adaptive overlay
              networks", IEEE/ACM Transactions on Networking, Vol. 12,
              Issue 5, pp. 767-780, DOI 10.1109/TNET.2004.836103,
              October 2004.

   [<a id="ref-IKEv2-CP-EXT">IKEv2-CP-EXT</a>]
              So, T., "IKEv2 Configuration Payload Extension for Private
              IPv4 Support for Fixed Mobile Convergence", Work in
              Progress, <a href="./draft-so-ipsecme-ikev2-cpext-02">draft-so-ipsecme-ikev2-cpext-02</a>, June 2012.




<span class="grey">Boucadair, et al.             Informational                    [Page 22]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-23"></span>
<span class="grey"><a href="./rfc7620">RFC 7620</a>             Host Identification: Scenarios          August 2015</span>


   [<a id="ref-OVERLAYPATH">OVERLAYPATH</a>]
              Williams, B., <a href="https://www.google.com/search?sitesearch=datatracker.ietf.org%2Fdoc%2Fhtml%2F&amp;q=inurl:draft-+%22Overlay+Path+Option+for+IP+and+TCP%22" style="text-decoration: none">"Overlay Path Option for IP and TCP"</a>, Work
              in Progress, <a href="./draft-williams-overlaypath-ip-tcp-rfc-04">draft-williams-overlaypath-ip-tcp-rfc-04</a>,
              June 2013.

   [<a id="ref-RFC2753">RFC2753</a>]  Yavatkar, R., Pendarakis, D., and R. Guerin, "A Framework
              for Policy-based Admission Control", <a href="./rfc2753">RFC 2753</a>,
              DOI 10.17487/RFC2753, January 2000,
              &lt;<a href="http://www.rfc-editor.org/info/rfc2753">http://www.rfc-editor.org/info/rfc2753</a>&gt;.

   [<a id="ref-RFC3261">RFC3261</a>]  Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston,
              A., Peterson, J., Sparks, R., Handley, M., and E.
              Schooler, "SIP: Session Initiation Protocol", <a href="./rfc3261">RFC 3261</a>,
              DOI 10.17487/RFC3261, June 2002,
              &lt;<a href="http://www.rfc-editor.org/info/rfc3261">http://www.rfc-editor.org/info/rfc3261</a>&gt;.

   [<a id="ref-RFC3633">RFC3633</a>]  Troan, O. and R. Droms, "IPv6 Prefix Options for Dynamic
              Host Configuration Protocol (DHCP) version 6", <a href="./rfc3633">RFC 3633</a>,
              DOI 10.17487/RFC3633, December 2003,
              &lt;<a href="http://www.rfc-editor.org/info/rfc3633">http://www.rfc-editor.org/info/rfc3633</a>&gt;.

   [<a id="ref-RFC4984">RFC4984</a>]  Meyer, D., Ed., Zhang, L., Ed., and K. Fall, Ed., "Report
              from the IAB Workshop on Routing and Addressing",
              <a href="./rfc4984">RFC 4984</a>, DOI 10.17487/RFC4984, September 2007,
              &lt;<a href="http://www.rfc-editor.org/info/rfc4984">http://www.rfc-editor.org/info/rfc4984</a>&gt;.

   [<a id="ref-RFC5321">RFC5321</a>]  Klensin, J., "Simple Mail Transfer Protocol", <a href="./rfc5321">RFC 5321</a>,
              DOI 10.17487/RFC5321, October 2008,
              &lt;<a href="http://www.rfc-editor.org/info/rfc5321">http://www.rfc-editor.org/info/rfc5321</a>&gt;.

   [<a id="ref-RFC5456">RFC5456</a>]  Spencer, M., Capouch, B., Guy, E., Ed., Miller, F., and K.
              Shumard, "IAX: Inter-Asterisk eXchange Version 2",
              <a href="./rfc5456">RFC 5456</a>, DOI 10.17487/RFC5456, February 2010,
              &lt;<a href="http://www.rfc-editor.org/info/rfc5456">http://www.rfc-editor.org/info/rfc5456</a>&gt;.

   [<a id="ref-RFC5694">RFC5694</a>]  Camarillo, G., Ed. and IAB, "Peer-to-Peer (P2P)
              Architecture: Definition, Taxonomies, Examples, and
              Applicability", <a href="./rfc5694">RFC 5694</a>, DOI 10.17487/RFC5694, November
              2009, &lt;<a href="http://www.rfc-editor.org/info/rfc5694">http://www.rfc-editor.org/info/rfc5694</a>&gt;.

   [<a id="ref-RFC6146">RFC6146</a>]  Bagnulo, M., Matthews, P., and I. van Beijnum, "Stateful
              NAT64: Network Address and Protocol Translation from IPv6
              Clients to IPv4 Servers", <a href="./rfc6146">RFC 6146</a>, DOI 10.17487/RFC6146,
              April 2011, &lt;<a href="http://www.rfc-editor.org/info/rfc6146">http://www.rfc-editor.org/info/rfc6146</a>&gt;.

   [<a id="ref-RFC6179">RFC6179</a>]  Templin, F., Ed., "The Internet Routing Overlay Network
              (IRON)", <a href="./rfc6179">RFC 6179</a>, DOI 10.17487/RFC6179, March 2011,
              &lt;<a href="http://www.rfc-editor.org/info/rfc6179">http://www.rfc-editor.org/info/rfc6179</a>&gt;.



<span class="grey">Boucadair, et al.             Informational                    [Page 23]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-24"></span>
<span class="grey"><a href="./rfc7620">RFC 7620</a>             Host Identification: Scenarios          August 2015</span>


   [<a id="ref-RFC6265">RFC6265</a>]  Barth, A., "HTTP State Management Mechanism", <a href="./rfc6265">RFC 6265</a>,
              DOI 10.17487/RFC6265, April 2011,
              &lt;<a href="http://www.rfc-editor.org/info/rfc6265">http://www.rfc-editor.org/info/rfc6265</a>&gt;.

   [<a id="ref-RFC6269">RFC6269</a>]  Ford, M., Ed., Boucadair, M., Durand, A., Levis, P., and
              P. Roberts, "Issues with IP Address Sharing", <a href="./rfc6269">RFC 6269</a>,
              DOI 10.17487/RFC6269, June 2011,
              &lt;<a href="http://www.rfc-editor.org/info/rfc6269">http://www.rfc-editor.org/info/rfc6269</a>&gt;.

   [<a id="ref-RFC6296">RFC6296</a>]  Wasserman, M. and F. Baker, "IPv6-to-IPv6 Network Prefix
              Translation", <a href="./rfc6296">RFC 6296</a>, DOI 10.17487/RFC6296, June 2011,
              &lt;<a href="http://www.rfc-editor.org/info/rfc6296">http://www.rfc-editor.org/info/rfc6296</a>&gt;.

   [<a id="ref-RFC6333">RFC6333</a>]  Durand, A., Droms, R., Woodyatt, J., and Y. Lee, "Dual-
              Stack Lite Broadband Deployments Following IPv4
              Exhaustion", <a href="./rfc6333">RFC 6333</a>, DOI 10.17487/RFC6333, August 2011,
              &lt;<a href="http://www.rfc-editor.org/info/rfc6333">http://www.rfc-editor.org/info/rfc6333</a>&gt;.

   [<a id="ref-RFC6346">RFC6346</a>]  Bush, R., Ed., "The Address plus Port (A+P) Approach to
              the IPv4 Address Shortage", <a href="./rfc6346">RFC 6346</a>,
              DOI 10.17487/RFC6346, August 2011,
              &lt;<a href="http://www.rfc-editor.org/info/rfc6346">http://www.rfc-editor.org/info/rfc6346</a>&gt;.

   [<a id="ref-RFC6443">RFC6443</a>]  Rosen, B., Schulzrinne, H., Polk, J., and A. Newton,
              "Framework for Emergency Calling Using Internet
              Multimedia", <a href="./rfc6443">RFC 6443</a>, DOI 10.17487/RFC6443, December
              2011, &lt;<a href="http://www.rfc-editor.org/info/rfc6443">http://www.rfc-editor.org/info/rfc6443</a>&gt;.

   [<a id="ref-RFC6888">RFC6888</a>]  Perreault, S., Ed., Yamagata, I., Miyakawa, S., Nakagawa,
              A., and H. Ashida, "Common Requirements for Carrier-Grade
              NATs (CGNs)", <a href="https://www.rfc-editor.org/bcp/bcp127">BCP 127</a>, <a href="./rfc6888">RFC 6888</a>, DOI 10.17487/RFC6888,
              April 2013, &lt;<a href="http://www.rfc-editor.org/info/rfc6888">http://www.rfc-editor.org/info/rfc6888</a>&gt;.

   [<a id="ref-RFC6967">RFC6967</a>]  Boucadair, M., Touch, J., Levis, P., and R. Penno,
              "Analysis of Potential Solutions for Revealing a Host
              Identifier (HOST_ID) in Shared Address Deployments",
              <a href="./rfc6967">RFC 6967</a>, DOI 10.17487/RFC6967, June 2013,
              &lt;<a href="http://www.rfc-editor.org/info/rfc6967">http://www.rfc-editor.org/info/rfc6967</a>&gt;.

   [<a id="ref-RFC7239">RFC7239</a>]  Petersson, A. and M. Nilsson, "Forwarded HTTP Extension",
              <a href="./rfc7239">RFC 7239</a>, DOI 10.17487/RFC7239, June 2014,
              &lt;<a href="http://www.rfc-editor.org/info/rfc7239">http://www.rfc-editor.org/info/rfc7239</a>&gt;.

   [<a id="ref-RFC7596">RFC7596</a>]  Cui, Y., Sun, Q., Boucadair, M., Tsou, T., Lee, Y., and I.
              Farrer, "Lightweight 4over6: An Extension to the Dual-
              Stack Lite Architecture", <a href="./rfc7596">RFC 7596</a>, DOI 10.17487/RFC7596,
              July 2015, &lt;<a href="http://www.rfc-editor.org/info/rfc7596">http://www.rfc-editor.org/info/rfc7596</a>&gt;.




<span class="grey">Boucadair, et al.             Informational                    [Page 24]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-25"></span>
<span class="grey"><a href="./rfc7620">RFC 7620</a>             Host Identification: Scenarios          August 2015</span>


   [<a id="ref-RFC7597">RFC7597</a>]  Troan, O., Ed., Dec, W., Li, X., Bao, C., Matsushima, S.,
              Murakami, T., and T. Taylor, Ed., "Mapping of Address and
              Port with Encapsulation (MAP-E)", <a href="./rfc7597">RFC 7597</a>,
              DOI 10.17487/RFC7597, July 2015,
              &lt;<a href="http://www.rfc-editor.org/info/rfc7597">http://www.rfc-editor.org/info/rfc7597</a>&gt;.

   [<a id="ref-STATELESS-NAT44">STATELESS-NAT44</a>]
              Tsou, T., Liu, W., Perreault, S., Penno, R., and M. Chen,
              "Stateless IPv4 Network Address Translation", Work in
              Progress, <a href="./draft-tsou-stateless-nat44-02">draft-tsou-stateless-nat44-02</a>, October 2012.

   [<a id="ref-TS23.203">TS23.203</a>] 3GPP, "Policy and charging control architecture (Release
              11)", 3GPP TS23.203, September 2012.

   [<a id="ref-TS29.212">TS29.212</a>] 3GPP, "Policy and Charging Control (PCC); Reference points
              (Release 11)", 3GPP TS29.212, December 2013.

Acknowledgments

   Many thanks to F. Klamm, D. Wing, D. von Hugo, G. Li, D. Liu, and
   Y. Lee for their review.

   J. Touch, S. Farrel, and S. Moonesamy provided useful comments in the
   intarea mailing list.

   Figure 8 and part of the text in <a href="#section-10.3">Section 10.3</a> were inspired by
   [<a href="#ref-IKEv2-CP-EXT">IKEv2-CP-EXT</a>].

Contributors

   Many thanks to the following people for contributing text and
   comments to the document:

   o  David Binet
   o  Sophie Durel
   o  Li Xue
   o  Richard Stewart Wheeldon














<span class="grey">Boucadair, et al.             Informational                    [Page 25]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-26"></span>
<span class="grey"><a href="./rfc7620">RFC 7620</a>             Host Identification: Scenarios          August 2015</span>


Authors' Addresses

   Mohamed Boucadair (editor)
   Orange
   Rennes  35000
   France

   Email: mohamed.boucadair@orange.com


   Bruno Chatras
   Orange
   Paris
   France

   Email: bruno.chatras@orange.com


   Tirumaleswar Reddy
   Cisco Systems
   Cessna Business Park, Varthur Hobli
   Sarjapur Marathalli Outer Ring Road
   Bangalore, Karnataka  560103
   India

   Email: tireddy@cisco.com


   Brandon Williams
   Akamai, Inc.
   Cambridge  MA
   United States

   Email: brandon.williams@akamai.com


   Behcet Sarikaya
   Huawei
   5340 Legacy Dr. Building 3,
   Plano, TX  75024
   United States

   Email: sarikaya@ieee.org








Boucadair, et al.             Informational                    [Page 26]
</pre>
</body></html>