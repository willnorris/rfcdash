<!DOCTYPE html>
<html class="RFC" lang="en"><head>
<meta charset="utf-8"/>
<meta content="Common,Latin" name="scripts"/>
<meta content="initial-scale=1.0" name="viewport"/>
<title>RFC 9491: Integration of the Network Service Header (NSH) and Segment Routing for Service Function Chaining (SFC)</title>
<meta content="James N Guichard" name="author"/>
<meta content="Jeff Tantsura" name="author"/>
<meta content="
        This document describes the integration of the Network Service
      Header (NSH) and Segment Routing (SR), as well as encapsulation details,
      to efficiently support Service Function Chaining (SFC) while maintaining
      separation of the service and transport planes as originally intended by
      the SFC architecture.
       
        Combining these technologies allows SR to be used for steering
      packets between Service Function Forwarders (SFFs) along a given Service
      Function Path (SFP), whereas the NSH is responsible for maintaining the
      integrity of the service plane, the SFC instance context, and any
      associated metadata.
       
        This integration demonstrates that the NSH and SR can work cooperatively
      and provide a network operator with the flexibility to use whichever
      transport technology makes sense in specific areas of their network
      infrastructure while still maintaining an end-to-end service plane using
      the NSH.
       
    " name="description"/>
<meta content="xml2rfc 3.18.2" name="generator"/>
<meta content="NSH" name="keyword"/>
<meta content="SR" name="keyword"/>
<meta content="MPLS-SR" name="keyword"/>
<meta content="SRv6" name="keyword"/>
<meta content="SFC" name="keyword"/>
<meta content="9491" name="rfc.number"/>
<!-- Generator version information:
  xml2rfc 3.18.2
    Python 3.9.15
    ConfigArgParse 1.5.3
    google-i18n-address 3.0.0
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 4.9.0
    platformdirs 3.8.0
    pycountry 22.3.5
    PyYAML 6.0
    requests 2.28.0
    setuptools 44.1.1
    six 1.16.0
    wcwidth 0.2.5
    weasyprint 56.1
-->
<link href="rfc9491.xml" rel="alternate" type="application/rfc+xml"/>
<link href="#copyright" rel="license"/>
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necessary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

:root {
  --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
  --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
  --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
}

@viewport {
  zoom: 1.0;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: var(--font-sans);
  line-height: 1.6;
  scroll-behavior: smooth;
  overflow-wrap: break-word;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
svg[font-family~="serif" i], svg [font-family~="serif" i] {
  font-family: var(--font-serif);
}
svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
  font-family: var(--font-sans);
}
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef,
.iref + a[href].internal {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre {
  background-color: #f9f9f9;
  font-family: var(--font-mono);
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
blockquote > *:last-child {
  margin-bottom: 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: var(--font-sans);
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  .breakable pre {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The following is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
.sourcecode pre,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .artwork > pre,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background slightly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottom margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the compact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div.sourcecode:first-child,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type:only-child {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css"/>
<link href="https://datatracker.ietf.org/doc/draft-ietf-spring-nsh-sr-15" rel="prev"/>
  <link href="https://dx.doi.org/10.17487/rfc9491" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  </head>
<body class="xml2rfc">
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 9491</td>
<td class="center">NSH SR SFC</td>
<td class="right">November 2023</td>
</tr></thead>
<tfoot><tr>
<td class="left">Guichard &amp; Tantsura</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div class="document-information" id="external-metadata"></div>
<div class="document-information" id="internal-metadata">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a class="eref" href="https://www.rfc-editor.org/rfc/rfc9491">9491</a></dd>
<dt class="label-category">Category:</dt>
<dd class="category">Standards Track</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time class="published" datetime="2023-11">November 2023</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">J. Guichard, <span class="editor">Ed.</span>
</div>
<div class="org">Futurewei Technologies</div>
</div>
<div class="author">
      <div class="author-name">J. Tantsura, <span class="editor">Ed.</span>
</div>
<div class="org">Nvidia</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 9491</h1>
<h1 id="title">Integration of the Network Service Header (NSH) and Segment Routing for Service Function Chaining (SFC)</h1>
<section id="section-abstract">
      <h2 id="abstract"><a class="selfRef" href="#abstract">Abstract</a></h2>
<p id="section-abstract-1"> This document describes the integration of the Network Service
      Header (NSH) and Segment Routing (SR), as well as encapsulation details,
      to efficiently support Service Function Chaining (SFC) while maintaining
      separation of the service and transport planes as originally intended by
      the SFC architecture.<a class="pilcrow" href="#section-abstract-1">¶</a></p>
<p id="section-abstract-2"> Combining these technologies allows SR to be used for steering
      packets between Service Function Forwarders (SFFs) along a given Service
      Function Path (SFP), whereas the NSH is responsible for maintaining the
      integrity of the service plane, the SFC instance context, and any
      associated metadata.<a class="pilcrow" href="#section-abstract-2">¶</a></p>
<p id="section-abstract-3"> This integration demonstrates that the NSH and SR can work cooperatively
      and provide a network operator with the flexibility to use whichever
      transport technology makes sense in specific areas of their network
      infrastructure while still maintaining an end-to-end service plane using
      the NSH.<a class="pilcrow" href="#section-abstract-3">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a class="section-name selfRef" href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This is an Internet Standards Track document.<a class="pilcrow" href="#section-boilerplate.1-1">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.<a class="pilcrow" href="#section-boilerplate.1-2">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc9491">https://www.rfc-editor.org/info/rfc9491</a></span>.<a class="pilcrow" href="#section-boilerplate.1-3">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a class="section-name selfRef" href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2023 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a class="pilcrow" href="#section-boilerplate.2-1">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a class="pilcrow" href="#section-boilerplate.2-2">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a class="toplink" href="#" onclick="scroll(0,0)">▲</a><h2 id="name-table-of-contents">
<a class="section-name selfRef" href="#name-table-of-contents">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p class="keepWithNext" id="section-toc.1-1.1.1"><a class="auto internal xref" href="#section-1">1</a>.  <a class="internal xref" href="#name-introduction">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p class="keepWithNext" id="section-toc.1-1.1.2.1.1"><a class="auto internal xref" href="#section-1.1">1.1</a>.  <a class="internal xref" href="#name-sfc-overview-and-rationale">SFC Overview and Rationale</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p class="keepWithNext" id="section-toc.1-1.1.2.2.1"><a class="auto internal xref" href="#section-1.2">1.2</a>.  <a class="internal xref" href="#name-requirements-language">Requirements Language</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a class="auto internal xref" href="#section-2">2</a>.  <a class="internal xref" href="#name-sfc-within-segment-routing-">SFC within Segment Routing Networks</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a class="auto internal xref" href="#section-3">3</a>.  <a class="internal xref" href="#name-nsh-based-sfc-with-sr-mpls-">NSH-Based SFC with SR-MPLS or the SRv6 Transport Tunnel</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a class="auto internal xref" href="#section-4">4</a>.  <a class="internal xref" href="#name-sr-based-sfc-with-the-integ">SR-Based SFC with the Integrated NSH Service Plane</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a class="auto internal xref" href="#section-5">5</a>.  <a class="internal xref" href="#name-packet-processing-for-sr-ba">Packet Processing for SR-Based SFC</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a class="auto internal xref" href="#section-5.1">5.1</a>.  <a class="internal xref" href="#name-sr-based-sfc-sr-mpls-packet">SR-Based SFC (SR-MPLS) Packet Processing</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a class="auto internal xref" href="#section-5.2">5.2</a>.  <a class="internal xref" href="#name-sr-based-sfc-srv6-packet-pr">SR-Based SFC (SRv6) Packet Processing</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a class="auto internal xref" href="#section-6">6</a>.  <a class="internal xref" href="#name-encapsulation">Encapsulation</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a class="auto internal xref" href="#section-6.1">6.1</a>.  <a class="internal xref" href="#name-nsh-using-sr-mpls-transport">NSH Using SR-MPLS Transport</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a class="auto internal xref" href="#section-6.2">6.2</a>.  <a class="internal xref" href="#name-nsh-using-srv6-transport">NSH Using SRv6 Transport</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a class="auto internal xref" href="#section-7">7</a>.  <a class="internal xref" href="#name-security-considerations">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a class="auto internal xref" href="#section-8">8</a>.  <a class="internal xref" href="#name-backwards-compatibility">Backwards Compatibility</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a class="auto internal xref" href="#section-9">9</a>.  <a class="internal xref" href="#name-caching-considerations">Caching Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a class="auto internal xref" href="#section-10">10</a>. <a class="internal xref" href="#name-mtu-considerations">MTU Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a class="auto internal xref" href="#section-11">11</a>. <a class="internal xref" href="#name-iana-considerations">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a class="auto internal xref" href="#section-11.1">11.1</a>.  <a class="internal xref" href="#name-protocol-number-for-the-nsh">Protocol Number for the NSH</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a class="auto internal xref" href="#section-11.2">11.2</a>.  <a class="internal xref" href="#name-srv6-endpoint-behavior-for-">SRv6 Endpoint Behavior for the NSH</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a class="auto internal xref" href="#section-12">12</a>. <a class="internal xref" href="#name-references">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a class="auto internal xref" href="#section-12.1">12.1</a>.  <a class="internal xref" href="#name-normative-references">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a class="auto internal xref" href="#section-12.2">12.2</a>.  <a class="internal xref" href="#name-informative-references">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a class="auto internal xref" href="#appendix-A"></a><a class="internal xref" href="#name-contributors">Contributors</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a class="auto internal xref" href="#appendix-B"></a><a class="internal xref" href="#name-authors-addresses">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<section id="section-1">
      <h2 id="name-introduction">
<a class="section-number selfRef" href="#section-1">1. </a><a class="section-name selfRef" href="#name-introduction">Introduction</a>
      </h2>
<p id="section-1-1"></p>
<section id="section-1.1">
        <h3 id="name-sfc-overview-and-rationale">
<a class="section-number selfRef" href="#section-1.1">1.1. </a><a class="section-name selfRef" href="#name-sfc-overview-and-rationale">SFC Overview and Rationale</a>
        </h3>
<p id="section-1.1-1"> The dynamic enforcement of a service-derived and adequate
        forwarding policy for packets entering a network that supports
        advanced Service Functions (SFs) has become a key challenge for
        network operators. For instance, cascading SFs at the Third
        Generation Partnership Project (3GPP) Gi interface (N6 interface in 5G
        architecture) has shown limitations such as 1) redundant
        classification features that must be supported by many SFs to execute
        their function; 2) some SFs that receive traffic that they are not supposed
        to process (e.g., TCP proxies receiving UDP traffic), which inevitably
        affects their dimensioning and performance; and 3) an increased design
        complexity related to the properly ordered invocation of several SFs.<a class="pilcrow" href="#section-1.1-1">¶</a></p>
<p id="section-1.1-2"> In order to solve those problems and to decouple the service's
        topology from the underlying physical network while allowing for
        simplified service delivery, SFC techniques have been introduced <span>[<a class="cite xref" href="#RFC7665">RFC7665</a>]</span>.<a class="pilcrow" href="#section-1.1-2">¶</a></p>
<p id="section-1.1-3"> SFC techniques are meant to rationalize the service delivery logic
        and reduce the resulting complexity while optimizing service
        activation time cycles for operators that need more agile service
        delivery procedures to better accommodate ever-demanding customer
        requirements. SFC allows network operators to dynamically create
        service planes that can be used by specific traffic flows. Each
        service plane is realized by invoking and chaining the relevant
        service functions in the right sequence.  <span>[<a class="cite xref" href="#RFC7498">RFC7498</a>]</span> provides an overview of the overall SFC problem
        space, and <span>[<a class="cite xref" href="#RFC7665">RFC7665</a>]</span> specifies an SFC
        data plane architecture.  The SFC architecture does not make
        assumptions on how advanced features (e.g., load balancing, loose or strict
        service paths) could be enabled within a domain. Various
        deployment options are made available to operators with the SFC
        architecture; this approach is fundamental to accommodate various
        and heterogeneous deployment contexts.<a class="pilcrow" href="#section-1.1-3">¶</a></p>
<p id="section-1.1-4">Many approaches can be considered for encoding the information
        required for SFC purposes (e.g., communicate a service chain pointer,
        encode a list of loose/explicit paths, or disseminate a service chain
        identifier together with a set of context information). Likewise, many
        approaches can also be considered for the channel to be used to carry
        SFC-specific information (e.g., define a new header, reuse existing
        packet header fields, or define an IPv6 extension header). Among all
        these approaches, the IETF created a transport-independent SFC
        encapsulation scheme: NSH <span>[<a class="cite xref" href="#RFC8300">RFC8300</a>]</span>. This design is pragmatic, as it does not require
        replicating the same specification effort as a function of underlying
        transport encapsulation. Moreover, this design approach encourages
        consistent SFC-based service delivery in networks enabling distinct
        transport protocols in various network segments or even between SFFs
        vs. SF-SFF hops.<a class="pilcrow" href="#section-1.1-4">¶</a></p>
</section>
<section id="section-1.2">
        <h3 id="name-requirements-language">
<a class="section-number selfRef" href="#section-1.2">1.2. </a><a class="section-name selfRef" href="#name-requirements-language">Requirements Language</a>
        </h3>
<p id="section-1.2-1"> The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>",
        "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>",
        "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
        "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document
        are to be interpreted as described in BCP 14 <span>[<a class="cite xref" href="#RFC2119">RFC2119</a>]</span> <span>[<a class="cite xref" href="#RFC8174">RFC8174</a>]</span> when, and only when, they
        appear in all capitals, as shown here.<a class="pilcrow" href="#section-1.2-1">¶</a></p>
</section>
</section>
<section id="section-2">
      <h2 id="name-sfc-within-segment-routing-">
<a class="section-number selfRef" href="#section-2">2. </a><a class="section-name selfRef" href="#name-sfc-within-segment-routing-">SFC within Segment Routing Networks</a>
      </h2>
<p id="section-2-1"><span>[<a class="cite xref" href="#RFC8300">RFC8300</a>]</span> specifies how to
      encapsulate the NSH directly within a link-layer header. In this
      document, IANA has assigned IP protocol number 145 for the NSH so that it
      can also be encapsulated directly within an IP header. The procedures
      that follow make use of this property.<a class="pilcrow" href="#section-2-1">¶</a></p>
<p id="section-2-2">As described in <span>[<a class="cite xref" href="#RFC8402">RFC8402</a>]</span>, SR
      leverages the source-routing technique. Concretely, a node steers a
      packet through an SR policy instantiated as an ordered list of
      instructions called segments. While initially designed for policy-based
      source routing, SR also finds its application in supporting SFC <span>[<a class="cite xref" href="#I-D.ietf-spring-sr-service-programming">SERVICE-PROGRAMMING</a>]</span>.<a class="pilcrow" href="#section-2-2">¶</a></p>
<p id="section-2-3"> The two SR data plane encapsulations, namely <span><a class="internal xref" href="#RFC8660">SR-MPLS</a> [<a class="cite xref" href="#RFC8660">RFC8660</a>]</span> and <span><a class="internal xref" href="#RFC8754">Segment Routing over IPv6 (SRv6)</a> [<a class="cite xref" href="#RFC8754">RFC8754</a>]</span>, can encode an
      SF as a segment so that a service function chain can be specified as a segment
      list. Nevertheless, and as discussed in <span>[<a class="cite xref" href="#RFC7498">RFC7498</a>]</span>, traffic steering is only a subset of the issues that
      motivated the design of the SFC architecture. Further considerations,
      such as simplifying classification at intermediate SFs and allowing for
      coordinated behaviors among SFs by means of supplying context
      information (a.k.a. metadata), should be considered when designing an
      SFC data plane solution.<a class="pilcrow" href="#section-2-3">¶</a></p>
<p id="section-2-4">While each scheme (i.e., NSH-based SFC and SR-based SFC) can work
      independently, this document describes how the two can be used together
      in concert and to complement each other through two representative
      application scenarios. Both application scenarios may be supported using
      either SR-MPLS or SRv6:<a class="pilcrow" href="#section-2-4">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-2-5">
        <dt id="section-2-5.1">NSH-based SFC with the SR-based transport plane:</dt>
        <dd id="section-2-5.2" style="margin-left: 1.5em">In this scenario, SR-MPLS or SRv6 provides the transport
 encapsulation between SFFs, while the NSH is used to convey and trigger SFC
 policies.<a class="pilcrow" href="#section-2-5.2">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.3">SR-based SFC with the integrated NSH service plane:</dt>
        <dd id="section-2-5.4" style="margin-left: 1.5em">In this scenario, each service hop of the service function chain
 is represented as a segment of the SR segment list. SR is thus
 responsible for steering traffic through the necessary SFFs as part of
 the segment routing path, while the NSH is responsible for maintaining
 the service plane and holding the SFC instance context (including
 associated metadata).<a class="pilcrow" href="#section-2-5.4">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-2-6">Of course, it is possible to combine both of these two scenarios to
      support specific deployment requirements and use cases.<a class="pilcrow" href="#section-2-6">¶</a></p>
<p id="section-2-7">A classifier <span class="bcp14">MUST</span> use one NSH Service Path Identifier
      (SPI) for each SR policy so that different traffic flows can use the
      same NSH Service Function Path (SFP) and different SR policies can
      coexist on the same SFP without conflict during SFF processing.<a class="pilcrow" href="#section-2-7">¶</a></p>
</section>
<section id="section-3">
      <h2 id="name-nsh-based-sfc-with-sr-mpls-">
<a class="section-number selfRef" href="#section-3">3. </a><a class="section-name selfRef" href="#name-nsh-based-sfc-with-sr-mpls-">NSH-Based SFC with SR-MPLS or the SRv6 Transport Tunnel</a>
      </h2>
<p id="section-3-1">Because of the transport-independent nature of NSH-based service
      function chains, it is expected that the NSH has broad applicability
      across different network domains (e.g., access, core).  By way of
      illustration, the various SFs involved in a service function chain may be
      available in a single data center or spread throughout multiple
      locations (e.g., data centers, different Points of Presence (POPs)),
      depending upon the network operator preference and/or availability of
      service resources. Regardless of where the SFs are deployed, it is
      necessary to provide traffic steering through a set of SFFs, and when
      NSH and SR are integrated, this is provided by SR-MPLS or SRv6.<a class="pilcrow" href="#section-3-1">¶</a></p>
<p id="section-3-2">The following three figures provide an example of an SFC-established
      flow F that has SF instances located in different data centers, DC1 and
      DC2. For the purpose of illustration, let the SFC's NSH SPI be 100 and
      the initial Service Index (SI) be 255.<a class="pilcrow" href="#section-3-2">¶</a></p>
<p id="section-3-3">Referring to <a class="auto internal xref" href="#figure_1">Figure 1</a>, packets of
      flow F in DC1 are classified into an NSH-based service function chain,
      encapsulated after classification as &lt;Inner Pkt&gt;&lt;NSH: SPI 100,
      SI 255&gt;&lt;Outer-transport&gt;, and forwarded to SFF1 (which is the
      first SFF hop for this service function chain).<a class="pilcrow" href="#section-3-3">¶</a></p>
<p id="section-3-4">After removing the outer transport encapsulation, SFF1 uses the SPI
      and SI carried within the NSH encapsulation to determine that it should
      forward the packet to SF1. SF1 applies its service, decrements the SI by
      1, and returns the packet to SFF1. Therefore, SFF1 has &lt;SPI 100, SI
      254&gt; when the packet comes back from SF1. SFF1 does a lookup on
      &lt;SPI 100, SI 254&gt;, which results in &lt;next-hop: DC1-GW1&gt; and
      forwards the packet to DC1-GW1.<a class="pilcrow" href="#section-3-4">¶</a></p>
<span id="name-sr-for-inter-dc-sfc-part-1"></span><div id="figure_1">
<figure id="figure-1">
        <div class="alignLeft art-text artwork" id="section-3-5.1">
<pre>+--------------------------- DC1 ----------------------------+
|                          +-----+                           |
|                          | SF1 |                           |
|                          +--+--+                           |
|                             |                              |
|                             |                              |
|        +------------+       |    +------------+            |
|        | N(100,255) |       |    | N(100,254) |            |
|        +------------+       |    +------------+            |
|        | F:Inner Pkt|       |    | F:Inner Pkt|            |
|        +------------+  ^    |  | +------------+            |
|                    (2) |    |  | (3)                       |
|                        |    |  v                           |
|                  (1)        |         (4)                  |
|+------------+   ----&gt;    +--+---+    ----&gt;     +---------+ |
||            |    NSH     |      |     NSH      |         | |
|| Classifier +------------+ SFF1 +--------------+ DC1-GW1 + |
||            |            |      |              |         | |
|+------------+            +------+              +---------+ |
|                                                            |
|             +------------+       +------------+            |
|             | N(100,255) |       | N(100,254) |            |
|             +------------+       +------------+            |
|             | F:Inner Pkt|       | F:Inner Pkt|            |
|             +------------+       +------------+            |
|                                                            |
+------------------------------------------------------------+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-1">Figure 1</a>:
<a class="selfRef" href="#name-sr-for-inter-dc-sfc-part-1">SR for Inter-DC SFC - Part 1</a>
        </figcaption></figure>
</div>
<p id="section-3-6"> Referring now to <a class="auto internal xref" href="#figure_2">Figure 2</a>, DC1-GW1
      performs a lookup using the information conveyed in the NSH, which
      results in &lt;next-hop: DC2-GW1, encapsulation: SR&gt;.  The SR
      encapsulation, which may be SR-MPLS or SRv6, has the SR segment list to
      forward the packet across the inter-DC network to DC2.<a class="pilcrow" href="#section-3-6">¶</a></p>
<span id="name-sr-for-inter-dc-sfc-part-2"></span><div id="figure_2">
<figure id="figure-2">
        <div class="alignLeft art-text artwork" id="section-3-7.1">
<pre>                  +----------- Inter DC ----------------+
           (4)    |                (5)                  |
+------+  ----&gt;   | +---------+   ----&gt;     +---------+ |
|      |   NSH    | |         |     SR      |         | |
+ SFF1 +----------|-+ DC1-GW1 +-------------+ DC2-GW1 + |
|      |          | |         |             |         | |
+------+          | +---------+             +---------+ |
                  |                                     |
                  |          +------------+             |
                  |          | S(DC2-GW1) |             |
                  |          +------------+             |
                  |          | N(100,254) |             |
                  |          +------------+             |
                  |          | F:Inner Pkt|             |
                  |          +------------+             |
                  +-------------------------------------+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-2">Figure 2</a>:
<a class="selfRef" href="#name-sr-for-inter-dc-sfc-part-2">SR for Inter-DC SFC - Part 2</a>
        </figcaption></figure>
</div>
<p id="section-3-8"> When the packet arrives at DC2, as shown in <a class="auto internal xref" href="#figure_3">Figure 3</a>, the SR encapsulation is removed, and DC2-GW1
      performs a lookup on the NSH, which results in next hop: SFF2. When SFF2
      receives the packet, it performs a lookup on &lt;NSH: SPI 100, SI
      254&gt; and determines to forward the packet to SF2. SF2 applies its
      service, decrements the SI by 1, and returns the packet to
      SFF2. Therefore, SFF2 has &lt;NSH: SPI 100, SI 253&gt; when the packet
      comes back from SF2.  SFF2 does a lookup on &lt;NSH: SPI 100, SI
      253&gt;, which results in the end of the service function chain.<a class="pilcrow" href="#section-3-8">¶</a></p>
<span id="name-sr-for-inter-dc-sfc-part-3"></span><div id="figure_3">
<figure id="figure-3">
        <div class="alignLeft art-text artwork" id="section-3-9.1">
<pre>                   +------------------------ DC2 ----------------------+
                   |                         +-----+                   |
                   |                         | SF2 |                   |
                   |                         +--+--+                   |
                   |                            |                      |
                   |                            |                      |
                   |        +------------+      |    +------------+    |
                   |        | N(100,254) |      |    | N(100,253) |    |
                   |        +------------+      |    +------------+    |
                   |        | F:Inner Pkt|      |    | F:Inner Pkt|    |
                   |        +------------+  ^   |  | +------------+    |
                   |                    (7) |   |  | (8)               |
                   |                        |   |  v                   |
             (5)   |                 (6)        |     (9)              |
+---------+  ---&gt;  | +----------+   ----&gt;    +--+---+ ----&gt;            |
|         |   SR   | |          |    NSH     |      |  IP              |
+ DC1-GW1 +--------|-+ DC2-GW1  +------------+ SFF2 |                  |
|         |        | |          |            |      |                  |
+---------+        | +----------+            +------+                  |
                   |                                                   |
                   |           +------------+      +------------+      |
                   |           | N(100,254) |      | F:Inner Pkt|      |
                   |           +------------+      +------------+      |
                   |           | F:Inner Pkt|                          |
                   |           +------------+                          |
                   +---------------------------------------------------+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-3">Figure 3</a>:
<a class="selfRef" href="#name-sr-for-inter-dc-sfc-part-3">SR for Inter-DC SFC - Part 3</a>
        </figcaption></figure>
</div>
<p id="section-3-10"> 
 
 
 The benefits of this scheme are listed hereafter:<a class="pilcrow" href="#section-3-10">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-11.1">The network operator is able to take advantage of the
        transport-independent nature of the NSH encapsulation while the
        service is provisioned end-to-end.<a class="pilcrow" href="#section-3-11.1">¶</a>
</li>
        <li class="normal" id="section-3-11.2">The network operator is able to take advantage of the
        traffic-steering (traffic-engineering) capability of SR where
        appropriate.<a class="pilcrow" href="#section-3-11.2">¶</a>
</li>
        <li class="normal" id="section-3-11.3">Clear responsibility division and scope between the NSH and SR.<a class="pilcrow" href="#section-3-11.3">¶</a>
</li>
      </ul>
<p id="section-3-12">Note that this scenario is applicable to any case where multiple
      segments of a service function chain are distributed across multiple
      domains or where traffic-engineered paths are necessary between SFFs
      (strict forwarding paths, for example). Further, note that the above
      example can also be implemented using end-to-end segment routing between
      SFF1 and SFF2. (As such, DC-GW1 and DC-GW2 are forwarding the packets
      based on segment routing instructions and are not looking at the NSH
      header for forwarding.)<a class="pilcrow" href="#section-3-12">¶</a></p>
</section>
<section id="section-4">
      <h2 id="name-sr-based-sfc-with-the-integ">
<a class="section-number selfRef" href="#section-4">4. </a><a class="section-name selfRef" href="#name-sr-based-sfc-with-the-integ">SR-Based SFC with the Integrated NSH Service Plane</a>
      </h2>
<p id="section-4-1">In this scenario, we assume that the SFs are NSH-aware; therefore,
      it should not be necessary to implement an SFC proxy to achieve SFC.
      The operation relies upon SR-MPLS or SRv6 to perform SFF-SFF transport
      and the NSH to provide the service plane between SFs, thereby maintaining SFC
      context (e.g., the service plane path referenced by the SPI) and any
      associated metadata.<a class="pilcrow" href="#section-4-1">¶</a></p>
<p id="section-4-2">When a service function chain is established, a packet associated
      with that chain will first carry an NSH that will be used to maintain
      the end-to-end service plane through use of the SFC context.  The SFC
      context is used by an SFF to determine the SR segment list for
      forwarding the packet to the next-hop SFFs.  The packet is then
      encapsulated using the SR header and forwarded in the SR domain
      following normal SR operations.<a class="pilcrow" href="#section-4-2">¶</a></p>
<p id="section-4-3">When a packet has to be forwarded to an SF attached to an SFF, the
      SFF performs a lookup on the segment identifier (SID) associated with
      the SF. In the case of SR-MPLS, this will be a Prefix-SID <span>[<a class="cite xref" href="#RFC8402">RFC8402</a>]</span>. In the case of SRv6, the behavior
      described within this document is assigned the name END.NSH, and <a class="auto internal xref" href="#NSHEPB">Section 11.2</a> describes the allocation of the code point by IANA. The
      result of this lookup allows the SFF to retrieve the next-hop context
      between the SFF and SF (e.g., the destination Media Access Control (MAC)
      address in case Ethernet encapsulation is used between the SFF and SF). In
      addition, the SFF strips the SR information from the packet, updates the
      SR information, and saves it to a cache indexed by the NSH Service Path
      Identifier (SPI) and the Service Index (SI) decremented by 1. This saved
      SR information is used to encapsulate and forward the packet(s) coming
      back from the SF.<a class="pilcrow" href="#section-4-3">¶</a></p>
<p id="section-4-4">The behavior of remembering the SR segment list occurs at the end of
      the regularly defined logic. The behavior of reattaching the
      segment list occurs before the SR process of forwarding the packet to
      the next entry in the segment list. Both behaviors are further detailed
      in <a class="auto internal xref" href="#sec-5">Section 5</a>.<a class="pilcrow" href="#section-4-4">¶</a></p>
<p id="section-4-5">When the SF receives the packet, it processes it as usual. When the
      SF is co-resident with a classifier, the already-processed packet may be
      reclassified. The SF sends the packet back to the SFF. Once the SFF
      receives this packet, it extracts the SR information using the NSH SPI
      and SI as the index into the cache. The SFF then pushes the retrieved SR
      header on top of the NSH header and forwards the packet to the next
      segment in the segment list. The lookup in the SFF cache might fail if
      reclassification at the SF changed the NSH SPI and/or SI to values that
      do not exist in the SFF cache. In such a case, the SFF must generate an
      error and drop the packet.<a class="pilcrow" href="#section-4-5">¶</a></p>
<p id="section-4-6"> <a class="auto internal xref" href="#figure_4">Figure 4</a> illustrates an example of
      this scenario.<a class="pilcrow" href="#section-4-6">¶</a></p>
<span id="name-nsh-over-sr-for-sfc"></span><div id="figure_4">
<figure id="figure-4">
        <div class="alignLeft art-text artwork" id="section-4-7.1">
<pre>                        +-----+                       +-----+
                        | SF1 |                       | SF2 |
                        +--+--+                       +--+--+
                           |                             |
                           |                             |
             +-----------+ | +-----------+ +-----------+ | +-----------+
             |N(100,255) | | |N(100,254) | |N(100,254) | | |N(100,253) |
             +-----------+ | +-----------+ +-----------+ | +-----------+
             |F:Inner Pkt| | |F:Inner Pkt| |F:Inner Pkt| | |F:Inner Pkt|
             +-----------+ | +-----------+ +-----------+ | +-----------+
                     (2) ^ | (3) |                 (5) ^ | (6) |
                         | |     |                     | |     |
                         | |     |                     | |     |
                 (1)     | |     v      (4)            | |     v (7)
+------------+   ---&gt;    +-+----+      ----&gt;          +---+--+   --&gt;
|            | NSHoverSR |      |    NSHoverSR        |      |    IP
| Classifier +-----------+ SFF1 +---------------------+ SFF2 |
|            |           |      |                     |      |
+------------+           +------+                     +------+

             +------------+        +------------+        +------------+
             |   S(SF1)   |        |   S(SF2)   |        | F:Inner Pkt|
             +------------+        +------------+        +------------+
             |   S(SFF2)  |        | N(100,254) |
             +------------+        +------------+
             |   S(SF2)   |        | F:Inner Pkt|
             +------------+        +------------+
             | N(100,255) |
             +------------+
             | F:Inner Pkt|
             +------------+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-4">Figure 4</a>:
<a class="selfRef" href="#name-nsh-over-sr-for-sfc">NSH over SR for SFC</a>
        </figcaption></figure>
</div>
<p id="section-4-8">The benefits of this scheme include the following:<a class="pilcrow" href="#section-4-8">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-9.1">It is economically sound for SF vendors to only support one
        unified SFC solution. The SF is unaware of the SR.<a class="pilcrow" href="#section-4-9.1">¶</a>
</li>
        <li class="normal" id="section-4-9.2">It simplifies the SFF (i.e., the SR router) by nullifying the
        needs for reclassification and SR proxy.<a class="pilcrow" href="#section-4-9.2">¶</a>
</li>
        <li class="normal" id="section-4-9.3">SR is also used for forwarding purposes, including between SFFs.<a class="pilcrow" href="#section-4-9.3">¶</a>
</li>
        <li class="normal" id="section-4-9.4">It takes advantage of SR to eliminate the NSH forwarding state in
        SFFs. This applies each time strict or loose SFPs are in use.<a class="pilcrow" href="#section-4-9.4">¶</a>
</li>
        <li class="normal" id="section-4-9.5">It requires no interworking, as would be the case if SR-MPLS-based
        SFC and NSH-based SFC were deployed as independent mechanisms in
        different parts of the network.<a class="pilcrow" href="#section-4-9.5">¶</a>
</li>
      </ul>
</section>
<div id="sec-5">
<section id="section-5">
      <h2 id="name-packet-processing-for-sr-ba">
<a class="section-number selfRef" href="#section-5">5. </a><a class="section-name selfRef" href="#name-packet-processing-for-sr-ba">Packet Processing for SR-Based SFC</a>
      </h2>
<p id="section-5-1"> This section describes the End.NSH behavior (SRv6), Prefix-SID
      behavior (SR-MPLS), and NSH processing logic.<a class="pilcrow" href="#section-5-1">¶</a></p>
<section id="section-5.1">
        <h3 id="name-sr-based-sfc-sr-mpls-packet">
<a class="section-number selfRef" href="#section-5.1">5.1. </a><a class="section-name selfRef" href="#name-sr-based-sfc-sr-mpls-packet">SR-Based SFC (SR-MPLS) Packet Processing</a>
        </h3>
<p id="section-5.1-1"> When an SFF receives a packet destined to S and S is a local
        Prefix-SID associated with an SF, the SFF strips the SR segment list
        (label stack) from the packet, updates the SR information, and saves
        it to a cache indexed by the NSH Service Path Identifier (SPI) and the
        Service Index (SI) decremented by 1. This saved SR information is used
        to re-encapsulate and forward the packet(s) coming back from the
        SF.<a class="pilcrow" href="#section-5.1-1">¶</a></p>
</section>
<section id="section-5.2">
        <h3 id="name-sr-based-sfc-srv6-packet-pr">
<a class="section-number selfRef" href="#section-5.2">5.2. </a><a class="section-name selfRef" href="#name-sr-based-sfc-srv6-packet-pr">SR-Based SFC (SRv6) Packet Processing</a>
        </h3>
<p id="section-5.2-1"> This section describes the End.NSH behavior and NSH processing
        logic for SRv6. The pseudocode is shown below.<a class="pilcrow" href="#section-5.2-1">¶</a></p>
<p id="section-5.2-2"> When N receives a packet destined to S and S is a local End.NSH
        SID, the processing is the same as that specified by <span>[<a class="cite xref" href="#RFC8754">RFC8754</a>], <a class="relref" href="https://rfc-editor.org/rfc/rfc8754#section-4.3.1.1">Section 4.3.1.1</a></span>, up through
        line S15.<a class="pilcrow" href="#section-5.2-2">¶</a></p>
<p id="section-5.2-3"> After S15, if S is a local End.NSH SID, then:<a class="pilcrow" href="#section-5.2-3">¶</a></p>
<div class="lang-pseudocode sourcecode" id="section-5.2-4">
<pre>S15.1.         Remove and store IPv6 and SRH headers in local cache
               indexed by &lt;NSH: service-path-id, service-index -1&gt;
S15.2.         Submit the packet to the NSH FIB lookup and transmit
               to the destination associated with &lt;NSH:
               service-path-id, service-index&gt;
</pre><a class="pilcrow" href="#section-5.2-4">¶</a>
</div>
<aside id="section-5.2-5">
          <p id="section-5.2-5.1">Note: The End.NSH behavior interrupts the normal SRH packet
          processing, as described in <span>[<a class="cite xref" href="#RFC8754">RFC8754</a>], <a class="relref" href="https://rfc-editor.org/rfc/rfc8754#section-4.3.1.1">Section 4.3.1.1</a></span>, which does not continue
          to S16 at this time.<a class="pilcrow" href="#section-5.2-5.1">¶</a></p>
</aside>
<p id="section-5.2-6"> When a packet is returned to the SFF from the SF, reattach the
          cached IPv6 and SRH headers based on the &lt;NSH: service-path-id,
          service-index&gt; from the NSH header.  Then, resume processing from
          <span>[<a class="cite xref" href="#RFC8754">RFC8754</a>], <a class="relref" href="https://rfc-editor.org/rfc/rfc8754#section-4.3.1.1">Section 4.3.1.1</a></span>
          with line S16.<a class="pilcrow" href="#section-5.2-6">¶</a></p>
</section>
</section>
</div>
<div id="Encapsulation">
<section id="section-6">
      <h2 id="name-encapsulation">
<a class="section-number selfRef" href="#section-6">6. </a><a class="section-name selfRef" href="#name-encapsulation">Encapsulation</a>
      </h2>
<p id="section-6-1"></p>
<div id="MPLS-SR">
<section id="section-6.1">
        <h3 id="name-nsh-using-sr-mpls-transport">
<a class="section-number selfRef" href="#section-6.1">6.1. </a><a class="section-name selfRef" href="#name-nsh-using-sr-mpls-transport">NSH Using SR-MPLS Transport</a>
        </h3>
<p id="section-6.1-1"> SR-MPLS instantiates segment identifiers (SIDs) as MPLS labels;
        therefore, the segment routing header is a stack of MPLS labels.<a class="pilcrow" href="#section-6.1-1">¶</a></p>
<p id="section-6.1-2"> When carrying an NSH within an SR-MPLS transport, the full
        encapsulation headers are as illustrated in <a class="auto internal xref" href="#figure_5">Figure 5</a>.<a class="pilcrow" href="#section-6.1-2">¶</a></p>
<span id="name-nsh-using-sr-mpls-transport-2"></span><div id="figure_5">
<figure id="figure-5">
          <div class="alignLeft art-text artwork" id="section-6.1-3.1">
<pre>                       +------------------+
                       ~   SR-MPLS Labels ~
                       +------------------+
                       |   NSH Base Hdr   |
                       +------------------+
                       | Service Path Hdr |
                       +------------------+
                       ~     Metadata     ~
                       +------------------+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-5">Figure 5</a>:
<a class="selfRef" href="#name-nsh-using-sr-mpls-transport-2">NSH Using SR-MPLS Transport</a>
          </figcaption></figure>
</div>
<p id="section-6.1-4">As described in <span>[<a class="cite xref" href="#RFC8402">RFC8402</a>]</span>,
        "[t]he IGP signaling extension for IGP-Prefix segment includes a flag to
        indicate whether directly connected neighbors of the node on which the
        prefix is attached should perform the NEXT operation or the CONTINUE
        operation when processing the SID." When an NSH is carried beneath
        SR-MPLS, it is necessary to terminate the NSH-based SFC at the tail-end
        node of the SR-MPLS label stack. This can be achieved using either the
        NEXT or CONTINUE operation.<a class="pilcrow" href="#section-6.1-4">¶</a></p>
<p id="section-6.1-5"> If the NEXT operation is to be used, then at the end of the
        SR-MPLS path, it is necessary to provide an indication to the tail end
        that the NSH follows the SR-MPLS label stack as described by <span>[<a class="cite xref" href="#RFC8596">RFC8596</a>]</span>.<a class="pilcrow" href="#section-6.1-5">¶</a></p>
<p id="section-6.1-6"> If the CONTINUE operation is to be used, this is the equivalent of
        MPLS Ultimate Hop Popping (UHP); therefore, it is necessary to
        ensure that the penultimate hop node does not pop the top label of the
        SR-MPLS label stack and thereby expose the NSH to the wrong SFF. This is
        realized by setting the No Penultimate Hop Popping (No-PHP) flag in
        Prefix-SID Sub-TLV <span>[<a class="cite xref" href="#RFC8667">RFC8667</a>]</span> <span>[<a class="cite xref" href="#RFC8665">RFC8665</a>]</span>. It is <span class="bcp14">RECOMMENDED</span>
        that a specific Prefix-SID be allocated at each node for use by the
        SFC application for this purpose.<a class="pilcrow" href="#section-6.1-6">¶</a></p>
</section>
</div>
<div id="SRv6">
<section id="section-6.2">
        <h3 id="name-nsh-using-srv6-transport">
<a class="section-number selfRef" href="#section-6.2">6.2. </a><a class="section-name selfRef" href="#name-nsh-using-srv6-transport">NSH Using SRv6 Transport</a>
        </h3>
<p id="section-6.2-1">When carrying a NSH within an SRv6 transport, the full encapsulation
        is as illustrated in <a class="auto internal xref" href="#figure_6">Figure 6</a>.<a class="pilcrow" href="#section-6.2-1">¶</a></p>
<span id="name-nsh-using-srv6-transport-2"></span><div id="figure_6">
<figure id="figure-6">
          <div class="alignLeft art-text artwork" id="section-6.2-2.1">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Next Header   |  Hdr Ext Len  | Routing Type  | Segments Left |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Last Entry   |     Flags     |              Tag              | S
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ e
|                                                               | g
|            Segment List[0] (128-bit IPv6 address)             | m
|                                                               | e
|                                                               | n
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ t
|                                                               |
|                                                               | R
~                              ...                              ~ o
|                                                               | u
|                                                               | t
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ i
|                                                               | n
|            Segment List[n] (128-bit IPv6 address)             | g
|                                                               |
|                                                               | S
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ R
//                                                             // H
//         Optional Type Length Value objects (variable)       //
//                                                             //
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|Ver|O|U|    TTL    |   Length  |U|U|U|U|MD Type| Next Protocol |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ N
|          Service Path Identifier              | Service Index | S
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ H
|                                                               |
~              Variable-Length Context Headers  (opt.)          ~
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-6">Figure 6</a>:
<a class="selfRef" href="#name-nsh-using-srv6-transport-2">NSH Using SRv6 Transport</a>
          </figcaption></figure>
</div>
<p id="section-6.2-3">Encapsulation of the NSH following SRv6 is indicated by the IP protocol
        number for the NSH in the Next Header of the SRH.<a class="pilcrow" href="#section-6.2-3">¶</a></p>
</section>
</div>
</section>
</div>
<div id="Security">
<section id="section-7">
      <h2 id="name-security-considerations">
<a class="section-number selfRef" href="#section-7">7. </a><a class="section-name selfRef" href="#name-security-considerations">Security Considerations</a>
      </h2>
<p id="section-7-1">
 Generic SFC-related security considerations are discussed in <span>[<a class="cite xref" href="#RFC7665">RFC7665</a>]</span>.<a class="pilcrow" href="#section-7-1">¶</a></p>
<p id="section-7-2">
 NSH-specific security considerations are discussed in <span>[<a class="cite xref" href="#RFC8300">RFC8300</a>]</span>.<a class="pilcrow" href="#section-7-2">¶</a></p>
<p id="section-7-3"> Generic security considerations related to segment routing are
      discussed in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc8754#section-7">Section 7</a> of [<a class="cite xref" href="#RFC8754">RFC8754</a>]</span> and
      <span><a class="relref" href="https://rfc-editor.org/rfc/rfc8663#section-5">Section 5</a> of [<a class="cite xref" href="#RFC8663">RFC8663</a>]</span>.<a class="pilcrow" href="#section-7-3">¶</a></p>
</section>
</div>
<section id="section-8">
      <h2 id="name-backwards-compatibility">
<a class="section-number selfRef" href="#section-8">8. </a><a class="section-name selfRef" href="#name-backwards-compatibility">Backwards Compatibility</a>
      </h2>
<p id="section-8-1">For SRv6/IPv6, if a processing node does not recognize the NSH, it should
      follow the procedures described in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc8200#section-4">Section 4</a> of [<a class="cite xref" href="#RFC8200">RFC8200</a>]</span>. For SR-MPLS, if a processing node does
      not recognize the NSH, it should follow the procedures laid out in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc3031#section-3.18">Section 3.18</a> of [<a class="cite xref" href="#RFC3031">RFC3031</a>]</span>.<a class="pilcrow" href="#section-8-1">¶</a></p>
</section>
<section id="section-9">
      <h2 id="name-caching-considerations">
<a class="section-number selfRef" href="#section-9">9. </a><a class="section-name selfRef" href="#name-caching-considerations">Caching Considerations</a>
      </h2>
<p id="section-9-1">The cache mechanism must remove cached entries at an appropriate time
      determined by the implementation. Further, an implementation
      <span class="bcp14">MAY</span> allow network operators to set the said time value.
      In the case where a packet arriving from an SF does not have a matching
      cached entry, the SFF <span class="bcp14">SHOULD</span> log this event and
      <span class="bcp14">MUST</span> drop the packet.<a class="pilcrow" href="#section-9-1">¶</a></p>
</section>
<section id="section-10">
      <h2 id="name-mtu-considerations">
<a class="section-number selfRef" href="#section-10">10. </a><a class="section-name selfRef" href="#name-mtu-considerations">MTU Considerations</a>
      </h2>
<p id="section-10-1">Aligned with <span><a class="relref" href="https://rfc-editor.org/rfc/rfc8300#section-5">Section 5</a> of [<a class="cite xref" href="#RFC8300">RFC8300</a>]</span>
      and <span><a class="relref" href="https://rfc-editor.org/rfc/rfc8754#section-5.3">Section 5.3</a> of [<a class="cite xref" href="#RFC8754">RFC8754</a>]</span>, it is
      <span class="bcp14">RECOMMENDED</span> for network operators to increase the
      underlying MTU so that SR/NSH traffic is forwarded within an SR domain
      without fragmentation.<a class="pilcrow" href="#section-10-1">¶</a></p>
</section>
<div id="IANA">
<section id="section-11">
      <h2 id="name-iana-considerations">
<a class="section-number selfRef" href="#section-11">11. </a><a class="section-name selfRef" href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<div id="NSHPROTO">
<section id="section-11.1">
        <h3 id="name-protocol-number-for-the-nsh">
<a class="section-number selfRef" href="#section-11.1">11.1. </a><a class="section-name selfRef" href="#name-protocol-number-for-the-nsh">Protocol Number for the NSH</a>
        </h3>
<p id="section-11.1-1">IANA has assigned  protocol number 145 for the NSH
 <span>[<a class="cite xref" href="#RFC8300">RFC8300</a>]</span> in the "Assigned Internet
 Protocol Numbers" registry
 <span>&lt;<a href="https://www.iana.org/assignments/protocol-numbers/">https://www.iana.org/assignments/protocol-numbers/</a>&gt;</span>.<a class="pilcrow" href="#section-11.1-1">¶</a></p>
<span id="name-assigned-internet-protocol-"></span><div id="iana-1">
<table class="center" id="table-1">
          <caption>
<a class="selfRef" href="#table-1">Table 1</a>:
<a class="selfRef" href="#name-assigned-internet-protocol-">Assigned Internet Protocol Numbers Registry</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Decimal</th>
              <th class="text-left" colspan="1" rowspan="1">Keyword</th>
              <th class="text-left" colspan="1" rowspan="1">Protocol</th>
              <th class="text-left" colspan="1" rowspan="1">IPv6 Extension Header</th>
              <th class="text-left" colspan="1" rowspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">145</td>
              <td class="text-left" colspan="1" rowspan="1">NSH</td>
              <td class="text-left" colspan="1" rowspan="1">Network Service Header</td>
              <td class="text-left" colspan="1" rowspan="1">N</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9491</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="NSHEPB">
<section id="section-11.2">
        <h3 id="name-srv6-endpoint-behavior-for-">
<a class="section-number selfRef" href="#section-11.2">11.2. </a><a class="section-name selfRef" href="#name-srv6-endpoint-behavior-for-">SRv6 Endpoint Behavior for the NSH</a>
        </h3>
<p id="section-11.2-1">IANA has allocated the following value in the "SRv6 Endpoint
        Behaviors" subregistry under the "Segment Routing" registry:<a class="pilcrow" href="#section-11.2-1">¶</a></p>
<span id="name-srv6-endpoint-behaviors-sub"></span><div id="iana-2">
<table class="center" id="table-2">
          <caption>
<a class="selfRef" href="#table-2">Table 2</a>:
<a class="selfRef" href="#name-srv6-endpoint-behaviors-sub">SRv6 Endpoint Behaviors Subregistry</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Value</th>
              <th class="text-left" colspan="1" rowspan="1">Hex</th>
              <th class="text-left" colspan="1" rowspan="1">Endpoint Behavior</th>
              <th class="text-left" colspan="1" rowspan="1">Reference</th>
              <th class="text-left" colspan="1" rowspan="1">Change Controller</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">84</td>
              <td class="text-left" colspan="1" rowspan="1">0x0054</td>
              <td class="text-left" colspan="1" rowspan="1">End.NSH - NSH Segment</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9491</td>
              <td class="text-left" colspan="1" rowspan="1">IETF</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
</section>
</div>
<section id="section-12">
      <h2 id="name-references">
<a class="section-number selfRef" href="#section-12">12. </a><a class="section-name selfRef" href="#name-references">References</a>
      </h2>
<section id="section-12.1">
        <h3 id="name-normative-references">
<a class="section-number selfRef" href="#section-12.1">12.1. </a><a class="section-name selfRef" href="#name-normative-references">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time class="refDate" datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3031">[RFC3031]</dt>
        <dd>
<span class="refAuthor">Rosen, E.</span>, <span class="refAuthor">Viswanathan, A.</span>, and <span class="refAuthor">R. Callon</span>, <span class="refTitle">"Multiprotocol Label Switching Architecture"</span>, <span class="seriesInfo">RFC 3031</span>, <span class="seriesInfo">DOI 10.17487/RFC3031</span>, <time class="refDate" datetime="2001-01">January 2001</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3031">https://www.rfc-editor.org/info/rfc3031</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time class="refDate" datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8200">[RFC8200]</dt>
        <dd>
<span class="refAuthor">Deering, S.</span> and <span class="refAuthor">R. Hinden</span>, <span class="refTitle">"Internet Protocol, Version 6 (IPv6) Specification"</span>, <span class="seriesInfo">STD 86</span>, <span class="seriesInfo">RFC 8200</span>, <span class="seriesInfo">DOI 10.17487/RFC8200</span>, <time class="refDate" datetime="2017-07">July 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8200">https://www.rfc-editor.org/info/rfc8200</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8300">[RFC8300]</dt>
        <dd>
<span class="refAuthor">Quinn, P., Ed.</span>, <span class="refAuthor">Elzur, U., Ed.</span>, and <span class="refAuthor">C. Pignataro, Ed.</span>, <span class="refTitle">"Network Service Header (NSH)"</span>, <span class="seriesInfo">RFC 8300</span>, <span class="seriesInfo">DOI 10.17487/RFC8300</span>, <time class="refDate" datetime="2018-01">January 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8300">https://www.rfc-editor.org/info/rfc8300</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8402">[RFC8402]</dt>
        <dd>
<span class="refAuthor">Filsfils, C., Ed.</span>, <span class="refAuthor">Previdi, S., Ed.</span>, <span class="refAuthor">Ginsberg, L.</span>, <span class="refAuthor">Decraene, B.</span>, <span class="refAuthor">Litkowski, S.</span>, and <span class="refAuthor">R. Shakir</span>, <span class="refTitle">"Segment Routing Architecture"</span>, <span class="seriesInfo">RFC 8402</span>, <span class="seriesInfo">DOI 10.17487/RFC8402</span>, <time class="refDate" datetime="2018-07">July 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8402">https://www.rfc-editor.org/info/rfc8402</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8660">[RFC8660]</dt>
        <dd>
<span class="refAuthor">Bashandy, A., Ed.</span>, <span class="refAuthor">Filsfils, C., Ed.</span>, <span class="refAuthor">Previdi, S.</span>, <span class="refAuthor">Decraene, B.</span>, <span class="refAuthor">Litkowski, S.</span>, and <span class="refAuthor">R. Shakir</span>, <span class="refTitle">"Segment Routing with the MPLS Data Plane"</span>, <span class="seriesInfo">RFC 8660</span>, <span class="seriesInfo">DOI 10.17487/RFC8660</span>, <time class="refDate" datetime="2019-12">December 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8660">https://www.rfc-editor.org/info/rfc8660</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8663">[RFC8663]</dt>
        <dd>
<span class="refAuthor">Xu, X.</span>, <span class="refAuthor">Bryant, S.</span>, <span class="refAuthor">Farrel, A.</span>, <span class="refAuthor">Hassan, S.</span>, <span class="refAuthor">Henderickx, W.</span>, and <span class="refAuthor">Z. Li</span>, <span class="refTitle">"MPLS Segment Routing over IP"</span>, <span class="seriesInfo">RFC 8663</span>, <span class="seriesInfo">DOI 10.17487/RFC8663</span>, <time class="refDate" datetime="2019-12">December 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8663">https://www.rfc-editor.org/info/rfc8663</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8665">[RFC8665]</dt>
        <dd>
<span class="refAuthor">Psenak, P., Ed.</span>, <span class="refAuthor">Previdi, S., Ed.</span>, <span class="refAuthor">Filsfils, C.</span>, <span class="refAuthor">Gredler, H.</span>, <span class="refAuthor">Shakir, R.</span>, <span class="refAuthor">Henderickx, W.</span>, and <span class="refAuthor">J. Tantsura</span>, <span class="refTitle">"OSPF Extensions for Segment Routing"</span>, <span class="seriesInfo">RFC 8665</span>, <span class="seriesInfo">DOI 10.17487/RFC8665</span>, <time class="refDate" datetime="2019-12">December 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8665">https://www.rfc-editor.org/info/rfc8665</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8667">[RFC8667]</dt>
        <dd>
<span class="refAuthor">Previdi, S., Ed.</span>, <span class="refAuthor">Ginsberg, L., Ed.</span>, <span class="refAuthor">Filsfils, C.</span>, <span class="refAuthor">Bashandy, A.</span>, <span class="refAuthor">Gredler, H.</span>, and <span class="refAuthor">B. Decraene</span>, <span class="refTitle">"IS-IS Extensions for Segment Routing"</span>, <span class="seriesInfo">RFC 8667</span>, <span class="seriesInfo">DOI 10.17487/RFC8667</span>, <time class="refDate" datetime="2019-12">December 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8667">https://www.rfc-editor.org/info/rfc8667</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8754">[RFC8754]</dt>
      <dd>
<span class="refAuthor">Filsfils, C., Ed.</span>, <span class="refAuthor">Dukes, D., Ed.</span>, <span class="refAuthor">Previdi, S.</span>, <span class="refAuthor">Leddy, J.</span>, <span class="refAuthor">Matsushima, S.</span>, and <span class="refAuthor">D. Voyer</span>, <span class="refTitle">"IPv6 Segment Routing Header (SRH)"</span>, <span class="seriesInfo">RFC 8754</span>, <span class="seriesInfo">DOI 10.17487/RFC8754</span>, <time class="refDate" datetime="2020-03">March 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8754">https://www.rfc-editor.org/info/rfc8754</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-12.2">
        <h3 id="name-informative-references">
<a class="section-number selfRef" href="#section-12.2">12.2. </a><a class="section-name selfRef" href="#name-informative-references">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC7498">[RFC7498]</dt>
        <dd>
<span class="refAuthor">Quinn, P., Ed.</span> and <span class="refAuthor">T. Nadeau, Ed.</span>, <span class="refTitle">"Problem Statement for Service Function Chaining"</span>, <span class="seriesInfo">RFC 7498</span>, <span class="seriesInfo">DOI 10.17487/RFC7498</span>, <time class="refDate" datetime="2015-04">April 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7498">https://www.rfc-editor.org/info/rfc7498</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7665">[RFC7665]</dt>
        <dd>
<span class="refAuthor">Halpern, J., Ed.</span> and <span class="refAuthor">C. Pignataro, Ed.</span>, <span class="refTitle">"Service Function Chaining (SFC) Architecture"</span>, <span class="seriesInfo">RFC 7665</span>, <span class="seriesInfo">DOI 10.17487/RFC7665</span>, <time class="refDate" datetime="2015-10">October 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7665">https://www.rfc-editor.org/info/rfc7665</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8596">[RFC8596]</dt>
        <dd>
<span class="refAuthor">Malis, A.</span>, <span class="refAuthor">Bryant, S.</span>, <span class="refAuthor">Halpern, J.</span>, and <span class="refAuthor">W. Henderickx</span>, <span class="refTitle">"MPLS Transport Encapsulation for the Service Function Chaining (SFC) Network Service Header (NSH)"</span>, <span class="seriesInfo">RFC 8596</span>, <span class="seriesInfo">DOI 10.17487/RFC8596</span>, <time class="refDate" datetime="2019-06">June 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8596">https://www.rfc-editor.org/info/rfc8596</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-spring-sr-service-programming">[SERVICE-PROGRAMMING]</dt>
      <dd>
<span class="refAuthor">Clad, F., Ed.</span>, <span class="refAuthor">Xu, X., Ed.</span>, <span class="refAuthor">Filsfils, C.</span>, <span class="refAuthor">Bernier, D.</span>, <span class="refAuthor">Li, C.</span>, <span class="refAuthor">Decraene, B.</span>, <span class="refAuthor">Ma, S.</span>, <span class="refAuthor">Yadlapalli, C.</span>, <span class="refAuthor">Henderickx, W.</span>, and <span class="refAuthor">S. Salsano</span>, <span class="refTitle">"Service Programming with Segment Routing"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-spring-sr-service-programming-08</span>, <time class="refDate" datetime="2023-08-21">21 August 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-spring-sr-service-programming-08">https://datatracker.ietf.org/doc/html/draft-ietf-spring-sr-service-programming-08</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="Contributors">
<section id="appendix-A">
      <h2 id="name-contributors">
<a class="section-name selfRef" href="#name-contributors">Contributors</a>
      </h2>
<p id="appendix-A-1">The following coauthors provided valuable inputs and text
      contributions to this document.<a class="pilcrow" href="#appendix-A-1">¶</a></p>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Mohamed Boucadair</span></div>
<div class="left" dir="auto"><span class="org">Orange</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:mohamed.boucadair@orange.com">mohamed.boucadair@orange.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Joel Halpern</span></div>
<div class="left" dir="auto"><span class="org">Ericsson</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:joel.halpern@ericsson.com">joel.halpern@ericsson.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Syed Hassan</span></div>
<div class="left" dir="auto"><span class="org">Cisco System, inc.</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:shassan@cisco.com">shassan@cisco.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Wim Henderickx</span></div>
<div class="left" dir="auto"><span class="org">Nokia</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:wim.henderickx@nokia.com">wim.henderickx@nokia.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Haoyu Song</span></div>
<div class="left" dir="auto"><span class="org">Futurewei Technologies</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:haoyu.song@futurewei.com">haoyu.song@futurewei.com</a>
</div>
</address>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-addresses">
<a class="section-name selfRef" href="#name-authors-addresses">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">James N Guichard (<span class="role">editor</span>)</span></div>
<div class="left" dir="auto"><span class="org">Futurewei Technologies</span></div>
<div class="left" dir="auto"><span class="street-address">2330 Central Expressway</span></div>
<div class="left" dir="auto">
<span class="locality">Santa Clara</span>, <span class="region">CA</span> </div>
<div class="left" dir="auto"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:james.n.guichard@futurewei.com">james.n.guichard@futurewei.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Jeff Tantsura (<span class="role">editor</span>)</span></div>
<div class="left" dir="auto"><span class="org">Nvidia</span></div>
<div class="left" dir="auto"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:jefftant.ietf@gmail.com">jefftant.ietf@gmail.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>


</body></html>