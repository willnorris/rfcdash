<!DOCTYPE html>
<html class="RFC" lang="en"><head>
<meta charset="utf-8"/>
<meta content="Common,Latin" name="scripts"/>
<meta content="initial-scale=1.0" name="viewport"/>
<title>RFC 9480: Certificate Management Protocol (CMP) Updates</title>
<meta content="Hendrik Brockhaus" name="author"/>
<meta content="David von Oheimb" name="author"/>
<meta content="John Gray" name="author"/>
<meta content="
       This document contains a set of updates to the syntax of Certificate Management Protocol (CMP) version 2 and its HTTP transfer mechanism. This document updates RFCs 4210, 5912, and 6712. 
       The aspects of CMP updated in this document are using EnvelopedData instead of EncryptedValue, clarifying the handling of p10cr messages, improving the crypto agility, as well as adding new general message types, extended key usages to identify certificates for use with CMP, and well-known URI path segments. 
       CMP version 3 is introduced to enable signaling support of EnvelopedData instead of EncryptedValue and signal the use of an explicit hash AlgorithmIdentifier in certConf messages, as far as needed. 
    " name="description"/>
<meta content="xml2rfc 3.18.2" name="generator"/>
<meta content="CMP" name="keyword"/>
<meta content="9480" name="rfc.number"/>
<!-- Generator version information:
  xml2rfc 3.18.2
    Python 3.9.15
    ConfigArgParse 1.5.3
    google-i18n-address 3.0.0
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 4.9.0
    platformdirs 3.8.0
    pycountry 22.3.5
    PyYAML 6.0
    requests 2.28.0
    setuptools 44.1.1
    six 1.16.0
    wcwidth 0.2.5
    weasyprint 56.1
-->
<link href="rfc9480.xml" rel="alternate" type="application/rfc+xml"/>
<link href="#copyright" rel="license"/>
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necessary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

:root {
  --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
  --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
  --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
}

@viewport {
  zoom: 1.0;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: var(--font-sans);
  line-height: 1.6;
  scroll-behavior: smooth;
  overflow-wrap: break-word;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
svg[font-family~="serif" i], svg [font-family~="serif" i] {
  font-family: var(--font-serif);
}
svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
  font-family: var(--font-sans);
}
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef,
.iref + a[href].internal {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre {
  background-color: #f9f9f9;
  font-family: var(--font-mono);
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
blockquote > *:last-child {
  margin-bottom: 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: var(--font-sans);
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  .breakable pre {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The following is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
.sourcecode pre,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .artwork > pre,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background slightly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottom margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the compact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div.sourcecode:first-child,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type:only-child {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css"/>
<link href="https://datatracker.ietf.org/doc/draft-ietf-lamps-cmp-updates-23" rel="prev"/>
  <link href="https://dx.doi.org/10.17487/rfc9480" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  </head>
<body class="xml2rfc">
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 9480</td>
<td class="center">CMP Updates</td>
<td class="right">November 2023</td>
</tr></thead>
<tfoot><tr>
<td class="left">Brockhaus, et al.</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div class="document-information" id="external-metadata"></div>
<div class="document-information" id="internal-metadata">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a class="eref" href="https://www.rfc-editor.org/rfc/rfc9480">9480</a></dd>
<dt class="label-updates">Updates:</dt>
<dd class="updates">
<a class="eref" href="https://www.rfc-editor.org/rfc/rfc4210">4210</a>, <a class="eref" href="https://www.rfc-editor.org/rfc/rfc5912">5912</a>, <a class="eref" href="https://www.rfc-editor.org/rfc/rfc6712">6712</a> </dd>
<dt class="label-category">Category:</dt>
<dd class="category">Standards Track</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time class="published" datetime="2023-11">November 2023</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">H. Brockhaus</div>
<div class="org">Siemens</div>
</div>
<div class="author">
      <div class="author-name">D. von Oheimb</div>
<div class="org">Siemens</div>
</div>
<div class="author">
      <div class="author-name">J. Gray</div>
<div class="org">Entrust</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 9480</h1>
<h1 id="title">Certificate Management Protocol (CMP) Updates</h1>
<section id="section-abstract">
      <h2 id="abstract"><a class="selfRef" href="#abstract">Abstract</a></h2>
<p id="section-abstract-1">This document contains a set of updates to the syntax of Certificate Management Protocol (CMP) version 2 and its HTTP transfer mechanism. This document updates RFCs 4210, 5912, and 6712.<a class="pilcrow" href="#section-abstract-1">¶</a></p>
<p id="section-abstract-2">The aspects of CMP updated in this document are using EnvelopedData instead of EncryptedValue, clarifying the handling of p10cr messages, improving the crypto agility, as well as adding new general message types, extended key usages to identify certificates for use with CMP, and well-known URI path segments.<a class="pilcrow" href="#section-abstract-2">¶</a></p>
<p id="section-abstract-3">CMP version 3 is introduced to enable signaling support of EnvelopedData instead of EncryptedValue and signal the use of an explicit hash AlgorithmIdentifier in certConf messages, as far as needed.<a class="pilcrow" href="#section-abstract-3">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a class="section-name selfRef" href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This is an Internet Standards Track document.<a class="pilcrow" href="#section-boilerplate.1-1">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.<a class="pilcrow" href="#section-boilerplate.1-2">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc9480">https://www.rfc-editor.org/info/rfc9480</a></span>.<a class="pilcrow" href="#section-boilerplate.1-3">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a class="section-name selfRef" href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2023 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a class="pilcrow" href="#section-boilerplate.2-1">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a class="pilcrow" href="#section-boilerplate.2-2">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a class="toplink" href="#" onclick="scroll(0,0)">▲</a><h2 id="name-table-of-contents">
<a class="section-name selfRef" href="#name-table-of-contents">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p class="keepWithNext" id="section-toc.1-1.1.1"><a class="auto internal xref" href="#section-1">1</a>.  <a class="internal xref" href="#name-introduction">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p class="keepWithNext" id="section-toc.1-1.1.2.1.1"><a class="auto internal xref" href="#section-1.1">1.1</a>.  <a class="internal xref" href="#name-convention-and-terminology">Convention and Terminology</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a class="auto internal xref" href="#section-2">2</a>.  <a class="internal xref" href="#name-updates-to-rfc-4210-certifi">Updates to RFC 4210 - Certificate Management Protocol (CMP)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p class="keepWithNext" id="section-toc.1-1.2.2.1.1"><a class="auto internal xref" href="#section-2.1">2.1</a>.  <a class="internal xref" href="#name-new-section-11-changes-sinc">New Section 1.1 - Changes Since RFC 4210</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a class="auto internal xref" href="#section-2.2">2.2</a>.  <a class="internal xref" href="#name-new-section-45-extended-key">New Section 4.5 - Extended Key Usage</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a class="auto internal xref" href="#section-2.3">2.3</a>.  <a class="internal xref" href="#name-update-section-511-pki-mess">Update Section 5.1.1 - PKI Message Header</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.4">
                <p id="section-toc.1-1.2.2.4.1"><a class="auto internal xref" href="#section-2.4">2.4</a>.  <a class="internal xref" href="#name-new-section-5113-certprofil">New Section 5.1.1.3 - CertProfile</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.5">
                <p id="section-toc.1-1.2.2.5.1"><a class="auto internal xref" href="#section-2.5">2.5</a>.  <a class="internal xref" href="#name-update-section-5131-shared-">Update Section 5.1.3.1 - Shared Secret Information</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.6">
                <p id="section-toc.1-1.2.2.6.1"><a class="auto internal xref" href="#section-2.6">2.6</a>.  <a class="internal xref" href="#name-replace-section-5134-multip">Replace Section 5.1.3.4 - Multiple Protection</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.7">
                <p id="section-toc.1-1.2.2.7.1"><a class="auto internal xref" href="#section-2.7">2.7</a>.  <a class="internal xref" href="#name-replace-section-522-encrypt">Replace Section 5.2.2 - Encrypted Values</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.8">
                <p id="section-toc.1-1.2.2.8.1"><a class="auto internal xref" href="#section-2.8">2.8</a>.  <a class="internal xref" href="#name-new-section-529-generalized">New Section 5.2.9 - GeneralizedTime</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.9">
                <p id="section-toc.1-1.2.2.9.1"><a class="auto internal xref" href="#section-2.9">2.9</a>.  <a class="internal xref" href="#name-update-section-534-certific">Update Section 5.3.4 - Certification Response</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.10">
                <p id="section-toc.1-1.2.2.10.1"><a class="auto internal xref" href="#section-2.10">2.10</a>. <a class="internal xref" href="#name-update-section-5318-certifi">Update Section 5.3.18 - Certificate Confirmation Content</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.11">
                <p id="section-toc.1-1.2.2.11.1"><a class="auto internal xref" href="#section-2.11">2.11</a>. <a class="internal xref" href="#name-update-section-53192-signin">Update Section 5.3.19.2 - Signing Key Pair Types</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.12">
                <p id="section-toc.1-1.2.2.12.1"><a class="auto internal xref" href="#section-2.12">2.12</a>. <a class="internal xref" href="#name-update-section-53193-encryp">Update Section 5.3.19.3 - Encryption/Key Agreement Key Pair Types</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.13">
                <p id="section-toc.1-1.2.2.13.1"><a class="auto internal xref" href="#section-2.13">2.13</a>. <a class="internal xref" href="#name-replace-section-53199-revoc">Replace Section 5.3.19.9 - Revocation Passphrase</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.14">
                <p id="section-toc.1-1.2.2.14.1"><a class="auto internal xref" href="#section-2.14">2.14</a>. <a class="internal xref" href="#name-new-section-531914-ca-certi">New Section 5.3.19.14 - CA Certificates</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.15">
                <p id="section-toc.1-1.2.2.15.1"><a class="auto internal xref" href="#section-2.15">2.15</a>. <a class="internal xref" href="#name-new-section-531915-root-ca-">New Section 5.3.19.15 - Root CA Certificate Update</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.16">
                <p id="section-toc.1-1.2.2.16.1"><a class="auto internal xref" href="#section-2.16">2.16</a>. <a class="internal xref" href="#name-new-section-531916-certific">New Section 5.3.19.16 - Certificate Request Template</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.17">
                <p id="section-toc.1-1.2.2.17.1"><a class="auto internal xref" href="#section-2.17">2.17</a>. <a class="internal xref" href="#name-new-section-531917-crl-upda">New Section 5.3.19.17 - CRL Update Retrieval</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.18">
                <p id="section-toc.1-1.2.2.18.1"><a class="auto internal xref" href="#section-2.18">2.18</a>. <a class="internal xref" href="#name-update-section-5321-error-m">Update Section 5.3.21 - Error Message Content</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.19">
                <p id="section-toc.1-1.2.2.19.1"><a class="auto internal xref" href="#section-2.19">2.19</a>. <a class="internal xref" href="#name-replace-section-5322-pollin">Replace Section 5.3.22 - Polling Request and Response</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.20">
                <p id="section-toc.1-1.2.2.20.1"><a class="auto internal xref" href="#section-2.20">2.20</a>. <a class="internal xref" href="#name-update-section-7-version-ne">Update Section 7 - Version Negotiation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.21">
                <p id="section-toc.1-1.2.2.21.1"><a class="auto internal xref" href="#section-2.21">2.21</a>. <a class="internal xref" href="#name-update-section-711-clients-">Update Section 7.1.1 - Clients Talking to RFC 2510 Servers</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.22">
                <p id="section-toc.1-1.2.2.22.1"><a class="auto internal xref" href="#section-2.22">2.22</a>. <a class="internal xref" href="#name-add-section-84-private-keys">Add Section 8.4 - Private Keys for Certificate Signing and CMP Message Protection</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.23">
                <p id="section-toc.1-1.2.2.23.1"><a class="auto internal xref" href="#section-2.23">2.23</a>. <a class="internal xref" href="#name-add-section-85-entropy-of-r">Add Section 8.5 - Entropy of Random Numbers, Key Pairs, and Shared Secret Information</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.24">
                <p id="section-toc.1-1.2.2.24.1"><a class="auto internal xref" href="#section-2.24">2.24</a>. <a class="internal xref" href="#name-add-section-86-trust-anchor">Add Section 8.6 - Trust Anchor Provisioning Using CMP Messages</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.25">
                <p id="section-toc.1-1.2.2.25.1"><a class="auto internal xref" href="#section-2.25">2.25</a>. <a class="internal xref" href="#name-add-section-87-authorizing-">Add Section 8.7 - Authorizing Requests for Certificates with Specific EKUs</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.26">
                <p id="section-toc.1-1.2.2.26.1"><a class="auto internal xref" href="#section-2.26">2.26</a>. <a class="internal xref" href="#name-update-appendix-b-the-use-o">Update Appendix B - The Use of Revocation Passphrase</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.27">
                <p id="section-toc.1-1.2.2.27.1"><a class="auto internal xref" href="#section-2.27">2.27</a>. <a class="internal xref" href="#name-update-appendix-c-request-m">Update Appendix C - Request Message Behavioral Clarifications</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.28">
                <p id="section-toc.1-1.2.2.28.1"><a class="auto internal xref" href="#section-2.28">2.28</a>. <a class="internal xref" href="#name-update-appendix-d1-general-">Update Appendix D.1. - General Rules for Interpretation of These Profiles</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.29">
                <p id="section-toc.1-1.2.2.29.1"><a class="auto internal xref" href="#section-2.29">2.29</a>. <a class="internal xref" href="#name-update-appendix-d2-algorith">Update Appendix D.2. - Algorithm Use Profile</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.30">
                <p id="section-toc.1-1.2.2.30.1"><a class="auto internal xref" href="#section-2.30">2.30</a>. <a class="internal xref" href="#name-update-appendix-d4-initial-">Update Appendix D.4. - Initial Registration/Certification (Basic Authenticated Scheme)</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a class="auto internal xref" href="#section-3">3</a>.  <a class="internal xref" href="#name-updates-to-rfc-6712-http-tr">Updates to RFC 6712 - HTTP Transfer for the Certificate Management Protocol (CMP)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a class="auto internal xref" href="#section-3.1">3.1</a>.  <a class="internal xref" href="#name-update-section-1-introducti">Update Section 1 - Introduction</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a class="auto internal xref" href="#section-3.2">3.2</a>.  <a class="internal xref" href="#name-new-section-11-changes-since">New Section 1.1 - Changes Since RFC 6712</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a class="auto internal xref" href="#section-3.3">3.3</a>.  <a class="internal xref" href="#name-replace-section-36-http-req">Replace Section 3.6 - HTTP Request-URI</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a class="auto internal xref" href="#section-4">4</a>.  <a class="internal xref" href="#name-iana-considerations">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a class="auto internal xref" href="#section-4.1">4.1</a>.  <a class="internal xref" href="#name-updates-to-the-asn1-modules">Updates to the ASN.1 Modules in RFCs 4210 and 5912</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a class="auto internal xref" href="#section-4.2">4.2</a>.  <a class="internal xref" href="#name-updates-to-the-iana-conside">Updates to the IANA Considerations of RFC 4210</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a class="auto internal xref" href="#section-4.2.1">4.2.1</a>.  <a class="internal xref" href="#name-smi-security-for-pkix-exten">SMI Security for PKIX Extended Key Purpose Registry</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.2">
                    <p id="section-toc.1-1.4.2.2.2.2.1"><a class="auto internal xref" href="#section-4.2.2">4.2.2</a>.  <a class="internal xref" href="#name-smi-security-for-pkix-cmp-i">SMI Security for PKIX CMP Information Types</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.3">
                    <p id="section-toc.1-1.4.2.2.2.3.1"><a class="auto internal xref" href="#section-4.2.3">4.2.3</a>.  <a class="internal xref" href="#name-smi-security-for-pkix-crmf-">SMI Security for PKIX CRMF Registration Controls</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a class="auto internal xref" href="#section-4.3">4.3</a>.  <a class="internal xref" href="#name-updates-to-the-iana-consider">Updates to the IANA Considerations of RFC 6712</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.1">
                    <p id="section-toc.1-1.4.2.3.2.1.1"><a class="auto internal xref" href="#section-4.3.1">4.3.1</a>.  <a class="internal xref" href="#name-well-known-uris">Well-Known URIs</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.2">
                    <p id="section-toc.1-1.4.2.3.2.2.1"><a class="auto internal xref" href="#section-4.3.2">4.3.2</a>.  <a class="internal xref" href="#name-certificate-management-prot">Certificate Management Protocol (CMP) Registry</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a class="auto internal xref" href="#section-5">5</a>.  <a class="internal xref" href="#name-security-considerations">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a class="auto internal xref" href="#section-6">6</a>.  <a class="internal xref" href="#name-references">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a class="auto internal xref" href="#section-6.1">6.1</a>.  <a class="internal xref" href="#name-normative-references">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a class="auto internal xref" href="#section-6.2">6.2</a>.  <a class="internal xref" href="#name-informative-references">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a class="auto internal xref" href="#appendix-A">Appendix A</a>.  <a class="internal xref" href="#name-asn1-modules">ASN.1 Modules</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a class="auto internal xref" href="#appendix-A.1">A.1</a>.  <a class="internal xref" href="#name-update-to-rfc-4210-1988-asn">Update to RFC 4210 - 1988 ASN.1 Module</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a class="auto internal xref" href="#appendix-A.2">A.2</a>.  <a class="internal xref" href="#name-update-to-rfc-5912-2002-asn">Update to RFC 5912 - 2002 ASN.1 Module</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a class="auto internal xref" href="#appendix-B"></a><a class="internal xref" href="#name-acknowledgements">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a class="auto internal xref" href="#appendix-C"></a><a class="internal xref" href="#name-authors-addresses">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="Introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a class="section-number selfRef" href="#section-1">1. </a><a class="section-name selfRef" href="#name-introduction">Introduction</a>
      </h2>
<p id="section-1-1">While using <span><a class="internal xref" href="#RFC4210">CMP</a> [<a class="cite xref" href="#RFC4210">RFC4210</a>]</span> in industrial and Internet of Things environments and developing the <span><a class="internal xref" href="#RFC9483">Lightweight CMP Profile</a> [<a class="cite xref" href="#RFC9483">RFC9483</a>]</span>, some limitations were identified in the original CMP specification. This document updates <span>[<a class="cite xref" href="#RFC4210">RFC4210</a>]</span> and <span>[<a class="cite xref" href="#RFC6712">RFC6712</a>]</span> to overcome these limitations.<a class="pilcrow" href="#section-1-1">¶</a></p>
<p id="section-1-2">Among other updates, this document improves the crypto agility of CMP, which allows more flexibility for future advances in cryptography.<a class="pilcrow" href="#section-1-2">¶</a></p>
<p id="section-1-3">This document also introduces new extended key usages to identify CMP endpoints on registration and certification authorities.<a class="pilcrow" href="#section-1-3">¶</a></p>
<p id="section-1-4">The main content of <span>[<a class="cite xref" href="#RFC4210">RFC4210</a>]</span> and <span>[<a class="cite xref" href="#RFC6712">RFC6712</a>]</span> remains unchanged. This document lists all sections that are updated, replaced, or added to the current text of the respective RFCs.<a class="pilcrow" href="#section-1-4">¶</a></p>
<p id="section-1-5">The authors acknowledge that the style of the document is hard to read because the original RFCs must be read along with this document to get the complete content.  The working group decided to use this approach in order to keep the changes to <span>[<a class="cite xref" href="#RFC4210">RFC4210</a>]</span> and <span>[<a class="cite xref" href="#RFC6712">RFC6712</a>]</span> to the required minimum.  This was meant to speed up the editorial process and to minimize the effort spent on reviewing the full text of the original documents.<a class="pilcrow" href="#section-1-5">¶</a></p>
<p id="section-1-6">However, <span>[<a class="cite xref" href="#I-D.ietf-lamps-rfc4210bis">PKIX-CMP</a>]</span> and
<span>[<a class="cite xref" href="#I-D.ietf-lamps-rfc6712bis">HTTP-CMP</a>]</span> are intended to obsolete RFCs 4210 and 6712, respectively; these documents also include the changes listed in this document.<a class="pilcrow" href="#section-1-6">¶</a></p>
<div id="Convention_Terminology">
<section id="section-1.1">
        <h3 id="name-convention-and-terminology">
<a class="section-number selfRef" href="#section-1.1">1.1. </a><a class="section-name selfRef" href="#name-convention-and-terminology">Convention and Terminology</a>
        </h3>
<p id="section-1.1-1">
    The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
    "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
    described in BCP 14 <span>[<a class="cite xref" href="#RFC2119">RFC2119</a>]</span> <span>[<a class="cite xref" href="#RFC8174">RFC8174</a>]</span> 
    when, and only when, they appear in all capitals, as shown here.<a class="pilcrow" href="#section-1.1-1">¶</a></p>
<p class="keepWithNext" id="section-1.1-2">Technical terminology is used in conformance with <span>[<a class="cite xref" href="#RFC4210">RFC4210</a>]</span>, <span>[<a class="cite xref" href="#RFC4211">RFC4211</a>]</span>, and <span>[<a class="cite xref" href="#RFC5280">RFC5280</a>]</span>. The following key words are used:<a class="pilcrow" href="#section-1.1-2">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-1.1-3">
          <dt id="section-1.1-3.1">CA:</dt>
          <dd id="section-1.1-3.2" style="margin-left: 3.5em">Certification authority, which issues certificates.<a class="pilcrow" href="#section-1.1-3.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-3.3">RA:</dt>
          <dd id="section-1.1-3.4" style="margin-left: 3.5em">Registration authority, an optional system component to which a CA delegates certificate management functions, such as authorization checks.<a class="pilcrow" href="#section-1.1-3.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-3.5">KGA:</dt>
          <dd id="section-1.1-3.6" style="margin-left: 3.5em">Key generation authority, which generates key pairs on behalf of an EE. The KGA could be colocated with an RA or a CA.<a class="pilcrow" href="#section-1.1-3.6">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-3.7">EE:</dt>
          <dd id="section-1.1-3.8" style="margin-left: 3.5em">End entity, a user, device, or service that holds a PKI certificate. An identifier for the EE is given as its subject of the certificate.<a class="pilcrow" href="#section-1.1-3.8">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="CMP-Updates">
<section id="section-2">
      <h2 id="name-updates-to-rfc-4210-certifi">
<a class="section-number selfRef" href="#section-2">2. </a><a class="section-name selfRef" href="#name-updates-to-rfc-4210-certifi">Updates to RFC 4210 - Certificate Management Protocol (CMP)</a>
      </h2>
<div id="CMP-1.1">
<section id="section-2.1">
        <h3 id="name-new-section-11-changes-sinc">
<a class="section-number selfRef" href="#section-2.1">2.1. </a><a class="section-name selfRef" href="#name-new-section-11-changes-sinc">New Section 1.1 - Changes Since RFC 4210</a>
        </h3>
<p id="section-2.1-1">The following subsection describes feature updates to <span>[<a class="cite xref" href="#RFC4210">RFC4210</a>]</span>. They are always related to the base specification. Hence, references to the original sections in <span>[<a class="cite xref" href="#RFC4210">RFC4210</a>]</span> are used whenever possible.<a class="pilcrow" href="#section-2.1-1">¶</a></p>
<p class="keepWithNext" id="section-2.1-2">Insert this section after the current <span><a class="relref" href="https://rfc-editor.org/rfc/rfc4210#section-1">Section 1</a> of [<a class="cite xref" href="#RFC4210">RFC4210</a>]</span>:<a class="pilcrow" href="#section-2.1-2">¶</a></p>
<p class="keepWithNext" id="section-2.1-3">1.1. Changes Since RFC 4210<a class="pilcrow" href="#section-2.1-3">¶</a></p>
<p id="section-2.1-4">The following updates are made in this document:<a class="pilcrow" href="#section-2.1-4">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-5.1">Adding new extended key usages for various CMP server types, e.g., registration authority and certification authority, to express the authorization of the entity identified in the certificate containing the respective extended key usage extension that acts as the indicated PKI management entity.<a class="pilcrow" href="#section-2.1-5.1">¶</a>
</li>
          <li class="normal" id="section-2.1-5.2">Extending the description of multiple protection to cover additional use cases, e.g., batch processing of messages.<a class="pilcrow" href="#section-2.1-5.2">¶</a>
</li>
          <li class="normal" id="section-2.1-5.3">Offering EnvelopedData as the preferred choice next to EncryptedValue to better support crypto agility in CMP. Note that, according to <span>[<a class="cite xref" href="#RFC4211">RFC4211</a>], <a class="relref" href="https://rfc-editor.org/rfc/rfc4211#section-2.1">Section 2.1</a></span>, point 9, the use of the EncryptedValue structure has been deprecated in favor of the EnvelopedData structure. <span>[<a class="cite xref" href="#RFC4211">RFC4211</a>]</span> offers the EncryptedKey structure a choice of EncryptedValue and EnvelopedData for migration to EnvelopedData. For reasons of completeness and consistency, the type EncryptedValue has been exchanged in all occurrences in <span>[<a class="cite xref" href="#RFC4210">RFC4210</a>]</span>.  This includes the protection of centrally generated private keys, encryption of certificates, and protection of revocation passphrases. To properly differentiate the support of EnvelopedData instead of EncryptedValue, CMP version 3 is introduced in case a transaction is supposed to use EnvelopedData.<a class="pilcrow" href="#section-2.1-5.3">¶</a>
</li>
          <li class="normal" id="section-2.1-5.4">Offering an optional hashAlg field in CertStatus that supports confirmation of certificates signed with signature algorithms, e.g., preparing for upcoming post quantum algorithms, not directly indicating a specific hash algorithm to use to compute the certHash.<a class="pilcrow" href="#section-2.1-5.4">¶</a>
</li>
          <li class="normal" id="section-2.1-5.5">Adding new general message types to request CA certificates, a root CA update, a certificate request template, or a Certificate Revocation List (CRL) update.<a class="pilcrow" href="#section-2.1-5.5">¶</a>
</li>
          <li class="normal" id="section-2.1-5.6">Extending the usage of polling to p10cr, certConf, rr, genm, and error messages.<a class="pilcrow" href="#section-2.1-5.6">¶</a>
</li>
          <li class="normal" id="section-2.1-5.7">Deleting the mandatory algorithm profile in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc4210#appendix-D.2">Appendix D.2</a> of [<a class="cite xref" href="#RFC4210">RFC4210</a>]</span> and referring to <span><a class="relref" href="https://rfc-editor.org/rfc/rfc9481#section-7">Section 7</a> of CMP Algorithms [<a class="cite xref" href="#RFC9481">RFC9481</a>]</span>.<a class="pilcrow" href="#section-2.1-5.7">¶</a>
</li>
        </ul>
</section>
</div>
<div id="CMP-4.5">
<section id="section-2.2">
        <h3 id="name-new-section-45-extended-key">
<a class="section-number selfRef" href="#section-2.2">2.2. </a><a class="section-name selfRef" href="#name-new-section-45-extended-key">New Section 4.5 - Extended Key Usage</a>
        </h3>
<p id="section-2.2-1">The following subsection introduces a new extended key usage for CMP servers authorized to centrally generate key pairs on behalf of end entities.<a class="pilcrow" href="#section-2.2-1">¶</a></p>
<p class="keepWithNext" id="section-2.2-2">Insert this section after <span><a class="relref" href="https://rfc-editor.org/rfc/rfc4210#section-4.4.3">Section 4.4.3</a> of [<a class="cite xref" href="#RFC4210">RFC4210</a>]</span>:<a class="pilcrow" href="#section-2.2-2">¶</a></p>
<p class="keepWithNext" id="section-2.2-3">4.5. Extended Key Usage<a class="pilcrow" href="#section-2.2-3">¶</a></p>
<p id="section-2.2-4">The extended key usage (EKU) extension indicates the purposes for which the certified key pair may be used. Therefore, it restricts the use of a certificate to specific applications.<a class="pilcrow" href="#section-2.2-4">¶</a></p>
<p id="section-2.2-5">A CA may want to delegate parts of its duties to other PKI management entities. This section provides a mechanism to both prove this delegation and enable an automated means for checking the authorization of this delegation. Such delegation may also be expressed by other means, e.g., explicit configuration.<a class="pilcrow" href="#section-2.2-5">¶</a></p>
<p id="section-2.2-6">To offer automatic validation for the delegation of a role by a CA to another entity, the certificates used for CMP message protection or signed data for central key generation <span class="bcp14">MUST</span> be issued by the delegating CA and <span class="bcp14">MUST</span> contain the respective EKUs. This proves the authorization of this entity by delegating CA to act in the given role, as described below.<a class="pilcrow" href="#section-2.2-6">¶</a></p>
<p class="keepWithNext" id="section-2.2-7">The OIDs to be used for these EKUs are:<a class="pilcrow" href="#section-2.2-7">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-2.2-8">
<pre>   id-kp-cmcCA OBJECT IDENTIFIER ::= {
      iso(1) identified-organization(3) dod(6) internet(1)
      security(5) mechanisms(5) pkix(7) kp(3) 27 }

   id-kp-cmcRA OBJECT IDENTIFIER ::= {
      iso(1) identified-organization(3) dod(6) internet(1)
      security(5) mechanisms(5) pkix(7) kp(3) 28 }

   id-kp-cmKGA OBJECT IDENTIFIER ::= {
      iso(1) identified-organization(3) dod(6) internet(1)
      security(5) mechanisms(5) pkix(7) kp(3) 32 }
</pre><a class="pilcrow" href="#section-2.2-8">¶</a>
</div>
<p id="section-2.2-9">Note: <span><a class="relref" href="https://rfc-editor.org/rfc/rfc6402#section-2.10">Section 2.10</a> of [<a class="cite xref" href="#RFC6402">RFC6402</a>]</span> specifies OIDs for a Certificate Management over CMS (CMC) CA and a CMC RA. As the functionality of a CA and RA is not specific to any certificate management protocol (such as CMC or CMP), these EKUs are reused by CMP.<a class="pilcrow" href="#section-2.2-9">¶</a></p>
<p class="keepWithNext" id="section-2.2-10">The meaning of the id-kp-cmKGA EKU is as follows:<a class="pilcrow" href="#section-2.2-10">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2.2-11">
          <dt id="section-2.2-11.1">CMP KGA:</dt>
          <dd id="section-2.2-11.2" style="margin-left: 5.0em">CMP key generation authorities are CAs or are identified by the id-kp-cmKGA extended key usage.  The CMP KGA knows the private key it generated on behalf of the end entity.  This is a very sensitive service and needs specific authorization, which by default is with the CA certificate itself.  The CA may delegate its authorization by placing the id-kp-cmKGA extended key usage in the certificate used to authenticate the origin of the generated private key. The authorization may also be determined through local configuration of the end entity.<a class="pilcrow" href="#section-2.2-11.2">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="CMP-5.1.1">
<section id="section-2.3">
        <h3 id="name-update-section-511-pki-mess">
<a class="section-number selfRef" href="#section-2.3">2.3. </a><a class="section-name selfRef" href="#name-update-section-511-pki-mess">Update Section 5.1.1 - PKI Message Header</a>
        </h3>
<p id="section-2.3-1"><span><a class="relref" href="https://rfc-editor.org/rfc/rfc4210#section-5.1.1">Section 5.1.1</a> of [<a class="cite xref" href="#RFC4210">RFC4210</a>]</span> describes the PKI message header. This document introduces the new version 3, indicating support of EnvelopedData as specified in <a class="auto internal xref" href="#CMP-5.2.2">Section 2.7</a> and hashAlg as specified in <a class="auto internal xref" href="#CMP-5.3.18">Section 2.10</a>.<a class="pilcrow" href="#section-2.3-1">¶</a></p>
<p class="keepWithNext" id="section-2.3-2">Replace the ASN.1 syntax of PKIHeader and the subsequent description of pvno with the following text:<a class="pilcrow" href="#section-2.3-2">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-2.3-3">
<pre>   PKIHeader ::= SEQUENCE {
      pvno                INTEGER     { cmp1999(1), cmp2000(2),
                                        cmp2021(3) },
      sender              GeneralName,
      recipient           GeneralName,
      messageTime     [0] GeneralizedTime         OPTIONAL,
      protectionAlg   [1] AlgorithmIdentifier{ALGORITHM, {...}}
                          OPTIONAL,
      senderKID       [2] KeyIdentifier           OPTIONAL,
      recipKID        [3] KeyIdentifier           OPTIONAL,
      transactionID   [4] OCTET STRING            OPTIONAL,
      senderNonce     [5] OCTET STRING            OPTIONAL,
      recipNonce      [6] OCTET STRING            OPTIONAL,
      freeText        [7] PKIFreeText             OPTIONAL,
      generalInfo     [8] SEQUENCE SIZE (1..MAX) OF
                          InfoTypeAndValue     OPTIONAL
   }

   PKIFreeText ::= SEQUENCE SIZE (1..MAX) OF UTF8String
</pre><a class="pilcrow" href="#section-2.3-3">¶</a>
</div>
<p id="section-2.3-4">The usage of the protocol version number (pvno) is described in Section <a class="relref" href="https://rfc-editor.org/rfc/rfc4210#section-7">7</a>.<a class="pilcrow" href="#section-2.3-4">¶</a></p>
</section>
</div>
<div id="CMP-5.1.1.3">
<section id="section-2.4">
        <h3 id="name-new-section-5113-certprofil">
<a class="section-number selfRef" href="#section-2.4">2.4. </a><a class="section-name selfRef" href="#name-new-section-5113-certprofil">New Section 5.1.1.3 - CertProfile</a>
        </h3>
<p id="section-2.4-1"><span><a class="relref" href="https://rfc-editor.org/rfc/rfc4210#section-5.1.1">Section 5.1.1</a> of [<a class="cite xref" href="#RFC4210">RFC4210</a>]</span> defines the PKIHeader and id-it OIDs to be used in the generalInfo field. This section introduces id-it-certProfile.<a class="pilcrow" href="#section-2.4-1">¶</a></p>
<p id="section-2.4-2">Insert this section after <span><a class="relref" href="https://rfc-editor.org/rfc/rfc4210#section-5.1.1.2">Section 5.1.1.2</a> of [<a class="cite xref" href="#RFC4210">RFC4210</a>]</span>:<a class="pilcrow" href="#section-2.4-2">¶</a></p>
<p id="section-2.4-3">5.1.1.3. CertProfile<a class="pilcrow" href="#section-2.4-3">¶</a></p>
<p id="section-2.4-4">This is used by the EE to indicate specific certificate profiles, e.g., when requesting a new certificate or a certificate request template; see Section 5.3.19.16.<a class="pilcrow" href="#section-2.4-4">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-2.4-5">
<pre>   id-it-certProfile  OBJECT IDENTIFIER ::= {id-it 21}
   CertProfileValue ::= SEQUENCE SIZE (1..MAX) OF UTF8String
</pre><a class="pilcrow" href="#section-2.4-5">¶</a>
</div>
<p id="section-2.4-6">When used in an ir/cr/kur/genm, the value <span class="bcp14">MUST NOT</span> contain more elements than the number of CertReqMsg or InfoTypeAndValue elements and the certificate profile names refer to the elements in the given order.<a class="pilcrow" href="#section-2.4-6">¶</a></p>
<p id="section-2.4-7">When used in a p10cr, the value <span class="bcp14">MUST NOT</span> contain multiple certificate profile names.<a class="pilcrow" href="#section-2.4-7">¶</a></p>
</section>
</div>
<div id="CMP-5.1.3.1">
<section id="section-2.5">
        <h3 id="name-update-section-5131-shared-">
<a class="section-number selfRef" href="#section-2.5">2.5. </a><a class="section-name selfRef" href="#name-update-section-5131-shared-">Update Section 5.1.3.1 - Shared Secret Information</a>
        </h3>
<p id="section-2.5-1"><span><a class="relref" href="https://rfc-editor.org/rfc/rfc4210#section-5.1.3.1">Section 5.1.3.1</a> of [<a class="cite xref" href="#RFC4210">RFC4210</a>]</span> describes the protection of a PKIMessage based on message authentication code (MAC) using the algorithm id-PasswordBasedMac.<a class="pilcrow" href="#section-2.5-1">¶</a></p>
<p id="section-2.5-2">Replace the first paragraph with the following text:<a class="pilcrow" href="#section-2.5-2">¶</a></p>
<p id="section-2.5-3">In this case, the sender and recipient share secret information with sufficient entropy (established via out-of-band means or from a previous PKI management operation). PKIProtection will contain a MAC value and the protectionAlg <span class="bcp14">MAY</span> be one of the options described in <span><a class="internal xref" href="#RFC9481">CMP Algorithms</a> [<a class="cite xref" href="#RFC9481">RFC9481</a>]</span>. The PasswordBasedMac is specified as follows (see also <span>[<a class="cite xref" href="#RFC4211">RFC4211</a>]</span> and <span>[<a class="cite xref" href="#RFC9045">RFC9045</a>]</span>):<a class="pilcrow" href="#section-2.5-3">¶</a></p>
<p id="section-2.5-4">Replace the last paragraph with the following text (Note: This fixes Errata ID 2616):<a class="pilcrow" href="#section-2.5-4">¶</a></p>
<p id="section-2.5-5">Note: It is <span class="bcp14">RECOMMENDED</span> that the fields of PBMParameter remain constant throughout the messages of a single transaction (e.g., ir/ip/certConf/pkiConf) to reduce the overhead associated with PasswordBasedMac computation.<a class="pilcrow" href="#section-2.5-5">¶</a></p>
</section>
</div>
<div id="CMP-5.1.3.4">
<section id="section-2.6">
        <h3 id="name-replace-section-5134-multip">
<a class="section-number selfRef" href="#section-2.6">2.6. </a><a class="section-name selfRef" href="#name-replace-section-5134-multip">Replace Section 5.1.3.4 - Multiple Protection</a>
        </h3>
<p id="section-2.6-1"><span><a class="relref" href="https://rfc-editor.org/rfc/rfc4210#section-5.1.3.4">Section 5.1.3.4</a> of [<a class="cite xref" href="#RFC4210">RFC4210</a>]</span> describes the nested message. This document also enables using nested messages for batch-delivery  transport of PKI messages between PKI management entities and with mixed body types.<a class="pilcrow" href="#section-2.6-1">¶</a></p>
<p class="keepWithNext" id="section-2.6-2">Replace the text of the section with the following text:<a class="pilcrow" href="#section-2.6-2">¶</a></p>
<p class="keepWithNext" id="section-2.6-3">5.1.3.4.  Multiple Protection<a class="pilcrow" href="#section-2.6-3">¶</a></p>
<p id="section-2.6-4">When receiving a protected PKI message, a PKI management entity, such as an RA, <span class="bcp14">MAY</span> forward that message along with adding its own protection (which is a MAC or a signature, depending on the information and certificates shared between the RA and the CA).  Additionally, multiple PKI messages <span class="bcp14">MAY</span> be aggregated.  There are several use cases for such messages.<a class="pilcrow" href="#section-2.6-4">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.6-5.1">The RA confirms having validated and authorized a message and forwards the original message unchanged.<a class="pilcrow" href="#section-2.6-5.1">¶</a>
</li>
          <li class="normal" id="section-2.6-5.2">The RA modifies the message(s) in some way (e.g., adds or modifies particular field values or adds new extensions) before forwarding them; then, it <span class="bcp14">MAY</span> create its own desired PKIBody.  If the changes made by the RA to PKIMessage break the POP of a certificate request, the RA <span class="bcp14">MUST</span> set the popo field to RAVerified. It <span class="bcp14">MAY</span> include the original PKIMessage from the EE in the generalInfo field of PKIHeader of a nested message (to accommodate, for example, cases in which the CA wishes to check POP or other information on the original EE message). The infoType to be used in this situation is {id-it 15} (see Section <a class="relref" href="https://rfc-editor.org/rfc/rfc4210#section-5.3.19">5.3.19</a> for the value of id-it), and the infoValue is PKIMessages (contents <span class="bcp14">MUST</span> be in the same order as the message in PKIBody).<a class="pilcrow" href="#section-2.6-5.2">¶</a>
</li>
          <li class="normal" id="section-2.6-5.3">A PKI management entity collects several messages that are to be forwarded in the same direction and forwards them in a batch. Request messages can be transferred as batch upstream (towards the CA); response or announce messages can be transferred as batch downstream (towards an RA but not to the EE). For instance, this can be used when bridging an off-line connection between two PKI management entities.<a class="pilcrow" href="#section-2.6-5.3">¶</a>
</li>
        </ul>
<p class="keepWithNext" id="section-2.6-6">These use cases are accomplished by nesting the messages within a new PKI message.  The structure used is as follows:<a class="pilcrow" href="#section-2.6-6">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-2.6-7">
<pre>   NestedMessageContent ::= PKIMessages
</pre><a class="pilcrow" href="#section-2.6-7">¶</a>
</div>
</section>
</div>
<div id="CMP-5.2.2">
<section id="section-2.7">
        <h3 id="name-replace-section-522-encrypt">
<a class="section-number selfRef" href="#section-2.7">2.7. </a><a class="section-name selfRef" href="#name-replace-section-522-encrypt">Replace Section 5.2.2 - Encrypted Values</a>
        </h3>
<p id="section-2.7-1"><span><a class="relref" href="https://rfc-editor.org/rfc/rfc4210#section-5.2.2">Section 5.2.2</a> of [<a class="cite xref" href="#RFC4210">RFC4210</a>]</span> describes the use of EncryptedValue to transport encrypted data. This document extends the encryption of data to preferably use EnvelopedData.<a class="pilcrow" href="#section-2.7-1">¶</a></p>
<p class="keepWithNext" id="section-2.7-2">Replace the text of the section with the following text:<a class="pilcrow" href="#section-2.7-2">¶</a></p>
<p class="keepWithNext" id="section-2.7-3">5.2.2.  Encrypted Values<a class="pilcrow" href="#section-2.7-3">¶</a></p>
<p id="section-2.7-4">Where encrypted data (in this specification, private keys, certificates, or revocation passphrase) is sent in PKI messages, the EncryptedKey data structure is used.<a class="pilcrow" href="#section-2.7-4">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-2.7-5">
<pre>   EncryptedKey ::= CHOICE {
      encryptedValue        EncryptedValue, -- deprecated
      envelopedData     [0] EnvelopedData }
</pre><a class="pilcrow" href="#section-2.7-5">¶</a>
</div>
<p id="section-2.7-6">See <span><a class="internal xref" href="#RFC4211">Certificate Request Message Format (CRMF)</a> [<a class="cite xref" href="#RFC4211">RFC4211</a>]</span> for EncryptedKey and EncryptedValue syntax and <span><a class="internal xref" href="#RFC5652">Cryptographic Message Syntax (CMS)</a> [<a class="cite xref" href="#RFC5652">RFC5652</a>]</span> for EnvelopedData syntax. Using the EncryptedKey data structure offers the choice to either use EncryptedValue (for backward compatibility only) or EnvelopedData.  The use of the EncryptedValue structure has been deprecated in favor of the EnvelopedData structure.  Therefore, it is <span class="bcp14">RECOMMENDED</span> to use EnvelopedData.<a class="pilcrow" href="#section-2.7-6">¶</a></p>
<p id="section-2.7-7">Note: The EncryptedKey structure defined in <span><a class="internal xref" href="#RFC4211">CRMF</a> [<a class="cite xref" href="#RFC4211">RFC4211</a>]</span> is reused here, which makes the update backward compatible. Using the new syntax with the untagged default choice EncryptedValue is bits-on-the-wire compatible with the old syntax.<a class="pilcrow" href="#section-2.7-7">¶</a></p>
<p id="section-2.7-8">To indicate support for EnvelopedData, the pvno cmp2021 has been introduced.  Details on the usage of the protocol version number (pvno) are described in Section <a class="relref" href="https://rfc-editor.org/rfc/rfc4210#section-7">7</a>.<a class="pilcrow" href="#section-2.7-8">¶</a></p>
<p id="section-2.7-9">The EncryptedKey data structure is used in CMP to transport a private key, certificate, or revocation passphrase in encrypted form.<a class="pilcrow" href="#section-2.7-9">¶</a></p>
<p class="keepWithNext" id="section-2.7-10">EnvelopedData is used as follows:<a class="pilcrow" href="#section-2.7-10">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.7-11.1">It contains only one RecipientInfo structure because the content is encrypted only for one recipient.<a class="pilcrow" href="#section-2.7-11.1">¶</a>
</li>
          <li class="normal" id="section-2.7-11.2">It may contain a private key in the AsymmetricKeyPackage structure, as defined in <span>[<a class="cite xref" href="#RFC5958">RFC5958</a>]</span>, that is wrapped in a SignedData structure, as specified in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc5652#section-5">Section 5</a> of CMS [<a class="cite xref" href="#RFC5652">RFC5652</a>]</span> and <span>[<a class="cite xref" href="#RFC8933">RFC8933</a>]</span>, and signed by the Key Generation Authority.<a class="pilcrow" href="#section-2.7-11.2">¶</a>
</li>
          <li class="normal" id="section-2.7-11.3">It may contain a certificate or revocation passphrase directly in the encryptedContent field.<a class="pilcrow" href="#section-2.7-11.3">¶</a>
</li>
        </ul>
<p id="section-2.7-12">The content of the EnvelopedData structure, as specified in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc5652#section-6">Section 6</a> of CMS [<a class="cite xref" href="#RFC5652">RFC5652</a>]</span>, <span class="bcp14">MUST</span> be encrypted using a newly generated symmetric content-encryption key. This content-encryption key <span class="bcp14">MUST</span> be securely provided to the recipient using one of three key management techniques.<a class="pilcrow" href="#section-2.7-12">¶</a></p>
<p class="keepWithNext" id="section-2.7-13">The choice of the key management technique to be used by the sender depends on the credential available at the recipient:<a class="pilcrow" href="#section-2.7-13">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.7-14.1">recipient's certificate with an algorithm identifier and a        
public key that supports key transport and where any given key usage extension 
allows keyEncipherment: The content-encryption key will be protected using the 
key transport key management technique, as specified in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc5652#section-6.2.1">Section 6.2.1</a> of CMS [<a class="cite xref" href="#RFC5652">RFC5652</a>]</span>.<a class="pilcrow" href="#section-2.7-14.1">¶</a>
</li>
          <li class="normal" id="section-2.7-14.2">recipient's certificate with an algorithm identifier and a        
public key that supports key agreement and where any given key usage extension 
allows keyAgreement: The content-encryption key will be protected using the     
key agreement key management technique, as specified in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc5652#section-6.2.2">Section 6.2.2</a> of CMS [<a class="cite xref" href="#RFC5652">RFC5652</a>]</span>.<a class="pilcrow" href="#section-2.7-14.2">¶</a>
</li>
          <li class="normal" id="section-2.7-14.3">a password or shared secret: The content-encryption key will be   
protected using the password-based key management technique, as specified in    
<span><a class="relref" href="https://rfc-editor.org/rfc/rfc5652#section-6.2.4">Section 6.2.4</a> of CMS [<a class="cite xref" href="#RFC5652">RFC5652</a>]</span>.<a class="pilcrow" href="#section-2.7-14.3">¶</a>
</li>
        </ul>
</section>
</div>
<div id="CMP-5.2.9">
<section id="section-2.8">
        <h3 id="name-new-section-529-generalized">
<a class="section-number selfRef" href="#section-2.8">2.8. </a><a class="section-name selfRef" href="#name-new-section-529-generalized">New Section 5.2.9 - GeneralizedTime</a>
        </h3>
<p id="section-2.8-1">The following subsection points implementers to <span>[<a class="cite xref" href="#RFC5280">RFC5280</a>]</span> regarding usage of GeneralizedTime.<a class="pilcrow" href="#section-2.8-1">¶</a></p>
<p class="keepWithNext" id="section-2.8-2">Insert this section after <span><a class="relref" href="https://rfc-editor.org/rfc/rfc4210#section-5.2.8.4">Section 5.2.8.4</a> of [<a class="cite xref" href="#RFC4210">RFC4210</a>]</span>:<a class="pilcrow" href="#section-2.8-2">¶</a></p>
<p id="section-2.8-3">5.2.9 GeneralizedTime<a class="pilcrow" href="#section-2.8-3">¶</a></p>
<p id="section-2.8-4">GeneralizedTime is a standard ASN.1 type and <span class="bcp14">SHALL</span> be used as specified in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc5280#section-4.1.2.5.2">Section 4.1.2.5.2</a> of [<a class="cite xref" href="#RFC5280">RFC5280</a>]</span>.<a class="pilcrow" href="#section-2.8-4">¶</a></p>
</section>
</div>
<div id="CMP-5.3.4">
<section id="section-2.9">
        <h3 id="name-update-section-534-certific">
<a class="section-number selfRef" href="#section-2.9">2.9. </a><a class="section-name selfRef" href="#name-update-section-534-certific">Update Section 5.3.4 - Certification Response</a>
        </h3>
<p id="section-2.9-1"><span><a class="relref" href="https://rfc-editor.org/rfc/rfc4210#section-5.3.4">Section 5.3.4</a> of [<a class="cite xref" href="#RFC4210">RFC4210</a>]</span> describes the Certification Response. This document updates the syntax by using the parent structure EncryptedKey instead of EncryptedValue, as described in <a class="auto internal xref" href="#CMP-5.2.2">Section 2.7</a> above. Additionally, it clarifies the certReqId to be used in response to a p10cr message.<a class="pilcrow" href="#section-2.9-1">¶</a></p>
<p class="keepWithNext" id="section-2.9-2">Replace the ASN.1 syntax with the following text (Note: This also fixes Errata ID 3949 and 4078):<a class="pilcrow" href="#section-2.9-2">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-2.9-3">
<pre>   CertRepMessage ::= SEQUENCE {
       caPubs          [1] SEQUENCE SIZE (1..MAX) OF CMPCertificate
                           OPTIONAL,
       response            SEQUENCE OF CertResponse
   }

   CertResponse ::= SEQUENCE {
       certReqId           INTEGER,
       status              PKIStatusInfo,
       certifiedKeyPair    CertifiedKeyPair    OPTIONAL,
       rspInfo             OCTET STRING        OPTIONAL
       -- analogous to the id-regInfo-utf8Pairs string defined
       -- for regInfo in CertReqMsg [RFC4211]
   }

   CertifiedKeyPair ::= SEQUENCE {
      certOrEncCert       CertOrEncCert,
      privateKey      [0] EncryptedKey        OPTIONAL,
      -- See [RFC4211] for comments on encoding.
      publicationInfo [1] PKIPublicationInfo  OPTIONAL
   }

   CertOrEncCert ::= CHOICE {
      certificate     [0] CMPCertificate,
      encryptedCert   [1] EncryptedKey
   }
</pre><a class="pilcrow" href="#section-2.9-3">¶</a>
</div>
<p class="keepWithNext" id="section-2.9-4">Add the following as a new paragraph right after the ASN.1 syntax:<a class="pilcrow" href="#section-2.9-4">¶</a></p>
<p id="section-2.9-5">A p10cr message contains exactly one CertificationRequestInfo data structure, as specified in <span><a class="internal xref" href="#RFC2986">PKCS #10</a> [<a class="cite xref" href="#RFC2986">RFC2986</a>]</span>, but no certReqId.  Therefore, the certReqId in the corresponding Certification Response (cp) message <span class="bcp14">MUST</span> be set to -1.<a class="pilcrow" href="#section-2.9-5">¶</a></p>
<p class="keepWithNext" id="section-2.9-6">Add the following as new paragraphs to the end of the section:<a class="pilcrow" href="#section-2.9-6">¶</a></p>
<p id="section-2.9-7">The use of EncryptedKey is described in Section <a class="relref" href="https://rfc-editor.org/rfc/rfc4210#section-5.2.2">5.2.2</a>.<a class="pilcrow" href="#section-2.9-7">¶</a></p>
<p id="section-2.9-8">Note: To indicate support for EnvelopedData, the pvno cmp2021 has been introduced. Details on the usage of different protocol version numbers (pvno) are described in Section <a class="relref" href="https://rfc-editor.org/rfc/rfc4210#section-7">7</a>.<a class="pilcrow" href="#section-2.9-8">¶</a></p>
</section>
</div>
<div id="CMP-5.3.18">
<section id="section-2.10">
        <h3 id="name-update-section-5318-certifi">
<a class="section-number selfRef" href="#section-2.10">2.10. </a><a class="section-name selfRef" href="#name-update-section-5318-certifi">Update Section 5.3.18 - Certificate Confirmation Content</a>
        </h3>
<p id="section-2.10-1">This section introduces an optional hashAlg field to the CertStatus type used in certConf messages to explicitly specify the hash algorithm for those certificates where no hash algorithm is specified in the signatureAlgorithm field.<a class="pilcrow" href="#section-2.10-1">¶</a></p>
<p class="keepWithNext" id="section-2.10-2">Replace the ASN.1 Syntax of CertStatus with the following text:<a class="pilcrow" href="#section-2.10-2">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-2.10-3">
<pre>   CertStatus ::= SEQUENCE {
      certHash    OCTET STRING,
      certReqId   INTEGER,
      statusInfo  PKIStatusInfo OPTIONAL,
      hashAlg [0] AlgorithmIdentifier{DIGEST-ALGORITHM, {...}}
                  OPTIONAL
   }
</pre><a class="pilcrow" href="#section-2.10-3">¶</a>
</div>
<p id="section-2.10-4">The hashAlg field <span class="bcp14">SHOULD</span> be used only in exceptional cases where the signatureAlgorithm of the certificate to be confirmed does not specify a hash algorithm in the OID or in the parameters. In such cases, e.g., for EdDSA, the hashAlg <span class="bcp14">MUST</span> be used to specify the hash algorithm to be used for calculating the certHash value. Otherwise, the certHash value <span class="bcp14">SHALL</span> be computed using the same hash algorithm as used to create and verify the certificate signature. If hashAlg is used, the CMP version indicated by the certConf message header must be cmp2021(3).<a class="pilcrow" href="#section-2.10-4">¶</a></p>
</section>
</div>
<div id="CMP-5.3.19.2">
<section id="section-2.11">
        <h3 id="name-update-section-53192-signin">
<a class="section-number selfRef" href="#section-2.11">2.11. </a><a class="section-name selfRef" href="#name-update-section-53192-signin">Update Section 5.3.19.2 - Signing Key Pair Types</a>
        </h3>
<p id="section-2.11-1">The following section clarifies the usage of the Signing Key Pair Types on referencing elliptic curves.<a class="pilcrow" href="#section-2.11-1">¶</a></p>
<p class="keepWithNext" id="section-2.11-2">Insert this note at the end of <span><a class="relref" href="https://rfc-editor.org/rfc/rfc4210#section-5.3.19.2">Section 5.3.19.2</a> of [<a class="cite xref" href="#RFC4210">RFC4210</a>]</span>:<a class="pilcrow" href="#section-2.11-2">¶</a></p>
<p id="section-2.11-3">Note: In case several elliptic curves are supported, several id-ecPublicKey elements as defined in <span>[<a class="cite xref" href="#RFC5480">RFC5480</a>]</span> need to be given, one per named curve.<a class="pilcrow" href="#section-2.11-3">¶</a></p>
</section>
</div>
<div id="CMP-5.3.19.3">
<section id="section-2.12">
        <h3 id="name-update-section-53193-encryp">
<a class="section-number selfRef" href="#section-2.12">2.12. </a><a class="section-name selfRef" href="#name-update-section-53193-encryp">Update Section 5.3.19.3 - Encryption/Key Agreement Key Pair Types</a>
        </h3>
<p id="section-2.12-1">The following section clarifies the use of the Encryption/Key Agreement Key Pair Types on referencing elliptic curves.<a class="pilcrow" href="#section-2.12-1">¶</a></p>
<p id="section-2.12-2">Insert this note at the end of <span><a class="relref" href="https://rfc-editor.org/rfc/rfc4210#section-5.3.19.3">Section 5.3.19.3</a> of [<a class="cite xref" href="#RFC4210">RFC4210</a>]</span>:<a class="pilcrow" href="#section-2.12-2">¶</a></p>
<p class="keepWithNext" id="section-2.12-3">Note: In case several elliptic curves are supported, several id-ecPublicKey elements as defined in <span>[<a class="cite xref" href="#RFC5480">RFC5480</a>]</span> need to be given, one per named curve.<a class="pilcrow" href="#section-2.12-3">¶</a></p>
</section>
</div>
<div id="CMP-5.3.19.9">
<section id="section-2.13">
        <h3 id="name-replace-section-53199-revoc">
<a class="section-number selfRef" href="#section-2.13">2.13. </a><a class="section-name selfRef" href="#name-replace-section-53199-revoc">Replace Section 5.3.19.9 - Revocation Passphrase</a>
        </h3>
<p id="section-2.13-1"><span><a class="relref" href="https://rfc-editor.org/rfc/rfc4210#section-5.3.19.9">Section 5.3.19.9</a> of [<a class="cite xref" href="#RFC4210">RFC4210</a>]</span> describes the provisioning of a revocation passphrase for authenticating a later revocation request. This document updates the handling by using the parent structure EncryptedKey instead of EncryptedValue to transport this information, as described in <a class="auto internal xref" href="#CMP-5.2.2">Section 2.7</a> above.<a class="pilcrow" href="#section-2.13-1">¶</a></p>
<p class="keepWithNext" id="section-2.13-2">Replace the text of the section with the following text:<a class="pilcrow" href="#section-2.13-2">¶</a></p>
<p class="keepWithNext" id="section-2.13-3">5.3.19.9.  Revocation Passphrase<a class="pilcrow" href="#section-2.13-3">¶</a></p>
<p id="section-2.13-4">This <span class="bcp14">MAY</span> be used by the EE to send a passphrase to a CA/RA for the purpose of authenticating a later revocation request (in the case that the appropriate signing private key is no longer available to authenticate the request).  See Appendix <a class="relref" href="https://rfc-editor.org/rfc/rfc4210#appendix-B">B</a> for further details on the use of this mechanism.<a class="pilcrow" href="#section-2.13-4">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-2.13-5">
<pre>   GenMsg:    {id-it 12}, EncryptedKey
   GenRep:    {id-it 12}, &lt; absent &gt;
</pre><a class="pilcrow" href="#section-2.13-5">¶</a>
</div>
<p id="section-2.13-6">The use of EncryptedKey is described in Section <a class="relref" href="https://rfc-editor.org/rfc/rfc4210#section-5.2.2">5.2.2</a>.<a class="pilcrow" href="#section-2.13-6">¶</a></p>
</section>
</div>
<div id="CMP-5.3.19.14">
<section id="section-2.14">
        <h3 id="name-new-section-531914-ca-certi">
<a class="section-number selfRef" href="#section-2.14">2.14. </a><a class="section-name selfRef" href="#name-new-section-531914-ca-certi">New Section 5.3.19.14 - CA Certificates</a>
        </h3>
<p id="section-2.14-1">The following subsection describes PKI general messages using id-it-caCerts. The intended use is specified in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc9483#section-4.3">Section 4.3</a> of the Lightweight CMP Profile [<a class="cite xref" href="#RFC9483">RFC9483</a>]</span>.<a class="pilcrow" href="#section-2.14-1">¶</a></p>
<p class="keepWithNext" id="section-2.14-2">Insert this section after <span><a class="relref" href="https://rfc-editor.org/rfc/rfc4210#section-5.3.19.13">Section 5.3.19.13</a> of [<a class="cite xref" href="#RFC4210">RFC4210</a>]</span>:<a class="pilcrow" href="#section-2.14-2">¶</a></p>
<p class="keepWithNext" id="section-2.14-3">5.3.19.14. CA Certificates<a class="pilcrow" href="#section-2.14-3">¶</a></p>
<p id="section-2.14-4">This <span class="bcp14">MAY</span> be used by the client to get CA certificates.<a class="pilcrow" href="#section-2.14-4">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-2.14-5">
<pre>   GenMsg:    {id-it 17}, &lt; absent &gt;
   GenRep:    {id-it 17}, SEQUENCE SIZE (1..MAX) OF
                          CMPCertificate | &lt; absent &gt;
</pre><a class="pilcrow" href="#section-2.14-5">¶</a>
</div>
</section>
</div>
<div id="CMP-5.3.19.15">
<section id="section-2.15">
        <h3 id="name-new-section-531915-root-ca-">
<a class="section-number selfRef" href="#section-2.15">2.15. </a><a class="section-name selfRef" href="#name-new-section-531915-root-ca-">New Section 5.3.19.15 - Root CA Certificate Update</a>
        </h3>
<p id="section-2.15-1">The following subsection describes PKI general messages using id-it-rootCaCert and id-it-rootCaKeyUpdate. The use is specified in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc9483#section-4.3">Section 4.3</a> of the Lightweight CMP Profile  [<a class="cite xref" href="#RFC9483">RFC9483</a>]</span>.<a class="pilcrow" href="#section-2.15-1">¶</a></p>
<p class="keepWithNext" id="section-2.15-2">Insert this section after the new Section 5.3.19.14:<a class="pilcrow" href="#section-2.15-2">¶</a></p>
<p class="keepWithNext" id="section-2.15-3">5.3.19.15. Root CA Certificate Update<a class="pilcrow" href="#section-2.15-3">¶</a></p>
<p id="section-2.15-4">This <span class="bcp14">MAY</span> be used by the client to get an update of a root CA certificate, which is provided in the body of the request message.  In contrast to the ckuann message, this approach follows the request/response model.<a class="pilcrow" href="#section-2.15-4">¶</a></p>
<p id="section-2.15-5">The EE <span class="bcp14">SHOULD</span> reference its current trust anchor in a TrustAnchor structure in the request body, giving the root CA certificate if available; otherwise, the public key value of the trust anchor is given.<a class="pilcrow" href="#section-2.15-5">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-2.15-6">
<pre>   GenMsg:    {id-it 20}, RootCaCertValue | &lt; absent &gt;
   GenRep:    {id-it 18}, RootCaKeyUpdateContent | &lt; absent &gt;

   RootCaCertValue ::= CMPCertificate

   RootCaKeyUpdateValue ::= RootCaKeyUpdateContent

   RootCaKeyUpdateContent ::= SEQUENCE {
      newWithNew       CMPCertificate,
      newWithOld   [0] CMPCertificate OPTIONAL,
      oldWithNew   [1] CMPCertificate OPTIONAL
      }
</pre><a class="pilcrow" href="#section-2.15-6">¶</a>
</div>
<p id="section-2.15-7">Note: In contrast to CAKeyUpdAnnContent, this type offers omitting newWithOld and oldWithNew in the GenRep message, depending on the needs of the EE.<a class="pilcrow" href="#section-2.15-7">¶</a></p>
</section>
</div>
<div id="CMP-5.3.19.16">
<section id="section-2.16">
        <h3 id="name-new-section-531916-certific">
<a class="section-number selfRef" href="#section-2.16">2.16. </a><a class="section-name selfRef" href="#name-new-section-531916-certific">New Section 5.3.19.16 - Certificate Request Template</a>
        </h3>
<p id="section-2.16-1">The following subsection introduces the PKI general message using id-it-certReqTemplate. Details are specified in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc9483#section-4.3">Section 4.3</a> of the Lightweight CMP Profile  [<a class="cite xref" href="#RFC9483">RFC9483</a>]</span>.<a class="pilcrow" href="#section-2.16-1">¶</a></p>
<p class="keepWithNext" id="section-2.16-2">Insert this section after the new Section 5.3.19.15:<a class="pilcrow" href="#section-2.16-2">¶</a></p>
<p class="keepWithNext" id="section-2.16-3">5.3.19.16. Certificate Request Template<a class="pilcrow" href="#section-2.16-3">¶</a></p>
<p id="section-2.16-4">This <span class="bcp14">MAY</span> be used by the client to get a template containing requirements for certificate request attributes and extensions. The controls id-regCtrl-algId and id-regCtrl-rsaKeyLen <span class="bcp14">MAY</span> contain details on the types of subject public keys the CA is willing to certify.<a class="pilcrow" href="#section-2.16-4">¶</a></p>
<p id="section-2.16-5">The id-regCtrl-algId control <span class="bcp14">MAY</span> be used to identify a cryptographic algorithm (see <span><a class="relref" href="https://rfc-editor.org/rfc/rfc5280#section-4.1.2.7">Section 4.1.2.7</a> of [<a class="cite xref" href="#RFC5280">RFC5280</a>]</span>) other than rsaEncryption. The algorithm field <span class="bcp14">SHALL</span> identify a cryptographic algorithm. The contents of the optional parameters field will vary according to the algorithm identified. For example, when the algorithm is set to id-ecPublicKey, the parameters identify the elliptic curve to be used; see <span>[<a class="cite xref" href="#RFC5480">RFC5480</a>]</span>.<a class="pilcrow" href="#section-2.16-5">¶</a></p>
<p id="section-2.16-6">The id-regCtrl-rsaKeyLen control <span class="bcp14">SHALL</span> be used for algorithm rsaEncryption and <span class="bcp14">SHALL</span> contain the intended modulus bit length of the RSA key.<a class="pilcrow" href="#section-2.16-6">¶</a></p>
<p class="keepWithNext" id="section-2.16-7"></p>
<div class="lang-asn.1 sourcecode" id="section-2.16-8">
<pre>   GenMsg:    {id-it 19}, &lt; absent &gt;
   GenRep:    {id-it 19}, CertReqTemplateContent | &lt; absent &gt;

   CertReqTemplateValue  ::= CertReqTemplateContent

   CertReqTemplateContent ::= SEQUENCE {
     certTemplate           CertTemplate,
     keySpec                Controls OPTIONAL }

   Controls  ::= SEQUENCE SIZE (1..MAX) OF AttributeTypeAndValue

   id-regCtrl-algId OBJECT IDENTIFIER ::= { iso(1)
      identified-organization(3) dod(6) internet(1) security(5)
      mechanisms(5) pkix(7) pkip(5) regCtrl(1) 11 }

   AlgIdCtrl ::= AlgorithmIdentifier{ALGORITHM, {...}}

   id-regCtrl-rsaKeyLen OBJECT IDENTIFIER ::= { iso(1)
      identified-organization(3) dod(6) internet(1) security(5)
      mechanisms(5) pkix(7) pkip(5) regCtrl(1) 12 }

   RsaKeyLenCtrl ::= INTEGER (1..MAX)
</pre><a class="pilcrow" href="#section-2.16-8">¶</a>
</div>
<p id="section-2.16-9">The CertReqTemplateValue contains the prefilled certTemplate to be used for a future certificate request.  The publicKey field in the certTemplate <span class="bcp14">MUST NOT</span> be used.  In case the PKI management entity wishes to specify supported public-key algorithms, the keySpec field <span class="bcp14">MUST</span> be used.  One AttributeTypeAndValue per supported algorithm or RSA key length <span class="bcp14">MUST</span> be used.<a class="pilcrow" href="#section-2.16-9">¶</a></p>
<p id="section-2.16-10">Note: The controls ASN.1 type is defined in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc4211#section-6">Section 6</a> of CRMF [<a class="cite xref" href="#RFC4211">RFC4211</a>]</span>.<a class="pilcrow" href="#section-2.16-10">¶</a></p>
</section>
</div>
<div id="CMP-5.3.19.17">
<section id="section-2.17">
        <h3 id="name-new-section-531917-crl-upda">
<a class="section-number selfRef" href="#section-2.17">2.17. </a><a class="section-name selfRef" href="#name-new-section-531917-crl-upda">New Section 5.3.19.17 - CRL Update Retrieval</a>
        </h3>
<p id="section-2.17-1">The following subsection introduces the PKI general message using id-it-crlStatusList and id-it-crls. Details are specified in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc9483#section-4.3">Section 4.3</a> of the Lightweight CMP Profile [<a class="cite xref" href="#RFC9483">RFC9483</a>]</span>. Insert this section after the new Section 5.3.19.16:<a class="pilcrow" href="#section-2.17-1">¶</a></p>
<p id="section-2.17-2">5.3.19.17. CRL Update Retrieval<a class="pilcrow" href="#section-2.17-2">¶</a></p>
<p id="section-2.17-3">This <span class="bcp14">MAY</span> be used by the client to get new CRLs, specifying the source of the CRLs and the thisUpdate value of the latest CRL it already has, if available.  A CRL source is given either by a DistributionPointName or the GeneralNames of the issuing CA.  The DistributionPointName should be treated as an internal pointer to identify a CRL that the server already has and not as a way to ask the server to fetch CRLs from external locations. The server shall only provide those CRLs that are more recent than the ones indicated by the client.<a class="pilcrow" href="#section-2.17-3">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-2.17-4">
<pre>   GenMsg:    {id-it 22}, SEQUENCE SIZE (1..MAX) OF CRLStatus
   GenRep:    {id-it 23}, SEQUENCE SIZE (1..MAX) OF
                            CertificateList  |  &lt; absent &gt;

   CRLSource ::= CHOICE {
      dpn          [0] DistributionPointName,
      issuer       [1] GeneralNames }

   CRLStatus ::= SEQUENCE {
      source       CRLSource,
      thisUpdate   Time OPTIONAL }
</pre><a class="pilcrow" href="#section-2.17-4">¶</a>
</div>
</section>
</div>
<div id="CMP-5.3.21">
<section id="section-2.18">
        <h3 id="name-update-section-5321-error-m">
<a class="section-number selfRef" href="#section-2.18">2.18. </a><a class="section-name selfRef" href="#name-update-section-5321-error-m">Update Section 5.3.21 - Error Message Content</a>
        </h3>
<p id="section-2.18-1"><span><a class="relref" href="https://rfc-editor.org/rfc/rfc4210#section-5.3.21">Section 5.3.21</a> of [<a class="cite xref" href="#RFC4210">RFC4210</a>]</span> describes the regular use of error messages.  This document adds a use by a PKI management entity to initiate delayed delivery in response to certConf, rr, and genm requests and to error messages.<a class="pilcrow" href="#section-2.18-1">¶</a></p>
<p id="section-2.18-2">Replace the first sentence of the first paragraph with the following one:<a class="pilcrow" href="#section-2.18-2">¶</a></p>
<p id="section-2.18-3">This data structure <span class="bcp14">MAY</span> be used by an EE, CA, or RA to convey error information and by a PKI management entity to initiate delayed delivery of responses.<a class="pilcrow" href="#section-2.18-3">¶</a></p>
<p id="section-2.18-4">Replace the second paragraph with the following text:<a class="pilcrow" href="#section-2.18-4">¶</a></p>
<p id="section-2.18-5">This message <span class="bcp14">MAY</span> be generated at any time during a PKI transaction. If the client sends this request, the server <span class="bcp14">MUST</span> respond with a PKIConfirm response or another ErrorMsg if any part of the header is not valid. In case a PKI management entity sends an error message to the EE with the pKIStatusInfo field containing the status "waiting", the EE will initiate polling
 as described in Section <a class="relref" href="https://rfc-editor.org/rfc/rfc4210#section-5.3.22">5.3.22</a>.  Otherwise, both sides <span class="bcp14">MUST</span> treat this message as the end of the transaction (if a transaction is in progress).<a class="pilcrow" href="#section-2.18-5">¶</a></p>
</section>
</div>
<div id="CMP-5.3.22">
<section id="section-2.19">
        <h3 id="name-replace-section-5322-pollin">
<a class="section-number selfRef" href="#section-2.19">2.19. </a><a class="section-name selfRef" href="#name-replace-section-5322-pollin">Replace Section 5.3.22 - Polling Request and Response</a>
        </h3>
<p id="section-2.19-1"><span><a class="relref" href="https://rfc-editor.org/rfc/rfc4210#section-5.3.22">Section 5.3.22</a> of [<a class="cite xref" href="#RFC4210">RFC4210</a>]</span> describes when and how polling messages are used for ir, cr, and kur messages.  This document extends the polling mechanism for outstanding responses to any kind of request message. This update also fixes the inconsistent use of the terms 'pReq' vs. 'pollReq' and 'pRep' vs. 'pollRep'.<a class="pilcrow" href="#section-2.19-1">¶</a></p>
<p class="keepWithNext" id="section-2.19-2">Replace <span><a class="relref" href="https://rfc-editor.org/rfc/rfc4210#section-5.3.22">Section 5.3.22</a> of [<a class="cite xref" href="#RFC4210">RFC4210</a>]</span> with following text:<a class="pilcrow" href="#section-2.19-2">¶</a></p>
<p id="section-2.19-3">This pair of messages is intended to handle scenarios in which the client needs to poll the server to determine the status of an outstanding response (i.e., when the "waiting" PKIStatus has been received).<a class="pilcrow" href="#section-2.19-3">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-2.19-4">
<pre>   PollReqContent ::= SEQUENCE OF SEQUENCE {
      certReqId    INTEGER }

   PollRepContent ::= SEQUENCE OF SEQUENCE {
      certReqId    INTEGER,
      checkAfter   INTEGER,  -- time in seconds
      reason       PKIFreeText OPTIONAL }
</pre><a class="pilcrow" href="#section-2.19-4">¶</a>
</div>
<p id="section-2.19-5">In response to an ir, cr, p10cr, or kur request message, polling is initiated with an ip, cp, or kup response message containing status "waiting". For any type of request message, polling can be initiated with an error response messages with status "waiting". The following clauses describe how polling messages are used.  It is assumed that multiple certConf messages can be sent during transactions.  There will be one sent in response to each ip, cp, or kup that contains a CertStatus for an issued certificate.<a class="pilcrow" href="#section-2.19-5">¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-2.19-6">
     <dt>1</dt>
<dd id="section-2.19-6.1">In response to an ip, cp, or kup message, an EE will send a certConf for all issued certificates and expect a PKIconf for each certConf.  An EE will send a pollReq message in response to each CertResponse element of an ip, cp, or kup message with status "waiting" and in response to an error message with status "waiting".  Its certReqId <span class="bcp14">MUST</span> be either the index of a CertResponse data structure with status "waiting" or -1, referring to the complete response.<a class="pilcrow" href="#section-2.19-6.1">¶</a>
</dd>
          <dd class="break"></dd>
<dt>2</dt>
<dd id="section-2.19-6.2">In response to a pollReq, a CA/RA will return an ip, cp, or kup if one or more of the still pending requested certificates are ready or the final response to some other type of request is available; otherwise, it will return a pollRep.<a class="pilcrow" href="#section-2.19-6.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt>3</dt>
<dd id="section-2.19-6.3">If the EE receives a pollRep, it will wait for at least the number of seconds given in the checkAfter field before sending another pollReq.<a class="pilcrow" href="#section-2.19-6.3">¶</a>
</dd>
          <dd class="break"></dd>
<dt>4</dt>
<dd id="section-2.19-6.4">If the EE receives an ip, cp, or kup, then it will be treated in the same way as the initial response; if it receives any other response, then this will be treated as the final response to the original request.<a class="pilcrow" href="#section-2.19-6.4">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p class="keepWithNext" id="section-2.19-7">The following client-side state machine describes polling for individual CertResponse elements.<a class="pilcrow" href="#section-2.19-7">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.19-8">
<pre>                            START
                              |
                              v
                           Send ir
                              | ip
                              v
                         Check status
                         of returned &lt;------------------------+
                            certs                             |
                              |                               |
    +------------------------&gt;|&lt;------------------+           |
    |                         |                   |           |
    |        (issued)         v       (waiting)   |           |
  Add to &lt;----------- Check CertResponse ------&gt; Add to       |
 conf list           for each certificate      pending list   |
                              /                               |
                             /                                |
                (conf list) /     (empty conf list)           |
                           /                     ip           |
                          /                 +-----------------+
   (empty pending list)  /                  |    pollRep
     END &lt;---- Send certConf        Send pollReq----------&gt;Wait
                      |                 ^   ^               |
                      |                 |   |               |
                      +-----------------+   +---------------+
                         (pending list)
</pre><a class="pilcrow" href="#section-2.19-8">¶</a>
</div>
<p class="keepWithNext" id="section-2.19-9">In the following exchange, the end entity is enrolling for two certificates in one request.<a class="pilcrow" href="#section-2.19-9">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.19-10">
<pre> Step  End Entity                       PKI
 --------------------------------------------------------------------
 1   Format ir
 2                    -&gt; ir      -&gt;
 3                                    Handle ir
 4                                    Manual intervention is
                                      required for both certs
 5                    &lt;- ip      &lt;-
 6   Process ip
 7   Format pollReq
 8                    -&gt; pollReq  -&gt;
 9                                    Check status of cert requests
 10                                   Certificates not ready
 11                                   Format pollRep
 12                   &lt;- pollRep  &lt;-
 13  Wait
 14  Format pollReq
 15                   -&gt; pollReq  -&gt;
 16                                   Check status of cert requests
 17                                   One certificate is ready
 18                                   Format ip
 19                   &lt;- ip       &lt;-
 20  Handle ip
 21  Format certConf
 22                   -&gt; certConf -&gt;
 23                                   Handle certConf
 24                                   Format ack
 25                   &lt;- pkiConf   &lt;-
 26  Format pollReq
 27                   -&gt; pollReq  -&gt;
 28                                   Check status of certificate
 29                                   Certificate is ready
 30                                   Format ip
 31                   &lt;- ip       &lt;-
 31  Handle ip
 32  Format certConf
 33                   -&gt; certConf -&gt;
 34                                   Handle certConf
 35                                   Format ack
 36                   &lt;- pkiConf  &lt;-
</pre><a class="pilcrow" href="#section-2.19-10">¶</a>
</div>
<p class="keepWithNext" id="section-2.19-11">The following client-side state machine describes polling for a complete response message.<a class="pilcrow" href="#section-2.19-11">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.19-12">
<pre>                                Start
                                  |
                                  | Send request
                                  |
             +----------- Receive response ------------+
             |                                         |
             | ip/cp/kup/error with                    | other
             | status "waiting"                        | response
             |                                         |
             v                                         |
 +------&gt; Polling                                      |
 |           |                                         |
 |           | Send pollReq                            |
 |           | Receive response                        |
 |           |                                         |
 |   pollRep | other response                          |
 +-----------+-------------------&gt;+&lt;-------------------+
                                  |
                                  v
                            Handle response
                                  |
                                  v
                                 End
</pre><a class="pilcrow" href="#section-2.19-12">¶</a>
</div>
<p class="keepWithNext" id="section-2.19-13">In the following exchange, the end entity is sending a general message request, and the response is delayed by the server.<a class="pilcrow" href="#section-2.19-13">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.19-14">
<pre> Step  End Entity                       PKI
 --------------------------------------------------------------------
 1   Format genm
 2                  -&gt; genm     -&gt;
 3                                 Handle genm
 4                                 delay in response is necessary
 5                                 Format error message "waiting"
                                   with certReqId set to -1
 6                   &lt;- error   &lt;-
 7   Process error
 8   Format pollReq
 9                   -&gt; pollReq -&gt;
 10                                Check status of original request
                                   general message response not ready
 11                                Format pollRep
 12                  &lt;- pollRep &lt;-
 13  Wait
 14  Format pollReq
 15                  -&gt; pollReq -&gt;
 16                                Check status of original request
                                   general message response is ready
 17                                Format genp
 18                  &lt;- genp    &lt;-
 19  Handle genp
</pre><a class="pilcrow" href="#section-2.19-14">¶</a>
</div>
</section>
</div>
<div id="CMP-7">
<section id="section-2.20">
        <h3 id="name-update-section-7-version-ne">
<a class="section-number selfRef" href="#section-2.20">2.20. </a><a class="section-name selfRef" href="#name-update-section-7-version-ne">Update Section 7 - Version Negotiation</a>
        </h3>
<p id="section-2.20-1"><span><a class="relref" href="https://rfc-editor.org/rfc/rfc4210#section-7">Section 7</a> of [<a class="cite xref" href="#RFC4210">RFC4210</a>]</span> describes the use of CMP versions. This document describes the handling of the additional CMP version cmp2021, which is introduced to indicate support of EnvelopedData and hashAlg.<a class="pilcrow" href="#section-2.20-1">¶</a></p>
<p class="keepWithNext" id="section-2.20-2">Replace the text of the second paragraph with the following text:<a class="pilcrow" href="#section-2.20-2">¶</a></p>
<p id="section-2.20-3">If a client knows the protocol version(s) supported by the server (e.g., from a previous PKIMessage exchange or via some out-of-band means), then it <span class="bcp14">MUST</span> send a PKIMessage with the highest version supported by both it and the server.  If a client does not know what version(s) the server supports, then it <span class="bcp14">MUST</span> send a PKIMessage using the highest version it supports with the following exception. Version cmp2021 <span class="bcp14">SHOULD</span> only be used if cmp2021 syntax is needed for the request being sent or for the expected response.<a class="pilcrow" href="#section-2.20-3">¶</a></p>
<p id="section-2.20-4">Note: Using cmp2000 as the default pvno is done to avoid extra message exchanges for version negotiation and to foster compatibility with cmp2000 implementations. Version cmp2021 syntax is only needed if a message exchange uses hashAlg (in CertStatus) or EnvelopedData.<a class="pilcrow" href="#section-2.20-4">¶</a></p>
</section>
</div>
<div id="CMP-7.1.1">
<section id="section-2.21">
        <h3 id="name-update-section-711-clients-">
<a class="section-number selfRef" href="#section-2.21">2.21. </a><a class="section-name selfRef" href="#name-update-section-711-clients-">Update Section 7.1.1 - Clients Talking to RFC 2510 Servers</a>
        </h3>
<p id="section-2.21-1"><span><a class="relref" href="https://rfc-editor.org/rfc/rfc4210#section-7.1.1">Section 7.1.1</a> of [<a class="cite xref" href="#RFC4210">RFC4210</a>]</span> describes the behavior of a client sending a cmp2000 message talking to a cmp1999 server, as specified in <span>[<a class="cite xref" href="#RFC2510">RFC2510</a>]</span>. This document extends the section to clients with any higher version than cmp1999.<a class="pilcrow" href="#section-2.21-1">¶</a></p>
<p class="keepWithNext" id="section-2.21-2">Replace the first sentence of <span><a class="relref" href="https://rfc-editor.org/rfc/rfc4210#section-7.1.1">Section 7.1.1</a> of [<a class="cite xref" href="#RFC4210">RFC4210</a>]</span> with the following text:<a class="pilcrow" href="#section-2.21-2">¶</a></p>
<p id="section-2.21-3">If, after sending a message with a protocol version number higher than cmp1999, a client receives an ErrorMsgContent with a version of cmp1999, then it <span class="bcp14">MUST</span> abort the current transaction.<a class="pilcrow" href="#section-2.21-3">¶</a></p>
</section>
</div>
<div id="CMP-8.4">
<section id="section-2.22">
        <h3 id="name-add-section-84-private-keys">
<a class="section-number selfRef" href="#section-2.22">2.22. </a><a class="section-name selfRef" href="#name-add-section-84-private-keys">Add Section 8.4 - Private Keys for Certificate Signing and CMP Message Protection</a>
        </h3>
<p id="section-2.22-1">The following subsection addresses the risk arising from reusing the CA private key for CMP message protection.<a class="pilcrow" href="#section-2.22-1">¶</a></p>
<p id="section-2.22-2">Insert this section after <span><a class="relref" href="https://rfc-editor.org/rfc/rfc4210#section-8.3">Section 8.3</a> of [<a class="cite xref" href="#RFC4210">RFC4210</a>]</span>  (Note: This fixes Errata ID 5731):<a class="pilcrow" href="#section-2.22-2">¶</a></p>
<p id="section-2.22-3">8.4. Private Keys for Certificate Signing and CMP Message Protection<a class="pilcrow" href="#section-2.22-3">¶</a></p>
<p id="section-2.22-4">A CA should not reuse its certificate signing key for other purposes, such as protecting CMP responses and TLS connections. This way, exposure to other parts of the system and the number of uses of this particularly critical key are reduced to a minimum.<a class="pilcrow" href="#section-2.22-4">¶</a></p>
</section>
</div>
<div id="CMP-8.5">
<section id="section-2.23">
        <h3 id="name-add-section-85-entropy-of-r">
<a class="section-number selfRef" href="#section-2.23">2.23. </a><a class="section-name selfRef" href="#name-add-section-85-entropy-of-r">Add Section 8.5 - Entropy of Random Numbers, Key Pairs, and Shared Secret Information</a>
        </h3>
<p id="section-2.23-1">The following subsection addresses the risk arising from low entropy of random numbers, asymmetric keys, and shared secret information.<a class="pilcrow" href="#section-2.23-1">¶</a></p>
<p id="section-2.23-2">Insert this section after the new Section 8.4:<a class="pilcrow" href="#section-2.23-2">¶</a></p>
<p id="section-2.23-3">8.5. Entropy of Random Numbers, Key Pairs, and Shared Secret Information<a class="pilcrow" href="#section-2.23-3">¶</a></p>
<p id="section-2.23-4">Implementations must generate nonces and private keys from random input. The use of inadequate pseudorandom number generators (PRNGs) to generate cryptographic keys can result in little or no security. An attacker may find it much easier to reproduce the PRNG environment that produced the keys and to search the resulting small set of possibilities than brute-force searching the whole key space. As an example of predictable random numbers, see <span>[<a class="cite xref" href="#CVE-2008-0166">CVE-2008-0166</a>]</span>; consequences of low-entropy random numbers are discussed in <span><a class="internal xref" href="#MiningPsQs">Mining Your Ps and Qs</a> [<a class="cite xref" href="#MiningPsQs">MiningPsQs</a>]</span>. The generation of quality random numbers is difficult. <span><a class="internal xref" href="#ISO.20543-2019">ISO/IEC 20543:2019</a> [<a class="cite xref" href="#ISO.20543-2019">ISO.20543-2019</a>]</span>, <span><a class="internal xref" href="#NIST_SP_800_90Ar1">NIST SP 800-90A Rev.1</a> [<a class="cite xref" href="#NIST_SP_800_90Ar1">NIST_SP_800_90Ar1</a>]</span>, <span><a class="internal xref" href="#AIS31">BSI AIS 31 V2.0</a> [<a class="cite xref" href="#AIS31">AIS31</a>]</span>, and other specifications offer valuable guidance in this area.<a class="pilcrow" href="#section-2.23-4">¶</a></p>
<p id="section-2.23-5">If shared secret information is generated by a cryptographically secure random number generator (CSRNG), it is safe to assume that the entropy of the shared secret information equals its bit length. If no CSRNG is used, the entropy of shared secret information depends on the details of the generation process and cannot be measured securely after it has been generated. If user-generated passwords are used as shared secret information, their entropy cannot be measured and are typically insufficient for protected delivery of centrally generated keys or trust anchors.<a class="pilcrow" href="#section-2.23-5">¶</a></p>
<p id="section-2.23-6">If the entropy of shared secret information protecting the delivery of a centrally generated key pair is known, it should not be less than the security strength of that key pair; if the shared secret information is reused for different key pairs, the security of the shared secret information should exceed the security strength of each individual key pair.<a class="pilcrow" href="#section-2.23-6">¶</a></p>
<p id="section-2.23-7">For the case of a PKI management operation that delivers a new trust anchor (e.g., a root CA certificate) using caPubs or genm that is (a) not concluded in a timely manner or (b) where the shared secret information is reused for several key management operations, the entropy of the shared secret information, if known, should not be less than the security strength of the trust anchor being managed by the operation. The shared secret information should have an entropy that at least matches the security strength of the key material being managed by the operation. Certain use cases may require shared secret information that may be of a low security strength, e.g., a human-generated password. It is <span class="bcp14">RECOMMENDED</span> that such secret information be limited to a single PKI management operation.<a class="pilcrow" href="#section-2.23-7">¶</a></p>
</section>
</div>
<div id="CMP-8.6">
<section id="section-2.24">
        <h3 id="name-add-section-86-trust-anchor">
<a class="section-number selfRef" href="#section-2.24">2.24. </a><a class="section-name selfRef" href="#name-add-section-86-trust-anchor">Add Section 8.6 - Trust Anchor Provisioning Using CMP Messages</a>
        </h3>
<p id="section-2.24-1">The following subsection addresses the risk arising from in-band provisioning of new trust anchors in a PKI management operation.<a class="pilcrow" href="#section-2.24-1">¶</a></p>
<p id="section-2.24-2">Insert this section after the new Section 8.5:<a class="pilcrow" href="#section-2.24-2">¶</a></p>
<p id="section-2.24-3">8.6. Trust Anchor Provisioning Using CMP Messages<a class="pilcrow" href="#section-2.24-3">¶</a></p>
<p id="section-2.24-4">A provider of trust anchors, which may be an RA involved in configuration management of its clients, <span class="bcp14">MUST NOT</span> include to-be-trusted CA certificates in a CMP message unless the specific deployment scenario can ensure that it is adequate that the receiving EE trusts these certificates, e.g., by loading them into its trust store.<a class="pilcrow" href="#section-2.24-4">¶</a></p>
<p id="section-2.24-5">Whenever an EE receives in a CMP message a CA certificate to be used as a trust anchor (for example in the caPubs field of a certificate response or in a general response), it <span class="bcp14">MUST</span> properly authenticate the message sender with existing trust anchor information without requiring the new trust anchors included in the message.<a class="pilcrow" href="#section-2.24-5">¶</a></p>
<p id="section-2.24-6">Additionally, the EE <span class="bcp14">MUST</span> verify that the sender is an authorized source of trust anchors.  This authorization is governed by local policy and typically indicated using shared secret information or with a signature-based message protection using a certificate issued by a PKI that is explicitly authorized for this purpose.<a class="pilcrow" href="#section-2.24-6">¶</a></p>
</section>
</div>
<div id="CMP-8.7">
<section id="section-2.25">
        <h3 id="name-add-section-87-authorizing-">
<a class="section-number selfRef" href="#section-2.25">2.25. </a><a class="section-name selfRef" href="#name-add-section-87-authorizing-">Add Section 8.7 - Authorizing Requests for Certificates with Specific EKUs</a>
        </h3>
<p id="section-2.25-1">The following subsection addresses the security considerations to follow when authorizing requests for certificates containing specific EKUs.<a class="pilcrow" href="#section-2.25-1">¶</a></p>
<p id="section-2.25-2">Insert this section after new Section 8.6:<a class="pilcrow" href="#section-2.25-2">¶</a></p>
<p id="section-2.25-3">8.7.  Authorizing Requests for Certificates with Specific EKUs<a class="pilcrow" href="#section-2.25-3">¶</a></p>
<p id="section-2.25-4">When a CA issues a certificate containing extended key usage extensions as defined in Section 4.5, this expresses delegation of an authorization that originally is only with the CA certificate itself. Such delegation is a very sensitive action in a PKI and therefore special care must be taken when approving such certificate requests to ensure that only legitimate entities receive a certificate containing such an EKU.<a class="pilcrow" href="#section-2.25-4">¶</a></p>
</section>
</div>
<div id="CMP-B">
<section id="section-2.26">
        <h3 id="name-update-appendix-b-the-use-o">
<a class="section-number selfRef" href="#section-2.26">2.26. </a><a class="section-name selfRef" href="#name-update-appendix-b-the-use-o">Update Appendix B - The Use of Revocation Passphrase</a>
        </h3>
<p id="section-2.26-1"><span><a class="relref" href="https://rfc-editor.org/rfc/rfc4210#appendix-B">Appendix B</a> of [<a class="cite xref" href="#RFC4210">RFC4210</a>]</span> describes the use of the revocation passphrase. As this document updates <span>[<a class="cite xref" href="#RFC4210">RFC4210</a>]</span> to utilize the parent structure EncryptedKey instead of EncryptedValue as described in <a class="auto internal xref" href="#CMP-5.2.2">Section 2.7</a> above, the description is updated accordingly.<a class="pilcrow" href="#section-2.26-1">¶</a></p>
<p class="keepWithNext" id="section-2.26-2">Replace the first bullet point of this section with the following text:<a class="pilcrow" href="#section-2.26-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.26-3.1">The OID and value specified in Section <a class="relref" href="https://rfc-editor.org/rfc/rfc4210#section-5.3.19.9">5.3.19.9</a> <span class="bcp14">MAY</span> be sent in a GenMsg message at any time or <span class="bcp14">MAY</span> be sent in the generalInfo field of the PKIHeader of any PKIMessage at any time.  (In particular, the EncryptedKey structure as described in Section <a class="relref" href="https://rfc-editor.org/rfc/rfc4210#section-5.2.2">5.2.2</a> may be sent in the header of the certConf message that confirms acceptance of certificates requested in an initialization request or certificate request message.)  This conveys a revocation passphrase chosen by the entity to the relevant CA/RA. When EnvelopedData is used, this is in the decrypted bytes of the encryptedContent field. When EncryptedValue is used, this is in the decrypted bytes of the encValue field. Furthermore, the transfer is accomplished with appropriate confidentiality characteristics.<a class="pilcrow" href="#section-2.26-3.1">¶</a>
</li>
        </ul>
<p class="keepWithNext" id="section-2.26-4">Replace the third bullet point of this section with the following text:<a class="pilcrow" href="#section-2.26-4">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.26-5.1">Either the localKeyId attribute of EnvelopedData as specified in <span>[<a class="cite xref" href="#RFC2985">RFC2985</a>]</span> or the valueHint field of EncryptedValue <span class="bcp14">MAY</span> contain a key identifier (chosen by the entity, along with the passphrase itself) to assist in later retrieval of the correct passphrase (e.g., when the revocation request is constructed by the entity and received by the CA/RA).<a class="pilcrow" href="#section-2.26-5.1">¶</a>
</li>
        </ul>
</section>
</div>
<div id="CMP-C">
<section id="section-2.27">
        <h3 id="name-update-appendix-c-request-m">
<a class="section-number selfRef" href="#section-2.27">2.27. </a><a class="section-name selfRef" href="#name-update-appendix-c-request-m">Update Appendix C - Request Message Behavioral Clarifications</a>
        </h3>
<p id="section-2.27-1"><span><a class="relref" href="https://rfc-editor.org/rfc/rfc4210#appendix-C">Appendix C</a> of [<a class="cite xref" href="#RFC4210">RFC4210</a>]</span> provides clarifications to the request message behavior. As this document updates <span>[<a class="cite xref" href="#RFC4210">RFC4210</a>]</span> to utilize the parent structure EncryptedKey instead of EncryptedValue as described in <a class="auto internal xref" href="#CMP-5.2.2">Section 2.7</a> above, the description is updated accordingly.<a class="pilcrow" href="#section-2.27-1">¶</a></p>
<p class="keepWithNext" id="section-2.27-2">Replace the comment within the ASN.1 syntax coming after the definition of POPOSigningKey with the following text (Note: This fixes Errata ID 2615):<a class="pilcrow" href="#section-2.27-2">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-2.27-3">
<pre>-- **********
-- * For the purposes of this specification, the ASN.1 comment
-- * given in [RFC4211] pertains not only to certTemplate but
-- * also to the altCertTemplate control.
-- **********
-- * The signature (using "algorithmIdentifier") is on the
-- * DER-encoded value of poposkInput (i.e., the "value" OCTETs
-- * of the POPOSigningKeyInput DER).  NOTE: If CertReqMsg
-- * certReq certTemplate (or the altCertTemplate control)
-- * contains the subject and publicKey values, then poposkInput
-- * MUST be omitted and the signature MUST be computed on the
-- * DER-encoded value of CertReqMsg certReq (or the DER-
-- * encoded value of AltCertTemplate).  If
-- * certTemplate/altCertTemplate does not contain both the
-- * subject and public key values (i.e., if it contains only
-- * one of these or neither), then poposkInput MUST be present
-- * and MUST be signed.
-- **********
</pre><a class="pilcrow" href="#section-2.27-3">¶</a>
</div>
<p class="keepWithNext" id="section-2.27-4">Replace the ASN.1 syntax of POPOPrivKey with     
the following text:<a class="pilcrow" href="#section-2.27-4">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-2.27-5">
<pre>POPOPrivKey ::= CHOICE {
    thisMessage       [0] BIT STRING,   -- deprecated
    subsequentMessage [1] SubsequentMessage,
    dhMAC             [2] BIT STRING,   -- deprecated
    agreeMAC          [3] PKMACValue,
    encryptedKey      [4] EnvelopedData }
-- **********
-- * When using CMP V2, the encrypted value MUST be transferred in
-- * the thisMessage field that is given as BIT STRING in [RFC4211],
-- * but it requires EncryptedValue. Therefore, this document makes
-- * the behavioral clarification for CMP V2 of specifying that the
-- * contents of "thisMessage" MUST be encoded as an
-- * EncryptedValue and then wrapped in a BIT STRING.
-- * When using CMP V3, the encrypted value MUST be transferred
-- * in the encryptedKey field, as specified in Section 5.2.2.
-- **********
</pre><a class="pilcrow" href="#section-2.27-5">¶</a>
</div>
</section>
</div>
<div id="CMP-D.1">
<section id="section-2.28">
        <h3 id="name-update-appendix-d1-general-">
<a class="section-number selfRef" href="#section-2.28">2.28. </a><a class="section-name selfRef" href="#name-update-appendix-d1-general-">Update Appendix D.1. - General Rules for Interpretation of These Profiles</a>
        </h3>
<p id="section-2.28-1"><span><a class="relref" href="https://rfc-editor.org/rfc/rfc4210#appendix-D.1">Appendix D.1</a> of [<a class="cite xref" href="#RFC4210">RFC4210</a>]</span> provides general rules for interpretation of the PKI management messages profiles specified in Appendices <a class="relref" href="https://rfc-editor.org/rfc/rfc4210#appendix-D">D</a> and <a class="relref" href="https://rfc-editor.org/rfc/rfc4210#appendix-E">E</a> of <span>[<a class="cite xref" href="#RFC4210">RFC4210</a>]</span>. This document updates a sentence regarding the new protocol version cmp2021.<a class="pilcrow" href="#section-2.28-1">¶</a></p>
<p class="keepWithNext" id="section-2.28-2">Replace the last sentence of the first paragraph of the section with the following text:<a class="pilcrow" href="#section-2.28-2">¶</a></p>
<p id="section-2.28-3">Mandatory fields are not mentioned if they have an obvious value (e.g., in this version of these profiles, pvno is always cmp2000).<a class="pilcrow" href="#section-2.28-3">¶</a></p>
</section>
</div>
<div id="CMP-D.2">
<section id="section-2.29">
        <h3 id="name-update-appendix-d2-algorith">
<a class="section-number selfRef" href="#section-2.29">2.29. </a><a class="section-name selfRef" href="#name-update-appendix-d2-algorith">Update Appendix D.2. - Algorithm Use Profile</a>
        </h3>
<p id="section-2.29-1"><span><a class="relref" href="https://rfc-editor.org/rfc/rfc4210#appendix-D.2">Appendix D.2</a> of [<a class="cite xref" href="#RFC4210">RFC4210</a>]</span> provides a list of algorithms that implementations must support when claiming conformance with PKI management message profiles, as specified in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc4210#appendix-D.2">Appendix D.2</a> of CMP [<a class="cite xref" href="#RFC4210">RFC4210</a>]</span>. This document redirects to the new algorithm profile, as specified in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc9481#section-7.1">Section 7.1</a> of CMP Algorithms [<a class="cite xref" href="#RFC9481">RFC9481</a>]</span>.<a class="pilcrow" href="#section-2.29-1">¶</a></p>
<p class="keepWithNext" id="section-2.29-2">Replace the text of the section with the following text:<a class="pilcrow" href="#section-2.29-2">¶</a></p>
<p class="keepWithNext" id="section-2.29-3">D.2. Algorithm Use Profile<a class="pilcrow" href="#section-2.29-3">¶</a></p>
<p id="section-2.29-4">For specifications of algorithm identifiers and respective conventions for conforming implementations, please refer to <span><a class="relref" href="https://rfc-editor.org/rfc/rfc9481#section-7.1">Section 7.1</a> of CMP Algorithms [<a class="cite xref" href="#RFC9481">RFC9481</a>]</span>.<a class="pilcrow" href="#section-2.29-4">¶</a></p>
</section>
</div>
<div id="CMP-D.4">
<section id="section-2.30">
        <h3 id="name-update-appendix-d4-initial-">
<a class="section-number selfRef" href="#section-2.30">2.30. </a><a class="section-name selfRef" href="#name-update-appendix-d4-initial-">Update Appendix D.4. - Initial Registration/Certification (Basic Authenticated Scheme)</a>
        </h3>
<p id="section-2.30-1"><span><a class="relref" href="https://rfc-editor.org/rfc/rfc4210#appendix-D.4">Appendix D.4</a> of [<a class="cite xref" href="#RFC4210">RFC4210</a>]</span> provides the initial registration/certification scheme.  This scheme shall continue using EncryptedValue for backward compatibility reasons.<a class="pilcrow" href="#section-2.30-1">¶</a></p>
<p class="keepWithNext" id="section-2.30-2">Replace the line specifying protectionAlg of the Initialization Response message with the following text (Note: This fixes Errata ID 5201):<a class="pilcrow" href="#section-2.30-2">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-2.30-3">
<pre>protectionAlg        MSG_MAC_ALG
</pre><a class="pilcrow" href="#section-2.30-3">¶</a>
</div>
<p class="keepWithNext" id="section-2.30-4">Replace the comment after the privateKey field of crc[1].certifiedKeyPair in the syntax of the Initialization Response message with the following text:<a class="pilcrow" href="#section-2.30-4">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-2.30-5">
<pre>   -- see Appendix C (Request Message Behavioral Clarifications)
   -- for backward compatibility reasons, use EncryptedValue
</pre><a class="pilcrow" href="#section-2.30-5">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="Trans-Updates">
<section id="section-3">
      <h2 id="name-updates-to-rfc-6712-http-tr">
<a class="section-number selfRef" href="#section-3">3. </a><a class="section-name selfRef" href="#name-updates-to-rfc-6712-http-tr">Updates to RFC 6712 - HTTP Transfer for the Certificate Management Protocol (CMP)</a>
      </h2>
<div id="Trans-1">
<section id="section-3.1">
        <h3 id="name-update-section-1-introducti">
<a class="section-number selfRef" href="#section-3.1">3.1. </a><a class="section-name selfRef" href="#name-update-section-1-introducti">Update Section 1 - Introduction</a>
        </h3>
<p id="section-3.1-1">To indicate and explain why delayed delivery of all kinds of PKIMessages may be handled at transfer level and/or at CMP level, the introduction of <span>[<a class="cite xref" href="#RFC6712">RFC6712</a>]</span> is updated.<a class="pilcrow" href="#section-3.1-1">¶</a></p>
<p id="section-3.1-2">Replace the third paragraph of this section with the following text:<a class="pilcrow" href="#section-3.1-2">¶</a></p>
<p id="section-3.1-3">In addition to reliable transport, CMP requires connection and error handling from the transfer protocol, which is all covered by HTTP.  Additionally, delayed delivery of CMP response messages may be handled at transfer level, regardless of the message contents.  Since this document extends the polling mechanism specified in the second version of CMP <span>[<a class="cite xref" href="#RFC4210">RFC4210</a>]</span> to cover all types of PKI management transactions, delays detected at application level may also be handled within CMP, using pollReq and pollRep messages.<a class="pilcrow" href="#section-3.1-3">¶</a></p>
</section>
</div>
<div id="Trans-1.1">
<section id="section-3.2">
        <h3 id="name-new-section-11-changes-since">
<a class="section-number selfRef" href="#section-3.2">3.2. </a><a class="section-name selfRef" href="#name-new-section-11-changes-since">New Section 1.1 - Changes Since RFC 6712</a>
        </h3>
<p id="section-3.2-1">The following subsection describes feature updates to <span>[<a class="cite xref" href="#RFC6712">RFC6712</a>]</span>. They are related to the base specification. Hence, references to the original sections in <span>[<a class="cite xref" href="#RFC6712">RFC6712</a>]</span> are used whenever possible.<a class="pilcrow" href="#section-3.2-1">¶</a></p>
<p class="keepWithNext" id="section-3.2-2">Insert this section after the current <span><a class="relref" href="https://rfc-editor.org/rfc/rfc6712#section-1">Section 1</a> of [<a class="cite xref" href="#RFC6712">RFC6712</a>]</span>:<a class="pilcrow" href="#section-3.2-2">¶</a></p>
<p class="keepWithNext" id="section-3.2-3">1.1  Changes Since RFC 6712<a class="pilcrow" href="#section-3.2-3">¶</a></p>
<p class="keepWithNext" id="section-3.2-4">The following updates are made in this document:<a class="pilcrow" href="#section-3.2-4">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-5.1">Introduce the HTTP path '/.well-known/cmp'.<a class="pilcrow" href="#section-3.2-5.1">¶</a>
</li>
          <li class="normal" id="section-3.2-5.2">Extend the URI structure.<a class="pilcrow" href="#section-3.2-5.2">¶</a>
</li>
        </ul>
</section>
</div>
<div id="Trans-3.6">
<section id="section-3.3">
        <h3 id="name-replace-section-36-http-req">
<a class="section-number selfRef" href="#section-3.3">3.3. </a><a class="section-name selfRef" href="#name-replace-section-36-http-req">Replace Section 3.6 - HTTP Request-URI</a>
        </h3>
<p id="section-3.3-1"><span><a class="relref" href="https://rfc-editor.org/rfc/rfc6712#section-3.6">Section 3.6</a> of [<a class="cite xref" href="#RFC6712">RFC6712</a>]</span> specifies the used HTTP URIs. This document introduces the HTTP path '/.well-known/cmp' and extends the URIs.<a class="pilcrow" href="#section-3.3-1">¶</a></p>
<p class="keepWithNext" id="section-3.3-2">Replace the text of the section with the following text:<a class="pilcrow" href="#section-3.3-2">¶</a></p>
<p class="keepWithNext" id="section-3.3-3">3.6.  HTTP Request-URI<a class="pilcrow" href="#section-3.3-3">¶</a></p>
<p id="section-3.3-4">Each CMP server on a PKI management entity supporting HTTP or HTTPS transfer <span class="bcp14">MUST</span> support the use of the path prefix '/.well-known/' as defined in <span>[<a class="cite xref" href="#RFC8615">RFC8615</a>]</span> and the registered name 'cmp' to ease interworking in a multi-vendor environment.<a class="pilcrow" href="#section-3.3-4">¶</a></p>
<p class="keepWithNext" id="section-3.3-5">The CMP client needs to be configured with sufficient information to form the CMP server URI.  This is at least the authority portion of the URI, e.g., 'www.example.com:80', or the full operation path segment of the PKI management entity. Additionally, <span class="bcp14">OPTIONAL</span> path segments <span class="bcp14">MAY</span> be added after the registered application name as part of the full operation path to provide further distinction.  The path segment 'p' followed by an arbitraryLabel &lt;name&gt; could, for example, support the differentiation of specific CAs or certificate profiles. Further path segments, e.g., as specified in the <span><a class="internal xref" href="#RFC9483">Lightweight CMP Profile</a> [<a class="cite xref" href="#RFC9483">RFC9483</a>]</span>, could indicate PKI management operations using an operationLabel &lt;operation&gt;.  A valid, full CMP URI can look like this:<a class="pilcrow" href="#section-3.3-5">¶</a></p>
<ul class="compact ulEmpty">
<li class="compact ulEmpty" id="section-3.3-6.1">http://www.example.com/.well-known/cmp<a class="pilcrow" href="#section-3.3-6.1">¶</a>
</li>
          <li class="compact ulEmpty" id="section-3.3-6.2">http://www.example.com/.well-known/cmp/&lt;operation&gt;<a class="pilcrow" href="#section-3.3-6.2">¶</a>
</li>
          <li class="compact ulEmpty" id="section-3.3-6.3">http://www.example.com/.well-known/cmp/p/&lt;name&gt;<a class="pilcrow" href="#section-3.3-6.3">¶</a>
</li>
          <li class="compact ulEmpty" id="section-3.3-6.4">http://www.example.com/.well-known/cmp/p/&lt;name&gt;/&lt;operation&gt;<a class="pilcrow" href="#section-3.3-6.4">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="IANA">
<section id="section-4">
      <h2 id="name-iana-considerations">
<a class="section-number selfRef" href="#section-4">4. </a><a class="section-name selfRef" href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<div id="IANA-ASN1">
<section id="section-4.1">
        <h3 id="name-updates-to-the-asn1-modules">
<a class="section-number selfRef" href="#section-4.1">4.1. </a><a class="section-name selfRef" href="#name-updates-to-the-asn1-modules">Updates to the ASN.1 Modules in RFCs 4210 and 5912</a>
        </h3>
<p id="section-4.1-1">This document updates the ASN.1 modules of <span><a class="relref" href="https://rfc-editor.org/rfc/rfc4210#appendix-F">Appendix F</a> of [<a class="cite xref" href="#RFC4210">RFC4210</a>]</span> and <span><a class="relref" href="https://rfc-editor.org/rfc/rfc5912#section-9">Section 9</a> of [<a class="cite xref" href="#RFC5912">RFC5912</a>]</span> as shown in Appendixes <a class="auto internal xref" href="#ASN.1_1988_Modules">A.1</a> and <a class="auto internal xref" href="#ASN.1_2002_Modules">A.2</a> of this document, respectively. The OIDs 99 (id-mod-cmp2021-88) and 100 (id-mod-cmp2021-02) have been registered in the "SMI Security for PKIX Module Identifier" registry to identify the updated ASN.1 modules.<a class="pilcrow" href="#section-4.1-1">¶</a></p>
</section>
</div>
<div id="IANA-4210">
<section id="section-4.2">
        <h3 id="name-updates-to-the-iana-conside">
<a class="section-number selfRef" href="#section-4.2">4.2. </a><a class="section-name selfRef" href="#name-updates-to-the-iana-conside">Updates to the IANA Considerations of RFC 4210</a>
        </h3>
<p id="section-4.2-1">This document updates the IANA Consideration sections of <span>[<a class="cite xref" href="#RFC4210">RFC4210</a>]</span> by adding this content.<a class="pilcrow" href="#section-4.2-1">¶</a></p>
<div id="IANA-EKU">
<section id="section-4.2.1">
          <h4 id="name-smi-security-for-pkix-exten">
<a class="section-number selfRef" href="#section-4.2.1">4.2.1. </a><a class="section-name selfRef" href="#name-smi-security-for-pkix-exten">SMI Security for PKIX Extended Key Purpose Registry</a>
          </h4>
<p id="section-4.2.1-1">IANA has registered the following new entry in the "SMI Security for PKIX Extended Key Purpose" registry (see <span>&lt;<a href="https://www.iana.org/assignments/smi-numbers">https://www.iana.org/assignments/smi-numbers</a>&gt;</span>, as defined in <span>[<a class="cite xref" href="#RFC7299">RFC7299</a>]</span>:<a class="pilcrow" href="#section-4.2.1-1">¶</a></p>
<span id="name-addition-to-the-smi-securit"></span><div id="IANA_new_EKU">
<table class="left" id="table-1">
            <caption>
<a class="selfRef" href="#table-1">Table 1</a>:
<a class="selfRef" href="#name-addition-to-the-smi-securit">Addition to the SMI Security for PKIX Extended Key Purpose</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" colspan="1" rowspan="1">Decimal</th>
                <th class="text-left" colspan="1" rowspan="1">Description</th>
                <th class="text-left" colspan="1" rowspan="1">References</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">32</td>
                <td class="text-left" colspan="1" rowspan="1">id-kp-cmKGA</td>
                <td class="text-left" colspan="1" rowspan="1">RFC 9480</td>
              </tr>
            </tbody>
          </table>
</div>
</section>
</div>
<div id="IANA-CMP-IT">
<section id="section-4.2.2">
          <h4 id="name-smi-security-for-pkix-cmp-i">
<a class="section-number selfRef" href="#section-4.2.2">4.2.2. </a><a class="section-name selfRef" href="#name-smi-security-for-pkix-cmp-i">SMI Security for PKIX CMP Information Types</a>
          </h4>
<p id="section-4.2.2-1">IANA has registered the following new entries in the "SMI Security for PKIX CMP Information Types" registry (see <span>&lt;<a href="https://www.iana.org/assignments/smi-numbers">https://www.iana.org/assignments/smi-numbers</a>&gt;</span>), as defined in <span>[<a class="cite xref" href="#RFC7299">RFC7299</a>]</span>:<a class="pilcrow" href="#section-4.2.2-1">¶</a></p>
<span id="name-additions-to-the-pkix-cmp-i"></span><div id="IANA_new_id-it">
<table class="left" id="table-2">
            <caption>
<a class="selfRef" href="#table-2">Table 2</a>:
<a class="selfRef" href="#name-additions-to-the-pkix-cmp-i">Additions to the PKIX CMP Information Types Registry</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" colspan="1" rowspan="1">Decimal</th>
                <th class="text-left" colspan="1" rowspan="1">Description</th>
                <th class="text-left" colspan="1" rowspan="1">References</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">17</td>
                <td class="text-left" colspan="1" rowspan="1">id-it-caCerts</td>
                <td class="text-left" colspan="1" rowspan="1">RFC 9480</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">18</td>
                <td class="text-left" colspan="1" rowspan="1">id-it-rootCaKeyUpdate</td>
                <td class="text-left" colspan="1" rowspan="1">RFC 9480</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">19</td>
                <td class="text-left" colspan="1" rowspan="1">id-it-certReqTemplate</td>
                <td class="text-left" colspan="1" rowspan="1">RFC 9480</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">20</td>
                <td class="text-left" colspan="1" rowspan="1">id-it-rootCaCert</td>
                <td class="text-left" colspan="1" rowspan="1">RFC 9480</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">21</td>
                <td class="text-left" colspan="1" rowspan="1">id-it-certProfile</td>
                <td class="text-left" colspan="1" rowspan="1">RFC 9480</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">22</td>
                <td class="text-left" colspan="1" rowspan="1">id-it-crlStatusList</td>
                <td class="text-left" colspan="1" rowspan="1">RFC 9480</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">23</td>
                <td class="text-left" colspan="1" rowspan="1">id-it-crls</td>
                <td class="text-left" colspan="1" rowspan="1">RFC 9480</td>
              </tr>
            </tbody>
          </table>
</div>
</section>
</div>
<div id="IANA-CRMF">
<section id="section-4.2.3">
          <h4 id="name-smi-security-for-pkix-crmf-">
<a class="section-number selfRef" href="#section-4.2.3">4.2.3. </a><a class="section-name selfRef" href="#name-smi-security-for-pkix-crmf-">SMI Security for PKIX CRMF Registration Controls</a>
          </h4>
<p id="section-4.2.3-1">IANA has registered the following new entries in the "SMI Security for PKIX CRMF Registration Controls" registry (see <span>&lt;<a href="https://www.iana.org/assignments/smi-numbers">https://www.iana.org/assignments/smi-numbers</a>&gt;</span>), as defined in <span>[<a class="cite xref" href="#RFC7299">RFC7299</a>]</span>:<a class="pilcrow" href="#section-4.2.3-1">¶</a></p>
<span id="name-addition-to-the-pkix-crmf-r"></span><div id="IANA_new_id-regCtrl">
<table class="left" id="table-3">
            <caption>
<a class="selfRef" href="#table-3">Table 3</a>:
<a class="selfRef" href="#name-addition-to-the-pkix-crmf-r">Addition to the PKIX CRMF Registration Controls Registry</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" colspan="1" rowspan="1">Decimal</th>
                <th class="text-left" colspan="1" rowspan="1">Description</th>
                <th class="text-left" colspan="1" rowspan="1">References</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">11</td>
                <td class="text-left" colspan="1" rowspan="1">id-regCtrl-algId</td>
                <td class="text-left" colspan="1" rowspan="1">RFC 9480</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">12</td>
                <td class="text-left" colspan="1" rowspan="1">id-regCtrl-rsaKeyLen</td>
                <td class="text-left" colspan="1" rowspan="1">RFC 9480</td>
              </tr>
            </tbody>
          </table>
</div>
</section>
</div>
</section>
</div>
<div id="IANA-6712">
<section id="section-4.3">
        <h3 id="name-updates-to-the-iana-consider">
<a class="section-number selfRef" href="#section-4.3">4.3. </a><a class="section-name selfRef" href="#name-updates-to-the-iana-consider">Updates to the IANA Considerations of RFC 6712</a>
        </h3>
<p id="section-4.3-1">This document contains an update to the IANA Considerations sections of <span>[<a class="cite xref" href="#RFC6712">RFC6712</a>]</span> by adding this content.<a class="pilcrow" href="#section-4.3-1">¶</a></p>
<div id="IANA-URI">
<section id="section-4.3.1">
          <h4 id="name-well-known-uris">
<a class="section-number selfRef" href="#section-4.3.1">4.3.1. </a><a class="section-name selfRef" href="#name-well-known-uris">Well-Known URIs</a>
          </h4>
<p id="section-4.3.1-1">IANA has registered the following new entry in the "Well-Known URIs" registry (see <span>&lt;<a href="https://www.iana.org/assignments/well-known-uris">https://www.iana.org/assignments/well-known-uris</a>&gt;</span>), as defined in <span>[<a class="cite xref" href="#RFC8615">RFC8615</a>]</span>:<a class="pilcrow" href="#section-4.3.1-1">¶</a></p>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-4.3.1-2">
            <dt id="section-4.3.1-2.1">URI Suffix:</dt>
            <dd id="section-4.3.1-2.2" style="margin-left: 1.5em">cmp<a class="pilcrow" href="#section-4.3.1-2.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.1-2.3">Change Controller:</dt>
            <dd id="section-4.3.1-2.4" style="margin-left: 1.5em">IETF<a class="pilcrow" href="#section-4.3.1-2.4">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.1-2.5">Reference:</dt>
            <dd id="section-4.3.1-2.6" style="margin-left: 1.5em">[RFC9480] <span>[<a class="cite xref" href="#RFC9482">RFC9482</a>]</span><a class="pilcrow" href="#section-4.3.1-2.6">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.1-2.7">Status:</dt>
            <dd id="section-4.3.1-2.8" style="margin-left: 1.5em">permanent<a class="pilcrow" href="#section-4.3.1-2.8">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.1-2.9">Related Information:</dt>
            <dd id="section-4.3.1-2.10" style="margin-left: 1.5em">CMP has a registry at <span>&lt;<a href="https://www.iana.org/assignments/cmp">https://www.iana.org/assignments/cmp</a>&gt;</span><a class="pilcrow" href="#section-4.3.1-2.10">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="IANA-URI-CMP">
<section id="section-4.3.2">
          <h4 id="name-certificate-management-prot">
<a class="section-number selfRef" href="#section-4.3.2">4.3.2. </a><a class="section-name selfRef" href="#name-certificate-management-prot">Certificate Management Protocol (CMP) Registry</a>
          </h4>
<p id="section-4.3.2-1">This document defines a new protocol registry group entitled "Certificate Management Protocol (CMP)" (at <span>&lt;<a href="https://www.iana.org/assignments/cmp">https://www.iana.org/assignments/cmp</a>&gt;</span>) with a new "CMP Well-Known URI Path Segments" registry containing three columns: Path Segment, Description, and Reference. New items can be added using the Specification Required <span>[<a class="cite xref" href="#RFC8615">RFC8615</a>]</span> process. The initial entry of this registry is:<a class="pilcrow" href="#section-4.3.2-1">¶</a></p>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-4.3.2-2">
            <dt id="section-4.3.2-2.1">Path Segment:</dt>
            <dd id="section-4.3.2-2.2" style="margin-left: 1.5em">p<a class="pilcrow" href="#section-4.3.2-2.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.2-2.3">Description:</dt>
            <dd id="section-4.3.2-2.4" style="margin-left: 1.5em">Indicates that the next path segment specifies, e.g., a CA or certificate profile name<a class="pilcrow" href="#section-4.3.2-2.4">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.2-2.5">Reference:</dt>
            <dd id="section-4.3.2-2.6" style="margin-left: 1.5em">[RFC9480] <span>[<a class="cite xref" href="#RFC9482">RFC9482</a>]</span><a class="pilcrow" href="#section-4.3.2-2.6">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="Security">
<section id="section-5">
      <h2 id="name-security-considerations">
<a class="section-number selfRef" href="#section-5">5. </a><a class="section-name selfRef" href="#name-security-considerations">Security Considerations</a>
      </h2>
<p id="section-5-1">The security considerations of <span>[<a class="cite xref" href="#RFC4210">RFC4210</a>]</span> are extended in <a class="auto internal xref" href="#CMP-8.4">Section 2.22</a> to <a class="auto internal xref" href="#CMP-8.6">Section 2.24</a>. No security considerations updates of <span>[<a class="cite xref" href="#RFC6712">RFC6712</a>]</span> were required.<a class="pilcrow" href="#section-5-1">¶</a></p>
</section>
</div>
<section id="section-6">
      <h2 id="name-references">
<a class="section-number selfRef" href="#section-6">6. </a><a class="section-name selfRef" href="#name-references">References</a>
      </h2>
<section id="section-6.1">
        <h3 id="name-normative-references">
<a class="section-number selfRef" href="#section-6.1">6.1. </a><a class="section-name selfRef" href="#name-normative-references">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time class="refDate" datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2510">[RFC2510]</dt>
        <dd>
<span class="refAuthor">Adams, C.</span> and <span class="refAuthor">S. Farrell</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate Management Protocols"</span>, <span class="seriesInfo">RFC 2510</span>, <span class="seriesInfo">DOI 10.17487/RFC2510</span>, <time class="refDate" datetime="1999-03">March 1999</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2510">https://www.rfc-editor.org/info/rfc2510</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2985">[RFC2985]</dt>
        <dd>
<span class="refAuthor">Nystrom, M.</span> and <span class="refAuthor">B. Kaliski</span>, <span class="refTitle">"PKCS #9: Selected Object Classes and Attribute Types Version 2.0"</span>, <span class="seriesInfo">RFC 2985</span>, <span class="seriesInfo">DOI 10.17487/RFC2985</span>, <time class="refDate" datetime="2000-11">November 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2985">https://www.rfc-editor.org/info/rfc2985</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2986">[RFC2986]</dt>
        <dd>
<span class="refAuthor">Nystrom, M.</span> and <span class="refAuthor">B. Kaliski</span>, <span class="refTitle">"PKCS #10: Certification Request Syntax Specification Version 1.7"</span>, <span class="seriesInfo">RFC 2986</span>, <span class="seriesInfo">DOI 10.17487/RFC2986</span>, <time class="refDate" datetime="2000-11">November 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2986">https://www.rfc-editor.org/info/rfc2986</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3629">[RFC3629]</dt>
        <dd>
<span class="refAuthor">Yergeau, F.</span>, <span class="refTitle">"UTF-8, a transformation format of ISO 10646"</span>, <span class="seriesInfo">STD 63</span>, <span class="seriesInfo">RFC 3629</span>, <span class="seriesInfo">DOI 10.17487/RFC3629</span>, <time class="refDate" datetime="2003-11">November 2003</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3629">https://www.rfc-editor.org/info/rfc3629</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4210">[RFC4210]</dt>
        <dd>
<span class="refAuthor">Adams, C.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Kause, T.</span>, and <span class="refAuthor">T. Mononen</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate Management Protocol (CMP)"</span>, <span class="seriesInfo">RFC 4210</span>, <span class="seriesInfo">DOI 10.17487/RFC4210</span>, <time class="refDate" datetime="2005-09">September 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4210">https://www.rfc-editor.org/info/rfc4210</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4211">[RFC4211]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate Request Message Format (CRMF)"</span>, <span class="seriesInfo">RFC 4211</span>, <span class="seriesInfo">DOI 10.17487/RFC4211</span>, <time class="refDate" datetime="2005-09">September 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4211">https://www.rfc-editor.org/info/rfc4211</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5280">[RFC5280]</dt>
        <dd>
<span class="refAuthor">Cooper, D.</span>, <span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Boeyen, S.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time class="refDate" datetime="2008-05">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5280">https://www.rfc-editor.org/info/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5480">[RFC5480]</dt>
        <dd>
<span class="refAuthor">Turner, S.</span>, <span class="refAuthor">Brown, D.</span>, <span class="refAuthor">Yiu, K.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">T. Polk</span>, <span class="refTitle">"Elliptic Curve Cryptography Subject Public Key Information"</span>, <span class="seriesInfo">RFC 5480</span>, <span class="seriesInfo">DOI 10.17487/RFC5480</span>, <time class="refDate" datetime="2009-03">March 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5480">https://www.rfc-editor.org/info/rfc5480</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5652">[RFC5652]</dt>
        <dd>
<span class="refAuthor">Housley, R.</span>, <span class="refTitle">"Cryptographic Message Syntax (CMS)"</span>, <span class="seriesInfo">STD 70</span>, <span class="seriesInfo">RFC 5652</span>, <span class="seriesInfo">DOI 10.17487/RFC5652</span>, <time class="refDate" datetime="2009-09">September 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5652">https://www.rfc-editor.org/info/rfc5652</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5958">[RFC5958]</dt>
        <dd>
<span class="refAuthor">Turner, S.</span>, <span class="refTitle">"Asymmetric Key Packages"</span>, <span class="seriesInfo">RFC 5958</span>, <span class="seriesInfo">DOI 10.17487/RFC5958</span>, <time class="refDate" datetime="2010-08">August 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5958">https://www.rfc-editor.org/info/rfc5958</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6402">[RFC6402]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"Certificate Management over CMS (CMC) Updates"</span>, <span class="seriesInfo">RFC 6402</span>, <span class="seriesInfo">DOI 10.17487/RFC6402</span>, <time class="refDate" datetime="2011-11">November 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6402">https://www.rfc-editor.org/info/rfc6402</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6712">[RFC6712]</dt>
        <dd>
<span class="refAuthor">Kause, T.</span> and <span class="refAuthor">M. Peylo</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure -- HTTP Transfer for the Certificate Management Protocol (CMP)"</span>, <span class="seriesInfo">RFC 6712</span>, <span class="seriesInfo">DOI 10.17487/RFC6712</span>, <time class="refDate" datetime="2012-09">September 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6712">https://www.rfc-editor.org/info/rfc6712</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time class="refDate" datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8615">[RFC8615]</dt>
        <dd>
<span class="refAuthor">Nottingham, M.</span>, <span class="refTitle">"Well-Known Uniform Resource Identifiers (URIs)"</span>, <span class="seriesInfo">RFC 8615</span>, <span class="seriesInfo">DOI 10.17487/RFC8615</span>, <time class="refDate" datetime="2019-05">May 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8615">https://www.rfc-editor.org/info/rfc8615</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8933">[RFC8933]</dt>
        <dd>
<span class="refAuthor">Housley, R.</span>, <span class="refTitle">"Update to the Cryptographic Message Syntax (CMS) for Algorithm Identifier Protection"</span>, <span class="seriesInfo">RFC 8933</span>, <span class="seriesInfo">DOI 10.17487/RFC8933</span>, <time class="refDate" datetime="2020-10">October 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8933">https://www.rfc-editor.org/info/rfc8933</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9045">[RFC9045]</dt>
        <dd>
<span class="refAuthor">Housley, R.</span>, <span class="refTitle">"Algorithm Requirements Update to the Internet X.509 Public Key Infrastructure Certificate Request Message Format (CRMF)"</span>, <span class="seriesInfo">RFC 9045</span>, <span class="seriesInfo">DOI 10.17487/RFC9045</span>, <time class="refDate" datetime="2021-06">June 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9045">https://www.rfc-editor.org/info/rfc9045</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9481">[RFC9481]</dt>
        <dd>
<span class="refAuthor">Brockhaus, H.</span>, <span class="refAuthor">Aschauer, H.</span>, <span class="refAuthor">Ounsworth, M.</span>, and <span class="refAuthor">J. Gray</span>, <span class="refTitle">"Certificate Management Protocol (CMP) Algorithms"</span>, <span class="seriesInfo">RFC 9481</span>, <span class="seriesInfo">DOI 10.17487/RFC9481</span>, <time class="refDate" datetime="2023-11">November 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9481">https://www.rfc-editor.org/info/rfc9481</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9482">[RFC9482]</dt>
      <dd>
<span class="refAuthor">Sahni, M., Ed.</span> and <span class="refAuthor">S. Tripathi, Ed.</span>, <span class="refTitle">"Constrained Application Protocol (CoAP) Transfer for the Certificate Management Protocol"</span>, <span class="seriesInfo">RFC 9482</span>, <span class="seriesInfo">DOI 10.17487/RFC9482</span>, <time class="refDate" datetime="2023-11">November 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9482">https://www.rfc-editor.org/info/rfc9482</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-6.2">
        <h3 id="name-informative-references">
<a class="section-number selfRef" href="#section-6.2">6.2. </a><a class="section-name selfRef" href="#name-informative-references">Informative References</a>
        </h3>
<dl class="references">
<dt id="AIS31">[AIS31]</dt>
        <dd>
<span class="refAuthor">Killmann, W.</span> and <span class="refAuthor">W. Schindler</span>, <span class="refTitle">"A proposal for: Functionality classes for random number generators - Version 2.0"</span>, <time class="refDate" datetime="2011-09">September 2011</time>, <span>&lt;<a href="https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Zertifizierung/Interpretationen/AIS_31_Functionality_classes_for_random_number_generators_e.pdf">https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Zertifizierung/Interpretationen/AIS_31_Functionality_classes_for_random_number_generators_e.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="CVE-2008-0166">[CVE-2008-0166]</dt>
        <dd>
<span class="refAuthor">National Institute of Science and Technology (NIST)</span>, <span class="refTitle">"National Vulnerability Database - CVE-2008-0166"</span>, <time class="refDate" datetime="2008-05">May 2008</time>, <span>&lt;<a href="https://nvd.nist.gov/vuln/detail/CVE-2008-0166">https://nvd.nist.gov/vuln/detail/CVE-2008-0166</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-lamps-rfc6712bis">[HTTP-CMP]</dt>
        <dd>
<span class="refAuthor">Brockhaus, H.</span>, <span class="refAuthor">von Oheimb, D.</span>, <span class="refAuthor">Ounsworth, M.</span>, and <span class="refAuthor">J. Gray</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure -- HTTP Transfer for the Certificate Management Protocol (CMP)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-lamps-rfc6712bis-03</span>, <time class="refDate" datetime="2023-02-10">10 February 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-lamps-rfc6712bis-03">https://datatracker.ietf.org/doc/html/draft-ietf-lamps-rfc6712bis-03</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ISO.20543-2019">[ISO.20543-2019]</dt>
        <dd>
<span class="refAuthor">International Organization for Standardization (ISO)</span>, <span class="refTitle">"Information technology -- Security techniques -- Test and analysis methods for random bit generators within ISO/IEC 19790 and ISO/IEC 15408"</span>, <span class="seriesInfo">ISO/IEC 20543:2019</span>, <time class="refDate" datetime="2019-10">October 2019</time>. </dd>
<dd class="break"></dd>
<dt id="MiningPsQs">[MiningPsQs]</dt>
        <dd>
<span class="refAuthor">Heninger, N.</span>, <span class="refAuthor">Durumeric, Z.</span>, <span class="refAuthor">Wustrow, E.</span>, and <span class="refAuthor">J. A. Halderman</span>, <span class="refTitle">"Mining Your Ps and Qs: Detection of Widespread Weak Keys in Network Devices"</span>, <span class="refContent">Security'12: Proceedings of the 21st USENIX conference on Security symposium</span>, <time class="refDate" datetime="2012-08">August 2012</time>, <span>&lt;<a href="https://www.usenix.org/conference/usenixsecurity12/technical-sessions/presentation/heninger">https://www.usenix.org/conference/usenixsecurity12/technical-sessions/presentation/heninger</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="NIST_SP_800_90Ar1">[NIST_SP_800_90Ar1]</dt>
        <dd>
<span class="refAuthor">Barker, E. B.</span>, <span class="refAuthor">Kelsey, J. M.</span>, and <span class="refAuthor">NIST</span>, <span class="refTitle">"Recommendation for Random Number Generation Using Deterministic Random Bit Generators"</span>, <span class="seriesInfo">NIST Special Publications (General) 800-90Ar1</span>, <span class="seriesInfo">DOI 10.6028/NIST.SP.800-90Ar1</span>, <time class="refDate" datetime="2015-06">June 2015</time>, <span>&lt;<a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-90Ar1.pdf">https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-90Ar1.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-lamps-rfc4210bis">[PKIX-CMP]</dt>
        <dd>
<span class="refAuthor">Brockhaus, H.</span>, <span class="refAuthor">von Oheimb, D.</span>, <span class="refAuthor">Ounsworth, M.</span>, and <span class="refAuthor">J. Gray</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure -- Certificate Management Protocol (CMP)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-lamps-rfc4210bis-07</span>, <time class="refDate" datetime="2023-06-19">19 June 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-lamps-rfc4210bis-07">https://datatracker.ietf.org/doc/html/draft-ietf-lamps-rfc4210bis-07</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2104">[RFC2104]</dt>
        <dd>
<span class="refAuthor">Krawczyk, H.</span>, <span class="refAuthor">Bellare, M.</span>, and <span class="refAuthor">R. Canetti</span>, <span class="refTitle">"HMAC: Keyed-Hashing for Message Authentication"</span>, <span class="seriesInfo">RFC 2104</span>, <span class="seriesInfo">DOI 10.17487/RFC2104</span>, <time class="refDate" datetime="1997-02">February 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2104">https://www.rfc-editor.org/info/rfc2104</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2202">[RFC2202]</dt>
        <dd>
<span class="refAuthor">Cheng, P.</span> and <span class="refAuthor">R. Glenn</span>, <span class="refTitle">"Test Cases for HMAC-MD5 and HMAC-SHA-1"</span>, <span class="seriesInfo">RFC 2202</span>, <span class="seriesInfo">DOI 10.17487/RFC2202</span>, <time class="refDate" datetime="1997-09">September 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2202">https://www.rfc-editor.org/info/rfc2202</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5912">[RFC5912]</dt>
        <dd>
<span class="refAuthor">Hoffman, P.</span> and <span class="refAuthor">J. Schaad</span>, <span class="refTitle">"New ASN.1 Modules for the Public Key Infrastructure Using X.509 (PKIX)"</span>, <span class="seriesInfo">RFC 5912</span>, <span class="seriesInfo">DOI 10.17487/RFC5912</span>, <time class="refDate" datetime="2010-06">June 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5912">https://www.rfc-editor.org/info/rfc5912</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7299">[RFC7299]</dt>
        <dd>
<span class="refAuthor">Housley, R.</span>, <span class="refTitle">"Object Identifier Registry for the PKIX Working Group"</span>, <span class="seriesInfo">RFC 7299</span>, <span class="seriesInfo">DOI 10.17487/RFC7299</span>, <time class="refDate" datetime="2014-07">July 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7299">https://www.rfc-editor.org/info/rfc7299</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9483">[RFC9483]</dt>
      <dd>
<span class="refAuthor">Brockhaus, H.</span>, <span class="refAuthor">von Oheimb, D.</span>, and <span class="refAuthor">S. Fries</span>, <span class="refTitle">"Lightweight Certificate Management Protocol (CMP) Profile"</span>, <span class="seriesInfo">RFC 9483</span>, <span class="seriesInfo">DOI 10.17487/RFC9483</span>, <time class="refDate" datetime="2023-11">November 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9483">https://www.rfc-editor.org/info/rfc9483</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="ASN.1_Modules">
<section id="appendix-A">
      <h2 id="name-asn1-modules">
<a class="section-number selfRef" href="#appendix-A">Appendix A. </a><a class="section-name selfRef" href="#name-asn1-modules">ASN.1 Modules</a>
      </h2>
<div id="ASN.1_1988_Modules">
<section id="appendix-A.1">
        <h3 id="name-update-to-rfc-4210-1988-asn">
<a class="section-number selfRef" href="#appendix-A.1">A.1. </a><a class="section-name selfRef" href="#name-update-to-rfc-4210-1988-asn">Update to RFC 4210 - 1988 ASN.1 Module</a>
        </h3>
<p id="appendix-A.1-1">This section contains the updated ASN.1 module for <span>[<a class="cite xref" href="#RFC4210">RFC4210</a>]</span>.  This module replaces the module in Appendix <a class="relref" href="https://rfc-editor.org/rfc/rfc4210#appendix-F">F</a> of that document.  Although a 2002 ASN.1 module is provided, this 1988 ASN.1 module remains the normative module, as per the policy of the PKIX Working Group.<a class="pilcrow" href="#appendix-A.1-1">¶</a></p>
<div class="breakable lang-asn.1 sourcecode" id="appendix-A.1-2">
<pre>PKIXCMP {iso(1) identified-organization(3)
      dod(6) internet(1) security(5) mechanisms(5) pkix(7)
      id-mod(0) id-mod-cmp2021-88(99)}

DEFINITIONS EXPLICIT TAGS ::=

BEGIN

-- EXPORTS ALL --

IMPORTS

    Certificate, CertificateList, Extensions, Name, Time,
    AlgorithmIdentifier, id-kp
    --, UTF8String -- -- if required; otherwise, comment out
           FROM PKIX1Explicit88 {iso(1) identified-organization(3)
           dod(6) internet(1) security(5) mechanisms(5) pkix(7)
           id-mod(0) id-pkix1-explicit-88(18)}
    -- The import of Name is added to define CertificationRequest
    -- instead of importing it from PKCS #10 [RFC2986].

    DistributionPointName, GeneralNames, GeneralName, KeyIdentifier
           FROM PKIX1Implicit88 {iso(1) identified-organization(3)
           dod(6) internet(1) security(5) mechanisms(5) pkix(7)
           id-mod(0) id-pkix1-implicit-88(19)}

    CertTemplate, PKIPublicationInfo, EncryptedKey, CertId,
    CertReqMessages, Controls, AttributeTypeAndValue, id-regCtrl
           FROM PKIXCRMF-2005 {iso(1) identified-organization(3)
           dod(6) internet(1) security(5) mechanisms(5) pkix(7)
           id-mod(0) id-mod-crmf2005(36)}
    -- The import of EncryptedKey is added due to the updates made
    -- in CMP Updates [RFC9480]. EncryptedValue does not need to
    -- be imported anymore and is therefore removed here.

    -- Also, see the behavioral clarifications to CRMF codified in
    -- Appendix C of this specification.

    EnvelopedData, SignedData, Attribute
           FROM CryptographicMessageSyntax2004 { iso(1)
           member-body(2) us(840) rsadsi(113549) pkcs(1) pkcs-9(9)
           smime(16) modules(0) cms-2004(24) }
    -- The import of EnvelopedData and SignedData is added due to
    -- the updates made in CMP Updates [RFC9480].
    -- The import of Attribute is added to define
    -- CertificationRequest instead of importing it from
    -- PKCS #10 [RFC2986].

    ;

-- The rest of the module contains locally defined OIDs and
-- constructs:

CMPCertificate ::= CHOICE {
    x509v3PKCert        Certificate
}
-- This syntax, while bits-on-the-wire compatible with the
-- standard X.509 definition of "Certificate", allows the
-- possibility of future certificate types (such as X.509
-- attribute certificates, card-verifiable
-- certificates, or other kinds of certificates) within this
-- Certificate Management Protocol, should a need ever arise to
-- support such generality.  Those implementations that do not
-- foresee a need to ever support other certificate types MAY, if
-- they wish, comment out the above structure and "uncomment" the
-- following one prior to compiling this ASN.1 module.  (Note that
-- interoperability with implementations that don't do this will be
-- unaffected by this change.)

-- CMPCertificate ::= Certificate

PKIMessage ::= SEQUENCE {
    header           PKIHeader,
    body             PKIBody,
    protection   [0] PKIProtection OPTIONAL,
    extraCerts   [1] SEQUENCE SIZE (1..MAX) OF CMPCertificate
                     OPTIONAL
}

PKIMessages ::= SEQUENCE SIZE (1..MAX) OF PKIMessage

PKIHeader ::= SEQUENCE {
    pvno                INTEGER     { cmp1999(1), cmp2000(2),
                                      cmp2021(3) },
    sender              GeneralName,
    -- identifies the sender
    recipient           GeneralName,
    -- identifies the intended recipient
    messageTime     [0] GeneralizedTime         OPTIONAL,
    -- time of production of this message (used when the sender
    -- believes that the transport will be "suitable", i.e.,
    -- that the time will still be meaningful upon receipt)
    protectionAlg   [1] AlgorithmIdentifier     OPTIONAL,
    -- algorithm used for the calculation of protection bits
    senderKID       [2] KeyIdentifier           OPTIONAL,
    recipKID        [3] KeyIdentifier           OPTIONAL,
    -- to identify specific keys used for protection
    transactionID   [4] OCTET STRING            OPTIONAL,
    -- identifies the transaction, i.e., this will be the same in
    -- corresponding request, response, certConf, and PKIConf
    -- messages
    senderNonce     [5] OCTET STRING            OPTIONAL,
    recipNonce      [6] OCTET STRING            OPTIONAL,
    -- nonces used to provide replay protection, senderNonce
    -- is inserted by the creator of this message; recipNonce
    -- is a nonce previously inserted in a related message by
    -- the intended recipient of this message.
    freeText        [7] PKIFreeText             OPTIONAL,
    -- this may be used to indicate context-specific instructions
    -- (this field is intended for human consumption)
    generalInfo     [8] SEQUENCE SIZE (1..MAX) OF
                           InfoTypeAndValue     OPTIONAL
    -- this may be used to convey context-specific information
    -- (this field not primarily intended for human consumption)
}

PKIFreeText ::= SEQUENCE SIZE (1..MAX) OF UTF8String
    -- text encoded as a UTF-8 string [RFC3629]

PKIBody ::= CHOICE {       -- message-specific body elements
    ir       [0]  CertReqMessages,        --Initialization Request
    ip       [1]  CertRepMessage,         --Initialization Response
    cr       [2]  CertReqMessages,        --Certification Request
    cp       [3]  CertRepMessage,         --Certification Response
    p10cr    [4]  CertificationRequest,   --imported from [RFC2986]
    popdecc  [5]  POPODecKeyChallContent, --pop Challenge
    popdecr  [6]  POPODecKeyRespContent,  --pop Response
    kur      [7]  CertReqMessages,        --Key Update Request
    kup      [8]  CertRepMessage,         --Key Update Response
    krr      [9]  CertReqMessages,        --Key Recovery Request
    krp      [10] KeyRecRepContent,       --Key Recovery Response
    rr       [11] RevReqContent,          --Revocation Request
    rp       [12] RevRepContent,          --Revocation Response
    ccr      [13] CertReqMessages,        --Cross-Cert. Request
    ccp      [14] CertRepMessage,         --Cross-Cert. Response
    ckuann   [15] CAKeyUpdAnnContent,     --CA Key Update Ann.
    cann     [16] CertAnnContent,         --Certificate Ann.
    rann     [17] RevAnnContent,          --Revocation Ann.
    crlann   [18] CRLAnnContent,          --CRL Announcement
    pkiconf  [19] PKIConfirmContent,      --Confirmation
    nested   [20] NestedMessageContent,   --Nested Message
    genm     [21] GenMsgContent,          --General Message
    genp     [22] GenRepContent,          --General Response
    error    [23] ErrorMsgContent,        --Error Message
    certConf [24] CertConfirmContent,     --Certificate Confirm
    pollReq  [25] PollReqContent,         --Polling Request
    pollRep  [26] PollRepContent          --Polling Response
}

PKIProtection ::= BIT STRING

ProtectedPart ::= SEQUENCE {
    header    PKIHeader,
    body      PKIBody
}

id-PasswordBasedMac OBJECT IDENTIFIER ::= {1 2 840 113533 7 66 13}
PBMParameter ::= SEQUENCE {
    salt                OCTET STRING,
    -- Note: Implementations MAY wish to limit acceptable sizes
    -- of this string to values appropriate for their environment
    -- in order to reduce the risk of denial-of-service attacks.
    owf                 AlgorithmIdentifier,
    -- AlgId for a One-Way Function (OWF)
    iterationCount      INTEGER,
    -- number of times the OWF is applied
    -- Note: Implementations MAY wish to limit acceptable sizes
    -- of this integer to values appropriate for their environment
    -- in order to reduce the risk of denial-of-service attacks.
    mac                 AlgorithmIdentifier
    -- the MAC AlgId (e.g., HMAC-SHA256, AES-GMAC [RFC9481],
}   -- or HMAC [RFC2104, RFC2202])



id-DHBasedMac OBJECT IDENTIFIER ::= {1 2 840 113533 7 66 30}
DHBMParameter ::= SEQUENCE {
    owf                 AlgorithmIdentifier,
    -- AlgId for a One-Way Function
    mac                 AlgorithmIdentifier
    -- the MAC AlgId (e.g., HMAC-SHA256, AES-GMAC [RFC9481],
}   -- or HMAC [RFC2104, RFC2202])


NestedMessageContent ::= PKIMessages

PKIStatus ::= INTEGER {
    accepted               (0),
    -- you got exactly what you asked for
    grantedWithMods        (1),
    -- you got something like what you asked for; the
    -- requester is responsible for ascertaining the differences
    rejection              (2),
    -- you don't get it, more information elsewhere in the message
    waiting                (3),
    -- the request body part has not yet been processed; expect to
    -- hear more later (note: proper handling of this status
    -- response MAY use the polling req/rep PKIMessages specified
    -- in Section 5.3.22 of [RFC4210]; alternatively, polling in the
    -- underlying transport layer MAY have some utility in this
    -- regard)
    revocationWarning      (4),
    -- this message contains a warning that a revocation is
    -- imminent
    revocationNotification (5),
    -- notification that a revocation has occurred
    keyUpdateWarning       (6)
    -- update already done for the oldCertId specified in
    -- CertReqMsg
}

PKIFailureInfo ::= BIT STRING {
-- since we can fail in more than one way!
-- More codes may be added in the future if/when required.
    badAlg              (0),
    -- unrecognized or unsupported algorithm identifier
    badMessageCheck     (1),
    -- integrity check failed (e.g., signature did not verify)
    badRequest          (2),
    -- transaction not permitted or supported
    badTime             (3),
    -- messageTime was not sufficiently close to the system time,
    -- as defined by local policy
    badCertId           (4),
    -- no certificate could be found matching the provided criteria
    badDataFormat       (5),
    -- the data submitted has the wrong format
    wrongAuthority      (6),
    -- the authority indicated in the request is different from the
    -- one creating the response token
    incorrectData       (7),
    -- the requester's data is incorrect (for notary services)
    missingTimeStamp    (8),
    -- when the timestamp is missing but should be there
    -- (by policy)
    badPOP              (9),
    -- the proof-of-possession failed
    certRevoked         (10),
    -- the certificate has already been revoked
    certConfirmed       (11),
    -- the certificate has already been confirmed
    wrongIntegrity      (12),
    -- not valid integrity, based on the password instead of the
    -- signature or vice versa
    badRecipientNonce   (13),
    -- not valid recipient nonce, either missing or wrong value
    timeNotAvailable    (14),
    -- the time source of the Time Stamping Authority (TSA) is
    -- not available
    unacceptedPolicy    (15),
    -- the requested TSA policy is not supported by the TSA
    unacceptedExtension (16),
    -- the requested extension is not supported by the TSA
    addInfoNotAvailable (17),
    -- the additional information requested could not be
    -- understood or is not available
    badSenderNonce      (18),
    -- not valid sender nonce, either missing or wrong size
    badCertTemplate     (19),
    -- not valid cert. template or missing mandatory information
    signerNotTrusted    (20),
    -- signer of the message unknown or not trusted
    transactionIdInUse  (21),
    -- the transaction identifier is already in use
    unsupportedVersion  (22),
    -- the version of the message is not supported
    notAuthorized       (23),
    -- the sender was not authorized to make the preceding
    -- request or perform the preceding action
    systemUnavail       (24),
    -- the request cannot be handled due to system unavailability
    systemFailure       (25),
    -- the request cannot be handled due to system failure
    duplicateCertReq    (26)
    -- the certificate cannot be issued because a duplicate
    -- certificate already exists
}

PKIStatusInfo ::= SEQUENCE {
    status        PKIStatus,
    statusString  PKIFreeText     OPTIONAL,
    failInfo      PKIFailureInfo  OPTIONAL
}

OOBCert ::= CMPCertificate

OOBCertHash ::= SEQUENCE {
    hashAlg     [0] AlgorithmIdentifier     OPTIONAL,
    certId      [1] CertId                  OPTIONAL,
    hashVal         BIT STRING
    -- hashVal is calculated over the DER encoding of the
    -- self-signed certificate with the identifier certID.
}

POPODecKeyChallContent ::= SEQUENCE OF Challenge
-- one Challenge per encryption key certification request (in the
-- same order as these requests appear in CertReqMessages)

Challenge ::= SEQUENCE {
    owf                 AlgorithmIdentifier  OPTIONAL,
    -- MUST be present in the first Challenge; MAY be omitted in
    -- any subsequent Challenge in POPODecKeyChallContent (if
    -- omitted, then the owf used in the immediately preceding
    -- Challenge is to be used)
    witness             OCTET STRING,
    -- the result of applying the One-Way Function (owf) to a
    -- randomly generated INTEGER, A (Note that a different
    -- INTEGER MUST be used for each Challenge.)
    challenge           OCTET STRING
    -- the encryption (under the public key for which the cert.
    -- request is being made) of Rand
}

-- Rand was added in CMP Updates [RFC9480]

Rand ::= SEQUENCE {
-- Rand is encrypted under the public key to form the challenge
-- in POPODecKeyChallContent
   int                  INTEGER,
   -- the randomly generated INTEGER A (above)
   sender               GeneralName
   -- the sender's name (as included in PKIHeader)
}

POPODecKeyRespContent ::= SEQUENCE OF INTEGER
-- One INTEGER per encryption key certification request (in the
-- same order as these requests appear in CertReqMessages).  The
-- retrieved INTEGER A (above) is returned to the sender of the
-- corresponding Challenge.

CertRepMessage ::= SEQUENCE {
    caPubs       [1] SEQUENCE SIZE (1..MAX) OF CMPCertificate
                     OPTIONAL,
    response         SEQUENCE OF CertResponse
}

CertificationRequest ::= SEQUENCE {
    certificationRequestInfo  SEQUENCE {
      version                   INTEGER,
      subject                   Name,
      subjectPublicKeyInfo      SEQUENCE {
        algorithm                 AlgorithmIdentifier,
        subjectPublicKey          BIT STRING },
      attributes                [0] IMPLICIT SET OF Attribute },
    signatureAlgorithm        AlgorithmIdentifier,
    signature                 BIT STRING
}

CertResponse ::= SEQUENCE {
    certReqId           INTEGER,
    -- to match this response with the corresponding request (a value
    -- of -1 is to be used if certReqId is not specified in the
    -- corresponding request, which can only be a p10cr)
    status              PKIStatusInfo,
    certifiedKeyPair    CertifiedKeyPair    OPTIONAL,
    rspInfo             OCTET STRING        OPTIONAL
    -- analogous to the id-regInfo-utf8Pairs string defined
    -- for regInfo in CertReqMsg [RFC4211]
}

CertifiedKeyPair ::= SEQUENCE {
    certOrEncCert       CertOrEncCert,
    privateKey      [0] EncryptedKey        OPTIONAL,
    -- See [RFC4211] for comments on encoding.
    -- Changed from Encrypted Value to EncryptedKey as a CHOICE of
    -- EncryptedValue and EnvelopedData due to the changes made in
    -- CMP Updates [RFC9480].
    -- Using the choice EncryptedValue is bit-compatible to the
    -- syntax without this change.
    publicationInfo [1] PKIPublicationInfo  OPTIONAL
}

CertOrEncCert ::= CHOICE {
    certificate     [0] CMPCertificate,
    encryptedCert   [1] EncryptedKey
    -- Changed from Encrypted Value to EncryptedKey as a CHOICE of
    -- EncryptedValue and EnvelopedData due to the changes made in
    -- CMP Updates [RFC9480].
    -- Using the choice EncryptedValue is bit-compatible to the
    -- syntax without this change.
}

KeyRecRepContent ::= SEQUENCE {
    status                  PKIStatusInfo,
    newSigCert          [0] CMPCertificate OPTIONAL,
    caCerts             [1] SEQUENCE SIZE (1..MAX) OF
                                        CMPCertificate OPTIONAL,
    keyPairHist         [2] SEQUENCE SIZE (1..MAX) OF
                                        CertifiedKeyPair OPTIONAL
}

RevReqContent ::= SEQUENCE OF RevDetails

RevDetails ::= SEQUENCE {
    certDetails         CertTemplate,
    -- allows the requester to specify as much as they can about
    -- the cert. for which revocation is requested
    -- (e.g., for cases in which serialNumber is not available)
    crlEntryDetails     Extensions       OPTIONAL
    -- requested crlEntryExtensions
}

RevRepContent ::= SEQUENCE {
    status       SEQUENCE SIZE (1..MAX) OF PKIStatusInfo,
    -- in the same order as was sent in RevReqContent
    revCerts [0] SEQUENCE SIZE (1..MAX) OF CertId
                                        OPTIONAL,
    -- IDs for which revocation was requested
    -- (same order as status)
    crls     [1] SEQUENCE SIZE (1..MAX) OF CertificateList
                                        OPTIONAL
    -- the resulting CRLs (there may be more than one)
}

CAKeyUpdAnnContent ::= SEQUENCE {
    oldWithNew   CMPCertificate, -- old pub signed with new priv
    newWithOld   CMPCertificate, -- new pub signed with old priv
    newWithNew   CMPCertificate  -- new pub signed with new priv
}

CertAnnContent ::= CMPCertificate

RevAnnContent ::= SEQUENCE {
    status              PKIStatus,
    certId              CertId,
    willBeRevokedAt     GeneralizedTime,
    badSinceDate        GeneralizedTime,
    crlDetails          Extensions  OPTIONAL
    -- extra CRL details (e.g., crl number, reason, location, etc.)
}

CRLAnnContent ::= SEQUENCE OF CertificateList

CertConfirmContent ::= SEQUENCE OF CertStatus

CertStatus ::= SEQUENCE {
   certHash    OCTET STRING,
   -- the hash of the certificate, using the same hash algorithm
   -- as is used to create and verify the certificate signature
   certReqId   INTEGER,
   -- to match this confirmation with the corresponding req/rep
   statusInfo  PKIStatusInfo OPTIONAL,
   hashAlg [0] AlgorithmIdentifier OPTIONAL
   -- the hash algorithm to use for calculating certHash
   -- SHOULD NOT be used in all cases where the AlgorithmIdentifier
   -- of the certificate signature specifies a hash algorithm
}

PKIConfirmContent ::= NULL

-- CertReqTemplateContent, id-regCtrl-algId, id-regCtrl-algId, and
-- id-regCtrl-rsaKeyLen were added in CMP Updates [RFC9480]

CertReqTemplateContent ::= SEQUENCE {
   certTemplate           CertTemplate,
   -- prefilled certTemplate structure elements
   -- The SubjectPublicKeyInfo field in the certTemplate MUST NOT
   -- be used.
   keySpec                Controls OPTIONAL
   -- MAY be used to specify supported algorithms
   -- Controls  ::= SEQUENCE SIZE (1..MAX) OF AttributeTypeAndValue
   -- as specified in CRMF [RFC4211]
   }

id-regCtrl-altCertTemplate OBJECT IDENTIFIER ::= { id-regCtrl 7 }
   AltCertTemplate ::= AttributeTypeAndValue
   -- specifies a template for a certificate other than an X.509v3
   -- public key certificate

id-regCtrl-algId OBJECT IDENTIFIER ::= { id-regCtrl 11 }
   AlgIdCtrl ::= AlgorithmIdentifier
   -- SHALL be used to specify supported algorithms other than RSA

id-regCtrl-rsaKeyLen OBJECT IDENTIFIER ::= { id-regCtrl 12 }
   RsaKeyLenCtrl ::= INTEGER (1..MAX)
   -- SHALL be used to specify supported RSA key lengths

-- RootCaKeyUpdateContent, CRLSource, and CRLStatus were added in
-- CMP Updates [RFC9480]

RootCaKeyUpdateContent ::= SEQUENCE {
   newWithNew       CMPCertificate,
   -- new root CA certificate
   newWithOld   [0] CMPCertificate OPTIONAL,
   -- X.509 certificate containing the new public root CA key
   -- signed with the old private root CA key
   oldWithNew   [1] CMPCertificate OPTIONAL
   -- X.509 certificate containing the old public root CA key
   -- signed with the new private root CA key
   }

CRLSource ::= CHOICE {
   dpn          [0] DistributionPointName,
   issuer       [1] GeneralNames }

CRLStatus ::= SEQUENCE {
   source       CRLSource,
   thisUpdate   Time OPTIONAL }

InfoTypeAndValue ::= SEQUENCE {
    infoType               OBJECT IDENTIFIER,
    infoValue              ANY DEFINED BY infoType  OPTIONAL
}
-- Example InfoTypeAndValue contents include, but are not limited
-- to, the following (uncomment in this ASN.1 module and use as
-- appropriate for a given environment):
--
--   id-it-caProtEncCert    OBJECT IDENTIFIER ::= {id-it 1}
--      CAProtEncCertValue      ::= CMPCertificate
--   id-it-signKeyPairTypes OBJECT IDENTIFIER ::= {id-it 2}
--      SignKeyPairTypesValue   ::= SEQUENCE SIZE (1..MAX) OF
--                                        AlgorithmIdentifier
--   id-it-encKeyPairTypes  OBJECT IDENTIFIER ::= {id-it 3}
--      EncKeyPairTypesValue    ::= SEQUENCE SIZE (1..MAX) OF
--                                        AlgorithmIdentifier
--   id-it-preferredSymmAlg OBJECT IDENTIFIER ::= {id-it 4}
--      PreferredSymmAlgValue   ::= AlgorithmIdentifier
--   id-it-caKeyUpdateInfo  OBJECT IDENTIFIER ::= {id-it 5}
--      CAKeyUpdateInfoValue    ::= CAKeyUpdAnnContent
--   id-it-currentCRL       OBJECT IDENTIFIER ::= {id-it 6}
--      CurrentCRLValue         ::= CertificateList
--   id-it-unsupportedOIDs  OBJECT IDENTIFIER ::= {id-it 7}
--      UnsupportedOIDsValue    ::= SEQUENCE SIZE (1..MAX) OF
--                                          OBJECT IDENTIFIER
--   id-it-keyPairParamReq  OBJECT IDENTIFIER ::= {id-it 10}
--      KeyPairParamReqValue    ::= OBJECT IDENTIFIER
--   id-it-keyPairParamRep  OBJECT IDENTIFIER ::= {id-it 11}
--      KeyPairParamRepValue    ::= AlgorithmIdentifier
--   id-it-revPassphrase    OBJECT IDENTIFIER ::= {id-it 12}
--      RevPassphraseValue      ::= EncryptedKey
--      - Changed from Encrypted Value to EncryptedKey as a CHOICE
--      - of EncryptedValue and EnvelopedData due to the changes
--      - made in CMP Updates [RFC9480].
--      - Using the choice EncryptedValue is bit-compatible to the
--      - syntax without this change.
--   id-it-implicitConfirm  OBJECT IDENTIFIER ::= {id-it 13}
--      ImplicitConfirmValue    ::= NULL
--   id-it-confirmWaitTime  OBJECT IDENTIFIER ::= {id-it 14}
--      ConfirmWaitTimeValue    ::= GeneralizedTime
--   id-it-origPKIMessage   OBJECT IDENTIFIER ::= {id-it 15}
--      OrigPKIMessageValue     ::= PKIMessages
--   id-it-suppLangTags     OBJECT IDENTIFIER ::= {id-it 16}
--      SuppLangTagsValue       ::= SEQUENCE OF UTF8String
--   id-it-caCerts          OBJECT IDENTIFIER ::= {id-it 17}
--      CaCertsValue            ::= SEQUENCE SIZE (1..MAX) OF
--                                             CMPCertificate
--      - id-it-caCerts added in CMP Updates [RFC9480]
--   id-it-rootCaKeyUpdate  OBJECT IDENTIFIER ::= {id-it 18}
--      RootCaKeyUpdateValue    ::= RootCaKeyUpdateContent
--      - id-it-rootCaKeyUpdate added in CMP Updates [RFC9480]
--   id-it-certReqTemplate  OBJECT IDENTIFIER ::= {id-it 19}
--      CertReqTemplateValue    ::= CertReqTemplateContent
--      - id-it-certReqTemplate added in CMP Updates [RFC9480]
--   id-it-rootCaCert       OBJECT IDENTIFIER ::= {id-it 20}
--      RootCaCertValue         ::= CMPCertificate
--      - id-it-rootCaCert added in CMP Updates [RFC9480]
--   id-it-certProfile      OBJECT IDENTIFIER ::= {id-it 21}
--      CertProfileValue        ::= SEQUENCE SIZE (1..MAX) OF
--                                                 UTF8String
--      - id-it-certProfile added in CMP Updates [RFC9480]
--   id-it-crlStatusList    OBJECT IDENTIFIER ::= {id-it 22}
--   CRLStatusListValue         ::= SEQUENCE SIZE (1..MAX) OF
--                                                  CRLStatus
--      - id-it-crlStatusList added in CMP Updates [RFC9480]
--   id-it-crls             OBJECT IDENTIFIER ::= {id-it 23}
--   CRLsValue                  ::= SEQUENCE SIZE (1..MAX) OF
--                                            CertificateList
--      - id-it-crls added in CMP Updates [RFC9480]
--
-- where
--
--   id-pkix OBJECT IDENTIFIER ::= {
--      iso(1) identified-organization(3)
--      dod(6) internet(1) security(5) mechanisms(5) pkix(7)}
-- and
--   id-it   OBJECT IDENTIFIER ::= {id-pkix 4}
--
--
-- This construct MAY also be used to define new PKIX Certificate
-- Management Protocol request and response messages or general-
-- purpose (e.g., announcement) messages for future needs or for
-- specific environments.

GenMsgContent ::= SEQUENCE OF InfoTypeAndValue

-- May be sent by EE, RA, or CA (depending on message content).
-- The OPTIONAL infoValue parameter of InfoTypeAndValue will
-- typically be omitted for some of the examples given above.
-- The receiver is free to ignore any contained OIDs that it
-- does not recognize.  If sent from EE to CA, the empty set
-- indicates that the CA may send
-- any/all information that it wishes.

GenRepContent ::= SEQUENCE OF InfoTypeAndValue
-- The receiver MAY ignore any contained OIDs that it does not
-- recognize.

ErrorMsgContent ::= SEQUENCE {
    pKIStatusInfo          PKIStatusInfo,
    errorCode              INTEGER           OPTIONAL,
    -- implementation-specific error codes
    errorDetails           PKIFreeText       OPTIONAL
    -- implementation-specific error details
}

PollReqContent ::= SEQUENCE OF SEQUENCE {
    certReqId              INTEGER
}

PollRepContent ::= SEQUENCE OF SEQUENCE {
    certReqId              INTEGER,
    checkAfter             INTEGER,  -- time in seconds
    reason                 PKIFreeText OPTIONAL
}

--
-- Extended key usage extension for PKI entities used in CMP
-- operations, added due to the changes made in
-- CMP Updates [RFC9480]
-- The EKUs for the CA and RA are reused from CMC, as defined in
-- [RFC6402]
--

-- id-kp-cmcCA OBJECT IDENTIFIER ::= { id-kp 27 }
-- id-kp-cmcRA OBJECT IDENTIFIER ::= { id-kp 28 }
id-kp-cmKGA OBJECT IDENTIFIER ::= { id-kp 32 }

-- There is no 1988 ASN.1 module of PKCS #9 available to import the
-- syntax of the localKeyId attribute type and value from. Therefore,
-- the syntax is added here as needed for the updates made in
-- CMP Updates [RFC9480].

pkcs-9 OBJECT IDENTIFIER ::= {iso(1) member-body(2) us(840)
                              rsadsi(113549) pkcs(1) 9}

pkcs-9-at-localKeyId OBJECT IDENTIFIER ::= {pkcs-9 21}

LocalKeyIdValue ::= OCTET STRING

END -- of CMP module
</pre><a class="pilcrow" href="#appendix-A.1-2">¶</a>
</div>
</section>
</div>
<div id="ASN.1_2002_Modules">
<section id="appendix-A.2">
        <h3 id="name-update-to-rfc-5912-2002-asn">
<a class="section-number selfRef" href="#appendix-A.2">A.2. </a><a class="section-name selfRef" href="#name-update-to-rfc-5912-2002-asn">Update to RFC 5912 - 2002 ASN.1 Module</a>
        </h3>
<p id="appendix-A.2-1">This section contains the updated 2002 ASN.1 module for <span>[<a class="cite xref" href="#RFC5912">RFC5912</a>]</span>.  This module replaces the module in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc5912#section-9">Section 9</a> of [<a class="cite xref" href="#RFC5912">RFC5912</a>]</span>.  The module contains those changes to the normative ASN.1 module from <span><a class="relref" href="https://rfc-editor.org/rfc/rfc4210#appendix-F">Appendix F</a> of [<a class="cite xref" href="#RFC4210">RFC4210</a>]</span> that were to update to the 2002 ASN.1 standard done in <span>[<a class="cite xref" href="#RFC5912">RFC5912</a>]</span>, as well as changes made in this document.<a class="pilcrow" href="#appendix-A.2-1">¶</a></p>
<div class="breakable lang-asn.1 sourcecode" id="appendix-A.2-2">
<pre>PKIXCMP-2021
    { iso(1) identified-organization(3) dod(6) internet(1)
    security(5) mechanisms(5) pkix(7) id-mod(0)
    id-mod-cmp2021-02(100) }
DEFINITIONS EXPLICIT TAGS ::=
BEGIN
IMPORTS

AttributeSet{}, SingleAttribute{}, Extensions{}, EXTENSION, ATTRIBUTE
FROM PKIX-CommonTypes-2009
    {iso(1) identified-organization(3) dod(6) internet(1) security(5)
    mechanisms(5) pkix(7) id-mod(0) id-mod-pkixCommon-02(57)}

AlgorithmIdentifier{}, SIGNATURE-ALGORITHM, ALGORITHM,
    DIGEST-ALGORITHM, MAC-ALGORITHM
FROM AlgorithmInformation-2009
    {iso(1) identified-organization(3) dod(6) internet(1) security(5)
    mechanisms(5) pkix(7) id-mod(0)
    id-mod-algorithmInformation-02(58)}

Certificate, CertificateList, Time, id-kp
FROM PKIX1Explicit-2009
    {iso(1) identified-organization(3) dod(6) internet(1) security(5)
    mechanisms(5) pkix(7) id-mod(0) id-mod-pkix1-explicit-02(51)}

DistributionPointName, GeneralNames, GeneralName, KeyIdentifier
FROM PKIX1Implicit-2009
    {iso(1) identified-organization(3) dod(6) internet(1) security(5)
    mechanisms(5) pkix(7) id-mod(0) id-mod-pkix1-implicit-02(59)}

CertTemplate, PKIPublicationInfo, EncryptedKey, CertId,
    CertReqMessages, Controls, RegControlSet, id-regCtrl
FROM PKIXCRMF-2009
    { iso(1) identified-organization(3) dod(6) internet(1)
    security(5) mechanisms(5) pkix(7) id-mod(0)
    id-mod-crmf2005-02(55) }
    -- The import of EncryptedKey is added due to the updates made
    -- in CMP Updates [RFC9480]. EncryptedValue does not need to
    -- be imported anymore and is therefore removed here.

-- See also the behavioral clarifications to CRMF codified in
-- Appendix C of this specification.

CertificationRequest
FROM PKCS-10
    {iso(1) identified-organization(3) dod(6) internet(1) security(5)
    mechanisms(5) pkix(7) id-mod(0) id-mod-pkcs10-2009(69)}
-- (specified in [RFC2986] with 1993 ASN.1 syntax and IMPLICIT
-- tags).  Alternatively, implementers may directly include
-- the syntax of [RFC2986] in this module.

localKeyId
FROM PKCS-9
    {iso(1) member-body(2) us(840) rsadsi(113549) pkcs(1) pkcs-9(9)
    modules(0) pkcs-9(1)}
    -- The import of localKeyId is added due to the updates made in
    -- CMP Updates [RFC9480].

EnvelopedData, SignedData
FROM CryptographicMessageSyntax-2009
    {iso(1) member-body(2) us(840) rsadsi(113549) pkcs(1) pkcs-9(9)
    smime(16) modules(0) id-mod-cms-2004-02(41)}
    -- The import of EnvelopedData and SignedData is added due to
    -- the updates made in CMP Updates [RFC9480].
;

-- The rest of the module contains locally defined OIDs and
-- constructs:

CMPCertificate ::= CHOICE { x509v3PKCert Certificate, ... }
-- This syntax, while bits-on-the-wire compatible with the
-- standard X.509 definition of "Certificate", allows the
-- possibility of future certificate types (such as X.509
-- attribute certificates, card-verifiable
-- certificates, or other kinds of certificates) within this
-- Certificate Management Protocol, should a need ever arise to
-- support such generality.  Those implementations that do not
-- foresee a need to ever support other certificate types MAY, if
-- they wish, comment out the above structure and "uncomment" the
-- following one prior to compiling this ASN.1 module.  (Note that
-- interoperability with implementations that don't do this will be
-- unaffected by this change.)

-- CMPCertificate ::= Certificate

PKIMessage ::= SEQUENCE {
    header           PKIHeader,
    body             PKIBody,
    protection   [0] PKIProtection OPTIONAL,
    extraCerts   [1] SEQUENCE SIZE (1..MAX) OF CMPCertificate
                  OPTIONAL }

PKIMessages ::= SEQUENCE SIZE (1..MAX) OF PKIMessage

PKIHeader ::= SEQUENCE {
    pvno                INTEGER     { cmp1999(1), cmp2000(2),
                                      cmp2012(3) },
    sender              GeneralName,
    -- identifies the sender
    recipient           GeneralName,
    -- identifies the intended recipient
    messageTime     [0] GeneralizedTime         OPTIONAL,
    -- time of production of this message (used when the sender
    -- believes that the transport will be "suitable", i.e.,
    -- that the time will still be meaningful upon receipt)
    protectionAlg   [1] AlgorithmIdentifier{ALGORITHM, {...}}
                            OPTIONAL,
    -- algorithm used for the calculation of protection bits
    senderKID       [2] KeyIdentifier           OPTIONAL,
    recipKID        [3] KeyIdentifier           OPTIONAL,
    -- to identify specific keys used for protection
    transactionID   [4] OCTET STRING            OPTIONAL,
    -- identifies the transaction, i.e., this will be the same in
    -- corresponding request, response, certConf, and PKIConf
    -- messages
    senderNonce     [5] OCTET STRING            OPTIONAL,
    recipNonce      [6] OCTET STRING            OPTIONAL,
    -- nonces used to provide replay protection, senderNonce
    -- is inserted by the creator of this message; recipNonce
    -- is a nonce previously inserted in a related message by
    -- the intended recipient of this message.
    freeText        [7] PKIFreeText             OPTIONAL,
    -- this may be used to indicate context-specific instructions
    -- (this field is intended for human consumption)
    generalInfo     [8] SEQUENCE SIZE (1..MAX) OF
                        InfoTypeAndValue     OPTIONAL
    -- this may be used to convey context-specific information
    -- (this field not primarily intended for human consumption)
}

PKIFreeText ::= SEQUENCE SIZE (1..MAX) OF UTF8String
    -- text encoded as a UTF-8 string [RFC3629]

PKIBody ::= CHOICE {       -- message-specific body elements
    ir       [0]  CertReqMessages,        --Initialization Request
    ip       [1]  CertRepMessage,         --Initialization Response
    cr       [2]  CertReqMessages,        --Certification Request
    cp       [3]  CertRepMessage,         --Certification Response
    p10cr    [4]  CertificationRequest,   --imported from [RFC2986]
    popdecc  [5]  POPODecKeyChallContent, --pop Challenge
    popdecr  [6]  POPODecKeyRespContent,  --pop Response
    kur      [7]  CertReqMessages,        --Key Update Request
    kup      [8]  CertRepMessage,         --Key Update Response
    krr      [9]  CertReqMessages,        --Key Recovery Request
    krp      [10] KeyRecRepContent,       --Key Recovery Response
    rr       [11] RevReqContent,          --Revocation Request
    rp       [12] RevRepContent,          --Revocation Response
    ccr      [13] CertReqMessages,        --Cross-Cert. Request
    ccp      [14] CertRepMessage,         --Cross-Cert. Response
    ckuann   [15] CAKeyUpdAnnContent,     --CA Key Update Ann.
    cann     [16] CertAnnContent,         --Certificate Ann.
    rann     [17] RevAnnContent,          --Revocation Ann.
    crlann   [18] CRLAnnContent,          --CRL Announcement
    pkiconf  [19] PKIConfirmContent,      --Confirmation
    nested   [20] NestedMessageContent,   --Nested Message
    genm     [21] GenMsgContent,          --General Message
    genp     [22] GenRepContent,          --General Response
    error    [23] ErrorMsgContent,        --Error Message
    certConf [24] CertConfirmContent,     --Certificate Confirm
    pollReq  [25] PollReqContent,         --Polling Request
    pollRep  [26] PollRepContent          --Polling Response
}

PKIProtection ::= BIT STRING

ProtectedPart ::= SEQUENCE {
    header    PKIHeader,
    body      PKIBody }

id-PasswordBasedMac OBJECT IDENTIFIER ::= { iso(1) member-body(2)
    usa(840) nt(113533) nsn(7) algorithms(66) 13 }
PBMParameter ::= SEQUENCE {
    salt                OCTET STRING,
    -- Note: Implementations MAY wish to limit acceptable sizes
    -- of this string to values appropriate for their environment
    -- in order to reduce the risk of denial-of-service attacks.
    owf                 AlgorithmIdentifier{DIGEST-ALGORITHM, {...}},
    -- AlgId for a One-Way Function
    iterationCount      INTEGER,
    -- number of times the OWF is applied
    -- Note: Implementations MAY wish to limit acceptable sizes
    -- of this integer to values appropriate for their environment
    -- in order to reduce the risk of denial-of-service attacks.
    mac                 AlgorithmIdentifier{MAC-ALGORITHM, {...}}
    -- the MAC AlgId (e.g., HMAC-SHA256, AES-GMAC [RFC9481],
    -- or HMAC [RFC2104, RFC2202])
}

id-DHBasedMac OBJECT IDENTIFIER ::= { iso(1) member-body(2)
    usa(840) nt(113533) nsn(7) algorithms(66) 30 }
DHBMParameter ::= SEQUENCE {
    owf                 AlgorithmIdentifier{DIGEST-ALGORITHM, {...}},
    -- AlgId for a One-Way Function
    mac                 AlgorithmIdentifier{MAC-ALGORITHM, {...}}
    -- the MAC AlgId (e.g., HMAC-SHA256, AES-GMAC [RFC9481],
    -- or HMAC [RFC2104, RFC2202])
}

PKIStatus ::= INTEGER {
    accepted               (0),
    -- you got exactly what you asked for
    grantedWithMods        (1),
    -- you got something like what you asked for; the
    -- requester is responsible for ascertaining the differences
    rejection              (2),
    -- you don't get it, more information elsewhere in the message
    waiting                (3),
    -- the request body part has not yet been processed; expect to
    -- hear more later (note: proper handling of this status
    -- response MAY use the polling req/rep PKIMessages specified
    -- in Section 5.3.22 of [RFC4210]; alternatively, polling in the
    -- underlying transport layer MAY have some utility in this
    -- regard)
    revocationWarning      (4),
    -- this message contains a warning that a revocation is
    -- imminent
    revocationNotification (5),
    -- notification that a revocation has occurred
    keyUpdateWarning       (6)
    -- update already done for the oldCertId specified in
    -- CertReqMsg
}

PKIFailureInfo ::= BIT STRING {
-- since we can fail in more than one way!
-- More codes may be added in the future if/when required.
    badAlg              (0),
    -- unrecognized or unsupported algorithm identifier
    badMessageCheck     (1),
    -- integrity check failed (e.g., signature did not verify)
    badRequest          (2),
    -- transaction not permitted or supported
    badTime             (3),
    -- messageTime was not sufficiently close to the system time,
    -- as defined by local policy
    badCertId           (4),
    -- no certificate could be found matching the provided criteria
    badDataFormat       (5),
    -- the data submitted has the wrong format
    wrongAuthority      (6),
    -- the authority indicated in the request is different from the
    -- one creating the response token
    incorrectData       (7),
    -- the requester's data is incorrect (for notary services)
    missingTimeStamp    (8),
    -- when the timestamp is missing but should be there
    -- (by policy)
    badPOP              (9),
    -- the proof-of-possession failed
    certRevoked         (10),
    -- the certificate has already been revoked
    certConfirmed       (11),
    -- the certificate has already been confirmed
    wrongIntegrity      (12),
    -- not valid integrity, based on the password instead of the
    -- signature or vice versa
    badRecipientNonce   (13),
    -- not valid recipient nonce, either missing or wrong value
    timeNotAvailable    (14),
    -- the TSA's time source is not available
    unacceptedPolicy    (15),
    -- the requested TSA policy is not supported by the TSA
    unacceptedExtension (16),
    -- the requested extension is not supported by the TSA
    addInfoNotAvailable (17),
    -- the additional information requested could not be
    -- understood or is not available
    badSenderNonce      (18),
    -- not valid sender nonce, either missing or wrong size
    badCertTemplate     (19),
    -- not valid cert. template or missing mandatory information
    signerNotTrusted    (20),
    -- signer of the message unknown or not trusted
    transactionIdInUse  (21),
    -- the transaction identifier is already in use
    unsupportedVersion  (22),
    -- the version of the message is not supported
    notAuthorized       (23),
    -- the sender was not authorized to make the preceding
    -- request or perform the preceding action
    systemUnavail       (24),
    -- the request cannot be handled due to system unavailability
    systemFailure       (25),
    -- the request cannot be handled due to system failure
    duplicateCertReq    (26)
    -- the certificate cannot be issued because a duplicate
    -- certificate already exists
}

PKIStatusInfo ::= SEQUENCE {
    status        PKIStatus,
    statusString  PKIFreeText     OPTIONAL,
    failInfo      PKIFailureInfo  OPTIONAL }

OOBCert ::= CMPCertificate

OOBCertHash ::= SEQUENCE {
    hashAlg     [0] AlgorithmIdentifier{DIGEST-ALGORITHM, {...}}
                        OPTIONAL,
    certId      [1] CertId                  OPTIONAL,
    hashVal         BIT STRING
    -- hashVal is calculated over the DER encoding of the
    -- self-signed certificate with the identifier certID.
}

POPODecKeyChallContent ::= SEQUENCE OF Challenge
-- One Challenge per encryption key certification request (in the
-- same order as these requests appear in CertReqMessages)

Challenge ::= SEQUENCE {
    owf                 AlgorithmIdentifier{DIGEST-ALGORITHM, {...}}
                            OPTIONAL,
    -- MUST be present in the first Challenge; MAY be omitted in
    -- any subsequent Challenge in POPODecKeyChallContent (if
    -- omitted, then the owf used in the immediately preceding
    -- Challenge is to be used)
    witness             OCTET STRING,
    -- the result of applying the One-Way Function (owf) to a
    -- randomly generated INTEGER, A (Note that a different
    -- INTEGER MUST be used for each Challenge.)
    challenge           OCTET STRING
    -- the encryption (under the public key for which the cert.
    -- request is being made) of Rand
}

-- Rand was added in CMP Updates [RFC9480]

Rand ::= SEQUENCE {
-- Rand is encrypted under the public key to form the challenge
-- in POPODecKeyChallContent
   int                  INTEGER,
   -- the randomly generated INTEGER A (above)
   sender               GeneralName
   -- the sender's name (as included in PKIHeader)
}

POPODecKeyRespContent ::= SEQUENCE OF INTEGER
-- One INTEGER per encryption key certification request (in the
-- same order as these requests appear in CertReqMessages).  The
-- retrieved INTEGER A (above) is returned to the sender of the
-- corresponding Challenge.

CertRepMessage ::= SEQUENCE {
    caPubs       [1] SEQUENCE SIZE (1..MAX) OF CMPCertificate
                  OPTIONAL,
    response         SEQUENCE OF CertResponse }

CertResponse ::= SEQUENCE {
    certReqId           INTEGER,
    -- to match this response with the corresponding request (a value
    -- of -1 is to be used if certReqId is not specified in the
    -- corresponding request, which can only be a p10cr)
    status              PKIStatusInfo,
    certifiedKeyPair    CertifiedKeyPair    OPTIONAL,
    rspInfo             OCTET STRING        OPTIONAL
    -- analogous to the id-regInfo-utf8Pairs string defined
    -- for regInfo in CertReqMsg [RFC4211]
}

CertifiedKeyPair ::= SEQUENCE {
    certOrEncCert       CertOrEncCert,
    privateKey      [0] EncryptedKey      OPTIONAL,
    -- See [RFC4211] for comments on encoding.
    -- Changed from Encrypted Value to EncryptedKey as a CHOICE of
    -- EncryptedValue and EnvelopedData due to the changes made in
    -- CMP Updates [RFC9480].
    -- Using the choice EncryptedValue is bit-compatible to the
    -- syntax without this change.
    publicationInfo [1] PKIPublicationInfo  OPTIONAL }

CertOrEncCert ::= CHOICE {
    certificate     [0] CMPCertificate,
    encryptedCert   [1] EncryptedKey
    -- Changed from Encrypted Value to EncryptedKey as a CHOICE of
    -- EncryptedValue and EnvelopedData due to the changes made in
    -- CMP Updates [RFC9480].
    -- Using the choice EncryptedValue is bit-compatible to the
    -- syntax without this change.
}

KeyRecRepContent ::= SEQUENCE {
    status                  PKIStatusInfo,
    newSigCert          [0] CMPCertificate OPTIONAL,
    caCerts             [1] SEQUENCE SIZE (1..MAX) OF
                                     CMPCertificate OPTIONAL,
    keyPairHist         [2] SEQUENCE SIZE (1..MAX) OF
                                     CertifiedKeyPair OPTIONAL }

RevReqContent ::= SEQUENCE OF RevDetails

RevDetails ::= SEQUENCE {
    certDetails         CertTemplate,
    -- allows the requester to specify as much as they can about
    -- the cert. for which revocation is requested
    -- (e.g., for cases in which serialNumber is not available)
    crlEntryDetails     Extensions{{...}}    OPTIONAL
    -- requested crlEntryExtensions
}

RevRepContent ::= SEQUENCE {
    status       SEQUENCE SIZE (1..MAX) OF PKIStatusInfo,
    -- in the same order as was sent in RevReqContent
    revCerts [0] SEQUENCE SIZE (1..MAX) OF CertId OPTIONAL,
    -- IDs for which revocation was requested
    -- (same order as status)
    crls     [1] SEQUENCE SIZE (1..MAX) OF CertificateList OPTIONAL
    -- the resulting CRLs (there may be more than one)
}

CAKeyUpdAnnContent ::= SEQUENCE {
    oldWithNew   CMPCertificate, -- old pub signed with new priv
    newWithOld   CMPCertificate, -- new pub signed with old priv
    newWithNew   CMPCertificate  -- new pub signed with new priv
}

CertAnnContent ::= CMPCertificate

RevAnnContent ::= SEQUENCE {
    status              PKIStatus,
    certId              CertId,
    willBeRevokedAt     GeneralizedTime,
    badSinceDate        GeneralizedTime,
    crlDetails          Extensions{{...}}  OPTIONAL
    -- extra CRL details (e.g., crl number, reason, location, etc.)
}

CRLAnnContent ::= SEQUENCE OF CertificateList
PKIConfirmContent ::= NULL

NestedMessageContent ::= PKIMessages

-- CertReqTemplateContent, AttributeTypeAndValue,
-- ExpandedRegControlSet, id-regCtrl-altCertTemplate,
-- AltCertTemplate, regCtrl-algId, id-regCtrl-algId, AlgIdCtrl,
-- regCtrl-rsaKeyLen, id-regCtrl-rsaKeyLen, and RsaKeyLenCtrl
-- were added in CMP Updates [RFC9480]

CertReqTemplateContent ::= SEQUENCE {
   certTemplate           CertTemplate,
   -- prefilled certTemplate structure elements
   -- The SubjectPublicKeyInfo field in the certTemplate MUST NOT
   -- be used.
   keySpec                Controls OPTIONAL
   -- MAY be used to specify supported algorithms
   -- Controls  ::= SEQUENCE SIZE (1..MAX) OF AttributeTypeAndValue
   -- as specified in CRMF [RFC4211]
   }

AttributeTypeAndValue ::= SingleAttribute{{ ... }}

ExpandedRegControlSet ATTRIBUTE ::= { RegControlSet |
   regCtrl-altCertTemplate | regCtrl-algId | regCtrl-rsaKeyLen, ... }

regCtrl-altCertTemplate ATTRIBUTE ::=
   { TYPE AltCertTemplate IDENTIFIED BY id-regCtrl-altCertTemplate }

id-regCtrl-altCertTemplate OBJECT IDENTIFIER ::= { id-regCtrl 7 }

AltCertTemplate ::= AttributeTypeAndValue
   -- specifies a template for a certificate other than an X.509v3
   -- public key certificate

regCtrl-algId ATTRIBUTE ::=
   { TYPE AlgIdCtrl IDENTIFIED BY id-regCtrl-algId }

id-regCtrl-algId OBJECT IDENTIFIER ::= { id-regCtrl 11 }

AlgIdCtrl ::= AlgorithmIdentifier{ALGORITHM, {...}}
   -- SHALL be used to specify supported algorithms other than RSA

regCtrl-rsaKeyLen ATTRIBUTE ::=
   { TYPE RsaKeyLenCtrl IDENTIFIED BY id-regCtrl-rsaKeyLen }

id-regCtrl-rsaKeyLen OBJECT IDENTIFIER ::= { id-regCtrl 12 }

RsaKeyLenCtrl ::= INTEGER (1..MAX)
   -- SHALL be used to specify supported RSA key lengths

-- RootCaKeyUpdateContent, CRLSource, and CRLStatus were added in
-- CMP Updates [RFC9480]

RootCaKeyUpdateContent ::= SEQUENCE {
   newWithNew       CMPCertificate,
   -- new root CA certificate
   newWithOld   [0] CMPCertificate OPTIONAL,
   -- X.509 certificate containing the new public root CA key
   -- signed with the old private root CA key
   oldWithNew   [1] CMPCertificate OPTIONAL
   -- X.509 certificate containing the old public root CA key
   -- signed with the new private root CA key
   }

CRLSource ::= CHOICE {
   dpn          [0] DistributionPointName,
   issuer       [1] GeneralNames }

CRLStatus ::= SEQUENCE {
   source       CRLSource,
   thisUpdate   Time OPTIONAL }

INFO-TYPE-AND-VALUE ::= TYPE-IDENTIFIER

InfoTypeAndValue ::= SEQUENCE {
    infoType    INFO-TYPE-AND-VALUE.
                    &amp;id({SupportedInfoSet}),
    infoValue   INFO-TYPE-AND-VALUE.
                    &amp;Type({SupportedInfoSet}{@infoType}) }

SupportedInfoSet INFO-TYPE-AND-VALUE ::= { ... }

-- Example InfoTypeAndValue contents include, but are not limited
-- to, the following (uncomment in this ASN.1 module and use as
-- appropriate for a given environment):
--
--   id-it-caProtEncCert    OBJECT IDENTIFIER ::= {id-it 1}
--      CAProtEncCertValue      ::= CMPCertificate
--   id-it-signKeyPairTypes OBJECT IDENTIFIER ::= {id-it 2}
--      SignKeyPairTypesValue   ::= SEQUENCE SIZE (1..MAX) OF
--                                      AlgorithmIdentifier{{...}}
--   id-it-encKeyPairTypes  OBJECT IDENTIFIER ::= {id-it 3}
--      EncKeyPairTypesValue    ::= SEQUENCE SIZE (1..MAX) OF
--                                      AlgorithmIdentifier{{...}}
--   id-it-preferredSymmAlg OBJECT IDENTIFIER ::= {id-it 4}
--      PreferredSymmAlgValue   ::= AlgorithmIdentifier{{...}}
--   id-it-caKeyUpdateInfo  OBJECT IDENTIFIER ::= {id-it 5}
--      CAKeyUpdateInfoValue    ::= CAKeyUpdAnnContent
--   id-it-currentCRL       OBJECT IDENTIFIER ::= {id-it 6}
--      CurrentCRLValue         ::= CertificateList
--   id-it-unsupportedOIDs  OBJECT IDENTIFIER ::= {id-it 7}
--      UnsupportedOIDsValue    ::= SEQUENCE SIZE (1..MAX) OF
--                                          OBJECT IDENTIFIER
--   id-it-keyPairParamReq  OBJECT IDENTIFIER ::= {id-it 10}
--      KeyPairParamReqValue    ::= OBJECT IDENTIFIER
--   id-it-keyPairParamRep  OBJECT IDENTIFIER ::= {id-it 11}
--      KeyPairParamRepValue    ::= AlgorithmIdentifier{{...}}
--   id-it-revPassphrase    OBJECT IDENTIFIER ::= {id-it 12}
--      RevPassphraseValue      ::= EncryptedKey
--      - Changed from Encrypted Value to EncryptedKey as a CHOICE
--      - of EncryptedValue and EnvelopedData due to the changes
--      - made in CMP Updates [RFC9480]
--      - Using the choice EncryptedValue is bit-compatible to
--      - the syntax without this change
--   id-it-implicitConfirm  OBJECT IDENTIFIER ::= {id-it 13}
--      ImplicitConfirmValue    ::= NULL
--   id-it-confirmWaitTime  OBJECT IDENTIFIER ::= {id-it 14}
--      ConfirmWaitTimeValue    ::= GeneralizedTime
--   id-it-origPKIMessage   OBJECT IDENTIFIER ::= {id-it 15}
--      OrigPKIMessageValue     ::= PKIMessages
--   id-it-suppLangTags     OBJECT IDENTIFIER ::= {id-it 16}
--      SuppLangTagsValue       ::= SEQUENCE OF UTF8String
--   id-it-caCerts          OBJECT IDENTIFIER ::= {id-it 17}
--      CaCertsValue            ::= SEQUENCE SIZE (1..MAX) OF
--                                             CMPCertificate
--      - id-it-caCerts added in CMP Updates [RFC9480]
--   id-it-rootCaKeyUpdate  OBJECT IDENTIFIER ::= {id-it 18}
--      RootCaKeyUpdateValue    ::= RootCaKeyUpdateContent
--      - id-it-rootCaKeyUpdate added in CMP Updates [RFC9480]
--   id-it-certReqTemplate  OBJECT IDENTIFIER ::= {id-it 19}
--      CertReqTemplateValue    ::= CertReqTemplateContent
--      - id-it-certReqTemplate added in CMP Updates [RFC9480]
--   id-it-rootCaCert       OBJECT IDENTIFIER ::= {id-it 20}
--      RootCaCertValue         ::= CMPCertificate
--      - id-it-rootCaCert added in CMP Updates [RFC9480]
--   id-it-certProfile      OBJECT IDENTIFIER ::= {id-it 21}
--      CertProfileValue        ::= SEQUENCE SIZE (1..MAX) OF
--                                                 UTF8String
--      - id-it-certProfile added in CMP Updates [RFC9480]
--   id-it-crlStatusList    OBJECT IDENTIFIER ::= {id-it 22}
--   CRLStatusListValue         ::= SEQUENCE SIZE (1..MAX) OF
--                                                  CRLStatus
--      - id-it-crlStatusList added in CMP Updates [RFC9480]
--   id-it-crls             OBJECT IDENTIFIER ::= {id-it 23}
--   CRLsValue                  ::= SEQUENCE SIZE (1..MAX) OF
--                                            CertificateList
--      - id-it-crls added in CMP Updates [RFC9480]
--
-- where
--
--   id-pkix OBJECT IDENTIFIER ::= {
--      iso(1) identified-organization(3)
--      dod(6) internet(1) security(5) mechanisms(5) pkix(7)}
-- and
--   id-it   OBJECT IDENTIFIER ::= {id-pkix 4}
--
--
-- This construct MAY also be used to define new PKIX Certificate
-- Management Protocol request and response messages or general-
-- purpose (e.g., announcement) messages for future needs or for
-- specific environments.

GenMsgContent ::= SEQUENCE OF InfoTypeAndValue

-- May be sent by EE, RA, or CA (depending on message content).
-- The OPTIONAL infoValue parameter of InfoTypeAndValue will
-- typically be omitted for some of the examples given above.
-- The receiver is free to ignore any contained OIDs that it
-- does not recognize.  If sent from EE to CA, the empty set
-- indicates that the CA may send
-- any/all information that it wishes.

GenRepContent ::= SEQUENCE OF InfoTypeAndValue
-- The receiver MAY ignore any contained OIDs that it does not
-- recognize.

ErrorMsgContent ::= SEQUENCE {
    pKIStatusInfo          PKIStatusInfo,
    errorCode              INTEGER           OPTIONAL,
    -- implementation-specific error codes
    errorDetails           PKIFreeText       OPTIONAL
    -- implementation-specific error details
}

CertConfirmContent ::= SEQUENCE OF CertStatus

CertStatus ::= SEQUENCE {
    certHash    OCTET STRING,
    -- the hash of the certificate, using the same hash algorithm
    -- as is used to create and verify the certificate signature
    certReqId   INTEGER,
    -- to match this confirmation with the corresponding req/rep
    statusInfo  PKIStatusInfo OPTIONAL,
    hashAlg [0] AlgorithmIdentifier{DIGEST-ALGORITHM, {...}} OPTIONAL
    -- the hash algorithm to use for calculating certHash
    -- SHOULD NOT be used in all cases where the AlgorithmIdentifier
    -- of the certificate signature specifies a hash algorithm
   }

PollReqContent ::= SEQUENCE OF SEQUENCE {
    certReqId              INTEGER }

PollRepContent ::= SEQUENCE OF SEQUENCE {
    certReqId              INTEGER,
    checkAfter             INTEGER,  -- time in seconds
    reason                 PKIFreeText OPTIONAL }

--
-- Extended key usage extension for PKI entities used in CMP
-- operations, added due to the changes made in
-- CMP Updates [RFC9480]
-- The EKUs for the CA and RA are reused from CMC, as defined in
-- [RFC6402]
--

-- id-kp-cmcCA OBJECT IDENTIFIER ::= { id-kp 27 }
-- id-kp-cmcRA OBJECT IDENTIFIER ::= { id-kp 28 }
id-kp-cmKGA OBJECT IDENTIFIER ::= { id-kp 32 }

END
</pre><a class="pilcrow" href="#appendix-A.2-2">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="Acknowledgements">
<section id="appendix-B">
      <h2 id="name-acknowledgements">
<a class="section-name selfRef" href="#name-acknowledgements">Acknowledgements</a>
      </h2>
<p id="appendix-B-1">Special thanks goes to <span class="contact-name">Jim Schaad</span> for his guidance and the inspiration to structure and write this document like <span>[<a class="cite xref" href="#RFC6402">RFC6402</a>]</span>, which updates CMC. Special thanks also goes to <span class="contact-name">Russ Housley</span>, <span class="contact-name">Lijun Liao</span>, <span class="contact-name">Martin Peylo</span>, and <span class="contact-name">Tomas Gustavsson</span> for reviewing and providing valuable suggestions on improving this document.<a class="pilcrow" href="#appendix-B-1">¶</a></p>
<p id="appendix-B-2">We also thank all reviewers of this document for their valuable feedback.<a class="pilcrow" href="#appendix-B-2">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-C">
      <h2 id="name-authors-addresses">
<a class="section-name selfRef" href="#name-authors-addresses">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Hendrik Brockhaus</span></div>
<div class="left" dir="auto"><span class="org">Siemens</span></div>
<div class="left" dir="auto"><span class="street-address">Werner-von-Siemens-Strasse 1</span></div>
<div class="left" dir="auto">
<span class="postal-code">80333</span> <span class="locality">Munich</span>
</div>
<div class="left" dir="auto"><span class="country-name">Germany</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:hendrik.brockhaus@siemens.com">hendrik.brockhaus@siemens.com</a>
</div>
<div class="url">
<span>URI:</span>
<a class="url" href="https://www.siemens.com">https://www.siemens.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">David von Oheimb</span></div>
<div class="left" dir="auto"><span class="org">Siemens</span></div>
<div class="left" dir="auto"><span class="street-address">Werner-von-Siemens-Strasse 1</span></div>
<div class="left" dir="auto">
<span class="postal-code">80333</span> <span class="locality">Munich</span>
</div>
<div class="left" dir="auto"><span class="country-name">Germany</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:david.von.oheimb@siemens.com">david.von.oheimb@siemens.com</a>
</div>
<div class="url">
<span>URI:</span>
<a class="url" href="https://www.siemens.com">https://www.siemens.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">John Gray</span></div>
<div class="left" dir="auto"><span class="org">Entrust</span></div>
<div class="left" dir="auto"><span class="street-address">1187 Park Place</span></div>
<div class="left" dir="auto">
<span class="locality">Minneapolis</span>, <span class="region">MN</span> <span class="postal-code">55379</span>
</div>
<div class="left" dir="auto"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:john.gray@entrust.com">john.gray@entrust.com</a>
</div>
<div class="url">
<span>URI:</span>
<a class="url" href="https://www.entrust.com">https://www.entrust.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>


</body></html>