<!DOCTYPE html>
<html class="RFC" lang="en"><head>
<meta charset="utf-8"/>
<meta content="Common,Latin" name="scripts"/>
<meta content="initial-scale=1.0" name="viewport"/>
<title>RFC 9010: Routing for RPL (Routing Protocol for Low-Power and Lossy Networks) Leaves</title>
<meta content="Pascal Thubert" name="author"/>
<meta content="Michael C. Richardson" name="author"/>
<meta content="
       
  This specification provides a mechanism for a host that implements a 
  routing-agnostic interface based on IPv6 over Low-Power Wireless Personal Area 
  Network (6LoWPAN) Neighbor Discovery to obtain reachability services across a
  network that leverages RFC 6550 for its routing operations. It updates RFCs 6550,
  6775, and 8505.
 
    " name="description"/>
<meta content="xml2rfc 3.7.0" name="generator"/>
<meta content="IPv6" name="keyword"/>
<meta content="ND" name="keyword"/>
<meta content="Redistribution" name="keyword"/>
<meta content="9010" name="rfc.number"/>
<!-- Generator version information:
  xml2rfc 3.7.0
    Python 3.6.10
    appdirs 1.4.4
    ConfigArgParse 1.2.3
    google-i18n-address 2.3.5
    html5lib 1.0.1
    intervaltree 3.0.2
    Jinja2 2.11.2
    kitchen 1.2.6
    lxml 4.4.2
    pycairo 1.19.0
    pycountry 19.8.18
    pyflakes 2.1.1
    PyYAML 5.3.1
    requests 2.22.0
    setuptools 40.6.2
    six 1.14.0
    WeasyPrint 51
-->
<link href="rfc9010.xml" rel="alternate" type="application/rfc+xml"/>
<link href="#copyright" rel="license"/>
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css"/>
<link href="https://dx.doi.org/10.17487/rfc9010" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <link href="https://datatracker.ietf.org/doc/draft-ietf-roll-unaware-leaves-30" rel="prev"/>
  </head>
<body>
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 9010</td>
<td class="center">RPL-Unaware Leaves</td>
<td class="right">April 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Thubert &amp; Richardson</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div class="document-information" id="external-metadata"></div>
<div class="document-information" id="internal-metadata">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a class="eref" href="https://www.rfc-editor.org/rfc/rfc9010">9010</a></dd>
<dt class="label-updates">Updates:</dt>
<dd class="updates">
<a class="eref" href="https://www.rfc-editor.org/rfc/rfc6550">6550</a>, <a class="eref" href="https://www.rfc-editor.org/rfc/rfc6775">6775</a>, <a class="eref" href="https://www.rfc-editor.org/rfc/rfc8505">8505</a> </dd>
<dt class="label-category">Category:</dt>
<dd class="category">Standards Track</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time class="published" datetime="2021-04">April 2021</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">P. Thubert, <span class="editor">Ed.</span>
</div>
<div class="org">Cisco Systems</div>
</div>
<div class="author">
      <div class="author-name">M. Richardson</div>
<div class="org">Sandelman</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 9010</h1>
<h1 id="title">Routing for RPL (Routing Protocol for Low-Power and Lossy Networks) Leaves</h1>
<section id="section-abstract">
      <h2 id="abstract"><a class="selfRef" href="#abstract">Abstract</a></h2>
<p id="section-abstract-1">
  This specification provides a mechanism for a host that implements a 
  routing-agnostic interface based on IPv6 over Low-Power Wireless Personal Area 
  Network (6LoWPAN) Neighbor Discovery to obtain reachability services across a
  network that leverages RFC 6550 for its routing operations. It updates RFCs 6550,
  6775, and 8505.<a class="pilcrow" href="#section-abstract-1">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a class="section-name selfRef" href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This is an Internet Standards Track document.<a class="pilcrow" href="#section-boilerplate.1-1">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.<a class="pilcrow" href="#section-boilerplate.1-2">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc9010">https://www.rfc-editor.org/info/rfc9010</a></span>.<a class="pilcrow" href="#section-boilerplate.1-3">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a class="section-name selfRef" href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a class="pilcrow" href="#section-boilerplate.2-1">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a class="pilcrow" href="#section-boilerplate.2-2">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a class="toplink" href="#" onclick="scroll(0,0)">▲</a><h2 id="name-table-of-contents">
<a class="section-name selfRef" href="#name-table-of-contents">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.1">
            <p class="keepWithNext" id="section-toc.1-1.1.1"><a class="xref" href="#section-1">1</a>.  <a class="xref" href="#name-introduction">Introduction</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a class="xref" href="#section-2">2</a>.  <a class="xref" href="#name-terminology">Terminology</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.2.2.1">
                <p class="keepWithNext" id="section-toc.1-1.2.2.1.1"><a class="xref" href="#section-2.1">2.1</a>.  <a class="xref" href="#name-requirements-language">Requirements Language</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.2.2.2">
                <p class="keepWithNext" id="section-toc.1-1.2.2.2.1"><a class="xref" href="#section-2.2">2.2</a>.  <a class="xref" href="#name-glossary">Glossary</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a class="xref" href="#section-2.3">2.3</a>.  <a class="xref" href="#name-related-documents">Related Documents</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a class="xref" href="#section-3">3</a>.  <a class="xref" href="#name-rpl-external-routes-and-dat">RPL External Routes and Data-Plane Artifacts</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a class="xref" href="#section-4">4</a>.  <a class="xref" href="#name-6lowpan-neighbor-discovery">6LoWPAN Neighbor Discovery</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a class="xref" href="#section-4.1">4.1</a>.  <a class="xref" href="#name-address-registration-per-rf">Address Registration per RFC 6775</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a class="xref" href="#section-4.2">4.2</a>.  <a class="xref" href="#name-extended-address-registrati">Extended Address Registration per RFC 8505</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a class="xref" href="#section-4.2.1">4.2.1</a>.  <a class="xref" href="#name-r-flag">R Flag</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.4.2.2.2.2">
                    <p id="section-toc.1-1.4.2.2.2.2.1"><a class="xref" href="#section-4.2.2">4.2.2</a>.  <a class="xref" href="#name-tid-i-field-and-opaque-fiel">TID, "I" Field, and Opaque Field</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.4.2.2.2.3">
                    <p id="section-toc.1-1.4.2.2.2.3.1"><a class="xref" href="#section-4.2.3">4.2.3</a>.  <a class="xref" href="#name-route-ownership-verifier">Route Ownership Verifier</a></p>
</li>
                </ul>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a class="xref" href="#section-4.3">4.3</a>.  <a class="xref" href="#name-edar-edac-per-rfc-8505">EDAR/EDAC per RFC 8505</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.4.2.3.2.1">
                    <p id="section-toc.1-1.4.2.3.2.1.1"><a class="xref" href="#section-4.3.1">4.3.1</a>.  <a class="xref" href="#name-capability-indication-optio">Capability Indication Option per RFC 7400</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a class="xref" href="#section-5">5</a>.  <a class="xref" href="#name-requirements-for-the-rpl-un">Requirements for the RPL-Unaware Leaf</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a class="xref" href="#section-5.1">5.1</a>.  <a class="xref" href="#name-support-of-6lowpan-nd">Support of 6LoWPAN ND</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a class="xref" href="#section-5.2">5.2</a>.  <a class="xref" href="#name-support-of-ipv6-encapsulati">Support of IPv6 Encapsulation</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a class="xref" href="#section-5.3">5.3</a>.  <a class="xref" href="#name-support-of-the-hop-by-hop-h">Support of the Hop-by-Hop Header</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a class="xref" href="#section-5.4">5.4</a>.  <a class="xref" href="#name-support-of-the-routing-head">Support of the Routing Header</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a class="xref" href="#section-6">6</a>.  <a class="xref" href="#name-enhancements-to-rfc-6550">Enhancements to RFC 6550</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a class="xref" href="#section-6.1">6.1</a>.  <a class="xref" href="#name-updated-rpl-target-option">Updated RPL Target Option</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a class="xref" href="#section-6.2">6.2</a>.  <a class="xref" href="#name-additional-flag-in-the-rpl-">Additional Flag in the RPL DODAG Configuration Option</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a class="xref" href="#section-6.3">6.3</a>.  <a class="xref" href="#name-updated-rpl-status">Updated RPL Status</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a class="xref" href="#section-7">7</a>.  <a class="xref" href="#name-enhancements-to-rfc-9009">Enhancements to RFC 9009</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a class="xref" href="#section-8">8</a>.  <a class="xref" href="#name-enhancements-to-rfcs-6775-a">Enhancements to RFCs 6775 and 8505</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a class="xref" href="#section-9">9</a>.  <a class="xref" href="#name-protocol-operations-for-uni">Protocol Operations for Unicast Addresses</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a class="xref" href="#section-9.1">9.1</a>.  <a class="xref" href="#name-general-flow">General Flow</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a class="xref" href="#section-9.2">9.2</a>.  <a class="xref" href="#name-detailed-operation">Detailed Operation</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.9.2.2.2.1">
                    <p id="section-toc.1-1.9.2.2.2.1.1"><a class="xref" href="#section-9.2.1">9.2.1</a>.  <a class="xref" href="#name-perspective-of-the-6ln-acti">Perspective of the 6LN Acting as a RUL</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.9.2.2.2.2">
                    <p id="section-toc.1-1.9.2.2.2.2.1"><a class="xref" href="#section-9.2.2">9.2.2</a>.  <a class="xref" href="#name-perspective-of-the-6lr-acti">Perspective of the 6LR Acting as a Border Router</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.9.2.2.2.3">
                    <p id="section-toc.1-1.9.2.2.2.3.1"><a class="xref" href="#section-9.2.3">9.2.3</a>.  <a class="xref" href="#name-perspective-of-the-rpl-doda">Perspective of the RPL DODAG Root</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.9.2.2.2.4">
                    <p id="section-toc.1-1.9.2.2.2.4.1"><a class="xref" href="#section-9.2.4">9.2.4</a>.  <a class="xref" href="#name-perspective-of-the-6lbr">Perspective of the 6LBR</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a class="xref" href="#section-10">10</a>. <a class="xref" href="#name-protocol-operations-for-mul">Protocol Operations for Multicast Addresses</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a class="xref" href="#section-11">11</a>. <a class="xref" href="#name-security-considerations">Security Considerations</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a class="xref" href="#section-12">12</a>. <a class="xref" href="#name-iana-considerations">IANA Considerations</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a class="xref" href="#section-12.1">12.1</a>.  <a class="xref" href="#name-fixing-the-address-registra">Fixing the Address Registration Option Flags</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a class="xref" href="#section-12.2">12.2</a>.  <a class="xref" href="#name-resizing-the-aro-status-val">Resizing the ARO Status Values</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.12.2.3">
                <p id="section-toc.1-1.12.2.3.1"><a class="xref" href="#section-12.3">12.3</a>.  <a class="xref" href="#name-new-rpl-dodag-configuration">New RPL DODAG Configuration Option Flag</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.12.2.4">
                <p id="section-toc.1-1.12.2.4.1"><a class="xref" href="#section-12.4">12.4</a>.  <a class="xref" href="#name-rpl-target-option-flags-reg">RPL Target Option Flags Registry</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.12.2.5">
                <p id="section-toc.1-1.12.2.5.1"><a class="xref" href="#section-12.5">12.5</a>.  <a class="xref" href="#name-new-subregistry-for-rpl-non">New Subregistry for RPL Non-Rejection Status Values</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.12.2.6">
                <p id="section-toc.1-1.12.2.6.1"><a class="xref" href="#section-12.6">12.6</a>.  <a class="xref" href="#name-new-subregistry-for-rpl-rej">New Subregistry for RPL Rejection Status Values</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a class="xref" href="#section-13">13</a>. <a class="xref" href="#name-references">References</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a class="xref" href="#section-13.1">13.1</a>.  <a class="xref" href="#name-normative-references">Normative References</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a class="xref" href="#section-13.2">13.2</a>.  <a class="xref" href="#name-informative-references">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a class="xref" href="#section-appendix.a">Appendix A</a>.  <a class="xref" href="#name-example-compression">Example Compression</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a class="xref" href="#section-appendix.b"></a><a class="xref" href="#name-acknowledgments">Acknowledgments</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a class="xref" href="#section-appendix.c"></a><a class="xref" href="#name-authors-addresses">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a class="section-number selfRef" href="#section-1">1. </a><a class="section-name selfRef" href="#name-introduction">Introduction</a>
      </h2>
<p id="section-1-1">The design of Low-Power and Lossy Networks (LLNs) is generally focused on
   saving energy, which is the most constrained resource of all. Other design
   constraints, such as a limited memory capacity, duty cycling of the LLN
   devices, and low-power lossy transmissions, derive from that primary concern.<a class="pilcrow" href="#section-1-1">¶</a></p>
<p id="section-1-2">The IETF produced "<a class="xref" href="#RFC6550">RPL: IPv6 Routing Protocol for Low-Power and Lossy Networks</a>" <span>[<a class="xref" href="#RFC6550">RFC6550</a>]</span> to provide routing services for IPv6 <span>[<a class="xref" href="#RFC8200">RFC8200</a>]</span> within such constraints. RPL belongs to the class of
distance-vector protocols -- which, compared to link-state protocols, limit
the amount of topological knowledge that needs to be installed and maintained
in each node -- and does not require convergence to avoid micro-loops.<a class="pilcrow" href="#section-1-2">¶</a></p>
<p id="section-1-3">
   To save signaling and routing state in constrained networks,
   RPL allows a path stretch (see <span>[<a class="xref" href="#RFC6687">RFC6687</a>]</span>), whereby routing
   is only performed along a Destination-Oriented Directed Acyclic Graph (DODAG) that is optimized to reach a root node, as opposed to along the shortest path
   between two peers, whatever that would mean in a given LLN.
   This trades the quality of peer-to-peer (P2P) paths for a vastly reduced
   amount of control traffic and routing state that would be required to
   operate an any-to-any shortest-path protocol. Additionally,
   broken routes may be fixed lazily and on demand, based on data-plane
   inconsistency discovery, which avoids wasting energy in the proactive repair
   of unused paths.<a class="pilcrow" href="#section-1-3">¶</a></p>
<p id="section-1-4">
   For many of the nodes, though not all, the DODAG provides multiple
   forwarding solutions towards the root of the topology via so-called parents.
RPL installs the routes proactively, but to adapt to fuzzy connectivity
-- whereby the physical topology cannot be expected to reach a stable state --
it uses a lazy route maintenance operation that may only fix them reactively, 
upon actual traffic.
   The result is that RPL provides reachability for most of the LLN nodes, most
   of the time, but may not converge in the classical sense.<a class="pilcrow" href="#section-1-4">¶</a></p>
<p id="section-1-5">
   RPL can be deployed in conjunction with IPv6 Neighbor Discovery (ND)
   <span>[<a class="xref" href="#RFC4861">RFC4861</a>]</span> <span>[<a class="xref" href="#RFC4862">RFC4862</a>]</span> and IPv6 over Low-Power Wireless Personal Area Network (6LoWPAN) ND
   <span>[<a class="xref" href="#RFC6775">RFC6775</a>]</span> <span>[<a class="xref" href="#RFC8505">RFC8505</a>]</span> to maintain reachability
   within a Non-Broadcast Multi-Access (NBMA) multi-link subnet.<a class="pilcrow" href="#section-1-5">¶</a></p>
<p id="section-1-6">
   In that mode, IPv6 addresses are advertised individually as host routes.
   Some nodes may act as routers and participate in the forwarding operations,
   whereas others will only receive/originate packets, acting as hosts in the
   data plane.
   Per the terminology of <span>[<a class="xref" href="#RFC6550">RFC6550</a>]</span>, an IPv6 host <span>[<a class="xref" href="#RFC8504">RFC8504</a>]</span>
   that is reachable over the RPL network is called a "leaf".<a class="pilcrow" href="#section-1-6">¶</a></p>
<p id="section-1-7">
   <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9008#section-2">Section 2</a> of [<a class="xref" href="#RFC9008">RFC9008</a>]</span> defines the terms
   "RPL leaf", "RPL-Aware Leaf" (RAL), and "RPL-Unaware Leaf" (RUL).
   A RPL leaf is a host attached to one or more RPL routers; as such, it
   relies on the RPL router(s) to forward its traffic across the RPL domain but
   does not forward traffic from another node. As opposed to the RAL, the RUL does not
 participate in RPL and relies on its RPL router(s) to also inject the
 routes to its IPv6 addresses in the RPL domain.<a class="pilcrow" href="#section-1-7">¶</a></p>
<p id="section-1-8">
   A RUL may be unable to participate because it is very energy constrained
   or code-space constrained, or because it would be unsafe to let it inject
   routes in RPL. Using 6LoWPAN ND as opposed to RPL as the host-to-router
   interface limits the surface of the possible attacks by the RUL against the
   RPL domain. If all RULs and RPL-Aware Nodes (RANs) use 6LoWPAN ND for the neighbor discovery process, it is
   also possible to protect the address ownership of all nodes, including the
   RULs.<a class="pilcrow" href="#section-1-8">¶</a></p>
<p id="section-1-9">
   This document specifies how the router injects the host routes in the RPL
   domain on behalf of the RUL. <a class="xref" href="#prereq">Section 5</a> details how the RUL
   can leverage 6LoWPAN ND to obtain the routing services from the router.
   In that model, the RUL is also a 6LoWPAN Node (6LN) and the RPL-aware router
   is also a 6LoWPAN Router (6LR). Using the 6LoWPAN ND Address Registration
   mechanism, the RUL signals that the router must inject a host route for the
   Registered Address.<a class="pilcrow" href="#section-1-9">¶</a></p>
<span id="name-injecting-routes-on-behalf-"></span><div id="injectfig">
<figure id="figure-1">
        <div class="artwork art-text alignLeft" id="section-1-10.1">
<pre>         ------+---------
               |          Internet
               |
            +-----+
            |     | &lt;------------- 6LBR / RPL DODAG Root
            +-----+                     ^
               |                        |
         o    o   o  o                  | RPL
     o o   o  o   o  o     o    o       |
    o  o o  o o    o   o  o   o  o      |  +
    o   o      o     o   o   o    o     |
   o  o   o  o   o  o    o    o  o      | 6LoWPAN ND
      o  o  o  o        o   o           |
     o       o            o    o        v
   o      o     o &lt;------------- 6LR / RPL Border Router
                                        ^
                                        | 6LoWPAN ND only
                                        v
                u &lt;------------- 6LN / RPL-Unaware Leaf</pre>
</div>
<figcaption><a class="selfRef" href="#figure-1">Figure 1</a>:
<a class="selfRef" href="#name-injecting-routes-on-behalf-">Injecting Routes on Behalf of RULs</a>
        </figcaption></figure>
</div>
<p id="section-1-11">
   The RPL Non-Storing mode mechanism is used to extend the routing state with
   connectivity to the RULs even when the DODAG is operated in Storing mode.
   The unicast packet-forwarding operation by the 6LR serving a RUL is described
   in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9008#section-4.1.1">Section 4.1.1</a> of [<a class="xref" href="#RFC9008">RFC9008</a>]</span>.<a class="pilcrow" href="#section-1-11">¶</a></p>
<p id="section-1-12">
   Examples of possible RULs include severely energy-constrained sensors such as
   window smash sensors (alarm system) and kinetically powered light switches.
   Other applications of this specification may include a smart grid network that
   controls appliances -- such as washing machines or the heating system -- in the
   home. Appliances may not participate in the RPL protocol operated in the
   smart grid network but can still interact with the smart grid for control and/or
   metering.<a class="pilcrow" href="#section-1-12">¶</a></p>
<p id="section-1-13">
   This specification can be deployed incrementally in a network that implements
   <span>[<a class="xref" href="#RFC9008">RFC9008</a>]</span>. Only the root and the 6LRs that
   connect the RULs need to be upgraded. The RPL routers on the path will only see
   unicast IPv6 traffic between the root and the 6LR.<a class="pilcrow" href="#section-1-13">¶</a></p>
<p id="section-1-14">
   This document is organized as follows:<a class="pilcrow" href="#section-1-14">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-15.1">
    Sections <a class="xref" href="#prereqv6">3</a> and <a class="xref" href="#lpnd">4</a> present in a
    non-normative fashion the salient aspects of RPL and 6LoWPAN ND,
    respectively, that are leveraged in this specification to provide
    connectivity to a 6LN acting as a RUL across a RPL network.<a class="pilcrow" href="#section-1-15.1">¶</a>
</li>
        <li class="normal" id="section-1-15.2">
          <a class="xref" href="#prereq">Section 5</a> lists the requirements that a RUL needs to match
    in order to be served by a RPL router that complies with this specification.<a class="pilcrow" href="#section-1-15.2">¶</a>
</li>
        <li class="normal" id="section-1-15.3">
          <a class="xref" href="#upd">Section 6</a> presents the changes made to <span>[<a class="xref" href="#RFC6550">RFC6550</a>]</span>;
    a new behavior is introduced whereby the 6LR advertises the 6LN's addresses in a RPL Destination Advertisement Object (DAO) message based on the ND registration by the 6LN, and the RPL DODAG root performs the Extended Duplicate Address Request / Extended Duplicate Address Confirmation (EDAR/EDAC) exchange with the 6LoWPAN Border Router (6LBR) on behalf of the 6LR;
    modifications are introduced to some RPL options and to the RPL Status to
    facilitate the integration of the protocols.<a class="pilcrow" href="#section-1-15.3">¶</a>
</li>
        <li class="normal" id="section-1-15.4">
          <a class="xref" href="#updnpdao">Section 7</a> presents the changes made to
    <span>[<a class="xref" href="#RFC9009">RFC9009</a>]</span>; the use of the Destination Cleanup Object (DCO) message is extended to the Non-Storing RPL Mode of Operation (MOP) to report asynchronous issues from the root to the 6LR.<a class="pilcrow" href="#section-1-15.4">¶</a>
</li>
        <li class="normal" id="section-1-15.5">
          <a class="xref" href="#upd2">Section 8</a> presents the changes made to <span>[<a class="xref" href="#RFC6775">RFC6775</a>]</span>
    and <span>[<a class="xref" href="#RFC8505">RFC8505</a>]</span>; the range of the Address Registration Option / Extended Address Registration Option (ARO/EARO) Status values is reduced
    to 64 values, and the remaining bits in the original status field are
    now reserved.<a class="pilcrow" href="#section-1-15.5">¶</a>
</li>
        <li class="normal" id="section-1-15.6">
    Sections <a class="xref" href="#op">9</a> and <a class="xref" href="#multiop">10</a> present the operation of
    this specification for unicast and multicast flows, respectively, and
    <a class="xref" href="#security-considerations">Section 11</a> presents associated security
    considerations.<a class="pilcrow" href="#section-1-15.6">¶</a>
</li>
      </ul>
</section>
</div>
<section id="section-2">
      <h2 id="name-terminology">
<a class="section-number selfRef" href="#section-2">2. </a><a class="section-name selfRef" href="#name-terminology">Terminology</a>
      </h2>
<div id="bcp">
<section id="section-2.1">
        <h3 id="name-requirements-language">
<a class="section-number selfRef" href="#section-2.1">2.1. </a><a class="section-name selfRef" href="#name-requirements-language">Requirements Language</a>
        </h3>
<p id="section-2.1-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>",
   "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>",
   "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>",
   "<span class="bcp14">SHOULD NOT</span>",
   "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
   "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document
   are to be interpreted as described in BCP 14
   <span>[<a class="xref" href="#RFC2119">RFC2119</a>]</span> <span>[<a class="xref" href="#RFC8174">RFC8174</a>]</span> when, and only
   when, they appear in all capitals, as shown here.<a class="pilcrow" href="#section-2.1-1">¶</a></p>
</section>
</div>
<div id="gloss">
<section id="section-2.2">
        <h3 id="name-glossary">
<a class="section-number selfRef" href="#section-2.2">2.2. </a><a class="section-name selfRef" href="#name-glossary">Glossary</a>
        </h3>
<p id="section-2.2-1"> This document uses the following abbreviations:<a class="pilcrow" href="#section-2.2-1">¶</a></p>
<span class="break"></span><dl class="dlParallel dlCompact" id="section-2.2-2">
          <dt id="section-2.2-2.1">6BBR:</dt>
          <dd id="section-2.2-2.2" style="margin-left: 1.5em">6LoWPAN Backbone Router<a class="pilcrow" href="#section-2.2-2.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.3">6CIO:</dt>
          <dd id="section-2.2-2.4" style="margin-left: 1.5em">6LoWPAN Capability Indication Option<a class="pilcrow" href="#section-2.2-2.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.5">6LBR:</dt>
          <dd id="section-2.2-2.6" style="margin-left: 1.5em">6LoWPAN Border Router<a class="pilcrow" href="#section-2.2-2.6">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.7">6LN:</dt>
          <dd id="section-2.2-2.8" style="margin-left: 1.5em">6LoWPAN Node (a low-power host or router)<a class="pilcrow" href="#section-2.2-2.8">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.9">6LoRH:</dt>
          <dd id="section-2.2-2.10" style="margin-left: 1.5em">6LoWPAN Routing Header<a class="pilcrow" href="#section-2.2-2.10">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.11">6LoWPAN:</dt>
          <dd id="section-2.2-2.12" style="margin-left: 1.5em">IPv6 over Low-Power Wireless Personal Area Network<a class="pilcrow" href="#section-2.2-2.12">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.13">6LR:</dt>
          <dd id="section-2.2-2.14" style="margin-left: 1.5em">6LoWPAN Router<a class="pilcrow" href="#section-2.2-2.14">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.15">AP-ND:</dt>
          <dd id="section-2.2-2.16" style="margin-left: 1.5em">Address-Protected Neighbor Discovery<a class="pilcrow" href="#section-2.2-2.16">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.17">ARO:</dt>
          <dd id="section-2.2-2.18" style="margin-left: 1.5em">Address Registration Option<a class="pilcrow" href="#section-2.2-2.18">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.19">DAC:</dt>
          <dd id="section-2.2-2.20" style="margin-left: 1.5em">Duplicate Address Confirmation<a class="pilcrow" href="#section-2.2-2.20">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.21">DAD:</dt>
          <dd id="section-2.2-2.22" style="margin-left: 1.5em">Duplicate Address Detection<a class="pilcrow" href="#section-2.2-2.22">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.23">DAO:</dt>
          <dd id="section-2.2-2.24" style="margin-left: 1.5em">Destination Advertisement Object (a RPL message)<a class="pilcrow" href="#section-2.2-2.24">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.25">DAR:</dt>
          <dd id="section-2.2-2.26" style="margin-left: 1.5em">Duplicate Address Request<a class="pilcrow" href="#section-2.2-2.26">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.27">DCO:</dt>
          <dd id="section-2.2-2.28" style="margin-left: 1.5em">Destination Cleanup Object (a RPL message)<a class="pilcrow" href="#section-2.2-2.28">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.29">DIO:</dt>
          <dd id="section-2.2-2.30" style="margin-left: 1.5em">DODAG Information Object (a RPL message)<a class="pilcrow" href="#section-2.2-2.30">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.31">DODAG:</dt>
          <dd id="section-2.2-2.32" style="margin-left: 1.5em">Destination-Oriented Directed Acyclic Graph<a class="pilcrow" href="#section-2.2-2.32">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.33">EARO:</dt>
          <dd id="section-2.2-2.34" style="margin-left: 1.5em">Extended Address Registration Option<a class="pilcrow" href="#section-2.2-2.34">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.35">EDAC:</dt>
          <dd id="section-2.2-2.36" style="margin-left: 1.5em">Extended Duplicate Address Confirmation<a class="pilcrow" href="#section-2.2-2.36">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.37">EDAR:</dt>
          <dd id="section-2.2-2.38" style="margin-left: 1.5em">Extended Duplicate Address Request<a class="pilcrow" href="#section-2.2-2.38">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.39">EUI:</dt>
          <dd id="section-2.2-2.40" style="margin-left: 1.5em">Extended Unique Identifier<a class="pilcrow" href="#section-2.2-2.40">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.41">LLN:</dt>
          <dd id="section-2.2-2.42" style="margin-left: 1.5em">Low-Power and Lossy Network<a class="pilcrow" href="#section-2.2-2.42">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.43">MLD:</dt>
          <dd id="section-2.2-2.44" style="margin-left: 1.5em">Multicast Listener Discovery<a class="pilcrow" href="#section-2.2-2.44">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.45">MOP:</dt>
          <dd id="section-2.2-2.46" style="margin-left: 1.5em">RPL Mode of Operation<a class="pilcrow" href="#section-2.2-2.46">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.47">NA:</dt>
          <dd id="section-2.2-2.48" style="margin-left: 1.5em">Neighbor Advertisement<a class="pilcrow" href="#section-2.2-2.48">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.49">NBMA:</dt>
          <dd id="section-2.2-2.50" style="margin-left: 1.5em">Non-Broadcast Multi-Access<a class="pilcrow" href="#section-2.2-2.50">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.51">NCE:</dt>
          <dd id="section-2.2-2.52" style="margin-left: 1.5em">Neighbor Cache Entry<a class="pilcrow" href="#section-2.2-2.52">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.53">ND:</dt>
          <dd id="section-2.2-2.54" style="margin-left: 1.5em">Neighbor Discovery<a class="pilcrow" href="#section-2.2-2.54">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.55">NS:</dt>
          <dd id="section-2.2-2.56" style="margin-left: 1.5em">Neighbor Solicitation<a class="pilcrow" href="#section-2.2-2.56">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.57">PIO:</dt>
          <dd id="section-2.2-2.58" style="margin-left: 1.5em">Prefix Information Option<a class="pilcrow" href="#section-2.2-2.58">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.59">RA:</dt>
          <dd id="section-2.2-2.60" style="margin-left: 1.5em">Router Advertisement<a class="pilcrow" href="#section-2.2-2.60">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.61">RAL:</dt>
          <dd id="section-2.2-2.62" style="margin-left: 1.5em">RPL-Aware Leaf<a class="pilcrow" href="#section-2.2-2.62">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.63">RAN:</dt>
          <dd id="section-2.2-2.64" style="margin-left: 1.5em">RPL-Aware Node (either a RPL router or a RPL-Aware Leaf)<a class="pilcrow" href="#section-2.2-2.64">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.65">RH3:</dt>
          <dd id="section-2.2-2.66" style="margin-left: 1.5em">Routing Header for IPv6 (type 3)<a class="pilcrow" href="#section-2.2-2.66">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.67">ROVR:</dt>
          <dd id="section-2.2-2.68" style="margin-left: 1.5em">Registration Ownership Verifier<a class="pilcrow" href="#section-2.2-2.68">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.69">RPI:</dt>
          <dd id="section-2.2-2.70" style="margin-left: 1.5em">RPL Packet Information<a class="pilcrow" href="#section-2.2-2.70">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.71">RPL:</dt>
          <dd id="section-2.2-2.72" style="margin-left: 1.5em">Routing Protocol for Low-Power and Lossy Networks<a class="pilcrow" href="#section-2.2-2.72">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.73">RUL:</dt>
          <dd id="section-2.2-2.74" style="margin-left: 1.5em">RPL-Unaware Leaf<a class="pilcrow" href="#section-2.2-2.74">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.75">SAVI:</dt>
          <dd id="section-2.2-2.76" style="margin-left: 1.5em">Source Address Validation Improvement<a class="pilcrow" href="#section-2.2-2.76">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.77">SLAAC:</dt>
          <dd id="section-2.2-2.78" style="margin-left: 1.5em">Stateless Address Autoconfiguration<a class="pilcrow" href="#section-2.2-2.78">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.79">SRH:</dt>
          <dd id="section-2.2-2.80" style="margin-left: 1.5em">Source Routing Header<a class="pilcrow" href="#section-2.2-2.80">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.81">TID:</dt>
          <dd id="section-2.2-2.82" style="margin-left: 1.5em">Transaction ID (a sequence counter in the EARO)<a class="pilcrow" href="#section-2.2-2.82">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.83">TIO:</dt>
          <dd id="section-2.2-2.84" style="margin-left: 1.5em">Transit Information Option<a class="pilcrow" href="#section-2.2-2.84">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="lo">
<section id="section-2.3">
        <h3 id="name-related-documents">
<a class="section-number selfRef" href="#section-2.3">2.3. </a><a class="section-name selfRef" href="#name-related-documents">Related Documents</a>
        </h3>
<p id="section-2.3-1">
   The terminology used in this document is consistent with, and incorporates
   the terms provided in, "<a class="xref" href="#RFC7102">Terms Used in Routing for Low-Power and Lossy Networks</a>" <span>[<a class="xref" href="#RFC7102">RFC7102</a>]</span>. A glossary of classical 6LoWPAN abbreviations is given in <a class="xref" href="#gloss">Section 2.2</a>.
   Other terms in use in LLNs are found in "<a class="xref" href="#RFC7228">Terminology for Constrained-Node Networks</a>" <span>[<a class="xref" href="#RFC7228">RFC7228</a>]</span>.
   This specification uses the terms "6LN" and "6LR" to refer specifically to nodes
   that implement the 6LN and 6LR roles in 6LoWPAN ND and does not expect other
   functionality such as 6LoWPAN Header Compression <span>[<a class="xref" href="#RFC6282">RFC6282</a>]</span>
   from those nodes.<a class="pilcrow" href="#section-2.3-1">¶</a></p>
<p id="section-2.3-2">"RPL", "RPI", "RPL Instance" (indexed by a
   RPLInstanceID), "up", and "down" are defined in "<a class="xref" href="#RFC6550">RPL: IPv6 Routing Protocol for Low-Power and Lossy Networks</a>" <span>[<a class="xref" href="#RFC6550">RFC6550</a>]</span>. The RPI is the abstract
   information that RPL defines to be placed in data packets, e.g., as the RPL
   Option <span>[<a class="xref" href="#RFC6553">RFC6553</a>]</span> within the IPv6 Hop-By-Hop Header.
   By extension, the term "RPI" is often used to refer to the RPL Option itself.
   The DAO and DIO messages are also specified in
   <span>[<a class="xref" href="#RFC6550">RFC6550</a>]</span>. The DCO message is defined in <span>[<a class="xref" href="#RFC9009">RFC9009</a>]</span>.<a class="pilcrow" href="#section-2.3-2">¶</a></p>
<p id="section-2.3-3">

   This document uses the terms "RUL", "RAN", and "RAL" consistently with <span>[<a class="xref" href="#RFC9008">RFC9008</a>]</span>.
   A RAN is either a RAL or a RPL router. As opposed to a RUL, a RAN manages
   the reachability of its addresses and prefixes by injecting them in RPL by
   itself.<a class="pilcrow" href="#section-2.3-3">¶</a></p>
<p id="section-2.3-4">
        In this document, readers will encounter terms and concepts
        that are discussed in the following documents:<a class="pilcrow" href="#section-2.3-4">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2.3-5">
          <dt id="section-2.3-5.1">Classical IPv6 ND:</dt>
          <dd id="section-2.3-5.2" style="margin-left: 1.5em">"<a class="xref" href="#RFC4861">Neighbor Discovery for IP version 6 (IPv6)</a>" <span>[<a class="xref" href="#RFC4861">RFC4861</a>]</span> and
        "<a class="xref" href="#RFC4862">IPv6 Stateless Address Autoconfiguration</a>" <span>[<a class="xref" href="#RFC4862">RFC4862</a>]</span>,<a class="pilcrow" href="#section-2.3-5.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-5.3">6LoWPAN:</dt>
          <dd id="section-2.3-5.4" style="margin-left: 1.5em">"<a class="xref" href="#RFC6606">Problem Statement and Requirements for IPv6 over Low-Power Wireless Personal Area Network (6LoWPAN) Routing</a>" <span>[<a class="xref" href="#RFC6606">RFC6606</a>]</span> and "<a class="xref" href="#RFC4919">IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs): Overview, Assumptions, Problem Statement, and Goals</a>" <span>[<a class="xref" href="#RFC4919">RFC4919</a>]</span>, and<a class="pilcrow" href="#section-2.3-5.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-5.5">6LoWPAN ND:</dt>
          <dd id="section-2.3-5.6" style="margin-left: 1.5em">"<a class="xref" href="#RFC6775">Neighbor Discovery Optimization for IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs)</a>" <span>[<a class="xref" href="#RFC6775">RFC6775</a>]</span>,
        "<a class="xref" href="#RFC8505">Registration Extensions for IPv6 over Low-Power Wireless Personal Area Network (6LoWPAN) Neighbor Discovery</a>" <span>[<a class="xref" href="#RFC8505">RFC8505</a>]</span>,
        "<a class="xref" href="#RFC8928">Address-Protected Neighbor Discovery for Low-Power and Lossy Networks</a>" <span>[<a class="xref" href="#RFC8928">RFC8928</a>]</span>, and "<a class="xref" href="#RFC8929">IPv6 Backbone Router</a>" <span>[<a class="xref" href="#RFC8929">RFC8929</a>]</span>.<a class="pilcrow" href="#section-2.3-5.6">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
</section>
<div id="prereqv6">
<section id="section-3">
      <h2 id="name-rpl-external-routes-and-dat">
<a class="section-number selfRef" href="#section-3">3. </a><a class="section-name selfRef" href="#name-rpl-external-routes-and-dat">RPL External Routes and Data-Plane Artifacts</a>
      </h2>
<p id="section-3-1">
   RPL was initially designed to build stub networks whereby the only border
   router would be the RPL DODAG root (typically co-located with the 6LBR) and all
   the nodes in the stub would be RPL aware. But <span>[<a class="xref" href="#RFC6550">RFC6550</a>]</span> was also prepared to be extended for external routes ("targets" in RPL parlance), via
   the External ('E') flag in the Transit Information Option (TIO).
   External targets provide the ability to reach destinations that are outside the RPL domain
   and connected to the RPL domain via RPL border routers that are not the root.
   <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9008#section-4.1">Section 4.1</a> of [<a class="xref" href="#RFC9008">RFC9008</a>]</span> provides a set of
   rules (summarized below) that must be followed for routing packets to and from
   an external destination. A RUL is a special case of an external target that
   is also a host directly connected to the RPL domain.<a class="pilcrow" href="#section-3-1">¶</a></p>
<p id="section-3-2">
   A 6LR that acts as a border router for external routes advertises them using
   Non-Storing mode DAO messages that are unicast directly to the root, even if
   the DODAG is operated in Storing mode.
   Non-Storing mode routes are not visible inside the RPL domain, and all packets
   are routed via the root. The RPL DODAG root tunnels the data packets directly to the
   6LR that advertised the external route, which decapsulates and forwards the
   original (inner) packets.<a class="pilcrow" href="#section-3-2">¶</a></p>
<p id="section-3-3">
   The RPL Non-Storing MOP signaling and the associated IPv6-in-IPv6 encapsulated
   packets appear as normal traffic to the intermediate routers. Support
   of external routes only impacts the root and the 6LR. It can be operated with
   legacy intermediate routers and does not add to the amount of state that must
   be maintained in those routers.
   A RUL is an example of a destination that is reachable via an external route
   that happens to also be a host route.<a class="pilcrow" href="#section-3-3">¶</a></p>
<p id="section-3-4">
   The RPL data packets typically carry a Hop-by-Hop Header with a RPL Option
   <span>[<a class="xref" href="#RFC6553">RFC6553</a>]</span> that contains the RPI (the RPL Packet Information, as defined
   in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc6550#section-11.2">Section 11.2</a> of [<a class="xref" href="#RFC6550">RFC6550</a>]</span>).
   Unless the RUL already placed a RPL Option in the outer header chain, the packets
   from and to the RUL are encapsulated using an IPv6-in-IPv6 tunnel between the
   root and the 6LR that serves the RUL
   (see Sections <a class="relref" href="https://www.rfc-editor.org/rfc/rfc9008#section-7">7</a> and <a class="relref" href="https://www.rfc-editor.org/rfc/rfc9008#section-8">8</a> of <span>[<a class="xref" href="#RFC9008">RFC9008</a>]</span> for details).
   If the packet from the RUL has an RPI, the 6LR acting as a RPL border router
   rewrites the RPI to indicate the selected RPL Instance and set the flags,
   but it does not need to encapsulate the packet (see <a class="xref" href="#lr">Section 9.2.2</a>).<a class="pilcrow" href="#section-3-4">¶</a></p>
<p id="section-3-5">
   In Non-Storing mode, packets going down the DODAG carry a Source Routing Header (SRH).  The IPv6-in-IPv6 encapsulation, the RPI, and the SRH are collectively called the
   "RPL artifacts" and can be compressed using the method defined in <span>[<a class="xref" href="#RFC8138">RFC8138</a>]</span>.
   <a class="xref" href="#u8138">Appendix A</a> presents an example compressed format for a packet
   forwarded by the root to a RUL in a Storing mode DODAG.<a class="pilcrow" href="#section-3-5">¶</a></p>
<p id="section-3-6">
   The inner packet that is forwarded to the RUL may carry some RPL artifacts,
   e.g., an RPI if the original packet was generated with it, and an SRH in a
   Non-Storing mode DODAG.
   <span>[<a class="xref" href="#RFC9008">RFC9008</a>]</span> expects the RUL to support the
   basic IPv6 node requirements per <span>[<a class="xref" href="#RFC8504">RFC8504</a>]</span> and, in particular,
   the mandates in Sections <a class="relref" href="https://www.rfc-editor.org/rfc/rfc8200#section-4.2">4.2</a> and <a class="relref" href="https://www.rfc-editor.org/rfc/rfc8200#section-4.4">4.4</a> of <span>[<a class="xref" href="#RFC8200">RFC8200</a>]</span>. As such,
   the RUL is expected to ignore the RPL artifacts that may be left over -- either
   an SRH whose Segments Left is zero or a RPL Option in the Hop-by-Hop Header
   (which can be skipped when not recognized; see <a class="xref" href="#prereqv6hh">Section 5.3</a> for
   details).<a class="pilcrow" href="#section-3-6">¶</a></p>
<p id="section-3-7">
   A RUL is not expected to support the compression method defined in
   <span>[<a class="xref" href="#RFC8138">RFC8138</a>]</span>. For that reason, the border router (the 6LR here)
   uncompresses the packet before forwarding it over an external route to a RUL
   <span>[<a class="xref" href="#RFC9008">RFC9008</a>]</span>.<a class="pilcrow" href="#section-3-7">¶</a></p>
</section>
</div>
<div id="lpnd">
<section id="section-4">
      <h2 id="name-6lowpan-neighbor-discovery">
<a class="section-number selfRef" href="#section-4">4. </a><a class="section-name selfRef" href="#name-6lowpan-neighbor-discovery">6LoWPAN Neighbor Discovery</a>
      </h2>
<p id="section-4-1">
This section goes through the 6LoWPAN ND mechanisms that this specification leverages, as a non-normative reference to the reader.
The full normative text is to be found in <span>[<a class="xref" href="#RFC6775">RFC6775</a>]</span>, <span>[<a class="xref" href="#RFC8505">RFC8505</a>]</span>, and <span>[<a class="xref" href="#RFC8928">RFC8928</a>]</span>.<a class="pilcrow" href="#section-4-1">¶</a></p>
<div id="R6775">
<section id="section-4.1">
        <h3 id="name-address-registration-per-rf">
<a class="section-number selfRef" href="#section-4.1">4.1. </a><a class="section-name selfRef" href="#name-address-registration-per-rf">Address Registration per RFC 6775</a>
        </h3>
<p id="section-4.1-1">
   The classical IPv6 Neighbor Discovery (IPv6 ND) protocol
   <span>[<a class="xref" href="#RFC4861">RFC4861</a>]</span> <span>[<a class="xref" href="#RFC4862">RFC4862</a>]</span> was defined for serial
   links and transit media such as Ethernet. It is a reactive protocol that
   relies heavily on multicast operations for Address Discovery (aka address lookup) and
   Duplicate Address Detection (DAD).<a class="pilcrow" href="#section-4.1-1">¶</a></p>
<p id="section-4.1-2">
   "<a class="xref" href="#RFC6775">Neighbor Discovery Optimization for IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs)</a>" <span>[<a class="xref" href="#RFC6775">RFC6775</a>]</span>
   adapts IPv6 ND for operations over energy-constrained LLNs.
   The main functions of <span>[<a class="xref" href="#RFC6775">RFC6775</a>]</span> are to proactively establish
   the Neighbor Cache Entry (NCE) in the 6LR and to prevent address duplication.
   To that effect, <span>[<a class="xref" href="#RFC6775">RFC6775</a>]</span> introduces a unicast Address
   Registration mechanism that contributes to reducing the use of multicast
   messages compared to the classical IPv6 ND protocol.<a class="pilcrow" href="#section-4.1-2">¶</a></p>
<p id="section-4.1-3"><span>[<a class="xref" href="#RFC6775">RFC6775</a>]</span> also introduces the Address
   Registration Option (ARO), which is carried in the unicast
   Neighbor Solicitation (NS) and Neighbor Advertisement (NA) messages between
   the 6LoWPAN Node (6LN) and the 6LoWPAN router (6LR).

   It also defines the Duplicate Address Request (DAR) and Duplicate
   Address Confirmation (DAC) messages between the 6LR and the 6LBR).
   In an LLN, the 6LBR is the central repository of all the Registered Addresses
   in its domain and the source of truth for uniqueness and ownership.<a class="pilcrow" href="#section-4.1-3">¶</a></p>
</section>
</div>
<div id="R8505E">
<section id="section-4.2">
        <h3 id="name-extended-address-registrati">
<a class="section-number selfRef" href="#section-4.2">4.2. </a><a class="section-name selfRef" href="#name-extended-address-registrati">Extended Address Registration per RFC 8505</a>
        </h3>
<p id="section-4.2-1">
   "<a class="xref" href="#RFC8505">Registration Extensions for IPv6 over Low-Power Wireless Personal Area Network (6LoWPAN) Neighbor Discovery</a>" <span>[<a class="xref" href="#RFC8505">RFC8505</a>]</span>
   updates RFC 6775 with a generic Address Registration mechanism that can be
   used to access services such as routing and ND proxy functions. To that effect,
   <span>[<a class="xref" href="#RFC8505">RFC8505</a>]</span> defines the Extended Address Registration Option
   (EARO), as shown in <a class="xref" href="#EARO">Figure 2</a>:<a class="pilcrow" href="#section-4.2-1">¶</a></p>
<span id="name-earo-format"></span><div id="EARO">
<figure id="figure-2">
          <div class="artwork art-text alignCenter" id="section-4.2-2.1">
<pre>   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |     Type      |     Length    |    Status     |    Opaque     |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |  Rsvd | I |R|T|     TID       |     Registration Lifetime     |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                                                               |
 ...          Registration Ownership Verifier (ROVR)             ...
  |                                                               |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</pre>
</div>
<figcaption><a class="selfRef" href="#figure-2">Figure 2</a>:
<a class="selfRef" href="#name-earo-format">EARO Format</a>
          </figcaption></figure>
</div>
<div id="R8505ER">
<section id="section-4.2.1">
          <h4 id="name-r-flag">
<a class="section-number selfRef" href="#section-4.2.1">4.2.1. </a><a class="section-name selfRef" href="#name-r-flag">R Flag</a>
          </h4>
<p id="section-4.2.1-1">
<span>[<a class="xref" href="#RFC8505">RFC8505</a>]</span> introduces the R flag in the EARO.
   The Registering Node sets the R flag to indicate whether the 6LR should
   ensure reachability for the Registered Address.
   If the R flag is set to 0, then the Registering Node handles the reachability
   of the Registered Address by other means. In a RPL network, this means that
   either it is a RAN that injects the route by itself or it uses another
   RPL router for reachability services.<a class="pilcrow" href="#section-4.2.1-1">¶</a></p>
<p id="section-4.2.1-2">
   This document specifies how the R flag is used in the context of RPL.
   A RPL leaf that implements the 6LN functionality from <span>[<a class="xref" href="#RFC8505">RFC8505</a>]</span>
   requires reachability services for an IPv6 address if and only if it sets
   the R flag in the NS(EARO) used to register the address to a 6LR acting as
   a RPL border router. Upon receiving the NS(EARO), the RPL router
   generates a DAO message for the Registered Address if and only if the R
   flag is set to 1.<a class="pilcrow" href="#section-4.2.1-2">¶</a></p>
<p id="section-4.2.1-3">
   <a class="xref" href="#oper">Section 9.2</a> specifies additional operations when the R flag is set to 1 in an EARO that is placed in either an NS message or an NA message.<a class="pilcrow" href="#section-4.2.1-3">¶</a></p>
</section>
</div>
<div id="R8505ETID">
<section id="section-4.2.2">
          <h4 id="name-tid-i-field-and-opaque-fiel">
<a class="section-number selfRef" href="#section-4.2.2">4.2.2. </a><a class="section-name selfRef" href="#name-tid-i-field-and-opaque-fiel">TID, "I" Field, and Opaque Field</a>
          </h4>
<p id="section-4.2.2-1">
   When the T flag is set to 1, the EARO includes a sequence counter called the
   "Transaction ID" (TID), which is needed to fill the Path Sequence field in the
   RPL Transit Information Option (TIO). For this reason, support of <span>[<a class="xref" href="#RFC8505">RFC8505</a>]</span>
   by the RUL, as opposed to only <span>[<a class="xref" href="#RFC6775">RFC6775</a>]</span>, is a prerequisite for
   this specification; this requirement is fully explained in
   <a class="xref" href="#prereq6lp">Section 5.1</a>. The EARO also
   transports an Opaque field and an associated "I" field that describes what
   the Opaque field transports and how to use it.<a class="pilcrow" href="#section-4.2.2-1">¶</a></p>
<p id="section-4.2.2-2">
   <a class="xref" href="#ln">Section 9.2.1</a> specifies the use of the "I" field and the Opaque
   field by a RUL.<a class="pilcrow" href="#section-4.2.2-2">¶</a></p>
</section>
</div>
<div id="R8505EROVR">
<section id="section-4.2.3">
          <h4 id="name-route-ownership-verifier">
<a class="section-number selfRef" href="#section-4.2.3">4.2.3. </a><a class="section-name selfRef" href="#name-route-ownership-verifier">Route Ownership Verifier</a>
          </h4>
<p id="section-4.2.3-1">
   <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8505#section-5.3">Section 5.3</a> of [<a class="xref" href="#RFC8505">RFC8505</a>]</span> introduces the Registration
   Ownership Verifier (ROVR) field, which has a variable length of 64 to 256 bits.
   The ROVR replaces the 64-bit Extended Unique Identifier (EUI‑64) in the ARO
   <span>[<a class="xref" href="#RFC6775">RFC6775</a>]</span>, which was used to uniquely identify an Address
   Registration with the link-layer address of the owner but provided no
   protection against spoofing.<a class="pilcrow" href="#section-4.2.3-1">¶</a></p>
<p id="section-4.2.3-2">

   "<a class="xref" href="#RFC8928">Address-Protected Neighbor Discovery for Low-Power and Lossy Networks</a>" <span>[<a class="xref" href="#RFC8928">RFC8928</a>]</span>
   leverages the ROVR field as a
   cryptographic proof of ownership to prevent a rogue third party from
   registering an address that is already owned.
   The use of the ROVR field enables the 6LR to block traffic that is not
   sourced at an owned address.<a class="pilcrow" href="#section-4.2.3-2">¶</a></p>
<p id="section-4.2.3-3">

   This specification does not address how the protection offered by
   <span>[<a class="xref" href="#RFC8928">RFC8928</a>]</span> could be extended for use in RPL.
   On the other hand, it adds the ROVR to the DAO to build the proxied EDAR at the root (see <a class="xref" href="#tgt">Section 6.1</a>), which means that nodes that are aware of the host route are also aware of the ROVR associated to the Target Address.<a class="pilcrow" href="#section-4.2.3-3">¶</a></p>
</section>
</div>
</section>
</div>
<div id="R8505D">
<section id="section-4.3">
        <h3 id="name-edar-edac-per-rfc-8505">
<a class="section-number selfRef" href="#section-4.3">4.3. </a><a class="section-name selfRef" href="#name-edar-edac-per-rfc-8505">EDAR/EDAC per RFC 8505</a>
        </h3>
<p id="section-4.3-1">
   <span>[<a class="xref" href="#RFC8505">RFC8505</a>]</span> updates the DAR/DAC messages to EDAR/EDAC messages to carry the ROVR field.
   The EDAR/EDAC exchange takes place
   between the 6LR and the 6LBR. It is triggered by an NS(EARO) message from a 6LN to create, refresh, and delete the corresponding state in the 6LBR.
   The exchange is protected by the retry mechanism specified in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc6775#section-8.2.6">Section 8.2.6</a> of [<a class="xref" href="#RFC6775">RFC6775</a>]</span>, though in an LLN, a duration longer than
   the default value of the RetransTimer (RETRANS_TIMER)
 <span>[<a class="xref" href="#RFC4861">RFC4861</a>]</span> of 1 second may be necessary to
   cover the round-trip delay between the 6LR and the 6LBR.<a class="pilcrow" href="#section-4.3-1">¶</a></p>
<p id="section-4.3-2">
   RPL <span>[<a class="xref" href="#RFC6550">RFC6550</a>]</span> specifies a periodic DAO from the 6LN all the way to
   the root that maintains the routing state in the RPL network for the lifetime
   indicated by the source of the DAO.
   This means that for each address, there are two keep-alive messages
   that traverse the whole network: one to the root and one to the 6LBR.<a class="pilcrow" href="#section-4.3-2">¶</a></p>
<p id="section-4.3-3">

   This specification avoids the periodic EDAR/EDAC exchange across the LLN.
   The 6LR turns
   the periodic NS(EARO) from the RUL into a DAO message to the
   root on every refresh, but it only generates the EDAR upon the first
   registration, for the purpose of DAD, which must be verified before the
   address is injected in RPL.
   Upon the DAO message, the root proxies the EDAR exchange to refresh the state at the 6LBR on behalf of the 6LR, as illustrated in <a class="xref" href="#fReg2">Figure 8</a> in <a class="xref" href="#flow">Section 9.1</a>.<a class="pilcrow" href="#section-4.3-3">¶</a></p>
<div id="R7400">
<section id="section-4.3.1">
          <h4 id="name-capability-indication-optio">
<a class="section-number selfRef" href="#section-4.3.1">4.3.1. </a><a class="section-name selfRef" href="#name-capability-indication-optio">Capability Indication Option per RFC 7400</a>
          </h4>
<p id="section-4.3.1-1">
   "<a class="xref" href="#RFC7400">6LoWPAN-GHC: Generic Header Compression for IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs)</a>" <span>[<a class="xref" href="#RFC7400">RFC7400</a>]</span>
   defines the 6LoWPAN Capability Indication Option (6CIO), which enables a node to expose its
   capabilities in Router Advertisement (RA) messages.<a class="pilcrow" href="#section-4.3.1-1">¶</a></p>
<p id="section-4.3.1-2">
   <span>[<a class="xref" href="#RFC8505">RFC8505</a>]</span> defines a number of bits in the 6CIO; in particular:<a class="pilcrow" href="#section-4.3.1-2">¶</a></p>
<span class="break"></span><dl class="dlParallel dlCompact" id="section-4.3.1-3">
            <dt id="section-4.3.1-3.1">L:</dt>
            <dd id="section-4.3.1-3.2" style="margin-left: 2.0em">The node is a 6LR.<a class="pilcrow" href="#section-4.3.1-3.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.1-3.3">E:</dt>
            <dd id="section-4.3.1-3.4" style="margin-left: 2.0em">The node is an IPv6 ND Registrar -- i.e., it supports
        registrations based on EARO.<a class="pilcrow" href="#section-4.3.1-3.4">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.1-3.5">P:</dt>
            <dd id="section-4.3.1-3.6" style="margin-left: 2.0em">The node is a Routing Registrar -- i.e., an IPv6 ND Registrar
         that also provides reachability services for the Registered Address.<a class="pilcrow" href="#section-4.3.1-3.6">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<span id="name-6cio-flags"></span><div id="CIO">
<figure id="figure-3">
            <div class="artwork art-text alignCenter" id="section-4.3.1-4.1">
<pre>    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Type      |   Length = 1  |     Reserved      |D|L|B|P|E|G|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                           Reserved                            |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</pre>
</div>
<figcaption><a class="selfRef" href="#figure-3">Figure 3</a>:
<a class="selfRef" href="#name-6cio-flags">6CIO Flags</a>
            </figcaption></figure>
</div>
<p id="section-4.3.1-5">

    A 6LR that provides reachability services for a RUL in a RPL network
    as specified in this document includes a 6CIO in its RA messages and
    set the L, P, and E flags to 1 as prescribed by <span>[<a class="xref" href="#RFC8505">RFC8505</a>]</span>;
    this is fully explained in <a class="xref" href="#oper">Section 9.2</a>.<a class="pilcrow" href="#section-4.3.1-5">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="prereq">
<section id="section-5">
      <h2 id="name-requirements-for-the-rpl-un">
<a class="section-number selfRef" href="#section-5">5. </a><a class="section-name selfRef" href="#name-requirements-for-the-rpl-un">Requirements for the RPL-Unaware Leaf</a>
      </h2>
<p id="section-5-1">
   This document describes how RPL routing can be extended to reach a RUL.
   This section specifies the minimal RPL-independent functionality that the RUL
   needs to implement in order to obtain routing services for its addresses.<a class="pilcrow" href="#section-5-1">¶</a></p>
<div id="prereq6lp">
<section id="section-5.1">
        <h3 id="name-support-of-6lowpan-nd">
<a class="section-number selfRef" href="#section-5.1">5.1. </a><a class="section-name selfRef" href="#name-support-of-6lowpan-nd">Support of 6LoWPAN ND</a>
        </h3>
<p id="section-5.1-1">
   To obtain routing services from a router that implements this specification,
   a RUL needs to implement <span>[<a class="xref" href="#RFC8505">RFC8505</a>]</span> and sets the "R" and "T"
   flags in the EARO to 1 as discussed in Sections <a class="xref" href="#R8505ER">4.2.1</a> and
   <a class="xref" href="#R8505ETID">4.2.2</a>, respectively. <a class="xref" href="#ln">Section 9.2.1</a> specifies new behaviors for the RUL, e.g., when the R flag set to 1 in an NS(EARO) is not echoed in the NA(EARO), which indicates that the route injection failed.<a class="pilcrow" href="#section-5.1-1">¶</a></p>
<p id="section-5.1-2">
   The RUL is expected to request routing services from a router only if that router originates RA messages with a 6CIO that has the L, P, and E flags all set to 1
   as discussed in <a class="xref" href="#R7400">Section 4.3.1</a>, unless configured to do so.
   It is suggested that the RUL also implement
   <span>[<a class="xref" href="#RFC8928">RFC8928</a>]</span> to protect the ownership of its addresses.<a class="pilcrow" href="#section-5.1-2">¶</a></p>
<p id="section-5.1-3">
   A RUL that may attach to multiple 6LRs is expected to prefer those that provide routing services.
   The RUL needs to register with all the 6LRs from which it desires routing services.<a class="pilcrow" href="#section-5.1-3">¶</a></p>
<p id="section-5.1-4">
   Parallel Address Registrations to several 6LRs should be performed in a rapid sequence, using the same EARO for the same address. Gaps between
   the Address Registrations will invalidate some of the routes until the Address
   Registration finally shows on those routes.<a class="pilcrow" href="#section-5.1-4">¶</a></p>
<p id="section-5.1-5"><span>[<a class="xref" href="#RFC8505">RFC8505</a>]</span> introduces error Status values in the NA(EARO)
   that can be received synchronously upon an NS(EARO) or asynchronously. The
   RUL needs to support both cases and refrain from using the address
   when the Status value indicates a rejection (see <a class="xref" href="#stat">Section 6.3</a>).<a class="pilcrow" href="#section-5.1-5">¶</a></p>
</section>
</div>
<div id="prereqv6ip">
<section id="section-5.2">
        <h3 id="name-support-of-ipv6-encapsulati">
<a class="section-number selfRef" href="#section-5.2">5.2. </a><a class="section-name selfRef" href="#name-support-of-ipv6-encapsulati">Support of IPv6 Encapsulation</a>
        </h3>
<p id="section-5.2-1">
   <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9008#section-4.1.1">Section 4.1.1</a> of [<a class="xref" href="#RFC9008">RFC9008</a>]</span> defines the rules
   for signaling an external destination (e.g., a RUL) and tunneling to its 
   attachment router (designated as a 6LR). In order to terminate the IPv6-in-IPv6
   tunnel, the RUL, as an IPv6 host, would have to be capable of decapsulating
   the tunneled packet and either drop the encapsulated packet if it is not the
   final destination or pass it to the upper layer for further processing.
   As indicated in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9008#section-4.1">Section 4.1</a> of [<a class="xref" href="#RFC9008">RFC9008</a>]</span>,
   this is not mandated by <span>[<a class="xref" href="#RFC8504">RFC8504</a>]</span>, and the IPv6-in-IPv6 tunnel
   from the root is terminated at the parent 6LR. It is thus not necessary
   for a RUL to support IPv6-in-IPv6 decapsulation.<a class="pilcrow" href="#section-5.2-1">¶</a></p>
</section>
</div>
<div id="prereqv6hh">
<section id="section-5.3">
        <h3 id="name-support-of-the-hop-by-hop-h">
<a class="section-number selfRef" href="#section-5.3">5.3. </a><a class="section-name selfRef" href="#name-support-of-the-hop-by-hop-h">Support of the Hop-by-Hop Header</a>
        </h3>
<p id="section-5.3-1">
   A RUL is expected to process an Option Type in a Hop-by-Hop Header as
   prescribed by <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8200#section-4.2">Section 4.2</a> of [<a class="xref" href="#RFC8200">RFC8200</a>]</span>.
   An RPI with an Option Type of 0x23 <span>[<a class="xref" href="#RFC9008">RFC9008</a>]</span> is thus skipped when not recognized.<a class="pilcrow" href="#section-5.3-1">¶</a></p>
</section>
</div>
<div id="prereqv6rh">
<section id="section-5.4">
        <h3 id="name-support-of-the-routing-head">
<a class="section-number selfRef" href="#section-5.4">5.4. </a><a class="section-name selfRef" href="#name-support-of-the-routing-head">Support of the Routing Header</a>
        </h3>
<p id="section-5.4-1">
   A RUL is expected to process an unknown Routing Header Type as
   prescribed by <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8200#section-4.4">Section 4.4</a> of [<a class="xref" href="#RFC8200">RFC8200</a>]</span>.
   This implies that the SRH, which has a Routing Type of 3
   <span>[<a class="xref" href="#RFC6554">RFC6554</a>]</span>, is ignored when Segments Left is zero.
   When Segments Left is non-zero, the RUL discards the packet and
   sends an ICMP Parameter Problem message with Code 0 to the packet's
   source address, pointing to the unrecognized Routing Type.<a class="pilcrow" href="#section-5.4-1">¶</a></p>
</section>
</div>
</section>
</div>
<div id="upd">
<section id="section-6">
      <h2 id="name-enhancements-to-rfc-6550">
<a class="section-number selfRef" href="#section-6">6. </a><a class="section-name selfRef" href="#name-enhancements-to-rfc-6550">Enhancements to RFC 6550</a>
      </h2>
<p id="section-6-1">
   This document specifies a new behavior whereby a 6LR injects DAO messages
   for unicast addresses (see <a class="xref" href="#op">Section 9</a>) and multicast addresses
   (see <a class="xref" href="#multiop">Section 10</a>) on behalf of leaves that are not aware of RPL.
   The RUL addresses are exposed as external targets <span>[<a class="xref" href="#RFC6550">RFC6550</a>]</span>.
   Conforming to
   <span>[<a class="xref" href="#RFC9008">RFC9008</a>]</span>, IPv6-in-IPv6 encapsulation between the 6LR and the RPL DODAG root is used to carry the RPL artifacts and remove them when forwarding outside the RPL domain, e.g., to a RUL.<a class="pilcrow" href="#section-6-1">¶</a></p>
<p id="section-6-2">
   This document also synchronizes the liveness monitoring at the root and the
   6LBR. The same lifetime value is used for both, and a single keep-alive
   message, the RPL DAO, traverses the RPL network. Another new behavior is introduced
   whereby the RPL DODAG root proxies the EDAR message to the 6LBR on behalf of the
   6LR (see <a class="xref" href="#upd2">Section 8</a>), for any leaf node that implements the
   6LN functionality described in <span>[<a class="xref" href="#RFC8505">RFC8505</a>]</span>.<a class="pilcrow" href="#section-6-2">¶</a></p>
<p id="section-6-3">
   <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc6550#section-6.7.7">Section 6.7.7</a> of [<a class="xref" href="#RFC6550">RFC6550</a>]</span> introduces the RPL Target option,
   which can be used in RPL control messages such as the DAO message to signal a
   destination prefix. This document adds capabilities for
   transporting the ROVR field (see <a class="xref" href="#R8505EROVR">Section 4.2.3</a>) and the
   IPv6 address of the prefix advertiser when the Target is a shorter prefix.
   Their use is signaled by a new ROVR Size field being non-zero
   and a new "Advertiser address in Full (F)" flag set to 1, respectively; see <a class="xref" href="#tgt">Section 6.1</a>.<a class="pilcrow" href="#section-6-3">¶</a></p>
<p id="section-6-4">
   This specification defines a new flag, "Root Proxies EDAR/EDAC (P)", in the
   RPL DODAG Configuration option; see <a class="xref" href="#pflag">Section 6.2</a>.<a class="pilcrow" href="#section-6-4">¶</a></p>
<p id="section-6-5">
 Furthermore, this
   specification provides the ability to carry the EARO Status defined for 6LoWPAN ND
   in RPL DAO and DCO messages, embedded in a RPL Status; see
   <a class="xref" href="#stat">Section 6.3</a>.<a class="pilcrow" href="#section-6-5">¶</a></p>
<p id="section-6-6">
    <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc6550#section-12">Section 12</a> of [<a class="xref" href="#RFC6550">RFC6550</a>]</span> details RPL support for
    multicast flows when the RPL Instance is operated with a MOP setting of 3
    ("Storing Mode of Operation with multicast support").
    This specification extends the RPL DODAG root operation to proxy-relay the MLDv2 operation <span>[<a class="xref" href="#RFC3810">RFC3810</a>]</span> between the RUL and the 6LR; see <a class="xref" href="#multiop">Section 10</a>.<a class="pilcrow" href="#section-6-6">¶</a></p>
<div id="tgt">
<section id="section-6.1">
        <h3 id="name-updated-rpl-target-option">
<a class="section-number selfRef" href="#section-6.1">6.1. </a><a class="section-name selfRef" href="#name-updated-rpl-target-option">Updated RPL Target Option</a>
        </h3>
<p id="section-6.1-1"> This specification updates the RPL Target option to transport the ROVR
    that was also defined for 6LoWPAN ND messages.
    This enables the RPL DODAG root to generate the proxied EDAR message to the 6LBR.<a class="pilcrow" href="#section-6.1-1">¶</a></p>
<p id="section-6.1-2">
   The Target Prefix of the RPL Target option is left (high bit) justified and
   contains the advertised prefix; its size may be smaller than 128 when
   it indicates a prefix route. The Prefix Length field signals the number
   of bits that correspond to the advertised prefix; it is 128 for a
   host route or less in the case of a prefix route. This remains unchanged.<a class="pilcrow" href="#section-6.1-2">¶</a></p>
<p id="section-6.1-3">
   This specification defines the new 'F' flag. When it is set to 1, the size of
   the Target Prefix field <span class="bcp14">MUST</span> be 128 bits and it <span class="bcp14">MUST</span> contain an IPv6 address
   of the advertising node taken from the advertised prefix. In that case, the
   Target Prefix field carries two distinct pieces of information: a route that
   can be a host route or a prefix route, depending on the Prefix Length; and an
   IPv6 address that can be used to reach the advertising node and validate the
   route.<a class="pilcrow" href="#section-6.1-3">¶</a></p>
<p id="section-6.1-4">
   If the 'F' flag is set to 0, the Target Prefix field can be shorter than
   128 bits, and it <span class="bcp14">MUST</span> be aligned to the next byte boundary after the end of
   the prefix.
   Any additional bits in the rightmost octet are filled with padding bits.
   Padding bits are reserved and set to 0 as specified in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc6550#section-6.7.7">Section 6.7.7</a> of [<a class="xref" href="#RFC6550">RFC6550</a>]</span>.<a class="pilcrow" href="#section-6.1-4">¶</a></p>
<p id="section-6.1-5">
    With this specification, the ROVR is the remainder of the RPL Target option.
    The size of the ROVR is indicated in a new ROVR Size field that is encoded
    to map one to one with the Code Suffix in the EDAR message
    (see Table 4 of <span>[<a class="xref" href="#RFC8505">RFC8505</a>]</span>). The ROVR Size field is taken
    from the Flags field, which is an update to the "RPL Target Option Flags" IANA registry.<a class="pilcrow" href="#section-6.1-5">¶</a></p>
<p id="section-6.1-6">
    The updated format is illustrated in <a class="xref" href="#frpltgt">Figure 4</a>.
    It is backward compatible with the Target option defined in
    <span>[<a class="xref" href="#RFC6550">RFC6550</a>]</span>.
    It is recommended that the updated format be used as a replacement in new
    implementations in all MOPs in preparation for upcoming route ownership
    validation mechanisms based on the ROVR, unless the device or the network is
    so constrained that this is not feasible.<a class="pilcrow" href="#section-6.1-6">¶</a></p>
<span id="name-updated-target-option"></span><div id="frpltgt">
<figure id="figure-4">
          <div class="artwork art-text alignLeft" id="section-6.1-7.1">
<pre>   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |   Type = 0x05 | Option Length |F|X|Flg|ROVRsz | Prefix Length |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                                                               |
  |                Target Prefix (Variable Length)                |
  .                                                               .
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                                                               |
 ...            Registration Ownership Verifier (ROVR)           ...
  |                                                               |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</pre>
</div>
<figcaption><a class="selfRef" href="#figure-4">Figure 4</a>:
<a class="selfRef" href="#name-updated-target-option">Updated Target Option</a>
          </figcaption></figure>
</div>
<p id="section-6.1-8"> New fields:<a class="pilcrow" href="#section-6.1-8">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-6.1-9">
          <dt id="section-6.1-9.1">F:</dt>
          <dd id="section-6.1-9.2" style="margin-left: 2.0em"> 1-bit flag. Set to 1 to indicate that the Target Prefix field
    contains the complete (128-bit) IPv6 address of the advertising node.<a class="pilcrow" href="#section-6.1-9.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-9.3">X:</dt>
          <dd id="section-6.1-9.4" style="margin-left: 2.0em">
            <p id="section-6.1-9.4.1">1-bit flag. Set to 1 to request that the root perform a
    proxy EDAR/EDAC exchange.<a class="pilcrow" href="#section-6.1-9.4.1">¶</a></p>
<p id="section-6.1-9.4.2">The 'X' flag can only be set to 1 if the DODAG is
    operating in Non-Storing mode and if the root sets the "Root Proxies EDAR/EDAC
    (P)" flag to 1 in the DODAG Configuration option; see <a class="xref" href="#pflag">Section 6.2</a>.<a class="pilcrow" href="#section-6.1-9.4.2">¶</a></p>
<p id="section-6.1-9.4.3">
    The 'X' flag can be set for host routes to RULs and RANs; it can also be set
    for internal prefix routes if the 'F' flag is set, using the node's address
    in the Target Prefix field to form the EDAR, but it cannot be used otherwise.<a class="pilcrow" href="#section-6.1-9.4.3">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-9.5">Flg (Flags):</dt>
          <dd id="section-6.1-9.6" style="margin-left: 2.0em">  The 2 bits remaining unused in the Flags field
    are reserved for flags.  The field <span class="bcp14">MUST</span> be initialized to 0 by the sender
    and <span class="bcp14">MUST</span> be ignored by the receiver.<a class="pilcrow" href="#section-6.1-9.6">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-9.7">ROVRsz (ROVR Size):</dt>
          <dd id="section-6.1-9.8" style="margin-left: 2.0em">
            <p id="section-6.1-9.8.1"> Indicates the size of the ROVR.
        It <span class="bcp14">MUST</span> be set to 1, 2, 3, or 4, indicating a ROVR size of 64, 128, 192,
        or 256 bits, respectively.<a class="pilcrow" href="#section-6.1-9.8.1">¶</a></p>
<p id="section-6.1-9.8.2">
        If a legacy Target option is used, then the value must
        remain 0, as specified in <span>[<a class="xref" href="#RFC6550">RFC6550</a>]</span>.<a class="pilcrow" href="#section-6.1-9.8.2">¶</a></p>
<p id="section-6.1-9.8.3">
        In the case of a value above 4, the size of the ROVR is undetermined and
        this node cannot validate the ROVR; an implementation <span class="bcp14">SHOULD</span> propagate
        the whole Target option upwards as received to enable the verification
        by an ancestor that would support the upgraded ROVR.<a class="pilcrow" href="#section-6.1-9.8.3">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-9.9">Registration Ownership Verifier (ROVR):</dt>
          <dd id="section-6.1-9.10" style="margin-left: 2.0em">
                  This is the same field as in the EARO;
                  see <span>[<a class="xref" href="#RFC8505">RFC8505</a>]</span>.<a class="pilcrow" href="#section-6.1-9.10">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="pflag">
<section id="section-6.2">
        <h3 id="name-additional-flag-in-the-rpl-">
<a class="section-number selfRef" href="#section-6.2">6.2. </a><a class="section-name selfRef" href="#name-additional-flag-in-the-rpl-">Additional Flag in the RPL DODAG Configuration Option</a>
        </h3>
<p id="section-6.2-1">
   The DODAG Configuration option is defined in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc6550#section-6.7.6">Section 6.7.6</a> of [<a class="xref" href="#RFC6550">RFC6550</a>]</span>. Its purpose is extended to distribute configuration
   information affecting the construction and maintenance of the DODAG, as
   well as operational parameters for RPL on the DODAG, through the DODAG.

   This option was originally designed with four bit positions reserved for future use as flags.<a class="pilcrow" href="#section-6.2-1">¶</a></p>
<span id="name-dodag-configuration-option-"></span><div id="RPLDCO">
<figure id="figure-5">
          <div class="artwork art-text alignCenter" id="section-6.2-2.1">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Type = 0x04 |Opt Length = 14| |P| | |A|       ...           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                     +
                                |4 bits |</pre>
</div>
<figcaption><a class="selfRef" href="#figure-5">Figure 5</a>:
<a class="selfRef" href="#name-dodag-configuration-option-">DODAG Configuration Option (Partial View)</a>
          </figcaption></figure>
</div>
<p id="section-6.2-3">
   This specification defines a new flag, "Root Proxies EDAR/EDAC (P)".
   The 'P' flag is encoded
   in bit position 1 of the reserved flags in the DODAG Configuration option
   (counting from bit 0 as the most significant bit), and it is set to 0 in
   legacy implementations as specified in Sections <a class="relref" href="https://www.rfc-editor.org/rfc/rfc6550#section-20.14">20.14</a> and <a class="relref" href="https://www.rfc-editor.org/rfc/rfc6550#section-6.7.6">6.7.6</a> of <span>[<a class="xref" href="#RFC6550">RFC6550</a>]</span>, respectively.<a class="pilcrow" href="#section-6.2-3">¶</a></p>
<p id="section-6.2-4">
   The 'P' flag is set to 1 to indicate that the root performs the proxy
   operation, which implies that it supports this specification and the updated
   RPL Target option (see <a class="xref" href="#tgt">Section 6.1</a>).<a class="pilcrow" href="#section-6.2-4">¶</a></p>
<p id="section-6.2-5">
   <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9008#section-4.1.3">Section 4.1.3</a> of [<a class="xref" href="#RFC9008">RFC9008</a>]</span> updates
   <span>[<a class="xref" href="#RFC6550">RFC6550</a>]</span> to indicate that the definition of the flags applies
   to MOP values from zero (0) to six (6) only. For a MOP value of 7, the implementation <span class="bcp14">MUST</span> assume that the root
   performs the proxy operation.<a class="pilcrow" href="#section-6.2-5">¶</a></p>
<p id="section-6.2-6">
   The RPL DODAG Configuration option is typically placed in
   a DODAG Information Object (DIO) message. The DIO message propagates down the
   DODAG to form and then maintain its structure. The DODAG Configuration option
   is copied unmodified from parents to children.
   <span>[<a class="xref" href="#RFC6550">RFC6550</a>]</span> states that "Nodes other than the DODAG root <span class="bcp14">MUST NOT</span> modify this information when propagating the DODAG Configuration option."
   Therefore, a legacy parent propagates the 'P' flag as set by the root, and
   when the 'P' flag is set to 1, it is transparently flooded to all the nodes
   in the DODAG.<a class="pilcrow" href="#section-6.2-6">¶</a></p>
</section>
</div>
<div id="stat">
<section id="section-6.3">
        <h3 id="name-updated-rpl-status">
<a class="section-number selfRef" href="#section-6.3">6.3. </a><a class="section-name selfRef" href="#name-updated-rpl-status">Updated RPL Status</a>
        </h3>
<p id="section-6.3-1">The RPL Status is defined in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc6550#section-6.5.1">Section 6.5.1</a> of [<a class="xref" href="#RFC6550">RFC6550</a>]</span> for use in the DAO-ACK message. Values are assigned as follows:<a class="pilcrow" href="#section-6.3-1">¶</a></p>
<span id="name-rpl-status-per-rfc-6550"></span><div id="irplStatusbl">
<table class="center" id="table-1">
          <caption>
<a class="selfRef" href="#table-1">Table 1</a>:
<a class="selfRef" href="#name-rpl-status-per-rfc-6550">RPL Status per RFC 6550</a>
          </caption>
<thead>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">Range</td>
              <td class="text-left" colspan="1" rowspan="1">Meaning</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">Success / Unqualified acceptance</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">1-127</td>
              <td class="text-left" colspan="1" rowspan="1">Not an outright rejection</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">128-255</td>
              <td class="text-left" colspan="1" rowspan="1">Rejection</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-6.3-3">

    The 6LoWPAN ND Status was defined for use in the EARO; see <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8505#section-4.1">Section 4.1</a> of [<a class="xref" href="#RFC8505">RFC8505</a>]</span>.
    This specification adds the ability to allow the carriage of 6LoWPAN ND
    Status values in RPL DAO and DCO messages, embedded in the RPL Status field.<a class="pilcrow" href="#section-6.3-3">¶</a></p>
<p id="section-6.3-4">
    To achieve this, the range of the ARO/EARO Status values is reduced to 0-63,
    which updates the IANA registry created for <span>[<a class="xref" href="#RFC6775">RFC6775</a>]</span>.
    This reduction ensures that the values fit within a RPL Status as shown in
    <a class="xref" href="#rpst">Figure 6</a>. See Sections <a class="xref" href="#iana-aro">12.2</a>,
    <a class="xref" href="#iana-stats-nonrej">12.5</a>, and <a class="xref" href="#iana-stats-rej">12.6</a>
    for the respective IANA declarations.
    These updates are reasonable because the associated registry relies on
    the Standards Action policy <span>[<a class="xref" href="#RFC8126">RFC8126</a>]</span> for registration and only values up to 10 are currently allocated.<a class="pilcrow" href="#section-6.3-4">¶</a></p>
<span id="name-rpl-status-format"></span><div id="rpst">
<figure id="figure-6">
          <div class="artwork art-text alignCenter" id="section-6.3-5.1">
<pre>    0 1 2 3 4 5 6 7
   +-+-+-+-+-+-+-+-+
   |U|A|StatusValue|
   +-+-+-+-+-+-+-+-+</pre>
</div>
<figcaption><a class="selfRef" href="#figure-6">Figure 6</a>:
<a class="selfRef" href="#name-rpl-status-format">RPL Status Format</a>
          </figcaption></figure>
</div>
<p id="section-6.3-6"> This specification updates the RPL Status with the following subfields:<a class="pilcrow" href="#section-6.3-6">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-6.3-7">
          <dt id="section-6.3-7.1">U:</dt>
          <dd id="section-6.3-7.2" style="margin-left: 2.0em"> 1-bit flag. Set to 1 to indicate a rejection. When set to 0, a Status value of 0
    indicates Success / Unqualified acceptance and other values indicate "Not an
    outright rejection" as per RFC 6550.<a class="pilcrow" href="#section-6.3-7.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.3-7.3">A:</dt>
          <dd id="section-6.3-7.4" style="margin-left: 2.0em">1-bit flag. Indicates the type of the RPL Status value.<a class="pilcrow" href="#section-6.3-7.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.3-7.5">Status Value:</dt>
          <dd id="section-6.3-7.6" style="margin-left: 2.0em">
            <p id="section-6.3-7.6.1">6-bit unsigned integer.<a class="pilcrow" href="#section-6.3-7.6.1">¶</a></p>
<p id="section-6.3-7.6.2">If the 'A' flag is set to 1, this field transports a value defined for the
    6LoWPAN ND EARO Status.<a class="pilcrow" href="#section-6.3-7.6.2">¶</a></p>
<p id="section-6.3-7.6.3">
    When the 'A' flag is set to 0, this field transports a Status value defined
    for RPL.<a class="pilcrow" href="#section-6.3-7.6.3">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-6.3-8">
   When building a DCO or a DAO-ACK message upon an IPv6 ND NA or an EDAC message,
   the RPL DODAG root <span class="bcp14">MUST</span> copy the 6LoWPAN ND status code unchanged in the RPL Status Value field and set the 'A' flag to 1.
   The RPL DODAG root <span class="bcp14">MUST</span> set the 'U' flag to 1 for all rejection and unknown status codes.  The status codes in the 1-10 range <span>[<a class="xref" href="#RFC8505">RFC8505</a>]</span> are all considered rejections.<a class="pilcrow" href="#section-6.3-8">¶</a></p>
<p id="section-6.3-9">
   Reciprocally, upon a DCO or a DAO-ACK message from the RPL DODAG root with a RPL
   Status that has the 'A' flag set, the 6LR <span class="bcp14">MUST</span> copy the RPL Status value
   unchanged in the Status field of the EARO when generating an NA to the RUL.<a class="pilcrow" href="#section-6.3-9">¶</a></p>
</section>
</div>
</section>
</div>
<div id="updnpdao">
<section id="section-7">
      <h2 id="name-enhancements-to-rfc-9009">
<a class="section-number selfRef" href="#section-7">7. </a><a class="section-name selfRef" href="#name-enhancements-to-rfc-9009">Enhancements to RFC 9009</a>
      </h2>
<p id="section-7-1">
<span>[<a class="xref" href="#RFC9009">RFC9009</a>]</span> defines the DCO message for RPL Storing mode only, with a link-local scope. All nodes in the RPL network are expected to support the specification, since the message is processed hop by hop along the path that is being cleaned up.<a class="pilcrow" href="#section-7-1">¶</a></p>
<p id="section-7-2">
This specification extends the use of the DCO message to the Non-Storing MOP, whereby the DCO is sent end to end by the root directly to the RAN that injected the DAO message for the considered target. In that case, intermediate nodes do not need to support <span>[<a class="xref" href="#RFC9009">RFC9009</a>]</span>; they forward the DCO message as a plain IPv6 packet between the root and the RAN.<a class="pilcrow" href="#section-7-2">¶</a></p>
<p id="section-7-3">
In the case of a RUL, the 6LR that serves the RUL acts as the RAN that receives
the Non-Storing DCO.
This specification leverages the Non-Storing DCO between the root and the 6LR that serves as the attachment router for a RUL. A 6LR and a root that support this specification <span class="bcp14">MUST</span> implement the Non-Storing DCO.<a class="pilcrow" href="#section-7-3">¶</a></p>
</section>
</div>
<div id="upd2">
<section id="section-8">
      <h2 id="name-enhancements-to-rfcs-6775-a">
<a class="section-number selfRef" href="#section-8">8. </a><a class="section-name selfRef" href="#name-enhancements-to-rfcs-6775-a">Enhancements to RFCs 6775 and 8505</a>
      </h2>
<p id="section-8-1">
   This document updates <span>[<a class="xref" href="#RFC6775">RFC6775</a>]</span> and <span>[<a class="xref" href="#RFC8505">RFC8505</a>]</span>
   to reduce the range of the ARO/EARO Status values to 64 values. The two most significant (leftmost) bits of the original ND Status field are now reserved; they <span class="bcp14">MUST</span> be set to 0 by the sender and ignored by the receiver.<a class="pilcrow" href="#section-8-1">¶</a></p>
<p id="section-8-2">
   This document also updates the behavior of a 6LR acting as a RPL router and of a 6LN acting as a RUL in the 6LoWPAN ND Address Registration as follows:<a class="pilcrow" href="#section-8-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8-3.1">
   If the RPL DODAG root advertises the ability to proxy the EDAR/EDAC
   exchange to the 6LBR, the 6LR refrains from sending the keep-alive EDAR
   message. If it is separated from the 6LBR, the root regenerates the
   EDAR message to the 6LBR periodically, upon a DAO message that signals the liveliness of the address.<a class="pilcrow" href="#section-8-3.1">¶</a>
</li>
        <li class="normal" id="section-8-3.2">
   The use of the R flag is extended to the NA(EARO) to confirm whether the route was installed.<a class="pilcrow" href="#section-8-3.2">¶</a>
</li>
      </ul>
</section>
</div>
<div id="op">
<section id="section-9">
      <h2 id="name-protocol-operations-for-uni">
<a class="section-number selfRef" href="#section-9">9. </a><a class="section-name selfRef" href="#name-protocol-operations-for-uni">Protocol Operations for Unicast Addresses</a>
      </h2>
<p id="section-9-1">

  The description below assumes that the root sets the 'P' flag in the
  DODAG Configuration option and performs the EDAR proxy operation presented in
  <a class="xref" href="#R8505D">Section 4.3</a>.<a class="pilcrow" href="#section-9-1">¶</a></p>
<p id="section-9-2">
  If the 'P' flag is set to 0, the 6LR <span class="bcp14">MUST</span> generate the periodic EDAR messages and
  process the returned status as specified in <span>[<a class="xref" href="#RFC8505">RFC8505</a>]</span>.
  If the EDAC indicates success, the rest of the flow takes place as presented
  but without the proxied EDAR/EDAC exchange.<a class="pilcrow" href="#section-9-2">¶</a></p>
<p id="section-9-3">
  <a class="xref" href="#flow">Section 9.1</a> provides an overview of the route injection in RPL, whereas <a class="xref" href="#oper">Section 9.2</a> offers more details from the perspective of the
  different nodes involved in the flow.<a class="pilcrow" href="#section-9-3">¶</a></p>
<div id="flow">
<section id="section-9.1">
        <h3 id="name-general-flow">
<a class="section-number selfRef" href="#section-9.1">9.1. </a><a class="section-name selfRef" href="#name-general-flow">General Flow</a>
        </h3>
<p id="section-9.1-1">
   This specification eliminates the need to exchange keep-alive EDAR and EDAC messages all the way from a 6LN to the 6LBR across a RPL mesh.
 Instead, the EDAR/EDAC exchange with the 6LBR is proxied
   by the RPL DODAG root upon the DAO message that refreshes the RPL routing state.
   The first EDAR upon a new Address Registration cannot be proxied, though, as it
   is generated for the purpose of DAD, which must be verified before the address is
   injected in RPL.<a class="pilcrow" href="#section-9.1-1">¶</a></p>
<p id="section-9.1-2">
   In a RPL
   network where the function is enabled, refreshing the state in the 6LBR is
   the responsibility of the root. Consequently, only addresses that are
   injected in RPL will be kept alive at the 6LBR by the RPL DODAG root.
   Since RULs are advertised using Non-Storing mode, the DAO message flow
   and the keep-alive EDAR/EDAC can be nested within the Address
   (re)Registration flow.
   <a class="xref" href="#fReg1">Figure 7</a> illustrates that, for the first Address Registration,
   both the DAD and the keep-alive EDAR⁠/EDAC exchanges happen in the same
   sequence.<a class="pilcrow" href="#section-9.1-2">¶</a></p>
<span id="name-first-rul-registration-flow"></span><div id="fReg1">
<figure id="figure-7">
          <div class="artwork art-text alignCenter" id="section-9.1-3.1">
<pre>   6LN/RUL            6LR   &lt;6LR*&gt;   Root               6LBR
      |&lt;---Using ND---&gt;|&lt;--Using RPL-&gt;|&lt;-----Using ND----&gt;|
      |                |&lt;-----------Using ND-------------&gt;|
      |                |              |                   |
      |   NS(EARO)     |              |                   |
      |---------------&gt;|                                  |
      |                |            EDAR                  |
      |                |---------------------------------&gt;|
      |                |                                  |
      |                |             EDAC                 |
      |                |&lt;---------------------------------|
      |                |                                  |
      |                |   DAO(X=0)   |                   |
      |                |-------------&gt;|                   |
      |                |                                  |
      |                |    DAO-ACK   |                   |
      |                |&lt;-------------|                   |
      |   NA(EARO)     |              |                   |
      |&lt;---------------|              |                   |
      |                |              |                   |</pre>
</div>
<figcaption><a class="selfRef" href="#figure-7">Figure 7</a>:
<a class="selfRef" href="#name-first-rul-registration-flow">First RUL Registration Flow</a>
          </figcaption></figure>
</div>
<p id="section-9.1-4">
   This flow requires that the lifetimes and sequence counters in 6LoWPAN ND and RPL be aligned.<a class="pilcrow" href="#section-9.1-4">¶</a></p>
<p id="section-9.1-5">
   To achieve this, the Path
   Sequence and the Path Lifetime in the DAO message are taken from the
   Transaction ID and the Address Registration lifetime in the NS(EARO) message
   from the 6LN.<a class="pilcrow" href="#section-9.1-5">¶</a></p>
<p id="section-9.1-6">
   On the first Address Registration, illustrated in <a class="xref" href="#fReg1">Figure 7</a>
   for RPL Non-Storing mode, the EDAR/EDAC exchange takes place
   as prescribed by <span>[<a class="xref" href="#RFC8505">RFC8505</a>]</span>. If the exchange fails, the 6LR returns an NA message with a non-zero status to the 6LN, the NCE is not created, and the address is not injected in RPL.

   Otherwise, the 6LR creates an NCE and injects the Registered
   Address in the RPL routing using a DAO/DAO-ACK exchange with the RPL DODAG
   root.<a class="pilcrow" href="#section-9.1-6">¶</a></p>
<p id="section-9.1-7">
    An Address Registration refresh is performed by the 6LN to keep the NCE
    in the 6LR alive before the lifetime expires. Upon the refresh of a
    registration, the 6LR reinjects the corresponding route in RPL before it expires, as illustrated in <a class="xref" href="#fReg2">Figure 8</a>.<a class="pilcrow" href="#section-9.1-7">¶</a></p>
<span id="name-next-rul-registration-flow"></span><div id="fReg2">
<figure id="figure-8">
          <div class="artwork art-text alignCenter" id="section-9.1-8.1">
<pre>   6LN/RUL   &lt;-ND-&gt;   6LR   &lt;-RPL-&gt;  Root   &lt;-ND-&gt;      6LBR
      |                |              |                   |
      |   NS(EARO)     |              |                   |
      |---------------&gt;|              |                   |
      |                |   DAO(X=1)   |                   |
      |                |-------------&gt;|                   |
      |                |              |       EDAR        |
      |                |              |------------------&gt;|
      |                |              |       EDAC        |
      |                |              |&lt;------------------|
      |                |    DAO-ACK   |                   |
      |                |&lt;-------------|                   |
      |   NA(EARO)     |              |                   |
      |&lt;---------------|              |                   |</pre>
</div>
<figcaption><a class="selfRef" href="#figure-8">Figure 8</a>:
<a class="selfRef" href="#name-next-rul-registration-flow">Next RUL Registration Flow</a>
          </figcaption></figure>
</div>
<p id="section-9.1-9">
    This is what causes the RPL DODAG root to refresh the state in the 6LBR, using an
    EDAC message.
    In the case of an error in the proxied EDAR flow, the error is
    returned in the DAO-ACK using a RPL Status with the 'A' flag set to 1, which embeds
    a 6LoWPAN Status value as discussed in <a class="xref" href="#stat">Section 6.3</a>.<a class="pilcrow" href="#section-9.1-9">¶</a></p>
<p id="section-9.1-10">

    The 6LR may receive a requested DAO-ACK after it received an asynchronous
    Non-Storing DCO, but the non-zero status in the DCO supersedes a positive
    status in the DAO-ACK, regardless of the order in which they are received.
    Upon the DAO-ACK -- or the DCO, if one arrives first -- the 6LR responds to the
    RUL with an NA(EARO).<a class="pilcrow" href="#section-9.1-10">¶</a></p>
<p id="section-9.1-11">
   An issue may be detected later, e.g., the address moves to a different
   DODAG with the 6LBR attached to a different 6LoWPAN Backbone Router (6BBR);
   see Figure 5 in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8929#section-3.3">Section 3.3</a> of [<a class="xref" href="#RFC8929">RFC8929</a>]</span>.
   The 6BBR may send a negative ND Status, e.g., in an asynchronous NA(EARO)
   to the 6LBR.<a class="pilcrow" href="#section-9.1-11">¶</a></p>
<p id="section-9.1-12">
   <span>[<a class="xref" href="#RFC8929">RFC8929</a>]</span> expects that the 6LBR is co-located with the RPL DODAG root,  but if not, the 6LBR <span class="bcp14">MUST</span> forward the status code to the originator of the EDAR -- either the 6LR or the RPL DODAG root that proxies for it.
   The ND status code is mapped in a RPL Status value by the RPL DODAG root, and then back to an ND Status by the 6LR to the 6LN.
   Note that a legacy RAN that receives a Non-Storing DCO that it does not
   support will ignore it silently, as specified in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc6550#section-6">Section 6</a> of [<a class="xref" href="#RFC6550">RFC6550</a>]</span>. The result is that it will remain unaware that it is no longer reachable until its next RPL exchange happens. This situation will be cleared upon the next Non-Storing DAO
   exchange if the error is returned in a DAO-ACK.<a class="pilcrow" href="#section-9.1-12">¶</a></p>
<p id="section-9.1-13">

   <a class="xref" href="#fReg1.5">Figure 9</a> illustrates this in the case where the 6LBR and the root are not co-located, and the root proxies the EDAR/EDAC flow.<a class="pilcrow" href="#section-9.1-13">¶</a></p>
<span id="name-asynchronous-issue"></span><div id="fReg1.5">
<figure id="figure-9">
          <div class="artwork art-text alignCenter" id="section-9.1-14.1">
<pre>6LN/RUL  &lt;-ND-&gt;  6LR  &lt;-RPL-&gt;  Root  &lt;-ND-&gt;  6LBR  &lt;-ND-&gt;  6BBR
   |              |             |              |             |
   |              |             |              |   NA(EARO)  |
   |              |             |              |&lt;------------|
   |              |             |     EDAC     |             |
   |              |             |&lt;-------------|             |
   |              |     DCO     |              |             |
   |              |&lt;------------|              |             |
   |   NA(EARO)   |             |              |             |
   |&lt;-------------|             |              |             |
   |              |             |              |             |</pre>
</div>
<figcaption><a class="selfRef" href="#figure-9">Figure 9</a>:
<a class="selfRef" href="#name-asynchronous-issue">Asynchronous Issue</a>
          </figcaption></figure>
</div>
<p id="section-9.1-15">

   If the root does not proxy, then the EDAC with a non-zero status reaches the
   6LR directly. In that case, the 6LR <span class="bcp14">MUST</span> clean up the route using a DAO with
   a Lifetime of 0, and it <span class="bcp14">MUST</span> propagate the status back to the RUL in an NA(EARO) with the R flag set to 0.<a class="pilcrow" href="#section-9.1-15">¶</a></p>
<p id="section-9.1-16">
    The RUL may terminate the registration at any time by using a Registration
    Lifetime of 0.
    This specification requires that the RPL Target option transport the ROVR.
    This way, the same flow as the heartbeat flow is sufficient to inform the
    6LBR using the root as a proxy, as illustrated in <a class="xref" href="#fReg2">Figure 8</a>.<a class="pilcrow" href="#section-9.1-16">¶</a></p>
<p id="section-9.1-17">
All or any combination of the 6LR, the root, and the 6LBR might be
collapsed in a single node.<a class="pilcrow" href="#section-9.1-17">¶</a></p>
</section>
</div>
<div id="oper">
<section id="section-9.2">
        <h3 id="name-detailed-operation">
<a class="section-number selfRef" href="#section-9.2">9.2. </a><a class="section-name selfRef" href="#name-detailed-operation">Detailed Operation</a>
        </h3>
<p id="section-9.2-1">
 The following sections specify the behavior of (1) the 6LN acting as
 a RUL, (2) the 6LR acting as a border router and serving the
 6LN, (3) the RPL DODAG root, and (4) the 6LBR in the control flows that
 enable RPL routing back to the RUL, respectively.<a class="pilcrow" href="#section-9.2-1">¶</a></p>
<div id="ln">
<section id="section-9.2.1">
          <h4 id="name-perspective-of-the-6ln-acti">
<a class="section-number selfRef" href="#section-9.2.1">9.2.1. </a><a class="section-name selfRef" href="#name-perspective-of-the-6ln-acti">Perspective of the 6LN Acting as a RUL</a>
          </h4>
<p id="section-9.2.1-1">
  This specification builds on the operation of a 6LoWPAN ND-compliant
  6LN/RUL, which is expected to operate as follows:<a class="pilcrow" href="#section-9.2.1-1">¶</a></p>
<ol class="normal type-1" id="section-9.2.1-2" start="1" type="1">
<li id="section-9.2.1-2.1">
    The 6LN selects a 6LR that provides reachability services for a RUL. This
    is signaled by a 6CIO in the RA messages with the L, P, and E flags set to 1
    as prescribed by <span>[<a class="xref" href="#RFC8505">RFC8505</a>]</span>.<a class="pilcrow" href="#section-9.2.1-2.1">¶</a>
</li>
            <li id="section-9.2.1-2.2">
   The 6LN obtains an IPv6 global address, via either (1) Stateless Address Autoconfiguration (SLAAC) <span>[<a class="xref" href="#RFC4862">RFC4862</a>]</span> based on a Prefix
   Information Option (PIO) <span>[<a class="xref" href="#RFC4861">RFC4861</a>]</span> found in an RA message or
   (2) some other means, such as DHCPv6 <span>[<a class="xref" href="#RFC8415">RFC8415</a>]</span>.<a class="pilcrow" href="#section-9.2.1-2.2">¶</a>
</li>
            <li id="section-9.2.1-2.3">
   Once it has formed an address, the 6LN registers its address and refreshes its registration periodically, early enough
   within the lifetime of the previous Address Registration, as prescribed by
   <span>[<a class="xref" href="#RFC6775">RFC6775</a>]</span>, to refresh the NCE before the lifetime indicated
   in the EARO expires. It sets the T flag to 1 as prescribed in <span>[<a class="xref" href="#RFC8505">RFC8505</a>]</span>.
   The TID is incremented each time and wraps in a lollipop fashion (see
   <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8505#section-5.2.1">Section 5.2.1</a> of [<a class="xref" href="#RFC8505">RFC8505</a>]</span>, which is fully compatible with
   <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc6550#section-7.2">Section 7.2</a> of [<a class="xref" href="#RFC6550">RFC6550</a>]</span>).<a class="pilcrow" href="#section-9.2.1-2.3">¶</a>
</li>
            <li id="section-9.2.1-2.4">
   As stated in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8505#section-5.2">Section 5.2</a> of [<a class="xref" href="#RFC8505">RFC8505</a>]</span>, the 6LN can register
   with more than one 6LR at the same time.
In that case, all the fields in the EARO are set to the same value
for all of the parallel Address Registrations, with the exception
of the Registration Lifetime field and the R flag, which may be set to
different values.
The 6LN may cancel a subset of its registrations or may transfer a
   registration from one or more old 6LRs to one or more new 6LRs. To do
   so, the 6LN sends a series of NS(EARO) messages, all with the same TID,
   with a zero Registration Lifetime to the old 6LR(s) and
   with a non-zero Registration Lifetime to the new 6LR(s). In that process,
   the 6LN <span class="bcp14">SHOULD</span> send the NS(EARO) with a non-zero Registration Lifetime and
   ensure that at least one succeeds before it sends an NS(EARO) that
   terminates another registration. This avoids the churn related to transient
   route invalidation in the RPL network above the common parent of the
   involved 6LRs.<a class="pilcrow" href="#section-9.2.1-2.4">¶</a>
</li>
            <li id="section-9.2.1-2.5">
  Following <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8505#section-5.1">Section 5.1</a> of [<a class="xref" href="#RFC8505">RFC8505</a>]</span>,
  a 6LN acting as a RUL sets the R flag in the EARO of its registration(s)
  for which it requires routing services. If the R flag is not echoed in the
  NA, the RUL <span class="bcp14">MUST</span> assume that establishing the routing services via this 6LR
  failed, and it <span class="bcp14">SHOULD</span> attempt to use another 6LR.
  The RUL <span class="bcp14">SHOULD</span> ensure that one registration succeeds before setting the R flag to 0.  In the case of a conflict with the preceding rule regarding the lifetime, the rule regarding the lifetime has precedence.<a class="pilcrow" href="#section-9.2.1-2.5">¶</a>
</li>
            <li id="section-9.2.1-2.6">
   The 6LN may use any of the 6LRs to which it registered as the default
   gateway.
   Using a 6LR to which the 6LN is not registered may result in packets dropped
   at the 6LR by a Source Address Validation Improvement (SAVI) function <span>[<a class="xref" href="#RFC7039">RFC7039</a>]</span> and thus is not recommended.<a class="pilcrow" href="#section-9.2.1-2.6">¶</a>
</li>
          </ol>
<p id="section-9.2.1-3">
   Even without support for RPL, the RUL may be configured with an opaque value
   to be provided to the routing protocol. If the RUL has knowledge of the RPL
   Instance into which the packet should be injected, then it <span class="bcp14">SHOULD</span> set the Opaque
   field in the EARO to the RPLInstanceID; otherwise, it <span class="bcp14">MUST</span> leave the Opaque
   field as 0.<a class="pilcrow" href="#section-9.2.1-3">¶</a></p>
<p id="section-9.2.1-4">
   Regardless of the setting of the Opaque field, the 6LN <span class="bcp14">MUST</span> set the "I"
   field to 0 to signal "topological information to be passed to a routing
   process", as specified in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8505#section-5.1">Section 5.1</a> of [<a class="xref" href="#RFC8505">RFC8505</a>]</span>.<a class="pilcrow" href="#section-9.2.1-4">¶</a></p>
<p id="section-9.2.1-5">
   A RUL is not expected to produce RPL artifacts in the data packets, but it
   may do so. For instance, if the RUL has minimal awareness of the RPL
   Instance, then it can build an RPI. A RUL that places an RPI in a data packet
   <span class="bcp14">SHOULD</span> indicate the RPLInstanceID of the RPL Instance where the
   packet should be forwarded. It is up to the 6LR (e.g., by policy) to use the
   RPLInstanceID information provided by the RUL or rewrite it to the selected
   RPLInstanceID for forwarding inside the RPL domain.
   All the flags and the SenderRank field are set
   to 0 as specified by <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc6550#section-11.2">Section 11.2</a> of [<a class="xref" href="#RFC6550">RFC6550</a>]</span>.<a class="pilcrow" href="#section-9.2.1-5">¶</a></p>
</section>
</div>
<div id="lr">
<section id="section-9.2.2">
          <h4 id="name-perspective-of-the-6lr-acti">
<a class="section-number selfRef" href="#section-9.2.2">9.2.2. </a><a class="section-name selfRef" href="#name-perspective-of-the-6lr-acti">Perspective of the 6LR Acting as a Border Router</a>
          </h4>
<p id="section-9.2.2-1">
    A 6LR that provides reachability services for a RUL in a RPL network
    as specified in this document <span class="bcp14">MUST</span> include a 6CIO in its RA messages and
    set the L, P, and E flags to 1 as prescribed by <span>[<a class="xref" href="#RFC8505">RFC8505</a>]</span>.<a class="pilcrow" href="#section-9.2.2-1">¶</a></p>
<p id="section-9.2.2-2">
   As prescribed by <span>[<a class="xref" href="#RFC8505">RFC8505</a>]</span>,
   the 6LR generates an EDAR message upon reception of a valid NS(EARO)
   message for the registration of a new IPv6 address by a 6LN.
   If the initial EDAR/EDAC exchange succeeds, then the 6LR installs an NCE
   for the Registration Lifetime.<a class="pilcrow" href="#section-9.2.2-2">¶</a></p>
<p id="section-9.2.2-3">
   If the R flag is set to 1 in the NS(EARO), the 6LR <span class="bcp14">SHOULD</span> inject the
   host route in RPL, unless this is barred for other reasons, such as the saturation of the RPL parents. The 6LR <span class="bcp14">MUST</span> use RPL Non-Storing mode
   signaling and the updated Target option (see <a class="xref" href="#tgt">Section 6.1</a>). To avoid a
redundant EDAR/EDAC flow to the 6LBR, the 6LR <span class="bcp14">SHOULD</span> refrain from setting the 'X' flag.
 The 6LR <span class="bcp14">MUST</span> request a DAO-ACK by setting the 'K' flag in the
   DAO message. Successfully injecting the route to the RUL's address will be indicated via
   the 'U' flag set to 0 in the RPL Status of the DAO-ACK message.<a class="pilcrow" href="#section-9.2.2-3">¶</a></p>
<p id="section-9.2.2-4">
   For the registration refreshes, if the RPL DODAG root sets the 'P' flag in the DODAG Configuration option to 1, then the 6LR <span class="bcp14">MUST</span> refrain from sending the keep-alive EDAR; instead, it <span class="bcp14">MUST</span> set the 'X' flag to 1 in the Target option of the DAO messages, to request that the root proxy the keep-alive EDAR/EDAC exchange with the 6LBR (see <a class="xref" href="#upd">Section 6</a>); if the 'P' flag is set to 0,
   then the 6LR <span class="bcp14">MUST</span> set the 'X' flag to 0 and handle the EDAR/EDAC flow itself.<a class="pilcrow" href="#section-9.2.2-4">¶</a></p>
<p id="section-9.2.2-5">
   The Opaque field in the EARO provides a means to signal which RPL Instance is to be used for the DAO advertisements and the forwarding of packets sourced at the Registered Address when there is no RPI in the packet.<a class="pilcrow" href="#section-9.2.2-5">¶</a></p>
<p id="section-9.2.2-6">
   As described in <span>[<a class="xref" href="#RFC8505">RFC8505</a>]</span>, if the "I" field is 0, then the Opaque field is expected to carry the RPLInstanceID suggested by the 6LN; otherwise, there is no suggested RPL Instance.
   If the 6LR participates in the suggested RPL Instance, then the
   6LR <span class="bcp14">MUST</span> use that RPL Instance for the Registered Address.<a class="pilcrow" href="#section-9.2.2-6">¶</a></p>
<p id="section-9.2.2-7">
   If there is no suggested RPL Instance or if the 6LR does not participate in 
the suggested RPL Instance, it is expected that the packets coming from the 6LN "can unambiguously be associated to at least one RPL Instance" <span>[<a class="xref" href="#RFC6550">RFC6550</a>]</span> by the 6LR, e.g., using a policy that
   maps the 6-tuple to a RPL Instance.<a class="pilcrow" href="#section-9.2.2-7">¶</a></p>
<p id="section-9.2.2-8">
  The DAO message advertising the Registered Address <span class="bcp14">MUST</span> be constructed as
  follows:<a class="pilcrow" href="#section-9.2.2-8">¶</a></p>
<ol class="normal type-1" id="section-9.2.2-9" start="1" type="1">
  <li id="section-9.2.2-9.1">The Registered Address is signaled as the Target Prefix in the updated Target option in the DAO message; the Prefix Length is set to 128 but the 'F' flag is set to 0, since the advertiser is not the RUL. The ROVR field is copied unchanged from the EARO (see <a class="xref" href="#tgt">Section 6.1</a>).<a class="pilcrow" href="#section-9.2.2-9.1">¶</a>
</li>
            <li id="section-9.2.2-9.2">
  The 6LR indicates one of its global or unique-local IPv6 unicast addresses as the Parent Address in the TIO associated with the Target option.<a class="pilcrow" href="#section-9.2.2-9.2">¶</a>
</li>
            <li id="section-9.2.2-9.3">
  The 6LR sets the External ('E') flag in the TIO to indicate that it is redistributing
  an external target into the RPL network.<a class="pilcrow" href="#section-9.2.2-9.3">¶</a>
</li>
            <li id="section-9.2.2-9.4">
              <p id="section-9.2.2-9.4.1">
  The Path Lifetime in the TIO is computed from the Registration Lifetime in the EARO. This operation converts seconds to the Lifetime Units used in the RPL operation. This creates the deployment constraint that the Lifetime Unit is reasonably compatible with the expression of the Registration Lifetime; e.g., a Lifetime Unit of 0x4000 maps the most significant byte of the Registration Lifetime to the Path Lifetime.<a class="pilcrow" href="#section-9.2.2-9.4.1">¶</a></p>
<p id="section-9.2.2-9.4.2">
  In that operation, the Path Lifetime must be set to ensure that the path has a longer lifetime than the registration and also covers the round-trip time to the root.<a class="pilcrow" href="#section-9.2.2-9.4.2">¶</a></p>
<p id="section-9.2.2-9.4.3">
  Note that if the Registration Lifetime is 0, then the Path Lifetime is also 0 and the DAO message becomes a No-Path DAO, which cleans up the routes down to the RUL's address; this also causes the root as a proxy to send an EDAR message to the 6LBR with a Lifetime of 0.<a class="pilcrow" href="#section-9.2.2-9.4.3">¶</a></p>
</li>
            <li id="section-9.2.2-9.5">
  The Path Sequence in the TIO is set to the TID value found in the EARO.<a class="pilcrow" href="#section-9.2.2-9.5">¶</a>
</li>
          </ol>
<p id="section-9.2.2-10">

   Upon receiving or timing out the DAO-ACK after an implementation-specific
   number of retries, the 6LR <span class="bcp14">MUST</span> send the corresponding NA(EARO) to the RUL.
   Upon receiving an asynchronous DCO message, it <span class="bcp14">MUST</span> send an asynchronous
   NA(EARO) to the RUL immediately but still be capable of processing the
   DAO-ACK if one is pending.<a class="pilcrow" href="#section-9.2.2-10">¶</a></p>
<p id="section-9.2.2-11">
The 6LR <span class="bcp14">MUST</span> set the R flag to 1 in the NA(EARO) that it sends back to the 6LN if and only if the 'U' flag in the RPL Status is set to 0, indicating that the 6LR injected the Registered Address in the RPL routing successfully and that the EDAR proxy operation succeeded.<a class="pilcrow" href="#section-9.2.2-11">¶</a></p>
<p id="section-9.2.2-12">

   If the 'A' flag in the RPL Status is set to 1, the embedded Status value is passed back to the RUL in the EARO Status.
   If the 'U' flag is also set to 1, the registration failed for
   6LoWPAN-ND-related reasons, and the NCE is removed.<a class="pilcrow" href="#section-9.2.2-12">¶</a></p>
<p id="section-9.2.2-13">

   An error injecting the route causes the 'U' flag to be set to 1. If the error is not related to ND, the 'A' flag is set to 0. In that case, the registration succeeds, but the RPL route is not installed. So, the NA(EARO) is returned
   with a status indicating success but the R flag set to 0, which means that
   the 6LN obtained a binding but no route.<a class="pilcrow" href="#section-9.2.2-13">¶</a></p>
<p id="section-9.2.2-14">
   If the 'A' flag is set to 0 in the RPL Status of the DAO-ACK, then the 6LoWPAN
   ND operation succeeded, and an EARO Status of 0 (Success) <span class="bcp14">MUST</span> be returned to
   the 6LN. The EARO Status of 0 <span class="bcp14">MUST</span> also be used if the 6LR did not attempt to inject the route but could create the binding after a successful EDAR/EDAC exchange or refresh it.<a class="pilcrow" href="#section-9.2.2-14">¶</a></p>
<p id="section-9.2.2-15">
   If the 'U' flag is set to 1 in the RPL Status of the DAO-ACK, then the route was not installed, and the R flag <span class="bcp14">MUST</span> be set to 0 in the NA(EARO). The R flag <span class="bcp14">MUST</span> be set to 0 if the 6LR did not attempt to inject the route.<a class="pilcrow" href="#section-9.2.2-15">¶</a></p>
<p id="section-9.2.2-16">
   In a network where Address-Protected Neighbor Discovery (AP-ND) is enabled,
   in the case of a DAO-ACK or a DCO transporting an EARO
   Status value of 5 (Validation Requested), the 6LR <span class="bcp14">MUST</span>
   challenge the 6LN for ownership of the address, as described in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8928#section-6.1">Section 6.1</a> of [<a class="xref" href="#RFC8928">RFC8928</a>]</span>, before the registration is
   complete. This flow, illustrated in <a class="xref" href="#Dynamic-fig">Figure 10</a>, ensures that the address is validated before it is injected in the RPL routing.<a class="pilcrow" href="#section-9.2.2-16">¶</a></p>
<span id="name-address-protection"></span><div id="Dynamic-fig">
<figure id="figure-10">
            <div class="artwork art-text alignLeft" id="section-9.2.2-17.1">
<pre>6LN                                       6LR        Root        6LBR
 |                                         |           |           |
 |&lt;--------------- RA ---------------------|           |           |
 |                                         |           |           |
 |------ NS(EARO) (ROVR=Crypto-ID) -------&gt;|           |           |
 |                                         |           |           |
 |&lt;-NA(EARO) (Status=Validation Requested)-|           |           |
 |                                         |           |           |
 |---- NS(EARO) and proof of ownership ---&gt;|           |           |
 |                                         |           |           |
 |                                &lt;validate the proof&gt; |           |
 |                                                     |           |
 |&lt;------- NA(EARO) (Status=10) -----&lt;if failed&gt;       |           |
 |                                                     |           |
 |                                       &lt;else&gt;        |           |
 |                                         |           |           |
 |                                         |--------- EDAR -------&gt;|
 |                                         |                       |
 |                                         |&lt;-------- EDAC --------|
 |                                         |                       |
 |                                         |           |           |
 |                                         |-DAO(X=0)-&gt;|           |
 |                                         |           |           |
 |                                         |&lt;- DAO-ACK-|           |
 |                                         |           |           |
 |&lt;---------- NA(EARO) (Status=0) ---------|           |           |
 |                                         |           |           |
                                     ...
 |                                         |           |           |
 |------ NS(EARO) (ROVR=Crypto-ID) -------&gt;|           |           |
 |                                         |-DAO(X=1)-&gt;|           |
 |                                         |           |-- EDAR --&gt;|
 |                                         |           |           |
 |                                         |           |&lt;-- EDAC --|
 |                                         |&lt;- DAO-ACK-|           |
 |&lt;---------- NA(EARO) (Status=0) ---------|           |           |
 |                                         |           |           |
                                     ...</pre>
</div>
<figcaption><a class="selfRef" href="#figure-10">Figure 10</a>:
<a class="selfRef" href="#name-address-protection">Address Protection</a>
            </figcaption></figure>
</div>
<p id="section-9.2.2-18">
   If the challenge succeeded, then the operations continue as normal.
   In particular, a DAO message is generated
   upon the NS(EARO) that proves the ownership of the address. If the challenge
   failed, the 6LR rejects the registration as prescribed by AP-ND and may take
   actions to protect itself against Denial-Of-Service (DoS) attacks by a rogue 6LN; see
   <a class="xref" href="#security-considerations">Section 11</a>.<a class="pilcrow" href="#section-9.2.2-18">¶</a></p>
<p id="section-9.2.2-19">
   The 6LR may, at any time, send a unicast asynchronous NA(EARO) with the R flag set to 0 to signal that it has stopped providing routing services, and/or with an EARO Status of 2 (Neighbor Cache Full) to signal that it removed the NCE. It may also send a final RA -- unicast or multicast -- with a router Lifetime field of 0, to signal that it will cease to serve as the router, as specified in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc4861#section-6.2.5">Section 6.2.5</a> of [<a class="xref" href="#RFC4861">RFC4861</a>]</span>. This may happen upon a
   DCO or a DAO-ACK message indicating that the path is already removed; otherwise, the
   6LR <span class="bcp14">MUST</span> remove the host route to the 6LN using a DAO message with a Path
   Lifetime of 0.<a class="pilcrow" href="#section-9.2.2-19">¶</a></p>
<p id="section-9.2.2-20">

   A valid NS(EARO) message with the R flag set to 0 and a Registration Lifetime that is not zero signals that the 6LN wishes to maintain the binding but does not require (i.e., no longer requires) the routing services from the 6LR.

   Upon this message, if, due to a previous NS(EARO) with the R flag set to 1 the
   6LR was injecting the host route to the Registered Address in RPL using DAO
   messages, then the 6LR <span class="bcp14">MUST</span> invalidate the host route in RPL using a DAO
   with a Path Lifetime of 0.

   It is up to the registering 6LN to maintain the corresponding route from then
   on, by either (1) keeping it active via a different 6LR or (2) acting as a RAN and managing its own reachability.<a class="pilcrow" href="#section-9.2.2-20">¶</a></p>
<p id="section-9.2.2-21">
   When forwarding a packet from the RUL into the RPL domain, if the packet does
   not have an RPI, the 6LR <span class="bcp14">MUST</span> encapsulate the packet to the root and add
   an RPI. If there is an RPI in the packet, the 6LR <span class="bcp14">MUST</span> rewrite the RPI, but it
   does not need to encapsulate.<a class="pilcrow" href="#section-9.2.2-21">¶</a></p>
</section>
</div>
<div id="Root">
<section id="section-9.2.3">
          <h4 id="name-perspective-of-the-rpl-doda">
<a class="section-number selfRef" href="#section-9.2.3">9.2.3. </a><a class="section-name selfRef" href="#name-perspective-of-the-rpl-doda">Perspective of the RPL DODAG Root</a>
          </h4>
<p id="section-9.2.3-1">
   A RPL DODAG root <span class="bcp14">MUST</span> set the 'P' flag to 1 in the RPL DODAG Configuration option of
   the DIO messages that it generates (see <a class="xref" href="#upd">Section 6</a>) to signal
   that it proxies the EDAR/EDAC exchange and supports the updated RPL Target
   option.<a class="pilcrow" href="#section-9.2.3-1">¶</a></p>
<p id="section-9.2.3-2">
   Upon reception of a DAO message, for each updated RPL Target option
   (see <a class="xref" href="#tgt">Section 6.1</a>) with the 'X' flag set to 1, the root <span class="bcp14">MUST</span> notify
   the 6LBR by using a proxied EDAR/EDAC exchange; if the RPL DODAG root and the 6LBR
   are integrated, an internal API can be used instead.<a class="pilcrow" href="#section-9.2.3-2">¶</a></p>
<p id="section-9.2.3-3">
  The EDAR message <span class="bcp14">MUST</span> be constructed as follows:<a class="pilcrow" href="#section-9.2.3-3">¶</a></p>
<ol class="normal type-1" id="section-9.2.3-4" start="1" type="1">
  <li id="section-9.2.3-4.1">
  The target IPv6 address from the RPL Target option is placed in the
  Registered Address field of the EDAR message;<a class="pilcrow" href="#section-9.2.3-4.1">¶</a>
</li>
            <li id="section-9.2.3-4.2">
  The Registration Lifetime is adapted from the Path Lifetime in the TIO by
  converting the Lifetime Units used in RPL into units of 60 seconds used in the
  6LoWPAN ND messages;<a class="pilcrow" href="#section-9.2.3-4.2">¶</a>
</li>
            <li id="section-9.2.3-4.3">
  The TID value is set to the Path Sequence in the TIO and indicated with an ICMP
  code of 1 in the EDAR message;<a class="pilcrow" href="#section-9.2.3-4.3">¶</a>
</li>
            <li id="section-9.2.3-4.4">
  The ROVR in the RPL Target option is copied as is in the
  EDAR, and the ICMP Code Suffix is set to the appropriate value as shown in
  Table 4 of <span>[<a class="xref" href="#RFC8505">RFC8505</a>]</span>, depending on the size of the ROVR field.<a class="pilcrow" href="#section-9.2.3-4.4">¶</a>
</li>
          </ol>
<p id="section-9.2.3-5">
   Upon receiving an EDAC message from the 6LBR, if a DAO is pending, then the
   root <span class="bcp14">MUST</span> send a DAO-ACK back to the 6LR. Otherwise, if the status in the EDAC message is not "Success", then it <span class="bcp14">MUST</span> send an asynchronous DCO to the 6LR.<a class="pilcrow" href="#section-9.2.3-5">¶</a></p>
<p id="section-9.2.3-6">
   In either case, the EDAC Status is embedded in the RPL Status with the 'A'
   flag set to 1.<a class="pilcrow" href="#section-9.2.3-6">¶</a></p>
<p id="section-9.2.3-7">
The proxied EDAR/EDAC exchange <span class="bcp14">MUST</span> be protected with a timer whose
appropriate duration and number of retries (1) are implementation dependent and (2) <span class="bcp14">SHOULD</span> be configurable, since the root and the 6LBR are
typically nodes with a higher capacity and manageability than 6LRs.
   Upon timing out, the root <span class="bcp14">MUST</span> send an error back to the 6LR as above, using either a DAO-ACK or a DCO, as appropriate, with the 'A' and 'U' flags set to 1 in the RPL Status, and a RPL Status value of "6LBR Registry Saturated" <span>[<a class="xref" href="#RFC8505">RFC8505</a>]</span>.<a class="pilcrow" href="#section-9.2.3-7">¶</a></p>
</section>
</div>
<div id="lbr">
<section id="section-9.2.4">
          <h4 id="name-perspective-of-the-6lbr">
<a class="section-number selfRef" href="#section-9.2.4">9.2.4. </a><a class="section-name selfRef" href="#name-perspective-of-the-6lbr">Perspective of the 6LBR</a>
          </h4>
<p id="section-9.2.4-1">
  The 6LBR is unaware that the RPL DODAG root is not the new attachment 6LR of the RUL,
  so it is not impacted by this specification.<a class="pilcrow" href="#section-9.2.4-1">¶</a></p>
<p id="section-9.2.4-2">
   Upon reception of an EDAR message,
   the 6LBR behaves as prescribed by <span>[<a class="xref" href="#RFC8505">RFC8505</a>]</span> and returns an EDAC message to the sender.<a class="pilcrow" href="#section-9.2.4-2">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="multiop">
<section id="section-10">
      <h2 id="name-protocol-operations-for-mul">
<a class="section-number selfRef" href="#section-10">10. </a><a class="section-name selfRef" href="#name-protocol-operations-for-mul">Protocol Operations for Multicast Addresses</a>
      </h2>
<p id="section-10-1"><span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc6550#section-12">Section 12</a> of [<a class="xref" href="#RFC6550">RFC6550</a>]</span> details RPL support for
    multicast flows. This support is activated by setting the MOP value to 3 ("Storing Mode of Operation with multicast support") in the DIO messages that form the DODAG. This section also applies if and only if the MOP of the RPL Instance is 3.<a class="pilcrow" href="#section-10-1">¶</a></p>
<p id="section-10-2">
    RPL support for multicast is not source specific and only operates as
    an extension to the Storing mode of operation for unicast packets.
    Note that
    it is the RPL model that the multicast packet is copied and transmitted as a Layer 2 unicast
    to each of the interested children.  This remains true when forwarding between the 6LR and the listener 6LN.<a class="pilcrow" href="#section-10-2">¶</a></p>
<p id="section-10-3">
    "<a class="xref" href="#RFC3810">Multicast Listener Discovery Version 2 (MLDv2) for IPv6</a>" <span>[<a class="xref" href="#RFC3810">RFC3810</a>]</span>
    provides an interface for a listener to register with multicast flows.
    In the MLD model, the router is a "querier", and the host is a multicast
    listener that registers with the querier to obtain copies of the particular
    flows it is interested in.<a class="pilcrow" href="#section-10-3">¶</a></p>
<p id="section-10-4">
     The equivalent of the first Address Registration happens as illustrated in <a class="xref" href="#fReg3">Figure 11</a>. The 6LN, as an MLD listener, sends an unsolicited Report to the 6LR. This enables it to start receiving the flow immediately and causes the 6LR to inject the multicast route in RPL.<a class="pilcrow" href="#section-10-4">¶</a></p>
<span id="name-first-multicast-registratio"></span><div id="fReg3">
<figure id="figure-11">
        <div class="artwork art-text alignLeft" id="section-10-5.1">
<pre>   6LN/RUL                6LR             Root                   6LBR
      |                    |               |                       |
      | unsolicited Report |               |                       |
      |-------------------&gt;|               |                       |
      |                    | DAO           |                       |
      |                    |--------------&gt;|                       |
      |                    |    DAO-ACK    |                       |
      |                    |&lt;--------------|                       |
      |                    |               | &lt;if not done already&gt; |
      |                    |               |  unsolicited Report   |
      |                    |               |----------------------&gt;|
      |                    |               |                       |</pre>
</div>
<figcaption><a class="selfRef" href="#figure-11">Figure 11</a>:
<a class="selfRef" href="#name-first-multicast-registratio">First Multicast Registration Flow</a>
        </figcaption></figure>
</div>
<p id="section-10-6"> This specification does not change MLD but will operate more efficiently
     if the asynchronous messages for unsolicited Report and Done are sent by
     the 6LN as Layer 2 unicast to the 6LR, particularly on wireless.<a class="pilcrow" href="#section-10-6">¶</a></p>
<p id="section-10-7">
     The 6LR acts as a generic MLD querier and generates a DAO with the multicast address as the Target Prefix as described in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc6550#section-12">Section 12</a> of [<a class="xref" href="#RFC6550">RFC6550</a>]</span>. As for the unicast host routes, the Path Lifetime associated to the Target is mapped from the Query Interval and is set to be larger, to account for variable propagation delays to the root.
     The root proxies the MLD exchange as a listener with the 6LBR acting as the
     querier, so as to get packets from a source external to the RPL domain.<a class="pilcrow" href="#section-10-7">¶</a></p>
<p id="section-10-8">
     Upon a DAO with a Target option for a multicast address, the RPL DODAG root checks to see if it is already registered as a listener for that address, and if not, it performs its own unsolicited Report for the multicast address as described in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc3810#section-6.1">Section 6.1</a> of [<a class="xref" href="#RFC3810">RFC3810</a>]</span>.  The Report is source independent, so there is no source address listed.<a class="pilcrow" href="#section-10-8">¶</a></p>
<p id="section-10-9">
    The equivalent of the registration refresh is pulled periodically by the 6LR acting as the querier. Upon the timing out of the Query Interval, the 6LR sends a Multicast Address Specific Query to each of its listeners, for each multicast address. The listeners respond with a Report. Based on the Reports, the 6LR maintains the aggregated list of all the multicast addresses for which there is a listener and advertises them using DAO messages as specified in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc6550#section-12">Section 12</a> of [<a class="xref" href="#RFC6550">RFC6550</a>]</span>. Optionally, the 6LR <span class="bcp14">MAY</span> send a General Query, where the Multicast Address field is set to 0. In that case, the multicast packet is passed as a Layer 2 unicast to each of the interested children.<a class="pilcrow" href="#section-10-9">¶</a></p>
<p id="section-10-10">
    Upon a Report, the 6LR generates a DAO with as many Target options as there are Multicast Address Records in the Report message, copying the
    Multicast Address field in the Target Prefix of the RPL Target option.
    The DAO message is a Storing mode DAO, passed to a selection of the 6LR's
    parents.<a class="pilcrow" href="#section-10-10">¶</a></p>
<p id="section-10-11">
    Asynchronously to this, a similar procedure happens between the root and a router, such as the 6LBR, that serves multicast flows on the link where the root is located. Again, the Query and Report messages are source independent. The root lists exactly once each multicast address for which it has at least one active multicast DAO state, copying the multicast address in the DAO state in the Multicast Address field of the
    Multicast Address Records in the Report message.<a class="pilcrow" href="#section-10-11">¶</a></p>
<p id="section-10-12">

    This is illustrated in <a class="xref" href="#fReg4">Figure 12</a>:<a class="pilcrow" href="#section-10-12">¶</a></p>
<span id="name-next-registration-flow"></span><div id="fReg4">
<figure id="figure-12">
        <div class="artwork art-text alignLeft" id="section-10-13.1">
<pre>   6LN/RUL                6LR             Root                6LBR
      |                    |               |                    |
      |       Query        |               |                    |
      |&lt;-------------------|               |                    |
      |       Report       |               |                    |
      |-------------------&gt;|               |                    |
      |                    | DAO           |                    |
      |                    |--------------&gt;|                    |
      |                    |    DAO-ACK    |                    |
      |                    |&lt;--------------|                    |
      |                    |               |       Query        |
      |                    |               |&lt;-------------------|
      |                    |               |       Report       |
      |                    |               |-------------------&gt;|
      |                    |               |                    |</pre>
</div>
<figcaption><a class="selfRef" href="#figure-12">Figure 12</a>:
<a class="selfRef" href="#name-next-registration-flow">Next Registration Flow</a>
        </figcaption></figure>
</div>
<p id="section-10-14">Note that all or any combination of the 6LR, the root, and the 6LBR might be
collapsed in a single node, in which case the flow above happens internally, and possibly
    through internal API calls as opposed to messaging.<a class="pilcrow" href="#section-10-14">¶</a></p>
</section>
</div>
<div id="security-considerations">
<section id="section-11">
      <h2 id="name-security-considerations">
<a class="section-number selfRef" href="#section-11">11. </a><a class="section-name selfRef" href="#name-security-considerations">Security Considerations</a>
      </h2>
<p id="section-11-1">
   It is worth noting that with <span>[<a class="xref" href="#RFC6550">RFC6550</a>]</span>, every
   node in the LLN is RPL aware and can inject any RPL-based attack in the
   network. This specification improves this situation by isolating edge nodes
    that can only interact with the RPL routers using 6LoWPAN ND, meaning that they cannot perform RPL insider attacks.<a class="pilcrow" href="#section-11-1">¶</a></p>
<p id="section-11-2">
        The LLN nodes depend on the 6LBR and the RPL participants for their
    operation.
        A trust model must be put in place to ensure that the right devices are
        acting in these roles, so as to avoid such threats as black-holing
        (see <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc7416#section-7">Section 7</a> of [<a class="xref" href="#RFC7416">RFC7416</a>]</span>),
    DoS attacks whereby a rogue 6LR creates a high churn in the RPL network by advertising and removing many forged addresses,
        or a bombing attack whereby an impersonated 6LBR would destroy state in
        the network by using a status code of 4 ("Removed") <span>[<a class="xref" href="#RFC8505">RFC8505</a>]</span>.<a class="pilcrow" href="#section-11-2">¶</a></p>
<p id="section-11-3">
    This trust model could be,
    at a minimum, based on Layer 2 secure joining and link-layer security.
    This is a generic 6LoWPAN requirement; see Req-5.1 in 
<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8505#appendix-B.5">Appendix B.5</a> of [<a class="xref" href="#RFC8505">RFC8505</a>]</span>.<a class="pilcrow" href="#section-11-3">¶</a></p>
<p id="section-11-4">
    In a general manner, the Security Considerations sections of <span>[<a class="xref" href="#RFC6550">RFC6550</a>]</span>,
    <span>[<a class="xref" href="#RFC7416">RFC7416</a>]</span>, <span>[<a class="xref" href="#RFC6775">RFC6775</a>]</span>, and <span>[<a class="xref" href="#RFC8505">RFC8505</a>]</span> apply to this specification as well.<a class="pilcrow" href="#section-11-4">¶</a></p>
<p id="section-11-5">
    In particular, link-layer security is needed to prevent
    DoS attacks whereby a rogue 6LN creates a high churn in the
    RPL network by constantly registering and deregistering addresses with the
    R flag set to 1 in the EARO.<a class="pilcrow" href="#section-11-5">¶</a></p>
<p id="section-11-6">
   <span>[<a class="xref" href="#RFC8928">RFC8928</a>]</span> updated 6LoWPAN ND with AP-ND. AP-ND protects the owner of an address against address theft and impersonation attacks in an LLN. Nodes supporting the extension compute a cryptographic identifier (Crypto-ID) and use it with one or more of their Registered Addresses. The Crypto-ID identifies the owner of the Registered Address and can be used to provide proof of ownership of the Registered Addresses. Once an address is registered with the Crypto‑ID and proof of ownership is provided, only the owner of that address can modify the registration information, thereby enforcing SAVI.
   <span>[<a class="xref" href="#RFC8928">RFC8928</a>]</span> reduces even further
   the attack perimeter that is available to the edge nodes,
   and its use is suggested in this specification.<a class="pilcrow" href="#section-11-6">¶</a></p>
<p id="section-11-7">
    Additionally, the trust model could include role validation (e.g., using
    role-based authorization) to ensure that the node that
    claims to be a 6LBR or a RPL DODAG root is entitled to do so.<a class="pilcrow" href="#section-11-7">¶</a></p>
<p id="section-11-8">
    The Opaque field in the EARO enables the RUL to suggest a RPLInstanceID
    where its traffic is placed. It is also possible for an attacker RUL to
    include an RPI in the packet. This opens the door to attacks where a RPL Instance
    would be reserved for critical traffic, e.g., with a specific bandwidth
    reservation, that the additional traffic generated by a rogue may disrupt.
    The attack may be alleviated by traditional access control and traffic-shaping mechanisms where the 6LR controls the incoming traffic from the
    6LN. More importantly, the 6LR is the node that injects the traffic in the
    RPL domain, so it has the final word on which RPL Instance is to be used
    for the traffic coming from the RUL, per its own policy. In particular, a
    policy can override the formal language that forces the use of the Opaque field
    or the rewriting of the RPI provided by the RUL, in a situation where the
    network administrator finds it relevant.<a class="pilcrow" href="#section-11-8">¶</a></p>
<p id="section-11-9">
    At the time of this writing, RPL does not have a route ownership validation
    model whereby it is possible to validate the origin of an address that is
    injected in a DAO.
    This specification makes a first step in that direction by
    allowing the root to challenge the RUL via the 6LR that serves it.<a class="pilcrow" href="#section-11-9">¶</a></p>
<p id="section-11-10">
   <a class="xref" href="#tgt">Section 6.1</a> indicates that when the length of the ROVR field is unknown, the RPL Target option must be passed on as received in RPL Storing mode. This creates a possible opening for using DAO messages as a
   covert channel. Note that DAO messages are rare, and overusing that channel could be detected. An implementation <span class="bcp14">SHOULD</span> notify the network
   management system when a RPL Target option is received with an unknown ROVR field size, to ensure that the network administrator is aware of the situation.<a class="pilcrow" href="#section-11-10">¶</a></p>
<p id="section-11-11">
     <span>[<a class="xref" href="#RFC9009">RFC9009</a>]</span> introduces the ability for
     a rogue common ancestor node to invalidate a route on behalf of the target
     node. In this case, the RPL Status in the DCO has the 'A' flag set to 0, and an NA(EARO) is returned to the 6LN with the R flag set to 0. This encourages the 6LN to try another 6LR. If a 6LR exists that does not use
     the rogue common ancestor, then the 6LN will eventually succeed gaining
     reachability over the RPL network in spite of the rogue node.<a class="pilcrow" href="#section-11-11">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-12">
      <h2 id="name-iana-considerations">
<a class="section-number selfRef" href="#section-12">12. </a><a class="section-name selfRef" href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<div id="iana-arof">
<section id="section-12.1">
        <h3 id="name-fixing-the-address-registra">
<a class="section-number selfRef" href="#section-12.1">12.1. </a><a class="section-name selfRef" href="#name-fixing-the-address-registra">Fixing the Address Registration Option Flags</a>
        </h3>
<p id="section-12.1-1"><span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8505#section-9.1">Section 9.1</a> of [<a class="xref" href="#RFC8505">RFC8505</a>]</span> created a registry for the 8-bit
    Address Registration Option Flags field.
    IANA has renamed the first column of the table from "ARO Status" to "Bit Number".<a class="pilcrow" href="#section-12.1-1">¶</a></p>
</section>
</div>
<div id="iana-aro">
<section id="section-12.2">
        <h3 id="name-resizing-the-aro-status-val">
<a class="section-number selfRef" href="#section-12.2">12.2. </a><a class="section-name selfRef" href="#name-resizing-the-aro-status-val">Resizing the ARO Status Values</a>
        </h3>
<p id="section-12.2-1"><span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc6775#section-12">Section 12</a> of [<a class="xref" href="#RFC6775">RFC6775</a>]</span> created the
    "Address Registration Option Status Values" registry with a range of 0-255.<a class="pilcrow" href="#section-12.2-1">¶</a></p>
<p id="section-12.2-2">
    This specification reduces that range to 0-63; see <a class="xref" href="#stat">Section 6.3</a>.<a class="pilcrow" href="#section-12.2-2">¶</a></p>
<p id="section-12.2-3">
    IANA has modified the "Address Registration Option Status Values"
    registry so that the upper bound of the unassigned values is 63.  This
    document has been added as a reference.  The registration procedure has
    not changed.<a class="pilcrow" href="#section-12.2-3">¶</a></p>
</section>
</div>
<div id="iana-conf">
<section id="section-12.3">
        <h3 id="name-new-rpl-dodag-configuration">
<a class="section-number selfRef" href="#section-12.3">12.3. </a><a class="section-name selfRef" href="#name-new-rpl-dodag-configuration">New RPL DODAG Configuration Option Flag</a>
        </h3>
<p id="section-12.3-1">
    IANA has assigned the following flag in the "DODAG Configuration Option
    Flags for MOP 0..6" registry <span>[<a class="xref" href="#RFC9008">RFC9008</a>]</span>:<a class="pilcrow" href="#section-12.3-1">¶</a></p>
<span id="name-new-dodag-configuration-opt"></span><div id="nexndopt">
<table class="center" id="table-2">
          <caption>
<a class="selfRef" href="#table-2">Table 2</a>:
<a class="selfRef" href="#name-new-dodag-configuration-opt">New DODAG Configuration Option Flag</a>
          </caption>
<thead>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">Bit Number</td>
              <td class="text-left" colspan="1" rowspan="1">Capability Description</td>
              <td class="text-left" colspan="1" rowspan="1">Reference</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">1</td>
              <td class="text-left" colspan="1" rowspan="1">Root Proxies EDAR/EDAC (P)</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9010</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-12.3-3">IANA has added this document as a reference for MOP 7 in the RPL
"Mode of Operation" registry.<a class="pilcrow" href="#section-12.3-3">¶</a></p>
</section>
</div>
<div id="iana-full">
<section id="section-12.4">
        <h3 id="name-rpl-target-option-flags-reg">
<a class="section-number selfRef" href="#section-12.4">12.4. </a><a class="section-name selfRef" href="#name-rpl-target-option-flags-reg">RPL Target Option Flags Registry</a>
        </h3>
<p id="section-12.4-1">
   This document modifies the "RPL Target Option Flags" registry initially
   created per <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc6550#section-20.15">Section 20.15</a> of [<a class="xref" href="#RFC6550">RFC6550</a>]</span>. The registry now
   includes only 4 bits (<a class="xref" href="#tgt">Section 6.1</a>) and lists this
   document as an additional reference. The registration procedure has not
   changed.<a class="pilcrow" href="#section-12.4-1">¶</a></p>
<p id="section-12.4-2">
  <a class="xref" href="#tgt">Section 6.1</a> also defines two new entries in the registry, as follows:<a class="pilcrow" href="#section-12.4-2">¶</a></p>
<span id="name-rpl-target-option-flags-regi"></span><div id="ianatarget">
<table class="center" id="table-3">
          <caption>
<a class="selfRef" href="#table-3">Table 3</a>:
<a class="selfRef" href="#name-rpl-target-option-flags-regi">RPL Target Option Flags Registry</a>
          </caption>
<thead>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">Bit Number</td>
              <td class="text-left" colspan="1" rowspan="1">Capability Description</td>
              <td class="text-left" colspan="1" rowspan="1">Reference</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">Advertiser address in Full (F)</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9010</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">1</td>
              <td class="text-left" colspan="1" rowspan="1">Proxy EDAR Requested (X)</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9010</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="iana-stats-nonrej">
<section id="section-12.5">
        <h3 id="name-new-subregistry-for-rpl-non">
<a class="section-number selfRef" href="#section-12.5">12.5. </a><a class="section-name selfRef" href="#name-new-subregistry-for-rpl-non">New Subregistry for RPL Non-Rejection Status Values</a>
        </h3>
<p id="section-12.5-1">
        IANA has created a new subregistry for the RPL Non-Rejection Status values for use in the RPL DAO-ACK, DCO, and DCO-ACK messages with the 'A' flag set to 0 and the 'U' flag set to 1, under the "Routing Protocol for Low Power and Lossy Networks (RPL)" registry.<a class="pilcrow" href="#section-12.5-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-12.5-2.1">Possible values are 6-bit unsigned integers (0..63).<a class="pilcrow" href="#section-12.5-2.1">¶</a>
</li>
          <li class="normal" id="section-12.5-2.2">The registration procedure is IETF Review <span>[<a class="xref" href="#RFC8126">RFC8126</a>]</span>.<a class="pilcrow" href="#section-12.5-2.2">¶</a>
</li>
          <li class="normal" id="section-12.5-2.3">The initial allocation is as indicated in <a class="xref" href="#iana-ACK-Status">Table 4</a>:<a class="pilcrow" href="#section-12.5-2.3">¶</a>
</li>
        </ul>
<span id="name-acceptance-values-of-the-rp"></span><div id="iana-ACK-Status">
<table class="center" id="table-4">
          <caption>
<a class="selfRef" href="#table-4">Table 4</a>:
<a class="selfRef" href="#name-acceptance-values-of-the-rp">Acceptance Values of the RPL Status</a>
          </caption>
<thead>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">Value</td>
              <td class="text-left" colspan="1" rowspan="1">Meaning</td>
              <td class="text-left" colspan="1" rowspan="1">Reference</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">Success / Unqualified acceptance</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 6550 / RFC 9010</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">1..63</td>
              <td class="text-left" colspan="1" rowspan="1">Unassigned</td>
              <td class="text-left" colspan="1" rowspan="1"></td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="iana-stats-rej">
<section id="section-12.6">
        <h3 id="name-new-subregistry-for-rpl-rej">
<a class="section-number selfRef" href="#section-12.6">12.6. </a><a class="section-name selfRef" href="#name-new-subregistry-for-rpl-rej">New Subregistry for RPL Rejection Status Values</a>
        </h3>
<p id="section-12.6-1">
        IANA has created a new subregistry for the RPL Rejection Status values for use in the RPL DAO-ACK and DCO messages with the 'A' flag set to 0 and the 'U' flag set to 1, under the "Routing Protocol for Low Power and Lossy Networks (RPL)" registry.<a class="pilcrow" href="#section-12.6-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-12.6-2.1">Possible values are 6-bit unsigned integers (0..63).<a class="pilcrow" href="#section-12.6-2.1">¶</a>
</li>
          <li class="normal" id="section-12.6-2.2">The registration procedure is IETF Review <span>[<a class="xref" href="#RFC8126">RFC8126</a>]</span>.<a class="pilcrow" href="#section-12.6-2.2">¶</a>
</li>
          <li class="normal" id="section-12.6-2.3">The initial allocation is as indicated in <a class="xref" href="#iana-nack-Status">Table 5</a>:<a class="pilcrow" href="#section-12.6-2.3">¶</a>
</li>
        </ul>
<span id="name-rejection-values-of-the-rpl"></span><div id="iana-nack-Status">
<table class="center" id="table-5">
          <caption>
<a class="selfRef" href="#table-5">Table 5</a>:
<a class="selfRef" href="#name-rejection-values-of-the-rpl">Rejection Values of the RPL Status</a>
          </caption>
<thead>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">Value</td>
              <td class="text-left" colspan="1" rowspan="1">Meaning</td>
              <td class="text-left" colspan="1" rowspan="1">Reference</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">Unqualified rejection</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9010</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">1</td>
              <td class="text-left" colspan="1" rowspan="1">No routing entry</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9009</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">2..63</td>
              <td class="text-left" colspan="1" rowspan="1">Unassigned</td>
              <td class="text-left" colspan="1" rowspan="1"></td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
</section>
</div>
<section id="section-13">
      <h2 id="name-references">
<a class="section-number selfRef" href="#section-13">13. </a><a class="section-name selfRef" href="#name-references">References</a>
      </h2>
<section id="section-13.1">
        <h3 id="name-normative-references">
<a class="section-number selfRef" href="#section-13.1">13.1. </a><a class="section-name selfRef" href="#name-normative-references">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time class="refDate" datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3810">[RFC3810]</dt>
        <dd>
<span class="refAuthor">Vida, R., Ed.</span> and <span class="refAuthor">L. Costa, Ed.</span>, <span class="refTitle">"Multicast Listener Discovery Version 2 (MLDv2) for IPv6"</span>, <span class="seriesInfo">RFC 3810</span>, <span class="seriesInfo">DOI 10.17487/RFC3810</span>, <time class="refDate" datetime="2004-06">June 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3810">https://www.rfc-editor.org/info/rfc3810</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4861">[RFC4861]</dt>
        <dd>
<span class="refAuthor">Narten, T.</span>, <span class="refAuthor">Nordmark, E.</span>, <span class="refAuthor">Simpson, W.</span>, and <span class="refAuthor">H. Soliman</span>, <span class="refTitle">"Neighbor Discovery for IP version 6 (IPv6)"</span>, <span class="seriesInfo">RFC 4861</span>, <span class="seriesInfo">DOI 10.17487/RFC4861</span>, <time class="refDate" datetime="2007-09">September 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4861">https://www.rfc-editor.org/info/rfc4861</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6550">[RFC6550]</dt>
        <dd>
<span class="refAuthor">Winter, T., Ed.</span>, <span class="refAuthor">Thubert, P., Ed.</span>, <span class="refAuthor">Brandt, A.</span>, <span class="refAuthor">Hui, J.</span>, <span class="refAuthor">Kelsey, R.</span>, <span class="refAuthor">Levis, P.</span>, <span class="refAuthor">Pister, K.</span>, <span class="refAuthor">Struik, R.</span>, <span class="refAuthor">Vasseur, JP.</span>, and <span class="refAuthor">R. Alexander</span>, <span class="refTitle">"RPL: IPv6 Routing Protocol for Low-Power and Lossy Networks"</span>, <span class="seriesInfo">RFC 6550</span>, <span class="seriesInfo">DOI 10.17487/RFC6550</span>, <time class="refDate" datetime="2012-03">March 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6550">https://www.rfc-editor.org/info/rfc6550</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6775">[RFC6775]</dt>
        <dd>
<span class="refAuthor">Shelby, Z., Ed.</span>, <span class="refAuthor">Chakrabarti, S.</span>, <span class="refAuthor">Nordmark, E.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"Neighbor Discovery Optimization for IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs)"</span>, <span class="seriesInfo">RFC 6775</span>, <span class="seriesInfo">DOI 10.17487/RFC6775</span>, <time class="refDate" datetime="2012-11">November 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6775">https://www.rfc-editor.org/info/rfc6775</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7102">[RFC7102]</dt>
        <dd>
<span class="refAuthor">Vasseur, JP.</span>, <span class="refTitle">"Terms Used in Routing for Low-Power and Lossy Networks"</span>, <span class="seriesInfo">RFC 7102</span>, <span class="seriesInfo">DOI 10.17487/RFC7102</span>, <time class="refDate" datetime="2014-01">January 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7102">https://www.rfc-editor.org/info/rfc7102</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7400">[RFC7400]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span>, <span class="refTitle">"6LoWPAN-GHC: Generic Header Compression for IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs)"</span>, <span class="seriesInfo">RFC 7400</span>, <span class="seriesInfo">DOI 10.17487/RFC7400</span>, <time class="refDate" datetime="2014-11">November 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7400">https://www.rfc-editor.org/info/rfc7400</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time class="refDate" datetime="2017-06">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time class="refDate" datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8200">[RFC8200]</dt>
        <dd>
<span class="refAuthor">Deering, S.</span> and <span class="refAuthor">R. Hinden</span>, <span class="refTitle">"Internet Protocol, Version 6 (IPv6) Specification"</span>, <span class="seriesInfo">STD 86</span>, <span class="seriesInfo">RFC 8200</span>, <span class="seriesInfo">DOI 10.17487/RFC8200</span>, <time class="refDate" datetime="2017-07">July 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8200">https://www.rfc-editor.org/info/rfc8200</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8504">[RFC8504]</dt>
        <dd>
<span class="refAuthor">Chown, T.</span>, <span class="refAuthor">Loughney, J.</span>, and <span class="refAuthor">T. Winters</span>, <span class="refTitle">"IPv6 Node Requirements"</span>, <span class="seriesInfo">BCP 220</span>, <span class="seriesInfo">RFC 8504</span>, <span class="seriesInfo">DOI 10.17487/RFC8504</span>, <time class="refDate" datetime="2019-01">January 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8504">https://www.rfc-editor.org/info/rfc8504</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8505">[RFC8505]</dt>
        <dd>
<span class="refAuthor">Thubert, P., Ed.</span>, <span class="refAuthor">Nordmark, E.</span>, <span class="refAuthor">Chakrabarti, S.</span>, and <span class="refAuthor">C. Perkins</span>, <span class="refTitle">"Registration Extensions for IPv6 over Low-Power Wireless Personal Area Network (6LoWPAN) Neighbor Discovery"</span>, <span class="seriesInfo">RFC 8505</span>, <span class="seriesInfo">DOI 10.17487/RFC8505</span>, <time class="refDate" datetime="2018-11">November 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8505">https://www.rfc-editor.org/info/rfc8505</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8928">[RFC8928]</dt>
        <dd>
<span class="refAuthor">Thubert, P., Ed.</span>, <span class="refAuthor">Sarikaya, B.</span>, <span class="refAuthor">Sethi, M.</span>, and <span class="refAuthor">R. Struik</span>, <span class="refTitle">"Address-Protected Neighbor Discovery for Low-Power and Lossy Networks"</span>, <span class="seriesInfo">RFC 8928</span>, <span class="seriesInfo">DOI 10.17487/RFC8928</span>, <time class="refDate" datetime="2020-11">November 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8928">https://www.rfc-editor.org/info/rfc8928</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9008">[RFC9008]</dt>
        <dd>
<span class="refAuthor">Robles, M.I.</span>, <span class="refAuthor">Richardson, M.</span>, and <span class="refAuthor">P. Thubert</span>, <span class="refTitle">"Using RPI Option Type, Routing Header for Source Routes, and IPv6-in-IPv6 Encapsulation in the RPL Data Plane"</span>, <span class="seriesInfo">RFC 9008</span>, <span class="seriesInfo">DOI 10.17487/RFC9008</span>, <time class="refDate" datetime="2021-04">April 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9008">https://www.rfc-editor.org/info/rfc9008</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9009">[RFC9009]</dt>
      <dd>
<span class="refAuthor">Jadhav, R.A., Ed.</span>, <span class="refAuthor">Thubert, P.</span>, <span class="refAuthor">Sahoo, R.N.</span>, and <span class="refAuthor">Z. Cao</span>, <span class="refTitle">"Efficient Route Invalidation"</span>, <span class="seriesInfo">RFC 9009</span>, <span class="seriesInfo">DOI 10.17487/RFC9009</span>, <time class="refDate" datetime="2021-04">April 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9009">https://www.rfc-editor.org/info/rfc9009</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-13.2">
        <h3 id="name-informative-references">
<a class="section-number selfRef" href="#section-13.2">13.2. </a><a class="section-name selfRef" href="#name-informative-references">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC4862">[RFC4862]</dt>
        <dd>
<span class="refAuthor">Thomson, S.</span>, <span class="refAuthor">Narten, T.</span>, and <span class="refAuthor">T. Jinmei</span>, <span class="refTitle">"IPv6 Stateless Address Autoconfiguration"</span>, <span class="seriesInfo">RFC 4862</span>, <span class="seriesInfo">DOI 10.17487/RFC4862</span>, <time class="refDate" datetime="2007-09">September 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4862">https://www.rfc-editor.org/info/rfc4862</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4919">[RFC4919]</dt>
        <dd>
<span class="refAuthor">Kushalnagar, N.</span>, <span class="refAuthor">Montenegro, G.</span>, and <span class="refAuthor">C. Schumacher</span>, <span class="refTitle">"IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs): Overview, Assumptions, Problem Statement, and Goals"</span>, <span class="seriesInfo">RFC 4919</span>, <span class="seriesInfo">DOI 10.17487/RFC4919</span>, <time class="refDate" datetime="2007-08">August 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4919">https://www.rfc-editor.org/info/rfc4919</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6282">[RFC6282]</dt>
        <dd>
<span class="refAuthor">Hui, J., Ed.</span> and <span class="refAuthor">P. Thubert</span>, <span class="refTitle">"Compression Format for IPv6 Datagrams over IEEE 802.15.4-Based Networks"</span>, <span class="seriesInfo">RFC 6282</span>, <span class="seriesInfo">DOI 10.17487/RFC6282</span>, <time class="refDate" datetime="2011-09">September 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6282">https://www.rfc-editor.org/info/rfc6282</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6553">[RFC6553]</dt>
        <dd>
<span class="refAuthor">Hui, J.</span> and <span class="refAuthor">JP. Vasseur</span>, <span class="refTitle">"The Routing Protocol for Low-Power and Lossy Networks (RPL) Option for Carrying RPL Information in Data-Plane Datagrams"</span>, <span class="seriesInfo">RFC 6553</span>, <span class="seriesInfo">DOI 10.17487/RFC6553</span>, <time class="refDate" datetime="2012-03">March 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6553">https://www.rfc-editor.org/info/rfc6553</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6554">[RFC6554]</dt>
        <dd>
<span class="refAuthor">Hui, J.</span>, <span class="refAuthor">Vasseur, JP.</span>, <span class="refAuthor">Culler, D.</span>, and <span class="refAuthor">V. Manral</span>, <span class="refTitle">"An IPv6 Routing Header for Source Routes with the Routing Protocol for Low-Power and Lossy Networks (RPL)"</span>, <span class="seriesInfo">RFC 6554</span>, <span class="seriesInfo">DOI 10.17487/RFC6554</span>, <time class="refDate" datetime="2012-03">March 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6554">https://www.rfc-editor.org/info/rfc6554</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6606">[RFC6606]</dt>
        <dd>
<span class="refAuthor">Kim, E.</span>, <span class="refAuthor">Kaspar, D.</span>, <span class="refAuthor">Gomez, C.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"Problem Statement and Requirements for IPv6 over Low-Power Wireless Personal Area Network (6LoWPAN) Routing"</span>, <span class="seriesInfo">RFC 6606</span>, <span class="seriesInfo">DOI 10.17487/RFC6606</span>, <time class="refDate" datetime="2012-05">May 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6606">https://www.rfc-editor.org/info/rfc6606</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6687">[RFC6687]</dt>
        <dd>
<span class="refAuthor">Tripathi, J., Ed.</span>, <span class="refAuthor">de Oliveira, J., Ed.</span>, and <span class="refAuthor">JP. Vasseur, Ed.</span>, <span class="refTitle">"Performance Evaluation of the Routing Protocol for Low-Power and Lossy Networks (RPL)"</span>, <span class="seriesInfo">RFC 6687</span>, <span class="seriesInfo">DOI 10.17487/RFC6687</span>, <time class="refDate" datetime="2012-10">October 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6687">https://www.rfc-editor.org/info/rfc6687</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7039">[RFC7039]</dt>
        <dd>
<span class="refAuthor">Wu, J.</span>, <span class="refAuthor">Bi, J.</span>, <span class="refAuthor">Bagnulo, M.</span>, <span class="refAuthor">Baker, F.</span>, and <span class="refAuthor">C. Vogt, Ed.</span>, <span class="refTitle">"Source Address Validation Improvement (SAVI) Framework"</span>, <span class="seriesInfo">RFC 7039</span>, <span class="seriesInfo">DOI 10.17487/RFC7039</span>, <time class="refDate" datetime="2013-10">October 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7039">https://www.rfc-editor.org/info/rfc7039</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7228">[RFC7228]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span>, <span class="refAuthor">Ersue, M.</span>, and <span class="refAuthor">A. Keranen</span>, <span class="refTitle">"Terminology for Constrained-Node Networks"</span>, <span class="seriesInfo">RFC 7228</span>, <span class="seriesInfo">DOI 10.17487/RFC7228</span>, <time class="refDate" datetime="2014-05">May 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7228">https://www.rfc-editor.org/info/rfc7228</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7416">[RFC7416]</dt>
        <dd>
<span class="refAuthor">Tsao, T.</span>, <span class="refAuthor">Alexander, R.</span>, <span class="refAuthor">Dohler, M.</span>, <span class="refAuthor">Daza, V.</span>, <span class="refAuthor">Lozano, A.</span>, and <span class="refAuthor">M. Richardson, Ed.</span>, <span class="refTitle">"A Security Threat Analysis for the Routing Protocol for Low-Power and Lossy Networks (RPLs)"</span>, <span class="seriesInfo">RFC 7416</span>, <span class="seriesInfo">DOI 10.17487/RFC7416</span>, <time class="refDate" datetime="2015-01">January 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7416">https://www.rfc-editor.org/info/rfc7416</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8025">[RFC8025]</dt>
        <dd>
<span class="refAuthor">Thubert, P., Ed.</span> and <span class="refAuthor">R. Cragie</span>, <span class="refTitle">"IPv6 over Low-Power Wireless Personal Area Network (6LoWPAN) Paging Dispatch"</span>, <span class="seriesInfo">RFC 8025</span>, <span class="seriesInfo">DOI 10.17487/RFC8025</span>, <time class="refDate" datetime="2016-11">November 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8025">https://www.rfc-editor.org/info/rfc8025</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8138">[RFC8138]</dt>
        <dd>
<span class="refAuthor">Thubert, P., Ed.</span>, <span class="refAuthor">Bormann, C.</span>, <span class="refAuthor">Toutain, L.</span>, and <span class="refAuthor">R. Cragie</span>, <span class="refTitle">"IPv6 over Low-Power Wireless Personal Area Network (6LoWPAN) Routing Header"</span>, <span class="seriesInfo">RFC 8138</span>, <span class="seriesInfo">DOI 10.17487/RFC8138</span>, <time class="refDate" datetime="2017-04">April 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8138">https://www.rfc-editor.org/info/rfc8138</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8415">[RFC8415]</dt>
        <dd>
<span class="refAuthor">Mrugalski, T.</span>, <span class="refAuthor">Siodelski, M.</span>, <span class="refAuthor">Volz, B.</span>, <span class="refAuthor">Yourtchenko, A.</span>, <span class="refAuthor">Richardson, M.</span>, <span class="refAuthor">Jiang, S.</span>, <span class="refAuthor">Lemon, T.</span>, and <span class="refAuthor">T. Winters</span>, <span class="refTitle">"Dynamic Host Configuration Protocol for IPv6 (DHCPv6)"</span>, <span class="seriesInfo">RFC 8415</span>, <span class="seriesInfo">DOI 10.17487/RFC8415</span>, <time class="refDate" datetime="2018-11">November 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8415">https://www.rfc-editor.org/info/rfc8415</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8929">[RFC8929]</dt>
      <dd>
<span class="refAuthor">Thubert, P., Ed.</span>, <span class="refAuthor">Perkins, C.E.</span>, and <span class="refAuthor">E. Levy-Abegnoli</span>, <span class="refTitle">"IPv6 Backbone Router"</span>, <span class="seriesInfo">RFC 8929</span>, <span class="seriesInfo">DOI 10.17487/RFC8929</span>, <time class="refDate" datetime="2020-11">November 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8929">https://www.rfc-editor.org/info/rfc8929</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="u8138">
<section id="section-appendix.a">
      <h2 id="name-example-compression">
<a class="section-number selfRef" href="#section-appendix.a">Appendix A. </a><a class="section-name selfRef" href="#name-example-compression">Example Compression</a>
      </h2>
<p id="section-appendix.a-1">

 <a class="xref" href="#rtghc">Figure 13</a> illustrates the case in Storing mode where the packet
    is received from the Internet, then the root encapsulates the packet to
    insert the RPI and deliver it to the 6LR that is the parent and last hop to the
    final destination, which is not known to support <span>[<a class="xref" href="#RFC8138">RFC8138</a>]</span>.<a class="pilcrow" href="#section-appendix.a-1">¶</a></p>
<span id="name-encapsulation-to-parent-6lr"></span><div id="rtghc">
<figure id="figure-13">
        <div class="artwork art-text alignLeft" id="section-appendix.a-2.1">
<pre>
+-+ ... -+-+ ... +-+- ... -+-+ ... -+-+-+ ... +-+-+ ... -+ ... +-...
|11110001|SRH-6LoRH| RPI-  |IP-in-IP| NH=1      |11110CPP| UDP | UDP
|Page 1  |Type1 S=0| 6LoRH | 6LoRH  |LOWPAN_IPHC| UDP    | hdr |Payld
+-+ ... -+-+ ... +-+- ... -+-+ ... -+-+-+ ... +-+-+ ... -+ ... +-...
         &lt;-4 bytes-&gt;                &lt;-        RFC 6282        -&gt;
                                    &lt;-     No RPL artifact ...</pre>
</div>
<figcaption><a class="selfRef" href="#figure-13">Figure 13</a>:
<a class="selfRef" href="#name-encapsulation-to-parent-6lr">Encapsulation to Parent 6LR in Storing Mode</a>
        </figcaption></figure>
</div>
<p id="section-appendix.a-3">
    The difference from the example presented in Figure 19 of
    <span>[<a class="xref" href="#RFC8138">RFC8138</a>]</span> is the addition of an SRH-6LoRH before the RPI-6LoRH
    to transport the compressed address of the 6LR as the destination address of
    the outer IPv6 header. In Figure 19 of <span>[<a class="xref" href="#RFC8138">RFC8138</a>]</span>, the destination IP of the
    outer header was elided and was implicitly the same address as the
    destination of the inner header.

    Type 1 was arbitrarily chosen, and the size of 0 denotes a single address in
    the SRH.<a class="pilcrow" href="#section-appendix.a-3">¶</a></p>
<p id="section-appendix.a-4">
     In <a class="xref" href="#rtghc">Figure 13</a>, the source of the IPv6-in-IPv6 encapsulation is
          the root, so it is elided in the IPv6-in-IPv6 6LoRH. The destination is
          the parent 6LR of the destination of the encapsulated packet, so it
          cannot be elided. If the DODAG is operated in Storing mode, it is the
          single entry in the SRH-6LoRH and the SRH-6LoRH Size is encoded as 0.
          The SRH-6LoRH is the first 6LoRH in the chain.
          In this particular example, the 6LR address can
          be compressed to 2 bytes, so a Type of 1 is used.
          The result is that the total length of the SRH-6LoRH is 4 bytes.<a class="pilcrow" href="#section-appendix.a-4">¶</a></p>
<p id="section-appendix.a-5">
          In Non-Storing mode, the encapsulation from the root would be similar
          to that represented in <a class="xref" href="#rtghc">Figure 13</a> with possibly more hops
          in the SRH‑6LoRH and possibly multiple SRH-6LoRHs if the various
          addresses in the routing header are not compressed to the same format.
          Note that on the last hop to the parent 6LR, the RH3 is consumed and
          removed from the compressed form, so the use of Non-Storing mode vs. Storing mode is indistinguishable from the packet format.<a class="pilcrow" href="#section-appendix.a-5">¶</a></p>
<p id="section-appendix.a-6">
          The SRH-6LoRHs are followed by the RPI-6LoRH and then the IPv6-in-IPv6 6LoRH.
          When the IPv6-in-IPv6 6LoRH is removed, all the 6LoRH Headers that
          precede it are also removed.
          The Paging Dispatch <span>[<a class="xref" href="#RFC8025">RFC8025</a>]</span> may also be removed if
          there was no previous Page change to a Page other than 0 or 1, since
          the LOWPAN_IPHC is encoded in the same fashion in the default Page 0
          and in Page 1. The resulting packet to the destination is the
          encapsulated packet compressed per <span>[<a class="xref" href="#RFC6282">RFC6282</a>]</span>.<a class="pilcrow" href="#section-appendix.a-6">¶</a></p>
</section>
</div>
<div id="Acks">
<section id="section-appendix.b">
      <h2 id="name-acknowledgments">
<a class="section-name selfRef" href="#name-acknowledgments">Acknowledgments</a>
      </h2>
<p id="section-appendix.b-1">
   The authors wish to thank <span class="contact-name">Ines Robles</span>, <span class="contact-name">Georgios Papadopoulos</span>, and
   especially <span class="contact-name">Rahul Jadhav</span> and <span class="contact-name">Alvaro Retana</span>
   for their reviews and contributions to this document.
   Also many thanks to <span class="contact-name">Éric Vyncke</span>, <span class="contact-name">Erik Kline</span>, <span class="contact-name">Murray Kucherawy</span>,
   <span class="contact-name">Peter van der Stok</span>, <span class="contact-name">Carl Wallace</span>, <span class="contact-name">Barry Leiba</span>, <span class="contact-name">Julien Meuric</span>,
   and especially <span class="contact-name">Benjamin Kaduk</span> and <span class="contact-name">Elwyn Davies</span>,

   for their reviews and useful comments
   during the IETF Last Call and the IESG review sessions.<a class="pilcrow" href="#section-appendix.b-1">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="section-appendix.c">
      <h2 id="name-authors-addresses">
<a class="section-name selfRef" href="#name-authors-addresses">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Pascal Thubert (<span class="role">editor</span>)</span></div>
<div class="left" dir="auto"><span class="org">Cisco Systems, Inc.</span></div>
<div class="left" dir="auto"><span class="street-address">Building D<br/>45 Allee des Ormes - BP1200</span></div>
<div class="left" dir="auto">
<span class="postal-code">06254</span> <span class="locality">MOUGINS - Sophia Antipolis</span>
</div>
<div class="left" dir="auto"><span class="country-name">France</span></div>
<div class="tel">
<span>Phone:</span>
<a class="tel" href="tel:+33%20497%2023%2026%2034">+33 497 23 26 34</a>
</div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:pthubert@cisco.com">pthubert@cisco.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Michael C. Richardson</span></div>
<div class="left" dir="auto"><span class="org">Sandelman Software Works</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:mcr+ietf@sandelman.ca">mcr+ietf@sandelman.ca</a>
</div>
<div class="url">
<span>URI:</span>
<a class="url" href="https://www.sandelman.ca/">https://www.sandelman.ca/</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>


</body></html>