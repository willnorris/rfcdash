<html><head></head><body><pre>Internet Engineering Task Force (IETF)                    T. Nadeau, Ed.
Request for Comments: 5885                                            BT
Category: Standards Track                              C. Pignataro, Ed.
ISSN: 2070-1721                                      Cisco Systems, Inc.
                                                               June 2010


              <span class="h1">Bidirectional Forwarding Detection (BFD) for</span>
    <span class="h1">the Pseudowire Virtual Circuit Connectivity Verification (VCCV)</span>

Abstract

   This document describes Connectivity Verification (CV) Types using
   Bidirectional Forwarding Detection (BFD) with Virtual Circuit
   Connectivity Verification (VCCV).  VCCV provides a control channel
   that is associated with a pseudowire (PW), as well as the
   corresponding operations and management functions such as
   connectivity verification to be used over that control channel.

Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in <a href="./rfc5741#section-2">SectionÂ 2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc5885">http://www.rfc-editor.org/info/rfc5885</a>.

Copyright Notice

   Copyright (c) 2010 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://www.rfc-editor.org/bcp/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.




<span class="grey">Nadeau &amp; Pignataro           Standards Track                    [Page 1]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-2"></span>
<span class="grey"><a href="./rfc5885">RFC 5885</a>                        BFD VCCV                       June 2010</span>


   This document may contain material from IETF Documents or IETF
   Contributions published or made publicly available before November
   10, 2008.  The person(s) controlling the copyright in some of this
   material may not have granted the IETF Trust the right to allow
   modifications of such material outside the IETF Standards Process.
   Without obtaining an adequate license from the person(s) controlling
   the copyright in such materials, this document may not be modified
   outside the IETF Standards Process, and derivative works of it may
   not be created outside the IETF Standards Process, except to format
   it for publication as an RFC or to translate it into languages other
   than English.

Table of Contents

   <a href="#section-1">1</a>.  Introduction . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-3">3</a>
   <a href="#section-2">2</a>.  Specification of Requirements  . . . . . . . . . . . . . . . .  <a href="#page-3">3</a>
   3.  Bidirectional Forwarding Detection Connectivity
       Verification . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-3">3</a>
     <a href="#section-3.1">3.1</a>.  BFD CV Type Operation  . . . . . . . . . . . . . . . . . .  <a href="#page-4">4</a>
     <a href="#section-3.2">3.2</a>.  BFD Encapsulation  . . . . . . . . . . . . . . . . . . . .  <a href="#page-5">5</a>
     <a href="#section-3.3">3.3</a>.  CV Types for BFD . . . . . . . . . . . . . . . . . . . . .  <a href="#page-7">7</a>
   <a href="#section-4">4</a>.  Capability Selection . . . . . . . . . . . . . . . . . . . . .  <a href="#page-9">9</a>
   <a href="#section-5">5</a>.  IANA Considerations  . . . . . . . . . . . . . . . . . . . . . <a href="#page-10">10</a>
     5.1.  MPLS CV Types for the VCCV Interface Parameters Sub-TLV  . 10
     <a href="#section-5.2">5.2</a>.  PW Associated Channel Type . . . . . . . . . . . . . . . . <a href="#page-10">10</a>
     <a href="#section-5.3">5.3</a>.  L2TPv3 CV Types for the VCCV Capability AVP  . . . . . . . <a href="#page-11">11</a>
   <a href="#section-6">6</a>.  Congestion Considerations  . . . . . . . . . . . . . . . . . . <a href="#page-11">11</a>
   <a href="#section-7">7</a>.  Security Considerations  . . . . . . . . . . . . . . . . . . . <a href="#page-12">12</a>
   <a href="#section-8">8</a>.  Acknowledgements . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-12">12</a>
   <a href="#section-9">9</a>.  References . . . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-12">12</a>
     <a href="#section-9.1">9.1</a>.  Normative References . . . . . . . . . . . . . . . . . . . <a href="#page-12">12</a>
     <a href="#section-9.2">9.2</a>.  Informative References . . . . . . . . . . . . . . . . . . <a href="#page-13">13</a>



















<span class="grey">Nadeau &amp; Pignataro           Standards Track                    [Page 2]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-3"></span>
<span class="grey"><a href="./rfc5885">RFC 5885</a>                        BFD VCCV                       June 2010</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" id="section-1">1</a>.  Introduction</span>

   This document describes Connectivity Verification (CV) Types using
   Bidirectional Forwarding Detection (BFD) with Virtual Circuit
   Connectivity Verification (VCCV).  VCCV [<a href="./rfc5085" title='"Pseudowire Virtual Circuit Connectivity Verification (VCCV): A Control Channel for Pseudowires"'>RFC5085</a>] provides a control
   channel that is associated with a pseudowire (PW), as well as the
   corresponding operations and management functions such as
   connectivity/fault verification to be used over that control channel.

   BFD [<a href="./rfc5880" title='"Bidirectional Forwarding Detection"'>RFC5880</a>] is used over the VCCV control channel primarily as a
   pseudowire fault detection mechanism, for detecting data-plane
   failures.  Some BFD CV Types can additionally carry fault status
   between the endpoints of the pseudowire.  Furthermore, this
   information can then be translated into the native Operations,
   Administration, and Maintenance (OAM) status codes used by the native
   access technologies, such as ATM, Frame Relay, or Ethernet.  The
   specific details of such status interworking are out of the scope of
   this document, and are only noted here to illustrate the utility of
   BFD over VCCV for such purposes.  Those details can be found in
   [<a href="#ref-OAM-MSG-MAP" title='"Pseudowire (PW) OAM Message Mapping"'>OAM-MSG-MAP</a>].

   The new BFD CV Types are PW demultiplexer-agnostic, and hence
   applicable for both MPLS and Layer Two Tunneling Protocol version 3
   (L2TPv3) pseudowire demultiplexers.  This document concerns itself
   with the BFD VCCV operation over single-segment pseudowires (SS-PWs).
   This specification describes procedures only for BFD asynchronous
   mode.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/2.%20%20Specification%20of%20Requirements"></a><a class="selflink" href="#section-2" id="section-2">2</a>.  Specification of Requirements</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [<a href="./rfc2119" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>].

   The reader is expected to be familiar with the terminology and
   abbreviations defined in [<a href="./rfc5085" title='"Pseudowire Virtual Circuit Connectivity Verification (VCCV): A Control Channel for Pseudowires"'>RFC5085</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.%20%20Bidirectional%20Forwarding%20Detection%20Connectivity%20Verification"></a><a class="selflink" href="#section-3" id="section-3">3</a>.  Bidirectional Forwarding Detection Connectivity Verification</span>

   VCCV can support several Connectivity Verification (CV) Types.  This
   section defines new CV Types for use when BFD is used as the VCCV
   payload.

   Four CV Types are defined for BFD.  Table 1 summarizes the BFD CV
   Types, grouping them by encapsulation (i.e., with versus without IP/
   UDP headers) and by functionality (i.e., fault detection only versus
   fault detection and status signaling).




<span class="grey">Nadeau &amp; Pignataro           Standards Track                    [Page 3]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-4"></span>
<span class="grey"><a href="./rfc5885">RFC 5885</a>                        BFD VCCV                       June 2010</span>


   +----------------------------+--------------+-----------------------+
   |                            |     Fault    |  Fault Detection and  |
   |                            |   Detection  |    Status Signaling   |
   |                            |     Only     |                       |
   +----------------------------+--------------+-----------------------+
   |  BFD, IP/UDP Encapsulation |     0x04     |          0x08         |
   |      (with IP/UDP Headers) |              |                       |
   |                            |              |                       |
   |  BFD, PW-ACH Encapsulation |     0x10     |          0x20         |
   |   (without IP/UDP Headers) |              |                       |
   +----------------------------+--------------+-----------------------+

                 Table 1: Bitmask Values for BFD CV Types

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.1.%20%20BFD%20CV%20Type%20Operation"></a><a class="selflink" href="#section-3.1" id="section-3.1">3.1</a>.  BFD CV Type Operation</span>

   When heart-beat indication is necessary for one or more PWs, the
   Bidirectional Forwarding Detection (BFD) [<a href="./rfc5880" title='"Bidirectional Forwarding Detection"'>RFC5880</a>] provides a means
   of continuous monitoring of the PW data path and, in some operational
   modes, propagation of PW receive and transmit defect state
   indications.

   In order to use BFD, both ends of the PW connection need to agree on
   the BFD CV Type to use:

      For statically provisioned pseudowires, both ends need to be
      statically configured to use the same BFD CV Type (in addition to
      being statically configured for VCCV with the same CC Type).

      For dynamically established pseudowires, both ends of the PW must
      have signaled the existence of a control channel and the ability
      to run BFD on it (see Sections <a href="#section-3.3">3.3</a> and <a href="#section-4">4</a>).

   Once a node has selected a valid BFD CV Type to use (either
   statically provisioned or selected dynamically after the node has
   both signaled and received signaling from its peer of these
   capabilities), it begins sending BFD Control packets:

   o  The BFD Control packets are sent on the VCCV control channel.  The
      use of the VCCV control channel provides the context required to
      bind and bootstrap the BFD session, since discriminator values are
      not exchanged; the pseudowire demultiplexer field (e.g., MPLS PW
      Label or L2TPv3 Session ID) provides the context to demultiplex
      the first BFD Control packet, and thus single-hop BFD
      initialization procedures are followed (see <a href="./rfc5881#section-3">SectionÂ 3 of [RFC5881]</a>
      and <a href="./rfc5882#section-6">SectionÂ 6 of [RFC5882]</a>).





<span class="grey">Nadeau &amp; Pignataro           Standards Track                    [Page 4]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-5"></span>
<span class="grey"><a href="./rfc5885">RFC 5885</a>                        BFD VCCV                       June 2010</span>


   o  A single BFD session exists per pseudowire.  Both PW endpoints
      take the Active role sending initial BFD Control packets with a
      Your Discriminator field of zero, and BFD Control packets received
      with a Your Discriminator field of zero are associated to the BFD
      session bound to the PW.

   o  BFD MUST be run in asynchronous mode (see [<a href="./rfc5880" title='"Bidirectional Forwarding Detection"'>RFC5880</a>]).

   The operation of BFD VCCV for PWs is therefore symmetrical.  Both
   endpoints of the bidirectional pseudowire MUST send BFD messages on
   the VCCV control channel.

   The details of the BFD state machine are as per <a href="./rfc5880#section-6.2">SectionÂ 6.2 of
   [RFC5880]</a>.  The following scenario exemplifies the operation: when
   the downstream PE (D-PE) does not receive BFD Control messages from
   its upstream peer PE (U-PE) during a certain number of transmission
   intervals (a number provisioned by the operator as "Detect Mult" or
   detection time multiplier [<a href="./rfc5880" title='"Bidirectional Forwarding Detection"'>RFC5880</a>]), D-PE declares that the PW in
   its receive direction is down.  In other words, D-PE enters the "PW
   receive defect" state for this PW.  After this calculated Detection
   Time (see <a href="./rfc5880#section-6.8.4">SectionÂ 6.8.4 of [RFC5880]</a>), D-PE declares the session
   Down, and signals this to the remote end via the State (Sta) with
   Diagnostic code 1 (Control Detection Time Expired).  In turn, U-PE
   declares the PW is down in its transmit direction, setting the State
   to Down with Diagnostic code 3 (Neighbor signaled session down) in
   its control messages to D-PE.  U-PE enters the "PW transmit defect"
   state for this PW.  How it further processes this error condition,
   and potentially conveys this status to the attachment circuits, is
   out of the scope of this specification, and is defined in
   [<a href="#ref-OAM-MSG-MAP" title='"Pseudowire (PW) OAM Message Mapping"'>OAM-MSG-MAP</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.2.%20%20BFD%20Encapsulation"></a><a class="selflink" href="#section-3.2" id="section-3.2">3.2</a>.  BFD Encapsulation</span>

   The VCCV message comprises a BFD Control packet [<a href="./rfc5880" title='"Bidirectional Forwarding Detection"'>RFC5880</a>]
   encapsulated as specified by the CV Type.  There are two ways in
   which a BFD connectivity verification packet may be encapsulated over
   the VCCV control channel.  This document defines four BFD CV Types
   (see <a href="#section-3">Section 3</a>), which can be grouped into two pairs of BFD CV Types
   from an encapsulation point of view.  See Table 1 in <a href="#section-3">Section 3</a>, which
   summarizes the BFD CV Types.

   o  IP/UDP BFD Encapsulation (BFD with IP/UDP Headers)

      In the first method, the VCCV encapsulation of BFD includes the
      IP/UDP headers as defined in <a href="./rfc5881#section-4">SectionÂ 4 of [RFC5881]</a>.  BFD Control
      packets are therefore transmitted in UDP with destination port
      3784 and source port within the range 49152 through 65535.  The IP




<span class="grey">Nadeau &amp; Pignataro           Standards Track                    [Page 5]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-6"></span>
<span class="grey"><a href="./rfc5885">RFC 5885</a>                        BFD VCCV                       June 2010</span>


      Protocol Number and UDP Port numbers discriminate among the
      possible VCCV payloads (i.e., differentiate among ICMP Ping and
      LSP Ping defined in [<a href="./rfc5085" title='"Pseudowire Virtual Circuit Connectivity Verification (VCCV): A Control Channel for Pseudowires"'>RFC5085</a>] and BFD).

      The IP version (IPv4 or IPv6) MUST match the IP version used for
      signaling for dynamically established pseudowires or MUST be
      configured for statically provisioned pseudowires.  The source IP
      address is an address of the sender.  The destination IP address
      is a (randomly chosen) IPv4 address from the range 127/8 or IPv6
      address from the range 0:0:0:0:0:FFFF:127.0.0.0/104.  The
      rationale is explained in <a href="./rfc4379#section-2.1">SectionÂ 2.1 of [RFC4379]</a>.  The Time to
      Live/Hop Limit and Generalized TTL Security Mechanism (GTSM)
      procedures from <a href="./rfc5881#section-5">SectionÂ 5 of [RFC5881]</a> apply to this
      encapsulation, and hence the TTL/Hop Limit is set to 255.

      If the PW is established by signaling, then the BFD CV Type used
      for this encapsulation is either 0x04 or 0x08.

   o  PW-ACH BFD Encapsulation (BFD without IP/UDP Headers)

      In the second method, a BFD Control packet (format defined in
      <a href="./rfc5880#section-4">SectionÂ 4 of [RFC5880]</a>) is encapsulated directly in the VCCV
      control channel (see Sections <a href="#section-6">6</a> and <a href="#section-8">8</a> of [<a href="./rfc5882" title='"Generic Application of Bidirectional Forwarding Detection (BFD)"'>RFC5882</a>]) and the IP/UDP
      headers are omitted from the BFD encapsulation.  Therefore, to
      utilize this encapsulation, a pseudowire MUST use the PW
      Associated Channel Header (PW-ACH) Control Word format (see
      [<a href="./rfc5586" title='"MPLS Generic Associated Channel"'>RFC5586</a>]) for its Control Word (CW) or L2-Specific Sublayer
      (L2SS, used in L2TPv3).

      In this encapsulation, a "raw" BFD Control packet (i.e., a BFD
      Control packet as defined in <a href="./rfc5880#section-4.1">SectionÂ 4.1 of [RFC5880]</a> without IP/
      UDP headers) follows directly the PW-ACH.  The PW-ACH Channel Type
      indicates that the Associated Channel carries "raw" BFD.  The PW
      Associated Channel (PWAC) is defined in <a href="./rfc4385#section-5">SectionÂ 5 of [RFC4385]</a>,
      and its Channel Type field is used to discriminate the VCCV
      payload types.

      The usage of the PW-ACH on different VCCV CC Types is specified
      for CC Type 1, Type 2, and Type 3 respectively in Sections <a href="#section-5.1.1">5.1.1</a>,
      5.1.2, and 5.1.3 of [<a href="./rfc5085" title='"Pseudowire Virtual Circuit Connectivity Verification (VCCV): A Control Channel for Pseudowires"'>RFC5085</a>], and in all cases requires the use
      of a CW (see <a href="./rfc4385#section-7">SectionÂ 7 of [RFC4385]</a>).  When VCCV carries PW-ACH-
      encapsulated BFD (i.e., "raw" BFD), the PW-ACH (pseudowire CW's or
      L2SS') Channel Type MUST be set to 0x0007 to indicate "BFD
      Control, PW-ACH-encapsulated" (i.e., BFD without IP/UDP headers;
      see <a href="#section-5.2">Section 5.2</a>).  This is to allow the identification of the
      encased BFD payload when demultiplexing the VCCV control channel.





<span class="grey">Nadeau &amp; Pignataro           Standards Track                    [Page 6]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-7"></span>
<span class="grey"><a href="./rfc5885">RFC 5885</a>                        BFD VCCV                       June 2010</span>


      If the PW is established by signaling, then the BFD CV Type used
      for this encapsulation is either 0x10 or 0x20.

   In summary, for the IP/UDP encapsulation of BFD (BFD with IP/UDP
   headers), if a PW Associated Channel Header is used, the Channel Type
   MUST indicate either IPv4 (0x0021) or IPv6 (0x0057).  For the PW-ACH
   encapsulation of BFD (BFD without IP/UDP headers), the PW Associated
   Channel Header MUST be used and the Channel Type MUST indicate BFD
   Control packet (0x0007).

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.3.%20%20CV%20Types%20for%20BFD"></a><a class="selflink" href="#section-3.3" id="section-3.3">3.3</a>.  CV Types for BFD</span>

   The CV Type is defined as a bitmask field used to indicate the
   specific CV Type or Types (i.e., none, one, or more) of VCCV packets
   that may be sent on the VCCV control channel.  The CV Types shown in
   the table below augment those already defined in [<a href="./rfc5085" title='"Pseudowire Virtual Circuit Connectivity Verification (VCCV): A Control Channel for Pseudowires"'>RFC5085</a>].  Their
   values shown in parentheses represent the numerical value
   corresponding to the actual bit being set in the CV Type bitfield.

   BFD CV Types:

      The defined values for the different BFD CV Types for MPLS and
      L2TPv3 PWs are:

      Bit (Value)   Description
      ============  ====================================================
      Bit 2 (0x04)  BFD IP/UDP-encapsulated, for PW Fault Detection only
      Bit 3 (0x08)  BFD IP/UDP-encapsulated, for PW Fault Detection and
                    AC/PW Fault Status Signaling
      Bit 4 (0x10)  BFD PW-ACH-encapsulated, for PW Fault Detection only
      Bit 5 (0x20)  BFD PW-ACH-encapsulated, for PW Fault Detection and
                    AC/PW Fault Status Signaling

   It should be noted that four BFD CV Types have been defined by
   combining two types of encapsulation with two types of functionality;
   see Table 1 in <a href="#section-3">Section 3</a>.

   Given the bidirectional nature of BFD, before selecting a given BFD
   CV Type capability to be used in dynamically established pseudowires,
   there MUST be common CV Types in the VCCV capability advertised and
   received.  That is, only BFD CV Types that were both advertised and
   received are available to be selected.  Additionally, only one BFD CV
   Type can be used (selecting a BFD CV Type excludes all the remaining
   BFD CV Types).







<span class="grey">Nadeau &amp; Pignataro           Standards Track                    [Page 7]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-8"></span>
<span class="grey"><a href="./rfc5885">RFC 5885</a>                        BFD VCCV                       June 2010</span>


   The following list enumerates rules, restrictions, and clarifications
   on the usage of BFD CV Types:

   1.  BFD CV Types used for fault detection and status signaling (i.e.,
       CV Types 0x08 and 0x20) SHOULD NOT be used when a control
       protocol such as LDP [<a href="./rfc4447" title='"Pseudowire Setup and Maintenance Using the Label Distribution Protocol (LDP)"'>RFC4447</a>] or L2TPV3 [<a href="./rfc3931" title='"Layer Two Tunneling Protocol - Version 3 (L2TPv3)"'>RFC3931</a>] is available
       that can signal the AC/PW status to the remote endpoint of the
       PW.  More details can be found in [<a href="#ref-OAM-MSG-MAP" title='"Pseudowire (PW) OAM Message Mapping"'>OAM-MSG-MAP</a>].

   2.  BFD CV Types used for fault detection only (i.e., CV Types 0x04
       and 0x10) can be used whether or not a protocol that can signal
       AC/PW status is available.  This includes both statically
       provisioned and dynamically signaled pseudowires.

       2.1.  In this case, BFD is used exclusively to detect faults on
             the PW; if it is desired to convey AC/PW fault status, some
             means other than BFD are to be used.  Examples include
             using LDP status messages when using MPLS as a transport
             (see <a href="./rfc4447#section-5.4">SectionÂ 5.4 of [RFC4447]</a>), and the Circuit Status
             Attribute Value Pair (AVP) in an L2TPv3 SLI message for
             L2TPv3 (see <a href="./rfc3931#section-5.4.5">SectionÂ 5.4.5 of [RFC3931]</a>).

   3.  Pseudowires that do not use a CW or L2SS using the PW Associated
       Channel Header MUST NOT use the BFD CV Types 0x10 or 0x20 (i.e.,
       PW-ACH encapsulation of BFD, without IP/UDP headers).

       3.1.  PWs that use a PW-ACH include CC Type 1 (for both MPLS and
             L2TPv3 as defined in Sections <a href="#section-5.1.1">5.1.1</a> and <a href="#section-6.1">6.1</a> of [<a href="./rfc5085" title='"Pseudowire Virtual Circuit Connectivity Verification (VCCV): A Control Channel for Pseudowires"'>RFC5085</a>]),
             and MPLS CC Types 2 and 3 when using a Control Word (as
             specified in Sections <a href="#section-5.1.2">5.1.2</a> and <a href="#section-5.1.3">5.1.3</a> of [<a href="./rfc5085" title='"Pseudowire Virtual Circuit Connectivity Verification (VCCV): A Control Channel for Pseudowires"'>RFC5085</a>]).  This
             restriction stems from the fact that the encapsulation uses
             the Channel Type in the PW-ACH.

       3.2.  PWs that do not use a PW-ACH can use the VCCV BFD
             encapsulation with IP/UDP headers, as the only VCCV BFD
             encapsulation supported.  Using the IP/UDP encapsulated BFD
             CV Types allows for the concurrent use of other VCCV CV
             Types that use an encapsulation with IP headers (e.g., ICMP
             Ping or LSP Ping defined in [<a href="./rfc5085" title='"Pseudowire Virtual Circuit Connectivity Verification (VCCV): A Control Channel for Pseudowires"'>RFC5085</a>]).

   4.  Only a single BFD CV Type can be selected and used.  All BFD CV
       Types are mutually exclusive.  After selecting a BFD CV Type, a
       node MUST NOT use any of the other three BFD CV Types.

   5.  Once a PE has chosen a single BFD CV Type to use, it MUST
       continue using it until when the PW is re-signaled.  In order to
       change the negotiated and selected BFD CV Type, the PW must be
       torn down and re-established.



<span class="grey">Nadeau &amp; Pignataro           Standards Track                    [Page 8]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-9"></span>
<span class="grey"><a href="./rfc5885">RFC 5885</a>                        BFD VCCV                       June 2010</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/4.%20%20Capability%20Selection"></a><a class="selflink" href="#section-4" id="section-4">4</a>.  Capability Selection</span>

   The precedence rules for selection of various CC and CV Types is
   clearly outlined in <a href="./rfc5085#section-7">SectionÂ 7 of [RFC5085]</a>.  This section augments
   these rules when the BFD CV Types defined herein are supported.  The
   selection of a specific BFD CV Type to use out of the four available
   CV Types defined is tied to multiple factors, as described in
   <a href="#section-3.3">Section 3.3</a>.  Given that BFD is bidirectional in nature, only CV
   Types that are both received and sent in VCCV capability signaling
   advertisement can be selected.

   When multiple BFD CV Types are advertised, and after applying the
   rules in <a href="#section-3.3">Section 3.3</a>, the set that both ends of the pseudowire have
   in common is determined.  If the two ends have more than one BFD CV
   Type in common, the following list of BFD CV Types is considered in
   the order of the lowest list number CV Type to the highest list
   number CV Type, and the CV Type with the lowest list number is used:

   1.  0x20 - BFD PW-ACH-encapsulated (without IP/UDP headers), for PW
       Fault Detection and AC/PW Fault Status Signaling

   2.  0x10 - BFD PW-ACH-encapsulated (without IP/UDP headers), for PW
       Fault Detection only

   3.  0x08 - BFD IP/UDP-encapsulated, for PW Fault Detection and AC/PW
       Fault Status Signaling

   4.  0x04 - BFD IP/UDP-encapsulated, for PW Fault Detection only























<span class="grey">Nadeau &amp; Pignataro           Standards Track                    [Page 9]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-10"></span>
<span class="grey"><a href="./rfc5885">RFC 5885</a>                        BFD VCCV                       June 2010</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.%20%20IANA%20Considerations"></a><a class="selflink" href="#section-5" id="section-5">5</a>.  IANA Considerations</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.1.%20%20MPLS%20CV%20Types%20for%20the%20VCCV%20Interface%20Parameters%20Sub-TLV"></a><a class="selflink" href="#section-5.1" id="section-5.1">5.1</a>.  MPLS CV Types for the VCCV Interface Parameters Sub-TLV</span>

   The VCCV Interface Parameters Sub-TLV codepoint is defined in
   [<a href="./rfc4446" title='"IANA Allocations for Pseudowire Edge to Edge Emulation (PWE3)"'>RFC4446</a>], and the VCCV CV Types registry is defined in [<a href="./rfc5085" title='"Pseudowire Virtual Circuit Connectivity Verification (VCCV): A Control Channel for Pseudowires"'>RFC5085</a>].
   This section lists the new BFD CV Types.

   IANA has augmented the "VCCV Connectivity Verification (CV) Types"
   registry in the Pseudowire Name Spaces reachable from [<a href="#ref-IANA" title='"Protocol Registries"'>IANA</a>].  These
   are bitfield values.  CV Type values 0x04, 0x08, 0x10, and 0x20 are
   specified in <a href="#section-3">Section 3</a> of this document.

      MPLS Connectivity Verification (CV) Types:

      Bit (Value)   Description
      ============  ====================================================
      Bit 2 (0x04)  BFD IP/UDP-encapsulated, for PW Fault Detection only
      Bit 3 (0x08)  BFD IP/UDP-encapsulated, for PW Fault Detection and
                    AC/PW Fault Status Signaling
      Bit 4 (0x10)  BFD PW-ACH-encapsulated, for PW Fault Detection only
      Bit 5 (0x20)  BFD PW-ACH-encapsulated, for PW Fault Detection and
                    AC/PW Fault Status Signaling

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.2.%20%20PW%20Associated%20Channel%20Type"></a><a class="selflink" href="#section-5.2" id="section-5.2">5.2</a>.  PW Associated Channel Type</span>

   The PW Associated Channel Types used by VCCV rely on previously
   allocated numbers from the Pseudowire Associated Channel Types
   Registry [<a href="./rfc4385" title='"Pseudowire Emulation Edge-to-Edge (PWE3) Control Word for Use over an MPLS PSN"'>RFC4385</a>] in the Pseudowire Name Spaces reachable from
   [<a href="#ref-IANA" title='"Protocol Registries"'>IANA</a>].

   IANA has reserved a new Pseudowire Associated Channel Type value as
   follows:

   Registry:
                                                TLV
    Value   Description                         Follows  Reference
    ------  ----------------------------------  -------  ---------------
    0x0007  BFD Control, PW-ACH encapsulation   No       [This document]
            (without IP/UDP Headers)











<span class="grey">Nadeau &amp; Pignataro           Standards Track                   [Page 10]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-11"></span>
<span class="grey"><a href="./rfc5885">RFC 5885</a>                        BFD VCCV                       June 2010</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.3.%20%20L2TPv3%20CV%20Types%20for%20the%20VCCV%20Capability%20AVP"></a><a class="selflink" href="#section-5.3" id="section-5.3">5.3</a>.  L2TPv3 CV Types for the VCCV Capability AVP</span>

   This section lists the new BFD CV Types to be added to the existing
   "VCCV Capability AVP" registry in the L2TP name spaces.  The Layer
   Two Tunneling Protocol "L2TP" Name Spaces are reachable from [<a href="#ref-IANA" title='"Protocol Registries"'>IANA</a>].

   IANA has reserved the following L2TPv3 Connectivity Verification (CV)
   Types in the VCCV Capability AVP Values registry.

      VCCV Capability AVP (Attribute Type 96) Values
      ----------------------------------------------

      L2TPv3 Connectivity Verification (CV) Types:

      Bit (Value)   Description
      ============  ====================================================
      Bit 2 (0x04)  BFD IP/UDP-encapsulated, for PW Fault Detection only
      Bit 3 (0x08)  BFD IP/UDP-encapsulated, for PW Fault Detection and
                    AC/PW Fault Status Signaling
      Bit 4 (0x10)  BFD PW-ACH-encapsulated, for PW Fault Detection only
      Bit 5 (0x20)  BFD PW-ACH-encapsulated, for PW Fault Detection and
                    AC/PW Fault Status Signaling

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/6.%20%20Congestion%20Considerations"></a><a class="selflink" href="#section-6" id="section-6">6</a>.  Congestion Considerations</span>

   The congestion considerations that apply to [<a href="./rfc5085" title='"Pseudowire Virtual Circuit Connectivity Verification (VCCV): A Control Channel for Pseudowires"'>RFC5085</a>] apply to this
   mode of operation as well.  This section describes explicitly how
   they apply.

   BFD as a VCCV application is required to provide details on
   congestion and bandwidth considerations.  BFD provides with a desired
   minimum transmit interval and a required minimum receive interval,
   negotiates the transmission interval using these configurable fields,
   and has a packet of fixed size (setting the transmission rate).
   Therefore, it results in a configuration limited bandwidth
   utilization.  As stated in [<a href="./rfc5085" title='"Pseudowire Virtual Circuit Connectivity Verification (VCCV): A Control Channel for Pseudowires"'>RFC5085</a>], this is sufficient protection
   against congestion as long as BFD's configured maximum bit-rate is
   minimal compared to the bit-rate of the pseudowire the VCCV channel
   is associated with.  If the pseudowire bit-rate can't be guaranteed
   to be minimal, like potentially for highly variable bit-rate and/or
   congestion responsive pseudowires, BFD will be required to operate
   using an adaptive congestion control mechanism (for example,
   including a throttled transmission rate on "congestion detected"
   situations, and a slow-start after shutdown due to congestion and
   until basic connectivity is verified).






<span class="grey">Nadeau &amp; Pignataro           Standards Track                   [Page 11]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-12"></span>
<span class="grey"><a href="./rfc5885">RFC 5885</a>                        BFD VCCV                       June 2010</span>


   Since the bandwidth utilized by BFD is configuration-limited, the
   VCCV channel MUST NOT be rate-limited below this maximum configurable
   bandwidth or BFD will not operate correctly.  The VCCV channel could
   provide rate-limiting above the maximum BFD rate, to protect from a
   misbehaving BFD application, so that it does not conflict and can
   coexist.  Additionally, the VCCV channel SHOULD NOT use any
   additional congestion control loop that would interfere or negatively
   interact with that of BFD.  There are no additional congestion
   considerations.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/7.%20%20Security%20Considerations"></a><a class="selflink" href="#section-7" id="section-7">7</a>.  Security Considerations</span>

   Routers that implement the additional CV Types defined herein are
   subject to the same security considerations as defined in [<a href="./rfc5085" title='"Pseudowire Virtual Circuit Connectivity Verification (VCCV): A Control Channel for Pseudowires"'>RFC5085</a>],
   [<a href="./rfc5880" title='"Bidirectional Forwarding Detection"'>RFC5880</a>], and [<a href="./rfc5881" title='"Bidirectional Forwarding Detection (BFD) for IPv4 and IPv6 (Single Hop)"'>RFC5881</a>].  This specification does not raise any
   additional security issues beyond these.  The IP/UDP-encapsulated BFD
   makes use of the TTL/Hop Limit procedures described in <a href="./rfc5881#section-5">SectionÂ 5 of
   [RFC5881]</a>, including the use of the Generalized TTL Security
   Mechanism (GTSM) as a security mechanism.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/8.%20%20Acknowledgements"></a><a class="selflink" href="#section-8" id="section-8">8</a>.  Acknowledgements</span>

   This work forks from a previous revision of the PWE3 WG document that
   resulted in [<a href="./rfc5085" title='"Pseudowire Virtual Circuit Connectivity Verification (VCCV): A Control Channel for Pseudowires"'>RFC5085</a>], to which a number of people contributed,
   including Rahul Aggarwal, Peter B. Busschbach, Yuichi Ikejiri, Kenji
   Kumaki, Luca Martini, Monique Morrow, George Swallow, and others.

   Mustapha Aissaoui, Sam Aldrin, Stewart Bryant, Peter B. Busschbach,
   Annamaria Fulignoli, Vishwas Manral, Luca Martini, Dave McDysan, Ben
   Niven-Jenkins, Pankil Shah, Yaakov Stein, and George Swallow provided
   useful feedback and valuable comments and suggestions improving newer
   versions of this document.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/9.%20%20References"></a><a class="selflink" href="#section-9" id="section-9">9</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/9.1.%20%20Normative%20References"></a><a class="selflink" href="#section-9.1" id="section-9.1">9.1</a>.  Normative References</span>

   [<a id="ref-RFC2119">RFC2119</a>]      Bradner, S., "Key words for use in RFCs to Indicate
                  Requirement Levels", <a href="https://www.rfc-editor.org/bcp/bcp14">BCP 14</a>, <a href="./rfc2119">RFC 2119</a>, March 1997.

   [<a id="ref-RFC4385">RFC4385</a>]      Bryant, S., Swallow, G., Martini, L., and D.
                  McPherson, "Pseudowire Emulation Edge-to-Edge (PWE3)
                  Control Word for Use over an MPLS PSN", <a href="./rfc4385">RFC 4385</a>,
                  February 2006.

   [<a id="ref-RFC5085">RFC5085</a>]      Nadeau, T. and C. Pignataro, "Pseudowire Virtual
                  Circuit Connectivity Verification (VCCV): A Control
                  Channel for Pseudowires", <a href="./rfc5085">RFC 5085</a>, December 2007.



<span class="grey">Nadeau &amp; Pignataro           Standards Track                   [Page 12]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-13"></span>
<span class="grey"><a href="./rfc5885">RFC 5885</a>                        BFD VCCV                       June 2010</span>


   [<a id="ref-RFC5880">RFC5880</a>]      Katz, D. and D. Ward, "Bidirectional Forwarding
                  Detection", <a href="./rfc5880">RFC 5880</a>, June 2010.

   [<a id="ref-RFC5881">RFC5881</a>]      Katz, D. and D. Ward, "Bidirectional Forwarding
                  Detection (BFD) for IPv4 and IPv6 (Single Hop)",
                  <a href="./rfc5881">RFC 5881</a>, June 2010.

   [<a id="ref-RFC5882">RFC5882</a>]      Katz, D. and D. Ward, "Generic Application of
                  Bidirectional Forwarding Detection (BFD)", <a href="./rfc5882">RFC 5882</a>,
                  June 2010.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/9.2.%20%20Informative%20References"></a><a class="selflink" href="#section-9.2" id="section-9.2">9.2</a>.  Informative References</span>

   [<a id="ref-IANA">IANA</a>]         Internet Assigned Numbers Authority, "Protocol
                  Registries", &lt;<a href="http://www.iana.org">http://www.iana.org</a>&gt;.

   [<a id="ref-OAM-MSG-MAP">OAM-MSG-MAP</a>]  Aissaoui, M., Busschbach, P., Morrow, M., Martini, L.,
                  Stein, Y., Allan, D., and T. Nadeau, "Pseudowire (PW)
                  OAM Message Mapping", Work in Progress, March 2010.

   [<a id="ref-RFC3931">RFC3931</a>]      Lau, J., Townsley, M., and I. Goyret, "Layer Two
                  Tunneling Protocol - Version 3 (L2TPv3)", <a href="./rfc3931">RFC 3931</a>,
                  March 2005.

   [<a id="ref-RFC4379">RFC4379</a>]      Kompella, K. and G. Swallow, "Detecting Multi-Protocol
                  Label Switched (MPLS) Data Plane Failures", <a href="./rfc4379">RFC 4379</a>,
                  February 2006.

   [<a id="ref-RFC4446">RFC4446</a>]      Martini, L., "IANA Allocations for Pseudowire Edge to
                  Edge Emulation (PWE3)", <a href="https://www.rfc-editor.org/bcp/bcp116">BCP 116</a>, <a href="./rfc4446">RFC 4446</a>, April 2006.

   [<a id="ref-RFC4447">RFC4447</a>]      Martini, L., Rosen, E., El-Aawar, N., Smith, T., and
                  G. Heron, "Pseudowire Setup and Maintenance Using the
                  Label Distribution Protocol (LDP)", <a href="./rfc4447">RFC 4447</a>,
                  April 2006.

   [<a id="ref-RFC5586">RFC5586</a>]      Bocci, M., Vigoureux, M., and S. Bryant, "MPLS Generic
                  Associated Channel", <a href="./rfc5586">RFC 5586</a>, June 2009.













<span class="grey">Nadeau &amp; Pignataro           Standards Track                   [Page 13]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-14"></span>
<span class="grey"><a href="./rfc5885">RFC 5885</a>                        BFD VCCV                       June 2010</span>


Authors' Addresses

   Thomas D. Nadeau (editor)
   BT
   BT Centre
   81 Newgate Street
   London  EC1A 7AJ
   United Kingdom

   EMail: tom.nadeau@bt.com


   Carlos Pignataro (editor)
   Cisco Systems, Inc.
   7200 Kit Creek Road
   PO Box 14987
   Research Triangle Park, NC  27709
   USA

   EMail: cpignata@cisco.com































Nadeau &amp; Pignataro           Standards Track                   [Page 14]
</pre>
</body></html>