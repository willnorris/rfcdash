<html><head></head><body><pre>Network Working Group                                        C. Jennings
Request for Comments: 3325                                 Cisco Systems
Category: Informational                                      J. Peterson
                                                           NeuStar, Inc.
                                                               M. Watson
                                                         Nortel Networks
                                                           November 2002


    <span class="h1">Private Extensions to the Session Initiation Protocol (SIP) for</span>
               <span class="h1">Asserted Identity within Trusted Networks</span>

Status of this Memo

   This memo provides information for the Internet community.  It does
   not specify an Internet standard of any kind.  Distribution of this
   memo is unlimited.

Copyright Notice

   Copyright (C) The Internet Society (2002).  All Rights Reserved.

Abstract

   This document describes private extensions to the Session Initiation
   Protocol (SIP) that enable a network of trusted SIP servers to assert
   the identity of authenticated users, and the application of existing
   privacy mechanisms to the identity problem.  The use of these
   extensions is only applicable inside an administrative domain with
   previously agreed-upon policies for generation, transport and usage
   of such information.  This document does NOT offer a general privacy
   or identity model suitable for use between different trust domains,
   or use in the Internet at large.

Table of Contents

   <a href="#section-1">1</a>.   Applicability Statement  . . . . . . . . . . . . . . . . . .   <a href="#page-2">2</a>
   <a href="#section-2">2</a>.   Conventions  . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-3">3</a>
   <a href="#section-3">3</a>.   Introduction . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-4">4</a>
   <a href="#section-4">4</a>.   Overview . . . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-5">5</a>
   <a href="#section-5">5</a>.   Proxy Behavior . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-5">5</a>
   <a href="#section-6">6</a>.   Hints for Multiple Identities  . . . . . . . . . . . . . . .   <a href="#page-6">6</a>
   <a href="#section-7">7</a>.   Requesting Privacy . . . . . . . . . . . . . . . . . . . . .   <a href="#page-6">6</a>
   <a href="#section-8">8</a>.   User Agent Server Behavior . . . . . . . . . . . . . . . . .   <a href="#page-7">7</a>
   <a href="#section-9">9</a>.   Formal Syntax  . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-7">7</a>
        <a href="#section-9.1">9.1</a>  The P-Asserted-Identity Header  . . . . . . . . . . . .   <a href="#page-8">8</a>
        <a href="#section-9.2">9.2</a>  The P-Preferred-Identity Header . . . . . . . . . . . .   <a href="#page-8">8</a>
        <a href="#section-9.3">9.3</a>  The "id" Privacy Type . . . . . . . . . . . . . . . . .   <a href="#page-9">9</a>



<span class="grey">Jennings, et. al.            Informational                      [Page 1]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-2"></span>
<span class="grey"><a href="./rfc3325">RFC 3325</a>                 SIP Asserted Identity             November 2002</span>


   <a href="#section-10">10</a>.  Examples . . . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-9">9</a>
        <a href="#section-10.1">10.1</a> Network Asserted Identity passed to trusted gateway . .   <a href="#page-9">9</a>
        <a href="#section-10.2">10.2</a> Network Asserted Identity Withheld  . . . . . . . . . .  <a href="#page-11">11</a>
   <a href="#section-11">11</a>.  Example of Spec(T) . . . . . . . . . . . . . . . . . . . . .  <a href="#page-13">13</a>
   <a href="#section-12">12</a>.  Security Considerations  . . . . . . . . . . . . . . . . . .  <a href="#page-14">14</a>
   <a href="#section-13">13</a>.  IANA Considerations  . . . . . . . . . . . . . . . . . . . .  <a href="#page-14">14</a>
        <a href="#section-13.1">13.1</a> Registration of new SIP header fields . . . . . . . . .  <a href="#page-14">14</a>
        13.2 Registration of "id" privacy type for SIP Privacy header 15
   <a href="#section-14">14</a>.  Acknowledgements . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-15">15</a>
        Normative References . . . . . . . . . . . . . . . . . . . .  <a href="#page-15">15</a>
        Informational References . . . . . . . . . . . . . . . . . .  <a href="#page-16">16</a>
        Authors' Addresses . . . . . . . . . . . . . . . . . . . . .  <a href="#page-17">17</a>
        Full Copyright Statement . . . . . . . . . . . . . . . . . .  <a href="#page-18">18</a>

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/1.%20Applicability%20Statement"></a><a class="selflink" href="#section-1" id="section-1">1</a>. Applicability Statement</span>

   This document describes private extensions to SIP [<a href="#ref-1" title='"SIP: Session Initiation Protocol"'>1</a>] that enable a
   network of trusted SIP servers to assert the identity of end users or
   end systems, and to convey indications of end-user requested privacy.
   The use of these extensions is only applicable inside a 'Trust
   Domain' as defined in Short term requirements for Network Asserted
   Identity [<a href="#ref-5" title='"Short Term Requirements for Network Asserted Identity"'>5</a>].  Nodes in such a Trust Domain are explicitly trusted by
   its users and end-systems to publicly assert the identity of each
   party, and to be responsible for withholding that identity outside of
   the Trust Domain when privacy is requested.  The means by which the
   network determines the identity to assert is outside the scope of
   this document (though it commonly entails some form of
   authentication).

   A key requirement of [<a href="#ref-5" title='"Short Term Requirements for Network Asserted Identity"'>5</a>] is that the behavior of all nodes within a
   given Trust Domain 'T' is known to comply to a certain set of
   specifications known as 'Spec(T)'.  Spec(T) MUST specify behavior for
   the following:

   1. The manner in which users are authenticated

   2. The mechanisms used to secure the communication among nodes within
      the Trust Domain

   3. The mechanisms used to secure the communication between UAs and
      nodes within the Trust Domain










<span class="grey">Jennings, et. al.            Informational                      [Page 2]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-3"></span>
<span class="grey"><a href="./rfc3325">RFC 3325</a>                 SIP Asserted Identity             November 2002</span>


   4. The manner used to determine which hosts are part of the Trust
      Domain

   5. The default privacy handling when no Privacy header field is
      present

   6. That nodes in the Trust Domain are compliant to SIP [<a href="#ref-1" title='"SIP: Session Initiation Protocol"'>1</a>]

   7. That nodes in the Trust Domain are compliant to this document

   8. Privacy handling for identity as described in <a href="#section-7">Section 7</a>.

   An example of a suitable Spec(T) is shown in <a href="#section-11">Section 11</a>.

   This document does NOT offer a general privacy or identity model
   suitable for inter-domain use or use in the Internet at large.  Its
   assumptions about the trust relationship between the user and the
   network may not apply in many applications.  For example, these
   extensions do not accommodate a model whereby end users can
   independently assert their identity by use of the extensions defined
   here.  Furthermore, since the asserted identities are not
   cryptographically certified, they are subject to forgery, replay, and
   falsification in any architecture that does not meet the requirements
   of [<a href="#ref-5" title='"Short Term Requirements for Network Asserted Identity"'>5</a>].

   The asserted identities also lack an indication of who specifically
   is asserting the identity, and so it must be assumed that the Trust
   Domain is asserting the identity.  Therefore, the information is only
   meaningful when securely received from a node known to be a member of
   the Trust Domain.

   Despite these limitations, there are sufficiently useful specialized
   deployments that meet the assumptions described above, and can accept
   the limitations that result, to warrant informational publication of
   this mechanism.  An example deployment would be a closed network
   which emulates a traditional circuit switched telephone network.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/2.%20Conventions"></a><a class="selflink" href="#section-2" id="section-2">2</a>. Conventions</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in <a href="https://www.rfc-editor.org/bcp/bcp14">BCP 14</a>, <a href="./rfc2119">RFC 2119</a> [<a href="#ref-3" title='"Key words for use in RFCs to Indicate Requirement Levels"'>3</a>].

   Throughout this document requirements for or references to proxy
   servers or proxy behavior apply similarly to other intermediaries
   within a Trust Domain (ex: B2BUAs).





<span class="grey">Jennings, et. al.            Informational                      [Page 3]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-4"></span>
<span class="grey"><a href="./rfc3325">RFC 3325</a>                 SIP Asserted Identity             November 2002</span>


   The terms Identity, Network Asserted Identity and Trust Domain in
   this document have meanings as defined in [<a href="#ref-5" title='"Short Term Requirements for Network Asserted Identity"'>5</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.%20Introduction"></a><a class="selflink" href="#section-3" id="section-3">3</a>. Introduction</span>

   Various providers offering a telephony service over IP networks have
   selected SIP as a call establishment protocol.  Their environments
   require a way for trusted network elements operated by the service
   providers (for example SIP proxy servers) to communicate the identity
   of the subscribers to such a service, yet also need to withhold this
   information from entities that are not trusted when necessary.  Such
   networks typically assume some level of transitive trust amongst
   providers and the devices they operate.

   These networks need to support certain traditional telephony services
   and meet basic regulatory and public safety requirements.  These
   include Calling Identity Delivery services, Calling Identity Delivery
   Blocking, and the ability to trace the originator of a call.  While
   baseline SIP can support each of these services independently,
   certain combinations cannot be supported without the extensions
   described in this document.  For example, a caller that wants to
   maintain privacy and consequently provides limited information in the
   SIP From header field will not be identifiable by recipients of the
   call unless they rely on some other means to discover the identity of
   the caller.  Masking identity information at the originating user
   agent will prevent certain services, e.g., call trace, from working
   in the Public Switched Telephone Network (PSTN) or being performed at
   intermediaries not privy to the authenticated identity of the user.

   This document attempts to provide a network asserted identity service
   using a very limited, simple mechanism, based on requirements in [<a href="#ref-5" title='"Short Term Requirements for Network Asserted Identity"'>5</a>].
   This work is derived from a previous attempt, [<a href="#ref-6" title='"SIP Extensions for Network-Asserted Caller Identity and Privacy within Trusted Networks"'>6</a>], to solve several
   problems related to privacy and identity in Trust Domains.  A more
   comprehensive mechanism, [<a href="#ref-7" title='"Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP)"'>7</a>] which uses cryptography to address this
   problem is the subject of current study by the SIP working group.

   Providing privacy in a SIP network is more complicated than in the
   PSTN.  In SIP networks, the participants in a session are typically
   able to exchange IP traffic directly without involving any SIP
   service provider.  The IP addresses used for these sessions may
   themselves reveal private information.  A general purpose mechanism
   for providing privacy in a SIP environment is discussed in [<a href="#ref-2" title='"A Privacy Mechanism for the Session Initiation Protocol (SIP)"'>2</a>].  This
   document applies that privacy mechanism to the problem of network
   asserted identity.







<span class="grey">Jennings, et. al.            Informational                      [Page 4]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-5"></span>
<span class="grey"><a href="./rfc3325">RFC 3325</a>                 SIP Asserted Identity             November 2002</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/4.%20Overview"></a><a class="selflink" href="#section-4" id="section-4">4</a>. Overview</span>

   The mechanism proposed in this document relies on a new header field
   called 'P-Asserted-Identity' that contains a URI (commonly a SIP URI)
   and an optional display-name, for example:

      P-Asserted-Identity: "Cullen Jennings" &lt;sip:fluffy@cisco.com&gt;

   A proxy server which handles a message can, after authenticating the
   originating user in some way (for example: Digest authentication),
   insert such a P-Asserted-Identity header field into the message and
   forward it to other trusted proxies.  A proxy that is about to
   forward a message to a proxy server or UA that it does not trust MUST
   remove all the P-Asserted-Identity header field values if the user
   requested that this information be kept private.  Users can request
   this type of privacy as described in <a href="#section-7">Section 7</a>.

   The formal syntax for the P-Asserted-Identity header is presented in
   <a href="#section-9">Section 9</a>.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.%20Proxy%20Behavior"></a><a class="selflink" href="#section-5" id="section-5">5</a>. Proxy Behavior</span>

   A proxy in a Trust Domain can receive a message from a node that it
   trusts, or a node that it does not trust.  When a proxy receives a
   message from a node it does not trust and it wishes to add a P-
   Asserted-Identity header field, the proxy MUST authenticate the
   originator of the message, and use the identity which results from
   this authentication to insert a P-Asserted-Identity header field into
   the message.

   If the proxy receives a message (request or response) from a node
   that it trusts, it can use the information in the P-Asserted-Identity
   header field, if any, as if it had authenticated the user itself.

   If there is no P-Asserted-Identity header field present, a proxy MAY
   add one containing at most one SIP or SIPS URI, and at most one tel
   URL.  If the proxy received the message from an element that it does
   not trust and there is a P-Asserted-Identity header present which
   contains a SIP or SIPS URI, the proxy MUST replace that SIP or SIPS
   URI with a single SIP or SIPS URI or remove this header field.
   Similarly, if the proxy received the message from an element that it
   does not trust and there is a P-Asserted-Identity header present
   which contains a tel URI, the proxy MUST replace that tel URI with a
   single tel URI or remove the header field.

   When a proxy forwards a message to another node, it must first
   determine if it trusts that node or not.  If it trusts the node, the
   proxy does not remove any P-Asserted-Identity header fields that it



<span class="grey">Jennings, et. al.            Informational                      [Page 5]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-6"></span>
<span class="grey"><a href="./rfc3325">RFC 3325</a>                 SIP Asserted Identity             November 2002</span>


   generated itself, or that it received from a trusted source.  If it
   does not trust the element, then the proxy MUST examine the Privacy
   header field (if present) to determine if the user requested that
   asserted identity information be kept private.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/6.%20Hints%20for%20Multiple%20Identities"></a><a class="selflink" href="#section-6" id="section-6">6</a>. Hints for Multiple Identities</span>

   If a P-Preferred-Identity header field is present in the message that
   a proxy receives from an entity that it does not trust, the proxy MAY
   use this information as a hint suggesting which of multiple valid
   identities for the authenticated user should be asserted.  If such a
   hint does not correspond to any valid identity known to the proxy for
   that user, the proxy can add a P-Asserted-Identity header of its own
   construction, or it can reject the request (for example, with a 403
   Forbidden).  The proxy MUST remove the user-provided P-Preferred-
   Identity header from any message it forwards.

   A user agent only sends a P-Preferred-Identity header field to proxy
   servers in a Trust Domain; user agents MUST NOT populate the P-
   Preferred-Identity header field in a message that is not sent
   directly to a proxy that is trusted by the user agent.  Were a user
   agent to send a message containing a P-Preferred-Identity header
   field to a node outside a Trust Domain, then the hinted identity
   might not be managed appropriately by the network, which could have
   negative ramifications for privacy.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/7.%20Requesting%20Privacy"></a><a class="selflink" href="#section-7" id="section-7">7</a>. Requesting Privacy</span>

   Parties who wish to request the removal of P-Asserted-Identity header
   fields before they are transmitted to an element that is not trusted
   may add the "id" privacy token defined in this document to the
   Privacy header field.  The Privacy header field is defined in [<a href="#ref-6" title='"SIP Extensions for Network-Asserted Caller Identity and Privacy within Trusted Networks"'>6</a>].
   If this token is present, proxies MUST remove all the P-Asserted-
   Identity header fields before forwarding messages to elements that
   are not trusted.  If the Privacy header field value is set to "none"
   then the proxy MUST NOT remove the P-Asserted-Identity header fields.

   When a proxy is forwarding the request to an element that is not
   trusted and there is no Privacy header field, the proxy MAY include
   the P-Asserted-Identity header field or it MAY remove it.  This
   decision is a policy matter of the Trust Domain and MUST be specified
   in Spec(T).  It is RECOMMENDED that the P-Asserted-Identity header
   fields SHOULD NOT be removed unless local privacy policies prevent
   it, because removal may cause services based on Asserted Identity to
   fail.






<span class="grey">Jennings, et. al.            Informational                      [Page 6]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-7"></span>
<span class="grey"><a href="./rfc3325">RFC 3325</a>                 SIP Asserted Identity             November 2002</span>


   However, it should be noted that unless all users of the Trust Domain
   have access to appropriate privacy services, forwarding of the P-
   Asserted-Identity may result in disclosure of information which the
   user has not requested and cannot prevent.  It is therefore STRONGLY
   RECOMMENDED that all users have access to privacy services as
   described in this document.

   Formal specification of the "id" Privacy header priv-value is
   described in <a href="#section-9.3">Section 9.3</a>.  Some general guidelines for when users
   require privacy are given in [<a href="#ref-2" title='"A Privacy Mechanism for the Session Initiation Protocol (SIP)"'>2</a>].

   If multiple P-Asserted-Identity header field values are present in a
   message, and privacy of the P-Asserted-Identity header field is
   requested, then all instances of the header field values MUST be
   removed before forwarding the request to an entity that is not
   trusted.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/8.%20User%20Agent%20Server%20Behavior"></a><a class="selflink" href="#section-8" id="section-8">8</a>. User Agent Server Behavior</span>

   Typically, a user agent renders the value of a P-Asserted-Identity
   header field that it receives to its user.  It may consider the
   identity provided by a Trust Domain to be privileged, or
   intrinsically more trustworthy than the From header field of a
   request.  However, any specific behavior is specific to
   implementations or services.  This document also does not mandate any
   user agent handling for multiple P-Asserted-Identity header field
   values that happen to appear in a message (such as a SIP URI
   alongside a tel URL).

   However, if a User Agent Server receives a message from a previous
   element that it does not trust, it MUST NOT use the P-Asserted-
   Identity header field in any way.

   If a UA is part of the Trust Domain from which it received a message
   containing a P-Asserted-Identity header field, then it can use the
   value freely but it MUST ensure that it does not forward the
   information to any element that is not part of the Trust Domain, if
   the user has requested that asserted identity information be kept
   private.

   If a UA is not part of the Trust Domain from which it received a
   message containing a P-Asserted-Identity header field, then it can
   assume this information does not need to be kept private.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/9.%20Formal%20Syntax"></a><a class="selflink" href="#section-9" id="section-9">9</a>. Formal Syntax</span>

   The following syntax specification uses the augmented Backus-Naur
   Form (BNF) as described in <a href="./rfc2234">RFC-2234</a> [<a href="#ref-4" title='"Augmented BNF for Syntax Specifications: ABNF"'>4</a>].



<span class="grey">Jennings, et. al.            Informational                      [Page 7]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-8"></span>
<span class="grey"><a href="./rfc3325">RFC 3325</a>                 SIP Asserted Identity             November 2002</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/9.1%20The%20P-Asserted-Identity%20Header"></a><a class="selflink" href="#section-9.1" id="section-9.1">9.1</a> The P-Asserted-Identity Header</span>

   The P-Asserted-Identity header field is used among trusted SIP
   entities (typically intermediaries) to carry the identity of the user
   sending a SIP message as it was verified by authentication.

      PAssertedID = "P-Asserted-Identity" HCOLON PAssertedID-value
                      *(COMMA PAssertedID-value)
      PAssertedID-value = name-addr / addr-spec

   A P-Asserted-Identity header field value MUST consist of exactly one
   name-addr or addr-spec.  There may be one or two P-Asserted-Identity
   values.  If there is one value, it MUST be a sip, sips, or tel URI.
   If there are two values, one value MUST be a sip or sips URI and the
   other MUST be a tel URI.  It is worth noting that proxies can (and
   will) add and remove this header field.

   This document adds the following entry to Table 2 of [<a href="#ref-1" title='"SIP: Session Initiation Protocol"'>1</a>]:

      Header field         where   proxy   ACK  BYE  CAN  INV  OPT  REG
      ------------         -----   -----   ---  ---  ---  ---  ---  ---
      P-Asserted-Identity           adr     -    o    -    o    o    -


                                           SUB  NOT  REF  INF  UPD  PRA
                                           ---  ---  ---  ---  ---  ---
                                            o    o    o    -    -    -

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/9.2%20The%20P-Preferred-Identity%20Header"></a><a class="selflink" href="#section-9.2" id="section-9.2">9.2</a> The P-Preferred-Identity Header</span>

   The P-Preferred-Identity header field is used from a user agent to a
   trusted proxy to carry the identity the user sending the SIP message
   wishes to be used for the P-Asserted-Header field value that the
   trusted element will insert.

      PPreferredID = "P-Preferred-Identity" HCOLON PPreferredID-value
                        *(COMMA PPreferredID-value)
      PPreferredID-value = name-addr / addr-spec

   A P-Preferred-Identity header field value MUST consist of exactly one
   name-addr or addr-spec.  There may be one or two P-Preferred-Identity
   values.  If there is one value, it MUST be a sip, sips, or tel URI.
   If there are two values, one value MUST be a sip or sips URI and the
   other MUST be a tel URI.  It is worth noting that proxies can (and
   will) remove this header field.






<span class="grey">Jennings, et. al.            Informational                      [Page 8]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-9"></span>
<span class="grey"><a href="./rfc3325">RFC 3325</a>                 SIP Asserted Identity             November 2002</span>


   This document adds the following entry to Table 2 of [<a href="#ref-1" title='"SIP: Session Initiation Protocol"'>1</a>]:

      Header field         where   proxy   ACK  BYE  CAN  INV  OPT  REG
      ------------         -----   -----   ---  ---  ---  ---  ---  ---
      P-Preferred-Identity          adr     -    o    -    o    o    -


                                           SUB  NOT  REF  INF  UPD  PRA
                                           ---  ---  ---  ---  ---  ---
                                            o    o    o    -    -    -

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/9.3%20The%20%22id%22%20Privacy%20Type"></a><a class="selflink" href="#section-9.3" id="section-9.3">9.3</a> The "id" Privacy Type</span>

   This specification adds a new privacy type ("priv-value") to the
   Privacy header, defined in [<a href="#ref-2" title='"A Privacy Mechanism for the Session Initiation Protocol (SIP)"'>2</a>].  The presence of this privacy type in
   a Privacy header field indicates that the user would like the Network
   Asserted Identity to be kept private with respect to SIP entities
   outside the Trust Domain with which the user authenticated.  Note
   that a user requesting multiple types of privacy MUST include all of
   the requested privacy types in its Privacy header field value.

      priv-value = "id"

     Example:

              Privacy: id

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/10.%20Examples"></a><a class="selflink" href="#section-10" id="section-10">10</a>. Examples</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/10.1%20Network%20Asserted%20Identity%20passed%20to%20trusted%20gateway"></a><a class="selflink" href="#section-10.1" id="section-10.1">10.1</a> Network Asserted Identity passed to trusted gateway</span>

   In this example, proxy.cisco.com creates a P-Asserted-Identity header
   field from an identity it discovered from SIP Digest authentication.
   It forwards this information to a trusted proxy which forwards it to
   a trusted gateway.  Note that these examples consist of partial SIP
   messages that illustrate only those headers relevant to the
   authenticated identity problem.

   * F1   useragent.cisco.com -&gt; proxy.cisco.com

   INVITE sip:+14085551212@cisco.com SIP/2.0
   Via: SIP/2.0/TCP useragent.cisco.com;branch=z9hG4bK-123
   To: &lt;sip:+14085551212@cisco.com&gt;
   From: "Anonymous" &lt;sip:anonymous@anonymous.invalid&gt;;tag=9802748
   Call-ID: 245780247857024504
   CSeq: 1 INVITE
   Max-Forwards: 70
   Privacy: id



<span class="grey">Jennings, et. al.            Informational                      [Page 9]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-10"></span>
<span class="grey"><a href="./rfc3325">RFC 3325</a>                 SIP Asserted Identity             November 2002</span>


   * F2   proxy.cisco.com -&gt; useragent.cisco.com

   SIP/2.0 407 Proxy Authorization
   Via: SIP/2.0/TCP useragent.cisco.com;branch=z9hG4bK-123
   To: &lt;sip:+14085551212@cisco.com&gt;;tag=123456
   From: "Anonymous" &lt;sip:anonymous@anonymous.invalid&gt;;tag=9802748
   Call-ID: 245780247857024504
   CSeq: 1 INVITE
   Proxy-Authenticate: .... realm="sip.cisco.com"

   * F3   useragent.cisco.com -&gt; proxy.cisco.com

   INVITE sip:+14085551212@cisco.com SIP/2.0
   Via: SIP/2.0/TCP useragent.cisco.com;branch=z9hG4bK-124
   To: &lt;sip:+14085551212@cisco.com&gt;
   From: "Anonymous" &lt;sip:anonymous@anonymous.invalid&gt;;tag=9802748
   Call-ID: 245780247857024504
   CSeq: 2 INVITE
   Max-Forwards: 70
   Privacy: id
   Proxy-Authorization: .... realm="sip.cisco.com" user="fluffy"

   * F4   proxy.cisco.com -&gt; proxy.pstn.net (trusted)

   INVITE sip:+14085551212@proxy.pstn.net SIP/2.0
   Via: SIP/2.0/TCP useragent.cisco.com;branch=z9hG4bK-124
   Via: SIP/2.0/TCP proxy.cisco.com;branch=z9hG4bK-abc
   To: &lt;sip:+14085551212@cisco.com&gt;
   From: "Anonymous" &lt;sip:anonymous@anonymous.invalid&gt;;tag=9802748
   Call-ID: 245780247857024504
   CSeq: 2 INVITE
   Max-Forwards: 69
   P-Asserted-Identity: "Cullen Jennings" &lt;sip:fluffy@cisco.com&gt;
   P-Asserted-Identity: tel:+14085264000
   Privacy: id
















<span class="grey">Jennings, et. al.            Informational                     [Page 10]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-11"></span>
<span class="grey"><a href="./rfc3325">RFC 3325</a>                 SIP Asserted Identity             November 2002</span>


   * F5   proxy.pstn.net -&gt; gw.pstn.net (trusted)

   INVITE sip:+14085551212@gw.pstn.net SIP/2.0
   Via: SIP/2.0/TCP useragent.cisco.com;branch=z9hG4bK-124
   Via: SIP/2.0/TCP proxy.cisco.com;branch=z9hG4bK-abc
   Via: SIP/2.0/TCP proxy.pstn.net;branch=z9hG4bK-a1b2
   To: &lt;sip:+14085551212@cisco.com&gt;
   From: "Anonymous" &lt;sip:anonymous@anonymous.invalid&gt;;tag=9802748
   Call-ID: 245780247857024504
   CSeq: 2 INVITE
   Max-Forwards: 68
   P-Asserted-Identity: "Cullen Jennings" &lt;sip:fluffy@cisco.com&gt;
   P-Asserted-Identity: tel:+14085264000
   Privacy: id

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/10.2%20Network%20Asserted%20Identity%20Withheld"></a><a class="selflink" href="#section-10.2" id="section-10.2">10.2</a> Network Asserted Identity Withheld</span>

   In this example, the User Agent sends an INVITE that indicates it
   would prefer the identity sip:fluffy@cisco.com to the first proxy,
   which authenticates this with SIP Digest.  The first proxy creates a
   P-Asserted-Identity header field and forwards it to a trusted proxy
   (outbound.cisco.com).  The next proxy removes the P-Asserted-Identity
   header field and the request for Privacy before forwarding this
   request onward to the biloxi.com proxy server which it does not
   trust.

   * F1    useragent.cisco.com -&gt; proxy.cisco.com

   INVITE sip:bob@biloxi.com SIP/2.0
   Via: SIP/2.0/TCP useragent.cisco.com;branch=z9hG4bK-a111
   To: &lt;sip:bob@biloxi.com&gt;
   From: "Anonymous" &lt;sip:anonymous@anonymous.invalid&gt;;tag=9802748
   Call-ID: 245780247857024504
   CSeq: 1 INVITE
   Max-Forwards: 70
   Privacy: id
   P-Preferred-Identity: "Cullen Jennings" &lt;sip:fluffy@cisco.com&gt;

   * F2    proxy.cisco.com -&gt; useragent.cisco.com
   SIP/2.0 407 Proxy Authorization
   Via: SIP/2.0/TCP useragent.cisco.com;branch=z9hG4bK-a111
   To: &lt;sip:bob@biloxi.com&gt;;tag=123456
   From: "Anonymous" &lt;sip:anonymous@anonymous.invalid&gt;;tag=9802748
   Call-ID: 245780247857024504
   CSeq: 1 INVITE
   Proxy-Authenticate: .... realm="cisco.com"





<span class="grey">Jennings, et. al.            Informational                     [Page 11]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-12"></span>
<span class="grey"><a href="./rfc3325">RFC 3325</a>                 SIP Asserted Identity             November 2002</span>


   * F3    useragent.cisco.com -&gt; proxy.cisco.com

   INVITE sip:bob@biloxi.com SIP/2.0
   Via: SIP/2.0/TCP useragent.cisco.com;branch=z9hG4bK-a123
   To: &lt;sip:bob@biloxi.com&gt;
   From: "Anonymous" &lt;sip:anonymous@anonymous.invalid&gt;;tag=9802748
   Call-ID: 245780247857024504
   CSeq: 2 INVITE
   Max-Forwards: 70
   Privacy: id
   P-Preferred-Identity: "Cullen Jennings" &lt;sip:fluffy@cisco.com&gt;
   Proxy-Authorization: .... realm="cisco.com" user="fluffy"

   * F4    proxy.cisco.com -&gt; outbound.cisco.com (trusted)

   INVITE sip:bob@biloxi SIP/2.0
   Via: SIP/2.0/TCP useragent.cisco.com;branch=z9hG4bK-a123
   Via: SIP/2.0/TCP proxy.cisco.com;branch=z9hG4bK-b234
   To: &lt;sip:bob@biloxi.com&gt;
   From: "Anonymous" &lt;sip:anonymous@anonymous.invalid&gt;;tag=9802748
   Call-ID: 245780247857024504
   CSeq: 2 INVITE
   Max-Forwards: 69
   P-Asserted-Identity: "Cullen Jennings" &lt;sip:fluffy@vovida.org&gt;
   Privacy: id

   * F5   outbound.cisco.com -&gt; proxy.biloxi.com (not trusted)

   INVITE sip:bob@biloxi SIP/2.0
   Via: SIP/2.0/TCP useragent.cisco.com;branch=z9hG4bK-a123
   Via: SIP/2.0/TCP proxy.cisco.com;branch=z9hG4bK-b234
   Via: SIP/2.0/TCP outbound.cisco.com;branch=z9hG4bK-c345
   To: &lt;sip:bob@biloxi.com&gt;
   From: "Anonymous" &lt;sip:anonymous@anonymous.invalid&gt;;tag=9802748
   Call-ID: 245780247857024504
   CSeq: 2 INVITE
   Max-Forwards: 68
   Privacy: id













<span class="grey">Jennings, et. al.            Informational                     [Page 12]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-13"></span>
<span class="grey"><a href="./rfc3325">RFC 3325</a>                 SIP Asserted Identity             November 2002</span>


   * F6   proxy.biloxi.com -&gt; bobster.biloxi.com

   INVITE sip:bob@bobster.biloxi.com SIP/2.0
   Via: SIP/2.0/TCP useragent.cisco.com;branch=z9hG4bK-a123
   Via: SIP/2.0/TCP proxy.cisco.com;branch=z9hG4bK-b234
   Via: SIP/2.0/TCP outbound.cisco.com;branch=z9hG4bK-c345
   Via: SIP/2.0/TCP proxy.biloxi.com;branch=z9hG4bK-d456
   To: &lt;sip:bob@biloxi.com&gt;
   From: "Anonymous" &lt;sip:anonymous@anonymous.invalid&gt;;tag=9802748
   Call-ID: 245780247857024504
   CSeq: 2 INVITE
   Max-Forwards: 67
   Privacy: id

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/11.%20Example%20of%20Spec%28T%29"></a><a class="selflink" href="#section-11" id="section-11">11</a>. Example of Spec(T)</span>

   The integrity of the mechanism described in this document relies on
   one node knowing (through configuration) that all of the nodes in a
   Trust Domain will behave in a predetermined way.  This requires the
   predetermined behavior to be clearly defined and for all nodes in the
   Trust Domain to be compliant.  The specification set that all nodes
   in a Trust Domain T must comply with is termed 'Spec(T)'.

   The remainder of this section presents an example Spec(T), which is
   not normative in any way.

      1. Protocol requirements

         The following specifications MUST be supported:

         1. <a href="./rfc3261">RFC 3261</a>

         2. <a href="./rfc3325">RFC 3325</a>

      2. Authentication requirements

         Users MUST be authenticated using SIP Digest Authentication.

      3. Security requirements

         Connections between nodes within the Trust Domain and between
         UAs and nodes in the Trust Domain MUST use TLS using a cipher
         suite of RSA_WITH_AES_128_CBC_SHA1.  Mutual authentication
         between nodes in the trust domain MUST be performed and
         confidentiality MUST be negotiated.






<span class="grey">Jennings, et. al.            Informational                     [Page 13]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-14"></span>
<span class="grey"><a href="./rfc3325">RFC 3325</a>                 SIP Asserted Identity             November 2002</span>


      4. Scope of Trust Domain

         The Trust Domain specified in this agreement consists of hosts
         which posses a valid certificate which is a) signed by
         examplerootca.org; b) whose subjectAltName ends with one of the
         following domain names:  trusted.div1.carrier-a.net,
         trusted.div2.carrier-a.net, sip.carrier-b.com; and c) whose
         domain name corresponds to the hostname in the subjectAltName
         in the certificate.

      5. Implicit handling when no Privacy header is present

         The elements in the trust domain must support the 'id' privacy
         service therefore absence of a Privacy header can be assumed to
         indicate that the user is not requesting any privacy.  If no
         Privacy header field is present in a request, elements in this
         Trust Domain MUST act as if no privacy is requested.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/12.%20Security%20Considerations"></a><a class="selflink" href="#section-12" id="section-12">12</a>. Security Considerations</span>

   The mechanism provided in this document is a partial consideration of
   the problem of identity and privacy in SIP.  For example, these
   mechanisms provide no means by which end users can securely share
   identity information end-to-end without a trusted service provider.
   Identity information that the user designates as 'private' can be
   inspected by any intermediaries participating in the Trust Domain.
   This information is secured by transitive trust, which is only as
   reliable as the weakest link in the chain of trust.

   When a trusted entity sends a message to any destination with that
   party's identity in a P-Asserted-Identity header field, the entity
   MUST take precautions to protect the identity information from
   eavesdropping and interception to protect the confidentiality and
   integrity of that identity information.  The use of transport or
   network layer hop-by-hop security mechanisms, such as TLS or IPSec
   with appropriate cipher suites, can satisfy this requirement.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/13.%20IANA%20Considerations"></a><a class="selflink" href="#section-13" id="section-13">13</a>. IANA Considerations</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/13.1%20Registration%20of%20new%20SIP%20header%20fields"></a><a class="selflink" href="#section-13.1" id="section-13.1">13.1</a> Registration of new SIP header fields</span>

   This document defines two new private SIP header fields, "P-
   Asserted-Identity" and "P-Preferred-Identity".  As recommended by the
   policy of the Transport Area, these headers have been registered by
   the IANA in the SIP header registry, using the RFC number of this
   document as its reference.





<span class="grey">Jennings, et. al.            Informational                     [Page 14]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-15"></span>
<span class="grey"><a href="./rfc3325">RFC 3325</a>                 SIP Asserted Identity             November 2002</span>


   Name of Header:          P-Asserted-Identity

   Short form:              none

   Registrant:              Cullen Jennings
                            fluffy@cisco.com

   Normative description:
   <a href="#section-9.1">Section 9.1</a> of this document

   Name of Header:          P-Preferred-Identity

   Short form:              none

   Registrant:              Cullen Jennings
                            fluffy@cisco.com

   Normative description:
   <a href="#section-9.2">Section 9.2</a> of this document

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/13.2%20Registration%20of%20%22id%22%20privacy%20type%20for%20SIP%20Privacy%20header"></a><a class="selflink" href="#section-13.2" id="section-13.2">13.2</a> Registration of "id" privacy type for SIP Privacy header</span>

   Name of privacy type:    id

   Short Description:       Privacy requested for Third-Party Asserted
                            Identity

   Registrant:              Cullen Jennings
                            fluffy@cisco.com

   Normative description:
   <a href="#section-9.3">Section 9.3</a> of this document

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/14.%20Acknowledgements"></a><a class="selflink" href="#section-14" id="section-14">14</a>. Acknowledgements</span>

   Thanks to Bill Marshall and Flemming Andreason [<a href="#ref-6" title='"SIP Extensions for Network-Asserted Caller Identity and Privacy within Trusted Networks"'>6</a>], Mark Watson [<a href="#ref-5" title='"Short Term Requirements for Network Asserted Identity"'>5</a>],
   and Jon Peterson [<a href="#ref-7" title='"Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP)"'>7</a>] for authoring drafts which represent the bulk of
   the text making up this document.  Thanks to many people for useful
   comments including Jonathan Rosenberg, Rohan Mahy and Paul Kyzivat.

Normative References

   [<a id="ref-1">1</a>] Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A.,
       Peterson, J., Sparks, R., Handley, M. and E. Schooler, "SIP:
       Session Initiation Protocol", <a href="./rfc3261">RFC 3261</a>, June 2002.

   [<a id="ref-2">2</a>] Peterson, J., "A Privacy Mechanism for the Session Initiation
       Protocol (SIP)", <a href="./rfc3323">RFC 3323</a>, November 2002.



<span class="grey">Jennings, et. al.            Informational                     [Page 15]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-16"></span>
<span class="grey"><a href="./rfc3325">RFC 3325</a>                 SIP Asserted Identity             November 2002</span>


   [<a id="ref-3">3</a>] Bradner, S., "Key words for use in RFCs to Indicate Requirement
       Levels", <a href="https://www.rfc-editor.org/bcp/bcp14">BCP 14</a>, <a href="./rfc2119">RFC 2119</a>, March 1997.

   [<a id="ref-4">4</a>] Crocker, D. and P. Overell, "Augmented BNF for Syntax
       Specifications: ABNF", <a href="./rfc2234">RFC 2234</a>, November 1997.

Informational References

   [<a id="ref-5">5</a>] Watson, M., "Short Term Requirements for Network Asserted
       Identity", <a href="./rfc3324">RFC 3324</a>, November 2002.

   [<a id="ref-6">6</a>] Andreasen, F., "SIP Extensions for Network-Asserted Caller
       Identity and Privacy within Trusted Networks", Work in Progress.

   [<a id="ref-7">7</a>] Peterson, J., "Enhancements for Authenticated Identity Management
       in the Session Initiation Protocol (SIP)", Work in Progress.



































<span class="grey">Jennings, et. al.            Informational                     [Page 16]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-17"></span>
<span class="grey"><a href="./rfc3325">RFC 3325</a>                 SIP Asserted Identity             November 2002</span>


Authors' Addresses

   Cullen Jennings
   Cisco Systems
   170 West Tasman Drive
   MS: SJC-21/3
   San Jose, CA  95134
   USA

   Phone: +1 408 527-9132
   EMail: fluffy@cisco.com


   Jon Peterson
   NeuStar, Inc.
   1800 Sutter Street, Suite 570
   Concord, CA  94520
   USA

   Phone: +1 925/363-8720
   EMail: Jon.Peterson@NeuStar.biz


   Mark Watson
   Nortel Networks
   Maidenhead Office Park (Bray House)
   Westacott Way
   Maidenhead, Berkshire
   England

   Phone: +44 (0)1628-434456
   EMail: mwatson@nortelnetworks.com



















<span class="grey">Jennings, et. al.            Informational                     [Page 17]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-18"></span>
<span class="grey"><a href="./rfc3325">RFC 3325</a>                 SIP Asserted Identity             November 2002</span>


Full Copyright Statement

   Copyright (C) The Internet Society (2002).  All Rights Reserved.

   This document and translations of it may be copied and furnished to
   others, and derivative works that comment on or otherwise explain it
   or assist in its implementation may be prepared, copied, published
   and distributed, in whole or in part, without restriction of any
   kind, provided that the above copyright notice and this paragraph are
   included on all such copies and derivative works.  However, this
   document itself may not be modified in any way, such as by removing
   the copyright notice or references to the Internet Society or other
   Internet organizations, except as needed for the purpose of
   developing Internet standards in which case the procedures for
   copyrights defined in the Internet Standards process must be
   followed, or as required to translate it into languages other than
   English.

   The limited permissions granted above are perpetual and will not be
   revoked by the Internet Society or its successors or assigns.

   This document and the information contained herein is provided on an
   "AS IS" basis and THE INTERNET SOCIETY AND THE INTERNET ENGINEERING
   TASK FORCE DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED, INCLUDING
   BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE INFORMATION
   HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED WARRANTIES OF
   MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

Acknowledgement

   Funding for the RFC Editor function is currently provided by the
   Internet Society.



















Jennings, et. al.            Informational                     [Page 18]
</pre>
</body></html>