<html><head></head><body><pre>Network Working Group                                       P. Srisuresh
Request for Comments: 2888                         Campio Communications
Category: Informational                                      August 2000


                     <span class="h1">Secure Remote Access with L2TP</span>

Status of this Memo

   This memo provides information for the Internet community.  It does
   not specify an Internet standard of any kind.  Distribution of this
   memo is unlimited.

Copyright Notice

   Copyright (C) The Internet Society (2000).  All Rights Reserved.

Abstract

   L2TP protocol is a virtual extension of PPP across IP network
   infrastructure. L2TP makes possible for an access concentrator (LAC)
   to be near remote clients, while allowing PPP termination server
   (LNS) to be located in enterprise premises. L2TP allows an enterprise
   to retain control of RADIUS data base, which is used to control
   Authentication, Authorization and Accountability (AAA) of dial-in
   users. The objective of this document is to extend security
   characteristics of IPsec to remote access users, as they dial-in
   through the Internet. This is accomplished without creating new
   protocols and using the existing practices of Remote Access and
   IPsec. Specifically, the document proposes three new RADIUS
   parameters for use by the LNS node, acting as Secure Remote Access
   Server (SRAS) to mandate network level security between remote
   clients and the enterprise. The document also discusses limitations
   of the approach.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/1.%20Introduction%20and%20Overview"></a><a class="selflink" href="#section-1" id="section-1">1</a>. Introduction and Overview</span>

   Now-a-days, it is common practice for employees to dial-in to their
   enterprise over the PSTN (Public Switched Telephone Network) and
   perform day-to-day operations just as they would if they were in
   corporate premises. This includes people who dial-in from their home
   and road warriors, who cannot be at the corporate premises. As the
   Internet has become ubiquitous, it is appealing to dial-in through
   the Internet to save on phone charges and save the dedicated voice
   lines from being clogged with data traffic.






<span class="grey">Srisuresh                    Informational                      [Page 1]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-2"></span>
<span class="grey"><a href="./rfc2888">RFC 2888</a>             Secure Remote Access with L2TP          August 2000</span>


   The document suggests an approach by which remote access over the
   Internet could become a reality. The approach is founded on the
   well-known techniques and protocols already in place. Remote Access
   extensions based on L2TP, when combined with the security offered by
   IPSec can make remote access over the Internet a reality. The
   approach does not require inventing new protocol(s).

   The trust model of remote access discussed in this document is viewed
   principally from the perspective of an enterprise into which remote
   access clients dial-in. A remote access client may or may not want to
   enforce end-to-end IPsec from his/her end to the enterprise.
   However, it is in the interest of the enterprise to mandate security
   of every packet that it accepts from the Internet into the
   enterprise.  Independently, remote users may also pursue end-to-end
   IPsec, if they choose to do so. That would be in addition to the
   security requirement imposed by the enterprise edge device.

   <a href="#section-2">Section 2</a> has reference to the terminology used throughout the
   document. Also mentioned are the limited scope in which some of these
   terms may be used in this document. <a href="#section-3">Section 3</a> has a brief description
   of what constitutes remote access. <a href="#section-4">Section 4</a> describes what
   constitutes network security from an enterprise perspective.  <a href="#section-5">Section</a>
   <a href="#section-5">5</a> describes the model of secure remote access as a viable solution to
   enterprises. The solution presented in <a href="#section-5">section 5</a> has some
   limitations. These limitations are listed in <a href="#section-6">section 6</a>.  <a href="#section-7">Section 7</a> is
   devoted to describing new RADIUS attributes that may be configured to
   turn a NAS device into Secure Remote Access Server.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/2.%20Terminology%20and%20scope"></a><a class="selflink" href="#section-2" id="section-2">2</a>. Terminology and scope</span>

   Definition of terms used in this document may be found in one of (a)
   L2TP Protocol document [Ref 1], (b) IP security Architecture document
   [Ref 5], or (c) Internet Key Exchange (IKE) document [Ref 8].

   Note, the terms Network Access Server (NAS) and  Remote Access
   Server(RAS) are used interchangeably throughout the document.  While
   PPP may be used to carry a variety of network layer packets, the
   focus of this document is limited to carrying IP datagrams only.

   "Secure Remote Access Server" (SRAS) defined in this document refers
   to a NAS that supports tunnel-mode IPsec with its remote clients.
   Specifically, LNS is the NAS that is referred. Further, involuntary
   tunneling is assumed for L2TP tunnel setup, in that remote clients
   initiating PPP session and the LAC that tunnels the PPP sessions are
   presumed to be distinct physical entities.






<span class="grey">Srisuresh                    Informational                      [Page 2]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-3"></span>
<span class="grey"><a href="./rfc2888">RFC 2888</a>             Secure Remote Access with L2TP          August 2000</span>


   Lastly, there are a variety of transport mediums by which to tunnel
   PPP packets between a LAC and LNS. Examples include Frame Relay or
   ATM cloud and IP network infrastructure. For simplicity, the document
   assumes a public IP infrastructure as the medium to transport PPP
   packets between LAC and LNS. Security of IP packets (embedded within
   PPP) in a trusted private transport medium is less of a concern for
   the purposes of this document.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.%20Remote%20Access%20operation"></a><a class="selflink" href="#section-3" id="section-3">3</a>. Remote Access operation</span>

   Remote access is more than mere authentication of remote clients by a
   Network Access Server(NAS). Authentication, Authorization, Accounting
   and routing are integral to remote access. A client must first pass
   the authentication test before being granted link access to the
   network. Network level services (such as IP) are granted based on the
   authorization characteristics specified for the user in RADIUS.
   Network Access Servers use RADIUS to scale for large numbers of users
   supported. NAS also monitors the link status of the remote access
   clients.

   There are a variety of techniques by which remote access users are
   connected to their enterprise and the Internet. At a link level, the
   access techniques include ISDN digital lines, analog plain-old-
   telephone-service lines, xDSL lines, cable and wireless to name a
   few. PPP is the most common Layer-2 (L2)protocol used for carrying
   network layer packets over these remote access links. PPP may be used
   to carry a variety of network layer datagrams including IP, IPX and
   AppleTalk. The focus of this document is however limited to IP
   datagrams only.

   L2TP is a logical extension of PPP over an IP infrastructure. While a
   LAC provides termination of Layer 2 links,  LNS provides the logical
   termination of PPP. As a result, LNS becomes the focal point for (a)
   performing the AAA operations for the remote users, (b) assigning IP
   address and monitoring the logical link status (i.e., the status of
   LAC-to-LNS tunnel and the link between remote user and LAC), and (c)
   maintaining host-route to remote user network and providing routing
   infrastructure into the enterprise.

   L2TP uses control messages to establish, terminate and monitor the
   status of the logical PPP sessions (from remote user to LNS). These
   are independent of the data messages. L2TP data messages contain an
   L2TP header, followed by PPP packets. The L2TP header identifies the
   PPP session (amongst other things) to which the PPP packet belongs.
   The IP packets exchanged from/to the remote user are carried within
   the PPP packets.  The L2TP data messages, carrying end-to-end IP
   packets in an IP transport medium may be described as follows. The
   exact details of L2TP protocol may be found in [Ref 1].



<span class="grey">Srisuresh                    Informational                      [Page 3]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-4"></span>
<span class="grey"><a href="./rfc2888">RFC 2888</a>             Secure Remote Access with L2TP          August 2000</span>


      +----------------------+
      | IP Header            |
      | (LAC &lt;-&gt;LNS)         |
      +----------------------+
      | UDP Header           |
      +----------------------+
      | L2TP Header          |
      | (incl. PPP Sess-ID)  |
      +----------------------+
      | PPP Header           |
      | (Remote User&lt;-&gt;LNS)  |
      +----------------------+
      | End-to-end IP packet |
      | (to/from Remote User)|
      +----------------------+

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/4.%20Requirements%20of%20an%20enterprise%20Security%20Gateway"></a><a class="selflink" href="#section-4" id="section-4">4</a>. Requirements of an enterprise Security Gateway</span>

   Today's enterprises are aware of the various benefits of connecting
   to the Internet. Internet is a vast source of Information and a means
   to disseminate information and make available certain resources to
   the external world. However, enterprises are also aware that security
   breaches (by being connected to the Internet) can severely jeopardize
   internal network.

   As a result, most enterprises restrict access to a pre-defined set of
   resources for external users. Typically, enterprises employ a
   firewall to restrict access to internal resources and place
   externally accessible servers in the DeMilitarized Zone (DMZ), in
   front of the firewall, as described below in Figure 1.





















<span class="grey">Srisuresh                    Informational                      [Page 4]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-5"></span>
<span class="grey"><a href="./rfc2888">RFC 2888</a>             Secure Remote Access with L2TP          August 2000</span>


                        ----------------
                       (                )
                      (                  )
                     (      Internet      )
                      (                  )
                       (_______________ )

                       WAN  |
                 .........|\|....
                          |
                +-----------------+
                |Enterprise Router|
                +-----------------+
                    |
                    |   DMZ - Network
               ---------------------------------
                |            |                |
               +--+         +--+         +----------+
               |__|         |__|         | Firewall |
              /____\       /____\        +----------+
              DMZ-Name     DMZ-Web  ...    |
              Server       Server          |
                                           |
                                ------------------
                               (                  )
                              (  Internal Network  )
                             (   (private to the    )
                              (   enterprise)      )
                               (_________________ )

         Figure 1: Security model of an Enterprise using Firewall

   Network Access Servers used to allow direct dial-in access (through
   the PSTN) to employees are placed within the private enterprise
   network so as to avoid access restrictions imposed by a firewall.

   With the above model, private resources of an enterprise are
   restricted for access from the Internet. Firewall may be configured
   to occasionally permit access to a certain resource or service but is
   not recommended on an operational basis as that could constitute a
   security threat to the enterprise. It is of interest to note that
   even when the firewall is configured to permit access to internal
   resources from pre-defined external node(s), many internal servers,
   such as NFS, enforce address based authentication and do not co-
   operate when the IP address of the external node is not in corporate
   IP address domain. In other words, with the above security model, it





<span class="grey">Srisuresh                    Informational                      [Page 5]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-6"></span>
<span class="grey"><a href="./rfc2888">RFC 2888</a>             Secure Remote Access with L2TP          August 2000</span>


   becomes very difficult to allow employees to access corporate
   resources, via the Internet, even if you are willing to forego
   security over the Internet.

   With the advent of IPsec, it is possible to secure corporate data
   across the Internet by employing a Security Gateway within the
   enterprise. Firewall may be configured to allow IKE and IPsec packets
   directed to a specific  Security Gateway behind the firewall. It then
   becomes the responsibility of the Security Gateway to employ the
   right access list for external connections seeking entry into the
   enterprise. Essentially, the access control functionality for IPsec
   secure packets would be shifted to the Security Gateway (while the
   access control for clear packets is retained with the firewall). The
   following figure illustrates the model where a combination of
   Firewall and Security Gateway control access to internal resources.




































<span class="grey">Srisuresh                    Informational                      [Page 6]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-7"></span>
<span class="grey"><a href="./rfc2888">RFC 2888</a>             Secure Remote Access with L2TP          August 2000</span>


                        ------------
                       (            )
                      (              )
                     (    Internet    )
                      (              )
                       (___________ )

                       WAN  |
                 .........|\|....
                          |
                +-----------------+
                |Enterprise Router|
                +-----------------+
                    |
                    |   DMZ - Network
   ------------------------------------------------------------
            |            |                     |
           +--+         +--+              +----------+
           |__|         |__|              | Firewall |
               /____\       /____\             +----------+
               DMZ-Name     DMZ-Web   ...         |
               Server       Server etc.           | LAN
                                             |
                  ------------------------------------
                      |                          |
                 +----------+         +------------------+
                 |   LNS    |         | Security Gateway |
                 |  Server  |         |      (SGW)       |
                 +----------+         +------------------+
                                               |
                                     ------------------
                                    (                  )
                                   (  Internal Network  )
                                  (   (Private to the    )
                                   (   enterprise)      )
                                    (_________________ )

     Figure 2: Security Model based on Firewall and Security Gateway

   In order to allow employee dial-in over the Internet, an LNS may be
   placed behind a firewall, and the firewall may be configured to allow
   UDP access to the LNS from the Internet. Note, it may not be possible
   to know all the IP addresses of the LACs located on the Internet at
   configuration time. Hence, the need to allow UDP access from any node
   on the Internet. The LNS may be configured to process only the L2TP
   packets and drop any UDP packets that are not L2TP.





<span class="grey">Srisuresh                    Informational                      [Page 7]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-8"></span>
<span class="grey"><a href="./rfc2888">RFC 2888</a>             Secure Remote Access with L2TP          August 2000</span>


   Such a configuration allows remote access over the Internet. However,
   the above setup is prone to a variety of security attacks over the
   Internet. It is easy for someone on the Internet to steal a remote
   access session and gain  access to precious resources of the
   enterprise. Hence it is important that all packets are preserved with
   IPsec to a security Gateway (SGW) behind the LNS, so the Security
   Gateway will not allow IP packets into corporate network unless it
   can authenticate the same.

   The trust model of secure remote access assumes that the enterprise
   and the end user are trusted domains. Everything in between is not
   trusted. Any examination of the end-to-end packets by the nodes
   enroute would violate this trust model. From this perspective, even
   the LAC node enroute must not be trusted with the end-to-end IP
   packets. Hence, location and operation of LAC is not relevant for the
   discussion on security. On the other hand, location and operation of
   LNS and the Security Gateway (SGW) are precisely the basis for
   discussion.

   Having security processing done on an independent Security gateway
   has the following shortcomings.

   1. Given the trust model for remote access, the SGW must be
      configured with a set of security profiles, access control lists
      and IKE authentication parameters for each user. This mandates an
      independent provisioning of security parameters on a per-user
      basis. This may not be able to take advantage of the user-centric
      provisioning on RADIUS, used by the LNS node.

   2. Unlike the LNS, SGW may not be in the routing path of remote
      access packets. I.e., there is no guarantee that the egress IP
      packets will go through the chain of SGW and LNS before they are
      delivered to remote user. As a result, packets may be subject to
      IPSec in one direction, but not in the other. This can be a
      significant threat to the remote access trust model.

   3. Lastly, the SGW node does not have a way to know when a remote
      user node(s) simply died or the LAC-LNS tunnel failed. Being
      unable to delete the SAs for users that no longer exist could
      drain the resources of the SGW. Further, the LNS cannot even
      communicate the user going away to the SGW because, the SGW
      maintains its peer nodes based on IKE user ID, which could be
      different the user IDs employed by the LNS node.








<span class="grey">Srisuresh                    Informational                      [Page 8]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-9"></span>
<span class="grey"><a href="./rfc2888">RFC 2888</a>             Secure Remote Access with L2TP          August 2000</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.%20Secure%20Remote%20Access"></a><a class="selflink" href="#section-5" id="section-5">5</a>. Secure Remote Access</span>

   Combining the functions of IPsec Security Gateway and LNS into a
   single system promises to offer a viable solution for secure remote
   access. By doing this, remote access clients will use a single node
   as both (a) PPP termination point providing NAS service, and (b) the
   Security gateway node into the enterprise. We will refer this node as
   "Secure Remote Access Server" (SRAS).

   The SRAS can benefit greatly from the confluence of PPP session and
   IPsec tunnel end points. PPP session monitoring capability of L2TP
   directly translates to being able to monitor IPsec tunnels. Radius
   based user authorization ability could be used to configure the
   security characteristics for IPsec tunnel. This includes setting
   access control filters and security preferences specific to each
   user. This may also be extended to configuring IKE authentication and
   other negotiation parameters, when automated key exchange is
   solicited. Security attributes that may be defined in Radius are
   discussed in detail in <a href="#section-7">section 7</a>. Needless to say, the centralized
   provisioning capability and scalability of Radius helps in the
   configuration of IPsec.

   As for remote access, the benefit is one of IPsec security as
   befitting the trust model solicited by enterprises for the end-to-end
   IP packets traversing the Internet. You may use simply AH where there
   is no fear of external eaves-dropping, but you simply need to
   authenticate packet data, including the source of packet. You may use
   ESP (including ESP-authentication), where there is no trust of the
   network and you do not want to permit eaves-dropping on corporate
   activities.

   Operation of SRAS requires that the firewall be configured to permit
   UDP traffic into the SRAS node. The SRAS node in turn will process
   just the L2TP packets and drop the rest. Further, the SRAS will
   require all IP packets embedded within PPP to be one of AH and ESP
   packets, directed to itself. In addition, the SRAS will also permit
   IKE UDP packets (with source and destination ports sets to 500)
   directed to itself in order to perform IKE negotiation and generate
   IPsec keys dynamically. All other IP packets embedded within PPP will
   be dropped. This enforces the security policy for the enterprise by
   permitting only the secure remote access packets into the enterprise.
   When a PPP session is dropped, the IPsec and ISAKMP SAs associated
   with the remote access user are dropped from the SRAS. All the
   shortcomings listed in the previous section with LNS and SGW on two
   systems disappear withe Secure Remote Access Server. Figure 3 below
   is a typical description of an enterprise supporting remote access
   users using SRAS system.




<span class="grey">Srisuresh                    Informational                      [Page 9]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-10"></span>
<span class="grey"><a href="./rfc2888">RFC 2888</a>             Secure Remote Access with L2TP          August 2000</span>


                                                   ------------
              Remote Access  +-------------+      (            )
        +--+______   Link    | Local Access|     (              )
        |__|     /___________| Concentrator|----(    Internet    )
       /____\                |    (LAC)    |     (              )
       RA-Host               +-------------+      (____________)

                                  WAN  |
                            .........|\|....
                                     |
                           +-----------------+
                           |Enterprise Router|
                           +-----------------+
                               |
                               |   DMZ - Network
             ------------------------------------------
            |            |                     |
           +--+         +--+              +----------+
           |__|         |__|              | Firewall |
               /____\       /____\             +----------+
               DMZ-Name     DMZ-Web   ...         |
               Server       Server etc.           | LAN
                                             |
                  ------------------------------------
                                     |
                                +---------------+
                                | Secure Remote |
                                | Access Server |
                                |    (SRAS)     |
                                +---------------+
                                         |
                               ---------------------
                              (                     )
                 +--+       (    Internal Network    )
                 |__|------(     (Private to the      )
                /____\      (     enterprise)        )
                Ent-Host     (______________________)

     Figure 3: Secure Remote Access Server operation in an Enterprise

   The following is an illustration of secure remote access data flow as
   end-to-end IP packets traverse the Internet and the SRAS. The example
   shows IP packet tunneling and IPsec transformation as packets are
   exchanged between a remote Access host (RA-Host) and a host within
   the enterprise (say, Ent-Host).






<span class="grey">Srisuresh                    Informational                     [Page 10]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-11"></span>
<span class="grey"><a href="./rfc2888">RFC 2888</a>             Secure Remote Access with L2TP          August 2000</span>


   Note, the IP packets originating from or directed to RA-Host are
   shown within PPP encapsulation, whereas, all other packets are shown
   simply as IP packets.  It is done this way to highlight the PPP
   packets encapsulated within L2TP tunnel. The PPP headers below are
   identified by their logical source and destination in parenthesis.
   Note, however, the source and recipient information of the PPP data
   is not a part of PPP header. This is described thus, just for
   clarity. In the case of an L2TP tunnel, the L2TP header carries the
   PPP session ID, which indirectly identifies the PPP end points to the
   LAC and the LNS. Lastly, the IPsec Headers section below include the
   tunneling overhead and the AH/ESP headers that are attached to the
   tunnel.







































<span class="grey">Srisuresh                    Informational                     [Page 11]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-12"></span>
<span class="grey"><a href="./rfc2888">RFC 2888</a>             Secure Remote Access with L2TP          August 2000</span>


   RA-Host to Ent-Host Packet traversal:
   ------------------------------------

   RA-Host              LAC                   SRAS              Ent-Host
   =====================================================================

   +----------------------+
   | PPP Header           |
   | (RA-Host -&gt;SRAS)     |
   +----------------------+
   | Tunnel-Mode IPsec    |
   | Hdr(s)(RA-Host-&gt;SRAS)|
   +----------------------+
   | End-to-end IP packet |
   | transformed as needed|
   | (RA-Host-&gt;Ent-Host)  |
   +----------------------+
      ----------------------&gt;

                   +----------------------+
                   | IP Header            |
                   | (LAC-&gt;SRAS)          |
                   +----------------------+
                   | UDP Header           |
                   +----------------------+
                   | L2TP Header          |
                   | (incl. PPP Sess-ID)  |
                   +----------------------+
                   | PPP Header           |
                   | (RA-Host -&gt;SRAS)     |
                   +----------------------+
                   | Tunnel-Mode IPsec    |
                   | Hdr(s)(RA-Host-&gt;SRAS)|
                   +----------------------+
                   | End-to-end IP packet |
                   | transformed as needed|
                   | (RA-Host-&gt;Ent-Host)  |
                   +----------------------+
                      ----------------------&gt;

                                      +----------------------+
                                      | End-to-end IP packet |
                                      | (RA-Host-&gt;Ent-Host)  |
                                      +----------------------+
                                         ----------------------&gt;






<span class="grey">Srisuresh                    Informational                     [Page 12]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-13"></span>
<span class="grey"><a href="./rfc2888">RFC 2888</a>             Secure Remote Access with L2TP          August 2000</span>


   Ent-Host to RA-Host Packet traversal:
   ------------------------------------

   Ent-Host             SRAS                  LAC               RA-Host
   =====================================================================

   +----------------------+
   | End-to-end IP packet |
   | (Ent-Host-&gt;Ra-Host)  |
   +----------------------+
      ----------------------&gt;

                   +----------------------+
                   | IP Header            |
                   | (SRAS-&gt;LAC)          |
                   +----------------------+
                   | UDP Header           |
                   +----------------------+
                   | L2TP Header          |
                   | (incl. PPP Sess-ID)  |
                   +----------------------+
                   | PPP Header           |
                   | (SRAS-&gt;RA-Host)      |
                   +----------------------+
                   | Tunnel-Mode IPsec    |
                   | Hdr(s)(SRAS-&gt;RA-Host)|
                   +----------------------+
                   | End-to-end IP packet |
                   | transformed as needed|
                   | (Ent-Host-&gt;RA-Host)  |
                   +----------------------+
                      ----------------------&gt;

                                     +----------------------+
                                     | PPP Header           |
                                     | (SRAS-&gt;RA-Host)      |
                                     +----------------------+
                                     | Tunnel-Mode IPsec    |
                                     | Hdr(s)(SRAS-&gt;RA-Host)|
                                     +----------------------+
                                     | End-to-end IP packet |
                                     | transformed as needed|
                                     | (Ent-Host-&gt;RA-Host)  |
                                     +----------------------+
                                        ----------------------&gt;






<span class="grey">Srisuresh                    Informational                     [Page 13]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-14"></span>
<span class="grey"><a href="./rfc2888">RFC 2888</a>             Secure Remote Access with L2TP          August 2000</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/6.%20Limitations%20to%20Secure%20Remote%20Access%20using%20L2TP"></a><a class="selflink" href="#section-6" id="section-6">6</a>. Limitations to Secure Remote Access using L2TP</span>

   The SRAS model described is not without its limitations. Below is a
   list of the limitations.

   1. Tunneling overhead: There is considerable tunneling overhead on
      the end-to-end IP packet. Arguably, there is overlap of
      information between tunneling headers. This overhead will undercut
      packet throughput.

      The overhead is particularly apparent at the LAC and SRAS nodes.
      Specifically, the SRAS has the additional computational overhead
      of IPsec processing on all IP packets exchanged with remote users.
      This can be a significant bottleneck in the ability of SRAS to
      scale for large numbers of remote users.

   2. Fragmentation and reassembly: Large IP packets may be required to
      undergo Fragmentation and reassembly at the LAC or the LNS as a
      result of multiple tunnel overhead tagged to the packet.
      Fragmentation and reassembly can havoc on packet throughput and
      latency. However, it is possible to avoid the overhead by reducing
      the MTU permitted within PPP frames.

   3. Multiple identity and authentication requirement: Remote Access
      users are required to authenticate themselves to the SRAS in order
      to be obtain access to the link. Further, when they require the
      use of IKE to automate IPsec key exchange, they will need to
      authenticate once again with the same or different ID and a
      distinct authentication approach. The authentication requirements
      of IKE phase 1 [Ref 8] and LCP [Ref 3] are different.

      However, it is possible to have a single authentication approach
      (i.e., a single ID and authentication mechanism) that can be
      shared between LCP and IKE phase 1.  The Extended Authentication
      Protocol(EAP) [Ref 4] may be used as the base to transport IKE
      authentication mechanism into PPP. Note, the configuration
      overhead is not a drag on the functionality perse.

   4. Weak security of Link level authentication: As LCP packets
      traverse the Internet, the Identity of the remote user and the
      password (if a password is used) is sent in the clear. This makes
      it a target for someone on the net to steal the information and
      masquerade as remote user. Note, however, this type of password
      stealing will not jeopardize the security of the enterprise per
      se, but could result in denial of service to remote users. An
      intruder can collect the password data and simply steal the link,
      but will not be able to run any IP applications subsequently, as
      the SRAS will fail non-IPsec packet data.



<span class="grey">Srisuresh                    Informational                     [Page 14]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-15"></span>
<span class="grey"><a href="./rfc2888">RFC 2888</a>             Secure Remote Access with L2TP          August 2000</span>


      A better approach would be to employ Extended Authentication
      Protocol (EAP) [Ref 4] and select an authentication technique that
      is not prone to stealing over the Internet. Alternately, the LAC
      and the SRAS may be independently configured to use IPsec to
      secure all LCP traffic exchanged between themselves.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/7.%20Configuring%20RADIUS%20to%20support%20Secure%20Remote%20Access."></a><a class="selflink" href="#section-7" id="section-7">7</a>. Configuring RADIUS to support Secure Remote Access.</span>

   A centralized RADIUS database is used by enterprises to maintain the
   authentication and authorization requirements of the dial-in Users.
   It is also believed that direct dial-in access (e.g., through the
   PSTN network is) safe and trusted and does not need any scrutiny
   outside of the link level authentication enforced in LCP. This belief
   is certainly not shared with the dial-in access through the Internet.

   So, while the same RADIUS database may be used for a user directly
   dialing-in or dialing in through the Internet, the security
   requirements may vary. The following RADIUS attributes may be used to
   mandate IPsec for the users dialing-in through the Internet.  The
   exact values for the attributes and its values may be obtained from
   IANA (refer <a href="#section-10">Section 10</a>).

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/7.1.%20Security%20mandate%20based%20on%20access%20method"></a><a class="selflink" href="#section-7.1" id="section-7.1">7.1</a>. Security mandate based on access method</span>

   A new RADIUS attribute IPSEC_MANDATE (91) may be defined for each
   user. This attribute may be given one of the following values.

      NONE            (=0)     No IPsec mandated on the IP packets
                               embedded within PPP.

      LNS_AS_SRAS     (=1)     Mandates Tunnel mode IPsec on the IP
                               packets embedded within PPP, only so
                               long as the PPP session terminates
                               at an LNS. LNS would be the tunnel
                               mode IPsec end point.

      SRAS            (=2)     Mandates Tunnel mode IPsec on the IP
                               packets embedded within PPP,
                               irrespective of the NAS type the PPP
                               terminates in. I.e., the IPsec mandate
                               is not specific to LNS alone, and is
                               applicable to any NAS, terminating
                               PPP. NAS would be the tunnel mode
                               IPsec end point.







<span class="grey">Srisuresh                    Informational                     [Page 15]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-16"></span>
<span class="grey"><a href="./rfc2888">RFC 2888</a>             Secure Remote Access with L2TP          August 2000</span>


   When IPSEC_MANDATE attribute is set to one of LNS_AS_SRAS or SRAS,
   that would direct the NAS to drop any IP packets in PPP that are not
   associated with an AH or ESP protocol. As an exception, the NAS will
   continue to process IKE packets (UDP packets, with source and
   destination port set to 500) directed from remote users. Further, the
   security profile parameter, defined in the following section may add
   additional criteria for which security is not mandatory.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/7.2.%20Security%20profile%20for%20the%20user"></a><a class="selflink" href="#section-7.2" id="section-7.2">7.2</a>. Security profile for the user</span>

   A new SECURITY_PROFILE (92) parameter may be defined in RADIUS to
   describe security access requirements for the users. The profile
   could contain information such as the access control security
   filters, security preferences and the nature of Keys (manual or
   automatic generated via the IKE protocol) used for security purposes.

   The SECURITY-PROFILE attribute can be assigned a filename, as a
   string of characters. The contents of the file could be vendor
   specific. But, the contents should include (a) a prioritized list
   access control security policies, (b) Security Association security
   preferences associated with each security policy.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/7.3.%20IKE%20negotiation%20profile%20for%20the%20user"></a><a class="selflink" href="#section-7.3" id="section-7.3">7.3</a>. IKE negotiation profile for the user</span>

   If the security profile of a user requires dynamic generation of
   security keys, the parameters necessary for IKE negotiation may be
   configured separately using a new IKE_NEGOTIATION_PROFILE (93)
   parameter in RADIUS. IKE-NEGOTIATION_PROFILE attribute may be
   assigned a filename, as a string of characters. The contents of the
   file could however be vendor specific. The contents would typically
   include (a) the IKE ID of the user and  SRAS, (b) preferred
   authentication approach and the associated parameters, such as a
   pre-shared-key or a pointer to X.509 digital Certificate, and, (c)
   ISAKMP security negotiation preferences for phase I.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/8.%20Acknowledgements"></a><a class="selflink" href="#section-8" id="section-8">8</a>. Acknowledgements</span>

   The author would like to express sincere thanks to Steve Willens for
   initially suggesting this idea. The author is also thankful to Steve
   for the many informal conversations which were instrumental in the
   author being able to appreciate the diverse needs of the Remote
   Access area.









<span class="grey">Srisuresh                    Informational                     [Page 16]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-17"></span>
<span class="grey"><a href="./rfc2888">RFC 2888</a>             Secure Remote Access with L2TP          August 2000</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/9.%20Security%20Considerations"></a><a class="selflink" href="#section-9" id="section-9">9</a>. Security Considerations</span>

   This document is about providing secure remote access to enterprises
   via the Internet. However, the document does not address security
   issues for network layers other than IP. While the document focus is
   on security over the Internet, the security model provided is not
   limited to the Internet or the IP infrastructure alone. It may also
   be applied over other transport media such as Frame Relay and ATM
   clouds. If the transport media is a trusted private network
   infrastructure, the security measures described may not be as much of
   an issue. The solution suggested in the document is keeping in view
   the trust model between a remote user and enterprise.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/10.%20IANA%20Considerations"></a><a class="selflink" href="#section-10" id="section-10">10</a>. IANA Considerations</span>

   This document proposes a total of three new RADIUS attributes to be
   maintained by the IANA. These attributes IPSEC_MANDATE,
   SECURITY_PROFILE and IKE_NEGOTIATION_PROFILE may be assigned the
   values 91, 92 and 93 respectively so as not to conflict with the
   definitions for recognized radius types, as defined in
   <a href="http://www.isi.edu/in-notes/iana/assignments/radius-types">http://www.isi.edu/in-notes/iana/assignments/radius-types</a>.

   The following sub-section explains the criteria to be used by the
   IANA to assign additional numbers as values to the IPSEC-MANDATE
   attribute described in <a href="#section-7.1">section 7.1</a>.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/10.1.%20%20IPSEC-MANDATE%20attribute%20Value"></a><a class="selflink" href="#section-10.1" id="section-10.1">10.1</a>.  IPSEC-MANDATE attribute Value</span>

   Values 0-2 of the IPSEC-MANDATE-Type Attribute are defined in <a href="#section-7.1">Section</a>
   <a href="#section-7.1">7.1</a>; the remaining values [3-255] are available for assignment by the
   IANA with IETF Consensus [Ref 11].

REFERENCES

   [<a id="ref-1">1</a>]  Townsley, W., Valencia, A., Rubens, A., Pall, G., Zorn, G. and
        B. Palter, "Layer Two Tunneling Protocol L2TP", <a href="./rfc2661">RFC 2661</a>, August
        1999.

   [<a id="ref-2">2</a>]  Rigney, C., Rubens, A., Simpson, W. and S. Willens, "Remote
        Authentication Dial In User Service (RADIUS)", <a href="./rfc2138">RFC 2138</a>, April
        1997.

   [<a id="ref-3">3</a>]  Simpson, W., "The Point-to-Point Protocol (PPP)", STD 51, <a href="./rfc1661">RFC</a>
        <a href="./rfc1661">1661</a>, July 1994.

   [<a id="ref-4">4</a>]  Blunk, L. and Vollbrecht, J. "PPP Extensible Authentication
        Protocol (EAP)", <a href="./rfc2284">RFC 2284</a>, March 1998.




<span class="grey">Srisuresh                    Informational                     [Page 17]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-18"></span>
<span class="grey"><a href="./rfc2888">RFC 2888</a>             Secure Remote Access with L2TP          August 2000</span>


   [<a id="ref-5">5</a>]  Kent, S. and R. Atkinson, "Security Architecture for the
        Internet Protocol", <a href="./rfc2401">RFC 2401</a>, November 1998.

   [<a id="ref-6">6</a>]  Kent, S. and R. Atkinson, "IP Encapsulating Security Payload
        (ESP)", <a href="./rfc2406">RFC 2406</a>, November 1998.

   [<a id="ref-7">7</a>]  Kent, S. and R. Atkinson, "IP Authentication Header", <a href="./rfc2402">RFC 2402</a>,
        November 1998.

   [<a id="ref-8">8</a>]  Harkins, D. and D. Carrel, "The Internet Key Exchange (IKE)",
        <a href="./rfc2409">RFC 2409</a>, November 1998.

   [<a id="ref-9">9</a>]  Piper, D., "The Internet IP Security Domain of Interpretation
        for ISAKMP", <a href="./rfc2407">RFC 2407</a>, November 1998.

   [<a id="ref-10">10</a>] Reynolds, J. and J. Postel, "Assigned Numbers", STD 2, <a href="./rfc1700">RFC 1700</a>,
        October 1994.
        See also <a href="http://www.iana.org/numbers.html">http://www.iana.org/numbers.html</a>

   [<a id="ref-11">11</a>] Narten, T. and H. Alvestrand, "Guidelines for writing an IANA
        Considerations Section in RFCs", <a href="https://www.rfc-editor.org/bcp/bcp26">BCP 26</a>, <a href="./rfc2434">RFC 2434</a>, October 1998.

   [<a id="ref-12">12</a>] Meyer, G., "The PPP Encryption Control Protocol (ECP)", <a href="./rfc1968">RFC</a>
        <a href="./rfc1968">1968</a>, June 1996.

   [<a id="ref-13">13</a>] Sklower, K. and G. Meyer, "The PPP DES Encryption Protocol,
        Version 2 (DESE-bis)", <a href="./rfc2419">RFC 2419</a>, September 1998.

Author's Address

   Pyda Srisuresh
   Campio Communications
   630 Alder Drive
   Milpitas, CA 95035
   U.S.A.

   Phone: +1 (408) 519-3849
   EMail: srisuresh@yahoo.com













<span class="grey">Srisuresh                    Informational                     [Page 18]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-19"></span>
<span class="grey"><a href="./rfc2888">RFC 2888</a>             Secure Remote Access with L2TP          August 2000</span>


Full Copyright Statement

   Copyright (C) The Internet Society (2000).  All Rights Reserved.

   This document and translations of it may be copied and furnished to
   others, and derivative works that comment on or otherwise explain it
   or assist in its implementation may be prepared, copied, published
   and distributed, in whole or in part, without restriction of any
   kind, provided that the above copyright notice and this paragraph are
   included on all such copies and derivative works.  However, this
   document itself may not be modified in any way, such as by removing
   the copyright notice or references to the Internet Society or other
   Internet organizations, except as needed for the purpose of
   developing Internet standards in which case the procedures for
   copyrights defined in the Internet Standards process must be
   followed, or as required to translate it into languages other than
   English.

   The limited permissions granted above are perpetual and will not be
   revoked by the Internet Society or its successors or assigns.

   This document and the information contained herein is provided on an
   "AS IS" basis and THE INTERNET SOCIETY AND THE INTERNET ENGINEERING
   TASK FORCE DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED, INCLUDING
   BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE INFORMATION
   HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED WARRANTIES OF
   MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

Acknowledgement

   Funding for the RFC Editor function is currently provided by the
   Internet Society.



















Srisuresh                    Informational                     [Page 19]
</pre>
</body></html>