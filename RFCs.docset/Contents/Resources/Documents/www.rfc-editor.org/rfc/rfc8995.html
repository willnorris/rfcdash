<!DOCTYPE html>
<html class="RFC" lang="en"><head>
<meta charset="utf-8"/>
<meta content="Common,Latin" name="scripts"/>
<meta content="initial-scale=1.0" name="viewport"/>
<title>RFC 8995: Bootstrapping Remote Secure Key Infrastructure (BRSKI)</title>
<meta content="Max Pritikin" name="author"/>
<meta content="Michael C. Richardson" name="author"/>
<meta content="Toerless Eckert" name="author"/>
<meta content="Michael H. Behringer" name="author"/>
<meta content="Kent Watsen" name="author"/>
<meta content="
       
        This document specifies automated bootstrapping of an Autonomic
        Control Plane.  To do this, a Secure Key Infrastructure is
        bootstrapped.  This is done using manufacturer-installed
        X.509 certificates, in combination with a manufacturer's authorizing
        service, both online and offline.  We call this process the
        Bootstrapping Remote Secure Key Infrastructure (BRSKI) protocol.
        Bootstrapping a new device can occur when using a routable address and a
        cloud service, only link-local connectivity, or
        limited/disconnected networks. Support for deployment models
        with less stringent security requirements is included.
        Bootstrapping is complete when the cryptographic identity of the new
        key infrastructure is successfully deployed to the device.  The
        established secure connection can be used to deploy a locally issued
        certificate to the device as well.
       
    " name="description"/>
<meta content="xml2rfc 3.8.0" name="generator"/>
<meta content="8995" name="rfc.number"/>
<!-- Generator version information:
  xml2rfc 3.8.0
    Python 3.6.10
    appdirs 1.4.4
    ConfigArgParse 1.2.3
    google-i18n-address 2.3.5
    html5lib 1.0.1
    intervaltree 3.0.2
    Jinja2 2.11.2
    kitchen 1.2.6
    lxml 4.4.2
    pycairo 1.19.0
    pycountry 19.8.18
    pyflakes 2.1.1
    PyYAML 5.3.1
    requests 2.22.0
    setuptools 40.6.2
    six 1.14.0
    WeasyPrint 51
-->
<link href="rfc8995.xml" rel="alternate" type="application/rfc+xml"/>
<link href="#copyright" rel="license"/>
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css"/>
<link href="https://dx.doi.org/10.17487/rfc8995" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <link href="https://datatracker.ietf.org/doc/draft-ietf-anima-bootstrapping-keyinfra-45" rel="prev"/>
  </head>
<body>
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 8995</td>
<td class="center">BRSKI</td>
<td class="right">May 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Pritikin, et al.</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div class="document-information" id="external-metadata"></div>
<div class="document-information" id="internal-metadata">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a class="eref" href="https://www.rfc-editor.org/rfc/rfc8995">8995</a></dd>
<dt class="label-category">Category:</dt>
<dd class="category">Standards Track</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time class="published" datetime="2021-05">May 2021</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">M. Pritikin</div>
<div class="org">Cisco</div>
</div>
<div class="author">
      <div class="author-name">M. Richardson</div>
<div class="org">Sandelman Software Works</div>
</div>
<div class="author">
      <div class="author-name">T. Eckert</div>
<div class="org">Futurewei USA</div>
</div>
<div class="author">
      <div class="author-name">M. Behringer</div>
</div>
<div class="author">
      <div class="author-name">K. Watsen</div>
<div class="org">Watsen Networks</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 8995</h1>
<h1 id="title">Bootstrapping Remote Secure Key Infrastructure (BRSKI)</h1>
<section id="section-abstract">
      <h2 id="abstract"><a class="selfRef" href="#abstract">Abstract</a></h2>
<p id="section-abstract-1">
        This document specifies automated bootstrapping of an Autonomic
        Control Plane.  To do this, a Secure Key Infrastructure is
        bootstrapped.  This is done using manufacturer-installed
        X.509 certificates, in combination with a manufacturer's authorizing
        service, both online and offline.  We call this process the
        Bootstrapping Remote Secure Key Infrastructure (BRSKI) protocol.
        Bootstrapping a new device can occur when using a routable address and a
        cloud service, only link-local connectivity, or
        limited/disconnected networks. Support for deployment models
        with less stringent security requirements is included.
        Bootstrapping is complete when the cryptographic identity of the new
        key infrastructure is successfully deployed to the device.  The
        established secure connection can be used to deploy a locally issued
        certificate to the device as well.<a class="pilcrow" href="#section-abstract-1">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a class="section-name selfRef" href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This is an Internet Standards Track document.<a class="pilcrow" href="#section-boilerplate.1-1">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.<a class="pilcrow" href="#section-boilerplate.1-2">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc8995">https://www.rfc-editor.org/info/rfc8995</a></span>.<a class="pilcrow" href="#section-boilerplate.1-3">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a class="section-name selfRef" href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a class="pilcrow" href="#section-boilerplate.2-1">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a class="pilcrow" href="#section-boilerplate.2-2">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a class="toplink" href="#" onclick="scroll(0,0)">▲</a><h2 id="name-table-of-contents">
<a class="section-name selfRef" href="#name-table-of-contents">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a class="xref" href="#section-1">1</a>.  <a class="xref" href="#name-introduction">Introduction</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.1.2.1">
                <p class="keepWithNext" id="section-toc.1-1.1.2.1.1"><a class="xref" href="#section-1.1">1.1</a>.  <a class="xref" href="#name-prior-bootstrapping-approac">Prior Bootstrapping Approaches</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.1.2.2">
                <p class="keepWithNext" id="section-toc.1-1.1.2.2.1"><a class="xref" href="#section-1.2">1.2</a>.  <a class="xref" href="#name-terminology">Terminology</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.1.2.3">
                <p id="section-toc.1-1.1.2.3.1"><a class="xref" href="#section-1.3">1.3</a>.  <a class="xref" href="#name-scope-of-solution">Scope of Solution</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.1.2.3.2.1">
                    <p class="keepWithNext" id="section-toc.1-1.1.2.3.2.1.1"><a class="xref" href="#section-1.3.1">1.3.1</a>.  <a class="xref" href="#name-support-environment">Support Environment</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.1.2.3.2.2">
                    <p id="section-toc.1-1.1.2.3.2.2.1"><a class="xref" href="#section-1.3.2">1.3.2</a>.  <a class="xref" href="#name-constrained-environments">Constrained Environments</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.1.2.3.2.3">
                    <p id="section-toc.1-1.1.2.3.2.3.1"><a class="xref" href="#section-1.3.3">1.3.3</a>.  <a class="xref" href="#name-network-access-controls">Network Access Controls</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.1.2.3.2.4">
                    <p id="section-toc.1-1.1.2.3.2.4.1"><a class="xref" href="#section-1.3.4">1.3.4</a>.  <a class="xref" href="#name-bootstrapping-is-not-bootin">Bootstrapping is Not Booting</a></p>
</li>
                </ul>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.1.2.4">
                <p id="section-toc.1-1.1.2.4.1"><a class="xref" href="#section-1.4">1.4</a>.  <a class="xref" href="#name-leveraging-the-new-key-infr">Leveraging the New Key Infrastructure / Next Steps</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.1.2.5">
                <p id="section-toc.1-1.1.2.5.1"><a class="xref" href="#section-1.5">1.5</a>.  <a class="xref" href="#name-requirements-for-autonomic-">Requirements for Autonomic Networking Infrastructure (ANI) Devices</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a class="xref" href="#section-2">2</a>.  <a class="xref" href="#name-architectural-overview">Architectural Overview</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a class="xref" href="#section-2.1">2.1</a>.  <a class="xref" href="#name-behavior-of-a-pledge">Behavior of a Pledge</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a class="xref" href="#section-2.2">2.2</a>.  <a class="xref" href="#name-secure-imprinting-using-vou">Secure Imprinting Using Vouchers</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a class="xref" href="#section-2.3">2.3</a>.  <a class="xref" href="#name-initial-device-identifier">Initial Device Identifier</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.2.2.3.2.1">
                    <p id="section-toc.1-1.2.2.3.2.1.1"><a class="xref" href="#section-2.3.1">2.3.1</a>.  <a class="xref" href="#name-identification-of-the-pledg">Identification of the Pledge</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.2.2.3.2.2">
                    <p id="section-toc.1-1.2.2.3.2.2.1"><a class="xref" href="#section-2.3.2">2.3.2</a>.  <a class="xref" href="#name-masa-uri-extension">MASA URI Extension</a></p>
</li>
                </ul>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.2.2.4">
                <p id="section-toc.1-1.2.2.4.1"><a class="xref" href="#section-2.4">2.4</a>.  <a class="xref" href="#name-protocol-flow">Protocol Flow</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.2.2.5">
                <p id="section-toc.1-1.2.2.5.1"><a class="xref" href="#section-2.5">2.5</a>.  <a class="xref" href="#name-architectural-components">Architectural Components</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.2.2.5.2.1">
                    <p id="section-toc.1-1.2.2.5.2.1.1"><a class="xref" href="#section-2.5.1">2.5.1</a>.  <a class="xref" href="#name-pledge">Pledge</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.2.2.5.2.2">
                    <p id="section-toc.1-1.2.2.5.2.2.1"><a class="xref" href="#section-2.5.2">2.5.2</a>.  <a class="xref" href="#name-join-proxy">Join Proxy</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.2.2.5.2.3">
                    <p id="section-toc.1-1.2.2.5.2.3.1"><a class="xref" href="#section-2.5.3">2.5.3</a>.  <a class="xref" href="#name-domain-registrar">Domain Registrar</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.2.2.5.2.4">
                    <p id="section-toc.1-1.2.2.5.2.4.1"><a class="xref" href="#section-2.5.4">2.5.4</a>.  <a class="xref" href="#name-manufacturer-service">Manufacturer Service</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.2.2.5.2.5">
                    <p id="section-toc.1-1.2.2.5.2.5.1"><a class="xref" href="#section-2.5.5">2.5.5</a>.  <a class="xref" href="#name-public-key-infrastructure-p">Public Key Infrastructure (PKI)</a></p>
</li>
                </ul>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.2.2.6">
                <p id="section-toc.1-1.2.2.6.1"><a class="xref" href="#section-2.6">2.6</a>.  <a class="xref" href="#name-certificate-time-validation">Certificate Time Validation</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.2.2.6.2.1">
                    <p id="section-toc.1-1.2.2.6.2.1.1"><a class="xref" href="#section-2.6.1">2.6.1</a>.  <a class="xref" href="#name-lack-of-real-time-clock">Lack of Real-Time Clock</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.2.2.6.2.2">
                    <p id="section-toc.1-1.2.2.6.2.2.1"><a class="xref" href="#section-2.6.2">2.6.2</a>.  <a class="xref" href="#name-infinite-lifetime-of-idevid">Infinite Lifetime of IDevID</a></p>
</li>
                </ul>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.2.2.7">
                <p id="section-toc.1-1.2.2.7.1"><a class="xref" href="#section-2.7">2.7</a>.  <a class="xref" href="#name-cloud-registrar">Cloud Registrar</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.2.2.8">
                <p id="section-toc.1-1.2.2.8.1"><a class="xref" href="#section-2.8">2.8</a>.  <a class="xref" href="#name-determining-the-masa-to-con">Determining the MASA to Contact</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a class="xref" href="#section-3">3</a>.  <a class="xref" href="#name-voucher-request-artifact">Voucher-Request Artifact</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a class="xref" href="#section-3.1">3.1</a>.  <a class="xref" href="#name-nonceless-voucher-requests">Nonceless Voucher-Requests</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a class="xref" href="#section-3.2">3.2</a>.  <a class="xref" href="#name-tree-diagram">Tree Diagram</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a class="xref" href="#section-3.3">3.3</a>.  <a class="xref" href="#name-examples">Examples</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a class="xref" href="#section-3.4">3.4</a>.  <a class="xref" href="#name-yang-module">YANG Module</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a class="xref" href="#section-4">4</a>.  <a class="xref" href="#name-proxying-details-pledge-pro">Proxying Details (Pledge -- Proxy -- Registrar)</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a class="xref" href="#section-4.1">4.1</a>.  <a class="xref" href="#name-pledge-discovery-of-proxy">Pledge Discovery of Proxy</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.4.2.1.2.1">
                    <p id="section-toc.1-1.4.2.1.2.1.1"><a class="xref" href="#section-4.1.1">4.1.1</a>.  <a class="xref" href="#name-proxy-grasp-announcements">Proxy GRASP Announcements</a></p>
</li>
                </ul>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a class="xref" href="#section-4.2">4.2</a>.  <a class="xref" href="#name-coap-connection-to-registra">CoAP Connection to Registrar</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a class="xref" href="#section-4.3">4.3</a>.  <a class="xref" href="#name-proxy-discovery-and-communi">Proxy Discovery and Communication of Registrar</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a class="xref" href="#section-5">5</a>.  <a class="xref" href="#name-protocol-details-pledge-reg">Protocol Details (Pledge -- Registrar -- MASA)</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a class="xref" href="#section-5.1">5.1</a>.  <a class="xref" href="#name-brski-est-tls-establishment">BRSKI-EST TLS Establishment Details</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a class="xref" href="#section-5.2">5.2</a>.  <a class="xref" href="#name-pledge-requests-voucher-fro">Pledge Requests Voucher from the Registrar</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a class="xref" href="#section-5.3">5.3</a>.  <a class="xref" href="#name-registrar-authorization-of-">Registrar Authorization of Pledge</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a class="xref" href="#section-5.4">5.4</a>.  <a class="xref" href="#name-brski-masa-tls-establishmen">BRSKI-MASA TLS Establishment Details</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.5.2.4.2.1">
                    <p id="section-toc.1-1.5.2.4.2.1.1"><a class="xref" href="#section-5.4.1">5.4.1</a>.  <a class="xref" href="#name-masa-authentication-of-cust">MASA Authentication of Customer Registrar</a></p>
</li>
                </ul>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.5.2.5">
                <p id="section-toc.1-1.5.2.5.1"><a class="xref" href="#section-5.5">5.5</a>.  <a class="xref" href="#name-registrar-requests-voucher-">Registrar Requests Voucher from MASA</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.5.2.5.2.1">
                    <p id="section-toc.1-1.5.2.5.2.1.1"><a class="xref" href="#section-5.5.1">5.5.1</a>.  <a class="xref" href="#name-masa-renewal-of-expired-vou">MASA Renewal of Expired Vouchers</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.5.2.5.2.2">
                    <p id="section-toc.1-1.5.2.5.2.2.1"><a class="xref" href="#section-5.5.2">5.5.2</a>.  <a class="xref" href="#name-masa-pinning-of-registrar">MASA Pinning of Registrar</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.5.2.5.2.3">
                    <p id="section-toc.1-1.5.2.5.2.3.1"><a class="xref" href="#section-5.5.3">5.5.3</a>.  <a class="xref" href="#name-masa-check-of-the-voucher-r">MASA Check of the Voucher-Request Signature</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.5.2.5.2.4">
                    <p id="section-toc.1-1.5.2.5.2.4.1"><a class="xref" href="#section-5.5.4">5.5.4</a>.  <a class="xref" href="#name-masa-verification-of-the-do">MASA Verification of the Domain Registrar</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.5.2.5.2.5">
                    <p id="section-toc.1-1.5.2.5.2.5.1"><a class="xref" href="#section-5.5.5">5.5.5</a>.  <a class="xref" href="#name-masa-verification-of-the-pl">MASA Verification of the Pledge 'prior-signed-voucher-request'</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.5.2.5.2.6">
                    <p id="section-toc.1-1.5.2.5.2.6.1"><a class="xref" href="#section-5.5.6">5.5.6</a>.  <a class="xref" href="#name-masa-nonce-handling">MASA Nonce Handling</a></p>
</li>
                </ul>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.5.2.6">
                <p id="section-toc.1-1.5.2.6.1"><a class="xref" href="#section-5.6">5.6</a>.  <a class="xref" href="#name-masa-and-registrar-voucher-">MASA and Registrar Voucher Response</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.5.2.6.2.1">
                    <p id="section-toc.1-1.5.2.6.2.1.1"><a class="xref" href="#section-5.6.1">5.6.1</a>.  <a class="xref" href="#name-pledge-voucher-verification">Pledge Voucher Verification</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.5.2.6.2.2">
                    <p id="section-toc.1-1.5.2.6.2.2.1"><a class="xref" href="#section-5.6.2">5.6.2</a>.  <a class="xref" href="#name-pledge-authentication-of-pr">Pledge Authentication of Provisional TLS Connection</a></p>
</li>
                </ul>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.5.2.7">
                <p id="section-toc.1-1.5.2.7.1"><a class="xref" href="#section-5.7">5.7</a>.  <a class="xref" href="#name-pledge-brski-status-telemet">Pledge BRSKI Status Telemetry</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.5.2.8">
                <p id="section-toc.1-1.5.2.8.1"><a class="xref" href="#section-5.8">5.8</a>.  <a class="xref" href="#name-registrar-audit-log-request">Registrar Audit-Log Request</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.5.2.8.2.1">
                    <p id="section-toc.1-1.5.2.8.2.1.1"><a class="xref" href="#section-5.8.1">5.8.1</a>.  <a class="xref" href="#name-masa-audit-log-response">MASA Audit-Log Response</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.5.2.8.2.2">
                    <p id="section-toc.1-1.5.2.8.2.2.1"><a class="xref" href="#section-5.8.2">5.8.2</a>.  <a class="xref" href="#name-calculation-of-domainid">Calculation of domainID</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.5.2.8.2.3">
                    <p id="section-toc.1-1.5.2.8.2.3.1"><a class="xref" href="#section-5.8.3">5.8.3</a>.  <a class="xref" href="#name-registrar-audit-log-verific">Registrar Audit-Log Verification</a></p>
</li>
                </ul>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.5.2.9">
                <p id="section-toc.1-1.5.2.9.1"><a class="xref" href="#section-5.9">5.9</a>.  <a class="xref" href="#name-est-integration-for-pki-boo">EST Integration for PKI Bootstrapping</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.5.2.9.2.1">
                    <p id="section-toc.1-1.5.2.9.2.1.1"><a class="xref" href="#section-5.9.1">5.9.1</a>.  <a class="xref" href="#name-est-distribution-of-ca-cert">EST Distribution of CA Certificates</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.5.2.9.2.2">
                    <p id="section-toc.1-1.5.2.9.2.2.1"><a class="xref" href="#section-5.9.2">5.9.2</a>.  <a class="xref" href="#name-est-csr-attributes">EST CSR Attributes</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.5.2.9.2.3">
                    <p id="section-toc.1-1.5.2.9.2.3.1"><a class="xref" href="#section-5.9.3">5.9.3</a>.  <a class="xref" href="#name-est-client-certificate-requ">EST Client Certificate Request</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.5.2.9.2.4">
                    <p id="section-toc.1-1.5.2.9.2.4.1"><a class="xref" href="#section-5.9.4">5.9.4</a>.  <a class="xref" href="#name-enrollment-status-telemetry">Enrollment Status Telemetry</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.5.2.9.2.5">
                    <p id="section-toc.1-1.5.2.9.2.5.1"><a class="xref" href="#section-5.9.5">5.9.5</a>.  <a class="xref" href="#name-multiple-certificates">Multiple Certificates</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.5.2.9.2.6">
                    <p id="section-toc.1-1.5.2.9.2.6.1"><a class="xref" href="#section-5.9.6">5.9.6</a>.  <a class="xref" href="#name-est-over-coap">EST over CoAP</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a class="xref" href="#section-6">6</a>.  <a class="xref" href="#name-clarification-of-transfer-e">Clarification of Transfer-Encoding</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a class="xref" href="#section-7">7</a>.  <a class="xref" href="#name-reduced-security-operationa">Reduced Security Operational Modes</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a class="xref" href="#section-7.1">7.1</a>.  <a class="xref" href="#name-trust-model">Trust Model</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a class="xref" href="#section-7.2">7.2</a>.  <a class="xref" href="#name-pledge-security-reductions">Pledge Security Reductions</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a class="xref" href="#section-7.3">7.3</a>.  <a class="xref" href="#name-registrar-security-reductio">Registrar Security Reductions</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a class="xref" href="#section-7.4">7.4</a>.  <a class="xref" href="#name-masa-security-reductions">MASA Security Reductions</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.7.2.4.2.1">
                    <p id="section-toc.1-1.7.2.4.2.1.1"><a class="xref" href="#section-7.4.1">7.4.1</a>.  <a class="xref" href="#name-issuing-nonceless-vouchers">Issuing Nonceless Vouchers</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.7.2.4.2.2">
                    <p id="section-toc.1-1.7.2.4.2.2.1"><a class="xref" href="#section-7.4.2">7.4.2</a>.  <a class="xref" href="#name-trusting-owners-on-first-us">Trusting Owners on First Use</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.7.2.4.2.3">
                    <p id="section-toc.1-1.7.2.4.2.3.1"><a class="xref" href="#section-7.4.3">7.4.3</a>.  <a class="xref" href="#name-updating-or-extending-vouch">Updating or Extending Voucher Trust Anchors</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a class="xref" href="#section-8">8</a>.  <a class="xref" href="#name-iana-considerations">IANA Considerations</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a class="xref" href="#section-8.1">8.1</a>.  <a class="xref" href="#name-the-ietf-xml-registry">The IETF XML Registry</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a class="xref" href="#section-8.2">8.2</a>.  <a class="xref" href="#name-yang-module-names-registry">YANG Module Names Registry</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a class="xref" href="#section-8.3">8.3</a>.  <a class="xref" href="#name-brski-well-known-considerat">BRSKI Well-Known Considerations</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.8.2.3.2.1">
                    <p id="section-toc.1-1.8.2.3.2.1.1"><a class="xref" href="#section-8.3.1">8.3.1</a>.  <a class="xref" href="#name-brski-well-known-registrati">BRSKI .well-known Registration</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.8.2.3.2.2">
                    <p id="section-toc.1-1.8.2.3.2.2.1"><a class="xref" href="#section-8.3.2">8.3.2</a>.  <a class="xref" href="#name-brski-well-known-registry">BRSKI .well-known Registry</a></p>
</li>
                </ul>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.8.2.4">
                <p id="section-toc.1-1.8.2.4.1"><a class="xref" href="#section-8.4">8.4</a>.  <a class="xref" href="#name-pkix-registry">PKIX Registry</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.8.2.5">
                <p id="section-toc.1-1.8.2.5.1"><a class="xref" href="#section-8.5">8.5</a>.  <a class="xref" href="#name-pledge-brski-status-telemetr">Pledge BRSKI Status Telemetry</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.8.2.6">
                <p id="section-toc.1-1.8.2.6.1"><a class="xref" href="#section-8.6">8.6</a>.  <a class="xref" href="#name-dns-service-names">DNS Service Names</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.8.2.7">
                <p id="section-toc.1-1.8.2.7.1"><a class="xref" href="#section-8.7">8.7</a>.  <a class="xref" href="#name-grasp-objective-names">GRASP Objective Names</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a class="xref" href="#section-9">9</a>.  <a class="xref" href="#name-applicability-to-the-autono">Applicability to the Autonomic Control Plane (ACP)</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a class="xref" href="#section-9.1">9.1</a>.  <a class="xref" href="#name-operational-requirements">Operational Requirements</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.9.2.1.2.1">
                    <p id="section-toc.1-1.9.2.1.2.1.1"><a class="xref" href="#section-9.1.1">9.1.1</a>.  <a class="xref" href="#name-masa-operational-requiremen">MASA Operational Requirements</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.9.2.1.2.2">
                    <p id="section-toc.1-1.9.2.1.2.2.1"><a class="xref" href="#section-9.1.2">9.1.2</a>.  <a class="xref" href="#name-domain-owner-operational-re">Domain Owner Operational Requirements</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.9.2.1.2.3">
                    <p id="section-toc.1-1.9.2.1.2.3.1"><a class="xref" href="#section-9.1.3">9.1.3</a>.  <a class="xref" href="#name-device-operational-requirem">Device Operational Requirements</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a class="xref" href="#section-10">10</a>. <a class="xref" href="#name-privacy-considerations">Privacy Considerations</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a class="xref" href="#section-10.1">10.1</a>.  <a class="xref" href="#name-masa-audit-log">MASA Audit-Log</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a class="xref" href="#section-10.2">10.2</a>.  <a class="xref" href="#name-what-brski-est-reveals">What BRSKI-EST Reveals</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.10.2.3">
                <p id="section-toc.1-1.10.2.3.1"><a class="xref" href="#section-10.3">10.3</a>.  <a class="xref" href="#name-what-brski-masa-reveals-to-">What BRSKI-MASA Reveals to the Manufacturer</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.10.2.4">
                <p id="section-toc.1-1.10.2.4.1"><a class="xref" href="#section-10.4">10.4</a>.  <a class="xref" href="#name-manufacturers-and-used-or-s">Manufacturers and Used or Stolen Equipment</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.10.2.5">
                <p id="section-toc.1-1.10.2.5.1"><a class="xref" href="#section-10.5">10.5</a>.  <a class="xref" href="#name-manufacturers-and-grey-mark">Manufacturers and Grey Market Equipment</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.10.2.6">
                <p id="section-toc.1-1.10.2.6.1"><a class="xref" href="#section-10.6">10.6</a>.  <a class="xref" href="#name-some-mitigations-for-meddli">Some Mitigations for Meddling by Manufacturers</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.10.2.7">
                <p id="section-toc.1-1.10.2.7.1"><a class="xref" href="#section-10.7">10.7</a>.  <a class="xref" href="#name-death-of-a-manufacturer">Death of a Manufacturer</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a class="xref" href="#section-11">11</a>. <a class="xref" href="#name-security-considerations">Security Considerations</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a class="xref" href="#section-11.1">11.1</a>.  <a class="xref" href="#name-denial-of-service-dos-again">Denial of Service (DoS) against MASA</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a class="xref" href="#section-11.2">11.2</a>.  <a class="xref" href="#name-domainid-must-be-resistant-">DomainID Must Be Resistant to Second-Preimage Attacks</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.11.2.3">
                <p id="section-toc.1-1.11.2.3.1"><a class="xref" href="#section-11.3">11.3</a>.  <a class="xref" href="#name-availability-of-good-random">Availability of Good Random Numbers</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.11.2.4">
                <p id="section-toc.1-1.11.2.4.1"><a class="xref" href="#section-11.4">11.4</a>.  <a class="xref" href="#name-freshness-in-voucher-reques">Freshness in Voucher-Requests</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.11.2.5">
                <p id="section-toc.1-1.11.2.5.1"><a class="xref" href="#section-11.5">11.5</a>.  <a class="xref" href="#name-trusting-manufacturers">Trusting Manufacturers</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.11.2.6">
                <p id="section-toc.1-1.11.2.6.1"><a class="xref" href="#section-11.6">11.6</a>.  <a class="xref" href="#name-manufacturer-maintenance-of">Manufacturer Maintenance of Trust Anchors</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.11.2.6.2.1">
                    <p id="section-toc.1-1.11.2.6.2.1.1"><a class="xref" href="#section-11.6.1">11.6.1</a>.  <a class="xref" href="#name-compromise-of-manufacturer-">Compromise of Manufacturer IDevID Signing Keys</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.11.2.6.2.2">
                    <p id="section-toc.1-1.11.2.6.2.2.1"><a class="xref" href="#section-11.6.2">11.6.2</a>.  <a class="xref" href="#name-compromise-of-masa-signing-">Compromise of MASA Signing Keys</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.11.2.6.2.3">
                    <p id="section-toc.1-1.11.2.6.2.3.1"><a class="xref" href="#section-11.6.3">11.6.3</a>.  <a class="xref" href="#name-compromise-of-masa-web-serv">Compromise of MASA Web Service</a></p>
</li>
                </ul>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.11.2.7">
                <p id="section-toc.1-1.11.2.7.1"><a class="xref" href="#section-11.7">11.7</a>.  <a class="xref" href="#name-yang-module-security-consid">YANG Module Security Considerations</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a class="xref" href="#section-12">12</a>. <a class="xref" href="#name-references">References</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a class="xref" href="#section-12.1">12.1</a>.  <a class="xref" href="#name-normative-references">Normative References</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a class="xref" href="#section-12.2">12.2</a>.  <a class="xref" href="#name-informative-references">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a class="xref" href="#section-appendix.a">Appendix A</a>.  <a class="xref" href="#name-ipv4-and-non-ani-operations">IPv4 and Non-ANI Operations</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a class="xref" href="#section-a.1">A.1</a>.  <a class="xref" href="#name-ipv4-link-local-addresses">IPv4 Link-Local Addresses</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a class="xref" href="#section-a.2">A.2</a>.  <a class="xref" href="#name-use-of-dhcpv4">Use of DHCPv4</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a class="xref" href="#section-appendix.b">Appendix B</a>.  <a class="xref" href="#name-mdns-dns-sd-proxy-discovery">mDNS / DNS-SD Proxy Discovery Options</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a class="xref" href="#section-appendix.c">Appendix C</a>.  <a class="xref" href="#name-example-vouchers">Example Vouchers</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.15.2.1">
                <p id="section-toc.1-1.15.2.1.1"><a class="xref" href="#section-c.1">C.1</a>.  <a class="xref" href="#name-keys-involved">Keys Involved</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.15.2.1.2.1">
                    <p id="section-toc.1-1.15.2.1.2.1.1"><a class="xref" href="#section-c.1.1">C.1.1</a>.  <a class="xref" href="#name-manufacturer-certification-">Manufacturer Certification Authority for IDevID Signatures</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.15.2.1.2.2">
                    <p id="section-toc.1-1.15.2.1.2.2.1"><a class="xref" href="#section-c.1.2">C.1.2</a>.  <a class="xref" href="#name-masa-key-pair-for-voucher-s">MASA Key Pair for Voucher Signatures</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.15.2.1.2.3">
                    <p id="section-toc.1-1.15.2.1.2.3.1"><a class="xref" href="#section-c.1.3">C.1.3</a>.  <a class="xref" href="#name-registrar-certification-aut">Registrar Certification Authority</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.15.2.1.2.4">
                    <p id="section-toc.1-1.15.2.1.2.4.1"><a class="xref" href="#section-c.1.4">C.1.4</a>.  <a class="xref" href="#name-registrar-key-pair">Registrar Key Pair</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.15.2.1.2.5">
                    <p id="section-toc.1-1.15.2.1.2.5.1"><a class="xref" href="#section-c.1.5">C.1.5</a>.  <a class="xref" href="#name-pledge-key-pair">Pledge Key Pair</a></p>
</li>
                </ul>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.15.2.2">
                <p id="section-toc.1-1.15.2.2.1"><a class="xref" href="#section-c.2">C.2</a>.  <a class="xref" href="#name-example-process">Example Process</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.15.2.2.2.1">
                    <p id="section-toc.1-1.15.2.2.2.1.1"><a class="xref" href="#section-c.2.1">C.2.1</a>.  <a class="xref" href="#name-pledge-to-registrar">Pledge to Registrar</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.15.2.2.2.2">
                    <p id="section-toc.1-1.15.2.2.2.2.1"><a class="xref" href="#section-c.2.2">C.2.2</a>.  <a class="xref" href="#name-registrar-to-masa">Registrar to MASA</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.15.2.2.2.3">
                    <p id="section-toc.1-1.15.2.2.2.3.1"><a class="xref" href="#section-c.2.3">C.2.3</a>.  <a class="xref" href="#name-masa-to-registrar">MASA to Registrar</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.15.2.2.2.4">
                    <p id="section-toc.1-1.15.2.2.2.4.1"><a class="xref" href="#section-c.2.4"></a><a class="xref" href="#name-acknowledgements">Acknowledgements</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a class="xref" href="#section-appendix.d"></a><a class="xref" href="#name-authors-addresses">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<section id="section-1">
      <h2 id="name-introduction">
<a class="section-number selfRef" href="#section-1">1. </a><a class="section-name selfRef" href="#name-introduction">Introduction</a>
      </h2>
<p id="section-1-1">
        The Bootstrapping Remote Secure Key Infrastructure (BRSKI) protocol
        provides a solution for secure zero-touch (automated) bootstrap of
        new (unconfigured) devices that are called "pledges" in this
        document.  Pledges have an Initial Device Identifier (IDevID) installed in them at the factory.<a class="pilcrow" href="#section-1-1">¶</a></p>
<p id="section-1-2">
        "BRSKI", pronounced like "brewski", is a colloquial term for beer in
        Canada and parts of the Midwestern United States <span>[<a class="xref" href="#brewski">brewski</a>]</span>.<a class="pilcrow" href="#section-1-2">¶</a></p>
<p id="section-1-3">
        This document primarily provides for the needs of
        the ISP and enterprise-focused Autonomic Networking Integrated Model and Approach (ANIMA)
        Autonomic Control Plane (ACP) <span>[<a class="xref" href="#RFC8994">RFC8994</a>]</span>.

 This bootstrap process satisfies
        the requirement of making all operations
        secure by default per <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc7575#section-3.3">Section 3.3</a> of [<a class="xref" href="#RFC7575">RFC7575</a>]</span>.

 Other users of the BRSKI protocol
        will need to provide separate applicability statements that
        include privacy and security considerations appropriate to that
        deployment.  <a class="xref" href="#acpapplicability">Section 9</a> explains the detailed
        applicability for this ACP usage.<a class="pilcrow" href="#section-1-3">¶</a></p>
<p id="section-1-4">
        The BRSKI protocol requires a significant amount of communication
        between manufacturer and owner: in its default modes, it provides a
        cryptographic transfer of control to the initial owner.  In its
        strongest modes, it leverages sales channel information to identify
        the owner in advance.  Resale of devices is possible, provided that
        the manufacturer is willing to authorize the transfer.  Mechanisms
        to enable transfers of ownership without manufacturer authorization
        are not included in this version of the protocol, but it could be
        designed into future versions.<a class="pilcrow" href="#section-1-4">¶</a></p>
<p id="section-1-5">
        This document describes how a pledge discovers (or are discovered by) an
        element of the network domain that it will belong to and that will perform
        its bootstrap.  This element (device) is called the
        "registrar".  Before any other operation, the pledge and registrar need to
        establish mutual trust:<a class="pilcrow" href="#section-1-5">¶</a></p>
<ol class="normal type-1" id="section-1-6" start="1" type="1">
        <li id="section-1-6.1">Registrar authenticating the pledge: "Who is this device? What is
          its identity?"<a class="pilcrow" href="#section-1-6.1">¶</a>
</li>
        <li id="section-1-6.2">Registrar authorizing the pledge: "Is it mine? Do I want it?
          What are the chances it has been compromised?"<a class="pilcrow" href="#section-1-6.2">¶</a>
</li>
        <li id="section-1-6.3">Pledge authenticating the registrar: "What is this
          registrar's identity?"<a class="pilcrow" href="#section-1-6.3">¶</a>
</li>
        <li id="section-1-6.4">Pledge authorizing the registrar: "Should I join this network?"<a class="pilcrow" href="#section-1-6.4">¶</a>
</li>
      </ol>
<p id="section-1-7">
          This document details protocols and messages to answer the above questions.
          It uses a TLS connection and a PKIX-shaped (X.509v3) certificate (an IEEE
          802.1AR IDevID <span>[<a class="xref" href="#IDevID">IDevID</a>]</span>) of the pledge to answer
          points 1 and 2.
          It uses a new artifact called a "voucher" that the registrar
          receives from a Manufacturer Authorized Signing Authority (MASA) and
          passes it to the pledge to answer points 3 and 4.<a class="pilcrow" href="#section-1-7">¶</a></p>
<p id="section-1-8">
          A proxy provides very limited connectivity between the pledge and
          the registrar.<a class="pilcrow" href="#section-1-8">¶</a></p>
<p id="section-1-9">The syntactic details of vouchers are described in detail in <span>[<a class="xref" href="#RFC8366">RFC8366</a>]</span>. This document details automated
      protocol mechanisms to obtain vouchers, including the definition
      of a "voucher-request" message that is a minor extension
      to the voucher format (see <a class="xref" href="#voucher-request">Section 3</a>) as defined
      by <span>[<a class="xref" href="#RFC8366">RFC8366</a>]</span>.<a class="pilcrow" href="#section-1-9">¶</a></p>
<p id="section-1-10">BRSKI results in the pledge storing an X.509 root
    certificate sufficient for verifying the registrar identity. In the
    process, a TLS connection is established that can be directly used for
    Enrollment over Secure Transport (EST).

    In effect, BRSKI provides
    an automated mechanism for "Bootstrap Distribution of CA Certificates"
    described in <span>[<a class="xref" href="#RFC7030">RFC7030</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc7030#section-4.1.1">Section 4.1.1</a></span>, wherein
    the pledge "<span class="bcp14">MUST</span> [...] engage a human user to authorize the CA certificate using
    out-of-band data". With BRSKI, the pledge now can automate
    this process using the voucher. Integration with a complete EST
      enrollment is optional but trivial.<a class="pilcrow" href="#section-1-10">¶</a></p>
<p id="section-1-11">BRSKI is agile enough to support
      bootstrapping alternative key infrastructures, such as a symmetric key
      solution, but no such system is described in this document.<a class="pilcrow" href="#section-1-11">¶</a></p>
<section id="section-1.1">
        <h3 id="name-prior-bootstrapping-approac">
<a class="section-number selfRef" href="#section-1.1">1.1. </a><a class="section-name selfRef" href="#name-prior-bootstrapping-approac">Prior Bootstrapping Approaches</a>
        </h3>
<p id="section-1.1-1">To literally "pull yourself up by the bootstraps" is an impossible
        action. Similarly, the secure establishment of a key infrastructure
        without external help is also an impossibility. Today, it is commonly
        accepted that the initial connections between nodes are insecure, until
        key distribution is complete, or that domain-specific keying material
        (often pre-shared keys, including mechanisms like Subscriber Identification Module (SIM) cards)
        is pre-provisioned on each new device in a costly and non-scalable
        manner.

 Existing automated mechanisms are known as non-secured "Trust on
        First Use (TOFU)" <span>[<a class="xref" href="#RFC7435">RFC7435</a>]</span>, "resurrecting duckling"
        <span>[<a class="xref" href="#Stajano99theresurrecting">Stajano99theresurrecting</a>]</span>, or "pre-staging".<a class="pilcrow" href="#section-1.1-1">¶</a></p>
<p id="section-1.1-2">Another prior approach has been to try and
        minimize user actions during bootstrapping, but not eliminate all
        user actions.
        The original EST protocol <span>[<a class="xref" href="#RFC7030">RFC7030</a>]</span> does reduce user actions during bootstrapping
        but does not provide solutions for how the following protocol steps
        can be made autonomic (not involving user actions):<a class="pilcrow" href="#section-1.1-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-3.1">using the Implicit Trust Anchor (TA) <span>[<a class="xref" href="#RFC7030">RFC7030</a>]</span> database to authenticate
                an owner-specific service (not an autonomic solution because
                the URL must be securely distributed),<a class="pilcrow" href="#section-1.1-3.1">¶</a>
</li>
          <li class="normal" id="section-1.1-3.2">engaging a human user to authorize the CA certificate using
                  out-of-band data (not an autonomic solution because the human user
                  is involved),<a class="pilcrow" href="#section-1.1-3.2">¶</a>
</li>
          <li class="normal" id="section-1.1-3.3">using a configured Explicit TA database (not an autonomic
                  solution because the distribution of an explicit TA database is
                  not autonomic), and<a class="pilcrow" href="#section-1.1-3.3">¶</a>
</li>
          <li class="normal" id="section-1.1-3.4">using a certificate-less TLS mutual authentication method
                  (not an autonomic solution because the distribution of symmetric
                  key material is not autonomic).<a class="pilcrow" href="#section-1.1-3.4">¶</a>
</li>
        </ul>
<p id="section-1.1-4">
            These "touch" methods do not meet the requirements for
            zero-touch.<a class="pilcrow" href="#section-1.1-4">¶</a></p>
<p id="section-1.1-5">There are "call home" technologies where the pledge first
              establishes a connection to a well-known manufacturer service using a common
              client-server authentication model. After mutual authentication,
              appropriate credentials to authenticate the target domain are
              transferred to the pledge. This creates several problems and
              limitations:<a class="pilcrow" href="#section-1.1-5">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-6.1">the pledge requires real-time connectivity to the manufacturer
                  service,<a class="pilcrow" href="#section-1.1-6.1">¶</a>
</li>
          <li class="normal" id="section-1.1-6.2">the domain identity is exposed to the manufacturer service (this is a
                  privacy concern), and<a class="pilcrow" href="#section-1.1-6.2">¶</a>
</li>
          <li class="normal" id="section-1.1-6.3">the manufacturer is responsible for making the authorization
                  decisions (this is a liability concern).<a class="pilcrow" href="#section-1.1-6.3">¶</a>
</li>
        </ul>
<p id="section-1.1-7">BRSKI addresses these issues by defining extensions to the EST protocol
             for the automated distribution of vouchers.<a class="pilcrow" href="#section-1.1-7">¶</a></p>
</section>
<section id="section-1.2">
        <h3 id="name-terminology">
<a class="section-number selfRef" href="#section-1.2">1.2. </a><a class="section-name selfRef" href="#name-terminology">Terminology</a>
        </h3>
<p id="section-1.2-1">
    The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
    "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
    described in BCP 14 <span>[<a class="xref" href="#RFC2119">RFC2119</a>]</span> <span>[<a class="xref" href="#RFC8174">RFC8174</a>]</span>
    when, and only when, they appear in all capitals, as shown here.<a class="pilcrow" href="#section-1.2-1">¶</a></p>
<p id="section-1.2-2">The following terms are defined for clarity:<a class="pilcrow" href="#section-1.2-2">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-1.2-3">
          <dt id="section-1.2-3.1">ANI:</dt>
          <dd id="section-1.2-3.2" style="margin-left: 1.5em">The Autonomic Networking Infrastructure as
            defined by <span>[<a class="xref" href="#RFC8993">RFC8993</a>]</span>.
            <a class="xref" href="#acpapplicability">Section 9</a> details specific requirements for pledges,
            proxies, and registrars when they are part of an ANI.<a class="pilcrow" href="#section-1.2-3.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.3">Circuit Proxy:</dt>
          <dd id="section-1.2-3.4" style="margin-left: 1.5em">A stateful implementation
              of the Join Proxy. This is the assumed type of proxy.<a class="pilcrow" href="#section-1.2-3.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.5">drop-ship:</dt>
          <dd id="section-1.2-3.6" style="margin-left: 1.5em">The physical distribution of equipment
            containing the "factory default" configuration to a final
            destination. In zero-touch scenarios, there is no staging or
            preconfiguration during drop-ship.<a class="pilcrow" href="#section-1.2-3.6">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.7">Domain:</dt>
          <dd id="section-1.2-3.8" style="margin-left: 1.5em">The set of entities that share a common local
            trust anchor. This includes the proxy, registrar,
            domain CA, management components, and any
          existing entity that is already a member of the domain.<a class="pilcrow" href="#section-1.2-3.8">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.9">Domain CA:</dt>
          <dd id="section-1.2-3.10" style="margin-left: 1.5em">The domain Certification Authority (CA)
            provides certification functionalities to the domain. At a minimum,
            it provides certification functionalities to a registrar and
            manages the private key that defines the domain. Optionally, it
            certifies all elements.<a class="pilcrow" href="#section-1.2-3.10">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.11">domainID:</dt>
          <dd id="section-1.2-3.12" style="margin-left: 1.5em">The domain IDentity is a unique value
            based upon the registrar's CA certificate.
            <a class="xref" href="#domainID">Section 5.8.2</a> specifies how it is calculated.<a class="pilcrow" href="#section-1.2-3.12">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.13">enrollment:</dt>
          <dd id="section-1.2-3.14" style="margin-left: 1.5em">The process where a device presents key
            material to a network and acquires a network-specific identity.
            For example, when a certificate signing request is presented to a
            CA, and a certificate is obtained in
          response.<a class="pilcrow" href="#section-1.2-3.14">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.15">IDevID:</dt>
          <dd id="section-1.2-3.16" style="margin-left: 1.5em">An Initial Device Identifier X.509 certificate
            installed by the vendor on new equipment. This is a term from
            802.1AR <span>[<a class="xref" href="#IDevID">IDevID</a>]</span>.<a class="pilcrow" href="#section-1.2-3.16">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.17">imprint:</dt>
          <dd id="section-1.2-3.18" style="margin-left: 1.5em">The process where a device obtains the
            cryptographic key material to identify and trust future
            interactions with a network. This term is taken from Konrad
            Lorenz's work in biology with new ducklings: during a critical
            period, the duckling would assume that anything that looks like a
            mother duck is in fact their mother. An equivalent for a device is
            to obtain the fingerprint of the network's root CA certificate. A device that imprints on an attacker
            suffers a similar fate to a duckling that imprints on a hungry
            wolf. Securely imprinting is a primary focus of this
            document <span>[<a class="xref" href="#imprinting">imprinting</a>]</span>. The analogy to
            Lorenz's work was first noted in <span>[<a class="xref" href="#Stajano99theresurrecting">Stajano99theresurrecting</a>]</span>.<a class="pilcrow" href="#section-1.2-3.18">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.19">IPIP Proxy:</dt>
          <dd id="section-1.2-3.20" style="margin-left: 1.5em">A stateless proxy alternative.<a class="pilcrow" href="#section-1.2-3.20">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.21">Join Proxy:</dt>
          <dd id="section-1.2-3.22" style="margin-left: 1.5em">A domain entity that helps the pledge join
            the domain. A Join Proxy facilitates communication for devices that
            find themselves in an environment where they are not provided
            connectivity until after they are validated as members of the
            domain. For simplicity, this document sometimes uses the
            term of "proxy" to indicate the Join Proxy. The pledge
            is unaware that they are communicating with a
            proxy rather than directly with a registrar.<a class="pilcrow" href="#section-1.2-3.22">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.23">Join Registrar (and Coordinator):</dt>
          <dd id="section-1.2-3.24" style="margin-left: 1.5em">A representative of the domain that is
            configured, perhaps autonomically, to decide whether a new device
            is allowed to join the domain. The administrator of the domain
            interfaces with a "Join Registrar (and Coordinator)" to control this process. Typically, a
            Join Registrar is "inside" its domain. For simplicity, this document
            often refers to this as just "registrar". Within <span>[<a class="xref" href="#RFC8993">RFC8993</a>]</span>, it is
            referred to as the "Join Registrar Autonomic Service Agent (ASA)".
            Other communities use the abbreviation "JRC".<a class="pilcrow" href="#section-1.2-3.24">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.25">LDevID:</dt>
          <dd id="section-1.2-3.26" style="margin-left: 1.5em">A Local Device Identifier X.509 certificate
            installed by the owner of the equipment. This is a term from
            802.1AR <span>[<a class="xref" href="#IDevID">IDevID</a>]</span>.<a class="pilcrow" href="#section-1.2-3.26">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.27">manufacturer:</dt>
          <dd id="section-1.2-3.28" style="margin-left: 1.5em">The term manufacturer is used
            throughout this document as the entity that created the
            device.  This is typically the original equipment manufacturer
            (OEM), but in more complex situations, it could be a value added
            retailer (VAR), or possibly even a systems integrator.  In
            general, a goal of BRSKI is to eliminate small distinctions
            between different sales channels.  The reason for this is
            that it permits a single device, with a uniform firmware load, to
            be shipped directly to all customers.  This eliminates costs
            for the manufacturer.  This also reduces the number of products
            supported in the field, increasing the chance that firmware will
            be more up to date.<a class="pilcrow" href="#section-1.2-3.28">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.29">MASA Audit-Log:</dt>
          <dd id="section-1.2-3.30" style="margin-left: 1.5em">An anonymized list of previous owners
            maintained by the MASA on a per-device (per-pledge)
            basis, as described in <a class="xref" href="#MASAauditlog">Section 5.8.1</a>.<a class="pilcrow" href="#section-1.2-3.30">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.31">MASA Service:</dt>
          <dd id="section-1.2-3.32" style="margin-left: 1.5em">A third-party MASA service on the global Internet. The MASA
            signs vouchers. It also provides a repository for audit-log
            information of privacy-protected bootstrapping events. It does
            not track ownership.<a class="pilcrow" href="#section-1.2-3.32">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.33">nonced:</dt>
          <dd id="section-1.2-3.34" style="margin-left: 1.5em">A voucher (or request) that contains a nonce (the normal
          case).<a class="pilcrow" href="#section-1.2-3.34">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.35">nonceless:</dt>
          <dd id="section-1.2-3.36" style="margin-left: 1.5em">A voucher (or request) that does not
            contain a nonce and either relies upon accurate clocks for expiration or
            does not expire.<a class="pilcrow" href="#section-1.2-3.36">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.37">offline:</dt>
          <dd id="section-1.2-3.38" style="margin-left: 1.5em">When an architectural component cannot
              perform real-time communications with a peer, due to
              either network connectivity or the peer being turned off, the
              operation is said to be occurring offline.<a class="pilcrow" href="#section-1.2-3.38">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.39">Ownership Tracker:</dt>
          <dd id="section-1.2-3.40" style="margin-left: 1.5em">An Ownership Tracker service on
            the global Internet. The Ownership Tracker uses business processes
            to accurately track ownership of all devices shipped against
            domains that have purchased them. Although optional, this component
            allows vendors to provide additional value in cases where their
            sales and distribution channels allow for accurate tracking of
            such ownership.
     Tracking information about ownership is indicated in
            vouchers, as described in <span>[<a class="xref" href="#RFC8366">RFC8366</a>]</span>.<a class="pilcrow" href="#section-1.2-3.40">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.41">Pledge:</dt>
          <dd id="section-1.2-3.42" style="margin-left: 1.5em">The prospective (unconfigured) device, which has an
            identity installed at the factory.<a class="pilcrow" href="#section-1.2-3.42">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.43">(Public) Key Infrastructure:</dt>
          <dd id="section-1.2-3.44" style="margin-left: 1.5em"> The collection of systems and
            processes that sustains the activities of a public key system.
            The registrar acts as a "Registration Authority"; see
            <span>[<a class="xref" href="#RFC5280">RFC5280</a>]</span> and <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc5272#section-7">Section 7</a> of [<a class="xref" href="#RFC5272">RFC5272</a>]</span>.<a class="pilcrow" href="#section-1.2-3.44">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.45">TOFU:</dt>
          <dd id="section-1.2-3.46" style="margin-left: 1.5em">Trust on First Use. Used similarly to how it is described in <span>[<a class="xref" href="#RFC7435">RFC7435</a>]</span>. This is where a pledge
            device makes no security decisions but rather simply trusts the
            first registrar it is contacted by. This is also known as the
            "resurrecting duckling" model.<a class="pilcrow" href="#section-1.2-3.46">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.47">Voucher:</dt>
          <dd id="section-1.2-3.48" style="margin-left: 1.5em">A signed artifact from the MASA
            that indicates the cryptographic identity of the
            registrar it should trust to a pledge. There are different types of vouchers
            depending on how that trust is asserted. Multiple voucher types are
            defined in <span>[<a class="xref" href="#RFC8366">RFC8366</a>]</span>.<a class="pilcrow" href="#section-1.2-3.48">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
<section id="section-1.3">
        <h3 id="name-scope-of-solution">
<a class="section-number selfRef" href="#section-1.3">1.3. </a><a class="section-name selfRef" href="#name-scope-of-solution">Scope of Solution</a>
        </h3>
<section id="section-1.3.1">
          <h4 id="name-support-environment">
<a class="section-number selfRef" href="#section-1.3.1">1.3.1. </a><a class="section-name selfRef" href="#name-support-environment">Support Environment</a>
          </h4>
<p id="section-1.3.1-1">
          This solution (BRSKI) can support large router
        platforms with multi-gigabit inter-connections, mounted in controlled
        access data centers. But this solution is not exclusive to large equipment:
        it is intended to scale to thousands of devices located in hostile
        environments, such as ISP-provided Customer Premises Equipment (CPE) devices that are drop-shipped
        to the end user. The situation where an order is fulfilled from a
        distributed warehouse from a common stock and shipped directly to the
        target location at the request of a domain owner is explicitly
        supported. That stock ("SKU") could be provided to a number of
        potential domain owners, and the eventual domain owner will not know
        a priori which device will go to which location.<a class="pilcrow" href="#section-1.3.1-1">¶</a></p>
<p id="section-1.3.1-2">
          The bootstrapping process can take minutes to complete depending on
          the network infrastructure and device processing speed. The network
          communication itself is not optimized for speed; for privacy reasons,
          the discovery process allows for the pledge to avoid announcing its
          presence through broadcasting.<a class="pilcrow" href="#section-1.3.1-2">¶</a></p>
<p id="section-1.3.1-3">
          Nomadic or mobile devices often need to acquire credentials to
          access the network at the new location.  An example of this is
          mobile phone roaming among network operators, or even between
          cell towers.  This is usually called "handoff".
          BRSKI does not provide a low-latency handoff, which is usually a
          requirement in such situations.
          For these solutions, BRSKI can be used to create a relationship
          (an LDevID) with the "home" domain owner. The resulting credentials
          are then used to provide credentials more appropriate for a
          low-latency handoff.<a class="pilcrow" href="#section-1.3.1-3">¶</a></p>
</section>
<section id="section-1.3.2">
          <h4 id="name-constrained-environments">
<a class="section-number selfRef" href="#section-1.3.2">1.3.2. </a><a class="section-name selfRef" href="#name-constrained-environments">Constrained Environments</a>
          </h4>
<p id="section-1.3.2-1">Questions have been posed as to whether this solution is suitable
        in general for Internet of Things (IoT) networks. This depends on the
        capabilities of the devices in question. The terminology of <span>[<a class="xref" href="#RFC7228">RFC7228</a>]</span> is best used to describe the boundaries.<a class="pilcrow" href="#section-1.3.2-1">¶</a></p>
<p id="section-1.3.2-2">The solution described in this document is aimed in general at
        non-constrained (i.e., Class 2+ <span>[<a class="xref" href="#RFC7228">RFC7228</a>]</span>) devices operating on a non-challenged
        network. The entire solution as described here is not intended to be
        usable as is by constrained devices operating on challenged networks
          (such as 802.15.4 Low-Power and Lossy Networks (LLNs)).<a class="pilcrow" href="#section-1.3.2-2">¶</a></p>
<p id="section-1.3.2-3">Specifically, there are protocol aspects described here that might
        result in congestion collapse or energy exhaustion of intermediate
        battery-powered routers in an LLN. Those types of networks should not
        use this solution. These limitations are predominately related to the
        large credential and key sizes required for device authentication.
        Defining symmetric key techniques that meet the operational
        requirements is out of scope, but the underlying protocol operations
        (TLS handshake and signing structures) have sufficient algorithm
          agility to support such techniques when defined.<a class="pilcrow" href="#section-1.3.2-3">¶</a></p>
<p id="section-1.3.2-4">The imprint protocol described here could, however, be used by
        non-energy constrained devices joining a non-constrained network (for
        instance, smart light bulbs are usually mains powered and use
        802.11 wireless technology). It could also be used by non-constrained devices across a
        non-energy constrained, but challenged, network (such as 802.15.4). The
        certificate contents, and the process by which the four
        questions above are resolved, do apply to constrained devices. It is
        simply the actual on-the-wire imprint protocol that could be
        inappropriate.<a class="pilcrow" href="#section-1.3.2-4">¶</a></p>
</section>
<section id="section-1.3.3">
          <h4 id="name-network-access-controls">
<a class="section-number selfRef" href="#section-1.3.3">1.3.3. </a><a class="section-name selfRef" href="#name-network-access-controls">Network Access Controls</a>
          </h4>
<p id="section-1.3.3-1">This document presumes that network access control has
        already occurred, is not required, or is integrated by the proxy
        and registrar in such a way that the device itself does not need to
        be aware of the details. Although the use of an X.509 IDevID is consistent with IEEE 802.1AR <span>[<a class="xref" href="#IDevID">IDevID</a>]</span>, and allows for alignment with 802.1X
        network access control methods, its use here is for pledge
        authentication rather than network access control. Integrating
        this protocol with network access control, perhaps as an
        Extensible Authentication Protocol (EAP) method
        (see <span>[<a class="xref" href="#RFC3748">RFC3748</a>]</span>), is out of scope for this document.<a class="pilcrow" href="#section-1.3.3-1">¶</a></p>
</section>
<section id="section-1.3.4">
          <h4 id="name-bootstrapping-is-not-bootin">
<a class="section-number selfRef" href="#section-1.3.4">1.3.4. </a><a class="section-name selfRef" href="#name-bootstrapping-is-not-bootin">Bootstrapping is Not Booting</a>
          </h4>
<p id="section-1.3.4-1">This document describes "bootstrapping" as the protocol
        used to obtain a local trust anchor. It is expected that this
        trust anchor, along with any additional configuration
        information subsequently installed, is persisted on the device
        across system restarts ("booting"). Bootstrapping occurs only
        infrequently such as when a device is transferred to a new
        owner or has been reset to factory default settings.<a class="pilcrow" href="#section-1.3.4-1">¶</a></p>
</section>
</section>
<div id="PostEnrollment">
<section id="section-1.4">
        <h3 id="name-leveraging-the-new-key-infr">
<a class="section-number selfRef" href="#section-1.4">1.4. </a><a class="section-name selfRef" href="#name-leveraging-the-new-key-infr">Leveraging the New Key Infrastructure / Next Steps</a>
        </h3>
<p id="section-1.4-1">
          As a result of the protocol described herein, bootstrapped devices
          have the domain CA trust anchor in common. An end-entity (EE) certificate has
          optionally been issued from the domain CA. This makes it possible
          to securely deploy functionalities across the domain; for example:<a class="pilcrow" href="#section-1.4-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.4-2.1">Device management<a class="pilcrow" href="#section-1.4-2.1">¶</a>
</li>
          <li class="normal" id="section-1.4-2.2">Routing authentication<a class="pilcrow" href="#section-1.4-2.2">¶</a>
</li>
          <li class="normal" id="section-1.4-2.3">Service discovery<a class="pilcrow" href="#section-1.4-2.3">¶</a>
</li>
        </ul>
<p id="section-1.4-3">
          The major intended benefit is the ability to use the credentials
     deployed by this protocol to secure the
          Autonomic Control Plane (ACP) <span>[<a class="xref" href="#RFC8994">RFC8994</a>]</span>.<a class="pilcrow" href="#section-1.4-3">¶</a></p>
</section>
</div>
<div id="ANIrequirements">
<section id="section-1.5">
        <h3 id="name-requirements-for-autonomic-">
<a class="section-number selfRef" href="#section-1.5">1.5. </a><a class="section-name selfRef" href="#name-requirements-for-autonomic-">Requirements for Autonomic Networking Infrastructure (ANI) Devices</a>
        </h3>
<p id="section-1.5-1">
          The BRSKI protocol can be used in a number of environments. Some of
          the options in this document are the result of requirements that
          are out of the ANI scope.  This section defines the base
          requirements for ANI devices.<a class="pilcrow" href="#section-1.5-1">¶</a></p>
<p id="section-1.5-2">
          For devices that intend to become part of an ANI
          <span>[<a class="xref" href="#RFC8993">RFC8993</a>]</span> that includes an
          Autonomic Control Plane
          <span>[<a class="xref" href="#RFC8994">RFC8994</a>]</span>, the
          BRSKI protocol <span class="bcp14">MUST</span> be implemented.<a class="pilcrow" href="#section-1.5-2">¶</a></p>
<p id="section-1.5-3">
          The pledge must perform discovery of the proxy as described in
          <a class="xref" href="#discovery">Section 4.1</a> using the Discovery Unsolicited
   Link-Local (DULL) <span>[<a class="xref" href="#RFC8990">RFC8990</a>]</span> M_FLOOD announcements of the GeneRic Autonomic Signaling Protocol (GRASP).<a class="pilcrow" href="#section-1.5-3">¶</a></p>
<p id="section-1.5-4">
          Upon successfully validating a voucher artifact, a status telemetry
          <span class="bcp14">MUST</span> be returned; see <a class="xref" href="#pledgestatus">Section 5.7</a>.<a class="pilcrow" href="#section-1.5-4">¶</a></p>
<p id="section-1.5-5">
          An ANIMA ANI pledge <span class="bcp14">MUST</span> implement the EST automation
          extensions described in <a class="xref" href="#ESTintegration">Section 5.9</a>.
          They supplement the EST <span>[<a class="xref" href="#RFC7030">RFC7030</a>]</span> to better
          support automated devices that do not have an end user.<a class="pilcrow" href="#section-1.5-5">¶</a></p>
<p id="section-1.5-6">
          The ANI Join Registrar ASA <span class="bcp14">MUST</span> support all the BRSKI and above-listed EST operations.<a class="pilcrow" href="#section-1.5-6">¶</a></p>
<p id="section-1.5-7">
          All ANI devices <span class="bcp14">SHOULD</span> support the BRSKI proxy function, using
          Circuit Proxies over the Autonomic Control Plane (ACP) (see <a class="xref" href="#JRCgrasp">Section 4.3</a>).<a class="pilcrow" href="#section-1.5-7">¶</a></p>
</section>
</div>
</section>
<section id="section-2">
      <h2 id="name-architectural-overview">
<a class="section-number selfRef" href="#section-2">2. </a><a class="section-name selfRef" href="#name-architectural-overview">Architectural Overview</a>
      </h2>
<p id="section-2-1">The logical elements of the bootstrapping framework are described in
      this section. <a class="xref" href="#architecturefigure">Figure 1</a> provides a simplified overview of the components.<a class="pilcrow" href="#section-2-1">¶</a></p>
<span id="name-architecture-overview"></span><div id="architecturefigure">
<figure id="figure-1">
        <div class="artwork art-text alignLeft" id="section-2-2.1">
<pre>                                           +------------------------+
   +--------------Drop-Ship----------------| Vendor Service         |
   |                                       +------------------------+
   |                                       | M anufacturer|         |
   |                                       | A uthorized  |Ownership|
   |                                       | S igning     |Tracker  |
   |                                       | A uthority   |         |
   |                                       +--------------+---------+
   |                                                      ^
   |                                                      |  BRSKI-
   V                                                      |   MASA
+-------+     ............................................|...
|       |     .                                           |  .
|       |     .  +------------+       +-----------+       |  .
|       |     .  |            |       |           |       |  .
|Pledge |     .  |   Join     |       | Domain    &lt;-------+  .
|       |     .  |   Proxy    |       | Registrar |          .
|       &lt;--------&gt;............&lt;-------&gt; (PKI RA)  |          .
|       |        |        BRSKI-EST   |           |          .
|       |     .  |            |       +-----+-----+          .
|IDevID |     .  +------------+             | e.g., RFC 7030 .
|       |     .           +-----------------+----------+     .
|       |     .           | Key Infrastructure         |     .
|       |     .           | (e.g., PKI CA)             |     .
+-------+     .           |                            |     .
              .           +----------------------------+     .
              .                                              .
              ................................................
                            "Domain" Components
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-1">Figure 1</a>:
<a class="selfRef" href="#name-architecture-overview">Architecture Overview</a>
        </figcaption></figure>
</div>
<p id="section-2-3">We assume a multivendor network. In such an environment, there could
      be a manufacturer service for each manufacturer that supports devices following this
      document's specification, or an integrator could provide a generic
      service authorized by multiple manufacturers. It is unlikely that an
      integrator could provide ownership tracking services for multiple
      manufacturers due to the required sales channel integrations necessary to
      track ownership.<a class="pilcrow" href="#section-2-3">¶</a></p>
<p id="section-2-4">The domain is the managed network infrastructure with a key infrastructure that the pledge is
      joining. The domain provides initial device connectivity
      sufficient for bootstrapping through a proxy. The domain
      registrar authenticates the pledge, makes authorization decisions, and distributes
      vouchers obtained from the manufacturer service. Optionally, the registrar
      also acts as a PKI CA.<a class="pilcrow" href="#section-2-4">¶</a></p>
<section id="section-2.1">
        <h3 id="name-behavior-of-a-pledge">
<a class="section-number selfRef" href="#section-2.1">2.1. </a><a class="section-name selfRef" href="#name-behavior-of-a-pledge">Behavior of a Pledge</a>
        </h3>
<p id="section-2.1-1">The pledge goes through a series of steps, which are outlined here
        at a high level.<a class="pilcrow" href="#section-2.1-1">¶</a></p>
<span id="name-pledge-state-diagram"></span><div id="pledgestatusfigure">
<figure id="figure-2">
          <div class="artwork art-text alignLeft" id="section-2.1-2.1">
<pre>               ------------
              /  Factory   \
              \  default   /
               -----+------
                    |
             +------v-------+
             | (1) Discover |
+------------&gt;              |
|            +------+-------+
|                   |
|            +------v-------+
|            | (2) Identify |
^------------+              |
| rejected   +------+-------+
|                   |
|            +------v-------+
|            | (3) Request  |
|            |     Join     |
|            +------+-------+
|                   |
|            +------v-------+
|            | (4) Imprint  |
^------------+              |
| Bad MASA   +------+-------+
| response          |  send Voucher Status Telemetry
|            +------v-------+
|            | (5) Enroll   |&lt;---+ (non-error HTTP codes)
^------------+              |\___/ (e.g., 202 "Retry-After")
| Enroll     +------+-------+
| failure           |
|              -----v------
|             /  Enrolled  \
^------------+             |
 Factory      \------------/
 reset

</pre>
</div>
<figcaption><a class="selfRef" href="#figure-2">Figure 2</a>:
<a class="selfRef" href="#name-pledge-state-diagram">Pledge State Diagram</a>
          </figcaption></figure>
</div>
<p id="section-2.1-3">State descriptions for the pledge are as follows:<a class="pilcrow" href="#section-2.1-3">¶</a></p>
<ol class="normal type-1" id="section-2.1-4" start="1" type="1">
          <li id="section-2.1-4.1">Discover a communication channel to a registrar.<a class="pilcrow" href="#section-2.1-4.1">¶</a>
</li>
          <li id="section-2.1-4.2">Identify itself. This is done by presenting an X.509 IDevID
                credential to the discovered registrar (via the proxy) in a TLS
                handshake. (The registrar credentials are only provisionally
                accepted at this time.)<a class="pilcrow" href="#section-2.1-4.2">¶</a>
</li>
          <li id="section-2.1-4.3">Request to join the discovered registrar. A unique nonce is
                included, ensuring that any responses can be associated with this
                particular bootstrapping attempt.<a class="pilcrow" href="#section-2.1-4.3">¶</a>
</li>
          <li id="section-2.1-4.4">Imprint on the registrar. This requires verification of the
                manufacturer-service-provided voucher. A voucher contains sufficient
                information for the pledge to complete authentication of a
                registrar.  This document details this step in depth.<a class="pilcrow" href="#section-2.1-4.4">¶</a>
</li>
          <li id="section-2.1-4.5">Enroll. After imprint, an authenticated TLS (HTTPS) connection exists
            between the pledge and registrar.
            EST <span>[<a class="xref" href="#RFC7030">RFC7030</a>]</span> can then be used to obtain a domain
            certificate from a registrar.<a class="pilcrow" href="#section-2.1-4.5">¶</a>
</li>
        </ol>
<p id="section-2.1-5">
          The pledge is now a member of, and can be managed by, the
          domain and will only repeat the discovery aspects of bootstrapping
          if it is returned to factory default settings.<a class="pilcrow" href="#section-2.1-5">¶</a></p>
<p id="section-2.1-6">
          This specification details integration with EST enrollment so that pledges can
          optionally obtain a locally issued certificate, although any
          Representational State Transfer (REST) (see <span>[<a class="xref" href="#REST">REST</a>]</span>)
          interface could be integrated in future work.<a class="pilcrow" href="#section-2.1-6">¶</a></p>
</section>
<section id="section-2.2">
        <h3 id="name-secure-imprinting-using-vou">
<a class="section-number selfRef" href="#section-2.2">2.2. </a><a class="section-name selfRef" href="#name-secure-imprinting-using-vou">Secure Imprinting Using Vouchers</a>
        </h3>
<p id="section-2.2-1">A voucher is a cryptographically protected artifact (using a digital signature) to the pledge
        device authorizing a zero-touch imprint on the registrar
        domain.<a class="pilcrow" href="#section-2.2-1">¶</a></p>
<p id="section-2.2-2">The format and cryptographic mechanism of vouchers is described in
        detail in <span>[<a class="xref" href="#RFC8366">RFC8366</a>]</span>.<a class="pilcrow" href="#section-2.2-2">¶</a></p>
<p id="section-2.2-3">Vouchers provide a flexible mechanism to secure imprinting: the
        pledge device only imprints when a voucher can be validated.
        At the lowest security levels, the MASA can indiscriminately issue
        vouchers and log claims of ownership by domains.  At the highest security
        levels, issuance of vouchers can be integrated with complex sales channel
        integrations that are beyond the scope of this document. The sales
        channel integration would verify actual (legal) ownership of the
        pledge by the domain.
            This
            provides the flexibility for a number of use cases via a single
            common protocol mechanism on the pledge and registrar devices that
            are to be widely deployed in the field. The MASA services have
            the flexibility to either leverage the currently defined claim
            mechanisms or experiment with higher or lower security levels.<a class="pilcrow" href="#section-2.2-3">¶</a></p>
<p id="section-2.2-4">
          Vouchers provide a signed but non-encrypted communication channel among
          the pledge, the MASA, and the registrar. The registrar maintains
          control over the transport and policy decisions, allowing the
          local security policy of the domain network to be enforced.<a class="pilcrow" href="#section-2.2-4">¶</a></p>
</section>
<div id="IDevIDextension">
<section id="section-2.3">
        <h3 id="name-initial-device-identifier">
<a class="section-number selfRef" href="#section-2.3">2.3. </a><a class="section-name selfRef" href="#name-initial-device-identifier">Initial Device Identifier</a>
        </h3>
<p id="section-2.3-1">
          Pledge authentication and pledge voucher-request signing is via
          a PKIX-shaped certificate installed
          during the manufacturing process. This is the 802.1AR
          IDevID, and it
          provides a basis for authenticating the pledge during
          the protocol exchanges described here.
          There is no requirement for a common root PKI hierarchy.
          Each device manufacturer can generate its own root certificate.
          Specifically, the IDevID enables:<a class="pilcrow" href="#section-2.3-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.3-2.1">
              Uniquely identifying the pledge by the Distinguished Name (DN)
              and subjectAltName (SAN) parameters in the IDevID. The
              unique identification of a pledge in the voucher objects are derived
              from those parameters as described below. <a class="xref" href="#idevidprivacy">Section 10.3</a> discusses privacy implications of the identifier.<a class="pilcrow" href="#section-2.3-2.1">¶</a>
</li>
          <li class="normal" id="section-2.3-2.2">
              Providing a cryptographic authentication of the pledge to the
              registrar (see <a class="xref" href="#pledgeauthorization">Section 5.3</a>).<a class="pilcrow" href="#section-2.3-2.2">¶</a>
</li>
          <li class="normal" id="section-2.3-2.3">
              Securing auto-discovery of the pledge's MASA by the registrar
              (see <a class="xref" href="#obtainmasaurl">Section 2.8</a>).<a class="pilcrow" href="#section-2.3-2.3">¶</a>
</li>
          <li class="normal" id="section-2.3-2.4">
              Signing of a voucher-request by the pledge's IDevID
              (see <a class="xref" href="#voucher-request">Section 3</a>).<a class="pilcrow" href="#section-2.3-2.4">¶</a>
</li>
          <li class="normal" id="section-2.3-2.5">
              Providing a cryptographic authentication of the pledge to the
              MASA (see <a class="xref" href="#MASAassertion">Section 5.5.5</a>).<a class="pilcrow" href="#section-2.3-2.5">¶</a>
</li>
        </ul>
<p id="section-2.3-3">
          Sections 7.2.13 (2009 edition) and 8.10.3 (2018 edition) of
          <span>[<a class="xref" href="#IDevID">IDevID</a>]</span> discuss keyUsage and
          extendedKeyUsage extensions in the IDevID certificate.
          <span>[<a class="xref" href="#IDevID">IDevID</a>]</span> acknowledges that adding restrictions
          in the certificate limits applicability of these long-lived
          certificates.  This specification emphasizes this point and
          therefore RECOMMENDS that no key usage restrictions be included.
          This is consistent with <span>[<a class="xref" href="#RFC5280">RFC5280</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc5280#section-4.2.1.3">Section 4.2.1.3</a></span>,
          which does not
          require key usage restrictions for end-entity certificates.<a class="pilcrow" href="#section-2.3-3">¶</a></p>
<div id="PledgeIdentification">
<section id="section-2.3.1">
          <h4 id="name-identification-of-the-pledg">
<a class="section-number selfRef" href="#section-2.3.1">2.3.1. </a><a class="section-name selfRef" href="#name-identification-of-the-pledg">Identification of the Pledge</a>
          </h4>
<p id="section-2.3.1-1">

            In the context of BRSKI, pledges have a 1:1 relationship
            with a "serial-number".
            This serial-number is used both in the serial-number
            field of a voucher or voucher-requests (see <a class="xref" href="#voucher-request">Section 3</a>)
            and in local policies on the registrar or MASA
            (see <a class="xref" href="#ProtocolDetails">Section 5</a>).<a class="pilcrow" href="#section-2.3.1-1">¶</a></p>
<p id="section-2.3.1-2">
   There is a (certificate) serialNumber field defined in <span>[<a class="xref" href="#RFC5280">RFC5280</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc5280#section-4.1.2.2">Section 4.1.2.2</a></span>.  In ASN.1, this is referred to as the
   CertificateSerialNumber.  This field is NOT relevant to this
   specification.  Do not confuse this field with the serial-number
   defined by this document, or by <span>[<a class="xref" href="#IDevID">IDevID</a>]</span> and <span>[<a class="xref" href="#RFC4519">RFC4519</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc4519#section-2.31">Section 2.31</a></span>.<a class="pilcrow" href="#section-2.3.1-2">¶</a></p>
<p id="section-2.3.1-3">
The device serial number is defined in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc5280#appendix-A.1">Appendix A.1</a> of [<a class="xref" href="#RFC5280">RFC5280</a>]</span> as the X520SerialNumber, with the OID tag id-at-serialNumber.<a class="pilcrow" href="#section-2.3.1-3">¶</a></p>
<p id="section-2.3.1-4">
   The device <em>serialNumber</em> field (X520SerialNumber) is used as follows
   by the pledge to build the <strong>serial-number</strong> that is placed in the
   voucher-request.  In order to build it, the fields need to be
   converted into a serial-number of "type string".<a class="pilcrow" href="#section-2.3.1-4">¶</a></p>
<p id="section-2.3.1-5">
            An example of a printable form of the serialNumber field
            is provided in <span>[<a class="xref" href="#RFC4519">RFC4519</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc4519#section-2.31">Section 2.31</a></span> ("WI-3005").
            That section further provides equality and syntax attributes.<a class="pilcrow" href="#section-2.3.1-5">¶</a></p>
<p id="section-2.3.1-6">
            Due to the reality of existing device identity provisioning
            processes, some
            manufacturers have stored serial-numbers in other
            fields.
     Registrars <span class="bcp14">SHOULD</span> be configurable, on a per-manufacturer
            basis, to look for serial-number equivalents in other fields.<a class="pilcrow" href="#section-2.3.1-6">¶</a></p>
<p id="section-2.3.1-7">
            As explained in <a class="xref" href="#RequestVoucherFromMASA">Section 5.5</a>, the registrar <span class="bcp14">MUST</span> again extract the
            serialNumber itself from the pledge's TLS certificate.  It
            can consult the serial-number in the pledge request if there is
            any possible confusion about the source of the serial-number.<a class="pilcrow" href="#section-2.3.1-7">¶</a></p>
</section>
</div>
<div id="MASAURL">
<section id="section-2.3.2">
          <h4 id="name-masa-uri-extension">
<a class="section-number selfRef" href="#section-2.3.2">2.3.2. </a><a class="section-name selfRef" href="#name-masa-uri-extension">MASA URI Extension</a>
          </h4>
<p id="section-2.3.2-1">
            This document defines a new PKIX non-critical certificate
            extension to carry the MASA URI.
            This extension is intended to be used in the IDevID certificate.
            The URI is represented as described in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc5280#section-7.4">Section 7.4</a> of [<a class="xref" href="#RFC5280">RFC5280</a>]</span>.<a class="pilcrow" href="#section-2.3.2-1">¶</a></p>
<p id="section-2.3.2-2">
            The URI provides the authority information.
            The BRSKI "/.well-known" tree <span>[<a class="xref" href="#RFC8615">RFC8615</a>]</span> is
            described in <a class="xref" href="#ProtocolDetails">Section 5</a>.<a class="pilcrow" href="#section-2.3.2-2">¶</a></p>
<p id="section-2.3.2-3">
            A complete URI <span class="bcp14">MAY</span> be in this extension, including the "scheme", "authority", and "path".
            The complete URI will typically be used in diagnostic or
            experimental situations.


            Typically (and in consideration to constrained systems), this
            <span class="bcp14">SHOULD</span> be reduced to only the "authority", in which
            case a scheme of "https://"
            (see <span>[<a class="xref" href="#RFC7230">RFC7230</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc7230#section-2.7.3">Section 2.7.3</a></span>)
            and a "path" of "/.well-known/brski" is to be
            assumed.<a class="pilcrow" href="#section-2.3.2-3">¶</a></p>
<p id="section-2.3.2-4">
            The registrar can assume that only the "authority" is present in
            the extension, if there are no slash ("/") characters in the
            extension.<a class="pilcrow" href="#section-2.3.2-4">¶</a></p>
<p id="section-2.3.2-5">
            <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc5280#section-7.4">Section 7.4</a> of [<a class="xref" href="#RFC5280">RFC5280</a>]</span> calls out various
            schemes that <span class="bcp14">MUST</span> be supported, including the Lightweight Directory Access Protocol (LDAP), HTTP, and FTP.
            However, the registrar <span class="bcp14">MUST</span> use HTTPS for the BRSKI-MASA connection.<a class="pilcrow" href="#section-2.3.2-5">¶</a></p>
<p id="section-2.3.2-6">The new extension is identified as follows:<a class="pilcrow" href="#section-2.3.2-6">¶</a></p>
<span id="name-masaurl-asn1-module"></span><div id="masaurlmodule">
<figure id="figure-3">
            <div id="section-2.3.2-7.1">
<pre class="sourcecode lang-asn.1">&lt;CODE BEGINS&gt;
MASAURLExtnModule-2016 { iso(1) identified-organization(3) dod(6)
internet(1) security(5) mechanisms(5) pkix(7)
id-mod(0) id-mod-MASAURLExtn2016(96) }

DEFINITIONS IMPLICIT TAGS ::= BEGIN

-- EXPORTS ALL --

IMPORTS
EXTENSION
FROM PKIX-CommonTypes-2009
  { iso(1) identified-organization(3) dod(6) internet(1)
    security(5) mechanisms(5) pkix(7) id-mod(0)
    id-mod-pkixCommon-02(57) }

id-pe FROM PKIX1Explicit-2009
  { iso(1) identified-organization(3) dod(6) internet(1)
     security(5) mechanisms(5) pkix(7) id-mod(0)
     id-mod-pkix1-explicit-02(51) } ;

MASACertExtensions EXTENSION ::= { ext-MASAURL, ... }
ext-MASAURL EXTENSION ::= { SYNTAX MASAURLSyntax
IDENTIFIED BY id-pe-masa-url }

id-pe-masa-url OBJECT IDENTIFIER ::= { id-pe 32 }

MASAURLSyntax ::= IA5String

END


&lt;CODE ENDS&gt;</pre>
</div>
<figcaption><a class="selfRef" href="#figure-3">Figure 3</a>:
<a class="selfRef" href="#name-masaurl-asn1-module">MASAURL ASN.1 Module</a>
            </figcaption></figure>
</div>
<p id="section-2.3.2-8">The choice of id-pe is based on guidance found in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc5280#section-4.2.2">Section 4.2.2</a> of [<a class="xref" href="#RFC5280">RFC5280</a>]</span>: "These extensions may
be used to direct applications to on-line
          information about the issuer or the subject". The MASA URL is precisely
          that: online information about the particular subject.<a class="pilcrow" href="#section-2.3.2-8">¶</a></p>
</section>
</div>
</section>
</div>
<div id="flow">
<section id="section-2.4">
        <h3 id="name-protocol-flow">
<a class="section-number selfRef" href="#section-2.4">2.4. </a><a class="section-name selfRef" href="#name-protocol-flow">Protocol Flow</a>
        </h3>
<p id="section-2.4-1">A representative flow is shown in
        <a class="xref" href="#protocoltimesequencefigure">Figure 4</a>.<a class="pilcrow" href="#section-2.4-1">¶</a></p>
<span id="name-protocol-time-sequence-diag"></span><div id="protocoltimesequencefigure">
<figure id="figure-4">
          <div class="artwork art-text alignLeft" id="section-2.4-2.1">
<pre>+--------+         +---------+    +------------+     +------------+
| Pledge |         | Circuit |    | Domain     |     | Vendor     |
|        |         | Join    |    | Registrar  |     | Service    |
|        |         | Proxy   |    |  (JRC)     |     | (MASA)     |
+--------+         +---------+    +------------+     +------------+
  |                     |                   |           Internet |
[discover]              |                   |                    |
  |&lt;-RFC 4862 IPv6 addr |                   |                    |
  |&lt;-RFC 3927 IPv4 addr | Appendix A        |  Legend            |
  |-++++++++++++++++++-&gt;|                   | C - Circuit        |
  | optional: mDNS query| Appendix B        |     Join Proxy     |
  | RFCs 6763/6762 (+)  |                   | P - Provisional TLS|
  |&lt;-++++++++++++++++++-|                   |     Connection     |
  | GRASP M_FLOOD       |                   |                    |
  |   periodic broadcast|                   |                    |
[identity]              |                   |                    |
  |&lt;-------------------&gt;C&lt;-----------------&gt;|                    |
  |         TLS via the Join Proxy          |                    |
  |&lt;--Registrar TLS server authentication---|                    |
[PROVISIONAL accept of server cert]         |                    |
  P---X.509 client authentication----------&gt;|                    |
[request join]                              |                    |
  P---Voucher-Request(w/nonce for voucher)-&gt;|                    |
  P                  /-------------------   |                    |
  P                  |                 [accept device?]          |
  P                  |                 [contact vendor]          |
  P                  |                      |--Pledge ID--------&gt;|
  P                  |                      |--Domain ID--------&gt;|
  P                  |                      |--optional:nonce---&gt;|
  P              optional:                  |     [extract DomainID]
  P        can occur in advance             |     [update audit-log]
  P            if nonceless                 |                    |
  P                  |                      |&lt;- voucher ---------|
  P                  \-------------------   | w/nonce if provided|
  P&lt;------voucher---------------------------|                    |
[imprint]                                   |                    |
  |-------voucher status telemetry---------&gt;|                    |
  |                                         |&lt;-device audit-log--|
  |                             [verify audit-log and voucher]   |
  |&lt;---------------------------------------&gt;|                    |
[enroll]                                    |                    |
  | Continue with enrollment using now      |                    |
  | bidirectionally authenticated TLS       |                    |
  | session per RFC 7030.                   |                    |
[enrolled]                                  |                    |
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-4">Figure 4</a>:
<a class="selfRef" href="#name-protocol-time-sequence-diag">Protocol Time Sequence Diagram</a>
          </figcaption></figure>
</div>
<p id="section-2.4-3">
          On initial bootstrap, a new device (the pledge) uses a local service
          auto-discovery (the GeneRic Autonomic Signaling Protocol (GRASP) or Multicast DNS (mDNS)) to locate a Join Proxy.  The
          Join Proxy connects the pledge to a local registrar (the JRC).<a class="pilcrow" href="#section-2.4-3">¶</a></p>
<p id="section-2.4-4">
          Having found a candidate registrar, the fledgling pledge sends
          some information about itself to the registrar, including its
          serial number in the form of a voucher-request and its
          IDevID certificate as part of the TLS session.<a class="pilcrow" href="#section-2.4-4">¶</a></p>
<p id="section-2.4-5">
          The registrar can determine whether it expected such a device to
          appear and locates a MASA.  The location of the MASA is usually found in
          an extension in the IDevID.  Having determined that the MASA is
          suitable, the entire information from the initial voucher-request
          (including the device's serial number) is transmitted over the Internet in a
          TLS-protected channel to the manufacturer, along with information about
          the registrar/owner.<a class="pilcrow" href="#section-2.4-5">¶</a></p>
<p id="section-2.4-6">
          The manufacturer can then apply policy based on the provided
          information, as well as other sources of information (such as sales
          records), to decide whether
          to approve the claim  by the registrar to own the device; if the claim
          is accepted, a voucher is issued that directs the device to accept its
          new owner.<a class="pilcrow" href="#section-2.4-6">¶</a></p>
<p id="section-2.4-7">
          The voucher is returned to the registrar, but not immediately to
          the device -- the registrar has an opportunity to examine the
          voucher, the MASA's audit-logs, and other sources of information to
          determine whether the device has been tampered with and whether
          the bootstrap should be accepted.<a class="pilcrow" href="#section-2.4-7">¶</a></p>
<p id="section-2.4-8">
          No filtering of information is possible in the signed voucher, so
          this is a binary yes-or-no decision.  After the registrar has applied any local policy to the voucher, if it accepts the voucher, then the voucher is returned to the pledge for imprinting.<a class="pilcrow" href="#section-2.4-8">¶</a></p>
<p id="section-2.4-9">
          The voucher also includes a trust anchor that the pledge uses to
          represent the owner.
   This is used to successfully bootstrap from an environment
          where only the manufacturer has built-in trust by the
          device to an environment where the owner now has a PKI footprint on the
          device.<a class="pilcrow" href="#section-2.4-9">¶</a></p>
<p id="section-2.4-10">
          When BRSKI is followed with EST, this single footprint is further
          leveraged into the full owner's PKI and an LDevID for the
          device. Subsequent reporting steps provide flows of  information to
          indicate success/failure of the process.<a class="pilcrow" href="#section-2.4-10">¶</a></p>
</section>
</div>
<section id="section-2.5">
        <h3 id="name-architectural-components">
<a class="section-number selfRef" href="#section-2.5">2.5. </a><a class="section-name selfRef" href="#name-architectural-components">Architectural Components</a>
        </h3>
<div id="pledge-overview">
<section id="section-2.5.1">
          <h4 id="name-pledge">
<a class="section-number selfRef" href="#section-2.5.1">2.5.1. </a><a class="section-name selfRef" href="#name-pledge">Pledge</a>
          </h4>
<p id="section-2.5.1-1">
            The pledge is the device that is attempting to join. It is assumed that
            the pledge talks to the Join Proxy using link-local network
            connectivity.  In most cases, the pledge has no other
            connectivity until the pledge completes the enrollment process
            and receives some kind of network credential.<a class="pilcrow" href="#section-2.5.1-1">¶</a></p>
</section>
</div>
<div id="proxy-overview">
<section id="section-2.5.2">
          <h4 id="name-join-proxy">
<a class="section-number selfRef" href="#section-2.5.2">2.5.2. </a><a class="section-name selfRef" href="#name-join-proxy">Join Proxy</a>
          </h4>
<p id="section-2.5.2-1">
            The Join Proxy provides HTTPS connectivity between the
            pledge and the registrar. A Circuit Proxy mechanism is
            described in <a class="xref" href="#proxydetails">Section 4</a>. Additional
            mechanisms, including a Constrained Application Protocol (CoAP) mechanism and a stateless
            IP in IP (IPIP) mechanism, are the subject of future work.<a class="pilcrow" href="#section-2.5.2-1">¶</a></p>
</section>
</div>
<div id="registrar-overview">
<section id="section-2.5.3">
          <h4 id="name-domain-registrar">
<a class="section-number selfRef" href="#section-2.5.3">2.5.3. </a><a class="section-name selfRef" href="#name-domain-registrar">Domain Registrar</a>
          </h4>
<p id="section-2.5.3-1">
            The domain's registrar operates as the BRSKI-MASA client when
            requesting vouchers from the MASA (see <a class="xref" href="#brskimasatls">Section 5.4</a>). The registrar
            operates as the BRSKI-EST server when pledges request
            vouchers (see <a class="xref" href="#brskiesttls">Section 5.1</a>). The registrar operates as the BRSKI-EST server
            "Registration Authority" if the pledge requests an end-entity certificate
          over the BRSKI-EST connection (see <a class="xref" href="#ESTintegration">Section 5.9</a>).<a class="pilcrow" href="#section-2.5.3-1">¶</a></p>
<p id="section-2.5.3-2">
            The registrar uses an Implicit Trust Anchor database for
            authenticating the BRSKI-MASA connection's MASA TLS server certificate.
            Configuration or distribution of trust anchors is out of scope
            for this specification.<a class="pilcrow" href="#section-2.5.3-2">¶</a></p>
<p id="section-2.5.3-3">
            The registrar uses a different Implicit Trust Anchor database for
            authenticating the BRSKI-EST connection's pledge TLS Client Certificate.
            Configuration or distribution of the BRSKI-EST client trust
            anchors is out of scope of this specification.  Note that the
            trust anchors
            in / excluded from the database will affect which manufacturers' devices are
            acceptable to the registrar as pledges, and they can also be used to limit the
            set of MASAs that are trusted for enrollment.<a class="pilcrow" href="#section-2.5.3-3">¶</a></p>
</section>
</div>
<div id="masa-overview">
<section id="section-2.5.4">
          <h4 id="name-manufacturer-service">
<a class="section-number selfRef" href="#section-2.5.4">2.5.4. </a><a class="section-name selfRef" href="#name-manufacturer-service">Manufacturer Service</a>
          </h4>
<p id="section-2.5.4-1">
            The manufacturer service provides two logically separate functions:
            the MASA as described in Sections
            <a class="xref" href="#RequestVoucherFromMASA">5.5</a> and
            <a class="xref" href="#VoucherResponse">5.6</a>
            and an ownership tracking/auditing function as described
            in Sections <a class="xref" href="#pledgestatus">5.7</a>
            and <a class="xref" href="#authzLogRequest">5.8</a>.<a class="pilcrow" href="#section-2.5.4-1">¶</a></p>
</section>
</div>
<div id="pki-overview">
<section id="section-2.5.5">
          <h4 id="name-public-key-infrastructure-p">
<a class="section-number selfRef" href="#section-2.5.5">2.5.5. </a><a class="section-name selfRef" href="#name-public-key-infrastructure-p">Public Key Infrastructure (PKI)</a>
          </h4>
<p id="section-2.5.5-1">
            The Public Key Infrastructure (PKI) administers certificates for the
            domain of concern, providing the trust anchor(s) for it and
            allowing enrollment of pledges with domain certificates.<a class="pilcrow" href="#section-2.5.5-1">¶</a></p>
<p id="section-2.5.5-2">
            The voucher provides a method for the distribution of a
            single PKI trust anchor (as the "pinned-domain-cert"). A distribution
            of the full set of current trust anchors is possible using the
            optional EST integration.<a class="pilcrow" href="#section-2.5.5-2">¶</a></p>
<p id="section-2.5.5-3">
            The domain's registrar acts as a
            Registration Authority <span>[<a class="xref" href="#RFC5272">RFC5272</a>]</span>, requesting certificates for pledges from
            the PKI.<a class="pilcrow" href="#section-2.5.5-3">¶</a></p>
<p id="section-2.5.5-4">
            The expectations of the PKI are unchanged from EST <span>[<a class="xref" href="#RFC7030">RFC7030</a>]</span>.  This document does
            not place any additional architectural requirements on the PKI.<a class="pilcrow" href="#section-2.5.5-4">¶</a></p>
</section>
</div>
</section>
<div id="certificatevalidaty">
<section id="section-2.6">
        <h3 id="name-certificate-time-validation">
<a class="section-number selfRef" href="#section-2.6">2.6. </a><a class="section-name selfRef" href="#name-certificate-time-validation">Certificate Time Validation</a>
        </h3>
<div id="timeunknown">
<section id="section-2.6.1">
          <h4 id="name-lack-of-real-time-clock">
<a class="section-number selfRef" href="#section-2.6.1">2.6.1. </a><a class="section-name selfRef" href="#name-lack-of-real-time-clock">Lack of Real-Time Clock</a>
          </h4>
<p id="section-2.6.1-1">
            When bootstrapping, many devices do not have knowledge of the
            current time. Mechanisms such as Network Time Protocols cannot be
            secured until bootstrapping is complete. Therefore, bootstrapping is
            defined with a framework that does not require knowledge of the current
            time.  A pledge <span class="bcp14">MAY</span> ignore all time stamps in the voucher and
            in the certificate validity periods if it does not know
            the current time.<a class="pilcrow" href="#section-2.6.1-1">¶</a></p>
<p id="section-2.6.1-2">
            The pledge is exposed to dates in the following five places:
            registrar certificate notBefore, registrar certificate
            notAfter,
            voucher created-on, and voucher expires-on.
            Additionally, Cryptographic Message Syntax (CMS) signatures contain a signingTime.<a class="pilcrow" href="#section-2.6.1-2">¶</a></p>
<p id="section-2.6.1-3">
            A pledge with a real-time clock in which it has confidence
            <span class="bcp14">MUST</span> check the above time fields in all certificates and
            signatures that it processes.<a class="pilcrow" href="#section-2.6.1-3">¶</a></p>
<p id="section-2.6.1-4">
            If the voucher contains a nonce,
            then the pledge <span class="bcp14">MUST</span> confirm the nonce matches the original
            pledge voucher-request. This ensures the voucher is fresh.
            See <a class="xref" href="#RequestVoucherFromRegistrar">Section 5.2</a>.<a class="pilcrow" href="#section-2.6.1-4">¶</a></p>
</section>
</div>
<div id="infinitelifetime">
<section id="section-2.6.2">
          <h4 id="name-infinite-lifetime-of-idevid">
<a class="section-number selfRef" href="#section-2.6.2">2.6.2. </a><a class="section-name selfRef" href="#name-infinite-lifetime-of-idevid">Infinite Lifetime of IDevID</a>
          </h4>
<p id="section-2.6.2-1">
            Long-lived pledge certificates "<span class="bcp14">SHOULD</span> be assigned the
            GeneralizedTime value of 99991231235959Z" for the notAfter field as explained in <span>[<a class="xref" href="#RFC5280">RFC5280</a>]</span>.<a class="pilcrow" href="#section-2.6.2-1">¶</a></p>
<p id="section-2.6.2-2">
            Some deployed IDevID management systems are not compliant
            with the 802.1AR requirement for infinite lifetimes and
            are put in typical &lt;= 3 year certificate lifetimes.
            Registrars <span class="bcp14">SHOULD</span> be configurable on a per-manufacturer basis
            to ignore pledge lifetimes when the pledge does not follow the recommendations in <span>[<a class="xref" href="#RFC5280">RFC5280</a>]</span>.<a class="pilcrow" href="#section-2.6.2-2">¶</a></p>
</section>
</div>
</section>
</div>
<div id="cloudregistrar">
<section id="section-2.7">
        <h3 id="name-cloud-registrar">
<a class="section-number selfRef" href="#section-2.7">2.7. </a><a class="section-name selfRef" href="#name-cloud-registrar">Cloud Registrar</a>
        </h3>
<p id="section-2.7-1">
          There exist operationally open networks wherein devices gain
          unauthenticated access to the Internet at large.
          In these use cases, the
          management domain for the device needs to be discovered within the
          larger Internet. The case where a device can boot and get access to
          a larger Internet is less likely within the ANIMA ACP scope but may
          be more important in the future.  In the ANIMA ACP scope, new
          devices will be quarantined behind a Join Proxy.<a class="pilcrow" href="#section-2.7-1">¶</a></p>
<p id="section-2.7-2">
          Additionally, there are some greenfield situations involving an
          entirely new installation where a device may have some kind of
          management uplink that it can use (such as via a 3G network, for
          instance).   In such a future situation, the device might use
          this management interface to learn that it should
          configure itself to become the local registrar.<a class="pilcrow" href="#section-2.7-2">¶</a></p>
<p id="section-2.7-3">
          In order to support these scenarios, the pledge <span class="bcp14">MAY</span> contact a well-known
          URI of a cloud registrar if a
              local registrar cannot be discovered or if the pledge's target use
              cases do not include a local registrar.<a class="pilcrow" href="#section-2.7-3">¶</a></p>
<p id="section-2.7-4">If the pledge uses a well-known URI for contacting a cloud registrar,
              a manufacturer-assigned Implicit Trust Anchor database (see <span>[<a class="xref" href="#RFC7030">RFC7030</a>]</span>) <span class="bcp14">MUST</span>
              be used to authenticate that service as described in <span>[<a class="xref" href="#RFC6125">RFC6125</a>]</span>.  The use of a DNS-ID for validation is
              appropriate, and it may include wildcard components on the
              left-mode side. This is
              consistent with the human-user configuration of an EST server URI in
              <span>[<a class="xref" href="#RFC7030">RFC7030</a>]</span>, which also depends on
<span>[<a class="xref" href="#RFC6125">RFC6125</a>]</span>.<a class="pilcrow" href="#section-2.7-4">¶</a></p>
</section>
</div>
<div id="obtainmasaurl">
<section id="section-2.8">
        <h3 id="name-determining-the-masa-to-con">
<a class="section-number selfRef" href="#section-2.8">2.8. </a><a class="section-name selfRef" href="#name-determining-the-masa-to-con">Determining the MASA to Contact</a>
        </h3>
<p id="section-2.8-1">
The registrar needs to be able to contact a MASA that is trusted by the pledge in order to obtain vouchers.<a class="pilcrow" href="#section-2.8-1">¶</a></p>
<p id="section-2.8-2">The device's IDevID will normally contain the MASA URL as detailed in <a class="xref" href="#IDevIDextension">Section 2.3</a>. This is the <span class="bcp14">RECOMMENDED</span>
        mechanism.<a class="pilcrow" href="#section-2.8-2">¶</a></p>
<p id="section-2.8-3">In some cases, it can be operationally difficult to ensure the necessary X.509 extensions are in the pledge's IDevID due to the difficulty of aligning current pledge manufacturing with software releases and development; thus, as a final fallback, the registrar <span class="bcp14">MAY</span> be manually configured or distributed with a MASA URL for each manufacturer. Note that the registrar can only select the configured MASA URL based on the trust anchor -- so manufacturers can only leverage this approach if they ensure a single MASA URL works for all pledges associated with each trust anchor.<a class="pilcrow" href="#section-2.8-3">¶</a></p>
</section>
</div>
</section>
<div id="voucher-request">
<section id="section-3">
      <h2 id="name-voucher-request-artifact">
<a class="section-number selfRef" href="#section-3">3. </a><a class="section-name selfRef" href="#name-voucher-request-artifact">Voucher-Request Artifact</a>
      </h2>
<p id="section-3-1">
        Voucher-requests are how vouchers are requested.
        The semantics of the voucher-request are described below, in the YANG module.<a class="pilcrow" href="#section-3-1">¶</a></p>
<p id="section-3-2">
        A pledge forms the "pledge voucher-request", signs it with its
        IDevID, and submits it to the registrar.<a class="pilcrow" href="#section-3-2">¶</a></p>
<p id="section-3-3">
        In turn, the registrar forms the "registrar voucher-request",
        signs it with its registrar key pair, and submits it to the MASA.<a class="pilcrow" href="#section-3-3">¶</a></p>
<p id="section-3-4">
        The "proximity-registrar-cert" leaf is used in the pledge
        voucher-requests. This provides a method for the pledge to
        assert the registrar's proximity.<a class="pilcrow" href="#section-3-4">¶</a></p>
<p id="section-3-5">
        This network proximity results from the following properties in the
        ACP context:  the pledge is connected to the Join Proxy
        (<a class="xref" href="#proxydetails">Section 4</a>) using a link-local IPv6 connection.
        While the Join Proxy does not participate in any meaningful sense in
        the cryptography of the TLS connection (such as via a Channel
        Binding), the registrar can observe that the connection is via the
        private ACP (ULA) address of the Join Proxy, and it cannot come from
        outside the ACP.  The pledge must therefore be at most one IPv6
        link-local hop away from an existing node on the ACP.<a class="pilcrow" href="#section-3-5">¶</a></p>
<p id="section-3-6">
        Other users of BRSKI will need to define other kinds of assertions if
        the network proximity described above does not match their needs.<a class="pilcrow" href="#section-3-6">¶</a></p>
<p id="section-3-7">
        The "prior-signed-voucher-request" leaf is used in registrar
        voucher-requests. If present, it is the signed pledge voucher-request
        artifact. This provides a method for
        the registrar to forward the pledge's signed request to the
        MASA. This completes transmission of the signed
        proximity-registrar-cert leaf.<a class="pilcrow" href="#section-3-7">¶</a></p>
<p id="section-3-8">
        Unless otherwise signaled (outside the voucher-request artifact), the
        signing structure is as defined for vouchers; see
        <span>[<a class="xref" href="#RFC8366">RFC8366</a>]</span>.<a class="pilcrow" href="#section-3-8">¶</a></p>
<div id="noncelessVoucherRequest">
<section id="section-3.1">
        <h3 id="name-nonceless-voucher-requests">
<a class="section-number selfRef" href="#section-3.1">3.1. </a><a class="section-name selfRef" href="#name-nonceless-voucher-requests">Nonceless Voucher-Requests</a>
        </h3>
<p id="section-3.1-1">
            A registrar <span class="bcp14">MAY</span> also retrieve nonceless vouchers by sending
            nonceless voucher-requests to the MASA in order to obtain
            vouchers for use when the registrar does not have connectivity to the
            MASA.
            No prior-signed-voucher-request leaf
            would be included.  The registrar will also need to know the serial number of
            the pledge. This document does not provide a mechanism for the
            registrar to learn that in an automated fashion. Typically, this will
            be done via the scanning of a bar code or QR code on packaging, or via
            some sales channel integration.<a class="pilcrow" href="#section-3.1-1">¶</a></p>
</section>
</div>
<div id="voucher-request-tree-diagram">
<section id="section-3.2">
        <h3 id="name-tree-diagram">
<a class="section-number selfRef" href="#section-3.2">3.2. </a><a class="section-name selfRef" href="#name-tree-diagram">Tree Diagram</a>
        </h3>
<p id="section-3.2-1">The following tree diagram illustrates a high-level view of a
                voucher-request document.  The voucher-request builds upon
                the voucher artifact described in <span>[<a class="xref" href="#RFC8366">RFC8366</a>]</span>.
                The tree diagram is described in <span>[<a class="xref" href="#RFC8340">RFC8340</a>]</span>.
                Each node in the diagram is
                fully described by the YANG module in <a class="xref" href="#voucher-request-yang-module">Section 3.4</a>.
                Please review the YANG module for a detailed description of the
                voucher-request format.<a class="pilcrow" href="#section-3.2-1">¶</a></p>
<span id="name-yang-tree-diagram-for-a-vou"></span><div id="voucherrequest_tree">
<figure id="figure-5">
          <div class="artwork art-text alignLeft art-yangtree" id="section-3.2-2.1">
<pre>module: ietf-voucher-request

 grouping voucher-request-grouping
  +-- voucher
     +-- created-on?                      yang:date-and-time
     +-- expires-on?                      yang:date-and-time
     +-- assertion?                       enumeration
     +-- serial-number                    string
     +-- idevid-issuer?                   binary
     +-- pinned-domain-cert?              binary
     +-- domain-cert-revocation-checks?   boolean
     +-- nonce?                           binary
     +-- last-renewal-date?               yang:date-and-time
     +-- prior-signed-voucher-request?    binary
     +-- proximity-registrar-cert?        binary
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-5">Figure 5</a>:
<a class="selfRef" href="#name-yang-tree-diagram-for-a-vou">YANG Tree Diagram for a Voucher-Request</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="voucher-request-examples">
<section id="section-3.3">
        <h3 id="name-examples">
<a class="section-number selfRef" href="#section-3.3">3.3. </a><a class="section-name selfRef" href="#name-examples">Examples</a>
        </h3>
<p id="section-3.3-1">This section provides voucher-request examples for illustration
                purposes.
                These examples show JSON prior to CMS wrapping.
                JSON encoding rules specify that any binary
                content be base64 encoded (<span>[<a class="xref" href="#RFC4648">RFC4648</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc4648#section-4">Section 4</a></span>).
                The contents of the (base64) encoded certificates have been elided
                to save space. For detailed examples, see <a class="xref" href="#exampleprocess">Appendix C.2</a>. These examples conform to the encoding rules
                defined in <span>[<a class="xref" href="#RFC7951">RFC7951</a>]</span>.<a class="pilcrow" href="#section-3.3-1">¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-3.3-2">
          <dt>Example (1):</dt>
<dd id="section-3.3-2.1">The following example illustrates a pledge voucher-request. The
            assertion leaf is indicated as "proximity", and the registrar's TLS server
            certificate is included in the proximity-registrar-cert leaf. See
            <a class="xref" href="#RequestVoucherFromRegistrar">Section 5.2</a>.<a class="pilcrow" href="#section-3.3-2.1">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<span id="name-json-representation-of-an-e"></span><div id="voucherrequest_example1">
<figure id="figure-6">
          <div id="section-3.3-3.1">
<pre class="sourcecode lang-json">{
    "ietf-voucher-request:voucher": {
        "assertion": "proximity",
        "nonce": "62a2e7693d82fcda2624de58fb6722e5",
        "serial-number" : "JADA123456789",
        "created-on": "2017-01-01T00:00:00.000Z",
        "proximity-registrar-cert": "base64encodedvalue=="
    }
}
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-6">Figure 6</a>:
<a class="selfRef" href="#name-json-representation-of-an-e">JSON Representation of an Example Voucher-Request</a>
          </figcaption></figure>
</div>
<span class="break"></span><dl class="olPercent" id="section-3.3-4">
          <dt>Example (2):</dt>
<dd id="section-3.3-4.1">The following example illustrates a registrar voucher-request.
                The prior-signed-voucher-request leaf is populated with the pledge's
                voucher-request (such as the prior example).  The pledge's
                voucher-request is a binary CMS-signed object.  In the JSON encoding used
                here, it must be base64 encoded. The nonce and
                assertion have been carried forward from the pledge request to
                the registrar request.
                The serial-number is extracted from
                the pledge's Client Certificate from the TLS connection. See
                <a class="xref" href="#RequestVoucherFromMASA">Section 5.5</a>.<a class="pilcrow" href="#section-3.3-4.1">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<span id="name-json-representation-of-an-ex"></span><div id="voucherrequest_prior_example1">
<figure id="figure-7">
          <div id="section-3.3-5.1">
<pre class="sourcecode lang-json">{
    "ietf-voucher-request:voucher": {
        "assertion" : "proximity",
        "nonce": "62a2e7693d82fcda2624de58fb6722e5",
        "created-on": "2017-01-01T00:00:02.000Z",
        "idevid-issuer": "base64encodedvalue==",
        "serial-number": "JADA123456789",
        "prior-signed-voucher-request": "base64encodedvalue=="
    }
}
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-7">Figure 7</a>:
<a class="selfRef" href="#name-json-representation-of-an-ex">JSON Representation of an Example Prior-Signed Voucher-Request</a>
          </figcaption></figure>
</div>
<span class="break"></span><dl class="olPercent" id="section-3.3-6">
          <dt>Example (3):</dt>
<dd id="section-3.3-6.1">The following example illustrates a registrar voucher-request.
                The prior-signed-voucher-request leaf is not populated with the pledge's
                voucher-request nor is the nonce leaf. This form might be used by a
                registrar requesting a voucher when the pledge cannot
                communicate with the registrar (such as when it is powered
                down or still in packaging)
                and therefore cannot submit a nonce.
                This scenario is most useful when the registrar is aware that
                it will not be able to reach the MASA during deployment.
                See
                <a class="xref" href="#RequestVoucherFromMASA">Section 5.5</a>.<a class="pilcrow" href="#section-3.3-6.1">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<span id="name-json-representation-of-an-o"></span><div id="voucherrequest_offline_example1">
<figure id="figure-8">
          <div id="section-3.3-7.1">
<pre class="sourcecode lang-json">{
    "ietf-voucher-request:voucher": {
        "created-on":    "2017-01-01T00:00:02.000Z",
        "idevid-issuer": "base64encodedvalue==",
        "serial-number": "JADA123456789"
    }
}
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-8">Figure 8</a>:
<a class="selfRef" href="#name-json-representation-of-an-o">JSON Representation of an Offline Voucher-Request</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="voucher-request-yang-module">
<section id="section-3.4">
        <h3 id="name-yang-module">
<a class="section-number selfRef" href="#section-3.4">3.4. </a><a class="section-name selfRef" href="#name-yang-module">YANG Module</a>
        </h3>
<p id="section-3.4-1">Following is a YANG module <span>[<a class="xref" href="#RFC7950">RFC7950</a>]</span> that formally
          extends a voucher <span>[<a class="xref" href="#RFC8366">RFC8366</a>]</span> into
        a voucher-request.  This YANG module references <span>[<a class="xref" href="#ITU.X690">ITU.X690</a>]</span>.<a class="pilcrow" href="#section-3.4-1">¶</a></p>
<span id="name-yang-module-for-voucher-req"></span><div id="voucherrequest_yang">
<figure id="figure-9">
          <div id="section-3.4-2.1">
<pre class="sourcecode lang-yang">&lt;CODE BEGINS&gt; file "ietf-voucher-request@2021-05-20.yang"

module ietf-voucher-request {
  yang-version 1.1;
  namespace "urn:ietf:params:xml:ns:yang:ietf-voucher-request";
  prefix vcr;

  import ietf-restconf {
    prefix rc;
    description
      "This import statement is only present to access
       the yang-data extension defined in RFC 8040.";
    reference
      "RFC 8040: RESTCONF Protocol";
  }
  import ietf-voucher {
    prefix vch;
    description
      "This module defines the format for a voucher,
       which is produced by a pledge's manufacturer or
       delegate (MASA) to securely assign a pledge to
       an 'owner', so that the pledge may establish a secure
       connection to the owner's network infrastructure.";
    reference
      "RFC 8366: A Voucher Artifact for
       Bootstrapping Protocols";
  }

  organization
    "IETF ANIMA Working Group";
  contact
    "WG Web:   &lt;https://datatracker.ietf.org/wg/anima/&gt;
     WG List:  &lt;mailto:anima@ietf.org&gt;
     Author:   Kent Watsen
               &lt;mailto:kent+ietf@watsen.net&gt;
     Author:   Michael H. Behringer
               &lt;mailto:Michael.H.Behringer@gmail.com&gt;
     Author:   Toerless Eckert
               &lt;mailto:tte+ietf@cs.fau.de&gt;
     Author:   Max Pritikin
               &lt;mailto:pritikin@cisco.com&gt;
     Author:   Michael Richardson
               &lt;mailto:mcr+ietf@sandelman.ca&gt;";
  description
    "This module defines the format for a voucher-request.
     It is a superset of the voucher itself.
     It provides content to the MASA for consideration
     during a voucher-request.

     The key words 'MUST', 'MUST NOT', 'REQUIRED', 'SHALL', 'SHALL
     NOT', 'SHOULD', 'SHOULD NOT', 'RECOMMENDED', 'NOT RECOMMENDED',
     'MAY', and 'OPTIONAL' in this document are to be interpreted as
     described in BCP 14 (RFC 2119) (RFC 8174) when, and only when,
     they appear in all capitals, as shown here.

     Copyright (c) 2021 IETF Trust and the persons identified as
     authors of the code. All rights reserved.

     Redistribution and use in source and binary forms, with or
     without modification, is permitted pursuant to, and subject
     to the license terms contained in, the Simplified BSD License
     set forth in Section 4.c of the IETF Trust's Legal Provisions
     Relating to IETF Documents
     (https://trustee.ietf.org/license-info).

     This version of this YANG module is part of RFC 8995; see the
     RFC itself for full legal notices.";

  revision 2021-05-20 {
    description
      "Initial version";
    reference
      "RFC 8995: Bootstrapping Remote Secure Key Infrastructure
       (BRSKI)";
  }

  // Top-level statement
  rc:yang-data voucher-request-artifact {
    uses voucher-request-grouping;
  }

  // Grouping defined for future usage

  grouping voucher-request-grouping {
    description
      "Grouping to allow reuse/extensions in future work.";
    uses vch:voucher-artifact-grouping {
      refine "voucher/created-on" {
        mandatory false;
      }
      refine "voucher/pinned-domain-cert" {
        mandatory false;
        description
          "A pinned-domain-cert field is not valid in a
           voucher-request, and any occurrence MUST be ignored.";
      }
      refine "voucher/last-renewal-date" {
        description
          "A last-renewal-date field is not valid in a
           voucher-request, and any occurrence MUST be ignored.";
      }
      refine "voucher/domain-cert-revocation-checks" {
        description
          "The domain-cert-revocation-checks field is not valid in a
           voucher-request, and any occurrence MUST be ignored.";
      }
      refine "voucher/assertion" {
        mandatory false;
        description
          "Any assertion included in registrar voucher-requests
           SHOULD be ignored by the MASA.";
      }
      augment "voucher" {
        description
          "Adds leaf nodes appropriate for requesting vouchers.";
        leaf prior-signed-voucher-request {
          type binary;
          description
            "If it is necessary to change a voucher, or re-sign and
             forward a voucher that was previously provided along a
             protocol path, then the previously signed voucher SHOULD
             be included in this field.

             For example, a pledge might sign a voucher-request
             with a proximity-registrar-cert, and the registrar
             then includes it as the prior-signed-voucher-request
             field.  This is a simple mechanism for a chain of
             trusted parties to change a voucher-request, while
             maintaining the prior signature information.

             The registrar and MASA MAY examine the prior-signed
             voucher information for the
             purposes of policy decisions.  For example, this
             information could be useful to a MASA to determine
             that both the pledge and registrar agree on proximity
             assertions.  The MASA SHOULD remove all
             prior-signed-voucher-request information when
             signing a voucher for imprinting so as to minimize
             the final voucher size.";
        }
        leaf proximity-registrar-cert {
          type binary;
          description
            "An X.509 v3 certificate structure, as specified by
             RFC 5280, Section 4, encoded using the ASN.1
             distinguished encoding rules (DER), as specified
             in ITU X.690.

             The first certificate in the registrar TLS server
             certificate_list sequence (the end-entity TLS
             certificate; see RFC 8446) presented by the registrar
             to the pledge.  This MUST be populated in a pledge's
             voucher-request when a proximity assertion is
             requested.";
          reference
            "ITU X.690: Information Technology - ASN.1 encoding
             rules: Specification of Basic Encoding Rules (BER),
             Canonical Encoding Rules (CER) and Distinguished
             Encoding Rules (DER)
             RFC 5280: Internet X.509 Public Key Infrastructure
             Certificate and Certificate Revocation List (CRL)
             Profile
             RFC 8446: The Transport Layer Security (TLS)
             Protocol Version 1.3";
        }
      }
    }
  }
}

&lt;CODE ENDS&gt;</pre>
</div>
<figcaption><a class="selfRef" href="#figure-9">Figure 9</a>:
<a class="selfRef" href="#name-yang-module-for-voucher-req">YANG Module for Voucher-Request</a>
          </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="proxydetails">
<section id="section-4">
      <h2 id="name-proxying-details-pledge-pro">
<a class="section-number selfRef" href="#section-4">4. </a><a class="section-name selfRef" href="#name-proxying-details-pledge-pro">Proxying Details (Pledge -- Proxy -- Registrar)</a>
      </h2>
<p id="section-4-1">
        This section is normative for uses with an ANIMA ACP.
        The use of the GRASP mechanism is part of the ACP.
        Other users of BRSKI will need to define an equivalent proxy
        mechanism and an equivalent mechanism to configure the proxy.<a class="pilcrow" href="#section-4-1">¶</a></p>
<p id="section-4-2">
        The role of the proxy is to facilitate communications. The proxy
        forwards packets between the pledge and a registrar that has been
        provisioned to the proxy via full GRASP ACP discovery.<a class="pilcrow" href="#section-4-2">¶</a></p>
<p id="section-4-3">
        This section defines a stateful proxy mechanism that is referred
        to as a "circuit" proxy.  This is a form of Application Level Gateway
        (see <span>[<a class="xref" href="#RFC2663">RFC2663</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc2663#section-2.9">Section 2.9</a></span>).<a class="pilcrow" href="#section-4-3">¶</a></p>
<p id="section-4-4">
        The proxy does not terminate the TLS handshake: it passes streams
        of bytes onward without examination.
        A proxy <span class="bcp14">MUST NOT</span> assume any specific TLS version.  Please see
        <span>[<a class="xref" href="#RFC8446">RFC8446</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc8446#section-9.3">Section 9.3</a></span> for
details on TLS invariants.<a class="pilcrow" href="#section-4-4">¶</a></p>
<p id="section-4-5">
        A registrar can directly provide the proxy announcements
        described below, in which case the
        announced port can point directly to the registrar itself.  In this
        scenario, the pledge is unaware that there is no proxying occurring.
        This is useful for registrars that are servicing pledges on directly
        connected networks.<a class="pilcrow" href="#section-4-5">¶</a></p>
<p id="section-4-6">
        As a result of the proxy discovery process in <a class="xref" href="#brskigrasp">Section 4.1.1</a>,
        the port number exposed by the proxy
        does not need to be well known or require an IANA allocation.<a class="pilcrow" href="#section-4-6">¶</a></p>
<p id="section-4-7">
        During the discovery of the registrar by the Join Proxy, the
        Join Proxy will also learn which kinds of proxy mechanisms are
        available.  This will allow the Join Proxy to use the lowest impact
        mechanism that the Join Proxy and registrar have in common.<a class="pilcrow" href="#section-4-7">¶</a></p>
<p id="section-4-8">
        In order to permit the proxy functionality to be implemented on the
        maximum variety of devices, the chosen mechanism should use the minimum
        amount of state on the proxy device. While many devices in the ANIMA
        target space will be rather large routers, the proxy function is
        likely to be implemented in the control-plane CPU of such a device,
        with available capabilities for the proxy function similar to many
        class 2 IoT devices.<a class="pilcrow" href="#section-4-8">¶</a></p>
<p id="section-4-9">
        The document <span>[<a class="xref" href="#I-D.richardson-anima-state-for-joinrouter">ANIMA-STATE</a>]</span> provides a
        more extensive analysis and background of the alternative proxy methods.<a class="pilcrow" href="#section-4-9">¶</a></p>
<div id="discovery">
<section id="section-4.1">
        <h3 id="name-pledge-discovery-of-proxy">
<a class="section-number selfRef" href="#section-4.1">4.1. </a><a class="section-name selfRef" href="#name-pledge-discovery-of-proxy">Pledge Discovery of Proxy</a>
        </h3>
<p id="section-4.1-1">
              The result of discovery is a logical communication with a
              registrar, through a proxy.
              The proxy is transparent to the pledge.  The communication
              between the pledge and Join Proxy is over IPv6 link-local addresses.<a class="pilcrow" href="#section-4.1-1">¶</a></p>
<p id="section-4.1-2">To discover the proxy, the pledge performs the following
                actions:<a class="pilcrow" href="#section-4.1-2">¶</a></p>
<ol class="normal type-1" id="section-4.1-3" start="1" type="1">
          <li id="section-4.1-3.1">
            <span class="bcp14">MUST</span>: Obtain a local address using IPv6
                    methods as described in "IPv6
                    Stateless Address Autoconfiguration" <span>[<a class="xref" href="#RFC4862">RFC4862</a>]</span>.
                    Use of temporary addresses <span>[<a class="xref" href="#RFC8981">RFC8981</a>]</span> is
                    encouraged.  To limit pervasive monitoring
                    <span>[<a class="xref" href="#RFC7258">RFC7258</a>]</span>, a new temporary address <span class="bcp14">MAY</span>
                    use a short lifetime (that is, set TEMP_PREFERRED_LIFETIME
                    to be short).
                    Pledges will generally prefer use of IPv6 link-local
                    addresses, and discovery of the proxy will be by link-local
                    mechanisms.
                    IPv4 methods are described in <a class="xref" href="#IPv4operations">Appendix A</a>.<a class="pilcrow" href="#section-4.1-3.1">¶</a>
</li>
          <li id="section-4.1-3.2">
            <span class="bcp14">MUST</span>: Listen for GRASP M_FLOOD
                    <span>[<a class="xref" href="#RFC8990">RFC8990</a>]</span>
                    announcements of the objective: "AN_Proxy".
                    See <a class="xref" href="#brskigrasp">Section 4.1.1</a> for the details of
                    the objective.  The pledge <span class="bcp14">MAY</span> listen concurrently for
                    other sources of information; see <a class="xref" href="#mdnsmethods">Appendix B</a>.<a class="pilcrow" href="#section-4.1-3.2">¶</a>
</li>
        </ol>
<p id="section-4.1-4">

            Once a proxy is
            discovered, the pledge communicates with a registrar through the
            proxy using the bootstrapping protocol defined in <a class="xref" href="#ProtocolDetails">Section 5</a>.<a class="pilcrow" href="#section-4.1-4">¶</a></p>
<p id="section-4.1-5">
              While the GRASP M_FLOOD mechanism is passive for the pledge, the
              non-normative other methods (mDNS and IPv4 methods) described in
              <a class="xref" href="#mdnsmethods">Appendix B</a> are active.
              The pledge <span class="bcp14">SHOULD</span> run those methods in parallel with listening
              for the M_FLOOD.  The active methods <span class="bcp14">SHOULD</span>
              back off by doubling to a maximum of one hour to avoid overloading the
              network with discovery attempts.  Detection of
              physical link status change (Ethernet carrier, for instance) <span class="bcp14">SHOULD</span>
              reset the back-off timers.<a class="pilcrow" href="#section-4.1-5">¶</a></p>
<p id="section-4.1-6">
              The pledge could discover more than one proxy on a given physical
              interface.  The pledge can have a multitude of physical
              interfaces as well: a Layer 2/3 Ethernet switch may have
              hundreds of physical ports.<a class="pilcrow" href="#section-4.1-6">¶</a></p>
<p id="section-4.1-7">
              Each possible proxy offer <span class="bcp14">SHOULD</span> be attempted up to the point
              where a valid voucher is received: while there are many ways in which
              the attempt may fail, it does not succeed until the voucher has
              been validated.<a class="pilcrow" href="#section-4.1-7">¶</a></p>
<p id="section-4.1-8">
              The connection attempts via a single proxy <span class="bcp14">SHOULD</span> exponentially
              back off to a maximum of one hour to avoid overloading the network
              infrastructure.   The back-off timer for each  <span class="bcp14">MUST</span> be
              independent of other connection attempts.<a class="pilcrow" href="#section-4.1-8">¶</a></p>
<p id="section-4.1-9">
                Connection attempts <span class="bcp14">SHOULD</span> be run in
                parallel to avoid head-of-queue problems wherein an attacker
                running a fake proxy or registrar could intentionally perform protocol
                actions slowly.  Connection attempts to
                different proxies <span class="bcp14">SHOULD</span> be sent with an interval of 3 to
                5s. The pledge <span class="bcp14">SHOULD</span> continue to
                listen for additional GRASP M_FLOOD messages during
                the connection attempts.<a class="pilcrow" href="#section-4.1-9">¶</a></p>
<p id="section-4.1-10">
              Each connection attempt through a distinct Join Proxy <span class="bcp14">MUST</span>
              have a unique nonce in the voucher-request.<a class="pilcrow" href="#section-4.1-10">¶</a></p>
<p id="section-4.1-11">
              Once a connection to a
              registrar is established (e.g., establishment of a TLS session key),
              there are expectations of more timely responses; see <a class="xref" href="#RequestVoucherFromRegistrar">Section 5.2</a>.<a class="pilcrow" href="#section-4.1-11">¶</a></p>
<p id="section-4.1-12">
              Once all discovered services are attempted (assuming that none
              succeeded), the device <span class="bcp14">MUST</span> return to listening for GRASP M_FLOOD.
              It <span class="bcp14">SHOULD</span> periodically retry any manufacturer-specific mechanisms.
              The pledge <span class="bcp14">MAY</span> prioritize selection order as
              appropriate for the anticipated environment.<a class="pilcrow" href="#section-4.1-12">¶</a></p>
<div id="brskigrasp">
<section id="section-4.1.1">
          <h4 id="name-proxy-grasp-announcements">
<a class="section-number selfRef" href="#section-4.1.1">4.1.1. </a><a class="section-name selfRef" href="#name-proxy-grasp-announcements">Proxy GRASP Announcements</a>
          </h4>
<p id="section-4.1.1-1">
               A proxy uses the DULL GRASP M_FLOOD mechanism to announce
               itself.
               This announcement can be within the same message as the ACP
               announcement detailed in
               <span>[<a class="xref" href="#RFC8994">RFC8994</a>]</span>.<a class="pilcrow" href="#section-4.1.1-1">¶</a></p>
<p id="section-4.1.1-2">
               The formal Concise Data Definition Language (CDDL) <span>[<a class="xref" href="#RFC8610">RFC8610</a>]</span> definition is:<a class="pilcrow" href="#section-4.1.1-2">¶</a></p>
<span id="name-cddl-definition-of-proxy-di"></span><div id="proxy_discovery_cddl">
<figure id="figure-10">
            <div id="section-4.1.1-3.1">
<pre class="sourcecode lang-CDDL">&lt;CODE BEGINS&gt; file "proxygrasp.cddl"

flood-message = [M_FLOOD, session-id, initiator, ttl,
                 +[objective, (locator-option / [])]]

objective = ["AN_Proxy", objective-flags, loop-count,
                                       objective-value]

ttl             = 180000     ; 180,000 ms (3 minutes)
initiator = ACP address to contact registrar
objective-flags   = sync-only  ; as in the GRASP spec
sync-only         =  4         ; M_FLOOD only requires
                               ; synchronization
loop-count        =  1         ; one hop only
objective-value   =  any       ; none

locator-option    = [ O_IPv6_LOCATOR, ipv6-address,
                    transport-proto, port-number ]
ipv6-address      = the v6 LL of the Proxy
$transport-proto /= IPPROTO_TCP   ; note that this can be any value
                                 ; from the IANA protocol registry,
                                 ; as per RFC 8990, Section 2.9.5.1,
                                 ; Note 3.
port-number      = selected by Proxy

&lt;CODE ENDS&gt;</pre>
</div>
<figcaption><a class="selfRef" href="#figure-10">Figure 10</a>:
<a class="selfRef" href="#name-cddl-definition-of-proxy-di">CDDL Definition of Proxy Discovery Message</a>
            </figcaption></figure>
</div>
<p id="section-4.1.1-4">
               Here is an example M_FLOOD announcing a proxy at fe80::1,
               on TCP port 4443.<a class="pilcrow" href="#section-4.1.1-4">¶</a></p>
<span id="name-example-of-proxy-discovery-"></span><div id="proxy_discovery_mflood">
<figure id="figure-11">
            <div class="artwork art-text alignLeft" id="section-4.1.1-5.1">
<pre>[M_FLOOD, 12340815, h'fe800000000000000000000000000001', 180000,
            [["AN_Proxy", 4, 1, ""],
             [O_IPv6_LOCATOR,
              h'fe800000000000000000000000000001', IPPROTO_TCP, 4443]]]
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-11">Figure 11</a>:
<a class="selfRef" href="#name-example-of-proxy-discovery-">Example of Proxy Discovery Message</a>
            </figcaption></figure>
</div>
<p id="section-4.1.1-6">
               On a small network, the registrar <span class="bcp14">MAY</span> include the GRASP
               M_FLOOD announcements to locally connected networks.<a class="pilcrow" href="#section-4.1.1-6">¶</a></p>
<p id="section-4.1.1-7">
               The $transport-proto above indicates the method that the
               pledge-proxy-registrar will use.  The TCP method described
               here is mandatory, and other proxy methods, such as CoAP
               methods not defined in this document, are optional. Other
               methods <span class="bcp14">MUST NOT</span> be enabled unless the Join Registrar ASA
               indicates support for them in its own announcement.<a class="pilcrow" href="#section-4.1.1-7">¶</a></p>
</section>
</div>
</section>
</div>
<div id="coapconnection">
<section id="section-4.2">
        <h3 id="name-coap-connection-to-registra">
<a class="section-number selfRef" href="#section-4.2">4.2. </a><a class="section-name selfRef" href="#name-coap-connection-to-registra">CoAP Connection to Registrar</a>
        </h3>
<p id="section-4.2-1">
          The use of CoAP to connect from pledge to registrar
          is out of scope for this document and is described in future
          work. See <span>[<a class="xref" href="#I-D.ietf-anima-constrained-voucher">ANIMA-CONSTRAINED-VOUCHER</a>]</span>.<a class="pilcrow" href="#section-4.2-1">¶</a></p>
</section>
</div>
<div id="JRCgrasp">
<section id="section-4.3">
        <h3 id="name-proxy-discovery-and-communi">
<a class="section-number selfRef" href="#section-4.3">4.3. </a><a class="section-name selfRef" href="#name-proxy-discovery-and-communi">Proxy Discovery and Communication of Registrar</a>
        </h3>
<p id="section-4.3-1"> The registrar <span class="bcp14">SHOULD</span> announce itself so that proxies can find it
        and determine what kind of connections can be terminated.<a class="pilcrow" href="#section-4.3-1">¶</a></p>
<p id="section-4.3-2">
          The registrar announces itself using GRASP M_FLOOD messages,
          with the "AN_join_registrar" objective, within the ACP instance.
          A registrar may announce any convenient port
          number, including use of stock port 443.
          ANI proxies <span class="bcp14">MUST</span> support GRASP discovery of registrars.<a class="pilcrow" href="#section-4.3-2">¶</a></p>
<p id="section-4.3-3">
          The M_FLOOD is formatted as follows:<a class="pilcrow" href="#section-4.3-3">¶</a></p>
<span id="name-an-example-of-a-registrar-a"></span><div id="registrar_discovery_example1">
<figure id="figure-12">
          <div class="artwork art-text alignLeft" id="section-4.3-4.1">
<pre>[M_FLOOD, 51804321, h'fda379a6f6ee00000200000064000001', 180000,
            [["AN_join_registrar", 4, 255, "EST-TLS"],
             [O_IPv6_LOCATOR,
              h'fda379a6f6ee00000200000064000001', IPPROTO_TCP, 8443]]]
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-12">Figure 12</a>:
<a class="selfRef" href="#name-an-example-of-a-registrar-a">An Example of a Registrar Announcement Message</a>
          </figcaption></figure>
</div>
<p id="section-4.3-5">
          The formal CDDL definition is:<a class="pilcrow" href="#section-4.3-5">¶</a></p>
<span id="name-cddl-definition-for-registr"></span><div id="registrar_discovery_cddl">
<figure id="figure-13">
          <div id="section-4.3-6.1">
<pre class="sourcecode lang-CDDL">&lt;CODE BEGINS&gt; file "jrcgrasp.cddl"

flood-message = [M_FLOOD, session-id, initiator, ttl,
                 +[objective, (locator-option / [])]]

objective = ["AN_join_registrar", objective-flags, loop-count,
                                       objective-value]

initiator = ACP address to contact registrar
objective-flags = sync-only  ; as in the GRASP spec
sync-only =  4               ; M_FLOOD only requires
                             ; synchronization
loop-count      = 255        ; mandatory maximum
objective-value = text       ; name of the (list of) supported
                             ; protocols: "EST-TLS" for RFC 7030.

&lt;CODE ENDS&gt;</pre>
</div>
<figcaption><a class="selfRef" href="#figure-13">Figure 13</a>:
<a class="selfRef" href="#name-cddl-definition-for-registr">CDDL Definition for Registrar Announcement Message</a>
          </figcaption></figure>
</div>
<p id="section-4.3-7">
          The M_FLOOD message <span class="bcp14">MUST</span> be sent periodically.  The default period <span class="bcp14">SHOULD</span> be
          60 seconds, and the value <span class="bcp14">SHOULD</span> be operator configurable but <span class="bcp14">SHOULD NOT</span> be smaller than 60 seconds.  The frequency of sending <span class="bcp14">MUST</span> be such
          that the aggregate amount of periodic M_FLOODs from all flooding
          sources causes only negligible traffic across the ACP.<a class="pilcrow" href="#section-4.3-7">¶</a></p>
<p id="section-4.3-8">
               Here are some examples of locators for illustrative purposes.
               Only the first one ($transport-protocol = 6, TCP) is defined in
               this document and is mandatory to implement.<a class="pilcrow" href="#section-4.3-8">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.3-9">
<pre>locator1  = [O_IPv6_LOCATOR, fd45:1345::6789, 6,  443]
locator2  = [O_IPv6_LOCATOR, fd45:1345::6789, 17, 5683]
locator3  = [O_IPv6_LOCATOR, fe80::1234, 41, nil]</pre><a class="pilcrow" href="#section-4.3-9">¶</a>
</div>
<p id="section-4.3-10">
               A protocol of 6 indicates that TCP proxying on the
               indicated port is desired.<a class="pilcrow" href="#section-4.3-10">¶</a></p>
<p id="section-4.3-11">
               Registrars <span class="bcp14">MUST</span> announce the set of protocols that they
               support, and they <span class="bcp14">MUST</span> support TCP traffic.<a class="pilcrow" href="#section-4.3-11">¶</a></p>
<p id="section-4.3-12">
               Registrars <span class="bcp14">MUST</span> accept HTTPS/EST traffic on the TCP ports
               indicated.<a class="pilcrow" href="#section-4.3-12">¶</a></p>
<p id="section-4.3-13">
               Registrars <span class="bcp14">MUST</span> support the ANI TLS Circuit Proxy and
               therefore BRSKI across HTTPS/TLS native across the ACP.<a class="pilcrow" href="#section-4.3-13">¶</a></p>
<p id="section-4.3-14">
               In the ANI, the ACP-secured instance of
               GRASP <span>[<a class="xref" href="#RFC8990">RFC8990</a>]</span> <span class="bcp14">MUST</span> be used for
               discovery of ANI registrar ACP addresses
               and ports by ANI proxies.  Therefore, the TCP leg of the proxy connection between
               the ANI proxy and ANI registrar also runs across the ACP.<a class="pilcrow" href="#section-4.3-14">¶</a></p>
</section>
</div>
</section>
</div>
<div id="ProtocolDetails">
<section id="section-5">
      <h2 id="name-protocol-details-pledge-reg">
<a class="section-number selfRef" href="#section-5">5. </a><a class="section-name selfRef" href="#name-protocol-details-pledge-reg">Protocol Details (Pledge -- Registrar -- MASA)</a>
      </h2>
<p id="section-5-1">The pledge <span class="bcp14">MUST</span> initiate BRSKI after boot if it is unconfigured.
        The pledge <span class="bcp14">MUST NOT</span> automatically initiate BRSKI if it has been
        configured or is in the process of being configured.<a class="pilcrow" href="#section-5-1">¶</a></p>
<p id="section-5-2">
          BRSKI is described as extensions to EST <span>[<a class="xref" href="#RFC7030">RFC7030</a>]</span>.
          The goal of these extensions is to reduce the number of TLS
          connections and crypto operations required on the pledge.
          The registrar implements the BRSKI REST interface within
          the "/.well-known/brski" URI tree and implements the existing EST URIs as
          described in
          EST <span>[<a class="xref" href="#RFC7030">RFC7030</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc7030#section-3.2.2">Section 3.2.2</a></span>. The communication channel
          between the pledge and the registrar is referred to as "BRSKI-EST"
          (see <a class="xref" href="#architecturefigure">Figure 1</a>).<a class="pilcrow" href="#section-5-2">¶</a></p>
<p id="section-5-3">
 The communication channel between the registrar and MASA is a new
   communication channel, similar to EST, within the newly registered
   "/.well-known/brski" tree.  For clarity, this channel is referred to
   as "BRSKI-MASA" (see <a class="xref" href="#architecturefigure">Figure 1</a>).<a class="pilcrow" href="#section-5-3">¶</a></p>
<p id="section-5-4">The MASA URI is "https://" authority "/.well-known/brski".<a class="pilcrow" href="#section-5-4">¶</a></p>
<p id="section-5-5">
          BRSKI uses existing CMS message formats for existing EST
          operations.  BRSKI uses JSON
          <span>[<a class="xref" href="#RFC8259">RFC8259</a>]</span> for all new operations defined here and
          for voucher formats. In all places where a binary value must be carried
          in a JSON string, a base64 format (<span>[<a class="xref" href="#RFC4648">RFC4648</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc4648#section-4">Section 4</a></span>) is to be used, as per
          <span>[<a class="xref" href="#RFC7951">RFC7951</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc7951#section-6.6">Section 6.6</a></span>.<a class="pilcrow" href="#section-5-5">¶</a></p>
<p id="section-5-6">
          While EST (<span>[<a class="xref" href="#RFC7030">RFC7030</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc7030#section-3.2">Section 3.2</a></span>) does not insist upon use of HTTP
          persistent connections
          (<span>[<a class="xref" href="#RFC7230">RFC7230</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc7230#section-6.3">Section 6.3</a></span>),
          BRSKI-EST connections <span class="bcp14">SHOULD</span> use persistent
          connections.  The intention of this guidance is to ensure the
          provisional TLS state occurs only once, and that the subsequent
          resolution of the provision state is not subject to a Man-in-the-Middle (MITM) attack
          during a critical phase.<a class="pilcrow" href="#section-5-6">¶</a></p>
<p id="section-5-7">
          If non-persistent connections are used, then both the pledge and
          the registrar <span class="bcp14">MUST</span> remember the certificates that have been seen and also sent
          for the first connection.  They <span class="bcp14">MUST</span> check each subsequent
          connection for the same certificates, and each end <span class="bcp14">MUST</span> use
          the same certificates as well.  This places a difficult restriction
          on rolling certificates on the registrar.<a class="pilcrow" href="#section-5-7">¶</a></p>
<p id="section-5-8">Summarized automation extensions for the BRSKI-EST flow are:<a class="pilcrow" href="#section-5-8">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-9.1">
              The pledge either attempts concurrent connections via each
              discovered proxy or times out quickly and tries connections
              in series, as explained at the end of <a class="xref" href="#brskiesttls">Section 5.1</a>.<a class="pilcrow" href="#section-5-9.1">¶</a>
</li>
        <li class="normal" id="section-5-9.2">
              The pledge provisionally accepts the registrar certificate during
              the TLS handshake as detailed in <a class="xref" href="#brskiesttls">Section 5.1</a>.<a class="pilcrow" href="#section-5-9.2">¶</a>
</li>
        <li class="normal" id="section-5-9.3">
              The pledge requests a voucher using
              the new REST calls described below.  This voucher is then validated.<a class="pilcrow" href="#section-5-9.3">¶</a>
</li>
        <li class="normal" id="section-5-9.4">
              The pledge completes authentication of the server certificate as
              detailed in <a class="xref" href="#CompletingAuthenticationBootstrapping">Section 5.6.1</a>. This
              moves the BRSKI-EST TLS connection out of the provisional
              state.<a class="pilcrow" href="#section-5-9.4">¶</a>
</li>
        <li class="normal" id="section-5-9.5">
              Mandatory bootstrap steps conclude with voucher status
              telemetry (see <a class="xref" href="#pledgestatus">Section 5.7</a>).<a class="pilcrow" href="#section-5-9.5">¶</a>
</li>
      </ul>
<p id="section-5-10">
          The BRSKI-EST TLS connection can now be used for EST enrollment.<a class="pilcrow" href="#section-5-10">¶</a></p>
<p id="section-5-11">The extensions for a registrar (equivalent to an EST server) are:<a class="pilcrow" href="#section-5-11">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-12.1">
            Client authentication is automated using IDevID as per the EST certificate-based client authentication.
            The subject field's DN encoding <span class="bcp14">MUST</span> include the "serialNumber"
            attribute   with the device's unique serial number
            as explained in <a class="xref" href="#PledgeIdentification">Section 2.3.1</a>.<a class="pilcrow" href="#section-5-12.1">¶</a>
</li>
        <li class="normal" id="section-5-12.2">The registrar requests and validates the voucher from the MASA.<a class="pilcrow" href="#section-5-12.2">¶</a>
</li>
        <li class="normal" id="section-5-12.3">The registrar forwards the voucher to the pledge when
          requested.<a class="pilcrow" href="#section-5-12.3">¶</a>
</li>
        <li class="normal" id="section-5-12.4">
            The registrar performs log verifications (described in
            <a class="xref" href="#auditLogVerification">Section 5.8.3</a>) in addition to local
            authorization checks before accepting optional pledge device
            enrollment requests.<a class="pilcrow" href="#section-5-12.4">¶</a>
</li>
      </ul>
<div id="brskiesttls">
<section id="section-5.1">
        <h3 id="name-brski-est-tls-establishment">
<a class="section-number selfRef" href="#section-5.1">5.1. </a><a class="section-name selfRef" href="#name-brski-est-tls-establishment">BRSKI-EST TLS Establishment Details</a>
        </h3>
<p id="section-5.1-1">The pledge establishes the TLS connection with the registrar through
                the Circuit Proxy (see <a class="xref" href="#proxydetails">Section 4</a>),
                but the TLS handshake is with the registrar. The BRSKI-EST pledge
                is the TLS client, and the BRSKI-EST registrar is the TLS server.
                All security associations established are
                between the pledge and the registrar regardless of proxy
                operations.<a class="pilcrow" href="#section-5.1-1">¶</a></p>
<p id="section-5.1-2">
              Use of TLS 1.3 (or newer) is encouraged.
              TLS 1.2 or newer is <span class="bcp14">REQUIRED</span> on the pledge side.
              TLS 1.3 (or newer) <span class="bcp14">SHOULD</span> be available on the registrar server interface,
              and the registrar client interface, but TLS 1.2 <span class="bcp14">MAY</span> be used.
              TLS 1.3 (or newer) <span class="bcp14">SHOULD</span> be available on the MASA server interface, but TLS
              1.2 <span class="bcp14">MAY</span> be used.<a class="pilcrow" href="#section-5.1-2">¶</a></p>
<p id="section-5.1-3">
              Establishment of the BRSKI-EST TLS connection is as
              specified in "Bootstrap Distribution of CA Certificates" (Section <a class="relref" href="https://www.rfc-editor.org/rfc/rfc7030#section-4.1.1">4.1.1</a>) of <span>[<a class="xref" href="#RFC7030">RFC7030</a>]</span>, wherein
              the client is authenticated with the IDevID certificate, and the
              EST server (the registrar) is provisionally authenticated with an unverified
              server certificate.

              Configuration or distribution of the trust anchor database
              used for validating the IDevID certificate is out of scope of
              this specification.  Note that the trust anchors
              in / excluded from the database will affect which manufacturers'
              devices are acceptable to the registrar as pledges and can
              also be used to limit the set of MASAs that are trusted for
              enrollment.<a class="pilcrow" href="#section-5.1-3">¶</a></p>
<p id="section-5.1-4">
              The signature in the certificate <span class="bcp14">MUST</span> be validated even if a
              signing key cannot (yet) be validated.  The certificate (or
              chain) <span class="bcp14">MUST</span> be retained for later validation.<a class="pilcrow" href="#section-5.1-4">¶</a></p>
<p id="section-5.1-5">
              A self-signed
              certificate for the registrar is acceptable as the voucher
              can validate it upon successful enrollment.<a class="pilcrow" href="#section-5.1-5">¶</a></p>
<p id="section-5.1-6">The pledge performs input validation of all data received
               until a voucher is verified as specified in <a class="xref" href="#CompletingAuthenticationBootstrapping">Section 5.6.1</a> and
               the TLS connection leaves the provisional state. Until these
               operations are complete, the pledge could be communicating
               with an attacker.<a class="pilcrow" href="#section-5.1-6">¶</a></p>
<p id="section-5.1-7">
              The pledge code needs to be written with the assumption that
              all data is being transmitted at this point to an
              unauthenticated peer, and that received data, while inside a
              TLS connection, <span class="bcp14">MUST</span> be considered untrusted.  This
              particularly applies to HTTP headers and CMS structures that
              make up the voucher.<a class="pilcrow" href="#section-5.1-7">¶</a></p>
<p id="section-5.1-8">
              A pledge that can connect to multiple registrars concurrently
              <span class="bcp14">SHOULD</span> do so.  Some devices may be unable to do so for lack of
              threading, or resource issues.   Concurrent connections defeat
              attempts by a malicious proxy from causing a TCP Slowloris-like
              attack (see <span>[<a class="xref" href="#slowloris">slowloris</a>]</span>).<a class="pilcrow" href="#section-5.1-8">¶</a></p>
<p id="section-5.1-9">
              A pledge that cannot maintain as many connections as there are
              eligible proxies will need to rotate among the various choices,
              terminating connections that do not appear to be making
              progress.
              If no connection is making progress after 5 seconds, then the
              pledge <span class="bcp14">SHOULD</span> drop the oldest connection and go on to a
              different proxy: the proxy that has been communicated with least recently.


              If there were no
              other proxies discovered, the pledge <span class="bcp14">MAY</span> continue to wait,
              as long as it is concurrently listening for new proxy
              announcements.<a class="pilcrow" href="#section-5.1-9">¶</a></p>
</section>
</div>
<div id="RequestVoucherFromRegistrar">
<section id="section-5.2">
        <h3 id="name-pledge-requests-voucher-fro">
<a class="section-number selfRef" href="#section-5.2">5.2. </a><a class="section-name selfRef" href="#name-pledge-requests-voucher-fro">Pledge Requests Voucher from the Registrar</a>
        </h3>
<p id="section-5.2-1">When the pledge bootstraps, it makes a request for a voucher from a
        registrar.<a class="pilcrow" href="#section-5.2-1">¶</a></p>
<p id="section-5.2-2">This is done with an HTTPS POST using the operation path value of
        "/.well-known/brski/requestvoucher".<a class="pilcrow" href="#section-5.2-2">¶</a></p>
<p id="section-5.2-3">The pledge voucher-request Content-Type is as follows.<a class="pilcrow" href="#section-5.2-3">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.2-4">
          <dt id="section-5.2-4.1">application/voucher-cms+json:</dt>
          <dd id="section-5.2-4.2" style="margin-left: 1.5em">
            <span>[<a class="xref" href="#RFC8366">RFC8366</a>]</span> defines a "YANG-defined JSON document that has been signed using a Cryptographic Message Syntax (CMS)
           structure", and the voucher-request described in
           <a class="xref" href="#voucher-request">Section 3</a> is created in the same way.
           The media type is the same as defined in <span>[<a class="xref" href="#RFC8366">RFC8366</a>]</span>.
           This is also used for the pledge voucher-request.
           The pledge <span class="bcp14">MUST</span> sign the request using the
           credentials in <a class="xref" href="#IDevIDextension">Section 2.3</a>.<a class="pilcrow" href="#section-5.2-4.2">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-5.2-5">Registrar
        implementations <span class="bcp14">SHOULD</span> anticipate future media types but, of course, will simply fail the request if those
        types are not yet known.<a class="pilcrow" href="#section-5.2-5">¶</a></p>
<p id="section-5.2-6">
          The pledge <span class="bcp14">SHOULD</span> include an
          "Accept" header field (see <span>[<a class="xref" href="#RFC7231">RFC7231</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc7231#section-5.3.2">Section 5.3.2</a></span>) indicating the acceptable media type for the voucher
          response. The  "application/voucher-cms+json" media type is defined
          in <span>[<a class="xref" href="#RFC8366">RFC8366</a>]</span>, but constrained voucher formats are
          expected in the future. Registrars and MASA are expected to be
          flexible in what they accept.<a class="pilcrow" href="#section-5.2-6">¶</a></p>
<p id="section-5.2-7">The pledge populates the voucher-request fields as follows:<a class="pilcrow" href="#section-5.2-7">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.2-8">
          <dt id="section-5.2-8.1">created-on:</dt>
          <dd id="section-5.2-8.2" style="margin-left: 1.5em">Pledges that have a real-time clock are
            <span class="bcp14">RECOMMENDED</span> to populate this field with the current date and
            time in yang:date-and-time format. This provides additional
            information to the MASA.
            Pledges that have no real-time clocks <span class="bcp14">MAY</span> omit this field.<a class="pilcrow" href="#section-5.2-8.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.2-8.3">nonce:</dt>
          <dd id="section-5.2-8.4" style="margin-left: 1.5em">The pledge voucher-request <span class="bcp14">MUST</span> contain a
            cryptographically strong random or pseudo-random number
            nonce (see <span>[<a class="xref" href="#RFC4086">RFC4086</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc4086#section-6.2">Section 6.2</a></span>).
            As the nonce is usually generated very early in the boot sequence,
            there is a concern that the same nonce might be generated across
            multiple boots, or after a factory reset.
            Different nonces <span class="bcp14">MUST</span> be generated for each bootstrapping
            attempt, whether in series or concurrently.
            The freshness of this nonce mitigates against the lack of a real-time
            clock as explained in <a class="xref" href="#timeunknown">Section 2.6.1</a>.<a class="pilcrow" href="#section-5.2-8.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.2-8.5">assertion:</dt>
          <dd id="section-5.2-8.6" style="margin-left: 1.5em">
              The pledge indicates support for the mechanism
              described in this document, by putting the value "proximity" in the
              voucher-request, and <span class="bcp14">MUST</span> include the
              proximity-registrar-cert field (below).<a class="pilcrow" href="#section-5.2-8.6">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.2-8.7">proximity-registrar-cert:</dt>
          <dd id="section-5.2-8.8" style="margin-left: 1.5em">In a pledge
            voucher-request, this is the first certificate in the TLS server
            "certificate_list" sequence (see <span>[<a class="xref" href="#RFC8446">RFC8446</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc8446#section-4.4.2">Section 4.4.2</a></span>) presented by the
            registrar to the pledge. That is, it is the end-entity
            certificate. This <span class="bcp14">MUST</span> be populated in a pledge voucher-request.<a class="pilcrow" href="#section-5.2-8.8">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.2-8.9">serial-number:</dt>
          <dd id="section-5.2-8.10" style="margin-left: 1.5em">The serial number of the pledge
            is included in the voucher-request from the pledge. This value is
            included as a sanity check only, but it is not to be forwarded
            by the registrar as described in <a class="xref" href="#RequestVoucherFromMASA">Section 5.5</a>.<a class="pilcrow" href="#section-5.2-8.10">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-5.2-9">All other fields <span class="bcp14">MAY</span> be omitted in the pledge voucher-request.<a class="pilcrow" href="#section-5.2-9">¶</a></p>
<p id="section-5.2-10">See an example JSON payload of a pledge voucher-request in
            <a class="xref" href="#voucher-request-examples">Section 3.3</a>, Example 1.<a class="pilcrow" href="#section-5.2-10">¶</a></p>
<p id="section-5.2-11">
          The registrar confirms that the
          assertion is "proximity" and that pinned
          proximity-registrar-cert is the registrar's certificate.
          If this validation fails, then there is an on-path attacker (MITM),
          and the connection <span class="bcp14">MUST</span> be closed after the returning of an
          HTTP 401 error code.<a class="pilcrow" href="#section-5.2-11">¶</a></p>
</section>
</div>
<div id="pledgeauthorization">
<section id="section-5.3">
        <h3 id="name-registrar-authorization-of-">
<a class="section-number selfRef" href="#section-5.3">5.3. </a><a class="section-name selfRef" href="#name-registrar-authorization-of-">Registrar Authorization of Pledge</a>
        </h3>
<p id="section-5.3-1">
          In a fully automated network, all devices must be securely identified
          and authorized to join the domain.<a class="pilcrow" href="#section-5.3-1">¶</a></p>
<p id="section-5.3-2">
          A registrar accepts or declines a request to join the domain, based
          on the authenticated identity presented.  For different networks,
          examples of automated acceptance may include the allowance of:<a class="pilcrow" href="#section-5.3-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3-3.1">any device of a specific type (as determined by the X.509
          IDevID),<a class="pilcrow" href="#section-5.3-3.1">¶</a>
</li>
          <li class="normal" id="section-5.3-3.2">any device from a specific vendor (as determined by the
          X.509 IDevID),<a class="pilcrow" href="#section-5.3-3.2">¶</a>
</li>
          <li class="normal" id="section-5.3-3.3">a specific device from a vendor (as determined by the X.509
          IDevID) against a domain acceptlist.  (The mechanism for checking
          a shared acceptlist potentially used by multiple registrars is out
          of scope.)<a class="pilcrow" href="#section-5.3-3.3">¶</a>
</li>
        </ul>
<p id="section-5.3-4">
          If validation fails, the registrar <span class="bcp14">SHOULD</span> respond with the
          HTTP 404 error code.  If the voucher-request is in an unknown
          format, then an HTTP 406 error code is more appropriate.
          A situation that could be resolved with administrative action
          (such as adding a vendor to an acceptlist) <span class="bcp14">MAY</span> be responded to with a
          403 HTTP error code.<a class="pilcrow" href="#section-5.3-4">¶</a></p>
<p id="section-5.3-5">If authorization is successful, the registrar obtains a voucher from the MASA service (see
            <a class="xref" href="#RequestVoucherFromMASA">Section 5.5</a>) and returns that MASA-signed voucher to the pledge
        as described in <a class="xref" href="#VoucherResponse">Section 5.6</a>.<a class="pilcrow" href="#section-5.3-5">¶</a></p>
</section>
</div>
<div id="brskimasatls">
<section id="section-5.4">
        <h3 id="name-brski-masa-tls-establishmen">
<a class="section-number selfRef" href="#section-5.4">5.4. </a><a class="section-name selfRef" href="#name-brski-masa-tls-establishmen">BRSKI-MASA TLS Establishment Details</a>
        </h3>
<p id="section-5.4-1">
          The BRSKI-MASA TLS connection is a "normal" TLS connection
          appropriate for HTTPS REST interfaces. The registrar initiates the
          connection and uses the MASA URL that is obtained as described in
          <a class="xref" href="#obtainmasaurl">Section 2.8</a>. The mechanisms in
          <span>[<a class="xref" href="#RFC6125">RFC6125</a>]</span> <span class="bcp14">SHOULD</span> be used in authentication of the
          MASA using a DNS-ID that matches that which is found in the IDevID.
          Registrars <span class="bcp14">MAY</span> include a mechanism to override the MASA URL on a
          manufacturer-by-manufacturer basis, and within that override, it is
          appropriate to provide alternate anchors.
          This will typically be used by some vendors to establish explicit
          (or private) trust
          anchors for validating their MASA that is part of a sales channel
          integration.<a class="pilcrow" href="#section-5.4-1">¶</a></p>
<p id="section-5.4-2">
          Use of TLS 1.3 (or newer) is encouraged. TLS 1.2 or newer is
          <span class="bcp14">REQUIRED</span>.  TLS 1.3 (or newer) <span class="bcp14">SHOULD</span> be available.<a class="pilcrow" href="#section-5.4-2">¶</a></p>
<p id="section-5.4-3">
          As described in <span>[<a class="xref" href="#RFC7030">RFC7030</a>]</span>, the MASA and the
          registrars <span class="bcp14">SHOULD</span> be prepared to support TLS Client
          Certificate authentication and/or HTTP Basic, Digest, or Salted Challenge Response Authentication Mechanism (SCRAM) authentication.
          This connection <span class="bcp14">MAY</span> also have no client authentication at all.<a class="pilcrow" href="#section-5.4-3">¶</a></p>
<p id="section-5.4-4">
          Registrars <span class="bcp14">SHOULD</span> permit
          trust anchors to be preconfigured on a per-vendor (MASA) basis.
          Registrars <span class="bcp14">SHOULD</span> include the ability to configure a TLS
          Client Certificate on a per-MASA basis, or to use no Client
          Certificate.  Registrars <span class="bcp14">SHOULD</span> also permit HTTP Basic and
          Digest authentication to be configured.<a class="pilcrow" href="#section-5.4-4">¶</a></p>
<p id="section-5.4-5">
          The authentication of the BRSKI-MASA
          connection does not change the voucher-request process, as
          voucher-requests are already signed by the registrar.
          Instead, this authentication provides access control to the
          audit-log as described in <a class="xref" href="#authzLogRequest">Section 5.8</a>.<a class="pilcrow" href="#section-5.4-5">¶</a></p>
<p id="section-5.4-6">
          Implementers are advised that
          contacting the MASA establishes a secured API connection with a
          web service, and that there are a number of authentication models
          being explored within the industry. Registrars are <span class="bcp14">RECOMMENDED</span> to
          fail gracefully and generate useful administrative notifications or
          logs in the advent of unexpected HTTP 401 (Unauthorized) responses
          from the MASA.<a class="pilcrow" href="#section-5.4-6">¶</a></p>
<div id="masaauthentication">
<section id="section-5.4.1">
          <h4 id="name-masa-authentication-of-cust">
<a class="section-number selfRef" href="#section-5.4.1">5.4.1. </a><a class="section-name selfRef" href="#name-masa-authentication-of-cust">MASA Authentication of Customer Registrar</a>
          </h4>
<p id="section-5.4.1-1">
            Providing per-customer options requires the customer's
            registrar to be uniquely identified.  This can be done by any stateless
            method that HTTPS supports such as HTTP Basic
            or Digest authentication (that is using a password), but the use
            of TLS Client Certificate authentication is <span class="bcp14">RECOMMENDED</span>.<a class="pilcrow" href="#section-5.4.1-1">¶</a></p>
<p id="section-5.4.1-2">
            Stateful methods involving API tokens, or HTTP Cookies, are not
            recommended.<a class="pilcrow" href="#section-5.4.1-2">¶</a></p>
<p id="section-5.4.1-3">
            It is expected that the setup and configuration of per-customer
            Client Certificates is done as part of a sales ordering process.<a class="pilcrow" href="#section-5.4.1-3">¶</a></p>
<p id="section-5.4.1-4">
            The use of public PKI (i.e., WebPKI) end-entity certificates to
            identify the registrar is reasonable, and if done universally,
            this would permit a MASA to identify a customer's registrar simply by a
            Fully Qualified Domain Name (FQDN).<a class="pilcrow" href="#section-5.4.1-4">¶</a></p>
<p id="section-5.4.1-5">
            The use of DANE records in DNSSEC-signed zones would also permit use of
            a FQDN to identify customer registrars.<a class="pilcrow" href="#section-5.4.1-5">¶</a></p>
<p id="section-5.4.1-6">
            A third (and simplest, but least flexible) mechanism would be for
            the MASA to simply store the registrar's certificate pinned in a
            database.<a class="pilcrow" href="#section-5.4.1-6">¶</a></p>
<p id="section-5.4.1-7">
            A MASA without any supply-chain integration can simply accept
            registrars without any authentication or on a
            blind TOFU basis as described in <a class="xref" href="#masasecurityreduction_tofu">Section 7.4.2</a>.<a class="pilcrow" href="#section-5.4.1-7">¶</a></p>
<p id="section-5.4.1-8">
            This document does not make a specific recommendation on how the
            MASA authenticates the registrar as there are
            likely different tradeoffs in different environments and product
            values. Even within the ANIMA ACP applicability, there is a
            significant difference between supply-chain logistics for $100
            CPE devices and $100,000 core routers.<a class="pilcrow" href="#section-5.4.1-8">¶</a></p>
</section>
</div>
</section>
</div>
<div id="RequestVoucherFromMASA">
<section id="section-5.5">
        <h3 id="name-registrar-requests-voucher-">
<a class="section-number selfRef" href="#section-5.5">5.5. </a><a class="section-name selfRef" href="#name-registrar-requests-voucher-">Registrar Requests Voucher from MASA</a>
        </h3>
<p id="section-5.5-1">
          When a registrar receives a pledge voucher-request, it in turn
          submits a registrar voucher-request to the MASA service via an
          HTTPS interface <span>[<a class="xref" href="#RFC7231">RFC7231</a>]</span>.<a class="pilcrow" href="#section-5.5-1">¶</a></p>
<p id="section-5.5-2">This is done with an HTTP POST using the operation path value of
        "/.well-known/brski/requestvoucher".<a class="pilcrow" href="#section-5.5-2">¶</a></p>
<p id="section-5.5-3">The voucher media type "application/voucher-cms+json" is defined in
          <span>[<a class="xref" href="#RFC8366">RFC8366</a>]</span> and is also used for the registrar voucher-request. It is a JSON document that has been
          signed using a CMS structure.
          The registrar <span class="bcp14">MUST</span> sign the registrar voucher-request.<a class="pilcrow" href="#section-5.5-3">¶</a></p>
<p id="section-5.5-4">
          MASA implementations <span class="bcp14">SHOULD</span> anticipate future media
          ntypes but, of course, will simply fail the request if those types are
          not yet known.<a class="pilcrow" href="#section-5.5-4">¶</a></p>
<p id="section-5.5-5">
          The voucher-request CMS object includes some number of certificates
          that are input to the MASA as it populates the
          pinned-domain-cert. As
          <span>[<a class="xref" href="#RFC8366">RFC8366</a>]</span> is quite flexible in what may be put into
          the pinned-domain-cert, the MASA needs some signal as to what
          certificate would be effective to populate the field with: it may
          range from the end-entity certificate that the registrar uses
          to the entire private Enterprise CA certificate.
          More-specific certificates result in a tighter binding of the
          voucher to the domain, while less-specific certificates result in
          more flexibility in how the domain is represented by certificates.<a class="pilcrow" href="#section-5.5-5">¶</a></p>
<p id="section-5.5-6">
          A registrar that is seeking a nonceless voucher for later offline use
          benefits from a less-specific certificate, as it permits the actual
          key pair used by a future registrar to be determined by the pinned
          CA.<a class="pilcrow" href="#section-5.5-6">¶</a></p>
<p id="section-5.5-7">
          In some cases, a less-specific certificate, such as a public WebPKI
          CA, could be too open and could permit any
          entity issued a certificate by that
          authority to assume ownership of a device
          that has a voucher pinned.
          Future work may provide a solution to pin both a certificate and a
          name that would reduce such risk of malicious ownership assertions.<a class="pilcrow" href="#section-5.5-7">¶</a></p>
<p id="section-5.5-8">
          The registrar <span class="bcp14">SHOULD</span> request a voucher with the most specificity
          consistent with the mode that it is operating in.
          In order to do this, when the registrar prepares the CMS structure
          for the signed voucher-request, it <span class="bcp14">SHOULD</span> include only certificates
          that are a part of the chain that it wishes the MASA to pin.
          This <span class="bcp14">MAY</span> be as small as only the end-entity certificate (with id-kp-cmcRA set) that
          it uses as its TLS server certificate, or it <span class="bcp14">MAY</span> be the entire
          chain, including the domain CA.<a class="pilcrow" href="#section-5.5-8">¶</a></p>
<p id="section-5.5-9">
          The registrar <span class="bcp14">SHOULD</span> include an "Accept" header field (see <span>[<a class="xref" href="#RFC7231">RFC7231</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc7231#section-5.3.2">Section 5.3.2</a></span>) indicating the response
media types that are
          acceptable. This list <span class="bcp14">SHOULD</span> be the entire list presented to the
          registrar in the pledge's original request (see <a class="xref" href="#RequestVoucherFromRegistrar">Section 5.2</a>), but it <span class="bcp14">MAY</span> be a subset.
          The MASA is expected to be flexible in what it accepts.<a class="pilcrow" href="#section-5.5-9">¶</a></p>
<p id="section-5.5-10">The registrar populates the voucher-request fields as follows:<a class="pilcrow" href="#section-5.5-10">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.5-11">
          <dt id="section-5.5-11.1">created-on:</dt>
          <dd id="section-5.5-11.2" style="margin-left: 1.5em">
          The registrar <span class="bcp14">SHOULD</span> populate this field with the current date and
          time when the voucher-request is formed. This field
          provides additional information to the MASA.<a class="pilcrow" href="#section-5.5-11.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.5-11.3">nonce:</dt>
          <dd id="section-5.5-11.4" style="margin-left: 1.5em">This value, if present, is copied from the pledge
            voucher-request. The registrar voucher-request <span class="bcp14">MAY</span> omit
            the nonce as per <a class="xref" href="#noncelessVoucherRequest">Section 3.1</a>.<a class="pilcrow" href="#section-5.5-11.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.5-11.5">serial-number:</dt>
          <dd id="section-5.5-11.6" style="margin-left: 1.5em">The serial number of the pledge the registrar would like a voucher for. The registrar
        determines this value by parsing the authenticated pledge IDevID certificate; see <a class="xref" href="#IDevIDextension">Section 2.3</a>.
        The registrar <span class="bcp14">MUST</span> verify that the serial-number field it parsed matches the serial-number field the pledge
        provided in its voucher-request. This provides a sanity check useful for detecting error conditions and logging.
        The registrar <span class="bcp14">MUST NOT</span> simply copy the serial-number field from a pledge voucher-request as that field is claimed but
        not certified.<a class="pilcrow" href="#section-5.5-11.6">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.5-11.7">idevid-issuer:</dt>
          <dd id="section-5.5-11.8" style="margin-left: 1.5em">The Issuer value from the
        pledge IDevID certificate is included to ensure unique interpretation of the
        serial-number. In the case of a nonceless (offline) voucher-request, an
        appropriate value needs to be configured from the same out-of-band source as the serial-number.<a class="pilcrow" href="#section-5.5-11.8">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.5-11.9">prior-signed-voucher-request:</dt>
          <dd id="section-5.5-11.10" style="margin-left: 1.5em">The signed pledge
        voucher-request <span class="bcp14">SHOULD</span> be included in the registrar voucher-request.
        The entire CMS-signed structure is to be included and base64 encoded for
        transport in the JSON structure.<a class="pilcrow" href="#section-5.5-11.10">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-5.5-12">
          A nonceless registrar voucher-request <span class="bcp14">MAY</span> be
          submitted to the MASA. Doing so allows
          the registrar to request a voucher when the pledge is offline, or
          when the registrar anticipates not being able to connect to the
          MASA
          while the pledge is being deployed. Some use cases require the
          registrar to learn the
          appropriate IDevID serialNumber field and appropriate "Accept" header field values from the physical device
          labeling or from the sales channel (which is out of scope for this
          document).<a class="pilcrow" href="#section-5.5-12">¶</a></p>
<p id="section-5.5-13">All other fields <span class="bcp14">MAY</span> be omitted in the registrar
        voucher-request.<a class="pilcrow" href="#section-5.5-13">¶</a></p>
<p id="section-5.5-14">
          The proximity-registrar-cert field <span class="bcp14">MUST NOT</span> be present in the
          registrar voucher-request.<a class="pilcrow" href="#section-5.5-14">¶</a></p>
<p id="section-5.5-15">See example JSON payloads of registrar voucher-requests in
            <a class="xref" href="#voucher-request-examples">Section 3.3</a>, Examples 2 through 4.<a class="pilcrow" href="#section-5.5-15">¶</a></p>
<p id="section-5.5-16">The MASA verifies that the registrar voucher-request is internally consistent
        but does not necessarily authenticate the registrar certificate since the
        registrar <span class="bcp14">MAY</span> be unknown to the MASA in advance. The MASA
        performs the actions and validation checks described in the following
        subsections before issuing a voucher.<a class="pilcrow" href="#section-5.5-16">¶</a></p>
<section id="section-5.5.1">
          <h4 id="name-masa-renewal-of-expired-vou">
<a class="section-number selfRef" href="#section-5.5.1">5.5.1. </a><a class="section-name selfRef" href="#name-masa-renewal-of-expired-vou">MASA Renewal of Expired Vouchers</a>
          </h4>
<p id="section-5.5.1-1">
            As described in
            <span>[<a class="xref" href="#RFC8366">RFC8366</a>]</span>, vouchers
            are normally short lived to avoid revocation issues. If the request
            is for a previous (expired) voucher using the same registrar
            (that is, a registrar with the same domain CA),
            then the request for
            a renewed voucher <span class="bcp14">SHOULD</span> be automatically authorized. The MASA has
            sufficient information to determine this by examining the request, the registrar
            authentication, and the existing audit-log. The issuance of a renewed voucher is
            logged as detailed in <a class="xref" href="#VoucherResponse">Section 5.6</a>.<a class="pilcrow" href="#section-5.5.1-1">¶</a></p>
<p id="section-5.5.1-2">To inform the MASA that existing vouchers are not to be renewed, one
            can update or revoke the registrar credentials used to authorize the request (see Sections
            <a class="xref" href="#MASAauthenticationOfRegistrar">5.5.4</a> and <a class="xref" href="#revocationcheck">5.5.3</a>). More
            flexible methods will likely involve sales channel integration and
            authorizations (details are out of scope of this document).<a class="pilcrow" href="#section-5.5.1-2">¶</a></p>
</section>
<div id="MASApinned">
<section id="section-5.5.2">
          <h4 id="name-masa-pinning-of-registrar">
<a class="section-number selfRef" href="#section-5.5.2">5.5.2. </a><a class="section-name selfRef" href="#name-masa-pinning-of-registrar">MASA Pinning of Registrar</a>
          </h4>
<p id="section-5.5.2-1">
            A certificate chain is extracted from the registrar's signed CMS container.
            This chain may be as short as a single end-entity certificate, up
            to the entire registrar certificate chain, including the domain
            CA certificate,
            as specified in <a class="xref" href="#RequestVoucherFromMASA">Section 5.5</a>.<a class="pilcrow" href="#section-5.5.2-1">¶</a></p>
<p id="section-5.5.2-2">
            If the domain's CA is unknown to the MASA, then it is
            considered a temporary trust anchor for the rest of the steps
            in this section.  The intention is not to authenticate the
            message as having come from a fully validated origin but
            to establish the consistency of the domain PKI.<a class="pilcrow" href="#section-5.5.2-2">¶</a></p>
<p id="section-5.5.2-3">
            The MASA <span class="bcp14">MAY</span> use the certificate in the chain that is farthest
            from the end-entity certificate of the registrar, as determined by MASA policy.
            A MASA <span class="bcp14">MAY</span> have a local policy in which it only pins the end-entity
            certificate. This is consistent with <span>[<a class="xref" href="#RFC8366">RFC8366</a>]</span>.
            Details of the policy will typically depend upon the degree of
            supply-chain integration and the mechanism used by the registrar to
            authenticate.  Such a policy would also determine how
            the MASA will respond to a request for a nonceless voucher.<a class="pilcrow" href="#section-5.5.2-3">¶</a></p>
</section>
</div>
<div id="revocationcheck">
<section id="section-5.5.3">
          <h4 id="name-masa-check-of-the-voucher-r">
<a class="section-number selfRef" href="#section-5.5.3">5.5.3. </a><a class="section-name selfRef" href="#name-masa-check-of-the-voucher-r">MASA Check of the Voucher-Request Signature</a>
          </h4>
<p id="section-5.5.3-1">
            As described in <a class="xref" href="#MASApinned">Section 5.5.2</a>, the MASA has
            extracted the registrar's domain CA.  This is used to validate the
            CMS signature <span>[<a class="xref" href="#RFC5652">RFC5652</a>]</span> on the voucher-request.<a class="pilcrow" href="#section-5.5.3-1">¶</a></p>
<p id="section-5.5.3-2">
            Normal PKIX revocation
            checking is assumed during voucher-request signature validation.
            This CA certificate <span class="bcp14">MAY</span> have
            Certificate Revocation List (CRL) distribution points or Online
            Certificate Status Protocol (OCSP) information <span>[<a class="xref" href="#RFC6960">RFC6960</a>]</span>.  If they are present, the MASA <span class="bcp14">MUST</span>
            be able to reach the relevant servers belonging to the
            registrar's domain CA to perform the revocation checks.<a class="pilcrow" href="#section-5.5.3-2">¶</a></p>
<p id="section-5.5.3-3">
            The use of OCSP Stapling is preferred.<a class="pilcrow" href="#section-5.5.3-3">¶</a></p>
</section>
</div>
<div id="MASAauthenticationOfRegistrar">
<section id="section-5.5.4">
          <h4 id="name-masa-verification-of-the-do">
<a class="section-number selfRef" href="#section-5.5.4">5.5.4. </a><a class="section-name selfRef" href="#name-masa-verification-of-the-do">MASA Verification of the Domain Registrar</a>
          </h4>
<p id="section-5.5.4-1">
            The MASA <span class="bcp14">MUST</span> verify that the registrar voucher-request is signed
            by a registrar. This is confirmed by verifying that the
            id-kp-cmcRA extended key usage extension field (as detailed in
            EST <span>[<a class="xref" href="#RFC7030">RFC7030</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc7030#section-3.6.1">Section 3.6.1</a></span>) exists in the certificate of the
            entity that signed the registrar voucher-request. This
            verification is only a consistency check to ensure that the unauthenticated
            domain CA intended the voucher-request signer to be a registrar. Performing this check
            provides value to the domain PKI by assuring the domain administrator
            that the MASA service will only respect claims from authorized
            registration authorities of the domain.<a class="pilcrow" href="#section-5.5.4-1">¶</a></p>
<p id="section-5.5.4-2">
            Even when a domain CA is authenticated to the MASA, and there is
            strong sales channel integration to understand who the legitimate
            owner is, the above id-kp-cmcRA check prevents arbitrary end-entity
            certificates (such as an LDevID certificate) from
            having vouchers issued against them.<a class="pilcrow" href="#section-5.5.4-2">¶</a></p>
<p id="section-5.5.4-3">
            Other cases of inappropriate voucher issuance are detected
            by examination of the audit-log.<a class="pilcrow" href="#section-5.5.4-3">¶</a></p>
<p id="section-5.5.4-4">
            If a nonceless voucher-request is submitted, the MASA <span class="bcp14">MUST</span>
            authenticate the registrar either as described in
            EST (see Sections <a class="relref" href="https://www.rfc-editor.org/rfc/rfc7030#section-3.2.3">3.2.3</a> and
<a class="relref" href="https://www.rfc-editor.org/rfc/rfc7030#section-3.3.2">3.3.2</a> of
<span>[<a class="xref" href="#RFC7030">RFC7030</a>]</span>)
            or by validating the registrar's certificate used to
            sign the registrar voucher-request using a configured trust anchor.
            Any of these methods reduce the risk of DDoS attacks
            and provide an authenticated identity as an input to
            sales channel integration and authorizations
            (details are out of scope of this document).<a class="pilcrow" href="#section-5.5.4-4">¶</a></p>
<p id="section-5.5.4-5">
            In the nonced case, validation of the registrar's identity (via
            TLS Client Certificate or HTTP authentication) <span class="bcp14">MAY</span> be omitted
            if the MASA knows that the device policy is to accept audit-only vouchers.<a class="pilcrow" href="#section-5.5.4-5">¶</a></p>
</section>
</div>
<div id="MASAassertion">
<section id="section-5.5.5">
          <h4 id="name-masa-verification-of-the-pl">
<a class="section-number selfRef" href="#section-5.5.5">5.5.5. </a><a class="section-name selfRef" href="#name-masa-verification-of-the-pl">MASA Verification of the Pledge 'prior-signed-voucher-request'</a>
          </h4>
<p id="section-5.5.5-1">
            The MASA <span class="bcp14">MAY</span> verify that the registrar voucher-request
            includes the prior-signed-voucher-request field. If so, the
            prior-signed-voucher-request <span class="bcp14">MUST</span> include a
            proximity-registrar-cert that is consistent with the
            certificate used to sign the registrar voucher-request.
            Additionally, the
            voucher-request serial-number leaf <span class="bcp14">MUST</span> match the pledge
            serial-number that the MASA extracts from the signing certificate
            of the prior-signed-voucher-request.
            The consistency check described above entails checking that the
            proximity-registrar-cert Subject Public Key Info (SPKI) Fingerprint exists within the
            registrar voucher-request CMS signature's certificate chain.
            This is substantially the same as the pin validation described in
            <span>[<a class="xref" href="#RFC7469">RFC7469</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc7469#section-2.6">Section 2.6</a></span>.<a class="pilcrow" href="#section-5.5.5-1">¶</a></p>
<p id="section-5.5.5-2">
            If these checks succeed, the MASA updates
            the voucher and audit-log assertion leafs with the "proximity"
            assertion, as defined by <span>[<a class="xref" href="#RFC8366">RFC8366</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc8366#section-5.3">Section 5.3</a></span>.<a class="pilcrow" href="#section-5.5.5-2">¶</a></p>
</section>
</div>
<div id="MASAnoncehandling">
<section id="section-5.5.6">
          <h4 id="name-masa-nonce-handling">
<a class="section-number selfRef" href="#section-5.5.6">5.5.6. </a><a class="section-name selfRef" href="#name-masa-nonce-handling">MASA Nonce Handling</a>
          </h4>
<p id="section-5.5.6-1">
            The MASA does not verify the nonce itself.
            If the registrar voucher-request contains a nonce, and the
            prior-signed-voucher-request exists, then the MASA <span class="bcp14">MUST</span>
            verify that the nonce is consistent.
            (Recall from above that the
            voucher-request might not contain a nonce; see
            Sections <a class="xref" href="#RequestVoucherFromMASA">5.5</a> and
            <a class="xref" href="#MASAauthenticationOfRegistrar">5.5.4</a>.)<a class="pilcrow" href="#section-5.5.6-1">¶</a></p>
<p id="section-5.5.6-2">
            The MASA populates the audit-log with the nonce that was
            verified. If a nonceless voucher is issued, then the
            audit-log is to be populated with the JSON value "null".<a class="pilcrow" href="#section-5.5.6-2">¶</a></p>
</section>
</div>
</section>
</div>
<div id="VoucherResponse">
<section id="section-5.6">
        <h3 id="name-masa-and-registrar-voucher-">
<a class="section-number selfRef" href="#section-5.6">5.6. </a><a class="section-name selfRef" href="#name-masa-and-registrar-voucher-">MASA and Registrar Voucher Response</a>
        </h3>
<p id="section-5.6-1">The MASA voucher response to the registrar is forwarded
          without changes to the pledge; therefore, this section applies
          to both the MASA and the registrar. The HTTP signaling described
          applies to both the MASA and registrar responses.<a class="pilcrow" href="#section-5.6-1">¶</a></p>
<p id="section-5.6-2">
          When a voucher-request arrives at the registrar, if it has a cached
          response from the MASA for the corresponding registrar
          voucher-request, that cached response can be used according to
          local policy; otherwise, the registrar constructs a new registrar
          voucher-request and sends it to the MASA.<a class="pilcrow" href="#section-5.6-2">¶</a></p>
<p id="section-5.6-3">
          Registrar evaluation of the voucher itself is purely for
          transparency and audit purposes to further inform log verification
          (see <a class="xref" href="#auditLogVerification">Section 5.8.3</a>); therefore, a
          registrar could accept future voucher formats that are opaque to
          the registrar.<a class="pilcrow" href="#section-5.6-3">¶</a></p>
<p id="section-5.6-4">
          If the voucher-request is successful, the server (a MASA responding
          to a registrar or a registrar responding to a pledge) response <span class="bcp14">MUST</span>
          contain an HTTP 200 response code. The server <span class="bcp14">MUST</span> answer with a
          suitable 4xx or 5xx HTTP <span>[<a class="xref" href="#RFC7230">RFC7230</a>]</span> error code when a problem occurs.
          In this case, the response data from the MASA <span class="bcp14">MUST</span> be a plain text
          human-readable (UTF-8) error message containing explanatory
          information describing why the request was rejected.<a class="pilcrow" href="#section-5.6-4">¶</a></p>
<p id="section-5.6-5">
          The registrar <span class="bcp14">MAY</span> respond with an HTTP 202 ("the request has been
          accepted for processing, but the processing has not been completed") as
          described in EST <span>[<a class="xref" href="#RFC7030">RFC7030</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc7030#section-4.2.3">Section 4.2.3</a></span>, wherein the
          client "<span class="bcp14">MUST</span> wait at least the specified "retry-after" time before
          repeating the same request"
          (also see <span>[<a class="xref" href="#RFC7231">RFC7231</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc7231#section-6.6.4">Section 6.6.4</a></span>).
          The pledge is <span class="bcp14">RECOMMENDED</span> to provide local
          feedback (blinked LED, etc.) during this wait cycle if mechanisms for this
          are available. To prevent an attacker registrar from significantly
          delaying bootstrapping, the pledge <span class="bcp14">MUST</span> limit the Retry-After time to
          60 seconds. Ideally, the pledge would keep track of the
          appropriate Retry-After header field values for any number of
          outstanding registrars, but this would involve a state table
          on the pledge.  Instead, the
          pledge <span class="bcp14">MAY</span> ignore the exact Retry-After value in favor of a single hard-coded
          value (a registrar that is unable
          to complete the transaction after the first 60 seconds has another chance a minute later). A pledge <span class="bcp14">SHOULD</span> be willing to maintain a 202 retry-state
          for up to 4 days, which is longer than a long weekend, after which
          time the enrollment attempt fails, and the pledge returns to Discovery state. This allows time for an alert to get from the registrar to a human operator who can make a
  decision as to whether or not to proceed with the enrollment.<a class="pilcrow" href="#section-5.6-5">¶</a></p>
<p id="section-5.6-6">
          A pledge that retries a request after receiving a 202 message <span class="bcp14">MUST</span>
          resend the same voucher-request.  It <span class="bcp14">MUST NOT</span> sign a new
          voucher-request each time, and in particular, it <span class="bcp14">MUST NOT</span> change
          the nonce value.<a class="pilcrow" href="#section-5.6-6">¶</a></p>
<p id="section-5.6-7">
          In order to avoid infinite redirect loops, which a malicious
          registrar might do in order to keep the pledge from
          discovering the correct registrar, the pledge <span class="bcp14">MUST NOT</span>
          follow more than one redirection (3xx code) to another web
          origin. EST supports redirection but requires user
          input; this change allows the pledge to follow a single
          redirection without a user interaction.<a class="pilcrow" href="#section-5.6-7">¶</a></p>
<p id="section-5.6-8">A 403 (Forbidden) response is appropriate if the voucher-request
        is not signed correctly or is stale or if the pledge has another
        outstanding voucher that cannot be overridden.<a class="pilcrow" href="#section-5.6-8">¶</a></p>
<p id="section-5.6-9">A 404 (Not Found) response is appropriate when the request is for a
        device that is not known to the MASA.<a class="pilcrow" href="#section-5.6-9">¶</a></p>
<p id="section-5.6-10">A 406 (Not Acceptable) response is appropriate if a voucher of the
        desired type or that uses the desired algorithms (as indicated by the
        "Accept" header fields and algorithms used in the signature) cannot be
        issued as such because the MASA knows the pledge cannot process
        that type. The registrar <span class="bcp14">SHOULD</span> use this response if it determines
        the pledge is unacceptable due to inventory control, MASA audit-logs, or
        any other reason.<a class="pilcrow" href="#section-5.6-10">¶</a></p>
<p id="section-5.6-11">
          A 415 (Unsupported Media Type) response is appropriate
          for a request that has a voucher-request or "Accept" value that is
          not understood.<a class="pilcrow" href="#section-5.6-11">¶</a></p>
<p id="section-5.6-12">The voucher response format is as indicated in the submitted
        "Accept" header fields or based on the MASA's prior understanding of proper
        format for this pledge. Only the
        "application/voucher-cms+json" media type <span>[<a class="xref" href="#RFC8366">RFC8366</a>]</span> is defined at this
        time. The syntactic details of vouchers are described in detail in
        <span>[<a class="xref" href="#RFC8366">RFC8366</a>]</span>. <a class="xref" href="#voucherjsonexample">Figure 14</a> shows
        a sample of the contents of a voucher.<a class="pilcrow" href="#section-5.6-12">¶</a></p>
<span id="name-an-example-voucher"></span><div id="voucherjsonexample">
<figure id="figure-14">
          <div id="section-5.6-13.1">
<pre class="sourcecode lang-json">{
  "ietf-voucher:voucher": {
    "nonce": "62a2e7693d82fcda2624de58fb6722e5",
    "assertion": "logged",
    "pinned-domain-cert": "base64encodedvalue==",
    "serial-number": "JADA123456789"
  }
}
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-14">Figure 14</a>:
<a class="selfRef" href="#name-an-example-voucher">An Example Voucher</a>
          </figcaption></figure>
</div>
<p id="section-5.6-14">The MASA populates the voucher fields as follows:<a class="pilcrow" href="#section-5.6-14">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.6-15">
          <dt id="section-5.6-15.1">nonce:</dt>
          <dd id="section-5.6-15.2" style="margin-left: 1.5em">The nonce from the pledge if available. See <a class="xref" href="#MASAnoncehandling">Section 5.5.6</a>.<a class="pilcrow" href="#section-5.6-15.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.6-15.3">assertion:</dt>
          <dd id="section-5.6-15.4" style="margin-left: 1.5em">The method used to verify the relationship
        between the pledge and registrar. See <a class="xref" href="#MASAassertion">Section 5.5.5</a>.<a class="pilcrow" href="#section-5.6-15.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.6-15.5">pinned-domain-cert:</dt>
          <dd id="section-5.6-15.6" style="margin-left: 1.5em">A certificate; see <a class="xref" href="#MASApinned">Section 5.5.2</a>. This figure is illustrative; for an example,
        see <a class="xref" href="#exampleprocess">Appendix C.2</a> where an end-entity certificate
        is used.<a class="pilcrow" href="#section-5.6-15.6">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.6-15.7">serial-number:</dt>
          <dd id="section-5.6-15.8" style="margin-left: 1.5em">The serial-number as provided in the
          voucher-request. Also see <a class="xref" href="#MASAassertion">Section 5.5.5</a>.<a class="pilcrow" href="#section-5.6-15.8">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.6-15.9">domain-cert-revocation-checks:</dt>
          <dd id="section-5.6-15.10" style="margin-left: 1.5em">Set as appropriate for the
          pledge's capabilities and as documented in <span>[<a class="xref" href="#RFC8366">RFC8366</a>]</span>.

          The MASA <span class="bcp14">MAY</span> set this field to "false" since setting it to "true" would
          require that revocation information be available to the pledge, and this
          document does not make normative requirements for
          <span>[<a class="xref" href="#RFC6961">RFC6961</a>]</span>, <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8446#section-4.4.2.1">Section 4.4.2.1</a> of [<a class="xref" href="#RFC8446">RFC8446</a>]</span>, or equivalent integrations.<a class="pilcrow" href="#section-5.6-15.10">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.6-15.11">expires-on:</dt>
          <dd id="section-5.6-15.12" style="margin-left: 1.5em">This is set for nonceless vouchers. The MASA
          ensures the voucher lifetime is consistent with any revocation or
          pinned-domain-cert consistency checks the pledge might perform.
          See <a class="xref" href="#timeunknown">Section 2.6.1</a>. There are three times to consider:
          (a) a configured voucher lifetime in the MASA, (b) the expiry time for the
          registrar's certificate, and (c) any CRL lifetime. The expires-on field <span class="bcp14">SHOULD</span> be before
          the earliest of these three values.
          Typically, (b) will be some significant time in the future,
          but (c) will typically be short (on the order of a week or
          less).  The <span class="bcp14">RECOMMENDED</span> period for (a) is on the order of
          20 minutes, so it will typically determine the life span
          of the resulting voucher.
          20 minutes is sufficient time to reach the post-provisional state
          in the pledge, at which point there is an established trust
          relationship between the pledge and registrar.  The subsequent
          operations can take as long as required from that point onwards.
          The lifetime of the voucher has no impact on the life span of the
          ownership relationship.<a class="pilcrow" href="#section-5.6-15.12">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-5.6-16">
          Whenever a voucher is issued, the MASA <span class="bcp14">MUST</span> update the
          audit-log sufficiently to generate the response as described in
          <a class="xref" href="#MASAauditlog">Section 5.8.1</a>.
          The internal state requirements to maintain the audit-log
          are out of scope.<a class="pilcrow" href="#section-5.6-16">¶</a></p>
<div id="CompletingAuthenticationBootstrapping">
<section id="section-5.6.1">
          <h4 id="name-pledge-voucher-verification">
<a class="section-number selfRef" href="#section-5.6.1">5.6.1. </a><a class="section-name selfRef" href="#name-pledge-voucher-verification">Pledge Voucher Verification</a>
          </h4>
<p id="section-5.6.1-1">
          The pledge <span class="bcp14">MUST</span> verify the voucher signature using the
          manufacturer-installed
          trust anchor(s) associated with the manufacturer's MASA (this is
          likely included in the pledge's firmware). Management of the
          manufacturer-installed
          trust anchor(s) is out of scope of this document; this protocol
          does not update this trust anchor(s).<a class="pilcrow" href="#section-5.6.1-1">¶</a></p>
<p id="section-5.6.1-2">
          The pledge <span class="bcp14">MUST</span> verify that the serial-number field of the signed voucher
          matches the pledge's own serial-number.<a class="pilcrow" href="#section-5.6.1-2">¶</a></p>
<p id="section-5.6.1-3">
          The pledge <span class="bcp14">MUST</span>
          verify the nonce information in the voucher.  If present, the nonce in
          the voucher must match the nonce the pledge submitted to the
          registrar; vouchers with no nonce can also be accepted (according
          to local policy; see <a class="xref" href="#pledgeReductions">Section 7.2</a>).<a class="pilcrow" href="#section-5.6.1-3">¶</a></p>
<p id="section-5.6.1-4">
          The pledge <span class="bcp14">MUST</span> be prepared to parse and fail gracefully from
          a voucher response that does not contain a pinned-domain-cert
          field.
          Such a thing indicates a failure to enroll in this domain,
          and the pledge <span class="bcp14">MUST</span> attempt joining with other available Join Proxies.<a class="pilcrow" href="#section-5.6.1-4">¶</a></p>
<p id="section-5.6.1-5">
          The pledge <span class="bcp14">MUST</span> be prepared to ignore additional fields that it does not recognize.<a class="pilcrow" href="#section-5.6.1-5">¶</a></p>
</section>
</div>
<div id="PledgeAuthenticationOfProvisionalTLS">
<section id="section-5.6.2">
          <h4 id="name-pledge-authentication-of-pr">
<a class="section-number selfRef" href="#section-5.6.2">5.6.2. </a><a class="section-name selfRef" href="#name-pledge-authentication-of-pr">Pledge Authentication of Provisional TLS Connection</a>
          </h4>
<p id="section-5.6.2-1">
            Following the process described in <span>[<a class="xref" href="#RFC8366">RFC8366</a>]</span>,
            the pledge should consider the public key from the
            pinned-domain-cert as the sole temporary trust anchor.<a class="pilcrow" href="#section-5.6.2-1">¶</a></p>
<p id="section-5.6.2-2">
            The pledge then evaluates the TLS server certificate chain that it
            received when the TLS connection was formed using this trust
            anchor.
            It is possible that the public key in the pinned-domain-cert directly matches
     the public key in the end-entity
            certificate provided by the TLS server.<a class="pilcrow" href="#section-5.6.2-2">¶</a></p>
<p id="section-5.6.2-3">
            If a registrar's credentials cannot be verified using the
            pinned-domain-cert trust anchor from the voucher, then the TLS
            connection is
            discarded, and the pledge abandons attempts to bootstrap with this
            discovered registrar. The pledge <span class="bcp14">SHOULD</span> send voucher status
            telemetry (described below) before closing the TLS connection.
            The pledge <span class="bcp14">MUST</span> attempt to enroll using any other proxies
            it has found.  It <span class="bcp14">SHOULD</span> return to the same proxy again after
            unsuccessful attempts with other proxies.  Attempts should be
            made at repeated intervals according to the back-off timer
            described earlier.
            Attempts <span class="bcp14">SHOULD</span> be repeated as failure may be the result of a
            temporary inconsistency (an inconsistently rolled registrar key,
            or some other misconfiguration).  The inconsistency could also
            be the result of an active MITM attack on the EST connection.<a class="pilcrow" href="#section-5.6.2-3">¶</a></p>
<p id="section-5.6.2-4"> The registrar <span class="bcp14">MUST</span> use a certificate that chains to the pinned-domain-cert
            as its TLS server certificate.<a class="pilcrow" href="#section-5.6.2-4">¶</a></p>
<p id="section-5.6.2-5">The pledge's PKIX path validation of a registrar certificate's validity
            period information is as described in <a class="xref" href="#timeunknown">Section 2.6.1</a>.
            Once the PKIX path validation is successful, the TLS connection is
            no longer provisional.<a class="pilcrow" href="#section-5.6.2-5">¶</a></p>
<p id="section-5.6.2-6">The pinned-domain-cert <span class="bcp14">MAY</span> be installed as a
            trust anchor for future operations such as enrollment (e.g., as recommended per <span>[<a class="xref" href="#RFC7030">RFC7030</a>]</span>) or trust anchor management or raw protocols that do not need full PKI-based key management. It can be used to authenticate any dynamically
            discovered EST server that contains the id-kp-cmcRA extended key
            usage extension as detailed in EST (see <span>[<a class="xref" href="#RFC7030">RFC7030</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc7030#section-3.6.1">Section 3.6.1</a></span>); but to
            reduce system complexity, the pledge <span class="bcp14">SHOULD</span> avoid additional
            discovery operations. Instead, the pledge <span class="bcp14">SHOULD</span> communicate directly
            with the registrar as the EST server. The pinned-domain-cert
            is not a complete
            distribution of the CA certificate response, as described in <span>[<a class="xref" href="#RFC7030">RFC7030</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc7030#section-4.1.3">Section 4.1.3</a></span>,
            which is
            an additional justification for the recommendation to proceed with EST
            key management operations. Once a full CA certificate response is
            obtained, it is more authoritative for the domain than the limited
            pinned-domain-cert response.<a class="pilcrow" href="#section-5.6.2-6">¶</a></p>
</section>
</div>
</section>
</div>
<div id="pledgestatus">
<section id="section-5.7">
        <h3 id="name-pledge-brski-status-telemet">
<a class="section-number selfRef" href="#section-5.7">5.7. </a><a class="section-name selfRef" href="#name-pledge-brski-status-telemet">Pledge BRSKI Status Telemetry</a>
        </h3>
<p id="section-5.7-1">The domain is expected to provide indications to the system
        administrators concerning device life-cycle status. To facilitate this,
        it needs telemetry information concerning the device's
        status.<a class="pilcrow" href="#section-5.7-1">¶</a></p>
<p id="section-5.7-2">The pledge <span class="bcp14">MUST</span> indicate its pledge status regarding the voucher.
        It does this by sending a status message to the registrar.<a class="pilcrow" href="#section-5.7-2">¶</a></p>
<p id="section-5.7-3">The posted data media type: application/json<a class="pilcrow" href="#section-5.7-3">¶</a></p>
<p id="section-5.7-4">The client sends an HTTP POST to the server at the URI ".well-known/brski/voucher_status".<a class="pilcrow" href="#section-5.7-4">¶</a></p>
<p id="section-5.7-5">
          The format and semantics described below are for version 1.
          A version field is included to permit significant changes to this
          feedback in the future.  A registrar that receives a status
          message with a version larger than it knows about <span class="bcp14">SHOULD</span> log the
          contents and alert a human.<a class="pilcrow" href="#section-5.7-5">¶</a></p>
<p id="section-5.7-6">The status field indicates if the voucher was acceptable.
        Boolean values are acceptable, where "true" indicates the voucher was
        acceptable.<a class="pilcrow" href="#section-5.7-6">¶</a></p>
<p id="section-5.7-7">
          If the voucher was not acceptable, the Reason string indicates
          why. In a failure case, this message may be sent to an
          unauthenticated, potentially malicious registrar; therefore, the
          Reason string <span class="bcp14">SHOULD NOT</span> provide information beneficial to an
          attacker. The operational benefit of this telemetry information is
          balanced against the operational costs of not recording that a
          voucher was ignored by a client that the registrar expected was going to continue
          joining the domain.<a class="pilcrow" href="#section-5.7-7">¶</a></p>
<p id="section-5.7-8">
          The reason-context attribute is an arbitrary JSON object (literal
          value or hash of values) that provides additional information
          specific to this pledge.  The contents of this field are not
          subject to standardization.<a class="pilcrow" href="#section-5.7-8">¶</a></p>
<p id="section-5.7-9">
          The version and status fields <span class="bcp14">MUST</span> be present.
          The Reason field <span class="bcp14">SHOULD</span> be present whenever the status field
          is false.  The Reason-Context field is optional.
   In the case of a SUCCESS, the Reason string <span class="bcp14">MAY</span> be omitted.<a class="pilcrow" href="#section-5.7-9">¶</a></p>
<p id="section-5.7-10">
          The keys to this JSON object are case sensitive and <span class="bcp14">MUST</span> be lowercase.
          <a class="xref" href="#telemetryexample">Figure 16</a> shows an example JSON.<a class="pilcrow" href="#section-5.7-10">¶</a></p>
<span id="name-cddl-for-voucher-status-pos"></span><div id="cddl-voucherstatus">
<figure id="figure-15">
          <div id="section-5.7-11.1">
<pre class="sourcecode lang-CDDL">&lt;CODE BEGINS&gt; file "voucherstatus.cddl"

voucherstatus-post = {
    "version": uint,
    "status": bool,
    ? "reason": text,
    ? "reason-context" : { $$arbitrary-map }
  }
}

&lt;CODE ENDS&gt;</pre>
</div>
<figcaption><a class="selfRef" href="#figure-15">Figure 15</a>:
<a class="selfRef" href="#name-cddl-for-voucher-status-pos">CDDL for Voucher Status POST</a>
          </figcaption></figure>
</div>
<span id="name-example-status-telemetry"></span><div id="telemetryexample">
<figure id="figure-16">
          <div id="section-5.7-12.1">
<pre class="sourcecode lang-json">{
    "version": 1,
    "status":false,
    "reason":"Informative human-readable message",
    "reason-context": { "additional" : "JSON" }
}
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-16">Figure 16</a>:
<a class="selfRef" href="#name-example-status-telemetry">Example Status Telemetry</a>
          </figcaption></figure>
</div>
<p id="section-5.7-13">
          The server <span class="bcp14">SHOULD</span> respond with an HTTP 200 but <span class="bcp14">MAY</span> simply
          fail with an HTTP 404 error. The client ignores any response. The server <span class="bcp14">SHOULD</span> capture this telemetry information within the server logs.<a class="pilcrow" href="#section-5.7-13">¶</a></p>
<p id="section-5.7-14">
          Additional standard JSON fields in this POST <span class="bcp14">MAY</span> be added; see
          <a class="xref" href="#pledgestatustelemetryregistry">Section 8.5</a>.  A server that
          sees unknown fields should log them, but otherwise ignore them.<a class="pilcrow" href="#section-5.7-14">¶</a></p>
</section>
</div>
<div id="authzLogRequest">
<section id="section-5.8">
        <h3 id="name-registrar-audit-log-request">
<a class="section-number selfRef" href="#section-5.8">5.8. </a><a class="section-name selfRef" href="#name-registrar-audit-log-request">Registrar Audit-Log Request</a>
        </h3>
<p id="section-5.8-1">
           After receiving the pledge status telemetry (see <a class="xref" href="#pledgestatus">Section 5.7</a>),
           the registrar <span class="bcp14">SHOULD</span> request the MASA audit-log from the MASA
        service.<a class="pilcrow" href="#section-5.8-1">¶</a></p>
<p id="section-5.8-2">
          This is done with an HTTP POST using the operation path value of
          "/.well-known/brski/requestauditlog".<a class="pilcrow" href="#section-5.8-2">¶</a></p>
<p id="section-5.8-3">
          The registrar <span class="bcp14">SHOULD</span> HTTP POST the same registrar voucher-request
          as it did when requesting a
          voucher (using the same Content-Type). It is posted to the /requestauditlog URI instead.
          The idevid-issuer and serial-number informs the MASA
          which log is requested, so the appropriate log can be prepared
          for the response.
          Using the same media type and message minimizes
          cryptographic and message operations, although it results in additional
          network traffic.
          The relying MASA implementation <span class="bcp14">MAY</span> leverage internal state
          to associate this request with the original, and by now already
          validated, voucher-request so as to avoid an extra crypto
          validation.<a class="pilcrow" href="#section-5.8-3">¶</a></p>
<p id="section-5.8-4">
          A registrar <span class="bcp14">MAY</span> request logs at future times. If the registrar
          generates a new request, then the MASA is forced to perform
          the additional cryptographic operations to verify the new request.<a class="pilcrow" href="#section-5.8-4">¶</a></p>
<p id="section-5.8-5">
          A MASA that receives a request for a device that does not exist,
          or for which the requesting owner was never an owner, returns an
          HTTP 404 ("Not found") code.<a class="pilcrow" href="#section-5.8-5">¶</a></p>
<p id="section-5.8-6">
          It is reasonable for a registrar, that the MASA does not believe
          to be the current owner, to request the audit-log.  There are
          probably reasons for this, which are hard to predict in advance.
          For instance, such a registrar may not be aware that the device has
          been resold; it may be that the device has been resold
          inappropriately, and this is how the original owner will learn of
          the occurrence.  It is also possible that the device legitimately
          spends time in two different networks.<a class="pilcrow" href="#section-5.8-6">¶</a></p>
<p id="section-5.8-7">
          Rather than returning the audit-log as a response to the POST (with
          a return code 200), the MASA <span class="bcp14">MAY</span> instead return a 201 ("Created")
          response (<span>[<a class="xref" href="#RFC7231">RFC7231</a>]</span>, Sections
<a class="relref" href="https://www.rfc-editor.org/rfc/rfc7231#section-6.3.2">6.3.2</a> and <a class="relref" href="https://www.rfc-editor.org/rfc/rfc7231#section-7.1">7.1</a>), with
          the URL to the prepared (and idempotent, therefore cachable) audit
          response in the "Location" header field.<a class="pilcrow" href="#section-5.8-7">¶</a></p>
<p id="section-5.8-8">
          In order to avoid enumeration of device audit-logs,
          a MASA that returns URLs <span class="bcp14">SHOULD</span> take care to make the returned
          URL unguessable.
          <span>[<a class="xref" href="#W3C.capability-urls">W3C.capability-urls</a>]</span> provides very good additional guidance.
          For instance, rather than returning URLs containing a database number
          such as https://example.com/auditlog/1234 or the Extended Unique Identifier (EUI) of the device
          such https://example.com/auditlog/10-00-00-11-22-33,
          the MASA <span class="bcp14">SHOULD</span> return a randomly generated value (a "slug" in
          web parlance).  The value is used to find the relevant database
          entry.<a class="pilcrow" href="#section-5.8-8">¶</a></p>
<p id="section-5.8-9">
          A MASA that returns a code 200 <span class="bcp14">MAY</span> also include a "Location" header
          for future reference by the registrar.<a class="pilcrow" href="#section-5.8-9">¶</a></p>
<div id="MASAauditlog">
<section id="section-5.8.1">
          <h4 id="name-masa-audit-log-response">
<a class="section-number selfRef" href="#section-5.8.1">5.8.1. </a><a class="section-name selfRef" href="#name-masa-audit-log-response">MASA Audit-Log Response</a>
          </h4>
<p id="section-5.8.1-1">A log data file is returned consisting of all log entries
          associated with the device selected by the IDevID presented in
          the request.  The audit-log may be abridged by removal of old or repeated
          values as explained below.
          The returned data is in JSON format <span>[<a class="xref" href="#RFC8259">RFC8259</a>]</span>,
          and the Content-Type <span class="bcp14">SHOULD</span> be "application/json".<a class="pilcrow" href="#section-5.8.1-1">¶</a></p>
<p id="section-5.8.1-2">
            The following CDDL <span>[<a class="xref" href="#RFC8610">RFC8610</a>]</span> explains the
            structure of the JSON format audit-log response:<a class="pilcrow" href="#section-5.8.1-2">¶</a></p>
<span id="name-cddl-for-audit-log-response"></span><div id="cddl-auditlog">
<figure id="figure-17">
            <div id="section-5.8.1-3.1">
<pre class="sourcecode lang-CDDL">&lt;CODE BEGINS&gt; file "auditlog.cddl"

audit-log-response = {
  "version": uint,
  "events": [ + event ]
  "truncation": {
    ? "nonced duplicates": uint,
    ? "nonceless duplicates": uint,
    ? "arbitrary": uint,
  }
}

event = {
  "date": text,
  "domainID": text,
  "nonce": text / null,
  "assertion": "verified" / "logged" / "proximity",
  ? "truncated": uint,
}

&lt;CODE ENDS&gt;</pre>
</div>
<figcaption><a class="selfRef" href="#figure-17">Figure 17</a>:
<a class="selfRef" href="#name-cddl-for-audit-log-response">CDDL for Audit-Log Response</a>
            </figcaption></figure>
</div>
<p id="section-5.8.1-4">An example:<a class="pilcrow" href="#section-5.8.1-4">¶</a></p>
<span id="name-example-of-an-audit-log-res"></span><div id="example-auditlog">
<figure id="figure-18">
            <div id="section-5.8.1-5.1">
<pre class="sourcecode lang-json">{
  "version":"1",
  "events":[
    {
        "date":"2019-05-15T17:25:55.644-04:00",
        "domainID":"BduJhdHPpfhQLyponf48JzXSGZ8=",
        "nonce":"VOUFT-WwrEv0NuAQEHoV7Q",
        "assertion":"proximity",
        "truncated":"0"
    },
    {
        "date":"2017-05-15T17:25:55.644-04:00",
        "domainID":"BduJhdHPpfhQLyponf48JzXSGZ8=",
        "nonce":"f4G6Vi1t8nKo/FieCVgpBg==",
        "assertion":"proximity"
    }
  ],
    "truncation": {
        "nonced duplicates": "0",
        "nonceless duplicates": "1",
        "arbitrary": "2"
     }
}
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-18">Figure 18</a>:
<a class="selfRef" href="#name-example-of-an-audit-log-res">Example of an Audit-Log Response</a>
            </figcaption></figure>
</div>
<p id="section-5.8.1-6">
            The domainID is a binary SubjectKeyIdentifier value calculated
            according to <a class="xref" href="#domainID">Section 5.8.2</a>.
            It is encoded once in base64 in order to be transported in this
            JSON container.<a class="pilcrow" href="#section-5.8.1-6">¶</a></p>
<p id="section-5.8.1-7">
            The date is formatted per <span>[<a class="xref" href="#RFC3339">RFC3339</a>]</span>, which is
            consistent with typical JavaScript usage of JSON.<a class="pilcrow" href="#section-5.8.1-7">¶</a></p>
<p id="section-5.8.1-8">
            The truncation structure <span class="bcp14">MAY</span> be omitted if all values are zero.
            Any counter missing from the truncation structure is
            assumed to be zero.<a class="pilcrow" href="#section-5.8.1-8">¶</a></p>
<p id="section-5.8.1-9">
            The nonce is a string, as provided in the voucher-request, and
            is used in the voucher.   If no nonce was placed in the resulting
            voucher, then a value of null <span class="bcp14">SHOULD</span> be used in preference to
            omitting the entry.
            While the nonce is often created as a base64-encoded random
            series of bytes, this should not be assumed.<a class="pilcrow" href="#section-5.8.1-9">¶</a></p>
<p id="section-5.8.1-10">
            Distribution of a large log is less than ideal. This structure can
            be optimized as follows: nonced or nonceless entries for the
            same domainID <span class="bcp14">MAY</span> be abridged from the log leaving only the single
            most recent nonced or nonceless entry for that domainID. In the case of
            truncation, the "event" truncation value <span class="bcp14">SHOULD</span> contain a count of the number of events for this
            domainID that were omitted. The log <span class="bcp14">SHOULD NOT</span> be further
            reduced, but an operational situation could exist where maintaining
            the full log is not possible. In such situations, the log <span class="bcp14">MAY</span> be
            arbitrarily abridged for length, with the number of removed
            entries indicated as "arbitrary".<a class="pilcrow" href="#section-5.8.1-10">¶</a></p>
<p id="section-5.8.1-11">
            If the truncation count exceeds 1024, then the MASA
            <span class="bcp14">MAY</span> use this value without further incrementing it.<a class="pilcrow" href="#section-5.8.1-11">¶</a></p>
<p id="section-5.8.1-12">
            A log where duplicate entries for the same domain have
            been omitted ("nonced duplicates" and/or "nonceless duplicates")
            could still be acceptable for informed decisions. A log that
            has had "arbitrary" truncations is less acceptable, but manufacturer
            transparency is better than hidden truncations.<a class="pilcrow" href="#section-5.8.1-12">¶</a></p>
<p id="section-5.8.1-13">
            A registrar that sees a version value greater than 1 indicates
            an audit-log format that has been enhanced with additional
            information.   No information will be removed in future
            versions; should an incompatible change be desired in the future,
            then a new HTTP endpoint will be used.<a class="pilcrow" href="#section-5.8.1-13">¶</a></p>
<p id="section-5.8.1-14">This document
            specifies a simple log format as provided by the
            MASA service to the registrar. This format could be improved by
            distributed consensus technologies that integrate vouchers
            with technologies such as block-chain or hash trees or optimized
            logging approaches. Doing so is out of the scope of this document
            but is an
            anticipated improvement for future work.  As such, the
            registrar <span class="bcp14">SHOULD</span> anticipate new kinds of responses and
            <span class="bcp14">SHOULD</span> provide operator controls to indicate how to process
            unknown responses.<a class="pilcrow" href="#section-5.8.1-14">¶</a></p>
</section>
</div>
<div id="domainID">
<section id="section-5.8.2">
          <h4 id="name-calculation-of-domainid">
<a class="section-number selfRef" href="#section-5.8.2">5.8.2. </a><a class="section-name selfRef" href="#name-calculation-of-domainid">Calculation of domainID</a>
          </h4>
<p id="section-5.8.2-1">
            The domainID is a binary value (a BIT STRING) that uniquely
            identifies a registrar by the pinned-domain-cert.<a class="pilcrow" href="#section-5.8.2-1">¶</a></p>
<p id="section-5.8.2-2">
            If the pinned-domain-cert certificate
            includes the SubjectKeyIdentifier (<span>[<a class="xref" href="#RFC5280">RFC5280</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc5280#section-4.2.1.2">Section 4.2.1.2</a></span>), then it is used as the domainID.  If not,
            the SPKI Fingerprint as described in
            <span>[<a class="xref" href="#RFC7469">RFC7469</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc7469#section-2.4">Section 2.4</a></span> is used.
            This value needs to be calculated by both the MASA (to
            populate the audit-log) and the registrar (to recognize itself in the audit-log).<a class="pilcrow" href="#section-5.8.2-2">¶</a></p>
<p id="section-5.8.2-3">
            <span>[<a class="xref" href="#RFC5280">RFC5280</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc5280#section-4.2.1.2">Section 4.2.1.2</a></span> does not mandate that the
            SubjectKeyIdentifier extension be present in non-CA certificates.
            It is <span class="bcp14">RECOMMENDED</span> that registrar certificates (even if
            self-signed) always include the SubjectKeyIdentifier to be
            used as a domainID.<a class="pilcrow" href="#section-5.8.2-3">¶</a></p>
<p id="section-5.8.2-4">
            The domainID is determined
            from the certificate chain associated with the
            pinned-domain-cert and is used to update the audit-log.<a class="pilcrow" href="#section-5.8.2-4">¶</a></p>
</section>
</div>
<div id="auditLogVerification">
<section id="section-5.8.3">
          <h4 id="name-registrar-audit-log-verific">
<a class="section-number selfRef" href="#section-5.8.3">5.8.3. </a><a class="section-name selfRef" href="#name-registrar-audit-log-verific">Registrar Audit-Log Verification</a>
          </h4>
<p id="section-5.8.3-1">
            Each time the MASA
            issues a voucher, it appends details of the assignment to
            an internal audit-log for that device.
            The internal audit-log is processed when responding to
            requests for details as described in <a class="xref" href="#authzLogRequest">Section 5.8</a>.
            The contents of the audit-log can express a variety of trust
            levels, and this section explains what kind of trust a
            registrar can derive from the entries.<a class="pilcrow" href="#section-5.8.3-1">¶</a></p>
<p id="section-5.8.3-2">
            While the audit-log provides a list of vouchers that were issued
            by the MASA, the vouchers are issued in response to
            voucher-requests, and it is the content of the voucher-requests
            that determines how meaningful the audit-log entries are.<a class="pilcrow" href="#section-5.8.3-2">¶</a></p>
<p id="section-5.8.3-3">A registrar <span class="bcp14">SHOULD</span> use the log information to make an informed decision
          regarding the continued bootstrapping of the pledge. The exact policy is
          out of scope of this document as it depends on the security requirements
          within the registrar domain. Equipment that is purchased preowned can be
          expected to have an extensive history.  The following discussion is provided to help
          explain the value of each log element:<a class="pilcrow" href="#section-5.8.3-3">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.8.3-4">
            <dt id="section-5.8.3-4.1">date:</dt>
            <dd id="section-5.8.3-4.2" style="margin-left: 1.5em">The date field provides the registrar an
              opportunity to divide the log around known events such as
              the purchase date. Depending on the context known to the registrar
              or administrator, events before/after certain dates can
              have different levels of importance. For example, for equipment
              that is expected to be new, and thus has no history, it
            would be a surprise to find prior entries.<a class="pilcrow" href="#section-5.8.3-4.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.8.3-4.3">domainID:</dt>
            <dd id="section-5.8.3-4.4" style="margin-left: 1.5em"> If the log includes an unexpected domainID,
              then the pledge could have imprinted on an unexpected domain. The
              registrar can be expected to use a variety of techniques to
              define "unexpected" ranging from acceptlists of prior
              domains to anomaly detection (e.g., "this device was previously
              bound to a different domain than any other device deployed"). Log
              entries can also be compared against local history logs in search of
              discrepancies (e.g., "this device was re-deployed some number of times
              internally, but the external audit-log shows additional re-deployments
              our internal logs are unaware of").<a class="pilcrow" href="#section-5.8.3-4.4">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.8.3-4.5">nonce:</dt>
            <dd id="section-5.8.3-4.6" style="margin-left: 1.5em">Nonceless entries mean the logged domainID could
              theoretically trigger a reset of the pledge and then take over management
              by using the existing nonceless voucher.<a class="pilcrow" href="#section-5.8.3-4.6">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.8.3-4.7">assertion:</dt>
            <dd id="section-5.8.3-4.8" style="margin-left: 1.5em">The assertion leaf in the voucher and
            audit-log indicates why the MASA issued the voucher.
              A "verified" entry means that
              the MASA issued the associated voucher as a result of positive
              verification of ownership.
              However, this entry does not indicate whether or not the pledge was
              actually deployed in the prior domain.
              A "logged" assertion informs
              the registrar that the prior vouchers were issued with
              minimal verification. A "proximity" assertion
              assures the registrar that the pledge was truly communicating
              with the prior domain and thus provides assurance that the
              prior domain really has deployed the pledge.<a class="pilcrow" href="#section-5.8.3-4.8">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-5.8.3-5">
            A relatively simple policy is to acceptlist known (internal or
            external) domainIDs and require all vouchers to have a nonce.
            An alternative is to require that all nonceless vouchers be from a
            subset (e.g., only internal) of domainIDs.
            If the policy is violated, a simple action is to revoke any
            locally issued credentials for the pledge in question or to
            refuse to forward the voucher.  The registrar <span class="bcp14">MUST</span> then refuse
            any EST actions and <span class="bcp14">SHOULD</span> inform a human via a log.
            A registrar <span class="bcp14">MAY</span> be configured to ignore (i.e., override the above
            policy) the
            history of the device, but it is <span class="bcp14">RECOMMENDED</span> that this only be
            configured if hardware-assisted (i.e., Transport Performance Metrics (TPM) anchored) Network
            Endpoint Assessment (NEA) <span>[<a class="xref" href="#RFC5209">RFC5209</a>]</span> is supported.<a class="pilcrow" href="#section-5.8.3-5">¶</a></p>
</section>
</div>
</section>
</div>
<div id="ESTintegration">
<section id="section-5.9">
        <h3 id="name-est-integration-for-pki-boo">
<a class="section-number selfRef" href="#section-5.9">5.9. </a><a class="section-name selfRef" href="#name-est-integration-for-pki-boo">EST Integration for PKI Bootstrapping</a>
        </h3>
<p id="section-5.9-1">The pledge <span class="bcp14">SHOULD</span> follow the BRSKI operations with EST enrollment operations
        including "CA Certificates Request", "CSR Attributes Request", and "Client Certificate Request"
        or "Server-Side Key Generation", etc. This is a relatively seamless integration
        since BRSKI API calls provide an automated alternative to the manual bootstrapping method
        described in <span>[<a class="xref" href="#RFC7030">RFC7030</a>]</span>. As noted above, use of HTTP-persistent
        connections simplifies the pledge state machine.<a class="pilcrow" href="#section-5.9-1">¶</a></p>
<p id="section-5.9-2">
          Although EST allows clients to obtain multiple certificates by sending
          multiple Certificate Signing Requests (CSRs), BRSKI does not support this mechanism directly.
          This is because BRSKI pledges <span class="bcp14">MUST</span> use the CSR Attributes request
          (<span>[<a class="xref" href="#RFC7030">RFC7030</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc7030#section-4.5">Section 4.5</a></span>).
          The registrar <span class="bcp14">MUST</span> validate the CSR against the expected
          attributes. This implies that client requests will "look the same"
          and therefore result in a single logical certificate being issued
          even if the client were to make multiple requests. Registrars <span class="bcp14">MAY</span>
          contain more complex logic, but doing so is out of scope of this
          specification.
          BRSKI does not signal any enhancement or restriction to this
          capability.<a class="pilcrow" href="#section-5.9-2">¶</a></p>
<section id="section-5.9.1">
          <h4 id="name-est-distribution-of-ca-cert">
<a class="section-number selfRef" href="#section-5.9.1">5.9.1. </a><a class="section-name selfRef" href="#name-est-distribution-of-ca-cert">EST Distribution of CA Certificates</a>
          </h4>
<p id="section-5.9.1-1">The pledge <span class="bcp14">SHOULD</span> request the full EST Distribution of CA
          certificate messages; see <span>[<a class="xref" href="#RFC7030">RFC7030</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc7030#section-4.1">Section 4.1</a></span>.<a class="pilcrow" href="#section-5.9.1-1">¶</a></p>
<p id="section-5.9.1-2">This ensures that the pledge has the complete set of current CA
          certificates beyond the pinned-domain-cert (see <a class="xref" href="#PledgeAuthenticationOfProvisionalTLS">Section 5.6.2</a> for a discussion of the
          limitations inherent in having a single certificate instead of a full
          CA certificate response). Although these limitations are acceptable during initial bootstrapping, they are not appropriate for ongoing PKIX end-entity certificate validation.<a class="pilcrow" href="#section-5.9.1-2">¶</a></p>
</section>
<div id="csrattributes">
<section id="section-5.9.2">
          <h4 id="name-est-csr-attributes">
<a class="section-number selfRef" href="#section-5.9.2">5.9.2. </a><a class="section-name selfRef" href="#name-est-csr-attributes">EST CSR Attributes</a>
          </h4>
<p id="section-5.9.2-1">Automated bootstrapping occurs without local administrative
          configuration of the pledge. In some deployments, it is plausible that
          the pledge generates a certificate request containing only identity
          information known to the pledge (essentially the X.509 IDevID information)
          and ultimately receives a certificate containing domain-specific
          identity information. Conceptually, the CA has complete control over
          all fields issued in the end-entity certificate. Realistically, this
          is operationally difficult with the current status of PKI
          CA deployments, where the CSR is submitted to the
          CA via a number of non-standard protocols. Even with all
          standardized protocols used, it could operationally be problematic
          to expect that service-specific certificate fields can be created
          by a CA that is likely operated by a group that has no insight
          into different network services/protocols used. For example, the
          CA could even be outsourced.<a class="pilcrow" href="#section-5.9.2-1">¶</a></p>
<p id="section-5.9.2-2">To alleviate these operational difficulties, the pledge <span class="bcp14">MUST</span>
          request the
          EST "CSR Attributes" from the EST server, and the EST server needs
          to be able to reply with the attributes necessary for use of
          the certificate in its intended protocols/services. This approach
          allows for minimal CA integrations, and instead,
          the local infrastructure (EST server) informs the pledge of the proper
          fields to include in the generated CSR (such as rfc822Name).
          This approach is beneficial
          to automated bootstrapping in the widest number of environments.<a class="pilcrow" href="#section-5.9.2-2">¶</a></p>
<p id="section-5.9.2-3">
            In networks using the BRSKI enrolled certificate to authenticate
            the ACP, the EST CSR Attributes <span class="bcp14">MUST</span> include
            the ACP domain information fields defined in
            <span>[<a class="xref" href="#RFC8994">RFC8994</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc8994#section-6.2.2">Section 6.2.2</a></span>.<a class="pilcrow" href="#section-5.9.2-3">¶</a></p>
<p id="section-5.9.2-4">The registrar <span class="bcp14">MUST</span> also confirm that the resulting CSR is formatted as
          indicated before forwarding the request to a CA. If the registrar is
          communicating with the CA using a protocol such as full Certificate Management over CMS (CMC), which
          provides mechanisms to override the CSR Attributes, then these
          mechanisms <span class="bcp14">MAY</span> be used even if the client ignores the guidance for the CSR Attributes.<a class="pilcrow" href="#section-5.9.2-4">¶</a></p>
</section>
</div>
<section id="section-5.9.3">
          <h4 id="name-est-client-certificate-requ">
<a class="section-number selfRef" href="#section-5.9.3">5.9.3. </a><a class="section-name selfRef" href="#name-est-client-certificate-requ">EST Client Certificate Request</a>
          </h4>
<p id="section-5.9.3-1">The pledge <span class="bcp14">MUST</span> request a new Client
Certificate; see <span>[<a class="xref" href="#RFC7030">RFC7030</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc7030#section-4.2">Section 4.2</a></span>.<a class="pilcrow" href="#section-5.9.3-1">¶</a></p>
</section>
<section id="section-5.9.4">
          <h4 id="name-enrollment-status-telemetry">
<a class="section-number selfRef" href="#section-5.9.4">5.9.4. </a><a class="section-name selfRef" href="#name-enrollment-status-telemetry">Enrollment Status Telemetry</a>
          </h4>
<p id="section-5.9.4-1">
            For automated bootstrapping of devices, the administrative elements
            that provide bootstrapping also provide indications to the system
            administrators concerning device life-cycle status.
            This might include information concerning attempted bootstrapping
            messages seen by the client.
            The MASA provides logs and the status of credential
            enrollment.
            Since an end user is assumed per <span>[<a class="xref" href="#RFC7030">RFC7030</a>]</span>, a final success indication back to the server is not included. This is
            insufficient for automated use cases.<a class="pilcrow" href="#section-5.9.4-1">¶</a></p>
<p id="section-5.9.4-2">
            The client <span class="bcp14">MUST</span> send an indicator to the registrar about its
            enrollment status.  It does this by using an HTTP POST of
            a JSON dictionary with the attributes described below to
            the new EST endpoint at "/.well-known/brski/enrollstatus".<a class="pilcrow" href="#section-5.9.4-2">¶</a></p>
<p id="section-5.9.4-3">
            When indicating a successful enrollment, the client <span class="bcp14">SHOULD</span> first
            re-establish the EST TLS session using the newly obtained
            credentials. TLS 1.3 supports doing this in-band, but
            TLS 1.2 does not.  The client <span class="bcp14">SHOULD</span> therefore always close the existing
            TLS connection and start a new one, using the same Join Proxy.<a class="pilcrow" href="#section-5.9.4-3">¶</a></p>
<p id="section-5.9.4-4">
            In the case of a failed enrollment, the client <span class="bcp14">MUST</span> send the
            telemetry information over the same TLS
            connection that was used for the enrollment attempt, with a
            Reason string indicating why the most recent enrollment failed.
            (For failed attempts, the TLS connection is the most reliable way
            to correlate server-side information with what the client provides.)<a class="pilcrow" href="#section-5.9.4-4">¶</a></p>
<p id="section-5.9.4-5">
            The version and status fields <span class="bcp14">MUST</span> be present.  The Reason field <span class="bcp14">SHOULD</span> be present
            whenever the status field is false.
            In the case of a SUCCESS, the Reason string <span class="bcp14">MAY</span> be omitted.<a class="pilcrow" href="#section-5.9.4-5">¶</a></p>
<p id="section-5.9.4-6">
            The reason-context attribute is an arbitrary JSON object (literal
            value or hash of values) that provides additional information
            specific to the failure to unroll from this pledge.
            The contents of this field are not subject to
            standardization. This is represented by the group-socket
            "$$arbitrary-map" in the CDDL.<a class="pilcrow" href="#section-5.9.4-6">¶</a></p>
<span id="name-cddl-for-enrollment-status-"></span><div id="cddl-enrollstatus">
<figure id="figure-19">
            <div id="section-5.9.4-7.1">
<pre class="sourcecode lang-CDDL">&lt;CODE BEGINS&gt; file "enrollstatus.cddl"

enrollstatus-post = {
    "version": uint,
    "status": bool,
    ? "reason": text,
    ? "reason-context" : { $$arbitrary-map }
  }
}

&lt;CODE ENDS&gt;</pre>
</div>
<figcaption><a class="selfRef" href="#figure-19">Figure 19</a>:
<a class="selfRef" href="#name-cddl-for-enrollment-status-">CDDL for Enrollment Status POST</a>
            </figcaption></figure>
</div>
<p id="section-5.9.4-8">
            An example status report can be seen below.  It is sent with
            the media type: application/json<a class="pilcrow" href="#section-5.9.4-8">¶</a></p>
<span id="name-example-of-enrollment-statu"></span><div id="example-enrollstatus">
<figure id="figure-20">
            <div id="section-5.9.4-9.1">
<pre class="sourcecode lang-json">{
    "version": 1,
    "status":true,
    "reason":"Informative human readable message",
    "reason-context": { "additional" : "JSON" }
}
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-20">Figure 20</a>:
<a class="selfRef" href="#name-example-of-enrollment-statu">Example of Enrollment Status POST</a>
            </figcaption></figure>
</div>
<p id="section-5.9.4-10">The server <span class="bcp14">SHOULD</span> respond with an HTTP 200 but <span class="bcp14">MAY</span> simply fail
          with an HTTP 404 error.<a class="pilcrow" href="#section-5.9.4-10">¶</a></p>
<p id="section-5.9.4-11">
            Within the server logs, the server <span class="bcp14">MUST</span> capture if this message
            was received over a TLS session with a matching Client
            Certificate.<a class="pilcrow" href="#section-5.9.4-11">¶</a></p>
</section>
<section id="section-5.9.5">
          <h4 id="name-multiple-certificates">
<a class="section-number selfRef" href="#section-5.9.5">5.9.5. </a><a class="section-name selfRef" href="#name-multiple-certificates">Multiple Certificates</a>
          </h4>
<p id="section-5.9.5-1">
            Pledges that require multiple certificates could establish
            direct EST connections to the registrar.<a class="pilcrow" href="#section-5.9.5-1">¶</a></p>
</section>
<section id="section-5.9.6">
          <h4 id="name-est-over-coap">
<a class="section-number selfRef" href="#section-5.9.6">5.9.6. </a><a class="section-name selfRef" href="#name-est-over-coap">EST over CoAP</a>
          </h4>
<p id="section-5.9.6-1">This document describes extensions to EST for the purpose
              of bootstrapping remote key infrastructures.
              Bootstrapping is relevant for CoAP enrollment
              discussions as well. The definition of EST and BRSKI over CoAP is not
              discussed within this document beyond ensuring proxy support for
              CoAP operations. Instead, it is anticipated that a definition of
              CoAP mappings will occur in subsequent documents such as
              <span>[<a class="xref" href="#I-D.ietf-ace-coap-est">ACE-COAP-EST</a>]</span> and that
              CoAP mappings for BRSKI will be discussed either there or
              in future work.<a class="pilcrow" href="#section-5.9.6-1">¶</a></p>
</section>
</section>
</div>
</section>
</div>
<div id="estbase64">
<section id="section-6">
      <h2 id="name-clarification-of-transfer-e">
<a class="section-number selfRef" href="#section-6">6. </a><a class="section-name selfRef" href="#name-clarification-of-transfer-e">Clarification of Transfer-Encoding</a>
      </h2>
<p id="section-6-1">
        <span>[<a class="xref" href="#RFC7030">RFC7030</a>]</span> defines endpoints to include a
        "Content-Transfer-Encoding" heading and payloads to be
         base64-encoded DER <span>[<a class="xref" href="#RFC4648">RFC4648</a>]</span>.<a class="pilcrow" href="#section-6-1">¶</a></p>
<p id="section-6-2">
        When used within BRSKI, the original EST endpoints remain
        base64 encoded <span>[<a class="xref" href="#RFC7030">RFC7030</a>]</span> (as clarified by <span>[<a class="xref" href="#RFC8951">RFC8951</a>]</span>), but the new BRSKI endpoints that send and receive binary
        artifacts (specifically, "/.well-known/brski/requestvoucher") are
        binary. That is, no encoding is used.<a class="pilcrow" href="#section-6-2">¶</a></p>
<p id="section-6-3">
        In the BRSKI context, the EST "Content-Transfer-Encoding" header
        field <span class="bcp14">SHOULD</span> be ignored if present. This header field does not need
        to be included.<a class="pilcrow" href="#section-6-3">¶</a></p>
</section>
</div>
<div id="reducedsecuritymodes">
<section id="section-7">
      <h2 id="name-reduced-security-operationa">
<a class="section-number selfRef" href="#section-7">7. </a><a class="section-name selfRef" href="#name-reduced-security-operationa">Reduced Security Operational Modes</a>
      </h2>
<p id="section-7-1">
        A common requirement of bootstrapping is to support less secure operational
        modes for support-specific use cases.  This section suggests a range of
        mechanisms that would alter the security assurance of BRSKI to accommodate
        alternative deployment architectures and mitigate life-cycle management issues
        identified in <a class="xref" href="#privacyconsiderations">Section 10</a>.  They are presented here as informative
        (non-normative) design guidance for future standardization
        activities.
        <a class="xref" href="#acpapplicability">Section 9</a> provides standardization applicability statements
        for the ANIMA ACP. Other users
        would expect that subsets of these mechanisms could be profiled with
        accompanying applicability statements similar to the one described in
        <a class="xref" href="#acpapplicability">Section 9</a>.<a class="pilcrow" href="#section-7-1">¶</a></p>
<p id="section-7-2">
        This section is considered non-normative in the generality of the
        protocol.  Use of the suggested mechanisms here <span class="bcp14">MUST</span> be detailed in
        specific profiles of BRSKI, such as in <a class="xref" href="#acpapplicability">Section 9</a>.<a class="pilcrow" href="#section-7-2">¶</a></p>
<section id="section-7.1">
        <h3 id="name-trust-model">
<a class="section-number selfRef" href="#section-7.1">7.1. </a><a class="section-name selfRef" href="#name-trust-model">Trust Model</a>
        </h3>
<p id="section-7.1-1">
        This section explains the trust relationships detailed in <a class="xref" href="#flow">Section 2.4</a>:<a class="pilcrow" href="#section-7.1-1">¶</a></p>
<span id="name-elements-of-brski-trust-mod"></span><figure id="figure-21">
          <div class="artwork art-text alignLeft" id="section-7.1-2.1">
<pre>+--------+         +---------+    +------------+     +------------+
| Pledge |         | Join    |    | Domain     |     |Manufacturer|
|        |         | Proxy   |    | Registrar  |     | Service    |
|        |         |         |    |            |     | (Internet) |
+--------+         +---------+    +------------+     +------------+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-21">Figure 21</a>:
<a class="selfRef" href="#name-elements-of-brski-trust-mod">Elements of BRSKI Trust Model</a>
          </figcaption></figure>
<span class="break"></span><dl class="dlParallel" id="section-7.1-3">
          <dt id="section-7.1-3.1">Pledge:</dt>
          <dd id="section-7.1-3.2" style="margin-left: 1.5em">The pledge could be compromised and
            provide an attack vector for malware. The entity is trusted to
            only imprint using secure methods described in this document.
            Additional endpoint assessment techniques are <span class="bcp14">RECOMMENDED</span> but are
            out of scope of this document.<a class="pilcrow" href="#section-7.1-3.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-7.1-3.3">Join Proxy:</dt>
          <dd id="section-7.1-3.4" style="margin-left: 1.5em">Provides proxy functionalities but is not
            involved in security considerations.<a class="pilcrow" href="#section-7.1-3.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-7.1-3.5">Registrar:</dt>
          <dd id="section-7.1-3.6" style="margin-left: 1.5em">When interacting with a MASA, a
            registrar makes all decisions. For Ownership Audit Vouchers (see <span>[<a class="xref" href="#RFC8366">RFC8366</a>]</span>), the registrar is provided an opportunity to
            accept MASA decisions.<a class="pilcrow" href="#section-7.1-3.6">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-7.1-3.7">Vendor Service, MASA:</dt>
          <dd id="section-7.1-3.8" style="margin-left: 1.5em">This form of manufacturer service is
            trusted to accurately log all claim attempts and to provide
            authoritative log information to registrars. The MASA does not
            know which devices are associated with which domains. These claims
            could be strengthened by using cryptographic log techniques to
            provide append only, cryptographic assured, publicly auditable
            logs.<a class="pilcrow" href="#section-7.1-3.8">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-7.1-3.9">Vendor Service, Ownership Validation:</dt>
          <dd id="section-7.1-3.10" style="margin-left: 1.5em">This form of
            manufacturer service is trusted to accurately know which device is owned
            by which domain.<a class="pilcrow" href="#section-7.1-3.10">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
<div id="pledgeReductions">
<section id="section-7.2">
        <h3 id="name-pledge-security-reductions">
<a class="section-number selfRef" href="#section-7.2">7.2. </a><a class="section-name selfRef" href="#name-pledge-security-reductions">Pledge Security Reductions</a>
        </h3>
<p id="section-7.2-1">
          The following is a list of alternative behaviors that the
          pledge can be programmed to implement.  These behaviors are not
          mutually exclusive, nor are they dependent upon each other.
          Some of these methods enable offline and emergency (touch-based)
          deployment use cases.  Normative language is used as these behaviors
          are referenced in later sections in a normative fashion.<a class="pilcrow" href="#section-7.2-1">¶</a></p>
<ol class="normal type-1" id="section-7.2-2" start="1" type="1">
          <li id="section-7.2-2.1">
                The pledge <span class="bcp14">MUST</span> accept nonceless vouchers. This allows for
                a use case where the registrar cannot connect to the MASA
                at the deployment time.
                Logging and validity periods address the
                security considerations of supporting these use cases.<a class="pilcrow" href="#section-7.2-2.1">¶</a>
</li>
          <li id="section-7.2-2.2">
                Many devices already support "trust on first use" for
                physical interfaces such as console ports. This document does
                not change that reality. Devices supporting this protocol
                <span class="bcp14">MUST NOT</span> support "trust on first use" on network
                interfaces. This is because "trust on first use" over network
                interfaces would undermine the logging based security
                protections provided by this specification.<a class="pilcrow" href="#section-7.2-2.2">¶</a>
</li>
          <li id="section-7.2-2.3">
                The pledge <span class="bcp14">MAY</span> have an operational mode where it skips voucher
                validation one time, for example, if a physical button is
                depressed during the bootstrapping operation. This can be
                useful if the manufacturer service is unavailable. This
                behavior <span class="bcp14">SHOULD</span> be available via local configuration or
                physical presence methods (such as use of a serial/craft
                console) to ensure new entities can always be deployed even
                when autonomic methods fail. This allows for unsecured
                imprint.<a class="pilcrow" href="#section-7.2-2.3">¶</a>
</li>
          <li id="section-7.2-2.4">
                A craft/serial console could include a command such as
                "est-enroll [2001:db8:0:1]:443" that begins the
                EST process from the point after the voucher is validated.
                This process <span class="bcp14">SHOULD</span> include server certificate verification using
                an on-screen fingerprint.<a class="pilcrow" href="#section-7.2-2.4">¶</a>
</li>
        </ol>
<p id="section-7.2-3">It is <span class="bcp14">RECOMMENDED</span> that "trust on first use" or any method of skipping voucher
        validation (including use of a craft serial console) only be available if hardware-assisted Network Endpoint
        Assessment (NEA) <span>[<a class="xref" href="#RFC5209">RFC5209</a>]</span>
        is supported. This recommendation ensures that domain network monitoring
        can detect inappropriate use of offline or emergency
        deployment procedures when voucher-based bootstrapping is not used.<a class="pilcrow" href="#section-7.2-3">¶</a></p>
</section>
</div>
<section id="section-7.3">
        <h3 id="name-registrar-security-reductio">
<a class="section-number selfRef" href="#section-7.3">7.3. </a><a class="section-name selfRef" href="#name-registrar-security-reductio">Registrar Security Reductions</a>
        </h3>
<p id="section-7.3-1">
          A registrar can choose to accept devices using less secure methods.
          They <span class="bcp14">MUST NOT</span> be the default behavior.
          These methods may be acceptable in situations where threat
          models indicate that low security is adequate.
          This includes situations where security decisions are being made by
          the local administrator:<a class="pilcrow" href="#section-7.3-1">¶</a></p>
<ol class="normal type-1" id="section-7.3-2" start="1" type="1">

          <li id="section-7.3-2.1">A registrar <span class="bcp14">MAY</span> choose to accept all devices, or all devices of
          a particular type. The administrator could make this choice in cases where it
          is operationally difficult to configure the registrar with the unique
          identifier of each new device expected.<a class="pilcrow" href="#section-7.3-2.1">¶</a>
</li>
          <li id="section-7.3-2.2">A registrar <span class="bcp14">MAY</span> choose to accept devices that claim a unique
            identity without the benefit of authenticating that claimed
            identity. This could occur when the pledge does not include an
            X.509 IDevID factory-installed credential. New entities without an
            X.509 IDevID credential <span class="bcp14">MAY</span> form the request per <a class="xref" href="#RequestVoucherFromRegistrar">Section 5.2</a> using the
            format per <a class="xref" href="#RequestVoucherFromMASA">Section 5.5</a> to ensure the
            pledge's serial number information is provided to the registrar
            (this includes the IDevID AuthorityKeyIdentifier value, which would
            be statically configured on the pledge). The pledge <span class="bcp14">MAY</span> refuse to
            provide a TLS Client Certificate (as one is not available). The
            pledge <span class="bcp14">SHOULD</span> support HTTP-based or certificate-less TLS
            authentication as described in EST <span>[<a class="xref" href="#RFC7030">RFC7030</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc7030#section-3.3.2">Section 3.3.2</a></span>. A
            registrar <span class="bcp14">MUST NOT</span> accept unauthenticated new entities unless it
            has been configured to do so by an administrator that has verified
            that only expected new entities can communicate with a registrar
            (presumably via a physically secured perimeter.)<a class="pilcrow" href="#section-7.3-2.2">¶</a>
</li>
          <li id="section-7.3-2.3">A registrar <span class="bcp14">MAY</span> submit a nonceless voucher-request to the MASA
            service (by not including a nonce in the voucher-request). The resulting
            vouchers can then be stored by the registrar until
            they are needed during bootstrapping operations. This is for use
            cases where the target network is protected by an air gap and
            therefore cannot contact the MASA service during pledge
            deployment.<a class="pilcrow" href="#section-7.3-2.3">¶</a>
</li>
          <li id="section-7.3-2.4">
              A registrar <span class="bcp14">MAY</span> ignore unrecognized nonceless log
              entries. This could occur when used equipment is purchased with a
              valid history of being deployed in air gap networks that
              required offline vouchers.<a class="pilcrow" href="#section-7.3-2.4">¶</a>
</li>
          <li id="section-7.3-2.5">A registrar <span class="bcp14">MAY</span> accept voucher formats of future types that
              cannot be parsed by the registrar. This reduces the registrar's
              visibility into the exact voucher contents but does not change
              the protocol operations.<a class="pilcrow" href="#section-7.3-2.5">¶</a>
</li>
        </ol>
</section>
<div id="masasecurityreductions">
<section id="section-7.4">
        <h3 id="name-masa-security-reductions">
<a class="section-number selfRef" href="#section-7.4">7.4. </a><a class="section-name selfRef" href="#name-masa-security-reductions">MASA Security Reductions</a>
        </h3>
<p id="section-7.4-1">
          Lower security modes chosen by the MASA service affect all device
          deployments unless the lower security behavior is tied to specific
          device identities.
          The modes described below can be applied to specific devices
          via knowledge of what devices were sold.  They can also be
          bound to specific customers (independent of the device identity) by
          authenticating  the customer's registrar.<a class="pilcrow" href="#section-7.4-1">¶</a></p>
<div id="masasecurityreduction_nonce">
<section id="section-7.4.1">
          <h4 id="name-issuing-nonceless-vouchers">
<a class="section-number selfRef" href="#section-7.4.1">7.4.1. </a><a class="section-name selfRef" href="#name-issuing-nonceless-vouchers">Issuing Nonceless Vouchers</a>
          </h4>
<p id="section-7.4.1-1">
            A MASA has the option of not including a nonce in the voucher
            and/or not requiring one to be present in the voucher-request. This
            results in distribution of a voucher that may never expire and, in
            effect, makes the specified domain an always trusted entity to the
            pledge during any subsequent bootstrapping attempts. The log information captures when
            a nonceless voucher is issued so that the registrar
            can make appropriate security decisions when a pledge joins the
            domain. Nonceless vouchers are useful to support use cases where registrars might
            not be online during actual device deployment.<a class="pilcrow" href="#section-7.4.1-1">¶</a></p>
<p id="section-7.4.1-2">
            While a nonceless voucher may include an expiry date, a typical
            use for a nonceless voucher is for it to be long lived.  If
            the device can be trusted to have an accurate clock (the MASA
            will know), then a nonceless voucher CAN be issued with a limited
            lifetime.<a class="pilcrow" href="#section-7.4.1-2">¶</a></p>
<p id="section-7.4.1-3">
            A more typical case for a nonceless voucher is for use with
            offline onboarding scenarios where it is not possible to pass
            a fresh voucher-request to the MASA.  The use of a long-lived
            voucher also eliminates concern about the availability of the
            MASA many years in the future.  Thus, many nonceless vouchers
            will have no expiry dates.<a class="pilcrow" href="#section-7.4.1-3">¶</a></p>
<p id="section-7.4.1-4">
            Thus, the long-lived nonceless voucher does not require proof
            that the device is online.  Issuing such a thing is only accepted
            when the registrar is authenticated by the MASA and the
            MASA is authorized to provide this functionality to this
            customer.
            The MASA is <span class="bcp14">RECOMMENDED</span> to use this
            functionality only in concert with an enhanced level of ownership
            tracking, the details of which are out of scope for this document.<a class="pilcrow" href="#section-7.4.1-4">¶</a></p>
<p id="section-7.4.1-5">
            If the pledge device is known to have
            a real-time clock that is set from the factory, use of a voucher
            validity period is <span class="bcp14">RECOMMENDED</span>.<a class="pilcrow" href="#section-7.4.1-5">¶</a></p>
</section>
</div>
<div id="masasecurityreduction_tofu">
<section id="section-7.4.2">
          <h4 id="name-trusting-owners-on-first-us">
<a class="section-number selfRef" href="#section-7.4.2">7.4.2. </a><a class="section-name selfRef" href="#name-trusting-owners-on-first-us">Trusting Owners on First Use</a>
          </h4>
<p id="section-7.4.2-1">
            A MASA has the option of not verifying ownership before
            responding with a voucher.
            This is expected to be a common operational model because
            doing so relieves the manufacturer providing MASA services from
            having to track ownership during shipping and throughout the
     supply chain, and it allows
            for a very low overhead MASA service.
     A registrar uses the audit-log
            information as an in-depth defense strategy to ensure that this
            does not occur unexpectedly (for example, when purchasing new
            equipment, the registrar would throw an error if any audit-log
            information is reported). The MASA <span class="bcp14">SHOULD</span> verify the
            prior-signed-voucher-request information for pledges that support
            that functionality. This provides a proof-of-proximity
            check that reduces the need for ownership verification.  The
            proof-of-proximity comes from the assumption that the pledge and
            Join Proxy are on the same link-local connection.<a class="pilcrow" href="#section-7.4.2-1">¶</a></p>
<p id="section-7.4.2-2">
            A MASA that practices TOFU for registrar
            identity may wish to annotate the origin of the connection
            by IP address or netblock and restrict future use of that
            identity from other locations.  A MASA that does this <span class="bcp14">SHOULD</span>
            take care to not create nuisance situations for itself when
            a customer has multiple registrars or uses outgoing IPv4-to-IPv4 NAT (NAT44)
            connections that change frequently.<a class="pilcrow" href="#section-7.4.2-2">¶</a></p>
</section>
</div>
<div id="masasecurityreduction_newanchor">
<section id="section-7.4.3">
          <h4 id="name-updating-or-extending-vouch">
<a class="section-number selfRef" href="#section-7.4.3">7.4.3. </a><a class="section-name selfRef" href="#name-updating-or-extending-vouch">Updating or Extending Voucher Trust Anchors</a>
          </h4>
<p id="section-7.4.3-1">
            This section deals with two problems: A MASA that is no longer available due to
     a failed business and a MASA that is uncooperative to a secondary sale.<a class="pilcrow" href="#section-7.4.3-1">¶</a></p>
<p id="section-7.4.3-2">
            A manufacturer could offer a management mechanism that allows the
            list of voucher verification trust anchors to be extended.
            <span>[<a class="xref" href="#I-D.ietf-netconf-keystore">YANG-KEYSTORE</a>]</span> describes one such interface
            that could be implemented using YANG.  Pretty much any
            configuration mechanism used today could be extended to
            provide the needed additional update.
            A manufacturer could even decide to install the domain CA
            trust anchors received during the EST "cacerts" step as voucher
            verification anchors. Some additional signals will be needed to
            clearly identify which keys have voucher validation authority from
            among those signed by the domain CA. This is future work.<a class="pilcrow" href="#section-7.4.3-2">¶</a></p>
<p id="section-7.4.3-3">
            With the above change to the list of anchors, vouchers can be
            issued by an alternate MASA.  This could be the previous owner
            (the seller) or some other trusted third party who is mediating
            the sale.  If it is a third party, the seller would need
            to take steps to introduce the third-party configuration to
            the device prior to disconnection.  The third party
            (e.g., a wholesaler of used equipment) could, however,
            use a mechanism described in <a class="xref" href="#pledgeReductions">Section 7.2</a>
            to take control of the device after receiving it physically.
            This would permit the third party to act as the MASA for future
            onboarding actions.  As the IDevID certificate probably cannot
            be replaced, the new owner's registrar would have to support
            an override of the MASA URL.<a class="pilcrow" href="#section-7.4.3-3">¶</a></p>
<p id="section-7.4.3-4">
            To be useful for resale or other transfers of ownership, one of
            two situations will need to occur.  The simplest is that the
            device is not put through any kind of factory default/reset
            before going through onboarding again.  Some other secure, physical
            signal would be needed to initiate it.  This is most suitable for
            redeploying a device within the same enterprise.  This would
            entail having previous configuration in the system until entirely
            replaced by the new owner, and it represents some level of risk.<a class="pilcrow" href="#section-7.4.3-4">¶</a></p>
<p id="section-7.4.3-5">
            For the second scenario, there would need to be two levels
            of factory reset.  One would take the system back entirely to
            manufacturer state, including removing any added trust anchors,
            and the other (more commonly used) one would just restore the
            configuration back to a known default without erasing trust
            anchors.  This weaker factory reset might leave valuable
            credentials on the device, and this may be unacceptable to
            some owners.<a class="pilcrow" href="#section-7.4.3-5">¶</a></p>
<p id="section-7.4.3-6">
            As a third option, the manufacturer's trust anchors could be
            entirely overwritten with local trust anchors.  A factory default
            would never restore those anchors.  This option comes with a lot
            of power but is also a lot of responsibility: if access to
            the private part of the new anchors
            are lost, the manufacturer may be unable to help.<a class="pilcrow" href="#section-7.4.3-6">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<section id="section-8">
      <h2 id="name-iana-considerations">
<a class="section-number selfRef" href="#section-8">8. </a><a class="section-name selfRef" href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<p id="section-8-1">Per this document, IANA has completed the following actions.<a class="pilcrow" href="#section-8-1">¶</a></p>
<section id="section-8.1">
        <h3 id="name-the-ietf-xml-registry">
<a class="section-number selfRef" href="#section-8.1">8.1. </a><a class="section-name selfRef" href="#name-the-ietf-xml-registry">The IETF XML Registry</a>
        </h3>
<p id="section-8.1-1">
          This document registers a URI in the "IETF XML
          Registry" <span>[<a class="xref" href="#RFC3688">RFC3688</a>]</span>.
          IANA has registered the following:<a class="pilcrow" href="#section-8.1-1">¶</a></p>
<span class="break"></span><dl class="dlParallel dlCompact" id="section-8.1-2">
          <dt id="section-8.1-2.1">URI:</dt>
          <dd id="section-8.1-2.2" style="margin-left: 1.5em">urn:ietf:params:xml:ns:yang:ietf-voucher-request<a class="pilcrow" href="#section-8.1-2.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-8.1-2.3">Registrant Contact:</dt>
          <dd id="section-8.1-2.4" style="margin-left: 1.5em">The ANIMA WG of the IETF.<a class="pilcrow" href="#section-8.1-2.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-8.1-2.5">XML:</dt>
          <dd id="section-8.1-2.6" style="margin-left: 1.5em">N/A; the requested URI is an XML namespace.<a class="pilcrow" href="#section-8.1-2.6">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
<section id="section-8.2">
        <h3 id="name-yang-module-names-registry">
<a class="section-number selfRef" href="#section-8.2">8.2. </a><a class="section-name selfRef" href="#name-yang-module-names-registry">YANG Module Names Registry</a>
        </h3>
<p id="section-8.2-1">
          This document registers a YANG module in the
          "YANG Module Names" registry <span>[<a class="xref" href="#RFC6020">RFC6020</a>]</span>.
          IANA has registered the following:<a class="pilcrow" href="#section-8.2-1">¶</a></p>
<span class="break"></span><dl class="dlParallel dlCompact" id="section-8.2-2">
          <dt id="section-8.2-2.1">Name:</dt>
          <dd id="section-8.2-2.2" style="margin-left: 1.5em">ietf-voucher-request<a class="pilcrow" href="#section-8.2-2.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-8.2-2.3">Namespace:</dt>
          <dd id="section-8.2-2.4" style="margin-left: 1.5em">urn:ietf:params:xml:ns:yang:ietf-voucher-request<a class="pilcrow" href="#section-8.2-2.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-8.2-2.5">Prefix:</dt>
          <dd id="section-8.2-2.6" style="margin-left: 1.5em">vch<a class="pilcrow" href="#section-8.2-2.6">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-8.2-2.7">Reference:</dt>
          <dd id="section-8.2-2.8" style="margin-left: 1.5em">RFC 8995<a class="pilcrow" href="#section-8.2-2.8">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
<section id="section-8.3">
        <h3 id="name-brski-well-known-considerat">
<a class="section-number selfRef" href="#section-8.3">8.3. </a><a class="section-name selfRef" href="#name-brski-well-known-considerat">BRSKI Well-Known Considerations</a>
        </h3>
<section id="section-8.3.1">
          <h4 id="name-brski-well-known-registrati">
<a class="section-number selfRef" href="#section-8.3.1">8.3.1. </a><a class="section-name selfRef" href="#name-brski-well-known-registrati">BRSKI .well-known Registration</a>
          </h4>
<p id="section-8.3.1-1">
            To the "Well-Known URIs" registry at
            <span><a href="https://www.iana.org/assignments/well-known-uris/">https://www.iana.org/assignments/well-known-uris/</a></span>,
            this document registers the well-known name "brski" with the
            following filled-in template from <span>[<a class="xref" href="#RFC8615">RFC8615</a>]</span>:<a class="pilcrow" href="#section-8.3.1-1">¶</a></p>
<span class="break"></span><dl class="dlParallel dlCompact" id="section-8.3.1-2">
            <dt id="section-8.3.1-2.1">URI Suffix:</dt>
            <dd id="section-8.3.1-2.2" style="margin-left: 1.5em">brski<a class="pilcrow" href="#section-8.3.1-2.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-8.3.1-2.3">Change Controller:</dt>
            <dd id="section-8.3.1-2.4" style="margin-left: 1.5em">IETF<a class="pilcrow" href="#section-8.3.1-2.4">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-8.3.1-3">
            IANA has changed the registration of "est" to now only
            include <span>[<a class="xref" href="#RFC7030">RFC7030</a>]</span> and no longer this document.
            Earlier draft versions of this document used "/.well-known/est" rather
            than "/.well-known/brski".<a class="pilcrow" href="#section-8.3.1-3">¶</a></p>
</section>
<section id="section-8.3.2">
          <h4 id="name-brski-well-known-registry">
<a class="section-number selfRef" href="#section-8.3.2">8.3.2. </a><a class="section-name selfRef" href="#name-brski-well-known-registry">BRSKI .well-known Registry</a>
          </h4>
<p id="section-8.3.2-1">
            IANA has created a new registry entitled: "BRSKI Well-Known URIs".
            The registry has three columns:  URI, Description, and Reference.
            New items can be added using the Specification Required <span>[<a class="xref" href="#RFC8126">RFC8126</a>]</span> process.
            The initial contents of this registry are:<a class="pilcrow" href="#section-8.3.2-1">¶</a></p>
<span id="name-brski-well-known-uris"></span><div id="table_IANA">
<table class="center" id="table-1">
            <caption>
<a class="selfRef" href="#table-1">Table 1</a>:
<a class="selfRef" href="#name-brski-well-known-uris">BRSKI Well-Known URIs</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" colspan="1" rowspan="1">URI</th>
                <th class="text-left" colspan="1" rowspan="1">Description</th>
                <th class="text-left" colspan="1" rowspan="1">Reference</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">requestvoucher</td>
                <td class="text-left" colspan="1" rowspan="1">pledge to registrar, and from registrar to MASA</td>
                <td class="text-left" colspan="1" rowspan="1">RFC 8995</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">voucher_status</td>
                <td class="text-left" colspan="1" rowspan="1">pledge to registrar</td>
                <td class="text-left" colspan="1" rowspan="1">RFC 8995</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">requestauditlog</td>
                <td class="text-left" colspan="1" rowspan="1">registrar to MASA</td>
                <td class="text-left" colspan="1" rowspan="1">RFC 8995</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">enrollstatus</td>
                <td class="text-left" colspan="1" rowspan="1">pledge to registrar</td>
                <td class="text-left" colspan="1" rowspan="1">RFC 8995</td>
              </tr>
            </tbody>
          </table>
</div>
</section>
</section>
<section id="section-8.4">
        <h3 id="name-pkix-registry">
<a class="section-number selfRef" href="#section-8.4">8.4. </a><a class="section-name selfRef" href="#name-pkix-registry">PKIX Registry</a>
        </h3>
<p id="section-8.4-1">IANA has registered the following:<a class="pilcrow" href="#section-8.4-1">¶</a></p>
<p id="section-8.4-2">
          a number for id-mod-MASAURLExtn2016(96)
          from the pkix(7) id-mod(0) Registry.<a class="pilcrow" href="#section-8.4-2">¶</a></p>
<p id="section-8.4-3">
          IANA has assigned a number from the id-pe registry
          (Structure of Management Information (SMI) Security for PKIX Certificate Extension) for id-pe-masa-url
          with the value 32, resulting in an OID of 1.3.6.1.5.5.7.1.32.<a class="pilcrow" href="#section-8.4-3">¶</a></p>
</section>
<div id="pledgestatustelemetryregistry">
<section id="section-8.5">
        <h3 id="name-pledge-brski-status-telemetr">
<a class="section-number selfRef" href="#section-8.5">8.5. </a><a class="section-name selfRef" href="#name-pledge-brski-status-telemetr">Pledge BRSKI Status Telemetry</a>
        </h3>
<p id="section-8.5-1">
          IANA has created a new registry entitled "BRSKI
          Parameters" and has created, within that registry, a table called:
          "Pledge BRSKI Status Telemetry Attributes".
          New items can be added using the
          Specification Required process.  The following items are in the
          initial registration, with this document (see <a class="xref" href="#pledgestatus">Section 5.7</a>) as the reference:<a class="pilcrow" href="#section-8.5-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.5-2.1">version<a class="pilcrow" href="#section-8.5-2.1">¶</a>
</li>
          <li class="normal" id="section-8.5-2.2">Status<a class="pilcrow" href="#section-8.5-2.2">¶</a>
</li>
          <li class="normal" id="section-8.5-2.3">Reason<a class="pilcrow" href="#section-8.5-2.3">¶</a>
</li>
          <li class="normal" id="section-8.5-2.4">reason-context<a class="pilcrow" href="#section-8.5-2.4">¶</a>
</li>
        </ul>
</section>
</div>
<section id="section-8.6">
        <h3 id="name-dns-service-names">
<a class="section-number selfRef" href="#section-8.6">8.6. </a><a class="section-name selfRef" href="#name-dns-service-names">DNS Service Names</a>
        </h3>
<p id="section-8.6-1">IANA has registered the following service names:<a class="pilcrow" href="#section-8.6-1">¶</a></p>
<span class="break"></span><dl class="dlParallel dlCompact" id="section-8.6-2">
          <dt id="section-8.6-2.1">Service Name:</dt>
          <dd id="section-8.6-2.2" style="margin-left: 1.5em">brski-proxy<a class="pilcrow" href="#section-8.6-2.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-8.6-2.3">Transport Protocol(s):</dt>
          <dd id="section-8.6-2.4" style="margin-left: 1.5em">tcp<a class="pilcrow" href="#section-8.6-2.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-8.6-2.5">Assignee:</dt>
          <dd id="section-8.6-2.6" style="margin-left: 1.5em">IESG &lt;iesg@ietf.org&gt;<a class="pilcrow" href="#section-8.6-2.6">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-8.6-2.7">Contact:</dt>
          <dd id="section-8.6-2.8" style="margin-left: 1.5em">IESG &lt;iesg@ietf.org&gt;<a class="pilcrow" href="#section-8.6-2.8">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-8.6-2.9">Description:</dt>
          <dd id="section-8.6-2.10" style="margin-left: 1.5em">The Bootstrapping Remote Secure Key Infrastructure
Proxy<a class="pilcrow" href="#section-8.6-2.10">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-8.6-2.11">Reference:</dt>
          <dd id="section-8.6-2.12" style="margin-left: 1.5em">RFC 8995<a class="pilcrow" href="#section-8.6-2.12">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="dlParallel dlCompact" id="section-8.6-3">
          <dt id="section-8.6-3.1">Service Name:</dt>
          <dd id="section-8.6-3.2" style="margin-left: 1.5em">brski-registrar<a class="pilcrow" href="#section-8.6-3.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-8.6-3.3">Transport Protocol(s):</dt>
          <dd id="section-8.6-3.4" style="margin-left: 1.5em">tcp<a class="pilcrow" href="#section-8.6-3.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-8.6-3.5">Assignee:</dt>
          <dd id="section-8.6-3.6" style="margin-left: 1.5em">IESG &lt;iesg@ietf.org&gt;<a class="pilcrow" href="#section-8.6-3.6">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-8.6-3.7">Contact:</dt>
          <dd id="section-8.6-3.8" style="margin-left: 1.5em">IESG &lt;iesg@ietf.org&gt;<a class="pilcrow" href="#section-8.6-3.8">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-8.6-3.9">Description:</dt>
          <dd id="section-8.6-3.10" style="margin-left: 1.5em">The Bootstrapping Remote Secure Key Infrastructure
Registrar<a class="pilcrow" href="#section-8.6-3.10">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-8.6-3.11">Reference:</dt>
          <dd id="section-8.6-3.12" style="margin-left: 1.5em">RFC 8995<a class="pilcrow" href="#section-8.6-3.12">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
<section id="section-8.7">
        <h3 id="name-grasp-objective-names">
<a class="section-number selfRef" href="#section-8.7">8.7. </a><a class="section-name selfRef" href="#name-grasp-objective-names">GRASP Objective Names</a>
        </h3>
<p id="section-8.7-1">IANA has registered the following GRASP Objective
        Names:<a class="pilcrow" href="#section-8.7-1">¶</a></p>
<p id="section-8.7-2">
          IANA has registered the value "AN_Proxy" (without quotes)
          to the "GRASP Objective Names" table in the GRASP Parameter registry.
          The specification for this value is <a class="xref" href="#brskigrasp">Section 4.1.1</a> of this document.<a class="pilcrow" href="#section-8.7-2">¶</a></p>
<p id="section-8.7-3">
          The IANA has registered the value "AN_join_registrar" (without quotes)
          to the "GRASP Objective Names" table in the GRASP Parameter registry.
          The specification for this value is <a class="xref" href="#JRCgrasp">Section 4.3</a> of this document.<a class="pilcrow" href="#section-8.7-3">¶</a></p>
</section>
</section>
<div id="acpapplicability">
<section id="section-9">
      <h2 id="name-applicability-to-the-autono">
<a class="section-number selfRef" href="#section-9">9. </a><a class="section-name selfRef" href="#name-applicability-to-the-autono">Applicability to the Autonomic Control Plane (ACP)</a>
      </h2>
<p id="section-9-1">
        This document provides a solution to the requirements for secure
        bootstrapping as defined in "<a class="xref" href="#RFC8368">Using an Autonomic Control Plane for Stable Connectivity of Network Operations, Administration, and Maintenance (OAM)</a>" <span>[<a class="xref" href="#RFC8368">RFC8368</a>]</span>,
       "A Reference Model for Autonomic Networking" <span>[<a class="xref" href="#RFC8993">RFC8993</a>]</span>, and specifically
       "An Autonomic Control Plane (ACP)" <span>[<a class="xref" href="#RFC8994">RFC8994</a>]</span>; see Sections <a class="relref" href="https://www.rfc-editor.org/rfc/rfc8994#section-3.2">3.2</a> ("Secure Bootstrap over an Unconfigured Network") and
        <a class="relref" href="https://www.rfc-editor.org/rfc/rfc8994#section-6.2">6.2</a> ("ACP Domain, Certificate, and Network").<a class="pilcrow" href="#section-9-1">¶</a></p>
<p id="section-9-2">
        The protocol described in this document has appeal in a number of
        other non-ANIMA use cases.  Such uses of the protocol will be
        deployed into other environments with different tradeoffs of
        privacy, security, reliability, and autonomy from manufacturers.
        As such, those use cases will need to provide their own applicability
        statements and will need to address unique privacy and security
        considerations for the environments in which they are used.<a class="pilcrow" href="#section-9-2">¶</a></p>
<p id="section-9-3">
        The ACP that is bootstrapped by
        the BRSKI protocol is typically used in medium to large Internet
        service provider organizations. Equivalent enterprises that have
        significant Layer 3 router connectivity also will find significant
        benefit, particularly if the enterprise has many sites.
        (A network consisting of primarily Layer 2
        is not excluded, but the adjacencies that the ACP will create and
        maintain will not reflect the topology until all devices participate
        in the ACP.)<a class="pilcrow" href="#section-9-3">¶</a></p>
<p id="section-9-4">
        In the ACP, the Join Proxy is found to be proximal because
        communication between the pledge and the Join Proxy is exclusively
        on IPv6 link-local addresses.  The proximity of the
        Join Proxy to the registrar is validated by the registrar using ANI
        ACP IPv6 ULAs.
        ULAs are not routable over the Internet, so as long as the Join
        Proxy is operating correctly, the proximity assertion is satisfied.
 Other uses of BRSKI will need similar analysis if they
        use proximity assertions.<a class="pilcrow" href="#section-9-4">¶</a></p>
<p id="section-9-5">
        As specified in the ANIMA charter, this work "focuses on
        professionally-managed networks."  Such a network has an operator
        and can do things like install, configure, and operate the
        registrar function.  The operator makes purchasing decisions
        and is aware of what manufacturers it expects to see on its
        network.<a class="pilcrow" href="#section-9-5">¶</a></p>
<p id="section-9-6">
        Such an operator is also capable of performing bootstrapping of a
        device using a serial console (craft console). The zero-touch
        mechanism presented in this and the ACP document <span>[<a class="xref" href="#RFC8994">RFC8994</a>]</span>
        represents a
        significant efficiency: in particular, it reduces the need to
        put senior experts on airplanes to configure devices in person.<a class="pilcrow" href="#section-9-6">¶</a></p>
<p id="section-9-7">
        As the technology evolves, there is recognition that not every
        situation may work out, and occasionally a human may still have to
        visit.  Given this, some mechanisms are presented in
        <a class="xref" href="#pledgeReductions">Section 7.2</a>. The manufacturer <span class="bcp14">MUST</span> provide at
        least one of the one-touch mechanisms described that permit
        enrollment to proceed without the availability of any manufacturer
        server (such as the MASA).<a class="pilcrow" href="#section-9-7">¶</a></p>
<p id="section-9-8">
        The BRSKI protocol is going into environments where there have
        already been quite a number of vendor proprietary management
        systems.  Those are not expected to go away quickly but rather to
        leverage the secure credentials that are provisioned by BRSKI.  The
        connectivity requirements of the said management systems are provided
        by the ACP.<a class="pilcrow" href="#section-9-8">¶</a></p>
<div id="operationalrequirements">
<section id="section-9.1">
        <h3 id="name-operational-requirements">
<a class="section-number selfRef" href="#section-9.1">9.1. </a><a class="section-name selfRef" href="#name-operational-requirements">Operational Requirements</a>
        </h3>
<p id="section-9.1-1">
          This section collects operational requirements based upon the three
          roles involved in BRSKI: the MASA, the (domain) owner, and the device.
          It should be recognized that the manufacturer may be involved in two
          roles, as it creates the software/firmware for the device and
          may also be the operator of the MASA.<a class="pilcrow" href="#section-9.1-1">¶</a></p>
<p id="section-9.1-2">
          The requirements in this section are presented using BCP 14 language
          <span>[<a class="xref" href="#RFC2119">RFC2119</a>]</span> <span>[<a class="xref" href="#RFC8174">RFC8174</a>]</span>.

   These do not represent new normative statements, just a
          review of a few such things in one place by role.  They also apply
          specifically to the ANIMA ACP use case.  Other use cases likely
          have similar, but <span class="bcp14">MAY</span> have different, requirements.<a class="pilcrow" href="#section-9.1-2">¶</a></p>
<div id="masarequirements">
<section id="section-9.1.1">
          <h4 id="name-masa-operational-requiremen">
<a class="section-number selfRef" href="#section-9.1.1">9.1.1. </a><a class="section-name selfRef" href="#name-masa-operational-requiremen">MASA Operational Requirements</a>
          </h4>
<p id="section-9.1.1-1">
            The manufacturer <span class="bcp14">MUST</span> arrange for an online service called the MASA to be available. It <span class="bcp14">MUST</span> be available at the URL that is encoded
            in the IDevID certificate extensions described in <a class="xref" href="#MASAURL">Section 2.3.2</a>.<a class="pilcrow" href="#section-9.1.1-1">¶</a></p>
<p id="section-9.1.1-2">
            The online service <span class="bcp14">MUST</span> have access to a private key with which to
            sign voucher artifacts <span>[<a class="xref" href="#RFC8366">RFC8366</a>]</span>.  The public
            key, certificate, or certificate chain <span class="bcp14">MUST</span> be built into the
            device as part of the firmware.<a class="pilcrow" href="#section-9.1.1-2">¶</a></p>
<p id="section-9.1.1-3">
            It is <span class="bcp14">RECOMMENDED</span> that the manufacturer arrange for this signing
            key (or keys) to be escrowed according to typical software source
            code escrow practices <span>[<a class="xref" href="#softwareescrow">softwareescrow</a>]</span>.<a class="pilcrow" href="#section-9.1.1-3">¶</a></p>
<p id="section-9.1.1-4">
            The MASA accepts voucher-requests from domain owners according to
            an operational practice appropriate for the device.  This can range
            from any domain owner (first-come first-served, on a TOFU-like
            basis), to full sales channel integration where domain owners need
            to be positively identified by TLS pinned Client Certificates or an HTTP
            authentication process.  The MASA creates signed voucher artifacts
            according to its internally defined policies.<a class="pilcrow" href="#section-9.1.1-4">¶</a></p>
<p id="section-9.1.1-5">
            The MASA <span class="bcp14">MUST</span> operate an audit-log for devices that is accessible.
            The audit-log is designed to be easily cacheable, and the MASA <span class="bcp14">MAY</span>
            find it useful to put this content on a Content Delivery Network (CDN).<a class="pilcrow" href="#section-9.1.1-5">¶</a></p>
</section>
</div>
<div id="domainownerrequirements">
<section id="section-9.1.2">
          <h4 id="name-domain-owner-operational-re">
<a class="section-number selfRef" href="#section-9.1.2">9.1.2. </a><a class="section-name selfRef" href="#name-domain-owner-operational-re">Domain Owner Operational Requirements</a>
          </h4>
<p id="section-9.1.2-1">
            The domain owner <span class="bcp14">MUST</span> operate an EST <span>[<a class="xref" href="#RFC7030">RFC7030</a>]</span>
            server with the extensions described in this document.  This is
            the JRC or registrar.  This JRC/EST
            server <span class="bcp14">MUST</span> announce itself using GRASP within the ACP.  This EST
            server will typically reside with the Network Operations Center for
            the organization.<a class="pilcrow" href="#section-9.1.2-1">¶</a></p>
<p id="section-9.1.2-2">
            The domain owner <span class="bcp14">MAY</span> operate an internal CA that
            is separate from the EST server, or it <span class="bcp14">MAY</span> combine all activities
            into a single device.  The determination of the architecture
            depends upon the scale and resiliency requirements of the
            organization.  Multiple JRC instances <span class="bcp14">MAY</span> be announced into the ACP
            from multiple locations to achieve an appropriate level of
            redundancy.<a class="pilcrow" href="#section-9.1.2-2">¶</a></p>
<p id="section-9.1.2-3">
            In order to recognize which devices and which manufacturers are
            welcome on the domain owner's network, the domain owner <span class="bcp14">SHOULD</span>
            maintain an acceptlist of manufacturers.  This <span class="bcp14">MAY</span> extend to
            integration with purchasing departments to know the serial numbers
            of devices.<a class="pilcrow" href="#section-9.1.2-3">¶</a></p>
<p id="section-9.1.2-4">
            The domain owner <span class="bcp14">SHOULD</span> use the resulting overlay ACP network to
            manage devices, replacing legacy out-of-band mechanisms.<a class="pilcrow" href="#section-9.1.2-4">¶</a></p>
<p id="section-9.1.2-5">
            The domain owner <span class="bcp14">SHOULD</span> operate one or more EST servers that can
            be used to renew the domain certificates (LDevIDs), which are
            deployed to devices.  These servers <span class="bcp14">MAY</span> be the same as the JRC or
            <span class="bcp14">MAY</span> be a distinct set of devices, as appropriate for resiliency.<a class="pilcrow" href="#section-9.1.2-5">¶</a></p>
<p id="section-9.1.2-6">
            The organization <span class="bcp14">MUST</span> take appropriate precautions against loss of
            access to the CA private key.  Hardware security
            modules and/or secret splitting are appropriate.<a class="pilcrow" href="#section-9.1.2-6">¶</a></p>
</section>
</div>
<div id="devicerequirements">
<section id="section-9.1.3">
          <h4 id="name-device-operational-requirem">
<a class="section-number selfRef" href="#section-9.1.3">9.1.3. </a><a class="section-name selfRef" href="#name-device-operational-requirem">Device Operational Requirements</a>
          </h4>
<p id="section-9.1.3-1">
            Devices <span class="bcp14">MUST</span> come with built-in trust anchors that permit the device to
            validate vouchers from the MASA.<a class="pilcrow" href="#section-9.1.3-1">¶</a></p>
<p id="section-9.1.3-2">
            Devices <span class="bcp14">MUST</span> come with (unique, per-device) IDevID certificates that
            include their serial numbers and the MASA URL extension.<a class="pilcrow" href="#section-9.1.3-2">¶</a></p>
<p id="section-9.1.3-3">
            Devices are expected to find Join Proxies using GRASP, and then connect
            to the JRC using the protocol described in this document.<a class="pilcrow" href="#section-9.1.3-3">¶</a></p>
<p id="section-9.1.3-4">
            Once a domain owner has been validated with the voucher, devices
            are expected to enroll into the domain using EST.  Devices are then
            expected to form ACPs using IPsec over IPv6 link-local addresses as
            described in  <span>[<a class="xref" href="#RFC8994">RFC8994</a>]</span>.<a class="pilcrow" href="#section-9.1.3-4">¶</a></p>
<p id="section-9.1.3-5">
            Once a device has been enrolled, it <span class="bcp14">SHOULD</span> listen for the address
            of the JRC using GRASP, and it <span class="bcp14">SHOULD</span> enable itself as a Join
            Proxy and announce itself on all links/interfaces using GRASP DULL.<a class="pilcrow" href="#section-9.1.3-5">¶</a></p>
<p id="section-9.1.3-6">
            Devices are expected to renew their certificates before they
            expire.<a class="pilcrow" href="#section-9.1.3-6">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="privacyconsiderations">
<section id="section-10">
      <h2 id="name-privacy-considerations">
<a class="section-number selfRef" href="#section-10">10. </a><a class="section-name selfRef" href="#name-privacy-considerations">Privacy Considerations</a>
      </h2>
<section id="section-10.1">
        <h3 id="name-masa-audit-log">
<a class="section-number selfRef" href="#section-10.1">10.1. </a><a class="section-name selfRef" href="#name-masa-audit-log">MASA Audit-Log</a>
        </h3>
<p id="section-10.1-1">
        The MASA audit-log includes the domainID for each
        domain a voucher has been issued to. This information is closely
        related to the actual domain identity.  A MASA may need additional
        defenses against Denial-of-Service attacks (<a class="xref" href="#dosmasa">Section 11.1</a>),
        and this may involve collecting additional (unspecified here)
        information. This could provide sufficient information for the MASA
        service to build a detailed understanding of the devices that have been
        provisioned within a domain.<a class="pilcrow" href="#section-10.1-1">¶</a></p>
<p id="section-10.1-2">
        There are a number of design choices that mitigate this
        risk. The domain can maintain some privacy since it has not necessarily
        been authenticated and is not authoritatively bound to the supply
        chain.<a class="pilcrow" href="#section-10.1-2">¶</a></p>
<p id="section-10.1-3">
        Additionally, the domainID captures only the unauthenticated
        subject key identifier of the domain. A privacy-sensitive domain could
        theoretically generate a new domainID for each device being
        deployed. Similarly, a privacy-sensitive domain would likely purchase
        devices that support proximity assertions from a manufacturer that does
        not require sales channel integrations. This would result in a
        significant level of privacy while maintaining the security
        characteristics provided by the registrar-based audit-log inspection.<a class="pilcrow" href="#section-10.1-3">¶</a></p>
</section>
<div id="idevidregistrar">
<section id="section-10.2">
        <h3 id="name-what-brski-est-reveals">
<a class="section-number selfRef" href="#section-10.2">10.2. </a><a class="section-name selfRef" href="#name-what-brski-est-reveals">What BRSKI-EST Reveals</a>
        </h3>
<p id="section-10.2-1">
            During the provisional phase of the BRSKI-EST connection between
            the pledge and the registrar, each party reveals its
            certificates to each other.  For the pledge, this includes the
            serialNumber attribute, the MASA URL, and the identity that
            signed the IDevID certificate.<a class="pilcrow" href="#section-10.2-1">¶</a></p>
<p id="section-10.2-2">
            TLS 1.2 reveals the certificate identities to on-path observers,
            including the Join Proxy.<a class="pilcrow" href="#section-10.2-2">¶</a></p>
<p id="section-10.2-3">
            TLS 1.3 reveals the certificate identities only to the end
            parties, but as the connection is provisional; an on-path
            attacker (MITM) can see the certificates.  This includes not just
            malicious attackers but also registrars that are visible
            to the pledge but are not part of the intended domain.<a class="pilcrow" href="#section-10.2-3">¶</a></p>
<p id="section-10.2-4">
            The certificate of the registrar is rather arbitrary from the
            point of view of the BRSKI protocol. As no
            validations <span>[<a class="xref" href="#RFC6125">RFC6125</a>]</span> are expected to be done, the contents could be easily
            pseudonymized.  Any device that can see a Join Proxy would be
            able to connect to the registrar and learn the identity of the
            network in question.  Even if the contents of the certificate
            are pseudonymized, it would be possible to correlate different
            connections in different locations that belong to the same
            entity. This is unlikely to present a significant privacy concern
            to ANIMA ACP uses of BRSKI, but it may be a concern to other users
            of BRSKI.<a class="pilcrow" href="#section-10.2-4">¶</a></p>
<p id="section-10.2-5">
            The certificate of the pledge could be revealed by a malicious
            Join Proxy that performed a MITM attack on the provisional TLS
            connection.   Such an attacker would be able to reveal the
            identity of the pledge to third parties if it chose to do so.<a class="pilcrow" href="#section-10.2-5">¶</a></p>
<p id="section-10.2-6">
            Research into a mechanism to do multistep, multiparty authenticated
            key agreement, incorporating some kind of zero-knowledge proof,
            would be valuable.  Such a mechanism would ideally avoid
            disclosing identities until the pledge, registrar, and MASA agree to
            the transaction.  Such a mechanism would need to discover the
            location of the MASA without knowing the identity of the pledge
            or the identity of the MASA.  This part of the problem may be unsolvable.<a class="pilcrow" href="#section-10.2-6">¶</a></p>
</section>
</div>
<div id="idevidprivacy">
<section id="section-10.3">
        <h3 id="name-what-brski-masa-reveals-to-">
<a class="section-number selfRef" href="#section-10.3">10.3. </a><a class="section-name selfRef" href="#name-what-brski-masa-reveals-to-">What BRSKI-MASA Reveals to the Manufacturer</a>
        </h3>
<p id="section-10.3-1">
            With consumer-oriented devices, the "call-home" mechanism in IoT
            devices raises significant privacy concerns.  See
            <span>[<a class="xref" href="#livingwithIoT">livingwithIoT</a>]</span> and <span>[<a class="xref" href="#IoTstrangeThings">IoTstrangeThings</a>]</span> for exemplars.  The ACP usage of BRSKI is not targeted at individual usage of
            IoT devices but rather at the enterprise and ISP creation of
            networks in a zero-touch fashion where the "call-home" represents
            a different class of privacy and life-cycle management concerns.<a class="pilcrow" href="#section-10.3-1">¶</a></p>
<p id="section-10.3-2">
            It needs to be reiterated that the BRSKI-MASA mechanism
            only occurs once during the commissioning of the device.  It is
            well defined, and although encrypted with TLS, it could in theory
            be made auditable as the contents are well defined.
            This connection does not occur when the device powers on or is
            restarted for normal routines.
            (It is conceivable, but remarkably unusual, that a device could
            be forced to go through a full factory reset during an exceptional firmware update
            situation, after which enrollment would have to be repeated, and a
            new connection would occur.)<a class="pilcrow" href="#section-10.3-2">¶</a></p>
<p id="section-10.3-3">
            The BRSKI call-home mechanism is mediated via the owner's
            registrar, and the information that is transmitted is directly
            auditable by the device owner. This is in stark contrast to
            many "call-home" protocols where the device autonomously calls
            home and uses an undocumented protocol.<a class="pilcrow" href="#section-10.3-3">¶</a></p>
<p id="section-10.3-4">
            While the contents of the signed part of the pledge voucher-request
            cannot be changed, they are not encrypted at the registrar.
            The ability to audit the messages by the owner of the network
            is a mechanism to defend against exfiltration of data by a nefarious
            pledge. Both are, to reiterate, encrypted by TLS while in transit.<a class="pilcrow" href="#section-10.3-4">¶</a></p>
<p id="section-10.3-5">
            The BRSKI-MASA exchange reveals the following information to the
            manufacturer:<a class="pilcrow" href="#section-10.3-5">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.3-6.1">
                the identity of the device being enrolled.  This is revealed
                by transmission of a signed voucher-request containing the
                serial-number.  The manufacturer can usually link the serial
                number to a device model.<a class="pilcrow" href="#section-10.3-6.1">¶</a>
</li>
          <li class="normal" id="section-10.3-6.2">
                an identity of the domain owner in the form of the domain
                trust anchor.  However, this is not a global PKI-anchored
                name within the WebPKI, so this identity could be
                pseudonymous.  If there is sales channel integration, then
                the MASA will have authenticated the domain owner, via either
                a pinned certificate or perhaps another HTTP authentication
                method, as per <a class="xref" href="#MASAauthenticationOfRegistrar">Section 5.5.4</a>.<a class="pilcrow" href="#section-10.3-6.2">¶</a>
</li>
          <li class="normal" id="section-10.3-6.3">
                the time the device is activated.<a class="pilcrow" href="#section-10.3-6.3">¶</a>
</li>
          <li class="normal" id="section-10.3-6.4">
                the IP address of the domain owner's registrar.
                For ISPs and enterprises, the IP address provides very clear
                geolocation of the owner.  No amount of IP address privacy
                extensions <span>[<a class="xref" href="#RFC8981">RFC8981</a>]</span> can do anything about
                this, as a simple whois lookup likely identifies the ISP or
                enterprise from the upper bits anyway.  A passive attacker
                who observes the connection definitely may conclude that the
                given enterprise/ISP is a customer of the particular
                equipment vendor.  The precise model that is being enrolled
                will remain private.<a class="pilcrow" href="#section-10.3-6.4">¶</a>
</li>
        </ul>
<p id="section-10.3-7">
            Based upon the above information, the manufacturer is able to
            track a specific device from pseudonymous domain identity to the
            next pseudonymous domain identity.  If there is sales-channel
            integration, then the identities are not pseudonymous.<a class="pilcrow" href="#section-10.3-7">¶</a></p>
<p id="section-10.3-8">
            The manufacturer knows the IP address of the registrar, but it
            cannot see the IP address of the device itself.  The
            manufacturer cannot track the device to a detailed physical
            or network location, only to the location of the registrar.
            That is likely to be at the enterprise or ISP's headquarters.<a class="pilcrow" href="#section-10.3-8">¶</a></p>
<p id="section-10.3-9">
            The above situation is to be distinguished from a
            residential/individual person who registers a device from a
            manufacturer.  Individuals do not tend to have multiple offices,
            and their registrar is likely on the same network as the device.
            A manufacturer that sells switching/routing products to enterprises
            should hardly be surprised if additional purchases of
            switching/routing products are made.
            Deviations from a historical trend or
            an established baseline would, however, be notable.<a class="pilcrow" href="#section-10.3-9">¶</a></p>
<p id="section-10.3-10">
            The situation is not improved by the enterprise/ISP using
            anonymization services such as Tor <span>[<a class="xref" href="#Dingledine">Dingledine</a>]</span>, as a TLS 1.2 connection
            will reveal the ClientCertificate used, clearly identifying
            the enterprise/ISP involved.  TLS 1.3 is better in this regard,
            but an active attacker can still discover the parties involved by
            performing a MITM attack on the first attempt
            (breaking/killing it with a TCP reset (RST)), and then letting subsequent
            connection pass through.<a class="pilcrow" href="#section-10.3-10">¶</a></p>
<p id="section-10.3-11">
            A manufacturer could attempt to mix the BRSKI-MASA traffic in
            with general traffic on their site by hosting the MASA behind the
            same (set) of load balancers that the company's normal marketing
            site is hosted behind.  This makes a lot of sense from a straight
            capacity planning point of view as the same set of services
            (and the same set of Distributed Denial-of-Service mitigations)
            may be used.  Unfortunately, as the BRSKI-MASA connections
            include TLS ClientCertificate exchanges, this may easily be
            observed in TLS 1.2, and a traffic analysis may reveal it even in
            TLS 1.3.  This does not make such a plan irrelevant.  There may
            be other organizational reasons to keep the marketing site (which
            is often subject to frequent redesigns, outsourcing, etc.)
            separate from the MASA, which may need to operate reliably for
            decades.<a class="pilcrow" href="#section-10.3-11">¶</a></p>
</section>
</div>
<section id="section-10.4">
        <h3 id="name-manufacturers-and-used-or-s">
<a class="section-number selfRef" href="#section-10.4">10.4. </a><a class="section-name selfRef" href="#name-manufacturers-and-used-or-s">Manufacturers and Used or Stolen Equipment</a>
        </h3>
<p id="section-10.4-1">
            As explained above, the manufacturer receives information each
            time a device that is in factory-default mode does a
            zero-touch bootstrap and attempts to enroll into a domain
            owner's registrar.<a class="pilcrow" href="#section-10.4-1">¶</a></p>
<p id="section-10.4-2">
            The manufacturer is therefore in a position to decline to
            issue a voucher if it detects that the new owner is not the
            same as the previous owner.<a class="pilcrow" href="#section-10.4-2">¶</a></p>
<ol class="normal type-1" id="section-10.4-3" start="1" type="1">
          <li id="section-10.4-3.1">
                This can be seen as a feature if the equipment is believed to
                have been stolen.  If the legitimate owner notifies the
                manufacturer of the theft, then when the new owner brings the
                device up, if they use the zero-touch mechanism, the new
                (illegitimate) owner reveals their location and identity.<a class="pilcrow" href="#section-10.4-3.1">¶</a>
</li>
          <li id="section-10.4-3.2">
                In the case of used equipment, the initial owner could inform
                the manufacturer of the sale, or the manufacturer may just
                permit resales unless told otherwise.  In which case, the
                transfer of ownership simply occurs.<a class="pilcrow" href="#section-10.4-3.2">¶</a>
</li>
          <li id="section-10.4-3.3">
                A manufacturer could, however, decide not to issue a new
                voucher in response to a transfer of ownership.
                This is essentially the same as the stolen case, with the
                manufacturer having decided that the sale was not legitimate.<a class="pilcrow" href="#section-10.4-3.3">¶</a>
</li>
          <li id="section-10.4-3.4">
                There is a fourth case, if the manufacturer is providing
                protection against stolen devices.  The manufacturer then
                has a responsibility to protect the legitimate owner against
                fraudulent claims that the equipment was stolen.
                In the absence of such manufacturer protection,
                such a claim would cause the manufacturer to refuse
                to issue a new voucher. Should the device go through
                a deep factory reset (for instance, replacement of a damaged
                main board component), the device would not bootstrap.<a class="pilcrow" href="#section-10.4-3.4">¶</a>
</li>
          <li id="section-10.4-3.5">
                Finally, there is a fifth case: the manufacturer has decided to
                end-of-line the device, or the owner has not paid a yearly
                support amount, and the manufacturer refuses to issue new
                vouchers at that point.  This last case is not new to the
                industry: many license systems are already deployed that have
                a significantly worse effect.<a class="pilcrow" href="#section-10.4-3.5">¶</a>
</li>
        </ol>
<p id="section-10.4-4">
            This section has outlined five situations in which a manufacturer
            could use the voucher system to enforce what are clearly
            license terms.
            A manufacturer that attempted to
            enforce license terms via vouchers would find it rather
            ineffective as the terms would only be enforced when the device
            is enrolled, and this is not (to repeat) a daily or even monthly
            occurrence.<a class="pilcrow" href="#section-10.4-4">¶</a></p>
</section>
<section id="section-10.5">
        <h3 id="name-manufacturers-and-grey-mark">
<a class="section-number selfRef" href="#section-10.5">10.5. </a><a class="section-name selfRef" href="#name-manufacturers-and-grey-mark">Manufacturers and Grey Market Equipment</a>
        </h3>
<p id="section-10.5-1">
            Manufacturers of devices often sell different products into
            different regional markets.  Which product is available in which
            market can be driven by price differentials, support issues (some
            markets may require manuals and tech support to be done in the
            local language), and government export regulation (such as whether
            strong crypto is permitted to be exported or permitted to be
            used in a particular market).  When a domain owner obtains a
            device from a different market (they can be new) and transfers it
            to a different location, this is called a Grey Market.<a class="pilcrow" href="#section-10.5-1">¶</a></p>
<p id="section-10.5-2">
            A manufacturer could decide not to issue a voucher to an
            enterprise/ISP based upon their location.  There are a number of
            ways that this could be determined: from the geolocation of the
            registrar, from sales channel knowledge about the customer, and
            from what products are available or unavailable in that market.  If the device
            has a GPS, the coordinates of the device could even be placed into
            an extension of the voucher.<a class="pilcrow" href="#section-10.5-2">¶</a></p>
<p id="section-10.5-3">
            The above actions are not illegal, and not new.  Many
            manufacturers have shipped crypto-weak (exportable) versions of
            firmware as the default on equipment for decades.  The first task
            of an enterprise/ISP has always been to login to a manufacturer
            system, show one's "entitlement" (country information, proof that
            support payments have been made), and receive either a new
            updated firmware or a license key that will activate the correct
            firmware.<a class="pilcrow" href="#section-10.5-3">¶</a></p>
<p id="section-10.5-4">
            BRSKI permits the above process to be automated (in an autonomic
            fashion) and therefore perhaps encourages this kind of
            differentiation by reducing the cost of doing it.<a class="pilcrow" href="#section-10.5-4">¶</a></p>
<p id="section-10.5-5">
            An issue that manufacturers will need to deal with in the above
            automated process is when a device is shipped to one country
            with one set of rules (or laws or entitlements), but the domain
            registry is in another one.  Which rules apply is something
            that will have to be worked out: the manufacturer could
            believe they are dealing with Grey Market equipment when they
            are simply dealing with a global enterprise.<a class="pilcrow" href="#section-10.5-5">¶</a></p>
</section>
<section id="section-10.6">
        <h3 id="name-some-mitigations-for-meddli">
<a class="section-number selfRef" href="#section-10.6">10.6. </a><a class="section-name selfRef" href="#name-some-mitigations-for-meddli">Some Mitigations for Meddling by Manufacturers</a>
        </h3>
<p id="section-10.6-1">
            The most obvious mitigation is not to buy the product.
            Pick manufacturers that are up front about their policies and who do
            not change them gratuitously.<a class="pilcrow" href="#section-10.6-1">¶</a></p>
<p id="section-10.6-2">
            <a class="xref" href="#masasecurityreduction_newanchor">Section 7.4.3</a>
            describes some ways in which a manufacturer could provide a
            mechanism to manage the trust
            anchors and built-in certificates (IDevID) as an extension.
            There are a variety of mechanisms, and some may take a substantial
            amount of work to get exactly correct.  These mechanisms do
            not change the flow of the protocol described here but rather
            allow the starting trust assumptions to be changed.
            This is an area for
            future standardization work.<a class="pilcrow" href="#section-10.6-2">¶</a></p>
<p id="section-10.6-3">
            Replacement of the voucher validation anchors (usually pointing
            to the original manufacturer's MASA) with those of the new
            owner permits the new owner to issue vouchers to subsequent
            owners. This would be done by having the selling (old) owner
            run a MASA.<a class="pilcrow" href="#section-10.6-3">¶</a></p>
<p id="section-10.6-4">
            The BRSKI protocol depends upon a trust anchor
            and an identity on the device.  Management of these
            entities facilitates a few new operational modes without
            making any changes to the BRSKI protocol.  Those modes include:
            offline modes where the domain owner operates an internal
            MASA for all devices, resell modes where the first domain owner
            becomes the MASA for the next (resold-to) domain owner,
            and services where an aggregator acquires a large variety
            of devices and then acts as a pseudonymized MASA for a variety
            of devices from a variety of manufacturers.<a class="pilcrow" href="#section-10.6-4">¶</a></p>
<p id="section-10.6-5">
            Although replacement of the IDevID is not required for all
            modes described above, a manufacturer could support such a
            thing.   Some may wish to consider replacement of the IDevID
            as an indication that the device's warranty is terminated.
            For others, the privacy requirements of some deployments might
            consider this a standard operating practice.<a class="pilcrow" href="#section-10.6-5">¶</a></p>
<p id="section-10.6-6">
            As discussed at the end of <a class="xref" href="#MASAauditlog">Section 5.8.1</a>,
            new work could be done to use a
            distributed consensus technology for the audit-log.
            This would permit the audit-log to continue to be useful,
            even when there is a chain of MASA due to changes of ownership.<a class="pilcrow" href="#section-10.6-6">¶</a></p>
</section>
<section id="section-10.7">
        <h3 id="name-death-of-a-manufacturer">
<a class="section-number selfRef" href="#section-10.7">10.7. </a><a class="section-name selfRef" href="#name-death-of-a-manufacturer">Death of a Manufacturer</a>
        </h3>
<p id="section-10.7-1">
            A common concern has been that a manufacturer could go out of
            business, leaving owners of devices unable to get new vouchers
            for existing products.  Said products might have been previously
            deployed but need to be reinitialized, used, or  kept in a warehouse as
            long-term spares.<a class="pilcrow" href="#section-10.7-1">¶</a></p>
<p id="section-10.7-2">
            The MASA was named the Manufacturer *Authorized* Signing
            Authority to emphasize that it need not be the manufacturer
            itself that performs this.  It is anticipated that
            specialist service providers will come to exist that deal with the creation
            of vouchers in much the same way that many companies have
            outsourced email, advertising, and janitorial services.<a class="pilcrow" href="#section-10.7-2">¶</a></p>
<p id="section-10.7-3">
            Further, it is expected that as part of any service agreement,
            the manufacturer would arrange to escrow appropriate private
            keys such that a MASA service could be provided by a third
            party.  This has routinely been done for source code for decades.<a class="pilcrow" href="#section-10.7-3">¶</a></p>
</section>
</section>
</div>
<div id="securityconsiderations">
<section id="section-11">
      <h2 id="name-security-considerations">
<a class="section-number selfRef" href="#section-11">11. </a><a class="section-name selfRef" href="#name-security-considerations">Security Considerations</a>
      </h2>
<p id="section-11-1">
        This document details a protocol for bootstrapping that balances
        operational concerns against security concerns. As detailed in the introduction,
        and touched on again in <a class="xref" href="#reducedsecuritymodes">Section 7</a>,
        the protocol allows for reduced security modes.
        These attempt to deliver additional
        control to the local administrator and owner in cases where
        less security provides operational benefits. This
        section goes into more detail about a variety of specific
        considerations.<a class="pilcrow" href="#section-11-1">¶</a></p>
<p id="section-11-2">
        To facilitate logging and administrative oversight, in addition
        to triggering registrar verification of MASA logs, the pledge reports
      on the voucher parsing status to the registrar. In the case of a
      failure, this information is informative to a potentially malicious
      registrar. This is mandated anyway because of the operational
      benefits of an informed administrator in cases where the failure is
      indicative of a problem. The registrar is <span class="bcp14">RECOMMENDED</span> to verify MASA logs
      if voucher status telemetry is not received.<a class="pilcrow" href="#section-11-2">¶</a></p>
<p id="section-11-3">To facilitate truly limited clients, EST
      requires that the client <span class="bcp14">MUST</span> support a client authentication model (see <span>[<a class="xref" href="#RFC7030">RFC7030</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc7030#section-3.3.2">Section 3.3.2</a></span>);
      <a class="xref" href="#reducedsecuritymodes">Section 7</a> updates these requirements by stating that the registrar <span class="bcp14">MAY</span> choose to accept devices
      that fail cryptographic authentication. This reflects
      current (poor) practices in shipping devices without a cryptographic
      identity that are <span class="bcp14">NOT RECOMMENDED</span>.<a class="pilcrow" href="#section-11-3">¶</a></p>
<p id="section-11-4">During the provisional period of the connection, the pledge <span class="bcp14">MUST</span> treat all HTTP header and
        content data as untrusted data. HTTP libraries are
        regularly exposed to non-secured HTTP traffic: mature libraries
        should not have any problems.<a class="pilcrow" href="#section-11-4">¶</a></p>
<p id="section-11-5">Pledges might chose to engage in protocol operations with
      multiple discovered registrars in parallel. As noted above, they
      will only do so with distinct nonce values, but the end result
      could be multiple vouchers issued from the MASA if all registrars
      attempt to claim the device. This is not a failure, and the pledge
      chooses whichever voucher to accept based on internal logic. The
      registrars verifying log information will see multiple entries
      and take this into account for their analytic purposes.<a class="pilcrow" href="#section-11-5">¶</a></p>
<div id="dosmasa">
<section id="section-11.1">
        <h3 id="name-denial-of-service-dos-again">
<a class="section-number selfRef" href="#section-11.1">11.1. </a><a class="section-name selfRef" href="#name-denial-of-service-dos-again">Denial of Service (DoS) against MASA</a>
        </h3>
<p id="section-11.1-1">There are use cases where the MASA could be unavailable or
        uncooperative to the registrar. They include active DoS attacks, planned and unplanned
        network partitions, changes to MASA policy, or other instances where
        MASA policy rejects a claim. These introduce an operational risk to the
        registrar owner in that MASA behavior might limit the ability to
        bootstrap a pledge device. For example, this might be an issue during
        disaster recovery. This risk can be mitigated by registrars that
        request and maintain long-term copies of "nonceless" vouchers. In
        that way, they are guaranteed to be able to bootstrap their devices.<a class="pilcrow" href="#section-11.1-1">¶</a></p>
<p id="section-11.1-2">The issuance of nonceless vouchers themselves creates a security
        concern. If the registrar of a previous domain can intercept protocol
        communications, then it can use a previously issued nonceless voucher to
        establish management control of a pledge device even after having sold
        it. This risk is mitigated by recording the issuance of such vouchers
        in the MASA audit-log that is verified by the subsequent registrar
        and by pledges only bootstrapping when in a factory default state. This
        reflects a balance between enabling MASA independence during
        future bootstrapping and the security of bootstrapping itself.
        Registrar control over requesting and auditing nonceless vouchers
        allows device owners to choose an appropriate balance.<a class="pilcrow" href="#section-11.1-2">¶</a></p>
<p id="section-11.1-3">The MASA is exposed to DoS attacks wherein attackers claim
        an unbounded number of devices. Ensuring a registrar is
        representative of a valid manufacturer customer, even without validating
        ownership of specific pledge devices, helps to mitigate this. Pledge
        signatures on the pledge voucher-request, as forwarded by the
        registrar in the prior-signed-voucher-request field of the registrar voucher-request, significantly
        reduce this risk by ensuring the MASA can confirm proximity
        between the pledge and the registrar making the request. Supply-chain
        integration ("know your customer") is an additional
        step that MASA providers and device vendors can explore.<a class="pilcrow" href="#section-11.1-3">¶</a></p>
</section>
</div>
<section id="section-11.2">
        <h3 id="name-domainid-must-be-resistant-">
<a class="section-number selfRef" href="#section-11.2">11.2. </a><a class="section-name selfRef" href="#name-domainid-must-be-resistant-">DomainID Must Be Resistant to Second-Preimage Attacks</a>
        </h3>
<p id="section-11.2-1">
          The domainID is used as the reference in the audit-log to the
          domain.  The domainID is expected to be calculated by a hash that
          is resistant to a second-preimage attack.
          Such an attack would allow a second registrar to create audit-log
          entries that are fake.<a class="pilcrow" href="#section-11.2-1">¶</a></p>
</section>
<section id="section-11.3">
        <h3 id="name-availability-of-good-random">
<a class="section-number selfRef" href="#section-11.3">11.3. </a><a class="section-name selfRef" href="#name-availability-of-good-random">Availability of Good Random Numbers</a>
        </h3>
<p id="section-11.3-1">
          The nonce used by the pledge in the voucher-request <span class="bcp14">SHOULD</span> be
          generated by a Strong Cryptographic Sequence (<span>[<a class="xref" href="#RFC4086">RFC4086</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc4086#section-6.2">Section 6.2</a></span>).  TLS has a similar requirement.<a class="pilcrow" href="#section-11.3-1">¶</a></p>
<p id="section-11.3-2">
          In particular, implementations should pay attention to the advance
          in  <span>[<a class="xref" href="#RFC4086">RFC4086</a>]</span>; see Sections <a class="relref" href="https://www.rfc-editor.org/rfc/rfc4086#section-3">3</a> and, in particular,
 <a class="relref" href="https://www.rfc-editor.org/rfc/rfc4086#section-3.4">3.4</a>.
          The random seed used by a device at boot <span class="bcp14">MUST</span> be
          unique across all devices and all bootstraps.  Resetting a device to
          factory default state does not obviate this requirement.<a class="pilcrow" href="#section-11.3-2">¶</a></p>
</section>
<section id="section-11.4">
        <h3 id="name-freshness-in-voucher-reques">
<a class="section-number selfRef" href="#section-11.4">11.4. </a><a class="section-name selfRef" href="#name-freshness-in-voucher-reques">Freshness in Voucher-Requests</a>
        </h3>
<p id="section-11.4-1">
          A concern has been raised that the pledge voucher-request should contain some content (a nonce) provided by the registrar and/or MASA
          in order for those actors to verify that the pledge voucher-request is fresh.<a class="pilcrow" href="#section-11.4-1">¶</a></p>
<p id="section-11.4-2">
          There are a number of operational problems with getting a nonce
          from the MASA to the pledge. It is somewhat easier to collect a
          random value from the registrar, but as the registrar is not yet
          vouched for, such a registrar nonce has little value.
          There are privacy and logistical challenges to addressing these
          operational issues, so if
          such a thing were to be considered, it would have to provide some
          clear value.  This section examines the impacts of not having a
          fresh pledge voucher-request.<a class="pilcrow" href="#section-11.4-2">¶</a></p>
<p id="section-11.4-3">
          Because the registrar authenticates the pledge, a full MITM
          attack is not possible, despite the provisional TLS authentication
          by the pledge (see <a class="xref" href="#ProtocolDetails">Section 5</a>.)
          Instead, we examine the case of a fake registrar (Rm)
          that communicates with the pledge in parallel or in close-time proximity
          with the intended registrar. (This scenario is intentionally supported as
          described in <a class="xref" href="#discovery">Section 4.1</a>.)<a class="pilcrow" href="#section-11.4-3">¶</a></p>
<p id="section-11.4-4">
          The fake registrar (Rm) can obtain a voucher signed by the MASA
          either directly or through arbitrary intermediaries.
          Assuming that the MASA accepts the registrar voucher-request (because
          either the Rm is collaborating with a legitimate registrar according to supply-chain
          information or the MASA is in audit-log only mode), then
          a voucher linking the pledge to the registrar Rm is issued.<a class="pilcrow" href="#section-11.4-4">¶</a></p>
<p id="section-11.4-5">
          Such a voucher, when passed back to the pledge, would link the
          pledge to registrar Rm and permit the pledge to
          end the provisional state. It now trusts the Rm and, if it has any
          security vulnerabilities leverageable by an Rm with full
          administrative control, can be assumed to be a
          threat against the intended registrar.<a class="pilcrow" href="#section-11.4-5">¶</a></p>
<p id="section-11.4-6">
          This flow is mitigated by the intended registrar verifying the audit-logs
          available from the MASA as described in
          <a class="xref" href="#authzLogRequest">Section 5.8</a>. The Rm might chose to collect
          a voucher-request but wait until after the intended registrar completes the authorization process before submitting it. This pledge voucher-request would be "stale" in that it has a nonce that no longer matches the internal state of the pledge. In order to successfully use any resulting voucher, the Rm would need to remove the stale nonce or anticipate the pledge's future nonce state. Reducing the possibility of this is why the pledge is mandated to generate a strong random or pseudo-random number nonce.<a class="pilcrow" href="#section-11.4-6">¶</a></p>
<p id="section-11.4-7">
          Additionally, in order to successfully use the resulting voucher, the Rm
          would have to attack the pledge and return it to a bootstrapping-enabled
          state. This would require wiping the pledge of current
          configuration and triggering a rebootstrapping of the pledge.
          This is no more likely than simply taking control of the pledge
          directly, but if this is a consideration, it is
          <span class="bcp14">RECOMMENDED</span> that the target network take the following steps:<a class="pilcrow" href="#section-11.4-7">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.4-8.1">Ongoing network monitoring for unexpected bootstrapping attempts by pledges.<a class="pilcrow" href="#section-11.4-8.1">¶</a>
</li>
          <li class="normal" id="section-11.4-8.2">Retrieval and examination of MASA log information upon the occurrence
              of any such unexpected events. The Rm will be listed in the logs along with nonce information for analysis.<a class="pilcrow" href="#section-11.4-8.2">¶</a>
</li>
        </ul>
</section>
<section id="section-11.5">
        <h3 id="name-trusting-manufacturers">
<a class="section-number selfRef" href="#section-11.5">11.5. </a><a class="section-name selfRef" href="#name-trusting-manufacturers">Trusting Manufacturers</a>
        </h3>
<p id="section-11.5-1">
          The BRSKI extensions to EST permit a new pledge to be completely
          configured with domain-specific trust anchors.  The link from
          built-in manufacturer-provided trust anchors to domain-specific
          trust anchors is mediated by the signed voucher artifact.<a class="pilcrow" href="#section-11.5-1">¶</a></p>
<p id="section-11.5-2">
          If the manufacturer's IDevID signing key is not properly validated,
          then there is a risk that the network will accept a pledge that
          should not be a member of the network.  As the address of the
          manufacturer's MASA is provided in the IDevID using the extension
          from <a class="xref" href="#IDevIDextension">Section 2.3</a>, the malicious pledge will have no problem
          collaborating with its MASA to produce a completely valid voucher.<a class="pilcrow" href="#section-11.5-2">¶</a></p>
<p id="section-11.5-3">
          BRSKI does not, however, fundamentally change the trust model from
          domain owner to manufacturer.  Assuming that the pledge used
          its IDevID with EST <span>[<a class="xref" href="#RFC7030">RFC7030</a>]</span> and BRSKI, the domain
(registrar) still needs to trust the manufacturer.<a class="pilcrow" href="#section-11.5-3">¶</a></p>
<p id="section-11.5-4">
          Establishing this trust between domain and manufacturer is outside
          the scope of BRSKI.  There are a number of mechanisms that can be
          adopted including:<a class="pilcrow" href="#section-11.5-4">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.5-5.1">
              Manually configuring each manufacturer's trust anchor.<a class="pilcrow" href="#section-11.5-5.1">¶</a>
</li>
          <li class="normal" id="section-11.5-5.2">
              A TOFU mechanism. A human would be queried upon
              seeing a manufacturer's trust anchor for the first time, and
              then the trust anchor would be installed to the trusted store.
              There are risks with this; even if the key to name mapping is validated
              using something like the WebPKI, there remains the possibility
              that the name is a look alike: e.g., dem0.example. vs.
              demO.example.<a class="pilcrow" href="#section-11.5-5.2">¶</a>
</li>
          <li class="normal" id="section-11.5-5.3">
              scanning the trust anchor from a QR code that came with the
              packaging (this is really a manual TOFU mechanism).<a class="pilcrow" href="#section-11.5-5.3">¶</a>
</li>
          <li class="normal" id="section-11.5-5.4">
              some sales integration processing where trust anchors are provided
              as part of the sales process, probably included in a digital
              packing "slip", or a sales invoice.<a class="pilcrow" href="#section-11.5-5.4">¶</a>
</li>
          <li class="normal" id="section-11.5-5.5">
              consortium membership, where all manufacturers of a particular
              device category (e.g, a light bulb or a cable modem) are
              signed by a CA specifically for this.
              This is done by CableLabs today.

       It is used for authentication
              and authorization as part of <span>[<a class="xref" href="#docsisroot">docsisroot</a>]</span> and <span>[<a class="xref" href="#TR069">TR069</a>]</span>.<a class="pilcrow" href="#section-11.5-5.5">¶</a>
</li>
        </ul>
<p id="section-11.5-6">
          The existing WebPKI provides a reasonable anchor between manufacturer
          name and public key. It authenticates the key.  It does not provide a
          reasonable authorization for the manufacturer, so it is not directly
          usable on its own.<a class="pilcrow" href="#section-11.5-6">¶</a></p>
</section>
<section id="section-11.6">
        <h3 id="name-manufacturer-maintenance-of">
<a class="section-number selfRef" href="#section-11.6">11.6. </a><a class="section-name selfRef" href="#name-manufacturer-maintenance-of">Manufacturer Maintenance of Trust Anchors</a>
        </h3>
<p id="section-11.6-1">
          BRSKI depends upon the manufacturer building in trust anchors
          to the pledge device.  The voucher artifact that is signed by the
          MASA will be validated by the pledge using that anchor.  This
          implies that the manufacturer needs to maintain access to a signing
          key that the pledge can validate.<a class="pilcrow" href="#section-11.6-1">¶</a></p>
<p id="section-11.6-2">
          The manufacturer will need to
          maintain the ability to make signatures that can be validated for
          the lifetime that the device could be onboarded. Whether
          this onboarding lifetime is less than the device lifetime depends
          upon how the device is used.  An inventory of devices kept in a
          warehouse as spares might not be onboarded for many decades.<a class="pilcrow" href="#section-11.6-2">¶</a></p>
<p id="section-11.6-3">
          There are good cryptographic hygiene reasons why a manufacturer
          would not want to maintain access to a private key for many
          decades.  A manufacturer in that situation can leverage a long-term
          CA anchor, built-in to the pledge, and then
          a certificate chain may be incorporated using the normal CMS
          certificate set.  This may increase the size of the voucher
          artifacts, but that is not a significant issue in non-constrained
          environments.<a class="pilcrow" href="#section-11.6-3">¶</a></p>
<p id="section-11.6-4">
          There are a few other operational variations that manufacturers
          could consider. For instance, there is no reason that every device
          need have the same
          set of trust anchors preinstalled.  Devices built in different
          factories, or on different days, or in any other consideration, could
          have different trust anchors built in, and the record of which
          batch the device is in would be recorded in the asset database.
          The manufacturer would then know which anchor to sign an artifact
          against.<a class="pilcrow" href="#section-11.6-4">¶</a></p>
<p id="section-11.6-5">
          Aside from the concern about long-term access to private keys, a
          major limiting factor for the shelf life of many devices will be
          the age of the cryptographic algorithms included.  A device
          produced in 2019 will have hardware and software capable of
          validating algorithms common in 2019 and will have no defense
          against attacks (both quantum and von Neumann brute-force attacks)
          that have not yet been invented.  This concern is orthogonal to
          the concern about access to private keys, but this concern likely
          dominates and limits the life span of a device in a warehouse.
          If any update to the firmware to support new cryptographic mechanisms
          were possible (while the device was in a warehouse), updates to
          trust anchors would also be done at the same time.<a class="pilcrow" href="#section-11.6-5">¶</a></p>
<p id="section-11.6-6">
          The set of standard operating procedures for maintaining
          high-value private keys is well documented. For instance,
          the WebPKI provides a number of options for audits in
          <span>[<a class="xref" href="#cabforumaudit">cabforumaudit</a>]</span>, and the DNSSEC root operations are well
          documented in <span>[<a class="xref" href="#dnssecroot">dnssecroot</a>]</span>.<a class="pilcrow" href="#section-11.6-6">¶</a></p>
<p id="section-11.6-7">
          It is not clear if manufacturers will take this level of
          precaution, or how strong the economic incentives are to maintain
          an appropriate level of security.<a class="pilcrow" href="#section-11.6-7">¶</a></p>
<p id="section-11.6-8">
          The next section examines the risk due to a compromised
          manufacturer IDevID signing key. This is followed by examination of
          the risk due to a compromised MASA key. The third section
          below examines the situation where a MASA web server itself
          is under attacker control, but the MASA signing key itself
          is safe in a not-directly connected hardware module.<a class="pilcrow" href="#section-11.6-8">¶</a></p>
<section id="section-11.6.1">
          <h4 id="name-compromise-of-manufacturer-">
<a class="section-number selfRef" href="#section-11.6.1">11.6.1. </a><a class="section-name selfRef" href="#name-compromise-of-manufacturer-">Compromise of Manufacturer IDevID Signing Keys</a>
          </h4>
<p id="section-11.6.1-1">
            An attacker that has access to the key that the manufacturer uses
            to sign IDevID certificates can create counterfeit devices.
            Such devices can claim to be from a particular manufacturer
            but can be entirely different devices: Trojan horses in effect.<a class="pilcrow" href="#section-11.6.1-1">¶</a></p>
<p id="section-11.6.1-2">
            As the attacker controls the MASA URL in the certificate,
            the registrar can be convinced to talk to the attacker's MASA.
            The registrar does not need to be in any kind of promiscuous mode
            to be vulnerable.<a class="pilcrow" href="#section-11.6.1-2">¶</a></p>
<p id="section-11.6.1-3">
            In addition to creating fake devices, the attacker may also
            be able to issue revocations for existing certificates if the
            IDevID certificate process relies upon CRL lists that are
            distributed.<a class="pilcrow" href="#section-11.6.1-3">¶</a></p>
<p id="section-11.6.1-4">
            There does not otherwise seem to be any risk from this compromise
            to devices that are already deployed or that are sitting
            locally in boxes waiting for deployment (local spares).
            The issue is that operators will be unable to trust devices
            that have been in an uncontrolled warehouse as they do not know
            if those are real devices.<a class="pilcrow" href="#section-11.6.1-4">¶</a></p>
</section>
<section id="section-11.6.2">
          <h4 id="name-compromise-of-masa-signing-">
<a class="section-number selfRef" href="#section-11.6.2">11.6.2. </a><a class="section-name selfRef" href="#name-compromise-of-masa-signing-">Compromise of MASA Signing Keys</a>
          </h4>
<p id="section-11.6.2-1">
            There are two periods of time in which to consider: when the MASA
            key has fallen into the hands of an attacker and after the MASA
            recognizes that the key has been compromised.<a class="pilcrow" href="#section-11.6.2-1">¶</a></p>
<section id="section-11.6.2.1">
            <h5 id="name-attacker-opportunities-with">
<a class="section-number selfRef" href="#section-11.6.2.1">11.6.2.1. </a><a class="section-name selfRef" href="#name-attacker-opportunities-with">Attacker Opportunities with a Compromised MASA Key</a>
            </h5>
<p id="section-11.6.2.1-1">
              An attacker that has access to the MASA signing key could create
              vouchers.  These vouchers could be for existing deployed
              devices or for devices that are still in a warehouse.
              In order to exploit these vouchers, two things need to occur:
              the device has to go through a factory default boot cycle, and the
              registrar has to be convinced to contact the attacker's MASA.<a class="pilcrow" href="#section-11.6.2.1-1">¶</a></p>
<p id="section-11.6.2.1-2">
              If the attacker controls a registrar that is visible to the
              device, then there is no difficulty in delivery of the false
              voucher.  A possible practical example of an attack like this
              would be in a data center, at an ISP peering point (whether a
              public IX or a private peering point).  In such a situation,
              there are already cables attached to the equipment that lead
              to other devices (the peers at the IX), and through those
              links, the false voucher could be delivered.  The difficult
              part would be to put the device through a factory reset.
              This might be accomplished through social engineering of data
              center staff.  Most locked cages have ventilation holes, and
              possibly a long "paperclip" could reach through to depress a
              factory reset button.  Once such a piece of ISP equipment has
              been compromised, it could be used to compromise equipment that
              it was connected to (through long haul links even), assuming that
              those pieces of equipment could also be forced through a
              factory reset.<a class="pilcrow" href="#section-11.6.2.1-2">¶</a></p>
<p id="section-11.6.2.1-3">
              The above scenario seems rather unlikely as it requires some
              element of physical access; but if there was a remote exploit
              that did not cause a direct breach, but rather a fault that
              resulted in a factory reset, this could provide a reasonable
              path.<a class="pilcrow" href="#section-11.6.2.1-3">¶</a></p>
<p id="section-11.6.2.1-4">
              The above deals with ANI uses of BRSKI.  For cases where IEEE 802.11
              or 802.15.4 is involved, the need to connect directly to the
              device is eliminated, but the need to do a factory reset is
              not.  Physical possession of the device is not required as
              above, provided that there is some way to force a factory
              reset.  With some consumer devices that have low overall
              implementation quality, end users might be familiar with the
              need to reset the device regularly.<a class="pilcrow" href="#section-11.6.2.1-4">¶</a></p>
<p id="section-11.6.2.1-5">
              The authors are unable to come up with an attack scenario where
              a compromised voucher signature enables an attacker to
              introduce a compromised pledge into an existing operator's
              network.  This is the case because the operator controls the
              communication between registrar and MASA, and there is no
              opportunity to introduce the fake voucher through that conduit.<a class="pilcrow" href="#section-11.6.2.1-5">¶</a></p>
</section>
<section id="section-11.6.2.2">
            <h5 id="name-risks-after-key-compromise-">
<a class="section-number selfRef" href="#section-11.6.2.2">11.6.2.2. </a><a class="section-name selfRef" href="#name-risks-after-key-compromise-">Risks after Key Compromise is Known</a>
            </h5>
<p id="section-11.6.2.2-1">
              Once the operator of the MASA realizes that the voucher signing
              key has been compromised, it has to do a few things.<a class="pilcrow" href="#section-11.6.2.2-1">¶</a></p>
<p id="section-11.6.2.2-2">
              First, it <span class="bcp14">MUST</span> issue a firmware update to all devices that
              had that key as a trust anchor, such that they will no longer
              trust vouchers from that key.  This will affect devices in the
              field that are operating, but those devices, being in
              operation, are not performing onboarding operations, so this
              is not a critical patch.<a class="pilcrow" href="#section-11.6.2.2-2">¶</a></p>
<p id="section-11.6.2.2-3">
              Devices in boxes (in warehouses) are vulnerable and remain
              vulnerable until patched.   An operator would be prudent to
              unbox the devices, onboard them in a safe environment, and
              then perform firmware updates.  This does not have to be
              done by the end-operator; it could be done by a distributor
              that stores the spares.  A recommended practice for high-value
              devices (which typically have a &lt;4hr service window) may be to
              validate the device operation on a regular basis anyway.<a class="pilcrow" href="#section-11.6.2.2-3">¶</a></p>
<p id="section-11.6.2.2-4">
              If the onboarding process includes attestations about firmware
              versions, then through that process, the operator would be
              advised to upgrade the firmware before going into production.
              Unfortunately, this does not help against situations where the
              attacker operates their own registrar (as listed above).<a class="pilcrow" href="#section-11.6.2.2-4">¶</a></p>
<p id="section-11.6.2.2-5">
              The need for short-lived vouchers is explained in <span>[<a class="xref" href="#RFC8366">RFC8366</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc8366#section-6.1">Section 6.1</a></span>.  The nonce guarantees freshness,
              and the short-lived nature of the voucher means that the window
              to deliver a fake voucher is very short.  A nonceless,
              long-lived voucher would be the only option for the attacker,
              and devices in the warehouse would be vulnerable to such a
              thing.<a class="pilcrow" href="#section-11.6.2.2-5">¶</a></p>
<p id="section-11.6.2.2-6">
              A key operational recommendation is for manufacturers to sign
              nonceless, long-lived vouchers with a different key than what is used to
              sign short-lived vouchers. That key needs significantly better
              protection.  If both keys come from a common trust-anchor
              (the manufacturer's CA), then a compromise of the
              manufacturer's CA would compromise both keys.  Such a
              compromise of the manufacturer's CA likely compromises
              all keys outlined in this section.<a class="pilcrow" href="#section-11.6.2.2-6">¶</a></p>
</section>
</section>
<section id="section-11.6.3">
          <h4 id="name-compromise-of-masa-web-serv">
<a class="section-number selfRef" href="#section-11.6.3">11.6.3. </a><a class="section-name selfRef" href="#name-compromise-of-masa-web-serv">Compromise of MASA Web Service</a>
          </h4>
<p id="section-11.6.3-1">
            An attacker that takes over the MASA web service can inflict a number of
            attacks.  The most obvious one is simply to take the database
            listing of customers and devices and sell the data to other
            attackers who will now know where to find potentially vulnerable
            devices.<a class="pilcrow" href="#section-11.6.3-1">¶</a></p>
<p id="section-11.6.3-2">
            The second most obvious thing that the attacker can do is to
            kill the service, or make it operate unreliably, making
            customers frustrated.  This could have a serious effect on
            the ability to deploy new services by customers and would be a
            significant issue during disaster recovery.<a class="pilcrow" href="#section-11.6.3-2">¶</a></p>
<p id="section-11.6.3-3">
            While the compromise of the MASA web service may lead to the
            compromise of the MASA voucher signing key, if the signing occurs
            offboard (such as in a hardware signing module (HSM)), then the
            key may well be safe, but control over it resides with the attacker.<a class="pilcrow" href="#section-11.6.3-3">¶</a></p>
<p id="section-11.6.3-4">
            Such an attacker can issue vouchers for any device presently in
            service.
     Said device still needs to be convinced to go through a
            factory reset process before an attack.<a class="pilcrow" href="#section-11.6.3-4">¶</a></p>
<p id="section-11.6.3-5">
            If the attacker has access to a key that is trusted for
            long-lived nonceless vouchers, then they could issue vouchers for
            devices that are not yet in service.  This attack may be very
            hard to verify as it would involve doing firmware updates
            on every device in warehouses (a potentially ruinously expensive
            process); a manufacturer might be reluctant to admit this
            possibility.<a class="pilcrow" href="#section-11.6.3-5">¶</a></p>
</section>
</section>
<section id="section-11.7">
        <h3 id="name-yang-module-security-consid">
<a class="section-number selfRef" href="#section-11.7">11.7. </a><a class="section-name selfRef" href="#name-yang-module-security-consid">YANG Module Security Considerations</a>
        </h3>
<p id="section-11.7-1">
          As described in Section <a class="relref" href="https://www.rfc-editor.org/rfc/rfc8366#section-7.4">7.4</a> (Security Considerations) of <span>[<a class="xref" href="#RFC8366">RFC8366</a>]</span>, the YANG module specified
          in this document defines the schema for data that is subsequently
          encapsulated by a CMS signed-data content type, as described in
          <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc5652#section-5">Section 5</a> of [<a class="xref" href="#RFC5652">RFC5652</a>]</span>.
          As such, all of the YANG-modeled data is protected from modification.<a class="pilcrow" href="#section-11.7-1">¶</a></p>
<p id="section-11.7-2">
           The use of YANG to define data structures, via the "yang-data"
           statement, is relatively new and distinct from the traditional use
           of YANG to define an API accessed by network management protocols
           such as NETCONF <span>[<a class="xref" href="#RFC6241">RFC6241</a>]</span> and RESTCONF <span>[<a class="xref" href="#RFC8040">RFC8040</a>]</span>. For this
           reason, these guidelines do not follow the template described by
           <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8407#section-3.7">Section 3.7</a> of [<a class="xref" href="#RFC8407">RFC8407</a>]</span>.<a class="pilcrow" href="#section-11.7-2">¶</a></p>
</section>
</section>
</div>
<section id="section-12">
      <h2 id="name-references">
<a class="section-number selfRef" href="#section-12">12. </a><a class="section-name selfRef" href="#name-references">References</a>
      </h2>
<section id="section-12.1">
        <h3 id="name-normative-references">
<a class="section-number selfRef" href="#section-12.1">12.1. </a><a class="section-name selfRef" href="#name-normative-references">Normative References</a>
        </h3>
<dl class="references">
<dt id="IDevID">[IDevID]</dt>
        <dd>
<span class="refAuthor">IEEE</span>, <span class="refTitle">"IEEE Standard for Local and metropolitan area networks - Secure Device Identity"</span>, <span class="refContent">IEEE 802.1AR</span>, <span>&lt;<a href="https://1.ieee802.org/security/802-1ar">https://1.ieee802.org/security/802-1ar</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ITU.X690">[ITU.X690]</dt>
        <dd>
<span class="refAuthor">ITU-T</span>, <span class="refTitle">"Information Technology - ASN.1 encoding rules: Specification of Basic Encoding Rules (BER), Canonical Encoding Rules (CER) and Distinguished Encoding Rules (DER)"</span>, <span class="refContent">ITU-T Recommendation X.690</span>, <span class="refContent">ISO/IEC 8825-1:2015</span>, <time class="refDate" datetime="2015-08">August 2015</time>, <span>&lt;<a href="https://www.itu.int/rec/T-REC-X.690">https://www.itu.int/rec/T-REC-X.690</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="REST">[REST]</dt>
        <dd>
<span class="refAuthor">Fielding, R.F.</span>, <span class="refTitle">"Architectural Styles and the Design of Network-based Software Architectures"</span>, <time class="refDate" datetime="2000">2000</time>, <span>&lt;<a href="http://www.ics.uci.edu/~fielding/pubs/dissertation/fielding_dissertation.pdf">http://www.ics.uci.edu/~fielding/pubs/dissertation/fielding_dissertation.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time class="refDate" datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3339">[RFC3339]</dt>
        <dd>
<span class="refAuthor">Klyne, G.</span> and <span class="refAuthor">C. Newman</span>, <span class="refTitle">"Date and Time on the Internet: Timestamps"</span>, <span class="seriesInfo">RFC 3339</span>, <span class="seriesInfo">DOI 10.17487/RFC3339</span>, <time class="refDate" datetime="2002-07">July 2002</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3339">https://www.rfc-editor.org/info/rfc3339</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3688">[RFC3688]</dt>
        <dd>
<span class="refAuthor">Mealling, M.</span>, <span class="refTitle">"The IETF XML Registry"</span>, <span class="seriesInfo">BCP 81</span>, <span class="seriesInfo">RFC 3688</span>, <span class="seriesInfo">DOI 10.17487/RFC3688</span>, <time class="refDate" datetime="2004-01">January 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3688">https://www.rfc-editor.org/info/rfc3688</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3748">[RFC3748]</dt>
        <dd>
<span class="refAuthor">Aboba, B.</span>, <span class="refAuthor">Blunk, L.</span>, <span class="refAuthor">Vollbrecht, J.</span>, <span class="refAuthor">Carlson, J.</span>, and <span class="refAuthor">H. Levkowetz, Ed.</span>, <span class="refTitle">"Extensible Authentication Protocol (EAP)"</span>, <span class="seriesInfo">RFC 3748</span>, <span class="seriesInfo">DOI 10.17487/RFC3748</span>, <time class="refDate" datetime="2004-06">June 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3748">https://www.rfc-editor.org/info/rfc3748</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3927">[RFC3927]</dt>
        <dd>
<span class="refAuthor">Cheshire, S.</span>, <span class="refAuthor">Aboba, B.</span>, and <span class="refAuthor">E. Guttman</span>, <span class="refTitle">"Dynamic Configuration of IPv4 Link-Local Addresses"</span>, <span class="seriesInfo">RFC 3927</span>, <span class="seriesInfo">DOI 10.17487/RFC3927</span>, <time class="refDate" datetime="2005-05">May 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3927">https://www.rfc-editor.org/info/rfc3927</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4086">[RFC4086]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span>, <span class="refAuthor">Schiller, J.</span>, and <span class="refAuthor">S. Crocker</span>, <span class="refTitle">"Randomness Requirements for Security"</span>, <span class="seriesInfo">BCP 106</span>, <span class="seriesInfo">RFC 4086</span>, <span class="seriesInfo">DOI 10.17487/RFC4086</span>, <time class="refDate" datetime="2005-06">June 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4086">https://www.rfc-editor.org/info/rfc4086</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4519">[RFC4519]</dt>
        <dd>
<span class="refAuthor">Sciberras, A., Ed.</span>, <span class="refTitle">"Lightweight Directory Access Protocol (LDAP): Schema for User Applications"</span>, <span class="seriesInfo">RFC 4519</span>, <span class="seriesInfo">DOI 10.17487/RFC4519</span>, <time class="refDate" datetime="2006-06">June 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4519">https://www.rfc-editor.org/info/rfc4519</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4648">[RFC4648]</dt>
        <dd>
<span class="refAuthor">Josefsson, S.</span>, <span class="refTitle">"The Base16, Base32, and Base64 Data Encodings"</span>, <span class="seriesInfo">RFC 4648</span>, <span class="seriesInfo">DOI 10.17487/RFC4648</span>, <time class="refDate" datetime="2006-10">October 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4648">https://www.rfc-editor.org/info/rfc4648</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4862">[RFC4862]</dt>
        <dd>
<span class="refAuthor">Thomson, S.</span>, <span class="refAuthor">Narten, T.</span>, and <span class="refAuthor">T. Jinmei</span>, <span class="refTitle">"IPv6 Stateless Address Autoconfiguration"</span>, <span class="seriesInfo">RFC 4862</span>, <span class="seriesInfo">DOI 10.17487/RFC4862</span>, <time class="refDate" datetime="2007-09">September 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4862">https://www.rfc-editor.org/info/rfc4862</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5272">[RFC5272]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span> and <span class="refAuthor">M. Myers</span>, <span class="refTitle">"Certificate Management over CMS (CMC)"</span>, <span class="seriesInfo">RFC 5272</span>, <span class="seriesInfo">DOI 10.17487/RFC5272</span>, <time class="refDate" datetime="2008-06">June 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5272">https://www.rfc-editor.org/info/rfc5272</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5280">[RFC5280]</dt>
        <dd>
<span class="refAuthor">Cooper, D.</span>, <span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Boeyen, S.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time class="refDate" datetime="2008-05">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5280">https://www.rfc-editor.org/info/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5652">[RFC5652]</dt>
        <dd>
<span class="refAuthor">Housley, R.</span>, <span class="refTitle">"Cryptographic Message Syntax (CMS)"</span>, <span class="seriesInfo">STD 70</span>, <span class="seriesInfo">RFC 5652</span>, <span class="seriesInfo">DOI 10.17487/RFC5652</span>, <time class="refDate" datetime="2009-09">September 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5652">https://www.rfc-editor.org/info/rfc5652</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6020">[RFC6020]</dt>
        <dd>
<span class="refAuthor">Bjorklund, M., Ed.</span>, <span class="refTitle">"YANG - A Data Modeling Language for the Network Configuration Protocol (NETCONF)"</span>, <span class="seriesInfo">RFC 6020</span>, <span class="seriesInfo">DOI 10.17487/RFC6020</span>, <time class="refDate" datetime="2010-10">October 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6020">https://www.rfc-editor.org/info/rfc6020</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6125">[RFC6125]</dt>
        <dd>
<span class="refAuthor">Saint-Andre, P.</span> and <span class="refAuthor">J. Hodges</span>, <span class="refTitle">"Representation and Verification of Domain-Based Application Service Identity within Internet Public Key Infrastructure Using X.509 (PKIX) Certificates in the Context of Transport Layer Security (TLS)"</span>, <span class="seriesInfo">RFC 6125</span>, <span class="seriesInfo">DOI 10.17487/RFC6125</span>, <time class="refDate" datetime="2011-03">March 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6125">https://www.rfc-editor.org/info/rfc6125</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6241">[RFC6241]</dt>
        <dd>
<span class="refAuthor">Enns, R., Ed.</span>, <span class="refAuthor">Bjorklund, M., Ed.</span>, <span class="refAuthor">Schoenwaelder, J., Ed.</span>, and <span class="refAuthor">A. Bierman, Ed.</span>, <span class="refTitle">"Network Configuration Protocol (NETCONF)"</span>, <span class="seriesInfo">RFC 6241</span>, <span class="seriesInfo">DOI 10.17487/RFC6241</span>, <time class="refDate" datetime="2011-06">June 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6241">https://www.rfc-editor.org/info/rfc6241</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6762">[RFC6762]</dt>
        <dd>
<span class="refAuthor">Cheshire, S.</span> and <span class="refAuthor">M. Krochmal</span>, <span class="refTitle">"Multicast DNS"</span>, <span class="seriesInfo">RFC 6762</span>, <span class="seriesInfo">DOI 10.17487/RFC6762</span>, <time class="refDate" datetime="2013-02">February 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6762">https://www.rfc-editor.org/info/rfc6762</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6763">[RFC6763]</dt>
        <dd>
<span class="refAuthor">Cheshire, S.</span> and <span class="refAuthor">M. Krochmal</span>, <span class="refTitle">"DNS-Based Service Discovery"</span>, <span class="seriesInfo">RFC 6763</span>, <span class="seriesInfo">DOI 10.17487/RFC6763</span>, <time class="refDate" datetime="2013-02">February 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6763">https://www.rfc-editor.org/info/rfc6763</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7030">[RFC7030]</dt>
        <dd>
<span class="refAuthor">Pritikin, M., Ed.</span>, <span class="refAuthor">Yee, P., Ed.</span>, and <span class="refAuthor">D. Harkins, Ed.</span>, <span class="refTitle">"Enrollment over Secure Transport"</span>, <span class="seriesInfo">RFC 7030</span>, <span class="seriesInfo">DOI 10.17487/RFC7030</span>, <time class="refDate" datetime="2013-10">October 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7030">https://www.rfc-editor.org/info/rfc7030</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7230">[RFC7230]</dt>
        <dd>
<span class="refAuthor">Fielding, R., Ed.</span> and <span class="refAuthor">J. Reschke, Ed.</span>, <span class="refTitle">"Hypertext Transfer Protocol (HTTP/1.1): Message Syntax and Routing"</span>, <span class="seriesInfo">RFC 7230</span>, <span class="seriesInfo">DOI 10.17487/RFC7230</span>, <time class="refDate" datetime="2014-06">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7230">https://www.rfc-editor.org/info/rfc7230</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7231">[RFC7231]</dt>
        <dd>
<span class="refAuthor">Fielding, R., Ed.</span> and <span class="refAuthor">J. Reschke, Ed.</span>, <span class="refTitle">"Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content"</span>, <span class="seriesInfo">RFC 7231</span>, <span class="seriesInfo">DOI 10.17487/RFC7231</span>, <time class="refDate" datetime="2014-06">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7231">https://www.rfc-editor.org/info/rfc7231</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7469">[RFC7469]</dt>
        <dd>
<span class="refAuthor">Evans, C.</span>, <span class="refAuthor">Palmer, C.</span>, and <span class="refAuthor">R. Sleevi</span>, <span class="refTitle">"Public Key Pinning Extension for HTTP"</span>, <span class="seriesInfo">RFC 7469</span>, <span class="seriesInfo">DOI 10.17487/RFC7469</span>, <time class="refDate" datetime="2015-04">April 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7469">https://www.rfc-editor.org/info/rfc7469</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7950">[RFC7950]</dt>
        <dd>
<span class="refAuthor">Bjorklund, M., Ed.</span>, <span class="refTitle">"The YANG 1.1 Data Modeling Language"</span>, <span class="seriesInfo">RFC 7950</span>, <span class="seriesInfo">DOI 10.17487/RFC7950</span>, <time class="refDate" datetime="2016-08">August 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7950">https://www.rfc-editor.org/info/rfc7950</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7951">[RFC7951]</dt>
        <dd>
<span class="refAuthor">Lhotka, L.</span>, <span class="refTitle">"JSON Encoding of Data Modeled with YANG"</span>, <span class="seriesInfo">RFC 7951</span>, <span class="seriesInfo">DOI 10.17487/RFC7951</span>, <time class="refDate" datetime="2016-08">August 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7951">https://www.rfc-editor.org/info/rfc7951</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8040">[RFC8040]</dt>
        <dd>
<span class="refAuthor">Bierman, A.</span>, <span class="refAuthor">Bjorklund, M.</span>, and <span class="refAuthor">K. Watsen</span>, <span class="refTitle">"RESTCONF Protocol"</span>, <span class="seriesInfo">RFC 8040</span>, <span class="seriesInfo">DOI 10.17487/RFC8040</span>, <time class="refDate" datetime="2017-01">January 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8040">https://www.rfc-editor.org/info/rfc8040</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time class="refDate" datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8259">[RFC8259]</dt>
        <dd>
<span class="refAuthor">Bray, T., Ed.</span>, <span class="refTitle">"The JavaScript Object Notation (JSON) Data Interchange Format"</span>, <span class="seriesInfo">STD 90</span>, <span class="seriesInfo">RFC 8259</span>, <span class="seriesInfo">DOI 10.17487/RFC8259</span>, <time class="refDate" datetime="2017-12">December 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8259">https://www.rfc-editor.org/info/rfc8259</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8366">[RFC8366]</dt>
        <dd>
<span class="refAuthor">Watsen, K.</span>, <span class="refAuthor">Richardson, M.</span>, <span class="refAuthor">Pritikin, M.</span>, and <span class="refAuthor">T. Eckert</span>, <span class="refTitle">"A Voucher Artifact for Bootstrapping Protocols"</span>, <span class="seriesInfo">RFC 8366</span>, <span class="seriesInfo">DOI 10.17487/RFC8366</span>, <time class="refDate" datetime="2018-05">May 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8366">https://www.rfc-editor.org/info/rfc8366</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8368">[RFC8368]</dt>
        <dd>
<span class="refAuthor">Eckert, T., Ed.</span> and <span class="refAuthor">M. Behringer</span>, <span class="refTitle">"Using an Autonomic Control Plane for Stable Connectivity of Network Operations, Administration, and Maintenance (OAM)"</span>, <span class="seriesInfo">RFC 8368</span>, <span class="seriesInfo">DOI 10.17487/RFC8368</span>, <time class="refDate" datetime="2018-05">May 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8368">https://www.rfc-editor.org/info/rfc8368</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8407">[RFC8407]</dt>
        <dd>
<span class="refAuthor">Bierman, A.</span>, <span class="refTitle">"Guidelines for Authors and Reviewers of Documents Containing YANG Data Models"</span>, <span class="seriesInfo">BCP 216</span>, <span class="seriesInfo">RFC 8407</span>, <span class="seriesInfo">DOI 10.17487/RFC8407</span>, <time class="refDate" datetime="2018-10">October 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8407">https://www.rfc-editor.org/info/rfc8407</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time class="refDate" datetime="2018-08">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8610">[RFC8610]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Vigano, C.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"Concise Data Definition Language (CDDL): A Notational Convention to Express Concise Binary Object Representation (CBOR) and JSON Data Structures"</span>, <span class="seriesInfo">RFC 8610</span>, <span class="seriesInfo">DOI 10.17487/RFC8610</span>, <time class="refDate" datetime="2019-06">June 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8610">https://www.rfc-editor.org/info/rfc8610</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8951">[RFC8951]</dt>
        <dd>
<span class="refAuthor">Richardson, M.</span>, <span class="refAuthor">Werner, T.</span>, and <span class="refAuthor">W. Pan</span>, <span class="refTitle">"Clarification of Enrollment over Secure Transport (EST): Transfer Encodings and ASN.1"</span>, <span class="seriesInfo">RFC 8951</span>, <span class="seriesInfo">DOI 10.17487/RFC8951</span>, <time class="refDate" datetime="2020-11">November 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8951">https://www.rfc-editor.org/info/rfc8951</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8981">[RFC8981]</dt>
        <dd>
<span class="refAuthor">Gont, F.</span>, <span class="refAuthor">Krishnan, S.</span>, <span class="refAuthor">Narten, T.</span>, and <span class="refAuthor">R. Draves</span>, <span class="refTitle">"Temporary Address Extensions for Stateless Address Autoconfiguration in IPv6"</span>, <span class="seriesInfo">RFC 8981</span>, <span class="seriesInfo">DOI 10.17487/RFC8981</span>, <time class="refDate" datetime="2021-02">February 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8981">https://www.rfc-editor.org/info/rfc8981</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8990">[RFC8990]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span>, <span class="refAuthor">Carpenter, B., Ed.</span>, and <span class="refAuthor">B. Liu, Ed.</span>, <span class="refTitle">"GeneRic Autonomic Signaling Protocol (GRASP)"</span>, <span class="seriesInfo">RFC 8990</span>, <span class="seriesInfo">DOI 10.17487/RFC8990</span>, <time class="refDate" datetime="2021-05">May 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8990">https://www.rfc-editor.org/rfc/rfc8990</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8994">[RFC8994]</dt>
      <dd>
<span class="refAuthor">Eckert, T., Ed.</span>, <span class="refAuthor">Behringer, M., Ed.</span>, and <span class="refAuthor">S. Bjarnason</span>, <span class="refTitle">"An Autonomic Control Plane (ACP)"</span>, <span class="seriesInfo">RFC 8994</span>, <span class="seriesInfo">DOI 10.17487/RFC8994</span>, <time class="refDate" datetime="2021-05">May 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8994">https://www.rfc-editor.org/rfc/rfc8994</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-12.2">
        <h3 id="name-informative-references">
<a class="section-number selfRef" href="#section-12.2">12.2. </a><a class="section-name selfRef" href="#name-informative-references">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-ace-coap-est">[ACE-COAP-EST]</dt>
        <dd>
<span class="refAuthor">van der Stok, P.</span>, <span class="refAuthor">Kampanakis, P.</span>, <span class="refAuthor">Richardson, M.</span>, and <span class="refAuthor">S. Raza</span>, <span class="refTitle">"EST over secure CoAP (EST-coaps)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-ace-coap-est-18</span>, <time class="refDate" datetime="2020-01-06">6 January 2020</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-ace-coap-est-18">https://tools.ietf.org/html/draft-ietf-ace-coap-est-18</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-anima-constrained-voucher">[ANIMA-CONSTRAINED-VOUCHER]</dt>
        <dd>
<span class="refAuthor">Richardson, M.</span>, <span class="refAuthor">van der Stok, P.</span>, <span class="refAuthor">Kampanakis, P.</span>, and <span class="refAuthor">E. Dijk</span>, <span class="refTitle">"Constrained Voucher Artifacts for Bootstrapping Protocols"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-anima-constrained-voucher-10</span>, <time class="refDate" datetime="2021-02-21">21 February 2021</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-anima-constrained-voucher-10">https://tools.ietf.org/html/draft-ietf-anima-constrained-voucher-10</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.richardson-anima-state-for-joinrouter">[ANIMA-STATE]</dt>
        <dd>
<span class="refAuthor">Richardson, M.</span>, <span class="refTitle">"Considerations for stateful vs stateless join router in ANIMA bootstrap"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-richardson-anima-state-for-joinrouter-03</span>, <time class="refDate" datetime="2020-09-22">22 September 2020</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-richardson-anima-state-for-joinrouter-03">https://tools.ietf.org/html/draft-richardson-anima-state-for-joinrouter-03</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="brewski">[brewski]</dt>
        <dd>
<span class="refAuthor">Urban Dictionary</span>, <span class="refTitle">"brewski"</span>, <time class="refDate" datetime="2003-03">March 2003</time>, <span>&lt;<a href="https://www.urbandictionary.com/define.php?term=brewski">https://www.urbandictionary.com/define.php?term=brewski</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="cabforumaudit">[cabforumaudit]</dt>
        <dd>
<span class="refAuthor">CA/Browser Forum</span>, <span class="refTitle">"Information for Auditors and Assessors"</span>, <time class="refDate" datetime="2019-08">August 2019</time>, <span>&lt;<a href="https://cabforum.org/information-for-auditors-and-assessors/">https://cabforum.org/information-for-auditors-and-assessors/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Dingledine">[Dingledine]</dt>
        <dd>
<span class="refAuthor">Dingledine, R.</span>, <span class="refAuthor">Mathewson, N.</span>, and <span class="refAuthor">P. Syverson</span>, <span class="refTitle">"Tor: The Second-Generation Onion Router"</span>, <time class="refDate" datetime="2004-08">August 2004</time>, <span>&lt;<a href="https://svn-archive.torproject.org/svn/projects/design-paper/tor-design.pdf">https://svn-archive.torproject.org/svn/projects/design-paper/tor-design.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="dnssecroot">[dnssecroot]</dt>
        <dd>
<span class="refTitle">"DNSSEC Practice Statement for the Root Zone ZSK Operator"</span>, <time class="refDate" datetime="2017-12">December 2017</time>, <span>&lt;<a href="https://www.iana.org/dnssec/procedures/zsk-operator/dps-zsk-operator-v2.1.pdf">https://www.iana.org/dnssec/procedures/zsk-operator/dps-zsk-operator-v2.1.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="docsisroot">[docsisroot]</dt>
        <dd>
<span class="refTitle">"CableLabs Digital Certificate Issuance Service"</span>, <time class="refDate" datetime="2018-02">February 2018</time>, <span>&lt;<a href="https://www.cablelabs.com/resources/digital-certificate-issuance-service/">https://www.cablelabs.com/resources/digital-certificate-issuance-service/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="imprinting">[imprinting]</dt>
        <dd>
<span class="refAuthor">Wikipedia</span>, <span class="refTitle">"Imprinting (psychology)"</span>, <time class="refDate" datetime="2021-01">January 2021</time>, <span>&lt;<a href="https://en.wikipedia.org/w/index.php?title=Imprinting_(psychology)&amp;=999211441">https://en.wikipedia.org/w/index.php?title=Imprinting_(psychology)&amp;=999211441</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IoTstrangeThings">[IoTstrangeThings]</dt>
        <dd>
<span class="refAuthor">ESET</span>, <span class="refTitle">"IoT of toys stranger than fiction: Cybersecurity and data privacy update"</span>, <time class="refDate" datetime="2017-03">March 2017</time>, <span>&lt;<a href="https://www.welivesecurity.com/2017/03/03/internet-of-things-security-privacy-iot-update/">https://www.welivesecurity.com/2017/03/03/internet-of-things-security-privacy-iot-update/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="livingwithIoT">[livingwithIoT]</dt>
        <dd>
<span class="refAuthor">Silicon Republic</span>, <span class="refTitle">"What is it actually like to live in a house filled with IoT devices?"</span>, <time class="refDate" datetime="2018-02">February 2018</time>, <span>&lt;<a href="https://www.siliconrepublic.com/machines/iot-smart-devices-reality">https://www.siliconrepublic.com/machines/iot-smart-devices-reality</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="minerva">[minerva]</dt>
        <dd>
<span class="refAuthor">Richardson, M.</span>, <span class="refTitle">"Minerva reference implementation for BRSKI"</span>, <time class="refDate" datetime="2020">2020</time>, <span>&lt;<a href="https://minerva.sandelman.ca/">https://minerva.sandelman.ca/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="minervagithub">[minervagithub]</dt>
        <dd>
<span class="refTitle">"ANIMA Minerva toolkit"</span>, <span>&lt;<a href="https://github.com/ANIMAgus-minerva">https://github.com/ANIMAgus-minerva</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="openssl">[openssl]</dt>
        <dd>
<span class="refAuthor">OpenSSL</span>, <span class="refTitle">"OpenSSL X509 Utility"</span>, <time class="refDate" datetime="2019-09">September 2019</time>, <span>&lt;<a href="https://www.openssl.org/docs/man1.1.1/man1/openssl-x509.html/">https://www.openssl.org/docs/man1.1.1/man1/openssl-x509.html/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2131">[RFC2131]</dt>
        <dd>
<span class="refAuthor">Droms, R.</span>, <span class="refTitle">"Dynamic Host Configuration Protocol"</span>, <span class="seriesInfo">RFC 2131</span>, <span class="seriesInfo">DOI 10.17487/RFC2131</span>, <time class="refDate" datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2131">https://www.rfc-editor.org/info/rfc2131</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2663">[RFC2663]</dt>
        <dd>
<span class="refAuthor">Srisuresh, P.</span> and <span class="refAuthor">M. Holdrege</span>, <span class="refTitle">"IP Network Address Translator (NAT) Terminology and Considerations"</span>, <span class="seriesInfo">RFC 2663</span>, <span class="seriesInfo">DOI 10.17487/RFC2663</span>, <time class="refDate" datetime="1999-08">August 1999</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2663">https://www.rfc-editor.org/info/rfc2663</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5209">[RFC5209]</dt>
        <dd>
<span class="refAuthor">Sangster, P.</span>, <span class="refAuthor">Khosravi, H.</span>, <span class="refAuthor">Mani, M.</span>, <span class="refAuthor">Narayan, K.</span>, and <span class="refAuthor">J. Tardo</span>, <span class="refTitle">"Network Endpoint Assessment (NEA): Overview and Requirements"</span>, <span class="seriesInfo">RFC 5209</span>, <span class="seriesInfo">DOI 10.17487/RFC5209</span>, <time class="refDate" datetime="2008-06">June 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5209">https://www.rfc-editor.org/info/rfc5209</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6960">[RFC6960]</dt>
        <dd>
<span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Myers, M.</span>, <span class="refAuthor">Ankney, R.</span>, <span class="refAuthor">Malpani, A.</span>, <span class="refAuthor">Galperin, S.</span>, and <span class="refAuthor">C. Adams</span>, <span class="refTitle">"X.509 Internet Public Key Infrastructure Online Certificate Status Protocol - OCSP"</span>, <span class="seriesInfo">RFC 6960</span>, <span class="seriesInfo">DOI 10.17487/RFC6960</span>, <time class="refDate" datetime="2013-06">June 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6960">https://www.rfc-editor.org/info/rfc6960</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6961">[RFC6961]</dt>
        <dd>
<span class="refAuthor">Pettersen, Y.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Multiple Certificate Status Request Extension"</span>, <span class="seriesInfo">RFC 6961</span>, <span class="seriesInfo">DOI 10.17487/RFC6961</span>, <time class="refDate" datetime="2013-06">June 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6961">https://www.rfc-editor.org/info/rfc6961</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7228">[RFC7228]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span>, <span class="refAuthor">Ersue, M.</span>, and <span class="refAuthor">A. Keranen</span>, <span class="refTitle">"Terminology for Constrained-Node Networks"</span>, <span class="seriesInfo">RFC 7228</span>, <span class="seriesInfo">DOI 10.17487/RFC7228</span>, <time class="refDate" datetime="2014-05">May 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7228">https://www.rfc-editor.org/info/rfc7228</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7258">[RFC7258]</dt>
        <dd>
<span class="refAuthor">Farrell, S.</span> and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"Pervasive Monitoring Is an Attack"</span>, <span class="seriesInfo">BCP 188</span>, <span class="seriesInfo">RFC 7258</span>, <span class="seriesInfo">DOI 10.17487/RFC7258</span>, <time class="refDate" datetime="2014-05">May 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7258">https://www.rfc-editor.org/info/rfc7258</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7435">[RFC7435]</dt>
        <dd>
<span class="refAuthor">Dukhovni, V.</span>, <span class="refTitle">"Opportunistic Security: Some Protection Most of the Time"</span>, <span class="seriesInfo">RFC 7435</span>, <span class="seriesInfo">DOI 10.17487/RFC7435</span>, <time class="refDate" datetime="2014-12">December 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7435">https://www.rfc-editor.org/info/rfc7435</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7575">[RFC7575]</dt>
        <dd>
<span class="refAuthor">Behringer, M.</span>, <span class="refAuthor">Pritikin, M.</span>, <span class="refAuthor">Bjarnason, S.</span>, <span class="refAuthor">Clemm, A.</span>, <span class="refAuthor">Carpenter, B.</span>, <span class="refAuthor">Jiang, S.</span>, and <span class="refAuthor">L. Ciavaglia</span>, <span class="refTitle">"Autonomic Networking: Definitions and Design Goals"</span>, <span class="seriesInfo">RFC 7575</span>, <span class="seriesInfo">DOI 10.17487/RFC7575</span>, <time class="refDate" datetime="2015-06">June 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7575">https://www.rfc-editor.org/info/rfc7575</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time class="refDate" datetime="2017-06">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8340">[RFC8340]</dt>
        <dd>
<span class="refAuthor">Bjorklund, M.</span> and <span class="refAuthor">L. Berger, Ed.</span>, <span class="refTitle">"YANG Tree Diagrams"</span>, <span class="seriesInfo">BCP 215</span>, <span class="seriesInfo">RFC 8340</span>, <span class="seriesInfo">DOI 10.17487/RFC8340</span>, <time class="refDate" datetime="2018-03">March 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8340">https://www.rfc-editor.org/info/rfc8340</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8615">[RFC8615]</dt>
        <dd>
<span class="refAuthor">Nottingham, M.</span>, <span class="refTitle">"Well-Known Uniform Resource Identifiers (URIs)"</span>, <span class="seriesInfo">RFC 8615</span>, <span class="seriesInfo">DOI 10.17487/RFC8615</span>, <time class="refDate" datetime="2019-05">May 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8615">https://www.rfc-editor.org/info/rfc8615</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8993">[RFC8993]</dt>
        <dd>
<span class="refAuthor">Behringer, M., Ed.</span>, <span class="refAuthor">Carpenter, B.</span>, <span class="refAuthor">Eckert, T.</span>, <span class="refAuthor">Ciavaglia, L.</span>, and <span class="refAuthor">J. Nobre</span>, <span class="refTitle">"A Reference Model for Autonomic Networking"</span>, <span class="seriesInfo">RFC 8993</span>, <span class="seriesInfo">DOI 10.17487/RFC8993</span>, <time class="refDate" datetime="2021-05">May 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8993">https://www.rfc-editor.org/info/rfc8993</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="slowloris">[slowloris]</dt>
        <dd>
<span class="refAuthor">Wikipedia</span>, <span class="refTitle">"Slowloris (computer security)"</span>, <time class="refDate" datetime="2021-01">January 2021</time>, <span>&lt;<a href="https://en.wikipedia.org/w/index.php?title=Slowloris_(computer_security)&amp;oldid=1001473290/">https://en.wikipedia.org/w/index.php?title=Slowloris_(computer_security)&amp;oldid=1001473290/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="softwareescrow">[softwareescrow]</dt>
        <dd>
<span class="refAuthor">Wikipedia</span>, <span class="refTitle">"Source code escrow"</span>, <time class="refDate" datetime="2020-03">March 2020</time>, <span>&lt;<a href="https://en.wikipedia.org/w/index.php?title=Source_code_escrow&amp;oldid=948073074">https://en.wikipedia.org/w/index.php?title=Source_code_escrow&amp;oldid=948073074</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Stajano99theresurrecting">[Stajano99theresurrecting]</dt>
        <dd>
<span class="refAuthor">Stajano, F.</span> and <span class="refAuthor">R. Anderson</span>, <span class="refTitle">"The Resurrecting Duckling: Security Issues for Ad-hoc Wireless Networks"</span>, <time class="refDate" datetime="1999">1999</time>, <span>&lt;<a href="https://www.cl.cam.ac.uk/~fms27/papers/1999-StajanoAnd-duckling.pdf">https://www.cl.cam.ac.uk/~fms27/papers/1999-StajanoAnd-duckling.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TR069">[TR069]</dt>
        <dd>
<span class="refAuthor">Broadband Forum</span>, <span class="refTitle">"CPE WAN Management Protocol"</span>, <span class="refContent">TR-069, Issue 1, Amendment 6</span>, <time class="refDate" datetime="2018-03">March 2018</time>, <span>&lt;<a href="https://www.broadband-forum.org/download/TR-069_Amendment-6.pdf">https://www.broadband-forum.org/download/TR-069_Amendment-6.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="W3C.capability-urls">[W3C.capability-urls]</dt>
        <dd>
<span class="refAuthor">Tennison, J.</span>, <span class="refTitle">"Good Practices for Capability URLs"</span>, <span class="refContent">W3C First Public Working Draft</span>, <span class="seriesInfo">World Wide Web Consortium WD WD-capability-urls-20140218</span>, <time class="refDate" datetime="2014-02">February 2014</time>, <span>&lt;<a href="https://www.w3.org/TR/2014/WD-capability-urls">https://www.w3.org/TR/2014/WD-capability-urls</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-netconf-keystore">[YANG-KEYSTORE]</dt>
      <dd>
<span class="refAuthor">Watsen, K.</span>, <span class="refTitle">"A YANG Data Model for a Keystore"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-netconf-keystore-22</span>, <time class="refDate" datetime="2021-05-18">18 May 2021</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-netconf-keystore-22">https://tools.ietf.org/html/draft-ietf-netconf-keystore-22</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="IPv4operations">
<section id="section-appendix.a">
      <h2 id="name-ipv4-and-non-ani-operations">
<a class="section-number selfRef" href="#section-appendix.a">Appendix A. </a><a class="section-name selfRef" href="#name-ipv4-and-non-ani-operations">IPv4 and Non-ANI Operations</a>
      </h2>
<p id="section-appendix.a-1">
        The specification of BRSKI in <a class="xref" href="#proxydetails">Section 4</a>
        intentionally covers only the mechanisms for an IPv6 pledge using
        link-local addresses.  This section describes non-normative
        extensions that can be used in other environments.<a class="pilcrow" href="#section-appendix.a-1">¶</a></p>
<section id="section-a.1">
        <h2 id="name-ipv4-link-local-addresses">
<a class="section-number selfRef" href="#section-a.1">A.1. </a><a class="section-name selfRef" href="#name-ipv4-link-local-addresses">IPv4 Link-Local Addresses</a>
        </h2>
<p id="section-a.1-1">Instead of an IPv6 link-local address, an IPv4 address may be
      generated using "Dynamic Configuration of
      IPv4 Link-Local Addresses" <span>[<a class="xref" href="#RFC3927">RFC3927</a>]</span>.<a class="pilcrow" href="#section-a.1-1">¶</a></p>
<p id="section-a.1-2"> In the case where an IPv4 link-local address is formed, the
      bootstrap process would continue, as in an IPv6 case, by looking for
      a (circuit) proxy.<a class="pilcrow" href="#section-a.1-2">¶</a></p>
</section>
<div id="IPv4dhcp">
<section id="section-a.2">
        <h2 id="name-use-of-dhcpv4">
<a class="section-number selfRef" href="#section-a.2">A.2. </a><a class="section-name selfRef" href="#name-use-of-dhcpv4">Use of DHCPv4</a>
        </h2>
<p id="section-a.2-1">
        The pledge <span class="bcp14">MAY</span> obtain an IP address via
        DHCP (<span>[<a class="xref" href="#RFC2131">RFC2131</a>]</span>. The DHCP-provided parameters for the Domain Name
        System can be used to perform DNS operations if all
        local discovery attempts fail.<a class="pilcrow" href="#section-a.2-1">¶</a></p>
</section>
</div>
</section>
</div>
<div id="mdnsmethods">
<section id="section-appendix.b">
      <h2 id="name-mdns-dns-sd-proxy-discovery">
<a class="section-number selfRef" href="#section-appendix.b">Appendix B. </a><a class="section-name selfRef" href="#name-mdns-dns-sd-proxy-discovery">mDNS / DNS-SD Proxy Discovery Options</a>
      </h2>
<p id="section-appendix.b-1">Pledge discovery of the proxy (<a class="xref" href="#discovery">Section 4.1</a>) <span class="bcp14">MAY</span> be performed with DNS-based Service Discovery <span>[<a class="xref" href="#RFC6763">RFC6763</a>]</span> over Multicast DNS <span>[<a class="xref" href="#RFC6762">RFC6762</a>]</span> to discover the proxy at
      "_brski-proxy._tcp.local.".<a class="pilcrow" href="#section-appendix.b-1">¶</a></p>
<p id="section-appendix.b-2">Proxy discovery of the registrar (<a class="xref" href="#JRCgrasp">Section 4.3</a>) <span class="bcp14">MAY</span> be performed with DNS-based Service Discovery over Multicast DNS to discover registrars by searching for the service
        "_brski-registrar._tcp.local.".<a class="pilcrow" href="#section-appendix.b-2">¶</a></p>
<p id="section-appendix.b-3">
        To prevent unacceptable levels of
        network traffic, when using mDNS, the congestion avoidance mechanisms
        specified in
        <span>[<a class="xref" href="#RFC6762">RFC6762</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc6762#section-7">Section 7</a></span> <span class="bcp14">MUST</span> be followed. The
        pledge <span class="bcp14">SHOULD</span> listen for an unsolicited broadcast response as
        described in <span>[<a class="xref" href="#RFC6762">RFC6762</a>]</span>. This allows devices
        to avoid announcing their presence via mDNS broadcasts and
        instead silently join a network by watching for periodic
        unsolicited broadcast responses.<a class="pilcrow" href="#section-appendix.b-3">¶</a></p>
<p id="section-appendix.b-4">
        Discovery of the registrar <span class="bcp14">MAY</span> also be performed with DNS-based
        Service Discovery by searching for the service "_brski-registrar._tcp.example.com".
        In this case, the domain
        "example.com" is discovered as described in <span>[<a class="xref" href="#RFC6763">RFC6763</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc6763#section-11">Section 11</a></span> (<a class="xref" href="#IPv4dhcp">Appendix A.2</a> of this document
        suggests the use of DHCP parameters).<a class="pilcrow" href="#section-appendix.b-4">¶</a></p>
<p id="section-appendix.b-5">
        If no local proxy or registrar service is located using the GRASP
        mechanisms or the above-mentioned DNS-based Service Discovery
        methods, the pledge <span class="bcp14">MAY</span> contact a well-known
        manufacturer-provided bootstrapping server by performing a DNS
        lookup using a well-known URI such as
        "brski-registrar.manufacturer.example.com". The details of the URI are
        manufacturer specific. Manufacturers that leverage this method on the
        pledge
        are responsible for providing the registrar service.
        Also see <a class="xref" href="#cloudregistrar">Section 2.7</a>.<a class="pilcrow" href="#section-appendix.b-5">¶</a></p>
<p id="section-appendix.b-6">
        The current DNS services returned
          during each query are maintained until bootstrapping is completed. If
          bootstrapping fails and the pledge returns to the Discovery state, it
          picks up where it left off and continues attempting bootstrapping.
          For example, if the first Multicast DNS _bootstrapks._tcp.local
          response doesn't work, then the second and third responses are tried.
          If these fail, the pledge moves on to normal DNS-based Service
          Discovery.<a class="pilcrow" href="#section-appendix.b-6">¶</a></p>
</section>
</div>
<section id="section-appendix.c">
      <h2 id="name-example-vouchers">
<a class="section-number selfRef" href="#section-appendix.c">Appendix C. </a><a class="section-name selfRef" href="#name-example-vouchers">Example Vouchers</a>
      </h2>
<p id="section-appendix.c-1">
        Three entities are involved in a voucher: the MASA issues (signs)
        it, the registrar's public key is mentioned in it, and the
        pledge validates it.  In order to provide reproducible examples,
        the public and private keys for an example MASA and registrar are
        listed first.<a class="pilcrow" href="#section-appendix.c-1">¶</a></p>
<p id="section-appendix.c-2">
        The keys come from an open source reference implementation of BRSKI,
        called "Minerva" <span>[<a class="xref" href="#minerva">minerva</a>]</span>.
        It is available on GitHub <span>[<a class="xref" href="#minervagithub">minervagithub</a>]</span>.
        The keys presented here are used in the unit and integration tests.
        The MASA code is called "highway", the registrar code is called
        "fountain", and the example client is called "reach".<a class="pilcrow" href="#section-appendix.c-2">¶</a></p>
<p id="section-appendix.c-3">
        The public key components of each are presented as base64
        certificates and are decoded by openssl's x509
        utility so that the extensions can be seen.  This was version
        1.1.1c of the library and utility of <span>[<a class="xref" href="#openssl">openssl</a>]</span>.<a class="pilcrow" href="#section-appendix.c-3">¶</a></p>
<section id="section-c.1">
        <h2 id="name-keys-involved">
<a class="section-number selfRef" href="#section-c.1">C.1. </a><a class="section-name selfRef" href="#name-keys-involved">Keys Involved</a>
        </h2>
<p id="section-c.1-1">
          The manufacturer has a CA that signs the
          pledge's IDevID.  In addition, the Manufacturer's signing authority
          (the MASA) signs the vouchers, and that certificate must
          distributed to the devices at manufacturing time so that vouchers
          can be validated.<a class="pilcrow" href="#section-c.1-1">¶</a></p>
<section id="section-c.1.1">
          <h3 id="name-manufacturer-certification-">
<a class="section-number selfRef" href="#section-c.1.1">C.1.1. </a><a class="section-name selfRef" href="#name-manufacturer-certification-">Manufacturer Certification Authority for IDevID Signatures</a>
          </h3>
<p id="section-c.1.1-1">
            This private key is the CA that signs IDevID certificates:<a class="pilcrow" href="#section-c.1.1-1">¶</a></p>
<div id="section-c.1.1-2">
<pre class="sourcecode">&lt;CODE BEGINS&gt; file "vendor.key"

-----BEGIN EC PRIVATE KEY-----
MIGkAgEBBDCAYkoLW1IEA5SKKhMMdkTK7sJxk5ybKqYq9Yr5aR7tNwqXyLGS7z8G
8S4w/UJ58BqgBwYFK4EEACKhZANiAAQu5/yktJbFLjMC87h7b+yTreFuF8GwewKH
L4mS0r0dVAQubqDUQcTrjvpXrXCpTojiLCzgp8fzkcUDkZ9LD/M90LDipiLNIOkP
juF8QkoAbT8pMrY83MS8y76wZ7AalNQ=
-----END EC PRIVATE KEY-----

&lt;CODE ENDS&gt;</pre><a class="pilcrow" href="#section-c.1.1-2">¶</a>
</div>
<p class="keepWithNext" id="section-c.1.1-3">
            This public key validates IDevID certificates:<a class="pilcrow" href="#section-c.1.1-3">¶</a></p>
<p id="section-c.1.1-4">file: examples/vendor.key<a class="pilcrow" href="#section-c.1.1-4">¶</a></p>
<div id="section-c.1.1-5">
<pre class="sourcecode lang-example-crypto-material">&lt;CODE BEGINS&gt; file "vendor.cert"

Certificate:
    Data:
        Version: 3 (0x2)
        Serial Number: 1216069925 (0x487bc125)
        Signature Algorithm: ecdsa-with-SHA256
        Issuer: CN = highway-test.example.com CA
        Validity
            Not Before: Apr 13 20:34:24 2021 GMT
            Not After : Apr 13 20:34:24 2023 GMT
        Subject: CN = highway-test.example.com CA
        Subject Public Key Info:
            Public Key Algorithm: id-ecPublicKey
                Public-Key: (384 bit)
                pub:
                    04:2e:e7:fc:a4:b4:96:c5:2e:33:02:f3:b8:7b:6f:
                    ec:93:ad:e1:6e:17:c1:b0:7b:02:87:2f:89:92:d2:
                    bd:1d:54:04:2e:6e:a0:d4:41:c4:eb:8e:fa:57:ad:
                    70:a9:4e:88:e2:2c:2c:e0:a7:c7:f3:91:c5:03:91:
                    9f:4b:0f:f3:3d:d0:b0:e2:a6:22:cd:20:e9:0f:8e:
                    e1:7c:42:4a:00:6d:3f:29:32:b6:3c:dc:c4:bc:cb:
                    be:b0:67:b0:1a:94:d4
                ASN1 OID: secp384r1
                NIST CURVE: P-384
        X509v3 extensions:
            X509v3 Basic Constraints: critical
                CA:TRUE
            X509v3 Key Usage: critical
                Certificate Sign, CRL Sign
            X509v3 Subject Key Identifier:
                5E:0C:A9:52:5A:8C:DF:A9:0F:03:14:E9:96:F1:80:76:
                8C:53:8A:08
            X509v3 Authority Key Identifier:
                keyid:5E:0C:A9:52:5A:8C:DF:A9:0F:03:14:E9:96:F1:
                80:76:8C:53:8A:08

    Signature Algorithm: ecdsa-with-SHA256
         30:64:02:30:60:37:a0:66:89:80:27:e1:0d:e5:43:9a:62:f1:
         02:bc:0f:72:6d:a9:e9:cb:84:a5:c6:44:d3:41:9e:5d:ce:7d:
         46:16:6e:15:de:f7:cc:e8:3e:61:f9:03:7c:20:c4:b7:02:30:
         7f:e9:f3:12:bb:06:c6:24:00:2b:41:aa:21:6b:d8:25:ed:81:
         07:11:ef:66:8f:06:bf:c8:be:f0:58:74:24:45:39:4d:04:fc:
         31:69:6f:cf:db:fe:61:7b:c3:24:31:ff
-----BEGIN CERTIFICATE-----
MIIB3TCCAWSgAwIBAgIESHvBJTAKBggqhkjOPQQDAjAmMSQwIgYDVQQDDBtoaWdo
d2F5LXRlc3QuZXhhbXBsZS5jb20gQ0EwHhcNMjEwNDEzMjAzNDI0WhcNMjMwNDEz
MjAzNDI0WjAmMSQwIgYDVQQDDBtoaWdod2F5LXRlc3QuZXhhbXBsZS5jb20gQ0Ew
djAQBgcqhkjOPQIBBgUrgQQAIgNiAAQu5/yktJbFLjMC87h7b+yTreFuF8GwewKH
L4mS0r0dVAQubqDUQcTrjvpXrXCpTojiLCzgp8fzkcUDkZ9LD/M90LDipiLNIOkP
juF8QkoAbT8pMrY83MS8y76wZ7AalNSjYzBhMA8GA1UdEwEB/wQFMAMBAf8wDgYD
VR0PAQH/BAQDAgEGMB0GA1UdDgQWBBReDKlSWozfqQ8DFOmW8YB2jFOKCDAfBgNV
HSMEGDAWgBReDKlSWozfqQ8DFOmW8YB2jFOKCDAKBggqhkjOPQQDAgNnADBkAjBg
N6BmiYAn4Q3lQ5pi8QK8D3JtqenLhKXGRNNBnl3OfUYWbhXe98zoPmH5A3wgxLcC
MH/p8xK7BsYkACtBqiFr2CXtgQcR72aPBr/IvvBYdCRFOU0E/DFpb8/b/mF7wyQx
/w==
-----END CERTIFICATE-----


&lt;CODE ENDS&gt;</pre><a class="pilcrow" href="#section-c.1.1-5">¶</a>
</div>
</section>
<section id="section-c.1.2">
          <h3 id="name-masa-key-pair-for-voucher-s">
<a class="section-number selfRef" href="#section-c.1.2">C.1.2. </a><a class="section-name selfRef" href="#name-masa-key-pair-for-voucher-s">MASA Key Pair for Voucher Signatures</a>
          </h3>
<p id="section-c.1.2-1">
            The MASA is the Manufacturer Authorized Signing Authority.  This
            key pair signs vouchers.  An example TLS certificate (see <a class="xref" href="#brskimasatls">Section 5.4</a>)
            HTTP authentication is not provided as it is a
            common form.<a class="pilcrow" href="#section-c.1.2-1">¶</a></p>
<p id="section-c.1.2-2">
            This private key signs the vouchers that are presented below:<a class="pilcrow" href="#section-c.1.2-2">¶</a></p>
<div id="section-c.1.2-3">
<pre class="sourcecode lang-example-crypto-material">&lt;CODE BEGINS&gt; file "masa.key"

-----BEGIN EC PRIVATE KEY-----
MHcCAQEEIFhdd0eDdzip67kXx72K+KHGJQYJHNy8pkiLJ6CcvxMGoAoGCCqGSM49
AwEHoUQDQgAEqgQVo0S54kT4yfkbBxumdHOcHrpsqbOpMKmiMln3oB1HAW25MJV+
gqi4tMFfSJ0iEwt8kszfWXK4rLgJS2mnpQ==
-----END EC PRIVATE KEY-----

&lt;CODE ENDS&gt;</pre><a class="pilcrow" href="#section-c.1.2-3">¶</a>
</div>
<p class="keepWithNext" id="section-c.1.2-4">
            This public key validates vouchers, and it has been signed by the
            CA above:<a class="pilcrow" href="#section-c.1.2-4">¶</a></p>
<p id="section-c.1.2-5">file: examples/masa.key<a class="pilcrow" href="#section-c.1.2-5">¶</a></p>
<div id="section-c.1.2-6">
<pre class="sourcecode lang-example-crypto-material">&lt;CODE BEGINS&gt; file "masa.cert"

Certificate:
    Data:
        Version: 3 (0x2)
        Serial Number: 193399345 (0xb870a31)
        Signature Algorithm: ecdsa-with-SHA256
        Issuer: CN = highway-test.example.com CA
        Validity
            Not Before: Apr 13 21:40:16 2021 GMT
            Not After : Apr 13 21:40:16 2023 GMT
        Subject: CN = highway-test.example.com MASA
        Subject Public Key Info:
            Public Key Algorithm: id-ecPublicKey
                Public-Key: (256 bit)
                pub:
                    04:aa:04:15:a3:44:b9:e2:44:f8:c9:f9:1b:07:1b:
                    a6:74:73:9c:1e:ba:6c:a9:b3:a9:30:a9:a2:32:59:
                    f7:a0:1d:47:01:6d:b9:30:95:7e:82:a8:b8:b4:c1:
                    5f:48:9d:22:13:0b:7c:92:cc:df:59:72:b8:ac:b8:
                    09:4b:69:a7:a5
                ASN1 OID: prime256v1
                NIST CURVE: P-256
        X509v3 extensions:
            X509v3 Basic Constraints: critical
                CA:FALSE
    Signature Algorithm: ecdsa-with-SHA256
         30:66:02:31:00:ae:cb:61:2d:d4:5c:8d:6e:86:aa:0b:06:1d:
         c6:d3:60:ba:32:73:36:25:d3:23:85:49:87:1c:ce:94:23:79:
         1a:9e:41:55:24:1d:15:22:a1:48:bb:0a:c0:ab:3c:13:73:02:
         31:00:86:3c:67:b3:95:a2:e2:e5:f9:ad:f9:1d:9c:c1:34:32:
         78:f5:cf:ea:d5:47:03:9f:00:bf:d0:59:cb:51:c2:98:04:81:
         24:8a:51:13:50:b1:75:b2:2f:9d:a8:b4:f4:b9
-----BEGIN CERTIFICATE-----
MIIBcDCB9qADAgECAgQLhwoxMAoGCCqGSM49BAMCMCYxJDAiBgNVBAMMG2hpZ2h3
YXktdGVzdC5leGFtcGxlLmNvbSBDQTAeFw0yMTA0MTMyMTQwMTZaFw0yMzA0MTMy
MTQwMTZaMCgxJjAkBgNVBAMMHWhpZ2h3YXktdGVzdC5leGFtcGxlLmNvbSBNQVNB
MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEqgQVo0S54kT4yfkbBxumdHOcHrps
qbOpMKmiMln3oB1HAW25MJV+gqi4tMFfSJ0iEwt8kszfWXK4rLgJS2mnpaMQMA4w
DAYDVR0TAQH/BAIwADAKBggqhkjOPQQDAgNpADBmAjEArsthLdRcjW6GqgsGHcbT
YLoyczYl0yOFSYcczpQjeRqeQVUkHRUioUi7CsCrPBNzAjEAhjxns5Wi4uX5rfkd
nME0Mnj1z+rVRwOfAL/QWctRwpgEgSSKURNQsXWyL52otPS5
-----END CERTIFICATE-----

&lt;CODE ENDS&gt;</pre><a class="pilcrow" href="#section-c.1.2-6">¶</a>
</div>
</section>
<section id="section-c.1.3">
          <h3 id="name-registrar-certification-aut">
<a class="section-number selfRef" href="#section-c.1.3">C.1.3. </a><a class="section-name selfRef" href="#name-registrar-certification-aut">Registrar Certification Authority</a>
          </h3>
<p id="section-c.1.3-1">
            This CA enrolls the pledge once it is
            authorized, and it also signs the registrar's certificate.<a class="pilcrow" href="#section-c.1.3-1">¶</a></p>
<div id="section-c.1.3-2">
<pre class="sourcecode lang-example-crypto-material">&lt;CODE BEGINS&gt; file "ownerca_secp384r1.key"

-----BEGIN EC PRIVATE KEY-----
MIGkAgEBBDCHnLI0MSOLf8XndiZqoZdqblcPR5YSoPGhPOuFxWy1gFi9HbWv8b/R
EGdRgGEVSjKgBwYFK4EEACKhZANiAAQbf1m6F8MavGaNjGzgw/oxcQ9l9iKRvbdW
gAfb37h6pUVNeYpGlxlZljGxj2l9Mr48yD5bY7VG9qjVb5v5wPPTuRQ/ckdRpHbd
0vC/9cqPMAF/+MJf0/UgA0SLi/IHbLQ=
-----END EC PRIVATE KEY-----

&lt;CODE ENDS&gt;</pre><a class="pilcrow" href="#section-c.1.3-2">¶</a>
</div>
<p class="keepWithNext" id="section-c.1.3-3">
            The public key is indicated in a pledge voucher-request to show proximity.<a class="pilcrow" href="#section-c.1.3-3">¶</a></p>
<p id="section-c.1.3-4">file: examples/ownerca_secp384r1.key<a class="pilcrow" href="#section-c.1.3-4">¶</a></p>
<div id="section-c.1.3-5">
<pre class="sourcecode lang-example-crypto-material">&lt;CODE BEGINS&gt; file "ownerca_secp384r1.cert"

Certificate:
    Data:
        Version: 3 (0x2)
        Serial Number: 694879833 (0x296b0659)
        Signature Algorithm: ecdsa-with-SHA256
        Issuer: DC = ca, DC = sandelman,
         CN = fountain-test.example.com Unstrung Fountain Root CA
        Validity
            Not Before: Feb 25 21:31:45 2020 GMT
            Not After : Feb 24 21:31:45 2022 GMT
        Subject: DC = ca, DC = sandelman,
         CN = fountain-test.example.com Unstrung Fountain Root CA
        Subject Public Key Info:
            Public Key Algorithm: id-ecPublicKey
                Public-Key: (384 bit)
                pub:
                    04:1b:7f:59:ba:17:c3:1a:bc:66:8d:8c:6c:e0:c3:
                    fa:31:71:0f:65:f6:22:91:bd:b7:56:80:07:db:df:
                    b8:7a:a5:45:4d:79:8a:46:97:19:59:96:31:b1:8f:
                    69:7d:32:be:3c:c8:3e:5b:63:b5:46:f6:a8:d5:6f:
                    9b:f9:c0:f3:d3:b9:14:3f:72:47:51:a4:76:dd:d2:
                    f0:bf:f5:ca:8f:30:01:7f:f8:c2:5f:d3:f5:20:03:
                    44:8b:8b:f2:07:6c:b4
                ASN1 OID: secp384r1
                NIST CURVE: P-384
        X509v3 extensions:
            X509v3 Basic Constraints: critical
                CA:TRUE
            X509v3 Key Usage: critical
                Certificate Sign, CRL Sign
            X509v3 Subject Key Identifier:
                B9:A5:F6:CB:11:E1:07:A4:49:2C:A7:08:C6:7C:10:BC:
                87:B3:74:26
            X509v3 Authority Key Identifier:
                keyid:B9:A5:F6:CB:11:E1:07:A4:49:2C:A7:08:C6:7C:
                10:BC:87:B3:74:26

    Signature Algorithm: ecdsa-with-SHA256
         30:64:02:30:20:83:06:ce:8d:98:a4:54:7a:66:4c:4a:3a:70:
         c2:52:36:5a:52:8d:59:7d:20:9b:2a:69:14:58:87:38:d8:55:
         79:dd:fd:29:38:95:1e:91:93:76:b4:f5:66:29:44:b4:02:30:
         6f:38:f9:af:12:ed:30:d5:85:29:7c:b1:16:58:bd:67:91:43:
         c4:0d:30:f9:d8:1c:ac:2f:06:dd:bc:d5:06:42:2c:84:a2:04:
         ea:02:a4:5f:17:51:26:fb:d9:2f:d2:5c
-----BEGIN CERTIFICATE-----
MIICazCCAfKgAwIBAgIEKWsGWTAKBggqhkjOPQQDAjBtMRIwEAYKCZImiZPyLGQB
GRYCY2ExGTAXBgoJkiaJk/IsZAEZFglzYW5kZWxtYW4xPDA6BgNVBAMMM2ZvdW50
YWluLXRlc3QuZXhhbXBsZS5jb20gVW5zdHJ1bmcgRm91bnRhaW4gUm9vdCBDQTAe
Fw0yMDAyMjUyMTMxNDVaFw0yMjAyMjQyMTMxNDVaMG0xEjAQBgoJkiaJk/IsZAEZ
FgJjYTEZMBcGCgmSJomT8ixkARkWCXNhbmRlbG1hbjE8MDoGA1UEAwwzZm91bnRh
aW4tdGVzdC5leGFtcGxlLmNvbSBVbnN0cnVuZyBGb3VudGFpbiBSb290IENBMHYw
EAYHKoZIzj0CAQYFK4EEACIDYgAEG39ZuhfDGrxmjYxs4MP6MXEPZfYikb23VoAH
29+4eqVFTXmKRpcZWZYxsY9pfTK+PMg+W2O1Rvao1W+b+cDz07kUP3JHUaR23dLw
v/XKjzABf/jCX9P1IANEi4vyB2y0o2MwYTAPBgNVHRMBAf8EBTADAQH/MA4GA1Ud
DwEB/wQEAwIBBjAdBgNVHQ4EFgQUuaX2yxHhB6RJLKcIxnwQvIezdCYwHwYDVR0j
BBgwFoAUuaX2yxHhB6RJLKcIxnwQvIezdCYwCgYIKoZIzj0EAwIDZwAwZAIwIIMG
zo2YpFR6ZkxKOnDCUjZaUo1ZfSCbKmkUWIc42FV53f0pOJUekZN2tPVmKUS0AjBv
OPmvEu0w1YUpfLEWWL1nkUPEDTD52BysLwbdvNUGQiyEogTqAqRfF1Em+9kv0lw=
-----END CERTIFICATE-----

&lt;CODE ENDS&gt;</pre><a class="pilcrow" href="#section-c.1.3-5">¶</a>
</div>
</section>
<section id="section-c.1.4">
          <h3 id="name-registrar-key-pair">
<a class="section-number selfRef" href="#section-c.1.4">C.1.4. </a><a class="section-name selfRef" href="#name-registrar-key-pair">Registrar Key Pair</a>
          </h3>
<p id="section-c.1.4-1">
            The registrar is the representative of the domain owner.
            This key signs registrar voucher-requests and terminates
            the TLS connection from the pledge.<a class="pilcrow" href="#section-c.1.4-1">¶</a></p>
<div id="section-c.1.4-2">
<pre class="sourcecode lang-example-crypto-material">&lt;CODE BEGINS&gt; file "jrc_prime256v1.key"

-----BEGIN EC PRIVATE KEY-----
MHcCAQEEIFZodk+PC5Mu24+ra0sbOjKzan+dW5rvDAR7YuJUOC1YoAoGCCqGSM49
AwEHoUQDQgAElmVQcjS6n+Xd5l/28IFv6UiegQwSBztGj5dkK2MAjQIPV8l8lH+E
jLIOYdbJiI0VtEIf1/Jqt+TOBfinTNOLOg==
-----END EC PRIVATE KEY-----

&lt;CODE ENDS&gt;</pre><a class="pilcrow" href="#section-c.1.4-2">¶</a>
</div>
<p id="section-c.1.4-3">
            The public key is indicated in a pledge voucher-request to show proximity.<a class="pilcrow" href="#section-c.1.4-3">¶</a></p>
<div id="section-c.1.4-4">
<pre class="sourcecode lang-example-crypto-material">&lt;CODE BEGINS&gt; file "jrc_prime256v1.cert"

Certificate:
    Data:
        Version: 3 (0x2)
        Serial Number: 1066965842 (0x3f989b52)
        Signature Algorithm: ecdsa-with-SHA256
        Issuer: DC = ca, DC = sandelman,
         CN = fountain-test.example.com Unstrung Fountain Root CA
        Validity
            Not Before: Feb 25 21:31:54 2020 GMT
            Not After : Feb 24 21:31:54 2022 GMT
        Subject: DC = ca, DC = sandelman,
         CN = fountain-test.example.com
        Subject Public Key Info:
            Public Key Algorithm: id-ecPublicKey
                Public-Key: (256 bit)
                pub:
                    04:96:65:50:72:34:ba:9f:e5:dd:e6:5f:f6:f0:81:
                    6f:e9:48:9e:81:0c:12:07:3b:46:8f:97:64:2b:63:
                    00:8d:02:0f:57:c9:7c:94:7f:84:8c:b2:0e:61:d6:
                    c9:88:8d:15:b4:42:1f:d7:f2:6a:b7:e4:ce:05:f8:
                    a7:4c:d3:8b:3a
                ASN1 OID: prime256v1
                NIST CURVE: P-256
        X509v3 extensions:
            X509v3 Extended Key Usage: critical
                CMC Registration Authority
            X509v3 Key Usage: critical
                Digital Signature
    Signature Algorithm: ecdsa-with-SHA256
         30:65:02:30:66:4f:60:4c:55:48:1e:96:07:f8:dd:1f:b9:c8:
         12:8d:45:36:87:9b:23:c0:bc:bb:f1:cb:3d:26:15:56:6f:5f:
         1f:bf:d5:1c:0e:6a:09:af:1b:76:97:99:19:23:fd:7e:02:31:
         00:bc:ac:c3:41:b0:ba:0d:af:52:f9:9c:6e:7a:7f:00:1d:23:
         c8:62:01:61:bc:4b:c5:c0:47:99:35:0a:0c:77:61:44:01:4a:
         07:52:70:57:00:75:ff:be:07:0e:98:cb:e5
-----BEGIN CERTIFICATE-----
MIIB/DCCAYKgAwIBAgIEP5ibUjAKBggqhkjOPQQDAjBtMRIwEAYKCZImiZPyLGQB
GRYCY2ExGTAXBgoJkiaJk/IsZAEZFglzYW5kZWxtYW4xPDA6BgNVBAMMM2ZvdW50
YWluLXRlc3QuZXhhbXBsZS5jb20gVW5zdHJ1bmcgRm91bnRhaW4gUm9vdCBDQTAe
Fw0yMDAyMjUyMTMxNTRaFw0yMjAyMjQyMTMxNTRaMFMxEjAQBgoJkiaJk/IsZAEZ
FgJjYTEZMBcGCgmSJomT8ixkARkWCXNhbmRlbG1hbjEiMCAGA1UEAwwZZm91bnRh
aW4tdGVzdC5leGFtcGxlLmNvbTBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABJZl
UHI0up/l3eZf9vCBb+lInoEMEgc7Ro+XZCtjAI0CD1fJfJR/hIyyDmHWyYiNFbRC
H9fyarfkzgX4p0zTizqjKjAoMBYGA1UdJQEB/wQMMAoGCCsGAQUFBwMcMA4GA1Ud
DwEB/wQEAwIHgDAKBggqhkjOPQQDAgNoADBlAjBmT2BMVUgelgf43R+5yBKNRTaH
myPAvLvxyz0mFVZvXx+/1RwOagmvG3aXmRkj/X4CMQC8rMNBsLoNr1L5nG56fwAd
I8hiAWG8S8XAR5k1Cgx3YUQBSgdScFcAdf++Bw6Yy+U=
-----END CERTIFICATE-----

&lt;CODE ENDS&gt;</pre><a class="pilcrow" href="#section-c.1.4-4">¶</a>
</div>
</section>
<section id="section-c.1.5">
          <h3 id="name-pledge-key-pair">
<a class="section-number selfRef" href="#section-c.1.5">C.1.5. </a><a class="section-name selfRef" href="#name-pledge-key-pair">Pledge Key Pair</a>
          </h3>
<p id="section-c.1.5-1">
            The pledge has an IDevID key pair built in at manufacturing time:<a class="pilcrow" href="#section-c.1.5-1">¶</a></p>
<div id="section-c.1.5-2">
<pre class="sourcecode lang-example-crypto-material">&lt;CODE BEGINS&gt; file "idevid_00-D0-E5-F2-00-02.key"

-----BEGIN EC PRIVATE KEY-----
MHcCAQEEIBHNh6r8QRevRuo+tEmBJeFjQKf6bpFA/9NGoltv+9sNoAoGCCqGSM49
AwEHoUQDQgAEA6N1Q4ezfMAKmoecrfb0OBMc1AyEH+BATkF58FsTSyBxs0SbSWLx
FjDOuwB9gLGn2TsTUJumJ6VPw5Z/TP4hJw==
-----END EC PRIVATE KEY-----

&lt;CODE ENDS&gt;</pre><a class="pilcrow" href="#section-c.1.5-2">¶</a>
</div>
<p id="section-c.1.5-3">
            The certificate is used by the registrar to find the MASA.<a class="pilcrow" href="#section-c.1.5-3">¶</a></p>
<div id="section-c.1.5-4">
<pre class="sourcecode lang-example-crypto-material">&lt;CODE BEGINS&gt; file "idevid_00-D0-E5-F2-00-02.cert"

Certificate:
    Data:
        Version: 3 (0x2)
        Serial Number: 521731815 (0x1f18fee7)
        Signature Algorithm: ecdsa-with-SHA256
        Issuer: CN = highway-test.example.com CA
        Validity
            Not Before: Apr 27 18:29:30 2021 GMT
            Not After : Dec 31 00:00:00 2999 GMT
        Subject: serialNumber = 00-D0-E5-F2-00-02
        Subject Public Key Info:
            Public Key Algorithm: id-ecPublicKey
                Public-Key: (256 bit)
                pub:
                    04:03:a3:75:43:87:b3:7c:c0:0a:9a:87:9c:ad:f6:
                    f4:38:13:1c:d4:0c:84:1f:e0:40:4e:41:79:f0:5b:
                    13:4b:20:71:b3:44:9b:49:62:f1:16:30:ce:bb:00:
                    7d:80:b1:a7:d9:3b:13:50:9b:a6:27:a5:4f:c3:96:
                    7f:4c:fe:21:27
                ASN1 OID: prime256v1
                NIST CURVE: P-256
        X509v3 extensions:
            X509v3 Subject Key Identifier:
                45:88:CC:96:96:00:64:37:B0:BA:23:65:64:64:54:08:
                06:6C:56:AD
            X509v3 Basic Constraints:
                CA:FALSE
            1.3.6.1.5.5.7.1.32:
                ..highway-test.example.com:9443
    Signature Algorithm: ecdsa-with-SHA256
         30:65:02:30:62:2a:db:be:34:f7:1b:cb:85:de:26:8e:43:00:
         f9:0d:88:c8:77:a8:dd:3c:08:40:54:bc:ec:3d:b6:dc:70:2b:
         c3:7f:ca:19:21:9a:a0:ab:c5:51:8e:aa:df:36:de:8b:02:31:
         00:b2:5d:59:f8:47:c7:ed:03:97:a8:c0:c7:a8:81:fa:a8:86:
         ed:67:64:37:51:7a:6e:9c:a3:82:4d:6d:ad:bc:f3:35:9e:9d:
         6a:a2:6d:7f:7f:25:1c:03:ef:f0:ba:9b:71
-----BEGIN CERTIFICATE-----
MIIBrzCCATWgAwIBAgIEHxj+5zAKBggqhkjOPQQDAjAmMSQwIgYDVQQDDBtoaWdo
d2F5LXRlc3QuZXhhbXBsZS5jb20gQ0EwIBcNMjEwNDI3MTgyOTMwWhgPMjk5OTEy
MzEwMDAwMDBaMBwxGjAYBgNVBAUTETAwLUQwLUU1LUYyLTAwLTAyMFkwEwYHKoZI
zj0CAQYIKoZIzj0DAQcDQgAEA6N1Q4ezfMAKmoecrfb0OBMc1AyEH+BATkF58FsT
SyBxs0SbSWLxFjDOuwB9gLGn2TsTUJumJ6VPw5Z/TP4hJ6NZMFcwHQYDVR0OBBYE
FEWIzJaWAGQ3sLojZWRkVAgGbFatMAkGA1UdEwQCMAAwKwYIKwYBBQUHASAEHxYd
aGlnaHdheS10ZXN0LmV4YW1wbGUuY29tOjk0NDMwCgYIKoZIzj0EAwIDaAAwZQIw
YirbvjT3G8uF3iaOQwD5DYjId6jdPAhAVLzsPbbccCvDf8oZIZqgq8VRjqrfNt6L
AjEAsl1Z+EfH7QOXqMDHqIH6qIbtZ2Q3UXpunKOCTW2tvPM1np1qom1/fyUcA+/w
uptx
-----END CERTIFICATE-----



&lt;CODE ENDS&gt;</pre><a class="pilcrow" href="#section-c.1.5-4">¶</a>
</div>
</section>
</section>
<div id="exampleprocess">
<section id="section-c.2">
        <h2 id="name-example-process">
<a class="section-number selfRef" href="#section-c.2">C.2. </a><a class="section-name selfRef" href="#name-example-process">Example Process</a>
        </h2>
<p id="section-c.2-1">
          The JSON examples below are wrapped at 60 columns.
          This results in strings that have newlines in them, which
          makes them invalid JSON as is.  The strings would otherwise
          be too long, so they need to be unwrapped before processing.<a class="pilcrow" href="#section-c.2-1">¶</a></p>
<p id="section-c.2-2">

          For readability, the output of the asn1parse has been truncated at
          68 columns rather than wrapped.<a class="pilcrow" href="#section-c.2-2">¶</a></p>
<section id="section-c.2.1">
          <h3 id="name-pledge-to-registrar">
<a class="section-number selfRef" href="#section-c.2.1">C.2.1. </a><a class="section-name selfRef" href="#name-pledge-to-registrar">Pledge to Registrar</a>
          </h3>
<p id="section-c.2.1-1">
            As described in <a class="xref" href="#RequestVoucherFromRegistrar">Section 5.2</a>,
            the pledge will sign a pledge voucher-request containing the
            registrar's public key in the proximity-registrar-cert field.
            The base64 has been wrapped at 60 characters for presentation reasons.<a class="pilcrow" href="#section-c.2.1-1">¶</a></p>
<div id="section-c.2.1-2">
<pre class="sourcecode">&lt;CODE BEGINS&gt; file "vr_00-D0-E5-F2-00-02.b64"

MIIGcAYJKoZIhvcNAQcCoIIGYTCCBl0CAQExDTALBglghkgBZQMEAgEwggOJBgkqhkiG
9w0BBwGgggN6BIIDdnsiaWV0Zi12b3VjaGVyLXJlcXVlc3Q6dm91Y2hlciI6eyJhc3Nl
cnRpb24iOiJwcm94aW1pdHkiLCJjcmVhdGVkLW9uIjoiMjAyMS0wNC0xM1QxNzo0Mzoy
My43NDctMDQ6MDAiLCJzZXJpYWwtbnVtYmVyIjoiMDAtRDAtRTUtRjItMDAtMDIiLCJu
b25jZSI6Ii1fWEU5eks5cThMbDFxeWxNdExLZWciLCJwcm94aW1pdHktcmVnaXN0cmFy
LWNlcnQiOiJNSUlCL0RDQ0FZS2dBd0lCQWdJRVA1aWJVakFLQmdncWhrak9QUVFEQWpC
dE1SSXdFQVlLQ1pJbWlaUHlMR1FCR1JZQ1kyRXhHVEFYQmdvSmtpYUprL0lzWkFFWkZn
bHpZVzVrWld4dFlXNHhQREE2QmdOVkJBTU1NMlp2ZFc1MFlXbHVMWFJsYzNRdVpYaGhi
WEJzWlM1amIyMGdWVzV6ZEhKMWJtY2dSbTkxYm5SaGFXNGdVbTl2ZENCRFFUQWVGdzB5
TURBeU1qVXlNVE14TlRSYUZ3MHlNakF5TWpReU1UTXhOVFJhTUZNeEVqQVFCZ29Ka2lh
SmsvSXNaQUVaRmdKallURVpNQmNHQ2dtU0pvbVQ4aXhrQVJrV0NYTmhibVJsYkcxaGJq
RWlNQ0FHQTFVRUF3d1pabTkxYm5SaGFXNHRkR1Z6ZEM1bGVHRnRjR3hsTG1OdmJUQlpN
Qk1HQnlxR1NNNDlBZ0VHQ0NxR1NNNDlBd0VIQTBJQUJKWmxVSEkwdXAvbDNlWmY5dkNC
YitsSW5vRU1FZ2M3Um8rWFpDdGpBSTBDRDFmSmZKUi9oSXl5RG1IV3lZaU5GYlJDSDlm
eWFyZmt6Z1g0cDB6VGl6cWpLakFvTUJZR0ExVWRKUUVCL3dRTU1Bb0dDQ3NHQVFVRkJ3
TWNNQTRHQTFVZER3RUIvd1FFQXdJSGdEQUtCZ2dxaGtqT1BRUURBZ05vQURCbEFqQm1U
MkJNVlVnZWxnZjQzUis1eUJLTlJUYUhteVBBdkx2eHl6MG1GVlp2WHgrLzFSd09hZ212
RzNhWG1Sa2ovWDRDTVFDOHJNTkJzTG9OcjFMNW5HNTZmd0FkSThoaUFXRzhTOFhBUjVr
MUNneDNZVVFCU2dkU2NGY0FkZisrQnc2WXkrVT0ifX2gggGyMIIBrjCCATWgAwIBAgIE
DYOv2TAKBggqhkjOPQQDAjAmMSQwIgYDVQQDDBtoaWdod2F5LXRlc3QuZXhhbXBsZS5j
b20gQ0EwIBcNMjEwNDEzMjAzNzM5WhgPMjk5OTEyMzEwMDAwMDBaMBwxGjAYBgNVBAUM
ETAwLUQwLUU1LUYyLTAwLTAyMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEA6N1Q4ez
fMAKmoecrfb0OBMc1AyEH+BATkF58FsTSyBxs0SbSWLxFjDOuwB9gLGn2TsTUJumJ6VP
w5Z/TP4hJ6NZMFcwHQYDVR0OBBYEFEWIzJaWAGQ3sLojZWRkVAgGbFatMAkGA1UdEwQC
MAAwKwYIKwYBBQUHASAEHxYdaGlnaHdheS10ZXN0LmV4YW1wbGUuY29tOjk0NDMwCgYI
KoZIzj0EAwIDZwAwZAIwTmlG8sXkKGNbwbKQcYMapFbmSbnHHURFUoFuRqvbgYX7FlXp
BczfwF2kllNuujigAjAow1kc4r55EmiH+OMEXjBNlWlBSZC5QuJjEf0Jsmxssc+pucjO
J4ShqnexMEy7bjAxggEEMIIBAAIBATAuMCYxJDAiBgNVBAMMG2hpZ2h3YXktdGVzdC5l
eGFtcGxlLmNvbSBDQQIEDYOv2TALBglghkgBZQMEAgGgaTAYBgkqhkiG9w0BCQMxCwYJ
KoZIhvcNAQcBMBwGCSqGSIb3DQEJBTEPFw0yMTA0MTMyMTQzMjNaMC8GCSqGSIb3DQEJ
BDEiBCBJwhyYibIjeqeR3bOaLURzMlGrc3F2X+kvJ1errtoCtTAKBggqhkjOPQQDAgRH
MEUCIQCmYuCE61HFQXH/E16GDOCsVquDtgr+Q/6/Du/9QkzA7gIgf7MFhAIPW2PNwRa2
vZFQAKXUbimkiHKzXBA8md0VHbU=

&lt;CODE ENDS&gt;</pre><a class="pilcrow" href="#section-c.2.1-2">¶</a>
</div>
<p class="keepWithNext" id="section-c.2.1-3">
            The ASN1 decoding of the artifact:<a class="pilcrow" href="#section-c.2.1-3">¶</a></p>
<p id="section-c.2.1-4">file: examples/vr_00-D0-E5-F2-00-02.b64<a class="pilcrow" href="#section-c.2.1-4">¶</a></p>
<div class="artwork art-text alignLeft" id="section-c.2.1-5">
<pre>    0:d=0  hl=4 l=1648 cons: SEQUENCE
    4:d=1  hl=2 l=   9 prim: OBJECT            :pkcs7-signedData
   15:d=1  hl=4 l=1633 cons: cont [ 0 ]
   19:d=2  hl=4 l=1629 cons: SEQUENCE
   23:d=3  hl=2 l=   1 prim: INTEGER           :01
   26:d=3  hl=2 l=  13 cons: SET
   28:d=4  hl=2 l=  11 cons: SEQUENCE
   30:d=5  hl=2 l=   9 prim: OBJECT            :sha256
   41:d=3  hl=4 l= 905 cons: SEQUENCE
   45:d=4  hl=2 l=   9 prim: OBJECT            :pkcs7-data
   56:d=4  hl=4 l= 890 cons: cont [ 0 ]
   60:d=5  hl=4 l= 886 prim: OCTET STRING      :{"ietf-voucher-request:v
  950:d=3  hl=4 l= 434 cons: cont [ 0 ]
  954:d=4  hl=4 l= 430 cons: SEQUENCE
  958:d=5  hl=4 l= 309 cons: SEQUENCE
  962:d=6  hl=2 l=   3 cons: cont [ 0 ]
  964:d=7  hl=2 l=   1 prim: INTEGER           :02
  967:d=6  hl=2 l=   4 prim: INTEGER           :0D83AFD9
  973:d=6  hl=2 l=  10 cons: SEQUENCE
  975:d=7  hl=2 l=   8 prim: OBJECT            :ecdsa-with-SHA256
  985:d=6  hl=2 l=  38 cons: SEQUENCE
  987:d=7  hl=2 l=  36 cons: SET
  989:d=8  hl=2 l=  34 cons: SEQUENCE
  991:d=9  hl=2 l=   3 prim: OBJECT            :commonName
  996:d=9  hl=2 l=  27 prim: UTF8STRING        :highway-test.example.com
 1025:d=6  hl=2 l=  32 cons: SEQUENCE
 1027:d=7  hl=2 l=  13 prim: UTCTIME           :210413203739Z
 1042:d=7  hl=2 l=  15 prim: GENERALIZEDTIME   :29991231000000Z
 1059:d=6  hl=2 l=  28 cons: SEQUENCE
 1061:d=7  hl=2 l=  26 cons: SET
 1063:d=8  hl=2 l=  24 cons: SEQUENCE
 1065:d=9  hl=2 l=   3 prim: OBJECT            :serialNumber
 1070:d=9  hl=2 l=  17 prim: UTF8STRING        :00-D0-E5-F2-00-02
 1089:d=6  hl=2 l=  89 cons: SEQUENCE
 1091:d=7  hl=2 l=  19 cons: SEQUENCE
 1093:d=8  hl=2 l=   7 prim: OBJECT            :id-ecPublicKey
 1102:d=8  hl=2 l=   8 prim: OBJECT            :prime256v1
 1112:d=7  hl=2 l=  66 prim: BIT STRING
 1180:d=6  hl=2 l=  89 cons: cont [ 3 ]
 1182:d=7  hl=2 l=  87 cons: SEQUENCE
 1184:d=8  hl=2 l=  29 cons: SEQUENCE
 1186:d=9  hl=2 l=   3 prim: OBJECT            :X509v3 Subject Key Ident
 1191:d=9  hl=2 l=  22 prim: OCTET STRING      [HEX DUMP]:04144588CC9696
 1215:d=8  hl=2 l=   9 cons: SEQUENCE
 1217:d=9  hl=2 l=   3 prim: OBJECT            :X509v3 Basic Constraints
 1222:d=9  hl=2 l=   2 prim: OCTET STRING      [HEX DUMP]:3000
 1226:d=8  hl=2 l=  43 cons: SEQUENCE
 1228:d=9  hl=2 l=   8 prim: OBJECT            :1.3.6.1.5.5.7.1.32
 1238:d=9  hl=2 l=  31 prim: OCTET STRING      [HEX DUMP]:161D6869676877
 1271:d=5  hl=2 l=  10 cons: SEQUENCE
 1273:d=6  hl=2 l=   8 prim: OBJECT            :ecdsa-with-SHA256
 1283:d=5  hl=2 l= 103 prim: BIT STRING
 1388:d=3  hl=4 l= 260 cons: SET
 1392:d=4  hl=4 l= 256 cons: SEQUENCE
 1396:d=5  hl=2 l=   1 prim: INTEGER           :01
 1399:d=5  hl=2 l=  46 cons: SEQUENCE
 1401:d=6  hl=2 l=  38 cons: SEQUENCE
 1403:d=7  hl=2 l=  36 cons: SET
 1405:d=8  hl=2 l=  34 cons: SEQUENCE
 1407:d=9  hl=2 l=   3 prim: OBJECT            :commonName
 1412:d=9  hl=2 l=  27 prim: UTF8STRING        :highway-test.example.com
 1441:d=6  hl=2 l=   4 prim: INTEGER           :0D83AFD9
 1447:d=5  hl=2 l=  11 cons: SEQUENCE
 1449:d=6  hl=2 l=   9 prim: OBJECT            :sha256
 1460:d=5  hl=2 l= 105 cons: cont [ 0 ]
 1462:d=6  hl=2 l=  24 cons: SEQUENCE
 1464:d=7  hl=2 l=   9 prim: OBJECT            :contentType
 1475:d=7  hl=2 l=  11 cons: SET
 1477:d=8  hl=2 l=   9 prim: OBJECT            :pkcs7-data
 1488:d=6  hl=2 l=  28 cons: SEQUENCE
 1490:d=7  hl=2 l=   9 prim: OBJECT            :signingTime
 1501:d=7  hl=2 l=  15 cons: SET
 1503:d=8  hl=2 l=  13 prim: UTCTIME           :210413214323Z
 1518:d=6  hl=2 l=  47 cons: SEQUENCE
 1520:d=7  hl=2 l=   9 prim: OBJECT            :messageDigest
 1531:d=7  hl=2 l=  34 cons: SET
 1533:d=8  hl=2 l=  32 prim: OCTET STRING      [HEX DUMP]:49C21C9889B223
 1567:d=5  hl=2 l=  10 cons: SEQUENCE
 1569:d=6  hl=2 l=   8 prim: OBJECT            :ecdsa-with-SHA256
 1579:d=5  hl=2 l=  71 prim: OCTET STRING      [HEX DUMP]:3045022100A662

</pre><a class="pilcrow" href="#section-c.2.1-5">¶</a>
</div>
<p id="section-c.2.1-6">
            The JSON contained in the voucher-request:<a class="pilcrow" href="#section-c.2.1-6">¶</a></p>
<div id="section-c.2.1-7">
<pre class="sourcecode lang-json">{"ietf-voucher-request:voucher":{"assertion":"proximity","cr
eated-on":"2021-04-13T17:43:23.747-04:00","serial-number":"0
0-D0-E5-F2-00-02","nonce":"-_XE9zK9q8Ll1qylMtLKeg","proximit
y-registrar-cert":"MIIB/DCCAYKgAwIBAgIEP5ibUjAKBggqhkjOPQQDA
jBtMRIwEAYKCZImiZPyLGQBGRYCY2ExGTAXBgoJkiaJk/IsZAEZFglzYW5kZ
WxtYW4xPDA6BgNVBAMMM2ZvdW50YWluLXRlc3QuZXhhbXBsZS5jb20gVW5zd
HJ1bmcgRm91bnRhaW4gUm9vdCBDQTAeFw0yMDAyMjUyMTMxNTRaFw0yMjAyM
jQyMTMxNTRaMFMxEjAQBgoJkiaJk/IsZAEZFgJjYTEZMBcGCgmSJomT8ixkA
RkWCXNhbmRlbG1hbjEiMCAGA1UEAwwZZm91bnRhaW4tdGVzdC5leGFtcGxlL
mNvbTBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABJZlUHI0up/l3eZf9vCBb
+lInoEMEgc7Ro+XZCtjAI0CD1fJfJR/hIyyDmHWyYiNFbRCH9fyarfkzgX4p
0zTizqjKjAoMBYGA1UdJQEB/wQMMAoGCCsGAQUFBwMcMA4GA1UdDwEB/wQEA
wIHgDAKBggqhkjOPQQDAgNoADBlAjBmT2BMVUgelgf43R+5yBKNRTaHmyPAv
Lvxyz0mFVZvXx+/1RwOagmvG3aXmRkj/X4CMQC8rMNBsLoNr1L5nG56fwAdI
8hiAWG8S8XAR5k1Cgx3YUQBSgdScFcAdf++Bw6Yy+U="}}
</pre><a class="pilcrow" href="#section-c.2.1-7">¶</a>
</div>
</section>
<section id="section-c.2.2">
          <h3 id="name-registrar-to-masa">
<a class="section-number selfRef" href="#section-c.2.2">C.2.2. </a><a class="section-name selfRef" href="#name-registrar-to-masa">Registrar to MASA</a>
          </h3>
<p id="section-c.2.2-1">
            As described in <a class="xref" href="#RequestVoucherFromMASA">Section 5.5</a>,
            the registrar will sign a registrar voucher-request and will
            include the pledge's voucher-request in the prior-signed-voucher-request.<a class="pilcrow" href="#section-c.2.2-1">¶</a></p>
<div id="section-c.2.2-2">
<pre class="sourcecode">&lt;CODE BEGINS&gt; file "parboiled_vr_00-D0-E5-F2-00-02.b64"

MIIPYwYJKoZIhvcNAQcCoIIPVDCCD1ACAQExDTALBglghkgBZQMEAgEwggl4BgkqhkiG
9w0BBwGggglpBIIJZXsiaWV0Zi12b3VjaGVyLXJlcXVlc3Q6dm91Y2hlciI6eyJhc3Nl
cnRpb24iOiJwcm94aW1pdHkiLCJjcmVhdGVkLW9uIjoiMjAyMS0wNC0xM1QyMTo0Mzoy
My43ODdaIiwic2VyaWFsLW51bWJlciI6IjAwLUQwLUU1LUYyLTAwLTAyIiwibm9uY2Ui
OiItX1hFOXpLOXE4TGwxcXlsTXRMS2VnIiwicHJpb3Itc2lnbmVkLXZvdWNoZXItcmVx
dWVzdCI6Ik1JSUdjQVlKS29aSWh2Y05BUWNDb0lJR1lUQ0NCbDBDQVFFeERUQUxCZ2xn
aGtnQlpRTUVBZ0V3Z2dPSkJna3Foa2lHOXcwQkJ3R2dnZ042QklJRGRuc2lhV1YwWmkx
MmIzVmphR1Z5TFhKbGNYVmxjM1E2ZG05MVkyaGxjaUk2ZXlKaGMzTmxjblJwYjI0aU9p
SndjbTk0YVcxcGRIa2lMQ0pqY21WaGRHVmtMVzl1SWpvaU1qQXlNUzB3TkMweE0xUXhO
em8wTXpveU15NDNORGN0TURRNk1EQWlMQ0p6WlhKcFlXd3RiblZ0WW1WeUlqb2lNREF0
UkRBdFJUVXRSakl0TURBdE1ESWlMQ0p1YjI1alpTSTZJaTFmV0VVNWVrczVjVGhNYkRG
eGVXeE5kRXhMWldjaUxDSndjbTk0YVcxcGRIa3RjbVZuYVhOMGNtRnlMV05sY25RaU9p
Sk5TVWxDTDBSRFEwRlpTMmRCZDBsQ1FXZEpSVkExYVdKVmFrRkxRbWRuY1docmFrOVFV
VkZFUVdwQ2RFMVNTWGRGUVZsTFExcEpiV2xhVUhsTVIxRkNSMUpaUTFreVJYaEhWRUZZ
UW1kdlNtdHBZVXByTDBseldrRkZXa1puYkhwWlZ6VnJXbGQ0ZEZsWE5IaFFSRUUyUW1k
T1ZrSkJUVTFOTWxwMlpGYzFNRmxYYkhWTVdGSnNZek5SZFZwWWFHaGlXRUp6V2xNMWFt
SXlNR2RXVnpWNlpFaEtNV0p0WTJkU2JUa3hZbTVTYUdGWE5HZFZiVGwyWkVOQ1JGRlVR
V1ZHZHpCNVRVUkJlVTFxVlhsTlZFMTRUbFJTWVVaM01IbE5ha0Y1VFdwUmVVMVVUWGhP
VkZKaFRVWk5lRVZxUVZGQ1oyOUthMmxoU21zdlNYTmFRVVZhUm1kS2FsbFVSVnBOUW1O
SFEyZHRVMHB2YlZRNGFYaHJRVkpyVjBOWVRtaGliVkpzWWtjeGFHSnFSV2xOUTBGSFFU
RlZSVUYzZDFwYWJUa3hZbTVTYUdGWE5IUmtSMVo2WkVNMWJHVkhSblJqUjNoc1RHMU9k
bUpVUWxwTlFrMUhRbmx4UjFOTk5EbEJaMFZIUTBOeFIxTk5ORGxCZDBWSVFUQkpRVUpL
V214VlNFa3dkWEF2YkRObFdtWTVka05DWWl0c1NXNXZSVTFGWjJNM1VtOHJXRnBEZEdw
QlNUQkRSREZtU21aS1VpOW9TWGw1UkcxSVYzbFphVTVHWWxKRFNEbG1lV0Z5Wm10Nlox
ZzBjREI2VkdsNmNXcExha0Z2VFVKWlIwRXhWV1JLVVVWQ0wzZFJUVTFCYjBkRFEzTkhR
VkZWUmtKM1RXTk5RVFJIUVRGVlpFUjNSVUl2ZDFGRlFYZEpTR2RFUVV0Q1oyZHhhR3Rx
VDFCUlVVUkJaMDV2UVVSQ2JFRnFRbTFVTWtKTlZsVm5aV3huWmpRelVpczFlVUpMVGxK
VVlVaHRlVkJCZGt4MmVIbDZNRzFHVmxwMldIZ3JMekZTZDA5aFoyMTJSek5oV0cxU2Ey
b3ZXRFJEVFZGRE9ISk5Ua0p6VEc5T2NqRk1OVzVITlRabWQwRmtTVGhvYVVGWFJ6aFRP
RmhCVWpWck1VTm5lRE5aVlZGQ1UyZGtVMk5HWTBGa1ppc3JRbmMyV1hrclZUMGlmWDJn
Z2dHeU1JSUJyakNDQVRXZ0F3SUJBZ0lFRFlPdjJUQUtCZ2dxaGtqT1BRUURBakFtTVNR
d0lnWURWUVFEREJ0b2FXZG9kMkY1TFhSbGMzUXVaWGhoYlhCc1pTNWpiMjBnUTBFd0lC
Y05NakV3TkRFek1qQXpOek01V2hnUE1qazVPVEV5TXpFd01EQXdNREJhTUJ3eEdqQVlC
Z05WQkFVTUVUQXdMVVF3TFVVMUxVWXlMVEF3TFRBeU1Ga3dFd1lIS29aSXpqMENBUVlJ
S29aSXpqMERBUWNEUWdBRUE2TjFRNGV6Zk1BS21vZWNyZmIwT0JNYzFBeUVIK0JBVGtG
NThGc1RTeUJ4czBTYlNXTHhGakRPdXdCOWdMR24yVHNUVUp1bUo2VlB3NVovVFA0aEo2
TlpNRmN3SFFZRFZSME9CQllFRkVXSXpKYVdBR1Ezc0xvalpXUmtWQWdHYkZhdE1Ba0dB
MVVkRXdRQ01BQXdLd1lJS3dZQkJRVUhBU0FFSHhZZGFHbG5hSGRoZVMxMFpYTjBMbVY0
WVcxd2JHVXVZMjl0T2prME5ETXdDZ1lJS29aSXpqMEVBd0lEWndBd1pBSXdUbWxHOHNY
a0tHTmJ3YktRY1lNYXBGYm1TYm5ISFVSRlVvRnVScXZiZ1lYN0ZsWHBCY3pmd0Yya2xs
TnV1amlnQWpBb3cxa2M0cjU1RW1pSCtPTUVYakJObFdsQlNaQzVRdUpqRWYwSnNteHNz
YytwdWNqT0o0U2hxbmV4TUV5N2JqQXhnZ0VFTUlJQkFBSUJBVEF1TUNZeEpEQWlCZ05W
QkFNTUcyaHBaMmgzWVhrdGRHVnpkQzVsZUdGdGNHeGxMbU52YlNCRFFRSUVEWU92MlRB
TEJnbGdoa2dCWlFNRUFnR2dhVEFZQmdrcWhraUc5dzBCQ1FNeEN3WUpLb1pJaHZjTkFR
Y0JNQndHQ1NxR1NJYjNEUUVKQlRFUEZ3MHlNVEEwTVRNeU1UUXpNak5hTUM4R0NTcUdT
SWIzRFFFSkJERWlCQ0JKd2h5WWliSWplcWVSM2JPYUxVUnpNbEdyYzNGMlgra3ZKMWVy
cnRvQ3RUQUtCZ2dxaGtqT1BRUURBZ1JITUVVQ0lRQ21ZdUNFNjFIRlFYSC9FMTZHRE9D
c1ZxdUR0Z3IrUS82L0R1LzlRa3pBN2dJZ2Y3TUZoQUlQVzJQTndSYTJ2WkZRQUtYVWJp
bWtpSEt6WEJBOG1kMFZIYlU9In19oIIEbzCCAfwwggGCoAMCAQICBD+Ym1IwCgYIKoZI
zj0EAwIwbTESMBAGCgmSJomT8ixkARkWAmNhMRkwFwYKCZImiZPyLGQBGRYJc2FuZGVs
bWFuMTwwOgYDVQQDDDNmb3VudGFpbi10ZXN0LmV4YW1wbGUuY29tIFVuc3RydW5nIEZv
dW50YWluIFJvb3QgQ0EwHhcNMjAwMjI1MjEzMTU0WhcNMjIwMjI0MjEzMTU0WjBTMRIw
EAYKCZImiZPyLGQBGRYCY2ExGTAXBgoJkiaJk/IsZAEZFglzYW5kZWxtYW4xIjAgBgNV
BAMMGWZvdW50YWluLXRlc3QuZXhhbXBsZS5jb20wWTATBgcqhkjOPQIBBggqhkjOPQMB
BwNCAASWZVByNLqf5d3mX/bwgW/pSJ6BDBIHO0aPl2QrYwCNAg9XyXyUf4SMsg5h1smI
jRW0Qh/X8mq35M4F+KdM04s6oyowKDAWBgNVHSUBAf8EDDAKBggrBgEFBQcDHDAOBgNV
HQ8BAf8EBAMCB4AwCgYIKoZIzj0EAwIDaAAwZQIwZk9gTFVIHpYH+N0fucgSjUU2h5sj
wLy78cs9JhVWb18fv9UcDmoJrxt2l5kZI/1+AjEAvKzDQbC6Da9S+Zxuen8AHSPIYgFh
vEvFwEeZNQoMd2FEAUoHUnBXAHX/vgcOmMvlMIICazCCAfKgAwIBAgIEKWsGWTAKBggq
hkjOPQQDAjBtMRIwEAYKCZImiZPyLGQBGRYCY2ExGTAXBgoJkiaJk/IsZAEZFglzYW5k
ZWxtYW4xPDA6BgNVBAMMM2ZvdW50YWluLXRlc3QuZXhhbXBsZS5jb20gVW5zdHJ1bmcg
Rm91bnRhaW4gUm9vdCBDQTAeFw0yMDAyMjUyMTMxNDVaFw0yMjAyMjQyMTMxNDVaMG0x
EjAQBgoJkiaJk/IsZAEZFgJjYTEZMBcGCgmSJomT8ixkARkWCXNhbmRlbG1hbjE8MDoG
A1UEAwwzZm91bnRhaW4tdGVzdC5leGFtcGxlLmNvbSBVbnN0cnVuZyBGb3VudGFpbiBS
b290IENBMHYwEAYHKoZIzj0CAQYFK4EEACIDYgAEG39ZuhfDGrxmjYxs4MP6MXEPZfYi
kb23VoAH29+4eqVFTXmKRpcZWZYxsY9pfTK+PMg+W2O1Rvao1W+b+cDz07kUP3JHUaR2
3dLwv/XKjzABf/jCX9P1IANEi4vyB2y0o2MwYTAPBgNVHRMBAf8EBTADAQH/MA4GA1Ud
DwEB/wQEAwIBBjAdBgNVHQ4EFgQUuaX2yxHhB6RJLKcIxnwQvIezdCYwHwYDVR0jBBgw
FoAUuaX2yxHhB6RJLKcIxnwQvIezdCYwCgYIKoZIzj0EAwIDZwAwZAIwIIMGzo2YpFR6
ZkxKOnDCUjZaUo1ZfSCbKmkUWIc42FV53f0pOJUekZN2tPVmKUS0AjBvOPmvEu0w1YUp
fLEWWL1nkUPEDTD52BysLwbdvNUGQiyEogTqAqRfF1Em+9kv0lwxggFLMIIBRwIBATB1
MG0xEjAQBgoJkiaJk/IsZAEZFgJjYTEZMBcGCgmSJomT8ixkARkWCXNhbmRlbG1hbjE8
MDoGA1UEAwwzZm91bnRhaW4tdGVzdC5leGFtcGxlLmNvbSBVbnN0cnVuZyBGb3VudGFp
biBSb290IENBAgQ/mJtSMAsGCWCGSAFlAwQCAaBpMBgGCSqGSIb3DQEJAzELBgkqhkiG
9w0BBwEwHAYJKoZIhvcNAQkFMQ8XDTIxMDQxMzIxNDMyM1owLwYJKoZIhvcNAQkEMSIE
IEnOrdWjlG70K74IhCJ7UXi+wPS+r2C8DFEqjabGP+G8MAoGCCqGSM49BAMCBEcwRQIh
AMhO3M+tSWb2wKTBOXPArN+XvjSzAhaQA/uLj3qhPwi/AiBDDthf6mjMuirqXE0yjMif
C2UY9oNUFF9Nl0wEQpBBAA==

&lt;CODE ENDS&gt;</pre><a class="pilcrow" href="#section-c.2.2-2">¶</a>
</div>
<p class="keepWithNext" id="section-c.2.2-3">
            The ASN1 decoding of the artifact:<a class="pilcrow" href="#section-c.2.2-3">¶</a></p>
<p id="section-c.2.2-4">file: examples/parboiled_vr_00_D0-E5-02-00-2D.b64<a class="pilcrow" href="#section-c.2.2-4">¶</a></p>
<div class="artwork art-text alignLeft" id="section-c.2.2-5">
<pre>    0:d=0  hl=4 l=3939 cons: SEQUENCE
    4:d=1  hl=2 l=   9 prim: OBJECT            :pkcs7-signedData
   15:d=1  hl=4 l=3924 cons: cont [ 0 ]
   19:d=2  hl=4 l=3920 cons: SEQUENCE
   23:d=3  hl=2 l=   1 prim: INTEGER           :01
   26:d=3  hl=2 l=  13 cons: SET
   28:d=4  hl=2 l=  11 cons: SEQUENCE
   30:d=5  hl=2 l=   9 prim: OBJECT            :sha256
   41:d=3  hl=4 l=2424 cons: SEQUENCE
   45:d=4  hl=2 l=   9 prim: OBJECT            :pkcs7-data
   56:d=4  hl=4 l=2409 cons: cont [ 0 ]
   60:d=5  hl=4 l=2405 prim: OCTET STRING      :{"ietf-voucher-request:v
 2469:d=3  hl=4 l=1135 cons: cont [ 0 ]
 2473:d=4  hl=4 l= 508 cons: SEQUENCE
 2477:d=5  hl=4 l= 386 cons: SEQUENCE
 2481:d=6  hl=2 l=   3 cons: cont [ 0 ]
 2483:d=7  hl=2 l=   1 prim: INTEGER           :02
 2486:d=6  hl=2 l=   4 prim: INTEGER           :3F989B52
 2492:d=6  hl=2 l=  10 cons: SEQUENCE
 2494:d=7  hl=2 l=   8 prim: OBJECT            :ecdsa-with-SHA256
 2504:d=6  hl=2 l= 109 cons: SEQUENCE
 2506:d=7  hl=2 l=  18 cons: SET
 2508:d=8  hl=2 l=  16 cons: SEQUENCE
 2510:d=9  hl=2 l=  10 prim: OBJECT            :domainComponent
 2522:d=9  hl=2 l=   2 prim: IA5STRING         :ca
 2526:d=7  hl=2 l=  25 cons: SET
 2528:d=8  hl=2 l=  23 cons: SEQUENCE
 2530:d=9  hl=2 l=  10 prim: OBJECT            :domainComponent
 2542:d=9  hl=2 l=   9 prim: IA5STRING         :sandelman
 2553:d=7  hl=2 l=  60 cons: SET
 2555:d=8  hl=2 l=  58 cons: SEQUENCE
 2557:d=9  hl=2 l=   3 prim: OBJECT            :commonName
 2562:d=9  hl=2 l=  51 prim: UTF8STRING        :fountain-test.example.co
 2615:d=6  hl=2 l=  30 cons: SEQUENCE
 2617:d=7  hl=2 l=  13 prim: UTCTIME           :200225213154Z
 2632:d=7  hl=2 l=  13 prim: UTCTIME           :220224213154Z
 2647:d=6  hl=2 l=  83 cons: SEQUENCE
 2649:d=7  hl=2 l=  18 cons: SET
 2651:d=8  hl=2 l=  16 cons: SEQUENCE
 2653:d=9  hl=2 l=  10 prim: OBJECT            :domainComponent
 2665:d=9  hl=2 l=   2 prim: IA5STRING         :ca
 2669:d=7  hl=2 l=  25 cons: SET
 2671:d=8  hl=2 l=  23 cons: SEQUENCE
 2673:d=9  hl=2 l=  10 prim: OBJECT            :domainComponent
 2685:d=9  hl=2 l=   9 prim: IA5STRING         :sandelman
 2696:d=7  hl=2 l=  34 cons: SET
 2698:d=8  hl=2 l=  32 cons: SEQUENCE
 2700:d=9  hl=2 l=   3 prim: OBJECT            :commonName
 2705:d=9  hl=2 l=  25 prim: UTF8STRING        :fountain-test.example.co
 2732:d=6  hl=2 l=  89 cons: SEQUENCE
 2734:d=7  hl=2 l=  19 cons: SEQUENCE
 2736:d=8  hl=2 l=   7 prim: OBJECT            :id-ecPublicKey
 2745:d=8  hl=2 l=   8 prim: OBJECT            :prime256v1
 2755:d=7  hl=2 l=  66 prim: BIT STRING
 2823:d=6  hl=2 l=  42 cons: cont [ 3 ]
 2825:d=7  hl=2 l=  40 cons: SEQUENCE
 2827:d=8  hl=2 l=  22 cons: SEQUENCE
 2829:d=9  hl=2 l=   3 prim: OBJECT            :X509v3 Extended Key Usag
 2834:d=9  hl=2 l=   1 prim: BOOLEAN           :255
 2837:d=9  hl=2 l=  12 prim: OCTET STRING      [HEX DUMP]:300A06082B0601
 2851:d=8  hl=2 l=  14 cons: SEQUENCE
 2853:d=9  hl=2 l=   3 prim: OBJECT            :X509v3 Key Usage
 2858:d=9  hl=2 l=   1 prim: BOOLEAN           :255
 2861:d=9  hl=2 l=   4 prim: OCTET STRING      [HEX DUMP]:03020780
 2867:d=5  hl=2 l=  10 cons: SEQUENCE
 2869:d=6  hl=2 l=   8 prim: OBJECT            :ecdsa-with-SHA256
 2879:d=5  hl=2 l= 104 prim: BIT STRING
 2985:d=4  hl=4 l= 619 cons: SEQUENCE
 2989:d=5  hl=4 l= 498 cons: SEQUENCE
 2993:d=6  hl=2 l=   3 cons: cont [ 0 ]
 2995:d=7  hl=2 l=   1 prim: INTEGER           :02
 2998:d=6  hl=2 l=   4 prim: INTEGER           :296B0659
 3004:d=6  hl=2 l=  10 cons: SEQUENCE
 3006:d=7  hl=2 l=   8 prim: OBJECT            :ecdsa-with-SHA256
 3016:d=6  hl=2 l= 109 cons: SEQUENCE
 3018:d=7  hl=2 l=  18 cons: SET
 3020:d=8  hl=2 l=  16 cons: SEQUENCE
 3022:d=9  hl=2 l=  10 prim: OBJECT            :domainComponent
 3034:d=9  hl=2 l=   2 prim: IA5STRING         :ca
 3038:d=7  hl=2 l=  25 cons: SET
 3040:d=8  hl=2 l=  23 cons: SEQUENCE
 3042:d=9  hl=2 l=  10 prim: OBJECT            :domainComponent
 3054:d=9  hl=2 l=   9 prim: IA5STRING         :sandelman
 3065:d=7  hl=2 l=  60 cons: SET
 3067:d=8  hl=2 l=  58 cons: SEQUENCE
 3069:d=9  hl=2 l=   3 prim: OBJECT            :commonName
 3074:d=9  hl=2 l=  51 prim: UTF8STRING        :fountain-test.example.co
 3127:d=6  hl=2 l=  30 cons: SEQUENCE
 3129:d=7  hl=2 l=  13 prim: UTCTIME           :200225213145Z
 3144:d=7  hl=2 l=  13 prim: UTCTIME           :220224213145Z
 3159:d=6  hl=2 l= 109 cons: SEQUENCE
 3161:d=7  hl=2 l=  18 cons: SET
 3163:d=8  hl=2 l=  16 cons: SEQUENCE
 3165:d=9  hl=2 l=  10 prim: OBJECT            :domainComponent
 3177:d=9  hl=2 l=   2 prim: IA5STRING         :ca
 3181:d=7  hl=2 l=  25 cons: SET
 3183:d=8  hl=2 l=  23 cons: SEQUENCE
 3185:d=9  hl=2 l=  10 prim: OBJECT            :domainComponent
 3197:d=9  hl=2 l=   9 prim: IA5STRING         :sandelman
 3208:d=7  hl=2 l=  60 cons: SET
 3210:d=8  hl=2 l=  58 cons: SEQUENCE
 3212:d=9  hl=2 l=   3 prim: OBJECT            :commonName
 3217:d=9  hl=2 l=  51 prim: UTF8STRING        :fountain-test.example.co
 3270:d=6  hl=2 l= 118 cons: SEQUENCE
 3272:d=7  hl=2 l=  16 cons: SEQUENCE
 3274:d=8  hl=2 l=   7 prim: OBJECT            :id-ecPublicKey
 3283:d=8  hl=2 l=   5 prim: OBJECT            :secp384r1
 3290:d=7  hl=2 l=  98 prim: BIT STRING
 3390:d=6  hl=2 l=  99 cons: cont [ 3 ]
 3392:d=7  hl=2 l=  97 cons: SEQUENCE
 3394:d=8  hl=2 l=  15 cons: SEQUENCE
 3396:d=9  hl=2 l=   3 prim: OBJECT            :X509v3 Basic Constraints
 3401:d=9  hl=2 l=   1 prim: BOOLEAN           :255
 3404:d=9  hl=2 l=   5 prim: OCTET STRING      [HEX DUMP]:30030101FF
 3411:d=8  hl=2 l=  14 cons: SEQUENCE
 3413:d=9  hl=2 l=   3 prim: OBJECT            :X509v3 Key Usage
 3418:d=9  hl=2 l=   1 prim: BOOLEAN           :255
 3421:d=9  hl=2 l=   4 prim: OCTET STRING      [HEX DUMP]:03020106
 3427:d=8  hl=2 l=  29 cons: SEQUENCE
 3429:d=9  hl=2 l=   3 prim: OBJECT            :X509v3 Subject Key Ident
 3434:d=9  hl=2 l=  22 prim: OCTET STRING      [HEX DUMP]:0414B9A5F6CB11
 3458:d=8  hl=2 l=  31 cons: SEQUENCE
 3460:d=9  hl=2 l=   3 prim: OBJECT            :X509v3 Authority Key Ide
 3465:d=9  hl=2 l=  24 prim: OCTET STRING      [HEX DUMP]:30168014B9A5F6
 3491:d=5  hl=2 l=  10 cons: SEQUENCE
 3493:d=6  hl=2 l=   8 prim: OBJECT            :ecdsa-with-SHA256
 3503:d=5  hl=2 l= 103 prim: BIT STRING
 3608:d=3  hl=4 l= 331 cons: SET
 3612:d=4  hl=4 l= 327 cons: SEQUENCE
 3616:d=5  hl=2 l=   1 prim: INTEGER           :01
 3619:d=5  hl=2 l= 117 cons: SEQUENCE
 3621:d=6  hl=2 l= 109 cons: SEQUENCE
 3623:d=7  hl=2 l=  18 cons: SET
 3625:d=8  hl=2 l=  16 cons: SEQUENCE
 3627:d=9  hl=2 l=  10 prim: OBJECT            :domainComponent
 3639:d=9  hl=2 l=   2 prim: IA5STRING         :ca
 3643:d=7  hl=2 l=  25 cons: SET
 3645:d=8  hl=2 l=  23 cons: SEQUENCE
 3647:d=9  hl=2 l=  10 prim: OBJECT            :domainComponent
 3659:d=9  hl=2 l=   9 prim: IA5STRING         :sandelman
 3670:d=7  hl=2 l=  60 cons: SET
 3672:d=8  hl=2 l=  58 cons: SEQUENCE
 3674:d=9  hl=2 l=   3 prim: OBJECT            :commonName
 3679:d=9  hl=2 l=  51 prim: UTF8STRING        :fountain-test.example.co
 3732:d=6  hl=2 l=   4 prim: INTEGER           :3F989B52
 3738:d=5  hl=2 l=  11 cons: SEQUENCE
 3740:d=6  hl=2 l=   9 prim: OBJECT            :sha256
 3751:d=5  hl=2 l= 105 cons: cont [ 0 ]
 3753:d=6  hl=2 l=  24 cons: SEQUENCE
 3755:d=7  hl=2 l=   9 prim: OBJECT            :contentType
 3766:d=7  hl=2 l=  11 cons: SET
 3768:d=8  hl=2 l=   9 prim: OBJECT            :pkcs7-data
 3779:d=6  hl=2 l=  28 cons: SEQUENCE
 3781:d=7  hl=2 l=   9 prim: OBJECT            :signingTime
 3792:d=7  hl=2 l=  15 cons: SET
 3794:d=8  hl=2 l=  13 prim: UTCTIME           :210413214323Z
 3809:d=6  hl=2 l=  47 cons: SEQUENCE
 3811:d=7  hl=2 l=   9 prim: OBJECT            :messageDigest
 3822:d=7  hl=2 l=  34 cons: SET
 3824:d=8  hl=2 l=  32 prim: OCTET STRING      [HEX DUMP]:49CEADD5A3946E
 3858:d=5  hl=2 l=  10 cons: SEQUENCE
 3860:d=6  hl=2 l=   8 prim: OBJECT            :ecdsa-with-SHA256
 3870:d=5  hl=2 l=  71 prim: OCTET STRING      [HEX DUMP]:3045022100C84E

</pre><a class="pilcrow" href="#section-c.2.2-5">¶</a>
</div>
<p id="section-c.2.2-6">
            The JSON contained in the voucher-request. Note that the previous
            voucher-request is in the prior-signed-voucher-request attribute.<a class="pilcrow" href="#section-c.2.2-6">¶</a></p>
<div id="section-c.2.2-7">
<pre class="sourcecode lang-json">{"ietf-voucher-request:voucher":{"assertion":"proximity","cr
eated-on":"2021-04-13T21:43:23.787Z","serial-number":"00-D0-
E5-F2-00-02","nonce":"-_XE9zK9q8Ll1qylMtLKeg","prior-signed-
voucher-request":"MIIGcAYJKoZIhvcNAQcCoIIGYTCCBl0CAQExDTALBg
lghkgBZQMEAgEwggOJBgkqhkiG9w0BBwGgggN6BIIDdnsiaWV0Zi12b3VjaG
VyLXJlcXVlc3Q6dm91Y2hlciI6eyJhc3NlcnRpb24iOiJwcm94aW1pdHkiLC
JjcmVhdGVkLW9uIjoiMjAyMS0wNC0xM1QxNzo0MzoyMy43NDctMDQ6MDAiLC
JzZXJpYWwtbnVtYmVyIjoiMDAtRDAtRTUtRjItMDAtMDIiLCJub25jZSI6Ii
1fWEU5eks5cThMbDFxeWxNdExLZWciLCJwcm94aW1pdHktcmVnaXN0cmFyLW
NlcnQiOiJNSUlCL0RDQ0FZS2dBd0lCQWdJRVA1aWJVakFLQmdncWhrak9QUV
FEQWpCdE1SSXdFQVlLQ1pJbWlaUHlMR1FCR1JZQ1kyRXhHVEFYQmdvSmtpYU
prL0lzWkFFWkZnbHpZVzVrWld4dFlXNHhQREE2QmdOVkJBTU1NMlp2ZFc1MF
lXbHVMWFJsYzNRdVpYaGhiWEJzWlM1amIyMGdWVzV6ZEhKMWJtY2dSbTkxYm
5SaGFXNGdVbTl2ZENCRFFUQWVGdzB5TURBeU1qVXlNVE14TlRSYUZ3MHlNak
F5TWpReU1UTXhOVFJhTUZNeEVqQVFCZ29Ka2lhSmsvSXNaQUVaRmdKallURV
pNQmNHQ2dtU0pvbVQ4aXhrQVJrV0NYTmhibVJsYkcxaGJqRWlNQ0FHQTFVRU
F3d1pabTkxYm5SaGFXNHRkR1Z6ZEM1bGVHRnRjR3hsTG1OdmJUQlpNQk1HQn
lxR1NNNDlBZ0VHQ0NxR1NNNDlBd0VIQTBJQUJKWmxVSEkwdXAvbDNlWmY5dk
NCYitsSW5vRU1FZ2M3Um8rWFpDdGpBSTBDRDFmSmZKUi9oSXl5RG1IV3lZaU
5GYlJDSDlmeWFyZmt6Z1g0cDB6VGl6cWpLakFvTUJZR0ExVWRKUUVCL3dRTU
1Bb0dDQ3NHQVFVRkJ3TWNNQTRHQTFVZER3RUIvd1FFQXdJSGdEQUtCZ2dxaG
tqT1BRUURBZ05vQURCbEFqQm1UMkJNVlVnZWxnZjQzUis1eUJLTlJUYUhteV
BBdkx2eHl6MG1GVlp2WHgrLzFSd09hZ212RzNhWG1Sa2ovWDRDTVFDOHJNTk
JzTG9OcjFMNW5HNTZmd0FkSThoaUFXRzhTOFhBUjVrMUNneDNZVVFCU2dkU2
NGY0FkZisrQnc2WXkrVT0ifX2gggGyMIIBrjCCATWgAwIBAgIEDYOv2TAKBg
gqhkjOPQQDAjAmMSQwIgYDVQQDDBtoaWdod2F5LXRlc3QuZXhhbXBsZS5jb2
0gQ0EwIBcNMjEwNDEzMjAzNzM5WhgPMjk5OTEyMzEwMDAwMDBaMBwxGjAYBg
NVBAUMETAwLUQwLUU1LUYyLTAwLTAyMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQ
cDQgAEA6N1Q4ezfMAKmoecrfb0OBMc1AyEH+BATkF58FsTSyBxs0SbSWLxFj
DOuwB9gLGn2TsTUJumJ6VPw5Z/TP4hJ6NZMFcwHQYDVR0OBBYEFEWIzJaWAG
Q3sLojZWRkVAgGbFatMAkGA1UdEwQCMAAwKwYIKwYBBQUHASAEHxYdaGlnaH
dheS10ZXN0LmV4YW1wbGUuY29tOjk0NDMwCgYIKoZIzj0EAwIDZwAwZAIwTm
lG8sXkKGNbwbKQcYMapFbmSbnHHURFUoFuRqvbgYX7FlXpBczfwF2kllNuuj
igAjAow1kc4r55EmiH+OMEXjBNlWlBSZC5QuJjEf0Jsmxssc+pucjOJ4Shqn
exMEy7bjAxggEEMIIBAAIBATAuMCYxJDAiBgNVBAMMG2hpZ2h3YXktdGVzdC
5leGFtcGxlLmNvbSBDQQIEDYOv2TALBglghkgBZQMEAgGgaTAYBgkqhkiG9w
0BCQMxCwYJKoZIhvcNAQcBMBwGCSqGSIb3DQEJBTEPFw0yMTA0MTMyMTQzMj
NaMC8GCSqGSIb3DQEJBDEiBCBJwhyYibIjeqeR3bOaLURzMlGrc3F2X+kvJ1
errtoCtTAKBggqhkjOPQQDAgRHMEUCIQCmYuCE61HFQXH/E16GDOCsVquDtg
r+Q/6/Du/9QkzA7gIgf7MFhAIPW2PNwRa2vZFQAKXUbimkiHKzXBA8md0VHb
U="}}
</pre><a class="pilcrow" href="#section-c.2.2-7">¶</a>
</div>
</section>
<section id="section-c.2.3">
          <h3 id="name-masa-to-registrar">
<a class="section-number selfRef" href="#section-c.2.3">C.2.3. </a><a class="section-name selfRef" href="#name-masa-to-registrar">MASA to Registrar</a>
          </h3>
<p id="section-c.2.3-1">
            The MASA will return a voucher to the registrar, which is to be relayed to
            the pledge.<a class="pilcrow" href="#section-c.2.3-1">¶</a></p>
<div id="section-c.2.3-2">
<pre class="sourcecode">&lt;CODE BEGINS&gt; file "voucher_00-D0-E5-F2-00-02.b64"

MIIGIgYJKoZIhvcNAQcCoIIGEzCCBg8CAQExDTALBglghkgBZQMEAgEwggN4BgkqhkiG
9w0BBwGgggNpBIIDZXsiaWV0Zi12b3VjaGVyOnZvdWNoZXIiOnsiYXNzZXJ0aW9uIjoi
bG9nZ2VkIiwiY3JlYXRlZC1vbiI6IjIwMjEtMDQtMTNUMTc6NDM6MjQuNTg5LTA0OjAw
Iiwic2VyaWFsLW51bWJlciI6IjAwLUQwLUU1LUYyLTAwLTAyIiwibm9uY2UiOiItX1hF
OXpLOXE4TGwxcXlsTXRMS2VnIiwicGlubmVkLWRvbWFpbi1jZXJ0IjoiTUlJQi9EQ0NB
WUtnQXdJQkFnSUVQNWliVWpBS0JnZ3Foa2pPUFFRREFqQnRNUkl3RUFZS0NaSW1pWlB5
TEdRQkdSWUNZMkV4R1RBWEJnb0praWFKay9Jc1pBRVpGZ2x6WVc1a1pXeHRZVzR4UERB
NkJnTlZCQU1NTTJadmRXNTBZV2x1TFhSbGMzUXVaWGhoYlhCc1pTNWpiMjBnVlc1emRI
SjFibWNnUm05MWJuUmhhVzRnVW05dmRDQkRRVEFlRncweU1EQXlNalV5TVRNeE5UUmFG
dzB5TWpBeU1qUXlNVE14TlRSYU1GTXhFakFRQmdvSmtpYUprL0lzWkFFWkZnSmpZVEVa
TUJjR0NnbVNKb21UOGl4a0FSa1dDWE5oYm1SbGJHMWhiakVpTUNBR0ExVUVBd3daWm05
MWJuUmhhVzR0ZEdWemRDNWxlR0Z0Y0d4bExtTnZiVEJaTUJNR0J5cUdTTTQ5QWdFR0ND
cUdTTTQ5QXdFSEEwSUFCSlpsVUhJMHVwL2wzZVpmOXZDQmIrbElub0VNRWdjN1JvK1ha
Q3RqQUkwQ0QxZkpmSlIvaEl5eURtSFd5WWlORmJSQ0g5ZnlhcmZremdYNHAwelRpenFq
S2pBb01CWUdBMVVkSlFFQi93UU1NQW9HQ0NzR0FRVUZCd01jTUE0R0ExVWREd0VCL3dR
RUF3SUhnREFLQmdncWhrak9QUVFEQWdOb0FEQmxBakJtVDJCTVZVZ2VsZ2Y0M1IrNXlC
S05SVGFIbXlQQXZMdnh5ejBtRlZadlh4Ky8xUndPYWdtdkczYVhtUmtqL1g0Q01RQzhy
TU5Cc0xvTnIxTDVuRzU2ZndBZEk4aGlBV0c4UzhYQVI1azFDZ3gzWVVRQlNnZFNjRmNB
ZGYrK0J3Nll5K1U9In19oIIBdDCCAXAwgfagAwIBAgIEC4cKMTAKBggqhkjOPQQDAjAm
MSQwIgYDVQQDDBtoaWdod2F5LXRlc3QuZXhhbXBsZS5jb20gQ0EwHhcNMjEwNDEzMjE0
MDE2WhcNMjMwNDEzMjE0MDE2WjAoMSYwJAYDVQQDDB1oaWdod2F5LXRlc3QuZXhhbXBs
ZS5jb20gTUFTQTBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABKoEFaNEueJE+Mn5Gwcb
pnRznB66bKmzqTCpojJZ96AdRwFtuTCVfoKouLTBX0idIhMLfJLM31lyuKy4CUtpp6Wj
EDAOMAwGA1UdEwEB/wQCMAAwCgYIKoZIzj0EAwIDaQAwZgIxAK7LYS3UXI1uhqoLBh3G
02C6MnM2JdMjhUmHHM6UI3kankFVJB0VIqFIuwrAqzwTcwIxAIY8Z7OVouLl+a35HZzB
NDJ49c/q1UcDnwC/0FnLUcKYBIEkilETULF1si+dqLT0uTGCAQUwggEBAgEBMC4wJjEk
MCIGA1UEAwwbaGlnaHdheS10ZXN0LmV4YW1wbGUuY29tIENBAgQLhwoxMAsGCWCGSAFl
AwQCAaBpMBgGCSqGSIb3DQEJAzELBgkqhkiG9w0BBwEwHAYJKoZIhvcNAQkFMQ8XDTIx
MDQxMzIxNDMyNFowLwYJKoZIhvcNAQkEMSIEIFUUjg4WYVO+MpX122Qfk/7zm/G6/B59
HD/xrVR0lGIjMAoGCCqGSM49BAMCBEgwRgIhAOhUfxbH2dwpB2BrTDcsYSjRkCCk/WE6
Mdt+y4z5KD9IAiEAphwdIUb40A0noNIUpH7N2lTyAFZgyn1lNHTteY9DmYI=

&lt;CODE ENDS&gt;</pre><a class="pilcrow" href="#section-c.2.3-2">¶</a>
</div>
<p class="keepWithNext" id="section-c.2.3-3">
            The ASN1 decoding of the artifact:<a class="pilcrow" href="#section-c.2.3-3">¶</a></p>
<p id="section-c.2.3-4">file: examples/voucher_00-D0-E5-F2-00-02.b64<a class="pilcrow" href="#section-c.2.3-4">¶</a></p>
<div class="artwork art-text alignLeft" id="section-c.2.3-5">
<pre>    0:d=0  hl=4 l=1570 cons: SEQUENCE
    4:d=1  hl=2 l=   9 prim: OBJECT            :pkcs7-signedData
   15:d=1  hl=4 l=1555 cons: cont [ 0 ]
   19:d=2  hl=4 l=1551 cons: SEQUENCE
   23:d=3  hl=2 l=   1 prim: INTEGER           :01
   26:d=3  hl=2 l=  13 cons: SET
   28:d=4  hl=2 l=  11 cons: SEQUENCE
   30:d=5  hl=2 l=   9 prim: OBJECT            :sha256
   41:d=3  hl=4 l= 888 cons: SEQUENCE
   45:d=4  hl=2 l=   9 prim: OBJECT            :pkcs7-data
   56:d=4  hl=4 l= 873 cons: cont [ 0 ]
   60:d=5  hl=4 l= 869 prim: OCTET STRING      :{"ietf-voucher:voucher":
  933:d=3  hl=4 l= 372 cons: cont [ 0 ]
  937:d=4  hl=4 l= 368 cons: SEQUENCE
  941:d=5  hl=3 l= 246 cons: SEQUENCE
  944:d=6  hl=2 l=   3 cons: cont [ 0 ]
  946:d=7  hl=2 l=   1 prim: INTEGER           :02
  949:d=6  hl=2 l=   4 prim: INTEGER           :0B870A31
  955:d=6  hl=2 l=  10 cons: SEQUENCE
  957:d=7  hl=2 l=   8 prim: OBJECT            :ecdsa-with-SHA256
  967:d=6  hl=2 l=  38 cons: SEQUENCE
  969:d=7  hl=2 l=  36 cons: SET
  971:d=8  hl=2 l=  34 cons: SEQUENCE
  973:d=9  hl=2 l=   3 prim: OBJECT            :commonName
  978:d=9  hl=2 l=  27 prim: UTF8STRING        :highway-test.example.com
 1007:d=6  hl=2 l=  30 cons: SEQUENCE
 1009:d=7  hl=2 l=  13 prim: UTCTIME           :210413214016Z
 1024:d=7  hl=2 l=  13 prim: UTCTIME           :230413214016Z
 1039:d=6  hl=2 l=  40 cons: SEQUENCE
 1041:d=7  hl=2 l=  38 cons: SET
 1043:d=8  hl=2 l=  36 cons: SEQUENCE
 1045:d=9  hl=2 l=   3 prim: OBJECT            :commonName
 1050:d=9  hl=2 l=  29 prim: UTF8STRING        :highway-test.example.com
 1081:d=6  hl=2 l=  89 cons: SEQUENCE
 1083:d=7  hl=2 l=  19 cons: SEQUENCE
 1085:d=8  hl=2 l=   7 prim: OBJECT            :id-ecPublicKey
 1094:d=8  hl=2 l=   8 prim: OBJECT            :prime256v1
 1104:d=7  hl=2 l=  66 prim: BIT STRING
 1172:d=6  hl=2 l=  16 cons: cont [ 3 ]
 1174:d=7  hl=2 l=  14 cons: SEQUENCE
 1176:d=8  hl=2 l=  12 cons: SEQUENCE
 1178:d=9  hl=2 l=   3 prim: OBJECT            :X509v3 Basic Constraints
 1183:d=9  hl=2 l=   1 prim: BOOLEAN           :255
 1186:d=9  hl=2 l=   2 prim: OCTET STRING      [HEX DUMP]:3000
 1190:d=5  hl=2 l=  10 cons: SEQUENCE
 1192:d=6  hl=2 l=   8 prim: OBJECT            :ecdsa-with-SHA256
 1202:d=5  hl=2 l= 105 prim: BIT STRING
 1309:d=3  hl=4 l= 261 cons: SET
 1313:d=4  hl=4 l= 257 cons: SEQUENCE
 1317:d=5  hl=2 l=   1 prim: INTEGER           :01
 1320:d=5  hl=2 l=  46 cons: SEQUENCE
 1322:d=6  hl=2 l=  38 cons: SEQUENCE
 1324:d=7  hl=2 l=  36 cons: SET
 1326:d=8  hl=2 l=  34 cons: SEQUENCE
 1328:d=9  hl=2 l=   3 prim: OBJECT            :commonName
 1333:d=9  hl=2 l=  27 prim: UTF8STRING        :highway-test.example.com
 1362:d=6  hl=2 l=   4 prim: INTEGER           :0B870A31
 1368:d=5  hl=2 l=  11 cons: SEQUENCE
 1370:d=6  hl=2 l=   9 prim: OBJECT            :sha256
 1381:d=5  hl=2 l= 105 cons: cont [ 0 ]
 1383:d=6  hl=2 l=  24 cons: SEQUENCE
 1385:d=7  hl=2 l=   9 prim: OBJECT            :contentType
 1396:d=7  hl=2 l=  11 cons: SET
 1398:d=8  hl=2 l=   9 prim: OBJECT            :pkcs7-data
 1409:d=6  hl=2 l=  28 cons: SEQUENCE
 1411:d=7  hl=2 l=   9 prim: OBJECT            :signingTime
 1422:d=7  hl=2 l=  15 cons: SET
 1424:d=8  hl=2 l=  13 prim: UTCTIME           :210413214324Z
 1439:d=6  hl=2 l=  47 cons: SEQUENCE
 1441:d=7  hl=2 l=   9 prim: OBJECT            :messageDigest
 1452:d=7  hl=2 l=  34 cons: SET
 1454:d=8  hl=2 l=  32 prim: OCTET STRING      [HEX DUMP]:55148E0E166153
 1488:d=5  hl=2 l=  10 cons: SEQUENCE
 1490:d=6  hl=2 l=   8 prim: OBJECT            :ecdsa-with-SHA256
 1500:d=5  hl=2 l=  72 prim: OCTET STRING      [HEX DUMP]:3046022100E854

</pre><a class="pilcrow" href="#section-c.2.3-5">¶</a>
</div>
</section>
<section id="section-c.2.4">
          <h3 id="name-acknowledgements">
<a class="section-name selfRef" href="#name-acknowledgements">Acknowledgements</a>
          </h3>
<p id="section-c.2.4-1">We would like to thank the various reviewers for their input, in
      particular
      <span class="contact-name">William Atwood</span>,
      <span class="contact-name">Brian Carpenter</span>,
      <span class="contact-name">Fuyu Eleven</span>,
      <span class="contact-name">Eliot Lear</span>,
      <span class="contact-name">Sergey Kasatkin</span>,
      <span class="contact-name">Anoop Kumar</span>,
      <span class="contact-name">Tom Petch</span>,
      <span class="contact-name">Markus Stenberg</span>,
      <span class="contact-name">Peter van der Stok</span>,
      and
      <span class="contact-name">Thomas Werner</span>.<a class="pilcrow" href="#section-c.2.4-1">¶</a></p>
<p id="section-c.2.4-2">
        Significant reviews were done by <span class="contact-name">Jari Arkko</span>,
<span class="contact-name">Christian Huitema</span>, and <span class="contact-name">Russ Housley</span>.<a class="pilcrow" href="#section-c.2.4-2">¶</a></p>
<p id="section-c.2.4-3">
        <span class="contact-name">Henk Birkholz</span> contributed the CDDL for the audit-log response.<a class="pilcrow" href="#section-c.2.4-3">¶</a></p>
<p id="section-c.2.4-4">
        This document started its life as a two-page idea from <span class="contact-name">Steinthor Bjarnason</span>.<a class="pilcrow" href="#section-c.2.4-4">¶</a></p>
<p id="section-c.2.4-5">
        In addition, significant review comments were provided by many IESG
        members, including <span class="contact-name">Adam Roach</span>, <span class="contact-name">Alexey Melnikov</span>, <span class="contact-name">Alissa Cooper</span>, <span class="contact-name">Benjamin Kaduk</span>, <span class="contact-name">Éric Vyncke</span>, <span class="contact-name">Roman Danyliw</span>, and <span class="contact-name">Magnus Westerlund</span>.<a class="pilcrow" href="#section-c.2.4-5">¶</a></p>
</section>
</section>
</div>
</section>
<div id="authors-addresses">
<section id="section-appendix.d">
      <h2 id="name-authors-addresses">
<a class="section-name selfRef" href="#name-authors-addresses">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Max Pritikin</span></div>
<div class="left" dir="auto"><span class="org">Cisco</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:pritikin@cisco.com">pritikin@cisco.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Michael C. Richardson</span></div>
<div class="left" dir="auto"><span class="org">Sandelman Software Works</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:mcr+ietf@sandelman.ca">mcr+ietf@sandelman.ca</a>
</div>
<div class="url">
<span>URI:</span>
<a class="url" href="http://www.sandelman.ca/">http://www.sandelman.ca/</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Toerless Eckert</span></div>
<div class="left" dir="auto"><span class="org">Futurewei Technologies Inc.  USA</span></div>
<div class="left" dir="auto"><span class="street-address">2330 Central Expy</span></div>
<div class="left" dir="auto">
<span class="locality">Santa Clara</span>, <span class="region">CA</span> <span class="postal-code">95050</span>
</div>
<div class="left" dir="auto"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:tte+ietf@cs.fau.de">tte+ietf@cs.fau.de</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Michael H. Behringer</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:Michael.H.Behringer@gmail.com">Michael.H.Behringer@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Kent Watsen</span></div>
<div class="left" dir="auto"><span class="org">Watsen Networks</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:kent+ietf@watsen.net">kent+ietf@watsen.net</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>


</body></html>