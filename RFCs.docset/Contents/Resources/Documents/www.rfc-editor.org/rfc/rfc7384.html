<html><head></head><body><pre>Internet Engineering Task Force (IETF)                        T. Mizrahi
Request for Comments: 7384                                       Marvell
Category: Informational                                     October 2014
ISSN: 2070-1721


                <span class="h1">Security Requirements of Time Protocols</span>
                      <span class="h1">in Packet Switched Networks</span>

Abstract

   As time and frequency distribution protocols are becoming
   increasingly common and widely deployed, concern about their exposure
   to various security threats is increasing.  This document defines a
   set of security requirements for time protocols, focusing on the
   Precision Time Protocol (PTP) and the Network Time Protocol (NTP).
   This document also discusses the security impacts of time protocol
   practices, the performance implications of external security
   practices on time protocols, and the dependencies between other
   security services and time synchronization.

Status of This Memo

   This document is not an Internet Standards Track specification; it is
   published for informational purposes.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Not all documents
   approved by the IESG are a candidate for any level of Internet
   Standard; see <a href="./rfc5741#section-2">SectionÂ 2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc7384">http://www.rfc-editor.org/info/rfc7384</a>.















<span class="grey">Mizrahi                       Informational                     [Page 1]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-2"></span>
<span class="grey"><a href="./rfc7384">RFC 7384</a>           Time Protocol Security Requirements      October 2014</span>


Copyright Notice

   Copyright (c) 2014 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://www.rfc-editor.org/bcp/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-4">4</a>
   <a href="#section-2">2</a>. Terminology .....................................................<a href="#page-5">5</a>
      <a href="#section-2.1">2.1</a>. Requirements Language ......................................<a href="#page-5">5</a>
      <a href="#section-2.2">2.2</a>. Abbreviations ..............................................<a href="#page-6">6</a>
      <a href="#section-2.3">2.3</a>. Common Terminology for PTP and NTP .........................<a href="#page-6">6</a>
      <a href="#section-2.4">2.4</a>. Terms Used in This Document ................................<a href="#page-6">6</a>
   <a href="#section-3">3</a>. Security Threats ................................................<a href="#page-7">7</a>
      <a href="#section-3.1">3.1</a>. Threat Model ...............................................<a href="#page-8">8</a>
           <a href="#section-3.1.1">3.1.1</a>. Internal vs. External Attackers .....................<a href="#page-8">8</a>
           <a href="#section-3.1.2">3.1.2</a>. Man in the Middle (MITM) vs. Packet Injector ........<a href="#page-8">8</a>
      <a href="#section-3.2">3.2</a>. Threat Analysis ............................................<a href="#page-9">9</a>
           <a href="#section-3.2.1">3.2.1</a>. Packet Manipulation .................................<a href="#page-9">9</a>
           <a href="#section-3.2.2">3.2.2</a>. Spoofing ............................................<a href="#page-9">9</a>
           <a href="#section-3.2.3">3.2.3</a>. Replay Attack .......................................<a href="#page-9">9</a>
           <a href="#section-3.2.4">3.2.4</a>. Rogue Master Attack .................................<a href="#page-9">9</a>
           <a href="#section-3.2.5">3.2.5</a>. Packet Interception and Removal ....................<a href="#page-10">10</a>
           <a href="#section-3.2.6">3.2.6</a>. Packet Delay Manipulation ..........................<a href="#page-10">10</a>
           <a href="#section-3.2.7">3.2.7</a>. L2/L3 DoS Attacks ..................................<a href="#page-10">10</a>
           <a href="#section-3.2.8">3.2.8</a>. Cryptographic Performance Attacks ..................<a href="#page-10">10</a>
           <a href="#section-3.2.9">3.2.9</a>. DoS Attacks against the Time Protocol ..............<a href="#page-11">11</a>
           <a href="#section-3.2.10">3.2.10</a>. Grandmaster Time Source Attack (e.g., GPS Fraud) ..11
           <a href="#section-3.2.11">3.2.11</a>. Exploiting Vulnerabilities in the Time Protocol ...<a href="#page-11">11</a>
           <a href="#section-3.2.12">3.2.12</a>. Network Reconnaissance ............................<a href="#page-11">11</a>
      <a href="#section-3.3">3.3</a>. Threat Analysis Summary ...................................<a href="#page-12">12</a>
   <a href="#section-4">4</a>. Requirement Levels .............................................<a href="#page-13">13</a>
   <a href="#section-5">5</a>. Security Requirements ..........................................<a href="#page-14">14</a>
      <a href="#section-5.1">5.1</a>. Clock Identity Authentication and Authorization ...........<a href="#page-14">14</a>
           <a href="#section-5.1.1">5.1.1</a>. Authentication and Authorization of Masters ........<a href="#page-15">15</a>
           5.1.2. Recursive Authentication and Authorization
                  of Masters (Chain of Trust) ........................<a href="#page-16">16</a>
           <a href="#section-5.1.3">5.1.3</a>. Authentication and Authorization of Slaves .........<a href="#page-17">17</a>



<span class="grey">Mizrahi                       Informational                     [Page 2]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-3"></span>
<span class="grey"><a href="./rfc7384">RFC 7384</a>           Time Protocol Security Requirements      October 2014</span>


           5.1.4. PTP: Authentication and Authorization of
                  P2P TCs by the Master ..............................<a href="#page-18">18</a>
           5.1.5. PTP: Authentication and Authorization of
                  Control Messages ...................................<a href="#page-18">18</a>
      <a href="#section-5.2">5.2</a>. Protocol Packet Integrity .................................<a href="#page-19">19</a>
           5.2.1. PTP: Hop-by-Hop vs. End-to-End Integrity
                  Protection .........................................<a href="#page-20">20</a>
                  <a href="#section-5.2.1.1">5.2.1.1</a>. Hop-by-Hop Integrity Protection ...........<a href="#page-20">20</a>
                  <a href="#section-5.2.1.2">5.2.1.2</a>. End-to-End Integrity Protection ...........<a href="#page-21">21</a>
      <a href="#section-5.3">5.3</a>. Spoofing Prevention .......................................<a href="#page-21">21</a>
      <a href="#section-5.4">5.4</a>. Availability ..............................................<a href="#page-22">22</a>
      <a href="#section-5.5">5.5</a>. Replay Protection .........................................<a href="#page-23">23</a>
      <a href="#section-5.6">5.6</a>. Cryptographic Keys and Security Associations ..............<a href="#page-23">23</a>
           <a href="#section-5.6.1">5.6.1</a>. Key Freshness ......................................<a href="#page-23">23</a>
           <a href="#section-5.6.2">5.6.2</a>. Security Association ...............................<a href="#page-24">24</a>
           <a href="#section-5.6.3">5.6.3</a>. Unicast and Multicast Associations .................<a href="#page-24">24</a>
      <a href="#section-5.7">5.7</a>. Performance ...............................................<a href="#page-25">25</a>
      <a href="#section-5.8">5.8</a>. Confidentiality ...........................................<a href="#page-26">26</a>
      <a href="#section-5.9">5.9</a>. Protection against Packet Delay and Interception Attacks ..27
      <a href="#section-5.10">5.10</a>. Combining Secured with Unsecured Nodes ...................<a href="#page-27">27</a>
           <a href="#section-5.10.1">5.10.1</a>. Secure Mode .......................................<a href="#page-28">28</a>
           <a href="#section-5.10.2">5.10.2</a>. Hybrid Mode .......................................<a href="#page-28">28</a>
   <a href="#section-6">6</a>. Summary of Requirements ........................................<a href="#page-29">29</a>
   <a href="#section-7">7</a>. Additional Security Implications ...............................<a href="#page-31">31</a>
      <a href="#section-7.1">7.1</a>. Security and On-the-Fly Timestamping ......................<a href="#page-31">31</a>
      <a href="#section-7.2">7.2</a>. PTP: Security and Two-Step Timestamping ...................<a href="#page-31">31</a>
      <a href="#section-7.3">7.3</a>. Intermediate Clocks .......................................<a href="#page-32">32</a>
      <a href="#section-7.4">7.4</a>. External Security Protocols and Time Protocols ............<a href="#page-32">32</a>
      <a href="#section-7.5">7.5</a>. External Security Services Requiring Time .................<a href="#page-33">33</a>
           <a href="#section-7.5.1">7.5.1</a>. Timestamped Certificates ...........................<a href="#page-33">33</a>
           <a href="#section-7.5.2">7.5.2</a>. Time Changes and Replay Attacks ....................<a href="#page-33">33</a>
   <a href="#section-8">8</a>. Issues for Further Discussion ..................................<a href="#page-34">34</a>
   <a href="#section-9">9</a>. Security Considerations ........................................<a href="#page-34">34</a>
   <a href="#section-10">10</a>. References ....................................................<a href="#page-34">34</a>
      <a href="#section-10.1">10.1</a>. Normative References .....................................<a href="#page-34">34</a>
      <a href="#section-10.2">10.2</a>. Informative References ...................................<a href="#page-34">34</a>
   Acknowledgments ...................................................<a href="#page-36">36</a>
   Contributors ......................................................<a href="#page-36">36</a>
   Author's Address ..................................................<a href="#page-36">36</a>












<span class="grey">Mizrahi                       Informational                     [Page 3]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-4"></span>
<span class="grey"><a href="./rfc7384">RFC 7384</a>           Time Protocol Security Requirements      October 2014</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" id="section-1">1</a>.  Introduction</span>

   As time protocols are becoming increasingly common and widely
   deployed, concern about the resulting exposure to various security
   threats is increasing.  If a time protocol is compromised, the
   applications it serves are prone to a range of possible attacks
   including Denial of Service (DoS) or incorrect behavior.

   This document discusses the security aspects of time distribution
   protocols in packet networks and focuses on the two most common
   protocols: the Network Time Protocol [<a href="#ref-NTPv4" title='"Network Time Protocol Version 4: Protocol and Algorithms Specification"'>NTPv4</a>] and the Precision Time
   Protocol (PTP) [<a href="#ref-IEEE1588" title='"1588-2008 - IEEE Standard for a Precision Clock Synchronization Protocol for Networked Measurement and Control Systems"'>IEEE1588</a>].  Note that although PTP was not defined by
   the IETF, it is one of the two most common time protocols; hence, it
   is included in the discussion.

   The Network Time Protocol was defined with an inherent security
   protocol; [<a href="#ref-NTPv4" title='"Network Time Protocol Version 4: Protocol and Algorithms Specification"'>NTPv4</a>] defines a security protocol that is based on a
   symmetric key authentication scheme, and [<a href="#ref-AutoKey" title='"Network Time Protocol Version 4: Autokey Specification"'>AutoKey</a>] presents an
   alternative security protocol, based on a public key authentication
   scheme.  [<a href="#ref-IEEE1588" title='"1588-2008 - IEEE Standard for a Precision Clock Synchronization Protocol for Networked Measurement and Control Systems"'>IEEE1588</a>] includes an experimental security protocol,
   defined in Annex K of the standard, but this Annex was never
   formalized into a fully defined security protocol.

   While NTP includes an inherent security protocol, the absence of a
   standard security solution for PTP undoubtedly contributed to the
   wide deployment of unsecured time synchronization solutions.
   However, in some cases, security mechanisms may not be strictly
   necessary, e.g., due to other security practices in place or due to
   the architecture of the network.  A time synchronization security
   solution, much like any security solution, is comprised of various
   building blocks and must be carefully tailored for the specific
   system in which it is deployed.  Based on a system-specific threat
   assessment, the benefits of a security solution must be weighed
   against the potential risks, and based on this trade-off an optimal
   security solution can be selected.

   The target audience of this document includes:

   o  Timing and networking equipment vendors - can benefit from this
      document by deriving the security features that should be
      supported in the time/networking equipment.

   o  Standards development organizations - can use the requirements
      defined in this document when specifying security mechanisms for a
      time protocol.






<span class="grey">Mizrahi                       Informational                     [Page 4]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-5"></span>
<span class="grey"><a href="./rfc7384">RFC 7384</a>           Time Protocol Security Requirements      October 2014</span>


   o  Network operators - can use this document as a reference when
      designing a network and its security architecture.  As stated
      above, the requirements in this document may be deployed
      selectively based on a careful per-system threat analysis.

   This document attempts to add clarity to the time protocol security
   requirements discussion by addressing a series of questions:

   (1) What are the threats that need to be addressed for the time
       protocol and what security services need to be provided (e.g., a
       malicious NTP server or PTP master)?

   (2) What external security practices impact the security and
       performance of time keeping and what can be done to mitigate
       these impacts (e.g., an IPsec tunnel in the time protocol traffic
       path)?

   (3) What are the security impacts of time protocol practices (e.g.,
       on-the-fly modification of timestamps)?

   (4) What are the dependencies between other security services and
       time protocols?  (For example, which comes first - the
       certificate or the timestamp?)

   In light of the questions above, this document defines a set of
   requirements for security solutions for time protocols, focusing on
   PTP and NTP.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/2.%20%20Terminology"></a><a class="selflink" href="#section-2" id="section-2">2</a>.  Terminology</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/2.1.%20%20Requirements%20Language"></a><a class="selflink" href="#section-2.1" id="section-2.1">2.1</a>.  Requirements Language</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [<a href="#ref-KEYWORDS" title='"Key words for use in RFCs to Indicate Requirement Levels"'>KEYWORDS</a>].

   This document describes security requirements; thus, requirements are
   phrased in the document in the form "the security mechanism
   MUST/SHOULD/...".  Note that the phrasing does not imply that this
   document defines a specific security mechanism, but that it defines
   the requirements with which every security mechanism should comply.










<span class="grey">Mizrahi                       Informational                     [Page 5]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-6"></span>
<span class="grey"><a href="./rfc7384">RFC 7384</a>           Time Protocol Security Requirements      October 2014</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/2.2.%20%20Abbreviations"></a><a class="selflink" href="#section-2.2" id="section-2.2">2.2</a>.  Abbreviations</span>

   BC       Boundary Clock [<a href="#ref-IEEE1588" title='"1588-2008 - IEEE Standard for a Precision Clock Synchronization Protocol for Networked Measurement and Control Systems"'>IEEE1588</a>]

   BMCA     Best Master Clock Algorithm [<a href="#ref-IEEE1588" title='"1588-2008 - IEEE Standard for a Precision Clock Synchronization Protocol for Networked Measurement and Control Systems"'>IEEE1588</a>]

   DoS      Denial of Service

   MITM     Man in the Middle

   NTP      Network Time Protocol [<a href="#ref-NTPv4" title='"Network Time Protocol Version 4: Protocol and Algorithms Specification"'>NTPv4</a>]

   OC       Ordinary Clock [<a href="#ref-IEEE1588" title='"1588-2008 - IEEE Standard for a Precision Clock Synchronization Protocol for Networked Measurement and Control Systems"'>IEEE1588</a>]

   P2P TC   Peer-to-Peer Transparent Clock [<a href="#ref-IEEE1588" title='"1588-2008 - IEEE Standard for a Precision Clock Synchronization Protocol for Networked Measurement and Control Systems"'>IEEE1588</a>]

   PTP      Precision Time Protocol [<a href="#ref-IEEE1588" title='"1588-2008 - IEEE Standard for a Precision Clock Synchronization Protocol for Networked Measurement and Control Systems"'>IEEE1588</a>]

   TC       Transparent Clock [<a href="#ref-IEEE1588" title='"1588-2008 - IEEE Standard for a Precision Clock Synchronization Protocol for Networked Measurement and Control Systems"'>IEEE1588</a>]

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/2.3.%20%20Common%20Terminology%20for%20PTP%20and%20NTP"></a><a class="selflink" href="#section-2.3" id="section-2.3">2.3</a>.  Common Terminology for PTP and NTP</span>

   This document refers to both PTP and NTP.  For the sake of
   consistency, throughout the document the term "master" applies to
   both a PTP master and an NTP server.  Similarly, the term "slave"
   applies to both PTP slaves and NTP clients.  The term "protocol
   packets" refers generically to PTP and NTP messages.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/2.4.%20%20Terms%20Used%20in%20This%20Document"></a><a class="selflink" href="#section-2.4" id="section-2.4">2.4</a>.  Terms Used in This Document</span>

   o  Clock - A node participating in the protocol (either PTP or NTP).
      A clock can be a master, a slave, or an intermediate clock (see
      corresponding definitions below).

   o  Control packets - Packets used by the protocol to exchange
      information between clocks that is not strictly related to the
      time.  NTP uses NTP Control Messages.  PTP uses Announce,
      Signaling, and Management messages.

   o  End-to-end security - A security approach where secured packets
      sent from a source to a destination are not modified by
      intermediate nodes, allowing the destination to authenticate the
      source of the packets and to verify their integrity.  In the
      context of confidentiality, end-to-end encryption guarantees that
      intermediate nodes cannot eavesdrop to en route packets.  However,
      as discussed in <a href="#section-5">Section 5</a>, confidentiality is not a strict
      requirement in this document.




<span class="grey">Mizrahi                       Informational                     [Page 6]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-7"></span>
<span class="grey"><a href="./rfc7384">RFC 7384</a>           Time Protocol Security Requirements      October 2014</span>


   o  Grandmaster - A master that receives time information from a
      locally attached clock device and not through the network.  A
      grandmaster distributes its time to other clocks in the network.

   o  Hop-by-hop security - A security approach where secured packets
      sent from a source to a destination may be modified by
      intermediate nodes.  In this approach intermediate nodes share the
      encryption key with the source and destination, allowing them to
      re-encrypt or re-authenticate modified packets before relaying
      them to the destination.

   o  Intermediate clock - A clock that receives timing information from
      a master and sends timing information to other clocks.  In NTP,
      this term refers to an NTP server that is not a Stratum 1 server.
      In PTP, this term refers to a BC or a TC.

   o  Master - A clock that generates timing information to other clocks
      in the network.  In NTP, 'master' refers to an NTP server.  In
      PTP, 'master' refers to a master OC (aka grandmaster) or to a port
      of a BC that is in the master state.

   o  Protocol packets - Packets used by the time protocol.  The
      terminology used in this document distinguishes between time
      packets and control packets.

   o  Secured clock - A clock that supports a security mechanism that
      complies to the requirements in this document.

   o  Slave - A clock that receives timing information from a master.
      In NTP, 'slave' refers to an NTP client.  In PTP, 'slave' refers
      to a slave OC or to a port of a BC that is in the slave state.

   o  Time packets - Protocol packets carrying time information.

   o  Unsecured clock - A clock that does not support a security
      mechanism according to the requirements in this document.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.%20%20Security%20Threats"></a><a class="selflink" href="#section-3" id="section-3">3</a>.  Security Threats</span>

   This section discusses the possible attacker types and analyzes
   various attacks against time protocols.

   The literature is rich with security threats of time protocols, e.g.,
   [<a href="#ref-Traps" title='"Traps and pitfalls in secure clock synchronization"'>Traps</a>], [<a href="#ref-AutoKey" title='"Network Time Protocol Version 4: Autokey Specification"'>AutoKey</a>], [<a href="#ref-TimeSec" title='"Time synchronization security using IPsec and MACsec"'>TimeSec</a>], [<a href="#ref-SecPTP" title='"A Security Analysis of the Precise Time Protocol (Short Paper),"'>SecPTP</a>], and [<a href="#ref-SecSen" title='"Secure Time Synchronization in Sensor Networks"'>SecSen</a>].  The threat
   analysis in this document is mostly based on [<a href="#ref-TimeSec" title='"Time synchronization security using IPsec and MACsec"'>TimeSec</a>].






<span class="grey">Mizrahi                       Informational                     [Page 7]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-8"></span>
<span class="grey"><a href="./rfc7384">RFC 7384</a>           Time Protocol Security Requirements      October 2014</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.1.%20%20Threat%20Model"></a><a class="selflink" href="#section-3.1" id="section-3.1">3.1</a>.  Threat Model</span>

   A time protocol can be attacked by various types of attackers.

   The analysis in this document classifies attackers according to two
   criteria, as described in Sections <a href="#section-3.1.1">3.1.1</a> and <a href="#section-3.1.2">3.1.2</a>.

<span class="h4"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.1.1.%20%20Internal%20vs.%20External%20Attackers"></a><a class="selflink" href="#section-3.1.1" id="section-3.1.1">3.1.1</a>.  Internal vs. External Attackers</span>

   In the context of internal and external attackers, the underlying
   assumption is that the time protocol is secured by either an
   encryption mechanism, an authentication mechanism, or both.

   Internal attackers either have access to a trusted segment of the
   network or possess the encryption or authentication keys.  An
   internal attack can also be performed by exploiting vulnerabilities
   in devices; for example, by installing malware or obtaining
   credentials to reconfigure the device.  Thus, an internal attacker
   can maliciously tamper with legitimate traffic in the network as well
   as generate its own traffic and make it appear legitimate to its
   attacked nodes.

   Note that internal attacks are a special case of Byzantine failures,
   where a node in the system may fail in arbitrary ways; by crashing,
   by omitting messages, or by malicious behavior.  This document
   focuses on nodes that demonstrate malicious behavior.

   External attackers, on the other hand, do not have the keys and have
   access only to the encrypted or authenticated traffic.

   Obviously, in the absence of a security mechanism, there is no
   distinction between internal and external attackers, since all
   attackers are internal in practice.

<span class="h4"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.1.2.%20%20Man%20in%20the%20Middle%20%28MITM%29%20vs.%20Packet%20Injector"></a><a class="selflink" href="#section-3.1.2" id="section-3.1.2">3.1.2</a>.  Man in the Middle (MITM) vs. Packet Injector</span>

   MITM attackers are located in a position that allows interception and
   modification of in-flight protocol packets.  It is assumed that an
   MITM attacker has physical access to a segment of the network or has
   gained control of one of the nodes in the network.

   A traffic injector is not located in an MITM position, but can attack
   by generating protocol packets.  An injector can reside either within
   the attacked network or on an external network that is connected to
   the attacked network.  An injector can also potentially eavesdrop on
   protocol packets sent as multicast, record them, and replay them
   later.




<span class="grey">Mizrahi                       Informational                     [Page 8]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-9"></span>
<span class="grey"><a href="./rfc7384">RFC 7384</a>           Time Protocol Security Requirements      October 2014</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.2.%20%20Threat%20Analysis"></a><a class="selflink" href="#section-3.2" id="section-3.2">3.2</a>.  Threat Analysis</span>

<span class="h4"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.2.1.%20%20Packet%20Manipulation"></a><a class="selflink" href="#section-3.2.1" id="section-3.2.1">3.2.1</a>.  Packet Manipulation</span>

   A packet manipulation attack results when an MITM attacker receives
   timing protocol packets, alters them, and relays them to their
   destination, allowing the attacker to maliciously tamper with the
   protocol.  This can result in a situation where the time protocol is
   apparently operational but providing intentionally inaccurate
   information.

<span class="h4"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.2.2.%20%20Spoofing"></a><a class="selflink" href="#section-3.2.2" id="section-3.2.2">3.2.2</a>.  Spoofing</span>

   In spoofing, an injector masquerades as a legitimate node in the
   network by generating and transmitting protocol packets or control
   packets.  Two typical examples of spoofing attacks:

   o  An attacker can impersonate the master, allowing malicious
      distribution of false timing information.

   o  An attacker can impersonate a legitimate clock, a slave, or an
      intermediate clock, by sending malicious messages to the master,
      causing the master to respond to the legitimate clock with
      protocol packets that are based on the spoofed messages.
      Consequently, the delay computations of the legitimate clock are
      based on false information.

   As with packet manipulation, this attack can result in a situation
   where the time protocol is apparently operational but providing
   intentionally inaccurate information.

<span class="h4"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.2.3.%20%20Replay%20Attack"></a><a class="selflink" href="#section-3.2.3" id="section-3.2.3">3.2.3</a>.  Replay Attack</span>

   In a replay attack, an attacker records protocol packets and replays
   them at a later time without any modification.  This can also result
   in a situation where the time protocol is apparently operational but
   providing intentionally inaccurate information.

<span class="h4"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.2.4.%20%20Rogue%20Master%20Attack"></a><a class="selflink" href="#section-3.2.4" id="section-3.2.4">3.2.4</a>.  Rogue Master Attack</span>

   In a rogue master attack, an attacker causes other nodes in the
   network to believe it is a legitimate master.  As opposed to the
   spoofing attack, in the rogue master attack the attacker does not
   fake its identity, but rather manipulates the master election process
   using malicious control packets.  For example, in PTP, an attacker
   can manipulate the Best Master Clock Algorithm (BMCA) and cause other
   nodes in the network to believe it is the most eligible candidate to
   be a grandmaster.



<span class="grey">Mizrahi                       Informational                     [Page 9]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-10"></span>
<span class="grey"><a href="./rfc7384">RFC 7384</a>           Time Protocol Security Requirements      October 2014</span>


   In PTP, a possible variant of this attack is the rogue TC/BC attack.
   Similar to the rogue master attack, an attacker can cause victims to
   believe it is a legitimate TC or BC, allowing the attacker to
   manipulate the time information forwarded to the victims.

<span class="h4"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.2.5.%20%20Packet%20Interception%20and%20Removal"></a><a class="selflink" href="#section-3.2.5" id="section-3.2.5">3.2.5</a>.  Packet Interception and Removal</span>

   A packet interception and removal attack results when an MITM
   attacker intercepts and drops protocol packets, preventing the
   destination node from receiving some or all of the protocol packets.

<span class="h4"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.2.6.%20%20Packet%20Delay%20Manipulation"></a><a class="selflink" href="#section-3.2.6" id="section-3.2.6">3.2.6</a>.  Packet Delay Manipulation</span>

   In a packet delay manipulation scenario, an MITM attacker receives
   protocol packets and relays them to their destination after adding a
   maliciously computed delay.  The attacker can use various delay
   attack strategies; the added delay can be constant, jittered, or
   slowly wandering.  Each of these strategies has a different impact,
   but they all effectively manipulate the attacked clock.

   Note that the victim still receives one copy of each packet, contrary
   to the replay attack, where some or all of the packets may be
   received by the victim more than once.

<span class="h4"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.2.7.%20%20L2%2FL3%20DoS%20Attacks"></a><a class="selflink" href="#section-3.2.7" id="section-3.2.7">3.2.7</a>.  L2/L3 DoS Attacks</span>

   There are many possible Layer 2 and Layer 3 DoS attacks, e.g., IP
   spoofing, ARP spoofing [<a href="#ref-Hack" title='"Hacking Exposed: Network Security Secrets and Solutions"'>Hack</a>], MAC flooding [<a href="#ref-Anatomy" title='"Anatomy of an ARP Poisoning Attack"'>Anatomy</a>], and many
   others.  As the target's availability is compromised, the timing
   protocol is affected accordingly.

<span class="h4"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.2.8.%20%20Cryptographic%20Performance%20Attacks"></a><a class="selflink" href="#section-3.2.8" id="section-3.2.8">3.2.8</a>.  Cryptographic Performance Attacks</span>

   In cryptographic performance attacks, an attacker transmits fake
   protocol packets, causing high utilization of the cryptographic
   engine at the receiver, which attempts to verify the integrity of
   these fake packets.

   This DoS attack is applicable to all encryption and authentication
   protocols.  However, when the time protocol uses a dedicated security
   mechanism implemented in a dedicated cryptographic engine, this
   attack can be applied to cause DoS specifically to the time protocol.









<span class="grey">Mizrahi                       Informational                    [Page 10]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-11"></span>
<span class="grey"><a href="./rfc7384">RFC 7384</a>           Time Protocol Security Requirements      October 2014</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.2.9.%20%20DoS%20Attacks%20against%20the%20Time%20Protocol"></a><a class="selflink" href="#section-3.2.9" id="section-3.2.9">3.2.9</a>.  DoS Attacks against the Time Protocol</span>

   An attacker can attack a clock by sending an excessive number of time
   protocol packets, thus degrading the victim's performance.  This
   attack can be implemented, for example, using the attacks described
   in Sections <a href="#section-3.2.2">3.2.2</a> and <a href="#section-3.2.4">3.2.4</a>.

<span class="h4"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.2.10.%20%20Grandmaster%20Time%20Source%20Attack%20%28e.g.%2C%20GPS%20Fraud%29"></a><a class="selflink" href="#section-3.2.10" id="section-3.2.10">3.2.10</a>.  Grandmaster Time Source Attack (e.g., GPS Fraud)</span>

   Grandmasters receive their time from an external accurate time
   source, such as an atomic clock or a GPS clock, and then distribute
   this time to the slaves using the time protocol.

   Time source attacks are aimed at the accurate time source of the
   grandmaster.  For example, if the grandmaster uses a GPS-based clock
   as its reference source, an attacker can jam the reception of the GPS
   signal, or transmit a signal similar to one from a GPS satellite,
   causing the grandmaster to use a false reference time.

   Note that this attack is outside the scope of the time protocol.
   While various security measures can be taken to mitigate this attack,
   these measures are outside the scope of the security requirements
   defined in this document.

<span class="h4"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.2.11.%20%20Exploiting%20Vulnerabilities%20in%20the%20Time%20Protocol"></a><a class="selflink" href="#section-3.2.11" id="section-3.2.11">3.2.11</a>.  Exploiting Vulnerabilities in the Time Protocol</span>

   Time protocols can be attacked by exploiting vulnerabilities in the
   protocol, implementation bugs, or misconfigurations (e.g.,
   [<a href="#ref-NTPDDoS" title='"Attackers use NTP reflection in huge DDoS attack"'>NTPDDoS</a>]).  It should be noted that such attacks cannot typically be
   mitigated by security mechanisms.  However, when a new vulnerability
   is discovered, operators should react as soon as possible, and take
   the necessary measures to address it.

<span class="h4"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.2.12.%20%20Network%20Reconnaissance"></a><a class="selflink" href="#section-3.2.12" id="section-3.2.12">3.2.12</a>.  Network Reconnaissance</span>

   An attacker can exploit the time protocol to collect information such
   as addresses and locations of nodes that take part in the protocol.
   Reconnaissance can be applied by either passively eavesdropping on
   protocol packets or sending malicious packets and gathering
   information from the responses.  By eavesdropping on a time protocol,
   an attacker can learn the network latencies, which provide
   information about the network topology and node locations.

   Moreover, properties such as the frequency of the protocol packets,
   or the exact times at which they are sent, can allow fingerprinting
   of specific nodes; thus, protocol packets from a node can be
   identified even if network addresses are hidden or encrypted.




<span class="grey">Mizrahi                       Informational                    [Page 11]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-12"></span>
<span class="grey"><a href="./rfc7384">RFC 7384</a>           Time Protocol Security Requirements      October 2014</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.3.%20%20Threat%20Analysis%20Summary"></a><a class="selflink" href="#section-3.3" id="section-3.3">3.3</a>.  Threat Analysis Summary</span>

   The two key factors to a threat analysis are the impact and the
   likelihood of each of the analyzed attacks.

   Table 1 summarizes the security attacks presented in <a href="#section-3.2">Section 3.2</a>.
   For each attack, the table specifies its impact, and its
   applicability to each of the attacker types presented in <a href="#section-3.1">Section 3.1</a>.

   Table 1 clearly shows the distinction between external and internal
   attackers, and motivates the usage of authentication and integrity
   protection, significantly reducing the impact of external attackers.

   The Impact column provides an intuitive measure of the severity of
   each attack, and the relevant Attacker Type column provides an
   intuition about how difficult each attack is to implement and, hence,
   about the likelihood of each attack.

   The Impact column in Table 1 can have one of three values:

   o  DoS - the attack causes denial of service to the attacked node,
      the impact of which is not restricted to the time protocol.

   o  Accuracy degradation - the attack yields a degradation in the
      slave accuracy, but does not completely compromise the slaves'
      time and frequency.

   o  False time - slaves align to a false time or frequency value due
      to the attack.  Note that if the time protocol aligns to a false
      time, it may cause DoS to other applications that rely on accurate
      time.  However, for the purpose of the analysis in this section,
      we distinguish this implication from 'DoS', which refers to a DoS
      attack that is not necessarily aimed at the time protocol.  All
      attacks that have a '+' for 'False Time' implicitly have a '+' for
      'Accuracy Degradation'.  Note that 'False Time' necessarily
      implies 'Accuracy Degradation'.  However, two different terms are
      used, indicating two levels of severity.

   The Attacker Type column refers to the four possible combinations of
   the attacker types defined in <a href="#section-3.1">Section 3.1</a>.











<span class="grey">Mizrahi                       Informational                    [Page 12]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-13"></span>
<span class="grey"><a href="./rfc7384">RFC 7384</a>           Time Protocol Security Requirements      October 2014</span>


+-----------------------------+-------------------++-------------------+
| Attack                      |      Impact       ||   Attacker Type   |
|                             +-----+--------+----++---------+---------+
|                             |False|Accuracy|    ||Internal |External |
|                             |Time |Degrad. |DoS ||MITM|Inj.|MITM|Inj.|
+-----------------------------+-----+--------+----++----+----+----+----+
|Manipulation                 |  +  |        |    || +  |    |    |    |
+-----------------------------+-----+--------+----++----+----+----+----+
|Spoofing                     |  +  |        |    || +  | +  |    |    |
+-----------------------------+-----+--------+----++----+----+----+----+
|Replay attack                |  +  |        |    || +  | +  |    |    |
+-----------------------------+-----+--------+----++----+----+----+----+
|Rogue master attack          |  +  |        |    || +  | +  |    |    |
+-----------------------------+-----+--------+----++----+----+----+----+
|Interception and removal     |     |   +    | +  || +  |    | +  |    |
+-----------------------------+-----+--------+----++----+----+----+----+
|Packet delay manipulation    |  +  |        |    || +  |    | +  |    |
+-----------------------------+-----+--------+----++----+----+----+----+
|L2/L3 DoS attacks            |     |        | +  || +  | +  | +  | +  |
+-----------------------------+-----+--------+----++----+----+----+----+
|Crypt. performance attacks   |     |        | +  || +  | +  | +  | +  |
+-----------------------------+-----+--------+----++----+----+----+----+
|Time protocol DoS attacks    |     |        | +  || +  | +  |    |    |
+-----------------------------+-----+--------+----++----+----+----+----+
|Master time source attack    |  +  |        |    || +  | +  | +  | +  |
|(e.g., GPS spoofing)         |     |        |    ||    |    |    |    |
+-----------------------------+-----+--------+----++----+----+----+----+

                     Table 1: Threat Analysis - Summary

   The threats discussed in this section provide the background for the
   security requirements presented in <a href="#section-5">Section 5</a>.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/4.%20%20Requirement%20Levels"></a><a class="selflink" href="#section-4" id="section-4">4</a>.  Requirement Levels</span>

   The security requirements are presented in <a href="#section-5">Section 5</a>.  Each
   requirement is defined with a requirement level, in accordance with
   the requirement levels defined in <a href="#section-2.1">Section 2.1</a>.

   The requirement levels in this document are affected by the following
   factors:

   o  Impact:
      The possible impact of not implementing the requirement, as
      illustrated in the Impact column of Table 1.  For example, a
      requirement that addresses a threat that can be implemented by an
      external injector is typically a 'MUST', since the threat can be
      implemented by all the attacker types analyzed in <a href="#section-3.1">Section 3.1</a>.



<span class="grey">Mizrahi                       Informational                    [Page 13]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-14"></span>
<span class="grey"><a href="./rfc7384">RFC 7384</a>           Time Protocol Security Requirements      October 2014</span>


   o  Difficulty of the corresponding attack:
      The level of difficulty of the possible attacks that become
      possible by not implementing the requirement.  The level of
      difficulty is reflected in the Attacker Type column of Table 1.
      For example, a requirement that addresses a threat that only
      compromises the availability of the protocol is typically no more
      than a 'SHOULD'.

   o  Practical considerations:
      Various practical factors that may affect the requirement.  For
      example, if a requirement is very difficult to implement, or is
      applicable to very specific scenarios, these factors may reduce
      the requirement level.

   <a href="#section-5">Section 5</a> lists the requirements.  For each requirement, there is a
   short explanation detailing the reason for its requirement level.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.%20%20Security%20Requirements"></a><a class="selflink" href="#section-5" id="section-5">5</a>.  Security Requirements</span>

   This section defines a set of security requirements.  These
   requirements are phrased in the form "the security mechanism
   MUST/SHOULD/MAY...".  However, this document does not specify how
   these requirements can be met.  While these requirements can be
   satisfied by defining explicit security mechanisms for time
   protocols, at least a subset of the requirements can be met by
   applying common security practices to the network or by using
   existing security protocols, such as [<a href="#ref-IPsec" title='"Security Architecture for the Internet Protocol"'>IPsec</a>] or [<a href="#ref-MACsec" title='"IEEE Standard for Local and metropolitan area networks - Media Access Control (MAC) Security"'>MACsec</a>].  Thus,
   security solutions that address these requirements are outside the
   scope of this document.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.1.%20%20Clock%20Identity%20Authentication%20and%20Authorization"></a><a class="selflink" href="#section-5.1" id="section-5.1">5.1</a>.  Clock Identity Authentication and Authorization</span>

   Requirement

      The security mechanism MUST support authentication.

   Requirement

      The security mechanism MUST support authorization.

   Requirement Level

      The requirements in this subsection address the spoofing attack
      (<a href="#section-3.2.2">Section 3.2.2</a>) and the rogue master attack (<a href="#section-3.2.4">Section 3.2.4</a>).

      The requirement level of these requirements is 'MUST' since, in
      the absence of these requirements, the protocol is exposed to
      attacks that are easy to implement and have a high impact.



<span class="grey">Mizrahi                       Informational                    [Page 14]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-15"></span>
<span class="grey"><a href="./rfc7384">RFC 7384</a>           Time Protocol Security Requirements      October 2014</span>


   Discussion

      Authentication refers to verifying the identity of the peer clock.
      Authorization, on the other hand, refers to verifying that the
      peer clock is permitted to play the role that it plays in the
      protocol.  For example, some nodes may be permitted to be masters,
      while other nodes are only permitted to be slaves or TCs.

      Authentication is typically implemented by means of a
      cryptographic signature, allowing the verification of the identity
      of the sender.  Authorization requires clocks to maintain a list
      of authorized clocks, or a "black list" of clocks that should be
      denied service or revoked.

      It is noted that while the security mechanism is required to
      provide an authorization mechanism, the deployment of such a
      mechanism depends on the nature of the network.  For example, a
      network that deploys PTP may consist of a set of identical OCs,
      where all clocks are equally permitted to be a master.  In such a
      network, an authorization mechanism may not be necessary.

      The following subsections describe five distinct cases of clock
      authentication.

<span class="h4"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.1.1.%20%20Authentication%20and%20Authorization%20of%20Masters"></a><a class="selflink" href="#section-5.1.1" id="section-5.1.1">5.1.1</a>.  Authentication and Authorization of Masters</span>

   Requirement

      The security mechanism MUST support an authentication mechanism,
      allowing slaves to authenticate the identity of masters.

   Requirement

      The authentication mechanism MUST allow slaves to verify that the
      authenticated master is authorized to be a master.

   Requirement Level

      The requirements in this subsection address the spoofing attack
      (<a href="#section-3.2.2">Section 3.2.2</a>) and the rogue master attack (<a href="#section-3.2.4">Section 3.2.4</a>).

      The requirement level of these requirements is 'MUST' since, in
      the absence of these requirements, the protocol is exposed to
      attacks that are easy to implement and have a high impact.







<span class="grey">Mizrahi                       Informational                    [Page 15]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-16"></span>
<span class="grey"><a href="./rfc7384">RFC 7384</a>           Time Protocol Security Requirements      October 2014</span>


   Discussion

      Clocks authenticate masters in order to ensure the authenticity of
      the time source.  It is important for a slave to verify the
      identity of the master, as well as to verify that the master is
      indeed authorized to be a master.

<span class="h4"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.1.2.%20%20Recursive%20Authentication%20and%20Authorization%20of%20Masters%20%28Chain%20of"></a><a class="selflink" href="#section-5.1.2" id="section-5.1.2">5.1.2</a>.  Recursive Authentication and Authorization of Masters (Chain of</span>
<span class="h4"><a class="dashAnchor" name="//apple_ref/cpp/Section/Trust%29"></a>        Trust)</span>

   Requirement

      The security mechanism MUST support recursive authentication and
      authorization of the master, to be used in cases where time
      information is conveyed through intermediate clocks.

   Requirement Level

      The requirement in this subsection addresses the spoofing attack
      (<a href="#section-3.2.2">Section 3.2.2</a>) and the rogue master attack (<a href="#section-3.2.4">Section 3.2.4</a>).

      The requirement level of this requirement is 'MUST' since, in the
      absence of this requirement, the protocol is exposed to attacks
      that are easy to implement and have a high impact.

   Discussion

      In some cases, a slave is connected to an intermediate clock that
      is not the primary time source.  For example, in PTP, a slave can
      be connected to a Boundary Clock (BC) or a Transparent Clock (TC),
      which in turn is connected to a grandmaster.  A similar example in
      NTP is when a client is connected to a Stratum 2 server, which is
      connected to a Stratum 1 server.  In both the PTP and the NTP
      cases, the slave authenticates the intermediate clock, and the
      intermediate clock authenticates the grandmaster.  This recursive
      authentication process is referred to in [<a href="#ref-AutoKey" title='"Network Time Protocol Version 4: Autokey Specification"'>AutoKey</a>] as
      proventication.

      Specifically in PTP, this requirement implies that if a slave
      receives time information through a TC, it must authenticate the
      TC to which it is attached, as well as authenticate the master
      from which it receives the time information, as per <a href="#section-5.1.1">Section 5.1.1</a>.
      Similarly, if a TC receives time information through an attached
      TC, it must authenticate the attached TC.







<span class="grey">Mizrahi                       Informational                    [Page 16]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-17"></span>
<span class="grey"><a href="./rfc7384">RFC 7384</a>           Time Protocol Security Requirements      October 2014</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.1.3.%20%20Authentication%20and%20Authorization%20of%20Slaves"></a><a class="selflink" href="#section-5.1.3" id="section-5.1.3">5.1.3</a>.  Authentication and Authorization of Slaves</span>

   Requirement

      The security mechanism MAY provide a means for a master to
      authenticate its slaves.

   Requirement

      The security mechanism MAY provide a means for a master to verify
      that the sender of a protocol packet is authorized to send a
      packet of this type.

   Requirement Level

      The requirement in this subsection prevents DoS attacks against
      the master (<a href="#section-3.2.9">Section 3.2.9</a>).

      The requirement level of this requirement is 'MAY' since:

      o  Its impact is low, i.e., in the absence of this requirement the
         protocol is only exposed to DoS.

      o  Practical considerations: requiring an NTP server to
         authenticate its clients may significantly impose on the
         server's performance.

      Note that while the requirement level of this requirement is
      'MAY', the requirement in <a href="#section-5.1.1">Section 5.1.1</a> is 'MUST'; the security
      mechanism must provide a means for authentication and
      authorization, with an emphasis on the master.  Authentication and
      authorization of slaves are specified in this subsection as 'MAY'.

   Discussion

      Slaves and intermediate clocks are authenticated by masters in
      order to verify that they are authorized to receive timing
      services from the master.

      Authentication of slaves prevents unauthorized clocks from
      receiving time services.  Preventing the master from serving
      unauthorized clocks can help in mitigating DoS attacks against the
      master.  Note that the authentication of slaves might put a higher
      load on the master than serving the unauthorized clock; hence,
      this requirement is 'MAY'.






<span class="grey">Mizrahi                       Informational                    [Page 17]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-18"></span>
<span class="grey"><a href="./rfc7384">RFC 7384</a>           Time Protocol Security Requirements      October 2014</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.1.4.%20%20PTP%3A%20Authentication%20and%20Authorization%20of%20P2P%20TCs%20by%20the%20Master"></a><a class="selflink" href="#section-5.1.4" id="section-5.1.4">5.1.4</a>.  PTP: Authentication and Authorization of P2P TCs by the Master</span>

   Requirement

      The security mechanism for PTP MAY provide a means for a master to
      authenticate the identity of the P2P TCs directly connected to it.

   Requirement

      The security mechanism for PTP MAY provide a means for a master to
      verify that P2P TCs directly connected to it are authorized to be
      TCs.

   Requirement Level

      The requirement in this subsection prevents DoS attacks against
      the master (<a href="#section-3.2.9">Section 3.2.9</a>).

      The requirement level of this requirement is 'MAY' for the same
      reasons specified in <a href="#section-5.1.3">Section 5.1.3</a>.

   Discussion

      P2P TCs that are one hop from the master use the PDelay_Req and
      PDelay_Resp handshake to compute the link delay between the master
      and TC.  These TCs are authenticated by the master.

      Authentication of TCs, much like authentication of slaves, reduces
      unnecessary load on the master and peer TCs, by preventing the
      master from serving unauthorized clocks.

<span class="h4"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.1.5.%20%20PTP%3A%20Authentication%20and%20Authorization%20of%20Control%20Messages"></a><a class="selflink" href="#section-5.1.5" id="section-5.1.5">5.1.5</a>.  PTP: Authentication and Authorization of Control Messages</span>

   Requirement

      The security mechanism for PTP MUST support authentication of
      Announce messages.  The authentication mechanism MUST also verify
      that the sender is authorized to be a master.

   Requirement

      The security mechanism for PTP MUST support authentication and
      authorization of Management messages.

   Requirement

      The security mechanism MAY support authentication and
      authorization of Signaling messages.



<span class="grey">Mizrahi                       Informational                    [Page 18]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-19"></span>
<span class="grey"><a href="./rfc7384">RFC 7384</a>           Time Protocol Security Requirements      October 2014</span>


   Requirement Level

      The requirements in this subsection address the spoofing attack
      (<a href="#section-3.2.2">Section 3.2.2</a>) and the rogue master attack (<a href="#section-3.2.4">Section 3.2.4</a>).

      The requirement level of the first two requirements is 'MUST'
      since, in the absence of these requirements, the protocol is
      exposed to attacks that are easy to implement and have a high
      impact.

      The requirement level of the third requirement is 'MAY' since its
      impact greatly depends on the application for which the Signaling
      messages are used.

   Discussion

      Master election is performed in PTP using the Best Master Clock
      Algorithm (BMCA).  Each Ordinary Clock (OC) announces its clock
      attributes using Announce messages, and the best master is elected
      based on the information gathered from all the candidates.
      Announce messages must be authenticated in order to prevent rogue
      master attacks (<a href="#section-3.2.4">Section 3.2.4</a>).  Note that this subsection
      specifies a requirement that is not necessarily included in
      Sections <a href="#section-5.1.1">5.1.1</a> or <a href="#section-5.1.3">5.1.3</a>, since the BMCA is initiated before clocks
      have been defined as masters or slaves.

      Management messages are used to monitor or configure PTP clocks.
      Malicious usage of Management messages enables various attacks,
      such as the rogue master attack or DoS attack.

      Signaling messages are used by PTP clocks to exchange information
      that is not strictly related to time information or to master
      selection, such as unicast negotiation.  Authentication and
      authorization of Signaling messages may be required in some
      systems, depending on the application for which these messages are
      used.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.2.%20%20Protocol%20Packet%20Integrity"></a><a class="selflink" href="#section-5.2" id="section-5.2">5.2</a>.  Protocol Packet Integrity</span>

   Requirement

      The security mechanism MUST protect the integrity of protocol
      packets.








<span class="grey">Mizrahi                       Informational                    [Page 19]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-20"></span>
<span class="grey"><a href="./rfc7384">RFC 7384</a>           Time Protocol Security Requirements      October 2014</span>


   Requirement Level

      The requirement in this subsection addresses the packet
      manipulation attack (<a href="#section-3.2.1">Section 3.2.1</a>).

      The requirement level of this requirement is 'MUST' since, in the
      absence of this requirement, the protocol is exposed to attacks
      that are easy to implement and have high impact.

   Discussion

      While <a href="#section-5.1">Section 5.1</a> refers to ensuring the identity an authorization
      of the source of a protocol packet, this subsection refers to
      ensuring that the packet arrived intact.  The integrity protection
      mechanism ensures the authenticity and completeness of data from
      the data originator.

      Integrity protection is typically implemented by means of an
      Integrity Check Value (ICV) that is included in protocol packets
      and is verified by the receiver.

<span class="h4"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.2.1.%20%20PTP%3A%20Hop-by-Hop%20vs.%20End-to-End%20Integrity%20Protection"></a><a class="selflink" href="#section-5.2.1" id="section-5.2.1">5.2.1</a>.  PTP: Hop-by-Hop vs. End-to-End Integrity Protection</span>

   Specifically in PTP, when protocol packets are subject to
   modification by TCs, the integrity protection can be enforced in one
   of two approaches: end-to-end or hop-by-hop.

<span class="h5"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.2.1.1.%20%20Hop-by-Hop%20Integrity%20Protection"></a><a class="selflink" href="#section-5.2.1.1" id="section-5.2.1.1">5.2.1.1</a>.  Hop-by-Hop Integrity Protection</span>

   Each hop that needs to modify a protocol packet:

   o  Verifies its integrity.

   o  Modifies the packet, i.e., modifies the correctionField.  Note:
      TCs improve the end-to-end accuracy by updating a correctionField
      (Clause 6.5 in [<a href="#ref-IEEE1588" title='"1588-2008 - IEEE Standard for a Precision Clock Synchronization Protocol for Networked Measurement and Control Systems"'>IEEE1588</a>]) in the PTP packet by adding the latency
      caused by the current TC.

   o  Re-generates the integrity protection, e.g., re-computes a Message
      Authentication Code (MAC).

   In the hop-by-hop approach, the integrity of protocol packets is
   protected by induction on the path from the originator to the
   receiver.

   This approach is simple, but allows rogue TCs to modify protocol
   packets.




<span class="grey">Mizrahi                       Informational                    [Page 20]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-21"></span>
<span class="grey"><a href="./rfc7384">RFC 7384</a>           Time Protocol Security Requirements      October 2014</span>


<span class="h5"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.2.1.2.%20%20End-to-End%20Integrity%20Protection"></a><a class="selflink" href="#section-5.2.1.2" id="section-5.2.1.2">5.2.1.2</a>.  End-to-End Integrity Protection</span>

   In this approach, the integrity protection is maintained on the path
   from the originator of a protocol packet to the receiver.  This
   allows the receiver to directly validate the protocol packet without
   the ability of intermediate TCs to manipulate the packet.

   Since TCs need to modify the correctionField, a separate integrity
   protection mechanism is used specifically for the correctionField.

   The end-to-end approach limits the TC's impact to the correctionField
   alone, while the rest of the protocol packet is protected on an end-
   to-end basis.  It should be noted that this approach is more
   difficult to implement than the hop-by-hop approach, as it requires
   the correctionField to be protected separately from the other fields
   of the packet, possibly using different cryptographic mechanisms and
   keys.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.3.%20%20Spoofing%20Prevention"></a><a class="selflink" href="#section-5.3" id="section-5.3">5.3</a>.  Spoofing Prevention</span>

   Requirement

      The security mechanism MUST provide a means to prevent master
      spoofing.

   Requirement

      The security mechanism MUST provide a means to prevent slave
      spoofing.

   Requirement

      PTP: The security mechanism MUST provide a means to prevent P2P TC
      spoofing.

   Requirement Level

      The requirements in this subsection address spoofing attacks.  As
      described in <a href="#section-3.2.2">Section 3.2.2</a>, when these requirements are not met,
      the attack may have a high impact, causing slaves to rely on false
      time information.  Thus, the requirement level is 'MUST'.

   Discussion

      Spoofing attacks may take various forms, and they can potentially
      cause significant impact.  In a master spoofing attack, the
      attacker causes slaves to receive false information about the
      current time by masquerading as the master.



<span class="grey">Mizrahi                       Informational                    [Page 21]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-22"></span>
<span class="grey"><a href="./rfc7384">RFC 7384</a>           Time Protocol Security Requirements      October 2014</span>


      By spoofing a slave or an intermediate node (the second example of
      <a href="#section-3.2.2">Section 3.2.2</a>), an attacker can tamper with the slaves' delay
      computations.  These attacks can be mitigated by an authentication
      mechanism (Sections <a href="#section-5.1.3">5.1.3</a> and <a href="#section-5.1.4">5.1.4</a>) or by other means, for
      example, a PTP Delay_Req can include a MAC that is included in the
      corresponding Delay_Resp message, allowing the slave to verify
      that the Delay_Resp was not sent in response to a spoofed message.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.4.%20%20Availability"></a><a class="selflink" href="#section-5.4" id="section-5.4">5.4</a>.  Availability</span>

   Requirement

      The security mechanism SHOULD include measures to mitigate DoS
      attacks against the time protocol.

   Requirement Level

      The requirement in this subsection prevents DoS attacks against
      the protocol (<a href="#section-3.2.9">Section 3.2.9</a>).

      The requirement level of this requirement is 'SHOULD' due to its
      low impact, i.e., in the absence of this requirement the protocol
      is only exposed to DoS.

   Discussion

      The protocol availability can be compromised by several different
      attacks.  An attacker can inject protocol packets to implement the
      spoofing attack (<a href="#section-3.2.2">Section 3.2.2</a>) or the rogue master attack
      (<a href="#section-3.2.4">Section 3.2.4</a>), causing DoS to the victim (<a href="#section-3.2.9">Section 3.2.9</a>).

      An authentication mechanism (<a href="#section-5.1">Section 5.1</a>) limits these attacks
      strictly to internal attackers; thus, it prevents external
      attackers from performing them.  Hence, the requirements of
      <a href="#section-5.1">Section 5.1</a> can be used to mitigate this attack.  Note that
      <a href="#section-5.1">Section 5.1</a> addresses a wider range of threats, whereas the
      current section is focused on availability.

      The DoS attacks described in <a href="#section-3.2.7">Section 3.2.7</a> are performed at lower
      layers than the time protocol layer, and they are thus outside the
      scope of the security requirements defined in this document.










<span class="grey">Mizrahi                       Informational                    [Page 22]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-23"></span>
<span class="grey"><a href="./rfc7384">RFC 7384</a>           Time Protocol Security Requirements      October 2014</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.5.%20%20Replay%20Protection"></a><a class="selflink" href="#section-5.5" id="section-5.5">5.5</a>.  Replay Protection</span>

   Requirement

      The security mechanism MUST include a replay prevention mechanism.

   Requirement Level

      The requirement in this subsection prevents replay attacks
      (<a href="#section-3.2.3">Section 3.2.3</a>).

      The requirement level of this requirement is 'MUST' since, in the
      absence of this requirement, the protocol is exposed to attacks
      that are easy to implement and have a high impact.

   Discussion

      The replay attack (<a href="#section-3.2.3">Section 3.2.3</a>) can compromise both the
      integrity and availability of the protocol.  Common encryption and
      authentication mechanisms include replay prevention mechanisms
      that typically use a monotonously increasing packet sequence
      number.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.6.%20%20Cryptographic%20Keys%20and%20Security%20Associations"></a><a class="selflink" href="#section-5.6" id="section-5.6">5.6</a>.  Cryptographic Keys and Security Associations</span>

<span class="h4"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.6.1.%20%20Key%20Freshness"></a><a class="selflink" href="#section-5.6.1" id="section-5.6.1">5.6.1</a>.  Key Freshness</span>

   Requirement

      The security mechanism MUST provide a means to refresh the
      cryptographic keys.

      The cryptographic keys MUST be refreshed frequently.

   Requirement Level

      The requirement level of this requirement is 'MUST' since key
      freshness is an essential property for cryptographic algorithms,
      as discussed below.

   Discussion

      Key freshness guarantees that both sides share a common updated
      secret key.  It also helps in preventing replay attacks.  Thus, it
      is important for keys to be refreshed frequently.  Note that the
      term 'frequently' is used without a quantitative requirement, as
      the precise frequency requirement should be considered on a per-
      system basis, based on the threats and system requirements.



<span class="grey">Mizrahi                       Informational                    [Page 23]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-24"></span>
<span class="grey"><a href="./rfc7384">RFC 7384</a>           Time Protocol Security Requirements      October 2014</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.6.2.%20%20Security%20Association"></a><a class="selflink" href="#section-5.6.2" id="section-5.6.2">5.6.2</a>.  Security Association</span>

   Requirement

      The security protocol SHOULD support a security association
      protocol where:

         o  Two or more clocks authenticate each other.

         o  The clocks generate and agree on a cryptographic session
            key.

   Requirement

      Each instance of the association protocol SHOULD produce a
      different session key.

   Requirement Level

      The requirement level of this requirement is 'SHOULD' since it may
      be expensive in terms of performance, especially in low-cost
      clocks.

   Discussion

      The security requirements in Sections <a href="#section-5.1">5.1</a> and <a href="#section-5.2">5.2</a> require usage of
      cryptographic mechanisms, deploying cryptographic keys.  A
      security association (e.g., [<a href="#ref-IPsec" title='"Security Architecture for the Internet Protocol"'>IPsec</a>]) is an important building
      block in these mechanisms.

      It should be noted that in some cases, different security
      association mechanisms may be used at different levels of clock
      hierarchies.  For example, the association between a Stratum 2
      clock and a Stratum 3 clock in NTP may have different
      characteristics than an association between two clocks at the same
      stratum level.  On a related note, in some cases, a hybrid
      solution may be used, where a subset of the network is not secured
      at all (see <a href="#section-5.10.2">Section 5.10.2</a>).

<span class="h4"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.6.3.%20%20Unicast%20and%20Multicast%20Associations"></a><a class="selflink" href="#section-5.6.3" id="section-5.6.3">5.6.3</a>.  Unicast and Multicast Associations</span>

   Requirement

      The security mechanism SHOULD support security association
      protocols for unicast and for multicast associations.






<span class="grey">Mizrahi                       Informational                    [Page 24]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-25"></span>
<span class="grey"><a href="./rfc7384">RFC 7384</a>           Time Protocol Security Requirements      October 2014</span>


   Requirement Level

      The requirement level of this requirement is 'SHOULD' since it may
      be expensive in terms of performance, especially for low-cost
      clocks.

   Discussion

      A unicast protocol requires an association protocol between two
      clocks, whereas a multicast protocol requires an association
      protocol among two or more clocks, where one of the clocks is a
      master.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.7.%20%20Performance"></a><a class="selflink" href="#section-5.7" id="section-5.7">5.7</a>.  Performance</span>

   Requirement

      The security mechanism MUST be designed in such a way that it does
      not significantly degrade the quality of the time transfer.

   Requirement

      The mechanism SHOULD minimize computational load.

   Requirement

      The mechanism SHOULD minimize storage requirements of client state
      in the master.

   Requirement

      The mechanism SHOULD minimize the bandwidth overhead required by
      the security protocol.

   Requirement Level

      While the quality of the time transfer is clearly a 'MUST', the
      other three performance requirements are 'SHOULD', since some
      systems may be more sensitive to resource consumption than others;
      hence, these requirements should be considered on a per-system
      basis.

   Discussion

      Performance efficiency is important since client restrictions
      often dictate a low processing and memory footprint and because
      the server may have extensive fan-out.




<span class="grey">Mizrahi                       Informational                    [Page 25]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-26"></span>
<span class="grey"><a href="./rfc7384">RFC 7384</a>           Time Protocol Security Requirements      October 2014</span>


      Note that the performance requirements refer to a time-protocol-
      specific security mechanism.  In systems where a security protocol
      is used for other types of traffic as well, this document does not
      place any performance requirements on the security protocol
      performance.  For example, if IPsec encryption is used for
      securing all information between the master and slave node,
      including information that is not part of the time protocol, the
      requirements in this subsection are not necessarily applicable.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.8.%20%20Confidentiality"></a><a class="selflink" href="#section-5.8" id="section-5.8">5.8</a>.  Confidentiality</span>

   Requirement

      The security mechanism MAY provide confidentiality protection of
      the protocol packets.

   Requirement Level

      The requirement level of this requirement is 'MAY' since the
      absence of this requirement does not expose the protocol to severe
      threats, as discussed below.

   Discussion

      In the context of time protocols, confidentiality is typically of
      low importance, since timing information is usually not considered
      secret information.

      Confidentiality can play an important role when service providers
      charge their customers for time synchronization services; thus, an
      encryption mechanism can prevent eavesdroppers from obtaining the
      service without payment.  Note that these cases are, for now,
      rather esoteric.

      Confidentiality can also prevent an MITM attacker from identifying
      protocol packets.  Thus, confidentiality can assist in protecting
      the timing protocol against MITM attacks such as packet delay
      (<a href="#section-3.2.6">Section 3.2.6</a>), manipulation and interception, and removal
      attacks.  Note that time protocols have predictable behavior even
      after encryption, such as packet transmission rates and packet
      lengths.  Additional measures can be taken to mitigate encrypted
      traffic analysis by random padding of encrypted packets and by
      adding random dummy packets.  Nevertheless, encryption does not
      prevent such MITM attacks, but rather makes these attacks more
      difficult to implement.






<span class="grey">Mizrahi                       Informational                    [Page 26]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-27"></span>
<span class="grey"><a href="./rfc7384">RFC 7384</a>           Time Protocol Security Requirements      October 2014</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.9.%20%20Protection%20against%20Packet%20Delay%20and%20Interception%20Attacks"></a><a class="selflink" href="#section-5.9" id="section-5.9">5.9</a>.  Protection against Packet Delay and Interception Attacks</span>

   Requirement

      The security mechanism MUST include means to protect the protocol
      from MITM attacks that degrade the clock accuracy.

   Requirement Level

      The requirements in this subsection address MITM attacks such as
      the packet delay attack (<a href="#section-3.2.6">Section 3.2.6</a>) and packet interception
      attacks (Sections <a href="#section-3.2.5">3.2.5</a> and <a href="#section-3.2.1">3.2.1</a>).

      The requirement level of this requirement is 'MUST'.  In the
      absence of this requirement, the protocol is exposed to attacks
      that are easy to implement and have a high impact.  Note that in
      the absence of this requirement, the impact is similar to packet
      manipulation attacks (<a href="#section-3.2.1">Section 3.2.1</a>); thus, this requirement has
      the same requirement level as integrity protection (<a href="#section-5.2">Section 5.2</a>).

      It is noted that the implementation of this requirement depends on
      the topology and properties of the system.

   Discussion

      While this document does not define specific security solutions,
      we note that common practices for protection against MITM attacks
      use redundant masters (e.g., [<a href="#ref-NTPv4" title='"Network Time Protocol Version 4: Protocol and Algorithms Specification"'>NTPv4</a>]) or redundant paths between
      the master and slave (e.g., [<a href="#ref-DelayAtt" title='"A game theoretic analysis of delay attacks against time synchronization protocols"'>DelayAtt</a>]).  If one of the time
      sources indicates a time value that is significantly different
      than the other sources, it is assumed to be erroneous or under
      attack and is therefore ignored.

      Thus, MITM attack prevention derives a requirement from the
      security mechanism and a requirement from the network topology.
      While the security mechanism should support the ability to detect
      delay attacks, it is noted that in some networks it is not
      possible to provide the redundancy needed for such a detection
      mechanism.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.10.%20%20Combining%20Secured%20with%20Unsecured%20Nodes"></a><a class="selflink" href="#section-5.10" id="section-5.10">5.10</a>.  Combining Secured with Unsecured Nodes</span>

   Integrating a security mechanism into a time-synchronized system is a
   complex and expensive process, and hence in some cases may require
   incremental deployment, where new equipment supports the security
   mechanism, and is required to interoperate with legacy equipment
   without the security features.




<span class="grey">Mizrahi                       Informational                    [Page 27]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-28"></span>
<span class="grey"><a href="./rfc7384">RFC 7384</a>           Time Protocol Security Requirements      October 2014</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.10.1.%20%20Secure%20Mode"></a><a class="selflink" href="#section-5.10.1" id="section-5.10.1">5.10.1</a>.  Secure Mode</span>

   Requirement

      The security mechanism MUST support a secure mode, where only
      secured clocks are permitted to take part in the time protocol.
      In this mode every protocol packet received from an unsecured
      clock MUST be discarded.

   Requirement Level

      The requirement level of this requirement is 'MUST' since the full
      capacity of the security requirements defined in this document can
      only be achieved in secure mode.

   Discussion

      While the requirement in this subsection is similar to the one in
      <a href="#section-5.1">Section 5.1</a>, it refers to the secure mode, as opposed to the
      hybrid mode presented in the next subsection.

<span class="h4"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.10.2.%20%20Hybrid%20Mode"></a><a class="selflink" href="#section-5.10.2" id="section-5.10.2">5.10.2</a>.  Hybrid Mode</span>

   Requirement

      The security protocol SHOULD support a hybrid mode, where both
      secured and unsecured clocks are permitted to take part in the
      protocol.

   Requirement Level

      The requirement level of this requirement is 'SHOULD'; on one
      hand, hybrid mode enables a gradual transition from unsecured to
      secured mode, which is especially important in large-scaled
      deployments.  On the other hand, hybrid mode is not required in
      all systems; this document recommends deployment of the 'secure
      mode' described in <a href="#section-5.10.1">Section 5.10.1</a>, where possible.

   Discussion

      The hybrid mode allows both secured and unsecured clocks to take
      part in the time protocol.  NTP, for example, allows a mixture of
      secured and unsecured nodes.

   Requirement

      A master in the hybrid mode SHOULD be a secured clock.




<span class="grey">Mizrahi                       Informational                    [Page 28]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-29"></span>
<span class="grey"><a href="./rfc7384">RFC 7384</a>           Time Protocol Security Requirements      October 2014</span>


      A secured slave in the hybrid mode SHOULD discard all protocol
      packets received from unsecured clocks.

   Requirement Level

      The requirement level of this requirement is 'SHOULD' since it may
      not be applicable to all deployments.  For example, a hybrid
      network may require the usage of unsecured masters or TCs.

   Discussion

      This requirement ensures that the existence of unsecured clocks
      does not compromise the security provided to secured clocks.
      Hence, secured slaves only "trust" protocol packets received from
      a secured clock.

      An unsecured slave can receive protocol packets from either
      unsecured clocks or secured clocks.  Note that the latter does not
      apply when encryption is used.  When integrity protection is used,
      the unsecured slave can receive secured packets ignoring the
      integrity protection.

      Note that the security scheme in [<a href="#ref-NTPv4" title='"Network Time Protocol Version 4: Protocol and Algorithms Specification"'>NTPv4</a>] with [<a href="#ref-AutoKey" title='"Network Time Protocol Version 4: Autokey Specification"'>AutoKey</a>] does not
      satisfy this requirement, since nodes prefer the server with the
      most accurate clock, which is not necessarily the server that
      supports authentication.  For example, a Stratum 2 server is
      connected to two Stratum 1 servers: Server A, supporting
      authentication, and Server B, without authentication.  If Server B
      has a more accurate clock than A, the Stratum 2 server chooses
      Server B, in spite of the fact it does not support authentication.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/6.%20%20Summary%20of%20Requirements"></a><a class="selflink" href="#section-6" id="section-6">6</a>.  Summary of Requirements</span>

   +-----------+---------------------------------------------+--------+
   | Section   | Requirement                                 | Type   |
   +-----------+---------------------------------------------+--------+
   | 5.1       | Authentication &amp; authorization of sender    | MUST   |
   |           +---------------------------------------------+--------+
   |           | Authentication &amp; authorization of master    | MUST   |
   |           +---------------------------------------------+--------+
   |           | Recursive authentication &amp; authorization    | MUST   |
   |           +---------------------------------------------+--------+
   |           | Authentication &amp; authorization of slaves    | MAY    |
   |           +---------------------------------------------+--------+
   |           | PTP: Authentication &amp; authorization of      | MAY    |
   |           | P2P TCs by master                           |        |
   +-----------+---------------------------------------------+--------+




<span class="grey">Mizrahi                       Informational                    [Page 29]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-30"></span>
<span class="grey"><a href="./rfc7384">RFC 7384</a>           Time Protocol Security Requirements      October 2014</span>


   +-----------+---------------------------------------------+--------+
   |5.1 (cont) | PTP: Authentication &amp; authorization of      | MUST   |
   |           | Announce messages                           |        |
   |           +---------------------------------------------+--------+
   |           | PTP: Authentication &amp; authorization of      | MUST   |
   |           | Management messages                         |        |
   |           +---------------------------------------------+--------+
   |           | PTP: Authentication &amp; authorization of      | MAY    |
   |           | Signaling messages                          |        |
   +-----------+---------------------------------------------+--------+
   | 5.2       | Integrity protection                        | MUST   |
   +-----------+---------------------------------------------+--------+
   | 5.3       | Spoofing prevention                         | MUST   |
   +-----------+---------------------------------------------+--------+
   | 5.4       | Protection from DoS attacks against the     | SHOULD |
   |           | time protocol                               |        |
   +-----------+---------------------------------------------+--------+
   | 5.5       | Replay protection                           | MUST   |
   +-----------+---------------------------------------------+--------+
   | 5.6       | Key freshness                               | MUST   |
   |           +---------------------------------------------+--------+
   |           | Security association                        | SHOULD |
   |           +---------------------------------------------+--------+
   |           | Unicast and multicast associations          | SHOULD |
   +-----------+---------------------------------------------+--------+
   | 5.7       | Performance: no degradation in quality of   | MUST   |
   |           | time transfer                               |        |
   |           +---------------------------------------------+--------+
   |           | Performance: computation load               | SHOULD |
   |           +---------------------------------------------+--------+
   |           | Performance: storage                        | SHOULD |
   |           +---------------------------------------------+--------+
   |           | Performance: bandwidth                      | SHOULD |
   +-----------+---------------------------------------------+--------+
   | 5.8       | Confidentiality protection                  | MAY    |
   +-----------+---------------------------------------------+--------+
   | 5.9       | Protection against delay and interception   | MUST   |
   |           | attacks                                     |        |
   +-----------+---------------------------------------------+--------+
   | 5.10      | Secure mode                                 | MUST   |
   |           +---------------------------------------------+--------+
   |           | Hybrid mode                                 | SHOULD |
   +-----------+---------------------------------------------+--------+

                 Table 2: Summary of Security Requirements






<span class="grey">Mizrahi                       Informational                    [Page 30]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-31"></span>
<span class="grey"><a href="./rfc7384">RFC 7384</a>           Time Protocol Security Requirements      October 2014</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/7.%20%20Additional%20Security%20Implications"></a><a class="selflink" href="#section-7" id="section-7">7</a>.  Additional Security Implications</span>

   This section discusses additional implications of the interaction
   between time protocols and security mechanisms.

   This section refers to time protocol security mechanisms, as well as
   to "external" security mechanisms, i.e., security mechanisms that are
   not strictly related to the time protocol.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/7.1.%20%20Security%20and%20On-the-Fly%20Timestamping"></a><a class="selflink" href="#section-7.1" id="section-7.1">7.1</a>.  Security and On-the-Fly Timestamping</span>

   Time protocols often require that protocol packets be modified during
   transmission.  Both NTP and PTP in one-step mode require clocks to
   modify protocol packets based on the time of transmission and/or
   reception.

   In the presence of a security mechanism, whether encryption or
   integrity protection:

   o  During transmission the encryption and/or integrity protection
      MUST be applied after integrating the timestamp into the packet.

   To allow high accuracy, timestamping is typically performed as close
   to the transmission or reception time as possible.  However, since
   the security engine must be placed between the timestamping function
   and the physical interface, it may introduce non-deterministic
   latency that causes accuracy degradation.  These performance aspects
   have been analyzed in literature, e.g., [<a href="#ref-1588IPsec" title='"Securing IEEE 1588 by IPsec tunnels - An analysis"'>1588IPsec</a>] and [<a href="#ref-Tunnel" title='"Secure tunneling of high-precision clock synchronisation protocols and other time-stamped data"'>Tunnel</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/7.2.%20%20PTP%3A%20Security%20and%20Two-Step%20Timestamping"></a><a class="selflink" href="#section-7.2" id="section-7.2">7.2</a>.  PTP: Security and Two-Step Timestamping</span>

   PTP supports a two-step mode of operation, where the time of
   transmission of protocol packets is communicated without modifying
   the packets.  As opposed to one-step mode, two-step timestamping can
   be performed without the requirement to encrypt after timestamping.

   Note that if an encryption mechanism such as IPsec is used, it
   presents a challenge to the timestamping mechanism, since time
   protocol packets are encrypted when traversing the physical
   interface, and are thus impossible to identify.  A possible solution
   to this problem [<a href="#ref-IPsecSync" title='"IPsec security for packet based synchronization"'>IPsecSync</a>] is to include an indication in the
   encryption header that identifies time protocol packets.









<span class="grey">Mizrahi                       Informational                    [Page 31]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-32"></span>
<span class="grey"><a href="./rfc7384">RFC 7384</a>           Time Protocol Security Requirements      October 2014</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/7.3.%20%20Intermediate%20Clocks"></a><a class="selflink" href="#section-7.3" id="section-7.3">7.3</a>.  Intermediate Clocks</span>

   A time protocol allows slaves to receive time information from an
   accurate time source.  Time information is sent over a path that
   often traverses one or more intermediate clocks.

   o  In NTP, time information originated from a Stratum 1 server can be
      distributed to Stratum 2 servers and, in turn, distributed from
      the Stratum 2 servers to NTP clients.  In this case, the Stratum 2
      servers are a layer of intermediate clocks.  These intermediate
      clocks are referred to as "secondary servers" in [<a href="#ref-NTPv4" title='"Network Time Protocol Version 4: Protocol and Algorithms Specification"'>NTPv4</a>].

   o  In PTP, BCs and TCs are intermediate nodes used to improve the
      accuracy of time information conveyed between the grandmaster and
      the slaves.

   A common rule of thumb in network security is that end-to-end
   security is the best policy, as it secures the entire path between
   the data originator and its receiver.  The usage of intermediate
   nodes implies that if a security mechanism is deployed in the
   network, a hop-by-hop security scheme must be used, since
   intermediate nodes must be able to send time information to the
   slaves, or to modify time information sent through them.

   This inherent property of using intermediate clocks increases the
   system's exposure to internal threats, as a large number of nodes
   possess the security keys.

   Thus, there is a trade-off between the achievable clock accuracy of a
   system, and the robustness of its security solution.  On one hand,
   high clock accuracy calls for hop-by-hop involvement in the protocol,
   also known as on-path support.  On the other hand, a robust security
   solution calls for end-to-end data protection.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/7.4.%20%20External%20Security%20Protocols%20and%20Time%20Protocols"></a><a class="selflink" href="#section-7.4" id="section-7.4">7.4</a>.  External Security Protocols and Time Protocols</span>

   Time protocols are often deployed in systems that use security
   mechanisms and protocols.

   A typical example is the 3GPP Femtocell network [<a href="#ref-3GPP" title='"Security of Home Node B (HNB) / Home evolved Node B (HeNB)"'>3GPP</a>], where IPsec
   is used for securing traffic between a Femtocell and the Femto
   Gateway.  In some cases, all traffic between these two nodes may be
   secured by IPsec, including the time protocol traffic.  This use-case
   is thoroughly discussed in [<a href="#ref-IPsecSync" title='"IPsec security for packet based synchronization"'>IPsecSync</a>].

   Another typical example is the usage of MACsec encryption ([<a href="#ref-MACsec" title='"IEEE Standard for Local and metropolitan area networks - Media Access Control (MAC) Security"'>MACsec</a>])
   in L2 networks that deploy time synchronization [<a href="#ref-AvbAssum" title='"Audio Video Bridging Gen 2 Assumptions"'>AvbAssum</a>].




<span class="grey">Mizrahi                       Informational                    [Page 32]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-33"></span>
<span class="grey"><a href="./rfc7384">RFC 7384</a>           Time Protocol Security Requirements      October 2014</span>


   The usage of external security mechanisms may affect time protocols
   as follows:

   o  Timestamping accuracy can be affected, as described in <a href="#section-7.1">Section</a>
      <a href="#section-7.1">7.1</a>.

   o  If traffic is secured between two nodes in the network, no
      intermediate clocks can be used between these two nodes.  In the
      [<a href="#ref-3GPP" title='"Security of Home Node B (HNB) / Home evolved Node B (HeNB)"'>3GPP</a>] example, if traffic between the Femtocell and the Femto
      Gateway is encrypted, then time protocol packets are necessarily
      transported over the underlying network without modification and,
      thus, cannot enjoy the improved accuracy provided by intermediate
      clock nodes.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/7.5.%20%20External%20Security%20Services%20Requiring%20Time"></a><a class="selflink" href="#section-7.5" id="section-7.5">7.5</a>.  External Security Services Requiring Time</span>

   Cryptographic protocols often use time as an important factor in the
   cryptographic algorithm.  If a time protocol is compromised, it may
   consequently expose the security protocols that rely on it to various
   attacks.  Two examples are presented in this section.

<span class="h4"><a class="dashAnchor" name="//apple_ref/cpp/Section/7.5.1.%20%20Timestamped%20Certificates"></a><a class="selflink" href="#section-7.5.1" id="section-7.5.1">7.5.1</a>.  Timestamped Certificates</span>

   Certificate validation requires the sender and receiver to be roughly
   time synchronized.  Thus, synchronization is required for
   establishing security protocols such as Internet Key Exchange
   Protocol version 2 (IKEv2) and Transport Layer Security (TLS).  Other
   authentication and key exchange mechanisms, such as Kerberos, also
   require the parties involved to be synchronized [<a href="#ref-Kerb" title='"Kerberized Internet Negotiation of Keys (KINK)"'>Kerb</a>].

   An even stronger interdependence between a time protocol and a
   security mechanism is defined in [<a href="#ref-AutoKey" title='"Network Time Protocol Version 4: Autokey Specification"'>AutoKey</a>], which defines mutual
   dependence between the acquired time information, and the
   authentication protocol that secures it.  This bootstrapping behavior
   results from the fact that trusting the received time information
   requires a valid certificate, and validating a certificate requires
   knowledge of the time.

<span class="h4"><a class="dashAnchor" name="//apple_ref/cpp/Section/7.5.2.%20%20Time%20Changes%20and%20Replay%20Attacks"></a><a class="selflink" href="#section-7.5.2" id="section-7.5.2">7.5.2</a>.  Time Changes and Replay Attacks</span>

   A successful attack on a time protocol may cause the attacked clocks
   to go back in time.  The erroneous time may expose cryptographic
   algorithms that rely on time, as a node may use a key that was
   already used in the past and has expired.







<span class="grey">Mizrahi                       Informational                    [Page 33]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-34"></span>
<span class="grey"><a href="./rfc7384">RFC 7384</a>           Time Protocol Security Requirements      October 2014</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/8.%20%20Issues%20for%20Further%20Discussion"></a><a class="selflink" href="#section-8" id="section-8">8</a>.  Issues for Further Discussion</span>

   The Key distribution is outside the scope of this document.  Although
   this is an essential element of any security system, it is outside
   the scope of this document.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/9.%20%20Security%20Considerations"></a><a class="selflink" href="#section-9" id="section-9">9</a>.  Security Considerations</span>

   The security considerations of network timing protocols are presented
   throughout this document.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/10.%20%20References"></a><a class="selflink" href="#section-10" id="section-10">10</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/10.1.%20%20Normative%20References"></a><a class="selflink" href="#section-10.1" id="section-10.1">10.1</a>.  Normative References</span>

   [<a id="ref-IEEE1588">IEEE1588</a>]    IEEE, "1588-2008 - IEEE Standard for a Precision Clock
                 Synchronization Protocol for Networked Measurement and
                 Control Systems", IEEE Standard 1588-2008, July 2008.

   [<a id="ref-KEYWORDS">KEYWORDS</a>]    Bradner, S., "Key words for use in RFCs to Indicate
                 Requirement Levels", <a href="https://www.rfc-editor.org/bcp/bcp14">BCP 14</a>, <a href="./rfc2119">RFC 2119</a>, March 1997,
                 &lt;<a href="http://www.rfc-editor.org/info/rfc2119">http://www.rfc-editor.org/info/rfc2119</a>&gt;.


   [<a id="ref-NTPv4">NTPv4</a>]       Mills, D., Martin, J., Ed., Burbank, J., and W. Kasch,
                 "Network Time Protocol Version 4: Protocol and
                 Algorithms Specification", <a href="./rfc5905">RFC 5905</a>, June 2010,
                 &lt;<a href="http://www.rfc-editor.org/info/rfc5905">http://www.rfc-editor.org/info/rfc5905</a>&gt;.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/10.2.%20%20Informative%20References"></a><a class="selflink" href="#section-10.2" id="section-10.2">10.2</a>.  Informative References</span>

   [<a id="ref-1588IPsec">1588IPsec</a>]   Treytl, A. and B. Hirschler, "Securing IEEE 1588 by
                 IPsec tunnels - An analysis", in Proceedings of 2010
                 International Symposium for Precision Clock
                 Synchronization for Measurement, Control and
                 Communication, ISPCS 2010, pp. 83-90, September 2010.

   [<a id="ref-3GPP">3GPP</a>]        3GPP, "Security of Home Node B (HNB) / Home evolved
                 Node B (HeNB)", 3GPP TS 33.320 11.6.0, November 2012.

   [<a id="ref-Anatomy">Anatomy</a>]     Nachreiner, C., "Anatomy of an ARP Poisoning Attack",
                 2003.

   [<a id="ref-AutoKey">AutoKey</a>]     Haberman, B., Ed., and D. Mills, "Network Time Protocol
                 Version 4: Autokey Specification", <a href="./rfc5906">RFC 5906</a>, June 2010,
                 &lt;<a href="http://www.rfc-editor.org/info/rfc5906">http://www.rfc-editor.org/info/rfc5906</a>&gt;.





<span class="grey">Mizrahi                       Informational                    [Page 34]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-35"></span>
<span class="grey"><a href="./rfc7384">RFC 7384</a>           Time Protocol Security Requirements      October 2014</span>


   [<a id="ref-AvbAssum">AvbAssum</a>]    Pannell, D., "Audio Video Bridging Gen 2 Assumptions",
                 IEEE 802.1 AVB Plenary, Work in Progress, May 2012.

   [<a id="ref-DelayAtt">DelayAtt</a>]    Mizrahi, T., "A game theoretic analysis of delay
                 attacks against time synchronization protocols",
                 accepted, to appear in Proceedings of the International
                 IEEE Symposium on Precision Clock Synchronization for
                 Measurement, Control and Communication, ISPCS,
                 September 2012.

   [<a id="ref-Hack">Hack</a>]        McClure, S., Scambray, J., and G. Kurtz, "Hacking
                 Exposed: Network Security Secrets and Solutions",
                 McGraw-Hill, 2009.

   [<a id="ref-IPsec">IPsec</a>]       Kent, S. and K. Seo, "Security Architecture for the
                 Internet Protocol", <a href="./rfc4301">RFC 4301</a>, December 2005,
                 &lt;<a href="http://www.rfc-editor.org/info/rfc4301">http://www.rfc-editor.org/info/rfc4301</a>&gt;.

   [<a id="ref-IPsecSync">IPsecSync</a>]   Xu, Y., "IPsec security for packet based
                 synchronization", Work in Progress, <a href="./draft-xu-tictoc-ipsec-security-for-synchronization-02">draft-xu-tictoc-</a>
                 <a href="./draft-xu-tictoc-ipsec-security-for-synchronization-02">ipsec-security-for-synchronization-02</a>, September 2011.

   [<a id="ref-Kerb">Kerb</a>]        Sakane, S., Kamada, K., Thomas, M., and J. Vilhuber,
                 "Kerberized Internet Negotiation of Keys (KINK)",
                 <a href="./rfc4430">RFC 4430</a>, March 2006,
                 &lt;<a href="http://www.rfc-editor.org/info/rfc4430">http://www.rfc-editor.org/info/rfc4430</a>&gt;.

   [<a id="ref-MACsec">MACsec</a>]      IEEE, "IEEE Standard for Local and metropolitan area
                 networks - Media Access Control (MAC) Security", IEEE
                 Standard 802.1AE, August 2006.

   [<a id="ref-NTPDDoS">NTPDDoS</a>]     "Attackers use NTP reflection in huge DDoS attack",
                 TICTOC mail archive, 2014.

   [<a id="ref-SecPTP">SecPTP</a>]      Tsang, J. and K. Beznosov, "A Security Analysis of the
                 Precise Time Protocol (Short Paper)," 8th International
                 Conference on Information and Communication Security
                 (ICICS) Lecture Notes in Computer Science Volume 4307,
                 pp. 50-59, 2006.

   [<a id="ref-SecSen">SecSen</a>]      Ganeriwal, S., Popper, C., Capkun, S., and M. B.
                 Srivastava, "Secure Time Synchronization in Sensor
                 Networks", ACM Trans. Inf. Syst. Secur., Volume 11,
                 Issue 4, Article 23, July 2008.

   [<a id="ref-TimeSec">TimeSec</a>]     Mizrahi, T., "Time synchronization security using IPsec
                 and MACsec", ISPCS 2011, pp. 38-43, September 2011.




<span class="grey">Mizrahi                       Informational                    [Page 35]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-36"></span>
<span class="grey"><a href="./rfc7384">RFC 7384</a>           Time Protocol Security Requirements      October 2014</span>


   [<a id="ref-Traps">Traps</a>]       Treytl, A., Gaderer, G., Hirschler, B., and R. Cohen,
                 "Traps and pitfalls in secure clock synchronization" in
                 Proceedings of 2007 International Symposium for
                 Precision Clock Synchronization for Measurement,
                 Control and Communication, ISPCS 2007, pp. 18-24,
                 October 2007.

   [<a id="ref-Tunnel">Tunnel</a>]      Treytl, A., Hirschler, B., and T. Sauter, "Secure
                 tunneling of high-precision clock synchronisation
                 protocols and other time-stamped data", in Proceedings
                 of the 8th IEEE International Workshop on Factory
                 Communication Systems (WFCS), pp. 303-313, May 2010.

Acknowledgments

   The author gratefully acknowledges Stefano Ruffini, Doug Arnold,
   Kevin Gross, Dieter Sibold, Dan Grossman, Laurent Montini, Russell
   Smiley, Shawn Emery, Dan Romascanu, Stephen Farrell, Kathleen
   Moriarty, and Joel Jaeggli for their thorough review and helpful
   comments.  The author would also like to thank members of the TICTOC
   WG for providing feedback on the TICTOC mailing list.

Contributors

   Karen O'Donoghue
   ISOC

   EMail: odonoghue@isoc.org

Author's Address

   Tal Mizrahi
   Marvell
   6 Hamada St.
   Yokneam, 20692 Israel

   EMail: talmi@marvell.com














Mizrahi                       Informational                    [Page 36]
</pre>
</body></html>