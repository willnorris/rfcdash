<!DOCTYPE html>
<html class="RFC" lang="en"><head>
<meta charset="utf-8"/>
<meta content="Common,Han,Latin" name="scripts"/>
<meta content="initial-scale=1.0" name="viewport"/>
<title>RFC 9345: Delegated Credentials for TLS and DTLS</title>
<meta content="Richard Barnes" name="author"/>
<meta content="Subodh Iyengar" name="author"/>
<meta content="Nick Sullivan" name="author"/>
<meta content="Eric Rescorla" name="author"/>
<meta content="
       The organizational separation between operators of TLS and DTLS
endpoints and the certification authority can create limitations.  For
example, the lifetime of certificates, how they may be used, and the
algorithms they support are ultimately determined by the
Certification Authority (CA).  This document describes a mechanism
to overcome some of these limitations by enabling operators to
delegate their own credentials for use in TLS and DTLS without breaking
compatibility with peers that do not support this specification. 
    " name="description"/>
<meta content="xml2rfc 3.17.4" name="generator"/>
<meta content="certificate" name="keyword"/>
<meta content="authentication" name="keyword"/>
<meta content="TLS 1.3" name="keyword"/>
<meta content="signature scheme" name="keyword"/>
<meta content="9345" name="rfc.number"/>
<!-- Generator version information:
  xml2rfc 3.17.4
    Python 3.9.15
    ConfigArgParse 1.5.3
    google-i18n-address 3.0.0
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 4.9.0
    platformdirs 3.8.0
    pycountry 22.3.5
    PyYAML 6.0
    requests 2.28.0
    setuptools 44.1.1
    six 1.16.0
    wcwidth 0.2.5
    weasyprint 56.1
-->
<link href="rfc9345.xml" rel="alternate" type="application/rfc+xml"/>
<link href="#copyright" rel="license"/>
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necessary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

:root {
  --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
  --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
  --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
}

@viewport {
  zoom: 1.0;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: var(--font-sans);
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
svg[font-family~="serif" i], svg [font-family~="serif" i] {
  font-family: var(--font-serif);
}
svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
  font-family: var(--font-sans);
}
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef,
.iref + a[href].internal {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre {
  background-color: #f9f9f9;
  font-family: var(--font-mono);
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: var(--font-sans);
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  .breakable pre {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The following is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
.sourcecode pre,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .artwork > pre,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background slightly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottom margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the compact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div.sourcecode:first-child,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type:only-child {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css"/>
<link href="https://dx.doi.org/10.17487/rfc9345" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <link href="https://datatracker.ietf.org/doc/draft-ietf-tls-subcerts-15" rel="prev"/>
  </head>
<body class="xml2rfc">
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 9345</td>
<td class="center">Delegated Credentials for TLS and DTLS</td>
<td class="right">July 2023</td>
</tr></thead>
<tfoot><tr>
<td class="left">Barnes, et al.</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div class="document-information" id="external-metadata"></div>
<div class="document-information" id="internal-metadata">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a class="eref" href="https://www.rfc-editor.org/rfc/rfc9345">9345</a></dd>
<dt class="label-category">Category:</dt>
<dd class="category">Standards Track</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time class="published" datetime="2023-07">July 2023</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">R. Barnes</div>
<div class="org">Cisco</div>
</div>
<div class="author">
      <div class="author-name">S. Iyengar</div>
<div class="org">Facebook</div>
</div>
<div class="author">
      <div class="author-name">N. Sullivan</div>
<div class="org">Cloudflare</div>
</div>
<div class="author">
      <div class="author-name">E. Rescorla</div>
<div class="org">Windy Hill Systems, LLC</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 9345</h1>
<h1 id="title">Delegated Credentials for TLS and DTLS</h1>
<section id="section-abstract">
      <h2 id="abstract"><a class="selfRef" href="#abstract">Abstract</a></h2>
<p id="section-abstract-1">The organizational separation between operators of TLS and DTLS
endpoints and the certification authority can create limitations.  For
example, the lifetime of certificates, how they may be used, and the
algorithms they support are ultimately determined by the
Certification Authority (CA).  This document describes a mechanism
to overcome some of these limitations by enabling operators to
delegate their own credentials for use in TLS and DTLS without breaking
compatibility with peers that do not support this specification.<a class="pilcrow" href="#section-abstract-1">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a class="section-name selfRef" href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This is an Internet Standards Track document.<a class="pilcrow" href="#section-boilerplate.1-1">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.<a class="pilcrow" href="#section-boilerplate.1-2">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc9345">https://www.rfc-editor.org/info/rfc9345</a></span>.<a class="pilcrow" href="#section-boilerplate.1-3">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a class="section-name selfRef" href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2023 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a class="pilcrow" href="#section-boilerplate.2-1">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a class="pilcrow" href="#section-boilerplate.2-2">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a class="toplink" href="#" onclick="scroll(0,0)">▲</a><h2 id="name-table-of-contents">
<a class="section-name selfRef" href="#name-table-of-contents">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p class="keepWithNext" id="section-toc.1-1.1.1"><a class="auto internal xref" href="#section-1">1</a>.  <a class="internal xref" href="#name-introduction">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p class="keepWithNext" id="section-toc.1-1.2.1"><a class="auto internal xref" href="#section-2">2</a>.  <a class="internal xref" href="#name-conventions-and-terminology">Conventions and Terminology</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a class="auto internal xref" href="#section-3">3</a>.  <a class="internal xref" href="#name-solution-overview">Solution Overview</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p class="keepWithNext" id="section-toc.1-1.3.2.1.1"><a class="auto internal xref" href="#section-3.1">3.1</a>.  <a class="internal xref" href="#name-rationale">Rationale</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a class="auto internal xref" href="#section-3.2">3.2</a>.  <a class="internal xref" href="#name-related-work">Related Work</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a class="auto internal xref" href="#section-4">4</a>.  <a class="internal xref" href="#name-delegated-credentials">Delegated Credentials</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a class="auto internal xref" href="#section-4.1">4.1</a>.  <a class="internal xref" href="#name-client-and-server-behavior">Client and Server Behavior</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.1">
                    <p id="section-toc.1-1.4.2.1.2.1.1"><a class="auto internal xref" href="#section-4.1.1">4.1.1</a>.  <a class="internal xref" href="#name-server-authentication">Server Authentication</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.2">
                    <p id="section-toc.1-1.4.2.1.2.2.1"><a class="auto internal xref" href="#section-4.1.2">4.1.2</a>.  <a class="internal xref" href="#name-client-authentication">Client Authentication</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.3">
                    <p id="section-toc.1-1.4.2.1.2.3.1"><a class="auto internal xref" href="#section-4.1.3">4.1.3</a>.  <a class="internal xref" href="#name-validating-a-delegated-cred">Validating a Delegated Credential</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a class="auto internal xref" href="#section-4.2">4.2</a>.  <a class="internal xref" href="#name-certificate-requirements">Certificate Requirements</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a class="auto internal xref" href="#section-5">5</a>.  <a class="internal xref" href="#name-operational-considerations">Operational Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a class="auto internal xref" href="#section-5.1">5.1</a>.  <a class="internal xref" href="#name-client-clock-skew">Client Clock Skew</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a class="auto internal xref" href="#section-6">6</a>.  <a class="internal xref" href="#name-iana-considerations">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a class="auto internal xref" href="#section-7">7</a>.  <a class="internal xref" href="#name-security-considerations">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a class="auto internal xref" href="#section-7.1">7.1</a>.  <a class="internal xref" href="#name-security-of-delegated-crede">Security of Delegated Credential's Private Key</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a class="auto internal xref" href="#section-7.2">7.2</a>.  <a class="internal xref" href="#name-re-use-of-delegated-credent">Re-use of Delegated Credentials in Multiple Contexts</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a class="auto internal xref" href="#section-7.3">7.3</a>.  <a class="internal xref" href="#name-revocation-of-delegated-cre">Revocation of Delegated Credentials</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a class="auto internal xref" href="#section-7.4">7.4</a>.  <a class="internal xref" href="#name-interactions-with-session-r">Interactions with Session Resumption</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5">
                <p id="section-toc.1-1.7.2.5.1"><a class="auto internal xref" href="#section-7.5">7.5</a>.  <a class="internal xref" href="#name-privacy-considerations">Privacy Considerations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.6">
                <p id="section-toc.1-1.7.2.6.1"><a class="auto internal xref" href="#section-7.6">7.6</a>.  <a class="internal xref" href="#name-the-impact-of-signature-for">The Impact of Signature Forgery Attacks</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a class="auto internal xref" href="#section-8">8</a>.  <a class="internal xref" href="#name-references">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a class="auto internal xref" href="#section-8.1">8.1</a>.  <a class="internal xref" href="#name-normative-references">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a class="auto internal xref" href="#section-8.2">8.2</a>.  <a class="internal xref" href="#name-informative-references">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a class="auto internal xref" href="#appendix-A">Appendix A</a>.  <a class="internal xref" href="#name-asn1-module">ASN.1 Module</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a class="auto internal xref" href="#appendix-B">Appendix B</a>.  <a class="internal xref" href="#name-example-certificate">Example Certificate</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a class="auto internal xref" href="#appendix-C"></a><a class="internal xref" href="#name-acknowledgements">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a class="auto internal xref" href="#appendix-D"></a><a class="internal xref" href="#name-authors-addresses">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a class="section-number selfRef" href="#section-1">1. </a><a class="section-name selfRef" href="#name-introduction">Introduction</a>
      </h2>
<p id="section-1-1">Server operators often deploy (D)TLS termination to act as the server for
inbound TLS connections.  These termination services can be in locations such
as remote data centers or Content Delivery Networks (CDNs) where it may
be difficult to detect compromises of private key material corresponding
to TLS certificates.  Short-lived certificates may be
used to limit the exposure of keys in these cases.<a class="pilcrow" href="#section-1-1">¶</a></p>
<p id="section-1-2">However, short-lived certificates need to be renewed more frequently than
long-lived certificates.  If an external Certification Authority (CA) is unable to issue a certificate in
time to replace a deployed certificate, the server would no longer be able to
present a valid certificate to clients.  With short-lived certificates, there is
a smaller window of time to renew a certificate and therefore a higher risk that
an outage at a CA will negatively affect the uptime of the TLS-fronted service.<a class="pilcrow" href="#section-1-2">¶</a></p>
<p id="section-1-3">Typically, a (D)TLS server uses a certificate provided by some entity other than
the operator of the server (a CA) <span>[<a class="cite xref" href="#RFC8446">RFC8446</a>]</span>
        <span>[<a class="cite xref" href="#RFC5280">RFC5280</a>]</span>.  This organizational separation makes the (D)TLS server operator
dependent on the CA for some aspects of its operations. For example:<a class="pilcrow" href="#section-1-3">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-4.1">Whenever the server operator wants to deploy a new certificate, it has to
interact with the CA.<a class="pilcrow" href="#section-1-4.1">¶</a>
</li>
        <li class="normal" id="section-1-4.2">The CA might only issue credentials containing certain types of public keys,
which can limit the set of (D)TLS signature schemes usable by the server
operator.<a class="pilcrow" href="#section-1-4.2">¶</a>
</li>
      </ul>
<p id="section-1-5">To reduce the dependency on external CAs, this document specifies a limited delegation
mechanism that allows a (D)TLS peer to issue its own credentials within
the scope of a certificate issued by an external CA.  These credentials only enable the
recipient of the delegation to terminate connections for names that the CA has authorized.  Furthermore,
this mechanism allows the server to use modern signature algorithms such as
Ed25519 <span>[<a class="cite xref" href="#RFC8032">RFC8032</a>]</span> even if their CA does not support them.<a class="pilcrow" href="#section-1-5">¶</a></p>
<p id="section-1-6">This document refers to the certificate issued by the CA as a "certificate",
or "delegation certificate", and the one issued by the operator as a "delegated
credential" or "DC".<a class="pilcrow" href="#section-1-6">¶</a></p>
</section>
</div>
<div id="conventions-and-terminology">
<section id="section-2">
      <h2 id="name-conventions-and-terminology">
<a class="section-number selfRef" href="#section-2">2. </a><a class="section-name selfRef" href="#name-conventions-and-terminology">Conventions and Terminology</a>
      </h2>
<p id="section-2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a class="cite xref" href="#RFC2119">RFC2119</a>]</span> <span>[<a class="cite xref" href="#RFC8174">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a class="pilcrow" href="#section-2-1">¶</a></p>
</section>
</div>
<div id="solution-overview">
<section id="section-3">
      <h2 id="name-solution-overview">
<a class="section-number selfRef" href="#section-3">3. </a><a class="section-name selfRef" href="#name-solution-overview">Solution Overview</a>
      </h2>
<p id="section-3-1">A delegated credential (DC) is a digitally signed data structure with two semantic
fields: a validity interval and a public key (along with its associated
signature algorithm).  The signature on the delegated credential indicates a delegation
from the certificate that is issued to the peer.  The private key
used to sign a credential corresponds to the public key of the peer's
X.509 end-entity certificate <span>[<a class="cite xref" href="#RFC5280">RFC5280</a>]</span>. <a class="auto internal xref" href="#fig1">Figure 1</a> shows the intended deployment architecture.<a class="pilcrow" href="#section-3-1">¶</a></p>
<span id="name-delegated-credentials-deplo"></span><div id="fig1">
<figure id="figure-1">
        <div class="alignLeft art-text artwork" id="section-3-2.1">
<pre>Client            Front-End            Back-End
  |                   |&lt;--DC distribution-&gt;|
  |----ClientHello---&gt;|                    |
  |&lt;---ServerHello----|                    |
  |&lt;---Certificate----|                    |
  |&lt;---CertVerify-----|                    |
  |        ...        |                    |

Legend:
Client: (D)TLS client
Front-End: (D)TLS server (could be a TLS-termination service like a CDN)
Back-End: Service with access to a private key
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-1">Figure 1</a>:
<a class="selfRef" href="#name-delegated-credentials-deplo">Delegated Credentials Deployment Architecture</a>
        </figcaption></figure>
</div>
<p id="section-3-3">A (D)TLS handshake that uses delegated credentials differs from a standard handshake
in a few important ways:<a class="pilcrow" href="#section-3-3">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-4.1">The initiating peer provides an extension in its ClientHello or CertificateRequest
that indicates support for this mechanism.<a class="pilcrow" href="#section-3-4.1">¶</a>
</li>
        <li class="normal" id="section-3-4.2">The peer sending the Certificate message provides both the certificate
chain terminating in its certificate and the delegated credential.<a class="pilcrow" href="#section-3-4.2">¶</a>
</li>
        <li class="normal" id="section-3-4.3">The initiator uses information from the peer's certificate
to verify the delegated credential and that the peer is asserting an
expected identity, determining an authentication result for the peer.<a class="pilcrow" href="#section-3-4.3">¶</a>
</li>
        <li class="normal" id="section-3-4.4">Peers accepting the delegated credential use it as the certificate
key for the (D)TLS handshake.<a class="pilcrow" href="#section-3-4.4">¶</a>
</li>
      </ul>
<p id="section-3-5">As detailed in <a class="auto internal xref" href="#delegated-credentials">Section 4</a>, the delegated credential is
cryptographically bound to the end-entity certificate with which the
credential may be used.  This document specifies the use of delegated
credentials in (D)TLS 1.3 or later; their use in prior versions of the
protocol is not allowed.<a class="pilcrow" href="#section-3-5">¶</a></p>
<p id="section-3-6">Delegated credentials allow a peer to terminate (D)TLS connections on behalf of
the certificate owner.  If a credential is stolen, there is no mechanism for
revoking it without revoking the certificate itself.  To limit exposure in case
of the compromise of a delegated credential's private key, delegated credentials
have a maximum validity period.  In the absence of an application profile standard
specifying otherwise, the maximum validity period is set to 7 days.  Peers <span class="bcp14">MUST NOT</span> issue credentials with a validity period longer than the maximum validity period or that extends beyond the validity period of the delegation certificate.
This mechanism is described in detail in <a class="auto internal xref" href="#client-and-server-behavior">Section 4.1</a>.<a class="pilcrow" href="#section-3-6">¶</a></p>
<p id="section-3-7">It was noted in <span>[<a class="cite xref" href="#XPROT">XPROT</a>]</span> that certificates in use by servers that
support outdated protocols such as SSLv2 can be used to forge
signatures for certificates that contain the keyEncipherment KeyUsage
(<span>[<a class="cite xref" href="#RFC5280">RFC5280</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc5280#section-4.2.1.3">Section 4.2.1.3</a></span>).  In order to reduce the risk of cross-
protocol attacks on certificates that are not intended to be used
with DC-capable TLS stacks, we define a new DelegationUsage
extension to X.509 that permits use of delegated credentials.  (See <a class="auto internal xref" href="#certificate-requirements">Section 4.2</a>.)<a class="pilcrow" href="#section-3-7">¶</a></p>
<div id="rationale">
<section id="section-3.1">
        <h3 id="name-rationale">
<a class="section-number selfRef" href="#section-3.1">3.1. </a><a class="section-name selfRef" href="#name-rationale">Rationale</a>
        </h3>
<p id="section-3.1-1">Delegated credentials present a better alternative than other delegation
mechanisms like proxy certificates <span>[<a class="cite xref" href="#RFC3820">RFC3820</a>]</span> for several reasons:<a class="pilcrow" href="#section-3.1-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-2.1">There is no change needed to certificate validation at the PKI layer.<a class="pilcrow" href="#section-3.1-2.1">¶</a>
</li>
          <li class="normal" id="section-3.1-2.2">X.509 semantics are very rich.  This can cause unintended
consequences if a service owner creates a proxy certificate where
the properties differ from the leaf certificate.  Proxy certificates can
be useful in controlled environments, but remain a risk in scenarios
where the additional flexibility they provide is not necessary.  For
this reason,  delegated credentials have very restricted semantics
that should not conflict with X.509 semantics.<a class="pilcrow" href="#section-3.1-2.2">¶</a>
</li>
          <li class="normal" id="section-3.1-2.3">Proxy certificates rely on the certificate path building process to establish
a binding between the proxy certificate and the end-entity certificate.  Since
the certificate path building process is not cryptographically protected, it is
possible that a proxy certificate could be bound to another certificate with
the same public key, with different X.509 parameters.  Delegated credentials,
which rely on a cryptographic binding between the entire certificate and the
delegated credential, cannot.<a class="pilcrow" href="#section-3.1-2.3">¶</a>
</li>
          <li class="normal" id="section-3.1-2.4">Each delegated credential is bound to a specific signature algorithm for use
in the (D)TLS handshake (<span>[<a class="cite xref" href="#RFC8446">RFC8446</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc8446#section-4.2.3">Section 4.2.3</a></span>).  This prevents
them from being used with other, perhaps unintended, signature algorithms.
The signature algorithm bound to the delegated credential can be chosen
independently of the set of signature algorithms supported by the end-entity
certificate.<a class="pilcrow" href="#section-3.1-2.4">¶</a>
</li>
        </ul>
</section>
</div>
<div id="related-work">
<section id="section-3.2">
        <h3 id="name-related-work">
<a class="section-number selfRef" href="#section-3.2">3.2. </a><a class="section-name selfRef" href="#name-related-work">Related Work</a>
        </h3>
<p id="section-3.2-1">Many of the use cases for delegated credentials can also be addressed using
purely server-side mechanisms that do not require changes to client behavior
(e.g., a PKCS#11 interface or a remote signing mechanism, <span>[<a class="cite xref" href="#KEYLESS">KEYLESS</a>]</span> being one
example).  These
mechanisms, however, incur per-transaction latency, since the front-end
server has to interact with a back-end server that holds a private key.  The
mechanism proposed in this document allows the delegation to be done
offline, with no per-transaction latency.  The figure below compares the
message flows for these two mechanisms
with (D)TLS 1.3 <span>[<a class="cite xref" href="#RFC8446">RFC8446</a>]</span> <span>[<a class="cite xref" href="#RFC9147">RFC9147</a>]</span>.<a class="pilcrow" href="#section-3.2-1">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.2-2">
<pre>Remote key signing:

Client            Front-End            Back-End
  |----ClientHello---&gt;|                    |
  |&lt;---ServerHello----|                    |
  |&lt;---Certificate----|                    |
  |                   |&lt;---remote sign----&gt;|
  |&lt;---CertVerify-----|                    |
  |        ...        |                    |


Delegated Credential:

Client            Front-End            Back-End
  |                   |&lt;--DC distribution-&gt;|
  |----ClientHello---&gt;|                    |
  |&lt;---ServerHello----|                    |
  |&lt;---Certificate----|                    |
  |&lt;---CertVerify-----|                    |
  |        ...        |                    |

Legend:
Client: (D)TLS client
Front-End: (D)TLS server (could be a TLS-termination service like a CDN)
Back-End: Service with access to a private key
</pre><a class="pilcrow" href="#section-3.2-2">¶</a>
</div>
<p id="section-3.2-3">These two mechanisms can be complementary.  A server could use
delegated credentials for clients that support them, while using a
server-side mechanism to support legacy clients.  Both mechanisms
require a trusted relationship between the front-end and back-end --
the delegated credential can be used in place of a certificate
private key.<a class="pilcrow" href="#section-3.2-3">¶</a></p>
<p id="section-3.2-4">The use of short-lived certificates with automated certificate issuance,
e.g., with the Automated Certificate Management Environment (ACME) <span>[<a class="cite xref" href="#RFC8555">RFC8555</a>]</span>,
reduces the risk of key compromise but has several limitations.
Specifically, it introduces an operationally critical dependency on an
external party (the CA).  It also
limits the types of algorithms supported for (D)TLS authentication to those
the CA is willing to issue a certificate for.  Nonetheless, existing
automated issuance APIs like ACME may be useful for provisioning delegated credentials.<a class="pilcrow" href="#section-3.2-4">¶</a></p>
</section>
</div>
</section>
</div>
<div id="delegated-credentials">
<section id="section-4">
      <h2 id="name-delegated-credentials">
<a class="section-number selfRef" href="#section-4">4. </a><a class="section-name selfRef" href="#name-delegated-credentials">Delegated Credentials</a>
      </h2>
<p id="section-4-1">While X.509 forbids end-entity certificates from being used as issuers for
other certificates, it is valid to use them to issue other signed
objects as long as the certificate contains the digitalSignature KeyUsage
(<span>[<a class="cite xref" href="#RFC5280">RFC5280</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc5280#section-4.2.1.3">Section 4.2.1.3</a></span>).  (All certificates compatible with TLS 1.3 are
required to contain the digitalSignature KeyUsage.)  This document defines a new signed
object format that encodes only the semantics that are needed for this
application.  The Credential has the following structure:<a class="pilcrow" href="#section-4-1">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4-2">
<pre>   struct {
     uint32 valid_time;
     SignatureScheme dc_cert_verify_algorithm;
     opaque ASN1_subjectPublicKeyInfo&lt;1..2^24-1&gt;;
   } Credential;
</pre><a class="pilcrow" href="#section-4-2">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4-3">
        <dt id="section-4-3.1">valid_time:</dt>
        <dd id="section-4-3.2" style="margin-left: 1.5em">
          <p id="section-4-3.2.1">Time, in seconds relative to the delegation certificate's
notBefore value, after which the delegated credential is no longer valid.
By default, unless set to an alternative value by an application profile (see
<a class="auto internal xref" href="#solution-overview">Section 3</a>), endpoints will reject delegated credentials that expire more than 7
days from the current time (as described in <a class="auto internal xref" href="#validating-a-delegated-credential">Section 4.1.3</a>).<a class="pilcrow" href="#section-4-3.2.1">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-4-3.3">dc_cert_verify_algorithm:</dt>
        <dd id="section-4-3.4" style="margin-left: 1.5em">
          <p id="section-4-3.4.1">The signature algorithm of the Credential key pair, where the type
SignatureScheme is as defined in <span>[<a class="cite xref" href="#RFC8446">RFC8446</a>]</span>. This is expected to be
the same as the sender's CertificateVerify.algorithm (as described in <a class="auto internal xref" href="#validating-a-delegated-credential">Section 4.1.3</a>).<br/>
When
using RSA, the public key <span class="bcp14">MUST NOT</span> use the rsaEncryption OID.  As a result,
the following algorithms are not allowed for use with delegated credentials:
rsa_pss_rsae_sha256, rsa_pss_rsae_sha384, and rsa_pss_rsae_sha512.<a class="pilcrow" href="#section-4-3.4.1">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-4-3.5">ASN1_subjectPublicKeyInfo:</dt>
        <dd id="section-4-3.6" style="margin-left: 1.5em">
          <p id="section-4-3.6.1">The Credential's public key, a DER-encoded <span>[<a class="cite xref" href="#X.690">X.690</a>]</span> SubjectPublicKeyInfo as defined in
<span>[<a class="cite xref" href="#RFC5280">RFC5280</a>]</span>.<a class="pilcrow" href="#section-4-3.6.1">¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-4-4">The DelegatedCredential has the following structure:<a class="pilcrow" href="#section-4-4">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4-5">
<pre>   struct {
     Credential cred;
     SignatureScheme algorithm;
     opaque signature&lt;1..2^16-1&gt;;
   } DelegatedCredential;
</pre><a class="pilcrow" href="#section-4-5">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4-6">
        <dt id="section-4-6.1">cred:</dt>
        <dd id="section-4-6.2" style="margin-left: 1.5em">
          <p id="section-4-6.2.1">The Credential structure as previously defined.<a class="pilcrow" href="#section-4-6.2.1">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-4-6.3">algorithm:</dt>
        <dd id="section-4-6.4" style="margin-left: 1.5em">
          <p id="section-4-6.4.1">The signature algorithm used to create DelegatedCredential.signature.<a class="pilcrow" href="#section-4-6.4.1">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-4-6.5">signature:</dt>
        <dd id="section-4-6.6" style="margin-left: 1.5em">
          <p id="section-4-6.6.1">The delegation, a signature that binds the credential to the end-entity
certificate's public key as specified below. The signature scheme is specified
by DelegatedCredential.algorithm.<a class="pilcrow" href="#section-4-6.6.1">¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-4-7">The signature of the DelegatedCredential is computed over the concatenation of:<a class="pilcrow" href="#section-4-7">¶</a></p>
<ol class="normal type-1" id="section-4-8" start="1" type="1">
<li id="section-4-8.1">An octet stream that consists of octet 32 (0x20) repeated 64 times.<a class="pilcrow" href="#section-4-8.1">¶</a>
</li>
        <li id="section-4-8.2">The non-null terminated context string "TLS, server delegated credentials" for server authentication and "TLS, client delegated credentials" for client authentication.<a class="pilcrow" href="#section-4-8.2">¶</a>
</li>
        <li id="section-4-8.3">A single octet 0x00, which serves as the separator.<a class="pilcrow" href="#section-4-8.3">¶</a>
</li>
        <li id="section-4-8.4">The DER-encoded X.509 end-entity certificate used to sign the
DelegatedCredential.<a class="pilcrow" href="#section-4-8.4">¶</a>
</li>
        <li id="section-4-8.5">DelegatedCredential.cred.<a class="pilcrow" href="#section-4-8.5">¶</a>
</li>
        <li id="section-4-8.6">DelegatedCredential.algorithm.<a class="pilcrow" href="#section-4-8.6">¶</a>
</li>
      </ol>
<p id="section-4-9">The signature is computed by using the private key of the peer's end-entity
certificate, with the algorithm indicated by DelegatedCredential.algorithm.<a class="pilcrow" href="#section-4-9">¶</a></p>
<p id="section-4-10">The signature effectively binds the credential to the parameters of the
handshake in which it is used.  In particular, it ensures that credentials are
only used with the certificate and signature algorithm chosen by the
delegator.<a class="pilcrow" href="#section-4-10">¶</a></p>
<p id="section-4-11">The code changes required in order to create and verify delegated credentials,
and the implementation complexity this entails, are localized to the (D)TLS
stack.  This has the advantage of avoiding changes to the often-delicate
security-critical PKI code.<a class="pilcrow" href="#section-4-11">¶</a></p>
<div id="client-and-server-behavior">
<section id="section-4.1">
        <h3 id="name-client-and-server-behavior">
<a class="section-number selfRef" href="#section-4.1">4.1. </a><a class="section-name selfRef" href="#name-client-and-server-behavior">Client and Server Behavior</a>
        </h3>
<p id="section-4.1-1">This document defines the following (D)TLS extension code point.<a class="pilcrow" href="#section-4.1-1">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1-2">
<pre>   enum {
     ...
     delegated_credential(34),
     (65535)
   } ExtensionType;
</pre><a class="pilcrow" href="#section-4.1-2">¶</a>
</div>
<div id="server-authentication">
<section id="section-4.1.1">
          <h4 id="name-server-authentication">
<a class="section-number selfRef" href="#section-4.1.1">4.1.1. </a><a class="section-name selfRef" href="#name-server-authentication">Server Authentication</a>
          </h4>
<p id="section-4.1.1-1">A client that is willing to use delegated credentials in a connection <span class="bcp14">SHALL</span> send a
"delegated_credential" extension in its ClientHello. The body of the extension
consists of a SignatureSchemeList (defined in <span>[<a class="cite xref" href="#RFC8446">RFC8446</a>]</span>):<a class="pilcrow" href="#section-4.1.1-1">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1.1-2">
<pre>   struct {
     SignatureScheme supported_signature_algorithms&lt;2..2^16-2&gt;;
   } SignatureSchemeList;
</pre><a class="pilcrow" href="#section-4.1.1-2">¶</a>
</div>
<p id="section-4.1.1-3">If the client receives a delegated credential without having indicated support
in its ClientHello,
then the client <span class="bcp14">MUST</span> abort the handshake with an "unexpected_message" alert.<a class="pilcrow" href="#section-4.1.1-3">¶</a></p>
<p id="section-4.1.1-4">If the extension is present, the server <span class="bcp14">MAY</span> send a delegated credential; if the
extension is not present, the server <span class="bcp14">MUST NOT</span> send a delegated credential.
When a (D)TLS version negotiated is less than 1.3, the server <span class="bcp14">MUST</span> ignore this extension.
An example of when a server could choose not to send a delegated
credential is when the SignatureSchemes listed only contain signature schemes
for which a corresponding delegated credential does not exist or are
otherwise unsuitable for the connection.<a class="pilcrow" href="#section-4.1.1-4">¶</a></p>
<p id="section-4.1.1-5">The server <span class="bcp14">MUST</span> send the delegated credential as an extension in the
CertificateEntry of its end-entity certificate; the client <span class="bcp14">MUST NOT</span> use
delegated credentials sent as extensions to any other certificate, and <span class="bcp14">SHOULD</span> ignore them, but <span class="bcp14">MAY</span> abort the handshake with
an "illegal_parameter" alert.  If the server sends multiple delegated
credentials extensions in a single CertificateEntry, the client <span class="bcp14">MUST</span>
abort the handshake with an "illegal_parameter" alert.<a class="pilcrow" href="#section-4.1.1-5">¶</a></p>
<p id="section-4.1.1-6">The algorithm field <span class="bcp14">MUST</span> be of a type advertised by the client in the
"signature_algorithms" extension of the ClientHello message, and
the dc_cert_verify_algorithm field <span class="bcp14">MUST</span> be of a
type advertised by the client in the SignatureSchemeList; otherwise, the credential is
considered not valid.  Clients that receive non-valid delegated
credentials <span class="bcp14">MUST</span> terminate the connection with an "illegal_parameter"
alert.<a class="pilcrow" href="#section-4.1.1-6">¶</a></p>
</section>
</div>
<div id="client-authentication">
<section id="section-4.1.2">
          <h4 id="name-client-authentication">
<a class="section-number selfRef" href="#section-4.1.2">4.1.2. </a><a class="section-name selfRef" href="#name-client-authentication">Client Authentication</a>
          </h4>
<p id="section-4.1.2-1">A server that supports this specification <span class="bcp14">SHALL</span> send a
"delegated_credential" extension in the CertificateRequest message
when requesting client authentication. The body of the
extension consists of a SignatureSchemeList. If the server receives a
delegated credential without having indicated support in its
CertificateRequest, then the server <span class="bcp14">MUST</span> abort with an
"unexpected_message" alert.<a class="pilcrow" href="#section-4.1.2-1">¶</a></p>
<p id="section-4.1.2-2">If the extension is present, the client <span class="bcp14">MAY</span> send a delegated credential; if the
extension is not present, the client <span class="bcp14">MUST NOT</span> send a delegated credential.
When a (D)TLS version negotiated is less than 1.3, the client <span class="bcp14">MUST</span> ignore this extension.<a class="pilcrow" href="#section-4.1.2-2">¶</a></p>
<p id="section-4.1.2-3">The client <span class="bcp14">MUST</span> send the delegated credential as an extension in the CertificateEntry of its end-entity certificate; the server
<span class="bcp14">MUST NOT</span> use delegated credentials sent as extensions to any other certificate, and <span class="bcp14">SHOULD</span> ignore them, but <span class="bcp14">MAY</span> abort the handshake with an "illegal_parameter" alert.  If the client sends multiple delegated credentials extensions in a single CertificateEntry, the server <span class="bcp14">MUST</span> abort the handshake with an "illegal_parameter" alert.<a class="pilcrow" href="#section-4.1.2-3">¶</a></p>
<p id="section-4.1.2-4">The algorithm field <span class="bcp14">MUST</span> be of a type advertised by the server
in the "signature_algorithms" extension of the CertificateRequest message,
and the dc_cert_verify_algorithm field <span class="bcp14">MUST</span> be of a type
advertised by the server in the SignatureSchemeList; otherwise, the credential is
considered not valid. Servers that receive non-valid
delegated credentials <span class="bcp14">MUST</span> terminate the connection with an
"illegal_parameter" alert.<a class="pilcrow" href="#section-4.1.2-4">¶</a></p>
</section>
</div>
<div id="validating-a-delegated-credential">
<section id="section-4.1.3">
          <h4 id="name-validating-a-delegated-cred">
<a class="section-number selfRef" href="#section-4.1.3">4.1.3. </a><a class="section-name selfRef" href="#name-validating-a-delegated-cred">Validating a Delegated Credential</a>
          </h4>
<p id="section-4.1.3-1">On receiving a delegated credential and certificate chain, the peer validates
the certificate chain and matches the end-entity certificate to the peer's
expected identity in the same way that it is done when delegated credentials are
not in use. It then performs the following checks with expiry time set to the
delegation certificate's notBefore value plus DelegatedCredential.cred.valid_time:<a class="pilcrow" href="#section-4.1.3-1">¶</a></p>
<ol class="normal type-1" id="section-4.1.3-2" start="1" type="1">
<li id="section-4.1.3-2.1">Verify that the current time is within the validity interval of the
credential. This is done by asserting that the current time does not exceed
the expiry time.  (The start time of the credential is implicitly validated
as part of certificate validation.)<a class="pilcrow" href="#section-4.1.3-2.1">¶</a>
</li>
            <li id="section-4.1.3-2.2">Verify that the delegated credential's remaining validity period is no more
than the maximum validity period. This is done by asserting that the expiry
time does not exceed the current time plus the maximum validity period (7
days by default) and that the expiry time is less than the certificate's expiry_time.<a class="pilcrow" href="#section-4.1.3-2.2">¶</a>
</li>
            <li id="section-4.1.3-2.3">Verify that dc_cert_verify_algorithm matches
the scheme indicated in the peer's CertificateVerify message and that the
algorithm is allowed for use with delegated credentials.<a class="pilcrow" href="#section-4.1.3-2.3">¶</a>
</li>
            <li id="section-4.1.3-2.4">Verify that the end-entity certificate satisfies the conditions described in
<a class="auto internal xref" href="#certificate-requirements">Section 4.2</a>.<a class="pilcrow" href="#section-4.1.3-2.4">¶</a>
</li>
            <li id="section-4.1.3-2.5">Use the public key in the peer's end-entity certificate to verify the
signature of the credential using the algorithm indicated by
DelegatedCredential.algorithm.<a class="pilcrow" href="#section-4.1.3-2.5">¶</a>
</li>
          </ol>
<p id="section-4.1.3-3">If one or more of these checks fail, then the delegated credential is deemed
not valid.  Clients and servers that receive non-valid delegated credentials <span class="bcp14">MUST</span> terminate the
connection with an "illegal_parameter" alert.<a class="pilcrow" href="#section-4.1.3-3">¶</a></p>
<p id="section-4.1.3-4">If successful, the participant receiving the Certificate message uses the public
key in DelegatedCredential.cred to verify the signature in the peer's
CertificateVerify message.<a class="pilcrow" href="#section-4.1.3-4">¶</a></p>
</section>
</div>
</section>
</div>
<div id="certificate-requirements">
<section id="section-4.2">
        <h3 id="name-certificate-requirements">
<a class="section-number selfRef" href="#section-4.2">4.2. </a><a class="section-name selfRef" href="#name-certificate-requirements">Certificate Requirements</a>
        </h3>
<p id="section-4.2-1">This document defines a new X.509 extension, DelegationUsage, to be used in the certificate
when the certificate permits the usage of delegated credentials.  What follows
is the ASN.1 <span>[<a class="cite xref" href="#X.680">X.680</a>]</span> for the DelegationUsage certificate extension.<a class="pilcrow" href="#section-4.2-1">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2-2">
<pre>    ext-delegationUsage EXTENSION  ::= {
        SYNTAX DelegationUsage IDENTIFIED BY id-pe-delegationUsage
    }

    DelegationUsage ::= NULL

    id-pe-delegationUsage OBJECT IDENTIFIER ::=
        { iso(1) identified-organization(3) dod(6) internet(1)
          private(4) enterprise(1) id-cloudflare(44363) 44 }
</pre><a class="pilcrow" href="#section-4.2-2">¶</a>
</div>
<p id="section-4.2-3">The extension <span class="bcp14">MUST</span> be marked non-critical.  (See <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc5280#section-4.2">Section 4.2</a> of [<a class="cite xref" href="#RFC5280">RFC5280</a>]</span>.)
An endpoint <span class="bcp14">MUST NOT</span> accept a delegated credential unless the peer's end-entity
certificate satisfies the following criteria:<a class="pilcrow" href="#section-4.2-3">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2-4.1">It has the DelegationUsage extension.<a class="pilcrow" href="#section-4.2-4.1">¶</a>
</li>
          <li class="normal" id="section-4.2-4.2">It has the digitalSignature KeyUsage (see the KeyUsage extension defined in
<span>[<a class="cite xref" href="#RFC5280">RFC5280</a>]</span>).<a class="pilcrow" href="#section-4.2-4.2">¶</a>
</li>
        </ul>
<p id="section-4.2-5">A new extension was chosen instead of adding a new Extended Key Usage
(EKU) to be compatible with deployed (D)TLS and PKI software stacks
without requiring CAs to issue new intermediate certificates.<a class="pilcrow" href="#section-4.2-5">¶</a></p>
</section>
</div>
</section>
</div>
<div id="operational-considerations">
<section id="section-5">
      <h2 id="name-operational-considerations">
<a class="section-number selfRef" href="#section-5">5. </a><a class="section-name selfRef" href="#name-operational-considerations">Operational Considerations</a>
      </h2>
<p id="section-5-1">The operational considerations documented in this section should be
taken into consideration when using delegated credentials.<a class="pilcrow" href="#section-5-1">¶</a></p>
<div id="client-clock-skew">
<section id="section-5.1">
        <h3 id="name-client-clock-skew">
<a class="section-number selfRef" href="#section-5.1">5.1. </a><a class="section-name selfRef" href="#name-client-clock-skew">Client Clock Skew</a>
        </h3>
<p id="section-5.1-1">One of the risks of deploying a short-lived credential system based
on absolute time is client clock skew.  If a client's clock is sufficiently
ahead of or behind the server's clock, then clients will reject delegated credentials
that are valid from the server's perspective.  Clock
skew also affects the validity of the original certificates.  The lifetime
of the delegated credential should be set taking clock skew into account.
Clock skew may affect a delegated credential at the beginning and end of
its validity periods, which should also be taken into account.<a class="pilcrow" href="#section-5.1-1">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-6">
      <h2 id="name-iana-considerations">
<a class="section-number selfRef" href="#section-6">6. </a><a class="section-name selfRef" href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<p id="section-6-1">This document registers the "delegated_credential" extension in the
"TLS ExtensionType Values" registry.  The "delegated_credential"
extension has been assigned the ExtensionType value 34.  The IANA registry
lists this extension as "Recommended" (i.e., "Y") and indicates that
it may appear in the ClientHello (CH), CertificateRequest (CR),
or Certificate (CT) messages in (D)TLS 1.3 <span>[<a class="cite xref" href="#RFC8446">RFC8446</a>]</span> <span>[<a class="cite xref" href="#RFC9147">RFC9147</a>]</span>.
Additionally, the "DTLS-Only" column is assigned the value "N".<a class="pilcrow" href="#section-6-1">¶</a></p>
<p id="section-6-2">This document also defines an ASN.1 module for the DelegationUsage
certificate extension in <a class="auto internal xref" href="#module">Appendix A</a>.  IANA has registered value 95 for
"id-mod-delegated-credential-extn" in the "SMI Security for PKIX Module
Identifier" (1.3.6.1.5.5.7.0) registry.  An OID for the DelegationUsage certificate extension
is not needed, as it is already assigned to the extension from
Cloudflare's IANA Private Enterprise Number (PEN) arc.<a class="pilcrow" href="#section-6-2">¶</a></p>
</section>
</div>
<div id="security-considerations">
<section id="section-7">
      <h2 id="name-security-considerations">
<a class="section-number selfRef" href="#section-7">7. </a><a class="section-name selfRef" href="#name-security-considerations">Security Considerations</a>
      </h2>
<p id="section-7-1">The security considerations documented in this section should be
taken into consideration when using delegated credentials.<a class="pilcrow" href="#section-7-1">¶</a></p>
<div id="security-of-delegated-credentials-private-key">
<section id="section-7.1">
        <h3 id="name-security-of-delegated-crede">
<a class="section-number selfRef" href="#section-7.1">7.1. </a><a class="section-name selfRef" href="#name-security-of-delegated-crede">Security of Delegated Credential's Private Key</a>
        </h3>
<p id="section-7.1-1">Delegated credentials limit the exposure of the private key used in
a (D)TLS connection by limiting its validity period.  An attacker who
compromises the private key of a delegated credential
cannot create new delegated credentials, but they can
impersonate the compromised party in new TLS connections until the
delegated credential expires.<a class="pilcrow" href="#section-7.1-1">¶</a></p>
<p id="section-7.1-2">Thus, delegated credentials should not be used to send a delegation to an untrusted party. Rather, they
are meant to be used between parties that have some trust relationship with each
other.  The secrecy of the delegated credential's private key is thus important, and
access control mechanisms <span class="bcp14">SHOULD</span> be used to protect it, including file system
controls, physical security, or hardware security modules.<a class="pilcrow" href="#section-7.1-2">¶</a></p>
</section>
</div>
<div id="re-use-of-delegated-credentials-in-multiple-contexts">
<section id="section-7.2">
        <h3 id="name-re-use-of-delegated-credent">
<a class="section-number selfRef" href="#section-7.2">7.2. </a><a class="section-name selfRef" href="#name-re-use-of-delegated-credent">Re-use of Delegated Credentials in Multiple Contexts</a>
        </h3>
<p id="section-7.2-1">It is not possible to use the same delegated credential for both client and server
authentication because issuing parties compute the corresponding signature using a context string unique to the intended role (client or server).<a class="pilcrow" href="#section-7.2-1">¶</a></p>
</section>
</div>
<div id="revocation-of-delegated-credentials">
<section id="section-7.3">
        <h3 id="name-revocation-of-delegated-cre">
<a class="section-number selfRef" href="#section-7.3">7.3. </a><a class="section-name selfRef" href="#name-revocation-of-delegated-cre">Revocation of Delegated Credentials</a>
        </h3>
<p id="section-7.3-1">Delegated credentials do not provide any additional form of early revocation.
Since it is short-lived, the expiry of the delegated credential revokes
the credential.  Revocation of the long-term private key that signs the
delegated credential (from the end-entity certificate) also implicitly revokes
the delegated credential.<a class="pilcrow" href="#section-7.3-1">¶</a></p>
</section>
</div>
<div id="interactions-with-session-resumption">
<section id="section-7.4">
        <h3 id="name-interactions-with-session-r">
<a class="section-number selfRef" href="#section-7.4">7.4. </a><a class="section-name selfRef" href="#name-interactions-with-session-r">Interactions with Session Resumption</a>
        </h3>
<p id="section-7.4-1">If a peer decides to cache the certificate chain and re-validate it
when resuming a connection, they <span class="bcp14">SHOULD</span> also cache the
associated delegated credential and re-validate it.  Failing to do so
may result in resuming connections for which the delegated credential has expired.<a class="pilcrow" href="#section-7.4-1">¶</a></p>
</section>
</div>
<div id="privacy-considerations">
<section id="section-7.5">
        <h3 id="name-privacy-considerations">
<a class="section-number selfRef" href="#section-7.5">7.5. </a><a class="section-name selfRef" href="#name-privacy-considerations">Privacy Considerations</a>
        </h3>
<p id="section-7.5-1">Delegated credentials can be valid for 7 days (by default), and it is much easier for a service to create delegated credentials than a certificate signed by a CA. A service could determine the client time and clock skew by creating several delegated credentials with different expiry timestamps and observing which credentials the client accepts. Since client time can be unique to a particular client, privacy-sensitive clients who do not trust the service, such as browsers in incognito mode, might not want to advertise support for delegated credentials, or might limit the number of probes that a server can perform.<a class="pilcrow" href="#section-7.5-1">¶</a></p>
</section>
</div>
<div id="the-impact-of-signature-forgery-attacks">
<section id="section-7.6">
        <h3 id="name-the-impact-of-signature-for">
<a class="section-number selfRef" href="#section-7.6">7.6. </a><a class="section-name selfRef" href="#name-the-impact-of-signature-for">The Impact of Signature Forgery Attacks</a>
        </h3>
<p id="section-7.6-1">Delegated credentials are only used in (D)TLS 1.3 connections. However, the certificate
that signs a delegated credential may be used in other contexts such as (D)TLS 1.2.
Using a certificate in multiple contexts opens up a potential cross-protocol
attack against delegated credentials in (D)TLS 1.3.<a class="pilcrow" href="#section-7.6-1">¶</a></p>
<p id="section-7.6-2">When (D)TLS 1.2 servers support RSA key exchange, they may be vulnerable to attacks
that allow forging an RSA signature over an arbitrary message <span>[<a class="cite xref" href="#BLEI">BLEI</a>]</span>.
The TLS 1.2 specification describes a strategy for preventing these attacks
 that requires careful implementation of timing-resistant countermeasures.
(See <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc5246#section-7.4.7.1">Section 7.4.7.1</a> of [<a class="cite xref" href="#RFC5246">RFC5246</a>]</span>.)<a class="pilcrow" href="#section-7.6-2">¶</a></p>
<p id="section-7.6-3">Experience shows that, in practice, server implementations may fail to fully
stop these attacks due to the complexity of this mitigation <span>[<a class="cite xref" href="#ROBOT">ROBOT</a>]</span>.
For (D)TLS 1.2 servers that support RSA key exchange using a DC-enabled end-entity
certificate, a hypothetical signature forgery attack would allow forging a
signature over a delegated credential.
The forged delegated credential could then be used by the attacker as the equivalent of an
on-path attacker, valid for a maximum of 7 days (if the default
valid_time is used).<a class="pilcrow" href="#section-7.6-3">¶</a></p>
<p id="section-7.6-4">Server operators should therefore minimize the risk of using DC-enabled
end-entity certificates where a signature forgery oracle may be present.
If possible, server operators may choose to use DC-enabled certificates only for signing
credentials and not for serving non-DC (D)TLS traffic.
Furthermore, server operators may use elliptic curve certificates for DC-enabled
traffic, while using RSA certificates without the DelegationUsage certificate
extension for non-DC traffic; this completely prevents such attacks.<a class="pilcrow" href="#section-7.6-4">¶</a></p>
<p id="section-7.6-5">Note that if a signature can be forged over an arbitrary credential, the
attacker can choose any value for the valid_time field.  Repeated signature
forgeries therefore allow the attacker to create multiple delegated
credentials that can cover the entire validity period of the
certificate.  Temporary exposure of the key or a signing oracle may
allow the attacker to impersonate a server for the lifetime of the certificate.<a class="pilcrow" href="#section-7.6-5">¶</a></p>
</section>
</div>
</section>
</div>
<section id="section-8">
      <h2 id="name-references">
<a class="section-number selfRef" href="#section-8">8. </a><a class="section-name selfRef" href="#name-references">References</a>
      </h2>
<section id="section-8.1">
        <h3 id="name-normative-references">
<a class="section-number selfRef" href="#section-8.1">8.1. </a><a class="section-name selfRef" href="#name-normative-references">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time class="refDate" datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5280">[RFC5280]</dt>
        <dd>
<span class="refAuthor">Cooper, D.</span>, <span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Boeyen, S.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time class="refDate" datetime="2008-05">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5280">https://www.rfc-editor.org/info/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time class="refDate" datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time class="refDate" datetime="2018-08">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9147">[RFC9147]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refAuthor">Tschofenig, H.</span>, and <span class="refAuthor">N. Modadugu</span>, <span class="refTitle">"The Datagram Transport Layer Security (DTLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 9147</span>, <span class="seriesInfo">DOI 10.17487/RFC9147</span>, <time class="refDate" datetime="2022-04">April 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9147">https://www.rfc-editor.org/info/rfc9147</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="X.680">[X.680]</dt>
        <dd>
<span class="refAuthor">ITU-T</span>, <span class="refTitle">"Information technology - Abstract Syntax Notation One (ASN.1): Specification of basic notation"</span>, <span class="seriesInfo">ISO/IEC 8824-1:2021</span>, <time class="refDate" datetime="2021-02">February 2021</time>, <span>&lt;<a href="https://www.itu.int/rec/T-REC-X.680">https://www.itu.int/rec/T-REC-X.680</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="X.690">[X.690]</dt>
      <dd>
<span class="refAuthor">ITU-T</span>, <span class="refTitle">"Information technology - ASN.1 encoding Rules: Specification of Basic Encoding Rules (BER), Canonical Encoding Rules (CER) and Distinguished Encoding Rules (DER)"</span>, <span class="seriesInfo">ISO/IEC 8825-1:2021</span>, <time class="refDate" datetime="2021-02">February 2021</time>, <span>&lt;<a href="https://www.itu.int/rec/T-REC-X.690">https://www.itu.int/rec/T-REC-X.690</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-8.2">
        <h3 id="name-informative-references">
<a class="section-number selfRef" href="#section-8.2">8.2. </a><a class="section-name selfRef" href="#name-informative-references">Informative References</a>
        </h3>
<dl class="references">
<dt id="BLEI">[BLEI]</dt>
        <dd>
<span class="refAuthor">Bleichenbacher, D.</span>, <span class="refTitle">"Chosen Ciphertext Attacks against Protocols Based on RSA Encryption Standard PKCS #1"</span>, <span class="refContent">Advances in Cryptology -- CRYPTO'98, LNCS vol. 1462, pages: 1-12</span>, <time class="refDate" datetime="1998">1998</time>, <span>&lt;<a href="https://link.springer.com/chapter/10.1007/BFb0055716">https://link.springer.com/chapter/10.1007/BFb0055716</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="KEYLESS">[KEYLESS]</dt>
        <dd>
<span class="refAuthor">Stebila, D.</span> and <span class="refAuthor">N. Sullivan</span>, <span class="refTitle">"An Analysis of TLS Handshake Proxying"</span>, <span class="refContent">IEEE Trustcom/BigDataSE/ISPA 2015</span>, <time class="refDate" datetime="2015">2015</time>, <span>&lt;<a href="https://ieeexplore.ieee.org/document/7345293">https://ieeexplore.ieee.org/document/7345293</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3820">[RFC3820]</dt>
        <dd>
<span class="refAuthor">Tuecke, S.</span>, <span class="refAuthor">Welch, V.</span>, <span class="refAuthor">Engert, D.</span>, <span class="refAuthor">Pearlman, L.</span>, and <span class="refAuthor">M. Thompson</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure (PKI) Proxy Certificate Profile"</span>, <span class="seriesInfo">RFC 3820</span>, <span class="seriesInfo">DOI 10.17487/RFC3820</span>, <time class="refDate" datetime="2004-06">June 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3820">https://www.rfc-editor.org/info/rfc3820</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5246">[RFC5246]</dt>
        <dd>
<span class="refAuthor">Dierks, T.</span> and <span class="refAuthor">E. Rescorla</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.2"</span>, <span class="seriesInfo">RFC 5246</span>, <span class="seriesInfo">DOI 10.17487/RFC5246</span>, <time class="refDate" datetime="2008-08">August 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5246">https://www.rfc-editor.org/info/rfc5246</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5912">[RFC5912]</dt>
        <dd>
<span class="refAuthor">Hoffman, P.</span> and <span class="refAuthor">J. Schaad</span>, <span class="refTitle">"New ASN.1 Modules for the Public Key Infrastructure Using X.509 (PKIX)"</span>, <span class="seriesInfo">RFC 5912</span>, <span class="seriesInfo">DOI 10.17487/RFC5912</span>, <time class="refDate" datetime="2010-06">June 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5912">https://www.rfc-editor.org/info/rfc5912</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8032">[RFC8032]</dt>
        <dd>
<span class="refAuthor">Josefsson, S.</span> and <span class="refAuthor">I. Liusvaara</span>, <span class="refTitle">"Edwards-Curve Digital Signature Algorithm (EdDSA)"</span>, <span class="seriesInfo">RFC 8032</span>, <span class="seriesInfo">DOI 10.17487/RFC8032</span>, <time class="refDate" datetime="2017-01">January 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8032">https://www.rfc-editor.org/info/rfc8032</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8555">[RFC8555]</dt>
        <dd>
<span class="refAuthor">Barnes, R.</span>, <span class="refAuthor">Hoffman-Andrews, J.</span>, <span class="refAuthor">McCarney, D.</span>, and <span class="refAuthor">J. Kasten</span>, <span class="refTitle">"Automatic Certificate Management Environment (ACME)"</span>, <span class="seriesInfo">RFC 8555</span>, <span class="seriesInfo">DOI 10.17487/RFC8555</span>, <time class="refDate" datetime="2019-03">March 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8555">https://www.rfc-editor.org/info/rfc8555</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ROBOT">[ROBOT]</dt>
        <dd>
<span class="refAuthor">Boeck, H.</span>, <span class="refAuthor">Somorovsky, J.</span>, and <span class="refAuthor">C. Young</span>, <span class="refTitle">"Return Of Bleichenbacher's Oracle Threat (ROBOT)"</span>, <span class="refContent">27th USENIX Security Symposium</span>, <time class="refDate" datetime="2018">2018</time>, <span>&lt;<a href="https://www.usenix.org/conference/usenixsecurity18/presentation/bock">https://www.usenix.org/conference/usenixsecurity18/presentation/bock</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="XPROT">[XPROT]</dt>
      <dd>
<span class="refAuthor">Jager, T.</span>, <span class="refAuthor">Schwenk, J.</span>, and <span class="refAuthor">J. Somorovsky</span>, <span class="refTitle">"On the Security of TLS 1.3 and QUIC Against Weaknesses in PKCS#1 v1.5 Encryption"</span>, <span class="refContent">Proceedings of the 22nd ACM SIGSAC Conference on Computer and Communications Security</span>, <time class="refDate" datetime="2015">2015</time>, <span>&lt;<a href="https://dl.acm.org/doi/10.1145/2810103.2813657">https://dl.acm.org/doi/10.1145/2810103.2813657</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="module">
<section id="appendix-A">
      <h2 id="name-asn1-module">
<a class="section-number selfRef" href="#appendix-A">Appendix A. </a><a class="section-name selfRef" href="#name-asn1-module">ASN.1 Module</a>
      </h2>
<p id="appendix-A-1">The following ASN.1 module provides the complete definition of the
DelegationUsage certificate extension.  The ASN.1 module makes imports
from <span>[<a class="cite xref" href="#RFC5912">RFC5912</a>]</span>.<a class="pilcrow" href="#appendix-A-1">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A-2">
<pre>DelegatedCredentialExtn
  { iso(1) identified-organization(3) dod(6) internet(1)
    security(5) mechanisms(5) pkix(7) id-mod(0)
    id-mod-delegated-credential-extn(95) }

DEFINITIONS IMPLICIT TAGS ::=
BEGIN

-- EXPORT ALL

IMPORTS

EXTENSION
  FROM PKIX-CommonTypes-2009 -- From RFC 5912
  { iso(1) identified-organization(3) dod(6) internet(1)
    security(5) mechanisms(5) pkix(7) id-mod(0)
    id-mod-pkixCommon-02(57) } ;

-- OID

id-cloudflare OBJECT IDENTIFIER ::=
  { iso(1) identified-organization(3) dod(6) internet(1) private(4)
    enterprise(1) 44363 }

-- EXTENSION

ext-delegationUsage EXTENSION ::=
  { SYNTAX DelegationUsage
    IDENTIFIED BY id-pe-delegationUsage }

id-pe-delegationUsage OBJECT IDENTIFIER ::= { id-cloudflare 44 }

DelegationUsage ::= NULL

END
</pre><a class="pilcrow" href="#appendix-A-2">¶</a>
</div>
</section>
</div>
<div id="example-certificate">
<section id="appendix-B">
      <h2 id="name-example-certificate">
<a class="section-number selfRef" href="#appendix-B">Appendix B. </a><a class="section-name selfRef" href="#name-example-certificate">Example Certificate</a>
      </h2>
<p id="appendix-B-1">The following is an example of a delegation certificate that satisfies the
requirements described in <a class="auto internal xref" href="#certificate-requirements">Section 4.2</a> (i.e., uses the DelegationUsage extension
and has the digitalSignature KeyUsage).<a class="pilcrow" href="#appendix-B-1">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B-2">
<pre>-----BEGIN CERTIFICATE-----
MIIFRjCCBMugAwIBAgIQDGevB+lY0o/OecHFSJ6YnTAKBggqhkjOPQQDAzBMMQsw
CQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5jMSYwJAYDVQQDEx1EaWdp
Q2VydCBFQ0MgU2VjdXJlIFNlcnZlciBDQTAeFw0xOTAzMjYwMDAwMDBaFw0yMTAz
MzAxMjAwMDBaMGoxCzAJBgNVBAYTAlVTMRMwEQYDVQQIEwpDYWxpZm9ybmlhMRYw
FAYDVQQHEw1TYW4gRnJhbmNpc2NvMRkwFwYDVQQKExBDbG91ZGZsYXJlLCBJbmMu
MRMwEQYDVQQDEwprYzJrZG0uY29tMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE
d4azI83Bw0fcPgfoeiZpZZnwGuxjBjv++wzE0zAj8vNiUkKxOWSQiGNLn+xlWUpL
lw9djRN1rLmVmn2gb9GgdKOCA28wggNrMB8GA1UdIwQYMBaAFKOd5h/52jlPwG7o
kcuVpdox4gqfMB0GA1UdDgQWBBSfcb7fS3fUFAyB91fRcwoDPtgtJjAjBgNVHREE
HDAaggprYzJrZG0uY29tggwqLmtjMmtkbS5jb20wDgYDVR0PAQH/BAQDAgeAMB0G
A1UdJQQWMBQGCCsGAQUFBwMBBggrBgEFBQcDAjBpBgNVHR8EYjBgMC6gLKAqhiho
dHRwOi8vY3JsMy5kaWdpY2VydC5jb20vc3NjYS1lY2MtZzEuY3JsMC6gLKAqhiho
dHRwOi8vY3JsNC5kaWdpY2VydC5jb20vc3NjYS1lY2MtZzEuY3JsMEwGA1UdIARF
MEMwNwYJYIZIAYb9bAEBMCowKAYIKwYBBQUHAgEWHGh0dHBzOi8vd3d3LmRpZ2lj
ZXJ0LmNvbS9DUFMwCAYGZ4EMAQICMHsGCCsGAQUFBwEBBG8wbTAkBggrBgEFBQcw
AYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tMEUGCCsGAQUFBzAChjlodHRwOi8v
Y2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRFQ0NTZWN1cmVTZXJ2ZXJDQS5j
cnQwDAYDVR0TAQH/BAIwADAPBgkrBgEEAYLaSywEAgUAMIIBfgYKKwYBBAHWeQIE
AgSCAW4EggFqAWgAdgC72d+8H4pxtZOUI5eqkntHOFeVCqtS6BqQlmQ2jh7RhQAA
AWm5hYJ5AAAEAwBHMEUCICiGfq+hSThRL2m8H0awoDR8OpnEHNkF0nI6nL5yYL/j
AiEAxwebGs/T6Es0YarPzoQJrVZqk+sHH/t+jrSrKd5TDjcAdgCHdb/nWXz4jEOZ
X73zbv9WjUdWNv9KtWDBtOr/XqCDDwAAAWm5hYNgAAAEAwBHMEUCIQD9OWA8KGL6
bxDKfgIleHJWB0iWieRs88VgJyfAg/aFDgIgQ/OsdSF9XOy1foqge0DTDM2FExuw
0JR0AGZWXoNtJzMAdgBElGUusO7Or8RAB9io/ijA2uaCvtjLMbU/0zOWtbaBqAAA
AWm5hYHgAAAEAwBHMEUCIQC4vua1n3BqthEqpA/VBTcsNwMtAwpCuac2IhJ9wx6X
/AIgb+o00k28JQo9TMpP4vzJ3BD3HXWSNc2Zizbq7mkUQYMwCgYIKoZIzj0EAwMD
aQAwZgIxAJsX7d0SuA8ddf/m7IWfNfs3MQfJyGkEezMJX1t6sRso5z50SS12LpXe
muGa1FE2ZgIxAL+CDUF5pz7mhrAEIjQ1MqlpF9tH40dJGvYZZQ3W23cMzSkDfvlt
y5S4RfWHIIPjbw==
-----END CERTIFICATE-----
</pre><a class="pilcrow" href="#appendix-B-2">¶</a>
</div>
</section>
</div>
<div id="acknowledgements">
<section id="appendix-C">
      <h2 id="name-acknowledgements">
<a class="section-name selfRef" href="#name-acknowledgements">Acknowledgements</a>
      </h2>
<p id="appendix-C-1">Thanks to David Benjamin, Christopher Patton, Kyle Nekritz, Anirudh Ramachandran, Benjamin
Kaduk, 奥 一穂 (Kazuho Oku), Daniel Kahn Gillmor, Watson Ladd, Robert Merget, Juraj
Somorovsky, and Nimrod Aviram for their discussions, ideas,
and bugs they have found.<a class="pilcrow" href="#appendix-C-1">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-D">
      <h2 id="name-authors-addresses">
<a class="section-name selfRef" href="#name-authors-addresses">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Richard Barnes</span></div>
<div class="left" dir="auto"><span class="org">Cisco</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:rlb@ipv.sx">rlb@ipv.sx</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Subodh Iyengar</span></div>
<div class="left" dir="auto"><span class="org">Facebook</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:subodh@fb.com">subodh@fb.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Nick Sullivan</span></div>
<div class="left" dir="auto"><span class="org">Cloudflare</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:nick@cloudflare.com">nick@cloudflare.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Eric Rescorla</span></div>
<div class="left" dir="auto"><span class="org">Windy Hill Systems, LLC</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:ekr@rtfm.com">ekr@rtfm.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>


</body></html>