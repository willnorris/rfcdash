<html><head></head><body><pre>Network Working Group                                          J. Lennox
Request for Comments: 4572                                   Columbia U.
Updates: <a href="./rfc4145">4145</a>                                                  July 2006
Category: Standards Track


 <span class="h1">Connection-Oriented Media Transport over the Transport Layer Security</span>
        <span class="h1">(TLS) Protocol in the Session Description Protocol (SDP)</span>

Status of This Memo

   This document specifies an Internet standards track protocol for the
   Internet community, and requests discussion and suggestions for
   improvements.  Please refer to the current edition of the "Internet
   Official Protocol Standards" (STD 1) for the standardization state
   and status of this protocol.  Distribution of this memo is unlimited.

Copyright Notice

   Copyright (C) The Internet Society (2006).

Abstract

   This document specifies how to establish secure connection-oriented
   media transport sessions over the Transport Layer Security (TLS)
   protocol using the Session Description Protocol (SDP).  It defines a
   new SDP protocol identifier, 'TCP/TLS'.  It also defines the syntax
   and semantics for an SDP 'fingerprint' attribute that identifies the
   certificate that will be presented for the TLS session.  This
   mechanism allows media transport over TLS connections to be
   established securely, so long as the integrity of session
   descriptions is assured.

   This document extends and updates <a href="./rfc4145">RFC 4145</a>.

















<span class="grey">Lennox                      Standards Track                     [Page 1]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-2"></span>
<span class="grey"><a href="./rfc4572">RFC 4572</a>                Comedia over TLS in SDP                July 2006</span>


Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-3">3</a>
   <a href="#section-2">2</a>. Terminology .....................................................<a href="#page-4">4</a>
   <a href="#section-3">3</a>. Overview ........................................................<a href="#page-4">4</a>
      <a href="#section-3.1">3.1</a>. SDP Operational Modes ......................................<a href="#page-4">4</a>
      <a href="#section-3.2">3.2</a>. Threat Model ...............................................<a href="#page-5">5</a>
      <a href="#section-3.3">3.3</a>. The Need for Self-Signed Certificates ......................<a href="#page-5">5</a>
      <a href="#section-3.4">3.4</a>. Example SDP Description for TLS Connection .................<a href="#page-6">6</a>
   <a href="#section-4">4</a>. Protocol Identifiers ............................................<a href="#page-6">6</a>
   <a href="#section-5">5</a>. Fingerprint Attribute ...........................................<a href="#page-7">7</a>
   <a href="#section-6">6</a>. Endpoint Identification .........................................<a href="#page-9">9</a>
      <a href="#section-6.1">6.1</a>. Certificate Choice .........................................<a href="#page-9">9</a>
      <a href="#section-6.2">6.2</a>. Certificate Presentation ..................................<a href="#page-10">10</a>
   <a href="#section-7">7</a>. Security Considerations ........................................<a href="#page-10">10</a>
   <a href="#section-8">8</a>. IANA Considerations ............................................<a href="#page-12">12</a>
   <a href="#section-9">9</a>. References .....................................................<a href="#page-14">14</a>
      <a href="#section-9.1">9.1</a>. Normative References ......................................<a href="#page-14">14</a>
      <a href="#section-9.2">9.2</a>. Informative References ....................................<a href="#page-15">15</a>
































<span class="grey">Lennox                      Standards Track                     [Page 2]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-3"></span>
<span class="grey"><a href="./rfc4572">RFC 4572</a>                Comedia over TLS in SDP                July 2006</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" id="section-1">1</a>.  Introduction</span>

   The Session Description Protocol (SDP) [<a href="#ref-1" title='"SDP: Session Description Protocol"'>1</a>] provides a general-purpose
   format for describing multimedia sessions in announcements or
   invitations.  For many applications, it is desirable to establish, as
   part of a multimedia session, a media stream that uses a connection-
   oriented transport.  <a href="./rfc4145">RFC 4145</a>, Connection-Oriented Media Transport in
   the Session Description Protocol (SDP) [<a href="#ref-2" title='"TCP-Based Media Transport in the Session Description Protocol (SDP)"'>2</a>], specifies a general
   mechanism for describing and establishing such connection-oriented
   streams; however, the only transport protocol it directly supports is
   TCP.  In many cases, session participants wish to provide
   confidentiality, data integrity, and authentication for their media
   sessions.  This document therefore extends the Connection-Oriented
   Media specification to allow session descriptions to describe media
   sessions that use the Transport Layer Security (TLS) protocol [<a href="#ref-3" title='"The Transport Layer Security (TLS) Protocol Version 1.1"'>3</a>].

   The TLS protocol allows applications to communicate over a channel
   that provides confidentiality and data integrity.  The TLS
   specification, however, does not specify how specific protocols
   establish and use this secure channel; particularly, TLS leaves the
   question of how to interpret and validate authentication certificates
   as an issue for the protocols that run over TLS.  This document
   specifies such usage for the case of connection-oriented media
   transport.

   Complicating this issue, endpoints exchanging media will often be
   unable to obtain authentication certificates signed by a well-known
   root certification authority (CA).  Most certificate authorities
   charge for signed certificates, particularly host-based certificates;
   additionally, there is a substantial administrative overhead to
   obtaining signed certificates, as certification authorities must be
   able to confirm that they are issuing the signed certificates to the
   correct party.  Furthermore, in many cases endpoints' IP addresses
   and host names are dynamic: they may be obtained from DHCP, for
   example.  It is impractical to obtain a CA-signed certificate valid
   for the duration of a DHCP lease.  For such hosts, self-signed
   certificates are usually the only option.  This specification defines
   a mechanism that allows self-signed certificates can be used
   securely, provided that the integrity of the SDP description is
   assured.  It provides for endpoints to include a secure hash of their
   certificate, known as the "certificate fingerprint", within the
   session description.  Provided that the fingerprint of the offered
   certificate matches the one in the session description, end hosts can
   trust even self-signed certificates.

   The rest of this document is laid out as follows.  An overview of the
   problem and threat model is given in <a href="#section-3">Section 3</a>.  <a href="#section-4">Section 4</a> gives the
   basic mechanism for establishing TLS-based connected-oriented media



<span class="grey">Lennox                      Standards Track                     [Page 3]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-4"></span>
<span class="grey"><a href="./rfc4572">RFC 4572</a>                Comedia over TLS in SDP                July 2006</span>


   in SDP.  <a href="#section-5">Section 5</a> describes the SDP fingerprint attribute, which,
   assuming that the integrity of SDP content is assured, allows the
   secure use of self-signed certificates.  <a href="#section-6">Section 6</a> describes which
   X.509 certificates are presented, and how they are used in TLS.
   <a href="#section-7">Section 7</a> discusses additional security considerations.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/2.%20%20Terminology"></a><a class="selflink" href="#section-2" id="section-2">2</a>.  Terminology</span>

   In this document, the key words "MUST", "MUST NOT", "REQUIRED",
   "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY",
   and "OPTIONAL" are to be interpreted as described in <a href="./rfc2119">RFC 2119</a> [<a href="#ref-4" title='"Key words for use in RFCs to Indicate Requirement Levels"'>4</a>] and
   indicate requirement levels for compliant implementations.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.%20%20Overview"></a><a class="selflink" href="#section-3" id="section-3">3</a>.  Overview</span>

   This section discusses the threat model that motivates TLS transport
   for connection-oriented media streams.  It also discusses in more
   detail the need for end systems to use self-signed certificates.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.1.%20%20SDP%20Operational%20Modes"></a><a class="selflink" href="#section-3.1" id="section-3.1">3.1</a>.  SDP Operational Modes</span>

   There are two principal operational modes for multimedia sessions:
   advertised and offer-answer.  Advertised sessions are the simpler
   mode.  In this mode, a server publishes, in some manner, an SDP
   session description of a multimedia session it is making available.
   The classic example of this mode of operation is the Session
   Announcement Protocol (SAP) [<a href="#ref-15" title='"Session Announcement Protocol"'>15</a>], in which SDP session descriptions
   are periodically transmitted to a well-known multicast group.
   Traditionally, these descriptions involve multicast conferences, but
   unicast sessions are also possible.  (Connection-oriented media,
   obviously, cannot use multicast.)  Recipients of a session
   description connect to the addresses published in the session
   description.  These recipients may not previously have been known to
   the advertiser of the session description.

   Alternatively, SDP conferences can operate in offer-answer mode [<a href="#ref-5" title='"An Offer/Answer Model with Session Description Protocol (SDP)"'>5</a>].
   This mode allows two participants in a multimedia session to
   negotiate the multimedia session between them.  In this model, one
   participant offers the other a description of the desired session
   from its perspective, and the other participant answers with the
   desired session from its own perspective.  In this mode, each of the
   participants in the session has knowledge of the other one.  This is
   the mode of operation used by the Session Initiation Protocol (SIP)
   [<a href="#ref-16" title='"SIP: Session Initiation Protocol"'>16</a>].







<span class="grey">Lennox                      Standards Track                     [Page 4]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-5"></span>
<span class="grey"><a href="./rfc4572">RFC 4572</a>                Comedia over TLS in SDP                July 2006</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.2.%20%20Threat%20Model"></a><a class="selflink" href="#section-3.2" id="section-3.2">3.2</a>.  Threat Model</span>

   Participants in multimedia conferences often wish to guarantee
   confidentiality, data integrity, and authentication for their media
   sessions.  This section describes various types of attackers and the
   ways they attempt to violate these guarantees.  It then describes how
   the TLS protocol can be used to thwart the attackers.

   The simplest type of attacker is one who listens passively to the
   traffic associated with a multimedia session.  This attacker might,
   for example, be on the same local-area or wireless network as one of
   the participants in a conference.  This sort of attacker does not
   threaten a connection's data integrity or authentication, and almost
   any operational mode of TLS can provide media stream confidentiality.

   More sophisticated is an attacker who can send his own data traffic
   over the network, but who cannot modify or redirect valid traffic.
   In SDP's 'advertised' operational mode, this can barely be considered
   an attack; media sessions are expected to be initiated from anywhere
   on the network.  In SDP's offer-answer mode, however, this type of
   attack is more serious.  An attacker could initiate a connection to
   one or both of the endpoints of a session, thus impersonating an
   endpoint, or acting as a man in the middle to listen in on their
   communications.  To thwart these attacks, TLS uses endpoint
   certificates.  So long as the certificates' private keys have not
   been compromised, the endpoints have an external trusted mechanism
   (most commonly, a mutually-trusted certification authority) to
   validate certificates, and the endpoints know what certificate
   identity to expect, endpoints can be certain that such an attack has
   not taken place.

   Finally, the most serious type of attacker is one who can modify or
   redirect session descriptions: for example, a compromised or
   malicious SIP proxy server.  Neither TLS itself nor any mechanisms
   that use it can protect an SDP session against such an attacker.
   Instead, the SDP description itself must be secured through some
   mechanism; SIP, for example, defines how S/MIME [<a href="#ref-17" title='"Secure/Multipurpose Internet Mail Extensions (S/MIME) Version 3.1 Message Specification"'>17</a>] can be used to
   secure session descriptions.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.3.%20%20The%20Need%20for%20Self-Signed%20Certificates"></a><a class="selflink" href="#section-3.3" id="section-3.3">3.3</a>.  The Need for Self-Signed Certificates</span>

   SDP session descriptions are created by any endpoint that needs to
   participate in a multimedia session.  In many cases, such as SIP
   phones, such endpoints have dynamically-configured IP addresses and
   host names and must be deployed with nearly zero configuration.  For
   such an endpoint, it is for practical purposes impossible to obtain a
   certificate signed by a well-known certification authority.




<span class="grey">Lennox                      Standards Track                     [Page 5]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-6"></span>
<span class="grey"><a href="./rfc4572">RFC 4572</a>                Comedia over TLS in SDP                July 2006</span>


   If two endpoints have no prior relationship, self-signed certificates
   cannot generally be trusted, as there is no guarantee that an
   attacker is not launching a man-in-the-middle attack.  Fortunately,
   however, if the integrity of SDP session descriptions can be assured,
   it is possible to consider those SDP descriptions themselves as a
   prior relationship: certificates can be securely described in the
   session description itself.  This is done by providing a secure hash
   of a certificate, or "certificate fingerprint", as an SDP attribute;
   this mechanism is described in <a href="#section-5">Section 5</a>.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.4.%20%20Example%20SDP%20Description%20for%20TLS%20Connection"></a><a class="selflink" href="#section-3.4" id="section-3.4">3.4</a>.  Example SDP Description for TLS Connection</span>

   Figure 1 illustrates an SDP offer that signals the availability of a
   T.38 fax session over TLS.  For the purpose of brevity, the main
   portion of the session description is omitted in the example, showing
   only the 'm' line and its attributes.  (This example is the same as
   the first one in <a href="./rfc4145">RFC 4145</a> [<a href="#ref-2" title='"TCP-Based Media Transport in the Session Description Protocol (SDP)"'>2</a>], except for the proto parameter and the
   fingerprint attribute.)  See the subsequent sections for explanations
   of the example's TLS-specific attributes.

   (Note: due to RFC formatting conventions, this document splits SDP
   across lines whose content would exceed 72 characters.  A backslash
   character marks where this line folding has taken place.  This
   backslash and its trailing CRLF and whitespace would not appear in
   actual SDP content.)

   m=image 54111 TCP/TLS t38
   c=IN IP4 192.0.2.2
   a=setup:passive
   a=connection:new
   a=fingerprint:SHA-1 \
          4A:AD:B9:B1:3F:82:18:3B:54:02:12:DF:3E:5D:49:6B:19:E5:7C:AB

       Figure 1: Example SDP Description Offering a TLS Media Stream

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/4.%20%20Protocol%20Identifiers"></a><a class="selflink" href="#section-4" id="section-4">4</a>.  Protocol Identifiers</span>

   The 'm' line in SDP specifies, among other items, the transport
   protocol to be used for the media in the session.  See the "Media
   Descriptions" section of SDP [<a href="#ref-1" title='"SDP: Session Description Protocol"'>1</a>] for a discussion on transport
   protocol identifiers.

   This specification defines a new protocol identifier, 'TCP/TLS',
   which indicates that the media described will use the Transport Layer
   Security protocol [<a href="#ref-3" title='"The Transport Layer Security (TLS) Protocol Version 1.1"'>3</a>] over TCP.  (Using TLS over other transport
   protocols is not discussed in this document.)  The 'TCP/TLS' protocol
   identifier describes only the transport protocol, not the upper-layer
   protocol.  An 'm' line that specifies 'TCP/TLS' MUST further qualify



<span class="grey">Lennox                      Standards Track                     [Page 6]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-7"></span>
<span class="grey"><a href="./rfc4572">RFC 4572</a>                Comedia over TLS in SDP                July 2006</span>


   the protocol using a fmt identifier to indicate the application being
   run over TLS.

   Media sessions described with this identifier follow the procedures
   defined in <a href="./rfc4145">RFC 4145</a> [<a href="#ref-2" title='"TCP-Based Media Transport in the Session Description Protocol (SDP)"'>2</a>].  They also use the SDP attributes defined in
   that specification, 'setup' and 'connection'.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.%20%20Fingerprint%20Attribute"></a><a class="selflink" href="#section-5" id="section-5">5</a>.  Fingerprint Attribute</span>

   Parties to a TLS session indicate their identities by presenting
   authentication certificates as part of the TLS handshake procedure.
   Authentication certificates are X.509 [<a href="#ref-6" title='"Information technology - Open Systems Interconnection - The Directory: Public-key and attribute certificate frameworks"'>6</a>] certificates, as profiled
   by <a href="./rfc3279">RFC 3279</a> [<a href="#ref-7" title='"Algorithms and Identifiers for the Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"'>7</a>], <a href="./rfc3280">RFC 3280</a> [<a href="#ref-8" title='"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"'>8</a>], and <a href="./rfc4055">RFC 4055</a> [<a href="#ref-9" title='"Additional Algorithms and Identifiers for RSA Cryptography for use in the Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"'>9</a>].

   In order to associate media streams with connections and to prevent
   unauthorized barge-in attacks on the media streams, endpoints MUST
   provide a certificate fingerprint.  If the X.509 certificate
   presented for the TLS connection matches the fingerprint presented in
   the SDP, the endpoint can be confident that the author of the SDP is
   indeed the initiator of the connection.

   A certificate fingerprint is a secure one-way hash of the DER
   (distinguished encoding rules) form of the certificate.  (Certificate
   fingerprints are widely supported by tools that manipulate X.509
   certificates; for instance, the command "openssl x509 -fingerprint"
   causes the command-line tool of the openssl package to print a
   certificate fingerprint, and the certificate managers for Mozilla and
   Internet Explorer display them when viewing the details of a
   certificate.)

   A fingerprint is represented in SDP as an attribute (an 'a' line).
   It consists of the name of the hash function used, followed by the
   hash value itself.  The hash value is represented as a sequence of
   uppercase hexadecimal bytes, separated by colons.  The number of
   bytes is defined by the hash function.  (This is the syntax used by
   openssl and by the browsers' certificate managers.  It is different
   from the syntax used to represent hash values in, e.g., HTTP digest
   authentication [<a href="#ref-18" title='"HTTP Authentication: Basic and Digest Access Authentication"'>18</a>], which uses unseparated lowercase hexadecimal
   bytes.  It was felt that consistency with other applications of
   fingerprints was more important.)

   The formal syntax of the fingerprint attribute is given in Augmented
   Backus-Naur Form [<a href="#ref-10" title='"Augmented BNF for Syntax Specifications: ABNF"'>10</a>] in Figure 2.  This syntax extends the BNF
   syntax of SDP [<a href="#ref-1" title='"SDP: Session Description Protocol"'>1</a>].







<span class="grey">Lennox                      Standards Track                     [Page 7]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-8"></span>
<span class="grey"><a href="./rfc4572">RFC 4572</a>                Comedia over TLS in SDP                July 2006</span>


   attribute              =/ fingerprint-attribute

   fingerprint-attribute  =  "fingerprint" ":" hash-func SP fingerprint

   hash-func              =  "sha-1" / "sha-224" / "sha-256" /
                             "sha-384" / "sha-512" /
                             "md5" / "md2" / token
                             ; Additional hash functions can only come
                             ; from updates to <a href="./rfc3279">RFC 3279</a>

   fingerprint            =  2UHEX *(":" 2UHEX)
                             ; Each byte in upper-case hex, separated
                             ; by colons.

   UHEX                   =  DIGIT / %x41-46 ; A-F uppercase

   Figure 2: Augmented Backus-Naur Syntax for the Fingerprint Attribute

   A certificate fingerprint MUST be computed using the same one-way
   hash function as is used in the certificate's signature algorithm.
   (This ensures that the security properties required for the
   certificate also apply for the fingerprint.  It also guarantees that
   the fingerprint will be usable by the other endpoint, so long as the
   certificate itself is.)  Following <a href="./rfc3279">RFC 3279</a> [<a href="#ref-7" title='"Algorithms and Identifiers for the Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"'>7</a>] as updated by <a href="./rfc4055">RFC</a>
   <a href="./rfc4055">4055</a> [<a href="#ref-9" title='"Additional Algorithms and Identifiers for RSA Cryptography for use in the Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"'>9</a>], therefore, the defined hash functions are 'SHA-1' [<a href="#ref-11" title='"Secure Hash Standard"'>11</a>]
   [<a href="#ref-19" title='"US Secure Hash Algorithm 1 (SHA1)"'>19</a>], 'SHA-224' [<a href="#ref-11" title='"Secure Hash Standard"'>11</a>], 'SHA-256' [<a href="#ref-11" title='"Secure Hash Standard"'>11</a>], 'SHA-384' [<a href="#ref-11" title='"Secure Hash Standard"'>11</a>], 'SHA-512' [<a href="#ref-11" title='"Secure Hash Standard"'>11</a>],
   'MD5' [<a href="#ref-12" title='"The MD5 Message-Digest Algorithm"'>12</a>], and 'MD2' [<a href="#ref-13" title='"The MD2 Message-Digest Algorithm"'>13</a>], with 'SHA-1' preferred.  A new IANA
   registry of Hash Function Textual Names, specified in <a href="#section-8">Section 8</a>,
   allows for addition of future tokens, but they may only be added if
   they are included in RFCs that update or obsolete <a href="./rfc3279">RFC 3279</a> [<a href="#ref-7" title='"Algorithms and Identifiers for the Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"'>7</a>].
   Self-signed certificates (for which legacy certificates are not a
   consideration) MUST use one of the FIPS 180 algorithms (SHA-1,
   SHA-224, SHA-256, SHA-384, or SHA-512) as their signature algorithm,
   and thus also MUST use it to calculate certificate fingerprints.

   The fingerprint attribute may be either a session-level or a media-
   level SDP attribute.  If it is a session-level attribute, it applies
   to all TLS sessions for which no media-level fingerprint attribute is
   defined.












<span class="grey">Lennox                      Standards Track                     [Page 8]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-9"></span>
<span class="grey"><a href="./rfc4572">RFC 4572</a>                Comedia over TLS in SDP                July 2006</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/6.%20%20Endpoint%20Identification"></a><a class="selflink" href="#section-6" id="section-6">6</a>.  Endpoint Identification</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/6.1.%20%20Certificate%20Choice"></a><a class="selflink" href="#section-6.1" id="section-6.1">6.1</a>.  Certificate Choice</span>

   An X.509 certificate binds an identity and a public key.  If SDP
   describing a TLS session is transmitted over a mechanism that
   provides integrity protection, a certificate asserting any
   syntactically valid identity MAY be used.  For example, an SDP
   description sent over HTTP/TLS [<a href="#ref-20" title='"HTTP Over TLS"'>20</a>] or secured by S/MIME [<a href="#ref-17" title='"Secure/Multipurpose Internet Mail Extensions (S/MIME) Version 3.1 Message Specification"'>17</a>] MAY
   assert any identity in the certificate securing the media connection.

   Security protocols that provide only hop-by-hop integrity protection
   (e.g., the sips protocol [<a href="#ref-16" title='"SIP: Session Initiation Protocol"'>16</a>], SIP over TLS) are considered
   sufficiently secure to allow the mode in which any valid identity is
   accepted.  However, see <a href="#section-7">Section 7</a> for a discussion of some security
   implications of this fact.

   In situations where the SDP is not integrity-protected, however, the
   certificate provided for a TLS connection MUST certify an appropriate
   identity for the connection.  In these scenarios, the certificate
   presented by an endpoint MUST certify either the SDP connection
   address, or the identity of the creator of the SDP message, as
   follows:

   o  If the connection address for the media description is specified
      as an IP address, the endpoint MAY use a certificate with an
      iPAddress subjectAltName that exactly matches the IP in the
      connection-address in the session description's 'c' line.
      Similarly, if the connection address for the media description is
      specified as a fully-qualified domain name, the endpoint MAY use a
      certificate with a dNSName subjectAltName matching the specified
      'c' line connection-address exactly.  (Wildcard patterns MUST NOT
      be used.)

   o  Alternately, if the SDP session description of the session was
      transmitted over a protocol (such as SIP [<a href="#ref-16" title='"SIP: Session Initiation Protocol"'>16</a>]) for which the
      identities of session participants are defined by uniform resource
      identifiers (URIs), the endpoint MAY use a certificate with a
      uniformResourceIdentifier subjectAltName corresponding to the
      identity of the endpoint that generated the SDP.  The details of
      what URIs are valid are dependent on the transmitting protocol.
      (For more details on the validity of URIs, see <a href="#section-7">Section 7</a>.)

   Identity matching is performed using the matching rules specified by
   <a href="./rfc3280">RFC 3280</a> [<a href="#ref-8" title='"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"'>8</a>].  If more than one identity of a given type is present
   in the certificate (e.g., more than one dNSName name), a match in any
   one of the set is considered acceptable.  To support the use of
   certificate caches, as described in <a href="#section-7">Section 7</a>, endpoints SHOULD



<span class="grey">Lennox                      Standards Track                     [Page 9]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-10"></span>
<span class="grey"><a href="./rfc4572">RFC 4572</a>                Comedia over TLS in SDP                July 2006</span>


   consistently provide the same certificate for each identity they
   support.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/6.2.%20%20Certificate%20Presentation"></a><a class="selflink" href="#section-6.2" id="section-6.2">6.2</a>.  Certificate Presentation</span>

   In all cases, an endpoint acting as the TLS server (i.e., one taking
   the 'setup:passive' role, in the terminology of connection-oriented
   media) MUST present a certificate during TLS initiation, following
   the rules presented in <a href="#section-6.1">Section 6.1</a>.  If the certificate does not
   match the original fingerprint, the client endpoint MUST terminate
   the media connection with a bad_certificate error.

   If the SDP offer/answer model [<a href="#ref-5" title='"An Offer/Answer Model with Session Description Protocol (SDP)"'>5</a>] is being used, the client (the
   endpoint with the 'setup:active' role) MUST also present a
   certificate following the rules of <a href="#section-6.1">Section 6.1</a>.  The server MUST
   request a certificate, and if the client does not provide one, or if
   the certificate does not match the provided fingerprint, the server
   endpoint MUST terminate the media connection with a bad_certificate
   error.

   Note that when the offer/answer model is being used, it is possible
   for a media connection to outrace the answer back to the offerer.
   Thus, if the offerer has offered a 'setup:passive' or 'setup:actpass'
   role, it MUST (as specified in <a href="./rfc4145">RFC 4145</a> [<a href="#ref-2" title='"TCP-Based Media Transport in the Session Description Protocol (SDP)"'>2</a>]) begin listening for an
   incoming connection as soon as it sends its offer.  However, it MUST
   NOT assume that the data transmitted over the TLS connection is valid
   until it has received a matching fingerprint in an SDP answer.  If
   the fingerprint, once it arrives, does not match the client's
   certificate, the server endpoint MUST terminate the media connection
   with a bad_certificate error, as stated in the previous paragraph.

   If offer/answer is not being used (e.g., if the SDP was sent over the
   Session Announcement Protocol [<a href="#ref-15" title='"Session Announcement Protocol"'>15</a>]), there is no secure channel
   available for clients to communicate certificate fingerprints to
   servers.  In this case, servers MAY request client certificates,
   which SHOULD be signed by a well-known certification authority, or
   MAY allow clients to connect without a certificate.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/7.%20%20Security%20Considerations"></a><a class="selflink" href="#section-7" id="section-7">7</a>.  Security Considerations</span>

   This entire document concerns itself with security.  The problem to
   be solved is addressed in <a href="#section-1">Section 1</a>, and a high-level overview is
   presented in <a href="#section-3">Section 3</a>.  See the SDP specification [<a href="#ref-1" title='"SDP: Session Description Protocol"'>1</a>] for security
   considerations applicable to SDP in general.

   Offering a TCP/TLS connection in SDP (or agreeing to one in SDP
   offer/answer mode) does not create an obligation for an endpoint to
   accept any TLS connection with the given fingerprint.  Instead, the



<span class="grey">Lennox                      Standards Track                    [Page 10]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-11"></span>
<span class="grey"><a href="./rfc4572">RFC 4572</a>                Comedia over TLS in SDP                July 2006</span>


   endpoint must engage in the standard TLS negotiation procedure to
   ensure that the TLS stream cipher and MAC algorithm chosen meet the
   security needs of the higher-level application.  (For example, an
   offered stream cipher of TLS_NULL_WITH_NULL_NULL SHOULD be rejected
   in almost every application scenario.)

   Like all SDP messages, SDP messages describing TLS streams are
   conveyed in an encapsulating application protocol (e.g., SIP, Media
   Gateway Control Protocol (MGCP), etc.).  It is the responsibility of
   the encapsulating protocol to ensure the integrity of the SDP
   security descriptions.  Therefore, the application protocol SHOULD
   either invoke its own security mechanisms (e.g., secure multiparts)
   or, alternatively, utilize a lower-layer security service (e.g., TLS
   or IPsec).  This security service SHOULD provide strong message
   authentication as well as effective replay protection.

   However, such integrity protection is not always possible.  For these
   cases, end systems SHOULD maintain a cache of certificates that other
   parties have previously presented using this mechanism.  If possible,
   users SHOULD be notified when an unsecured certificate associated
   with a previously unknown end system is presented and SHOULD be
   strongly warned if a different unsecured certificate is presented by
   a party with which they have communicated in the past.  In this way,
   even in the absence of integrity protection for SDP, the security of
   this document's mechanism is equivalent to that of the Secure Shell
   (ssh) protocol [<a href="#ref-21" title='"The Secure Shell (SSH) Protocol Architecture"'>21</a>], which is vulnerable to man-in-the-middle attacks
   when two parties first communicate, but can detect ones that occur
   subsequently.  (Note that a precise definition of the "other party"
   depends on the application protocol carrying the SDP message.)  Users
   SHOULD NOT, however, in any circumstances be notified about
   certificates described in SDP descriptions sent over an integrity-
   protected channel.

   To aid interoperability and deployment, security protocols that
   provide only hop-by-hop integrity protection (e.g., the sips protocol
   [<a href="#ref-16" title='"SIP: Session Initiation Protocol"'>16</a>], SIP over TLS) are considered sufficiently secure to allow the
   mode in which any syntactically valid identity is accepted in a
   certificate.  This decision was made because sips is currently the
   integrity mechanism most likely to be used in deployed networks in
   the short to medium term.  However, in this mode, SDP integrity is
   vulnerable to attacks by compromised or malicious middleboxes, e.g.,
   SIP proxy servers.  End systems MAY warn users about SDP sessions
   that are secured in only a hop-by-hop manner, and definitions of
   media formats running over TCP/TLS MAY specify that only end-to-end
   integrity mechanisms be used.






<span class="grey">Lennox                      Standards Track                    [Page 11]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-12"></span>
<span class="grey"><a href="./rfc4572">RFC 4572</a>                Comedia over TLS in SDP                July 2006</span>


   Depending on how SDP messages are transmitted, it is not always
   possible to determine whether or not a subjectAltName presented in a
   remote certificate is expected for the remote party.  In particular,
   given call forwarding, third-party call control, or session
   descriptions generated by endpoints controlled by the Gateway Control
   Protocol [<a href="#ref-22" title='"Gateway Control Protocol Version 1"'>22</a>], it is not always possible in SIP to determine what
   entity ought to have generated a remote SDP response.  In general,
   when not using authenticity and integrity protection of SDP
   descriptions, a certificate transmitted over SIP SHOULD assert the
   endpoint's SIP Address of Record as a uniformResourceIndicator
   subjectAltName.  When an endpoint receives a certificate over SIP
   asserting an identity (including an iPAddress or dNSName identity)
   other than the one to which it placed or received the call, it SHOULD
   alert the user and ask for confirmation.  This applies whether
   certificates are self-signed, or signed by certification authorities;
   a certificate for sip:bob@example.com may be legitimately signed by a
   certification authority, but may still not be acceptable for a call
   to sip:alice@example.com.  (This issue is not one specific to this
   specification; the same consideration applies for S/MIME-signed SDP
   carried over SIP.)

   This document does not define any mechanism for securely transporting
   RTP and RTP Control Protocol (RTCP) packets over a
   connection-oriented channel.  There was no consensus in the working
   group as to whether it would be better to send Secure RTP packets
   [<a href="#ref-23" title='"The Secure Real-time Transport Protocol (SRTP)"'>23</a>] over a connection-oriented transport [<a href="#ref-24" title='"Framing Real-time Transport Protocol (RTP) and RTP Control Protocol (RTCP) Packets over Connection-Oriented Transport"'>24</a>], or whether it would
   be better to send standard unsecured RTP packets over TLS using the
   mechanisms described in this document.  The group consensus was to
   wait until a use-case requiring secure connection-oriented RTP was
   presented.

   TLS is not always the most appropriate choice for secure connection-
   oriented media; in some cases, a higher- or lower-level security
   protocol may be appropriate.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/8.%20%20IANA%20Considerations"></a><a class="selflink" href="#section-8" id="section-8">8</a>.  IANA Considerations</span>

   This document defines an SDP proto value: 'TCP/TLS'.  Its format is
   defined in <a href="#section-4">Section 4</a>.  This proto value has been registered by IANA
   under "Session Description Protocol (SDP) Parameters" under "proto".

   This document defines an SDP session and media-level attribute:
   'fingerprint'.  Its format is defined in <a href="#section-5">Section 5</a>.  This attribute
   has been registered by IANA under "Session Description Protocol (SDP)
   Parameters" under "att-field (both session and media level)".

   The SDP specification [<a href="#ref-1" title='"SDP: Session Description Protocol"'>1</a>] states that specifications defining new
   proto values, like the 'TCP/TLS' proto value defined in this one,



<span class="grey">Lennox                      Standards Track                    [Page 12]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-13"></span>
<span class="grey"><a href="./rfc4572">RFC 4572</a>                Comedia over TLS in SDP                July 2006</span>


   must define the rules by which their media format (fmt) namespace is
   managed.  For the TCP/TLS protocol, new formats SHOULD have an
   associated MIME registration.  Use of an existing MIME subtype for
   the format is encouraged.  If no MIME subtype exists, it is
   RECOMMENDED that a suitable one be registered through the IETF
   process [<a href="#ref-14" title='"Media Type Specifications and Registration Procedures"'>14</a>] by production of, or reference to, a standards-track RFC
   that defines the transport protocol for the format.

   This specification creates a new IANA registry named "Hash Function
   Textual Names".  It will not be part of the SDP Parameters.

   The names of hash functions used for certificate fingerprints are
   registered by the IANA.  Hash functions MUST be defined by standards-
   track RFCs that update or obsolete <a href="./rfc3279">RFC 3279</a> [<a href="#ref-7" title='"Algorithms and Identifiers for the Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"'>7</a>].

   When registering a new hash function textual name, the following
   information MUST be provided:

   o  The textual name of the hash function.

   o  The Object Identifier (OID) of the hash function as used in X.509
      certificates.

   o  A reference to the standards-track RFC, updating or obsoleting <a href="./rfc3279">RFC</a>
      <a href="./rfc3279">3279</a> [<a href="#ref-7" title='"Algorithms and Identifiers for the Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"'>7</a>], defining the use of the hash function in X.509
      certificates.

   Figure 3 contains the initial values of this registry.

   Hash Function Name     OID                         Reference
   ------------------     ---                         ---------
   "md2"                  1.2.840.113549.2.2          <a href="./rfc3279">RFC 3279</a>
   "md5"                  1.2.840.113549.2.5          <a href="./rfc3279">RFC 3279</a>
   "sha-1"                1.3.14.3.2.26               <a href="./rfc3279">RFC 3279</a>
   "sha-224"              2.16.840.1.101.3.4.2.4      <a href="./rfc4055">RFC 4055</a>
   "sha-256"              2.16.840.1.101.3.4.2.1      <a href="./rfc4055">RFC 4055</a>
   "sha-384"              2.16.840.1.101.3.4.2.2      <a href="./rfc4055">RFC 4055</a>
   "sha-512"              2.16.840.1.101.3.4.2.3      <a href="./rfc4055">RFC 4055</a>

            Figure 3: IANA Hash Function Textual Name Registry











<span class="grey">Lennox                      Standards Track                    [Page 13]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-14"></span>
<span class="grey"><a href="./rfc4572">RFC 4572</a>                Comedia over TLS in SDP                July 2006</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/9.%20%20References"></a><a class="selflink" href="#section-9" id="section-9">9</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/9.1.%20%20Normative%20References"></a><a class="selflink" href="#section-9.1" id="section-9.1">9.1</a>.  Normative References</span>

   [<a id="ref-1">1</a>]   Handley, M., Jacobson, V., and C. Perkins, "SDP: Session
         Description Protocol", <a href="./rfc4566">RFC 4566</a>, July 2006.

   [<a id="ref-2">2</a>]   Yon, D. and G. Camarillo, "TCP-Based Media Transport in the
         Session Description Protocol (SDP)", <a href="./rfc4145">RFC 4145</a>, September 2005.

   [<a id="ref-3">3</a>]   Dierks, T. and E. Rescorla, "The Transport Layer Security (TLS)
         Protocol Version 1.1", <a href="./rfc4346">RFC 4346</a>, April 2006.

   [<a id="ref-4">4</a>]   Bradner, S., "Key words for use in RFCs to Indicate Requirement
         Levels", <a href="https://www.rfc-editor.org/bcp/bcp14">BCP 14</a>, <a href="./rfc2119">RFC 2119</a>, March 1997.

   [<a id="ref-5">5</a>]   Rosenberg, J. and H. Schulzrinne, "An Offer/Answer Model with
         Session Description Protocol (SDP)", <a href="./rfc3264">RFC 3264</a>, June 2002.

   [<a id="ref-6">6</a>]   International Telecommunications Union, "Information technology
         - Open Systems Interconnection - The Directory: Public-key and
         attribute certificate frameworks", ITU-T Recommendation X.509,
         ISO Standard 9594-8, March 2000.

   [<a id="ref-7">7</a>]   Bassham, L., Polk, W., and R. Housley, "Algorithms and
         Identifiers for the Internet X.509 Public Key Infrastructure
         Certificate and Certificate Revocation List (CRL) Profile",
         <a href="./rfc3279">RFC 3279</a>, April 2002.

   [<a id="ref-8">8</a>]   Housley, R., Polk, W., Ford, W., and D. Solo, "Internet X.509
         Public Key Infrastructure Certificate and Certificate
         Revocation List (CRL) Profile", <a href="./rfc3280">RFC 3280</a>, April 2002.

   [<a id="ref-9">9</a>]   Schaad, J., Kaliski, B., and R. Housley, "Additional Algorithms
         and Identifiers for RSA Cryptography for use in the Internet
         X.509 Public Key Infrastructure Certificate and Certificate
         Revocation List (CRL) Profile", <a href="./rfc4055">RFC 4055</a>, June 2005.

   [<a id="ref-10">10</a>]  Crocker, D. and P. Overell, "Augmented BNF for Syntax
         Specifications: ABNF", <a href="./rfc4234">RFC 4234</a>, October 2005.

   [<a id="ref-11">11</a>]  National Institute of Standards and Technology, "Secure Hash
         Standard", FIPS PUB 180-2, August 2002, &lt;<a href="http://csrc.nist.gov/publications/fips/fips180-2/fips180-2.pdf">http://csrc.nist.gov/</a>
         <a href="http://csrc.nist.gov/publications/fips/fips180-2/fips180-2.pdf">publications/fips/fips180-2/fips180-2.pdf</a>&gt;.

   [<a id="ref-12">12</a>]  Rivest, R., "The MD5 Message-Digest Algorithm", <a href="./rfc1321">RFC 1321</a>,
         April 1992.




<span class="grey">Lennox                      Standards Track                    [Page 14]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-15"></span>
<span class="grey"><a href="./rfc4572">RFC 4572</a>                Comedia over TLS in SDP                July 2006</span>


   [<a id="ref-13">13</a>]  Kaliski, B., "The MD2 Message-Digest Algorithm", <a href="./rfc1319">RFC 1319</a>,
         April 1992.

   [<a id="ref-14">14</a>]  Freed, N. and J. Klensin, "Media Type Specifications and
         Registration Procedures", <a href="https://www.rfc-editor.org/bcp/bcp13">BCP 13</a>, <a href="./rfc4288">RFC 4288</a>, December 2005.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/9.2.%20%20Informative%20References"></a><a class="selflink" href="#section-9.2" id="section-9.2">9.2</a>.  Informative References</span>

   [<a id="ref-15">15</a>]  Handley, M., Perkins, C., and E. Whelan, "Session Announcement
         Protocol", <a href="./rfc2974">RFC 2974</a>, October 2000.

   [<a id="ref-16">16</a>]  Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A.,
         Peterson, J., Sparks, R., Handley, M., and E. Schooler, "SIP:
         Session Initiation Protocol", <a href="./rfc3261">RFC 3261</a>, June 2002.

   [<a id="ref-17">17</a>]  Ramsdell, B., "Secure/Multipurpose Internet Mail Extensions
         (S/MIME) Version 3.1 Message Specification", <a href="./rfc3851">RFC 3851</a>, July
         2004.

   [<a id="ref-18">18</a>]  Franks, J., Hallam-Baker, P., Hostetler, J., Lawrence, S.,
         Leach, P., Luotonen, A., and L. Stewart, "HTTP Authentication:
         Basic and Digest Access Authentication", <a href="./rfc2617">RFC 2617</a>, June 1999.

   [<a id="ref-19">19</a>]  Eastlake, D. and P. Jones, "US Secure Hash Algorithm 1 (SHA1)",
         <a href="./rfc3174">RFC 3174</a>, September 2001.

   [<a id="ref-20">20</a>]  Rescorla, E., "HTTP Over TLS", <a href="./rfc2818">RFC 2818</a>, May 2000.

   [<a id="ref-21">21</a>]  Ylonen, T. and C. Lonvick, "The Secure Shell (SSH) Protocol
         Architecture", <a href="./rfc4251">RFC 4251</a>, January 2006.

   [<a id="ref-22">22</a>]  Groves, C., Pantaleo, M., Anderson, T., and T. Taylor, "Gateway
         Control Protocol Version 1", <a href="./rfc3525">RFC 3525</a>, June 2003.

   [<a id="ref-23">23</a>]  Baugher, M., McGrew, D., Naslund, M., Carrara, E., and K.
         Norrman, "The Secure Real-time Transport Protocol (SRTP)",
         <a href="./rfc3711">RFC 3711</a>, March 2004.

   [<a id="ref-24">24</a>]  Lazzaro, J., "Framing Real-time Transport Protocol (RTP) and
         RTP Control Protocol (RTCP) Packets over Connection-Oriented
         Transport", <a href="./rfc4571">RFC 4571</a>, July 2006.










<span class="grey">Lennox                      Standards Track                    [Page 15]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-16"></span>
<span class="grey"><a href="./rfc4572">RFC 4572</a>                Comedia over TLS in SDP                July 2006</span>


Author's Address

   Jonathan Lennox
   Columbia University Department of Computer Science
   450 Computer Science
   1214 Amsterdam Ave., M.C. 0401
   New York, NY  10027
   US

   EMail: lennox@cs.columbia.edu









































<span class="grey">Lennox                      Standards Track                    [Page 16]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-17"></span>
<span class="grey"><a href="./rfc4572">RFC 4572</a>                Comedia over TLS in SDP                July 2006</span>


Full Copyright Statement

   Copyright (C) The Internet Society (2006).

   This document is subject to the rights, licenses and restrictions
   contained in <a href="https://www.rfc-editor.org/bcp/bcp78">BCP 78</a>, and except as set forth therein, the authors
   retain all their rights.

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY AND THE INTERNET
   ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS OR IMPLIED,
   INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE
   INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

Intellectual Property

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in <a href="https://www.rfc-editor.org/bcp/bcp78">BCP 78</a> and <a href="https://www.rfc-editor.org/bcp/bcp79">BCP 79</a>.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   <a href="http://www.ietf.org/ipr">http://www.ietf.org/ipr</a>.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at
   ietf-ipr@ietf.org.

Acknowledgement

   Funding for the RFC Editor function is provided by the IETF
   Administrative Support Activity (IASA).







Lennox                      Standards Track                    [Page 17]
</pre>
</body></html>