<html><head></head><body><pre>Internet Engineering Task Force (IETF)                       M. Reynolds
Request for Comments: 8209                                          IPSw
Updates: <a href="./rfc6487">6487</a>                                                  S. Turner
Category: Standards Track                                          sn3rd
ISSN: 2070-1721                                                  S. Kent
                                                                     BBN
                                                          September 2017


               <span class="h1">A Profile for BGPsec Router Certificates,</span>
        <span class="h1">Certificate Revocation Lists, and Certification Requests</span>

Abstract

   This document defines a standard profile for X.509 certificates used
   to enable validation of Autonomous System (AS) paths in the Border
   Gateway Protocol (BGP), as part of an extension to that protocol
   known as BGPsec.  BGP is the standard for inter-domain routing in the
   Internet; it is the "glue" that holds the Internet together.  BGPsec
   is being developed as one component of a solution that addresses the
   requirement to provide security for BGP.  The goal of BGPsec is to
   provide full AS path validation based on the use of strong
   cryptographic primitives.  The end entity (EE) certificates specified
   by this profile are issued to routers within an AS.  Each of these
   certificates is issued under a Resource Public Key Infrastructure
   (RPKI) Certification Authority (CA) certificate.  These CA
   certificates and EE certificates both contain the AS Resource
   extension.  An EE certificate of this type asserts that the router or
   routers holding the corresponding private key are authorized to emit
   secure route advertisements on behalf of the AS(es) specified in the
   certificate.  This document also profiles the format of certification
   requests and specifies Relying Party (RP) certificate path validation
   procedures for these EE certificates.  This document extends the
   RPKI; therefore, this document updates the RPKI Resource Certificates
   Profile (<a href="./rfc6487">RFC 6487</a>).
















<span class="grey">Reynolds, et al.             Standards Track                    [Page 1]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-2"></span>
<span class="grey"><a href="./rfc8209">RFC 8209</a>                BGPsec Router PKI Profile         September 2017</span>


Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in <a href="./rfc7841#section-2">Section 2 of RFC 7841</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="https://www.rfc-editor.org/info/rfc8209">https://www.rfc-editor.org/info/rfc8209</a>.

Copyright Notice

   Copyright (c) 2017 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://www.rfc-editor.org/bcp/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.























<span class="grey">Reynolds, et al.             Standards Track                    [Page 2]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-3"></span>
<span class="grey"><a href="./rfc8209">RFC 8209</a>                BGPsec Router PKI Profile         September 2017</span>


Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-3">3</a>
      <a href="#section-1.1">1.1</a>. Terminology ................................................<a href="#page-4">4</a>
   <a href="#section-2">2</a>. Describing Resources in Certificates ............................<a href="#page-4">4</a>
   <a href="#section-3">3</a>. Updates to <a href="./rfc6487">RFC 6487</a> .............................................<a href="#page-6">6</a>
      <a href="#section-3.1">3.1</a>. BGPsec Router Certificate Fields ...........................<a href="#page-6">6</a>
           <a href="#section-3.1.1">3.1.1</a>. Subject .............................................<a href="#page-6">6</a>
           <a href="#section-3.1.2">3.1.2</a>. Subject Public Key Info .............................<a href="#page-6">6</a>
           3.1.3. BGPsec Router Certificate Version 3
                  Extension Fields ....................................<a href="#page-6">6</a>
                  <a href="#section-3.1.3.1">3.1.3.1</a>. Basic Constraints ..........................<a href="#page-6">6</a>
                  <a href="#section-3.1.3.2">3.1.3.2</a>. Extended Key Usage .........................<a href="#page-6">6</a>
                  <a href="#section-3.1.3.3">3.1.3.3</a>. Subject Information Access .................<a href="#page-7">7</a>
                  <a href="#section-3.1.3.4">3.1.3.4</a>. IP Resources ...............................<a href="#page-7">7</a>
                  <a href="#section-3.1.3.5">3.1.3.5</a>. AS Resources ...............................<a href="#page-7">7</a>
      <a href="#section-3.2">3.2</a>. BGPsec Router Certificate Request Profile ..................<a href="#page-7">7</a>
      <a href="#section-3.3">3.3</a>. BGPsec Router Certificate Validation .......................<a href="#page-8">8</a>
      <a href="#section-3.4">3.4</a>. Router Certificates and Signing Functions in the RPKI ......<a href="#page-8">8</a>
   <a href="#section-4">4</a>. Design Notes ....................................................<a href="#page-9">9</a>
   <a href="#section-5">5</a>. Implementation Considerations ...................................<a href="#page-9">9</a>
   <a href="#section-6">6</a>. Security Considerations ........................................<a href="#page-10">10</a>
   <a href="#section-7">7</a>. IANA Considerations ............................................<a href="#page-10">10</a>
   <a href="#section-8">8</a>. References .....................................................<a href="#page-11">11</a>
      <a href="#section-8.1">8.1</a>. Normative References ......................................<a href="#page-11">11</a>
      <a href="#section-8.2">8.2</a>. Informative References ....................................<a href="#page-12">12</a>
   <a href="#appendix-A">Appendix A</a>. ASN.1 Module ..........................................<a href="#page-14">14</a>
   Acknowledgements ..................................................<a href="#page-15">15</a>
   Authors' Addresses ................................................<a href="#page-15">15</a>

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" id="section-1">1</a>.  Introduction</span>

   This document defines a profile for X.509 end entity (EE)
   certificates [<a href="./rfc5280" title='"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"'>RFC5280</a>] for use in the context of certification of
   Autonomous System (AS) paths in the BGPsec protocol.  Such
   certificates are termed "BGPsec Router Certificates".  The holder of
   the private key associated with a BGPsec Router Certificate is
   authorized to send secure route advertisements (BGPsec UPDATEs) on
   behalf of the AS(es) named in the certificate.  A router holding the
   private key is authorized to send route advertisements (to its peers)
   identifying the router's AS number (ASN) as the source of the
   advertisements.  A key property provided by BGPsec is that every AS
   along the AS path can verify that the other ASes along the path have
   authorized the advertisement of the given route (to the next AS along
   the AS path).






<span class="grey">Reynolds, et al.             Standards Track                    [Page 3]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-4"></span>
<span class="grey"><a href="./rfc8209">RFC 8209</a>                BGPsec Router PKI Profile         September 2017</span>


   This document is a profile of [<a href="./rfc6487" title='"A Profile for X.509 PKIX Resource Certificates"'>RFC6487</a>], which is a profile of
   [<a href="./rfc5280" title='"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"'>RFC5280</a>]; thus, this document updates [<a href="./rfc6487" title='"A Profile for X.509 PKIX Resource Certificates"'>RFC6487</a>].  It establishes
   requirements imposed on a Resource Certificate that is used as a
   BGPsec Router Certificate, i.e., it defines constraints for
   certificate fields and extensions for the certificate to be valid in
   this context.  This document also profiles the certification requests
   used to acquire BGPsec Router Certificates.  Finally, this document
   specifies the Relying Party (RP) certificate path validation
   procedures for these certificates.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/1.1.%20%20Terminology"></a><a class="selflink" href="#section-1.1" id="section-1.1">1.1</a>.  Terminology</span>

   It is assumed that the reader is familiar with the terms and concepts
   described in "A Profile for X.509 PKIX Resource Certificates"
   [<a href="./rfc6487" title='"A Profile for X.509 PKIX Resource Certificates"'>RFC6487</a>], "BGPsec Protocol Specification" [<a href="./rfc8205" title='"BGPsec Protocol Specification"'>RFC8205</a>], "A Border
   Gateway Protocol 4 (BGP-4)" [<a href="./rfc4271" title='"A Border Gateway Protocol 4 (BGP-4)"'>RFC4271</a>], "BGP Security Vulnerabilities
   Analysis" [<a href="./rfc4272" title='"BGP Security Vulnerabilities Analysis"'>RFC4272</a>], "Considerations in Validating the Path in BGP"
   [<a href="./rfc5123" title='"Considerations in Validating the Path in BGP"'>RFC5123</a>], and "Capabilities Advertisement with BGP-4" [<a href="./rfc5492" title='"Capabilities Advertisement with BGP-4"'>RFC5492</a>].

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in
   <a href="https://www.rfc-editor.org/bcp/bcp14">BCP 14</a> [<a href="./rfc2119" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>] [<a href="./rfc8174" title='"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"'>RFC8174</a>] when, and only when, they appear in all
   capitals, as shown here.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/2.%20%20Describing%20Resources%20in%20Certificates"></a><a class="selflink" href="#section-2" id="section-2">2</a>.  Describing Resources in Certificates</span>

   Figure 1 depicts some of the entities in the Resource Public Key
   Infrastructure (RPKI) and some of the products generated by RPKI
   entities.  IANA issues a Certification Authority (CA) certificate to
   each Regional Internet Registry (RIR).  The RIR in turn issues a
   CA certificate to an Internet Service Provider (ISP).  The ISP
   in turn issues EE certificates to itself to enable verification of
   signatures on RPKI signed objects.  The CA also generates Certificate
   Revocation Lists (CRLs).  These CA and EE certificates are referred
   to as "Resource Certificates" and are profiled in [<a href="./rfc6487" title='"A Profile for X.509 PKIX Resource Certificates"'>RFC6487</a>].
   [<a href="./rfc6480" title='"An Infrastructure to Support Secure Internet Routing"'>RFC6480</a>] envisioned using Resource Certificates to enable
   verification of manifests [<a href="./rfc6486" title='"Manifests for the Resource Public Key Infrastructure (RPKI)"'>RFC6486</a>] and Route Origin Authorizations
   (ROAs) [<a href="./rfc6482" title='"A Profile for Route Origin Authorizations (ROAs)"'>RFC6482</a>].  ROAs and manifests include the Resource
   Certificates used to verify them.











<span class="grey">Reynolds, et al.             Standards Track                    [Page 4]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-5"></span>
<span class="grey"><a href="./rfc8209">RFC 8209</a>                BGPsec Router PKI Profile         September 2017</span>


                +---------+   +------+
                | CA Cert |---| IANA |
                +---------+   +------+
                         \
                      +---------+   +-----+
                      | CA Cert |---| RIR |
                      +---------+   +-----+
                              \
                             +---------+   +-----+
                             | CA Cert |---| ISP |
                             +---------+   +-----+
                              / |            | |
                   +-----+   /  |            | |   +-----+
                   | CRL |--+   |            | +---| ROA |
                   +-----+      |            |     +-----+
                                |            |   +----------+
                       +----+   |            +---| Manifest |
                     +-| EE |---+                +----------+
                     | +----+
                     +-----+

                                 Figure 1

   This document defines another type of Resource Certificate, which is
   referred to as a "BGPsec Router Certificate".  The purpose of this
   certificate is explained in <a href="#section-1">Section 1</a> and falls within the scope of
   appropriate uses defined within [<a href="./rfc6484" title='"Certificate Policy (CP) for the Resource Public Key Infrastructure (RPKI)"'>RFC6484</a>].  The issuance of BGPsec
   Router Certificates has minimal impact on RPKI CAs because the RPKI
   CA certificate and CRL profile remain unchanged (i.e., they are as
   specified in [<a href="./rfc6487" title='"A Profile for X.509 PKIX Resource Certificates"'>RFC6487</a>]).  Further, the algorithms used to generate
   RPKI CA certificates that issue the BGPsec Router Certificates and
   the CRLs necessary to check the validity of the BGPsec Router
   Certificates remain unchanged (i.e., they are as specified in
   [<a href="./rfc7935" title='"The Profile for Algorithms and Key Sizes for Use in the Resource Public Key Infrastructure"'>RFC7935</a>]).  The only impact is that RPKI CAs will need to be able to
   process a profiled certificate request (see <a href="#section-3.2">Section 3.2</a>) signed with
   algorithms found in [<a href="./rfc8208" title='"BGP Algorithms, Key Formats, and Signature Formats"'>RFC8208</a>].  BGPsec Router Certificates are used
   only to verify the signature on the BGPsec certificate request (only
   CAs process these) and the signature on a BGPsec UPDATE message
   [<a href="./rfc8205" title='"BGPsec Protocol Specification"'>RFC8205</a>] (only BGPsec routers process these); BGPsec Router
   Certificates are not used to process manifests and ROAs or verify
   signatures on Certificates or CRLs.

   This document enumerates only the differences between this profile
   and the profile in [<a href="./rfc6487" title='"A Profile for X.509 PKIX Resource Certificates"'>RFC6487</a>].  Note that BGPsec Router Certificates
   are EE certificates, and as such there is no impact on the algorithm
   agility procedure described in [<a href="./rfc6916" title='"Algorithm Agility Procedure for the Resource Public Key Infrastructure (RPKI)"'>RFC6916</a>].





<span class="grey">Reynolds, et al.             Standards Track                    [Page 5]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-6"></span>
<span class="grey"><a href="./rfc8209">RFC 8209</a>                BGPsec Router PKI Profile         September 2017</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.%20%20Updates%20to%20RFC%206487"></a><a class="selflink" href="#section-3" id="section-3">3</a>.  Updates to <a href="./rfc6487">RFC 6487</a></span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.1.%20%20BGPsec%20Router%20Certificate%20Fields"></a><a class="selflink" href="#section-3.1" id="section-3.1">3.1</a>.  BGPsec Router Certificate Fields</span>

   A BGPsec Router Certificate is consistent with the profile in
   [<a href="./rfc6487" title='"A Profile for X.509 PKIX Resource Certificates"'>RFC6487</a>] as modified by the specifications in this section.  As
   such, it is a valid X.509 public key certificate and consistent with
   the PKIX profile [<a href="./rfc5280" title='"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"'>RFC5280</a>].  The differences between this profile and
   the profile in [<a href="./rfc6487" title='"A Profile for X.509 PKIX Resource Certificates"'>RFC6487</a>] are specified in this section.

<span class="h4"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.1.1.%20%20Subject"></a><a class="selflink" href="#section-3.1.1" id="section-3.1.1">3.1.1</a>.  Subject</span>

   Encoding options for the common name that are supported are
   printableString and UTF8String.  For BGPsec Router Certificates, it
   is RECOMMENDED that the common name attribute contain the literal
   string "ROUTER-" followed by the 32-bit ASN [<a href="./rfc3779" title='"X.509 Extensions for IP Addresses and AS Identifiers"'>RFC3779</a>] encoded as
   eight hexadecimal digits and that the serial number attribute contain
   the 32-bit BGP Identifier [<a href="./rfc4271" title='"A Border Gateway Protocol 4 (BGP-4)"'>RFC4271</a>] (i.e., the router ID) encoded as
   eight hexadecimal digits.  If there is more than one ASN, the choice
   of which to include in the common name is at the discretion of the
   Issuer.  If the same certificate is issued to more than one router
   (and hence the private key is shared among these routers), the choice
   of the router ID used in this name is at the discretion of the
   Issuer.

<span class="h4"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.1.2.%20%20Subject%20Public%20Key%20Info"></a><a class="selflink" href="#section-3.1.2" id="section-3.1.2">3.1.2</a>.  Subject Public Key Info</span>

   Refer to <a href="./rfc8208#section-3.1">Section 3.1 of [RFC8208]</a>.

<span class="h4"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.1.3.%20%20BGPsec%20Router%20Certificate%20Version%203%20Extension%20Fields"></a><a class="selflink" href="#section-3.1.3" id="section-3.1.3">3.1.3</a>.  BGPsec Router Certificate Version 3 Extension Fields</span>

<span class="h5"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.1.3.1.%20%20Basic%20Constraints"></a><a class="selflink" href="#section-3.1.3.1" id="section-3.1.3.1">3.1.3.1</a>.  Basic Constraints</span>

   BGPsec speakers are EEs; therefore, the Basic Constraints extension
   must not be present, as per [<a href="./rfc6487" title='"A Profile for X.509 PKIX Resource Certificates"'>RFC6487</a>].

<span class="h5"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.1.3.2.%20%20Extended%20Key%20Usage"></a><a class="selflink" href="#section-3.1.3.2" id="section-3.1.3.2">3.1.3.2</a>.  Extended Key Usage</span>

   BGPsec Router Certificates MUST include the Extended Key Usage (EKU)
   extension.  As specified in [<a href="./rfc6487" title='"A Profile for X.509 PKIX Resource Certificates"'>RFC6487</a>], this extension must not be
   marked critical.  This document defines one EKU for BGPsec Router
   Certificates:

     id-kp OBJECT IDENTIFIER ::=
        { iso(1) identified-organization(3) dod(6) internet(1)
          security(5) mechanisms(5) pkix(7) kp(3) }

     id-kp-bgpsec-router OBJECT IDENTIFIER ::= { id-kp 30 }



<span class="grey">Reynolds, et al.             Standards Track                    [Page 6]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-7"></span>
<span class="grey"><a href="./rfc8209">RFC 8209</a>                BGPsec Router PKI Profile         September 2017</span>


   A BGPsec router MUST require the EKU extension be present in a BGPsec
   Router Certificate it receives.  If multiple KeyPurposeId values are
   included, the BGPsec routers need not recognize all of them, as long
   as the required KeyPurposeId value is present.  BGPsec routers MUST
   reject certificates that do not contain the BGPsec Router EKU even if
   they include the anyExtendedKeyUsage OID defined in [<a href="./rfc5280" title='"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"'>RFC5280</a>].

<span class="h5"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.1.3.3.%20%20Subject%20Information%20Access"></a><a class="selflink" href="#section-3.1.3.3" id="section-3.1.3.3">3.1.3.3</a>.  Subject Information Access</span>

   This extension is not used in BGPsec Router Certificates.  It MUST be
   omitted.

<span class="h5"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.1.3.4.%20%20IP%20Resources"></a><a class="selflink" href="#section-3.1.3.4" id="section-3.1.3.4">3.1.3.4</a>.  IP Resources</span>

   This extension is not used in BGPsec Router Certificates.  It MUST be
   omitted.

<span class="h5"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.1.3.5.%20%20AS%20Resources"></a><a class="selflink" href="#section-3.1.3.5" id="section-3.1.3.5">3.1.3.5</a>.  AS Resources</span>

   Each BGPsec Router Certificate MUST include the AS Resources
   extension, as specified in <a href="./rfc6487#section-4.8.11">Section 4.8.11 of [RFC6487]</a>.  The
   AS Resources extension MUST include one or more ASNs, and the
   "inherit" element MUST NOT be specified.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.2.%20%20BGPsec%20Router%20Certificate%20Request%20Profile"></a><a class="selflink" href="#section-3.2" id="section-3.2">3.2</a>.  BGPsec Router Certificate Request Profile</span>

   Refer to <a href="./rfc6487#section-6">Section 6 of [RFC6487]</a>.  The only differences between this
   profile and the profile in [<a href="./rfc6487" title='"A Profile for X.509 PKIX Resource Certificates"'>RFC6487</a>] are as follows:

   o  The Basic Constraints extension:

      If included, the CA MUST NOT honor the cA boolean if set to TRUE.

   o  The EKU extension:

      If included, id-kp-bgpsec-router MUST be present (see
      <a href="#section-3.1.3.2">Section 3.1.3.2</a>).  If included, the CA MUST honor the request for
      id-kp-bgpsec-router.

   o  The Subject Information Access (SIA) extension:

      If included, the CA MUST NOT honor the request to include the
      extension.

   o  The SubjectPublicKeyInfo field is specified in [<a href="./rfc8208" title='"BGP Algorithms, Key Formats, and Signature Formats"'>RFC8208</a>].

   o  The request is signed with the algorithms specified in [<a href="./rfc8208" title='"BGP Algorithms, Key Formats, and Signature Formats"'>RFC8208</a>].




<span class="grey">Reynolds, et al.             Standards Track                    [Page 7]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-8"></span>
<span class="grey"><a href="./rfc8209">RFC 8209</a>                BGPsec Router PKI Profile         September 2017</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.3.%20%20BGPsec%20Router%20Certificate%20Validation"></a><a class="selflink" href="#section-3.3" id="section-3.3">3.3</a>.  BGPsec Router Certificate Validation</span>

   The validation procedure used for BGPsec Router Certificates is
   identical to the validation procedure described in <a href="./rfc6487#section-7">Section 7 of
   [RFC6487]</a> (and any RFC that updates that procedure), as modified
   below.  For example, in step 3 (of the criteria listed in <a href="./rfc6487#section-7.2">Section 7.2
   of [RFC6487]</a>), "The certificate contains all fields that MUST be
   present" refers to the fields that are required by this
   specification.

   The differences are as follows:

   o  BGPsec Router Certificates MUST include the BGPsec Router EKU
      defined in <a href="#section-3.1.3.2">Section 3.1.3.2</a>.

   o  BGPsec Router Certificates MUST NOT include the SIA extension.

   o  BGPsec Router Certificates MUST NOT include the IP Resources
      extension.

   o  BGPsec Router Certificates MUST include the AS Resources
      extension.

   o  BGPsec Router Certificates MUST include the subjectPublicKeyInfo
      field described in [<a href="./rfc8208" title='"BGP Algorithms, Key Formats, and Signature Formats"'>RFC8208</a>].

   NOTE: BGPsec RPs will need to support the algorithms in [<a href="./rfc8208" title='"BGP Algorithms, Key Formats, and Signature Formats"'>RFC8208</a>],
   which are used to validate BGPsec signatures, as well as the
   algorithms in [<a href="./rfc7935" title='"The Profile for Algorithms and Key Sizes for Use in the Resource Public Key Infrastructure"'>RFC7935</a>], which are needed to validate signatures on
   BGPsec certificates, RPKI CA certificates, and RPKI CRLs.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.4.%20%20Router%20Certificates%20and%20Signing%20Functions%20in%20the%20RPKI"></a><a class="selflink" href="#section-3.4" id="section-3.4">3.4</a>.  Router Certificates and Signing Functions in the RPKI</span>

   As described in <a href="#section-1">Section 1</a>, the primary function of BGPsec Router
   Certificates in the RPKI is for use in the context of certification
   of AS paths in the BGPsec protocol.

   The private key associated with a router EE certificate may be used
   multiple times in generating signatures in multiple instances of the
   BGPsec_PATH attribute Signature Segments [<a href="./rfc8205" title='"BGPsec Protocol Specification"'>RFC8205</a>].  That is, the
   BGPsec Router Certificate is used to validate multiple signatures.

   BGPsec Router Certificates are stored in the issuing CA's repository,
   where a repository following [<a href="./rfc6481" title='"A Profile for Resource Certificate Repository Structure"'>RFC6481</a>] MUST use a .cer filename
   extension for the certificate file.






<span class="grey">Reynolds, et al.             Standards Track                    [Page 8]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-9"></span>
<span class="grey"><a href="./rfc8209">RFC 8209</a>                BGPsec Router PKI Profile         September 2017</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/4.%20%20Design%20Notes"></a><a class="selflink" href="#section-4" id="section-4">4</a>.  Design Notes</span>

   The BGPsec Router Certificate profile is based on the Resource
   Certificate profile as specified in [<a href="./rfc6487" title='"A Profile for X.509 PKIX Resource Certificates"'>RFC6487</a>].  As a result, many of
   the design choices herein are a reflection of the design choices that
   were taken in that prior work.  The reader is referred to [<a href="./rfc6484" title='"Certificate Policy (CP) for the Resource Public Key Infrastructure (RPKI)"'>RFC6484</a>]
   for a fuller discussion of those choices.

   CAs are required by the Certificate Policy (CP) [<a href="./rfc6484" title='"Certificate Policy (CP) for the Resource Public Key Infrastructure (RPKI)"'>RFC6484</a>] to issue
   properly formed BGPsec Router Certificates regardless of what is
   present in the certificate request, so there is some flexibility
   permitted in the certificate requests:

   o  BGPsec Router Certificates are always EE certificates; therefore,
      requests to issue a CA certificate result in EE certificates;

   o  BGPsec Router Certificates are always EE certificates; therefore,
      requests for Key Usage extension values keyCertSign and cRLSign
      result in certificates with neither of these values;

   o  BGPsec Router Certificates always include the BGPsec Router EKU
      value; therefore, requests without the value result in
      certificates with the value; and,

   o  BGPsec Router Certificates never include the SIA extension;
      therefore, requests with this extension result in certificates
      without the extension.

   Note that this behavior is similar to the CA including the
   AS Resources extension in issued BGPsec Router Certificates, despite
   the fact that it is not present in the request.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.%20%20Implementation%20Considerations"></a><a class="selflink" href="#section-5" id="section-5">5</a>.  Implementation Considerations</span>

   This document permits the operator to include a list of ASNs in a
   BGPsec Router Certificate.  In that case, the router certificate
   would become invalid if any one of the ASNs is removed from any
   superior CA certificate along the path to a trust anchor.  Operators
   could choose to avoid this possibility by issuing a separate BGPsec
   Router Certificate for each distinct ASN, so that the router
   certificates for ASNs that are retained in the superior CA
   certificate would remain valid.









<span class="grey">Reynolds, et al.             Standards Track                    [Page 9]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-10"></span>
<span class="grey"><a href="./rfc8209">RFC 8209</a>                BGPsec Router PKI Profile         September 2017</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/6.%20%20Security%20Considerations"></a><a class="selflink" href="#section-6" id="section-6">6</a>.  Security Considerations</span>

   The security considerations of [<a href="./rfc6487" title='"A Profile for X.509 PKIX Resource Certificates"'>RFC6487</a>] apply.

   A BGPsec Router Certificate will fail RPKI validation as defined in
   [<a href="./rfc6487" title='"A Profile for X.509 PKIX Resource Certificates"'>RFC6487</a>] because the cryptographic algorithms used are different.
   Consequently, an RP needs to identify the EKU to determine the
   appropriate Validation constraint.

   A BGPsec Router Certificate is an extension of the RPKI [<a href="./rfc6480" title='"An Infrastructure to Support Secure Internet Routing"'>RFC6480</a>] to
   encompass routers.  It is a building block of BGPsec and is used to
   validate signatures on BGPsec Signature Segment origination of
   signed path segments [<a href="./rfc8205" title='"BGPsec Protocol Specification"'>RFC8205</a>].  Thus, its essential security
   function is the secure binding of one or more ASNs to a public key,
   consistent with the RPKI allocation/assignment hierarchy.

   Hash functions [<a href="./rfc8208" title='"BGP Algorithms, Key Formats, and Signature Formats"'>RFC8208</a>] are used when generating the two key
   identifier extensions (i.e., Subject Key Identifier and Issuer Key
   Identifier) included in BGPsec certificates.  However, as noted in
   [<a href="./rfc6818" title='"Updates to the Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"'>RFC6818</a>], collision resistance is not a required property of one-way
   hash functions when used to generate key identifiers.  Regardless,
   hash collisions are unlikely, but they are possible, and if detected
   an operator should be alerted.  A Subject Key Identifier collision
   might cause the incorrect certificate to be selected from the cache,
   resulting in a failed signature validation.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/7.%20%20IANA%20Considerations"></a><a class="selflink" href="#section-7" id="section-7">7</a>.  IANA Considerations</span>

   This document makes use of two OIDs in the SMI registry for PKIX.
   One is for the ASN.1 module [<a href="#ref-X680" title='"Information technology - Abstract Syntax Notation One (ASN.1): Specification of basic notation"'>X680</a>] [<a href="#ref-X690" title='"Information technology - ASN.1 encoding rules: Specification of Basic Encoding Rules (BER), Canonical Encoding Rules (CER) and Distinguished Encoding Rules (DER)"'>X690</a>] in <a href="#appendix-A">Appendix A</a>, and it comes
   from the "SMI Security for PKIX Module Identifier" IANA registry
   (id-mod-bgpsec-eku).  The other is for the BGPsec Router EKU defined
   in <a href="#section-3.1.3.2">Section 3.1.3.2</a> and <a href="#appendix-A">Appendix A</a>, and it comes from the "SMI
   Security for PKIX Extended Key Purpose" IANA registry
   (id-kp-bgpsec-router).  These OIDs were assigned before management of
   the PKIX Arc was handed to IANA.  The references in those registries
   have been updated to point to this document.














<span class="grey">Reynolds, et al.             Standards Track                   [Page 10]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-11"></span>
<span class="grey"><a href="./rfc8209">RFC 8209</a>                BGPsec Router PKI Profile         September 2017</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/8.%20%20References"></a><a class="selflink" href="#section-8" id="section-8">8</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/8.1.%20%20Normative%20References"></a><a class="selflink" href="#section-8.1" id="section-8.1">8.1</a>.  Normative References</span>

   [<a id="ref-RFC2119">RFC2119</a>]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="https://www.rfc-editor.org/bcp/bcp14">BCP 14</a>, <a href="./rfc2119">RFC 2119</a>,
              DOI 10.17487/RFC2119, March 1997,
              &lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;.

   [<a id="ref-RFC3779">RFC3779</a>]  Lynn, C., Kent, S., and K. Seo, "X.509 Extensions for
              IP Addresses and AS Identifiers", <a href="./rfc3779">RFC 3779</a>,
              DOI 10.17487/RFC3779, June 2004,
              &lt;<a href="https://www.rfc-editor.org/info/rfc3779">https://www.rfc-editor.org/info/rfc3779</a>&gt;.

   [<a id="ref-RFC4271">RFC4271</a>]  Rekhter, Y., Ed., Li, T., Ed., and S. Hares, Ed., "A
              Border Gateway Protocol 4 (BGP-4)", <a href="./rfc4271">RFC 4271</a>,
              DOI 10.17487/RFC4271, January 2006,
              &lt;<a href="https://www.rfc-editor.org/info/rfc4271">https://www.rfc-editor.org/info/rfc4271</a>&gt;.

   [<a id="ref-RFC5280">RFC5280</a>]  Cooper, D., Santesson, S., Farrell, S., Boeyen, S.,
              Housley, R., and W. Polk, "Internet X.509 Public Key
              Infrastructure Certificate and Certificate Revocation List
              (CRL) Profile", <a href="./rfc5280">RFC 5280</a>, DOI 10.17487/RFC5280, May 2008,
              &lt;<a href="https://www.rfc-editor.org/info/rfc5280">https://www.rfc-editor.org/info/rfc5280</a>&gt;.

   [<a id="ref-RFC6481">RFC6481</a>]  Huston, G., Loomans, R., and G. Michaelson, "A Profile for
              Resource Certificate Repository Structure", <a href="./rfc6481">RFC 6481</a>,
              DOI 10.17487/RFC6481, February 2012,
              &lt;<a href="https://www.rfc-editor.org/info/rfc6481">https://www.rfc-editor.org/info/rfc6481</a>&gt;.

   [<a id="ref-RFC6486">RFC6486</a>]  Austein, R., Huston, G., Kent, S., and M. Lepinski,
              "Manifests for the Resource Public Key Infrastructure
              (RPKI)", <a href="./rfc6486">RFC 6486</a>, DOI 10.17487/RFC6486, February 2012,
              &lt;<a href="https://www.rfc-editor.org/info/rfc6486">https://www.rfc-editor.org/info/rfc6486</a>&gt;.

   [<a id="ref-RFC6487">RFC6487</a>]  Huston, G., Michaelson, G., and R. Loomans, "A Profile for
              X.509 PKIX Resource Certificates", <a href="./rfc6487">RFC 6487</a>,
              DOI 10.17487/RFC6487, February 2012,
              &lt;<a href="https://www.rfc-editor.org/info/rfc6487">https://www.rfc-editor.org/info/rfc6487</a>&gt;.

   [<a id="ref-RFC7935">RFC7935</a>]  Huston, G. and G. Michaelson, Ed., "The Profile for
              Algorithms and Key Sizes for Use in the Resource Public
              Key Infrastructure", <a href="./rfc7935">RFC 7935</a>, DOI 10.17487/RFC7935,
              August 2016, &lt;<a href="https://www.rfc-editor.org/info/rfc7935">https://www.rfc-editor.org/info/rfc7935</a>&gt;.







<span class="grey">Reynolds, et al.             Standards Track                   [Page 11]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-12"></span>
<span class="grey"><a href="./rfc8209">RFC 8209</a>                BGPsec Router PKI Profile         September 2017</span>


   [<a id="ref-RFC8174">RFC8174</a>]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in
              <a href="./rfc2119">RFC 2119</a> Key Words", <a href="https://www.rfc-editor.org/bcp/bcp14">BCP 14</a>, <a href="./rfc8174">RFC 8174</a>,
              DOI 10.17487/RFC8174, May 2017,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;.

   [<a id="ref-RFC8205">RFC8205</a>]  Lepinski, M., Ed., and K. Sriram, Ed., "BGPsec Protocol
              Specification", <a href="./rfc8205">RFC 8205</a>, DOI 10.17487/RFC8205,
              September 2017,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8205">https://www.rfc-editor.org/info/rfc8205</a>&gt;.

   [<a id="ref-RFC8208">RFC8208</a>]  Turner, S. and O. Borchert, "BGP Algorithms, Key Formats,
              and Signature Formats", <a href="./rfc8208">RFC 8208</a>, DOI 10.17487/RFC8208,
              September 2017,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8208">https://www.rfc-editor.org/info/rfc8208</a>&gt;.

   [<a id="ref-X680">X680</a>]     ITU-T, "Information technology - Abstract Syntax
              Notation One (ASN.1): Specification of basic notation",
              ITU-T Recommendation X.680, ISO/IEC 8824-1, August 2015,
              &lt;<a href="https://www.itu.int/rec/T-REC-X.680/en">https://www.itu.int/rec/T-REC-X.680/en</a>&gt;.

   [<a id="ref-X690">X690</a>]     ITU-T, "Information technology - ASN.1 encoding rules:
              Specification of Basic Encoding Rules (BER), Canonical
              Encoding Rules (CER) and Distinguished Encoding Rules
              (DER)", ITU-T Recommendation X.690, ISO/IEC 8825-1,
              August 2015, &lt;<a href="https://www.itu.int/rec/T-REC-X.690/en">https://www.itu.int/rec/T-REC-X.690/en</a>&gt;.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/8.2.%20%20Informative%20References"></a><a class="selflink" href="#section-8.2" id="section-8.2">8.2</a>.  Informative References</span>

   [<a id="ref-RFC4272">RFC4272</a>]  Murphy, S., "BGP Security Vulnerabilities Analysis",
              <a href="./rfc4272">RFC 4272</a>, DOI 10.17487/RFC4272, January 2006,
              &lt;<a href="https://www.rfc-editor.org/info/rfc4272">https://www.rfc-editor.org/info/rfc4272</a>&gt;.

   [<a id="ref-RFC5123">RFC5123</a>]  White, R. and B. Akyol, "Considerations in Validating the
              Path in BGP", <a href="./rfc5123">RFC 5123</a>, DOI 10.17487/RFC5123,
              February 2008, &lt;<a href="https://www.rfc-editor.org/info/rfc5123">https://www.rfc-editor.org/info/rfc5123</a>&gt;.

   [<a id="ref-RFC5492">RFC5492</a>]  Scudder, J. and R. Chandra, "Capabilities Advertisement
              with BGP-4", <a href="./rfc5492">RFC 5492</a>, DOI 10.17487/RFC5492,
              February 2009, &lt;<a href="https://www.rfc-editor.org/info/rfc5492">https://www.rfc-editor.org/info/rfc5492</a>&gt;.

   [<a id="ref-RFC6480">RFC6480</a>]  Lepinski, M. and S. Kent, "An Infrastructure to Support
              Secure Internet Routing", <a href="./rfc6480">RFC 6480</a>, DOI 10.17487/RFC6480,
              February 2012, &lt;<a href="https://www.rfc-editor.org/info/rfc6480">https://www.rfc-editor.org/info/rfc6480</a>&gt;.

   [<a id="ref-RFC6482">RFC6482</a>]  Lepinski, M., Kent, S., and D. Kong, "A Profile for Route
              Origin Authorizations (ROAs)", <a href="./rfc6482">RFC 6482</a>,
              DOI 10.17487/RFC6482, February 2012,
              &lt;<a href="https://www.rfc-editor.org/info/rfc6482">https://www.rfc-editor.org/info/rfc6482</a>&gt;.



<span class="grey">Reynolds, et al.             Standards Track                   [Page 12]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-13"></span>
<span class="grey"><a href="./rfc8209">RFC 8209</a>                BGPsec Router PKI Profile         September 2017</span>


   [<a id="ref-RFC6484">RFC6484</a>]  Kent, S., Kong, D., Seo, K., and R. Watro, "Certificate
              Policy (CP) for the Resource Public Key Infrastructure
              (RPKI)", <a href="https://www.rfc-editor.org/bcp/bcp173">BCP 173</a>, <a href="./rfc6484">RFC 6484</a>, DOI 10.17487/RFC6484,
              February 2012, &lt;<a href="https://www.rfc-editor.org/info/rfc6484">https://www.rfc-editor.org/info/rfc6484</a>&gt;.

   [<a id="ref-RFC6818">RFC6818</a>]  Yee, P., "Updates to the Internet X.509 Public Key
              Infrastructure Certificate and Certificate Revocation List
              (CRL) Profile", <a href="./rfc6818">RFC 6818</a>, DOI 10.17487/RFC6818,
              January 2013, &lt;<a href="https://www.rfc-editor.org/info/rfc6818">https://www.rfc-editor.org/info/rfc6818</a>&gt;.

   [<a id="ref-RFC6916">RFC6916</a>]  Gagliano, R., Kent, S., and S. Turner, "Algorithm Agility
              Procedure for the Resource Public Key Infrastructure
              (RPKI)", <a href="https://www.rfc-editor.org/bcp/bcp182">BCP 182</a>, <a href="./rfc6916">RFC 6916</a>, DOI 10.17487/RFC6916,
              April 2013, &lt;<a href="https://www.rfc-editor.org/info/rfc6916">https://www.rfc-editor.org/info/rfc6916</a>&gt;.





































<span class="grey">Reynolds, et al.             Standards Track                   [Page 13]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-14"></span>
<span class="grey"><a href="./rfc8209">RFC 8209</a>                BGPsec Router PKI Profile         September 2017</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/Appendix%20A.%20%20ASN.1%20Module"></a><a class="selflink" href="#appendix-A" id="appendix-A">Appendix A</a>.  ASN.1 Module</span>

   BGPSECEKU { iso(1) identified-organization(3) dod(6) internet(1)
     security(5) mechanisms(5) pkix(7) id-mod(0) id-mod-bgpsec-eku(84) }

     DEFINITIONS EXPLICIT TAGS ::=

     BEGIN

     -- EXPORTS ALL --

     -- IMPORTS NOTHING --

     -- OID Arc --

     id-kp  OBJECT IDENTIFIER  ::= {
       iso(1) identified-organization(3) dod(6) internet(1)
       security(5) mechanisms(5) pkix(7) kp(3) }

     -- BGPsec Router Extended Key Usage --

     id-kp-bgpsec-router OBJECT IDENTIFIER ::= { id-kp 30 }

     END



























<span class="grey">Reynolds, et al.             Standards Track                   [Page 14]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-15"></span>
<span class="grey"><a href="./rfc8209">RFC 8209</a>                BGPsec Router PKI Profile         September 2017</span>


Acknowledgements

   We would like to thank Geoff Huston, George Michaelson, and Robert
   Loomans for their work on [<a href="./rfc6487" title='"A Profile for X.509 PKIX Resource Certificates"'>RFC6487</a>], which this work is based on.  In
   addition, the efforts of Matt Lepinski were instrumental in preparing
   this work.  Additionally, we'd like to thank Rob Austein, Roque
   Gagliano, Richard Hansen, Geoff Huston, David Mandelberg, Sandra
   Murphy, and Sam Weiler for their reviews and comments.

Authors' Addresses

   Mark Reynolds
   Island Peak Software
   328 Virginia Road
   Concord, MA  01742
   United States of America

   Email: mcr@islandpeaksoftware.com


   Sean Turner
   sn3rd

   Email: sean@sn3rd.com


   Stephen Kent
   Raytheon BBN Technologies
   10 Moulton St.
   Cambridge, MA  02138
   United States of America

   Email: kent@alum.mit.edu


















Reynolds, et al.             Standards Track                   [Page 15]
</pre>
</body></html>