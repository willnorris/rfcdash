<html><head></head><body><pre>Internet Engineering Task Force (IETF)                        H. Fontana
Request for Comments: 6591                                    April 2012
Category: Standards Track
ISSN: 2070-1721


   <span class="h1">Authentication Failure Reporting Using the Abuse Reporting Format</span>

Abstract

   This memo registers an extension report type for the Abuse Reporting
   Format (ARF), affecting multiple registries, for use in generating
   receipt-time reports about messages that fail one or more email
   message authentication checks.

Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in <a href="./rfc5741#section-2">SectionÂ 2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc6591">http://www.rfc-editor.org/info/rfc6591</a>.

Copyright Notice

   Copyright (c) 2012 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://www.rfc-editor.org/bcp/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.








<span class="grey">Fontana                      Standards Track                    [Page 1]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-2"></span>
<span class="grey"><a href="./rfc6591">RFC 6591</a>                 Auth Failure Reporting               April 2012</span>


Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-2">2</a>
   <a href="#section-2">2</a>. Definitions .....................................................<a href="#page-3">3</a>
      <a href="#section-2.1">2.1</a>. Key Words ..................................................<a href="#page-3">3</a>
      <a href="#section-2.2">2.2</a>. Email Architecture .........................................<a href="#page-3">3</a>
      <a href="#section-2.3">2.3</a>. Base64 .....................................................<a href="#page-3">3</a>
      <a href="#section-2.4">2.4</a>. Technologies ...............................................<a href="#page-3">3</a>
   <a href="#section-3">3</a>. ARF Extension for Authentication Failure Reporting ..............<a href="#page-3">3</a>
      <a href="#section-3.1">3.1</a>. New ARF Feedback Type ......................................<a href="#page-4">4</a>
      <a href="#section-3.2">3.2</a>. New ARF Header Field Names .................................<a href="#page-5">5</a>
           <a href="#section-3.2.1">3.2.1</a>. Required for All Reports ............................<a href="#page-5">5</a>
           <a href="#section-3.2.2">3.2.2</a>. Optional for All Reports ............................<a href="#page-5">5</a>
           <a href="#section-3.2.3">3.2.3</a>. Required for DKIM Reports ...........................<a href="#page-5">5</a>
           <a href="#section-3.2.4">3.2.4</a>. Optional for DKIM Reports ...........................<a href="#page-6">6</a>
           <a href="#section-3.2.5">3.2.5</a>. Required for ADSP Reports ...........................<a href="#page-6">6</a>
           <a href="#section-3.2.6">3.2.6</a>. Required for SPF Reports ............................<a href="#page-6">6</a>
      <a href="#section-3.3">3.3</a>. Authentication Failure Types ...............................<a href="#page-6">6</a>
   <a href="#section-4">4</a>. Syntax for Added ARF Header Fields ..............................<a href="#page-7">7</a>
   <a href="#section-5">5</a>. IANA Considerations .............................................<a href="#page-8">8</a>
      <a href="#section-5.1">5.1</a>. Updates to ARF Feedback Types ..............................<a href="#page-8">8</a>
      <a href="#section-5.2">5.2</a>. Updates to ARF Header Field Names ..........................<a href="#page-8">8</a>
   <a href="#section-6">6</a>. Security Considerations ........................................<a href="#page-10">10</a>
      <a href="#section-6.1">6.1</a>. Inherited Considerations ..................................<a href="#page-10">10</a>
      <a href="#section-6.2">6.2</a>. Forgeries .................................................<a href="#page-10">10</a>
      <a href="#section-6.3">6.3</a>. Automatic Generation ......................................<a href="#page-11">11</a>
      <a href="#section-6.4">6.4</a>. Envelope Sender Selection .................................<a href="#page-11">11</a>
      <a href="#section-6.5">6.5</a>. Reporting Multiple Incidents ..............................<a href="#page-11">11</a>
      <a href="#section-6.6">6.6</a>. Redaction of Data in DKIM Reports .........................<a href="#page-12">12</a>
   <a href="#section-7">7</a>. References .....................................................<a href="#page-12">12</a>
      <a href="#section-7.1">7.1</a>. Normative References ......................................<a href="#page-12">12</a>
      <a href="#section-7.2">7.2</a>. Informative References ....................................<a href="#page-13">13</a>
   <a href="#appendix-A">Appendix A</a>. Acknowledgements ......................................<a href="#page-14">14</a>
   <a href="#appendix-B">Appendix B</a>. Example ...............................................<a href="#page-14">14</a>
     <a href="#appendix-B.1">B.1</a>. Example Use of ARF Extension Headers .......................<a href="#page-14">14</a>

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" id="section-1">1</a>.  Introduction</span>

   The Abuse Reporting Format [<a href="#ref-ARF" title='"An Extensible Format for Email Feedback Reports"'>ARF</a>] defines a message format for sending
   reports of abuse in the messaging infrastructure, with an eye towards
   automating both the generation and consumption of those reports.
   There is now also a desire to extend the ARF to include the reporting
   of messages that fail to authenticate using known message
   authentication methods, such as DomainKeys Identified Mail [<a href="#ref-DKIM" title='"DomainKeys Identified Mail (DKIM) Signatures"'>DKIM</a>] and
   Sender Policy Framework [<a href="#ref-SPF" title='"Sender Policy Framework (SPF) for Authorizing Use of Domains in E-Mail, Version 1"'>SPF</a>], as these are sometimes evidence of
   abuse that can be detected and reported through automated means.  The
   same mechanism can be used to convey forensic information about the




<span class="grey">Fontana                      Standards Track                    [Page 2]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-3"></span>
<span class="grey"><a href="./rfc6591">RFC 6591</a>                 Auth Failure Reporting               April 2012</span>


   specific reason the authentication method failed.  Thus, this memo
   presents such extensions to ARF that allow for detailed reporting of
   message authentication method failures.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/2.%20%20Definitions"></a><a class="selflink" href="#section-2" id="section-2">2</a>.  Definitions</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/2.1.%20%20Key%20Words"></a><a class="selflink" href="#section-2.1" id="section-2.1">2.1</a>.  Key Words</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [<a href="#ref-KEYWORDS" title='"Key words for use in RFCs to Indicate Requirement Levels"'>KEYWORDS</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/2.2.%20%20Email%20Architecture"></a><a class="selflink" href="#section-2.2" id="section-2.2">2.2</a>.  Email Architecture</span>

   This memo uses some terms whose definitions and descriptions can be
   found in [<a href="#ref-EMAIL-ARCH">EMAIL-ARCH</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/2.3.%20%20Base64"></a><a class="selflink" href="#section-2.3" id="section-2.3">2.3</a>.  Base64</span>

   Base64 is defined in Section 4 of [<a href="#ref-BASE64" title='"The Base16, Base32, and Base64 Data Encodings"'>BASE64</a>].

   The values that are base64 encodings MAY contain folding whitespace
   (FWS) for formatting purposes as per the usual header field wrapping
   defined in [<a href="#ref-MAIL" title='"Internet Message Format"'>MAIL</a>].  During decoding, any characters not in the base64
   alphabet are ignored so that such line wrapping does not harm the
   value.  The ABNF token "FWS" is defined in [<a href="#ref-DKIM" title='"DomainKeys Identified Mail (DKIM) Signatures"'>DKIM</a>].  No other
   extensions to the valid base64 character set are permitted.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/2.4.%20%20Technologies"></a><a class="selflink" href="#section-2.4" id="section-2.4">2.4</a>.  Technologies</span>

   There are technologies in email security that provide authentication
   services and some that do authorization.  These are often conflated.
   A discussion that is useful for establishing context can be found in
   Section 1.5.2 of [<a href="#ref-AUTH-RESULTS">AUTH-RESULTS</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.%20%20ARF%20Extension%20for%20Authentication%20Failure%20Reporting"></a><a class="selflink" href="#section-3" id="section-3">3</a>.  ARF Extension for Authentication Failure Reporting</span>

   The current report format defined in [<a href="#ref-ARF" title='"An Extensible Format for Email Feedback Reports"'>ARF</a>] lacks some specific
   features required to do effective email authentication failure
   reporting.  This section defines extensions to ARF to accommodate
   this requirement.

   A single report describes a single email authentication failure.
   Multiple reports MAY be used to report multiple failures for a single
   message.






<span class="grey">Fontana                      Standards Track                    [Page 3]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-4"></span>
<span class="grey"><a href="./rfc6591">RFC 6591</a>                 Auth Failure Reporting               April 2012</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.1.%20%20New%20ARF%20Feedback%20Type"></a><a class="selflink" href="#section-3.1" id="section-3.1">3.1</a>.  New ARF Feedback Type</span>

   A new feedback type, "auth-failure", is defined in this document as
   an extension, per Section 7.3 of [<a href="#ref-ARF" title='"An Extensible Format for Email Feedback Reports"'>ARF</a>].

   A message that uses this feedback type has the following modified
   header field requirements for the second (machine-parseable) [<a href="#ref-MIME" title='"Multipurpose Internet Mail Extensions (MIME) Part One: Format of Internet Message Bodies"'>MIME</a>]
   part of the report:

   Authentication-Results:  Syntax as specified in [<a href="#ref-AUTH-RESULTS">AUTH-RESULTS</a>].
      Furthermore, [<a href="#ref-ARF" title='"An Extensible Format for Email Feedback Reports"'>ARF</a>] specifies this field is OPTIONAL and appears at
      most once; for this extension, this field MUST be present, but it
      MUST reflect only a single authentication method's result.

   Original-Envelope-Id:  Syntax as specified in [<a href="#ref-ARF" title='"An Extensible Format for Email Feedback Reports"'>ARF</a>].  Furthermore,
      [<a href="#ref-ARF" title='"An Extensible Format for Email Feedback Reports"'>ARF</a>] specifies this field is OPTIONAL and appears at most once;
      for this extension, this field's inclusion is RECOMMENDED, where
      that value is available, to aid in diagnosing the authentication
      failure.

   Original-Mail-From:  Syntax as specified in [<a href="#ref-ARF" title='"An Extensible Format for Email Feedback Reports"'>ARF</a>].  Furthermore,
      [<a href="#ref-ARF" title='"An Extensible Format for Email Feedback Reports"'>ARF</a>] specifies this field is OPTIONAL and appears at most once;
      for this extension, this field's inclusion is RECOMMENDED, where
      that value is available, to aid in diagnosing the authentication
      failure.

   Source-IP:  Syntax as specified in [<a href="#ref-ARF" title='"An Extensible Format for Email Feedback Reports"'>ARF</a>].  Furthermore, [<a href="#ref-ARF" title='"An Extensible Format for Email Feedback Reports"'>ARF</a>]
      specifies this field is OPTIONAL and appears at most once; for
      this extension, this field's inclusion is RECOMMENDED, where that
      value is available, to aid in diagnosing the authentication
      failure.

   Reported-Domain:  Syntax as specified in [<a href="#ref-ARF" title='"An Extensible Format for Email Feedback Reports"'>ARF</a>].  Furthermore, [<a href="#ref-ARF" title='"An Extensible Format for Email Feedback Reports"'>ARF</a>]
      specifies this field is OPTIONAL and appears at most once; for
      this extension, this field MUST be present if such a value is
      available.

   Delivery-Result:  As specified in <a href="#section-3.2.2">Section 3.2.2</a>.  This field is
      OPTIONAL, but it MUST NOT appear more than once.  If present, it
      SHOULD indicate the outcome of the message in some meaningful way,
      but it MAY be set to "other" for local policy reasons.

   The third MIME part of the message is either of type "message/rfc822"
   (as defined in [<a href="#ref-MIME-TYPES">MIME-TYPES</a>]) or of type "text/rfc822-headers" (as
   defined in [<a href="#ref-REPORT" title='"The Multipart/Report Media Type for the Reporting of Mail System Administrative Messages"'>REPORT</a>]) and contains a copy of the entire header block
   from the original message.  This part MUST be included (contrary to
   [<a href="#ref-REPORT" title='"The Multipart/Report Media Type for the Reporting of Mail System Administrative Messages"'>REPORT</a>], which makes it optional).




<span class="grey">Fontana                      Standards Track                    [Page 4]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-5"></span>
<span class="grey"><a href="./rfc6591">RFC 6591</a>                 Auth Failure Reporting               April 2012</span>


   For privacy reasons, report generators might need to redact portions
   of a reported message, such as an identifier or address associated
   with the end user whose complaint action resulted in the report.  A
   discussion of relevant issues and a suggested method for doing so can
   be found in [<a href="./rfc6590" title='"Redaction of Potentially Sensitive Data from Mail Abuse Reports"'>RFC6590</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.2.%20%20New%20ARF%20Header%20Field%20Names"></a><a class="selflink" href="#section-3.2" id="section-3.2">3.2</a>.  New ARF Header Field Names</span>

   The following new ARF field names are defined as extensions to
   Section 3.1 of [<a href="#ref-ARF" title='"An Extensible Format for Email Feedback Reports"'>ARF</a>].

<span class="h4"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.2.1.%20%20Required%20for%20All%20Reports"></a><a class="selflink" href="#section-3.2.1" id="section-3.2.1">3.2.1</a>.  Required for All Reports</span>

   Auth-Failure:  Indicates the failure from an email authentication
      method that is being reported.  The list of valid values is
      enumerated in <a href="#section-3.3">Section 3.3</a>.

<span class="h4"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.2.2.%20%20Optional%20for%20All%20Reports"></a><a class="selflink" href="#section-3.2.2" id="section-3.2.2">3.2.2</a>.  Optional for All Reports</span>

   Delivery-Result:  The final message disposition that was enacted by
      the ADministrative Management Domain (ADMD) generating the report.
      It MUST NOT appear more than once.  Possible values are as
      follows:

      delivered:  The message was delivered (not specific as to where).

      spam:  The message was delivered to the recipient's spam folder
         (or equivalent).

      policy:  The message was not delivered to the intended inbox due
         to a failure from an email authentication method.  The specific
         action taken is not specified.

      reject:  The message was rejected.

      other:  The message had a final disposition not covered by one of
         the above values.

<span class="h4"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.2.3.%20%20Required%20for%20DKIM%20Reports"></a><a class="selflink" href="#section-3.2.3" id="section-3.2.3">3.2.3</a>.  Required for DKIM Reports</span>

   DKIM-Domain:  The domain that signed the message, taken from the "d="
      tag of the signature.

   DKIM-Identity:  The identity of the signature that failed
      verification, taken from the "i=" tag of the signature.

   DKIM-Selector:  The selector of the signature that failed
      verification, taken from the "s=" tag of the signature.



<span class="grey">Fontana                      Standards Track                    [Page 5]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-6"></span>
<span class="grey"><a href="./rfc6591">RFC 6591</a>                 Auth Failure Reporting               April 2012</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.2.4.%20%20Optional%20for%20DKIM%20Reports"></a><a class="selflink" href="#section-3.2.4" id="section-3.2.4">3.2.4</a>.  Optional for DKIM Reports</span>

   DKIM-Canonicalized-Header:  A base64 encoding of the canonicalized
      header of the message as generated by the verifier.

   DKIM-Canonicalized-Body:  A base64 encoding of the canonicalized body
      of the message as generated by the verifier.  The encoded content
      MUST be limited to those octets that contribute to the DKIM body
      hash (i.e., the value of the "l=" tag; see Section 3.7 of [<a href="#ref-DKIM" title='"DomainKeys Identified Mail (DKIM) Signatures"'>DKIM</a>]).

   If DKIM-Canonicalized-Header and DKIM-Canonicalized-Body encode
   redacted data, they MUST NOT be included.  Otherwise, they SHOULD be
   included.  The data presented there have to be exactly the
   canonicalized header and body as defined by [<a href="#ref-DKIM" title='"DomainKeys Identified Mail (DKIM) Signatures"'>DKIM</a>] and computed at
   the verifier.  This is because these fields are intended to aid in
   identifying message alterations that invalidate DKIM signatures in
   transit.  Including redacted data in them renders the data unusable.
   (See also Sections <a href="#section-3.1">3.1</a> and <a href="#section-6.6">6.6</a> for further discussion.)

<span class="h4"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.2.5.%20%20Required%20for%20ADSP%20Reports"></a><a class="selflink" href="#section-3.2.5" id="section-3.2.5">3.2.5</a>.  Required for ADSP Reports</span>

   DKIM-ADSP-DNS:  Includes the Author Domain Signing Practices (ADSP)
      policy used to obtain the verifier's ADSP result.  This MUST be
      formatted per Section 4.2.1 of [<a href="#ref-ADSP" title='"DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP)"'>ADSP</a>].

<span class="h4"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.2.6.%20%20Required%20for%20SPF%20Reports"></a><a class="selflink" href="#section-3.2.6" id="section-3.2.6">3.2.6</a>.  Required for SPF Reports</span>

   SPF-DNS:  This field MUST appear once for every SPF record [<a href="#ref-SPF" title='"Sender Policy Framework (SPF) for Authorizing Use of Domains in E-Mail, Version 1"'>SPF</a>] used
      to obtain the SPF result.  It MUST include the DNS RRTYPE used,
      the DNS domain from which the record was retrieved, and the
      content of that record.  The syntax is defined in <a href="#section-4">Section 4</a>.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.3.%20%20Authentication%20Failure%20Types"></a><a class="selflink" href="#section-3.3" id="section-3.3">3.3</a>.  Authentication Failure Types</span>

   The list of defined email authentication failure types used in the
   "Auth-Failure:" header field (defined above), is as follows:

   adsp:  The message did not conform to the author domain's published
      [<a href="#ref-ADSP" title='"DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP)"'>ADSP</a>] signing practices.  The DKIM-ADSP-DNS field MUST be
      included in the report.

   bodyhash:  The body hash in the signature and the body hash computed
      by the verifier did not match.  The DKIM-Canonicalized-Body field
      SHOULD be included in the report (see <a href="#section-3.2.4">Section 3.2.4</a>).

   revoked:  The DKIM key referenced by the signature on the message has
      been revoked.  The DKIM-Domain and DKIM-Selector fields MUST be
      included in the report.



<span class="grey">Fontana                      Standards Track                    [Page 6]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-7"></span>
<span class="grey"><a href="./rfc6591">RFC 6591</a>                 Auth Failure Reporting               April 2012</span>


   signature:  The DKIM signature on the message did not successfully
      verify against the header hash and public key.  The DKIM-Domain
      and DKIM-Selector fields MUST be included in the report, and the
      DKIM-Canonicalized-Header field SHOULD be included in the report
      (see <a href="#section-3.2.4">Section 3.2.4</a>).

   spf:  The evaluation of the author domain's SPF record produced a
      "none", "fail", "softfail", "temperror", or "permerror" result.
      ("none" is not strictly a failure per [<a href="#ref-SPF" title='"Sender Policy Framework (SPF) for Authorizing Use of Domains in E-Mail, Version 1"'>SPF</a>], but a service that
      demands successful SPF evaluations of clients could treat it like
      a failure.)

   Supplementary data MAY be included in the form of comments compliant
   with [<a href="#ref-MAIL" title='"Internet Message Format"'>MAIL</a>].  For example, "Auth-Failure: adsp" could be augmented by
   a comment to indicate that the failed message was rejected because it
   was not signed when it should have been.  See <a href="#appendix-B">Appendix B</a> for an
   example.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/4.%20%20Syntax%20for%20Added%20ARF%20Header%20Fields"></a><a class="selflink" href="#section-4" id="section-4">4</a>.  Syntax for Added ARF Header Fields</span>

   The [<a href="#ref-ABNF" title='"Augmented BNF for Syntax Specifications: ABNF"'>ABNF</a>] definitions for the new fields are as follows:

     auth-failure = "Auth-Failure:" [CFWS]
                    ( "adsp" / "bodyhash" / "revoked" /
                      "signature" / "spf" ) [CFWS] CRLF
                  ; "CFWS" is defined in [<a href="#ref-MAIL" title='"Internet Message Format"'>MAIL</a>]

     delivery-result = "Delivery-Result:" [CFWS]
                       ( "delivered" / "spam" / "policy" /
                         "reject" / "other" ) [CFWS] CRLF

     dkim-header = "DKIM-Canonicalized-Header:" [CFWS]
                   base64string CRLF
                 ; "base64string" is defined in [<a href="#ref-DKIM" title='"DomainKeys Identified Mail (DKIM) Signatures"'>DKIM</a>]

     dkim-sig-domain = "DKIM-Domain:" [CFWS] domain-name [CFWS]
                       CRLF
                     ; "domain-name" is defined in [<a href="#ref-DKIM" title='"DomainKeys Identified Mail (DKIM) Signatures"'>DKIM</a>]

     dkim-identity = "DKIM-Identity:" [CFWS] [ local-part ] "@"
                     domain-name [CFWS] CRLF
                   ; "local-part" is defined in [<a href="#ref-MAIL" title='"Internet Message Format"'>MAIL</a>]

     dkim-selector = "DKIM-Selector:" [CFWS] selector [CFWS] CRLF
                   ; "selector" is defined in [<a href="#ref-DKIM" title='"DomainKeys Identified Mail (DKIM) Signatures"'>DKIM</a>]






<span class="grey">Fontana                      Standards Track                    [Page 7]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-8"></span>
<span class="grey"><a href="./rfc6591">RFC 6591</a>                 Auth Failure Reporting               April 2012</span>


     dkim-adsp-dns = "DKIM-ADSP-DNS:" [CFWS]
                     quoted-string [CFWS] CRLF
                   ; "quoted-string" is defined in [<a href="#ref-MAIL" title='"Internet Message Format"'>MAIL</a>]

     dkim-body = "DKIM-Canonicalized-Body:" [CFWS]
                 base64string CRLF

     dkim-selector-dns = "DKIM-Selector-DNS:" [CFWS]
                         quoted-string [CFWS] CRLF

     spf-dns = "SPF-DNS:" [CFWS] ( "txt" / "spf" ) [CFWS] ":" [CFWS]
               domain [CFWS] ":" [CFWS] quoted-string [CFWS] CRLF

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.%20%20IANA%20Considerations"></a><a class="selflink" href="#section-5" id="section-5">5</a>.  IANA Considerations</span>

   As required by [<a href="#ref-IANA" title="">IANA</a>], this section contains registry information for
   the extension to [<a href="#ref-ARF" title='"An Extensible Format for Email Feedback Reports"'>ARF</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.1.%20%20Updates%20to%20ARF%20Feedback%20Types"></a><a class="selflink" href="#section-5.1" id="section-5.1">5.1</a>.  Updates to ARF Feedback Types</span>

   The following feedback type has been added to the Feedback Report
   Type Values registry:

       Feedback Type: auth-failure
       Description: email authentication failure report
       Published in: [<a href="./rfc6591">RFC6591</a>]
       Status: current

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.2.%20%20Updates%20to%20ARF%20Header%20Field%20Names"></a><a class="selflink" href="#section-5.2" id="section-5.2">5.2</a>.  Updates to ARF Header Field Names</span>

   The following headers are added to the Feedback Report Header Fields
   registry:

       Field Name: Auth-Failure
       Description: Type of email authentication method failure
       Multiple Appearances: No
       Related "Feedback-Type": auth-failure
       Published in: [<a href="./rfc6591">RFC6591</a>]
       Status: current

       Field Name: Delivery-Result
       Description: Final disposition of the subject message
       Multiple Appearances: No
       Related "Feedback-Type": auth-failure
       Published in: [<a href="./rfc6591">RFC6591</a>]
       Status: current





<span class="grey">Fontana                      Standards Track                    [Page 8]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-9"></span>
<span class="grey"><a href="./rfc6591">RFC 6591</a>                 Auth Failure Reporting               April 2012</span>


       Field Name: DKIM-ADSP-DNS
       Description: Retrieved DKIM ADSP record
       Multiple Appearances: No
       Related "Feedback-Type": auth-failure
       Published in: [<a href="./rfc6591">RFC6591</a>]
       Status: current

       Field Name: DKIM-Canonicalized-Body
       Description: Canonicalized body, per DKIM
       Multiple Appearances: No
       Related "Feedback-Type": auth-failure
       Published in: [<a href="./rfc6591">RFC6591</a>]
       Status: current

       Field Name: DKIM-Canonicalized-Header
       Description: Canonicalized header, per DKIM
       Multiple Appearances: No
       Related "Feedback-Type": auth-failure
       Published in: [<a href="./rfc6591">RFC6591</a>]
       Status: current

       Field Name: DKIM-Domain
       Description: DKIM signing domain from "d=" tag
       Multiple Appearances: No
       Related "Feedback-Type": auth-failure
       Published in: [<a href="./rfc6591">RFC6591</a>]
       Status: current

       Field Name: DKIM-Identity
       Description: Identity from DKIM signature
       Multiple Appearances: No
       Related "Feedback-Type": auth-failure
       Published in: [<a href="./rfc6591">RFC6591</a>]
       Status: current

       Field Name: DKIM-Selector
       Description: Selector from DKIM signature
       Multiple Appearances: No
       Related "Feedback-Type": auth-failure
       Published in: [<a href="./rfc6591">RFC6591</a>]
       Status: current

       Field Name: DKIM-Selector-DNS
       Description: Retrieved DKIM key record
       Multiple Appearances: No
       Related "Feedback-Type": auth-failure
       Published in: [<a href="./rfc6591">RFC6591</a>]
       Status: current



<span class="grey">Fontana                      Standards Track                    [Page 9]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-10"></span>
<span class="grey"><a href="./rfc6591">RFC 6591</a>                 Auth Failure Reporting               April 2012</span>


       Field Name: SPF-DNS
       Description: Retrieved SPF record
       Multiple Appearances: No
       Related "Feedback-Type": auth-failure
       Published in: [<a href="./rfc6591">RFC6591</a>]
       Status: current

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/6.%20%20Security%20Considerations"></a><a class="selflink" href="#section-6" id="section-6">6</a>.  Security Considerations</span>

   Security issues with respect to these reports are similar to those
   found in [<a href="#ref-DSN" title='"An Extensible Message Format for Delivery Status Notifications"'>DSN</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/6.1.%20%20Inherited%20Considerations"></a><a class="selflink" href="#section-6.1" id="section-6.1">6.1</a>.  Inherited Considerations</span>

   Implementers are advised to consider the Security Considerations
   sections of [<a href="#ref-DKIM" title='"DomainKeys Identified Mail (DKIM) Signatures"'>DKIM</a>], [<a href="#ref-ADSP" title='"DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP)"'>ADSP</a>], [<a href="#ref-SPF" title='"Sender Policy Framework (SPF) for Authorizing Use of Domains in E-Mail, Version 1"'>SPF</a>], and [<a href="#ref-ARF" title='"An Extensible Format for Email Feedback Reports"'>ARF</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/6.2.%20%20Forgeries"></a><a class="selflink" href="#section-6.2" id="section-6.2">6.2</a>.  Forgeries</span>

   These reports can be forged as easily as ordinary Internet electronic
   mail.  User agents and automatic mail-handling facilities (such as
   mail distribution list exploders) that wish to make automatic use of
   Delivery Status Notifications (DSNs) of any kind should take
   appropriate precautions to minimize the potential damage from denial-
   of-service attacks.

   Security threats related to forged DSNs include the sending of

   a.  A falsified email authentication method failure notification when
       the message was in fact delivered to the indicated recipient;

   b.  Falsified signature information, such as selector, domain, etc.

   Perhaps the simplest means of mitigating this threat is to assert
   that these reports should themselves be signed with something like
   DKIM.  On the other hand, if there's a problem with the DKIM
   infrastructure at the verifier, signing DKIM failure reports might
   produce reports that aren't trusted or even accepted by their
   intended recipients.












<span class="grey">Fontana                      Standards Track                   [Page 10]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-11"></span>
<span class="grey"><a href="./rfc6591">RFC 6591</a>                 Auth Failure Reporting               April 2012</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/6.3.%20%20Automatic%20Generation"></a><a class="selflink" href="#section-6.3" id="section-6.3">6.3</a>.  Automatic Generation</span>

   Automatic generation of these reports by verifying agents can cause a
   denial-of-service attack when a large volume of email is sent that
   causes email authentication failures for whatever reason.

   Limiting the rate of generation of these messages might be
   appropriate but threatens to inhibit the distribution of important
   and possibly time-sensitive information.

   In general ARF feedback loop terms, it is suggested that report
   generators only create these (or any) ARF reports after an out-of-
   band arrangement has been made between two parties.  This mechanism
   then becomes a way to adjust parameters of an authorized abuse report
   feedback loop that is configured and activated by private agreement
   rather than starting to send them automatically based solely on
   discovered data in the DNS.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/6.4.%20%20Envelope%20Sender%20Selection"></a><a class="selflink" href="#section-6.4" id="section-6.4">6.4</a>.  Envelope Sender Selection</span>

   In the case of transmitted reports in the form of a new message, it
   is necessary to consider the construction and transmission of the
   message so as to avoid amplification attacks, deliberate or
   otherwise.  See Section 5 of [<a href="#ref-ARF" title='"An Extensible Format for Email Feedback Reports"'>ARF</a>] for further information.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/6.5.%20%20Reporting%20Multiple%20Incidents"></a><a class="selflink" href="#section-6.5" id="section-6.5">6.5</a>.  Reporting Multiple Incidents</span>

   If it is known that a particular host generates abuse reports upon
   certain incidents, an attacker could forge a high volume of messages
   that will trigger such a report.  The recipient of the report could
   then be inundated with reports.  This could easily be extended to a
   distributed denial-of-service attack by finding a number of report-
   generating servers.

   The incident count referenced in [<a href="#ref-ARF" title='"An Extensible Format for Email Feedback Reports"'>ARF</a>] provides a limited form of
   mitigation.  The host generating reports may elect to send reports
   only periodically, with each report representing a number of
   identical or near-identical incidents.  One might even do something
   inverse-exponentially, sending reports for each of the first ten
   incidents, then every tenth incident up to 100, then every 100th
   incident up to 1000, etc., until some period of relative quiet after
   which the limitation resets.

   The use of this technique for "near-identical" incidents in
   particular causes a degradation in reporting quality, however.  If,
   for example, a large number of pieces of spam arrive from one
   attacker, a reporting agent might decide only to send a report about




<span class="grey">Fontana                      Standards Track                   [Page 11]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-12"></span>
<span class="grey"><a href="./rfc6591">RFC 6591</a>                 Auth Failure Reporting               April 2012</span>


   a fraction of those messages.  While this averts a flood of reports
   to a system administrator, the precise details of each incident are
   similarly not sent.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/6.6.%20%20Redaction%20of%20Data%20in%20DKIM%20Reports"></a><a class="selflink" href="#section-6.6" id="section-6.6">6.6</a>.  Redaction of Data in DKIM Reports</span>

   This memo requires that the canonicalized header and body be returned
   without being subject to redaction when a DKIM failure is being
   reported.  This is necessary to ensure that the returned
   canonicalized forms are useful for debugging, as they must be
   compared to the equivalent form at the signer.  If a message is
   altered in transit, and the returned data are also redacted, the
   redacted portion and the altered portion may overlap, rendering the
   comparison results meaningless.  However, unredacted data can leak
   information the reporting entity considers to be private.  It is for
   this reason the return of the canonicalized forms is not required.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/7.%20%20References"></a><a class="selflink" href="#section-7" id="section-7">7</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/7.1.%20%20Normative%20References"></a><a class="selflink" href="#section-7.1" id="section-7.1">7.1</a>.  Normative References</span>

   [<a id="ref-ABNF">ABNF</a>]     Crocker, D., Ed., and P. Overell, "Augmented BNF for
              Syntax Specifications: ABNF", STD 68, <a href="./rfc5234">RFC 5234</a>,
              January 2008.

   [<a id="ref-ADSP">ADSP</a>]     Allman, E., Fenton, J., Delany, M., and J. Levine,
              "DomainKeys Identified Mail (DKIM) Author Domain Signing
              Practices (ADSP)", <a href="./rfc5617">RFC 5617</a>, August 2009.

   [<a id="ref-ARF">ARF</a>]      Shafranovich, Y., Levine, J., and M. Kucherawy, "An
              Extensible Format for Email Feedback Reports", <a href="./rfc5965">RFC 5965</a>,
              August 2010.

   [<a id="ref-AUTH-RESULTS">AUTH-RESULTS</a>]
              Kucherawy, M., "Message Header Field for Indicating
              Message Authentication Status", <a href="./rfc5451">RFC 5451</a>, April 2009.

   [<a id="ref-BASE64">BASE64</a>]   Josefsson, S., "The Base16, Base32, and Base64 Data
              Encodings", <a href="./rfc4648">RFC 4648</a>, October 2006.

   [<a id="ref-DKIM">DKIM</a>]     Crocker, D., Ed., Hansen, T., Ed., and M. Kucherawy, Ed.,
              "DomainKeys Identified Mail (DKIM) Signatures", <a href="./rfc6376">RFC 6376</a>,
              September 2011.

   [<a id="ref-IANA">IANA</a>]     Narten, T. and H. Alvestrand, "Guidelines for Writing an
              IANA Considerations Section in RFCs", <a href="https://www.rfc-editor.org/bcp/bcp26">BCP 26</a>, <a href="./rfc5226">RFC 5226</a>,
              May 2008.




<span class="grey">Fontana                      Standards Track                   [Page 12]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-13"></span>
<span class="grey"><a href="./rfc6591">RFC 6591</a>                 Auth Failure Reporting               April 2012</span>


   [<a id="ref-KEYWORDS">KEYWORDS</a>] Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="https://www.rfc-editor.org/bcp/bcp14">BCP 14</a>, <a href="./rfc2119">RFC 2119</a>, March 1997.

   [<a id="ref-MAIL">MAIL</a>]     Resnick, P., Ed., "Internet Message Format", <a href="./rfc5322">RFC 5322</a>,
              October 2008.

   [<a id="ref-MIME">MIME</a>]     Freed, N. and N. Borenstein, "Multipurpose Internet Mail
              Extensions (MIME) Part One: Format of Internet Message
              Bodies", <a href="./rfc2045">RFC 2045</a>, November 1996.

   [<a id="ref-MIME-TYPES">MIME-TYPES</a>]
              Freed, N. and N. Borenstein, "Multipurpose Internet Mail
              Extensions (MIME) Part Two: Media Types", <a href="./rfc2046">RFC 2046</a>,
              November 1996.

   [<a id="ref-REPORT">REPORT</a>]   Kucherawy, M., Ed., "The Multipart/Report Media Type for
              the Reporting of Mail System Administrative Messages",
              STD 73, <a href="./rfc6522">RFC 6522</a>, January 2012.

   [<a id="ref-RFC6590">RFC6590</a>]  Falk, J., Ed., and M. Kucherawy, Ed., "Redaction of
              Potentially Sensitive Data from Mail Abuse Reports",
              <a href="./rfc6590">RFC 6590</a>, April 2012.

   [<a id="ref-SPF">SPF</a>]      Wong, M. and W. Schlitt, "Sender Policy Framework (SPF)
              for Authorizing Use of Domains in E-Mail, Version 1",
              <a href="./rfc4408">RFC 4408</a>, April 2006.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/7.2.%20%20Informative%20References"></a><a class="selflink" href="#section-7.2" id="section-7.2">7.2</a>.  Informative References</span>

   [<a id="ref-DSN">DSN</a>]      Moore, K. and G. Vaudreuil, "An Extensible Message Format
              for Delivery Status Notifications", <a href="./rfc3464">RFC 3464</a>,
              January 2003.

   [<a id="ref-EMAIL-ARCH">EMAIL-ARCH</a>]
              Crocker, D., "Internet Mail Architecture", <a href="./rfc5598">RFC 5598</a>,
              July 2009.















<span class="grey">Fontana                      Standards Track                   [Page 13]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-14"></span>
<span class="grey"><a href="./rfc6591">RFC 6591</a>                 Auth Failure Reporting               April 2012</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/Appendix%20A.%20%20Acknowledgements"></a><a class="selflink" href="#appendix-A" id="appendix-A">Appendix A</a>.  Acknowledgements</span>

   The author wishes to acknowledge the following for their review and
   constructive criticism of this proposal: Frank Ellermann, J.D. Falk,
   Scott Kitterman, John Levine, Mike Markley, Kelly Wanser, Murray
   Kucherawy, and Alessandro Vesely.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/Appendix%20B.%20%20Example"></a><a class="selflink" href="#appendix-B" id="appendix-B">Appendix B</a>.  Example</span>

   This section contains an example of the use of the extension defined
   by this memo.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/B.1.%20%20Example%20Use%20of%20ARF%20Extension%20Headers"></a><a class="selflink" href="#appendix-B.1" id="appendix-B.1">B.1</a>.  Example Use of ARF Extension Headers</span>

   An ARF-formatted report using the proposed ARF extension fields:

   Message-ID: &lt;433689.81121.example@mta.mail.receiver.example&gt;
   From: "SomeISP Antispam Feedback" &lt;feedback@mail.receiver.example&gt;
   To: arf-failure@sender.example
   Subject: FW: You have a new bill from your bank
   Date: Sat, 8 Oct 2011 15:15:59 -0500 (CDT)
   MIME-Version: 1.0
   Content-Type: multipart/report;
     boundary="------------Boundary-00=_3BCR4Y7kX93yP9uUPRhg";
     report-type=feedback-report
   Content-Transfer-Encoding: 7bit

   --------------Boundary-00=_3BCR4Y7kX93yP9uUPRhg
   Content-Type: text/plain; charset="us-ascii"
   Content-Disposition: inline
   Content-Transfer-Encoding: 7bit

   This is an authentication failure report for an email message
   received from a.sender.example on 8 Oct 2011 20:15:58 +0000 (GMT).
   For more information about this format, please see [<a href="./rfc6591">RFC6591</a>].

   --------------Boundary-00=_3BCR4Y7kX93yP9uUPRhg
   Content-Type: message/feedback-report
   Content-Transfer-Encoding: 7bit

   Feedback-Type: auth-failure
   User-Agent: Someisp!Mail-Feedback/1.0
   Version: 1
   Original-Mail-From: anexample.reply@a.sender.example
   Original-Envelope-Id: o3F52gxO029144
   Authentication-Results: mta1011.mail.tp2.receiver.example;
    dkim=fail (bodyhash) header.d=sender.example
   Auth-Failure: bodyhash



<span class="grey">Fontana                      Standards Track                   [Page 14]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-15"></span>
<span class="grey"><a href="./rfc6591">RFC 6591</a>                 Auth Failure Reporting               April 2012</span>


   DKIM-Canonicalized-Body: VGhpcyBpcyBhIG1lc3NhZ2UgYm9keSB0
     aGF0IGdvdCBtb2RpZmllZCBpbiB0cmFuc2l0LgoKQXQgdGhlIHNhbWU
     gdGltZSB0aGF0IHRoZSBib2R5aGFzaCBmYWlscyB0byB2ZXJpZnksIH
     RoZQptZXNzYWdlIGNvbnRlbnQgaXMgY2xlYXJseSBhYnVzaXZlIG9yI
     HBoaXNoeSwgYXMgdGhlClN1YmplY3QgYWxyZWFkeSBoaW50cy4gIElu
     ZGVlZCwgdGhpcyBib2R5IGFsc28gY29udGFpbnMKdGhlIGZvbGxvd2l
     uZyB0ZXh0OgoKICAgUGxlYXNlIGVudGVyIHlvdXIgZnVsbCBiYW5rIG
     NyZWRlbnRpYWxzIGF0CiAgIGh0dHA6Ly93d3cuc2VuZGVyLmV4YW1wb
     GUvCgpXZSBhcmUgaW1wbHlpbmcgdGhhdCwgYWx0aG91Z2ggbXVsdGlw
     bGUgZmFpbHVyZXMKcmVxdWlyZSBtdWx0aXBsZSByZXBvcnRzLCBhIHN
     pbmdsZSBmYWlsdXJlIGNhbiBiZQpyZXBvcnRlZCBhbG9uZyB3aXRoIH
     BoaXNoaW5nIGluIGEgc2luZ2xlIHJlcG9ydC4K
   DKIM-Domain: sender.example
   DKIM-Identity: @sender.example
   DKIM-Selector: testkey
   Arrival-Date: 8 Oct 2011 20:15:58 +0000 (GMT)
   Source-IP: 192.0.2.1
   Reported-Domain: a.sender.example
   Reported-URI: <a href="http://www.sender.example/">http://www.sender.example/</a>

   --------------Boundary-00=_3BCR4Y7kX93yP9uUPRhg
   Content-Type: text/rfc822-headers
   Content-Transfer-Encoding: 7bit

   Authentication-Results: mta1011.mail.tp2.receiver.example;
    dkim=fail (bodyhash) header.d=sender.example;
    spf=pass smtp.mailfrom=anexample.reply@a.sender.example
   Received: from smtp-out.sender.example
    by mta1011.mail.tp2.receiver.example
    with SMTP id oB85W8xV000169;
    Sat, 08 Oct 2011 13:15:58 -0700 (PDT)
   DKIM-Signature: v=1; c=relaxed/simple; a=rsa-sha256;
    s=testkey; d=sender.example; h=From:To:Subject:Date;
    bh=2jUSOH9NhtVGCQWNr9BrIAPreKQjO6Sn7XIkfJVOzv8=;
    b=AuUoFEfDxTDkHlLXSZEpZj79LICEps6eda7W3deTVFOk4yAUoqOB
    4nujc7YopdG5dWLSdNg6xNAZpOPr+kHxt1IrE+NahM6L/LbvaHut
    KVdkLLkpVaVVQPzeRDI009SO2Il5Lu7rDNH6mZckBdrIx0orEtZV
    4bmp/YzhwvcubU4=
   Received: from mail.sender.example
    by smtp-out.sender.example
    with SMTP id o3F52gxO029144;
    Sat, 08 Oct 2011 13:15:31 -0700 (PDT)
   Received: from internal-client-001.sender.example
    by mail.sender.example
    with SMTP id o3F3BwdY028431;
    Sat, 08 Oct 2011 13:15:24 -0700 (PDT)
   Date: Sat, 8 Oct 2011 16:15:24 -0400 (EDT)
   Reply-To: anexample.reply@a.sender.example



<span class="grey">Fontana                      Standards Track                   [Page 15]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-16"></span>
<span class="grey"><a href="./rfc6591">RFC 6591</a>                 Auth Failure Reporting               April 2012</span>


   From: anexample@a.sender.example
   To: someuser@receiver.example
   Subject: You have a new bill from your bank
   Message-ID: &lt;87913910.1318094604546@out.sender.example&gt;

   --------------Boundary-00=_3BCR4Y7kX93yP9uUPRhg--

   Example 1: Example ARF Report Using These Extensions

   This example ARF message is making the following assertion:

   o  DKIM verification of the signature added within "sender.example"
      failed.

   o  The cause of the verification failure was a mismatch between the
      body contents observed at the verifier and the body hash contained
      in the signature.

Author's Address

   Hilda L. Fontana
   3579 E. Foothill Blvd., Suite 282
   Pasadena, CA  91107
   US

   Phone: +1 626 676 8852
   EMail: hilda@hfontana.com
























Fontana                      Standards Track                   [Page 16]
</pre>
</body></html>