<!DOCTYPE html>
<html class="RFC" lang="en"><head>
<meta charset="utf-8"/>
<meta content="Common,Latin" name="scripts"/>
<meta content="initial-scale=1.0" name="viewport"/>
<title>RFC 9397: Trusted Execution Environment Provisioning (TEEP) Architecture</title>
<meta content="Mingliang Pei" name="author"/>
<meta content="Hannes Tschofenig" name="author"/>
<meta content="Dave Thaler" name="author"/>
<meta content="David Wheeler" name="author"/>
<meta content="
       
A Trusted Execution Environment (TEE) is an environment that
enforces the following: any code within the environment cannot be tampered
with, and any data used by such code cannot be read or tampered with by any
code outside the environment.
This architecture document discusses the motivation for designing and
standardizing a protocol for managing
the lifecycle of Trusted Applications running inside such a TEE.
 
    " name="description"/>
<meta content="xml2rfc 3.17.4" name="generator"/>
<meta content="9397" name="rfc.number"/>
<!-- Generator version information:
  xml2rfc 3.17.4
    Python 3.9.15
    ConfigArgParse 1.5.3
    google-i18n-address 3.0.0
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 4.9.0
    platformdirs 3.8.0
    pycountry 22.3.5
    PyYAML 6.0
    requests 2.28.0
    setuptools 44.1.1
    six 1.16.0
    wcwidth 0.2.5
    weasyprint 56.1
-->
<link href="rfc9397.xml" rel="alternate" type="application/rfc+xml"/>
<link href="#copyright" rel="license"/>
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necessary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

:root {
  --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
  --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
  --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
}

@viewport {
  zoom: 1.0;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: var(--font-sans);
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
svg[font-family~="serif" i], svg [font-family~="serif" i] {
  font-family: var(--font-serif);
}
svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
  font-family: var(--font-sans);
}
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef,
.iref + a[href].internal {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre {
  background-color: #f9f9f9;
  font-family: var(--font-mono);
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: var(--font-sans);
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  .breakable pre {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The following is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
.sourcecode pre,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .artwork > pre,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background slightly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottom margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the compact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div.sourcecode:first-child,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type:only-child {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css"/>
<link href="https://dx.doi.org/10.17487/rfc9397" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <link href="https://datatracker.ietf.org/doc/draft-ietf-teep-architecture-19" rel="prev"/>
  </head>
<body class="xml2rfc">
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 9397</td>
<td class="center">TEEP Architecture</td>
<td class="right">July 2023</td>
</tr></thead>
<tfoot><tr>
<td class="left">Pei, et al.</td>
<td class="center">Informational</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div class="document-information" id="external-metadata"></div>
<div class="document-information" id="internal-metadata">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a class="eref" href="https://www.rfc-editor.org/rfc/rfc9397">9397</a></dd>
<dt class="label-category">Category:</dt>
<dd class="category">Informational</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time class="published" datetime="2023-07">July 2023</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">M. Pei</div>
<div class="org">Broadcom</div>
</div>
<div class="author">
      <div class="author-name">H. Tschofenig</div>
</div>
<div class="author">
      <div class="author-name">D. Thaler</div>
<div class="org">Microsoft</div>
</div>
<div class="author">
      <div class="author-name">D. Wheeler</div>
<div class="org">Amazon</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 9397</h1>
<h1 id="title">Trusted Execution Environment Provisioning (TEEP) Architecture</h1>
<section id="section-abstract">
      <h2 id="abstract"><a class="selfRef" href="#abstract">Abstract</a></h2>
<p id="section-abstract-1">
A Trusted Execution Environment (TEE) is an environment that
enforces the following: any code within the environment cannot be tampered
with, and any data used by such code cannot be read or tampered with by any
code outside the environment.
This architecture document discusses the motivation for designing and
standardizing a protocol for managing
the lifecycle of Trusted Applications running inside such a TEE.<a class="pilcrow" href="#section-abstract-1">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a class="section-name selfRef" href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This document is not an Internet Standards Track specification; it is
            published for informational purposes.<a class="pilcrow" href="#section-boilerplate.1-1">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by the
            Internet Engineering Steering Group (IESG).  Not all documents
            approved by the IESG are candidates for any level of Internet
            Standard; see Section 2 of RFC 7841.<a class="pilcrow" href="#section-boilerplate.1-2">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc9397">https://www.rfc-editor.org/info/rfc9397</a></span>.<a class="pilcrow" href="#section-boilerplate.1-3">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a class="section-name selfRef" href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2023 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a class="pilcrow" href="#section-boilerplate.2-1">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a class="pilcrow" href="#section-boilerplate.2-2">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a class="toplink" href="#" onclick="scroll(0,0)">▲</a><h2 id="name-table-of-contents">
<a class="section-name selfRef" href="#name-table-of-contents">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p class="keepWithNext" id="section-toc.1-1.1.1"><a class="auto internal xref" href="#section-1">1</a>.  <a class="internal xref" href="#name-introduction">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p class="keepWithNext" id="section-toc.1-1.2.1"><a class="auto internal xref" href="#section-2">2</a>.  <a class="internal xref" href="#name-terminology">Terminology</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a class="auto internal xref" href="#section-3">3</a>.  <a class="internal xref" href="#name-use-cases">Use Cases</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p class="keepWithNext" id="section-toc.1-1.3.2.1.1"><a class="auto internal xref" href="#section-3.1">3.1</a>.  <a class="internal xref" href="#name-payment">Payment</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a class="auto internal xref" href="#section-3.2">3.2</a>.  <a class="internal xref" href="#name-authentication">Authentication</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a class="auto internal xref" href="#section-3.3">3.3</a>.  <a class="internal xref" href="#name-internet-of-things">Internet of Things</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a class="auto internal xref" href="#section-3.4">3.4</a>.  <a class="internal xref" href="#name-confidential-cloud-computin">Confidential Cloud Computing</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a class="auto internal xref" href="#section-4">4</a>.  <a class="internal xref" href="#name-architecture">Architecture</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a class="auto internal xref" href="#section-4.1">4.1</a>.  <a class="internal xref" href="#name-system-components">System Components</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a class="auto internal xref" href="#section-4.2">4.2</a>.  <a class="internal xref" href="#name-multiple-tees-in-a-device">Multiple TEEs in a Device</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a class="auto internal xref" href="#section-4.3">4.3</a>.  <a class="internal xref" href="#name-multiple-tams-and-relations">Multiple TAMs and Relationship to TAs</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a class="auto internal xref" href="#section-4.4">4.4</a>.  <a class="internal xref" href="#name-untrusted-apps-trusted-apps">Untrusted Apps, Trusted Apps, and Personalization Data</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.1">
                    <p id="section-toc.1-1.4.2.4.2.1.1"><a class="auto internal xref" href="#section-4.4.1">4.4.1</a>.  <a class="internal xref" href="#name-example-application-deliver">Example: Application Delivery Mechanisms in Intel SGX</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.2">
                    <p id="section-toc.1-1.4.2.4.2.2.1"><a class="auto internal xref" href="#section-4.4.2">4.4.2</a>.  <a class="internal xref" href="#name-example-application-delivery">Example: Application Delivery Mechanisms in Arm TrustZone</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a class="auto internal xref" href="#section-4.5">4.5</a>.  <a class="internal xref" href="#name-entity-relations">Entity Relations</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a class="auto internal xref" href="#section-5">5</a>.  <a class="internal xref" href="#name-keys-and-certificate-types">Keys and Certificate Types</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a class="auto internal xref" href="#section-5.1">5.1</a>.  <a class="internal xref" href="#name-trust-anchors-in-a-teep-age">Trust Anchors in a TEEP Agent</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a class="auto internal xref" href="#section-5.2">5.2</a>.  <a class="internal xref" href="#name-trust-anchors-in-a-tee">Trust Anchors in a TEE</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a class="auto internal xref" href="#section-5.3">5.3</a>.  <a class="internal xref" href="#name-trust-anchors-in-a-tam">Trust Anchors in a TAM</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a class="auto internal xref" href="#section-5.4">5.4</a>.  <a class="internal xref" href="#name-scalability">Scalability</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5">
                <p id="section-toc.1-1.5.2.5.1"><a class="auto internal xref" href="#section-5.5">5.5</a>.  <a class="internal xref" href="#name-message-security">Message Security</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a class="auto internal xref" href="#section-6">6</a>.  <a class="internal xref" href="#name-teep-broker">TEEP Broker</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a class="auto internal xref" href="#section-6.1">6.1</a>.  <a class="internal xref" href="#name-role-of-the-teep-broker">Role of the TEEP Broker</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a class="auto internal xref" href="#section-6.2">6.2</a>.  <a class="internal xref" href="#name-teep-broker-implementation-">TEEP Broker Implementation Consideration</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.1">
                    <p id="section-toc.1-1.6.2.2.2.1.1"><a class="auto internal xref" href="#section-6.2.1">6.2.1</a>.  <a class="internal xref" href="#name-teep-broker-apis">TEEP Broker APIs</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.2">
                    <p id="section-toc.1-1.6.2.2.2.2.1"><a class="auto internal xref" href="#section-6.2.2">6.2.2</a>.  <a class="internal xref" href="#name-teep-broker-distribution">TEEP Broker Distribution</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a class="auto internal xref" href="#section-7">7</a>.  <a class="internal xref" href="#name-attestation">Attestation</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a class="auto internal xref" href="#section-8">8</a>.  <a class="internal xref" href="#name-algorithm-and-attestation-a">Algorithm and Attestation Agility</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a class="auto internal xref" href="#section-9">9</a>.  <a class="internal xref" href="#name-security-considerations">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a class="auto internal xref" href="#section-9.1">9.1</a>.  <a class="internal xref" href="#name-broker-trust-model">Broker Trust Model</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a class="auto internal xref" href="#section-9.2">9.2</a>.  <a class="internal xref" href="#name-data-protection">Data Protection</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a class="auto internal xref" href="#section-9.3">9.3</a>.  <a class="internal xref" href="#name-compromised-ree">Compromised REE</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.4">
                <p id="section-toc.1-1.9.2.4.1"><a class="auto internal xref" href="#section-9.4">9.4</a>.  <a class="internal xref" href="#name-ca-compromise-or-expiry-of-">CA Compromise or Expiry of CA Certificate</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.5">
                <p id="section-toc.1-1.9.2.5.1"><a class="auto internal xref" href="#section-9.5">9.5</a>.  <a class="internal xref" href="#name-compromised-tam">Compromised TAM</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.6">
                <p id="section-toc.1-1.9.2.6.1"><a class="auto internal xref" href="#section-9.6">9.6</a>.  <a class="internal xref" href="#name-malicious-ta-removal">Malicious TA Removal</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.7">
                <p id="section-toc.1-1.9.2.7.1"><a class="auto internal xref" href="#section-9.7">9.7</a>.  <a class="internal xref" href="#name-tee-certificate-expiry-and-">TEE Certificate Expiry and Renewal</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.8">
                <p id="section-toc.1-1.9.2.8.1"><a class="auto internal xref" href="#section-9.8">9.8</a>.  <a class="internal xref" href="#name-keeping-secrets-from-the-ta">Keeping Secrets from the TAM</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.9">
                <p id="section-toc.1-1.9.2.9.1"><a class="auto internal xref" href="#section-9.9">9.9</a>.  <a class="internal xref" href="#name-ree-privacy">REE Privacy</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a class="auto internal xref" href="#section-10">10</a>. <a class="internal xref" href="#name-iana-considerations">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a class="auto internal xref" href="#section-11">11</a>. <a class="internal xref" href="#name-informative-references">Informative References</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a class="auto internal xref" href="#appendix-A"></a><a class="internal xref" href="#name-acknowledgments">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a class="auto internal xref" href="#appendix-B"></a><a class="internal xref" href="#name-contributors">Contributors</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a class="auto internal xref" href="#appendix-C"></a><a class="internal xref" href="#name-authors-addresses">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a class="section-number selfRef" href="#section-1">1. </a><a class="section-name selfRef" href="#name-introduction">Introduction</a>
      </h2>
<p id="section-1-1">Applications executing in a device are exposed to many different attacks
intended to compromise the execution of the application or reveal the
data upon which those applications are operating. These attacks increase
with the number of other applications on the device, with such other
applications coming from potentially untrustworthy sources. The
potential for attacks further increases with the complexity of features
and applications on devices and the unintended interactions among those
features and applications. The risk of attacks on a system increases
as the sensitivity of the applications or data on the device increases.
As an example, exposure of emails from a mail client is likely to be of
concern to its owner, but a compromise of a banking application raises
even greater concerns.<a class="pilcrow" href="#section-1-1">¶</a></p>
<p id="section-1-2">
The Trusted Execution Environment (TEE) concept is designed to let
applications execute in a protected environment that enforces that any code within that
environment cannot be tampered with and that any data used by such code
cannot be read or tampered with by any code outside that environment,
including by a commodity operating system (if present).  In a system with
multiple TEEs, this also means that code in one TEE cannot be read or tampered
with by code in another TEE.<a class="pilcrow" href="#section-1-2">¶</a></p>
<p id="section-1-3">This separation reduces the possibility
of a successful attack on application components and the data contained inside the
TEE. Typically, application components are chosen to execute inside a TEE because
those application components perform security-sensitive operations or operate on
sensitive data. An application component running inside a TEE is commonly referred to
(e.g., in <span>[<a class="cite xref" href="#GPTEE">GPTEE</a>]</span> and <span>[<a class="cite xref" href="#OP-TEE">OP-TEE</a>]</span>) as a
Trusted Application (TA), while an application running outside any TEE, i.e., in the
Rich Execution Environment (REE),
is referred to as an Untrusted Application (UA). 
In the example of a banking application, 
code that relates to the authentication protocol could reside in a TA while the 
application logic including HTTP protocol parsing could be contained in the 
Untrusted Application.  In addition, processing of credit card numbers or account balances could be done in a TA as it is sensitive data.
The precise code split is ultimately a decision of the 
developer based on the assets the person wants to protect according to the threat model.<a class="pilcrow" href="#section-1-3">¶</a></p>
<p id="section-1-4">TEEs are typically used in cases where software or data assets need to be protected from unauthorized access
where threat actors may have physical or administrative access to a device.  
This situation arises, for example, in gaming consoles where anti-cheat
protection is a concern, devices such as ATMs or IoT devices placed in
locations where attackers might have physical access, cell phones or other
devices used for mobile payments, and hosted cloud environments.  Such
environments can be thought of as hybrid devices where one user or
administrator controls the REE and a different (remote) user or administrator
controls a TEE in the same physical device. In
some constrained devices, it may also be the case that there is no REE (only a TEE) and no
local "user" per se, but only a remote TEE administrator.  For further discussion
of such confidential computing use cases and threat model, see <span>[<a class="cite xref" href="#CC-Overview">CC-Overview</a>]</span> and <span>[<a class="cite xref" href="#CC-Technical-Analysis">CC-Technical-Analysis</a>]</span>.<a class="pilcrow" href="#section-1-4">¶</a></p>
<p id="section-1-5">TEEs use hardware enforcement combined with software protection to secure TAs and
their data. TEEs typically offer a more limited set of services to TAs than what is 
normally available to Untrusted Applications.<a class="pilcrow" href="#section-1-5">¶</a></p>
<p id="section-1-6">However, not all TEEs are the same. Different vendors may have different
implementations of TEEs with different security properties, features, and control mechanisms to operate on TAs. 
Some
vendors may market multiple different TEEs themselves, with different
properties attuned to different markets. A device vendor may integrate
one or more TEEs into their devices depending on market needs.<a class="pilcrow" href="#section-1-6">¶</a></p>
<p id="section-1-7">To simplify the life of TA developers interacting
with TAs in a TEE, an interoperable protocol for managing TAs running in
different TEEs of various devices is needed. This software update protocol 
needs to make sure that compatible trusted and Untrusted Components (if any) of an 
application are installed on the correct device. In this TEE ecosystem,
the need often arises for an external trusted party to verify the
identity, claims, and permissions of TA developers, devices, and their TEEs.
This external trusted party is the Trusted Application Manager (TAM).<a class="pilcrow" href="#section-1-7">¶</a></p>
<p id="section-1-8">The Trusted Execution Environment Provisioning (TEEP) protocol addresses
the following problems:<a class="pilcrow" href="#section-1-8">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-9.1">An installer of an Untrusted Application that depends on a given TA
wants to request installation of that TA in the device's TEE
so that the installation of the Untrusted Application can complete, but the TEE
needs to verify whether such a TA is actually authorized to
run in the TEE and consume potentially scarce TEE resources.<a class="pilcrow" href="#section-1-9.1">¶</a>
</li>
        <li class="normal" id="section-1-9.2">A TA developer providing a TA whose code itself is considered
confidential wants to determine 
security-relevant information of a device before allowing their
TA to be provisioned to the TEE within the device. An example 
is the verification of 
the type of TEE included in a device and its capability of 
providing the security protections required.<a class="pilcrow" href="#section-1-9.2">¶</a>
</li>
        <li class="normal" id="section-1-9.3">A TEE in a device needs to determine whether an entity
that wants to manage a TA in the device is authorized to manage TAs
in the TEE and what TAs the entity is permitted to manage.<a class="pilcrow" href="#section-1-9.3">¶</a>
</li>
        <li class="normal" id="section-1-9.4">A Device Administrator wants to determine if a TA exists on a device
(i.e., is installed in the TEE) and, if not, install the TA in the TEE.<a class="pilcrow" href="#section-1-9.4">¶</a>
</li>
        <li class="normal" id="section-1-9.5">A Device Administrator wants to check whether a TA in a
device's TEE is the most up-to-date version, and if not, update the
TA in the TEE.<a class="pilcrow" href="#section-1-9.5">¶</a>
</li>
        <li class="normal" id="section-1-9.6">A Device Administrator wants to remove a TA from a device's TEE if
the TA developer is no longer maintaining that TA, when the TA has
been revoked, or if the TA is not used for other reasons (e.g., due to an 
expired subscription).<a class="pilcrow" href="#section-1-9.6">¶</a>
</li>
      </ul>
<p id="section-1-10">For TEEs that simply verify and load signed TAs from an untrusted
filesystem, classic application distribution protocols can be used
without modification.  On the other hand, the problems listed in the bullets above
require a new protocol -- the TEEP protocol. The TEEP protocol is 
a solution for TEEs that can install and enumerate TAs in a TEE-secured
location where another domain-specific protocol standard (e.g., <span>[<a class="cite xref" href="#GSMA">GSMA</a>]</span> and <span>[<a class="cite xref" href="#OTRP">OTRP</a>]</span>) that meets the needs is not already in use.<a class="pilcrow" href="#section-1-10">¶</a></p>
</section>
</div>
<div id="terminology">
<section id="section-2">
      <h2 id="name-terminology">
<a class="section-number selfRef" href="#section-2">2. </a><a class="section-name selfRef" href="#name-terminology">Terminology</a>
      </h2>
<p id="section-2-1">The following terms are used:<a class="pilcrow" href="#section-2-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2-2">
        <dt id="section-2-2.1">App Store:</dt>
        <dd id="section-2-2.2" style="margin-left: 1.5em">An online location from which Untrusted Applications can be downloaded.<a class="pilcrow" href="#section-2-2.2">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.3">Device:</dt>
        <dd id="section-2-2.4" style="margin-left: 1.5em">A physical piece of hardware that hosts one or more TEEs,
often along with
an REE.<a class="pilcrow" href="#section-2-2.4">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.5">Device Administrator:</dt>
        <dd id="section-2-2.6" style="margin-left: 1.5em">An entity that is responsible for administration
of a device, which could be the Device Owner. A Device Administrator
has privileges on the device to install and remove Untrusted Applications and TAs,
approve or reject Trust Anchors, and approve or reject TA developers,
among other possible privileges on the device. A Device Administrator can
manage the list of allowed TAMs by modifying the list of Trust
Anchors on the device. Although a Device Administrator may have
privileges and device-specific controls to locally administer a
device, the Device Administrator may choose to remotely
administer a device through a TAM.<a class="pilcrow" href="#section-2-2.6">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.7">Device Owner:</dt>
        <dd id="section-2-2.8" style="margin-left: 1.5em">A device is always owned by someone. In some cases, it is common for
the (primary) device user to also own the device, making the device
user/owner also the Device Administrator. In enterprise environments,
it is more common for the enterprise to own the device and for any device
user to have no or limited administration rights. In this case, the
enterprise appoints a Device Administrator that is not the Device
Owner.<a class="pilcrow" href="#section-2-2.8">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.9">Device User:</dt>
        <dd id="section-2-2.10" style="margin-left: 1.5em">A human being that uses a device. Many devices have
a single device user. Some devices have a primary device user with
other human beings as secondary device users (e.g., a parent allowing
children to use their tablet or laptop). Other devices are not used
by a human being; hence, they have no device user.<a class="pilcrow" href="#section-2-2.10">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.11">Personalization Data:</dt>
        <dd id="section-2-2.12" style="margin-left: 1.5em">A set of configuration data that is specific to
   the device or user. The Personalization Data may depend on the type of
   TEE, a particular TEE instance, the TA, and even the user of the device.
   An example of Personalization Data might be a secret symmetric key used
   by a TA to communicate with some service.<a class="pilcrow" href="#section-2-2.12">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.13">Raw Public Key:</dt>
        <dd id="section-2-2.14" style="margin-left: 1.5em">A raw public key consists of only the algorithm identifier
(type) of the key and the cryptographic public key material, such as the
SubjectPublicKeyInfo structure of a PKIX certificate <span>[<a class="cite xref" href="#RFC5280">RFC5280</a>]</span>. Other
serialization formats that do not rely on ASN.1 may also be used.<a class="pilcrow" href="#section-2-2.14">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.15">Rich Execution Environment (REE):</dt>
        <dd id="section-2-2.16" style="margin-left: 1.5em">An environment that is provided
and governed by a typical OS (e.g., Linux, Windows, Android, iOS),
potentially in conjunction with other supporting operating systems
and hypervisors; it is outside of the TEE(s) managed by the TEEP protocol. This environment and
applications running on it are considered untrusted (or more precisely,
less trusted than a TEE).<a class="pilcrow" href="#section-2-2.16">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.17">Trust Anchor:</dt>
        <dd id="section-2-2.18" style="margin-left: 1.5em">As defined in <span>[<a class="cite xref" href="#RFC6024">RFC6024</a>]</span> and <span>[<a class="cite xref" href="#RFC9019">RFC9019</a>]</span>,
a Trust Anchor "represents an authoritative entity via a public
key and associated data.  The public key is used to verify digital
signatures, and the associated data is used to constrain the types
of information for which the trust anchor is authoritative."
The Trust Anchor may be a certificate, a raw public key, or other structure,
as appropriate. It can be a non-root certificate when it is a certificate.<a class="pilcrow" href="#section-2-2.18">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.19">Trust Anchor Store:</dt>
        <dd id="section-2-2.20" style="margin-left: 1.5em">As defined in <span>[<a class="cite xref" href="#RFC6024">RFC6024</a>]</span>, a "trust anchor store is a set of one
        or more trust anchors stored in a device...  A device may have more
        than one trust anchor store, each of which may be used by one or more
        applications."  As noted in <span>[<a class="cite xref" href="#RFC9019">RFC9019</a>]</span>, "a trust anchor
        store must resist modification against unauthorized insertion,
        deletion, and modification."<a class="pilcrow" href="#section-2-2.20">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.21">Trusted
        Application (TA):</dt>
        <dd id="section-2-2.22" style="margin-left: 1.5em">An application (or, in some implementations,
        an application component) that runs in a TEE.<a class="pilcrow" href="#section-2-2.22">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.23">Trusted Application Manager (TAM):</dt>
        <dd id="section-2-2.24" style="margin-left: 1.5em">An entity that manages Trusted Applications and other Trusted Components running in TEEs of various devices.<a class="pilcrow" href="#section-2-2.24">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.25">Trusted Component:</dt>
        <dd id="section-2-2.26" style="margin-left: 1.5em">A set of code and/or data in a TEE managed as a unit
by a Trusted Application Manager.  Trusted Applications and
Personalization Data are thus managed by being included in
Trusted Components.  Trusted OS code or trusted firmware can also be
expressed as Trusted Components that a Trusted Component depends on.<a class="pilcrow" href="#section-2-2.26">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.27">Trusted Component Developer:</dt>
        <dd id="section-2-2.28" style="margin-left: 1.5em">An entity that develops one or
more Trusted Components.<a class="pilcrow" href="#section-2-2.28">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.29">Trusted Component Signer:</dt>
        <dd id="section-2-2.30" style="margin-left: 1.5em">An entity that signs a Trusted Component with
a key that a TEE will trust. The signer might or might not be the
same entity as the Trusted Component Developer. For example, a Trusted Component might
be signed (or re-signed) by a Device Administrator if the TEE will
only trust the Device Administrator. 
A Trusted Component might also be encrypted
if the code is considered confidential, for example, when a developer wants to 
provide a TA without revealing its code to others.<a class="pilcrow" href="#section-2-2.30">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.31">Trusted Execution Environment (TEE):</dt>
        <dd id="section-2-2.32" style="margin-left: 1.5em">An execution environment that enforces that
only authorized code can execute within the TEE and data used by that
code cannot be read or tampered with by code outside the TEE.
A TEE also generally has a unique device  credential that cannot be cloned.  
There are multiple technologies that can be used to implement
a TEE, and the level of security achieved varies accordingly.
In addition, TEEs typically use an isolation mechanism between Trusted Applications to ensure
that one TA cannot read, modify, or delete the data and code of another
TA.<a class="pilcrow" href="#section-2-2.32">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.33">Untrusted Application (UA):</dt>
        <dd id="section-2-2.34" style="margin-left: 1.5em">An application running in an REE. An Untrusted Application
might depend on one or more TAs.<a class="pilcrow" href="#section-2-2.34">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
</section>
</div>
<div id="use-cases">
<section id="section-3">
      <h2 id="name-use-cases">
<a class="section-number selfRef" href="#section-3">3. </a><a class="section-name selfRef" href="#name-use-cases">Use Cases</a>
      </h2>
<div id="payment">
<section id="section-3.1">
        <h3 id="name-payment">
<a class="section-number selfRef" href="#section-3.1">3.1. </a><a class="section-name selfRef" href="#name-payment">Payment</a>
        </h3>
<p id="section-3.1-1">A payment application in a mobile device requires high security and
trust in the hosting device. Payments initiated from a mobile
device can use a Trusted Application
to provide strong identification and proof of transaction.<a class="pilcrow" href="#section-3.1-1">¶</a></p>
<p id="section-3.1-2">For a mobile payment application, some biometric identification
information could also be stored in a TEE. The mobile payment
application can use such information for unlocking the device and local identification of the user.<a class="pilcrow" href="#section-3.1-2">¶</a></p>
<p id="section-3.1-3">A trusted user interface (UI) may be used in a mobile device or point-of-sale device to
prevent malicious software from stealing sensitive user input data.
Such an implementation often relies on a TEE for providing access 
to peripherals, such as PIN input or a trusted display, so that
the REE cannot observe or tamper with the user input or output.<a class="pilcrow" href="#section-3.1-3">¶</a></p>
</section>
</div>
<div id="authentication">
<section id="section-3.2">
        <h3 id="name-authentication">
<a class="section-number selfRef" href="#section-3.2">3.2. </a><a class="section-name selfRef" href="#name-authentication">Authentication</a>
        </h3>
<p id="section-3.2-1">For better security of authentication, a device may store its
keys and cryptographic libraries inside a TEE, limiting access to 
cryptographic functions via a well-defined interface and thereby 
reducing access to keying material.<a class="pilcrow" href="#section-3.2-1">¶</a></p>
</section>
</div>
<div id="internet-of-things">
<section id="section-3.3">
        <h3 id="name-internet-of-things">
<a class="section-number selfRef" href="#section-3.3">3.3. </a><a class="section-name selfRef" href="#name-internet-of-things">Internet of Things</a>
        </h3>
<p id="section-3.3-1">Weak security in Internet of Things (IoT) devices has been posing threats to 
critical infrastructure, i.e., assets that are essential for the functioning
of a society and economy. It is desirable that IoT devices can prevent malware
from manipulating actuators (e.g., unlocking a door) or
stealing or modifying sensitive data, such as authentication credentials
in the device. A TEE can be one of the best ways to implement such IoT
security functions. For example, <span>[<a class="cite xref" href="#GPTEE">GPTEE</a>]</span> uses the term "trusted peripheral" to refer to such things being
accessible only from the TEE, and this concept is used in some GlobalPlatform-compliant devices today.<a class="pilcrow" href="#section-3.3-1">¶</a></p>
</section>
</div>
<div id="confidential-cloud-computing">
<section id="section-3.4">
        <h3 id="name-confidential-cloud-computin">
<a class="section-number selfRef" href="#section-3.4">3.4. </a><a class="section-name selfRef" href="#name-confidential-cloud-computin">Confidential Cloud Computing</a>
        </h3>
<p id="section-3.4-1">A tenant can store sensitive data, such as customer details or credit
card numbers, in a TEE in a cloud computing
server such that only the tenant can access the data, which prevents
the cloud hosting provider from accessing the data. A tenant can
run TAs inside a server TEE for secure operation and enhanced
data security. This provides benefits not only to tenants with
better data security but also to cloud hosting providers for reduced
liability and increased cloud adoption.<a class="pilcrow" href="#section-3.4-1">¶</a></p>
</section>
</div>
</section>
</div>
<div id="architecture">
<section id="section-4">
      <h2 id="name-architecture">
<a class="section-number selfRef" href="#section-4">4. </a><a class="section-name selfRef" href="#name-architecture">Architecture</a>
      </h2>
<div id="system-components">
<section id="section-4.1">
        <h3 id="name-system-components">
<a class="section-number selfRef" href="#section-4.1">4.1. </a><a class="section-name selfRef" href="#name-system-components">System Components</a>
        </h3>
<p id="section-4.1-1"><a class="auto internal xref" href="#notionalarch">Figure 1</a> shows the main components in a typical device with an REE and a
TEE. Full descriptions of
components not previously defined are provided below. Interactions of
all components are further explained in the following paragraphs.<a class="pilcrow" href="#section-4.1-1">¶</a></p>
<span id="name-notional-architecture-of-te"></span><div id="notionalarch">
<figure id="figure-1">
          <div class="alignLeft art-text artwork" id="section-4.1-2.1">
<pre>+---------------------------------------------+
| Device                                      |     Trusted Component
|                          +--------+         |               Signer
|    +---------------+     |        |--------------+              |
|    | TEE-1         |     | TEEP   |-----------+  |              |
|    | +--------+    |  +--| Broker |         | |  |   +-------+  |
|    | | TEEP   |    |  |  |        |&lt;-----+  | |  +--&gt;|       |&lt;-+
|    | | Agent  |&lt;------+  |        |      |  | |    +-| TAM-1 |
|    | +--------+    |     |        |&lt;---+ |  | +---&gt;| |       |&lt;-+
|    |               |     +--------+    | |  |      | +-------+  |
|    | +----+ +----+ |                   | |  |      | TAM-2 |    |
|  +--&gt;|TA-1| |TA-2| |        +-------+  | |  |      +-------+    |
|  | | |    | |    |&lt;---------| UA-2  |--+ |  |                   |
|  | | +----+ +----+ |  +-------+     |    |  |               Device
|  | +---------------+  | UA-1  |     |    |  |         Administrator
|  |                    |       |     |    |  |
|  +--------------------|       |-----+    |  |
|                       |       |----------+  |
|                       +-------+             |
+---------------------------------------------+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-1">Figure 1</a>:
<a class="selfRef" href="#name-notional-architecture-of-te">Notional Architecture of TEEP</a>
          </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4.1-3">
          <dt id="section-4.1-3.1">Trusted Component Signer and Device Administrator:</dt>
          <dd id="section-4.1-3.2" style="margin-left: 1.5em">Trusted Component Signers and Device Administrators utilize the services
of a TAM to manage TAs on devices. Trusted Component Signers do not directly interact
with devices. Device Administrators may elect to use a TAM for remote administration
of TAs instead of managing each device directly.<a class="pilcrow" href="#section-4.1-3.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-3.3">Trusted Application Manager (TAM):</dt>
          <dd id="section-4.1-3.4" style="margin-left: 1.5em">
            <p id="section-4.1-3.4.1">A TAM is responsible for
            performing lifecycle management activity on Trusted Components on
            behalf of Trusted Component Signers and Device Administrators.
            This includes installation and deletion of Trusted Components and
            may include, for example, over-the-air updates to keep Trusted
            Components up-to-date and clean up when Trusted Components should
            be removed. TAMs may provide services that make it easier for
            Trusted Component Signers or Device Administrators to use the
            TAM's service to manage multiple devices, although that is not
            required of a TAM.<a class="pilcrow" href="#section-4.1-3.4.1">¶</a></p>
<p id="section-4.1-3.4.2">
The TAM performs its management of Trusted Components on the device through
interactions with a device's TEEP Broker, which relays
messages between a TAM and a TEEP Agent running inside the TEE. 
TEEP authentication is performed between a TAM and a TEEP Agent.<a class="pilcrow" href="#section-4.1-3.4.2">¶</a></p>
<p id="section-4.1-3.4.3">
When the TEEP Agent runs in a user or enterprise device, network and application firewalls
normally protect user and enterprise devices from arbitrary connections from external network
entities. In such a deployment, a TAM outside that network might not be able to directly
contact a TEEP Agent but needs to wait for the TEEP Broker to contact it.
The architecture in <a class="auto internal xref" href="#notionalarch">Figure 1</a> accommodates this case as well as other less restrictive cases
by leaving such details to an appropriate TEEP transport protocol (e.g., <span>[<a class="cite xref" href="#I-D.ietf-teep-otrp-over-http">TEEP-HTTP</a>]</span>,
though other transport protocols can be defined under the TEEP protocol for other cases).<a class="pilcrow" href="#section-4.1-3.4.3">¶</a></p>
<p id="section-4.1-3.4.4">
A TAM may be publicly available for use by many Trusted Component Signers, or a TAM
may be private and accessible by only one or a limited number of
Trusted Component Signers. It is expected that many enterprises, manufacturers, and network carriers
will run their own private TAM.<a class="pilcrow" href="#section-4.1-3.4.4">¶</a></p>
<p id="section-4.1-3.4.5">
A Trusted Component Signer or Device Administrator chooses a particular TAM based on
whether the TAM is trusted by a device or set of devices. The
TAM is trusted by a device if the TAM's public key is, or chains up to,
an authorized Trust Anchor in the device and conforms with all constraints defined in 
the Trust Anchor. A Trusted Component Signer or Device Administrator may run
their own TAM, but the devices they wish to manage must include
this TAM's public key or certificate, or a certificate it chains up to, in the
Trust Anchor Store.<a class="pilcrow" href="#section-4.1-3.4.5">¶</a></p>
<p id="section-4.1-3.4.6">
A Trusted Component Signer or Device Administrator is free to utilize multiple TAMs. This may
be required for managing Trusted Components on multiple different types of devices
from different manufacturers or mobile devices on
different network carriers, since
the Trust Anchor Store on these different devices may contain keys
for different
TAMs. To overcome this limitation, Device Administrator may be able to add their own TAM's
public key or certificate, or a certificate it chains up to, to the Trust Anchor Store on all their devices.<a class="pilcrow" href="#section-4.1-3.4.6">¶</a></p>
<p id="section-4.1-3.4.7">
Any entity is free to operate a TAM. For a TAM to be successful, it must
have its public key or certificate installed in a device's Trust Anchor Store.
A TAM may set up a relationship with device manufacturers or network carriers
to have them install the TAM's keys in their device's Trust Anchor Store.
Alternatively, a TAM may publish its certificate and allow Device
Administrators to install the TAM's certificate in their devices as
an aftermarket action.<a class="pilcrow" href="#section-4.1-3.4.7">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-3.5">TEEP Broker:</dt>
          <dd id="section-4.1-3.6" style="margin-left: 1.5em">A TEEP Broker is an application component running
          in a Rich Execution Environment (REE) that enables the message
          protocol exchange between a TAM and a TEE in a device. A TEEP Broker
          does not process messages on behalf of a TEE but is merely
          responsible for relaying messages from the TAM to the TEE and for
          returning the TEE's responses to the TAM.  In devices with no REE
          (e.g., a microcontroller where all code runs in an environment that
          meets the definition of a Trusted Execution Environment in <a class="auto internal xref" href="#terminology">Section 2</a>), the TEEP Broker would be absent, and
          the TEEP protocol transport would be implemented inside the TEE
          itself.<a class="pilcrow" href="#section-4.1-3.6">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-3.7">TEEP Agent:</dt>
          <dd id="section-4.1-3.8" style="margin-left: 1.5em">The TEEP Agent is a processing module running inside
a TEE that receives TAM requests (typically relayed via a TEEP Broker
that runs in an REE). A TEEP Agent in the TEE may parse or
forward requests to other processing modules in a TEE, which is
up to a TEE provider's implementation. 
A response message
corresponding to a TAM request is sent back to the TAM, again typically
relayed via a TEEP Broker.<a class="pilcrow" href="#section-4.1-3.8">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-3.9">Certification Authority (CA):</dt>
          <dd id="section-4.1-3.10" style="margin-left: 1.5em">A CA is an entity that issues digital 
certificates (especially X.509 certificates) and vouches for the 
binding between the data items in a certificate <span>[<a class="cite xref" href="#RFC4949">RFC4949</a>]</span>. 
Certificates are then used for authenticating a device, a TAM, or a 
Trusted Component Signer, as discussed in <a class="auto internal xref" href="#trustanchors">Section 5</a>.  The CAs do not need to be the same;
different CAs can be chosen by each TAM, and different device CAs
can be used by different device manufacturers.<a class="pilcrow" href="#section-4.1-3.10">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="multiple-tees-in-a-device">
<section id="section-4.2">
        <h3 id="name-multiple-tees-in-a-device">
<a class="section-number selfRef" href="#section-4.2">4.2. </a><a class="section-name selfRef" href="#name-multiple-tees-in-a-device">Multiple TEEs in a Device</a>
        </h3>
<p id="section-4.2-1">Some devices might implement multiple TEEs. 
In these cases, there might be one shared TEEP Broker 
that interacts with all the TEEs in the device.
However, some TEEs (for example, SGX <span>[<a class="cite xref" href="#SGX">SGX</a>]</span>) present themselves as separate containers
within memory without a controlling manager within the TEE. As such,
there might be multiple TEEP Brokers in the REE,
where each TEEP Broker communicates with one or more TEEs associated with it.<a class="pilcrow" href="#section-4.2-1">¶</a></p>
<p id="section-4.2-2">It is up to the REE and the Untrusted Applications
how they select the correct TEEP Broker. Verification that the correct TA
has been reached then becomes a matter of properly verifying TA attestations,
which are unforgeable.<a class="pilcrow" href="#section-4.2-2">¶</a></p>
<p id="section-4.2-3">The multiple TEEP Broker approach is shown in the diagram below.
For brevity, TEEP Broker 2 is shown interacting with only one TAM, Untrusted Application, and TEE, but no such limitations are intended to be implied in the architecture.<a class="pilcrow" href="#section-4.2-3">¶</a></p>
<span id="name-notional-architecture-of-tee"></span><div id="notionalarch2">
<figure id="figure-2">
          <div class="alignLeft art-text artwork" id="section-4.2-4.1">
<pre>+-------------------------------------------+
| Device                                    |     Trusted Component
|                                           |               Signer
|    +---------------+                      |                  |
|    | TEE-1         |                      |                  |
|    | +-------+     |     +--------+       |      +--------+  |
|    | | TEEP  |     |     | TEEP   |-------------&gt;|        |&lt;-+
|    | | Agent |&lt;----------| Broker |       |      |        | TA
|    | | 1     |     |     | 1      |---------+    |        |
|    | +-------+     |     |        |       | |    |        |
|    |               |     |        |&lt;---+  | |    |        |
|    | +----+ +----+ |     |        |    |  | |  +-|  TAM-1 | Policy
|    | |TA-1| |TA-2| |     |        |&lt;-+ |  | +-&gt;| |        |&lt;-+
|  +--&gt;|    | |    |&lt;---+  +--------+  | |  |    | +--------+  |
|  | | +----+ +----+ |  |              | |  |    | TAM-2  |    |
|  | |               |  |   +-------+  | |  |    +--------+    |
|  | +---------------+  +---| UA-2  |--+ |  |       ^          |
|  |                    +-------+   |    |  |       |       Device
|  +--------------------| UA-1  |   |    |  |       |   Administrator
|                +------|       |   |    |  |       |
|    +-----------|---+  |       |---+    |  |       |
|    | TEE-2     |   |  |       |--------+  |       |
|    | +------+  |   |  |       |-------+   |       |
|    | | TEEP |  |   |  +-------+       |   |       |
|    | | Agent|&lt;-------+                |   |       |
|    | | 2    |  |   | |                |   |       |
|    | +------+  |   | |                |   |       |
|    |           |   | |                |   |       |
|    | +----+    |   | |                |   |       |
|    | |TA-3|&lt;---+   | |   +---------+  |   |       |
|    | |    |        | |   | TEEP    |&lt;-+   |       |
|    | +----+        | +---| Broker  |      |       |
|    |               |     | 2       |--------------+
|    +---------------+     +---------+      |
|                                           |
+-------------------------------------------+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-2">Figure 2</a>:
<a class="selfRef" href="#name-notional-architecture-of-tee">Notional Architecture of TEEP with multiple TEEs</a>
          </figcaption></figure>
</div>
<p id="section-4.2-5">In the diagram above, TEEP Broker 1 controls interactions with the TAs in TEE-1,
and TEEP Broker 2 controls interactions with the TAs in TEE-2. 
This presents some challenges for a TAM in completely managing the device,
since a TAM may not interact with all the TEEP Brokers on a particular
platform. In addition, since TEEs may be physically separated, with wholly
different resources, there may be no need for TEEP Brokers to share
information on installed Trusted Components or resource usage.<a class="pilcrow" href="#section-4.2-5">¶</a></p>
</section>
</div>
<div id="multiple-tams-and-relationship-to-tas">
<section id="section-4.3">
        <h3 id="name-multiple-tams-and-relations">
<a class="section-number selfRef" href="#section-4.3">4.3. </a><a class="section-name selfRef" href="#name-multiple-tams-and-relations">Multiple TAMs and Relationship to TAs</a>
        </h3>
<p id="section-4.3-1">As shown in <a class="auto internal xref" href="#notionalarch2">Figure 2</a>, a TEEP Broker provides communication between 
one or more TEEP Agents and one or more TAMs. The selection of which TAM to interact with might be
made with or without input from an Untrusted Application but is ultimately
the decision of a TEEP Agent.<a class="pilcrow" href="#section-4.3-1">¶</a></p>
<p id="section-4.3-2">For any given Trusted Component, a TEEP Agent is assumed to be able to determine whether that Trusted Component is installed (or minimally, is running) in a TEE with
which the TEEP Agent is associated.<a class="pilcrow" href="#section-4.3-2">¶</a></p>
<p id="section-4.3-3">Each Trusted Component is digitally signed, protecting its integrity and linking
the Trusted Component back to the Trusted Component Signer. The Trusted Component Signer is often the Trusted Component Developer but, in
some cases, might be another party such as a Device Administrator
or other party
to whom the code has been licensed (in which case, the same code might
be signed by multiple licensees and distributed as if it were different TAs).<a class="pilcrow" href="#section-4.3-3">¶</a></p>
<p id="section-4.3-4">A Trusted Component Signer selects one or more TAMs and communicates the Trusted Component(s) to the TAM.
For example, the Trusted Component Signer might choose TAMs based upon the markets into which the TAM can provide access. There
may be TAMs that provide services to specific types of devices, device
operating systems, specific geographical regions, or network carriers. A Trusted Component Signer may be
motivated to utilize multiple TAMs in order to maximize market penetration
and availability on multiple types of devices. This means that the same Trusted Component
will often be available through multiple TAMs.<a class="pilcrow" href="#section-4.3-4">¶</a></p>
<p id="section-4.3-5">When the developer of an Untrusted Application that depends on a Trusted Component publishes
the Untrusted Application to an app store or other app repository, the developer
optionally binds the Untrusted Application with a manifest that identifies
what TAMs can be contacted for
the Trusted Component. In some situations, a Trusted Component may only be available via a single TAM; this is likely the case
for enterprise applications or Trusted Component Signers serving a closed community. For broad public apps,
there will likely be multiple TAMs in the Untrusted Application's manifest, one servicing one brand of mobile
device and another servicing a different manufacturer, etc. Because different devices and manufacturers trust different TAMs, the manifest can include multiple
TAMs that support the required Trusted Component.<a class="pilcrow" href="#section-4.3-5">¶</a></p>
<p id="section-4.3-6">When a TEEP Broker receives a request (see the RequestTA API in <a class="auto internal xref" href="#apis">Section 6.2.1</a>) from an Untrusted Application to install a Trusted Component,
a list of TAM URIs may be provided for that Trusted Component, and the request is passed to the TEEP Agent.
If the TEEP Agent decides that the Trusted Component needs to be installed, the TEEP Agent selects a single TAM URI
that is consistent with the list of trusted TAMs provisioned in the TEEP Agent, invokes the
HTTP transport for TEEP to connect to the TAM URI, and begins a TEEP protocol exchange.  When the TEEP Agent
subsequently receives the Trusted Component to install and the Trusted Component's manifest indicates dependencies
on any other Trusted Components, each dependency can include a list of TAM URIs for the
relevant dependency.  If such dependencies exist that are prerequisites to install the Trusted Component,
then the TEEP Agent recursively follows the same procedure for each dependency that needs to be installed
or updated, including selecting a TAM URI that is consistent with the list of trusted TAMs provisioned
on the device and beginning a TEEP exchange.  If multiple TAM URIs are considered trusted,
only one needs to be contacted, and they can be attempted in some order until one responds.<a class="pilcrow" href="#section-4.3-6">¶</a></p>
<p id="section-4.3-7">Separate from the Untrusted Application's manifest, this framework relies on the use of the manifest 
format in <span>[<a class="cite xref" href="#I-D.ietf-suit-manifest">SUIT-MANIFEST</a>]</span> for expressing how to install a Trusted Component, as well as any
dependencies on other TEE components and versions.
That is, dependencies from Trusted Components on other Trusted Components can be expressed in a Software Update for the Internet of Things (SUIT) manifest,
including dependencies on any other TAs, trusted OS code (if any), or trusted firmware.
Installation steps can also be expressed in a SUIT manifest.<a class="pilcrow" href="#section-4.3-7">¶</a></p>
<p id="section-4.3-8">For example, TEEs compliant
with GlobalPlatform <span>[<a class="cite xref" href="#GPTEE">GPTEE</a>]</span> may have a notion of a "security domain" (which is a grouping of
one or more TAs installed on a device that can share information within such a group)
that must be created and into which one or more TAs can then be installed. It is thus up
to the SUIT manifest to express a dependency on having such a security domain existing
or being created first, as appropriate.<a class="pilcrow" href="#section-4.3-8">¶</a></p>
<p id="section-4.3-9">Updating a Trusted Component may cause compatibility issues with any Untrusted Applications or other
components that depend on the updated Trusted Component, just like updating the OS or a shared library
could impact an Untrusted Application.  Thus, an implementation needs to take such issues into account.<a class="pilcrow" href="#section-4.3-9">¶</a></p>
</section>
</div>
<div id="untrusted-apps-trusted-apps-and-personalization-data">
<section id="section-4.4">
        <h3 id="name-untrusted-apps-trusted-apps">
<a class="section-number selfRef" href="#section-4.4">4.4. </a><a class="section-name selfRef" href="#name-untrusted-apps-trusted-apps">Untrusted Apps, Trusted Apps, and Personalization Data</a>
        </h3>
<p id="section-4.4-1">In TEEP, there is an explicit relationship and dependence between an Untrusted Application
in an REE and one or more TAs in a TEE, as shown in <a class="auto internal xref" href="#notionalarch2">Figure 2</a>.
For most purposes, an Untrusted Application that uses one or more TAs in a TEE
appears no different from any other Untrusted Application in the REE. However, the way
the Untrusted Application and its corresponding TAs are packaged, delivered, and installed on
the device can vary. The variations depend on whether the Untrusted Application and TA are bundled
together or provided separately, and this has implications to the management of
the TAs in a TEE. In addition to the Untrusted Application and TA(s), the TA(s) and/or TEE may 
also require additional data to personalize the TA to the device or a user.
Implementations of the TEEP protocol must support encryption to preserve the confidentiality of such Personalization Data,
which may potentially contain sensitive data. The encryption is used to ensure that no personalization data 
is sent in the clear. Implementations must also support mechanisms for integrity protection of such Personalization Data.
Other than the requirement to support confidentiality and integrity protection,
the TEEP architecture places no limitations or requirements on the Personalization Data.<a class="pilcrow" href="#section-4.4-1">¶</a></p>
<p id="section-4.4-2">There are multiple possible cases for bundling of an Untrusted Application, TA(s), and Personalization Data.
Such cases include (possibly among others):<a class="pilcrow" href="#section-4.4-2">¶</a></p>
<ol class="normal type-1" id="section-4.4-3" start="1" type="1">
<li id="section-4.4-3.1">The Untrusted Application, TA(s), and Personalization Data are all bundled together in a single
package by a Trusted Component Signer and either provided to the TEEP Broker through the TAM or provided separately (with encrypted Personalization Data), with
key material needed to decrypt and install the Personalization
Data and TA provided by a TAM.<a class="pilcrow" href="#section-4.4-3.1">¶</a>
</li>
          <li id="section-4.4-3.2">The Untrusted Application and the TA(s) are bundled together in a single package, which a TAM or
a publicly accessible app store maintains, and the Personalization Data
is separately provided by the Personalization Data provider's TAM.<a class="pilcrow" href="#section-4.4-3.2">¶</a>
</li>
          <li id="section-4.4-3.3">All components are independent packages. The Untrusted Application is installed through some
independent or device-specific mechanism, and one or more TAMs provide (directly or indirectly by reference)
the TA(s) and Personalization Data.<a class="pilcrow" href="#section-4.4-3.3">¶</a>
</li>
          <li id="section-4.4-3.4">The TA(s) and Personalization Data are bundled together into a package provided by a TAM,
while the Untrusted Application is installed through some independent
or device-specific mechanism, such as an app store.<a class="pilcrow" href="#section-4.4-3.4">¶</a>
</li>
          <li id="section-4.4-3.5">Encrypted Personalization Data is bundled into a package distributed with the Untrusted
Application, while the TA(s) and key material needed to decrypt and install the Personalization Data
are in a separate package provided by a TAM. Personalization Data is encrypted with a key
unique to that specific TEE, as discussed in <a class="auto internal xref" href="#trustanchors">Section 5</a>.<a class="pilcrow" href="#section-4.4-3.5">¶</a>
</li>
        </ol>
<p id="section-4.4-4">The TEEP protocol can treat each TA, any dependencies the TA has, and Personalization Data as
separate Trusted Components with separate installation steps that are expressed in SUIT manifests, and a SUIT manifest might contain or reference multiple binaries (see <span>[<a class="cite xref" href="#I-D.ietf-suit-manifest">SUIT-MANIFEST</a>]</span>
for more details). The TEEP Agent is responsible for handling any installation steps
that need to be performed inside the TEE, such as decryption of private TA binaries or
Personalization Data.<a class="pilcrow" href="#section-4.4-4">¶</a></p>
<p id="section-4.4-5">In order to better understand these cases, it is helpful to review actual implementations of TEEs and their application delivery mechanisms.<a class="pilcrow" href="#section-4.4-5">¶</a></p>
<div id="example-application-delivery-mechanisms-in-intel-sgx">
<section id="section-4.4.1">
          <h4 id="name-example-application-deliver">
<a class="section-number selfRef" href="#section-4.4.1">4.4.1. </a><a class="section-name selfRef" href="#name-example-application-deliver">Example: Application Delivery Mechanisms in Intel SGX</a>
          </h4>
<p id="section-4.4.1-1">In Intel Software Guard Extensions (SGX), the Untrusted
          Application and TA are typically bundled into the same package (Case
          2). The TA exists in the package as a shared library (.so or
          .dll). The Untrusted Application loads the TA into an SGX enclave
          when the Untrusted Application needs the TA. This organization makes
          it easy to maintain compatibility between the Untrusted Application
          and the TA, since they are updated together. It is entirely possible
          to create an Untrusted Application that loads an external TA into an
          SGX enclave and use that TA (Cases 3-5).  In this case, the
          Untrusted Application would require a reference to an external file
          or download such a file dynamically, place the contents of the file
          into memory, and load that as a TA. Obviously, such file or
          downloaded content must be properly formatted and signed for it to
          be accepted by the SGX TEE.<a class="pilcrow" href="#section-4.4.1-1">¶</a></p>
<p id="section-4.4.1-2">In SGX, any
Personalization Data is normally loaded into the SGX enclave (the TA) after the TA has
started. 
Although it is possible with SGX to include the Untrusted Application in an encrypted
package along with Personalization Data (Cases 1 and 5), there are currently no known instances of this in use, since such a construction would require a special installation
program and SGX TA (which might or might not be the TEEP Agent itself based on the implementation)
to receive the encrypted package, decrypt it, separate it into the
different elements, and then install each one. This installation is complex
because the Untrusted Application decrypted inside the TEE must be passed out of the TEE to an
installer in the REE that would install the Untrusted Application.
Finally, the Personalization Data would need to be sent out of the
TEE (encrypted in an SGX enclave-to-enclave manner) to the REE's installation app, which
would pass this data to the installed Untrusted Application, which would in turn send this data
to the SGX enclave (TA). This complexity is due to the fact that each SGX enclave is separate
and does not have direct communication to other SGX enclaves.<a class="pilcrow" href="#section-4.4.1-2">¶</a></p>
<p id="section-4.4.1-3">As long as signed files (TAs and/or Personalization Data) are installed into
an untrusted filesystem and trust is verified by the TEE at load time, classic
distribution mechanisms can be used.  However, some uses of SGX allow a model
where a TA can be dynamically installed into an SGX enclave that
provides a runtime platform.  The TEEP protocol can be used in
such cases, where the runtime platform could include a TEEP Agent.<a class="pilcrow" href="#section-4.4.1-3">¶</a></p>
</section>
</div>
<div id="example-application-delivery-mechanisms-in-arm-trustzone">
<section id="section-4.4.2">
          <h4 id="name-example-application-delivery">
<a class="section-number selfRef" href="#section-4.4.2">4.4.2. </a><a class="section-name selfRef" href="#name-example-application-delivery">Example: Application Delivery Mechanisms in Arm TrustZone</a>
          </h4>
<p id="section-4.4.2-1">In Arm TrustZone <span>[<a class="cite xref" href="#TrustZone">TrustZone</a>]</span> for A-class devices,
          the Untrusted Application and TA may or may not be bundled
          together. 
This differs from SGX since in TrustZone, the TA lifetime
          is not inherently tied to a specific Untrusted Application process
          lifetime as occurs in SGX.  A TA is loaded by a trusted OS running
          in the TEE, such as a TEE compliant with GlobalPlatform <span>[<a class="cite xref" href="#GPTEE">GPTEE</a>]</span>,
          where the trusted OS is separate from the OS in the REE.  Thus,
          Cases 2-4 are equally applicable.  

In addition, it is possible for
          TAs to communicate with each other without involving any Untrusted
          Application; thus, the complexity of Cases 1 and 5 are lower than
          in the SGX example, though still more complex than Cases 2-4.<a class="pilcrow" href="#section-4.4.2-1">¶</a></p>
<p id="section-4.4.2-2">A trusted OS running in the TEE (e.g., OP-TEE <span>[<a class="cite xref" href="#OP-TEE">OP-TEE</a>]</span>) that supports loading and verifying signed TAs from
an untrusted filesystem can, like SGX, use classic file distribution
mechanisms.  If secure TA storage is used (e.g., a Replay-Protected
Memory Block device) on the other hand, the TEEP protocol can be used
to manage such storage.<a class="pilcrow" href="#section-4.4.2-2">¶</a></p>
</section>
</div>
</section>
</div>
<div id="entity-relations">
<section id="section-4.5">
        <h3 id="name-entity-relations">
<a class="section-number selfRef" href="#section-4.5">4.5. </a><a class="section-name selfRef" href="#name-entity-relations">Entity Relations</a>
        </h3>
<p id="section-4.5-1">This architecture leverages asymmetric cryptography to
authenticate a device to a TAM. Additionally, a TEEP Agent
in a device authenticates a TAM. The
provisioning of Trust Anchors to a device may be different from
one use case to the other. A Device Administrator may want to
have the capability to control what TAs are allowed.
A device manufacturer enables verification by one or more TAMs and by Trusted Component Signers; 
it may embed a list of default Trust Anchors into the TEEP Agent
and TEE for TAM trust verification and TA signature verification.<a class="pilcrow" href="#section-4.5-1">¶</a></p>
<span id="name-example-developer-experienc"></span><div id="experience">
<figure id="figure-3">
          <div class="alignLeft art-text artwork" id="section-4.5-2.1">
<pre> (App Developers)   (App Store)   (TAM)      (Device with TEE)  (CAs)
        |                   |       |                |            |
        |                   |       |      (Embedded TEE cert) &lt;--|
        |                   |       |                |            |
        | &lt;--- Get an app cert -----------------------------------|
        |                   |       |                |            |
        |                   |       | &lt;-- Get a TAM cert ---------|
        |                   |       |                |            |
1. Build two apps:          |       |                |            |
                            |       |                |            |
   (a) Untrusted            |       |                |            |
       App - 2a. Supply --&gt; |       |                |            |
                            |       |                |            |
   (b) TA -- 2b. Supply ----------&gt; |                |            |
                            |       |                |            |
                            | --- 3. Install ------&gt; |            |
                            |       |                |            |
                            |       | 4. Messaging--&gt;|            |
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-3">Figure 3</a>:
<a class="selfRef" href="#name-example-developer-experienc">Example Developer Experience</a>
          </figcaption></figure>
</div>
<p id="section-4.5-3"><a class="auto internal xref" href="#experience">Figure 3</a> shows an example where the same developer builds and signs
two applications: (a) an Untrusted Application and (b) a TA
that provides some security functions to be run inside
a TEE.  This example assumes that the developer, the TEE, and the TAM have
previously been provisioned with certificates.<a class="pilcrow" href="#section-4.5-3">¶</a></p>
<p id="section-4.5-4">At step 1, the developer authors the two applications.<a class="pilcrow" href="#section-4.5-4">¶</a></p>
<p id="section-4.5-5">At step 2, the developer uploads the
Untrusted Application (2a) to an Application Store. 
In this example, the developer is also the Trusted Component Signer and thus generates
a signed TA.
The developer can then either bundle the signed TA
with the Untrusted Application or provide a signed Trusted Component containing the TA
to a TAM that will be managing the TA in various devices.<a class="pilcrow" href="#section-4.5-5">¶</a></p>
<p id="section-4.5-6">At step 3, a user
will go to an Application Store to download the Untrusted
Application (where the arrow indicates the direction of data transfer).<a class="pilcrow" href="#section-4.5-6">¶</a></p>
<p id="section-4.5-7">At step 4, since the Untrusted Application depends on the TA, installing the Untrusted Application will trigger TA installation
via communication with a TAM. The TEEP Agent
will interact with the TAM via a TEEP Broker that facilitates communications between the TAM
and the TEEP Agent.<a class="pilcrow" href="#section-4.5-7">¶</a></p>
<p id="section-4.5-8">Some implementations that install Trusted Components might ask for a user's consent. In other
implementations,
a Device Administrator might choose the Untrusted Applications and related Trusted Components to
be installed. A user consent flow is out of scope of the TEEP architecture.<a class="pilcrow" href="#section-4.5-8">¶</a></p>
<p id="section-4.5-9">The main components of the TEEP protocol
consist of a set of standard messages created by
a TAM to deliver Trusted Component management commands to a device
and device attestation and response messages created by a TEE that
responds to a TAM's message.<a class="pilcrow" href="#section-4.5-9">¶</a></p>
<p id="section-4.5-10">It should be noted that network communication capability is generally
not available in TAs in today's TEE-powered devices.  Consequently, Trusted
Applications generally rely on a Broker in the REE to provide access to
network functionality in the REE.  A Broker does not need to know the actual
content of messages to facilitate such access.<a class="pilcrow" href="#section-4.5-10">¶</a></p>
<p id="section-4.5-11">Similarly, since the TEEP Agent runs inside a TEE, the TEEP Agent generally
relies on a TEEP Broker in the REE to provide network access, relay
TAM requests to the TEEP Agent, and relay the responses back to the TAM.<a class="pilcrow" href="#section-4.5-11">¶</a></p>
</section>
</div>
</section>
</div>
<div id="trustanchors">
<section id="section-5">
      <h2 id="name-keys-and-certificate-types">
<a class="section-number selfRef" href="#section-5">5. </a><a class="section-name selfRef" href="#name-keys-and-certificate-types">Keys and Certificate Types</a>
      </h2>
<p id="section-5-1">This architecture leverages the following credentials, which allow
achieving end-to-end security between a TAM and a TEEP Agent.<a class="pilcrow" href="#section-5-1">¶</a></p>
<p id="section-5-2"><a class="auto internal xref" href="#keys">Table 1</a> summarizes the relationships between various keys and where
they are stored.  Each public/private key identifies a Trusted Component Signer, TAM, or TEE
and gets a certificate that chains up to some Trust Anchor.  
A list of trusted
certificates is used to check a presented certificate against.<a class="pilcrow" href="#section-5-2">¶</a></p>
<p id="section-5-3">Different CAs can be used for different
types of certificates.  TEEP messages are always signed, where the signer
key is the message originator's private key, such as that of a TAM
or a TEE.  In addition to the keys shown in <a class="auto internal xref" href="#keys">Table 1</a>,
there may be additional keys used for attestation or encryption.  Refer to the 
RATS Architecture <span>[<a class="cite xref" href="#RFC9334">RFC9334</a>]</span> for more discussion.<a class="pilcrow" href="#section-5-3">¶</a></p>
<span id="name-signature-keys"></span><div id="keys">
<table class="center" id="table-1">
        <caption>
<a class="selfRef" href="#table-1">Table 1</a>:
<a class="selfRef" href="#name-signature-keys">Signature Keys</a>
        </caption>
<thead>
          <tr>
            <th class="text-left" colspan="1" rowspan="1">Purpose</th>
            <th class="text-left" colspan="1" rowspan="1">Cardinality &amp; Location of Private Key</th>
            <th class="text-left" colspan="1" rowspan="1">Private Key Signs</th>
            <th class="text-left" colspan="1" rowspan="1">Location of Trust Anchor Store</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">Authenticating TEEP Agent</td>
            <td class="text-left" colspan="1" rowspan="1">1 per TEE</td>
            <td class="text-left" colspan="1" rowspan="1">TEEP responses</td>
            <td class="text-left" colspan="1" rowspan="1">TAM</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">Authenticating TAM</td>
            <td class="text-left" colspan="1" rowspan="1">1 per TAM</td>
            <td class="text-left" colspan="1" rowspan="1">TEEP requests</td>
            <td class="text-left" colspan="1" rowspan="1">TEEP Agent</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">Code Signing</td>
            <td class="text-left" colspan="1" rowspan="1">1 per Trusted Component Signer</td>
            <td class="text-left" colspan="1" rowspan="1">TA binary</td>
            <td class="text-left" colspan="1" rowspan="1">TEE</td>
          </tr>
        </tbody>
      </table>
</div>
<p id="section-5-5">Note that Personalization Data is not included in the table above. 
The use of Personalization Data is dependent on how TAs are used 
and what their security requirements are.<a class="pilcrow" href="#section-5-5">¶</a></p>
<p id="section-5-6">TEEP requests from a TAM to a TEEP Agent are signed with the TAM
private key (for authentication and integrity protection). 
Personalization Data and TA binaries can be encrypted with a key 
unique to that specific TEE.
Conversely, TEEP responses from a TEEP Agent to a TAM can be signed with the
TEE private key.<a class="pilcrow" href="#section-5-6">¶</a></p>
<p id="section-5-7">The TEE key pair and certificate are thus used for authenticating the TEE
to a remote TAM and for sending private data to the TEE. Often, 
the key pair is burned into the TEE by the
TEE manufacturer, and the key pair and its certificate are valid for
the expected lifetime of the TEE.  A TAM provider is responsible
for configuring the TAM's Trust Anchor Store with the manufacturer certificates or CAs
that are used to sign TEE keys. This is discussed further in
<a class="auto internal xref" href="#trust-anchors-in-tam">Section 5.3</a>.  Typically,
the same TEE key pair is used for both signing and encryption, though separate
key pairs might also be used in the future, as the joint security of
encryption and signature with a single key remains, to some extent, an open
question in academic cryptography.<a class="pilcrow" href="#section-5-7">¶</a></p>
<p id="section-5-8">The TAM key pair and certificate are used for authenticating a TAM
to a remote TEE and for sending private data to the TAM (separate key 
pairs for authentication vs. encryption could also be used in the future).  A TAM provider
is responsible for acquiring a
certificate from a CA that is trusted by the TEEs it manages. This
is discussed further in <a class="auto internal xref" href="#trust-anchors-in-teep-agent">Section 5.1</a>.<a class="pilcrow" href="#section-5-8">¶</a></p>
<p id="section-5-9">The Trusted Component Signer key pair and certificate are used to sign Trusted Components that the TEE
will consider authorized to execute.  TEEs must be configured with
the certificates or keys that it considers authorized to sign TAs
that it will execute.  This is discussed further in
<a class="auto internal xref" href="#trust-anchors-in-tee">Section 5.2</a>.<a class="pilcrow" href="#section-5-9">¶</a></p>
<div id="trust-anchors-in-teep-agent">
<section id="section-5.1">
        <h3 id="name-trust-anchors-in-a-teep-age">
<a class="section-number selfRef" href="#section-5.1">5.1. </a><a class="section-name selfRef" href="#name-trust-anchors-in-a-teep-age">Trust Anchors in a TEEP Agent</a>
        </h3>
<p id="section-5.1-1">A TEEP Agent's Trust Anchor Store contains a list of Trust Anchors, which are typically CA certificates that sign various TAM certificates.  The list
is usually preloaded at manufacturing time and
can be updated using the TEEP protocol if the TEE has some form of
"Trust Anchor Manager TA" that has Trust Anchors in its configuration data.
Thus, Trust Anchors can be updated similarly to the Personalization Data
for any other TA.<a class="pilcrow" href="#section-5.1-1">¶</a></p>
<p id="section-5.1-2">When a Trust Anchor update is carried out, it is imperative that any update
must maintain integrity where only an authentic Trust Anchor list from
a device manufacturer or a Device Administrator is accepted. Details
are out of scope of this architecture document and can be addressed in a protocol
document.<a class="pilcrow" href="#section-5.1-2">¶</a></p>
<p id="section-5.1-3">Before a TAM can begin operation in the marketplace to support a
device with a particular TEE, it must be able to get its raw public
key, its certificate, or a certificate it chains up to listed in
the Trust Anchor Store of the TEEP Agent.<a class="pilcrow" href="#section-5.1-3">¶</a></p>
</section>
</div>
<div id="trust-anchors-in-tee">
<section id="section-5.2">
        <h3 id="name-trust-anchors-in-a-tee">
<a class="section-number selfRef" href="#section-5.2">5.2. </a><a class="section-name selfRef" href="#name-trust-anchors-in-a-tee">Trust Anchors in a TEE</a>
        </h3>
<p id="section-5.2-1">The Trust Anchor Store in a TEE contains a list of Trust Anchors (raw public keys
or certificates) that are used to determine whether TA binaries are allowed to execute by 
checking if their signatures can be verified.  The list
is typically preloaded at manufacturing time and
can be updated using the TEEP protocol if the TEE has some form of
"Trust Anchor Manager TA" that has Trust Anchors in its configuration data.
Thus, Trust Anchors can be updated similarly to the Personalization Data
for any other TA, as discussed in <a class="auto internal xref" href="#trust-anchors-in-teep-agent">Section 5.1</a>.<a class="pilcrow" href="#section-5.2-1">¶</a></p>
</section>
</div>
<div id="trust-anchors-in-tam">
<section id="section-5.3">
        <h3 id="name-trust-anchors-in-a-tam">
<a class="section-number selfRef" href="#section-5.3">5.3. </a><a class="section-name selfRef" href="#name-trust-anchors-in-a-tam">Trust Anchors in a TAM</a>
        </h3>
<p id="section-5.3-1">The Trust Anchor Store in a TAM consists of a list of Trust
        Anchors, which are certificates that sign various device TEE
        certificates.  A TAM will accept a device for Trusted Component
        management if the TEE in the device uses a TEE certificate that is
        chained to a certificate or raw public key that the TAM trusts, is
        contained in an allow list, is not found on a block list, and/or
        fulfills any other policy criteria.<a class="pilcrow" href="#section-5.3-1">¶</a></p>
</section>
</div>
<div id="scalability">
<section id="section-5.4">
        <h3 id="name-scalability">
<a class="section-number selfRef" href="#section-5.4">5.4. </a><a class="section-name selfRef" href="#name-scalability">Scalability</a>
        </h3>
<p id="section-5.4-1">This architecture uses a PKI (including self-signed
        certificates). Trust Anchors exist on the devices to enable the TEEP
        Agent to authenticate TAMs and the TEE to authenticate Trusted
        Component Signers, and TAMs use Trust Anchors to authenticate TEEP
        Agents.  When a PKI is used, many intermediate CA certificates can
        chain to a root certificate, each of which can issue many
        certificates.  This makes the protocol highly scalable.  New factories
        that produce TEEs can join the ecosystem.  In this case, such a
        factory can get an intermediate CA certificate from one of the
        existing roots without requiring that TAMs are updated with
        information about the new device factory.  Likewise, new TAMs can join
        the ecosystem, providing they are issued a TAM certificate that chains
        to an existing root whereby existing TAs in the TEE will be allowed to
        be personalized by the TAM without requiring changes to the TEE
        itself.  This enables the ecosystem to scale and avoids the need for
        centralized databases of all TEEs produced, all TAMs that exist, or
        all Trusted Component Signers that exist.<a class="pilcrow" href="#section-5.4-1">¶</a></p>
</section>
</div>
<div id="message-security">
<section id="section-5.5">
        <h3 id="name-message-security">
<a class="section-number selfRef" href="#section-5.5">5.5. </a><a class="section-name selfRef" href="#name-message-security">Message Security</a>
        </h3>
<p id="section-5.5-1">Messages created by a TAM are used to deliver Trusted Component
management commands to a device, and device attestation and
messages are created by the device TEE to respond to TAM messages.<a class="pilcrow" href="#section-5.5-1">¶</a></p>
<p id="section-5.5-2">These messages are signed end-to-end between a TEEP Agent and a TAM.
Confidentiality is provided by encrypting sensitive payloads (such as
Personalization Data and attestation evidence), rather than encrypting the
messages themselves.  Using encrypted payloads is important to ensure
that only the targeted device TEE or TAM is able to decrypt and view
the actual content.<a class="pilcrow" href="#section-5.5-2">¶</a></p>
</section>
</div>
</section>
</div>
<div id="broker">
<section id="section-6">
      <h2 id="name-teep-broker">
<a class="section-number selfRef" href="#section-6">6. </a><a class="section-name selfRef" href="#name-teep-broker">TEEP Broker</a>
      </h2>
<p id="section-6-1">A TEE and TAs often do not have the capability to directly communicate
outside of the hosting device.  For example, GlobalPlatform
<span>[<a class="cite xref" href="#GPTEE">GPTEE</a>]</span> specifies one such architecture.  This calls for a software
module in the REE world to handle network communication with a TAM.<a class="pilcrow" href="#section-6-1">¶</a></p>
<p id="section-6-2">A TEEP Broker is an application component
running in the REE of the device or an SDK that facilitates
communication between a TAM and a TEE.  It also provides interfaces for
Untrusted Applications to query and trigger installation of Trusted Components that the
application needs to use.<a class="pilcrow" href="#section-6-2">¶</a></p>
<p id="section-6-3">
   An Untrusted Application might communicate with a TEEP Broker at
   runtime to trigger Trusted Component installation itself. Alternatively, an
   Untrusted Application might simply have a metadata file that
   describes the Trusted Components it depends on and the associated
   TAM(s) for each Trusted Component. An REE Application Installer
   can inspect this application metadata file and invoke the TEEP Broker
   to trigger Trusted Component installation on behalf of the Untrusted
   Application without requiring the Untrusted Application to run first.<a class="pilcrow" href="#section-6-3">¶</a></p>
<div id="role-of-the-teep-broker">
<section id="section-6.1">
        <h3 id="name-role-of-the-teep-broker">
<a class="section-number selfRef" href="#section-6.1">6.1. </a><a class="section-name selfRef" href="#name-role-of-the-teep-broker">Role of the TEEP Broker</a>
        </h3>
<p id="section-6.1-1">A TEEP Broker interacts with a TEEP Agent inside a TEE,
relaying messages between the TEEP Agent and the TAM, and may also interact with
one or more Untrusted Applications (see <a class="auto internal xref" href="#apis">Section 6.2.1</a>).
The Broker cannot parse encrypted TEEP messages exchanged between a TAM and a TEEP Agent but merely relays them.<a class="pilcrow" href="#section-6.1-1">¶</a></p>
<p id="section-6.1-2">When a device has more than one TEE, one TEEP Broker per TEE could
be present in the REE, or a common TEEP Broker could be used by multiple TEEs
where the transport protocol (e.g., <span>[<a class="cite xref" href="#I-D.ietf-teep-otrp-over-http">TEEP-HTTP</a>]</span>) allows
the TEEP Broker to distinguish which TEE is relevant for each message from a TAM.<a class="pilcrow" href="#section-6.1-2">¶</a></p>
<p id="section-6.1-3">The Broker only needs to return an error message to the TAM if the TEE is
not reachable for some reason.  Other errors are represented as
TEEP response messages returned from the TEE, which will then be passed to
the TAM.<a class="pilcrow" href="#section-6.1-3">¶</a></p>
</section>
</div>
<div id="teep-broker-implementation-consideration">
<section id="section-6.2">
        <h3 id="name-teep-broker-implementation-">
<a class="section-number selfRef" href="#section-6.2">6.2. </a><a class="section-name selfRef" href="#name-teep-broker-implementation-">TEEP Broker Implementation Consideration</a>
        </h3>
<p id="section-6.2-1">As depicted in <a class="auto internal xref" href="#broker-models">Figure 4</a>, there are multiple ways in which a TEEP Broker
can be implemented with more or fewer layers being inside the TEE.  
For example, in model A (the model with the smallest TEE footprint), only the
TEEP implementation is inside the TEE, whereas the TEEP/HTTP implementation is
in the TEEP Broker outside the TEE.<a class="pilcrow" href="#section-6.2-1">¶</a></p>
<span id="name-teep-broker-models"></span><div id="broker-models">
<figure id="figure-4">
          <div class="alignLeft art-text artwork" id="section-6.2-2.1">
<pre>                   Model:    A      B      C

                            TEE    TEE    TEE
+----------------+           |      |      |
|      TEEP      |     Agent |      |      | Agent
| implementation |           |      |      |
+----------------+           v      |      |
         |                          |      |
+----------------+           ^      |      |
|    TEEP/HTTP   |    Broker |      |      |
| implementation |           |      |      |
+----------------+           |      v      |
         |                   |             |
+----------------+           |      ^      |
|     HTTP(S)    |           |      |      |
| implementation |           |      |      |
+----------------+           |      |      v
         |                   |      |
+----------------+           |      |      ^
|   TCP or QUIC  |           |      |      | Broker
| implementation |           |      |      |
+----------------+           |      |      |
                            REE    REE    REE
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-4">Figure 4</a>:
<a class="selfRef" href="#name-teep-broker-models">TEEP Broker Models</a>
          </figcaption></figure>
</div>
<p id="section-6.2-3">In other models, additional layers are moved into the TEE, increasing the TEE footprint,
with the Broker either containing or calling the topmost protocol layer outside of the TEE.
An implementation is free to choose any of these models.<a class="pilcrow" href="#section-6.2-3">¶</a></p>
<p id="section-6.2-4">TEEP Broker implementers should consider methods of distribution, scope, and
   concurrency on devices and runtime options.<a class="pilcrow" href="#section-6.2-4">¶</a></p>
<div id="apis">
<section id="section-6.2.1">
          <h4 id="name-teep-broker-apis">
<a class="section-number selfRef" href="#section-6.2.1">6.2.1. </a><a class="section-name selfRef" href="#name-teep-broker-apis">TEEP Broker APIs</a>
          </h4>
<p id="section-6.2.1-1">The following conceptual APIs exist from a TEEP Broker to a TEEP Agent:<a class="pilcrow" href="#section-6.2.1-1">¶</a></p>
<ol class="normal type-1" id="section-6.2.1-2" start="1" type="1">    

     <li id="section-6.2.1-2.1">RequestTA: A notification from an REE application (e.g., an
     installer or an Untrusted Application) that the application
     depends on a given Trusted Component, which may or may not already
     be installed in the TEE.<a class="pilcrow" href="#section-6.2.1-2.1">¶</a>
</li>
            <li id="section-6.2.1-2.2">UnrequestTA: A notification from an REE application (e.g., an
            installer or an Untrusted Application) that the application no
            longer depends on a given Trusted Component, which may or may not
            already be installed in the TEE.  For example, if the Untrusted
            Application is uninstalled, the uninstaller might invoke this
            conceptual API.<a class="pilcrow" href="#section-6.2.1-2.2">¶</a>
</li>
            <li id="section-6.2.1-2.3">ProcessTeepMessage: A message arriving from the network, to be delivered
to the TEEP Agent for processing.<a class="pilcrow" href="#section-6.2.1-2.3">¶</a>
</li>
            <li id="section-6.2.1-2.4">RequestPolicyCheck: A hint (e.g., based on a timer) that the TEEP Agent
may wish to contact the TAM for any changes without the device itself
needing any particular change.<a class="pilcrow" href="#section-6.2.1-2.4">¶</a>
</li>
            <li id="section-6.2.1-2.5">ProcessError: A notification that the TEEP Broker could not deliver an outbound
TEEP message to a TAM.<a class="pilcrow" href="#section-6.2.1-2.5">¶</a>
</li>
          </ol>
<p id="section-6.2.1-3">For comparison, similar APIs may exist on the TAM side, where a Broker may or may not
exist, depending on whether the TAM uses a TEE or not:<a class="pilcrow" href="#section-6.2.1-3">¶</a></p>
<ol class="normal type-1" id="section-6.2.1-4" start="1" type="1">
<li id="section-6.2.1-4.1">ProcessConnect: A notification that a new TEEP session is being requested by a TEEP Agent.<a class="pilcrow" href="#section-6.2.1-4.1">¶</a>
</li>
            <li id="section-6.2.1-4.2">ProcessTeepMessage: A message arriving at an existing TEEP session, to be delivered
to the TAM for processing.<a class="pilcrow" href="#section-6.2.1-4.2">¶</a>
</li>
          </ol>
<p id="section-6.2.1-5">For further discussion on these APIs, see <span>[<a class="cite xref" href="#I-D.ietf-teep-otrp-over-http">TEEP-HTTP</a>]</span>.<a class="pilcrow" href="#section-6.2.1-5">¶</a></p>
</section>
</div>
<div id="teep-broker-distribution">
<section id="section-6.2.2">
          <h4 id="name-teep-broker-distribution">
<a class="section-number selfRef" href="#section-6.2.2">6.2.2. </a><a class="section-name selfRef" href="#name-teep-broker-distribution">TEEP Broker Distribution</a>
          </h4>
<p id="section-6.2.2-1">The Broker installation is commonly carried out at device manufacturing time. A user
may also dynamically download and install a Broker on demand.<a class="pilcrow" href="#section-6.2.2-1">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="attestation">
<section id="section-7">
      <h2 id="name-attestation">
<a class="section-number selfRef" href="#section-7">7. </a><a class="section-name selfRef" href="#name-attestation">Attestation</a>
      </h2>
<p id="section-7-1">Attestation is the process through which one entity (an Attester) presents "evidence" in the form
of a series of claims to another entity (a Verifier) and provides sufficient proof that the claims
are true. Different Verifiers may require different degrees of confidence in attestation proofs,
and not all attestations are acceptable to every Verifier.  A third entity (a Relying Party)
can then use "attestation results" in the form of another series of claims from a Verifier
to make authorization decisions.  (See <span>[<a class="cite xref" href="#RFC9334">RFC9334</a>]</span> for more discussion.)<a class="pilcrow" href="#section-7-1">¶</a></p>
<p id="section-7-2">In TEEP, as depicted in <a class="auto internal xref" href="#attestation-roles">Figure 5</a>,
the primary purpose of an attestation is to allow a device (the Attester) to prove to a TAM
(the Relying Party) that a TEE in the device has particular properties, was built by a particular
manufacturer, and/or is executing a particular TA. Other claims are possible; TEEP
does not limit the claims that may appear in evidence or attestation results,
but it defines a minimal set of attestation result claims
required for TEEP to operate properly. Extensions to these claims are possible.
Other standards or groups may define the format and semantics
of extended claims.<a class="pilcrow" href="#section-7-2">¶</a></p>
<span id="name-teep-attestation-roles"></span><div id="attestation-roles">
<figure id="figure-5">
        <div class="alignLeft art-text artwork" id="section-7-3.1">
<pre>+----------------+
| Device         |            +----------+
| +------------+ |  Evidence  |   TAM    |   Evidence    +----------+
| |     TEE    |-------------&gt;| (Relying |--------------&gt;| Verifier |
| | (Attester) | |            |  Party)  |&lt;--------------|          |
| +------------+ |            +----------+  Attestation  +----------+
+----------------+                             Result
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-5">Figure 5</a>:
<a class="selfRef" href="#name-teep-attestation-roles">TEEP Attestation Roles</a>
        </figcaption></figure>
</div>
<p id="section-7-4">At the time of writing this specification, device and TEE attestations have not been standardized
across the market. Different devices, manufacturers, and TEEs support different attestation
protocols. In order for TEEP to be inclusive, it is agnostic to the format of evidence,
allowing proprietary or standardized formats to be used between a TEE and a Verifier (which may or may not
be colocated in the TAM), as long as the format supports encryption of
any information that is considered sensitive.<a class="pilcrow" href="#section-7-4">¶</a></p>
<p id="section-7-5">However, it should be recognized
that not all Verifiers may be able to process all proprietary forms of attestation evidence.
Similarly, the TEEP protocol is agnostic as to the format of attestation results and the protocol
(if any) used between the TAM and a Verifier, as long as they convey at least the required set of claims
in some format. Note that the respective attestation algorithms are not defined in the TEEP protocol itself;
see <span>[<a class="cite xref" href="#RFC9334">RFC9334</a>]</span> and <span>[<a class="cite xref" href="#I-D.ietf-teep-protocol">TEEP</a>]</span> for more discussion.<a class="pilcrow" href="#section-7-5">¶</a></p>
<p id="section-7-6">Considerations when appraising evidence provided by a TEE include the following:<a class="pilcrow" href="#section-7-6">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7-7.1">What security measures a manufacturer takes when provisioning keys into devices/TEEs;<a class="pilcrow" href="#section-7-7.1">¶</a>
</li>
        <li class="normal" id="section-7-7.2">What hardware and software components have access to the attestation keys of the TEE;<a class="pilcrow" href="#section-7-7.2">¶</a>
</li>
        <li class="normal" id="section-7-7.3">The source or local verification of claims within an attestation prior to a TEE signing a set of claims;<a class="pilcrow" href="#section-7-7.3">¶</a>
</li>
        <li class="normal" id="section-7-7.4">The level of protection afforded to attestation keys against exfiltration, modification, and side channel attacks;<a class="pilcrow" href="#section-7-7.4">¶</a>
</li>
        <li class="normal" id="section-7-7.5">The limitations of use applied to TEE attestation keys;<a class="pilcrow" href="#section-7-7.5">¶</a>
</li>
        <li class="normal" id="section-7-7.6">The processes in place to discover or detect TEE breaches; and<a class="pilcrow" href="#section-7-7.6">¶</a>
</li>
        <li class="normal" id="section-7-7.7">The revocation and recovery process of TEE attestation keys.<a class="pilcrow" href="#section-7-7.7">¶</a>
</li>
      </ul>
<p id="section-7-8">Some TAMs may require additional claims in order to properly authorize a device or TEE.  The specific
format for these additional claims are outside the scope of this specification, but the TEEP protocol
allows these additional claims to be included in the attestation messages.<a class="pilcrow" href="#section-7-8">¶</a></p>
<p id="section-7-9">For more discussion of the attestation and appraisal process, see
the RATS Architecture <span>[<a class="cite xref" href="#RFC9334">RFC9334</a>]</span>.<a class="pilcrow" href="#section-7-9">¶</a></p>
<p id="section-7-10">The following information is required for TEEP attestation:<a class="pilcrow" href="#section-7-10">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7-11.1">Device Identifying Information: Attestation information may need to uniquely identify a device to the TAM.
Unique device identification allows the TAM to provide services to the device, such as managing installed
TAs, providing subscriptions to services, and locating device-specific keying material to
communicate with or authenticate the device. In some use cases, it may be sufficient to identify 
only the model or class of the device, for example, a DAA Issuer's group public key ID when the 
attestation uses DAA; see <span>[<a class="cite xref" href="#I-D.ietf-rats-daa">RATS-DAA</a>]</span>. Another example of models is the hwmodel (Hardware Model) as 
defined in <span>[<a class="cite xref" href="#I-D.ietf-rats-eat">EAT</a>]</span>. The security and privacy requirements regarding device identification 
will vary with the type of TA provisioned to the TEE.<a class="pilcrow" href="#section-7-11.1">¶</a>
</li>
        <li class="normal" id="section-7-11.2">TEE Identifying Information: The type of TEE that generated this attestation must be identified.
This includes version identification information for hardware, firmware, and software version of the TEE, as applicable by the
TEE type. TEE manufacturer information for the TEE is
required in order to disambiguate the same TEE type created by different manufacturers and
address considerations around manufacturer provisioning, keying, and support for the TEE.<a class="pilcrow" href="#section-7-11.2">¶</a>
</li>
        <li class="normal" id="section-7-11.3">Freshness Proof: A claim that includes freshness information must be included, such as a nonce
or timestamp.<a class="pilcrow" href="#section-7-11.3">¶</a>
</li>
      </ul>
</section>
</div>
<div id="algorithm-and-attestation-agility">
<section id="section-8">
      <h2 id="name-algorithm-and-attestation-a">
<a class="section-number selfRef" href="#section-8">8. </a><a class="section-name selfRef" href="#name-algorithm-and-attestation-a">Algorithm and Attestation Agility</a>
      </h2>
<p id="section-8-1"><span>[<a class="cite xref" href="#RFC7696">RFC7696</a>]</span> outlines the requirements to migrate from one
mandatory-to-implement cryptographic algorithm suite to another over time.
This feature is also known as "crypto agility". Protocol evolution
is greatly simplified when crypto agility is considered
during the design of the protocol. In the case of the TEEP
protocol, the diverse range of use cases (from trusted app
updates for smartphones and tablets to updates of code on
higher-end IoT devices) creates the need for different
mandatory-to-implement algorithms from the start.<a class="pilcrow" href="#section-8-1">¶</a></p>
<p id="section-8-2">Crypto agility in TEEP concerns the use of symmetric as well as asymmetric 
algorithms. In the context of TEEP, symmetric algorithms are used for 
encryption and integrity protection of TA binaries and Personalization Data, 
whereas the asymmetric algorithms are used for signing messages and managing 
symmetric keys.<a class="pilcrow" href="#section-8-2">¶</a></p>
<p id="section-8-3">In addition to the use of cryptographic algorithms in TEEP, there
is also the need to make use of different attestation technologies.
A device must provide techniques to inform a TAM about the
attestation technology it supports. For many deployment cases, it
is more likely for the TAM to support one or more attestation
techniques, whereas the device may only support one.<a class="pilcrow" href="#section-8-3">¶</a></p>
</section>
</div>
<div id="security-considerations">
<section id="section-9">
      <h2 id="name-security-considerations">
<a class="section-number selfRef" href="#section-9">9. </a><a class="section-name selfRef" href="#name-security-considerations">Security Considerations</a>
      </h2>
<div id="broker-trust-model">
<section id="section-9.1">
        <h3 id="name-broker-trust-model">
<a class="section-number selfRef" href="#section-9.1">9.1. </a><a class="section-name selfRef" href="#name-broker-trust-model">Broker Trust Model</a>
        </h3>
<p id="section-9.1-1">The architecture enables the TAM to communicate, via a TEEP Broker, with the device's TEE to manage Trusted Components.  

However, since the TEEP Broker runs in a potentially vulnerable REE,
the TEEP Broker could be malware or be infected by malware.
As such, all TAM messages are signed and sensitive
data is encrypted such that the TEEP Broker cannot modify or capture
sensitive data, but the TEEP Broker can still conduct DoS attacks
as discussed in <a class="auto internal xref" href="#compromised-ree">Section 9.3</a>.<a class="pilcrow" href="#section-9.1-1">¶</a></p>
<p id="section-9.1-2">A TEEP Agent in a TEE is responsible for protecting against potential attacks
from a compromised 
TEEP Broker or rogue malware in the REE. A rogue TEEP Broker
might send corrupted data to the TEEP Agent, launch a DoS attack by sending a flood
of TEEP protocol requests, or simply drop or delay notifications to a TEE. The TEEP Agent
validates the signature of each TEEP protocol request
and checks the signing certificate against its Trust Anchors. To mitigate
DoS attacks, it might also add some protection
scheme such as a threshold on repeated requests or the number of TAs that can be installed.<a class="pilcrow" href="#section-9.1-2">¶</a></p>
<p id="section-9.1-3">Due to the lack of any available alternative, some implementations might rely on the use of 
an untrusted timer or other event to call the RequestPolicyCheck API (<a class="auto internal xref" href="#apis">Section 6.2.1</a>), which
means that a compromised REE can cause a TEE to not receive policy changes and thus be out of date
with respect to policy.  The same can potentially be done by any other manipulator-in-the-middle
simply by blocking communication with a TAM.  Ultimately, such outdated compliance
could be addressed by using attestation in secure communication, where the attestation
evidence reveals what state the TEE is in, so that communication (other than remediation
such as via TEEP) from an out-of-compliance TEE can be rejected.<a class="pilcrow" href="#section-9.1-3">¶</a></p>
<p id="section-9.1-4">Similarly, in most implementations, the REE is involved in the mechanics of installing new TAs.
However, the authority for what TAs are running in a given TEE is between the TEEP Agent and the TAM.
While a TEEP Broker can, in effect, make suggestions as discussed in <a class="auto internal xref" href="#apis">Section 6.2.1</a>, it cannot decide or enforce what runs where.
The TEEP Broker can also control which TEE a given installation request is directed at, but a TEEP
Agent will only accept TAs that are actually applicable to it and where installation instructions
are received by a TAM that it trusts.<a class="pilcrow" href="#section-9.1-4">¶</a></p>
<p id="section-9.1-5">The authorization model for the UnrequestTA operation is, however, weaker in that it
expresses the removal of a dependency from an application that was untrusted to begin with.
This means that a compromised REE could remove a valid dependency from an Untrusted Application
on a TA.  Normal REE security mechanisms should be used to protect the REE and Untrusted Applications.<a class="pilcrow" href="#section-9.1-5">¶</a></p>
</section>
</div>
<div id="data-protection">
<section id="section-9.2">
        <h3 id="name-data-protection">
<a class="section-number selfRef" href="#section-9.2">9.2. </a><a class="section-name selfRef" href="#name-data-protection">Data Protection</a>
        </h3>
<p id="section-9.2-1">It is the responsibility of the TAM to protect data on its servers.
Similarly, it is the responsibility of the TEE implementation to provide protection of
data against integrity and confidentiality attacks from outside the TEE.
TEEs that provide isolation among TAs within the TEE are likewise
responsible for protecting TA data against the REE and other TAs.
For example, this can be used to protect the data of one user or tenant
from compromise by another user or tenant, even if the attacker has TAs.<a class="pilcrow" href="#section-9.2-1">¶</a></p>
<p id="section-9.2-2">The protocol between TEEP Agents and TAMs is similarly responsible for
securely providing integrity and confidentiality protection against
adversaries between them. 
   The layers at which to best provide protection against network
   adversaries is a design choice.
   As discussed in <a class="auto internal xref" href="#broker">Section 6</a>, 
the transport protocol and any security mechanism associated with it (e.g., the Transport Layer Security protocol) under 
the TEEP protocol may terminate outside a TEE. If it does, the TEEP protocol 
itself must provide integrity and confidentiality protection to 
secure data end-to-end. For example, confidentiality protection for 
payloads may be provided by utilizing encrypted TA binaries and encrypted
attestation information. See <span>[<a class="cite xref" href="#I-D.ietf-teep-protocol">TEEP</a>]</span> for how a specific 
solution addresses the design question of how to provide integrity and 
confidentiality protection.<a class="pilcrow" href="#section-9.2-2">¶</a></p>
</section>
</div>
<div id="compromised-ree">
<section id="section-9.3">
        <h3 id="name-compromised-ree">
<a class="section-number selfRef" href="#section-9.3">9.3. </a><a class="section-name selfRef" href="#name-compromised-ree">Compromised REE</a>
        </h3>
<p id="section-9.3-1">It is possible that the REE of a device is compromised. 
We have already seen examples of attacks on the public Internet with a large number
of compromised devices being used to mount DDoS attacks.  A compromised
REE can be used for such an attack, but it cannot tamper with the TEE's
code or data in doing so.  A compromised REE can, however, launch DoS attacks
against the TEE.<a class="pilcrow" href="#section-9.3-1">¶</a></p>
<p id="section-9.3-2">The compromised REE
may terminate the TEEP Broker such that TEEP transactions cannot reach the TEE
or might drop, replay, or delay messages between a TAM and a TEEP Agent.
However, while a DoS attack cannot be prevented, the REE cannot access
anything in the TEE if the TEE is implemented correctly.
Some TEEs may have some watchdog scheme to observe REE state and mitigate DoS
attacks against it, but most TEEs don't have such a capability.<a class="pilcrow" href="#section-9.3-2">¶</a></p>
<p id="section-9.3-3">In some other scenarios, the compromised REE may ask a TEEP Broker
to make repeated requests to a TEEP Agent in a TEE to install or
uninstall a Trusted Component.  An installation or uninstallation request constructed
by the TEEP Broker or REE will be rejected by the TEEP Agent because
the request won't have the correct signature from a TAM to pass the request
signature validation.<a class="pilcrow" href="#section-9.3-3">¶</a></p>
<p id="section-9.3-4">This can become a DoS attack by exhausting resources in a TEE with
repeated requests. In general, a DoS attack threat exists when the REE
is compromised and a DoS attack can happen to other resources. The TEEP
architecture doesn't change this.<a class="pilcrow" href="#section-9.3-4">¶</a></p>
<p id="section-9.3-5">A compromised REE might also request initiating the full flow of
installation of Trusted Components that are not necessary.
It may also repeat a prior legitimate Trusted Component installation
request. A TEEP Agent implementation is responsible for ensuring that it
can recognize and decline such repeated requests. It is also responsible
for protecting the resource usage allocated for Trusted Component management.<a class="pilcrow" href="#section-9.3-5">¶</a></p>
</section>
</div>
<div id="trust-anchor-compromise">
<section id="section-9.4">
        <h3 id="name-ca-compromise-or-expiry-of-">
<a class="section-number selfRef" href="#section-9.4">9.4. </a><a class="section-name selfRef" href="#name-ca-compromise-or-expiry-of-">CA Compromise or Expiry of CA Certificate</a>
        </h3>
<p id="section-9.4-1">A root CA for TAM certificates might get compromised, its certificate might
expire, or a Trust Anchor other than a root CA certificate may also expire or
be compromised.
TEEs are responsible for validating the entire TAM certification path,
including the TAM certificate and any intermediate certificates up to
the root certificate.  See <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc5280#section-6">Section 6</a> of [<a class="cite xref" href="#RFC5280">RFC5280</a>]</span> for details.
Such validation generally includes checking for certificate
revocation, but certificate status check protocols may
not scale down to constrained devices that use TEEP.<a class="pilcrow" href="#section-9.4-1">¶</a></p>
<p id="section-9.4-2">To address the above issues, a certification path update mechanism
is expected from TAM operators, so that the TAM can get
a new certification path that can be validated by a TEEP Agent.
In addition, the Trust Anchor in the TEEP Agent's Trust Anchor Store
may need to be updated.  
To address this, a TEE Trust Anchor update 
mechanism is expected from device equipment manufacturers (OEMs), such as using the TEEP protocol
to distribute new Trust Anchors.<a class="pilcrow" href="#section-9.4-2">¶</a></p>
<p id="section-9.4-3">Similarly, a root CA for TEE certificates might get compromised, its certificate might
expire, or a Trust Anchor other than a root CA certificate may also expire or
be compromised.
TAMs are responsible for validating the entire TEE certification path,
including the TEE certificate and any intermediate certificates up to
the root certificate.  Such validation includes checking for certificate
revocation.<a class="pilcrow" href="#section-9.4-3">¶</a></p>
<p id="section-9.4-4">If a TEE certification path validation fails, the TEE
might be rejected by a TAM, subject to the TAM's policy.
To address this, a certification path update mechanism
is expected from device OEMs, so that the TEE can get
a new certification path that can be validated by a TAM.
In addition, the Trust Anchor in the TAM's Trust Anchor Store
may need to be updated.<a class="pilcrow" href="#section-9.4-4">¶</a></p>
</section>
</div>
<div id="compromised-tam">
<section id="section-9.5">
        <h3 id="name-compromised-tam">
<a class="section-number selfRef" href="#section-9.5">9.5. </a><a class="section-name selfRef" href="#name-compromised-tam">Compromised TAM</a>
        </h3>
<p id="section-9.5-1">Device TEEs are responsible for validating the supplied TAM
        certificates.  A compromised TAM may bring multiple threats and damage
        to user devices that it can manage and thus to the Device Owners.
        Information on devices that the TAM manages may be leaked to a bad
        actor.  A compromised TAM can also install many TAs to launch a DoS
        attack on devices, for example, by filling up a device's TEE resources
        reserved for TAs such that other TAs may not get resources to be
        installed or properly function. It may also install malicious TAs to
        potentially many devices under the condition that it also has a
        Trusted Component signer key that is trusted by the TEEs.  This makes
        TAMs high-value targets. A TAM could be compromised without impacting
        its certificate or raising concern from the TAM's operator.<a class="pilcrow" href="#section-9.5-1">¶</a></p>
<p id="section-9.5-2">To mitigate this threat, TEEP Agents and Device Owners have several options for detecting and mitigating a compromised TAM, 
including but potentially not limited to the following:<a class="pilcrow" href="#section-9.5-2">¶</a></p>
<ol class="normal type-1" id="section-9.5-3" start="1" type="1">
<li id="section-9.5-3.1">Apply an ACL to the TAM key, limiting which Trusted Components the TAM is permitted to install or update.<a class="pilcrow" href="#section-9.5-3.1">¶</a>
</li>
          <li id="section-9.5-3.2">Use a transparency log to expose a TAM compromise.  TAMs publish
        an out-of-band record of Trusted Component releases, allowing a TEE to
        cross-check the Trusted Components delivered against the Trusted
        Components installed in order to detect a TAM compromise.<a class="pilcrow" href="#section-9.5-3.2">¶</a>
</li>
          <li id="section-9.5-3.3">Use remote attestation of the TAM to prove trustworthiness.<a class="pilcrow" href="#section-9.5-3.3">¶</a>
</li>
        </ol>
</section>
</div>
<div id="malicious-ta-removal">
<section id="section-9.6">
        <h3 id="name-malicious-ta-removal">
<a class="section-number selfRef" href="#section-9.6">9.6. </a><a class="section-name selfRef" href="#name-malicious-ta-removal">Malicious TA Removal</a>
        </h3>
<p id="section-9.6-1">It is possible that a rogue developer distributes a malicious Untrusted 
Application and intends to have a malicious TA installed. Such a TA
might be able to escape from malware detection by the REE or access trusted
resources within the TEE (but could not access other TEEs or other
TAs if the TEE provides isolation between TAs).<a class="pilcrow" href="#section-9.6-1">¶</a></p>
<p id="section-9.6-2">It is the responsibility
of the TAM to not install malicious TAs in the first place. The TEEP
architecture allows a TEEP Agent to decide which TAMs it trusts via Trust Anchors 
and delegate the TA authenticity check to the TAMs it trusts.<a class="pilcrow" href="#section-9.6-2">¶</a></p>
<p id="section-9.6-3">A TA that was previously considered trustworthy may later be
found to be buggy or compromised.
In this case, the TAM can initiate the removal of the TA by notifying devices 
to remove the TA (and potentially notify the REE or Device Owner to remove any Untrusted 
Application that depend on the TA).  If the TAM does not currently have a
connection to the TEEP Agent on a device, such a notification would occur
the next time connectivity does exist.  
That is, to recover, the TEEP Agent
must be able to reach out to the TAM, for example, whenever the 
RequestPolicyCheck API (<a class="auto internal xref" href="#apis">Section 6.2.1</a>) is invoked by a timer or other event.<a class="pilcrow" href="#section-9.6-3">¶</a></p>
<p id="section-9.6-4">Furthermore, the policy in the Verifier in an attestation process can be
updated so that any evidence that includes the malicious TA would result
in an attestation failure.  There is, however, a time window during which
a malicious TA might be able to operate successfully, which is the
validity time of the previous attestation result.  For example, if
the Verifier in <a class="auto internal xref" href="#attestation-roles">Figure 5</a> is updated to treat a previously
valid TA as no longer trustworthy, any attestation result it previously
generated saying that the TA is valid will continue to be used until
the attestation result expires.  As such, the TAM's Verifier should
take into account the acceptable time window when generating attestation
results. See <span>[<a class="cite xref" href="#RFC9334">RFC9334</a>]</span> for further discussion.<a class="pilcrow" href="#section-9.6-4">¶</a></p>
</section>
</div>
<div id="tee-certificate-expiry-and-renewal">
<section id="section-9.7">
        <h3 id="name-tee-certificate-expiry-and-">
<a class="section-number selfRef" href="#section-9.7">9.7. </a><a class="section-name selfRef" href="#name-tee-certificate-expiry-and-">TEE Certificate Expiry and Renewal</a>
        </h3>
<p id="section-9.7-1">TEE device certificates are expected to be long-lived, longer
than the lifetime of a device.  A TAM certificate usually has a
moderate lifetime of 1 to 5 years.  A TAM should get renewed or
rekeyed certificates.  The root CA certificates for a TAM, which are
embedded into the Trust Anchor Store in a device, should have long
lifetimes that don't require device Trust Anchor updates.  On the
other hand, it is imperative that OEMs or device providers plan for
support of a Trust Anchor update in their shipped devices.<a class="pilcrow" href="#section-9.7-1">¶</a></p>
<p id="section-9.7-2">For those cases where TEE devices are given certificates for which no good
expiration date can be assigned, the recommendations in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc5280#section-4.1.2.5">Section 4.1.2.5</a> of [<a class="cite xref" href="#RFC5280">RFC5280</a>]</span> are applicable.<a class="pilcrow" href="#section-9.7-2">¶</a></p>
</section>
</div>
<div id="keeping-secrets-from-the-tam">
<section id="section-9.8">
        <h3 id="name-keeping-secrets-from-the-ta">
<a class="section-number selfRef" href="#section-9.8">9.8. </a><a class="section-name selfRef" href="#name-keeping-secrets-from-the-ta">Keeping Secrets from the TAM</a>
        </h3>
<p id="section-9.8-1">In some scenarios, it is desirable to protect the TA binary or Personalization Data
from being disclosed to the TAM that distributes them.  In such a scenario,
the files can be encrypted end-to-end between a Trusted Component Signer and a TEE.  However, there
must be some means of provisioning the decryption key into the TEE and/or some
means of the Trusted Component Signer securely learning a public key of the TEE that it can use to
encrypt. The Trusted Component Signer cannot necessarily even trust the
TAM to report the correct public key of a TEE for use with encryption, since the TAM might instead
provide the public key of a TEE that it controls.<a class="pilcrow" href="#section-9.8-1">¶</a></p>
<p id="section-9.8-2">One way to solve this is for the Trusted Component Signer to run
        its own TAM that is only used to distribute the decryption key via the
        TEEP protocol and the key file can be a dependency in the manifest of
        the encrypted TA.  Thus, the TEEP Agent would look at the Trusted
        Component manifest to determine if there is a dependency with a TAM
        URI of the Trusted Component Signer's TAM.  The Agent would then
        install the dependency and continue with the Trusted Component
        installation steps, including decrypting the TA binary with the
        relevant key.<a class="pilcrow" href="#section-9.8-2">¶</a></p>
</section>
</div>
<div id="ree-privacy">
<section id="section-9.9">
        <h3 id="name-ree-privacy">
<a class="section-number selfRef" href="#section-9.9">9.9. </a><a class="section-name selfRef" href="#name-ree-privacy">REE Privacy</a>
        </h3>
<p id="section-9.9-1">The TEEP architecture is applicable to cases where devices have a TEE that protects data
and code from the REE administrator.  In such cases, the TAM administrator, not the REE administrator,
controls the TEE in the devices.  Examples include:<a class="pilcrow" href="#section-9.9-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.9-2.1">A cloud hoster may be the REE administrator where a customer administrator controls the TEE hosted in the cloud.<a class="pilcrow" href="#section-9.9-2.1">¶</a>
</li>
          <li class="normal" id="section-9.9-2.2">A device manufacturer might control the TEE in a device purchased by a customer.<a class="pilcrow" href="#section-9.9-2.2">¶</a>
</li>
        </ul>
<p id="section-9.9-3">The privacy risk is that data in the REE might be susceptible to
 disclosure to the TEE administrator.  This risk is not introduced by
 the TEEP architecture, but it is inherent in most uses of TEEs.  This
 risk can be mitigated by making sure the REE administrator explicitly
 chooses to have a TEE that is managed by another party.  In the cloud
 hoster example, this choice is made by explicitly offering a service
 to customers to provide TEEs for them to administer.  In the device
 manufacturer example, this choice is made by the customer choosing to
 buy a device made by a given manufacturer.<a class="pilcrow" href="#section-9.9-3">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-10">
      <h2 id="name-iana-considerations">
<a class="section-number selfRef" href="#section-10">10. </a><a class="section-name selfRef" href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<p id="section-10-1">This document has no IANA actions.<a class="pilcrow" href="#section-10-1">¶</a></p>
</section>
</div>
<section id="section-11">
      <h2 id="name-informative-references">
<a class="section-number selfRef" href="#section-11">11. </a><a class="section-name selfRef" href="#name-informative-references">Informative References</a>
      </h2>
<dl class="references">
<dt id="CC-Overview">[CC-Overview]</dt>
      <dd>
<span class="refAuthor">Confidential Computing Consortium</span>, <span class="refTitle">"Confidential Computing: Hardware-Based Trusted Execution for Applications and Data"</span>, <time class="refDate" datetime="2022-11">November 2022</time>, <span>&lt;<a href="https://confidentialcomputing.io/wp-content/uploads/sites/85/2021/03/confidentialcomputing_outreach_whitepaper-8-5x11-1.pdf">https://confidentialcomputing.io/wp-content/uploads/sites/85/2021/03/confidentialcomputing_outreach_whitepaper-8-5x11-1.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="CC-Technical-Analysis">[CC-Technical-Analysis]</dt>
      <dd>
<span class="refAuthor">Confidential Computing Consortium</span>, <span class="refTitle">"A Technical Analysis of Confidential Computing"</span>, <span class="refContent">v1.3</span>, <time class="refDate" datetime="2022-11">November 2022</time>, <span>&lt;<a href="https://confidentialcomputing.io/wp-content/uploads/sites/10/2023/03/CCC-A-Technical-Analysis-of-Confidential-Computing-v1.3_unlocked.pdf">https://confidentialcomputing.io/wp-content/uploads/sites/10/2023/03/CCC-A-Technical-Analysis-of-Confidential-Computing-v1.3_unlocked.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-rats-eat">[EAT]</dt>
      <dd>
<span class="refAuthor">Lundblade, L.</span>, <span class="refAuthor">Mandyam, G.</span>, <span class="refAuthor">O'Donoghue, J.</span>, and <span class="refAuthor">C. Wallace</span>, <span class="refTitle">"The Entity Attestation Token (EAT)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-rats-eat-21</span>, <time class="refDate" datetime="2023-06-30">30 June 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-eat-21">https://datatracker.ietf.org/doc/html/draft-ietf-rats-eat-21</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="GPTEE">[GPTEE]</dt>
      <dd>
<span class="refAuthor">GlobalPlatform</span>, <span class="refTitle">"TEE System Architecture v1.3"</span>, <span class="seriesInfo">GlobalPlatform GPD_SPE_009</span>, <time class="refDate" datetime="2022-05">May 2022</time>, <span>&lt;<a href="https://globalplatform.org/specs-library/tee-system-architecture/">https://globalplatform.org/specs-library/tee-system-architecture/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="GSMA">[GSMA]</dt>
      <dd>
<span class="refAuthor">GSM Association</span>, <span class="refTitle">"SGP.22 RSP Technical Specification"</span>, <span class="refContent">Version 2.2.2</span>, <time class="refDate" datetime="2020-06">June 2020</time>, <span>&lt;<a href="https://www.gsma.com/esim/wp-content/uploads/2020/06/SGP.22-v2.2.2.pdf">https://www.gsma.com/esim/wp-content/uploads/2020/06/SGP.22-v2.2.2.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="OP-TEE">[OP-TEE]</dt>
      <dd>
<span class="refAuthor">TrustedFirmware.org</span>, <span class="refTitle">"OP-TEE Documentation"</span>, <span>&lt;<a href="https://optee.readthedocs.io/en/latest/">https://optee.readthedocs.io/en/latest/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="OTRP">[OTRP]</dt>
      <dd>
<span class="refAuthor">GlobalPlatform</span>, <span class="refTitle">"TEE Management Framework: Open Trust Protocol (OTrP) Profile v1.1"</span>, <span class="seriesInfo">GlobalPlatform GPD_SPE_123</span>, <time class="refDate" datetime="2020-07">July 2020</time>, <span>&lt;<a href="https://globalplatform.org/specs-library/tee-management-framework-open-trust-protocol/">https://globalplatform.org/specs-library/tee-management-framework-open-trust-protocol/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-rats-daa">[RATS-DAA]</dt>
      <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Newton, C.</span>, <span class="refAuthor">Chen, L.</span>, and <span class="refAuthor">D. Thaler</span>, <span class="refTitle">"Direct Anonymous Attestation for the Remote Attestation Procedures Architecture"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-rats-daa-03</span>, <time class="refDate" datetime="2023-03-10">10 March 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-daa-03">https://datatracker.ietf.org/doc/html/draft-ietf-rats-daa-03</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4949">[RFC4949]</dt>
      <dd>
<span class="refAuthor">Shirey, R.</span>, <span class="refTitle">"Internet Security Glossary, Version 2"</span>, <span class="seriesInfo">FYI 36</span>, <span class="seriesInfo">RFC 4949</span>, <span class="seriesInfo">DOI 10.17487/RFC4949</span>, <time class="refDate" datetime="2007-08">August 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4949">https://www.rfc-editor.org/info/rfc4949</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5280">[RFC5280]</dt>
      <dd>
<span class="refAuthor">Cooper, D.</span>, <span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Boeyen, S.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time class="refDate" datetime="2008-05">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5280">https://www.rfc-editor.org/info/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6024">[RFC6024]</dt>
      <dd>
<span class="refAuthor">Reddy, R.</span> and <span class="refAuthor">C. Wallace</span>, <span class="refTitle">"Trust Anchor Management Requirements"</span>, <span class="seriesInfo">RFC 6024</span>, <span class="seriesInfo">DOI 10.17487/RFC6024</span>, <time class="refDate" datetime="2010-10">October 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6024">https://www.rfc-editor.org/info/rfc6024</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7696">[RFC7696]</dt>
      <dd>
<span class="refAuthor">Housley, R.</span>, <span class="refTitle">"Guidelines for Cryptographic Algorithm Agility and Selecting Mandatory-to-Implement Algorithms"</span>, <span class="seriesInfo">BCP 201</span>, <span class="seriesInfo">RFC 7696</span>, <span class="seriesInfo">DOI 10.17487/RFC7696</span>, <time class="refDate" datetime="2015-11">November 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7696">https://www.rfc-editor.org/info/rfc7696</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9019">[RFC9019]</dt>
      <dd>
<span class="refAuthor">Moran, B.</span>, <span class="refAuthor">Tschofenig, H.</span>, <span class="refAuthor">Brown, D.</span>, and <span class="refAuthor">M. Meriac</span>, <span class="refTitle">"A Firmware Update Architecture for Internet of Things"</span>, <span class="seriesInfo">RFC 9019</span>, <span class="seriesInfo">DOI 10.17487/RFC9019</span>, <time class="refDate" datetime="2021-04">April 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9019">https://www.rfc-editor.org/info/rfc9019</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9334">[RFC9334]</dt>
      <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Thaler, D.</span>, <span class="refAuthor">Richardson, M.</span>, <span class="refAuthor">Smith, N.</span>, and <span class="refAuthor">W. Pan</span>, <span class="refTitle">"Remote ATtestation procedureS (RATS) Architecture"</span>, <span class="seriesInfo">RFC 9334</span>, <span class="seriesInfo">DOI 10.17487/RFC9334</span>, <time class="refDate" datetime="2023-01">January 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9334">https://www.rfc-editor.org/info/rfc9334</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SGX">[SGX]</dt>
      <dd>
<span class="refAuthor">Intel</span>, <span class="refTitle">"Intel(R) Software Guard Extensions (Intel (R) SGX)"</span>, <span>&lt;<a href="https://www.intel.com/content/www/us/en/architecture-and-technology/software-guard-extensions.html">https://www.intel.com/content/www/us/en/architecture-and-technology/software-guard-extensions.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-suit-manifest">[SUIT-MANIFEST]</dt>
      <dd>
<span class="refAuthor">Moran, B.</span>, <span class="refAuthor">Tschofenig, H.</span>, <span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Zandberg, K.</span>, and <span class="refAuthor">O. Rønningstad</span>, <span class="refTitle">"A Concise Binary Object Representation (CBOR)-based Serialization Format for the Software Updates for Internet of Things (SUIT) Manifest"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-suit-manifest-22</span>, <time class="refDate" datetime="2023-02-27">27 February 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-suit-manifest-22">https://datatracker.ietf.org/doc/html/draft-ietf-suit-manifest-22</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-teep-protocol">[TEEP]</dt>
      <dd>
<span class="refAuthor">Tschofenig, H.</span>, <span class="refAuthor">Pei, M.</span>, <span class="refAuthor">Wheeler, D. M.</span>, <span class="refAuthor">Thaler, D.</span>, and <span class="refAuthor">A. Tsukamoto</span>, <span class="refTitle">"Trusted Execution Environment Provisioning (TEEP) Protocol"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-teep-protocol-15</span>, <time class="refDate" datetime="2023-07-03">3 July 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-teep-protocol-15">https://datatracker.ietf.org/doc/html/draft-ietf-teep-protocol-15</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-teep-otrp-over-http">[TEEP-HTTP]</dt>
      <dd>
<span class="refAuthor">Thaler, D.</span>, <span class="refTitle">"HTTP Transport for Trusted Execution Environment Provisioning: Agent Initiated Communication"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-teep-otrp-over-http-15</span>, <time class="refDate" datetime="2023-03-27">27 March 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-teep-otrp-over-http-15">https://datatracker.ietf.org/doc/html/draft-ietf-teep-otrp-over-http-15</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TrustZone">[TrustZone]</dt>
    <dd>
<span class="refAuthor">Arm</span>, <span class="refTitle">"TrustZone for Cortex-A"</span>, <span>&lt;<a href="https://www.arm.com/technologies/trustzone-for-cortex-a">https://www.arm.com/technologies/trustzone-for-cortex-a</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<div id="acknowledgements">
<section id="appendix-A">
      <h2 id="name-acknowledgments">
<a class="section-name selfRef" href="#name-acknowledgments">Acknowledgments</a>
      </h2>
<p id="appendix-A-1">We would like to thank <span class="contact-name">Nick Cook</span>, <span class="contact-name">Minho Yoo</span>, <span class="contact-name">Brian Witten</span>, <span class="contact-name">Tyler Kim</span>, <span class="contact-name">Alin Mutu</span>, <span class="contact-name">Juergen Schoenwaelder</span>, <span class="contact-name">Nicolae       Paladi</span>, <span class="contact-name">Sorin Faibish</span>, <span class="contact-name">Ned       Smith</span>, <span class="contact-name">Russ Housley</span>, <span class="contact-name">Jeremy       O'Donoghue</span>, <span class="contact-name">Anders Rundgren</span>, and <span class="contact-name">Brendan Moran</span> for their feedback.<a class="pilcrow" href="#appendix-A-1">¶</a></p>
</section>
</div>
<div id="contributors">
<section id="appendix-B">
      <h2 id="name-contributors">
<a class="section-name selfRef" href="#name-contributors">Contributors</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Andrew Atyeo</span></div>
<div class="left" dir="auto"><span class="org">Intercede</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:andrew.atyeo@intercede.com">andrew.atyeo@intercede.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Liu Dapeng</span></div>
<div class="left" dir="auto"><span class="org">Alibaba Group</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:maxpassion@gmail.com">maxpassion@gmail.com</a>
</div>
</address>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-C">
      <h2 id="name-authors-addresses">
<a class="section-name selfRef" href="#name-authors-addresses">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Mingliang Pei</span></div>
<div class="left" dir="auto"><span class="org">Broadcom</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:mingliang.pei@broadcom.com">mingliang.pei@broadcom.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Hannes Tschofenig</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:hannes.tschofenig@gmx.net">hannes.tschofenig@gmx.net</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Dave Thaler</span></div>
<div class="left" dir="auto"><span class="org">Microsoft</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:dthaler@microsoft.com">dthaler@microsoft.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">David Wheeler</span></div>
<div class="left" dir="auto"><span class="org">Amazon</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:davewhee@amazon.com">davewhee@amazon.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>


</body></html>