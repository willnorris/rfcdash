<!DOCTYPE html>
<html class="RFC" lang="en"><head>
<meta charset="utf-8"/>
<meta content="Common,Latin" name="scripts"/>
<meta content="initial-scale=1.0" name="viewport"/>
<title>RFC 9576: The Privacy Pass Architecture</title>
<meta content="Alex Davidson" name="author"/>
<meta content="Jana Iyengar" name="author"/>
<meta content="Christopher A. Wood" name="author"/>
<meta content="
       This document specifies the Privacy Pass architecture and requirements for
its constituent protocols used for authorization based on privacy-preserving
authentication mechanisms. It describes the conceptual model of Privacy Pass
and its protocols, its security and privacy goals, practical deployment models,
and recommendations for each deployment model, to help ensure that the desired
security and privacy goals are fulfilled. 
    " name="description"/>
<meta content="xml2rfc 3.21.0" name="generator"/>
<meta content="9576" name="rfc.number"/>
<!-- Generator version information:
  xml2rfc 3.21.0
    Python 3.9.15
    ConfigArgParse 1.5.3
    google-i18n-address 3.0.0
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 4.9.0
    platformdirs 3.8.0
    pycountry 22.3.5
    PyYAML 6.0
    requests 2.28.0
    setuptools 44.1.1
    six 1.16.0
    wcwidth 0.2.5
    weasyprint 56.1
-->
<link href="rfc9576.xml" rel="alternate" type="application/rfc+xml"/>
<link href="#copyright" rel="license"/>
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necessary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

:root {
  --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
  --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
  --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
}

@viewport {
  zoom: 1.0;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: var(--font-sans);
  line-height: 1.6;
  scroll-behavior: smooth;
  overflow-wrap: break-word;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
svg[font-family~="serif" i], svg [font-family~="serif" i] {
  font-family: var(--font-serif);
}
svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
  font-family: var(--font-sans);
}
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre {
  background-color: #f9f9f9;
  font-family: var(--font-mono);
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
blockquote > *:last-child {
  margin-bottom: 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}
.xref {
  overflow-wrap: normal;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.refSubseries {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: var(--font-sans);
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  .breakable pre {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The following is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
.sourcecode pre,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .artwork > pre,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background slightly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottom margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the compact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div.sourcecode:first-child,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type:only-child {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css"/>
<link href="https://datatracker.ietf.org/doc/draft-ietf-privacypass-architecture-16" rel="prev"/>
  <link href="https://dx.doi.org/10.17487/rfc9576" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  </head>
<body class="xml2rfc">
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 9576</td>
<td class="center">Privacy Pass Architecture</td>
<td class="right">June 2024</td>
</tr></thead>
<tfoot><tr>
<td class="left">Davidson, et al.</td>
<td class="center">Informational</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div class="document-information" id="external-metadata"></div>
<div class="document-information" id="internal-metadata">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a class="eref" href="https://www.rfc-editor.org/rfc/rfc9576">9576</a></dd>
<dt class="label-category">Category:</dt>
<dd class="category">Informational</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time class="published" datetime="2024-06">June 2024</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">A. Davidson</div>
<div class="org">NOVA LINCS, Universidade NOVA de Lisboa</div>
</div>
<div class="author">
      <div class="author-name">J. Iyengar</div>
<div class="org">Fastly</div>
</div>
<div class="author">
      <div class="author-name">C. A. Wood</div>
<div class="org">Cloudflare</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 9576</h1>
<h1 id="title">The Privacy Pass Architecture</h1>
<section id="section-abstract">
      <h2 id="abstract"><a class="selfRef" href="#abstract">Abstract</a></h2>
<p id="section-abstract-1">This document specifies the Privacy Pass architecture and requirements for
its constituent protocols used for authorization based on privacy-preserving
authentication mechanisms. It describes the conceptual model of Privacy Pass
and its protocols, its security and privacy goals, practical deployment models,
and recommendations for each deployment model, to help ensure that the desired
security and privacy goals are fulfilled.<a class="pilcrow" href="#section-abstract-1">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a class="section-name selfRef" href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This document is not an Internet Standards Track specification; it is
            published for informational purposes.<a class="pilcrow" href="#section-boilerplate.1-1">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by the
            Internet Engineering Steering Group (IESG).  Not all documents
            approved by the IESG are candidates for any level of Internet
            Standard; see Section 2 of RFC 7841.<a class="pilcrow" href="#section-boilerplate.1-2">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc9576">https://www.rfc-editor.org/info/rfc9576</a></span>.<a class="pilcrow" href="#section-boilerplate.1-3">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a class="section-name selfRef" href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2024 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a class="pilcrow" href="#section-boilerplate.2-1">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a class="pilcrow" href="#section-boilerplate.2-2">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a class="toplink" href="#" onclick="scroll(0,0)">▲</a><h2 id="name-table-of-contents">
<a class="section-name selfRef" href="#name-table-of-contents">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p class="keepWithNext" id="section-toc.1-1.1.1"><a class="auto internal xref" href="#section-1">1</a>.  <a class="internal xref" href="#name-introduction">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p class="keepWithNext" id="section-toc.1-1.2.1"><a class="auto internal xref" href="#section-2">2</a>.  <a class="internal xref" href="#name-terminology">Terminology</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a class="auto internal xref" href="#section-3">3</a>.  <a class="internal xref" href="#name-architecture">Architecture</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p class="keepWithNext" id="section-toc.1-1.3.2.1.1"><a class="auto internal xref" href="#section-3.1">3.1</a>.  <a class="internal xref" href="#name-overview">Overview</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a class="auto internal xref" href="#section-3.2">3.2</a>.  <a class="internal xref" href="#name-use-cases">Use Cases</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a class="auto internal xref" href="#section-3.3">3.3</a>.  <a class="internal xref" href="#name-privacy-goals-and-threat-mo">Privacy Goals and Threat Model</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a class="auto internal xref" href="#section-3.4">3.4</a>.  <a class="internal xref" href="#name-redemption-protocol">Redemption Protocol</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a class="auto internal xref" href="#section-3.5">3.5</a>.  <a class="internal xref" href="#name-issuance-protocol">Issuance Protocol</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5.2.1">
                    <p id="section-toc.1-1.3.2.5.2.1.1"><a class="auto internal xref" href="#section-3.5.1">3.5.1</a>.  <a class="internal xref" href="#name-attester-role">Attester Role</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5.2.2">
                    <p id="section-toc.1-1.3.2.5.2.2.1"><a class="auto internal xref" href="#section-3.5.2">3.5.2</a>.  <a class="internal xref" href="#name-issuer-role">Issuer Role</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5.2.3">
                    <p id="section-toc.1-1.3.2.5.2.3.1"><a class="auto internal xref" href="#section-3.5.3">3.5.3</a>.  <a class="internal xref" href="#name-issuance-metadata">Issuance Metadata</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5.2.4">
                    <p id="section-toc.1-1.3.2.5.2.4.1"><a class="auto internal xref" href="#section-3.5.4">3.5.4</a>.  <a class="internal xref" href="#name-future-issuance-protocol-re">Future Issuance Protocol Requirements</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6">
                <p id="section-toc.1-1.3.2.6.1"><a class="auto internal xref" href="#section-3.6">3.6</a>.  <a class="internal xref" href="#name-information-flow">Information Flow</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6.2.1">
                    <p id="section-toc.1-1.3.2.6.2.1.1"><a class="auto internal xref" href="#section-3.6.1">3.6.1</a>.  <a class="internal xref" href="#name-token-challenge-flow">Token Challenge Flow</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6.2.2">
                    <p id="section-toc.1-1.3.2.6.2.2.1"><a class="auto internal xref" href="#section-3.6.2">3.6.2</a>.  <a class="internal xref" href="#name-attestation-flow">Attestation Flow</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6.2.3">
                    <p id="section-toc.1-1.3.2.6.2.3.1"><a class="auto internal xref" href="#section-3.6.3">3.6.3</a>.  <a class="internal xref" href="#name-issuance-flow">Issuance Flow</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6.2.4">
                    <p id="section-toc.1-1.3.2.6.2.4.1"><a class="auto internal xref" href="#section-3.6.4">3.6.4</a>.  <a class="internal xref" href="#name-token-redemption-flow">Token Redemption Flow</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a class="auto internal xref" href="#section-4">4</a>.  <a class="internal xref" href="#name-deployment-models">Deployment Models</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a class="auto internal xref" href="#section-4.1">4.1</a>.  <a class="internal xref" href="#name-shared-origin-attester-issu">Shared Origin, Attester, Issuer</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a class="auto internal xref" href="#section-4.2">4.2</a>.  <a class="internal xref" href="#name-joint-attester-and-issuer">Joint Attester and Issuer</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a class="auto internal xref" href="#section-4.3">4.3</a>.  <a class="internal xref" href="#name-joint-origin-and-issuer">Joint Origin and Issuer</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a class="auto internal xref" href="#section-4.4">4.4</a>.  <a class="internal xref" href="#name-split-origin-attester-issue">Split Origin, Attester, Issuer</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a class="auto internal xref" href="#section-5">5</a>.  <a class="internal xref" href="#name-deployment-considerations">Deployment Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a class="auto internal xref" href="#section-5.1">5.1</a>.  <a class="internal xref" href="#name-discriminatory-treatment">Discriminatory Treatment</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a class="auto internal xref" href="#section-5.2">5.2</a>.  <a class="internal xref" href="#name-centralization">Centralization</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a class="auto internal xref" href="#section-6">6</a>.  <a class="internal xref" href="#name-privacy-considerations">Privacy Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a class="auto internal xref" href="#section-6.1">6.1</a>.  <a class="internal xref" href="#name-partitioning-by-issuance-me">Partitioning by Issuance Metadata</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a class="auto internal xref" href="#section-6.2">6.2</a>.  <a class="internal xref" href="#name-partitioning-by-issuance-co">Partitioning by Issuance Consistency</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a class="auto internal xref" href="#section-6.3">6.3</a>.  <a class="internal xref" href="#name-partitioning-by-side-channe">Partitioning by Side Channels</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a class="auto internal xref" href="#section-7">7</a>.  <a class="internal xref" href="#name-security-considerations">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a class="auto internal xref" href="#section-7.1">7.1</a>.  <a class="internal xref" href="#name-token-caching">Token Caching</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a class="auto internal xref" href="#section-8">8</a>.  <a class="internal xref" href="#name-iana-considerations">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a class="auto internal xref" href="#section-9">9</a>.  <a class="internal xref" href="#name-references">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a class="auto internal xref" href="#section-9.1">9.1</a>.  <a class="internal xref" href="#name-normative-references">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a class="auto internal xref" href="#section-9.2">9.2</a>.  <a class="internal xref" href="#name-informative-references">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a class="auto internal xref" href="#appendix-A"></a><a class="internal xref" href="#name-acknowledgements">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a class="auto internal xref" href="#appendix-B"></a><a class="internal xref" href="#name-authors-addresses">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a class="section-number selfRef" href="#section-1">1. </a><a class="section-name selfRef" href="#name-introduction">Introduction</a>
      </h2>
<p id="section-1-1">Privacy Pass is an architecture for authorization based on privacy-preserving
authentication mechanisms. In other words, relying parties authenticate Clients
in a privacy-preserving way, i.e., without learning any unique, per-Client
information through the authentication protocol, and then make authorization
decisions on the basis of that authentication succeeding or failing. Possible
authorization decisions might be to provide Clients with read access to a
particular resource or write access to a particular resource.<a class="pilcrow" href="#section-1-1">¶</a></p>
<p id="section-1-2">Typical approaches for authorizing Clients, such as through the use of long-term
state (cookies), are not privacy friendly, since they allow servers to track
Clients across sessions and interactions. Privacy Pass takes a different
approach: instead of presenting linkable state-carrying information to servers,
e.g., a cookie indicating whether or not the Client is an authorized user or
has completed some prior challenge, Clients present unlinkable proofs that
attest to this information. These proofs, or tokens, are private in the sense
that a given token cannot be linked to the protocol interaction where that
token was initially issued.<a class="pilcrow" href="#section-1-2">¶</a></p>
<p id="section-1-3">At a high level, the Privacy Pass architecture consists of two protocols:
redemption and issuance. The redemption protocol, described in
<span>[<a class="cite xref" href="#RFC9577">AUTHSCHEME</a>]</span>, runs between Clients and
Origins (servers). It allows Origins to challenge Clients to present tokens
for consumption. Origins verify the token to authenticate the Client -- without
learning any specific information about the Client -- and then make an authorization
decision on the basis of the token verifying successfully or not. Depending
on the type of token, e.g., whether or not it can be cached, the Client
either presents a previously obtained token or invokes an issuance protocol,
e.g., the protocols described in <span>[<a class="cite xref" href="#RFC9578">ISSUANCE</a>]</span>, to acquire a token to
present as authorization.<a class="pilcrow" href="#section-1-3">¶</a></p>
<p id="section-1-4">This document describes requirements for both redemption and issuance
protocols and how they interact. It also provides recommendations on how
the architecture should be deployed to ensure the privacy of Clients and
the security of all participating entities.<a class="pilcrow" href="#section-1-4">¶</a></p>
</section>
</div>
<div id="terminology">
<section id="section-2">
      <h2 id="name-terminology">
<a class="section-number selfRef" href="#section-2">2. </a><a class="section-name selfRef" href="#name-terminology">Terminology</a>
      </h2>
<p id="section-2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>",
       "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>",
       "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>",
       "<span class="bcp14">SHOULD NOT</span>",
       "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
       "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document
       are to be interpreted as described in BCP 14
       <span>[<a class="cite xref" href="#RFC2119">RFC2119</a>]</span> <span>[<a class="cite xref" href="#RFC8174">RFC8174</a>]</span> when, and only
       when, they appear in all capitals, as shown here.<a class="pilcrow" href="#section-2-1">¶</a></p>
<p id="section-2-2">The following terms are used throughout this document:<a class="pilcrow" href="#section-2-2">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2-3">
        <dt id="section-2-3.1">Client:</dt>
        <dd id="section-2-3.2" style="margin-left: 1.5em">
          <p id="section-2-3.2.1">An entity that seeks authorization to an Origin. Using terminology from <span>[<a class="cite xref" href="#RFC9334">RFC9334</a>]</span>,
Clients implement the Remote ATtestation procedureS (RATS) Attester role.<a class="pilcrow" href="#section-2-3.2.1">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.3">Token:</dt>
        <dd id="section-2-3.4" style="margin-left: 1.5em">
          <p id="section-2-3.4.1">A cryptographic authentication message used for authorization decisions,
produced as output from an issuance mechanism or protocol.<a class="pilcrow" href="#section-2-3.4.1">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.5">Origin:</dt>
        <dd id="section-2-3.6" style="margin-left: 1.5em">
          <p id="section-2-3.6.1">An entity that consumes tokens presented by Clients and uses them to make authorization decisions.<a class="pilcrow" href="#section-2-3.6.1">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.7">Token challenge:</dt>
        <dd id="section-2-3.8" style="margin-left: 1.5em">
          <p id="section-2-3.8.1">The mechanism by which Origins request tokens from Clients, often denoted TokenChallenge.<a class="pilcrow" href="#section-2-3.8.1">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.9">Token request:</dt>
        <dd id="section-2-3.10" style="margin-left: 1.5em">
          <p id="section-2-3.10.1">A message used by Clients to request a token from an Issuer, often denoted TokenRequest.<a class="pilcrow" href="#section-2-3.10.1">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.11">Token response:</dt>
        <dd id="section-2-3.12" style="margin-left: 1.5em">
          <p id="section-2-3.12.1">A message used by Issuers to send tokens to a Client, often denoted TokenResponse.<a class="pilcrow" href="#section-2-3.12.1">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.13">Redemption:</dt>
        <dd id="section-2-3.14" style="margin-left: 1.5em">
          <p id="section-2-3.14.1">The mechanism by which Clients present tokens to Origins for the
purposes of authorization.<a class="pilcrow" href="#section-2-3.14.1">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.15">Issuer:</dt>
        <dd id="section-2-3.16" style="margin-left: 1.5em">
          <p id="section-2-3.16.1">An entity that issues tokens to Clients for properties
attested to by the Attester.<a class="pilcrow" href="#section-2-3.16.1">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.17">Issuance:</dt>
        <dd id="section-2-3.18" style="margin-left: 1.5em">
          <p id="section-2-3.18.1">The mechanism by which an Issuer produces tokens for Clients.<a class="pilcrow" href="#section-2-3.18.1">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.19">Attester:</dt>
        <dd id="section-2-3.20" style="margin-left: 1.5em">
          <p id="section-2-3.20.1">An entity that attests to properties of Clients for the
purposes of token issuance. Using terminology from <span>[<a class="cite xref" href="#RFC9334">RFC9334</a>]</span>, Attesters implement the RATS Verifier role.<a class="pilcrow" href="#section-2-3.20.1">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.21">Attestation procedure:</dt>
        <dd id="section-2-3.22" style="margin-left: 1.5em">
          <p id="section-2-3.22.1">The procedure by which an Attester determines whether or not a Client
has the specific set of properties that are necessary for token issuance.<a class="pilcrow" href="#section-2-3.22.1">¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-2-4">The trust relationships between each of the entities in this list are further
elaborated upon in <a class="auto internal xref" href="#privacy-and-trust">Section 3.3</a>.<a class="pilcrow" href="#section-2-4">¶</a></p>
</section>
</div>
<div id="architecture">
<section id="section-3">
      <h2 id="name-architecture">
<a class="section-number selfRef" href="#section-3">3. </a><a class="section-name selfRef" href="#name-architecture">Architecture</a>
      </h2>
<p id="section-3-1">The Privacy Pass architecture consists of four logical entities --
Client, Origin, Issuer, and Attester -- that work in concert
for token redemption and issuance. This section presents an overview
of Privacy Pass, a high-level description of the threat model and
privacy goals of the architecture, and the goals and requirements of
the redemption and issuance protocols. Deployment variations for the
Origin, Issuer, and Attester in this architecture, including
considerations for implementing these entities, are further discussed
in <a class="auto internal xref" href="#deployment">Section 4</a>.<a class="pilcrow" href="#section-3-1">¶</a></p>
<div id="overview">
<section id="section-3.1">
        <h3 id="name-overview">
<a class="section-number selfRef" href="#section-3.1">3.1. </a><a class="section-name selfRef" href="#name-overview">Overview</a>
        </h3>
<p id="section-3.1-1">This section describes the typical interaction flow for Privacy Pass, as shown in <a class="auto internal xref" href="#fig-overview">Figure 1</a>.<a class="pilcrow" href="#section-3.1-1">¶</a></p>
<ol class="normal type-1" id="section-3.1-2" start="1" type="1">
<li id="section-3.1-2.1">A Client interacts with an Origin by sending a request or otherwise
interacting with the Origin in a way that triggers a response containing
a token challenge. The token challenge indicates a specific Issuer to use.<a class="pilcrow" href="#section-3.1-2.1">¶</a>
</li>
          <li id="section-3.1-2.2">If the Client already has a token available that satisfies the token
challenge, e.g., because the Client has a cache of previously issued tokens,
it can skip to <a class="internal xref" href="#step-redemption">step 6</a> and redeem its
token; see <a class="auto internal xref" href="#hoarding">Section 7.1</a> for security considerations regarding cached tokens.<a class="pilcrow" href="#section-3.1-2.2">¶</a>
</li>
          <li id="section-3.1-2.3">If the Client does not have a token available and decides it wants to
obtain one (or more) bound to the token challenge, it then invokes the
issuance protocol. As a prerequisite to the issuance protocol, the Client
runs the deployment-specific attestation process that is required for the
designated Issuer. Client attestation can be done via proof of solving a
CAPTCHA, checking device or hardware attestation validity, etc.; see
<a class="auto internal xref" href="#attester">Section 3.5.1</a> for more details.<a class="pilcrow" href="#section-3.1-2.3">¶</a>
</li>
          <li id="section-3.1-2.4">If the attestation process completes successfully, the Client creates a
token request to send to the designated Issuer (generally via the Attester,
though it is not required to be sent through the Attester).
The Attester and Issuer might be functions on the same server, depending on the
deployment model (see <a class="auto internal xref" href="#deployment">Section 4</a>). Depending on the attestation process, it
is possible for attestation to run alongside the issuance protocol, e.g., where
Clients send necessary attestation information to the Attester along with their
token request. If the attestation process fails, the Client receives an error
and issuance aborts without a token.<a class="pilcrow" href="#section-3.1-2.4">¶</a>
</li>
          <li id="section-3.1-2.5">The Issuer generates a token response based on the token request, which
is returned to the Client (generally via the Attester). Upon receiving the
token response, the Client computes a token from the token challenge and token
response. This token can be validated by anyone with the per-Issuer key but
cannot be linked to the content of the token request or token response.<a class="pilcrow" href="#section-3.1-2.5">¶</a>
</li>
          <li id="section-3.1-2.6">
            <div id="step-redemption">
<p id="section-3.1-2.6.1">If the Client has a token, it includes it in a subsequent request to
the Origin, as authorization. This token is sent only once in reaction to a
challenge; Clients do not send tokens more than once, even if they receive
duplicate or redundant challenges. The Origin
validates that the token was generated by the expected Issuer and has not
already been redeemed for the corresponding token challenge.  If the Client
does not have a token, perhaps because issuance failed, the Client does not
reply to the Origin's challenge with a new request.<a class="pilcrow" href="#section-3.1-2.6.1">¶</a></p>
</div>
</li>
        </ol>
<span id="name-privacy-pass-redemption-and"></span><div id="fig-overview">
<figure id="figure-1">
          <div id="section-3.1-3.1">
            <div class="alignLeft art-svg artwork" id="section-3.1-3.1.1">
<svg class="diagram" font-family="monospace" font-size="13px" stroke-linecap="round" text-anchor="middle" version="1.1" viewBox="0 0 520 224" xmlns="http://www.w3.org/2000/svg">
                <path d="M 8,32 L 8,64" fill="none" stroke="black"></path>
                <path d="M 40,64 L 40,208" fill="none" stroke="black"></path>
                <path d="M 80,32 L 80,64" fill="none" stroke="black"></path>
                <path d="M 184,32 L 184,64" fill="none" stroke="black"></path>
                <path d="M 216,64 L 216,208" fill="none" stroke="black"></path>
                <path d="M 256,32 L 256,64" fill="none" stroke="black"></path>
                <path d="M 336,32 L 336,64" fill="none" stroke="black"></path>
                <path d="M 376,64 L 376,144" fill="none" stroke="black"></path>
                <path d="M 376,192 L 376,208" fill="none" stroke="black"></path>
                <path d="M 424,32 L 424,64" fill="none" stroke="black"></path>
                <path d="M 440,32 L 440,64" fill="none" stroke="black"></path>
                <path d="M 472,64 L 472,208" fill="none" stroke="black"></path>
                <path d="M 512,32 L 512,64" fill="none" stroke="black"></path>
                <path d="M 8,32 L 80,32" fill="none" stroke="black"></path>
                <path d="M 184,32 L 256,32" fill="none" stroke="black"></path>
                <path d="M 336,32 L 424,32" fill="none" stroke="black"></path>
                <path d="M 440,32 L 512,32" fill="none" stroke="black"></path>
                <path d="M 8,64 L 80,64" fill="none" stroke="black"></path>
                <path d="M 184,64 L 256,64" fill="none" stroke="black"></path>
                <path d="M 336,64 L 424,64" fill="none" stroke="black"></path>
                <path d="M 440,64 L 512,64" fill="none" stroke="black"></path>
                <path d="M 48,96 L 88,96" fill="none" stroke="black"></path>
                <path d="M 168,96 L 216,96" fill="none" stroke="black"></path>
                <path d="M 40,112 L 56,112" fill="none" stroke="black"></path>
                <path d="M 192,112 L 208,112" fill="none" stroke="black"></path>
                <path d="M 224,126 L 240,126" fill="none" stroke="black"></path>
                <path d="M 224,130 L 240,130" fill="none" stroke="black"></path>
                <path d="M 352,126 L 368,126" fill="none" stroke="black"></path>
                <path d="M 352,130 L 368,130" fill="none" stroke="black"></path>
                <path d="M 216,160 L 288,160" fill="none" stroke="black"></path>
                <path d="M 408,160 L 464,160" fill="none" stroke="black"></path>
                <path d="M 224,176 L 288,176" fill="none" stroke="black"></path>
                <path d="M 416,176 L 472,176" fill="none" stroke="black"></path>
                <path d="M 48,192 L 64,192" fill="none" stroke="black"></path>
                <path d="M 192,192 L 216,192" fill="none" stroke="black"></path>
                <polygon class="arrowhead" fill="black" points="472,160 460,154.4 460,165.6" transform="rotate(0,464,160)"></polygon>
                <polygon class="arrowhead" fill="black" points="376,128 364,122.4 364,133.6" transform="rotate(0,368,128)"></polygon>
                <polygon class="arrowhead" fill="black" points="232,176 220,170.4 220,181.6" transform="rotate(180,224,176)"></polygon>
                <polygon class="arrowhead" fill="black" points="232,128 220,122.4 220,133.6" transform="rotate(180,224,128)"></polygon>
                <polygon class="arrowhead" fill="black" points="216,112 204,106.4 204,117.6" transform="rotate(0,208,112)"></polygon>
                <polygon class="arrowhead" fill="black" points="56,192 44,186.4 44,197.6" transform="rotate(180,48,192)"></polygon>
                <polygon class="arrowhead" fill="black" points="56,96 44,90.4 44,101.6" transform="rotate(180,48,96)"></polygon>
                <g class="text">
                  <text x="44" y="52">Origin</text>
                  <text x="220" y="52">Client</text>
                  <text x="380" y="52">Attester</text>
                  <text x="476" y="52">Issuer</text>
                  <text x="128" y="100">Request</text>
                  <text x="124" y="116">TokenChallenge</text>
                  <text x="296" y="132">Attestation</text>
                  <text x="348" y="164">TokenRequest</text>
                  <text x="352" y="180">TokenResponse</text>
                  <text x="128" y="196">Request+Token</text>
                </g>
              </svg><a class="pilcrow" href="#section-3.1-3.1.1">¶</a>
</div>
</div>
<figcaption><a class="selfRef" href="#figure-1">Figure 1</a>:
<a class="selfRef" href="#name-privacy-pass-redemption-and">Privacy Pass Redemption and Issuance Protocol Interaction</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="use-cases">
<section id="section-3.2">
        <h3 id="name-use-cases">
<a class="section-number selfRef" href="#section-3.2">3.2. </a><a class="section-name selfRef" href="#name-use-cases">Use Cases</a>
        </h3>
<p id="section-3.2-1">Use cases for Privacy Pass are broad and depend greatly on the deployment model
as discussed in <a class="auto internal xref" href="#deployment">Section 4</a>. The initial motivating use case for Privacy Pass
<span>[<a class="cite xref" href="#PrivacyPassCloudflare">PrivacyPassCloudflare</a>]</span> was to help rate-limit malicious or otherwise abusive
traffic from services such as Tor <span>[<a class="cite xref" href="#DMS2004">DMS2004</a>]</span>. The generalized and evolved
architecture described in this document also works for this use case. However,
for added clarity, some more possible use cases are described below.<a class="pilcrow" href="#section-3.2-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-2.1">Low-quality, anti-fraud signal for open Internet services. Tokens can attest that
the Client behind the user agent is likely not a bot attempting to perform some
form of automated attack such as credential stuffing. Example attestation procedures
for this use case might be solving some form of CAPTCHA or presenting evidence of a
valid, unlocked device in good standing.<a class="pilcrow" href="#section-3.2-2.1">¶</a>
</li>
          <li class="normal" id="section-3.2-2.2">Privacy-preserving authentication for proprietary services. Tokens can attest that
the Client is a valid subscriber for a proprietary service, such as a deployment of
Oblivious HTTP <span>[<a class="cite xref" href="#RFC9458">OHTTP</a>]</span>.<a class="pilcrow" href="#section-3.2-2.2">¶</a>
</li>
        </ul>
</section>
</div>
<div id="privacy-and-trust">
<section id="section-3.3">
        <h3 id="name-privacy-goals-and-threat-mo">
<a class="section-number selfRef" href="#section-3.3">3.3. </a><a class="section-name selfRef" href="#name-privacy-goals-and-threat-mo">Privacy Goals and Threat Model</a>
        </h3>
<p id="section-3.3-1">The end-to-end flow for Privacy Pass described in <a class="auto internal xref" href="#overview">Section 3.1</a> involves three
different types of contexts:<a class="pilcrow" href="#section-3.3-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.3-2">
          <dt id="section-3.3-2.1">Redemption context:</dt>
          <dd id="section-3.3-2.2" style="margin-left: 1.5em">
            <p id="section-3.3-2.2.1">The interactions and set of information shared
between the Client and Origin, i.e., the information that is provided or
otherwise available to the Origin during redemption that might be used
to identify a Client and construct a token challenge. This context includes all
information associated with redemption, such as the timestamp of the event,
Client-visible information (including the IP address), and the Origin name.<a class="pilcrow" href="#section-3.3-2.2.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.3-2.3">Issuance context:</dt>
          <dd id="section-3.3-2.4" style="margin-left: 1.5em">
            <p id="section-3.3-2.4.1">The interactions and set of information shared between the Client, Attester,
and Issuer, i.e., the information that is provided or otherwise available
to the Attester and Issuer during issuance that might be used to identify a Client.
This context includes all information associated with issuance, such as the
timestamp of the event, any Client-visible information (including the IP
address), and the Origin name (if revealed during issuance). This does not
include the token challenge in its entirety, as that is kept secret from the
Issuer during the issuance protocol.<a class="pilcrow" href="#section-3.3-2.4.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.3-2.5">Attestation context:</dt>
          <dd id="section-3.3-2.6" style="margin-left: 1.5em">
            <p id="section-3.3-2.6.1">The interactions and set of information shared between
the Client and Attester only, for the purposes of attesting the validity of
the Client, that is provided or otherwise available during attestation that
might be used to identify the Client. This context includes all information
associated with attestation, such as the timestamp of the event and any
Client-visible information, including information needed for the attestation
procedure to complete.<a class="pilcrow" href="#section-3.3-2.6.1">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-3.3-3">The privacy goals of Privacy Pass assume a threat model in which Origins trust
specific Issuers to produce tokens, and Issuers in turn trust one or more
Attesters to correctly run the attestation procedure with Clients. This
arrangement ensures that tokens that validate for a given Issuer were only
issued to a Client that successfully completed attestation with an Attester
that the Issuer trusts. Moreover, this arrangement means that if an Origin
accepts tokens issued by an Issuer that trusts multiple Attesters, then a
Client can use any one of these Attesters to issue and redeem tokens for the
Origin. Whether or not these different entities in the architecture collude
for learning redemption, issuance, or attestation contexts, as well as the
necessary preconditions for context unlinkability, depends on the deployment
model; see <a class="auto internal xref" href="#deployment">Section 4</a> for more details.<a class="pilcrow" href="#section-3.3-3">¶</a></p>
<p id="section-3.3-4">The mechanisms for establishing trust between each entity in this arrangement
are deployment specific. For example, in settings where Clients interact with
Issuers through an Attester, Attesters and Issuers might use
mutually authenticated TLS to authenticate one another. In settings where
Clients do not communicate with Issuers through an Attester, the Attesters
might convey this trust via a digital signature that Issuers can verify.<a class="pilcrow" href="#section-3.3-4">¶</a></p>
<p id="section-3.3-5">Clients explicitly trust Attesters to perform attestation correctly and in a
way that does not violate their privacy. In particular, this means that Attesters
that may be privy to private information about Clients are trusted to not disclose
this information to non-colluding parties. Colluding parties are assumed to have
access to the same information; see <a class="auto internal xref" href="#deployment">Section 4</a> for more about different
deployment models and non-collusion assumptions. However, Clients assume that Issuers and
Origins are malicious.<a class="pilcrow" href="#section-3.3-5">¶</a></p>
<p id="section-3.3-6">Given this threat model, the privacy goals of Privacy Pass are oriented around
unlinkability based on redemption, issuance, and attestation contexts, as
described below.<a class="pilcrow" href="#section-3.3-6">¶</a></p>
<ol class="normal type-1" id="section-3.3-7" start="1" type="1">
<li id="section-3.3-7.1">Origin-Client unlinkability. This means that given two redemption contexts,
the Origin cannot determine if both redemption contexts correspond to the same
Client or two different Clients. Informally, this means that a Client in a
redemption context is indistinguishable from any other Client that might use
the same redemption context. The set of Clients that share the same redemption
context is referred to as a redemption anonymity set.<a class="pilcrow" href="#section-3.3-7.1">¶</a>
</li>
          <li id="section-3.3-7.2">Issuer-Client unlinkability. This is similar to Origin-Client unlinkability
in that a Client in an issuance context is indistinguishable from any other
Client that might use the same issuance context. The set of Clients that share
the same issuance context is referred to as an issuance anonymity set.<a class="pilcrow" href="#section-3.3-7.2">¶</a>
</li>
          <li id="section-3.3-7.3">Attester-Origin unlinkability. This is similar to Origin-Client and
Issuer-Client unlinkability. It means that given two attestation contexts,
the Attester cannot determine if both contexts correspond to the same Origin
or two different Origins. The set of Origins that share the same attestation
context is referred to as an attestation anonymity set.<a class="pilcrow" href="#section-3.3-7.3">¶</a>
</li>
          <li id="section-3.3-7.4">Redemption context unlinkability. Given two redemption contexts, the Origin
cannot determine which issuance and attestation contexts each redemption
corresponds to, even with the collaboration of the Issuer and Attester (should
these be different parties). This means that any information that may be learned
about the Client during the issuance and attestation flows cannot be used by the
Origin to compromise Client privacy.<a class="pilcrow" href="#section-3.3-7.4">¶</a>
</li>
        </ol>
<p id="section-3.3-8">These unlinkability properties ensure that only the Clients are able to correlate
information that might be used to identify them with activity on the Origin.
The Attester, Issuer, and Origin only receive the information necessary to perform
their respective functions.<a class="pilcrow" href="#section-3.3-8">¶</a></p>
<p id="section-3.3-9">The manner in which these unlinkability properties are achieved depends on the
deployment model, type of attestation, and issuance protocol details. For example,
as discussed in <a class="auto internal xref" href="#deployment">Section 4</a>, in some cases it is necessary to use an anonymization
service that hides Client IP addresses, such as Tor <span>[<a class="cite xref" href="#DMS2004">DMS2004</a>]</span>. In general,
anonymization services ensure that all Clients that use the service are indistinguishable
from one another, though in practice there may be small distinguishing features
(TLS fingerprints, HTTP headers, etc.). Moreover, Clients generally trust these services
to not disclose private Client information (such as IP addresses) to untrusted parties.
Failure to use an anonymization service when interacting with Attesters, Issuers, or
Origins can allow the set of possible Clients to be partitioned by the Client's IP address
and can therefore lead to unlinkability violations. Similarly, malicious Origins
may attempt to link two redemption contexts together by using Client-specific
Issuer Public Keys. See Sections <a class="auto internal xref" href="#deployment-considerations">5</a> and <a class="auto internal xref" href="#privacy">6</a> for more
information.<a class="pilcrow" href="#section-3.3-9">¶</a></p>
<p id="section-3.3-10">Sections <a class="auto internal xref" href="#redemption">3.4</a> and <a class="auto internal xref" href="#issuance-protocol">3.5</a> describe the functional properties and security
requirements of the redemption and issuance protocols in more detail. <a class="auto internal xref" href="#flow">Section 3.6</a>
describes how information flows between the Issuer, Origin, Client, and Attester
through these protocols.<a class="pilcrow" href="#section-3.3-10">¶</a></p>
</section>
</div>
<div id="redemption">
<section id="section-3.4">
        <h3 id="name-redemption-protocol">
<a class="section-number selfRef" href="#section-3.4">3.4. </a><a class="section-name selfRef" href="#name-redemption-protocol">Redemption Protocol</a>
        </h3>
<p id="section-3.4-1">The Privacy Pass redemption protocol, described in
<span>[<a class="cite xref" href="#RFC9577">AUTHSCHEME</a>]</span>, is an authorization protocol
wherein Clients present tokens to Origins for authorization. Normally,
redemption is preceded by a challenge, wherein the Origin challenges
Clients for a token with a TokenChallenge (<span>[<a class="cite xref" href="#RFC9577">AUTHSCHEME</a>], <a class="relref" href="https://rfc-editor.org/rfc/rfc9577#section-2.1">Section 2.1</a></span>) and,
if possible, Clients present a valid token (<span>[<a class="cite xref" href="#RFC9577">AUTHSCHEME</a>], <a class="relref" href="https://rfc-editor.org/rfc/rfc9577#section-2.2">Section 2.2</a></span>)
in reaction to the challenge. This interaction is shown below.<a class="pilcrow" href="#section-3.4-1">¶</a></p>
<span id="name-challenge-and-redemption-pr"></span><div id="fig-redemption">
<figure id="figure-2">
          <div id="section-3.4-2.1">
            <div class="alignLeft art-svg artwork" id="section-3.4-2.1.1">
<svg class="diagram" font-family="monospace" font-size="13px" stroke-linecap="round" text-anchor="middle" version="1.1" viewBox="0 0 432 176" xmlns="http://www.w3.org/2000/svg">
                <path d="M 8,32 L 8,64" fill="none" stroke="black"></path>
                <path d="M 40,64 L 40,160" fill="none" stroke="black"></path>
                <path d="M 80,32 L 80,64" fill="none" stroke="black"></path>
                <path d="M 184,32 L 184,64" fill="none" stroke="black"></path>
                <path d="M 216,64 L 216,160" fill="none" stroke="black"></path>
                <path d="M 256,32 L 256,64" fill="none" stroke="black"></path>
                <path d="M 8,32 L 80,32" fill="none" stroke="black"></path>
                <path d="M 184,32 L 256,32" fill="none" stroke="black"></path>
                <path d="M 8,64 L 80,64" fill="none" stroke="black"></path>
                <path d="M 184,64 L 256,64" fill="none" stroke="black"></path>
                <path d="M 48,96 L 88,96" fill="none" stroke="black"></path>
                <path d="M 168,96 L 216,96" fill="none" stroke="black"></path>
                <path d="M 40,112 L 56,112" fill="none" stroke="black"></path>
                <path d="M 192,112 L 208,112" fill="none" stroke="black"></path>
                <path d="M 232,126 L 248,126" fill="none" stroke="black"></path>
                <path d="M 232,130 L 248,130" fill="none" stroke="black"></path>
                <path d="M 408,126 L 424,126" fill="none" stroke="black"></path>
                <path d="M 408,130 L 424,130" fill="none" stroke="black"></path>
                <path d="M 48,144 L 64,144" fill="none" stroke="black"></path>
                <path d="M 192,144 L 216,144" fill="none" stroke="black"></path>
                <polygon class="arrowhead" fill="black" points="432,128 420,122.4 420,133.6" transform="rotate(0,424,128)"></polygon>
                <polygon class="arrowhead" fill="black" points="240,128 228,122.4 228,133.6" transform="rotate(180,232,128)"></polygon>
                <polygon class="arrowhead" fill="black" points="216,112 204,106.4 204,117.6" transform="rotate(0,208,112)"></polygon>
                <polygon class="arrowhead" fill="black" points="56,144 44,138.4 44,149.6" transform="rotate(180,48,144)"></polygon>
                <polygon class="arrowhead" fill="black" points="56,96 44,90.4 44,101.6" transform="rotate(180,48,96)"></polygon>
                <g class="text">
                  <text x="44" y="52">Origin</text>
                  <text x="220" y="52">Client</text>
                  <text x="128" y="100">Request</text>
                  <text x="124" y="116">TokenChallenge</text>
                  <text x="292" y="132">Issuance</text>
                  <text x="364" y="132">protocol</text>
                  <text x="128" y="148">Request+Token</text>
                </g>
              </svg><a class="pilcrow" href="#section-3.4-2.1.1">¶</a>
</div>
</div>
<figcaption><a class="selfRef" href="#figure-2">Figure 2</a>:
<a class="selfRef" href="#name-challenge-and-redemption-pr">Challenge and Redemption Protocol Interaction</a>
          </figcaption></figure>
</div>
<p id="section-3.4-3">Alternatively, when configured to do so, Clients may opportunistically present
token values to Origins without a corresponding TokenChallenge.<a class="pilcrow" href="#section-3.4-3">¶</a></p>
<p id="section-3.4-4">The structure and semantics of the TokenChallenge and token messages depend
on the issuance protocol and token type being used; see <span>[<a class="cite xref" href="#RFC9577">AUTHSCHEME</a>]</span> for
more information.<a class="pilcrow" href="#section-3.4-4">¶</a></p>
<p id="section-3.4-5">The challenge provides the Client with the information necessary to obtain
tokens that the server might subsequently accept in the redemption context.
There are a number of ways in which the token may vary based on this challenge,
including the following:<a class="pilcrow" href="#section-3.4-5">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.4-6.1">Issuance protocol. The challenge identifies the type of issuance protocol
required for producing the token. Different issuance protocols have different
security properties, e.g., some issuance protocols may produce tokens that
are publicly verifiable, whereas others may not have this property.<a class="pilcrow" href="#section-3.4-6.1">¶</a>
</li>
          <li class="normal" id="section-3.4-6.2">Issuer identity. Token challenges identify which Issuers are trusted for a
given issuance protocol. As described in <a class="auto internal xref" href="#privacy-and-trust">Section 3.3</a>, the choice
of Issuer determines the type of Attesters and attestation procedures possible
for a token from the specified Issuer, but the Origin does not learn exactly
which Attester was used for a given token issuance event.<a class="pilcrow" href="#section-3.4-6.2">¶</a>
</li>
          <li class="normal" id="section-3.4-6.3">Redemption context. Challenges can be bound to a given redemption context,
which influences a Client's ability to pre-fetch and cache tokens. For
example, an empty redemption context always allows tokens to be issued and
redeemed non-interactively, whereas a fresh and random redemption context
means that the redeemed token must be issued only after the Client receives
the challenge. See <span><a class="relref" href="https://rfc-editor.org/rfc/rfc9577#section-2.1.1">Section 2.1.1</a> of [<a class="cite xref" href="#RFC9577">AUTHSCHEME</a>]</span> for more details.<a class="pilcrow" href="#section-3.4-6.3">¶</a>
</li>
          <li class="normal" id="section-3.4-6.4">Per-Origin or cross-Origin. Challenges can be constrained to the Origin for
which the challenge originated (referred to as per-Origin tokens) or
can be used across multiple Origins (referred to as cross-Origin tokens).
The set of Origins for which a cross-Origin token is applicable is referred
to as the cross-Origin set. Opting into this set is done by explicitly agreeing
on the contents of the set. Every Origin in a cross-Origin set, by opting in,
agrees to admit tokens for any other Origin in the set. See
<span><a class="relref" href="https://rfc-editor.org/rfc/rfc9577#section-2.1.1">Section 2.1.1</a> of [<a class="cite xref" href="#RFC9577">AUTHSCHEME</a>]</span> for more information on how this set is created.<a class="pilcrow" href="#section-3.4-6.4">¶</a>
</li>
        </ul>
<p id="section-3.4-7">Origins that admit cross-Origin tokens bear some risk of allowing tokens
issued for one Origin to be spent in an interaction with another Origin.
In particular, cross-Origin tokens issued based on a challenge for
one Origin can be redeemed at another Origin in the cross-Origin set,
which can make it difficult to regulate token consumption. Depending on the
use case, Origins may need to maintain state to track redeemed tokens. For
example, Origins that accept cross-Origin tokens across shared redemption
contexts <span class="bcp14">SHOULD</span> track which tokens have already been redeemed in those
redemption contexts, since these tokens can be issued and then spent multiple
times for any such challenge. Note that Clients that redeem the
same token to multiple Origins do risk those Origins being able to link
Client activity together, which can disincentivize this behavior. See
<span><a class="relref" href="https://rfc-editor.org/rfc/rfc9577#section-2.1.1">Section 2.1.1</a> of [<a class="cite xref" href="#RFC9577">AUTHSCHEME</a>]</span> for discussion.<a class="pilcrow" href="#section-3.4-7">¶</a></p>
<p id="section-3.4-8">How Clients respond to token challenges can have privacy implications.
For example, if an Origin allows the Client to choose an Issuer, then the choice
of Issuer can reveal information about the Client used to partition anonymity
sets; see <a class="auto internal xref" href="#rotation-and-consistency">Section 6.2</a> for more information about these privacy
considerations.<a class="pilcrow" href="#section-3.4-8">¶</a></p>
</section>
</div>
<div id="issuance-protocol">
<section id="section-3.5">
        <h3 id="name-issuance-protocol">
<a class="section-number selfRef" href="#section-3.5">3.5. </a><a class="section-name selfRef" href="#name-issuance-protocol">Issuance Protocol</a>
        </h3>
<p id="section-3.5-1">The Privacy Pass issuance protocols, such as those described in <span>[<a class="cite xref" href="#RFC9578">ISSUANCE</a>]</span>, are two-message
protocols that take as input a TokenChallenge from the redemption protocol
(<span>[<a class="cite xref" href="#RFC9577">AUTHSCHEME</a>], <a class="relref" href="https://rfc-editor.org/rfc/rfc9577#section-2.1">Section 2.1</a></span>) and produce a token
(<span>[<a class="cite xref" href="#RFC9577">AUTHSCHEME</a>], <a class="relref" href="https://rfc-editor.org/rfc/rfc9577#section-2.2">Section 2.2</a></span>), as shown in <a class="auto internal xref" href="#fig-overview">Figure 1</a>.<a class="pilcrow" href="#section-3.5-1">¶</a></p>
<p id="section-3.5-2">The structure and semantics of the TokenRequest and TokenResponse messages
depend on the issuance protocol and token type being used; see <span>[<a class="cite xref" href="#RFC9578">ISSUANCE</a>]</span>
for more information.<a class="pilcrow" href="#section-3.5-2">¶</a></p>
<p id="section-3.5-3">Clients interact with the Attester and Issuer to produce a token for
a challenge. The context in which an Attester vouches for a Client during
issuance is referred to as the attestation context. This context includes all
information associated with the issuance event, such as the timestamp of the
event and Client-visible information, including the IP address or other
information specific to the type of attestation done.<a class="pilcrow" href="#section-3.5-3">¶</a></p>
<p id="section-3.5-4">Each issuance protocol may be different, e.g., in the number and types of
participants, underlying cryptographic constructions used when issuing tokens,
and even privacy properties.<a class="pilcrow" href="#section-3.5-4">¶</a></p>
<p id="section-3.5-5">Clients initiate the issuance protocol using the token challenge, a randomly
generated nonce, and a public key for the Issuer, all of which are the Client's
private input to the protocol and ultimately bound to an output token;
see <span><a class="relref" href="https://rfc-editor.org/rfc/rfc9577#section-2.2">Section 2.2</a> of [<a class="cite xref" href="#RFC9577">AUTHSCHEME</a>]</span> for details. Future specifications
may change or extend the Client's input to the issuance protocol to produce
tokens with a different structure.<a class="pilcrow" href="#section-3.5-5">¶</a></p>
<p id="section-3.5-6">Token properties vary based on the issuance protocol. Important properties
supported in this architecture are described below.<a class="pilcrow" href="#section-3.5-6">¶</a></p>
<ol class="normal type-1" id="section-3.5-7" start="1" type="1">
<li id="section-3.5-7.1">Public verifiability. This means that the token can be verified using the Issuer
Public Key. A token that does not have public verifiability can only be verified
using the Issuer secret key.<a class="pilcrow" href="#section-3.5-7.1">¶</a>
</li>
          <li id="section-3.5-7.2">Public metadata. This means that the token can be cryptographically bound to
arbitrary public information. See <a class="auto internal xref" href="#metadata-privacy">Section 6.1</a> for privacy considerations
regarding public metadata.<a class="pilcrow" href="#section-3.5-7.2">¶</a>
</li>
          <li id="section-3.5-7.3">Private metadata. This means that the token can be cryptographically bound to
arbitrary private information, i.e., information that the Client does not observe
during token issuance or redemption. See <a class="auto internal xref" href="#metadata-privacy">Section 6.1</a> for privacy
considerations regarding private metadata.<a class="pilcrow" href="#section-3.5-7.3">¶</a>
</li>
        </ol>
<p id="section-3.5-8">The issuance protocol itself can be any interactive protocol between the Client,
Issuer, or other parties that produces a valid token bound to the Client's
private input, subject to the following security requirements.<a class="pilcrow" href="#section-3.5-8">¶</a></p>
<ol class="normal type-1" id="section-3.5-9" start="1" type="1">
<li id="section-3.5-9.1">Unconditional input secrecy. The issuance protocol <span class="bcp14">MUST NOT</span> reveal anything
about the Client's private input, including the challenge and nonce, to the
Attester or Issuer, regardless of the hardness assumptions of the underlying
cryptographic protocol(s). This property is sometimes also referred to as
blindness.<a class="pilcrow" href="#section-3.5-9.1">¶</a>
</li>
          <li id="section-3.5-9.2">One-more forgery security. The issuance protocol <span class="bcp14">MUST NOT</span> allow malicious
Clients or Attesters (acting as Clients) to forge tokens offline or otherwise
without interacting with the Issuer directly.<a class="pilcrow" href="#section-3.5-9.2">¶</a>
</li>
          <li id="section-3.5-9.3">Concurrent security. The issuance protocol <span class="bcp14">MUST</span> be safe to run concurrently
with arbitrarily many Clients, Attesters, and Issuers.<a class="pilcrow" href="#section-3.5-9.3">¶</a>
</li>
        </ol>
<p id="section-3.5-10">See <a class="auto internal xref" href="#extensions">Section 3.5.4</a> for requirements on new issuance protocol variants and
related extensions.<a class="pilcrow" href="#section-3.5-10">¶</a></p>
<p id="section-3.5-11">In the sections below, we describe the Attester and Issuer roles in more
detail.<a class="pilcrow" href="#section-3.5-11">¶</a></p>
<div id="attester">
<section id="section-3.5.1">
          <h4 id="name-attester-role">
<a class="section-number selfRef" href="#section-3.5.1">3.5.1. </a><a class="section-name selfRef" href="#name-attester-role">Attester Role</a>
          </h4>
<p id="section-3.5.1-1">In Privacy Pass, attestation is the process by which an Attester bears
witness to, confirms, or authenticates a Client so as to verify properties
about the Client that are required for issuance. Issuers trust Attesters
to perform attestation correctly, i.e., to implement attestation procedures
in such a way that those procedures are not subverted or bypassed by malicious Clients.<a class="pilcrow" href="#section-3.5.1-1">¶</a></p>
<p id="section-3.5.1-2"><span>[<a class="cite xref" href="#RFC9334">RFC9334</a>]</span> describes an architecture for attestation procedures. Using
that architecture as a conceptual basis, Clients are RATS Attesters that
produce attestation evidence, and Attesters are RATS Verifiers that
appraise the validity of attestation evidence.<a class="pilcrow" href="#section-3.5.1-2">¶</a></p>
<p id="section-3.5.1-3">The type of attestation procedure is a deployment-specific option and outside
the scope of the issuance protocol. Example attestation procedures are below.<a class="pilcrow" href="#section-3.5.1-3">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5.1-4.1">Solving a CAPTCHA. Clients that solve CAPTCHA challenges can be attested to
have this capability for the purpose of being ruled out as a bot or otherwise
automated Client.<a class="pilcrow" href="#section-3.5.1-4.1">¶</a>
</li>
            <li class="normal" id="section-3.5.1-4.2">Presenting evidence of Client device validity. Some Clients run on trusted
hardware that is capable of producing device-level attestation evidence.<a class="pilcrow" href="#section-3.5.1-4.2">¶</a>
</li>
            <li class="normal" id="section-3.5.1-4.3">Proving properties about Client state. Clients can be associated with state,
and the Attester can verify this state. Examples of state include the
Client's geographic region and whether the Client has a valid
application-layer account.<a class="pilcrow" href="#section-3.5.1-4.3">¶</a>
</li>
          </ul>
<p id="section-3.5.1-5">Attesters may support different types of attestation procedures.<a class="pilcrow" href="#section-3.5.1-5">¶</a></p>
<p id="section-3.5.1-6">Each attestation procedure has different security properties. For
example, attesting to having a valid account is different from attesting to
running on trusted hardware. Supporting multiple attestation procedures is
an important step towards ensuring equitable access for Clients; see <a class="auto internal xref" href="#discrimination">Section 5.1</a>.<a class="pilcrow" href="#section-3.5.1-6">¶</a></p>
<p id="section-3.5.1-7">The role of the Attester in the issuance protocol and its impact on privacy
depend on the type of attestation procedure, issuance protocol, and deployment
model. For instance, increasing the number of required attestation procedures
could decrease the overall anonymity set size. As an example, the number of Clients
that have solved a CAPTCHA in the past day, that have a valid account, and that
are running on a trusted device is less than the number of Clients that have
solved a CAPTCHA in the past day. See <a class="auto internal xref" href="#rotation-and-consistency">Section 6.2</a> for more discussion
of how the variety of attestation procedures can negatively impact Client privacy.<a class="pilcrow" href="#section-3.5.1-7">¶</a></p>
<p id="section-3.5.1-8">Depending on the issuance protocol, the Issuer might learn
information about the Origin. To ensure Issuer-Client unlinkability, the Issuer
should be unable to link that information to a specific Client. For such
issuance protocols where the Attester has access to Client-specific
information, such as is the case for attestation procedures that involve
Client-specific information (such as application-layer account information)
or for deployment models where the Attester learns Client-specific information
(such as Client IP addresses), Clients trust the Attester to not share any
Client-specific information with the Issuer. In deployments where the Attester
does not learn Client-specific information or where the Attester and Issuer are
operated by the same entity (such as in the Joint Attester and Issuer model
described in <a class="auto internal xref" href="#deploy-joint-issuer">Section 4.2</a>), the Client does not need to explicitly
trust the Attester in this regard.<a class="pilcrow" href="#section-3.5.1-8">¶</a></p>
<p id="section-3.5.1-9">Issuers trust Attesters to correctly and reliably perform attestation. However,
certain types of attestation procedures can vary in value over time, e.g., if the
attestation procedure is compromised. Broken
attestation procedures are considered exceptional events and require
configuration changes to address the underlying cause. For example, if
an attestation procedure is compromised or subverted because of a zero-day
exploit on devices that implement the attestation procedure, then the
corresponding attestation procedure should be untrusted until the exploit is
patched. Addressing changes in attestation quality is therefore a
deployment-specific task. In Split Origin, Attester, and Issuer deployments (see
<a class="auto internal xref" href="#deploy-split">Section 4.4</a>), Issuers can choose to remove compromised Attesters from
their trusted set until the compromise is patched.<a class="pilcrow" href="#section-3.5.1-9">¶</a></p>
<p id="section-3.5.1-10">From the perspective of an Origin, tokens produced by an Issuer with at least
one compromised Attester cannot be trusted, assuming that the Origin does not know
which attestation procedure was used for issuance. This is because the Origin
cannot distinguish between tokens that were issued via compromised Attesters
and tokens that were issued via uncompromised Attesters, absent some
distinguishing information in the tokens themselves or from the Issuer. As a
result, until the attestation procedure is fixed, the Issuer cannot be trusted
by Origins. Moreover, as a consequence, any tokens issued by an Issuer with a
compromised Attester may no longer be trusted by Origins, even if those tokens
were issued to Clients interacting with an uncompromised Attester.<a class="pilcrow" href="#section-3.5.1-10">¶</a></p>
</section>
</div>
<div id="issuer-role">
<section id="section-3.5.2">
          <h4 id="name-issuer-role">
<a class="section-number selfRef" href="#section-3.5.2">3.5.2. </a><a class="section-name selfRef" href="#name-issuer-role">Issuer Role</a>
          </h4>
<p id="section-3.5.2-1">In Privacy Pass, the Issuer is responsible for completing the issuance protocol
for Clients that complete attestation through a trusted Attester. As described
in <a class="auto internal xref" href="#attester">Section 3.5.1</a>, Issuers explicitly trust Attesters to correctly and reliably
perform attestation. Origins explicitly trust Issuers to only issue tokens
from trusted Attesters. Clients do not explicitly trust Issuers.<a class="pilcrow" href="#section-3.5.2-1">¶</a></p>
<p id="section-3.5.2-2">Depending on the deployment model case, issuance may require some form of
Client anonymization service, similar to an IP-hiding proxy, so that Issuers
cannot learn information about Clients. This can be provided by an explicit
participant in the issuance protocol, or it can be provided via external means,
such as through the use of an IP-hiding proxy service like Tor <span>[<a class="cite xref" href="#DMS2004">DMS2004</a>]</span>.
In general, Clients <span class="bcp14">SHOULD</span> minimize or remove identifying
information where possible when invoking the issuance protocol.<a class="pilcrow" href="#section-3.5.2-2">¶</a></p>
<p id="section-3.5.2-3">Issuers are uniquely identifiable by all Clients with a consistent
identifier. In a web context, this identifier might be the Issuer hostname.
Issuers maintain one or more configurations, including issuance key pairs, for
use in the issuance protocol. Each configuration is assumed to have a unique
and canonical identifier, sometimes referred to as a key identifier or key ID.
Issuers can rotate these configurations as needed to mitigate the risk of compromise;
see <a class="auto internal xref" href="#rotation-and-consistency">Section 6.2</a> for more considerations around configuration
rotation. The Issuer Public Key for each active configuration is made available
to Origins and Clients for use in the issuance and redemption protocols.<a class="pilcrow" href="#section-3.5.2-3">¶</a></p>
</section>
</div>
<div id="metadata">
<section id="section-3.5.3">
          <h4 id="name-issuance-metadata">
<a class="section-number selfRef" href="#section-3.5.3">3.5.3. </a><a class="section-name selfRef" href="#name-issuance-metadata">Issuance Metadata</a>
          </h4>
<p id="section-3.5.3-1">Certain instantiations of the issuance protocol may permit public or private
metadata to be cryptographically bound to a token. As an example, one
trivial way to include public metadata is to assign a unique Issuer
Public Key for each value of metadata, such that N keys yield
log<sub>2</sub>(N) bits of metadata. Metadata may be public or private.<a class="pilcrow" href="#section-3.5.3-1">¶</a></p>
<p id="section-3.5.3-2">Public metadata is metadata that Clients can observe as part of the token
issuance flow. Public metadata can be either transparent or opaque. For
example, transparent public metadata is a value that either the Client
generates itself or the Issuer provides during the issuance flow and that the
Client can check for correctness. Opaque public metadata is metadata
the Client can see but cannot check for correctness. As an example, the
opaque public metadata might be a "fraud detection signal", computed on
behalf of the Issuer, during token issuance. Generally speaking, Clients
cannot determine if this value is generated in a way that permits tracking.<a class="pilcrow" href="#section-3.5.3-2">¶</a></p>
<p id="section-3.5.3-3">Private metadata is metadata that Clients cannot observe as part of the token
issuance flow. Such instantiations can be built on the private metadata bit
construction from Kreuter et al. <span>[<a class="cite xref" href="#KLOR20">KLOR20</a>]</span>
or the attribute-based Verifiable Oblivious Pseudorandom Function (VOPRF) from Huang et al. <span>[<a class="cite xref" href="#HIJK21">HIJK21</a>]</span>.<a class="pilcrow" href="#section-3.5.3-3">¶</a></p>
<p id="section-3.5.3-4">Metadata can be arbitrarily long or bounded in length. The amount of permitted
metadata may be determined by an application or by the underlying cryptographic
protocol. The total amount of metadata bits included in a token is the sum of
public and private metadata bits. Every bit of metadata can be used to
partition the Client issuance or redemption anonymity sets; see
<a class="auto internal xref" href="#metadata-privacy">Section 6.1</a> for more information.<a class="pilcrow" href="#section-3.5.3-4">¶</a></p>
</section>
</div>
<div id="extensions">
<section id="section-3.5.4">
          <h4 id="name-future-issuance-protocol-re">
<a class="section-number selfRef" href="#section-3.5.4">3.5.4. </a><a class="section-name selfRef" href="#name-future-issuance-protocol-re">Future Issuance Protocol Requirements</a>
          </h4>
<p id="section-3.5.4-1">The Privacy Pass architecture and ecosystem are both intended to be receptive
to extensions that expand the current set of functionalities through new
issuance protocols. Each new issuance protocol and extension <span class="bcp14">MUST</span> adhere
to the following requirements:<a class="pilcrow" href="#section-3.5.4-1">¶</a></p>
<ol class="normal type-1" id="section-3.5.4-2" start="1" type="1">
<li id="section-3.5.4-2.1">Include a detailed analysis of the privacy impacts of the extension, why
these impacts are justified, and guidelines on how to use the protocol
to mitigate or minimize negative deployment or privacy consequences
discussed in Sections <a class="auto internal xref" href="#deployment-considerations">5</a> and <a class="auto internal xref" href="#privacy">6</a>, respectively.<a class="pilcrow" href="#section-3.5.4-2.1">¶</a>
</li>
            <li id="section-3.5.4-2.2">Adhere to the guidelines specified in <a class="auto internal xref" href="#issuer-role">Section 3.5.2</a> for managing Issuer
Public Key data.<a class="pilcrow" href="#section-3.5.4-2.2">¶</a>
</li>
            <li id="section-3.5.4-2.3">Clearly specify how to interpret and validate TokenChallenge and token
messages that are exchanged during the redemption protocol.<a class="pilcrow" href="#section-3.5.4-2.3">¶</a>
</li>
          </ol>
</section>
</div>
</section>
</div>
<div id="flow">
<section id="section-3.6">
        <h3 id="name-information-flow">
<a class="section-number selfRef" href="#section-3.6">3.6. </a><a class="section-name selfRef" href="#name-information-flow">Information Flow</a>
        </h3>
<p id="section-3.6-1">The end-to-end process of redemption and issuance protocols involves information
flowing between the Issuer, Origin, Client, and Attester. That information can
have implications on the privacy goals that Privacy Pass aims to provide
as outlined in <a class="auto internal xref" href="#privacy-and-trust">Section 3.3</a>. In this section, we describe the flow
of information between each party. How this information affects the privacy
goals in particular deployment models is further discussed in <a class="auto internal xref" href="#deployment">Section 4</a>.<a class="pilcrow" href="#section-3.6-1">¶</a></p>
<div id="challenge-flow">
<section id="section-3.6.1">
          <h4 id="name-token-challenge-flow">
<a class="section-number selfRef" href="#section-3.6.1">3.6.1. </a><a class="section-name selfRef" href="#name-token-challenge-flow">Token Challenge Flow</a>
          </h4>
<p id="section-3.6.1-1">To use Privacy Pass, Origins choose an Issuer from which they are willing to
accept tokens. Origins then construct a token challenge using this specified
Issuer and information from the redemption context it shares with the Client.
This token challenge is then delivered to a Client. The token challenge conveys
information about the Issuer and the redemption context, such as whether the
Origin desires a per-Origin or cross-Origin token. Any entity that sees
the token challenge might learn things about the Client as known to the Origin.
This is why input secrecy is a requirement for issuance protocols, as it
ensures that the challenge is not directly available to the Issuer.<a class="pilcrow" href="#section-3.6.1-1">¶</a></p>
</section>
</div>
<div id="attestation-flow">
<section id="section-3.6.2">
          <h4 id="name-attestation-flow">
<a class="section-number selfRef" href="#section-3.6.2">3.6.2. </a><a class="section-name selfRef" href="#name-attestation-flow">Attestation Flow</a>
          </h4>
<p id="section-3.6.2-1">Clients interact with the Attester to prove that they meet some required
set of properties. In doing so, Clients contribute information to the
attestation context, which might include sensitive information such as
application-layer identities, IP addresses, and so on. Clients can choose
whether or not to contribute this information based on local policy or
preference.<a class="pilcrow" href="#section-3.6.2-1">¶</a></p>
</section>
</div>
<div id="issue-flow">
<section id="section-3.6.3">
          <h4 id="name-issuance-flow">
<a class="section-number selfRef" href="#section-3.6.3">3.6.3. </a><a class="section-name selfRef" href="#name-issuance-flow">Issuance Flow</a>
          </h4>
<p id="section-3.6.3-1">Clients use the issuance protocol to produce a token bound to a token
challenge. In doing so, there are several ways in which the issuance protocol
contributes information to the attestation or issuance contexts. For example, a
token request may contribute information to the attestation or issuance
contexts as described below.<a class="pilcrow" href="#section-3.6.3-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.6.3-2.1">Issuance protocol. The type of issuance protocol can contribute information
about the Issuer's capabilities to the attestation or issuance contexts, as
well as the capabilities of a given Client. For example, if a Client is
presented with multiple issuance protocol options, then the choice of which
issuance protocol to use can contribute information about the Client's
capabilities.<a class="pilcrow" href="#section-3.6.3-2.1">¶</a>
</li>
            <li class="normal" id="section-3.6.3-2.2">Issuer configuration. Information about the Issuer configuration, such as
its identity or the public key used to validate tokens it creates, can be
revealed during issuance and contribute to the attestation or issuance
contexts.<a class="pilcrow" href="#section-3.6.3-2.2">¶</a>
</li>
            <li class="normal" id="section-3.6.3-2.3">Attestation information. The issuance protocol can contribute information to
the attestation or issuance contexts based on what attestation procedure the
Issuer uses to trust a token request. In particular, a token request that is
validated by a given Attester means that the Client that generated the token
request must be capable of completing the designated attestation procedure.<a class="pilcrow" href="#section-3.6.3-2.3">¶</a>
</li>
            <li class="normal" id="section-3.6.3-2.4">Origin information. The issuance protocol can contribute information about
the Origin that challenged the Client; see <a class="auto internal xref" href="#challenge-flow">Section 3.6.1</a>. In particular,
a token request designated for a specific Issuer might imply that the resulting
token is for an Origin that trusts the specified Issuer. However, this is not
always true, as some token requests can correspond to cross-Origin tokens,
i.e., they are tokens that would be accepted at any Origin that accepts the
cross-Origin token.<a class="pilcrow" href="#section-3.6.3-2.4">¶</a>
</li>
          </ul>
<p id="section-3.6.3-3">Moreover, a token may contribute information to the issuance attestation or
contexts as described below.<a class="pilcrow" href="#section-3.6.3-3">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.6.3-4.1">Origin information. The issuance protocol can contribute information about
the Origin in how it responds to a token request. For example, if an Issuer
learns the Origin during issuance and is also configured to respond in some way
on the basis of that information, and the Client interacts with the Issuer
transitively through the Attester, that response can reveal information to the
Attester.<a class="pilcrow" href="#section-3.6.3-4.1">¶</a>
</li>
            <li class="normal" id="section-3.6.3-4.2">Token. The token produced by the issuance protocol can contain information
from the issuance context. In particular, depending on the issuance protocol,
tokens can contain public or private metadata, and Issuers can choose that
metadata on the basis of information in the issuance context.<a class="pilcrow" href="#section-3.6.3-4.2">¶</a>
</li>
          </ul>
<p id="section-3.6.3-5">Exceptional cases in the issuance protocol, such as when either the
Attester or Issuer aborts the protocol, can contribute information to the
attestation or issuance contexts. The extent to which information in this
context harms the Issuer-Client or Attester-Origin unlinkability goals as discussed in
<a class="auto internal xref" href="#privacy-and-trust">Section 3.3</a> depends on the deployment model; see <a class="auto internal xref" href="#deployment">Section 4</a>.
Clients can choose whether or not to contribute information to these contexts
based on local policy or preference.<a class="pilcrow" href="#section-3.6.3-5">¶</a></p>
</section>
</div>
<div id="redemption-flow">
<section id="section-3.6.4">
          <h4 id="name-token-redemption-flow">
<a class="section-number selfRef" href="#section-3.6.4">3.6.4. </a><a class="section-name selfRef" href="#name-token-redemption-flow">Token Redemption Flow</a>
          </h4>
<p id="section-3.6.4-1">Clients send tokens to Origins during the redemption protocol. Any information
that is added to the token during issuance can therefore be sent to the Origin.
Information can be either (1) explicitly passed in a token or (2) implicit
in the way the Client responds to a token challenge. For example, if a Client
fails to complete issuance and consequently fails to redeem a token for
a token challenge, this can reveal information to the Origin that
it might not otherwise have access to. However, an Origin cannot necessarily
distinguish between a Client that fails to complete issuance and one that
ignores the token challenge altogether.<a class="pilcrow" href="#section-3.6.4-1">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="deployment">
<section id="section-4">
      <h2 id="name-deployment-models">
<a class="section-number selfRef" href="#section-4">4. </a><a class="section-name selfRef" href="#name-deployment-models">Deployment Models</a>
      </h2>
<p id="section-4-1">The Origin, Attester, and Issuer portrayed in <a class="auto internal xref" href="#fig-overview">Figure 1</a> can be
instantiated and deployed in a number of ways. The deployment model directly
influences the manner in which attestation, issuance, and redemption contexts
are separated to achieve Origin-Client, Issuer-Client, and Attester-Origin
unlinkability.<a class="pilcrow" href="#section-4-1">¶</a></p>
<p id="section-4-2">This section covers some expected deployment models and their corresponding
security and privacy considerations. Each deployment model is described in
terms of the trust relationships and communication patterns between the Client,
Attester, Issuer, and Origin. Entities drawn within the same bounding box are
assumed to be operated by the same party and are therefore able to collude.
Collusion can enable linking of attestation, issuance, and redemption contexts.
Entities not drawn within the same bounding box (i.e., operated by separate parties) are assumed to not collude. Mechanisms for enforcing non-collusion are out of scope for this architecture.<a class="pilcrow" href="#section-4-2">¶</a></p>
<div id="deploy-shared">
<section id="section-4.1">
        <h3 id="name-shared-origin-attester-issu">
<a class="section-number selfRef" href="#section-4.1">4.1. </a><a class="section-name selfRef" href="#name-shared-origin-attester-issu">Shared Origin, Attester, Issuer</a>
        </h3>
<p id="section-4.1-1">In this model, the Origin, Attester, and Issuer are all operated by the same
entity, as shown in <a class="auto internal xref" href="#fig-deploy-shared">Figure 3</a>.<a class="pilcrow" href="#section-4.1-1">¶</a></p>
<span id="name-shared-deployment-model"></span><div id="fig-deploy-shared">
<figure id="figure-3">
          <div id="section-4.1-2.1">
            <div class="alignLeft art-svg artwork" id="section-4.1-2.1.1">
<svg class="diagram" font-family="monospace" font-size="13px" stroke-linecap="round" text-anchor="middle" version="1.1" viewBox="0 0 528 256" xmlns="http://www.w3.org/2000/svg">
                <path d="M 8,48 L 8,80" fill="none" stroke="black"></path>
                <path d="M 40,80 L 40,240" fill="none" stroke="black"></path>
                <path d="M 80,48 L 80,80" fill="none" stroke="black"></path>
                <path d="M 144,32 L 144,80" fill="none" stroke="black"></path>
                <path d="M 168,48 L 168,80" fill="none" stroke="black"></path>
                <path d="M 216,80 L 216,104" fill="none" stroke="black"></path>
                <path d="M 216,120 L 216,160" fill="none" stroke="black"></path>
                <path d="M 256,48 L 256,80" fill="none" stroke="black"></path>
                <path d="M 304,48 L 304,80" fill="none" stroke="black"></path>
                <path d="M 344,80 L 344,96" fill="none" stroke="black"></path>
                <path d="M 344,128 L 344,192" fill="none" stroke="black"></path>
                <path d="M 376,48 L 376,80" fill="none" stroke="black"></path>
                <path d="M 424,48 L 424,80" fill="none" stroke="black"></path>
                <path d="M 456,80 L 456,208" fill="none" stroke="black"></path>
                <path d="M 496,48 L 496,80" fill="none" stroke="black"></path>
                <path d="M 520,48 L 520,80" fill="none" stroke="black"></path>
                <path d="M 144,32 L 504,32" fill="none" stroke="black"></path>
                <path d="M 8,48 L 80,48" fill="none" stroke="black"></path>
                <path d="M 168,48 L 256,48" fill="none" stroke="black"></path>
                <path d="M 304,48 L 376,48" fill="none" stroke="black"></path>
                <path d="M 424,48 L 496,48" fill="none" stroke="black"></path>
                <path d="M 8,80 L 80,80" fill="none" stroke="black"></path>
                <path d="M 168,80 L 256,80" fill="none" stroke="black"></path>
                <path d="M 304,80 L 376,80" fill="none" stroke="black"></path>
                <path d="M 424,80 L 496,80" fill="none" stroke="black"></path>
                <path d="M 160,96 L 208,96" fill="none" stroke="black"></path>
                <path d="M 224,96 L 336,96" fill="none" stroke="black"></path>
                <path d="M 352,96 L 448,96" fill="none" stroke="black"></path>
                <path d="M 464,96 L 504,96" fill="none" stroke="black"></path>
                <path d="M 48,112 L 304,112" fill="none" stroke="black"></path>
                <path d="M 440,112 L 456,112" fill="none" stroke="black"></path>
                <path d="M 48,142 L 72,142" fill="none" stroke="black"></path>
                <path d="M 48,146 L 72,146" fill="none" stroke="black"></path>
                <path d="M 184,142 L 208,142" fill="none" stroke="black"></path>
                <path d="M 184,146 L 208,146" fill="none" stroke="black"></path>
                <path d="M 40,176 L 128,176" fill="none" stroke="black"></path>
                <path d="M 248,176 L 336,176" fill="none" stroke="black"></path>
                <path d="M 48,192 L 128,192" fill="none" stroke="black"></path>
                <path d="M 256,192 L 344,192" fill="none" stroke="black"></path>
                <path d="M 40,224 L 208,224" fill="none" stroke="black"></path>
                <path d="M 272,224 L 456,224" fill="none" stroke="black"></path>
                <path d="M 504,32 C 512.83064,32 520,39.16936 520,48" fill="none" stroke="black"></path>
                <path d="M 160,96 C 151.16936,96 144,88.83064 144,80" fill="none" stroke="black"></path>
                <path d="M 504,96 C 512.83064,96 520,88.83064 520,80" fill="none" stroke="black"></path>
                <polygon class="arrowhead" fill="black" points="464,224 452,218.4 452,229.6" transform="rotate(0,456,224)"></polygon>
                <polygon class="arrowhead" fill="black" points="344,176 332,170.4 332,181.6" transform="rotate(0,336,176)"></polygon>
                <polygon class="arrowhead" fill="black" points="216,144 204,138.4 204,149.6" transform="rotate(0,208,144)"></polygon>
                <polygon class="arrowhead" fill="black" points="56,192 44,186.4 44,197.6" transform="rotate(180,48,192)"></polygon>
                <polygon class="arrowhead" fill="black" points="56,144 44,138.4 44,149.6" transform="rotate(180,48,144)"></polygon>
                <polygon class="arrowhead" fill="black" points="56,112 44,106.4 44,117.6" transform="rotate(180,48,112)"></polygon>
                <g class="text">
                  <text x="44" y="68">Client</text>
                  <text x="212" y="68">Attester</text>
                  <text x="340" y="68">Issuer</text>
                  <text x="460" y="68">Origin</text>
                  <text x="372" y="116">TokenChallenge</text>
                  <text x="128" y="148">Attestation</text>
                  <text x="188" y="180">TokenRequest</text>
                  <text x="192" y="196">TokenResponse</text>
                  <text x="240" y="228">Token</text>
                  <text x="456" y="244">|</text>
                </g>
              </svg><a class="pilcrow" href="#section-4.1-2.1.1">¶</a>
</div>
</div>
<figcaption><a class="selfRef" href="#figure-3">Figure 3</a>:
<a class="selfRef" href="#name-shared-deployment-model">Shared Deployment Model</a>
          </figcaption></figure>
</div>
<p id="section-4.1-3">This model represents the initial deployment of Privacy Pass, as described in
<span>[<a class="cite xref" href="#PrivacyPassCloudflare">PrivacyPassCloudflare</a>]</span>. In this model, the Attester, Issuer, and Origin
share the attestation, issuance, and redemption contexts. As a result,
attestation mechanisms that can uniquely identify a Client, e.g., requiring
that Clients authenticate with some type of application-layer account, are
not appropriate, as they could lead to unlinkability violations.<a class="pilcrow" href="#section-4.1-3">¶</a></p>
<p id="section-4.1-4">Origin-Client, Issuer-Client, and Attester-Origin unlinkability requires that
issuance and redemption events be separated over time, such as through the use
of tokens that correspond to token challenges with an empty redemption context
(see <a class="auto internal xref" href="#redemption">Section 3.4</a>), or that they be separated over space, such as through the use of an
anonymizing service when connecting to the Origin.<a class="pilcrow" href="#section-4.1-4">¶</a></p>
</section>
</div>
<div id="deploy-joint-issuer">
<section id="section-4.2">
        <h3 id="name-joint-attester-and-issuer">
<a class="section-number selfRef" href="#section-4.2">4.2. </a><a class="section-name selfRef" href="#name-joint-attester-and-issuer">Joint Attester and Issuer</a>
        </h3>
<p id="section-4.2-1">In this model, the Attester and Issuer are operated by the same entity,
separate from the Origin. The Origin trusts the joint Attester
and Issuer to perform attestation and issue tokens. Clients interact
with the joint Attester and Issuer for attestation and issuance. This
arrangement is shown in <a class="auto internal xref" href="#fig-deploy-joint-issuer">Figure 4</a>.<a class="pilcrow" href="#section-4.2-1">¶</a></p>
<span id="name-joint-attester-and-issuer-d"></span><div id="fig-deploy-joint-issuer">
<figure id="figure-4">
          <div id="section-4.2-2.1">
            <div class="alignLeft art-svg artwork" id="section-4.2-2.1.1">
<svg class="diagram" font-family="monospace" font-size="13px" stroke-linecap="round" text-anchor="middle" version="1.1" viewBox="0 0 520 256" xmlns="http://www.w3.org/2000/svg">
                <path d="M 8,48 L 8,80" fill="none" stroke="black"></path>
                <path d="M 40,80 L 40,240" fill="none" stroke="black"></path>
                <path d="M 80,48 L 80,80" fill="none" stroke="black"></path>
                <path d="M 160,32 L 160,80" fill="none" stroke="black"></path>
                <path d="M 184,48 L 184,80" fill="none" stroke="black"></path>
                <path d="M 232,80 L 232,104" fill="none" stroke="black"></path>
                <path d="M 232,120 L 232,160" fill="none" stroke="black"></path>
                <path d="M 272,48 L 272,80" fill="none" stroke="black"></path>
                <path d="M 320,48 L 320,80" fill="none" stroke="black"></path>
                <path d="M 360,80 L 360,96" fill="none" stroke="black"></path>
                <path d="M 360,128 L 360,192" fill="none" stroke="black"></path>
                <path d="M 392,48 L 392,80" fill="none" stroke="black"></path>
                <path d="M 416,48 L 416,80" fill="none" stroke="black"></path>
                <path d="M 440,48 L 440,80" fill="none" stroke="black"></path>
                <path d="M 472,80 L 472,208" fill="none" stroke="black"></path>
                <path d="M 512,48 L 512,80" fill="none" stroke="black"></path>
                <path d="M 160,32 L 400,32" fill="none" stroke="black"></path>
                <path d="M 8,48 L 80,48" fill="none" stroke="black"></path>
                <path d="M 184,48 L 272,48" fill="none" stroke="black"></path>
                <path d="M 320,48 L 392,48" fill="none" stroke="black"></path>
                <path d="M 440,48 L 512,48" fill="none" stroke="black"></path>
                <path d="M 8,80 L 80,80" fill="none" stroke="black"></path>
                <path d="M 184,80 L 272,80" fill="none" stroke="black"></path>
                <path d="M 320,80 L 392,80" fill="none" stroke="black"></path>
                <path d="M 440,80 L 512,80" fill="none" stroke="black"></path>
                <path d="M 176,96 L 224,96" fill="none" stroke="black"></path>
                <path d="M 240,96 L 352,96" fill="none" stroke="black"></path>
                <path d="M 368,96 L 400,96" fill="none" stroke="black"></path>
                <path d="M 48,112 L 320,112" fill="none" stroke="black"></path>
                <path d="M 456,112 L 472,112" fill="none" stroke="black"></path>
                <path d="M 48,142 L 80,142" fill="none" stroke="black"></path>
                <path d="M 48,146 L 80,146" fill="none" stroke="black"></path>
                <path d="M 192,142 L 224,142" fill="none" stroke="black"></path>
                <path d="M 192,146 L 224,146" fill="none" stroke="black"></path>
                <path d="M 40,176 L 144,176" fill="none" stroke="black"></path>
                <path d="M 264,176 L 352,176" fill="none" stroke="black"></path>
                <path d="M 48,192 L 136,192" fill="none" stroke="black"></path>
                <path d="M 264,192 L 360,192" fill="none" stroke="black"></path>
                <path d="M 40,224 L 224,224" fill="none" stroke="black"></path>
                <path d="M 288,224 L 472,224" fill="none" stroke="black"></path>
                <path d="M 400,32 C 408.83064,32 416,39.16936 416,48" fill="none" stroke="black"></path>
                <path d="M 176,96 C 167.16936,96 160,88.83064 160,80" fill="none" stroke="black"></path>
                <path d="M 400,96 C 408.83064,96 416,88.83064 416,80" fill="none" stroke="black"></path>
                <polygon class="arrowhead" fill="black" points="480,224 468,218.4 468,229.6" transform="rotate(0,472,224)"></polygon>
                <polygon class="arrowhead" fill="black" points="360,176 348,170.4 348,181.6" transform="rotate(0,352,176)"></polygon>
                <polygon class="arrowhead" fill="black" points="232,144 220,138.4 220,149.6" transform="rotate(0,224,144)"></polygon>
                <polygon class="arrowhead" fill="black" points="56,192 44,186.4 44,197.6" transform="rotate(180,48,192)"></polygon>
                <polygon class="arrowhead" fill="black" points="56,144 44,138.4 44,149.6" transform="rotate(180,48,144)"></polygon>
                <polygon class="arrowhead" fill="black" points="56,112 44,106.4 44,117.6" transform="rotate(180,48,112)"></polygon>
                <g class="text">
                  <text x="44" y="68">Client</text>
                  <text x="228" y="68">Attester</text>
                  <text x="356" y="68">Issuer</text>
                  <text x="476" y="68">Origin</text>
                  <text x="388" y="116">TokenChallenge</text>
                  <text x="136" y="148">Attestation</text>
                  <text x="204" y="180">TokenRequest</text>
                  <text x="200" y="196">TokenResponse</text>
                  <text x="256" y="228">Token</text>
                  <text x="472" y="244">|</text>
                </g>
              </svg><a class="pilcrow" href="#section-4.2-2.1.1">¶</a>
</div>
</div>
<figcaption><a class="selfRef" href="#figure-4">Figure 4</a>:
<a class="selfRef" href="#name-joint-attester-and-issuer-d">Joint Attester and Issuer Deployment Model</a>
          </figcaption></figure>
</div>
<p id="section-4.2-3">This model is useful if an Origin wants to offload attestation and issuance to
a trusted entity. In this model, the Attester and Issuer share an attestation
and issuance context for the Client, separate from the Origin's
redemption context.<a class="pilcrow" href="#section-4.2-3">¶</a></p>
<p id="section-4.2-4">Similar to the shared Origin, Attester, Issuer model, Issuer-Client and
Origin-Client unlinkability in this model requires that issuance and redemption
events, respectively, be separated over time or space. Attester-Origin
unlinkability requires that the Attester and Issuer do not learn the Origin
for a particular token request. For this reason, issuance protocols that
require the Issuer to learn information about the Origin, such as the issuance protocol described in <span>[<a class="cite xref" href="#I-D.ietf-privacypass-rate-limit-tokens">RATE-LIMITED</a>]</span>, are not
appropriate, since they could lead to Attester-Origin unlinkability violations
through the Origin name.<a class="pilcrow" href="#section-4.2-4">¶</a></p>
</section>
</div>
<div id="deploy-joint-origin">
<section id="section-4.3">
        <h3 id="name-joint-origin-and-issuer">
<a class="section-number selfRef" href="#section-4.3">4.3. </a><a class="section-name selfRef" href="#name-joint-origin-and-issuer">Joint Origin and Issuer</a>
        </h3>
<p id="section-4.3-1">In this model, the Origin and Issuer are operated by the same entity, separate
from the Attester, as shown in <a class="auto internal xref" href="#fig-deploy-joint-origin">Figure 5</a>. The Issuer accepts token
requests that come from trusted Attesters. Since the Attester and Issuer are
separate entities, this model requires some mechanism by which Issuers
establish trust in the Attester (as described in <a class="auto internal xref" href="#privacy-and-trust">Section 3.3</a>).
For example, in settings where the Attester is a Client-trusted service that
directly communicates with the Issuer, one way to establish this trust is via
mutually authenticated TLS. However, alternative authentication mechanisms are
possible. In this model, the Origin and Issuer are operated by the same entity, separate from the Attester, as shown in the figure below.<a class="pilcrow" href="#section-4.3-1">¶</a></p>
<span id="name-joint-origin-and-issuer-dep"></span><div id="fig-deploy-joint-origin">
<figure id="figure-5">
          <div id="section-4.3-2.1">
            <div class="alignLeft art-svg artwork" id="section-4.3-2.1.1">
<svg class="diagram" font-family="monospace" font-size="13px" stroke-linecap="round" text-anchor="middle" version="1.1" viewBox="0 0 528 256" xmlns="http://www.w3.org/2000/svg">
                <path d="M 8,48 L 8,80" fill="none" stroke="black"></path>
                <path d="M 40,80 L 40,240" fill="none" stroke="black"></path>
                <path d="M 80,48 L 80,80" fill="none" stroke="black"></path>
                <path d="M 168,48 L 168,80" fill="none" stroke="black"></path>
                <path d="M 216,80 L 216,104" fill="none" stroke="black"></path>
                <path d="M 216,120 L 216,160" fill="none" stroke="black"></path>
                <path d="M 256,48 L 256,80" fill="none" stroke="black"></path>
                <path d="M 280,32 L 280,80" fill="none" stroke="black"></path>
                <path d="M 304,48 L 304,80" fill="none" stroke="black"></path>
                <path d="M 344,80 L 344,96" fill="none" stroke="black"></path>
                <path d="M 344,128 L 344,192" fill="none" stroke="black"></path>
                <path d="M 376,48 L 376,80" fill="none" stroke="black"></path>
                <path d="M 424,48 L 424,80" fill="none" stroke="black"></path>
                <path d="M 456,80 L 456,208" fill="none" stroke="black"></path>
                <path d="M 496,48 L 496,80" fill="none" stroke="black"></path>
                <path d="M 520,48 L 520,80" fill="none" stroke="black"></path>
                <path d="M 280,32 L 504,32" fill="none" stroke="black"></path>
                <path d="M 8,48 L 80,48" fill="none" stroke="black"></path>
                <path d="M 168,48 L 256,48" fill="none" stroke="black"></path>
                <path d="M 304,48 L 376,48" fill="none" stroke="black"></path>
                <path d="M 424,48 L 496,48" fill="none" stroke="black"></path>
                <path d="M 8,80 L 80,80" fill="none" stroke="black"></path>
                <path d="M 168,80 L 256,80" fill="none" stroke="black"></path>
                <path d="M 304,80 L 376,80" fill="none" stroke="black"></path>
                <path d="M 424,80 L 496,80" fill="none" stroke="black"></path>
                <path d="M 296,96 L 336,96" fill="none" stroke="black"></path>
                <path d="M 352,96 L 448,96" fill="none" stroke="black"></path>
                <path d="M 464,96 L 504,96" fill="none" stroke="black"></path>
                <path d="M 48,112 L 304,112" fill="none" stroke="black"></path>
                <path d="M 440,112 L 456,112" fill="none" stroke="black"></path>
                <path d="M 48,142 L 72,142" fill="none" stroke="black"></path>
                <path d="M 48,146 L 72,146" fill="none" stroke="black"></path>
                <path d="M 184,142 L 208,142" fill="none" stroke="black"></path>
                <path d="M 184,146 L 208,146" fill="none" stroke="black"></path>
                <path d="M 40,176 L 136,176" fill="none" stroke="black"></path>
                <path d="M 256,176 L 336,176" fill="none" stroke="black"></path>
                <path d="M 48,192 L 128,192" fill="none" stroke="black"></path>
                <path d="M 256,192 L 344,192" fill="none" stroke="black"></path>
                <path d="M 40,224 L 208,224" fill="none" stroke="black"></path>
                <path d="M 272,224 L 456,224" fill="none" stroke="black"></path>
                <path d="M 504,32 C 512.83064,32 520,39.16936 520,48" fill="none" stroke="black"></path>
                <path d="M 296,96 C 287.16936,96 280,88.83064 280,80" fill="none" stroke="black"></path>
                <path d="M 504,96 C 512.83064,96 520,88.83064 520,80" fill="none" stroke="black"></path>
                <polygon class="arrowhead" fill="black" points="464,224 452,218.4 452,229.6" transform="rotate(0,456,224)"></polygon>
                <polygon class="arrowhead" fill="black" points="344,176 332,170.4 332,181.6" transform="rotate(0,336,176)"></polygon>
                <polygon class="arrowhead" fill="black" points="216,144 204,138.4 204,149.6" transform="rotate(0,208,144)"></polygon>
                <polygon class="arrowhead" fill="black" points="56,192 44,186.4 44,197.6" transform="rotate(180,48,192)"></polygon>
                <polygon class="arrowhead" fill="black" points="56,144 44,138.4 44,149.6" transform="rotate(180,48,144)"></polygon>
                <polygon class="arrowhead" fill="black" points="56,112 44,106.4 44,117.6" transform="rotate(180,48,112)"></polygon>
                <g class="text">
                  <text x="44" y="68">Client</text>
                  <text x="212" y="68">Attester</text>
                  <text x="340" y="68">Issuer</text>
                  <text x="460" y="68">Origin</text>
                  <text x="372" y="116">TokenChallenge</text>
                  <text x="128" y="148">Attestation</text>
                  <text x="196" y="180">TokenRequest</text>
                  <text x="192" y="196">TokenResponse</text>
                  <text x="240" y="228">Token</text>
                  <text x="456" y="244">|</text>
                </g>
              </svg><a class="pilcrow" href="#section-4.3-2.1.1">¶</a>
</div>
</div>
<figcaption><a class="selfRef" href="#figure-5">Figure 5</a>:
<a class="selfRef" href="#name-joint-origin-and-issuer-dep">Joint Origin and Issuer Deployment Model</a>
          </figcaption></figure>
</div>
<p id="section-4.3-3">This model is useful for Origins that require Client-identifying attestation,
e.g., through the use of application-layer account information, but do not
otherwise want to learn information about individual Clients beyond what is
observed during the token redemption, such as Client IP addresses.<a class="pilcrow" href="#section-4.3-3">¶</a></p>
<p id="section-4.3-4">In this model, attestation contexts are separate from Issuer and redemption
contexts. As a result, any type of attestation is suitable in this model.<a class="pilcrow" href="#section-4.3-4">¶</a></p>
<p id="section-4.3-5">Moreover, assuming that there is more than one Origin involved, any type of token challenge is suitable, since no single party will have access to the identifying
Client information and unique Origin information. Issuers that produce tokens
for a single Origin are not suitable in this model, since an Attester can
infer the Origin from a token request, as described in <a class="auto internal xref" href="#issue-flow">Section 3.6.3</a>. However,
since the issuance protocol provides input secrecy, the Attester does not learn
details about the corresponding token challenge, such as whether the token
challenge is per Origin or across Origins.<a class="pilcrow" href="#section-4.3-5">¶</a></p>
</section>
</div>
<div id="deploy-split">
<section id="section-4.4">
        <h3 id="name-split-origin-attester-issue">
<a class="section-number selfRef" href="#section-4.4">4.4. </a><a class="section-name selfRef" href="#name-split-origin-attester-issue">Split Origin, Attester, Issuer</a>
        </h3>
<p id="section-4.4-1">In this model, the Origin, Attester, and Issuer are all operated by different
entities. As with the Joint Origin and Issuer model (<a class="auto internal xref" href="#deploy-joint-origin">Section 4.3</a>), the Issuer accepts token
requests that come from trusted Attesters, and the details of that trust
establishment depend on the issuance protocol and relationship between the
Attester and Issuer; see <a class="auto internal xref" href="#privacy-and-trust">Section 3.3</a>. This arrangement is shown
in <a class="auto internal xref" href="#fig-overview">Figure 1</a>.<a class="pilcrow" href="#section-4.4-1">¶</a></p>
<p id="section-4.4-2">This is the most general deployment model and is necessary for some
types of issuance protocols where the Attester plays a role in token
issuance; see <span>[<a class="cite xref" href="#I-D.ietf-privacypass-rate-limit-tokens">RATE-LIMITED</a>]</span> for one such type of issuance protocol.<a class="pilcrow" href="#section-4.4-2">¶</a></p>
<p id="section-4.4-3">In this model, the Attester, Issuer, and Origin have a separate view
of the Client: the Attester sees potentially sensitive Client-identifying
information, such as account identifiers or IP addresses; the Issuer
sees only the information necessary for issuance; and the Origin sees
token challenges, corresponding tokens, and Client source information,
such as their IP address. As a result, attestation, issuance, and redemption
contexts are separate, and therefore any type of token challenge is suitable in
this model as long as there is more than a single Origin.<a class="pilcrow" href="#section-4.4-3">¶</a></p>
<p id="section-4.4-4">As with the Joint Origin and Issuer model (<a class="auto internal xref" href="#deploy-joint-origin">Section 4.3</a>), and as
described in <a class="auto internal xref" href="#issue-flow">Section 3.6.3</a>, if the Issuer produces tokens for a single Origin,
then per-Origin tokens are not appropriate, since the Attester can infer the
Origin from a token request.<a class="pilcrow" href="#section-4.4-4">¶</a></p>
</section>
</div>
</section>
</div>
<div id="deployment-considerations">
<section id="section-5">
      <h2 id="name-deployment-considerations">
<a class="section-number selfRef" href="#section-5">5. </a><a class="section-name selfRef" href="#name-deployment-considerations">Deployment Considerations</a>
      </h2>
<p id="section-5-1"><a class="auto internal xref" href="#deployment">Section 4</a> discusses deployment models that are possible in practice.
Beyond possible implications on security and privacy properties of the
resulting system, Privacy Pass deployments can impact the overall ecosystem
in two important ways: (1) discriminatory treatment of Clients and the gated
access to otherwise open services and (2) centralization. This section
describes considerations relevant to these topics.<a class="pilcrow" href="#section-5-1">¶</a></p>
<div id="discrimination">
<section id="section-5.1">
        <h3 id="name-discriminatory-treatment">
<a class="section-number selfRef" href="#section-5.1">5.1. </a><a class="section-name selfRef" href="#name-discriminatory-treatment">Discriminatory Treatment</a>
        </h3>
<p id="section-5.1-1">Origins can use tokens as a signal for distinguishing between (1) Clients
that are capable of completing attestation with one Attester trusted by the
Origin's chosen Issuer and (2) Clients that are not capable of doing the same. A
consequence of this is that Privacy Pass could enable discriminatory treatment
of Clients based on attestation support. For example, an Origin could only
authorize Clients that successfully authenticate with a token, prohibiting access
to all other Clients.<a class="pilcrow" href="#section-5.1-1">¶</a></p>
<p id="section-5.1-2">The types of attestation procedures supported for a particular deployment depend
greatly on the use case. For example, consider a proprietary deployment of Privacy Pass
that authorizes Clients to access a resource such as an anonymization service. In this
context, it is reasonable to support specific types of attestation procedures that
demonstrate that Clients can access the resource, such as with an account or specific
type of device. However, in open deployments of Privacy Pass that are used to
safeguard access to otherwise open or publicly accessible resources, diversity
in attestation procedures is critically important so as to not discriminate against
Clients that choose certain software, hardware, or identity providers.<a class="pilcrow" href="#section-5.1-2">¶</a></p>
<p id="section-5.1-3">In principle, Issuers should strive to mitigate discriminatory behavior by
providing equitable access to all Clients. This can be done by working with a
set of Attesters that are suitable for all Clients. In practice, this may require
trade-offs in what type of attestation Issuers are willing to trust so as to
enable more widespread support. In other words, trusting a variety of Attesters
with a diverse set of attestation procedures would presumably increase support
among Clients, though most likely at the expense of decreasing the overall value
of tokens issued by the Issuer.<a class="pilcrow" href="#section-5.1-3">¶</a></p>
<p id="section-5.1-4">For example, to disallow discriminatory behavior between Clients with and
without device attestation support, an Issuer may wish to support Attesters
that support CAPTCHA-based attestation. This means that the overall attestation
value of a Privacy Pass token is bound by the difficulty in spoofing or
bypassing either one of these attestation procedures.<a class="pilcrow" href="#section-5.1-4">¶</a></p>
</section>
</div>
<div id="centralization">
<section id="section-5.2">
        <h3 id="name-centralization">
<a class="section-number selfRef" href="#section-5.2">5.2. </a><a class="section-name selfRef" href="#name-centralization">Centralization</a>
        </h3>
<p id="section-5.2-1">A consequence of limiting the number of participants (Attesters or Issuers) in
Privacy Pass deployments for meaningful privacy is that it forces concentrated
centralization among those participants.
<span>[<a class="cite xref" href="#RFC9518">CENTRALIZATION</a>]</span> discusses
several ways in which this might be mitigated. For example, a multi-stakeholder
governance model could be established to determine what candidate participants
are fit to operate as participants in a Privacy Pass deployment. This is
precisely the system used to control the Web's trust model.<a class="pilcrow" href="#section-5.2-1">¶</a></p>
<p id="section-5.2-2">Alternatively, Privacy Pass deployments might mitigate this problem through
implementation. For example, rather than centralize the role of attestation
in one or a few entities, attestation could be a distributed function performed
by a quorum of many parties, provided that neither Issuers nor Origins learn
which Attester implementations were chosen. As a result, Clients could have
more opportunities to switch between attestation participants.<a class="pilcrow" href="#section-5.2-2">¶</a></p>
</section>
</div>
</section>
</div>
<div id="privacy">
<section id="section-6">
      <h2 id="name-privacy-considerations">
<a class="section-number selfRef" href="#section-6">6. </a><a class="section-name selfRef" href="#name-privacy-considerations">Privacy Considerations</a>
      </h2>
<p id="section-6-1">The previous section discusses the impact of deployment details on
Origin-Client, Issuer-Client, and Attester-Origin unlinkability.
The value these properties afford to end users depends on
the size of anonymity sets in which Clients or Origins are
unlinkable. For example, consider two different deployments, one wherein
there exists a redemption anonymity set of size two and another
wherein there exists a redemption anonymity set of size 2<sup>32</sup>. Although
Origin-Client unlinkability guarantees that the Origin cannot link any two
requests to the same Client based on these contexts, respectively, the
smaller these sets become, the higher the probability of determining the "true" Client.<a class="pilcrow" href="#section-6-1">¶</a></p>
<p id="section-6-2">In practice, there are a number of ways in which the size of anonymity sets
may be reduced or partitioned, though they all center around the concept of
consistency. In particular, by definition, all Clients in an anonymity set
share a consistent view of information needed to run the issuance and
redemption protocols. The Issuer Public Key is an example of the type of information needed to run these protocols. When two Clients have inconsistent
information, these Clients effectively have different redemption contexts and
therefore belong in different anonymity sets.<a class="pilcrow" href="#section-6-2">¶</a></p>
<p id="section-6-3">The following subsections discuss issues that can influence anonymity set size.
For each issue, we discuss mitigations or safeguards to protect against the
underlying problem.<a class="pilcrow" href="#section-6-3">¶</a></p>
<div id="metadata-privacy">
<section id="section-6.1">
        <h3 id="name-partitioning-by-issuance-me">
<a class="section-number selfRef" href="#section-6.1">6.1. </a><a class="section-name selfRef" href="#name-partitioning-by-issuance-me">Partitioning by Issuance Metadata</a>
        </h3>
<p id="section-6.1-1">Any public or private metadata bits of information can be used to further
segment the size of the Client anonymity set. Any Issuer that wanted to
track a single Client could add a single metadata bit to Client tokens. For
the tracked Client, it would set the bit to <code>1</code>, and <code>0</code> otherwise. Adding
additional bits provides an exponential increase in tracking granularity
in a manner similar to introducing more Issuers (though with more potential targeting).<a class="pilcrow" href="#section-6.1-1">¶</a></p>
<p id="section-6.1-2">For this reason, deployments should take the amount of metadata used by an Issuer
in creating tokens, together with the bits of information that Issuers may learn about Clients through other means, into account. Since this
metadata may be useful for practical deployments of Privacy Pass, Issuers
must balance this against the reduction in Client privacy.<a class="pilcrow" href="#section-6.1-2">¶</a></p>
<p id="section-6.1-3">The number of permitted metadata values often depends on deployment-specific
details. In general, limiting the amount of metadata permitted helps limit the
extent to which metadata can uniquely identify individual Clients. Failure to
bound the number of possible metadata values can therefore lead to a reduction in
Client privacy. Most token types do not admit any metadata, so this bound is
implicitly enforced.<a class="pilcrow" href="#section-6.1-3">¶</a></p>
</section>
</div>
<div id="rotation-and-consistency">
<section id="section-6.2">
        <h3 id="name-partitioning-by-issuance-co">
<a class="section-number selfRef" href="#section-6.2">6.2. </a><a class="section-name selfRef" href="#name-partitioning-by-issuance-co">Partitioning by Issuance Consistency</a>
        </h3>
<p id="section-6.2-1">Anonymity sets can be partitioned by information used for the issuance
protocol, including metadata, Issuer configuration (keys), and Issuer
selection.<a class="pilcrow" href="#section-6.2-1">¶</a></p>
<p id="section-6.2-2">Any issuance metadata bits of information can be used to partition the Client
anonymity set. For example, any Issuer that wanted to track a single Client
could add a single metadata bit to Client tokens. For the tracked Client, it
would set the bit to <code>1</code>, and <code>0</code> otherwise. Adding additional bits provides an
exponential increase in tracking granularity in a manner similar to introducing more
Issuers (though with more potential targeting).<a class="pilcrow" href="#section-6.2-2">¶</a></p>
<p id="section-6.2-3">The number of active Issuer configurations also contributes to anonymity set
partitioning. In particular, when an Issuer updates their configuration and
the corresponding key pair, any Client that invokes the issuance protocol with
this configuration becomes part of a set of Clients that also ran the
issuance protocol using the same configuration. Issuer configuration updates,
e.g., due to key rotation, are an important part of hedging against long-term
private key compromise. In general, key rotations represent a trade-off between
Client privacy and Issuer security. Therefore, it is important that key
rotations occur on a regular cycle to reduce the harm of an Issuer key
compromise.<a class="pilcrow" href="#section-6.2-3">¶</a></p>
<p id="section-6.2-4">Lastly, if Clients are willing to issue and redeem tokens from a large number
of Issuers for a specific Origin and that Origin accepts tokens from all
Issuers, partitioning can occur. As an example, if a Client obtains tokens from
many Issuers and an Origin later challenges that Client for a token from each
Issuer, the Origin can learn information about the Client. This arrangement
might happen if Clients request tokens from different Issuers, each of which
has different Attester preferences. Each per-Issuer token that a Client holds
essentially corresponds to a bit of information about the Client that the Origin
learns. Therefore, there is an exponential loss in privacy relative to the
number of Issuers.<a class="pilcrow" href="#section-6.2-4">¶</a></p>
<p id="section-6.2-5">The fundamental problem here is that the number of possible issuance
configurations, including the keys in use and the Issuer identities themselves,
can partition the Client anonymity set. To mitigate this problem, Clients
<span class="bcp14">SHOULD</span> bound the number of active issuance configurations per Origin as well as
across Origins. Moreover, Clients <span class="bcp14">SHOULD</span> employ some form of consistency
mechanism to ensure that they receive the same configuration information and
are not being actively partitioned into smaller anonymity sets. See
<span>[<a class="cite xref" href="#I-D.ietf-privacypass-key-consistency">CONSISTENCY</a>]</span> for possible consistency
mechanisms. Depending on the deployment, the Attester might assist the Client
in applying these consistency checks across Clients. Failure to apply a
consistency check can allow Client-specific keys to violate Origin-Client
unlinkability.<a class="pilcrow" href="#section-6.2-5">¶</a></p>
</section>
</div>
<div id="partitioning-by-side-channels">
<section id="section-6.3">
        <h3 id="name-partitioning-by-side-channe">
<a class="section-number selfRef" href="#section-6.3">6.3. </a><a class="section-name selfRef" href="#name-partitioning-by-side-channe">Partitioning by Side Channels</a>
        </h3>
<p id="section-6.3-1">Side-channel attacks, such as those based on timing correlation, could be
used to reduce anonymity set size. In particular,
for interactive tokens that are bound to a Client-specific redemption
context, the anonymity set of Clients during the issuance protocol consists
of those Clients that started issuance between the time of the Origin's
challenge and the corresponding token redemption. Depending on the number
of Clients using a particular Issuer during that time window, the set can
be small. Applications should take such side channels into consideration before
choosing a particular deployment model and type of token challenge and
redemption context.<a class="pilcrow" href="#section-6.3-1">¶</a></p>
</section>
</div>
</section>
</div>
<div id="security">
<section id="section-7">
      <h2 id="name-security-considerations">
<a class="section-number selfRef" href="#section-7">7. </a><a class="section-name selfRef" href="#name-security-considerations">Security Considerations</a>
      </h2>
<p id="section-7-1">This document describes security and privacy requirements for the Privacy Pass
redemption and issuance protocols. It also describes deployment models built
around non-collusion assumptions and privacy considerations for using Privacy
Pass within those models. Ensuring Client privacy -- separation of attestation
and redemption contexts -- requires active work on behalf of the Client,
especially in the presence of malicious Issuers and Origins. Implementing the
mitigations discussed in Sections <a class="auto internal xref" href="#deployment">4</a> and <a class="auto internal xref" href="#privacy">6</a> is therefore necessary
to ensure that Privacy Pass offers meaningful privacy improvements to end users.<a class="pilcrow" href="#section-7-1">¶</a></p>
<div id="hoarding">
<section id="section-7.1">
        <h3 id="name-token-caching">
<a class="section-number selfRef" href="#section-7.1">7.1. </a><a class="section-name selfRef" href="#name-token-caching">Token Caching</a>
        </h3>
<p id="section-7.1-1">Depending on the Origin's token challenge, Clients can request and cache more
than one token using an issuance protocol. Cached tokens help improve privacy by
separating the time of token issuance from the time of token redemption; they
also allow Clients to reduce the overhead of receiving new tokens via the
issuance protocol.<a class="pilcrow" href="#section-7.1-1">¶</a></p>
<p id="section-7.1-2">As a consequence, Origins that send token challenges that are compatible with
cached tokens need to take precautions to ensure that tokens are not replayed.
This is typically done via keeping track of tokens that are redeemed for the
period of time in which cached tokens would be accepted for particular
challenges.<a class="pilcrow" href="#section-7.1-2">¶</a></p>
<p id="section-7.1-3">Moreover, since tokens are not intrinsically bound to Clients, it is possible
for malicious Clients to collude and share tokens in a so-called "hoarding
attack". As an example of this attack, many distributed Clients could obtain
cacheable tokens and then share them with a single Client to redeem the tokens in a way
that would violate an Origin's attempt to limit tokens to any one particular
Client. In general, mechanisms for mitigating hoarding attacks depend on the
deployment model and use case. For example, in the Joint Origin and Issuer model,
comparing the issuance and redemption contexts can help detect hoarding attacks,
i.e., if the distribution of redemption contexts is noticeably different from the
distribution of issuance contexts. Rate-limiting issuance, at either the Client,
Attester, or Issuer, can also help mitigate these attacks.<a class="pilcrow" href="#section-7.1-3">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana">
<section id="section-8">
      <h2 id="name-iana-considerations">
<a class="section-number selfRef" href="#section-8">8. </a><a class="section-name selfRef" href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<p id="section-8-1">This document has no IANA actions.<a class="pilcrow" href="#section-8-1">¶</a></p>
</section>
</div>
<section id="section-9">
      <h2 id="name-references">
<a class="section-number selfRef" href="#section-9">9. </a><a class="section-name selfRef" href="#name-references">References</a>
      </h2>
<section id="section-9.1">
        <h3 id="name-normative-references">
<a class="section-number selfRef" href="#section-9.1">9.1. </a><a class="section-name selfRef" href="#name-normative-references">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC9577">[AUTHSCHEME]</dt>
        <dd>
<span class="refAuthor">Pauly, T.</span>, <span class="refAuthor">Valdez, S.</span>, and <span class="refAuthor">C. A. Wood</span>, <span class="refTitle">"The Privacy Pass HTTP Authentication Scheme"</span>, <span class="seriesInfo">RFC 9577</span>, <span class="seriesInfo">DOI 10.17487/RFC9577</span>, <time class="refDate" datetime="2024-06">June 2024</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9577">https://www.rfc-editor.org/info/rfc9577</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time class="refDate" datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
      <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time class="refDate" datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-9.2">
        <h3 id="name-informative-references">
<a class="section-number selfRef" href="#section-9.2">9.2. </a><a class="section-name selfRef" href="#name-informative-references">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC9518">[CENTRALIZATION]</dt>
        <dd>
<span class="refAuthor">Nottingham, M.</span>, <span class="refTitle">"Centralization, Decentralization, and Internet Standards"</span>, <span class="seriesInfo">RFC 9518</span>, <span class="seriesInfo">DOI 10.17487/RFC9518</span>, <time class="refDate" datetime="2023-12">December 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9518">https://www.rfc-editor.org/info/rfc9518</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-privacypass-key-consistency">[CONSISTENCY]</dt>
        <dd>
<span class="refAuthor">Davidson, A.</span>, <span class="refAuthor">Finkel, M.</span>, <span class="refAuthor">Thomson, M.</span>, and <span class="refAuthor">C. A. Wood</span>, <span class="refTitle">"Key Consistency and Discovery"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-privacypass-key-consistency-01</span>, <time class="refDate" datetime="2023-07-10">10 July 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-privacypass-key-consistency-01">https://datatracker.ietf.org/doc/html/draft-ietf-privacypass-key-consistency-01</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="DMS2004">[DMS2004]</dt>
        <dd>
<span class="refAuthor">Dingledine, R.</span>, <span class="refAuthor">Mathewson, N.</span>, and <span class="refAuthor">P. Syverson</span>, <span class="refTitle">"Tor: The Second-Generation Onion Router"</span>, <time class="refDate" datetime="2004-05">May 2004</time>, <span>&lt;<a href="https://svn.torproject.org/svn/projects/design-paper/tor-design.html">https://svn.torproject.org/svn/projects/design-paper/tor-design.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="HIJK21">[HIJK21]</dt>
        <dd>
<span class="refAuthor">Huang, S.</span>, <span class="refAuthor">Iyengar, S.</span>, <span class="refAuthor">Jeyaraman, S.</span>, <span class="refAuthor">Kushwah, S.</span>, <span class="refAuthor">Lee, C-K.</span>, <span class="refAuthor">Luo, Z.</span>, <span class="refAuthor">Mohassel, P.</span>, <span class="refAuthor">Raghunathan, A.</span>, <span class="refAuthor">Shaikh, S.</span>, <span class="refAuthor">Sung, Y-C.</span>, and <span class="refAuthor">A. Zhang</span>, <span class="refTitle">"DIT: De-Identified Authenticated Telemetry at Scale"</span>, <time class="refDate" datetime="2021-01">January 2021</time>, <span>&lt;<a href="https://research.fb.com/privatestats">https://research.fb.com/privatestats</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9578">[ISSUANCE]</dt>
        <dd>
<span class="refAuthor">Celi, S.</span>, <span class="refAuthor">Davidson, A.</span>, <span class="refAuthor">Valdez, S.</span>, and <span class="refAuthor">C. A. Wood</span>, <span class="refTitle">"Privacy Pass Issuance Protocols"</span>, <span class="seriesInfo">RFC 9578</span>, <span class="seriesInfo">DOI 10.17487/RFC9578</span>, <time class="refDate" datetime="2024-06">June 2024</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9578">https://www.rfc-editor.org/info/rfc9578</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="KLOR20">[KLOR20]</dt>
        <dd>
<span class="refAuthor">Kreuter, B.</span>, <span class="refAuthor">Lepoint, T.</span>, <span class="refAuthor">Orrù, M.</span>, <span class="refAuthor">Raykova, M.</span>, and <span class="refAuthor">Springer International Publishing</span>, <span class="refTitle">"Anonymous Tokens with Private Metadata Bit"</span>, <span class="refContent">Advances in Cryptology - CRYPTO 2020, pp. 308-336</span>, <span class="seriesInfo">DOI 10.1007/978-3-030-56784-2_11</span>, <time class="refDate" datetime="2020">2020</time>, <span>&lt;<a href="https://doi.org/10.1007/978-3-030-56784-2_11">https://doi.org/10.1007/978-3-030-56784-2_11</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9458">[OHTTP]</dt>
        <dd>
<span class="refAuthor">Thomson, M.</span> and <span class="refAuthor">C. A. Wood</span>, <span class="refTitle">"Oblivious HTTP"</span>, <span class="seriesInfo">RFC 9458</span>, <span class="seriesInfo">DOI 10.17487/RFC9458</span>, <time class="refDate" datetime="2024-01">January 2024</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9458">https://www.rfc-editor.org/info/rfc9458</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="PrivacyPassCloudflare">[PrivacyPassCloudflare]</dt>
        <dd>
<span class="refAuthor">Sullivan, N.</span>, <span class="refTitle">"Cloudflare supports Privacy Pass"</span>, <time class="refDate" datetime="2017-11">November 2017</time>, <span>&lt;<a href="https://blog.cloudflare.com/cloudflare-supports-privacy-pass/">https://blog.cloudflare.com/cloudflare-supports-privacy-pass/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-privacypass-rate-limit-tokens">[RATE-LIMITED]</dt>
        <dd>
<span class="refAuthor">Hendrickson, S.</span>, <span class="refAuthor">Iyengar, J.</span>, <span class="refAuthor">Pauly, T.</span>, <span class="refAuthor">Valdez, S.</span>, and <span class="refAuthor">C. A. Wood</span>, <span class="refTitle">"Rate-Limited Token Issuance Protocol"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-privacypass-rate-limit-tokens-06</span>, <time class="refDate" datetime="2024-04-01">1 April 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-privacypass-rate-limit-tokens-06">https://datatracker.ietf.org/doc/html/draft-ietf-privacypass-rate-limit-tokens-06</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9334">[RFC9334]</dt>
      <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Thaler, D.</span>, <span class="refAuthor">Richardson, M.</span>, <span class="refAuthor">Smith, N.</span>, and <span class="refAuthor">W. Pan</span>, <span class="refTitle">"Remote ATtestation procedureS (RATS) Architecture"</span>, <span class="seriesInfo">RFC 9334</span>, <span class="seriesInfo">DOI 10.17487/RFC9334</span>, <time class="refDate" datetime="2023-01">January 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9334">https://www.rfc-editor.org/info/rfc9334</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="acknowledgements">
<section id="appendix-A">
      <h2 id="name-acknowledgements">
<a class="section-name selfRef" href="#name-acknowledgements">Acknowledgements</a>
      </h2>
<p id="appendix-A-1">The authors would like to thank <span class="contact-name">Eric Kinnear</span>, <span class="contact-name">Scott Hendrickson</span>, <span class="contact-name">Tommy Pauly</span>,
<span class="contact-name">Christopher Patton</span>, <span class="contact-name">Benjamin Schwartz</span>, <span class="contact-name">Martin Thomson</span>, <span class="contact-name">Steven Valdez</span>, and other
contributors of the Privacy Pass Working Group for many helpful contributions
to this document.<a class="pilcrow" href="#appendix-A-1">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-addresses">
<a class="section-name selfRef" href="#name-authors-addresses">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Alex Davidson</span></div>
<div class="left" dir="auto"><span class="org">NOVA LINCS, Universidade NOVA de Lisboa</span></div>
<div class="left" dir="auto"><span class="street-address">Largo da Torre</span></div>
<div class="left" dir="auto"><span class="locality">Caparica</span></div>
<div class="left" dir="auto"><span class="country-name">Portugal</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:alex.davidson92@gmail.com">alex.davidson92@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Jana Iyengar</span></div>
<div class="left" dir="auto"><span class="org">Fastly</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:jri@fastly.com">jri@fastly.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Christopher A. Wood</span></div>
<div class="left" dir="auto"><span class="org">Cloudflare</span></div>
<div class="left" dir="auto"><span class="street-address">101 Townsend St</span></div>
<div class="left" dir="auto">
<span class="locality">San Francisco</span>, <span class="region">CA</span> <span class="postal-code">94107</span>
</div>
<div class="left" dir="auto"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:caw@heapingbits.net">caw@heapingbits.net</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>


</body></html>