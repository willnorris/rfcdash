<html><head></head><body><pre>Internet Engineering Task Force (IETF)                           B. Weis
Request for Comments: 8263                                 Cisco Systems
Category: Standards Track                                      U. Mangla
ISSN: 2070-1721                                    Juniper Networks Inc.
                                                                 T. Karl
                                                        Deutsche Telekom
                                                           N. Maheshwari
                                                           November 2017


          <span class="h1">Group Domain of Interpretation (GDOI) GROUPKEY-PUSH</span>
                        <span class="h1">Acknowledgement Message</span>

Abstract

   The Group Domain of Interpretation (GDOI) includes the ability of a
   Group Controller/Key Server (GCKS) to provide a set of current Group
   Member (GM) devices with additional security associations (e.g., to
   rekey expiring security associations).  This memo adds the ability of
   a GCKS to request that the GM devices return an acknowledgement of
   receipt of its rekey message and specifies the acknowledgement
   method.

Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in <a href="./rfc7841#section-2">Section 2 of RFC 7841</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="https://www.rfc-editor.org/info/rfc8263">https://www.rfc-editor.org/info/rfc8263</a>.















<span class="grey">Weis, et al.                 Standards Track                    [Page 1]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-2"></span>
<span class="grey"><a href="./rfc8263">RFC 8263</a>                    GROUPKEY-PUSH ACK              November 2017</span>


Copyright Notice

   Copyright (c) 2017 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://www.rfc-editor.org/bcp/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-3">3</a>
      <a href="#section-1.1">1.1</a>. Requirements Notation ......................................<a href="#page-4">4</a>
      <a href="#section-1.2">1.2</a>. Acronyms and Abbreviations .................................<a href="#page-4">4</a>
   <a href="#section-2">2</a>. Acknowledgement Message Request .................................<a href="#page-5">5</a>
      <a href="#section-2.1">2.1</a>. REKEY_ACK_KEK_SHA256 Type ..................................<a href="#page-5">5</a>
      <a href="#section-2.2">2.2</a>. REKEY_ACK_LKH_SHA256 Type ..................................<a href="#page-6">6</a>
      <a href="#section-2.3">2.3</a>. REKEY_ACK_KEK_SHA512 Type ..................................<a href="#page-6">6</a>
      <a href="#section-2.4">2.4</a>. REKEY_ACK_LKH_SHA512 Type ..................................<a href="#page-6">6</a>
   <a href="#section-3">3</a>. GROUPKEY-PUSH Acknowledgement Message ...........................<a href="#page-6">6</a>
      <a href="#section-3.1">3.1</a>. HDR ........................................................<a href="#page-7">7</a>
      <a href="#section-3.2">3.2</a>. HASH .......................................................<a href="#page-8">8</a>
      <a href="#section-3.3">3.3</a>. SEQ ........................................................<a href="#page-9">9</a>
      <a href="#section-3.4">3.4</a>. ID .........................................................<a href="#page-9">9</a>
   <a href="#section-4">4</a>. Group Member Operations .........................................<a href="#page-9">9</a>
   <a href="#section-5">5</a>. GCKS Operations ................................................<a href="#page-10">10</a>
   <a href="#section-6">6</a>. Management Considerations ......................................<a href="#page-10">10</a>
   <a href="#section-7">7</a>. Security Considerations ........................................<a href="#page-12">12</a>
      <a href="#section-7.1">7.1</a>. Protection of the GROUPKEY-PUSH ACK .......................<a href="#page-12">12</a>
      <a href="#section-7.2">7.2</a>. Transmitting a GROUPKEY-PUSH ACK ..........................<a href="#page-13">13</a>
      <a href="#section-7.3">7.3</a>. Receiving a GROUPKEY-PUSH ACK .............................<a href="#page-13">13</a>
   <a href="#section-8">8</a>. IANA Considerations ............................................<a href="#page-14">14</a>
   <a href="#section-9">9</a>. References .....................................................<a href="#page-15">15</a>
      <a href="#section-9.1">9.1</a>. Normative References ......................................<a href="#page-15">15</a>
      <a href="#section-9.2">9.2</a>. Informative References ....................................<a href="#page-16">16</a>
   Acknowledgements ..................................................<a href="#page-17">17</a>
   Authors' Addresses ................................................<a href="#page-17">17</a>








<span class="grey">Weis, et al.                 Standards Track                    [Page 2]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-3"></span>
<span class="grey"><a href="./rfc8263">RFC 8263</a>                    GROUPKEY-PUSH ACK              November 2017</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" id="section-1">1</a>.  Introduction</span>

   The Group Domain of Interpretation (GDOI) [<a href="./rfc6407" title='"The Group Domain of Interpretation"'>RFC6407</a>] is a group key
   management method by which a Group Controller/Key Server (GCKS)
   distributes security associations (i.e., cryptographic policy and
   keying material) to a set of Group Member (GM) devices.  The GDOI
   meets the requirements set forth in [<a href="./rfc4046" title='"Multicast Security (MSEC) Group Key Management Architecture"'>RFC4046</a>] ("Multicast Security
   (MSEC) Group Key Management Architecture"), including a Registration
   Protocol and a Rekey Protocol.  The GDOI describes the Rekey Protocol
   as a GROUPKEY-PUSH message.

   A GDOI GCKS uses a GROUPKEY-PUSH message (<a href="./rfc6407#section-4">Section 4 of [RFC6407]</a>) to
   alert GMs to updates in policy for the group, including new policy
   and keying material, replacement policy and keying material, and
   indications of deleted policy and keying material.  Usually, the GCKS
   does not require a notification that the GM actually received the
   policy.  However, in some cases it is beneficial for a GCKS to be
   told by each receiving GM that it received the rekey message and, by
   implication, has reacted to the policy contained within.  For
   example, a GCKS policy can use the acknowledgements to determine
   which GMs are receiving the current group policy and which GMs are no
   longer participating in the group.

   This memo introduces a method by which a GM returns an
   Acknowledgement Message to the GCKS.  Initially, a GCKS requests that
   a GM acknowledge GROUPKEY-PUSH messages as part of a distributed
   group policy.  Then, as shown in Figure 1, when the GCKS delivers a
   GROUPKEY-PUSH message, each GM that honors the GCKS request returns a
   GROUPKEY-PUSH Acknowledgement Message.  The rest of this memo
   describes this method in detail.

                GCKS                          GM1       GM2
                 |                             |         |
                 |                 +----------&gt;|         |
                 |   GROUPKEY-PUSH |           |         |
                 |-----------------+           |         |
                 |                 |           |         |
                 |                 +--------------------&gt;|
                 |                             |         |
                 |&lt;----------------------------|         |
                 |      GROUPKEY-PUSH ACK      |         |
                 |                             |         |
                 |&lt;--------------------------------------|
                 |      GROUPKEY-PUSH ACK      |         |

                    Figure 1: GROUPKEY-PUSH Rekey Event





<span class="grey">Weis, et al.                 Standards Track                    [Page 3]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-4"></span>
<span class="grey"><a href="./rfc8263">RFC 8263</a>                    GROUPKEY-PUSH ACK              November 2017</span>


   Implementation of the GROUPKEY-PUSH Acknowledgement Message is
   OPTIONAL.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/1.1.%20%20Requirements%20Notation"></a><a class="selflink" href="#section-1.1" id="section-1.1">1.1</a>.  Requirements Notation</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in
   <a href="https://www.rfc-editor.org/bcp/bcp14">BCP 14</a> [<a href="./rfc2119" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>] [<a href="./rfc8174" title='"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"'>RFC8174</a>] when, and only when, they appear in all
   capitals, as shown here.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/1.2.%20%20Acronyms%20and%20Abbreviations"></a><a class="selflink" href="#section-1.2" id="section-1.2">1.2</a>.  Acronyms and Abbreviations</span>

   The following acronyms and abbreviations are used throughout this
   document.

   ACK   Acknowledgement Message

   D     Delete

   GCKS  Group Controller/Key Server

   GDOI  Group Domain of Interpretation

   GM    Group Member

   HDR   Header

   HMAC  Hashed Message Authentication Code

   IV    Initialization Vector

   KD    Key Download

   KDF   Key Derivation Function

   KEK   Key Encryption Key

   LKH   Logical Key Hierarchy

   MSEC  Multicast Security

   PRF   Pseudorandom Function

   SA    Security Association






<span class="grey">Weis, et al.                 Standards Track                    [Page 4]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-5"></span>
<span class="grey"><a href="./rfc8263">RFC 8263</a>                    GROUPKEY-PUSH ACK              November 2017</span>


   SEQ   Sequence Number

   SIG   Signature

   SPI   Security Parameter Index

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/2.%20%20Acknowledgement%20Message%20Request"></a><a class="selflink" href="#section-2" id="section-2">2</a>.  Acknowledgement Message Request</span>

   When a GM is ready to join a group, it contacts the GCKS with a
   GROUPKEY-PULL Registration Protocol.  When the GCKS has authenticated
   and verified that the GM is an authorized member of the group, it
   downloads several sets of policy in a Security Association (SA)
   payload.  If the group includes the use of a GROUPKEY-PUSH Rekey
   Protocol, the SA payload includes an SA Key Encryption Key (KEK)
   payload (<a href="./rfc6407#section-5.3">Section 5.3 of [RFC6407]</a>).  When necessary, the
   GROUPKEY-PUSH Rekey Protocol also contains an SA payload that
   includes the SA KEK policy.  The SA KEK policy indicates how the GM
   will be receiving and handling the GROUPKEY-PUSH Rekey Protocol.

   When the GCKS policy includes the use of the GROUPKEY-PUSH
   Acknowledgement Message, the GCKS reports this policy to the GM
   within the SA KEK policy.  The GCKS includes a new KEK attribute with
   the name KEK_ACK_REQUESTED (9), which indicates that the GM is
   requested to return a GROUPKEY-PUSH Acknowledgement Message.

   As part of the SA KEK policy, the GCKS specifies information on the
   keying material that is used to protect the GROUPKEY-PUSH Rekey
   Protocol (e.g., the presence of a KEK management algorithm).  Parts
   of this information are used by a GM to derive the ack_key (defined
   in <a href="#section-3.2">Section 3.2</a>), which protects the GROUPKEY-PUSH Acknowledgement
   Message.  There are different types of Rekey Acknowledgement
   Messages; they share an identical message format but differ in the
   keying material used.

   The following values of the KEK_ACK_REQUESTED attribute are defined
   in this memo.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/2.1.%20%20REKEY_ACK_KEK_SHA256%20Type"></a><a class="selflink" href="#section-2.1" id="section-2.1">2.1</a>.  REKEY_ACK_KEK_SHA256 Type</span>

   This type of Rekey ACK is used when the KEK Download Type
   (<a href="./rfc6407#section-5.6.2">Section 5.6.2 of [RFC6407]</a>) is part of the group policy.  The prf
   (defined in <a href="#section-3.2">Section 3.2</a>) is PRF-HMAC-SHA-256 [<a href="./rfc4868" title='"Using HMAC-SHA-256, HMAC-SHA-384, and HMAC-SHA-512 with IPsec"'>RFC4868</a>].  The base_key
   (also defined in <a href="#section-3.2">Section 3.2</a>) is the KEK_ALGORITHM_KEY used to
   decrypt the GROUPKEY-PUSH message.  Note that for some algorithms the
   KEK_ALGORITHM_KEY will include an explicit Initialization Vector (IV)
   before the actual key (<a href="./rfc6407#section-5.6.2.1">Section 5.6.2.1 of [RFC6407]</a>), but it is not
   used in the definition of the base_key.




<span class="grey">Weis, et al.                 Standards Track                    [Page 5]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-6"></span>
<span class="grey"><a href="./rfc8263">RFC 8263</a>                    GROUPKEY-PUSH ACK              November 2017</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/2.2.%20%20REKEY_ACK_LKH_SHA256%20Type"></a><a class="selflink" href="#section-2.2" id="section-2.2">2.2</a>.  REKEY_ACK_LKH_SHA256 Type</span>

   This type of Rekey ACK can be used when the KEK_MANAGEMENT_ALGORITHM
   KEK attribute with a value representing the Logical Key Hierarchy
   (LKH) is part of the group policy (<a href="./rfc6407#section-5.3.1.1">Section 5.3.1.1 of [RFC6407]</a>).
   The prf is PRF-HMAC-SHA-256.  The base_key is the Key Data field
   value taken from the first LKH Key structure in an LKH_DOWNLOAD_ARRAY
   attribute (see <a href="./rfc6407#section-5.6.3.1">Section 5.6.3.1 of [RFC6407]</a>).  This is a secret
   symmetric key that the GCKS shares with the GM.  Note that for some
   algorithms the LKH Key structure will include an explicit IV before
   the actual key (<a href="./rfc6407#section-5.6.3.1">Section 5.6.3.1 of [RFC6407]</a>), but it is not used in
   the definition of the base_key.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/2.3.%20%20REKEY_ACK_KEK_SHA512%20Type"></a><a class="selflink" href="#section-2.3" id="section-2.3">2.3</a>.  REKEY_ACK_KEK_SHA512 Type</span>

   This type of Rekey ACK is identical to the REKEY_ACK_KEK_SHA256 Type,
   except that the prf is PRF-HMAC-SHA-512 (defined in [<a href="./rfc4868" title='"Using HMAC-SHA-256, HMAC-SHA-384, and HMAC-SHA-512 with IPsec"'>RFC4868</a>]).

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/2.4.%20%20REKEY_ACK_LKH_SHA512%20Type"></a><a class="selflink" href="#section-2.4" id="section-2.4">2.4</a>.  REKEY_ACK_LKH_SHA512 Type</span>

   This type of Rekey ACK is identical to the REKEY_ACK_LKH_SHA256 Type,
   except that the prf is PRF-HMAC-SHA-512 (defined in [<a href="./rfc4868" title='"Using HMAC-SHA-256, HMAC-SHA-384, and HMAC-SHA-512 with IPsec"'>RFC4868</a>]).

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.%20%20GROUPKEY-PUSH%20Acknowledgement%20Message"></a><a class="selflink" href="#section-3" id="section-3">3</a>.  GROUPKEY-PUSH Acknowledgement Message</span>

   The GROUPKEY-PUSH message defined in [<a href="./rfc6407" title='"The Group Domain of Interpretation"'>RFC6407</a>] is reproduced in
   Figure 2.  The SA and Key Download (KD) payloads contain the actual
   policy and keying material being distributed to the GM.  The Sequence
   Number (SEQ) payload contains a sequence number that is used by the
   GM for replay protection.  This sequence number defines a unique
   rekey message delivered to that GM.  One or more Delete (D) payloads
   optionally specify the deletion of the existing group policy.  The
   Signature (SIG) payload includes a signature of a hash of the entire
   GROUPKEY-PUSH message (excepting the SIG payload octets) before it
   has been encrypted.

         GM                  GCKS
         --                  ----
                             &lt;---- HDR*, SEQ, [D,] SA, KD, SIG

         * Protected by the Rekey SA KEK; encryption occurs after HDR

              Figure 2: GROUPKEY-PUSH Message (from <a href="./rfc6407">RFC 6407</a>)








<span class="grey">Weis, et al.                 Standards Track                    [Page 6]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-7"></span>
<span class="grey"><a href="./rfc8263">RFC 8263</a>                    GROUPKEY-PUSH ACK              November 2017</span>


   When the GM has received a KEK_ACK_REQUESTED attribute in an SA KEK
   and it chooses to respond, it returns the value of the Sequence
   Number taken from the GROUPKEY-PUSH message to the GCKS along with
   its identity.  This tuple alerts the GCKS that the GM has received
   the GROUPKEY-PUSH message and implemented the policy contained
   therein.  The GROUPKEY-PUSH Acknowledgement Message is shown in
   Figure 3.

                      GM                              GCKS
                      --                              ----
                         HDR, HASH, SEQ, ID   ----&gt;

              Figure 3: GROUPKEY-PUSH Acknowledgement Message

   The IP header for the GROUPKEY-PUSH Acknowledgement Message is
   constructed as if it were a reply to the GROUPKEY-PUSH message.  That
   is, the source address of the GROUPKEY-PUSH message becomes the
   destination address of the GROUPKEY-PUSH Acknowledgement Message, and
   the GM includes its own IP address as the source address of the
   GROUPKEY-PUSH Acknowledgement Message.  The source port in the
   GROUPKEY-PUSH message UDP header becomes the destination port of the
   GROUPKEY-PUSH Acknowledgement Message UDP header, and the destination
   port of the GROUPKEY-PUSH message UDP header becomes the source port
   of the GROUPKEY-PUSH Acknowledgement Message UDP header.

   The following sections describe the payloads in the GROUPKEY-PUSH
   Acknowledgement Message.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.1.%20%20HDR"></a><a class="selflink" href="#section-3.1" id="section-3.1">3.1</a>.  HDR</span>

   The message begins with a header as defined for the GDOI
   GROUPKEY-PUSH message in <a href="./rfc6407#section-4.2">Section 4.2 of [RFC6407]</a>.  The fields in the
   HDR MUST be initialized as follows.  The cookies of a GROUPKEY-PUSH
   message act as a Security Parameter Index (SPI) and are copied to the
   Acknowledgement Message.  "Next Payload" identifies a "Hash (HASH)"
   payload (value 8) [<a href="#ref-ISAKMP-NP">ISAKMP-NP</a>].  Major Version is 1 and Minor Version
   is 0.  The Exchange Type has value 35 for the GDOI GROUPKEY-PUSH
   Acknowledgement Message.  Flags are set to 0.  Message ID MUST be set
   to 0.  Length is according to <a href="./rfc6407#section-4.2">Section 4.2 of [RFC6407]</a>.












<span class="grey">Weis, et al.                 Standards Track                    [Page 7]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-8"></span>
<span class="grey"><a href="./rfc8263">RFC 8263</a>                    GROUPKEY-PUSH ACK              November 2017</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.2.%20%20HASH"></a><a class="selflink" href="#section-3.2" id="section-3.2">3.2</a>.  HASH</span>

   The HASH payload is the same one used in the GDOI GROUPKEY-PULL
   exchange defined in <a href="./rfc6407#section-3.2">Section 3.2 of [RFC6407]</a>.  The hash data in the
   HASH payload is created as follows:

      HASH = prf(ack_key, SEQ | ID)

   where:

   o  "prf" is specific to the KEK_ACK_REQUESTED value and is described
      as part of that description.

   o  "|" indicates concatenation.

   o  "SEQ" and "ID" represent the bytes comprising the Sequence Number
      and Identification payloads.

   The ack_key is computed from a Key Derivation Function (KDF) that
   conforms to KDF in feedback mode as defined in NIST SP800-108
   [<a href="#ref-SP800-108">SP800-108</a>], where the length of the derived keying material is the
   same as the output of the prf, there is no IV, and the optional
   counter is not used.  Note: When the derived ack_key is smaller than
   the prf block size (i.e., 512 bits for PRF-HMAC-SHA-256), it is
   zero-filled to the right, as specified in <a href="./rfc4868#section-2.1.2">Section 2.1.2 of [RFC4868]</a>.

      ack_key = prf(base_key, "GROUPKEY-PUSH ACK" | SPI | L)

   where:

   o  "prf" is specific to the KEK_ACK_REQUESTED value and is described
      as part of that description.

   o  "base_key" is specific to the KEK_ACK_REQUESTED value and is
      described as part of that description.  If the base_key is smaller
      than the prf block size (i.e., 512 bits for PRF-HMAC-SHA-256),
      then it is zero-filled to the right, as specified in <a href="./rfc4868#section-2.1.2">Section 2.1.2
      of [RFC4868]</a>.

   o  "|" indicates concatenation.

   o  "GROUPKEY-PUSH ACK" is a label encoded as a null-terminated ASCII
      string.

   o  "SPI" (per [<a href="./rfc6407" title='"The Group Domain of Interpretation"'>RFC6407</a>]) is the Initiator Cookie followed by the
      Responder Cookie taken from the GROUPKEY-PUSH message HDR, which
      describes the context of the key usage.




<span class="grey">Weis, et al.                 Standards Track                    [Page 8]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-9"></span>
<span class="grey"><a href="./rfc8263">RFC 8263</a>                    GROUPKEY-PUSH ACK              November 2017</span>


   o  "L" is a length field matching the number of bits in the ack_key.
      L MUST match the length of the base_key (i.e., 512 bits for
      PRF-HMAC-SHA-256).  The value L is represented as two octets in
      network byte order (that is, most significant byte first).

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.3.%20%20SEQ"></a><a class="selflink" href="#section-3.3" id="section-3.3">3.3</a>.  SEQ</span>

   The Sequence Number payload is defined in <a href="./rfc6407#section-5.7">Section 5.7 of [RFC6407]</a>.
   The value in the GROUPKEY-PUSH SEQ payload is copied to the
   GROUPKEY-PUSH ACK SEQ payload.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.4.%20%20ID"></a><a class="selflink" href="#section-3.4" id="section-3.4">3.4</a>.  ID</span>

   The Identification payload is used as defined in <a href="./rfc6407#section-5.1">Section 5.1 of
   [RFC6407]</a>.  The ID payload contains an ID Type of ID_IPV4_ADDR,
   ID_IPV6_ADDR, or ID_OID as defined in [<a href="./rfc8052" title='"Group Domain of Interpretation (GDOI) Protocol Support for IEC 62351 Security Services"'>RFC8052</a>] for GDOI exchanges.
   The Protocol ID and Port fields MUST be set to 0.  The address
   provided in the ID payload represents the IP address of the GM and
   MUST match the source IP address used for the most recent
   GROUPKEY-PULL exchange.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/4.%20%20Group%20Member%20Operations"></a><a class="selflink" href="#section-4" id="section-4">4</a>.  Group Member Operations</span>

   When a GM receives an SA KEK payload (in a GROUPKEY-PULL exchange or
   GROUPKEY-PUSH message) including a KEK_ACK_REQUESTED attribute, it
   records in its group state some indication that it is expected to
   return a GROUPKEY-PUSH ACK.  A GM recognizing the attribute MUST
   honor the KEK_ACK_REQUESTED attribute by returning Acknowledgements,
   because it can be expected that the GCKS is likely to take some
   policy-specific action regarding unresponsive GMs, including ceasing
   to deliver GROUPKEY-PUSH messages to it.

   If a GM cannot respond with the requested type of Acknowledgement, it
   continues with protocol exchange and participates in the group.  In
   any case, if a GM stops receiving GROUPKEY-PUSH messages from a GCKS,
   it will re-register before existing SAs expire, so omitting the
   sending of Acknowledgements should not be critical.

   When a GM receives a GROUPKEY-PUSH message that contains a
   KEK_ACK_REQUESTED attribute in the SA KEK payload, it processes the
   message according to <a href="./rfc6407">RFC 6407</a>.  When it concludes successful
   processing of the message, it formulates the GROUPKEY-PUSH ACKs as
   described in <a href="#section-3">Section 3</a> and delivers the message to the GCKS from
   which the GROUPKEY-PUSH message was received.  A GROUPKEY-PUSH ACK is
   sent even if the GROUPKEY-PUSH message contains a Delete payload for
   the KEK used to protect the GROUPKEY-PUSH message.





<span class="grey">Weis, et al.                 Standards Track                    [Page 9]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-10"></span>
<span class="grey"><a href="./rfc8263">RFC 8263</a>                    GROUPKEY-PUSH ACK              November 2017</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.%20%20GCKS%20Operations"></a><a class="selflink" href="#section-5" id="section-5">5</a>.  GCKS Operations</span>

   When a GCKS policy includes requesting a GROUPKEY-PUSH ACK from GMs,
   it includes the KEK_ACK_REQUESTED attribute in the SA KEK payload.
   It does this each time the SA KEK is delivered, in both GROUPKEY-PULL
   exchanges and GROUPKEY-PUSH messages.  The value of the
   KEK_ACK_REQUESTED attribute will depend upon the type of SA KEK
   policy, as described in <a href="#section-2">Section 2</a>.

   When a GCKS receives a GROUPKEY-PUSH ACK (identified by an Exchange
   Type of GROUPKEY-PUSH-ACK), it first verifies that the group policy
   includes receiving GROUPKEY-PUSH ACKs.  If not, the message is
   discarded.  GCKS implementations SHOULD keep a record (e.g., a hash
   value) of recently received GROUPKEY-PUSH Acknowledgement Messages
   and reject duplicate messages prior to performing cryptographic
   operations.  This enables an early discard of the replayed messages.

   If the message is expected, the GCKS validates the format of the
   message and verifies that the HASH has been properly constructed as
   described in <a href="#section-3.2">Section 3.2</a>.  If validation fails, the message is
   discarded.  The GCKS extracts the sequence number and identity of the
   GM from the SEQ and ID payloads, respectively, and records the fact
   that the GM received the GROUPKEY-PUSH message represented by its
   sequence number.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/6.%20%20Management%20Considerations"></a><a class="selflink" href="#section-6" id="section-6">6</a>.  Management Considerations</span>

   The GCKS manages group policy as well as determining which GM devices
   are presently "live" members of the group (i.e., members either
   sending or receiving messages).  Group policy includes a strategy to
   ensure that rekey messages with current group policy reach all live
   GMs.  This is discussed briefly in <a href="./rfc4046#section-5.3">Section 5.3 of [RFC4046]</a>.  The
   GROUPKEY-PUSH Acknowledgement Message specified in this memo provides
   the GCKS with an additional method to assess if a GM is live and has
   received the current group policy.  But it is possible for a rekey
   message or GROUPKEY-PUSH Acknowledgement Message to be discarded in
   the network, resulting in a live GM appearing to be unresponsive.
   Also, a GM might not be able to respond with a GROUPKEY-PUSH ACK, so
   the GCKS should use caution in using a lack of an Acknowledgement
   Message as the only factor in determining whether a GM is live.  In
   particular, a GCKS SHOULD NOT consider a GM to have left the group
   until it has received at least one ACK from the GM.









<span class="grey">Weis, et al.                 Standards Track                   [Page 10]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-11"></span>
<span class="grey"><a href="./rfc8263">RFC 8263</a>                    GROUPKEY-PUSH ACK              November 2017</span>


   Some management considerations for determining how a GM handles
   Acknowledgement Messages are as follows:

   o  A GM MUST respond with Acknowledgement Messages when requested, as
      a GCKS can subsequently determine when a GM unexpectedly becomes
      unresponsive.

   o  A GM receiving a GROUPKEY-PUSH message as a multicast message MAY
      introduce jitter to the timing of its Acknowledgement Message to
      help the GCKS better manage replies from GMs.  A GM MUST NOT delay
      sending an Acknowledgement Message for more than 5 seconds. a GCKS
      SHOULD NOT declare an Acknowledgement Message as missing until it
      has waited at least 10 seconds.  Implementations SHOULD make these
      timers configurable.

   Some management considerations for determining how the GCKS handles
   Acknowledgement Messages are as follows:

   o  Non-receipt of an Acknowledgement Message is an indication that a
      GM is unable to respond.  A GCKS SHOULD wait at least several
      seconds before determining non-receipt, as GMs could add jitter to
      the response time before sending an Acknowledgement Message.

   o  If the GCKS is aware that GMs are expected to respond, then
      non-receipt of an Acknowledgement Message SHOULD trigger a logging
      event.  The GCKS MAY be configured with such additional policy
      actions as transmitting the GROUPKEY-PUSH message several times in
      a short period of time (as suggested in [<a href="./rfc4046" title='"Multicast Security (MSEC) Group Key Management Architecture"'>RFC4046</a>]), thereby
      mitigating loss of either the GROUPKEY-PUSH message or an
      Acknowledgement Message.  Another policy action could be to alert
      GCKS administrators of GMs that do not return several consecutive
      Acknowledgement Messages or even removing unresponsive GMs from
      the group.  However, a GCKS with a policy of removing GMs from the
      group needs to be aware that a GM that has not responded will not
      receive a newer group policy until it initiates contact with the
      GCKS again.

   o  When a GROUPKEY-PUSH message includes a Delete payload for the KEK
      used to protect the GROUPKEY-PUSH message, the GCKS SHOULD NOT
      itself delete the KEK until it has given GMs the opportunity to
      acknowledge receipt of the GROUPKEY-PUSH message.  This could be
      several seconds, as GMs could add jitter to the response time
      before sending an Acknowledgement Message.

   o  A GCKS SHOULD log failure events, such as receiving
      Acknowledgement Messages for a group in which the GCKS has not
      requested Acknowledgements, receiving malformed Acknowledgements,
      and Acknowledgements that fail validation.



<span class="grey">Weis, et al.                 Standards Track                   [Page 11]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-12"></span>
<span class="grey"><a href="./rfc8263">RFC 8263</a>                    GROUPKEY-PUSH ACK              November 2017</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/7.%20%20Security%20Considerations"></a><a class="selflink" href="#section-7" id="section-7">7</a>.  Security Considerations</span>

   There are three areas of security considerations to consider: the
   protection of the GROUPKEY-PUSH ACK, whether the GM should transmit a
   GROUPKEY-PUSH ACK, and whether a GCKS should accept a GROUPKEY-PUSH
   ACK.  These are addressed in the following subsections.

   The construction of the HASH defined in this memo uses
   PRF-HMAC-SHA-256 or PRF-HMAC-SHA-512.  The strengths of
   PRF-HMAC-SHA-256 and PRF-HMAC-SHA-512 were unquestioned at the time
   this memo was developed.  When a HASH construction using a different
   prf becomes necessary, a new KEK_ACK_REQUESTED value will be defined
   in a new specification.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/7.1.%20%20Protection%20of%20the%20GROUPKEY-PUSH%20ACK"></a><a class="selflink" href="#section-7.1" id="section-7.1">7.1</a>.  Protection of the GROUPKEY-PUSH ACK</span>

   The GROUPKEY-PUSH ACK is an Internet Security Association and Key
   Management Protocol (ISAKMP) message as discussed in [<a href="./rfc2408" title='"Internet Security Association and Key Management Protocol (ISAKMP)"'>RFC2408</a>].
   (Note: <a href="./rfc2408">RFC 2408</a> has been obsoleted by <a href="./rfc7296">RFC 7296</a>, but only <a href="./rfc2408">RFC 2408</a>
   applies in this context.)  Message authentication and protection
   against man-in-the-middle attacks are provided by the inclusion of a
   HASH payload that includes the output of an HMAC computation over the
   bytes of the message.

   Because the KEK is a group secret, when the value of REKEY_ACK_KEK is
   specified, impersonation of a victim GM by another authorized GM is
   possible.  However, security considerations regarding such an
   impersonation are limited to a false claim that a victim GM has
   received a GROUPKEY-PUSH when the victim GM has in fact not received
   it (e.g., because an active attacker has discarded the
   GROUPKEY-PUSH).  If a GCKS policy includes sending retransmissions of
   the GROUPKEY-PUSH message to that victim GM, then the victim GM might
   not receive replacement SAs.  However, this does not introduce any
   additional threats over a use case where the GROUPKEY-PUSH ACK is not
   deployed and GROUPKEY-PUSH messages are withheld from a victim GM by
   an active attacker.  These threats can be mitigated by using a value
   of REKEY_ACK_LKH, due to the use of a secret pairwise key shared
   between the GCKS and an individual GM.

   Confidentiality is not provided for the GROUPKEY-PUSH ACK.  The
   contents of the message, including the hash value, the sequence
   number from the GROUPKEY-PUSH message to which it is acknowledging
   receipt, and the identity of the GM, can be observed by a passive
   attacker.  Observation of a hash value or set of hash values will not
   compromise the hash key.  The identity of the GM is also available to
   the passive attacker as the source IP address of the packet.  Note
   that the sequence number in the GROUPKEY-PUSH ACK does reveal the
   sequence number (previously not available to the attacker) that was



<span class="grey">Weis, et al.                 Standards Track                   [Page 12]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-13"></span>
<span class="grey"><a href="./rfc8263">RFC 8263</a>                    GROUPKEY-PUSH ACK              November 2017</span>


   included in the GROUPKEY-PUSH message.  However, the attacker is
   assumed to not be in possession of the key used to encrypt the
   message and thus cannot create a spoofed GROUPKEY-PUSH message.
   Therefore, the attacker does not derive any direct value from
   learning the sequence number.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/7.2.%20%20Transmitting%20a%20GROUPKEY-PUSH%20ACK"></a><a class="selflink" href="#section-7.2" id="section-7.2">7.2</a>.  Transmitting a GROUPKEY-PUSH ACK</span>

   A GM transmits an ACK only when the policy of the most recently
   received SA KEK includes a request by the GCKS for ACKs, and the ACK
   is only returned after processing the GROUPKEY-PUSH message according
   to <a href="./rfc6407#section-4.4">Section 4.4 of [RFC6407]</a>.  In other words, the form of the
   GROUPKEY-PUSH message will have been validated, replay protection
   completed, and the digital signature verified as being genuine.
   Therefore, the threat of a GM responding to a spoofed or resent
   GROUPKEY-PUSH message, and the possibility of the GM being used to
   propagate a Distributed Denial of Service (DDoS) attack on a GCKS,
   are mitigated.  For more information, see the security considerations
   for a GROUPKEY-PUSH message as described in <a href="./rfc6407#section-7.3">Section 7.3 of [RFC6407]</a>.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/7.3.%20%20Receiving%20a%20GROUPKEY-PUSH%20ACK"></a><a class="selflink" href="#section-7.3" id="section-7.3">7.3</a>.  Receiving a GROUPKEY-PUSH ACK</span>

   A GCKS receiving ACKs will follow the validation steps described in
   <a href="#section-5">Section 5</a> before interpreting the contents of the message.  The GCKS
   will then be sure to operate only on messages that have been sent by
   an authorized GM.

   A GCKS SHOULD be prepared to receive GROUPKEY-PUSH ACKs from each GM
   to which it was sent.  That is, it needs to ensure that it has
   sufficient resources (e.g., receive queue size) so that it does not
   unnecessarily drop ACKs.  A GCKS should be aware that a large number
   of replayed or invalid GROUPKEY-PUSH messages could be addressed to
   it.  However, this is no worse a threat than if it received a large
   number of other types of replayed or invalid GDOI or other messages
   containing a HASH payload.

   How a GCKS processes the sequence number and identity included in an
   ACK is a matter of local policy and is outside the scope of this
   memo.












<span class="grey">Weis, et al.                 Standards Track                   [Page 13]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-14"></span>
<span class="grey"><a href="./rfc8263">RFC 8263</a>                    GROUPKEY-PUSH ACK              November 2017</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/8.%20%20IANA%20Considerations"></a><a class="selflink" href="#section-8" id="section-8">8</a>.  IANA Considerations</span>

   The following additions have been made to the "Group Domain of
   Interpretation (GDOI) Payloads" [<a href="#ref-GDOI-REG">GDOI-REG</a>] registry.

   A new attribute has been added to the "SA KEK Payload Values - KEK
   Attributes" registry.  The ID Class name is KEK_ACK_REQUESTED with a
   value of 9 and is a Basic attribute.

   A new registry defining values for KEK_ACK_REQUESTED, "SA KEK Payload
   Values - KEK_ACK_REQUESTED", has been added; the initial
   registrations are shown in the following table.  The terms
   "Reserved", "Unassigned", and "Private Use" are to be applied as
   defined in [<a href="./rfc8126" title="">RFC8126</a>].  The registration procedure is Specification
   Required.

                   Value            Type
                  -------           --------------------
                     0              Reserved
                     1              REKEY_ACK_KEK_SHA256
                     2              REKEY_ACK_LKH_SHA256
                     3              REKEY_ACK_KEK_SHA512
                     4              REKEY_ACK_LKH_SHA512
                    5-128           Unassigned
                  129-255           Private Use

   A new registry describing ISAKMP Exchange Types for the GDOI, "GDOI
   DOI Exchange Types", has been added under the "Group Domain of
   Interpretation (GDOI) Payloads" registry [<a href="#ref-GDOI-REG">GDOI-REG</a>].  This new
   registry defines DOI Specific Use values [<a href="#ref-ISAKMP-EXCH">ISAKMP-EXCH</a>], which are
   Exchange Type values used with the ISAKMP GDOI DOI.  The registration
   procedure is Specification Required.  The terms "Known Unregistered
   Use" and "Unassigned" are to be applied as defined in [<a href="./rfc8126" title="">RFC8126</a>].

             Value                      Phase        Reference
             ----------------------     ------       ---------
             GROUPKEY-PULL                32         <a href="./rfc6407">RFC 6407</a>
             GROUPKEY-PUSH                33         <a href="./rfc6407">RFC 6407</a>
             Known Unregistered Use       34
             GROUPKEY-PUSH-ACK            35         <a href="./rfc8263">RFC 8263</a>
             Unassigned                 36-239










<span class="grey">Weis, et al.                 Standards Track                   [Page 14]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-15"></span>
<span class="grey"><a href="./rfc8263">RFC 8263</a>                    GROUPKEY-PUSH ACK              November 2017</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/9.%20%20References"></a><a class="selflink" href="#section-9" id="section-9">9</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/9.1.%20%20Normative%20References"></a><a class="selflink" href="#section-9.1" id="section-9.1">9.1</a>.  Normative References</span>

   [<a id="ref-RFC2119">RFC2119</a>]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="https://www.rfc-editor.org/bcp/bcp14">BCP 14</a>, <a href="./rfc2119">RFC 2119</a>,
              DOI 10.17487/RFC2119, March 1997,
              &lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;.

   [<a id="ref-RFC4868">RFC4868</a>]  Kelly, S. and S. Frankel, "Using HMAC-SHA-256,
              HMAC-SHA-384, and HMAC-SHA-512 with IPsec", <a href="./rfc4868">RFC 4868</a>,
              DOI 10.17487/RFC4868, May 2007,
              &lt;<a href="https://www.rfc-editor.org/info/rfc4868">https://www.rfc-editor.org/info/rfc4868</a>&gt;.

   [<a id="ref-RFC6407">RFC6407</a>]  Weis, B., Rowles, S., and T. Hardjono, "The Group Domain
              of Interpretation", <a href="./rfc6407">RFC 6407</a>, DOI 10.17487/RFC6407,
              October 2011, &lt;<a href="https://www.rfc-editor.org/info/rfc6407">https://www.rfc-editor.org/info/rfc6407</a>&gt;.

   [<a id="ref-RFC8052">RFC8052</a>]  Weis, B., Seewald, M., and H. Falk, "Group Domain of
              Interpretation (GDOI) Protocol Support for IEC 62351
              Security Services", <a href="./rfc8052">RFC 8052</a>, DOI 10.17487/RFC8052,
              June 2017, &lt;<a href="https://www.rfc-editor.org/info/rfc8052">https://www.rfc-editor.org/info/rfc8052</a>&gt;.

   [<a id="ref-RFC8126">RFC8126</a>]  Cotton, M., Leiba, B., and T. Narten, "Guidelines for
              Writing an IANA Considerations Section in RFCs", <a href="https://www.rfc-editor.org/bcp/bcp26">BCP 26</a>,
              <a href="./rfc8126">RFC 8126</a>, DOI 10.17487/RFC8126, June 2017,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;.

   [<a id="ref-RFC8174">RFC8174</a>]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in
              <a href="./rfc2119">RFC 2119</a> Key Words", <a href="https://www.rfc-editor.org/bcp/bcp14">BCP 14</a>, <a href="./rfc8174">RFC 8174</a>,
              DOI 10.17487/RFC8174, May 2017,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;.



















<span class="grey">Weis, et al.                 Standards Track                   [Page 15]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-16"></span>
<span class="grey"><a href="./rfc8263">RFC 8263</a>                    GROUPKEY-PUSH ACK              November 2017</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/9.2.%20%20Informative%20References"></a><a class="selflink" href="#section-9.2" id="section-9.2">9.2</a>.  Informative References</span>

   [<a id="ref-GDOI-REG">GDOI-REG</a>]
              Internet Assigned Numbers Authority, "Group Domain of
              Interpretation (GDOI) Payload Type Values", IANA Registry,
              September 2017, &lt;<a href="https://www.iana.org/assignments/gdoi-payloads/">https://www.iana.org/assignments/</a>
              <a href="https://www.iana.org/assignments/gdoi-payloads/">gdoi-payloads/</a>&gt;.

   [<a id="ref-ISAKMP-EXCH">ISAKMP-EXCH</a>]
              Internet Assigned Numbers Authority, "Internet Key
              Exchange (IKE) Attributes Exchange Type Values",
              IANA Registry, May 2013,
              &lt;<a href="https://www.iana.org/assignments/ipsec-registry/">https://www.iana.org/assignments/ipsec-registry/</a>&gt;.

   [<a id="ref-ISAKMP-NP">ISAKMP-NP</a>]
              Internet Assigned Numbers Authority, "Internet Key
              Exchange (IKE) Attributes Next Protocol Types",
              IANA Registry, May 2013,
              &lt;<a href="https://www.iana.org/assignments/ipsec-registry/">https://www.iana.org/assignments/ipsec-registry/</a>&gt;.

   [<a id="ref-RFC2408">RFC2408</a>]  Maughan, D., Schertler, M., Schneider, M., and J. Turner,
              "Internet Security Association and Key Management Protocol
              (ISAKMP)", <a href="./rfc2408">RFC 2408</a>, DOI 10.17487/RFC2408, November 1998,
              &lt;<a href="https://www.rfc-editor.org/info/rfc2408">https://www.rfc-editor.org/info/rfc2408</a>&gt;.

   [<a id="ref-RFC4046">RFC4046</a>]  Baugher, M., Canetti, R., Dondeti, L., and F. Lindholm,
              "Multicast Security (MSEC) Group Key Management
              Architecture", <a href="./rfc4046">RFC 4046</a>, DOI 10.17487/RFC4046, April 2005,
              &lt;<a href="https://www.rfc-editor.org/info/rfc4046">https://www.rfc-editor.org/info/rfc4046</a>&gt;.

   [<a id="ref-SP800-108">SP800-108</a>]
              Chen, L., "Recommendation for Key Derivation Using
              Pseudorandom Functions (Revised)", National Institute of
              Science and Technology, NIST Special Publication 800-108,
              DOI 10.6028/NIST.SP.800-108, October 2009,
              &lt;<a href="http://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-108.pdf">http://nvlpubs.nist.gov/nistpubs/Legacy/SP/</a>
              <a href="http://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-108.pdf">nistspecialpublication800-108.pdf</a>&gt;.














<span class="grey">Weis, et al.                 Standards Track                   [Page 16]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-17"></span>
<span class="grey"><a href="./rfc8263">RFC 8263</a>                    GROUPKEY-PUSH ACK              November 2017</span>


Acknowledgements

   Mike Hamada, Adrian Farrel, and Yaron Sheffer provided many useful
   technical and editorial comments and suggestions for improvement.

Authors' Addresses

   Brian Weis
   Cisco Systems
   170 W. Tasman Drive
   San Jose, California  95134-1706
   United States of America

   Phone: +1-408-526-4796
   Email: bew@cisco.com


   Umesh Mangla
   Juniper Networks Inc.
   1133 Innovation Way
   Sunnyvale, California  94089
   United States of America

   Phone: +1-408-936-1022
   Email: umangla@juniper.net


   Thomas Karl
   Deutsche Telekom
   Landgrabenweg 151
   Bonn  53227
   Germany

   Phone: +49-228-18138122
   Email: thomas.karl@telekom.de


   Nilesh Maheshwari

   Email: nileshm@gmail.com











Weis, et al.                 Standards Track                   [Page 17]
</pre>
</body></html>