<!DOCTYPE html>
<html class="RFC" lang="en"><head>
<meta charset="utf-8"/>
<meta content="Common,Cyrillic,Latin" name="scripts"/>
<meta content="initial-scale=1.0" name="viewport"/>
<title>RFC 9548: Generating Transport Key Containers (PFX) Using the GOST Algorithms</title>
<meta content="Ekaterina Karelina" name="author"/>
<meta content='
       This document specifies how to use "PKCS #12: Personal Information Exchange Syntax v1.1" (RFC 7292) to transport key containers (PFX) for storing keys and certificates in conjunction with the
Russian national standard GOST algorithms.
       
       
            This specification has been developed outside the IETF. The purpose of publication is to
            facilitate interoperable implementations that wish to support the
            GOST algorithms. This document does not imply IETF endorsement of the cryptographic algorithms
used here.
       
    ' name="description"/>
<meta content="xml2rfc 3.21.0" name="generator"/>
<meta content="certificates" name="keyword"/>
<meta content="GOST algorithms" name="keyword"/>
<meta content="pkcs12" name="keyword"/>
<meta content="gost" name="keyword"/>
<meta content="PFX" name="keyword"/>
<meta content="9548" name="rfc.number"/>
<!-- Generator version information:
  xml2rfc 3.21.0
    Python 3.9.15
    ConfigArgParse 1.5.3
    google-i18n-address 3.0.0
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 4.9.0
    platformdirs 3.8.0
    pycountry 22.3.5
    PyYAML 6.0
    requests 2.28.0
    setuptools 44.1.1
    six 1.16.0
    wcwidth 0.2.5
    weasyprint 56.1
-->
<link href="rfc9548.xml" rel="alternate" type="application/rfc+xml"/>
<link href="#copyright" rel="license"/>
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necessary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

:root {
  --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
  --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
  --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
}

@viewport {
  zoom: 1.0;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: var(--font-sans);
  line-height: 1.6;
  scroll-behavior: smooth;
  overflow-wrap: break-word;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
svg[font-family~="serif" i], svg [font-family~="serif" i] {
  font-family: var(--font-serif);
}
svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
  font-family: var(--font-sans);
}
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre {
  background-color: #f9f9f9;
  font-family: var(--font-mono);
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
blockquote > *:last-child {
  margin-bottom: 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}
.xref {
  overflow-wrap: normal;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.refSubseries {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: var(--font-sans);
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  .breakable pre {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The following is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
.sourcecode pre,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .artwork > pre,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background slightly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottom margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the compact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div.sourcecode:first-child,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type:only-child {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css"/>
<link href="https://datatracker.ietf.org/doc/draft-pkcs12-gost-08" rel="prev"/>
  <link href="https://dx.doi.org/10.17487/rfc9548" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  </head>
<body class="xml2rfc">
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 9548</td>
<td class="center">GOST Usage in Password-Based PKCS #12</td>
<td class="right">May 2024</td>
</tr></thead>
<tfoot><tr>
<td class="left">Karelina</td>
<td class="center">Informational</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div class="document-information" id="external-metadata"></div>
<div class="document-information" id="internal-metadata">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Independent Submission</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a class="eref" href="https://www.rfc-editor.org/rfc/rfc9548">9548</a></dd>
<dt class="label-category">Category:</dt>
<dd class="category">Informational</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time class="published" datetime="2024-05">May 2024</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">E. Karelina, <span class="editor">Ed.</span>
</div>
<div class="org">InfoTeCS</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 9548</h1>
<h1 id="title">Generating Transport Key Containers (PFX) Using the GOST Algorithms</h1>
<section id="section-abstract">
      <h2 id="abstract"><a class="selfRef" href="#abstract">Abstract</a></h2>
<p id="section-abstract-1">This document specifies how to use "PKCS #12: Personal Information Exchange Syntax v1.1" (RFC 7292) to transport key containers (PFX) for storing keys and certificates in conjunction with the
Russian national standard GOST algorithms.<a class="pilcrow" href="#section-abstract-1">¶</a></p>
<p id="section-abstract-2">
            This specification has been developed outside the IETF. The purpose of publication is to
            facilitate interoperable implementations that wish to support the
            GOST algorithms. This document does not imply IETF endorsement of the cryptographic algorithms
used here.<a class="pilcrow" href="#section-abstract-2">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a class="section-name selfRef" href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This document is not an Internet Standards Track specification; it is
            published for informational purposes.<a class="pilcrow" href="#section-boilerplate.1-1">¶</a></p>
<p id="section-boilerplate.1-2">
            This is a contribution to the RFC Series, independently of any
            other RFC stream.  The RFC Editor has chosen to publish this
            document at its discretion and makes no statement about its value
            for implementation or deployment.  Documents approved for
            publication by the RFC Editor are not candidates for any level of
            Internet Standard; see Section 2 of RFC 7841.<a class="pilcrow" href="#section-boilerplate.1-2">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc9548">https://www.rfc-editor.org/info/rfc9548</a></span>.<a class="pilcrow" href="#section-boilerplate.1-3">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a class="section-name selfRef" href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2024 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a class="pilcrow" href="#section-boilerplate.2-1">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document.<a class="pilcrow" href="#section-boilerplate.2-2">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a class="toplink" href="#" onclick="scroll(0,0)">▲</a><h2 id="name-table-of-contents">
<a class="section-name selfRef" href="#name-table-of-contents">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p class="keepWithNext" id="section-toc.1-1.1.1"><a class="auto internal xref" href="#section-1">1</a>.  <a class="internal xref" href="#name-introduction">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p class="keepWithNext" id="section-toc.1-1.2.1"><a class="auto internal xref" href="#section-2">2</a>.  <a class="internal xref" href="#name-conventions-used-in-this-do">Conventions Used in This Document</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p class="keepWithNext" id="section-toc.1-1.3.1"><a class="auto internal xref" href="#section-3">3</a>.  <a class="internal xref" href="#name-basic-terms-and-definitions">Basic Terms and Definitions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a class="auto internal xref" href="#section-4">4</a>.  <a class="internal xref" href="#name-pfx">PFX</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a class="auto internal xref" href="#section-4.1">4.1</a>.  <a class="internal xref" href="#name-structure-of-pfx">Structure of PFX</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a class="auto internal xref" href="#section-4.2">4.2</a>.  <a class="internal xref" href="#name-authenticatedsafe">AuthenticatedSafe</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a class="auto internal xref" href="#section-4.2.1">4.2.1</a>.  <a class="internal xref" href="#name-unencrypted-data">Unencrypted Data</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.2">
                    <p id="section-toc.1-1.4.2.2.2.2.1"><a class="auto internal xref" href="#section-4.2.2">4.2.2</a>.  <a class="internal xref" href="#name-password-encrypted-data">Password-Encrypted Data</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a class="auto internal xref" href="#section-4.3">4.3</a>.  <a class="internal xref" href="#name-safecontents-and-safebag">SafeContents and SafeBag</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a class="auto internal xref" href="#section-5">5</a>.  <a class="internal xref" href="#name-gost-r-3410-2012-key-repres">GOST R 34.10-2012 Key Representation</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a class="auto internal xref" href="#section-5.1">5.1</a>.  <a class="internal xref" href="#name-masking-gost-r-3410-2012-ke">Masking GOST R 34.10-2012 Keys</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a class="auto internal xref" href="#section-5.2">5.2</a>.  <a class="internal xref" href="#name-keybag-structure-for-gost-r">KeyBag Structure for GOST R 34.10-2012 Key</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a class="auto internal xref" href="#section-5.3">5.3</a>.  <a class="internal xref" href="#name-oneasymmetrickey-structure">OneAsymmetricKey Structure</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a class="auto internal xref" href="#section-5.4">5.4</a>.  <a class="internal xref" href="#name-encryptedprivatekeyinfo-str">EncryptedPrivateKeyInfo Structure for GOST R 34.10-2012 Key</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a class="auto internal xref" href="#section-6">6</a>.  <a class="internal xref" href="#name-gost-r-3410-2012-certificat">GOST R 34.10-2012 Certificate Representation</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a class="auto internal xref" href="#section-7">7</a>.  <a class="internal xref" href="#name-security-mechanisms">Security Mechanisms</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a class="auto internal xref" href="#section-8">8</a>.  <a class="internal xref" href="#name-security-considerations">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a class="auto internal xref" href="#section-9">9</a>.  <a class="internal xref" href="#name-iana-considerations">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a class="auto internal xref" href="#section-10">10</a>. <a class="internal xref" href="#name-asn1-modules">ASN.1 Modules</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a class="auto internal xref" href="#section-11">11</a>. <a class="internal xref" href="#name-references">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a class="auto internal xref" href="#section-11.1">11.1</a>.  <a class="internal xref" href="#name-normative-references">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a class="auto internal xref" href="#section-11.2">11.2</a>.  <a class="internal xref" href="#name-informative-references">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a class="auto internal xref" href="#appendix-A">Appendix A</a>.  <a class="internal xref" href="#name-examples">Examples</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a class="auto internal xref" href="#appendix-A.1">A.1</a>.  <a class="internal xref" href="#name-test-data">Test Data</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1.2.1">
                    <p id="section-toc.1-1.12.2.1.2.1.1"><a class="auto internal xref" href="#appendix-A.1.1">A.1.1</a>.  <a class="internal xref" href="#name-test-certificate">Test Certificate</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1.2.2">
                    <p id="section-toc.1-1.12.2.1.2.2.1"><a class="auto internal xref" href="#appendix-A.1.2">A.1.2</a>.  <a class="internal xref" href="#name-test-key">Test Key</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a class="auto internal xref" href="#appendix-A.2">A.2</a>.  <a class="internal xref" href="#name-example-of-a-pfx-with-a-pas">Example of a PFX with a Password-Protected Key and Unencrypted Certificate</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2.2.1">
                    <p id="section-toc.1-1.12.2.2.2.1.1"><a class="auto internal xref" href="#appendix-A.2.1">A.2.1</a>.  <a class="internal xref" href="#name-pfx-in-base64-format">PFX in BASE64 Format</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2.2.2">
                    <p id="section-toc.1-1.12.2.2.2.2.1"><a class="auto internal xref" href="#appendix-A.2.2">A.2.2</a>.  <a class="internal xref" href="#name-pfx-in-asn1-format">PFX in ASN.1 Format</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2.2.3">
                    <p id="section-toc.1-1.12.2.2.2.3.1"><a class="auto internal xref" href="#appendix-A.2.3">A.2.3</a>.  <a class="internal xref" href="#name-decrypted-key-value-in-base">Decrypted Key Value in BASE64 Format</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2.2.4">
                    <p id="section-toc.1-1.12.2.2.2.4.1"><a class="auto internal xref" href="#appendix-A.2.4">A.2.4</a>.  <a class="internal xref" href="#name-decrypted-key-value-in-asn1">Decrypted Key Value in ASN.1 Format</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.3">
                <p id="section-toc.1-1.12.2.3.1"><a class="auto internal xref" href="#appendix-A.3">A.3</a>.  <a class="internal xref" href="#name-example-of-a-pfx-with-a-pass">Example of a PFX with a Password-Protected Key and a Password-Protected Certificate</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.3.2.1">
                    <p id="section-toc.1-1.12.2.3.2.1.1"><a class="auto internal xref" href="#appendix-A.3.1">A.3.1</a>.  <a class="internal xref" href="#name-pfx-in-base64-format-2">PFX in BASE64 Format</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.3.2.2">
                    <p id="section-toc.1-1.12.2.3.2.2.1"><a class="auto internal xref" href="#appendix-A.3.2">A.3.2</a>.  <a class="internal xref" href="#name-pfx-in-asn1-format-2">PFX in ASN.1 Format</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.3.2.3">
                    <p id="section-toc.1-1.12.2.3.2.3.1"><a class="auto internal xref" href="#appendix-A.3.3">A.3.3</a>.  <a class="internal xref" href="#name-decrypted-key-value-in-base6">Decrypted Key Value in BASE64 Format</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.3.2.4">
                    <p id="section-toc.1-1.12.2.3.2.4.1"><a class="auto internal xref" href="#appendix-A.3.4">A.3.4</a>.  <a class="internal xref" href="#name-decrypted-key-value-in-asn1-">Decrypted Key Value in ASN.1 Format</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a class="auto internal xref" href="#appendix-B"></a><a class="internal xref" href="#name-acknowledgments">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a class="auto internal xref" href="#appendix-C"></a><a class="internal xref" href="#name-authors-address">Author's Address</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="Introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a class="section-number selfRef" href="#section-1">1. </a><a class="section-name selfRef" href="#name-introduction">Introduction</a>
      </h2>
<p id="section-1-1">
            This document provides a specification of the usage of GOST algorithms with PKCS #12 v1.1.<a class="pilcrow" href="#section-1-1">¶</a></p>
<p id="section-1-2">
            PKCS #12 v1.1 describes a syntax for transfer of personal information such as private keys, certificates, and various secrets.<a class="pilcrow" href="#section-1-2">¶</a></p>
<p id="section-1-3"> 
This memo describes the creation of transport key containers (PFX) for keys and certificates using the GOST R 34.10-2012 algorithm.
The GOST R 34.11-2012 algorithm is used to ensure the integrity of PFX.<a class="pilcrow" href="#section-1-3">¶</a></p>
<p id="section-1-4">
      Caution:<a class="pilcrow" href="#section-1-4">¶</a></p>
<p id="section-1-5">
      This specification is not a standard and does not have IETF community
      consensus. It makes use of a cryptographic algorithm that is a national
      standard for Russia. Neither the IETF nor the IRTF has analyzed that algorithm
      for suitability for any given application, and it may contain either intended
      or unintended weaknesses.<a class="pilcrow" href="#section-1-5">¶</a></p>
</section>
</div>
<section id="section-2">
      <h2 id="name-conventions-used-in-this-do">
<a class="section-number selfRef" href="#section-2">2. </a><a class="section-name selfRef" href="#name-conventions-used-in-this-do">Conventions Used in This Document</a>
      </h2>
<p id="section-2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>",
       "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>",
       "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>",
       "<span class="bcp14">SHOULD NOT</span>",
       "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
       "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document
       are to be interpreted as described in BCP 14
       <span>[<a class="cite xref" href="#RFC2119">RFC2119</a>]</span> <span>[<a class="cite xref" href="#RFC8174">RFC8174</a>]</span> when, and only
       when, they appear in all capitals, as shown here.<a class="pilcrow" href="#section-2-1">¶</a></p>
</section>
<div id="Definition">
<section id="section-3">
      <h2 id="name-basic-terms-and-definitions">
<a class="section-number selfRef" href="#section-3">3. </a><a class="section-name selfRef" href="#name-basic-terms-and-definitions">Basic Terms and Definitions</a>
      </h2>
<p id="section-3-1">
           Throughout this document, the following notations are used:<a class="pilcrow" href="#section-3-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3-2">
        <dt id="section-3-2.1">P</dt>
        <dd id="section-3-2.2" style="margin-left: 1.5em">a password encoded as a Unicode UTF-8 string<a class="pilcrow" href="#section-3-2.2">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-2.3">S</dt>
        <dd id="section-3-2.4" style="margin-left: 1.5em">a random initializing value<a class="pilcrow" href="#section-3-2.4">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-2.5">V<sub>s</sub>
</dt>
        <dd id="section-3-2.6" style="margin-left: 1.5em">the set of byte strings of length s, where s &gt;= 0; the string b = (b<sub>1</sub>,...,b<sub>s</sub>) belongs to the set V<sub>s</sub> if b<sub>1</sub>,...,b<sub>s</sub> belongs to {0,...,255}<a class="pilcrow" href="#section-3-2.6">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-2.7">|A|</dt>
        <dd id="section-3-2.8" style="margin-left: 1.5em">the number of components (a length) of the vector A belonging to V<sub>s</sub> (if A is an empty string, then |A| = 0)<a class="pilcrow" href="#section-3-2.8">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-2.9">A||C</dt>
        <dd id="section-3-2.10" style="margin-left: 1.5em">a concatenation of two byte strings A, C from V<sub>s</sub>, i.e.,
            a string from V<sub>|A|+|C|</sub>, where the left substring from V<sub>|A|</sub>
            is equal to the string A and the right substring from V<sub>|C|</sub> is
            equal to the string C: A = (a<sub>1</sub>,...,a<sub>n<sub>1</sub></sub>) in V<sub>n<sub>1</sub></sub> and C =
           (c<sub>1</sub>,...,c<sub>n<sub>2</sub></sub>) in V<sub>n<sub>2</sub></sub>, res = (a<sub>1</sub>,...,a<sub>n<sub>1</sub></sub>,c<sub>1</sub>,...,c<sub>n<sub>2</sub></sub>) in V<sub>n<sub>1</sub>+n<sub>2</sub></sub><a class="pilcrow" href="#section-3-2.10">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-2.11">F_q</dt>
        <dd id="section-3-2.12" style="margin-left: 1.5em">a finite prime field represented as a set of q integers {0,1,...,q - 1}, where q &gt; 3 - prime number<a class="pilcrow" href="#section-3-2.12">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-2.13">b mod q</dt>
        <dd id="section-3-2.14" style="margin-left: 1.5em">the minimum non-negative number comparable to b modulo p<a class="pilcrow" href="#section-3-2.14">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-2.15">INT(b)</dt>
        <dd id="section-3-2.16" style="margin-left: 1.5em">integer INT(b) = b<sub>1</sub> + b<sub>2</sub> * 256 +...+ b<sub>s</sub> * 256<sup>s-1</sup>, where b belongs to V<sub>s</sub><a class="pilcrow" href="#section-3-2.16">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-3-3">
      This document uses the following terms and abbreviations:<a class="pilcrow" href="#section-3-3">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3-4">
        <dt id="section-3-4.1">Signature</dt>
        <dd id="section-3-4.2" style="margin-left: 1.5em">one or more data elements resulting from the signature process (Clause 3.12 of <span>[<a class="cite xref" href="#ISO14888-1">ISO14888-1</a>]</span>).
            Note: The terms "digital signature", "electronic signature", and "electronic digital signature" are considered
            equivalent in this document.<a class="pilcrow" href="#section-3-4.2">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-4.3">Signature key</dt>
        <dd id="section-3-4.4" style="margin-left: 1.5em">set of private data elements specific to an entity and usable only by this entity 
                    in the signature process (Clause 3.13 of <span>[<a class="cite xref" href="#ISO14888-1">ISO14888-1</a>]</span>).
                    Note: Sometimes called a private key.<a class="pilcrow" href="#section-3-4.4">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-4.5">Verification key</dt>
        <dd id="section-3-4.6" style="margin-left: 1.5em">set of public data elements that is mathematically related to an entity's signature key
                    and is used by the verifier in the verification process (Clause 3.16 of <span>[<a class="cite xref" href="#ISO14888-1">ISO14888-1</a>]</span>).
                    Note: Sometimes called a public key.<a class="pilcrow" href="#section-3-4.6">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-4.7">ASN.1</dt>
        <dd id="section-3-4.8" style="margin-left: 1.5em">Abstract Syntax Notation One, as defined in <span>[<a class="cite xref" href="#X.680">X.680</a>]</span>.<a class="pilcrow" href="#section-3-4.8">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-4.9">BER</dt>
        <dd id="section-3-4.10" style="margin-left: 1.5em">Basic Encoding Rules, as defined in <span>[<a class="cite xref" href="#X.690">X.690</a>]</span>.<a class="pilcrow" href="#section-3-4.10">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-4.11">HMAC_GOSTR3411</dt>
        <dd id="section-3-4.12" style="margin-left: 1.5em">Hash-Based Message Authentication Code. A
            function for calculating a Message Authentication Code (MAC) based
            on the GOST R 34.11-2012 hash function (see <span>[<a class="cite xref" href="#RFC6986">RFC6986</a>]</span>) with 512-bit output in accordance with <span>[<a class="cite xref" href="#RFC2104">RFC2104</a>]</span>.<a class="pilcrow" href="#section-3-4.12">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
</section>
</div>
<div id="PFX">
<section id="section-4">
      <h2 id="name-pfx">
<a class="section-number selfRef" href="#section-4">4. </a><a class="section-name selfRef" href="#name-pfx">PFX</a>
      </h2>
<p id="section-4-1">
            The PFX (see <span>[<a class="cite xref" href="#RFC7292">RFC7292</a>]</span>) is designed for secure storage and data transfer. 
           The scope of this document is to define how PFX is used for private key and certificate protection with a password when GOST R 34.10-2012 is applied.<a class="pilcrow" href="#section-4-1">¶</a></p>
<div id="StrucurePFX">
<section id="section-4.1">
        <h3 id="name-structure-of-pfx">
<a class="section-number selfRef" href="#section-4.1">4.1. </a><a class="section-name selfRef" href="#name-structure-of-pfx">Structure of PFX</a>
        </h3>
<p id="section-4.1-1">In accordance with <span>[<a class="cite xref" href="#RFC7292">RFC7292</a>]</span>, PFX has the following structure:<a class="pilcrow" href="#section-4.1-1">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-4.1-2">
<pre>PFX ::= SEQUENCE
{
    version     INTEGER {v3(3)}(v3,...),
    authSafe    ContentInfo,
    macData     MacData OPTIONAL
}
</pre><a class="pilcrow" href="#section-4.1-2">¶</a>
</div>
<p id="section-4.1-3">The fields of the PFX have the following meanings:<a class="pilcrow" href="#section-4.1-3">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-4.1">version is the syntax version number; the only allowed value for this specification is 3.<a class="pilcrow" href="#section-4.1-4.1">¶</a>
</li>
          <li class="normal" id="section-4.1-4.2">authSafe contains the data of type ContentInfo. In the case of password integrity mode, the authSafe.content field has a Data type value and contains a BER-encoded value of the AuthenticatedSafe structure.<a class="pilcrow" href="#section-4.1-4.2">¶</a>
</li>
          <li class="normal" id="section-4.1-4.3">macData has a MacData type; in the case of password integrity mode, the macData field should contain information about the algorithm and parameters for password key generation.
                        Integrity control is ensured by using the HMAC_GOSTR3411_2012_512 algorithm: the macData.mac.digestAlgorithm.algorithm field contains the HMAC_GOSTR3411_2012_512 algorithm identifier (see <a class="auto internal xref" href="#SecurityM">Section 7</a>). 
                        When processing PFX, this field should be checked first.<a class="pilcrow" href="#section-4.1-4.3">¶</a>
</li>
        </ul>
</section>
</div>
<div id="AuthenticatedSafe">
<section id="section-4.2">
        <h3 id="name-authenticatedsafe">
<a class="section-number selfRef" href="#section-4.2">4.2. </a><a class="section-name selfRef" href="#name-authenticatedsafe">AuthenticatedSafe</a>
        </h3>
<p id="section-4.2-1">The AuthenticatedSafe structure is a sequence of ContentInfo values (see <span>[<a class="cite xref" href="#RFC5652">RFC5652</a>]</span>):<a class="pilcrow" href="#section-4.2-1">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-4.2-2">
<pre>AuthenticatedSafe ::= SEQUENCE OF ContentInfo
   -- Data if unencrypted
   -- EncryptedData if password-encrypted
   -- EnvelopedData if public key-encrypted
</pre><a class="pilcrow" href="#section-4.2-2">¶</a>
</div>
<div id="Unencrypted">
<section id="section-4.2.1">
          <h4 id="name-unencrypted-data">
<a class="section-number selfRef" href="#section-4.2.1">4.2.1. </a><a class="section-name selfRef" href="#name-unencrypted-data">Unencrypted Data</a>
          </h4>
<p id="section-4.2.1-1">If the data is not encrypted, then the content field is the BER-encoded value of the SafeContents structure. The contentType field is set to the id-data type.<a class="pilcrow" href="#section-4.2.1-1">¶</a></p>
</section>
</div>
<div id="Password-encrypted">
<section id="section-4.2.2">
          <h4 id="name-password-encrypted-data">
<a class="section-number selfRef" href="#section-4.2.2">4.2.2. </a><a class="section-name selfRef" href="#name-password-encrypted-data">Password-Encrypted Data</a>
          </h4>
<p id="section-4.2.2-1">When password integrity mode is used, the data is represented as an EncryptedData structure (see <span>[<a class="cite xref" href="#RFC5652">RFC5652</a>]</span>). 
               The encryption algorithm and parameters have the following values:<a class="pilcrow" href="#section-4.2.2-1">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-4.2.2-2">
<pre>ContentEncryptionAlgorithmIdentifier ::= SEQUENCE
{
    encryptionAlgorithmOID  OBJECT IDENTIFIER,
    parameters              PBES2-params
}
</pre><a class="pilcrow" href="#section-4.2.2-2">¶</a>
</div>
<p id="section-4.2.2-3">The PBES2-params type is defined in <span>[<a class="cite xref" href="#RFC9337">RFC9337</a>]</span>. The content should be encrypted according to the encryption algorithm in the PBES2 scheme, as described in <span>[<a class="cite xref" href="#RFC9337">RFC9337</a>]</span>.
                The following identifier <span class="bcp14">MUST</span> be specified in the EncryptedData.EncryptedContentInfo.contentEncryptionAlgorithm.<br/>
encryptionAlgorithmOID field:<a class="pilcrow" href="#section-4.2.2-3">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-4.2.2-4">
<pre>{
    iso(1) member-body(2) us(840) rsadsi(113549)
    pkcs(1) pkcs-5(5) pbes2(13)
}
</pre><a class="pilcrow" href="#section-4.2.2-4">¶</a>
</div>
<p id="section-4.2.2-5">The encrypted content is specified in the EncryptedData.EncryptedContentInfo.encryptedContent field.<a class="pilcrow" href="#section-4.2.2-5">¶</a></p>
</section>
</div>
</section>
</div>
<div id="SC">
<section id="section-4.3">
        <h3 id="name-safecontents-and-safebag">
<a class="section-number selfRef" href="#section-4.3">4.3. </a><a class="section-name selfRef" href="#name-safecontents-and-safebag">SafeContents and SafeBag</a>
        </h3>
<p id="section-4.3-1">In accordance with <span>[<a class="cite xref" href="#RFC7292">RFC7292</a>]</span>, the SafeContents structure is a sequence of SafeBag:<a class="pilcrow" href="#section-4.3-1">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-4.3-2">
<pre>SafeContents ::= SEQUENCE OF SafeBag
</pre><a class="pilcrow" href="#section-4.3-2">¶</a>
</div>
<p id="section-4.3-3">where<a class="pilcrow" href="#section-4.3-3">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-4.3-4">
<pre>SafeBag ::= SEQUENCE
{
    bagId         BAG-TYPE.&amp;id ({PKCS12BagSet})
    bagValue [0]  EXPLICIT BAG-TYPE.&amp;Type({PKCS12BagSet}{@bagId})
    bagAttributes SET OF PKCS12Attribute OPTIONAL
}
</pre><a class="pilcrow" href="#section-4.3-4">¶</a>
</div>
<p id="section-4.3-5">The fields of SafeBag have the following meanings:<a class="pilcrow" href="#section-4.3-5">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3-6.1">bagId is an object identifier; it defines the type of object.<a class="pilcrow" href="#section-4.3-6.1">¶</a>
</li>
          <li class="normal" id="section-4.3-6.2">bagValue is the value of an object.<a class="pilcrow" href="#section-4.3-6.2">¶</a>
</li>
          <li class="normal" id="section-4.3-6.3">bagAttributes contains the users' names, the key identifiers, and other additional information. This field is optional.<a class="pilcrow" href="#section-4.3-6.3">¶</a>
</li>
        </ul>
<p id="section-4.3-7">See <span>[<a class="cite xref" href="#RFC7292">RFC7292</a>], <a class="relref" href="https://rfc-editor.org/rfc/rfc7292#section-4.2">Section 4.2</a></span>
for the different bag types.
                This document describes the two object types of the SafeBag structure:<a class="pilcrow" href="#section-4.3-7">¶</a></p>
<ol class="normal type-1" id="section-4.3-8" start="1" type="1">
                    <li id="section-4.3-8.1">pkcs8ShroudedKeyBag<a class="pilcrow" href="#section-4.3-8.1">¶</a>
</li>
          <li id="section-4.3-8.2">certBag<a class="pilcrow" href="#section-4.3-8.2">¶</a>
</li>
        </ol>
<p id="section-4.3-9">When password integrity mode is used, the private key has the following structure:<a class="pilcrow" href="#section-4.3-9">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-4.3-10">
<pre>pkcs8ShroudedKeyBag BAG-TYPE ::=
{
    PKCS8ShroudedKeyBag IDENTIFIED BY {bagtypes 2}
}
</pre><a class="pilcrow" href="#section-4.3-10">¶</a>
</div>
<p id="section-4.3-11">The bagValue field contains the key and information about the key, in encrypted form, in the EncryptedPrivateKeyInfo structure.<a class="pilcrow" href="#section-4.3-11">¶</a></p>
<p id="section-4.3-12">A certBag contains a certificate of a certain type. Object identifiers are used to distinguish between different certificate types.<a class="pilcrow" href="#section-4.3-12">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-4.3-13">
<pre>certBag BAG-TYPE ::=
{
    CertBag IDENTIFIED BY { bagtypes 3 }
}
</pre><a class="pilcrow" href="#section-4.3-13">¶</a>
</div>
<p id="section-4.3-14">If the certificate is not encrypted, the CertBag structure is placed in the Data structure (see <span>[<a class="cite xref" href="#RFC5652">RFC5652</a>]</span>).
                If the certificate is encrypted, the CertBag structure is placed in the EncryptedData structure (see <span>[<a class="cite xref" href="#RFC5652">RFC5652</a>]</span>).<a class="pilcrow" href="#section-4.3-14">¶</a></p>
</section>
</div>
</section>
</div>
<div id="Key_repres">
<section id="section-5">
      <h2 id="name-gost-r-3410-2012-key-repres">
<a class="section-number selfRef" href="#section-5">5. </a><a class="section-name selfRef" href="#name-gost-r-3410-2012-key-repres">GOST R 34.10-2012 Key Representation</a>
      </h2>
<p id="section-5-1">This section describes the GOST R 34.10-2012 private key representation for asymmetric key pairs.
            Masked keys should be used to ensure that private keys are protected from leaking through side channels when reading and performing operations with keys.<a class="pilcrow" href="#section-5-1">¶</a></p>
<div id="Key_mask">
<section id="section-5.1">
        <h3 id="name-masking-gost-r-3410-2012-ke">
<a class="section-number selfRef" href="#section-5.1">5.1. </a><a class="section-name selfRef" href="#name-masking-gost-r-3410-2012-ke">Masking GOST R 34.10-2012 Keys</a>
        </h3>
<p id="section-5.1-1">The masking algorithm is defined by the basic cryptographic transformation operation of the algorithm: multiplication in the F_q field for  GOST R 34.10-2012 keys.<a class="pilcrow" href="#section-5.1-1">¶</a></p>
<p id="section-5.1-2">Let M<sub>1</sub>, M<sub>2</sub>, ..., M<sub>k</sub> be a sequence of k masks. Let M<sub>i</sub>() denote the operation of applying the i-th mask and M<sub>i</sub><sup>-1</sup>() denote the operation of removing the i-th mask, 1 &lt;= i &lt;= k.
                Let K be a key. The masked key K<sub>M</sub> is obtained by applying the masking operation k times:<a class="pilcrow" href="#section-5.1-2">¶</a></p>
<p id="section-5.1-3" style="margin-left: 1.5em">K<sub>M</sub> = M<sub>k</sub> (...(M<sub>2</sub>(M<sub>1</sub>(K)...).<a class="pilcrow" href="#section-5.1-3">¶</a></p>
<p id="section-5.1-4">Unmasking is performed by applying the removal operation k times, but in reverse order:<a class="pilcrow" href="#section-5.1-4">¶</a></p>
<p id="section-5.1-5" style="margin-left: 1.5em">K = M<sub>1</sub><sup>-1</sup>(...(M<sub>k-1</sub><sup>-1</sup>(M<sub>k</sub><sup>-1</sup>(K<sub>M</sub>))...).<a class="pilcrow" href="#section-5.1-5">¶</a></p>
<p id="section-5.1-6">The masked key is represented as the sequence<a class="pilcrow" href="#section-5.1-6">¶</a></p>
<p id="section-5.1-7" style="margin-left: 1.5em">I = K<sub>M</sub>||M<sub>1</sub>||M<sub>2</sub>||...||M<sub>k</sub>.<a class="pilcrow" href="#section-5.1-7">¶</a></p>
<p id="section-5.1-8">Let the key K be n bits in length; then, the sequence I is represented in memory as a sequence of (k + 1)*n bits. I is represented in little-endian format.
                It is possible to use an unmasked private key (i.e., k = 0, K<sub>M</sub> = K).
                For GOST R 34.10-2012 keys, the masking operation is the multiplication of the key by the inverse of the mask: INT(K<sub>M</sub>) = INT(K) * INT(M)<sup>-1</sup> mod Q, where the Q value is taken from the key parameters.
                The operation of removing the mask is the multiplication of the masked key by the mask: INT(K) = INT(K<sub>M</sub>) * INT(M) mod Q.
                The public key is specified by a pair of coordinates (x, y) as defined in GOST R 34.10-2012, presented in the following format:<a class="pilcrow" href="#section-5.1-8">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1-9.1">a public key corresponding to the GOST R 34.10-2012 algorithm with a key length of 256 bits 
                has the GostR3410-2012-256-PublicKey representation. It is specified by a 64-byte string, where the first 32 bytes contain the little-endian representation of the x coordinate
                and the last 32 bytes contain the little-endian representation of the y coordinate.<a class="pilcrow" href="#section-5.1-9.1">¶</a>
</li>
          <li class="normal" id="section-5.1-9.2">a public key corresponding to the GOST R 34.10-2012 algorithm with a key length of 512 bits 
                has the GostR3410-2012-512-PublicKey representation. It is specified by a 128-byte string, where the first 64 bytes contain the little-endian representation of the x coordinate
                and the last 64 bytes contain the little-endian representation of the y coordinate.<a class="pilcrow" href="#section-5.1-9.2">¶</a>
</li>
        </ul>
<p id="section-5.1-10">The public keys GostR3410-2012-256-PublicKey and GostR3410-2012-512-PublicKey <span class="bcp14">MUST</span> be DER encoded as an octet string in accordance with <span><a class="relref" href="https://rfc-editor.org/rfc/rfc9215#section-4.3">Section 4.3</a> of [<a class="cite xref" href="#RFC9215">RFC9215</a>]</span>:<a class="pilcrow" href="#section-5.1-10">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-5.1-11">
<pre>   GostR3410-2012-256-PublicKey ::= OCTET STRING (64),
   GostR3410-2012-512-PublicKey ::= OCTET STRING (128).
</pre><a class="pilcrow" href="#section-5.1-11">¶</a>
</div>
</section>
</div>
<div id="KeyBag">
<section id="section-5.2">
        <h3 id="name-keybag-structure-for-gost-r">
<a class="section-number selfRef" href="#section-5.2">5.2. </a><a class="section-name selfRef" href="#name-keybag-structure-for-gost-r">KeyBag Structure for GOST R 34.10-2012 Key</a>
        </h3>
<p id="section-5.2-1">
                In accordance with <span>[<a class="cite xref" href="#RFC7292">RFC7292</a>]</span>, a KeyBag is defined as information about a private key represented as the PrivateKeyInfo structure:<a class="pilcrow" href="#section-5.2-1">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-5.2-2">
<pre>KeyBag ::= PrivateKeyInfo
</pre><a class="pilcrow" href="#section-5.2-2">¶</a>
</div>
<p id="section-5.2-3">In accordance with <span>[<a class="cite xref" href="#RFC5958">RFC5958</a>]</span>, information about a private key is presented in the following form:<a class="pilcrow" href="#section-5.2-3">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-5.2-4">
<pre>PrivateKeyInfo ::= OneAsymmetricKey
</pre><a class="pilcrow" href="#section-5.2-4">¶</a>
</div>
</section>
</div>
<div id="OneAsymmetricKey">
<section id="section-5.3">
        <h3 id="name-oneasymmetrickey-structure">
<a class="section-number selfRef" href="#section-5.3">5.3. </a><a class="section-name selfRef" href="#name-oneasymmetrickey-structure">OneAsymmetricKey Structure</a>
        </h3>
<p id="section-5.3-1">In accordance with <span>[<a class="cite xref" href="#RFC5958">RFC5958</a>]</span>, OneAsymmetricKey has the following structure:<a class="pilcrow" href="#section-5.3-1">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-5.3-2">
<pre>OneAsymmetricKey::= SEQUENCE
{
    version                 Version,
    privateKeyAlgorithm     PrivateKeyAlgorithmIdentifier,
    privateKey              PrivateKey,
    attributes              [0] Attributes OPTIONAL,
    ...,
    [[2:publicKey           [1] PublicKey OPTIONAL]],
    ...
}
Version ::= INTEGER { v1(0), v2(1) } (v1, ..., v2)
PrivateKeyAlgorithmIdentifier ::= AlgorithmIdentifier
PrivateKey ::= OCTET STRING
PublicKey ::= BIT STRING
Attributes ::= SET OF Attribute
</pre><a class="pilcrow" href="#section-5.3-2">¶</a>
</div>
<p id="section-5.3-3">The fields have the following meanings:<a class="pilcrow" href="#section-5.3-3">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3-4.1">version identifies the version of OneAsymmetricKey. If publicKey is present, then version is set to 2; else, version is set to 1.<a class="pilcrow" href="#section-5.3-4.1">¶</a>
</li>
          <li class="normal" id="section-5.3-4.2">privateKeyAlgorithm identifies the private key algorithm and optionally contains parameters associated with the asymmetric key
                pair. For GOST R 34.10-2012 private keys, the identifiers of the corresponding public keys are used; they are defined in <span>[<a class="cite xref" href="#RFC9215">RFC9215</a>]</span>. 
                The use of identifiers and public key parameters is defined in <span>[<a class="cite xref" href="#RFC9215">RFC9215</a>]</span>.<a class="pilcrow" href="#section-5.3-4.2">¶</a>
</li>
          <li class="normal" id="section-5.3-4.3">privateKey is an OCTET STRING that contains the value of the masked private key I.<a class="pilcrow" href="#section-5.3-4.3">¶</a>
</li>
          <li class="normal" id="section-5.3-4.4">attributes are optional. They contain information corresponding to the public key (e.g., certificates).<a class="pilcrow" href="#section-5.3-4.4">¶</a>
</li>
          <li class="normal" id="section-5.3-4.5">publicKey contains the value of the public key GostR3410-2012-256-PublicKey or GostR3410-2012-512-PublicKey encoded in a BIT STRING. This field is optional.<a class="pilcrow" href="#section-5.3-4.5">¶</a>
</li>
        </ul>
</section>
</div>
<div id="PKCS8ShroudedKeyBag">
<section id="section-5.4">
        <h3 id="name-encryptedprivatekeyinfo-str">
<a class="section-number selfRef" href="#section-5.4">5.4. </a><a class="section-name selfRef" href="#name-encryptedprivatekeyinfo-str">EncryptedPrivateKeyInfo Structure for GOST R 34.10-2012 Key</a>
        </h3>
<p id="section-5.4-1">In accordance with <span>[<a class="cite xref" href="#RFC7292">RFC7292</a>]</span>, the encrypted information regarding the private key is defined as the PKCS8ShroudedKeyBag structure:<a class="pilcrow" href="#section-5.4-1">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-5.4-2">
<pre>PKCS8ShroudedKeyBag::= EncryptedPrivateKeyInfo
</pre><a class="pilcrow" href="#section-5.4-2">¶</a>
</div>
<p id="section-5.4-3">In accordance with <span>[<a class="cite xref" href="#RFC5958">RFC5958</a>]</span>, EncryptedPrivateKeyInfo has the following structure:<a class="pilcrow" href="#section-5.4-3">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-5.4-4">
<pre>EncryptedPrivateKeyInfo ::= SEQUENCE
{
    encryptionAlgorithm EncryptionAlgorithmIdentifier,
    encryptedData       EncryptedData
}
EncryptionAlgorithmIdentifier ::= AlgorithmIdentifier
EncryptedData ::= OCTET STRING
</pre><a class="pilcrow" href="#section-5.4-4">¶</a>
</div>
<p id="section-5.4-5">The fields have the following meanings:<a class="pilcrow" href="#section-5.4-5">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.4-6.1">encryptionAlgorithm identifies the algorithm under which the private key information is encrypted. Encryption <span class="bcp14">MUST</span> use the PBES2 scheme. The algorithm and parameters of this scheme are presented in <span>[<a class="cite xref" href="#RFC9337">RFC9337</a>]</span>.<a class="pilcrow" href="#section-5.4-6.1">¶</a>
</li>
          <li class="normal" id="section-5.4-6.2">encryptedData is the DER-encoded PrivateKeyInfo structure.<a class="pilcrow" href="#section-5.4-6.2">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="Cert_repres">
<section id="section-6">
      <h2 id="name-gost-r-3410-2012-certificat">
<a class="section-number selfRef" href="#section-6">6. </a><a class="section-name selfRef" href="#name-gost-r-3410-2012-certificat">GOST R 34.10-2012 Certificate Representation</a>
      </h2>
<p id="section-6-1">
        In accordance with <span>[<a class="cite xref" href="#RFC7292">RFC7292</a>]</span>, a CertBag is defined as information about a certificate and has the following structure:<a class="pilcrow" href="#section-6-1">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-6-2">
<pre>CertBag ::= SEQUENCE
{
    certId                  BAG-TYPE.&amp;id ({CertTypes}),
    certValue [0] EXPLICIT  BAG-TYPE.&amp;Type ({CertTypes}{@certId})
}
</pre><a class="pilcrow" href="#section-6-2">¶</a>
</div>
<p id="section-6-3">The fields have the following meanings:<a class="pilcrow" href="#section-6-3">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6-4.1">certId identifies the type of certificate.<a class="pilcrow" href="#section-6-4.1">¶</a>
</li>
        <li class="normal" id="section-6-4.2">certValue contains the certificate.<a class="pilcrow" href="#section-6-4.2">¶</a>
</li>
      </ul>
</section>
</div>
<div id="SecurityM">
<section id="section-7">
      <h2 id="name-security-mechanisms">
<a class="section-number selfRef" href="#section-7">7. </a><a class="section-name selfRef" href="#name-security-mechanisms">Security Mechanisms</a>
      </h2>
<p id="section-7-1">Let the sender and receiver have a previously agreed-upon password P. The sender generates a password key using the PBKDF2 algorithm in accordance with <span>[<a class="cite xref" href="#RFC9337">RFC9337</a>]</span> and uses it to encrypt the transmitted private key.
        The recipient independently generates a password key using the same PBKDF2 diversification algorithm in accordance with <span>[<a class="cite xref" href="#RFC9337">RFC9337</a>]</span> and uses it to extract the private key from the PFX.<a class="pilcrow" href="#section-7-1">¶</a></p>
<p id="section-7-2">The same password P is used to encrypt different sections of the PFX using a different random initializing value S with a length of 8 to 32 bytes, 
        where S and P are the input parameters of the PBKDF2 function. The password <span class="bcp14">MUST</span> be encoded as a Unicode UTF-8 string and fed into the PBKDF2 algorithm as a P parameter.<a class="pilcrow" href="#section-7-2">¶</a></p>
<p id="section-7-3">The integrity of the PFX is ensured by using the HMAC_GOSTR3411_2012_512 algorithm in accordance with <span>[<a class="cite xref" href="#RFC7836">RFC7836</a>]</span>. To check the integrity of the PFX with the HMAC_GOSTR3411_2012_512 algorithm,
        the key for this algorithm is also generated by using the PBKDF2 algorithm in accordance with <span>[<a class="cite xref" href="#RFC9337">RFC9337</a>]</span>, with the same value for the P parameter and a different initializing value S with a length of 8 to 32 bytes.
        The dkLen parameter for the PBKDF2 algorithm is set to 96 bytes. The key for the HMAC_GOSTR3411_2012_512 algorithm must be the last 32 bytes of the 96-byte sequence generated by the PBKDF2 algorithm.
        The PBKDF2 algorithm parameters S and c are saved in the macData.Salt and macData.iterations fields, respectively. 
        The HMAC_GOSTR3411_2012_512 function is calculated from the content field of the authSafe structure field. The authSafe structure field is a PFX structure field.
        The value of the calculated checksum is saved in the macData.mac.digest field. The macData.mac.digestAlgorithm.algorithm field contains the following algorithm identifier:<a class="pilcrow" href="#section-7-3">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-7-4">
<pre>id-tc26-gost3411-12-512 :: =
{
    iso(1) member-body(2) ru(643) rosstandart(7) tc26(1)
    algorithms(1) digest(2) gost3411-12-512(3)
}
</pre><a class="pilcrow" href="#section-7-4">¶</a>
</div>
<p id="section-7-5">The macData.mac.digestAlgorithm.parameters field isn't used and should be omitted.<a class="pilcrow" href="#section-7-5">¶</a></p>
</section>
</div>
<div id="Security">
<section id="section-8">
      <h2 id="name-security-considerations">
<a class="section-number selfRef" href="#section-8">8. </a><a class="section-name selfRef" href="#name-security-considerations">Security Considerations</a>
      </h2>
<p id="section-8-1">The masked keys <span class="bcp14">SHOULD</span> be used to ensure that private keys are protected from leaking through side channels when reading and performing operations with keys. 
        
        Applications <span class="bcp14">MUST</span> use unique values for ukm and S in the PBKDF2 algorithm.
        It is <span class="bcp14">RECOMMENDED</span> that parameter S consist of at least 32 octets of pseudorandom data in order to reduce the probability of collisions of keys generated from the same password.
        The password <span class="bcp14">MUST</span> be encoded as a Unicode UTF-8 string and fed into the PBKDF2 algorithm as a P parameter.
        For more information, see <span>[<a class="cite xref" href="#RFC9337">RFC9337</a>]</span>.
        
        Encryption <span class="bcp14">MUST</span> use the PBES2 scheme to encrypt private keys. Public keys <span class="bcp14">MUST</span> be DER encoded as an octet string in accordance with <span>[<a class="cite xref" href="#RFC9215">RFC9215</a>]</span>.
        Passwords <span class="bcp14">SHOULD</span> be stored in a secure way.
        For information on security considerations for generating PFX, see <span>[<a class="cite xref" href="#RFC7292">RFC7292</a>]</span>.<a class="pilcrow" href="#section-8-1">¶</a></p>
</section>
</div>
<div id="IANA_Considerations">
<section id="section-9">
      <h2 id="name-iana-considerations">
<a class="section-number selfRef" href="#section-9">9. </a><a class="section-name selfRef" href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<p id="section-9-1">This document has no IANA actions.<a class="pilcrow" href="#section-9-1">¶</a></p>
</section>
</div>
<div id="ASN">
<section id="section-10">
      <h2 id="name-asn1-modules">
<a class="section-number selfRef" href="#section-10">10. </a><a class="section-name selfRef" href="#name-asn1-modules">ASN.1 Modules</a>
      </h2>
<div class="lang-asn.1 sourcecode" id="section-10-1">
<pre>PKCS-12RU
{
    iso(1) member-body(2) ru(643) rosstandart(7)
    tc26(1) modules(0) pkcs-12ruSyntax(5)
}
DEFINITIONS EXPLICIT TAGS ::=
BEGIN
IMPORTS
    GostR3410-2012-PublicKey
FROM GostR3410-2012-PKISyntax
{
    iso(1) member-body(2) ru(643) rosstandart(7) tc26(1)
    modules(0) gostR3410-2012-PKISyntax(2)
};
END
</pre><a class="pilcrow" href="#section-10-1">¶</a>
</div>
</section>
</div>
<section id="section-11">
      <h2 id="name-references">
<a class="section-number selfRef" href="#section-11">11. </a><a class="section-name selfRef" href="#name-references">References</a>
      </h2>
<section id="section-11.1">
        <h3 id="name-normative-references">
<a class="section-number selfRef" href="#section-11.1">11.1. </a><a class="section-name selfRef" href="#name-normative-references">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2104">[RFC2104]</dt>
        <dd>
<span class="refAuthor">Krawczyk, H.</span>, <span class="refAuthor">Bellare, M.</span>, and <span class="refAuthor">R. Canetti</span>, <span class="refTitle">"HMAC: Keyed-Hashing for Message Authentication"</span>, <span class="seriesInfo">RFC 2104</span>, <span class="seriesInfo">DOI 10.17487/RFC2104</span>, <time class="refDate" datetime="1997-02">February 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2104">https://www.rfc-editor.org/info/rfc2104</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time class="refDate" datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5652">[RFC5652]</dt>
        <dd>
<span class="refAuthor">Housley, R.</span>, <span class="refTitle">"Cryptographic Message Syntax (CMS)"</span>, <span class="seriesInfo">STD 70</span>, <span class="seriesInfo">RFC 5652</span>, <span class="seriesInfo">DOI 10.17487/RFC5652</span>, <time class="refDate" datetime="2009-09">September 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5652">https://www.rfc-editor.org/info/rfc5652</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5958">[RFC5958]</dt>
        <dd>
<span class="refAuthor">Turner, S.</span>, <span class="refTitle">"Asymmetric Key Packages"</span>, <span class="seriesInfo">RFC 5958</span>, <span class="seriesInfo">DOI 10.17487/RFC5958</span>, <time class="refDate" datetime="2010-08">August 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5958">https://www.rfc-editor.org/info/rfc5958</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6986">[RFC6986]</dt>
        <dd>
<span class="refAuthor">Dolmatov, V., Ed.</span> and <span class="refAuthor">A. Degtyarev</span>, <span class="refTitle">"GOST R 34.11-2012: Hash Function"</span>, <span class="seriesInfo">RFC 6986</span>, <span class="seriesInfo">DOI 10.17487/RFC6986</span>, <time class="refDate" datetime="2013-08">August 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6986">https://www.rfc-editor.org/info/rfc6986</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7292">[RFC7292]</dt>
        <dd>
<span class="refAuthor">Moriarty, K., Ed.</span>, <span class="refAuthor">Nystrom, M.</span>, <span class="refAuthor">Parkinson, S.</span>, <span class="refAuthor">Rusch, A.</span>, and <span class="refAuthor">M. Scott</span>, <span class="refTitle">"PKCS #12: Personal Information Exchange Syntax v1.1"</span>, <span class="seriesInfo">RFC 7292</span>, <span class="seriesInfo">DOI 10.17487/RFC7292</span>, <time class="refDate" datetime="2014-07">July 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7292">https://www.rfc-editor.org/info/rfc7292</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7836">[RFC7836]</dt>
        <dd>
<span class="refAuthor">Smyshlyaev, S., Ed.</span>, <span class="refAuthor">Alekseev, E.</span>, <span class="refAuthor">Oshkin, I.</span>, <span class="refAuthor">Popov, V.</span>, <span class="refAuthor">Leontiev, S.</span>, <span class="refAuthor">Podobaev, V.</span>, and <span class="refAuthor">D. Belyavsky</span>, <span class="refTitle">"Guidelines on the Cryptographic Algorithms to Accompany the Usage of Standards GOST R 34.10-2012 and GOST R 34.11-2012"</span>, <span class="seriesInfo">RFC 7836</span>, <span class="seriesInfo">DOI 10.17487/RFC7836</span>, <time class="refDate" datetime="2016-03">March 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7836">https://www.rfc-editor.org/info/rfc7836</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time class="refDate" datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9215">[RFC9215]</dt>
        <dd>
<span class="refAuthor">Baryshkov, D., Ed.</span>, <span class="refAuthor">Nikolaev, V.</span>, and <span class="refAuthor">A. Chelpanov</span>, <span class="refTitle">"Using GOST R 34.10-2012 and GOST R 34.11-2012 Algorithms with the Internet X.509 Public Key Infrastructure"</span>, <span class="seriesInfo">RFC 9215</span>, <span class="seriesInfo">DOI 10.17487/RFC9215</span>, <time class="refDate" datetime="2022-03">March 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9215">https://www.rfc-editor.org/info/rfc9215</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9337">[RFC9337]</dt>
        <dd>
<span class="refAuthor">Karelina, E., Ed.</span>, <span class="refTitle">"Generating Password-Based Keys Using the GOST Algorithms"</span>, <span class="seriesInfo">RFC 9337</span>, <span class="seriesInfo">DOI 10.17487/RFC9337</span>, <time class="refDate" datetime="2022-12">December 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9337">https://www.rfc-editor.org/info/rfc9337</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="X.680">[X.680]</dt>
        <dd>
<span class="refAuthor">ITU-T</span>, <span class="refTitle">"Information Technology - Abstract Syntax Notation One (ASN.1): Specification of basic notation"</span>, <span class="seriesInfo">ITU-T Recommendation X.680</span>, <span class="seriesInfo">ISO/IEC 8824-1:2021</span>, <time class="refDate" datetime="2021-02">February 2021</time>, <span>&lt;<a href="https://www.itu.int/rec/T-REC-X.680">https://www.itu.int/rec/T-REC-X.680</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="X.690">[X.690]</dt>
      <dd>
<span class="refAuthor">ITU-T</span>, <span class="refTitle">"Information technology - ASN.1 encoding rules: Specification of Basic Encoding Rules (BER), Canonical Encoding Rules (CER) and Distinguished Encoding Rules (DER)"</span>, <span class="seriesInfo">ITU-T Recommendation X.690</span>, <span class="seriesInfo">ISO/IEC International Standard 8825-1:2021</span>, <time class="refDate" datetime="2021-02">February 2021</time>, <span>&lt;<a href="https://www.itu.int/rec/T-REC-X.690">https://www.itu.int/rec/T-REC-X.690</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-11.2">
        <h3 id="name-informative-references">
<a class="section-number selfRef" href="#section-11.2">11.2. </a><a class="section-name selfRef" href="#name-informative-references">Informative References</a>
        </h3>
<dl class="references">
<dt id="ISO14888-1">[ISO14888-1]</dt>
      <dd>
<span class="refAuthor">ISO/IEC</span>, <span class="refTitle">"Information technology - Security techniques - Digital signatures with appendix - Part 1: General"</span>, <span class="seriesInfo">ISO/IEC 14888-1</span>, <time class="refDate" datetime="2008-04">April 2008</time>, <span>&lt;<a href="https://www.iso.org/standard/44226.html">https://www.iso.org/standard/44226.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="Examples">
<section id="appendix-A">
      <h2 id="name-examples">
<a class="section-number selfRef" href="#appendix-A">Appendix A. </a><a class="section-name selfRef" href="#name-examples">Examples</a>
      </h2>
<p id="appendix-A-1">This section contains examples of using GOST cryptographic algorithms to create a PFX.<a class="pilcrow" href="#appendix-A-1">¶</a></p>
<div id="Data">
<section id="appendix-A.1">
        <h3 id="name-test-data">
<a class="section-number selfRef" href="#appendix-A.1">A.1. </a><a class="section-name selfRef" href="#name-test-data">Test Data</a>
        </h3>
<p id="appendix-A.1-1">In all examples, the following data is used.<a class="pilcrow" href="#appendix-A.1-1">¶</a></p>
<div id="Test_cert">
<section id="appendix-A.1.1">
          <h4 id="name-test-certificate">
<a class="section-number selfRef" href="#appendix-A.1.1">A.1.1. </a><a class="section-name selfRef" href="#name-test-certificate">Test Certificate</a>
          </h4>
<p id="appendix-A.1.1-1">This section contains a test certificate in BASE64 format.<a class="pilcrow" href="#appendix-A.1.1-1">¶</a></p>
<div class="sourcecode" id="appendix-A.1.1-2">
<pre>MIICLjCCAdugAwIBAgIEAYy6hDAKBggqhQMHAQEDAjA4MQ0wCwYDVQQKEwRUSzI2
MScwJQYDVQQDEx5DQSBUSzI2OiBHT1NUIDM0LjEwLTEyIDI1Ni1iaXQwHhcNMDEw
MTAxMDAwMDAwWhcNNDkxMjMxMDAwMDAwWjA7MQ0wCwYDVQQKEwRUSzI2MSowKAYD
VQQDEyFPUklHSU5BVE9SOiBHT1NUIDM0LjEwLTEyIDUxMi1iaXQwgaAwFwYIKoUD
BwEBAQIwCwYJKoUDBwECAQIBA4GEAASBgLSLt1q8KQ4YZVxioU+1LV9QhE7MHR9g
BEh7S1yVNGlqt7+rNG5VFqmrPM74rbUsOlhV8M+zZKprXdk35Oz8lSW/n2oIUHZx
ikXIH/SSHj4rv3K/Puvz7hYTQSZl/xPdp78nUmjrEa6d5wfX8biEy2z0dgufFvAk
Mw1Ua4gdXqDOo4GHMIGEMGMGA1UdIwRcMFqAFKxsDkxEZqJCluKfCTslZvPLpFMq
oTykOjA4MQ0wCwYDVQQKEwRUSzI2MScwJQYDVQQDEx5DQSBUSzI2OiBHT1NUIDM0
LjEwLTEyIDI1Ni1iaXSCBAGMuoEwHQYDVR0OBBYEFH4GVwmYDK1rCKhX7nkAWDrJ
16CkMAoGCCqFAwcBAQMCA0EACl6p8dAbpi9Hk+3mgMyI0WIh17IrlrSp/mB0F7Zz
Mt8XUD1Dwz3JrrnxeXnfMvOA5BdUJ9hCyDgMVAGs/IcEEA==
</pre><a class="pilcrow" href="#appendix-A.1.1-2">¶</a>
</div>
</section>
</div>
<div id="Test_key">
<section id="appendix-A.1.2">
          <h4 id="name-test-key">
<a class="section-number selfRef" href="#appendix-A.1.2">A.1.2. </a><a class="section-name selfRef" href="#name-test-key">Test Key</a>
          </h4>
<p id="appendix-A.1.2-1">This section contains test key bytes in hexadecimal.<a class="pilcrow" href="#appendix-A.1.2-1">¶</a></p>
<div class="sourcecode" id="appendix-A.1.2-2">
<pre>F95A5D44C5245F63F2E7DF8E782C1924EADCB8D06C52D91023179786154CBDB1
561B4DF759D69F67EE1FBD5B68800E134BAA12818DA4F3AC75B0E5E6F9256911
</pre><a class="pilcrow" href="#appendix-A.1.2-2">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="PFXUnencrypted">
<section id="appendix-A.2">
        <h3 id="name-example-of-a-pfx-with-a-pas">
<a class="section-number selfRef" href="#appendix-A.2">A.2. </a><a class="section-name selfRef" href="#name-example-of-a-pfx-with-a-pas">Example of a PFX with a Password-Protected Key and Unencrypted Certificate</a>
        </h3>
<p id="appendix-A.2-1">In this example, the PKCS8SHroudedKeybag structure is used to store the key, which is placed in the Data structure. 
            The certBag structure is used to store the certificate, which is placed in the Data structure.
            
            The following password is used to encrypt the key and provide integrity control:
            "Пароль для PFX".
            The password is in hexadecimal:<a class="pilcrow" href="#appendix-A.2-1">¶</a></p>
<div class="sourcecode" id="appendix-A.2-2">
<pre>D09FD0B0D180D0BED0BBD18C20D0B4D0BBD18F20504658
</pre><a class="pilcrow" href="#appendix-A.2-2">¶</a>
</div>
<p id="appendix-A.2-3">The key encryption algorithm identifier:<a class="pilcrow" href="#appendix-A.2-3">¶</a></p>
<div class="lang-asn.1 sourcecode" id="appendix-A.2-4">
<pre>1.2.643.7.1.1.5.2.2
</pre><a class="pilcrow" href="#appendix-A.2-4">¶</a>
</div>
<div id="PFX_BASE64">
<section id="appendix-A.2.1">
          <h4 id="name-pfx-in-base64-format">
<a class="section-number selfRef" href="#appendix-A.2.1">A.2.1. </a><a class="section-name selfRef" href="#name-pfx-in-base64-format">PFX in BASE64 Format</a>
          </h4>
<div class="sourcecode" id="appendix-A.2.1-1">
<pre>MIIFKwIBAzCCBMQGCSqGSIb3DQEHAaCCBLUEggSxMIIErTCCAswGCSqGSIb3DQEH
AaCCAr0EggK5MIICtTCCArEGCyqGSIb3DQEMCgEDoIICSjCCAkYGCiqGSIb3DQEJ
FgGgggI2BIICMjCCAi4wggHboAMCAQICBAGMuoQwCgYIKoUDBwEBAwIwODENMAsG
A1UEChMEVEsyNjEnMCUGA1UEAxMeQ0EgVEsyNjogR09TVCAzNC4xMC0xMiAyNTYt
Yml0MB4XDTAxMDEwMTAwMDAwMFoXDTQ5MTIzMTAwMDAwMFowOzENMAsGA1UEChME
VEsyNjEqMCgGA1UEAxMhT1JJR0lOQVRPUjogR09TVCAzNC4xMC0xMiA1MTItYml0
MIGgMBcGCCqFAwcBAQECMAsGCSqFAwcBAgECAQOBhAAEgYC0i7davCkOGGVcYqFP
tS1fUIROzB0fYARIe0tclTRpare/qzRuVRapqzzO+K21LDpYVfDPs2Sqa13ZN+Ts
/JUlv59qCFB2cYpFyB/0kh4+K79yvz7r8+4WE0EmZf8T3ae/J1Jo6xGunecH1/G4
hMts9HYLnxbwJDMNVGuIHV6gzqOBhzCBhDBjBgNVHSMEXDBagBSsbA5MRGaiQpbi
nwk7JWbzy6RTKqE8pDowODENMAsGA1UEChMEVEsyNjEnMCUGA1UEAxMeQ0EgVEsy
NjogR09TVCAzNC4xMC0xMiAyNTYtYml0ggQBjLqBMB0GA1UdDgQWBBR+BlcJmAyt
awioV+55AFg6ydegpDAKBggqhQMHAQEDAgNBAApeqfHQG6YvR5Pt5oDMiNFiIdey
K5a0qf5gdBe2czLfF1A9Q8M9ya658Xl53zLzgOQXVCfYQsg4DFQBrPyHBBAxVDAj
BgkqhkiG9w0BCRUxFgQUeVV0+dS25MICJChpmGc/8AoUwE0wLQYJKoZIhvcNAQkU
MSAeHgBwADEAMgBGAHIAaQBlAG4AZABsAHkATgBhAG0AZTCCAdkGCSqGSIb3DQEH
AaCCAcoEggHGMIIBwjCCAb4GCyqGSIb3DQEMCgECoIIBVzCCAVMwWQYJKoZIhvcN
AQUNMEwwKQYJKoZIhvcNAQUMMBwECKf4N7NMwugqAgIIADAMBggqhQMHAQEEAgUA
MB8GCSqFAwcBAQUCAjASBBAlmt2WDfaPJlsAs0mLKglzBIH1DMvEacbbWRNDVSnX
JLWygYrKoipdOjDA/2HEnBZ34uFOLNheUqiKpCPoFpbR2GBiVYVTVK9ibiczgaca
EQYzDXtcS0QCZOxpKWfteAlbdJLC/SqPurPYyKi0MVRUPROhbisFASDT38HDH1Dh
0dL5f6ga4aPWLrWbbgWERFOoOPyh4DotlPF37AQOwiEjsbyyRHq3HgbWiaxQRuAh
eqHOn4QVGY92/HFvJ7u3TcnQdLWhTe/lh1RHLNF3RnXtN9if9zC23laDZOiWZplU
yLrUiTCbHrtn1RppPDmLFNMt9dJ7KKgCkOi7Zm5nhqPChbywX13wcfYxVDAjBgkq
hkiG9w0BCRUxFgQUeVV0+dS25MICJChpmGc/8AoUwE0wLQYJKoZIhvcNAQkUMSAe
HgBwADEAMgBGAHIAaQBlAG4AZABsAHkATgBhAG0AZTBeME4wCgYIKoUDBwEBAgME
QAkBKw4ihn7pSIYTEhu0bcvTPZjI3WgVxCkUVlOsc80G69EKFEOTnObGJGSKJ51U
KkOsXF0a7+VBZf3BcVVQh9UECIVEtO+VpuskAgIIAA==
</pre><a class="pilcrow" href="#appendix-A.2.1-1">¶</a>
</div>
</section>
</div>
<div id="PFX_ASN">
<section id="appendix-A.2.2">
          <h4 id="name-pfx-in-asn1-format">
<a class="section-number selfRef" href="#appendix-A.2.2">A.2.2. </a><a class="section-name selfRef" href="#name-pfx-in-asn1-format">PFX in ASN.1 Format</a>
          </h4>
<div class="breakable lang-asn.1 sourcecode" id="appendix-A.2.2-1">
<pre>   0 1323:SEQUENCE:
   4    1: INTEGER: 3
   7 1220: SEQUENCE:
  11    9:  OBJECT IDENTIFIER:data [1.2.840.113549.1.7.1]
  22 1205:  CONTEXT SPECIFIC (0):
  26 1201:    OCTET STRING:
  30 1197:     SEQUENCE:
  34  716:       SEQUENCE:
  38    9:        OBJECT IDENTIFIER:data [1.2.840.113549.1.7.1]
  49  701:        CONTEXT SPECIFIC (0):
  53  697:          OCTET STRING:
  57  693:           SEQUENCE:
  61  689:             SEQUENCE:
  65   11:              OBJECT IDENTIFIER:pkcs-12-certBag
         :                               [1.2.840.113549.1.12.10.1.3]
  78  586:              CONTEXT SPECIFIC (0):
  82  582:                SEQUENCE:
  86   10:                 OBJECT IDENTIFIER:x509Certificate
         :                               [1.2.840.113549.1.9.22.1]
  98  566:                 CONTEXT SPECIFIC (0):
 102  562:                   OCTET STRING:
 106  558:                    SEQUENCE:
 110  475:                      SEQUENCE:
 114    3:                       CONTEXT SPECIFIC (0):
 116    1:                         INTEGER:2
 119    4:                       INTEGER:26000004
 125   10:                       SEQUENCE:
 127    8:                         OBJECT IDENTIFIER:
         :                               [1.2.643.7.1.1.3.2]
 137   56:                       SEQUENCE:
 139   13:                         SET:
 141   11:                          SEQUENCE:
 143    3:                            OBJECT IDENTIFIER:
         :                               organizationName [2.5.4.10]
 148    4:                            PRINTABLE STRING:'TK26'
 154   39:                         SET:
 156   37:                          SEQUENCE:
 158    3:                            OBJECT IDENTIFIER:commonName
         :                               [2.5.4.3]
 163   30:                           PRINTABLE STRING:
         :                           'CA TK26: GOST 34.10-12 256-bit'
 195   30:                       SEQUENCE:
 197   13:                         UTC TIME:'010101000000Z'
 212   13:                         UTC TIME:'491231000000Z'
 227   59:                       SEQUENCE:
 229   13:                         SET:
 231   11:                          SEQUENCE:
 233    3:                            OBJECT IDENTIFIER:
         :                               organizationName [2.5.4.10]
 238    4:                            PRINTABLE STRING:'TK26'
 244   42:                         SET:
 246   40:                          SEQUENCE:
 248    3:                            OBJECT IDENTIFIER:commonName
         :                                              [2.5.4.3]
 253   33:                            PRINTABLE STRING:
         :                             'ORIGINATOR:
         :                               GOST 34.10-12 512-bit'
 288  160:                       SEQUENCE:
 291   23:                         SEQUENCE:
 293    8:                          OBJECT IDENTIFIER:
         :                               [1.2.643.7.1.1.1.2]
 303   11:                          SEQUENCE:
 305    9:                            OBJECT IDENTIFIER:
         :                               [1.2.643.7.1.2.1.2.1]
 316  132:                         BIT STRING UnusedBits:0:
 320  128:                          OCTET STRING:
         :                            B48BB75ABC290E18655C62A
         :                            14FB52D5F50844ECC1D1F60
         :                            04487B4B5C9534696AB7BFA
         :                            B346E5516A9AB3CCEF8ADB5
         :                            2C3A5855F0CFB364AA6B5DD
         :                            937E4ECFC9525BF9F6A0850
         :                            76718A45C81FF4921E3E2BB
         :                            F72BF3EEBF3EE1613412665
         :                            FF13DDA7BF275268EB11AE9
         :                            DE707D7F1B884CB6CF4760B
         :                            9F16F024330D546B881D5EA0CE
 451  135:                       CONTEXT SPECIFIC (3):
 454  132:                         SEQUENCE:
 457   99:                          SEQUENCE:
 459    3:                            OBJECT IDENTIFIER:
         :                               authorityKeyIdentifier
         :                               [2.5.29.35]
 464   92:                            OCTET STRING:
 466   90:                             SEQUENCE:
 468   20:                               CONTEXT SPECIFIC (0):
         :                                AC6C0E4C4466A24296E2
         :                                9F093B2566F3CBA4532A
 490   60:                               CONTEXT SPECIFIC (1):
 492   58:                                CONTEXT SPECIFIC (4):
 494   56:                                  SEQUENCE:
 496   13:                                   SET:
 498   11:                                     SEQUENCE:
 500    3:                                      OBJECT IDENTIFIER:
         :                                         organizationName
         :                                         [2.5.4.10]
 505    4:                                      PRINTABLE STRING:
         :                                       'TK26'
 511   39:                                   SET:
 513   37:                                     SEQUENCE:
 515    3:                                      OBJECT IDENTIFIER:
         :                                         commonName
         :                                         [2.5.4.3]
 520   30:                                      PRINTABLE STRING:
         :                                       'CA TK26: GOST '
         :                                       '34.10-12 256-bit'
 552    4:                               CONTEXT SPECIFIC (2):
         :                                018CBA81
 558   29:                          SEQUENCE:
 560    3:                            OBJECT IDENTIFIER:
         :                               subjectKeyIdentifier
         :                               [2.5.29.14]
 565   22:                            OCTET STRING:
 567   20:                             OCTET STRING:
         :                               7E065709980CAD6B08A8
         :                               57EE7900583AC9D7A0A4
 589   10:                      SEQUENCE:
 591    8:                       OBJECT IDENTIFIER:
         :                        [1.2.643.7.1.1.3.2]
 601   65:                      BIT STRING UnusedBits:0:
         :                       0A5EA9F1D01BA62F4793EDE680CC88D1
         :                       6221D7B22B96B4A9FE607417B67332DF
         :                       17503D43C33DC9AEB9F17979DF32F380
         :                       E4175427D842C8380C5401ACFC870410
 668   84:              SET:
 670   35:                SEQUENCE:
 672    9:                 OBJECT IDENTIFIER:localKeyID
         :                       [1.2.840.113549.1.9.21]
 683   22:                 SET:
 685   20:                   OCTET STRING:
         :                    795574F9D4B6E4C20224
         :                    286998673FF00A14C04D
 707   45:                SEQUENCE:
 709    9:                 OBJECT IDENTIFIER:friendlyName
         :                       [1.2.840.113549.1.9.20]
 720   32:                 SET:
 722   30:                   BMP STRING:'p12FriendlyName'
 754  473:       SEQUENCE:
 758    9:        OBJECT IDENTIFIER:data [1.2.840.113549.1.7.1]
 769  458:        CONTEXT SPECIFIC (0):
 773  454:          OCTET STRING:
 777  450:           SEQUENCE:
 781  446:             SEQUENCE:
 785   11:              OBJECT IDENTIFIER:
         :               pkcs-12-pkcs-8ShroudedKeyBag
         :               [1.2.840.113549.1.12.10.1.2]
 798  343:              CONTEXT SPECIFIC (0):
 802  339:                SEQUENCE:
 806   89:                 SEQUENCE:
 808    9:                   OBJECT IDENTIFIER:
         :                    [1.2.840.113549.1.5.13]
 819   76:                   SEQUENCE:
 821   41:                    SEQUENCE:
 823    9:                      OBJECT IDENTIFIER:
         :                       [1.2.840.113549.1.5.12]
 834   28:                      SEQUENCE:
 836    8:                       OCTET STRING:'A7F837B34CC2E82A'
 846    2:                       INTEGER:2048
 850   12:                       SEQUENCE:
 852    8:                         OBJECT IDENTIFIER:
         :                          [1.2.643.7.1.1.4.2]
 862    0:                         NULL:
 864   31:                    SEQUENCE:
 866    9:                      OBJECT IDENTIFIER:
         :                       [1.2.643.7.1.1.5.2.2]
 877   18:                      SEQUENCE:
 879   16:                       OCTET STRING:
         :                         259ADD960DF68F265B00B3498B2A0973
 897  245:                 OCTET STRING:
         :                   0CCBC469C6DB5913435529D724B5B281
         :                   8ACAA22A5D3A30C0FF61C49C1677E2E1
         :                   4E2CD85E52A88AA423E81696D1D86062
         :                   55855354AF626E273381A71A1106330D
         :                   7B5C4B440264EC692967ED78095B7492
         :                   C2FD2A8FBAB3D8C8A8B43154543D13A1
         :                   6E2B050120D3DFC1C31F50E1D1D2F97F
         :                   A81AE1A3D62EB59B6E05844453A838FC
         :                   A1E03A2D94F177EC040EC22123B1BCB2
         :                   447AB71E06D689AC5046E0217AA1CE9F
         :                   8415198F76FC716F27BBB74DC9D074B5
         :                   A14DEFE58754472CD1774675ED37D89F
         :                   F730B6DE568364E896669954C8BAD489
         :                   309B1EBB67D51A693C398B14D32DF5D2
         :                   7B28A80290E8BB666E6786A3C285BCB0
         :                   5F5DF071F6
1145   84:              SET:
1147   35:                SEQUENCE:
1149    9:                 OBJECT IDENTIFIER:localKeyID
         :                   [1.2.840.113549.1.9.21]
1160   22:                 SET:
1162   20:                   OCTET STRING:
         :                    795574F9D4B6E4C20224
         :                    286998673FF00A14C04D
1184   45:                SEQUENCE:
1186    9:                 OBJECT IDENTIFIER:friendlyName
         :                   [1.2.840.113549.1.9.20]
1197   32:                 SET:
1199   30:                   BMP STRING:'p12FriendlyName'
1231   94: SEQUENCE:
1233   78:  SEQUENCE:
1235   10:    SEQUENCE:
1237    8:     OBJECT IDENTIFIER:[1.2.643.7.1.1.2.3]
1247   64:    OCTET STRING:
         :     09012B0E22867EE9488613121BB46DCB
         :     D33D98C8DD6815C429145653AC73CD06
         :     EBD10A1443939CE6C624648A279D542A
         :     43AC5C5D1AEFE54165FDC171555087D5
1313    8:  OCTET STRING:'8544B4EF95A6EB24'
1323    2:  INTEGER:2048
</pre><a class="pilcrow" href="#appendix-A.2.2-1">¶</a>
</div>
</section>
</div>
<div id="Dec_key">
<section id="appendix-A.2.3">
          <h4 id="name-decrypted-key-value-in-base">
<a class="section-number selfRef" href="#appendix-A.2.3">A.2.3. </a><a class="section-name selfRef" href="#name-decrypted-key-value-in-base">Decrypted Key Value in BASE64 Format</a>
          </h4>
<div class="sourcecode" id="appendix-A.2.3-1">
<pre>MIHiAgEBMBcGCCqFAwcBAQECMAsGCSqFAwcBAgECAQRAEWkl+eblsHWs86SNgRKq
SxMOgGhbvR/uZ5/WWfdNG1axvUwVhpcXIxDZUmzQuNzqJBkseI7f5/JjXyTFRF1a
+YGBgQG0i7davCkOGGVcYqFPtS1fUIROzB0fYARIe0tclTRpare/qzRuVRapqzzO
+K21LDpYVfDPs2Sqa13ZN+Ts/JUlv59qCFB2cYpFyB/0kh4+K79yvz7r8+4WE0Em
Zf8T3ae/J1Jo6xGunecH1/G4hMts9HYLnxbwJDMNVGuIHV6gzg==
</pre><a class="pilcrow" href="#appendix-A.2.3-1">¶</a>
</div>
</section>
</div>
<div id="Dec_key_ASN">
<section id="appendix-A.2.4">
          <h4 id="name-decrypted-key-value-in-asn1">
<a class="section-number selfRef" href="#appendix-A.2.4">A.2.4. </a><a class="section-name selfRef" href="#name-decrypted-key-value-in-asn1">Decrypted Key Value in ASN.1 Format</a>
          </h4>
<div class="lang-asn.1 sourcecode" id="appendix-A.2.4-1">
<pre> 0 226:SEQUENCE:
 3   1:   INTEGER: 1
 6  23:   SEQUENCE:
 8   8:      OBJECT IDENTIFIER:  [1.2.643.7.1.1.1.2]
18  11:      SEQUENCE:
20   9:         OBJECT IDENTIFIER:  [1.2.643.7.1.2.1.2.1]
31  64:   OCTET STRING:
      :      116925F9E6E5B075ACF3A48D8112AA4B130E80685BBD1FEE679FD6
      :      59F74D1B56B1BD4C158697172310D9526CD0B8DCEA24192C788EDF
      :      E7F2635F24C5445D5AF9
97 129:   CONTEXT SPECIFIC (1):
      :      01B48BB75ABC290E18655C62A14FB52D5F50844ECC1D1F6004487B
      :      4B5C9534696AB7BFAB346E5516A9AB3CCEF8ADB52C3A5855F0CFB3
      :      64AA6B5DD937E4ECFC9525BF9F6A085076718A45C81FF4921E3E2B
      :      BF72BF3EEBF3EE1613412665FF13DDA7BF275268EB11AE9DE707D7
      :      F1B884CB6CF4760B9F16F024330D546B881D5EA0CE
</pre><a class="pilcrow" href="#appendix-A.2.4-1">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="PFXEncrypted">
<section id="appendix-A.3">
        <h3 id="name-example-of-a-pfx-with-a-pass">
<a class="section-number selfRef" href="#appendix-A.3">A.3. </a><a class="section-name selfRef" href="#name-example-of-a-pfx-with-a-pass">Example of a PFX with a Password-Protected Key and a Password-Protected Certificate</a>
        </h3>
<p id="appendix-A.3-1">In this example, the PKCS8SHroudedKeybag structure is used to store the key, which is placed in the Data structure (see <span>[<a class="cite xref" href="#RFC5652">RFC5652</a>]</span>). 
            The certBag structure is used to store the certificate, which is placed in the EncryptedData structure (see <span>[<a class="cite xref" href="#RFC5652">RFC5652</a>]</span>).
            
            The following password is used to encrypt the key and provide integrity control. The password is in hexadecimal.<a class="pilcrow" href="#appendix-A.3-1">¶</a></p>
<div class="sourcecode" id="appendix-A.3-2">
<pre>D09FD0B0D180D0BED0BBD18C20D0B4D0BBD18F20504658
</pre><a class="pilcrow" href="#appendix-A.3-2">¶</a>
</div>
<p id="appendix-A.3-3">The key encryption algorithm identifier:<a class="pilcrow" href="#appendix-A.3-3">¶</a></p>
<div class="lang-asn.1 sourcecode" id="appendix-A.3-4">
<pre>1.2.643.7.1.1.5.1.1
</pre><a class="pilcrow" href="#appendix-A.3-4">¶</a>
</div>
<p id="appendix-A.3-5">The certificate encryption algorithm identifier:<a class="pilcrow" href="#appendix-A.3-5">¶</a></p>
<div class="lang-asn.1 sourcecode" id="appendix-A.3-6">
<pre>1.2.643.7.1.1.5.1.2
</pre><a class="pilcrow" href="#appendix-A.3-6">¶</a>
</div>
<div id="PFX_BASE64_Ex2">
<section id="appendix-A.3.1">
          <h4 id="name-pfx-in-base64-format-2">
<a class="section-number selfRef" href="#appendix-A.3.1">A.3.1. </a><a class="section-name selfRef" href="#name-pfx-in-base64-format-2">PFX in BASE64 Format</a>
          </h4>
<div class="sourcecode" id="appendix-A.3.1-1">
<pre>MIIFjAIBAzCCBSUGCSqGSIb3DQEHAaCCBRYEggUSMIIFDjCCA0EGCSqGSIb3DQEH
BqCCAzIwggMuAgEAMIIDJwYJKoZIhvcNAQcBMFUGCSqGSIb3DQEFDTBIMCkGCSqG
SIb3DQEFDDAcBAgUuSVGsSwGjQICCAAwDAYIKoUDBwEBBAIFADAbBgkqhQMHAQEF
AQIwDgQM9Hk3dagtS48+G/x+gIICwWGPqxxN+sTrKbruRf9R5Ya9cf5AtO1frqMn
f1eULfmZmTg/BdE51QQ+Vbnh3v1kmspr6h2+e4Wli+ndEeCWG6A6X/G22h/RAHW2
YrVmf6cCWxW+YrqzT4h/8RQL/9haunD5LmHPLVsYrEai0OwbgXayDSwARVJQLQYq
sLNmZK5ViN+fRiS5wszVJ3AtVq8EuPt41aQEKwPy2gmH4S6WmnQRC6W7aoqmIifF
PJENJNn5K2M1J6zNESs6bFtYNKMArNqtvv3rioY6eAaaLy6AV6ljsekmqodHmQjv
Y4eEioJs0xhpXhZY69PXT+ZBeHv6MSheBhwXqxAd1DqtPTafMjNK8rqKCap9TtPG
vONvo5W9dgwegxRRQzlum8dzV4m1W9Aq4W7t8/UcxDWRz3k6ijFPlGaA9+8ZMTEO
RHhBRvM6OY2/VNNxbgxWfGYuPxpSi3YnCZIPmBEe5lU/Xv7KjzFusGM38F8YR61k
4/QNpKI1QUv714YKfaUQznshGGzILv1NGID62pl1+JI3vuawi2mDMrmkuM9QFU9v
/kRP+c2uBHDuOGEUUSNhF08p7+w3vxplatGWXH9fmIsPBdk2f3wkn+rwoqrEuijM
I/bCAylU/M0DMKhAo9j31UYSZdi4fsfRWYDJMq/8FPn96tuo+oCpbqv3NUwpZM/8
Li4xqgTHtYw/+fRG0/P6XadNEiII/TYjenLfVHXjAHOVJsVeCu/t3EsMYHQddNCh
rFk/Ic2PdIQOyB4/enpW0qrKegSbyZNuF1WI4zl4mI89L8dTQBUkhy45yQXZlDD8
k1ErYdtdEsPtz/4zuSpbnmwCEIRoOuSXtGuJP+tbcWEXRKM2UBgi3qBjpn7DU18M
tsrRM9pDdadl8mT/Vfh9+B8dZBZVxgQu70lMPEGexbUkYHuFCCnyi9J0V92StbIz
Elxla1VebjCCAcUGCSqGSIb3DQEHAaCCAbYEggGyMIIBrjCCAaoGCyqGSIb3DQEM
CgECoIIBQzCCAT8wVQYJKoZIhvcNAQUNMEgwKQYJKoZIhvcNAQUMMBwECP0EQk0O
1twvAgIIADAMBggqhQMHAQEEAgUAMBsGCSqFAwcBAQUBATAOBAzwxSqgAAAAAAAA
AAAEgeUqj9mI3RDfK5hMd0EeYws7foZK/5ANr2wUhP5qnDjAZgn76lExJ+wuvlnS
9PChfWVugvdl/9XJgQvvr9Cu4pOh4ICXplchcy0dGk/MzItHRVC5wK2nTxwQ4kKT
kG9xhLFzoD16dhtqX0+/dQg9G8pE5EzCBIYRXLm1Arcz9k7KVsTJuNMjFrr7EQuu
Tr80ATSQOtsq50zpFyrpznVPGCrOdIjpymZxNdvw48bZxqTtRVDxCYATOGqz0pwH
ClWULHD9LIajLMB2GhBKyQw6ujIlltJs0T+WNdX/AT2FLi1LFSS3+Cj9MVQwIwYJ
KoZIhvcNAQkVMRYEFHlVdPnUtuTCAiQoaZhnP/AKFMBNMC0GCSqGSIb3DQEJFDEg
Hh4AcAAxADIARgByAGkAZQBuAGQAbAB5AE4AYQBtAGUwXjBOMAoGCCqFAwcBAQID
BEDp4e22JmXdnvR0xA99yQuzQuJ8pxBeOpsLm2dZQqt3Fje5zqW1uk/7VOcfV5r2
bKm8nsLOs2rPT8hBOoeAZvOIBAjGIUHw6IjG2QICCAA=
</pre><a class="pilcrow" href="#appendix-A.3.1-1">¶</a>
</div>
</section>
</div>
<div id="PFX_ASN_Ex2">
<section id="appendix-A.3.2">
          <h4 id="name-pfx-in-asn1-format-2">
<a class="section-number selfRef" href="#appendix-A.3.2">A.3.2. </a><a class="section-name selfRef" href="#name-pfx-in-asn1-format-2">PFX in ASN.1 Format</a>
          </h4>
<div class="breakable lang-asn.1 sourcecode" id="appendix-A.3.2-1">
<pre>0 1420:SEQUENCE:
  4    1:  INTEGER:3
  7 1317:  SEQUENCE:
 11    9:   OBJECT IDENTIFIER:data [1.2.840.113549.1.7.1]
 22 1302:   CONTEXT SPECIFIC (0):
 26 1298:     OCTET STRING:
 30 1294:      SEQUENCE:
 34  833:        SEQUENCE:
 38    9:         OBJECT IDENTIFIER:
        :          encryptedData [1.2.840.113549.1.7.6]
 49  818:         CONTEXT SPECIFIC (0):
 53  814:           SEQUENCE:
 57    1:            INTEGER:0
 60  807:            SEQUENCE:
 64    9:              OBJECT IDENTIFIER:data [1.2.840.113549.1.7.1]
 75   85:              SEQUENCE:
 77    9:               OBJECT IDENTIFIER:[1.2.840.113549.1.5.13]
 88   72:               SEQUENCE:
 90   41:                 SEQUENCE:
 92    9:                  OBJECT IDENTIFIER:[1.2.840.113549.1.5.12]
103   28:                  SEQUENCE:
105    8:                    OCTET STRING:'14B92546B12C068D'
115    2:                    INTEGER:2048
119   12:                    SEQUENCE:
121    8:                     OBJECT IDENTIFIER:[1.2.643.7.1.1.4.2]
131    0:                     NULL:
133   27:                 SEQUENCE:
135    9:                  OBJECT IDENTIFIER:[1.2.643.7.1.1.5.1.2]
146   14:                  SEQUENCE:
148   12:                    OCTET STRING:
        :                     F4793775A82D4B8F3E1BFC7E
162  705:              CONTEXT SPECIFIC (0):
        :               618FAB1C4DFAC4EB29BAEE45FF51E586BD7
        :               1FE40B4ED5FAEA3277F57942DF99999383F
        :               05D139D5043E55B9E1DEFD649ACA6BEA1DB
        :               E7B85A58BE9DD11E0961BA03A5FF1B6DA1F
        :               D10075B662B5667FA7025B15BE62BAB34F8
        :               87FF1140BFFD85ABA70F92E61CF2D5B18AC
        :               46A2D0EC1B8176B20D2C004552502D062AB
        :               0B36664AE5588DF9F4624B9C2CCD527702D
        :               56AF04B8FB78D5A4042B03F2DA0987E12E9
        :               69A74110BA5BB6A8AA62227C53C910D24D9
        :               F92B633527ACCD112B3A6C5B5834A300ACD
        :               AADBEFDEB8A863A78069A2F2E8057A963B1
        :               E926AA87479908EF6387848A826CD318695
        :               E1658EBD3D74FE641787BFA31285E061C17
        :               AB101DD43AAD3D369F32334AF2BA8A09AA7
        :               D4ED3C6BCE36FA395BD760C1E8314514339
        :               6E9BC7735789B55BD02AE16EEDF3F51CC43
        :               591CF793A8A314F946680F7EF1931310E44
        :               784146F33A398DBF54D3716E0C567C662E3
        :               F1A528B762709920F98111EE6553F5EFECA
        :               8F316EB06337F05F1847AD64E3F40DA4A23
        :               5414BFBD7860A7DA510CE7B21186CC82EFD
        :               4D1880FADA9975F89237BEE6B08B698332B
        :               9A4B8CF50154F6FFE444FF9CDAE0470EE38
        :               6114512361174F29EFEC37BF1A656AD1965
        :               C7F5F988B0F05D9367F7C249FEAF0A2AAC4
        :               BA28CC23F6C2032954FCCD0330A840A3D8F
        :               7D5461265D8B87EC7D15980C932AFFC14F9
        :               FDEADBA8FA80A96EABF7354C2964CFFC2E2
        :               E31AA04C7B58C3FF9F446D3F3FA5DA74D12
        :               2208FD36237A72DF5475E300739526C55E0
        :               AEFEDDC4B0C60741D74D0A1AC593F21CD8F
        :               74840EC81E3F7A7A56D2AACA7A049BC9936
        :               E175588E33978988F3D2FC753401524872E
        :               39C905D99430FC93512B61DB5D12C3EDCFF
        :               E33B92A5B9E6C021084683AE497B46B893F
        :               EB5B71611744A336501822DEA063A67EC35
        :               35F0CB6CAD133DA4375A765F264FF55F87D
        :               F81F1D641655C6042EEF494C3C419EC5B52
        :               4607B850829F28BD27457DD92B5B233125C
        :               656B555E6E
871  453:        SEQUENCE:
875    9:         OBJECT IDENTIFIER:data [1.2.840.113549.1.7.1]
886  438:         CONTEXT SPECIFIC (0):
890  434:           OCTET STRING:
894  430:            SEQUENCE:
898  426:              SEQUENCE:
902   11:               OBJECT IDENTIFIER:
        :                pkcs-12-pkcs-8ShroudedKeyBag
        :                [1.2.840.113549.1.12.10.1.2]
915  323:               CONTEXT SPECIFIC (0):
919  319:                 SEQUENCE:
923   85:                  SEQUENCE:
925    9:                    OBJECT IDENTIFIER:
        :                     [1.2.840.113549.1.5.13]
936   72:                    SEQUENCE:
938   41:                     SEQUENCE:
940    9:                       OBJECT IDENTIFIER:
        :                        [1.2.840.113549.1.5.12]
951   28:                       SEQUENCE:
953    8:                        OCTET STRING:
        :                          FD04424D0ED6DC2F
963    2:                        INTEGER:2048
967   12:                        SEQUENCE:
969    8:                          OBJECT IDENTIFIER:
        :                           [1.2.643.7.1.1.4.2]
979    0:                          NULL:
981   27:                     SEQUENCE:
983    9:                       OBJECT IDENTIFIER:
        :                        [1.2.643.7.1.1.5.1.1]
994   14:                       SEQUENCE:
996   12:                        OCTET STRING:
        :                          F0C52AA00000000000000000
1010  229:                  OCTET STRING:
        :                    2A8FD988DD10DF2B984C77411E630B3B
        :                    7E864AFF900DAF6C1484FE6A9C38C066
        :                    09FBEA513127EC2EBE59D2F4F0A17D65
        :                    6E82F765FFD5C9810BEFAFD0AEE293A1
        :                    E08097A65721732D1D1A4FCCCC8B4745
        :                    50B9C0ADA74F1C10E24293906F7184B1
        :                    73A03D7A761B6A5F4FBF75083D1BCA44
        :                    E44CC20486115CB9B502B733F64ECA56
        :                    C4C9B8D32316BAFB110BAE4EBF340134
        :                    903ADB2AE74CE9172AE9CE754F182ACE
        :                    7488E9CA667135DBF0E3C6D9C6A4ED45
        :                    50F1098013386AB3D29C070A55942C70
        :                    FD2C86A32CC0761A104AC90C3ABA3225
        :                    96D26CD13F9635D5FF013D852E2D4B15
        :                    24B7F828FD
1242   84:               SET:
1244   35:                 SEQUENCE:
1246    9:                  OBJECT IDENTIFIER:localKeyID
        :                   [1.2.840.113549.1.9.21]
1257   22:                  SET:
1259   20:                    OCTET STRING:
        :                      795574F9D4B6E4C20224
        :                      286998673FF00A14C04D
1281   45:                 SEQUENCE:
1283    9:                  OBJECT IDENTIFIER:
        :                   friendlyName [1.2.840.113549.1.9.20]
1294   32:                  SET:
1296   30:                    BMP STRING:'p12FriendlyName'
1328   94:  SEQUENCE:
1330   78:   SEQUENCE:
1332   10:     SEQUENCE:
1334    8:      OBJECT IDENTIFIER:[1.2.643.7.1.1.2.3]
1344   64:     OCTET STRING:
        :      E9E1EDB62665DD9EF474C40F7DC90BB3
        :      42E27CA7105E3A9B0B9B675942AB7716
        :      37B9CEA5B5BA4FFB54E71F579AF66CA9
        :      BC9EC2CEB36ACF4FC8413A878066F388
1410    8:   OCTET STRING:'C62141F0E888C6D9'
1420    2:   INTEGER:2048
</pre><a class="pilcrow" href="#appendix-A.3.2-1">¶</a>
</div>
</section>
</div>
<div id="Dec_key_Ex2">
<section id="appendix-A.3.3">
          <h4 id="name-decrypted-key-value-in-base6">
<a class="section-number selfRef" href="#appendix-A.3.3">A.3.3. </a><a class="section-name selfRef" href="#name-decrypted-key-value-in-base6">Decrypted Key Value in BASE64 Format</a>
          </h4>
<div class="sourcecode" id="appendix-A.3.3-1">
<pre>MIHiAgEBMBcGCCqFAwcBAQECMAsGCSqFAwcBAgECAQRAEWkl+eblsHWs86SNgRKq
SxMOgGhbvR/uZ5/WWfdNG1axvUwVhpcXIxDZUmzQuNzqJBkseI7f5/JjXyTFRF1a
+YGBgQG0i7davCkOGGVcYqFPtS1fUIROzB0fYARIe0tclTRpare/qzRuVRapqzzO
+K21LDpYVfDPs2Sqa13ZN+Ts/JUlv59qCFB2cYpFyB/0kh4+K79yvz7r8+4WE0Em
Zf8T3ae/J1Jo6xGunecH1/G4hMts9HYLnxbwJDMNVGuIHV6gzg==
</pre><a class="pilcrow" href="#appendix-A.3.3-1">¶</a>
</div>
</section>
</div>
<div id="Dec_key_ASN_Ex2">
<section id="appendix-A.3.4">
          <h4 id="name-decrypted-key-value-in-asn1-">
<a class="section-number selfRef" href="#appendix-A.3.4">A.3.4. </a><a class="section-name selfRef" href="#name-decrypted-key-value-in-asn1-">Decrypted Key Value in ASN.1 Format</a>
          </h4>
<div class="lang-asn.1 sourcecode" id="appendix-A.3.4-1">
<pre> 0 226:SEQUENCE:
 3   1:   INTEGER: 1
 6  23:   SEQUENCE:
 8   8:      OBJECT IDENTIFIER:  [1.2.643.7.1.1.1.2]
18  11:      SEQUENCE:
20   9:         OBJECT IDENTIFIER:  [1.2.643.7.1.2.1.2.1]
31  64:   OCTET STRING:
      :      116925F9E6E5B075ACF3A48D8112AA4B130E80685BBD1FEE679FD6
      :      59F74D1B56B1BD4C158697172310D9526CD0B8DCEA24192C788EDF
      :      E7F2635F24C5445D5AF9
97 129:   CONTEXT SPECIFIC (1):
      :      01B48BB75ABC290E18655C62A14FB52D5F50844ECC1D1F6004487B
      :      4B5C9534696AB7BFAB346E5516A9AB3CCEF8ADB52C3A5855F0CFB3
      :      64AA6B5DD937E4ECFC9525BF9F6A085076718A45C81FF4921E3E2B
      :      BF72BF3EEBF3EE1613412665FF13DDA7BF275268EB11AE9DE707D7
      :      F1B884CB6CF4760B9F16F024330D546B881D5EA0CE
</pre><a class="pilcrow" href="#appendix-A.3.4-1">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="Acknowledgments">
<section id="appendix-B">
      <h2 id="name-acknowledgments">
<a class="section-name selfRef" href="#name-acknowledgments">Acknowledgments</a>
      </h2>
<p id="appendix-B-1">The author thanks <span class="contact-name">Potashnikov Alexander</span>, <span class="contact-name">Pianov Semen</span>, and <span class="contact-name">Smyslov Valery</span> for their careful readings and useful comments,
         and <span class="contact-name">Chelpanov Alexander</span> for his help with the registration of identifiers.<a class="pilcrow" href="#appendix-B-1">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-C">
      <h2 id="name-authors-address">
<a class="section-name selfRef" href="#name-authors-address">Author's Address</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Ekaterina Karelina (<span class="role">editor</span>)</span></div>
<div class="left" dir="auto"><span class="org">InfoTeCS</span></div>
<div class="left" dir="auto"><span class="street-address">2B stroenie 1, ul. Otradnaya</span></div>
<div class="left" dir="auto"><span class="locality">Moscow</span></div>
<div class="left" dir="auto"><span class="postal-code">127273</span></div>
<div class="left" dir="auto"><span class="country-name">Russian Federation</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:Ekaterina.Karelina@infotecs.ru">Ekaterina.Karelina@infotecs.ru</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>


</body></html>