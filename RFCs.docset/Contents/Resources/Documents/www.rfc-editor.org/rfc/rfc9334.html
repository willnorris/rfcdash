<!DOCTYPE html>
<html class="RFC" lang="en"><head>
<meta charset="utf-8"/>
<meta content="Common,Latin" name="scripts"/>
<meta content="initial-scale=1.0" name="viewport"/>
<title>RFC 9334: Remote ATtestation procedureS (RATS) Architecture</title>
<meta content="Henk Birkholz" name="author"/>
<meta content="Dave Thaler" name="author"/>
<meta content="Michael Richardson" name="author"/>
<meta content="Ned Smith" name="author"/>
<meta content="Wei Pan" name="author"/>
<meta content="
       In network protocol exchanges, it is often useful for one end of a
communication to know whether the other end is in an intended operating state.
This document provides an architectural overview of the entities involved
that make such tests possible through the process of generating,
conveying, and evaluating evidentiary Claims.  It provides a model that is neutral toward
     processor architectures, the content of Claims, and protocols. 
    " name="description"/>
<meta content="xml2rfc 3.15.3" name="generator"/>
<meta content="9334" name="rfc.number"/>
<!-- Generator version information:
  xml2rfc 3.15.3
    Python 3.9.15
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.1
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 4.9.0
    MarkupSafe 2.1.1
    pycountry 22.3.5
    PyYAML 6.0
    requests 2.28.0
    setuptools 44.1.1
    six 1.16.0
    wcwidth 0.2.5
    weasyprint 56.1
-->
<link href="rfc9334.xml" rel="alternate" type="application/rfc+xml"/>
<link href="#copyright" rel="license"/>
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necessary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

:root {
  --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
  --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
  --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
}

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: var(--font-sans);
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
svg[font-family~="serif" i], svg [font-family~="serif" i] {
  font-family: var(--font-serif);
}
svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
  font-family: var(--font-sans);
}
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre {
  background-color: #f9f9f9;
  font-family: var(--font-mono);
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: var(--font-sans);
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  .breakable pre {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The following is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
.sourcecode pre,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .artwork > pre,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background slightly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottom margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the compact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div.sourcecode:first-child,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type:only-child {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css"/>
<link href="https://dx.doi.org/10.17487/rfc9334" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <link href="https://datatracker.ietf.org/doc/draft-ietf-rats-architecture-22" rel="prev"/>
  </head>
<body class="xml2rfc">
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 9334</td>
<td class="center">RATS Arch &amp; Terms</td>
<td class="right">January 2023</td>
</tr></thead>
<tfoot><tr>
<td class="left">Birkholz, et al.</td>
<td class="center">Informational</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div class="document-information" id="external-metadata"></div>
<div class="document-information" id="internal-metadata">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a class="eref" href="https://www.rfc-editor.org/rfc/rfc9334">9334</a></dd>
<dt class="label-category">Category:</dt>
<dd class="category">Informational</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time class="published" datetime="2023-01">January 2023</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">H. Birkholz</div>
<div class="org">Fraunhofer SIT</div>
</div>
<div class="author">
      <div class="author-name">D. Thaler</div>
<div class="org">Microsoft</div>
</div>
<div class="author">
      <div class="author-name">M. Richardson</div>
<div class="org">Sandelman Software Works</div>
</div>
<div class="author">
      <div class="author-name">N. Smith</div>
<div class="org">Intel</div>
</div>
<div class="author">
      <div class="author-name">W. Pan</div>
<div class="org">Huawei</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 9334</h1>
<h1 id="title">Remote ATtestation procedureS (RATS) Architecture</h1>
<section id="section-abstract">
      <h2 id="abstract"><a class="selfRef" href="#abstract">Abstract</a></h2>
<p id="section-abstract-1">In network protocol exchanges, it is often useful for one end of a
communication to know whether the other end is in an intended operating state.
This document provides an architectural overview of the entities involved
that make such tests possible through the process of generating,
conveying, and evaluating evidentiary Claims.  It provides a model that is neutral toward
     processor architectures, the content of Claims, and protocols.<a class="pilcrow" href="#section-abstract-1">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a class="section-name selfRef" href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This document is not an Internet Standards Track specification; it is
            published for informational purposes.<a class="pilcrow" href="#section-boilerplate.1-1">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by the
            Internet Engineering Steering Group (IESG).  Not all documents
            approved by the IESG are candidates for any level of Internet
            Standard; see Section 2 of RFC 7841.<a class="pilcrow" href="#section-boilerplate.1-2">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc9334">https://www.rfc-editor.org/info/rfc9334</a></span>.<a class="pilcrow" href="#section-boilerplate.1-3">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a class="section-name selfRef" href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2023 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a class="pilcrow" href="#section-boilerplate.2-1">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a class="pilcrow" href="#section-boilerplate.2-2">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a class="toplink" href="#" onclick="scroll(0,0)">▲</a><h2 id="name-table-of-contents">
<a class="section-name selfRef" href="#name-table-of-contents">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p class="keepWithNext" id="section-toc.1-1.1.1"><a class="auto internal xref" href="#section-1">1</a>.  <a class="internal xref" href="#name-introduction">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a class="auto internal xref" href="#section-2">2</a>.  <a class="internal xref" href="#name-reference-use-cases">Reference Use Cases</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p class="keepWithNext" id="section-toc.1-1.2.2.1.1"><a class="auto internal xref" href="#section-2.1">2.1</a>.  <a class="internal xref" href="#name-network-endpoint-assessment">Network Endpoint Assessment</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p class="keepWithNext" id="section-toc.1-1.2.2.2.1"><a class="auto internal xref" href="#section-2.2">2.2</a>.  <a class="internal xref" href="#name-confidential-machine-learni">Confidential Machine Learning Model Protection</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a class="auto internal xref" href="#section-2.3">2.3</a>.  <a class="internal xref" href="#name-confidential-data-protectio">Confidential Data Protection</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.4">
                <p id="section-toc.1-1.2.2.4.1"><a class="auto internal xref" href="#section-2.4">2.4</a>.  <a class="internal xref" href="#name-critical-infrastructure-con">Critical Infrastructure Control</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.5">
                <p id="section-toc.1-1.2.2.5.1"><a class="auto internal xref" href="#section-2.5">2.5</a>.  <a class="internal xref" href="#name-trusted-execution-environme">Trusted Execution Environment Provisioning</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.6">
                <p id="section-toc.1-1.2.2.6.1"><a class="auto internal xref" href="#section-2.6">2.6</a>.  <a class="internal xref" href="#name-hardware-watchdog">Hardware Watchdog</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.7">
                <p id="section-toc.1-1.2.2.7.1"><a class="auto internal xref" href="#section-2.7">2.7</a>.  <a class="internal xref" href="#name-fido-biometric-authenticati">FIDO Biometric Authentication</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a class="auto internal xref" href="#section-3">3</a>.  <a class="internal xref" href="#name-architectural-overview">Architectural Overview</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a class="auto internal xref" href="#section-3.1">3.1</a>.  <a class="internal xref" href="#name-two-types-of-environments-o">Two Types of Environments of an Attester</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a class="auto internal xref" href="#section-3.2">3.2</a>.  <a class="internal xref" href="#name-layered-attestation-environ">Layered Attestation Environments</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a class="auto internal xref" href="#section-3.3">3.3</a>.  <a class="internal xref" href="#name-composite-device">Composite Device</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a class="auto internal xref" href="#section-3.4">3.4</a>.  <a class="internal xref" href="#name-implementation-consideratio">Implementation Considerations</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a class="auto internal xref" href="#section-4">4</a>.  <a class="internal xref" href="#name-terminology">Terminology</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a class="auto internal xref" href="#section-4.1">4.1</a>.  <a class="internal xref" href="#name-roles">Roles</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a class="auto internal xref" href="#section-4.2">4.2</a>.  <a class="internal xref" href="#name-artifacts">Artifacts</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a class="auto internal xref" href="#section-5">5</a>.  <a class="internal xref" href="#name-topological-patterns">Topological Patterns</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a class="auto internal xref" href="#section-5.1">5.1</a>.  <a class="internal xref" href="#name-passport-model">Passport Model</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a class="auto internal xref" href="#section-5.2">5.2</a>.  <a class="internal xref" href="#name-background-check-model">Background-Check Model</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a class="auto internal xref" href="#section-5.3">5.3</a>.  <a class="internal xref" href="#name-combinations">Combinations</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a class="auto internal xref" href="#section-6">6</a>.  <a class="internal xref" href="#name-roles-and-entities">Roles and Entities</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a class="auto internal xref" href="#section-7">7</a>.  <a class="internal xref" href="#name-trust-model">Trust Model</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a class="auto internal xref" href="#section-7.1">7.1</a>.  <a class="internal xref" href="#name-relying-party">Relying Party</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a class="auto internal xref" href="#section-7.2">7.2</a>.  <a class="internal xref" href="#name-attester">Attester</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a class="auto internal xref" href="#section-7.3">7.3</a>.  <a class="internal xref" href="#name-relying-party-owner">Relying Party Owner</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a class="auto internal xref" href="#section-7.4">7.4</a>.  <a class="internal xref" href="#name-verifier">Verifier</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5">
                <p id="section-toc.1-1.7.2.5.1"><a class="auto internal xref" href="#section-7.5">7.5</a>.  <a class="internal xref" href="#name-endorser-reference-value-pr">Endorser, Reference Value Provider, and Verifier Owner</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a class="auto internal xref" href="#section-8">8</a>.  <a class="internal xref" href="#name-conceptual-messages">Conceptual Messages</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a class="auto internal xref" href="#section-8.1">8.1</a>.  <a class="internal xref" href="#name-evidence">Evidence</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a class="auto internal xref" href="#section-8.2">8.2</a>.  <a class="internal xref" href="#name-endorsements">Endorsements</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a class="auto internal xref" href="#section-8.3">8.3</a>.  <a class="internal xref" href="#name-reference-values">Reference Values</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4">
                <p id="section-toc.1-1.8.2.4.1"><a class="auto internal xref" href="#section-8.4">8.4</a>.  <a class="internal xref" href="#name-attestation-results">Attestation Results</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.5">
                <p id="section-toc.1-1.8.2.5.1"><a class="auto internal xref" href="#section-8.5">8.5</a>.  <a class="internal xref" href="#name-appraisal-policies">Appraisal Policies</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a class="auto internal xref" href="#section-9">9</a>.  <a class="internal xref" href="#name-claims-encoding-formats">Claims Encoding Formats</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a class="auto internal xref" href="#section-10">10</a>. <a class="internal xref" href="#name-freshness">Freshness</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a class="auto internal xref" href="#section-10.1">10.1</a>.  <a class="internal xref" href="#name-explicit-timekeeping-using-">Explicit Timekeeping Using Synchronized Clocks</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a class="auto internal xref" href="#section-10.2">10.2</a>.  <a class="internal xref" href="#name-implicit-timekeeping-using-">Implicit Timekeeping Using Nonces</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.3">
                <p id="section-toc.1-1.10.2.3.1"><a class="auto internal xref" href="#section-10.3">10.3</a>.  <a class="internal xref" href="#name-implicit-timekeeping-using-e">Implicit Timekeeping Using Epoch IDs</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.4">
                <p id="section-toc.1-1.10.2.4.1"><a class="auto internal xref" href="#section-10.4">10.4</a>.  <a class="internal xref" href="#name-discussion">Discussion</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a class="auto internal xref" href="#section-11">11</a>. <a class="internal xref" href="#name-privacy-considerations">Privacy Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a class="auto internal xref" href="#section-12">12</a>. <a class="internal xref" href="#name-security-considerations">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a class="auto internal xref" href="#section-12.1">12.1</a>.  <a class="internal xref" href="#name-attester-and-attestation-ke">Attester and Attestation Key Protection</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1.2.1">
                    <p id="section-toc.1-1.12.2.1.2.1.1"><a class="auto internal xref" href="#section-12.1.1">12.1.1</a>.  <a class="internal xref" href="#name-on-device-attester-and-key-">On-Device Attester and Key Protection</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1.2.2">
                    <p id="section-toc.1-1.12.2.1.2.2.1"><a class="auto internal xref" href="#section-12.1.2">12.1.2</a>.  <a class="internal xref" href="#name-attestation-key-provisionin">Attestation Key Provisioning Processes</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a class="auto internal xref" href="#section-12.2">12.2</a>.  <a class="internal xref" href="#name-conceptual-message-protecti">Conceptual Message Protection</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.3">
                <p id="section-toc.1-1.12.2.3.1"><a class="auto internal xref" href="#section-12.3">12.3</a>.  <a class="internal xref" href="#name-attestation-based-on-epoch-">Attestation Based on Epoch ID</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.4">
                <p id="section-toc.1-1.12.2.4.1"><a class="auto internal xref" href="#section-12.4">12.4</a>.  <a class="internal xref" href="#name-trust-anchor-protection">Trust Anchor Protection</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a class="auto internal xref" href="#section-13">13</a>. <a class="internal xref" href="#name-iana-considerations">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a class="auto internal xref" href="#section-14">14</a>. <a class="internal xref" href="#name-references">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.1">
                <p id="section-toc.1-1.14.2.1.1"><a class="auto internal xref" href="#section-14.1">14.1</a>.  <a class="internal xref" href="#name-normative-references">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.2">
                <p id="section-toc.1-1.14.2.2.1"><a class="auto internal xref" href="#section-14.2">14.2</a>.  <a class="internal xref" href="#name-informative-references">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a class="auto internal xref" href="#appendix-A">Appendix A</a>.  <a class="internal xref" href="#name-time-considerations">Time Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.1">
                <p id="section-toc.1-1.15.2.1.1"><a class="auto internal xref" href="#appendix-A.1">A.1</a>.  <a class="internal xref" href="#name-example-1-timestamp-based-p">Example 1: Timestamp-Based Passport Model</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.2">
                <p id="section-toc.1-1.15.2.2.1"><a class="auto internal xref" href="#appendix-A.2">A.2</a>.  <a class="internal xref" href="#name-example-2-nonce-based-passp">Example 2: Nonce-Based Passport Model</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.3">
                <p id="section-toc.1-1.15.2.3.1"><a class="auto internal xref" href="#appendix-A.3">A.3</a>.  <a class="internal xref" href="#name-example-3-passport-model-ba">Example 3: Passport Model Based on Epoch ID</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.4">
                <p id="section-toc.1-1.15.2.4.1"><a class="auto internal xref" href="#appendix-A.4">A.4</a>.  <a class="internal xref" href="#name-example-4-timestamp-based-b">Example 4: Timestamp-Based Background-Check Model</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.5">
                <p id="section-toc.1-1.15.2.5.1"><a class="auto internal xref" href="#appendix-A.5">A.5</a>.  <a class="internal xref" href="#name-example-5-nonce-based-backg">Example 5: Nonce-Based Background-Check Model</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a class="auto internal xref" href="#appendix-B"></a><a class="internal xref" href="#name-acknowledgments">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17">
            <p id="section-toc.1-1.17.1"><a class="auto internal xref" href="#appendix-C"></a><a class="internal xref" href="#name-contributors">Contributors</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18">
            <p id="section-toc.1-1.18.1"><a class="auto internal xref" href="#appendix-D"></a><a class="internal xref" href="#name-authors-addresses">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a class="section-number selfRef" href="#section-1">1. </a><a class="section-name selfRef" href="#name-introduction">Introduction</a>
      </h2>
<p id="section-1-1">The question of how one system can know that another system can be trusted has found new interest and relevance in a world where trusted computing elements are maturing in processor architectures.<a class="pilcrow" href="#section-1-1">¶</a></p>
<p id="section-1-2">Systems that have been attested and verified to be in a good state
(for some value of "good") can improve overall system posture.
Conversely, systems that cannot be attested and verified to be in a
good state can be given reduced access or privileges, taken out of
service, or otherwise flagged for repair.<a class="pilcrow" href="#section-1-2">¶</a></p>
<p id="section-1-3">For example:<a class="pilcrow" href="#section-1-3">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-4.1">A bank backend system might refuse to transact with another system
that is not known to be in a good state.<a class="pilcrow" href="#section-1-4.1">¶</a>
</li>
        <li class="normal" id="section-1-4.2">A healthcare system might refuse to transmit electronic healthcare
records to a system that is not known to be in a good state.<a class="pilcrow" href="#section-1-4.2">¶</a>
</li>
      </ul>
<p id="section-1-5">In Remote ATtestation procedureS (RATS), one peer (the "Attester")
produces believable information about itself ("Evidence") to enable
a remote peer (the "Relying Party") to decide whether or not to consider that
Attester a trustworthy peer.
Remote attestation procedures are facilitated by an additional vital party (the "Verifier").<a class="pilcrow" href="#section-1-5">¶</a></p>
<p id="section-1-6">The Verifier appraises Evidence via appraisal policies and creates
the Attestation Results to support Relying Parties in their decision
process.
This document defines a flexible architecture consisting of attestation roles
and their interactions via conceptual messages.  Additionally, this document defines a universal set of terms that can be mapped to various existing and emerging remote attestation procedures.
Common topological patterns and the sequence of data flows associated with them, such as
the "Passport Model" and the "Background-Check Model", are illustrated.
The purpose is to define useful terminology for remote attestation and enable readers to map
their solution architecture to the canonical attestation architecture provided here.
Having a common terminology that provides well-understood meanings for common themes,
such as roles, device composition, topological patterns, and appraisal procedures, is vital for
semantic interoperability across solutions and platforms involving multiple vendors and providers.<a class="pilcrow" href="#section-1-6">¶</a></p>
<p id="section-1-7">Amongst other things, this document is about trust and trustworthiness.
Trust is a choice one makes about another system.  Trustworthiness is a
quality about the other system that can be used in making one's decision to
trust it or not.  This is a subtle difference; being familiar with the
difference is crucial for using this document.  Additionally, the concepts of freshness and trust relationships are specified to enable implementers to choose appropriate solutions
to compose their remote attestation procedures.<a class="pilcrow" href="#section-1-7">¶</a></p>
</section>
</div>
<div id="referenceusecases">
<section id="section-2">
      <h2 id="name-reference-use-cases">
<a class="section-number selfRef" href="#section-2">2. </a><a class="section-name selfRef" href="#name-reference-use-cases">Reference Use Cases</a>
      </h2>
<p id="section-2-1">This section covers a number of representative and generic use cases
      for remote attestation, independent of specific solutions.  The
      purpose is to provide motivation for various aspects of the architecture
      presented in this document.  Many other use cases exist; this document
      does not contain a complete list.  It only 
      illustrates a set of use cases that collectively cover all the
      functionality required in the architecture.<a class="pilcrow" href="#section-2-1">¶</a></p>
<p id="section-2-2">Each use case includes a description followed by an additional summary of the
Attester and Relying Party roles derived from the use case.<a class="pilcrow" href="#section-2-2">¶</a></p>
<div id="network-endpoint-assessment">
<section id="section-2.1">
        <h3 id="name-network-endpoint-assessment">
<a class="section-number selfRef" href="#section-2.1">2.1. </a><a class="section-name selfRef" href="#name-network-endpoint-assessment">Network Endpoint Assessment</a>
        </h3>
<p id="section-2.1-1">Network operators want trustworthy reports that include identity
and version information about the hardware and software on the
machines attached to their network. 
Examples of reports include purposes (such as inventory summaries), audit
results, and anomaly notifications (which typically include the maintenance of log
records or trend reports).  
The network operator may also want a policy by which full access is only
granted to devices that meet some definition of hygiene, and so wants to get
Claims about such information and verify its validity.  Remote attestation is
desired to prevent vulnerable or compromised devices from getting access to
the network and potentially harming others.<a class="pilcrow" href="#section-2.1-1">¶</a></p>
<p id="section-2.1-2">Typically, a solution starts with a specific component (sometimes referred to as a "root of trust") that often
provides a trustworthy device identity and performs a series of operations that enables trustworthiness appraisals for other components.
Such components perform operations that help determine the trustworthiness of yet other components
by collecting, protecting, or signing measurements.
Measurements that have been signed by such components are comprised of Evidence that either supports or refutes a claim of trustworthiness when evaluated.
Measurements can describe a variety of attributes of system components, such as hardware, firmware, BIOS, software, etc., and how they are hardened.<a class="pilcrow" href="#section-2.1-2">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2.1-3">
          <dt id="section-2.1-3.1">Attester:</dt>
          <dd id="section-2.1-3.2" style="margin-left: 1.5em">A device desiring access to a network.<a class="pilcrow" href="#section-2.1-3.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-3.3">Relying Party:</dt>
          <dd id="section-2.1-3.4" style="margin-left: 1.5em">Network equipment (such as a router, switch, or access point) that is
responsible for admission of the device into the network.<a class="pilcrow" href="#section-2.1-3.4">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="confidential-machine-learning-model-protection">
<section id="section-2.2">
        <h3 id="name-confidential-machine-learni">
<a class="section-number selfRef" href="#section-2.2">2.2. </a><a class="section-name selfRef" href="#name-confidential-machine-learni">Confidential Machine Learning Model Protection</a>
        </h3>
<p id="section-2.2-1">A device manufacturer wants to protect its intellectual property.
The intellectual property's scope primarily encompasses the machine learning (ML) model that is deployed in the devices purchased by its customers.
The protection goals include preventing attackers, potentially
the customer themselves, from seeing the details of the model.<a class="pilcrow" href="#section-2.2-1">¶</a></p>
<p id="section-2.2-2">Typically, this works by having some protected environment
in the device go through a remote attestation with some manufacturer service
that can assess its trustworthiness.  If remote attestation succeeds,
then the manufacturer service releases either the model or a key to decrypt
a model already deployed on the Attester in encrypted form to the requester.<a class="pilcrow" href="#section-2.2-2">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2.2-3">
          <dt id="section-2.2-3.1">Attester:</dt>
          <dd id="section-2.2-3.2" style="margin-left: 1.5em">
            A device desiring to run an ML model.<a class="pilcrow" href="#section-2.2-3.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-3.3">Relying Party:</dt>
          <dd id="section-2.2-3.4" style="margin-left: 1.5em">
            A server or service holding ML models it desires to protect.<a class="pilcrow" href="#section-2.2-3.4">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="confidential-data-protection">
<section id="section-2.3">
        <h3 id="name-confidential-data-protectio">
<a class="section-number selfRef" href="#section-2.3">2.3. </a><a class="section-name selfRef" href="#name-confidential-data-protectio">Confidential Data Protection</a>
        </h3>
<p id="section-2.3-1">This is a generalization of the ML model use case above where
the data can be any highly confidential data, such as health data
about customers, payroll data about employees, future business plans, etc.
As part of the attestation procedure, an assessment is made against a set
of policies to evaluate the state of the system that is requesting
the confidential data.  Attestation is desired to prevent leaking data via
compromised devices.<a class="pilcrow" href="#section-2.3-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2.3-2">
          <dt id="section-2.3-2.1">Attester:</dt>
          <dd id="section-2.3-2.2" style="margin-left: 1.5em">
           An entity desiring to retrieve confidential data.<a class="pilcrow" href="#section-2.3-2.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-2.3">Relying Party:</dt>
          <dd id="section-2.3-2.4" style="margin-left: 1.5em">
            An entity that holds confidential data for release to authorized entities.<a class="pilcrow" href="#section-2.3-2.4">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="critical-infrastructure-control">
<section id="section-2.4">
        <h3 id="name-critical-infrastructure-con">
<a class="section-number selfRef" href="#section-2.4">2.4. </a><a class="section-name selfRef" href="#name-critical-infrastructure-con">Critical Infrastructure Control</a>
        </h3>
<p id="section-2.4-1">Potentially harmful physical equipment (e.g., power grid, traffic
        control, hazardous chemical processing, etc.) is connected to a
        network in support of critical infrastructure.  The organization
        managing such infrastructure needs to ensure that only authorized code
        and users can control corresponding critical processes, and that these
        processes are protected from unauthorized manipulation or other
        threats.  
When a protocol operation can affect a critical system component of the
infrastructure, devices attached to that critical component require some
assurances depending on the security context, including assurances that a requesting
device or application has not been compromised and the requesters and actors
act on applicable policies.  As such, remote attestation can be used to only
accept commands from requesters that are within policy.<a class="pilcrow" href="#section-2.4-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2.4-2">
          <dt id="section-2.4-2.1">Attester:</dt>
          <dd id="section-2.4-2.2" style="margin-left: 1.5em">
            <p id="section-2.4-2.2.1">A device or application wishing to control physical equipment.<a class="pilcrow" href="#section-2.4-2.2.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.4-2.3">Relying Party:</dt>
          <dd id="section-2.4-2.4" style="margin-left: 1.5em">
            <p id="section-2.4-2.4.1">A device or application connected to potentially dangerous physical
equipment (hazardous chemical processing, traffic control, power grid,
etc.).<a class="pilcrow" href="#section-2.4-2.4.1">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="trusted-execution-environment-provisioning">
<section id="section-2.5">
        <h3 id="name-trusted-execution-environme">
<a class="section-number selfRef" href="#section-2.5">2.5. </a><a class="section-name selfRef" href="#name-trusted-execution-environme">Trusted Execution Environment Provisioning</a>
        </h3>
<p id="section-2.5-1">A Trusted Application Manager (TAM) server is responsible
for managing the applications running in a Trusted Execution Environment (TEE) of a client device, as described in <span>[<a class="cite xref" href="#I-D.ietf-teep-architecture">TEEP-ARCH</a>]</span>.
To achieve its purpose, the TAM needs to assess the state of a TEE or applications
in the TEE of a client device.  The TEE conducts remote attestation
procedures with the TAM, which can
then decide whether the TEE is already in compliance with the TAM's latest
policy.  If not, the TAM has to uninstall, update, or install approved
applications in the TEE to bring it back into compliance with the TAM's policy.<a class="pilcrow" href="#section-2.5-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2.5-2">
          <dt id="section-2.5-2.1">Attester:</dt>
          <dd id="section-2.5-2.2" style="margin-left: 1.5em">
            <p id="section-2.5-2.2.1">A device with a TEE capable of
running trusted applications that can be updated.<a class="pilcrow" href="#section-2.5-2.2.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.5-2.3">Relying Party:</dt>
          <dd id="section-2.5-2.4" style="margin-left: 1.5em">
            <p id="section-2.5-2.4.1">A TAM.<a class="pilcrow" href="#section-2.5-2.4.1">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="hardware-watchdog">
<section id="section-2.6">
        <h3 id="name-hardware-watchdog">
<a class="section-number selfRef" href="#section-2.6">2.6. </a><a class="section-name selfRef" href="#name-hardware-watchdog">Hardware Watchdog</a>
        </h3>
<p id="section-2.6-1">There is a class of malware that holds a device hostage and does
not allow it to reboot to prevent updates from being applied.
This can be a significant problem because it allows a fleet of devices to be held hostage for ransom.<a class="pilcrow" href="#section-2.6-1">¶</a></p>
<p id="section-2.6-2">A solution to this problem is a watchdog timer implemented in a protected
environment, such as a Trusted Platform Module (TPM),
as described in Section 43.3 of <span>[<a class="cite xref" href="#TCGarch">TCGarch</a>]</span>.
If the watchdog does not receive regular and fresh Attestation Results regarding the system's health, then it forces a reboot.<a class="pilcrow" href="#section-2.6-2">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2.6-3">
          <dt id="section-2.6-3.1">Attester:</dt>
          <dd id="section-2.6-3.2" style="margin-left: 1.5em">
            <p id="section-2.6-3.2.1">The device that should be protected from being held hostage for
a long period of time.<a class="pilcrow" href="#section-2.6-3.2.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.6-3.3">Relying Party:</dt>
          <dd id="section-2.6-3.4" style="margin-left: 1.5em">
            <p id="section-2.6-3.4.1">A watchdog capable of triggering a procedure that resets a device into
a known, good operational state.<a class="pilcrow" href="#section-2.6-3.4.1">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="fido-biometric-authentication">
<section id="section-2.7">
        <h3 id="name-fido-biometric-authenticati">
<a class="section-number selfRef" href="#section-2.7">2.7. </a><a class="section-name selfRef" href="#name-fido-biometric-authenticati">FIDO Biometric Authentication</a>
        </h3>
<p id="section-2.7-1">In the Fast IDentity Online (FIDO) protocol <span>[<a class="cite xref" href="#WebAuthN">WebAuthN</a>]</span>
          <span>[<a class="cite xref" href="#CTAP">CTAP</a>]</span>, the device in the user's hand authenticates the
     human user, whether by biometrics (such as fingerprints) or by PIN and
     password.  FIDO authentication puts a large amount of trust in the device
     compared to typical password authentication because it is the device that
     verifies the biometric, PIN, and password inputs from the user, not the
     server.  For the Relying Party to know that the authentication is
     trustworthy, the Relying Party needs to know that the Authenticator part
     of the device is trustworthy.  The FIDO protocol employs remote
     attestation for this.<a class="pilcrow" href="#section-2.7-1">¶</a></p>
<p id="section-2.7-2">The FIDO protocol supports several remote attestation protocols and a mechanism by which new ones can be registered and added; thus, remote attestation defined by the RATS architecture is a candidate for use in the FIDO protocol.<a class="pilcrow" href="#section-2.7-2">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2.7-3">
          <dt id="section-2.7-3.1">Attester:</dt>
          <dd id="section-2.7-3.2" style="margin-left: 1.5em">
            <p id="section-2.7-3.2.1">FIDO Authenticator.<a class="pilcrow" href="#section-2.7-3.2.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.7-3.3">Relying Party:</dt>
          <dd id="section-2.7-3.4" style="margin-left: 1.5em">
            <p id="section-2.7-3.4.1">Any website, mobile application backend, or service that relies on authentication data based on biometric information.<a class="pilcrow" href="#section-2.7-3.4.1">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="architectural-overview">
<section id="section-3">
      <h2 id="name-architectural-overview">
<a class="section-number selfRef" href="#section-3">3. </a><a class="section-name selfRef" href="#name-architectural-overview">Architectural Overview</a>
      </h2>
<p id="section-3-1"><a class="auto internal xref" href="#dataflow">Figure 1</a> depicts the data that flows between different roles, independent of protocol or use case.<a class="pilcrow" href="#section-3-1">¶</a></p>
<span id="name-conceptual-data-flow"></span><div id="dataflow">
<figure id="figure-1">
        <div id="section-3-2.1">
          <div class="alignCenter art-svg artwork" id="section-3-2.1.1">
<svg class="diagram" font-family="monospace" font-size="13px" height="416" text-anchor="middle" version="1.1" viewBox="0 0 560 416" width="560" xmlns="http://www.w3.org/2000/svg">
              <path d="M 8,352 L 8,384" fill="none" stroke="black"></path>
              <path d="M 32,64 L 32,160" fill="none" stroke="black"></path>
              <path d="M 56,256 L 56,352" fill="none" stroke="black"></path>
              <path d="M 96,352 L 96,384" fill="none" stroke="black"></path>
              <path d="M 128,48 L 128,80" fill="none" stroke="black"></path>
              <path d="M 128,224 L 128,256" fill="none" stroke="black"></path>
              <path d="M 144,192 L 144,216" fill="none" stroke="black"></path>
              <path d="M 184,96 L 184,216" fill="none" stroke="black"></path>
              <path d="M 224,48 L 224,80" fill="none" stroke="black"></path>
              <path d="M 272,48 L 272,64" fill="none" stroke="black"></path>
              <path d="M 312,80 L 312,216" fill="none" stroke="black"></path>
              <path d="M 336,224 L 336,256" fill="none" stroke="black"></path>
              <path d="M 360,48 L 360,64" fill="none" stroke="black"></path>
              <path d="M 360,352 L 360,384" fill="none" stroke="black"></path>
              <path d="M 392,256 L 392,344" fill="none" stroke="black"></path>
              <path d="M 408,48 L 408,64" fill="none" stroke="black"></path>
              <path d="M 456,80 L 456,344" fill="none" stroke="black"></path>
              <path d="M 488,352 L 488,384" fill="none" stroke="black"></path>
              <path d="M 536,48 L 536,64" fill="none" stroke="black"></path>
              <path d="M 24,32 L 80,32" fill="none" stroke="black"></path>
              <path d="M 144,32 L 208,32" fill="none" stroke="black"></path>
              <path d="M 288,32 L 344,32" fill="none" stroke="black"></path>
              <path d="M 424,32 L 520,32" fill="none" stroke="black"></path>
              <path d="M 24,64 L 80,64" fill="none" stroke="black"></path>
              <path d="M 288,80 L 344,80" fill="none" stroke="black"></path>
              <path d="M 424,80 L 520,80" fill="none" stroke="black"></path>
              <path d="M 144,96 L 208,96" fill="none" stroke="black"></path>
              <path d="M 48,176 L 128,176" fill="none" stroke="black"></path>
              <path d="M 128,224 L 336,224" fill="none" stroke="black"></path>
              <path d="M 72,240 L 120,240" fill="none" stroke="black"></path>
              <path d="M 336,240 L 376,240" fill="none" stroke="black"></path>
              <path d="M 128,256 L 336,256" fill="none" stroke="black"></path>
              <path d="M 8,352 L 96,352" fill="none" stroke="black"></path>
              <path d="M 360,352 L 488,352" fill="none" stroke="black"></path>
              <path d="M 8,384 L 96,384" fill="none" stroke="black"></path>
              <path d="M 360,384 L 488,384" fill="none" stroke="black"></path>
              <path d="M 24,32 C 15.16936,32 8,39.16936 8,48" fill="none" stroke="black"></path>
              <path d="M 80,32 C 88.83064,32 96,39.16936 96,48" fill="none" stroke="black"></path>
              <path d="M 144,32 C 135.16936,32 128,39.16936 128,48" fill="none" stroke="black"></path>
              <path d="M 208,32 C 216.83064,32 224,39.16936 224,48" fill="none" stroke="black"></path>
              <path d="M 288,32 C 279.16936,32 272,39.16936 272,48" fill="none" stroke="black"></path>
              <path d="M 344,32 C 352.83064,32 360,39.16936 360,48" fill="none" stroke="black"></path>
              <path d="M 424,32 C 415.16936,32 408,39.16936 408,48" fill="none" stroke="black"></path>
              <path d="M 520,32 C 528.83064,32 536,39.16936 536,48" fill="none" stroke="black"></path>
              <path d="M 24,64 C 15.16936,64 8,56.83064 8,48" fill="none" stroke="black"></path>
              <path d="M 80,64 C 88.83064,64 96,56.83064 96,48" fill="none" stroke="black"></path>
              <path d="M 288,80 C 279.16936,80 272,72.83064 272,64" fill="none" stroke="black"></path>
              <path d="M 344,80 C 352.83064,80 360,72.83064 360,64" fill="none" stroke="black"></path>
              <path d="M 424,80 C 415.16936,80 408,72.83064 408,64" fill="none" stroke="black"></path>
              <path d="M 520,80 C 528.83064,80 536,72.83064 536,64" fill="none" stroke="black"></path>
              <path d="M 144,96 C 135.16936,96 128,88.83064 128,80" fill="none" stroke="black"></path>
              <path d="M 208,96 C 216.83064,96 224,88.83064 224,80" fill="none" stroke="black"></path>
              <path d="M 48,176 C 39.16936,176 32,168.83064 32,160" fill="none" stroke="black"></path>
              <path d="M 128,176 C 136.83064,176 144,183.16936 144,192" fill="none" stroke="black"></path>
              <path d="M 72,240 C 63.16936,240 56,247.16936 56,256" fill="none" stroke="black"></path>
              <path d="M 376,240 C 384.83064,240 392,247.16936 392,256" fill="none" stroke="black"></path>
              <polygon class="arrowhead" fill="black" points="464,344 452,338.4 452,349.6" transform="rotate(90,456,344)"></polygon>
              <polygon class="arrowhead" fill="black" points="400,344 388,338.4 388,349.6" transform="rotate(90,392,344)"></polygon>
              <polygon class="arrowhead" fill="black" points="320,216 308,210.4 308,221.6" transform="rotate(90,312,216)"></polygon>
              <polygon class="arrowhead" fill="black" points="192,216 180,210.4 180,221.6" transform="rotate(90,184,216)"></polygon>
              <polygon class="arrowhead" fill="black" points="152,216 140,210.4 140,221.6" transform="rotate(90,144,216)"></polygon>
              <polygon class="arrowhead" fill="black" points="128,240 116,234.4 116,245.6" transform="rotate(0,120,240)"></polygon>
              <g class="text">
                <text x="52" y="52">Endorser</text>
                <text x="176" y="52">Reference</text>
                <text x="316" y="52">Verifier</text>
                <text x="448" y="52">Relying</text>
                <text x="504" y="52">Party</text>
                <text x="160" y="68">Value</text>
                <text x="304" y="68">Owner</text>
                <text x="440" y="68">Owner</text>
                <text x="172" y="84">Provider</text>
                <text x="92" y="132">Endorsements</text>
                <text x="232" y="132">Reference</text>
                <text x="360" y="132">Appraisal</text>
                <text x="504" y="132">Appraisal</text>
                <text x="220" y="148">Values</text>
                <text x="348" y="148">Policy</text>
                <text x="392" y="148">for</text>
                <text x="492" y="148">Policy</text>
                <text x="536" y="148">for</text>
                <text x="356" y="164">Evidence</text>
                <text x="512" y="164">Attestation</text>
                <text x="496" y="180">Results</text>
                <text x="236" y="244">Verifier</text>
                <text x="100" y="292">Evidence</text>
                <text x="336" y="292">Attestation</text>
                <text x="320" y="308">Results</text>
                <text x="52" y="372">Attester</text>
                <text x="400" y="372">Relying</text>
                <text x="456" y="372">Party</text>
              </g>
            </svg><a class="pilcrow" href="#section-3-2.1.1">¶</a>
</div>
</div>
<figcaption><a class="selfRef" href="#figure-1">Figure 1</a>:
<a class="selfRef" href="#name-conceptual-data-flow">Conceptual Data Flow</a>
        </figcaption></figure>
</div>
<p id="section-3-3">The text below summarizes the activities conducted by the roles illustrated in <a class="auto internal xref" href="#dataflow">Figure 1</a>.
Roles are assigned to entities. Entities are often system components <span>[<a class="cite xref" href="#RFC4949">RFC4949</a>]</span>, such as devices. As the term "device" is typically more intuitive than the term "entity" or "system component", device is often used as an illustrative synonym throughout this document.<a class="pilcrow" href="#section-3-3">¶</a></p>
<p id="section-3-4">The Attester role is assigned to entities that create Evidence that is conveyed to a Verifier.<a class="pilcrow" href="#section-3-4">¶</a></p>
<p id="section-3-5">The Verifier role is assigned to entities that use the Evidence, any Reference Values from Reference Value Providers, and any Endorsements from Endorsers
by applying an Appraisal Policy for Evidence to assess the trustworthiness of the Attester.
This procedure is called the "appraisal of Evidence".<a class="pilcrow" href="#section-3-5">¶</a></p>
<p id="section-3-6">Subsequently, the Verifier role generates Attestation Results for use by Relying Parties.<a class="pilcrow" href="#section-3-6">¶</a></p>
<p id="section-3-7">The Appraisal Policy for Evidence might be obtained from the Verifier Owner via some protocol mechanism, configured into the Verifier by the Verifier Owner, programmed into the Verifier,
or obtained via some other mechanism.<a class="pilcrow" href="#section-3-7">¶</a></p>
<p id="section-3-8">The Relying Party role is assigned to an entity that uses Attestation Results by applying its own
appraisal policy to make application-specific decisions, such as authorization decisions.
This procedure is called the "appraisal of Attestation Results".<a class="pilcrow" href="#section-3-8">¶</a></p>
<p id="section-3-9">The Appraisal Policy for Attestation Results might be obtained from the Relying Party Owner via some protocol mechanism, configured into the Relying Party by the Relying Party Owner, programmed into the Relying Party, or obtained via some other mechanism.<a class="pilcrow" href="#section-3-9">¶</a></p>
<p id="section-3-10">See <a class="auto internal xref" href="#messages">Section 8</a> for further discussion of the conceptual messages shown in <a class="auto internal xref" href="#dataflow">Figure 1</a>.  <a class="auto internal xref" href="#terminology">Section 4</a> provides a more complete definition of all RATS roles.<a class="pilcrow" href="#section-3-10">¶</a></p>
<div id="twotypes">
<section id="section-3.1">
        <h3 id="name-two-types-of-environments-o">
<a class="section-number selfRef" href="#section-3.1">3.1. </a><a class="section-name selfRef" href="#name-two-types-of-environments-o">Two Types of Environments of an Attester</a>
        </h3>
<p id="section-3.1-1">As shown in <a class="auto internal xref" href="#twotypes-env">Figure 2</a>, an Attester consists of at least one Attesting Environment and at least one
Target Environment co-located in one entity.
In some implementations, the Attesting and Target Environments might be combined into one environment.
Other implementations might have multiple Attesting and Target Environments,
such as in the examples described in more detail in Sections <a class="auto internal xref" href="#layered-attestation">3.2</a>
and <a class="auto internal xref" href="#compositedevice">3.3</a>.  Other examples may exist. All compositions of Attesting and Target Environments discussed in this architecture can be combined into more complex implementations.<a class="pilcrow" href="#section-3.1-1">¶</a></p>
<span id="name-two-types-of-environments-w"></span><div id="twotypes-env">
<figure id="figure-2">
          <div id="section-3.1-2.1">
            <div class="alignCenter art-svg artwork" id="section-3.1-2.1.1">
<svg class="diagram" font-family="monospace" font-size="13px" height="464" text-anchor="middle" version="1.1" viewBox="0 0 320 464" width="320" xmlns="http://www.w3.org/2000/svg">
                <path d="M 8,144 L 8,448" fill="none" stroke="black"></path>
                <path d="M 24,32 L 24,96" fill="none" stroke="black"></path>
                <path d="M 48,176 L 48,240" fill="none" stroke="black"></path>
                <path d="M 152,352 L 152,416" fill="none" stroke="black"></path>
                <path d="M 168,240 L 168,344" fill="none" stroke="black"></path>
                <path d="M 184,176 L 184,240" fill="none" stroke="black"></path>
                <path d="M 216,104 L 216,352" fill="none" stroke="black"></path>
                <path d="M 264,352 L 264,416" fill="none" stroke="black"></path>
                <path d="M 288,32 L 288,96" fill="none" stroke="black"></path>
                <path d="M 304,144 L 304,448" fill="none" stroke="black"></path>
                <path d="M 24,32 L 288,32" fill="none" stroke="black"></path>
                <path d="M 24,96 L 288,96" fill="none" stroke="black"></path>
                <path d="M 8,144 L 208,144" fill="none" stroke="black"></path>
                <path d="M 224,144 L 304,144" fill="none" stroke="black"></path>
                <path d="M 48,176 L 184,176" fill="none" stroke="black"></path>
                <path d="M 48,240 L 184,240" fill="none" stroke="black"></path>
                <path d="M 152,352 L 264,352" fill="none" stroke="black"></path>
                <path d="M 152,416 L 264,416" fill="none" stroke="black"></path>
                <path d="M 8,448 L 304,448" fill="none" stroke="black"></path>
                <polygon class="arrowhead" fill="black" points="224,104 212,98.4 212,109.6" transform="rotate(270,216,104)"></polygon>
                <polygon class="arrowhead" fill="black" points="176,344 164,338.4 164,349.6" transform="rotate(90,168,344)"></polygon>
                <g class="text">
                  <text x="156" y="68">Verifier</text>
                  <text x="84" y="196">Target</text>
                  <text x="104" y="212">Environment</text>
                  <text x="260" y="228">Evidence</text>
                  <text x="128" y="292">Collect</text>
                  <text x="132" y="308">Claims</text>
                  <text x="200" y="372">Attesting</text>
                  <text x="208" y="388">Environment</text>
                  <text x="164" y="436">Attester</text>
                </g>
              </svg><a class="pilcrow" href="#section-3.1-2.1.1">¶</a>
</div>
</div>
<figcaption><a class="selfRef" href="#figure-2">Figure 2</a>:
<a class="selfRef" href="#name-two-types-of-environments-w">Two Types of Environments within an Attester</a>
          </figcaption></figure>
</div>
<p id="section-3.1-3">Claims are collected from Target Environments.
That is, Attesting Environments collect the values and the information to be represented in Claims by reading system registers and variables, calling into subsystems, and taking measurements on code, memory, or other relevant assets of the Target Environment.
Attesting Environments then format the Claims appropriately; typically, they
use key material and
cryptographic functions, such as signing or cipher algorithms, to
generate Evidence.
There is no limit or requirement on the types of hardware or software environments that can be used to implement an Attesting Environment. For example, TEEs, embedded Secure Elements
(eSEs), TPMs <span>[<a class="cite xref" href="#TCGarch">TCGarch</a>]</span>, or BIOS firmware.<a class="pilcrow" href="#section-3.1-3">¶</a></p>
<p id="section-3.1-4">An arbitrary execution environment may not, by default, be capable of Claims collection for a given Target Environment.
Execution environments that are designed specifically to be capable of Claims collection are referred to in this document as "Attesting Environments".
For example, a TPM doesn't actively collect Claims itself.  Instead, it
requires another component to feed various values to the TPM.
Thus, an Attesting Environment in such a case would be the combination
of the TPM together with whatever component is feeding it the measurements.<a class="pilcrow" href="#section-3.1-4">¶</a></p>
</section>
</div>
<div id="layered-attestation">
<section id="section-3.2">
        <h3 id="name-layered-attestation-environ">
<a class="section-number selfRef" href="#section-3.2">3.2. </a><a class="section-name selfRef" href="#name-layered-attestation-environ">Layered Attestation Environments</a>
        </h3>
<p id="section-3.2-1">By definition, the Attester role generates Evidence.  An Attester
        may consist of one or more nested environments (layers).  The bottom
        layer of an Attester has an Attesting Environment that is typically
        designed to be immutable or difficult to modify by malicious code.  In
        order to appraise Evidence generated by an Attester, the Verifier
        needs to trust various layers, including the bottom Attesting
        Environment.  Trust in the Attester's layers, including the bottom
        layer, can be established in various ways, as discussed in <a class="auto internal xref" href="#verifier">Section 7.4</a>.<a class="pilcrow" href="#section-3.2-1">¶</a></p>
<p id="section-3.2-2">In layered attestation, Claims can be collected from or about each
        layer beginning with an initial layer.  The corresponding Claims can
        be structured in a nested fashion that reflects the nesting of the
        Attester's layers.  Normally, Claims are not self-asserted.  Rather, a
        previous layer acts as the Attesting Environment for the next layer.
        Claims about an initial layer are typically asserted by an
        Endorser.<a class="pilcrow" href="#section-3.2-2">¶</a></p>
<p id="section-3.2-3">The example device illustrated in <a class="auto internal xref" href="#layered">Figure 3</a> includes
        (A) a BIOS stored in read-only memory, (B) a bootloader, and (C) an
        operating system kernel.<a class="pilcrow" href="#section-3.2-3">¶</a></p>
<span id="name-layered-attester"></span><div id="layered">
<figure id="figure-3">
          <div id="section-3.2-4.1">
            <div class="alignCenter art-svg artwork" id="section-3.2-4.1.1">
<svg class="diagram" font-family="monospace" font-size="13px" height="656" text-anchor="middle" version="1.1" viewBox="0 0 448 656" width="448" xmlns="http://www.w3.org/2000/svg">
                <path d="M 8,192 L 8,640" fill="none" stroke="black"></path>
                <path d="M 40,32 L 40,64" fill="none" stroke="black"></path>
                <path d="M 40,96 L 40,160" fill="none" stroke="black"></path>
                <path d="M 40,224 L 40,304" fill="none" stroke="black"></path>
                <path d="M 40,352 L 40,480" fill="none" stroke="black"></path>
                <path d="M 40,528 L 40,608" fill="none" stroke="black"></path>
                <path d="M 152,32 L 152,64" fill="none" stroke="black"></path>
                <path d="M 152,96 L 152,160" fill="none" stroke="black"></path>
                <path d="M 160,384 L 160,448" fill="none" stroke="black"></path>
                <path d="M 168,480 L 168,520" fill="none" stroke="black"></path>
                <path d="M 176,304 L 176,376" fill="none" stroke="black"></path>
                <path d="M 192,456 L 192,528" fill="none" stroke="black"></path>
                <path d="M 256,384 L 256,448" fill="none" stroke="black"></path>
                <path d="M 272,224 L 272,304" fill="none" stroke="black"></path>
                <path d="M 272,352 L 272,408" fill="none" stroke="black"></path>
                <path d="M 272,424 L 272,480" fill="none" stroke="black"></path>
                <path d="M 272,528 L 272,608" fill="none" stroke="black"></path>
                <path d="M 304,96 L 304,160" fill="none" stroke="black"></path>
                <path d="M 312,192 L 312,408" fill="none" stroke="black"></path>
                <path d="M 312,424 L 312,640" fill="none" stroke="black"></path>
                <path d="M 344,48 L 344,88" fill="none" stroke="black"></path>
                <path d="M 352,168 L 352,416" fill="none" stroke="black"></path>
                <path d="M 392,96 L 392,160" fill="none" stroke="black"></path>
                <path d="M 40,32 L 152,32" fill="none" stroke="black"></path>
                <path d="M 152,48 L 344,48" fill="none" stroke="black"></path>
                <path d="M 40,64 L 152,64" fill="none" stroke="black"></path>
                <path d="M 40,96 L 152,96" fill="none" stroke="black"></path>
                <path d="M 304,96 L 392,96" fill="none" stroke="black"></path>
                <path d="M 152,128 L 296,128" fill="none" stroke="black"></path>
                <path d="M 40,160 L 152,160" fill="none" stroke="black"></path>
                <path d="M 304,160 L 392,160" fill="none" stroke="black"></path>
                <path d="M 8,192 L 312,192" fill="none" stroke="black"></path>
                <path d="M 40,224 L 272,224" fill="none" stroke="black"></path>
                <path d="M 40,304 L 272,304" fill="none" stroke="black"></path>
                <path d="M 40,352 L 168,352" fill="none" stroke="black"></path>
                <path d="M 184,352 L 272,352" fill="none" stroke="black"></path>
                <path d="M 160,384 L 256,384" fill="none" stroke="black"></path>
                <path d="M 256,416 L 352,416" fill="none" stroke="black"></path>
                <path d="M 160,448 L 256,448" fill="none" stroke="black"></path>
                <path d="M 40,480 L 184,480" fill="none" stroke="black"></path>
                <path d="M 200,480 L 272,480" fill="none" stroke="black"></path>
                <path d="M 40,528 L 272,528" fill="none" stroke="black"></path>
                <path d="M 40,608 L 272,608" fill="none" stroke="black"></path>
                <path d="M 8,640 L 312,640" fill="none" stroke="black"></path>
                <polygon class="arrowhead" fill="black" points="360,168 348,162.4 348,173.6" transform="rotate(270,352,168)"></polygon>
                <polygon class="arrowhead" fill="black" points="352,88 340,82.4 340,93.6" transform="rotate(90,344,88)"></polygon>
                <polygon class="arrowhead" fill="black" points="304,128 292,122.4 292,133.6" transform="rotate(0,296,128)"></polygon>
                <polygon class="arrowhead" fill="black" points="200,456 188,450.4 188,461.6" transform="rotate(270,192,456)"></polygon>
                <polygon class="arrowhead" fill="black" points="184,376 172,370.4 172,381.6" transform="rotate(90,176,376)"></polygon>
                <polygon class="arrowhead" fill="black" points="176,520 164,514.4 164,525.6" transform="rotate(90,168,520)"></polygon>
                <g class="text">
                  <text x="224" y="36">Endorsement</text>
                  <text x="288" y="36">for</text>
                  <text x="320" y="36">ROM</text>
                  <text x="92" y="52">Endorser</text>
                  <text x="216" y="100">Reference</text>
                  <text x="88" y="116">Reference</text>
                  <text x="204" y="116">Values</text>
                  <text x="248" y="116">for</text>
                  <text x="72" y="132">Value</text>
                  <text x="348" y="132">Verifier</text>
                  <text x="96" y="148">Provider(s)</text>
                  <text x="180" y="148">ROM,</text>
                  <text x="248" y="148">bootloader,</text>
                  <text x="200" y="164">and</text>
                  <text x="244" y="164">kernel</text>
                  <text x="88" y="244">Kernel(C)</text>
                  <text x="392" y="260">Layered</text>
                  <text x="92" y="276">Target</text>
                  <text x="396" y="276">Evidence</text>
                  <text x="96" y="292">Environment</text>
                  <text x="392" y="292">for</text>
                  <text x="404" y="308">bootloader</text>
                  <text x="136" y="324">Collect</text>
                  <text x="392" y="324">and</text>
                  <text x="132" y="340">Claims</text>
                  <text x="388" y="340">kernel</text>
                  <text x="104" y="372">Bootloader(B)</text>
                  <text x="92" y="404">Target</text>
                  <text x="208" y="404">Attesting</text>
                  <text x="96" y="420">Environment</text>
                  <text x="208" y="420">Environment</text>
                  <text x="128" y="500">Collect</text>
                  <text x="236" y="500">Evidence</text>
                  <text x="288" y="500">for</text>
                  <text x="124" y="516">Claims</text>
                  <text x="244" y="516">bootloader</text>
                  <text x="76" y="548">ROM(A)</text>
                  <text x="208" y="580">Attesting</text>
                  <text x="208" y="596">Environment</text>
                </g>
              </svg><a class="pilcrow" href="#section-3.2-4.1.1">¶</a>
</div>
</div>
<figcaption><a class="selfRef" href="#figure-3">Figure 3</a>:
<a class="selfRef" href="#name-layered-attester">Layered Attester</a>
          </figcaption></figure>
</div>
<p id="section-3.2-5">The first Attesting Environment (the ROM in this example)
has to ensure the integrity of the bootloader (the first Target Environment).
There are
potentially multiple kernels to boot; the decision is up to the bootloader.
Only a bootloader with intact integrity will make an appropriate decision.
Therefore, the Claims relating to the integrity of the bootloader have to be measured securely.
At this stage of the boot cycle of the
device, the Claims collected typically cannot be composed into Evidence.<a class="pilcrow" href="#section-3.2-5">¶</a></p>
<p id="section-3.2-6">After the boot sequence is started, the BIOS conducts the most
        important and defining feature of layered attestation: the
        successfully measured bootloader now becomes (or contains) an
        Attesting Environment for the next layer.  This procedure in layered
        attestation is sometimes called "staging".  It is important that the
        bootloader not be able to alter any Claims about itself that were
        collected by the BIOS.  This can be ensured having those Claims be
        either signed by the BIOS or stored in a tamper-proof manner by the
        BIOS.<a class="pilcrow" href="#section-3.2-6">¶</a></p>
<p id="section-3.2-7">Continuing with this example, the bootloader's Attesting
        Environment is now in charge of collecting Claims about the next
        Target Environment.  In this example, it is the kernel to be booted.

The final Evidence thus contains two sets of Claims: one set about the
bootloader as measured and signed by the BIOS and another set of Claims about the
kernel as measured and signed by the bootloader.<a class="pilcrow" href="#section-3.2-7">¶</a></p>
<p id="section-3.2-8">This example could be extended further by making the kernel become another
Attesting Environment for an application as another Target Environment.
This would result in a third set of Claims in the Evidence pertaining to that application.<a class="pilcrow" href="#section-3.2-8">¶</a></p>
<p id="section-3.2-9">The essence of this example is a cascade of staged environments. Each
environment has the responsibility
of measuring the next environment before the next environment is started.
In general, the number of layers may vary by device or implementation,
and an Attesting Environment might even have multiple Target Environments
that it measures, rather than only one as shown by example in <a class="auto internal xref" href="#layered">Figure 3</a>.<a class="pilcrow" href="#section-3.2-9">¶</a></p>
</section>
</div>
<div id="compositedevice">
<section id="section-3.3">
        <h3 id="name-composite-device">
<a class="section-number selfRef" href="#section-3.3">3.3. </a><a class="section-name selfRef" href="#name-composite-device">Composite Device</a>
        </h3>
<p id="section-3.3-1">A composite device is an entity composed of multiple sub-entities such that its
trustworthiness has to be determined by the appraisal of all these sub-entities.<a class="pilcrow" href="#section-3.3-1">¶</a></p>
<p id="section-3.3-2">Each sub-entity has at least one Attesting Environment collecting the Claims
from at least one Target Environment. Then, this sub-entity generates Evidence
about its trustworthiness; therefore, each sub-entity can be called an "Attester".
Among all the Attesters, there may be only some that have the ability to communicate
with the Verifier while others do not.<a class="pilcrow" href="#section-3.3-2">¶</a></p>
<p id="section-3.3-3">For example, a carrier-grade router consists of a chassis and multiple slots.
The trustworthiness of the router depends on all its slots' trustworthiness.
Each slot has an Attesting Environment, such as a TEE, collecting the
Claims of its boot process, after which it generates Evidence from the Claims.<a class="pilcrow" href="#section-3.3-3">¶</a></p>
<p id="section-3.3-4">Among these slots, only a "main" slot can communicate with the Verifier
while other slots cannot. However, other slots can communicate with the main
slot by the links between them inside the router.
The main slot collects the Evidence of other slots, produces the final Evidence of the whole router, and conveys the final Evidence to the Verifier.
Therefore, the router is a composite
device, each slot is an Attester, and the main slot is the lead Attester.<a class="pilcrow" href="#section-3.3-4">¶</a></p>
<p id="section-3.3-5">Another example is a multi-chassis router composed of multiple single carrier-grade routers.
Multi-chassis router setups create redundancy groups that provide higher throughput by interconnecting
multiple routers in these groups, which can be treated as one logical router for simpler management.
A multi-chassis router setup provides a management point that connects to the Verifier.
Typically, one router in the group is designated as the main router.
Other routers in the multi-chassis setup are connected to the main router only via physical network links; therefore, they are managed and appraised via the main router's help.
Consequently, a multi-chassis router setup is a composite device,
each router is an Attester, and the main router is the lead Attester.<a class="pilcrow" href="#section-3.3-5">¶</a></p>
<p id="section-3.3-6"><a class="auto internal xref" href="#composite">Figure 4</a> depicts the conceptual data flow for a composite device.<a class="pilcrow" href="#section-3.3-6">¶</a></p>
<span id="name-composite-device-2"></span><div id="composite">
<figure id="figure-4">
          <div id="section-3.3-7.1">
            <div class="alignCenter art-svg artwork" id="section-3.3-7.1.1">
<svg class="diagram" font-family="monospace" font-size="13px" height="416" text-anchor="middle" version="1.1" viewBox="0 0 552 416" width="552" xmlns="http://www.w3.org/2000/svg">
                <path d="M 8,160 L 8,400" fill="none" stroke="black"></path>
                <path d="M 24,176 L 24,352" fill="none" stroke="black"></path>
                <path d="M 48,240 L 48,304" fill="none" stroke="black"></path>
                <path d="M 120,208 L 120,240" fill="none" stroke="black"></path>
                <path d="M 160,32 L 160,64" fill="none" stroke="black"></path>
                <path d="M 184,240 L 184,304" fill="none" stroke="black"></path>
                <path d="M 208,192 L 208,288" fill="none" stroke="black"></path>
                <path d="M 288,72 L 288,192" fill="none" stroke="black"></path>
                <path d="M 312,192 L 312,288" fill="none" stroke="black"></path>
                <path d="M 336,176 L 336,200" fill="none" stroke="black"></path>
                <path d="M 336,280 L 336,352" fill="none" stroke="black"></path>
                <path d="M 392,176 L 392,224" fill="none" stroke="black"></path>
                <path d="M 400,32 L 400,64" fill="none" stroke="black"></path>
                <path d="M 408,224 L 408,256" fill="none" stroke="black"></path>
                <path d="M 424,256 L 424,288" fill="none" stroke="black"></path>
                <path d="M 496,176 L 496,224" fill="none" stroke="black"></path>
                <path d="M 512,208 L 512,256" fill="none" stroke="black"></path>
                <path d="M 528,240 L 528,288" fill="none" stroke="black"></path>
                <path d="M 544,160 L 544,400" fill="none" stroke="black"></path>
                <path d="M 160,32 L 400,32" fill="none" stroke="black"></path>
                <path d="M 160,64 L 400,64" fill="none" stroke="black"></path>
                <path d="M 8,160 L 280,160" fill="none" stroke="black"></path>
                <path d="M 296,160 L 544,160" fill="none" stroke="black"></path>
                <path d="M 24,176 L 280,176" fill="none" stroke="black"></path>
                <path d="M 296,176 L 336,176" fill="none" stroke="black"></path>
                <path d="M 392,176 L 496,176" fill="none" stroke="black"></path>
                <path d="M 208,192 L 312,192" fill="none" stroke="black"></path>
                <path d="M 120,208 L 200,208" fill="none" stroke="black"></path>
                <path d="M 320,208 L 392,208" fill="none" stroke="black"></path>
                <path d="M 496,208 L 512,208" fill="none" stroke="black"></path>
                <path d="M 392,224 L 496,224" fill="none" stroke="black"></path>
                <path d="M 48,240 L 184,240" fill="none" stroke="black"></path>
                <path d="M 320,240 L 408,240" fill="none" stroke="black"></path>
                <path d="M 512,240 L 528,240" fill="none" stroke="black"></path>
                <path d="M 408,256 L 512,256" fill="none" stroke="black"></path>
                <path d="M 320,272 L 424,272" fill="none" stroke="black"></path>
                <path d="M 208,288 L 312,288" fill="none" stroke="black"></path>
                <path d="M 424,288 L 528,288" fill="none" stroke="black"></path>
                <path d="M 48,304 L 184,304" fill="none" stroke="black"></path>
                <path d="M 24,352 L 336,352" fill="none" stroke="black"></path>
                <path d="M 8,400 L 544,400" fill="none" stroke="black"></path>
                <polygon class="arrowhead" fill="black" points="328,272 316,266.4 316,277.6" transform="rotate(180,320,272)"></polygon>
                <polygon class="arrowhead" fill="black" points="328,240 316,234.4 316,245.6" transform="rotate(180,320,240)"></polygon>
                <polygon class="arrowhead" fill="black" points="328,208 316,202.4 316,213.6" transform="rotate(180,320,208)"></polygon>
                <polygon class="arrowhead" fill="black" points="296,72 284,66.4 284,77.6" transform="rotate(270,288,72)"></polygon>
                <polygon class="arrowhead" fill="black" points="208,208 196,202.4 196,213.6" transform="rotate(0,200,208)"></polygon>
                <g class="text">
                  <text x="284" y="52">Verifier</text>
                  <text x="332" y="116">Evidence</text>
                  <text x="380" y="116">of</text>
                  <text x="336" y="132">Composite</text>
                  <text x="404" y="132">Device</text>
                  <text x="72" y="196">Collect</text>
                  <text x="68" y="212">Claims</text>
                  <text x="264" y="212">Attesting</text>
                  <text x="436" y="212">Attester</text>
                  <text x="480" y="212">B</text>
                  <text x="256" y="228">Environment</text>
                  <text x="336" y="228">|</text>
                  <text x="452" y="244">Attester</text>
                  <text x="496" y="244">C</text>
                  <text x="116" y="260">Target</text>
                  <text x="336" y="260">|</text>
                  <text x="116" y="276">Environment(s)</text>
                  <text x="448" y="276">...</text>
                  <text x="380" y="292">Evidence</text>
                  <text x="380" y="308">of</text>
                  <text x="384" y="324">Attesters</text>
                  <text x="52" y="340">lead</text>
                  <text x="108" y="340">Attester</text>
                  <text x="152" y="340">A</text>
                  <text x="364" y="340">(via</text>
                  <text x="420" y="340">Internal</text>
                  <text x="480" y="340">Links</text>
                  <text x="516" y="340">or</text>
                  <text x="376" y="356">Network</text>
                  <text x="460" y="356">Connections)</text>
                  <text x="232" y="388">Composite</text>
                  <text x="300" y="388">Device</text>
                </g>
              </svg><a class="pilcrow" href="#section-3.3-7.1.1">¶</a>
</div>
</div>
<figcaption><a class="selfRef" href="#figure-4">Figure 4</a>:
<a class="selfRef" href="#name-composite-device-2">Composite Device</a>
          </figcaption></figure>
</div>
<p id="section-3.3-8">In a composite device, each Attester generates its own Evidence by its
Attesting Environment(s) collecting the Claims from its Target Environment(s).
The lead Attester collects Evidence from other Attesters and conveys it to a Verifier.
Collection of Evidence from sub-entities may itself be a form of Claims collection that results in Evidence asserted by the lead Attester.
The lead Attester generates Evidence about the layout of the whole composite device, while sub-Attesters generate Evidence about their respective (sub-)modules.<a class="pilcrow" href="#section-3.3-8">¶</a></p>
<p id="section-3.3-9">In this scenario, the trust model described in <a class="auto internal xref" href="#trustmodel">Section 7</a> can also be applied to an inside Verifier.<a class="pilcrow" href="#section-3.3-9">¶</a></p>
</section>
</div>
<div id="implementation-considerations">
<section id="section-3.4">
        <h3 id="name-implementation-consideratio">
<a class="section-number selfRef" href="#section-3.4">3.4. </a><a class="section-name selfRef" href="#name-implementation-consideratio">Implementation Considerations</a>
        </h3>
<p id="section-3.4-1">An entity can take on multiple RATS roles (e.g., Attester, Verifier, Relying
Party, etc.) at the same time.
Multiple entities can cooperate to implement a single RATS role as well.
In essence, the combination of roles and entities can be arbitrary.
For example, in the composite device scenario, the entity inside
the lead Attester can also take on the role of a Verifier and the
outer entity of Verifier can take on the role of a Relying Party.
After collecting the Evidence of other Attesters, this inside Verifier uses
Endorsements and appraisal policies (obtained the same way as by any other
Verifier) as part of the appraisal procedures that generate Attestation Results.
The inside Verifier then conveys the Attestation Results of other Attesters to the outside Verifier,
whether in the same conveyance protocol as part of the Evidence or not.<a class="pilcrow" href="#section-3.4-1">¶</a></p>
<p id="section-3.4-2">As explained in <a class="auto internal xref" href="#terminology">Section 4</a>, there are a variety of roles in the RATS architecture; they are defined by a unique combination of artifacts they produce and consume.
Conversely, artifacts are also defined by the roles that produce or consume them.
To produce an artifact means that a given role introduces it into the RATS architecture.
To consume an artifact means that a given role has responsibility for processing it in the RATS architecture.
Roles also have the ability to perform additional actions, such as caching or forwarding artifacts as opaque data.
As depicted in <a class="auto internal xref" href="#overview">Section 5</a>, these additional actions can be performed by several roles.<a class="pilcrow" href="#section-3.4-2">¶</a></p>
</section>
</div>
</section>
</div>
<div id="terminology">
<section id="section-4">
      <h2 id="name-terminology">
<a class="section-number selfRef" href="#section-4">4. </a><a class="section-name selfRef" href="#name-terminology">Terminology</a>
      </h2>
<p id="section-4-1"><span>[<a class="cite xref" href="#RFC4949">RFC4949</a>]</span> has defined a number of terms that are also used in this document.
Some of the terms are close to, but not exactly the same.
Where the terms are similar, they are noted below with references.



As explained in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc4949#section-2.6">Section 2.6</a> of [<a class="cite xref" href="#RFC4949">RFC4949</a>]</span>, when this document says "Compare:", the terminology used in this document differs significantly from the definition in the reference.<a class="pilcrow" href="#section-4-1">¶</a></p>
<p id="section-4-2">This document uses the terms in the subsections that follow.<a class="pilcrow" href="#section-4-2">¶</a></p>
<div id="roles">
<section id="section-4.1">
        <h3 id="name-roles">
<a class="section-number selfRef" href="#section-4.1">4.1. </a><a class="section-name selfRef" href="#name-roles">Roles</a>
        </h3>
<span class="break"></span><dl class="dlParallel" id="section-4.1-1">
          <dt id="section-4.1-1.1">Attester:</dt>
          <dd id="section-4.1-1.2" style="margin-left: 1.5em">
            <p id="section-4.1-1.2.1">A role performed by an entity (typically a device) whose Evidence must be appraised in order to infer the extent to which the Attester is considered trustworthy, such as when deciding whether it is authorized to perform some operation.<a class="pilcrow" href="#section-4.1-1.2.1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.1-1.2.2">
              <dt id="section-4.1-1.2.2.1">Produces:</dt>
              <dd id="section-4.1-1.2.2.2" style="margin-left: 1.5em">Evidence<a class="pilcrow" href="#section-4.1-1.2.2.2">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-1.3">Relying Party:</dt>
          <dd id="section-4.1-1.4" style="margin-left: 1.5em">
            <p id="section-4.1-1.4.1">A role performed by an entity that depends on the validity of information about an Attester for purposes of reliably applying application-specific actions.  Compare: relying party <span>[<a class="cite xref" href="#RFC4949">RFC4949</a>]</span>.<a class="pilcrow" href="#section-4.1-1.4.1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.1-1.4.2">
              <dt id="section-4.1-1.4.2.1">Consumes:</dt>
              <dd id="section-4.1-1.4.2.2" style="margin-left: 1.5em">Attestation Results, Appraisal Policy for Attestation Results<a class="pilcrow" href="#section-4.1-1.4.2.2">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-1.5">Verifier:</dt>
          <dd id="section-4.1-1.6" style="margin-left: 1.5em">
            <p id="section-4.1-1.6.1">A role performed by an entity that appraises the validity of Evidence about an Attester
 and produces Attestation Results to be used by a Relying Party.<a class="pilcrow" href="#section-4.1-1.6.1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.1-1.6.2">
              <dt id="section-4.1-1.6.2.1">Consumes:</dt>
              <dd id="section-4.1-1.6.2.2" style="margin-left: 1.5em">Evidence, Reference Values, Endorsements, Appraisal Policy for Evidence<a class="pilcrow" href="#section-4.1-1.6.2.2">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-4.1-1.6.2.3">Produces:</dt>
              <dd id="section-4.1-1.6.2.4" style="margin-left: 1.5em">Attestation Results<a class="pilcrow" href="#section-4.1-1.6.2.4">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-1.7">Relying Party Owner:</dt>
          <dd id="section-4.1-1.8" style="margin-left: 1.5em">
            <p id="section-4.1-1.8.1">A role performed by an entity (typically an administrator) that is authorized to configure an Appraisal Policy for Attestation Results in a Relying Party.<a class="pilcrow" href="#section-4.1-1.8.1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.1-1.8.2">
              <dt id="section-4.1-1.8.2.1">Produces:</dt>
              <dd id="section-4.1-1.8.2.2" style="margin-left: 1.5em">Appraisal Policy for Attestation Results<a class="pilcrow" href="#section-4.1-1.8.2.2">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-1.9">Verifier Owner:</dt>
          <dd id="section-4.1-1.10" style="margin-left: 1.5em">
            <p id="section-4.1-1.10.1">A role performed by an entity (typically an administrator) that is authorized to configure an Appraisal Policy for Evidence in a Verifier.<a class="pilcrow" href="#section-4.1-1.10.1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.1-1.10.2">
              <dt id="section-4.1-1.10.2.1">Produces:</dt>
              <dd id="section-4.1-1.10.2.2" style="margin-left: 1.5em">Appraisal Policy for Evidence<a class="pilcrow" href="#section-4.1-1.10.2.2">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-1.11">Endorser:</dt>
          <dd id="section-4.1-1.12" style="margin-left: 1.5em">
            <p id="section-4.1-1.12.1">A role performed by an entity (typically a manufacturer) whose Endorsements may help Verifiers appraise the authenticity of Evidence and infer further capabilities of the Attester.<a class="pilcrow" href="#section-4.1-1.12.1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.1-1.12.2">
              <dt id="section-4.1-1.12.2.1">Produces:</dt>
              <dd id="section-4.1-1.12.2.2" style="margin-left: 1.5em">Endorsements<a class="pilcrow" href="#section-4.1-1.12.2.2">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-1.13">Reference Value Provider:</dt>
          <dd id="section-4.1-1.14" style="margin-left: 1.5em">
            <p id="section-4.1-1.14.1">A role performed by an entity (typically a manufacturer) whose Reference Values help Verifiers appraise Evidence to determine if acceptable known Claims have been recorded by the Attester.<a class="pilcrow" href="#section-4.1-1.14.1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.1-1.14.2">
              <dt id="section-4.1-1.14.2.1">Produces:</dt>
              <dd id="section-4.1-1.14.2.2" style="margin-left: 1.5em">Reference Values<a class="pilcrow" href="#section-4.1-1.14.2.2">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="artifacts">
<section id="section-4.2">
        <h3 id="name-artifacts">
<a class="section-number selfRef" href="#section-4.2">4.2. </a><a class="section-name selfRef" href="#name-artifacts">Artifacts</a>
        </h3>
<span class="break"></span><dl class="dlParallel" id="section-4.2-1">
          <dt id="section-4.2-1.1">Claim:</dt>
          <dd id="section-4.2-1.2" style="margin-left: 1.5em">
            <p id="section-4.2-1.2.1">A piece of asserted information, often in the form of a name/value pair. Claims make up the usual structure of Evidence and other RATS conceptual messages.
Compare: claim <span>[<a class="cite xref" href="#RFC7519">RFC7519</a>]</span>.<a class="pilcrow" href="#section-4.2-1.2.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-1.3">Endorsement:</dt>
          <dd id="section-4.2-1.4" style="margin-left: 1.5em">
            <p id="section-4.2-1.4.1">A secure statement that an Endorser vouches for the integrity of an Attester's various capabilities, such as Claims collection and Evidence signing.<a class="pilcrow" href="#section-4.2-1.4.1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.2-1.4.2">
              <dt id="section-4.2-1.4.2.1">Consumed By:</dt>
              <dd id="section-4.2-1.4.2.2" style="margin-left: 1.5em">Verifier<a class="pilcrow" href="#section-4.2-1.4.2.2">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-4.2-1.4.2.3">Produced By:</dt>
              <dd id="section-4.2-1.4.2.4" style="margin-left: 1.5em">Endorser<a class="pilcrow" href="#section-4.2-1.4.2.4">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-1.5">Evidence:</dt>
          <dd id="section-4.2-1.6" style="margin-left: 1.5em">
            <p id="section-4.2-1.6.1">A set of Claims generated by an Attester to be appraised by a Verifier.
Evidence may include configuration data, measurements, telemetry, or inferences.<a class="pilcrow" href="#section-4.2-1.6.1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.2-1.6.2">
              <dt id="section-4.2-1.6.2.1">Consumed By:</dt>
              <dd id="section-4.2-1.6.2.2" style="margin-left: 1.5em">Verifier<a class="pilcrow" href="#section-4.2-1.6.2.2">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-4.2-1.6.2.3">Produced By:</dt>
              <dd id="section-4.2-1.6.2.4" style="margin-left: 1.5em">Attester<a class="pilcrow" href="#section-4.2-1.6.2.4">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-1.7">Attestation Result:</dt>
          <dd id="section-4.2-1.8" style="margin-left: 1.5em">
            <p id="section-4.2-1.8.1">The output generated by a Verifier, typically including information about an Attester, where the Verifier vouches for the validity of the results.<a class="pilcrow" href="#section-4.2-1.8.1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.2-1.8.2">
              <dt id="section-4.2-1.8.2.1">Consumed By:</dt>
              <dd id="section-4.2-1.8.2.2" style="margin-left: 1.5em">Relying Party<a class="pilcrow" href="#section-4.2-1.8.2.2">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-4.2-1.8.2.3">Produced By:</dt>
              <dd id="section-4.2-1.8.2.4" style="margin-left: 1.5em">Verifier<a class="pilcrow" href="#section-4.2-1.8.2.4">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-1.9">Appraisal Policy for Evidence:</dt>
          <dd id="section-4.2-1.10" style="margin-left: 1.5em">
            <p id="section-4.2-1.10.1">A set of rules that
  a Verifier uses to evaluate the validity of information
  about an Attester. Compare: security policy <span>[<a class="cite xref" href="#RFC4949">RFC4949</a>]</span>.<a class="pilcrow" href="#section-4.2-1.10.1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.2-1.10.2">
              <dt id="section-4.2-1.10.2.1">Consumed By:</dt>
              <dd id="section-4.2-1.10.2.2" style="margin-left: 1.5em">Verifier<a class="pilcrow" href="#section-4.2-1.10.2.2">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-4.2-1.10.2.3">Produced By:</dt>
              <dd id="section-4.2-1.10.2.4" style="margin-left: 1.5em">Verifier Owner<a class="pilcrow" href="#section-4.2-1.10.2.4">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-1.11">Appraisal Policy for Attestation Results:</dt>
          <dd id="section-4.2-1.12" style="margin-left: 1.5em">
            <p id="section-4.2-1.12.1">A set of rules that direct how a Relying Party uses the Attestation Results regarding an Attester generated by the Verifiers. Compare: security policy <span>[<a class="cite xref" href="#RFC4949">RFC4949</a>]</span>.<a class="pilcrow" href="#section-4.2-1.12.1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.2-1.12.2">
              <dt id="section-4.2-1.12.2.1">Consumed by:</dt>
              <dd id="section-4.2-1.12.2.2" style="margin-left: 1.5em">Relying Party<a class="pilcrow" href="#section-4.2-1.12.2.2">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-4.2-1.12.2.3">Produced by:</dt>
              <dd id="section-4.2-1.12.2.4" style="margin-left: 1.5em">Relying Party Owner<a class="pilcrow" href="#section-4.2-1.12.2.4">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-1.13">Reference Values:</dt>
          <dd id="section-4.2-1.14" style="margin-left: 1.5em">
            <p id="section-4.2-1.14.1">A set of values against which values of Claims can be compared as part of
applying an Appraisal Policy for Evidence.  Reference Values are sometimes
referred to in other documents as "known-good values", "golden measurements",
or "nominal values". These terms typically assume comparison for
equality, whereas here, Reference Values might be more general and be used
in any sort of comparison.<a class="pilcrow" href="#section-4.2-1.14.1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.2-1.14.2">
              <dt id="section-4.2-1.14.2.1">Consumed By:</dt>
              <dd id="section-4.2-1.14.2.2" style="margin-left: 1.5em">Verifier<a class="pilcrow" href="#section-4.2-1.14.2.2">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-4.2-1.14.2.3">Produced By:</dt>
              <dd id="section-4.2-1.14.2.4" style="margin-left: 1.5em">Reference Value Provider<a class="pilcrow" href="#section-4.2-1.14.2.4">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="overview">
<section id="section-5">
      <h2 id="name-topological-patterns">
<a class="section-number selfRef" href="#section-5">5. </a><a class="section-name selfRef" href="#name-topological-patterns">Topological Patterns</a>
      </h2>
<p id="section-5-1"><a class="auto internal xref" href="#dataflow">Figure 1</a> shows a data flow diagram for communication between an Attester,
a Verifier, and a Relying Party. The Attester conveys its Evidence to the Verifier
for appraisal and the Relying Party receives the Attestation Result from the Verifier.
This section refines the data-flow diagram by describing two
reference models, as well as one example composition thereof. The
discussion that follows is for illustrative purposes only and does
not constrain the interactions between RATS roles to the presented models.<a class="pilcrow" href="#section-5-1">¶</a></p>
<div id="passport-model">
<section id="section-5.1">
        <h3 id="name-passport-model">
<a class="section-number selfRef" href="#section-5.1">5.1. </a><a class="section-name selfRef" href="#name-passport-model">Passport Model</a>
        </h3>
<p id="section-5.1-1">The Passport Model is so named because of its resemblance to how nations issue
passports to their citizens. The nature of the Evidence that an individual needs
to provide to its local authority is specific to the country involved. The citizen
retains control of the resulting passport document and presents it to other entities
when it needs to assert a citizenship or identity Claim, such as at an airport immigration
desk. The passport is considered sufficient because it vouches for the citizenship and
identity Claims and it is issued by a trusted authority.<a class="pilcrow" href="#section-5.1-1">¶</a></p>
<p id="section-5.1-2">Thus, in this immigration desk analogy,
the citizen is the Attester,
the passport-issuing agency is a Verifier,
and the passport application and identifying information (e.g., birth certificate) is the Evidence.
The passport is an Attestation Result and the immigration desk is a Relying Party.<a class="pilcrow" href="#section-5.1-2">¶</a></p>
<p id="section-5.1-3">In this model, an Attester conveys Evidence to a Verifier that compares
the Evidence against its appraisal policy.
The Verifier then gives back an Attestation Result that the Attester treats as opaque data.<a class="pilcrow" href="#section-5.1-3">¶</a></p>
<p id="section-5.1-4">The Attester does not consume the Attestation Result, but it might cache it.
The Attester can then present the Attestation Result (and possibly additional Claims)
to a Relying Party, which then compares this information against its own
appraisal policy.
The Attester may also present the same Attestation Result to other Relying Parties.<a class="pilcrow" href="#section-5.1-4">¶</a></p>
<p id="section-5.1-5">There are three ways in which the process may fail:<a class="pilcrow" href="#section-5.1-5">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1-6.1">First, the Verifier may not issue a positive Attestation Result due to the Evidence not passing the Appraisal Policy for Evidence.<a class="pilcrow" href="#section-5.1-6.1">¶</a>
</li>
          <li class="normal" id="section-5.1-6.2">The second way in which the process may fail is when the Attestation Result
is examined by the Relying Party, and based upon the Appraisal Policy for
Attestation Results, the result does not comply with the policy.<a class="pilcrow" href="#section-5.1-6.2">¶</a>
</li>
          <li class="normal" id="section-5.1-6.3">The third way is when the Verifier is unreachable or unavailable.<a class="pilcrow" href="#section-5.1-6.3">¶</a>
</li>
        </ul>
<p id="section-5.1-7">As with any other information needed by the Relying Party to make an authorization decision,
an Attestation Result can be carried in a resource access protocol between the Attester and Relying Party.
In this model, the details of the resource access protocol
constrain the serialization format of the Attestation Result. On the other hand, the
format of the Evidence is only constrained by the
Attester-Verifier remote attestation protocol.
This implies that interoperability and standardization is more relevant for Attestation Results than it is for Evidence.<a class="pilcrow" href="#section-5.1-7">¶</a></p>
<span id="name-passport-model-2"></span><div id="passport">
<figure id="figure-5">
          <div id="section-5.1-8.1">
            <div class="alignCenter art-svg artwork" id="section-5.1-8.1.1">
<svg class="diagram" font-family="monospace" font-size="13px" height="272" text-anchor="middle" version="1.1" viewBox="0 0 552 272" width="552" xmlns="http://www.w3.org/2000/svg">
                <path d="M 48,32 L 48,96" fill="none" stroke="black"></path>
                <path d="M 48,176 L 48,240" fill="none" stroke="black"></path>
                <path d="M 80,104 L 80,176" fill="none" stroke="black"></path>
                <path d="M 120,96 L 120,168" fill="none" stroke="black"></path>
                <path d="M 152,32 L 152,96" fill="none" stroke="black"></path>
                <path d="M 152,176 L 152,240" fill="none" stroke="black"></path>
                <path d="M 272,176 L 272,240" fill="none" stroke="black"></path>
                <path d="M 384,176 L 384,240" fill="none" stroke="black"></path>
                <path d="M 48,32 L 152,32" fill="none" stroke="black"></path>
                <path d="M 48,96 L 152,96" fill="none" stroke="black"></path>
                <path d="M 48,176 L 152,176" fill="none" stroke="black"></path>
                <path d="M 272,176 L 384,176" fill="none" stroke="black"></path>
                <path d="M 152,192 L 264,192" fill="none" stroke="black"></path>
                <path d="M 48,240 L 152,240" fill="none" stroke="black"></path>
                <path d="M 272,240 L 384,240" fill="none" stroke="black"></path>
                <polygon class="arrowhead" fill="black" points="272,192 260,186.4 260,197.6" transform="rotate(0,264,192)"></polygon>
                <polygon class="arrowhead" fill="black" points="128,168 116,162.4 116,173.6" transform="rotate(90,120,168)"></polygon>
                <polygon class="arrowhead" fill="black" points="88,104 76,98.4 76,109.6" transform="rotate(270,80,104)"></polygon>
                <g class="text">
                  <text x="192" y="52">Compare</text>
                  <text x="260" y="52">Evidence</text>
                  <text x="100" y="68">Verifier</text>
                  <text x="192" y="68">against</text>
                  <text x="264" y="68">appraisal</text>
                  <text x="332" y="68">policy</text>
                  <text x="36" y="132">Evidence</text>
                  <text x="176" y="132">Attestation</text>
                  <text x="156" y="148">Result</text>
                  <text x="424" y="196">Compare</text>
                  <text x="504" y="196">Attestation</text>
                  <text x="100" y="212">Attester</text>
                  <text x="208" y="212">Attestation</text>
                  <text x="328" y="212">Relying</text>
                  <text x="420" y="212">Result</text>
                  <text x="480" y="212">against</text>
                  <text x="188" y="228">Result</text>
                  <text x="328" y="228">Party</text>
                  <text x="432" y="228">appraisal</text>
                  <text x="500" y="228">policy</text>
                </g>
              </svg><a class="pilcrow" href="#section-5.1-8.1.1">¶</a>
</div>
</div>
<figcaption><a class="selfRef" href="#figure-5">Figure 5</a>:
<a class="selfRef" href="#name-passport-model-2">Passport Model</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="background-check-model">
<section id="section-5.2">
        <h3 id="name-background-check-model">
<a class="section-number selfRef" href="#section-5.2">5.2. </a><a class="section-name selfRef" href="#name-background-check-model">Background-Check Model</a>
        </h3>
<p id="section-5.2-1">The Background-Check Model is so named because of the resemblance
        of how employers and volunteer organizations perform background
        checks. When a prospective employee provides Claims about education or
        previous experience, the employer will contact the respective
        institutions or former employers to validate the Claim. Volunteer
        organizations often perform police background checks on volunteers in
        order to determine the volunteer's trustworthiness.  Thus, in this
        analogy, a prospective volunteer is an Attester, the organization is
        the Relying Party, and the organization that issues a report is a
        Verifier.<a class="pilcrow" href="#section-5.2-1">¶</a></p>
<p id="section-5.2-2">In this model, an Attester conveys Evidence to a Relying Party,
        which treats it as opaque and simply forwards it on to a Verifier.
        The Verifier compares the Evidence against its appraisal policy and
        returns an Attestation Result to the Relying Party.  The Relying Party
        then compares the Attestation Result against its own appraisal
        policy.<a class="pilcrow" href="#section-5.2-2">¶</a></p>
<p id="section-5.2-3">The resource access protocol between the Attester and Relying Party
        includes Evidence rather than an Attestation Result, but that Evidence
        is not processed by the Relying Party.<a class="pilcrow" href="#section-5.2-3">¶</a></p>
<p id="section-5.2-4">Since the Evidence is merely forwarded on to a trusted Verifier, any serialization format can be used for Evidence because the Relying Party does not need a parser for it.  The only requirement is that the Evidence can be <em>encapsulated</em> in the format
required by the resource access protocol between the Attester and Relying Party.<a class="pilcrow" href="#section-5.2-4">¶</a></p>
<p id="section-5.2-5">However, as seen in the Passport Model, an Attestation Result is still consumed by the
Relying Party.  Code footprint and attack surface area can be minimized by
using a serialization format for which the Relying Party already needs a
parser to support the protocol between the Attester and Relying Party,
which may be an existing standard or widely deployed resource access protocol.
Such minimization is especially important if the Relying Party is a
constrained node.<a class="pilcrow" href="#section-5.2-5">¶</a></p>
<span id="name-background-check-model-2"></span><div id="backgroundcheck">
<figure id="figure-6">
          <div id="section-5.2-6.1">
            <div class="alignCenter art-svg artwork" id="section-5.2-6.1.1">
<svg class="diagram" font-family="monospace" font-size="13px" height="272" text-anchor="middle" version="1.1" viewBox="0 0 520 272" width="520" xmlns="http://www.w3.org/2000/svg">
                <path d="M 8,176 L 8,240" fill="none" stroke="black"></path>
                <path d="M 112,176 L 112,240" fill="none" stroke="black"></path>
                <path d="M 240,32 L 240,96" fill="none" stroke="black"></path>
                <path d="M 240,176 L 240,240" fill="none" stroke="black"></path>
                <path d="M 280,104 L 280,176" fill="none" stroke="black"></path>
                <path d="M 312,96 L 312,168" fill="none" stroke="black"></path>
                <path d="M 352,32 L 352,96" fill="none" stroke="black"></path>
                <path d="M 352,176 L 352,240" fill="none" stroke="black"></path>
                <path d="M 240,32 L 352,32" fill="none" stroke="black"></path>
                <path d="M 240,96 L 352,96" fill="none" stroke="black"></path>
                <path d="M 8,176 L 112,176" fill="none" stroke="black"></path>
                <path d="M 240,176 L 272,176" fill="none" stroke="black"></path>
                <path d="M 288,176 L 352,176" fill="none" stroke="black"></path>
                <path d="M 112,192 L 232,192" fill="none" stroke="black"></path>
                <path d="M 248,192 L 264,192" fill="none" stroke="black"></path>
                <path d="M 8,240 L 112,240" fill="none" stroke="black"></path>
                <path d="M 240,240 L 352,240" fill="none" stroke="black"></path>
                <path d="M 264,192 C 272.83064,192 280,184.83064 280,176" fill="none" stroke="black"></path>
                <polygon class="arrowhead" fill="black" points="320,168 308,162.4 308,173.6" transform="rotate(90,312,168)"></polygon>
                <polygon class="arrowhead" fill="black" points="288,104 276,98.4 276,109.6" transform="rotate(270,280,104)"></polygon>
                <polygon class="arrowhead" fill="black" points="240,192 228,186.4 228,197.6" transform="rotate(0,232,192)"></polygon>
                <g class="text">
                  <text x="392" y="52">Compare</text>
                  <text x="460" y="52">Evidence</text>
                  <text x="300" y="68">Verifier</text>
                  <text x="392" y="68">against</text>
                  <text x="464" y="68">appraisal</text>
                  <text x="388" y="84">policy</text>
                  <text x="236" y="132">Evidence</text>
                  <text x="368" y="132">Attestation</text>
                  <text x="348" y="148">Result</text>
                  <text x="392" y="196">Compare</text>
                  <text x="472" y="196">Attestation</text>
                  <text x="60" y="212">Attester</text>
                  <text x="172" y="212">Evidence</text>
                  <text x="312" y="212">Relying</text>
                  <text x="388" y="212">Result</text>
                  <text x="448" y="212">against</text>
                  <text x="312" y="228">Party</text>
                  <text x="400" y="228">appraisal</text>
                  <text x="468" y="228">policy</text>
                </g>
              </svg><a class="pilcrow" href="#section-5.2-6.1.1">¶</a>
</div>
</div>
<figcaption><a class="selfRef" href="#figure-6">Figure 6</a>:
<a class="selfRef" href="#name-background-check-model-2">Background-Check Model</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="combinations">
<section id="section-5.3">
        <h3 id="name-combinations">
<a class="section-number selfRef" href="#section-5.3">5.3. </a><a class="section-name selfRef" href="#name-combinations">Combinations</a>
        </h3>
<p id="section-5.3-1">One variation of the Background-Check Model is where the Relying Party
and the Verifier are on the same machine, performing both functions together.
In this case, there is no need for a protocol between the two.<a class="pilcrow" href="#section-5.3-1">¶</a></p>
<p id="section-5.3-2">It is also worth pointing out that the choice of model depends on the use case and that different Relying Parties may use different topological patterns.<a class="pilcrow" href="#section-5.3-2">¶</a></p>
<p id="section-5.3-3">The same device may need to create Evidence for different Relying Parties and/or different use cases.
For instance, it would use one model to provide Evidence to a network infrastructure device to gain access to the network and
the other model to provide Evidence to a server holding confidential data to gain access to that data.
As such, both models may simultaneously be in use by the same device.<a class="pilcrow" href="#section-5.3-3">¶</a></p>
<p id="section-5.3-4"><a class="auto internal xref" href="#combination">Figure 7</a> shows another example of a combination where Relying Party 1 uses the
Passport Model, whereas Relying Party 2 uses an extension of the Background-Check Model.
Specifically, in addition to the basic functionality shown in <a class="auto internal xref" href="#backgroundcheck">Figure 6</a>, Relying Party 2
actually provides the Attestation Result back to the Attester, allowing the Attester to
use it with other Relying Parties.  This is the model that the TAM
plans to support in the TEEP architecture <span>[<a class="cite xref" href="#I-D.ietf-teep-architecture">TEEP-ARCH</a>]</span>.<a class="pilcrow" href="#section-5.3-4">¶</a></p>
<span id="name-example-combination"></span><div id="combination">
<figure id="figure-7">
          <div id="section-5.3-5.1">
            <div class="alignLeft art-svg artwork" id="section-5.3-5.1.1">
<svg class="diagram" font-family="monospace" font-size="13px" height="416" text-anchor="middle" version="1.1" viewBox="0 0 560 416" width="560" xmlns="http://www.w3.org/2000/svg">
                <path d="M 40,32 L 40,96" fill="none" stroke="black"></path>
                <path d="M 40,176 L 40,240" fill="none" stroke="black"></path>
                <path d="M 40,320 L 40,384" fill="none" stroke="black"></path>
                <path d="M 80,104 L 80,176" fill="none" stroke="black"></path>
                <path d="M 80,248 L 80,320" fill="none" stroke="black"></path>
                <path d="M 112,96 L 112,168" fill="none" stroke="black"></path>
                <path d="M 112,240 L 112,312" fill="none" stroke="black"></path>
                <path d="M 152,32 L 152,96" fill="none" stroke="black"></path>
                <path d="M 152,176 L 152,240" fill="none" stroke="black"></path>
                <path d="M 152,320 L 152,384" fill="none" stroke="black"></path>
                <path d="M 280,320 L 280,384" fill="none" stroke="black"></path>
                <path d="M 392,320 L 392,384" fill="none" stroke="black"></path>
                <path d="M 40,32 L 152,32" fill="none" stroke="black"></path>
                <path d="M 40,96 L 152,96" fill="none" stroke="black"></path>
                <path d="M 40,176 L 152,176" fill="none" stroke="black"></path>
                <path d="M 40,240 L 152,240" fill="none" stroke="black"></path>
                <path d="M 40,320 L 152,320" fill="none" stroke="black"></path>
                <path d="M 280,320 L 392,320" fill="none" stroke="black"></path>
                <path d="M 152,336 L 272,336" fill="none" stroke="black"></path>
                <path d="M 40,384 L 152,384" fill="none" stroke="black"></path>
                <path d="M 280,384 L 392,384" fill="none" stroke="black"></path>
                <polygon class="arrowhead" fill="black" points="280,336 268,330.4 268,341.6" transform="rotate(0,272,336)"></polygon>
                <polygon class="arrowhead" fill="black" points="120,312 108,306.4 108,317.6" transform="rotate(90,112,312)"></polygon>
                <polygon class="arrowhead" fill="black" points="120,168 108,162.4 108,173.6" transform="rotate(90,112,168)"></polygon>
                <polygon class="arrowhead" fill="black" points="88,248 76,242.4 76,253.6" transform="rotate(270,80,248)"></polygon>
                <polygon class="arrowhead" fill="black" points="88,104 76,98.4 76,109.6" transform="rotate(270,80,104)"></polygon>
                <g class="text">
                  <text x="192" y="52">Compare</text>
                  <text x="260" y="52">Evidence</text>
                  <text x="100" y="68">Verifier</text>
                  <text x="192" y="68">against</text>
                  <text x="264" y="68">appraisal</text>
                  <text x="332" y="68">policy</text>
                  <text x="36" y="132">Evidence</text>
                  <text x="168" y="132">Attestation</text>
                  <text x="148" y="148">Result</text>
                  <text x="192" y="196">Compare</text>
                  <text x="96" y="212">Relying</text>
                  <text x="208" y="212">Attestation</text>
                  <text x="284" y="212">Result</text>
                  <text x="88" y="228">Party</text>
                  <text x="120" y="228">2</text>
                  <text x="192" y="228">against</text>
                  <text x="264" y="228">appraisal</text>
                  <text x="332" y="228">policy</text>
                  <text x="36" y="276">Evidence</text>
                  <text x="168" y="276">Attestation</text>
                  <text x="148" y="292">Result</text>
                  <text x="432" y="340">Compare</text>
                  <text x="512" y="340">Attestation</text>
                  <text x="100" y="356">Attester</text>
                  <text x="216" y="356">Attestation</text>
                  <text x="336" y="356">Relying</text>
                  <text x="428" y="356">Result</text>
                  <text x="488" y="356">against</text>
                  <text x="220" y="372">Result</text>
                  <text x="328" y="372">Party</text>
                  <text x="360" y="372">1</text>
                  <text x="440" y="372">appraisal</text>
                  <text x="508" y="372">policy</text>
                </g>
              </svg><a class="pilcrow" href="#section-5.3-5.1.1">¶</a>
</div>
</div>
<figcaption><a class="selfRef" href="#figure-7">Figure 7</a>:
<a class="selfRef" href="#name-example-combination">Example Combination</a>
          </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="rolesentities">
<section id="section-6">
      <h2 id="name-roles-and-entities">
<a class="section-number selfRef" href="#section-6">6. </a><a class="section-name selfRef" href="#name-roles-and-entities">Roles and Entities</a>
      </h2>
<p id="section-6-1">An entity in the RATS architecture includes at least one of the roles defined
in this document.<a class="pilcrow" href="#section-6-1">¶</a></p>
<p id="section-6-2">An entity can aggregate more than one role into itself, such as being both
a Verifier and a Relying Party or being both a Reference Value Provider and
an Endorser.
As such, any conceptual messages (see <a class="auto internal xref" href="#messages">Section 8</a> for more
discussion) originating from such roles might also be combined. For example,
Reference Values might be conveyed as part of an appraisal policy if the
Verifier Owner and Reference Value Provider roles are combined. Similarly,
Reference Values might be conveyed as part of an Endorsement if the Endorser
and Reference Value Provider roles are combined.<a class="pilcrow" href="#section-6-2">¶</a></p>
<p id="section-6-3">Interactions between roles aggregated into the same entity do not necessarily use the
Internet Protocol.
Such interactions might use a loopback device or other IP-based
communication between separate environments, but they do not have to.



Alternative channels to convey conceptual messages include function calls, sockets, General-Purpose Input/Output (GPIO)
interfaces, local buses, or hypervisor calls. This type of conveyance is typically found
in composite devices. Most importantly, these conveyance methods are
out of scope of the  RATS architecture, but they are presumed to exist in order to convey
conceptual messages appropriately between roles.<a class="pilcrow" href="#section-6-3">¶</a></p>
<p id="section-6-4">In essence, an entity that combines more than one role creates and consumes
the corresponding conceptual messages as defined in this document.<a class="pilcrow" href="#section-6-4">¶</a></p>
</section>
</div>
<div id="trustmodel">
<section id="section-7">
      <h2 id="name-trust-model">
<a class="section-number selfRef" href="#section-7">7. </a><a class="section-name selfRef" href="#name-trust-model">Trust Model</a>
      </h2>
<div id="relying-party">
<section id="section-7.1">
        <h3 id="name-relying-party">
<a class="section-number selfRef" href="#section-7.1">7.1. </a><a class="section-name selfRef" href="#name-relying-party">Relying Party</a>
        </h3>
<p id="section-7.1-1">This document covers scenarios for which a Relying Party
trusts a Verifier that can appraise the trustworthiness of
information about an Attester.  Such trust
is expressed by storing one or more "trust anchors" in a secure location
known as a "trust anchor store".<a class="pilcrow" href="#section-7.1-1">¶</a></p>
<p id="section-7.1-2">As defined in <span>[<a class="cite xref" href="#RFC6024">RFC6024</a>]</span>:<a class="pilcrow" href="#section-7.1-2">¶</a></p>
<blockquote id="section-7.1-3">A trust anchor represents an authoritative entity via a public
key and associated data.  The public key is used to verify digital
signatures, and the associated data is used to constrain the types
of information for which the trust anchor is authoritative.<a class="pilcrow" href="#section-7.1-3">¶</a>
</blockquote>
<p id="section-7.1-4">
The trust anchor may be a certificate or it may be a raw public key
along with additional data if necessary, such as its public key
algorithm and parameters.
In the context of this document, a trust anchor may also be a symmetric key, as
in <span>[<a class="cite xref" href="#TCG-DICE-SIBDA">TCG-DICE-SIBDA</a>]</span>, or the symmetric mode described in
<span>[<a class="cite xref" href="#I-D.tschofenig-rats-psa-token">RATS-PSA-TOKEN</a>]</span>.<a class="pilcrow" href="#section-7.1-4">¶</a></p>
<p id="section-7.1-5">Thus, trusting a Verifier might be expressed by having the Relying
Party store the Verifier's key or certificate in its trust anchor store.  It might also
be expressed by storing the public key or certificate of an entity (e.g., a Certificate Authority) that is
in the Verifier's certificate path.
For example, the Relying Party can verify that the Verifier is an expected one by out-of-band establishment of key material combined with a protocol like TLS to communicate.
There is an assumption that the Verifier has not been compromised between the establishment of the trusted key material and the creation of the Evidence.<a class="pilcrow" href="#section-7.1-5">¶</a></p>
<p id="section-7.1-6">For a stronger level of security, the
Relying Party might require that the Verifier first provide
information about itself that the Relying Party can use to assess
the trustworthiness of the Verifier before accepting its Attestation Results.
Such a process would provide a stronger level of confidence in the correctness of
the information provided, such as a belief that the authentic Verifier has
not been compromised by malware.<a class="pilcrow" href="#section-7.1-6">¶</a></p>
<p id="section-7.1-7">For example, one explicit way for a Relying Party "A" to establish
such confidence in the correctness of a Verifier "B" would be for B to first act as an Attester
where A acts as a combined Verifier/Relying Party.  If A then accepts B as
trustworthy, it can choose to accept B as a Verifier for other Attesters.<a class="pilcrow" href="#section-7.1-7">¶</a></p>
<p id="section-7.1-8">Similarly, the Relying Party also needs to trust the Relying Party Owner
for providing its Appraisal Policy for Attestation Results, and,
in some scenarios, the Relying Party might even require that the
Relying Party Owner go through a remote attestation procedure with it before the Relying Party will accept
an updated policy. This can be done in a manner similar to how a Relying Party
could establish trust in a Verifier as discussed above, i.e., verifying credentials against a trust anchor store
and optionally requiring Attestation Results from the Relying Party Owner.<a class="pilcrow" href="#section-7.1-8">¶</a></p>
</section>
</div>
<div id="attester">
<section id="section-7.2">
        <h3 id="name-attester">
<a class="section-number selfRef" href="#section-7.2">7.2. </a><a class="section-name selfRef" href="#name-attester">Attester</a>
        </h3>
<p id="section-7.2-1">In some scenarios, Evidence might contain sensitive information, such as
Personally Identifiable Information (PII) or system identifiable information.
Thus, an Attester must trust the entities to which it conveys Evidence to not
reveal sensitive data to unauthorized parties.



The Verifier might share this information with other
authorized parties according to a governing policy that addresses the
handling of sensitive information (potentially included in Appraisal
Policies for Evidence).
In the Background-Check Model, this Evidence may also be revealed to Relying Parties.<a class="pilcrow" href="#section-7.2-1">¶</a></p>
<p id="section-7.2-2">When Evidence contains sensitive information, an Attester
typically requires that a Verifier authenticates itself (e.g., at TLS session establishment) and might even request a remote attestation before the Attester
sends the sensitive Evidence.  This can be done by having the
Attester first act as a Verifier/Relying Party and the Verifier act as its
own Attester, as discussed above.<a class="pilcrow" href="#section-7.2-2">¶</a></p>
</section>
</div>
<div id="rpowner-trust">
<section id="section-7.3">
        <h3 id="name-relying-party-owner">
<a class="section-number selfRef" href="#section-7.3">7.3. </a><a class="section-name selfRef" href="#name-relying-party-owner">Relying Party Owner</a>
        </h3>
<p id="section-7.3-1">The Relying Party Owner might also require that the
Relying Party first act as an Attester by providing Evidence that the Owner
can appraise before the Owner would give the Relying Party an updated
policy that might contain sensitive information.  
In such a case, authentication or attestation in both directions might
be needed. Typically, one side's Evidence must be considered safe to
share with an untrusted entity in order to bootstrap the sequence.
See <a class="auto internal xref" href="#privacy-considerations">Section 11</a> for more discussion.<a class="pilcrow" href="#section-7.3-1">¶</a></p>
</section>
</div>
<div id="verifier">
<section id="section-7.4">
        <h3 id="name-verifier">
<a class="section-number selfRef" href="#section-7.4">7.4. </a><a class="section-name selfRef" href="#name-verifier">Verifier</a>
        </h3>
<p id="section-7.4-1">The Verifier trusts (or more specifically, the Verifier's security
policy is written in a way that configures the Verifier to trust) a
manufacturer or the manufacturer's hardware so as to be able to
appraise the trustworthiness of that manufacturer's devices.  Such trust
is expressed by storing one or more trust anchors in the Verifier's
trust anchor store.<a class="pilcrow" href="#section-7.4-1">¶</a></p>
<p id="section-7.4-2">In a typical solution, a Verifier comes to trust an Attester
        indirectly by having an Endorser (such as a manufacturer) vouch for
        the Attester's ability to securely generate Evidence through
        Endorsements (see <a class="auto internal xref" href="#endorsements">Section 8.2</a>). Endorsements might
        describe the ways in which the Attester resists attacks, protects
        secrets, and measures Target Environments. Consequently, the
        Endorser's key material is stored in the Verifier's trust anchor store
        so that Endorsements can be authenticated and used in the Verifier's
        appraisal process.<a class="pilcrow" href="#section-7.4-2">¶</a></p>
<p id="section-7.4-3">In some solutions, a Verifier might be
        configured to directly trust an Attester by having the Verifier
        possess the Attester's key material (rather than the Endorser's) in
        its trust anchor store.<a class="pilcrow" href="#section-7.4-3">¶</a></p>
<p id="section-7.4-4">Such direct trust must first be established at the time of trust anchor
store configuration either by checking with an Endorser at that
time or by conducting a security analysis of the specific device.
Having the Attester directly in the trust anchor store narrows
the Verifier's trust to only specific devices rather than all devices
the Endorser might vouch for, such as all devices manufactured by the
same manufacturer in the case that the Endorser is a manufacturer.<a class="pilcrow" href="#section-7.4-4">¶</a></p>
<p id="section-7.4-5">Such narrowing is often important since physical possession of a device
can also be used to conduct a number of attacks, and so a device in
a physically secure environment (such as one's own premises) may be
considered trusted, whereas devices owned by others would not be.
This often results in a desire either to have the owner run their
own Endorser that would only endorse devices one owns or to use
Attesters directly in the trust anchor store.   When there are many
Attesters owned, the use of an Endorser enables better scalability.<a class="pilcrow" href="#section-7.4-5">¶</a></p>
<p id="section-7.4-6">That is, a Verifier might appraise the trustworthiness of an application component, operating
system component, or service under the assumption that information
provided about it by the lower-layer firmware or software is true.
A stronger level of assurance of security comes when information can be vouched
for by hardware or by ROM code, especially if such hardware is
physically resistant to hardware tampering.
In most cases, components that have to be vouched for via Endorsements (because no Evidence is generated about them) are referred to as "roots of trust".<a class="pilcrow" href="#section-7.4-6">¶</a></p>
<p id="section-7.4-7">The manufacturer having arranged for an Attesting Environment to be provisioned with key material with which to sign Evidence, the Verifier is then provided with
some way of verifying the signature on the Evidence.  This may be in the form of an appropriate trust anchor or the Verifier may be provided with a database of public keys (rather than certificates) or even carefully curated and secured lists of symmetric keys.<a class="pilcrow" href="#section-7.4-7">¶</a></p>
<p id="section-7.4-8">The nature of how the Verifier manages to validate the signatures produced by the Attester is critical to the secure operation of a remote attestation system but is not the subject of standardization within this architecture.<a class="pilcrow" href="#section-7.4-8">¶</a></p>
<p id="section-7.4-9">A conveyance protocol that provides authentication and integrity protection can be used
to convey Evidence that is otherwise unprotected (e.g., not signed). Appropriate conveyance of unprotected Evidence (e.g., <span>[<a class="cite xref" href="#I-D.ietf-rats-uccs">RATS-UCCS</a>]</span>) relies on the following conveyance protocol's protection capabilities:<a class="pilcrow" href="#section-7.4-9">¶</a></p>
<ol class="normal type-1" id="section-7.4-10" start="1" type="1">

<li id="section-7.4-10.1">The key material used to authenticate and integrity protect the conveyance channel is trusted by the Verifier to speak for the Attesting Environment(s) that collected Claims about the Target Environment(s).<a class="pilcrow" href="#section-7.4-10.1">¶</a>
</li>
          <li id="section-7.4-10.2">All unprotected Evidence that is conveyed is supplied exclusively by the Attesting Environment that has the key material that protects the conveyance channel.<a class="pilcrow" href="#section-7.4-10.2">¶</a>
</li>
          <li id="section-7.4-10.3">A trusted environment protects the conveyance channel's key material, which may depend on other Attesting Environments with equivalent strength protections.<a class="pilcrow" href="#section-7.4-10.3">¶</a>
</li>
        </ol>
<p id="section-7.4-11">As illustrated in <span>[<a class="cite xref" href="#I-D.ietf-rats-uccs">RATS-UCCS</a>]</span>, an entity that receives unprotected Evidence via a trusted conveyance channel always takes on the responsibility of vouching for the Evidence's authenticity and freshness.
If protected Evidence is generated, the Attester's Attesting Environments take on that responsibility.
In cases where unprotected Evidence is processed by a Verifier, Relying Parties have to trust that the Verifier is capable of handling Evidence in a manner that preserves the Evidence's authenticity and freshness.
Generating and conveying unprotected Evidence always creates significant risk and the benefits of that approach have to be carefully weighed against potential drawbacks.<a class="pilcrow" href="#section-7.4-11">¶</a></p>
<p id="section-7.4-12">See <a class="auto internal xref" href="#security-considerations">Section 12</a> for discussion on security strength.<a class="pilcrow" href="#section-7.4-12">¶</a></p>
</section>
</div>
<div id="endorser-reference-value-provider-and-verifier-owner">
<section id="section-7.5">
        <h3 id="name-endorser-reference-value-pr">
<a class="section-number selfRef" href="#section-7.5">7.5. </a><a class="section-name selfRef" href="#name-endorser-reference-value-pr">Endorser, Reference Value Provider, and Verifier Owner</a>
        </h3>
<p id="section-7.5-1">In some scenarios, the Endorser, Reference Value Provider, and Verifier Owner may need to trust the Verifier
before giving the Endorsement, Reference Values, or appraisal policy to it.  This can be done in a 
similar manner to how a Relying Party might establish trust in a Verifier.<a class="pilcrow" href="#section-7.5-1">¶</a></p>
<p id="section-7.5-2">As discussed in <a class="auto internal xref" href="#rpowner-trust">Section 7.3</a>, authentication or attestation in both directions might be
needed. Typically, one side's identity or
Evidence in this case must be considered safe to share with an untrusted entity
in order to bootstrap the sequence.
See <a class="auto internal xref" href="#privacy-considerations">Section 11</a> for more discussion.<a class="pilcrow" href="#section-7.5-2">¶</a></p>
</section>
</div>
</section>
</div>
<div id="messages">
<section id="section-8">
      <h2 id="name-conceptual-messages">
<a class="section-number selfRef" href="#section-8">8. </a><a class="section-name selfRef" href="#name-conceptual-messages">Conceptual Messages</a>
      </h2>
<p id="section-8-1"><a class="auto internal xref" href="#dataflow">Figure 1</a> illustrates the flow of conceptual messages between various roles.
This section provides additional elaboration and implementation considerations.
It is the responsibility of protocol specifications to define the actual data format
and semantics of any relevant conceptual messages.<a class="pilcrow" href="#section-8-1">¶</a></p>
<div id="evidence">
<section id="section-8.1">
        <h3 id="name-evidence">
<a class="section-number selfRef" href="#section-8.1">8.1. </a><a class="section-name selfRef" href="#name-evidence">Evidence</a>
        </h3>
<p id="section-8.1-1">Evidence is a set of Claims about the Target Environment that reveal operational
status, health, configuration, or construction that have security relevance.
Evidence is appraised by a Verifier to establish its relevance, compliance, and timeliness.
Claims need to be collected in a manner that is reliable such that a Target Environment cannot lie to the Attesting Environment about its trustworthiness properties.
Evidence needs to be securely associated with the Target Environment
so that the Verifier cannot be tricked into accepting Claims originating
from a different environment (that may be more trustworthy).
Evidence also must be protected from an active on-path attacker who may observe,
change, or misdirect Evidence as it travels from the Attester to the Verifier.
The timeliness of Evidence can be captured using Claims that pinpoint the time
or interval when changes in operational status, health, and so forth occur.<a class="pilcrow" href="#section-8.1-1">¶</a></p>
</section>
</div>
<div id="endorsements">
<section id="section-8.2">
        <h3 id="name-endorsements">
<a class="section-number selfRef" href="#section-8.2">8.2. </a><a class="section-name selfRef" href="#name-endorsements">Endorsements</a>
        </h3>
<p id="section-8.2-1">An Endorsement is a secure statement that some entity (e.g., a
        manufacturer) vouches for the integrity of the device's various
        capabilities, such as Claims collection, signing, launching code,
        transitioning to other environments, storing secrets, and more.  For
        example, if the device's signing capability is in hardware, then an
        Endorsement might be a manufacturer certificate that signs a public
        key whose corresponding private key is only known inside the device's
        hardware.  Thus, when Evidence and such an Endorsement are used
        together, an appraisal procedure can be conducted based on appraisal
        policies that may not be specific to the device instance but are merely
        specific to the manufacturer providing the Endorsement. For example,
        an appraisal policy might simply check that devices from a given
        manufacturer have information matching a set of Reference Values. An appraisal policy might also have a set of more complex logic on how to
        appraise the validity of information.<a class="pilcrow" href="#section-8.2-1">¶</a></p>
<p id="section-8.2-2">However, while an appraisal policy that treats all devices from a
        given manufacturer the same may be appropriate for some use cases, it
        would be inappropriate to use such an appraisal policy as the sole
        means of authorization for use cases that wish to constrain
        <em>which</em> compliant devices are considered authorized for some
        purpose.  For example, an enterprise using remote attestation for
        Network Endpoint Assessment (NEA) <span>[<a class="cite xref" href="#RFC5209">RFC5209</a>]</span> may not wish to
        let every healthy laptop from the same manufacturer onto the network.
        Instead, it may only want to let devices that it legally owns onto the
        network.  Thus, an Endorsement may be helpful information in
        authenticating information about a device, but is not necessarily
        sufficient to authorize access to resources that may need
        device-specific information, such as a public key for the device or
        component or user on the device.<a class="pilcrow" href="#section-8.2-2">¶</a></p>
</section>
</div>
<div id="reference-values">
<section id="section-8.3">
        <h3 id="name-reference-values">
<a class="section-number selfRef" href="#section-8.3">8.3. </a><a class="section-name selfRef" href="#name-reference-values">Reference Values</a>
        </h3>
<p id="section-8.3-1">Reference Values used in appraisal procedures come from a Reference
        Value Provider and are then used by the Verifier to compare to
        Evidence.  Reference Values with matching Evidence produce acceptable
        Claims.  Additionally, an appraisal policy may play a role in determining
        the acceptance of Claims.<a class="pilcrow" href="#section-8.3-1">¶</a></p>
</section>
</div>
<div id="attestation-results">
<section id="section-8.4">
        <h3 id="name-attestation-results">
<a class="section-number selfRef" href="#section-8.4">8.4. </a><a class="section-name selfRef" href="#name-attestation-results">Attestation Results</a>
        </h3>
<p id="section-8.4-1">Attestation Results are the input used by the Relying Party to
        decide the extent to which it will trust a particular Attester and
        allow it to access some data or perform some operation.<a class="pilcrow" href="#section-8.4-1">¶</a></p>
<p id="section-8.4-2">Attestation Results may carry a boolean value indicating compliance
        or non-compliance with a Verifier's appraisal policy or may carry a
        richer set of Claims about the Attester, against which the Relying
        Party applies its Appraisal Policy for Attestation Results.<a class="pilcrow" href="#section-8.4-2">¶</a></p>
<p id="section-8.4-3">The quality of the Attestation Results depends upon the ability of the Verifier to evaluate the Attester.
Different Attesters have a different <em>Strength of Function</em> <span>[<a class="cite xref" href="#strengthoffunction">strengthoffunction</a>]</span>, which results in the Attestation Results being qualitatively different in strength.<a class="pilcrow" href="#section-8.4-3">¶</a></p>
<p id="section-8.4-4">An Attestation Result that indicates non-compliance can be used by an Attester (in the Passport Model) or
a Relying Party (in the Background-Check Model) to indicate that the Attester
should not be treated as authorized and may be in need of remediation.  In some cases,
it may even indicate that the Evidence itself cannot be authenticated as being correct.<a class="pilcrow" href="#section-8.4-4">¶</a></p>
<p id="section-8.4-5">By default, the Relying Party does not believe the Attester to be compliant.
Upon receipt of an authentic Attestation Result and given the Appraisal Policy for Attestation Results is satisfied,
the Attester is allowed to perform the prescribed actions or access.
The simplest such appraisal policy might authorize granting the Attester full access or control over the resources guarded by the Relying Party.
A more complex appraisal policy might involve using the information
provided in the Attestation Result to compare against expected values or to apply complex analysis
of other information contained in the Attestation Result.<a class="pilcrow" href="#section-8.4-5">¶</a></p>
<p id="section-8.4-6">Thus, Attestation Results can contain detailed information about an
        Attester, which can include privacy sensitive information as discussed
        in <a class="auto internal xref" href="#privacy-considerations">Section 11</a>.  Unlike Evidence, which is
        often very device- and vendor-specific, Attestation Results can be
        vendor-neutral, if the Verifier has a way to generate vendor-agnostic
        information based on the appraisal of vendor-specific information in
        Evidence.  This allows a Relying Party's appraisal policy to be
        simpler, potentially based on standard ways of expressing the
        information, while still allowing interoperability with heterogeneous
        devices.<a class="pilcrow" href="#section-8.4-6">¶</a></p>
<p id="section-8.4-7">Finally, whereas Evidence is signed by the device (or indirectly by
        a manufacturer if Endorsements are used), Attestation Results are
        signed by a Verifier, allowing a Relying Party to only need a trust
        relationship with one entity rather than a larger set of entities
        for purposes of its appraisal policy.<a class="pilcrow" href="#section-8.4-7">¶</a></p>
</section>
</div>
<div id="appraisal-policies">
<section id="section-8.5">
        <h3 id="name-appraisal-policies">
<a class="section-number selfRef" href="#section-8.5">8.5. </a><a class="section-name selfRef" href="#name-appraisal-policies">Appraisal Policies</a>
        </h3>
<p id="section-8.5-1">The Verifier (when appraising Evidence) or the Relying Party (when
appraising Attestation Results) checks the values of matched Claims
against constraints specified in its appraisal policy.
Examples of such constraints checking include the following:<a class="pilcrow" href="#section-8.5-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.5-2.1">Comparison for equality against a Reference Value.<a class="pilcrow" href="#section-8.5-2.1">¶</a>
</li>
          <li class="normal" id="section-8.5-2.2">A check for being in a range bounded by Reference Values.<a class="pilcrow" href="#section-8.5-2.2">¶</a>
</li>
          <li class="normal" id="section-8.5-2.3">Membership in a set of Reference Values.<a class="pilcrow" href="#section-8.5-2.3">¶</a>
</li>
          <li class="normal" id="section-8.5-2.4">A check against values in other Claims.<a class="pilcrow" href="#section-8.5-2.4">¶</a>
</li>
        </ul>
<p id="section-8.5-3">Upon completing all appraisal policy constraints, the remaining Claims are accepted
as input toward determining Attestation Results (when appraising Evidence)
or as input to a Relying Party (when appraising Attestation Results).<a class="pilcrow" href="#section-8.5-3">¶</a></p>
</section>
</div>
</section>
</div>
<div id="claims-encoding-formats">
<section id="section-9">
      <h2 id="name-claims-encoding-formats">
<a class="section-number selfRef" href="#section-9">9. </a><a class="section-name selfRef" href="#name-claims-encoding-formats">Claims Encoding Formats</a>
      </h2>
<p id="section-9-1"><a class="auto internal xref" href="#clientserver">Figure 8</a> illustrates a relationship to which remote attestation is desired to be added:<a class="pilcrow" href="#section-9-1">¶</a></p>
<span id="name-typical-resource-access"></span><div id="clientserver">
<figure id="figure-8">
        <div id="section-9-2.1">
          <div class="alignLeft art-svg artwork" id="section-9-2.1.1">
<svg class="diagram" font-family="monospace" font-size="13px" height="128" text-anchor="middle" version="1.1" viewBox="0 0 432 128" width="432" xmlns="http://www.w3.org/2000/svg">
              <path d="M 8,32 L 8,96" fill="none" stroke="black"></path>
              <path d="M 120,32 L 120,96" fill="none" stroke="black"></path>
              <path d="M 248,32 L 248,96" fill="none" stroke="black"></path>
              <path d="M 352,32 L 352,96" fill="none" stroke="black"></path>
              <path d="M 8,32 L 120,32" fill="none" stroke="black"></path>
              <path d="M 248,32 L 352,32" fill="none" stroke="black"></path>
              <path d="M 120,48 L 240,48" fill="none" stroke="black"></path>
              <path d="M 8,96 L 120,96" fill="none" stroke="black"></path>
              <path d="M 248,96 L 352,96" fill="none" stroke="black"></path>
              <polygon class="arrowhead" fill="black" points="248,48 236,42.4 236,53.6" transform="rotate(0,240,48)"></polygon>
              <g class="text">
                <text x="396" y="36">Evaluate</text>
                <text x="392" y="52">request</text>
                <text x="60" y="68">Attester</text>
                <text x="164" y="68">Access</text>
                <text x="212" y="68">some</text>
                <text x="304" y="68">Relying</text>
                <text x="392" y="68">against</text>
                <text x="188" y="84">resource</text>
                <text x="304" y="84">Party</text>
                <text x="396" y="84">security</text>
                <text x="388" y="100">policy</text>
              </g>
            </svg><a class="pilcrow" href="#section-9-2.1.1">¶</a>
</div>
</div>
<figcaption><a class="selfRef" href="#figure-8">Figure 8</a>:
<a class="selfRef" href="#name-typical-resource-access">Typical Resource Access</a>
        </figcaption></figure>
</div>
<p id="section-9-3">In this diagram, the protocol between the Attester and a Relying Party
can be any new or existing protocol (e.g., HTTP(S), CoAP(S),
Resource-Oriented Lightweight Information Exchange (ROLIE) <span>[<a class="cite xref" href="#RFC8322">RFC8322</a>]</span>,
802.1x, OPC UA <span>[<a class="cite xref" href="#OPCUA">OPCUA</a>]</span>, etc.) depending on the use case.<a class="pilcrow" href="#section-9-3">¶</a></p>
<p id="section-9-4">Typically, such protocols already have mechanisms for passing security information for authentication and authorization purposes.
Common formats include JSON Web Tokens (JWTs) <span>[<a class="cite xref" href="#RFC7519">RFC7519</a>]</span>, CWTs <span>[<a class="cite xref" href="#RFC8392">RFC8392</a>]</span>, and X.509 certificates.<a class="pilcrow" href="#section-9-4">¶</a></p>
<p id="section-9-5">Retrofitting already-deployed protocols with remote attestation requires
adding RATS conceptual messages to the existing data flows. This must be
done in a way that does not degrade the security properties of the systems involved
and should use extension mechanisms provided by the underlying
protocol. For example, if a TLS handshake is to be extended with
remote attestation capabilities, attestation Evidence may be embedded
in an ad hoc X.509 certificate extension (e.g., <span>[<a class="cite xref" href="#TCG-DICE">TCG-DICE</a>]</span>) or into a new
TLS Certificate Type (e.g., <span>[<a class="cite xref" href="#I-D.tschofenig-tls-cwt">TLS-CWT</a>]</span>).<a class="pilcrow" href="#section-9-5">¶</a></p>
<p id="section-9-6">Especially for constrained nodes, there is a desire to minimize
the amount of parsing code needed in a Relying Party in order to both
minimize footprint and the attack surface. While
it would be possible to embed a CWT inside a JWT, or a JWT inside an
X.509 extension, etc., there is a desire to encode the information
in a format that is already supported by the Relying Party.<a class="pilcrow" href="#section-9-6">¶</a></p>
<p id="section-9-7">This motivates having a common "information model" that describes
the set of remote attestation related information in an encoding-agnostic
way and allows multiple encoding formats (CWT, JWT, X.509, etc.)
that encode the same information into the Claims format needed by the
Relying Party.<a class="pilcrow" href="#section-9-7">¶</a></p>
<p id="section-9-8"><a class="auto internal xref" href="#multievidence_diag">Figure 9</a> illustrates that Evidence and
      Attestation Results might be expressed via multiple potential encoding
      formats so that they can be conveyed by various existing protocols.  It
      also motivates why the Verifier might also be responsible for accepting
      Evidence that encodes Claims in one format while issuing Attestation
      Results that encode Claims in a different format.<a class="pilcrow" href="#section-9-8">¶</a></p>
<span id="name-multiple-attesters-and-rely"></span><div id="multievidence_diag">
<figure id="figure-9">
        <div id="section-9-9.1">
          <div class="alignCenter art-svg artwork" id="section-9-9.1.1">
<svg class="diagram" font-family="monospace" font-size="13px" height="352" text-anchor="middle" version="1.1" viewBox="0 0 560 352" width="560" xmlns="http://www.w3.org/2000/svg">
              <path d="M 8,48 L 8,80" fill="none" stroke="black"></path>
              <path d="M 8,112 L 8,144" fill="none" stroke="black"></path>
              <path d="M 8,176 L 8,208" fill="none" stroke="black"></path>
              <path d="M 8,240 L 8,272" fill="none" stroke="black"></path>
              <path d="M 8,304 L 8,336" fill="none" stroke="black"></path>
              <path d="M 128,48 L 128,80" fill="none" stroke="black"></path>
              <path d="M 128,112 L 128,144" fill="none" stroke="black"></path>
              <path d="M 128,176 L 128,208" fill="none" stroke="black"></path>
              <path d="M 128,240 L 128,272" fill="none" stroke="black"></path>
              <path d="M 128,304 L 128,336" fill="none" stroke="black"></path>
              <path d="M 208,112 L 208,272" fill="none" stroke="black"></path>
              <path d="M 232,80 L 232,104" fill="none" stroke="black"></path>
              <path d="M 232,280 L 232,304" fill="none" stroke="black"></path>
              <path d="M 288,80 L 288,112" fill="none" stroke="black"></path>
              <path d="M 288,272 L 288,304" fill="none" stroke="black"></path>
              <path d="M 312,112 L 312,272" fill="none" stroke="black"></path>
              <path d="M 392,48 L 392,80" fill="none" stroke="black"></path>
              <path d="M 392,112 L 392,144" fill="none" stroke="black"></path>
              <path d="M 392,176 L 392,208" fill="none" stroke="black"></path>
              <path d="M 392,240 L 392,272" fill="none" stroke="black"></path>
              <path d="M 392,304 L 392,336" fill="none" stroke="black"></path>
              <path d="M 552,48 L 552,80" fill="none" stroke="black"></path>
              <path d="M 552,112 L 552,144" fill="none" stroke="black"></path>
              <path d="M 552,176 L 552,208" fill="none" stroke="black"></path>
              <path d="M 552,240 L 552,272" fill="none" stroke="black"></path>
              <path d="M 552,304 L 552,336" fill="none" stroke="black"></path>
              <path d="M 8,48 L 128,48" fill="none" stroke="black"></path>
              <path d="M 392,48 L 552,48" fill="none" stroke="black"></path>
              <path d="M 128,64 L 216,64" fill="none" stroke="black"></path>
              <path d="M 304,64 L 384,64" fill="none" stroke="black"></path>
              <path d="M 8,80 L 128,80" fill="none" stroke="black"></path>
              <path d="M 392,80 L 552,80" fill="none" stroke="black"></path>
              <path d="M 8,112 L 128,112" fill="none" stroke="black"></path>
              <path d="M 208,112 L 312,112" fill="none" stroke="black"></path>
              <path d="M 392,112 L 552,112" fill="none" stroke="black"></path>
              <path d="M 128,128 L 200,128" fill="none" stroke="black"></path>
              <path d="M 312,128 L 384,128" fill="none" stroke="black"></path>
              <path d="M 8,144 L 128,144" fill="none" stroke="black"></path>
              <path d="M 392,144 L 552,144" fill="none" stroke="black"></path>
              <path d="M 8,176 L 128,176" fill="none" stroke="black"></path>
              <path d="M 392,176 L 552,176" fill="none" stroke="black"></path>
              <path d="M 128,192 L 200,192" fill="none" stroke="black"></path>
              <path d="M 312,192 L 384,192" fill="none" stroke="black"></path>
              <path d="M 8,208 L 128,208" fill="none" stroke="black"></path>
              <path d="M 392,208 L 552,208" fill="none" stroke="black"></path>
              <path d="M 8,240 L 128,240" fill="none" stroke="black"></path>
              <path d="M 392,240 L 552,240" fill="none" stroke="black"></path>
              <path d="M 128,256 L 200,256" fill="none" stroke="black"></path>
              <path d="M 312,256 L 384,256" fill="none" stroke="black"></path>
              <path d="M 8,272 L 128,272" fill="none" stroke="black"></path>
              <path d="M 208,272 L 312,272" fill="none" stroke="black"></path>
              <path d="M 392,272 L 552,272" fill="none" stroke="black"></path>
              <path d="M 8,304 L 128,304" fill="none" stroke="black"></path>
              <path d="M 392,304 L 552,304" fill="none" stroke="black"></path>
              <path d="M 128,320 L 216,320" fill="none" stroke="black"></path>
              <path d="M 304,320 L 384,320" fill="none" stroke="black"></path>
              <path d="M 8,336 L 128,336" fill="none" stroke="black"></path>
              <path d="M 392,336 L 552,336" fill="none" stroke="black"></path>
              <path d="M 216,64 C 224.83064,64 232,71.16936 232,80" fill="none" stroke="black"></path>
              <path d="M 304,64 C 295.16936,64 288,71.16936 288,80" fill="none" stroke="black"></path>
              <path d="M 216,320 C 224.83064,320 232,312.83064 232,304" fill="none" stroke="black"></path>
              <path d="M 304,320 C 295.16936,320 288,312.83064 288,304" fill="none" stroke="black"></path>
              <polygon class="arrowhead" fill="black" points="392,320 380,314.4 380,325.6" transform="rotate(0,384,320)"></polygon>
              <polygon class="arrowhead" fill="black" points="392,256 380,250.4 380,261.6" transform="rotate(0,384,256)"></polygon>
              <polygon class="arrowhead" fill="black" points="392,192 380,186.4 380,197.6" transform="rotate(0,384,192)"></polygon>
              <polygon class="arrowhead" fill="black" points="392,128 380,122.4 380,133.6" transform="rotate(0,384,128)"></polygon>
              <polygon class="arrowhead" fill="black" points="392,64 380,58.4 380,69.6" transform="rotate(0,384,64)"></polygon>
              <polygon class="arrowhead" fill="black" points="240,280 228,274.4 228,285.6" transform="rotate(270,232,280)"></polygon>
              <polygon class="arrowhead" fill="black" points="240,104 228,98.4 228,109.6" transform="rotate(90,232,104)"></polygon>
              <polygon class="arrowhead" fill="black" points="208,256 196,250.4 196,261.6" transform="rotate(0,200,256)"></polygon>
              <polygon class="arrowhead" fill="black" points="208,192 196,186.4 196,197.6" transform="rotate(0,200,192)"></polygon>
              <polygon class="arrowhead" fill="black" points="208,128 196,122.4 196,133.6" transform="rotate(0,200,128)"></polygon>
              <g class="text">
                <text x="164" y="36">Evidence</text>
                <text x="328" y="36">Attestation</text>
                <text x="408" y="36">Results</text>
                <text x="168" y="52">CWT</text>
                <text x="352" y="52">CWT</text>
                <text x="68" y="68">Attester-A</text>
                <text x="440" y="68">Relying</text>
                <text x="496" y="68">Party</text>
                <text x="528" y="68">V</text>
                <text x="168" y="116">JWT</text>
                <text x="352" y="116">JWT</text>
                <text x="68" y="132">Attester-B</text>
                <text x="440" y="132">Relying</text>
                <text x="496" y="132">Party</text>
                <text x="528" y="132">W</text>
                <text x="168" y="180">X.509</text>
                <text x="352" y="180">X.509</text>
                <text x="68" y="196">Attester-C</text>
                <text x="260" y="196">Verifier</text>
                <text x="440" y="196">Relying</text>
                <text x="496" y="196">Party</text>
                <text x="528" y="196">X</text>
                <text x="168" y="244">TPM</text>
                <text x="352" y="244">TPM</text>
                <text x="68" y="260">Attester-D</text>
                <text x="440" y="260">Relying</text>
                <text x="496" y="260">Party</text>
                <text x="528" y="260">Y</text>
                <text x="168" y="308">other</text>
                <text x="352" y="308">other</text>
                <text x="68" y="324">Attester-E</text>
                <text x="440" y="324">Relying</text>
                <text x="496" y="324">Party</text>
                <text x="528" y="324">Z</text>
              </g>
            </svg><a class="pilcrow" href="#section-9-9.1.1">¶</a>
</div>
</div>
<figcaption><a class="selfRef" href="#figure-9">Figure 9</a>:
<a class="selfRef" href="#name-multiple-attesters-and-rely">Multiple Attesters and Relying Parties with Different Formats</a>
        </figcaption></figure>
</div>
</section>
</div>
<div id="freshness">
<section id="section-10">
      <h2 id="name-freshness">
<a class="section-number selfRef" href="#section-10">10. </a><a class="section-name selfRef" href="#name-freshness">Freshness</a>
      </h2>
<p id="section-10-1">A Verifier or Relying Party might need to learn the point in time
(i.e., the "epoch") an Evidence or Attestation Result has been produced.  This is essential in deciding whether the included Claims can be considered fresh,
meaning they still reflect the latest state of the Attester, and that any
Attestation Result was generated using the latest Appraisal Policy for Evidence, Endorsements, and Reference Values.<a class="pilcrow" href="#section-10-1">¶</a></p>
<p id="section-10-2">This section provides a number of details.
However, it does not define any protocol formats and the interactions shown are abstract.
This section is intended for those creating protocols and solutions to understand the options available to ensure freshness.
The way in which freshness is provisioned in a protocol is an architectural decision.
Provisioning of freshness has an impact on the number of needed round trips in a protocol; therefore, it must be made very early in the design.
Different decisions will have significant impacts on resulting interoperability,
which is why this section goes into sufficient detail such that choices in freshness will be compatible across interacting protocols, such as depicted in <a class="auto internal xref" href="#multievidence_diag">Figure 9</a>.<a class="pilcrow" href="#section-10-2">¶</a></p>
<p id="section-10-3">Freshness is assessed based on the Appraisal Policy for Evidence or
      Attestation Results that compares the estimated epoch against an
      "expiry" threshold defined locally to that policy.  There is, however,
      always a race condition possible in that the state of the Attester and
      the appraisal policies might change immediately after the Evidence or
      Attestation Result was generated.  The goal is merely to narrow their
      recentness to something the Verifier (for Evidence) or Relying Party
      (for Attestation Result) is willing to accept.  Some flexibility on the
      freshness requirement is a key component for enabling caching and reuse
      of both Evidence and Attestation Results, which is especially valuable
      in cases where their computation uses a substantial part of the resource
      budget (e.g., energy in constrained devices).<a class="pilcrow" href="#section-10-3">¶</a></p>
<p id="section-10-4">There are three common approaches for determining the epoch of Evidence or an
Attestation Result.<a class="pilcrow" href="#section-10-4">¶</a></p>
<div id="explicit-timekeeping-using-synchronized-clocks">
<section id="section-10.1">
        <h3 id="name-explicit-timekeeping-using-">
<a class="section-number selfRef" href="#section-10.1">10.1. </a><a class="section-name selfRef" href="#name-explicit-timekeeping-using-">Explicit Timekeeping Using Synchronized Clocks</a>
        </h3>
<p id="section-10.1-1">The first approach is to rely on synchronized and trustworthy clocks and
include a signed timestamp (see <span>[<a class="cite xref" href="#I-D.birkholz-rats-tuda">RATS-TUDA</a>]</span>) along with the
Claims in the Evidence or Attestation Result.  Timestamps can also be added on a
per-Claim basis to distinguish the time of generation of Evidence or Attestation
Result from the time that a specific Claim was generated.  The clock's
trustworthiness can generally be established via Endorsements and typically requires additional Claims about the signer's time
synchronization mechanism.<a class="pilcrow" href="#section-10.1-1">¶</a></p>
<p id="section-10.1-2">However, a trustworthy clock might not be available in some use cases. For
example, in many TEEs today, a clock is only
available outside the TEE; thus, it cannot be trusted by the TEE.<a class="pilcrow" href="#section-10.1-2">¶</a></p>
</section>
</div>
<div id="implicit-timekeeping-using-nonces">
<section id="section-10.2">
        <h3 id="name-implicit-timekeeping-using-">
<a class="section-number selfRef" href="#section-10.2">10.2. </a><a class="section-name selfRef" href="#name-implicit-timekeeping-using-">Implicit Timekeeping Using Nonces</a>
        </h3>
<p id="section-10.2-1">A second approach
        places the onus of timekeeping solely on the Verifier (for Evidence)
        or the Relying Party (for Attestation Results). For example, this
        approach might be suitable in case the Attester does not have a
        trustworthy clock or time synchronization is otherwise impaired.
 In
        this approach, an unpredictable nonce is sent by the appraising
        entity and the nonce is then signed and included along with the Claims
        in the Evidence or Attestation Result.  After checking that the sent
        and received nonces are the same, the appraising entity knows that the
        Claims were signed after the nonce was generated.  This allows
        associating a "rough" epoch to the Evidence or Attestation Result.  In
        this case, the epoch is said to be rough because:<a class="pilcrow" href="#section-10.2-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.2-2.1">The epoch applies to the entire Claim set instead of a more granular
association, and<a class="pilcrow" href="#section-10.2-2.1">¶</a>
</li>
          <li class="normal" id="section-10.2-2.2">The time between the creation of Claims and the collection of Claims is
indistinguishable.<a class="pilcrow" href="#section-10.2-2.2">¶</a>
</li>
        </ul>
</section>
</div>
<div id="epochfreshness">
<section id="section-10.3">
        <h3 id="name-implicit-timekeeping-using-e">
<a class="section-number selfRef" href="#section-10.3">10.3. </a><a class="section-name selfRef" href="#name-implicit-timekeeping-using-e">Implicit Timekeeping Using Epoch IDs</a>
        </h3>
<p id="section-10.3-1">A third approach relies on having epoch identifiers (IDs)
periodically sent to both the sender and receiver of Evidence or
Attestation Results by some "epoch ID distributor".<a class="pilcrow" href="#section-10.3-1">¶</a></p>
<p id="section-10.3-2">Epoch IDs are different from nonces as they can be used more than once and
can even be used by more than one entity at the same time.
Epoch IDs are different from timestamps as they do not have to convey information about a point in time, i.e., they are not necessarily monotonically increasing integers.<a class="pilcrow" href="#section-10.3-2">¶</a></p>
<p id="section-10.3-3">Like the nonce approach, this allows associating a "rough" epoch without
requiring a trustworthy clock or time synchronization in order to generate or
appraise the freshness of Evidence or Attestation Results.  Only the
epoch ID distributor requires access to a clock so it can periodically send
new epoch IDs.<a class="pilcrow" href="#section-10.3-3">¶</a></p>
<p id="section-10.3-4">The most recent epoch ID is included in the produced Evidence or Attestation
Results, and the appraising entity can compare the epoch ID in received
Evidence or Attestation Results against the latest epoch ID it received from
the epoch ID distributor to determine if it is within the current epoch.
An actual solution also needs to take into account race conditions
when transitioning to a new epoch, such as by using a counter signed
by the epoch ID distributor as the epoch ID, by including both the current and
previous epoch IDs in messages and/or checks by requiring retries
in case of mismatching epoch IDs, or by buffering incoming messages
that might be associated with an epoch ID that the receiver has not yet
obtained.<a class="pilcrow" href="#section-10.3-4">¶</a></p>
<p id="section-10.3-5">More generally, in order to prevent an appraising entity from generating false
negatives (e.g., discarding Evidence that is deemed stale even if it is
not), the appraising entity should keep an "epoch window" consisting of the
most recently received epoch IDs.  The depth of such epoch window is directly
proportional to the maximum network propagation delay between the first to receive the epoch ID and the last to receive the epoch ID and it is inversely proportional to the epoch duration.
The appraising entity shall compare the
epoch ID carried in the received Evidence or Attestation Result with the epoch IDs
in its epoch window to find a suitable match.<a class="pilcrow" href="#section-10.3-5">¶</a></p>
<p id="section-10.3-6">Whereas the nonce approach typically requires the appraising entity
to keep state for each nonce generated, the epoch ID approach minimizes
the state kept to be independent of the number of Attesters or Verifiers
from which it expects to receive Evidence or Attestation Results as long
as all use the same epoch ID distributor.<a class="pilcrow" href="#section-10.3-6">¶</a></p>
</section>
</div>
<div id="discussion">
<section id="section-10.4">
        <h3 id="name-discussion">
<a class="section-number selfRef" href="#section-10.4">10.4. </a><a class="section-name selfRef" href="#name-discussion">Discussion</a>
        </h3>
<p id="section-10.4-1">Implicit and explicit timekeeping can be combined into hybrid mechanisms.
For example, if clocks exist within the Attesting Environment and are considered trustworthy (tamper-proof) but are not synchronized, a nonce-based exchange may be used to determine the (relative) time offset between the involved peers followed by any number of timestamp
based exchanges.<a class="pilcrow" href="#section-10.4-1">¶</a></p>
<p id="section-10.4-2">It is important to note that the actual values in Claims might have been
generated long before the Claims are signed.  If so, it is the signer's
responsibility to ensure that the values are still fresh when they are
signed.  For example, values generated at boot time might have been saved to
secure storage until network connectivity is established to the remote Verifier
and a nonce is obtained.<a class="pilcrow" href="#section-10.4-2">¶</a></p>
<p id="section-10.4-3">A more detailed discussion with examples appears in <a class="auto internal xref" href="#time-considerations">Appendix A</a>.<a class="pilcrow" href="#section-10.4-3">¶</a></p>
<p id="section-10.4-4">For a discussion on the security of epoch IDs see <a class="auto internal xref" href="#epochids-sec">Section 12.3</a>.<a class="pilcrow" href="#section-10.4-4">¶</a></p>
</section>
</div>
</section>
</div>
<div id="privacy-considerations">
<section id="section-11">
      <h2 id="name-privacy-considerations">
<a class="section-number selfRef" href="#section-11">11. </a><a class="section-name selfRef" href="#name-privacy-considerations">Privacy Considerations</a>
      </h2>
<p id="section-11-1">The conveyance of Evidence and the resulting Attestation Results
reveal a great deal of information about the internal state of a
device as well as potentially any users of the device.<a class="pilcrow" href="#section-11-1">¶</a></p>
<p id="section-11-2">In many cases, the whole point of attestation procedures is
to provide reliable information about the type of the device and the
firmware/software that the device is running.<a class="pilcrow" href="#section-11-2">¶</a></p>
<p id="section-11-3">This information might be particularly interesting to many attackers.
For example, knowing that a device is
running a weak version of firmware provides a way to aim attacks better.<a class="pilcrow" href="#section-11-3">¶</a></p>
<p id="section-11-4">In some circumstances, if an attacker can become aware of Endorsements, Reference Values, or appraisal policies, it could potentially provide an attacker with insight into defensive mitigations.
It is recommended that attention be paid to confidentiality of such information.<a class="pilcrow" href="#section-11-4">¶</a></p>
<p id="section-11-5">Additionally, many Evidence, Attestation Results, and appraisal policies potentially contain Personally Identifying Information (PII) depending on the end-to-end use case of
the remote attestation procedure.
Remote attestation that includes containers and applications, e.g., a blood pressure monitor, may further
reveal details about specific systems or users.<a class="pilcrow" href="#section-11-5">¶</a></p>
<p id="section-11-6">In some cases, an attacker may be able to make inferences about the contents of Evidence
from the resulting effects or timing of the processing.
For example, an attacker might be able to infer the value of specific Claims if it knew that only certain values were accepted by the Relying Party.<a class="pilcrow" href="#section-11-6">¶</a></p>
<p id="section-11-7">Conceptual messages (see <a class="auto internal xref" href="#messages">Section 8</a>) carrying sensitive or confidential information are expected to be integrity protected (i.e., either via signing or a secure channel) and optionally might be confidentiality protected via encryption.
If there isn't confidentiality protection of conceptual messages themselves, the underlying conveyance protocol should provide these protections.<a class="pilcrow" href="#section-11-7">¶</a></p>
<p id="section-11-8">As Evidence might contain sensitive or confidential information,
Attesters are responsible for only sending such Evidence to trusted
Verifiers.
Some Attesters might want a stronger level of assurance of
the trustworthiness of a Verifier before sending Evidence to it.
In such cases,
an Attester can first act as a Relying Party and ask for the Verifier's own
Attestation Result. Appraising it just as a Relying Party would appraise
an Attestation Result for any other purpose.<a class="pilcrow" href="#section-11-8">¶</a></p>
<p id="section-11-9">Another approach to deal with Evidence is to remove PII from the Evidence
while still being able to verify that the Attester is one of a large set.
This approach is often called "Direct Anonymous Attestation".  See
Section 6.2 of <span>[<a class="cite xref" href="#CCC-DeepDive">CCC-DeepDive</a>]</span> and <span>[<a class="cite xref" href="#I-D.ietf-rats-daa">RATS-DAA</a>]</span> for more discussion.<a class="pilcrow" href="#section-11-9">¶</a></p>
</section>
</div>
<div id="security-considerations">
<section id="section-12">
      <h2 id="name-security-considerations">
<a class="section-number selfRef" href="#section-12">12. </a><a class="section-name selfRef" href="#name-security-considerations">Security Considerations</a>
      </h2>
<p id="section-12-1">This document provides an architecture for doing remote attestation.
No specific wire protocol is documented here.
Without a specific proposal to compare against, it is impossible to know if the security threats listed below have been mitigated well.<a class="pilcrow" href="#section-12-1">¶</a></p>
<p id="section-12-2">The security considerations below should be read as being, essentially, requirements against realizations of the RATS architecture.
Some threats apply to protocols and some are against implementations (code) and physical infrastructure (such as factories).<a class="pilcrow" href="#section-12-2">¶</a></p>
<p id="section-12-3">The fundamental purpose of the RATS architecture is to allow a Relying Party to establish a basis for trusting the Attester.<a class="pilcrow" href="#section-12-3">¶</a></p>
<div id="attester-and-attestation-key-protection">
<section id="section-12.1">
        <h3 id="name-attester-and-attestation-ke">
<a class="section-number selfRef" href="#section-12.1">12.1. </a><a class="section-name selfRef" href="#name-attester-and-attestation-ke">Attester and Attestation Key Protection</a>
        </h3>
<p id="section-12.1-1">Implementers need to pay close attention to the protection of the Attester and the manufacturing processes for provisioning attestation key material. If either of these are compromised, intended levels of assurance for  remote attestation procedures are compromised because attackers can forge Evidence or manipulate the Attesting Environment.
For example, a Target Environment should not be able to tamper with the
Attesting Environment that measures it by isolating the two environments
from each other in some way.<a class="pilcrow" href="#section-12.1-1">¶</a></p>
<p id="section-12.1-2">Remote attestation applies to use cases with a range of security requirements. The protections discussed here range from low to high security: low security may be limited to application or process isolation by the device's operating system and high security may involve specialized hardware to defend against physical attacks on a chip.<a class="pilcrow" href="#section-12.1-2">¶</a></p>
<div id="on-device-attester-and-key-protection">
<section id="section-12.1.1">
          <h4 id="name-on-device-attester-and-key-">
<a class="section-number selfRef" href="#section-12.1.1">12.1.1. </a><a class="section-name selfRef" href="#name-on-device-attester-and-key-">On-Device Attester and Key Protection</a>
          </h4>
<p id="section-12.1.1-1">It is assumed that an Attesting Environment is sufficiently isolated from the
Target Environment it collects Claims about and that it signs the resulting Claims set with an attestation
key so that the Target Environment cannot forge Evidence about itself.  Such
an isolated environment might be provided by a process, a dedicated chip,
a TEE, a virtual machine, or another secure mode of operation.
The Attesting Environment must be protected from unauthorized modification to ensure it behaves correctly. Confidentiality protection of the Attesting Environment's signing key is vital so it cannot be misused to forge Evidence.<a class="pilcrow" href="#section-12.1.1-1">¶</a></p>
<p id="section-12.1.1-2">In many cases, the user or owner of a device that includes the role of Attester must not be able to modify or extract keys from the Attesting Environments to prevent creating forged Evidence.
Some common examples include the user of a mobile phone or FIDO authenticator.<a class="pilcrow" href="#section-12.1.1-2">¶</a></p>
<p id="section-12.1.1-3">Measures for a minimally protected system might include process or application isolation provided by a high-level operating system and restricted access to root or system privileges. In contrast, for really simple single-use devices that don't use a protected mode operating system (like a Bluetooth speaker), the only factual isolation might be the sturdy housing of the device.<a class="pilcrow" href="#section-12.1.1-3">¶</a></p>
<p id="section-12.1.1-4">Measures for a moderately protected system could include a special restricted operating environment, such as a TEE. In this case, only security-oriented software has access to the Attester and key material.<a class="pilcrow" href="#section-12.1.1-4">¶</a></p>
<p id="section-12.1.1-5">Measures for a highly protected system could include specialized hardware that is used to provide protection against chip decapping attacks, power supply and clock glitching, faulting injection and RF, and power side channel attacks.<a class="pilcrow" href="#section-12.1.1-5">¶</a></p>
</section>
</div>
<div id="attestation-key-provisioning-processes">
<section id="section-12.1.2">
          <h4 id="name-attestation-key-provisionin">
<a class="section-number selfRef" href="#section-12.1.2">12.1.2. </a><a class="section-name selfRef" href="#name-attestation-key-provisionin">Attestation Key Provisioning Processes</a>
          </h4>
<p id="section-12.1.2-1">Attestation key provisioning is the process that occurs in the factory or elsewhere to establish signing key material on the device and the validation key material off the device.
Sometimes, this procedure is referred to as "personalization" or "customization".<a class="pilcrow" href="#section-12.1.2-1">¶</a></p>
<p id="section-12.1.2-2">When generating keys off-device in the factory or in the device, the use of
a cryptographically strong sequence (<span>[<a class="cite xref" href="#RFC4086">RFC4086</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc4086#section-6.2">Section 6.2</a></span>) needs consideration.<a class="pilcrow" href="#section-12.1.2-2">¶</a></p>
<div id="off-device-key-generation">
<section id="section-12.1.2.1">
            <h5 id="name-off-device-key-generation">
<a class="section-number selfRef" href="#section-12.1.2.1">12.1.2.1. </a><a class="section-name selfRef" href="#name-off-device-key-generation">Off-Device Key Generation</a>
            </h5>
<p id="section-12.1.2.1-1">One way to provision key material is to first generate it external to the device and then copy the key onto the device.
In this case, confidentiality protection of the generator and the path over which the key is provisioned is necessary.
The manufacturer needs to take care to protect corresponding key material with measures appropriate for its value.<a class="pilcrow" href="#section-12.1.2.1-1">¶</a></p>
<p id="section-12.1.2.1-2">The degree of protection afforded to this key material can vary by the intended
function of the device and the specific practices of the device manufacturer or integrator.
The confidentiality protection is fundamentally based upon some amount of physical protection. While encryption is often used to provide confidentiality when a key is conveyed across a factory where the attestation key is created or applied, it must be available in an unencrypted form.
The physical protection can therefore vary from situations where the key is unencrypted only within carefully controlled secure enclaves within silicon to situations where an entire facility is considered secure
by the simple means of locked doors and limited access.<a class="pilcrow" href="#section-12.1.2.1-2">¶</a></p>
<p id="section-12.1.2.1-3">The cryptography that is used to enable confidentiality protection of the attestation key comes with its own requirements to be secured.
This results in recursive problems, as the key material used to provision attestation keys must again somehow have been provisioned securely beforehand (requiring an additional level of protection and so on).<a class="pilcrow" href="#section-12.1.2.1-3">¶</a></p>
<p id="section-12.1.2.1-4">Commonly, a combination of some physical security measures and some cryptographic measures are used to establish confidentiality protection.<a class="pilcrow" href="#section-12.1.2.1-4">¶</a></p>
</section>
</div>
<div id="on-device-key-generation">
<section id="section-12.1.2.2">
            <h5 id="name-on-device-key-generation">
<a class="section-number selfRef" href="#section-12.1.2.2">12.1.2.2. </a><a class="section-name selfRef" href="#name-on-device-key-generation">On-Device Key Generation</a>
            </h5>
<p id="section-12.1.2.2-1">When key material is generated within a device and the secret part of it never leaves the device, the problem may lessen.  
 For public-key cryptography, it is not necessary to maintain confidentiality
 of the public key.  However, integrity of the chain of custody of the
 public key is necessary in order to avoid attacks where an attacker is able
 to get a key endorsed that the attacker controls.<a class="pilcrow" href="#section-12.1.2.2-1">¶</a></p>
<p id="section-12.1.2.2-2">To summarize, attestation key provisioning must ensure that only valid attestation key material is established in Attesters.<a class="pilcrow" href="#section-12.1.2.2-2">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="conceptual-message-protection">
<section id="section-12.2">
        <h3 id="name-conceptual-message-protecti">
<a class="section-number selfRef" href="#section-12.2">12.2. </a><a class="section-name selfRef" href="#name-conceptual-message-protecti">Conceptual Message Protection</a>
        </h3>
<p id="section-12.2-1">Any solution that conveys information in any conceptual message (see <a class="auto internal xref" href="#messages">Section 8</a>)
must support end-to-end integrity protection
and replay attack prevention. It often also needs to support additional
security properties, including:<a class="pilcrow" href="#section-12.2-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-12.2-2.1">end-to-end encryption,<a class="pilcrow" href="#section-12.2-2.1">¶</a>
</li>
          <li class="normal" id="section-12.2-2.2">denial-of-service protection,<a class="pilcrow" href="#section-12.2-2.2">¶</a>
</li>
          <li class="normal" id="section-12.2-2.3">authentication,<a class="pilcrow" href="#section-12.2-2.3">¶</a>
</li>
          <li class="normal" id="section-12.2-2.4">auditing,<a class="pilcrow" href="#section-12.2-2.4">¶</a>
</li>
          <li class="normal" id="section-12.2-2.5">fine-grained access controls, and<a class="pilcrow" href="#section-12.2-2.5">¶</a>
</li>
          <li class="normal" id="section-12.2-2.6">logging.<a class="pilcrow" href="#section-12.2-2.6">¶</a>
</li>
        </ul>
<p id="section-12.2-3"><a class="auto internal xref" href="#freshness">Section 10</a> discusses ways in which freshness can be used in this
architecture to protect against replay attacks.<a class="pilcrow" href="#section-12.2-3">¶</a></p>
<p id="section-12.2-4">To assess the security provided by a particular appraisal policy, it
is important to understand the strength of the root of trust, e.g.,
whether it is mutable software or firmware that is read-only after
boot or immutable hardware/ROM.<a class="pilcrow" href="#section-12.2-4">¶</a></p>
<p id="section-12.2-5">It is also important that the appraisal policy was obtained securely itself.
If an attacker can configure or modify appraisal policies and Endorsements or Reference Values for a Relying Party or a Verifier, then integrity of the process is compromised.<a class="pilcrow" href="#section-12.2-5">¶</a></p>
<p id="section-12.2-6">Security protections in the RATS architecture may be applied at different layers, whether by a conveyance protocol or an information encoding format.
This architecture expects conceptual messages to be end-to-end protected based on the role interaction context.
For example, if an Attester produces Evidence that is relayed through some other entity that doesn't implement the Attester or the intended Verifier roles, then the relaying entity should not expect to have access to the Evidence.<a class="pilcrow" href="#section-12.2-6">¶</a></p>
<p id="section-12.2-7">The RATS architecture allows for an entity to function in multiple roles
(<a class="auto internal xref" href="#rolesentities">Section 6</a>) and for composite devices (<a class="auto internal xref" href="#compositedevice">Section 3.3</a>).
Implementers need to evaluate their designs to ensure that the assumed security properties of the individual components and roles still hold despite the lack of separation and that emergent risk is not introduced.  The specifics of this evaluation will depend on the implementation and the use case; hence, they are out of scope for this document.
Isolation mechanisms in software or hardware that separate Attesting Environments and Target Environments (<a class="auto internal xref" href="#twotypes">Section 3.1</a>) can support an implementer's evaluation and resulting design decisions.<a class="pilcrow" href="#section-12.2-7">¶</a></p>
</section>
</div>
<div id="epochids-sec">
<section id="section-12.3">
        <h3 id="name-attestation-based-on-epoch-">
<a class="section-number selfRef" href="#section-12.3">12.3. </a><a class="section-name selfRef" href="#name-attestation-based-on-epoch-">Attestation Based on Epoch ID</a>
        </h3>
<p id="section-12.3-1">Epoch IDs, described in <a class="auto internal xref" href="#epochfreshness">Section 10.3</a>, can be tampered with, replayed, dropped, delayed, and
reordered by an attacker.<a class="pilcrow" href="#section-12.3-1">¶</a></p>
<p id="section-12.3-2">An attacker could either be external or belong to the distribution group (for
example, if one of the Attester entities have been compromised).<a class="pilcrow" href="#section-12.3-2">¶</a></p>
<p id="section-12.3-3">An attacker who is able to tamper with epoch IDs can potentially lock all the
participants in a certain epoch of choice forever, effectively freezing time.
This is problematic since it destroys the ability to ascertain freshness of
Evidence and Attestation Results.<a class="pilcrow" href="#section-12.3-3">¶</a></p>
<p id="section-12.3-4">To mitigate this threat, the transport should be at least integrity protected
and provide origin authentication.<a class="pilcrow" href="#section-12.3-4">¶</a></p>
<p id="section-12.3-5">Selective dropping of epoch IDs is equivalent to pinning the victim node to a past epoch.
An attacker could drop epoch IDs to only some entities and not others, which will typically result in a denial of service due to the permanent staleness of the Attestation Result or Evidence.<a class="pilcrow" href="#section-12.3-5">¶</a></p>
<p id="section-12.3-6">Delaying or reordering epoch IDs is equivalent to manipulating the victim's
timeline at will.  This ability could be used by a malicious actor (e.g., a
compromised router) to mount a confusion attack. For example, a Verifier
can be tricked into accepting Evidence coming from a past epoch as fresh, while, in
the meantime, the Attester has been compromised.<a class="pilcrow" href="#section-12.3-6">¶</a></p>
<p id="section-12.3-7">Reordering and dropping attacks are mitigated if the transport provides the ability to detect reordering and drop.
However, the delay attack described above can't be thwarted in this manner.<a class="pilcrow" href="#section-12.3-7">¶</a></p>
</section>
</div>
<div id="trust-anchor-protection">
<section id="section-12.4">
        <h3 id="name-trust-anchor-protection">
<a class="section-number selfRef" href="#section-12.4">12.4. </a><a class="section-name selfRef" href="#name-trust-anchor-protection">Trust Anchor Protection</a>
        </h3>
<p id="section-12.4-1">As noted in <a class="auto internal xref" href="#trustmodel">Section 7</a>, Verifiers and Relying Parties have trust anchor stores
that must be secured.
<span>[<a class="cite xref" href="#RFC6024">RFC6024</a>]</span> contains more discussion of trust anchor store requirements
for protecting public keys.
Section 6 of <span>[<a class="cite xref" href="#NIST-800-57-p1">NIST-800-57-p1</a>]</span> contains a comprehensive treatment of the
topic, including the protection of symmetric key material.
Specifically, a trust anchor store must resist modification against unauthorized insertion, deletion, and modification.
Additionally, if the trust anchor is a symmetric key, the trust anchor store must
not allow unauthorized read.<a class="pilcrow" href="#section-12.4-1">¶</a></p>
<p id="section-12.4-2">If certificates are used as trust anchors, Verifiers and Relying Parties are also
responsible for validating the entire certificate path up to the trust anchor,
which includes checking for certificate revocation.
For an example of such a procedure, see <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc5280#section-6">Section 6</a> of [<a class="cite xref" href="#RFC5280">RFC5280</a>]</span>.<a class="pilcrow" href="#section-12.4-2">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-13">
      <h2 id="name-iana-considerations">
<a class="section-number selfRef" href="#section-13">13. </a><a class="section-name selfRef" href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<p id="section-13-1">This document has no IANA actions.<a class="pilcrow" href="#section-13-1">¶</a></p>
</section>
</div>
<section id="section-14">
      <h2 id="name-references">
<a class="section-number selfRef" href="#section-14">14. </a><a class="section-name selfRef" href="#name-references">References</a>
      </h2>
<section id="section-14.1">
        <h3 id="name-normative-references">
<a class="section-number selfRef" href="#section-14.1">14.1. </a><a class="section-name selfRef" href="#name-normative-references">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC5280">[RFC5280]</dt>
        <dd>
<span class="refAuthor">Cooper, D.</span>, <span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Boeyen, S.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time class="refDate" datetime="2008-05">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5280">https://www.rfc-editor.org/info/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7519">[RFC7519]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">N. Sakimura</span>, <span class="refTitle">"JSON Web Token (JWT)"</span>, <span class="seriesInfo">RFC 7519</span>, <span class="seriesInfo">DOI 10.17487/RFC7519</span>, <time class="refDate" datetime="2015-05">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7519">https://www.rfc-editor.org/info/rfc7519</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8392">[RFC8392]</dt>
      <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Wahlstroem, E.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"CBOR Web Token (CWT)"</span>, <span class="seriesInfo">RFC 8392</span>, <span class="seriesInfo">DOI 10.17487/RFC8392</span>, <time class="refDate" datetime="2018-05">May 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8392">https://www.rfc-editor.org/info/rfc8392</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-14.2">
        <h3 id="name-informative-references">
<a class="section-number selfRef" href="#section-14.2">14.2. </a><a class="section-name selfRef" href="#name-informative-references">Informative References</a>
        </h3>
<dl class="references">
<dt id="CCC-DeepDive">[CCC-DeepDive]</dt>
        <dd>
<span class="refAuthor">Confidential Computing Consortium</span>, <span class="refTitle">"A Technical Analysis of Confidential Computing"</span>, <span class="refContent">Version 1.3</span>, <time class="refDate" datetime="2022-11">November 2022</time>, <span>&lt;<a href="https://confidentialcomputing.io/white-papers-reports">https://confidentialcomputing.io/white-papers-reports</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="CTAP">[CTAP]</dt>
        <dd>
<span class="refAuthor">FIDO Alliance</span>, <span class="refTitle">"Client to Authenticator Protocol (CTAP)"</span>, <time class="refDate" datetime="2018-02">February 2018</time>, <span>&lt;<a href="https://fidoalliance.org/specs/fido-v2.0-id-20180227/fido-client-to-authenticator-protocol-v2.0-id-20180227.html">https://fidoalliance.org/specs/fido-v2.0-id-20180227/fido-client-to-authenticator-protocol-v2.0-id-20180227.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="NIST-800-57-p1">[NIST-800-57-p1]</dt>
        <dd>
<span class="refAuthor">Barker, E.</span>, <span class="refTitle">"Recommendation for Key Management: Part 1 - General"</span>, <span class="seriesInfo">DOI 10.6028/NIST.SP.800-57pt1r5</span>, <time class="refDate" datetime="2020-05">May 2020</time>, <span>&lt;<a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-57pt1r5.pdf">https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-57pt1r5.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="OPCUA">[OPCUA]</dt>
        <dd>
<span class="refAuthor">OPC Foundation</span>, <span class="refTitle">"OPC Unified Architecture Specification, Part 2: Security Model, Release 1.03"</span>, <span class="seriesInfo">OPC 10000-2 </span>, <time class="refDate" datetime="2015-11">November 2015</time>, <span>&lt;<a href="https://opcfoundation.org/developer-tools/specifications-unified-architecture/part-2-security-model/">https://opcfoundation.org/developer-tools/specifications-unified-architecture/part-2-security-model/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-rats-daa">[RATS-DAA]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Newton, C.</span>, <span class="refAuthor">Chen, L.</span>, and <span class="refAuthor">D. Thaler</span>, <span class="refTitle">"Direct Anonymous Attestation for the Remote Attestation Procedures Architecture"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-rats-daa-02</span>, <time class="refDate" datetime="2022-09-07">7 September 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-daa-02">https://datatracker.ietf.org/doc/html/draft-ietf-rats-daa-02</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.tschofenig-rats-psa-token">[RATS-PSA-TOKEN]</dt>
        <dd>
<span class="refAuthor">Tschofenig, H.</span>, <span class="refAuthor">Frost, S.</span>, <span class="refAuthor">Brossard, M.</span>, <span class="refAuthor">Shaw, A.</span>, and <span class="refAuthor">T. Fossati</span>, <span class="refTitle">"Arm's Platform Security Architecture (PSA) Attestation Token"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-tschofenig-rats-psa-token-10</span>, <time class="refDate" datetime="2022-09-06">6 September 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-tschofenig-rats-psa-token-10">https://datatracker.ietf.org/doc/html/draft-tschofenig-rats-psa-token-10</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.birkholz-rats-tuda">[RATS-TUDA]</dt>
        <dd>
<span class="refAuthor">Fuchs, A.</span>, <span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">McDonald, I.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"Time-Based Uni-Directional Attestation"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-birkholz-rats-tuda-07</span>, <time class="refDate" datetime="2022-07-10">10 July 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-birkholz-rats-tuda-07">https://datatracker.ietf.org/doc/html/draft-birkholz-rats-tuda-07</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-rats-uccs">[RATS-UCCS]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">O'Donoghue, J.</span>, <span class="refAuthor">Cam-Winget, N.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"A CBOR Tag for Unprotected CWT Claims Sets"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-rats-uccs-04</span>, <time class="refDate" datetime="2023-01-11">11 January 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-uccs-04">https://datatracker.ietf.org/doc/html/draft-ietf-rats-uccs-04</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4086">[RFC4086]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span>, <span class="refAuthor">Schiller, J.</span>, and <span class="refAuthor">S. Crocker</span>, <span class="refTitle">"Randomness Requirements for Security"</span>, <span class="seriesInfo">BCP 106</span>, <span class="seriesInfo">RFC 4086</span>, <span class="seriesInfo">DOI 10.17487/RFC4086</span>, <time class="refDate" datetime="2005-06">June 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4086">https://www.rfc-editor.org/info/rfc4086</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4949">[RFC4949]</dt>
        <dd>
<span class="refAuthor">Shirey, R.</span>, <span class="refTitle">"Internet Security Glossary, Version 2"</span>, <span class="seriesInfo">FYI 36</span>, <span class="seriesInfo">RFC 4949</span>, <span class="seriesInfo">DOI 10.17487/RFC4949</span>, <time class="refDate" datetime="2007-08">August 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4949">https://www.rfc-editor.org/info/rfc4949</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5209">[RFC5209]</dt>
        <dd>
<span class="refAuthor">Sangster, P.</span>, <span class="refAuthor">Khosravi, H.</span>, <span class="refAuthor">Mani, M.</span>, <span class="refAuthor">Narayan, K.</span>, and <span class="refAuthor">J. Tardo</span>, <span class="refTitle">"Network Endpoint Assessment (NEA): Overview and Requirements"</span>, <span class="seriesInfo">RFC 5209</span>, <span class="seriesInfo">DOI 10.17487/RFC5209</span>, <time class="refDate" datetime="2008-06">June 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5209">https://www.rfc-editor.org/info/rfc5209</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6024">[RFC6024]</dt>
        <dd>
<span class="refAuthor">Reddy, R.</span> and <span class="refAuthor">C. Wallace</span>, <span class="refTitle">"Trust Anchor Management Requirements"</span>, <span class="seriesInfo">RFC 6024</span>, <span class="seriesInfo">DOI 10.17487/RFC6024</span>, <time class="refDate" datetime="2010-10">October 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6024">https://www.rfc-editor.org/info/rfc6024</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8322">[RFC8322]</dt>
        <dd>
<span class="refAuthor">Field, J.</span>, <span class="refAuthor">Banghart, S.</span>, and <span class="refAuthor">D. Waltermire</span>, <span class="refTitle">"Resource-Oriented Lightweight Information Exchange (ROLIE)"</span>, <span class="seriesInfo">RFC 8322</span>, <span class="seriesInfo">DOI 10.17487/RFC8322</span>, <time class="refDate" datetime="2018-02">February 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8322">https://www.rfc-editor.org/info/rfc8322</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="strengthoffunction">[strengthoffunction]</dt>
        <dd>
<span class="refAuthor">NIST</span>, <span class="refTitle">"Strength of Function"</span>, <span>&lt;<a href="https://csrc.nist.gov/glossary/term/strength_of_function">https://csrc.nist.gov/glossary/term/strength_of_function</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TCG-DICE">[TCG-DICE]</dt>
        <dd>
<span class="refAuthor">Trusted Computing Group</span>, <span class="refTitle">"DICE Attestation Architecture"</span>, <span class="refContent">Version 1.00</span>, <span class="refContent">Revision 0.23</span>, <time class="refDate" datetime="2021-03">March 2021</time>, <span>&lt;<a href="https://trustedcomputinggroup.org/wp-content/uploads/DICE-Attestation-Architecture-r23-final.pdf">https://trustedcomputinggroup.org/wp-content/uploads/DICE-Attestation-Architecture-r23-final.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TCG-DICE-SIBDA">[TCG-DICE-SIBDA]</dt>
        <dd>
<span class="refAuthor">Trusted Computing Group</span>, <span class="refTitle">"Symmetric Identity Based Device Attestation"</span>, <span class="refContent">Version 1.0</span>, <span class="refContent">Revision 0.95</span>, <time class="refDate" datetime="2020-01">January 2020</time>, <span>&lt;<a href="https://trustedcomputinggroup.org/wp-content/uploads/TCG_DICE_SymIDAttest_v1_r0p95_pub-1.pdf">https://trustedcomputinggroup.org/wp-content/uploads/TCG_DICE_SymIDAttest_v1_r0p95_pub-1.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TCGarch">[TCGarch]</dt>
        <dd>
<span class="refAuthor">Trusted Computing Group</span>, <span class="refTitle">"Trusted Platform Module Library, Part 1: Architecture"</span>, <time class="refDate" datetime="2019-11">November 2019</time>, <span>&lt;<a href="https://trustedcomputinggroup.org/wp-content/uploads/TCG_TPM2_r1p59_Part1_Architecture_pub.pdf">https://trustedcomputinggroup.org/wp-content/uploads/TCG_TPM2_r1p59_Part1_Architecture_pub.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-teep-architecture">[TEEP-ARCH]</dt>
        <dd>
<span class="refAuthor">Pei, M.</span>, <span class="refAuthor">Tschofenig, H.</span>, <span class="refAuthor">Thaler, D.</span>, and <span class="refAuthor">D. Wheeler</span>, <span class="refTitle">"Trusted Execution Environment Provisioning (TEEP) Architecture"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-teep-architecture-19</span>, <time class="refDate" datetime="2022-10-24">24 October 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-teep-architecture-19">https://datatracker.ietf.org/doc/html/draft-ietf-teep-architecture-19</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.tschofenig-tls-cwt">[TLS-CWT]</dt>
        <dd>
<span class="refAuthor">Tschofenig, H.</span> and <span class="refAuthor">M. Brossard</span>, <span class="refTitle">"Using CBOR Web Tokens (CWTs) in Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-tschofenig-tls-cwt-02</span>, <time class="refDate" datetime="2020-07-13">13 July 2020</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-tschofenig-tls-cwt-02">https://datatracker.ietf.org/doc/html/draft-tschofenig-tls-cwt-02</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="WebAuthN">[WebAuthN]</dt>
      <dd>
<span class="refAuthor">W3C</span>, <span class="refTitle">"Web Authentication: An API for accessing Public Key Credentials Level 1"</span>, <time class="refDate" datetime="2019-03">March 2019</time>, <span>&lt;<a href="https://www.w3.org/TR/webauthn-1/">https://www.w3.org/TR/webauthn-1/</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="time-considerations">
<section id="appendix-A">
      <h2 id="name-time-considerations">
<a class="section-number selfRef" href="#appendix-A">Appendix A. </a><a class="section-name selfRef" href="#name-time-considerations">Time Considerations</a>
      </h2>
<p id="appendix-A-1"><a class="auto internal xref" href="#freshness">Section 10</a> discussed various issues and requirements around freshness of Evidence and
summarized three approaches that might be used by different solutions to address them.
This appendix provides more details with examples to help illustrate potential approaches and inform those creating specific solutions.<a class="pilcrow" href="#appendix-A-1">¶</a></p>
<p id="appendix-A-2">The table below defines a number of relevant events with an ID that
is used in subsequent diagrams.  The times of said events might be
defined in terms of an absolute clock time, such as the Coordinated Universal Time timescale,
or might be defined relative to some other timestamp or timeticks counter, such as a clock resetting its epoch each time it is powered on.<a class="pilcrow" href="#appendix-A-2">¶</a></p>
<span id="name-relevant-events-over-time"></span><table class="center" id="table-1">
        <caption>
<a class="selfRef" href="#table-1">Table 1</a>:
<a class="selfRef" href="#name-relevant-events-over-time">Relevant Events over Time</a>
        </caption>
<thead>
          <tr>
            <th class="text-left" colspan="1" rowspan="1">ID</th>
            <th class="text-left" colspan="1" rowspan="1">Event</th>
            <th class="text-left" colspan="1" rowspan="1">Explanation of event</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">VG</td>
            <td class="text-left" colspan="1" rowspan="1">Value generated</td>
            <td class="text-left" colspan="1" rowspan="1">A value to appear in a Claim was created.  In some cases, a value may have technically existed before an Attester became aware of it, but the Attester might have no idea how long it has had that value.  In such a case, the value created time is the time at which the Claim containing the copy of the value was created.</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">NS</td>
            <td class="text-left" colspan="1" rowspan="1">Nonce sent</td>
            <td class="text-left" colspan="1" rowspan="1">A nonce not predictable to an Attester (recentness &amp; uniqueness) is sent to an Attester.</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">NR</td>
            <td class="text-left" colspan="1" rowspan="1">Nonce relayed</td>
            <td class="text-left" colspan="1" rowspan="1">A nonce is relayed to an Attester by another entity.</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">IR</td>
            <td class="text-left" colspan="1" rowspan="1">Epoch ID received</td>
            <td class="text-left" colspan="1" rowspan="1">An epoch ID is successfully received and processed by an entity.</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">EG</td>
            <td class="text-left" colspan="1" rowspan="1">Evidence generation</td>
            <td class="text-left" colspan="1" rowspan="1">An Attester creates Evidence from collected Claims.</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">ER</td>
            <td class="text-left" colspan="1" rowspan="1">Evidence relayed</td>
            <td class="text-left" colspan="1" rowspan="1">A Relying Party relays Evidence to a Verifier.</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">RG</td>
            <td class="text-left" colspan="1" rowspan="1">Result generation</td>
            <td class="text-left" colspan="1" rowspan="1">A Verifier appraises Evidence and generates an Attestation Result.</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">RR</td>
            <td class="text-left" colspan="1" rowspan="1">Result relayed</td>
            <td class="text-left" colspan="1" rowspan="1">A Relying Party relays an Attestation Result to a Relying Party.</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">RA</td>
            <td class="text-left" colspan="1" rowspan="1">Result appraised</td>
            <td class="text-left" colspan="1" rowspan="1">The Relying Party appraises Attestation Results.</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">OP</td>
            <td class="text-left" colspan="1" rowspan="1">Operation performed</td>
            <td class="text-left" colspan="1" rowspan="1">The Relying Party performs some operation requested by the Attester via a resource access protocol as depicted in <a class="auto internal xref" href="#clientserver">Figure 8</a>, e.g., across a session created earlier at time(RA).</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">RX</td>
            <td class="text-left" colspan="1" rowspan="1">Result expiry</td>
            <td class="text-left" colspan="1" rowspan="1">An Attestation Result should no longer be accepted, according to the Verifier that generated it.</td>
          </tr>
        </tbody>
      </table>
<p id="appendix-A-4">Using the table above, a number of hypothetical examples of how a solution might be built are illustrated below.
This list is not intended to be complete;
it is just representative enough to highlight various timing considerations.<a class="pilcrow" href="#appendix-A-4">¶</a></p>
<p id="appendix-A-5">All times are relative to the local clocks, indicated by an "_a" (Attester),
"_v" (Verifier), or "_r" (Relying Party) suffix.<a class="pilcrow" href="#appendix-A-5">¶</a></p>
<p id="appendix-A-6">Times with an appended Prime (') indicate a second instance of the same event.<a class="pilcrow" href="#appendix-A-6">¶</a></p>
<p id="appendix-A-7">How and if clocks are synchronized depends upon the model.<a class="pilcrow" href="#appendix-A-7">¶</a></p>
<p id="appendix-A-8">In the figures below, curly braces indicate containment.
For example, the notation Evidence{foo} indicates that 'foo' is contained in the Evidence; thus, it is covered by its signature.<a class="pilcrow" href="#appendix-A-8">¶</a></p>
<div id="example-1-timestamp-based-passport-model-example">
<section id="appendix-A.1">
        <h3 id="name-example-1-timestamp-based-p">
<a class="section-number selfRef" href="#appendix-A.1">A.1. </a><a class="section-name selfRef" href="#name-example-1-timestamp-based-p">Example 1: Timestamp-Based Passport Model</a>
        </h3>
<p id="appendix-A.1-1"><a class="auto internal xref" href="#timestamp-based-passport-model">Figure 10</a>
illustrates a hypothetical Passport Model
solution that uses timestamps and requires roughly synchronized
clocks between the Attester, Verifier, and Relying Party, which
depends on using a secure clock synchronization mechanism.
As a result, the receiver of a conceptual message containing a
timestamp can directly compare it to its own clock and timestamps.<a class="pilcrow" href="#appendix-A.1-1">¶</a></p>
<span id="name-timestamp-based-passport-mo"></span><div id="timestamp-based-passport-model">
<figure id="figure-10">
          <div id="appendix-A.1-2.1">
            <div class="alignLeft art-svg artwork" id="appendix-A.1-2.1.1">
<svg class="diagram" font-family="monospace" font-size="13px" height="416" text-anchor="middle" version="1.1" viewBox="0 0 520 416" width="520" xmlns="http://www.w3.org/2000/svg">
                <path d="M 8,32 L 8,64" fill="none" stroke="black"></path>
                <path d="M 48,64 L 48,80" fill="none" stroke="black"></path>
                <path d="M 48,176 L 48,272" fill="none" stroke="black"></path>
                <path d="M 48,304 L 48,336" fill="none" stroke="black"></path>
                <path d="M 48,368 L 48,384" fill="none" stroke="black"></path>
                <path d="M 96,32 L 96,64" fill="none" stroke="black"></path>
                <path d="M 272,32 L 272,64" fill="none" stroke="black"></path>
                <path d="M 320,64 L 320,112" fill="none" stroke="black"></path>
                <path d="M 320,144 L 320,208" fill="none" stroke="black"></path>
                <path d="M 320,240 L 320,272" fill="none" stroke="black"></path>
                <path d="M 360,32 L 360,64" fill="none" stroke="black"></path>
                <path d="M 384,32 L 384,64" fill="none" stroke="black"></path>
                <path d="M 448,64 L 448,112" fill="none" stroke="black"></path>
                <path d="M 448,144 L 448,272" fill="none" stroke="black"></path>
                <path d="M 512,32 L 512,64" fill="none" stroke="black"></path>
                <path d="M 8,32 L 96,32" fill="none" stroke="black"></path>
                <path d="M 272,32 L 360,32" fill="none" stroke="black"></path>
                <path d="M 384,32 L 512,32" fill="none" stroke="black"></path>
                <path d="M 8,64 L 96,64" fill="none" stroke="black"></path>
                <path d="M 272,64 L 360,64" fill="none" stroke="black"></path>
                <path d="M 384,64 L 512,64" fill="none" stroke="black"></path>
                <path d="M 48,192 L 96,192" fill="none" stroke="black"></path>
                <path d="M 264,192 L 312,192" fill="none" stroke="black"></path>
                <path d="M 56,256 L 96,256" fill="none" stroke="black"></path>
                <path d="M 248,256 L 320,256" fill="none" stroke="black"></path>
                <path d="M 48,320 L 64,320" fill="none" stroke="black"></path>
                <path d="M 400,320 L 416,320" fill="none" stroke="black"></path>
                <polygon class="arrowhead" fill="black" points="424,320 412,314.4 412,325.6" transform="rotate(0,416,320)"></polygon>
                <polygon class="arrowhead" fill="black" points="320,192 308,186.4 308,197.6" transform="rotate(0,312,192)"></polygon>
                <polygon class="arrowhead" fill="black" points="64,256 52,250.4 52,261.6" transform="rotate(180,56,256)"></polygon>
                <g class="text">
                  <text x="52" y="52">Attester</text>
                  <text x="316" y="52">Verifier</text>
                  <text x="424" y="52">Relying</text>
                  <text x="480" y="52">Party</text>
                  <text x="60" y="100">time(VG_a)</text>
                  <text x="48" y="116">|</text>
                  <text x="48" y="132">~</text>
                  <text x="320" y="132">~</text>
                  <text x="448" y="132">~</text>
                  <text x="48" y="148">|</text>
                  <text x="60" y="164">time(EG_a)</text>
                  <text x="180" y="196">Evidence{time(EG_a)}</text>
                  <text x="332" y="228">time(RG_v)</text>
                  <text x="144" y="260">Attestation</text>
                  <text x="220" y="260">Result</text>
                  <text x="192" y="276">{time(RG_v),time(RX_v)}</text>
                  <text x="48" y="292">~</text>
                  <text x="448" y="292">~</text>
                  <text x="448" y="308">|</text>
                  <text x="112" y="324">Attestation</text>
                  <text x="280" y="324">Result{time(RG_v),time(RX_v)}</text>
                  <text x="468" y="324">time(RA_r)</text>
                  <text x="448" y="340">|</text>
                  <text x="48" y="356">~</text>
                  <text x="448" y="356">~</text>
                  <text x="448" y="372">|</text>
                  <text x="460" y="388">time(OP_r)</text>
                </g>
              </svg><a class="pilcrow" href="#appendix-A.1-2.1.1">¶</a>
</div>
</div>
<figcaption><a class="selfRef" href="#figure-10">Figure 10</a>:
<a class="selfRef" href="#name-timestamp-based-passport-mo">Timestamp-Based Passport Model</a>
          </figcaption></figure>
</div>
<p id="appendix-A.1-3">The Verifier can check whether the Evidence is fresh when appraising
it at time(RG_v) by checking <code>time(RG_v) - time(EG_a) &lt; Threshold</code>, where the
Verifier's threshold is large enough to account for the maximum
permitted clock skew between the Verifier and the Attester.<a class="pilcrow" href="#appendix-A.1-3">¶</a></p>
<p id="appendix-A.1-4">If time(VG_a) is included in the Evidence along with the Claim value
generated at that time, and the Verifier decides that it can trust the
time(VG_a) value, the Verifier can also determine whether the Claim value is
recent by checking <code>time(RG_v) - time(VG_a) &lt; Threshold</code>.
The threshold is decided by the Appraisal Policy for Evidence and, again,  needs to take
into account the maximum permitted clock skew between
the Verifier and the Attester.<a class="pilcrow" href="#appendix-A.1-4">¶</a></p>
<p id="appendix-A.1-5">The Attester does not consume the Attestation Result but might cache it.<a class="pilcrow" href="#appendix-A.1-5">¶</a></p>
<p id="appendix-A.1-6">The Relying Party can check whether the Attestation Result is fresh
when appraising it at time(RA_r) by checking the <code>time(RA_r) - time(RG_v) &lt; Threshold</code>,
where the Relying Party's threshold is large enough to account for the
maximum permitted clock skew between the Relying Party and the Verifier.
The result might then be used for some time (e.g., throughout the lifetime
of a connection established at time(RA_r)).  However, the Relying Party must be
careful not to allow continued use beyond the period for which
it deems the Attestation Result to remain fresh enough.  Thus,
it might allow use (at time(OP_r)) as long as <code>time(OP_r) - time(RG_v) &lt; Threshold</code>.
However, if the Attestation Result contains an expiry time time(RX_v), then
it could explicitly check <code>time(OP_r) &lt; time(RX_v)</code>.<a class="pilcrow" href="#appendix-A.1-6">¶</a></p>
</section>
</div>
<div id="example-2-nonce-based-passport-model-example">
<section id="appendix-A.2">
        <h3 id="name-example-2-nonce-based-passp">
<a class="section-number selfRef" href="#appendix-A.2">A.2. </a><a class="section-name selfRef" href="#name-example-2-nonce-based-passp">Example 2: Nonce-Based Passport Model</a>
        </h3>
<p id="appendix-A.2-1"><a class="auto internal xref" href="#nonce-based-passport-model">Figure 11</a> illustrates a hypothetical Passport Model
solution that uses nonces instead of timestamps.  Compared to the
timestamp-based example, it requires an extra round trip
to retrieve a nonce and requires that the Verifier and Relying Party
track state to remember the nonce for some period of time.<a class="pilcrow" href="#appendix-A.2-1">¶</a></p>
<p id="appendix-A.2-2">The advantage is that it does not require that any clocks
are synchronized.
As a result, the receiver of a conceptual message containing a
timestamp cannot directly compare it to its own clock or timestamps.
Thus, we use a suffix ("a" for Attester, "v" for Verifier, and "r" for Relying Party) on the IDs below indicating which clock generated them since times from different clocks cannot be compared.
Only the delta between two events from the sender can be used by the receiver.<a class="pilcrow" href="#appendix-A.2-2">¶</a></p>
<span id="name-nonce-based-passport-model"></span><div id="nonce-based-passport-model">
<figure id="figure-11">
          <div id="appendix-A.2-3.1">
            <div class="alignLeft art-svg artwork" id="appendix-A.2-3.1.1">
<svg class="diagram" font-family="monospace" font-size="13px" height="544" text-anchor="middle" version="1.1" viewBox="0 0 536 544" width="536" xmlns="http://www.w3.org/2000/svg">
                <path d="M 8,32 L 8,64" fill="none" stroke="black"></path>
                <path d="M 48,64 L 48,80" fill="none" stroke="black"></path>
                <path d="M 48,144 L 48,176" fill="none" stroke="black"></path>
                <path d="M 48,208 L 48,320" fill="none" stroke="black"></path>
                <path d="M 48,352 L 48,384" fill="none" stroke="black"></path>
                <path d="M 48,416 L 48,464" fill="none" stroke="black"></path>
                <path d="M 48,496 L 48,512" fill="none" stroke="black"></path>
                <path d="M 96,32 L 96,64" fill="none" stroke="black"></path>
                <path d="M 272,32 L 272,64" fill="none" stroke="black"></path>
                <path d="M 320,64 L 320,112" fill="none" stroke="black"></path>
                <path d="M 320,176 L 320,256" fill="none" stroke="black"></path>
                <path d="M 320,288 L 320,320" fill="none" stroke="black"></path>
                <path d="M 360,32 L 360,64" fill="none" stroke="black"></path>
                <path d="M 384,32 L 384,64" fill="none" stroke="black"></path>
                <path d="M 448,64 L 448,112" fill="none" stroke="black"></path>
                <path d="M 448,144 L 448,320" fill="none" stroke="black"></path>
                <path d="M 448,384 L 448,464" fill="none" stroke="black"></path>
                <path d="M 512,32 L 512,64" fill="none" stroke="black"></path>
                <path d="M 8,32 L 96,32" fill="none" stroke="black"></path>
                <path d="M 272,32 L 360,32" fill="none" stroke="black"></path>
                <path d="M 384,32 L 512,32" fill="none" stroke="black"></path>
                <path d="M 8,64 L 96,64" fill="none" stroke="black"></path>
                <path d="M 272,64 L 360,64" fill="none" stroke="black"></path>
                <path d="M 384,64 L 512,64" fill="none" stroke="black"></path>
                <path d="M 56,160 L 72,160" fill="none" stroke="black"></path>
                <path d="M 128,160 L 288,160" fill="none" stroke="black"></path>
                <path d="M 48,224 L 72,224" fill="none" stroke="black"></path>
                <path d="M 144,224 L 312,224" fill="none" stroke="black"></path>
                <path d="M 56,304 L 72,304" fill="none" stroke="black"></path>
                <path d="M 224,304 L 320,304" fill="none" stroke="black"></path>
                <path d="M 56,368 L 72,368" fill="none" stroke="black"></path>
                <path d="M 128,368 L 416,368" fill="none" stroke="black"></path>
                <path d="M 48,432 L 64,432" fill="none" stroke="black"></path>
                <path d="M 424,432 L 440,432" fill="none" stroke="black"></path>
                <polygon class="arrowhead" fill="black" points="448,432 436,426.4 436,437.6" transform="rotate(0,440,432)"></polygon>
                <polygon class="arrowhead" fill="black" points="320,224 308,218.4 308,229.6" transform="rotate(0,312,224)"></polygon>
                <polygon class="arrowhead" fill="black" points="64,368 52,362.4 52,373.6" transform="rotate(180,56,368)"></polygon>
                <polygon class="arrowhead" fill="black" points="64,304 52,298.4 52,309.6" transform="rotate(180,56,304)"></polygon>
                <polygon class="arrowhead" fill="black" points="64,160 52,154.4 52,165.6" transform="rotate(180,56,160)"></polygon>
                <g class="text">
                  <text x="52" y="52">Attester</text>
                  <text x="316" y="52">Verifier</text>
                  <text x="424" y="52">Relying</text>
                  <text x="480" y="52">Party</text>
                  <text x="60" y="100">time(VG_a)</text>
                  <text x="48" y="116">|</text>
                  <text x="48" y="132">~</text>
                  <text x="320" y="132">~</text>
                  <text x="448" y="132">~</text>
                  <text x="320" y="148">|</text>
                  <text x="100" y="164">Nonce1</text>
                  <text x="332" y="164">time(NS_v)</text>
                  <text x="60" y="196">time(EG_a)</text>
                  <text x="108" y="228">Evidence</text>
                  <text x="92" y="244">{Nonce1,</text>
                  <text x="220" y="244">time(EG_a)-time(VG_a)}</text>
                  <text x="332" y="276">time(RG_v)</text>
                  <text x="120" y="308">Attestation</text>
                  <text x="196" y="308">Result</text>
                  <text x="168" y="324">{time(RX_v)-time(RG_v)}</text>
                  <text x="48" y="340">~</text>
                  <text x="448" y="340">~</text>
                  <text x="448" y="356">|</text>
                  <text x="100" y="372">Nonce2</text>
                  <text x="460" y="372">time(NS_r)</text>
                  <text x="60" y="404">time(RR_a)</text>
                  <text x="116" y="436">[Attestation</text>
                  <text x="292" y="436">Result{time(RX_v)-time(RG_v)},</text>
                  <text x="492" y="436">time(RA_r)</text>
                  <text x="144" y="452">Nonce2,</text>
                  <text x="268" y="452">time(RR_a)-time(EG_a)]</text>
                  <text x="48" y="484">~</text>
                  <text x="448" y="484">~</text>
                  <text x="448" y="500">|</text>
                  <text x="460" y="516">time(OP_r)</text>
                </g>
              </svg><a class="pilcrow" href="#appendix-A.2-3.1.1">¶</a>
</div>
</div>
<figcaption><a class="selfRef" href="#figure-11">Figure 11</a>:
<a class="selfRef" href="#name-nonce-based-passport-model">Nonce-Based Passport Model</a>
          </figcaption></figure>
</div>
<p id="appendix-A.2-4">In this example solution, the Verifier can check whether the Evidence is
fresh at <code>time(RG_v)</code> by verifying that <code>time(RG_v)-time(NS_v) &lt; Threshold</code>.<a class="pilcrow" href="#appendix-A.2-4">¶</a></p>
<p id="appendix-A.2-5">However, the Verifier cannot simply rely on a Nonce to
determine whether the value of a Claim is recent since the Claim value
might have been generated long before the nonce was sent by the Verifier.
Nevertheless, if the Verifier decides that the Attester can be trusted to
correctly provide the delta <code>time(EG_a)-time(VG_a)</code>, then it can determine recency
by checking <code>time(RG_v)-time(NS_v) + time(EG_a)-time(VG_a) &lt; Threshold</code>.<a class="pilcrow" href="#appendix-A.2-5">¶</a></p>
<p id="appendix-A.2-6">Similarly if, based on an Attestation Result from a Verifier it trusts, the
Relying Party decides that the Attester can be trusted to correctly provide
time deltas, then it can determine whether the Attestation Result is fresh by
checking <code>time(OP_r)-time(NS_r) + time(RR_a)-time(EG_a) &lt;
Threshold</code>.  Although the Nonce2 and <code>time(RR_a)-time(EG_a)</code> values
cannot be inside the Attestation Result, they might be signed by the Attester
such that the Attestation Result vouches for the Attester's signing
capability.<a class="pilcrow" href="#appendix-A.2-6">¶</a></p>
<p id="appendix-A.2-7">However, the Relying Party must still be careful not to allow continued
use beyond the period for which it deems the Attestation Result to remain
valid.  Thus, if the Attestation Result sends a validity lifetime
in terms of <code>time(RX_v)-time(RG_v)</code>, then the Relying Party can check
<code>time(OP_r)-time(NS_r) &lt; time(RX_v)-time(RG_v)</code>.<a class="pilcrow" href="#appendix-A.2-7">¶</a></p>
</section>
</div>
<div id="example-3-epoch-id-based-passport-model-example">
<section id="appendix-A.3">
        <h3 id="name-example-3-passport-model-ba">
<a class="section-number selfRef" href="#appendix-A.3">A.3. </a><a class="section-name selfRef" href="#name-example-3-passport-model-ba">Example 3: Passport Model Based on Epoch ID</a>
        </h3>
<p id="appendix-A.3-1">The example in <a class="auto internal xref" href="#fig-epochid-passport">Figure 12</a> illustrates a hypothetical Passport Model
solution that uses epoch IDs instead of nonces or timestamps.<a class="pilcrow" href="#appendix-A.3-1">¶</a></p>
<p id="appendix-A.3-2">The epoch ID distributor broadcasts epoch ID <code>I</code>, which starts a new
epoch <code>E</code> for a protocol participant upon reception at <code>time(IR)</code>.<a class="pilcrow" href="#appendix-A.3-2">¶</a></p>
<p id="appendix-A.3-3">The Attester generates Evidence incorporating epoch ID <code>I</code> and conveys it to the
 Verifier.<a class="pilcrow" href="#appendix-A.3-3">¶</a></p>
<p id="appendix-A.3-4">The Verifier appraises that the received epoch ID <code>I</code> is "fresh" according to the
definition provided in <a class="auto internal xref" href="#epochfreshness">Section 10.3</a> whereby retries are required in the case of mismatching epoch IDs; then the Verifier generates an Attestation Result.  The
Attestation Result is conveyed to the Attester.<a class="pilcrow" href="#appendix-A.3-4">¶</a></p>
<p id="appendix-A.3-5">After the transmission of epoch ID <code>I'</code> a new epoch <code>E'</code> is
established when <code>I'</code> is received by each protocol participant.  The Attester
relays the Attestation Result obtained during epoch <code>E</code> (associated with epoch ID
<code>I</code>) to the Relying Party using the epoch ID for the current epoch <code>I'</code>.
If the Relying Party had not yet received <code>I'</code>, then the Attestation Result would be rejected. The Attestation Result is received in this example.<a class="pilcrow" href="#appendix-A.3-5">¶</a></p>
<p id="appendix-A.3-6">In <a class="auto internal xref" href="#fig-epochid-passport">Figure 12</a>, the epoch ID for relaying an Attestation Result to the Relying Party is current while a previous epoch ID was used to generate Verifier evaluated Evidence.
This indicates that at least one epoch transition has occurred and the Attestation Results may only be as fresh as the previous epoch.
If the Relying Party remembers the previous epoch ID <code>I</code> during an epoch window
as discussed in <a class="auto internal xref" href="#epochfreshness">Section 10.3</a>, and the message is received during
that window, the Attestation Result is accepted as fresh; otherwise, it is
rejected as stale.<a class="pilcrow" href="#appendix-A.3-6">¶</a></p>
<span id="name-epoch-id-based-passport-mod"></span><div id="fig-epochid-passport">
<figure id="figure-12">
          <div id="appendix-A.3-7.1">
            <div class="alignLeft art-svg artwork" id="appendix-A.3-7.1.1">
<svg class="diagram" font-family="monospace" font-size="13px" height="512" text-anchor="middle" version="1.1" viewBox="0 0 520 512" width="520" xmlns="http://www.w3.org/2000/svg">
                <path d="M 8,48 L 8,80" fill="none" stroke="black"></path>
                <path d="M 48,80 L 48,96" fill="none" stroke="black"></path>
                <path d="M 48,224 L 48,352" fill="none" stroke="black"></path>
                <path d="M 48,384 L 48,432" fill="none" stroke="black"></path>
                <path d="M 48,464 L 48,480" fill="none" stroke="black"></path>
                <path d="M 96,48 L 96,80" fill="none" stroke="black"></path>
                <path d="M 128,32 L 128,80" fill="none" stroke="black"></path>
                <path d="M 184,80 L 184,232" fill="none" stroke="black"></path>
                <path d="M 184,264 L 184,304" fill="none" stroke="black"></path>
                <path d="M 184,344 L 184,368" fill="none" stroke="black"></path>
                <path d="M 240,32 L 240,80" fill="none" stroke="black"></path>
                <path d="M 272,48 L 272,80" fill="none" stroke="black"></path>
                <path d="M 320,80 L 320,128" fill="none" stroke="black"></path>
                <path d="M 320,192 L 320,272" fill="none" stroke="black"></path>
                <path d="M 320,304 L 320,352" fill="none" stroke="black"></path>
                <path d="M 320,408 L 320,432" fill="none" stroke="black"></path>
                <path d="M 320,464 L 320,480" fill="none" stroke="black"></path>
                <path d="M 360,48 L 360,80" fill="none" stroke="black"></path>
                <path d="M 384,48 L 384,80" fill="none" stroke="black"></path>
                <path d="M 448,80 L 448,128" fill="none" stroke="black"></path>
                <path d="M 448,192 L 448,352" fill="none" stroke="black"></path>
                <path d="M 448,416 L 448,432" fill="none" stroke="black"></path>
                <path d="M 512,48 L 512,80" fill="none" stroke="black"></path>
                <path d="M 128,32 L 240,32" fill="none" stroke="black"></path>
                <path d="M 8,48 L 96,48" fill="none" stroke="black"></path>
                <path d="M 272,48 L 360,48" fill="none" stroke="black"></path>
                <path d="M 384,48 L 512,48" fill="none" stroke="black"></path>
                <path d="M 8,80 L 96,80" fill="none" stroke="black"></path>
                <path d="M 128,80 L 240,80" fill="none" stroke="black"></path>
                <path d="M 272,80 L 360,80" fill="none" stroke="black"></path>
                <path d="M 384,80 L 512,80" fill="none" stroke="black"></path>
                <path d="M 112,176 L 152,176" fill="none" stroke="black"></path>
                <path d="M 168,176 L 176,176" fill="none" stroke="black"></path>
                <path d="M 192,176 L 200,176" fill="none" stroke="black"></path>
                <path d="M 216,176 L 264,176" fill="none" stroke="black"></path>
                <path d="M 368,176 L 392,176" fill="none" stroke="black"></path>
                <path d="M 48,240 L 72,240" fill="none" stroke="black"></path>
                <path d="M 144,240 L 312,240" fill="none" stroke="black"></path>
                <path d="M 56,320 L 72,320" fill="none" stroke="black"></path>
                <path d="M 224,320 L 320,320" fill="none" stroke="black"></path>
                <path d="M 120,368 L 152,368" fill="none" stroke="black"></path>
                <path d="M 192,368 L 200,368" fill="none" stroke="black"></path>
                <path d="M 232,368 L 264,368" fill="none" stroke="black"></path>
                <path d="M 376,368 L 392,368" fill="none" stroke="black"></path>
                <path d="M 48,400 L 72,400" fill="none" stroke="black"></path>
                <path d="M 232,400 L 392,400" fill="none" stroke="black"></path>
                <polygon class="arrowhead" fill="black" points="400,400 388,394.4 388,405.6" transform="rotate(0,392,400)"></polygon>
                <polygon class="arrowhead" fill="black" points="400,368 388,362.4 388,373.6" transform="rotate(0,392,368)"></polygon>
                <polygon class="arrowhead" fill="black" points="400,176 388,170.4 388,181.6" transform="rotate(0,392,176)"></polygon>
                <polygon class="arrowhead" fill="black" points="320,240 308,234.4 308,245.6" transform="rotate(0,312,240)"></polygon>
                <polygon class="arrowhead" fill="black" points="272,368 260,362.4 260,373.6" transform="rotate(0,264,368)"></polygon>
                <polygon class="arrowhead" fill="black" points="272,176 260,170.4 260,181.6" transform="rotate(0,264,176)"></polygon>
                <polygon class="arrowhead" fill="black" points="128,368 116,362.4 116,373.6" transform="rotate(180,120,368)"></polygon>
                <polygon class="arrowhead" fill="black" points="120,176 108,170.4 108,181.6" transform="rotate(180,112,176)"></polygon>
                <polygon class="arrowhead" fill="black" points="64,320 52,314.4 52,325.6" transform="rotate(180,56,320)"></polygon>
                <circle class="opendot" cx="184" cy="176" fill="white" r="6" stroke="black"></circle>
                <circle class="opendot" cx="184" cy="368" fill="white" r="6" stroke="black"></circle>
                <g class="text">
                  <text x="160" y="52">Epoch</text>
                  <text x="196" y="52">ID</text>
                  <text x="52" y="68">Attester</text>
                  <text x="184" y="68">Distributor</text>
                  <text x="316" y="68">Verifier</text>
                  <text x="424" y="68">Relying</text>
                  <text x="480" y="68">Party</text>
                  <text x="60" y="116">time(VG_a)</text>
                  <text x="48" y="132">|</text>
                  <text x="48" y="148">~</text>
                  <text x="320" y="148">~</text>
                  <text x="448" y="148">~</text>
                  <text x="48" y="164">|</text>
                  <text x="320" y="164">|</text>
                  <text x="448" y="164">|</text>
                  <text x="60" y="180">time(IR_a)</text>
                  <text x="160" y="180">I</text>
                  <text x="208" y="180">I</text>
                  <text x="316" y="180">time(IR_v)</text>
                  <text x="444" y="180">time(IR_r)</text>
                  <text x="48" y="196">|</text>
                  <text x="60" y="212">time(EG_a)</text>
                  <text x="108" y="244">Evidence</text>
                  <text x="176" y="260">{I,time(EG_a)-time(VG_a)}</text>
                  <text x="316" y="292">time(RG_v)</text>
                  <text x="120" y="324">Attestation</text>
                  <text x="196" y="324">Result</text>
                  <text x="176" y="340">{I,time(RX_v)-time(RG_v)}</text>
                  <text x="64" y="372">time(IR'_a)</text>
                  <text x="168" y="372">I'-</text>
                  <text x="212" y="372">I'</text>
                  <text x="320" y="372">time(IR'_v)</text>
                  <text x="448" y="372">time(IR'_r)</text>
                  <text x="320" y="388">|</text>
                  <text x="448" y="388">|</text>
                  <text x="124" y="404">[Attestation</text>
                  <text x="204" y="404">Result</text>
                  <text x="444" y="404">time(RA_r)</text>
                  <text x="192" y="420">{I,time(RX_v)-time(RG_v)},I']</text>
                  <text x="48" y="452">~</text>
                  <text x="320" y="452">~</text>
                  <text x="448" y="452">~</text>
                  <text x="448" y="468">|</text>
                  <text x="444" y="484">time(OP_r)</text>
                </g>
              </svg><a class="pilcrow" href="#appendix-A.3-7.1.1">¶</a>
</div>
</div>
<figcaption><a class="selfRef" href="#figure-12">Figure 12</a>:
<a class="selfRef" href="#name-epoch-id-based-passport-mod">Epoch ID-Based Passport Model</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="example-4-timestamp-based-background-check-model-example">
<section id="appendix-A.4">
        <h3 id="name-example-4-timestamp-based-b">
<a class="section-number selfRef" href="#appendix-A.4">A.4. </a><a class="section-name selfRef" href="#name-example-4-timestamp-based-b">Example 4: Timestamp-Based Background-Check Model</a>
        </h3>
<p id="appendix-A.4-1"><a class="auto internal xref" href="#timestamp-based-bg-check-model">Figure 13</a> illustrates a hypothetical Background-Check Model
solution that uses timestamps and requires roughly synchronized
clocks between the Attester, Verifier, and Relying Party.
The Attester conveys Evidence to the Relying Party, which treats it as opaque and simply forwards it on to the Verifier.<a class="pilcrow" href="#appendix-A.4-1">¶</a></p>
<span id="name-timestamp-based-background-"></span><div id="timestamp-based-bg-check-model">
<figure id="figure-13">
          <div id="appendix-A.4-2.1">
            <div class="alignLeft art-svg artwork" id="appendix-A.4-2.1.1">
<svg class="diagram" font-family="monospace" font-size="13px" height="368" text-anchor="middle" version="1.1" viewBox="0 0 568 368" width="568" xmlns="http://www.w3.org/2000/svg">
                <path d="M 8,32 L 8,64" fill="none" stroke="black"></path>
                <path d="M 72,64 L 72,80" fill="none" stroke="black"></path>
                <path d="M 72,104 L 72,112" fill="none" stroke="black"></path>
                <path d="M 72,168 L 72,304" fill="none" stroke="black"></path>
                <path d="M 72,336 L 72,352" fill="none" stroke="black"></path>
                <path d="M 96,32 L 96,64" fill="none" stroke="black"></path>
                <path d="M 176,32 L 176,64" fill="none" stroke="black"></path>
                <path d="M 240,64 L 240,112" fill="none" stroke="black"></path>
                <path d="M 240,144 L 240,208" fill="none" stroke="black"></path>
                <path d="M 240,240 L 240,272" fill="none" stroke="black"></path>
                <path d="M 304,32 L 304,64" fill="none" stroke="black"></path>
                <path d="M 472,32 L 472,64" fill="none" stroke="black"></path>
                <path d="M 512,64 L 512,112" fill="none" stroke="black"></path>
                <path d="M 512,144 L 512,240" fill="none" stroke="black"></path>
                <path d="M 512,272 L 512,304" fill="none" stroke="black"></path>
                <path d="M 512,336 L 512,352" fill="none" stroke="black"></path>
                <path d="M 560,32 L 560,64" fill="none" stroke="black"></path>
                <path d="M 8,32 L 96,32" fill="none" stroke="black"></path>
                <path d="M 176,32 L 304,32" fill="none" stroke="black"></path>
                <path d="M 472,32 L 560,32" fill="none" stroke="black"></path>
                <path d="M 8,64 L 96,64" fill="none" stroke="black"></path>
                <path d="M 176,64 L 304,64" fill="none" stroke="black"></path>
                <path d="M 472,64 L 560,64" fill="none" stroke="black"></path>
                <path d="M 72,192 L 104,192" fill="none" stroke="black"></path>
                <path d="M 176,192 L 232,192" fill="none" stroke="black"></path>
                <path d="M 288,224 L 304,224" fill="none" stroke="black"></path>
                <path d="M 472,224 L 504,224" fill="none" stroke="black"></path>
                <path d="M 288,288 L 312,288" fill="none" stroke="black"></path>
                <path d="M 464,288 L 512,288" fill="none" stroke="black"></path>
                <polygon class="arrowhead" fill="black" points="512,224 500,218.4 500,229.6" transform="rotate(0,504,224)"></polygon>
                <polygon class="arrowhead" fill="black" points="296,288 284,282.4 284,293.6" transform="rotate(180,288,288)"></polygon>
                <polygon class="arrowhead" fill="black" points="240,192 228,186.4 228,197.6" transform="rotate(0,232,192)"></polygon>
                <g class="text">
                  <text x="52" y="52">Attester</text>
                  <text x="216" y="52">Relying</text>
                  <text x="272" y="52">Party</text>
                  <text x="516" y="52">Verifier</text>
                  <text x="60" y="100">time(VG_a)</text>
                  <text x="72" y="132">~</text>
                  <text x="240" y="132">~</text>
                  <text x="512" y="132">~</text>
                  <text x="72" y="148">|</text>
                  <text x="60" y="164">time(EG_a)</text>
                  <text x="140" y="196">Evidence</text>
                  <text x="148" y="212">{time(EG_a)}</text>
                  <text x="236" y="228">time(ER_r)</text>
                  <text x="388" y="228">Evidence{time(EG_a)}</text>
                  <text x="508" y="260">time(RG_v)</text>
                  <text x="236" y="292">time(RA_r)</text>
                  <text x="360" y="292">Attestation</text>
                  <text x="436" y="292">Result</text>
                  <text x="240" y="308">|</text>
                  <text x="380" y="308">{time(RX_v)}</text>
                  <text x="72" y="324">~</text>
                  <text x="240" y="324">~</text>
                  <text x="512" y="324">~</text>
                  <text x="240" y="340">|</text>
                  <text x="252" y="356">time(OP_r)</text>
                </g>
              </svg><a class="pilcrow" href="#appendix-A.4-2.1.1">¶</a>
</div>
</div>
<figcaption><a class="selfRef" href="#figure-13">Figure 13</a>:
<a class="selfRef" href="#name-timestamp-based-background-">Timestamp-Based Background-Check Model</a>
          </figcaption></figure>
</div>
<p id="appendix-A.4-3">The time considerations in this example are equivalent to those
discussed under <a class="internal xref" href="#example-1-timestamp-based-passport-model-example">Example 1</a>.<a class="pilcrow" href="#appendix-A.4-3">¶</a></p>
</section>
</div>
<div id="example-5-nonce-based-background-check-model-example">
<section id="appendix-A.5">
        <h3 id="name-example-5-nonce-based-backg">
<a class="section-number selfRef" href="#appendix-A.5">A.5. </a><a class="section-name selfRef" href="#name-example-5-nonce-based-backg">Example 5: Nonce-Based Background-Check Model</a>
        </h3>
<p id="appendix-A.5-1"><a class="auto internal xref" href="#nonce-based-bg-check-model">Figure 14</a> illustrates a hypothetical Background-Check Model
solution that uses nonces; thus, it does not require that any clocks
be synchronized.
In this example solution, a nonce is generated by a Verifier at the request of a Relying Party when the Relying Party needs to send one to an Attester.<a class="pilcrow" href="#appendix-A.5-1">¶</a></p>
<span id="name-nonce-based-background-chec"></span><div id="nonce-based-bg-check-model">
<figure id="figure-14">
          <div id="appendix-A.5-2.1">
            <div class="alignLeft art-svg artwork" id="appendix-A.5-2.1.1">
<svg class="diagram" font-family="monospace" font-size="13px" height="432" text-anchor="middle" version="1.1" viewBox="0 0 536 432" width="536" xmlns="http://www.w3.org/2000/svg">
                <path d="M 8,32 L 8,64" fill="none" stroke="black"></path>
                <path d="M 48,64 L 48,80" fill="none" stroke="black"></path>
                <path d="M 48,144 L 48,208" fill="none" stroke="black"></path>
                <path d="M 48,240 L 48,368" fill="none" stroke="black"></path>
                <path d="M 48,400 L 48,416" fill="none" stroke="black"></path>
                <path d="M 96,32 L 96,64" fill="none" stroke="black"></path>
                <path d="M 176,32 L 176,64" fill="none" stroke="black"></path>
                <path d="M 240,64 L 240,112" fill="none" stroke="black"></path>
                <path d="M 240,144 L 240,176" fill="none" stroke="black"></path>
                <path d="M 240,208 L 240,272" fill="none" stroke="black"></path>
                <path d="M 240,304 L 240,336" fill="none" stroke="black"></path>
                <path d="M 304,32 L 304,64" fill="none" stroke="black"></path>
                <path d="M 440,32 L 440,64" fill="none" stroke="black"></path>
                <path d="M 480,64 L 480,112" fill="none" stroke="black"></path>
                <path d="M 480,176 L 480,304" fill="none" stroke="black"></path>
                <path d="M 480,336 L 480,368" fill="none" stroke="black"></path>
                <path d="M 480,400 L 480,416" fill="none" stroke="black"></path>
                <path d="M 528,32 L 528,64" fill="none" stroke="black"></path>
                <path d="M 8,32 L 96,32" fill="none" stroke="black"></path>
                <path d="M 176,32 L 304,32" fill="none" stroke="black"></path>
                <path d="M 440,32 L 528,32" fill="none" stroke="black"></path>
                <path d="M 8,64 L 96,64" fill="none" stroke="black"></path>
                <path d="M 176,64 L 304,64" fill="none" stroke="black"></path>
                <path d="M 440,64 L 528,64" fill="none" stroke="black"></path>
                <path d="M 248,160 L 304,160" fill="none" stroke="black"></path>
                <path d="M 352,160 L 432,160" fill="none" stroke="black"></path>
                <path d="M 56,192 L 80,192" fill="none" stroke="black"></path>
                <path d="M 128,192 L 208,192" fill="none" stroke="black"></path>
                <path d="M 48,256 L 80,256" fill="none" stroke="black"></path>
                <path d="M 208,256 L 232,256" fill="none" stroke="black"></path>
                <path d="M 304,288 L 320,288" fill="none" stroke="black"></path>
                <path d="M 448,288 L 472,288" fill="none" stroke="black"></path>
                <path d="M 288,352 L 312,352" fill="none" stroke="black"></path>
                <path d="M 464,352 L 480,352" fill="none" stroke="black"></path>
                <polygon class="arrowhead" fill="black" points="480,288 468,282.4 468,293.6" transform="rotate(0,472,288)"></polygon>
                <polygon class="arrowhead" fill="black" points="296,352 284,346.4 284,357.6" transform="rotate(180,288,352)"></polygon>
                <polygon class="arrowhead" fill="black" points="256,160 244,154.4 244,165.6" transform="rotate(180,248,160)"></polygon>
                <polygon class="arrowhead" fill="black" points="240,256 228,250.4 228,261.6" transform="rotate(0,232,256)"></polygon>
                <polygon class="arrowhead" fill="black" points="64,192 52,186.4 52,197.6" transform="rotate(180,56,192)"></polygon>
                <g class="text">
                  <text x="52" y="52">Attester</text>
                  <text x="216" y="52">Relying</text>
                  <text x="272" y="52">Party</text>
                  <text x="484" y="52">Verifier</text>
                  <text x="60" y="100">time(VG_a)</text>
                  <text x="48" y="116">|</text>
                  <text x="48" y="132">~</text>
                  <text x="240" y="132">~</text>
                  <text x="480" y="132">~</text>
                  <text x="480" y="148">|</text>
                  <text x="328" y="164">Nonce</text>
                  <text x="476" y="164">time(NS_v)</text>
                  <text x="104" y="196">Nonce</text>
                  <text x="252" y="196">time(NR_r)</text>
                  <text x="60" y="228">time(EG_a)</text>
                  <text x="144" y="260">Evidence{Nonce}</text>
                  <text x="252" y="292">time(ER_r)</text>
                  <text x="384" y="292">Evidence{Nonce}</text>
                  <text x="492" y="324">time(RG_v)</text>
                  <text x="240" y="356">time(RA_r)</text>
                  <text x="360" y="356">Attestation</text>
                  <text x="436" y="356">Result</text>
                  <text x="240" y="372">|</text>
                  <text x="368" y="372">{time(RX_v)-time(RG_v)}</text>
                  <text x="48" y="388">~</text>
                  <text x="240" y="388">~</text>
                  <text x="480" y="388">~</text>
                  <text x="240" y="404">|</text>
                  <text x="252" y="420">time(OP_r)</text>
                </g>
              </svg><a class="pilcrow" href="#appendix-A.5-2.1.1">¶</a>
</div>
</div>
<figcaption><a class="selfRef" href="#figure-14">Figure 14</a>:
<a class="selfRef" href="#name-nonce-based-background-chec">Nonce-Based Background-Check Model</a>
          </figcaption></figure>
</div>
<p id="appendix-A.5-3">The Verifier can check whether the Evidence is fresh and a Claim
value is recent, which is the same as <a class="internal xref" href="#example-2-nonce-based-passport-model-example">Example 2</a>.<a class="pilcrow" href="#appendix-A.5-3">¶</a></p>
<p id="appendix-A.5-4">However, unlike in  <a class="internal xref" href="#example-2-nonce-based-passport-model-example">Example 2</a>, the Relying
        Party can use the Nonce to determine whether the Attestation Result is
        fresh by verifying that <code>time(OP_r)-time(NR_r) &lt;
        Threshold</code>.<a class="pilcrow" href="#appendix-A.5-4">¶</a></p>
<p id="appendix-A.5-5">However, the Relying Party must still be careful not to allow continued
use beyond the period for which it deems the Attestation Result to remain
valid.  Thus, if the Attestation Result sends a validity lifetime
in terms of <code>time(RX_v)-time(RG_v)</code>, then the Relying Party can check
<code>time(OP_r)-time(ER_r) &lt; time(RX_v)-time(RG_v)</code>.<a class="pilcrow" href="#appendix-A.5-5">¶</a></p>
</section>
</div>
</section>
</div>
<section id="appendix-B">
      <h2 id="name-acknowledgments">
<a class="section-name selfRef" href="#name-acknowledgments">Acknowledgments</a>
      </h2>
<p id="appendix-B-1">The authors would like to thank the following people for their input:<a class="pilcrow" href="#appendix-B-1">¶</a></p>
<p id="appendix-B-2"><span class="contact-name">Joerg Borchert</span>, <span class="contact-name">Carsten Bormann</span>, <span class="contact-name">Nancy Cam-Winget</span>, <span class="contact-name">Guy Fedorkow</span>, <span class="contact-name">Jessica Fitzgerald-McKay</span>, <span class="contact-name">Thomas Fossati</span>, <span class="contact-name">Simon Frost</span>, <span class="contact-name">Andrew Guinn</span>, <span class="contact-name">Thomas Hardjano</span>, <span class="contact-name">Eliot Lear</span>, <span class="contact-name">Diego Lopez</span>, <span class="contact-name">Peter Loscocco</span>, <span class="contact-name">Laurence Lundblade</span>, <span class="contact-name">Giri Mandyam</span>, <span class="contact-name">Daniel Migault</span>, <span class="contact-name">Kathleen Moriarty</span>, <span class="contact-name">Paul Rowe</span>, <span class="contact-name">Hannes Tschofenig</span>, <span class="contact-name">Eric Voit</span>, <span class="contact-name">Monty Wiseman</span>, <span class="contact-name">David Wooten</span>, and <span class="contact-name">Liang Xia</span>.<a class="pilcrow" href="#appendix-B-2">¶</a></p>
</section>
<div id="contributors">
<section id="appendix-C">
      <h2 id="name-contributors">
<a class="section-name selfRef" href="#name-contributors">Contributors</a>
      </h2>
<p id="appendix-C-1"><span class="contact-name">Thomas Hardjono</span> created initial versions of the
     terminology section in collaboration with <span class="contact-name">Ned      Smith</span>. <span class="contact-name">Eric Voit</span> provided the conceptual
     separation between Attestation Provision Flows and Attestation Evidence
     Flows.
     <span class="contact-name">Monty Wisemen</span> was a key author of a document that was merged to create
     this document.
     <span class="contact-name">Carsten Bormann</span> provided many of the motivational building
     blocks with respect to the Internet Threat Model.<a class="pilcrow" href="#appendix-C-1">¶</a></p>
<p id="appendix-C-2"><span class="contact-name">Peter Loscocco</span> contributed critical review
     feedback as part of the weekly design team meetings that added precision
     and depth to several sections.<a class="pilcrow" href="#appendix-C-2">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-D">
      <h2 id="name-authors-addresses">
<a class="section-name selfRef" href="#name-authors-addresses">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Henk Birkholz</span></div>
<div class="left" dir="auto"><span class="org">Fraunhofer SIT</span></div>
<div class="left" dir="auto"><span class="street-address">Rheinstrasse 75</span></div>
<div class="left" dir="auto">
<span class="postal-code">64295</span> <span class="locality">Darmstadt</span>
</div>
<div class="left" dir="auto"><span class="country-name">Germany</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:henk.birkholz@sit.fraunhofer.de">henk.birkholz@sit.fraunhofer.de</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Dave Thaler</span></div>
<div class="left" dir="auto"><span class="org">Microsoft</span></div>
<div class="left" dir="auto"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:dthaler@microsoft.com">dthaler@microsoft.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Michael Richardson</span></div>
<div class="left" dir="auto"><span class="org">Sandelman Software Works</span></div>
<div class="left" dir="auto"><span class="country-name">Canada</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:mcr+ietf@sandelman.ca">mcr+ietf@sandelman.ca</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Ned Smith</span></div>
<div class="left" dir="auto"><span class="org">Intel Corporation</span></div>
<div class="left" dir="auto"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:ned.smith@intel.com">ned.smith@intel.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Wei Pan</span></div>
<div class="left" dir="auto"><span class="org">Huawei Technologies</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:william.panwei@huawei.com">william.panwei@huawei.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>


</body></html>