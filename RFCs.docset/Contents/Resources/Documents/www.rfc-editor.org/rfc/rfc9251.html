<!DOCTYPE html>
<html class="RFC" lang="en"><head>
<meta charset="utf-8"/>
<meta content="Common,Latin" name="scripts"/>
<meta content="initial-scale=1.0" name="viewport"/>
<title>RFC 9251: Internet Group Management Protocol (IGMP) and Multicast Listener Discovery (MLD) Proxies for Ethernet VPN (EVPN)</title>
<meta content="Ali Sajassi" name="author"/>
<meta content="Samir Thoria" name="author"/>
<meta content="Mankamana Mishra" name="author"/>
<meta content="Keyur Patel" name="author"/>
<meta content="John Drake" name="author"/>
<meta content="Wen Lin" name="author"/>
<meta content="
       This document describes how to support endpoints running
      the Internet Group Management Protocol (IGMP) or Multicast Listener Discovery (MLD) efficiently
      for the multicast services over an Ethernet VPN (EVPN) network by incorporating
      IGMP/MLD Proxy procedures on EVPN Provider Edges (PEs).
       
    " name="description"/>
<meta content="xml2rfc 3.12.10" name="generator"/>
<meta content="9251" name="rfc.number"/>
<!-- Generator version information:
  xml2rfc 3.12.10
    Python 3.6.15
    appdirs 1.4.4
    ConfigArgParse 1.4.1
    google-i18n-address 2.4.0
    html5lib 1.0.1
    intervaltree 3.0.2
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.7.1
    MarkupSafe 2.0.1
    pycairo 1.15.1
    pycountry 19.8.18
    pyflakes 2.1.1
    PyYAML 5.4.1
    requests 2.24.0
    setuptools 40.5.0
    six 1.14.0
    WeasyPrint 52.5
-->
<link href="rfc9251.xml" rel="alternate" type="application/rfc+xml"/>
<link href="#copyright" rel="license"/>
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  pre.breakable {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css"/>
<link href="https://dx.doi.org/10.17487/rfc9251" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <link href="https://datatracker.ietf.org/doc/draft-ietf-bess-evpn-igmp-mld-proxy-21" rel="prev"/>
  </head>
<body>
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 9251</td>
<td class="center">IGMP and MLD Proxies for EVPN</td>
<td class="right">June 2022</td>
</tr></thead>
<tfoot><tr>
<td class="left">Sajassi, et al.</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div class="document-information" id="external-metadata"></div>
<div class="document-information" id="internal-metadata">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a class="eref" href="https://www.rfc-editor.org/rfc/rfc9251">9251</a></dd>
<dt class="label-category">Category:</dt>
<dd class="category">Standards Track</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time class="published" datetime="2022-06">June 2022</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">A. Sajassi</div>
<div class="org">Cisco Systems</div>
</div>
<div class="author">
      <div class="author-name">S. Thoria</div>
<div class="org">Cisco Systems</div>
</div>
<div class="author">
      <div class="author-name">M. Mishra</div>
<div class="org">Cisco Systems</div>
</div>
<div class="author">
      <div class="author-name">K. Patel</div>
<div class="org">Arrcus</div>
</div>
<div class="author">
      <div class="author-name">J. Drake</div>
<div class="org">Juniper Networks</div>
</div>
<div class="author">
      <div class="author-name">W. Lin</div>
<div class="org">Juniper Networks</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 9251</h1>
<h1 id="title">Internet Group Management Protocol (IGMP) and Multicast Listener Discovery (MLD) Proxies for Ethernet VPN (EVPN)</h1>
<section id="section-abstract">
      <h2 id="abstract"><a class="selfRef" href="#abstract">Abstract</a></h2>
<p id="section-abstract-1">This document describes how to support endpoints running
      the Internet Group Management Protocol (IGMP) or Multicast Listener Discovery (MLD) efficiently
      for the multicast services over an Ethernet VPN (EVPN) network by incorporating
      IGMP/MLD Proxy procedures on EVPN Provider Edges (PEs).<a class="pilcrow" href="#section-abstract-1">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a class="section-name selfRef" href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This is an Internet Standards Track document.<a class="pilcrow" href="#section-boilerplate.1-1">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.<a class="pilcrow" href="#section-boilerplate.1-2">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc9251">https://www.rfc-editor.org/info/rfc9251</a></span>.<a class="pilcrow" href="#section-boilerplate.1-3">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a class="section-name selfRef" href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2022 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a class="pilcrow" href="#section-boilerplate.2-1">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a class="pilcrow" href="#section-boilerplate.2-2">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a class="toplink" href="#" onclick="scroll(0,0)">▲</a><h2 id="name-table-of-contents">
<a class="section-name selfRef" href="#name-table-of-contents">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p class="keepWithNext" id="section-toc.1-1.1.1"><a class="xref" href="#section-1">1</a>.  <a class="xref" href="#name-introduction">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p class="keepWithNext" id="section-toc.1-1.2.1"><a class="xref" href="#section-2">2</a>.  <a class="xref" href="#name-specification-of-requiremen">Specification of Requirements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p class="keepWithNext" id="section-toc.1-1.3.1"><a class="xref" href="#section-3">3</a>.  <a class="xref" href="#name-terminology">Terminology</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a class="xref" href="#section-4">4</a>.  <a class="xref" href="#name-igmp-mld-proxy">IGMP/MLD Proxy</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a class="xref" href="#section-4.1">4.1</a>.  <a class="xref" href="#name-proxy-reporting">Proxy Reporting</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.1">
                    <p id="section-toc.1-1.4.2.1.2.1.1"><a class="xref" href="#section-4.1.1">4.1.1</a>.  <a class="xref" href="#name-igmp-mld-membership-report-">IGMP/MLD Membership Report Advertisement in BGP</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.2">
                    <p id="section-toc.1-1.4.2.1.2.2.1"><a class="xref" href="#section-4.1.2">4.1.2</a>.  <a class="xref" href="#name-igmp-mld-leave-group-advert">IGMP/MLD Leave Group Advertisement in BGP</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a class="xref" href="#section-4.2">4.2</a>.  <a class="xref" href="#name-proxy-querier">Proxy Querier</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a class="xref" href="#section-5">5</a>.  <a class="xref" href="#name-operation">Operation</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a class="xref" href="#section-5.1">5.1</a>.  <a class="xref" href="#name-pe-with-only-attached-hosts">PE with Only Attached Hosts for a Given Subnet</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a class="xref" href="#section-5.2">5.2</a>.  <a class="xref" href="#name-pe-with-a-mix-of-attached-h">PE with a Mix of Attached Hosts and a Multicast Source</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a class="xref" href="#section-5.3">5.3</a>.  <a class="xref" href="#name-pe-with-a-mix-of-attached-ho">PE with a Mix of Attached Hosts, a Multicast Source, and a Router</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a class="xref" href="#section-6">6</a>.  <a class="xref" href="#name-all-active-multihoming">All-Active Multihoming</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a class="xref" href="#section-6.1">6.1</a>.  <a class="xref" href="#name-local-igmp-mld-membership-r">Local IGMP/MLD Membership Report Synchronization</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a class="xref" href="#section-6.2">6.2</a>.  <a class="xref" href="#name-local-igmp-mld-leave-group-">Local IGMP/MLD Leave Group Synchronization</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.1">
                    <p id="section-toc.1-1.6.2.2.2.1.1"><a class="xref" href="#section-6.2.1">6.2.1</a>.  <a class="xref" href="#name-remote-leave-group-synchron">Remote Leave Group Synchronization</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.2">
                    <p id="section-toc.1-1.6.2.2.2.2.1"><a class="xref" href="#section-6.2.2">6.2.2</a>.  <a class="xref" href="#name-common-leave-group-synchron">Common Leave Group Synchronization</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a class="xref" href="#section-6.3">6.3</a>.  <a class="xref" href="#name-mass-withdraw-of-the-multic">Mass Withdraw of the Multicast Membership Report Synch Route in Case of Failure</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a class="xref" href="#section-7">7</a>.  <a class="xref" href="#name-single-active-multihoming">Single-Active Multihoming</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a class="xref" href="#section-8">8</a>.  <a class="xref" href="#name-selective-multicast-procedu">Selective Multicast Procedures for IR Tunnels</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a class="xref" href="#section-9">9</a>.  <a class="xref" href="#name-bgp-encoding">BGP Encoding</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a class="xref" href="#section-9.1">9.1</a>.  <a class="xref" href="#name-selective-multicast-etherne">Selective Multicast Ethernet Tag Route</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1.2.1">
                    <p id="section-toc.1-1.9.2.1.2.1.1"><a class="xref" href="#section-9.1.1">9.1.1</a>.  <a class="xref" href="#name-constructing-the-selective-">Constructing the Selective Multicast Ethernet Tag Route</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1.2.2">
                    <p id="section-toc.1-1.9.2.1.2.2.1"><a class="xref" href="#section-9.1.2">9.1.2</a>.  <a class="xref" href="#name-reconstructing-igmp-mld-mem">Reconstructing IGMP/MLD Membership Reports from the Selective Multicast Route</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1.2.3">
                    <p id="section-toc.1-1.9.2.1.2.3.1"><a class="xref" href="#section-9.1.3">9.1.3</a>.  <a class="xref" href="#name-default-selective-multicast">Default Selective Multicast Route</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a class="xref" href="#section-9.2">9.2</a>.  <a class="xref" href="#name-multicast-membership-report">Multicast Membership Report Synch Route</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2.2.1">
                    <p id="section-toc.1-1.9.2.2.2.1.1"><a class="xref" href="#section-9.2.1">9.2.1</a>.  <a class="xref" href="#name-constructing-the-multicast-">Constructing the Multicast Membership Report Synch Route</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2.2.2">
                    <p id="section-toc.1-1.9.2.2.2.2.1"><a class="xref" href="#section-9.2.2">9.2.2</a>.  <a class="xref" href="#name-reconstructing-igmp-mld-memb">Reconstructing IGMP/MLD Membership Reports from a Multicast Membership
   Report Synch Route</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a class="xref" href="#section-9.3">9.3</a>.  <a class="xref" href="#name-multicast-leave-synch-route">Multicast Leave Synch Route</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3.2.1">
                    <p id="section-toc.1-1.9.2.3.2.1.1"><a class="xref" href="#section-9.3.1">9.3.1</a>.  <a class="xref" href="#name-constructing-the-multicast-l">Constructing the Multicast Leave Synch Route</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3.2.2">
                    <p id="section-toc.1-1.9.2.3.2.2.1"><a class="xref" href="#section-9.3.2">9.3.2</a>.  <a class="xref" href="#name-reconstructing-igmp-mld-lea">Reconstructing IGMP/MLD Leave from a Multicast Leave Synch Route</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.4">
                <p id="section-toc.1-1.9.2.4.1"><a class="xref" href="#section-9.4">9.4</a>.  <a class="xref" href="#name-multicast-flags-extended-co">Multicast Flags Extended Community</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.5">
                <p id="section-toc.1-1.9.2.5.1"><a class="xref" href="#section-9.5">9.5</a>.  <a class="xref" href="#name-evi-rt-extended-community">EVI-RT Extended Community</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.6">
                <p id="section-toc.1-1.9.2.6.1"><a class="xref" href="#section-9.6">9.6</a>.  <a class="xref" href="#name-rewriting-of-rt-ecs-and-evi">Rewriting of RT ECs and EVI-RT ECs by ASBRs</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.7">
                <p id="section-toc.1-1.9.2.7.1"><a class="xref" href="#section-9.7">9.7</a>.  <a class="xref" href="#name-bgp-error-handling">BGP Error Handling</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a class="xref" href="#section-10">10</a>. <a class="xref" href="#name-igmp-version-1-membership-r">IGMP Version 1 Membership Report</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a class="xref" href="#section-11">11</a>. <a class="xref" href="#name-security-considerations">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a class="xref" href="#section-12">12</a>. <a class="xref" href="#name-iana-considerations">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a class="xref" href="#section-12.1">12.1</a>.  <a class="xref" href="#name-evpn-extended-community-sub">EVPN Extended Community Sub-Types Registration</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a class="xref" href="#section-12.2">12.2</a>.  <a class="xref" href="#name-evpn-route-types-registrati">EVPN Route Types Registration</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.3">
                <p id="section-toc.1-1.12.2.3.1"><a class="xref" href="#section-12.3">12.3</a>.  <a class="xref" href="#name-multicast-flags-extended-com">Multicast Flags Extended Community Registry</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a class="xref" href="#section-13">13</a>. <a class="xref" href="#name-references">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a class="xref" href="#section-13.1">13.1</a>.  <a class="xref" href="#name-normative-references">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a class="xref" href="#section-13.2">13.2</a>.  <a class="xref" href="#name-informative-references">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a class="xref" href="#appendix-A"></a><a class="xref" href="#name-acknowledgements">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a class="xref" href="#appendix-B"></a><a class="xref" href="#name-contributors">Contributors</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a class="xref" href="#appendix-C"></a><a class="xref" href="#name-authors-addresses">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<section id="section-1">
      <h2 id="name-introduction">
<a class="section-number selfRef" href="#section-1">1. </a><a class="section-name selfRef" href="#name-introduction">Introduction</a>
      </h2>
<p id="section-1-1">In data center (DC) applications, a point of delivery (POD) can consist of a
      collection of servers supported by several top-of-rack (ToR) and
      spine switches. This collection of servers and switches are self-contained
      and may have their own control protocol for intra-POD
      communication and orchestration. However, EVPN is used as a standard
      way of inter-POD communication for both intra-DC and inter-DC. A
      subnet can span across multiple PODs and DCs. EVPN provides a robust
      multi-tenant solution with extensive multihoming capabilities to
      stretch a subnet (VLAN) across multiple PODs and DCs. There can be
      many hosts (several hundreds) attached to a subnet that is
      stretched across several PODs and DCs.<a class="pilcrow" href="#section-1-1">¶</a></p>
<p id="section-1-2">These hosts express their interests in multicast groups on a
      given subnet/VLAN by sending IGMP/MLD Membership Reports for
      their interested multicast group(s). Furthermore, an IGMP/MLD router
      periodically sends Membership Queries to find out if there are hosts
      on that subnet that are still interested in receiving multicast
      traffic for that group. The IGMP/MLD Proxy solution described in this
      document accomplishes three objectives:<a class="pilcrow" href="#section-1-2">¶</a></p>
<ol class="normal type-1" id="section-1-3" start="1" type="1">
 <li id="section-1-3.1">Reduce flooding of IGMP/MLD messages: Just like the ARP/Neighbor Discovery (ND)
 suppression
 mechanism in EVPN to reduce the flooding of ARP messages over EVPN,
 it is also desired to have a mechanism to reduce the flooding of IGMP/MLD
 messages (both Queries and Membership Reports) in EVPN.<a class="pilcrow" href="#section-1-3.1">¶</a>
</li>
        <li id="section-1-3.2">Distributed anycast multicast proxy: It is desirable for the EVPN
 network to act as a distributed anycast multicast router with respect
 to IGMP/MLD Proxy function for all the hosts attached to that
 subnet.<a class="pilcrow" href="#section-1-3.2">¶</a>
</li>
        <li id="section-1-3.3">Selective multicast: This describes forwarding multicast traffic over the EVPN
 network such that it only gets forwarded to the PEs that have
 interests in the multicast group(s). This document shows how this objective may be achieved
 when ingress replication is used to distribute the multicast traffic
 among the PEs.  Procedures for supporting selective multicast using
 Point-to-Multipoint (P2MP) tunnels can be found in <span>[<a class="xref" href="#I-D.ietf-bess-evpn-bum-procedure-updates">EVPN-BUM</a>]</span>.<a class="pilcrow" href="#section-1-3.3">¶</a>
</li>
      </ol>
<p id="section-1-4">The first two objectives are achieved by using the IGMP/MLD Proxy on the
      PE. The third objective is achieved by setting up a multicast
      tunnel among only the PEs that have
      interest in the multicast group(s) based on the trigger from
      IGMP/MLD Proxy processes. The proposed solutions for each of these
      objectives are discussed in the following sections.<a class="pilcrow" href="#section-1-4">¶</a></p>
</section>
<section id="section-2">
      <h2 id="name-specification-of-requiremen">
<a class="section-number selfRef" href="#section-2">2. </a><a class="section-name selfRef" href="#name-specification-of-requiremen">Specification of Requirements</a>
      </h2>
<p id="section-2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>",
      "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>",
      "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>",
      "<span class="bcp14">NOT RECOMMENDED</span>", "<span class="bcp14">MAY</span>", and
      "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as described in
      BCP 14 <span>[<a class="xref" href="#RFC2119">RFC2119</a>]</span> <span>[<a class="xref" href="#RFC8174">RFC8174</a>]</span> when, and only when,  they appear in all capitals, as shown here.<a class="pilcrow" href="#section-2-1">¶</a></p>
</section>
<section id="section-3">
      <h2 id="name-terminology">
<a class="section-number selfRef" href="#section-3">3. </a><a class="section-name selfRef" href="#name-terminology">Terminology</a>
      </h2>
<span class="break"></span><dl class="dlParallel" id="section-3-1">
        <dt id="section-3-1.1"> AC:</dt>
        <dd id="section-3-1.2" style="margin-left: 1.5em"> Attachment Circuit<a class="pilcrow" href="#section-3-1.2">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-1.3">All-Active Redundancy Mode:</dt>
        <dd id="section-3-1.4" style="margin-left: 1.5em"> When all PEs attached to an Ethernet
 segment are allowed to forward known unicast traffic to/from that
 Ethernet segment for a given VLAN, then the Ethernet segment is
 defined to be operating in All-Active redundancy mode.<a class="pilcrow" href="#section-3-1.4">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-1.5">BD:</dt>
        <dd id="section-3-1.6" style="margin-left: 1.5em"> Broadcast Domain. As per <span>[<a class="xref" href="#RFC7432">RFC7432</a>]</span>, an EVPN instance
 (EVI) consists of a single BD
 or multiple BDs. In case of a VLAN bundle and a VLAN-aware bundle service
 model, an EVI contains multiple BDs. Also, in this document, BD and
 subnet are equivalent terms.<a class="pilcrow" href="#section-3-1.6">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-1.7">DC:</dt>
        <dd id="section-3-1.8" style="margin-left: 1.5em"> Data Center<a class="pilcrow" href="#section-3-1.8">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-1.9">ES:</dt>
        <dd id="section-3-1.10" style="margin-left: 1.5em"> Ethernet segment. This is when a customer site (device or network) is
 connected to one or more PEs via a set of Ethernet links.<a class="pilcrow" href="#section-3-1.10">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-1.11">ESI:</dt>
        <dd id="section-3-1.12" style="margin-left: 1.5em"> Ethernet Segment Identifier. This is a unique non-zero identifier that
 identifies an Ethernet segment.<a class="pilcrow" href="#section-3-1.12">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-1.13">Ethernet Tag:</dt>
        <dd id="section-3-1.14" style="margin-left: 1.5em"> It identifies a particular broadcast
 domain, e.g., a VLAN.  An EVPN instance consists of one or more
 broadcast domains.<a class="pilcrow" href="#section-3-1.14">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-1.15">EVI:</dt>
        <dd id="section-3-1.16" style="margin-left: 1.5em"> EVPN Instance. This spans the Provider Edge (PE) devices
 participating in that EVPN.<a class="pilcrow" href="#section-3-1.16">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-1.17">EVPN:</dt>
        <dd id="section-3-1.18" style="margin-left: 1.5em"> Ethernet Virtual Private Network<a class="pilcrow" href="#section-3-1.18">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-1.19">IGMP:</dt>
        <dd id="section-3-1.20" style="margin-left: 1.5em"> Internet Group Management Protocol<a class="pilcrow" href="#section-3-1.20">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-1.21">IR:</dt>
        <dd id="section-3-1.22" style="margin-left: 1.5em"> Ingress Replication<a class="pilcrow" href="#section-3-1.22">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-1.23">MLD:</dt>
        <dd id="section-3-1.24" style="margin-left: 1.5em"> Multicast Listener Discovery<a class="pilcrow" href="#section-3-1.24">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-1.25"> OIF:</dt>
        <dd id="section-3-1.26" style="margin-left: 1.5em"> Outgoing Interface for multicast. It can be a physical interface,
 virtual interface, or tunnel.<a class="pilcrow" href="#section-3-1.26">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-1.27">PE:</dt>
        <dd id="section-3-1.28" style="margin-left: 1.5em"> Provider Edge<a class="pilcrow" href="#section-3-1.28">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-1.29">POD:</dt>
        <dd id="section-3-1.30" style="margin-left: 1.5em"> Point of Delivery<a class="pilcrow" href="#section-3-1.30">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-1.31"> S-PMSI:</dt>
        <dd id="section-3-1.32" style="margin-left: 1.5em"> Selective P-Multicast Service Interface. This is a conceptual interface for a 
 PE to send customer multicast traffic to some of the PEs in the same VPN.<a class="pilcrow" href="#section-3-1.32">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-1.33">Single-Active Redundancy Mode:</dt>
        <dd id="section-3-1.34" style="margin-left: 1.5em"> When only a single PE, among all the
 PEs attached to an Ethernet segment, is allowed to forward traffic
 to/from that Ethernet segment for a given VLAN, then the Ethernet
 segment is defined to be operating in Single-Active redundancy mode.<a class="pilcrow" href="#section-3-1.34">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-1.35"> SMET:</dt>
        <dd id="section-3-1.36" style="margin-left: 1.5em"> Selective Multicast Ethernet Tag<a class="pilcrow" href="#section-3-1.36">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-1.37">ToR:</dt>
        <dd id="section-3-1.38" style="margin-left: 1.5em"> Top of Rack<a class="pilcrow" href="#section-3-1.38">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-3-2">This document also assumes familiarity with the terminology of
      <span>[<a class="xref" href="#RFC7432">RFC7432</a>]</span>, <span>[<a class="xref" href="#RFC3376">RFC3376</a>]</span>, and <span>[<a class="xref" href="#RFC2236">RFC2236</a>]</span>.
      When this document uses the term "IGMP
      Membership Report", the text equally applies to the MLD
      Membership Report. Similarly, text for IGMPv2 applies to MLDv1,
      and text for IGMPv3 applies to MLDv2. IGMP/MLD version encoding in the
      BGP update is stated in <a class="xref" href="#bgp-encoding">Section 9</a>.<a class="pilcrow" href="#section-3-2">¶</a></p>
<p id="section-3-3"> It is important to note that when there is text considering whether a PE
      indicates support for IGMP proxying, the corresponding behavior has a
      natural analog for indicating support for MLD proxying, and the analogous
      requirements apply as well.<a class="pilcrow" href="#section-3-3">¶</a></p>
</section>
<section id="section-4">
      <h2 id="name-igmp-mld-proxy">
<a class="section-number selfRef" href="#section-4">4. </a><a class="section-name selfRef" href="#name-igmp-mld-proxy">IGMP/MLD Proxy</a>
      </h2>
<p id="section-4-1">The IGMP Proxy mechanism is used to reduce the flooding of IGMP
      messages over an EVPN network, similar to the ARP proxy used in reducing
      the flooding of ARP messages over EVPN. It also provides a triggering
      mechanism for the PEs to set up their underlay multicast tunnels. The
      IGMP Proxy mechanism consists of two components:<a class="pilcrow" href="#section-4-1">¶</a></p>
<ol class="normal type-1" id="section-4-2" start="1" type="1">
 <li id="section-4-2.1"> Proxy for IGMP Membership Reports<a class="pilcrow" href="#section-4-2.1">¶</a>
</li>
        <li id="section-4-2.2"> Proxy for IGMP Membership Queries<a class="pilcrow" href="#section-4-2.2">¶</a>
</li>
      </ol>
<p id="section-4-3">The goal of IGMP and MLD proxying is to make the EVPN behave seamlessly for
      the tenant systems with respect to multicast operations while using a more 
      efficient delivery system for signaling and delivery across the VPN. 
      Accordingly, group state must be tracked synchronously among the PEs 
      serving the VPN, with join and leave events propagated to the peer PEs and 
      each PE tracking the state of each of its peer PEs with respect to whether 
      there are locally attached group members (and in some cases, senders), what 
      version(s) of IGMP/MLD are in use for those locally attached group members, 
      etc.  In order to perform this translation, each PE acts as an IGMP router 
      for the locally attached domain, maintains the requisite state on 
      locally attached nodes, sends periodic Membership Queries, etc.  The role 
      of EVPN Selective Multicast Ethernet Tag (SMET) route propagation is to
      ensure that each PE's local state is 
      propagated to the other PEs so that they share a consistent view of the 
      overall IGMP Membership Request and Leave Group state.  It is important to 
      note that the need to keep such local state can be triggered by either 
      local IGMP traffic or BGP EVPN signaling.  In most cases, a local IGMP event 
      will need to be signaled over EVPN, though state initiated by received EVPN 
      traffic will not always need to be relayed to the locally attached domain.<a class="pilcrow" href="#section-4-3">¶</a></p>
<section id="section-4.1">
        <h3 id="name-proxy-reporting">
<a class="section-number selfRef" href="#section-4.1">4.1. </a><a class="section-name selfRef" href="#name-proxy-reporting">Proxy Reporting</a>
        </h3>
<p id="section-4.1-1">When IGMP is used between hosts and their first hop EVPN
 router (EVPN PE), proxy reporting is used by the EVPN PE to summarize
 (when possible) reports received from downstream hosts and propagate
 them in BGP to other PEs that are interested in the information.
 This
 is done by terminating the IGMP Membership Reports in the first hop PE and
 translating and exchanging the relevant information among EVPN BGP
 speakers. The information is again translated back to an IGMP message at
 the recipient EVPN speaker. Thus, it helps create an IGMP overlay
 subnet using BGP. In order to facilitate such an overlay, this
 document also defines a new EVPN route type Network Layer Reachability Information
 (NLRI) and the EVPN SMET route, along with its procedures to help
 exchange and register IGMP multicast groups; see <a class="xref" href="#bgp-encoding">Section 9</a>.<a class="pilcrow" href="#section-4.1-1">¶</a></p>
<section id="section-4.1.1">
          <h4 id="name-igmp-mld-membership-report-">
<a class="section-number selfRef" href="#section-4.1.1">4.1.1. </a><a class="section-name selfRef" href="#name-igmp-mld-membership-report-">IGMP/MLD Membership Report Advertisement in BGP</a>
          </h4>
<p id="section-4.1.1-1">When a PE wants to advertise an IGMP Membership Report using
   the BGP EVPN route, it follows the proceeding rules (BGP encoding
   is stated in <a class="xref" href="#bgp-encoding">Section 9</a>). The first four
   rules are applicable to the originator PE, and the last three rules are applicable
   to remote PE processing SMET routes:<a class="pilcrow" href="#section-4.1.1-1">¶</a></p>
<p id="section-4.1.1-2">Processing at the BGP route originator:<a class="pilcrow" href="#section-4.1.1-2">¶</a></p>
<ol class="normal type-1" id="section-4.1.1-3" start="1" type="1">
     <li id="section-4.1.1-3.1">When the first hop PE receives IGMP Membership Reports
     belonging to the same IGMP version from different attached
     hosts for the same (*,G) or (S,G), it <span class="bcp14">SHOULD</span> send a single
     BGP message corresponding to the very first IGMP Membership Request (BGP update as
     soon as possible) for that (*,G) or (S,G). This is because BGP is a
     stateful protocol, and no further transmission of the same report is
     needed. If the IGMP Membership Request is for (*,G), then the Multicast Group Address
     <span class="bcp14">MUST</span> be sent along with the corresponding version flag (v2 or v3)
     set. In case of IGMPv3, the exclude flag <span class="bcp14">MUST</span> also be set to
     indicate that no source IP address must be excluded (include all
     sources "*").
     If the IGMP Membership Report is for (S,G), then besides setting the Multicast Group
     Address along with the v3 flag, the source IP address and the
     Include/Exclude (IE) flag <span class="bcp14">MUST</span> be set. It should be noted that, when
     advertising the EVPN route for (S,G), the only valid version flag is
     v3 (v2 flags <span class="bcp14">MUST</span> be set to 0).<a class="pilcrow" href="#section-4.1.1-3.1">¶</a>
</li>
            <li id="section-4.1.1-3.2">When the first hop PE receives an IGMPv3 Membership Report for (S,G) on a given
     BD, it <span class="bcp14">MUST</span> advertise the corresponding EVPN SMET route, regardless
     of whether the source (S) is
     attached to itself or not, in order to facilitate the source move in
     the future.<a class="pilcrow" href="#section-4.1.1-3.2">¶</a>
</li>
            <li id="section-4.1.1-3.3">When the first hop PE receives an IGMP version-X Membership Report first for
     (*,G) and then later receives an IGMP version-Y Membership Report for the same
     (*,G), then it <span class="bcp14">MUST</span> re-advertise the same EVPN SMET route with the flag
     for version-Y set in addition to any previously set version flag(s).
     In other words, the first hop PE <span class="bcp14">MUST NOT</span> withdraw the EVPN route
     before sending the new route because the Flags field is not part of
     BGP route key processing.<a class="pilcrow" href="#section-4.1.1-3.3">¶</a>
</li>
            <li id="section-4.1.1-3.4">When the first hop PE receives an IGMP version-X Membership Report first for
     (*,G) and then later receives an IGMPv3 Membership Report for the same
     Multicast Group Address but for a specific source address S, then the
     PE <span class="bcp14">MUST</span> advertise a new EVPN SMET route with the v3 flag set (and v2 reset). 
     The IE flag also needs to be set accordingly.
     Since the source IP address is used as part of BGP route key processing,
     it is considered to be a new BGP route advertisement. When different versions 
     of IGMP Membership Report are received, the final state <span class="bcp14">MUST</span> be as per
     <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc3376#section-5.1">Section 5.1</a> of [<a class="xref" href="#RFC3376">RFC3376</a>]</span>.
     At the end of the route processing, local and remote group record state
     <span class="bcp14">MUST</span>
     be as per <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc3376#section-5.1">Section 5.1</a> of [<a class="xref" href="#RFC3376">RFC3376</a>]</span>.<a class="pilcrow" href="#section-4.1.1-3.4">¶</a>
</li>
          </ol>
<p id="section-4.1.1-4">Processing at the BGP route receiver:<a class="pilcrow" href="#section-4.1.1-4">¶</a></p>
<ol class="normal type-1" id="section-4.1.1-5" start="1" type="1">
     <li id="section-4.1.1-5.1">When a PE receives an EVPN SMET route with more than one version
     flag set, it will generate the corresponding IGMP Report for (*,G)
     for each version specified in the Flags field. With multiple version
     flags set, there must not be a source IP address in the received EVPN
     route. If there is, then an error <span class="bcp14">SHOULD</span> be logged. If the v3 flag
     is set (in addition to v2), then the IE flag <span class="bcp14">MUST</span>
     indicate "exclude". If not, then an error <span class="bcp14">SHOULD</span> be logged. The PE
     <span class="bcp14">MUST</span> generate an IGMP Membership Report for that (*,G) and
     each IGMP version in the version flag.<a class="pilcrow" href="#section-4.1.1-5.1">¶</a>
</li>
            <li id="section-4.1.1-5.2">When a PE receives a list of EVPN SMET NLRIs in its BGP update
     message, each with a different source IP address and the same
     Multicast Group Address, and the version flag is set to v3, then the
     PE generates an IGMPv3 Membership Report with a record corresponding
     to the list of source IP addresses and the group address, along with
     the proper indication of inclusion/exclusion.<a class="pilcrow" href="#section-4.1.1-5.2">¶</a>
</li>
            <li id="section-4.1.1-5.3">Upon receiving an EVPN SMET route(s) and before generating the
     corresponding IGMP Membership Request(s), the PE checks to see whether it has a
     Customer Edge (CE) multicast router for that BD on any of its ESs . The PE provides
     such a check by listening for PIM Hello messages on that AC, i.e.,
     (ES,BD). If the PE does have the router's ACs, then the generated
     IGMP Membership Request(s) is sent to those ACs. If it doesn't have any of the
     router's ACs, then no IGMP Membership Request(s) needs to be generated. This is
     because sending IGMP Membership Requests to other hosts can result in
     unintentionally preventing a host from joining a specific multicast
     group using IGMPv2, i.e., if the PE does not receive a Membership Report from the
     host, it will not forward multicast data to it. Per <span>[<a class="xref" href="#RFC4541">RFC4541</a>]</span> , when an
     IGMPv2 host receives a Membership Report for a group address that it
     intends to join, the host will suppress its own Membership Report for
     the same group, and if the PE does not receive an IGMP Membership Report from the host,
     it will not forward multicast data to it. In other words, an IGMPv2
     Membership Report <span class="bcp14">MUST NOT</span> be sent on an AC that does not lead to a CE
     multicast router. This message suppression is a requirement for IGMPv2 hosts.
     This is not a problem for hosts running IGMPv3, because there is no
     suppression of IGMP Membership Reports.<a class="pilcrow" href="#section-4.1.1-5.3">¶</a>
</li>
          </ol>
</section>
<section id="section-4.1.2">
          <h4 id="name-igmp-mld-leave-group-advert">
<a class="section-number selfRef" href="#section-4.1.2">4.1.2. </a><a class="section-name selfRef" href="#name-igmp-mld-leave-group-advert">IGMP/MLD Leave Group Advertisement in BGP</a>
          </h4>
<p id="section-4.1.2-1">When a PE wants to withdraw an EVPN SMET route corresponding to an
   IGMPv2 Leave Group or IGMPv3 "Leave" equivalent message, it
   follows the rules below. The first rule defines the procedure at the
   originator PE, and the last two rules talk about procedures at the remote PE:<a class="pilcrow" href="#section-4.1.2-1">¶</a></p>
<p id="section-4.1.2-2">Processing at the BGP route originator:<a class="pilcrow" href="#section-4.1.2-2">¶</a></p>
<ol class="normal type-1" id="section-4.1.2-3" start="1" type="1">
     <li id="section-4.1.2-3.1">When a PE receives an IGMPv2 Leave Group or its "Leave" equivalent
     message for IGMPv3 from its attached host, it checks to see if this
     host is the last host that is interested in this multicast group by
     sending a query for the multicast group.
     If the host was indeed the
     last one (i.e., no responses are received for the query), then the PE
     <span class="bcp14">MUST</span> re-advertise the EVPN SMET route with the corresponding
     version flag reset. If this is the last version flag to be reset,
     then instead of re-advertising the EVPN route with all version flags
     reset, the PE <span class="bcp14">MUST</span> withdraw the EVPN route for that (*,G).<a class="pilcrow" href="#section-4.1.2-3.1">¶</a>
</li>
          </ol>
<p id="section-4.1.2-4">Processing at the BGP route receiver:<a class="pilcrow" href="#section-4.1.2-4">¶</a></p>
<ol class="normal type-1" id="section-4.1.2-5" start="1" type="1">
     <li id="section-4.1.2-5.1">When a PE receives an EVPN SMET route for a given (*,G), it
     compares the received version flags from the route with its per-PE
     stored version flags.
     If the PE finds that a version flag associated
     with the (*,G) for the remote PE is reset, then the PE <span class="bcp14">MUST</span> generate
     IGMP Leave for that (*,G) toward its local interface (if any), which is
     attached to the multicast router for that multicast group. It should
     be noted that the received EVPN route <span class="bcp14">MUST</span> have at least one
     version flag set. If all version flags are reset, it is an error
     because the PE should have received an EVPN route withdraw for the
     last version flag. An error <span class="bcp14">MUST</span> be considered as a BGP error, and
     the PE <span class="bcp14">MUST</span> apply the 
     "treat-as-withdraw" procedure per <span>[<a class="xref" href="#RFC7606">RFC7606</a>]</span>.<a class="pilcrow" href="#section-4.1.2-5.1">¶</a>
</li>
            <li id="section-4.1.2-5.2">When a PE receives an EVPN SMET route withdraw, it removes the
     remote PE from its OIF list for that multicast group, and if there are
     no more OIF entries for that multicast group (either locally or
     remotely), then the PE <span class="bcp14">MUST</span> stop responding to Membership
     Queries from the
     locally attached router (if any). If there is a source for that
     multicast group, the PE stops sending multicast traffic for that source.<a class="pilcrow" href="#section-4.1.2-5.2">¶</a>
</li>
          </ol>
</section>
</section>
<section id="section-4.2">
        <h3 id="name-proxy-querier">
<a class="section-number selfRef" href="#section-4.2">4.2. </a><a class="section-name selfRef" href="#name-proxy-querier">Proxy Querier</a>
        </h3>
<p id="section-4.2-1">As mentioned in the previous sections, each PE <span class="bcp14">MUST</span> have proxy
 querier functionality for the following reasons:<a class="pilcrow" href="#section-4.2-1">¶</a></p>
<ol class="normal type-1" id="section-4.2-2" start="1" type="1">
   <li id="section-4.2-2.1">to enable the collection of EVPN PEs providing Layer 2 Virtual Private Network
   (L2VPN) service to
   act as a distributed multicast router with an anycast IP address for all
   attached hosts in that subnet<a class="pilcrow" href="#section-4.2-2.1">¶</a>
</li>
          <li id="section-4.2-2.2">to enable suppression of IGMP Membership Reports and Membership Queries over
   MPLS/IP core<a class="pilcrow" href="#section-4.2-2.2">¶</a>
</li>
        </ol>
</section>
</section>
<section id="section-5">
      <h2 id="name-operation">
<a class="section-number selfRef" href="#section-5">5. </a><a class="section-name selfRef" href="#name-operation">Operation</a>
      </h2>
<p id="section-5-1">Consider the EVPN network in <a class="xref" href="#EVPN">Figure 1</a>, where there is an EVPN
      instance configured across the PEs (namely PE1,
      PE2, and PE3). Let's consider that this EVPN instance consists of a
      single bridge domain (single subnet) with all the hosts and sources and
      the multicast router connected to this subnet. PE1 only has hosts (host denoted by Hx)
      connected to it. PE2 has a mix of hosts and a multicast source. PE3
      has a mix of hosts, a multicast source (source denoted by Sx), and a multicast router
      (router denoted by Rx).
      Furthermore, let's consider that for (S1,G1), R1 is used as the
      multicast router. The following subsections describe the IGMP Proxy
      operation in different PEs with regard to whether the locally
      attached devices for that subnet are:<a class="pilcrow" href="#section-5-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-2.1">only hosts,<a class="pilcrow" href="#section-5-2.1">¶</a>
</li>
        <li class="normal" id="section-5-2.2">a mix of hosts and a multicast source, or<a class="pilcrow" href="#section-5-2.2">¶</a>
</li>
        <li class="normal" id="section-5-2.3">a mix of hosts, a multicast source, and a multicast router.<a class="pilcrow" href="#section-5-2.3">¶</a>
</li>
      </ul>
<span id="name-evpn-network"></span><div id="EVPN">
<figure id="figure-1">
        <div class="alignCenter art-text artwork" id="section-5-3.1">
<pre>                      +--------------+
                      |              |
                      |              |
               +----+ |              | +----+
H1:(*,G1)v2 ---|    | |              | |    |---- H6(*,G1)v2
H2:(*,G1)v2 ---| PE1| |   IP/MPLS    | | PE2|---- H7(S2,G2)v3
H3:(*,G1)v3 ---|    | |   Network    | |    |---- S2
H4:(S2,G2)v3 --|    | |              | |    |
               +----+ |              | +----+
                      |              |
               +----+ |              |
H5:(S1,G1)v3 --|    | |              |
         S1 ---| PE3| |              |
         R1 ---|    | |              |
               +----+ |              |
                      |              |
                      +--------------+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-1">Figure 1</a>:
<a class="selfRef" href="#name-evpn-network">EVPN Network</a>
        </figcaption></figure>
</div>
<section id="section-5.1">
        <h3 id="name-pe-with-only-attached-hosts">
<a class="section-number selfRef" href="#section-5.1">5.1. </a><a class="section-name selfRef" href="#name-pe-with-only-attached-hosts">PE with Only Attached Hosts for a Given Subnet</a>
        </h3>
<p id="section-5.1-1">When PE1 receives an IGMPv2 Membership Report from H1, it does not forward 
 this Membership Report to any of its other ports (for this subnet) because all
 these local ports are associated with the hosts.
        PE1 sends an
 EVPN SMET route corresponding to this Membership Report for (*,G1) and
 sets the v2 flag. This EVPN route is received by PE2 and PE3, which are
 the members of the same BD (i.e., same EVI in case of a VLAN-based
 service or EVI and VLAN in case of a VLAN-aware bundle service). PE3
 reconstructs the IGMPv2 Membership Report from this EVPN BGP route and only
 sends it to the port(s) with multicast routers attached to it (for
 that subnet). In this example, PE3 sends the reconstructed IGMPv2
 Membership Report for (*,G1)  only to R1. Furthermore, even though PE2
 receives the EVPN BGP route, it does not send it to any of its ports
 for that subnet (viz., ports associated with H6 and H7).<a class="pilcrow" href="#section-5.1-1">¶</a></p>
<p id="section-5.1-2">When PE1 receives the second IGMPv2 Membership Report from H2 for the same
 multicast group (*,G1), it only adds that port to its OIF list, but it
 doesn't send any EVPN BGP routes because there is no change in
 information. However, when it receives the IGMPv3 Membership Report from H3 for
 the same (*,G1), besides adding the corresponding port to its OIF
 list, it re-advertises the previously sent EVPN SMET route with the
 v3 and exclude flag set.<a class="pilcrow" href="#section-5.1-2">¶</a></p>
<p id="section-5.1-3">Finally, when PE1 receives the IGMPv3 Membership Report from H4 for (S2,G2), it
 advertises a new EVPN SMET route corresponding to it.<a class="pilcrow" href="#section-5.1-3">¶</a></p>
</section>
<section id="section-5.2">
        <h3 id="name-pe-with-a-mix-of-attached-h">
<a class="section-number selfRef" href="#section-5.2">5.2. </a><a class="section-name selfRef" href="#name-pe-with-a-mix-of-attached-h">PE with a Mix of Attached Hosts and a Multicast Source</a>
        </h3>
<p id="section-5.2-1">The main difference in this case is that when PE2 receives the IGMPv3
 Membership Report from H7 for (S2,G2), it advertises it in BGP to support the
 source moving, even though PE2 knows that S2 is attached to its local
 AC. PE2 adds the port associated with H7 to its OIF list for (S2,G2).
 The processing for IGMPv2 received from H6 is the same as the IGMPv2
 Membership Report described in the previous section.<a class="pilcrow" href="#section-5.2-1">¶</a></p>
</section>
<section id="section-5.3">
        <h3 id="name-pe-with-a-mix-of-attached-ho">
<a class="section-number selfRef" href="#section-5.3">5.3. </a><a class="section-name selfRef" href="#name-pe-with-a-mix-of-attached-ho">PE with a Mix of Attached Hosts, a Multicast Source, and a Router</a>
        </h3>
<p id="section-5.3-1">The main difference in this case relative to the previous two
 sections is that IGMPv2/v3 Membership Report messages received locally need to
 be sent to the port associated with router R1. Furthermore, the Membership Reports
 received via BGP (SMET) need to be passed to the R1 port but filtered
 for all other ports.<a class="pilcrow" href="#section-5.3-1">¶</a></p>
</section>
</section>
<section id="section-6">
      <h2 id="name-all-active-multihoming">
<a class="section-number selfRef" href="#section-6">6. </a><a class="section-name selfRef" href="#name-all-active-multihoming">All-Active Multihoming</a>
      </h2>
<p id="section-6-1">Because the Link Aggregation Group (LAG) flow hashing algorithm used by the CE is unknown at
      the PE, in an All-Active redundancy mode, it must be assumed that the
      CE can send a given IGMP message to any one of the multihomed PEs,
      either Designated Forwarder (DF) or non-DF, i.e., different IGMP Membership
      Request messages can arrive at
      different PEs in the redundancy group. Furthermore, their
      corresponding Leave messages can arrive at PEs that are different
      from the ones that received the Membership Report. Therefore, all PEs
      attached to a given Ethernet segment (ES) must coordinate the IGMP Membership Request and Leave Group
      (x,G) state, where x may be either "*" or a particular source S for
      each BD on that ES. Each PE has a local copy of that state, and the EVPN signaling
      serves to synchronize that state across PEs. This allows the DF for that (ES,BD) to correctly
      advertise or withdraw a SMET route
      for that (x,G) group in that BD when needed. 
      All-Active multihoming PEs for a given ES <span class="bcp14">MUST</span> support IGMP
      synchronization procedures described in this section if they need to
      perform IGMP Proxy for hosts connected to that ES.<a class="pilcrow" href="#section-6-1">¶</a></p>
<div id="local-igmp-mld">
<section id="section-6.1">
        <h3 id="name-local-igmp-mld-membership-r">
<a class="section-number selfRef" href="#section-6.1">6.1. </a><a class="section-name selfRef" href="#name-local-igmp-mld-membership-r">Local IGMP/MLD Membership Report Synchronization</a>
        </h3>
<p id="section-6.1-1">When a PE, either DF or non-DF, receives an IGMP Membership Report
 for (x,G) on a given multihomed ES operating in All-Active redundancy mode, it determines the BD to which the IGMP Membership Report
 belongs. If the PE doesn't already have the local IGMP Membership Request (x,G) state
 for that BD on that ES, it <span class="bcp14">MUST</span> instantiate that local IGMP Membership
 Request (x,G)
 state and <span class="bcp14">MUST</span> advertise a BGP IGMP Membership Report Synch route
 for that (ES,BD).
 The local IGMP Membership Request (x,G) state refers to the IGMP Membership Request (x,G) state
 that is created as a result of processing an IGMP Membership Report
 for (x,G).<a class="pilcrow" href="#section-6.1-1">¶</a></p>
<p id="section-6.1-2">The IGMP Membership Report Synch route <span class="bcp14">MUST</span> carry the ES-Import
 Route Target (RT) for the ES on
 which the IGMP Membership Report was received.  Thus, it <span class="bcp14">MUST</span> only be 
 imported by the PEs attached to that ES and not any other PEs.<a class="pilcrow" href="#section-6.1-2">¶</a></p>
<p id="section-6.1-3">When a PE, either DF or non-DF, receives an IGMP Membership Report Synch route, it
 installs that route, and if it doesn't already have the IGMP Membership Request (x,G)
 state for that (ES,BD), it <span class="bcp14">MUST</span> instantiate that IGMP Membership
 Request (x,G)
 state, i.e., the IGMP Membership Request (x,G) state is the union of the local IGMP
 Membership Report (x,G) state and the installed IGMP Membership Report Synch route.
 If the DF did not already advertise (originate) a SMET route for that (x,G)
 group in that BD, it <span class="bcp14">MUST</span> do so now.<a class="pilcrow" href="#section-6.1-3">¶</a></p>
<p id="section-6.1-4">When a PE, either DF or non-DF, deletes its local IGMP Membership Request (x,G)
 state for that (ES,BD), it <span class="bcp14">MUST</span> withdraw its BGP IGMP Membership
 Report Synch route for that (ES,BD).<a class="pilcrow" href="#section-6.1-4">¶</a></p>
<p id="section-6.1-5">When a PE, either DF or non-DF, receives the withdrawal of an IGMP
 Membership Report Synch route from another PE, it <span class="bcp14">MUST</span> remove that route.
 When a PE has no local IGMP Membership Request (x,G) state and it has no installed IGMP
 Membership Report Synch routes, it <span class="bcp14">MUST</span> remove that IGMP Membership Request
 (x,G) state for that (ES,BD).  
 If the DF no longer has the IGMP Membership Request (x,G) state for that BD on
 any ES for which it is the DF, it <span class="bcp14">MUST</span> withdraw its SMET route for that
 (x,G) group in that BD.<a class="pilcrow" href="#section-6.1-5">¶</a></p>
<p id="section-6.1-6">In other words, a PE advertises a SMET route for that (x,G) group in
 that BD when it has the IGMP Membership Request (x,G) state on at least one
 ES for which it is the DF, and it withdraws that SMET route when it does
 not have an IGMP Membership Request (x,G) state in that BD on any ES for which it is
 the DF.<a class="pilcrow" href="#section-6.1-6">¶</a></p>
</section>
</div>
<section id="section-6.2">
        <h3 id="name-local-igmp-mld-leave-group-">
<a class="section-number selfRef" href="#section-6.2">6.2. </a><a class="section-name selfRef" href="#name-local-igmp-mld-leave-group-">Local IGMP/MLD Leave Group Synchronization</a>
        </h3>
<p id="section-6.2-1">When a PE, either DF or non-DF, receives an IGMP Leave Group message
 for (x,G) from the attached CE on a given multihomed ES
 operating in All-Active redundancy mode, it determines the BD to which the
 IGMPv2 Leave Group belongs.  Regardless of whether it has the IGMP Membership Request
 (x,G) state for that (ES,BD), it initiates the (x,G) leave group
 synchronization procedure, which consists of the following steps:<a class="pilcrow" href="#section-6.2-1">¶</a></p>
<ol class="normal type-1" id="section-6.2-2" start="1" type="1">
   <li id="section-6.2-2.1">It computes the Maximum Response Time, which is the duration of the
   (x,G) leave group synchronization procedure.  This is the product of
   two locally configured values, Last Member Query Count and Last
   Member Query Interval (described in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc2236#section-3">Section 3</a> of [<a class="xref" href="#RFC2236">RFC2236</a>]</span>), plus a
   delta corresponding to the time it takes for a BGP advertisement to
   propagate between the PEs attached to the multihomed ES (delta is a
   consistently configured value on all PEs attached to the multihomed
   ES).<a class="pilcrow" href="#section-6.2-2.1">¶</a>
</li>
          <li id="section-6.2-2.2">It starts the Maximum Response Time timer. Note that the receipt
   of subsequent IGMP Leave Group messages or BGP Leave Synch routes for
   (x,G) do not change the value of a currently running Maximum Response
   Time timer and are ignored by the PE.<a class="pilcrow" href="#section-6.2-2.2">¶</a>
</li>
          <li id="section-6.2-2.3">It initiates the Last Member Query procedure described in
   <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc2236#section-3">Section 3</a> of [<a class="xref" href="#RFC2236">RFC2236</a>]</span>; viz., it
   sends a number of Group-Specific Query (x,G)
   messages (Last Member Query Count) at a fixed interval (Last Member
   Query Interval) to the attached CE.<a class="pilcrow" href="#section-6.2-2.3">¶</a>
</li>
          <li id="section-6.2-2.4">It advertises an IGMP Leave Synch route for that (ES,BD).
   This route notifies the other multihomed PEs attached to the given
   multihomed ES that it has initiated an (x,G) leave group
   synchronization procedure, i.e., it carries the ES-Import RT for the
   ES on which the IGMP Leave Group was received.  It also contains the
   Maximum Response Time.<a class="pilcrow" href="#section-6.2-2.4">¶</a>
</li>
          <li id="section-6.2-2.5">When the Maximum Response Time timer expires, the PE that has
   advertised the IGMP Leave Synch route withdraws it.<a class="pilcrow" href="#section-6.2-2.5">¶</a>
</li>
        </ol>
<section id="section-6.2.1">
          <h4 id="name-remote-leave-group-synchron">
<a class="section-number selfRef" href="#section-6.2.1">6.2.1. </a><a class="section-name selfRef" href="#name-remote-leave-group-synchron">Remote Leave Group Synchronization</a>
          </h4>
<p id="section-6.2.1-1">When a PE, either DF or non-DF, receives an IGMP Leave Synch route, it
   installs that route and it starts a timer for (x,G) on the specified
   (ES,BD), whose value is set to the Maximum Response Time in the
   received IGMP Leave Synch route.  Note that the receipt of subsequent
   IGMPv2 Leave Group messages or BGP Leave Synch routes for (x,G) do
   not change the value of a currently running Maximum Response Time 
   timer and are ignored by the PE.<a class="pilcrow" href="#section-6.2.1-1">¶</a></p>
</section>
<section id="section-6.2.2">
          <h4 id="name-common-leave-group-synchron">
<a class="section-number selfRef" href="#section-6.2.2">6.2.2. </a><a class="section-name selfRef" href="#name-common-leave-group-synchron">Common Leave Group Synchronization</a>
          </h4>
<p id="section-6.2.2-1">If a PE attached to the multihomed ES receives an IGMP Membership
   Report for (x,G) before the Maximum Response Time timer expires, it
   advertises a BGP IGMP Membership Report Synch route for that (ES,BD). If it
   doesn't already have the local IGMP Membership Request (x,G) state for that (ES,BD),
   it instantiates that local IGMP Membership Request (x,G) state. If the DF is not
   currently advertising (originating) a SMET route for that (x,G) group
   in that BD, it does so now.<a class="pilcrow" href="#section-6.2.2-1">¶</a></p>
<p id="section-6.2.2-2">If a PE attached to the multihomed ES receives an IGMP Membership Report Synch
   route for (x,G) before the Maximum Response Time timer expires, it
   installs that route, and if it doesn't already have the IGMP Membership Request (x,G)
   state for that BD on that ES, it instantiates that IGMP Membership Request (x,G)
   state. If the DF has not already advertised (originated) a SMET route
   for that (x,G) group in that BD, it does so now.<a class="pilcrow" href="#section-6.2.2-2">¶</a></p>
<p id="section-6.2.2-3">When the Maximum Response Time timer expires, a PE that has advertised an
   IGMP Leave Synch route withdraws it.  Any PE attached to the
   multihomed ES, which started the Maximum Response Time and has no
   local IGMP Membership Request (x,G) state and no installed IGMP Membership Report
   Synch routes,
   removes the IGMP Membership Request (x,G) state for that (ES,BD).  If the DF no
   longer has the IGMP Membership Request (x,G) state for that BD on any ES for which it
   is the DF, it withdraws its SMET route for that (x,G) group in that BD.<a class="pilcrow" href="#section-6.2.2-3">¶</a></p>
</section>
</section>
<section id="section-6.3">
        <h3 id="name-mass-withdraw-of-the-multic">
<a class="section-number selfRef" href="#section-6.3">6.3. </a><a class="section-name selfRef" href="#name-mass-withdraw-of-the-multic">Mass Withdraw of the Multicast Membership Report Synch Route in Case of Failure</a>
        </h3>
<p id="section-6.3-1">A PE that has received an IGMP Membership Request would have synced the IGMP
 Membership Report by the procedure defined in <a class="xref" href="#local-igmp-mld">Section 6.1</a>. If a PE with the local Membership Report
 state goes down or the PE to CE link goes down, it would lead to a
 mass withdraw of multicast routes. Remote PEs (PEs where these routes
 were remote IGMP Membership Reports) <span class="bcp14">SHOULD NOT</span> remove the state immediately;
 instead, General Query <span class="bcp14">SHOULD</span> be generated to refresh the states.
 There are several ways to detect failure at a
 peer, e.g., using IGP next-hop tracking or ES route withdraw.<a class="pilcrow" href="#section-6.3-1">¶</a></p>
</section>
</section>
<section id="section-7">
      <h2 id="name-single-active-multihoming">
<a class="section-number selfRef" href="#section-7">7. </a><a class="section-name selfRef" href="#name-single-active-multihoming">Single-Active Multihoming</a>
      </h2>
<p id="section-7-1">Note that to facilitate state synchronization after failover, the PEs
      attached to a multihomed ES operating in Single-Active redundancy mode
      <span class="bcp14">SHOULD</span> also coordinate the IGMP Membership Report (x,G) state.
      In this case, all IGMP
      Membership Report messages are received by the DF and distributed to the non-DF
      PEs using the procedures described above.<a class="pilcrow" href="#section-7-1">¶</a></p>
</section>
<section id="section-8">
      <h2 id="name-selective-multicast-procedu">
<a class="section-number selfRef" href="#section-8">8. </a><a class="section-name selfRef" href="#name-selective-multicast-procedu">Selective Multicast Procedures for IR Tunnels</a>
      </h2>
<p id="section-8-1">If an ingress PE uses ingress replication, then for a given (x,G)
      group in a given BD:<a class="pilcrow" href="#section-8-1">¶</a></p>
<ol class="normal type-1" id="section-8-2" start="1" type="1">
 <li id="section-8-2.1">It sends (x,G) traffic to the set of PEs not supporting IGMP or MLD 
 Proxies. This set consists of any PE that has advertised an Inclusive Multicast
 Ethernet Tag (IMET) route for the BD 
 without a  Multicast Flags Extended Community or with a Multicast Flags Extended 
 Community in which neither the IGMP Proxy support nor the  MLD Proxy support flags are set.<a class="pilcrow" href="#section-8-2.1">¶</a>
</li>
        <li id="section-8-2.2">It sends (x,G) traffic to the set of PEs supporting IGMP or MLD Proxies
 and has listeners for that (x,G) group in that BD. This set consists of any PE
 that has advertised an IMET route for the BD 
 with a Multicast Flags Extended Community in which the IGMP Proxy support and/or 
 the  MLD Proxy support flags are set and that has advertised a SMET route for that (x,G) 
 group in that BD.<a class="pilcrow" href="#section-8-2.2">¶</a>
</li>
      </ol>
</section>
<div id="bgp-encoding">
<section id="section-9">
      <h2 id="name-bgp-encoding">
<a class="section-number selfRef" href="#section-9">9. </a><a class="section-name selfRef" href="#name-bgp-encoding">BGP Encoding</a>
      </h2>
<p id="section-9-1">This document defines three new BGP EVPN routes to carry IGMP
      Membership Reports. The route types are known as:<a class="pilcrow" href="#section-9-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-9-2">
        <dt id="section-9-2.1">6 -</dt>
        <dd id="section-9-2.2" style="margin-left: 1.5em">Selective Multicast Ethernet Tag Route<a class="pilcrow" href="#section-9-2.2">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-9-2.3">7 -</dt>
        <dd id="section-9-2.4" style="margin-left: 1.5em">Multicast Membership Report Synch Route<a class="pilcrow" href="#section-9-2.4">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-9-2.5">8 -</dt>
        <dd id="section-9-2.6" style="margin-left: 1.5em">Multicast Leave Synch Route<a class="pilcrow" href="#section-9-2.6">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-9-3">The detailed encoding and procedures for these route types are
      described in subsequent sections.<a class="pilcrow" href="#section-9-3">¶</a></p>
<div id="SMET">
<section id="section-9.1">
        <h3 id="name-selective-multicast-etherne">
<a class="section-number selfRef" href="#section-9.1">9.1. </a><a class="section-name selfRef" href="#name-selective-multicast-etherne">Selective Multicast Ethernet Tag Route</a>
        </h3>
<p id="section-9.1-1">A SMET route-type-specific EVPN NLRI
 consists of the following:<a class="pilcrow" href="#section-9.1-1">¶</a></p>
<div class="alignCenter art-text artwork" id="section-9.1-2">
<pre>+---------------------------------------+
|  RD (8 octets)                        |
+---------------------------------------+
|  Ethernet Tag ID (4 octets)           |
+---------------------------------------+
|  Multicast Source Length (1 octet)    |
+---------------------------------------+
|  Multicast Source Address (variable)  |
+---------------------------------------+
|  Multicast Group Length (1 octet)     |
+---------------------------------------+
|  Multicast Group Address (Variable)   |
+---------------------------------------+
|  Originator Router Length (1 octet)   |
+---------------------------------------+
|  Originator Router Address (variable) |
+---------------------------------------+
|  Flags (1 octet)                      |
+---------------------------------------+
</pre><a class="pilcrow" href="#section-9.1-2">¶</a>
</div>
<p id="section-9.1-3">For the purpose of BGP route key processing, all the fields are
 considered to be part of the prefix in the NLRI, except for the 1-octet
 Flags field. The Flags fields are defined as follows:<a class="pilcrow" href="#section-9.1-3">¶</a></p>
<div class="alignCenter art-text artwork" id="section-9.1-4">
<pre>  0  1  2  3  4  5  6  7
+--+--+--+--+--+--+--+--+
| reserved  |IE|v3|v2|v1|
+--+--+--+--+--+--+--+--+
</pre><a class="pilcrow" href="#section-9.1-4">¶</a>
</div>
<ul class="normal">
<li class="normal" id="section-9.1-5.1">The least significant bit (bit 7) indicates support for IGMP version
   1. Since IGMPv1 is being deprecated, the sender <span class="bcp14">MUST</span> set
   it to 0 for IGMP and the receiver <span class="bcp14">MUST</span> ignore it.<a class="pilcrow" href="#section-9.1-5.1">¶</a>
</li>
          <li class="normal" id="section-9.1-5.2">The second least significant bit (bit 6) indicates support for IGMP
   version 2.<a class="pilcrow" href="#section-9.1-5.2">¶</a>
</li>
          <li class="normal" id="section-9.1-5.3">The third least significant bit (bit 5) indicates support for IGMP
   version 3.<a class="pilcrow" href="#section-9.1-5.3">¶</a>
</li>
          <li class="normal" id="section-9.1-5.4">The fourth least significant bit (bit 4) indicates whether the (S,G)
   information carried within the route type is of an Include Group type
   (bit value 0) or an Exclude Group type (bit value 1). The Exclude
   Group type bit <span class="bcp14">MUST</span> be ignored if bit 5 is not set.<a class="pilcrow" href="#section-9.1-5.4">¶</a>
</li>
          <li class="normal" id="section-9.1-5.5">This EVPN route type is used to carry tenant IGMP multicast group
   information. The Flags field assists in distributing the IGMP Membership
   Report of a given host for a given multicast route. The version
   bits help associate the IGMP version of receivers participating within 
   the EVPN domain.<a class="pilcrow" href="#section-9.1-5.5">¶</a>
</li>
          <li class="normal" id="section-9.1-5.6">The IE bit helps in creating filters for a given
   multicast route.<a class="pilcrow" href="#section-9.1-5.6">¶</a>
</li>
          <li class="normal" id="section-9.1-5.7">If the route is used for IPv6 (MLD), then bit 7 indicates support for MLD
   version 1. The second least significant bit (bit 6) indicates support
   for MLD version 2. Since there is no MLD version 3, in case of IPv6
   routes, the third least significant bit <span class="bcp14">MUST</span> be 0. In case of IPv6 routes,
   the fourth least significant bit <span class="bcp14">MUST</span> be ignored if bit 6 is not
   set.<a class="pilcrow" href="#section-9.1-5.7">¶</a>
</li>
          <li class="normal" id="section-9.1-5.8"> Reserved bits <span class="bcp14">MUST</span> be set to 0 by the sender, and the receiver
   <span class="bcp14">MUST</span> ignore the Reserved bits.<a class="pilcrow" href="#section-9.1-5.8">¶</a>
</li>
        </ul>
<section id="section-9.1.1">
          <h4 id="name-constructing-the-selective-">
<a class="section-number selfRef" href="#section-9.1.1">9.1.1. </a><a class="section-name selfRef" href="#name-constructing-the-selective-">Constructing the Selective Multicast Ethernet Tag Route</a>
          </h4>
<p id="section-9.1.1-1">This section describes the procedures used to construct the SMET route.<a class="pilcrow" href="#section-9.1.1-1">¶</a></p>
<p id="section-9.1.1-2">The Route Distinguisher (RD) <span class="bcp14">SHOULD</span> be a Type 1 RD <span>[<a class="xref" href="#RFC4364">RFC4364</a>]</span>.  The
   value field comprises an IP address of the PE (typically, the
   loopback address), followed by a number unique to the PE.<a class="pilcrow" href="#section-9.1.1-2">¶</a></p>
<p id="section-9.1.1-3">The Ethernet Tag ID <span class="bcp14">MUST</span> be set, as per the procedure
   defined in <span>[<a class="xref" href="#RFC7432">RFC7432</a>]</span>.<a class="pilcrow" href="#section-9.1.1-3">¶</a></p>
<p id="section-9.1.1-4">The Multicast Source Length <span class="bcp14">MUST</span> be set to the length of the Multicast
   Source Address in bits. If the Multicast Source Address field
   contains an IPv4 address, then the value of the Multicast Source
   Length field is 32. If the Multicast Source Address field contains an
   IPv6 address, then the value of the Multicast Source Length field is
   128. In case of a (*,G) Membership Report, the Multicast Source Length is set to
   0.<a class="pilcrow" href="#section-9.1.1-4">¶</a></p>
<p id="section-9.1.1-5">The Multicast Source Address is the source IP address from the IGMP
   Membership Report.
   In case of a (*,G) Membership Report, this field is not used.<a class="pilcrow" href="#section-9.1.1-5">¶</a></p>
<p id="section-9.1.1-6">The Multicast Group Length <span class="bcp14">MUST</span> be set to the length of the Multicast Group
   Address in bits. If the Multicast Group Address  field contains an
   IPv4 address, then the value of the Multicast Group Length field is
   32.  If the Multicast Group Address field contains an IPv6 address,
   then the value of the Multicast Group Length field is 128.<a class="pilcrow" href="#section-9.1.1-6">¶</a></p>
<p id="section-9.1.1-7">The Multicast Group Address is the group address from the IGMP or MLD
   Membership Report.<a class="pilcrow" href="#section-9.1.1-7">¶</a></p>
<p id="section-9.1.1-8">The Originator Router Length is the length of the Originator Router
   Address in bits.<a class="pilcrow" href="#section-9.1.1-8">¶</a></p>
<p id="section-9.1.1-9">The Originator Router Address is the IP address of the router originating this route. 
   The SMET Originator Router IP address <span class="bcp14">MUST</span> match that of the IMET (or
   S-PMSI Authentic Data (AD))
   route originated for the same EVI by the same downstream PE.<a class="pilcrow" href="#section-9.1.1-9">¶</a></p>
<p id="section-9.1.1-10">The Flags field indicates the version of IGMP from which the
   Membership Report was received. It also indicates whether the
   multicast group had the Include/Exclude bit set.<a class="pilcrow" href="#section-9.1.1-10">¶</a></p>
<p id="section-9.1.1-11"> Reserved bits <span class="bcp14">MUST</span> be set to 0. They can be defined
   by other documents in the future.<a class="pilcrow" href="#section-9.1.1-11">¶</a></p>
<p id="section-9.1.1-12">IGMP is used to receive group membership information from hosts
   by Top-of-the-Rack (ToR) switches. Upon receiving the host's expression of interest in a
   particular group membership, this information is then forwarded using the
   SMET route. The NLRI also keeps track
   of the receiver's IGMP version and any source filtering for a
   given group membership. All EVPN SMET routes are announced per EVI
   Route Target extended communities (EVI-RT ECs).<a class="pilcrow" href="#section-9.1.1-12">¶</a></p>
</section>
<section id="section-9.1.2">
          <h4 id="name-reconstructing-igmp-mld-mem">
<a class="section-number selfRef" href="#section-9.1.2">9.1.2. </a><a class="section-name selfRef" href="#name-reconstructing-igmp-mld-mem">Reconstructing IGMP/MLD Membership Reports from the Selective Multicast Route</a>
          </h4>
<p id="section-9.1.2-1">  This section describes the procedures used to reconstruct IGMP/MLD Membership
   Reports from the SMET route.<a class="pilcrow" href="#section-9.1.2-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.1.2-2.1"> If the Multicast Group Length is 32, the route is
     translated to the IGMP Membership Request. If the Multicast Group
     Length is 128, the route is translated to an MLD
     Membership Request.<a class="pilcrow" href="#section-9.1.2-2.1">¶</a>
</li>
            <li class="normal" id="section-9.1.2-2.2">The Multicast Group Address field is translated to
     the IGMP/MLD group address.<a class="pilcrow" href="#section-9.1.2-2.2">¶</a>
</li>
            <li class="normal" id="section-9.1.2-2.3"> If the Multicast Source Length is set to 0, it is
     translated to any source (*).
            If the Multicast Source Length is non-zero, the Multicast Source
     Address field is translated to the IGMP/MLD source address.<a class="pilcrow" href="#section-9.1.2-2.3">¶</a>
</li>
            <li class="normal" id="section-9.1.2-2.4"> If flag bit 7 is set, it translates the Membership Report to be
     IGMPv1 or MLDv1.<a class="pilcrow" href="#section-9.1.2-2.4">¶</a>
</li>
            <li class="normal" id="section-9.1.2-2.5"> If flag bit 6 is set, it translates the Membership Report to be
     IGMPv2 or MLDv2.<a class="pilcrow" href="#section-9.1.2-2.5">¶</a>
</li>
            <li class="normal" id="section-9.1.2-2.6"> Flag bit 5 is only valid for the IGMP Membership Report; if it is
     set, it translates to the IGMPv3 report.<a class="pilcrow" href="#section-9.1.2-2.6">¶</a>
</li>
            <li class="normal" id="section-9.1.2-2.7"> If the IE flag is set, it translates to the IGMP/MLD Exclude
     mode Membership Report. If the IE flag is not set (0), it
     translates to the Include mode Membership Report.<a class="pilcrow" href="#section-9.1.2-2.7">¶</a>
</li>
          </ul>
</section>
<section id="section-9.1.3">
          <h4 id="name-default-selective-multicast">
<a class="section-number selfRef" href="#section-9.1.3">9.1.3. </a><a class="section-name selfRef" href="#name-default-selective-multicast">Default Selective Multicast Route</a>
          </h4>
<p id="section-9.1.3-1">If there is a multicast router connected behind the EVPN domain, the PE
   <span class="bcp14">MAY</span> originate a default SMET (*,*) to get all multicast traffic in
   the domain.<a class="pilcrow" href="#section-9.1.3-1">¶</a></p>
<span id="name-multicast-router-behind-the"></span><div id="EVPN-domain">
<figure id="figure-2">
            <div class="alignCenter art-text artwork" id="section-9.1.3-2.1">
<pre>                       +--------------+
                       |              |
                       |              |
                       |              | +----+
                       |              | |    |---- H1(*,G1)v2
                       |   IP/MPLS    | | PE1|---- H2(S2,G2)v3
                       |   Network    | |    |---- S2
                       |              | |    |
                       |              | +----+
                       |              |
                +----+ |              |
+----+          |    | |              |
|    |    S1 ---| PE2| |              |
|PIM |----R1 ---|    | |              |
|ASM |          +----+ |              |
|    |                 |              |
+----+                 +--------------+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-2">Figure 2</a>:
<a class="selfRef" href="#name-multicast-router-behind-the">Multicast Router behind the EVPN Domain</a>
            </figcaption></figure>
</div>
<p id="section-9.1.3-3">Consider the EVPN network in <a class="xref" href="#EVPN-domain">Figure 2</a>, where there is an EVPN
    instance configured across the PEs. Let's consider that PE2 is connected to
    multicast router R1 and there is a network running PIM ASM behind R1.
    If there are receivers behind the PIM ASM network, the PIM Join would
    be forwarded to the PIM Rendezvous Point (RP). If receivers behind the
    PIM ASM network are interested in a multicast flow originated by
    multicast source S2 (behind PE1), it is necessary for PE2 to receive
    multicast traffic. In this case, PE2 <span class="bcp14">MUST</span> originate a (*,*) SMET route
    to receive all of the multicast traffic in the EVPN domain. To generate 
    wildcard (*,*) routes, the procedure from <span>[<a class="xref" href="#RFC6625">RFC6625</a>]</span>
            <span class="bcp14">MUST</span> be used.<a class="pilcrow" href="#section-9.1.3-3">¶</a></p>
</section>
</section>
</div>
<section id="section-9.2">
        <h3 id="name-multicast-membership-report">
<a class="section-number selfRef" href="#section-9.2">9.2. </a><a class="section-name selfRef" href="#name-multicast-membership-report">Multicast Membership Report Synch Route</a>
        </h3>
<p id="section-9.2-1">This EVPN route type is used to coordinate the IGMP Membership Report (x,G)
 state for a given BD between the PEs attached to a given ES operating in
 All-Active (or Single-Active) redundancy mode, and it consists of the
 following:<a class="pilcrow" href="#section-9.2-1">¶</a></p>
<div class="alignCenter art-text artwork" id="section-9.2-2">
<pre>+--------------------------------------------------+
|  RD (8 octets)                                   |
+--------------------------------------------------+
|  Ethernet Segment Identifier (10 octets)         |
+--------------------------------------------------+
|  Ethernet Tag ID  (4 octets)                     |
+--------------------------------------------------+
|  Multicast Source Length (1 octet)               |
+--------------------------------------------------+
|  Multicast Source Address (variable)             |
+--------------------------------------------------+
|  Multicast Group Length (1 octet)                |
+--------------------------------------------------+
|  Multicast Group Address (Variable)              |
+--------------------------------------------------+
|  Originator Router Length (1 octet)              |
+--------------------------------------------------+
|  Originator Router Address (variable)            |
+--------------------------------------------------+
|  Flags (1 octet)                                 |
+--------------------------------------------------+
</pre><a class="pilcrow" href="#section-9.2-2">¶</a>
</div>
<p id="section-9.2-3">For the purpose of BGP route key processing, all the fields are
 considered to be part of the prefix in the NLRI, except for the 1-octet
 Flags field, whose fields are defined as follows:<a class="pilcrow" href="#section-9.2-3">¶</a></p>
<div class="alignCenter art-text artwork" id="section-9.2-4">
<pre>  0  1  2  3  4  5  6  7
+--+--+--+--+--+--+--+--+
| reserved  |IE|v3|v2|v1|
+--+--+--+--+--+--+--+--+
</pre><a class="pilcrow" href="#section-9.2-4">¶</a>
</div>
<ul class="normal">
<li class="normal" id="section-9.2-5.1"> The least significant bit (bit 7) indicates support for IGMP version 1.<a class="pilcrow" href="#section-9.2-5.1">¶</a>
</li>
          <li class="normal" id="section-9.2-5.2"> The second least significant bit (bit 6) indicates support for IGMP version 2.<a class="pilcrow" href="#section-9.2-5.2">¶</a>
</li>
          <li class="normal" id="section-9.2-5.3"> The third least significant bit (bit 5) indicates support for IGMP version 3.<a class="pilcrow" href="#section-9.2-5.3">¶</a>
</li>
          <li class="normal" id="section-9.2-5.4"> The fourth least significant bit (bit 4) indicates whether the (S, G) information 
   carried within the route type is of an Include Group type (bit value 0) or an Exclude Group
   type (bit value 1). The Exclude Group type bit <span class="bcp14">MUST</span> be ignored if bit 5 is
   not set.<a class="pilcrow" href="#section-9.2-5.4">¶</a>
</li>
          <li class="normal" id="section-9.2-5.5"> Reserved bits <span class="bcp14">MUST</span> be set to 0.<a class="pilcrow" href="#section-9.2-5.5">¶</a>
</li>
        </ul>
<p id="section-9.2-6">The Flags field assists in distributing the IGMP Membership Report of a 
 given host for a given multicast route. The version bits help 
 associate the IGMP version of receivers participating within the EVPN
 domain.  The Include/Exclude bit helps in creating filters for a
 given multicast route.<a class="pilcrow" href="#section-9.2-6">¶</a></p>
<p id="section-9.2-7">If the route is being prepared for IPv6 (MLD), then bit 7 indicates
 support for MLD version 1. The second least significant bit (bit 6)
 indicates support for MLD version 2. Since there is no MLD version 3,
 in case of the IPv6 route, the third least significant bit <span class="bcp14">MUST</span>
 be 0. In case of the IPv6 route, the fourth least significant bit <span class="bcp14">MUST</span>
 be ignored if bit 6 is not set.<a class="pilcrow" href="#section-9.2-7">¶</a></p>
<section id="section-9.2.1">
          <h4 id="name-constructing-the-multicast-">
<a class="section-number selfRef" href="#section-9.2.1">9.2.1. </a><a class="section-name selfRef" href="#name-constructing-the-multicast-">Constructing the Multicast Membership Report Synch Route</a>
          </h4>
<p id="section-9.2.1-1">This section describes the procedures used to construct the IGMP Membership Report
   Synch route.  Support for these route types is optional. If a PE does
   not support this route, then it <span class="bcp14">MUST NOT</span> indicate that it supports
   "IGMP Proxy" in the Multicast Flags Extended Community for the EVIs
   corresponding to its multihomed ESs.<a class="pilcrow" href="#section-9.2.1-1">¶</a></p>
<p id="section-9.2.1-2">An IGMP Membership Report Synch route <span class="bcp14">MUST</span> carry exactly one
   ES-Import Route
   Target extended community, i.e., the one that corresponds to the ES on
   which the IGMP Membership Report was received.  It <span class="bcp14">MUST</span> also carry
   exactly one EVI-RT EC, i.e., the one that corresponds to the EVI on
   which the IGMP Membership Report
   was received.  See <a class="xref" href="#evi-rt">Section 9.5</a> for details on how to
   encode and construct the EVI-RT EC.<a class="pilcrow" href="#section-9.2.1-2">¶</a></p>
<p id="section-9.2.1-3">The RD <span class="bcp14">SHOULD</span> be Type 1 <span>[<a class="xref" href="#RFC4364">RFC4364</a>]</span>.  The
   value field comprises an IP address of the PE (typically, the
   loopback address), followed by a number unique to the PE.<a class="pilcrow" href="#section-9.2.1-3">¶</a></p>
<p id="section-9.2.1-4">The Ethernet Segment Identifier (ESI) <span class="bcp14">MUST</span> be set to the 10-octet 
   value defined for the ES.<a class="pilcrow" href="#section-9.2.1-4">¶</a></p>
<p id="section-9.2.1-5">The Ethernet Tag ID <span class="bcp14">MUST</span> be set, as per the procedure defined in
   <span>[<a class="xref" href="#RFC7432">RFC7432</a>]</span>.<a class="pilcrow" href="#section-9.2.1-5">¶</a></p>
<p id="section-9.2.1-6">The Multicast Source Length <span class="bcp14">MUST</span> be set to the
   length of the Multicast Source
   Address in bits. If the Multicast Source field contains an IPv4
   address, then the value of the Multicast Source Length field is 32.
   If the Multicast Source field contains an IPv6 address, then the
   value of the Multicast Source Length field is 128. In case of a (*,G) 
   Membership Report, the Multicast Source Length is set to 0.<a class="pilcrow" href="#section-9.2.1-6">¶</a></p>
<p id="section-9.2.1-7">The Multicast Source is the source IP address of the IGMP Membership
   Report.  In case of a (*,G) Membership Report, this field does not exist.<a class="pilcrow" href="#section-9.2.1-7">¶</a></p>
<p id="section-9.2.1-8">The Multicast Group Length <span class="bcp14">MUST</span> be set to the length of the
   Multicast Group
   Address in bits. If the Multicast Group field contains an IPv4
   address, then the value of the Multicast Group Length field is 32.
   If the Multicast Group field contains an IPv6 address, then the value
   of the Multicast Group Length field is 128.<a class="pilcrow" href="#section-9.2.1-8">¶</a></p>
<p id="section-9.2.1-9">The Multicast Group is the group address of the IGMP Membership
   Report.<a class="pilcrow" href="#section-9.2.1-9">¶</a></p>
<p id="section-9.2.1-10">The Originator Router Length is the length of the Originator Router
   Address in bits.<a class="pilcrow" href="#section-9.2.1-10">¶</a></p>
<p id="section-9.2.1-11">The Originator Router Address is the IP address of the router originating the prefix.<a class="pilcrow" href="#section-9.2.1-11">¶</a></p>
<p id="section-9.2.1-12">The Flags field indicates the version of IGMP from which the 
   Membership Report was received. It also indicates whether the
   multicast group had the Include/Exclude bit set.<a class="pilcrow" href="#section-9.2.1-12">¶</a></p>
<p id="section-9.2.1-13"> Reserved bits <span class="bcp14">MUST</span> be set to 0.<a class="pilcrow" href="#section-9.2.1-13">¶</a></p>
</section>
<section id="section-9.2.2">
          <h4 id="name-reconstructing-igmp-mld-memb">
<a class="section-number selfRef" href="#section-9.2.2">9.2.2. </a><a class="section-name selfRef" href="#name-reconstructing-igmp-mld-memb">Reconstructing IGMP/MLD Membership Reports from a Multicast Membership
   Report Synch Route</a>
          </h4>
<p id="section-9.2.2-1">  This section describes the procedures used to reconstruct IGMP/MLD
   Membership Reports from the Multicast Membership Report Synch route.<a class="pilcrow" href="#section-9.2.2-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.2.2-2.1"> If the Multicast Group Length is 32, the route is translated
     to the IGMP Membership Request. If the Multicast Group Length is 128,
     the route is translated to an MLD Membership Request.<a class="pilcrow" href="#section-9.2.2-2.1">¶</a>
</li>
            <li class="normal" id="section-9.2.2-2.2"> The Multicast Group Address field is translated to the
     IGMP/MLD group address.<a class="pilcrow" href="#section-9.2.2-2.2">¶</a>
</li>
            <li class="normal" id="section-9.2.2-2.3"> If the Multicast Source Length is set to 0, it is translated to
     any source (*). If the Multicast Source Length is non-zero, the
     Multicast Source
     Address field is translated to the IGMP/MLD source address.<a class="pilcrow" href="#section-9.2.2-2.3">¶</a>
</li>
            <li class="normal" id="section-9.2.2-2.4"> If flag bit 7 is set, it translates the Membership Report to be
     IGMPv1 or MLDv1.<a class="pilcrow" href="#section-9.2.2-2.4">¶</a>
</li>
            <li class="normal" id="section-9.2.2-2.5"> If flag bit 6 is set, it translates the Membership Report to be
     IGMPv2 or MLDv2.<a class="pilcrow" href="#section-9.2.2-2.5">¶</a>
</li>
            <li class="normal" id="section-9.2.2-2.6"> Flag bit 5 is only valid for the IGMP Membership Report; if it is
     set, it translates to the IGMPv3 report.<a class="pilcrow" href="#section-9.2.2-2.6">¶</a>
</li>
            <li class="normal" id="section-9.2.2-2.7"> If the IE flag is set, it translates to the IGMP/MLD Exclude mode
     Membership Report. If the IE flag is not set (0), it translates to the
     Include mode Membership Report.<a class="pilcrow" href="#section-9.2.2-2.7">¶</a>
</li>
          </ul>
</section>
</section>
<section id="section-9.3">
        <h3 id="name-multicast-leave-synch-route">
<a class="section-number selfRef" href="#section-9.3">9.3. </a><a class="section-name selfRef" href="#name-multicast-leave-synch-route">Multicast Leave Synch Route</a>
        </h3>
<p id="section-9.3-1">This EVPN route type is used to coordinate the IGMP Leave Group (x,G)
 state for a given BD between the PEs attached to a given ES operating
 in an All-Active (or Single-Active) redundancy mode, and it consists of the
 following:<a class="pilcrow" href="#section-9.3-1">¶</a></p>
<div class="alignCenter art-text artwork" id="section-9.3-2">
<pre>+--------------------------------------------------+
|  RD (8 octets)                                   |
+--------------------------------------------------+
|  Ethernet Segment Identifier (10 octets)         |
+--------------------------------------------------+
|  Ethernet Tag ID  (4 octets)                     |
+--------------------------------------------------+
|  Multicast Source Length (1 octet)               |
+--------------------------------------------------+
|  Multicast Source Address (variable)             |
+--------------------------------------------------+
|  Multicast Group Length (1 octet)                |
+--------------------------------------------------+
|  Multicast Group Address (Variable)              |
+--------------------------------------------------+
|  Originator Router Length (1 octet)              |
+--------------------------------------------------+
|  Originator Router Address (variable)            |
+--------------------------------------------------+
|  Reserved (4 octets)                             |
+--------------------------------------------------+
|  Maximum Response Time (1 octet)                 |
+--------------------------------------------------+
|  Flags (1 octet)                                 |
+--------------------------------------------------+
</pre><a class="pilcrow" href="#section-9.3-2">¶</a>
</div>
<p id="section-9.3-3">For the purpose of BGP route key processing, all the fields are
 considered to be part of the prefix in the NLRI, except for the Reserved, 
 Maximum Response Time, and 1-octet Flags fields, which are defined as follows:<a class="pilcrow" href="#section-9.3-3">¶</a></p>
<div class="alignCenter art-text artwork" id="section-9.3-4">
<pre>  0  1  2  3  4  5  6  7
+--+--+--+--+--+--+--+--+
| reserved  |IE|v3|v2|v1|
+--+--+--+--+--+--+--+--+
</pre><a class="pilcrow" href="#section-9.3-4">¶</a>
</div>
<ul class="normal">
<li class="normal" id="section-9.3-5.1">  The least significant bit (bit 7) indicates support for IGMP version 1.<a class="pilcrow" href="#section-9.3-5.1">¶</a>
</li>
          <li class="normal" id="section-9.3-5.2">  The second least significant bit (bit 6) indicates support for IGMP version 2.<a class="pilcrow" href="#section-9.3-5.2">¶</a>
</li>
          <li class="normal" id="section-9.3-5.3">  The third least significant bit (bit 5) indicates support for IGMP version 3.<a class="pilcrow" href="#section-9.3-5.3">¶</a>
</li>
          <li class="normal" id="section-9.3-5.4">  The fourth least significant bit (bit 4) indicates whether the (S, G) information
   carried within the route type is of an Include Group type (bit value 0) or an Exclude Group
   type (bit value 1). The Exclude Group type bit <span class="bcp14">MUST</span> be ignored if bit 5
   is not set.<a class="pilcrow" href="#section-9.3-5.4">¶</a>
</li>
          <li class="normal" id="section-9.3-5.5"> Reserved bits <span class="bcp14">MUST</span> be set to 0. They can be defined by
   other documents in the future.<a class="pilcrow" href="#section-9.3-5.5">¶</a>
</li>
        </ul>
<p id="section-9.3-6">The Flags field assists in distributing the IGMP Membership Report of a
 given host for a given multicast route. The version bits help
 associate the IGMP version of the receivers participating within the EVPN
 domain.  The Include/Exclude bit helps in creating filters for a
 given multicast route.<a class="pilcrow" href="#section-9.3-6">¶</a></p>
<p id="section-9.3-7">If the route is being prepared for IPv6 (MLD), then bit 7 indicates 
 support for MLD version 1. The second least significant bit (bit 6)
 indicates support for MLD version 2. Since there is no MLD version 3,
 in case of the IPv6 route, the third least significant bit <span class="bcp14">MUST</span> be 0. In case
 of the IPv6 route, the fourth least significant bit <span class="bcp14">MUST</span> be ignored if
 bit 6 is not set.<a class="pilcrow" href="#section-9.3-7">¶</a></p>
<p id="section-9.3-8"> Reserved bits in the flag <span class="bcp14">MUST</span> be set to 0. They can be
 defined by other documents in the future.<a class="pilcrow" href="#section-9.3-8">¶</a></p>
<section id="section-9.3.1">
          <h4 id="name-constructing-the-multicast-l">
<a class="section-number selfRef" href="#section-9.3.1">9.3.1. </a><a class="section-name selfRef" href="#name-constructing-the-multicast-l">Constructing the Multicast Leave Synch Route</a>
          </h4>
<p id="section-9.3.1-1">This section describes the procedures used to construct the IGMP
   Leave Synch route.  Support for these route types is optional. If a PE
   does not support this route, then it <span class="bcp14">MUST NOT</span> indicate that it
   supports "IGMP Proxy" in the Multicast Flags Extended Community for the
   EVIs corresponding to its multihomed Ethernet segments.<a class="pilcrow" href="#section-9.3.1-1">¶</a></p>
<p id="section-9.3.1-2">An IGMP Leave Synch route <span class="bcp14">MUST</span> carry exactly one ES-Import Route
   Target extended community, i.e., the one that corresponds to the ES on
   which the IGMP Leave was received.  It <span class="bcp14">MUST</span> also carry exactly one
   EVI-RT EC, i.e., the one that corresponds to the EVI on which the IGMP
   Leave was received.  See <a class="xref" href="#evi-rt">Section 9.5</a> for details on how to form the
   EVI-RT EC.<a class="pilcrow" href="#section-9.3.1-2">¶</a></p>
<p id="section-9.3.1-3">The RD <span class="bcp14">SHOULD</span> be Type 1 <span>[<a class="xref" href="#RFC4364">RFC4364</a>]</span>.  The
   value field comprises an IP address of the PE (typically, the
   loopback address), followed by a number unique to the PE.<a class="pilcrow" href="#section-9.3.1-3">¶</a></p>
<p id="section-9.3.1-4">The ESI <span class="bcp14">MUST</span> be set to the 10-octet 
   value defined for the ES.<a class="pilcrow" href="#section-9.3.1-4">¶</a></p>
<p id="section-9.3.1-5">The Ethernet Tag ID <span class="bcp14">MUST</span> be set, as per the procedure
   defined in <span>[<a class="xref" href="#RFC7432">RFC7432</a>]</span>.<a class="pilcrow" href="#section-9.3.1-5">¶</a></p>
<p id="section-9.3.1-6">The Multicast Source Length <span class="bcp14">MUST</span> be set to the length
   of the Multicast Source
   Address in bits. If the Multicast Source field contains an IPv4
   address, then the value of the Multicast Source Length field is 32.
   If the Multicast Source field contains an IPv6 address, then the
   value of the Multicast Source Length field is 128. In case of a (*,G)
   Membership Report, the Multicast Source Length is set to 0.<a class="pilcrow" href="#section-9.3.1-6">¶</a></p>
<p id="section-9.3.1-7">The Multicast Source is the source IP address of the IGMP Membership
   Report.  In case of a (*,G) Membership Report, this field does not exist.<a class="pilcrow" href="#section-9.3.1-7">¶</a></p>
<p id="section-9.3.1-8">The Multicast Group Length <span class="bcp14">MUST</span> be set to the length of the
   Multicast Group
   Address in bits. If the Multicast Group field contains an IPv4
   address, then the value of the Multicast Group Length field is 32.
   If the Multicast Group field contains an IPv6 address, then the value
   of the Multicast Group Length field is 128.<a class="pilcrow" href="#section-9.3.1-8">¶</a></p>
<p id="section-9.3.1-9">The Multicast Group is the group address of the IGMP Membership Report.<a class="pilcrow" href="#section-9.3.1-9">¶</a></p>
<p id="section-9.3.1-10">The Originator Router Length is the length of the Originator Router Address
   in bits.<a class="pilcrow" href="#section-9.3.1-10">¶</a></p>
<p id="section-9.3.1-11">The Originator Router Address is the IP address of the router
   originating the prefix.<a class="pilcrow" href="#section-9.3.1-11">¶</a></p>
<p id="section-9.3.1-12"> The Reserved field is not part of the route key. The originator <span class="bcp14">MUST</span> set
   the Reserved field to 0;
   the receiver <span class="bcp14">SHOULD</span> ignore it, and if it needs to be propagated, it
   <span class="bcp14">MUST</span> propagate it unchanged.<a class="pilcrow" href="#section-9.3.1-12">¶</a></p>
<p id="section-9.3.1-13"> The Maximum Response Time is the value to be used while sending a query, as defined in
   <span>[<a class="xref" href="#RFC2236">RFC2236</a>]</span>.<a class="pilcrow" href="#section-9.3.1-13">¶</a></p>
<p id="section-9.3.1-14">The Flags field indicates the version of IGMP from which the 
   Membership Report was received. It also indicates whether the
   multicast group had an Include/Exclude bit set.<a class="pilcrow" href="#section-9.3.1-14">¶</a></p>
</section>
<section id="section-9.3.2">
          <h4 id="name-reconstructing-igmp-mld-lea">
<a class="section-number selfRef" href="#section-9.3.2">9.3.2. </a><a class="section-name selfRef" href="#name-reconstructing-igmp-mld-lea">Reconstructing IGMP/MLD Leave from a Multicast Leave Synch Route</a>
          </h4>
<p id="section-9.3.2-1">This section describes the procedures used to reconstruct IGMP/MLD Leave from
   the Multicast Leave Synch route.<a class="pilcrow" href="#section-9.3.2-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.3.2-2.1"> If the Multicast Group Length is 32, the route is translated
     to IGMP Leave. If the
     Multicast Group Length is 128, the route is translated to MLD
     Leave.<a class="pilcrow" href="#section-9.3.2-2.1">¶</a>
</li>
            <li class="normal" id="section-9.3.2-2.2"> The Multicast Group Address field is translated to an
     IGMP/MLD group address.<a class="pilcrow" href="#section-9.3.2-2.2">¶</a>
</li>
            <li class="normal" id="section-9.3.2-2.3"> If the Multicast Source Length is set to 0, it is
     translated to any source (*).
            If the Multicast Source Length is non-zero, the Multicast Source
     Address field is translated to the IGMP/MLD source address.<a class="pilcrow" href="#section-9.3.2-2.3">¶</a>
</li>
            <li class="normal" id="section-9.3.2-2.4"> If flag bit 7 is set, it translates the Membership Report to be
     IGMPv1 or MLDv1.<a class="pilcrow" href="#section-9.3.2-2.4">¶</a>
</li>
            <li class="normal" id="section-9.3.2-2.5"> If flag bit 6 is set, it translates the Membership Report to be
     IGMPv2 or MLDv2.<a class="pilcrow" href="#section-9.3.2-2.5">¶</a>
</li>
            <li class="normal" id="section-9.3.2-2.6"> Flag bit 5 is only valid for the IGMP Membership Report; if it is set, it
     translates to the IGMPv3 report.<a class="pilcrow" href="#section-9.3.2-2.6">¶</a>
</li>
            <li class="normal" id="section-9.3.2-2.7"> If the IE flag is set, it translates to the IGMP/MLD Exclude mode Leave.
     If the IE flag is not set (0), it translates to the Include mode Leave.<a class="pilcrow" href="#section-9.3.2-2.7">¶</a>
</li>
          </ul>
</section>
</section>
<section id="section-9.4">
        <h3 id="name-multicast-flags-extended-co">
<a class="section-number selfRef" href="#section-9.4">9.4. </a><a class="section-name selfRef" href="#name-multicast-flags-extended-co">Multicast Flags Extended Community</a>
        </h3>
<p id="section-9.4-1">The Multicast Flags Extended Community is a new EVPN Extended 
 Community.  EVPN Extended Communities are transitive extended
 communities with a Type Value of 0x06.  IANA has assigned 0x09 to Multicast Flags Extended Community in the "EVPN Extended Community Sub-Types" subregistry.<a class="pilcrow" href="#section-9.4-1">¶</a></p>
<p id="section-9.4-2">A PE that supports IGMP and/or the MLD Proxy on a given BD
 <span class="bcp14">MUST</span> attach this extended community to the IMET route it
 advertises for that BD, and it <span class="bcp14">MUST</span> set the IGMP and/or MLD Proxy 
 Support flags to 1. Note that a PE compliant with <span>[<a class="xref" href="#RFC7432">RFC7432</a>]</span> 
 will not advertise this 
 extended community, so its absence indicates that the advertising PE 
 does not support either IGMP or MLD Proxies.<a class="pilcrow" href="#section-9.4-2">¶</a></p>
<p id="section-9.4-3">The advertisement of this extended community enables a more efficient
 multicast tunnel setup from the source PE specially for ingress
 replication, i.e., if an egress PE supports the IGMP Proxy but doesn't
 have any interest in a given (x,G), it advertises its IGMP Proxy
 capability using this extended community, but it does not advertise
 any SMET route for that (x,G). When the source PE (ingress PE)
 receives such advertisements from the egress PE, it does not
 replicate the multicast traffic to that egress PE; however, it does
 replicate the multicast traffic to the egress PEs that don't
 advertise such capability, even if they don't have any interests in
 that (x,G).<a class="pilcrow" href="#section-9.4-3">¶</a></p>
<p id="section-9.4-4">A Multicast Flags Extended Community is encoded as an 8-octet value
 as follows:<a class="pilcrow" href="#section-9.4-4">¶</a></p>
<div class="alignCenter art-text artwork" id="section-9.4-5">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Type=0x06     |Sub-Type=0x09  |     Flags (2 Octets)      |M|I|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                           Reserved=0                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a class="pilcrow" href="#section-9.4-5">¶</a>
</div>
<p id="section-9.4-6">The low-order (least significant) 2 bits are defined as the "IGMP
 Proxy Support" and "MLD Proxy Support" bits (see <a class="xref" href="#multicast_flags_extended_community">Section 12.3</a>. The absence of this
 extended community also means that the PE does not support the IGMP
 Proxy, where:<a class="pilcrow" href="#section-9.4-6">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.4-7.1"> The Type is 0x06, as registered with IANA for EVPN Extended Communities.<a class="pilcrow" href="#section-9.4-7.1">¶</a>
</li>
          <li class="normal" id="section-9.4-7.2"> The Sub-Type is 0x09.<a class="pilcrow" href="#section-9.4-7.2">¶</a>
</li>
          <li class="normal" id="section-9.4-7.3">
            <p id="section-9.4-7.3.1">Flags are 2-octet values.<a class="pilcrow" href="#section-9.4-7.3.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.4-7.3.2.1"> Bit 15 (shown as I) defines IGMP Proxy Support. The value of 1 for
       bit 15 means that the PE supports the IGMP Proxy. The value of 0 for bit 15
       means that the PE does not support the IGMP Proxy.<a class="pilcrow" href="#section-9.4-7.3.2.1">¶</a>
</li>
              <li class="normal" id="section-9.4-7.3.2.2">Bit 14 (shown as M) defines MLD Proxy Support. The value of 1 for
       bit 14 means that the PE supports the MLD Proxy. The value of 0 for bit 14
       means that the PE does not support the MLD Proxy.<a class="pilcrow" href="#section-9.4-7.3.2.2">¶</a>
</li>
              <li class="normal" id="section-9.4-7.3.2.3">Bits 0 to 13 are reserved for the future. The sender <span class="bcp14">MUST</span>
       set it to 0, and the receiver <span class="bcp14">MUST</span> ignore it.<a class="pilcrow" href="#section-9.4-7.3.2.3">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-9.4-7.4"> Reserved bits are set to 0. The sender <span class="bcp14">MUST</span> set it to 0,
   and the receiver <span class="bcp14">MUST</span> ignore it.<a class="pilcrow" href="#section-9.4-7.4">¶</a>
</li>
        </ul>
<p id="section-9.4-8"> If a router does not support this specification, it <span class="bcp14">MUST NOT</span> add 
 the Multicast Flags Extended Community
 in the BGP route. When a router receives a BGP update, 
 if both M and I flags are 0, the router <span class="bcp14">MUST</span> treat this update as
 malformed.  The receiver of such an
 update <span class="bcp14">MUST</span> ignore the extended community.<a class="pilcrow" href="#section-9.4-8">¶</a></p>
</section>
<div id="evi-rt">
<section id="section-9.5">
        <h3 id="name-evi-rt-extended-community">
<a class="section-number selfRef" href="#section-9.5">9.5. </a><a class="section-name selfRef" href="#name-evi-rt-extended-community">EVI-RT Extended Community</a>
        </h3>
<p id="section-9.5-1">In EVPN, every EVI is associated with one or more Route Targets.  These RTs serve two functions:<a class="pilcrow" href="#section-9.5-1">¶</a></p>
<ol class="normal type-1" id="section-9.5-2" start="1" type="1">
   <li id="section-9.5-2.1">Distribution control: RTs control the distribution of the
   routes.  If a route carries the RT associated with a particular
   EVI, it will be distributed to all the PEs on which that EVI
   exists.<a class="pilcrow" href="#section-9.5-2.1">¶</a>
</li>
          <li id="section-9.5-2.2">EVI identification: Once a route has been received by a
   particular PE, the RT is used to identify the EVI to which it
   applies.<a class="pilcrow" href="#section-9.5-2.2">¶</a>
</li>
        </ol>
<p id="section-9.5-3">An IGMP Membership Report Synch or IGMP Leave Synch route is associated with a
 particular combination of ES and EVI.  These routes need to be
 distributed only to PEs that are attached to the associated ES.
 Therefore, these routes carry the ES-Import RT for that ES.<a class="pilcrow" href="#section-9.5-3">¶</a></p>
<p id="section-9.5-4">Since an IGMP Membership Report Synch or IGMP Leave Synch route does not need
 to be distributed to all the PEs on which the associated EVI
 exists, these routes cannot carry the RT associated with that
 EVI. Therefore, when such a route arrives at a particular PE, the
 route's RTs cannot be used to identify the EVI to which the route
 applies. Some other means of associating the route with an EVI
 must be used.<a class="pilcrow" href="#section-9.5-4">¶</a></p>
<p id="section-9.5-5">This document specifies four new ECs that
 can be used to identify the EVI with which a route is associated
 but do not have any effect on the distribution of the
 route.  These new ECs are known as "Type 0 EVI-RT EC", 
 "Type 1 EVI-RT EC", "Type 2 EVI-RT EC", and "Type 3 EVI-RT EC".<a class="pilcrow" href="#section-9.5-5">¶</a></p>
<ol class="normal type-1" id="section-9.5-6" start="1" type="1">
   <li id="section-9.5-6.1"> A Type 0 EVI-RT EC is an EVPN EC (type 6) of sub-type 0xA.<a class="pilcrow" href="#section-9.5-6.1">¶</a>
</li>
          <li id="section-9.5-6.2"> A Type 1 EVI-RT EC is an EVPN EC (type 6) of sub-type 0xB.<a class="pilcrow" href="#section-9.5-6.2">¶</a>
</li>
          <li id="section-9.5-6.3"> A Type 2 EVI-RT EC is an EVPN EC (type 6) of sub-type 0xC.<a class="pilcrow" href="#section-9.5-6.3">¶</a>
</li>
          <li id="section-9.5-6.4"> A Type 3 EVI-RT EC is an EVPN EC (type 6) of sub-type 0xD<a class="pilcrow" href="#section-9.5-6.4">¶</a>
</li>
        </ol>
<p id="section-9.5-7">Each IGMP Membership Report Synch or IGMP Leave Synch route <span class="bcp14">MUST</span>
 carry exactly
 one EVI-RT EC.  The EVI-RT EC carried by a particular route is
 constructed as follows.  Each such route is the result of having
 received an IGMP Membership Report or an IGMP Leave message from a particular
 BD. The route is said to be associated with that BD.
 For each BD, there is a corresponding RT that is used to ensure
 that routes "about" that BD are distributed to all PEs attached
 to that BD.  So suppose a given IGMP Membership Report Synch or Leave Synch
 route is associated with a given BD, say BD1, and suppose that
 the corresponding RT for BD1 is RT1. Then:<a class="pilcrow" href="#section-9.5-7">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.5-8.1">If RT1 is a Transitive Two-Octet AS-specific EC, then the EVI-RT
   EC carried by the route is a Type 0 EVI-RT EC.  The value
   field of the Type 0 EVI-RT EC is identical to the value field of
   RT1.<a class="pilcrow" href="#section-9.5-8.1">¶</a>
</li>
          <li class="normal" id="section-9.5-8.2">If RT1 is a Transitive IPv4-Address-specific EC, then the EVI-RT
   EC carried by the route is a Type 1 EVI-RT EC.  The value
   field of the Type 1 EVI-RT EC is identical to the value field of
   RT1.<a class="pilcrow" href="#section-9.5-8.2">¶</a>
</li>
          <li class="normal" id="section-9.5-8.3">If RT1 is a Transitive Four-Octet AS-specific EC, then the EVI-RT
   EC carried by the route is a Type 2 EVI-RT EC.  The value field
   of the Type 2 EVI-RT EC is identical to the value field of RT1.<a class="pilcrow" href="#section-9.5-8.3">¶</a>
</li>
          <li class="normal" id="section-9.5-8.4">If RT1 is a Transitive IPv6-Address-specific EC, then the EVI-RT 
   EC carried by the route is a Type 3 EVI-RT EC.  The value
   field of the Type 3 EVI-RT EC is identical to the value field of
   RT1.<a class="pilcrow" href="#section-9.5-8.4">¶</a>
</li>
        </ul>
<p id="section-9.5-9">An IGMP Membership Report Synch or Leave Synch route <span class="bcp14">MUST</span>
 carry exactly one EVI-RT EC.<a class="pilcrow" href="#section-9.5-9">¶</a></p>
<p id="section-9.5-10">Suppose a PE receives a particular IGMP Membership Report Synch or IGMP Leave
 Synch route, say R1, and suppose that R1 carries an ES-Import RT
 that is one of the PE's Import RTs.  If R1 has no EVI-RT EC or
 has more than one EVI-RT EC, the PE <span class="bcp14">MUST</span> apply the "treat-as-withdraw" 
 procedure per <span>[<a class="xref" href="#RFC7606">RFC7606</a>]</span>.<a class="pilcrow" href="#section-9.5-10">¶</a></p>
<p id="section-9.5-11">Note that an EVI-RT EC is not a Route Target extended community,
 is not visible to the RT Constrain mechanism <span>[<a class="xref" href="#RFC4684">RFC4684</a>]</span>,
 and is not intended to influence the propagation of routes by BGP.<a class="pilcrow" href="#section-9.5-11">¶</a></p>
<div class="alignCenter art-text artwork" id="section-9.5-12">
<pre>                     1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Type=0x06     |  Sub-Type=n   |       RT associated with EVI  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|             RT associated with the EVI  (cont.)               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a class="pilcrow" href="#section-9.5-12">¶</a>
</div>
<p id="section-9.5-13">The value of "n" is 0x0A, 0x0B, 0x0C, or 0x0D, corresponding
 to EVI-RT types 0, 1, 2, or 3, respectively.<a class="pilcrow" href="#section-9.5-13">¶</a></p>
</section>
</div>
<section id="section-9.6">
        <h3 id="name-rewriting-of-rt-ecs-and-evi">
<a class="section-number selfRef" href="#section-9.6">9.6. </a><a class="section-name selfRef" href="#name-rewriting-of-rt-ecs-and-evi">Rewriting of RT ECs and EVI-RT ECs by ASBRs</a>
        </h3>
<p id="section-9.6-1">There are certain situations in which an ES is attached to a set of PEs that are not all in the same AS, or not all operated by the same provider.  In this situation, the RT that corresponds to a particular EVI may be different in each AS.  If a route is propagated from AS1 to AS2, an ASBR at the AS1/AS2 border may be configured with a policy that replaces the EVI RTs for AS1 with the corresponding EVI RTs for AS2.  This is known
as RT-rewriting.<a class="pilcrow" href="#section-9.6-1">¶</a></p>
<p id="section-9.6-2">If an ASBR is configured to perform RT-rewriting of the EVI RTs in EVPN routes, it <span class="bcp14">MUST</span> be configured to perform RT-rewriting of the corresponding  EVI-RT extended communities in IGMP Join Synch and IGMP Leave Synch Routes.<a class="pilcrow" href="#section-9.6-2">¶</a></p>
</section>
<section id="section-9.7">
        <h3 id="name-bgp-error-handling">
<a class="section-number selfRef" href="#section-9.7">9.7. </a><a class="section-name selfRef" href="#name-bgp-error-handling">BGP Error Handling</a>
        </h3>
<p id="section-9.7-1">If a received BGP update contains Flags not in accordance with the IGMP/MLD
 version-X expectation, 
 the PE <span class="bcp14">MUST</span> apply the "treat-as-withdraw" procedure per <span>[<a class="xref" href="#RFC7606">RFC7606</a>]</span>.<a class="pilcrow" href="#section-9.7-1">¶</a></p>
<p id="section-9.7-2">If a received BGP update is malformed such that BGP route keys cannot be extracted,
 then the BGP update <span class="bcp14">MUST</span> be considered invalid. The receiving PE
 <span class="bcp14">MUST</span> apply the "session reset" procedure per <span>[<a class="xref" href="#RFC7606">RFC7606</a>]</span>.<a class="pilcrow" href="#section-9.7-2">¶</a></p>
</section>
</section>
</div>
<section id="section-10">
      <h2 id="name-igmp-version-1-membership-r">
<a class="section-number selfRef" href="#section-10">10. </a><a class="section-name selfRef" href="#name-igmp-version-1-membership-r">IGMP Version 1 Membership Report</a>
      </h2>
<p id="section-10-1">This document does not provide any detail about IGMPv1 processing.
      Implementations are expected to only use IGMPv2 and above for IPv4 and
      MLDv1 and above for IPv6. IGMPv1 routes are considered invalid, and the
      PE <span class="bcp14">MUST</span> apply the "treat-as-withdraw" procedure per
      <span>[<a class="xref" href="#RFC7606">RFC7606</a>]</span>.<a class="pilcrow" href="#section-10-1">¶</a></p>
</section>
<section id="section-11">
      <h2 id="name-security-considerations">
<a class="section-number selfRef" href="#section-11">11. </a><a class="section-name selfRef" href="#name-security-considerations">Security Considerations</a>
      </h2>
<p id="section-11-1">This document describes a means to efficiently operate IGMP and MLD on a subnet
      constructed across multiple PODs or DCs via an EVPN solution.  The security
      considerations for the operation of the underlying EVPN and BGP substrates are
      described in <span>[<a class="xref" href="#RFC7432">RFC7432</a>]</span>, and specific multicast
      considerations are outlined in
      <span>[<a class="xref" href="#RFC6513">RFC6513</a>]</span> and <span>[<a class="xref" href="#RFC6514">RFC6514</a>]</span>.
      The EVPN and associated IGMP Proxy provides a single 
      broadcast domain so the same security considerations of IGMPv2 <span>[<a class="xref" href="#RFC2236">RFC2236</a>]</span>, IGMPv3
      <span>[<a class="xref" href="#RFC3376">RFC3376</a>]</span>, MLD <span>[<a class="xref" href="#RFC2710">RFC2710</a>]</span>,
      or MLDv2 <span>[<a class="xref" href="#RFC3810">RFC3810</a>]</span> apply.<a class="pilcrow" href="#section-11-1">¶</a></p>
</section>
<section id="section-12">
      <h2 id="name-iana-considerations">
<a class="section-number selfRef" href="#section-12">12. </a><a class="section-name selfRef" href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<section id="section-12.1">
        <h3 id="name-evpn-extended-community-sub">
<a class="section-number selfRef" href="#section-12.1">12.1. </a><a class="section-name selfRef" href="#name-evpn-extended-community-sub">EVPN Extended Community Sub-Types Registration</a>
        </h3>
<p id="section-12.1-1">IANA has allocated the following codepoints in the "EVPN Extended Community Sub-Types" 
        subregistry under the "Border Gateway Protocol (BGP) Extended Communities" registry.<a class="pilcrow" href="#section-12.1-1">¶</a></p>
<span id="name-evpn-extended-community-sub-"></span><table class="center" id="table-1">
          <caption>
<a class="selfRef" href="#table-1">Table 1</a>:
<a class="selfRef" href="#name-evpn-extended-community-sub-">EVPN Extended Community Sub-Types Subregistry Allocated Codepoints</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Sub-Type Value</th>
              <th class="text-left" colspan="1" rowspan="1">Name</th>
              <th class="text-left" colspan="1" rowspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0x09</td>
              <td class="text-left" colspan="1" rowspan="1">Multicast Flags Extended Community</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9251</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0x0A</td>
              <td class="text-left" colspan="1" rowspan="1">EVI-RT Type 0</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9251</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0x0B</td>
              <td class="text-left" colspan="1" rowspan="1">EVI-RT Type 1</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9251</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0x0C</td>
              <td class="text-left" colspan="1" rowspan="1">EVI-RT Type 2</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9251</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0x0D</td>
              <td class="text-left" colspan="1" rowspan="1">EVI-RT Type 3</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9251</td>
            </tr>
          </tbody>
        </table>
</section>
<section id="section-12.2">
        <h3 id="name-evpn-route-types-registrati">
<a class="section-number selfRef" href="#section-12.2">12.2. </a><a class="section-name selfRef" href="#name-evpn-route-types-registrati">EVPN Route Types Registration</a>
        </h3>
<p id="section-12.2-1">IANA has allocated the following EVPN route types in the "EVPN
 Route Types" subregistry.<a class="pilcrow" href="#section-12.2-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-12.2-2">
          <dt id="section-12.2-2.1">6 -</dt>
          <dd id="section-12.2-2.2" style="margin-left: 1.5em">Selective Multicast Ethernet Tag Route<a class="pilcrow" href="#section-12.2-2.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-12.2-2.3">7 -</dt>
          <dd id="section-12.2-2.4" style="margin-left: 1.5em">Multicast Membership Report Synch Route<a class="pilcrow" href="#section-12.2-2.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-12.2-2.5">8 -</dt>
          <dd id="section-12.2-2.6" style="margin-left: 1.5em"> Multicast Leave Synch Route<a class="pilcrow" href="#section-12.2-2.6">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
<div id="multicast_flags_extended_community">
<section id="section-12.3">
        <h3 id="name-multicast-flags-extended-com">
<a class="section-number selfRef" href="#section-12.3">12.3. </a><a class="section-name selfRef" href="#name-multicast-flags-extended-com">Multicast Flags Extended Community Registry</a>
        </h3>
<p id="section-12.3-1">IANA has created and now maintains a new subregistry called "Multicast Flags Extended Community" under the "Border Gateway Protocol (BGP) Extended Communities" registry. The registration procedure is First Come First Served <span>[<a class="xref" href="#RFC8126">RFC8126</a>]</span>. For the 16-bit Flags field, the bits are numbered 0-15, from high order to low order. The registry was initialized as follows:<a class="pilcrow" href="#section-12.3-1">¶</a></p>
<span id="name-multicast-flags-extended-comm"></span><table class="center" id="table-2">
          <caption>
<a class="selfRef" href="#table-2">Table 2</a>:
<a class="selfRef" href="#name-multicast-flags-extended-comm">Multicast Flags Extended Community</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Bit</th>
              <th class="text-left" colspan="1" rowspan="1">Name</th>
              <th class="text-left" colspan="1" rowspan="1">Reference</th>
              <th class="text-left" colspan="1" rowspan="1">Change Controller</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0-13</td>
              <td class="text-left" colspan="1" rowspan="1">Unassigned</td>
              <td class="text-left" colspan="1" rowspan="1"></td>
              <td class="text-left" colspan="1" rowspan="1"></td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1"> 14</td>
              <td class="text-left" colspan="1" rowspan="1">MLD Proxy Support</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9251</td>
              <td class="text-left" colspan="1" rowspan="1">IETF</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1"> 15</td>
              <td class="text-left" colspan="1" rowspan="1">IGMP Proxy Support</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9251</td>
              <td class="text-left" colspan="1" rowspan="1">IETF</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
</section>
<section id="section-13">
      <h2 id="name-references">
<a class="section-number selfRef" href="#section-13">13. </a><a class="section-name selfRef" href="#name-references">References</a>
      </h2>
<section id="section-13.1">
        <h3 id="name-normative-references">
<a class="section-number selfRef" href="#section-13.1">13.1. </a><a class="section-name selfRef" href="#name-normative-references">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time class="refDate" datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2236">[RFC2236]</dt>
        <dd>
<span class="refAuthor">Fenner, W.</span>, <span class="refTitle">"Internet Group Management Protocol, Version 2"</span>, <span class="seriesInfo">RFC 2236</span>, <span class="seriesInfo">DOI 10.17487/RFC2236</span>, <time class="refDate" datetime="1997-11">November 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2236">https://www.rfc-editor.org/info/rfc2236</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2710">[RFC2710]</dt>
        <dd>
<span class="refAuthor">Deering, S.</span>, <span class="refAuthor">Fenner, W.</span>, and <span class="refAuthor">B. Haberman</span>, <span class="refTitle">"Multicast Listener Discovery (MLD) for IPv6"</span>, <span class="seriesInfo">RFC 2710</span>, <span class="seriesInfo">DOI 10.17487/RFC2710</span>, <time class="refDate" datetime="1999-10">October 1999</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2710">https://www.rfc-editor.org/info/rfc2710</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3376">[RFC3376]</dt>
        <dd>
<span class="refAuthor">Cain, B.</span>, <span class="refAuthor">Deering, S.</span>, <span class="refAuthor">Kouvelas, I.</span>, <span class="refAuthor">Fenner, B.</span>, and <span class="refAuthor">A. Thyagarajan</span>, <span class="refTitle">"Internet Group Management Protocol, Version 3"</span>, <span class="seriesInfo">RFC 3376</span>, <span class="seriesInfo">DOI 10.17487/RFC3376</span>, <time class="refDate" datetime="2002-10">October 2002</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3376">https://www.rfc-editor.org/info/rfc3376</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3810">[RFC3810]</dt>
        <dd>
<span class="refAuthor">Vida, R., Ed.</span> and <span class="refAuthor">L. Costa, Ed.</span>, <span class="refTitle">"Multicast Listener Discovery Version 2 (MLDv2) for IPv6"</span>, <span class="seriesInfo">RFC 3810</span>, <span class="seriesInfo">DOI 10.17487/RFC3810</span>, <time class="refDate" datetime="2004-06">June 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3810">https://www.rfc-editor.org/info/rfc3810</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4364">[RFC4364]</dt>
        <dd>
<span class="refAuthor">Rosen, E.</span> and <span class="refAuthor">Y. Rekhter</span>, <span class="refTitle">"BGP/MPLS IP Virtual Private Networks (VPNs)"</span>, <span class="seriesInfo">RFC 4364</span>, <span class="seriesInfo">DOI 10.17487/RFC4364</span>, <time class="refDate" datetime="2006-02">February 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4364">https://www.rfc-editor.org/info/rfc4364</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4684">[RFC4684]</dt>
        <dd>
<span class="refAuthor">Marques, P.</span>, <span class="refAuthor">Bonica, R.</span>, <span class="refAuthor">Fang, L.</span>, <span class="refAuthor">Martini, L.</span>, <span class="refAuthor">Raszuk, R.</span>, <span class="refAuthor">Patel, K.</span>, and <span class="refAuthor">J. Guichard</span>, <span class="refTitle">"Constrained Route Distribution for Border Gateway Protocol/MultiProtocol Label Switching (BGP/MPLS) Internet Protocol (IP) Virtual Private Networks (VPNs)"</span>, <span class="seriesInfo">RFC 4684</span>, <span class="seriesInfo">DOI 10.17487/RFC4684</span>, <time class="refDate" datetime="2006-11">November 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4684">https://www.rfc-editor.org/info/rfc4684</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6513">[RFC6513]</dt>
        <dd>
<span class="refAuthor">Rosen, E., Ed.</span> and <span class="refAuthor">R. Aggarwal, Ed.</span>, <span class="refTitle">"Multicast in MPLS/BGP IP VPNs"</span>, <span class="seriesInfo">RFC 6513</span>, <span class="seriesInfo">DOI 10.17487/RFC6513</span>, <time class="refDate" datetime="2012-02">February 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6513">https://www.rfc-editor.org/info/rfc6513</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6514">[RFC6514]</dt>
        <dd>
<span class="refAuthor">Aggarwal, R.</span>, <span class="refAuthor">Rosen, E.</span>, <span class="refAuthor">Morin, T.</span>, and <span class="refAuthor">Y. Rekhter</span>, <span class="refTitle">"BGP Encodings and Procedures for Multicast in MPLS/BGP IP VPNs"</span>, <span class="seriesInfo">RFC 6514</span>, <span class="seriesInfo">DOI 10.17487/RFC6514</span>, <time class="refDate" datetime="2012-02">February 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6514">https://www.rfc-editor.org/info/rfc6514</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6625">[RFC6625]</dt>
        <dd>
<span class="refAuthor">Rosen, E., Ed.</span>, <span class="refAuthor">Rekhter, Y., Ed.</span>, <span class="refAuthor">Hendrickx, W.</span>, and <span class="refAuthor">R. Qiu</span>, <span class="refTitle">"Wildcards in Multicast VPN Auto-Discovery Routes"</span>, <span class="seriesInfo">RFC 6625</span>, <span class="seriesInfo">DOI 10.17487/RFC6625</span>, <time class="refDate" datetime="2012-05">May 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6625">https://www.rfc-editor.org/info/rfc6625</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7432">[RFC7432]</dt>
        <dd>
<span class="refAuthor">Sajassi, A., Ed.</span>, <span class="refAuthor">Aggarwal, R.</span>, <span class="refAuthor">Bitar, N.</span>, <span class="refAuthor">Isaac, A.</span>, <span class="refAuthor">Uttaro, J.</span>, <span class="refAuthor">Drake, J.</span>, and <span class="refAuthor">W. Henderickx</span>, <span class="refTitle">"BGP MPLS-Based Ethernet VPN"</span>, <span class="seriesInfo">RFC 7432</span>, <span class="seriesInfo">DOI 10.17487/RFC7432</span>, <time class="refDate" datetime="2015-02">February 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7432">https://www.rfc-editor.org/info/rfc7432</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7606">[RFC7606]</dt>
        <dd>
<span class="refAuthor">Chen, E., Ed.</span>, <span class="refAuthor">Scudder, J., Ed.</span>, <span class="refAuthor">Mohapatra, P.</span>, and <span class="refAuthor">K. Patel</span>, <span class="refTitle">"Revised Error Handling for BGP UPDATE Messages"</span>, <span class="seriesInfo">RFC 7606</span>, <span class="seriesInfo">DOI 10.17487/RFC7606</span>, <time class="refDate" datetime="2015-08">August 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7606">https://www.rfc-editor.org/info/rfc7606</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
      <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time class="refDate" datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-13.2">
        <h3 id="name-informative-references">
<a class="section-number selfRef" href="#section-13.2">13.2. </a><a class="section-name selfRef" href="#name-informative-references">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-bess-evpn-bum-procedure-updates">[EVPN-BUM]</dt>
        <dd>
<span class="refAuthor">Zhang, Z.</span>, <span class="refAuthor">Lin, W.</span>, <span class="refAuthor">Rabadan, J.</span>, <span class="refAuthor">Patel, K.</span>, and <span class="refAuthor">A. Sajassi</span>, <span class="refTitle">"Updates on EVPN BUM Procedures"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-bess-evpn-bum-procedure-updates-14</span>, <time class="refDate" datetime="2021-11-18">18 November 2021</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-bess-evpn-bum-procedure-updates-14">https://datatracker.ietf.org/doc/html/draft-ietf-bess-evpn-bum-procedure-updates-14</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4541">[RFC4541]</dt>
        <dd>
<span class="refAuthor">Christensen, M.</span>, <span class="refAuthor">Kimball, K.</span>, and <span class="refAuthor">F. Solensky</span>, <span class="refTitle">"Considerations for Internet Group Management Protocol (IGMP) and Multicast Listener Discovery (MLD) Snooping Switches"</span>, <span class="seriesInfo">RFC 4541</span>, <span class="seriesInfo">DOI 10.17487/RFC4541</span>, <time class="refDate" datetime="2006-05">May 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4541">https://www.rfc-editor.org/info/rfc4541</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
      <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time class="refDate" datetime="2017-06">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<section id="appendix-A">
      <h2 id="name-acknowledgements">
<a class="section-name selfRef" href="#name-acknowledgements">Acknowledgements</a>
      </h2>
<p id="appendix-A-1">The authors would like to thank <span class="contact-name">Stephane Litkowski</span>, <span class="contact-name">Jorge Rabadan</span>,
      <span class="contact-name">Anoop Ghanwani</span>, <span class="contact-name">Jeffrey Haas</span>, <span class="contact-name">Krishna Muddenahally Ananthamurthy</span>, and <span class="contact-name">Swadesh Agrawal</span>
      for their reviews and valuable comments.<a class="pilcrow" href="#appendix-A-1">¶</a></p>
</section>
<section id="appendix-B">
      <h2 id="name-contributors">
<a class="section-name selfRef" href="#name-contributors">Contributors</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Derek Yeung</span></div>
<div class="left" dir="auto"><span class="org">Arrcus</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:derek@arrcus.com">derek@arrcus.com</a>
</div>
</address>
</section>
<div id="authors-addresses">
<section id="appendix-C">
      <h2 id="name-authors-addresses">
<a class="section-name selfRef" href="#name-authors-addresses">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Ali Sajassi</span></div>
<div class="left" dir="auto"><span class="org">Cisco Systems</span></div>
<div class="left" dir="auto"><span class="street-address">821 Alder Drive</span></div>
<div class="left" dir="auto">
<span class="locality">Milpitas</span>, <span class="region">CA</span> <span class="postal-code">95035</span>
</div>
<div class="left" dir="auto"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:sajassi@cisco.com">sajassi@cisco.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Samir Thoria</span></div>
<div class="left" dir="auto"><span class="org">Cisco Systems</span></div>
<div class="left" dir="auto"><span class="street-address">821 Alder Drive</span></div>
<div class="left" dir="auto">
<span class="locality">Milpitas</span>, <span class="region">CA</span> <span class="postal-code">95035</span>
</div>
<div class="left" dir="auto"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:sthoria@cisco.com">sthoria@cisco.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Mankamana Mishra</span></div>
<div class="left" dir="auto"><span class="org">Cisco Systems</span></div>
<div class="left" dir="auto"><span class="street-address">821 Alder Drive</span></div>
<div class="left" dir="auto">
<span class="locality">Milpitas</span>, <span class="region">CA</span> <span class="postal-code">95035</span>
</div>
<div class="left" dir="auto"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:mankamis@cisco.com">mankamis@cisco.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Keyur Patel</span></div>
<div class="left" dir="auto"><span class="org">Arrcus</span></div>
<div class="left" dir="auto"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:keyur@arrcus.com">keyur@arrcus.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">John Drake</span></div>
<div class="left" dir="auto"><span class="org">Juniper Networks</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:jdrake@juniper.net">jdrake@juniper.net</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Wen Lin</span></div>
<div class="left" dir="auto"><span class="org">Juniper Networks</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:wlin@juniper.net">wlin@juniper.net</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>


</body></html>