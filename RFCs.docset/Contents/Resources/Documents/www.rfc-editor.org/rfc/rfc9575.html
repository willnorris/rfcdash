<!DOCTYPE html>
<html class="RFC" lang="en"><head>
<meta charset="utf-8"/>
<meta content="Common,Latin" name="scripts"/>
<meta content="initial-scale=1.0" name="viewport"/>
<title>RFC 9575: DRIP Entity Tag (DET) Authentication Formats and Protocols for Broadcast Remote Identification (RID)</title>
<meta content="Adam Wiethuechter" name="author"/>
<meta content="Stuart Card" name="author"/>
<meta content="Robert Moskowitz" name="author"/>
<meta content="
       The Drone Remote Identification Protocol (DRIP), plus trust policies and periodic access to registries, augments Unmanned Aircraft System (UAS) Remote Identification (RID), enabling local real-time assessment of trustworthiness of received RID messages and observed UAS, even by Observers lacking Internet access. This document defines DRIP message types and formats to be sent in Broadcast RID Authentication Messages to verify that attached and recently detached messages were signed by the registered owner of the DRIP Entity Tag (DET) claimed. 
    " name="description"/>
<meta content="xml2rfc 3.21.0" name="generator"/>
<meta content="drone" name="keyword"/>
<meta content="UAS" name="keyword"/>
<meta content="Broadcast RID" name="keyword"/>
<meta content="trustworthy remote identification" name="keyword"/>
<meta content="anti-spoofing" name="keyword"/>
<meta content="9575" name="rfc.number"/>
<!-- Generator version information:
  xml2rfc 3.21.0
    Python 3.9.15
    ConfigArgParse 1.5.3
    google-i18n-address 3.0.0
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 4.9.0
    platformdirs 3.8.0
    pycountry 22.3.5
    PyYAML 6.0
    requests 2.28.0
    setuptools 44.1.1
    six 1.16.0
    wcwidth 0.2.5
    weasyprint 56.1
-->
<link href="rfc9575.xml" rel="alternate" type="application/rfc+xml"/>
<link href="#copyright" rel="license"/>
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necessary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

:root {
  --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
  --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
  --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
}

@viewport {
  zoom: 1.0;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: var(--font-sans);
  line-height: 1.6;
  scroll-behavior: smooth;
  overflow-wrap: break-word;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
svg[font-family~="serif" i], svg [font-family~="serif" i] {
  font-family: var(--font-serif);
}
svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
  font-family: var(--font-sans);
}
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre {
  background-color: #f9f9f9;
  font-family: var(--font-mono);
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
blockquote > *:last-child {
  margin-bottom: 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}
.xref {
  overflow-wrap: normal;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.refSubseries {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: var(--font-sans);
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  .breakable pre {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The following is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
.sourcecode pre,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .artwork > pre,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background slightly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottom margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the compact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div.sourcecode:first-child,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type:only-child {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css"/>
<link href="https://datatracker.ietf.org/doc/draft-ietf-drip-auth-49" rel="prev"/>
  <link href="https://dx.doi.org/10.17487/rfc9575" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  </head>
<body class="xml2rfc">
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 9575</td>
<td class="center">DRIP Auth Formats</td>
<td class="right">June 2024</td>
</tr></thead>
<tfoot><tr>
<td class="left">Wiethuechter, et al.</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div class="document-information" id="external-metadata"></div>
<div class="document-information" id="internal-metadata">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a class="eref" href="https://www.rfc-editor.org/rfc/rfc9575">9575</a></dd>
<dt class="label-category">Category:</dt>
<dd class="category">Standards Track</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time class="published" datetime="2024-06">June 2024</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">A. Wiethuechter, <span class="editor">Ed.</span>
</div>
<div class="org">AX Enterprize, LLC</div>
</div>
<div class="author">
      <div class="author-name">S. Card</div>
<div class="org">AX Enterprize, LLC</div>
</div>
<div class="author">
      <div class="author-name">R. Moskowitz</div>
<div class="org">HTT Consulting</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 9575</h1>
<h1 id="title">DRIP Entity Tag (DET) Authentication Formats and Protocols for Broadcast Remote Identification (RID)</h1>
<section id="section-abstract">
      <h2 id="abstract"><a class="selfRef" href="#abstract">Abstract</a></h2>
<p id="section-abstract-1">The Drone Remote Identification Protocol (DRIP), plus trust policies and periodic access to registries, augments Unmanned Aircraft System (UAS) Remote Identification (RID), enabling local real-time assessment of trustworthiness of received RID messages and observed UAS, even by Observers lacking Internet access. This document defines DRIP message types and formats to be sent in Broadcast RID Authentication Messages to verify that attached and recently detached messages were signed by the registered owner of the DRIP Entity Tag (DET) claimed.<a class="pilcrow" href="#section-abstract-1">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a class="section-name selfRef" href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This is an Internet Standards Track document.<a class="pilcrow" href="#section-boilerplate.1-1">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.<a class="pilcrow" href="#section-boilerplate.1-2">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc9575">https://www.rfc-editor.org/info/rfc9575</a></span>.<a class="pilcrow" href="#section-boilerplate.1-3">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a class="section-name selfRef" href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2024 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a class="pilcrow" href="#section-boilerplate.2-1">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a class="pilcrow" href="#section-boilerplate.2-2">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a class="toplink" href="#" onclick="scroll(0,0)">▲</a><h2 id="name-table-of-contents">
<a class="section-name selfRef" href="#name-table-of-contents">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p class="keepWithNext" id="section-toc.1-1.1.1"><a class="auto internal xref" href="#section-1">1</a>.  <a class="internal xref" href="#name-introduction">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p class="keepWithNext" id="section-toc.1-1.1.2.1.1"><a class="auto internal xref" href="#section-1.1">1.1</a>.  <a class="internal xref" href="#name-drip-entity-tag-det-authent">DRIP Entity Tag (DET) Authentication Goals for Broadcast RID</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a class="auto internal xref" href="#section-2">2</a>.  <a class="internal xref" href="#name-terminology">Terminology</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p class="keepWithNext" id="section-toc.1-1.2.2.1.1"><a class="auto internal xref" href="#section-2.1">2.1</a>.  <a class="internal xref" href="#name-required-terminology">Required Terminology</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a class="auto internal xref" href="#section-2.2">2.2</a>.  <a class="internal xref" href="#name-definitions">Definitions</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a class="auto internal xref" href="#section-3">3</a>.  <a class="internal xref" href="#name-uas-rid-authentication-back">UAS RID Authentication Background and Procedures</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a class="auto internal xref" href="#section-3.1">3.1</a>.  <a class="internal xref" href="#name-drip-authentication-protoco">DRIP Authentication Protocol Description</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.1">
                    <p id="section-toc.1-1.3.2.1.2.1.1"><a class="auto internal xref" href="#section-3.1.1">3.1.1</a>.  <a class="internal xref" href="#name-usage-of-dns">Usage of DNS</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.2">
                    <p id="section-toc.1-1.3.2.1.2.2.1"><a class="auto internal xref" href="#section-3.1.2">3.1.2</a>.  <a class="internal xref" href="#name-providing-uas-rid-trust">Providing UAS RID Trust</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a class="auto internal xref" href="#section-3.2">3.2</a>.  <a class="internal xref" href="#name-astm-authentication-message">ASTM Authentication Message Framing</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.1">
                    <p id="section-toc.1-1.3.2.2.2.1.1"><a class="auto internal xref" href="#section-3.2.1">3.2.1</a>.  <a class="internal xref" href="#name-authentication-page">Authentication Page</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.2">
                    <p id="section-toc.1-1.3.2.2.2.2.1"><a class="auto internal xref" href="#section-3.2.2">3.2.2</a>.  <a class="internal xref" href="#name-authentication-payload-fiel">Authentication Payload Field</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.3">
                    <p id="section-toc.1-1.3.2.2.2.3.1"><a class="auto internal xref" href="#section-3.2.3">3.2.3</a>.  <a class="internal xref" href="#name-sam-data-format">SAM Data Format</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.4">
                    <p id="section-toc.1-1.3.2.2.2.4.1"><a class="auto internal xref" href="#section-3.2.4">3.2.4</a>.  <a class="internal xref" href="#name-astm-broadcast-rid-constrai">ASTM Broadcast RID Constraints</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a class="auto internal xref" href="#section-4">4</a>.  <a class="internal xref" href="#name-drip-authentication-formats">DRIP Authentication Formats</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a class="auto internal xref" href="#section-4.1">4.1</a>.  <a class="internal xref" href="#name-ua-signed-evidence-structur">UA-Signed Evidence Structure</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a class="auto internal xref" href="#section-4.2">4.2</a>.  <a class="internal xref" href="#name-drip-link">DRIP Link</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a class="auto internal xref" href="#section-4.3">4.3</a>.  <a class="internal xref" href="#name-drip-wrapper">DRIP Wrapper</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.1">
                    <p id="section-toc.1-1.4.2.3.2.1.1"><a class="auto internal xref" href="#section-4.3.1">4.3.1</a>.  <a class="internal xref" href="#name-wrapped-count-and-format-va">Wrapped Count and Format Validation</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.2">
                    <p id="section-toc.1-1.4.2.3.2.2.1"><a class="auto internal xref" href="#section-4.3.2">4.3.2</a>.  <a class="internal xref" href="#name-wrapper-over-extended-trans">Wrapper over Extended Transports</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.3">
                    <p id="section-toc.1-1.4.2.3.2.3.1"><a class="auto internal xref" href="#section-4.3.3">4.3.3</a>.  <a class="internal xref" href="#name-wrapper-limitations">Wrapper Limitations</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a class="auto internal xref" href="#section-4.4">4.4</a>.  <a class="internal xref" href="#name-drip-manifest">DRIP Manifest</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.1">
                    <p id="section-toc.1-1.4.2.4.2.1.1"><a class="auto internal xref" href="#section-4.4.1">4.4.1</a>.  <a class="internal xref" href="#name-hash-count-and-format-valid">Hash Count and Format Validation</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.2">
                    <p id="section-toc.1-1.4.2.4.2.2.1"><a class="auto internal xref" href="#section-4.4.2">4.4.2</a>.  <a class="internal xref" href="#name-manifest-ledger-hashes">Manifest Ledger Hashes</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.3">
                    <p id="section-toc.1-1.4.2.4.2.3.1"><a class="auto internal xref" href="#section-4.4.3">4.4.3</a>.  <a class="internal xref" href="#name-hash-algorithms-and-operati">Hash Algorithms and Operation</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a class="auto internal xref" href="#section-4.5">4.5</a>.  <a class="internal xref" href="#name-drip-frame">DRIP Frame</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a class="auto internal xref" href="#section-5">5</a>.  <a class="internal xref" href="#name-forward-error-correction">Forward Error Correction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a class="auto internal xref" href="#section-5.1">5.1</a>.  <a class="internal xref" href="#name-encoding">Encoding</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a class="auto internal xref" href="#section-5.2">5.2</a>.  <a class="internal xref" href="#name-decoding">Decoding</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a class="auto internal xref" href="#section-5.3">5.3</a>.  <a class="internal xref" href="#name-fec-limitations">FEC Limitations</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a class="auto internal xref" href="#section-6">6</a>.  <a class="internal xref" href="#name-requirements-and-recommenda">Requirements and Recommendations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a class="auto internal xref" href="#section-6.1">6.1</a>.  <a class="internal xref" href="#name-legacy-transports">Legacy Transports</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a class="auto internal xref" href="#section-6.2">6.2</a>.  <a class="internal xref" href="#name-extended-transports">Extended Transports</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a class="auto internal xref" href="#section-6.3">6.3</a>.  <a class="internal xref" href="#name-authentication">Authentication</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a class="auto internal xref" href="#section-6.4">6.4</a>.  <a class="internal xref" href="#name-operational">Operational</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4.2.1">
                    <p id="section-toc.1-1.6.2.4.2.1.1"><a class="auto internal xref" href="#section-6.4.1">6.4.1</a>.  <a class="internal xref" href="#name-drip-wrapper-2">DRIP Wrapper</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4.2.2">
                    <p id="section-toc.1-1.6.2.4.2.2.1"><a class="auto internal xref" href="#section-6.4.2">6.4.2</a>.  <a class="internal xref" href="#name-uas-rid-trust-assessment">UAS RID Trust Assessment</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a class="auto internal xref" href="#section-7">7</a>.  <a class="internal xref" href="#name-summary-of-addressed-drip-r">Summary of Addressed DRIP Requirements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a class="auto internal xref" href="#section-8">8</a>.  <a class="internal xref" href="#name-iana-considerations">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a class="auto internal xref" href="#section-8.1">8.1</a>.  <a class="internal xref" href="#name-iana-drip-registry">IANA DRIP Registry</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a class="auto internal xref" href="#section-9">9</a>.  <a class="internal xref" href="#name-security-considerations">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a class="auto internal xref" href="#section-9.1">9.1</a>.  <a class="internal xref" href="#name-replay-attacks">Replay Attacks</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a class="auto internal xref" href="#section-9.2">9.2</a>.  <a class="internal xref" href="#name-wrapper-vs-manifest">Wrapper vs Manifest</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a class="auto internal xref" href="#section-9.3">9.3</a>.  <a class="internal xref" href="#name-vna-timestamp-offsets-for-d">VNA Timestamp Offsets for DRIP Authentication Formats</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.4">
                <p id="section-toc.1-1.9.2.4.1"><a class="auto internal xref" href="#section-9.4">9.4</a>.  <a class="internal xref" href="#name-dns-security-in-drip">DNS Security in DRIP</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a class="auto internal xref" href="#section-10">10</a>. <a class="internal xref" href="#name-references">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a class="auto internal xref" href="#section-10.1">10.1</a>.  <a class="internal xref" href="#name-normative-references">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a class="auto internal xref" href="#section-10.2">10.2</a>.  <a class="internal xref" href="#name-informative-references">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a class="auto internal xref" href="#appendix-A">Appendix A</a>.  <a class="internal xref" href="#name-authentication-states">Authentication States</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a class="auto internal xref" href="#appendix-A.1">A.1</a>.  <a class="internal xref" href="#name-none-black">None: Black</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a class="auto internal xref" href="#appendix-A.2">A.2</a>.  <a class="internal xref" href="#name-partial-gray">Partial: Gray</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.3">
                <p id="section-toc.1-1.11.2.3.1"><a class="auto internal xref" href="#appendix-A.3">A.3</a>.  <a class="internal xref" href="#name-unsupported-brown">Unsupported: Brown</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.4">
                <p id="section-toc.1-1.11.2.4.1"><a class="auto internal xref" href="#appendix-A.4">A.4</a>.  <a class="internal xref" href="#name-unverifiable-yellow">Unverifiable: Yellow</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.5">
                <p id="section-toc.1-1.11.2.5.1"><a class="auto internal xref" href="#appendix-A.5">A.5</a>.  <a class="internal xref" href="#name-verified-green">Verified: Green</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.6">
                <p id="section-toc.1-1.11.2.6.1"><a class="auto internal xref" href="#appendix-A.6">A.6</a>.  <a class="internal xref" href="#name-trusted-blue">Trusted: Blue</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.7">
                <p id="section-toc.1-1.11.2.7.1"><a class="auto internal xref" href="#appendix-A.7">A.7</a>.  <a class="internal xref" href="#name-questionable-orange">Questionable: Orange</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.8">
                <p id="section-toc.1-1.11.2.8.1"><a class="auto internal xref" href="#appendix-A.8">A.8</a>.  <a class="internal xref" href="#name-unverified-red">Unverified: Red</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.9">
                <p id="section-toc.1-1.11.2.9.1"><a class="auto internal xref" href="#appendix-A.9">A.9</a>.  <a class="internal xref" href="#name-conflicting-purple">Conflicting: Purple</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a class="auto internal xref" href="#appendix-B">Appendix B</a>.  <a class="internal xref" href="#name-operational-recommendation-">Operational Recommendation Analysis</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a class="auto internal xref" href="#appendix-B.1">B.1</a>.  <a class="internal xref" href="#name-page-counts-vs-frame-counts">Page Counts vs Frame Counts</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1.2.1">
                    <p id="section-toc.1-1.12.2.1.2.1.1"><a class="auto internal xref" href="#appendix-B.1.1">B.1.1</a>.  <a class="internal xref" href="#name-special-cases">Special Cases</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a class="auto internal xref" href="#appendix-B.2">B.2</a>.  <a class="internal xref" href="#name-full-authentication-example">Full Authentication Example</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2.2.1">
                    <p id="section-toc.1-1.12.2.2.2.1.1"><a class="auto internal xref" href="#appendix-B.2.1">B.2.1</a>.  <a class="internal xref" href="#name-raw-example">Raw Example</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a class="auto internal xref" href="#appendix-C"></a><a class="internal xref" href="#name-acknowledgments">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a class="auto internal xref" href="#appendix-D"></a><a class="internal xref" href="#name-authors-addresses">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a class="section-number selfRef" href="#section-1">1. </a><a class="section-name selfRef" href="#name-introduction">Introduction</a>
      </h2>
<p id="section-1-1">The initial regulations (e.g., <span>[<a class="cite xref" href="#FAA-14CFR">FAA-14CFR</a>]</span>) and standards (e.g., <span>[<a class="cite xref" href="#F3411">F3411</a>]</span>) for Unmanned Aircraft  Systems (UAS) Remote Identification (RID) and tracking do not address trust. However, this is a requirement that needs to be addressed for various different parties that have a stake in the safe operation of National Airspace Systems (NAS). Drone Remote ID Protocol's (DRIP's) goal is to specify how RID can be made trustworthy and available in both Internet and local-only connected scenarios, especially in emergency situations.<a class="pilcrow" href="#section-1-1">¶</a></p>
<p id="section-1-2">UAS often operate in a volatile environment. A small Unmanned Aircraft (UA) offers little capacity for computation and communication. UAS RID must also be accessible with ubiquitous and inexpensive devices without modification. This limits options. Most current small UAS are Internet of Things (IoT) devices even if they are not typically thought of as such. Thus many IoT considerations apply here. Some DRIP work, currently strongly scoped to UAS RID, is likely to be applicable to some other IoT use cases.<a class="pilcrow" href="#section-1-2">¶</a></p>
<p id="section-1-3">Generally, two communication schemes for UAS RID are considered: Broadcast and Network. This document focuses on adding trust to Broadcast RID (<span><a class="relref" href="https://rfc-editor.org/rfc/rfc9153#section-3.2">Section 3.2</a> of [<a class="cite xref" href="#RFC9153">RFC9153</a>]</span> and <span><a class="relref" href="https://rfc-editor.org/rfc/rfc9434#section-1.2.2">Section 1.2.2</a> of [<a class="cite xref" href="#RFC9434">RFC9434</a>]</span>). As defined in <span>[<a class="cite xref" href="#F3411">F3411</a>]</span> and outlined in <span>[<a class="cite xref" href="#RFC9153">RFC9153</a>]</span> and <span>[<a class="cite xref" href="#RFC9434">RFC9434</a>]</span>, Broadcast RID is a one-way Radio Frequency (RF) transmission of Media Access Control (MAC) layer messages over Bluetooth or Wi-Fi.<a class="pilcrow" href="#section-1-3">¶</a></p>
<p id="section-1-4">Senders can make any claims the RID message formats allow. Observers have no standardized means to assess the trustworthiness of message content, nor verify whether the messages were sent by the UA identified therein, nor confirm that the UA identified therein is the one they are visually observing. Indeed, Observers have no way to detect whether the messages were sent by a UA or spoofed by some other transmitter (e.g., a laptop or smartphone) anywhere in direct wireless broadcast range. Authentication is the primary strategy for mitigating this issue.<a class="pilcrow" href="#section-1-4">¶</a></p>
<div id="drip-entity-tag-det-authentication-goals-for-broadcast-rid">
<section id="section-1.1">
        <h3 id="name-drip-entity-tag-det-authent">
<a class="section-number selfRef" href="#section-1.1">1.1. </a><a class="section-name selfRef" href="#name-drip-entity-tag-det-authent">DRIP Entity Tag (DET) Authentication Goals for Broadcast RID</a>
        </h3>
<p id="section-1.1-1">ASTM <span>[<a class="cite xref" href="#F3411">F3411</a>]</span> Authentication Messages (Message Type 0x2), when used with DET-based formats <span>[<a class="cite xref" href="#RFC9374">RFC9374</a>]</span>, enable a high level of trust that the content of other ASTM Messages was generated by their claimed registered source. These messages are designed to provide the Observers with trustworthy and immediately actionable information. <a class="auto internal xref" href="#auth-state-diagrams">Appendix A</a> provides a high-level overview of the various states of trustworthiness that may be used along with these formats.<a class="pilcrow" href="#section-1.1-1">¶</a></p>
<p id="section-1.1-2">This authentication approach also provides some error correction (<a class="auto internal xref" href="#fec-details">Section 5</a>) as mandated by the United States (US) Federal Aviation Administration (FAA) <span>[<a class="cite xref" href="#FAA-14CFR">FAA-14CFR</a>]</span>, which is missing from <span>[<a class="cite xref" href="#F3411">F3411</a>]</span> over Legacy Transports (Bluetooth 4.x).<a class="pilcrow" href="#section-1.1-2">¶</a></p>
<p id="section-1.1-3">These DRIP enhancements to ASTM's specification for RID and tracking <span>[<a class="cite xref" href="#F3411">F3411</a>]</span> further support the important use case of Observers who may be offline at the time of observation.<a class="pilcrow" href="#section-1.1-3">¶</a></p>
<p id="section-1.1-4"><a class="auto internal xref" href="#req-sum">Section 7</a> summarizes the DRIP requirements <span>[<a class="cite xref" href="#RFC9153">RFC9153</a>]</span> addressed herein.<a class="pilcrow" href="#section-1.1-4">¶</a></p>
</section>
</div>
</section>
</div>
<div id="terminology">
<section id="section-2">
      <h2 id="name-terminology">
<a class="section-number selfRef" href="#section-2">2. </a><a class="section-name selfRef" href="#name-terminology">Terminology</a>
      </h2>
<div id="required-terminology">
<section id="section-2.1">
        <h3 id="name-required-terminology">
<a class="section-number selfRef" href="#section-2.1">2.1. </a><a class="section-name selfRef" href="#name-required-terminology">Required Terminology</a>
        </h3>
<p id="section-2.1-1">
    The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>",
    "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>",
    "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>",
    "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
    "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be
    interpreted as described in BCP 14 <span>[<a class="cite xref" href="#RFC2119">RFC2119</a>]</span> <span>[<a class="cite xref" href="#RFC8174">RFC8174</a>]</span> when, and only when, they appear in all capitals, as
    shown here.<a class="pilcrow" href="#section-2.1-1">¶</a></p>
</section>
</div>
<div id="definitions">
<section id="section-2.2">
        <h3 id="name-definitions">
<a class="section-number selfRef" href="#section-2.2">2.2. </a><a class="section-name selfRef" href="#name-definitions">Definitions</a>
        </h3>
<p id="section-2.2-1">This document makes use of the terms (CAA, Observer, USS, UTM, etc.) defined in <span>[<a class="cite xref" href="#RFC9153">RFC9153</a>]</span>. Other terms (such as DIME) are from <span>[<a class="cite xref" href="#RFC9434">RFC9434</a>]</span>, while others (HI, DET, RAA, HDA, etc.) are from <span>[<a class="cite xref" href="#RFC9374">RFC9374</a>]</span>.<a class="pilcrow" href="#section-2.2-1">¶</a></p>
<p id="section-2.2-2">In addition, the following terms are defined for this document:<a class="pilcrow" href="#section-2.2-2">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2.2-3">
          <dt id="section-2.2-3.1">Extended Transports:</dt>
          <dd id="section-2.2-3.2" style="margin-left: 1.5em">Use of extended advertisements (Bluetooth 5.x), service info
        (Wi-Fi Neighbor Awareness Networking (NAN)), or IEEE 802.11 Beacons
        with the vendor-specific information element as specified in <span>[<a class="cite xref" href="#F3411">F3411</a>]</span>. Must use ASTM Message Pack (Message
        Type 0xF).<a class="pilcrow" href="#section-2.2-3.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-3.3">Legacy Transports:</dt>
          <dd id="section-2.2-3.4" style="margin-left: 1.5em">Use of broadcast frames (Bluetooth 4.x) as specified in <span>[<a class="cite xref" href="#F3411">F3411</a>]</span>.<a class="pilcrow" href="#section-2.2-3.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-3.5">Manifest:</dt>
          <dd id="section-2.2-3.6" style="margin-left: 1.5em">An immutable list of items being transported (in this specific case over wireless communication).<a class="pilcrow" href="#section-2.2-3.6">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-3.7">Observation Session:</dt>
          <dd id="section-2.2-3.8" style="margin-left: 1.5em">The period of time during which a given Observer's receiver is processing (even if only intermittently) a series of UAS RID messages, at least some of which use DRIP extensions to <span>[<a class="cite xref" href="#F3411">F3411</a>]</span>, all nominally from the same UA executing a single flight operation.<a class="pilcrow" href="#section-2.2-3.8">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-2.2-4">Note: For the remainder of this document, <em>Broadcast Endorsement: Parent, Child</em> will be abbreviated as <em>BE: Parent, Child</em>. For example, <em>Broadcast Endorsement: RAA, HDA</em> will be abbreviated as <em>BE: RAA, HDA</em>.<a class="pilcrow" href="#section-2.2-4">¶</a></p>
</section>
</div>
</section>
</div>
<div id="uas-rid-authentication-background-procedures">
<section id="section-3">
      <h2 id="name-uas-rid-authentication-back">
<a class="section-number selfRef" href="#section-3">3. </a><a class="section-name selfRef" href="#name-uas-rid-authentication-back">UAS RID Authentication Background and Procedures</a>
      </h2>
<div id="protocol-desc">
<section id="section-3.1">
        <h3 id="name-drip-authentication-protoco">
<a class="section-number selfRef" href="#section-3.1">3.1. </a><a class="section-name selfRef" href="#name-drip-authentication-protoco">DRIP Authentication Protocol Description</a>
        </h3>
<p id="section-3.1-1"><span>[<a class="cite xref" href="#F3411">F3411</a>]</span> defines Authentication Message framing only. It does not define authentication formats or methods. It explicitly anticipates several signature options but does not fully define those. Annex A1 of <span>[<a class="cite xref" href="#F3411">F3411</a>]</span> defines a Broadcast Authentication Verifier Service, which has a heavy reliance on Observer real-time connectivity to the Internet. Fortunately, <span>[<a class="cite xref" href="#F3411">F3411</a>]</span> also allows third-party standard Authentication Types using the Type 0x5 Specific Authentication Method (SAM), several of which DRIP defines herein.<a class="pilcrow" href="#section-3.1-1">¶</a></p>
<p id="section-3.1-2">The standardization of specific formats to support the DRIP requirements in UAS RID for trustworthy communications over Broadcast RID is an important part of the chain of trust for a UAS ID. Per <span><a class="relref" href="https://rfc-editor.org/rfc/rfc9434#section-5">Section 5</a> of [<a class="cite xref" href="#RFC9434">RFC9434</a>]</span>, Authentication formats are needed to relay information for Observers to determine trust. No existing formats (defined in <span>[<a class="cite xref" href="#F3411">F3411</a>]</span> or other organizations leveraging this feature) provide  functionality to satisfy this goal, resulting in the work reflected in this document.<a class="pilcrow" href="#section-3.1-2">¶</a></p>
<div id="auth-dns">
<section id="section-3.1.1">
          <h4 id="name-usage-of-dns">
<a class="section-number selfRef" href="#section-3.1.1">3.1.1. </a><a class="section-name selfRef" href="#name-usage-of-dns">Usage of DNS</a>
          </h4>
<p id="section-3.1.1-1">Like most aviation matters, the overall objectives here are security and ultimately safety oriented. Since DRIP depends on DNS for some of its functions, DRIP usage of DNS needs to be protected per best security practices. Many participating nodes will have limited local processing power and/or poor, low-bandwidth QoS paths. Appropriate and feasible security techniques will be highly dependent on the UAS and Observer situation. Therefore, specification of particular DNS security options, transports, etc. is outside the scope of this document (see also <a class="auto internal xref" href="#dns-security">Section 9.4</a>).<a class="pilcrow" href="#section-3.1.1-1">¶</a></p>
<p id="section-3.1.1-2">In DRIP, Observers <span class="bcp14">MUST</span> validate all signatures received. This requires that the Host Identity (HI) correspond to a DET <span>[<a class="cite xref" href="#RFC9374">RFC9374</a>]</span>. HI's <span class="bcp14">MAY</span> be retrieved from a local cache, if present. The local cache is pre-configured with well-known HIs (such as those of CAA DIMEs) and is further populated by received Broadcast Endorsements (BEs) (<a class="auto internal xref" href="#dime-attestation">Section 3.1.2.1</a>) and DNS lookups (when available).<a class="pilcrow" href="#section-3.1.1-2">¶</a></p>
<p id="section-3.1.1-3">The Observer <span class="bcp14">MUST</span> perform a DNS query, when connectivity allows, to obtain a previously unknown HI. If a query cannot be performed, the message <span class="bcp14">SHOULD</span> be cached by the Observer to be validated once the HI is obtained.<a class="pilcrow" href="#section-3.1.1-3">¶</a></p>
<p id="section-3.1.1-4">A more comprehensive specification of DRIP's use of DNS is out of scope for this document and can be found in <span>[<a class="cite xref" href="#I-D.ietf-drip-registries">DRIP-REG</a>]</span>.<a class="pilcrow" href="#section-3.1.1-4">¶</a></p>
</section>
</div>
<div id="rid-trust">
<section id="section-3.1.2">
          <h4 id="name-providing-uas-rid-trust">
<a class="section-number selfRef" href="#section-3.1.2">3.1.2. </a><a class="section-name selfRef" href="#name-providing-uas-rid-trust">Providing UAS RID Trust</a>
          </h4>
<p id="section-3.1.2-1">For DRIP, two actions together provide a mechanism for an Observer to trust in UAS RID using Authentication Messages.<a class="pilcrow" href="#section-3.1.2-1">¶</a></p>
<p id="section-3.1.2-2">First is the transmission of an entire trust chain via Broadcast Endorsements (<a class="auto internal xref" href="#dime-attestation">Section 3.1.2.1</a>). This provides a hierarchy of DIMEs down to and including an individual UA's registration of a claimed DET and corresponding HI (public key). This alone cannot be trusted as having any relevance to the observed UA because replay attacks are trivial.<a class="pilcrow" href="#section-3.1.2-2">¶</a></p>
<p id="section-3.1.2-3">After an Observer has gathered such a complete key trust chain (from pre-configured cache entries, Broadcast Endorsements received over the air and/or DNS lookups) and verified all of its links, that device can trust that the claimed DET and corresponding public key are properly registered, but the UA has not yet been proven to possess the corresponding private key.<a class="pilcrow" href="#section-3.1.2-3">¶</a></p>
<p id="section-3.1.2-4">Second is for the UA to prove possession by dynamically signing data that is unique and unpredictable but easily verified by the Observer (<a class="auto internal xref" href="#ua-attestation">Section 3.1.2.2</a>). Verification of this signed data <span class="bcp14">MUST</span> be performed by the Observer as part of the received UAS RID information trust assessment (<a class="auto internal xref" href="#trust-assessment">Section 6.4.2</a>).<a class="pilcrow" href="#section-3.1.2-4">¶</a></p>
<div id="dime-attestation">
<section id="section-3.1.2.1">
            <h5 id="name-dime-endorsements-of-subord">
<a class="section-number selfRef" href="#section-3.1.2.1">3.1.2.1. </a><a class="section-name selfRef" href="#name-dime-endorsements-of-subord">DIME Endorsements of Subordinate DETs</a>
            </h5>
<p id="section-3.1.2.1-1">Observers receive DRIP Link Authentication Messages (<a class="auto internal xref" href="#drip-link">Section 4.2</a>) containing Broadcast Endorsements by DIMEs of child DET registrations. A series of these Endorsements confirms a path through the hierarchy, defined in <span>[<a class="cite xref" href="#I-D.ietf-drip-registries">DRIP-REG</a>]</span>, from the DET Prefix Owner all the way to an individual UA DET registration.<a class="pilcrow" href="#section-3.1.2.1-1">¶</a></p>
</section>
</div>
<div id="ua-attestation">
<section id="section-3.1.2.2">
            <h5 id="name-ua-signed-evidence">
<a class="section-number selfRef" href="#section-3.1.2.2">3.1.2.2. </a><a class="section-name selfRef" href="#name-ua-signed-evidence">UA-Signed Evidence</a>
            </h5>
<p id="section-3.1.2.2-1">To prove possession of the private key associated with the DET, the UA <span class="bcp14">MUST</span> sign and send data that is unique and unpredictable but easily validated by the Observer. The data can be an ASTM Message that fulfills the requirements to be unpredictable but easily validated. An Observer receives this UA-signed Evidence from DRIP-based Authentication Messages (Sections <a class="auto internal xref" href="#drip-wrapper">4.3</a> or <a class="auto internal xref" href="#drip-manifest">4.4</a>). The Observer must verify the signature (cryptographically, as specified in <a class="auto internal xref" href="#auth-dns">Section 3.1.1</a>) and validate the signed content (via non-cryptographic means, as specified in <a class="auto internal xref" href="#drip-recommendations">Section 6.3</a>).<a class="pilcrow" href="#section-3.1.2.2-1">¶</a></p>
<p id="section-3.1.2.2-2">Whether the content is true is a separate question that DRIP cannot address, but validation performed using observable and/or out-of-band data (<a class="auto internal xref" href="#reqs">Section 6</a>) is possible and encouraged.<a class="pilcrow" href="#section-3.1.2.2-2">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="auth-message">
<section id="section-3.2">
        <h3 id="name-astm-authentication-message">
<a class="section-number selfRef" href="#section-3.2">3.2. </a><a class="section-name selfRef" href="#name-astm-authentication-message">ASTM Authentication Message Framing</a>
        </h3>
<p id="section-3.2-1">The Authentication Message (Message Type 0x2) is unique in the ASTM  <span>[<a class="cite xref" href="#F3411">F3411</a>]</span> Broadcast standard, as it is the only message that can be larger than the Legacy Transport size. To address this limitation around transport size, it is defined as a set of "pages", each of which fits into a single Legacy Transport frame. For Extended Transports, pages are still used but they are all in a single frame.<a class="pilcrow" href="#section-3.2-1">¶</a></p>
<aside id="section-3.2-2">
          <p id="section-3.2-2.1">Informational Note: Message Pack (Message Type 0xF) is also
        larger than the Legacy Transport size but is limited for use only on
        Extended Transports where it can be supported.<a class="pilcrow" href="#section-3.2-2.1">¶</a></p>
</aside>
<p id="section-3.2-3">The following subsections are a brief overview of the Authentication Message format defined in <span>[<a class="cite xref" href="#F3411">F3411</a>]</span> for better context on how DRIP Authentication fills and uses various fields already defined by ASTM <span>[<a class="cite xref" href="#F3411">F3411</a>]</span>.<a class="pilcrow" href="#section-3.2-3">¶</a></p>
<div id="auth-page">
<section id="section-3.2.1">
          <h4 id="name-authentication-page">
<a class="section-number selfRef" href="#section-3.2.1">3.2.1. </a><a class="section-name selfRef" href="#name-authentication-page">Authentication Page</a>
          </h4>
<p id="section-3.2.1-1">This document leverages Authentication Type 0x5 (Specific Authentication Method (SAM)) as the principal authentication container, defining a set of SAM Types in <a class="auto internal xref" href="#drip-authentication-formats">Section 4</a>. Authentication Type is encoded in every Authentication Page in the <em>Page Header</em>. The SAM Type is defined as a field in the <em>Authentication Payload</em> (see <a class="auto internal xref" href="#sam-data">Section 3.2.3</a>).<a class="pilcrow" href="#section-3.2.1-1">¶</a></p>
<span id="name-standard-astm-authenticatio"></span><div id="astm-auth-page">
<figure id="figure-1">
            <div class="alignCenter art-text artwork" id="section-3.2.1-2.1">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+---------------+---------------+
|  Page Header  |                                               |
+---------------+                                               |
|                                                               |
|                                                               |
|                     Authentication Payload                    |
|                                                               |
|                                                               |
+---------------+---------------+---------------+---------------+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-1">Figure 1</a>:
<a class="selfRef" href="#name-standard-astm-authenticatio">Standard ASTM Authentication Message Page</a>
            </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-3.2.1-3">
            <dt id="section-3.2.1-3.1">
<em>Page Header</em>:</dt>
            <dd id="section-3.2.1-3.2" style="margin-left: 1.5em">
              <p id="section-3.2.1-3.2.1">(1 octet)<a class="pilcrow" href="#section-3.2.1-3.2.1">¶</a></p>
<p id="section-3.2.1-3.2.2">Authentication Type (4 bits) and Page Number (4 bits)<a class="pilcrow" href="#section-3.2.1-3.2.2">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.1-3.3">
<em>Authentication Payload</em>:</dt>
            <dd id="section-3.2.1-3.4" style="margin-left: 1.5em">
              <p id="section-3.2.1-3.4.1">(23 octets per page)<a class="pilcrow" href="#section-3.2.1-3.4.1">¶</a></p>
<p id="section-3.2.1-3.4.2">Authentication Payload, including headers. Null padded. See
            <a class="auto internal xref" href="#auth-payload">Section 3.2.2</a>.<a class="pilcrow" href="#section-3.2.1-3.4.2">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-3.2.1-4">The Authentication Message is structured as a set of pages per <a class="auto internal xref" href="#astm-auth-page">Figure 1</a>. There is a technical maximum of 16 pages (indexed 0 to 15) that can be sent for a single Authentication Message, with each page carrying a maximum 23-octet <em>Authentication Payload</em>. See <a class="auto internal xref" href="#drip-restrictions">Section 3.2.4</a> for more details. Over Legacy Transports, these messages are "fragmented", with each page sent in a separate Legacy Transport frame.<a class="pilcrow" href="#section-3.2.1-4">¶</a></p>
<p id="section-3.2.1-5">Either as a single Authentication Message or a set of fragmented Authentication Message Pages, the structure is further wrapped by outer ASTM framing and the specific link framing.<a class="pilcrow" href="#section-3.2.1-5">¶</a></p>
</section>
</div>
<div id="auth-payload">
<section id="section-3.2.2">
          <h4 id="name-authentication-payload-fiel">
<a class="section-number selfRef" href="#section-3.2.2">3.2.2. </a><a class="section-name selfRef" href="#name-authentication-payload-fiel">Authentication Payload Field</a>
          </h4>
<p id="section-3.2.2-1"><a class="auto internal xref" href="#astm-auth">Figure 2</a> is the source data view of the data fields found in the Authentication Message as defined by <span>[<a class="cite xref" href="#F3411">F3411</a>]</span>. This data is placed into the <em>Authentication Payload</em> shown in <a class="auto internal xref" href="#astm-auth-page">Figure 1</a>, which spans multiple <em>Authentication Pages</em>.<a class="pilcrow" href="#section-3.2.2-1">¶</a></p>
<span id="name-astm-authentication-message-"></span><div id="astm-auth">
<figure id="figure-2">
            <div class="alignCenter art-text artwork" id="section-3.2.2-2.1">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+---------------+---------------+
|                     Authentication Headers                    |
|                               +---------------+---------------+
|                               |                               |
+---------------+---------------+                               |
.                                                               .
.                Authentication Data / Signature                .
.                                                               .
|                                                               |
+---------------+---------------+---------------+---------------+
|      ADL      |                                               |
+---------------+                                               |
.                                                               .
.                       Additional Data                         .
.                                                               .
|                                                               |
+---------------+---------------+---------------+---------------+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-2">Figure 2</a>:
<a class="selfRef" href="#name-astm-authentication-message-">ASTM Authentication Message Fields</a>
            </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-3.2.2-3">
            <dt id="section-3.2.2-3.1">
<em>Authentication Headers</em>:</dt>
            <dd id="section-3.2.2-3.2" style="margin-left: 1.5em">
              <p id="section-3.2.2-3.2.1">(6 octets)<a class="pilcrow" href="#section-3.2.2-3.2.1">¶</a></p>
<p id="section-3.2.2-3.2.2">As defined in <span>[<a class="cite xref" href="#F3411">F3411</a>]</span>.<a class="pilcrow" href="#section-3.2.2-3.2.2">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.2-3.3">
<em>Authentication Data / Signature</em>:</dt>
            <dd id="section-3.2.2-3.4" style="margin-left: 1.5em">
              <p id="section-3.2.2-3.4.1">(0 to 255 octets)<a class="pilcrow" href="#section-3.2.2-3.4.1">¶</a></p>
<p id="section-3.2.2-3.4.2">Opaque authentication data. The length of this payload is
            known through a field in the <em>Authentication Headers</em>
            (defined in <span>[<a class="cite xref" href="#F3411">F3411</a>]</span>).<a class="pilcrow" href="#section-3.2.2-3.4.2">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.2-3.5">
<em>Additional Data Length (ADL)</em>:</dt>
            <dd id="section-3.2.2-3.6" style="margin-left: 1.5em">
              <p id="section-3.2.2-3.6.1">(1 octet - unsigned)<a class="pilcrow" href="#section-3.2.2-3.6.1">¶</a></p>
<p id="section-3.2.2-3.6.2">Length in octets of <em>Additional Data</em>. The
          value of <em>ADL</em> is calculated as the minimum of <code>361 -
          Authentication Data / Signature Length</code> and <code>255</code>. Only
          present with <em>Additional Data</em>.<a class="pilcrow" href="#section-3.2.2-3.6.2">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.2-3.7"><em>Additional Data:</em></dt>
            <dd id="section-3.2.2-3.8" style="margin-left: 1.5em">
              <p id="section-3.2.2-3.8.1">(<em>ADL</em> octets)<a class="pilcrow" href="#section-3.2.2-3.8.1">¶</a></p>
<p id="section-3.2.2-3.8.2">Data that follows the <em>Authentication Data /
          Signature</em> but is not considered part of the <em>Authentication
          Data</em>, and thus is not covered by a signature. For DRIP, this field
          is used to carry Forward Error Correction (FEC) generated by
          transmitters and parsed by receivers as defined in <a class="auto internal xref" href="#fec-details">Section 5</a>.<a class="pilcrow" href="#section-3.2.2-3.8.2">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="sam-data">
<section id="section-3.2.3">
          <h4 id="name-sam-data-format">
<a class="section-number selfRef" href="#section-3.2.3">3.2.3. </a><a class="section-name selfRef" href="#name-sam-data-format">SAM Data Format</a>
          </h4>
<p id="section-3.2.3-1"><a class="auto internal xref" href="#sam-frame">Figure 3</a> is the general format to hold authentication data when using SAM and is placed inside the <em>Authentication Data / Signature</em> field in <a class="auto internal xref" href="#astm-auth">Figure 2</a>.<a class="pilcrow" href="#section-3.2.3-1">¶</a></p>
<span id="name-sam-data-format-2"></span><div id="sam-frame">
<figure id="figure-3">
            <div class="alignCenter art-text artwork" id="section-3.2.3-2.1">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+---------------+---------------+
|   SAM Type    |                                               |
+---------------+                                               |
.                                                               .
.                     SAM Authentication Data                   .
.                                                               .
|                                                               |
+---------------+---------------+---------------+---------------+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-3">Figure 3</a>:
<a class="selfRef" href="#name-sam-data-format-2">SAM Data Format</a>
            </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-3.2.3-3">
            <dt id="section-3.2.3-3.1">
<em>SAM Type</em>:</dt>
            <dd id="section-3.2.3-3.2" style="margin-left: 1.5em">
              <p id="section-3.2.3-3.2.1">(1 octet)<a class="pilcrow" href="#section-3.2.3-3.2.1">¶</a></p>
<p id="section-3.2.3-3.2.2">The following SAM Types are allocated to DRIP:<a class="pilcrow" href="#section-3.2.3-3.2.2">¶</a></p>
<span id="name-drip-sam-types"></span><table class="center" id="table-1">
                <caption>
<a class="selfRef" href="#table-1">Table 1</a>:
<a class="selfRef" href="#name-drip-sam-types">DRIP SAM Types</a>
                </caption>
<thead>
                  <tr>
                    <th class="text-left" colspan="1" rowspan="1">SAM Type</th>
                    <th class="text-left" colspan="1" rowspan="1">Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="text-left" colspan="1" rowspan="1">0x01</td>
                    <td class="text-left" colspan="1" rowspan="1">DRIP Link (<a class="auto internal xref" href="#drip-link">Section 4.2</a>)</td>
                  </tr>
                  <tr>
                    <td class="text-left" colspan="1" rowspan="1">0x02</td>
                    <td class="text-left" colspan="1" rowspan="1">DRIP Wrapper (<a class="auto internal xref" href="#drip-wrapper">Section 4.3</a>)</td>
                  </tr>
                  <tr>
                    <td class="text-left" colspan="1" rowspan="1">0x03</td>
                    <td class="text-left" colspan="1" rowspan="1">DRIP Manifest (<a class="auto internal xref" href="#drip-manifest">Section 4.4</a>)</td>
                  </tr>
                  <tr>
                    <td class="text-left" colspan="1" rowspan="1">0x04</td>
                    <td class="text-left" colspan="1" rowspan="1">DRIP Frame (<a class="auto internal xref" href="#drip-frame">Section 4.5</a>)</td>
                  </tr>
                </tbody>
              </table>
</dd>
          <dd class="break"></dd>
</dl>
<aside id="section-3.2.3-4">
            <p id="section-3.2.3-4.1">Note: ASTM International is the owner of these code points as they are defined in <span>[<a class="cite xref" href="#F3411">F3411</a>]</span>. In accordance with Annex 5 of <span>[<a class="cite xref" href="#F3411">F3411</a>]</span>, the International Civil Aviation Organization (ICAO) has been selected by ASTM as the registrar to manage allocations of these code points. The list is available at <span>[<a class="cite xref" href="#ASTM-Remote-ID">ASTM-Remote-ID</a>]</span>.<a class="pilcrow" href="#section-3.2.3-4.1">¶</a></p>
</aside>
<span class="break"></span><dl class="dlParallel" id="section-3.2.3-5">
            <dt id="section-3.2.3-5.1">
<em>SAM Authentication Data</em>:</dt>
            <dd id="section-3.2.3-5.2" style="margin-left: 1.5em">
              <p id="section-3.2.3-5.2.1">(0 to 200 octets)<a class="pilcrow" href="#section-3.2.3-5.2.1">¶</a></p>
<p id="section-3.2.3-5.2.2">Contains opaque authentication data formatted as defined by the preceding SAM Type.<a class="pilcrow" href="#section-3.2.3-5.2.2">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="drip-restrictions">
<section id="section-3.2.4">
          <h4 id="name-astm-broadcast-rid-constrai">
<a class="section-number selfRef" href="#section-3.2.4">3.2.4. </a><a class="section-name selfRef" href="#name-astm-broadcast-rid-constrai">ASTM Broadcast RID Constraints</a>
          </h4>
<div id="wireless-frame-constraints">
<section id="section-3.2.4.1">
            <h5 id="name-wireless-frame-constraints">
<a class="section-number selfRef" href="#section-3.2.4.1">3.2.4.1. </a><a class="section-name selfRef" href="#name-wireless-frame-constraints">Wireless Frame Constraints</a>
            </h5>
<p id="section-3.2.4.1-1">A UA has the option to broadcast using Bluetooth (4.x and 5.x), Wi-Fi NAN, or IEEE 802.11 Beacon; see <a class="auto internal xref" href="#reqs">Section 6</a>. With Bluetooth, FAA and other Civil Aviation Authorities (CAA) mandate transmitting simultaneously over both 4.x and 5.x. The same application-layer information defined in <span>[<a class="cite xref" href="#F3411">F3411</a>]</span> <span class="bcp14">MUST</span> be transmitted over all the physical-layer interfaces performing RID, because Observer transports may be limited. 
  If an Observer can
  support multiple transports, it should use (display, report, etc.) the latest
  data regardless of the transport over which that data was received.<a class="pilcrow" href="#section-3.2.4.1-1">¶</a></p>
<p id="section-3.2.4.1-2">Bluetooth 4.x presents a payload-size challenge in that it can only transmit 25 octets of payload per frame, while other transports can support larger payloads per frame.  As <span>[<a class="cite xref" href="#F3411">F3411</a>]</span> message formats are the same for all media,
  and their framing was designed to fit within these legacy constraints,
  Extended Transports cannot send larger messages;
  instead, the Message Pack format encapsulates multiple messages
  (each of which fits within these legacy constraints).<a class="pilcrow" href="#section-3.2.4.1-2">¶</a></p>
<p id="section-3.2.4.1-3">By definition Extended Transports provide FEC,
  but Legacy Transports lack FEC. Thus over Legacy Transports, paged
  Authentication Messages may suffer the loss of one or more pages.
  This would result in delivery to the Observer application of incomplete
  (typically unusable) messages, so DRIP FEC (<a class="auto internal xref" href="#fec-details">Section 5</a>) is specified
  to enable recovery of a single lost page and thereby reduce the likelihood
  of receiving incompletely reconstructable Authentication Messages.
Authentication Messages sent using Extended Transports do not suffer this issue, as the full message (all pages) is sent using a single Message Pack. Furthermore, the use of one-way RF broadcasts prohibits the use of any congestion-control or loss-recovery schemes that require ACKs or NACKs.<a class="pilcrow" href="#section-3.2.4.1-3">¶</a></p>
</section>
</div>
<div id="paged-authentication-message-constraints">
<section id="section-3.2.4.2">
            <h5 id="name-paged-authentication-messag">
<a class="section-number selfRef" href="#section-3.2.4.2">3.2.4.2. </a><a class="section-name selfRef" href="#name-paged-authentication-messag">Paged Authentication Message Constraints</a>
            </h5>
<p id="section-3.2.4.2-1">To keep consistent formatting across the different transports (Legacy and Extended) and their independent restrictions, the authentication data being sent is <span class="bcp14">REQUIRED</span> to fit within the page limit that the most constrained existing transport can support. Under Broadcast RID, the Extended Transport that can hold the least amount of authentication data is Bluetooth 5.x at 9 pages.<a class="pilcrow" href="#section-3.2.4.2-1">¶</a></p>
<p id="section-3.2.4.2-2">As such, DRIP transmitters are <span class="bcp14">REQUIRED</span> to adhere to the following when using the Authentication Message:<a class="pilcrow" href="#section-3.2.4.2-2">¶</a></p>
<ol class="normal type-1" id="section-3.2.4.2-3" start="1" type="1">
       <li id="section-3.2.4.2-3.1">
                <em>Authentication Data / Signature</em> data
       <span class="bcp14">MUST</span> fit in the first 9 pages (Page Numbers 0
       through 8).<a class="pilcrow" href="#section-3.2.4.2-3.1">¶</a>
</li>
              <li id="section-3.2.4.2-3.2">The <em>Length</em> field in the <em>Authentication
              Headers</em> (which encodes the length in octets of
              <em>Authentication Data / Signature</em> only) <span class="bcp14">MUST NOT</span> exceed the value of 201. This includes the SAM Type
              but excludes <em>Additional Data</em>.<a class="pilcrow" href="#section-3.2.4.2-3.2">¶</a>
</li>
            </ol>
</section>
</div>
<div id="astm-timestamps">
<section id="section-3.2.4.3">
            <h5 id="name-timestamps">
<a class="section-number selfRef" href="#section-3.2.4.3">3.2.4.3. </a><a class="section-name selfRef" href="#name-timestamps">Timestamps</a>
            </h5>
<p id="section-3.2.4.3-1">In ASTM <span>[<a class="cite xref" href="#F3411">F3411</a>]</span>, timestamps are a Unix-style timestamp with an epoch of <code>2019-01-01 00:00:00 UTC</code>. For DRIP, this format is adopted for Authentication to keep a common time format in Broadcast payloads.<a class="pilcrow" href="#section-3.2.4.3-1">¶</a></p>
<p id="section-3.2.4.3-2">Under DRIP, there are two timestamps defined: <code>Valid Not Before (VNB)</code> and <code>Valid Not After (VNA)</code>.<a class="pilcrow" href="#section-3.2.4.3-2">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.2.4.3-3">
              <dt id="section-3.2.4.3-3.1">Valid Not Before (VNB) Timestamp:</dt>
              <dd id="section-3.2.4.3-3.2" style="margin-left: 1.5em">
                <p id="section-3.2.4.3-3.2.1">(4 octets)<a class="pilcrow" href="#section-3.2.4.3-3.2.1">¶</a></p>
<p id="section-3.2.4.3-3.2.2">Timestamp denoting the recommended time at which to start trusting data. <span class="bcp14">MUST</span> follow the format defined in <span>[<a class="cite xref" href="#F3411">F3411</a>]</span> as described above. <span class="bcp14">MUST</span> be set no earlier than the time the signature (across a given structure) is generated.<a class="pilcrow" href="#section-3.2.4.3-3.2.2">¶</a></p>
</dd>
              <dd class="break"></dd>
<dt id="section-3.2.4.3-3.3">Valid Not After (VNA) Timestamp:</dt>
              <dd id="section-3.2.4.3-3.4" style="margin-left: 1.5em">
                <p id="section-3.2.4.3-3.4.1">(4 octets)<a class="pilcrow" href="#section-3.2.4.3-3.4.1">¶</a></p>
<p id="section-3.2.4.3-3.4.2">Timestamp denoting the recommended time at which to stop trusting data. <span class="bcp14">MUST</span> follow the format defined in <span>[<a class="cite xref" href="#F3411">F3411</a>]</span> as described above. Has an offset (relative to <code>VNB</code>) to avoid replay attacks. The exact offset is not defined in this document. Best practice for identifying an acceptable offset should be used and should take into consideration the UA environment, propagation characteristics of the messages being sent, and clock differences between the UA and Observers.
  For UA signatures in scenarios typical as of 2024, a reasonable offset would be
  to set <code>VNA</code> approximately 2 minutes after <code>VNB</code>; see <a class="auto internal xref" href="#operational-proof">Appendix B</a> for examples
  that may aid in tuning this value.<a class="pilcrow" href="#section-3.2.4.3-3.4.2">¶</a></p>
</dd>
            <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="drip-authentication-formats">
<section id="section-4">
      <h2 id="name-drip-authentication-formats">
<a class="section-number selfRef" href="#section-4">4. </a><a class="section-name selfRef" href="#name-drip-authentication-formats">DRIP Authentication Formats</a>
      </h2>
<p id="section-4-1">All formats defined in this section are contained in the <em>Authentication Data / Signature</em> field in <a class="auto internal xref" href="#astm-auth">Figure 2</a> and use the Specific Authentication Method (SAM, Authentication Type 0x5). The first octet of the <em>Authentication Data / Signature</em> of <a class="auto internal xref" href="#astm-auth">Figure 2</a> is used to multiplex among these various formats.<a class="pilcrow" href="#section-4-1">¶</a></p>
<p id="section-4-2">
   When sending data over a medium that does not have underlying FEC,
   for example Legacy Transports, then FEC (per <a class="auto internal xref" href="#fec-details">Section 5</a>) <span class="bcp14">MUST</span> be used.<a class="pilcrow" href="#section-4-2">¶</a></p>
<p id="section-4-3">Examples of Link, Wrapper, and Manifest are shown as part of an operational schedule in <a class="auto internal xref" href="#raw-example">Appendix B.2.1</a>.<a class="pilcrow" href="#section-4-3">¶</a></p>
<div id="bas">
<section id="section-4.1">
        <h3 id="name-ua-signed-evidence-structur">
<a class="section-number selfRef" href="#section-4.1">4.1. </a><a class="section-name selfRef" href="#name-ua-signed-evidence-structur">UA-Signed Evidence Structure</a>
        </h3>
<p id="section-4.1-1">The <em>UA-Signed Evidence Structure</em> (<a class="auto internal xref" href="#drip-data">Figure 4</a>) is used by the UA during flight to sign over information elements using the private key associated with the current UA DET. It is encapsulated by the <em>SAM Authentication Data</em> field of <a class="auto internal xref" href="#sam-frame">Figure 3</a>.<a class="pilcrow" href="#section-4.1-1">¶</a></p>
<p id="section-4.1-2">This structure is used by the DRIP Wrapper (<a class="auto internal xref" href="#drip-wrapper">Section 4.3</a>), Manifest (<a class="auto internal xref" href="#drip-manifest">Section 4.4</a>), and Frame (<a class="auto internal xref" href="#drip-frame">Section 4.5</a>). DRIP Link (<a class="auto internal xref" href="#drip-link">Section 4.2</a>) <span class="bcp14">MUST NOT</span> use it, as it will not fit in the ASTM Authentication Message with its intended content (i.e., a Broadcast Endorsement).<a class="pilcrow" href="#section-4.1-2">¶</a></p>
<span id="name-endorsement-structure-for-u"></span><div id="drip-data">
<figure id="figure-4">
          <div class="alignCenter art-text artwork" id="section-4.1-3.1">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+---------------+---------------+
|                      VNB Timestamp by UA                      |
+---------------+---------------+---------------+---------------+
|                      VNA Timestamp by UA                      |
+---------------+---------------+---------------+---------------+
|                                                               |
.                                                               .
.                            Evidence                           .
.                                                               .
|                                                               |
+---------------+---------------+---------------+---------------+
|                                                               |
|                              UA                               |
|                        DRIP Entity Tag                        |
|                                                               |
+---------------+---------------+---------------+---------------+
|                                                               |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
|                          UA Signature                         |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
+---------------+---------------+---------------+---------------+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-4">Figure 4</a>:
<a class="selfRef" href="#name-endorsement-structure-for-u">Endorsement Structure for UA-Signed Evidence</a>
          </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4.1-4">
          <dt id="section-4.1-4.1">
<em>Valid Not Before (VNB) Timestamp by UA</em>:</dt>
          <dd id="section-4.1-4.2" style="margin-left: 1.5em">
            <p id="section-4.1-4.2.1">(4 octets)<a class="pilcrow" href="#section-4.1-4.2.1">¶</a></p>
<p id="section-4.1-4.2.2">See <a class="auto internal xref" href="#astm-timestamps">Section 3.2.4.3</a>. Set by the UA.<a class="pilcrow" href="#section-4.1-4.2.2">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-4.3">
<em>Valid Not After (VNA) Timestamp by UA</em>:</dt>
          <dd id="section-4.1-4.4" style="margin-left: 1.5em">
            <p id="section-4.1-4.4.1">(4 octets)<a class="pilcrow" href="#section-4.1-4.4.1">¶</a></p>
<p id="section-4.1-4.4.2">See <a class="auto internal xref" href="#astm-timestamps">Section 3.2.4.3</a>. Set by the UA.<a class="pilcrow" href="#section-4.1-4.4.2">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-4.5">
<em>Evidence</em>:</dt>
          <dd id="section-4.1-4.6" style="margin-left: 1.5em">
            <p id="section-4.1-4.6.1">(0 to 112 octets)<a class="pilcrow" href="#section-4.1-4.6.1">¶</a></p>
<p id="section-4.1-4.6.2">The <em>Evidence</em> field <span class="bcp14">MUST</span> be filled in with data in the form of an opaque object specified in the DRIP Wrapper (<a class="auto internal xref" href="#drip-wrapper">Section 4.3</a>), Manifest (<a class="auto internal xref" href="#drip-manifest">Section 4.4</a>), or Frame (<a class="auto internal xref" href="#drip-frame">Section 4.5</a>).<a class="pilcrow" href="#section-4.1-4.6.2">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-4.7">
<em>UA DRIP Entity Tag</em>:</dt>
          <dd id="section-4.1-4.8" style="margin-left: 1.5em">
            <p id="section-4.1-4.8.1">(16 octets)<a class="pilcrow" href="#section-4.1-4.8.1">¶</a></p>
<p id="section-4.1-4.8.2">
  This is a DET <span>[<a class="cite xref" href="#RFC9374">RFC9374</a>]</span> currently being used by the UA for authentication;
  it is assumed to be a Specific Session ID (a type of UAS ID typically also
  used by the UA in the Basic ID Message).<a class="pilcrow" href="#section-4.1-4.8.2">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-4.9">
<em>UA Signature</em>:</dt>
          <dd id="section-4.1-4.10" style="margin-left: 1.5em">
            <p id="section-4.1-4.10.1">(64 octets)<a class="pilcrow" href="#section-4.1-4.10.1">¶</a></p>
<p id="section-4.1-4.10.2">Signature over the concatenation of preceding fields (<em>VNB</em>, <em>VNA</em>, <em>Evidence</em>, and <em>UA DET</em>) using the keypair of the UA DET. The signature algorithm is specified by the Hierarchical Host Identity Tags (HHIT) Suite ID of the DET.<a class="pilcrow" href="#section-4.1-4.10.2">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.1-5">When using this structure, the UA is minimally self-endorsing its DET. The HI of the UA DET can be looked up by mechanisms described in <span>[<a class="cite xref" href="#I-D.ietf-drip-registries">DRIP-REG</a>]</span> or by extracting it from a Broadcast Endorsement (see Sections <a class="auto internal xref" href="#drip-link">4.2</a> and <a class="auto internal xref" href="#drip-recommendations">6.3</a>).<a class="pilcrow" href="#section-4.1-5">¶</a></p>
</section>
</div>
<div id="drip-link">
<section id="section-4.2">
        <h3 id="name-drip-link">
<a class="section-number selfRef" href="#section-4.2">4.2. </a><a class="section-name selfRef" href="#name-drip-link">DRIP Link</a>
        </h3>
<p id="section-4.2-1">This SAM Type (<a class="auto internal xref" href="#link-fig">Figure 5</a>) is used to transmit Broadcast Endorsements. For example,  the <em>BE: HDA, UA</em> is sent (see <a class="auto internal xref" href="#drip-recommendations">Section 6.3</a>) as a DRIP Link message.<a class="pilcrow" href="#section-4.2-1">¶</a></p>
<p id="section-4.2-2">DRIP Link is important as its contents are used to provide trust in the DET/HI pair that the UA is currently broadcasting. This message does not require Internet connectivity to perform signature verification of the contents when the DIME DET/HI is in the Observer's cache. It also provides the UA HI, when it is filled with a <code>BE: HDA, UA</code>, so that connectivity is not required when performing signature verification of other DRIP Authentication Messages.<a class="pilcrow" href="#section-4.2-2">¶</a></p>
<p id="section-4.2-3">
  Various Broadcast Endorsements are sent during each UAS flight operation to ensure
  that the full Broadcast Endorsement chain is available offline.
See <a class="auto internal xref" href="#drip-recommendations">Section 6.3</a> for further details.<a class="pilcrow" href="#section-4.2-3">¶</a></p>
<span id="name-broadcast-endorsement-drip-"></span><div id="link-fig">
<figure id="figure-5">
          <div class="alignCenter art-text artwork" id="section-4.2-4.1">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+---------------+---------------+
|                    VNB Timestamp by Parent                    |
+---------------+---------------+---------------+---------------+
|                    VNA Timestamp by Parent                    |
+---------------+---------------+---------------+---------------+
|                                                               |
|                              DET                              |
|                            of Child                           |
|                                                               |
+---------------+---------------+---------------+---------------+
|                                                               |
|                                                               |
|                                                               |
|                           HI of Child                         |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
+---------------+---------------+---------------+---------------+
|                                                               |
|                              DET                              |
|                           of Parent                           |
|                                                               |
+---------------+---------------+---------------+---------------+
|                                                               |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
|                     Signature by Parent                       |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
+---------------+---------------+---------------+---------------+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-5">Figure 5</a>:
<a class="selfRef" href="#name-broadcast-endorsement-drip-">Broadcast Endorsement / DRIP Link</a>
          </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4.2-5">
          <dt id="section-4.2-5.1">
<em>VNB Timestamp by Parent</em>:</dt>
          <dd id="section-4.2-5.2" style="margin-left: 1.5em">
            <p id="section-4.2-5.2.1">(4 octets)<a class="pilcrow" href="#section-4.2-5.2.1">¶</a></p>
<p id="section-4.2-5.2.2">See <a class="auto internal xref" href="#astm-timestamps">Section 3.2.4.3</a>. Set by Parent Entity.<a class="pilcrow" href="#section-4.2-5.2.2">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-5.3">
<em>VNA Timestamp by Parent</em>:</dt>
          <dd id="section-4.2-5.4" style="margin-left: 1.5em">
            <p id="section-4.2-5.4.1">(4 octets)<a class="pilcrow" href="#section-4.2-5.4.1">¶</a></p>
<p id="section-4.2-5.4.2">See <a class="auto internal xref" href="#astm-timestamps">Section 3.2.4.3</a>. Set by Parent Entity.<a class="pilcrow" href="#section-4.2-5.4.2">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-5.5">
<em>DET of Child</em>:</dt>
          <dd id="section-4.2-5.6" style="margin-left: 1.5em">
            <p id="section-4.2-5.6.1">(16 octets)<a class="pilcrow" href="#section-4.2-5.6.1">¶</a></p>
<p id="section-4.2-5.6.2">DRIP Entity Tag of Child Entity.<a class="pilcrow" href="#section-4.2-5.6.2">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-5.7">
<em>HI of Child</em>:</dt>
          <dd id="section-4.2-5.8" style="margin-left: 1.5em">
            <p id="section-4.2-5.8.1">(32 octets)<a class="pilcrow" href="#section-4.2-5.8.1">¶</a></p>
<p id="section-4.2-5.8.2">Host Identity of Child Entity.<a class="pilcrow" href="#section-4.2-5.8.2">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-5.9">
<em>DET of Parent</em>:</dt>
          <dd id="section-4.2-5.10" style="margin-left: 1.5em">
            <p id="section-4.2-5.10.1">(16 octets)<a class="pilcrow" href="#section-4.2-5.10.1">¶</a></p>
<p id="section-4.2-5.10.2">DRIP Entity Tag of Parent Entity in DIME Hierarchy.<a class="pilcrow" href="#section-4.2-5.10.2">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-5.11">
<em>Signature by Parent</em>:</dt>
          <dd id="section-4.2-5.12" style="margin-left: 1.5em">
            <p id="section-4.2-5.12.1">(64 octets)<a class="pilcrow" href="#section-4.2-5.12.1">¶</a></p>
<p id="section-4.2-5.12.2">Signature over concatenation of preceding fields (<em>VNB</em>, <em>VNA</em>, <em>DET of Child</em>, <em>HI of Child</em>, and <em>DET of Parent</em>) using the keypair of the Parent DET.<a class="pilcrow" href="#section-4.2-5.12.2">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.2-6">This DRIP Authentication Message is used in conjunction with other DRIP SAM Types (such as the Manifest or the Wrapper) that contain data (e.g., the ASTM Location/Vector Message, Message Type 0x2) that is guaranteed to be unique, unpredictable, and easily cross-checked by the receiving device.<a class="pilcrow" href="#section-4.2-6">¶</a></p>
<p id="section-4.2-7">A hash of the final link (<code>BE: HDA on UA</code>) in the Broadcast Endorsement chain <span class="bcp14">MUST</span> be included in each DRIP Manifest (<a class="auto internal xref" href="#drip-manifest">Section 4.4</a>).<a class="pilcrow" href="#section-4.2-7">¶</a></p>
<p id="section-4.2-8">Note: The Endorsement that proves a DET is registered <span class="bcp14">MUST</span> come from its immediate parent in the registration hierarchy, e.g., a DRIP Identity Management Entity (DIME) <span>[<a class="cite xref" href="#I-D.ietf-drip-registries">DRIP-REG</a>]</span>. In the definitive hierarchy, the parent of the UA is its HHIT Domain Authority (HDA), the parent of an HDA is its Registered Assigning
Authority (RAA), etc. It is also assumed that all DRIP-aware entities use a DET as their identifier 
during interactions with other DRIP-aware entities.<a class="pilcrow" href="#section-4.2-8">¶</a></p>
</section>
</div>
<div id="drip-wrapper">
<section id="section-4.3">
        <h3 id="name-drip-wrapper">
<a class="section-number selfRef" href="#section-4.3">4.3. </a><a class="section-name selfRef" href="#name-drip-wrapper">DRIP Wrapper</a>
        </h3>
<p id="section-4.3-1">This SAM Type is used to wrap and sign over a list of other <span>[<a class="cite xref" href="#F3411">F3411</a>]</span> Broadcast RID messages.<a class="pilcrow" href="#section-4.3-1">¶</a></p>
<p id="section-4.3-2">The <em>Evidence</em> field of the <em>UA-Signed Evidence Structure</em> (<a class="auto internal xref" href="#bas">Section 4.1</a>) is populated with up to four ASTM Messages <span>[<a class="cite xref" href="#F3411">F3411</a>]</span> in a contiguous octet sequence. Only ASTM Message Types 0x0, 0x1, 0x3, 0x4, and 0x5 are allowed and must be in Message Type order as defined by <span>[<a class="cite xref" href="#F3411">F3411</a>]</span>. These messages <span class="bcp14">MUST</span> include the Message Type and Protocol Version octet and <span class="bcp14">MUST NOT</span> include the Message Counter octet (thus are fixed at 25 octets in length).<a class="pilcrow" href="#section-4.3-2">¶</a></p>
<div id="wrapped-count-format-validation">
<section id="section-4.3.1">
          <h4 id="name-wrapped-count-and-format-va">
<a class="section-number selfRef" href="#section-4.3.1">4.3.1. </a><a class="section-name selfRef" href="#name-wrapped-count-and-format-va">Wrapped Count and Format Validation</a>
          </h4>
<p id="section-4.3.1-1">When decoding a DRIP Wrapper on a receiver, a calculation of the number of messages wrapped and a validation <span class="bcp14">MUST</span> be performed by using the number of octets (defined as <code>wrapperLength</code>) between the <em>VNA Timestamp by UA</em> and the <em>UA DET</em> as shown in <a class="auto internal xref" href="#wrapper-check">Figure 6</a>.<a class="pilcrow" href="#section-4.3.1-1">¶</a></p>
<span id="name-pseudocode-for-wrapper-vali"></span><div id="wrapper-check">
<figure id="figure-6">
            <div class="lang-pseudocode sourcecode" id="section-4.3.1-2.1">
<pre>&lt;CODE BEGINS&gt;
if (wrapperLength MOD 25) != 0 {
  return DECODE_FAILURE;
}
wrappedCount = wrapperLength / 25;
if (wrappedCount == 0) {
  // DECODE_SUCCESS; treat as DRIP Wrapper over extended transport
}
else if (wrappedCount &gt; 4) {
  return DECODE_FAILURE;
} else {
  // DECODE_SUCCESS; treat as standard DRIP Wrapper
}

&lt;CODE ENDS&gt;</pre>
</div>
<figcaption><a class="selfRef" href="#figure-6">Figure 6</a>:
<a class="selfRef" href="#name-pseudocode-for-wrapper-vali">Pseudocode for Wrapper Validation and Number of Messages Calculation</a>
            </figcaption></figure>
</div>
</section>
</div>
<div id="extended-wrapper">
<section id="section-4.3.2">
          <h4 id="name-wrapper-over-extended-trans">
<a class="section-number selfRef" href="#section-4.3.2">4.3.2. </a><a class="section-name selfRef" href="#name-wrapper-over-extended-trans">Wrapper over Extended Transports</a>
          </h4>
<p id="section-4.3.2-1">When using Extended Transports, an optimization to DRIP Wrapper can be made to sign over co-located data in an ASTM Message Pack (Message Type 0xF).<a class="pilcrow" href="#section-4.3.2-1">¶</a></p>
<p id="section-4.3.2-2">To perform this optimization, the <em>UA-Signed Evidence Structure</em> is filled with the ASTM Messages to be in the ASTM Message Pack, the signature is generated, and then the <em>Evidence</em> field is cleared, leaving the encoded form shown in <a class="auto internal xref" href="#set-sig">Figure 7</a>.<a class="pilcrow" href="#section-4.3.2-2">¶</a></p>
<span id="name-drip-wrapper-over-extended-"></span><div id="set-sig">
<figure id="figure-7">
            <div class="alignCenter art-text artwork" id="section-4.3.2-3.1">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+---------------+---------------+
|                      VNB Timestamp by UA                      |
+---------------+---------------+---------------+---------------+
|                      VNA Timestamp by UA                      |
+---------------+---------------+---------------+---------------+
|                                                               |
|                              UA                               |
|                        DRIP Entity Tag                        |
|                                                               |
+---------------+---------------+---------------+---------------+
|                                                               |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
|                          UA Signature                         |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
+---------------+---------------+---------------+---------------+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-7">Figure 7</a>:
<a class="selfRef" href="#name-drip-wrapper-over-extended-">DRIP Wrapper over Extended Transports</a>
            </figcaption></figure>
</div>
<p id="section-4.3.2-4">To verify the signature, the receiver <span class="bcp14">MUST</span> concatenate all the messages in the Message Pack (excluding the Authentication Message found in the same Message Pack) in ASTM Message Type order and set the <em>Evidence</em> field of the <em>UA-Signed Evidence Structure</em> before performing signature verification.<a class="pilcrow" href="#section-4.3.2-4">¶</a></p>
<p id="section-4.3.2-5">The functionality of a Wrapper in this form is equivalent to Message Set Signature (Authentication Type 0x3) when running over Extended Transports. The Wrapper provides the same format but over both Extended and Legacy Transports, which allows the transports to be similar. Message Set Signature also implies using the ASTM validator system architecture, which depends on Internet connectivity for verification that the receiver may not have at the time an Authentication Message is received. This is something the Wrapper, and all DRIP Authentication Formats, avoid when the UA key is obtained via a DRIP Link Authentication Message.<a class="pilcrow" href="#section-4.3.2-5">¶</a></p>
</section>
</div>
<div id="wrapper-limitations">
<section id="section-4.3.3">
          <h4 id="name-wrapper-limitations">
<a class="section-number selfRef" href="#section-4.3.3">4.3.3. </a><a class="section-name selfRef" href="#name-wrapper-limitations">Wrapper Limitations</a>
          </h4>
<p id="section-4.3.3-1">The primary limitation of the Wrapper is the bounding of up to four ASTM Messages that can be sent within it. Another limitation is that the format cannot be used as a surrogate for messages it is wrapping due to the potential that an Observer on the ground does not support DRIP. Thus, when a Wrapper is being used, the wrapped data must effectively be sent twice, once as a single-framed message (as specified in <span>[<a class="cite xref" href="#F3411">F3411</a>]</span>) and again within the Wrapper.<a class="pilcrow" href="#section-4.3.3-1">¶</a></p>
</section>
</div>
</section>
</div>
<div id="drip-manifest">
<section id="section-4.4">
        <h3 id="name-drip-manifest">
<a class="section-number selfRef" href="#section-4.4">4.4. </a><a class="section-name selfRef" href="#name-drip-manifest">DRIP Manifest</a>
        </h3>
<p id="section-4.4-1">This SAM Type is used to create message manifests that contain hashes of previously sent ASTM Messages.<a class="pilcrow" href="#section-4.4-1">¶</a></p>
<p id="section-4.4-2">By hashing previously sent messages and signing them, we gain trust in a UA's previous reports without retransmitting them. This is a way to evade the limitation of a maximum of four messages in the Wrapper (<a class="auto internal xref" href="#wrapper-limitations">Section 4.3.3</a>) and greatly reduce overhead.<a class="pilcrow" href="#section-4.4-2">¶</a></p>
<p id="section-4.4-3">Observers <span class="bcp14">MUST</span> hash all received ASTM Messages and cross-check them against hashes in received Manifests.<a class="pilcrow" href="#section-4.4-3">¶</a></p>
<p id="section-4.4-4">Judicious use of a Manifest enables an entire Broadcast RID message stream to be strongly authenticated with less than 100% overhead relative to a completely unauthenticated message stream (see <a class="auto internal xref" href="#drip-recommendations">Section 6.3</a> and <a class="auto internal xref" href="#operational-proof">Appendix B</a>).<a class="pilcrow" href="#section-4.4-4">¶</a></p>
<p id="section-4.4-5">The <em>Evidence</em> field of the <em>UA-Signed Evidence Structure</em> (<a class="auto internal xref" href="#bas">Section 4.1</a>) is populated with 8-octet hashes of <span>[<a class="cite xref" href="#F3411">F3411</a>]</span> Broadcast RID messages (up to 11) and three special hashes (<a class="auto internal xref" href="#block-hashes">Section 4.4.2</a>). All of these hashes <span class="bcp14">MUST</span> be concatenated to form a contiguous octet sequence in the <em>Evidence</em> field. It is <span class="bcp14">RECOMMENDED</span> that the maximum number of ASTM Message Hashes used be 10 (see <a class="auto internal xref" href="#eleven-astm-messages">Appendix B.1.1.2</a>).<a class="pilcrow" href="#section-4.4-5">¶</a></p>
<p id="section-4.4-6">The <em>Previous Manifest Hash</em>, <em>Current Manifest Hash</em>, and <em>DRIP Link (BE: HDA, UA) Hash</em> <span class="bcp14">MUST</span> always come before the <em>ASTM Message Hashes</em> as seen in <a class="auto internal xref" href="#manifest-fig">Figure 8</a>.<a class="pilcrow" href="#section-4.4-6">¶</a></p>
<p id="section-4.4-7">An Observer <span class="bcp14">MUST</span> use the Manifest to verify each ASTM Message hashed therein that it has previously received. It can do this without having received them all. A Manifest <span class="bcp14">SHOULD</span> typically encompass a single transmission cycle of messages being sent; see <a class="auto internal xref" href="#operational-recommendations">Section 6.4</a> and <a class="auto internal xref" href="#operational-proof">Appendix B</a>.<a class="pilcrow" href="#section-4.4-7">¶</a></p>
<span id="name-drip-manifest-evidence-stru"></span><div id="manifest-fig">
<figure id="figure-8">
          <div class="alignCenter art-text artwork" id="section-4.4-8.1">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+---------------+---------------+
|                       Previous Manifest                       |
|                              Hash                             |
+---------------+---------------+---------------+---------------+
|                       Current Manifest                        |
|                              Hash                             |
+---------------+---------------+---------------+---------------+
|                      DRIP Link (BE: HDA, UA)                  |
|                              Hash                             |
+---------------+---------------+---------------+---------------+
|                                                               |
.                                                               .
.                      ASTM Message Hashes                      .
.                                                               .
|                                                               |
+---------------+---------------+---------------+---------------+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-8">Figure 8</a>:
<a class="selfRef" href="#name-drip-manifest-evidence-stru">DRIP Manifest Evidence Structure</a>
          </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4.4-9">
          <dt id="section-4.4-9.1">
<em>Previous Manifest Hash</em>:</dt>
          <dd id="section-4.4-9.2" style="margin-left: 1.5em">
            <p id="section-4.4-9.2.1">(8 octets)<a class="pilcrow" href="#section-4.4-9.2.1">¶</a></p>
<p id="section-4.4-9.2.2">Hash of the previously sent Manifest Message.<a class="pilcrow" href="#section-4.4-9.2.2">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-4.4-9.3">
<em>Current Manifest Hash</em>:</dt>
          <dd id="section-4.4-9.4" style="margin-left: 1.5em">
            <p id="section-4.4-9.4.1">(8 octets)<a class="pilcrow" href="#section-4.4-9.4.1">¶</a></p>
<p id="section-4.4-9.4.2">Hash of the current Manifest Message.<a class="pilcrow" href="#section-4.4-9.4.2">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-4.4-9.5">
<em>DRIP Link (BE: HDA, UA)</em>:</dt>
          <dd id="section-4.4-9.6" style="margin-left: 1.5em">
            <p id="section-4.4-9.6.1">(8 octets)<a class="pilcrow" href="#section-4.4-9.6.1">¶</a></p>
<p id="section-4.4-9.6.2">Hash of the DRIP Link Authentication Message carrying <code>BE: HDA, UA</code> (see <a class="auto internal xref" href="#drip-link">Section 4.2</a>).<a class="pilcrow" href="#section-4.4-9.6.2">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-4.4-9.7">
<em>ASTM Message Hash</em>:</dt>
          <dd id="section-4.4-9.8" style="margin-left: 1.5em">
            <p id="section-4.4-9.8.1">(8 octets)<a class="pilcrow" href="#section-4.4-9.8.1">¶</a></p>
<p id="section-4.4-9.8.2">Hash of a single full ASTM Message using hash operations described in <a class="auto internal xref" href="#hash-op">Section 4.4.3</a>.<a class="pilcrow" href="#section-4.4-9.8.2">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<div id="hash-count-format-validation">
<section id="section-4.4.1">
          <h4 id="name-hash-count-and-format-valid">
<a class="section-number selfRef" href="#section-4.4.1">4.4.1. </a><a class="section-name selfRef" href="#name-hash-count-and-format-valid">Hash Count and Format Validation</a>
          </h4>
<p id="section-4.4.1-1">When decoding a DRIP Manifest on a receiver, a calculation of the number of hashes and a validation can be performed by using the number of octets between the <em>UA DET</em> and the <em>VNB Timestamp by UA</em> (defined as    
<code>manifestLength</code>) such as shown in <a class="auto internal xref" href="#manifest-check">Figure 9</a>.<a class="pilcrow" href="#section-4.4.1-1">¶</a></p>
<span id="name-pseudocode-for-manifest-san"></span><div id="manifest-check">
<figure id="figure-9">
            <div class="lang-pseudocode sourcecode" id="section-4.4.1-2.1">
<pre>&lt;CODE BEGINS&gt;
if (manifestLength MOD 8) != 0 {
  return DECODE_FAILURE
}
hashCount = (manifestLength / 8) - 3;

&lt;CODE ENDS&gt;</pre>
</div>
<figcaption><a class="selfRef" href="#figure-9">Figure 9</a>:
<a class="selfRef" href="#name-pseudocode-for-manifest-san">Pseudocode for Manifest Sanity Check and Number of Hashes Calculation</a>
            </figcaption></figure>
</div>
</section>
</div>
<div id="block-hashes">
<section id="section-4.4.2">
          <h4 id="name-manifest-ledger-hashes">
<a class="section-number selfRef" href="#section-4.4.2">4.4.2. </a><a class="section-name selfRef" href="#name-manifest-ledger-hashes">Manifest Ledger Hashes</a>
          </h4>
<p id="section-4.4.2-1">
  The following three special hashes are included in all Manifests:<a class="pilcrow" href="#section-4.4.2-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4.2-2.1">the <em>Previous Manifest Hash</em> links to the previous Manifest.<a class="pilcrow" href="#section-4.4.2-2.1">¶</a>
</li>
            <li class="normal" id="section-4.4.2-2.2">the <em>Current Manifest Hash</em> is of the Manifest in which it appears.<a class="pilcrow" href="#section-4.4.2-2.2">¶</a>
</li>
            <li class="normal" id="section-4.4.2-2.3">the <em>DRIP Link (BE: HDA, UA) Hash</em> ties the endorsed UA key to the Manifest chain.<a class="pilcrow" href="#section-4.4.2-2.3">¶</a>
</li>
          </ul>
<p id="section-4.4.2-3">
  The Previous and Current hashes act as a ledger of provenance for the Manifest chain,
  which should be traced back if the Observer and UA were within Broadcast RID wireless range
  of each other for an extended period of time.<a class="pilcrow" href="#section-4.4.2-3">¶</a></p>
<p id="section-4.4.2-4">The <em>DRIP Link (BE: HDA, UA)</em> is included so there is a direct signature by the UA over the Broadcast Endorsement (see <a class="auto internal xref" href="#drip-link">Section 4.2</a>). Typical operation would expect that the list of <em>ASTM Message Hashes</em> contain nonce-like data. To enforce a binding between the <code>BE: HDA, UA</code> and avoid trivial replay attack vectors (see <a class="auto internal xref" href="#replay-attacks">Section 9.1</a>), at least one <em>ASTM Message Hash</em> <span class="bcp14">MUST</span> be from an <span>[<a class="cite xref" href="#F3411">F3411</a>]</span> message that satisfies the fourth requirement in <a class="auto internal xref" href="#drip-recommendations">Section 6.3</a>. At least once per Observation Session, the Observer must process that message as specified in <a class="auto internal xref" href="#drip-recommendations">Section 6.3</a>.<a class="pilcrow" href="#section-4.4.2-4">¶</a></p>
</section>
</div>
<div id="hash-op">
<section id="section-4.4.3">
          <h4 id="name-hash-algorithms-and-operati">
<a class="section-number selfRef" href="#section-4.4.3">4.4.3. </a><a class="section-name selfRef" href="#name-hash-algorithms-and-operati">Hash Algorithms and Operation</a>
          </h4>
<p id="section-4.4.3-1">The hash algorithm used for the Manifest is the same hash algorithm used in creation of the DET <span>[<a class="cite xref" href="#RFC9374">RFC9374</a>]</span> that is signing the Manifest. This is encoded as part of the DET using the HHIT Suite ID.<a class="pilcrow" href="#section-4.4.3-1">¶</a></p>
<p id="section-4.4.3-2">DETs that use cSHAKE128 <span>[<a class="cite xref" href="#NIST.SP.800-185">NIST.SP.800-185</a>]</span> compute the hash as follows:<a class="pilcrow" href="#section-4.4.3-2">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.4.3-3">
<pre>   cSHAKE128(ASTM Message, 64, "", "Remote ID Auth Hash")
</pre><a class="pilcrow" href="#section-4.4.3-3">¶</a>
</div>
<p id="section-4.4.3-4">For ORCHID Generation Algorithms (OGAs) other than "5" (EdDSA/cSHAKE128) <span>[<a class="cite xref" href="#RFC9374">RFC9374</a>]</span>, use the construct appropriate for the associated hash. For example, the hash for "2" (ECDSA/SHA-384) is computed as follows:<a class="pilcrow" href="#section-4.4.3-4">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.4.3-5">
<pre>   Ltrunc( SHA-384( ASTM Message | "Remote ID Auth Hash" ), 8 )
</pre><a class="pilcrow" href="#section-4.4.3-5">¶</a>
</div>
<p id="section-4.4.3-6">When building a Manifest, this process <span class="bcp14">MUST</span> be followed:<a class="pilcrow" href="#section-4.4.3-6">¶</a></p>
<ol class="normal type-1" id="section-4.4.3-7" start="1" type="1">
<li id="section-4.4.3-7.1">
              <p id="section-4.4.3-7.1.1">The <em>Previous Manifest Hash</em><a class="pilcrow" href="#section-4.4.3-7.1.1">¶</a></p>
<ol class="normal type-a" id="section-4.4.3-7.1.2" start="1" type="a">
<li id="section-4.4.3-7.1.2.1">is filled with a random nonce if and only if this is the first manifest being generated;<a class="pilcrow" href="#section-4.4.3-7.1.2.1">¶</a>
</li>
                <li id="section-4.4.3-7.1.2.2">otherwise, it contains the previous manifest's <em>Current Manifest Hash</em>.<a class="pilcrow" href="#section-4.4.3-7.1.2.2">¶</a>
</li>
              </ol>
</li>
            <li id="section-4.4.3-7.2">The <em>Current Manifest Hash</em> is filled with null.<a class="pilcrow" href="#section-4.4.3-7.2">¶</a>
</li>
            <li id="section-4.4.3-7.3">
              <em>ASTM Message Hashes</em> are filled per <a class="auto internal xref" href="#legacy-transport-hashing">Section 4.4.3.1</a> or <a class="auto internal xref" href="#extended-transport-hashing">Section 4.4.3.2</a>.<a class="pilcrow" href="#section-4.4.3-7.3">¶</a>
</li>
            <li id="section-4.4.3-7.4">A hash, as defined above in this section, is calculated over the <em>Previous Manifest Hash</em>, <em>Current Manifest Hash</em> (null filled), and <em>ASTM Message Hashes</em>.<a class="pilcrow" href="#section-4.4.3-7.4">¶</a>
</li>
            <li id="section-4.4.3-7.5">The <em>Current Manifest Hash</em> (null filled) is replaced with the hash generated in Step r.<a class="pilcrow" href="#section-4.4.3-7.5">¶</a>
</li>
          </ol>
<div id="legacy-transport-hashing">
<section id="section-4.4.3.1">
            <h5 id="name-legacy-transport-hashing">
<a class="section-number selfRef" href="#section-4.4.3.1">4.4.3.1. </a><a class="section-name selfRef" href="#name-legacy-transport-hashing">Legacy Transport Hashing</a>
            </h5>
<p id="section-4.4.3.1-1">Under this transport, DRIP hashes the full ASTM Message being sent over the Bluetooth Advertising frame. This is the 25-octet object that starts with the Message Type and Protocol Version octet along with the 24 octets of message data. The hash <span class="bcp14">MUST NOT</span> include the Message Counter octet.<a class="pilcrow" href="#section-4.4.3.1-1">¶</a></p>
<p id="section-4.4.3.1-2">For paged ASTM Messages (currently only Authentication Messages), all of the pages are concatenated together in Page Number order and hashed as one object.<a class="pilcrow" href="#section-4.4.3.1-2">¶</a></p>
</section>
</div>
<div id="extended-transport-hashing">
<section id="section-4.4.3.2">
            <h5 id="name-extended-transport-hashing">
<a class="section-number selfRef" href="#section-4.4.3.2">4.4.3.2. </a><a class="section-name selfRef" href="#name-extended-transport-hashing">Extended Transport Hashing</a>
            </h5>
<p id="section-4.4.3.2-1">Under this transport, DRIP hashes the full ASTM Message Pack (Message Type 0xF) regardless of its content. The hash <span class="bcp14">MUST NOT</span> include the Message Counter octet.<a class="pilcrow" href="#section-4.4.3.2-1">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="drip-frame">
<section id="section-4.5">
        <h3 id="name-drip-frame">
<a class="section-number selfRef" href="#section-4.5">4.5. </a><a class="section-name selfRef" href="#name-drip-frame">DRIP Frame</a>
        </h3>
<p id="section-4.5-1">
  This SAM Type is defined to enable use of the <em>UA-Signed Evidence Structure</em>
  (<a class="auto internal xref" href="#bas">Section 4.1</a>) in the future beyond the previously defined formats (Wrapper and
  Manifest) by the inclusion of a single octet to signal the format of <em>Evidence</em>
  data (up to 111 octets).<a class="pilcrow" href="#section-4.5-1">¶</a></p>
<p id="section-4.5-2">The content format of <em>Frame Evidence Data</em> is not defined in this document. Other specifications <span class="bcp14">MUST</span> define the contents and register for a <em>Frame Type</em>. At the time of publication (2024), there are no defined Frame Types; only an Experimental range has been defined.<a class="pilcrow" href="#section-4.5-2">¶</a></p>
<p id="section-4.5-3">Observers <span class="bcp14">MUST</span> check the signature of the structure (<a class="auto internal xref" href="#bas">Section 4.1</a>) per <a class="auto internal xref" href="#ua-attestation">Section 3.1.2.2</a> and <span class="bcp14">MAY</span>, if the specification of <em>Frame Type</em> is known, parse the content in <em>Frame Evidence Data</em>.<a class="pilcrow" href="#section-4.5-3">¶</a></p>
<span id="name-drip-frame-2"></span><div id="frame-fig">
<figure id="figure-10">
          <div class="alignCenter art-text artwork" id="section-4.5-4.1">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+---------------+---------------+
|  Frame Type   |                                               |
+---------------+                                               .
.                      Frame Evidence Data                      .
.                                                               .
|                                                               |
+---------------+---------------+---------------+---------------+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-10">Figure 10</a>:
<a class="selfRef" href="#name-drip-frame-2">DRIP Frame</a>
          </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4.5-5">
          <dt id="section-4.5-5.1">
<em>Frame Type</em>:</dt>
          <dd id="section-4.5-5.2" style="margin-left: 1.5em">
            <p id="section-4.5-5.2.1">(1 octet)<a class="pilcrow" href="#section-4.5-5.2.1">¶</a></p>
<p id="section-4.5-5.2.2">
      As shown in <a class="auto internal xref" href="#frame-fig">Figure 10</a>, the <em>Frame Type</em> takes the first octet, which 
      leaves 111 octets available for <em>Frame Evidence Data</em>.  See <a class="auto internal xref" href="#iana-drip-registry">Section 8.1</a> for Frame Type allocations.<a class="pilcrow" href="#section-4.5-5.2.2">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="fec-details">
<section id="section-5">
      <h2 id="name-forward-error-correction">
<a class="section-number selfRef" href="#section-5">5. </a><a class="section-name selfRef" href="#name-forward-error-correction">Forward Error Correction</a>
      </h2>
<p id="section-5-1">For Broadcast RID, FEC is provided by the lower layers in Extended Transports. The Bluetooth 4.x Legacy Transport does not support FEC, so the following application-level scheme is used with DRIP Authentication to add some FEC. When sending data over a medium that does not have underlying FEC, for example Bluetooth 4.x, this section <span class="bcp14">MUST</span> be used.<a class="pilcrow" href="#section-5-1">¶</a></p>
<p id="section-5-2">The Bluetooth 4.x lower layers have error detection but not correction. Any frame in which Bluetooth detects an error is dropped and not delivered to higher layers (in our case, DRIP). Thus it can be treated as an erasure.<a class="pilcrow" href="#section-5-2">¶</a></p>
<p id="section-5-3">DRIP standardizes a single page FEC scheme using XOR parity across all page data of an Authentication Message. This allows the correction of a single erased page in an Authentication Message. If more than a single page is missing, then handling of an incomplete Authentication Message is determined by higher layers.<a class="pilcrow" href="#section-5-3">¶</a></p>
<p id="section-5-4">Other FEC schemes, to protect more than a single page of an Authentication Message or multiple <span>[<a class="cite xref" href="#F3411">F3411</a>]</span> Messages, are left for future standardization if operational experience proves it necessary and/or practical.<a class="pilcrow" href="#section-5-4">¶</a></p>
<p id="section-5-5">The data added during FEC is not included in the <em>Authentication Data / Signature</em>, but instead in the <em>Additional Data</em> field of <a class="auto internal xref" href="#astm-auth">Figure 2</a>. This may cause the Authentication Message to exceed 9 pages, up to a maximum of 16 pages.<a class="pilcrow" href="#section-5-5">¶</a></p>
<div id="enc-single-page">
<section id="section-5.1">
        <h3 id="name-encoding">
<a class="section-number selfRef" href="#section-5.1">5.1. </a><a class="section-name selfRef" href="#name-encoding">Encoding</a>
        </h3>
<p id="section-5.1-1">When encoding, two things are <span class="bcp14">REQUIRED</span>:<a class="pilcrow" href="#section-5.1-1">¶</a></p>
<ol class="normal type-1" id="section-5.1-2" start="1" type="1">
   <li id="section-5.1-2.1">The FEC data <span class="bcp14">MUST</span> start on a new Authentication
   Page. To do this, the results of parity encoding <span class="bcp14">MUST</span>
   be placed in the <em>Additional Data</em> field of <a class="auto internal xref" href="#astm-auth">Figure 2</a> with null padding before it to
   line up with the next page. The <em>Additional Data Length</em>
   field <span class="bcp14">MUST</span> be set to <code>number of padding octets +
   number of parity octets</code>.<a class="pilcrow" href="#section-5.1-2.1">¶</a>
</li>
          <li id="section-5.1-2.2">The <em>Last Page Index</em> field (in Page 0)
          <span class="bcp14">MUST</span> be incremented from what it would have been
          without FEC by the number of pages required for the <em>Additional
          Data Length</em> field, null padding, and FEC.<a class="pilcrow" href="#section-5.1-2.2">¶</a>
</li>
        </ol>
<p id="section-5.1-3">To generate the parity, a simple XOR operation using the previous parity page and current page is used. Only the 23-octet <em>Authentication Payload</em> field of <a class="auto internal xref" href="#astm-auth-page">Figure 1</a> is used in the XOR operations. For Page 0, a 23-octet null pad is used for the previous parity page.<a class="pilcrow" href="#section-5.1-3">¶</a></p>
<p id="section-5.1-4"><a class="auto internal xref" href="#fig-single-fec">Figure 11</a> shows an example of the last two pages (out of N) of an Authentication Message using DRIP Single Page FEC. The <em>Additional Data Length</em> is set to 33, as there are always 23 octets of FEC data and there are 10 octets of padding in this example to line it up into Page N.<a class="pilcrow" href="#section-5.1-4">¶</a></p>
<span id="name-example-single-page-fec-enc"></span><div id="fig-single-fec">
<figure id="figure-11">
          <div class="alignCenter art-text artwork" id="section-5.1-5.1">
<pre>Page N-1:
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+---------------+---------------+
|  Page Header  |                                               |
+---------------+                                               |
|                Authentication Data / Signature                |
|                                                               |
|               +---------------+---------------+---------------+
|               |    ADL=33     |                               |
+---------------+---------------+                               |
|                          Null Padding                         |
|                                                               |
+---------------+---------------+---------------+---------------+


Page N:
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+---------------+---------------+
|  Page Header  |                                               |
+---------------+                                               |
|                                                               |
|                     Forward Error Correction                  |
|                                                               |
|                                                               |
|                                                               |
+---------------+---------------+---------------+---------------+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-11">Figure 11</a>:
<a class="selfRef" href="#name-example-single-page-fec-enc">Example Single Page FEC Encoding</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="dec-single-page">
<section id="section-5.2">
        <h3 id="name-decoding">
<a class="section-number selfRef" href="#section-5.2">5.2. </a><a class="section-name selfRef" href="#name-decoding">Decoding</a>
        </h3>
<p id="section-5.2-1">Frame decoding is independent of the transmit media. However, the decoding process can determine from the first Authentication Page that there may be a Bluetooth 4.x FEC page at the end. The decoding process <span class="bcp14">MUST</span> test for the presence of FEC and apply it as follows.<a class="pilcrow" href="#section-5.2-1">¶</a></p>
<p id="section-5.2-2">To determine if FEC has been used, a check of the <em>Last Page Index</em> is performed. In general, if the <em>Last Page Index</em> field is one greater than that necessary to hold <em>Length</em> octets of Authentication Data, then FEC has been used. Note that if <em>Length</em> octets are exhausted exactly at the end of an Authentication Page, the <em>Additional Data Length</em> field will occupy the first octet of the following page. The remainder of this page will be null padded under DRIP to align the FEC to its own page. In this case, the <em>Last Page Index</em> will have been incremented once for initializing the <em>Additional Data Length</em> field and once for the FEC page, for a total of two additional pages, as in the last row of <a class="auto internal xref" href="#tbl-page-counts">Table 5</a>.<a class="pilcrow" href="#section-5.2-2">¶</a></p>
<p id="section-5.2-3">To decode FEC in DRIP, a rolling XOR is used on each <em>Authentication Page</em> received in the current Authentication Message. A Message Counter, outside of the ASTM Message but specified in <span>[<a class="cite xref" href="#F3411">F3411</a>]</span>, is used to signal a different Authentication Message and to correlate pages to messages. This Message Counter is only a single octet in length, so it will roll over (to 0x00) after reaching its maximum value (0xFF). If only a single page is missing in the Authentication Message the resulting parity octets should be the data of the erased page.<a class="pilcrow" href="#section-5.2-3">¶</a></p>
<p id="section-5.2-4">Authentication Page 0 contains various important fields, only located on that page, that help decode the full ASTM Authentication Message. If Page 0 has been reconstructed, the <em>Last Page Index</em> and <em>Length</em> fields <span class="bcp14">MUST</span> be validated by DRIP. The pseudocode in <a class="auto internal xref" href="#decode-pseudo">Figure 12</a> can be used for both checks.<a class="pilcrow" href="#section-5.2-4">¶</a></p>
<span id="name-pseudocode-for-decode-check"></span><div id="decode-pseudo">
<figure id="figure-12">
          <div class="lang-pseudocode sourcecode" id="section-5.2-5.1">
<pre>&lt;CODE BEGINS&gt;
function decode_check(auth_pages[], decoded_lpi, decoded_length) {
  // check decoded_lpi does not exceed maximum value
  if (decoded_lpi &gt;= 16) {
    return DECODE_FAILURE
  }

  // check that decoded length does not exceed DRIP maximum value
  if (decoded_length &gt; 201) {
    return DECODE_FAILURE
  }

  // grab the page at index where length ends and extract its data
  auth_data = auth_pages[(decoded_length - 17) / 23].data
  // find the index of last auth byte
  last_auth_byte = (17 + (23 * last_auth_page)) - decoded_length

  // look for non-nulls after the last auth byte
  if (auth_data[(last_auth_byte + 2):] has non-nulls) {
    return DECODE_FAILURE
  }

  // check that byte directly after last auth byte is null
  if (auth_data[last_auth_byte + 1] equals null) {
    return DECODE_FAILURE
  }

  // we set our presumed Additional Data Length (ADL)
  presumed_adl = auth_data[last_auth_byte + 1]
  // use the presumed ADL to calculate a presumed
  //Last Page Index (LPI, a field defined in [F3411])
  presumed_lpi = (presumed_adl + decoded_length - 17) / 23

  // check that presumed LPI and decoded LPI match
  if (presumed_lpi not equal decoded_lpi) {
    return DECODE_FAILURE
  }
  return DECODE_SUCCESS
}

&lt;CODE ENDS&gt;</pre>
</div>
<figcaption><a class="selfRef" href="#figure-12">Figure 12</a>:
<a class="selfRef" href="#name-pseudocode-for-decode-check">Pseudocode for Decode Checks</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="fec-limitations">
<section id="section-5.3">
        <h3 id="name-fec-limitations">
<a class="section-number selfRef" href="#section-5.3">5.3. </a><a class="section-name selfRef" href="#name-fec-limitations">FEC Limitations</a>
        </h3>
<p id="section-5.3-1">The worst-case scenario is when the <em>Authentication Data / Signature</em> ends perfectly on a page boundary (Page N-1). This means the <em>Additional Data Length</em> would start the next page (Page N) and have 22 octets worth of null padding to align the FEC to begin at the start of the next page (Page N+1). In this scenario, an entire page (Page N) is being wasted just to carry the <em>Additional Data Length</em>.<a class="pilcrow" href="#section-5.3-1">¶</a></p>
</section>
</div>
</section>
</div>
<div id="reqs">
<section id="section-6">
      <h2 id="name-requirements-and-recommenda">
<a class="section-number selfRef" href="#section-6">6. </a><a class="section-name selfRef" href="#name-requirements-and-recommenda">Requirements and Recommendations</a>
      </h2>
<div id="legacy-transports">
<section id="section-6.1">
        <h3 id="name-legacy-transports">
<a class="section-number selfRef" href="#section-6.1">6.1. </a><a class="section-name selfRef" href="#name-legacy-transports">Legacy Transports</a>
        </h3>
<p id="section-6.1-1">Under DRIP, the goal is to bring reliable receipt of the paged Authentication Message using Legacy Transports. FEC (<a class="auto internal xref" href="#fec-details">Section 5</a>) <span class="bcp14">MUST</span> be used, per mandated RID rules (for example, the US FAA RID Rules <span>[<a class="cite xref" href="#FAA-14CFR">FAA-14CFR</a>]</span>), when using Legacy Transports (such as Bluetooth 4.x).<a class="pilcrow" href="#section-6.1-1">¶</a></p>
<p id="section-6.1-2">Under <span>[<a class="cite xref" href="#F3411">F3411</a>]</span>, Authentication Messages are transmitted at the static rate (at least every 3 seconds). Any DRIP Authentication Messages containing dynamic data (such as the DRIP Wrapper) <span class="bcp14">MAY</span> be sent at the dynamic rate (at least every 1 second).<a class="pilcrow" href="#section-6.1-2">¶</a></p>
</section>
</div>
<div id="extended-transports">
<section id="section-6.2">
        <h3 id="name-extended-transports">
<a class="section-number selfRef" href="#section-6.2">6.2. </a><a class="section-name selfRef" href="#name-extended-transports">Extended Transports</a>
        </h3>
<p id="section-6.2-1">Under the ASTM specification, Extended Transports of RID must use the Message Pack (Message Type 0xF) format for all transmissions. Under Message Pack, ASTM Messages are sent together (in Message Type order) in a single frame (up to 9 single-frame equivalent messages under Legacy Transports). Message Packs are required by <span>[<a class="cite xref" href="#F3411">F3411</a>]</span> to be sent at a rate of 1 per second (like dynamic messages).<a class="pilcrow" href="#section-6.2-1">¶</a></p>
<p id="section-6.2-2">Message Packs are sent only over Extended Transports that provide FEC. Thus, the DRIP decoders will never be presented with a Message Pack from which a constituent Authentication Page has been dropped; DRIP FEC could never provide benefit to a Message Pack, only consume its precious payload space. Therefore, DRIP FEC (<a class="auto internal xref" href="#fec-details">Section 5</a>) <span class="bcp14">MUST NOT</span> be used in Message Packs.<a class="pilcrow" href="#section-6.2-2">¶</a></p>
</section>
</div>
<div id="drip-recommendations">
<section id="section-6.3">
        <h3 id="name-authentication">
<a class="section-number selfRef" href="#section-6.3">6.3. </a><a class="section-name selfRef" href="#name-authentication">Authentication</a>
        </h3>
<p id="section-6.3-1">To fulfill the requirements in <span>[<a class="cite xref" href="#RFC9153">RFC9153</a>]</span>, a UA <span class="bcp14">MUST</span>:<a class="pilcrow" href="#section-6.3-1">¶</a></p>
<ol class="normal type-1" id="section-6.3-2" start="1" type="1">
   <li id="section-6.3-2.1">send DRIP Link (<a class="auto internal xref" href="#drip-link">Section 4.2</a>) using the <em>BE: Apex, RAA</em> (partially
   satisfying GEN-3); at least once per 5 minutes. Apex in this context
   is the DET prefix owner.<a class="pilcrow" href="#section-6.3-2.1">¶</a>
</li>
          <li id="section-6.3-2.2">send DRIP Link (<a class="auto internal xref" href="#drip-link">Section 4.2</a>) using the <code>BE: RAA, HDA</code> (partially
          satisfying GEN-3); at least once per 5 minutes.<a class="pilcrow" href="#section-6.3-2.2">¶</a>
</li>
          <li id="section-6.3-2.3">send DRIP Link (<a class="auto internal xref" href="#drip-link">Section 4.2</a>) using the <code>BE: HDA, UA</code> (satisfying ID-5,
          GEN-1 and partially satisfying GEN-3); at least once per minute.<a class="pilcrow" href="#section-6.3-2.3">¶</a>
</li>
          <li id="section-6.3-2.4">send any other DRIP Authentication Format
          (non-DRIP Link) where the UA is dynamically signing data that is
          guaranteed to be unique, unpredictable, and easily cross checked by
          the receiving device (satisfying ID-5, GEN-1 and GEN-2); at least
          once per 5 seconds.<a class="pilcrow" href="#section-6.3-2.4">¶</a>
</li>
        </ol>
<p id="section-6.3-3">An Observer's receiver must verify the signature (cryptographically, as specified in <a class="auto internal xref" href="#auth-dns">Section 3.1.1</a>) on each of the 4 messages sent in the operations specified immediately above and the Observer <span class="bcp14">MUST</span> validate the signed content (via non-cryptographic means) of the 4th message sent in the last operation immediately above (the non-DRIP Link message).<a class="pilcrow" href="#section-6.3-3">¶</a></p>
<p id="section-6.3-4">These transmission, receiver verification, and Observer validation requirements collectively satisfy GEN-3.<a class="pilcrow" href="#section-6.3-4">¶</a></p>
</section>
</div>
<div id="operational-recommendations">
<section id="section-6.4">
        <h3 id="name-operational">
<a class="section-number selfRef" href="#section-6.4">6.4. </a><a class="section-name selfRef" href="#name-operational">Operational</a>
        </h3>
<p id="section-6.4-1">UAS operation may impact the frequency of sending DRIP Authentication Messages. When a UA dwells at an approximate location, and the channel is heavily used by other devices, less frequent message authentication may be effective (to minimize RF packet collisions) for an Observer. Contrast this with a UA transiting an area, where authenticated messages <span class="bcp14">SHOULD</span> be sufficiently frequent for an Observer to have a high probability of receiving an adequate number for validation during the transit.<a class="pilcrow" href="#section-6.4-1">¶</a></p>
<p id="section-6.4-2">A <span class="bcp14">RECOMMENDED</span> operational configuration (in alignment with <a class="auto internal xref" href="#drip-recommendations">Section 6.3</a>) with rationale can be found in <a class="auto internal xref" href="#operational-proof">Appendix B</a>. It recommends the following once per second:<a class="pilcrow" href="#section-6.4-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.4-3.1">
            <p id="section-6.4-3.1.1">Under Legacy Transport:<a class="pilcrow" href="#section-6.4-3.1.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.4-3.1.2.1">Two sets of those ASTM Messages required by a CAA in its jurisdiction (example: Basic ID, Location/Vector, and System) and one set of other ASTM Messages (example: Self ID, Operator ID)<a class="pilcrow" href="#section-6.4-3.1.2.1">¶</a>
</li>
              <li class="normal" id="section-6.4-3.1.2.2">An FEC-protected DRIP Manifest enabling authentication of those ASTM Messages sent<a class="pilcrow" href="#section-6.4-3.1.2.2">¶</a>
</li>
              <li class="normal" id="section-6.4-3.1.2.3">A single page of an FEC-protected DRIP Link<a class="pilcrow" href="#section-6.4-3.1.2.3">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-6.4-3.2">
            <p id="section-6.4-3.2.1">Under Extended Transport:<a class="pilcrow" href="#section-6.4-3.2.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.4-3.2.2.1">A Message Pack of ASTM Messages (up to 4) and a DRIP Wrapper (per <a class="auto internal xref" href="#extended-wrapper">Section 4.3.2</a>)<a class="pilcrow" href="#section-6.4-3.2.2.1">¶</a>
</li>
              <li class="normal" id="section-6.4-3.2.2.2">A Message Pack of a DRIP Link<a class="pilcrow" href="#section-6.4-3.2.2.2">¶</a>
</li>
            </ul>
</li>
        </ul>
<div id="wrapper-operations">
<section id="section-6.4.1">
          <h4 id="name-drip-wrapper-2">
<a class="section-number selfRef" href="#section-6.4.1">6.4.1. </a><a class="section-name selfRef" href="#name-drip-wrapper-2">DRIP Wrapper</a>
          </h4>
<p id="section-6.4.1-1">If DRIP Wrappers are sent, they <span class="bcp14">MUST</span> be sent in addition to any required ASTM Messages in a given jurisdiction. An implementation <span class="bcp14">MUST NOT</span> send DRIP Wrappers in place of any required ASTM Messages it may encapsulate. Thus, messages within a Wrapper are sent twice: once in the clear and once authenticated within the Wrapper.<a class="pilcrow" href="#section-6.4.1-1">¶</a></p>
<p id="section-6.4.1-2">The DRIP Wrapper has a specific use case for DRIP-aware Observers. For an Observer plotting Location/Vector Messages (Message Type 0x2) on a map, display of an embedded Location/Vector Message in a DRIP Wrapper can be marked differently (e.g., via color) to signify trust in the Location/Vector data.<a class="pilcrow" href="#section-6.4.1-2">¶</a></p>
</section>
</div>
<div id="trust-assessment">
<section id="section-6.4.2">
          <h4 id="name-uas-rid-trust-assessment">
<a class="section-number selfRef" href="#section-6.4.2">6.4.2. </a><a class="section-name selfRef" href="#name-uas-rid-trust-assessment">UAS RID Trust Assessment</a>
          </h4>
<p id="section-6.4.2-1">As described in <a class="auto internal xref" href="#rid-trust">Section 3.1.2</a>, the Observer <span class="bcp14">MUST</span> perform validation of the data being received in Broadcast RID. This is because trust in a key is different from trust that an observed UA possesses that key.<a class="pilcrow" href="#section-6.4.2-1">¶</a></p>
<p id="section-6.4.2-2">A chain of DRIP Links provides trust in a key. A message, signed by that key, containing data that changes rapidly and is not predictable far in advance (relative to typical operational flight times) but that can be validated by Observers, provides trust that some agent with access to that data also possesses that key. If the validation involves correlating physical world observations of the UA with claims in that data, then the probability is high that the observed UA is (or is collaborating with or observed in real time by) the agent with the key.<a class="pilcrow" href="#section-6.4.2-2">¶</a></p>
<p id="section-6.4.2-3">At least once per Observation session, after signature verification of any DRIP Authentication Message containing UAS RID information elements (e.g., DRIP Wrapper, <a class="auto internal xref" href="#drip-wrapper">Section 4.3</a>), the Observer must use other sources of information to correlate against and perform validation (as specified in <a class="auto internal xref" href="#drip-recommendations">Section 6.3</a>). An example of another source of information is a visual confirmation of the UA position.<a class="pilcrow" href="#section-6.4.2-3">¶</a></p>
<p id="section-6.4.2-4">When correlation of these different data streams does not match in acceptable thresholds, the data <span class="bcp14">MUST</span> be rejected as if the signature failed to validate. Acceptable threshold limits and what happens after such a rejection are out of scope for this document.<a class="pilcrow" href="#section-6.4.2-4">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="req-sum">
<section id="section-7">
      <h2 id="name-summary-of-addressed-drip-r">
<a class="section-number selfRef" href="#section-7">7. </a><a class="section-name selfRef" href="#name-summary-of-addressed-drip-r">Summary of Addressed DRIP Requirements</a>
      </h2>
<p id="section-7-1">The following requirements as defined in <span>[<a class="cite xref" href="#RFC9153">RFC9153</a>]</span> are addressed in this document:<a class="pilcrow" href="#section-7-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-7-2">
        <dt id="section-7-2.1">ID-5:</dt>
        <dd id="section-7-2.2" style="margin-left: 1.5em">
          <p id="section-7-2.2.1">Non-spoofability<a class="pilcrow" href="#section-7-2.2.1">¶</a></p>
<p id="section-7-2.2.2">Addressed using the DRIP Wrapper (<a class="auto internal xref" href="#drip-wrapper">Section 4.3</a>), DRIP Manifest (<a class="auto internal xref" href="#drip-manifest">Section 4.4</a>), or DRIP Frame (<a class="auto internal xref" href="#drip-frame">Section 4.5</a>).<a class="pilcrow" href="#section-7-2.2.2">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-7-2.3">GEN-1:</dt>
        <dd id="section-7-2.4" style="margin-left: 1.5em">
          <p id="section-7-2.4.1">Provable Ownership<a class="pilcrow" href="#section-7-2.4.1">¶</a></p>
<p id="section-7-2.4.2">Addressed using the DRIP Link (<a class="auto internal xref" href="#drip-link">Section 4.2</a>) and DRIP Wrapper (<a class="auto internal xref" href="#drip-wrapper">Section 4.3</a>), DRIP Manifest (<a class="auto internal xref" href="#drip-manifest">Section 4.4</a>), or DRIP Frame (<a class="auto internal xref" href="#drip-frame">Section 4.5</a>).<a class="pilcrow" href="#section-7-2.4.2">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-7-2.5">GEN-2:</dt>
        <dd id="section-7-2.6" style="margin-left: 1.5em">
          <p id="section-7-2.6.1">Provable Binding<a class="pilcrow" href="#section-7-2.6.1">¶</a></p>
<p id="section-7-2.6.2">Addressed using the DRIP Wrapper (<a class="auto internal xref" href="#drip-wrapper">Section 4.3</a>), DRIP Manifest (<a class="auto internal xref" href="#drip-manifest">Section 4.4</a>) or DRIP Frame (<a class="auto internal xref" href="#drip-frame">Section 4.5</a>).<a class="pilcrow" href="#section-7-2.6.2">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-7-2.7">GEN-3:</dt>
        <dd id="section-7-2.8" style="margin-left: 1.5em">
          <p id="section-7-2.8.1">Provable Registration<a class="pilcrow" href="#section-7-2.8.1">¶</a></p>
<p id="section-7-2.8.2">Addressed using the DRIP Link (<a class="auto internal xref" href="#drip-link">Section 4.2</a>).<a class="pilcrow" href="#section-7-2.8.2">¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
</section>
</div>
<div id="iana-considerations">
<section id="section-8">
      <h2 id="name-iana-considerations">
<a class="section-number selfRef" href="#section-8">8. </a><a class="section-name selfRef" href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<div id="iana-drip-registry">
<section id="section-8.1">
        <h3 id="name-iana-drip-registry">
<a class="section-number selfRef" href="#section-8.1">8.1. </a><a class="section-name selfRef" href="#name-iana-drip-registry">IANA DRIP Registry</a>
        </h3>
<p id="section-8.1-1">IANA has created the "DRIP SAM Types" and "DRIP Frame Types" registries within the <a href="https://www.iana.org/assignments/drip">"Drone Remote ID Protocol" registry group</a>.<a class="pilcrow" href="#section-8.1-1">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-8.1-2">
          <dt id="section-8.1-2.1">DRIP SAM Types:</dt>
          <dd id="section-8.1-2.2" style="margin-left: 1.5em">
            <p id="section-8.1-2.2.1">This registry is a mirror for SAM Types containing the subset of
          allocations used by DRIP Authentication Messages. Future additions
          <span class="bcp14">MUST</span> be done through ASTM's designated registrar,
          which is ICAO <span>[<a class="cite xref" href="#ASTM-Remote-ID">ASTM-Remote-ID</a>]</span> at the time of publication of this RFC (2024). The registration procedure for DRIP (only) SAM Types is Standards Action <span>[<a class="cite xref" href="#RFC8126">RFC8126</a>]</span>. 
  Requests for new DRIP SAM Type registrations will be coordinated by IANA and the
  ASTM-designated registrar of all SAM Types before being documented in Standards Track RFCs. The following values have
          been allocated to the IETF:<a class="pilcrow" href="#section-8.1-2.2.1">¶</a></p>
<span id="name-drip-sam-types-2"></span><table class="center" id="table-2">
              <caption>
<a class="selfRef" href="#table-2">Table 2</a>:
<a class="selfRef" href="#name-drip-sam-types-2">DRIP SAM Types</a>
              </caption>
<thead>
                <tr>
                  <th class="text-left" colspan="1" rowspan="1">SAM Type</th>
                  <th class="text-left" colspan="1" rowspan="1">Name</th>
                  <th class="text-left" colspan="1" rowspan="1">Description</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">0x01</td>
                  <td class="text-left" colspan="1" rowspan="1">DRIP Link</td>
                  <td class="text-left" colspan="1" rowspan="1">Format to hold Broadcast Endorsements</td>
                </tr>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">0x02</td>
                  <td class="text-left" colspan="1" rowspan="1">DRIP Wrapper</td>
                  <td class="text-left" colspan="1" rowspan="1">Authenticate full ASTM Messages</td>
                </tr>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">0x03</td>
                  <td class="text-left" colspan="1" rowspan="1">DRIP Manifest</td>
                  <td class="text-left" colspan="1" rowspan="1">Authenticate hashes of ASTM Messages</td>
                </tr>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">0x04</td>
                  <td class="text-left" colspan="1" rowspan="1">DRIP Frame</td>
                  <td class="text-left" colspan="1" rowspan="1">Format for future DRIP authentication</td>
                </tr>
              </tbody>
            </table>
</dd>
          <dd class="break"></dd>
<dt id="section-8.1-2.3">DRIP Frame Types:</dt>
          <dd id="section-8.1-2.4" style="margin-left: 1.5em">
            <p id="section-8.1-2.4.1">This 8-bit value registry is for Frame Types in DRIP Frame
          Authentication Messages. Future additions to this registry are to be
          made through Expert Review (<span><a class="relref" href="https://rfc-editor.org/rfc/rfc8126#section-4.5">Section 4.5</a> of [<a class="cite xref" href="#RFC8126">RFC8126</a>]</span>) for values 0x01 to 0x9F
          and First Come First Served (<span><a class="relref" href="https://rfc-editor.org/rfc/rfc8126#section-4.4">Section 4.4</a> of [<a class="cite xref" href="#RFC8126">RFC8126</a>]</span>) for values 0xA0 to 0xEF. The
          following values are defined:<a class="pilcrow" href="#section-8.1-2.4.1">¶</a></p>
<span id="name-drip-frame-types"></span><table class="center" id="table-3">
              <caption>
<a class="selfRef" href="#table-3">Table 3</a>:
<a class="selfRef" href="#name-drip-frame-types">DRIP Frame Types</a>
              </caption>
<thead>
                <tr>
                  <th class="text-left" colspan="1" rowspan="1">Frame Type</th>
                  <th class="text-left" colspan="1" rowspan="1">Name</th>
                  <th class="text-left" colspan="1" rowspan="1">Description</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">0x00</td>
                  <td class="text-left" colspan="1" rowspan="1">Reserved</td>
                  <td class="text-left" colspan="1" rowspan="1">Reserved</td>
                </tr>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">0x01 - 0xEF</td>
                  <td class="text-left" colspan="1" rowspan="1">Unassigned</td>
                  <td class="text-left" colspan="1" rowspan="1"></td>
                </tr>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">0xF0-0xFF</td>
                  <td class="text-left" colspan="1" rowspan="1">Experimental</td>
                  <td class="text-left" colspan="1" rowspan="1">Reserved for Experimental Use</td>
                </tr>
              </tbody>
            </table>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-8.1-3">Criteria that should be applied by the designated experts includes determining whether the proposed registration duplicates existing functionality and whether the registration description is clear and fits the purpose of this registry.<a class="pilcrow" href="#section-8.1-3">¶</a></p>
<p id="section-8.1-4">Registration requests <span class="bcp14">MUST</span> be sent to <a href="mailto:drip-reg-review@ietf.org">drip-reg-review@ietf.org</a> and be evaluated by one or more designated experts within a three-week review period. Within that review period, the designated experts will either approve or deny the registration request, and communicate their decision to the review list and IANA. Denials should include an explanation and, if applicable, suggestions to successfully register the DRIP Frame Type.<a class="pilcrow" href="#section-8.1-4">¶</a></p>
<p id="section-8.1-5">Registration requests that are undetermined for a period longer than 28 days can be brought to the IESG's attention for resolution.<a class="pilcrow" href="#section-8.1-5">¶</a></p>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-9">
      <h2 id="name-security-considerations">
<a class="section-number selfRef" href="#section-9">9. </a><a class="section-name selfRef" href="#name-security-considerations">Security Considerations</a>
      </h2>
<div id="replay-attacks">
<section id="section-9.1">
        <h3 id="name-replay-attacks">
<a class="section-number selfRef" href="#section-9.1">9.1. </a><a class="section-name selfRef" href="#name-replay-attacks">Replay Attacks</a>
        </h3>
<p id="section-9.1-1"><span>[<a class="cite xref" href="#F3411">F3411</a>]</span> (regardless of transport) lacks replay protection, as it more fundamentally lacks fully specified authentication. An attacker can spoof the UA sender MAC address and UAS ID, replaying (with or without modification) previous genuine messages, and/or crafting entirely new messages. Using DRIP in <span>[<a class="cite xref" href="#F3411">F3411</a>]</span> Authentication Message framing enables verification that messages were signed with registered keys, but when naively used may be vulnerable to replay attacks. Technologies such as Single Emitter Identification can detect such attacks, but they are not readily available and can be prohibitively expensive, especially for typical Observer devices such as smartphones.<a class="pilcrow" href="#section-9.1-1">¶</a></p>
<p id="section-9.1-2">Replay attack detection using DRIP requires Observer devices to combine information from multiple Broadcast RID messages and from sources other than Broadcast RID. A complete chain of Link messages (<a class="auto internal xref" href="#drip-link">Section 4.2</a>) from an Endorsement root of trust to the claimed sender must be collected and verified by the Observer device to provide trust in a key. Successful signature verification, using that public key, of a Wrapper (<a class="auto internal xref" href="#drip-wrapper">Section 4.3</a>) or Manifest (<a class="auto internal xref" href="#drip-manifest">Section 4.4</a>) message, authenticating content that is nonce-like (see below), provides trust that the sender actually possesses the corresponding private key.<a class="pilcrow" href="#section-9.1-2">¶</a></p>
<p id="section-9.1-3">The term "nonce-like" describes data that is unique, changes frequently, is not accurately predictable long in advance, and is easily validated (i.e., can be checked quickly at low computational cost using readily available data) by the Observer. A Location/Vector Message is an obvious choice. This is described in <a class="auto internal xref" href="#ua-attestation">Section 3.1.2.2</a> and <a class="auto internal xref" href="#drip-recommendations">Section 6.3</a> (requirement 4). A Location/Vector Message <span>[<a class="cite xref" href="#F3411">F3411</a>]</span> reporting precise UA position and velocity at a precise and very recent time can be checked by the Observer against visual observations of UA within both RF and Visual Line of Sight.<a class="pilcrow" href="#section-9.1-3">¶</a></p>
<p id="section-9.1-4">For normative specification of the foregoing, see Sections <a class="auto internal xref" href="#rid-trust">3.1.2</a> and <a class="auto internal xref" href="#trust-assessment">6.4.2</a>. As non-normative clarification, the requirements are satisfied as follows:<a class="pilcrow" href="#section-9.1-4">¶</a></p>
<p id="section-9.1-5">The public key corresponding to a given DET (i.e., the key attested in the DRIP Link (<code>BE: HDA, UA</code>) that is the last link in the relevant chain of DRIP Links) is used by an Observer's receiver to try to authenticate some signed message.<a class="pilcrow" href="#section-9.1-5">¶</a></p>
<p id="section-9.1-6">If the signature check passes,<a class="pilcrow" href="#section-9.1-6">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-9.1-7.1">
            <em>and</em> the message was a Wrapper or Manifest,<a class="pilcrow" href="#section-9.1-7.1">¶</a>
</li>
          <li class="normal ulEmpty" id="section-9.1-7.2">
            <em>and</em> the wrapped or manifested message contained content that was nonce-like,<a class="pilcrow" href="#section-9.1-7.2">¶</a>
</li>
          <li class="normal ulEmpty" id="section-9.1-7.3">
            <em>and</em> the Observer validated that content by non-cryptographic means (e.g., if the wrapped or manifested message was a Location/Vector Message and the UA was visually observed to be in approximately 
the claimed location at the reported time),<a class="pilcrow" href="#section-9.1-7.3">¶</a>
</li>
        </ul>
<p id="section-9.1-8"><em>only then</em> can the Observer trust that the currently observed sending UA actually possesses the corresponding private key (and thus owns the corresponding DET).<a class="pilcrow" href="#section-9.1-8">¶</a></p>
<p id="section-9.1-9">Messages that pass signature verification with trusted keys could still be replays if they contain only static information (e.g., Broadcast Endorsements (<a class="auto internal xref" href="#drip-link">Section 4.2</a>), <span>[<a class="cite xref" href="#F3411">F3411</a>]</span> Basic ID, or <span>[<a class="cite xref" href="#F3411">F3411</a>]</span> Operator ID), or information that cannot be readily validated (e.g., <span>[<a class="cite xref" href="#F3411">F3411</a>]</span> Self-ID). Replay of Link messages is harmless (unless sent so frequently as to cause RF data link congestion) and indeed can increase the likelihood of an Observer device collecting an entire trust chain in a short time window. Replay of other messages (<span>[<a class="cite xref" href="#F3411">F3411</a>]</span> Basic ID, <span>[<a class="cite xref" href="#F3411">F3411</a>]</span> Operator ID, or <span>[<a class="cite xref" href="#F3411">F3411</a>]</span> Self-ID) remains a vulnerability, unless they are combined with messages containing nonce-like data (<span>[<a class="cite xref" href="#F3411">F3411</a>]</span> Location/Vector or <span>[<a class="cite xref" href="#F3411">F3411</a>]</span> System) in a Wrapper or Manifest. For specification of this last requirement, see <a class="auto internal xref" href="#block-hashes">Section 4.4.2</a>.<a class="pilcrow" href="#section-9.1-9">¶</a></p>
</section>
</div>
<div id="wrapper-vs-manifest">
<section id="section-9.2">
        <h3 id="name-wrapper-vs-manifest">
<a class="section-number selfRef" href="#section-9.2">9.2. </a><a class="section-name selfRef" href="#name-wrapper-vs-manifest">Wrapper vs Manifest</a>
        </h3>
<p id="section-9.2-1">Implementations have a choice of using Wrapper (<a class="auto internal xref" href="#drip-wrapper">Section 4.3</a>), Manifest (<a class="auto internal xref" href="#drip-manifest">Section 4.4</a>), or a combination to satisfy the fourth requirement in <a class="auto internal xref" href="#drip-recommendations">Section 6.3</a>.<a class="pilcrow" href="#section-9.2-1">¶</a></p>
<p id="section-9.2-2">
  Wrapper is an attached signature on the full content of one or more
  <span>[<a class="cite xref" href="#F3411">F3411</a>]</span> messages, providing strong authentication.
Wrapper is an attached signature of the full content of one or more <span>[<a class="cite xref" href="#F3411">F3411</a>]</span> messages, providing strong authentication. 

However, the size limitation means it cannot support such signatures over other Authentication Messages; thus, it cannot provide a direct binding to any part of the trust chain (Sections <a class="auto internal xref" href="#rid-trust">3.1.2</a> and <a class="auto internal xref" href="#trust-assessment">6.4.2</a>).<a class="pilcrow" href="#section-9.2-2">¶</a></p>
<p id="section-9.2-3">Manifest explicitly provides the binding of the last link in the trust chain (with the inclusion of the hash of the Link containing <code>BE: HDA, UA</code>). The use of hashes and their length also allows for a larger number (11 vs 4) of <span>[<a class="cite xref" href="#F3411">F3411</a>]</span> messages to be authenticated, making it more efficient compared to the Wrapper. However, the detached signature requires additional Observer overhead in storing and comparing hashes of received messages (some of which may not be received) with those in a Manifest.<a class="pilcrow" href="#section-9.2-3">¶</a></p>
<p id="section-9.2-4"><a class="auto internal xref" href="#operational-proof">Appendix B</a> contains a breakdown of frame counts and an example of a schedule using both Manifest and Wrapper. Typical operation may see (as an example) 2x Basic ID, 2x Location/Vector, 2x System, 1x Operator ID and 1x Self ID broadcast per second to comply with jurisdiction mandates. Each of these messages is a single frame in size. A Link message is 8 frames long (including FEC). This is a base frame count of <strong>16 frames</strong>.<a class="pilcrow" href="#section-9.2-4">¶</a></p>
<p id="section-9.2-5">When Wrapper is used, up to four of the previous messages (except the Link) can be authenticated. For this comparison, we will sign all the messages we can in two Wrappers. This results in <em>20 frames</em> (with FEC). Due to size constraints, the Link message is left unauthenticated. The total frame count using Wrappers is <strong>36 frames</strong> (wrapper frame count + base frame count).<a class="pilcrow" href="#section-9.2-5">¶</a></p>
<p id="section-9.2-6">When Manifest is used, up to 10 previous messages can be authenticated. For this example, all messages (8) are hashed (including the Link) resulting in a single Manifest that is <em>9 frames</em> (with FEC). The total frame count using Manifest is <strong>25 frames</strong> (manifest frame count + base frame count).<a class="pilcrow" href="#section-9.2-6">¶</a></p>
</section>
</div>
<div id="vna-timestamp-offsets-for-drip-authentication-formats">
<section id="section-9.3">
        <h3 id="name-vna-timestamp-offsets-for-d">
<a class="section-number selfRef" href="#section-9.3">9.3. </a><a class="section-name selfRef" href="#name-vna-timestamp-offsets-for-d">VNA Timestamp Offsets for DRIP Authentication Formats</a>
        </h3>
<p id="section-9.3-1">Note the discussion of VNA Timestamp offsets here is in the context of the DRIP Wrapper (<a class="auto internal xref" href="#drip-wrapper">Section 4.3</a>), DRIP Manifest (<a class="auto internal xref" href="#drip-manifest">Section 4.4</a>), and DRIP Frame (<a class="auto internal xref" href="#drip-frame">Section 4.5</a>). For DRIP Link (<a class="auto internal xref" href="#drip-link">Section 4.2</a>), these offsets are set by the DIME and have their own set of considerations in <span>[<a class="cite xref" href="#I-D.ietf-drip-registries">DRIP-REG</a>]</span>.<a class="pilcrow" href="#section-9.3-1">¶</a></p>
<p id="section-9.3-2">The offset of the <em>VNA Timestamp by UA</em> is one that needs careful consideration for any implementation. The offset should be shorter than any given flight duration (typically less than an hour) but be long enough to be received and processed by Observers (larger than a few seconds). It is recommended that 3-5 minutes should be sufficient to serve this purpose in any scenario, but it is not limited by design.<a class="pilcrow" href="#section-9.3-2">¶</a></p>
</section>
</div>
<div id="dns-security">
<section id="section-9.4">
        <h3 id="name-dns-security-in-drip">
<a class="section-number selfRef" href="#section-9.4">9.4. </a><a class="section-name selfRef" href="#name-dns-security-in-drip">DNS Security in DRIP</a>
        </h3>
<p id="section-9.4-1">As stated in <a class="auto internal xref" href="#protocol-desc">Section 3.1</a> specification of particular DNS security options, transports, etc. is outside the scope of this document. 
  The main specification for DNS operations in DRIP <span>[<a class="cite xref" href="#I-D.ietf-drip-registries">DRIP-REG</a>]</span>
  will specify applicable best common security practices 
  (e.g., from <span>[<a class="cite xref" href="#RFC9364">RFC9364</a>]</span>).<a class="pilcrow" href="#section-9.4-1">¶</a></p>
</section>
</div>
</section>
</div>
<section id="section-10">
      <h2 id="name-references">
<a class="section-number selfRef" href="#section-10">10. </a><a class="section-name selfRef" href="#name-references">References</a>
      </h2>
<section id="section-10.1">
        <h3 id="name-normative-references">
<a class="section-number selfRef" href="#section-10.1">10.1. </a><a class="section-name selfRef" href="#name-normative-references">Normative References</a>
        </h3>
<dl class="references">
<dt id="F3411">[F3411]</dt>
        <dd>
<span class="refAuthor">ASTM International</span>, <span class="refTitle">"Standard Specification for Remote ID and Tracking"</span>, <span class="seriesInfo">ASTM F3411-22A</span>, <span class="seriesInfo">DOI 10.1520/F3411-22A</span>, <time class="refDate" datetime="2022-07">July 2022</time>, <span>&lt;<a href="https://www.astm.org/f3411-22a.html">https://www.astm.org/f3411-22a.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="NIST.SP.800-185">[NIST.SP.800-185]</dt>
        <dd>
<span class="refAuthor">Kelsey, J.</span>, <span class="refAuthor">Chang, S.</span>, and <span class="refAuthor">R. Perlner</span>, <span class="refTitle">"SHA-3 Derived Functions: cSHAKE, KMAC, TupleHash and ParallelHash"</span>, <span class="seriesInfo">NIST Special Publication 800-185</span>, <span class="seriesInfo">DOI 10.6028/NIST.SP.800-185</span>, <time class="refDate" datetime="2016-12">December 2016</time>, <span>&lt;<a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-185.pdf">https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-185.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time class="refDate" datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time class="refDate" datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9153">[RFC9153]</dt>
        <dd>
<span class="refAuthor">Card, S., Ed.</span>, <span class="refAuthor">Wiethuechter, A.</span>, <span class="refAuthor">Moskowitz, R.</span>, and <span class="refAuthor">A. Gurtov</span>, <span class="refTitle">"Drone Remote Identification Protocol (DRIP) Requirements and Terminology"</span>, <span class="seriesInfo">RFC 9153</span>, <span class="seriesInfo">DOI 10.17487/RFC9153</span>, <time class="refDate" datetime="2022-02">February 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9153">https://www.rfc-editor.org/info/rfc9153</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9374">[RFC9374]</dt>
        <dd>
<span class="refAuthor">Moskowitz, R.</span>, <span class="refAuthor">Card, S.</span>, <span class="refAuthor">Wiethuechter, A.</span>, and <span class="refAuthor">A. Gurtov</span>, <span class="refTitle">"DRIP Entity Tag (DET) for Unmanned Aircraft System Remote ID (UAS RID)"</span>, <span class="seriesInfo">RFC 9374</span>, <span class="seriesInfo">DOI 10.17487/RFC9374</span>, <time class="refDate" datetime="2023-03">March 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9374">https://www.rfc-editor.org/info/rfc9374</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9434">[RFC9434]</dt>
      <dd>
<span class="refAuthor">Card, S.</span>, <span class="refAuthor">Wiethuechter, A.</span>, <span class="refAuthor">Moskowitz, R.</span>, <span class="refAuthor">Zhao, S., Ed.</span>, and <span class="refAuthor">A. Gurtov</span>, <span class="refTitle">"Drone Remote Identification Protocol (DRIP) Architecture"</span>, <span class="seriesInfo">RFC 9434</span>, <span class="seriesInfo">DOI 10.17487/RFC9434</span>, <time class="refDate" datetime="2023-07">July 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9434">https://www.rfc-editor.org/info/rfc9434</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-10.2">
        <h3 id="name-informative-references">
<a class="section-number selfRef" href="#section-10.2">10.2. </a><a class="section-name selfRef" href="#name-informative-references">Informative References</a>
        </h3>
<dl class="references">
<dt id="ASTM-Remote-ID">[ASTM-Remote-ID]</dt>
        <dd>
<span class="refAuthor">International Civil Aviation Organization (ICAO)</span>, <span class="refTitle">"Remote ID Number Registration"</span>, <time class="refDate" datetime="2023-12">December 2023</time>, <span>&lt;<a href="https://www.icao.int/airnavigation/IATF/Pages/ASTM-Remote-ID.aspx">https://www.icao.int/airnavigation/IATF/Pages/ASTM-Remote-ID.aspx</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-drip-registries">[DRIP-REG]</dt>
        <dd>
<span class="refAuthor">Wiethuechter, A., Ed.</span> and <span class="refAuthor">J. Reid</span>, <span class="refTitle">"DRIP Entity Tag (DET) Identity Management Architecture"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-drip-registries-16</span>, <time class="refDate" datetime="2024-05-31">31 May 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-drip-registries-16">https://datatracker.ietf.org/doc/html/draft-ietf-drip-registries-16</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="FAA-14CFR">[FAA-14CFR]</dt>
        <dd>
<span class="refAuthor">Federal Aviation Administration (FAA)</span>, <span class="refTitle">"Remote Identification of Unmanned Aircraft"</span>, <time class="refDate" datetime="2021-01">January 2021</time>, <span>&lt;<a href="https://www.govinfo.gov/content/pkg/FR-2021-01-15/pdf/2020-28948.pdf">https://www.govinfo.gov/content/pkg/FR-2021-01-15/pdf/2020-28948.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time class="refDate" datetime="2017-06">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9364">[RFC9364]</dt>
      <dd>
<span class="refAuthor">Hoffman, P.</span>, <span class="refTitle">"DNS Security Extensions (DNSSEC)"</span>, <span class="seriesInfo">BCP 237</span>, <span class="seriesInfo">RFC 9364</span>, <span class="seriesInfo">DOI 10.17487/RFC9364</span>, <time class="refDate" datetime="2023-02">February 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9364">https://www.rfc-editor.org/info/rfc9364</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="auth-state-diagrams">
<section id="appendix-A">
      <h2 id="name-authentication-states">
<a class="section-number selfRef" href="#appendix-A">Appendix A. </a><a class="section-name selfRef" href="#name-authentication-states">Authentication States</a>
      </h2>
<p id="appendix-A-1">ASTM Authentication has only three states: None, Invalid, and Valid. This is because, under ASTM, the authentication is done by an external service hosted somewhere on the Internet so it is assumed an authoritative response will always be returned. This classification becomes more complex in DRIP with the support of "offline" scenarios where an Observer does not have Internet connectivity. With the use of asymmetric cryptography, this means that the public key (PK) must somehow be obtained. <span>[<a class="cite xref" href="#I-D.ietf-drip-registries">DRIP-REG</a>]</span> provides more detail on how these keys are stored on the DNS and how DRIP Authentication Messages can be used to send PKs over Broadcast RID.<a class="pilcrow" href="#appendix-A-1">¶</a></p>
<p id="appendix-A-2">There are a few keys of interest: the PK of the UA and the PKs of relevant DIMEs. This document describes how to send the PK of the UA over the Broadcast RID messages. The keys of DIMEs are sent over Broadcast RID using the same mechanisms (see Sections <a class="auto internal xref" href="#drip-link">4.2</a> and <a class="auto internal xref" href="#drip-recommendations">6.3</a>) but <span class="bcp14">MAY</span> be sent at a far lower rate due to potential operational constraints (such as saturation of limited bandwidth). As such, there are scenarios where part of the key-chain may be unavailable at the moment a full Authentication Message is received and processed.<a class="pilcrow" href="#appendix-A-2">¶</a></p>
<p id="appendix-A-3">The intent of this informative appendix is to recommend a way to classify these various states and convey it to the user through colors and state names/text. These states can apply to either a single Authentication Message, a DET (and its associated public key), and/or a sender.<a class="pilcrow" href="#appendix-A-3">¶</a></p>
<p id="appendix-A-4"><a class="auto internal xref" href="#tab4">Table 4</a> briefly describes each state and recommends an associated color.<a class="pilcrow" href="#appendix-A-4">¶</a></p>
<span id="name-authentication-state-names-"></span><div id="tab4">
<table class="center" id="table-4">
        <caption>
<a class="selfRef" href="#table-4">Table 4</a>:
<a class="selfRef" href="#name-authentication-state-names-">Authentication State Names, Colors, and Descriptions</a>
        </caption>
<thead>
          <tr>
            <th class="text-left" colspan="1" rowspan="1">State</th>
            <th class="text-left" colspan="1" rowspan="1">Color</th>
            <th class="text-left" colspan="1" rowspan="1">Details</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">None</td>
            <td class="text-left" colspan="1" rowspan="1">Black</td>
            <td class="text-left" colspan="1" rowspan="1">No Authentication has been or is being received (as yet)</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">Partial</td>
            <td class="text-left" colspan="1" rowspan="1">Gray</td>
            <td class="text-left" colspan="1" rowspan="1">Authentication being received but missing pages</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">Unsupported</td>
            <td class="text-left" colspan="1" rowspan="1">Brown</td>
            <td class="text-left" colspan="1" rowspan="1">Authentication Type / SAM Type of received message not supported</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">Unverifiable</td>
            <td class="text-left" colspan="1" rowspan="1">Yellow</td>
            <td class="text-left" colspan="1" rowspan="1">Data needed for signature verification is missing</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">Verified</td>
            <td class="text-left" colspan="1" rowspan="1">Green</td>
            <td class="text-left" colspan="1" rowspan="1">Valid signature verification and content validation</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">Trusted</td>
            <td class="text-left" colspan="1" rowspan="1">Blue</td>
            <td class="text-left" colspan="1" rowspan="1">Evidence of Verified and DIME is marked as only registering DETs for trusted entities</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">Unverified</td>
            <td class="text-left" colspan="1" rowspan="1">Red</td>
            <td class="text-left" colspan="1" rowspan="1">Invalid signature verification or content validation</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">Questionable</td>
            <td class="text-left" colspan="1" rowspan="1">Orange</td>
            <td class="text-left" colspan="1" rowspan="1">Evidence of both"Verified and Unverified for the same claimed sender</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">Conflicting</td>
            <td class="text-left" colspan="1" rowspan="1">Purple</td>
            <td class="text-left" colspan="1" rowspan="1">Evidence of both Trusted and Unverified for the same claimed sender</td>
          </tr>
        </tbody>
      </table>
</div>
<div id="black">
<section id="appendix-A.1">
        <h3 id="name-none-black">
<a class="section-number selfRef" href="#appendix-A.1">A.1. </a><a class="section-name selfRef" href="#name-none-black">None: Black</a>
        </h3>
<p id="appendix-A.1-1">The default state where authentication information has not yet been received and is not currently being received.<a class="pilcrow" href="#appendix-A.1-1">¶</a></p>
</section>
</div>
<div id="gray">
<section id="appendix-A.2">
        <h3 id="name-partial-gray">
<a class="section-number selfRef" href="#appendix-A.2">A.2. </a><a class="section-name selfRef" href="#name-partial-gray">Partial: Gray</a>
        </h3>
<p id="appendix-A.2-1">A pending state where Authentication Pages are being received, but a full Authentication Message has yet to be compiled.<a class="pilcrow" href="#appendix-A.2-1">¶</a></p>
</section>
</div>
<div id="brown">
<section id="appendix-A.3">
        <h3 id="name-unsupported-brown">
<a class="section-number selfRef" href="#appendix-A.3">A.3. </a><a class="section-name selfRef" href="#name-unsupported-brown">Unsupported: Brown</a>
        </h3>
<p id="appendix-A.3-1">A state wherein authentication data is being or has been received but cannot be used, as the Authentication Type or SAM Type is not supported by the Observer.<a class="pilcrow" href="#appendix-A.3-1">¶</a></p>
</section>
</div>
<div id="yellow">
<section id="appendix-A.4">
        <h3 id="name-unverifiable-yellow">
<a class="section-number selfRef" href="#appendix-A.4">A.4. </a><a class="section-name selfRef" href="#name-unverifiable-yellow">Unverifiable: Yellow</a>
        </h3>
<p id="appendix-A.4-1">A pending state where a full Authentication Message has been received but other information, such as public keys to verify signatures, is missing.<a class="pilcrow" href="#appendix-A.4-1">¶</a></p>
</section>
</div>
<div id="green">
<section id="appendix-A.5">
        <h3 id="name-verified-green">
<a class="section-number selfRef" href="#appendix-A.5">A.5. </a><a class="section-name selfRef" href="#name-verified-green">Verified: Green</a>
        </h3>
<p id="appendix-A.5-1">A state where all Authentication Messages that have been received from that claimed sender up to that point pass signature verification and the requirement of <a class="auto internal xref" href="#trust-assessment">Section 6.4.2</a> has been met.<a class="pilcrow" href="#appendix-A.5-1">¶</a></p>
</section>
</div>
<div id="blue">
<section id="appendix-A.6">
        <h3 id="name-trusted-blue">
<a class="section-number selfRef" href="#appendix-A.6">A.6. </a><a class="section-name selfRef" href="#name-trusted-blue">Trusted: Blue</a>
        </h3>
<p id="appendix-A.6-1">A state where all Authentication Messages that have been received from that claimed sender up to that point have passed signature verification, the requirement of <a class="auto internal xref" href="#trust-assessment">Section 6.4.2</a> has been met, and the public key of the sending UA has been marked as trusted.<a class="pilcrow" href="#appendix-A.6-1">¶</a></p>
<p id="appendix-A.6-2">The sending UA key will have been marked as trusted if the relevant DIMEs only register DETs (of subordinate DIMEs, UAS operators, and UA) that have been vetted as per their published registration policies, and those DIMEs have been marked, by the owner (individual or organizational) of the Observer, as per that owner's policy, as trusted to register DETs only for trusted parties.<a class="pilcrow" href="#appendix-A.6-2">¶</a></p>
</section>
</div>
<div id="orange">
<section id="appendix-A.7">
        <h3 id="name-questionable-orange">
<a class="section-number selfRef" href="#appendix-A.7">A.7. </a><a class="section-name selfRef" href="#name-questionable-orange">Questionable: Orange</a>
        </h3>
<p id="appendix-A.7-1">A state where there is a mix of Authentication Messages received that are Verified (<a class="auto internal xref" href="#green">Appendix A.5</a>) and Unverified (<a class="auto internal xref" href="#red">Appendix A.8</a>).<a class="pilcrow" href="#appendix-A.7-1">¶</a></p>
<p id="appendix-A.7-2">State transitions from Verified to Questionable if a subsequent message fails verification, so it would have otherwise been marked Unverified.  State transitions from Unverified to Questionable if a subsequent message passes verification or validation, so it would otherwise have been marked Verified.  It may transition from either of those states upon mixed results on the requirement of <a class="auto internal xref" href="#trust-assessment">Section 6.4.2</a>.<a class="pilcrow" href="#appendix-A.7-2">¶</a></p>
</section>
</div>
<div id="red">
<section id="appendix-A.8">
        <h3 id="name-unverified-red">
<a class="section-number selfRef" href="#appendix-A.8">A.8. </a><a class="section-name selfRef" href="#name-unverified-red">Unverified: Red</a>
        </h3>
<p id="appendix-A.8-1">A state where all Authentication Messages that have been received from that claimed sender up to that point failed signature verification or the requirement of <a class="auto internal xref" href="#trust-assessment">Section 6.4.2</a>.<a class="pilcrow" href="#appendix-A.8-1">¶</a></p>
</section>
</div>
<div id="purple">
<section id="appendix-A.9">
        <h3 id="name-conflicting-purple">
<a class="section-number selfRef" href="#appendix-A.9">A.9. </a><a class="section-name selfRef" href="#name-conflicting-purple">Conflicting: Purple</a>
        </h3>
<p id="appendix-A.9-1">A state where there is a mix of Authentication Messages received that are Trusted (<a class="auto internal xref" href="#blue">Appendix A.6</a>) and Unverified (<a class="auto internal xref" href="#red">Appendix A.8</a>) and the public key of the aircraft is marked as trusted.<a class="pilcrow" href="#appendix-A.9-1">¶</a></p>
<p id="appendix-A.9-2">State transitions from Trusted to Conflicting if a subsequent message fails verification, so it would have otherwise been marked Unverified.  State transitions from Unverified to Conflicting if a subsequent message passes verification or validation and policy checks, so it would otherwise have been marked Trusted. It may transition from either of those states upon mixed results on the requirement of <a class="auto internal xref" href="#trust-assessment">Section 6.4.2</a>.<a class="pilcrow" href="#appendix-A.9-2">¶</a></p>
</section>
</div>
</section>
</div>
<div id="operational-proof">
<section id="appendix-B">
      <h2 id="name-operational-recommendation-">
<a class="section-number selfRef" href="#appendix-B">Appendix B. </a><a class="section-name selfRef" href="#name-operational-recommendation-">Operational Recommendation Analysis</a>
      </h2>
<p id="appendix-B-1">The recommendations in <a class="auto internal xref" href="#operational-recommendations">Section 6.4</a> may seem heavy-handed and specific. This informative appendix lays out the math and assumptions made that resulted in those recommendations and provides an example.<a class="pilcrow" href="#appendix-B-1">¶</a></p>
<p id="appendix-B-2">In all jurisdictions known to the authors of this document as of its
  publication (2024), at least the following ASTM Messages are
  required to be transmitted at least once per second:<a class="pilcrow" href="#appendix-B-2">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-3.1">Basic ID (0x1)<a class="pilcrow" href="#appendix-B-3.1">¶</a>
</li>
        <li class="normal" id="appendix-B-3.2">Location (0x2)<a class="pilcrow" href="#appendix-B-3.2">¶</a>
</li>
        <li class="normal" id="appendix-B-3.3">System (0x4)<a class="pilcrow" href="#appendix-B-3.3">¶</a>
</li>
      </ul>
<p id="appendix-B-4">Europe also requires:<a class="pilcrow" href="#appendix-B-4">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-5.1">Operator ID Message (0x5)<a class="pilcrow" href="#appendix-B-5.1">¶</a>
</li>
      </ul>
<p id="appendix-B-6">Japan requires not one but two Basic ID messages:<a class="pilcrow" href="#appendix-B-6">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-7.1">one carrying a manufacturer assigned serial number<a class="pilcrow" href="#appendix-B-7.1">¶</a>
</li>
        <li class="normal" id="appendix-B-7.2">one carrying a CAA assigned registration number<a class="pilcrow" href="#appendix-B-7.2">¶</a>
</li>
      </ul>
<p id="appendix-B-8">Japan also requires:<a class="pilcrow" href="#appendix-B-8">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-9.1">Authentication (0x2) using their own unique scheme<a class="pilcrow" href="#appendix-B-9.1">¶</a>
</li>
      </ul>
<p id="appendix-B-10">In all jurisdictions, one further message is optional, but highly
  recommended for carriage of additional information on the
  nature of the emergency if the Emergency value is sent in
  the Operational Status field of the Location/Vector Message:<a class="pilcrow" href="#appendix-B-10">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-11.1">Self ID (0x3)<a class="pilcrow" href="#appendix-B-11.1">¶</a>
</li>
      </ul>
<p id="appendix-B-12">To improve the likelihood of successful timely receipt of
  regulator required RID data elements, most implementations
  send at a higher rate, whether by repeating the same messages
  in the same one second interval, or updating message content
  and sending messages more frequently than once per second.
  Excessive sending rate, however, could congest the RF spectrum,
  leading to collisions and counter-intuitively actually reducing
  the likelihood of timely receipt of RID data.<a class="pilcrow" href="#appendix-B-12">¶</a></p>
<div id="page-counts-vs-frame-counts">
<section id="appendix-B.1">
        <h3 id="name-page-counts-vs-frame-counts">
<a class="section-number selfRef" href="#appendix-B.1">B.1. </a><a class="section-name selfRef" href="#name-page-counts-vs-frame-counts">Page Counts vs Frame Counts</a>
        </h3>
<p id="appendix-B.1-1">There are two formulas to determine the number of Authentication Pages required.  The following formula is for Wrapper:<a class="pilcrow" href="#appendix-B.1-1">¶</a></p>
<div class="sourcecode" id="appendix-B.1-2">
<pre>&lt;CODE BEGINS&gt;
wrapper_struct_size = 89 + (25 * num_astm_messages)
wrapper_page_count = ceiling((wrapper_struct_size - 17) / 23) + 1

&lt;CODE ENDS&gt;</pre><a class="pilcrow" href="#appendix-B.1-2">¶</a>
</div>
<p id="appendix-B.1-3">The following formula is for Manifest:<a class="pilcrow" href="#appendix-B.1-3">¶</a></p>
<div class="sourcecode" id="appendix-B.1-4">
<pre>&lt;CODE BEGINS&gt;
manifest_struct_size = 89 + (8 * (num_astm_hashes + 3))
manifest_page_count = ceiling((manifest_struct_size - 17) / 23) + 1

&lt;CODE ENDS&gt;</pre><a class="pilcrow" href="#appendix-B.1-4">¶</a>
</div>
<p id="appendix-B.1-5">A similar formula can be applied to Links, as they are of fixed size:<a class="pilcrow" href="#appendix-B.1-5">¶</a></p>
<div class="sourcecode" id="appendix-B.1-6">
<pre>&lt;CODE BEGINS&gt;
link_page_count = ceiling((137 - 17) / 23) + 1 = 7

&lt;CODE ENDS&gt;</pre><a class="pilcrow" href="#appendix-B.1-6">¶</a>
</div>
<p id="appendix-B.1-7">Comparing Wrapper and Manifest Authentication Message page counts against total frame counts, we have the following:<a class="pilcrow" href="#appendix-B.1-7">¶</a></p>
<span id="name-page-and-frame-counts"></span><div id="tbl-page-counts">
<table class="center" id="table-5">
          <caption>
<a class="selfRef" href="#table-5">Table 5</a>:
<a class="selfRef" href="#name-page-and-frame-counts">Page and Frame Counts</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">ASTM Messages</th>
              <th class="text-left" colspan="1" rowspan="1">Wrapper (w/FEC)</th>
              <th class="text-left" colspan="1" rowspan="1">Manifest (w/FEC)</th>
              <th class="text-left" colspan="1" rowspan="1">ASTM Messages + Wrapper (w/FEC)</th>
              <th class="text-left" colspan="1" rowspan="1">ASTM Messages + Manifest (w/FEC)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">5 (6)</td>
              <td class="text-left" colspan="1" rowspan="1">6 (7)</td>
              <td class="text-left" colspan="1" rowspan="1">5 (6)</td>
              <td class="text-left" colspan="1" rowspan="1">6 (7)</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">1</td>
              <td class="text-left" colspan="1" rowspan="1">6 (7)</td>
              <td class="text-left" colspan="1" rowspan="1">6 (7)</td>
              <td class="text-left" colspan="1" rowspan="1">7 (8)</td>
              <td class="text-left" colspan="1" rowspan="1">7 (8)</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">2</td>
              <td class="text-left" colspan="1" rowspan="1">7 (8)</td>
              <td class="text-left" colspan="1" rowspan="1">6 (7)</td>
              <td class="text-left" colspan="1" rowspan="1">9 (10)</td>
              <td class="text-left" colspan="1" rowspan="1">8 (9)</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">3</td>
              <td class="text-left" colspan="1" rowspan="1">8 (9)</td>
              <td class="text-left" colspan="1" rowspan="1">7 (8)</td>
              <td class="text-left" colspan="1" rowspan="1">11 (12)</td>
              <td class="text-left" colspan="1" rowspan="1">10 (11)</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">4</td>
              <td class="text-left" colspan="1" rowspan="1">9 (10)</td>
              <td class="text-left" colspan="1" rowspan="1">7 (8)</td>
              <td class="text-left" colspan="1" rowspan="1">13 (14)</td>
              <td class="text-left" colspan="1" rowspan="1">11 (12)</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">5</td>
              <td class="text-left" colspan="1" rowspan="1">N/A</td>
              <td class="text-left" colspan="1" rowspan="1">7 (8)</td>
              <td class="text-left" colspan="1" rowspan="1">N/A</td>
              <td class="text-left" colspan="1" rowspan="1">12 (13)</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">6</td>
              <td class="text-left" colspan="1" rowspan="1">N/A</td>
              <td class="text-left" colspan="1" rowspan="1">8 (9)</td>
              <td class="text-left" colspan="1" rowspan="1">N/A</td>
              <td class="text-left" colspan="1" rowspan="1">14 (15)</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">7</td>
              <td class="text-left" colspan="1" rowspan="1">N/A</td>
              <td class="text-left" colspan="1" rowspan="1">8 (9)</td>
              <td class="text-left" colspan="1" rowspan="1">N/A</td>
              <td class="text-left" colspan="1" rowspan="1">15 (16)</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">8</td>
              <td class="text-left" colspan="1" rowspan="1">N/A</td>
              <td class="text-left" colspan="1" rowspan="1">8 (9)</td>
              <td class="text-left" colspan="1" rowspan="1">N/A</td>
              <td class="text-left" colspan="1" rowspan="1">16 (17)</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">9</td>
              <td class="text-left" colspan="1" rowspan="1">N/A</td>
              <td class="text-left" colspan="1" rowspan="1">9 (10)</td>
              <td class="text-left" colspan="1" rowspan="1">N/A</td>
              <td class="text-left" colspan="1" rowspan="1">18 (19)</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">10</td>
              <td class="text-left" colspan="1" rowspan="1">N/A</td>
              <td class="text-left" colspan="1" rowspan="1">9 (10)</td>
              <td class="text-left" colspan="1" rowspan="1">N/A</td>
              <td class="text-left" colspan="1" rowspan="1">19 (20)</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">11</td>
              <td class="text-left" colspan="1" rowspan="1">N/A</td>
              <td class="text-left" colspan="1" rowspan="1">9 (11)</td>
              <td class="text-left" colspan="1" rowspan="1">N/A</td>
              <td class="text-left" colspan="1" rowspan="1">20 (22)</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="appendix-B.1-9">Link shares the same page counts as Manifest with 5 ASTM Messages.<a class="pilcrow" href="#appendix-B.1-9">¶</a></p>
<div id="special-cases">
<section id="appendix-B.1.1">
          <h4 id="name-special-cases">
<a class="section-number selfRef" href="#appendix-B.1.1">B.1.1. </a><a class="section-name selfRef" href="#name-special-cases">Special Cases</a>
          </h4>
<div id="zero-astm-messages">
<section id="appendix-B.1.1.1">
            <h5 id="name-zero-astm-messages">
<a class="section-number selfRef" href="#appendix-B.1.1.1">B.1.1.1. </a><a class="section-name selfRef" href="#name-zero-astm-messages">Zero ASTM Messages</a>
            </h5>
<p id="appendix-B.1.1.1-1">Zero ASTM Messages (see <a class="auto internal xref" href="#tbl-page-counts">Table 5</a>) is where Extended Wrapper (<a class="auto internal xref" href="#extended-wrapper">Section 4.3.2</a>) without FEC is used in Message Packs. With a maximum of nine "message slots" in a Message Pack, an Extended Wrapper fills five slots; thus it can authenticate up to four ASTM Messages co-located in the same Message Pack.<a class="pilcrow" href="#appendix-B.1.1.1-1">¶</a></p>
</section>
</div>
<div id="eleven-astm-messages">
<section id="appendix-B.1.1.2">
            <h5 id="name-eleven-astm-messages">
<a class="section-number selfRef" href="#appendix-B.1.1.2">B.1.1.2. </a><a class="section-name selfRef" href="#name-eleven-astm-messages">Eleven ASTM Messages</a>
            </h5>
<p id="appendix-B.1.1.2-1">Eleven ASTM Messages (see <a class="auto internal xref" href="#tbl-page-counts">Table 5</a>) is where a Manifest with FEC invokes the situation mentioned in <a class="auto internal xref" href="#fec-limitations">Section 5.3</a>.<a class="pilcrow" href="#appendix-B.1.1.2-1">¶</a></p>
<p id="appendix-B.1.1.2-2">Eleven is the maximum number of ASTM Message Hashes that can be supported resulting in 14 total hashes. This completely fills the <em>Evidence</em> field of the <em>UA-Signed Evidence
Structure</em> making its total size 200 octets. This fits on exactly 9 Authentication Pages (<code>(201 - 17) / 23 == 8</code>), so when the ADL is added, it is placed on the next page (Page 10). Per rule 1 in <a class="auto internal xref" href="#enc-single-page">Section 5.1</a>, this means that all of Page 10 is null padded (expect the ADL octet) and FEC data fills Page 11, resulting in a plus-two page count when FEC is applied.<a class="pilcrow" href="#appendix-B.1.1.2-2">¶</a></p>
<p id="appendix-B.1.1.2-3">This drives the recommendation is <a class="auto internal xref" href="#drip-manifest">Section 4.4</a> to only use up to 10 ASTM Message Hashes, not 11.<a class="pilcrow" href="#appendix-B.1.1.2-3">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="full-authentication-example">
<section id="appendix-B.2">
        <h3 id="name-full-authentication-example">
<a class="section-number selfRef" href="#appendix-B.2">B.2. </a><a class="section-name selfRef" href="#name-full-authentication-example">Full Authentication Example</a>
        </h3>
<p id="appendix-B.2-1">This example (<a class="auto internal xref" href="#max-schedule-fig">Figure 13</a>) is focused on showing that 100% of ASTM Messages can be authenticated over Legacy Transports with up to 125% overhead in Authentication Pages. 
  Extended Transports are not shown in this example, because, for those,
  Authentication with DRIP is achieved using Extended Wrapper 
  (<a class="auto internal xref" href="#extended-wrapper">Section 4.3.2</a>).
Two ASTM Message Packs are sent in a given cycle: one containing up to four ASTM Messages and an Extended Wrapper (authenticating the pack), and one containing a Link message with a Broadcast Endorsement and up to two other ASTM Messages.<a class="pilcrow" href="#appendix-B.2-1">¶</a></p>
<p id="appendix-B.2-2">This example transmit scheme covers and meets every known regulatory case enabling manufacturers to use the same firmware worldwide.<a class="pilcrow" href="#appendix-B.2-2">¶</a></p>
<span id="name-example-of-a-fully-authenti"></span><div id="max-schedule-fig">
<figure id="figure-13">
          <div class="alignCenter art-text artwork" id="appendix-B.2-3.1">
<pre>+------------------------------------------------------+
|                      Frame Slots                     |
| 00 - 04           | 05 - 07       | 08 - 16 | 17     |
+-------------------+---------------+---------+--------+
| {A|B|C|D},V,S,I,O | {A|B|C|D},V,S | M[0,8]  | L/W[0] |
+-------------------+---------------+---------+--------+
| {A|B|C|D},V,S,I,O | {A|B|C|D},V,S | M[0,8]  | L/W[1] |
+-------------------+---------------+---------+--------+
| {A|B|C|D},V,S,I,O | {A|B|C|D},V,S | M[0,8]  | L/W[2] |
+-------------------+---------------+---------+--------+
| {A|B|C|D},V,S,I,O | {A|B|C|D},V,S | M[0,8]  | L/W[3] |
+-------------------+---------------+---------+--------+
| {A|B|C|D},V,S,I,O | {A|B|C|D},V,S | M[0,8]  | L/W[4] |
+-------------------+---------------+---------+--------+
| {A|B|C|D},V,S,I,O | {A|B|C|D},V,S | M[0,8]  | L/W[5] |
+-------------------+---------------+---------+--------+
| {A|B|C|D},V,S,I,O | {A|B|C|D},V,S | M[0,8]  | L/W[6] |
+-------------------+---------------+---------+--------+
| {A|B|C|D},V,S,I,O | {A|B|C|D},V,S | M[0,8]  | L/W[7] |
+-------------------+---------------+---------+--------+

A = Basic ID Message (0x0) ID Type 1
B = Basic ID Message (0x0) ID Type 2
C = Basic ID Message (0x0) ID Type 3
D = Basic ID Message (0x0) ID Type 4
V = Location/Vector Message (0x1)
I = Self ID Message (0x3)
S = System Message (0x4)
O = Operator ID Message (0x5)

L[y,z] = DRIP Link Authentication Message (0x2)
W[y,z] = DRIP Wrapper Authentication Message (0x2)
M[y,z] = DRIP Manifest Authentication Message (0x2)
  y = Start Page
  z = End Page

# = Empty Frame Slot
* = Message in DRIP Manifest Authentication Message
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-13">Figure 13</a>:
<a class="selfRef" href="#name-example-of-a-fully-authenti">Example of a Fully Authenticated Legacy Transport Transmit Schedule</a>
          </figcaption></figure>
</div>
<p id="appendix-B.2-4">Every common required message (Basic ID, Location/Vector, and System) is sent twice along with Operator ID and Self ID in a single second. The Manifest is over all messages (8) in slots <code>00 - 04</code> and <code>05 - 07</code>.<a class="pilcrow" href="#appendix-B.2-4">¶</a></p>
<p id="appendix-B.2-5">In two seconds, either a Link or Wrapper is sent. The content and order of Links and Wrappers runs as follows:<a class="pilcrow" href="#appendix-B.2-5">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.2-6">
<pre>Link: HDA on UA
Link: RAA on HDA
Link: HDA on UA
Link: Apex on RAA
Link: HDA on UA
Link: RAA on HDA
Link: HDA on UA
Wrapper: Location/Vector (0x1), System (0x4)
Link: HDA on UA
Link: RAA on HDA
Link: HDA on UA
Link: Apex on RAA
Link: HDA on UA
Link: RAA on HDA
Link: HDA on UA
Wrapper: Location/Vector (0x1), System (0x4)
Link: IANA on UAS RID Apex
</pre><a class="pilcrow" href="#appendix-B.2-6">¶</a>
</div>
<p id="appendix-B.2-7">After perfect receipt of all messages for a period of 8 seconds,
  all messages sent during that period have been authenticated using the Manifest
  (except for the Authentication Messages themselves).
  Within 136 seconds, the entire Broadcast Endorsement chain
  is received and can be validated. Interspersed in this schedule
  are 4 messages sent not only in their basic <span>[<a class="cite xref" href="#F3411">F3411</a>]</span> form, but also
  in DRIP Wrapper messages, together with their attached signatures,
  to defend against the possibility of attack against the detached signatures
  provided by the Manifest messages.<a class="pilcrow" href="#appendix-B.2-7">¶</a></p>
<div id="raw-example">
<section id="appendix-B.2.1">
          <h4 id="name-raw-example">
<a class="section-number selfRef" href="#appendix-B.2.1">B.2.1. </a><a class="section-name selfRef" href="#name-raw-example">Raw Example</a>
          </h4>
<p id="appendix-B.2.1-1">Assuming the following DET and HI:<a class="pilcrow" href="#appendix-B.2.1-1">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.2.1-2">
<pre>2001:3f:fe00:105:a29b:3ff4:2226:c04e
b5fef530d450dedb59ebafa18b00d7f5ed0ac08a81975034297bea2b00041813
</pre><a class="pilcrow" href="#appendix-B.2.1-2">¶</a>
</div>
<p id="appendix-B.2.1-3">The following ASTM Messages are to be sent in a single second:<a class="pilcrow" href="#appendix-B.2.1-3">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.2.1-4">
<pre>0240012001003ffe000105a29b3ff42226c04e000000000000
12000000000000000000000000000000000000000060220000
32004578616d706c652053656c662049440000000000000000
420000000000000000000100000000000000000010ea510900
52004578616d706c65204f70657261746f7220494400000000
0240012001003ffe000105a29b3ff42226c04e000000000000
12000000000000000000000000000000000000000060220000
420000000000000000000100000000000000000010ea510900
</pre><a class="pilcrow" href="#appendix-B.2.1-4">¶</a>
</div>
<p id="appendix-B.2.1-5">This is a Link with FEC that would be spread out over 8 seconds:<a class="pilcrow" href="#appendix-B.2.1-5">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.2.1-6">
<pre>2250078910ea510904314b8564b17e66662001003ffe000105
2251a29b3ff42226c04eb5fef530d450dedb59ebafa18b00d7
2252f5ed0ac08a81975034297bea2b000418132001003ffe00
22530105b82bf1c99d87273103fc83f6ecd9b91842f205c222
2254dd71d8e165ad18ca91daf9299a73eec850c756a7e9be46
2255f51dddfa0f09db7bfdde14eec07c7a6dd1061c1d5ace94
2256d9ad97940d280000000000000000000000000000000000
2257a03b0f7a6feb0d198167045058cfc49f73129917024d22
</pre><a class="pilcrow" href="#appendix-B.2.1-6">¶</a>
</div>
<p id="appendix-B.2.1-7">This is a Wrapper with FEC that would be spread out over 8 seconds:<a class="pilcrow" href="#appendix-B.2.1-7">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.2.1-8">
<pre>2250078b10ea510902e0dd7c6560115e671200000000000000
22510000000000000000000000000060220000420000000000
2252000000000100000000000000000010ea5109002001003f
2253fe000105a29b3ff42226c04ef0ecad581a030ca790152a
22542f08df5762a463e24a742d1c530ec977bbe0d113697e2b
2255b909d6c7557bdaf1227ce86154b030daadda4a6b8474de
22569a62f6c375020826000000000000000000000000000000
2257f5e8eebcb04f8c2197526053e66c010d5d7297ff7c1fe0
</pre><a class="pilcrow" href="#appendix-B.2.1-8">¶</a>
</div>
<p id="appendix-B.2.1-9">This is the Manifest with FEC sent in the same second as the original messages:<a class="pilcrow" href="#appendix-B.2.1-9">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.2.1-10">
<pre>225008b110ea510903e0dd7c6560115e670000000000000000
2251d57594875f8608b4d61dc9224ecf8b842bd4862734ed01
22522ca2e5f2b8a3e61547b81704766ba3eeb651be7eafc928
22538884e3e28a24fd5529bc2bd4862734ed012ca2e5f2b8a3
2254e61547b81704766ba3eeb62001003ffe000105a29b3ff4
22552226c04efb729846e7d110903797066fd96f49a77c5a48
2256c4c3b330be05bc4a958e9641718aaa31aeabad368386a2
22579ed2dce2769120da83edbcdc0858dd1e357755e7860317
2258e7c06a5918ea62a937391cbfe0983539de1b2e688b7c83
</pre><a class="pilcrow" href="#appendix-B.2.1-10">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="acknowledgments">
<section id="appendix-C">
      <h2 id="name-acknowledgments">
<a class="section-name selfRef" href="#name-acknowledgments">Acknowledgments</a>
      </h2>
<p id="appendix-C-1">The authors acknowledge the following individuals:<a class="pilcrow" href="#appendix-C-1">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-2.1">
          <p id="appendix-C-2.1.1"><span class="contact-name">Ryan Quigley</span>, <span class="contact-name">James         Mussi</span>, and <span class="contact-name">Joseph Stanton</span> of AX Enterprize,
        LLC for early prototyping to find holes in earlier drafts of this
        specification.<a class="pilcrow" href="#appendix-C-2.1.1">¶</a></p>
</li>
        <li class="normal" id="appendix-C-2.2">
          <p id="appendix-C-2.2.1"><span class="contact-name">Carsten Bormann</span> for the simple approach of using bit-column-wise
        parity for erasure (dropped frame) FEC.<a class="pilcrow" href="#appendix-C-2.2.1">¶</a></p>
</li>
        <li class="normal" id="appendix-C-2.3">
          <p id="appendix-C-2.3.1"><span class="contact-name">Soren Friis</span> for pointing out that Wi-Fi implementations would not always give access to the MAC Address, as was originally used in calculation of the hashes for DRIP Manifest. Also, for confirming that Message Packs (0xF) can only carry up to 9 ASTM frames worth of data (9 Authentication Pages).<a class="pilcrow" href="#appendix-C-2.3.1">¶</a></p>
</li>
        <li class="normal" id="appendix-C-2.4">
          <p id="appendix-C-2.4.1"><span class="contact-name">Gabriel Cox</span> (chair of the working group that produced <span>[<a class="cite xref" href="#F3411">F3411</a>]</span>) for reviewing the specification for the SAM Type request as the ASTM Designated Expert.<a class="pilcrow" href="#appendix-C-2.4.1">¶</a></p>
</li>
        <li class="normal" id="appendix-C-2.5">
          <p id="appendix-C-2.5.1"><span class="contact-name">Mohamed Boucadair</span> (Document Shepherd) for his many patches and comments.<a class="pilcrow" href="#appendix-C-2.5.1">¶</a></p>
</li>
        <li class="normal" id="appendix-C-2.6">
          <p id="appendix-C-2.6.1"><span class="contact-name">Eric Vyncke</span> (DRIP AD) for his guidance regarding the document's path to publication.<a class="pilcrow" href="#appendix-C-2.6.1">¶</a></p>
</li>
      </ul>
<p id="appendix-C-3">The authors also thank the following reviewers:<a class="pilcrow" href="#appendix-C-3">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-4.1">
          <p id="appendix-C-4.1.1"><span class="contact-name">Rick Salz (secdir)</span><a class="pilcrow" href="#appendix-C-4.1.1">¶</a></p>
</li>
        <li class="normal" id="appendix-C-4.2">
          <p id="appendix-C-4.2.1"><span class="contact-name">Matt Joras (genart)</span><a class="pilcrow" href="#appendix-C-4.2.1">¶</a></p>
</li>
        <li class="normal" id="appendix-C-4.3">
          <p id="appendix-C-4.3.1"><span class="contact-name">Di Ma (dnsdir)</span><a class="pilcrow" href="#appendix-C-4.3.1">¶</a></p>
</li>
        <li class="normal" id="appendix-C-4.4">
          <p id="appendix-C-4.4.1"><span class="contact-name">Gorry Fairhurst (tsvart)</span><a class="pilcrow" href="#appendix-C-4.4.1">¶</a></p>
</li>
        <li class="normal" id="appendix-C-4.5">
          <p id="appendix-C-4.5.1"><span class="contact-name">Carlos Bernardos (intdir)</span><a class="pilcrow" href="#appendix-C-4.5.1">¶</a></p>
</li>
        <li class="normal" id="appendix-C-4.6">
          <p id="appendix-C-4.6.1"><span class="contact-name">Behcet Sarikaya (iotdir)</span><a class="pilcrow" href="#appendix-C-4.6.1">¶</a></p>
</li>
        <li class="normal" id="appendix-C-4.7">
          <p id="appendix-C-4.7.1"><span class="contact-name">Martin Duke (IESG)</span><a class="pilcrow" href="#appendix-C-4.7.1">¶</a></p>
</li>
        <li class="normal" id="appendix-C-4.8">
          <p id="appendix-C-4.8.1"><span class="contact-name">Roman Danyliw (IESG)</span><a class="pilcrow" href="#appendix-C-4.8.1">¶</a></p>
</li>
        <li class="normal" id="appendix-C-4.9">
          <p id="appendix-C-4.9.1"><span class="contact-name">Murray Kucherawy (IESG)</span><a class="pilcrow" href="#appendix-C-4.9.1">¶</a></p>
</li>
        <li class="normal" id="appendix-C-4.10">
          <p id="appendix-C-4.10.1"><span class="contact-name">Erik Kline (IESG)</span><a class="pilcrow" href="#appendix-C-4.10.1">¶</a></p>
</li>
        <li class="normal" id="appendix-C-4.11">
          <p id="appendix-C-4.11.1"><span class="contact-name">Warren Kumari (IESG)</span><a class="pilcrow" href="#appendix-C-4.11.1">¶</a></p>
</li>
        <li class="normal" id="appendix-C-4.12">
          <p id="appendix-C-4.12.1"><span class="contact-name">Paul Wouters (IESG)</span><a class="pilcrow" href="#appendix-C-4.12.1">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-D">
      <h2 id="name-authors-addresses">
<a class="section-name selfRef" href="#name-authors-addresses">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Adam Wiethuechter (<span class="role">editor</span>)</span></div>
<div class="left" dir="auto"><span class="org">AX Enterprize, LLC</span></div>
<div class="left" dir="auto"><span class="street-address">4947 Commercial Drive</span></div>
<div class="left" dir="auto">
<span class="locality">Yorkville</span>, <span class="region">NY</span> <span class="postal-code">13495</span>
</div>
<div class="left" dir="auto"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:adam.wiethuechter@axenterprize.com">adam.wiethuechter@axenterprize.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Stuart Card</span></div>
<div class="left" dir="auto"><span class="org">AX Enterprize, LLC</span></div>
<div class="left" dir="auto"><span class="street-address">4947 Commercial Drive</span></div>
<div class="left" dir="auto">
<span class="locality">Yorkville</span>, <span class="region">NY</span> <span class="postal-code">13495</span>
</div>
<div class="left" dir="auto"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:stu.card@axenterprize.com">stu.card@axenterprize.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Robert Moskowitz</span></div>
<div class="left" dir="auto"><span class="org">HTT Consulting</span></div>
<div class="left" dir="auto">
<span class="locality">Oak Park</span>, <span class="region">MI</span> <span class="postal-code">48237</span>
</div>
<div class="left" dir="auto"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:rgm@labs.htt-consult.com">rgm@labs.htt-consult.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>


</body></html>