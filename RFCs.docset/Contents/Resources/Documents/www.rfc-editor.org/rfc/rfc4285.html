<html><head></head><body><pre>Network Working Group                                           A. Patel
Request for Comments: 4285                                      K. Leung
Category: Informational                                    Cisco Systems
                                                               M. Khalil
                                                               H. Akhtar
                                                         Nortel Networks
                                                            K. Chowdhury
                                                        Starent Networks
                                                            January 2006


                <span class="h1">Authentication Protocol for Mobile IPv6</span>

Status of this Memo

   This memo provides information for the Internet community.  It does
   not specify an Internet standard of any kind.  Distribution of this
   memo is unlimited.

Copyright Notice

   Copyright (C) The Internet Society (2006).

IESG Note

   This RFC is not a candidate for any level of Internet Standard.  <a href="./rfc3775">RFC</a>
   <a href="./rfc3775">3775</a> and 3776 define Mobile IPv6 and its security mechanism.  This
   document presents an alternate security mechanism for Mobile IPv6
   used in 3GPP2 networks.

   The security properties of this mechanism have not been reviewed in
   the IETF.  Conducting this review proved difficult because the
   standards-track security mechanism for Mobile IPv6 is tightly
   integrated into the protocol; extensions to Mobile IPv6 and the core
   documents make assumptions about the properties of the security model
   without explicitly stating what assumptions are being made.  There is
   no documented service model.  Thus it is difficult to replace the
   security mechanism and see if the current protocol and future
   extensions meet appropriate security requirements both under the
   original and new security mechanisms.  If a service model for Mobile
   IPv6 security is ever formally defined and reviewed, a mechanism
   similar to this one could be produced and fully reviewed.

   <a href="#section-1.1">Section 1.1</a> of this document provides an applicability statement for
   this RFC.  The IESG recommends against the usage of this
   specification outside of environments that meet the conditions of
   that applicability statement.  In addition the IESG recommends those




<span class="grey">Patel, et al.                Informational                      [Page 1]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-2"></span>
<span class="grey"><a href="./rfc4285">RFC 4285</a>        Authentication Protocol for Mobile IPv6     January 2006</span>


   considering deploying or implementing this specification conduct a
   sufficient security review to meet the conditions of the environments
   in which this RFC will be used.

Abstract

   IPsec is specified as the means of securing signaling messages
   between the Mobile Node and Home Agent for Mobile IPv6 (MIPv6).
   MIPv6 signaling messages that are secured include the Binding Updates
   and Acknowledgement messages used for managing the bindings between a
   Mobile Node and its Home Agent.  This document proposes an alternate
   method for securing MIPv6 signaling messages between Mobile Nodes and
   Home Agents.  The alternate method defined here consists of a
   MIPv6-specific mobility message authentication option that can be
   added to MIPv6 signaling messages.

Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-3">3</a>
      <a href="#section-1.1">1.1</a>. Applicability Statement ....................................<a href="#page-3">3</a>
   <a href="#section-2">2</a>. Overview ........................................................<a href="#page-4">4</a>
   <a href="#section-3">3</a>. Terminology .....................................................<a href="#page-5">5</a>
      <a href="#section-3.1">3.1</a>. General Terms ..............................................<a href="#page-5">5</a>
   <a href="#section-4">4</a>. Operational Flow ................................................<a href="#page-6">6</a>
   <a href="#section-5">5</a>. Mobility Message Authentication Option ..........................<a href="#page-7">7</a>
      <a href="#section-5.1">5.1</a>. MN-HA Mobility Message Authentication Option ...............<a href="#page-8">8</a>
           <a href="#section-5.1.1">5.1.1</a>. Processing Considerations ...........................<a href="#page-9">9</a>
      <a href="#section-5.2">5.2</a>. MN-AAA Mobility Message Authentication Option ..............<a href="#page-9">9</a>
           <a href="#section-5.2.1">5.2.1</a>. Processing Considerations ..........................<a href="#page-10">10</a>
      <a href="#section-5.3">5.3</a>. Authentication Failure Detection at the Mobile Node .......<a href="#page-11">11</a>
   <a href="#section-6">6</a>. Mobility Message Replay Protection Option ......................<a href="#page-11">11</a>
   <a href="#section-7">7</a>. Security Considerations ........................................<a href="#page-13">13</a>
   <a href="#section-8">8</a>. IANA Considerations ............................................<a href="#page-14">14</a>
   <a href="#section-9">9</a>. Acknowledgements ...............................................<a href="#page-15">15</a>
   <a href="#section-10">10</a>. References ....................................................<a href="#page-15">15</a>
      <a href="#section-10.1">10.1</a>. Normative References .....................................<a href="#page-15">15</a>
      <a href="#section-10.2">10.2</a>. Informative References ...................................<a href="#page-15">15</a>
   <a href="#appendix-A">Appendix A</a>. Rationale for mobility message replay protection
               option ................................................<a href="#page-16">16</a>












<span class="grey">Patel, et al.                Informational                      [Page 2]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-3"></span>
<span class="grey"><a href="./rfc4285">RFC 4285</a>        Authentication Protocol for Mobile IPv6     January 2006</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" id="section-1">1</a>.  Introduction</span>

   The base Mobile IPv6 specification [<a href="./rfc3775" title='"Mobility Support in IPv6"'>RFC3775</a>] specifies the signaling
   messages, Binding Update (BU) and Binding Acknowledgement (BA),
   between the Mobile Node (MN) and Home Agent (HA) to be secured by the
   IPsec Security Associations (IPsec SAs) that are established between
   these two entities.

   This document proposes a solution for securing the Binding Update and
   Binding Acknowledgment messages between the Mobile Node and Home
   Agent using a mobility message authentication option that is included
   in these messages.  Such a mechanism enables IPv6 mobility in a host
   without having to establish an IPsec SA with its Home Agent.  A
   Mobile Node can implement Mobile IPv6 without having to integrate it
   with the IPsec module, in which case the Binding Update and Binding
   Acknowledgement messages (between MN-HA) are secured with the
   mobility message authentication option.

   The authentication mechanism proposed here is similar to the
   authentication mechanism used in Mobile IPv4 [<a href="./rfc3344" title='"IP Mobility Support for IPv4"'>RFC3344</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/1.1.%20%20Applicability%20Statement"></a><a class="selflink" href="#section-1.1" id="section-1.1">1.1</a>.  Applicability Statement</span>

   The mobility message authentication option specified in <a href="#section-5">Section 5</a> is
   applicable in certain types of networks that have the following
   characteristics:

   - Networks in which the authentication of the MN for network access
   is done by an authentication server in the home network via the home
   agent.  The security association is established by the network
   operator (provisioning methods) between the MN and a backend
   authentication server (e.g., Authentication, Authorization, and
   Accounting (AAA) home server).  MIPv6 as per RFCs 3775 and 3776
   relies on the IPsec SA between the MN and an HA.  In cases where the
   assignment of the HA is dynamic and the only static or long-term SA
   is between the MN and a backend authentication server, the mobility
   message authentication option is desirable.

   - In certain deployment environments, the mobile node needs dynamic
   assignment of a home agent and home address.  The assignment of such
   can be on a per-session basis or on a per-MN power-up basis.  In such
   scenarios, the MN relies on an identity such as a Network Access
   Identifier (NAI) [<a href="./rfc4283" title='"Mobile Node Identifier Option for Mobile IPv6"'>RFC4283</a>], and a security association with a AAA
   server to obtain such bootstrapping information.  The security
   association is created via an out-of-band mechanism or by non Mobile
   IPv6 signaling.  The out-of-band mechanism can be specific to the
   deployment environment of a network operator.  In Code Division
   Multiple Access (CDMA) network deployments, this information can be



<span class="grey">Patel, et al.                Informational                      [Page 3]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-4"></span>
<span class="grey"><a href="./rfc4285">RFC 4285</a>        Authentication Protocol for Mobile IPv6     January 2006</span>


   obtained at the time of network access authentication via [<a href="#ref-3GPP2" title='"cdma2000 Wireless IP Network Standard"'>3GPP2</a>]
   specific extensions to PPP or DHCPv6 on the access link and by AAA
   extensions in the core.  It should be noted that the out-of-band
   mechanism is not within the scope of the mobility message
   authentication option (<a href="#section-5">Section 5</a>) and hence is not described therein.

   - Network deployments in which not all Mobile Nodes and Home Agents
   have IKEv2 implementations and support for the integration of IKEv2
   with backend AAA infrastructures.  IKEv2 as a technology has yet to
   reach maturity status and widespread implementations needed for
   commercial deployments on a large scale.  At the time of this
   writing, [<a href="./rfc4306" title='"Internet Key Exchange (IKEv2) Protocol"'>RFC4306</a>] is yet to be published as an RFC.  Hence from a
   practical perspective that operators face, IKEv2 is not yet capable
   of addressing the immediate need for MIPv6 deployment.

   - Networks that expressly rely on the backend AAA infrastructure as
   the primary means for identifying and authentication/authorizing a
   mobile user for MIPv6 service.

   - Networks in which the establishment of the security association
   between the Mobile Node and the authentication server (AAA Home) is
   established using an out-of-band mechanism and not by any key
   exchange protocol.  Such networks will also rely on out-of-band
   mechanisms to renew the security association (between MN and AAA
   Home) when needed.

   - Networks that are bandwidth constrained (such as cellular wireless
   networks) and for which there exists a strong desire to minimize the
   number of signaling messages sent over such interfaces.  MIPv6
   signaling that relies on Internet Key Exchange (IKE) as the primary
   means for setting up an SA between the MN and HA requires more
   signaling messages compared with the use of an mobility message
   authentication option carried in the BU/BA messages.

   One such example of networks that have such characteristics are CDMA
   networks as defined in [<a href="#ref-3GPP2" title='"cdma2000 Wireless IP Network Standard"'>3GPP2</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/2.%20%20Overview"></a><a class="selflink" href="#section-2" id="section-2">2</a>.  Overview</span>

   This document presents a lightweight mechanism to authenticate the
   Mobile Node at the Home Agent or at the Authentication,
   Authorization, and Accounting (AAA) server in Home network (AAAH)
   based on a shared-key-based mobility security association between the
   Mobile Node and the respective authenticating entity.  This shared-
   key-based mobility security association (shared-key-based mobility
   SA) may be statically provisioned or dynamically created.  The term





<span class="grey">Patel, et al.                Informational                      [Page 4]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-5"></span>
<span class="grey"><a href="./rfc4285">RFC 4285</a>        Authentication Protocol for Mobile IPv6     January 2006</span>


   "mobility security association" referred to in this document is
   understood to be a "shared-key-based Mobile IPv6 authentication"
   security association.

   This document introduces new mobility options to aid in
   authentication of the Mobile Node to the Home Agent or AAAH server.
   The confidentiality protection of Return Routability messages and
   authentication/integrity protection of Mobile Prefix Discovery (MPD)
   is not provided when these options are used for authentication of the
   Mobile Node to the Home Agent.  Thus, unless the network can
   guarantee such protection (for instance, like in 3GPP2 networks),
   Route Optimization and Mobile Prefix Discovery should not be used
   when using the mobility message authentication option.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.%20%20Terminology"></a><a class="selflink" href="#section-3" id="section-3">3</a>.  Terminology</span>

   The keywords "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in <a href="./rfc2119">RFC 2119</a>.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.1.%20%20General%20Terms"></a><a class="selflink" href="#section-3.1" id="section-3.1">3.1</a>.  General Terms</span>

   First (size, input)

      Some formulas in this specification use a functional form "First
      (size, input)" to indicate truncation of the "input" data so that
      only the first "size" bits remain to be used.

   Shared-key-based Mobility Security Association

      Security relation between the Mobile Node and its Home Agent, used
      to authenticate the Mobile Node for mobility service.  The
      shared-key-based mobility security association between Mobile Node
      and Home Agent consists of a mobility Security Parameter Index
      (SPI), a shared key, an authentication algorithm, and the replay
      protection mechanism in use.

   Mobility SPI

      A number in the range [0-4294967296] used to index into the
      shared-key-based mobility security associations.










<span class="grey">Patel, et al.                Informational                      [Page 5]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-6"></span>
<span class="grey"><a href="./rfc4285">RFC 4285</a>        Authentication Protocol for Mobile IPv6     January 2006</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/4.%20%20Operational%20Flow"></a><a class="selflink" href="#section-4" id="section-4">4</a>.  Operational Flow</span>

   The figure below describes the sequence of messages sent and received
   between the MN and HA in the registration process.  Binding Update
   (BU) and Binding Acknowledgement (BA) messages are used in the
   registration process.

         MN                                                  HA/AAAH

         |                   BU to HA                           |
   (a)   |-----------------------------------------------------&gt;|
         | (including MN-ID option,                             |
         |  mobility message replay protection option[optional],|
         |  mobility message authentication option)             |
         |                                                      |
         |                                   HA/AAAH authenticates MN
         |                                                      |
         |                                                      |
         |                  BA to MN                            |
   (b)   |&lt;-----------------------------------------------------|
         | (including MN-ID option,                             |
         |  mobility message replay protection option[optional],|
         |  mobility message authentication option)             |
         |                                                      |

         Figure 1: Home Registration with Authentication Protocol

   The Mobile Node MUST use the Mobile Node Identifier option,
   specifically the MN-NAI mobility option as defined in [<a href="./rfc4283" title='"Mobile Node Identifier Option for Mobile IPv6"'>RFC4283</a>] to
   identify itself while authenticating with the Home Agent.  The Mobile
   Node uses the Mobile Node Identifier option as defined in [<a href="./rfc4283" title='"Mobile Node Identifier Option for Mobile IPv6"'>RFC4283</a>]
   to identify itself as may be required for use with some existing AAA
   infrastructure designs.

   The Mobile Node MAY use the Message Identifier option as defined in
   <a href="#section-6">Section 6</a> for additional replay protection.

   The mobility message authentication option described in <a href="#section-5">Section 5</a> may
   be used by the Mobile Node to transfer authentication data when the
   Mobile Node and the Home Agent are utilizing a mobility SPI (a number
   in the range [0-4294967296] used to index into the shared-key-based
   mobility security associations) to index between multiple mobility
   security associations.








<span class="grey">Patel, et al.                Informational                      [Page 6]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-7"></span>
<span class="grey"><a href="./rfc4285">RFC 4285</a>        Authentication Protocol for Mobile IPv6     January 2006</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.%20%20Mobility%20Message%20Authentication%20Option"></a><a class="selflink" href="#section-5" id="section-5">5</a>.  Mobility Message Authentication Option</span>

   This section defines a mobility message authentication option that
   may be used to secure Binding Update and Binding Acknowledgement
   messages.  This option can be used along with IPsec or preferably as
   an alternate mechanism to authenticate Binding Update and Binding
   Acknowledgement messages in the absence of IPsec.

   This document also defines subtype numbers, which identify the mode
   of authentication and the peer entity to authenticate the message.
   Two subtype numbers are specified in this document.  Other subtypes
   may be defined for use in the future.

   Only one instance of a mobility message authentication option of a
   particular subtype can be present in the message.  One message may
   contain multiple instances of the mobility message authentication
   option with different subtype values.  If both MN-HA and MN-AAA
   authentication options are present, the MN-HA authentication option
   must be present before the MN-AAA authentication option (else, the HA
   MUST discard the message).

   When a Binding Update or Binding Acknowledgement is received without
   a mobility message authentication option and the entity receiving it
   is configured to use the mobility message authentication option or
   has the shared-key-based mobility security association for the
   mobility message authentication option, the entity should silently
   discard the received message.

       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
                       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                       |  Option Type  | Option Length |  Subtype      |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                  Mobility SPI                                 |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                  Authentication Data ....
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

             Figure 2: Mobility Message Authentication Option

      Option Type:

         AUTH-OPTION-TYPE value 9 has been defined by IANA.  An 8-bit
         identifier of the type mobility option.







<span class="grey">Patel, et al.                Informational                      [Page 7]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-8"></span>
<span class="grey"><a href="./rfc4285">RFC 4285</a>        Authentication Protocol for Mobile IPv6     January 2006</span>


      Option Length:

         8-bit unsigned integer, representing the length in octets of
         the Subtype, mobility Security Parameter Index (SPI) and
         Authentication Data fields.

      Subtype:

         A number assigned to identify the entity and/or mechanism to be
         used to authenticate the message.

      Mobility SPI:

         Mobility Security Parameter Index

      Authentication Data:

         This field has the information to authenticate the relevant
         mobility entity.  This protects the message beginning at the
         Mobility Header up to and including the mobility SPI field.

      Alignment requirements :

         The alignment requirement for this option is 4n + 1.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.1.%20%20MN-HA%20Mobility%20Message%20Authentication%20Option"></a><a class="selflink" href="#section-5.1" id="section-5.1">5.1</a>.  MN-HA Mobility Message Authentication Option</span>

   The format of the MN-HA mobility message authentication option is as
   defined in Figure 2.  This option uses the subtype value of 1.  The
   MN-HA mobility message authentication option is used to authenticate
   the Binding Update and Binding Acknowledgement messages based on the
   shared-key-based security association between the Mobile Node and the
   Home Agent.

   The shared-key-based mobility security association between Mobile
   Node and Home Agent used within this specification consists of a
   mobility SPI, a key, an authentication algorithm, and the replay
   protection mechanism in use.  The mobility SPI is a number in the
   range [0-4294967296], where the range [0-255] is reserved.  The key
   consists of an arbitrary value and is 16 octets in length.  The
   authentication algorithm is HMAC_SHA1.  The replay protection
   mechanism may use the Sequence number as specified in [<a href="./rfc3775" title='"Mobility Support in IPv6"'>RFC3775</a>] or
   the Timestamp option as defined in <a href="#section-6">Section 6</a>.  If the Timestamp
   option is used for replay protection, the mobility security
   association includes a "close enough" field to account for clock
   drift.  A default value of 7 seconds SHOULD be used.  This value
   SHOULD be greater than 3 seconds.




<span class="grey">Patel, et al.                Informational                      [Page 8]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-9"></span>
<span class="grey"><a href="./rfc4285">RFC 4285</a>        Authentication Protocol for Mobile IPv6     January 2006</span>


   The MN-HA mobility message authentication option MUST be the last
   option in a message with a mobility header if it is the only mobility
   message authentication option in the message.

   The authentication data is calculated on the message starting from
   the mobility header up to and including the mobility SPI value of
   this option.

   Authentication Data = First (96, HMAC_SHA1(MN-HA Shared key, Mobility
   Data))

   Mobility Data = care-of address | home address | Mobility Header (MH)
   Data

   MH Data is the content of the Mobility Header up to and including the
   mobility SPI field of this option.  The Checksum field in the
   Mobility Header MUST be set to 0 to calculate the Mobility Data.

   The first 96 bits from the Message Authentication Code (MAC) result
   are used as the Authentication Data field.

<span class="h4"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.1.1.%20%20Processing%20Considerations"></a><a class="selflink" href="#section-5.1.1" id="section-5.1.1">5.1.1</a>.  Processing Considerations</span>

   The assumption is that the Mobile Node has a shared-key-based
   security association with the Home Agent.  The Mobile Node MUST
   include this option in a BU if it has a shared-key-based mobility
   security association with the Home Agent.  The Home Agent MUST
   include this option in the BA if it received this option in the
   corresponding BU and Home Agent has a shared-key-based mobility
   security association with the Mobile Node.

   The Mobile Node or Home Agent receiving this option MUST verify the
   authentication data in the option.  If authentication fails, the Home
   Agent MUST send BA with Status Code MIPV6-AUTH-FAIL.  If the Home
   Agent does not have shared-key-based mobility SA, Home Agent MUST
   discard the BU.  The Home Agent MAY log such events.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.2.%20%20MN-AAA%20Mobility%20Message%20Authentication%20Option"></a><a class="selflink" href="#section-5.2" id="section-5.2">5.2</a>.  MN-AAA Mobility Message Authentication Option</span>

   The format of the MN-AAA mobility message authentication option is as
   defined in Figure 2.  This option uses the subtype value of 2.  The
   MN-AAA authentication mobility option is used to authenticate the
   Binding Update message based on the shared mobility security
   association between the Mobile Node and AAA server in Home network
   (AAAH).  It is not used in Binding Acknowledgement messages.  The
   corresponding Binding Acknowledgement messages must be authenticated
   using the MN-HA mobility message authentication option (<a href="#section-5.1">Section 5.1</a>).




<span class="grey">Patel, et al.                Informational                      [Page 9]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-10"></span>
<span class="grey"><a href="./rfc4285">RFC 4285</a>        Authentication Protocol for Mobile IPv6     January 2006</span>


   The MN-AAA mobility message authentication option must be the last
   option in a message with a mobility header.  The corresponding
   response MUST include the MN-HA mobility message authentication
   option, and MUST NOT include the MN-AAA mobility message
   authentication option.

   The Mobile Node MAY use the Mobile Node Identifier option [<a href="./rfc4283" title='"Mobile Node Identifier Option for Mobile IPv6"'>RFC4283</a>]
   to enable the Home Agent to make use of available AAA infrastructure.

   The authentication data is calculated on the message starting from
   the mobility header up to and including the mobility SPI value of
   this option.

   The authentication data shall be calculated as follows:

   Authentication data = hash_fn(MN-AAA Shared key, MAC_Mobility Data)

   hash_fn() is decided by the value of mobility SPI field in the MN-AAA
   mobility message authentication option.

   SPI = HMAC_SHA1_SPI:

   If mobility SPI has the well-known value HMAC_SHA1_SPI, then
   hash_fn() is HMAC_SHA1.  When HMAC_SHA1_SPI is used, the BU is
   authenticated by AAA using HMAC_SHA1 authentication.  In that case,
   MAC_Mobility Data is calculated as follows:

   MAC_Mobility Data = SHA1(care-of address | home address | MH Data)

   MH Data is the content of the Mobility Header up to and including the
   mobility SPI field of this option.

<span class="h4"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.2.1.%20%20Processing%20Considerations"></a><a class="selflink" href="#section-5.2.1" id="section-5.2.1">5.2.1</a>.  Processing Considerations</span>

   The use of the MN-AAA mobility message authentication option assumes
   that AAA entities at the home site communicate with the HA via an
   authenticated channel.  Specifically, a BU with the MN-AAA mobility
   message authentication option is authenticated via a home AAA server.
   The specific details of the interaction between the HA and the AAA
   server is beyond the scope of this document.

   When the Home Agent receives a Binding Update with the MN-AAA
   mobility message authentication option, the Binding Update is
   authenticated by an entity external to the Home Agent, typically a
   AAA server.






<span class="grey">Patel, et al.                Informational                     [Page 10]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-11"></span>
<span class="grey"><a href="./rfc4285">RFC 4285</a>        Authentication Protocol for Mobile IPv6     January 2006</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.3.%20%20Authentication%20Failure%20Detection%20at%20the%20Mobile%20Node"></a><a class="selflink" href="#section-5.3" id="section-5.3">5.3</a>.  Authentication Failure Detection at the Mobile Node</span>

   In case of authentication failure, the Home Agent MUST send a Binding
   Acknowledgement with status code MIPV6-AUTH-FAIL to the Mobile Node,
   if a shared-key-based mobility security association to be used
   between Mobile Node and Home Agent for authentication exists.  If
   there is no shared-key-based mobility security association, HA drops
   the Binding Update.  HA may log the message for administrative
   action.

   Upon receiving a Binding Acknowledgement with status code MIPV6-
   AUTH-FAIL, the Mobile Node SHOULD stop sending new Binding Updates to
   the Home Agent.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/6.%20%20Mobility%20Message%20Replay%20Protection%20Option"></a><a class="selflink" href="#section-6" id="section-6">6</a>.  Mobility Message Replay Protection Option</span>

   The Mobility message replay protection option MAY be used in Binding
   Update/Binding Acknowledgement messages when authenticated using the
   mobility message authentication option as described in <a href="#section-5">Section 5</a>.

   The mobility message replay protection option is used to let the Home
   Agent verify that a Binding Update has been freshly generated by the
   Mobile Node and not replayed by an attacker from some previous
   Binding Update.  This is especially useful for cases where the Home
   Agent does not maintain stateful information about the Mobile Node
   after the binding entry has been removed.  The Home Agent does the
   replay protection check after the Binding Update has been
   authenticated.  The mobility message replay protection option when
   included is used by the Mobile Node for matching BA with BU.

   If this mode of replay protection is used, it needs to be part of the
   shared-key-based mobility security association.

   If the policy at Home Agent mandates replay protection using this
   option (as opposed to the sequence number in the Mobility Header in
   Binding Update) and the Binding Update from the Mobile Node does not
   include this option, the Home Agent discards the BU and sets the
   Status Code in BA to MIPV6-MESG-ID-REQD.

   When the Home Agent receives the mobility message replay protection
   option in Binding Update, it MUST include the mobility message replay
   protection option in Binding Acknowledgement.  <a href="#appendix-A">Appendix A</a> provides
   details regarding why the mobility message replay protection option
   MAY be used when using the authentication option.







<span class="grey">Patel, et al.                Informational                     [Page 11]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-12"></span>
<span class="grey"><a href="./rfc4285">RFC 4285</a>        Authentication Protocol for Mobile IPv6     January 2006</span>


       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
                                   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                                   |      Option Type  | Option Length |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                  Timestamp ...                                |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                  Timestamp                                    |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

            Figure 3: Mobility Message Replay Protection Option

      Option Type:

         MESG-ID-OPTION-TYPE value 10 has been defined by IANA.  An
         8-bit identifier of the type mobility option.

      Option Length:

         8-bit unsigned integer, representing the length in octets of
         the Timestamp field.

      Timestamp:

         This field carries the 64 bit timestamp.

      Alignment requirements :

         The alignment requirement for this option is 8n + 2.

   The basic principle of timestamp replay protection is that the node
   generating a message inserts the current time of day, and the node
   receiving the message checks that this timestamp is sufficiently
   close to its own time of day.  Unless specified differently in the
   shared-key-based mobility security association between the nodes, a
   default value of 7 seconds MAY be used to limit the time difference.
   This value SHOULD be greater than 3 seconds.  The two nodes must have
   adequately synchronized time-of-day clocks.

   The Mobile Node MUST set the Timestamp field to a 64-bit value
   formatted as specified by the Network Time Protocol (NTP) [<a href="./rfc1305" title='"Network Time Protocol (Version 3) Specification, Implementation"'>RFC1305</a>].
   The low-order 32 bits of the NTP format represent fractional seconds,
   and those bits that are not available from a time source SHOULD be
   generated from a good source of randomness.  Note, however, that when
   using timestamps, the 64-bit timestamp used in a Binding Update from
   the Mobile Node MUST be greater than that used in any previous
   successful Binding Update.




<span class="grey">Patel, et al.                Informational                     [Page 12]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-13"></span>
<span class="grey"><a href="./rfc4285">RFC 4285</a>        Authentication Protocol for Mobile IPv6     January 2006</span>


   After successful authentication of Binding Update (either locally at
   the Home Agent or when a success indication is received from the AAA
   server), the Home Agent MUST check the Timestamp field for validity.
   In order to be valid, the timestamp contained in the Timestamp field
   MUST be close enough to the Home Agent's time-of-day clock and the
   timestamp MUST be greater than all previously accepted timestamps for
   the requesting Mobile Node.

   If the timestamp is valid, the Home Agent copies the entire Timestamp
   field into the Timestamp field in the BA it returns to the Mobile
   Node.  If the timestamp is not valid, the Home Agent copies only the
   low-order 32 bits into the BA, and supplies the high-order 32 bits
   from its own time of day.

   If the Timestamp field is not valid but the authentication of the BU
   succeeds, the Home Agent MUST send a Binding Acknowledgement with
   status code MIPV6-ID-MISMATCH.  The Home Agent does not create a
   binding cache entry if the timestamp check fails.

   If the Mobile Node receives a Binding Acknowledgement with the code
   MIPV6-ID-MISMATCH, the Mobile Node MUST authenticate the BA by
   processing the MN-HA authentication mobility option.

   If authentication succeeds, the Mobile Node MUST adjust its timestamp
   and send subsequent Binding Update using the updated value.

   Upon receiving a BA that does not contain the MIPV6-ID-MISMATCH
   status code, the Mobile Node MUST compare the Timestamp value in the
   BA to the Timestamp value it sent in the corresponding BU.  If the
   values match, the Mobile Node proceeds to process the MN-HA
   authentication data in the BA.  If the values do not match, the
   Mobile Node silently discards the BA.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/7.%20%20Security%20Considerations"></a><a class="selflink" href="#section-7" id="section-7">7</a>.  Security Considerations</span>

   This document proposes new mobility message authentication options to
   authenticate the control message between Mobile Node, Home Agent,
   and/or home AAA (as an alternative to IPsec).  The new options
   provide for authentication of Binding Update and Binding
   Acknowledgement messages.  The MN-AAA mobility message authentication
   option provide for authentication with AAA infrastructure.

   This specification also introduces an optional replay protection
   mechanism in <a href="#section-6">Section 6</a>, to prevent replay attacks.  The sequence
   number field in the Binding Update is not used if this mechanism is
   used.  This memo defines the timestamp option to be used for mobility
   message replay protection.




<span class="grey">Patel, et al.                Informational                     [Page 13]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-14"></span>
<span class="grey"><a href="./rfc4285">RFC 4285</a>        Authentication Protocol for Mobile IPv6     January 2006</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/8.%20%20IANA%20Considerations"></a><a class="selflink" href="#section-8" id="section-8">8</a>.  IANA Considerations</span>

   IANA services are required for this specification.  The values for
   new mobility options and status codes must be assigned from the
   Mobile IPv6 [<a href="./rfc3775" title='"Mobility Support in IPv6"'>RFC3775</a>] numbering space.

   The values for Mobility Option types AUTH-OPTION-TYPE and MESG-ID-
   OPTION-TYPE, as defined in <a href="#section-5">Section 5</a> and <a href="#section-6">Section 6</a>, have been
   assigned.  The values are 9 for the AUTH-OPTION-TYPE and 10 for the
   MESG-ID-OPTION-TYPE Mobility Option.

   The values for status codes MIPV6-ID-MISMATCH, MIPv6-AUTH-FAIL, and
   MIPV6-MESG-ID-REQD, as defined in <a href="#section-6">Section 6</a> and <a href="#section-5.3">Section 5.3</a>, have
   been assigned.  The values are 144 for MIPV6-ID-MISMATCH 145 for
   MIPV6-MESG-ID-REQD and 146 for MIPV6-AUTH-FAIL.

   A new section for enumerating algorithms identified by specific
   mobility SPIs within the range 0-255 has to be added to

   <a href="http://www.iana.org/assignments/mobility-parameters">http://www.iana.org/assignments/mobility-parameters</a>

   The currently defined values are as follows:

   The value 0 should not be assigned.

   The value 3 is reserved for HMAC_SHA1_SPI as defined in <a href="#section-5.2">Section 5.2</a>.

   The value 5 is reserved for use by 3GPP2.

   New values for this namespace can be allocated using IETF Consensus.
   [<a href="./rfc2434" title="">RFC2434</a>].

   In addition, IANA has created a new namespace for the Subtype field
   of the MN-HA and MN-AAA mobility message authentication options under

   <a href="http://www.iana.org/assignments/mobility-parameters">http://www.iana.org/assignments/mobility-parameters</a>

   The currently allocated values are as follows:

   1 MN-HA mobility message authentication option <a href="#section-5.1">Section 5.1</a>

   2 MN-AAA mobility message authentication option <a href="#section-5.2">Section 5.2</a>

   New values for this namespace can be allocated using IETF Consensus.
   [<a href="./rfc2434" title="">RFC2434</a>].






<span class="grey">Patel, et al.                Informational                     [Page 14]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-15"></span>
<span class="grey"><a href="./rfc4285">RFC 4285</a>        Authentication Protocol for Mobile IPv6     January 2006</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/9.%20%20Acknowledgements"></a><a class="selflink" href="#section-9" id="section-9">9</a>.  Acknowledgements</span>

   The authors would like to thank Basavaraj Patil, Charlie Perkins,
   Vijay Devarapalli, Jari Arkko, and Gopal Dommety, and Avi Lior for
   their thorough review and suggestions on the document.  The authors
   would like to acknowledge the fact that a similar authentication
   method was considered in base protocol [<a href="./rfc3775" title='"Mobility Support in IPv6"'>RFC3775</a>] at one time.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/10.%20%20References"></a><a class="selflink" href="#section-10" id="section-10">10</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/10.1.%20%20Normative%20References"></a><a class="selflink" href="#section-10.1" id="section-10.1">10.1</a>.  Normative References</span>

   [<a id="ref-RFC4283">RFC4283</a>]   Patel, A., Leung, K., Khalil, M., Akhtar, H., and K.
               Chowdhury, "Mobile Node Identifier Option for Mobile
               IPv6", <a href="./rfc4283">RFC 4283</a>, November 2005.

   [<a id="ref-RFC1305">RFC1305</a>]   Mills, D., "Network Time Protocol (Version 3)
               Specification, Implementation", <a href="./rfc1305">RFC 1305</a>, March 1992.

   [<a id="ref-RFC2434">RFC2434</a>]   Narten, T. and H. Alvestrand, "Guidelines for Writing an
               IANA Considerations Section in RFCs", <a href="https://www.rfc-editor.org/bcp/bcp26">BCP 26</a>, <a href="./rfc2434">RFC 2434</a>,
               October 1998.

   [<a id="ref-RFC3344">RFC3344</a>]   Perkins, C., "IP Mobility Support for IPv4", <a href="./rfc3344">RFC 3344</a>,
               August 2002.

   [<a id="ref-RFC3775">RFC3775</a>]   Johnson, D., Perkins, C., and J. Arkko, "Mobility Support
               in IPv6", <a href="./rfc3775">RFC 3775</a>, June 2004.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/10.2.%20%20Informative%20References"></a><a class="selflink" href="#section-10.2" id="section-10.2">10.2</a>.  Informative References</span>

   [<a id="ref-3GPP2">3GPP2</a>]     "cdma2000 Wireless IP Network Standard", 3GPP2 X.S0011-D,
               September 2005.

   [<a id="ref-RFC4306">RFC4306</a>]   Kaufman, C., Ed., "Internet Key Exchange (IKEv2)
               Protocol", <a href="./rfc4306">RFC 4306</a>, December 2005.















<span class="grey">Patel, et al.                Informational                     [Page 15]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-16"></span>
<span class="grey"><a href="./rfc4285">RFC 4285</a>        Authentication Protocol for Mobile IPv6     January 2006</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/Appendix%20A.%20%20Rationale%20for%20Mobility%20Message%20Replay%20Protection%20Option"></a><a class="selflink" href="#appendix-A" id="appendix-A">Appendix A</a>.  Rationale for Mobility Message Replay Protection Option</span>

   Mobile IPv6 [<a href="./rfc3775" title='"Mobility Support in IPv6"'>RFC3775</a>] defines a Sequence Number in the mobility
   header to prevent replay attacks.  There are two aspects that stand
   out in regards to using the Sequence Number to prevent replay
   attacks.

   First, the specification states that the Home Agent should accept a
   BU with a Sequence Number greater than the Sequence Number from the
   previous Binding Update.  This implicitly assumes that the Home Agent
   has some information regarding the Sequence Number from the previous
   BU (even when the binding cache entry is not present).  Second, the
   specification states that if the Home Agent has no binding cache
   entry for the indicated home address, it MUST accept any Sequence
   Number value in a received Binding Update from this Mobile Node.

   With the mechanism defined in this document, it is possible for the
   Mobile Node to register with a different Home Agent during each
   mobility session.  Thus, it is unreasonable to expect each Home Agent
   in the network to maintain state about the Mobile Node.  Also, if the
   Home Agent does not cache information regarding sequence number, as
   per the second point above, a replayed BU can cause a Home Agent to
   create a binding cache entry for the Mobile Node.  Thus, when
   authentication option is used, Sequence Number does not provide
   protection against replay attack.

   One solution to this problem (when the Home Agent does not save state
   information for every Mobile Node) would be for the Home Agent to
   reject the first BU and assign a (randomly generated) starting
   sequence number for the session and force the Mobile Node to send a
   fresh BU with the suggested sequence number.  While this would work
   in most cases, it would require an additional round trip, and this
   extra signaling and latency is not acceptable in certain deployments
   [<a href="#ref-3GPP2" title='"cdma2000 Wireless IP Network Standard"'>3GPP2</a>].  Also, this rejection and using sequence number as a nonce
   in rejection is a new behavior that is not specified in [<a href="./rfc3775" title='"Mobility Support in IPv6"'>RFC3775</a>].

   Thus, this specification uses the mobility message replay protection
   option to prevent replay attacks.  Specifically, timestamps are used
   to prevent replay attacks as described in <a href="#section-6">Section 6</a>.

   It is important to note that as per Mobile IPv6 [<a href="./rfc3775" title='"Mobility Support in IPv6"'>RFC3775</a>] this
   problem with sequence number exists.  Since the base specification
   mandates the use of IPsec (and naturally that goes with IKE in most
   cases), the real replay protection is provided by IPsec/IKE.  In case
   of BU/BA between Mobile Node and Client Node (CN), the liveness proof
   is provided by the use of nonces that the CN generates.





<span class="grey">Patel, et al.                Informational                     [Page 16]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-17"></span>
<span class="grey"><a href="./rfc4285">RFC 4285</a>        Authentication Protocol for Mobile IPv6     January 2006</span>


Authors' Addresses

   Alpesh Patel
   Cisco Systems
   170 W. Tasman Drive
   San Jose, CA  95134
   US

   Phone: +1 408-853-9580
   EMail: alpesh@cisco.com


   Kent Leung
   Cisco Systems
   170 W. Tasman Drive
   San Jose, CA  95134
   US

   Phone: +1 408-526-5030
   EMail: kleung@cisco.com


   Mohamed Khalil
   Nortel Networks
   2221 Lakeside Blvd.
   Richardson, TX  75082
   US

   Phone: +1 972-685-0574
   EMail: mkhalil@nortel.com


   Haseeb Akhtar
   Nortel Networks
   2221 Lakeside Blvd.
   Richardson, TX  75082
   US

   Phone: +1 972-684-4732
   EMail: haseebak@nortel.com











<span class="grey">Patel, et al.                Informational                     [Page 17]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-18"></span>
<span class="grey"><a href="./rfc4285">RFC 4285</a>        Authentication Protocol for Mobile IPv6     January 2006</span>


   Kuntal Chowdhury
   Starent Networks
   30 International Place
   Tewksbury, MA  01876
   US

   Phone: +1 214 550 1416
   EMail: kchowdhury@starentnetworks.com











































<span class="grey">Patel, et al.                Informational                     [Page 18]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-19"></span>
<span class="grey"><a href="./rfc4285">RFC 4285</a>        Authentication Protocol for Mobile IPv6     January 2006</span>


Full Copyright Statement

   Copyright (C) The Internet Society (2006).

   This document is subject to the rights, licenses and restrictions
   contained in <a href="https://www.rfc-editor.org/bcp/bcp78">BCP 78</a>, and except as set forth therein, the authors
   retain all their rights.

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY AND THE INTERNET
   ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS OR IMPLIED,
   INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE
   INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

Intellectual Property

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in <a href="https://www.rfc-editor.org/bcp/bcp78">BCP 78</a> and <a href="https://www.rfc-editor.org/bcp/bcp79">BCP 79</a>.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   <a href="http://www.ietf.org/ipr">http://www.ietf.org/ipr</a>.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at
   ietf-ipr@ietf.org.

Acknowledgement

   Funding for the RFC Editor function is provided by the IETF
   Administrative Support Activity (IASA).







Patel, et al.                Informational                     [Page 19]
</pre>
</body></html>