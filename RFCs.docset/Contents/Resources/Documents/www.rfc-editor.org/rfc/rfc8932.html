<!DOCTYPE html>
<html class="RFC BCP" lang="en"><head>
<meta charset="utf-8"/>
<meta content="Common,Latin" name="scripts"/>
<meta content="initial-scale=1.0" name="viewport"/>
<title>RFC 8932: Recommendations for DNS Privacy Service Operators</title>
<meta content="Sara Dickinson" name="author"/>
<meta content="Benno J. Overeinder" name="author"/>
<meta content="Roland M. van Rijswijk-Deij" name="author"/>
<meta content="Allison Mankin" name="author"/>
<meta content="
       This document presents operational, policy, and security
      considerations for DNS recursive resolver operators who choose to offer
      DNS privacy services.  With these recommendations, the operator can make
      deliberate decisions regarding which services to provide, as well as
      understanding how those decisions and the alternatives impact the
      privacy of users.
 
       This document also presents a non-normative framework to assist
      writers of a Recursive operator Privacy Statement, analogous to DNS
      Security Extensions (DNSSEC) Policies and DNSSEC Practice Statements
      described in RFC 6841.
 
    " name="description"/>
<meta content="xml2rfc 3.3.0" name="generator"/>
<meta content="DNS" name="keyword"/>
<meta content="8932" name="rfc.number"/>
<!-- Generator version information:
  xml2rfc 3.3.0
    Python 3.6.10
    appdirs 1.4.4
    ConfigArgParse 1.2.3
    google-i18n-address 2.3.5
    html5lib 1.0.1
    intervaltree 3.0.2
    Jinja2 2.11.2
    kitchen 1.2.6
    lxml 4.4.2
    pycairo 1.19.0
    pycountry 19.8.18
    pyflakes 2.1.1
    PyYAML 5.3.1
    requests 2.22.0
    setuptools 40.6.2
    six 1.14.0
    WeasyPrint 51
-->
<link href="rfc8932.xml" rel="alternate" type="application/rfc+xml"/>
<link href="#copyright" rel="license"/>
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css"/>
<link href="https://dx.doi.org/10.17487/rfc8932" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <link href="https://datatracker.ietf.org/doc/draft-ietf-dprive-bcp-op-14" rel="prev"/>
  </head>
<body>
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 8932</td>
<td class="center">DNS Privacy Service Recommendations</td>
<td class="right">October 2020</td>
</tr></thead>
<tfoot><tr>
<td class="left">Dickinson, et al.</td>
<td class="center">Best Current Practice</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div class="document-information" id="external-metadata"></div>
<div class="document-information" id="internal-metadata">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a class="eref" href="https://www.rfc-editor.org/rfc/rfc8932">8932</a></dd>
<dt class="label-bcp">BCP:</dt>
<dd class="bcp">232</dd>
<dt class="label-category">Category:</dt>
<dd class="category">Best Current Practice</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time class="published" datetime="2020-10">October 2020</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">S. Dickinson</div>
<div class="org">Sinodun IT</div>
</div>
<div class="author">
      <div class="author-name">B. Overeinder</div>
<div class="org">NLnet Labs</div>
</div>
<div class="author">
      <div class="author-name">R. van Rijswijk-Deij</div>
<div class="org">NLnet Labs</div>
</div>
<div class="author">
      <div class="author-name">A. Mankin</div>
<div class="org">Salesforce</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 8932</h1>
<h1 id="title">Recommendations for DNS Privacy Service Operators</h1>
<section id="section-abstract">
      <h2 id="abstract"><a class="selfRef" href="#abstract">Abstract</a></h2>
<p id="section-abstract-1">This document presents operational, policy, and security
      considerations for DNS recursive resolver operators who choose to offer
      DNS privacy services.  With these recommendations, the operator can make
      deliberate decisions regarding which services to provide, as well as
      understanding how those decisions and the alternatives impact the
      privacy of users.<a class="pilcrow" href="#section-abstract-1">¶</a></p>
<p id="section-abstract-2">This document also presents a non-normative framework to assist
      writers of a Recursive operator Privacy Statement, analogous to DNS
      Security Extensions (DNSSEC) Policies and DNSSEC Practice Statements
      described in RFC 6841.<a class="pilcrow" href="#section-abstract-2">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a class="section-name selfRef" href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This memo documents an Internet Best Current Practice.<a class="pilcrow" href="#section-boilerplate.1-1">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further information
            on BCPs is available in Section 2 of RFC 7841.<a class="pilcrow" href="#section-boilerplate.1-2">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc8932">https://www.rfc-editor.org/info/rfc8932</a></span>.<a class="pilcrow" href="#section-boilerplate.1-3">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a class="section-name selfRef" href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2020 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a class="pilcrow" href="#section-boilerplate.2-1">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a class="pilcrow" href="#section-boilerplate.2-2">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a class="toplink" href="#" onclick="scroll(0,0)">▲</a><h2 id="name-table-of-contents">
<a class="section-name selfRef" href="#name-table-of-contents">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.1">
            <p class="keepWithNext" id="section-toc.1-1.1.1"><a class="xref" href="#section-1">1</a>.  <a class="xref" href="#name-introduction">Introduction</a><a class="pilcrow" href="#section-toc.1-1.1.1">¶</a></p>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.2">
            <p class="keepWithNext" id="section-toc.1-1.2.1"><a class="xref" href="#section-2">2</a>.  <a class="xref" href="#name-scope">Scope</a><a class="pilcrow" href="#section-toc.1-1.2.1">¶</a></p>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.3">
            <p class="keepWithNext" id="section-toc.1-1.3.1"><a class="xref" href="#section-3">3</a>.  <a class="xref" href="#name-privacy-related-documents">Privacy-Related Documents</a><a class="pilcrow" href="#section-toc.1-1.3.1">¶</a></p>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a class="xref" href="#section-4">4</a>.  <a class="xref" href="#name-terminology">Terminology</a><a class="pilcrow" href="#section-toc.1-1.4.1">¶</a></p>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a class="xref" href="#section-5">5</a>.  <a class="xref" href="#name-recommendations-for-dns-pri">Recommendations for DNS Privacy Services</a><a class="pilcrow" href="#section-toc.1-1.5.1">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a class="xref" href="#section-5.1">5.1</a>.  <a class="xref" href="#name-on-the-wire-between-client-">On the Wire between Client and Server</a><a class="pilcrow" href="#section-toc.1-1.5.2.1.1">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.5.2.1.2.1">
                    <p id="section-toc.1-1.5.2.1.2.1.1"><a class="xref" href="#section-5.1.1">5.1.1</a>.  <a class="xref" href="#name-transport-recommendations">Transport Recommendations</a><a class="pilcrow" href="#section-toc.1-1.5.2.1.2.1.1">¶</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.5.2.1.2.2">
                    <p id="section-toc.1-1.5.2.1.2.2.1"><a class="xref" href="#section-5.1.2">5.1.2</a>.  <a class="xref" href="#name-authentication-of-dns-priva">Authentication of DNS Privacy Services</a><a class="pilcrow" href="#section-toc.1-1.5.2.1.2.2.1">¶</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.5.2.1.2.3">
                    <p id="section-toc.1-1.5.2.1.2.3.1"><a class="xref" href="#section-5.1.3">5.1.3</a>.  <a class="xref" href="#name-protocol-recommendations">Protocol Recommendations</a><a class="pilcrow" href="#section-toc.1-1.5.2.1.2.3.1">¶</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.5.2.1.2.4">
                    <p id="section-toc.1-1.5.2.1.2.4.1"><a class="xref" href="#section-5.1.4">5.1.4</a>.  <a class="xref" href="#name-dnssec">DNSSEC</a><a class="pilcrow" href="#section-toc.1-1.5.2.1.2.4.1">¶</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.5.2.1.2.5">
                    <p id="section-toc.1-1.5.2.1.2.5.1"><a class="xref" href="#section-5.1.5">5.1.5</a>.  <a class="xref" href="#name-availability">Availability</a><a class="pilcrow" href="#section-toc.1-1.5.2.1.2.5.1">¶</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.5.2.1.2.6">
                    <p id="section-toc.1-1.5.2.1.2.6.1"><a class="xref" href="#section-5.1.6">5.1.6</a>.  <a class="xref" href="#name-service-options">Service Options</a><a class="pilcrow" href="#section-toc.1-1.5.2.1.2.6.1">¶</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.5.2.1.2.7">
                    <p id="section-toc.1-1.5.2.1.2.7.1"><a class="xref" href="#section-5.1.7">5.1.7</a>.  <a class="xref" href="#name-impact-of-encryption-on-mon">Impact of Encryption on Monitoring by DNS Privacy Service Operators</a><a class="pilcrow" href="#section-toc.1-1.5.2.1.2.7.1">¶</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.5.2.1.2.8">
                    <p id="section-toc.1-1.5.2.1.2.8.1"><a class="xref" href="#section-5.1.8">5.1.8</a>.  <a class="xref" href="#name-limitations-of-fronting-a-d">Limitations of Fronting a DNS Privacy Service with a Pure TLS Proxy</a><a class="pilcrow" href="#section-toc.1-1.5.2.1.2.8.1">¶</a></p>
</li>
                </ul>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a class="xref" href="#section-5.2">5.2</a>.  <a class="xref" href="#name-data-at-rest-on-the-server">Data at Rest on the Server</a><a class="pilcrow" href="#section-toc.1-1.5.2.2.1">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.5.2.2.2.1">
                    <p id="section-toc.1-1.5.2.2.2.1.1"><a class="xref" href="#section-5.2.1">5.2.1</a>.  <a class="xref" href="#name-data-handling">Data Handling</a><a class="pilcrow" href="#section-toc.1-1.5.2.2.2.1.1">¶</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.5.2.2.2.2">
                    <p id="section-toc.1-1.5.2.2.2.2.1"><a class="xref" href="#section-5.2.2">5.2.2</a>.  <a class="xref" href="#name-data-minimization-of-networ">Data Minimization of Network Traffic</a><a class="pilcrow" href="#section-toc.1-1.5.2.2.2.2.1">¶</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.5.2.2.2.3">
                    <p id="section-toc.1-1.5.2.2.2.3.1"><a class="xref" href="#section-5.2.3">5.2.3</a>.  <a class="xref" href="#name-ip-address-pseudonymization">IP Address Pseudonymization and Anonymization Methods</a><a class="pilcrow" href="#section-toc.1-1.5.2.2.2.3.1">¶</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.5.2.2.2.4">
                    <p id="section-toc.1-1.5.2.2.2.4.1"><a class="xref" href="#section-5.2.4">5.2.4</a>.  <a class="xref" href="#name-pseudonymization-anonymizat">Pseudonymization, Anonymization, or Discarding of Other Correlation Data</a><a class="pilcrow" href="#section-toc.1-1.5.2.2.2.4.1">¶</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.5.2.2.2.5">
                    <p id="section-toc.1-1.5.2.2.2.5.1"><a class="xref" href="#section-5.2.5">5.2.5</a>.  <a class="xref" href="#name-cache-snooping">Cache Snooping</a><a class="pilcrow" href="#section-toc.1-1.5.2.2.2.5.1">¶</a></p>
</li>
                </ul>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a class="xref" href="#section-5.3">5.3</a>.  <a class="xref" href="#name-data-sent-onwards-from-the-">Data Sent Onwards from the Server</a><a class="pilcrow" href="#section-toc.1-1.5.2.3.1">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.5.2.3.2.1">
                    <p id="section-toc.1-1.5.2.3.2.1.1"><a class="xref" href="#section-5.3.1">5.3.1</a>.  <a class="xref" href="#name-protocol-recommendations-2">Protocol Recommendations</a><a class="pilcrow" href="#section-toc.1-1.5.2.3.2.1.1">¶</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.5.2.3.2.2">
                    <p id="section-toc.1-1.5.2.3.2.2.1"><a class="xref" href="#section-5.3.2">5.3.2</a>.  <a class="xref" href="#name-client-query-obfuscation">Client Query Obfuscation</a><a class="pilcrow" href="#section-toc.1-1.5.2.3.2.2.1">¶</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.5.2.3.2.3">
                    <p id="section-toc.1-1.5.2.3.2.3.1"><a class="xref" href="#section-5.3.3">5.3.3</a>.  <a class="xref" href="#name-data-sharing">Data Sharing</a><a class="pilcrow" href="#section-toc.1-1.5.2.3.2.3.1">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a class="xref" href="#section-6">6</a>.  <a class="xref" href="#name-recursive-operator-privacy-">Recursive Operator Privacy Statement (RPS)</a><a class="pilcrow" href="#section-toc.1-1.6.1">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a class="xref" href="#section-6.1">6.1</a>.  <a class="xref" href="#name-outline-of-an-rps">Outline of an RPS</a><a class="pilcrow" href="#section-toc.1-1.6.2.1.1">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.6.2.1.2.1">
                    <p id="section-toc.1-1.6.2.1.2.1.1"><a class="xref" href="#section-6.1.1">6.1.1</a>.  <a class="xref" href="#name-policy">Policy</a><a class="pilcrow" href="#section-toc.1-1.6.2.1.2.1.1">¶</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.6.2.1.2.2">
                    <p id="section-toc.1-1.6.2.1.2.2.1"><a class="xref" href="#section-6.1.2">6.1.2</a>.  <a class="xref" href="#name-practice">Practice</a><a class="pilcrow" href="#section-toc.1-1.6.2.1.2.2.1">¶</a></p>
</li>
                </ul>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a class="xref" href="#section-6.2">6.2</a>.  <a class="xref" href="#name-enforcement-accountability">Enforcement/Accountability</a><a class="pilcrow" href="#section-toc.1-1.6.2.2.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a class="xref" href="#section-7">7</a>.  <a class="xref" href="#name-iana-considerations">IANA Considerations</a><a class="pilcrow" href="#section-toc.1-1.7.1">¶</a></p>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a class="xref" href="#section-8">8</a>.  <a class="xref" href="#name-security-considerations">Security Considerations</a><a class="pilcrow" href="#section-toc.1-1.8.1">¶</a></p>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a class="xref" href="#section-9">9</a>.  <a class="xref" href="#name-references">References</a><a class="pilcrow" href="#section-toc.1-1.9.1">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a class="xref" href="#section-9.1">9.1</a>.  <a class="xref" href="#name-normative-references">Normative References</a><a class="pilcrow" href="#section-toc.1-1.9.2.1.1">¶</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a class="xref" href="#section-9.2">9.2</a>.  <a class="xref" href="#name-informative-references">Informative References</a><a class="pilcrow" href="#section-toc.1-1.9.2.2.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a class="xref" href="#section-appendix.a">Appendix A</a>.  <a class="xref" href="#name-documents">Documents</a><a class="pilcrow" href="#section-toc.1-1.10.1">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a class="xref" href="#section-a.1">A.1</a>.  <a class="xref" href="#name-potential-increases-in-dns-">Potential Increases in DNS Privacy</a><a class="pilcrow" href="#section-toc.1-1.10.2.1.1">¶</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a class="xref" href="#section-a.2">A.2</a>.  <a class="xref" href="#name-potential-decreases-in-dns-">Potential Decreases in DNS Privacy</a><a class="pilcrow" href="#section-toc.1-1.10.2.2.1">¶</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.10.2.3">
                <p id="section-toc.1-1.10.2.3.1"><a class="xref" href="#section-a.3">A.3</a>.  <a class="xref" href="#name-related-operational-documen">Related Operational Documents</a><a class="pilcrow" href="#section-toc.1-1.10.2.3.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a class="xref" href="#section-appendix.b">Appendix B</a>.  <a class="xref" href="#name-ip-address-techniques">IP Address Techniques</a><a class="pilcrow" href="#section-toc.1-1.11.1">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a class="xref" href="#section-b.1">B.1</a>.  <a class="xref" href="#name-categorization-of-technique">Categorization of Techniques</a><a class="pilcrow" href="#section-toc.1-1.11.2.1.1">¶</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a class="xref" href="#section-b.2">B.2</a>.  <a class="xref" href="#name-specific-techniques">Specific Techniques</a><a class="pilcrow" href="#section-toc.1-1.11.2.2.1">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.11.2.2.2.1">
                    <p id="section-toc.1-1.11.2.2.2.1.1"><a class="xref" href="#section-b.2.1">B.2.1</a>.  <a class="xref" href="#name-google-analytics-non-prefix">Google Analytics Non-Prefix Filtering</a><a class="pilcrow" href="#section-toc.1-1.11.2.2.2.1.1">¶</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.11.2.2.2.2">
                    <p id="section-toc.1-1.11.2.2.2.2.1"><a class="xref" href="#section-b.2.2">B.2.2</a>.  <a class="xref" href="#name-dnswasher">dnswasher</a><a class="pilcrow" href="#section-toc.1-1.11.2.2.2.2.1">¶</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.11.2.2.2.3">
                    <p id="section-toc.1-1.11.2.2.2.3.1"><a class="xref" href="#section-b.2.3">B.2.3</a>.  <a class="xref" href="#name-prefix-preserving-map">Prefix-Preserving Map</a><a class="pilcrow" href="#section-toc.1-1.11.2.2.2.3.1">¶</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.11.2.2.2.4">
                    <p id="section-toc.1-1.11.2.2.2.4.1"><a class="xref" href="#section-b.2.4">B.2.4</a>.  <a class="xref" href="#name-cryptographic-prefix-preser">Cryptographic Prefix-Preserving Pseudonymization</a><a class="pilcrow" href="#section-toc.1-1.11.2.2.2.4.1">¶</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.11.2.2.2.5">
                    <p id="section-toc.1-1.11.2.2.2.5.1"><a class="xref" href="#section-b.2.5">B.2.5</a>.  <a class="xref" href="#name-top-hash-subtree-replicated">Top-Hash Subtree-Replicated Anonymization</a><a class="pilcrow" href="#section-toc.1-1.11.2.2.2.5.1">¶</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.11.2.2.2.6">
                    <p id="section-toc.1-1.11.2.2.2.6.1"><a class="xref" href="#section-b.2.6">B.2.6</a>.  <a class="xref" href="#name-ipcipher">ipcipher</a><a class="pilcrow" href="#section-toc.1-1.11.2.2.2.6.1">¶</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.11.2.2.2.7">
                    <p id="section-toc.1-1.11.2.2.2.7.1"><a class="xref" href="#section-b.2.7">B.2.7</a>.  <a class="xref" href="#name-bloom-filters">Bloom Filters</a><a class="pilcrow" href="#section-toc.1-1.11.2.2.2.7.1">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a class="xref" href="#section-appendix.c">Appendix C</a>.  <a class="xref" href="#name-current-policy-and-privacy-">Current Policy and Privacy Statements</a><a class="pilcrow" href="#section-toc.1-1.12.1">¶</a></p>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a class="xref" href="#section-appendix.d">Appendix D</a>.  <a class="xref" href="#name-example-rps">Example RPS</a><a class="pilcrow" href="#section-toc.1-1.13.1">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a class="xref" href="#section-d.1">D.1</a>.  <a class="xref" href="#name-policy-2">Policy</a><a class="pilcrow" href="#section-toc.1-1.13.2.1.1">¶</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a class="xref" href="#section-d.2">D.2</a>.  <a class="xref" href="#name-practice-2">Practice</a><a class="pilcrow" href="#section-toc.1-1.13.2.2.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a class="xref" href="#section-appendix.e"></a><a class="xref" href="#name-acknowledgements">Acknowledgements</a><a class="pilcrow" href="#section-toc.1-1.14.1">¶</a></p>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a class="xref" href="#section-appendix.f"></a><a class="xref" href="#name-contributors">Contributors</a><a class="pilcrow" href="#section-toc.1-1.15.1">¶</a></p>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a class="xref" href="#section-appendix.g"></a><a class="xref" href="#name-authors-addresses">Authors' Addresses</a><a class="pilcrow" href="#section-toc.1-1.16.1">¶</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a class="section-number selfRef" href="#section-1">1. </a><a class="section-name selfRef" href="#name-introduction">Introduction</a>
      </h2>
<p id="section-1-1">The Domain Name System (DNS) is at the core of the Internet; almost every
activity on the Internet starts with a DNS query (and often several). However,
the DNS was not originally designed with strong security or privacy
mechanisms.
A number of developments have taken place in recent years that aim to
increase
the privacy of the DNS, and these are now seeing some deployment. This
latest evolution of the DNS presents new challenges to operators, and this
document attempts to provide an overview of considerations for privacy-focused
DNS services.<a class="pilcrow" href="#section-1-1">¶</a></p>
<p id="section-1-2">In recent years, there has also been an increase in the availability of
"public
resolvers" <span>[<a class="xref" href="#RFC8499">RFC8499</a>]</span>, which users may prefer
to use instead of the default
network resolver, either because they offer a specific feature (e.g., good
reachability or encrypted transport) or because the network resolver lacks a
specific feature (e.g., strong privacy policy or unfiltered responses). These
public resolvers have tended to be at the forefront of adoption of
privacy-related
enhancements, but it is anticipated that operators of other resolver services
will follow.<a class="pilcrow" href="#section-1-2">¶</a></p>
<p id="section-1-3">Whilst protocols that encrypt DNS messages on the wire provide protection
against certain attacks, the resolver operator still has (in principle) full
visibility of the query data and transport identifiers for each
user. Therefore,
a trust relationship (whether explicit or implicit) is assumed to exist
between
each user and the operator of the resolver(s) used by that user. The ability
of
the operator to provide a transparent, well-documented, and secure privacy
service will likely serve as a major differentiating factor for
privacy-conscious users if they make an active selection of which resolver to
use.<a class="pilcrow" href="#section-1-3">¶</a></p>
<p id="section-1-4">It should also be noted that there are both advantages and
      disadvantages to a user choosing to configure a single resolver
(or a fixed set of resolvers) and an encrypted transport to use in all network
environments. For example, the user has a
clear expectation of which resolvers have visibility of their query data.
However, this resolver/transport selection may provide an added mechanism for
tracking them as they move across network environments. Commitments from
resolver
operators to minimize such tracking as users move between networks are also
likely to play a role in user selection of resolvers.<a class="pilcrow" href="#section-1-4">¶</a></p>
<p id="section-1-5">More recently, the global legislative landscape with regard to personal data
collection, retention, and pseudonymization has seen significant activity.
Providing detailed practice advice about these areas to the operator is out of
scope, but <a class="xref" href="#data-sharing">Section 5.3.3</a> describes some mitigations of data-sharing risk.<a class="pilcrow" href="#section-1-5">¶</a></p>
<p id="section-1-6">This document has two main goals:<a class="pilcrow" href="#section-1-6">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-7.1">To provide operational and policy guidance related to DNS over encrypted
transports and to outline recommendations for data handling for operators of
DNS privacy services.<a class="pilcrow" href="#section-1-7.1">¶</a>
</li>
        <li class="normal" id="section-1-7.2">To introduce the Recursive operator Privacy Statement (RPS) and present a
framework to assist writers of an RPS. An RPS is a
document that an operator should publish that outlines their operational
practices and commitments with regard to privacy, thereby providing a means
for clients to evaluate both the measurable and claimed privacy properties of
a given DNS privacy service. The framework identifies a set of elements and
specifies an outline order for them. This document does not, however, define a
particular privacy statement, nor does it seek to provide legal advice as to
the contents of an RPS.<a class="pilcrow" href="#section-1-7.2">¶</a>
</li>
      </ul>
<p id="section-1-8">A desired operational impact is that all operators (both those providing
resolvers within networks and those operating large public services) can
demonstrate their commitment to user privacy, thereby driving all DNS
resolution
services to a more equitable footing. Choices for users would (in this ideal
world) be driven by other factors -- e.g., differing security policies or minor
differences in operator policy -- rather than gross disparities in privacy
concerns.<a class="pilcrow" href="#section-1-8">¶</a></p>
<p id="section-1-9">Community insight (or judgment?) about operational practices can change
quickly, and experience shows that a Best Current Practice (BCP) document
about
privacy and security is a point-in-time statement. Readers are advised to seek
out any updates that apply to this document.<a class="pilcrow" href="#section-1-9">¶</a></p>
</section>
</div>
<div id="scope">
<section id="section-2">
      <h2 id="name-scope">
<a class="section-number selfRef" href="#section-2">2. </a><a class="section-name selfRef" href="#name-scope">Scope</a>
      </h2>
<p id="section-2-1">"DNS Privacy Considerations" <span>[<a class="xref" href="#RFC7626">RFC7626</a>]</span> describes
the general privacy issues
and threats associated with the use of the DNS by Internet users; much of
the threat analysis here is lifted from that document and <span>[<a class="xref" href="#RFC6973">RFC6973</a>]</span>. However,
this document is limited in scope to best-practice considerations for the
provision of DNS privacy services by servers (recursive resolvers) to clients
(stub resolvers or forwarders). Choices that are made exclusively by
the end user, or those for operators of authoritative nameservers, are out
of scope.<a class="pilcrow" href="#section-2-1">¶</a></p>
<p id="section-2-2">This document includes (but is not limited to) considerations in the
following
areas:<a class="pilcrow" href="#section-2-2">¶</a></p>
<ol class="normal type-1" id="section-2-3" start="1" type="1">
        <li id="section-2-3.1">Data "on the wire" between a client and a server.<a class="pilcrow" href="#section-2-3.1">¶</a>
</li>
        <li id="section-2-3.2">Data "at rest" on a server (e.g., in logs).<a class="pilcrow" href="#section-2-3.2">¶</a>
</li>
        <li id="section-2-3.3">Data "sent onwards" from the server (either on the wire or shared
with a
third party).<a class="pilcrow" href="#section-2-3.3">¶</a>
</li>
      </ol>
<p id="section-2-4">Whilst the issues raised here are targeted at those operators who choose to
offer a DNS privacy service, considerations for areas 2 and 3 could equally
apply to operators who only offer DNS over unencrypted transports but who
would
otherwise like to align with privacy best practice.<a class="pilcrow" href="#section-2-4">¶</a></p>
</section>
</div>
<div id="privacyrelated-documents">
<section id="section-3">
      <h2 id="name-privacy-related-documents">
<a class="section-number selfRef" href="#section-3">3. </a><a class="section-name selfRef" href="#name-privacy-related-documents">Privacy-Related Documents</a>
      </h2>
<p id="section-3-1">There are various documents that describe protocol changes that have the
potential to either increase or decrease the privacy properties of the DNS in
various ways. Note that this does not imply that some documents are good or bad,
better or worse, just that (for example) some features may bring functional
benefits at the price of a reduction in privacy, and conversely some features
increase privacy with an accompanying increase in complexity. A selection of
the
most relevant documents is listed in <a class="xref" href="#documents">Appendix A</a> for
reference.<a class="pilcrow" href="#section-3-1">¶</a></p>
</section>
</div>
<div id="terminology">
<section id="section-4">
      <h2 id="name-terminology">
<a class="section-number selfRef" href="#section-4">4. </a><a class="section-name selfRef" href="#name-terminology">Terminology</a>
      </h2>
<p id="section-4-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>",
"<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>",
"<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this
document are to be interpreted as described in BCP 14 <span>[<a class="xref" href="#RFC2119">RFC2119</a>]</span>
        <span>[<a class="xref" href="#RFC8174">RFC8174</a>]</span>
when, and only when, they appear in all capitals, as shown here.<a class="pilcrow" href="#section-4-1">¶</a></p>
<p id="section-4-2">
DNS terminology is as described in <span>[<a class="xref" href="#RFC8499">RFC8499</a>]</span>, except with
regard to the definition of privacy-enabling DNS server in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8499#section-6">Section 6</a> of [<a class="xref" href="#RFC8499">RFC8499</a>]</span>. In this document we use
the full definition of a DNS over (D)TLS privacy-enabling DNS server as given
in <span>[<a class="xref" href="#RFC8310">RFC8310</a>]</span>, i.e., that such a server should also offer at
least one of the credentials described in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8310#section-8">Section 8</a> of [<a class="xref" href="#RFC8310">RFC8310</a>]</span> and implement the (D)TLS profile described in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8310#section-9">Section 9</a> of [<a class="xref" href="#RFC8310">RFC8310</a>]</span>.<a class="pilcrow" href="#section-4-2">¶</a></p>
<p id="section-4-3">Other Terms:<a class="pilcrow" href="#section-4-3">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4-4">
        <dt id="section-4-4.1">RPS:</dt>
        <dd id="section-4-4.2" style="margin-left: 1.5em">Recursive operator Privacy Statement; see
 <a class="xref" href="#recursive-operator-privacy-statement-rps">Section 6</a>.<a class="pilcrow" href="#section-4-4.2">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-4-4.3">DNS privacy service:</dt>
        <dd id="section-4-4.4" style="margin-left: 1.5em">The service that is offered via a
 privacy-enabling DNS
 server and is documented either in an informal statement of policy and
 practice with regard to users privacy or a formal RPS.<a class="pilcrow" href="#section-4-4.4">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
</section>
</div>
<div id="recommendations-for-dns-privacy-services">
<section id="section-5">
      <h2 id="name-recommendations-for-dns-pri">
<a class="section-number selfRef" href="#section-5">5. </a><a class="section-name selfRef" href="#name-recommendations-for-dns-pri">Recommendations for DNS Privacy Services</a>
      </h2>
<p id="section-5-1">In the following sections, we first outline the threats relevant to the
specific topic and then discuss the potential actions that can be taken to
mitigate them.<a class="pilcrow" href="#section-5-1">¶</a></p>
<p id="section-5-2">We describe two classes of threats:<a class="pilcrow" href="#section-5-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-3.1">
          <p id="section-5-3.1.1">Threats described in <span>[<a class="xref" href="#RFC6973">RFC6973</a>]</span>,
   "Privacy Considerations for Internet Protocols"<a class="pilcrow" href="#section-5-3.1.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-3.1.2.1">Privacy terminology, threats to privacy, and mitigations as
     described in Sections <a class="relref" href="https://www.rfc-editor.org/rfc/rfc6973#section-3">3</a>, <a class="relref" href="https://www.rfc-editor.org/rfc/rfc6973#section-5">5</a>, and <a class="relref" href="https://www.rfc-editor.org/rfc/rfc6973#section-6">6</a> of <span>[<a class="xref" href="#RFC6973">RFC6973</a>]</span>.<a class="pilcrow" href="#section-5-3.1.2.1">¶</a>
</li>
          </ul>
</li>
        <li class="normal" id="section-5-3.2">
          <p id="section-5-3.2.1">DNS Privacy Threats<a class="pilcrow" href="#section-5-3.2.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-3.2.2.1">These are threats to the users and operators of DNS privacy
     services that
     are not directly covered by <span>[<a class="xref" href="#RFC6973">RFC6973</a>]</span>. These may be more
     operational in
     nature, such as certificate-management or service-availability issues.<a class="pilcrow" href="#section-5-3.2.2.1">¶</a>
</li>
          </ul>
</li>
      </ul>
<p id="section-5-4">We describe three classes of actions that operators of DNS privacy
services can take:<a class="pilcrow" href="#section-5-4">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-5.1">Threat mitigation for well-understood and documented privacy threats to the
users of the service and, in some cases, the operators of the service.<a class="pilcrow" href="#section-5-5.1">¶</a>
</li>
        <li class="normal" id="section-5-5.2">Optimization of privacy services from an operational or management
perspective.<a class="pilcrow" href="#section-5-5.2">¶</a>
</li>
        <li class="normal" id="section-5-5.3">Additional options that could further enhance the privacy and usability of
the
service.<a class="pilcrow" href="#section-5-5.3">¶</a>
</li>
      </ul>
<p id="section-5-6">This document does not specify policy, only best practice. However, for DNS
privacy services to be considered compliant with these best-practice
guidelines,
they <span class="bcp14">SHOULD</span> implement (where appropriate) all:<a class="pilcrow" href="#section-5-6">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-7.1">Threat mitigations to be minimally compliant.<a class="pilcrow" href="#section-5-7.1">¶</a>
</li>
        <li class="normal" id="section-5-7.2">Optimizations to be moderately compliant.<a class="pilcrow" href="#section-5-7.2">¶</a>
</li>
        <li class="normal" id="section-5-7.3">Additional options to be maximally compliant.<a class="pilcrow" href="#section-5-7.3">¶</a>
</li>
      </ul>
<p id="section-5-8">The rest of this document does not use normative language but instead
refers
only to the three differing classes of action that correspond to the three
named levels of compliance stated above. However, compliance (to the indicated
level) remains a normative requirement.<a class="pilcrow" href="#section-5-8">¶</a></p>
<div id="on-the-wire-between-client-and-server">
<section id="section-5.1">
        <h3 id="name-on-the-wire-between-client-">
<a class="section-number selfRef" href="#section-5.1">5.1. </a><a class="section-name selfRef" href="#name-on-the-wire-between-client-">On the Wire between Client and Server</a>
        </h3>
<p id="section-5.1-1">In this section, we consider both data on the wire and the service provided
 to the client.<a class="pilcrow" href="#section-5.1-1">¶</a></p>
<div id="transport-recommendations">
<section id="section-5.1.1">
          <h4 id="name-transport-recommendations">
<a class="section-number selfRef" href="#section-5.1.1">5.1.1. </a><a class="section-name selfRef" href="#name-transport-recommendations">Transport Recommendations</a>
          </h4>
<span class="break"></span><dl class="dlNewline" id="section-5.1.1-1">
            <dt id="section-5.1.1-1.1">Threats described in <span>[<a class="xref" href="#RFC6973">RFC6973</a>]</span>:</dt>
            <dd id="section-5.1.1-1.2" style="margin-left: 1.5em">
              <span class="break"></span><dl class="dlNewline" id="section-5.1.1-1.2.1">
                <dt id="section-5.1.1-1.2.1.1">Surveillance:</dt>
                <dd id="section-5.1.1-1.2.1.2" style="margin-left: 1.5em">Passive surveillance of traffic on the wire.<a class="pilcrow" href="#section-5.1.1-1.2.1.2">¶</a>
</dd>
              <dd class="break"></dd>
</dl>
</dd>
            <dd class="break"></dd>
<dt id="section-5.1.1-1.3">DNS Privacy Threats:</dt>
            <dd id="section-5.1.1-1.4" style="margin-left: 1.5em">Active injection of spurious data or traffic.<a class="pilcrow" href="#section-5.1.1-1.4">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.1.1-1.5">Mitigations:</dt>
            <dd id="section-5.1.1-1.6" style="margin-left: 1.5em">
              <p id="section-5.1.1-1.6.1">A DNS privacy service can mitigate these threats by providing
   service over one
   or more of the following transports:<a class="pilcrow" href="#section-5.1.1-1.6.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1.1-1.6.2.1">DNS over TLS (DoT) <span>[<a class="xref" href="#RFC7858">RFC7858</a>]</span>
                  <span>[<a class="xref" href="#RFC8310">RFC8310</a>]</span>.<a class="pilcrow" href="#section-5.1.1-1.6.2.1">¶</a>
</li>
                <li class="normal" id="section-5.1.1-1.6.2.2">DNS over HTTPS (DoH) <span>[<a class="xref" href="#RFC8484">RFC8484</a>]</span>.<a class="pilcrow" href="#section-5.1.1-1.6.2.2">¶</a>
</li>
              </ul>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-5.1.1-2">It is noted that a DNS privacy service can also be provided over DNS over
DTLS
<span>[<a class="xref" href="#RFC8094">RFC8094</a>]</span>; however, this is an Experimental
specification, and
there are no known
implementations at the time of writing.<a class="pilcrow" href="#section-5.1.1-2">¶</a></p>
<p id="section-5.1.1-3">It is also noted that DNS privacy service might be
          provided over DNSCrypt <span>[<a class="xref" href="#DNSCrypt">DNSCrypt</a>]</span>, IPsec, or VPNs. However, there are
          no specific RFCs that cover the use of these transports for
          DNS, and any discussion of best practice for providing such a
          service is out of scope for this document.<a class="pilcrow" href="#section-5.1.1-3">¶</a></p>
<p id="section-5.1.1-4">Whilst encryption of DNS traffic can protect against active
   injection on the paths traversed by the encrypted connection, this
   does not diminish the need
   for DNSSEC; see <a class="xref" href="#dnssec">Section 5.1.4</a>.<a class="pilcrow" href="#section-5.1.1-4">¶</a></p>
</section>
</div>
<div id="authentication-of-dns-privacy-services">
<section id="section-5.1.2">
          <h4 id="name-authentication-of-dns-priva">
<a class="section-number selfRef" href="#section-5.1.2">5.1.2. </a><a class="section-name selfRef" href="#name-authentication-of-dns-priva">Authentication of DNS Privacy Services</a>
          </h4>
<span class="break"></span><dl class="dlNewline" id="section-5.1.2-1">
            <dt id="section-5.1.2-1.1">Threats described in <span>[<a class="xref" href="#RFC6973">RFC6973</a>]</span>:</dt>
            <dd id="section-5.1.2-1.2" style="margin-left: 1.5em">
              <span class="break"></span><dl class="dlNewline" id="section-5.1.2-1.2.1">
                <dt id="section-5.1.2-1.2.1.1">Surveillance:</dt>
                <dd id="section-5.1.2-1.2.1.2" style="margin-left: 1.5em">Active attacks on client resolver configuration.<a class="pilcrow" href="#section-5.1.2-1.2.1.2">¶</a>
</dd>
              <dd class="break"></dd>
</dl>
</dd>
            <dd class="break"></dd>
<dt id="section-5.1.2-1.3">Mitigations:</dt>
            <dd id="section-5.1.2-1.4" style="margin-left: 1.5em">
              <p id="section-5.1.2-1.4.1">DNS privacy services should ensure clients can authenticate the
     server. Note that this, in effect, commits the DNS privacy service
     to a public identity users will trust.<a class="pilcrow" href="#section-5.1.2-1.4.1">¶</a></p>
<p id="section-5.1.2-1.4.2">When using DoT, clients that select a "Strict Privacy" usage
            profile <span>[<a class="xref" href="#RFC8310">RFC8310</a>]</span> (to mitigate the
            threat of active attack on the client) require the ability to
            authenticate the DNS server. To enable this, DNS privacy services
            that offer DoT need to provide credentials that will be
            accepted by the client's trust model, in the form of either X.509
            certificates <span>[<a class="xref" href="#RFC5280">RFC5280</a>]</span> or Subject
            Public Key Info (SPKI) pin sets <span>[<a class="xref" href="#RFC8310">RFC8310</a>]</span>.<a class="pilcrow" href="#section-5.1.2-1.4.2">¶</a></p>
<p id="section-5.1.2-1.4.3">When offering DoH <span>[<a class="xref" href="#RFC8484">RFC8484</a>]</span>,
     HTTPS requires authentication of the server as part of the protocol.<a class="pilcrow" href="#section-5.1.2-1.4.3">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<div id="certificate-management">
<section id="section-5.1.2.1">
            <h5 id="name-certificate-management">
<a class="section-number selfRef" href="#section-5.1.2.1">5.1.2.1. </a><a class="section-name selfRef" href="#name-certificate-management">Certificate Management</a>
            </h5>
<p id="section-5.1.2.1-1">Anecdotal evidence to date highlights the management of certificates as one
of
the more challenging aspects for operators of traditional DNS resolvers that
choose to additionally provide a DNS privacy service, as management of such
credentials is new to those DNS operators.<a class="pilcrow" href="#section-5.1.2.1-1">¶</a></p>
<p id="section-5.1.2.1-2">It is noted that SPKI pin set management is described in <span>[<a class="xref" href="#RFC7858">RFC7858</a>]</span> but that key-pinning mechanisms in general have fallen out of favor operationally for
various reasons, such as the logistical overhead of rolling keys.<a class="pilcrow" href="#section-5.1.2.1-2">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-5.1.2.1-3">
              <dt id="section-5.1.2.1-3.1">DNS Privacy Threats:</dt>
              <dd id="section-5.1.2.1-3.2" style="margin-left: 1.5em">
                <ul class="normal">
<li class="normal" id="section-5.1.2.1-3.2.1.1">Invalid certificates, resulting in an unavailable service, which might force a
       user to fall back to cleartext.<a class="pilcrow" href="#section-5.1.2.1-3.2.1.1">¶</a>
</li>
                  <li class="normal" id="section-5.1.2.1-3.2.1.2">Misidentification of a server by a client -- e.g., typos in DoH URL templates
       <span>[<a class="xref" href="#RFC8484">RFC8484</a>]</span> or authentication domain names <span>[<a class="xref" href="#RFC8310">RFC8310</a>]</span> that accidentally direct
       clients to attacker-controlled servers.<a class="pilcrow" href="#section-5.1.2.1-3.2.1.2">¶</a>
</li>
                </ul>
</dd>
              <dd class="break"></dd>
<dt id="section-5.1.2.1-3.3">Mitigations:</dt>
              <dd id="section-5.1.2.1-3.4" style="margin-left: 1.5em">
                <p id="section-5.1.2.1-3.4.1">It is recommended that operators:<a class="pilcrow" href="#section-5.1.2.1-3.4.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1.2.1-3.4.2.1">Follow the guidance in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc7525#section-6.5">Section 6.5</a> of [<a class="xref" href="#RFC7525">RFC7525</a>]</span> with regard to certificate revocation.<a class="pilcrow" href="#section-5.1.2.1-3.4.2.1">¶</a>
</li>
                  <li class="normal" id="section-5.1.2.1-3.4.2.2">Automate the generation, publication, and renewal of certificates. For
       example, Automatic Certificate Management Environment (ACME)
       <span>[<a class="xref" href="#RFC8555">RFC8555</a>]</span> provides a
       mechanism to actively manage certificates through
       automation and has been implemented by a number of certificate
       authorities.<a class="pilcrow" href="#section-5.1.2.1-3.4.2.2">¶</a>
</li>
                  <li class="normal" id="section-5.1.2.1-3.4.2.3">Monitor certificates to prevent accidental expiration of certificates.<a class="pilcrow" href="#section-5.1.2.1-3.4.2.3">¶</a>
</li>
                  <li class="normal" id="section-5.1.2.1-3.4.2.4">Choose a short, memorable authentication domain name for the service.<a class="pilcrow" href="#section-5.1.2.1-3.4.2.4">¶</a>
</li>
                </ul>
</dd>
            <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="protocol-recommendations">
<section id="section-5.1.3">
          <h4 id="name-protocol-recommendations">
<a class="section-number selfRef" href="#section-5.1.3">5.1.3. </a><a class="section-name selfRef" href="#name-protocol-recommendations">Protocol Recommendations</a>
          </h4>
<div id="dot">
<section id="section-5.1.3.1">
            <h5 id="name-dot">
<a class="section-number selfRef" href="#section-5.1.3.1">5.1.3.1. </a><a class="section-name selfRef" href="#name-dot">DoT</a>
            </h5>
<span class="break"></span><dl class="dlNewline" id="section-5.1.3.1-1">
              <dt id="section-5.1.3.1-1.1">DNS Privacy Threats:</dt>
              <dd id="section-5.1.3.1-1.2" style="margin-left: 1.5em">
                <ul class="normal">
<li class="normal" id="section-5.1.3.1-1.2.1.1">Known attacks on TLS, such as those described in <span>[<a class="xref" href="#RFC7457">RFC7457</a>]</span>.<a class="pilcrow" href="#section-5.1.3.1-1.2.1.1">¶</a>
</li>
                  <li class="normal" id="section-5.1.3.1-1.2.1.2">Traffic analysis, for example: <span>[<a class="xref" href="#Pitfalls-of-DNS-Encryption">Pitfalls-of-DNS-Encryption</a>]</span> (focused
       on DoT).<a class="pilcrow" href="#section-5.1.3.1-1.2.1.2">¶</a>
</li>
                  <li class="normal" id="section-5.1.3.1-1.2.1.3">Potential for client tracking via transport identifiers.<a class="pilcrow" href="#section-5.1.3.1-1.2.1.3">¶</a>
</li>
                  <li class="normal" id="section-5.1.3.1-1.2.1.4">Blocking of well-known ports (e.g., 853 for DoT).<a class="pilcrow" href="#section-5.1.3.1-1.2.1.4">¶</a>
</li>
                </ul>
</dd>
              <dd class="break"></dd>
<dt id="section-5.1.3.1-1.3">Mitigations:</dt>
              <dd id="section-5.1.3.1-1.4" style="margin-left: 1.5em">
                <p id="section-5.1.3.1-1.4.1">In the case of DoT, TLS profiles from <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8310#section-9">Section 9</a> of [<a class="xref" href="#RFC8310">RFC8310</a>]</span> and the
           "Countermeasures to DNS Traffic Analysis" from <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8310#section-11.1">Section 11.1</a> of [<a class="xref" href="#RFC8310">RFC8310</a>]</span>
           provide strong mitigations. This includes but is not
           limited to:<a class="pilcrow" href="#section-5.1.3.1-1.4.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1.3.1-1.4.2.1">Adhering to <span>[<a class="xref" href="#RFC7525">RFC7525</a>]</span>.<a class="pilcrow" href="#section-5.1.3.1-1.4.2.1">¶</a>
</li>
                  <li class="normal" id="section-5.1.3.1-1.4.2.2">Implementing only (D)TLS 1.2 or later, as specified in <span>[<a class="xref" href="#RFC8310">RFC8310</a>]</span>.<a class="pilcrow" href="#section-5.1.3.1-1.4.2.2">¶</a>
</li>
                  <li class="normal" id="section-5.1.3.1-1.4.2.3">Implementing Extension Mechanisms for DNS (EDNS(0)) Padding
       <span>[<a class="xref" href="#RFC7830">RFC7830</a>]</span> using the guidelines
in
<span>[<a class="xref" href="#RFC8467">RFC8467</a>]</span> or a successor specification.<a class="pilcrow" href="#section-5.1.3.1-1.4.2.3">¶</a>
</li>
                  <li class="normal" id="section-5.1.3.1-1.4.2.4">Servers should not degrade in any way the query service
       level provided to
       clients that do not use any form of session resumption
       mechanism, such as TLS
       session resumption <span>[<a class="xref" href="#RFC5077">RFC5077</a>]</span> with TLS 1.2
       (<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8446#section-2.2">Section 2.2</a> of [<a class="xref" href="#RFC8446">RFC8446</a>]</span>) or Domain
       Name System (DNS) Cookies <span>[<a class="xref" href="#RFC7873">RFC7873</a>]</span>.<a class="pilcrow" href="#section-5.1.3.1-1.4.2.4">¶</a>
</li>
                  <li class="normal" id="section-5.1.3.1-1.4.2.5">A DoT privacy service on both port 853 and 443. If the
       operator deploys DoH
       on the same IP address, this requires the use of the "dot" 
       Application-Layer Protocol Negotiation (ALPN) value <span>[<a class="xref" href="#dot-ALPN">dot-ALPN</a>]</span>.<a class="pilcrow" href="#section-5.1.3.1-1.4.2.5">¶</a>
</li>
                </ul>
</dd>
              <dd class="break"></dd>
<dt id="section-5.1.3.1-1.5">Optimizations:</dt>
              <dd id="section-5.1.3.1-1.6" style="margin-left: 1.5em">
                <ul class="normal">
<li class="normal" id="section-5.1.3.1-1.6.1.1">Concurrent processing of pipelined queries, returning
       responses as soon as
       available, potentially out of order, as specified in <span>[<a class="xref" href="#RFC7766">RFC7766</a>]</span>. This is often
       called "OOOR" -- out-of-order responses (providing processing performance
       similar to HTTP multiplexing).<a class="pilcrow" href="#section-5.1.3.1-1.6.1.1">¶</a>
</li>
                  <li class="normal" id="section-5.1.3.1-1.6.1.2">Management of TLS connections to optimize performance for clients using
       <span>[<a class="xref" href="#RFC7766">RFC7766</a>]</span> and EDNS(0) Keepalive
       <span>[<a class="xref" href="#RFC7828">RFC7828</a>]</span><a class="pilcrow" href="#section-5.1.3.1-1.6.1.2">¶</a>
</li>
                </ul>
</dd>
              <dd class="break"></dd>
<dt id="section-5.1.3.1-1.7">Additional Options:</dt>
              <dd id="section-5.1.3.1-1.8" style="margin-left: 1.5em">Management of TLS connections to optimize performance for clients using DNS
Stateful Operations <span>[<a class="xref" href="#RFC8490">RFC8490</a>]</span>.<a class="pilcrow" href="#section-5.1.3.1-1.8">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</section>
</div>
<div id="doh">
<section id="section-5.1.3.2">
            <h5 id="name-doh">
<a class="section-number selfRef" href="#section-5.1.3.2">5.1.3.2. </a><a class="section-name selfRef" href="#name-doh">DoH</a>
            </h5>
<span class="break"></span><dl class="dlNewline" id="section-5.1.3.2-1">
              <dt id="section-5.1.3.2-1.1">DNS Privacy Threats:</dt>
              <dd id="section-5.1.3.2-1.2" style="margin-left: 1.5em">
                <ul class="normal">
<li class="normal" id="section-5.1.3.2-1.2.1.1">Known attacks on TLS, such as those described in <span>[<a class="xref" href="#RFC7457">RFC7457</a>]</span>.<a class="pilcrow" href="#section-5.1.3.2-1.2.1.1">¶</a>
</li>
                  <li class="normal" id="section-5.1.3.2-1.2.1.2">Traffic analysis, for example: <span>[<a class="xref" href="#DNS-Privacy-not-so-private">DNS-Privacy-not-so-private</a>]</span> (focused
       on DoH).<a class="pilcrow" href="#section-5.1.3.2-1.2.1.2">¶</a>
</li>
                  <li class="normal" id="section-5.1.3.2-1.2.1.3">Potential for client tracking via transport identifiers.<a class="pilcrow" href="#section-5.1.3.2-1.2.1.3">¶</a>
</li>
                </ul>
</dd>
              <dd class="break"></dd>
<dt id="section-5.1.3.2-1.3">Mitigations:</dt>
              <dd id="section-5.1.3.2-1.4" style="margin-left: 1.5em">
                <ul class="normal">
<li class="normal" id="section-5.1.3.2-1.4.1.1">Clients must be able to forgo the use of HTTP cookies <span>[<a class="xref" href="#RFC6265">RFC6265</a>]</span> and still
use the service.<a class="pilcrow" href="#section-5.1.3.2-1.4.1.1">¶</a>
</li>
                  <li class="normal" id="section-5.1.3.2-1.4.1.2">Use of HTTP/2 padding and/or EDNS(0) padding, as described in
<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8484#section-9">Section 9</a> of [<a class="xref" href="#RFC8484">RFC8484</a>]</span>.<a class="pilcrow" href="#section-5.1.3.2-1.4.1.2">¶</a>
</li>
                  <li class="normal" id="section-5.1.3.2-1.4.1.3">Clients should not be required to include any headers beyond the absolute
minimum to obtain service from a DoH server. (See
<span><a class="relref" href="https://tools.ietf.org/html/draft-ietf-httpbis-bcp56bis-09#section-6.1">Section 6.1</a> of [<a class="xref" href="#I-D.ietf-httpbis-bcp56bis">BUILD-W-HTTP</a>]</span>.)<a class="pilcrow" href="#section-5.1.3.2-1.4.1.3">¶</a>
</li>
                </ul>
</dd>
            <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="dnssec">
<section id="section-5.1.4">
          <h4 id="name-dnssec">
<a class="section-number selfRef" href="#section-5.1.4">5.1.4. </a><a class="section-name selfRef" href="#name-dnssec">DNSSEC</a>
          </h4>
<span class="break"></span><dl class="dlNewline" id="section-5.1.4-1">
            <dt id="section-5.1.4-1.1">DNS Privacy Threats:</dt>
            <dd id="section-5.1.4-1.2" style="margin-left: 1.5em">Users may be directed to bogus IP addresses that, depending on the
     application, protocol, and authentication method, might lead users to reveal
     personal information to attackers. One example is a website that doesn't use
     TLS or whose TLS authentication can somehow be subverted.<a class="pilcrow" href="#section-5.1.4-1.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.1.4-1.3">Mitigations:</dt>
            <dd id="section-5.1.4-1.4" style="margin-left: 1.5em">All DNS privacy services must offer a DNS privacy service that performs

   Domain Name System Security Extensions (DNSSEC) validation. In
   addition, they must be
   able to provide the DNSSEC Resource Records (RRs) to the client so that it can perform its own
   validation.<a class="pilcrow" href="#section-5.1.4-1.4">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-5.1.4-2">The addition of encryption to DNS does not remove the need for DNSSEC
<span>[<a class="xref" href="#RFC4033">RFC4033</a>]</span>; they are independent and fully compatible
protocols,
each solving different problems. The use of one does not diminish the need nor
the usefulness of the other.<a class="pilcrow" href="#section-5.1.4-2">¶</a></p>
<p id="section-5.1.4-3">While the use of an authenticated and encrypted transport protects origin
   authentication and data integrity between a client and a DNS privacy service,
   it provides no proof (for a nonvalidating client) that the data provided by the
   DNS privacy service was actually DNSSEC authenticated. As with cleartext DNS,
   the user is still solely trusting the Authentic Data (AD) bit (if
   present) set by the resolver.<a class="pilcrow" href="#section-5.1.4-3">¶</a></p>
<p id="section-5.1.4-4">It should also be noted that the use of an encrypted transport for DNS
   actually solves many of the practical issues encountered by DNS validating clients -- e.g.,
   interference by middleboxes with cleartext DNS payloads is completely avoided.
   In this sense, a validating client that uses a DNS privacy service that
   supports DNSSEC has a far simpler task in terms of DNSSEC roadblock avoidance
   <span>[<a class="xref" href="#RFC8027">RFC8027</a>]</span>.<a class="pilcrow" href="#section-5.1.4-4">¶</a></p>
</section>
</div>
<div id="availability">
<section id="section-5.1.5">
          <h4 id="name-availability">
<a class="section-number selfRef" href="#section-5.1.5">5.1.5. </a><a class="section-name selfRef" href="#name-availability">Availability</a>
          </h4>
<span class="break"></span><dl class="dlNewline" id="section-5.1.5-1">
            <dt id="section-5.1.5-1.1">DNS Privacy Threats:</dt>
            <dd id="section-5.1.5-1.2" style="margin-left: 1.5em">
       A failing DNS privacy service could force the user to switch
       providers, fall back to cleartext, or accept no DNS service for
       the duration of the outage.<a class="pilcrow" href="#section-5.1.5-1.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.1.5-1.3">Mitigations:</dt>
            <dd id="section-5.1.5-1.4" style="margin-left: 1.5em">
              <p id="section-5.1.5-1.4.1">A DNS privacy service should strive to engineer encrypted services to the
   same
   availability level as any unencrypted services they provide. Particular care
   should to be taken to protect DNS privacy services against denial-of-service
   (DoS) attacks, as experience has shown that unavailability of DNS resolving because
   of attacks is a significant motivation for users to switch services. See, for
   example, Section IV-C of <span>[<a class="xref" href="#Passive-Observations-of-a-Large-DNS">Passive-Observations-of-a-Large-DNS</a>]</span>.<a class="pilcrow" href="#section-5.1.5-1.4.1">¶</a></p>
<p id="section-5.1.5-1.4.2">Techniques such as those described in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc7766#section-10">Section 10</a> of [<a class="xref" href="#RFC7766">RFC7766</a>]</span> can be of use to operators to defend against such attacks.<a class="pilcrow" href="#section-5.1.5-1.4.2">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="service-options">
<section id="section-5.1.6">
          <h4 id="name-service-options">
<a class="section-number selfRef" href="#section-5.1.6">5.1.6. </a><a class="section-name selfRef" href="#name-service-options">Service Options</a>
          </h4>
<span class="break"></span><dl class="dlNewline" id="section-5.1.6-1">
            <dt id="section-5.1.6-1.1">DNS Privacy Threats:</dt>
            <dd id="section-5.1.6-1.2" style="margin-left: 1.5em">Unfairly disadvantaging users of the privacy service with respect to the
   services available. This could force the user to switch providers,
   fall back to
   cleartext, or accept no DNS service for the duration of the outage.<a class="pilcrow" href="#section-5.1.6-1.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.1.6-1.3">Mitigations:</dt>
            <dd id="section-5.1.6-1.4" style="margin-left: 1.5em">A DNS privacy service should deliver the same level of service as offered
   on unencrypted channels in terms of options such as filtering (or lack thereof),
   DNSSEC validation, etc.<a class="pilcrow" href="#section-5.1.6-1.4">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="impact-of-encryption-on-monitoring-by-dns-privacy-service-operators">
<section id="section-5.1.7">
          <h4 id="name-impact-of-encryption-on-mon">
<a class="section-number selfRef" href="#section-5.1.7">5.1.7. </a><a class="section-name selfRef" href="#name-impact-of-encryption-on-mon">Impact of Encryption on Monitoring by DNS Privacy Service Operators</a>
          </h4>
<span class="break"></span><dl class="dlNewline" id="section-5.1.7-1">
            <dt id="section-5.1.7-1.1">DNS Privacy Threats:</dt>
            <dd id="section-5.1.7-1.2" style="margin-left: 1.5em">Increased use of encryption can impact a DNS privacy service operator's ability
   to monitor traffic and therefore manage their DNS servers <span>[<a class="xref" href="#RFC8404">RFC8404</a>]</span>.<a class="pilcrow" href="#section-5.1.7-1.2">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-5.1.7-2">Many monitoring solutions for DNS traffic rely on the plaintext nature of
   this
   traffic and work by intercepting traffic on the wire, either using a separate
   view on the connection between clients and the resolver, or as a separate
   process on the resolver system that inspects network traffic. Such solutions
   will no longer function when traffic between clients and resolvers is
   encrypted.
   Many DNS privacy service operators still need to inspect DNS traffic --
   e.g., to monitor for network security threats. Operators may therefore need to
   invest in an alternative means of monitoring that relies on either the resolver software
   directly, or exporting DNS traffic from the resolver using, for
   example, <span>[<a class="xref" href="#dnstap">dnstap</a>]</span>.<a class="pilcrow" href="#section-5.1.7-2">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-5.1.7-3">
            <dt id="section-5.1.7-3.1">Optimization:</dt>
            <dd id="section-5.1.7-3.2" style="margin-left: 1.5em">When implementing alternative means for traffic monitoring, operators of a
DNS
privacy service should consider using privacy-conscious means to do so. See
<a class="xref" href="#data-at-rest-on-the-server">Section 5.2</a> for more details on data
handling and the discussion on the use of Bloom Filters in <a class="xref" href="#ip-address-techniques">Appendix B</a>.<a class="pilcrow" href="#section-5.1.7-3.2">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="limitations-of-fronting-a-dns-privacy-service-with-a-pure-tls-proxy">
<section id="section-5.1.8">
          <h4 id="name-limitations-of-fronting-a-d">
<a class="section-number selfRef" href="#section-5.1.8">5.1.8. </a><a class="section-name selfRef" href="#name-limitations-of-fronting-a-d">Limitations of Fronting a DNS Privacy Service with a Pure TLS Proxy</a>
          </h4>
<span class="break"></span><dl class="dlNewline" id="section-5.1.8-1">
            <dt id="section-5.1.8-1.1">DNS Privacy Threats:</dt>
            <dd id="section-5.1.8-1.2" style="margin-left: 1.5em">
              <ul class="normal">
<li class="normal" id="section-5.1.8-1.2.1.1">Limited ability to manage or monitor incoming connections using DNS-specific
     techniques.<a class="pilcrow" href="#section-5.1.8-1.2.1.1">¶</a>
</li>
                <li class="normal" id="section-5.1.8-1.2.1.2">Misconfiguration (e.g., of the target-server address in the
     proxy configuration) could lead to data leakage if the
     proxy-to-target-server path
     is not encrypted.<a class="pilcrow" href="#section-5.1.8-1.2.1.2">¶</a>
</li>
              </ul>
</dd>
            <dd class="break"></dd>
<dt id="section-5.1.8-1.3">Optimization:</dt>
            <dd id="section-5.1.8-1.4" style="margin-left: 1.5em">
              <p id="section-5.1.8-1.4.1">Some operators may choose to implement DoT using a TLS proxy (e.g.,
<span>[<a class="xref" href="#nginx">nginx</a>]</span>, <span>[<a class="xref" href="#haproxy">haproxy</a>]</span>, or
<span>[<a class="xref" href="#stunnel">stunnel</a>]</span>) in front of
a DNS nameserver because of proven robustness and capacity when handling large
numbers of client connections, load-balancing capabilities, and good tooling.
Currently, however, because such proxies typically have no specific handling
of DNS as a protocol over TLS or DTLS, using them can restrict traffic management
at the proxy layer and the DNS server. For example, all traffic received by a
nameserver behind such a proxy will appear to originate from the proxy, and DNS
techniques such as Access Control Lists (ACLs), Response Rate Limiting (RRL),
or DNS64 <span>[<a class="xref" href="#RFC6147">RFC6147</a>]</span> will be hard or impossible to implement
in
the nameserver.<a class="pilcrow" href="#section-5.1.8-1.4.1">¶</a></p>
<p id="section-5.1.8-1.4.2">Operators may choose to use a DNS-aware proxy, such as
<span>[<a class="xref" href="#dnsdist">dnsdist</a>]</span>, that offers custom options (similar to those
proposed in <span>[<a class="xref" href="#I-D.bellis-dnsop-xpf">DNS-XPF</a>]</span>) to add source information
to packets
to address this shortcoming. It should be noted that such options potentially
significantly increase the leaked information in the event of a
misconfiguration.<a class="pilcrow" href="#section-5.1.8-1.4.2">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="data-at-rest-on-the-server">
<section id="section-5.2">
        <h3 id="name-data-at-rest-on-the-server">
<a class="section-number selfRef" href="#section-5.2">5.2. </a><a class="section-name selfRef" href="#name-data-at-rest-on-the-server">Data at Rest on the Server</a>
        </h3>
<div id="data-handling">
<section id="section-5.2.1">
          <h4 id="name-data-handling">
<a class="section-number selfRef" href="#section-5.2.1">5.2.1. </a><a class="section-name selfRef" href="#name-data-handling">Data Handling</a>
          </h4>
<span class="break"></span><dl class="dlNewline" id="section-5.2.1-1">
            <dt id="section-5.2.1-1.1">Threats described in <span>[<a class="xref" href="#RFC6973">RFC6973</a>]</span>:</dt>
            <dd id="section-5.2.1-1.2" style="margin-left: 1.5em">
              <ul class="normal">
<li class="normal" id="section-5.2.1-1.2.1.1">Surveillance.<a class="pilcrow" href="#section-5.2.1-1.2.1.1">¶</a>
</li>
                <li class="normal" id="section-5.2.1-1.2.1.2">Stored-data compromise.<a class="pilcrow" href="#section-5.2.1-1.2.1.2">¶</a>
</li>
                <li class="normal" id="section-5.2.1-1.2.1.3">Correlation.<a class="pilcrow" href="#section-5.2.1-1.2.1.3">¶</a>
</li>
                <li class="normal" id="section-5.2.1-1.2.1.4">Identification.<a class="pilcrow" href="#section-5.2.1-1.2.1.4">¶</a>
</li>
                <li class="normal" id="section-5.2.1-1.2.1.5">Secondary use.<a class="pilcrow" href="#section-5.2.1-1.2.1.5">¶</a>
</li>
                <li class="normal" id="section-5.2.1-1.2.1.6">Disclosure.<a class="pilcrow" href="#section-5.2.1-1.2.1.6">¶</a>
</li>
              </ul>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.1-1.3">Other Threats</dt>
            <dd id="section-5.2.1-1.4" style="margin-left: 1.5em">
              <ul class="normal">
<li class="normal" id="section-5.2.1-1.4.1.1">Contravention of legal requirements not to process user data.<a class="pilcrow" href="#section-5.2.1-1.4.1.1">¶</a>
</li>
              </ul>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.1-1.5">Mitigations:</dt>
            <dd id="section-5.2.1-1.6" style="margin-left: 1.5em">
              <p id="section-5.2.1-1.6.1">The following are recommendations relating to common activities for DNS
   service operators; in all cases, data retention should be minimized or completely
   avoided if possible for DNS privacy services. If data is retained, it should be
   encrypted and either aggregated, pseudonymized, or anonymized whenever
   possible.
   In general, the principle of data minimization described in <span>[<a class="xref" href="#RFC6973">RFC6973</a>]</span> should be applied.<a class="pilcrow" href="#section-5.2.1-1.6.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.1-1.6.2.1">Transient data (e.g., data used for real-time monitoring and threat
     analysis, which might be held only in memory) should be retained for the shortest
     possible period deemed operationally feasible.<a class="pilcrow" href="#section-5.2.1-1.6.2.1">¶</a>
</li>
                <li class="normal" id="section-5.2.1-1.6.2.2">The retention period of DNS traffic logs should be only as
     long as is required to sustain operation of the service and meet
     regulatory requirements, to the extent that they exist.<a class="pilcrow" href="#section-5.2.1-1.6.2.2">¶</a>
</li>
                <li class="normal" id="section-5.2.1-1.6.2.3">DNS privacy services should not track users except for the particular
purpose
of detecting and remedying technically malicious (e.g., DoS) or anomalous use
of the service.<a class="pilcrow" href="#section-5.2.1-1.6.2.3">¶</a>
</li>
                <li class="normal" id="section-5.2.1-1.6.2.4">Data access should be minimized to only those personnel who require access
to
perform operational duties. It should also be limited to anonymized or
pseudonymized data where operationally feasible, with access to full logs (if
any are held) only permitted when necessary.<a class="pilcrow" href="#section-5.2.1-1.6.2.4">¶</a>
</li>
              </ul>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.1-1.7">Optimizations:</dt>
            <dd id="section-5.2.1-1.8" style="margin-left: 1.5em">
              <ul class="normal">
<li class="normal" id="section-5.2.1-1.8.1.1">Consider use of full-disk encryption for logs and data-capture storage.<a class="pilcrow" href="#section-5.2.1-1.8.1.1">¶</a>
</li>
              </ul>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="data-minimization-of-network-traffic">
<section id="section-5.2.2">
          <h4 id="name-data-minimization-of-networ">
<a class="section-number selfRef" href="#section-5.2.2">5.2.2. </a><a class="section-name selfRef" href="#name-data-minimization-of-networ">Data Minimization of Network Traffic</a>
          </h4>
<p id="section-5.2.2-1">Data minimization refers to collecting, using, disclosing, and storing the
minimal data necessary to perform a task, and this can be achieved by
removing or obfuscating privacy-sensitive information in network traffic logs.
This is typically personal data or data that can be used to link a record to
an individual, but it may also include other confidential information -- for
example, on the structure of an internal corporate network.<a class="pilcrow" href="#section-5.2.2-1">¶</a></p>
<p id="section-5.2.2-2">The problem of effectively ensuring that DNS traffic logs contain no or
minimal
privacy-sensitive information is not one that currently has a generally agreed
solution or any standards to inform this discussion. This section presents an
overview of current techniques to simply provide reference on the current
status of this work.<a class="pilcrow" href="#section-5.2.2-2">¶</a></p>
<p id="section-5.2.2-3">Research into data minimization techniques (and particularly IP address
pseudonymization/anonymization) was sparked in the late 1990s / early 2000s,
partly driven by the desire to share significant corpuses of traffic captures
for research purposes. Several techniques reflecting different requirements in
this area and different performance/resource trade-offs emerged over the course
of the decade. Developments over the last decade have been both a blessing and
a
curse; the large increase in size between an IPv4 and an IPv6 address, for
example, renders some techniques impractical, but also makes available a much
larger amount of input entropy, the better to resist brute-force
re-identification attacks that have grown in practicality over the period.<a class="pilcrow" href="#section-5.2.2-3">¶</a></p>
<p id="section-5.2.2-4">Techniques employed may be broadly categorized as either anonymization or
pseudonymization. The following discussion uses the definitions from <span>[<a class="xref" href="#RFC6973">RFC6973</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc6973#section-3">Section 3</a></span>, with additional
observations from <span>[<a class="xref" href="#van-Dijkhuizen-et-al">van-Dijkhuizen-et-al</a>]</span>.<a class="pilcrow" href="#section-5.2.2-4">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.2-5.1">Anonymization. To enable anonymity of an individual, there must exist a set
of
individuals that appear to have the same attribute(s) as the individual. To
the attacker or the observer, these individuals must appear indistinguishable
from each other.<a class="pilcrow" href="#section-5.2.2-5.1">¶</a>
</li>
            <li class="normal" id="section-5.2.2-5.2">Pseudonymization. The true identity is deterministically replaced with an
alternate identity (a pseudonym). When the pseudonymization schema is known,
the process can be reversed, so the original identity becomes known again.<a class="pilcrow" href="#section-5.2.2-5.2">¶</a>
</li>
          </ul>
<p id="section-5.2.2-6">In practice, there is a fine line between the two; for example,
   it is difficult to categorize a deterministic algorithm for data
   minimization of IP addresses that produces a group of pseudonyms for
   a single given address.<a class="pilcrow" href="#section-5.2.2-6">¶</a></p>
</section>
</div>
<div id="ip-address-pseudonymization-and-anonymization-methods">
<section id="section-5.2.3">
          <h4 id="name-ip-address-pseudonymization">
<a class="section-number selfRef" href="#section-5.2.3">5.2.3. </a><a class="section-name selfRef" href="#name-ip-address-pseudonymization">IP Address Pseudonymization and Anonymization Methods</a>
          </h4>
<p id="section-5.2.3-1">A major privacy risk in DNS is connecting DNS queries to an individual, and
   the major vector for this in DNS traffic is the client IP address.<a class="pilcrow" href="#section-5.2.3-1">¶</a></p>
<p id="section-5.2.3-2">There is active discussion in the space of effective pseudonymization of IP
   addresses in DNS traffic logs; however, there seems to be no single solution
   that is widely recognized as suitable for all or most use cases. There are also as
   yet no standards for this that are unencumbered by patents.<a class="pilcrow" href="#section-5.2.3-2">¶</a></p>
<p id="section-5.2.3-3"><a class="xref" href="#ip-address-techniques">Appendix B</a> provides a more detailed survey of
various techniques
employed or under development in 2020.<a class="pilcrow" href="#section-5.2.3-3">¶</a></p>
</section>
</div>
<div id="pseudonymization-anonymization-or-discarding-of-other-correlation-data">
<section id="section-5.2.4">
          <h4 id="name-pseudonymization-anonymizat">
<a class="section-number selfRef" href="#section-5.2.4">5.2.4. </a><a class="section-name selfRef" href="#name-pseudonymization-anonymizat">Pseudonymization, Anonymization, or Discarding of Other Correlation Data</a>
          </h4>
<span class="break"></span><dl class="dlNewline" id="section-5.2.4-1">
            <dt id="section-5.2.4-1.1">DNS Privacy Threats:</dt>
            <dd id="section-5.2.4-1.2" style="margin-left: 1.5em">
              <ul class="normal">
<li class="normal" id="section-5.2.4-1.2.1.1">Fingerprinting of the client OS via various means, including: IP
     TTL/Hoplimit,
     TCP parameters (e.g., window size, Explicit Congestion
     Notification (ECN) support, selective acknowledgment (SACK)),
     OS-specific DNS query
     patterns (e.g., for network connectivity, captive portal detection, or
     OS-specific updates).<a class="pilcrow" href="#section-5.2.4-1.2.1.1">¶</a>
</li>
                <li class="normal" id="section-5.2.4-1.2.1.2">Fingerprinting of the client application or TLS library by,
     for example, HTTP headers (e.g., User-Agent, Accept,
     Accept-Encoding), TLS version/Cipher-suite
     combinations, or other connection parameters.<a class="pilcrow" href="#section-5.2.4-1.2.1.2">¶</a>
</li>
                <li class="normal" id="section-5.2.4-1.2.1.3">Correlation of queries on multiple TCP sessions originating from the same
     IP address.<a class="pilcrow" href="#section-5.2.4-1.2.1.3">¶</a>
</li>
                <li class="normal" id="section-5.2.4-1.2.1.4">Correlating of queries on multiple TLS sessions originating from the same
     client, including via session-resumption mechanisms.<a class="pilcrow" href="#section-5.2.4-1.2.1.4">¶</a>
</li>
                <li class="normal" id="section-5.2.4-1.2.1.5">Resolvers <em>might</em> receive client identifiers -- e.g.,
     Media Access Control (MAC) addresses in EDNS(0)
     options. Some customer premises equipment (CPE) devices are known
     to add them
     <span>[<a class="xref" href="#MAC-address-EDNS">MAC-address-EDNS</a>]</span>.<a class="pilcrow" href="#section-5.2.4-1.2.1.5">¶</a>
</li>
              </ul>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.4-1.3">Mitigations:</dt>
            <dd id="section-5.2.4-1.4" style="margin-left: 1.5em">
              <ul class="normal">
<li class="normal" id="section-5.2.4-1.4.1.1">Data minimization or discarding of such correlation data.<a class="pilcrow" href="#section-5.2.4-1.4.1.1">¶</a>
</li>
              </ul>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="cache-snooping">
<section id="section-5.2.5">
          <h4 id="name-cache-snooping">
<a class="section-number selfRef" href="#section-5.2.5">5.2.5. </a><a class="section-name selfRef" href="#name-cache-snooping">Cache Snooping</a>
          </h4>
<span class="break"></span><dl class="dlNewline" id="section-5.2.5-1">
            <dt id="section-5.2.5-1.1">Threats described in <span>[<a class="xref" href="#RFC6973">RFC6973</a>]</span>:</dt>
            <dd id="section-5.2.5-1.2" style="margin-left: 1.5em">
              <span class="break"></span><dl class="dlNewline" id="section-5.2.5-1.2.1">
                <dt id="section-5.2.5-1.2.1.1">Surveillance:</dt>
                <dd id="section-5.2.5-1.2.1.2" style="margin-left: 1.5em">Profiling of client queries by malicious third parties.<a class="pilcrow" href="#section-5.2.5-1.2.1.2">¶</a>
</dd>
              <dd class="break"></dd>
</dl>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.5-1.3">Mitigations:</dt>
            <dd id="section-5.2.5-1.4" style="margin-left: 1.5em">See <span>[<a class="xref" href="#ISC-Knowledge-database-on-cache-snooping">ISC-Knowledge-database-on-cache-snooping</a>]</span> for an
example discussion on
defending against cache snooping. Options proposed include limiting access to
a server and limiting nonrecursive queries.<a class="pilcrow" href="#section-5.2.5-1.4">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="data-sent-onwards-from-the-server">
<section id="section-5.3">
        <h3 id="name-data-sent-onwards-from-the-">
<a class="section-number selfRef" href="#section-5.3">5.3. </a><a class="section-name selfRef" href="#name-data-sent-onwards-from-the-">Data Sent Onwards from the Server</a>
        </h3>
<p id="section-5.3-1">In this section, we consider both data sent on the wire in upstream queries
and
data shared with third parties.<a class="pilcrow" href="#section-5.3-1">¶</a></p>
<div id="protocol-recommendations-1">
<section id="section-5.3.1">
          <h4 id="name-protocol-recommendations-2">
<a class="section-number selfRef" href="#section-5.3.1">5.3.1. </a><a class="section-name selfRef" href="#name-protocol-recommendations-2">Protocol Recommendations</a>
          </h4>
<span class="break"></span><dl class="dlNewline" id="section-5.3.1-1">
            <dt id="section-5.3.1-1.1">Threats described in <span>[<a class="xref" href="#RFC6973">RFC6973</a>]</span>:</dt>
            <dd id="section-5.3.1-1.2" style="margin-left: 1.5em">
              <span class="break"></span><dl class="dlNewline" id="section-5.3.1-1.2.1">
                <dt id="section-5.3.1-1.2.1.1">Surveillance:</dt>
                <dd id="section-5.3.1-1.2.1.2" style="margin-left: 1.5em">Transmission of identifying data upstream.<a class="pilcrow" href="#section-5.3.1-1.2.1.2">¶</a>
</dd>
              <dd class="break"></dd>
</dl>
</dd>
            <dd class="break"></dd>
<dt id="section-5.3.1-1.3">Mitigations:</dt>
            <dd id="section-5.3.1-1.4" style="margin-left: 1.5em">
              <p id="section-5.3.1-1.4.1">The server should:<a class="pilcrow" href="#section-5.3.1-1.4.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3.1-1.4.2.1">implement QNAME minimization <span>[<a class="xref" href="#RFC7816">RFC7816</a>]</span>.<a class="pilcrow" href="#section-5.3.1-1.4.2.1">¶</a>
</li>
                <li class="normal" id="section-5.3.1-1.4.2.2">honor a SOURCE PREFIX-LENGTH set to 0 in a query containing the EDNS(0)
Client Subnet (ECS) option (<span>[<a class="xref" href="#RFC7871">RFC7871</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc7871#section-7.1.2">Section 7.1.2</a></span>).  This is as specified in <span>[<a class="xref" href="#RFC8310">RFC8310</a>]</span> for DoT but
     applicable to any DNS
        privacy service.<a class="pilcrow" href="#section-5.3.1-1.4.2.2">¶</a>
</li>
              </ul>
</dd>
            <dd class="break"></dd>
<dt id="section-5.3.1-1.5">Optimizations:</dt>
            <dd id="section-5.3.1-1.6" style="margin-left: 1.5em">
              <p id="section-5.3.1-1.6.1">As per <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc7871#section-2">Section 2</a> of [<a class="xref" href="#RFC7871">RFC7871</a>]</span>, the server should either:<a class="pilcrow" href="#section-5.3.1-1.6.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3.1-1.6.2.1">not use the ECS option in upstream queries at all, or<a class="pilcrow" href="#section-5.3.1-1.6.2.1">¶</a>
</li>
                <li class="normal" id="section-5.3.1-1.6.2.2">offer alternative services, one that sends ECS and one that does not.<a class="pilcrow" href="#section-5.3.1-1.6.2.2">¶</a>
</li>
              </ul>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-5.3.1-2">If operators do offer a service that sends the ECS options upstream, they
should
use the shortest prefix that is operationally feasible and ideally
use a policy of allowlisting upstream servers to which to send ECS in order to
reduce data leakage. Operators should make clear in any policy statement what
prefix length they actually send and the specific policy used.<a class="pilcrow" href="#section-5.3.1-2">¶</a></p>
<p id="section-5.3.1-3">Allowlisting has the benefit that not only does the operator know which
   upstream
   servers can use ECS, but also the operator can decide which upstream
   servers apply privacy policies that the operator is happy with. However, some
   operators consider allowlisting to incur significant operational overhead
   compared to dynamic detection of ECS support on authoritative servers.<a class="pilcrow" href="#section-5.3.1-3">¶</a></p>
<p id="section-5.3.1-4">Additional options:<a class="pilcrow" href="#section-5.3.1-4">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3.1-5.1">"Aggressive Use of DNSSEC-Validated Cache" <span>[<a class="xref" href="#RFC8198">RFC8198</a>]</span> and "NXDOMAIN: There Really Is
     Nothing Underneath" <span>[<a class="xref" href="#RFC8020">RFC8020</a>]</span> to reduce the number of queries
to authoritative servers to increase privacy.<a class="pilcrow" href="#section-5.3.1-5.1">¶</a>
</li>
            <li class="normal" id="section-5.3.1-5.2">Run a local copy of the root zone <span>[<a class="xref" href="#RFC8806">RFC8806</a>]</span> to avoid making queries to the root servers
            that might leak information.<a class="pilcrow" href="#section-5.3.1-5.2">¶</a>
</li>
          </ul>
</section>
</div>
<div id="client-query-obfuscation">
<section id="section-5.3.2">
          <h4 id="name-client-query-obfuscation">
<a class="section-number selfRef" href="#section-5.3.2">5.3.2. </a><a class="section-name selfRef" href="#name-client-query-obfuscation">Client Query Obfuscation</a>
          </h4>
<p id="section-5.3.2-1">Additional options:<a class="pilcrow" href="#section-5.3.2-1">¶</a></p>
<p id="section-5.3.2-2">Since queries from recursive resolvers to authoritative servers are
performed
using cleartext (at the time of writing), resolver services need to consider
the
extent to which they may be directly leaking information about their client
community via these upstream queries and what they can do to mitigate this
further. Note that, even when all the relevant techniques described above are
employed, there may still be attacks possible -- e.g.,
<span>[<a class="xref" href="#Pitfalls-of-DNS-Encryption">Pitfalls-of-DNS-Encryption</a>]</span>. For example, a resolver with a
very small
community of users risks exposing data in this way and ought to obfuscate this
traffic by mixing it with "generated" traffic to make client characterization
harder. The resolver could also employ aggressive prefetch techniques as a
further measure to counter traffic analysis.<a class="pilcrow" href="#section-5.3.2-2">¶</a></p>
<p id="section-5.3.2-3">At the time of writing, there are no standardized or widely recognized
techniques
to perform such obfuscation or bulk prefetches.<a class="pilcrow" href="#section-5.3.2-3">¶</a></p>
<p id="section-5.3.2-4">Another technique that particularly small operators may consider is
forwarding
local traffic to a larger resolver (with a privacy policy that aligns with
their
own practices) over an encrypted protocol, so that the upstream queries are
obfuscated among those of the large resolver.<a class="pilcrow" href="#section-5.3.2-4">¶</a></p>
</section>
</div>
<div id="data-sharing">
<section id="section-5.3.3">
          <h4 id="name-data-sharing">
<a class="section-number selfRef" href="#section-5.3.3">5.3.3. </a><a class="section-name selfRef" href="#name-data-sharing">Data Sharing</a>
          </h4>
<span class="break"></span><dl class="dlNewline" id="section-5.3.3-1">
            <dt id="section-5.3.3-1.1">Threats described in <span>[<a class="xref" href="#RFC6973">RFC6973</a>]</span>:</dt>
            <dd id="section-5.3.3-1.2" style="margin-left: 1.5em">
              <ul class="normal">
<li class="normal" id="section-5.3.3-1.2.1.1">Surveillance.<a class="pilcrow" href="#section-5.3.3-1.2.1.1">¶</a>
</li>
                <li class="normal" id="section-5.3.3-1.2.1.2">Stored-data compromise.<a class="pilcrow" href="#section-5.3.3-1.2.1.2">¶</a>
</li>
                <li class="normal" id="section-5.3.3-1.2.1.3">Correlation.<a class="pilcrow" href="#section-5.3.3-1.2.1.3">¶</a>
</li>
                <li class="normal" id="section-5.3.3-1.2.1.4">Identification.<a class="pilcrow" href="#section-5.3.3-1.2.1.4">¶</a>
</li>
                <li class="normal" id="section-5.3.3-1.2.1.5">Secondary use.<a class="pilcrow" href="#section-5.3.3-1.2.1.5">¶</a>
</li>
                <li class="normal" id="section-5.3.3-1.2.1.6">Disclosure.<a class="pilcrow" href="#section-5.3.3-1.2.1.6">¶</a>
</li>
              </ul>
</dd>
            <dd class="break"></dd>
<dt id="section-5.3.3-1.3">DNS Privacy Threats:</dt>
            <dd id="section-5.3.3-1.4" style="margin-left: 1.5em">Contravention of legal requirements not to process user data.<a class="pilcrow" href="#section-5.3.3-1.4">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.3.3-1.5">Mitigations:</dt>
            <dd id="section-5.3.3-1.6" style="margin-left: 1.5em">
              <p id="section-5.3.3-1.6.1">Operators should not share identifiable data with third parties.<a class="pilcrow" href="#section-5.3.3-1.6.1">¶</a></p>
<p id="section-5.3.3-1.6.2">If operators choose to share identifiable data with third parties in
   specific circumstances, they should publish the terms under which data is shared.<a class="pilcrow" href="#section-5.3.3-1.6.2">¶</a></p>
<p id="section-5.3.3-1.6.3">Operators should consider including specific guidelines for the collection
of
aggregated and/or anonymized data for research purposes, within or outside of
their own organization. This can benefit not only the operator (through
inclusion in novel research) but also the wider Internet community. See the
policy published by SURFnet <span>[<a class="xref" href="#SURFnet-policy">SURFnet-policy</a>]</span> on data sharing
for research as
an example.<a class="pilcrow" href="#section-5.3.3-1.6.3">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="recursive-operator-privacy-statement-rps">
<section id="section-6">
      <h2 id="name-recursive-operator-privacy-">
<a class="section-number selfRef" href="#section-6">6. </a><a class="section-name selfRef" href="#name-recursive-operator-privacy-">Recursive Operator Privacy Statement (RPS)</a>
      </h2>
<p id="section-6-1">To be compliant with this Best Current Practice document, a DNS recursive
operator <span class="bcp14">SHOULD</span> publish a Recursive operator Privacy Statement (RPS). Adopting
the
outline, and including the headings in the order provided, is a benefit to
persons comparing RPSs from multiple operators.<a class="pilcrow" href="#section-6-1">¶</a></p>
<p id="section-6-2"><a class="xref" href="#current-policy-and-privacy-statements">Appendix C</a> provides a
comparison of some existing
policy and privacy statements.<a class="pilcrow" href="#section-6-2">¶</a></p>
<div id="outline-of-an-rps">
<section id="section-6.1">
        <h3 id="name-outline-of-an-rps">
<a class="section-number selfRef" href="#section-6.1">6.1. </a><a class="section-name selfRef" href="#name-outline-of-an-rps">Outline of an RPS</a>
        </h3>
<p id="section-6.1-1">The contents of Sections <a class="xref" href="#policy">6.1.1</a> and <a class="xref" href="#practice">6.1.2</a> are
non-normative, other than the
order of the headings. Material under each topic is present to assist the
operator developing their own RPS. This material:<a class="pilcrow" href="#section-6.1-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1-2.1">Relates <em>only</em> to matters around the technical
operation of DNS privacy services, and no other matters.<a class="pilcrow" href="#section-6.1-2.1">¶</a>
</li>
          <li class="normal" id="section-6.1-2.2">Does not attempt to offer an exhaustive list for the contents of an
RPS.<a class="pilcrow" href="#section-6.1-2.2">¶</a>
</li>
          <li class="normal" id="section-6.1-2.3">Is not intended to form the basis of any legal/compliance
documentation.<a class="pilcrow" href="#section-6.1-2.3">¶</a>
</li>
        </ul>
<p id="section-6.1-3"><a class="xref" href="#example-rps">Appendix D</a> provides an example (also non-normative) of an
RPS
statement for a specific operator scenario.<a class="pilcrow" href="#section-6.1-3">¶</a></p>
<div id="policy">
<section id="section-6.1.1">
          <h4 id="name-policy">
<a class="section-number selfRef" href="#section-6.1.1">6.1.1. </a><a class="section-name selfRef" href="#name-policy">Policy</a>
          </h4>
<ol class="normal type-1" id="section-6.1.1-1" start="1" type="1">
            <li id="section-6.1.1-1.1">Treatment of IP addresses. Make an explicit statement that IP addresses are
treated as personal data.<a class="pilcrow" href="#section-6.1.1-1.1">¶</a>
</li>
            <li id="section-6.1.1-1.2">
              <p id="section-6.1.1-1.2.1">Data collection and sharing. Specify clearly what data (including IP
       addresses) is:<a class="pilcrow" href="#section-6.1.1-1.2.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1.1-1.2.2.1">Collected and retained by the operator, and for what period it is
retained.<a class="pilcrow" href="#section-6.1.1-1.2.2.1">¶</a>
</li>
                <li class="normal" id="section-6.1.1-1.2.2.2">Shared with partners.<a class="pilcrow" href="#section-6.1.1-1.2.2.2">¶</a>
</li>
                <li class="normal" id="section-6.1.1-1.2.2.3">
                  <p id="section-6.1.1-1.2.2.3.1">Shared, sold, or rented to third parties.<a class="pilcrow" href="#section-6.1.1-1.2.2.3.1">¶</a></p>
<p id="section-6.1.1-1.2.2.3.2"></p>
</li>
              </ul>
<p id="section-6.1.1-1.2.3">
 In each case, specify whether data is aggregated, pseudonymized, or anonymized and
 the conditions of data transfer. Where possible provide details of the
       techniques used for the above data minimizations.<a class="pilcrow" href="#section-6.1.1-1.2.3">¶</a></p>
</li>
            <li id="section-6.1.1-1.3">Exceptions. Specify any exceptions to the above -- for example, technically
malicious or anomalous behavior.<a class="pilcrow" href="#section-6.1.1-1.3">¶</a>
</li>
            <li id="section-6.1.1-1.4">Associated entities. Declare and explicitly enumerate any partners,
third-party affiliations, or sources of funding.<a class="pilcrow" href="#section-6.1.1-1.4">¶</a>
</li>
            <li id="section-6.1.1-1.5">Correlation. Whether user DNS data is correlated or combined with any other
personal information held by the operator.<a class="pilcrow" href="#section-6.1.1-1.5">¶</a>
</li>
            <li id="section-6.1.1-1.6">
              <p id="section-6.1.1-1.6.1">Result filtering. This section should explain whether the operator filters,
edits, or alters in any way the replies that it receives from the authoritative
servers for each DNS zone before forwarding them to the clients. For each
category listed below, the operator should also specify how the filtering
lists
are created and managed, whether it employs any third-party sources for such
lists, and which ones.<a class="pilcrow" href="#section-6.1.1-1.6.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1.1-1.6.2.1">Specify if any replies are being filtered out or altered for network- and
 computer-security reasons (e.g., preventing connections to
 malware-spreading websites or botnet control servers).<a class="pilcrow" href="#section-6.1.1-1.6.2.1">¶</a>
</li>
                <li class="normal" id="section-6.1.1-1.6.2.2">Specify if any replies are being filtered out or altered for mandatory
legal reasons, due to applicable legislation or binding orders by courts
and other public authorities.<a class="pilcrow" href="#section-6.1.1-1.6.2.2">¶</a>
</li>
                <li class="normal" id="section-6.1.1-1.6.2.3">Specify if any replies are being filtered out or altered for voluntary
legal reasons, due to an internal policy by the operator aiming at
reducing potential legal risks.<a class="pilcrow" href="#section-6.1.1-1.6.2.3">¶</a>
</li>
                <li class="normal" id="section-6.1.1-1.6.2.4">Specify if any replies are being filtered out or altered for any other
reason, including commercial ones.<a class="pilcrow" href="#section-6.1.1-1.6.2.4">¶</a>
</li>
              </ul>
</li>
          </ol>
</section>
</div>
<div id="practice">
<section id="section-6.1.2">
          <h4 id="name-practice">
<a class="section-number selfRef" href="#section-6.1.2">6.1.2. </a><a class="section-name selfRef" href="#name-practice">Practice</a>
          </h4>
<p id="section-6.1.2-1">Communicate the current operational practices of the service.<a class="pilcrow" href="#section-6.1.2-1">¶</a></p>
<ol class="normal type-1" id="section-6.1.2-2" start="1" type="1">
  <li id="section-6.1.2-2.1">Deviations. Specify any temporary or permanent deviations from the policy
  for operational reasons.<a class="pilcrow" href="#section-6.1.2-2.1">¶</a>
</li>
            <li id="section-6.1.2-2.2">
              <p id="section-6.1.2-2.2.1">Client-facing capabilities. With reference to each subsection of
       <a class="xref" href="#on-the-wire-between-client-and-server">Section 5.1</a>, provide specific
       details of which
       capabilities (transport, DNSSEC, padding, etc.) are provided on
       which client-facing addresses/port combination or DoH URI
       template. For
       <a class="xref" href="#authentication-of-dns-privacy-services">Section 5.1.2</a>, clearly specify which specific
       authentication mechanisms are supported for each endpoint that offers DoT:<a class="pilcrow" href="#section-6.1.2-2.2.1">¶</a></p>
<ol class="normal type-a" id="section-6.1.2-2.2.2" start="1" type="a">
                <li id="section-6.1.2-2.2.2.1">The authentication domain name to be used (if any).<a class="pilcrow" href="#section-6.1.2-2.2.2.1">¶</a>
</li>
                <li id="section-6.1.2-2.2.2.2">
                  <p id="section-6.1.2-2.2.2.2.1">The SPKI pin sets to be used (if any) and policy for rolling keys.<a class="pilcrow" href="#section-6.1.2-2.2.2.2.1">¶</a></p>
<p id="section-6.1.2-2.2.2.2.2"></p>
</li>
              </ol>
</li>
            <li id="section-6.1.2-2.3">Upstream capabilities. With reference to
     <a class="xref" href="#data-sent-onwards-from-the-server">Section 5.3</a>, provide specific details of
     which capabilities are provided upstream for data sent to authoritative servers.<a class="pilcrow" href="#section-6.1.2-2.3">¶</a>
</li>
            <li id="section-6.1.2-2.4">Support. Provide contact/support information for the service.<a class="pilcrow" href="#section-6.1.2-2.4">¶</a>
</li>
            <li id="section-6.1.2-2.5">Data Processing. This section can optionally communicate links to, and the
     high-level contents of, any separate statements the operator has published
     that cover applicable data-processing legislation or agreements with regard to the
     location(s) of service provision.<a class="pilcrow" href="#section-6.1.2-2.5">¶</a>
</li>
          </ol>
</section>
</div>
</section>
</div>
<div id="enforcementaccountability">
<section id="section-6.2">
        <h3 id="name-enforcement-accountability">
<a class="section-number selfRef" href="#section-6.2">6.2. </a><a class="section-name selfRef" href="#name-enforcement-accountability">Enforcement/Accountability</a>
        </h3>
<p id="section-6.2-1">Transparency reports may help with building user trust that operators
adhere to
their policies and practices.<a class="pilcrow" href="#section-6.2-1">¶</a></p>
<p id="section-6.2-2">Where possible, independent monitoring or analysis could be performed of:<a class="pilcrow" href="#section-6.2-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2-3.1">ECS, QNAME minimization, EDNS(0) padding, etc.<a class="pilcrow" href="#section-6.2-3.1">¶</a>
</li>
          <li class="normal" id="section-6.2-3.2">Filtering.<a class="pilcrow" href="#section-6.2-3.2">¶</a>
</li>
          <li class="normal" id="section-6.2-3.3">Uptime.<a class="pilcrow" href="#section-6.2-3.3">¶</a>
</li>
        </ul>
<p id="section-6.2-4">This is by analogy with several TLS or website-analysis tools that are
currently available -- e.g., <span>[<a class="xref" href="#SSL-Labs">SSL-Labs</a>]</span> or
<span>[<a class="xref" href="#Internet.nl">Internet.nl</a>]</span>.<a class="pilcrow" href="#section-6.2-4">¶</a></p>
<p id="section-6.2-5">Additionally, operators could choose to engage the services of a third-party
auditor to verify their compliance with their published RPS.<a class="pilcrow" href="#section-6.2-5">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-7">
      <h2 id="name-iana-considerations">
<a class="section-number selfRef" href="#section-7">7. </a><a class="section-name selfRef" href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<p id="section-7-1">This document has no IANA actions.<a class="pilcrow" href="#section-7-1">¶</a></p>
</section>
</div>
<div id="security-considerations">
<section id="section-8">
      <h2 id="name-security-considerations">
<a class="section-number selfRef" href="#section-8">8. </a><a class="section-name selfRef" href="#name-security-considerations">Security Considerations</a>
      </h2>
<p id="section-8-1">Security considerations for DNS over TCP are given in <span>[<a class="xref" href="#RFC7766">RFC7766</a>]</span>, many of which
are generally applicable to session-based DNS. Guidance on operational
requirements for DNS over TCP are also available in <span>[<a class="xref" href="#I-D.ietf-dnsop-dns-tcp-requirements">DNS-OVER-TCP</a>]</span>. Security considerations for
DoT are given in <span>[<a class="xref" href="#RFC7858">RFC7858</a>]</span> and <span>[<a class="xref" href="#RFC8310">RFC8310</a>]</span>, and those for DoH in <span>[<a class="xref" href="#RFC8484">RFC8484</a>]</span>.<a class="pilcrow" href="#section-8-1">¶</a></p>
<p id="section-8-2">Security considerations for DNSSEC are given in <span>[<a class="xref" href="#RFC4033">RFC4033</a>]</span>,
<span>[<a class="xref" href="#RFC4034">RFC4034</a>]</span>, and <span>[<a class="xref" href="#RFC4035">RFC4035</a>]</span>.<a class="pilcrow" href="#section-8-2">¶</a></p>
</section>
</div>
<section id="section-9">
      <h2 id="name-references">
<a class="section-number selfRef" href="#section-9">9. </a><a class="section-name selfRef" href="#name-references">References</a>
      </h2>
<section id="section-9.1">
        <h3 id="name-normative-references">
<a class="section-number selfRef" href="#section-9.1">9.1. </a><a class="section-name selfRef" href="#name-normative-references">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time class="refDate" datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4033">[RFC4033]</dt>
        <dd>
<span class="refAuthor">Arends, R.</span><span class="refAuthor">, Austein, R.</span><span class="refAuthor">, Larson, M.</span><span class="refAuthor">, Massey, D.</span><span class="refAuthor">, and S. Rose</span>, <span class="refTitle">"DNS Security Introduction and Requirements"</span>, <span class="seriesInfo">RFC 4033</span>, <span class="seriesInfo">DOI 10.17487/RFC4033</span>, <time class="refDate" datetime="2005-03">March 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4033">https://www.rfc-editor.org/info/rfc4033</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5280">[RFC5280]</dt>
        <dd>
<span class="refAuthor">Cooper, D.</span><span class="refAuthor">, Santesson, S.</span><span class="refAuthor">, Farrell, S.</span><span class="refAuthor">, Boeyen, S.</span><span class="refAuthor">, Housley, R.</span><span class="refAuthor">, and W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time class="refDate" datetime="2008-05">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5280">https://www.rfc-editor.org/info/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6973">[RFC6973]</dt>
        <dd>
<span class="refAuthor">Cooper, A.</span><span class="refAuthor">, Tschofenig, H.</span><span class="refAuthor">, Aboba, B.</span><span class="refAuthor">, Peterson, J.</span><span class="refAuthor">, Morris, J.</span><span class="refAuthor">, Hansen, M.</span><span class="refAuthor">, and R. Smith</span>, <span class="refTitle">"Privacy Considerations for Internet Protocols"</span>, <span class="seriesInfo">RFC 6973</span>, <span class="seriesInfo">DOI 10.17487/RFC6973</span>, <time class="refDate" datetime="2013-07">July 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6973">https://www.rfc-editor.org/info/rfc6973</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7457">[RFC7457]</dt>
        <dd>
<span class="refAuthor">Sheffer, Y.</span><span class="refAuthor">, Holz, R.</span><span class="refAuthor">, and P. Saint-Andre</span>, <span class="refTitle">"Summarizing Known Attacks on Transport Layer Security (TLS) and Datagram TLS (DTLS)"</span>, <span class="seriesInfo">RFC 7457</span>, <span class="seriesInfo">DOI 10.17487/RFC7457</span>, <time class="refDate" datetime="2015-02">February 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7457">https://www.rfc-editor.org/info/rfc7457</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7525">[RFC7525]</dt>
        <dd>
<span class="refAuthor">Sheffer, Y.</span><span class="refAuthor">, Holz, R.</span><span class="refAuthor">, and P. Saint-Andre</span>, <span class="refTitle">"Recommendations for Secure Use of Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)"</span>, <span class="seriesInfo">BCP 195</span>, <span class="seriesInfo">RFC 7525</span>, <span class="seriesInfo">DOI 10.17487/RFC7525</span>, <time class="refDate" datetime="2015-05">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7525">https://www.rfc-editor.org/info/rfc7525</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7766">[RFC7766]</dt>
        <dd>
<span class="refAuthor">Dickinson, J.</span><span class="refAuthor">, Dickinson, S.</span><span class="refAuthor">, Bellis, R.</span><span class="refAuthor">, Mankin, A.</span><span class="refAuthor">, and D. Wessels</span>, <span class="refTitle">"DNS Transport over TCP - Implementation Requirements"</span>, <span class="seriesInfo">RFC 7766</span>, <span class="seriesInfo">DOI 10.17487/RFC7766</span>, <time class="refDate" datetime="2016-03">March 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7766">https://www.rfc-editor.org/info/rfc7766</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7816">[RFC7816]</dt>
        <dd>
<span class="refAuthor">Bortzmeyer, S.</span>, <span class="refTitle">"DNS Query Name Minimisation to Improve Privacy"</span>, <span class="seriesInfo">RFC 7816</span>, <span class="seriesInfo">DOI 10.17487/RFC7816</span>, <time class="refDate" datetime="2016-03">March 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7816">https://www.rfc-editor.org/info/rfc7816</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7828">[RFC7828]</dt>
        <dd>
<span class="refAuthor">Wouters, P.</span><span class="refAuthor">, Abley, J.</span><span class="refAuthor">, Dickinson, S.</span><span class="refAuthor">, and R. Bellis</span>, <span class="refTitle">"The edns-tcp-keepalive EDNS0 Option"</span>, <span class="seriesInfo">RFC 7828</span>, <span class="seriesInfo">DOI 10.17487/RFC7828</span>, <time class="refDate" datetime="2016-04">April 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7828">https://www.rfc-editor.org/info/rfc7828</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7830">[RFC7830]</dt>
        <dd>
<span class="refAuthor">Mayrhofer, A.</span>, <span class="refTitle">"The EDNS(0) Padding Option"</span>, <span class="seriesInfo">RFC 7830</span>, <span class="seriesInfo">DOI 10.17487/RFC7830</span>, <time class="refDate" datetime="2016-05">May 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7830">https://www.rfc-editor.org/info/rfc7830</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7858">[RFC7858]</dt>
        <dd>
<span class="refAuthor">Hu, Z.</span><span class="refAuthor">, Zhu, L.</span><span class="refAuthor">, Heidemann, J.</span><span class="refAuthor">, Mankin, A.</span><span class="refAuthor">, Wessels, D.</span><span class="refAuthor">, and P. Hoffman</span>, <span class="refTitle">"Specification for DNS over Transport Layer Security (TLS)"</span>, <span class="seriesInfo">RFC 7858</span>, <span class="seriesInfo">DOI 10.17487/RFC7858</span>, <time class="refDate" datetime="2016-05">May 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7858">https://www.rfc-editor.org/info/rfc7858</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7871">[RFC7871]</dt>
        <dd>
<span class="refAuthor">Contavalli, C.</span><span class="refAuthor">, van der Gaast, W.</span><span class="refAuthor">, Lawrence, D.</span><span class="refAuthor">, and W. Kumari</span>, <span class="refTitle">"Client Subnet in DNS Queries"</span>, <span class="seriesInfo">RFC 7871</span>, <span class="seriesInfo">DOI 10.17487/RFC7871</span>, <time class="refDate" datetime="2016-05">May 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7871">https://www.rfc-editor.org/info/rfc7871</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8020">[RFC8020]</dt>
        <dd>
<span class="refAuthor">Bortzmeyer, S.</span><span class="refAuthor"> and S. Huque</span>, <span class="refTitle">"NXDOMAIN: There Really Is Nothing Underneath"</span>, <span class="seriesInfo">RFC 8020</span>, <span class="seriesInfo">DOI 10.17487/RFC8020</span>, <time class="refDate" datetime="2016-11">November 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8020">https://www.rfc-editor.org/info/rfc8020</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time class="refDate" datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8198">[RFC8198]</dt>
        <dd>
<span class="refAuthor">Fujiwara, K.</span><span class="refAuthor">, Kato, A.</span><span class="refAuthor">, and W. Kumari</span>, <span class="refTitle">"Aggressive Use of DNSSEC-Validated Cache"</span>, <span class="seriesInfo">RFC 8198</span>, <span class="seriesInfo">DOI 10.17487/RFC8198</span>, <time class="refDate" datetime="2017-07">July 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8198">https://www.rfc-editor.org/info/rfc8198</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8310">[RFC8310]</dt>
        <dd>
<span class="refAuthor">Dickinson, S.</span><span class="refAuthor">, Gillmor, D.</span><span class="refAuthor">, and T. Reddy</span>, <span class="refTitle">"Usage Profiles for DNS over TLS and DNS over DTLS"</span>, <span class="seriesInfo">RFC 8310</span>, <span class="seriesInfo">DOI 10.17487/RFC8310</span>, <time class="refDate" datetime="2018-03">March 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8310">https://www.rfc-editor.org/info/rfc8310</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8467">[RFC8467]</dt>
        <dd>
<span class="refAuthor">Mayrhofer, A.</span>, <span class="refTitle">"Padding Policies for Extension Mechanisms for DNS (EDNS(0))"</span>, <span class="seriesInfo">RFC 8467</span>, <span class="seriesInfo">DOI 10.17487/RFC8467</span>, <time class="refDate" datetime="2018-10">October 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8467">https://www.rfc-editor.org/info/rfc8467</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8484">[RFC8484]</dt>
        <dd>
<span class="refAuthor">Hoffman, P.</span><span class="refAuthor"> and P. McManus</span>, <span class="refTitle">"DNS Queries over HTTPS (DoH)"</span>, <span class="seriesInfo">RFC 8484</span>, <span class="seriesInfo">DOI 10.17487/RFC8484</span>, <time class="refDate" datetime="2018-10">October 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8484">https://www.rfc-editor.org/info/rfc8484</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8490">[RFC8490]</dt>
        <dd>
<span class="refAuthor">Bellis, R.</span><span class="refAuthor">, Cheshire, S.</span><span class="refAuthor">, Dickinson, J.</span><span class="refAuthor">, Dickinson, S.</span><span class="refAuthor">, Lemon, T.</span><span class="refAuthor">, and T. Pusateri</span>, <span class="refTitle">"DNS Stateful Operations"</span>, <span class="seriesInfo">RFC 8490</span>, <span class="seriesInfo">DOI 10.17487/RFC8490</span>, <time class="refDate" datetime="2019-03">March 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8490">https://www.rfc-editor.org/info/rfc8490</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8499">[RFC8499]</dt>
        <dd>
<span class="refAuthor">Hoffman, P.</span><span class="refAuthor">, Sullivan, A.</span><span class="refAuthor">, and K. Fujiwara</span>, <span class="refTitle">"DNS Terminology"</span>, <span class="seriesInfo">BCP 219</span>, <span class="seriesInfo">RFC 8499</span>, <span class="seriesInfo">DOI 10.17487/RFC8499</span>, <time class="refDate" datetime="2019-01">January 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8499">https://www.rfc-editor.org/info/rfc8499</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8806">[RFC8806]</dt>
      <dd>
<span class="refAuthor">Kumari, W.</span><span class="refAuthor"> and P. Hoffman</span>, <span class="refTitle">"Running a Root Server Local to a Resolver"</span>, <span class="seriesInfo">RFC 8806</span>, <span class="seriesInfo">DOI 10.17487/RFC8806</span>, <time class="refDate" datetime="2020-06">June 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8806">https://www.rfc-editor.org/info/rfc8806</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-9.2">
        <h3 id="name-informative-references">
<a class="section-number selfRef" href="#section-9.2">9.2. </a><a class="section-name selfRef" href="#name-informative-references">Informative References</a>
        </h3>
<dl class="references">
<dt id="Bloom-filter">[Bloom-filter]</dt>
        <dd>
<span class="refAuthor">van Rijswijk-Deij, R.</span><span class="refAuthor">, Rijnders, G.</span><span class="refAuthor">, Bomhoff, M.</span><span class="refAuthor">, and L. Allodi</span>, <span class="refTitle">"Privacy-Conscious Threat Intelligence Using DNSBLOOM"</span>, <span class="refContent">IFIP/IEEE International Symposium on Integrated Network
   Management (IM2019)</span>, <time class="refDate" datetime="2019">2019</time>, <span>&lt;<a href="http://dl.ifip.org/db/conf/im/im2019/189282.pdf">http://dl.ifip.org/db/conf/im/im2019/189282.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Brekne-and-Arnes">[Brekne-and-Arnes]</dt>
        <dd>
<span class="refAuthor">Brekne, T.</span><span class="refAuthor"> and A. Årnes</span>, <span class="refTitle">"Circumventing IP-address pseudonymization"</span>, <span class="seriesInfo">Communications and Computer Networks</span>, <time class="refDate" datetime="2005">2005</time>, <span>&lt;<a href="https://pdfs.semanticscholar.org/7b34/12c951cebe71cd2cddac5fda164fb2138a44.pdf">https://pdfs.semanticscholar.org/7b34/12c951cebe71cd2cddac5fda164fb2138a44.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-httpbis-bcp56bis">[BUILD-W-HTTP]</dt>
        <dd>
<span class="refAuthor">Nottingham, M.</span>, <span class="refTitle">"Building Protocols with HTTP"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-httpbis-bcp56bis-09</span>, <time class="refDate" datetime="2019-11-01">1 November 2019</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-httpbis-bcp56bis-09">https://tools.ietf.org/html/draft-ietf-httpbis-bcp56bis-09</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Crypto-PAn">[Crypto-PAn]</dt>
        <dd>
<span class="refAuthor">CESNET</span>, <span class="refTitle">"Crypto-PAn"</span>, <span class="seriesInfo">commit 636b237</span>, <time class="refDate" datetime="2015-03">March 2015</time>, <span>&lt;<a href="https://github.com/CESNET/ipfixcol/tree/master/base/src/intermediate/anonymization/Crypto-PAn">https://github.com/CESNET/ipfixcol/tree/master/base/src/intermediate/anonymization/Crypto-PAn</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-dnsop-dns-tcp-requirements">[DNS-OVER-TCP]</dt>
        <dd>
<span class="refAuthor">Kristoff, J.</span><span class="refAuthor"> and D. Wessels</span>, <span class="refTitle">"DNS Transport over TCP - Operational Requirements"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-dnsop-dns-tcp-requirements-06</span>, <time class="refDate" datetime="2020-05-06">6 May 2020</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-dnsop-dns-tcp-requirements-06">https://tools.ietf.org/html/draft-ietf-dnsop-dns-tcp-requirements-06</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="DNS-Privacy-not-so-private">[DNS-Privacy-not-so-private]</dt>
        <dd>
<span class="refAuthor">Silby, S.</span><span class="refAuthor">, Juarez, M.</span><span class="refAuthor">, Vallina-Rodriguez, N.</span><span class="refAuthor">, and C. Troncoso</span>, <span class="refTitle">"DNS Privacy not so private: the traffic analysis perspective."</span>, <span class="seriesInfo">Privacy Enhancing Technologies Symposium</span>, <time class="refDate" datetime="2018">2018</time>, <span>&lt;<a href="https://petsymposium.org/2018/files/hotpets/4-siby.pdf">https://petsymposium.org/2018/files/hotpets/4-siby.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.bellis-dnsop-xpf">[DNS-XPF]</dt>
        <dd>
<span class="refAuthor">Bellis, R.</span><span class="refAuthor">, Dijk, P. V.</span><span class="refAuthor">, and R. Gacogne</span>, <span class="refTitle">"DNS X-Proxied-For"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-bellis-dnsop-xpf-04</span>, <time class="refDate" datetime="2018-03-05">5 March 2018</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-bellis-dnsop-xpf-04">https://tools.ietf.org/html/draft-bellis-dnsop-xpf-04</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="DNSCrypt">[DNSCrypt]</dt>
        <dd>
<span class="refTitle">"DNSCrypt - Official Project Home Page"</span>, <span>&lt;<a href="https://www.dnscrypt.org">https://www.dnscrypt.org</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="dnsdist">[dnsdist]</dt>
        <dd>
<span class="refAuthor">PowerDNS</span>, <span class="refTitle">"dnsdist Overview"</span>, <span>&lt;<a href="https://dnsdist.org">https://dnsdist.org</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="dnstap">[dnstap]</dt>
        <dd>
<span class="refTitle">"dnstap"</span>, <span>&lt;<a href="https://dnstap.info">https://dnstap.info</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="DoH-resolver-policy">[DoH-resolver-policy]</dt>
        <dd>
<span class="refAuthor">Mozilla</span>, <span class="refTitle">"Security/DOH-resolver-policy"</span>, <time class="refDate" datetime="2019">2019</time>, <span>&lt;<a href="https://wiki.mozilla.org/Security/DOH-resolver-policy">https://wiki.mozilla.org/Security/DOH-resolver-policy</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="dot-ALPN">[dot-ALPN]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Transport Layer Security (TLS) Extensions: TLS Application-Layer Protocol Negotiation (ALPN) Protocol IDs"</span>, <span>&lt;<a href="https://www.iana.org/assignments/tls-extensiontype-values">https://www.iana.org/assignments/tls-extensiontype-values</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Geolocation-Impact-Assessment">[Geolocation-Impact-Assessment]</dt>
        <dd>
<span class="refAuthor">Conversion Works</span>, <span class="refTitle">"Anonymize IP Geolocation Accuracy Impact Assessment"</span>, <time class="refDate" datetime="2017-05-19">19 May 2017</time>, <span>&lt;<a href="https://www.conversionworks.co.uk/blog/2017/05/19/anonymize-ip-geo-impact-test/">https://www.conversionworks.co.uk/blog/2017/05/19/anonymize-ip-geo-impact-test/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="haproxy">[haproxy]</dt>
        <dd>
<span class="refTitle">"HAProxy - The Reliable, High Performance TCP/HTTP Load Balancer"</span>, <span>&lt;<a href="https://www.haproxy.org/">https://www.haproxy.org/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Harvan">[Harvan]</dt>
        <dd>
<span class="refAuthor">Harvan, M.</span>, <span class="refTitle">"Prefix- and Lexicographical-order-preserving IP Address Anonymization"</span>, <span class="refContent">IEEE/IFIP Network Operations and Management
   Symposium</span>, <span class="seriesInfo">DOI 10.1109/NOMS.2006.1687580</span>, <time class="refDate" datetime="2006">2006</time>, <span>&lt;<a href="http://mharvan.net/talks/noms-ip_anon.pdf">http://mharvan.net/talks/noms-ip_anon.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Internet.nl">[Internet.nl]</dt>
        <dd>
<span class="refAuthor">Internet.nl</span>, <span class="refTitle">"Internet.nl Is Your Internet Up To Date?"</span>, <time class="refDate" datetime="2019">2019</time>, <span>&lt;<a href="https://internet.nl">https://internet.nl</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IP-Anonymization-in-Analytics">[IP-Anonymization-in-Analytics]</dt>
        <dd>
<span class="refAuthor">Google</span>, <span class="refTitle">"IP Anonymization in Analytics"</span>, <time class="refDate" datetime="2019">2019</time>, <span>&lt;<a href="https://support.google.com/analytics/answer/2763052?hl=en">https://support.google.com/analytics/answer/2763052?hl=en</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ipcipher1">[ipcipher1]</dt>
        <dd>
<span class="refAuthor">Hubert, B.</span>, <span class="refTitle">"On IP address encryption: security analysis with respect for privacy"</span>, <span class="refContent">Medium</span>, <time class="refDate" datetime="2017-05-07">7 May 2017</time>, <span>&lt;<a href="https://medium.com/@bert.hubert/on-ip-address-encryption-security-analysis-with-respect-for-privacy-dabe1201b476">https://medium.com/@bert.hubert/on-ip-address-encryption-security-analysis-with-respect-for-privacy-dabe1201b476</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ipcipher2">[ipcipher2]</dt>
        <dd>
<span class="refAuthor">PowerDNS</span>, <span class="refTitle">"ipcipher"</span>, <span class="seriesInfo">commit fd47abe</span>, <time class="refDate" datetime="2018-02-13">13 February 2018</time>, <span>&lt;<a href="https://github.com/PowerDNS/ipcipher">https://github.com/PowerDNS/ipcipher</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ipcrypt">[ipcrypt]</dt>
        <dd>
<span class="refAuthor">veorq</span>, <span class="refTitle">"ipcrypt: IP-format-preserving encryption"</span>, <span class="seriesInfo">commit 8cc12f9</span>, <time class="refDate" datetime="2015-07-06">6 July 2015</time>, <span>&lt;<a href="https://github.com/veorq/ipcrypt">https://github.com/veorq/ipcrypt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ipcrypt-analysis">[ipcrypt-analysis]</dt>
        <dd>
<span class="refAuthor">Aumasson, J-P.</span>, <span class="refTitle">"Subject: Re: [Cfrg] Analysis of ipcrypt?"</span>, <span class="refContent">message to the Cfrg mailing list</span>, <time class="refDate" datetime="2018-02-22">22 February 2018</time>, <span>&lt;<a href="https://mailarchive.ietf.org/arch/msg/cfrg/cFx5WJo48ZEN-a5cj_LlyrdN8-0/">https://mailarchive.ietf.org/arch/msg/cfrg/cFx5WJo48ZEN-a5cj_LlyrdN8-0/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ISC-Knowledge-database-on-cache-snooping">[ISC-Knowledge-database-on-cache-snooping]</dt>
        <dd>
<span class="refAuthor">Goldlust, S.</span><span class="refAuthor"> and C. Almond</span>, <span class="refTitle">"DNS Cache snooping - should I be concerned?"</span>, <span class="seriesInfo">ISC Knowledge Database</span>, <time class="refDate" datetime="2018-10-15">15 October 2018</time>, <span>&lt;<a href="https://kb.isc.org/docs/aa-00482">https://kb.isc.org/docs/aa-00482</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="MAC-address-EDNS">[MAC-address-EDNS]</dt>
        <dd>
<span class="refAuthor">Hubert, B.</span>, <span class="refTitle">"Embedding MAC address in DNS requests for selective filtering"</span>, <span class="seriesInfo">DNS-OARC mailing list</span>, <time class="refDate" datetime="2016-01-25">25 January 2016</time>, <span>&lt;<a href="https://lists.dns-oarc.net/pipermail/dns-operations/2016-January/014143.html">https://lists.dns-oarc.net/pipermail/dns-operations/2016-January/014143.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="nginx">[nginx]</dt>
        <dd>
<span class="refAuthor">nginx.org</span>, <span class="refTitle">"nginx news"</span>, <time class="refDate" datetime="2019">2019</time>, <span>&lt;<a href="https://nginx.org/">https://nginx.org/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Passive-Observations-of-a-Large-DNS">[Passive-Observations-of-a-Large-DNS]</dt>
        <dd>
<span class="refAuthor">de Vries, W. B.</span><span class="refAuthor">, van Rijswijk-Deij, R.</span><span class="refAuthor">, de Boer, P-T.</span><span class="refAuthor">, and A. Pras</span>, <span class="refTitle">"Passive Observations of a Large DNS Service: 2.5 Years in the Life of Google"</span>, <span class="seriesInfo">DOI 10.23919/TMA.2018.8506536</span>, <time class="refDate" datetime="2018">2018</time>, <span>&lt;<a href="http://tma.ifip.org/2018/wp-content/uploads/sites/3/2018/06/tma2018_paper30.pdf">http://tma.ifip.org/2018/wp-content/uploads/sites/3/2018/06/tma2018_paper30.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="pcap">[pcap]</dt>
        <dd>
<span class="refAuthor">The Tcpdump Group</span>, <span class="refTitle">"Tcpdump &amp; Libpcap"</span>, <time class="refDate" datetime="2020">2020</time>, <span>&lt;<a href="https://www.tcpdump.org/">https://www.tcpdump.org/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Pitfalls-of-DNS-Encryption">[Pitfalls-of-DNS-Encryption]</dt>
        <dd>
<span class="refAuthor">Shulman, H.</span>, <span class="refTitle">"Pretty Bad Privacy: Pitfalls of DNS Encryption"</span>, <span class="refContent">Proceedings of the 13th Workshop on Privacy in the
     Electronic Society, pp. 191-200</span>, <span class="seriesInfo">DOI 10.1145/2665943.2665959</span>, <time class="refDate" datetime="2014-11">November 2014</time>, <span>&lt;<a href="https://dl.acm.org/citation.cfm?id=2665959">https://dl.acm.org/citation.cfm?id=2665959</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="policy-comparison">[policy-comparison]</dt>
        <dd>
<span class="refAuthor">Dickinson, S.</span>, <span class="refTitle">"Comparison of policy and privacy statements 2019"</span>, <span class="refContent">DNS Privacy Project</span>, <time class="refDate" datetime="2019-12-18">18 December 2019</time>, <span>&lt;<a href="https://dnsprivacy.org/wiki/display/DP/Comparison+of+policy+and+privacy+statements+2019">https://dnsprivacy.org/wiki/display/DP/Comparison+of+policy+and+privacy+statements+2019</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="PowerDNS-dnswasher">[PowerDNS-dnswasher]</dt>
        <dd>
<span class="refAuthor">PowerDNS</span>, <span class="refTitle">"dnswasher"</span>, <span class="seriesInfo">commit 050e687</span>, <time class="refDate" datetime="2020-04-24">24 April 2020</time>, <span>&lt;<a href="https://github.com/PowerDNS/pdns/blob/master/pdns/dnswasher.cc">https://github.com/PowerDNS/pdns/blob/master/pdns/dnswasher.cc</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Ramaswamy-and-Wolf">[Ramaswamy-and-Wolf]</dt>
        <dd>
<span class="refAuthor">Ramaswamy, R.</span><span class="refAuthor"> and T. Wolf</span>, <span class="refTitle">"High-Speed Prefix-Preserving IP Address Anonymization for Passive Measurement Systems"</span>, <span class="seriesInfo">DOI 10.1109/TNET.2006.890128</span>, <time class="refDate" datetime="2007">2007</time>, <span>&lt;<a href="http://www.ecs.umass.edu/ece/wolf/pubs/ton2007.pdf">http://www.ecs.umass.edu/ece/wolf/pubs/ton2007.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4034">[RFC4034]</dt>
        <dd>
<span class="refAuthor">Arends, R.</span><span class="refAuthor">, Austein, R.</span><span class="refAuthor">, Larson, M.</span><span class="refAuthor">, Massey, D.</span><span class="refAuthor">, and S. Rose</span>, <span class="refTitle">"Resource Records for the DNS Security Extensions"</span>, <span class="seriesInfo">RFC 4034</span>, <span class="seriesInfo">DOI 10.17487/RFC4034</span>, <time class="refDate" datetime="2005-03">March 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4034">https://www.rfc-editor.org/info/rfc4034</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4035">[RFC4035]</dt>
        <dd>
<span class="refAuthor">Arends, R.</span><span class="refAuthor">, Austein, R.</span><span class="refAuthor">, Larson, M.</span><span class="refAuthor">, Massey, D.</span><span class="refAuthor">, and S. Rose</span>, <span class="refTitle">"Protocol Modifications for the DNS Security Extensions"</span>, <span class="seriesInfo">RFC 4035</span>, <span class="seriesInfo">DOI 10.17487/RFC4035</span>, <time class="refDate" datetime="2005-03">March 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4035">https://www.rfc-editor.org/info/rfc4035</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5077">[RFC5077]</dt>
        <dd>
<span class="refAuthor">Salowey, J.</span><span class="refAuthor">, Zhou, H.</span><span class="refAuthor">, Eronen, P.</span><span class="refAuthor">, and H. Tschofenig</span>, <span class="refTitle">"Transport Layer Security (TLS) Session Resumption without Server-Side State"</span>, <span class="seriesInfo">RFC 5077</span>, <span class="seriesInfo">DOI 10.17487/RFC5077</span>, <time class="refDate" datetime="2008-01">January 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5077">https://www.rfc-editor.org/info/rfc5077</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6147">[RFC6147]</dt>
        <dd>
<span class="refAuthor">Bagnulo, M.</span><span class="refAuthor">, Sullivan, A.</span><span class="refAuthor">, Matthews, P.</span><span class="refAuthor">, and I. van Beijnum</span>, <span class="refTitle">"DNS64: DNS Extensions for Network Address Translation from IPv6 Clients to IPv4 Servers"</span>, <span class="seriesInfo">RFC 6147</span>, <span class="seriesInfo">DOI 10.17487/RFC6147</span>, <time class="refDate" datetime="2011-04">April 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6147">https://www.rfc-editor.org/info/rfc6147</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6235">[RFC6235]</dt>
        <dd>
<span class="refAuthor">Boschi, E.</span><span class="refAuthor"> and B. Trammell</span>, <span class="refTitle">"IP Flow Anonymization Support"</span>, <span class="seriesInfo">RFC 6235</span>, <span class="seriesInfo">DOI 10.17487/RFC6235</span>, <time class="refDate" datetime="2011-05">May 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6235">https://www.rfc-editor.org/info/rfc6235</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6265">[RFC6265]</dt>
        <dd>
<span class="refAuthor">Barth, A.</span>, <span class="refTitle">"HTTP State Management Mechanism"</span>, <span class="seriesInfo">RFC 6265</span>, <span class="seriesInfo">DOI 10.17487/RFC6265</span>, <time class="refDate" datetime="2011-04">April 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6265">https://www.rfc-editor.org/info/rfc6265</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7626">[RFC7626]</dt>
        <dd>
<span class="refAuthor">Bortzmeyer, S.</span>, <span class="refTitle">"DNS Privacy Considerations"</span>, <span class="seriesInfo">RFC 7626</span>, <span class="seriesInfo">DOI 10.17487/RFC7626</span>, <time class="refDate" datetime="2015-08">August 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7626">https://www.rfc-editor.org/info/rfc7626</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7873">[RFC7873]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span><span class="refAuthor"> and M. Andrews</span>, <span class="refTitle">"Domain Name System (DNS) Cookies"</span>, <span class="seriesInfo">RFC 7873</span>, <span class="seriesInfo">DOI 10.17487/RFC7873</span>, <time class="refDate" datetime="2016-05">May 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7873">https://www.rfc-editor.org/info/rfc7873</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8027">[RFC8027]</dt>
        <dd>
<span class="refAuthor">Hardaker, W.</span><span class="refAuthor">, Gudmundsson, O.</span><span class="refAuthor">, and S. Krishnaswamy</span>, <span class="refTitle">"DNSSEC Roadblock Avoidance"</span>, <span class="seriesInfo">BCP 207</span>, <span class="seriesInfo">RFC 8027</span>, <span class="seriesInfo">DOI 10.17487/RFC8027</span>, <time class="refDate" datetime="2016-11">November 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8027">https://www.rfc-editor.org/info/rfc8027</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8094">[RFC8094]</dt>
        <dd>
<span class="refAuthor">Reddy, T.</span><span class="refAuthor">, Wing, D.</span><span class="refAuthor">, and P. Patil</span>, <span class="refTitle">"DNS over Datagram Transport Layer Security (DTLS)"</span>, <span class="seriesInfo">RFC 8094</span>, <span class="seriesInfo">DOI 10.17487/RFC8094</span>, <time class="refDate" datetime="2017-02">February 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8094">https://www.rfc-editor.org/info/rfc8094</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8404">[RFC8404]</dt>
        <dd>
<span class="refAuthor">Moriarty, K., Ed.</span><span class="refAuthor"> and A. Morton, Ed.</span>, <span class="refTitle">"Effects of Pervasive Encryption on Operators"</span>, <span class="seriesInfo">RFC 8404</span>, <span class="seriesInfo">DOI 10.17487/RFC8404</span>, <time class="refDate" datetime="2018-07">July 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8404">https://www.rfc-editor.org/info/rfc8404</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time class="refDate" datetime="2018-08">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8555">[RFC8555]</dt>
        <dd>
<span class="refAuthor">Barnes, R.</span><span class="refAuthor">, Hoffman-Andrews, J.</span><span class="refAuthor">, McCarney, D.</span><span class="refAuthor">, and J. Kasten</span>, <span class="refTitle">"Automatic Certificate Management Environment (ACME)"</span>, <span class="seriesInfo">RFC 8555</span>, <span class="seriesInfo">DOI 10.17487/RFC8555</span>, <time class="refDate" datetime="2019-03">March 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8555">https://www.rfc-editor.org/info/rfc8555</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8618">[RFC8618]</dt>
        <dd>
<span class="refAuthor">Dickinson, J.</span><span class="refAuthor">, Hague, J.</span><span class="refAuthor">, Dickinson, S.</span><span class="refAuthor">, Manderson, T.</span><span class="refAuthor">, and J. Bond</span>, <span class="refTitle">"Compacted-DNS (C-DNS): A Format for DNS Packet Capture"</span>, <span class="seriesInfo">RFC 8618</span>, <span class="seriesInfo">DOI 10.17487/RFC8618</span>, <time class="refDate" datetime="2019-09">September 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8618">https://www.rfc-editor.org/info/rfc8618</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SSL-Labs">[SSL-Labs]</dt>
        <dd>
<span class="refAuthor">SSL Labs</span>, <span class="refTitle">"SSL Server Test"</span>, <time class="refDate" datetime="2019">2019</time>, <span>&lt;<a href="https://www.ssllabs.com/ssltest/">https://www.ssllabs.com/ssltest/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="stunnel">[stunnel]</dt>
        <dd>
<span class="refAuthor">Goldlust, S.</span><span class="refAuthor">, Almond, C.</span><span class="refAuthor">, and F. Dupont</span>, <span class="refTitle">"DNS over TLS"</span>, <span class="refContent">ISC Knowledge Database"</span>, <time class="refDate" datetime="2018-11-01">1 November 2018</time>, <span>&lt;<a href="https://kb.isc.org/article/AA-01386/0/DNS-over-TLS.html">https://kb.isc.org/article/AA-01386/0/DNS-over-TLS.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SURFnet-policy">[SURFnet-policy]</dt>
        <dd>
<span class="refAuthor">Baartmans, C.</span><span class="refAuthor">, van Wynsberghe, A.</span><span class="refAuthor">, van Rijswijk-Deij, R.</span><span class="refAuthor">, and F. Jorna</span>, <span class="refTitle">"SURFnet Data Sharing Policy"</span>, <time class="refDate" datetime="2016-06">June 2016</time>, <span>&lt;<a href="https://surf.nl/datasharing">https://surf.nl/datasharing</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="tcpdpriv">[tcpdpriv]</dt>
        <dd>
<span class="refAuthor">Ipsilon Networks, Inc.</span>, <span class="refTitle">"TCPDRIV - Program for Eliminating Confidential Information from Traces"</span>, <time class="refDate" datetime="2004">2004</time>, <span>&lt;<a href="http://fly.isti.cnr.it/software/tcpdpriv/">http://fly.isti.cnr.it/software/tcpdpriv/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="van-Dijkhuizen-et-al">[van-Dijkhuizen-et-al]</dt>
        <dd>
<span class="refAuthor">Van Dijkhuizen, N.</span><span class="refAuthor"> and J. Van Der Ham</span>, <span class="refTitle">"A Survey of Network Traffic Anonymisation Techniques and Implementations"</span>, <span class="refContent">ACM Computing Surveys</span>, <span class="seriesInfo">DOI 10.1145/3182660</span>, <time class="refDate" datetime="2018-05">May 2018</time>, <span>&lt;<a href="https://doi.org/10.1145/3182660">https://doi.org/10.1145/3182660</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Xu-et-al">[Xu-et-al]</dt>
      <dd>
<span class="refAuthor">Fan, J.</span><span class="refAuthor">, Xu, J.</span><span class="refAuthor">, Ammar, M.H.</span><span class="refAuthor">, and S.B. Moon</span>, <span class="refTitle">"Prefix-preserving IP address anonymization: measurement-based security evaluation and a new cryptography-based scheme"</span>, <span class="seriesInfo">DOI 10.1016/j.comnet.2004.03.033</span>, <time class="refDate" datetime="2004">2004</time>, <span>&lt;<a href="http://an.kaist.ac.kr/~sbmoon/paper/intl-journal/2004-cn-anon.pdf">http://an.kaist.ac.kr/~sbmoon/paper/intl-journal/2004-cn-anon.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="documents">
<section id="section-appendix.a">
      <h2 id="name-documents">
<a class="section-number selfRef" href="#section-appendix.a">Appendix A. </a><a class="section-name selfRef" href="#name-documents">Documents</a>
      </h2>
<p id="section-appendix.a-1">

This section provides an overview of some DNS privacy-related
documents. However, this is neither an exhaustive list nor a
definitive statement on the characteristics of any document with 
regard to potential increases or decreases in DNS privacy.<a class="pilcrow" href="#section-appendix.a-1">¶</a></p>
<div id="potential-increases-in-dns-privacy">
<section id="section-a.1">
        <h2 id="name-potential-increases-in-dns-">
<a class="section-number selfRef" href="#section-a.1">A.1. </a><a class="section-name selfRef" href="#name-potential-increases-in-dns-">Potential Increases in DNS Privacy</a>
        </h2>
<p id="section-a.1-1">These documents are limited in scope to communications between stub
clients and recursive resolvers:<a class="pilcrow" href="#section-a.1-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-a.1-2.1">"Specification for DNS over Transport Layer Security (TLS)" <span>[<a class="xref" href="#RFC7858">RFC7858</a>]</span>.<a class="pilcrow" href="#section-a.1-2.1">¶</a>
</li>
          <li class="normal" id="section-a.1-2.2">"DNS over Datagram Transport Layer Security (DTLS)" <span>[<a class="xref" href="#RFC8094">RFC8094</a>]</span>. Note that this
document has the category of Experimental.<a class="pilcrow" href="#section-a.1-2.2">¶</a>
</li>
          <li class="normal" id="section-a.1-2.3">"DNS Queries over HTTPS (DoH)" <span>[<a class="xref" href="#RFC8484">RFC8484</a>]</span>.<a class="pilcrow" href="#section-a.1-2.3">¶</a>
</li>
          <li class="normal" id="section-a.1-2.4">"Usage Profiles for DNS over TLS and DNS over DTLS" <span>[<a class="xref" href="#RFC8310">RFC8310</a>]</span>.<a class="pilcrow" href="#section-a.1-2.4">¶</a>
</li>
          <li class="normal" id="section-a.1-2.5">"The EDNS(0) Padding Option" <span>[<a class="xref" href="#RFC7830">RFC7830</a>]</span> and "Padding Policies for Extension Mechanisms
   for DNS (EDNS(0))" <span>[<a class="xref" href="#RFC8467">RFC8467</a>]</span>.<a class="pilcrow" href="#section-a.1-2.5">¶</a>
</li>
        </ul>
<p id="section-a.1-3">These documents apply to recursive and authoritative DNS but are relevant
when
considering the operation of a recursive server:<a class="pilcrow" href="#section-a.1-3">¶</a></p>
<ul class="normal">
<li class="normal" id="section-a.1-4.1">"DNS Query Name Minimisation to Improve Privacy" <span>[<a class="xref" href="#RFC7816">RFC7816</a>]</span>.<a class="pilcrow" href="#section-a.1-4.1">¶</a>
</li>
        </ul>
</section>
</div>
<div id="potential-decreases-in-dns-privacy">
<section id="section-a.2">
        <h2 id="name-potential-decreases-in-dns-">
<a class="section-number selfRef" href="#section-a.2">A.2. </a><a class="section-name selfRef" href="#name-potential-decreases-in-dns-">Potential Decreases in DNS Privacy</a>
        </h2>
<p id="section-a.2-1">These documents relate to functionality that could provide increased
tracking of
user activity as a side effect:<a class="pilcrow" href="#section-a.2-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-a.2-2.1">"Client Subnet in DNS Queries" <span>[<a class="xref" href="#RFC7871">RFC7871</a>]</span>.<a class="pilcrow" href="#section-a.2-2.1">¶</a>
</li>
          <li class="normal" id="section-a.2-2.2">"Domain Name System (DNS) Cookies" <span>[<a class="xref" href="#RFC7873">RFC7873</a>]</span>).<a class="pilcrow" href="#section-a.2-2.2">¶</a>
</li>
          <li class="normal" id="section-a.2-2.3">"Transport Layer Security (TLS) Session Resumption without Server-Side
   State" <span>[<a class="xref" href="#RFC5077">RFC5077</a>]</span>, referred to here
   as simply TLS session resumption.<a class="pilcrow" href="#section-a.2-2.3">¶</a>
</li>
          <li class="normal" id="section-a.2-2.4">
            <span>[<a class="xref" href="#RFC8446">RFC8446</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc8446#appendix-C.4">Appendix C.4</a></span>
     describes client tracking prevention in TLS 1.3<a class="pilcrow" href="#section-a.2-2.4">¶</a>
</li>
          <li class="normal" id="section-a.2-2.5">"Compacted-DNS (C-DNS): A Format for DNS Packet Capture" <span>[<a class="xref" href="#RFC8618">RFC8618</a>]</span>.<a class="pilcrow" href="#section-a.2-2.5">¶</a>
</li>
          <li class="normal" id="section-a.2-2.6">Passive DNS <span>[<a class="xref" href="#RFC8499">RFC8499</a>]</span>.<a class="pilcrow" href="#section-a.2-2.6">¶</a>
</li>
          <li class="normal" id="section-a.2-2.7">
            <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8484#section-8">Section 8</a> of [<a class="xref" href="#RFC8484">RFC8484</a>]</span> outlines the privacy considerations
of DoH. Note that
(while that document advises exposing the minimal set of data needed to
achieve the desired feature set), depending on the specifics of a DoH
implementation, there may be increased identification and tracking compared to
other DNS transports.<a class="pilcrow" href="#section-a.2-2.7">¶</a>
</li>
        </ul>
</section>
</div>
<div id="related-operational-documents">
<section id="section-a.3">
        <h2 id="name-related-operational-documen">
<a class="section-number selfRef" href="#section-a.3">A.3. </a><a class="section-name selfRef" href="#name-related-operational-documen">Related Operational Documents</a>
        </h2>
<ul class="normal">
<li class="normal" id="section-a.3-1.1">"DNS Transport over TCP - Implementation Requirements" <span>[<a class="xref" href="#RFC7766">RFC7766</a>]</span>.<a class="pilcrow" href="#section-a.3-1.1">¶</a>
</li>
          <li class="normal" id="section-a.3-1.2">"DNS Transport over TCP - Operational Requirements"
<span>[<a class="xref" href="#I-D.ietf-dnsop-dns-tcp-requirements">DNS-OVER-TCP</a>]</span>.<a class="pilcrow" href="#section-a.3-1.2">¶</a>
</li>
          <li class="normal" id="section-a.3-1.3">"The edns-tcp-keepalive EDNS0 Option" <span>[<a class="xref" href="#RFC7828">RFC7828</a>]</span>.<a class="pilcrow" href="#section-a.3-1.3">¶</a>
</li>
          <li class="normal" id="section-a.3-1.4">"DNS Stateful Operations" <span>[<a class="xref" href="#RFC8490">RFC8490</a>]</span>.<a class="pilcrow" href="#section-a.3-1.4">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="ip-address-techniques">
<section id="section-appendix.b">
      <h2 id="name-ip-address-techniques">
<a class="section-number selfRef" href="#section-appendix.b">Appendix B. </a><a class="section-name selfRef" href="#name-ip-address-techniques">IP Address Techniques</a>
      </h2>
<p id="section-appendix.b-1">The following table presents a high-level comparison of various techniques
employed or under development in 2019 and classifies them according to
categorization of technique and other properties. Both the specific techniques
and the categorizations are described in more detail in the following
sections.
The list of techniques includes the main techniques in current use but does
not
claim to be comprehensive.<a class="pilcrow" href="#section-appendix.b-1">¶</a></p>
<span id="name-classification-of-technique"></span><table class="center" id="table-1">
        <caption>
<a class="selfRef" href="#table-1">Table 1</a>:
<a class="selfRef" href="#name-classification-of-technique">Classification of Techniques</a>
        </caption>
<thead>
          <tr>
            <th class="text-left" colspan="1" rowspan="1">Categorization/Property</th>
            <th class="text-center" colspan="1" rowspan="1">GA</th>
            <th class="text-center" colspan="1" rowspan="1">d</th>
            <th class="text-center" colspan="1" rowspan="1">TC</th>
            <th class="text-center" colspan="1" rowspan="1">C</th>
            <th class="text-center" colspan="1" rowspan="1">TS</th>
            <th class="text-center" colspan="1" rowspan="1">i</th>
            <th class="text-center" colspan="1" rowspan="1">B</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">Anonymization</td>
            <td class="text-center" colspan="1" rowspan="1">X</td>
            <td class="text-center" colspan="1" rowspan="1">X</td>
            <td class="text-center" colspan="1" rowspan="1">X</td>
            <td class="text-center" colspan="1" rowspan="1"></td>
            <td class="text-center" colspan="1" rowspan="1"></td>
            <td class="text-center" colspan="1" rowspan="1"></td>
            <td class="text-center" colspan="1" rowspan="1">X</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">Pseudonymization</td>
            <td class="text-center" colspan="1" rowspan="1"></td>
            <td class="text-center" colspan="1" rowspan="1"></td>
            <td class="text-center" colspan="1" rowspan="1"></td>
            <td class="text-center" colspan="1" rowspan="1">X</td>
            <td class="text-center" colspan="1" rowspan="1">X</td>
            <td class="text-center" colspan="1" rowspan="1">X</td>
            <td class="text-center" colspan="1" rowspan="1"></td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">Format
preserving</td>
            <td class="text-center" colspan="1" rowspan="1">X</td>
            <td class="text-center" colspan="1" rowspan="1">X</td>
            <td class="text-center" colspan="1" rowspan="1">X</td>
            <td class="text-center" colspan="1" rowspan="1">X</td>
            <td class="text-center" colspan="1" rowspan="1">X</td>
            <td class="text-center" colspan="1" rowspan="1">X</td>
            <td class="text-center" colspan="1" rowspan="1"></td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">Prefix preserving</td>
            <td class="text-center" colspan="1" rowspan="1"></td>
            <td class="text-center" colspan="1" rowspan="1"></td>
            <td class="text-center" colspan="1" rowspan="1">X</td>
            <td class="text-center" colspan="1" rowspan="1">X</td>
            <td class="text-center" colspan="1" rowspan="1">X</td>
            <td class="text-center" colspan="1" rowspan="1"></td>
            <td class="text-center" colspan="1" rowspan="1"></td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">Replacement</td>
            <td class="text-center" colspan="1" rowspan="1"></td>
            <td class="text-center" colspan="1" rowspan="1"></td>
            <td class="text-center" colspan="1" rowspan="1">X</td>
            <td class="text-center" colspan="1" rowspan="1"></td>
            <td class="text-center" colspan="1" rowspan="1"></td>
            <td class="text-center" colspan="1" rowspan="1"></td>
            <td class="text-center" colspan="1" rowspan="1"></td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">Filtering</td>
            <td class="text-center" colspan="1" rowspan="1">X</td>
            <td class="text-center" colspan="1" rowspan="1"></td>
            <td class="text-center" colspan="1" rowspan="1"></td>
            <td class="text-center" colspan="1" rowspan="1"></td>
            <td class="text-center" colspan="1" rowspan="1"></td>
            <td class="text-center" colspan="1" rowspan="1"></td>
            <td class="text-center" colspan="1" rowspan="1"></td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">Generalization</td>
            <td class="text-center" colspan="1" rowspan="1"></td>
            <td class="text-center" colspan="1" rowspan="1"></td>
            <td class="text-center" colspan="1" rowspan="1"></td>
            <td class="text-center" colspan="1" rowspan="1"></td>
            <td class="text-center" colspan="1" rowspan="1"></td>
            <td class="text-center" colspan="1" rowspan="1"></td>
            <td class="text-center" colspan="1" rowspan="1">X</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">Enumeration</td>
            <td class="text-center" colspan="1" rowspan="1"></td>
            <td class="text-center" colspan="1" rowspan="1">X</td>
            <td class="text-center" colspan="1" rowspan="1"></td>
            <td class="text-center" colspan="1" rowspan="1"></td>
            <td class="text-center" colspan="1" rowspan="1"></td>
            <td class="text-center" colspan="1" rowspan="1"></td>
            <td class="text-center" colspan="1" rowspan="1"></td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">Reordering/Shuffling</td>
            <td class="text-center" colspan="1" rowspan="1"></td>
            <td class="text-center" colspan="1" rowspan="1"></td>
            <td class="text-center" colspan="1" rowspan="1">X</td>
            <td class="text-center" colspan="1" rowspan="1"></td>
            <td class="text-center" colspan="1" rowspan="1"></td>
            <td class="text-center" colspan="1" rowspan="1"></td>
            <td class="text-center" colspan="1" rowspan="1"></td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">Random substitution</td>
            <td class="text-center" colspan="1" rowspan="1"></td>
            <td class="text-center" colspan="1" rowspan="1"></td>
            <td class="text-center" colspan="1" rowspan="1">X</td>
            <td class="text-center" colspan="1" rowspan="1"></td>
            <td class="text-center" colspan="1" rowspan="1"></td>
            <td class="text-center" colspan="1" rowspan="1"></td>
            <td class="text-center" colspan="1" rowspan="1"></td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">Cryptographic
permutation</td>
            <td class="text-center" colspan="1" rowspan="1"></td>
            <td class="text-center" colspan="1" rowspan="1"></td>
            <td class="text-center" colspan="1" rowspan="1"></td>
            <td class="text-center" colspan="1" rowspan="1">X</td>
            <td class="text-center" colspan="1" rowspan="1">X</td>
            <td class="text-center" colspan="1" rowspan="1">X</td>
            <td class="text-center" colspan="1" rowspan="1"></td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">IPv6 issues</td>
            <td class="text-center" colspan="1" rowspan="1"></td>
            <td class="text-center" colspan="1" rowspan="1"></td>
            <td class="text-center" colspan="1" rowspan="1"></td>
            <td class="text-center" colspan="1" rowspan="1"></td>
            <td class="text-center" colspan="1" rowspan="1">X</td>
            <td class="text-center" colspan="1" rowspan="1"></td>
            <td class="text-center" colspan="1" rowspan="1"></td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">CPU intensive</td>
            <td class="text-center" colspan="1" rowspan="1"></td>
            <td class="text-center" colspan="1" rowspan="1"></td>
            <td class="text-center" colspan="1" rowspan="1"></td>
            <td class="text-center" colspan="1" rowspan="1">X</td>
            <td class="text-center" colspan="1" rowspan="1"></td>
            <td class="text-center" colspan="1" rowspan="1"></td>
            <td class="text-center" colspan="1" rowspan="1"></td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">Memory intensive</td>
            <td class="text-center" colspan="1" rowspan="1"></td>
            <td class="text-center" colspan="1" rowspan="1"></td>
            <td class="text-center" colspan="1" rowspan="1">X</td>
            <td class="text-center" colspan="1" rowspan="1"></td>
            <td class="text-center" colspan="1" rowspan="1"></td>
            <td class="text-center" colspan="1" rowspan="1"></td>
            <td class="text-center" colspan="1" rowspan="1"></td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">Security concerns</td>
            <td class="text-center" colspan="1" rowspan="1"></td>
            <td class="text-center" colspan="1" rowspan="1"></td>
            <td class="text-center" colspan="1" rowspan="1"></td>
            <td class="text-center" colspan="1" rowspan="1"></td>
            <td class="text-center" colspan="1" rowspan="1"></td>
            <td class="text-center" colspan="1" rowspan="1">X</td>
            <td class="text-center" colspan="1" rowspan="1"></td>
          </tr>
        </tbody>
      </table>
<p id="section-appendix.b-3">Legend of techniques:<a class="pilcrow" href="#section-appendix.b-3">¶</a></p>
<span class="break"></span><dl class="dlParallel dlCompact" id="section-appendix.b-4">
        <dt id="section-appendix.b-4.1">GA</dt>
        <dd id="section-appendix.b-4.2" style="margin-left: 2.5em">= Google Analytics<a class="pilcrow" href="#section-appendix.b-4.2">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-appendix.b-4.3">d</dt>
        <dd id="section-appendix.b-4.4" style="margin-left: 2.5em">= dnswasher<a class="pilcrow" href="#section-appendix.b-4.4">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-appendix.b-4.5">TC</dt>
        <dd id="section-appendix.b-4.6" style="margin-left: 2.5em">= TCPdpriv<a class="pilcrow" href="#section-appendix.b-4.6">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-appendix.b-4.7">C</dt>
        <dd id="section-appendix.b-4.8" style="margin-left: 2.5em">= CryptoPAn<a class="pilcrow" href="#section-appendix.b-4.8">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-appendix.b-4.9">TS</dt>
        <dd id="section-appendix.b-4.10" style="margin-left: 2.5em">= TSA<a class="pilcrow" href="#section-appendix.b-4.10">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-appendix.b-4.11">i</dt>
        <dd id="section-appendix.b-4.12" style="margin-left: 2.5em">= ipcipher<a class="pilcrow" href="#section-appendix.b-4.12">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-appendix.b-4.13">B</dt>
        <dd id="section-appendix.b-4.14" style="margin-left: 2.5em">= Bloom filter<a class="pilcrow" href="#section-appendix.b-4.14">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-appendix.b-5">The choice of which method to use for a particular application will depend
on
the requirements of that application and consideration of the threat analysis
of
the particular situation.<a class="pilcrow" href="#section-appendix.b-5">¶</a></p>
<p id="section-appendix.b-6">For example, a common goal is that distributed packet captures must be in
      an existing data format, such as PCAP <span>[<a class="xref" href="#pcap">pcap</a>]</span> or Compacted-DNS (C-DNS) <span>[<a class="xref" href="#RFC8618">RFC8618</a>]</span>, that can be used
      as input to existing analysis tools. In that case, use of a format-preserving
      technique is essential. This, though, is not cost free; several authors
      (e.g., <span>[<a class="xref" href="#Brekne-and-Arnes">Brekne-and-Arnes</a>]</span>) have observed
      that, as the entropy in an IPv4 address is limited, if an attacker can<a class="pilcrow" href="#section-appendix.b-6">¶</a></p>
<ul class="normal">
<li class="normal" id="section-appendix.b-7.1">ensure packets are captured by the target and<a class="pilcrow" href="#section-appendix.b-7.1">¶</a>
</li>
        <li class="normal" id="section-appendix.b-7.2">send forged traffic with arbitrary source and destination addresses to that
target and<a class="pilcrow" href="#section-appendix.b-7.2">¶</a>
</li>
        <li class="normal" id="section-appendix.b-7.3">obtain a de-identified log of said traffic from that target,<a class="pilcrow" href="#section-appendix.b-7.3">¶</a>
</li>
      </ul>
<p id="section-appendix.b-8">any format-preserving pseudonymization is vulnerable to an attack along the
lines of a cryptographic chosen-plaintext attack.<a class="pilcrow" href="#section-appendix.b-8">¶</a></p>
<div id="categorization-of-techniques">
<section id="section-b.1">
        <h2 id="name-categorization-of-technique">
<a class="section-number selfRef" href="#section-b.1">B.1. </a><a class="section-name selfRef" href="#name-categorization-of-technique">Categorization of Techniques</a>
        </h2>
<p id="section-b.1-1">Data minimization methods may be categorized by the processing used and the
properties of their outputs. The following builds on the categorization
employed in <span>[<a class="xref" href="#RFC6235">RFC6235</a>]</span>:<a class="pilcrow" href="#section-b.1-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-b.1-2">
          <dt id="section-b.1-2.1">Format-preserving.</dt>
          <dd id="section-b.1-2.2" style="margin-left: 1.5em"> Normally, when encrypting, the original data length and
patterns in the data should be hidden from an attacker. Some applications of
de-identification, such as network capture de-identification, require that the
de-identified data is of the same form as the original data, to allow the data
to be parsed in the same way as the original.<a class="pilcrow" href="#section-b.1-2.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-b.1-2.3">Prefix preservation.</dt>
          <dd id="section-b.1-2.4" style="margin-left: 1.5em"> Values such as IP addresses and MAC addresses contain
prefix information that can be valuable in analysis -- e.g., manufacturer ID in
MAC addresses, or subnet in IP addresses. Prefix preservation ensures that
prefixes are de-identified consistently; for example, if two IP addresses are from
the
same subnet, a prefix preserving de-identification will ensure that their
de-identified counterparts will also share a subnet. Prefix preservation may
be fixed (i.e., based on a user-selected prefix length identified in advance to
be preserved ) or general.<a class="pilcrow" href="#section-b.1-2.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-b.1-2.5">Replacement.</dt>
          <dd id="section-b.1-2.6" style="margin-left: 1.5em"> A one-to-one replacement of a field to a new value of the same
type -- for example, using a regular expression.<a class="pilcrow" href="#section-b.1-2.6">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-b.1-2.7">Filtering.</dt>
          <dd id="section-b.1-2.8" style="margin-left: 1.5em"> Removing or replacing data in a field. Field
data can be overwritten, often with zeros, either partially (truncation or
reverse truncation) or
completely (black-marker anonymization).<a class="pilcrow" href="#section-b.1-2.8">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-b.1-2.9">Generalization.</dt>
          <dd id="section-b.1-2.10" style="margin-left: 1.5em"> Data is replaced by more general data with reduced
specificity. One example would be to replace all TCP/UDP port numbers with one
of two fixed values indicating whether the original port was ephemeral
(&gt;=1024) or nonephemeral (&gt;1024). Another example, precision
degradation,
reduces the accuracy of, for example, a numeric value or a timestamp.<a class="pilcrow" href="#section-b.1-2.10">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-b.1-2.11">Enumeration.</dt>
          <dd id="section-b.1-2.12" style="margin-left: 1.5em"> With data from a well-ordered set, replace
   the first data item's data using a random initial value and then
   allocate ordered values for
   subsequent data items. When used with timestamp data, this preserves ordering
   but loses precision and distance.<a class="pilcrow" href="#section-b.1-2.12">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-b.1-2.13">Reordering/shuffling.</dt>
          <dd id="section-b.1-2.14" style="margin-left: 1.5em"> Preserving the original data, but rearranging its
order,
often in a random manner.<a class="pilcrow" href="#section-b.1-2.14">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-b.1-2.15">Random substitution.</dt>
          <dd id="section-b.1-2.16" style="margin-left: 1.5em"> As replacement, but using randomly generated
replacement
values.<a class="pilcrow" href="#section-b.1-2.16">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-b.1-2.17">Cryptographic permutation.</dt>
          <dd id="section-b.1-2.18" style="margin-left: 1.5em"> Using a permutation function, such as a hash
function or cryptographic block cipher, to generate a replacement
de-identified value.<a class="pilcrow" href="#section-b.1-2.18">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="specific-techniques">
<section id="section-b.2">
        <h2 id="name-specific-techniques">
<a class="section-number selfRef" href="#section-b.2">B.2. </a><a class="section-name selfRef" href="#name-specific-techniques">Specific Techniques</a>
        </h2>
<div id="google-analytics-nonprefix-filtering">
<section id="section-b.2.1">
          <h3 id="name-google-analytics-non-prefix">
<a class="section-number selfRef" href="#section-b.2.1">B.2.1. </a><a class="section-name selfRef" href="#name-google-analytics-non-prefix">Google Analytics Non-Prefix Filtering</a>
          </h3>
<p id="section-b.2.1-1">Since May 2010, Google Analytics has provided a facility <span>[<a class="xref" href="#IP-Anonymization-in-Analytics">IP-Anonymization-in-Analytics</a>]</span> that allows website
owners to request that all their users' IP addresses are anonymized within
Google Analytics processing. This very basic anonymization simply sets to zero
the least significant 8 bits of IPv4 addresses, and the least significant 80
bits of IPv6 addresses. The level of anonymization this produces is perhaps
questionable. There are some analysis results <span>[<a class="xref" href="#Geolocation-Impact-Assessment">Geolocation-Impact-Assessment</a>]</span> that suggest that the impact of
this on reducing the accuracy of determining the user's location from their IP
address is less than might be hoped; the average discrepancy in identification
of the user city for UK users is no more than 17%.<a class="pilcrow" href="#section-b.2.1-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-b.2.1-2">
            <dt id="section-b.2.1-2.1">Anonymization:</dt>
            <dd id="section-b.2.1-2.2" style="margin-left: 1.5em"> Format-preserving, Filtering (truncation).<a class="pilcrow" href="#section-b.2.1-2.2">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="dnswasher">
<section id="section-b.2.2">
          <h3 id="name-dnswasher">
<a class="section-number selfRef" href="#section-b.2.2">B.2.2. </a><a class="section-name selfRef" href="#name-dnswasher">dnswasher</a>
          </h3>
<p id="section-b.2.2-1">Since 2006, PowerDNS has included a de-identification tool, dnswasher
<span>[<a class="xref" href="#PowerDNS-dnswasher">PowerDNS-dnswasher</a>]</span>, with their PowerDNS
product. This is a
PCAP filter that
performs a one-to-one mapping of end-user IP addresses with an anonymized
address. A table of user IP addresses and their de-identified counterparts is
kept; the first IPv4 user addresses is translated to 0.0.0.1, the second to
0.0.0.2, and so on. The de-identified address therefore depends on the order
that
addresses arrive in the input, and when running over a large amount of data, the
address translation tables can grow to a significant size.<a class="pilcrow" href="#section-b.2.2-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-b.2.2-2">
            <dt id="section-b.2.2-2.1">Anonymization:</dt>
            <dd id="section-b.2.2-2.2" style="margin-left: 1.5em"> Format-preserving, Enumeration.<a class="pilcrow" href="#section-b.2.2-2.2">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="prefixpreserving-map">
<section id="section-b.2.3">
          <h3 id="name-prefix-preserving-map">
<a class="section-number selfRef" href="#section-b.2.3">B.2.3. </a><a class="section-name selfRef" href="#name-prefix-preserving-map">Prefix-Preserving Map</a>
          </h3>
<p id="section-b.2.3-1">Used in <span>[<a class="xref" href="#tcpdpriv">tcpdpriv</a>]</span>,
this algorithm stores a set of original and anonymized IP
address pairs. When a new IP address arrives, it is compared with previous
addresses to determine the longest prefix match. The new address is anonymized
by using the same prefix, with the remainder of the address anonymized with a
random value. The use of a random value means that TCPdpriv is not
deterministic; different anonymized values will be generated on each run. 

The need to store previous addresses means that TCPdpriv has significant and
unbounded memory requirements. The need to allocate anonymized addresses
sequentially means that TCPdpriv cannot be used in parallel processing.<a class="pilcrow" href="#section-b.2.3-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-b.2.3-2">
            <dt id="section-b.2.3-2.1">Anonymization:</dt>
            <dd id="section-b.2.3-2.2" style="margin-left: 1.5em"> Format-preserving, prefix preservation (general).<a class="pilcrow" href="#section-b.2.3-2.2">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="cryptographic-prefixpreserving-pseudonymization">
<section id="section-b.2.4">
          <h3 id="name-cryptographic-prefix-preser">
<a class="section-number selfRef" href="#section-b.2.4">B.2.4. </a><a class="section-name selfRef" href="#name-cryptographic-prefix-preser">Cryptographic Prefix-Preserving Pseudonymization</a>
          </h3>
<p id="section-b.2.4-1">Cryptographic prefix-preserving pseudonymization was originally proposed as
an
improvement to the prefix-preserving map implemented in TCPdpriv, described in
<span>[<a class="xref" href="#Xu-et-al">Xu-et-al</a>]</span> and implemented in the <span>[<a class="xref" href="#Crypto-PAn">Crypto-PAn</a>]</span>
tool.
Crypto-PAn is now frequently
used as an acronym for the algorithm. Initially, it was described for IPv4
addresses only; extension for IPv6 addresses was proposed in <span>[<a class="xref" href="#Harvan">Harvan</a>]</span>. This uses a cryptographic algorithm
rather than a random value, and thus pseudonymity is determined uniquely by
the
encryption key, and is deterministic. It requires a separate AES encryption
for
each output bit and so has a nontrivial calculation overhead. This can be
mitigated to some extent (for IPv4, at least) by precalculating results for
some number of prefix bits.<a class="pilcrow" href="#section-b.2.4-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-b.2.4-2">
            <dt id="section-b.2.4-2.1">Pseudonymization:</dt>
            <dd id="section-b.2.4-2.2" style="margin-left: 1.5em"> Format-preserving, prefix preservation (general).<a class="pilcrow" href="#section-b.2.4-2.2">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="tophash-subtreereplicated-anonymization">
<section id="section-b.2.5">
          <h3 id="name-top-hash-subtree-replicated">
<a class="section-number selfRef" href="#section-b.2.5">B.2.5. </a><a class="section-name selfRef" href="#name-top-hash-subtree-replicated">Top-Hash Subtree-Replicated Anonymization</a>
          </h3>
<p id="section-b.2.5-1">Proposed in <span>[<a class="xref" href="#Ramaswamy-and-Wolf">Ramaswamy-and-Wolf</a>]</span>,
Top-hash Subtree-replicated Anonymization (TSA)
originated in response to the requirement for faster processing than
Crypto-PAn.
It used hashing for the most significant byte of an IPv4 address and a
precalculated binary-tree structure for the remainder of the address. 

To save
memory space, replication is used within the tree structure, reducing the size
of the precalculated structures to a few megabytes for IPv4 addresses. Address
pseudonymization is done via hash and table lookup and so requires minimal
computation. However, due to the much-increased address space for IPv6, TSA is
not memory efficient for IPv6.<a class="pilcrow" href="#section-b.2.5-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-b.2.5-2">
            <dt id="section-b.2.5-2.1">Pseudonymization:</dt>
            <dd id="section-b.2.5-2.2" style="margin-left: 1.5em"> Format-preserving, prefix preservation (general).<a class="pilcrow" href="#section-b.2.5-2.2">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="ipcipher">
<section id="section-b.2.6">
          <h3 id="name-ipcipher">
<a class="section-number selfRef" href="#section-b.2.6">B.2.6. </a><a class="section-name selfRef" href="#name-ipcipher">ipcipher</a>
          </h3>
<p id="section-b.2.6-1">A recently released proposal from PowerDNS, ipcipher
<span>[<a class="xref" href="#ipcipher1">ipcipher1</a>]</span> <span>[<a class="xref" href="#ipcipher2">ipcipher2</a>]</span>, is a simple
pseudonymization technique for IPv4 and IPv6 addresses. IPv6 addresses are
encrypted directly with AES-128 using a key (which may be derived from a
passphrase). IPv4 addresses are similarly encrypted, but using a recently
proposed encryption <span>[<a class="xref" href="#ipcrypt">ipcrypt</a>]</span> suitable for
32-bit block lengths. However, the author of ipcrypt has since indicated <span>[<a class="xref" href="#ipcrypt-analysis">ipcrypt-analysis</a>]</span> that it has
low security, and further analysis has revealed it is vulnerable to attack.<a class="pilcrow" href="#section-b.2.6-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-b.2.6-2">
            <dt id="section-b.2.6-2.1">Pseudonymization:</dt>
            <dd id="section-b.2.6-2.2" style="margin-left: 1.5em">Format-preserving, cryptographic permutation.<a class="pilcrow" href="#section-b.2.6-2.2">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="bloom-filters">
<section id="section-b.2.7">
          <h3 id="name-bloom-filters">
<a class="section-number selfRef" href="#section-b.2.7">B.2.7. </a><a class="section-name selfRef" href="#name-bloom-filters">Bloom Filters</a>
          </h3>
<p id="section-b.2.7-1">van Rijswijk-Deij et al.
have recently described work using Bloom Filters <span>[<a class="xref" href="#Bloom-filter">Bloom-filter</a>]</span>
to
categorize query traffic and record the traffic as the state of multiple
filters. The goal of this work is to allow operators to identify so-called
Indicators of Compromise (IOCs) originating from specific subnets without
storing information about, or being able to monitor, the DNS queries of an
individual user. By using a Bloom Filter, it is possible to determine with a
high probability if, for example, a particular query was made, but the set of
queries made cannot be recovered from the filter. Similarly, by mixing queries
from a sufficient number of users in a single filter, it becomes practically
impossible to determine if a particular user performed a particular
query. Large
numbers of queries can be tracked in a memory-efficient way. As filter status
is
stored, this approach cannot be used to regenerate traffic and so cannot be
used with tools used to process live traffic.<a class="pilcrow" href="#section-b.2.7-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-b.2.7-2">
            <dt id="section-b.2.7-2.1">Anonymized:</dt>
            <dd id="section-b.2.7-2.2" style="margin-left: 1.5em"> Generalization.<a class="pilcrow" href="#section-b.2.7-2.2">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="current-policy-and-privacy-statements">
<section id="section-appendix.c">
      <h2 id="name-current-policy-and-privacy-">
<a class="section-number selfRef" href="#section-appendix.c">Appendix C. </a><a class="section-name selfRef" href="#name-current-policy-and-privacy-">Current Policy and Privacy Statements</a>
      </h2>
<p id="section-appendix.c-1">A tabular comparison of policy and privacy statements from various DNS
      privacy service operators based loosely on the proposed RPS structure can
      be found at <span>[<a class="xref" href="#policy-comparison">policy-comparison</a>]</span>. The
      analysis is based on the data available in December 2019.<a class="pilcrow" href="#section-appendix.c-1">¶</a></p>
<p id="section-appendix.c-2">We note that the existing policies vary widely in style, content, and
detail, and it is not uncommon for the full text for a given operator to
equate to more than 10 pages (A4 size) of text in a moderate-sized font. It is a
nontrivial task today for a user to extract a meaningful overview of the
different services on offer.<a class="pilcrow" href="#section-appendix.c-2">¶</a></p>
<p id="section-appendix.c-3">It is also noted that Mozilla has published a DoH resolver policy
<span>[<a class="xref" href="#DoH-resolver-policy">DoH-resolver-policy</a>]</span> that describes the minimum set of
policy
requirements that a party must satisfy to be considered as a potential
partner for Mozilla's Trusted Recursive Resolver (TRR) program.<a class="pilcrow" href="#section-appendix.c-3">¶</a></p>
</section>
</div>
<div id="example-rps">
<section id="section-appendix.d">
      <h2 id="name-example-rps">
<a class="section-number selfRef" href="#section-appendix.d">Appendix D. </a><a class="section-name selfRef" href="#name-example-rps">Example RPS</a>
      </h2>
<p id="section-appendix.d-1">The following example RPS is very loosely based on some elements of
published privacy statements for some public resolvers, with additional fields
populated to illustrate what the full contents of an RPS might
look like. This should not be interpreted as<a class="pilcrow" href="#section-appendix.d-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-appendix.d-2.1">having been reviewed or approved by any operator in any way<a class="pilcrow" href="#section-appendix.d-2.1">¶</a>
</li>
        <li class="normal" id="section-appendix.d-2.2">having any legal standing or validity at all<a class="pilcrow" href="#section-appendix.d-2.2">¶</a>
</li>
        <li class="normal" id="section-appendix.d-2.3">being complete or exhaustive<a class="pilcrow" href="#section-appendix.d-2.3">¶</a>
</li>
      </ul>
<p id="section-appendix.d-3">This is a purely hypothetical example of an RPS to outline example
contents -- in this case, for a public resolver operator providing a basic DNS
Privacy service via one IP address and one DoH URI with security-based
filtering. It does aim to meet minimal compliance as specified in
<a class="xref" href="#recommendations-for-dns-privacy-services">Section 5</a>.<a class="pilcrow" href="#section-appendix.d-3">¶</a></p>
<div id="policy-1">
<section id="section-d.1">
        <h2 id="name-policy-2">
<a class="section-number selfRef" href="#section-d.1">D.1. </a><a class="section-name selfRef" href="#name-policy-2">Policy</a>
        </h2>
<ol class="normal type-1" id="section-d.1-1" start="1" type="1">
          <li id="section-d.1-1.1">Treatment of IP addresses. Many nations classify IP addresses as personal
data, and we take a conservative approach in treating IP addresses as personal
data in all jurisdictions in which our systems reside.<a class="pilcrow" href="#section-d.1-1.1">¶</a>
</li>
          <li id="section-d.1-1.2">
            <p id="section-d.1-1.2.1">Data collection and sharing.<a class="pilcrow" href="#section-d.1-1.2.1">¶</a></p>
<ol class="normal type-a" id="section-d.1-1.2.2" start="1" type="a">
              <li id="section-d.1-1.2.2.1">IP addresses. Our normal course of data management does
not have any IP address information or other personal data logged to disk or
transmitted out of the location in which the query was received. We may
aggregate certain counters to larger network block levels for
statistical collection purposes, but those counters do not maintain specific
IP address data, nor is the format or model of data stored capable of being
reverse-engineered to ascertain what specific IP addresses made what
queries.<a class="pilcrow" href="#section-d.1-1.2.2.1">¶</a>
</li>
              <li id="section-d.1-1.2.2.2">
                <p id="section-d.1-1.2.2.2.1">Data collected in logs. We do keep some generalized
 location information
 (at the city / metropolitan-area level) so that we can conduct debugging and
 analyze abuse phenomena. We also use the collected information for the
 creation and sharing of telemetry (timestamp, geolocation, number of hits,
 first seen, last seen) for contributors, public publishing of general
 statistics of system use (protections, threat types, counts, etc.).
 When you use our DNS services, here is the full list of items that are
 included in our logs:<a class="pilcrow" href="#section-d.1-1.2.2.2.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-d.1-1.2.2.2.2.1">Requested domain name -- e.g., example.net<a class="pilcrow" href="#section-d.1-1.2.2.2.2.1">¶</a>
</li>
                  <li class="normal" id="section-d.1-1.2.2.2.2.2">Record type of requested domain -- e.g., A, AAAA, NS,
   MX, TXT, etc.<a class="pilcrow" href="#section-d.1-1.2.2.2.2.2">¶</a>
</li>
                  <li class="normal" id="section-d.1-1.2.2.2.2.3">
                    <p id="section-d.1-1.2.2.2.2.3.1">Transport protocol on which the request arrived --
     i.e., UDP, TCP, DoT, DoH<a class="pilcrow" href="#section-d.1-1.2.2.2.2.3.1">¶</a></p>
</li>
                  <li class="normal" id="section-d.1-1.2.2.2.2.4">Origin IP general geolocation information -- i.e., geocode, region ID,
   city ID, and metro code<a class="pilcrow" href="#section-d.1-1.2.2.2.2.4">¶</a>
</li>
                  <li class="normal" id="section-d.1-1.2.2.2.2.5">IP protocol version -- IPv4 or IPv6<a class="pilcrow" href="#section-d.1-1.2.2.2.2.5">¶</a>
</li>
                  <li class="normal" id="section-d.1-1.2.2.2.2.6">Response code sent -- e.g., SUCCESS, SERVFAIL, NXDOMAIN, etc.<a class="pilcrow" href="#section-d.1-1.2.2.2.2.6">¶</a>
</li>
                  <li class="normal" id="section-d.1-1.2.2.2.2.7">Absolute arrival time using a precision in ms<a class="pilcrow" href="#section-d.1-1.2.2.2.2.7">¶</a>
</li>
                  <li class="normal" id="section-d.1-1.2.2.2.2.8">Name of the specific instance that processed this request<a class="pilcrow" href="#section-d.1-1.2.2.2.2.8">¶</a>
</li>
                  <li class="normal" id="section-d.1-1.2.2.2.2.9">IP address of the specific instance to which this request was
addressed (no relation to the requestor's IP address)<a class="pilcrow" href="#section-d.1-1.2.2.2.2.9">¶</a>
</li>
                </ul>
<p id="section-d.1-1.2.2.2.3">
We may keep the following data as summary information, including all the
above EXCEPT for data about the DNS record requested:<a class="pilcrow" href="#section-d.1-1.2.2.2.3">¶</a></p>
<ul class="normal">
<li class="normal" id="section-d.1-1.2.2.2.4.1">Currently advertised BGP-summarized IP prefix/netmask of apparent
client origin<a class="pilcrow" href="#section-d.1-1.2.2.2.4.1">¶</a>
</li>
                  <li class="normal" id="section-d.1-1.2.2.2.4.2">Autonomous system number (BGP ASN) of apparent client origin<a class="pilcrow" href="#section-d.1-1.2.2.2.4.2">¶</a>
</li>
                </ul>
<p id="section-d.1-1.2.2.2.5">
All the above data may be kept in full or partial form in permanent
archives.<a class="pilcrow" href="#section-d.1-1.2.2.2.5">¶</a></p>
</li>
              <li id="section-d.1-1.2.2.3">Sharing of data.
Except as described in this document, we do not intentionally share,
sell, or rent individual personal information associated with the
requestor (i.e., source IP address or any other information that can
positively identify the client using our infrastructure) with anyone
without your consent.
We generate and share high-level anonymized aggregate statistics,
including threat metrics on threat type, geolocation, and if available,
sector, as well as other vertical metrics, including performance metrics
on our DNS Services (i.e., number of threats blocked, infrastructure
uptime) when available with our Threat Intelligence (TI) partners,
academic researchers, or the public.
Our DNS services share anonymized data on specific domains queried
(records such as domain, timestamp, geolocation, number of hits, first
seen, last seen) with our Threat Intelligence partners. Our DNS service
also builds, stores, and may share certain DNS data streams which store
high level information about domain resolved, query types, result codes,
and timestamp. These streams do not contain the IP address information of
the requestor and cannot be correlated to IP address or other personal data.
We do not and never will share any of the requestor's data with marketers, nor will
we use this data for demographic analysis.<a class="pilcrow" href="#section-d.1-1.2.2.3">¶</a>
</li>
            </ol>
</li>
          <li id="section-d.1-1.3">Exceptions. There are exceptions to this storage model: In the event of
actions or observed behaviors that we deem malicious or anomalous, we may
utilize more detailed logging to collect more specific IP address data in the
process of normal network defense and mitigation. This collection and
transmission off-site will be limited to IP addresses that we determine are
involved in the event.<a class="pilcrow" href="#section-d.1-1.3">¶</a>
</li>
          <li id="section-d.1-1.4">Associated entities. Details of our Threat Intelligence partners can be
found
at our website page (insert link).<a class="pilcrow" href="#section-d.1-1.4">¶</a>
</li>
          <li id="section-d.1-1.5">Correlation of Data. We do not correlate or combine information from our
logs
with any personal information that you have provided us for other services, or
with your specific IP address.<a class="pilcrow" href="#section-d.1-1.5">¶</a>
</li>
          <li id="section-d.1-1.6">
            <p id="section-d.1-1.6.1">Result filtering.<a class="pilcrow" href="#section-d.1-1.6.1">¶</a></p>
<ol class="normal type-a" id="section-d.1-1.6.2" start="1" type="a">
              <li id="section-d.1-1.6.2.1">
                <p id="section-d.1-1.6.2.1.1">Filtering. We utilize cyber-threat intelligence about
 malicious domains
 from a variety of public and private sources and block access to those
 malicious domains when your system attempts to contact
 them. An NXDOMAIN is
 returned for blocked sites.<a class="pilcrow" href="#section-d.1-1.6.2.1.1">¶</a></p>
<ol class="normal type-i" id="section-d.1-1.6.2.1.2" start="1" type="i">
                  <li id="section-d.1-1.6.2.1.2.1">Censorship. We will not provide a censoring component and will limit our
actions solely to the blocking of malicious domains around phishing,
malware, and exploit-kit domains.<a class="pilcrow" href="#section-d.1-1.6.2.1.2.1">¶</a>
</li>
                  <li id="section-d.1-1.6.2.1.2.2">Accidental blocking. We implement allowlisting algorithms to make sure
legitimate domains are not blocked by accident. However, in the rare case of
blocking a legitimate domain, we work with the users to quickly allowlist
that domain. Please use our support form (insert link) if you believe we are
blocking a domain in error.<a class="pilcrow" href="#section-d.1-1.6.2.1.2.2">¶</a>
</li>
                </ol>
</li>
            </ol>
</li>
        </ol>
</section>
</div>
<div id="practice-1">
<section id="section-d.2">
        <h2 id="name-practice-2">
<a class="section-number selfRef" href="#section-d.2">D.2. </a><a class="section-name selfRef" href="#name-practice-2">Practice</a>
        </h2>
<ol class="normal type-1" id="section-d.2-1" start="1" type="1">
          <li id="section-d.2-1.1">Deviations from Policy. None in place since (insert date).<a class="pilcrow" href="#section-d.2-1.1">¶</a>
</li>
          <li id="section-d.2-1.2">
            <p id="section-d.2-1.2.1">Client-facing capabilities.<a class="pilcrow" href="#section-d.2-1.2.1">¶</a></p>
<ol class="normal type-a" id="section-d.2-1.2.2" start="1" type="a">
              <li id="section-d.2-1.2.2.1">We offer UDP and TCP DNS on port 53 on (insert IP address)<a class="pilcrow" href="#section-d.2-1.2.2.1">¶</a>
</li>
              <li id="section-d.2-1.2.2.2">
                <p id="section-d.2-1.2.2.2.1">We offer DNS over TLS as specified in RFC 7858 on (insert
 IP address). It
 is available on port 853 and port 443. We also implement RFC 7766.<a class="pilcrow" href="#section-d.2-1.2.2.2.1">¶</a></p>
<ol class="normal type-i" id="section-d.2-1.2.2.2.2" start="1" type="i">
                  <li id="section-d.2-1.2.2.2.2.1">The DoT authentication domain name used is (insert domain name).<a class="pilcrow" href="#section-d.2-1.2.2.2.2.1">¶</a>
</li>
                  <li id="section-d.2-1.2.2.2.2.2">We do not publish SPKI pin sets.<a class="pilcrow" href="#section-d.2-1.2.2.2.2.2">¶</a>
</li>
                </ol>
</li>
              <li id="section-d.2-1.2.2.3">We offer DNS over HTTPS as specified in RFC 8484 on (insert URI
template).<a class="pilcrow" href="#section-d.2-1.2.2.3">¶</a>
</li>
              <li id="section-d.2-1.2.2.4">Both services offer TLS 1.2 and TLS 1.3.<a class="pilcrow" href="#section-d.2-1.2.2.4">¶</a>
</li>
              <li id="section-d.2-1.2.2.5">Both services pad DNS responses according to RFC 8467.<a class="pilcrow" href="#section-d.2-1.2.2.5">¶</a>
</li>
              <li id="section-d.2-1.2.2.6">
                <p id="section-d.2-1.2.2.6.1">Both services provide DNSSEC validation.<a class="pilcrow" href="#section-d.2-1.2.2.6.1">¶</a></p>
<p id="section-d.2-1.2.2.6.2"></p>
</li>
            </ol>
</li>
          <li id="section-d.2-1.3">
            <p id="section-d.2-1.3.1">Upstream capabilities.<a class="pilcrow" href="#section-d.2-1.3.1">¶</a></p>
<ol class="normal type-a" id="section-d.2-1.3.2" start="1" type="a">
              <li id="section-d.2-1.3.2.1">Our servers implement QNAME minimization.<a class="pilcrow" href="#section-d.2-1.3.2.1">¶</a>
</li>
              <li id="section-d.2-1.3.2.2">Our servers do not send ECS upstream.<a class="pilcrow" href="#section-d.2-1.3.2.2">¶</a>
</li>
            </ol>
</li>
          <li id="section-d.2-1.4">Support. Support information for this service is available at (insert
link).<a class="pilcrow" href="#section-d.2-1.4">¶</a>
</li>
          <li id="section-d.2-1.5">Data Processing. We operate as the legal entity (insert entity) registered
in
(insert country); as such, we operate under (insert country/region) law. Our
separate statement regarding the specifics of our data processing policy,
practice, and agreements can be found here (insert link).<a class="pilcrow" href="#section-d.2-1.5">¶</a>
</li>
        </ol>
</section>
</div>
</section>
</div>
<div id="acknowledgements">
<section id="section-appendix.e">
      <h2 id="name-acknowledgements">
<a class="section-name selfRef" href="#name-acknowledgements">Acknowledgements</a>
      </h2>
<p id="section-appendix.e-1">Many thanks to <span class="contact-name">Amelia Andersdotter</span> for a very
      thorough review of the first draft of this document and <span class="contact-name">Stephen Farrell</span> for a thorough review at Working Group Last
      Call and for
      suggesting the inclusion of an example RPS. Thanks to <span class="contact-name">John Todd</span> for discussions on this topic, and to <span class="contact-name">Stéphane Bortzmeyer</span>, <span class="contact-name">Puneet Sood</span>, and
      <span class="contact-name">Vittorio Bertola</span> for review. Thanks to <span class="contact-name">Daniel Kahn Gillmor</span>, <span class="contact-name">Barry Green</span>,
      <span class="contact-name">Paul Hoffman</span>, <span class="contact-name">Dan York</span>,
      <span class="contact-name">Jon Reed</span>, and <span class="contact-name">Lorenzo       Colitti</span> for comments at the mic. Thanks to <span class="contact-name">Loganaden Velvindron</span> for useful updates to the text.<a class="pilcrow" href="#section-appendix.e-1">¶</a></p>
<p id="section-appendix.e-2"><span class="contact-name">Sara Dickinson</span> thanks the Open Technology Fund for a grant to support the
work
on this document.<a class="pilcrow" href="#section-appendix.e-2">¶</a></p>
</section>
</div>
<div id="contributors">
<section id="section-appendix.f">
      <h2 id="name-contributors">
<a class="section-name selfRef" href="#name-contributors">Contributors</a>
      </h2>
<p id="section-appendix.f-1">The below individuals contributed significantly to the document:<a class="pilcrow" href="#section-appendix.f-1">¶</a></p>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">John Dickinson</span></div>
<div class="left" dir="auto"><span class="org">Sinodun IT</span></div>
<div class="left" dir="auto"><span class="extended-address">Magdalen Centre</span></div>
<div class="left" dir="auto"><span class="street-address">Oxford Science Park</span></div>
<div class="left" dir="auto"><span class="locality">Oxford</span></div>
<div class="left" dir="auto"><span class="postal-code">OX4 4GA</span></div>
<div class="left" dir="auto"><span class="country-name">United Kingdom</span></div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Jim Hague</span></div>
<div class="left" dir="auto"><span class="org">Sinodun IT</span></div>
<div class="left" dir="auto"><span class="extended-address">Magdalen Centre</span></div>
<div class="left" dir="auto"><span class="street-address">Oxford Science Park</span></div>
<div class="left" dir="auto"><span class="locality">Oxford</span></div>
<div class="left" dir="auto"><span class="postal-code">OX4 4GA</span></div>
<div class="left" dir="auto"><span class="country-name">United Kingdom</span></div>
</address>
</section>
</div>
<div id="authors-addresses">
<section id="section-appendix.g">
      <h2 id="name-authors-addresses">
<a class="section-name selfRef" href="#name-authors-addresses">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Sara Dickinson</span></div>
<div class="left" dir="auto"><span class="org">Sinodun IT</span></div>
<div class="left" dir="auto"><span class="extended-address">Magdalen Centre</span></div>
<div class="left" dir="auto"><span class="street-address">Oxford Science Park</span></div>
<div class="left" dir="auto"><span class="locality">Oxford</span></div>
<div class="left" dir="auto"><span class="postal-code">OX4 4GA</span></div>
<div class="left" dir="auto"><span class="country-name">United Kingdom</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:sara@sinodun.com">sara@sinodun.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Benno J. Overeinder</span></div>
<div class="left" dir="auto"><span class="org">NLnet Labs</span></div>
<div class="left" dir="auto"><span class="street-address">Science Park 400</span></div>
<div class="left" dir="auto">
<span class="postal-code">1098 XH</span> <span class="locality">Amsterdam</span>
</div>
<div class="left" dir="auto"><span class="country-name">Netherlands</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:benno@nlnetLabs.nl">benno@nlnetLabs.nl</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Roland M. van Rijswijk-Deij</span></div>
<div class="left" dir="auto"><span class="org">NLnet Labs</span></div>
<div class="left" dir="auto"><span class="street-address">Science Park 400</span></div>
<div class="left" dir="auto">
<span class="postal-code">1098 XH</span> <span class="locality">Amsterdam</span>
</div>
<div class="left" dir="auto"><span class="country-name">Netherlands</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:roland@nlnetLabs.nl">roland@nlnetLabs.nl</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Allison Mankin</span></div>
<div class="left" dir="auto"><span class="org">Salesforce.com, Inc.</span></div>
<div class="left" dir="auto"><span class="street-address">Salesforce Tower<br/>415 Mission Street, 3rd Floor</span></div>
<div class="left" dir="auto">
<span class="locality">San Francisco</span>, <span class="region">CA</span> <span class="postal-code">94105</span>
</div>
<div class="left" dir="auto"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:allison.mankin@gmail.com">allison.mankin@gmail.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>


</body></html>