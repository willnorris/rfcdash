<!DOCTYPE html>
<html class="RFC" lang="en"><head>
<meta charset="utf-8"/>
<meta content="Common,Latin" name="scripts"/>
<meta content="initial-scale=1.0" name="viewport"/>
<title>RFC 9415: On the Generation of Transient Numeric Identifiers</title>
<meta content="Fernando Gont" name="author"/>
<meta content="Ivan Arce" name="author"/>
<meta content='
       
This document performs an analysis of the security and privacy implications of different types of "transient numeric identifiers" used in IETF protocols and tries to categorize them based on their interoperability requirements and their associated failure severity when such requirements are not met. Subsequently, it provides advice on possible algorithms that could be employed to satisfy the interoperability requirements of each identifier category while minimizing the negative security and privacy implications, thus providing guidance to protocol designers and protocol implementers. Finally, it describes a number of algorithms that have been employed in real implementations to generate transient numeric identifiers and analyzes their security and privacy properties. This document is a product of the Privacy Enhancements and Assessments Research Group (PEARG) in the IRTF.
       
    ' name="description"/>
<meta content="xml2rfc 3.17.4" name="generator"/>
<meta content="security" name="keyword"/>
<meta content="vulnerability" name="keyword"/>
<meta content="algorithm" name="keyword"/>
<meta content="attack" name="keyword"/>
<meta content="fingerprinting" name="keyword"/>
<meta content="9415" name="rfc.number"/>
<!-- Generator version information:
  xml2rfc 3.17.4
    Python 3.9.15
    ConfigArgParse 1.5.3
    google-i18n-address 3.0.0
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 4.9.0
    platformdirs 3.8.0
    pycountry 22.3.5
    PyYAML 6.0
    requests 2.28.0
    setuptools 44.1.1
    six 1.16.0
    wcwidth 0.2.5
    weasyprint 56.1
-->
<link href="rfc9415.xml" rel="alternate" type="application/rfc+xml"/>
<link href="#copyright" rel="license"/>
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necessary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

:root {
  --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
  --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
  --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
}

@viewport {
  zoom: 1.0;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: var(--font-sans);
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
svg[font-family~="serif" i], svg [font-family~="serif" i] {
  font-family: var(--font-serif);
}
svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
  font-family: var(--font-sans);
}
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef,
.iref + a[href].internal {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre {
  background-color: #f9f9f9;
  font-family: var(--font-mono);
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: var(--font-sans);
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  .breakable pre {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The following is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
.sourcecode pre,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .artwork > pre,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background slightly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottom margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the compact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div.sourcecode:first-child,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type:only-child {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css"/>
<link href="https://dx.doi.org/10.17487/rfc9415" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <link href="https://datatracker.ietf.org/doc/draft-irtf-pearg-numeric-ids-generation-12" rel="prev"/>
  </head>
<body class="xml2rfc">
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 9415</td>
<td class="center">Generation of Transient Numeric IDs</td>
<td class="right">July 2023</td>
</tr></thead>
<tfoot><tr>
<td class="left">Gont &amp; Arce</td>
<td class="center">Informational</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div class="document-information" id="external-metadata"></div>
<div class="document-information" id="internal-metadata">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Research Task Force (IRTF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a class="eref" href="https://www.rfc-editor.org/rfc/rfc9415">9415</a></dd>
<dt class="label-category">Category:</dt>
<dd class="category">Informational</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time class="published" datetime="2023-07">July 2023</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">F. Gont</div>
<div class="org">SI6 Networks</div>
</div>
<div class="author">
      <div class="author-name">I. Arce</div>
<div class="org">Quarkslab</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 9415</h1>
<h1 id="title">On the Generation of Transient Numeric Identifiers</h1>
<section id="section-abstract">
      <h2 id="abstract"><a class="selfRef" href="#abstract">Abstract</a></h2>
<p id="section-abstract-1">
This document performs an analysis of the security and privacy implications of different types of "transient numeric identifiers" used in IETF protocols and tries to categorize them based on their interoperability requirements and their associated failure severity when such requirements are not met. Subsequently, it provides advice on possible algorithms that could be employed to satisfy the interoperability requirements of each identifier category while minimizing the negative security and privacy implications, thus providing guidance to protocol designers and protocol implementers. Finally, it describes a number of algorithms that have been employed in real implementations to generate transient numeric identifiers and analyzes their security and privacy properties. This document is a product of the Privacy Enhancements and Assessments Research Group (PEARG) in the IRTF.<a class="pilcrow" href="#section-abstract-1">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a class="section-name selfRef" href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This document is not an Internet Standards Track specification; it is
            published for informational purposes.<a class="pilcrow" href="#section-boilerplate.1-1">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Research Task Force
            (IRTF).  The IRTF publishes the results of Internet-related
            research and development activities.  These results might not be
            suitable for deployment.  This RFC represents the consensus of the Privacy Enhancements and Assessments
            Research Group of the Internet Research Task Force (IRTF).
            Documents approved for publication by the IRSG are not
            candidates for any level of Internet Standard; see Section 2 of RFC
            7841.<a class="pilcrow" href="#section-boilerplate.1-2">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc9415">https://www.rfc-editor.org/info/rfc9415</a></span>.<a class="pilcrow" href="#section-boilerplate.1-3">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a class="section-name selfRef" href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2023 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a class="pilcrow" href="#section-boilerplate.2-1">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document.<a class="pilcrow" href="#section-boilerplate.2-2">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a class="toplink" href="#" onclick="scroll(0,0)">▲</a><h2 id="name-table-of-contents">
<a class="section-name selfRef" href="#name-table-of-contents">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p class="keepWithNext" id="section-toc.1-1.1.1"><a class="auto internal xref" href="#section-1">1</a>.  <a class="internal xref" href="#name-introduction">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p class="keepWithNext" id="section-toc.1-1.2.1"><a class="auto internal xref" href="#section-2">2</a>.  <a class="internal xref" href="#name-terminology">Terminology</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p class="keepWithNext" id="section-toc.1-1.3.1"><a class="auto internal xref" href="#section-3">3</a>.  <a class="internal xref" href="#name-threat-model">Threat Model</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a class="auto internal xref" href="#section-4">4</a>.  <a class="internal xref" href="#name-issues-with-the-specificati">Issues with the Specification of Transient Numeric Identifiers</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a class="auto internal xref" href="#section-5">5</a>.  <a class="internal xref" href="#name-protocol-failure-severity">Protocol Failure Severity</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a class="auto internal xref" href="#section-6">6</a>.  <a class="internal xref" href="#name-categorizing-transient-nume">Categorizing Transient Numeric Identifiers</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a class="auto internal xref" href="#section-7">7</a>.  <a class="internal xref" href="#name-common-algorithms-for-trans">Common Algorithms for Transient Numeric Identifier Generation</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a class="auto internal xref" href="#section-7.1">7.1</a>.  <a class="internal xref" href="#name-category-1-uniqueness-soft-">Category #1: Uniqueness (Soft Failure)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a class="auto internal xref" href="#section-7.2">7.2</a>.  <a class="internal xref" href="#name-category-2-uniqueness-hard-">Category #2: Uniqueness (Hard Failure)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a class="auto internal xref" href="#section-7.3">7.3</a>.  <a class="internal xref" href="#name-category-3-uniqueness-stabl">Category #3: Uniqueness, Stable within Context (Soft Failure)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a class="auto internal xref" href="#section-7.4">7.4</a>.  <a class="internal xref" href="#name-category-4-uniqueness-monot">Category #4: Uniqueness, Monotonically Increasing within Context (Hard Failure)</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a class="auto internal xref" href="#section-8">8</a>.  <a class="internal xref" href="#name-common-vulnerabilities-asso">Common Vulnerabilities Associated with Transient Numeric Identifiers</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a class="auto internal xref" href="#section-8.1">8.1</a>.  <a class="internal xref" href="#name-network-activity-correlatio">Network Activity Correlation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a class="auto internal xref" href="#section-8.2">8.2</a>.  <a class="internal xref" href="#name-information-leakage">Information Leakage</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a class="auto internal xref" href="#section-8.3">8.3</a>.  <a class="internal xref" href="#name-fingerprinting">Fingerprinting</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4">
                <p id="section-toc.1-1.8.2.4.1"><a class="auto internal xref" href="#section-8.4">8.4</a>.  <a class="internal xref" href="#name-exploitation-of-the-semanti">Exploitation of the Semantics of Transient Numeric Identifiers</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.5">
                <p id="section-toc.1-1.8.2.5.1"><a class="auto internal xref" href="#section-8.5">8.5</a>.  <a class="internal xref" href="#name-exploitation-of-collisions-">Exploitation of Collisions of Transient Numeric Identifiers</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.6">
                <p id="section-toc.1-1.8.2.6.1"><a class="auto internal xref" href="#section-8.6">8.6</a>.  <a class="internal xref" href="#name-exploitation-of-predictable">Exploitation of Predictable Transient Numeric Identifiers for Injection Attacks</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.7">
                <p id="section-toc.1-1.8.2.7.1"><a class="auto internal xref" href="#section-8.7">8.7</a>.  <a class="internal xref" href="#name-cryptanalysis">Cryptanalysis</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a class="auto internal xref" href="#section-9">9</a>.  <a class="internal xref" href="#name-vulnerability-assessment-of">Vulnerability Assessment of Transient Numeric Identifiers</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a class="auto internal xref" href="#section-9.1">9.1</a>.  <a class="internal xref" href="#name-category-1-uniqueness-soft-f">Category #1: Uniqueness (Soft Failure)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a class="auto internal xref" href="#section-9.2">9.2</a>.  <a class="internal xref" href="#name-category-2-uniqueness-hard-f">Category #2: Uniqueness (Hard Failure)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a class="auto internal xref" href="#section-9.3">9.3</a>.  <a class="internal xref" href="#name-category-3-uniqueness-stable">Category #3: Uniqueness, Stable within Context (Soft Failure)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.4">
                <p id="section-toc.1-1.9.2.4.1"><a class="auto internal xref" href="#section-9.4">9.4</a>.  <a class="internal xref" href="#name-category-4-uniqueness-monoto">Category #4: Uniqueness, Monotonically Increasing within Context (Hard Failure)</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a class="auto internal xref" href="#section-10">10</a>. <a class="internal xref" href="#name-iana-considerations">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a class="auto internal xref" href="#section-11">11</a>. <a class="internal xref" href="#name-security-considerations">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a class="auto internal xref" href="#section-12">12</a>. <a class="internal xref" href="#name-references">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a class="auto internal xref" href="#section-12.1">12.1</a>.  <a class="internal xref" href="#name-normative-references">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a class="auto internal xref" href="#section-12.2">12.2</a>.  <a class="internal xref" href="#name-informative-references">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a class="auto internal xref" href="#appendix-A">Appendix A</a>.  <a class="internal xref" href="#name-algorithms-and-techniques-w">Algorithms and Techniques with Known Issues</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a class="auto internal xref" href="#appendix-A.1">A.1</a>.  <a class="internal xref" href="#name-predictable-linear-identifi">Predictable Linear Identifiers Algorithm</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a class="auto internal xref" href="#appendix-A.2">A.2</a>.  <a class="internal xref" href="#name-random-increments-algorithm">Random-Increments Algorithm</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.3">
                <p id="section-toc.1-1.13.2.3.1"><a class="auto internal xref" href="#appendix-A.3">A.3</a>.  <a class="internal xref" href="#name-reusing-identifiers-across-">Reusing Identifiers Across Different Contexts</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a class="auto internal xref" href="#appendix-B"></a><a class="internal xref" href="#name-acknowledgements">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a class="auto internal xref" href="#appendix-C"></a><a class="internal xref" href="#name-authors-addresses">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="intro">
<section id="section-1">
      <h2 id="name-introduction">
<a class="section-number selfRef" href="#section-1">1. </a><a class="section-name selfRef" href="#name-introduction">Introduction</a>
      </h2>
<p id="section-1-1">
Networking protocols employ a variety of transient numeric identifiers for different protocol objects, such as IPv4 and IPv6 Identification values <span>[<a class="cite xref" href="#RFC0791">RFC0791</a>]</span> <span>[<a class="cite xref" href="#RFC8200">RFC8200</a>]</span>, IPv6 Interface Identifiers (IIDs) <span>[<a class="cite xref" href="#RFC4291">RFC4291</a>]</span>, transport-protocol ephemeral port numbers <span>[<a class="cite xref" href="#RFC6056">RFC6056</a>]</span>, TCP Initial Sequence Numbers (ISNs) <span>[<a class="cite xref" href="#RFC9293">RFC9293</a>]</span>, NTP Reference IDs (REFIDs) <span>[<a class="cite xref" href="#RFC5905">RFC5905</a>]</span>, and DNS IDs <span>[<a class="cite xref" href="#RFC1035">RFC1035</a>]</span>. These identifiers typically have specific requirements (e.g., uniqueness during a specified period of time) that must be satisfied such that they do not result in negative interoperability implications and an associated failure severity when such requirements are not met.<a class="pilcrow" href="#section-1-1">¶</a></p>
<aside id="section-1-2">
        <p id="section-1-2.1">NOTE: Some documents refer to the DNS ID as the DNS "Query ID" or "TxID".<a class="pilcrow" href="#section-1-2.1">¶</a></p>
</aside>
<p id="section-1-3">For more than 30 years, a large number of implementations of IETF protocols have been subject to a variety of attacks, with effects ranging from Denial of Service (DoS) or data injection to information leakages that could be exploited for pervasive monitoring <span>[<a class="cite xref" href="#RFC7258">RFC7258</a>]</span>. The root cause of these issues has been, in many cases, the poor selection of transient numeric identifiers in such protocols, usually as a result of insufficient or misleading specifications. While it is generally trivial to identify an algorithm that can satisfy the interoperability requirements of a given transient numeric identifier, empirical evidence exists that doing so without negatively affecting the security and/or privacy properties of the aforementioned protocols is prone to error <span>[<a class="cite xref" href="#RFC9414">RFC9414</a>]</span>.<a class="pilcrow" href="#section-1-3">¶</a></p>
<p id="section-1-4">For example, implementations have been subject to security and/or privacy issues resulting from:<a class="pilcrow" href="#section-1-4">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-5.1">predictable IPv4 or IPv6 Identification values (e.g., see <span>[<a class="cite xref" href="#Sanfilippo1998a">Sanfilippo1998a</a>]</span>, <span>[<a class="cite xref" href="#RFC6274">RFC6274</a>]</span>, and <span>[<a class="cite xref" href="#RFC7739">RFC7739</a>]</span>),<a class="pilcrow" href="#section-1-5.1">¶</a>
</li>
        <li class="normal" id="section-1-5.2">predictable IPv6 IIDs (e.g., see <span>[<a class="cite xref" href="#RFC7217">RFC7217</a>]</span>, <span>[<a class="cite xref" href="#RFC7707">RFC7707</a>]</span>, and <span>[<a class="cite xref" href="#RFC7721">RFC7721</a>]</span>),<a class="pilcrow" href="#section-1-5.2">¶</a>
</li>
        <li class="normal" id="section-1-5.3">predictable transport-protocol ephemeral port numbers (e.g., see <span>[<a class="cite xref" href="#RFC6056">RFC6056</a>]</span> and <span>[<a class="cite xref" href="#Silbersack2005">Silbersack2005</a>]</span>),<a class="pilcrow" href="#section-1-5.3">¶</a>
</li>
        <li class="normal" id="section-1-5.4">predictable TCP Initial Sequence Numbers (ISNs) (e.g., see <span>[<a class="cite xref" href="#Morris1985">Morris1985</a>]</span>, <span>[<a class="cite xref" href="#Bellovin1989">Bellovin1989</a>]</span>, and <span>[<a class="cite xref" href="#RFC6528">RFC6528</a>]</span>),<a class="pilcrow" href="#section-1-5.4">¶</a>
</li>
        <li class="normal" id="section-1-5.5">predictable initial timestamps in TCP timestamps options (e.g., see <span>[<a class="cite xref" href="#TCPT-uptime">TCPT-uptime</a>]</span> and <span>[<a class="cite xref" href="#RFC7323">RFC7323</a>]</span>), and<a class="pilcrow" href="#section-1-5.5">¶</a>
</li>
        <li class="normal" id="section-1-5.6">predictable DNS IDs (see, e.g., <span>[<a class="cite xref" href="#Schuba1993">Schuba1993</a>]</span> and <span>[<a class="cite xref" href="#Klein2007">Klein2007</a>]</span>).<a class="pilcrow" href="#section-1-5.6">¶</a>
</li>
      </ul>
<p id="section-1-6">

Recent history indicates that, when new protocols are standardized or new protocol implementations are produced, the security and privacy properties of the associated transient numeric identifiers tend to be overlooked, and inappropriate algorithms to generate such identifiers are either suggested in the specifications or selected by implementers. As a result, advice in this area is warranted.<a class="pilcrow" href="#section-1-6">¶</a></p>
<p id="section-1-7">We note that the use of cryptographic techniques may readily mitigate some of the issues arising from predictable transient numeric identifiers. For example, cryptographic authentication can readily mitigate data injection attacks even in the presence of predictable transient numeric identifiers (such as "sequence numbers"). However, use of flawed algorithms (such as global counters) for generating transient numeric identifiers could still result in information leakages even when cryptographic techniques are employed.<a class="pilcrow" href="#section-1-7">¶</a></p>
<p id="section-1-8">This document contains a non-exhaustive survey of transient numeric identifiers employed in various IETF protocols and aims to categorize such identifiers based on their interoperability requirements and the associated failure severity when such requirements are not met. Subsequently, it provides advice on possible algorithms that could be employed to satisfy the interoperability requirements of each category while minimizing negative security and privacy implications. Finally, it analyzes several algorithms that have been employed in real implementations to meet such requirements and analyzes their security and privacy properties.<a class="pilcrow" href="#section-1-8">¶</a></p>
<p id="section-1-9">This document represents the consensus of the Privacy Enhancements and Assessments Research Group (PEARG).<a class="pilcrow" href="#section-1-9">¶</a></p>
</section>
</div>
<div id="terminology">
<section id="section-2">
      <h2 id="name-terminology">
<a class="section-number selfRef" href="#section-2">2. </a><a class="section-name selfRef" href="#name-terminology">Terminology</a>
      </h2>
<span class="break"></span><dl class="dlNewline" id="section-2-1">
        <dt id="section-2-1.1">Transient Numeric Identifier:</dt>
        <dd id="section-2-1.2" style="margin-left: 1.5em">A data object in a protocol specification that can be used to definitely distinguish a protocol object (a datagram, network interface, transport-protocol endpoint, session, etc.) from all other objects of the same type, in a given context. Transient numeric identifiers are usually defined as a series of bits and represented using integer values. These identifiers are typically dynamically selected, as opposed to statically assigned numeric identifiers (see, e.g., <span>[<a class="cite xref" href="#IANA-PROT">IANA-PROT</a>]</span>). We note that different transient numeric identifiers may have additional requirements or properties depending on their specific use in a protocol. We use the term "transient numeric identifier" (or simply "numeric identifier" or "identifier" as short forms) as a generic term to refer to any data object in a protocol specification that satisfies the identification property stated above.<a class="pilcrow" href="#section-2-1.2">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.3">Failure Severity:</dt>
        <dd id="section-2-1.4" style="margin-left: 1.5em">The interoperability consequences of a failure to comply with the interoperability requirements of a given identifier. Severity considers the worst potential consequence of a failure, determined by the system damage and/or time lost to repair the failure. In this document, we define two types of failure severity: "soft failure" and "hard failure".<a class="pilcrow" href="#section-2-1.4">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.5">Soft Failure:</dt>
        <dd id="section-2-1.6" style="margin-left: 1.5em">A recoverable condition in which a protocol does not operate in the prescribed manner but normal operation can be resumed automatically in a short period of time. For example, a simple packet-loss event that is subsequently recovered with a packet retransmission can be considered a soft failure.<a class="pilcrow" href="#section-2-1.6">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.7">Hard Failure:</dt>
        <dd id="section-2-1.8" style="margin-left: 1.5em">A non-recoverable condition in which a protocol does not operate in the prescribed manner or it operates with excessive degradation of service. For example, an established TCP connection that is aborted due to an error condition constitutes, from the point of view of the transport protocol, a hard failure, since it enters a state from which normal operation cannot be resumed.<a class="pilcrow" href="#section-2-1.8">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
</section>
</div>
<div id="threat-model">
<section id="section-3">
      <h2 id="name-threat-model">
<a class="section-number selfRef" href="#section-3">3. </a><a class="section-name selfRef" href="#name-threat-model">Threat Model</a>
      </h2>
<p id="section-3-1">Throughout this document, we do not consider on-path attacks. That is, we assume the attacker does not have physical or logical access to the system(s) being attacked and that the attacker can only observe traffic explicitly directed to the attacker. Similarly, an attacker cannot observe traffic transferred between the sender and the receiver(s) of a target protocol but may be able to interact with any of these entities, including by, e.g., sending any traffic to them to sample transient numeric identifiers employed by the target hosts when communicating with the attacker.<a class="pilcrow" href="#section-3-1">¶</a></p>
<p id="section-3-2">For example, when analyzing vulnerabilities associated with TCP Initial Sequence Numbers (ISNs), we consider the attacker is unable to capture network traffic corresponding to a TCP connection between two other hosts. However, we consider the attacker is able to communicate with any of these hosts (e.g., establish a TCP connection with any of them) to, e.g., sample the TCP ISNs employed by these hosts when communicating with the attacker.<a class="pilcrow" href="#section-3-2">¶</a></p>
<p id="section-3-3">Similarly, when considering host-tracking attacks based on IPv6 Interface Identifiers, we consider an attacker may learn the IPv6 address employed by a victim host if, e.g., the address becomes exposed as a result of the victim host communicating with an attacker-operated server. Subsequently, an attacker may perform host-tracking by probing a set of target addresses composed by a set of target prefixes and the IPv6 Interface Identifier originally learned by the attacker.
      Alternatively, an attacker may perform host-tracking if, e.g., the victim host communicates with an attacker-operated server as it moves from one location to another, thereby exposing its configured addresses. We note that none of these scenarios require the attacker observe traffic not explicitly directed to the attacker.<a class="pilcrow" href="#section-3-3">¶</a></p>
</section>
</div>
<div id="issues">
<section id="section-4">
      <h2 id="name-issues-with-the-specificati">
<a class="section-number selfRef" href="#section-4">4. </a><a class="section-name selfRef" href="#name-issues-with-the-specificati">Issues with the Specification of Transient Numeric Identifiers</a>
      </h2>
<p id="section-4-1">While assessing IETF protocol specifications regarding the use of transient numeric identifiers, we have found that most of the issues discussed in this document arise as a result of one of the following conditions:<a class="pilcrow" href="#section-4-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-2.1">protocol specifications that under specify their transient numeric identifiers<a class="pilcrow" href="#section-4-2.1">¶</a>
</li>
        <li class="normal" id="section-4-2.2">protocol specifications that over specify their transient numeric identifiers<a class="pilcrow" href="#section-4-2.2">¶</a>
</li>
        <li class="normal" id="section-4-2.3">protocol implementations that simply fail to comply with the specified requirements<a class="pilcrow" href="#section-4-2.3">¶</a>
</li>
      </ul>
<p id="section-4-3">A number of IETF protocol specifications under specified their transient numeric identifiers, thus leading to implementations that were vulnerable to numerous off-path
   attacks. Examples of them are the specification of TCP local ports in <span>[<a class="cite xref" href="#RFC0793">RFC0793</a>]</span> or the specification of the DNS ID in <span>[<a class="cite xref" href="#RFC1035">RFC1035</a>]</span>.<a class="pilcrow" href="#section-4-3">¶</a></p>
<aside id="section-4-4">
        <p id="section-4-4.1">NOTE: The TCP local port in an active OPEN request is commonly known as the "ephemeral port" of the corresponding TCP connection <span>[<a class="cite xref" href="#RFC6056">RFC6056</a>]</span>.<a class="pilcrow" href="#section-4-4.1">¶</a></p>
</aside>
<p id="section-4-5">On the other hand, there are a number of IETF protocol specifications that over specify some of their associated transient numeric identifiers. For example, <span>[<a class="cite xref" href="#RFC4291">RFC4291</a>]</span> essentially overloads the semantics of IPv6 Interface Identifiers (IIDs) by embedding link-layer addresses in the IPv6 IIDs when the interoperability requirement of uniqueness could be achieved in other ways that do not result in negative security and privacy implications <span>[<a class="cite xref" href="#RFC7721">RFC7721</a>]</span>. Similarly, <span>[<a class="cite xref" href="#RFC2460">RFC2460</a>]</span> suggests the use of a global counter for the generation of Identification values when the interoperability requirement of uniqueness per {IPv6 Source Address, IPv6 Destination Address} could be achieved with other algorithms that do not result in negative security and privacy implications <span>[<a class="cite xref" href="#RFC7739">RFC7739</a>]</span>.<a class="pilcrow" href="#section-4-5">¶</a></p>
<p id="section-4-6">Finally, there are protocol implementations that simply fail to comply with existing protocol specifications. For example, some popular operating systems still fail to implement transport-protocol ephemeral port randomization, as recommended in <span>[<a class="cite xref" href="#RFC6056">RFC6056</a>]</span>, or TCP Initial Sequence Number randomization, as recommended in <span>[<a class="cite xref" href="#RFC9293">RFC9293</a>]</span>.<a class="pilcrow" href="#section-4-6">¶</a></p>
</section>
</div>
<div id="failure-severity">
<section id="section-5">
      <h2 id="name-protocol-failure-severity">
<a class="section-number selfRef" href="#section-5">5. </a><a class="section-name selfRef" href="#name-protocol-failure-severity">Protocol Failure Severity</a>
      </h2>
<p id="section-5-1"><a class="auto internal xref" href="#terminology">Section 2</a> defines the concept of "failure severity", along with two types of failure severities that we employ throughout this document: soft and hard.<a class="pilcrow" href="#section-5-1">¶</a></p>
<p id="section-5-2">Our analysis of the severity of a failure is performed from the point of view of the protocol in question. However, the corresponding severity on the upper protocol (or application) might not be the same as that of the protocol in question. For example, a TCP connection that is aborted might or might not result in a hard failure of the upper application, i.e., if the upper application can establish a new TCP connection without any impact on the application, a hard failure at the TCP protocol may have no severity at the application layer. On the other hand, if a hard failure of a TCP connection results in excessive degradation of service at the application layer, it will also result in a hard failure at the application.<a class="pilcrow" href="#section-5-2">¶</a></p>
</section>
</div>
<div id="categorizing">
<section id="section-6">
      <h2 id="name-categorizing-transient-nume">
<a class="section-number selfRef" href="#section-6">6. </a><a class="section-name selfRef" href="#name-categorizing-transient-nume">Categorizing Transient Numeric Identifiers</a>
      </h2>
<p id="section-6-1">This section includes a non-exhaustive survey of transient numeric identifiers, which are representative of all the possible combinations of interoperability requirements and failure severities found in popular protocols of different layers. Additionally, it proposes a number of categories that can accommodate these identifiers based on their interoperability requirements and their associated failure severity (soft or hard).<a class="pilcrow" href="#section-6-1">¶</a></p>
<aside id="section-6-2">
        <p id="section-6-2.1">NOTE: All other transient numeric identifiers that were analyzed as part of this effort could be accommodated into one of the existing categories from <a class="auto internal xref" href="#survey-table">Table 1</a>.<a class="pilcrow" href="#section-6-2.1">¶</a></p>
</aside>
<span id="name-survey-of-transient-numeric"></span><div id="survey-table">
<table class="center" id="table-1">
        <caption>
<a class="selfRef" href="#table-1">Table 1</a>:
<a class="selfRef" href="#name-survey-of-transient-numeric">Survey of Transient Numeric Identifiers</a>
        </caption>
<thead>
          <tr>
            <th class="text-center" colspan="1" rowspan="1">Identifier</th>
            <th class="text-center" colspan="1" rowspan="1">Interoperability Requirements</th>
            <th class="text-center" colspan="1" rowspan="1">Failure Severity</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-center" colspan="1" rowspan="1">IPv6 ID</td>
            <td class="text-center" colspan="1" rowspan="1">Uniqueness (for IPv6 address pair)</td>
            <td class="text-center" colspan="1" rowspan="1">Soft/Hard (1)</td>
          </tr>
          <tr>
            <td class="text-center" colspan="1" rowspan="1">IPv6 IID</td>
            <td class="text-center" colspan="1" rowspan="1">Uniqueness (and stable within IPv6 prefix) (2)</td>
            <td class="text-center" colspan="1" rowspan="1">Soft (3)</td>
          </tr>
          <tr>
            <td class="text-center" colspan="1" rowspan="1">TCP ISN</td>
            <td class="text-center" colspan="1" rowspan="1">Monotonically increasing (4)</td>
            <td class="text-center" colspan="1" rowspan="1">Hard (4)</td>
          </tr>
          <tr>
            <td class="text-center" colspan="1" rowspan="1">TCP initial timestamp</td>
            <td class="text-center" colspan="1" rowspan="1">Monotonically increasing (5)</td>
            <td class="text-center" colspan="1" rowspan="1">Hard (5)</td>
          </tr>
          <tr>
            <td class="text-center" colspan="1" rowspan="1">TCP ephemeral port</td>
            <td class="text-center" colspan="1" rowspan="1">Uniqueness (for connection ID)</td>
            <td class="text-center" colspan="1" rowspan="1">Hard</td>
          </tr>
          <tr>
            <td class="text-center" colspan="1" rowspan="1">IPv6 Flow Label</td>
            <td class="text-center" colspan="1" rowspan="1">Uniqueness</td>
            <td class="text-center" colspan="1" rowspan="1">None (6)</td>
          </tr>
          <tr>
            <td class="text-center" colspan="1" rowspan="1">DNS ID</td>
            <td class="text-center" colspan="1" rowspan="1">Uniqueness</td>
            <td class="text-center" colspan="1" rowspan="1">None (7)</td>
          </tr>
        </tbody>
      </table>
</div>
<p id="section-6-4">NOTE:<a class="pilcrow" href="#section-6-4">¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-6-5">
        <dt>(1)</dt>
<dd id="section-6-5.1">While a single collision of IPv6 Identification (ID) values would simply lead to a single packet drop (and hence, a "soft" failure), repeated collisions at high data rates might result in self-propagating collisions of IPv6 IDs, thus possibly leading to a hard failure <span>[<a class="cite xref" href="#RFC4963">RFC4963</a>]</span>.<a class="pilcrow" href="#section-6-5.1">¶</a>
</dd>
        <dd class="break"></dd>
<dt>(2)</dt>
<dd id="section-6-5.2">While the interoperability requirements are simply that the Interface Identifier results in a unique IPv6 address, for operational reasons, it is typically desirable that the resulting IPv6 address (and hence, the corresponding Interface Identifier) be stable within each network <span>[<a class="cite xref" href="#RFC7217">RFC7217</a>]</span> <span>[<a class="cite xref" href="#RFC8064">RFC8064</a>]</span>.<a class="pilcrow" href="#section-6-5.2">¶</a>
</dd>
        <dd class="break"></dd>
<dt>(3)</dt>
<dd id="section-6-5.3">While IPv6 Interface Identifiers must result in unique IPv6 addresses, IPv6 Duplicate Address Detection (DAD) <span>[<a class="cite xref" href="#RFC4862">RFC4862</a>]</span> allows for the detection of duplicate addresses, and hence, such Interface Identifier collisions can be recovered.<a class="pilcrow" href="#section-6-5.3">¶</a>
</dd>
        <dd class="break"></dd>
<dt>(4)</dt>
<dd id="section-6-5.4">In theory, there are no interoperability requirements for TCP Initial Sequence Numbers (ISNs), since the TIME-WAIT state and TCP's "quiet time" concept take care of old segments from previous incarnations of a connection. However, a widespread optimization allows for a new incarnation of a previous connection to be created if the ISN of the incoming SYN is larger than the last sequence number seen in that direction for the previous incarnation of the connection. Thus, monotonically increasing TCP ISNs allow for such optimization to work as expected <span>[<a class="cite xref" href="#RFC6528">RFC6528</a>]</span> and can help avoid connection-establishment failures.<a class="pilcrow" href="#section-6-5.4">¶</a>
</dd>
        <dd class="break"></dd>
<dt>(5)</dt>
<dd id="section-6-5.5">Strictly speaking, there are no interoperability requirements for the <strong>initial</strong> TCP timestamp employed by a TCP instance (i.e., the TS Value (TSval) in a segment with the SYN bit set). However, some TCP implementations allow a new incarnation of a previous connection to be created if the TSval of the incoming SYN is larger than the last TSval seen in that direction for the previous incarnation of the connection (please see <span>[<a class="cite xref" href="#RFC6191">RFC6191</a>]</span>). Thus, monotonically increasing TCP initial timestamps (across connections to the same endpoint) allow for such optimization to work as expected <span>[<a class="cite xref" href="#RFC6191">RFC6191</a>]</span> and can help avoid connection-establishment failures.<a class="pilcrow" href="#section-6-5.5">¶</a>
</dd>
        <dd class="break"></dd>
<dt>(6)</dt>
<dd id="section-6-5.6">The IPv6 Flow Label <span>[<a class="cite xref" href="#RFC6437">RFC6437</a>]</span>, along with the IPv6 Source Address and the IPv6 Destination Address, is typically employed for load sharing <span>[<a class="cite xref" href="#RFC7098">RFC7098</a>]</span>.
Reuse of a Flow Label value for the same set {Source Address, Destination Address} would typically cause both flows to be multiplexed onto the same link. However, as long as this does not occur deterministically, it will not result in any negative implications.<a class="pilcrow" href="#section-6-5.6">¶</a>
</dd>
        <dd class="break"></dd>
<dt>(7)</dt>
<dd id="section-6-5.7">DNS IDs are employed, together with the IP Source Address, the IP Destination Address, the transport-protocol Source Port, and the transport-protocol Destination Port, to match DNS requests and responses. However, since an implementation knows which DNS requests were sent for that set of {IP Source Address, IP Destination Address, transport-protocol Source Port, transport-protocol Destination Port, DNS ID}, a collision of DNS IDs would result, if anything, in a small performance penalty (the response would nevertheless be discarded when it is found that it does not answer the query sent in the corresponding DNS query).<a class="pilcrow" href="#section-6-5.7">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-6-6">Based on the survey above, we can categorize identifiers as follows:<a class="pilcrow" href="#section-6-6">¶</a></p>
<span id="name-identifier-categories"></span><div id="cat-table">
<table class="center" id="table-2">
        <caption>
<a class="selfRef" href="#table-2">Table 2</a>:
<a class="selfRef" href="#name-identifier-categories">Identifier Categories</a>
        </caption>
<thead>
          <tr>
            <th class="text-center" colspan="1" rowspan="1">Cat #</th>
            <th class="text-center" colspan="1" rowspan="1">Category</th>
            <th class="text-center" colspan="1" rowspan="1">Sample Numeric IDs</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-center" colspan="1" rowspan="1">1</td>
            <td class="text-center" colspan="1" rowspan="1">Uniqueness (soft failure)</td>
            <td class="text-center" colspan="1" rowspan="1">IPv6 Flow L., DNS ID</td>
          </tr>
          <tr>
            <td class="text-center" colspan="1" rowspan="1">2</td>
            <td class="text-center" colspan="1" rowspan="1">Uniqueness (hard failure)</td>
            <td class="text-center" colspan="1" rowspan="1">IPv6 ID, TCP ephemeral port</td>
          </tr>
          <tr>
            <td class="text-center" colspan="1" rowspan="1">3</td>
            <td class="text-center" colspan="1" rowspan="1">Uniqueness, stable within context (soft failure)</td>
            <td class="text-center" colspan="1" rowspan="1">IPv6 IID</td>
          </tr>
          <tr>
            <td class="text-center" colspan="1" rowspan="1">4</td>
            <td class="text-center" colspan="1" rowspan="1">Uniqueness, monotonically increasing within context (hard failure)</td>
            <td class="text-center" colspan="1" rowspan="1">TCP ISN, TCP initial timestamp</td>
          </tr>
        </tbody>
      </table>
</div>
<p id="section-6-8">
We note that Category #4 could be considered a generalized case of Category #3, in which a monotonically increasing element is added to a stable (within context) element, such that the resulting identifiers are monotonically increasing within a specified context. That is, the same algorithm could be employed for both #3 and #4, given appropriate parameters.<a class="pilcrow" href="#section-6-8">¶</a></p>
</section>
</div>
<div id="common-algorithms">
<section id="section-7">
      <h2 id="name-common-algorithms-for-trans">
<a class="section-number selfRef" href="#section-7">7. </a><a class="section-name selfRef" href="#name-common-algorithms-for-trans">Common Algorithms for Transient Numeric Identifier Generation</a>
      </h2>
<p id="section-7-1">The following subsections describe some sample algorithms that can be employed for generating transient numeric identifiers for each of the categories above while mitigating the vulnerabilities analyzed in <a class="auto internal xref" href="#vulns">Section 8</a> of this document.<a class="pilcrow" href="#section-7-1">¶</a></p>
<p id="section-7-2">All of the variables employed in the algorithms of the following subsections are of "unsigned integer" type, except for the "retry" variable, which is of (signed) "integer" type.<a class="pilcrow" href="#section-7-2">¶</a></p>
<div id="cat-1-alg">
<section id="section-7.1">
        <h3 id="name-category-1-uniqueness-soft-">
<a class="section-number selfRef" href="#section-7.1">7.1. </a><a class="section-name selfRef" href="#name-category-1-uniqueness-soft-">Category #1: Uniqueness (Soft Failure)</a>
        </h3>
<p id="section-7.1-1">The requirement of uniqueness with a soft failure severity can be complied with a Pseudorandom Number Generator (PRNG).<a class="pilcrow" href="#section-7.1-1">¶</a></p>
<aside id="section-7.1-2">
          <p id="section-7.1-2.1">NOTE: Please see <span>[<a class="cite xref" href="#RFC4086">RFC4086</a>]</span> regarding randomness requirements for security.<a class="pilcrow" href="#section-7.1-2.1">¶</a></p>
</aside>
<p id="section-7.1-3">While most systems provide access to a PRNG, many of such PRNG implementations are not cryptographically secure and therefore might be statistically biased or subject to adversarial influence. For example, ISO C <span>[<a class="cite xref" href="#C11">C11</a>]</span> rand(3) implementations are not cryptographically secure.<a class="pilcrow" href="#section-7.1-3">¶</a></p>
<aside id="section-7.1-4">
          <p id="section-7.1-4.1">NOTE: Section 7.1 ("Uniform Deviates") of <span>[<a class="cite xref" href="#Press1992">Press1992</a>]</span> discusses the underlying issues affecting ISO C <span>[<a class="cite xref" href="#C11">C11</a>]</span> rand(3) implementations.<a class="pilcrow" href="#section-7.1-4.1">¶</a></p>
</aside>
<p id="section-7.1-5">On the other hand, a number of systems provide an interface to a Cryptographically Secure PRNG (CSPRNG) <span>[<a class="cite xref" href="#RFC4086">RFC4086</a>]</span> <span>[<a class="cite xref" href="#RFC8937">RFC8937</a>]</span>, which guarantees high entropy, unpredictability, and good statistical distribution of the random values generated.  For example, GNU/Linux's CSPRNG implementation is available via the getentropy(3) interface <span>[<a class="cite xref" href="#GETENTROPY">GETENTROPY</a>]</span>, while OpenBSD's CSPRNG implementation is available via the arc4random(3) and arc4random_uniform(3) interfaces <span>[<a class="cite xref" href="#ARC4RANDOM">ARC4RANDOM</a>]</span>. Where available, these CSPRNGs should be preferred over, e.g., POSIX <span>[<a class="cite xref" href="#POSIX">POSIX</a>]</span> random(3) or ISO C <span>[<a class="cite xref" href="#C11">C11</a>]</span> rand(3) implementations.<a class="pilcrow" href="#section-7.1-5">¶</a></p>
<p id="section-7.1-6">In scenarios where a CSPRNG is not readily available to select transient numeric identifiers of Category #1, a security and privacy assessment of employing a regular PRNG should be performed, supporting the implementation decision.<a class="pilcrow" href="#section-7.1-6">¶</a></p>
<aside id="section-7.1-7">
          <p id="section-7.1-7.1">NOTE: <span>[<a class="cite xref" href="#Aumasson2018">Aumasson2018</a>]</span>, <span>[<a class="cite xref" href="#Press1992">Press1992</a>]</span>, and <span>[<a class="cite xref" href="#Knuth1983">Knuth1983</a>]</span> discuss theoretical and practical aspects of pseudorandom number generation and provide guidance on how to evaluate PRNGs.<a class="pilcrow" href="#section-7.1-7.1">¶</a></p>
</aside>
<p id="section-7.1-8">We note that, since the premise is that collisions of transient numeric identifiers of this category only lead to soft failures, in many cases, the algorithm might not need to check the suitability of a selected identifier (i.e., the suitable_id() function, described below, could always return "true").<a class="pilcrow" href="#section-7.1-8">¶</a></p>
<p id="section-7.1-9">In scenarios where, e.g., simultaneous use of a given numeric identifier is undesirable and an implementation detects such condition, the implementation may opt to select the next available identifier in the same sequence or select another random number. <a class="auto internal xref" href="#simple-randomization">Section 7.1.1</a> is an implementation of the former strategy, while <a class="auto internal xref" href="#simple-randomization2">Section 7.1.2</a> is an implementation of the latter. Typically, the algorithm in <a class="auto internal xref" href="#simple-randomization2">Section 7.1.2</a> results in a more uniform distribution of the generated transient numeric identifiers. However, for transient numeric identifiers where an implementation typically keeps local state about unsuitable/used identifiers, the algorithm in <a class="auto internal xref" href="#simple-randomization2">Section 7.1.2</a> may require many more iterations than the algorithm in <a class="auto internal xref" href="#simple-randomization">Section 7.1.1</a> to generate a suitable transient numeric identifier. This will usually be affected by the current usage ratio of transient numeric identifiers (i.e., the number of numeric identifiers considered suitable / total number of numeric identifiers) and other parameters. Therefore, in such cases, many implementations tend to prefer the algorithm in <a class="auto internal xref" href="#simple-randomization">Section 7.1.1</a> over the algorithm in <a class="auto internal xref" href="#simple-randomization2">Section 7.1.2</a>.<a class="pilcrow" href="#section-7.1-9">¶</a></p>
<div id="simple-randomization">
<section id="section-7.1.1">
          <h4 id="name-simple-randomization-algori">
<a class="section-number selfRef" href="#section-7.1.1">7.1.1. </a><a class="section-name selfRef" href="#name-simple-randomization-algori">Simple Randomization Algorithm</a>
          </h4>
<div class="lang-c sourcecode" id="section-7.1.1-1">
<pre>    /* Transient Numeric ID selection function */

    id_range = max_id - min_id + 1;
    next_id = min_id + (random() % id_range);
    retry = id_range;

    do {
        if (suitable_id(next_id)) {
            return next_id;
        }

        if (next_id == max_id) {
            next_id = min_id;
        } else {
            next_id++;
        }

        retry--;

    } while (retry &gt; 0);

    return ERROR;
</pre><a class="pilcrow" href="#section-7.1.1-1">¶</a>
</div>
<p id="section-7.1.1-2">NOTE:<a class="pilcrow" href="#section-7.1.1-2">¶</a></p>
<p id="section-7.1.1-3" style="margin-left: 1.5em">random() is a PRNG that returns a pseudorandom unsigned integer number of appropriate size. Beware that "adapting" the length of the output of random() with a modulo operator (e.g., C language's "%") may change the distribution of the PRNG. To preserve a uniform distribution, the rejection sampling technique <span>[<a class="cite xref" href="#Romailler2020">Romailler2020</a>]</span> can be used.<a class="pilcrow" href="#section-7.1.1-3">¶</a></p>
<p id="section-7.1.1-4" style="margin-left: 1.5em">suitable_id() is a function that checks, if possible and desirable, whether a candidate numeric identifier is suitable (e.g., whether it is in use or has been recently employed). Depending on how/where the numeric identifier is used, it may or may not be possible (or even desirable) to check whether the numeric identifier is suitable.<a class="pilcrow" href="#section-7.1.1-4">¶</a></p>
<p id="section-7.1.1-5" style="margin-left: 1.5em">All the variables (in this algorithm and all the others algorithms discussed in this document) are unsigned integers.<a class="pilcrow" href="#section-7.1.1-5">¶</a></p>
<p id="section-7.1.1-6">When an identifier is found to be unsuitable, this algorithm selects the next available numeric identifier in sequence. Thus, even when this algorithm selects numeric identifiers randomly, it is biased towards the first available numeric identifier after a sequence of unavailable numeric identifiers. For example, if this algorithm is employed for transport-protocol ephemeral port randomization <span>[<a class="cite xref" href="#RFC6056">RFC6056</a>]</span> and the local list of unsuitable port numbers (e.g., registered port numbers that should not be used for ephemeral ports) is significant, an attacker may actually have a significantly better chance of guessing an ephemeral port number.<a class="pilcrow" href="#section-7.1.1-6">¶</a></p>
<p id="section-7.1.1-7">Assuming the randomness requirements for the PRNG are met (see <span>[<a class="cite xref" href="#RFC4086">RFC4086</a>]</span>), this algorithm does not suffer from any of the issues discussed in <a class="auto internal xref" href="#vulns">Section 8</a>.<a class="pilcrow" href="#section-7.1.1-7">¶</a></p>
</section>
</div>
<div id="simple-randomization2">
<section id="section-7.1.2">
          <h4 id="name-another-simple-randomizatio">
<a class="section-number selfRef" href="#section-7.1.2">7.1.2. </a><a class="section-name selfRef" href="#name-another-simple-randomizatio">Another Simple Randomization Algorithm</a>
          </h4>
<p id="section-7.1.2-1">The following pseudocode illustrates another algorithm for selecting a random transient numeric identifier where, in the event a selected identifier is found to be unsuitable (e.g., already in use), another identifier is randomly selected:<a class="pilcrow" href="#section-7.1.2-1">¶</a></p>
<div class="lang-c sourcecode" id="section-7.1.2-2">
<pre>    /* Transient Numeric ID selection function */

    id_range = max_id - min_id + 1;
    retry = id_range;

    do {
        next_id = min_id + (random() % id_range);

        if (suitable_id(next_id)) {
            return next_id;
        }

        retry--;

    } while (retry &gt; 0);

    return ERROR;
</pre><a class="pilcrow" href="#section-7.1.2-2">¶</a>
</div>
<p id="section-7.1.2-3">NOTE:<a class="pilcrow" href="#section-7.1.2-3">¶</a></p>
<p id="section-7.1.2-4" style="margin-left: 1.5em">random() is a PRNG that returns a pseudorandom unsigned integer number of appropriate size. Beware that "adapting" the length of the output of random() with a modulo operator (e.g., C language's "%") may change the distribution of the PRNG. To preserve a uniform distribution, the rejection sampling technique <span>[<a class="cite xref" href="#Romailler2020">Romailler2020</a>]</span> can be used.<a class="pilcrow" href="#section-7.1.2-4">¶</a></p>
<p id="section-7.1.2-5" style="margin-left: 1.5em">suitable_id() is a function that checks, if possible and desirable, whether a candidate numeric identifier is suitable (e.g., if it is not already in use). Depending on how/where the numeric identifier is used, it may or may not be possible (or even desirable) to check whether the numeric identifier is in use (or whether it has been recently employed).<a class="pilcrow" href="#section-7.1.2-5">¶</a></p>
<p id="section-7.1.2-6">When an identifier is found to be unsuitable, this algorithm selects another random numeric identifier. Thus, this algorithm might be unable to select a transient numeric identifier (i.e., return "ERROR"), even if there are suitable identifiers available, in cases where a large number of identifiers are found to be unsuitable (e.g., "in use").<a class="pilcrow" href="#section-7.1.2-6">¶</a></p>
<p id="section-7.1.2-7">Assuming the randomness requirements for the PRNG are met (see <span>[<a class="cite xref" href="#RFC4086">RFC4086</a>]</span>), this algorithm does not suffer from any of the issues discussed in <a class="auto internal xref" href="#vulns">Section 8</a>.<a class="pilcrow" href="#section-7.1.2-7">¶</a></p>
</section>
</div>
</section>
</div>
<div id="cat-2-alg">
<section id="section-7.2">
        <h3 id="name-category-2-uniqueness-hard-">
<a class="section-number selfRef" href="#section-7.2">7.2. </a><a class="section-name selfRef" href="#name-category-2-uniqueness-hard-">Category #2: Uniqueness (Hard Failure)</a>
        </h3>
<p id="section-7.2-1">One of the most trivial approaches for generating a unique transient numeric identifier (with a hard failure severity) is to reduce the identifier reuse frequency by generating the numeric identifiers with a monotonically increasing function (e.g., linear). As a result, any of the algorithms described in <a class="auto internal xref" href="#cat-4-alg">Section 7.4</a> ("Category #4: Uniqueness, Monotonically Increasing within Context (Hard Failure)") can be readily employed for complying with the requirements of this transient numeric identifier category.<a class="pilcrow" href="#section-7.2-1">¶</a></p>
<p id="section-7.2-2">In cases where suitability (e.g., uniqueness) of the selected identifiers can be definitely assessed by the local system, any of the algorithms described in <a class="auto internal xref" href="#cat-1-alg">Section 7.1</a> ("Category #1: Uniqueness (Soft Failure)") can be readily employed for complying with the requirements of this numeric identifier category.<a class="pilcrow" href="#section-7.2-2">¶</a></p>
<aside id="section-7.2-3">
          <p id="section-7.2-3.1">NOTE: In the case of, e.g., TCP ephemeral ports or TCP ISNs, a transient numeric identifier that might seem suitable from the perspective of the local system might actually be unsuitable from the perspective of the remote system (e.g., because there is state associated with the selected identifier at the remote system). Therefore, in such cases, it is not possible to employ the algorithms from <a class="auto internal xref" href="#cat-1-alg">Section 7.1</a> ("Category #1: Uniqueness (Soft Failure)").<a class="pilcrow" href="#section-7.2-3.1">¶</a></p>
</aside>
</section>
</div>
<div id="cat-3-alg">
<section id="section-7.3">
        <h3 id="name-category-3-uniqueness-stabl">
<a class="section-number selfRef" href="#section-7.3">7.3. </a><a class="section-name selfRef" href="#name-category-3-uniqueness-stabl">Category #3: Uniqueness, Stable within Context (Soft Failure)</a>
        </h3>
<p id="section-7.3-1">The goal of the following algorithm is to produce identifiers that are stable for a given context (identified by "CONTEXT") but that change when the aforementioned context changes.<a class="pilcrow" href="#section-7.3-1">¶</a></p>
<p id="section-7.3-2">In order to avoid storing the transient numeric identifiers computed for each CONTEXT in memory, the following algorithm employs a calculated technique (as opposed to keeping state in memory) to generate a stable transient numeric identifier for each given context.<a class="pilcrow" href="#section-7.3-2">¶</a></p>
<div class="lang-c sourcecode" id="section-7.3-3">
<pre>    /* Transient Numeric ID selection function  */

    id_range = max_id - min_id + 1;

    retry = 0;

    do {
        offset = F(CONTEXT, retry, secret_key);
        next_id = min_id + (offset % id_range);

        if (suitable_id(next_id)) {
            return next_id;
        }

        retry++;

    } while (retry &lt;= MAX_RETRIES);

    return ERROR;
</pre><a class="pilcrow" href="#section-7.3-3">¶</a>
</div>
<p id="section-7.3-4">NOTE:<a class="pilcrow" href="#section-7.3-4">¶</a></p>
<p id="section-7.3-5" style="margin-left: 1.5em">CONTEXT is the concatenation of all the elements that define a given context.<a class="pilcrow" href="#section-7.3-5">¶</a></p>
<p id="section-7.3-6" style="margin-left: 1.5em">F() is a pseudorandom function (PRF). It must not be computable from the outside (without knowledge of the secret key). F() must also be difficult to reverse, such that it resists attempts to obtain the secret key, even when given samples of the output of F() and knowledge or control of the other input parameters. F() should produce an output of at least as many bits as required for the transient numeric identifier. SipHash-2-4 (128-bit key, 64-bit output) <span>[<a class="cite xref" href="#SipHash">SipHash</a>]</span> and BLAKE3 (256-bit key, arbitrary-length output) <span>[<a class="cite xref" href="#BLAKE3">BLAKE3</a>]</span> are two possible options for F(). Alternatively, F() could be implemented with a keyed hash message authentication code (HMAC) <span>[<a class="cite xref" href="#RFC2104">RFC2104</a>]</span>. HMAC-SHA-256 <span>[<a class="cite xref" href="#FIPS-SHS">FIPS-SHS</a>]</span> would be one possible option for such implementation alternative. Note: Use of HMAC-MD5 <span>[<a class="cite xref" href="#RFC1321">RFC1321</a>]</span> or HMAC-SHA1 <span>[<a class="cite xref" href="#FIPS-SHS">FIPS-SHS</a>]</span> are not recommended for F() <span>[<a class="cite xref" href="#RFC6151">RFC6151</a>]</span> <span>[<a class="cite xref" href="#RFC6194">RFC6194</a>]</span>. The result of F() is no more secure than the secret key, and therefore, "secret_key" must be unknown to the attacker and must be of a reasonable length. "secret_key" must remain stable for a given CONTEXT, since otherwise, the numeric identifiers generated by this algorithm would not have the desired stability properties (i.e., stable for a given CONTEXT). In most cases, "secret_key" should be selected with a PRNG (see <span>[<a class="cite xref" href="#RFC4086">RFC4086</a>]</span> for recommendations on choosing secrets) at an appropriate time and stored in stable or volatile storage (as necessary) for future use.<a class="pilcrow" href="#section-7.3-6">¶</a></p>
<p id="section-7.3-7" style="margin-left: 1.5em">suitable_id() checks whether a candidate numeric identifier has suitable uniqueness properties.<a class="pilcrow" href="#section-7.3-7">¶</a></p>
<p id="section-7.3-8">In this algorithm, the function F() provides a stateless and stable per-CONTEXT offset, where CONTEXT is the concatenation of all the elements that define the given context.<a class="pilcrow" href="#section-7.3-8">¶</a></p>
<p id="section-7.3-9">For example, if this algorithm is expected to produce IPv6 IIDs that are unique per network interface and Stateless Address Autoconfiguration (SLAAC) prefix, CONTEXT should be the concatenation of, e.g., the network interface index and the SLAAC autoconfiguration prefix (please see <span>[<a class="cite xref" href="#RFC7217">RFC7217</a>]</span> for an implementation of this algorithm for generation of stable IPv6 addresses).<a class="pilcrow" href="#section-7.3-9">¶</a></p>
<p id="section-7.3-10">The result of F() is stored in the variable "offset", which may take any value within the storage type range, since we are restricting the resulting identifier to be in the range [min_id, max_id] in a similar way as in the algorithm described in <a class="auto internal xref" href="#simple-randomization">Section 7.1.1</a>.<a class="pilcrow" href="#section-7.3-10">¶</a></p>
<p id="section-7.3-11">As noted above, suitable_id() checks whether a candidate numeric identifier has suitable uniqueness properties. Collisions (i.e., an identifier that is not unique) are recovered by incrementing the "retry" variable and recomputing F(), up to a maximum of MAX_RETRIES times. However, recovering from collisions will usually result in identifiers that fail to remain constant for the specified context. This is normally acceptable when the probability of collisions is small, as in the case of, e.g., IPv6 IIDs resulting from SLAAC <span>[<a class="cite xref" href="#RFC7217">RFC7217</a>]</span> <span>[<a class="cite xref" href="#RFC8981">RFC8981</a>]</span>.<a class="pilcrow" href="#section-7.3-11">¶</a></p>
<p id="section-7.3-12">For obvious reasons, the transient numeric identifiers generated with this algorithm allow for network activity correlation and fingerprinting within "CONTEXT". However, this is essentially a design goal of this category of transient numeric identifiers.<a class="pilcrow" href="#section-7.3-12">¶</a></p>
</section>
</div>
<div id="cat-4-alg">
<section id="section-7.4">
        <h3 id="name-category-4-uniqueness-monot">
<a class="section-number selfRef" href="#section-7.4">7.4. </a><a class="section-name selfRef" href="#name-category-4-uniqueness-monot">Category #4: Uniqueness, Monotonically Increasing within Context (Hard Failure)</a>
        </h3>
<div id="per-context-counter">
<section id="section-7.4.1">
          <h4 id="name-per-context-counter-algorit">
<a class="section-number selfRef" href="#section-7.4.1">7.4.1. </a><a class="section-name selfRef" href="#name-per-context-counter-algorit">Per-Context Counter Algorithm</a>
          </h4>
<p id="section-7.4.1-1">One possible way of selecting unique monotonically increasing identifiers (per context) is to employ a per-context counter. Such an algorithm could be described as follows:<a class="pilcrow" href="#section-7.4.1-1">¶</a></p>
<div class="lang-c sourcecode" id="section-7.4.1-2">
<pre>    /* Transient Numeric ID selection function */

    id_range = max_id - min_id + 1;
    retry = id_range;
    id_inc = increment() % id_range;

    if( (next_id = lookup_counter(CONTEXT)) == ERROR){
         next_id = min_id + random() % id_range;
    }

    do {
        if ( (max_id - next_id) &gt;= id_inc){
            next_id = next_id + id_inc;
        }
        else {
            next_id = min_id + id_inc - (max_id - next_id);
        }

        if (suitable_id(next_id)){
            store_counter(CONTEXT, next_id);
            return next_id;
        }

        retry = retry - id_inc;

    } while (retry &gt; 0);

    return ERROR;
</pre><a class="pilcrow" href="#section-7.4.1-2">¶</a>
</div>
<p id="section-7.4.1-3">NOTE:<a class="pilcrow" href="#section-7.4.1-3">¶</a></p>
<p id="section-7.4.1-4" style="margin-left: 1.5em">CONTEXT is the concatenation of all the elements that define a given context.<a class="pilcrow" href="#section-7.4.1-4">¶</a></p>
<p id="section-7.4.1-5" style="margin-left: 1.5em">increment() returns a small integer that is employed to increment the current counter value to obtain the next transient numeric identifier. This value must be larger than or equal to 1, and much smaller than the number of possible values for the numeric identifiers (i.e., "id_range"). Most implementations of this algorithm employ a constant increment of 1. Using a value other than 1 can help mitigate some information leakages (please see below) at the expense of a possible increase in the numeric identifier reuse frequency. The code above makes sure that the increment employed in the algorithm (id_inc) is always smaller than the number of possible values for the numeric identifiers (i.e., "max_id - min_d + 1"). However, as noted above, this value must also be much smaller than the number of possible values for the numeric identifiers.<a class="pilcrow" href="#section-7.4.1-5">¶</a></p>
<p id="section-7.4.1-6" style="margin-left: 1.5em">lookup_counter() is a function that returns the current counter for a given context or an error condition if that counter does not exist.<a class="pilcrow" href="#section-7.4.1-6">¶</a></p>
<p id="section-7.4.1-7" style="margin-left: 1.5em">random() is a PRNG that returns a pseudorandom unsigned integer number of appropriate size. Beware that "adapting" the length of the output of random() with a modulo operator (e.g., C language's "%") may change the distribution of the PRNG. To preserve a uniform distribution, the rejection sampling technique <span>[<a class="cite xref" href="#Romailler2020">Romailler2020</a>]</span> can be used.<a class="pilcrow" href="#section-7.4.1-7">¶</a></p>
<p id="section-7.4.1-8" style="margin-left: 1.5em">store_counter() is a function that saves a counter value for a given context.<a class="pilcrow" href="#section-7.4.1-8">¶</a></p>
<p id="section-7.4.1-9" style="margin-left: 1.5em">suitable_id() checks whether a candidate numeric identifier has suitable uniqueness properties.<a class="pilcrow" href="#section-7.4.1-9">¶</a></p>
<p id="section-7.4.1-10">Essentially, whenever a new identifier is to be selected, the algorithm checks whether a counter for the corresponding context exists. If it does, the value of such counter is incremented to obtain the new transient numeric identifier, and the counter is updated. If no counter exists for such context, a new counter is created and initialized to a random value and used as the selected transient numeric identifier. This algorithm produces a per-context counter, which results in one monotonically increasing function for each context. Since each counter is initialized to a random value, the resulting values are unpredictable by an off-path attacker.<a class="pilcrow" href="#section-7.4.1-10">¶</a></p>
<p id="section-7.4.1-11">The choice of id_inc has implications on both the security and privacy properties of the resulting identifiers and also on the corresponding interoperability properties. On one hand, minimizing the increments generally minimizes the identifier reuse frequency, albeit at increased predictability. On the other hand, if the increments are randomized, predictability of the resulting identifiers is reduced, and the information leakage produced by global constant increments is mitigated. However, using larger increments than necessary can result in higher numeric identifier reuse frequency.<a class="pilcrow" href="#section-7.4.1-11">¶</a></p>
<p id="section-7.4.1-12">This algorithm has the following drawbacks:<a class="pilcrow" href="#section-7.4.1-12">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.4.1-13.1">It requires an implementation to store each per-context counter in memory. If, as a result of resource management, the counter for a given context must be removed, the last transient numeric identifier value used for that context will be lost.  Thus, if an identifier subsequently needs to be generated for the same context, the corresponding counter will need to be recreated and reinitialized to a random value, thus possibly leading to reuse/collision of numeric identifiers.<a class="pilcrow" href="#section-7.4.1-13.1">¶</a>
</li>
            <li class="normal" id="section-7.4.1-13.2">
Keeping one counter for each possible "context" may in some cases be considered too onerous in terms of memory requirements.<a class="pilcrow" href="#section-7.4.1-13.2">¶</a>
</li>
          </ul>
<p id="section-7.4.1-14">Otherwise, the identifiers produced by this algorithm do not suffer from the other issues discussed in <a class="auto internal xref" href="#vulns">Section 8</a>.<a class="pilcrow" href="#section-7.4.1-14">¶</a></p>
</section>
</div>
<div id="simple-hash">
<section id="section-7.4.2">
          <h4 id="name-simple-prf-based-algorithm">
<a class="section-number selfRef" href="#section-7.4.2">7.4.2. </a><a class="section-name selfRef" href="#name-simple-prf-based-algorithm">Simple PRF-Based Algorithm</a>
          </h4>
<p id="section-7.4.2-1">The goal of this algorithm is to produce monotonically increasing transient numeric identifiers (for each given context) with a randomized initial value. For example, if the identifiers being generated must be monotonically increasing for each {Source Address, Destination Address} set, then each possible combination of {Source Address, Destination Address} should have a separate monotonically increasing sequence that starts at a different random value.<a class="pilcrow" href="#section-7.4.2-1">¶</a></p>
<p id="section-7.4.2-2">Instead of maintaining a per-context counter (as in the algorithm from <a class="auto internal xref" href="#per-context-counter">Section 7.4.1</a>), the following algorithm employs a calculated technique to maintain a random offset for each possible context.<a class="pilcrow" href="#section-7.4.2-2">¶</a></p>
<div class="lang-c sourcecode" id="section-7.4.2-3">
<pre>    /* Initialization code */
    counter = 0;

    /* Transient Numeric ID selection function  */

    id_range = max_id - min_id + 1;
    id_inc = increment() % id_range;
    offset = F(CONTEXT, secret_key);
    retry = id_range;

    do {
        next_id = min_id + (offset + counter) % id_range;
        counter = counter + id_inc;

        if (suitable_id(next_id)) {
            return next_id;
        }

        retry = retry - id_inc;

    } while (retry &gt; 0);

    return ERROR;
</pre><a class="pilcrow" href="#section-7.4.2-3">¶</a>
</div>
<p id="section-7.4.2-4">NOTE:<a class="pilcrow" href="#section-7.4.2-4">¶</a></p>
<p id="section-7.4.2-5" style="margin-left: 1.5em">CONTEXT is the concatenation of all the elements that define a given context. For example, if this algorithm is expected to produce identifiers that are monotonically increasing for each set {Source Address, Destination Address}, CONTEXT should be the concatenation of Source Address and Destination Address.<a class="pilcrow" href="#section-7.4.2-5">¶</a></p>
<p id="section-7.4.2-6" style="margin-left: 1.5em">increment() has the same properties and requirements as those specified for increment() in <a class="auto internal xref" href="#per-context-counter">Section 7.4.1</a>.<a class="pilcrow" href="#section-7.4.2-6">¶</a></p>
<p id="section-7.4.2-7" style="margin-left: 1.5em">F() is a PRF, with the same properties as those specified for F() in <a class="auto internal xref" href="#cat-3-alg">Section 7.3</a>.<a class="pilcrow" href="#section-7.4.2-7">¶</a></p>
<p id="section-7.4.2-8" style="margin-left: 1.5em">suitable_id() checks whether a candidate numeric identifier has suitable uniqueness properties.<a class="pilcrow" href="#section-7.4.2-8">¶</a></p>
<p id="section-7.4.2-9">In the algorithm above, the function F() provides a stateless, stable, and unpredictable offset for each given context (as identified by "CONTEXT"). Both the "offset" and "counter" variables may take any value within
    the storage type range since we are restricting the resulting identifier to be in the range [min_id, max_id] in a similar way as in the algorithm described in <a class="auto internal xref" href="#simple-randomization">Section 7.1.1</a>.  This allows us
    to simply increment the "counter" variable and rely on the
    unsigned integer to wrap around.<a class="pilcrow" href="#section-7.4.2-9">¶</a></p>
<p id="section-7.4.2-10">
The result of F() is no more secure than the secret key, and therefore, "secret_key" must be unknown to the attacker and must be of a reasonable length. "secret_key" must remain stable for a given CONTEXT, since otherwise, the numeric identifiers generated by this algorithm would not have the desired properties (i.e., monotonically increasing for a given CONTEXT). In most cases, "secret_key" should be selected with a PRNG (see <span>[<a class="cite xref" href="#RFC4086">RFC4086</a>]</span> for recommendations on choosing secrets) at an appropriate time and stored in stable or volatile storage (as necessary) for future use.<a class="pilcrow" href="#section-7.4.2-10">¶</a></p>
<p id="section-7.4.2-11">It should be noted that, since this algorithm uses a global counter ("counter") for selecting identifiers (i.e., all counters share the same increment space), this algorithm results in an information leakage (as described in <a class="auto internal xref" href="#information-leakage">Section 8.2</a>). For example, if this algorithm was used for selecting TCP ephemeral ports and an attacker could force a client to periodically establish a new TCP connection to an attacker-controlled system (or through an attacker-observable routing path), the attacker could subtract consecutive Source Port values to obtain the number of outgoing TCP connections established globally by the victim host within that time period (up to wrap-around issues and five-tuple collisions, of course). This information leakage could be partially mitigated by employing small random values for the increments (i.e., increment() function), instead of having increment() return the constant "1".<a class="pilcrow" href="#section-7.4.2-11">¶</a></p>
<p id="section-7.4.2-12">We nevertheless note that an improved mitigation of this information leakage could be more successfully achieved by employing the algorithm from <a class="auto internal xref" href="#double-hash">Section 7.4.3</a>, instead.<a class="pilcrow" href="#section-7.4.2-12">¶</a></p>
</section>
</div>
<div id="double-hash">
<section id="section-7.4.3">
          <h4 id="name-double-prf-algorithm">
<a class="section-number selfRef" href="#section-7.4.3">7.4.3. </a><a class="section-name selfRef" href="#name-double-prf-algorithm">Double-PRF Algorithm</a>
          </h4>
<p id="section-7.4.3-1">A trade-off between maintaining a single global "counter" variable and maintaining 2**N "counter" variables (where N is the width of the result of F()) could be achieved as follows. The system would keep an array of TABLE_LENGTH values, which would provide a separation of the increment space into multiple buckets. This improvement could be incorporated into the algorithm from <a class="auto internal xref" href="#simple-hash">Section 7.4.2</a> as follows:<a class="pilcrow" href="#section-7.4.3-1">¶</a></p>
<div class="lang-c sourcecode" id="section-7.4.3-2">
<pre>    /* Initialization code */

    for(i = 0; i &lt; TABLE_LENGTH; i++) {
        table[i] = random();
    }

    /* Transient Numeric ID selection function */

    id_range = max_id - min_id + 1;
    id_inc = increment() % id_range;
    offset = F(CONTEXT, secret_key1);
    index = G(CONTEXT, secret_key2) % TABLE_LENGTH;
    retry = id_range;

    do {
        next_id = min_id + (offset + table[index]) % id_range;
        table[index] = table[index] + id_inc;

        if (suitable_id(next_id)) {
            return next_id;
        }

       retry = retry - id_inc;

    } while (retry &gt; 0);

    return ERROR;
</pre><a class="pilcrow" href="#section-7.4.3-2">¶</a>
</div>
<p id="section-7.4.3-3">NOTE:<a class="pilcrow" href="#section-7.4.3-3">¶</a></p>
<p id="section-7.4.3-4" style="margin-left: 1.5em">increment() has the same properties and requirements as those specified for increment() in <a class="auto internal xref" href="#per-context-counter">Section 7.4.1</a>.<a class="pilcrow" href="#section-7.4.3-4">¶</a></p>
<p id="section-7.4.3-5" style="margin-left: 1.5em">Both F() and G() are PRFs, with the same properties as those required for F() in <a class="auto internal xref" href="#cat-3-alg">Section 7.3</a>. The results of F() and G() are no more secure than their respective secret keys ("secret_key1" and "secret_key2", respectively), and therefore, both secret keys must be unknown to the attacker and must be of a reasonable length. Both secret keys must remain stable for the given CONTEXT, since otherwise, the transient numeric identifiers generated by this algorithm would not have the desired properties (i.e., monotonically increasing for a given CONTEXT). In most cases, both secret keys should be selected with a PRNG (see <span>[<a class="cite xref" href="#RFC4086">RFC4086</a>]</span> for recommendations on choosing secrets) at an appropriate time and stored in stable or volatile storage (as necessary) for future use.<a class="pilcrow" href="#section-7.4.3-5">¶</a></p>
<p id="section-7.4.3-6" style="margin-left: 1.5em">
"table[]" could be initialized with random values, as indicated by the initialization code in the pseudocode above.<a class="pilcrow" href="#section-7.4.3-6">¶</a></p>
<p id="section-7.4.3-7">The "table[]" array assures that successive transient numeric identifiers for a given context will be monotonically increasing. Since the increment space is separated into TABLE_LENGTH different spaces, the identifier reuse frequency will be (probabilistically) lower than that of the algorithm in <a class="auto internal xref" href="#simple-hash">Section 7.4.2</a>. That is, the generation of an identifier for one given context will not necessarily result in increments in the identifier sequence of other contexts. It is interesting to note that the size of "table[]" does not limit the number of different identifier sequences but rather separates the <strong>increment space</strong> into TABLE_LENGTH different spaces. The selected transient numeric identifier sequence will be obtained by adding the corresponding entry from "table[]" to the value in the "offset" variable, which selects the actual identifier sequence space (as in the algorithm from <a class="auto internal xref" href="#simple-hash">Section 7.4.2</a>).<a class="pilcrow" href="#section-7.4.3-7">¶</a></p>
<p id="section-7.4.3-8">An attacker can perform traffic analysis for any "increment
  space"  (i.e., context) into which the attacker has "visibility" -- namely, the attacker can force a system to generate identifiers for G(CONTEXT, secret_key2), where the result of G() identifies the target "increment space". However, the attacker's ability to perform traffic analysis is very reduced when compared to the simple PRF-based identifiers (described in <a class="auto internal xref" href="#simple-hash">Section 7.4.2</a>) and the predictable linear identifiers (described in <a class="auto internal xref" href="#trad_selection">Appendix A.1</a>). Additionally, an implementation can further limit the attacker's ability to perform traffic analysis by further separating the increment space (that is, using a larger value for TABLE_LENGTH) and/or by randomizing the increments (i.e., increment() returning a small random number as opposed to the constant "1").<a class="pilcrow" href="#section-7.4.3-8">¶</a></p>
<p id="section-7.4.3-9">Otherwise, this algorithm does not suffer from the issues discussed in <a class="auto internal xref" href="#vulns">Section 8</a>.<a class="pilcrow" href="#section-7.4.3-9">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="vulns">
<section id="section-8">
      <h2 id="name-common-vulnerabilities-asso">
<a class="section-number selfRef" href="#section-8">8. </a><a class="section-name selfRef" href="#name-common-vulnerabilities-asso">Common Vulnerabilities Associated with Transient Numeric Identifiers</a>
      </h2>
<div id="activity-correlation">
<section id="section-8.1">
        <h3 id="name-network-activity-correlatio">
<a class="section-number selfRef" href="#section-8.1">8.1. </a><a class="section-name selfRef" href="#name-network-activity-correlatio">Network Activity Correlation</a>
        </h3>
<p id="section-8.1-1">An identifier that is predictable within a given context allows for network activity correlation within that context.<a class="pilcrow" href="#section-8.1-1">¶</a></p>
<p id="section-8.1-2">For example, a stable IPv6 Interface Identifier allows for network activity to be correlated within the context in which the Interface Identifier is stable <span>[<a class="cite xref" href="#RFC7721">RFC7721</a>]</span>. A stable per-network IPv6 Interface Identifier (as in <span>[<a class="cite xref" href="#RFC7217">RFC7217</a>]</span>) allows for network activity correlation within a network, whereas a constant IPv6 Interface Identifier (which remains constant across networks) allows not only network activity correlation within the same network but also across networks ("host-tracking").<a class="pilcrow" href="#section-8.1-2">¶</a></p>
<p id="section-8.1-3">Similarly, an implementation that generates TCP ISNs with a global counter could allow for fingerprinting and network activity correlation across networks, since an attacker could passively infer the identity of the victim based on the TCP ISNs employed for subsequent communication instances. Similarly, an implementation that generates predictable IPv6 Identification values could be subject to fingerprinting attacks (see, e.g., <span>[<a class="cite xref" href="#Bellovin2002">Bellovin2002</a>]</span>).<a class="pilcrow" href="#section-8.1-3">¶</a></p>
</section>
</div>
<div id="information-leakage">
<section id="section-8.2">
        <h3 id="name-information-leakage">
<a class="section-number selfRef" href="#section-8.2">8.2. </a><a class="section-name selfRef" href="#name-information-leakage">Information Leakage</a>
        </h3>
<p id="section-8.2-1">Transient numeric identifiers that result in specific patterns can produce an information leakage to other communicating entities. For example, it is common to generate transient numeric identifiers with an algorithm such as:<a class="pilcrow" href="#section-8.2-1">¶</a></p>
<div class="lang-c sourcecode" id="section-8.2-2">
<pre>           ID = offset(CONTEXT) + mono(CONTEXT);
</pre><a class="pilcrow" href="#section-8.2-2">¶</a>
</div>
<p class="keepWithNext" id="section-8.2-3">

This generic expression generates identifiers by adding a monotonically increasing function (e.g., linear) to a randomized offset. offset() is constant within a given context, whereas mono() produces a monotonically increasing sequence for the given context. Identifiers generated with this expression will generally be predictable within CONTEXT.<a class="pilcrow" href="#section-8.2-3">¶</a></p>
<p id="section-8.2-4"></p>
<p id="section-8.2-5">The predictability of mono(), irrespective of the predictability of offset(), can leak information that may be of use to attackers. For example, a node that selects transport-protocol ephemeral port numbers, as in:<a class="pilcrow" href="#section-8.2-5">¶</a></p>
<div class="lang-c sourcecode" id="section-8.2-6">
<pre>           ephemeral_port = offset(IP_Dst_Addr) + mono()
</pre><a class="pilcrow" href="#section-8.2-6">¶</a>
</div>
<p class="keepWithNext" id="section-8.2-7">
that is, with a per-destination offset but a global mono() function (e.g., a global counter), will leak information about the total number of outgoing connections that have been issued by the vulnerable implementation.<a class="pilcrow" href="#section-8.2-7">¶</a></p>
<p id="section-8.2-8"></p>
<p id="section-8.2-9">Similarly, a node that generates IPv6 Identification values as in:<a class="pilcrow" href="#section-8.2-9">¶</a></p>
<div class="lang-c sourcecode" id="section-8.2-10">
<pre>           ID = offset(IP_Src_Addr, IP_Dst_Addr) + mono()
</pre><a class="pilcrow" href="#section-8.2-10">¶</a>
</div>
<p id="section-8.2-11">
will leak out information about the total number of fragmented packets that have been transmitted by the vulnerable implementation. The vulnerabilities described in <span>[<a class="cite xref" href="#Sanfilippo1998a">Sanfilippo1998a</a>]</span>, <span>[<a class="cite xref" href="#Sanfilippo1998b">Sanfilippo1998b</a>]</span>, and <span>[<a class="cite xref" href="#Sanfilippo1999">Sanfilippo1999</a>]</span> are all associated with the use of a global mono() function (i.e., with a global and constant "CONTEXT") -- particularly when it is a linear function (constant increments of 1).<a class="pilcrow" href="#section-8.2-11">¶</a></p>
<p id="section-8.2-12">Predicting transient numeric identifiers can be of help for other types of attacks. For example, predictable TCP ISNs can open the door to trivial connection-reset and data injection attacks (see <a class="auto internal xref" href="#injection-attacks">Section 8.6</a>).<a class="pilcrow" href="#section-8.2-12">¶</a></p>
</section>
</div>
<div id="fingerprinting">
<section id="section-8.3">
        <h3 id="name-fingerprinting">
<a class="section-number selfRef" href="#section-8.3">8.3. </a><a class="section-name selfRef" href="#name-fingerprinting">Fingerprinting</a>
        </h3>
<p id="section-8.3-1">Fingerprinting is the capability of an attacker to identify or reidentify a visiting user, user agent, or device via configuration settings or other observable characteristics. Observable protocol objects and characteristics can be employed to identify/reidentify
various entities. These entities can range from the underlying hardware or operating
system (OS) (vendor, type, and version) to the user. <span>[<a class="cite xref" href="#EFF">EFF</a>]</span> illustrates web-browser-based fingerprinting, but
similar techniques can be applied at other layers and protocols, whether
alternatively or in conjunction with it.<a class="pilcrow" href="#section-8.3-1">¶</a></p>
<p id="section-8.3-2">
Transient numeric identifiers are one of the observable protocol components that could be leveraged for fingerprinting purposes. That is, an attacker could sample transient numeric identifiers to infer the algorithm (and its associated parameters, if any) for generating such identifiers, possibly revealing the underlying OS vendor, type, and version. This information could possibly be further leveraged in conjunction with other fingerprinting techniques and sources.<a class="pilcrow" href="#section-8.3-2">¶</a></p>
<p id="section-8.3-3">
Evasion of protocol-stack fingerprinting can prove to be a very difficult task, i.e., most systems make use of a wide variety of protocols, each of which have a large number of parameters that can be set to arbitrary values or generated with a variety of algorithms with multiple parameters.<a class="pilcrow" href="#section-8.3-3">¶</a></p>
<aside id="section-8.3-4">
          <p id="section-8.3-4.1">NOTE: General protocol-based fingerprinting is discussed in <span>[<a class="cite xref" href="#RFC6973">RFC6973</a>]</span>,
   along with guidelines to mitigate the associated  vulnerability.
   <span>[<a class="cite xref" href="#Fyodor1998">Fyodor1998</a>]</span> and <span>[<a class="cite xref" href="#Fyodor2006">Fyodor2006</a>]</span> are classic references
   on OS detection via TCP/IP stack fingerprinting.
   Network Mapper <span>[<a class="cite xref" href="#nmap">nmap</a>]</span> is probably the most popular tool for remote OS
   identification via active TCP/IP stack fingerprinting. p0f <span>[<a class="cite xref" href="#Zalewski2012">Zalewski2012</a>]</span>,
   on the other hand, is a tool for performing remote OS detection via
   passive TCP/IP stack fingerprinting. Finally, <span>[<a class="cite xref" href="#TBIT">TBIT</a>]</span> is a TCP
   fingerprinting tool that aims at characterizing the behavior of a
   remote TCP peer based on active probes, which has been widely
   used in the research community.<a class="pilcrow" href="#section-8.3-4.1">¶</a></p>
</aside>
<p id="section-8.3-5">
Algorithms that, from the perspective of an observer (e.g., the legitimate communicating peer), result in specific values or patterns will allow for at least some level of fingerprinting. For example,
the algorithm from <a class="auto internal xref" href="#cat-3-alg">Section 7.3</a> will typically allow fingerprinting within the context where the resulting identifiers are stable. Similarly, the algorithms from <a class="auto internal xref" href="#cat-4-alg">Section 7.4</a> will result in monotonically increasing sequences within a given context, thus allowing for at least some level of fingerprinting (when the other communicating entity can correlate different sampled identifiers as belonging to the same monotonically increasing sequence).<a class="pilcrow" href="#section-8.3-5">¶</a></p>
<p id="section-8.3-6">
Thus, where possible, algorithms from <a class="auto internal xref" href="#cat-1-alg">Section 7.1</a> should be preferred over algorithms that result in specific values or patterns.<a class="pilcrow" href="#section-8.3-6">¶</a></p>
</section>
</div>
<div id="id-semantics">
<section id="section-8.4">
        <h3 id="name-exploitation-of-the-semanti">
<a class="section-number selfRef" href="#section-8.4">8.4. </a><a class="section-name selfRef" href="#name-exploitation-of-the-semanti">Exploitation of the Semantics of Transient Numeric Identifiers</a>
        </h3>
<p id="section-8.4-1">Identifiers that are not semantically opaque tend to be more predictable than semantically opaque identifiers. For example, a Media Access Control (MAC) address contains an  Organizationally Unique Identifier (OUI), which may identify the vendor that manufactured the corresponding network interface card. This can be leveraged by an attacker trying to "guess" MAC addresses, who has some knowledge about the possible Network Interface Card (NIC) vendor.<a class="pilcrow" href="#section-8.4-1">¶</a></p>
<p id="section-8.4-2"><span>[<a class="cite xref" href="#RFC7707">RFC7707</a>]</span> discusses a number of techniques to reduce the search space when performing IPv6 address-scanning attacks by leveraging the semantics of IPv6 IIDs.<a class="pilcrow" href="#section-8.4-2">¶</a></p>
</section>
</div>
<div id="id-collisions">
<section id="section-8.5">
        <h3 id="name-exploitation-of-collisions-">
<a class="section-number selfRef" href="#section-8.5">8.5. </a><a class="section-name selfRef" href="#name-exploitation-of-collisions-">Exploitation of Collisions of Transient Numeric Identifiers</a>
        </h3>
<p id="section-8.5-1">In many cases, the collision of transient network identifiers can have a hard failure severity (or result in a hard failure severity if an attacker can cause multiple collisions deterministically, one after another). For example, predictable IP Identification values open the door to Denial of Service (DoS) attacks (see, e.g., <span>[<a class="cite xref" href="#RFC5722">RFC5722</a>]</span>.).<a class="pilcrow" href="#section-8.5-1">¶</a></p>
</section>
</div>
<div id="injection-attacks">
<section id="section-8.6">
        <h3 id="name-exploitation-of-predictable">
<a class="section-number selfRef" href="#section-8.6">8.6. </a><a class="section-name selfRef" href="#name-exploitation-of-predictable">Exploitation of Predictable Transient Numeric Identifiers for Injection Attacks</a>
        </h3>
<p id="section-8.6-1">Some protocols rely on "sequence numbers" for the validation of incoming packets. For example, TCP employs sequence numbers for reassembling TCP segments, while IPv4 and IPv6 employ Identification values for reassembling IPv4 and IPv6 fragments (respectively). Lacking built-in cryptographic mechanisms for validating packets, these protocols are therefore vulnerable to on-path data (see, e.g., <span>[<a class="cite xref" href="#Joncheray1995">Joncheray1995</a>]</span>)  and/or control-information (see, e.g., <span>[<a class="cite xref" href="#RFC4953">RFC4953</a>]</span> and <span>[<a class="cite xref" href="#RFC5927">RFC5927</a>]</span>) injection attacks. The extent to which these protocols may resist off-path (i.e., "blind") injection attacks depends on whether the associated "sequence numbers" are predictable and the effort required to successfully predict a valid "sequence number" (see, e.g., <span>[<a class="cite xref" href="#RFC4953">RFC4953</a>]</span> and <span>[<a class="cite xref" href="#RFC5927">RFC5927</a>]</span>).<a class="pilcrow" href="#section-8.6-1">¶</a></p>
<p id="section-8.6-2">We note that the use of unpredictable "sequence numbers" is a completely ineffective mitigation for on-path injection attacks and also a mostly ineffective mitigation for off-path (i.e., "blind") injection attacks.
However, many legacy protocols (such as TCP) do not incorporate cryptographic mitigations as part of the core protocol but rather as optional features (see, e.g., <span>[<a class="cite xref" href="#RFC5925">RFC5925</a>]</span>), if available at all.
Additionally, ad hoc use of cryptographic mitigations might not be sufficient to relieve a protocol implementation of generating appropriate transient numeric identifiers. For example, use of the Transport Layer Security (TLS) protocol <span>[<a class="cite xref" href="#RFC8446">RFC8446</a>]</span> with TCP will protect the application protocol but will not help to mitigate, e.g., TCP-based connection-reset attacks (see, e.g., <span>[<a class="cite xref" href="#RFC4953">RFC4953</a>]</span>). Similarly, use of SEcure Neighbor Discovery (SEND) <span>[<a class="cite xref" href="#RFC3971">RFC3971</a>]</span> will still imply reliance on the successful reassembly of IPv6 fragments in those cases where SEND packets do not fit into the link Maximum Transmission Unit (MTU) (see <span>[<a class="cite xref" href="#RFC6980">RFC6980</a>]</span>).<a class="pilcrow" href="#section-8.6-2">¶</a></p>
</section>
</div>
<div id="crypto-analisis">
<section id="section-8.7">
        <h3 id="name-cryptanalysis">
<a class="section-number selfRef" href="#section-8.7">8.7. </a><a class="section-name selfRef" href="#name-cryptanalysis">Cryptanalysis</a>
        </h3>
<p id="section-8.7-1">A number of algorithms discussed in this document (such as those described in Sections <a class="auto internal xref" href="#simple-hash">7.4.2</a> and <a class="auto internal xref" href="#double-hash">7.4.3</a>) rely on PRFs. Implementations that employ weak PRFs or keys of inappropriate size can be subject to cryptanalysis, where an attacker can obtain the secret key employed for the PRF, predict numeric identifiers, etc.<a class="pilcrow" href="#section-8.7-1">¶</a></p>
<p id="section-8.7-2">Furthermore, an implementation that overloads the semantics of the secret key can result in more trivial cryptanalysis, possibly resulting in the leakage of the value employed for the secret key.<a class="pilcrow" href="#section-8.7-2">¶</a></p>
<aside id="section-8.7-3">
          <p id="section-8.7-3.1">NOTE: <span>[<a class="cite xref" href="#IPID-DEV">IPID-DEV</a>]</span> describes two vulnerable transient numeric identifier generators that employ cryptographically weak hash functions. Additionally, one of such implementations employs 32 bits of a kernel address as the secret key for a hash function, and therefore, successful cryptanalysis leaks the aforementioned kernel address, allowing for Kernel Address Space Layout Randomization (KASLR) <span>[<a class="cite xref" href="#KASLR">KASLR</a>]</span> bypass.<a class="pilcrow" href="#section-8.7-3.1">¶</a></p>
</aside>
</section>
</div>
</section>
</div>
<div id="vuln-cats">
<section id="section-9">
      <h2 id="name-vulnerability-assessment-of">
<a class="section-number selfRef" href="#section-9">9. </a><a class="section-name selfRef" href="#name-vulnerability-assessment-of">Vulnerability Assessment of Transient Numeric Identifiers</a>
      </h2>
<p id="section-9-1">
The following subsections analyze possible vulnerabilities associated with the algorithms described in <a class="auto internal xref" href="#common-algorithms">Section 7</a>.<a class="pilcrow" href="#section-9-1">¶</a></p>
<div id="cat-1-vuln">
<section id="section-9.1">
        <h3 id="name-category-1-uniqueness-soft-f">
<a class="section-number selfRef" href="#section-9.1">9.1. </a><a class="section-name selfRef" href="#name-category-1-uniqueness-soft-f">Category #1: Uniqueness (Soft Failure)</a>
        </h3>
<p id="section-9.1-1">Possible vulnerabilities associated with the algorithms from <a class="auto internal xref" href="#cat-1-alg">Section 7.1</a> include the following:<a class="pilcrow" href="#section-9.1-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.1-2.1">use of flawed PRNGs (please see, e.g., <span>[<a class="cite xref" href="#Zalewski2001">Zalewski2001</a>]</span>, <span>[<a class="cite xref" href="#Zalewski2002">Zalewski2002</a>]</span>, <span>[<a class="cite xref" href="#Klein2007">Klein2007</a>]</span>, and <span>[<a class="cite xref" href="#CVEs">CVEs</a>]</span>)<a class="pilcrow" href="#section-9.1-2.1">¶</a>
</li>
          <li class="normal" id="section-9.1-2.2">inadvertently affecting the distribution of an otherwise suitable PRNG (please see, e.g., <span>[<a class="cite xref" href="#Romailler2020">Romailler2020</a>]</span>)<a class="pilcrow" href="#section-9.1-2.2">¶</a>
</li>
        </ul>
<p id="section-9.1-3">Where available, CSPRNGs should be preferred over regular PRNGs, such as, e.g., POSIX random(3) implementations. In scenarios where a CSPRNG is not readily available, a security and privacy assessment of employing a regular PRNG should be performed, supporting the implementation decision.<a class="pilcrow" href="#section-9.1-3">¶</a></p>
<aside id="section-9.1-4">
          <p id="section-9.1-4.1">NOTE: Please see <span>[<a class="cite xref" href="#RFC4086">RFC4086</a>]</span> regarding randomness requirements for security. <span>[<a class="cite xref" href="#Aumasson2018">Aumasson2018</a>]</span>, <span>[<a class="cite xref" href="#Press1992">Press1992</a>]</span>, and <span>[<a class="cite xref" href="#Knuth1983">Knuth1983</a>]</span> discuss theoretical and practical aspects of random number generation and provide guidance on how to evaluate PRNGs.<a class="pilcrow" href="#section-9.1-4.1">¶</a></p>
</aside>
<p id="section-9.1-5">When employing a PRNG, many implementations "adapt" the length of its output with a modulo operator (e.g., C language's "%"), possibly changing the distribution of the output of the PRNG.<a class="pilcrow" href="#section-9.1-5">¶</a></p>
<p id="section-9.1-6">
For example, consider an implementation that employs the following code:<a class="pilcrow" href="#section-9.1-6">¶</a></p>
<div class="lang-c sourcecode" id="section-9.1-7">
<pre>           id = random() % 50000;
</pre><a class="pilcrow" href="#section-9.1-7">¶</a>
</div>
<p class="keepWithNext" id="section-9.1-8">
This example implementation means to obtain a transient numeric identifier in the range 0-49999. If random() produces, e.g., a pseudorandom number of 16 bits (with uniform distribution), the selected transient numeric identifier will have a nonuniform distribution with the numbers in the range 0-15535 having double frequency than the numbers in the range 15536-49999.<a class="pilcrow" href="#section-9.1-8">¶</a></p>
<p id="section-9.1-9"></p>
<aside id="section-9.1-10">
          <p id="section-9.1-10.1">NOTE: For example, in our sample code, both an output of 10 and output of 50010 from the random() function will result in an "id" value of 10.<a class="pilcrow" href="#section-9.1-10.1">¶</a></p>
</aside>
<p id="section-9.1-11">
This effect is reduced if the PRNG produces an output that is much longer than the length implied by the modulo operation. We note that to preserve a uniform distribution, the rejection sampling technique <span>[<a class="cite xref" href="#Romailler2020">Romailler2020</a>]</span> can be used.<a class="pilcrow" href="#section-9.1-11">¶</a></p>
<p id="section-9.1-12">
Use of algorithms other than PRNGs for generating identifiers of this category is discouraged.<a class="pilcrow" href="#section-9.1-12">¶</a></p>
</section>
</div>
<div id="cat-2-vuln">
<section id="section-9.2">
        <h3 id="name-category-2-uniqueness-hard-f">
<a class="section-number selfRef" href="#section-9.2">9.2. </a><a class="section-name selfRef" href="#name-category-2-uniqueness-hard-f">Category #2: Uniqueness (Hard Failure)</a>
        </h3>
<p id="section-9.2-1">As noted in <a class="auto internal xref" href="#cat-2-alg">Section 7.2</a>, this category can employ the same algorithms as Category #4, since a monotonically increasing sequence tends to minimize the transient numeric identifier reuse frequency. Therefore, the vulnerability analysis in <a class="auto internal xref" href="#cat-4-vuln">Section 9.4</a> also applies to this category.<a class="pilcrow" href="#section-9.2-1">¶</a></p>
<p id="section-9.2-2">Additionally, as noted in <a class="auto internal xref" href="#cat-2-alg">Section 7.2</a>, some transient numeric identifiers of this category might be able to use the algorithms from  <a class="auto internal xref" href="#cat-1-alg">Section 7.1</a>, in which case the same considerations as in <a class="auto internal xref" href="#cat-1-vuln">Section 9.1</a> would apply.<a class="pilcrow" href="#section-9.2-2">¶</a></p>
</section>
</div>
<div id="cat-3-vuln">
<section id="section-9.3">
        <h3 id="name-category-3-uniqueness-stable">
<a class="section-number selfRef" href="#section-9.3">9.3. </a><a class="section-name selfRef" href="#name-category-3-uniqueness-stable">Category #3: Uniqueness, Stable within Context (Soft Failure)</a>
        </h3>
<p id="section-9.3-1">Possible vulnerabilities associated with the algorithms from <a class="auto internal xref" href="#cat-3-alg">Section 7.3</a> are the following:<a class="pilcrow" href="#section-9.3-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.3-2.1">Use of weak PRFs or inappropriate secret keys (whether inappropriate selection or inappropriate size) could allow for cryptanalysis, which could eventually be exploited by an attacker to predict future transient numeric identifiers.<a class="pilcrow" href="#section-9.3-2.1">¶</a>
</li>
          <li class="normal" id="section-9.3-2.2">Since the algorithm generates a unique and stable identifier within a specified context, it may allow for network activity correlation and fingerprinting within the specified context.<a class="pilcrow" href="#section-9.3-2.2">¶</a>
</li>
        </ul>
</section>
</div>
<div id="cat-4-vuln">
<section id="section-9.4">
        <h3 id="name-category-4-uniqueness-monoto">
<a class="section-number selfRef" href="#section-9.4">9.4. </a><a class="section-name selfRef" href="#name-category-4-uniqueness-monoto">Category #4: Uniqueness, Monotonically Increasing within Context (Hard Failure)</a>
        </h3>
<p id="section-9.4-1">The algorithm described in <a class="auto internal xref" href="#per-context-counter">Section 7.4.1</a> for generating identifiers of Category #4 will result in an identifiable pattern (i.e., a monotonically increasing sequence) for the transient numeric identifiers generated for each CONTEXT, and thus will allow for fingerprinting and network activity correlation within each CONTEXT.<a class="pilcrow" href="#section-9.4-1">¶</a></p>
<p id="section-9.4-2">On the other hand, a simple way to generalize and analyze the algorithms described in Sections <a class="auto internal xref" href="#simple-hash">7.4.2</a> and <a class="auto internal xref" href="#double-hash">7.4.3</a> for generating identifiers of Category #4 is as follows:<a class="pilcrow" href="#section-9.4-2">¶</a></p>
<div class="lang-c sourcecode" id="section-9.4-3">
<pre>    /* Transient Numeric ID selection function */

    id_range = max_id - min_id + 1;
    retry = id_range;
    id_inc = increment() % id_range;

    do {
        update_mono(CONTEXT, id_inc);
        next_id = min_id + (offset(CONTEXT) + \
                            mono(CONTEXT)) % id_range;

        if (suitable_id(next_id)) {
            return next_id;
        }

        retry = retry - id_inc;

    } while (retry &gt; 0);

    return ERROR;
</pre><a class="pilcrow" href="#section-9.4-3">¶</a>
</div>
<p id="section-9.4-4">NOTE:<a class="pilcrow" href="#section-9.4-4">¶</a></p>
<p id="section-9.4-5" style="margin-left: 1.5em">increment() returns a small integer that is employed to generate a monotonically increasing function. Most implementations employ a constant value for "increment()" (usually 1). The value returned by increment() must be much smaller than the value computed for "id_range".<a class="pilcrow" href="#section-9.4-5">¶</a></p>
<p id="section-9.4-6" style="margin-left: 1.5em">update_mono(CONTEXT, id_inc) increments the counter corresponding to CONTEXT by "id_inc".<a class="pilcrow" href="#section-9.4-6">¶</a></p>
<p id="section-9.4-7" style="margin-left: 1.5em">mono(CONTEXT) reads the counter corresponding to CONTEXT.<a class="pilcrow" href="#section-9.4-7">¶</a></p>
<p id="section-9.4-8">Essentially, an identifier (next_id) is generated by adding a monotonically increasing function (mono()) to an offset value, which is unknown to the attacker and stable for given context (CONTEXT).<a class="pilcrow" href="#section-9.4-8">¶</a></p>
<p id="section-9.4-9">The following aspects of the algorithm should be considered:<a class="pilcrow" href="#section-9.4-9">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.4-10.1">For the most part, it is the offset() function that results in identifiers that are unpredictable by an off-patch attacker. While the resulting sequence is known to be monotonically increasing, the use of a randomized offset value makes the resulting values unknown to the attacker.<a class="pilcrow" href="#section-9.4-10.1">¶</a>
</li>
          <li class="normal" id="section-9.4-10.2">The most straightforward "stateless" implementation of offset() is with a PRF that takes the values that identify the context and a secret key (not shown in the figure above) as arguments.<a class="pilcrow" href="#section-9.4-10.2">¶</a>
</li>
          <li class="normal" id="section-9.4-10.3">
One possible implementation of mono() would be to have mono() internally employ a single counter (as in the algorithm from <a class="auto internal xref" href="#simple-hash">Section 7.4.2</a>) or map the increments for different contexts into a number of counters/buckets, such that the number of counters that need to be maintained in memory is reduced (as in the "Double-PRF Algorithm" from <a class="auto internal xref" href="#double-hash">Section 7.4.3</a>).<a class="pilcrow" href="#section-9.4-10.3">¶</a>
</li>
          <li class="normal" id="section-9.4-10.4">In all cases, a monotonically increasing function is implemented by incrementing the previous value of a counter by increment() units. In the most trivial case, increment() could return the constant "1". But increment() could also be implemented to return small random integers such that the increments are unpredictable (see <a class="auto internal xref" href="#random-increments">Appendix A.2</a> of this document). This represents a trade-off between the unpredictability of the resulting transient numeric identifiers and the transient numeric identifier reuse frequency.<a class="pilcrow" href="#section-9.4-10.4">¶</a>
</li>
        </ul>
<p id="section-9.4-11">Considering the generic algorithm illustrated above, we can identify the following possible vulnerabilities:<a class="pilcrow" href="#section-9.4-11">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.4-12.1">Since the algorithms for this category are similar to those of <a class="auto internal xref" href="#cat-3-vuln">Section 9.3</a>, with the addition of a monotonically increasing function, all the issues discussed in <a class="auto internal xref" href="#cat-3-vuln">Section 9.3</a> ("Category #3: Uniqueness, Stable within Context (Soft Failure)") also apply to this case.<a class="pilcrow" href="#section-9.4-12.1">¶</a>
</li>
          <li class="normal" id="section-9.4-12.2">mono() can be correlated to the number of identifiers generated for a given context (CONTEXT). Thus, if mono() spans more than the necessary context, the "increments" could be leaked to other parties, thus disclosing information about the number of identifiers that have been generated by the algorithm for all contexts. This information disclosure becomes more evident when an implementation employs a constant increment of 1.


For example, an implementation where mono() is actually a single global counter will unnecessarily leak information about the number of identifiers that have been generated by the algorithm (globally, for all contexts). <span>[<a class="cite xref" href="#Fyodor2003">Fyodor2003</a>]</span> describes one example of how such information leakages can be exploited. We note that limiting the span of the increment space will require a larger number of counters to be stored in memory (i.e., a larger value for the TABLE_LENGTH parameter of the algorithm in <a class="auto internal xref" href="#double-hash">Section 7.4.3</a>).<a class="pilcrow" href="#section-9.4-12.2">¶</a>
</li>
          <li class="normal" id="section-9.4-12.3">Transient numeric identifiers generated with the algorithms described in Sections <a class="auto internal xref" href="#simple-hash">7.4.2</a> and <a class="auto internal xref" href="#double-hash">7.4.3</a> will normally allow for fingerprinting within CONTEXT since, for such context, the resulting identifiers will have an identifiable pattern (i.e., a monotonically increasing sequence).<a class="pilcrow" href="#section-9.4-12.3">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-10">
      <h2 id="name-iana-considerations">
<a class="section-number selfRef" href="#section-10">10. </a><a class="section-name selfRef" href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<p id="section-10-1">This document has no IANA actions.<a class="pilcrow" href="#section-10-1">¶</a></p>
</section>
</div>
<section id="section-11">
      <h2 id="name-security-considerations">
<a class="section-number selfRef" href="#section-11">11. </a><a class="section-name selfRef" href="#name-security-considerations">Security Considerations</a>
      </h2>
<p id="section-11-1">This entire document is about the security and privacy implications of transient numeric identifiers. <span>[<a class="cite xref" href="#RFC9416">RFC9416</a>]</span> recommends that protocol specifications specify the interoperability requirements of their transient numeric identifiers, perform a vulnerability assessment of their transient numeric identifiers, and recommend an algorithm for generating each of their transient numeric identifiers. This document analyzes possible algorithms (and their implications) that could be employed to comply with the interoperability requirements of the most common categories of transient numeric identifiers while minimizing the associated negative security and privacy implications.<a class="pilcrow" href="#section-11-1">¶</a></p>
</section>
<section id="section-12">
      <h2 id="name-references">
<a class="section-number selfRef" href="#section-12">12. </a><a class="section-name selfRef" href="#name-references">References</a>
      </h2>
<section id="section-12.1">
        <h3 id="name-normative-references">
<a class="section-number selfRef" href="#section-12.1">12.1. </a><a class="section-name selfRef" href="#name-normative-references">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC0791">[RFC0791]</dt>
        <dd>
<span class="refAuthor">Postel, J.</span>, <span class="refTitle">"Internet Protocol"</span>, <span class="seriesInfo">STD 5</span>, <span class="seriesInfo">RFC 791</span>, <span class="seriesInfo">DOI 10.17487/RFC0791</span>, <time class="refDate" datetime="1981-09">September 1981</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc791">https://www.rfc-editor.org/info/rfc791</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC0793">[RFC0793]</dt>
        <dd>
<span class="refAuthor">Postel, J.</span>, <span class="refTitle">"Transmission Control Protocol"</span>, <span class="seriesInfo">RFC 793</span>, <span class="seriesInfo">DOI 10.17487/RFC0793</span>, <time class="refDate" datetime="1981-09">September 1981</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc793">https://www.rfc-editor.org/info/rfc793</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1035">[RFC1035]</dt>
        <dd>
<span class="refAuthor">Mockapetris, P.</span>, <span class="refTitle">"Domain names - implementation and specification"</span>, <span class="seriesInfo">STD 13</span>, <span class="seriesInfo">RFC 1035</span>, <span class="seriesInfo">DOI 10.17487/RFC1035</span>, <time class="refDate" datetime="1987-11">November 1987</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1035">https://www.rfc-editor.org/info/rfc1035</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1321">[RFC1321]</dt>
        <dd>
<span class="refAuthor">Rivest, R.</span>, <span class="refTitle">"The MD5 Message-Digest Algorithm"</span>, <span class="seriesInfo">RFC 1321</span>, <span class="seriesInfo">DOI 10.17487/RFC1321</span>, <time class="refDate" datetime="1992-04">April 1992</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1321">https://www.rfc-editor.org/info/rfc1321</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2460">[RFC2460]</dt>
        <dd>
<span class="refAuthor">Deering, S.</span> and <span class="refAuthor">R. Hinden</span>, <span class="refTitle">"Internet Protocol, Version 6 (IPv6) Specification"</span>, <span class="seriesInfo">RFC 2460</span>, <span class="seriesInfo">DOI 10.17487/RFC2460</span>, <time class="refDate" datetime="1998-12">December 1998</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2460">https://www.rfc-editor.org/info/rfc2460</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4086">[RFC4086]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span>, <span class="refAuthor">Schiller, J.</span>, and <span class="refAuthor">S. Crocker</span>, <span class="refTitle">"Randomness Requirements for Security"</span>, <span class="seriesInfo">BCP 106</span>, <span class="seriesInfo">RFC 4086</span>, <span class="seriesInfo">DOI 10.17487/RFC4086</span>, <time class="refDate" datetime="2005-06">June 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4086">https://www.rfc-editor.org/info/rfc4086</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4291">[RFC4291]</dt>
        <dd>
<span class="refAuthor">Hinden, R.</span> and <span class="refAuthor">S. Deering</span>, <span class="refTitle">"IP Version 6 Addressing Architecture"</span>, <span class="seriesInfo">RFC 4291</span>, <span class="seriesInfo">DOI 10.17487/RFC4291</span>, <time class="refDate" datetime="2006-02">February 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4291">https://www.rfc-editor.org/info/rfc4291</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4862">[RFC4862]</dt>
        <dd>
<span class="refAuthor">Thomson, S.</span>, <span class="refAuthor">Narten, T.</span>, and <span class="refAuthor">T. Jinmei</span>, <span class="refTitle">"IPv6 Stateless Address Autoconfiguration"</span>, <span class="seriesInfo">RFC 4862</span>, <span class="seriesInfo">DOI 10.17487/RFC4862</span>, <time class="refDate" datetime="2007-09">September 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4862">https://www.rfc-editor.org/info/rfc4862</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5722">[RFC5722]</dt>
        <dd>
<span class="refAuthor">Krishnan, S.</span>, <span class="refTitle">"Handling of Overlapping IPv6 Fragments"</span>, <span class="seriesInfo">RFC 5722</span>, <span class="seriesInfo">DOI 10.17487/RFC5722</span>, <time class="refDate" datetime="2009-12">December 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5722">https://www.rfc-editor.org/info/rfc5722</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5905">[RFC5905]</dt>
        <dd>
<span class="refAuthor">Mills, D.</span>, <span class="refAuthor">Martin, J., Ed.</span>, <span class="refAuthor">Burbank, J.</span>, and <span class="refAuthor">W. Kasch</span>, <span class="refTitle">"Network Time Protocol Version 4: Protocol and Algorithms Specification"</span>, <span class="seriesInfo">RFC 5905</span>, <span class="seriesInfo">DOI 10.17487/RFC5905</span>, <time class="refDate" datetime="2010-06">June 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5905">https://www.rfc-editor.org/info/rfc5905</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5925">[RFC5925]</dt>
        <dd>
<span class="refAuthor">Touch, J.</span>, <span class="refAuthor">Mankin, A.</span>, and <span class="refAuthor">R. Bonica</span>, <span class="refTitle">"The TCP Authentication Option"</span>, <span class="seriesInfo">RFC 5925</span>, <span class="seriesInfo">DOI 10.17487/RFC5925</span>, <time class="refDate" datetime="2010-06">June 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5925">https://www.rfc-editor.org/info/rfc5925</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6056">[RFC6056]</dt>
        <dd>
<span class="refAuthor">Larsen, M.</span> and <span class="refAuthor">F. Gont</span>, <span class="refTitle">"Recommendations for Transport-Protocol Port Randomization"</span>, <span class="seriesInfo">BCP 156</span>, <span class="seriesInfo">RFC 6056</span>, <span class="seriesInfo">DOI 10.17487/RFC6056</span>, <time class="refDate" datetime="2011-01">January 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6056">https://www.rfc-editor.org/info/rfc6056</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6151">[RFC6151]</dt>
        <dd>
<span class="refAuthor">Turner, S.</span> and <span class="refAuthor">L. Chen</span>, <span class="refTitle">"Updated Security Considerations for the MD5 Message-Digest and the HMAC-MD5 Algorithms"</span>, <span class="seriesInfo">RFC 6151</span>, <span class="seriesInfo">DOI 10.17487/RFC6151</span>, <time class="refDate" datetime="2011-03">March 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6151">https://www.rfc-editor.org/info/rfc6151</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6191">[RFC6191]</dt>
        <dd>
<span class="refAuthor">Gont, F.</span>, <span class="refTitle">"Reducing the TIME-WAIT State Using TCP Timestamps"</span>, <span class="seriesInfo">BCP 159</span>, <span class="seriesInfo">RFC 6191</span>, <span class="seriesInfo">DOI 10.17487/RFC6191</span>, <time class="refDate" datetime="2011-04">April 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6191">https://www.rfc-editor.org/info/rfc6191</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6437">[RFC6437]</dt>
        <dd>
<span class="refAuthor">Amante, S.</span>, <span class="refAuthor">Carpenter, B.</span>, <span class="refAuthor">Jiang, S.</span>, and <span class="refAuthor">J. Rajahalme</span>, <span class="refTitle">"IPv6 Flow Label Specification"</span>, <span class="seriesInfo">RFC 6437</span>, <span class="seriesInfo">DOI 10.17487/RFC6437</span>, <time class="refDate" datetime="2011-11">November 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6437">https://www.rfc-editor.org/info/rfc6437</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6528">[RFC6528]</dt>
        <dd>
<span class="refAuthor">Gont, F.</span> and <span class="refAuthor">S. Bellovin</span>, <span class="refTitle">"Defending against Sequence Number Attacks"</span>, <span class="seriesInfo">RFC 6528</span>, <span class="seriesInfo">DOI 10.17487/RFC6528</span>, <time class="refDate" datetime="2012-02">February 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6528">https://www.rfc-editor.org/info/rfc6528</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7217">[RFC7217]</dt>
        <dd>
<span class="refAuthor">Gont, F.</span>, <span class="refTitle">"A Method for Generating Semantically Opaque Interface Identifiers with IPv6 Stateless Address Autoconfiguration (SLAAC)"</span>, <span class="seriesInfo">RFC 7217</span>, <span class="seriesInfo">DOI 10.17487/RFC7217</span>, <time class="refDate" datetime="2014-04">April 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7217">https://www.rfc-editor.org/info/rfc7217</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7323">[RFC7323]</dt>
        <dd>
<span class="refAuthor">Borman, D.</span>, <span class="refAuthor">Braden, B.</span>, <span class="refAuthor">Jacobson, V.</span>, and <span class="refAuthor">R. Scheffenegger, Ed.</span>, <span class="refTitle">"TCP Extensions for High Performance"</span>, <span class="seriesInfo">RFC 7323</span>, <span class="seriesInfo">DOI 10.17487/RFC7323</span>, <time class="refDate" datetime="2014-09">September 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7323">https://www.rfc-editor.org/info/rfc7323</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8064">[RFC8064]</dt>
        <dd>
<span class="refAuthor">Gont, F.</span>, <span class="refAuthor">Cooper, A.</span>, <span class="refAuthor">Thaler, D.</span>, and <span class="refAuthor">W. Liu</span>, <span class="refTitle">"Recommendation on Stable IPv6 Interface Identifiers"</span>, <span class="seriesInfo">RFC 8064</span>, <span class="seriesInfo">DOI 10.17487/RFC8064</span>, <time class="refDate" datetime="2017-02">February 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8064">https://www.rfc-editor.org/info/rfc8064</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8200">[RFC8200]</dt>
        <dd>
<span class="refAuthor">Deering, S.</span> and <span class="refAuthor">R. Hinden</span>, <span class="refTitle">"Internet Protocol, Version 6 (IPv6) Specification"</span>, <span class="seriesInfo">STD 86</span>, <span class="seriesInfo">RFC 8200</span>, <span class="seriesInfo">DOI 10.17487/RFC8200</span>, <time class="refDate" datetime="2017-07">July 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8200">https://www.rfc-editor.org/info/rfc8200</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8981">[RFC8981]</dt>
        <dd>
<span class="refAuthor">Gont, F.</span>, <span class="refAuthor">Krishnan, S.</span>, <span class="refAuthor">Narten, T.</span>, and <span class="refAuthor">R. Draves</span>, <span class="refTitle">"Temporary Address Extensions for Stateless Address Autoconfiguration in IPv6"</span>, <span class="seriesInfo">RFC 8981</span>, <span class="seriesInfo">DOI 10.17487/RFC8981</span>, <time class="refDate" datetime="2021-02">February 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8981">https://www.rfc-editor.org/info/rfc8981</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9293">[RFC9293]</dt>
      <dd>
<span class="refAuthor">Eddy, W., Ed.</span>, <span class="refTitle">"Transmission Control Protocol (TCP)"</span>, <span class="seriesInfo">STD 7</span>, <span class="seriesInfo">RFC 9293</span>, <span class="seriesInfo">DOI 10.17487/RFC9293</span>, <time class="refDate" datetime="2022-08">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9293">https://www.rfc-editor.org/info/rfc9293</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-12.2">
        <h3 id="name-informative-references">
<a class="section-number selfRef" href="#section-12.2">12.2. </a><a class="section-name selfRef" href="#name-informative-references">Informative References</a>
        </h3>
<dl class="references">
<dt id="ARC4RANDOM">[ARC4RANDOM]</dt>
        <dd>
<span class="refAuthor">OpenBSD</span>, <span class="refTitle">"arc4random(3)"</span>, <span class="refContent">Library Functions Manual</span>, <time class="refDate" datetime="2019-09">September 2019</time>, <span>&lt;<a href="https://man.openbsd.org/arc4random">https://man.openbsd.org/arc4random</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Aumasson2018">[Aumasson2018]</dt>
        <dd>
<span class="refAuthor">Aumasson, J-P.</span>, <span class="refTitle">"Serious Cryptography: A Practical Introduction to Modern Encryption"</span>, <span class="refContent">No Starch Press, Inc.</span>, <span class="seriesInfo">ISBN-10 1-59327-826-8</span>, <time class="refDate" datetime="2017-11">November 2017</time>. </dd>
<dd class="break"></dd>
<dt id="Bellovin1989">[Bellovin1989]</dt>
        <dd>
<span class="refAuthor">Bellovin, S.</span>, <span class="refTitle">"Security Problems in the TCP/IP Protocol Suite"</span>, <span class="refContent">Computer Communications Review, Vol. 19, No. 2, pp. 32-48</span>, <time class="refDate" datetime="1989-04">April 1989</time>, <span>&lt;<a href="https://www.cs.columbia.edu/~smb/papers/ipext.pdf">https://www.cs.columbia.edu/~smb/papers/ipext.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Bellovin2002">[Bellovin2002]</dt>
        <dd>
<span class="refAuthor">Bellovin, S.</span>, <span class="refTitle">"A Technique for Counting NATted Hosts"</span>, <span class="refContent">IMW'02, Marseille, France</span>, <span class="seriesInfo">ISBN 1-58113-603-X/02/0011</span>, <time class="refDate" datetime="2002-11">November 2002</time>, <span>&lt;<a href="https://www.cs.columbia.edu/~smb/papers/fnat.pdf">https://www.cs.columbia.edu/~smb/papers/fnat.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="BLAKE3">[BLAKE3]</dt>
        <dd>
<span class="refTitle">"BLAKE3: one function, fast everywhere"</span>, <time class="refDate" datetime="2022-09">September 2022</time>, <span>&lt;<a href="https://blake3.io/">https://blake3.io/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="C11">[C11]</dt>
        <dd>
<span class="refAuthor">ISO/IEC</span>, <span class="refTitle">"Information technology - Programming languages - C"</span>, <span class="seriesInfo">ISO/IEC 9899:2018</span>, <time class="refDate" datetime="2018-06">June 2018</time>. </dd>
<dd class="break"></dd>
<dt id="CPNI-TCP">[CPNI-TCP]</dt>
        <dd>
<span class="refAuthor">Centre for the Protection of National Infrastructure (CPNI)</span>, <span class="refTitle">"Security Assessment of the Transmission Control Protocol (TCP)"</span>, <span class="seriesInfo">CPNI Technical Note 3/2009</span>, <time class="refDate" datetime="2009-02">February 2009</time>, <span>&lt;<a href="https://www.si6networks.com/files/publications/tn-03-09-security-assessment-TCP.pdf">https://www.si6networks.com/files/publications/tn-03-09-security-assessment-TCP.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="CVEs">[CVEs]</dt>
        <dd>
<span class="refAuthor">NVD</span>, <span class="refTitle">"Vulnerability Advisories for PRNGs"</span>, <span>&lt;<a href="https://www.gont.com.ar/miscellanea/prng-cves/">https://www.gont.com.ar/miscellanea/prng-cves/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="EFF">[EFF]</dt>
        <dd>
<span class="refAuthor">EFF</span>, <span class="refTitle">"Cover your tracks: See how trackers view your browser"</span>, <span>&lt;<a href="https://coveryourtracks.eff.org/">https://coveryourtracks.eff.org/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="FIPS-SHS">[FIPS-SHS]</dt>
        <dd>
<span class="refAuthor">NIST</span>, <span class="refTitle">"Secure Hash Standard (SHS)"</span>, <span class="seriesInfo">FIPS PUB 180-4</span>, <span class="seriesInfo">DOI 10.6028/NIST.FIPS.180-4</span>, <time class="refDate" datetime="2015-08">August 2015</time>, <span>&lt;<a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf">https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Fyodor1998">[Fyodor1998]</dt>
        <dd>
<span class="refAuthor">Fyodor</span>, <span class="refTitle">"Remote OS detection via TCP/IP Stack FingerPrinting"</span>, <span class="refContent">Phrack Magazine, Volume 8, Issue 54</span>, <time class="refDate" datetime="1998-12">December 1998</time>, <span>&lt;<a href="http://www.phrack.org/archives/issues/54/9.txt">http://www.phrack.org/archives/issues/54/9.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Fyodor2003">[Fyodor2003]</dt>
        <dd>
<span class="refAuthor">Fyodor</span>, <span class="refTitle">"Idle Scanning and related IPID games"</span>, <time class="refDate" datetime="2003">2003</time>, <span>&lt;<a href="https://nmap.org/presentations/CanSecWest03/CD_Content/idlescan_paper/idlescan.html">https://nmap.org/presentations/CanSecWest03/CD_Content/idlescan_paper/idlescan.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Fyodor2006">[Fyodor2006]</dt>
        <dd>
<span class="refAuthor">Lyon, G.</span>, <span class="refTitle">"Chapter 8. Remote OS Detection"</span>, <time class="refDate" datetime="2009-01">January 2009</time>, <span>&lt;<a href="https://nmap.org/book/osdetect.html">https://nmap.org/book/osdetect.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="GETENTROPY">[GETENTROPY]</dt>
        <dd>
<span class="refAuthor">Linux</span>, <span class="refTitle">"getentropy(3)"</span>, <span class="refContent">Linux Programmer's Manual</span>, <time class="refDate" datetime="2021-03">March 2021</time>, <span>&lt;<a href="https://man7.org/linux/man-pages/man3/getentropy.3.html">https://man7.org/linux/man-pages/man3/getentropy.3.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA-PROT">[IANA-PROT]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Protocol Registries"</span>, <span>&lt;<a href="https://www.iana.org/protocols">https://www.iana.org/protocols</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IPID-DEV">[IPID-DEV]</dt>
        <dd>
<span class="refAuthor">Klein, A.</span> and <span class="refAuthor">B. Pinkas</span>, <span class="refTitle">"From IP ID to Device ID and KASLR Bypass (Extended Version)"</span>, <span class="seriesInfo">DOI 10.48550/arXiv.1906.10478</span>, <time class="refDate" datetime="2019-10">October 2019</time>, <span>&lt;<a href="https://arxiv.org/pdf/1906.10478.pdf">https://arxiv.org/pdf/1906.10478.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Joncheray1995">[Joncheray1995]</dt>
        <dd>
<span class="refAuthor">Joncheray, L.</span>, <span class="refTitle">"Simple Active Attack Against TCP"</span>, <span class="refContent">Proceedings of the Fifth USENIX UNIX Security Symposium</span>, <time class="refDate" datetime="1995-06">June 1995</time>, <span>&lt;<a href="https://www.usenix.org/legacy/publications/library/proceedings/security95/full_papers/joncheray.pdf">https://www.usenix.org/legacy/publications/library/proceedings/security95/full_papers/joncheray.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="KASLR">[KASLR]</dt>
        <dd>
<span class="refAuthor">PaX Team</span>, <span class="refTitle">"Address Space Layout Randomization"</span>, <span>&lt;<a href="https://pax.grsecurity.net/docs/aslr.txt">https://pax.grsecurity.net/docs/aslr.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Klein2007">[Klein2007]</dt>
        <dd>
<span class="refAuthor">Klein, A.</span>, <span class="refTitle">"OpenBSD DNS Cache Poisoning and Multiple O/S Predictable IP ID Vulnerability"</span>, <time class="refDate" datetime="2007-11">November 2007</time>, <span>&lt;<a href="https://dl.packetstormsecurity.net/papers/attack/OpenBSD_DNS_Cache_Poisoning_and_Multiple_OS_Predictable_IP_ID_Vulnerability.pdf">https://dl.packetstormsecurity.net/papers/attack/OpenBSD_DNS_Cache_Poisoning_and_Multiple_OS_Predictable_IP_ID_Vulnerability.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Knuth1983">[Knuth1983]</dt>
        <dd>
<span class="refAuthor">Knuth, D.</span>, <span class="refTitle">"The Art of Computer Programming"</span>, <span class="refContent">Volume 2 (Seminumerical Algorithms), 2nd Ed., Reading, Massachusetts, Addison-Wesley Publishing Company</span>, <time class="refDate" datetime="1981-01">January 1981</time>. </dd>
<dd class="break"></dd>
<dt id="Morris1985">[Morris1985]</dt>
        <dd>
<span class="refAuthor">Morris, R.</span>, <span class="refTitle">"A Weakness in the 4.2BSD UNIX TCP/IP Software"</span>, <span class="refContent">CSTR 117, AT&amp;T Bell Laboratories, Murray Hill, NJ</span>, <time class="refDate" datetime="1985-02">February 1985</time>, <span>&lt;<a href="https://pdos.csail.mit.edu/~rtm/papers/117.pdf">https://pdos.csail.mit.edu/~rtm/papers/117.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="nmap">[nmap]</dt>
        <dd>
<span class="refAuthor">nmap</span>, <span class="refTitle">"Nmap: Free Security Scanner For Network Exploration and Audit"</span>, <time class="refDate" datetime="2020">2020</time>, <span>&lt;<a href="https://nmap.org/">https://nmap.org/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="POSIX">[POSIX]</dt>
        <dd>
<span class="refAuthor">IEEE</span>, <span class="refTitle">"IEEE Standard for Information Technology -- Portable Operating System Interface (POSIX(TM)) Base Specifications, Issue 7"</span>, <span class="seriesInfo">IEEE Std 1003.1-2017</span>, <span class="seriesInfo">DOI 10.1109/IEEESTD.2018.8277153</span>, <time class="refDate" datetime="2018-01">January 2018</time>, <span>&lt;<a href="https://doi.org/10.1109/IEEESTD.2018.8277153">https://doi.org/10.1109/IEEESTD.2018.8277153</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Press1992">[Press1992]</dt>
        <dd>
<span class="refAuthor">Press, W.</span>, <span class="refAuthor">Teukolsky, S.</span>, <span class="refAuthor">Vetterling, W.</span>, and <span class="refAuthor">B. Flannery</span>, <span class="refTitle">"Numerical Recipes in C: The Art of Scientific Computing"</span>, <span class="refContent">2nd Ed., Cambridge University Press</span>, <span class="seriesInfo">ISBN 0-521-43108-5</span>, <time class="refDate" datetime="1992-12">December 1992</time>. </dd>
<dd class="break"></dd>
<dt id="RFC2104">[RFC2104]</dt>
        <dd>
<span class="refAuthor">Krawczyk, H.</span>, <span class="refAuthor">Bellare, M.</span>, and <span class="refAuthor">R. Canetti</span>, <span class="refTitle">"HMAC: Keyed-Hashing for Message Authentication"</span>, <span class="seriesInfo">RFC 2104</span>, <span class="seriesInfo">DOI 10.17487/RFC2104</span>, <time class="refDate" datetime="1997-02">February 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2104">https://www.rfc-editor.org/info/rfc2104</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3971">[RFC3971]</dt>
        <dd>
<span class="refAuthor">Arkko, J., Ed.</span>, <span class="refAuthor">Kempf, J.</span>, <span class="refAuthor">Zill, B.</span>, and <span class="refAuthor">P. Nikander</span>, <span class="refTitle">"SEcure Neighbor Discovery (SEND)"</span>, <span class="seriesInfo">RFC 3971</span>, <span class="seriesInfo">DOI 10.17487/RFC3971</span>, <time class="refDate" datetime="2005-03">March 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3971">https://www.rfc-editor.org/info/rfc3971</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4953">[RFC4953]</dt>
        <dd>
<span class="refAuthor">Touch, J.</span>, <span class="refTitle">"Defending TCP Against Spoofing Attacks"</span>, <span class="seriesInfo">RFC 4953</span>, <span class="seriesInfo">DOI 10.17487/RFC4953</span>, <time class="refDate" datetime="2007-07">July 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4953">https://www.rfc-editor.org/info/rfc4953</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4963">[RFC4963]</dt>
        <dd>
<span class="refAuthor">Heffner, J.</span>, <span class="refAuthor">Mathis, M.</span>, and <span class="refAuthor">B. Chandler</span>, <span class="refTitle">"IPv4 Reassembly Errors at High Data Rates"</span>, <span class="seriesInfo">RFC 4963</span>, <span class="seriesInfo">DOI 10.17487/RFC4963</span>, <time class="refDate" datetime="2007-07">July 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4963">https://www.rfc-editor.org/info/rfc4963</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5927">[RFC5927]</dt>
        <dd>
<span class="refAuthor">Gont, F.</span>, <span class="refTitle">"ICMP Attacks against TCP"</span>, <span class="seriesInfo">RFC 5927</span>, <span class="seriesInfo">DOI 10.17487/RFC5927</span>, <time class="refDate" datetime="2010-07">July 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5927">https://www.rfc-editor.org/info/rfc5927</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6194">[RFC6194]</dt>
        <dd>
<span class="refAuthor">Polk, T.</span>, <span class="refAuthor">Chen, L.</span>, <span class="refAuthor">Turner, S.</span>, and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Security Considerations for the SHA-0 and SHA-1 Message-Digest Algorithms"</span>, <span class="seriesInfo">RFC 6194</span>, <span class="seriesInfo">DOI 10.17487/RFC6194</span>, <time class="refDate" datetime="2011-03">March 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6194">https://www.rfc-editor.org/info/rfc6194</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6274">[RFC6274]</dt>
        <dd>
<span class="refAuthor">Gont, F.</span>, <span class="refTitle">"Security Assessment of the Internet Protocol Version 4"</span>, <span class="seriesInfo">RFC 6274</span>, <span class="seriesInfo">DOI 10.17487/RFC6274</span>, <time class="refDate" datetime="2011-07">July 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6274">https://www.rfc-editor.org/info/rfc6274</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6973">[RFC6973]</dt>
        <dd>
<span class="refAuthor">Cooper, A.</span>, <span class="refAuthor">Tschofenig, H.</span>, <span class="refAuthor">Aboba, B.</span>, <span class="refAuthor">Peterson, J.</span>, <span class="refAuthor">Morris, J.</span>, <span class="refAuthor">Hansen, M.</span>, and <span class="refAuthor">R. Smith</span>, <span class="refTitle">"Privacy Considerations for Internet Protocols"</span>, <span class="seriesInfo">RFC 6973</span>, <span class="seriesInfo">DOI 10.17487/RFC6973</span>, <time class="refDate" datetime="2013-07">July 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6973">https://www.rfc-editor.org/info/rfc6973</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6980">[RFC6980]</dt>
        <dd>
<span class="refAuthor">Gont, F.</span>, <span class="refTitle">"Security Implications of IPv6 Fragmentation with IPv6 Neighbor Discovery"</span>, <span class="seriesInfo">RFC 6980</span>, <span class="seriesInfo">DOI 10.17487/RFC6980</span>, <time class="refDate" datetime="2013-08">August 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6980">https://www.rfc-editor.org/info/rfc6980</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7098">[RFC7098]</dt>
        <dd>
<span class="refAuthor">Carpenter, B.</span>, <span class="refAuthor">Jiang, S.</span>, and <span class="refAuthor">W. Tarreau</span>, <span class="refTitle">"Using the IPv6 Flow Label for Load Balancing in Server Farms"</span>, <span class="seriesInfo">RFC 7098</span>, <span class="seriesInfo">DOI 10.17487/RFC7098</span>, <time class="refDate" datetime="2014-01">January 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7098">https://www.rfc-editor.org/info/rfc7098</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7258">[RFC7258]</dt>
        <dd>
<span class="refAuthor">Farrell, S.</span> and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"Pervasive Monitoring Is an Attack"</span>, <span class="seriesInfo">BCP 188</span>, <span class="seriesInfo">RFC 7258</span>, <span class="seriesInfo">DOI 10.17487/RFC7258</span>, <time class="refDate" datetime="2014-05">May 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7258">https://www.rfc-editor.org/info/rfc7258</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7707">[RFC7707]</dt>
        <dd>
<span class="refAuthor">Gont, F.</span> and <span class="refAuthor">T. Chown</span>, <span class="refTitle">"Network Reconnaissance in IPv6 Networks"</span>, <span class="seriesInfo">RFC 7707</span>, <span class="seriesInfo">DOI 10.17487/RFC7707</span>, <time class="refDate" datetime="2016-03">March 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7707">https://www.rfc-editor.org/info/rfc7707</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7721">[RFC7721]</dt>
        <dd>
<span class="refAuthor">Cooper, A.</span>, <span class="refAuthor">Gont, F.</span>, and <span class="refAuthor">D. Thaler</span>, <span class="refTitle">"Security and Privacy Considerations for IPv6 Address Generation Mechanisms"</span>, <span class="seriesInfo">RFC 7721</span>, <span class="seriesInfo">DOI 10.17487/RFC7721</span>, <time class="refDate" datetime="2016-03">March 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7721">https://www.rfc-editor.org/info/rfc7721</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7739">[RFC7739]</dt>
        <dd>
<span class="refAuthor">Gont, F.</span>, <span class="refTitle">"Security Implications of Predictable Fragment Identification Values"</span>, <span class="seriesInfo">RFC 7739</span>, <span class="seriesInfo">DOI 10.17487/RFC7739</span>, <time class="refDate" datetime="2016-02">February 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7739">https://www.rfc-editor.org/info/rfc7739</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time class="refDate" datetime="2018-08">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8937">[RFC8937]</dt>
        <dd>
<span class="refAuthor">Cremers, C.</span>, <span class="refAuthor">Garratt, L.</span>, <span class="refAuthor">Smyshlyaev, S.</span>, <span class="refAuthor">Sullivan, N.</span>, and <span class="refAuthor">C. Wood</span>, <span class="refTitle">"Randomness Improvements for Security Protocols"</span>, <span class="seriesInfo">RFC 8937</span>, <span class="seriesInfo">DOI 10.17487/RFC8937</span>, <time class="refDate" datetime="2020-10">October 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8937">https://www.rfc-editor.org/info/rfc8937</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9414">[RFC9414]</dt>
        <dd>
<span class="refAuthor">Gont, F.</span> and <span class="refAuthor">I. Arce</span>, <span class="refTitle">"Unfortunate History of Transient Numeric Identifiers"</span>, <span class="seriesInfo">RFC 9414</span>, <span class="seriesInfo">DOI 10.17487/RFC9414</span>, <time class="refDate" datetime="2023-07">July 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9414">https://www.rfc-editor.org/info/rfc9414</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9416">[RFC9416]</dt>
        <dd>
<span class="refAuthor">Gont, F.</span> and <span class="refAuthor">I. Arce</span>, <span class="refTitle">"Security Considerations for Transient Numeric Identifiers Employed in Network Protocols"</span>, <span class="seriesInfo">BCP 72</span>, <span class="seriesInfo">RFC 9416</span>, <span class="seriesInfo">DOI 10.17487/RFC9416</span>, <time class="refDate" datetime="2023-07">July 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9416">https://www.rfc-editor.org/info/rfc9416</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Romailler2020">[Romailler2020]</dt>
        <dd>
<span class="refAuthor">Romailler, Y.</span>, <span class="refTitle">"The Definitive Guide to "Modulo Bias and How to Avoid It"!"</span>, <span class="refContent">Kudelski Security Research</span>, <time class="refDate" datetime="2020-07">July 2020</time>, <span>&lt;<a href="https://research.kudelskisecurity.com/2020/07/28/the-definitive-guide-to-modulo-bias-and-how-to-avoid-it/">https://research.kudelskisecurity.com/2020/07/28/the-definitive-guide-to-modulo-bias-and-how-to-avoid-it/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Sanfilippo1998a">[Sanfilippo1998a]</dt>
        <dd>
<span class="refAuthor">Sanfilippo, S.</span>, <span class="refTitle">"about the ip header id"</span>, <span class="refContent">message to the Bugtraq mailing list</span>, <time class="refDate" datetime="1998-12">December 1998</time>, <span>&lt;<a href="http://seclists.org/bugtraq/1998/Dec/48">http://seclists.org/bugtraq/1998/Dec/48</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Sanfilippo1998b">[Sanfilippo1998b]</dt>
        <dd>
<span class="refAuthor">Sanfilippo, S.</span>, <span class="refTitle">"new tcp scan method"</span>, <span class="refContent">message to the Bugtraq mailing list</span>, <time class="refDate" datetime="1998-12-18">18 December 1998</time>, <span>&lt;<a href="https://seclists.org/bugtraq/1998/Dec/79">https://seclists.org/bugtraq/1998/Dec/79</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Sanfilippo1999">[Sanfilippo1999]</dt>
        <dd>
<span class="refAuthor">Sanfilippo, S.</span>, <span class="refTitle">"more ip id"</span>, <span class="refContent">message to the Bugtraq mailing list</span>, <time class="refDate" datetime="1999-11">November 1999</time>, <span>&lt;<a href="https://github.com/antirez/hping/raw/master/docs/MORE-FUN-WITH-IPID">https://github.com/antirez/hping/raw/master/docs/MORE-FUN-WITH-IPID</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Schuba1993">[Schuba1993]</dt>
        <dd>
<span class="refAuthor">Schuba, C.</span>, <span class="refTitle">"Addressing Weakness in the Domain Name System Protocol"</span>, <time class="refDate" datetime="1993-08">August 1993</time>, <span>&lt;<a href="http://ftp.cerias.purdue.edu/pub/papers/christoph-schuba/schuba-DNS-msthesis.pdf">http://ftp.cerias.purdue.edu/pub/papers/christoph-schuba/schuba-DNS-msthesis.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Shimomura1995">[Shimomura1995]</dt>
        <dd>
<span class="refAuthor">Shimomura, T.</span>, <span class="refTitle">"Technical details of the attack described by Markoff in NYT"</span>, <span class="refContent">message to the USENET comp.security.misc newsgroup</span>, <time class="refDate" datetime="1995-01-25">25 January 1995</time>, <span>&lt;<a href="https://www.gont.com.ar/files/post-shimomura-usenet.txt">https://www.gont.com.ar/files/post-shimomura-usenet.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Silbersack2005">[Silbersack2005]</dt>
        <dd>
<span class="refAuthor">Silbersack, M.</span>, <span class="refTitle">"Improving TCP/IP security through randomization without sacrificing interoperability"</span>, <span class="refContent">EuroBSDCon 2005 Conference</span>, <span>&lt;<a href="https://www.silby.com/eurobsdcon05/eurobsdcon_silbersack.pdf">https://www.silby.com/eurobsdcon05/eurobsdcon_silbersack.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SipHash">[SipHash]</dt>
        <dd>
<span class="refTitle">"SipHash: a fast short-input PRF"</span>, <time class="refDate" datetime="2023-02">February 2023</time>, <span>&lt;<a href="https://github.com/veorq/SipHash">https://github.com/veorq/SipHash</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TBIT">[TBIT]</dt>
        <dd>
<span class="refAuthor">TBIT</span>, <span class="refTitle">"TBIT, the TCP Behavior Inference Tool"</span>, <time class="refDate" datetime="2001">2001</time>, <span>&lt;<a href="https://www.icir.org/tbit/">https://www.icir.org/tbit/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TCPT-uptime">[TCPT-uptime]</dt>
        <dd>
<span class="refAuthor">McDanel, B.</span>, <span class="refTitle">"TCP Timestamping - Obtaining System Uptime Remotely"</span>, <span class="refContent">message to the Bugtraq mailing list</span>, <time class="refDate" datetime="2001-03">March 2001</time>, <span>&lt;<a href="https://seclists.org/bugtraq/2001/Mar/182">https://seclists.org/bugtraq/2001/Mar/182</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Zalewski2001">[Zalewski2001]</dt>
        <dd>
<span class="refAuthor">Zalewski, M.</span>, <span class="refTitle">"Strange Attractors and TCP/IP Sequence Number Analysis"</span>, <time class="refDate" datetime="2001-04">April 2001</time>, <span>&lt;<a href="https://lcamtuf.coredump.cx/oldtcp/tcpseq.html">https://lcamtuf.coredump.cx/oldtcp/tcpseq.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Zalewski2002">[Zalewski2002]</dt>
        <dd>
<span class="refAuthor">Zalewski, M.</span>, <span class="refTitle">"Strange Attractors and TCP/IP Sequence Number Analysis - One Year Later (2002)"</span>, <span>&lt;<a href="https://lcamtuf.coredump.cx/newtcp/">https://lcamtuf.coredump.cx/newtcp/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Zalewski2012">[Zalewski2012]</dt>
      <dd>
<span class="refAuthor">Zalewski, M.</span>, <span class="refTitle">"p0f v3 (3.09b)"</span>, <span>&lt;<a href="https://lcamtuf.coredump.cx/p0f.shtml">https://lcamtuf.coredump.cx/p0f.shtml</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="fawed-algorithms">
<section id="appendix-A">
      <h2 id="name-algorithms-and-techniques-w">
<a class="section-number selfRef" href="#appendix-A">Appendix A. </a><a class="section-name selfRef" href="#name-algorithms-and-techniques-w">Algorithms and Techniques with Known Issues</a>
      </h2>
<p id="appendix-A-1">The following subsections discuss algorithms and techniques with known negative security and privacy implications.<a class="pilcrow" href="#appendix-A-1">¶</a></p>
<aside id="appendix-A-2">
        <p id="appendix-A-2.1">NOTE: As discussed in <a class="auto internal xref" href="#intro">Section 1</a>, the use of cryptographic techniques might allow for the safe use of some of these algorithms and techniques. However, this should be evaluated on a case-by-case basis.<a class="pilcrow" href="#appendix-A-2.1">¶</a></p>
</aside>
<div id="trad_selection">
<section id="appendix-A.1">
        <h3 id="name-predictable-linear-identifi">
<a class="section-number selfRef" href="#appendix-A.1">A.1. </a><a class="section-name selfRef" href="#name-predictable-linear-identifi">Predictable Linear Identifiers Algorithm</a>
        </h3>
<p id="appendix-A.1-1">One of the most trivial ways to achieve uniqueness with a low identifier reuse frequency is to produce a linear sequence. This type of algorithm has been employed in the past to generate identifiers of Categories #1, #2, and #4 (please see <a class="auto internal xref" href="#categorizing">Section 6</a> for an analysis of these categories).<a class="pilcrow" href="#appendix-A.1-1">¶</a></p>
<p id="appendix-A.1-2">
For example, the following algorithm has been employed (see, e.g., <span>[<a class="cite xref" href="#Morris1985">Morris1985</a>]</span>, <span>[<a class="cite xref" href="#Shimomura1995">Shimomura1995</a>]</span>, <span>[<a class="cite xref" href="#Silbersack2005">Silbersack2005</a>]</span>, and <span>[<a class="cite xref" href="#CPNI-TCP">CPNI-TCP</a>]</span>) in a number of operating systems for selecting IP IDs, TCP ephemeral port numbers, etc.:<a class="pilcrow" href="#appendix-A.1-2">¶</a></p>
<div class="lang-c sourcecode" id="appendix-A.1-3">
<pre>    /* Initialization code */

    next_id = min_id;
    id_inc= 1;


    /* Transient Numeric ID selection function */

    id_range = max_id - min_id + 1;
    retry = id_range;

    do {
        if (next_id == max_id) {
            next_id = min_id;
        }
        else {
            next_id = next_id + id_inc;
        }

        if (suitable_id(next_id)) {
            return next_id;
        }

        retry--;

    } while (retry &gt; 0);

    return ERROR;
</pre><a class="pilcrow" href="#appendix-A.1-3">¶</a>
</div>
<p id="appendix-A.1-4">NOTE:<a class="pilcrow" href="#appendix-A.1-4">¶</a></p>
<p id="appendix-A.1-5" style="margin-left: 1.5em">suitable_id() checks whether a candidate numeric identifier is suitable (e.g., whether it is unique or not).<a class="pilcrow" href="#appendix-A.1-5">¶</a></p>
<p id="appendix-A.1-6">For obvious reasons, this algorithm results in predictable sequences. Since a global counter is used to generate the transient numeric identifiers ("next_id" in the example above), an entity that learns one numeric identifier can infer past numeric identifiers and predict future values to be generated by the same algorithm. Since the value employed for the increments is known (such as "1" in this case), an attacker can sample two values and learn the number of identifiers that were generated in between the two sampled values. Furthermore, if the counter is initialized, to some known value (e.g., when the system is bootstrapped), the algorithm will leak additional information, such as the number of transmitted fragmented datagrams in the case of an IP ID generator <span>[<a class="cite xref" href="#Sanfilippo1998a">Sanfilippo1998a</a>]</span> or the system uptime in the case of TCP timestamps <span>[<a class="cite xref" href="#TCPT-uptime">TCPT-uptime</a>]</span>.<a class="pilcrow" href="#appendix-A.1-6">¶</a></p>
</section>
</div>
<div id="random-increments">
<section id="appendix-A.2">
        <h3 id="name-random-increments-algorithm">
<a class="section-number selfRef" href="#appendix-A.2">A.2. </a><a class="section-name selfRef" href="#name-random-increments-algorithm">Random-Increments Algorithm</a>
        </h3>
<p id="appendix-A.2-1">This algorithm offers a middle ground between the algorithms that
  generate randomized transient numeric identifiers (such as those described in Sections <a class="auto internal xref" href="#simple-randomization">7.1.1</a> and <a class="auto internal xref" href="#simple-randomization2">7.1.2</a>) and those that generate identifiers with a predictable monotonically increasing function (see <a class="auto internal xref" href="#trad_selection">Appendix A.1</a>).<a class="pilcrow" href="#appendix-A.2-1">¶</a></p>
<div class="lang-c sourcecode" id="appendix-A.2-2">
<pre>    /* Initialization code */

    next_id = random();        /* Initialization value */
    id_rinc = 500;             /* Determines the trade-off */


    /* Transient Numeric ID selection function */

    id_range = max_id - min_id + 1;
    retry = id_range;


    do {
        /* Random increment */
        id_inc = (random() % id_rinc) + 1;

        if ( (max_id - next_id) &gt;= id_inc){
            next_id = next_id + id_inc;
        }
        else {
            next_id = min_id + id_inc - (max_id - next_id);
        }

        if (suitable_id(next_id)) {
           return next_id;
        }

        retry = retry - id_inc;

    } while (retry &gt; 0);

    return ERROR;
</pre><a class="pilcrow" href="#appendix-A.2-2">¶</a>
</div>
<p id="appendix-A.2-3">NOTE:<a class="pilcrow" href="#appendix-A.2-3">¶</a></p>
<p id="appendix-A.2-4" style="margin-left: 1.5em">random() is a PRNG that returns a pseudorandom unsigned integer number of appropriate size. Beware that "adapting" the length of the output of random() with a modulo operator (e.g., C language's "%") may change the distribution of the PRNG. To preserve a uniform distribution, the rejection sampling technique <span>[<a class="cite xref" href="#Romailler2020">Romailler2020</a>]</span> can be used.<a class="pilcrow" href="#appendix-A.2-4">¶</a></p>
<p id="appendix-A.2-5" style="margin-left: 1.5em">suitable_id() is a function that checks whether a candidate identifier is suitable (e.g., whether it is unique or not).<a class="pilcrow" href="#appendix-A.2-5">¶</a></p>
<p id="appendix-A.2-6">
This algorithm aims at producing a global monotonically increasing sequence of transient numeric identifiers while avoiding the
use of fixed increments, which would lead to trivially predictable sequences.  The value "id_rinc" allows for direct control of the trade-off between unpredictability and identifier reuse frequency. The smaller the value of "id_rinc", the more similar this algorithm is to a predicable, global linear identifier generation algorithm (as the one in <a class="auto internal xref" href="#trad_selection">Appendix A.1</a>). The larger the value of "id_rinc", the more similar this algorithm is to the algorithm described in <a class="auto internal xref" href="#simple-randomization">Section 7.1.1</a> of this document.<a class="pilcrow" href="#appendix-A.2-6">¶</a></p>
<p id="appendix-A.2-7">
When the identifiers wrap, there is a risk of collisions of transient numeric identifiers (i.e., identifier reuse). Therefore, "id_rinc" should be selected according to the following criteria:<a class="pilcrow" href="#appendix-A.2-7">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A.2-8.1">It should maximize the wrapping time of the identifier space.<a class="pilcrow" href="#appendix-A.2-8.1">¶</a>
</li>
          <li class="normal" id="appendix-A.2-8.2">It should minimize identifier reuse frequency.<a class="pilcrow" href="#appendix-A.2-8.2">¶</a>
</li>
          <li class="normal" id="appendix-A.2-8.3">It should maximize unpredictability.<a class="pilcrow" href="#appendix-A.2-8.3">¶</a>
</li>
        </ul>
<p id="appendix-A.2-9">
Clearly, these are competing goals, and the decision of which value of "id_rinc" to use is a trade-off. Therefore, the value of "id_rinc" is at times a configurable parameter so that system administrators can make the trade-off for themselves. We note that the alternative algorithms discussed throughout this document offer better interoperability, security, and privacy properties than this algorithm, and hence, implementation of this algorithm is discouraged.<a class="pilcrow" href="#appendix-A.2-9">¶</a></p>
</section>
</div>
<div id="reuse-across-context">
<section id="appendix-A.3">
        <h3 id="name-reusing-identifiers-across-">
<a class="section-number selfRef" href="#appendix-A.3">A.3. </a><a class="section-name selfRef" href="#name-reusing-identifiers-across-">Reusing Identifiers Across Different Contexts</a>
        </h3>
<p id="appendix-A.3-1">Employing the same identifier across contexts in which stability is not required (i.e., overloading the semantics of transient numeric identifiers) usually has negative security and privacy implications.<a class="pilcrow" href="#appendix-A.3-1">¶</a></p>
<p id="appendix-A.3-2">For example, in order to generate transient numeric identifiers of Category #2 or #3, an implementation or specification might be tempted to employ a source for the numeric identifiers that is known to provide unique values but that may also be predictable or leak information related to the entity generating the identifier. This technique has been employed in the past for, e.g., generating IPv6 IIDs by reusing the MAC address of the underlying network interface card. However, as noted in <span>[<a class="cite xref" href="#RFC7721">RFC7721</a>]</span> and <span>[<a class="cite xref" href="#RFC7707">RFC7707</a>]</span>, embedding link-layer addresses in IPv6 IIDs not only results in predictable values but also leaks information about the manufacturer of the underlying network interface card, allows for network activity correlation, and makes address-based scanning attacks feasible.<a class="pilcrow" href="#appendix-A.3-2">¶</a></p>
</section>
</div>
</section>
</div>
<section id="appendix-B">
      <h2 id="name-acknowledgements">
<a class="section-name selfRef" href="#name-acknowledgements">Acknowledgements</a>
      </h2>
<p id="appendix-B-1">The authors would like to thank (in alphabetical order) <span class="contact-name">Bernard Aboba</span>, <span class="contact-name">Jean-Philippe Aumasson</span>, <span class="contact-name">Steven Bellovin</span>, <span class="contact-name">Luis León Cárdenas Graide</span>, <span class="contact-name">Spencer Dawkins</span>, <span class="contact-name">Theo de Raadt</span>, <span class="contact-name">Guillermo Gont</span>, <span class="contact-name">Joseph Lorenzo Hall</span>, <span class="contact-name">Gre Norcie</span>, <span class="contact-name">Colin Perkins</span>, <span class="contact-name">Vincent Roca</span>, <span class="contact-name">Shivan Sahib</span>, <span class="contact-name">Rich Salz</span>, <span class="contact-name">Martin Thomson</span>, and <span class="contact-name">Michael Tüxen</span> for providing valuable comments on earlier draft versions of this document.<a class="pilcrow" href="#appendix-B-1">¶</a></p>
<p id="appendix-B-2">The authors would like to thank <span class="contact-name">Shivan Sahib</span> and <span class="contact-name">Christopher Wood</span> for their guidance during the publication process of this document.<a class="pilcrow" href="#appendix-B-2">¶</a></p>
<p id="appendix-B-3">The authors would like to thank <span class="contact-name">Jean-Philippe Aumasson</span> and <span class="contact-name">Mathew D. Green</span> (John Hopkins University) for kindly answering a number of questions.<a class="pilcrow" href="#appendix-B-3">¶</a></p>
<p id="appendix-B-4">The authors would like to thank <span class="contact-name">Diego Armando Maradona</span> for his magic and inspiration.<a class="pilcrow" href="#appendix-B-4">¶</a></p>
</section>
<div id="authors-addresses">
<section id="appendix-C">
      <h2 id="name-authors-addresses">
<a class="section-name selfRef" href="#name-authors-addresses">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Fernando Gont</span></div>
<div class="left" dir="auto"><span class="org">SI6 Networks</span></div>
<div class="left" dir="auto"><span class="street-address">Segurola y Habana 4310 7mo piso</span></div>
<div class="left" dir="auto"><span class="locality">Ciudad Autonoma de Buenos Aires</span></div>
<div class="left" dir="auto"><span class="country-name">Argentina</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:fgont@si6networks.com">fgont@si6networks.com</a>
</div>
<div class="url">
<span>URI:</span>
<a class="url" href="https://www.si6networks.com">https://www.si6networks.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Ivan Arce</span></div>
<div class="left" dir="auto"><span class="org">Quarkslab</span></div>
<div class="left" dir="auto"><span class="street-address">Segurola y Habana 4310 7mo piso</span></div>
<div class="left" dir="auto"><span class="locality">Ciudad Autonoma de Buenos Aires</span></div>
<div class="left" dir="auto"><span class="country-name">Argentina</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:iarce@quarkslab.com">iarce@quarkslab.com</a>
</div>
<div class="url">
<span>URI:</span>
<a class="url" href="https://www.quarkslab.com">https://www.quarkslab.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>


</body></html>