<html><head></head><body><pre>Internet Engineering Task Force (IETF)                          P. Patil
Request for Comments: 8155                                      T. Reddy
Updates: <a href="./rfc5766">5766</a>                                                      Cisco
Category: Standards Track                                        D. Wing
ISSN: 2070-1721                                               April 2017


     <span class="h1">Traversal Using Relays around NAT (TURN) Server Auto Discovery</span>

Abstract

   Current Traversal Using Relays around NAT (TURN) server discovery
   mechanisms are relatively static and limited to explicit
   configuration.  These are usually under the administrative control of
   the application or TURN service provider, and not the enterprise,
   ISP, or the network in which the client is located.  Enterprises and
   ISPs wishing to provide their own TURN servers need auto-discovery
   mechanisms that a TURN client could use with minimal or no
   configuration.  This document describes three such mechanisms for
   TURN server discovery.

   This document updates <a href="./rfc5766">RFC 5766</a> to relax the requirement for mutual
   authentication in certain cases.

Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in <a href="./rfc7841#section-2">Section 2 of RFC 7841</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc8155">http://www.rfc-editor.org/info/rfc8155</a>.














<span class="grey">Patil, et al.                Standards Track                    [Page 1]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-2"></span>
<span class="grey"><a href="./rfc8155">RFC 8155</a>               TURN Server Auto Discovery             April 2017</span>


Copyright Notice

   Copyright (c) 2017 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://www.rfc-editor.org/bcp/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   <a href="#section-1">1</a>.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-3">3</a>
   <a href="#section-2">2</a>.  Terminology . . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-3">3</a>
   <a href="#section-3">3</a>.  Discovery Procedure . . . . . . . . . . . . . . . . . . . . .   <a href="#page-4">4</a>
   <a href="#section-4">4</a>.  Discovery Using Service Resolution  . . . . . . . . . . . . .   <a href="#page-5">5</a>
     <a href="#section-4.1">4.1</a>.  Retrieving Domain Name  . . . . . . . . . . . . . . . . .   <a href="#page-5">5</a>
       <a href="#section-4.1.1">4.1.1</a>.  DHCP  . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-5">5</a>
       <a href="#section-4.1.2">4.1.2</a>.  From Own Identity . . . . . . . . . . . . . . . . . .   <a href="#page-6">6</a>
     <a href="#section-4.2">4.2</a>.  Resolution  . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-6">6</a>
   <a href="#section-5">5</a>.  DNS Service Discovery . . . . . . . . . . . . . . . . . . . .   <a href="#page-6">6</a>
     <a href="#section-5.1">5.1</a>.  mDNS  . . . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-7">7</a>
   <a href="#section-6">6</a>.  Discovery Using Anycast . . . . . . . . . . . . . . . . . . .   <a href="#page-7">7</a>
   <a href="#section-7">7</a>.  Deployment Considerations . . . . . . . . . . . . . . . . . .   <a href="#page-8">8</a>
     <a href="#section-7.1">7.1</a>.  Mobility and Changing IP Addresses  . . . . . . . . . . .   <a href="#page-8">8</a>
     <a href="#section-7.2">7.2</a>.  Recursively Encapsulated TURN . . . . . . . . . . . . . .   <a href="#page-8">8</a>
   <a href="#section-8">8</a>.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .   <a href="#page-9">9</a>
     <a href="#section-8.1">8.1</a>.  IPv4 Anycast  . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-9">9</a>
     <a href="#section-8.2">8.2</a>.  IPv6 Anycast  . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-9">9</a>
   <a href="#section-9">9</a>.  Security Considerations . . . . . . . . . . . . . . . . . . .  <a href="#page-10">10</a>
     <a href="#section-9.1">9.1</a>.  Service Resolution  . . . . . . . . . . . . . . . . . . .  <a href="#page-12">12</a>
     <a href="#section-9.2">9.2</a>.  DNS Service Discovery . . . . . . . . . . . . . . . . . .  <a href="#page-12">12</a>
     <a href="#section-9.3">9.3</a>.  Anycast . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-13">13</a>
   <a href="#section-10">10</a>. References  . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-13">13</a>
     <a href="#section-10.1">10.1</a>.  Normative References . . . . . . . . . . . . . . . . . .  <a href="#page-13">13</a>
     <a href="#section-10.2">10.2</a>.  Informative References . . . . . . . . . . . . . . . . .  <a href="#page-15">15</a>
   Acknowledgements  . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-16">16</a>
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-16">16</a>








<span class="grey">Patil, et al.                Standards Track                    [Page 2]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-3"></span>
<span class="grey"><a href="./rfc8155">RFC 8155</a>               TURN Server Auto Discovery             April 2017</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" id="section-1">1</a>.  Introduction</span>

   TURN [<a href="./rfc5766" title='"Traversal Using Relays around NAT (TURN): Relay Extensions to Session Traversal Utilities for NAT (STUN)"'>RFC5766</a>] is a protocol that is often used to improve the
   connectivity of Peer-to-Peer (P2P) applications (as defined in
   <a href="./rfc5128#section-2.7">Section 2.7 of [RFC5128]</a>).  TURN allows a connection to be
   established when one or both sides are incapable of a direct P2P
   connection.  It is an important building block for interactive, real-
   time communication using audio, video, collaboration, etc.

   While TURN services are extensively used today, the means to
   automatically discover TURN servers do not exist.  TURN clients are
   usually explicitly configured with a well-known TURN server.  To
   allow TURN applications to operate seamlessly across different types
   of networks and encourage the use of TURN without the need for manual
   configuration, it is important that there exist an auto-discovery
   mechanism for TURN services.  Web Real-Time Communication (WebRTC)
   [<a href="#ref-WebRTC-Overview">WebRTC-Overview</a>] usages and related extensions, which are mostly
   based on web applications, need TURN server discovery mechanisms.

   This document describes three discovery mechanisms, so as to maximize
   the opportunity for discovery, based on the network in which the TURN
   client finds itself.  The three discovery mechanisms are:

   o  A resolution mechanism based on Straightforward-Naming Authority
      Pointer (S-NAPTR) resource records in the Domain Name System
      (DNS).  [<a href="./rfc5928" title='"Traversal Using Relays around NAT (TURN) Resolution Mechanism"'>RFC5928</a>] describes details on retrieving a list of server
      transport addresses from the DNS that can be used to create a TURN
      allocation.

   o  DNS Service Discovery.

   o  A mechanism based on an anycast address for TURN.

   In general, if a client wishes to communicate using one of its
   interfaces using a specific IP address family, it SHOULD query the
   TURN server(s) that has been discovered for that specific interface
   and address family.  How to select an interface and IP address family
   is out of the scope of this document.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/2.%20%20Terminology"></a><a class="selflink" href="#section-2" id="section-2">2</a>.  Terminology</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in
   [<a href="./rfc2119" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>].






<span class="grey">Patil, et al.                Standards Track                    [Page 3]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-4"></span>
<span class="grey"><a href="./rfc8155">RFC 8155</a>               TURN Server Auto Discovery             April 2017</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.%20%20Discovery%20Procedure"></a><a class="selflink" href="#section-3" id="section-3">3</a>.  Discovery Procedure</span>

   TURN clients, by default, discover TURN server(s) by means of local
   or manual TURN configuration (i.e., TURN servers configured at the
   system level).  Configuration discovered from an application, e.g., a
   JavaScript-specified TURN server for Web Real-Time Communication
   (WebRTC) [<a href="#ref-WebRTC-Overview">WebRTC-Overview</a>] usages and related extensions, is
   considered a local configuration.  An implementation may give the
   user an opportunity (e.g., by means of configuration file options or
   menu items) to specify a TURN server for each address family.  A
   client can choose auto-discovery in the absence of local
   configuration, if local configuration doesn't work or in addition to
   local configuration.  This document does not offer a recommendation
   on server selection.

   A TURN client that implements the auto-discovery algorithm, to
   discover TURN servers in the attached network, uses the following
   mechanisms for discovery:

   o  Service Resolution: The TURN client attempts to perform TURN
      service resolution using the host's DNS domain.

   o  DNS SD: DNS Service Discovery.

   o  Anycast: Send TURN Allocation request to the assigned TURN anycast
      request for each combination of interface and address family.

   Not all TURN servers may be discovered using NAPTR records or DNS SD.
   Similarly, not all TURN servers may support anycast.  For best
   results, a client SHOULD implement all the discovery mechanisms
   described above.

   The document does not prescribe a strict order that a client must
   follow for discovery.  An implementation may choose to perform all
   the above steps in parallel for discovery OR choose to follow any
   desired order and stop the discovery procedure if a mechanism
   succeeds.

   On hosts with more than one interface or address family (IPv4/v6),
   the TURN server discovery procedure has to be performed for each
   combination of interface and address family.  A client MAY choose to
   perform the discovery procedure only for a desired interface/address
   combination if the client does not wish to discover a TURN server for
   all combinations of interface and address family.







<span class="grey">Patil, et al.                Standards Track                    [Page 4]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-5"></span>
<span class="grey"><a href="./rfc8155">RFC 8155</a>               TURN Server Auto Discovery             April 2017</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/4.%20%20Discovery%20Using%20Service%20Resolution"></a><a class="selflink" href="#section-4" id="section-4">4</a>.  Discovery Using Service Resolution</span>

   This mechanism is performed in two steps:

   1.  A DNS domain name is retrieved for each combination of interface
       and address family.

   2.  Retrieved DNS domain names are then used for S-NAPTR lookups as
       per [<a href="./rfc5928" title='"Traversal Using Relays around NAT (TURN) Resolution Mechanism"'>RFC5928</a>].  Further DNS lookups may be necessary to determine
       TURN server IP address(es).

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/4.1.%20%20Retrieving%20Domain%20Name"></a><a class="selflink" href="#section-4.1" id="section-4.1">4.1</a>.  Retrieving Domain Name</span>

   A client has to determine the domain in which it is located.  The
   following sections provide two possible mechanisms to learn the
   domain name, but other means of retrieving domain names may be used,
   which are outside the scope of this document, e.g., local
   configuration.

   Implementations may allow the user to specify a default name that is
   used if no specific name has been configured.

<span class="h4"><a class="dashAnchor" name="//apple_ref/cpp/Section/4.1.1.%20%20DHCP"></a><a class="selflink" href="#section-4.1.1" id="section-4.1.1">4.1.1</a>.  DHCP</span>

   DHCP can be used to determine the domain name related to an
   interface's point of network attachment.  Network operators may
   provide the domain name to be used for service discovery within an
   access network using DHCP.  Sections <a href="#section-3.2">3.2</a> and <a href="#section-3.3">3.3</a> of [<a href="./rfc5986" title='"Discovering the Local Location Information Server (LIS)"'>RFC5986</a>] define
   DHCP IPv4 and IPv6 access network domain name options,
   OPTION_V4_ACCESS_DOMAIN and OPTION_V6_ACCESS_DOMAIN respectively, to
   identify a domain name that is suitable for service discovery within
   the access network.

   For IPv4, the discovery procedure MUST request the access network
   domain name option in a Parameter Request List option, as described
   in [<a href="./rfc2131" title='"Dynamic Host Configuration Protocol"'>RFC2131</a>].  [<a href="./rfc2132" title='"DHCP Options and BOOTP Vendor Extensions"'>RFC2132</a>] defines the DHCP IPv4 domain name option;
   while this option is less suitable, a client MAY request it if the
   access network domain name defined in [<a href="./rfc5986" title='"Discovering the Local Location Information Server (LIS)"'>RFC5986</a>] is not available.

   For IPv6, the discovery procedure MUST request the access network
   domain name option in an Options Request Option (ORO) within an
   Information-request message, as described in [<a href="./rfc3315" title='"Dynamic Host Configuration Protocol for IPv6 (DHCPv6)"'>RFC3315</a>].

   If neither option can be retrieved, the procedure fails for this
   interface.  If a result can be retrieved, it will be used as an input
   for S-NAPTR resolution.





<span class="grey">Patil, et al.                Standards Track                    [Page 5]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-6"></span>
<span class="grey"><a href="./rfc8155">RFC 8155</a>               TURN Server Auto Discovery             April 2017</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/cpp/Section/4.1.2.%20%20From%20Own%20Identity"></a><a class="selflink" href="#section-4.1.2" id="section-4.1.2">4.1.2</a>.  From Own Identity</span>

   For a TURN client with an understanding of the protocol mechanics of
   calling applications, the client may wish to extract the domain name
   from its own identity, i.e, the canonical identifier used to reach
   the user.

   Example:

   SIP      : 'sip:alice@example.com'
   Bare JID : 'alice@example.com'
   email    : 'alice@example.com'

   'example.com' is retrieved from the above examples.

   A client may support multiple users, potentially with different
   domains, or a single user utilizing different domains for different
   services.  The means to choose and extract the domain name may be
   different based on the type of identifier, service being used, etc.,
   which are outside the scope of this document.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/4.2.%20%20Resolution"></a><a class="selflink" href="#section-4.2" id="section-4.2">4.2</a>.  Resolution</span>

   Once the TURN discovery procedure has retrieved domain names, the
   resolution mechanism described in [<a href="./rfc5928" title='"Traversal Using Relays around NAT (TURN) Resolution Mechanism"'>RFC5928</a>] is followed.  An S-NAPTR
   lookup with the 'RELAY' application service and the desired protocol
   tag is made to obtain the information necessary to connect to the
   authoritative TURN server within the given domain.

   If no TURN-specific S-NAPTR records can be retrieved, the discovery
   procedure fails for this domain name (and the corresponding interface
   and IP protocol version).  If more domain names are known, the
   discovery procedure may perform the corresponding S-NAPTR lookups
   immediately.  However, before retrying a lookup that has failed, a
   client must wait a time period that is appropriate for the
   encountered error (NXDOMAIN, timeout, etc.).

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.%20%20DNS%20Service%20Discovery"></a><a class="selflink" href="#section-5" id="section-5">5</a>.  DNS Service Discovery</span>

   DNS-based Service Discovery (DNS-SD) [<a href="./rfc6763" title='"DNS-Based Service Discovery"'>RFC6763</a>] and Multicast DNS
   (mDNS) [<a href="./rfc6762" title='"Multicast DNS"'>RFC6762</a>] provide generic solutions for discovering services
   available in a local network.  DNS-SD/mDNS define a set of naming
   rules for certain DNS record types that they use for advertising and
   discovering services.







<span class="grey">Patil, et al.                Standards Track                    [Page 6]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-7"></span>
<span class="grey"><a href="./rfc8155">RFC 8155</a>               TURN Server Auto Discovery             April 2017</span>


   <a href="./rfc6763#section-4.1">Section 4.1 of [RFC6763]</a> specifies that a service instance name in
   DNS-SD has the following structure:

   &lt;Instance&gt; . &lt;Service&gt; . &lt;Domain&gt;

   The &lt;Domain&gt; portion specifies the DNS sub-domain where the service
   instance is registered.  It may be "local.", indicating the mDNS
   local domain, or it may be a conventional domain name such as
   "example.com.".  The &lt;Service&gt; portion of the TURN service instance
   name MUST be "_turn._udp" or "_turn._tcp" or "_turns._udp" or
   "_turns._tcp", as introduced in [<a href="./rfc5766" title='"Traversal Using Relays around NAT (TURN): Relay Extensions to Session Traversal Utilities for NAT (STUN)"'>RFC5766</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.1.%20%20mDNS"></a><a class="selflink" href="#section-5.1" id="section-5.1">5.1</a>.  mDNS</span>

   A TURN client can proactively discover TURN servers being advertised
   in the site by multicasting a PTR query to one or all of the
   following:

   o  "_turn._udp.local."

   o  "_turn._tcp.local"

   o  "_turns._udp.local."

   o  "_turns._tcp.local"

   A TURN server can send out gratuitous multicast DNS answer packets
   whenever it starts up, wakes from sleep, or detects a change in
   network configuration.  TURN clients receive these gratuitous packets
   and cache information contained in it.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/6.%20%20Discovery%20Using%20Anycast"></a><a class="selflink" href="#section-6" id="section-6">6</a>.  Discovery Using Anycast</span>

   IP anycast can also be used for TURN service discovery.  A packet
   sent to an anycast address is delivered to the "topologically
   nearest" network interface with the anycast address.  Using the TURN
   anycast address, the only two things that need to be deployed in the
   network for discovery are the two things that actually use TURN.

   When a client requires TURN services, it sends a TURN Allocation
   request to the assigned anycast address.  A TURN anycast server
   performs checks 1 through 7 discussed in <a href="./rfc5766#section-6.2">Section 6.2 of [RFC5766]</a>.
   If all checks pass, the TURN anycast server MUST respond with a 300
   (Try Alternate) error as described in <a href="./rfc5766#section-2.9">Section 2.9 of [RFC5766]</a>; the
   response contains the TURN unicast address in the ALTERNATE-SERVER
   attribute.  For subsequent communication with the TURN server, the
   client uses the responding server's unicast address.  This has to be
   done because two packets addressed to an anycast address may reach



<span class="grey">Patil, et al.                Standards Track                    [Page 7]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-8"></span>
<span class="grey"><a href="./rfc8155">RFC 8155</a>               TURN Server Auto Discovery             April 2017</span>


   two different anycast servers.  The client, thus, also needs to
   ensure that the initial request fits in a single packet.  An
   implementation may choose to send out every new TURN Allocation
   request to the anycast address to discover the closest and the most
   optimal unicast address for the TURN server.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/7.%20%20Deployment%20Considerations"></a><a class="selflink" href="#section-7" id="section-7">7</a>.  Deployment Considerations</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/7.1.%20%20Mobility%20and%20Changing%20IP%20Addresses"></a><a class="selflink" href="#section-7.1" id="section-7.1">7.1</a>.  Mobility and Changing IP Addresses</span>

   A change of IP address on an interface may invalidate the result of
   the TURN server discovery procedure.  For instance, if the IP address
   assigned to a mobile host changes due to host mobility, it may be
   required to re-run the TURN server discovery procedure without
   relying on earlier gained information.  New requests should be made
   to the newly learned TURN servers that were learned after TURN the
   discovery was re-run.  However, if an earlier learned TURN server is
   still accessible using the new IP address, procedures described for
   mobility using TURN defined in [<a href="./rfc8016" title='"Mobility with Traversal Using Relays around NAT (TURN)"'>RFC8016</a>] can be used for ongoing
   streams.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/7.2.%20%20Recursively%20Encapsulated%20TURN"></a><a class="selflink" href="#section-7.2" id="section-7.2">7.2</a>.  Recursively Encapsulated TURN</span>

   WebRTC endpoints SHOULD treat any TURN server discovered through the
   mechanisms described in this specification as an enterprise/gateway
   or access network server, in accordance with Recursively Encapsulated
   TURN [<a href="#ref-RETURN" title='"Recursively Encapsulated TURN (RETURN) for Connectivity and Privacy in WebRTC"'>RETURN</a>].
























<span class="grey">Patil, et al.                Standards Track                    [Page 8]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-9"></span>
<span class="grey"><a href="./rfc8155">RFC 8155</a>               TURN Server Auto Discovery             April 2017</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/8.%20%20IANA%20Considerations"></a><a class="selflink" href="#section-8" id="section-8">8</a>.  IANA Considerations</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/8.1.%20%20IPv4%20Anycast"></a><a class="selflink" href="#section-8.1" id="section-8.1">8.1</a>.  IPv4 Anycast</span>

   IANA has assigned a single IPv4 address from the 192.0.0.0/24 prefix
   and registered it in the "IANA IPv4 Special-Purpose Address Registry"
   [<a href="./rfc6890" title='"Special-Purpose IP Address Registries"'>RFC6890</a>].

    +----------------------+-------------------------------------------+
    | Attribute            | Value                                     |
    +----------------------+-------------------------------------------+
    | Address Block        | 192.0.0.10/32                             |
    | Name                 | Traversal Using Relays around NAT Anycast |
    | RFC                  | <a href="./rfc8155">RFC 8155</a>                                  |
    | Allocation Date      | 2017-02                                   |
    | Termination Date     | N/A                                       |
    | Source               | True                                      |
    | Destination          | True                                      |
    | Forwardable          | True                                      |
    | Global               | True                                      |
    | Reserved-by-Protocol | False                                     |
    +----------------------+-------------------------------------------+

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/8.2.%20%20IPv6%20Anycast"></a><a class="selflink" href="#section-8.2" id="section-8.2">8.2</a>.  IPv6 Anycast</span>

   IANA has assigned a single IPv6 address from the 2001:0000::/23
   prefix and registered it in the "IANA IPv6 Special-Purpose Address
   Registry" [<a href="./rfc6890" title='"Special-Purpose IP Address Registries"'>RFC6890</a>].

    +----------------------+-------------------------------------------+
    | Attribute            | Value                                     |
    +----------------------+-------------------------------------------+
    | Address Block        | 2001:1::2/128                             |
    | Name                 | Traversal Using Relays around NAT Anycast |
    | RFC                  | <a href="./rfc8155">RFC 8155</a>                                  |
    | Allocation Date      | 2017-02                                   |
    | Termination Date     | N/A                                       |
    | Source               | True                                      |
    | Destination          | True                                      |
    | Forwardable          | True                                      |
    | Global               | True                                      |
    | Reserved-by-Protocol | False                                     |
    +----------------------+-------------------------------------------+








<span class="grey">Patil, et al.                Standards Track                    [Page 9]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-10"></span>
<span class="grey"><a href="./rfc8155">RFC 8155</a>               TURN Server Auto Discovery             April 2017</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/9.%20%20Security%20Considerations"></a><a class="selflink" href="#section-9" id="section-9">9</a>.  Security Considerations</span>

   Use of Session Traversal Utilities for NAT (STUN) [<a href="./rfc5389" title='"Session Traversal Utilities for NAT (STUN)"'>RFC5389</a>]
   authentication is OPTIONAL for TURN servers provided by the local
   network or by the access network.  A network-provided TURN server MAY
   be configured to accept Allocation requests without STUN
   authentication, and a TURN client MAY be configured to accept
   Allocation success responses without STUN authentication from a
   network-provided TURN server.

   Making STUN authentication optional is a downgrade of a MUST level
   requirement defined in [<a href="./rfc5766" title='"Traversal Using Relays around NAT (TURN): Relay Extensions to Session Traversal Utilities for NAT (STUN)"'>RFC5766</a>].  The downgrade allows TURN servers
   provided by the local or access network to accept Allocation requests
   from new and/or guest users in the network who do not necessarily
   possess long term credentials for STUN authentication.  The intention
   in such deployments is to provide TURN services to all users in the
   local or access network.  However, this opens up a TURN server to a
   variety of attacks described in <a href="./rfc5766#section-17">Section 17 of [RFC5766]</a>.  A TURN
   server in such cases must be configured to only process STUN requests
   from the trusted local network or subscribers of the access network.
   Operational measures must be taken in order to protect the TURN
   server; some of these measures include, but are not limited to,
   access control by means of access lists, firewalls, subscriber quota
   limits, ingress filtering, etc.

   A TURN client in the absence of the STUN long-term credential
   mechanism [<a href="./rfc5389" title='"Session Traversal Utilities for NAT (STUN)"'>RFC5389</a>] or the STUN Extension for Third-Party
   Authorization [<a href="./rfc7635" title='"Session Traversal Utilities for NAT (STUN) Extension for Third-Party Authorization"'>RFC7635</a>] MUST use (D)TLS unless it trusts the network
   infrastructure to defend against attacks discussed in [<a href="./rfc5766" title='"Traversal Using Relays around NAT (TURN): Relay Extensions to Session Traversal Utilities for NAT (STUN)"'>RFC5766</a>].  It
   is RECOMMENDED that the TURN client use one of the following
   techniques with (D)TLS to validate the TURN server:

   o  For certificate-based authentication, a pre-populated trust anchor
      store [<a href="./rfc6024" title='"Trust Anchor Management Requirements"'>RFC6024</a>] allows a TURN client to perform path validation
      for the server certificate obtained during the (D)TLS handshake.
      If the client used a domain name to discover the TURN server, that
      domain name also provides a mechanism for validation of the TURN
      server.  The client MUST use the rules and guidelines given in
      <a href="./rfc6125#section-6">Section 6 of [RFC6125]</a> to validate the TURN server identity.

   o  Certification authorities that issue TURN server certificates
      SHOULD support the CN-ID, DNS-ID, SRV-ID, and URI-ID identifier
      types.  TURN service providers SHOULD prefer the use of DNS-ID,
      SRV-ID, and URI-ID over CN-ID identifier types in certificate
      requests (as described in <a href="#section-2.3">Section 2.3</a> from [<a href="./rfc6125" title='"Representation and Verification of Domain-Based Application Service Identity within Internet Public Key Infrastructure Using X.509 (PKIX) Certificates in the Context of Transport Layer Security (TLS)"'>RFC6125</a>]) and the
      wildcard character '*' SHOULD NOT be included in the presented
      identifier.




<span class="grey">Patil, et al.                Standards Track                   [Page 10]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-11"></span>
<span class="grey"><a href="./rfc8155">RFC 8155</a>               TURN Server Auto Discovery             April 2017</span>


   o  For TURN servers that don't have a certificate trust chain (e.g.,
      because they are on a home network or a corporate network), a
      configured list of TURN servers can contain the Subject Public Key
      Info (SPKI) fingerprint of the TURN servers.  The public key is
      used for the same reasons HTTP pinning [<a href="./rfc7469" title='"Public Key Pinning Extension for HTTP"'>RFC7469</a>] uses the public
      key.

   o  Raw public key-based authentication, as defined in [<a href="./rfc7250" title='"Using Raw Public Keys in Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)"'>RFC7250</a>],
      could also be used to authenticate a TURN server.

   An auto-discovered TURN server is considered to be only as trusted as
   the path between the client and the TURN server.  In order to safely
   use auto-discovered TURN servers for sessions with 'strict privacy'
   requirements, the user needs to be able to define privacy criteria
   (e.g., a trusted list of servers, networks, or domains) that are
   considered acceptable for such traffic.  Any discovered TURN server
   outside the criteria is considered untrusted and therefore MUST NOT
   be used for privacy-sensitive communication.

   In some auto-discovery scenarios, it might not be possible for the
   TURN client to use (D)TLS authentication to validate the TURN server.
   However, fallback to clear text in such cases could leave the TURN
   client open to on-path injection of spoofed TURN messages.  A TURN
   client could fall back to encryption-only (D)TLS when (D)TLS
   authentication is not available but MUST NOT fall back without
   explicit administrator choice.  Another reason to fall back to
   encryption-only is for privacy, which is analogous to SMTP
   opportunistic encryption [<a href="./rfc7435" title='"Opportunistic Security: Some Protection Most of the Time"'>RFC7435</a>] where one does not require privacy
   but one desires privacy when possible.

   In order to allow the TURN client to fall back to (D)TLS as described
   above, a TURN server that does not require either STUN long-term
   authentication [<a href="./rfc5389" title='"Session Traversal Utilities for NAT (STUN)"'>RFC5389</a>] or STUN Extension for Third Party
   Authorization [<a href="./rfc7635" title='"Session Traversal Utilities for NAT (STUN) Extension for Third-Party Authorization"'>RFC7635</a>] MUST support (D)TLS and, if the network
   infrastructure is capable of defending against attacks discussed in
   [<a href="./rfc5766" title='"Traversal Using Relays around NAT (TURN): Relay Extensions to Session Traversal Utilities for NAT (STUN)"'>RFC5766</a>], then the TURN server MAY allow fallback to clear text.

   A TURN client could fall back to clear text if it does not support
   unauthenticated (D)TLS but MUST NOT fall back without explicit
   administrator choice.  Fallback to clear text is NOT RECOMMENDED
   because it makes the client more susceptible to man-in-the-middle
   attacks and on-path packet injection.









<span class="grey">Patil, et al.                Standards Track                   [Page 11]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-12"></span>
<span class="grey"><a href="./rfc8155">RFC 8155</a>               TURN Server Auto Discovery             April 2017</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/9.1.%20%20Service%20Resolution"></a><a class="selflink" href="#section-9.1" id="section-9.1">9.1</a>.  Service Resolution</span>

   The primary attack against the methods described in this document is
   one that would lead to impersonation of a TURN server.  An attacker
   could attempt to compromise the S-NAPTR resolution.  Security
   considerations described in [<a href="./rfc5928" title='"Traversal Using Relays around NAT (TURN) Resolution Mechanism"'>RFC5928</a>] are applicable here as well.

   In addition to considerations related to S-NAPTR, it is important to
   recognize that the output of this is entirely dependent on its input.
   An attacker who can control the domain name can also control the
   final result.  Because more than one method can be used to determine
   the domain name, a host implementation needs to consider attacks
   against each of the methods that are used.

   If DHCP is used, the integrity of DHCP options is limited by the
   security of the channel over which they are provided.  Physical
   security and separation of DHCP messages from other packets are
   commonplace methods that can reduce the possibility of attack within
   an access network; alternatively, DHCP authentication [<a href="./rfc3188" title='"Using National Bibliography Numbers as Uniform Resource Names"'>RFC3188</a>] can
   provide a degree of protection against modification.  When using DHCP
   discovery, clients are encouraged to use unicast DHCP INFORM queries
   instead of broadcast queries, which are more easily spoofed in
   insecure networks.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/9.2.%20%20DNS%20Service%20Discovery"></a><a class="selflink" href="#section-9.2" id="section-9.2">9.2</a>.  DNS Service Discovery</span>

   Since DNS-SD is just a specification for how to name and use records
   in the existing DNS system, it has no specific additional security
   requirements over and above those that already apply to DNS queries
   and DNS updates.  For DNS queries, DNS Security Extensions (DNSSEC)
   [<a href="./rfc4033" title='"DNS Security Introduction and Requirements"'>RFC4033</a>] should be used where the authenticity of information is
   important.  For DNS updates, secure updates [<a href="./rfc2136" title='"Dynamic Updates in the Domain Name System (DNS UPDATE)"'>RFC2136</a>] [<a href="./rfc3007" title='"Secure Domain Name System (DNS) Dynamic Update"'>RFC3007</a>]
   should generally be used to control which clients have permission to
   update DNS records.

   For mDNS, in addition to what has been described above, a principal
   security threat is a security threat inherent to IP multicast routing
   and any application that runs on it.  A rogue system can advertise
   that it is a TURN server.  Discovery of such rogue systems as TURN
   servers, in itself, is not a security threat if there is a means for
   the TURN client to authenticate and authorize the discovered TURN
   servers.









<span class="grey">Patil, et al.                Standards Track                   [Page 12]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-13"></span>
<span class="grey"><a href="./rfc8155">RFC 8155</a>               TURN Server Auto Discovery             April 2017</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/9.3.%20%20Anycast"></a><a class="selflink" href="#section-9.3" id="section-9.3">9.3</a>.  Anycast</span>

   In a network without any TURN server that is aware of the TURN
   anycast address, outgoing TURN requests could leak out onto the
   external Internet, possibly revealing information.

   Using an IANA-assigned well-known TURN anycast address enables border
   gateways to block such outgoing packets.  In the default-free zone,
   routers should be configured to drop such packets.  Such
   configuration can occur naturally via BGP messages advertising that
   no route exists to said address.

   Sensitive clients that do not wish to leak information about their
   presence can set an IP TTL on their TURN requests that limits how far
   they can travel into the public Internet.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/10.%20%20References"></a><a class="selflink" href="#section-10" id="section-10">10</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/10.1.%20%20Normative%20References"></a><a class="selflink" href="#section-10.1" id="section-10.1">10.1</a>.  Normative References</span>

   [<a id="ref-RFC2119">RFC2119</a>]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="https://www.rfc-editor.org/bcp/bcp14">BCP 14</a>, <a href="./rfc2119">RFC 2119</a>,
              DOI 10.17487/RFC2119, March 1997,
              &lt;<a href="http://www.rfc-editor.org/info/rfc2119">http://www.rfc-editor.org/info/rfc2119</a>&gt;.

   [<a id="ref-RFC2131">RFC2131</a>]  Droms, R., "Dynamic Host Configuration Protocol",
              <a href="./rfc2131">RFC 2131</a>, DOI 10.17487/RFC2131, March 1997,
              &lt;<a href="http://www.rfc-editor.org/info/rfc2131">http://www.rfc-editor.org/info/rfc2131</a>&gt;.

   [<a id="ref-RFC2132">RFC2132</a>]  Alexander, S. and R. Droms, "DHCP Options and BOOTP Vendor
              Extensions", <a href="./rfc2132">RFC 2132</a>, DOI 10.17487/RFC2132, March 1997,
              &lt;<a href="http://www.rfc-editor.org/info/rfc2132">http://www.rfc-editor.org/info/rfc2132</a>&gt;.

   [<a id="ref-RFC2136">RFC2136</a>]  Vixie, P., Ed., Thomson, S., Rekhter, Y., and J. Bound,
              "Dynamic Updates in the Domain Name System (DNS UPDATE)",
              <a href="./rfc2136">RFC 2136</a>, DOI 10.17487/RFC2136, April 1997,
              &lt;<a href="http://www.rfc-editor.org/info/rfc2136">http://www.rfc-editor.org/info/rfc2136</a>&gt;.

   [<a id="ref-RFC3007">RFC3007</a>]  Wellington, B., "Secure Domain Name System (DNS) Dynamic
              Update", <a href="./rfc3007">RFC 3007</a>, DOI 10.17487/RFC3007, November 2000,
              &lt;<a href="http://www.rfc-editor.org/info/rfc3007">http://www.rfc-editor.org/info/rfc3007</a>&gt;.

   [<a id="ref-RFC3315">RFC3315</a>]  Droms, R., Ed., Bound, J., Volz, B., Lemon, T., Perkins,
              C., and M. Carney, "Dynamic Host Configuration Protocol
              for IPv6 (DHCPv6)", <a href="./rfc3315">RFC 3315</a>, DOI 10.17487/RFC3315, July
              2003, &lt;<a href="http://www.rfc-editor.org/info/rfc3315">http://www.rfc-editor.org/info/rfc3315</a>&gt;.





<span class="grey">Patil, et al.                Standards Track                   [Page 13]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-14"></span>
<span class="grey"><a href="./rfc8155">RFC 8155</a>               TURN Server Auto Discovery             April 2017</span>


   [<a id="ref-RFC4033">RFC4033</a>]  Arends, R., Austein, R., Larson, M., Massey, D., and S.
              Rose, "DNS Security Introduction and Requirements",
              <a href="./rfc4033">RFC 4033</a>, DOI 10.17487/RFC4033, March 2005,
              &lt;<a href="http://www.rfc-editor.org/info/rfc4033">http://www.rfc-editor.org/info/rfc4033</a>&gt;.

   [<a id="ref-RFC5389">RFC5389</a>]  Rosenberg, J., Mahy, R., Matthews, P., and D. Wing,
              "Session Traversal Utilities for NAT (STUN)", <a href="./rfc5389">RFC 5389</a>,
              DOI 10.17487/RFC5389, October 2008,
              &lt;<a href="http://www.rfc-editor.org/info/rfc5389">http://www.rfc-editor.org/info/rfc5389</a>&gt;.

   [<a id="ref-RFC5766">RFC5766</a>]  Mahy, R., Matthews, P., and J. Rosenberg, "Traversal Using
              Relays around NAT (TURN): Relay Extensions to Session
              Traversal Utilities for NAT (STUN)", <a href="./rfc5766">RFC 5766</a>,
              DOI 10.17487/RFC5766, April 2010,
              &lt;<a href="http://www.rfc-editor.org/info/rfc5766">http://www.rfc-editor.org/info/rfc5766</a>&gt;.

   [<a id="ref-RFC5928">RFC5928</a>]  Petit-Huguenin, M., "Traversal Using Relays around NAT
              (TURN) Resolution Mechanism", <a href="./rfc5928">RFC 5928</a>,
              DOI 10.17487/RFC5928, August 2010,
              &lt;<a href="http://www.rfc-editor.org/info/rfc5928">http://www.rfc-editor.org/info/rfc5928</a>&gt;.

   [<a id="ref-RFC5986">RFC5986</a>]  Thomson, M. and J. Winterbottom, "Discovering the Local
              Location Information Server (LIS)", <a href="./rfc5986">RFC 5986</a>,
              DOI 10.17487/RFC5986, September 2010,
              &lt;<a href="http://www.rfc-editor.org/info/rfc5986">http://www.rfc-editor.org/info/rfc5986</a>&gt;.

   [<a id="ref-RFC6024">RFC6024</a>]  Reddy, R. and C. Wallace, "Trust Anchor Management
              Requirements", <a href="./rfc6024">RFC 6024</a>, DOI 10.17487/RFC6024, October
              2010, &lt;<a href="http://www.rfc-editor.org/info/rfc6024">http://www.rfc-editor.org/info/rfc6024</a>&gt;.

   [<a id="ref-RFC6762">RFC6762</a>]  Cheshire, S. and M. Krochmal, "Multicast DNS", <a href="./rfc6762">RFC 6762</a>,
              DOI 10.17487/RFC6762, February 2013,
              &lt;<a href="http://www.rfc-editor.org/info/rfc6762">http://www.rfc-editor.org/info/rfc6762</a>&gt;.

   [<a id="ref-RFC6763">RFC6763</a>]  Cheshire, S. and M. Krochmal, "DNS-Based Service
              Discovery", <a href="./rfc6763">RFC 6763</a>, DOI 10.17487/RFC6763, February 2013,
              &lt;<a href="http://www.rfc-editor.org/info/rfc6763">http://www.rfc-editor.org/info/rfc6763</a>&gt;.

   [<a id="ref-RFC6890">RFC6890</a>]  Cotton, M., Vegoda, L., Bonica, R., Ed., and B. Haberman,
              "Special-Purpose IP Address Registries", <a href="https://www.rfc-editor.org/bcp/bcp153">BCP 153</a>,
              <a href="./rfc6890">RFC 6890</a>, DOI 10.17487/RFC6890, April 2013,
              &lt;<a href="http://www.rfc-editor.org/info/rfc6890">http://www.rfc-editor.org/info/rfc6890</a>&gt;.

   [<a id="ref-RFC7250">RFC7250</a>]  Wouters, P., Ed., Tschofenig, H., Ed., Gilmore, J.,
              Weiler, S., and T. Kivinen, "Using Raw Public Keys in
              Transport Layer Security (TLS) and Datagram Transport
              Layer Security (DTLS)", <a href="./rfc7250">RFC 7250</a>, DOI 10.17487/RFC7250,
              June 2014, &lt;<a href="http://www.rfc-editor.org/info/rfc7250">http://www.rfc-editor.org/info/rfc7250</a>&gt;.



<span class="grey">Patil, et al.                Standards Track                   [Page 14]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-15"></span>
<span class="grey"><a href="./rfc8155">RFC 8155</a>               TURN Server Auto Discovery             April 2017</span>


   [<a id="ref-RFC7635">RFC7635</a>]  Reddy, T., Patil, P., Ravindranath, R., and J. Uberti,
              "Session Traversal Utilities for NAT (STUN) Extension for
              Third-Party Authorization", <a href="./rfc7635">RFC 7635</a>,
              DOI 10.17487/RFC7635, August 2015,
              &lt;<a href="http://www.rfc-editor.org/info/rfc7635">http://www.rfc-editor.org/info/rfc7635</a>&gt;.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/10.2.%20%20Informative%20References"></a><a class="selflink" href="#section-10.2" id="section-10.2">10.2</a>.  Informative References</span>

   [<a id="ref-RETURN">RETURN</a>]   Schwartz, B. and J. Uberti, "Recursively Encapsulated TURN
              (RETURN) for Connectivity and Privacy in WebRTC", Work in
              Progress, <a href="./draft-ietf-rtcweb-return-02">draft-ietf-rtcweb-return-02</a>, March 2017.

   [<a id="ref-RFC3188">RFC3188</a>]  Hakala, J., "Using National Bibliography Numbers as
              Uniform Resource Names", <a href="./rfc3188">RFC 3188</a>, DOI 10.17487/RFC3188,
              October 2001, &lt;<a href="http://www.rfc-editor.org/info/rfc3188">http://www.rfc-editor.org/info/rfc3188</a>&gt;.

   [<a id="ref-RFC5128">RFC5128</a>]  Srisuresh, P., Ford, B., and D. Kegel, "State of Peer-to-
              Peer (P2P) Communication across Network Address
              Translators (NATs)", <a href="./rfc5128">RFC 5128</a>, DOI 10.17487/RFC5128, March
              2008, &lt;<a href="http://www.rfc-editor.org/info/rfc5128">http://www.rfc-editor.org/info/rfc5128</a>&gt;.

   [<a id="ref-RFC6125">RFC6125</a>]  Saint-Andre, P. and J. Hodges, "Representation and
              Verification of Domain-Based Application Service Identity
              within Internet Public Key Infrastructure Using X.509
              (PKIX) Certificates in the Context of Transport Layer
              Security (TLS)", <a href="./rfc6125">RFC 6125</a>, DOI 10.17487/RFC6125, March
              2011, &lt;<a href="http://www.rfc-editor.org/info/rfc6125">http://www.rfc-editor.org/info/rfc6125</a>&gt;.

   [<a id="ref-RFC7435">RFC7435</a>]  Dukhovni, V., "Opportunistic Security: Some Protection
              Most of the Time", <a href="./rfc7435">RFC 7435</a>, DOI 10.17487/RFC7435,
              December 2014, &lt;<a href="http://www.rfc-editor.org/info/rfc7435">http://www.rfc-editor.org/info/rfc7435</a>&gt;.

   [<a id="ref-RFC7469">RFC7469</a>]  Evans, C., Palmer, C., and R. Sleevi, "Public Key Pinning
              Extension for HTTP", <a href="./rfc7469">RFC 7469</a>, DOI 10.17487/RFC7469, April
              2015, &lt;<a href="http://www.rfc-editor.org/info/rfc7469">http://www.rfc-editor.org/info/rfc7469</a>&gt;.

   [<a id="ref-RFC8016">RFC8016</a>]  Reddy, T., Wing, D., Patil, P., and P. Martinsen,
              "Mobility with Traversal Using Relays around NAT (TURN)",
              <a href="./rfc8016">RFC 8016</a>, DOI 10.17487/RFC8016, November 2016,
              &lt;<a href="http://www.rfc-editor.org/info/rfc8016">http://www.rfc-editor.org/info/rfc8016</a>&gt;.

   [<a id="ref-WebRTC-Overview">WebRTC-Overview</a>]
              Alvestrand, H., "Overview: Real Time Protocols for
              Browser-based Applications", Work in Progress,
              <a href="./draft-ietf-rtcweb-overview-18">draft-ietf-rtcweb-overview-18</a>, March 2017.






<span class="grey">Patil, et al.                Standards Track                   [Page 15]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-16"></span>
<span class="grey"><a href="./rfc8155">RFC 8155</a>               TURN Server Auto Discovery             April 2017</span>


Acknowledgements

   The authors would like to thank Simon Perrault, Paul Kyzivat, Troy
   Shields, Eduardo Gueiros, Ted Hardie, Bernard Aboba, Karl Stahl,
   Brian Weis, Ralph Dromes, Ben Campbell, Suresh Krishnan, and Brandon
   Williams for their review and valuable comments.  Thanks to Adam
   Roach for his detailed review and suggesting DNS Service Discovery as
   an additional discovery mechanism.

Authors' Addresses

   Prashanth Patil
   Cisco Systems, Inc.

   Email: praspati@cisco.com


   Tirumaleswar Reddy
   Cisco Systems, Inc.
   Cessna Business Park, Varthur Hobli
   Sarjapur Marathalli Outer Ring Road
   Bangalore, Karnataka  560103
   India

   Email: tireddy@cisco.com


   Dan Wing
   United States America

   Email: dwing-ietf@fuggles.com




















Patil, et al.                Standards Track                   [Page 16]
</pre>
</body></html>