<!DOCTYPE html>
<html class="RFC" lang="en"><head>
<meta charset="utf-8"/>
<meta content="Common,Latin" name="scripts"/>
<meta content="initial-scale=1.0" name="viewport"/>
<title>RFC 9176: Constrained RESTful Environments (CoRE) Resource Directory</title>
<meta content="Christian AmsÃ¼ss" name="author"/>
<meta content="Zach Shelby" name="author"/>
<meta content="Michael Koster" name="author"/>
<meta content="Carsten Bormann" name="author"/>
<meta content="Peter van der Stok" name="author"/>
<meta content="
       In many Internet of Things (IoT) applications, direct discovery of resources is not
      practical due to sleeping nodes or networks where multicast traffic
is inefficient. These problems can be solved by employing an entity called
a Resource Directory (RD), which contains information about resources held on
other servers, allowing lookups to be performed for those resources. The input to an RD is composed of links, and the output is composed of links constructed from the information stored in the RD. This
document specifies the web interfaces that an RD supports for web servers to discover the RD and to register, maintain, look up,
and remove information on resources. Furthermore, new target attributes useful
in conjunction with an RD are defined. 
    " name="description"/>
<meta content="xml2rfc 3.12.2" name="generator"/>
<meta content="CoRE" name="keyword"/>
<meta content="Web Linking" name="keyword"/>
<meta content="Resource Discovery" name="keyword"/>
<meta content="Resource Directory" name="keyword"/>
<meta content="9176" name="rfc.number"/>
<!-- Generator version information:
  xml2rfc 3.12.2
    Python 3.6.15
    appdirs 1.4.4
    ConfigArgParse 1.4.1
    google-i18n-address 2.4.0
    html5lib 1.0.1
    intervaltree 3.0.2
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.4.2
    pycairo 1.15.1
    pycountry 19.8.18
    pyflakes 2.1.1
    PyYAML 5.4.1
    requests 2.24.0
    setuptools 40.5.0
    six 1.14.0
    WeasyPrint 52.5
-->
<link href="rfc9176.xml" rel="alternate" type="application/rfc+xml"/>
<link href="#copyright" rel="license"/>
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css"/>
<link href="https://dx.doi.org/10.17487/rfc9176" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <link href="https://datatracker.ietf.org/doc/draft-ietf-core-resource-directory-28" rel="prev"/>
  </head>
<body>
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 9176</td>
<td class="center">CoRE Resource Directory</td>
<td class="right">April 2022</td>
</tr></thead>
<tfoot><tr>
<td class="left">AmsÃ¼ss, et al.</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div class="document-information" id="external-metadata"></div>
<div class="document-information" id="internal-metadata">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a class="eref" href="https://www.rfc-editor.org/rfc/rfc9176">9176</a></dd>
<dt class="label-category">Category:</dt>
<dd class="category">Standards Track</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time class="published" datetime="2022-04">April 2022</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">C. AmsÃ¼ss, <span class="editor">Ed.</span>
</div>
</div>
<div class="author">
      <div class="author-name">Z. Shelby</div>
<div class="org">Edge Impulse</div>
</div>
<div class="author">
      <div class="author-name">M. Koster</div>
<div class="org">PassiveLogic</div>
</div>
<div class="author">
      <div class="author-name">C. Bormann</div>
<div class="org">UniversitÃ¤t Bremen TZI</div>
</div>
<div class="author">
      <div class="author-name">P. van der Stok</div>
<div class="org">vanderstok consultancy</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 9176</h1>
<h1 id="title">Constrained RESTful Environments (CoRE) Resource Directory</h1>
<section id="section-abstract">
      <h2 id="abstract"><a class="selfRef" href="#abstract">Abstract</a></h2>
<p id="section-abstract-1">In many Internet of Things (IoT) applications, direct discovery of resources is not
      practical due to sleeping nodes or networks where multicast traffic
is inefficient. These problems can be solved by employing an entity called
a Resource Directory (RD), which contains information about resources held on
other servers, allowing lookups to be performed for those resources. The input to an RD is composed of links, and the output is composed of links constructed from the information stored in the RD. This
document specifies the web interfaces that an RD supports for web servers to discover the RD and to register, maintain, look up,
and remove information on resources. Furthermore, new target attributes useful
in conjunction with an RD are defined.<a class="pilcrow" href="#section-abstract-1">Â¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a class="section-name selfRef" href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This is an Internet Standards Track document.<a class="pilcrow" href="#section-boilerplate.1-1">Â¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.<a class="pilcrow" href="#section-boilerplate.1-2">Â¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc9176">https://www.rfc-editor.org/info/rfc9176</a></span>.<a class="pilcrow" href="#section-boilerplate.1-3">Â¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a class="section-name selfRef" href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2022 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a class="pilcrow" href="#section-boilerplate.2-1">Â¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a class="pilcrow" href="#section-boilerplate.2-2">Â¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a class="toplink" href="#" onclick="scroll(0,0)">â²</a><h2 id="name-table-of-contents">
<a class="section-name selfRef" href="#name-table-of-contents">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p class="keepWithNext" id="section-toc.1-1.1.1"><a class="xref" href="#section-1">1</a>.Â Â <a class="xref" href="#name-introduction">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p class="keepWithNext" id="section-toc.1-1.2.1"><a class="xref" href="#section-2">2</a>.Â Â <a class="xref" href="#name-terminology">Terminology</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a class="xref" href="#section-3">3</a>.Â Â <a class="xref" href="#name-architecture-and-use-cases">Architecture and Use Cases</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p class="keepWithNext" id="section-toc.1-1.3.2.1.1"><a class="xref" href="#section-3.1">3.1</a>.Â Â <a class="xref" href="#name-principles">Principles</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a class="xref" href="#section-3.2">3.2</a>.Â Â <a class="xref" href="#name-architecture">Architecture</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a class="xref" href="#section-3.3">3.3</a>.Â Â <a class="xref" href="#name-rd-content-model">RD Content Model</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a class="xref" href="#section-3.4">3.4</a>.Â Â <a class="xref" href="#name-link-local-addresses-and-zo">Link-Local Addresses and Zone Identifiers</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a class="xref" href="#section-3.5">3.5</a>.Â Â <a class="xref" href="#name-use-case-cellular-m2m">Use Case: Cellular M2M</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6">
                <p id="section-toc.1-1.3.2.6.1"><a class="xref" href="#section-3.6">3.6</a>.Â Â <a class="xref" href="#name-use-case-home-and-building-">Use Case: Home and Building Automation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.7">
                <p id="section-toc.1-1.3.2.7.1"><a class="xref" href="#section-3.7">3.7</a>.Â Â <a class="xref" href="#name-use-case-link-catalogues">Use Case: Link Catalogues</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a class="xref" href="#section-4">4</a>.Â Â <a class="xref" href="#name-rd-discovery-and-other-inte">RD Discovery and Other Interface-Independent Components</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a class="xref" href="#section-4.1">4.1</a>.Â Â <a class="xref" href="#name-finding-a-resource-director">Finding a Resource Directory</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.1">
                    <p id="section-toc.1-1.4.2.1.2.1.1"><a class="xref" href="#section-4.1.1">4.1.1</a>.Â Â <a class="xref" href="#name-resource-directory-address-">Resource Directory Address Option (RDAO)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.2">
                    <p id="section-toc.1-1.4.2.1.2.2.1"><a class="xref" href="#section-4.1.2">4.1.2</a>.Â Â <a class="xref" href="#name-using-dns-sd-to-discover-a-">Using DNS-SD to Discover a Resource Directory</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a class="xref" href="#section-4.2">4.2</a>.Â Â <a class="xref" href="#name-payload-content-formats">Payload Content Formats</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a class="xref" href="#section-4.3">4.3</a>.Â Â <a class="xref" href="#name-uri-discovery">URI Discovery</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a class="xref" href="#section-5">5</a>.Â Â <a class="xref" href="#name-registration">Registration</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a class="xref" href="#section-5.1">5.1</a>.Â Â <a class="xref" href="#name-simple-registration">Simple Registration</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a class="xref" href="#section-5.2">5.2</a>.Â Â <a class="xref" href="#name-third-party-registration">Third-Party Registration</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a class="xref" href="#section-5.3">5.3</a>.Â Â <a class="xref" href="#name-operations-on-the-registrat">Operations on the Registration Resource</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.1">
                    <p id="section-toc.1-1.5.2.3.2.1.1"><a class="xref" href="#section-5.3.1">5.3.1</a>.Â Â <a class="xref" href="#name-registration-update">Registration Update</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.2">
                    <p id="section-toc.1-1.5.2.3.2.2.1"><a class="xref" href="#section-5.3.2">5.3.2</a>.Â Â <a class="xref" href="#name-registration-removal">Registration Removal</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.3">
                    <p id="section-toc.1-1.5.2.3.2.3.1"><a class="xref" href="#section-5.3.3">5.3.3</a>.Â Â <a class="xref" href="#name-further-operations">Further Operations</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.4">
                    <p id="section-toc.1-1.5.2.3.2.4.1"><a class="xref" href="#section-5.3.4">5.3.4</a>.Â Â <a class="xref" href="#name-request-freshness">Request Freshness</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a class="xref" href="#section-6">6</a>.Â Â <a class="xref" href="#name-rd-lookup">RD Lookup</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a class="xref" href="#section-6.1">6.1</a>.Â Â <a class="xref" href="#name-resource-lookup">Resource Lookup</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a class="xref" href="#section-6.2">6.2</a>.Â Â <a class="xref" href="#name-lookup-filtering">Lookup Filtering</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a class="xref" href="#section-6.3">6.3</a>.Â Â <a class="xref" href="#name-resource-lookup-examples">Resource Lookup Examples</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a class="xref" href="#section-6.4">6.4</a>.Â Â <a class="xref" href="#name-endpoint-lookup">Endpoint Lookup</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a class="xref" href="#section-7">7</a>.Â Â <a class="xref" href="#name-security-policies">Security Policies</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a class="xref" href="#section-7.1">7.1</a>.Â Â <a class="xref" href="#name-endpoint-name">Endpoint Name</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1.2.1">
                    <p id="section-toc.1-1.7.2.1.2.1.1"><a class="xref" href="#section-7.1.1">7.1.1</a>.Â Â <a class="xref" href="#name-random-endpoint-names">Random Endpoint Names</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a class="xref" href="#section-7.2">7.2</a>.Â Â <a class="xref" href="#name-entered-links">Entered Links</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a class="xref" href="#section-7.3">7.3</a>.Â Â <a class="xref" href="#name-link-confidentiality">Link Confidentiality</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a class="xref" href="#section-7.4">7.4</a>.Â Â <a class="xref" href="#name-segmentation">Segmentation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5">
                <p id="section-toc.1-1.7.2.5.1"><a class="xref" href="#section-7.5">7.5</a>.Â Â <a class="xref" href="#name-first-come-first-remembered">"First Come First Remembered": A Default Policy</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a class="xref" href="#section-8">8</a>.Â Â <a class="xref" href="#name-security-considerations">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a class="xref" href="#section-8.1">8.1</a>.Â Â <a class="xref" href="#name-discovery">Discovery</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a class="xref" href="#section-8.2">8.2</a>.Â Â <a class="xref" href="#name-endpoint-identification-and">Endpoint Identification and Authentication</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a class="xref" href="#section-8.3">8.3</a>.Â Â <a class="xref" href="#name-access-control">Access Control</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4">
                <p id="section-toc.1-1.8.2.4.1"><a class="xref" href="#section-8.4">8.4</a>.Â Â <a class="xref" href="#name-denial-of-service-attacks">Denial-of-Service Attacks</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.5">
                <p id="section-toc.1-1.8.2.5.1"><a class="xref" href="#section-8.5">8.5</a>.Â Â <a class="xref" href="#name-skipping-freshness-checks">Skipping Freshness Checks</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a class="xref" href="#section-9">9</a>.Â Â <a class="xref" href="#name-iana-considerations">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a class="xref" href="#section-9.1">9.1</a>.Â Â <a class="xref" href="#name-resource-types">Resource Types</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a class="xref" href="#section-9.2">9.2</a>.Â Â <a class="xref" href="#name-ipv6-nd-resource-directory-">IPv6 ND Resource Directory Address Option</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a class="xref" href="#section-9.3">9.3</a>.Â Â <a class="xref" href="#name-rd-parameters-registry">RD Parameters Registry</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3.2.1">
                    <p id="section-toc.1-1.9.2.3.2.1.1"><a class="xref" href="#section-9.3.1">9.3.1</a>.Â Â <a class="xref" href="#name-full-description-of-the-end">Full Description of the "Endpoint Type" RD Parameter</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.4">
                <p id="section-toc.1-1.9.2.4.1"><a class="xref" href="#section-9.4">9.4</a>.Â Â <a class="xref" href="#name-endpoint-type-et-rd-paramet">Endpoint Type (et=) RD Parameter Values</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.5">
                <p id="section-toc.1-1.9.2.5.1"><a class="xref" href="#section-9.5">9.5</a>.Â Â <a class="xref" href="#name-multicast-address-registrat">Multicast Address Registration</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.6">
                <p id="section-toc.1-1.9.2.6.1"><a class="xref" href="#section-9.6">9.6</a>.Â Â <a class="xref" href="#name-well-known-uris">Well-Known URIs</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.7">
                <p id="section-toc.1-1.9.2.7.1"><a class="xref" href="#section-9.7">9.7</a>.Â Â <a class="xref" href="#name-service-name-and-transport-">Service Name and Transport Protocol Port Number Registry</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a class="xref" href="#section-10">10</a>.Â <a class="xref" href="#name-examples">Examples</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a class="xref" href="#section-10.1">10.1</a>.Â Â <a class="xref" href="#name-lighting-installation">Lighting Installation</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1.2.1">
                    <p id="section-toc.1-1.10.2.1.2.1.1"><a class="xref" href="#section-10.1.1">10.1.1</a>.Â Â <a class="xref" href="#name-installation-characteristic">Installation Characteristics</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1.2.2">
                    <p id="section-toc.1-1.10.2.1.2.2.1"><a class="xref" href="#section-10.1.2">10.1.2</a>.Â Â <a class="xref" href="#name-rd-entries">RD Entries</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a class="xref" href="#section-10.2">10.2</a>.Â Â <a class="xref" href="#name-oma-lightweight-m2m-lwm2m">OMA Lightweight M2M (LwM2M)</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a class="xref" href="#section-11">11</a>.Â <a class="xref" href="#name-references">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a class="xref" href="#section-11.1">11.1</a>.Â Â <a class="xref" href="#name-normative-references">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a class="xref" href="#section-11.2">11.2</a>.Â Â <a class="xref" href="#name-informative-references">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a class="xref" href="#appendix-A">Appendix A</a>.Â Â <a class="xref" href="#name-groups-registration-and-loo">Groups Registration and Lookup</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a class="xref" href="#appendix-B">Appendix B</a>.Â Â <a class="xref" href="#name-web-links-and-the-resource-">Web Links and the Resource Directory</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a class="xref" href="#appendix-B.1">B.1</a>.Â Â <a class="xref" href="#name-a-simple-example">A Simple Example</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1.2.1">
                    <p id="section-toc.1-1.13.2.1.2.1.1"><a class="xref" href="#appendix-B.1.1">B.1.1</a>.Â Â <a class="xref" href="#name-resolving-the-uris">Resolving the URIs</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1.2.2">
                    <p id="section-toc.1-1.13.2.1.2.2.1"><a class="xref" href="#appendix-B.1.2">B.1.2</a>.Â Â <a class="xref" href="#name-interpreting-attributes-and">Interpreting Attributes and Relations</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a class="xref" href="#appendix-B.2">B.2</a>.Â Â <a class="xref" href="#name-a-slightly-more-complex-exa">A Slightly More Complex Example</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.3">
                <p id="section-toc.1-1.13.2.3.1"><a class="xref" href="#appendix-B.3">B.3</a>.Â Â <a class="xref" href="#name-enter-the-resource-director">Enter the Resource Directory</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.4">
                <p id="section-toc.1-1.13.2.4.1"><a class="xref" href="#appendix-B.4">B.4</a>.Â Â <a class="xref" href="#name-a-note-on-differences-betwe">A Note on Differences between Link-Format and Link Header Fields</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a class="xref" href="#appendix-C">Appendix C</a>.Â Â <a class="xref" href="#name-limited-link-format">Limited Link Format</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a class="xref" href="#appendix-D"></a><a class="xref" href="#name-acknowledgments">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a class="xref" href="#appendix-E"></a><a class="xref" href="#name-authors-addresses">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a class="section-number selfRef" href="#section-1">1. </a><a class="section-name selfRef" href="#name-introduction">Introduction</a>
      </h2>
<p id="section-1-1">In the work on Constrained RESTful Environments (CoRE), a Representational State Transfer (REST) architecture
suitable for constrained nodes (e.g., with limited RAM and ROM <span>[<a class="xref" href="#RFC7228">RFC7228</a>]</span>)
and networks (e.g., IPv6 over Low-Power Wireless Personal Area Network (6LoWPAN) <span>[<a class="xref" href="#RFC4944">RFC4944</a>]</span>)
has been established and is used in
Internet of Things (IoT) or
machine-to-machine (M2M) applications, such as smart energy
and building automation.<a class="pilcrow" href="#section-1-1">Â¶</a></p>
<p id="section-1-2">The discovery of resources offered by a constrained server is very important
in machine-to-machine applications where there are no humans in the loop and
static interfaces result in fragility. The discovery of resources provided by
an HTTP web server is typically called web linking <span>[<a class="xref" href="#RFC8288">RFC8288</a>]</span>. The use of
web linking for the description and discovery of resources hosted by
constrained web servers is specified by the CoRE Link Format
<span>[<a class="xref" href="#RFC6690">RFC6690</a>]</span>. However, <span>[<a class="xref" href="#RFC6690">RFC6690</a>]</span> only describes how to discover
resources from the web server that hosts them by querying
<code>/.well-known/core</code>. In many constrained scenarios, direct discovery of resources is
not practical due to sleeping nodes or networks where
multicast traffic is inefficient. These problems can be solved by employing
an entity called a Resource Directory (RD), which contains information about resources held on
other servers, allowing lookups to be performed for those resources.<a class="pilcrow" href="#section-1-2">Â¶</a></p>
<p id="section-1-3">This document specifies the web interfaces that an RD supports for web servers to discover the RD and to register, maintain, look up,
and remove information on resources. Furthermore, new target attributes useful in
conjunction with an RD are defined. Although the examples in
this document show the use of these interfaces with the Constrained Application Protocol (CoAP) <span>[<a class="xref" href="#RFC7252">RFC7252</a>]</span>, they
can be applied in an equivalent manner to HTTP <span>[<a class="xref" href="#RFC7230">RFC7230</a>]</span>.<a class="pilcrow" href="#section-1-3">Â¶</a></p>
</section>
</div>
<div id="terminology">
<section id="section-2">
      <h2 id="name-terminology">
<a class="section-number selfRef" href="#section-2">2. </a><a class="section-name selfRef" href="#name-terminology">Terminology</a>
      </h2>
<p id="section-2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>",
"<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>", "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>"
in this
document are to be interpreted as described in BCP 14 <span>[<a class="xref" href="#RFC2119">RFC2119</a>]</span> <span>[<a class="xref" href="#RFC8174">RFC8174</a>]</span>
when, and only when, they appear in all capitals, as shown here.<a class="pilcrow" href="#section-2-1">Â¶</a></p>
<p id="section-2-2">The term "byte" is used in its now customary sense as a synonym for "octet".<a class="pilcrow" href="#section-2-2">Â¶</a></p>
<p id="section-2-3">This specification requires readers to be familiar with all the terms and
concepts that are discussed in <span>[<a class="xref" href="#RFC3986">RFC3986</a>]</span>, <span>[<a class="xref" href="#RFC8288">RFC8288</a>]</span>, and <span>[<a class="xref" href="#RFC6690">RFC6690</a>]</span>. Readers should
also be familiar with the terms and concepts discussed in <span>[<a class="xref" href="#RFC7252">RFC7252</a>]</span>.  To
describe the REST interfaces defined in this specification, the URI Template
format is used <span>[<a class="xref" href="#RFC6570">RFC6570</a>]</span>.<a class="pilcrow" href="#section-2-3">Â¶</a></p>
<p id="section-2-4">This specification makes use of the following additional terminology:<a class="pilcrow" href="#section-2-4">Â¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-2-5">
        <dt id="section-2-5.1">Resolve Against</dt>
        <dd id="section-2-5.2" style="margin-left: 1.5em">The expression "a URI reference is <em>resolved against</em> a base URI" is used
 to describe the process of <span>[<a class="xref" href="#RFC3986">RFC3986</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc3986#section-5.2">Section 5.2</a></span>.
       Noteworthy corner cases include the following: (1) if the URI reference is a (full)
      URI, resolving against any base URI gives the original
      full URI and (2) resolving an empty URI reference gives the base
      URI without any fragment identifier.<a class="pilcrow" href="#section-2-5.2">Â¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.3">Resource Directory (RD)</dt>
        <dd id="section-2-5.4" style="margin-left: 1.5em">
          <p id="section-2-5.4.1">A web entity that stores information about web resources and
          implements the REST interfaces defined in this specification for
          discovery, for the creation, maintenance, and removal of
          registrations, and for lookup of the registered resources.<a class="pilcrow" href="#section-2-5.4.1">Â¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.5">Sector</dt>
        <dd id="section-2-5.6" style="margin-left: 1.5em">
          <p id="section-2-5.6.1">In the context of an RD, a sector is a logical grouping of endpoints.<a class="pilcrow" href="#section-2-5.6.1">Â¶</a></p>
<p id="section-2-5.6.2">The abbreviation "d=" is used for the sector in query parameters for
   compatibility with deployed implementations.<a class="pilcrow" href="#section-2-5.6.2">Â¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.7">Endpoint (EP)</dt>
        <dd id="section-2-5.8" style="margin-left: 1.5em">
          <p id="section-2-5.8.1">Endpoint (EP) is a term used to describe a web server or client
          in <span>[<a class="xref" href="#RFC7252">RFC7252</a>]</span>.  In the context of
          this specification, an endpoint is used to describe a web server
          that registers resources to the RD. An endpoint is identified by its
          endpoint name, which is included during registration, and has a
          unique name within the associated sector of the registration.<a class="pilcrow" href="#section-2-5.8.1">Â¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.9">Registration Base URI</dt>
        <dd id="section-2-5.10" style="margin-left: 1.5em">
          <p id="section-2-5.10.1">The base URI of a registration is a URI that typically gives scheme and
   authority information about an endpoint. The registration base URI is provided at
   registration time and is used by the RD to
   resolve relative references of the registration into URIs.<a class="pilcrow" href="#section-2-5.10.1">Â¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.11">Target</dt>
        <dd id="section-2-5.12" style="margin-left: 1.5em">
          <p id="section-2-5.12.1">The target of a link is the destination address (URI) of the link. It is
   sometimes identified with "href=" or displayed as <code>&lt;target&gt;</code>.
   Relative targets need resolving with respect to the base URI (<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc3986#section-5.2">Section 5.2</a> of [<a class="xref" href="#RFC3986">RFC3986</a>]</span>).<a class="pilcrow" href="#section-2-5.12.1">Â¶</a></p>
<p id="section-2-5.12.2">This use of the term "target" is consistent with the use in <span>[<a class="xref" href="#RFC8288">RFC8288</a>]</span>.<a class="pilcrow" href="#section-2-5.12.2">Â¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.13">Context</dt>
        <dd id="section-2-5.14" style="margin-left: 1.5em">
          <p id="section-2-5.14.1">The context of a link is the source address (URI) of the link
   and describes which resource is linked to the target.
   A link's context is made explicit in serialized links as the "anchor=" attribute.<a class="pilcrow" href="#section-2-5.14.1">Â¶</a></p>
<p id="section-2-5.14.2">This use of the term "context" is consistent with the use in <span>[<a class="xref" href="#RFC8288">RFC8288</a>]</span>.<a class="pilcrow" href="#section-2-5.14.2">Â¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.15">Directory Resource</dt>
        <dd id="section-2-5.16" style="margin-left: 1.5em">
          <p id="section-2-5.16.1">A directory resource is a resource in the RD containing registration resources.<a class="pilcrow" href="#section-2-5.16.1">Â¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.17">Registration Resource</dt>
        <dd id="section-2-5.18" style="margin-left: 1.5em">
          <p id="section-2-5.18.1">A registration resource is a resource in the RD that contains information about an
   endpoint and its links.<a class="pilcrow" href="#section-2-5.18.1">Â¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.19">Commissioning Tool (CT)</dt>
        <dd id="section-2-5.20" style="margin-left: 1.5em">
          <p id="section-2-5.20.1">A Commissioning Tool (CT) is a device that assists during installation events
   by assigning values to parameters, naming endpoints and groups, or adapting
   the installation to the needs of the applications.<a class="pilcrow" href="#section-2-5.20.1">Â¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.21">Registrant-EP</dt>
        <dd id="section-2-5.22" style="margin-left: 1.5em">
          <p id="section-2-5.22.1">A registrant-EP is the endpoint that is registered into the RD. The registrant-EP can
   register itself, or a CT registers the registrant-EP.<a class="pilcrow" href="#section-2-5.22.1">Â¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.23">Resource Directory Address Option (RDAO)</dt>
        <dd id="section-2-5.24" style="margin-left: 1.5em">
          <p id="section-2-5.24.1">A Resource Directory Address Option (RDAO) is a new IPv6 Neighbor Discovery option defined
   for announcing an RD's address.<a class="pilcrow" href="#section-2-5.24.1">Â¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
</section>
</div>
<div id="arch">
<section id="section-3">
      <h2 id="name-architecture-and-use-cases">
<a class="section-number selfRef" href="#section-3">3. </a><a class="section-name selfRef" href="#name-architecture-and-use-cases">Architecture and Use Cases</a>
      </h2>
<div id="principles">
<section id="section-3.1">
        <h3 id="name-principles">
<a class="section-number selfRef" href="#section-3.1">3.1. </a><a class="section-name selfRef" href="#name-principles">Principles</a>
        </h3>
<p id="section-3.1-1">The RD is primarily a tool to make discovery operations more
efficient than querying <code>/.well-known/core</code> on all connected devices or across
boundaries that would limit those operations.<a class="pilcrow" href="#section-3.1-1">Â¶</a></p>
<p id="section-3.1-2">It provides information about resources hosted by other devices that could otherwise only be obtained by
directly querying the <code>/.well-known/core</code> resource on these other devices, either by a unicast request or a multicast request.<a class="pilcrow" href="#section-3.1-2">Â¶</a></p>
<p id="section-3.1-3">Information <span class="bcp14">SHOULD</span> only be stored in the RD
if it can be obtained by querying the described device's
<code>/.well-known/core</code> resource directly.<a class="pilcrow" href="#section-3.1-3">Â¶</a></p>
<p id="section-3.1-4">Data in the RD can only be provided by the
device that hosts the data or a dedicated Commissioning Tool (CT).
These CTs act on behalf of endpoints too constrained, or generally
unable, to present that information themselves. No other client can modify data
in the RD. Changes to the information in the RD do not propagate automatically back to the web servers from where the information originated.<a class="pilcrow" href="#section-3.1-4">Â¶</a></p>
</section>
</div>
<div id="architecture">
<section id="section-3.2">
        <h3 id="name-architecture">
<a class="section-number selfRef" href="#section-3.2">3.2. </a><a class="section-name selfRef" href="#name-architecture">Architecture</a>
        </h3>
<p id="section-3.2-1">The RD architecture is illustrated in <a class="xref" href="#fig-arch">Figure 1</a>. An
RD is used as a repository of registrations
describing resources hosted on other web servers, also called endpoints
(EPs).
An endpoint is a web server associated with a scheme, IP address, and port. A physical node may host one or more endpoints. The
RD implements a set of REST interfaces for endpoints to register and maintain
RD registrations and for endpoints to
look up resources from the RD. An RD can be logically segmented by the use of sectors.<a class="pilcrow" href="#section-3.2-1">Â¶</a></p>
<p id="section-3.2-2">A mechanism to discover an RD using CoRE Link Format <span>[<a class="xref" href="#RFC6690">RFC6690</a>]</span> is defined.<a class="pilcrow" href="#section-3.2-2">Â¶</a></p>
<p id="section-3.2-3">Registrations in the RD are soft state and need to be periodically refreshed.<a class="pilcrow" href="#section-3.2-3">Â¶</a></p>
<p id="section-3.2-4">An endpoint uses specific interfaces to register, update, and remove a registration. It is also possible for an RD to fetch web links
from endpoints and add their contents to its registrations.<a class="pilcrow" href="#section-3.2-4">Â¶</a></p>
<p id="section-3.2-5">At the first registration of an endpoint, a "registration resource" is created,
the location of which is returned to the registering endpoint. The registering
endpoint uses this registration resource to manage the contents of registrations.<a class="pilcrow" href="#section-3.2-5">Â¶</a></p>
<p id="section-3.2-6">A lookup interface for discovering any of the web links stored in the RD is
provided using the CoRE Link Format.<a class="pilcrow" href="#section-3.2-6">Â¶</a></p>
<span id="name-the-rd-architecture"></span><div id="fig-arch">
<figure id="figure-1">
          <div class="alignLeft art-ascii-art art-text artwork" id="section-3.2-7.1">
<pre>           Registration         Lookup
            Interface         Interface
+----+          |                 |
| EP |----      |                 |
+----+    ----  |                 |
              --|-    +------+    |
+----+          | ----|      |    |     +--------+
| EP | ---------|-----|  RD  |----|-----| Client |
+----+          | ----|      |    |     +--------+
              --|-    +------+    |
+----+    ----  |                 |
| CT |----      |                 |
+----+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-1">Figure 1</a>:
<a class="selfRef" href="#name-the-rd-architecture">The RD Architecture</a>
          </figcaption></figure>
</div>
<p id="section-3.2-8">A registrant-EP <span class="bcp14">MAY</span> keep concurrent registrations to more than one RD at the same time
if explicitly configured to do so,
but that is not expected to be supported by typical EP implementations.
Any such registrations are independent of each other.
The usual expectation when multiple discovery mechanisms or addresses are configured
is that they constitute a fall-back path for a single registration.<a class="pilcrow" href="#section-3.2-8">Â¶</a></p>
</section>
</div>
<div id="ER-model">
<section id="section-3.3">
        <h3 id="name-rd-content-model">
<a class="section-number selfRef" href="#section-3.3">3.3. </a><a class="section-name selfRef" href="#name-rd-content-model">RD Content Model</a>
        </h3>
<p id="section-3.3-1">The Entity-Relationship (ER) models shown in Figures <a class="xref" href="#fig-ER-WKC">2</a> and <a class="xref" href="#fig-ER-RD">3</a> model the contents of <code>/.well-known/core</code> and the RD respectively, with entity-relationship diagrams <span>[<a class="xref" href="#ER">ER</a>]</span>. Entities (rectangles) are used for concepts that exist independently. Attributes (ovals) are used for concepts that exist only in connection with a related entity. Relations (diamonds) give a semantic meaning to the relation between entities. Numbers specify the cardinality of the relations.<a class="pilcrow" href="#section-3.3-1">Â¶</a></p>
<p id="section-3.3-2">Some of the attribute values are URIs. Those values are always full URIs and never relative references in the information model.
However, they can be expressed as relative references in serializations, and they often are.<a class="pilcrow" href="#section-3.3-2">Â¶</a></p>
<p id="section-3.3-3">These models provide an abstract view of the information expressed in link-format documents and an RD. They cover the concepts but not necessarily all details of an RD's operation; they are meant to give an overview and not be a template for implementations.<a class="pilcrow" href="#section-3.3-3">Â¶</a></p>
<span id="name-er-model-of-the-content-of-"></span><div id="fig-ER-WKC">
<figure id="figure-2">
          <div class="alignLeft art-ascii-art art-text artwork" id="section-3.3-4.1">
<pre>           +----------------------+
           |   /.well-known/core  |
           +----------------------+
                      |
                      | 1
              ////////\\\\\\\
             &lt;    contains   &gt;
              \\\\\\\\///////
                      |
                      | 0+
            +--------------------+
            |      link          |
            +--------------------+
                      |
                      |  1   oooooooo
                      +-----o target o
                      |      oooooooo
 oooooooooooo   0+    |
o    target  o--------+
o  attribute o        | 0+   oooooo
 oooooooooooo         +-----o rel  o
                      |      oooooo
                      |
                      | 1    ooooooooo
                      +-----o context o
                             ooooooooo
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-2">Figure 2</a>:
<a class="selfRef" href="#name-er-model-of-the-content-of-">ER Model of the Content of <code>/.well-known/core</code></a>
          </figcaption></figure>
</div>
<p id="section-3.3-5"><a class="xref" href="#fig-ER-WKC">Figure 2</a> models the contents of
 <code>/.well-known/core</code>, which contains a set of links belonging to the hosting web server.<a class="pilcrow" href="#section-3.3-5">Â¶</a></p>
<p id="section-3.3-6">The web server is free to choose links it deems appropriate to be exposed in its <code>/.well-known/core</code>.
Typically, the links describe resources that are served by the host, but the set can also contain links to resources on other servers (see examples in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc6690#section-5">Section 5</a> of [<a class="xref" href="#RFC6690">RFC6690</a>]</span>).
The set does not necessarily contain links to all resources served by the host.<a class="pilcrow" href="#section-3.3-6">Â¶</a></p>
<p id="section-3.3-7">A link has the following attributes (see <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8288#section-5">Section 5</a> of [<a class="xref" href="#RFC8288">RFC8288</a>]</span>):<a class="pilcrow" href="#section-3.3-7">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3-8.1">
            <p id="section-3.3-8.1.1">Zero or more link relations:
     They describe relations between the link context and the link target.<a class="pilcrow" href="#section-3.3-8.1.1">Â¶</a></p>
<p id="section-3.3-8.1.2">In link-format serialization, they are expressed as space-separated values in the
     "rel" attribute and default to "hosts".<a class="pilcrow" href="#section-3.3-8.1.2">Â¶</a></p>
</li>
          <li class="normal" id="section-3.3-8.2">
            <p id="section-3.3-8.2.1">A link context URI: It defines the source of the relation, e.g., <em>who</em> "hosts" something.<a class="pilcrow" href="#section-3.3-8.2.1">Â¶</a></p>
<p id="section-3.3-8.2.2">In link-format serialization, it is expressed in the "anchor" attribute and defaults
     to the Origin of the target (practically, the target with its path and later components
     removed).<a class="pilcrow" href="#section-3.3-8.2.2">Â¶</a></p>
</li>
          <li class="normal" id="section-3.3-8.3">
            <p id="section-3.3-8.3.1">A link target URI: It defines the destination of the relation (e.g., <em>what</em> is hosted) and is
     the topic of all target attributes.<a class="pilcrow" href="#section-3.3-8.3.1">Â¶</a></p>
<p id="section-3.3-8.3.2">In link-format serialization, it is expressed between angular brackets and
     sometimes called the "href".<a class="pilcrow" href="#section-3.3-8.3.2">Â¶</a></p>
</li>
          <li class="normal" id="section-3.3-8.4">Other target attributes (e.g., resource type (rt), interface (if), or content format (ct)): These provide additional information about the target URI.<a class="pilcrow" href="#section-3.3-8.4">Â¶</a>
</li>
        </ul>
<span id="name-er-model-of-the-content-of-t"></span><div id="fig-ER-RD">
<figure id="figure-3">
          <div class="alignLeft art-ascii-art art-text artwork" id="section-3.3-9.1">
<pre>                 +--------------+
                 +      RD      +
                 +--------------+
                        | 1
                        |
                        |
                        |
                        |
                   //////\\\\
                  &lt; contains &gt;
                   \\\\\/////
                        |
                     0+ |
 ooooooo     1  +---------------+
o  base o-------|  registration |
 ooooooo        +---------------+
                    |       | 1
                    |       +--------------+
       oooooooo   1 |                      |
      o  href  o----+                 /////\\\\
       oooooooo     |                &lt; contains &gt;
                    |                 \\\\\/////
       oooooooo   1 |                      |
      o   ep   o----+                      | 0+
       oooooooo     |             +------------------+
                    |             |      link        |
       oooooooo 0-1 |             +------------------+
      o    d   o----+                      |
       oooooooo     |                      |  1   oooooooo
                    |                      +-----o target o
       oooooooo   1 |                      |      oooooooo
      o   lt   o----+     ooooooooooo   0+ |
       oooooooo     |    o  target   o-----+
                    |    o attribute o     | 0+   oooooo
    ooooooooooo 0+  |     ooooooooooo      +-----o rel  o
   o  endpoint o----+                      |      oooooo
   o attribute o                           |
    ooooooooooo                            | 1   ooooooooo
                                           +----o context o
                                                 ooooooooo
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-3">Figure 3</a>:
<a class="selfRef" href="#name-er-model-of-the-content-of-t">ER Model of the Content of the RD</a>
          </figcaption></figure>
</div>
<p id="section-3.3-10"><a class="xref" href="#fig-ER-RD">Figure 3</a> models the contents of
 the RD, which contains, in addition to <code>/.well-known/core</code>, 0 to n registrations of
 endpoints.<a class="pilcrow" href="#section-3.3-10">Â¶</a></p>
<p id="section-3.3-11">A registration is associated with one endpoint. A registration defines a set of links,
 as defined for <code>/.well-known/core</code>. A registration has six types of attributes:<a class="pilcrow" href="#section-3.3-11">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3-12.1">an endpoint name ("ep", a Unicode string) unique within a sector<a class="pilcrow" href="#section-3.3-12.1">Â¶</a>
</li>
          <li class="normal" id="section-3.3-12.2">a registration base URI ("base", a URI typically describing the scheme://authority part)<a class="pilcrow" href="#section-3.3-12.2">Â¶</a>
</li>
          <li class="normal" id="section-3.3-12.3">a lifetime ("lt")<a class="pilcrow" href="#section-3.3-12.3">Â¶</a>
</li>
          <li class="normal" id="section-3.3-12.4">a registration resource location inside the RD ("href")<a class="pilcrow" href="#section-3.3-12.4">Â¶</a>
</li>
          <li class="normal" id="section-3.3-12.5">optionally, a sector ("d", a Unicode string)<a class="pilcrow" href="#section-3.3-12.5">Â¶</a>
</li>
          <li class="normal" id="section-3.3-12.6">optional additional endpoint attributes (from <a class="xref" href="#iana-registry">Section 9.3</a>)<a class="pilcrow" href="#section-3.3-12.6">Â¶</a>
</li>
        </ul>
<p id="section-3.3-13">The cardinality of "base" is currently 1;
future documents are invited to extend the RD specification to support multiple values (e.g., <span>[<a class="xref" href="#I-D.silverajan-core-coap-protocol-negotiation">COAP-PROT-NEG</a>]</span>).
Its value is used as a base URI when resolving URIs in the links contained in the endpoint.<a class="pilcrow" href="#section-3.3-13">Â¶</a></p>
<p id="section-3.3-14">Links are modeled as they are in <a class="xref" href="#fig-ER-WKC">Figure 2</a>.<a class="pilcrow" href="#section-3.3-14">Â¶</a></p>
</section>
</div>
<div id="linklocal">
<section id="section-3.4">
        <h3 id="name-link-local-addresses-and-zo">
<a class="section-number selfRef" href="#section-3.4">3.4. </a><a class="section-name selfRef" href="#name-link-local-addresses-and-zo">Link-Local Addresses and Zone Identifiers</a>
        </h3>
<p id="section-3.4-1">Registration base URIs can contain link-local IP addresses.
        To be usable across hosts, those cannot be serialized to
        contain zone identifiers (see <span>[<a class="xref" href="#RFC6874">RFC6874</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc6874#section-1">Section 1</a></span>).<a class="pilcrow" href="#section-3.4-1">Â¶</a></p>
<p id="section-3.4-2">Link-local addresses can only be used on a single link
(therefore, RD servers cannot announce them when queried on a different link),
and lookup clients using them need to keep track of which interface they got them from.<a class="pilcrow" href="#section-3.4-2">Â¶</a></p>
<p id="section-3.4-3">Therefore, it is advisable in many scenarios
to use addresses with larger scopes, if available.<a class="pilcrow" href="#section-3.4-3">Â¶</a></p>
</section>
</div>
<div id="cellular">
<section id="section-3.5">
        <h3 id="name-use-case-cellular-m2m">
<a class="section-number selfRef" href="#section-3.5">3.5. </a><a class="section-name selfRef" href="#name-use-case-cellular-m2m">Use Case: Cellular M2M</a>
        </h3>
<p id="section-3.5-1">Over the last few years, mobile operators around the world
have focused on development of M2M solutions in order to
expand the business to the new type of users: machines. The
machines are connected directly to a mobile network using an appropriate
embedded wireless interface (GSM/General Packet Radio Service (GPRS), Wideband Code Division Multiple Access (W-CDMA), LTE, etc.) or via a gateway providing
short- and wide-range wireless interfaces.
The ambition in such systems is to build them from reusable components.
These speed up development and deployment
and enable shared use of machines across different applications.
One crucial component of such systems
is the discovery of resources (and thus the endpoints they are hosted on) capable of providing required
information at a given time or acting on instructions from the end users.<a class="pilcrow" href="#section-3.5-1">Â¶</a></p>
<p id="section-3.5-2">Imagine a scenario where endpoints installed on vehicles enable
tracking of the position of these vehicles for fleet management purposes and allow
monitoring of environment parameters. During the boot-up process,
endpoints register with an RD, which is hosted by the
mobile operator or somewhere in the cloud. Periodically, these endpoints
update their registration and may modify resources they offer.<a class="pilcrow" href="#section-3.5-2">Â¶</a></p>
<p id="section-3.5-3">When endpoints are not always connected, for example, because they enter
a sleep mode, a remote server is usually used to provide proxy access to
the endpoints. Mobile apps or web applications for environment monitoring contact the RD, look up the endpoints capable of providing information about the environment using an appropriate set of link parameters, obtain information on how to contact them (URLs of the proxy server), and then initiate interaction to obtain information that is finally processed, displayed on the screen, and usually stored in a database. Similarly, fleet management systems provide
the appropriate link parameters to the RD to look up for EPs deployed on
the vehicles the application is responsible for.<a class="pilcrow" href="#section-3.5-3">Â¶</a></p>
</section>
</div>
<div id="automation">
<section id="section-3.6">
        <h3 id="name-use-case-home-and-building-">
<a class="section-number selfRef" href="#section-3.6">3.6. </a><a class="section-name selfRef" href="#name-use-case-home-and-building-">Use Case: Home and Building Automation</a>
        </h3>
<p id="section-3.6-1">Home and commercial building automation systems can benefit from the use
of IoT web services.  The discovery requirements of these applications are
demanding. Home automation usually relies on run-time discovery to commission
the system, whereas, in building automation, a combination of professional
commissioning and run-time discovery is used. Both home and building automation
involve peer-to-peer interactions between endpoints and involve battery-powered
sleeping devices.
Both can use the common RD infrastructure to establish device interactions efficiently
but can pick security policies suitable for their needs.<a class="pilcrow" href="#section-3.6-1">Â¶</a></p>
<p id="section-3.6-2">Two phases can be discerned for a network servicing the system: (1) installation and (2) operation. During the operational phase, the network is connected to the Internet with a border router (e.g., a 6LoWPAN Border Router (6LBR) <span>[<a class="xref" href="#RFC6775">RFC6775</a>]</span>), and the nodes connected to the network can use the Internet services that are provided by the IP or network administrator. During the installation phase, the network is completely stand-alone, no border router is connected, and the network only supports the IP communication between the connected nodes. The installation phase is usually followed by the operational phase.
As an RD's operations work without hard dependencies on names or addresses,
it can be used for discovery across both phases.<a class="pilcrow" href="#section-3.6-2">Â¶</a></p>
</section>
</div>
<div id="usecase-catalogues">
<section id="section-3.7">
        <h3 id="name-use-case-link-catalogues">
<a class="section-number selfRef" href="#section-3.7">3.7. </a><a class="section-name selfRef" href="#name-use-case-link-catalogues">Use Case: Link Catalogues</a>
        </h3>
<p id="section-3.7-1">Resources may be shared through data brokers that have no knowledge beforehand
of who is going to consume the data. An RD can be used to hold
links about resources and services hosted anywhere to make them discoverable
by a general class of applications.<a class="pilcrow" href="#section-3.7-1">Â¶</a></p>
<p id="section-3.7-2">For example, environmental and weather sensors that generate data for public
consumption may provide data to an intermediary server or broker. Sensor
data are published to the intermediary upon changes or at regular intervals.
Descriptions of the sensors that resolve to links to sensor data may be published
to an RD. Applications wishing to consume the data can use
RD lookup to discover and resolve links
to the desired resources and endpoints. The RD service need
not be coupled with the data intermediary service. Mapping of RDs
to data intermediaries may be many-to-many.<a class="pilcrow" href="#section-3.7-2">Â¶</a></p>
<p id="section-3.7-3">Metadata in web link formats, such as the one defined in <span>[<a class="xref" href="#RFC6690">RFC6690</a>]</span>, which may be internally stored as  triples or relation/attribute
pairs providing metadata about resource links, need to be supported by RDs. External catalogues that are
represented in other formats may be converted to common web linking formats for
storage and access by RDs. Since it is common practice for these
to be encoded in URNs <span>[<a class="xref" href="#RFC8141">RFC8141</a>]</span>, simple and lossless structural transforms should
generally be sufficient to store external metadata in RDs.<a class="pilcrow" href="#section-3.7-3">Â¶</a></p>
<p id="section-3.7-4">The additional features of an RD allow sectors to be defined
to enable access to a particular set of resources from particular applications.
This provides isolation and protection of sensitive data when needed. Application groups with multicast addresses may be defined to support efficient data transport.<a class="pilcrow" href="#section-3.7-4">Â¶</a></p>
</section>
</div>
</section>
</div>
<div id="rd-discovery-and-other-interface-independent-components">
<section id="section-4">
      <h2 id="name-rd-discovery-and-other-inte">
<a class="section-number selfRef" href="#section-4">4. </a><a class="section-name selfRef" href="#name-rd-discovery-and-other-inte">RD Discovery and Other Interface-Independent Components</a>
      </h2>
<p id="section-4-1">This and the following sections define the required set of REST interfaces between an RD,
endpoints, and lookup clients. Although the examples throughout these sections assume the use of
CoAP <span>[<a class="xref" href="#RFC7252">RFC7252</a>]</span>, these REST interfaces can also be realized using HTTP <span>[<a class="xref" href="#RFC7230">RFC7230</a>]</span>.
The multicast discovery and simple registration operations are exceptions to that,
as they rely on mechanisms unavailable in HTTP.
In all definitions in these sections, both CoAP response codes (with dot notation) and HTTP response codes
(without dot notation) are shown. An RD implementing this specification <span class="bcp14">MUST</span> support
the discovery, registration, update, lookup, and removal interfaces.<a class="pilcrow" href="#section-4-1">Â¶</a></p>
<p id="section-4-2">All operations on the contents of the RD <span class="bcp14">MUST</span> be atomic and idempotent.<a class="pilcrow" href="#section-4-2">Â¶</a></p>
<p id="section-4-3">For several operations, interface templates are given in list form;
those describe the operation participants, request codes, URIs, content formats, and outcomes.
Sections of those templates contain normative content about
Interaction, Method, URI Template, and URI Template Variables,
as well as the details of the Success condition.
The additional sections
for options (such as Content-Format) and for Failure codes
give typical cases that an implementation of the RD should deal with.
Those serve to illustrate the typical responses
to readers who are not yet familiar with all the details of CoAP-based interfaces;
they do not limit how a server may respond under atypical circumstances.<a class="pilcrow" href="#section-4-3">Â¶</a></p>
<p id="section-4-4">REST clients (registrant-EPs and CTs during registration and maintenance, lookup clients, and RD servers during simple registrations)
must be prepared to receive any unsuccessful code and act upon it
according to its definition, options, and/or payload to the best of their capabilities,
falling back to failing the operation if recovery is not possible.
In particular, they <span class="bcp14">SHOULD</span> retry the request upon 5.03 (Service Unavailable; 503 in HTTP)
according to the Max-Age (Retry-After in HTTP) option
and <span class="bcp14">SHOULD</span> fall back to link format when receiving 4.15 (Unsupported Content-Format; 415 in HTTP).<a class="pilcrow" href="#section-4-4">Â¶</a></p>
<p id="section-4-5">An RD <span class="bcp14">MAY</span> make the information submitted to it available to further
directories (subject to security policies on link confidentiality)
if it can ensure that a loop does not form.  The protocol used
between directories to ensure loop-free operation is outside the scope of
this document.<a class="pilcrow" href="#section-4-5">Â¶</a></p>
<div id="finding_an_rd">
<section id="section-4.1">
        <h3 id="name-finding-a-resource-director">
<a class="section-number selfRef" href="#section-4.1">4.1. </a><a class="section-name selfRef" href="#name-finding-a-resource-director">Finding a Resource Directory</a>
        </h3>
<p id="section-4.1-1">A (re)starting device may want to find one or more RDs
before it can discover their URIs. Dependent on the operational conditions, one or more of the techniques below apply.<a class="pilcrow" href="#section-4.1-1">Â¶</a></p>
<p id="section-4.1-2">The device may be preconfigured to exercise specific mechanisms for
finding the RD:<a class="pilcrow" href="#section-4.1-2">Â¶</a></p>
<ol class="normal type-1" id="section-4.1-3" start="1" type="1">
          <li id="section-4.1-3.1">It may be configured with a specific IP address for the RD.  That IP
address may also be an anycast address, allowing the network to
forward RD requests to an RD that is topologically close; each
target network environment in which some of these preconfigured
nodes are to be brought up is then configured with a route for this
anycast address that leads to an appropriate RD.  (Instead of using
an anycast address, a multicast address can also be preconfigured.
The RD servers then need to configure one of their
interfaces with this multicast address.)<a class="pilcrow" href="#section-4.1-3.1">Â¶</a>
</li>
          <li id="section-4.1-3.2">It may be configured with a DNS name for the RD and use DNS to return
the IP address of the RD; it can find a DNS server to perform the lookup using the usual mechanisms for finding DNS servers.<a class="pilcrow" href="#section-4.1-3.2">Â¶</a>
</li>
          <li id="section-4.1-3.3">It may be configured to use a service discovery mechanism, such as
DNS-based Service Discovery (DNS-SD), as outlined in <a class="xref" href="#rd-using-dnssd">Section 4.1.2</a>.<a class="pilcrow" href="#section-4.1-3.3">Â¶</a>
</li>
        </ol>
<p id="section-4.1-4">For cases where the device is not specifically configured with a way
to find an RD, the network may want to provide a
suitable default.<a class="pilcrow" href="#section-4.1-4">Â¶</a></p>
<ol class="normal type-1" id="section-4.1-5" start="1" type="1">
          <li id="section-4.1-5.1">The IPv6 Neighbor Discovery option RDAO (<a class="xref" href="#rdao">Section 4.1.1</a>) can do that.<a class="pilcrow" href="#section-4.1-5.1">Â¶</a>
</li>
          <li id="section-4.1-5.2">When DHCP is in use,
this could be provided via a DHCP option (no such option is defined
at the time of writing).<a class="pilcrow" href="#section-4.1-5.2">Â¶</a>
</li>
        </ol>
<p id="section-4.1-6">Finally, if neither the device nor the network offers any specific
configuration, the device may want to employ heuristics to find a
suitable RD.<a class="pilcrow" href="#section-4.1-6">Â¶</a></p>
<p id="section-4.1-7">The present specification does not fully define these heuristics but
suggests a number of candidates:<a class="pilcrow" href="#section-4.1-7">Â¶</a></p>
<ol class="normal type-1" id="section-4.1-8" start="1" type="1">
          <li id="section-4.1-8.1">In a 6LoWPAN, just assume the 6LBR can act as an
RD (using the Authoritative Border Router Option (ABRO) to find that <span>[<a class="xref" href="#RFC6775">RFC6775</a>]</span>).
Confirmation can be obtained by sending a unicast GET to
<code>coap://[6LBR]/.well-known/core?rt=core.rd*</code>.<a class="pilcrow" href="#section-4.1-8.1">Â¶</a>
</li>
          <li id="section-4.1-8.2">In a network that supports multicast well, discover the RD using
a multicast query for <code>/.well-known/core</code>, as specified in CoRE Link
Format <span>[<a class="xref" href="#RFC6690">RFC6690</a>]</span>, and send a Multicast GET to
<code>coap://[ff0x::fe]/.well-known/core?rt=core.rd*</code>.  RDs within the
multicast scope will answer the query.<a class="pilcrow" href="#section-4.1-8.2">Â¶</a>
</li>
        </ol>
<p id="section-4.1-9">When answering a multicast request directed at a link-local group,
  the RD may want to respond from a routable address;
  this makes it easier for registrants to use one of their own routable addresses for registration.
When source addresses are selected using the mechanism described in <span>[<a class="xref" href="#RFC6724">RFC6724</a>]</span>,
this can be achieved by applying the changes of its Section <a class="relref" href="https://www.rfc-editor.org/rfc/rfc6724#section-10.4">10.4</a>,
picking public addresses in Rule 7 of its Section <a class="relref" href="https://www.rfc-editor.org/rfc/rfc6724#section-5">5</a>,
and superseding Rule 8 with preferring the source address's precedence.<a class="pilcrow" href="#section-4.1-9">Â¶</a></p>
<p id="section-4.1-10">As some of the RD addresses obtained by the methods listed here are
just (more or less educated) guesses, endpoints <span class="bcp14">MUST</span> make use of any
error messages to very strictly rate-limit requests to candidate IP
addresses that don't work out.  For example, an ICMP Destination
Unreachable message (and, in particular, the port unreachable code for
this message) may indicate the lack of a CoAP server on the candidate
host, or a CoAP error response code, such as 4.05 (Method Not Allowed),
may indicate unwillingness of a CoAP server to act as a directory
server.<a class="pilcrow" href="#section-4.1-10">Â¶</a></p>
<p id="section-4.1-11">The following RD discovery mechanisms are recommended:<a class="pilcrow" href="#section-4.1-11">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-12.1">In managed networks with border routers that need stand-alone operation, the RDAO is recommended (e.g., the operational phase described in <a class="xref" href="#automation">Section 3.6</a>).<a class="pilcrow" href="#section-4.1-12.1">Â¶</a>
</li>
          <li class="normal" id="section-4.1-12.2">In managed networks without border routers (no Internet services available), the use of a preconfigured anycast address is recommended (e.g., the installation phase described in <a class="xref" href="#automation">Section 3.6</a>).<a class="pilcrow" href="#section-4.1-12.2">Â¶</a>
</li>
          <li class="normal" id="section-4.1-12.3">In networks managed using DNS-SD, the use of DNS-SD for discovery, as described in <a class="xref" href="#rd-using-dnssd">Section 4.1.2</a>, is recommended.<a class="pilcrow" href="#section-4.1-12.3">Â¶</a>
</li>
        </ul>
<p id="section-4.1-13">The use of multicast discovery in mesh networks is <span class="bcp14">NOT RECOMMENDED</span>.<a class="pilcrow" href="#section-4.1-13">Â¶</a></p>
<div id="rdao">
<section id="section-4.1.1">
          <h4 id="name-resource-directory-address-">
<a class="section-number selfRef" href="#section-4.1.1">4.1.1. </a><a class="section-name selfRef" href="#name-resource-directory-address-">Resource Directory Address Option (RDAO)</a>
          </h4>
<p id="section-4.1.1-1">The Resource Directory Address Option (RDAO) carries
information about the address of the RD in RAs (Router Advertisements) of IPv6 Neighbor Discovery (ND),
similar to how Recursive DNS Server (RDNSS) options <span>[<a class="xref" href="#RFC8106">RFC8106</a>]</span> are sent. This information is
needed when endpoints cannot discover the RD with a link-local
or realm-local scope multicast address, for instance, because the
endpoint and the RD are separated by a
6LBR. In many circumstances, the availability of DHCP cannot be guaranteed
during commissioning of the network either. The presence and the use of the RD is
essential during commissioning.<a class="pilcrow" href="#section-4.1.1-1">Â¶</a></p>
<p id="section-4.1.1-2">It is possible to send multiple RDAOs in one message,
indicating as many RD addresses.<a class="pilcrow" href="#section-4.1.1-2">Â¶</a></p>
<p id="section-4.1.1-3">The RDAO format is:<a class="pilcrow" href="#section-4.1.1-3">Â¶</a></p>
<span id="name-resource-directory-address-o"></span><div id="fig-rdao">
<figure id="figure-4">
            <div class="alignLeft art-ascii-art art-text artwork" id="section-4.1.1-4.1">
<pre>0                   1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     Type      |  Length = 3   |          Reserved             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                        Valid Lifetime                         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
+                                                               +
|                                                               |
+                          RD Address                           +
|                                                               |
+                                                               +
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-4">Figure 4</a>:
<a class="selfRef" href="#name-resource-directory-address-o">Resource Directory Address Option</a>
            </figcaption></figure>
</div>
<p id="section-4.1.1-5">Fields:<a class="pilcrow" href="#section-4.1.1-5">Â¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.1.1-6">
            <dt id="section-4.1.1-6.1">Type:</dt>
            <dd id="section-4.1.1-6.2" style="margin-left: 9.0em">41<a class="pilcrow" href="#section-4.1.1-6.2">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.1.1-6.3">Length:</dt>
            <dd id="section-4.1.1-6.4" style="margin-left: 9.0em"> 8-bit unsigned integer.  The length of
            the option in units of 8 bytes.
            Always 3.<a class="pilcrow" href="#section-4.1.1-6.4">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.1.1-6.5">Reserved:</dt>
            <dd id="section-4.1.1-6.6" style="margin-left: 9.0em">This field is unused.  It <span class="bcp14">MUST</span> be
            initialized to zero by the sender and
            <span class="bcp14">MUST</span> be ignored by the receiver.<a class="pilcrow" href="#section-4.1.1-6.6">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.1.1-6.7">Valid Lifetime:</dt>
            <dd id="section-4.1.1-6.8" style="margin-left: 9.0em">32-bit unsigned integer.  The length of
            time in seconds (relative to
            the time the packet is received) that
            this RD address is valid.
            A value of all zero bits (0x0) indicates
            that this RD address
            is not valid anymore.<a class="pilcrow" href="#section-4.1.1-6.8">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.1.1-6.9">RD Address:</dt>
            <dd id="section-4.1.1-6.10" style="margin-left: 9.0em"> IPv6 address of the RD.<a class="pilcrow" href="#section-4.1.1-6.10">Â¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="rd-using-dnssd">
<section id="section-4.1.2">
          <h4 id="name-using-dns-sd-to-discover-a-">
<a class="section-number selfRef" href="#section-4.1.2">4.1.2. </a><a class="section-name selfRef" href="#name-using-dns-sd-to-discover-a-">Using DNS-SD to Discover a Resource Directory</a>
          </h4>
<p id="section-4.1.2-1">An RD can advertise its presence in DNS-SD <span>[<a class="xref" href="#RFC6763">RFC6763</a>]</span>
   using the service names defined in this document: <code>_core-rd._udp</code> (for CoAP), <code>_core-rd-dtls._udp</code>
   (for CoAP over DTLS), <code>_core-rd._tcp</code> (for CoAP over TCP), or
   <code>_core-rd-tls._tcp</code> (for CoAP over TLS).
   (For the WebSocket transports of CoAP, no service is defined,
   as DNS-SD is typically unavailable in environments where CoAP over WebSockets is
   used.)<a class="pilcrow" href="#section-4.1.2-1">Â¶</a></p>
<p id="section-4.1.2-2">The selection of the service indicates the protocol used, and
   the SRV record points the client to a host name and port to use as a starting point for
   the "URI discovery" steps of <a class="xref" href="#discovery">Section 4.3</a>.<a class="pilcrow" href="#section-4.1.2-2">Â¶</a></p>
<p id="section-4.1.2-3">This section is a simplified, concrete application of the more generic mechanism
specified in <span>[<a class="xref" href="#I-D.ietf-core-rd-dns-sd">CORE-RD-DNS-SD</a>]</span>.<a class="pilcrow" href="#section-4.1.2-3">Â¶</a></p>
</section>
</div>
</section>
</div>
<div id="payload-content-formats">
<section id="section-4.2">
        <h3 id="name-payload-content-formats">
<a class="section-number selfRef" href="#section-4.2">4.2. </a><a class="section-name selfRef" href="#name-payload-content-formats">Payload Content Formats</a>
        </h3>
<p id="section-4.2-1">RDs implementing this specification <span class="bcp14">MUST</span> support the
<code>application/link-format</code> content format (ct=40).<a class="pilcrow" href="#section-4.2-1">Â¶</a></p>
<p id="section-4.2-2">RDs implementing this specification <span class="bcp14">MAY</span> support additional content formats.<a class="pilcrow" href="#section-4.2-2">Â¶</a></p>
<p id="section-4.2-3">Any additional content format supported by an RD implementing this
specification <span class="bcp14">SHOULD</span> be able to express all the information expressible in link format.
It <span class="bcp14">MAY</span> be able to express information that is inexpressible in link format,
but those expressions <span class="bcp14">SHOULD</span> be avoided where possible.<a class="pilcrow" href="#section-4.2-3">Â¶</a></p>
</section>
</div>
<div id="discovery">
<section id="section-4.3">
        <h3 id="name-uri-discovery">
<a class="section-number selfRef" href="#section-4.3">4.3. </a><a class="section-name selfRef" href="#name-uri-discovery">URI Discovery</a>
        </h3>
<p id="section-4.3-1">Before an endpoint can make use of an RD, it must first know the RD's address
and port and the URI path information for its REST APIs. This section defines
discovery of the RD and its URIs using the well-known interface of the
CoRE Link Format <span>[<a class="xref" href="#RFC6690">RFC6690</a>]</span> after having discovered a host, as described in <a class="xref" href="#finding_an_rd">Section 4.1</a>.<a class="pilcrow" href="#section-4.3-1">Â¶</a></p>
<p id="section-4.3-2">Discovery of the RD registration URI is performed by sending either a multicast or
unicast GET request to <code>/.well-known/core</code> and including a resource type (rt)
parameter <span>[<a class="xref" href="#RFC6690">RFC6690</a>]</span> with the value "core.rd" in the query string. Likewise, a
resource type parameter value of "core.rd-lookup*" is used to discover the
URIs for RD lookup operations, and "core.rd*" is used to discover all URIs for RD operations.
Upon success, the response will contain a payload with
a link format entry for each RD function discovered, indicating the URI
of the RD function returned and the corresponding resource type. When performing
multicast discovery, the multicast IP address used will depend on the scope required
and the multicast capabilities of the network (see <a class="xref" href="#mc-registration">Section 9.5</a>).<a class="pilcrow" href="#section-4.3-2">Â¶</a></p>
<p id="section-4.3-3">An RD <span class="bcp14">MAY</span> provide hints about the content formats it supports in the links it exposes or registers, using the "ct" target attribute, as shown in the example below. Clients <span class="bcp14">MAY</span> use these hints to select alternate content formats for interaction with the RD.<a class="pilcrow" href="#section-4.3-3">Â¶</a></p>
<p id="section-4.3-4">HTTP does not support multicast, and, consequently, only unicast discovery can be
 supported using the HTTP <code>/.well-known/core</code> resource.<a class="pilcrow" href="#section-4.3-4">Â¶</a></p>
<p id="section-4.3-5">RDs implementing this specification <span class="bcp14">MUST</span> support query filtering for
the rt parameter, as defined in <span>[<a class="xref" href="#RFC6690">RFC6690</a>]</span>.<a class="pilcrow" href="#section-4.3-5">Â¶</a></p>
<p id="section-4.3-6">While the link targets in this discovery step are often expressed in path-absolute form,
this is not a requirement.
Clients of the RD <span class="bcp14">SHOULD</span> therefore accept URIs of all schemes they support,
both as URIs and relative references,
and not limit the set of discovered URIs to those hosted at the address used for URI discovery.<a class="pilcrow" href="#section-4.3-6">Â¶</a></p>
<p id="section-4.3-7">With security policies where the client requires the RD to be authorized to act as an RD,
that authorization may be limited to resources on which the authorized RD advertises the adequate resource types.
Clients that have obtained links they cannot rely on yet
can repeat the "URI discovery" step at the <code>/.well-known/core</code> resource of the indicated host
to obtain the resource type information from an authorized source.<a class="pilcrow" href="#section-4.3-7">Â¶</a></p>
<p id="section-4.3-8">The URI discovery operation can yield multiple URIs of a given resource type.
The client of the RD can try out any of the discovered addresses.<a class="pilcrow" href="#section-4.3-8">Â¶</a></p>
<p id="section-4.3-9">The discovery request interface is specified as follows
(this is exactly the well-known interface of <span>[<a class="xref" href="#RFC6690">RFC6690</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc6690#section-4">Section 4</a></span>,
 with the additional requirement that the server <span class="bcp14">MUST</span> support query filtering):<a class="pilcrow" href="#section-4.3-9">Â¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.3-10">
          <dt id="section-4.3-10.1">Interaction:</dt>
          <dd id="section-4.3-10.2" style="margin-left: 1.5em"> EP, CT, or Client -&gt; RD<a class="pilcrow" href="#section-4.3-10.2">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.3-10.3">Method:</dt>
          <dd id="section-4.3-10.4" style="margin-left: 1.5em">GET<a class="pilcrow" href="#section-4.3-10.4">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.3-10.5">URI Template:</dt>
          <dd id="section-4.3-10.6" style="margin-left: 1.5em">
            <code>/.well-known/core{?rt}</code><a class="pilcrow" href="#section-4.3-10.6">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.3-10.7">URI Template Variables:</dt>
          <dd id="section-4.3-10.8" style="margin-left: 1.5em">
            <p id="section-4.3-10.8.1"><br/></p>
<span class="break"></span><dl class="dlParallel" id="section-4.3-10.8.2">
              <dt id="section-4.3-10.8.2.1">rt := </dt>
              <dd id="section-4.3-10.8.2.2" style="margin-left: 1.5em">Resource Type. <span class="bcp14">SHOULD</span> contain one of the values "core.rd",                                 
        "core.rd-lookup*",                                                                                            
        "core.rd-lookup-res", "core.rd-lookup-ep", or "core.rd*"<a class="pilcrow" href="#section-4.3-10.8.2.2">Â¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</dd>
          <dd class="break"></dd>
<dt id="section-4.3-10.9">Accept:</dt>
          <dd id="section-4.3-10.10" style="margin-left: 1.5em">absent, <code>application/link-format</code>, or any other media type representing web links<a class="pilcrow" href="#section-4.3-10.10">Â¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.3-11">The following response is expected on this interface:<a class="pilcrow" href="#section-4.3-11">Â¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.3-12">
          <dt id="section-4.3-12.1">Success:</dt>
          <dd id="section-4.3-12.2" style="margin-left: 1.5em">2.05 (Content) or 200 (OK) with an
  <code>application/link-format</code> or other web link payload containing one or more matching entries for the RD resource.<a class="pilcrow" href="#section-4.3-12.2">Â¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.3-13">The following example shows an endpoint discovering an RD using this interface,
thus learning that the directory resource location in this example is /rd and that the
content format delivered by the server hosting the resource is <code>application/link-format</code>
 (ct=40).  Note that it is up to the RD to choose its RD locations.<a class="pilcrow" href="#section-4.3-13">Â¶</a></p>
<span id="name-example-discovery-exchange"></span><div id="example-discovery">
<figure id="figure-5">
          <div id="section-4.3-14.1">
<pre class="sourcecode">Req: GET coap://[ff02::fe]/.well-known/core?rt=core.rd*

Res: 2.05 Content
Payload:
&lt;/rd&gt;;rt=core.rd;ct=40,
&lt;/rd-lookup/ep&gt;;rt=core.rd-lookup-ep;ct=40,
&lt;/rd-lookup/res&gt;;rt=core.rd-lookup-res;ct=40
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-5">Figure 5</a>:
<a class="selfRef" href="#name-example-discovery-exchange">Example Discovery Exchange</a>
          </figcaption></figure>
</div>
<p id="section-4.3-15">The following example shows the way of indicating that a client may request
 alternate content formats. The Content-Format code attribute "ct" <span class="bcp14">MAY</span>
 include a space-separated sequence of Content-Format codes, as specified in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc7252#section-7.2.1">Section 7.2.1</a> of [<a class="xref" href="#RFC7252">RFC7252</a>]</span>, indicating that multiple
 content formats are available. The example below shows the required Content-Format 40
 (<code>application/link-format</code>) indicated, as well as Concise Binary Object Representation (CBOR)
 and JSON representations in the style of <span>[<a class="xref" href="#I-D.ietf-core-links-json">CORE-LINKS-JSON</a>]</span>
 (for which the experimental values 65060 and 65050 are used in this example). The RD resource locations /rd
 and /rd-lookup are example values. The server in this example also indicates that
 it is capable of providing observation on resource lookups.<a class="pilcrow" href="#section-4.3-15">Â¶</a></p>
<span id="name-example-discovery-exchange-"></span><div id="example-discovery-ct">
<figure id="figure-6">
          <div id="section-4.3-16.1">
<pre class="sourcecode">Req: GET coap://[ff02::fe]/.well-known/core?rt=core.rd*

Res: 2.05 Content
Payload:
&lt;/rd&gt;;rt=core.rd;ct=40,
&lt;/rd-lookup/res&gt;;rt=core.rd-lookup-res;ct="40 65060 65050";obs,
&lt;/rd-lookup/ep&gt;;rt=core.rd-lookup-ep;ct="40 65060 65050"
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-6">Figure 6</a>:
<a class="selfRef" href="#name-example-discovery-exchange-">Example Discovery Exchange Indicating Additional Content-Formats</a>
          </figcaption></figure>
</div>
<p id="section-4.3-17">For maintenance, management, and debugging,
it can be useful to identify the components that constitute the RD server.
The identification can be used to find client-server incompatibilities,
supported features, required updates, and other aspects.
The well-known interface described in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc6690#section-4">Section 4</a> of [<a class="xref" href="#RFC6690">RFC6690</a>]</span> can be used to find such data.<a class="pilcrow" href="#section-4.3-17">Â¶</a></p>
<p id="section-4.3-18">It would typically be stored in an implementation information link
(as described in <span>[<a class="xref" href="#I-D.bormann-t2trg-rel-impl">T2TRG-REL-IMPL</a>]</span>).<a class="pilcrow" href="#section-4.3-18">Â¶</a></p>
<span id="name-example-exchange-of-obtaini"></span><div id="example-impl-discovery">
<figure id="figure-7">
          <div id="section-4.3-19.1">
<pre class="sourcecode">Req: GET /.well-known/core?rel=impl-info

Res: 2.05 Content
Payload:
&lt;http://software.example.com/shiny-resource-directory/1.0beta1&gt;;
    rel=impl-info
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-7">Figure 7</a>:
<a class="selfRef" href="#name-example-exchange-of-obtaini">Example Exchange of Obtaining Implementation Information Using the Relation Type Currently Proposed in <em class="xref">[T2TRG-REL-IMPL]</em></a>
          </figcaption></figure>
</div>
<p id="section-4.3-20">Note that, depending on the particular server's architecture,
such a link could be anchored at the RD server's root
(as in this example) or
at individual RD components.
The latter is to be expected when different applications
are run on the same server.<a class="pilcrow" href="#section-4.3-20">Â¶</a></p>
</section>
</div>
</section>
</div>
<div id="registration">
<section id="section-5">
      <h2 id="name-registration">
<a class="section-number selfRef" href="#section-5">5. </a><a class="section-name selfRef" href="#name-registration">Registration</a>
      </h2>
<p id="section-5-1">After discovering the location of an RD, a registrant-EP or CT <span class="bcp14">MAY</span>
register the resources of the registrant-EP using the registration interface. This interface
accepts a POST from an endpoint containing the list of resources to be added
to the directory as the message payload in the CoRE Link Format <span>[<a class="xref" href="#RFC6690">RFC6690</a>]</span> or other representations of web links, along with query
parameters indicating the name of the endpoint and, optionally, the sector,
lifetime, and base URI of the registration.
It is expected that other specifications will define further parameters (see
<a class="xref" href="#iana-registry">Section 9.3</a>). The RD then creates a new registration resource in the RD and returns its location. The receiving endpoint <span class="bcp14">MUST</span> use that
location when refreshing registrations using this interface. Registration
resources in the RD are kept active for the period indicated by the lifetime
parameter. The creating endpoint is responsible for refreshing the registration resource within this
period, using either the registration or update interface. The registration
interface <span class="bcp14">MUST</span> be implemented to be idempotent, so that registering twice
with the same endpoint parameters ep and d (sector) does not create multiple registration resources.<a class="pilcrow" href="#section-5-1">Â¶</a></p>
<p id="section-5-2">The following rules apply for a registration request targeting a given (ep, d) value pair:<a class="pilcrow" href="#section-5-2">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-3.1">When the (ep, d) value pair of the registration request is different from any existing registration,
a new registration is generated.<a class="pilcrow" href="#section-5-3.1">Â¶</a>
</li>
        <li class="normal" id="section-5-3.2">When the (ep, d) value pair of the registration request is equal to an existing registration,
the content and parameters of the existing registration are replaced with the content of the registration request.
As with changes to registration resources, security policies (<a class="xref" href="#policies">Section 7</a>) usually require such requests to come from the same device.<a class="pilcrow" href="#section-5-3.2">Â¶</a>
</li>
      </ul>
<p id="section-5-4">The posted link-format document can (and typically does) contain relative references
both in its link targets and in its anchors; it can also contain empty anchors.
The RD server needs to resolve these references in order to faithfully represent them in lookups.
They are resolved against the base URI of the registration,
which is provided either explicitly in the <code>base</code> parameter or constructed implicitly from the requester's URI, as constructed from its network address and scheme.<a class="pilcrow" href="#section-5-4">Â¶</a></p>
<p id="section-5-5">For media types to which <a class="xref" href="#limitedlinkformat">Appendix C</a> applies
(i.e., documents in <code>application/link-format</code>),
request bodies <span class="bcp14">MUST</span> be expressed in Limited Link Format.<a class="pilcrow" href="#section-5-5">Â¶</a></p>
<p id="section-5-6">The registration request interface is specified as follows:<a class="pilcrow" href="#section-5-6">Â¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5-7">
        <dt id="section-5-7.1">Interaction:</dt>
        <dd id="section-5-7.2" style="margin-left: 1.5em">EP or CT -&gt; RD<a class="pilcrow" href="#section-5-7.2">Â¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-5-7.3">Method:</dt>
        <dd id="section-5-7.4" style="margin-left: 1.5em">POST<a class="pilcrow" href="#section-5-7.4">Â¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-5-7.5">URI Template:</dt>
        <dd id="section-5-7.6" style="margin-left: 1.5em">{+rd}{?ep,d,lt,base,extra-attrs*}<a class="pilcrow" href="#section-5-7.6">Â¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-5-7.7">URI Template Variables:</dt>
        <dd id="section-5-7.8" style="margin-left: 1.5em">
          <p id="section-5-7.8.1"><br/></p>
<span class="break"></span><dl class="dlParallel" id="section-5-7.8.2">
            <dt id="section-5-7.8.2.1">rd :=</dt>
            <dd id="section-5-7.8.2.2" style="margin-left: 1.5em">RD registration URI
     (mandatory). This is the location of
     the RD, as obtained from discovery.<a class="pilcrow" href="#section-5-7.8.2.2">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5-7.8.2.3">ep :=</dt>
            <dd id="section-5-7.8.2.4" style="margin-left: 1.5em">
              <p id="section-5-7.8.2.4.1">Endpoint name (mostly mandatory). The endpoint name is an identifier
     that <span class="bcp14">MUST</span> be unique within a sector.<a class="pilcrow" href="#section-5-7.8.2.4.1">Â¶</a></p>
<p id="section-5-7.8.2.4.2">As the endpoint name is a Unicode string, it is
            encoded in UTF-8 (and possibly percent encoded) during
            variable expansion (see <span>[<a class="xref" href="#RFC6570">RFC6570</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc6570#section-3.2.1">Section 3.2.1</a></span>).  The endpoint name <span class="bcp14">MUST NOT</span> contain any
     character in the inclusive ranges 0-31 or 127-159.<a class="pilcrow" href="#section-5-7.8.2.4.2">Â¶</a></p>
<p id="section-5-7.8.2.4.3">The maximum length of this parameter is 63 bytes encoded in UTF-8.<a class="pilcrow" href="#section-5-7.8.2.4.3">Â¶</a></p>
<p id="section-5-7.8.2.4.4">If the RD is configured to recognize the endpoint that is to be authorized to use
     exactly
     one endpoint name, the RD assigns that name. In that case, giving the endpoint name
     becomes optional for the client; if the client gives any other endpoint name, it is
     not authorized to perform the registration.<a class="pilcrow" href="#section-5-7.8.2.4.4">Â¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-5-7.8.2.5">d :=</dt>
            <dd id="section-5-7.8.2.6" style="margin-left: 1.5em">
              <p id="section-5-7.8.2.6.1">Sector (optional). This is the sector to which this endpoint belongs.
     When this parameter is not present, the
     RD <span class="bcp14">MAY</span> associate the endpoint with a configured default sector
     (possibly based on the endpoint's authorization)
     or leave it empty.<a class="pilcrow" href="#section-5-7.8.2.6.1">Â¶</a></p>
<p id="section-5-7.8.2.6.2">The sector is encoded like the ep parameter and is limited to 63 bytes encoded in
     UTF-8 as well.<a class="pilcrow" href="#section-5-7.8.2.6.2">Â¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-5-7.8.2.7">lt := </dt>
            <dd id="section-5-7.8.2.8" style="margin-left: 1.5em">Lifetime (optional). This is the lifetime of the registration in seconds, with a
     range of 1-4294967295.
     If no lifetime is included in the initial registration, a default value of
     90000 (25 hours) <span class="bcp14">SHOULD</span> be assumed.<a class="pilcrow" href="#section-5-7.8.2.8">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5-7.8.2.9">base :=</dt>
            <dd id="section-5-7.8.2.10" style="margin-left: 1.5em">
              <p id="section-5-7.8.2.10.1">Base URI (optional). This parameter sets the base URI of the registration, under
       which the relative links in the payload are to be interpreted. The specified URI
       typically does not have a path component of its own and <span class="bcp14">MUST</span> be
       suitable as a base URI to resolve any relative references given in the registration.
       The parameter is therefore usually of the shape "scheme://authority" for
       HTTP and CoAP URIs.
       The URI <span class="bcp14">SHOULD NOT</span> have a query or fragment component,
       as any non-empty relative part in a reference would remove those parts from the
       resulting URI.<a class="pilcrow" href="#section-5-7.8.2.10.1">Â¶</a></p>
<p id="section-5-7.8.2.10.2">In the absence of this parameter, the scheme of the protocol, the source address,
       and the source port of the registration request are assumed.
       The base URI is consecutively constructed by concatenating the used protocol's scheme
       with the characters "://", the requester's source address as an address literal,
       and ":" followed by its port (if it was not the protocol's default
       one). This is analogous to the process described in <span>[<a class="xref" href="#RFC7252">RFC7252</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc7252#section-6.5">Section 6.5</a></span>.<a class="pilcrow" href="#section-5-7.8.2.10.2">Â¶</a></p>
<p id="section-5-7.8.2.10.3">This parameter is
       mandatory when the directory is filled by a third party, such as a
       commissioning tool.<a class="pilcrow" href="#section-5-7.8.2.10.3">Â¶</a></p>
<p id="section-5-7.8.2.10.4">If the registrant-EP uses an ephemeral port to register with, it
       <span class="bcp14">MUST</span> include the base
       parameter in the registration to provide a valid network path.<a class="pilcrow" href="#section-5-7.8.2.10.4">Â¶</a></p>
<p id="section-5-7.8.2.10.5">A registrant that cannot be reached by potential lookup clients at the address it
       registers from
       (e.g., because it is behind some form of Network Address Translation (NAT))
       <span class="bcp14">MUST</span> provide a reachable base address with its registration.<a class="pilcrow" href="#section-5-7.8.2.10.5">Â¶</a></p>
<p id="section-5-7.8.2.10.6">If the base URI contains a link-local IP literal, it <span class="bcp14">MUST NOT</span>
       contain a Zone Identifier
       and <span class="bcp14">MUST</span> be local to the link on which the registration request is
       received.<a class="pilcrow" href="#section-5-7.8.2.10.6">Â¶</a></p>
<p id="section-5-7.8.2.10.7">Endpoints that register with a base that contains a path component
       cannot efficiently express their registrations in Limited Link Format (<a class="xref" href="#limitedlinkformat">Appendix C</a>).
       Those applications should use different representations of links to which <a class="xref" href="#limitedlinkformat">Appendix C</a> is not applicable
       (e.g., <span>[<a class="xref" href="#I-D.ietf-core-coral">CORE-CORAL</a>]</span>).<a class="pilcrow" href="#section-5-7.8.2.10.7">Â¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-5-7.8.2.11">extra-attrs :=</dt>
            <dd id="section-5-7.8.2.12" style="margin-left: 1.5em">Additional registration attributes (optional). The endpoint can pass any
       parameter registered in <a class="xref" href="#iana-registry">Section 9.3</a> to the
       directory. If the RD is
       aware of the parameter's specified semantics, it processes the parameter accordingly.
       Otherwise, it <span class="bcp14">MUST</span> store the unknown key and its value(s) as an
       endpoint attribute for further lookup.<a class="pilcrow" href="#section-5-7.8.2.12">Â¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</dd>
        <dd class="break"></dd>
<dt id="section-5-7.9">Content-Format:</dt>
        <dd id="section-5-7.10" style="margin-left: 1.5em">
          <code>application/link-format</code> or any other indicated media type representing web links<a class="pilcrow" href="#section-5-7.10">Â¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-5-8">The following response is expected on this interface:<a class="pilcrow" href="#section-5-8">Â¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5-9">
        <dt id="section-5-9.1">Success:</dt>
        <dd id="section-5-9.2" style="margin-left: 1.5em">
          <p id="section-5-9.2.1">2.01 (Created) or 201 (Created). The Location-Path option or Location header
     field <span class="bcp14">MUST</span> be included in the response. This location
     <span class="bcp14">MUST</span> be a stable identifier generated by the RD, as it is used
     for all subsequent operations on this registration resource. The registration
     resource location thus returned is for the purpose of updating the lifetime
     of the registration and for maintaining the content of the
     registered links, including updating and deleting links.<a class="pilcrow" href="#section-5-9.2.1">Â¶</a></p>
<p id="section-5-9.2.2">A registration with an already-registered ep and d value pair
     responds with the same success code and location as the original registration;
     the set of links registered with the endpoint is replaced with the links
     from the payload.<a class="pilcrow" href="#section-5-9.2.2">Â¶</a></p>
<p id="section-5-9.2.3">The location <span class="bcp14">MUST NOT</span> have a query or fragment component,
     as that could conflict with query parameters during the registration update
     operation. Therefore, the Location-Query option <span class="bcp14">MUST NOT</span> be
     present in a successful response.<a class="pilcrow" href="#section-5-9.2.3">Â¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-5-10">If the registration fails, including request timeouts,
     or if delays from Service Unavailable responses with Max-Age or Retry-After
     accumulate to exceed the registrant's configured timeouts,
     it <span class="bcp14">SHOULD</span> pick another registration URI from the "URI discovery" step of <a class="xref" href="#discovery">Section 4.3</a>,
     and, if there is only one or the list is exhausted,
     pick other choices from the "finding a  resource directory" step of <a class="xref" href="#finding_an_rd">Section 4.1</a>.
     Care has to be taken to consider the freshness of results obtained earlier,
     e.g., the result of a <code>/.well-known/core</code> response,
     the lifetime of an RDAO, and DNS responses.
     Any rate limits and persistent errors from the "finding a resource directory" step
     must be considered for the whole registration time,
     not only for a single operation.<a class="pilcrow" href="#section-5-10">Â¶</a></p>
<p id="section-5-11">The following example shows a registrant-EP with the name "node1" registering
     two resources to an RD using this interface. The location "/rd"
     is an example RD location discovered in a request similar to <a class="xref" href="#example-discovery">Figure 5</a>.<a class="pilcrow" href="#section-5-11">Â¶</a></p>
<span id="name-example-registration-payloa"></span><div id="example-payload">
<figure id="figure-8">
        <div id="section-5-12.1">
<pre class="sourcecode">Req: POST coap://rd.example.com/rd?ep=node1
Content-Format: 40
Payload:
&lt;/sensors/temp&gt;;rt=temperature-c;if=sensor,
&lt;http://www.example.com/sensors/temp&gt;;
  anchor="/sensors/temp";rel=describedby

Res: 2.01 Created
Location-Path: /rd/4521
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-8">Figure 8</a>:
<a class="selfRef" href="#name-example-registration-payloa">Example Registration Payload</a>
        </figcaption></figure>
</div>
<p id="section-5-13">An RD may optionally support HTTP. Here is an example of almost the same registration operation above when done using HTTP.<a class="pilcrow" href="#section-5-13">Â¶</a></p>
<span id="name-example-registration-payload"></span><div id="example-payload-http">
<figure id="figure-9">
        <div id="section-5-14.1">
<pre class="sourcecode">Req:
POST /rd?ep=node1&amp;base=http://[2001:db8:1::1] HTTP/1.1
Host: rd.example.com
Content-Type: application/link-format

&lt;/sensors/temp&gt;;rt=temperature-c;if=sensor,
&lt;http://www.example.com/sensors/temp&gt;;
  anchor="/sensors/temp";rel=describedby

Res:
HTTP/1.1 201 Created
Location: /rd/4521
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-9">Figure 9</a>:
<a class="selfRef" href="#name-example-registration-payload">Example Registration Payload as Expressed Using HTTP</a>
        </figcaption></figure>
</div>
<div id="simple">
<section id="section-5.1">
        <h3 id="name-simple-registration">
<a class="section-number selfRef" href="#section-5.1">5.1. </a><a class="section-name selfRef" href="#name-simple-registration">Simple Registration</a>
        </h3>
<p id="section-5.1-1">Not all endpoints hosting resources are expected to know how to upload links to an RD, as described in <a class="xref" href="#registration">Section 5</a>. Instead, simple endpoints can implement the simple registration approach described in this section. An RD implementing this specification <span class="bcp14">MUST</span> implement simple registration. However, there may
be security reasons why this form of directory discovery would be disabled.<a class="pilcrow" href="#section-5.1-1">Â¶</a></p>
<p id="section-5.1-2">This approach requires that the registrant-EP makes available the hosted resources
that it wants to be discovered as links on its <code>/.well-known/core</code> interface, as
specified in <span>[<a class="xref" href="#RFC6690">RFC6690</a>]</span>.
The links in that document are subject to the same limitations as the payload of a registration
(with respect to <a class="xref" href="#limitedlinkformat">Appendix C</a>).<a class="pilcrow" href="#section-5.1-2">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1-3.1">The registrant-EP finds one or more addresses of the directory server, as described in <a class="xref" href="#finding_an_rd">Section 4.1</a>.<a class="pilcrow" href="#section-5.1-3.1">Â¶</a>
</li>
          <li class="normal" id="section-5.1-3.2">
            <p id="section-5.1-3.2.1">The registrant-EP sends (and regularly refreshes with) a POST
     request to the <code>/.well-known/rd</code> URI of the directory server of choice. The
     body of the POST request is empty and triggers the resource
     directory server to perform GET requests (redone before lifetime expiry) at the requesting registrant-EP's
     <code>/.well-known/core</code> to obtain the link-format payload to register.<a class="pilcrow" href="#section-5.1-3.2.1">Â¶</a></p>
<p id="section-5.1-3.2.2">The registrant-EP includes the same registration parameters in the POST request as
     it would with a regular registration, per <a class="xref" href="#registration">Section 5</a>. The registration base URI of the registration is taken from the
     registrant-EP's network address (as is default with regular registrations).<a class="pilcrow" href="#section-5.1-3.2.2">Â¶</a></p>
<p id="section-5.1-3.2.3">The following is an example request from the registrant-EP to the RD (unanswered
     until the next step):<a class="pilcrow" href="#section-5.1-3.2.3">Â¶</a></p>
<span id="name-first-half-example-exchange"></span><div id="example-simple1">
<figure id="figure-10">
              <div id="section-5.1-3.2.4.1">
<pre class="sourcecode">Req: POST /.well-known/rd?lt=6000&amp;ep=node1
(No payload)
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-10">Figure 10</a>:
<a class="selfRef" href="#name-first-half-example-exchange">First-Half Example Exchange of a Simple Registration</a>
              </figcaption></figure>
</div>
</li>
          <li class="normal" id="section-5.1-3.3">
            <p id="section-5.1-3.3.1">The RD queries the registrant-EP's discovery resource to determine the success of
     the operation. It <span class="bcp14">SHOULD</span> keep a cache of the discovery resource and not
     query it again as long as it is fresh.<a class="pilcrow" href="#section-5.1-3.3.1">Â¶</a></p>
<p id="section-5.1-3.3.2">The following is an example request from the RD to the registrant-EP:<a class="pilcrow" href="#section-5.1-3.3.2">Â¶</a></p>
<span id="name-example-exchange-of-the-rd-"></span><div id="example-simple2">
<figure id="figure-11">
              <div id="section-5.1-3.3.3.1">
<pre class="sourcecode">Req: GET /.well-known/core
Accept: 40

Res: 2.05 Content
Content-Format: 40
Payload:
&lt;/sen/temp&gt;
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-11">Figure 11</a>:
<a class="selfRef" href="#name-example-exchange-of-the-rd-">Example Exchange of the RD Querying the Simple Endpoint</a>
              </figcaption></figure>
</div>
</li>
        </ul>
<p id="section-5.1-4">With this response, the RD would answer the previous step's request:<a class="pilcrow" href="#section-5.1-4">Â¶</a></p>
<span id="name-second-half-example-exchang"></span><div id="example-simple3">
<figure id="figure-12">
          <div id="section-5.1-5.1">
<pre class="sourcecode">Res: 2.04 Changed
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-12">Figure 12</a>:
<a class="selfRef" href="#name-second-half-example-exchang">Second-Half Example Exchange of a Simple Registration</a>
          </figcaption></figure>
</div>
<p id="section-5.1-6">The sequence of fetching the registration content before sending a successful response
was chosen to make responses reliable,
and the point about caching was chosen to still allow very constrained registrants.
Registrants <span class="bcp14">MUST</span> be able to serve a GET request to <code>/.well-known/core</code> after having requested registration.
Constrained devices <span class="bcp14">MAY</span> regard the initial request as temporarily failed when they need RAM occupied by their own request to serve the RD's GET
and retry later when the RD already has a cached representation of their discovery resources.
Then, the RD can reply immediately, and the registrant can receive the response.<a class="pilcrow" href="#section-5.1-6">Â¶</a></p>
<p id="section-5.1-7">The simple registration request interface is specified as follows:<a class="pilcrow" href="#section-5.1-7">Â¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.1-8">
          <dt id="section-5.1-8.1">Interaction:</dt>
          <dd id="section-5.1-8.2" style="margin-left: 1.5em">EP -&gt; RD<a class="pilcrow" href="#section-5.1-8.2">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-8.3">Method:  </dt>
          <dd id="section-5.1-8.4" style="margin-left: 1.5em">POST<a class="pilcrow" href="#section-5.1-8.4">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-8.5">URI Template:  </dt>
          <dd id="section-5.1-8.6" style="margin-left: 1.5em">
            <code>/.well-known/rd{?ep,d,lt,extra-attrs*}</code><a class="pilcrow" href="#section-5.1-8.6">Â¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-5.1-9">URI Template Variables are the same as for registration in <a class="xref" href="#registration">Section 5</a>.
The base attribute is not accepted to keep the registration interface simple;
that rules out registration over CoAP-over-TCP or HTTP that would need to specify one.
For some time during this document's development, the URI Template <code>/.well-known/core{?ep,...}</code> was in use instead.<a class="pilcrow" href="#section-5.1-9">Â¶</a></p>
<p id="section-5.1-10">The following response is expected on this interface:<a class="pilcrow" href="#section-5.1-10">Â¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.1-11">
          <dt id="section-5.1-11.1">Success:</dt>
          <dd id="section-5.1-11.2" style="margin-left: 1.5em">2.04 (Changed)<a class="pilcrow" href="#section-5.1-11.2">Â¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-5.1-12">For the second interaction triggered by the above, the
        registrant-EP takes the role of server and the RD takes the role of
        client.  (Note that this is exactly the well-known interface
        of <span>[<a class="xref" href="#RFC6690">RFC6690</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc6690#section-4">Section 4</a></span>):<a class="pilcrow" href="#section-5.1-12">Â¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.1-13">
          <dt id="section-5.1-13.1">Interaction:</dt>
          <dd id="section-5.1-13.2" style="margin-left: 1.5em">RD -&gt; EP<a class="pilcrow" href="#section-5.1-13.2">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-13.3">Method:</dt>
          <dd id="section-5.1-13.4" style="margin-left: 1.5em">GET<a class="pilcrow" href="#section-5.1-13.4">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-13.5">URI Template:</dt>
          <dd id="section-5.1-13.6" style="margin-left: 1.5em">
            <code>/.well-known/core</code><a class="pilcrow" href="#section-5.1-13.6">Â¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-5.1-14">The following response is expected on this interface:<a class="pilcrow" href="#section-5.1-14">Â¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.1-15">
          <dt id="section-5.1-15.1">Success:</dt>
          <dd id="section-5.1-15.2" style="margin-left: 1.5em">2.05 (Content)<a class="pilcrow" href="#section-5.1-15.2">Â¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-5.1-16">When the RD uses any authorization credentials to access the endpoint's discovery
 resource or when it is deployed in a location where third parties might reach it but not
 the endpoint, it <span class="bcp14">SHOULD</span> verify that the apparent registrant-EP intends to
 register with the given registration parameters
 before revealing the obtained discovery information to lookup clients.
 An easy way to do that is to verify the simple registration request's sender address using
 the Echo option, as described in <span>[<a class="xref" href="#RFC9175">RFC9175</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc9175#section-2.4">Section 2.4</a></span>.<a class="pilcrow" href="#section-5.1-16">Â¶</a></p>
<p id="section-5.1-17">The RD <span class="bcp14">MUST</span> delete registrations created by simple registration after the expiration of their lifetime. Additional operations on the registration resource cannot be executed because no registration location is returned.<a class="pilcrow" href="#section-5.1-17">Â¶</a></p>
</section>
</div>
<div id="third-party-registration">
<section id="section-5.2">
        <h3 id="name-third-party-registration">
<a class="section-number selfRef" href="#section-5.2">5.2. </a><a class="section-name selfRef" href="#name-third-party-registration">Third-Party Registration</a>
        </h3>
<p id="section-5.2-1">For some applications, even simple registration may be too taxing
for some very constrained devices, in particular, if the security requirements
become too onerous.<a class="pilcrow" href="#section-5.2-1">Â¶</a></p>
<p id="section-5.2-2">In a controlled environment (e.g., building control), the RD
can be filled by a third-party device, called a Commissioning Tool (CT). The CT can fill the RD from a database or other means. For
that purpose scheme, the IP address and port of the URI of the registered device is
 the value of the "base" parameter of the registration described in <a class="xref" href="#registration">Section 5</a>.<a class="pilcrow" href="#section-5.2-2">Â¶</a></p>
<p id="section-5.2-3">It should be noted that the value of the "base" parameter applies to all the links of the registration and has consequences for the anchor value of the individual links, as exemplified in <a class="xref" href="#weblink">Appendix B</a>.  A potential (currently nonexistent) "base" attribute of the link is not affected by the value of "base" parameter in the registration.<a class="pilcrow" href="#section-5.2-3">Â¶</a></p>
</section>
</div>
<div id="operations-on-the-registration-resource">
<section id="section-5.3">
        <h3 id="name-operations-on-the-registrat">
<a class="section-number selfRef" href="#section-5.3">5.3. </a><a class="section-name selfRef" href="#name-operations-on-the-registrat">Operations on the Registration Resource</a>
        </h3>
<p id="section-5.3-1">This section describes how the registering endpoint can maintain the registrations that it created. The registering endpoint can be the registrant-EP or the CT. The registrations are resources of the RD.<a class="pilcrow" href="#section-5.3-1">Â¶</a></p>
<p id="section-5.3-2">An endpoint should not use this interface for registrations that it did not create.
 This is usually enforced by security policies,
 which, in general, require equivalent credentials for creation of and operations on a
 registration.<a class="pilcrow" href="#section-5.3-2">Â¶</a></p>
<p id="section-5.3-3">After the initial registration, the registering endpoint retains the returned location of the registration resource for further operations, including refreshing the registration in order to extend the lifetime and "keep-alive" the registration. When the lifetime of the registration has expired, the RD <span class="bcp14">SHOULD NOT</span> respond to discovery queries concerning this endpoint. The RD <span class="bcp14">SHOULD</span> continue to provide access to the registration resource after a registration timeout occurs in order to enable the registering endpoint to eventually refresh the registration. The RD <span class="bcp14">MAY</span> eventually remove the registration resource for the purpose of garbage collection. If the registration resource is removed, the corresponding endpoint will need to be reregistered.<a class="pilcrow" href="#section-5.3-3">Â¶</a></p>
<p id="section-5.3-4">The registration resource may also be used to cancel the registration using DELETE and to perform further operations beyond the scope of this specification.<a class="pilcrow" href="#section-5.3-4">Â¶</a></p>
<p id="section-5.3-5">Operations on the registration resource are sensitive to reordering;
<a class="xref" href="#freshness">Section 5.3.4</a> describes how order is restored.<a class="pilcrow" href="#section-5.3-5">Â¶</a></p>
<p id="section-5.3-6">The operations on the registration resource are described below.<a class="pilcrow" href="#section-5.3-6">Â¶</a></p>
<div id="update">
<section id="section-5.3.1">
          <h4 id="name-registration-update">
<a class="section-number selfRef" href="#section-5.3.1">5.3.1. </a><a class="section-name selfRef" href="#name-registration-update">Registration Update</a>
          </h4>
<p id="section-5.3.1-1">The update interface is used by the registering endpoint to refresh or update its
registration with an RD. To use the interface, the registering endpoint sends a POST request to the registration resource returned by the initial registration operation.<a class="pilcrow" href="#section-5.3.1-1">Â¶</a></p>
<p id="section-5.3.1-2">An update <span class="bcp14">MAY</span> update registration parameters, such as lifetime, base URI, or others.
Parameters that are not being changed should not
be included in an update. Adding parameters that have not changed increases
the size of the message but does not have any other implications.
Parameters are included as query parameters in an update operation, as
in <a class="xref" href="#registration">Section 5</a>.<a class="pilcrow" href="#section-5.3.1-2">Â¶</a></p>
<p id="section-5.3.1-3">A registration update resets the timeout of the registration to the (possibly
updated) lifetime of the registration, independent of whether an <code>lt</code> parameter
was given.<a class="pilcrow" href="#section-5.3.1-3">Â¶</a></p>
<p id="section-5.3.1-4">If the base URI of the registration is changed in an update,
relative references submitted in the original registration or later updates are resolved anew against the new base.<a class="pilcrow" href="#section-5.3.1-4">Â¶</a></p>
<p id="section-5.3.1-5">The registration update operation only describes the use of POST with an empty payload.
Future standards might describe the semantics of using content formats and payloads
with the POST method to update the links of a registration (see <a class="xref" href="#link-up">Section 5.3.3</a>).<a class="pilcrow" href="#section-5.3.1-5">Â¶</a></p>
<p id="section-5.3.1-6">The update registration request interface is specified as follows:<a class="pilcrow" href="#section-5.3.1-6">Â¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.3.1-7">
            <dt id="section-5.3.1-7.1">Interaction:</dt>
            <dd id="section-5.3.1-7.2" style="margin-left: 1.5em">EP or CT -&gt; RD<a class="pilcrow" href="#section-5.3.1-7.2">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.3.1-7.3">Method:</dt>
            <dd id="section-5.3.1-7.4" style="margin-left: 1.5em">POST<a class="pilcrow" href="#section-5.3.1-7.4">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.3.1-7.5">URI Template:</dt>
            <dd id="section-5.3.1-7.6" style="margin-left: 1.5em">{+location}{?lt,base,extra-attrs*}<a class="pilcrow" href="#section-5.3.1-7.6">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.3.1-7.7">URI Template Variables:</dt>
            <dd id="section-5.3.1-7.8" style="margin-left: 1.5em">
              <p id="section-5.3.1-7.8.1"><br/></p>
<span class="break"></span><dl class="dlParallel" id="section-5.3.1-7.8.2">
                <dt id="section-5.3.1-7.8.2.1">location :=</dt>
                <dd id="section-5.3.1-7.8.2.2" style="margin-left: 1.5em">This is the location returned by the RD as a result of a successful
 earlier registration.<a class="pilcrow" href="#section-5.3.1-7.8.2.2">Â¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-5.3.1-7.8.2.3">lt :=</dt>
                <dd id="section-5.3.1-7.8.2.4" style="margin-left: 1.5em">Lifetime (optional). This is the lifetime of the registration in seconds,
 with a range of 1-4294967295. If no lifetime is included, the previous last
 lifetime set on a previous update or the original registration
 (falling back to 90000) <span class="bcp14">SHOULD</span> be used.<a class="pilcrow" href="#section-5.3.1-7.8.2.4">Â¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-5.3.1-7.8.2.5">base :=</dt>
                <dd id="section-5.3.1-7.8.2.6" style="margin-left: 1.5em">
                  <p id="section-5.3.1-7.8.2.6.1">Base URI (optional). This parameter updates the base URI established in the
   original registration to a new value and is subject to
   the same restrictions as in the registration.<a class="pilcrow" href="#section-5.3.1-7.8.2.6.1">Â¶</a></p>
<p id="section-5.3.1-7.8.2.6.2">If the parameter is set in an update, it is stored by the RD as the new
   base URI under which to interpret the relative links present in the payload of
   the original registration.<a class="pilcrow" href="#section-5.3.1-7.8.2.6.2">Â¶</a></p>
<p id="section-5.3.1-7.8.2.6.3">If the parameter is not set in the request but was set before, the previous
   base URI value is kept unmodified.<a class="pilcrow" href="#section-5.3.1-7.8.2.6.3">Â¶</a></p>
<p id="section-5.3.1-7.8.2.6.4">If the parameter is not set in the request and was not set before either, the
   source address and source port of the update request are stored as the
   base URI.<a class="pilcrow" href="#section-5.3.1-7.8.2.6.4">Â¶</a></p>
</dd>
                <dd class="break"></dd>
<dt id="section-5.3.1-7.8.2.7">extra-attrs :=</dt>
                <dd id="section-5.3.1-7.8.2.8" style="margin-left: 1.5em">
                  <p id="section-5.3.1-7.8.2.8.1">Additional registration attributes (optional). As with the registration,
   the RD processes them if it knows their semantics. Otherwise, unknown
   attributes are stored as endpoint attributes, overriding any previously
   stored endpoint attributes of the same key.<a class="pilcrow" href="#section-5.3.1-7.8.2.8.1">Â¶</a></p>
<p id="section-5.3.1-7.8.2.8.2">Note that this default behavior does not allow removing an endpoint attribute
   in an update. For attributes whose functionality depends on the endpoints'
   ability to remove them in an update,
   it can make sense to define a value whose presence is equivalent to the absence
   of a value. As an alternative, an extension can define different updating rules
   for their attributes. That necessitates either discovering whether the RD is
   aware of that extension or tolerating the default behavior.<a class="pilcrow" href="#section-5.3.1-7.8.2.8.2">Â¶</a></p>
</dd>
              <dd class="break"></dd>
</dl>
</dd>
            <dd class="break"></dd>
<dt id="section-5.3.1-7.9">Content-Format:</dt>
            <dd id="section-5.3.1-7.10" style="margin-left: 1.5em">none (no payload)<a class="pilcrow" href="#section-5.3.1-7.10">Â¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-5.3.1-8">The following responses are expected on this interface:<a class="pilcrow" href="#section-5.3.1-8">Â¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.3.1-9">
            <dt id="section-5.3.1-9.1">Success:</dt>
            <dd id="section-5.3.1-9.2" style="margin-left: 1.5em">2.04 (Changed) or 204 (No Content) if the update was successfully processed.<a class="pilcrow" href="#section-5.3.1-9.2">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.3.1-9.3">Failure:</dt>
            <dd id="section-5.3.1-9.4" style="margin-left: 1.5em">4.04 (Not Found) or 404 (Not Found). Registration does not exist (e.g., may have
     been removed).<a class="pilcrow" href="#section-5.3.1-9.4">Â¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-5.3.1-10">If the registration update fails in any way, including "Not Found" and request timeouts,
or if the time indicated in a Service Unavailable Max-Age/Retry-After exceeds the remaining lifetime,
the registering endpoint <span class="bcp14">SHOULD</span> attempt registration again.<a class="pilcrow" href="#section-5.3.1-10">Â¶</a></p>
<p id="section-5.3.1-11">The following example shows how the registering endpoint resets the timeout on its registration resource at
an RD using this interface with the example location value /rd/4521:<a class="pilcrow" href="#section-5.3.1-11">Â¶</a></p>
<span id="name-example-update-of-a-registr"></span><div id="example-update">
<figure id="figure-13">
            <div id="section-5.3.1-12.1">
<pre class="sourcecode">Req: POST /rd/4521

Res: 2.04 Changed
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-13">Figure 13</a>:
<a class="selfRef" href="#name-example-update-of-a-registr">Example Update of a Registration</a>
            </figcaption></figure>
</div>
<p id="section-5.3.1-13">The following example shows the registering endpoint updating its registration resource at
an RD using this interface with the example location value /rd/4521. The initial registration by the registering endpoint set the following values:<a class="pilcrow" href="#section-5.3.1-13">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3.1-14.1">endpoint name (ep)=endpoint1<a class="pilcrow" href="#section-5.3.1-14.1">Â¶</a>
</li>
            <li class="normal" id="section-5.3.1-14.2">lifetime (lt)=500<a class="pilcrow" href="#section-5.3.1-14.2">Â¶</a>
</li>
            <li class="normal" id="section-5.3.1-14.3">base URI (base)=coap://local-proxy-old.example.com<a class="pilcrow" href="#section-5.3.1-14.3">Â¶</a>
</li>
            <li class="normal" id="section-5.3.1-14.4">payload of <a class="xref" href="#example-payload">Figure 8</a><a class="pilcrow" href="#section-5.3.1-14.4">Â¶</a>
</li>
          </ul>
<p id="section-5.3.1-15">The initial state of the RD is reflected in the following request:<a class="pilcrow" href="#section-5.3.1-15">Â¶</a></p>
<span id="name-example-lookup-before-a-cha"></span><div id="example-update-base-lookup-pre">
<figure id="figure-14">
            <div id="section-5.3.1-16.1">
<pre class="sourcecode">Req: GET /rd-lookup/res?ep=endpoint1

Res: 2.05 Content
Payload:
&lt;coap://local-proxy-old.example.com/sensors/temp&gt;;
    rt=temperature-c;if=sensor,
&lt;http://www.example.com/sensors/temp&gt;;
    anchor="coap://local-proxy-old.example.com/sensors/temp";
    rel=describedby
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-14">Figure 14</a>:
<a class="selfRef" href="#name-example-lookup-before-a-cha">Example Lookup Before a Change to the Base Address</a>
            </figcaption></figure>
</div>
<p id="section-5.3.1-17">The following example shows the registering endpoint changing the base URI to <code>coaps://new.example.com:5684</code>:<a class="pilcrow" href="#section-5.3.1-17">Â¶</a></p>
<span id="name-example-registration-update"></span><div id="example-update-base">
<figure id="figure-15">
            <div id="section-5.3.1-18.1">
<pre class="sourcecode">Req: POST /rd/4521?base=coaps://new.example.com

Res: 2.04 Changed
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-15">Figure 15</a>:
<a class="selfRef" href="#name-example-registration-update">Example Registration Update that Changes the Base Address</a>
            </figcaption></figure>
</div>
<p id="section-5.3.1-19">The consecutive query returns:<a class="pilcrow" href="#section-5.3.1-19">Â¶</a></p>
<span id="name-example-lookup-after-a-chan"></span><div id="example-update-base-lookup-post">
<figure id="figure-16">
            <div id="section-5.3.1-20.1">
<pre class="sourcecode">Req: GET /rd-lookup/res?ep=endpoint1

Res: 2.05 Content
Payload:
&lt;coaps://new.example.com/sensors/temp&gt;;
    rt=temperature-c;if=sensor,
&lt;http://www.example.com/sensors/temp&gt;;
    anchor="coaps://new.example.com/sensors/temp";
    rel=describedby
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-16">Figure 16</a>:
<a class="selfRef" href="#name-example-lookup-after-a-chan">Example Lookup After a Change to the Base Address</a>
            </figcaption></figure>
</div>
</section>
</div>
<div id="removal">
<section id="section-5.3.2">
          <h4 id="name-registration-removal">
<a class="section-number selfRef" href="#section-5.3.2">5.3.2. </a><a class="section-name selfRef" href="#name-registration-removal">Registration Removal</a>
          </h4>
<p id="section-5.3.2-1">Although RD registrations have soft state and will eventually time out after their
lifetime, the registering endpoint <span class="bcp14">SHOULD</span> explicitly remove an entry from the RD if it
knows it will no longer be available (for example, on shutdown). This is
accomplished using a removal interface on the RD by performing a DELETE on
the endpoint resource.<a class="pilcrow" href="#section-5.3.2-1">Â¶</a></p>
<p id="section-5.3.2-2">The removal request interface is specified as follows:<a class="pilcrow" href="#section-5.3.2-2">Â¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.3.2-3">
            <dt id="section-5.3.2-3.1">Interaction:</dt>
            <dd id="section-5.3.2-3.2" style="margin-left: 1.5em">EP or CT -&gt; RD<a class="pilcrow" href="#section-5.3.2-3.2">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.3.2-3.3">Method:</dt>
            <dd id="section-5.3.2-3.4" style="margin-left: 1.5em">DELETE<a class="pilcrow" href="#section-5.3.2-3.4">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.3.2-3.5">URI Template:</dt>
            <dd id="section-5.3.2-3.6" style="margin-left: 1.5em">{+location}<a class="pilcrow" href="#section-5.3.2-3.6">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.3.2-3.7">URI Template Variables:</dt>
            <dd id="section-5.3.2-3.8" style="margin-left: 1.5em">
              <p id="section-5.3.2-3.8.1"><br/></p>
<span class="break"></span><dl class="dlParallel" id="section-5.3.2-3.8.2">
                <dt id="section-5.3.2-3.8.2.1">location :=</dt>
                <dd id="section-5.3.2-3.8.2.2" style="margin-left: 1.5em">This is the location returned by the RD as a result of a successful
 earlier registration.<a class="pilcrow" href="#section-5.3.2-3.8.2.2">Â¶</a>
</dd>
              <dd class="break"></dd>
</dl>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-5.3.2-4"> The following responses are expected on this interface:<a class="pilcrow" href="#section-5.3.2-4">Â¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.3.2-5">
            <dt id="section-5.3.2-5.1">Success:</dt>
            <dd id="section-5.3.2-5.2" style="margin-left: 1.5em">2.02 (Deleted) or 204 (No Content) upon successful deletion.<a class="pilcrow" href="#section-5.3.2-5.2">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.3.2-5.3">Failure:</dt>
            <dd id="section-5.3.2-5.4" style="margin-left: 1.5em">4.04 (Not Found) or 404 (Not Found). Registration does not exist (e.g., may
     already have been removed).<a class="pilcrow" href="#section-5.3.2-5.4">Â¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-5.3.2-6">The following example shows successful removal of the endpoint from the RD
   with example location value /rd/4521:<a class="pilcrow" href="#section-5.3.2-6">Â¶</a></p>
<span id="name-example-of-a-registration-r"></span><div id="example-removal">
<figure id="figure-17">
            <div id="section-5.3.2-7.1">
<pre class="sourcecode">Req: DELETE /rd/4521

Res: 2.02 Deleted
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-17">Figure 17</a>:
<a class="selfRef" href="#name-example-of-a-registration-r">Example of a Registration Removal</a>
            </figcaption></figure>
</div>
</section>
</div>
<div id="link-up">
<section id="section-5.3.3">
          <h4 id="name-further-operations">
<a class="section-number selfRef" href="#section-5.3.3">5.3.3. </a><a class="section-name selfRef" href="#name-further-operations">Further Operations</a>
          </h4>
<p id="section-5.3.3-1">Additional operations on the registration can be specified in future documents, for
   example:<a class="pilcrow" href="#section-5.3.3-1">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3.3-2.1">Send iPATCH (or PATCH) updates <span>[<a class="xref" href="#RFC8132">RFC8132</a>]</span> to add,
     remove, or change the links of a registration.<a class="pilcrow" href="#section-5.3.3-2.1">Â¶</a>
</li>
            <li class="normal" id="section-5.3.3-2.2">Use GET to read the currently stored set of links in a registration resource.<a class="pilcrow" href="#section-5.3.3-2.2">Â¶</a>
</li>
          </ul>
<p id="section-5.3.3-3">Those operations are out of scope of this document and will require media types suitable for modifying sets of links.<a class="pilcrow" href="#section-5.3.3-3">Â¶</a></p>
</section>
</div>
<div id="freshness">
<section id="section-5.3.4">
          <h4 id="name-request-freshness">
<a class="section-number selfRef" href="#section-5.3.4">5.3.4. </a><a class="section-name selfRef" href="#name-request-freshness">Request Freshness</a>
          </h4>
<p id="section-5.3.4-1">Some security mechanisms usable with an RD allow out-of-order request processing
or do not even mandate replay protection at all.
The RD needs to ensure that operations on the registration resource
are executed in an order that does not distort the client's intentions.<a class="pilcrow" href="#section-5.3.4-1">Â¶</a></p>
<p id="section-5.3.4-2">This ordering of operations is expressed in terms of freshness, as defined in <span>[<a class="xref" href="#RFC9175">RFC9175</a>]</span>.
Requests that alter a resource's state need to be fresh relative to the latest request
that altered that state in a conflicting way.<a class="pilcrow" href="#section-5.3.4-2">Â¶</a></p>
<p id="section-5.3.4-3">An RD <span class="bcp14">SHOULD</span> determine a request's freshness
and <span class="bcp14">MUST</span> use the Echo option if it requires request freshness and cannot determine it in any other way.
An endpoint <span class="bcp14">MUST</span> support the use of the Echo option.
(One reason why an RD would not require freshness is when no relevant registration properties are covered by its security policies.)<a class="pilcrow" href="#section-5.3.4-3">Â¶</a></p>
<div id="efficient-use-of-echo-by-an-rd">
<section id="section-5.3.4.1">
            <h5 id="name-efficient-use-of-echo-by-an">
<a class="section-number selfRef" href="#section-5.3.4.1">5.3.4.1. </a><a class="section-name selfRef" href="#name-efficient-use-of-echo-by-an">Efficient Use of Echo by an RD</a>
            </h5>
<p id="section-5.3.4.1-1">To keep latency and traffic added by the freshness requirements to a minimum,
RDs should avoid naive (sufficient but inefficient) freshness criteria.<a class="pilcrow" href="#section-5.3.4.1-1">Â¶</a></p>
<p id="section-5.3.4.1-2">Some simple mechanisms the RD can employ are:<a class="pilcrow" href="#section-5.3.4.1-2">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3.4.1-3.1">
                <p id="section-5.3.4.1-3.1.1">State counter. The RD can keep a monotonous counter that increments
 whenever a registration changes. For every registration resource, it stores
 the post-increment value of that resource's last change. Requests altering
 them need to have at least that value encoded in their Echo option
 and are otherwise rejected with a 4.01 (Unauthorized) and the current
 counter value as the Echo value. If other applications on the same server
 use Echo as well, that encoding may include a prefix indicating that it
 pertains to the RD's counter.<a class="pilcrow" href="#section-5.3.4.1-3.1.1">Â¶</a></p>
<p id="section-5.3.4.1-3.1.2">The value associated with a resource needs to be kept across the removal
 of registrations if the same registration resource is to be reused.<a class="pilcrow" href="#section-5.3.4.1-3.1.2">Â¶</a></p>
<p id="section-5.3.4.1-3.1.3">The counter can be reset (and the values of removed resources forgotten)
 when all previous security associations are reset.<a class="pilcrow" href="#section-5.3.4.1-3.1.3">Â¶</a></p>
<p id="section-5.3.4.1-3.1.4">This is the "Persistent Counter" method of <span>[<a class="xref" href="#RFC9175">RFC9175</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc9175#appendix-A">Appendix A</a></span>.<a class="pilcrow" href="#section-5.3.4.1-3.1.4">Â¶</a></p>
</li>
              <li class="normal" id="section-5.3.4.1-3.2">
                <p id="section-5.3.4.1-3.2.1">Preemptive Echo values. The current state counter can be sent in an Echo
 option not only when requests are rejected with 4.01 (Unauthorized) but
 also with successful responses. Thus, clients can be provided with Echo
 values sufficient for their next request on a regular basis. This is also described in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9175#section-2.3">Section 2.3</a> of [<a class="xref" href="#RFC9175">RFC9175</a>]</span><a class="pilcrow" href="#section-5.3.4.1-3.2.1">Â¶</a></p>
<p id="section-5.3.4.1-3.2.2"> While endpoints may discard received Echo values at leisure between
 requests, they are encouraged to retain these values for the next request
 to avoid additional round trips.<a class="pilcrow" href="#section-5.3.4.1-3.2.2">Â¶</a></p>
</li>
              <li class="normal" id="section-5.3.4.1-3.3">If the RD can ensure that only one security association has modifying access to any registration at any given time
and that security association provides order on the requests,
that order is sufficient to show request freshness.<a class="pilcrow" href="#section-5.3.4.1-3.3">Â¶</a>
</li>
            </ul>
</section>
</div>
<div id="examples-of-echo-usage">
<section id="section-5.3.4.2">
            <h5 id="name-examples-of-echo-usage">
<a class="section-number selfRef" href="#section-5.3.4.2">5.3.4.2. </a><a class="section-name selfRef" href="#name-examples-of-echo-usage">Examples of Echo Usage</a>
            </h5>
<p id="section-5.3.4.2-1"><a class="xref" href="#example-freshness">Figure 18</a> shows the interactions of an endpoint
that has forgotten the server's latest Echo value
and temporarily reduces its registration lifetime:<a class="pilcrow" href="#section-5.3.4.2-1">Â¶</a></p>
<span id="name-example-update-of-a-registra"></span><div id="example-freshness">
<figure id="figure-18">
              <div id="section-5.3.4.2-2.1">
<pre class="sourcecode">Req: POST /rd/4521?lt=7200

Res: 4.01 Unauthorized
Echo: 0x0123

(EP tries again immediately.)

Req: POST /rd/4521?lt=7200
Echo: 0x0123

Res: 2.04 Changed
Echo: 0x0124

(Later, the EP regains its confidence in its long-term reachability.)

Req: POST /rd/4521?lt=90000
Echo: 0x0124

Res: 2.04 Changed
Echo: 0x0247
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-18">Figure 18</a>:
<a class="selfRef" href="#name-example-update-of-a-registra">Example Update of a Registration</a>
              </figcaption></figure>
</div>
<p id="section-5.3.4.2-3">The other examples do not show Echo options for two reasons: (1) for simplicity
and (2) because they lack the context for any example values to have meaning.<a class="pilcrow" href="#section-5.3.4.2-3">Â¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="lookup">
<section id="section-6">
      <h2 id="name-rd-lookup">
<a class="section-number selfRef" href="#section-6">6. </a><a class="section-name selfRef" href="#name-rd-lookup">RD Lookup</a>
      </h2>
<p id="section-6-1">To discover the resources registered with the RD,
a lookup interface must be provided. This lookup interface
is defined as a default, and it is assumed that RDs may also support lookups
to return resource descriptions in alternative formats (e.g., JSON or CBOR link format <span>[<a class="xref" href="#I-D.ietf-core-links-json">CORE-LINKS-JSON</a>]</span>)
or use more advanced interfaces (e.g., supporting context- or semantic-based lookup) on different resources that are discovered independently.<a class="pilcrow" href="#section-6-1">Â¶</a></p>
<p id="section-6-2">RD lookup allows lookups for endpoints and resources
using attributes defined in this document and for use with the CoRE
Link Format. The result of a lookup request is the list of links (if any)
corresponding to the type of lookup.  Thus, an endpoint lookup <span class="bcp14">MUST</span> return a list of endpoints, and a resource lookup <span class="bcp14">MUST</span> return a list of links to resources.<a class="pilcrow" href="#section-6-2">Â¶</a></p>
<p id="section-6-3">The lookup type implemented by a lookup resource is indicated by a resource type, as per <a class="xref" href="#lookup-types">Table 1</a>:<a class="pilcrow" href="#section-6-3">Â¶</a></p>
<span id="name-lookup-types"></span><div id="lookup-types">
<table class="center" id="table-1">
        <caption>
<a class="selfRef" href="#table-1">Table 1</a>:
<a class="selfRef" href="#name-lookup-types">Lookup Types</a>
        </caption>
<thead>
          <tr>
            <th class="text-left" colspan="1" rowspan="1">Lookup Type</th>
            <th class="text-left" colspan="1" rowspan="1">Resource Type</th>
            <th class="text-left" colspan="1" rowspan="1">Mandatory</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">Resource</td>
            <td class="text-left" colspan="1" rowspan="1">core.rd-lookup-res</td>
            <td class="text-left" colspan="1" rowspan="1">Mandatory</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">Endpoint</td>
            <td class="text-left" colspan="1" rowspan="1">core.rd-lookup-ep</td>
            <td class="text-left" colspan="1" rowspan="1">Mandatory</td>
          </tr>
        </tbody>
      </table>
</div>
<div id="resource-lookup">
<section id="section-6.1">
        <h3 id="name-resource-lookup">
<a class="section-number selfRef" href="#section-6.1">6.1. </a><a class="section-name selfRef" href="#name-resource-lookup">Resource Lookup</a>
        </h3>
<p id="section-6.1-1">Resource lookup results in links that are semantically equivalent to the links submitted to the RD by the registrant.
The links and link parameters returned by the lookup are equal to the originally submitted ones,
except that the target reference is fully resolved
and that the anchor reference is fully resolved if it is present in the lookup result at all.<a class="pilcrow" href="#section-6.1-1">Â¶</a></p>
<p id="section-6.1-2">Links that did not have an anchor attribute in the registration are returned without an anchor attribute.
Links of which href or anchor was submitted as a (full) URI are returned with the respective attribute unmodified.<a class="pilcrow" href="#section-6.1-2">Â¶</a></p>
<p id="section-6.1-3">The above rules allow the client to interpret the response as links without any further knowledge of the storage conventions of the RD.
The RD <span class="bcp14">MAY</span> replace the registration base URIs with a configured intermediate proxy, e.g., in the case of an HTTP lookup interface for CoAP endpoints.<a class="pilcrow" href="#section-6.1-3">Â¶</a></p>
<p id="section-6.1-4">If the base URI of a registration contains a link-local address,
the RD <span class="bcp14">MUST NOT</span> show its links unless the lookup was made from the
link on which the registered endpoint can be reached.
The RD <span class="bcp14">MUST NOT</span> include zone identifiers in the resolved URIs.<a class="pilcrow" href="#section-6.1-4">Â¶</a></p>
</section>
</div>
<div id="lookup-filtering">
<section id="section-6.2">
        <h3 id="name-lookup-filtering">
<a class="section-number selfRef" href="#section-6.2">6.2. </a><a class="section-name selfRef" href="#name-lookup-filtering">Lookup Filtering</a>
        </h3>
<p id="section-6.2-1">Using the Accept option, the requester can control whether the returned list is returned in CoRE Link Format (<code>application/link-format</code>, default) or in alternate content formats (e.g., from <span>[<a class="xref" href="#I-D.ietf-core-links-json">CORE-LINKS-JSON</a>]</span>).<a class="pilcrow" href="#section-6.2-1">Â¶</a></p>
<p id="section-6.2-2">Multiple search criteria <span class="bcp14">MAY</span> be included in a lookup. All included criteria <span class="bcp14">MUST</span> match for a link to be returned. The RD <span class="bcp14">MUST</span> support matching with multiple search criteria.<a class="pilcrow" href="#section-6.2-2">Â¶</a></p>
<p id="section-6.2-3">A link matches a search criterion if it has an attribute of
        the same name and the same value, allowing for a trailing "*"
        wildcard operator, as in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc6690#section-4.1">Section 4.1</a> of [<a class="xref" href="#RFC6690">RFC6690</a>]</span>.  Attributes that are defined as
        <code>relation-types</code> (in the link-format ABNF) match if the
        search value matches any of their values (see <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc6690#section-4.1">Section 4.1</a> of [<a class="xref" href="#RFC6690">RFC6690</a>]</span>;
        for example, <code>?if=tag:example.net,2020:sensor</code> matches
        <code>;if="example.regname tag:example.net,2020:sensor";</code>.
        A resource link also matches a search criterion if its
        endpoint would match the criterion, and vice versa, an
        endpoint link matches a search criterion if any of its
        resource links matches it.<a class="pilcrow" href="#section-6.2-3">Â¶</a></p>
<p id="section-6.2-4">Note that <code>href</code> is a valid search criterion and matches target references. Like all search criteria, on a resource lookup, it can match the target reference of the resource link itself but also the registration resource of the endpoint that registered it.
Queries for resource link targets <span class="bcp14">MUST</span> be in URI form (i.e., not relative references) and are matched against a resolved link target. Queries for endpoints <span class="bcp14">SHOULD</span> be expressed in path-absolute form if possible and <span class="bcp14">MUST</span> be expressed in URI form otherwise; the RD <span class="bcp14">SHOULD</span> recognize either.
The <code>anchor</code> attribute is usable for resource lookups and, if queried, <span class="bcp14">MUST</span> be in URI form as well.<a class="pilcrow" href="#section-6.2-4">Â¶</a></p>
<p id="section-6.2-5">Additional query parameters "page" and "count" are used to obtain lookup results in specified increments using pagination, where count specifies how many links to return and page specifies which subset of links organized in sequential pages, each containing 'count' links, starting with link zero and page zero. Thus, specifying a count of 10 and page of 0 will return the first 10 links in the result set (links 0-9). Specifying a count of 10 and page of 1 will return the next 'page' containing links 10-19, and so on.
Unlike block-wise transfer of a complete result set,
these parameters ensure that each chunk of results can be interpreted on its own.
This simplifies the processing
but can result in duplicate or missed items when coinciding with changes from the registration interface.<a class="pilcrow" href="#section-6.2-5">Â¶</a></p>
<p id="section-6.2-6">Endpoints that are interested in a lookup result repeatedly or continuously can use
mechanisms such as ETag caching, resource observation <span>[<a class="xref" href="#RFC7641">RFC7641</a>]</span>,
or any future mechanism that might allow more efficient observations of collections.
These are advertised, detected, and used according to their own specifications
and can be used with the lookup interface as with any other resource.<a class="pilcrow" href="#section-6.2-6">Â¶</a></p>
<p id="section-6.2-7">When resource observation is used,
every time the set of matching links changes or the content of a matching link changes, the RD sends a notification with the matching link set.
The notification contains the successful current response to the given request,
especially with respect to representing zero matching links
(see "Success" item below).<a class="pilcrow" href="#section-6.2-7">Â¶</a></p>
<p id="section-6.2-8">The lookup interface is specified as follows:<a class="pilcrow" href="#section-6.2-8">Â¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-6.2-9">
          <dt id="section-6.2-9.1">Interaction:</dt>
          <dd id="section-6.2-9.2" style="margin-left: 1.5em">Client -&gt; RD<a class="pilcrow" href="#section-6.2-9.2">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-9.3">Method:</dt>
          <dd id="section-6.2-9.4" style="margin-left: 1.5em">GET<a class="pilcrow" href="#section-6.2-9.4">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-9.5">URI Template:</dt>
          <dd id="section-6.2-9.6" style="margin-left: 1.5em">{+type-lookup-location}{?page,count,search*}<a class="pilcrow" href="#section-6.2-9.6">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-9.7">URI Template Variables:</dt>
          <dd id="section-6.2-9.8" style="margin-left: 1.5em">
            <p id="section-6.2-9.8.1"><br/></p>
<span class="break"></span><dl class="dlParallel" id="section-6.2-9.8.2">
              <dt id="section-6.2-9.8.2.1">type-lookup-location :=</dt>
              <dd id="section-6.2-9.8.2.2" style="margin-left: 1.5em">RD lookup URI for a given lookup type (mandatory). The address is
       discovered as described in <a class="xref" href="#discovery">Section 4.3</a>.<a class="pilcrow" href="#section-6.2-9.8.2.2">Â¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-6.2-9.8.2.3">search := </dt>
              <dd id="section-6.2-9.8.2.4" style="margin-left: 1.5em">
                <p id="section-6.2-9.8.2.4.1"> Search criteria for limiting the number of results (optional). The search
 criteria are an associative array, expressed in a form-style query,
        as per the URI Template (see <span>[<a class="xref" href="#RFC6570">RFC6570</a>]</span>, Sections
        <a class="relref" href="https://www.rfc-editor.org/rfc/rfc6570#section-2.4.2">2.4.2</a> and <a class="relref" href="https://www.rfc-editor.org/rfc/rfc6570#section-3.2.8">3.2.8</a>).<a class="pilcrow" href="#section-6.2-9.8.2.4.1">Â¶</a></p>
</dd>
              <dd class="break"></dd>
<dt id="section-6.2-9.8.2.5">page :=</dt>
              <dd id="section-6.2-9.8.2.6" style="margin-left: 1.5em">Page (optional). This parameter cannot be used without the count
       parameter. Results are returned from result set in pages that contain
       'count' links starting from index (page * count). Page numbering starts
       with zero.<a class="pilcrow" href="#section-6.2-9.8.2.6">Â¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-6.2-9.8.2.7">count := </dt>
              <dd id="section-6.2-9.8.2.8" style="margin-left: 1.5em">Count (optional). The number of results is limited to this parameter value. If
       the page parameter is also present, the response <span class="bcp14">MUST</span> only include
       'count' links starting with the (page * count) link in the result set from the
       query. If the count parameter is not present, then the response <span class="bcp14">MUST</span>
       return all matching links in the result set. Link numbering starts with zero.<a class="pilcrow" href="#section-6.2-9.8.2.8">Â¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-9.9">Accept:</dt>
          <dd id="section-6.2-9.10" style="margin-left: 1.5em">absent, <code>application/link-format</code>, or any other indicated media type representing web
   links<a class="pilcrow" href="#section-6.2-9.10">Â¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-6.2-10"> The following responses codes are defined for this interface:<a class="pilcrow" href="#section-6.2-10">Â¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-6.2-11">
          <dt id="section-6.2-11.1">Success:</dt>
          <dd id="section-6.2-11.2" style="margin-left: 1.5em">
            <p id="section-6.2-11.2.1">2.05 (Content) or 200 (OK) with an <code>application/link-format</code> or other
     web link payload containing matching entries for the lookup.<a class="pilcrow" href="#section-6.2-11.2.1">Â¶</a></p>
<p id="section-6.2-11.2.2">The payload can contain zero links (which is an empty payload in the link format described in <span>[<a class="xref" href="#RFC6690">RFC6690</a>]</span> but could also be <code>[]</code>
     in JSON-based formats), indicating that no entities matched the request.<a class="pilcrow" href="#section-6.2-11.2.2">Â¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="resource-lookup-examples">
<section id="section-6.3">
        <h3 id="name-resource-lookup-examples">
<a class="section-number selfRef" href="#section-6.3">6.3. </a><a class="section-name selfRef" href="#name-resource-lookup-examples">Resource Lookup Examples</a>
        </h3>
<p id="section-6.3-1">The examples in this section assume the existence of CoAP hosts with a default CoAP port 61616. HTTP hosts are possible and do not change the nature of the examples.<a class="pilcrow" href="#section-6.3-1">Â¶</a></p>
<p id="section-6.3-2">The following example shows a client performing a resource lookup with the example resource lookup locations discovered in <a class="xref" href="#example-discovery">Figure 5</a>:<a class="pilcrow" href="#section-6.3-2">Â¶</a></p>
<span id="name-example-of-a-resource-looku"></span><div id="example-lookup-res">
<figure id="figure-19">
          <div id="section-6.3-3.1">
<pre class="sourcecode">Req: GET /rd-lookup/res?rt=tag:example.org,2020:temperature

Res: 2.05 Content
Payload:
&lt;coap://[2001:db8:3::123]:61616/temp&gt;;
    rt="tag:example.org,2020:temperature"
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-19">Figure 19</a>:
<a class="selfRef" href="#name-example-of-a-resource-looku">Example of a Resource Lookup</a>
          </figcaption></figure>
</div>
<p id="section-6.3-4">A client that wants to be notified of new resources as they show up can use
 this observation:<a class="pilcrow" href="#section-6.3-4">Â¶</a></p>
<span id="name-example-of-an-observing-res"></span><div id="example-lookup-obs">
<figure id="figure-20">
          <div id="section-6.3-5.1">
<pre class="sourcecode">Req: GET /rd-lookup/res?rt=tag:example.org,2020:light
Observe: 0

Res: 2.05 Content
Observe: 23
Payload: empty

(at a later point in time)

Res: 2.05 Content
Observe: 24
Payload:
&lt;coap://[2001:db8:3::124]/west&gt;;rt="tag:example.org,2020:light",
&lt;coap://[2001:db8:3::124]/south&gt;;rt="tag:example.org,2020:light",
&lt;coap://[2001:db8:3::124]/east&gt;;rt="tag:example.org,2020:light"
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-20">Figure 20</a>:
<a class="selfRef" href="#name-example-of-an-observing-res">Example of an Observing Resource Lookup</a>
          </figcaption></figure>
</div>
<p id="section-6.3-6">The following example shows a client performing a paginated resource lookup:<a class="pilcrow" href="#section-6.3-6">Â¶</a></p>
<span id="name-example-of-paginated-resour"></span><div id="example-lookup-page">
<figure id="figure-21">
          <div id="section-6.3-7.1">
<pre class="sourcecode">Req: GET /rd-lookup/res?page=0&amp;count=5

Res: 2.05 Content
Payload:
&lt;coap://[2001:db8:3::123]:61616/res/0&gt;;ct=60,
&lt;coap://[2001:db8:3::123]:61616/res/1&gt;;ct=60,
&lt;coap://[2001:db8:3::123]:61616/res/2&gt;;ct=60,
&lt;coap://[2001:db8:3::123]:61616/res/3&gt;;ct=60,
&lt;coap://[2001:db8:3::123]:61616/res/4&gt;;ct=60

Req: GET /rd-lookup/res?page=1&amp;count=5

Res: 2.05 Content
Payload:
&lt;coap://[2001:db8:3::123]:61616/res/5&gt;;ct=60,
&lt;coap://[2001:db8:3::123]:61616/res/6&gt;;ct=60,
&lt;coap://[2001:db8:3::123]:61616/res/7&gt;;ct=60,
&lt;coap://[2001:db8:3::123]:61616/res/8&gt;;ct=60,
&lt;coap://[2001:db8:3::123]:61616/res/9&gt;;ct=60
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-21">Figure 21</a>:
<a class="selfRef" href="#name-example-of-paginated-resour">Example of Paginated Resource Lookup</a>
          </figcaption></figure>
</div>
<p id="section-6.3-8">The following example shows a client performing a lookup of all resources
of all endpoints of a given endpoint type. It assumes that two endpoints (with endpoint
names <code>sensor1</code> and <code>sensor2</code>) have previously registered with their respective
addresses (<code>coap://sensor1.example.com</code> and <code>coap://sensor2.example.com</code>) and
posted the very payload of the 6th response of <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc6690#section-5">Section 5</a> of [<a class="xref" href="#RFC6690">RFC6690</a>]</span>.<a class="pilcrow" href="#section-6.3-8">Â¶</a></p>
<p id="section-6.3-9">It demonstrates how absolute link targets stay unmodified, while relative ones
are resolved:<a class="pilcrow" href="#section-6.3-9">Â¶</a></p>
<span id="name-example-of-a-resource-lookup"></span><div id="example-lookup-multiple">
<figure id="figure-22">
          <div id="section-6.3-10.1">
<pre class="sourcecode">Req: GET /rd-lookup/res?et=tag:example.com,2020:platform

Res: 2.05 Content
Payload:
&lt;coap://sensor1.example.com/sensors&gt;;ct=40;title="Sensor Index",
&lt;coap://sensor1.example.com/sensors/temp&gt;;rt=temperature-c;if=sensor,
&lt;coap://sensor1.example.com/sensors/light&gt;;rt=light-lux;if=sensor,
&lt;http://www.example.com/sensors/t123&gt;;rel=describedby;
    anchor="coap://sensor1.example.com/sensors/temp",
&lt;coap://sensor1.example.com/t&gt;;rel=alternate;
    anchor="coap://sensor1.example.com/sensors/temp",
&lt;coap://sensor2.example.com/sensors&gt;;ct=40;title="Sensor Index",
&lt;coap://sensor2.example.com/sensors/temp&gt;;rt=temperature-c;if=sensor,
&lt;coap://sensor2.example.com/sensors/light&gt;;rt=light-lux;if=sensor,
&lt;http://www.example.com/sensors/t123&gt;;rel=describedby;
    anchor="coap://sensor2.example.com/sensors/temp",
&lt;coap://sensor2.example.com/t&gt;;rel=alternate;
    anchor="coap://sensor2.example.com/sensors/temp"
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-22">Figure 22</a>:
<a class="selfRef" href="#name-example-of-a-resource-lookup">Example of a Resource Lookup from Multiple Endpoints</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="ep-lookup">
<section id="section-6.4">
        <h3 id="name-endpoint-lookup">
<a class="section-number selfRef" href="#section-6.4">6.4. </a><a class="section-name selfRef" href="#name-endpoint-lookup">Endpoint Lookup</a>
        </h3>
<p id="section-6.4-1">The endpoint lookup returns links to and information about registration resources,
 which themselves can only be manipulated by the registering endpoint.<a class="pilcrow" href="#section-6.4-1">Â¶</a></p>
<p id="section-6.4-2">Endpoint registration resources are annotated with their endpoint names (ep), sectors
 (d, if present), and registration base URI (base; reports the registrant-EP's address if
 no explicit base was given), as well as a constant resource type (rt="core.rd-ep"); the
 lifetime (lt) is not reported.
 Additional endpoint attributes are added as target attributes to their endpoint link
 unless their specification says otherwise.<a class="pilcrow" href="#section-6.4-2">Â¶</a></p>
<p id="section-6.4-3">Links to endpoints <span class="bcp14">SHOULD</span> be presented in path-absolute form or, if
 required, as (full) URIs. (This ensures that the output conforms to Limited Link Format,
 as described in <a class="xref" href="#limitedlinkformat">Appendix C</a>.)<a class="pilcrow" href="#section-6.4-3">Â¶</a></p>
<p id="section-6.4-4">Base addresses that contain link-local addresses <span class="bcp14">MUST NOT</span> include zone
 identifiers, and such registrations  <span class="bcp14">MUST NOT</span> be shown unless the lookup was made from the same link from which the
 registration was made.<a class="pilcrow" href="#section-6.4-4">Â¶</a></p>
<p id="section-6.4-5">While the endpoint lookup does expose the registration resources,
 the RD does not need to make them accessible to clients.
 Clients <span class="bcp14">SHOULD NOT</span> attempt to dereference or manipulate them.<a class="pilcrow" href="#section-6.4-5">Â¶</a></p>
<p id="section-6.4-6">  An RD can report registrations in lookup whose URI scheme and
   authority differ from that of the lookup resource.  
 Lookup clients <span class="bcp14">MUST</span> be prepared to see arbitrary URIs as registration
 resources in the results and treat them as opaque identifiers;
 the precise semantics of such links are left to future specifications.<a class="pilcrow" href="#section-6.4-6">Â¶</a></p>
<p id="section-6.4-7">The following example shows a client performing an endpoint lookup that is limited to
 endpoints of endpoint type <code>tag:example.com,2020:platform</code>:<a class="pilcrow" href="#section-6.4-7">Â¶</a></p>
<span id="name-example-of-endpoint-lookup"></span><div id="example-lookup-ep">
<figure id="figure-23">
          <div id="section-6.4-8.1">
<pre class="sourcecode">Req: GET /rd-lookup/ep?et=tag:example.com,2020:platform

Res: 2.05 Content
Payload:
&lt;/rd/1234&gt;;base="coap://[2001:db8:3::127]:61616";ep=node5;
    et="tag:example.com,2020:platform";ct=40;rt=core.rd-ep,
&lt;/rd/4521&gt;;base="coap://[2001:db8:3::129]:61616";ep=node7;
    et="tag:example.com,2020:platform";ct=40;d=floor-3;
    rt=core.rd-ep
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-23">Figure 23</a>:
<a class="selfRef" href="#name-example-of-endpoint-lookup">Example of Endpoint Lookup</a>
          </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="policies">
<section id="section-7">
      <h2 id="name-security-policies">
<a class="section-number selfRef" href="#section-7">7. </a><a class="section-name selfRef" href="#name-security-policies">Security Policies</a>
      </h2>
<p id="section-7-1">The security policies that are applicable to an RD strongly depend on the application
and are not set out normatively here.<a class="pilcrow" href="#section-7-1">Â¶</a></p>
<p id="section-7-2">This section provides a list of aspects that applications should consider when describing their use of the RD,
without claiming to cover all cases.
It uses terminology of <span>[<a class="xref" href="#I-D.ietf-ace-oauth-authz">ACE-OAUTH-AUTHZ</a>]</span>,
in which the RD acts as the Resource Server (RS), and both registrant-EPs and lookup clients act as Clients (C) with support from an Authorization Server (AS),
without the intention of ruling out other schemes (e.g., those based on certificates/Public Key Infrastructures (PKIs)).<a class="pilcrow" href="#section-7-2">Â¶</a></p>
<p id="section-7-3">Any, all, or none of the below can apply to an application.
Which are relevant depends on its protection objectives.<a class="pilcrow" href="#section-7-3">Â¶</a></p>
<p id="section-7-4">Security policies are set by configuration of the RD or by choice of the implementation.
Lookup clients (and, where relevant, endpoints) can only trust an RD to uphold them if it is authenticated
and authorized to serve as an RD according to the application's requirements.<a class="pilcrow" href="#section-7-4">Â¶</a></p>
<div id="secure-ep">
<section id="section-7.1">
        <h3 id="name-endpoint-name">
<a class="section-number selfRef" href="#section-7.1">7.1. </a><a class="section-name selfRef" href="#name-endpoint-name">Endpoint Name</a>
        </h3>
<p id="section-7.1-1">Whenever an RD needs to provide trustworthy results to clients doing endpoint lookup
or resource lookup with filtering on the endpoint name,
the RD must ensure that the registrant is authorized to use the given endpoint name.
This applies both to registration and later to operations on the registration resource.
It is immaterial whether the client is the registrant-EP itself or a CT is doing the registration.
The RD cannot tell the difference, and CTs may use authorization credentials authorizing only operations on that particular endpoint name or a wider range of endpoint names.<a class="pilcrow" href="#section-7.1-1">Â¶</a></p>
<p id="section-7.1-2">It is up to the concrete security policy to describe
how the endpoint name and sector are transported when certificates are used.
For example, it may describe how SubjectAltName dNSName entries are mapped to endpoint and domain names.<a class="pilcrow" href="#section-7.1-2">Â¶</a></p>
<div id="arbitrary-ep">
<section id="section-7.1.1">
          <h4 id="name-random-endpoint-names">
<a class="section-number selfRef" href="#section-7.1.1">7.1.1. </a><a class="section-name selfRef" href="#name-random-endpoint-names">Random Endpoint Names</a>
          </h4>
<p id="section-7.1.1-1">Conversely, in applications where the RD does not check the endpoint name,
the authorized registering endpoint can generate a random number (or string) that identifies the endpoint.
The RD should then remember unique properties of the registrant,
associate them with the registration for as long as its registration resource is active (which may be longer than the registration's lifetime),
and require the same properties for operations on the registration resource.<a class="pilcrow" href="#section-7.1.1-1">Â¶</a></p>
<p id="section-7.1.1-2">Registrants that are prepared to pick a different identifier when their initial attempt
(or attempts, in the unlikely case of two subsequent collisions)
at registration is unauthorized should pick an identifier at least twice as long as would be needed to enumerate the expected number of registrants;
registrants without any such recovery options should pick significantly longer endpoint names (e.g., using Universally Unique Identifier (UUID) URNs <span>[<a class="xref" href="#RFC4122">RFC4122</a>]</span>).<a class="pilcrow" href="#section-7.1.1-2">Â¶</a></p>
</section>
</div>
</section>
</div>
<div id="entered-links">
<section id="section-7.2">
        <h3 id="name-entered-links">
<a class="section-number selfRef" href="#section-7.2">7.2. </a><a class="section-name selfRef" href="#name-entered-links">Entered Links</a>
        </h3>
<p id="section-7.2-1">When lookup clients expect that certain types of links can only originate from certain endpoints,
then the RD needs to apply filtering to the links an endpoint may register.<a class="pilcrow" href="#section-7.2-1">Â¶</a></p>
<p id="section-7.2-2">For example, if clients use an RD to find a server that provides firmware updates,
then any registrant that wants to register (or update) links to firmware sources will need to provide suitable credentials to do so, independently of its endpoint name.<a class="pilcrow" href="#section-7.2-2">Â¶</a></p>
<p id="section-7.2-3">Note that the impact of having undesirable links in the RD depends on the application.
If the client requires the firmware server to present credentials as a firmware server,
a fraudulent link's impact is limited to the client revealing its intention to obtain updates and slowing down the client until it finds a legitimate firmware server;
if the client accepts any credentials from the server as long as they fit the provided URI, the impact is larger.<a class="pilcrow" href="#section-7.2-3">Â¶</a></p>
<p id="section-7.2-4">An RD may also require that links are only registered if the registrant is authorized to publish information about the anchor (or even target) of the link.
One way to do this is to demand that the registrant present the same credentials in its role as a registering client that it would need to present in its role as a server when contacted at the resources' URI. These credentials may include using the address and port that are part of the URI.
Such a restriction places severe practical limitations on the links that can be registered.<a class="pilcrow" href="#section-7.2-4">Â¶</a></p>
<p id="section-7.2-5">As above, the impact of undesirable links depends on the extent to which the lookup client relies on the RD.
To avoid the limitations, RD applications should consider prescribing that lookup clients only use the discovered information as hints
and describe which pieces of information need to be verified because they impact the application's security.
A straightforward way to verify such information is to request it again from an authorized server, typically the one that hosts the target resource.
That is similar to what happens in <a class="xref" href="#discovery">Section 4.3</a> when the "URI discovery" step is repeated.<a class="pilcrow" href="#section-7.2-5">Â¶</a></p>
</section>
</div>
<div id="link-confidentiality">
<section id="section-7.3">
        <h3 id="name-link-confidentiality">
<a class="section-number selfRef" href="#section-7.3">7.3. </a><a class="section-name selfRef" href="#name-link-confidentiality">Link Confidentiality</a>
        </h3>
<p id="section-7.3-1">When registrants publish information in the RD that is not available to any client that would query the registrant's <code>/.well-known/core</code> interface,
or when lookups to that interface are subject to stricter firewalling than lookups to the RD,
the RD may need to limit which lookup clients may access the information.<a class="pilcrow" href="#section-7.3-1">Â¶</a></p>
<p id="section-7.3-2">In this case, the endpoint (and not the lookup clients) needs to be careful to check the RD's authorization.
The RD needs to check any lookup client's authorization
before revealing information directly (in resource lookup)
or indirectly (when using it to satisfy a resource lookup search criterion).<a class="pilcrow" href="#section-7.3-2">Â¶</a></p>
</section>
</div>
<div id="segmentation">
<section id="section-7.4">
        <h3 id="name-segmentation">
<a class="section-number selfRef" href="#section-7.4">7.4. </a><a class="section-name selfRef" href="#name-segmentation">Segmentation</a>
        </h3>
<p id="section-7.4-1">Within a single RD, different security policies can apply.<a class="pilcrow" href="#section-7.4-1">Â¶</a></p>
<p id="section-7.4-2">One example of this are multi-tenant deployments separated by the sector (d) parameter.
Some sectors might apply limitations on the endpoint names available,
while others use a random identifier approach to endpoint names and place limits on the entered links based on their attributes instead.<a class="pilcrow" href="#section-7.4-2">Â¶</a></p>
<p id="section-7.4-3">Care must be taken in such setups to determine the applicable access control measures to each operation.
One easy way to do that is to mandate the use of the sector parameter on all operations,
as no credentials are suitable for operations across sector borders anyway.<a class="pilcrow" href="#section-7.4-3">Â¶</a></p>
</section>
</div>
<div id="first-come-first-remembered-a-default-policy">
<section id="section-7.5">
        <h3 id="name-first-come-first-remembered">
<a class="section-number selfRef" href="#section-7.5">7.5. </a><a class="section-name selfRef" href="#name-first-come-first-remembered">"First Come First Remembered": A Default Policy</a>
        </h3>
<p id="section-7.5-1">The "First Come First Remembered" policy is provided both as a reference example for a
 security policy definition and as a policy that implementations may choose to use as
 default policy in the absence of any other configuration. It is designed to enable efficient
 discovery operations even in ad hoc settings.<a class="pilcrow" href="#section-7.5-1">Â¶</a></p>
<p id="section-7.5-2">Under this policy, the RD accepts registrations for any endpoint name that is not assigned to an active registration resource
and only accepts registration updates from the same endpoint.
The policy is minimal in that it does not make any promises to lookup clients about the claims of Sections <a class="xref" href="#entered-links">7.2</a> and <a class="xref" href="#link-confidentiality">7.3</a>,
and promises about the claims in <a class="xref" href="#secure-ep">Section 7.1</a> are limited to the lifetime of that endpoint's registration.
It does however promise the endpoint that, for the duration of its registration, its links will be discoverable on the RD.<a class="pilcrow" href="#section-7.5-2">Â¶</a></p>
<p id="section-7.5-3">When a registration or operation is attempted, the RD <span class="bcp14">MUST</span> determine the client's subject name or public key:<a class="pilcrow" href="#section-7.5-3">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.5-4.1">If the client's credentials indicate any subject name that is certified by any authority that the RD recognizes (which may be the system's trust anchor store), all such subject names are stored.
With credentials based on CWT or JWT (as common with Authentication and Authorization for Constrained Environments (ACE)), the Subject (sub) claim is stored as a single name, if it exists.
With X.509 certificates, the Common Name (CN) and the complete list of SubjectAltName entries are stored.
In both cases, the authority that certified the claim is stored along with the subject, as the latter may only be locally unique.<a class="pilcrow" href="#section-7.5-4.1">Â¶</a>
</li>
          <li class="normal" id="section-7.5-4.2">Otherwise, if the client proves possession of a private key, the matching public key is stored.
This applies both to raw public keys and to the public keys indicated in certificates that failed the above authority check.<a class="pilcrow" href="#section-7.5-4.2">Â¶</a>
</li>
          <li class="normal" id="section-7.5-4.3">If neither is present, a reference to the security session itself is stored.
With (D)TLS, that is the connection itself or the session resumption information, if available.
With OSCORE, that is the security context.<a class="pilcrow" href="#section-7.5-4.3">Â¶</a>
</li>
        </ul>
<p id="section-7.5-5">As part of the registration operation, that information is stored along with the registration resource.<a class="pilcrow" href="#section-7.5-5">Â¶</a></p>
<p id="section-7.5-6">The RD <span class="bcp14">MUST</span> accept all registrations whose registration resource is not already active,
as long as they are made using a security layer supported by the RD.<a class="pilcrow" href="#section-7.5-6">Â¶</a></p>
<p id="section-7.5-7">Any operation on a registration resource,
including registrations that lead to an existing registration resource,
<span class="bcp14">MUST</span> be rejected by the RD unless all the stored information is found in the new request's credentials.<a class="pilcrow" href="#section-7.5-7">Â¶</a></p>
<p id="section-7.5-8">Note that, even though subject names are compared in this policy,
they are never directly compared to endpoint names,
and an endpoint cannot expect to "own" any particular endpoint name outside of an active registration --
even if a certificate says so.
It is an accepted shortcoming of this approach that the endpoint has no indication of whether the RD remembers it by its subject name or public key;
recognition by subject happens on a best-effort basis (given the RD may not recognize any authority).
Clients <span class="bcp14">MUST</span> be prepared to pick a different endpoint name when rejected by the RD initially or after a change in their credentials;
picking an endpoint name, as per <a class="xref" href="#arbitrary-ep">Section 7.1.1</a>, is an easy option for that.<a class="pilcrow" href="#section-7.5-8">Â¶</a></p>
<p id="section-7.5-9">For this policy to be usable without configuration, clients should not set a sector name in their registrations.
An RD can set a default sector name for registrations accepted under this policy,
which is especially useful in a segmented setup where different policies apply to different sectors.
The configuration of such a behavior, as well as any other configuration applicable to such an RD
(i.e., the set of recognized authorities),
is out of scope for this document.<a class="pilcrow" href="#section-7.5-9">Â¶</a></p>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-8">
      <h2 id="name-security-considerations">
<a class="section-number selfRef" href="#section-8">8. </a><a class="section-name selfRef" href="#name-security-considerations">Security Considerations</a>
      </h2>
<p id="section-8-1">The security considerations as described in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8288#section-5">Section 5</a> of [<a class="xref" href="#RFC8288">RFC8288</a>]</span> and <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc6690#section-6">Section 6</a> of [<a class="xref" href="#RFC6690">RFC6690</a>]</span> apply. The <code>/.well-known/core</code> resource may be
protected, e.g., using DTLS when hosted on a CoAP server, as described in
<span>[<a class="xref" href="#RFC7252">RFC7252</a>]</span>.<a class="pilcrow" href="#section-8-1">Â¶</a></p>
<p id="section-8-2">Access that is limited or affects sensitive data <span class="bcp14">SHOULD</span> be protected,
e.g., using (D)TLS or OSCORE <span>[<a class="xref" href="#RFC8613">RFC8613</a>]</span>;
which aspects of the RD this affects depends on the security policies of the application (see <a class="xref" href="#policies">Section 7</a>).<a class="pilcrow" href="#section-8-2">Â¶</a></p>
<div id="seccons-discovery">
<section id="section-8.1">
        <h3 id="name-discovery">
<a class="section-number selfRef" href="#section-8.1">8.1. </a><a class="section-name selfRef" href="#name-discovery">Discovery</a>
        </h3>
<p id="section-8.1-1">Most steps in discovery of the RD, and possibly its resources, are not covered by CoAP's security mechanisms.
This will not endanger the security properties of the registrations and lookup itself
(where the client requires authorization of the RD if it expects any security properties of the operation)
but may leak the client's intention to third parties
and allow them to slow down the process.<a class="pilcrow" href="#section-8.1-1">Â¶</a></p>
<p id="section-8.1-2">To mitigate that, clients can retain the RD's address,
use secure discovery options (such as configured addresses),
and send queries for RDs in a very general form (e.g., <code>?rt=core.rd*</code> rather than <code>?rt=core.rd-lookup-ep</code>).<a class="pilcrow" href="#section-8.1-2">Â¶</a></p>
</section>
</div>
<div id="endpoint_identification">
<section id="section-8.2">
        <h3 id="name-endpoint-identification-and">
<a class="section-number selfRef" href="#section-8.2">8.2. </a><a class="section-name selfRef" href="#name-endpoint-identification-and">Endpoint Identification and Authentication</a>
        </h3>
<p id="section-8.2-1">An endpoint (name, sector) pair is unique within the set of endpoints registered by the RD. An endpoint <span class="bcp14">MUST NOT</span> be identified by its protocol, port, or IP
address, as these may change over the lifetime of an endpoint.<a class="pilcrow" href="#section-8.2-1">Â¶</a></p>
<p id="section-8.2-2">Every operation performed by an endpoint on an RD
<span class="bcp14">SHOULD</span> be mutually authenticated using a pre-shared key, a raw public key, or
certificate-based security.<a class="pilcrow" href="#section-8.2-2">Â¶</a></p>
<p id="section-8.2-3">Consider the following threat: two devices, A and B, are registered at a single server. Both devices have unique, per-device credentials for use with DTLS to make sure that only parties with authorization to access A or B can do so.<a class="pilcrow" href="#section-8.2-3">Â¶</a></p>
<p id="section-8.2-4">Now, imagine that a malicious device A wants to sabotage the device B. It uses its credentials during the DTLS exchange. Then, it specifies the
endpoint name of device B as the name of its own endpoint in device A. If the server does not check
whether the identifier provided in the DTLS handshake matches the
identifier used at the CoAP layer, then it may be inclined to use the
endpoint name for looking up what information to provision to the malicious device.<a class="pilcrow" href="#section-8.2-4">Â¶</a></p>
<p id="section-8.2-5">Endpoint authorization needs to be checked on registration and registration resource operations
independently of whether there are configured requirements on the credentials for a given endpoint name and sector (<a class="xref" href="#secure-ep">Section 7.1</a>)
or whether arbitrary names are accepted (<a class="xref" href="#arbitrary-ep">Section 7.1.1</a>).<a class="pilcrow" href="#section-8.2-5">Â¶</a></p>
<p id="section-8.2-6">Simple registration could be used to circumvent address-based access control.
An attacker would send a simple registration request with the victim's address as the source address
and later look up the victim's <code>/.well-known/core</code> content in the RD.
Mitigation for this is recommended in <a class="xref" href="#simple">Section 5.1</a>.<a class="pilcrow" href="#section-8.2-6">Â¶</a></p>
<p id="section-8.2-7">The registration resource path is visible to any client that is allowed endpoint lookup
and can be extracted by resource lookup clients as well.
The same goes for registration attributes that are shown as target attributes or lookup attributes.
The RD needs to consider this in the choice of registration resource paths,
as do administrators or endpoints in their choice of attributes.<a class="pilcrow" href="#section-8.2-7">Â¶</a></p>
</section>
</div>
<div id="access-control">
<section id="section-8.3">
        <h3 id="name-access-control">
<a class="section-number selfRef" href="#section-8.3">8.3. </a><a class="section-name selfRef" href="#name-access-control">Access Control</a>
        </h3>
<p id="section-8.3-1">Access control <span class="bcp14">SHOULD</span> be performed separately for the RD registration and lookup
API paths, as different endpoints may be authorized to register
with an RD from those authorized to look up endpoints from the RD. Such access
control <span class="bcp14">SHOULD</span> be performed in as fine-grained a level as possible. For example,
access control for lookups could be performed either at the sector, endpoint,
or resource level.<a class="pilcrow" href="#section-8.3-1">Â¶</a></p>
<p id="section-8.3-2">The precise access controls necessary (and the consequences of failure to enforce them)
depend on the protection objectives of the application and the security policies (<a class="xref" href="#policies">Section 7</a>) derived from them.<a class="pilcrow" href="#section-8.3-2">Â¶</a></p>
</section>
</div>
<div id="denial-of-service-attacks">
<section id="section-8.4">
        <h3 id="name-denial-of-service-attacks">
<a class="section-number selfRef" href="#section-8.4">8.4. </a><a class="section-name selfRef" href="#name-denial-of-service-attacks">Denial-of-Service Attacks</a>
        </h3>
<p id="section-8.4-1">Services that run over UDP unprotected are vulnerable to unknowingly
amplify and distribute a DoS attack, as UDP does not require a return
routability check.
Since RD lookup responses can be significantly
larger than requests, RDs are prone to this.<a class="pilcrow" href="#section-8.4-1">Â¶</a></p>
<p id="section-8.4-2"><span>[<a class="xref" href="#RFC7252">RFC7252</a>]</span> describes this at length in its Section <a class="relref" href="https://www.rfc-editor.org/rfc/rfc7252#section-11.3">11.3</a>,
including some mitigation by using small block sizes in responses.
<span>[<a class="xref" href="#RFC9175">RFC9175</a>]</span> updates that
by describing a source address verification mechanism using the Echo option.<a class="pilcrow" href="#section-8.4-2">Â¶</a></p>
</section>
</div>
<div id="skipping-freshness-checks">
<section id="section-8.5">
        <h3 id="name-skipping-freshness-checks">
<a class="section-number selfRef" href="#section-8.5">8.5. </a><a class="section-name selfRef" href="#name-skipping-freshness-checks">Skipping Freshness Checks</a>
        </h3>
<p id="section-8.5-1">When RD-based applications are built in which request freshness checks are not performed,
these concerns need to be balanced:<a class="pilcrow" href="#section-8.5-1">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.5-2.1">
            <p id="section-8.5-2.1.1">When alterations to registration attributes are reordered,
an attacker may create any combination of attributes ever set,
with the attack difficulty determined by the security layer's replay properties.<a class="pilcrow" href="#section-8.5-2.1.1">Â¶</a></p>
<p id="section-8.5-2.1.2">
For example, if <a class="xref" href="#example-freshness">Figure 18</a> were conducted without freshness assurances,
an attacker could later reset the lifetime back to 7200.
Thus, the device is made unreachable to lookup clients.<a class="pilcrow" href="#section-8.5-2.1.2">Â¶</a></p>
</li>
          <li class="normal" id="section-8.5-2.2">
            <p id="section-8.5-2.2.1">When registration updates without query parameters
     (which just serve to restart the lifetime) can be reordered,
     an attacker can use intercepted messages to give the appearance of the device being
     alive to the RD.<a class="pilcrow" href="#section-8.5-2.2.1">Â¶</a></p>
<p id="section-8.5-2.2.2">This is unacceptable when the RD's security policy promises reachability of
     endpoints (e.g., when disappearing devices would trigger further investigation)
     but may be acceptable with other policies.<a class="pilcrow" href="#section-8.5-2.2.2">Â¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-9">
      <h2 id="name-iana-considerations">
<a class="section-number selfRef" href="#section-9">9. </a><a class="section-name selfRef" href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<div id="iana-rt">
<section id="section-9.1">
        <h3 id="name-resource-types">
<a class="section-number selfRef" href="#section-9.1">9.1. </a><a class="section-name selfRef" href="#name-resource-types">Resource Types</a>
        </h3>
<p id="section-9.1-1">IANA has added the following values to the "Resource Type (rt=) Link Target Attribute Values"
 subregistry of the "Constrained RESTful Environments (CoRE) Parameters"
 registry defined in <span>[<a class="xref" href="#RFC6690">RFC6690</a>]</span>:<a class="pilcrow" href="#section-9.1-1">Â¶</a></p>
<span id="name-additions-to-resource-type-"></span><table class="center" id="table-2">
          <caption>
<a class="selfRef" href="#table-2">Table 2</a>:
<a class="selfRef" href="#name-additions-to-resource-type-">Additions to Resource Type (rt=) Link Target Attribute Values Subregistry</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Value</th>
              <th class="text-left" colspan="1" rowspan="1">Description</th>
              <th class="text-left" colspan="1" rowspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">core.rd</td>
              <td class="text-left" colspan="1" rowspan="1">Directory resource of an RD</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9176, <a class="xref" href="#discovery">Section 4.3</a>
</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">core.rd-lookup-res</td>
              <td class="text-left" colspan="1" rowspan="1">Resource lookup of an RD</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9176, <a class="xref" href="#discovery">Section 4.3</a>
</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">core.rd-lookup-ep</td>
              <td class="text-left" colspan="1" rowspan="1">Endpoint lookup of an RD</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9176, <a class="xref" href="#discovery">Section 4.3</a>
</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">core.rd-ep</td>
              <td class="text-left" colspan="1" rowspan="1">Endpoint resource of an RD</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9176, <a class="xref" href="#lookup">Section 6</a>
</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
<div id="ipv6-nd-resource-directory-address-option">
<section id="section-9.2">
        <h3 id="name-ipv6-nd-resource-directory-">
<a class="section-number selfRef" href="#section-9.2">9.2. </a><a class="section-name selfRef" href="#name-ipv6-nd-resource-directory-">IPv6 ND Resource Directory Address Option</a>
        </h3>
<p id="section-9.2-1">IANA has registered one new ND option type in the "IPv6 Neighbor
        Discovery Option Formats" subregistry of the "Internet Control Message
        Protocol version 6 (ICMPv6) Parameters" registry:<a class="pilcrow" href="#section-9.2-1">Â¶</a></p>
<span id="name-addition-to-ipv6-neighbor-d"></span><table class="center" id="table-3">
          <caption>
<a class="selfRef" href="#table-3">Table 3</a>:
<a class="selfRef" href="#name-addition-to-ipv6-neighbor-d">Addition to IPv6 Neighbor Discovery Option Formats Subregistry</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Type</th>
              <th class="text-left" colspan="1" rowspan="1">Description</th>
              <th class="text-left" colspan="1" rowspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">41</td>
              <td class="text-left" colspan="1" rowspan="1">Resource Directory Address Option</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9176</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
<div id="iana-registry">
<section id="section-9.3">
        <h3 id="name-rd-parameters-registry">
<a class="section-number selfRef" href="#section-9.3">9.3. </a><a class="section-name selfRef" href="#name-rd-parameters-registry">RD Parameters Registry</a>
        </h3>
<p id="section-9.3-1">This specification defines a new subregistry for registration and
        lookup parameters called "RD Parameters" within the "Constrained
        RESTful Environments (CoRE) Parameters" registry. Although this
        specification defines a basic set of parameters, it is expected that
        other standards that make use of this interface will define new
        ones.<a class="pilcrow" href="#section-9.3-1">Â¶</a></p>
<p id="section-9.3-2">Each entry in the registry must include:<a class="pilcrow" href="#section-9.3-2">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.3-3.1">the human-readable name of the parameter,<a class="pilcrow" href="#section-9.3-3.1">Â¶</a>
</li>
          <li class="normal" id="section-9.3-3.2">the short name, as used in query parameters or target attributes,<a class="pilcrow" href="#section-9.3-3.2">Â¶</a>
</li>
          <li class="normal" id="section-9.3-3.3">syntax and validity requirements (if any),<a class="pilcrow" href="#section-9.3-3.3">Â¶</a>
</li>
          <li class="normal" id="section-9.3-3.4">indication of whether it can be passed as a query parameter at registration of
   endpoints, passed as a query parameter in lookups, or expressed as a target
   attribute,<a class="pilcrow" href="#section-9.3-3.4">Â¶</a>
</li>
          <li class="normal" id="section-9.3-3.5">a description, and<a class="pilcrow" href="#section-9.3-3.5">Â¶</a>
</li>
          <li class="normal" id="section-9.3-3.6">a link to reference documentation.<a class="pilcrow" href="#section-9.3-3.6">Â¶</a>
</li>
        </ul>
<p id="section-9.3-4">The query parameter <span class="bcp14">MUST</span> be both a valid URI query key <span>[<a class="xref" href="#RFC3986">RFC3986</a>]</span> and a token as used in <span>[<a class="xref" href="#RFC8288">RFC8288</a>]</span>.<a class="pilcrow" href="#section-9.3-4">Â¶</a></p>
<p id="section-9.3-5">The reference documentation must give details on whether the parameter can be updated and how it is to be processed in lookups.<a class="pilcrow" href="#section-9.3-5">Â¶</a></p>
<p id="section-9.3-6">The mechanisms around new RD parameters should be designed in such a way that they tolerate RD implementations that are unaware of the parameter and expose any parameter passed at registration or updates in endpoint lookups. (For example, if a parameter used at registration were to be confidential, the registering endpoint should be instructed to only set that parameter if the RD advertises support for keeping it confidential at the discovery step.)<a class="pilcrow" href="#section-9.3-6">Â¶</a></p>
<p id="section-9.3-7">Initial entries in this subregistry are as follows:<a class="pilcrow" href="#section-9.3-7">Â¶</a></p>
<span id="name-new-rd-parameters-registry"></span><div id="tab-registry">
<table class="center" id="table-4">
          <caption>
<a class="selfRef" href="#table-4">Table 4</a>:
<a class="selfRef" href="#name-new-rd-parameters-registry">New RD Parameters Registry</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Name</th>
              <th class="text-left" colspan="1" rowspan="1">Short</th>
              <th class="text-left" colspan="1" rowspan="1">Validity</th>
              <th class="text-left" colspan="1" rowspan="1">Use</th>
              <th class="text-left" colspan="1" rowspan="1">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">Endpoint Name</td>
              <td class="text-left" colspan="1" rowspan="1">ep</td>
              <td class="text-left" colspan="1" rowspan="1">Unicode*</td>
              <td class="text-left" colspan="1" rowspan="1">RLA</td>
              <td class="text-left" colspan="1" rowspan="1">Name of the endpoint</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">Lifetime</td>
              <td class="text-left" colspan="1" rowspan="1">lt</td>
              <td class="text-left" colspan="1" rowspan="1">1-4294967295</td>
              <td class="text-left" colspan="1" rowspan="1">R</td>
              <td class="text-left" colspan="1" rowspan="1">Lifetime of the registration in seconds</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">Sector</td>
              <td class="text-left" colspan="1" rowspan="1">d</td>
              <td class="text-left" colspan="1" rowspan="1">Unicode*</td>
              <td class="text-left" colspan="1" rowspan="1">RLA</td>
              <td class="text-left" colspan="1" rowspan="1">Sector to which this endpoint belongs</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">Registration Base URI</td>
              <td class="text-left" colspan="1" rowspan="1">base</td>
              <td class="text-left" colspan="1" rowspan="1">URI</td>
              <td class="text-left" colspan="1" rowspan="1">RLA</td>
              <td class="text-left" colspan="1" rowspan="1">The scheme, address, port, and path at which this server is
       available</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">Page</td>
              <td class="text-left" colspan="1" rowspan="1">page</td>
              <td class="text-left" colspan="1" rowspan="1">Integer</td>
              <td class="text-left" colspan="1" rowspan="1">L</td>
              <td class="text-left" colspan="1" rowspan="1">Used for pagination</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">Count</td>
              <td class="text-left" colspan="1" rowspan="1">count</td>
              <td class="text-left" colspan="1" rowspan="1">Integer</td>
              <td class="text-left" colspan="1" rowspan="1">L</td>
              <td class="text-left" colspan="1" rowspan="1">Used for pagination</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">Endpoint Type</td>
              <td class="text-left" colspan="1" rowspan="1">et</td>
              <td class="text-left" colspan="1" rowspan="1">
                RFC 9176, <a class="xref" href="#et-description">Section 9.3.1</a>
</td>
              <td class="text-left" colspan="1" rowspan="1">RLA</td>
              <td class="text-left" colspan="1" rowspan="1">Semantic type of the endpoint (see RFC 9176, <a class="xref" href="#et-registry">Section 9.4</a>)</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-9.3-9">Where:<a class="pilcrow" href="#section-9.3-9">Â¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-9.3-10">
          <dt id="section-9.3-10.1">Short:</dt>
          <dd id="section-9.3-10.2" style="margin-left: 1.5em">Short name used in query parameters or target attributes<a class="pilcrow" href="#section-9.3-10.2">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.3-10.3">Validity:</dt>
          <dd id="section-9.3-10.4" style="margin-left: 1.5em">
            <p id="section-9.3-10.4.1"><br/></p>
<span class="break"></span><dl class="dlParallel" id="section-9.3-10.4.2">
              <dt id="section-9.3-10.4.2.1">Unicode* = </dt>
              <dd id="section-9.3-10.4.2.2" style="margin-left: 1.5em">up to 63 bytes of UTF-8-encoded Unicode, with no control characters as per                           
          <a class="xref" href="#registration">Section 5</a><a class="pilcrow" href="#section-9.3-10.4.2.2">Â¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</dd>
          <dd class="break"></dd>
<dt id="section-9.3-10.5">Use:</dt>
          <dd id="section-9.3-10.6" style="margin-left: 1.5em">
            <p id="section-9.3-10.6.1"><br/></p>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-9.3-10.6.2">
              <dt id="section-9.3-10.6.2.1">R =</dt>
              <dd id="section-9.3-10.6.2.2" style="margin-left: 1.5em">used at registration<a class="pilcrow" href="#section-9.3-10.6.2.2">Â¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-9.3-10.6.2.3">L =</dt>
              <dd id="section-9.3-10.6.2.4" style="margin-left: 1.5em">used at lookup<a class="pilcrow" href="#section-9.3-10.6.2.4">Â¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-9.3-10.6.2.5">A =</dt>
              <dd id="section-9.3-10.6.2.6" style="margin-left: 1.5em">expressed in the target attribute<a class="pilcrow" href="#section-9.3-10.6.2.6">Â¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-9.3-11">The descriptions for the options defined in this document are only summarized here.
To which registrations they apply and when they are to be shown are described in the respective sections of this document.
All their reference documentation entries point to this document.<a class="pilcrow" href="#section-9.3-11">Â¶</a></p>
<p id="section-9.3-12">The IANA policy for future additions to the subregistry is Expert Review,
as described in <span>[<a class="xref" href="#RFC8126">RFC8126</a>]</span>. The evaluation should consider
formal criteria,
duplication of functionality (i.e., is the new entry redundant with an existing one?),
topical suitability (e.g., is the described property actually a property of the endpoint and not a property of a particular resource, in which case it should go into the payload of the registration and need not be registered?),
and the potential for conflict with commonly used target attributes (e.g., <code>if</code> could be used as a parameter for conditional registration if it were not to be used in lookup or attributes but would make a bad parameter for lookup because a resource lookup with an <code>if</code> query parameter could ambiguously filter by the registered endpoint property or the target attribute <span>[<a class="xref" href="#RFC6690">RFC6690</a>]</span>).<a class="pilcrow" href="#section-9.3-12">Â¶</a></p>
<div id="et-description">
<section id="section-9.3.1">
          <h4 id="name-full-description-of-the-end">
<a class="section-number selfRef" href="#section-9.3.1">9.3.1. </a><a class="section-name selfRef" href="#name-full-description-of-the-end">Full Description of the "Endpoint Type" RD Parameter</a>
          </h4>
<p id="section-9.3.1-1">An endpoint registering at an RD can describe itself with
          endpoint types, similar to how resources are described with resource
          types in <span>[<a class="xref" href="#RFC6690">RFC6690</a>]</span>.  An endpoint
          type is expressed as a string, which can be either a URI or one of
          the values defined in the "Endpoint Type (et=) RD Parameter Values"
          subregistry.  Endpoint types can be passed in the <code>et</code> query
          parameter as part of extra-attrs at the "registration" step of <a class="xref" href="#registration">Section 5</a>, are shown
          on endpoint lookups using the <code>et</code> target attribute, and can
          be filtered for using <code>et</code> as a search criterion in resource
          and endpoint lookup.  Multiple endpoint types are given as separate
          query parameters or link attributes.<a class="pilcrow" href="#section-9.3.1-1">Â¶</a></p>
<p id="section-9.3.1-2">Note that the endpoint type differs from the resource type in that it uses multiple
attributes rather than space-separated values.
As a result, RDs implementing this specification automatically support correct
filtering in the lookup interfaces from the rules for unknown endpoint
attributes.<a class="pilcrow" href="#section-9.3.1-2">Â¶</a></p>
</section>
</div>
</section>
</div>
<div id="et-registry">
<section id="section-9.4">
        <h3 id="name-endpoint-type-et-rd-paramet">
<a class="section-number selfRef" href="#section-9.4">9.4. </a><a class="section-name selfRef" href="#name-endpoint-type-et-rd-paramet">Endpoint Type (et=) RD Parameter Values</a>
        </h3>
<p id="section-9.4-1">This specification establishes a new subregistry called "Endpoint
        Type (et=) RD Parameter Values" within the "Constrained RESTful
        Environments (CoRE) Parameters" registry.
 The registry properties (required policy, requirements, and template) are
 identical to those of the "Resource Type (rt=) Link Target Attribute
 Values" subregistry defined in <span>[<a class="xref" href="#RFC6690">RFC6690</a>]</span>;
 in short, the review policy is IETF Review for
        values starting with "core" and Specification Required for others.<a class="pilcrow" href="#section-9.4-1">Â¶</a></p>
<p id="section-9.4-2">The requirements to be enforced are:<a class="pilcrow" href="#section-9.4-2">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.4-3.1">The values <span class="bcp14">MUST</span> be related to the purpose described in <a class="xref" href="#et-description">Section 9.3.1</a>.<a class="pilcrow" href="#section-9.4-3.1">Â¶</a>
</li>
          <li class="normal" id="section-9.4-3.2">The registered values <span class="bcp14">MUST</span> conform to the ABNF reg-rel-type definition of
<span>[<a class="xref" href="#RFC6690">RFC6690</a>]</span> and <span class="bcp14">MUST NOT</span> be a URI.<a class="pilcrow" href="#section-9.4-3.2">Â¶</a>
</li>
          <li class="normal" id="section-9.4-3.3">It is recommended to use the period "." character for segmentation.<a class="pilcrow" href="#section-9.4-3.3">Â¶</a>
</li>
        </ul>
<p id="section-9.4-4">The initial contents of the registry are as follows:<a class="pilcrow" href="#section-9.4-4">Â¶</a></p>
<span id="name-new-endpoint-type-et-rd-par"></span><table class="center" id="table-5">
          <caption>
<a class="selfRef" href="#table-5">Table 5</a>:
<a class="selfRef" href="#name-new-endpoint-type-et-rd-par">New Endpoint Type (et=) RD Parameter Values Registry</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Value</th>
              <th class="text-left" colspan="1" rowspan="1">Description</th>
              <th class="text-left" colspan="1" rowspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">core.rd-group</td>
              <td class="text-left" colspan="1" rowspan="1">An application group, as described in RFC 9176, <a class="xref" href="#groups">Appendix A</a>.</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9176</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
<div id="mc-registration">
<section id="section-9.5">
        <h3 id="name-multicast-address-registrat">
<a class="section-number selfRef" href="#section-9.5">9.5. </a><a class="section-name selfRef" href="#name-multicast-address-registrat">Multicast Address Registration</a>
        </h3>
<p id="section-9.5-1">
   IANA has assigned
 the following multicast addresses for use by CoAP nodes:<a class="pilcrow" href="#section-9.5-1">Â¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-9.5-2">
          <dt id="section-9.5-2.1">IPv4</dt>
          <dd id="section-9.5-2.2" style="margin-left: 1.5em">-- "All CoRE Resource Directories" address 224.0.1.190, in the
   "Internetwork Control Block (224.0.1.0 - 224.0.1.255 (224.0.1/24))"
   subregistry within the "IPv4 Multicast Address Space Registry".  As
   the address is used for discovery that may span beyond a single
   network, it has come from the Internetwork Control Block (224.0.1.x)
   <span>[<a class="xref" href="#RFC5771">RFC5771</a>]</span>.<a class="pilcrow" href="#section-9.5-2.2">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.5-2.3">IPv6</dt>
          <dd id="section-9.5-2.4" style="margin-left: 1.5em">-- "All CoRE Resource Directories" address ff0x::fe, in
      the "Variable Scope Multicast Addresses" subregistry within the "IPv6
      Multicast Address Space Registry" <span>[<a class="xref" href="#RFC3307">RFC3307</a>]</span>.  Note that there is a distinct multicast address for
      each scope that interested CoAP nodes should 
listen to; CoAP needs the
      link-local and site-local scopes only.<a class="pilcrow" href="#section-9.5-2.4">Â¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="well-known-uris">
<section id="section-9.6">
        <h3 id="name-well-known-uris">
<a class="section-number selfRef" href="#section-9.6">9.6. </a><a class="section-name selfRef" href="#name-well-known-uris">Well-Known URIs</a>
        </h3>
<p id="section-9.6-1">IANA has registered the URI suffix "rd" in the "Well-Known URIs"
        registry as follows:<a class="pilcrow" href="#section-9.6-1">Â¶</a></p>
<span id="name-addition-to-well-known-uris"></span><table class="center" id="table-6">
          <caption>
<a class="selfRef" href="#table-6">Table 6</a>:
<a class="selfRef" href="#name-addition-to-well-known-uris">Addition to Well-Known URIs Registry</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">URI Suffix</th>
              <th class="text-left" colspan="1" rowspan="1">Change Controller</th>
              <th class="text-left" colspan="1" rowspan="1">Reference</th>
              <th class="text-left" colspan="1" rowspan="1">Status</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">rd</td>
              <td class="text-left" colspan="1" rowspan="1">IETF</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9176</td>
              <td class="text-left" colspan="1" rowspan="1">permanent</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
<div id="service-names-and-transport-protocol-port-number-registry">
<section id="section-9.7">
        <h3 id="name-service-name-and-transport-">
<a class="section-number selfRef" href="#section-9.7">9.7. </a><a class="section-name selfRef" href="#name-service-name-and-transport-">Service Name and Transport Protocol Port Number Registry</a>
        </h3>
<p id="section-9.7-1">IANA has added four new items to the "Service Name and Transport Protocol Port Number Registry" as follows:<a class="pilcrow" href="#section-9.7-1">Â¶</a></p>
<span id="name-additions-to-service-name-a"></span><table class="center" id="table-7">
          <caption>
<a class="selfRef" href="#table-7">Table 7</a>:
<a class="selfRef" href="#name-additions-to-service-name-a">Additions to Service Name and Transport Protocol Port Number Registry</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Service Name</th>
              <th class="text-left" colspan="1" rowspan="1">Transport Protocol</th>
              <th class="text-left" colspan="1" rowspan="1">Description</th>
              <th class="text-left" colspan="1" rowspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">core-rd</td>
              <td class="text-left" colspan="1" rowspan="1">udp</td>
              <td class="text-left" colspan="1" rowspan="1">Resource Directory accessed using CoAP</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9176</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">core-rd-dtls</td>
              <td class="text-left" colspan="1" rowspan="1">udp</td>
              <td class="text-left" colspan="1" rowspan="1">Resource Directory accessed using CoAP over DTLS</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9176</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">core-rd</td>
              <td class="text-left" colspan="1" rowspan="1">tcp</td>
              <td class="text-left" colspan="1" rowspan="1">Resource Directory accessed using CoAP over TCP</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9176</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">core-rd-tls</td>
              <td class="text-left" colspan="1" rowspan="1">tcp</td>
              <td class="text-left" colspan="1" rowspan="1">Resource Directory accessed using CoAP over TLS</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9176</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
</section>
</div>
<div id="examples">
<section id="section-10">
      <h2 id="name-examples">
<a class="section-number selfRef" href="#section-10">10. </a><a class="section-name selfRef" href="#name-examples">Examples</a>
      </h2>
<p id="section-10-1">Two examples are presented: a lighting installation example in <a class="xref" href="#lt-ex">Section 10.1</a> and a Lightweight M2M (LwM2M) example in <a class="xref" href="#lwm2m-ex">Section 10.2</a>.<a class="pilcrow" href="#section-10-1">Â¶</a></p>
<div id="lt-ex">
<section id="section-10.1">
        <h3 id="name-lighting-installation">
<a class="section-number selfRef" href="#section-10.1">10.1. </a><a class="section-name selfRef" href="#name-lighting-installation">Lighting Installation</a>
        </h3>
<p id="section-10.1-1">This example shows a simplified lighting installation that makes use of
the RD with a CoAP interface to facilitate the installation and startup of
the application code in the lights and sensors. In particular, the example
leads to the definition of a group and the enabling of the corresponding
multicast address, as described in <a class="xref" href="#groups">Appendix A</a>. No conclusions must be drawn on the realization of actual
installation or naming procedures, because the example only emphasizes some of the issues
that may influence the use of the RD and does not pretend to be normative.<a class="pilcrow" href="#section-10.1-1">Â¶</a></p>
<div id="lt-in-ch">
<section id="section-10.1.1">
          <h4 id="name-installation-characteristic">
<a class="section-number selfRef" href="#section-10.1.1">10.1.1. </a><a class="section-name selfRef" href="#name-installation-characteristic">Installation Characteristics</a>
          </h4>
<p id="section-10.1.1-1">The example assumes that the installation is managed. That means that a Commissioning
Tool (CT) is used to authorize the addition of nodes, name them, and name
their services. The CT can be connected to the installation in many ways:
the CT can be part of the installation network, connected by Wi-Fi to the
installation network, connected via GPRS link, or connected by another method.<a class="pilcrow" href="#section-10.1.1-1">Â¶</a></p>
<p id="section-10.1.1-2">It is assumed that there are two naming authorities for the installation:
(1) the network manager that is responsible for the correct operation of
the network and the connected interfaces and (2) the lighting manager that
is responsible for the correct functioning of networked lights and sensors.
The result is the existence of two naming schemes coming from the two managing
entities.<a class="pilcrow" href="#section-10.1.1-2">Â¶</a></p>
<p id="section-10.1.1-3">The example installation consists of one presence sensor and two luminaries,
luminary1 and luminary2, each with their own wireless interface. Each luminary
contains three lamps: left, right, and middle. Each luminary is accessible
through one endpoint. For each lamp, a resource exists to modify the settings
of a lamp in a luminary. The purpose of the installation is that the presence
sensor notifies the presence of persons to a group of lamps. The group of
lamps consists of the middle and left lamps of luminary1 and the right lamp of luminary2.<a class="pilcrow" href="#section-10.1.1-3">Â¶</a></p>
<p id="section-10.1.1-4">Before commissioning by the lighting manager, the network is installed, and
access to the interfaces is proven to work by the network manager.<a class="pilcrow" href="#section-10.1.1-4">Â¶</a></p>
<p id="section-10.1.1-5">At the moment of installation, the network under installation is not necessarily
connected to the DNS infrastructure. Therefore, Stateless Address Autoconfiguration (SLAAC) IPv6 addresses are
assigned to CT, RD, luminaries, and the sensor.
The addresses shown in <a class="xref" href="#interface-S">Table 8</a> below stand in for these in the following examples.<a class="pilcrow" href="#section-10.1.1-5">Â¶</a></p>
<span id="name-addresses-used-in-the-examp"></span><div id="interface-S">
<table class="center" id="table-8">
            <caption>
<a class="selfRef" href="#table-8">Table 8</a>:
<a class="selfRef" href="#name-addresses-used-in-the-examp">Addresses Used in the Examples</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" colspan="1" rowspan="1">Name</th>
                <th class="text-left" colspan="1" rowspan="1">IPv6 address</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">luminary1</td>
                <td class="text-left" colspan="1" rowspan="1">2001:db8:4::1</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">luminary2</td>
                <td class="text-left" colspan="1" rowspan="1">2001:db8:4::2</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">Presence sensor</td>
                <td class="text-left" colspan="1" rowspan="1">2001:db8:4::3</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">RD</td>
                <td class="text-left" colspan="1" rowspan="1">2001:db8:4::ff</td>
              </tr>
            </tbody>
          </table>
</div>
<p id="section-10.1.1-7">In <a class="xref" href="#rd-en">Section 10.1.2</a>, the use of RD during installation is
presented.<a class="pilcrow" href="#section-10.1.1-7">Â¶</a></p>
</section>
</div>
<div id="rd-en">
<section id="section-10.1.2">
          <h4 id="name-rd-entries">
<a class="section-number selfRef" href="#section-10.1.2">10.1.2. </a><a class="section-name selfRef" href="#name-rd-entries">RD Entries</a>
          </h4>
<p id="section-10.1.2-1">It is assumed that access to the DNS infrastructure is not always possible
during installation. Therefore, the SLAAC addresses are used in this section.<a class="pilcrow" href="#section-10.1.2-1">Â¶</a></p>
<p id="section-10.1.2-2">For discovery, the resource types (rt) of the devices are important. The
lamps in the luminaries have rt=tag:example.com,2020:light, and the presence sensor has rt=tag:example.com,2020:p-sensor.
The endpoints have names that are relevant to the light installation manager.
In this case, luminary1, luminary2, and the presence sensor are located in
room 2-4-015, where luminary1 is located at the window and luminary2 and
the presence sensor are located at the door. The endpoint names reflect
this physical location. The middle, left, and right lamps are accessed via
path /light/middle, /light/left, and /light/right, respectively. The identifiers
relevant to the RD are shown in <a class="xref" href="#endpoint">Table 9</a>.<a class="pilcrow" href="#section-10.1.2-2">Â¶</a></p>
<span id="name-rd-identifiers"></span><div id="endpoint">
<table class="center" id="table-9">
            <caption>
<a class="selfRef" href="#table-9">Table 9</a>:
<a class="selfRef" href="#name-rd-identifiers">RD Identifiers</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" colspan="1" rowspan="1">Name</th>
                <th class="text-left" colspan="1" rowspan="1">Endpoint</th>
                <th class="text-left" colspan="1" rowspan="1">Resource Path</th>
                <th class="text-left" colspan="1" rowspan="1">Resource Type</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">luminary1</td>
                <td class="text-left" colspan="1" rowspan="1">lm_R2-4-015_wndw</td>
                <td class="text-left" colspan="1" rowspan="1">/light/left</td>
                <td class="text-left" colspan="1" rowspan="1">tag:example.com,2020:light</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">luminary1</td>
                <td class="text-left" colspan="1" rowspan="1">lm_R2-4-015_wndw</td>
                <td class="text-left" colspan="1" rowspan="1">/light/middle</td>
                <td class="text-left" colspan="1" rowspan="1">tag:example.com,2020:light</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">luminary1</td>
                <td class="text-left" colspan="1" rowspan="1">lm_R2-4-015_wndw</td>
                <td class="text-left" colspan="1" rowspan="1">/light/right</td>
                <td class="text-left" colspan="1" rowspan="1">tag:example.com,2020:light</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">luminary2</td>
                <td class="text-left" colspan="1" rowspan="1">lm_R2-4-015_door</td>
                <td class="text-left" colspan="1" rowspan="1">/light/left</td>
                <td class="text-left" colspan="1" rowspan="1">tag:example.com,2020:light</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">luminary2</td>
                <td class="text-left" colspan="1" rowspan="1">lm_R2-4-015_door</td>
                <td class="text-left" colspan="1" rowspan="1">/light/middle</td>
                <td class="text-left" colspan="1" rowspan="1">tag:example.com,2020:light</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">luminary2</td>
                <td class="text-left" colspan="1" rowspan="1">lm_R2-4-015_door</td>
                <td class="text-left" colspan="1" rowspan="1">/light/right</td>
                <td class="text-left" colspan="1" rowspan="1">tag:example.com,2020:light</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">Presence sensor</td>
                <td class="text-left" colspan="1" rowspan="1">ps_R2-4-015_door</td>
                <td class="text-left" colspan="1" rowspan="1">/ps</td>
                <td class="text-left" colspan="1" rowspan="1">tag:example.com,2020:p-sensor</td>
              </tr>
            </tbody>
          </table>
</div>
<p id="section-10.1.2-4">It is assumed that the CT has performed RD discovery and has received a response like the one in the example in <a class="xref" href="#discovery">Section 4.3</a>.<a class="pilcrow" href="#section-10.1.2-4">Â¶</a></p>
<p id="section-10.1.2-5">The CT inserts the endpoints of the luminaries and the sensor in the RD
using the registration base URI parameter (base) to specify the interface address:<a class="pilcrow" href="#section-10.1.2-5">Â¶</a></p>
<span id="name-example-of-registrations-a-"></span><div id="example-lighting-1">
<figure id="figure-24">
            <div id="section-10.1.2-6.1">
<pre class="sourcecode">Req: POST coap://[2001:db8:4::ff]/rd
  ?ep=lm_R2-4-015_wndw&amp;base=coap://[2001:db8:4::1]&amp;d=R2-4-015
Payload:
&lt;/light/left&gt;;rt="tag:example.com,2020:light",
&lt;/light/middle&gt;;rt="tag:example.com,2020:light",
&lt;/light/right&gt;;rt="tag:example.com,2020:light"

Res: 2.01 Created
Location-Path: /rd/4521

Req: POST coap://[2001:db8:4::ff]/rd
  ?ep=lm_R2-4-015_door&amp;base=coap://[2001:db8:4::2]&amp;d=R2-4-015
Payload:
&lt;/light/left&gt;;rt="tag:example.com,2020:light",
&lt;/light/middle&gt;;rt="tag:example.com,2020:light",
&lt;/light/right&gt;;rt="tag:example.com,2020:light"

Res: 2.01 Created
Location-Path: /rd/4522

Req: POST coap://[2001:db8:4::ff]/rd
  ?ep=ps_R2-4-015_door&amp;base=coap://[2001:db8:4::3]&amp;d=R2-4-015
Payload:
&lt;/ps&gt;;rt="tag:example.com,2020:p-sensor"

Res: 2.01 Created
Location-Path: /rd/4523
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-24">Figure 24</a>:
<a class="selfRef" href="#name-example-of-registrations-a-">Example of Registrations a CT Enters into an RD</a>
            </figcaption></figure>
</div>
<p id="section-10.1.2-7">The sector name d=R2-4-015 has been added for an efficient lookup because
filtering on the "ep" name is more awkward. The same sector name is communicated to
the two luminaries and the presence sensor by the CT.<a class="pilcrow" href="#section-10.1.2-7">Â¶</a></p>
<p id="section-10.1.2-8">The group is specified in the RD. The base parameter is set to the site-local
multicast address allocated to the group.
In the POST in the example below, the resources supported by all group members are published.<a class="pilcrow" href="#section-10.1.2-8">Â¶</a></p>
<span id="name-example-of-a-multicast-grou"></span><div id="example-lighting-2">
<figure id="figure-25">
            <div id="section-10.1.2-9.1">
<pre class="sourcecode">Req: POST coap://[2001:db8:4::ff]/rd
  ?ep=grp_R2-4-015&amp;et=core.rd-group&amp;base=coap://[ff05::1]
Payload:
&lt;/light/left&gt;;rt="tag:example.com,2020:light",
&lt;/light/middle&gt;;rt="tag:example.com,2020:light",
&lt;/light/right&gt;;rt="tag:example.com,2020:light"

Res: 2.01 Created
Location-Path: /rd/501
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-25">Figure 25</a>:
<a class="selfRef" href="#name-example-of-a-multicast-grou">Example of a Multicast Group a CT Enters into an RD</a>
            </figcaption></figure>
</div>
<p id="section-10.1.2-10">After the filling of the RD by the CT, the application in the luminaries
can learn to which groups they belong and enable their interface for the
multicast address.<a class="pilcrow" href="#section-10.1.2-10">Â¶</a></p>
<p id="section-10.1.2-11">The luminary, knowing its sector and being configured to join any group
containing lights, searches for candidate groups and joins them:<a class="pilcrow" href="#section-10.1.2-11">Â¶</a></p>
<span id="name-example-of-a-lookup-exchang"></span><div id="example-lighting-3">
<figure id="figure-26">
            <div id="section-10.1.2-12.1">
<pre class="sourcecode">Req: GET coap://[2001:db8:4::ff]/rd-lookup/ep
  ?d=R2-4-015&amp;et=core.rd-group&amp;rt=light

Res: 2.05 Content
Payload:
&lt;/rd/501&gt;;ep=grp_R2-4-015;et=core.rd-group;
          base="coap://[ff05::1]";rt=core.rd-ep
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-26">Figure 26</a>:
<a class="selfRef" href="#name-example-of-a-lookup-exchang">Example of a Lookup Exchange to Find Suitable Multicast Addresses</a>
            </figcaption></figure>
</div>
<p id="section-10.1.2-13">From the returned base parameter value, the luminary learns the multicast address
of the multicast group.<a class="pilcrow" href="#section-10.1.2-13">Â¶</a></p>
<p id="section-10.1.2-14">The presence sensor can learn the presence of groups that support resources with rt=tag:example.com,2020:light in its own sector by sending the same request, as used by the luminary. The presence sensor learns the multicast address to use for sending messages to the luminaries.<a class="pilcrow" href="#section-10.1.2-14">Â¶</a></p>
</section>
</div>
</section>
</div>
<div id="lwm2m-ex">
<section id="section-10.2">
        <h3 id="name-oma-lightweight-m2m-lwm2m">
<a class="section-number selfRef" href="#section-10.2">10.2. </a><a class="section-name selfRef" href="#name-oma-lightweight-m2m-lwm2m">OMA Lightweight M2M (LwM2M)</a>
        </h3>
<p id="section-10.2-1">OMA LwM2M is a profile for device services based on CoAP, providing interfaces and operations for device management and device service enablement.<a class="pilcrow" href="#section-10.2-1">Â¶</a></p>
<p id="section-10.2-2">An LwM2M server is an instance of an LwM2M middleware service layer, containing an RD (<span>[<a class="xref" href="#LwM2M">LwM2M</a>]</span>, starting at page 36).<a class="pilcrow" href="#section-10.2-2">Â¶</a></p>
<p id="section-10.2-3">That RD only implements the registration interface, and no lookup is implemented.
Instead, the LwM2M server provides access to the registered resources in a similar way to a reverse proxy.<a class="pilcrow" href="#section-10.2-3">Â¶</a></p>
<p id="section-10.2-4">The location of the LwM2M server and RD URI path is provided by the LwM2M bootstrap process, so no dynamic discovery of the RD is used. LwM2M servers and endpoints are not required to implement the <code>/.well-known/core</code> resource.<a class="pilcrow" href="#section-10.2-4">Â¶</a></p>
</section>
</div>
</section>
</div>
<section id="section-11">
      <h2 id="name-references">
<a class="section-number selfRef" href="#section-11">11. </a><a class="section-name selfRef" href="#name-references">References</a>
      </h2>
<section id="section-11.1">
        <h3 id="name-normative-references">
<a class="section-number selfRef" href="#section-11.1">11.1. </a><a class="section-name selfRef" href="#name-normative-references">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time class="refDate" datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3986">[RFC3986]</dt>
        <dd>
<span class="refAuthor">Berners-Lee, T.</span>, <span class="refAuthor">Fielding, R.</span>, and <span class="refAuthor">L. Masinter</span>, <span class="refTitle">"Uniform Resource Identifier (URI): Generic Syntax"</span>, <span class="seriesInfo">STD 66</span>, <span class="seriesInfo">RFC 3986</span>, <span class="seriesInfo">DOI 10.17487/RFC3986</span>, <time class="refDate" datetime="2005-01">January 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3986">https://www.rfc-editor.org/info/rfc3986</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6570">[RFC6570]</dt>
        <dd>
<span class="refAuthor">Gregorio, J.</span>, <span class="refAuthor">Fielding, R.</span>, <span class="refAuthor">Hadley, M.</span>, <span class="refAuthor">Nottingham, M.</span>, and <span class="refAuthor">D. Orchard</span>, <span class="refTitle">"URI Template"</span>, <span class="seriesInfo">RFC 6570</span>, <span class="seriesInfo">DOI 10.17487/RFC6570</span>, <time class="refDate" datetime="2012-03">March 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6570">https://www.rfc-editor.org/info/rfc6570</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6690">[RFC6690]</dt>
        <dd>
<span class="refAuthor">Shelby, Z.</span>, <span class="refTitle">"Constrained RESTful Environments (CoRE) Link Format"</span>, <span class="seriesInfo">RFC 6690</span>, <span class="seriesInfo">DOI 10.17487/RFC6690</span>, <time class="refDate" datetime="2012-08">August 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6690">https://www.rfc-editor.org/info/rfc6690</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6763">[RFC6763]</dt>
        <dd>
<span class="refAuthor">Cheshire, S.</span> and <span class="refAuthor">M. Krochmal</span>, <span class="refTitle">"DNS-Based Service Discovery"</span>, <span class="seriesInfo">RFC 6763</span>, <span class="seriesInfo">DOI 10.17487/RFC6763</span>, <time class="refDate" datetime="2013-02">February 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6763">https://www.rfc-editor.org/info/rfc6763</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7230">[RFC7230]</dt>
        <dd>
<span class="refAuthor">Fielding, R., Ed.</span> and <span class="refAuthor">J. Reschke, Ed.</span>, <span class="refTitle">"Hypertext Transfer Protocol (HTTP/1.1): Message Syntax and Routing"</span>, <span class="seriesInfo">RFC 7230</span>, <span class="seriesInfo">DOI 10.17487/RFC7230</span>, <time class="refDate" datetime="2014-06">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7230">https://www.rfc-editor.org/info/rfc7230</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7252">[RFC7252]</dt>
        <dd>
<span class="refAuthor">Shelby, Z.</span>, <span class="refAuthor">Hartke, K.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"The Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 7252</span>, <span class="seriesInfo">DOI 10.17487/RFC7252</span>, <time class="refDate" datetime="2014-06">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7252">https://www.rfc-editor.org/info/rfc7252</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time class="refDate" datetime="2017-06">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time class="refDate" datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8288">[RFC8288]</dt>
        <dd>
<span class="refAuthor">Nottingham, M.</span>, <span class="refTitle">"Web Linking"</span>, <span class="seriesInfo">RFC 8288</span>, <span class="seriesInfo">DOI 10.17487/RFC8288</span>, <time class="refDate" datetime="2017-10">October 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8288">https://www.rfc-editor.org/info/rfc8288</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9175">[RFC9175]</dt>
      <dd>
<span class="refAuthor">AmsÃ¼ss, C.</span>, <span class="refAuthor">PreuÃ Mattsson, J.</span>, and <span class="refAuthor">G. Selander</span>, <span class="refTitle">"Constrained Application Protocol (CoAP): Echo, Request-Tag, and Token Processing"</span>, <span class="seriesInfo">RFC 9175</span>, <span class="seriesInfo">DOI 10.17487/RFC9175</span>, <time class="refDate" datetime="2022-02">February 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9175">https://www.rfc-editor.org/info/rfc9175</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-11.2">
        <h3 id="name-informative-references">
<a class="section-number selfRef" href="#section-11.2">11.2. </a><a class="section-name selfRef" href="#name-informative-references">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-ace-oauth-authz">[ACE-OAUTH-AUTHZ]</dt>
        <dd>
<span class="refAuthor">Seitz, L.</span>, <span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Wahlstroem, E.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"Authentication and Authorization for Constrained Environments (ACE) using the OAuth 2.0 Framework (ACE-OAuth)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-ace-oauth-authz-46</span>, <time class="refDate" datetime="2021-11-08">8 November 2021</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oauth-authz-46">https://datatracker.ietf.org/doc/html/draft-ietf-ace-oauth-authz-46</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.silverajan-core-coap-protocol-negotiation">[COAP-PROT-NEG]</dt>
        <dd>
<span class="refAuthor">Silverajan, B.</span> and <span class="refAuthor">M. Ocak</span>, <span class="refTitle">"CoAP Protocol Negotiation"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-silverajan-core-coap-protocol-negotiation-09</span>, <time class="refDate" datetime="2018-07-02">2 July 2018</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-silverajan-core-coap-protocol-negotiation-09">https://datatracker.ietf.org/doc/html/draft-silverajan-core-coap-protocol-negotiation-09</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-core-coral">[CORE-CORAL]</dt>
        <dd>
<span class="refAuthor">AmsÃ¼ss, C.</span> and <span class="refAuthor">T. Fossati</span>, <span class="refTitle">"The Constrained RESTful Application Language (CoRAL)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-core-coral-05</span>, <time class="refDate" datetime="2022-03-07">7 March 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-coral-05">https://datatracker.ietf.org/doc/html/draft-ietf-core-coral-05</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-core-links-json">[CORE-LINKS-JSON]</dt>
        <dd>
<span class="refAuthor">Li, K.</span>, <span class="refAuthor">Rahman, A.</span>, and <span class="refAuthor">C. Bormann, Ed.</span>, <span class="refTitle">"Representing Constrained RESTful Environments (CoRE) Link Format in JSON and CBOR"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-core-links-json-10</span>, <time class="refDate" datetime="2018-02-26">26 February 2018</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-links-json-10">https://datatracker.ietf.org/doc/html/draft-ietf-core-links-json-10</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-core-rd-dns-sd">[CORE-RD-DNS-SD]</dt>
        <dd>
<span class="refAuthor">van der Stok, P.</span>, <span class="refAuthor">Koster, M.</span>, and <span class="refAuthor">C. Amsuess</span>, <span class="refTitle">"CoRE Resource Directory: DNS-SD mapping"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-core-rd-dns-sd-05</span>, <time class="refDate" datetime="2019-07-07">7 July 2019</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-rd-dns-sd-05">https://datatracker.ietf.org/doc/html/draft-ietf-core-rd-dns-sd-05</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ER">[ER]</dt>
        <dd>
<span class="refAuthor">Chen, P.</span>, <span class="refTitle">"The entity-relationship model--toward a unified view of data"</span>, <span class="refContent">ACM Transactions on Database Systems, Vol. 1, pp. 9-36</span>, <span class="seriesInfo">DOI 10.1145/320434.320440</span>, <time class="refDate" datetime="1976-03">March 1976</time>, <span>&lt;<a href="https://doi.org/10.1145/320434.320440">https://doi.org/10.1145/320434.320440</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="LwM2M">[LwM2M]</dt>
        <dd>
<span class="refAuthor">Open Mobile Alliance</span>, <span class="refTitle">"Lightweight Machine to Machine Technical Specification: Transport Bindings (Candidate Version 1.1)"</span>, <time class="refDate" datetime="2018-06">June 2018</time>, <span>&lt;<a href="https://openmobilealliance.org/RELEASE/LightweightM2M/V1_1-20180612-C/OMA-TS-LightweightM2M_Transport-V1_1-20180612-C.pdf">https://openmobilealliance.org/RELEASE/LightweightM2M/V1_1-20180612-C/OMA-TS-LightweightM2M_Transport-V1_1-20180612-C.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3306">[RFC3306]</dt>
        <dd>
<span class="refAuthor">Haberman, B.</span> and <span class="refAuthor">D. Thaler</span>, <span class="refTitle">"Unicast-Prefix-based IPv6 Multicast Addresses"</span>, <span class="seriesInfo">RFC 3306</span>, <span class="seriesInfo">DOI 10.17487/RFC3306</span>, <time class="refDate" datetime="2002-08">August 2002</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3306">https://www.rfc-editor.org/info/rfc3306</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3307">[RFC3307]</dt>
        <dd>
<span class="refAuthor">Haberman, B.</span>, <span class="refTitle">"Allocation Guidelines for IPv6 Multicast Addresses"</span>, <span class="seriesInfo">RFC 3307</span>, <span class="seriesInfo">DOI 10.17487/RFC3307</span>, <time class="refDate" datetime="2002-08">August 2002</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3307">https://www.rfc-editor.org/info/rfc3307</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3849">[RFC3849]</dt>
        <dd>
<span class="refAuthor">Huston, G.</span>, <span class="refAuthor">Lord, A.</span>, and <span class="refAuthor">P. Smith</span>, <span class="refTitle">"IPv6 Address Prefix Reserved for Documentation"</span>, <span class="seriesInfo">RFC 3849</span>, <span class="seriesInfo">DOI 10.17487/RFC3849</span>, <time class="refDate" datetime="2004-07">July 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3849">https://www.rfc-editor.org/info/rfc3849</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4122">[RFC4122]</dt>
        <dd>
<span class="refAuthor">Leach, P.</span>, <span class="refAuthor">Mealling, M.</span>, and <span class="refAuthor">R. Salz</span>, <span class="refTitle">"A Universally Unique IDentifier (UUID) URN Namespace"</span>, <span class="seriesInfo">RFC 4122</span>, <span class="seriesInfo">DOI 10.17487/RFC4122</span>, <time class="refDate" datetime="2005-07">July 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4122">https://www.rfc-editor.org/info/rfc4122</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4944">[RFC4944]</dt>
        <dd>
<span class="refAuthor">Montenegro, G.</span>, <span class="refAuthor">Kushalnagar, N.</span>, <span class="refAuthor">Hui, J.</span>, and <span class="refAuthor">D. Culler</span>, <span class="refTitle">"Transmission of IPv6 Packets over IEEE 802.15.4 Networks"</span>, <span class="seriesInfo">RFC 4944</span>, <span class="seriesInfo">DOI 10.17487/RFC4944</span>, <time class="refDate" datetime="2007-09">September 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4944">https://www.rfc-editor.org/info/rfc4944</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5771">[RFC5771]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Vegoda, L.</span>, and <span class="refAuthor">D. Meyer</span>, <span class="refTitle">"IANA Guidelines for IPv4 Multicast Address Assignments"</span>, <span class="seriesInfo">BCP 51</span>, <span class="seriesInfo">RFC 5771</span>, <span class="seriesInfo">DOI 10.17487/RFC5771</span>, <time class="refDate" datetime="2010-03">March 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5771">https://www.rfc-editor.org/info/rfc5771</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6724">[RFC6724]</dt>
        <dd>
<span class="refAuthor">Thaler, D., Ed.</span>, <span class="refAuthor">Draves, R.</span>, <span class="refAuthor">Matsumoto, A.</span>, and <span class="refAuthor">T. Chown</span>, <span class="refTitle">"Default Address Selection for Internet Protocol Version 6 (IPv6)"</span>, <span class="seriesInfo">RFC 6724</span>, <span class="seriesInfo">DOI 10.17487/RFC6724</span>, <time class="refDate" datetime="2012-09">September 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6724">https://www.rfc-editor.org/info/rfc6724</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6775">[RFC6775]</dt>
        <dd>
<span class="refAuthor">Shelby, Z., Ed.</span>, <span class="refAuthor">Chakrabarti, S.</span>, <span class="refAuthor">Nordmark, E.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"Neighbor Discovery Optimization for IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs)"</span>, <span class="seriesInfo">RFC 6775</span>, <span class="seriesInfo">DOI 10.17487/RFC6775</span>, <time class="refDate" datetime="2012-11">November 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6775">https://www.rfc-editor.org/info/rfc6775</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6874">[RFC6874]</dt>
        <dd>
<span class="refAuthor">Carpenter, B.</span>, <span class="refAuthor">Cheshire, S.</span>, and <span class="refAuthor">R. Hinden</span>, <span class="refTitle">"Representing IPv6 Zone Identifiers in Address Literals and Uniform Resource Identifiers"</span>, <span class="seriesInfo">RFC 6874</span>, <span class="seriesInfo">DOI 10.17487/RFC6874</span>, <time class="refDate" datetime="2013-02">February 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6874">https://www.rfc-editor.org/info/rfc6874</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7228">[RFC7228]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span>, <span class="refAuthor">Ersue, M.</span>, and <span class="refAuthor">A. Keranen</span>, <span class="refTitle">"Terminology for Constrained-Node Networks"</span>, <span class="seriesInfo">RFC 7228</span>, <span class="seriesInfo">DOI 10.17487/RFC7228</span>, <time class="refDate" datetime="2014-05">May 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7228">https://www.rfc-editor.org/info/rfc7228</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7641">[RFC7641]</dt>
        <dd>
<span class="refAuthor">Hartke, K.</span>, <span class="refTitle">"Observing Resources in the Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 7641</span>, <span class="seriesInfo">DOI 10.17487/RFC7641</span>, <time class="refDate" datetime="2015-09">September 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7641">https://www.rfc-editor.org/info/rfc7641</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8106">[RFC8106]</dt>
        <dd>
<span class="refAuthor">Jeong, J.</span>, <span class="refAuthor">Park, S.</span>, <span class="refAuthor">Beloeil, L.</span>, and <span class="refAuthor">S. Madanapalli</span>, <span class="refTitle">"IPv6 Router Advertisement Options for DNS Configuration"</span>, <span class="seriesInfo">RFC 8106</span>, <span class="seriesInfo">DOI 10.17487/RFC8106</span>, <time class="refDate" datetime="2017-03">March 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8106">https://www.rfc-editor.org/info/rfc8106</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8132">[RFC8132]</dt>
        <dd>
<span class="refAuthor">van der Stok, P.</span>, <span class="refAuthor">Bormann, C.</span>, and <span class="refAuthor">A. Sehgal</span>, <span class="refTitle">"PATCH and FETCH Methods for the Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 8132</span>, <span class="seriesInfo">DOI 10.17487/RFC8132</span>, <time class="refDate" datetime="2017-04">April 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8132">https://www.rfc-editor.org/info/rfc8132</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8141">[RFC8141]</dt>
        <dd>
<span class="refAuthor">Saint-Andre, P.</span> and <span class="refAuthor">J. Klensin</span>, <span class="refTitle">"Uniform Resource Names (URNs)"</span>, <span class="seriesInfo">RFC 8141</span>, <span class="seriesInfo">DOI 10.17487/RFC8141</span>, <time class="refDate" datetime="2017-04">April 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8141">https://www.rfc-editor.org/info/rfc8141</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8613">[RFC8613]</dt>
        <dd>
<span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Mattsson, J.</span>, <span class="refAuthor">Palombini, F.</span>, and <span class="refAuthor">L. Seitz</span>, <span class="refTitle">"Object Security for Constrained RESTful Environments (OSCORE)"</span>, <span class="seriesInfo">RFC 8613</span>, <span class="seriesInfo">DOI 10.17487/RFC8613</span>, <time class="refDate" datetime="2019-07">July 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8613">https://www.rfc-editor.org/info/rfc8613</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.bormann-t2trg-rel-impl">[T2TRG-REL-IMPL]</dt>
      <dd>
<span class="refAuthor">Bormann, C.</span>, <span class="refTitle">"impl-info: A link relation type for disclosing implementation information"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-bormann-t2trg-rel-impl-02</span>, <time class="refDate" datetime="2020-09-27">27 September 2020</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-bormann-t2trg-rel-impl-02">https://datatracker.ietf.org/doc/html/draft-bormann-t2trg-rel-impl-02</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="groups">
<section id="appendix-A">
      <h2 id="name-groups-registration-and-loo">
<a class="section-number selfRef" href="#appendix-A">Appendix A. </a><a class="section-name selfRef" href="#name-groups-registration-and-loo">Groups Registration and Lookup</a>
      </h2>
<p id="appendix-A-1">The RD-Group's usage pattern allows announcing application groups inside an RD.<a class="pilcrow" href="#appendix-A-1">Â¶</a></p>
<p id="appendix-A-2">Groups are represented by endpoint registrations.
      Their base address is a multicast address,
      and they <span class="bcp14">SHOULD</span> be entered with the endpoint type <code>core.rd-group</code>.
      The endpoint name can also be referred to as a group name in this context.<a class="pilcrow" href="#appendix-A-2">Â¶</a></p>
<p id="appendix-A-3">The registration is inserted into the RD by a Commissioning Tool,
      which might also be known as a group manager here.
      It performs third-party registration and registration updates.<a class="pilcrow" href="#appendix-A-3">Â¶</a></p>
<p id="appendix-A-4">The links it registers <span class="bcp14">SHOULD</span> be available on all members that join the group.
Depending on the application, members that lack some resources
<span class="bcp14">MAY</span> be permissible if requests to them fail gracefully.<a class="pilcrow" href="#appendix-A-4">Â¶</a></p>
<p id="appendix-A-5">The following example shows a CT registering a group with the name "lights", which provides two resources.
The directory resource path /rd
is an example RD location discovered in a request similar to <a class="xref" href="#example-discovery">Figure 5</a>.
The group address in the example is constructed from the reserved 2001:db8:: prefix in <span>[<a class="xref" href="#RFC3849">RFC3849</a>]</span> as a unicast-prefix-based site-local address (see <span>[<a class="xref" href="#RFC3306">RFC3306</a>]</span>).<a class="pilcrow" href="#appendix-A-5">Â¶</a></p>
<span id="name-example-registration-of-a-g"></span><div id="example-group-registration">
<figure id="figure-27">
        <div id="appendix-A-6.1">
<pre class="sourcecode">Req: POST coap://rd.example.com/rd?ep=lights&amp;et=core.rd-group
                           &amp;base=coap://[ff35:30:2001:db8:f1::8000:1]
Content-Format: 40
Payload:
&lt;/light&gt;;rt="tag:example.com,2020:light";
     if="tag:example.net,2020:actuator",
&lt;/color-temperature&gt;;if="tag:example.net,2020:parameter";u=K

Res: 2.01 Created
Location-Path: /rd/12
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-27">Figure 27</a>:
<a class="selfRef" href="#name-example-registration-of-a-g">Example Registration of a Group</a>
        </figcaption></figure>
</div>
<p id="appendix-A-7">In this example, the group manager can easily permit devices that have no
writable color-temperature to join, as they would still respond to brightness-changing commands. Had the group instead contained a single resource that sets
brightness and color-temperature atomically, endpoints would need to support
both properties.<a class="pilcrow" href="#appendix-A-7">Â¶</a></p>
<p id="appendix-A-8">The resources of a group can be looked up like any other resource,
and the group registrations (along with any additional registration parameters)
can be looked up using the endpoint lookup interface.<a class="pilcrow" href="#appendix-A-8">Â¶</a></p>
<p id="appendix-A-9">The following example shows a client performing an endpoint lookup for all groups:<a class="pilcrow" href="#appendix-A-9">Â¶</a></p>
<span id="name-example-lookup-of-groups"></span><div id="example-group-lookup">
<figure id="figure-28">
        <div id="appendix-A-10.1">
<pre class="sourcecode">Req: GET /rd-lookup/ep?et=core.rd-group

Res: 2.05 Content
Payload:
&lt;/rd/12&gt;;ep=lights&amp;et=core.rd-group;
         base="coap://[ff35:30:2001:f1:db8::8000:1]";rt=core.rd-ep
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-28">Figure 28</a>:
<a class="selfRef" href="#name-example-lookup-of-groups">Example Lookup of Groups</a>
        </figcaption></figure>
</div>
<p id="appendix-A-11">The following example shows a client performing a lookup of all resources of all endpoints (groups) with et=core.rd-group:<a class="pilcrow" href="#appendix-A-11">Â¶</a></p>
<span id="name-example-lookup-of-resources"></span><div id="example-group-lookup-res">
<figure id="figure-29">
        <div id="appendix-A-12.1">
<pre class="sourcecode">Req: GET /rd-lookup/res?et=core.rd-group

Res: 2.05 Content
Payload:
&lt;coap://[ff35:30:2001:db8:f1::8000:1]/light&gt;;
     rt="tag:example.com,2020:light";
     if="tag:example.net,2020:actuator",
&lt;coap://[ff35:30:2001:db8:f1::8000:1]/color-temperature&gt;;
     if="tag:example.net,2020:parameter";u=K,
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-29">Figure 29</a>:
<a class="selfRef" href="#name-example-lookup-of-resources">Example Lookup of Resources Inside Groups</a>
        </figcaption></figure>
</div>
</section>
</div>
<div id="weblink">
<section id="appendix-B">
      <h2 id="name-web-links-and-the-resource-">
<a class="section-number selfRef" href="#appendix-B">Appendix B. </a><a class="section-name selfRef" href="#name-web-links-and-the-resource-">Web Links and the Resource Directory</a>
      </h2>
<p id="appendix-B-1">Understanding the semantics of a link-format document and its URI references is
a journey through different documents (<span>[<a class="xref" href="#RFC3986">RFC3986</a>]</span> defining URIs, <span>[<a class="xref" href="#RFC6690">RFC6690</a>]</span>
defining link-format documents based on <span>[<a class="xref" href="#RFC8288">RFC8288</a>]</span>, which defines Link header fields,
and <span>[<a class="xref" href="#RFC7252">RFC7252</a>]</span> providing the transport). This appendix summarizes
the mechanisms and semantics at play from an entry in <code>/.well-known/core</code> to a
resource lookup.<a class="pilcrow" href="#appendix-B-1">Â¶</a></p>
<p id="appendix-B-2">This text is primarily aimed at people entering the field of Constrained
Restful Environments from applications that previously did not use web
mechanisms.<a class="pilcrow" href="#appendix-B-2">Â¶</a></p>
<div id="a-simple-example">
<section id="appendix-B.1">
        <h3 id="name-a-simple-example">
<a class="section-number selfRef" href="#appendix-B.1">B.1. </a><a class="section-name selfRef" href="#name-a-simple-example">A Simple Example</a>
        </h3>
<p id="appendix-B.1-1">Let's start this example with a very simple host, <code>2001:db8:f0::1</code>. A client
that follows classical CoAP discovery (<span>[<a class="xref" href="#RFC7252">RFC7252</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc7252#section-7">Section 7</a></span>) sends the
following multicast request to learn about neighbors supporting resources with
resource-type "temperature".<a class="pilcrow" href="#appendix-B.1-1">Â¶</a></p>
<p id="appendix-B.1-2">The client sends a link-local multicast:<a class="pilcrow" href="#appendix-B.1-2">Â¶</a></p>
<span id="name-example-of-direct-resource-"></span><div id="example-weblink-wkc">
<figure id="figure-30">
          <div id="appendix-B.1-3.1">
<pre class="sourcecode">Req: GET coap://[ff02::fd]:5683/.well-known/core?rt=temperature

Res: 2.05 Content
Payload:
&lt;/sensors/temp&gt;;rt=temperature;ct=0
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-30">Figure 30</a>:
<a class="selfRef" href="#name-example-of-direct-resource-">Example of Direct Resource Discovery</a>
          </figcaption></figure>
</div>
<p id="appendix-B.1-4">where the response is sent by the server, <code>[2001:db8:f0::1]:5683</code>.<a class="pilcrow" href="#appendix-B.1-4">Â¶</a></p>
<p id="appendix-B.1-5">While a practical client side implementation might just go
ahead and create a new request to <code>[2001:db8:f0::1]:5683</code> with Uri-Path
<code>sensors</code> and <code>temp</code>, the full resolution steps for insertion into and retrieval from the RD without any shortcuts are as follows.<a class="pilcrow" href="#appendix-B.1-5">Â¶</a></p>
<div id="resolveURI">
<section id="appendix-B.1.1">
          <h4 id="name-resolving-the-uris">
<a class="section-number selfRef" href="#appendix-B.1.1">B.1.1. </a><a class="section-name selfRef" href="#name-resolving-the-uris">Resolving the URIs</a>
          </h4>
<p id="appendix-B.1.1-1">The client parses the single returned link. Its target (sometimes
called "href") is <code>/sensors/temp</code>, which is a relative URI that needs resolving.
The base
URI <code>coap://[ff02::fd]:5683/.well-known/core</code> is used to resolve the
reference against <code>/sensors/temp</code>.<a class="pilcrow" href="#appendix-B.1.1-1">Â¶</a></p>
<p id="appendix-B.1.1-2">The base URI of the requested resource can be composed from the options of the CoAP GET request by following the steps of
<span>[<a class="xref" href="#RFC7252">RFC7252</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc7252#section-6.5">Section 6.5</a></span> (with an addition at the end of Section <a class="relref" href="https://www.rfc-editor.org/rfc/rfc7252#section-8.2">8.2</a>) into
<code>coap://[2001:db8:f0::1]/.well-known/core</code>.<a class="pilcrow" href="#appendix-B.1.1-2">Â¶</a></p>
<p id="appendix-B.1.1-3">Because <code>/sensors/temp</code> starts with a single slash,
the link's target is resolved by replacing the path <code>/.well-known/core</code>
from the base URI (<span>[<a class="xref" href="#RFC3986">RFC3986</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc3986#section-5.2">Section 5.2</a></span>) with the relative target URI <code>/sensors/temp</code> into
<code>coap://[2001:db8:f0::1]/sensors/temp</code>.<a class="pilcrow" href="#appendix-B.1.1-3">Â¶</a></p>
</section>
</div>
<div id="interpreting-attributes-and-relations">
<section id="appendix-B.1.2">
          <h4 id="name-interpreting-attributes-and">
<a class="section-number selfRef" href="#appendix-B.1.2">B.1.2. </a><a class="section-name selfRef" href="#name-interpreting-attributes-and">Interpreting Attributes and Relations</a>
          </h4>
<p id="appendix-B.1.2-1">Some more information about the link's target can be obtained from the payload:
the resource type of the target is "temperature", and its content format is
text/plain (ct=0).<a class="pilcrow" href="#appendix-B.1.2-1">Â¶</a></p>
<p id="appendix-B.1.2-2">A relation in a web link is a three-part statement that specifies a named relation between the so-called "context resource"
and the target resource, like "<em>This page</em> has <em>its table
of contents</em> at <em>/toc.html</em>". In link-format documents,
there is an implicit "host relation" specified with default parameter rel="hosts".<a class="pilcrow" href="#appendix-B.1.2-2">Â¶</a></p>
<p id="appendix-B.1.2-3">In our example, the context resource of the link is implied to be <code>coap:://[2001:db8:f0::1]</code>
by the default value of the anchor (see <a class="xref" href="#resolution-rules">Appendix B.4</a>).
A full English expression of the "host relation" is:<a class="pilcrow" href="#appendix-B.1.2-3">Â¶</a></p>
<p id="appendix-B.1.2-4" style="margin-left: 1.5em"><code>coap://[2001:db8:f0::1]</code> is hosting the resource
<code>coap://[2001:db8:f0::1]/sensors/temp</code>, which is of the resource type "temperature" and
can be read in the text/plain content format.<a class="pilcrow" href="#appendix-B.1.2-4">Â¶</a></p>
</section>
</div>
</section>
</div>
<div id="a-slightly-more-complex-example">
<section id="appendix-B.2">
        <h3 id="name-a-slightly-more-complex-exa">
<a class="section-number selfRef" href="#appendix-B.2">B.2. </a><a class="section-name selfRef" href="#name-a-slightly-more-complex-exa">A Slightly More Complex Example</a>
        </h3>
<p id="appendix-B.2-1">Omitting the <code>rt=temperature</code> filter, the discovery query would
have given some more links in the payload:<a class="pilcrow" href="#appendix-B.2-1">Â¶</a></p>
<span id="name-extended-example-of-direct-"></span><div id="example-weblink-wkc-extended">
<figure id="figure-31">
          <div id="appendix-B.2-2.1">
<pre class="sourcecode">Req: GET coap://[ff02::fd]:5683/.well-known/core

Res: 2.05 Content
Payload:
&lt;/sensors/temp&gt;;rt=temperature;ct=0,
&lt;/sensors/light&gt;;rt=light-lux;ct=0,
&lt;/t&gt;;anchor="/sensors/temp";rel=alternate,
&lt;http://www.example.com/sensors/t123&gt;;anchor="/sensors/temp";
    rel=describedby
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-31">Figure 31</a>:
<a class="selfRef" href="#name-extended-example-of-direct-">Extended Example of Direct Resource Discovery</a>
          </figcaption></figure>
</div>
<p id="appendix-B.2-3">Parsing the third link, the client encounters the "anchor" parameter. It is
a URI relative to the base URI of the request and is thus resolved to
<code>coap://[2001:db8:f0::1]/sensors/temp</code>.
That is the context resource of the link, so the "rel" statement is not about
the target and the base URI any more but about the target and the resolved
URI. Thus, the third link could be read as:<a class="pilcrow" href="#appendix-B.2-3">Â¶</a></p>
<p id="appendix-B.2-4" style="margin-left: 1.5em"><code>coap://[2001:db8:f0::1]/sensors/temp</code> has an alternate representation at
<code>coap://[2001:db8:f0::1]/t</code>.<a class="pilcrow" href="#appendix-B.2-4">Â¶</a></p>
<p id="appendix-B.2-5">Following the same resolution steps, the fourth link can be read as <code>coap://[2001:db8:f0::1]/sensors/temp</code> is
described by <code>http://www.example.com/sensors/t123</code>.<a class="pilcrow" href="#appendix-B.2-5">Â¶</a></p>
</section>
</div>
<div id="enter-the-resource-directory">
<section id="appendix-B.3">
        <h3 id="name-enter-the-resource-director">
<a class="section-number selfRef" href="#appendix-B.3">B.3. </a><a class="section-name selfRef" href="#name-enter-the-resource-director">Enter the Resource Directory</a>
        </h3>
<p id="appendix-B.3-1">The RD tries to carry the semantics obtainable by classical
 CoAP discovery over to the resource lookup interface as faithfully as possible.<a class="pilcrow" href="#appendix-B.3-1">Â¶</a></p>
<p id="appendix-B.3-2">For the following queries, we will assume that the simple host has used simple
 registration to register at the RD that was announced to it,
 sending this request from its UDP port <code>[2001:db8:f0::1]:6553</code>:<a class="pilcrow" href="#appendix-B.3-2">Â¶</a></p>
<span id="name-example-of-a-simple-registr"></span><div id="example-weblink-simple">
<figure id="figure-32">
          <div id="appendix-B.3-3.1">
<pre class="sourcecode">Req: POST coap://[2001:db8:f0::ff]/.well-known/rd?ep=simple-host1

Res: 2.04 Changed
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-32">Figure 32</a>:
<a class="selfRef" href="#name-example-of-a-simple-registr">Example of a Simple Registration</a>
          </figcaption></figure>
</div>
<p id="appendix-B.3-4">The RD would have accepted the registration and queried the
simple host's <code>/.well-known/core</code> by itself. As a result, the host is registered
as an endpoint in the RD with the name "simple-host1". The registration is
active for 90000 seconds, and the endpoint registration base URI is
<code>coap://[2001:db8:f0::1]</code>, following the resolution steps described in <a class="xref" href="#resolveURI">Appendix B.1.1</a>. It should be remarked that the base URI constructed that way always yields a URI of the form scheme://authority without path suffix.<a class="pilcrow" href="#appendix-B.3-4">Â¶</a></p>
<p id="appendix-B.3-5">If the client now queries the RD as it would previously have issued a multicast
request, it would go through the RD discovery steps by fetching
<code>coap://[2001:db8:f0::ff]/.well-known/core?rt=core.rd-lookup-res</code>, obtain
<code>coap://[2001:db8:f0::ff]/rd-lookup/res</code> as the resource lookup endpoint, and
ask it for all temperature resources:<a class="pilcrow" href="#appendix-B.3-5">Â¶</a></p>
<span id="name-example-exchange-performing"></span><div id="example-weblink-lookup-result">
<figure id="figure-33">
          <div id="appendix-B.3-6.1">
<pre class="sourcecode">Req: GET coap://[2001:db8:f0::ff]/rd-lookup/res?rt=temperature

Res: 2.05 Content
Payload:
&lt;coap://[2001:db8:f0::1]/sensors/temp&gt;;rt=temperature;ct=0
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-33">Figure 33</a>:
<a class="selfRef" href="#name-example-exchange-performing">Example Exchange Performing Resource Lookup</a>
          </figcaption></figure>
</div>
<p id="appendix-B.3-7">This is not <em>literally</em> the same response that it would have received from a
multicast request, but it contains the equivalent statement:<a class="pilcrow" href="#appendix-B.3-7">Â¶</a></p>
<p id="appendix-B.3-8" style="margin-left: 1.5em"><code>coap://[2001:db8:f0::1]</code> is hosting the resource
<code>coap://[2001:db8:f0::1]/sensors/temp</code>, which is of the resource type "temperature" and
can be accessed using the text/plain content format.<a class="pilcrow" href="#appendix-B.3-8">Â¶</a></p>
<p id="appendix-B.3-9">To complete the examples, the client could also query all resources hosted at
the endpoint with the known endpoint name "simple-host1":<a class="pilcrow" href="#appendix-B.3-9">Â¶</a></p>
<span id="name-extended-example-exchange-p"></span><div id="example-weblink-lookup-result-extended">
<figure id="figure-34">
          <div id="appendix-B.3-10.1">
<pre class="sourcecode">Req: GET coap://[2001:db8:f0::ff]/rd-lookup/res?ep=simple-host1

Res: 2.05 Content
Payload:
&lt;coap://[2001:db8:f0::1]/sensors/temp&gt;;rt=temperature;ct=0,
&lt;coap://[2001:db8:f0::1]/sensors/light&gt;;rt=light-lux;ct=0,
&lt;coap://[2001:db8:f0::1]/t&gt;;
    anchor="coap://[2001:db8:f0::1]/sensors/temp";rel=alternate,
&lt;http://www.example.com/sensors/t123&gt;;
    anchor="coap://[2001:db8:f0::1]/sensors/temp";rel=describedby
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-34">Figure 34</a>:
<a class="selfRef" href="#name-extended-example-exchange-p">Extended Example Exchange Performing Resource Lookup</a>
          </figcaption></figure>
</div>
<p id="appendix-B.3-11">All the target and anchor references are already in absolute form there, which
don't need to be resolved any further.<a class="pilcrow" href="#appendix-B.3-11">Â¶</a></p>
<p id="appendix-B.3-12">Had the simple host done an equivalent full registration with a base= parameter (e.g.,
<code>?ep=simple-host1&amp;base=coap+tcp://sh1.example.com</code>), that context would
have been used to resolve the relative anchor values instead, giving the following and analogous links:<a class="pilcrow" href="#appendix-B.3-12">Â¶</a></p>
<span id="name-example-payload-of-a-respon"></span><div id="example-weblink-lookup-result-base">
<figure id="figure-35">
          <div id="appendix-B.3-13.1">
<pre class="sourcecode">&lt;coap+tcp://sh1.example.com/sensors/temp&gt;;rt=temperature;ct=0
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-35">Figure 35</a>:
<a class="selfRef" href="#name-example-payload-of-a-respon">Example Payload of a Response to a Resource Lookup with a Dedicated Base URI</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="resolution-rules">
<section id="appendix-B.4">
        <h3 id="name-a-note-on-differences-betwe">
<a class="section-number selfRef" href="#appendix-B.4">B.4. </a><a class="section-name selfRef" href="#name-a-note-on-differences-betwe">A Note on Differences between Link-Format and Link Header Fields</a>
        </h3>
<p id="appendix-B.4-1">While link-format and Link header fields look very similar and are based on the same
model of typed links, there are some differences between <span>[<a class="xref" href="#RFC6690">RFC6690</a>]</span> and
<span>[<a class="xref" href="#RFC8288">RFC8288</a>]</span>.
When implementing an RD or interacting with an RD,
care must be taken to follow the behavior described in <span>[<a class="xref" href="#RFC6690">RFC6690</a>]</span>
whenever <code>application/link-format</code> representations are used.<a class="pilcrow" href="#appendix-B.4-1">Â¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B.4-2.1">
            <p id="appendix-B.4-2.1.1">"Default value of anchor":
Under both <span>[<a class="xref" href="#RFC6690">RFC6690</a>]</span> and <span>[<a class="xref" href="#RFC8288">RFC8288</a>]</span>,
relative references in the term inside the angle brackets (the target)
and the anchor attribute are resolved against the relevant base URI
(which usually is the URI used to retrieve the entity)
and independent of each other.<a class="pilcrow" href="#appendix-B.4-2.1.1">Â¶</a></p>
<p id="appendix-B.4-2.1.2">
When, in a Link header <span>[<a class="xref" href="#RFC8288">RFC8288</a>]</span>, the anchor attribute is absent,
the link's context is the URI of the selected representation
(and usually equal to the base URI).<a class="pilcrow" href="#appendix-B.4-2.1.2">Â¶</a></p>
<p id="appendix-B.4-2.1.3">
In links per <span>[<a class="xref" href="#RFC6690">RFC6690</a>]</span>, if the anchor attribute is absent,
the default value is the Origin of
(for all relevant cases, the URI reference <code>/</code> resolved against)
the link's target.<a class="pilcrow" href="#appendix-B.4-2.1.3">Â¶</a></p>
</li>
          <li class="normal" id="appendix-B.4-2.2">
            <p id="appendix-B.4-2.2.1">There is no percent encoding in link-format documents.<a class="pilcrow" href="#appendix-B.4-2.2.1">Â¶</a></p>
<p id="appendix-B.4-2.2.2">A link-format document is a UTF-8-encoded string of Unicode characters and
     does not have percent encoding, while Link header fields are practically ASCII
     strings that use percent encoding for non-ASCII characters, stating the
     encoding explicitly when required.<a class="pilcrow" href="#appendix-B.4-2.2.2">Â¶</a></p>
<p id="appendix-B.4-2.2.3">For example, while a Link header field in a page about a Swedish city might
     read:<a class="pilcrow" href="#appendix-B.4-2.2.3">Â¶</a></p>
<div id="appendix-B.4-2.2.4">
<pre class="lang-http-message sourcecode">Link: &lt;/temperature/Malm%C3%B6&gt;;rel=live-environment-data
</pre><a class="pilcrow" href="#appendix-B.4-2.2.4">Â¶</a>
</div>
<p id="appendix-B.4-2.2.5">
a link-format document from the same source might describe the link as:<a class="pilcrow" href="#appendix-B.4-2.2.5">Â¶</a></p>
<div id="appendix-B.4-2.2.6">
<pre class="sourcecode">&lt;/temperature/MalmÃ¶&gt;;rel=live-environment-data
</pre><a class="pilcrow" href="#appendix-B.4-2.2.6">Â¶</a>
</div>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="limitedlinkformat">
<section id="appendix-C">
      <h2 id="name-limited-link-format">
<a class="section-number selfRef" href="#appendix-C">Appendix C. </a><a class="section-name selfRef" href="#name-limited-link-format">Limited Link Format</a>
      </h2>
<p id="appendix-C-1">The CoRE Link Format, as described in <span>[<a class="xref" href="#RFC6690">RFC6690</a>]</span>,
has been interpreted differently by implementers,
and a strict implementation
rules out some use cases of an RD
(e.g., base values with path components in combination with absent anchors).<a class="pilcrow" href="#appendix-C-1">Â¶</a></p>
<p id="appendix-C-2">This appendix describes
a subset of link format documents called the Limited Link Format.
The one rule herein is not very limiting in practice --
all examples in <span>[<a class="xref" href="#RFC6690">RFC6690</a>]</span> and all deployments the authors are aware of already stick to them --
but eases the implementation of RD servers.<a class="pilcrow" href="#appendix-C-2">Â¶</a></p>
<p id="appendix-C-3">It is applicable to representations in the <code>application/link-format</code> media type
and any other media types that inherit <span>[<a class="xref" href="#RFC6690">RFC6690</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc6690#section-2.1">Section 2.1</a></span>.<a class="pilcrow" href="#appendix-C-3">Â¶</a></p>
<p id="appendix-C-4">A link format representation is in the Limited Link Format if,
for each link in it,
the following applies:<a class="pilcrow" href="#appendix-C-4">Â¶</a></p>
<p id="appendix-C-5">All URI references either follow the URI or the path-absolute ABNF rule of
  <span>[<a class="xref" href="#RFC3986">RFC3986</a>]</span> (i.e., the target and anchor each either start with a scheme or with a
  single slash).<a class="pilcrow" href="#appendix-C-5">Â¶</a></p>
</section>
</div>
<div id="acknowledgments">
<section id="appendix-D">
      <h2 id="name-acknowledgments">
<a class="section-name selfRef" href="#name-acknowledgments">Acknowledgments</a>
      </h2>
<p id="appendix-D-1"> <span class="contact-name">Oscar Novo</span>, <span class="contact-name">Srdjan Krco</span>, <span class="contact-name">Szymon Sasin</span>, <span class="contact-name">Kerry Lynn</span>, <span class="contact-name">Esko Dijk</span>, <span class="contact-name">Anders Brandt</span>, <span class="contact-name">Matthieu Vial</span>, <span class="contact-name">Jim Schaad</span>, <span class="contact-name">Mohit Sethi</span>, <span class="contact-name">Hauke Petersen</span>, <span class="contact-name">Hannes Tschofenig</span>, <span class="contact-name">Sampo Ukkola</span>, <span class="contact-name">Linyi Tian</span>, <span class="contact-name">Jan Newmarch</span>, <span class="contact-name">Matthias Kovatsch</span>, <span class="contact-name">Jaime Jimenez</span>, and <span class="contact-name">Ted Lemon</span> have provided helpful comments, discussions, and ideas to improve and shape this document. Zach would also like to thank his colleagues from the EU FP7 SENSEI project, where many of the RD concepts were originally developed.<a class="pilcrow" href="#appendix-D-1">Â¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-E">
      <h2 id="name-authors-addresses">
<a class="section-name selfRef" href="#name-authors-addresses">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Christian AmsÃ¼ss (<span class="role">editor</span>)</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:christian@amsuess.com">christian@amsuess.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Zach Shelby</span></div>
<div class="left" dir="auto"><span class="org">Edge Impulse</span></div>
<div class="left" dir="auto"><span class="street-address">3031 Tisch Way</span></div>
<div class="left" dir="auto">
<span class="locality">San Jose</span>,  <span class="postal-code">95128</span>
</div>
<div class="left" dir="auto"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:zach@edgeimpulse.com">zach@edgeimpulse.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Michael Koster</span></div>
<div class="left" dir="auto"><span class="org">PassiveLogic</span></div>
<div class="left" dir="auto"><span class="street-address">524 H Street</span></div>
<div class="left" dir="auto">
<span class="locality">Antioch</span>, <span class="region">CA</span> <span class="postal-code">94509</span>
</div>
<div class="left" dir="auto"><span class="country-name">United States of America</span></div>
<div class="tel">
<span>Phone:</span>
<a class="tel" href="tel:+1-707-502-5136">+1-707-502-5136</a>
</div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:michaeljohnkoster@gmail.com">michaeljohnkoster@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Carsten Bormann</span></div>
<div class="left" dir="auto"><span class="org">UniversitÃ¤t Bremen TZI</span></div>
<div class="left" dir="auto"><span class="street-address">Postfach 330440</span></div>
<div class="left" dir="auto">
<span class="postal-code">D-28359</span> <span class="locality">Bremen</span>
</div>
<div class="left" dir="auto"><span class="country-name">Germany</span></div>
<div class="tel">
<span>Phone:</span>
<a class="tel" href="tel:+49-421-218-63921">+49-421-218-63921</a>
</div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:cabo@tzi.org">cabo@tzi.org</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Peter van der Stok</span></div>
<div class="left" dir="auto"><span class="org">vanderstok consultancy</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:stokcons@bbhmail.nl">stokcons@bbhmail.nl</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>


</body></html>