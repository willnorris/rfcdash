<html><head></head><body><pre>Internet Engineering Task Force (IETF)                             D. Ma
Request for Comments: 8416                                          ZDNS
Category: Standards Track                                  D. Mandelberg
ISSN: 2070-1721                                             Unaffiliated
                                                          T. Bruijnzeels
                                                              NLnet Labs
                                                             August 2018


   <span class="h1">Simplified Local Internet Number Resource Management with the RPKI</span>
                                <span class="h1">(SLURM)</span>

Abstract

   The Resource Public Key Infrastructure (RPKI) is a global
   authorization infrastructure that allows the holder of Internet
   Number Resources (INRs) to make verifiable statements about those
   resources.  Network operators, e.g., Internet Service Providers
   (ISPs), can use the RPKI to validate BGP route origin assertions.
   ISPs can also use the RPKI to validate the path of a BGP route.
   However, ISPs may want to establish a local view of exceptions to the
   RPKI data in the form of local filters and additions.  The mechanisms
   described in this document provide a simple way to enable INR holders
   to establish a local, customized view of the RPKI, overriding global
   RPKI repository data as needed.

Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in <a href="./rfc7841#section-2">Section 2 of RFC 7841</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="https://www.rfc-editor.org/info/rfc8416">https://www.rfc-editor.org/info/rfc8416</a>.












<span class="grey">Ma, et al.                   Standards Track                    [Page 1]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-2"></span>
<span class="grey"><a href="./rfc8416">RFC 8416</a>                          SLURM                      August 2018</span>


Copyright Notice

   Copyright (c) 2018 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://www.rfc-editor.org/bcp/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-3">3</a>
      <a href="#section-1.1">1.1</a>. Terminology ................................................<a href="#page-4">4</a>
   <a href="#section-2">2</a>. RP with SLURM ...................................................<a href="#page-4">4</a>
   <a href="#section-3">3</a>. SLURM Files and Mechanisms ......................................<a href="#page-5">5</a>
      <a href="#section-3.1">3.1</a>. Use of JSON ................................................<a href="#page-5">5</a>
      <a href="#section-3.2">3.2</a>. SLURM File Overview ........................................<a href="#page-5">5</a>
      <a href="#section-3.3">3.3</a>. Validation Output Filters ..................................<a href="#page-6">6</a>
           <a href="#section-3.3.1">3.3.1</a>. Validated ROA Prefix Filters ........................<a href="#page-6">6</a>
           <a href="#section-3.3.2">3.3.2</a>. BGPsec Assertion Filters ............................<a href="#page-7">7</a>
      <a href="#section-3.4">3.4</a>. Locally Added Assertions ...................................<a href="#page-9">9</a>
           <a href="#section-3.4.1">3.4.1</a>. ROA Prefix Assertions ...............................<a href="#page-9">9</a>
           <a href="#section-3.4.2">3.4.2</a>. BGPsec Assertions ..................................<a href="#page-10">10</a>
      <a href="#section-3.5">3.5</a>. Example of a SLURM File with Filters and Assertions .......<a href="#page-11">11</a>
   <a href="#section-4">4</a>. SLURM File Configuration .......................................<a href="#page-13">13</a>
      <a href="#section-4.1">4.1</a>. SLURM File Atomicity ......................................<a href="#page-13">13</a>
      <a href="#section-4.2">4.2</a>. Multiple SLURM Files ......................................<a href="#page-13">13</a>
   <a href="#section-5">5</a>. IANA Considerations ............................................<a href="#page-14">14</a>
   <a href="#section-6">6</a>. Security Considerations ........................................<a href="#page-14">14</a>
   <a href="#section-7">7</a>. References .....................................................<a href="#page-14">14</a>
      <a href="#section-7.1">7.1</a>. Normative References ......................................<a href="#page-14">14</a>
      <a href="#section-7.2">7.2</a>. Informative References ....................................<a href="#page-16">16</a>
   Acknowledgments ...................................................<a href="#page-17">17</a>
   Authors' Addresses ................................................<a href="#page-17">17</a>











<span class="grey">Ma, et al.                   Standards Track                    [Page 2]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-3"></span>
<span class="grey"><a href="./rfc8416">RFC 8416</a>                          SLURM                      August 2018</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" id="section-1">1</a>.  Introduction</span>

   The Resource Public Key Infrastructure (RPKI) is a global
   authorization infrastructure that allows the holder of Internet
   Number Resources (INRs) to make verifiable statements about those
   resources.  For example, the holder of a block of IP(v4 or v6)
   addresses can issue a Route Origin Authorization (ROA) [<a href="./rfc6482" title='"A Profile for Route Origin Authorizations (ROAs)"'>RFC6482</a>] to
   authorize an Autonomous System (AS) to originate routes for that
   block.  Internet Service Providers (ISPs) can then use the RPKI to
   validate BGP routes.  (Validation of the origin of a route is
   described in [<a href="./rfc6811" title='"BGP Prefix Origin Validation"'>RFC6811</a>], and validation of the path of a route is
   described in [<a href="./rfc8205" title='"BGPsec Protocol Specification"'>RFC8205</a>].)

   However, an RPKI Relying Party (RP) may want to override some of the
   information expressed via configured Trust Anchors (TAs) and the
   certificates downloaded from the RPKI repository system.  For
   instance, [<a href="./rfc6491" title='"Resource Public Key Infrastructure (RPKI) Objects Issued by IANA"'>RFC6491</a>] recommends the creation of ROAs that would
   invalidate public routes for reserved and unallocated address space,
   yet some ISPs might like to use BGP and the RPKI with private address
   space (see [<a href="./rfc1918" title='"Address Allocation for Private Internets"'>RFC1918</a>], [<a href="./rfc4193" title='"Unique Local IPv6 Unicast Addresses"'>RFC4193</a>], and [<a href="./rfc6598" title='"IANA-Reserved IPv4 Prefix for Shared Address Space"'>RFC6598</a>]) or private AS numbers
   (see [<a href="./rfc1930" title='"Guidelines for creation, selection, and registration of an Autonomous System (AS)"'>RFC1930</a>] and [<a href="./rfc6996" title='"Autonomous System (AS) Reservation for Private Use"'>RFC6996</a>]).  Local use of private address space
   and/or AS numbers is consistent with the RFCs cited above, but such
   use cannot be verified by the global RPKI.  This motivates creation
   of mechanisms that enable a network operator to publish, at its
   discretion, an exception to the RPKI in the form of filters and
   additions (for its own use and that of its customers).  Additionally,
   a network operator might wish to make use of a local override
   capability to protect routes from adverse actions [<a href="./rfc8211" title='"Adverse Actions by a Certification Authority (CA) or Repository Manager in the Resource Public Key Infrastructure (RPKI)"'>RFC8211</a>], until
   the results of such actions have been addressed.  The mechanisms
   developed to provide this capability to network operators are hereby
   called "Simplified Local Internet Number Resource Management with the
   RPKI (SLURM)".

   SLURM allows an operator to create a local view of the global RPKI by
   generating sets of assertions.  For origin validation [<a href="./rfc6811" title='"BGP Prefix Origin Validation"'>RFC6811</a>], an
   assertion is a tuple of {IP prefix, prefix length, maximum length,
   Autonomous System Number (ASN)} as used by the RPKI-Router protocol,
   version 0 [<a href="./rfc6810" title='"The Resource Public Key Infrastructure (RPKI) to Router Protocol"'>RFC6810</a>] and version 1 [<a href="./rfc8210" title='"The Resource Public Key Infrastructure (RPKI) to Router Protocol, Version 1"'>RFC8210</a>].  For BGPsec [<a href="./rfc8205" title='"BGPsec Protocol Specification"'>RFC8205</a>],
   an assertion is a tuple of {ASN, subject key identifier, router
   public key} as used by version 1 of the RPKI-Router protocol.  (For
   the remainder of this document, these assertions are called "ROA
   Prefix Assertions" and "BGPsec Assertions", respectively.)









<span class="grey">Ma, et al.                   Standards Track                    [Page 3]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-4"></span>
<span class="grey"><a href="./rfc8416">RFC 8416</a>                          SLURM                      August 2018</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/1.1.%20%20Terminology"></a><a class="selflink" href="#section-1.1" id="section-1.1">1.1</a>.  Terminology</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in
   <a href="https://www.rfc-editor.org/bcp/bcp14">BCP 14</a> [<a href="./rfc2119" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>] [<a href="./rfc8174" title='"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"'>RFC8174</a>] when, and only when, they appear in all
   capitals, as shown here.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/2.%20%20RP%20with%20SLURM"></a><a class="selflink" href="#section-2" id="section-2">2</a>.  RP with SLURM</span>

   SLURM provides a simple way to enable an RP to establish a local,
   customized view of the RPKI, overriding RPKI repository data if
   needed.  To that end, an RP with SLURM filters out (i.e., removes
   from consideration for routing decisions) any assertions in the RPKI
   that are overridden by local ROA Prefix Assertions and BGPsec
   Assertions.

   In general, the primary output of an RP is the data it sends to
   routers over the RPKI-Router protocol [<a href="./rfc8210" title='"The Resource Public Key Infrastructure (RPKI) to Router Protocol, Version 1"'>RFC8210</a>].  The RPKI-Router
   protocol enables routers to query an RP for all assertions it knows
   about (Reset Query) or for an update of only the changes in
   assertions (Serial Query).  The mechanisms specified in this document
   are to be applied to the result set for a Reset Query and to both the
   old and new sets that are compared for a Serial Query.  RP software
   may modify other forms of output in comparable ways, but that is
   outside the scope of this document.

   +--------------+   +---------------------------+   +------------+
   |              |   |                           |   |            |
   | Repositories +---&gt;Local cache of RPKI objects+---&gt; Validation |
   |              |   |                           |   |            |
   +--------------+   +---------------------------+   +-----+------+
                                                            |
          +-------------------------------------------------+
          |
   +------v-------+   +------------+   +-----------+   +-------------+
   |              |   |            |   |           |   |             |
   |    SLURM     +---&gt;   SLURM    +---&gt;RPKI-Router+---&gt; BGP Speakers|
   |   Filters    |   | Assertions |   | Protocol  |   |             |
   +--------------+   +------------+   +-----------+   +-------------+

                Figure 1: SLURM's Position in the RP Stack









<span class="grey">Ma, et al.                   Standards Track                    [Page 4]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-5"></span>
<span class="grey"><a href="./rfc8416">RFC 8416</a>                          SLURM                      August 2018</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.%20%20SLURM%20Files%20and%20Mechanisms"></a><a class="selflink" href="#section-3" id="section-3">3</a>.  SLURM Files and Mechanisms</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.1.%20%20Use%20of%20JSON"></a><a class="selflink" href="#section-3.1" id="section-3.1">3.1</a>.  Use of JSON</span>

   SLURM filters and assertions are specified in JSON format [<a href="./rfc8259" title='"The JavaScript Object Notation (JSON) Data Interchange Format"'>RFC8259</a>].
   JSON members that are not defined here MUST NOT be used in SLURM
   files.  An RP MUST consider any deviations from the specifications to
   be errors.  Future additions to the specifications in this document
   MUST use an incremented value for the "slurmVersion" member.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.2.%20%20SLURM%20File%20Overview"></a><a class="selflink" href="#section-3.2" id="section-3.2">3.2</a>.  SLURM File Overview</span>

   A SLURM file consists of a single JSON object containing the
   following members:

   o  A "slurmVersion" member that MUST be set to 1, encoded as a number

   o  A "validationOutputFilters" member (<a href="#section-3.3">Section 3.3</a>), whose value is
      an object.  The object MUST contain exactly two members:

      *  A "prefixFilters" member, whose value is described in
         <a href="#section-3.3.1">Section 3.3.1</a>.

      *  A "bgpsecFilters" member, whose value is described in
         <a href="#section-3.3.2">Section 3.3.2</a>.

   o  A "locallyAddedAssertions" member (<a href="#section-3.4">Section 3.4</a>), whose value is an
      object.  The object MUST contain exactly two members:

      *  A "prefixAssertions" member, whose value is described in
         <a href="#section-3.4.1">Section 3.4.1</a>.

      *  A "bgpsecAssertions" member, whose value is described in
         <a href="#section-3.4.2">Section 3.4.2</a>.

   In the envisioned typical use case, an RP uses both Validation Output
   Filters and Locally Added Assertions.  In this case, the resulting
   assertions MUST be the same as if output filtering were performed
   before locally adding assertions; that is, Locally Added Assertions
   MUST NOT be removed by output filtering.

   The following JSON structure with JSON members represents a SLURM
   file that has no filters or assertions:








<span class="grey">Ma, et al.                   Standards Track                    [Page 5]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-6"></span>
<span class="grey"><a href="./rfc8416">RFC 8416</a>                          SLURM                      August 2018</span>


   {
     "slurmVersion": 1,
     "validationOutputFilters": {
       "prefixFilters": [],
       "bgpsecFilters": []
     },
     "locallyAddedAssertions": {
       "prefixAssertions": [],
       "bgpsecAssertions": []
     }
   }

                        Figure 2: Empty SLURM File

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.3.%20%20Validation%20Output%20Filters"></a><a class="selflink" href="#section-3.3" id="section-3.3">3.3</a>.  Validation Output Filters</span>

<span class="h4"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.3.1.%20%20Validated%20ROA%20Prefix%20Filters"></a><a class="selflink" href="#section-3.3.1" id="section-3.3.1">3.3.1</a>.  Validated ROA Prefix Filters</span>

   The RP can configure zero or more Validated ROA Prefix Filters
   ("Prefix Filters" for short).  Each Prefix Filter can contain either
   an IPv4 or IPv6 prefix and/or an ASN.  It is RECOMMENDED that an
   explanatory comment is included with each Prefix Filter so that it
   can be shown to users of the RP software.

   The above is expressed as a value of the "prefixFilters" member, as
   an array of zero or more objects.  Each object MUST contain either 1)
   one of the following members or 2) one of each of the following
   members.

   o  A "prefix" member, whose value is a string representing either an
      IPv4 prefix (see <a href="./rfc4632#section-3.1">Section 3.1 of [RFC4632]</a>) or an IPv6 prefix (see
      [<a href="./rfc5952" title='"A Recommendation for IPv6 Address Text Representation"'>RFC5952</a>]).

   o  An "asn" member, whose value is a number.

   In addition, each object MAY contain one optional "comment" member,
   whose value is a string.

   The following example JSON structure represents a "prefixFilters"
   member with an array of example objects for each use case listed
   above:










<span class="grey">Ma, et al.                   Standards Track                    [Page 6]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-7"></span>
<span class="grey"><a href="./rfc8416">RFC 8416</a>                          SLURM                      August 2018</span>


           "prefixFilters": [
             {
               "prefix": "192.0.2.0/24",
               "comment": "All VRPs encompassed by prefix"
             },
             {
               "asn": 64496,
               "comment": "All VRPs matching ASN"
             },
             {
               "prefix": "198.51.100.0/24",
               "asn": 64497,
               "comment": "All VRPs encompassed by prefix, matching ASN"
             }
           ]

                    Figure 3: "prefixFilters" Examples

   Any Validated ROA Payload (VRP) [<a href="./rfc6811" title='"BGP Prefix Origin Validation"'>RFC6811</a>] that matches any configured
   Prefix Filter MUST be removed from the RP's output.

   A VRP is considered to match with a Prefix Filter if one of the
   following cases applies:

   1.  If the Prefix Filter only contains an IPv4 or IPv6 prefix, the
       VRP is considered to match the filter if the VRP prefix is equal
       to or covered by the Prefix Filter prefix.

   2.  If the Prefix Filter only contains an ASN, the VRP is considered
       to match the filter if the VRP ASN matches the Prefix Filter ASN.

   3.  If the Prefix Filter contains both an IPv4 or IPv6 prefix and an
       ASN, the VRP is considered to match if the VRP prefix is equal to
       or covered by the Prefix Filter prefix and the VRP ASN matches
       the Prefix Filter ASN.

<span class="h4"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.3.2.%20%20BGPsec%20Assertion%20Filters"></a><a class="selflink" href="#section-3.3.2" id="section-3.3.2">3.3.2</a>.  BGPsec Assertion Filters</span>

   The RP can configure zero or more BGPsec Assertion Filters ("BGPsec
   Filters" for short).  Each BGPsec Filter can contain an ASN and/or
   the Base64 [<a href="./rfc4648" title='"The Base16, Base32, and Base64 Data Encodings"'>RFC4648</a>] encoding of a Router Subject Key Identifier
   (SKI), as described in [<a href="./rfc8209" title='"A Profile for BGPsec Router Certificates, Certificate Revocation Lists, and Certification Requests"'>RFC8209</a>] and [<a href="./rfc6487" title='"A Profile for X.509 PKIX Resource Certificates"'>RFC6487</a>].  It is RECOMMENDED
   that an explanatory comment is also included with each BGPsec Filter,
   so that it can be shown to users of the RP software.

   The above is expressed as a value of the "bgpsecFilters" member, as
   an array of zero or more objects.  Each object MUST contain one of
   either, or one each of both following members:



<span class="grey">Ma, et al.                   Standards Track                    [Page 7]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-8"></span>
<span class="grey"><a href="./rfc8416">RFC 8416</a>                          SLURM                      August 2018</span>


   o  An "asn" member, whose value is a number

   o  An "SKI" member, whose value is the Base64 encoding without
      trailing '=' (<a href="./rfc4648#section-5">Section 5 of [RFC4648]</a>) of the certificate's Subject
      Key Identifier as described in <a href="./rfc6487#section-4.8.2">Section 4.8.2 of [RFC6487]</a>.  (This
      is the value of the ASN.1 OCTET STRING without the ASN.1 tag or
      length fields.)

   In addition, each object MAY contain one optional "comment" member,
   whose value is a string.

   The following example JSON structure represents a "bgpsecFilters"
   member with an array of example objects for each use case listed
   above:

           "bgpsecFilters": [
             {
               "asn": 64496,
               "comment": "All keys for ASN"
             },
             {
               "SKI": "&lt;Base 64 of some SKI&gt;",
               "comment": "Key matching Router SKI"
             },
             {
               "asn": 64497,
               "SKI": "&lt;Base 64 of some SKI&gt;",
               "comment": "Key for ASN 64497 matching Router SKI"
             }
           ]

                    Figure 4: "bgpsecFilters" Examples

   Any BGPsec Assertion that matches any configured BGPsec Filter MUST
   be removed from the RP's output.  A BGPsec Assertion is considered to
   match with a BGPsec Filter if one of the following cases applies:

   1.  If the BGPsec Filter only contains an ASN, a BGPsec Assertion is
       considered to match if the Assertion ASN matches the Filter ASN.

   2.  If the BGPsec Filter only contains an SKI, a BGPsec Assertion is
       considered to match if the Assertion Router SKI matches the
       Filter SKI.

   3.  If the BGPsec Filter contains both an ASN and a Router SKI, then
       a BGPsec Assertion is considered to match if both the Assertion
       ASN matches the Filter ASN and the Assertion Router SKI matches
       the Filter SKI.



<span class="grey">Ma, et al.                   Standards Track                    [Page 8]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-9"></span>
<span class="grey"><a href="./rfc8416">RFC 8416</a>                          SLURM                      August 2018</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.4.%20%20Locally%20Added%20Assertions"></a><a class="selflink" href="#section-3.4" id="section-3.4">3.4</a>.  Locally Added Assertions</span>

<span class="h4"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.4.1.%20%20ROA%20Prefix%20Assertions"></a><a class="selflink" href="#section-3.4.1" id="section-3.4.1">3.4.1</a>.  ROA Prefix Assertions</span>

   Each RP is locally configured with a (possibly empty) array of ROA
   Prefix Assertions ("Prefix Assertions" for short).  Each ROA Prefix
   Assertion MUST contain an IPv4 or IPv6 prefix and an ASN.  It MAY
   include a value for the maximum length.  It is RECOMMENDED that an
   explanatory comment is also included with each so that it can be
   shown to users of the RP software.

   The above is expressed as a value of the "prefixAssertions" member,
   as an array of zero or more objects.  Each object MUST contain one of
   each of the following members:

   o  A "prefix" member, whose value is a string representing either an
      IPv4 prefix (see <a href="./rfc4632#section-3.1">Section 3.1 of [RFC4632]</a>) or an IPv6 prefix (see
      [<a href="./rfc5952" title='"A Recommendation for IPv6 Address Text Representation"'>RFC5952</a>]).

   o  An "asn" member, whose value is a number.

   In addition, each object MAY contain one of each of the following
   members:

   o  A "maxPrefixLength" member, whose value is a number.

   o  A "comment" member, whose value is a string.

   The following example JSON structure represents a "prefixAssertions"
   member with an array of example objects for each use case listed
   above:

     "prefixAssertions": [
       {
         "asn": 64496,
         "prefix": "198.51.100.0/24",
         "comment": "My other important route"
       },
       {
         "asn": 64496,
         "prefix": "2001:DB8::/32",
         "maxPrefixLength": 48,
         "comment": "My other important de-aggregated routes"
       }
     ]

                   Figure 5: "prefixAssertions" Examples




<span class="grey">Ma, et al.                   Standards Track                    [Page 9]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-10"></span>
<span class="grey"><a href="./rfc8416">RFC 8416</a>                          SLURM                      August 2018</span>


   Note that the combination of the prefix, ASN, and optional maximum
   length describes a VRP as described in [<a href="./rfc6811" title='"BGP Prefix Origin Validation"'>RFC6811</a>].  The RP MUST add
   all Prefix Assertions found this way to the VRP found through RPKI
   validation and ensure that it sends the complete set of Protocol Data
   Units (PDUs), excluding duplicates when using the RPKI-Router
   protocol (see Sections <a href="#section-5.6">5.6</a> and <a href="#section-5.7">5.7</a> of [<a href="./rfc8210" title='"The Resource Public Key Infrastructure (RPKI) to Router Protocol, Version 1"'>RFC8210</a>]).

<span class="h4"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.4.2.%20%20BGPsec%20Assertions"></a><a class="selflink" href="#section-3.4.2" id="section-3.4.2">3.4.2</a>.  BGPsec Assertions</span>

   Each RP is locally configured with a (possibly empty) array of BGPsec
   Assertions.  Each BGPsec Assertion MUST contain an AS number, a
   Router SKI, and the router public key.  It is RECOMMENDED that an
   explanatory comment is also included so that it can be shown to users
   of the RP software.

   The above is expressed as a value of the "bgpsecAssertions" member,
   as an array of zero or more objects.  Each object MUST contain one
   each of all of the following members:

   o  An "asn" member, whose value is a number.

   o  An "SKI" member, whose value is the Base64 encoding without
      trailing '=' (<a href="./rfc4648#section-5">Section 5 of [RFC4648]</a>) of the certificate's Subject
      Key Identifier as described in <a href="./rfc6487#section-4.8.2">Section 4.8.2 of [RFC6487]</a> (This is
      the value of the ASN.1 OCTET STRING without the ASN.1 tag or
      length fields.)

   o  A "routerPublicKey" member, whose value is the Base64 encoding
      without trailing '=' (<a href="./rfc4648#section-5">Section 5 of [RFC4648]</a>) of the equivalent to
      the subjectPublicKeyInfo value of the router certificate's public
      key, as described in [<a href="./rfc8208" title='"BGPsec Algorithms, Key Formats, and Signature Formats"'>RFC8208</a>].  This is the full ASN.1 DER
      encoding of the subjectPublicKeyInfo, including the ASN.1 tag and
      length values of the subjectPublicKeyInfo SEQUENCE.

   The following example JSON structure represents a "bgpsecAssertions"
   member with one object as described above:

     "bgpsecAssertions": [
       {
         "asn": 64496,
         "SKI": "&lt;some base64 SKI&gt;",
         "routerPublicKey": "&lt;some base64 public key&gt;",
         "comment": "My known key for my important ASN"
       }
     ]

                   Figure 6: "bgpsecAssertions" Examples




<span class="grey">Ma, et al.                   Standards Track                   [Page 10]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-11"></span>
<span class="grey"><a href="./rfc8416">RFC 8416</a>                          SLURM                      August 2018</span>


   Note that a "bgpsecAssertions" member matches the syntax of the
   Router Key PDU described in <a href="./rfc8210#section-5.10">Section 5.10 of [RFC8210]</a>.  Relying
   Parties MUST add any "bgpsecAssertions" member thus found to the set
   of Router Key PDUs, excluding duplicates, when using the RPKI-Router
   protocol [<a href="./rfc8210" title='"The Resource Public Key Infrastructure (RPKI) to Router Protocol, Version 1"'>RFC8210</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.5.%20%20Example%20of%20a%20SLURM%20File%20with%20Filters%20and%20Assertions"></a><a class="selflink" href="#section-3.5" id="section-3.5">3.5</a>.  Example of a SLURM File with Filters and Assertions</span>

   The following JSON structure represents an example of a SLURM file
   that uses all the elements described in the previous sections:

     {
       "slurmVersion": 1,
       "validationOutputFilters": {
         "prefixFilters": [
           {
             "prefix": "192.0.2.0/24",
             "comment": "All VRPs encompassed by prefix"
           },
           {
             "asn": 64496,
             "comment": "All VRPs matching ASN"
           },
           {
             "prefix": "198.51.100.0/24",
             "asn": 64497,
             "comment": "All VRPs encompassed by prefix, matching ASN"
           }
         ],
         "bgpsecFilters": [
           {
             "asn": 64496,
             "comment": "All keys for ASN"
           },
           {
             "SKI": "Zm9v",
             "comment": "Key matching Router SKI"
           },
           {
             "asn": 64497,
             "SKI": "YmFy",
             "comment": "Key for ASN 64497 matching Router SKI"
           }
         ]
       },
       "locallyAddedAssertions": {
         "prefixAssertions": [
           {



<span class="grey">Ma, et al.                   Standards Track                   [Page 11]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-12"></span>
<span class="grey"><a href="./rfc8416">RFC 8416</a>                          SLURM                      August 2018</span>


             "asn": 64496,
             "prefix": "198.51.100.0/24",
             "comment": "My other important route"
           },
           {
             "asn": 64496,
             "prefix": "2001:DB8::/32",
             "maxPrefixLength": 48,
             "comment": "My other important de-aggregated routes"
           }
         ],
         "bgpsecAssertions": [
           {
             "asn": 64496,
             "comment" : "My known key for my important ASN",
             "SKI": "&lt;some base64 SKI&gt;",
             "routerPublicKey": "&lt;some base64 public key&gt;"
           }
         ]
       }
     }

                   Figure 7: Example of Full SLURM File




























<span class="grey">Ma, et al.                   Standards Track                   [Page 12]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-13"></span>
<span class="grey"><a href="./rfc8416">RFC 8416</a>                          SLURM                      August 2018</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/4.%20%20SLURM%20File%20Configuration"></a><a class="selflink" href="#section-4" id="section-4">4</a>.  SLURM File Configuration</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/4.1.%20%20SLURM%20File%20Atomicity"></a><a class="selflink" href="#section-4.1" id="section-4.1">4.1</a>.  SLURM File Atomicity</span>

   To ensure local consistency, the effect of SLURM MUST be atomic.
   That is, the output of the RP either MUST be the same as if a SLURM
   file were not used or MUST reflect the entire SLURM configuration.
   For an example of why this is required, consider the case of two
   local routes for the same prefix but different origin ASNs.  Both
   routes are configured with Locally Added Assertions.  If neither
   addition occurs, then both routes could be in the NotFound state
   [<a href="./rfc6811" title='"BGP Prefix Origin Validation"'>RFC6811</a>].  If both additions occur, then both routes would be in the
   Valid state.  However, if one addition occurs and the other does not,
   then one could be Invalid while the other is Valid.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/4.2.%20%20Multiple%20SLURM%20Files"></a><a class="selflink" href="#section-4.2" id="section-4.2">4.2</a>.  Multiple SLURM Files</span>

   An implementation MAY support the concurrent use of multiple SLURM
   files.  In this case, the resulting inputs to Validation Output
   Filters and Locally Added Assertions are the respective unions of the
   inputs from each file.  The envisioned typical use case for multiple
   files is when the files have distinct scopes.  For instance,
   operators of two distinct networks may resort to one RP system to
   frame routing decisions.  As such, they probably deliver SLURM files
   to this RP independently.  Before an RP configures SLURM files from
   different sources, it MUST make sure there is no internal conflict
   among the INR assertions in these SLURM files.  To do so, the RP
   SHOULD check the entries of each SLURM file with regard to overlaps
   of the INR assertions and report errors to the sources that created
   the SLURM files in question.  The RP gets multiple SLURM files as a
   set, and the whole set MUST be rejected in case of any overlaps among
   the SLURM files.

   If a problem is detected with the INR assertions in these SLURM
   files, the RP MUST NOT use them and SHOULD issue a warning as error
   report in the following cases:

   1.  There may be conflicting changes to ROA Prefix Assertions if an
       IP address X and distinct SLURM files Y and Z exist such that X
       is contained by any prefix in any "prefixAssertions" or
       "prefixFilters" in file Y and X is contained by any prefix in any
       "prefixAssertions" or "prefixFilters" in file Z.

   2.  There may be conflicting changes to BGPsec Assertions if an ASN X
       and distinct SLURM files Y and Z exist such that X is used in any
       "bgpsecAssertions" or "bgpsecFilters" in file Y and X is used in
       any "bgpsecAssertions" or "bgpsecFilters" in file Z.




<span class="grey">Ma, et al.                   Standards Track                   [Page 13]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-14"></span>
<span class="grey"><a href="./rfc8416">RFC 8416</a>                          SLURM                      August 2018</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.%20%20IANA%20Considerations"></a><a class="selflink" href="#section-5" id="section-5">5</a>.  IANA Considerations</span>

   This document has no IANA actions.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/6.%20%20Security%20Considerations"></a><a class="selflink" href="#section-6" id="section-6">6</a>.  Security Considerations</span>

   The mechanisms described in this document provide a network operator
   with additional ways to control use of RPKI data while preserving
   autonomy in address space and ASN management.  These mechanisms are
   only applied locally; they do not influence how other network
   operators interpret RPKI data.  Nonetheless, care should be taken in
   how these mechanisms are employed.  Note that it also is possible to
   use SLURM to (locally) manipulate assertions about non-private INRs,
   e.g., allocated address space that is globally routed.  For example,
   a SLURM file may be used to override RPKI data that a network
   operator believes has been corrupted by an adverse action.  Network
   operators who elect to use SLURM in this fashion should use extreme
   caution.

   The goal of the mechanisms described in this document is to enable an
   RP to create its own view of the RPKI, which is intrinsically a
   security function.  An RP using a SLURM file is trusting the
   assertions made in that file.  Errors in the SLURM file used by an RP
   can undermine the security offered to that RP by the RPKI.  A SLURM
   file could declare as invalid ROAs that would otherwise be valid, and
   vice versa.  As a result, an RP MUST carefully consider the security
   implications of the SLURM file being used, especially if the file is
   provided by a third party.

   Additionally, each RP using SLURM MUST ensure the authenticity and
   integrity of any SLURM file that it uses.  Initially, the SLURM file
   may be preconfigured out of band, but if the RP updates its SLURM
   file over the network, it MUST verify the authenticity and integrity
   of the updated SLURM file.  The mechanism to update the SLURM file to
   guarantee authenticity and integrity is out of the scope of this
   document.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/7.%20%20References"></a><a class="selflink" href="#section-7" id="section-7">7</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/7.1.%20%20Normative%20References"></a><a class="selflink" href="#section-7.1" id="section-7.1">7.1</a>.  Normative References</span>

   [<a id="ref-RFC2119">RFC2119</a>]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="https://www.rfc-editor.org/bcp/bcp14">BCP 14</a>, <a href="./rfc2119">RFC 2119</a>,
              DOI 10.17487/RFC2119, March 1997,
              &lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;.






<span class="grey">Ma, et al.                   Standards Track                   [Page 14]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-15"></span>
<span class="grey"><a href="./rfc8416">RFC 8416</a>                          SLURM                      August 2018</span>


   [<a id="ref-RFC4632">RFC4632</a>]  Fuller, V. and T. Li, "Classless Inter-domain Routing
              (CIDR): The Internet Address Assignment and Aggregation
              Plan", <a href="https://www.rfc-editor.org/bcp/bcp122">BCP 122</a>, <a href="./rfc4632">RFC 4632</a>, DOI 10.17487/RFC4632, August
              2006, &lt;<a href="https://www.rfc-editor.org/info/rfc4632">https://www.rfc-editor.org/info/rfc4632</a>&gt;.

   [<a id="ref-RFC4648">RFC4648</a>]  Josefsson, S., "The Base16, Base32, and Base64 Data
              Encodings", <a href="./rfc4648">RFC 4648</a>, DOI 10.17487/RFC4648, October 2006,
              &lt;<a href="https://www.rfc-editor.org/info/rfc4648">https://www.rfc-editor.org/info/rfc4648</a>&gt;.

   [<a id="ref-RFC5952">RFC5952</a>]  Kawamura, S. and M. Kawashima, "A Recommendation for IPv6
              Address Text Representation", <a href="./rfc5952">RFC 5952</a>,
              DOI 10.17487/RFC5952, August 2010,
              &lt;<a href="https://www.rfc-editor.org/info/rfc5952">https://www.rfc-editor.org/info/rfc5952</a>&gt;.

   [<a id="ref-RFC6487">RFC6487</a>]  Huston, G., Michaelson, G., and R. Loomans, "A Profile for
              X.509 PKIX Resource Certificates", <a href="./rfc6487">RFC 6487</a>,
              DOI 10.17487/RFC6487, February 2012,
              &lt;<a href="https://www.rfc-editor.org/info/rfc6487">https://www.rfc-editor.org/info/rfc6487</a>&gt;.

   [<a id="ref-RFC6811">RFC6811</a>]  Mohapatra, P., Scudder, J., Ward, D., Bush, R., and R.
              Austein, "BGP Prefix Origin Validation", <a href="./rfc6811">RFC 6811</a>,
              DOI 10.17487/RFC6811, January 2013,
              &lt;<a href="https://www.rfc-editor.org/info/rfc6811">https://www.rfc-editor.org/info/rfc6811</a>&gt;.

   [<a id="ref-RFC8174">RFC8174</a>]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in <a href="./rfc2119">RFC</a>
              <a href="./rfc2119">2119</a> Key Words", <a href="https://www.rfc-editor.org/bcp/bcp14">BCP 14</a>, <a href="./rfc8174">RFC 8174</a>, DOI 10.17487/RFC8174,
              May 2017, &lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;.

   [<a id="ref-RFC8205">RFC8205</a>]  Lepinski, M., Ed. and K. Sriram, Ed., "BGPsec Protocol
              Specification", <a href="./rfc8205">RFC 8205</a>, DOI 10.17487/RFC8205, September
              2017, &lt;<a href="https://www.rfc-editor.org/info/rfc8205">https://www.rfc-editor.org/info/rfc8205</a>&gt;.

   [<a id="ref-RFC8208">RFC8208</a>]  Turner, S. and O. Borchert, "BGPsec Algorithms, Key
              Formats, and Signature Formats", <a href="./rfc8208">RFC 8208</a>,
              DOI 10.17487/RFC8208, September 2017,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8208">https://www.rfc-editor.org/info/rfc8208</a>&gt;.

   [<a id="ref-RFC8209">RFC8209</a>]  Reynolds, M., Turner, S., and S. Kent, "A Profile for
              BGPsec Router Certificates, Certificate Revocation Lists,
              and Certification Requests", <a href="./rfc8209">RFC 8209</a>,
              DOI 10.17487/RFC8209, September 2017,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8209">https://www.rfc-editor.org/info/rfc8209</a>&gt;.

   [<a id="ref-RFC8259">RFC8259</a>]  Bray, T., Ed., "The JavaScript Object Notation (JSON) Data
              Interchange Format", STD 90, <a href="./rfc8259">RFC 8259</a>,
              DOI 10.17487/RFC8259, December 2017,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8259">https://www.rfc-editor.org/info/rfc8259</a>&gt;.




<span class="grey">Ma, et al.                   Standards Track                   [Page 15]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-16"></span>
<span class="grey"><a href="./rfc8416">RFC 8416</a>                          SLURM                      August 2018</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/7.2.%20%20Informative%20References"></a><a class="selflink" href="#section-7.2" id="section-7.2">7.2</a>.  Informative References</span>

   [<a id="ref-RFC1918">RFC1918</a>]  Rekhter, Y., Moskowitz, B., Karrenberg, D., de Groot, G.,
              and E. Lear, "Address Allocation for Private Internets",
              <a href="https://www.rfc-editor.org/bcp/bcp5">BCP 5</a>, <a href="./rfc1918">RFC 1918</a>, DOI 10.17487/RFC1918, February 1996,
              &lt;<a href="https://www.rfc-editor.org/info/rfc1918">https://www.rfc-editor.org/info/rfc1918</a>&gt;.

   [<a id="ref-RFC1930">RFC1930</a>]  Hawkinson, J. and T. Bates, "Guidelines for creation,
              selection, and registration of an Autonomous System (AS)",
              <a href="https://www.rfc-editor.org/bcp/bcp6">BCP 6</a>, <a href="./rfc1930">RFC 1930</a>, DOI 10.17487/RFC1930, March 1996,
              &lt;<a href="https://www.rfc-editor.org/info/rfc1930">https://www.rfc-editor.org/info/rfc1930</a>&gt;.

   [<a id="ref-RFC4193">RFC4193</a>]  Hinden, R. and B. Haberman, "Unique Local IPv6 Unicast
              Addresses", <a href="./rfc4193">RFC 4193</a>, DOI 10.17487/RFC4193, October 2005,
              &lt;<a href="https://www.rfc-editor.org/info/rfc4193">https://www.rfc-editor.org/info/rfc4193</a>&gt;.

   [<a id="ref-RFC6482">RFC6482</a>]  Lepinski, M., Kent, S., and D. Kong, "A Profile for Route
              Origin Authorizations (ROAs)", <a href="./rfc6482">RFC 6482</a>,
              DOI 10.17487/RFC6482, February 2012,
              &lt;<a href="https://www.rfc-editor.org/info/rfc6482">https://www.rfc-editor.org/info/rfc6482</a>&gt;.

   [<a id="ref-RFC6491">RFC6491</a>]  Manderson, T., Vegoda, L., and S. Kent, "Resource Public
              Key Infrastructure (RPKI) Objects Issued by IANA",
              <a href="./rfc6491">RFC 6491</a>, DOI 10.17487/RFC6491, February 2012,
              &lt;<a href="https://www.rfc-editor.org/info/rfc6491">https://www.rfc-editor.org/info/rfc6491</a>&gt;.

   [<a id="ref-RFC6598">RFC6598</a>]  Weil, J., Kuarsingh, V., Donley, C., Liljenstolpe, C., and
              M. Azinger, "IANA-Reserved IPv4 Prefix for Shared Address
              Space", <a href="https://www.rfc-editor.org/bcp/bcp153">BCP 153</a>, <a href="./rfc6598">RFC 6598</a>, DOI 10.17487/RFC6598, April
              2012, &lt;<a href="https://www.rfc-editor.org/info/rfc6598">https://www.rfc-editor.org/info/rfc6598</a>&gt;.

   [<a id="ref-RFC6810">RFC6810</a>]  Bush, R. and R. Austein, "The Resource Public Key
              Infrastructure (RPKI) to Router Protocol", <a href="./rfc6810">RFC 6810</a>,
              DOI 10.17487/RFC6810, January 2013,
              &lt;<a href="https://www.rfc-editor.org/info/rfc6810">https://www.rfc-editor.org/info/rfc6810</a>&gt;.

   [<a id="ref-RFC6996">RFC6996</a>]  Mitchell, J., "Autonomous System (AS) Reservation for
              Private Use", <a href="https://www.rfc-editor.org/bcp/bcp6">BCP 6</a>, <a href="./rfc6996">RFC 6996</a>, DOI 10.17487/RFC6996, July
              2013, &lt;<a href="https://www.rfc-editor.org/info/rfc6996">https://www.rfc-editor.org/info/rfc6996</a>&gt;.

   [<a id="ref-RFC8210">RFC8210</a>]  Bush, R. and R. Austein, "The Resource Public Key
              Infrastructure (RPKI) to Router Protocol, Version 1",
              <a href="./rfc8210">RFC 8210</a>, DOI 10.17487/RFC8210, September 2017,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8210">https://www.rfc-editor.org/info/rfc8210</a>&gt;.







<span class="grey">Ma, et al.                   Standards Track                   [Page 16]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-17"></span>
<span class="grey"><a href="./rfc8416">RFC 8416</a>                          SLURM                      August 2018</span>


   [<a id="ref-RFC8211">RFC8211</a>]  Kent, S. and D. Ma, "Adverse Actions by a Certification
              Authority (CA) or Repository Manager in the Resource
              Public Key Infrastructure (RPKI)", <a href="./rfc8211">RFC 8211</a>,
              DOI 10.17487/RFC8211, September 2017,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8211">https://www.rfc-editor.org/info/rfc8211</a>&gt;.

Acknowledgments

   The authors would like to thank Stephen Kent for his guidance and
   detailed reviews of this document.  The authors would also like to
   thank Richard Hansen for his careful reviews and Hui Zou and Chunlin
   An for their editorial assistance.

Authors' Addresses

   Di Ma
   ZDNS
   4 South 4th St. Zhongguancun
   Haidian, Beijing  100190
   China

   Email: madi@zdns.cn


   David Mandelberg
   Unaffiliated

   Email: david@mandelberg.org
   URI:   <a href="https://david.mandelberg.org">https://david.mandelberg.org</a>


   Tim Bruijnzeels
   NLnet Labs
   Science Park 400
   Amsterdam  1098 XH
   The Netherlands

   Email: tim@nlnetlabs.nl













Ma, et al.                   Standards Track                   [Page 17]
</pre>
</body></html>