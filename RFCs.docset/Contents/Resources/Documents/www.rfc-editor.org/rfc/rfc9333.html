<!DOCTYPE html>
<html class="RFC" lang="en"><head>
<meta charset="utf-8"/>
<meta content="Common,Latin" name="scripts"/>
<meta content="initial-scale=1.0" name="viewport"/>
<title>RFC 9333: Minimal IP Encapsulating Security Payload (ESP)</title>
<meta content="Daniel Migault" name="author"/>
<meta content="Tobias Guggemos" name="author"/>
<meta content="
       
This document describes the minimal properties that an IP Encapsulating Security Payload (ESP) implementation needs to meet to remain interoperable with the standard ESP as defined in RFC 4303.
Such a minimal version of ESP is not intended to become a replacement of ESP in RFC 4303.
Instead, a minimal implementation is expected to be optimized for constrained environments while remaining interoperable with implementations of ESP.
In addition, this document provides some considerations for implementing minimal ESP in a constrained environment, such as limiting the number of flash writes, handling frequent wakeup and sleep states, limiting wakeup time, and reducing the use of random generation.  
        This document does not update or modify RFC 4303. It provides a compact description of how to implement the minimal version of that protocol.
RFC 4303 remains the authoritative description. 
    " name="description"/>
<meta content="xml2rfc 3.15.3" name="generator"/>
<meta content="9333" name="rfc.number"/>
<!-- Generator version information:
  xml2rfc 3.15.3
    Python 3.9.15
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.1
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 4.9.0
    MarkupSafe 2.1.1
    pycountry 22.3.5
    PyYAML 6.0
    requests 2.28.0
    setuptools 44.1.1
    six 1.16.0
    wcwidth 0.2.5
    weasyprint 56.1
-->
<link href="rfc9333.xml" rel="alternate" type="application/rfc+xml"/>
<link href="#copyright" rel="license"/>
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necessary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

:root {
  --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
  --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
  --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
}

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: var(--font-sans);
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
svg[font-family~="serif" i], svg [font-family~="serif" i] {
  font-family: var(--font-serif);
}
svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
  font-family: var(--font-sans);
}
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre {
  background-color: #f9f9f9;
  font-family: var(--font-mono);
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: var(--font-sans);
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  .breakable pre {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The following is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
.sourcecode pre,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .artwork > pre,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background slightly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottom margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the compact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div.sourcecode:first-child,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type:only-child {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css"/>
<link href="https://dx.doi.org/10.17487/rfc9333" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <link href="https://datatracker.ietf.org/doc/draft-ietf-lwig-minimal-esp-12" rel="prev"/>
  </head>
<body class="xml2rfc">
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 9333</td>
<td class="center">Minimal IP ESP</td>
<td class="right">January 2023</td>
</tr></thead>
<tfoot><tr>
<td class="left">Migault &amp; Guggemos</td>
<td class="center">Informational</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div class="document-information" id="external-metadata"></div>
<div class="document-information" id="internal-metadata">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a class="eref" href="https://www.rfc-editor.org/rfc/rfc9333">9333</a></dd>
<dt class="label-category">Category:</dt>
<dd class="category">Informational</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time class="published" datetime="2023-01">January 2023</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">D. Migault</div>
<div class="org">Ericsson</div>
</div>
<div class="author">
      <div class="author-name">T. Guggemos</div>
<div class="org">LMU Munich</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 9333</h1>
<h1 id="title">Minimal IP Encapsulating Security Payload (ESP)</h1>
<section id="section-abstract">
      <h2 id="abstract"><a class="selfRef" href="#abstract">Abstract</a></h2>
<p id="section-abstract-1">
This document describes the minimal properties that an IP Encapsulating Security Payload (ESP) implementation needs to meet to remain interoperable with the standard ESP as defined in RFC 4303.
Such a minimal version of ESP is not intended to become a replacement of ESP in RFC 4303.
Instead, a minimal implementation is expected to be optimized for constrained environments while remaining interoperable with implementations of ESP.
In addition, this document provides some considerations for implementing minimal ESP in a constrained environment, such as limiting the number of flash writes, handling frequent wakeup and sleep states, limiting wakeup time, and reducing the use of random generation.<a class="pilcrow" href="#section-abstract-1">¶</a></p>
<p id="section-abstract-2"> This document does not update or modify RFC 4303. It provides a compact description of how to implement the minimal version of that protocol.
RFC 4303 remains the authoritative description.<a class="pilcrow" href="#section-abstract-2">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a class="section-name selfRef" href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This document is not an Internet Standards Track specification; it is
            published for informational purposes.<a class="pilcrow" href="#section-boilerplate.1-1">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by the
            Internet Engineering Steering Group (IESG).  Not all documents
            approved by the IESG are candidates for any level of Internet
            Standard; see Section 2 of RFC 7841.<a class="pilcrow" href="#section-boilerplate.1-2">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc9333">https://www.rfc-editor.org/info/rfc9333</a></span>.<a class="pilcrow" href="#section-boilerplate.1-3">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a class="section-name selfRef" href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2023 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a class="pilcrow" href="#section-boilerplate.2-1">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a class="pilcrow" href="#section-boilerplate.2-2">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a class="toplink" href="#" onclick="scroll(0,0)">▲</a><h2 id="name-table-of-contents">
<a class="section-name selfRef" href="#name-table-of-contents">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p class="keepWithNext" id="section-toc.1-1.1.1"><a class="auto internal xref" href="#section-1">1</a>.  <a class="internal xref" href="#name-introduction">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p class="keepWithNext" id="section-toc.1-1.2.1"><a class="auto internal xref" href="#section-2">2</a>.  <a class="internal xref" href="#name-requirements-notation">Requirements Notation</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a class="auto internal xref" href="#section-3">3</a>.  <a class="internal xref" href="#name-security-parameters-index-s">Security Parameters Index (SPI)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p class="keepWithNext" id="section-toc.1-1.3.2.1.1"><a class="auto internal xref" href="#section-3.1">3.1</a>.  <a class="internal xref" href="#name-considerations-for-spi-gene">Considerations for SPI Generation</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a class="auto internal xref" href="#section-4">4</a>.  <a class="internal xref" href="#name-sequence-number-sn">Sequence Number (SN)</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a class="auto internal xref" href="#section-5">5</a>.  <a class="internal xref" href="#name-padding">Padding</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a class="auto internal xref" href="#section-6">6</a>.  <a class="internal xref" href="#name-next-header-and-dummy-packe">Next Header and "Dummy" Packets</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a class="auto internal xref" href="#section-7">7</a>.  <a class="internal xref" href="#name-icv">ICV</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a class="auto internal xref" href="#section-8">8</a>.  <a class="internal xref" href="#name-cryptographic-suites">Cryptographic Suites</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a class="auto internal xref" href="#section-9">9</a>.  <a class="internal xref" href="#name-iana-considerations">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a class="auto internal xref" href="#section-10">10</a>. <a class="internal xref" href="#name-security-considerations">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a class="auto internal xref" href="#section-11">11</a>. <a class="internal xref" href="#name-privacy-considerations">Privacy Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a class="auto internal xref" href="#section-12">12</a>. <a class="internal xref" href="#name-references">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a class="auto internal xref" href="#section-12.1">12.1</a>.  <a class="internal xref" href="#name-normative-references">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a class="auto internal xref" href="#section-12.2">12.2</a>.  <a class="internal xref" href="#name-informative-references">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a class="auto internal xref" href="#appendix-A"></a><a class="internal xref" href="#name-acknowledgments">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a class="auto internal xref" href="#appendix-B"></a><a class="internal xref" href="#name-authors-addresses">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<section id="section-1">
      <h2 id="name-introduction">
<a class="section-number selfRef" href="#section-1">1. </a><a class="section-name selfRef" href="#name-introduction">Introduction</a>
      </h2>
<p id="section-1-1">ESP <span>[<a class="cite xref" href="#RFC4303">RFC4303</a>]</span> is part of the IPsec protocol suite <span>[<a class="cite xref" href="#RFC4301">RFC4301</a>]</span>.
IPsec is used to provide confidentiality, data origin authentication, connectionless integrity, an anti-replay service, and limited Traffic Flow Confidentiality (TFC) padding.<a class="pilcrow" href="#section-1-1">¶</a></p>
<p id="section-1-2"><a class="auto internal xref" href="#fig-esp-description">Figure 1</a> describes an ESP packet.
Currently, ESP is implemented in the kernel of most major multipurpose Operating Systems (OSes).
ESP is usually implemented with all of its features to fit the multipurpose usage of these OSes, at the expense of resources and with no considerations for code size.
Constrained devices are likely to have their own implementation of ESP optimized and adapted to their specific use, such as limiting the number of flash writes (for each packet or across wake time), handling frequent wakeup and sleep states, limiting wakeup time, and reducing the use of random generation.
With the adoption of IPsec by Internet of Things (IoT) devices with minimal IKEv2 <span>[<a class="cite xref" href="#RFC7815">RFC7815</a>]</span> and ESP Header Compression (EHC) <span>[<a class="cite xref" href="#I-D.mglt-ipsecme-diet-esp">EHC-DIET-ESP</a>]</span> <span>[<a class="cite xref" href="#I-D.mglt-ipsecme-ikev2-diet-esp-extension">EHC-IKEv2</a>]</span>, these ESP implementations <span class="bcp14">MUST</span> remain interoperable with standard ESP implementations.
This document describes the minimal properties an ESP implementation needs to meet to remain interoperable with ESP <span>[<a class="cite xref" href="#RFC4303">RFC4303</a>]</span>.
In addition, this document provides advice to implementers for implementing ESP within constrained environments.
This document does not update or modify <span>[<a class="cite xref" href="#RFC4303">RFC4303</a>]</span>.<a class="pilcrow" href="#section-1-2">¶</a></p>
<p id="section-1-3">For each field of the ESP packet represented in <a class="auto internal xref" href="#fig-esp-description">Figure 1</a>, this document provides recommendations and guidance for minimal implementations.
The primary purpose of minimal ESP is to remain interoperable with other nodes implementing ESP <span>[<a class="cite xref" href="#RFC4303">RFC4303</a>]</span>, while limiting the standard complexity of the implementation.<a class="pilcrow" href="#section-1-3">¶</a></p>
<span id="name-esp-packet-description"></span><div id="fig-esp-description">
<figure id="figure-1">
        <div class="alignLeft art-text artwork" id="section-1-4.1">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ----
|               Security Parameters Index (SPI)                 | ^Int.
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ |Cov-
|                      Sequence Number                          | |ered
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ | ----
|                    Payload Data* (variable)                   | |   ^
~                                                               ~ |   |
|                                                               | |Conf.
+               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ |Cov-
|               |     Padding (0-255 bytes)                     | |ered*
+-+-+-+-+-+-+-+-+               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ |   |
|                               |  Pad Length   | Next Header   | v   v
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ------
|         Integrity Check Value (ICV) (variable)                |
~                                                               ~
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-1">Figure 1</a>:
<a class="selfRef" href="#name-esp-packet-description">ESP Packet Description</a>
        </figcaption></figure>
</div>
</section>
<section id="section-2">
      <h2 id="name-requirements-notation">
<a class="section-number selfRef" href="#section-2">2. </a><a class="section-name selfRef" href="#name-requirements-notation">Requirements Notation</a>
      </h2>
<p id="section-2-1">
    The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
    "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
    described in BCP 14 <span>[<a class="cite xref" href="#RFC2119">RFC2119</a>]</span> <span>[<a class="cite xref" href="#RFC8174">RFC8174</a>]</span> 
    when, and only when, they appear in all capitals, as shown here.<a class="pilcrow" href="#section-2-1">¶</a></p>
</section>
<div id="sec-spi">
<section id="section-3">
      <h2 id="name-security-parameters-index-s">
<a class="section-number selfRef" href="#section-3">3. </a><a class="section-name selfRef" href="#name-security-parameters-index-s">Security Parameters Index (SPI)</a>
      </h2>
<p id="section-3-1"> <span>[<a class="cite xref" href="#RFC4303">RFC4303</a>]</span> defines the SPI as a mandatory 32-bit field.<a class="pilcrow" href="#section-3-1">¶</a></p>
<p id="section-3-2"> The SPI has local significance to index the Security Association (SA).
As described in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc4301#section-4.1">Section 4.1</a> of [<a class="cite xref" href="#RFC4301">RFC4301</a>]</span>, nodes supporting only unicast communications can index their SA using only the SPI.
Nodes supporting multicast communications also require the use of IP
addresses; thus, SA lookup needs to be performed using the longest
match.<a class="pilcrow" href="#section-3-2">¶</a></p>
<p id="section-3-3"> For nodes supporting only unicast communications, indexing the SA using only the SPI is <span class="bcp14">RECOMMENDED</span>.
The index may be based on the full 32 bits of the SPI or a subset of these bits.
The node may require a combination of the SPI as well as other parameters (like the IP address) to index the SA.<a class="pilcrow" href="#section-3-3">¶</a></p>
<p id="section-3-4"> Values 0-255 <span class="bcp14">MUST NOT</span> be used.
As per <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc4303#section-2.1">Section 2.1</a> of [<a class="cite xref" href="#RFC4303">RFC4303</a>]</span>, values 1-255 are reserved, and 0 is only allowed to be used internally and <span class="bcp14">MUST NOT</span> be sent over the wire.<a class="pilcrow" href="#section-3-4">¶</a></p>
<p id="section-3-5"> <span>[<a class="cite xref" href="#RFC4303">RFC4303</a>]</span> does not require the 32-bit SPI to be randomly generated, although that is the <span class="bcp14">RECOMMENDED</span> way to generate SPIs as it provides some privacy and security benefits and avoids correlation between ESP communications.
To obtain a usable random 32-bit SPI, the node generates a random 32-bit value and checks it does not fall within the 0-255 range.
If the SPI has an acceptable value, it is used to index the inbound session.
Otherwise, the generated value is discarded, and the process repeats until a valid value is found.<a class="pilcrow" href="#section-3-5">¶</a></p>
<p id="section-3-6">Some constrained devices are less concerned with the privacy properties associated with randomly generated SPIs.
Examples of such devices might include sensors looking to reduce their code complexity.
The use of a predictive function to generate the SPI might be preferred over the generation and handling of random values.
An implementation of such predictable function could use the combination of a fixed value and the memory address of the Security Association Database (SAD) structure.
For every incoming packet, the node will be able to point to the SAD structure directly from the SPI value.
This avoids having a separate and additional binding and lookup function for the SPI to its SAD entry for every incoming packet.<a class="pilcrow" href="#section-3-6">¶</a></p>
<section id="section-3.1">
        <h3 id="name-considerations-for-spi-gene">
<a class="section-number selfRef" href="#section-3.1">3.1. </a><a class="section-name selfRef" href="#name-considerations-for-spi-gene">Considerations for SPI Generation</a>
        </h3>
<p id="section-3.1-1">SPIs that are not randomly generated over 32 bits may have privacy and security concerns.
As a result, the use of alternative designs requires careful security and privacy reviews.
This section provides some considerations for the adoption of alternative designs.<a class="pilcrow" href="#section-3.1-1">¶</a></p>
<p id="section-3.1-2">The SPI value is only looked up for inbound traffic.
The SPI negotiated with IKEv2 <span>[<a class="cite xref" href="#RFC7296">RFC7296</a>]</span> or minimal IKEv2 <span>[<a class="cite xref" href="#RFC7815">RFC7815</a>]</span> by a peer is the value used by the remote peer when it sends traffic.
The main advantage of using a rekeying mechanism is to enable a rekey, which is performed by replacing an old SA with a new SA, both indexed with distinct SPIs. 
The SPI is only used for inbound traffic by the peer, which allows each peer to manage the set of SPIs used for its inbound traffic. 
The necessary number of SPIs reflects the number of inbound SAs as well as the ability to rekey those SAs. Typically, rekeying an SA is performed by creating a new SA (with a dedicated SPI) before the old SA is deleted. This results in an additional SA and the need to support an additional SPI.
Similarly, the privacy concerns associated with the generation of non-random SPIs is also limited to the incoming traffic.<a class="pilcrow" href="#section-3.1-2">¶</a></p>
<p id="section-3.1-3">
Alternatively, some constrained devices will not implement IKEv2 or minimal IKEv2 and, as such, will not be able to manage a rollover between two distinct SAs. In addition, some of these constrained devices are likely to have a limited number of SAs; for example, they are likely to be indexed over 3 bytes only. One possible way to enable a rekeying mechanism with these devices is to use the SPI where, for example, the first 3 bytes designates the SA while the remaining byte indicates a rekey index.
SPI numbers can be used to implement tracking the inbound SAs when rekeying is taking place. When rekeying an SPI, the new SPI could use the SPI bytes to indicate the rekeying index.<a class="pilcrow" href="#section-3.1-3">¶</a></p>
<p id="section-3.1-4">The use of a small, limited set of SPI numbers across communications comes
with privacy and security concerns.  Some specific values or subsets of SPI
values could reveal the model or manufacturer of the node implementing ESP or
reveal a state such as "not yet rekeyed" or "rekeyed 10 times".  If a
constrained host uses a very limited number of applications, eventually a
single one, the SPI itself could indicate what kind of traffic is transmitted
(e.g., the kind of application typically running).  This could also be
correlated with encrypted data size to further leak information to an observer
on the network.  In addition, use of specific hardcoded SPI numbers could
reveal a manufacturer or device version. If updated devices use different SPI
numbers, an attacker could locate vulnerable devices by their use of specific
SPI numbers.<a class="pilcrow" href="#section-3.1-4">¶</a></p>
<p id="section-3.1-5">
A privacy analysis should consider at least the type of information as well as the traffic pattern before deciding whether non-random SPIs are safe to use.
Typically, temperature and wind sensors that are used outdoors do not leak privacy-sensitive information, and most of their traffic is expected to be outbound traffic.
When used indoors, a sensor that reports an encrypted status of a door (closed or opened) every minute might not leak sensitive information outside the local network.
In these examples, the privacy aspect of the information itself might be limited. Being able to determine the version of the sensor to potentially take control of it may also have some limited security consequences. Of course, this depends on the context in which these sensors are being used. If the risks associated to privacy and security are acceptable, a non-randomized SPI can be used.<a class="pilcrow" href="#section-3.1-5">¶</a></p>
</section>
</section>
</div>
<div id="sec-sn">
<section id="section-4">
      <h2 id="name-sequence-number-sn">
<a class="section-number selfRef" href="#section-4">4. </a><a class="section-name selfRef" href="#name-sequence-number-sn">Sequence Number (SN)</a>
      </h2>
<p id="section-4-1"> The Sequence Number (SN) in <span>[<a class="cite xref" href="#RFC4303">RFC4303</a>]</span> is a mandatory 32-bit field in the packet.<a class="pilcrow" href="#section-4-1">¶</a></p>
<p id="section-4-2"> The SN is set by the sender so the receiver can implement anti-replay protection.
The SN is derived from any strictly increasing function that guarantees the following: if packet B is sent after packet A, then the SN of packet B is higher than the SN of packet A.<a class="pilcrow" href="#section-4-2">¶</a></p>
<p id="section-4-3">Some constrained devices may establish communication with specific devices where it is known whether or not the peer implements anti-replay protection.
As per <span>[<a class="cite xref" href="#RFC4303">RFC4303</a>]</span>, the sender <span class="bcp14">MUST</span> still implement a strictly increasing function to generate the SN.<a class="pilcrow" href="#section-4-3">¶</a></p>
<p id="section-4-4">
  It is <span class="bcp14">RECOMMENDED</span> that multipurpose ESP implementations
  increment a counter for each packet sent.  However, a constrained device may
  avoid maintaining this context and use another source that is known to
  always increase.  Typically, constrained devices use 802.15.4 Time Slotted
  Channel Hopping (TSCH).  This communication is heavily dependent on time.  A
  constrained device can take advantage of this clock mechanism to generate
  the SN.  A lot of IoT devices are in a sleep state most of the time and wake
  up only to perform a specific operation before going back to sleep.  These
  devices have separate hardware that allows them to wake up after a certain
  timeout and typically also have timers that start running when the device is
  booted up, so they might have a concept of time with certain granularity.
  This requires devices to store any information in stable storage that can be
  restored across sleeps (e.g., flash memory).  Storing information associated
  with the SA (such as the SN) requires some read and write operations on
  stable storage after each packet is sent as opposed to an SPI number or
  cryptographic keys that are only written to stable storage at the creation
  of the SA.  Write operations wear out the flash storage.  Write operations
  also slow down the system significantly, as writing to flash is much slower
  than reading from flash.  While these devices have internal clocks or timers
  that might not be very accurate, they are good enough to guarantee that each
  time the device wakes up from sleep, the time is greater than what it was
  before the device went to sleep.  Using time for the SN would guarantee a
  strictly increasing function and avoid storing any additional values or
  context related to the SN on flash.  In addition to the time value, a
  RAM-based counter can be used to ensure that the serial numbers are still
  increasing and unique if the device sends multiple packets over an SA within
  one wakeup period.<a class="pilcrow" href="#section-4-4">¶</a></p>
<p id="section-4-5">For inbound traffic, it is <span class="bcp14">RECOMMENDED</span> that receivers
implement anti-replay protection.  The size of the window should depend on the
network characteristic to deliver packets out of order.  In an environment
where out-of-order packets are not possible, the window size can be set to
one.  An ESP implementation may choose to not implement anti-replay
protection.  An implementation of anti-replay protection may require the
device to write the received SN for every packet to stable storage.  This will
have the same issues as discussed earlier with the SN.  Some constrained
device implementations may choose to not implement the optional anti-replay
protection.  A typical example is an IoT device such as a temperature sensor
that sends a temperature measurement every 60 seconds and receives an
acknowledgment from the receiver.  In a case like this, the ability to spoof
and replay an acknowledgement is of limited interest and might not justify the
implementation of an anti-replay mechanism.  Receiving peers may also use an
ESP anti-replay mechanism adapted to a specific application.  Typically, when
the sending peer is using an SN based on time, anti-replay may be implemented
by discarding any packets that present an SN whose value is too much in the
past.  Such mechanisms may consider clock drifting in various ways in addition
to acceptable delay induced by the network to avoid the anti-replay windows
rejecting legitimate packets.  Receiving peers could accept any SN as long as it is higher
than the previously received SN.  Another mechanism could be used where only
the received time on the device is used to consider a packet to be valid,
without looking at the SN at all.<a class="pilcrow" href="#section-4-5">¶</a></p>
<p id="section-4-6">The SN can be represented as a 32-bit number or as a 64-bit number, known as an "Extended Sequence Number (ESN)".
As per <span>[<a class="cite xref" href="#RFC4303">RFC4303</a>]</span>, support of ESN is not mandatory, and its use is negotiated via IKEv2 <span>[<a class="cite xref" href="#RFC7296">RFC7296</a>]</span>.
An ESN is used for high-speed links to ensure there can be more than 2<sup>32</sup> packets before the SA needs to be rekeyed to prevent the SN from rolling over.
This assumes the SN is incremented by 1 for each packet.
When the SN is incremented differently -- such as when time is used -- rekeying needs to happen based on how the SN is incremented to prevent the SN from rolling over.
The security of all data protected under a given key decreases slightly with each message, and a node must ensure the limit is not reached, even though the SN would permit it.
Estimation of the maximum number of packets to be sent by a node is not always predictable, and large margins should be used, especially as nodes could be online for much more time than expected.
Even for constrained devices, it is <span class="bcp14">RECOMMENDED</span> to implement some rekeying mechanisms (see <a class="auto internal xref" href="#sec-security-considerations">Section 10</a>).<a class="pilcrow" href="#section-4-6">¶</a></p>
</section>
</div>
<div id="sec-padding">
<section id="section-5">
      <h2 id="name-padding">
<a class="section-number selfRef" href="#section-5">5. </a><a class="section-name selfRef" href="#name-padding">Padding</a>
      </h2>
<p id="section-5-1"> Padding is required to keep the 32-bit alignment of ESP.
It is also required for some encryption transforms that need a specific block size of input, such as ENCR_AES_CBC.
ESP specifies padding in the Pad Length byte, followed by up to 255 bytes of padding.<a class="pilcrow" href="#section-5-1">¶</a></p>
<p id="section-5-2"> Checking the padding structure is not mandatory, so constrained devices may omit these checks on received ESP packets.
For outgoing ESP packets, padding must be applied as required by ESP.<a class="pilcrow" href="#section-5-2">¶</a></p>
<p id="section-5-3"> In some situations, the padding bytes may take a fixed value.
This would typically be the case when the Payload Data is of fixed size.<a class="pilcrow" href="#section-5-3">¶</a></p>
<p id="section-5-4">ESP <span>[<a class="cite xref" href="#RFC4303">RFC4303</a>]</span> additionally provides Traffic Flow Confidentiality (TFC) as a way to perform padding to hide traffic characteristics.
TFC is not mandatory and is negotiated with the SA management protocol, such as IKEv2.
TFC has been widely implemented, but it is not widely deployed for ESP traffic.
It is <span class="bcp14">NOT RECOMMENDED</span> to implement TFC for minimal ESP.<a class="pilcrow" href="#section-5-4">¶</a></p>
<p id="section-5-5">As a consequence, communication protection that relies on TFC would be more
sensitive to traffic patterns without TFC.  This can leak application
information as well as the manufacturer or model of the device used to a
passive monitoring attacker.  Such information can be used, for example, by an
attacker if a vulnerability is known for the specific device or application.
In addition, some applications (such as health applications) could leak
important privacy-oriented information.<a class="pilcrow" href="#section-5-5">¶</a></p>
<p id="section-5-6">Constrained devices that have a limited battery lifetime may prefer to avoid sending extra padding bytes.
In most cases, the payload carried by these devices is quite small, and the standard padding mechanism can be used as an alternative to TFC.
Alternatively, any information leak based on the size -- or presence -- of the packet can also be addressed at the application level before the packet is encrypted with ESP.
If application packets vary between 1 to 30 bytes, the application could always send 32-byte responses to ensure all traffic sent is of identical length.
To prevent leaking information that a sensor changed state, such as "temperature changed" or "door opened", an application could send this information at regular time intervals, rather than when a specific event is happening, even if the sensor state did not change.<a class="pilcrow" href="#section-5-6">¶</a></p>
</section>
</div>
<div id="sec-nh">
<section id="section-6">
      <h2 id="name-next-header-and-dummy-packe">
<a class="section-number selfRef" href="#section-6">6. </a><a class="section-name selfRef" href="#name-next-header-and-dummy-packe">Next Header and "Dummy" Packets</a>
      </h2>
<p id="section-6-1">ESP <span>[<a class="cite xref" href="#RFC4303">RFC4303</a>]</span> defines the Next Header as a mandatory 8-bit field in the packet.
The Next Header, only visible after decryption, specifies the data contained in the payload.
In addition, the Next Header may carry an indication on how to process the packet <span>[<a class="cite xref" href="#I-D.nikander-esp-beet-mode">BEET-ESP</a>]</span>.
The Next Header can point to a "dummy" packet, i.e., a packet with the Next Header value set to 59, meaning "no next header".
The data following "no next header" is unstructured "dummy" data. (Note that this document uses the term "dummy" for consistency with <span>[<a class="cite xref" href="#RFC4303">RFC4303</a>]</span>.)<a class="pilcrow" href="#section-6-1">¶</a></p>
<p id="section-6-2">The ability to generate, receive, and ignore "dummy" packets is required by <span>[<a class="cite xref" href="#RFC4303">RFC4303</a>]</span>.
An implementation can omit ever generating and sending "dummy" packets.
For interoperability, a minimal ESP implementation <span class="bcp14">MUST</span> be able to process and discard "dummy" packets without indicating an error.<a class="pilcrow" href="#section-6-2">¶</a></p>
<p id="section-6-3">
In constrained environments, sending "dummy" packets may have too much impact on the device lifetime, in which case, "dummy" packets should not be generated and sent.

On the other hand, constrained devices running specific applications that would leak too much information by not generating and sending "dummy" packets may implement this functionality or even implement something similar at the application layer.
Note also that similarly to padding and TFC that can be used to hide some traffic characteristics (see <a class="auto internal xref" href="#sec-padding">Section 5</a>), "dummy" packets may also reveal some patterns that can be used to identify the application.
For example, an application may send "dummy" data to hide a traffic pattern. Suppose such an application sends a 1-byte data when a change occurs. 
This results in sending a packet notifying a change has occurred. 
"Dummy" packets may be used to prevent such information from being leaked by sending a 1-byte packet every second when the information is not changed.
After an upgrade, the data becomes 2 bytes. At that point, the  "dummy" packets do not hide anything, and having 1 byte regularly versus 2 bytes makes even the identification of the application version easier to identify.
This generally makes the use of "dummy" packets more appropriate on high-speed links.<a class="pilcrow" href="#section-6-3">¶</a></p>
<p id="section-6-4"> In some cases, devices are dedicated to a single application or a single transport protocol. In this case, the Next Header has a fixed value.<a class="pilcrow" href="#section-6-4">¶</a></p>
<p id="section-6-5">Specific processing indications have not been standardized yet <span>[<a class="cite xref" href="#I-D.nikander-esp-beet-mode">BEET-ESP</a>]</span> and are expected to result from an agreement between the peers.
As a result, they <span class="bcp14">SHOULD NOT</span> be part of a minimal implementation of ESP.<a class="pilcrow" href="#section-6-5">¶</a></p>
</section>
</div>
<div id="sec-icv">
<section id="section-7">
      <h2 id="name-icv">
<a class="section-number selfRef" href="#section-7">7. </a><a class="section-name selfRef" href="#name-icv">ICV</a>
      </h2>
<p id="section-7-1">The ICV depends on the cryptographic suite used.
As detailed in <span>[<a class="cite xref" href="#RFC8221">RFC8221</a>]</span>, authentication or authenticated encryption is <span class="bcp14">RECOMMENDED</span>, and as such, the ICV field must be present with a size different from zero.
Its length is defined by the security recommendations only.<a class="pilcrow" href="#section-7-1">¶</a></p>
</section>
</div>
<div id="sec-encr">
<section id="section-8">
      <h2 id="name-cryptographic-suites">
<a class="section-number selfRef" href="#section-8">8. </a><a class="section-name selfRef" href="#name-cryptographic-suites">Cryptographic Suites</a>
      </h2>
<p id="section-8-1"> The recommended algorithms to use are expected to evolve over time, and implementers <span class="bcp14">SHOULD</span> follow the recommendations provided by <span>[<a class="cite xref" href="#RFC8221">RFC8221</a>]</span> and updates.<a class="pilcrow" href="#section-8-1">¶</a></p>
<p id="section-8-2"> This section lists some of the criteria that may be considered to select an appropriate cryptographic suite.
The list is not expected to be exhaustive and may also evolve over time.<a class="pilcrow" href="#section-8-2">¶</a></p>
<ol class="normal type-1" id="section-8-3" start="1" type="1">

 <li id="section-8-3.1">Security: Security is the criteria that should be considered first
 for the selection of encryption algorithm transforms.  The security of
 encryption algorithm transforms is expected to evolve over time, and
 it is of primary importance to follow up-to-date security guidance and
 recommendations.  The chosen encryption algorithm <span class="bcp14">MUST NOT</span> be vulnerable or weak (see <span>[<a class="cite xref" href="#RFC8221">RFC8221</a>]</span> for outdated ciphers).  ESP can be used to
 authenticate only (ENCR_NULL) or to encrypt the communication.  In the
 latter case, Authenticated Encryption with Associated Data (AEAD) is
 <span class="bcp14">RECOMMENDED</span> <span>[<a class="cite xref" href="#RFC8221">RFC8221</a>]</span>.<a class="pilcrow" href="#section-8-3.1">¶</a>
</li>
        <li id="section-8-3.2">Resilience to Nonce Reuse: Some transforms, including AES-GCM,
        are vulnerable to nonce collision with a given key.  While the
        generation of the nonce may prevent such collision during a session,
        the mechanisms are unlikely to provide such protection across sleep
        states or reboot.  This causes an issue for devices that are
        configured using static keys (called "manual keying"), and manual keying
        should not be used with these encryption algorithms.  When the key is
        likely to be reused across reboots, algorithms that are resistant to nonce misuse
         (for example, AES-SIV <span>[<a class="cite xref" href="#RFC5297">RFC5297</a>]</span>, AES-GCM-SIV <span>[<a class="cite xref" href="#RFC8452">RFC8452</a>]</span>, and Deoxys-II <span>[<a class="cite xref" href="#DeoxysII">DeoxysII</a>]</span>) are <span class="bcp14">RECOMMENDED</span>.  Note, however,
        that none of these are currently defined for use with
        ESP.<a class="pilcrow" href="#section-8-3.2">¶</a>
</li>
        <li id="section-8-3.3">Interoperability: Constrained devices usually only implement one
        or very few different encryption algorithm transforms.  <span>[<a class="cite xref" href="#RFC8221">RFC8221</a>]</span> takes the life cycle of encryption
        algorithm transforms and device manufacturing into consideration in
        its recommendations for mandatory-to-implement (MTI)
        algorithms.<a class="pilcrow" href="#section-8-3.3">¶</a>
</li>
        <li id="section-8-3.4">Power Consumption and Cipher Suite Complexity: Complexity of the
        encryption algorithm transform and the energy cost associated with it
        are especially important considerations for devices that have limited
        resources or are battery powered.  The battery life might determine
        the lifetime of the entire device.  When choosing a cryptographic
        function, reusing specific libraries or taking
        advantage of hardware acceleration provided by the device should be considered.  For
        example, if the device benefits from AES hardware modules and uses
        ENCR_AES_CTR, it may prefer AUTH_AES-XCBC for its authentication.  In
        addition, some devices may embed radio modules with hardware
        acceleration for AES-CCM, in which case, this transform may be
        preferred.<a class="pilcrow" href="#section-8-3.4">¶</a>
</li>
        <li id="section-8-3.5">
          <p id="section-8-3.5.1">Power Consumption and Bandwidth Consumption: Reducing the
        payload sent may significantly reduce the energy consumption of the
        device.  Encryption algorithm transforms with low overhead are
        strongly preferred.  To reduce the overall payload size, one may, for
        example:<a class="pilcrow" href="#section-8-3.5.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8-3.5.2.1">Use counter-based ciphers without fixed block length
     (e.g., AES-CTR or ChaCha20-Poly1305).<a class="pilcrow" href="#section-8-3.5.2.1">¶</a>
</li>
            <li class="normal" id="section-8-3.5.2.2">Use ciphers capable of using implicit
            Initialization Vectors (IVs) <span>[<a class="cite xref" href="#RFC8750">RFC8750</a>]</span>.<a class="pilcrow" href="#section-8-3.5.2.2">¶</a>
</li>
            <li class="normal" id="section-8-3.5.2.3">Use ciphers recommended for IoT <span>[<a class="cite xref" href="#RFC8221">RFC8221</a>]</span>.<a class="pilcrow" href="#section-8-3.5.2.3">¶</a>
</li>
            <li class="normal" id="section-8-3.5.2.4"> Avoid padding by sending payload data that are
            aligned to the cipher block length -- 2 bytes for the ESP trailer.<a class="pilcrow" href="#section-8-3.5.2.4">¶</a>
</li>
          </ul>
</li>
      </ol>
</section>
</div>
<section id="section-9">
      <h2 id="name-iana-considerations">
<a class="section-number selfRef" href="#section-9">9. </a><a class="section-name selfRef" href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<p id="section-9-1">This document has no IANA actions.<a class="pilcrow" href="#section-9-1">¶</a></p>
</section>
<div id="sec-security-considerations">
<section id="section-10">
      <h2 id="name-security-considerations">
<a class="section-number selfRef" href="#section-10">10. </a><a class="section-name selfRef" href="#name-security-considerations">Security Considerations</a>
      </h2>
<p id="section-10-1"> The security considerations in <span>[<a class="cite xref" href="#RFC4303">RFC4303</a>]</span> apply to this document as well.
In addition, this document provides security recommendations and guidance for the implementation choices for each ESP field.<a class="pilcrow" href="#section-10-1">¶</a></p>
<p id="section-10-2">The security of a communication provided by ESP is closely related to the security associated with the management of that key.
This usually includes mechanisms to prevent a nonce from repeating, for example.
When a node is provisioned with a session key that is used across reboot, the implementer <span class="bcp14">MUST</span> ensure that the mechanisms put in place remain valid across reboot as well.<a class="pilcrow" href="#section-10-2">¶</a></p>
<p id="section-10-3">It is <span class="bcp14">RECOMMENDED</span> to use ESP in conjunction with key management protocols such as, for example, IKEv2 <span>[<a class="cite xref" href="#RFC7296">RFC7296</a>]</span> or minimal IKEv2 <span>[<a class="cite xref" href="#RFC7815">RFC7815</a>]</span>.
Such mechanisms are responsible for negotiating fresh session keys as well as preventing a session key being used beyond its lifetime.

When such mechanisms cannot be implemented, such as when the session key is provisioned, the device <span class="bcp14">MUST</span> ensure that keys are not used beyond their lifetime and that the key remains used in compliance with all security requirements across reboots (e.g., conditions on counters and nonces remain valid).<a class="pilcrow" href="#section-10-3">¶</a></p>
<p id="section-10-4">When a device generates its own key or when random values such as nonces are generated, the random generation <span class="bcp14">MUST</span> follow <span>[<a class="cite xref" href="#RFC4086">RFC4086</a>]</span>.
In addition, <span>[<a class="cite xref" href="#SP-800-90A-Rev-1">SP-800-90A-Rev-1</a>]</span> provides guidance on how to build random generators based on deterministic random functions.<a class="pilcrow" href="#section-10-4">¶</a></p>
</section>
</div>
<div id="sec-privacy-considerations">
<section id="section-11">
      <h2 id="name-privacy-considerations">
<a class="section-number selfRef" href="#section-11">11. </a><a class="section-name selfRef" href="#name-privacy-considerations">Privacy Considerations</a>
      </h2>
<p id="section-11-1">Preventing the leakage of privacy-sensitive information is a hard problem to solve and usually results in balancing the information potentially being leaked to the cost associated with the counter measures.
This problem is not inherent to the minimal ESP described in this document and also concerns the use of ESP in general.<a class="pilcrow" href="#section-11-1">¶</a></p>
<p id="section-11-2">This document targets minimal implementations of ESP and, as such, describes a minimalistic way to implement ESP.
In some cases, this may result in potentially revealing privacy-sensitive pieces of information.
This document describes these privacy implications so the implementer can make the appropriate decisions given the specificities of a given environment and deployment.<a class="pilcrow" href="#section-11-2">¶</a></p>
<p id="section-11-3">The main risk associated with privacy is the ability to identify an application or a device by analyzing the traffic, which is designated as "traffic shaping".
As discussed in <a class="auto internal xref" href="#sec-spi">Section 3</a>, the use in a very specific context of non-randomly generated SPIs might ease the determination of the device or the application in some cases.
Similarly, padding provides limited capabilities to obfuscate the traffic compared to those provided by TFC. Such consequences on privacy are detailed in <a class="auto internal xref" href="#sec-padding">Section 5</a>.<a class="pilcrow" href="#section-11-3">¶</a></p>
</section>
</div>
<section id="section-12">
      <h2 id="name-references">
<a class="section-number selfRef" href="#section-12">12. </a><a class="section-name selfRef" href="#name-references">References</a>
      </h2>
<section id="section-12.1">
        <h3 id="name-normative-references">
<a class="section-number selfRef" href="#section-12.1">12.1. </a><a class="section-name selfRef" href="#name-normative-references">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time class="refDate" datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4086">[RFC4086]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span>, <span class="refAuthor">Schiller, J.</span>, and <span class="refAuthor">S. Crocker</span>, <span class="refTitle">"Randomness Requirements for Security"</span>, <span class="seriesInfo">BCP 106</span>, <span class="seriesInfo">RFC 4086</span>, <span class="seriesInfo">DOI 10.17487/RFC4086</span>, <time class="refDate" datetime="2005-06">June 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4086">https://www.rfc-editor.org/info/rfc4086</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4301">[RFC4301]</dt>
        <dd>
<span class="refAuthor">Kent, S.</span> and <span class="refAuthor">K. Seo</span>, <span class="refTitle">"Security Architecture for the Internet Protocol"</span>, <span class="seriesInfo">RFC 4301</span>, <span class="seriesInfo">DOI 10.17487/RFC4301</span>, <time class="refDate" datetime="2005-12">December 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4301">https://www.rfc-editor.org/info/rfc4301</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4303">[RFC4303]</dt>
        <dd>
<span class="refAuthor">Kent, S.</span>, <span class="refTitle">"IP Encapsulating Security Payload (ESP)"</span>, <span class="seriesInfo">RFC 4303</span>, <span class="seriesInfo">DOI 10.17487/RFC4303</span>, <time class="refDate" datetime="2005-12">December 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4303">https://www.rfc-editor.org/info/rfc4303</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7296">[RFC7296]</dt>
        <dd>
<span class="refAuthor">Kaufman, C.</span>, <span class="refAuthor">Hoffman, P.</span>, <span class="refAuthor">Nir, Y.</span>, <span class="refAuthor">Eronen, P.</span>, and <span class="refAuthor">T. Kivinen</span>, <span class="refTitle">"Internet Key Exchange Protocol Version 2 (IKEv2)"</span>, <span class="seriesInfo">STD 79</span>, <span class="seriesInfo">RFC 7296</span>, <span class="seriesInfo">DOI 10.17487/RFC7296</span>, <time class="refDate" datetime="2014-10">October 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7296">https://www.rfc-editor.org/info/rfc7296</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7815">[RFC7815]</dt>
        <dd>
<span class="refAuthor">Kivinen, T.</span>, <span class="refTitle">"Minimal Internet Key Exchange Version 2 (IKEv2) Initiator Implementation"</span>, <span class="seriesInfo">RFC 7815</span>, <span class="seriesInfo">DOI 10.17487/RFC7815</span>, <time class="refDate" datetime="2016-03">March 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7815">https://www.rfc-editor.org/info/rfc7815</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time class="refDate" datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8221">[RFC8221]</dt>
        <dd>
<span class="refAuthor">Wouters, P.</span>, <span class="refAuthor">Migault, D.</span>, <span class="refAuthor">Mattsson, J.</span>, <span class="refAuthor">Nir, Y.</span>, and <span class="refAuthor">T. Kivinen</span>, <span class="refTitle">"Cryptographic Algorithm Implementation Requirements and Usage Guidance for Encapsulating Security Payload (ESP) and Authentication Header (AH)"</span>, <span class="seriesInfo">RFC 8221</span>, <span class="seriesInfo">DOI 10.17487/RFC8221</span>, <time class="refDate" datetime="2017-10">October 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8221">https://www.rfc-editor.org/info/rfc8221</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8750">[RFC8750]</dt>
      <dd>
<span class="refAuthor">Migault, D.</span>, <span class="refAuthor">Guggemos, T.</span>, and <span class="refAuthor">Y. Nir</span>, <span class="refTitle">"Implicit Initialization Vector (IV) for Counter-Based Ciphers in Encapsulating Security Payload (ESP)"</span>, <span class="seriesInfo">RFC 8750</span>, <span class="seriesInfo">DOI 10.17487/RFC8750</span>, <time class="refDate" datetime="2020-03">March 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8750">https://www.rfc-editor.org/info/rfc8750</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-12.2">
        <h3 id="name-informative-references">
<a class="section-number selfRef" href="#section-12.2">12.2. </a><a class="section-name selfRef" href="#name-informative-references">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.nikander-esp-beet-mode">[BEET-ESP]</dt>
        <dd>
<span class="refAuthor">Nikander, P.</span> and <span class="refAuthor">J. Melen</span>, <span class="refTitle">"A Bound End-to-End Tunnel (BEET) mode for ESP"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-nikander-esp-beet-mode-09</span>, <time class="refDate" datetime="2008-08-05">5 August 2008</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-nikander-esp-beet-mode-09">https://datatracker.ietf.org/doc/html/draft-nikander-esp-beet-mode-09</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="DeoxysII">[DeoxysII]</dt>
        <dd>
<span class="refAuthor">Jean, J.</span>, <span class="refAuthor">Nikolić, I.</span>, <span class="refAuthor">Peyrin, T.</span>, and <span class="refAuthor">Y. Seurin</span>, <span class="refTitle">"Deoxys v1.41"</span>, <time class="refDate" datetime="2016-10">October 2016</time>, <span>&lt;<a href="https://competitions.cr.yp.to/round3/deoxysv141.pdf">https://competitions.cr.yp.to/round3/deoxysv141.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.mglt-ipsecme-diet-esp">[EHC-DIET-ESP]</dt>
        <dd>
<span class="refAuthor">Migault, D.</span>, <span class="refAuthor">Guggemos, T.</span>, <span class="refAuthor">Bormann, C.</span>, and <span class="refAuthor">D. Schinazi</span>, <span class="refTitle">"ESP Header Compression and Diet-ESP"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-mglt-ipsecme-diet-esp-08</span>, <time class="refDate" datetime="2022-05-13">13 May 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-mglt-ipsecme-diet-esp-08">https://datatracker.ietf.org/doc/html/draft-mglt-ipsecme-diet-esp-08</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.mglt-ipsecme-ikev2-diet-esp-extension">[EHC-IKEv2]</dt>
        <dd>
<span class="refAuthor">Migault, D.</span>, <span class="refAuthor">Guggemos, T.</span>, and <span class="refAuthor">D. Schinazi</span>, <span class="refTitle">"Internet Key Exchange version 2 (IKEv2) extension for the ESP Header Compression (EHC) Strategy"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-mglt-ipsecme-ikev2-diet-esp-extension-02</span>, <time class="refDate" datetime="2022-05-13">13 May 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-mglt-ipsecme-ikev2-diet-esp-extension-02">https://datatracker.ietf.org/doc/html/draft-mglt-ipsecme-ikev2-diet-esp-extension-02</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5297">[RFC5297]</dt>
        <dd>
<span class="refAuthor">Harkins, D.</span>, <span class="refTitle">"Synthetic Initialization Vector (SIV) Authenticated Encryption Using the Advanced Encryption Standard (AES)"</span>, <span class="seriesInfo">RFC 5297</span>, <span class="seriesInfo">DOI 10.17487/RFC5297</span>, <time class="refDate" datetime="2008-10">October 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5297">https://www.rfc-editor.org/info/rfc5297</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8452">[RFC8452]</dt>
        <dd>
<span class="refAuthor">Gueron, S.</span>, <span class="refAuthor">Langley, A.</span>, and <span class="refAuthor">Y. Lindell</span>, <span class="refTitle">"AES-GCM-SIV: Nonce Misuse-Resistant Authenticated Encryption"</span>, <span class="seriesInfo">RFC 8452</span>, <span class="seriesInfo">DOI 10.17487/RFC8452</span>, <time class="refDate" datetime="2019-04">April 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8452">https://www.rfc-editor.org/info/rfc8452</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SP-800-90A-Rev-1">[SP-800-90A-Rev-1]</dt>
      <dd>
<span class="refAuthor">Barker, E.</span> and <span class="refAuthor">J. Kelsey</span>, <span class="refTitle">"Recommendation for Random Number Generation Using Deterministic Random Bit Generators"</span>, <span class="seriesInfo">NIST SP 800-90A Rev 1</span>, <span class="seriesInfo">DOI 10.6028/NIST.SP.800-90Ar1</span>, <time class="refDate" datetime="2015-06">June 2015</time>, <span>&lt;<a href="https://csrc.nist.gov/publications/detail/sp/800-90a/rev-1/final">https://csrc.nist.gov/publications/detail/sp/800-90a/rev-1/final</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<section id="appendix-A">
      <h2 id="name-acknowledgments">
<a class="section-name selfRef" href="#name-acknowledgments">Acknowledgments</a>
      </h2>
<p id="appendix-A-1">The authors would like to thank <span class="contact-name">Daniel       Palomares</span>, <span class="contact-name">Scott Fluhrer</span>, <span class="contact-name">Tero Kivinen</span>, <span class="contact-name">Valery Smyslov</span>,
      <span class="contact-name">Yoav Nir</span>, <span class="contact-name">Michael       Richardson</span>, <span class="contact-name">Thomas Peyrin</span>, <span class="contact-name">Eric Thormarker</span>, <span class="contact-name">Nancy Cam-Winget</span>, and
      <span class="contact-name">Bob Briscoe</span> for their valuable comments.  In
      particular, <span class="contact-name">Scott Fluhrer</span> suggested including the
      rekey index in the SPI.  <span class="contact-name">Tero Kivinen</span> also
      provided multiple clarifications and examples of ESP deployment within
      constrained devices with their associated optimizations.
<span class="contact-name">Thomas Peyrin</span>, <span class="contact-name">Eric Thormarker</span>, and
<span class="contact-name">Scott Fluhrer</span> suggested and clarified the use of
transform resilient to nonce misuse. The authors would also like to thank <span class="contact-name">Mohit Sethi</span> for his support as the LWIG Working Group Chair.<a class="pilcrow" href="#appendix-A-1">¶</a></p>
</section>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-addresses">
<a class="section-name selfRef" href="#name-authors-addresses">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Daniel Migault</span></div>
<div class="left" dir="auto"><span class="org">Ericsson</span></div>
<div class="left" dir="auto"><span class="street-address">8275 Rte Transcanadienne</span></div>
<div class="left" dir="auto">
<span class="locality">Saint-Laurent</span> <span class="region">QC</span> <span class="postal-code">H4S 0B6</span>
</div>
<div class="left" dir="auto"><span class="country-name">Canada</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:daniel.migault@ericsson.com">daniel.migault@ericsson.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Tobias Guggemos</span></div>
<div class="left" dir="auto"><span class="org">LMU Munich</span></div>
<div class="left" dir="auto"><span class="street-address">MNM-Team<br/>Oettingenstr. 67</span></div>
<div class="left" dir="auto"><span class="locality">80538 Munich</span></div>
<div class="left" dir="auto"><span class="country-name">Germany</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:guggemos@mnm-team.org">guggemos@mnm-team.org</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>


</body></html>