<!DOCTYPE html>
<html class="RFC" lang="en"><head>
<meta charset="utf-8"/>
<meta content="Common,Latin" name="scripts"/>
<meta content="initial-scale=1.0" name="viewport"/>
<title>RFC 9580: OpenPGP</title>
<meta content="Paul Wouters" name="author"/>
<meta content="Daniel Huigens" name="author"/>
<meta content="Justus Winter" name="author"/>
<meta content="Yutaka Niibe" name="author"/>
<meta content='
       This document specifies the message formats used in OpenPGP.
OpenPGP provides encryption with public key or symmetric cryptographic algorithms, digital signatures, compression, and key management. 
       This document is maintained in order to publish all necessary information needed to develop interoperable applications based on the OpenPGP format. It is not a step-by-step cookbook for writing an application. It describes only the format and methods needed to read, check, generate, and write conforming packets crossing any network. It does not deal with storage and implementation questions. It does, however, discuss implementation issues necessary to avoid security flaws. 
       This document obsoletes RFCs 4880 ("OpenPGP Message Format"), 5581 ("The Camellia Cipher in OpenPGP"), and 6637 ("Elliptic Curve Cryptography (ECC) in OpenPGP"). 
    ' name="description"/>
<meta content="xml2rfc 3.22.0" name="generator"/>
<meta content="9580" name="rfc.number"/>
<!-- Generator version information:
  xml2rfc 3.22.0
    Python 3.9.15
    ConfigArgParse 1.5.3
    google-i18n-address 3.0.0
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 4.9.0
    platformdirs 3.8.0
    pycountry 22.3.5
    PyYAML 6.0
    requests 2.28.0
    setuptools 44.1.1
    wcwidth 0.2.5
    weasyprint 62.3
-->
<link href="rfc9580.xml" rel="alternate" type="application/rfc+xml"/>
<link href="#copyright" rel="license"/>
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necessary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

:root {
  --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
  --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
  --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
}

@viewport {
  zoom: 1.0;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: var(--font-sans);
  line-height: 1.6;
  scroll-behavior: smooth;
  overflow-wrap: break-word;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
svg[font-family~="serif" i], svg [font-family~="serif" i] {
  font-family: var(--font-serif);
}
svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
  font-family: var(--font-sans);
}
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre {
  background-color: #f9f9f9;
  font-family: var(--font-mono);
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
blockquote > *:last-child {
  margin-bottom: 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}
.xref {
  overflow-wrap: normal;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.refSubseries {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: var(--font-sans);
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  .breakable pre {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The following is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
.sourcecode pre,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .artwork > pre,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: upper-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background slightly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottom margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the compact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div.sourcecode:first-child,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type:only-child {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css"/>
<link href="https://datatracker.ietf.org/doc/draft-ietf-openpgp-crypto-refresh-13" rel="prev"/>
  <link href="https://dx.doi.org/10.17487/rfc9580" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  </head>
<body class="xml2rfc">
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 9580</td>
<td class="center">OpenPGP</td>
<td class="right">July 2024</td>
</tr></thead>
<tfoot><tr>
<td class="left">Wouters, et al.</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div class="document-information" id="external-metadata"></div>
<div class="document-information" id="internal-metadata">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a class="eref" href="https://www.rfc-editor.org/rfc/rfc9580">9580</a></dd>
<dt class="label-obsoletes">Obsoletes:</dt>
<dd class="obsoletes">
<a class="eref" href="https://www.rfc-editor.org/rfc/rfc4880">4880</a>, <a class="eref" href="https://www.rfc-editor.org/rfc/rfc5581">5581</a>, <a class="eref" href="https://www.rfc-editor.org/rfc/rfc6637">6637</a> </dd>
<dt class="label-category">Category:</dt>
<dd class="category">Standards Track</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time class="published" datetime="2024-07">July 2024</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">P. Wouters, <span class="editor">Ed.</span>
</div>
<div class="org">Aiven</div>
</div>
<div class="author">
      <div class="author-name">D. Huigens</div>
<div class="org">Proton AG</div>
</div>
<div class="author">
      <div class="author-name">J. Winter</div>
<div class="org">Sequoia PGP</div>
</div>
<div class="author">
      <div class="author-name">Y. Niibe</div>
<div class="org">FSIJ</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 9580</h1>
<h1 id="title">OpenPGP</h1>
<section id="section-abstract">
      <h2 id="abstract"><a class="selfRef" href="#abstract">Abstract</a></h2>
<p id="section-abstract-1">This document specifies the message formats used in OpenPGP.
OpenPGP provides encryption with public key or symmetric cryptographic algorithms, digital signatures, compression, and key management.<a class="pilcrow" href="#section-abstract-1">¶</a></p>
<p id="section-abstract-2">This document is maintained in order to publish all necessary information needed to develop interoperable applications based on the OpenPGP format. It is not a step-by-step cookbook for writing an application. It describes only the format and methods needed to read, check, generate, and write conforming packets crossing any network. It does not deal with storage and implementation questions. It does, however, discuss implementation issues necessary to avoid security flaws.<a class="pilcrow" href="#section-abstract-2">¶</a></p>
<p id="section-abstract-3">This document obsoletes RFCs 4880 ("OpenPGP Message Format"), 5581 ("The Camellia Cipher in OpenPGP"), and 6637 ("Elliptic Curve Cryptography (ECC) in OpenPGP").<a class="pilcrow" href="#section-abstract-3">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a class="section-name selfRef" href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This is an Internet Standards Track document.<a class="pilcrow" href="#section-boilerplate.1-1">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.<a class="pilcrow" href="#section-boilerplate.1-2">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc9580">https://www.rfc-editor.org/info/rfc9580</a></span>.<a class="pilcrow" href="#section-boilerplate.1-3">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a class="section-name selfRef" href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2024 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a class="pilcrow" href="#section-boilerplate.2-1">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a class="pilcrow" href="#section-boilerplate.2-2">¶</a></p>
<p id="section-boilerplate.2-3">
            This document may contain material from IETF Documents or IETF
            Contributions published or made publicly available before November
            10, 2008. The person(s) controlling the copyright in some of this
            material may not have granted the IETF Trust the right to allow
            modifications of such material outside the IETF Standards Process.
            Without obtaining an adequate license from the person(s)
            controlling the copyright in such materials, this document may not
            be modified outside the IETF Standards Process, and derivative
            works of it may not be created outside the IETF Standards Process,
            except to format it for publication as an RFC or to translate it
            into languages other than English.<a class="pilcrow" href="#section-boilerplate.2-3">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a class="toplink" href="#" onclick="scroll(0,0)">▲</a><h2 id="name-table-of-contents">
<a class="section-name selfRef" href="#name-table-of-contents">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p class="keepWithNext" id="section-toc.1-1.1.1"><a class="auto internal xref" href="#section-1">1</a>.  <a class="internal xref" href="#name-introduction">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p class="keepWithNext" id="section-toc.1-1.1.2.1.1"><a class="auto internal xref" href="#section-1.1">1.1</a>.  <a class="internal xref" href="#name-terms">Terms</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a class="auto internal xref" href="#section-2">2</a>.  <a class="internal xref" href="#name-general-functions">General Functions</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p class="keepWithNext" id="section-toc.1-1.2.2.1.1"><a class="auto internal xref" href="#section-2.1">2.1</a>.  <a class="internal xref" href="#name-confidentiality-via-encrypt">Confidentiality via Encryption</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a class="auto internal xref" href="#section-2.2">2.2</a>.  <a class="internal xref" href="#name-authentication-via-digital-">Authentication via Digital Signature</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a class="auto internal xref" href="#section-2.3">2.3</a>.  <a class="internal xref" href="#name-compression">Compression</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.4">
                <p id="section-toc.1-1.2.2.4.1"><a class="auto internal xref" href="#section-2.4">2.4</a>.  <a class="internal xref" href="#name-conversion-to-base64">Conversion to Base64</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.5">
                <p id="section-toc.1-1.2.2.5.1"><a class="auto internal xref" href="#section-2.5">2.5</a>.  <a class="internal xref" href="#name-signature-only-applications">Signature-Only Applications</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a class="auto internal xref" href="#section-3">3</a>.  <a class="internal xref" href="#name-data-element-formats">Data Element Formats</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a class="auto internal xref" href="#section-3.1">3.1</a>.  <a class="internal xref" href="#name-scalar-numbers">Scalar Numbers</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a class="auto internal xref" href="#section-3.2">3.2</a>.  <a class="internal xref" href="#name-multiprecision-integers">Multiprecision Integers</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.1">
                    <p id="section-toc.1-1.3.2.2.2.1.1"><a class="auto internal xref" href="#section-3.2.1">3.2.1</a>.  <a class="internal xref" href="#name-using-mpis-to-encode-other-">Using MPIs to Encode Other Data</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a class="auto internal xref" href="#section-3.3">3.3</a>.  <a class="internal xref" href="#name-key-ids-and-fingerprints">Key IDs and Fingerprints</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a class="auto internal xref" href="#section-3.4">3.4</a>.  <a class="internal xref" href="#name-text">Text</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a class="auto internal xref" href="#section-3.5">3.5</a>.  <a class="internal xref" href="#name-time-fields">Time Fields</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6">
                <p id="section-toc.1-1.3.2.6.1"><a class="auto internal xref" href="#section-3.6">3.6</a>.  <a class="internal xref" href="#name-keyrings">Keyrings</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.7">
                <p id="section-toc.1-1.3.2.7.1"><a class="auto internal xref" href="#section-3.7">3.7</a>.  <a class="internal xref" href="#name-string-to-key-s2k-specifier">String-to-Key (S2K) Specifier</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.7.2.1">
                    <p id="section-toc.1-1.3.2.7.2.1.1"><a class="auto internal xref" href="#section-3.7.1">3.7.1</a>.  <a class="internal xref" href="#name-s2k-specifier-types">S2K Specifier Types</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.7.2.1.2.1">
                        <p id="section-toc.1-1.3.2.7.2.1.2.1.1"><a class="auto internal xref" href="#section-3.7.1.1">3.7.1.1</a>.  <a class="internal xref" href="#name-simple-s2k">Simple S2K</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.7.2.1.2.2">
                        <p id="section-toc.1-1.3.2.7.2.1.2.2.1"><a class="auto internal xref" href="#section-3.7.1.2">3.7.1.2</a>.  <a class="internal xref" href="#name-salted-s2k">Salted S2K</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.7.2.1.2.3">
                        <p id="section-toc.1-1.3.2.7.2.1.2.3.1"><a class="auto internal xref" href="#section-3.7.1.3">3.7.1.3</a>.  <a class="internal xref" href="#name-iterated-and-salted-s2k">Iterated and Salted S2K</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.7.2.1.2.4">
                        <p id="section-toc.1-1.3.2.7.2.1.2.4.1"><a class="auto internal xref" href="#section-3.7.1.4">3.7.1.4</a>.  <a class="internal xref" href="#name-argon2">Argon2</a></p>
</li>
                    </ul>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.7.2.2">
                    <p id="section-toc.1-1.3.2.7.2.2.1"><a class="auto internal xref" href="#section-3.7.2">3.7.2</a>.  <a class="internal xref" href="#name-s2k-usage">S2K Usage</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.7.2.2.2.1">
                        <p id="section-toc.1-1.3.2.7.2.2.2.1.1"><a class="auto internal xref" href="#section-3.7.2.1">3.7.2.1</a>.  <a class="internal xref" href="#name-secret-key-encryption">Secret Key Encryption</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.7.2.2.2.2">
                        <p id="section-toc.1-1.3.2.7.2.2.2.2.1"><a class="auto internal xref" href="#section-3.7.2.2">3.7.2.2</a>.  <a class="internal xref" href="#name-symmetric-key-message-encry">Symmetric Key Message Encryption</a></p>
</li>
                    </ul>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a class="auto internal xref" href="#section-4">4</a>.  <a class="internal xref" href="#name-packet-syntax">Packet Syntax</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a class="auto internal xref" href="#section-4.1">4.1</a>.  <a class="internal xref" href="#name-overview">Overview</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a class="auto internal xref" href="#section-4.2">4.2</a>.  <a class="internal xref" href="#name-packet-headers">Packet Headers</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a class="auto internal xref" href="#section-4.2.1">4.2.1</a>.  <a class="internal xref" href="#name-openpgp-format-packet-lengt">OpenPGP Format Packet Lengths</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.1.2.1">
                        <p id="section-toc.1-1.4.2.2.2.1.2.1.1"><a class="auto internal xref" href="#section-4.2.1.1">4.2.1.1</a>.  <a class="internal xref" href="#name-1-octet-lengths">1-Octet Lengths</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.1.2.2">
                        <p id="section-toc.1-1.4.2.2.2.1.2.2.1"><a class="auto internal xref" href="#section-4.2.1.2">4.2.1.2</a>.  <a class="internal xref" href="#name-2-octet-lengths">2-Octet Lengths</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.1.2.3">
                        <p id="section-toc.1-1.4.2.2.2.1.2.3.1"><a class="auto internal xref" href="#section-4.2.1.3">4.2.1.3</a>.  <a class="internal xref" href="#name-5-octet-lengths">5-Octet Lengths</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.1.2.4">
                        <p id="section-toc.1-1.4.2.2.2.1.2.4.1"><a class="auto internal xref" href="#section-4.2.1.4">4.2.1.4</a>.  <a class="internal xref" href="#name-partial-body-lengths">Partial Body Lengths</a></p>
</li>
                    </ul>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.2">
                    <p id="section-toc.1-1.4.2.2.2.2.1"><a class="auto internal xref" href="#section-4.2.2">4.2.2</a>.  <a class="internal xref" href="#name-legacy-format-packet-length">Legacy Format Packet Lengths</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.3">
                    <p id="section-toc.1-1.4.2.2.2.3.1"><a class="auto internal xref" href="#section-4.2.3">4.2.3</a>.  <a class="internal xref" href="#name-packet-length-examples">Packet Length Examples</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a class="auto internal xref" href="#section-4.3">4.3</a>.  <a class="internal xref" href="#name-packet-criticality">Packet Criticality</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a class="auto internal xref" href="#section-5">5</a>.  <a class="internal xref" href="#name-packet-types">Packet Types</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a class="auto internal xref" href="#section-5.1">5.1</a>.  <a class="internal xref" href="#name-public-key-encrypted-sessio">Public Key Encrypted Session Key Packet (Type ID 1)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.1">
                    <p id="section-toc.1-1.5.2.1.2.1.1"><a class="auto internal xref" href="#section-5.1.1">5.1.1</a>.  <a class="internal xref" href="#name-version-3-public-key-encryp">Version 3 Public Key Encrypted Session Key Packet Format</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.2">
                    <p id="section-toc.1-1.5.2.1.2.2.1"><a class="auto internal xref" href="#section-5.1.2">5.1.2</a>.  <a class="internal xref" href="#name-version-6-public-key-encryp">Version 6 Public Key Encrypted Session Key Packet Format</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.3">
                    <p id="section-toc.1-1.5.2.1.2.3.1"><a class="auto internal xref" href="#section-5.1.3">5.1.3</a>.  <a class="internal xref" href="#name-algorithm-specific-fields-f">Algorithm-Specific Fields for RSA Encryption</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.4">
                    <p id="section-toc.1-1.5.2.1.2.4.1"><a class="auto internal xref" href="#section-5.1.4">5.1.4</a>.  <a class="internal xref" href="#name-algorithm-specific-fields-fo">Algorithm-Specific Fields for Elgamal Encryption</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.5">
                    <p id="section-toc.1-1.5.2.1.2.5.1"><a class="auto internal xref" href="#section-5.1.5">5.1.5</a>.  <a class="internal xref" href="#name-algorithm-specific-fields-for">Algorithm-Specific Fields for ECDH Encryption</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.6">
                    <p id="section-toc.1-1.5.2.1.2.6.1"><a class="auto internal xref" href="#section-5.1.6">5.1.6</a>.  <a class="internal xref" href="#name-algorithm-specific-fields-for-">Algorithm-Specific Fields for X25519 Encryption</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.7">
                    <p id="section-toc.1-1.5.2.1.2.7.1"><a class="auto internal xref" href="#section-5.1.7">5.1.7</a>.  <a class="internal xref" href="#name-algorithm-specific-fields-for-x">Algorithm-Specific Fields for X448 Encryption</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.8">
                    <p id="section-toc.1-1.5.2.1.2.8.1"><a class="auto internal xref" href="#section-5.1.8">5.1.8</a>.  <a class="internal xref" href="#name-notes-on-pkesk">Notes on PKESK</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a class="auto internal xref" href="#section-5.2">5.2</a>.  <a class="internal xref" href="#name-signature-packet-type-id-2">Signature Packet (Type ID 2)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.1">
                    <p id="section-toc.1-1.5.2.2.2.1.1"><a class="auto internal xref" href="#section-5.2.1">5.2.1</a>.  <a class="internal xref" href="#name-signature-types">Signature Types</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.1.2.1">
                        <p id="section-toc.1-1.5.2.2.2.1.2.1.1"><a class="auto internal xref" href="#section-5.2.1.1">5.2.1.1</a>.  <a class="internal xref" href="#name-binary-signature-type-id-0x">Binary Signature (Type ID 0x00) of a Document</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.1.2.2">
                        <p id="section-toc.1-1.5.2.2.2.1.2.2.1"><a class="auto internal xref" href="#section-5.2.1.2">5.2.1.2</a>.  <a class="internal xref" href="#name-text-signature-type-id-0x01">Text Signature (Type ID 0x01) of a Canonical Document</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.1.2.3">
                        <p id="section-toc.1-1.5.2.2.2.1.2.3.1"><a class="auto internal xref" href="#section-5.2.1.3">5.2.1.3</a>.  <a class="internal xref" href="#name-standalone-signature-type-i">Standalone Signature (Type ID 0x02)</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.1.2.4">
                        <p id="section-toc.1-1.5.2.2.2.1.2.4.1"><a class="auto internal xref" href="#section-5.2.1.4">5.2.1.4</a>.  <a class="internal xref" href="#name-generic-certification-signa">Generic Certification Signature (Type ID 0x10) of a User ID and Public Key Packet</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.1.2.5">
                        <p id="section-toc.1-1.5.2.2.2.1.2.5.1"><a class="auto internal xref" href="#section-5.2.1.5">5.2.1.5</a>.  <a class="internal xref" href="#name-persona-certification-signa">Persona Certification Signature (Type ID 0x11) of a User ID and Public Key Packet</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.1.2.6">
                        <p id="section-toc.1-1.5.2.2.2.1.2.6.1"><a class="auto internal xref" href="#section-5.2.1.6">5.2.1.6</a>.  <a class="internal xref" href="#name-casual-certification-signat">Casual Certification Signature (Type ID 0x12) of a User ID and Public Key Packet</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.1.2.7">
                        <p id="section-toc.1-1.5.2.2.2.1.2.7.1"><a class="auto internal xref" href="#section-5.2.1.7">5.2.1.7</a>.  <a class="internal xref" href="#name-positive-certification-sign">Positive Certification Signature (Type ID 0x13) of a User ID and Public Key Packet</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.1.2.8">
                        <p id="section-toc.1-1.5.2.2.2.1.2.8.1"><a class="auto internal xref" href="#section-5.2.1.8">5.2.1.8</a>.  <a class="internal xref" href="#name-subkey-binding-signature-ty">Subkey Binding Signature (Type ID 0x18)</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.1.2.9">
                        <p id="section-toc.1-1.5.2.2.2.1.2.9.1"><a class="auto internal xref" href="#section-5.2.1.9">5.2.1.9</a>.  <a class="internal xref" href="#name-primary-key-binding-signatu">Primary Key Binding Signature (Type ID 0x19)</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.1.2.10">
                        <p id="section-toc.1-1.5.2.2.2.1.2.10.1"><a class="auto internal xref" href="#section-5.2.1.10">5.2.1.10</a>. <a class="internal xref" href="#name-direct-key-signature-type-i">Direct Key Signature (Type ID 0x1F)</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.1.2.11">
                        <p id="section-toc.1-1.5.2.2.2.1.2.11.1"><a class="auto internal xref" href="#section-5.2.1.11">5.2.1.11</a>. <a class="internal xref" href="#name-key-revocation-signature-ty">Key Revocation Signature (Type ID 0x20)</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.1.2.12">
                        <p id="section-toc.1-1.5.2.2.2.1.2.12.1"><a class="auto internal xref" href="#section-5.2.1.12">5.2.1.12</a>. <a class="internal xref" href="#name-subkey-revocation-signature">Subkey Revocation Signature (Type ID 0x28)</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.1.2.13">
                        <p id="section-toc.1-1.5.2.2.2.1.2.13.1"><a class="auto internal xref" href="#section-5.2.1.13">5.2.1.13</a>. <a class="internal xref" href="#name-certification-revocation-si">Certification Revocation Signature (Type ID 0x30)</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.1.2.14">
                        <p id="section-toc.1-1.5.2.2.2.1.2.14.1"><a class="auto internal xref" href="#section-5.2.1.14">5.2.1.14</a>. <a class="internal xref" href="#name-timestamp-signature-type-id">Timestamp Signature (Type ID 0x40)</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.1.2.15">
                        <p id="section-toc.1-1.5.2.2.2.1.2.15.1"><a class="auto internal xref" href="#section-5.2.1.15">5.2.1.15</a>. <a class="internal xref" href="#name-third-party-confirmation-si">Third-Party Confirmation Signature (Type ID 0x50)</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.1.2.16">
                        <p id="section-toc.1-1.5.2.2.2.1.2.16.1"><a class="auto internal xref" href="#section-5.2.1.16">5.2.1.16</a>. <a class="internal xref" href="#name-reserved-type-id-0xff">Reserved (Type ID 0xFF)</a></p>
</li>
                    </ul>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.2">
                    <p id="section-toc.1-1.5.2.2.2.2.1"><a class="auto internal xref" href="#section-5.2.2">5.2.2</a>.  <a class="internal xref" href="#name-version-3-signature-packet-">Version 3 Signature Packet Format</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3">
                    <p id="section-toc.1-1.5.2.2.2.3.1"><a class="auto internal xref" href="#section-5.2.3">5.2.3</a>.  <a class="internal xref" href="#name-versions-4-and-6-signature-">Versions 4 and 6 Signature Packet Formats</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3.2.1">
                        <p id="section-toc.1-1.5.2.2.2.3.2.1.1"><a class="auto internal xref" href="#section-5.2.3.1">5.2.3.1</a>.  <a class="internal xref" href="#name-algorithm-specific-fields-for-r">Algorithm-Specific Fields for RSA Signatures</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3.2.2">
                        <p id="section-toc.1-1.5.2.2.2.3.2.2.1"><a class="auto internal xref" href="#section-5.2.3.2">5.2.3.2</a>.  <a class="internal xref" href="#name-algorithm-specific-fields-for-d">Algorithm-Specific Fields for DSA or ECDSA Signatures</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3.2.3">
                        <p id="section-toc.1-1.5.2.2.2.3.2.3.1"><a class="auto internal xref" href="#section-5.2.3.3">5.2.3.3</a>.  <a class="internal xref" href="#name-algorithm-specific-fields-for-e">Algorithm-Specific Fields for EdDSALegacy Signatures (Deprecated)</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3.2.4">
                        <p id="section-toc.1-1.5.2.2.2.3.2.4.1"><a class="auto internal xref" href="#section-5.2.3.4">5.2.3.4</a>.  <a class="internal xref" href="#name-algorithm-specific-fields-for-ed2">Algorithm-Specific Fields for Ed25519 Signatures</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3.2.5">
                        <p id="section-toc.1-1.5.2.2.2.3.2.5.1"><a class="auto internal xref" href="#section-5.2.3.5">5.2.3.5</a>.  <a class="internal xref" href="#name-algorithm-specific-fields-for-ed4">Algorithm-Specific Fields for Ed448 Signatures</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3.2.6">
                        <p id="section-toc.1-1.5.2.2.2.3.2.6.1"><a class="auto internal xref" href="#section-5.2.3.6">5.2.3.6</a>.  <a class="internal xref" href="#name-notes-on-signatures">Notes on Signatures</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3.2.7">
                        <p id="section-toc.1-1.5.2.2.2.3.2.7.1"><a class="auto internal xref" href="#section-5.2.3.7">5.2.3.7</a>.  <a class="internal xref" href="#name-signature-subpacket-specifi">Signature Subpacket Specification</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3.2.8">
                        <p id="section-toc.1-1.5.2.2.2.3.2.8.1"><a class="auto internal xref" href="#section-5.2.3.8">5.2.3.8</a>.  <a class="internal xref" href="#name-signature-subpacket-types">Signature Subpacket Types</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3.2.9">
                        <p id="section-toc.1-1.5.2.2.2.3.2.9.1"><a class="auto internal xref" href="#section-5.2.3.9">5.2.3.9</a>.  <a class="internal xref" href="#name-notes-on-subpackets">Notes on Subpackets</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3.2.10">
                        <p id="section-toc.1-1.5.2.2.2.3.2.10.1"><a class="auto internal xref" href="#section-5.2.3.10">5.2.3.10</a>. <a class="internal xref" href="#name-notes-on-self-signatures">Notes on Self-Signatures</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3.2.11">
                        <p id="section-toc.1-1.5.2.2.2.3.2.11.1"><a class="auto internal xref" href="#section-5.2.3.11">5.2.3.11</a>. <a class="internal xref" href="#name-signature-creation-time">Signature Creation Time</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3.2.12">
                        <p id="section-toc.1-1.5.2.2.2.3.2.12.1"><a class="auto internal xref" href="#section-5.2.3.12">5.2.3.12</a>. <a class="internal xref" href="#name-issuer-key-id">Issuer Key ID</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3.2.13">
                        <p id="section-toc.1-1.5.2.2.2.3.2.13.1"><a class="auto internal xref" href="#section-5.2.3.13">5.2.3.13</a>. <a class="internal xref" href="#name-key-expiration-time">Key Expiration Time</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3.2.14">
                        <p id="section-toc.1-1.5.2.2.2.3.2.14.1"><a class="auto internal xref" href="#section-5.2.3.14">5.2.3.14</a>. <a class="internal xref" href="#name-preferred-symmetric-ciphers">Preferred Symmetric Ciphers for v1 SEIPD</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3.2.15">
                        <p id="section-toc.1-1.5.2.2.2.3.2.15.1"><a class="auto internal xref" href="#section-5.2.3.15">5.2.3.15</a>. <a class="internal xref" href="#name-preferred-aead-ciphersuites">Preferred AEAD Ciphersuites</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3.2.16">
                        <p id="section-toc.1-1.5.2.2.2.3.2.16.1"><a class="auto internal xref" href="#section-5.2.3.16">5.2.3.16</a>. <a class="internal xref" href="#name-preferred-hash-algorithms">Preferred Hash Algorithms</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3.2.17">
                        <p id="section-toc.1-1.5.2.2.2.3.2.17.1"><a class="auto internal xref" href="#section-5.2.3.17">5.2.3.17</a>. <a class="internal xref" href="#name-preferred-compression-algor">Preferred Compression Algorithms</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3.2.18">
                        <p id="section-toc.1-1.5.2.2.2.3.2.18.1"><a class="auto internal xref" href="#section-5.2.3.18">5.2.3.18</a>. <a class="internal xref" href="#name-signature-expiration-time">Signature Expiration Time</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3.2.19">
                        <p id="section-toc.1-1.5.2.2.2.3.2.19.1"><a class="auto internal xref" href="#section-5.2.3.19">5.2.3.19</a>. <a class="internal xref" href="#name-exportable-certification">Exportable Certification</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3.2.20">
                        <p id="section-toc.1-1.5.2.2.2.3.2.20.1"><a class="auto internal xref" href="#section-5.2.3.20">5.2.3.20</a>. <a class="internal xref" href="#name-revocable">Revocable</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3.2.21">
                        <p id="section-toc.1-1.5.2.2.2.3.2.21.1"><a class="auto internal xref" href="#section-5.2.3.21">5.2.3.21</a>. <a class="internal xref" href="#name-trust-signature">Trust Signature</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3.2.22">
                        <p id="section-toc.1-1.5.2.2.2.3.2.22.1"><a class="auto internal xref" href="#section-5.2.3.22">5.2.3.22</a>. <a class="internal xref" href="#name-regular-expression">Regular Expression</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3.2.23">
                        <p id="section-toc.1-1.5.2.2.2.3.2.23.1"><a class="auto internal xref" href="#section-5.2.3.23">5.2.3.23</a>. <a class="internal xref" href="#name-revocation-key-deprecated">Revocation Key (Deprecated)</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3.2.24">
                        <p id="section-toc.1-1.5.2.2.2.3.2.24.1"><a class="auto internal xref" href="#section-5.2.3.24">5.2.3.24</a>. <a class="internal xref" href="#name-notation-data">Notation Data</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3.2.25">
                        <p id="section-toc.1-1.5.2.2.2.3.2.25.1"><a class="auto internal xref" href="#section-5.2.3.25">5.2.3.25</a>. <a class="internal xref" href="#name-key-server-preferences">Key Server Preferences</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3.2.26">
                        <p id="section-toc.1-1.5.2.2.2.3.2.26.1"><a class="auto internal xref" href="#section-5.2.3.26">5.2.3.26</a>. <a class="internal xref" href="#name-preferred-key-server">Preferred Key Server</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3.2.27">
                        <p id="section-toc.1-1.5.2.2.2.3.2.27.1"><a class="auto internal xref" href="#section-5.2.3.27">5.2.3.27</a>. <a class="internal xref" href="#name-primary-user-id">Primary User ID</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3.2.28">
                        <p id="section-toc.1-1.5.2.2.2.3.2.28.1"><a class="auto internal xref" href="#section-5.2.3.28">5.2.3.28</a>. <a class="internal xref" href="#name-policy-uri">Policy URI</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3.2.29">
                        <p id="section-toc.1-1.5.2.2.2.3.2.29.1"><a class="auto internal xref" href="#section-5.2.3.29">5.2.3.29</a>. <a class="internal xref" href="#name-key-flags">Key Flags</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3.2.30">
                        <p id="section-toc.1-1.5.2.2.2.3.2.30.1"><a class="auto internal xref" href="#section-5.2.3.30">5.2.3.30</a>. <a class="internal xref" href="#name-signers-user-id">Signer's User ID</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3.2.31">
                        <p id="section-toc.1-1.5.2.2.2.3.2.31.1"><a class="auto internal xref" href="#section-5.2.3.31">5.2.3.31</a>. <a class="internal xref" href="#name-reason-for-revocation">Reason for Revocation</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3.2.32">
                        <p id="section-toc.1-1.5.2.2.2.3.2.32.1"><a class="auto internal xref" href="#section-5.2.3.32">5.2.3.32</a>. <a class="internal xref" href="#name-features">Features</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3.2.33">
                        <p id="section-toc.1-1.5.2.2.2.3.2.33.1"><a class="auto internal xref" href="#section-5.2.3.33">5.2.3.33</a>. <a class="internal xref" href="#name-signature-target">Signature Target</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3.2.34">
                        <p id="section-toc.1-1.5.2.2.2.3.2.34.1"><a class="auto internal xref" href="#section-5.2.3.34">5.2.3.34</a>. <a class="internal xref" href="#name-embedded-signature">Embedded Signature</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3.2.35">
                        <p id="section-toc.1-1.5.2.2.2.3.2.35.1"><a class="auto internal xref" href="#section-5.2.3.35">5.2.3.35</a>. <a class="internal xref" href="#name-issuer-fingerprint">Issuer Fingerprint</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3.2.36">
                        <p id="section-toc.1-1.5.2.2.2.3.2.36.1"><a class="auto internal xref" href="#section-5.2.3.36">5.2.3.36</a>. <a class="internal xref" href="#name-intended-recipient-fingerpr">Intended Recipient Fingerprint</a></p>
</li>
                    </ul>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.4">
                    <p id="section-toc.1-1.5.2.2.2.4.1"><a class="auto internal xref" href="#section-5.2.4">5.2.4</a>.  <a class="internal xref" href="#name-computing-signatures">Computing Signatures</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.4.2.1">
                        <p id="section-toc.1-1.5.2.2.2.4.2.1.1"><a class="auto internal xref" href="#section-5.2.4.1">5.2.4.1</a>.  <a class="internal xref" href="#name-notes-about-signature-compu">Notes about Signature Computation</a></p>
</li>
                    </ul>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.5">
                    <p id="section-toc.1-1.5.2.2.2.5.1"><a class="auto internal xref" href="#section-5.2.5">5.2.5</a>.  <a class="internal xref" href="#name-malformed-and-unknown-signa">Malformed and Unknown Signatures</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a class="auto internal xref" href="#section-5.3">5.3</a>.  <a class="internal xref" href="#name-symmetric-key-encrypted-ses">Symmetric Key Encrypted Session Key Packet (Type ID 3)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.1">
                    <p id="section-toc.1-1.5.2.3.2.1.1"><a class="auto internal xref" href="#section-5.3.1">5.3.1</a>.  <a class="internal xref" href="#name-version-4-symmetric-key-enc">Version 4 Symmetric Key Encrypted Session Key Packet Format</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.2">
                    <p id="section-toc.1-1.5.2.3.2.2.1"><a class="auto internal xref" href="#section-5.3.2">5.3.2</a>.  <a class="internal xref" href="#name-version-6-symmetric-key-enc">Version 6 Symmetric Key Encrypted Session Key Packet Format</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a class="auto internal xref" href="#section-5.4">5.4</a>.  <a class="internal xref" href="#name-one-pass-signature-packet-t">One-Pass Signature Packet (Type ID 4)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5">
                <p id="section-toc.1-1.5.2.5.1"><a class="auto internal xref" href="#section-5.5">5.5</a>.  <a class="internal xref" href="#name-key-material-packets">Key Material Packets</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5.2.1">
                    <p id="section-toc.1-1.5.2.5.2.1.1"><a class="auto internal xref" href="#section-5.5.1">5.5.1</a>.  <a class="internal xref" href="#name-key-packet-variants">Key Packet Variants</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5.2.1.2.1">
                        <p id="section-toc.1-1.5.2.5.2.1.2.1.1"><a class="auto internal xref" href="#section-5.5.1.1">5.5.1.1</a>.  <a class="internal xref" href="#name-public-key-packet-type-id-6">Public Key Packet (Type ID 6)</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5.2.1.2.2">
                        <p id="section-toc.1-1.5.2.5.2.1.2.2.1"><a class="auto internal xref" href="#section-5.5.1.2">5.5.1.2</a>.  <a class="internal xref" href="#name-public-subkey-packet-type-i">Public Subkey Packet (Type ID 14)</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5.2.1.2.3">
                        <p id="section-toc.1-1.5.2.5.2.1.2.3.1"><a class="auto internal xref" href="#section-5.5.1.3">5.5.1.3</a>.  <a class="internal xref" href="#name-secret-key-packet-type-id-5">Secret Key Packet (Type ID 5)</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5.2.1.2.4">
                        <p id="section-toc.1-1.5.2.5.2.1.2.4.1"><a class="auto internal xref" href="#section-5.5.1.4">5.5.1.4</a>.  <a class="internal xref" href="#name-secret-subkey-packet-type-i">Secret Subkey Packet (Type ID 7)</a></p>
</li>
                    </ul>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5.2.2">
                    <p id="section-toc.1-1.5.2.5.2.2.1"><a class="auto internal xref" href="#section-5.5.2">5.5.2</a>.  <a class="internal xref" href="#name-public-key-packet-formats">Public Key Packet Formats</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5.2.2.2.1">
                        <p id="section-toc.1-1.5.2.5.2.2.2.1.1"><a class="auto internal xref" href="#section-5.5.2.1">5.5.2.1</a>.  <a class="internal xref" href="#name-version-3-public-keys">Version 3 Public Keys</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5.2.2.2.2">
                        <p id="section-toc.1-1.5.2.5.2.2.2.2.1"><a class="auto internal xref" href="#section-5.5.2.2">5.5.2.2</a>.  <a class="internal xref" href="#name-version-4-public-keys">Version 4 Public Keys</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5.2.2.2.3">
                        <p id="section-toc.1-1.5.2.5.2.2.2.3.1"><a class="auto internal xref" href="#section-5.5.2.3">5.5.2.3</a>.  <a class="internal xref" href="#name-version-6-public-keys">Version 6 Public Keys</a></p>
</li>
                    </ul>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5.2.3">
                    <p id="section-toc.1-1.5.2.5.2.3.1"><a class="auto internal xref" href="#section-5.5.3">5.5.3</a>.  <a class="internal xref" href="#name-secret-key-packet-formats">Secret Key Packet Formats</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5.2.4">
                    <p id="section-toc.1-1.5.2.5.2.4.1"><a class="auto internal xref" href="#section-5.5.4">5.5.4</a>.  <a class="internal xref" href="#name-key-ids-and-fingerprints-2">Key IDs and Fingerprints</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5.2.4.2.1">
                        <p id="section-toc.1-1.5.2.5.2.4.2.1.1"><a class="auto internal xref" href="#section-5.5.4.1">5.5.4.1</a>.  <a class="internal xref" href="#name-version-3-key-id-and-finger">Version 3 Key ID and Fingerprint</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5.2.4.2.2">
                        <p id="section-toc.1-1.5.2.5.2.4.2.2.1"><a class="auto internal xref" href="#section-5.5.4.2">5.5.4.2</a>.  <a class="internal xref" href="#name-version-4-key-id-and-finger">Version 4 Key ID and Fingerprint</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5.2.4.2.3">
                        <p id="section-toc.1-1.5.2.5.2.4.2.3.1"><a class="auto internal xref" href="#section-5.5.4.3">5.5.4.3</a>.  <a class="internal xref" href="#name-version-6-key-id-and-finger">Version 6 Key ID and Fingerprint</a></p>
</li>
                    </ul>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5.2.5">
                    <p id="section-toc.1-1.5.2.5.2.5.1"><a class="auto internal xref" href="#section-5.5.5">5.5.5</a>.  <a class="internal xref" href="#name-algorithm-specific-parts-of">Algorithm-Specific Parts of Keys</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5.2.5.2.1">
                        <p id="section-toc.1-1.5.2.5.2.5.2.1.1"><a class="auto internal xref" href="#section-5.5.5.1">5.5.5.1</a>.  <a class="internal xref" href="#name-algorithm-specific-part-for">Algorithm-Specific Part for RSA Keys</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5.2.5.2.2">
                        <p id="section-toc.1-1.5.2.5.2.5.2.2.1"><a class="auto internal xref" href="#section-5.5.5.2">5.5.5.2</a>.  <a class="internal xref" href="#name-algorithm-specific-part-for-">Algorithm-Specific Part for DSA Keys</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5.2.5.2.3">
                        <p id="section-toc.1-1.5.2.5.2.5.2.3.1"><a class="auto internal xref" href="#section-5.5.5.3">5.5.5.3</a>.  <a class="internal xref" href="#name-algorithm-specific-part-for-e">Algorithm-Specific Part for Elgamal Keys</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5.2.5.2.4">
                        <p id="section-toc.1-1.5.2.5.2.5.2.4.1"><a class="auto internal xref" href="#section-5.5.5.4">5.5.5.4</a>.  <a class="internal xref" href="#name-algorithm-specific-part-for-ec">Algorithm-Specific Part for ECDSA Keys</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5.2.5.2.5">
                        <p id="section-toc.1-1.5.2.5.2.5.2.5.1"><a class="auto internal xref" href="#section-5.5.5.5">5.5.5.5</a>.  <a class="internal xref" href="#name-algorithm-specific-part-for-ed">Algorithm-Specific Part for EdDSALegacy Keys (Deprecated)</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5.2.5.2.6">
                        <p id="section-toc.1-1.5.2.5.2.5.2.6.1"><a class="auto internal xref" href="#section-5.5.5.6">5.5.5.6</a>.  <a class="internal xref" href="#name-algorithm-specific-part-for-ecd">Algorithm-Specific Part for ECDH Keys</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5.2.5.2.7">
                        <p id="section-toc.1-1.5.2.5.2.5.2.7.1"><a class="auto internal xref" href="#section-5.5.5.7">5.5.5.7</a>.  <a class="internal xref" href="#name-algorithm-specific-part-for-x">Algorithm-Specific Part for X25519 Keys</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5.2.5.2.8">
                        <p id="section-toc.1-1.5.2.5.2.5.2.8.1"><a class="auto internal xref" href="#section-5.5.5.8">5.5.5.8</a>.  <a class="internal xref" href="#name-algorithm-specific-part-for-x4">Algorithm-Specific Part for X448 Keys</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5.2.5.2.9">
                        <p id="section-toc.1-1.5.2.5.2.5.2.9.1"><a class="auto internal xref" href="#section-5.5.5.9">5.5.5.9</a>.  <a class="internal xref" href="#name-algorithm-specific-part-for-ed2">Algorithm-Specific Part for Ed25519 Keys</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5.2.5.2.10">
                        <p id="section-toc.1-1.5.2.5.2.5.2.10.1"><a class="auto internal xref" href="#section-5.5.5.10">5.5.5.10</a>. <a class="internal xref" href="#name-algorithm-specific-part-for-ed4">Algorithm-Specific Part for Ed448 Keys</a></p>
</li>
                    </ul>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.6">
                <p id="section-toc.1-1.5.2.6.1"><a class="auto internal xref" href="#section-5.6">5.6</a>.  <a class="internal xref" href="#name-compressed-data-packet-type">Compressed Data Packet (Type ID 8)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.7">
                <p id="section-toc.1-1.5.2.7.1"><a class="auto internal xref" href="#section-5.7">5.7</a>.  <a class="internal xref" href="#name-symmetrically-encrypted-dat">Symmetrically Encrypted Data Packet (Type ID 9)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.8">
                <p id="section-toc.1-1.5.2.8.1"><a class="auto internal xref" href="#section-5.8">5.8</a>.  <a class="internal xref" href="#name-marker-packet-type-id-10">Marker Packet (Type ID 10)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.9">
                <p id="section-toc.1-1.5.2.9.1"><a class="auto internal xref" href="#section-5.9">5.9</a>.  <a class="internal xref" href="#name-literal-data-packet-type-id">Literal Data Packet (Type ID 11)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.9.2.1">
                    <p id="section-toc.1-1.5.2.9.2.1.1"><a class="auto internal xref" href="#section-5.9.1">5.9.1</a>.  <a class="internal xref" href="#name-special-filename-_console-d">Special Filename _CONSOLE (Deprecated)</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.10">
                <p id="section-toc.1-1.5.2.10.1"><a class="auto internal xref" href="#section-5.10">5.10</a>. <a class="internal xref" href="#name-trust-packet-type-id-12">Trust Packet (Type ID 12)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.11">
                <p id="section-toc.1-1.5.2.11.1"><a class="auto internal xref" href="#section-5.11">5.11</a>. <a class="internal xref" href="#name-user-id-packet-type-id-13">User ID Packet (Type ID 13)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.12">
                <p id="section-toc.1-1.5.2.12.1"><a class="auto internal xref" href="#section-5.12">5.12</a>. <a class="internal xref" href="#name-user-attribute-packet-type-">User Attribute Packet (Type ID 17)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.12.2.1">
                    <p id="section-toc.1-1.5.2.12.2.1.1"><a class="auto internal xref" href="#section-5.12.1">5.12.1</a>.  <a class="internal xref" href="#name-image-attribute-subpacket">Image Attribute Subpacket</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.13">
                <p id="section-toc.1-1.5.2.13.1"><a class="auto internal xref" href="#section-5.13">5.13</a>. <a class="internal xref" href="#name-symmetrically-encrypted-and">Symmetrically Encrypted and Integrity Protected Data Packet (Type ID 18)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.13.2.1">
                    <p id="section-toc.1-1.5.2.13.2.1.1"><a class="auto internal xref" href="#section-5.13.1">5.13.1</a>.  <a class="internal xref" href="#name-version-1-symmetrically-enc">Version 1 Symmetrically Encrypted and Integrity Protected Data Packet Format</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.13.2.2">
                    <p id="section-toc.1-1.5.2.13.2.2.1"><a class="auto internal xref" href="#section-5.13.2">5.13.2</a>.  <a class="internal xref" href="#name-version-2-symmetrically-enc">Version 2 Symmetrically Encrypted and Integrity Protected Data Packet Format</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.13.2.3">
                    <p id="section-toc.1-1.5.2.13.2.3.1"><a class="auto internal xref" href="#section-5.13.3">5.13.3</a>.  <a class="internal xref" href="#name-eax-mode">EAX Mode</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.13.2.4">
                    <p id="section-toc.1-1.5.2.13.2.4.1"><a class="auto internal xref" href="#section-5.13.4">5.13.4</a>.  <a class="internal xref" href="#name-ocb-mode">OCB Mode</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.13.2.5">
                    <p id="section-toc.1-1.5.2.13.2.5.1"><a class="auto internal xref" href="#section-5.13.5">5.13.5</a>.  <a class="internal xref" href="#name-gcm-mode">GCM Mode</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.14">
                <p id="section-toc.1-1.5.2.14.1"><a class="auto internal xref" href="#section-5.14">5.14</a>. <a class="internal xref" href="#name-padding-packet-type-id-21">Padding Packet (Type ID 21)</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a class="auto internal xref" href="#section-6">6</a>.  <a class="internal xref" href="#name-base64-conversions">Base64 Conversions</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a class="auto internal xref" href="#section-6.1">6.1</a>.  <a class="internal xref" href="#name-optional-checksum">Optional Checksum</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.1">
                    <p id="section-toc.1-1.6.2.1.2.1.1"><a class="auto internal xref" href="#section-6.1.1">6.1.1</a>.  <a class="internal xref" href="#name-an-implementation-of-the-cr">An Implementation of the CRC24 in "C"</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a class="auto internal xref" href="#section-6.2">6.2</a>.  <a class="internal xref" href="#name-forming-ascii-armor">Forming ASCII Armor</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.1">
                    <p id="section-toc.1-1.6.2.2.2.1.1"><a class="auto internal xref" href="#section-6.2.1">6.2.1</a>.  <a class="internal xref" href="#name-armor-header-line">Armor Header Line</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.2">
                    <p id="section-toc.1-1.6.2.2.2.2.1"><a class="auto internal xref" href="#section-6.2.2">6.2.2</a>.  <a class="internal xref" href="#name-armor-headers">Armor Headers</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.2.2.1">
                        <p id="section-toc.1-1.6.2.2.2.2.2.1.1"><a class="auto internal xref" href="#section-6.2.2.1">6.2.2.1</a>.  <a class="internal xref" href="#name-version-armor-header">"Version" Armor Header</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.2.2.2">
                        <p id="section-toc.1-1.6.2.2.2.2.2.2.1"><a class="auto internal xref" href="#section-6.2.2.2">6.2.2.2</a>.  <a class="internal xref" href="#name-comment-armor-header">"Comment" Armor Header</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.2.2.3">
                        <p id="section-toc.1-1.6.2.2.2.2.2.3.1"><a class="auto internal xref" href="#section-6.2.2.3">6.2.2.3</a>.  <a class="internal xref" href="#name-hash-armor-header">"Hash" Armor Header</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.2.2.4">
                        <p id="section-toc.1-1.6.2.2.2.2.2.4.1"><a class="auto internal xref" href="#section-6.2.2.4">6.2.2.4</a>.  <a class="internal xref" href="#name-charset-armor-header">"Charset" Armor Header</a></p>
</li>
                    </ul>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.3">
                    <p id="section-toc.1-1.6.2.2.2.3.1"><a class="auto internal xref" href="#section-6.2.3">6.2.3</a>.  <a class="internal xref" href="#name-armor-tail-line">Armor Tail Line</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a class="auto internal xref" href="#section-7">7</a>.  <a class="internal xref" href="#name-cleartext-signature-framewo">Cleartext Signature Framework</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a class="auto internal xref" href="#section-7.1">7.1</a>.  <a class="internal xref" href="#name-cleartext-signed-message-st">Cleartext Signed Message Structure</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a class="auto internal xref" href="#section-7.2">7.2</a>.  <a class="internal xref" href="#name-dash-escaped-text">Dash-Escaped Text</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a class="auto internal xref" href="#section-7.3">7.3</a>.  <a class="internal xref" href="#name-issues-with-the-cleartext-s">Issues with the Cleartext Signature Framework</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a class="auto internal xref" href="#section-8">8</a>.  <a class="internal xref" href="#name-regular-expressions">Regular Expressions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a class="auto internal xref" href="#section-9">9</a>.  <a class="internal xref" href="#name-constants">Constants</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a class="auto internal xref" href="#section-9.1">9.1</a>.  <a class="internal xref" href="#name-public-key-algorithms">Public Key Algorithms</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a class="auto internal xref" href="#section-9.2">9.2</a>.  <a class="internal xref" href="#name-ecc-curves-for-openpgp">ECC Curves for OpenPGP</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2.2.1">
                    <p id="section-toc.1-1.9.2.2.2.1.1"><a class="auto internal xref" href="#section-9.2.1">9.2.1</a>.  <a class="internal xref" href="#name-curve-specific-wire-formats">Curve-Specific Wire Formats</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a class="auto internal xref" href="#section-9.3">9.3</a>.  <a class="internal xref" href="#name-symmetric-key-algorithms">Symmetric Key Algorithms</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.4">
                <p id="section-toc.1-1.9.2.4.1"><a class="auto internal xref" href="#section-9.4">9.4</a>.  <a class="internal xref" href="#name-compression-algorithms">Compression Algorithms</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.5">
                <p id="section-toc.1-1.9.2.5.1"><a class="auto internal xref" href="#section-9.5">9.5</a>.  <a class="internal xref" href="#name-hash-algorithms">Hash Algorithms</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.6">
                <p id="section-toc.1-1.9.2.6.1"><a class="auto internal xref" href="#section-9.6">9.6</a>.  <a class="internal xref" href="#name-aead-algorithms">AEAD Algorithms</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a class="auto internal xref" href="#section-10">10</a>. <a class="internal xref" href="#name-packet-sequence-composition">Packet Sequence Composition</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a class="auto internal xref" href="#section-10.1">10.1</a>.  <a class="internal xref" href="#name-transferable-public-keys">Transferable Public Keys</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1.2.1">
                    <p id="section-toc.1-1.10.2.1.2.1.1"><a class="auto internal xref" href="#section-10.1.1">10.1.1</a>.  <a class="internal xref" href="#name-openpgp-version-6-certifica">OpenPGP Version 6 Certificate Structure</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1.2.2">
                    <p id="section-toc.1-1.10.2.1.2.2.1"><a class="auto internal xref" href="#section-10.1.2">10.1.2</a>.  <a class="internal xref" href="#name-openpgp-version-6-revocatio">OpenPGP Version 6 Revocation Certificate</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1.2.3">
                    <p id="section-toc.1-1.10.2.1.2.3.1"><a class="auto internal xref" href="#section-10.1.3">10.1.3</a>.  <a class="internal xref" href="#name-openpgp-version-4-certifica">OpenPGP Version 4 Certificate Structure</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1.2.4">
                    <p id="section-toc.1-1.10.2.1.2.4.1"><a class="auto internal xref" href="#section-10.1.4">10.1.4</a>.  <a class="internal xref" href="#name-openpgp-version-3-key-struc">OpenPGP Version 3 Key Structure</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1.2.5">
                    <p id="section-toc.1-1.10.2.1.2.5.1"><a class="auto internal xref" href="#section-10.1.5">10.1.5</a>.  <a class="internal xref" href="#name-common-requirements">Common Requirements</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a class="auto internal xref" href="#section-10.2">10.2</a>.  <a class="internal xref" href="#name-transferable-secret-keys">Transferable Secret Keys</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.3">
                <p id="section-toc.1-1.10.2.3.1"><a class="auto internal xref" href="#section-10.3">10.3</a>.  <a class="internal xref" href="#name-openpgp-messages">OpenPGP Messages</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.3.2.1">
                    <p id="section-toc.1-1.10.2.3.2.1.1"><a class="auto internal xref" href="#section-10.3.1">10.3.1</a>.  <a class="internal xref" href="#name-unwrapping-encrypted-and-co">Unwrapping Encrypted and Compressed Messages</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.3.2.2">
                    <p id="section-toc.1-1.10.2.3.2.2.1"><a class="auto internal xref" href="#section-10.3.2">10.3.2</a>.  <a class="internal xref" href="#name-additional-constraints-on-p">Additional Constraints on Packet Sequences</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.3.2.2.2.1">
                        <p id="section-toc.1-1.10.2.3.2.2.2.1.1"><a class="auto internal xref" href="#section-10.3.2.1">10.3.2.1</a>.  <a class="internal xref" href="#name-packet-versions-in-encrypte">Packet Versions in Encrypted Messages</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.3.2.2.2.2">
                        <p id="section-toc.1-1.10.2.3.2.2.2.2.1"><a class="auto internal xref" href="#section-10.3.2.2">10.3.2.2</a>.  <a class="internal xref" href="#name-packet-versions-in-signatur">Packet Versions in Signatures</a></p>
</li>
                    </ul>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.4">
                <p id="section-toc.1-1.10.2.4.1"><a class="auto internal xref" href="#section-10.4">10.4</a>.  <a class="internal xref" href="#name-detached-signatures">Detached Signatures</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a class="auto internal xref" href="#section-11">11</a>. <a class="internal xref" href="#name-elliptic-curve-cryptography">Elliptic Curve Cryptography</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a class="auto internal xref" href="#section-11.1">11.1</a>.  <a class="internal xref" href="#name-ecc-curves">ECC Curves</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a class="auto internal xref" href="#section-11.2">11.2</a>.  <a class="internal xref" href="#name-ec-point-wire-formats">EC Point Wire Formats</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2.2.1">
                    <p id="section-toc.1-1.11.2.2.2.1.1"><a class="auto internal xref" href="#section-11.2.1">11.2.1</a>.  <a class="internal xref" href="#name-sec1-ec-point-wire-format">SEC1 EC Point Wire Format</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2.2.2">
                    <p id="section-toc.1-1.11.2.2.2.2.1"><a class="auto internal xref" href="#section-11.2.2">11.2.2</a>.  <a class="internal xref" href="#name-prefixed-native-ec-point-wi">Prefixed Native EC Point Wire Format</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2.2.3">
                    <p id="section-toc.1-1.11.2.2.2.3.1"><a class="auto internal xref" href="#section-11.2.3">11.2.3</a>.  <a class="internal xref" href="#name-notes-on-ec-point-wire-form">Notes on EC Point Wire Formats</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.3">
                <p id="section-toc.1-1.11.2.3.1"><a class="auto internal xref" href="#section-11.3">11.3</a>.  <a class="internal xref" href="#name-ec-scalar-wire-formats">EC Scalar Wire Formats</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.3.2.1">
                    <p id="section-toc.1-1.11.2.3.2.1.1"><a class="auto internal xref" href="#section-11.3.1">11.3.1</a>.  <a class="internal xref" href="#name-ec-octet-string-wire-format">EC Octet String Wire Format</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.3.2.2">
                    <p id="section-toc.1-1.11.2.3.2.2.1"><a class="auto internal xref" href="#section-11.3.2">11.3.2</a>.  <a class="internal xref" href="#name-ec-prefixed-octet-string-wi">EC Prefixed Octet String Wire Format</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.4">
                <p id="section-toc.1-1.11.2.4.1"><a class="auto internal xref" href="#section-11.4">11.4</a>.  <a class="internal xref" href="#name-key-derivation-function">Key Derivation Function</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.5">
                <p id="section-toc.1-1.11.2.5.1"><a class="auto internal xref" href="#section-11.5">11.5</a>.  <a class="internal xref" href="#name-ecdh-algorithm">ECDH Algorithm</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.5.2.1">
                    <p id="section-toc.1-1.11.2.5.2.1.1"><a class="auto internal xref" href="#section-11.5.1">11.5.1</a>.  <a class="internal xref" href="#name-ecdh-parameters">ECDH Parameters</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a class="auto internal xref" href="#section-12">12</a>. <a class="internal xref" href="#name-notes-on-algorithms">Notes on Algorithms</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a class="auto internal xref" href="#section-12.1">12.1</a>.  <a class="internal xref" href="#name-pkcs1-encoding-in-openpgp">PKCS#1 Encoding in OpenPGP</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1.2.1">
                    <p id="section-toc.1-1.12.2.1.2.1.1"><a class="auto internal xref" href="#section-12.1.1">12.1.1</a>.  <a class="internal xref" href="#name-eme-pkcs1-v1_5-encode">EME-PKCS1-v1_5-ENCODE</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1.2.2">
                    <p id="section-toc.1-1.12.2.1.2.2.1"><a class="auto internal xref" href="#section-12.1.2">12.1.2</a>.  <a class="internal xref" href="#name-eme-pkcs1-v1_5-decode">EME-PKCS1-v1_5-DECODE</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1.2.3">
                    <p id="section-toc.1-1.12.2.1.2.3.1"><a class="auto internal xref" href="#section-12.1.3">12.1.3</a>.  <a class="internal xref" href="#name-emsa-pkcs1-v1_5">EMSA-PKCS1-v1_5</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a class="auto internal xref" href="#section-12.2">12.2</a>.  <a class="internal xref" href="#name-symmetric-algorithm-prefere">Symmetric Algorithm Preferences</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2.2.1">
                    <p id="section-toc.1-1.12.2.2.2.1.1"><a class="auto internal xref" href="#section-12.2.1">12.2.1</a>.  <a class="internal xref" href="#name-plaintext">Plaintext</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.3">
                <p id="section-toc.1-1.12.2.3.1"><a class="auto internal xref" href="#section-12.3">12.3</a>.  <a class="internal xref" href="#name-other-algorithm-preferences">Other Algorithm Preferences</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.3.2.1">
                    <p id="section-toc.1-1.12.2.3.2.1.1"><a class="auto internal xref" href="#section-12.3.1">12.3.1</a>.  <a class="internal xref" href="#name-compression-preferences">Compression Preferences</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.3.2.1.2.1">
                        <p id="section-toc.1-1.12.2.3.2.1.2.1.1"><a class="auto internal xref" href="#section-12.3.1.1">12.3.1.1</a>.  <a class="internal xref" href="#name-uncompressed">Uncompressed</a></p>
</li>
                    </ul>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.3.2.2">
                    <p id="section-toc.1-1.12.2.3.2.2.1"><a class="auto internal xref" href="#section-12.3.2">12.3.2</a>.  <a class="internal xref" href="#name-hash-algorithm-preferences">Hash Algorithm Preferences</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.4">
                <p id="section-toc.1-1.12.2.4.1"><a class="auto internal xref" href="#section-12.4">12.4</a>.  <a class="internal xref" href="#name-rsa">RSA</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.5">
                <p id="section-toc.1-1.12.2.5.1"><a class="auto internal xref" href="#section-12.5">12.5</a>.  <a class="internal xref" href="#name-dsa">DSA</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.6">
                <p id="section-toc.1-1.12.2.6.1"><a class="auto internal xref" href="#section-12.6">12.6</a>.  <a class="internal xref" href="#name-elgamal">Elgamal</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.7">
                <p id="section-toc.1-1.12.2.7.1"><a class="auto internal xref" href="#section-12.7">12.7</a>.  <a class="internal xref" href="#name-eddsa">EdDSA</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.8">
                <p id="section-toc.1-1.12.2.8.1"><a class="auto internal xref" href="#section-12.8">12.8</a>.  <a class="internal xref" href="#name-reserved-algorithm-ids">Reserved Algorithm IDs</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.9">
                <p id="section-toc.1-1.12.2.9.1"><a class="auto internal xref" href="#section-12.9">12.9</a>.  <a class="internal xref" href="#name-cfb-mode">CFB Mode</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.10">
                <p id="section-toc.1-1.12.2.10.1"><a class="auto internal xref" href="#section-12.10">12.10</a>. <a class="internal xref" href="#name-private-or-experimental-par">Private or Experimental Parameters</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.11">
                <p id="section-toc.1-1.12.2.11.1"><a class="auto internal xref" href="#section-12.11">12.11</a>. <a class="internal xref" href="#name-meta-considerations-for-exp">Meta Considerations for Expansion</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a class="auto internal xref" href="#section-13">13</a>. <a class="internal xref" href="#name-security-considerations">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a class="auto internal xref" href="#section-13.1">13.1</a>.  <a class="internal xref" href="#name-sha-1-collision-detection">SHA-1 Collision Detection</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a class="auto internal xref" href="#section-13.2">13.2</a>.  <a class="internal xref" href="#name-advantages-of-salted-signat">Advantages of Salted Signatures</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.3">
                <p id="section-toc.1-1.13.2.3.1"><a class="auto internal xref" href="#section-13.3">13.3</a>.  <a class="internal xref" href="#name-elliptic-curve-side-channel">Elliptic Curve Side Channels</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.4">
                <p id="section-toc.1-1.13.2.4.1"><a class="auto internal xref" href="#section-13.4">13.4</a>.  <a class="internal xref" href="#name-risks-of-a-quick-check-orac">Risks of a Quick Check Oracle</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.5">
                <p id="section-toc.1-1.13.2.5.1"><a class="auto internal xref" href="#section-13.5">13.5</a>.  <a class="internal xref" href="#name-avoiding-leaks-from-pkcs1-e">Avoiding Leaks from PKCS#1 Errors</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.6">
                <p id="section-toc.1-1.13.2.6.1"><a class="auto internal xref" href="#section-13.6">13.6</a>.  <a class="internal xref" href="#name-fingerprint-usability">Fingerprint Usability</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.7">
                <p id="section-toc.1-1.13.2.7.1"><a class="auto internal xref" href="#section-13.7">13.7</a>.  <a class="internal xref" href="#name-avoiding-ciphertext-malleab">Avoiding Ciphertext Malleability</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.8">
                <p id="section-toc.1-1.13.2.8.1"><a class="auto internal xref" href="#section-13.8">13.8</a>.  <a class="internal xref" href="#name-secure-use-of-the-v2-seipd-">Secure Use of the v2 SEIPD Session-Key-Reuse Feature</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.9">
                <p id="section-toc.1-1.13.2.9.1"><a class="auto internal xref" href="#section-13.9">13.9</a>.  <a class="internal xref" href="#name-escrowed-revocation-signatu">Escrowed Revocation Signatures</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.10">
                <p id="section-toc.1-1.13.2.10.1"><a class="auto internal xref" href="#section-13.10">13.10</a>. <a class="internal xref" href="#name-random-number-generation-an">Random Number Generation and Seeding</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.11">
                <p id="section-toc.1-1.13.2.11.1"><a class="auto internal xref" href="#section-13.11">13.11</a>. <a class="internal xref" href="#name-traffic-analysis">Traffic Analysis</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.12">
                <p id="section-toc.1-1.13.2.12.1"><a class="auto internal xref" href="#section-13.12">13.12</a>. <a class="internal xref" href="#name-surreptitious-forwarding">Surreptitious Forwarding</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.13">
                <p id="section-toc.1-1.13.2.13.1"><a class="auto internal xref" href="#section-13.13">13.13</a>. <a class="internal xref" href="#name-hashed-vs-unhashed-subpacke">Hashed vs. Unhashed Subpackets</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.14">
                <p id="section-toc.1-1.13.2.14.1"><a class="auto internal xref" href="#section-13.14">13.14</a>. <a class="internal xref" href="#name-malicious-compressed-data">Malicious Compressed Data</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a class="auto internal xref" href="#section-14">14</a>. <a class="internal xref" href="#name-implementation-consideratio">Implementation Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.1">
                <p id="section-toc.1-1.14.2.1.1"><a class="auto internal xref" href="#section-14.1">14.1</a>.  <a class="internal xref" href="#name-constrained-legacy-fingerpr">Constrained Legacy Fingerprint Storage for Version 6 Keys</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a class="auto internal xref" href="#section-15">15</a>. <a class="internal xref" href="#name-iana-considerations">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.1">
                <p id="section-toc.1-1.15.2.1.1"><a class="auto internal xref" href="#section-15.1">15.1</a>.  <a class="internal xref" href="#name-renamed-protocol-group">Renamed Protocol Group</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.2">
                <p id="section-toc.1-1.15.2.2.1"><a class="auto internal xref" href="#section-15.2">15.2</a>.  <a class="internal xref" href="#name-renamed-and-updated-registr">Renamed and Updated Registries</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.3">
                <p id="section-toc.1-1.15.2.3.1"><a class="auto internal xref" href="#section-15.3">15.3</a>.  <a class="internal xref" href="#name-removed-registry">Removed Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.4">
                <p id="section-toc.1-1.15.2.4.1"><a class="auto internal xref" href="#section-15.4">15.4</a>.  <a class="internal xref" href="#name-added-registries">Added Registries</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.5">
                <p id="section-toc.1-1.15.2.5.1"><a class="auto internal xref" href="#section-15.5">15.5</a>.  <a class="internal xref" href="#name-registration-policies">Registration Policies</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.5.2.1">
                    <p id="section-toc.1-1.15.2.5.2.1.1"><a class="auto internal xref" href="#section-15.5.1">15.5.1</a>.  <a class="internal xref" href="#name-registries-that-use-rfc-req">Registries That Use RFC Required</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.6">
                <p id="section-toc.1-1.15.2.6.1"><a class="auto internal xref" href="#section-15.6">15.6</a>.  <a class="internal xref" href="#name-designated-experts">Designated Experts</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.6.2.1">
                    <p id="section-toc.1-1.15.2.6.2.1.1"><a class="auto internal xref" href="#section-15.6.1">15.6.1</a>.  <a class="internal xref" href="#name-key-and-signature-versions">Key and Signature Versions</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.6.2.2">
                    <p id="section-toc.1-1.15.2.6.2.2.1"><a class="auto internal xref" href="#section-15.6.2">15.6.2</a>.  <a class="internal xref" href="#name-encryption-versions">Encryption Versions</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.6.2.3">
                    <p id="section-toc.1-1.15.2.6.2.3.1"><a class="auto internal xref" href="#section-15.6.3">15.6.3</a>.  <a class="internal xref" href="#name-algorithms">Algorithms</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.6.2.3.2.1">
                        <p id="section-toc.1-1.15.2.6.2.3.2.1.1"><a class="auto internal xref" href="#section-15.6.3.1">15.6.3.1</a>.  <a class="internal xref" href="#name-elliptic-curve-algorithms">Elliptic Curve Algorithms</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.6.2.3.2.2">
                        <p id="section-toc.1-1.15.2.6.2.3.2.2.1"><a class="auto internal xref" href="#section-15.6.3.2">15.6.3.2</a>.  <a class="internal xref" href="#name-symmetric-key-algorithms-2">Symmetric Key Algorithms</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.6.2.3.2.3">
                        <p id="section-toc.1-1.15.2.6.2.3.2.3.1"><a class="auto internal xref" href="#section-15.6.3.3">15.6.3.3</a>.  <a class="internal xref" href="#name-hash-algorithms-2">Hash Algorithms</a></p>
</li>
                    </ul>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a class="auto internal xref" href="#section-16">16</a>. <a class="internal xref" href="#name-references">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16.2.1">
                <p id="section-toc.1-1.16.2.1.1"><a class="auto internal xref" href="#section-16.1">16.1</a>.  <a class="internal xref" href="#name-normative-references">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16.2.2">
                <p id="section-toc.1-1.16.2.2.1"><a class="auto internal xref" href="#section-16.2">16.2</a>.  <a class="internal xref" href="#name-informative-references">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17">
            <p id="section-toc.1-1.17.1"><a class="auto internal xref" href="#appendix-A">Appendix A</a>.  <a class="internal xref" href="#name-test-vectors">Test Vectors</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.1">
                <p id="section-toc.1-1.17.2.1.1"><a class="auto internal xref" href="#appendix-A.1">A.1</a>.  <a class="internal xref" href="#name-sample-version-4-ed25519leg">Sample Version 4 Ed25519Legacy Key</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.2">
                <p id="section-toc.1-1.17.2.2.1"><a class="auto internal xref" href="#appendix-A.2">A.2</a>.  <a class="internal xref" href="#name-sample-version-4-ed25519lega">Sample Version 4 Ed25519Legacy Signature</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.3">
                <p id="section-toc.1-1.17.2.3.1"><a class="auto internal xref" href="#appendix-A.3">A.3</a>.  <a class="internal xref" href="#name-sample-version-6-certificat">Sample Version 6 Certificate (Transferable Public Key)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.3.2.1">
                    <p id="section-toc.1-1.17.2.3.2.1.1"><a class="auto internal xref" href="#appendix-A.3.1">A.3.1</a>.  <a class="internal xref" href="#name-hashed-data-stream-for-sign">Hashed Data Stream for Signature Verification</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.4">
                <p id="section-toc.1-1.17.2.4.1"><a class="auto internal xref" href="#appendix-A.4">A.4</a>.  <a class="internal xref" href="#name-sample-version-6-secret-key">Sample Version 6 Secret Key (Transferable Secret Key)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.5">
                <p id="section-toc.1-1.17.2.5.1"><a class="auto internal xref" href="#appendix-A.5">A.5</a>.  <a class="internal xref" href="#name-sample-locked-version-6-sec">Sample Locked Version 6 Secret Key (Transferable Secret Key)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.5.2.1">
                    <p id="section-toc.1-1.17.2.5.2.1.1"><a class="auto internal xref" href="#appendix-A.5.1">A.5.1</a>.  <a class="internal xref" href="#name-intermediate-data-for-locke">Intermediate Data for Locked Primary Key</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.5.2.2">
                    <p id="section-toc.1-1.17.2.5.2.2.1"><a class="auto internal xref" href="#appendix-A.5.2">A.5.2</a>.  <a class="internal xref" href="#name-intermediate-data-for-locked">Intermediate Data for Locked Subkey</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.6">
                <p id="section-toc.1-1.17.2.6.1"><a class="auto internal xref" href="#appendix-A.6">A.6</a>.  <a class="internal xref" href="#name-sample-cleartext-signed-mes">Sample Cleartext Signed Message</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.7">
                <p id="section-toc.1-1.17.2.7.1"><a class="auto internal xref" href="#appendix-A.7">A.7</a>.  <a class="internal xref" href="#name-sample-inline-signed-messag">Sample Inline-Signed Message</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.8">
                <p id="section-toc.1-1.17.2.8.1"><a class="auto internal xref" href="#appendix-A.8">A.8</a>.  <a class="internal xref" href="#name-sample-x25519-aead-ocb-encr">Sample X25519-AEAD-OCB Encryption and Decryption</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.8.2.1">
                    <p id="section-toc.1-1.17.2.8.2.1.1"><a class="auto internal xref" href="#appendix-A.8.1">A.8.1</a>.  <a class="internal xref" href="#name-sample-version-6-public-key">Sample Version 6 Public Key Encrypted Session Key Packet</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.8.2.2">
                    <p id="section-toc.1-1.17.2.8.2.2.1"><a class="auto internal xref" href="#appendix-A.8.2">A.8.2</a>.  <a class="internal xref" href="#name-x25519-encryption-decryptio">X25519 Encryption/Decryption of the Session Key</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.8.2.3">
                    <p id="section-toc.1-1.17.2.8.2.3.1"><a class="auto internal xref" href="#appendix-A.8.3">A.8.3</a>.  <a class="internal xref" href="#name-sample-v2-seipd-packet">Sample v2 SEIPD Packet</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.8.2.4">
                    <p id="section-toc.1-1.17.2.8.2.4.1"><a class="auto internal xref" href="#appendix-A.8.4">A.8.4</a>.  <a class="internal xref" href="#name-decryption-of-data">Decryption of Data</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.8.2.5">
                    <p id="section-toc.1-1.17.2.8.2.5.1"><a class="auto internal xref" href="#appendix-A.8.5">A.8.5</a>.  <a class="internal xref" href="#name-complete-x25519-aead-ocb-en">Complete X25519-AEAD-OCB Encrypted Packet Sequence</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.9">
                <p id="section-toc.1-1.17.2.9.1"><a class="auto internal xref" href="#appendix-A.9">A.9</a>.  <a class="internal xref" href="#name-sample-aead-eax-encryption-">Sample AEAD-EAX Encryption and Decryption</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.9.2.1">
                    <p id="section-toc.1-1.17.2.9.2.1.1"><a class="auto internal xref" href="#appendix-A.9.1">A.9.1</a>.  <a class="internal xref" href="#name-sample-version-6-symmetric-">Sample Version 6 Symmetric Key Encrypted Session Key Packet</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.9.2.2">
                    <p id="section-toc.1-1.17.2.9.2.2.1"><a class="auto internal xref" href="#appendix-A.9.2">A.9.2</a>.  <a class="internal xref" href="#name-starting-aead-eax-decryptio">Starting AEAD-EAX Decryption of the Session Key</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.9.2.3">
                    <p id="section-toc.1-1.17.2.9.2.3.1"><a class="auto internal xref" href="#appendix-A.9.3">A.9.3</a>.  <a class="internal xref" href="#name-sample-v2-seipd-packet-2">Sample v2 SEIPD Packet</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.9.2.4">
                    <p id="section-toc.1-1.17.2.9.2.4.1"><a class="auto internal xref" href="#appendix-A.9.4">A.9.4</a>.  <a class="internal xref" href="#name-decryption-of-data-2">Decryption of Data</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.9.2.5">
                    <p id="section-toc.1-1.17.2.9.2.5.1"><a class="auto internal xref" href="#appendix-A.9.5">A.9.5</a>.  <a class="internal xref" href="#name-complete-aead-eax-encrypted">Complete AEAD-EAX Encrypted Packet Sequence</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.10">
                <p id="section-toc.1-1.17.2.10.1"><a class="auto internal xref" href="#appendix-A.10">A.10</a>. <a class="internal xref" href="#name-sample-aead-ocb-encryption-">Sample AEAD-OCB Encryption and Decryption</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.10.2.1">
                    <p id="section-toc.1-1.17.2.10.2.1.1"><a class="auto internal xref" href="#appendix-A.10.1">A.10.1</a>.  <a class="internal xref" href="#name-sample-version-6-symmetric-k">Sample Version 6 Symmetric Key Encrypted Session Key Packet</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.10.2.2">
                    <p id="section-toc.1-1.17.2.10.2.2.1"><a class="auto internal xref" href="#appendix-A.10.2">A.10.2</a>.  <a class="internal xref" href="#name-starting-aead-ocb-decryptio">Starting AEAD-OCB Decryption of the Session Key</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.10.2.3">
                    <p id="section-toc.1-1.17.2.10.2.3.1"><a class="auto internal xref" href="#appendix-A.10.3">A.10.3</a>.  <a class="internal xref" href="#name-sample-v2-seipd-packet-3">Sample v2 SEIPD Packet</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.10.2.4">
                    <p id="section-toc.1-1.17.2.10.2.4.1"><a class="auto internal xref" href="#appendix-A.10.4">A.10.4</a>.  <a class="internal xref" href="#name-decryption-of-data-3">Decryption of Data</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.10.2.5">
                    <p id="section-toc.1-1.17.2.10.2.5.1"><a class="auto internal xref" href="#appendix-A.10.5">A.10.5</a>.  <a class="internal xref" href="#name-complete-aead-ocb-encrypted">Complete AEAD-OCB Encrypted Packet Sequence</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.11">
                <p id="section-toc.1-1.17.2.11.1"><a class="auto internal xref" href="#appendix-A.11">A.11</a>. <a class="internal xref" href="#name-sample-aead-gcm-encryption-">Sample AEAD-GCM Encryption and Decryption</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.11.2.1">
                    <p id="section-toc.1-1.17.2.11.2.1.1"><a class="auto internal xref" href="#appendix-A.11.1">A.11.1</a>.  <a class="internal xref" href="#name-sample-version-6-symmetric-ke">Sample Version 6 Symmetric Key Encrypted Session Key Packet</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.11.2.2">
                    <p id="section-toc.1-1.17.2.11.2.2.1"><a class="auto internal xref" href="#appendix-A.11.2">A.11.2</a>.  <a class="internal xref" href="#name-starting-aead-gcm-decryptio">Starting AEAD-GCM Decryption of the Session Key</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.11.2.3">
                    <p id="section-toc.1-1.17.2.11.2.3.1"><a class="auto internal xref" href="#appendix-A.11.3">A.11.3</a>.  <a class="internal xref" href="#name-sample-v2-seipd-packet-4">Sample v2 SEIPD Packet</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.11.2.4">
                    <p id="section-toc.1-1.17.2.11.2.4.1"><a class="auto internal xref" href="#appendix-A.11.4">A.11.4</a>.  <a class="internal xref" href="#name-decryption-of-data-4">Decryption of Data</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.11.2.5">
                    <p id="section-toc.1-1.17.2.11.2.5.1"><a class="auto internal xref" href="#appendix-A.11.5">A.11.5</a>.  <a class="internal xref" href="#name-complete-aead-gcm-encrypted">Complete AEAD-GCM Encrypted Packet Sequence</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.12">
                <p id="section-toc.1-1.17.2.12.1"><a class="auto internal xref" href="#appendix-A.12">A.12</a>. <a class="internal xref" href="#name-sample-messages-encrypted-u">Sample Messages Encrypted Using Argon2</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.12.2.1">
                    <p id="section-toc.1-1.17.2.12.2.1.1"><a class="auto internal xref" href="#appendix-A.12.1">A.12.1</a>.  <a class="internal xref" href="#name-v4-skesk-using-argon2-with-">V4 SKESK Using Argon2 with AES-128</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.12.2.2">
                    <p id="section-toc.1-1.17.2.12.2.2.1"><a class="auto internal xref" href="#appendix-A.12.2">A.12.2</a>.  <a class="internal xref" href="#name-v4-skesk-using-argon2-with-a">V4 SKESK Using Argon2 with AES-192</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.12.2.3">
                    <p id="section-toc.1-1.17.2.12.2.3.1"><a class="auto internal xref" href="#appendix-A.12.3">A.12.3</a>.  <a class="internal xref" href="#name-v4-skesk-using-argon2-with-ae">V4 SKESK Using Argon2 with AES-256</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18">
            <p id="section-toc.1-1.18.1"><a class="auto internal xref" href="#appendix-B">Appendix B</a>.  <a class="internal xref" href="#name-upgrade-guidance-adapting-i">Upgrade Guidance (Adapting Implementations from RFCs 4880 and 6637)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.1">
                <p id="section-toc.1-1.18.2.1.1"><a class="auto internal xref" href="#appendix-B.1">B.1</a>.  <a class="internal xref" href="#name-terminology-changes">Terminology Changes</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19">
            <p id="section-toc.1-1.19.1"><a class="auto internal xref" href="#appendix-C">Appendix C</a>.  <a class="internal xref" href="#name-errata-addressed-by-this-do">Errata Addressed by This Document</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.20">
            <p id="section-toc.1-1.20.1"><a class="auto internal xref" href="#appendix-D"></a><a class="internal xref" href="#name-acknowledgements">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.21">
            <p id="section-toc.1-1.21.1"><a class="auto internal xref" href="#appendix-E"></a><a class="internal xref" href="#name-authors-addresses">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a class="section-number selfRef" href="#section-1">1. </a><a class="section-name selfRef" href="#name-introduction">Introduction</a>
      </h2>
<p id="section-1-1">This document provides information on the message-exchange packet formats used by OpenPGP to provide encryption, decryption, signing, and key management functions.
      It is a revision of <span>[<a class="cite xref" href="#RFC4880">RFC4880</a>]</span> ("OpenPGP Message Format"), which is a revision of <span>[<a class="cite xref" href="#RFC2440">RFC2440</a>]</span>, which itself replaces <span>[<a class="cite xref" href="#RFC1991">RFC1991</a>]</span> ("PGP Message Exchange Formats").<a class="pilcrow" href="#section-1-1">¶</a></p>
<p id="section-1-2">This document obsoletes <span>[<a class="cite xref" href="#RFC4880">RFC4880</a>]</span> (OpenPGP), <span>[<a class="cite xref" href="#RFC5581">RFC5581</a>]</span> (Camellia in OpenPGP), and <span>[<a class="cite xref" href="#RFC6637">RFC6637</a>]</span> (Elliptic Curves in OpenPGP). At the time of writing, this document incorporates all outstanding verified errata, which are listed in <a class="auto internal xref" href="#errata-listing">Appendix C</a>.<a class="pilcrow" href="#section-1-2">¶</a></p>
<p id="section-1-3">Software that has already implemented those previous specifications may want to review <a class="auto internal xref" href="#upgrade-guidance">Appendix B</a> for pointers to what has changed.<a class="pilcrow" href="#section-1-3">¶</a></p>
<div id="terms">
<section id="section-1.1">
        <h3 id="name-terms">
<a class="section-number selfRef" href="#section-1.1">1.1. </a><a class="section-name selfRef" href="#name-terms">Terms</a>
        </h3>
<p id="section-1.1-1">
    The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>",
    "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>",
    "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>",
    "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
    "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be
    interpreted as described in BCP 14 <span>[<a class="cite xref" href="#RFC2119">RFC2119</a>]</span> <span>[<a class="cite xref" href="#RFC8174">RFC8174</a>]</span> when, and only when, they appear in all capitals, as
    shown here.<a class="pilcrow" href="#section-1.1-1">¶</a></p>
<p id="section-1.1-2">The key words "Private Use", "Specification Required", and "RFC Required" that appear in this document when used to describe namespace allocation are to be interpreted as described in <span>[<a class="cite xref" href="#RFC8126">RFC8126</a>]</span>.<a class="pilcrow" href="#section-1.1-2">¶</a></p>
<p id="section-1.1-3">Some terminology used in this document has been improved from previous versions of the OpenPGP specification.
See <a class="auto internal xref" href="#terminology-changes">Appendix B.1</a> for more details.<a class="pilcrow" href="#section-1.1-3">¶</a></p>
</section>
</div>
</section>
</div>
<div id="general-functions">
<section id="section-2">
      <h2 id="name-general-functions">
<a class="section-number selfRef" href="#section-2">2. </a><a class="section-name selfRef" href="#name-general-functions">General Functions</a>
      </h2>
<p id="section-2-1">OpenPGP provides data confidentiality and integrity for messages and data files by using public key and/or symmetric encryption and digital signatures.
It provides formats for encoding and transferring encrypted and/or signed messages.
In addition, OpenPGP provides functionality for encoding and transferring keys and certificates, though key storage and management are beyond the scope of this document.<a class="pilcrow" href="#section-2-1">¶</a></p>
<div id="confidentiality-via-encryption">
<section id="section-2.1">
        <h3 id="name-confidentiality-via-encrypt">
<a class="section-number selfRef" href="#section-2.1">2.1. </a><a class="section-name selfRef" href="#name-confidentiality-via-encrypt">Confidentiality via Encryption</a>
        </h3>
<p id="section-2.1-1">OpenPGP combines symmetric key encryption and (optionally) public key encryption to provide confidentiality.
When using public keys, first the object is encrypted using a symmetric key encryption algorithm.
Each symmetric key is used only once, for a single object.
A new "session key" is generated as a random number for each object (sometimes referred to as a "session").
Since it is used only once, the session key is bound to the message and transmitted with it.
To protect the key, it is encrypted with the receiver's public key.
The sequence is as follows:<a class="pilcrow" href="#section-2.1-1">¶</a></p>
<ol class="normal type-1" id="section-2.1-2" start="1" type="1">
<li id="section-2.1-2.1">
            The sender creates a message.<a class="pilcrow" href="#section-2.1-2.1">¶</a>
</li>
          <li id="section-2.1-2.2">The sending OpenPGP implementation generates a random session key for this message.<a class="pilcrow" href="#section-2.1-2.2">¶</a>
</li>
          <li id="section-2.1-2.3">The session key is encrypted using each recipient's public key.
These "encrypted session keys" start the message.<a class="pilcrow" href="#section-2.1-2.3">¶</a>
</li>
          <li id="section-2.1-2.4">The sending OpenPGP implementation optionally compresses the message and then encrypts it using a message key derived from the session key.
The encrypted message forms the remainder of the OpenPGP Message.<a class="pilcrow" href="#section-2.1-2.4">¶</a>
</li>
          <li id="section-2.1-2.5">The receiving OpenPGP implementation decrypts the session key using the recipient's private key.<a class="pilcrow" href="#section-2.1-2.5">¶</a>
</li>
          <li id="section-2.1-2.6">The receiving OpenPGP implementation decrypts the message using the message key derived from the session key.
If the message was compressed, it will be decompressed.<a class="pilcrow" href="#section-2.1-2.6">¶</a>
</li>
        </ol>
<p id="section-2.1-3">When using symmetric key encryption, a similar process as described above is used, but the session key is encrypted with a symmetric algorithm derived from a shared secret.<a class="pilcrow" href="#section-2.1-3">¶</a></p>
<p id="section-2.1-4">Both digital signature and confidentiality services may be applied to the same message.
First, a signature is generated for the message and attached to the message.
Then, the message plus signature is encrypted using a symmetric message key derived from the session key.
Finally, the session key is encrypted using public key encryption and prefixed to the encrypted block.<a class="pilcrow" href="#section-2.1-4">¶</a></p>
</section>
</div>
<div id="authentication-via-digital-signature">
<section id="section-2.2">
        <h3 id="name-authentication-via-digital-">
<a class="section-number selfRef" href="#section-2.2">2.2. </a><a class="section-name selfRef" href="#name-authentication-via-digital-">Authentication via Digital Signature</a>
        </h3>
<p id="section-2.2-1">The digital signature uses a cryptographic hash function and a public key algorithm capable of signing.
The sequence is as follows:<a class="pilcrow" href="#section-2.2-1">¶</a></p>
<ol class="normal type-1" id="section-2.2-2" start="1" type="1">
<li id="section-2.2-2.1">
         The sender creates a message.<a class="pilcrow" href="#section-2.2-2.1">¶</a>
</li>
          <li id="section-2.2-2.2">The sending implementation generates a hash digest of the message.<a class="pilcrow" href="#section-2.2-2.2">¶</a>
</li>
          <li id="section-2.2-2.3">The sending implementation generates a signature from the hash digest using the sender's private key.<a class="pilcrow" href="#section-2.2-2.3">¶</a>
</li>
          <li id="section-2.2-2.4">The signature is attached to or transmitted alongside the message.<a class="pilcrow" href="#section-2.2-2.4">¶</a>
</li>
          <li id="section-2.2-2.5">The receiving implementation obtains a copy of the message and the message signature.<a class="pilcrow" href="#section-2.2-2.5">¶</a>
</li>
          <li id="section-2.2-2.6">The receiving implementation generates a new hash digest for the received message and verifies it using the message's signature.
If the verification is successful, the message is accepted as authentic.<a class="pilcrow" href="#section-2.2-2.6">¶</a>
</li>
        </ol>
</section>
</div>
<div id="compression">
<section id="section-2.3">
        <h3 id="name-compression">
<a class="section-number selfRef" href="#section-2.3">2.3. </a><a class="section-name selfRef" href="#name-compression">Compression</a>
        </h3>
<p id="section-2.3-1">An OpenPGP implementation <span class="bcp14">MAY</span> support the compression of data.
Many existing OpenPGP Messages are compressed.
Implementers, such as those working on constrained implementations that do not want to support compression, might want to consider at least implementing decompression.<a class="pilcrow" href="#section-2.3-1">¶</a></p>
</section>
</div>
<div id="conversion-to-base64">
<section id="section-2.4">
        <h3 id="name-conversion-to-base64">
<a class="section-number selfRef" href="#section-2.4">2.4. </a><a class="section-name selfRef" href="#name-conversion-to-base64">Conversion to Base64</a>
        </h3>
<p id="section-2.4-1">OpenPGP's underlying representation for encrypted messages, signatures, keys, and certificates is a stream of arbitrary octets.
Some systems only permit the use of blocks consisting of 7-bit, printable text.
For transporting OpenPGP's raw binary octets through channels that are not safe to transport raw binary data, a printable encoding of these binary octets is defined. The raw 8-bit binary octet stream can be converted to a stream of printable ASCII characters using base64 encoding in a format called "ASCII Armor" (see <a class="auto internal xref" href="#base64">Section 6</a>).<a class="pilcrow" href="#section-2.4-1">¶</a></p>
<p id="section-2.4-2">Implementations <span class="bcp14">SHOULD</span> support base64 conversions.<a class="pilcrow" href="#section-2.4-2">¶</a></p>
</section>
</div>
<div id="signature-only-applications">
<section id="section-2.5">
        <h3 id="name-signature-only-applications">
<a class="section-number selfRef" href="#section-2.5">2.5. </a><a class="section-name selfRef" href="#name-signature-only-applications">Signature-Only Applications</a>
        </h3>
<p id="section-2.5-1">OpenPGP is designed for applications that use both encryption and signatures, but there are a number of use cases that only require a signature-only implementation.
Although this specification requires both encryption and signatures, it is reasonable for there to be subset implementations that are non-conformant only in that they omit encryption support.<a class="pilcrow" href="#section-2.5-1">¶</a></p>
</section>
</div>
</section>
</div>
<div id="data-element-formats">
<section id="section-3">
      <h2 id="name-data-element-formats">
<a class="section-number selfRef" href="#section-3">3. </a><a class="section-name selfRef" href="#name-data-element-formats">Data Element Formats</a>
      </h2>
<p id="section-3-1">This section describes the data elements used by OpenPGP.<a class="pilcrow" href="#section-3-1">¶</a></p>
<div id="scalar-numbers">
<section id="section-3.1">
        <h3 id="name-scalar-numbers">
<a class="section-number selfRef" href="#section-3.1">3.1. </a><a class="section-name selfRef" href="#name-scalar-numbers">Scalar Numbers</a>
        </h3>
<p id="section-3.1-1">Scalar numbers are unsigned and always stored in big-endian format.
Using n[k] to refer to the kth octet being interpreted, the value of a 2-octet scalar is ((n[0] &lt;&lt; 8) + n[1]).
The value of a 4-octet scalar is ((n[0] &lt;&lt; 24) + (n[1] &lt;&lt; 16) + (n[2] &lt;&lt; 8) + n[3]).<a class="pilcrow" href="#section-3.1-1">¶</a></p>
</section>
</div>
<div id="mpi">
<section id="section-3.2">
        <h3 id="name-multiprecision-integers">
<a class="section-number selfRef" href="#section-3.2">3.2. </a><a class="section-name selfRef" href="#name-multiprecision-integers">Multiprecision Integers</a>
        </h3>
<p id="section-3.2-1">Multiprecision Integers (MPIs) are unsigned integers used to hold large integers such as the ones used in cryptographic calculations.<a class="pilcrow" href="#section-3.2-1">¶</a></p>
<p id="section-3.2-2">An MPI consists of two pieces: a 2-octet scalar that is the length of the MPI in bits, followed by a string of octets that contain the actual integer.<a class="pilcrow" href="#section-3.2-2">¶</a></p>
<p id="section-3.2-3">These octets form a big-endian number; a big-endian number can be made into an MPI by prefixing it with the appropriate length.<a class="pilcrow" href="#section-3.2-3">¶</a></p>
<p id="section-3.2-4">Examples:<a class="pilcrow" href="#section-3.2-4">¶</a></p>
<p id="section-3.2-5">(Note that all numbers in the octet strings identified by square brackets are in hexadecimal.)<a class="pilcrow" href="#section-3.2-5">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.2-6.1">The string of octets [00 00] forms an MPI with the value 0.<a class="pilcrow" href="#section-3.2-6.1">¶</a>
</li>
          <li class="normal ulEmpty" id="section-3.2-6.2">The string of octets [00 01 01] forms an MPI with the value 1.<a class="pilcrow" href="#section-3.2-6.2">¶</a>
</li>
          <li class="normal ulEmpty" id="section-3.2-6.3">The string [00 09 01 FF] forms an MPI with the value 511.<a class="pilcrow" href="#section-3.2-6.3">¶</a>
</li>
        </ul>
<p id="section-3.2-7">Additional rules:<a class="pilcrow" href="#section-3.2-7">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-8.1">The size of an MPI is ((MPI.length + 7) / 8) + 2 octets.<a class="pilcrow" href="#section-3.2-8.1">¶</a>
</li>
          <li class="normal" id="section-3.2-8.2">The length field of an MPI describes the length starting from its most significant non-zero bit. Thus, the MPI [00 02 01] is not formed correctly.
It should be [00 01 01]. When parsing an MPI in a version 6 Key, Signature, or Public Key Encrypted Session Key (PKESK) packet, the implementation <span class="bcp14">MUST</span> check that the encoded length matches the length starting from the most significant non-zero bit; if it doesn't match, reject the packet as malformed.<a class="pilcrow" href="#section-3.2-8.2">¶</a>
</li>
          <li class="normal" id="section-3.2-8.3">Unused bits of an MPI <span class="bcp14">MUST</span> be zero.<a class="pilcrow" href="#section-3.2-8.3">¶</a>
</li>
        </ul>
<div id="using-mpis-to-encode-other-data">
<section id="section-3.2.1">
          <h4 id="name-using-mpis-to-encode-other-">
<a class="section-number selfRef" href="#section-3.2.1">3.2.1. </a><a class="section-name selfRef" href="#name-using-mpis-to-encode-other-">Using MPIs to Encode Other Data</a>
          </h4>
<p id="section-3.2.1-1">Note that in some places, MPIs are used to encode non-integer data, such as an elliptic curve (EC) point (see <a class="auto internal xref" href="#ec-point-wire-formats">Section 11.2</a>) or an octet string of known, fixed length (see <a class="auto internal xref" href="#ec-scalar-wire-formats">Section 11.3</a>). The wire representation is the same: 2 octets of length in bits counted from the first non-zero bit, followed by the smallest series of octets that can represent the value while stripping off any leading zero octets.<a class="pilcrow" href="#section-3.2.1-1">¶</a></p>
</section>
</div>
</section>
</div>
<div id="key-ids-and-fingerprints">
<section id="section-3.3">
        <h3 id="name-key-ids-and-fingerprints">
<a class="section-number selfRef" href="#section-3.3">3.3. </a><a class="section-name selfRef" href="#name-key-ids-and-fingerprints">Key IDs and Fingerprints</a>
        </h3>
<p id="section-3.3-1">A Key ID is an 8-octet scalar that identifies a key.
Implementations <span class="bcp14">SHOULD NOT</span> assume that Key IDs are unique.
A fingerprint is more likely to be unique than a Key ID.
The fingerprint and Key ID of a key are calculated differently according to the version of the key.<a class="pilcrow" href="#section-3.3-1">¶</a></p>
<p id="section-3.3-2"><a class="auto internal xref" href="#key-ids-fingerprints">Section 5.5.4</a> describes how Key IDs and Fingerprints are formed.<a class="pilcrow" href="#section-3.3-2">¶</a></p>
</section>
</div>
<div id="text">
<section id="section-3.4">
        <h3 id="name-text">
<a class="section-number selfRef" href="#section-3.4">3.4. </a><a class="section-name selfRef" href="#name-text">Text</a>
        </h3>
<p id="section-3.4-1">Unless otherwise specified, the character set for text is the UTF-8 <span>[<a class="cite xref" href="#RFC3629">RFC3629</a>]</span> encoding of Unicode <span>[<a class="cite xref" href="#ISO10646">ISO10646</a>]</span>.<a class="pilcrow" href="#section-3.4-1">¶</a></p>
</section>
</div>
<div id="time-fields">
<section id="section-3.5">
        <h3 id="name-time-fields">
<a class="section-number selfRef" href="#section-3.5">3.5. </a><a class="section-name selfRef" href="#name-time-fields">Time Fields</a>
        </h3>
<p id="section-3.5-1">A time field is an unsigned 4-octet number containing the number of seconds elapsed since midnight, 1 January 1970 UTC.<a class="pilcrow" href="#section-3.5-1">¶</a></p>
</section>
</div>
<div id="keyrings">
<section id="section-3.6">
        <h3 id="name-keyrings">
<a class="section-number selfRef" href="#section-3.6">3.6. </a><a class="section-name selfRef" href="#name-keyrings">Keyrings</a>
        </h3>
<p id="section-3.6-1">A keyring is a collection of one or more keys in a file or database.
Typically, a keyring is simply a sequential list of keys, but it may be any suitable database.
It is beyond the scope of this specification to discuss the details of keyrings or other databases.<a class="pilcrow" href="#section-3.6-1">¶</a></p>
</section>
</div>
<div id="string-to-key-s2k-specifier">
<section id="section-3.7">
        <h3 id="name-string-to-key-s2k-specifier">
<a class="section-number selfRef" href="#section-3.7">3.7. </a><a class="section-name selfRef" href="#name-string-to-key-s2k-specifier">String-to-Key (S2K) Specifier</a>
        </h3>
<p id="section-3.7-1">A string-to-key (S2K) Specifier is used to convert a passphrase string into a symmetric key encryption/decryption key. Passphrases requiring use of S2K conversion are currently used in two places: to encrypt the secret part of private keys and for symmetrically encrypted messages.<a class="pilcrow" href="#section-3.7-1">¶</a></p>
<div id="s2k-types">
<section id="section-3.7.1">
          <h4 id="name-s2k-specifier-types">
<a class="section-number selfRef" href="#section-3.7.1">3.7.1. </a><a class="section-name selfRef" href="#name-s2k-specifier-types">S2K Specifier Types</a>
          </h4>
<p id="section-3.7.1-1">There are four types of S2K Specifiers currently specified and some reserved values:<a class="pilcrow" href="#section-3.7.1-1">¶</a></p>
<span id="name-openpgp-string-to-key-s2k-t"></span><div id="s2k-types-registry">
<table class="center" id="table-1">
            <caption>
<a class="selfRef" href="#table-1">Table 1</a>:
<a class="selfRef" href="#name-openpgp-string-to-key-s2k-t">OpenPGP String-to-Key (S2K) Types Registry</a>
            </caption>
<thead>
              <tr>
                <th class="text-right" colspan="1" rowspan="1">ID</th>
                <th class="text-left" colspan="1" rowspan="1">S2K Type</th>
                <th class="text-left" colspan="1" rowspan="1">S2K Field Size (Octets)</th>
                <th class="text-left" colspan="1" rowspan="1">Generate?</th>
                <th class="text-left" colspan="1" rowspan="1">Reference</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-right" colspan="1" rowspan="1">0</td>
                <td class="text-left" colspan="1" rowspan="1">Simple S2K</td>
                <td class="text-left" colspan="1" rowspan="1">2</td>
                <td class="text-left" colspan="1" rowspan="1">No</td>
                <td class="text-left" colspan="1" rowspan="1">
                  <a class="auto internal xref" href="#s2k-simple">Section 3.7.1.1</a>
</td>
              </tr>
              <tr>
                <td class="text-right" colspan="1" rowspan="1">1</td>
                <td class="text-left" colspan="1" rowspan="1">Salted S2K</td>
                <td class="text-left" colspan="1" rowspan="1">10</td>
                <td class="text-left" colspan="1" rowspan="1">Only when string is high entropy</td>
                <td class="text-left" colspan="1" rowspan="1">
                  <a class="auto internal xref" href="#s2k-salted">Section 3.7.1.2</a>
</td>
              </tr>
              <tr>
                <td class="text-right" colspan="1" rowspan="1">2</td>
                <td class="text-left" colspan="1" rowspan="1">Reserved value</td>
                <td class="text-left" colspan="1" rowspan="1">-</td>
                <td class="text-left" colspan="1" rowspan="1">No</td>
                <td class="text-left" colspan="1" rowspan="1"></td>
              </tr>
              <tr>
                <td class="text-right" colspan="1" rowspan="1">3</td>
                <td class="text-left" colspan="1" rowspan="1">Iterated and Salted S2K</td>
                <td class="text-left" colspan="1" rowspan="1">11</td>
                <td class="text-left" colspan="1" rowspan="1">Yes</td>
                <td class="text-left" colspan="1" rowspan="1">
                  <a class="auto internal xref" href="#s2k-iter-salted">Section 3.7.1.3</a>
</td>
              </tr>
              <tr>
                <td class="text-right" colspan="1" rowspan="1">4</td>
                <td class="text-left" colspan="1" rowspan="1">Argon2</td>
                <td class="text-left" colspan="1" rowspan="1">20</td>
                <td class="text-left" colspan="1" rowspan="1">Yes</td>
                <td class="text-left" colspan="1" rowspan="1">
                  <a class="auto internal xref" href="#s2k-argon2">Section 3.7.1.4</a>
</td>
              </tr>
              <tr>
                <td class="text-right" colspan="1" rowspan="1">100-110</td>
                <td class="text-left" colspan="1" rowspan="1">Private or Experimental Use</td>
                <td class="text-left" colspan="1" rowspan="1">-</td>
                <td class="text-left" colspan="1" rowspan="1">As appropriate</td>
                <td class="text-left" colspan="1" rowspan="1"></td>
              </tr>
            </tbody>
          </table>
</div>
<p id="section-3.7.1-3">The S2K Specifier Types are described in the subsections below.
If "Yes" is not present in the "Generate?" column, the S2K entry is used only for reading in backward-compatibility mode and <span class="bcp14">SHOULD NOT</span> be used to generate new output.<a class="pilcrow" href="#section-3.7.1-3">¶</a></p>
<div id="s2k-simple">
<section id="section-3.7.1.1">
            <h5 id="name-simple-s2k">
<a class="section-number selfRef" href="#section-3.7.1.1">3.7.1.1. </a><a class="section-name selfRef" href="#name-simple-s2k">Simple S2K</a>
            </h5>
<p id="section-3.7.1.1-1">Simple S2K directly hashes the string to produce the key data. This hashing is done as shown below.<a class="pilcrow" href="#section-3.7.1.1-1">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.7.1.1-2">
<pre>  Octet 0:        0x00
  Octet 1:        hash algorithm
</pre><a class="pilcrow" href="#section-3.7.1.1-2">¶</a>
</div>
<p id="section-3.7.1.1-3">Simple S2K hashes the passphrase to produce the session key.
The manner in which this is done depends on the size of the session key (which depends on the cipher the session key will be used with) and the size of the hash algorithm's output.
If the hash size is greater than the session key size, the high-order (leftmost) octets of the hash are used as the key.<a class="pilcrow" href="#section-3.7.1.1-3">¶</a></p>
<p id="section-3.7.1.1-4">If the hash size is less than the key size, multiple instances of the hash context are created -- enough to produce the required key data. These instances are preloaded with 0, 1, 2, ...
octets of zeros (that is, the first instance has no preloading, the second gets preloaded with 1 octet of zero, the third is preloaded with 2 octets of zeros, and so forth).<a class="pilcrow" href="#section-3.7.1.1-4">¶</a></p>
<p id="section-3.7.1.1-5">As the data is hashed, it is given independently to each hash context. Since the contexts have been initialized differently, they will each produce a different hash output. Once the passphrase is hashed, the output data from the multiple hashes is concatenated, first hash leftmost, to produce the key data, and any excess octets on the right are discarded.<a class="pilcrow" href="#section-3.7.1.1-5">¶</a></p>
</section>
</div>
<div id="s2k-salted">
<section id="section-3.7.1.2">
            <h5 id="name-salted-s2k">
<a class="section-number selfRef" href="#section-3.7.1.2">3.7.1.2. </a><a class="section-name selfRef" href="#name-salted-s2k">Salted S2K</a>
            </h5>
<p id="section-3.7.1.2-1">Salted S2K includes a "salt" value in the S2K Specifier -- some arbitrary data -- that gets hashed along with the passphrase string to help prevent dictionary attacks.<a class="pilcrow" href="#section-3.7.1.2-1">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.7.1.2-2">
<pre>  Octet 0:        0x01
  Octet 1:        hash algorithm
  Octets 2-9:     8-octet salt value
</pre><a class="pilcrow" href="#section-3.7.1.2-2">¶</a>
</div>
<p id="section-3.7.1.2-3">Salted S2K is exactly like Simple S2K, except that the input to the hash function(s) consists of the 8 octets of salt from the S2K Specifier, followed by the passphrase.<a class="pilcrow" href="#section-3.7.1.2-3">¶</a></p>
</section>
</div>
<div id="s2k-iter-salted">
<section id="section-3.7.1.3">
            <h5 id="name-iterated-and-salted-s2k">
<a class="section-number selfRef" href="#section-3.7.1.3">3.7.1.3. </a><a class="section-name selfRef" href="#name-iterated-and-salted-s2k">Iterated and Salted S2K</a>
            </h5>
<p id="section-3.7.1.3-1">Iterated and Salted S2K includes both a salt and an octet count.
The salt is combined with the passphrase, and the resulting value is repeated and then hashed.
This further increases the amount of work an attacker must do to try dictionary attacks.<a class="pilcrow" href="#section-3.7.1.3-1">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.7.1.3-2">
<pre>  Octet  0:        0x03
  Octet  1:        hash algorithm
  Octets 2-9:      8-octet salt value
  Octet  10:       count; a 1-octet coded value
</pre><a class="pilcrow" href="#section-3.7.1.3-2">¶</a>
</div>
<p id="section-3.7.1.3-3">The count is coded into a 1-octet number using the following formula:<a class="pilcrow" href="#section-3.7.1.3-3">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.7.1.3-4">
<pre>  #define EXPBIAS 6
      count = ((Int32)16 + (c &amp; 15)) &lt;&lt; ((c &gt;&gt; 4) + EXPBIAS);
</pre><a class="pilcrow" href="#section-3.7.1.3-4">¶</a>
</div>
<p id="section-3.7.1.3-5">The above formula is described in <span>[<a class="cite xref" href="#C99">C99</a>]</span>, where "Int32" is a type for a 32-bit integer, and the variable "c" is the coded count, octet 10.<a class="pilcrow" href="#section-3.7.1.3-5">¶</a></p>
<p id="section-3.7.1.3-6">Iterated and Salted S2K hashes the passphrase and salt data multiple times.
The total number of octets to be hashed is specified in the encoded count in the S2K Specifier.
     Note that the resulting count value is an octet count of how many octets will be hashed, not an iteration count.<a class="pilcrow" href="#section-3.7.1.3-6">¶</a></p>
<p id="section-3.7.1.3-7">Initially, one or more hash contexts are set up the same as the other S2K algorithms, depending on how many octets of key data are needed. Then the salt, followed by the passphrase data, is repeatedly processed as input to each hash context until the number of octets specified by the octet count has been hashed. The input is truncated to the octet count, except if the octet count is less than the initial size of the salt plus passphrase. That is, at least one copy of the full salt plus passphrase will be provided as input to each hash context regardless of the octet count. After the hashing is done, the key data is produced from the hash digest(s), which is the same way it is produced for the other S2K algorithms.<a class="pilcrow" href="#section-3.7.1.3-7">¶</a></p>
</section>
</div>
<div id="s2k-argon2">
<section id="section-3.7.1.4">
            <h5 id="name-argon2">
<a class="section-number selfRef" href="#section-3.7.1.4">3.7.1.4. </a><a class="section-name selfRef" href="#name-argon2">Argon2</a>
            </h5>
<p id="section-3.7.1.4-1">This S2K method hashes the passphrase using Argon2, as specified in <span>[<a class="cite xref" href="#RFC9106">RFC9106</a>]</span>.
     This provides memory hardness, further protecting the passphrase against brute-force attacks.<a class="pilcrow" href="#section-3.7.1.4-1">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.7.1.4-2">
<pre>  Octet  0:        0x04
  Octets 1-16:     16-octet salt value
  Octet  17:       1-octet number of passes t
  Octet  18:       1-octet degree of parallelism p
  Octet  19:       1-octet encoded_m, specifying the exponent of
                      the memory size
</pre><a class="pilcrow" href="#section-3.7.1.4-2">¶</a>
</div>
<p id="section-3.7.1.4-3">The salt <span class="bcp14">SHOULD</span> be unique for each passphrase.<a class="pilcrow" href="#section-3.7.1.4-3">¶</a></p>
<p id="section-3.7.1.4-4">The number of passes t and the degree of parallelism p <span class="bcp14">MUST</span> be non-zero.<a class="pilcrow" href="#section-3.7.1.4-4">¶</a></p>
<p id="section-3.7.1.4-5">The memory size m is 2<sup><code>encoded_m</code></sup> kibibytes (KiB) of RAM.
The encoded memory size <span class="bcp14">MUST</span> be a value from 3+ceil(log<sub>2</sub>(p)) to 31, such that the decoded memory size m is a value from 8*p to 2<sup>31</sup>. Note that memory-hardness size is indicated in KiB, not octets.<a class="pilcrow" href="#section-3.7.1.4-5">¶</a></p>
<p id="section-3.7.1.4-6">Argon2 is invoked with the passphrase as P, the salt as S, the values of t, p, and m as described above, the required key size as the tag length T, 0x13 as the version v, and Argon2id as the type.<a class="pilcrow" href="#section-3.7.1.4-6">¶</a></p>
<p id="section-3.7.1.4-7">For the recommended values of t, p, and m, see <span><a class="relref" href="https://rfc-editor.org/rfc/rfc9106#section-4">Section 4</a> of [<a class="cite xref" href="#RFC9106">RFC9106</a>]</span>.
If the recommended value of m for a given application is not a power of 2, it is <span class="bcp14">RECOMMENDED</span> to round up to the next power of 2 if the resulting performance would be acceptable; otherwise, round down (keeping in mind that m must be at least 8*p).<a class="pilcrow" href="#section-3.7.1.4-7">¶</a></p>
<p id="section-3.7.1.4-8">As an example, with the first recommended option (t=1, p=4, m=2<sup>21</sup>), the full S2K Specifier would be:<a class="pilcrow" href="#section-3.7.1.4-8">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.7.1.4-9">
<pre>  04 XX XX XX XX XX XX XX XX XX XX XX XX XX XX XX
  XX 01 04 15
</pre><a class="pilcrow" href="#section-3.7.1.4-9">¶</a>
</div>
<p id="section-3.7.1.4-10">where XX represents a random octet of salt.<a class="pilcrow" href="#section-3.7.1.4-10">¶</a></p>
</section>
</div>
</section>
</div>
<div id="s2k-usage-octet">
<section id="section-3.7.2">
          <h4 id="name-s2k-usage">
<a class="section-number selfRef" href="#section-3.7.2">3.7.2. </a><a class="section-name selfRef" href="#name-s2k-usage">S2K Usage</a>
          </h4>
<p id="section-3.7.2-1">Simple S2K and Salted S2K Specifiers can be brute-forced when used with a low-entropy string, such as those typically provided by users.
In addition, the usage of Simple S2K can lead to key and initialization vector (IV) reuse (see <a class="auto internal xref" href="#skesk">Section 5.3</a>).
Therefore, when generating an S2K Specifier, an implementation <span class="bcp14">MUST NOT</span> use Simple S2K.
Furthermore, an implementation <span class="bcp14">SHOULD NOT</span> generate a Salted S2K unless the implementation knows that the input string is high entropy (for example, it generated the string itself using a known good source of randomness).<a class="pilcrow" href="#section-3.7.2-1">¶</a></p>
<p id="section-3.7.2-2">It is <span class="bcp14">RECOMMENDED</span> that implementations use Argon2.
If Argon2 is not available, Iterated and Salted S2K <span class="bcp14">MAY</span> be used if care is taken to use a high octet count and a strong passphrase.
However, this method does not provide memory hardness, unlike Argon2.<a class="pilcrow" href="#section-3.7.2-2">¶</a></p>
<div id="secret-key-encryption">
<section id="section-3.7.2.1">
            <h5 id="name-secret-key-encryption">
<a class="section-number selfRef" href="#section-3.7.2.1">3.7.2.1. </a><a class="section-name selfRef" href="#name-secret-key-encryption">Secret Key Encryption</a>
            </h5>
<p id="section-3.7.2.1-1">The first octet following the public key material in a Secret Key packet (<a class="auto internal xref" href="#secret-key-packet-formats">Section 5.5.3</a>) indicates whether and how the secret key material is passphrase protected.
This first octet is known as the "S2K usage octet".<a class="pilcrow" href="#section-3.7.2.1-1">¶</a></p>
<p id="section-3.7.2.1-2">If the S2K usage octet is zero, the secret key data is unprotected.
If it is non-zero, it describes how to use a passphrase to unlock the secret key.<a class="pilcrow" href="#section-3.7.2.1-2">¶</a></p>
<p id="section-3.7.2.1-3">Implementations predating <span>[<a class="cite xref" href="#RFC2440">RFC2440</a>]</span> indicated a protected key by storing a Symmetric Cipher Algorithm ID (see <a class="auto internal xref" href="#symmetric-algos">Section 9.3</a>) in the S2K usage octet.
In this case, the MD5 hash function was always used to convert the passphrase to a key for the specified cipher algorithm.<a class="pilcrow" href="#section-3.7.2.1-3">¶</a></p>
<p id="section-3.7.2.1-4">Later implementations indicate a protected secret key by storing one of the special values 253 (AEAD), 254 (CFB), or 255 (MalleableCFB) in the S2K usage octet. The S2K usage octet is then followed immediately by a set of fields that describe how to convert a passphrase to a symmetric key that can unlock the secret material, plus other parameters relevant to the type of encryption used.<a class="pilcrow" href="#section-3.7.2.1-4">¶</a></p>
<p id="section-3.7.2.1-5">The wire format fields also differ based on the version of the enclosing OpenPGP packet.
     The table below, indexed by the S2K usage octet, summarizes the specifics described in <a class="auto internal xref" href="#secret-key-packet-formats">Section 5.5.3</a>.<a class="pilcrow" href="#section-3.7.2.1-5">¶</a></p>
<p id="section-3.7.2.1-6">In the table below, <code>check(x)</code> means the "2-octet checksum", which is the sum of all octets in x mod 65536. The <code>info</code> and <code>packetprefix</code> parameters are described in detail in <a class="auto internal xref" href="#secret-key-packet-formats">Section 5.5.3</a>.  Note that the "Generate?" column header has been shortened to "Gen?" here.<a class="pilcrow" href="#section-3.7.2.1-6">¶</a></p>
<span id="name-openpgp-secret-key-encrypti"></span><div id="secret-key-protection-registry">
<table class="center" id="table-2">
              <caption>
<a class="selfRef" href="#table-2">Table 2</a>:
<a class="selfRef" href="#name-openpgp-secret-key-encrypti">OpenPGP Secret Key Encryption (S2K Usage Octet) Registry</a>
              </caption>
<thead>
                <tr>
                  <th class="text-left" colspan="1" rowspan="1">S2K Usage Octet</th>
                  <th class="text-left" colspan="1" rowspan="1">Shorthand</th>
                  <th class="text-left" colspan="1" rowspan="1">Encryption Parameter Fields</th>
                  <th class="text-left" colspan="1" rowspan="1">Encryption</th>
                  <th class="text-left" colspan="1" rowspan="1">Gen?</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">0</td>
                  <td class="text-left" colspan="1" rowspan="1">Unprotected</td>
                  <td class="text-left" colspan="1" rowspan="1">-</td>
                  <td class="text-left" colspan="1" rowspan="1">
                    <strong>v3 or v4 keys:</strong> [cleartext secrets || check(secrets)] <br/>
                    <strong>v6 keys:</strong> [cleartext secrets]
                   </td>
                  <td class="text-left" colspan="1" rowspan="1">Yes</td>
                </tr>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">Known symmetric cipher algo ID (see <a class="auto internal xref" href="#symmetric-algos">Section 9.3</a>)</td>
                  <td class="text-left" colspan="1" rowspan="1">LegacyCFB</td>
                  <td class="text-left" colspan="1" rowspan="1">IV</td>
                  <td class="text-left" colspan="1" rowspan="1">CFB(MD5(passphrase), secrets || check(secrets))</td>
                  <td class="text-left" colspan="1" rowspan="1">No</td>
                </tr>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">253</td>
                  <td class="text-left" colspan="1" rowspan="1">AEAD</td>
                  <td class="text-left" colspan="1" rowspan="1">params-length (<strong>v6-only</strong>), cipher-algo, AEAD-mode, S2K-specifier-length (<strong>v6-only</strong>), S2K-specifier, nonce
</td>
                  <td class="text-left" colspan="1" rowspan="1">AEAD(HKDF(S2K(passphrase), info), secrets, packetprefix)</td>
                  <td class="text-left" colspan="1" rowspan="1">Yes</td>
                </tr>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">254</td>
                  <td class="text-left" colspan="1" rowspan="1">CFB</td>
                  <td class="text-left" colspan="1" rowspan="1">params-length (<strong>v6-only</strong>), cipher-algo, S2K-specifier-length (<strong>v6-only</strong>), S2K-specifier, IV</td>
                  <td class="text-left" colspan="1" rowspan="1">CFB(S2K(passphrase), secrets || SHA1(secrets))</td>
                  <td class="text-left" colspan="1" rowspan="1">Yes</td>
                </tr>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">255</td>
                  <td class="text-left" colspan="1" rowspan="1">MalleableCFB</td>
                  <td class="text-left" colspan="1" rowspan="1">cipher-algo, S2K-specifier, IV</td>
                  <td class="text-left" colspan="1" rowspan="1">CFB(S2K(passphrase), secrets || check(secrets))</td>
                  <td class="text-left" colspan="1" rowspan="1">No</td>
                </tr>
              </tbody>
            </table>
</div>
<p id="section-3.7.2.1-8">When emitting a secret key (with or without passphrase protection), an implementation <span class="bcp14">MUST</span> only produce data from a row with "Generate?" marked as "Yes".
Each row with "Generate?" marked as "No" is described for backward compatibility (for reading version 4 and earlier keys only) and <span class="bcp14">MUST NOT</span> be used to generate new output.
Version 6 secret keys using these formats <span class="bcp14">MUST</span> be rejected.<a class="pilcrow" href="#section-3.7.2.1-8">¶</a></p>
<p id="section-3.7.2.1-9">Note that compared to a version 4 secret key, the parameters of a passphrase-protected version 6 secret key are stored with an additional pair of length counts, each of which is 1 octet wide.<a class="pilcrow" href="#section-3.7.2.1-9">¶</a></p>
<p id="section-3.7.2.1-10">Argon2 is only used with Authenticated Encryption with Associated Data (AEAD) (S2K usage octet 253).
An implementation <span class="bcp14">MUST NOT</span> create and <span class="bcp14">MUST</span> reject as malformed any Secret Key packet where the S2K usage octet is not AEAD (253) and the S2K Specifier Type is Argon2.<a class="pilcrow" href="#section-3.7.2.1-10">¶</a></p>
</section>
</div>
<div id="symmetric-key-message-encryption">
<section id="section-3.7.2.2">
            <h5 id="name-symmetric-key-message-encry">
<a class="section-number selfRef" href="#section-3.7.2.2">3.7.2.2. </a><a class="section-name selfRef" href="#name-symmetric-key-message-encry">Symmetric Key Message Encryption</a>
            </h5>
<p id="section-3.7.2.2-1">OpenPGP can create a Symmetric Key Encrypted Session Key (SKESK) packet at the front of a message.
     This is used to allow S2K Specifiers to be used for the passphrase conversion or to create messages with a mix of SKESK packets and PKESK packets. This allows a message to be decrypted with either a passphrase or a public key pair.<a class="pilcrow" href="#section-3.7.2.2-1">¶</a></p>
<p id="section-3.7.2.2-2">Implementations predating <span>[<a class="cite xref" href="#RFC2440">RFC2440</a>]</span> always used the International Data Encryption Algorithm (IDEA) with Simple S2K conversion when encrypting a message with a symmetric algorithm;
see <a class="auto internal xref" href="#sed">Section 5.7</a>. IDEA <span class="bcp14">MUST NOT</span> be generated but <span class="bcp14">MAY</span> be consumed for backward compatibility.<a class="pilcrow" href="#section-3.7.2.2-2">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="packet-syntax">
<section id="section-4">
      <h2 id="name-packet-syntax">
<a class="section-number selfRef" href="#section-4">4. </a><a class="section-name selfRef" href="#name-packet-syntax">Packet Syntax</a>
      </h2>
<p id="section-4-1">This section describes the packets used by OpenPGP.<a class="pilcrow" href="#section-4-1">¶</a></p>
<div id="overview">
<section id="section-4.1">
        <h3 id="name-overview">
<a class="section-number selfRef" href="#section-4.1">4.1. </a><a class="section-name selfRef" href="#name-overview">Overview</a>
        </h3>
<p id="section-4.1-1">An OpenPGP Message is constructed from a number of records that are typically called packets.
A packet is a chunk of data that has a Type ID specifying its meaning.
An OpenPGP Message, keyring, certificate, detached signature, and so forth consists of a number of packets.
Some of those packets may contain other OpenPGP packets (for example, a compressed data packet, when uncompressed, contains OpenPGP packets).<a class="pilcrow" href="#section-4.1-1">¶</a></p>
<p id="section-4.1-2">Each packet consists of a packet header, followed by the packet body.
The packet header is of variable length.<a class="pilcrow" href="#section-4.1-2">¶</a></p>
<p id="section-4.1-3">When handling a stream of packets, the length information in each packet header is the canonical source of packet boundaries.
An implementation handling a packet stream that wants to find the next packet <span class="bcp14">MUST</span> look for it at the precise offset indicated in the previous packet header.<a class="pilcrow" href="#section-4.1-3">¶</a></p>
<p id="section-4.1-4">Additionally, some packets contain internal length indicators (for example, a subfield within the packet).
In the event that a subfield length indicator within a packet implies inclusion of octets outside the range indicated in the packet header, a parser <span class="bcp14">MUST</span> abort without writing outside the indicated range and <span class="bcp14">MUST</span> treat the packet as malformed and unusable.<a class="pilcrow" href="#section-4.1-4">¶</a></p>
<p id="section-4.1-5">An implementation <span class="bcp14">MUST NOT</span> interpret octets outside the range indicated in the packet header as part of the contents of the packet.<a class="pilcrow" href="#section-4.1-5">¶</a></p>
</section>
</div>
<div id="packet-headers">
<section id="section-4.2">
        <h3 id="name-packet-headers">
<a class="section-number selfRef" href="#section-4.2">4.2. </a><a class="section-name selfRef" href="#name-packet-headers">Packet Headers</a>
        </h3>
<p id="section-4.2-1">The first octet of the packet denotes the format of the rest of the header, and it encodes the Packet Type ID, indicating the type of the packet (see <a class="auto internal xref" href="#packet-types">Section 5</a>). The remainder of the packet header is the length of the packet.<a class="pilcrow" href="#section-4.2-1">¶</a></p>
<p id="section-4.2-2">There are two packet formats: 1) the (current) OpenPGP packet format specified by this document and its predecessors <span>[<a class="cite xref" href="#RFC4880">RFC4880</a>]</span> and <span>[<a class="cite xref" href="#RFC2440">RFC2440</a>]</span> and 2) the Legacy packet format as used by implementations predating any IETF specification of OpenPGP.<a class="pilcrow" href="#section-4.2-2">¶</a></p>
<p id="section-4.2-3">Note that the most significant bit is the leftmost bit, called "bit 7".
A mask for this bit is 0x80 in hexadecimal.<a class="pilcrow" href="#section-4.2-3">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2-4">
<pre>                          +---------------+
  Encoded Packet Type ID: |7 6 5 4 3 2 1 0|
                          +---------------+
  OpenPGP format:
    Bit 7 -- always one
    Bit 6 -- always one
    Bits 5 to 0 -- Packet Type ID

  Legacy format:
    Bit 7 -- always one
    Bit 6 -- always zero
    Bits 5 to 2 -- Packet Type ID
    Bits 1 to 0 -- length-type
</pre><a class="pilcrow" href="#section-4.2-4">¶</a>
</div>
<p id="section-4.2-5">Bit 6 of the first octet of the packet header indicates whether the packet is encoded in the OpenPGP or Legacy packet format.
The Legacy packet format <span class="bcp14">MAY</span> be used when consuming packets to facilitate interoperability and accessing archived data.
The Legacy packet format <span class="bcp14">SHOULD NOT</span> be used to generate new data, unless the recipient is known to only support the Legacy packet format. This latter case is extremely unlikely, as the Legacy packet format was obsoleted by <span>[<a class="cite xref" href="#RFC2440">RFC2440</a>]</span> in 1998.<a class="pilcrow" href="#section-4.2-5">¶</a></p>
<p id="section-4.2-6">An implementation that consumes and redistributes pre-existing OpenPGP data (such as Transferable Public Keys) may encounter packets framed with the Legacy packet format. Such an implementation <span class="bcp14">MAY</span> either redistribute these packets in their Legacy format or transform them to the current OpenPGP packet format before redistribution.<a class="pilcrow" href="#section-4.2-6">¶</a></p>
<p id="section-4.2-7">Note that Legacy format headers only have 4 bits for the Packet Type ID and hence can only encode Packet Type IDs less than 16, whereas the OpenPGP format headers can encode IDs as great as 63.<a class="pilcrow" href="#section-4.2-7">¶</a></p>
<div id="openpgp-packet-format">
<section id="section-4.2.1">
          <h4 id="name-openpgp-format-packet-lengt">
<a class="section-number selfRef" href="#section-4.2.1">4.2.1. </a><a class="section-name selfRef" href="#name-openpgp-format-packet-lengt">OpenPGP Format Packet Lengths</a>
          </h4>
<p id="section-4.2.1-1">OpenPGP format packets have four possible ways of encoding length:<a class="pilcrow" href="#section-4.2.1-1">¶</a></p>
<ol class="normal type-1" id="section-4.2.1-2" start="1" type="1">
<li id="section-4.2.1-2.1">
              <p id="section-4.2.1-2.1.1">A 1-octet Body Length header encodes packet lengths of up to 191 octets.<a class="pilcrow" href="#section-4.2.1-2.1.1">¶</a></p>
</li>
            <li id="section-4.2.1-2.2">
              <p id="section-4.2.1-2.2.1">A 2-octet Body Length header encodes packet lengths of 192 to 8383 octets.<a class="pilcrow" href="#section-4.2.1-2.2.1">¶</a></p>
</li>
            <li id="section-4.2.1-2.3">
              <p id="section-4.2.1-2.3.1">A 5-octet Body Length header encodes packet lengths of up to 4,294,967,295 (0xFFFFFFFF) octets in length.
(This actually encodes a 4-octet scalar number.)<a class="pilcrow" href="#section-4.2.1-2.3.1">¶</a></p>
</li>
            <li id="section-4.2.1-2.4">
              <p id="section-4.2.1-2.4.1">When the length of the packet body is not known in advance by the issuer, Partial Body Length headers encode a packet of indeterminate length, effectively making it a stream.<a class="pilcrow" href="#section-4.2.1-2.4.1">¶</a></p>
</li>
          </ol>
<div id="one-octet-lengths">
<section id="section-4.2.1.1">
            <h5 id="name-1-octet-lengths">
<a class="section-number selfRef" href="#section-4.2.1.1">4.2.1.1. </a><a class="section-name selfRef" href="#name-1-octet-lengths">1-Octet Lengths</a>
            </h5>
<p id="section-4.2.1.1-1">A 1-octet Body Length header encodes a length of 0 to 191 octets.
This type of length header is recognized because the 1-octet value is less than 192.
The body length is equal to:<a class="pilcrow" href="#section-4.2.1.1-1">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.1.1-2">
<pre>  bodyLen = 1st_octet;
</pre><a class="pilcrow" href="#section-4.2.1.1-2">¶</a>
</div>
</section>
</div>
<div id="two-octet-lengths">
<section id="section-4.2.1.2">
            <h5 id="name-2-octet-lengths">
<a class="section-number selfRef" href="#section-4.2.1.2">4.2.1.2. </a><a class="section-name selfRef" href="#name-2-octet-lengths">2-Octet Lengths</a>
            </h5>
<p id="section-4.2.1.2-1">A 2-octet Body Length header encodes a length of 192 to 8383 octets.
It is recognized because its first octet is in the range 192 to 223.
The body length is equal to:<a class="pilcrow" href="#section-4.2.1.2-1">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.1.2-2">
<pre>  bodyLen = ((1st_octet - 192) &lt;&lt; 8) + (2nd_octet) + 192
</pre><a class="pilcrow" href="#section-4.2.1.2-2">¶</a>
</div>
</section>
</div>
<div id="five-octet-lengths">
<section id="section-4.2.1.3">
            <h5 id="name-5-octet-lengths">
<a class="section-number selfRef" href="#section-4.2.1.3">4.2.1.3. </a><a class="section-name selfRef" href="#name-5-octet-lengths">5-Octet Lengths</a>
            </h5>
<p id="section-4.2.1.3-1">A 5-octet Body Length header consists of a single octet holding the value 255, followed by a 4-octet scalar. The body length is equal to:<a class="pilcrow" href="#section-4.2.1.3-1">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.1.3-2">
<pre>  bodyLen = (2nd_octet &lt;&lt; 24) | (3rd_octet &lt;&lt; 16) |
            (4th_octet &lt;&lt; 8)  | 5th_octet
</pre><a class="pilcrow" href="#section-4.2.1.3-2">¶</a>
</div>
<p id="section-4.2.1.3-3">This basic set of 1-octet, 2-octet, and 5-octet lengths is also used internally to some packets.<a class="pilcrow" href="#section-4.2.1.3-3">¶</a></p>
</section>
</div>
<div id="partial-body-lengths">
<section id="section-4.2.1.4">
            <h5 id="name-partial-body-lengths">
<a class="section-number selfRef" href="#section-4.2.1.4">4.2.1.4. </a><a class="section-name selfRef" href="#name-partial-body-lengths">Partial Body Lengths</a>
            </h5>
<p id="section-4.2.1.4-1">A Partial Body Length header is 1 octet long and encodes the length of only part of the data packet.
This length is a power of 2, from 1 to 1,073,741,824 (2 to the 30th power).
It is recognized by its 1-octet value that is greater than or equal to 224, and less than 255.
The Partial Body Length is equal to:<a class="pilcrow" href="#section-4.2.1.4-1">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.1.4-2">
<pre>  partialBodyLen = 1 &lt;&lt; (1st_octet &amp; 0x1F);
</pre><a class="pilcrow" href="#section-4.2.1.4-2">¶</a>
</div>
<p id="section-4.2.1.4-3">Each Partial Body Length header is followed by a portion of the packet body data;
the Partial Body Length header specifies this portion's length.
Another length header (1-octet, 2-octet, 5-octet, or partial) follows that portion.
The last length header in the packet <span class="bcp14">MUST NOT</span> be a Partial Body Length header.
Partial Body Length headers may only be used for the non-final parts of the packet.<a class="pilcrow" href="#section-4.2.1.4-3">¶</a></p>
<p id="section-4.2.1.4-4">Note also that the last Body Length header can be a zero-length header.<a class="pilcrow" href="#section-4.2.1.4-4">¶</a></p>
<p id="section-4.2.1.4-5">An implementation <span class="bcp14">MAY</span> use Partial Body Lengths for data packets, whether they are literal, compressed, or encrypted. The first partial length <span class="bcp14">MUST</span> be at least 512 octets long.
Partial Body Lengths <span class="bcp14">MUST NOT</span> be used for any other packet types.<a class="pilcrow" href="#section-4.2.1.4-5">¶</a></p>
</section>
</div>
</section>
</div>
<div id="legacy-packet-format">
<section id="section-4.2.2">
          <h4 id="name-legacy-format-packet-length">
<a class="section-number selfRef" href="#section-4.2.2">4.2.2. </a><a class="section-name selfRef" href="#name-legacy-format-packet-length">Legacy Format Packet Lengths</a>
          </h4>
<p id="section-4.2.2-1">A zero in bit 6 of the first octet of the packet indicates a Legacy packet format.
Bits 1 and 0 of the first octet of a Legacy packet are the "length-type" field.
The meaning of length-type in Legacy format packets is as follows:<a class="pilcrow" href="#section-4.2.2-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.2.2-2">
            <dt id="section-4.2.2-2.1">0</dt>
            <dd id="section-4.2.2-2.2" style="margin-left: 1.5em">The packet has a 1-octet length. The header is 2 octets long.<a class="pilcrow" href="#section-4.2.2-2.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.2.2-2.3">1</dt>
            <dd id="section-4.2.2-2.4" style="margin-left: 1.5em">The packet has a 2-octet length. The header is 3 octets long.<a class="pilcrow" href="#section-4.2.2-2.4">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.2.2-2.5">2</dt>
            <dd id="section-4.2.2-2.6" style="margin-left: 1.5em">The packet has a 4-octet length. The header is 5 octets long.<a class="pilcrow" href="#section-4.2.2-2.6">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.2.2-2.7">3</dt>
            <dd id="section-4.2.2-2.8" style="margin-left: 1.5em">The packet is of indeterminate length.
The header is 1 octet long, and the implementation must determine how long the packet is.
If the packet is in a file, it means that the packet extends until the end of the file.
The OpenPGP format headers have a mechanism for precisely encoding data of indeterminate length.
An implementation <span class="bcp14">MUST NOT</span> generate a Legacy format packet with indeterminate length.
An implementation <span class="bcp14">MAY</span> interpret an indeterminate length Legacy format packet in order to deal with historic data or data generated by a legacy system that predates support for <span>[<a class="cite xref" href="#RFC2440">RFC2440</a>]</span>.<a class="pilcrow" href="#section-4.2.2-2.8">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="packet-length-examples">
<section id="section-4.2.3">
          <h4 id="name-packet-length-examples">
<a class="section-number selfRef" href="#section-4.2.3">4.2.3. </a><a class="section-name selfRef" href="#name-packet-length-examples">Packet Length Examples</a>
          </h4>
<p id="section-4.2.3-1">These examples show ways that OpenPGP format packets might encode the packet body lengths.<a class="pilcrow" href="#section-4.2.3-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.3-2.1">A packet body with length 100 may have its length encoded in one octet: 0x64.
This is followed by 100 octets of data.<a class="pilcrow" href="#section-4.2.3-2.1">¶</a>
</li>
            <li class="normal" id="section-4.2.3-2.2">A packet body with length 1723 may have its length encoded in two octets: 0xC5, 0xFB.
This header is followed by the 1723 octets of data.<a class="pilcrow" href="#section-4.2.3-2.2">¶</a>
</li>
            <li class="normal" id="section-4.2.3-2.3">A packet body with length 100000 may have its length encoded in five octets: 0xFF, 0x00, 0x01, 0x86, 0xA0.<a class="pilcrow" href="#section-4.2.3-2.3">¶</a>
</li>
          </ul>
<p id="section-4.2.3-3">It might also be encoded in the following octet stream:<a class="pilcrow" href="#section-4.2.3-3">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.3-4.1">0xEF, first 32768 octets of data;<a class="pilcrow" href="#section-4.2.3-4.1">¶</a>
</li>
            <li class="normal" id="section-4.2.3-4.2">0xE1, next 2 octets of data;<a class="pilcrow" href="#section-4.2.3-4.2">¶</a>
</li>
            <li class="normal" id="section-4.2.3-4.3">0xE0, next 1 octet of data;<a class="pilcrow" href="#section-4.2.3-4.3">¶</a>
</li>
            <li class="normal" id="section-4.2.3-4.4">0xF0, next 65536 octets of data; and<a class="pilcrow" href="#section-4.2.3-4.4">¶</a>
</li>
            <li class="normal" id="section-4.2.3-4.5">0xC5, 0xDD, last 1693 octets of data.<a class="pilcrow" href="#section-4.2.3-4.5">¶</a>
</li>
          </ul>
<p id="section-4.2.3-5">This is just one possible encoding, and many variations are possible on the size of the Partial Body Length headers, as long as a regular Body Length header encodes the last portion of the data.<a class="pilcrow" href="#section-4.2.3-5">¶</a></p>
<p id="section-4.2.3-6">Please note that in all of these explanations, the total length of the packet is the length of the header(s) plus the length of the body.<a class="pilcrow" href="#section-4.2.3-6">¶</a></p>
</section>
</div>
</section>
</div>
<div id="packet-criticality">
<section id="section-4.3">
        <h3 id="name-packet-criticality">
<a class="section-number selfRef" href="#section-4.3">4.3. </a><a class="section-name selfRef" href="#name-packet-criticality">Packet Criticality</a>
        </h3>
<p id="section-4.3-1">The Packet Type ID space is partitioned into critical packets and non-critical packets.
If an implementation encounters a critical packet where the packet type is unknown in a packet sequence, it <span class="bcp14">MUST</span> reject the whole packet sequence (see <a class="auto internal xref" href="#packet-sequence-composition">Section 10</a>).
On the other hand, an unknown non-critical packet <span class="bcp14">MUST</span> be ignored.<a class="pilcrow" href="#section-4.3-1">¶</a></p>
<p id="section-4.3-2">Packets with Type IDs from 0 to 39 are critical.
Packets with Type IDs from 40 to 63 are non-critical.<a class="pilcrow" href="#section-4.3-2">¶</a></p>
</section>
</div>
</section>
</div>
<div id="packet-types">
<section id="section-5">
      <h2 id="name-packet-types">
<a class="section-number selfRef" href="#section-5">5. </a><a class="section-name selfRef" href="#name-packet-types">Packet Types</a>
      </h2>
<p id="section-5-1">The defined packet types are as follows:<a class="pilcrow" href="#section-5-1">¶</a></p>
<span id="name-openpgp-packet-types-regist"></span><div id="packet-types-registry">
<table class="center" id="table-3">
        <caption>
<a class="selfRef" href="#table-3">Table 3</a>:
<a class="selfRef" href="#name-openpgp-packet-types-regist">OpenPGP Packet Types Registry</a>
        </caption>
<thead>
          <tr>
            <th class="text-right" colspan="1" rowspan="1">ID</th>
            <th class="text-left" colspan="1" rowspan="1">Critical</th>
            <th class="text-left" colspan="1" rowspan="1">Packet Type Description</th>
            <th class="text-left" colspan="1" rowspan="1">Shorthand</th>
            <th class="text-left" colspan="1" rowspan="1">Reference</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-right" colspan="1" rowspan="1">0</td>
            <td class="text-left" colspan="1" rowspan="1">Yes</td>
            <td class="text-left" colspan="1" rowspan="1">Reserved - this Packet Type ID <span class="bcp14">MUST NOT</span> be used</td>
            <td class="text-left" colspan="1" rowspan="1"> </td>
            <td class="text-left" colspan="1" rowspan="1"></td>
          </tr>
          <tr>
            <td class="text-right" colspan="1" rowspan="1">1</td>
            <td class="text-left" colspan="1" rowspan="1">Yes</td>
            <td class="text-left" colspan="1" rowspan="1">Public Key Encrypted Session Key Packet</td>
            <td class="text-left" colspan="1" rowspan="1">PKESK</td>
            <td class="text-left" colspan="1" rowspan="1">
              <a class="auto internal xref" href="#pkesk">Section 5.1</a>
</td>
          </tr>
          <tr>
            <td class="text-right" colspan="1" rowspan="1">2</td>
            <td class="text-left" colspan="1" rowspan="1">Yes</td>
            <td class="text-left" colspan="1" rowspan="1">Signature Packet</td>
            <td class="text-left" colspan="1" rowspan="1">SIG</td>
            <td class="text-left" colspan="1" rowspan="1">
              <a class="auto internal xref" href="#signature-packet">Section 5.2</a>
</td>
          </tr>
          <tr>
            <td class="text-right" colspan="1" rowspan="1">3</td>
            <td class="text-left" colspan="1" rowspan="1">Yes</td>
            <td class="text-left" colspan="1" rowspan="1">Symmetric Key Encrypted Session Key Packet</td>
            <td class="text-left" colspan="1" rowspan="1">SKESK</td>
            <td class="text-left" colspan="1" rowspan="1">
              <a class="auto internal xref" href="#skesk">Section 5.3</a>
</td>
          </tr>
          <tr>
            <td class="text-right" colspan="1" rowspan="1">4</td>
            <td class="text-left" colspan="1" rowspan="1">Yes</td>
            <td class="text-left" colspan="1" rowspan="1">One-Pass Signature Packet</td>
            <td class="text-left" colspan="1" rowspan="1">OPS</td>
            <td class="text-left" colspan="1" rowspan="1">
              <a class="auto internal xref" href="#one-pass-sig">Section 5.4</a>
</td>
          </tr>
          <tr>
            <td class="text-right" colspan="1" rowspan="1">5</td>
            <td class="text-left" colspan="1" rowspan="1">Yes</td>
            <td class="text-left" colspan="1" rowspan="1">Secret Key Packet</td>
            <td class="text-left" colspan="1" rowspan="1">SECKEY</td>
            <td class="text-left" colspan="1" rowspan="1">
              <a class="auto internal xref" href="#seckey">Section 5.5.1.3</a>
</td>
          </tr>
          <tr>
            <td class="text-right" colspan="1" rowspan="1">6</td>
            <td class="text-left" colspan="1" rowspan="1">Yes</td>
            <td class="text-left" colspan="1" rowspan="1">Public Key Packet</td>
            <td class="text-left" colspan="1" rowspan="1">PUBKEY</td>
            <td class="text-left" colspan="1" rowspan="1">
              <a class="auto internal xref" href="#pubkey">Section 5.5.1.1</a>
</td>
          </tr>
          <tr>
            <td class="text-right" colspan="1" rowspan="1">7</td>
            <td class="text-left" colspan="1" rowspan="1">Yes</td>
            <td class="text-left" colspan="1" rowspan="1">Secret Subkey Packet</td>
            <td class="text-left" colspan="1" rowspan="1">SECSUBKEY</td>
            <td class="text-left" colspan="1" rowspan="1">
              <a class="auto internal xref" href="#secsubkey">Section 5.5.1.4</a>
</td>
          </tr>
          <tr>
            <td class="text-right" colspan="1" rowspan="1">8</td>
            <td class="text-left" colspan="1" rowspan="1">Yes</td>
            <td class="text-left" colspan="1" rowspan="1">Compressed Data Packet</td>
            <td class="text-left" colspan="1" rowspan="1">COMP</td>
            <td class="text-left" colspan="1" rowspan="1">
              <a class="auto internal xref" href="#compressed-data">Section 5.6</a>
</td>
          </tr>
          <tr>
            <td class="text-right" colspan="1" rowspan="1">9</td>
            <td class="text-left" colspan="1" rowspan="1">Yes</td>
            <td class="text-left" colspan="1" rowspan="1">Symmetrically Encrypted Data Packet</td>
            <td class="text-left" colspan="1" rowspan="1">SED</td>
            <td class="text-left" colspan="1" rowspan="1">
              <a class="auto internal xref" href="#sed">Section 5.7</a>
</td>
          </tr>
          <tr>
            <td class="text-right" colspan="1" rowspan="1">10</td>
            <td class="text-left" colspan="1" rowspan="1">Yes</td>
            <td class="text-left" colspan="1" rowspan="1">Marker Packet</td>
            <td class="text-left" colspan="1" rowspan="1">MARKER</td>
            <td class="text-left" colspan="1" rowspan="1">
              <a class="auto internal xref" href="#marker-packet">Section 5.8</a>
</td>
          </tr>
          <tr>
            <td class="text-right" colspan="1" rowspan="1">11</td>
            <td class="text-left" colspan="1" rowspan="1">Yes</td>
            <td class="text-left" colspan="1" rowspan="1">Literal Data Packet</td>
            <td class="text-left" colspan="1" rowspan="1">LIT</td>
            <td class="text-left" colspan="1" rowspan="1">
              <a class="auto internal xref" href="#lit">Section 5.9</a>
</td>
          </tr>
          <tr>
            <td class="text-right" colspan="1" rowspan="1">12</td>
            <td class="text-left" colspan="1" rowspan="1">Yes</td>
            <td class="text-left" colspan="1" rowspan="1">Trust Packet</td>
            <td class="text-left" colspan="1" rowspan="1">TRUST</td>
            <td class="text-left" colspan="1" rowspan="1">
              <a class="auto internal xref" href="#trust">Section 5.10</a>
</td>
          </tr>
          <tr>
            <td class="text-right" colspan="1" rowspan="1">13</td>
            <td class="text-left" colspan="1" rowspan="1">Yes</td>
            <td class="text-left" colspan="1" rowspan="1">User ID Packet</td>
            <td class="text-left" colspan="1" rowspan="1">UID</td>
            <td class="text-left" colspan="1" rowspan="1">
              <a class="auto internal xref" href="#uid">Section 5.11</a>
</td>
          </tr>
          <tr>
            <td class="text-right" colspan="1" rowspan="1">14</td>
            <td class="text-left" colspan="1" rowspan="1">Yes</td>
            <td class="text-left" colspan="1" rowspan="1">Public Subkey Packet</td>
            <td class="text-left" colspan="1" rowspan="1">PUBSUBKEY</td>
            <td class="text-left" colspan="1" rowspan="1">
              <a class="auto internal xref" href="#pubsubkey">Section 5.5.1.2</a>
</td>
          </tr>
          <tr>
            <td class="text-right" colspan="1" rowspan="1">17</td>
            <td class="text-left" colspan="1" rowspan="1">Yes</td>
            <td class="text-left" colspan="1" rowspan="1">User Attribute Packet</td>
            <td class="text-left" colspan="1" rowspan="1">UAT</td>
            <td class="text-left" colspan="1" rowspan="1">
              <a class="auto internal xref" href="#user-attribute-packet">Section 5.12</a>
</td>
          </tr>
          <tr>
            <td class="text-right" colspan="1" rowspan="1">18</td>
            <td class="text-left" colspan="1" rowspan="1">Yes</td>
            <td class="text-left" colspan="1" rowspan="1">Symmetrically Encrypted and Integrity Protected Data Packet</td>
            <td class="text-left" colspan="1" rowspan="1">SEIPD</td>
            <td class="text-left" colspan="1" rowspan="1">
              <a class="auto internal xref" href="#seipd">Section 5.13</a>
</td>
          </tr>
          <tr>
            <td class="text-right" colspan="1" rowspan="1">19</td>
            <td class="text-left" colspan="1" rowspan="1">Yes</td>
            <td class="text-left" colspan="1" rowspan="1">Reserved (formerly Modification Detection Code Packet)</td>
            <td class="text-left" colspan="1" rowspan="1"> </td>
            <td class="text-left" colspan="1" rowspan="1">
              <a class="auto internal xref" href="#version-one-seipd">Section 5.13.1</a>
</td>
          </tr>
          <tr>
            <td class="text-right" colspan="1" rowspan="1">20</td>
            <td class="text-left" colspan="1" rowspan="1">Yes</td>
            <td class="text-left" colspan="1" rowspan="1">Reserved</td>
            <td class="text-left" colspan="1" rowspan="1"> </td>
            <td class="text-left" colspan="1" rowspan="1"></td>
          </tr>
          <tr>
            <td class="text-right" colspan="1" rowspan="1">21</td>
            <td class="text-left" colspan="1" rowspan="1">Yes</td>
            <td class="text-left" colspan="1" rowspan="1">Padding Packet</td>
            <td class="text-left" colspan="1" rowspan="1">PADDING</td>
            <td class="text-left" colspan="1" rowspan="1">
              <a class="auto internal xref" href="#padding-packet">Section 5.14</a>
</td>
          </tr>
          <tr>
            <td class="text-right" colspan="1" rowspan="1">22-39</td>
            <td class="text-left" colspan="1" rowspan="1">Yes</td>
            <td class="text-left" colspan="1" rowspan="1">Unassigned Critical Packets</td>
            <td class="text-left" colspan="1" rowspan="1"> </td>
            <td class="text-left" colspan="1" rowspan="1"> </td>
          </tr>
          <tr>
            <td class="text-right" colspan="1" rowspan="1">40-59</td>
            <td class="text-left" colspan="1" rowspan="1">No</td>
            <td class="text-left" colspan="1" rowspan="1">Unassigned Non-Critical Packets</td>
            <td class="text-left" colspan="1" rowspan="1"> </td>
            <td class="text-left" colspan="1" rowspan="1"> </td>
          </tr>
          <tr>
            <td class="text-right" colspan="1" rowspan="1">60-63</td>
            <td class="text-left" colspan="1" rowspan="1">No</td>
            <td class="text-left" colspan="1" rowspan="1">Private or Experimental Use</td>
            <td class="text-left" colspan="1" rowspan="1"> </td>
            <td class="text-left" colspan="1" rowspan="1"></td>
          </tr>
        </tbody>
      </table>
</div>
<p id="section-5-3">The labels in the "Shorthand" column are used for compact reference elsewhere in this document, and they may also be used by implementations that provide debugging or inspection affordances for streams of OpenPGP packets.<a class="pilcrow" href="#section-5-3">¶</a></p>
<div id="pkesk">
<section id="section-5.1">
        <h3 id="name-public-key-encrypted-sessio">
<a class="section-number selfRef" href="#section-5.1">5.1. </a><a class="section-name selfRef" href="#name-public-key-encrypted-sessio">Public Key Encrypted Session Key Packet (Type ID 1)</a>
        </h3>
<p id="section-5.1-1">Zero or more PKESK packets and/or SKESK packets (<a class="auto internal xref" href="#skesk">Section 5.3</a>) precede an encryption container (that is, a Symmetrically Encrypted and Integrity Protected Data (SEIPD) packet or -- for historic data -- a Symmetrically Encrypted Data (SED) packet), which holds an Encrypted Message.
The message is encrypted with the session key, and the session key is itself encrypted and stored in the Encrypted Session Key packet(s). The encryption container is preceded by one Public Key Encrypted Session Key packet for each OpenPGP Key to which the message is encrypted. The recipient of the message finds a session key that is encrypted to their public key, decrypts the session key, and then uses the session key to decrypt the message.<a class="pilcrow" href="#section-5.1-1">¶</a></p>
<p id="section-5.1-2">The body of this packet starts with a 1-octet number giving the version number of the packet type. The currently defined versions are 3 and 6. The remainder of the packet depends on the version.<a class="pilcrow" href="#section-5.1-2">¶</a></p>
<p id="section-5.1-3">The versions differ in how they identify the recipient key and in what they encode.
The version of the PKESK packet must align with the version of the SEIPD packet (see <a class="auto internal xref" href="#encrypted-message-versions">Section 10.3.2.1</a>).
Any new version of the PKESK packet should be registered in the registry established in <a class="auto internal xref" href="#encrypted-message-versions">Section 10.3.2.1</a>.<a class="pilcrow" href="#section-5.1-3">¶</a></p>
<div id="v3-pkesk">
<section id="section-5.1.1">
          <h4 id="name-version-3-public-key-encryp">
<a class="section-number selfRef" href="#section-5.1.1">5.1.1. </a><a class="section-name selfRef" href="#name-version-3-public-key-encryp">Version 3 Public Key Encrypted Session Key Packet Format</a>
          </h4>
<p id="section-5.1.1-1">A version 3 PKESK packet precedes a v1 SEIPD packet (see <a class="auto internal xref" href="#version-one-seipd">Section 5.13.1</a>).
In historic data, it is sometimes found preceding a deprecated SED packet; see <a class="auto internal xref" href="#sed">Section 5.7</a>.
A v3 PKESK packet <span class="bcp14">MUST NOT</span> precede a v2 SEIPD packet (see <a class="auto internal xref" href="#encrypted-message-versions">Section 10.3.2.1</a>).<a class="pilcrow" href="#section-5.1.1-1">¶</a></p>
<p id="section-5.1.1-2">The v3 PKESK packet consists of:<a class="pilcrow" href="#section-5.1.1-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1.1-3.1">A 1-octet version number with value 3.<a class="pilcrow" href="#section-5.1.1-3.1">¶</a>
</li>
            <li class="normal" id="section-5.1.1-3.2">An 8-octet number that gives the Key ID of the public key to which the session key is encrypted.
If the session key is encrypted to a subkey, then the Key ID of this subkey is used here instead of the Key ID of the primary key.
The Key ID may also be all zeros, for an "anonymous recipient" (see <a class="auto internal xref" href="#pkesk-notes">Section 5.1.8</a>).<a class="pilcrow" href="#section-5.1.1-3.2">¶</a>
</li>
            <li class="normal" id="section-5.1.1-3.3">A 1-octet number giving the public key algorithm used.<a class="pilcrow" href="#section-5.1.1-3.3">¶</a>
</li>
            <li class="normal" id="section-5.1.1-3.4">A series of values comprising the encrypted session key.
This is algorithm specific and described below.<a class="pilcrow" href="#section-5.1.1-3.4">¶</a>
</li>
          </ul>
<p id="section-5.1.1-4">The public key encryption algorithm (described in subsequent sections) is passed two values:<a class="pilcrow" href="#section-5.1.1-4">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1.1-5.1">The session key.<a class="pilcrow" href="#section-5.1.1-5.1">¶</a>
</li>
            <li class="normal" id="section-5.1.1-5.2">
              <p id="section-5.1.1-5.2.1">The 1-octet algorithm identifier that specifies the symmetric key encryption algorithm used to encrypt the v1 SEIPD packet described in the following section.<a class="pilcrow" href="#section-5.1.1-5.2.1">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="v6-pkesk">
<section id="section-5.1.2">
          <h4 id="name-version-6-public-key-encryp">
<a class="section-number selfRef" href="#section-5.1.2">5.1.2. </a><a class="section-name selfRef" href="#name-version-6-public-key-encryp">Version 6 Public Key Encrypted Session Key Packet Format</a>
          </h4>
<p id="section-5.1.2-1">A v6 PKESK packet precedes a v2 SEIPD packet (see <a class="auto internal xref" href="#version-two-seipd">Section 5.13.2</a>).
A v6 PKESK packet <span class="bcp14">MUST NOT</span> precede a v1 SEIPD packet or a deprecated SED packet (see <a class="auto internal xref" href="#encrypted-message-versions">Section 10.3.2.1</a>).<a class="pilcrow" href="#section-5.1.2-1">¶</a></p>
<p id="section-5.1.2-2">The v6 PKESK packet consists of the following fields:<a class="pilcrow" href="#section-5.1.2-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1.2-3.1">A 1-octet version number with value 6.<a class="pilcrow" href="#section-5.1.2-3.1">¶</a>
</li>
            <li class="normal" id="section-5.1.2-3.2">A 1-octet size of the following two fields.
This size may be zero, if the key version number field and the fingerprint field are omitted for an "anonymous recipient" (see <a class="auto internal xref" href="#pkesk-notes">Section 5.1.8</a>).<a class="pilcrow" href="#section-5.1.2-3.2">¶</a>
</li>
            <li class="normal" id="section-5.1.2-3.3">A 1-octet key version number.<a class="pilcrow" href="#section-5.1.2-3.3">¶</a>
</li>
            <li class="normal" id="section-5.1.2-3.4">The fingerprint of the public key or subkey to which the session key is encrypted.
Note that the length N of the fingerprint for a version 4 key is 20 octets; for a version 6 key, N is 32.<a class="pilcrow" href="#section-5.1.2-3.4">¶</a>
</li>
            <li class="normal" id="section-5.1.2-3.5">A 1-octet number giving the public key algorithm used.<a class="pilcrow" href="#section-5.1.2-3.5">¶</a>
</li>
            <li class="normal" id="section-5.1.2-3.6">A series of values comprising the encrypted session key.
This is algorithm specific and described below.<a class="pilcrow" href="#section-5.1.2-3.6">¶</a>
</li>
          </ul>
<p id="section-5.1.2-4">The session key is encrypted according to the public key algorithm used, as described below.
No symmetric key encryption algorithm identifier is passed to the public key algorithm for a v6 PKESK packet, as it is included in the v2 SEIPD packet.<a class="pilcrow" href="#section-5.1.2-4">¶</a></p>
</section>
</div>
<div id="pkesk-rsa">
<section id="section-5.1.3">
          <h4 id="name-algorithm-specific-fields-f">
<a class="section-number selfRef" href="#section-5.1.3">5.1.3. </a><a class="section-name selfRef" href="#name-algorithm-specific-fields-f">Algorithm-Specific Fields for RSA Encryption</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-5.1.3-1.1">MPI of RSA-encrypted value m<sup>e</sup> mod n.<a class="pilcrow" href="#section-5.1.3-1.1">¶</a>
</li>
          </ul>
<p id="section-5.1.3-2">To produce the value "m" in the above formula, first concatenate the following values:<a class="pilcrow" href="#section-5.1.3-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1.3-3.1">The 1-octet algorithm identifier, if it was passed (in the case of a v3 PKESK packet).<a class="pilcrow" href="#section-5.1.3-3.1">¶</a>
</li>
            <li class="normal" id="section-5.1.3-3.2">The session key.<a class="pilcrow" href="#section-5.1.3-3.2">¶</a>
</li>
            <li class="normal" id="section-5.1.3-3.3">A 2-octet checksum of the session key, equal to the sum of the session key octets, modulo 65536.<a class="pilcrow" href="#section-5.1.3-3.3">¶</a>
</li>
          </ul>
<p id="section-5.1.3-4">Then, the above values are encoded using the PKCS#1 block encoding EME-PKCS1-v1_5, as described in Step 2 in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc8017#section-7.2.1">Section 7.2.1</a> of [<a class="cite xref" href="#RFC8017">RFC8017</a>]</span> (see also <a class="auto internal xref" href="#eme-pkcs1-v1-5-encode">Section 12.1.1</a>).
   When decoding "m" during decryption, an implementation should follow Step 3 in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc8017#section-7.2.2">Section 7.2.2</a> of [<a class="cite xref" href="#RFC8017">RFC8017</a>]</span> (see also <a class="auto internal xref" href="#eme-pkcs1-v1-5-decode">Section 12.1.2</a>).<a class="pilcrow" href="#section-5.1.3-4">¶</a></p>
<p id="section-5.1.3-5">Note that when an implementation forms several PKESK packets with one session key, forming a message that can be decrypted by several keys, the implementation <span class="bcp14">MUST</span> make a new PKCS#1 encoding for each key. This defends against attacks such as those discussed in <span>[<a class="cite xref" href="#HASTAD">HASTAD</a>]</span>.<a class="pilcrow" href="#section-5.1.3-5">¶</a></p>
</section>
</div>
<div id="pkesk-elgamal">
<section id="section-5.1.4">
          <h4 id="name-algorithm-specific-fields-fo">
<a class="section-number selfRef" href="#section-5.1.4">5.1.4. </a><a class="section-name selfRef" href="#name-algorithm-specific-fields-fo">Algorithm-Specific Fields for Elgamal Encryption</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-5.1.4-1.1">
              <p id="section-5.1.4-1.1.1">MPI of Elgamal (Diffie-Hellman) value g<sup>k</sup> mod p.<a class="pilcrow" href="#section-5.1.4-1.1.1">¶</a></p>
</li>
            <li class="normal" id="section-5.1.4-1.2">
              <p id="section-5.1.4-1.2.1">MPI of Elgamal (Diffie-Hellman) value m * y<sup>k</sup> mod p.<a class="pilcrow" href="#section-5.1.4-1.2.1">¶</a></p>
</li>
          </ul>
<p id="section-5.1.4-2">To produce the value "m" in the above formula, first concatenate the following values:<a class="pilcrow" href="#section-5.1.4-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1.4-3.1">
              <p id="section-5.1.4-3.1.1">The 1-octet algorithm identifier, if it was passed (in the case of a v3 PKESK packet).<a class="pilcrow" href="#section-5.1.4-3.1.1">¶</a></p>
</li>
            <li class="normal" id="section-5.1.4-3.2">
              <p id="section-5.1.4-3.2.1">The session key.<a class="pilcrow" href="#section-5.1.4-3.2.1">¶</a></p>
</li>
            <li class="normal" id="section-5.1.4-3.3">
              <p id="section-5.1.4-3.3.1">A 2-octet checksum of the session key, equal to the sum of the session key octets, modulo 65536.<a class="pilcrow" href="#section-5.1.4-3.3.1">¶</a></p>
</li>
          </ul>
<p id="section-5.1.4-4">Then, the above values are encoded using the PKCS#1 block encoding EME-PKCS1-v1_5, as described in Step 2 in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc8017#section-7.2.1">Section 7.2.1</a> of [<a class="cite xref" href="#RFC8017">RFC8017</a>]</span> (see also <a class="auto internal xref" href="#eme-pkcs1-v1-5-encode">Section 12.1.1</a>).
When decoding "m" during decryption, an implementation should follow Step 3 in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc8017#section-7.2.2">Section 7.2.2</a> of [<a class="cite xref" href="#RFC8017">RFC8017</a>]</span> (see also <a class="auto internal xref" href="#eme-pkcs1-v1-5-decode">Section 12.1.2</a>).<a class="pilcrow" href="#section-5.1.4-4">¶</a></p>
<p id="section-5.1.4-5">Note that when an implementation forms several PKESK packets with one session key, forming a message that can be decrypted by several keys, the implementation <span class="bcp14">MUST</span> make a new PKCS#1 encoding for each key.
This defends against attacks such as those discussed in <span>[<a class="cite xref" href="#HASTAD">HASTAD</a>]</span>.<a class="pilcrow" href="#section-5.1.4-5">¶</a></p>
<p id="section-5.1.4-6">An implementation <span class="bcp14">MUST NOT</span> generate ElGamal v6 PKESK packets.<a class="pilcrow" href="#section-5.1.4-6">¶</a></p>
</section>
</div>
<div id="pkesk-ecdh">
<section id="section-5.1.5">
          <h4 id="name-algorithm-specific-fields-for">
<a class="section-number selfRef" href="#section-5.1.5">5.1.5. </a><a class="section-name selfRef" href="#name-algorithm-specific-fields-for">Algorithm-Specific Fields for ECDH Encryption</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-5.1.5-1.1">MPI of an EC point representing an ephemeral public key in the point format associated with the curve as specified in <a class="auto internal xref" href="#ec-curves">Section 9.2</a>.<a class="pilcrow" href="#section-5.1.5-1.1">¶</a>
</li>
            <li class="normal" id="section-5.1.5-1.2">A 1-octet size, followed by a symmetric key encoded using the method described in <a class="auto internal xref" href="#ecdh">Section 11.5</a>.<a class="pilcrow" href="#section-5.1.5-1.2">¶</a>
</li>
          </ul>
</section>
</div>
<div id="pkesk-x25519">
<section id="section-5.1.6">
          <h4 id="name-algorithm-specific-fields-for-">
<a class="section-number selfRef" href="#section-5.1.6">5.1.6. </a><a class="section-name selfRef" href="#name-algorithm-specific-fields-for-">Algorithm-Specific Fields for X25519 Encryption</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-5.1.6-1.1">32 octets representing an ephemeral X25519 public key.<a class="pilcrow" href="#section-5.1.6-1.1">¶</a>
</li>
            <li class="normal" id="section-5.1.6-1.2">A 1-octet size of the following fields.<a class="pilcrow" href="#section-5.1.6-1.2">¶</a>
</li>
            <li class="normal" id="section-5.1.6-1.3">The 1-octet algorithm identifier, if it was passed (in the case of a v3 PKESK packet).<a class="pilcrow" href="#section-5.1.6-1.3">¶</a>
</li>
            <li class="normal" id="section-5.1.6-1.4">The encrypted session key.<a class="pilcrow" href="#section-5.1.6-1.4">¶</a>
</li>
          </ul>
<p id="section-5.1.6-2">See <span><a class="relref" href="https://rfc-editor.org/rfc/rfc7748#section-6.1">Section 6.1</a> of [<a class="cite xref" href="#RFC7748">RFC7748</a>]</span> for more details on the computation of the ephemeral public key and the shared secret. The HMAC-based Key Derivation Function (HKDF) <span>[<a class="cite xref" href="#RFC5869">RFC5869</a>]</span> is then used with SHA256 <span>[<a class="cite xref" href="#RFC6234">RFC6234</a>]</span> and an info parameter of "OpenPGP X25519" and no salt.
The input of HKDF is the concatenation of the following three values:<a class="pilcrow" href="#section-5.1.6-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1.6-3.1">
              <p id="section-5.1.6-3.1.1">32 octets of the ephemeral X25519 public key from this packet.<a class="pilcrow" href="#section-5.1.6-3.1.1">¶</a></p>
</li>
            <li class="normal" id="section-5.1.6-3.2">
              <p id="section-5.1.6-3.2.1">32 octets of the recipient public key material.<a class="pilcrow" href="#section-5.1.6-3.2.1">¶</a></p>
</li>
            <li class="normal" id="section-5.1.6-3.3">
              <p id="section-5.1.6-3.3.1">32 octets of the shared secret.<a class="pilcrow" href="#section-5.1.6-3.3.1">¶</a></p>
</li>
          </ul>
<p id="section-5.1.6-4">The key produced from HKDF is used to encrypt the session key with AES-128 key wrap, as defined in <span>[<a class="cite xref" href="#RFC3394">RFC3394</a>]</span>.<a class="pilcrow" href="#section-5.1.6-4">¶</a></p>
<p id="section-5.1.6-5">Note that unlike Elliptic Curve Diffie-Hellman (ECDH), no checksum or padding are appended to the session key before key wrapping. Finally, note that unlike the other public key algorithms, in the case of a v3 PKESK packet, the symmetric algorithm ID is not encrypted. Instead, it is prepended to the encrypted session key in plaintext.
In this case, the symmetric algorithm used <span class="bcp14">MUST</span> be AES-128, AES-192, or AES-256 (algorithm IDs 7, 8, or 9, respectively).<a class="pilcrow" href="#section-5.1.6-5">¶</a></p>
</section>
</div>
<div id="pkesk-x448">
<section id="section-5.1.7">
          <h4 id="name-algorithm-specific-fields-for-x">
<a class="section-number selfRef" href="#section-5.1.7">5.1.7. </a><a class="section-name selfRef" href="#name-algorithm-specific-fields-for-x">Algorithm-Specific Fields for X448 Encryption</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-5.1.7-1.1">
              <p id="section-5.1.7-1.1.1">56 octets representing an ephemeral X448 public key.<a class="pilcrow" href="#section-5.1.7-1.1.1">¶</a></p>
</li>
            <li class="normal" id="section-5.1.7-1.2">
              <p id="section-5.1.7-1.2.1">A 1-octet size of the following fields.<a class="pilcrow" href="#section-5.1.7-1.2.1">¶</a></p>
</li>
            <li class="normal" id="section-5.1.7-1.3">
              <p id="section-5.1.7-1.3.1">The 1-octet algorithm identifier, if it was passed (in the case of a v3 PKESK packet).<a class="pilcrow" href="#section-5.1.7-1.3.1">¶</a></p>
</li>
            <li class="normal" id="section-5.1.7-1.4">
              <p id="section-5.1.7-1.4.1">The encrypted session key.<a class="pilcrow" href="#section-5.1.7-1.4.1">¶</a></p>
</li>
          </ul>
<p id="section-5.1.7-2">See <span><a class="relref" href="https://rfc-editor.org/rfc/rfc7748#section-6.2">Section 6.2</a> of [<a class="cite xref" href="#RFC7748">RFC7748</a>]</span> for more details on the computation of the ephemeral public key and the shared secret.
HKDF <span>[<a class="cite xref" href="#RFC5869">RFC5869</a>]</span> is then used with SHA512 <span>[<a class="cite xref" href="#RFC6234">RFC6234</a>]</span> and an info parameter of "OpenPGP X448" and no salt. The input of HKDF is the concatenation of the following three values:<a class="pilcrow" href="#section-5.1.7-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1.7-3.1">
              <p id="section-5.1.7-3.1.1">56 octets of the ephemeral X448 public key from this packet.<a class="pilcrow" href="#section-5.1.7-3.1.1">¶</a></p>
</li>
            <li class="normal" id="section-5.1.7-3.2">
              <p id="section-5.1.7-3.2.1">56 octets of the recipient public key material.<a class="pilcrow" href="#section-5.1.7-3.2.1">¶</a></p>
</li>
            <li class="normal" id="section-5.1.7-3.3">
              <p id="section-5.1.7-3.3.1">56 octets of the shared secret.<a class="pilcrow" href="#section-5.1.7-3.3.1">¶</a></p>
</li>
          </ul>
<p id="section-5.1.7-4">The key produced from HKDF is used to encrypt the session key with AES-256 key wrap, as defined in <span>[<a class="cite xref" href="#RFC3394">RFC3394</a>]</span>.<a class="pilcrow" href="#section-5.1.7-4">¶</a></p>
<p id="section-5.1.7-5">Note that unlike ECDH, no checksum or padding are appended to the session key before key wrapping.
Finally, note that unlike the other public key algorithms, in the case of a v3 PKESK packet, the symmetric algorithm ID is not encrypted.
Instead, it is prepended to the encrypted session key in plaintext.
In this case, the symmetric algorithm used <span class="bcp14">MUST</span> be AES-128, AES-192, or AES-256 (algorithm ID 7, 8, or 9).<a class="pilcrow" href="#section-5.1.7-5">¶</a></p>
</section>
</div>
<div id="pkesk-notes">
<section id="section-5.1.8">
          <h4 id="name-notes-on-pkesk">
<a class="section-number selfRef" href="#section-5.1.8">5.1.8. </a><a class="section-name selfRef" href="#name-notes-on-pkesk">Notes on PKESK</a>
          </h4>
<p id="section-5.1.8-1">An implementation <span class="bcp14">MAY</span> accept or use a Key ID of all zeros, or an omitted key fingerprint, to hide the intended decryption key.
In this case, the receiving implementation would try all available private keys, checking for a valid decrypted session key.
This format helps reduce traffic analysis of messages.<a class="pilcrow" href="#section-5.1.8-1">¶</a></p>
</section>
</div>
</section>
</div>
<div id="signature-packet">
<section id="section-5.2">
        <h3 id="name-signature-packet-type-id-2">
<a class="section-number selfRef" href="#section-5.2">5.2. </a><a class="section-name selfRef" href="#name-signature-packet-type-id-2">Signature Packet (Type ID 2)</a>
        </h3>
<p id="section-5.2-1">A Signature packet describes a binding between some public key and some data.
The most common signatures are a signature of a file or a block of text and a signature that is a certification of a User ID.<a class="pilcrow" href="#section-5.2-1">¶</a></p>
<p id="section-5.2-2">Three versions of Signature packets are defined.
Version 3 provides basic signature information, while versions 4 and 6 provide an expandable format with subpackets that can specify more information about the signature.<a class="pilcrow" href="#section-5.2-2">¶</a></p>
<p id="section-5.2-3">For historical reasons, versions 1, 2, and 5 of the Signature packet are unspecified.
Any new Signature packet version should be registered in the registry established in <a class="auto internal xref" href="#signed-message-versions">Section 10.3.2.2</a>.<a class="pilcrow" href="#section-5.2-3">¶</a></p>
<p id="section-5.2-4">An implementation <span class="bcp14">MUST</span> generate a version 6 signature when signing with a version 6 key.
An implementation <span class="bcp14">MUST</span> generate a version 4 signature when signing with a version 4 key.
Implementations <span class="bcp14">MUST NOT</span> create version 3 signatures; they <span class="bcp14">MAY</span> accept version 3 signatures.
See <a class="auto internal xref" href="#signed-message-versions">Section 10.3.2.2</a> for more details about packet version correspondence between keys and signatures.<a class="pilcrow" href="#section-5.2-4">¶</a></p>
<div id="signature-types">
<section id="section-5.2.1">
          <h4 id="name-signature-types">
<a class="section-number selfRef" href="#section-5.2.1">5.2.1. </a><a class="section-name selfRef" href="#name-signature-types">Signature Types</a>
          </h4>
<p id="section-5.2.1-1">There are a number of possible meanings for a signature, which are indicated by the Signature Type ID in any given signature. Please note that the vagueness of these meanings is not a flaw but rather a feature of the system.
Because OpenPGP places final authority for validity upon the receiver of a signature, it may be that one signer's casual act might be more rigorous than some other authority's positive act.
See <a class="auto internal xref" href="#computing-signatures">Section 5.2.4</a> for detailed information on how to compute and verify signatures of each type.<a class="pilcrow" href="#section-5.2.1-1">¶</a></p>
<span id="name-openpgp-signature-types-reg"></span><div id="signature-types-registry">
<table class="center" id="table-4">
            <caption>
<a class="selfRef" href="#table-4">Table 4</a>:
<a class="selfRef" href="#name-openpgp-signature-types-reg">OpenPGP Signature Types Registry</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" colspan="1" rowspan="1">ID</th>
                <th class="text-left" colspan="1" rowspan="1">Name</th>
                <th class="text-left" colspan="1" rowspan="1">Reference</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">0x00</td>
                <td class="text-left" colspan="1" rowspan="1">Binary Signature</td>
                <td class="text-left" colspan="1" rowspan="1">
                  <a class="auto internal xref" href="#sigtype-binary">Section 5.2.1.1</a>
</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">0x01</td>
                <td class="text-left" colspan="1" rowspan="1">Text Signature</td>
                <td class="text-left" colspan="1" rowspan="1">
                  <a class="auto internal xref" href="#sigtype-text">Section 5.2.1.2</a>
</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">0x02</td>
                <td class="text-left" colspan="1" rowspan="1">Standalone Signature</td>
                <td class="text-left" colspan="1" rowspan="1">
                  <a class="auto internal xref" href="#sigtype-standalone">Section 5.2.1.3</a>
</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">0x10</td>
                <td class="text-left" colspan="1" rowspan="1">Generic Certification Signature</td>
                <td class="text-left" colspan="1" rowspan="1">
                  <a class="auto internal xref" href="#sigtype-generic-cert">Section 5.2.1.4</a>
</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">0x11</td>
                <td class="text-left" colspan="1" rowspan="1">Persona Certification Signature</td>
                <td class="text-left" colspan="1" rowspan="1">
                  <a class="auto internal xref" href="#sigtype-persona-cert">Section 5.2.1.5</a>
</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">0x12</td>
                <td class="text-left" colspan="1" rowspan="1">Casual Certification Signature</td>
                <td class="text-left" colspan="1" rowspan="1">
                  <a class="auto internal xref" href="#sigtype-casual-cert">Section 5.2.1.6</a>
</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">0x13</td>
                <td class="text-left" colspan="1" rowspan="1">Positive Certification Signature</td>
                <td class="text-left" colspan="1" rowspan="1">
                  <a class="auto internal xref" href="#sigtype-positive-cert">Section 5.2.1.7</a>
</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">0x18</td>
                <td class="text-left" colspan="1" rowspan="1">Subkey Binding Signature</td>
                <td class="text-left" colspan="1" rowspan="1">
                  <a class="auto internal xref" href="#sigtype-subkey-binding">Section 5.2.1.8</a>
</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">0x19</td>
                <td class="text-left" colspan="1" rowspan="1">Primary Key Binding Signature</td>
                <td class="text-left" colspan="1" rowspan="1">
                  <a class="auto internal xref" href="#sigtype-primary-binding">Section 5.2.1.9</a>
</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">0x1F</td>
                <td class="text-left" colspan="1" rowspan="1">Direct Key Signature</td>
                <td class="text-left" colspan="1" rowspan="1">
                  <a class="auto internal xref" href="#sigtype-direct-key">Section 5.2.1.10</a>
</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">0x20</td>
                <td class="text-left" colspan="1" rowspan="1">Key Revocation Signature</td>
                <td class="text-left" colspan="1" rowspan="1">
                  <a class="auto internal xref" href="#sigtype-key-revocation">Section 5.2.1.11</a>
</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">0x28</td>
                <td class="text-left" colspan="1" rowspan="1">Subkey Revocation Signature</td>
                <td class="text-left" colspan="1" rowspan="1">
                  <a class="auto internal xref" href="#sigtype-subkey-revocation">Section 5.2.1.12</a>
</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">0x30</td>
                <td class="text-left" colspan="1" rowspan="1">Certification Revocation Signature</td>
                <td class="text-left" colspan="1" rowspan="1">
                  <a class="auto internal xref" href="#sigtype-certification-revocation">Section 5.2.1.13</a>
</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">0x40</td>
                <td class="text-left" colspan="1" rowspan="1">Timestamp Signature</td>
                <td class="text-left" colspan="1" rowspan="1">
                  <a class="auto internal xref" href="#sigtype-timestamp">Section 5.2.1.14</a>
</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">0x50</td>
                <td class="text-left" colspan="1" rowspan="1">Third-Party Confirmation Signature</td>
                <td class="text-left" colspan="1" rowspan="1">
                  <a class="auto internal xref" href="#sigtype-third-party-confirmation">Section 5.2.1.15</a>
</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">0xFF</td>
                <td class="text-left" colspan="1" rowspan="1">Reserved</td>
                <td class="text-left" colspan="1" rowspan="1">
                  <a class="auto internal xref" href="#sigtype-reserved">Section 5.2.1.16</a>
                </td>
              </tr>
            </tbody>
          </table>
</div>
<p id="section-5.2.1-3">The meanings of each signature type are described in the subsections below.<a class="pilcrow" href="#section-5.2.1-3">¶</a></p>
<div id="sigtype-binary">
<section id="section-5.2.1.1">
            <h5 id="name-binary-signature-type-id-0x">
<a class="section-number selfRef" href="#section-5.2.1.1">5.2.1.1. </a><a class="section-name selfRef" href="#name-binary-signature-type-id-0x">Binary Signature (Type ID 0x00) of a Document</a>
            </h5>
<p id="section-5.2.1.1-1">This means the signer owns it, created it, or certifies that it has not been modified.<a class="pilcrow" href="#section-5.2.1.1-1">¶</a></p>
</section>
</div>
<div id="sigtype-text">
<section id="section-5.2.1.2">
            <h5 id="name-text-signature-type-id-0x01">
<a class="section-number selfRef" href="#section-5.2.1.2">5.2.1.2. </a><a class="section-name selfRef" href="#name-text-signature-type-id-0x01">Text Signature (Type ID 0x01) of a Canonical Document</a>
            </h5>
<p id="section-5.2.1.2-1">This means the signer owns it, created it, or certifies that it has not been modified.
The signature is calculated over the text data with its line endings converted to &lt;CR&gt;&lt;LF&gt;.<a class="pilcrow" href="#section-5.2.1.2-1">¶</a></p>
</section>
</div>
<div id="sigtype-standalone">
<section id="section-5.2.1.3">
            <h5 id="name-standalone-signature-type-i">
<a class="section-number selfRef" href="#section-5.2.1.3">5.2.1.3. </a><a class="section-name selfRef" href="#name-standalone-signature-type-i">Standalone Signature (Type ID 0x02)</a>
            </h5>
<p id="section-5.2.1.3-1">This signature is a signature of only its own subpacket contents.
It is calculated identically to a signature over a zero-length binary document.
 Version 3 Standalone signatures <span class="bcp14">MUST NOT</span> be generated and <span class="bcp14">MUST</span> be ignored.<a class="pilcrow" href="#section-5.2.1.3-1">¶</a></p>
</section>
</div>
<div id="sigtype-generic-cert">
<section id="section-5.2.1.4">
            <h5 id="name-generic-certification-signa">
<a class="section-number selfRef" href="#section-5.2.1.4">5.2.1.4. </a><a class="section-name selfRef" href="#name-generic-certification-signa">Generic Certification Signature (Type ID 0x10) of a User ID and Public Key Packet</a>
            </h5>
<p id="section-5.2.1.4-1">The issuer of this certification does not make any particular assertion as to how well the certifier has checked that the owner of the key is in fact the person described by the User ID.<a class="pilcrow" href="#section-5.2.1.4-1">¶</a></p>
</section>
</div>
<div id="sigtype-persona-cert">
<section id="section-5.2.1.5">
            <h5 id="name-persona-certification-signa">
<a class="section-number selfRef" href="#section-5.2.1.5">5.2.1.5. </a><a class="section-name selfRef" href="#name-persona-certification-signa">Persona Certification Signature (Type ID 0x11) of a User ID and Public Key Packet</a>
            </h5>
<p id="section-5.2.1.5-1">The issuer of this certification has not done any verification of the claim that the owner of this key is the User ID specified.<a class="pilcrow" href="#section-5.2.1.5-1">¶</a></p>
</section>
</div>
<div id="sigtype-casual-cert">
<section id="section-5.2.1.6">
            <h5 id="name-casual-certification-signat">
<a class="section-number selfRef" href="#section-5.2.1.6">5.2.1.6. </a><a class="section-name selfRef" href="#name-casual-certification-signat">Casual Certification Signature (Type ID 0x12) of a User ID and Public Key Packet</a>
            </h5>
<p id="section-5.2.1.6-1">The issuer of this certification has done some casual verification of the claim of identity.<a class="pilcrow" href="#section-5.2.1.6-1">¶</a></p>
</section>
</div>
<div id="sigtype-positive-cert">
<section id="section-5.2.1.7">
            <h5 id="name-positive-certification-sign">
<a class="section-number selfRef" href="#section-5.2.1.7">5.2.1.7. </a><a class="section-name selfRef" href="#name-positive-certification-sign">Positive Certification Signature (Type ID 0x13) of a User ID and Public Key Packet</a>
            </h5>
<p id="section-5.2.1.7-1">The issuer of this certification has done substantial verification of the claim of identity.<a class="pilcrow" href="#section-5.2.1.7-1">¶</a></p>
<p id="section-5.2.1.7-2">Most OpenPGP implementations make their "key signatures" as generic (Type ID 0x10) certifications. Some implementations can issue 0x11-0x13 certifications, but few differentiate between the types.<a class="pilcrow" href="#section-5.2.1.7-2">¶</a></p>
</section>
</div>
<div id="sigtype-subkey-binding">
<section id="section-5.2.1.8">
            <h5 id="name-subkey-binding-signature-ty">
<a class="section-number selfRef" href="#section-5.2.1.8">5.2.1.8. </a><a class="section-name selfRef" href="#name-subkey-binding-signature-ty">Subkey Binding Signature (Type ID 0x18)</a>
            </h5>
<p id="section-5.2.1.8-1">This signature is a statement by the top-level signing key, indicating that it owns the subkey. This signature is calculated directly on the primary key and subkey, and not on any User ID or other packets. A signature that binds a signing subkey <span class="bcp14">MUST</span> have an Embedded Signature subpacket in this binding signature that contains a 0x19 signature made by the signing subkey on the primary key and subkey.<a class="pilcrow" href="#section-5.2.1.8-1">¶</a></p>
</section>
</div>
<div id="sigtype-primary-binding">
<section id="section-5.2.1.9">
            <h5 id="name-primary-key-binding-signatu">
<a class="section-number selfRef" href="#section-5.2.1.9">5.2.1.9. </a><a class="section-name selfRef" href="#name-primary-key-binding-signatu">Primary Key Binding Signature (Type ID 0x19)</a>
            </h5>
<p id="section-5.2.1.9-1">This signature is a statement by a signing subkey, indicating that it is owned by the primary key.
This signature is calculated the same way as a Subkey Binding signature (Type ID 0x18): directly on the primary key and subkey, and not on any User ID or other packets.<a class="pilcrow" href="#section-5.2.1.9-1">¶</a></p>
</section>
</div>
<div id="sigtype-direct-key">
<section id="section-5.2.1.10">
            <h5 id="name-direct-key-signature-type-i">
<a class="section-number selfRef" href="#section-5.2.1.10">5.2.1.10. </a><a class="section-name selfRef" href="#name-direct-key-signature-type-i">Direct Key Signature (Type ID 0x1F)</a>
            </h5>
<p id="section-5.2.1.10-1">This signature is calculated directly on a key.
It binds the information in the Signature subpackets to the key and is appropriate to be used for subpackets that provide information about the key, such as the Key Flags subpacket or the (deprecated) Revocation Key subpacket.
It is also appropriate for statements that non-self certifiers want to make about the key itself rather than the binding between a key and a name.<a class="pilcrow" href="#section-5.2.1.10-1">¶</a></p>
</section>
</div>
<div id="sigtype-key-revocation">
<section id="section-5.2.1.11">
            <h5 id="name-key-revocation-signature-ty">
<a class="section-number selfRef" href="#section-5.2.1.11">5.2.1.11. </a><a class="section-name selfRef" href="#name-key-revocation-signature-ty">Key Revocation Signature (Type ID 0x20)</a>
            </h5>
<p id="section-5.2.1.11-1">This signature is calculated directly on the key being revoked.
A revoked key is not to be used. Only Revocation Signatures by the key being revoked, or by a (deprecated) Revocation Key, should be considered valid Revocation Signatures.<a class="pilcrow" href="#section-5.2.1.11-1">¶</a></p>
</section>
</div>
<div id="sigtype-subkey-revocation">
<section id="section-5.2.1.12">
            <h5 id="name-subkey-revocation-signature">
<a class="section-number selfRef" href="#section-5.2.1.12">5.2.1.12. </a><a class="section-name selfRef" href="#name-subkey-revocation-signature">Subkey Revocation Signature (Type ID 0x28)</a>
            </h5>
<p id="section-5.2.1.12-1">This signature is calculated directly on the primary key and the subkey being revoked.
A revoked subkey is not to be used.
Only Revocation Signatures by the top-level signature key that is bound to this subkey, or by a (deprecated) Revocation Key, should be considered valid Revocation Signatures.<a class="pilcrow" href="#section-5.2.1.12-1">¶</a></p>
</section>
</div>
<div id="sigtype-certification-revocation">
<section id="section-5.2.1.13">
            <h5 id="name-certification-revocation-si">
<a class="section-number selfRef" href="#section-5.2.1.13">5.2.1.13. </a><a class="section-name selfRef" href="#name-certification-revocation-si">Certification Revocation Signature (Type ID 0x30)</a>
            </h5>
<p id="section-5.2.1.13-1">This signature revokes an earlier User ID certification signature (Type IDs 0x10 through 0x13) or Direct Key signature (Type ID 0x1F).
It should be issued by the same key that issued the revoked signature or by a (deprecated) Revocation Key.
The signature is computed over the same data as the certification that it revokes, and it should have a later creation date than that certification.<a class="pilcrow" href="#section-5.2.1.13-1">¶</a></p>
</section>
</div>
<div id="sigtype-timestamp">
<section id="section-5.2.1.14">
            <h5 id="name-timestamp-signature-type-id">
<a class="section-number selfRef" href="#section-5.2.1.14">5.2.1.14. </a><a class="section-name selfRef" href="#name-timestamp-signature-type-id">Timestamp Signature (Type ID 0x40)</a>
            </h5>
<p id="section-5.2.1.14-1">This signature is only meaningful for the timestamp contained in it.<a class="pilcrow" href="#section-5.2.1.14-1">¶</a></p>
</section>
</div>
<div id="sigtype-third-party-confirmation">
<section id="section-5.2.1.15">
            <h5 id="name-third-party-confirmation-si">
<a class="section-number selfRef" href="#section-5.2.1.15">5.2.1.15. </a><a class="section-name selfRef" href="#name-third-party-confirmation-si">Third-Party Confirmation Signature (Type ID 0x50)</a>
            </h5>
<p id="section-5.2.1.15-1">This signature is a signature over another OpenPGP Signature packet.
  It is analogous to a notary seal on the signed data. A Third-Party Confirmation signature <span class="bcp14">SHOULD</span> include a Signature Target subpacket that identifies the confirmed signature.<a class="pilcrow" href="#section-5.2.1.15-1">¶</a></p>
</section>
</div>
<div id="sigtype-reserved">
<section id="section-5.2.1.16">
            <h5 id="name-reserved-type-id-0xff">
<a class="section-number selfRef" href="#section-5.2.1.16">5.2.1.16. </a><a class="section-name selfRef" href="#name-reserved-type-id-0xff">Reserved (Type ID 0xFF)</a>
            </h5>
<p id="section-5.2.1.16-1">An implementation <span class="bcp14">MUST NOT</span> create any signature with this type and <span class="bcp14">MUST NOT</span> validate any signature made with this type.
See <a class="auto internal xref" href="#sig-computation-notes">Section 5.2.4.1</a> for more details.<a class="pilcrow" href="#section-5.2.1.16-1">¶</a></p>
</section>
</div>
</section>
</div>
<div id="version-three-sig">
<section id="section-5.2.2">
          <h4 id="name-version-3-signature-packet-">
<a class="section-number selfRef" href="#section-5.2.2">5.2.2. </a><a class="section-name selfRef" href="#name-version-3-signature-packet-">Version 3 Signature Packet Format</a>
          </h4>
<p id="section-5.2.2-1">The body of a version 3 Signature packet contains:<a class="pilcrow" href="#section-5.2.2-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.2-2.1">
              <p id="section-5.2.2-2.1.1">A 1-octet version number with value 3.<a class="pilcrow" href="#section-5.2.2-2.1.1">¶</a></p>
</li>
            <li class="normal" id="section-5.2.2-2.2">
              <p id="section-5.2.2-2.2.1">A 1-octet length of the following hashed material; it
<span class="bcp14">MUST</span> be 5:<a class="pilcrow" href="#section-5.2.2-2.2.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.2-2.2.2.1">
                  <p id="section-5.2.2-2.2.2.1.1">A 1-octet Signature Type ID.<a class="pilcrow" href="#section-5.2.2-2.2.2.1.1">¶</a></p>
</li>
                <li class="normal" id="section-5.2.2-2.2.2.2">
                  <p id="section-5.2.2-2.2.2.2.1">A 4-octet creation time.<a class="pilcrow" href="#section-5.2.2-2.2.2.2.1">¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="section-5.2.2-2.3">
              <p id="section-5.2.2-2.3.1">An 8-octet Key ID of the signer.<a class="pilcrow" href="#section-5.2.2-2.3.1">¶</a></p>
</li>
            <li class="normal" id="section-5.2.2-2.4">
              <p id="section-5.2.2-2.4.1">A 1-octet public key algorithm.<a class="pilcrow" href="#section-5.2.2-2.4.1">¶</a></p>
</li>
            <li class="normal" id="section-5.2.2-2.5">
              <p id="section-5.2.2-2.5.1">A 1-octet hash algorithm.<a class="pilcrow" href="#section-5.2.2-2.5.1">¶</a></p>
</li>
            <li class="normal" id="section-5.2.2-2.6">
              <p id="section-5.2.2-2.6.1">A 2-octet field holding left 16 bits of the signed hash value.<a class="pilcrow" href="#section-5.2.2-2.6.1">¶</a></p>
</li>
            <li class="normal" id="section-5.2.2-2.7">
              <p id="section-5.2.2-2.7.1">One or more MPIs comprising the signature. This portion is algorithm specific, as described below.<a class="pilcrow" href="#section-5.2.2-2.7.1">¶</a></p>
</li>
          </ul>
<p id="section-5.2.2-3">The concatenation of the data to be signed, the signature type, and the creation time from the Signature packet (5 additional octets) is hashed.
The resulting hash value is used in the signature algorithm.
The high 16 bits (first two octets) of the hash are included in the Signature packet to provide a way to reject some invalid signatures without performing a signature verification.<a class="pilcrow" href="#section-5.2.2-3">¶</a></p>
<p id="section-5.2.2-4">Algorithm-specific fields for RSA signatures:<a class="pilcrow" href="#section-5.2.2-4">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.2-5.1">
              <p id="section-5.2.2-5.1.1">MPI of RSA signature value m<sup>d</sup> mod n.<a class="pilcrow" href="#section-5.2.2-5.1.1">¶</a></p>
</li>
          </ul>
<p id="section-5.2.2-6">Algorithm-specific fields for DSA signatures:<a class="pilcrow" href="#section-5.2.2-6">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.2-7.1">
              <p id="section-5.2.2-7.1.1">MPI of DSA value r.<a class="pilcrow" href="#section-5.2.2-7.1.1">¶</a></p>
</li>
            <li class="normal" id="section-5.2.2-7.2">
              <p id="section-5.2.2-7.2.1">MPI of DSA value s.<a class="pilcrow" href="#section-5.2.2-7.2.1">¶</a></p>
</li>
          </ul>
<p id="section-5.2.2-8">The signature calculation is based on a hash of the signed data, as described above.
The details of the calculation are different for DSA signatures than for RSA signatures; see Sections <a class="auto internal xref" href="#sig-rsa">5.2.3.1</a> and <a class="auto internal xref" href="#sig-dsa">5.2.3.2</a>.<a class="pilcrow" href="#section-5.2.2-8">¶</a></p>
</section>
</div>
<div id="version-four-and-six-sig">
<section id="section-5.2.3">
          <h4 id="name-versions-4-and-6-signature-">
<a class="section-number selfRef" href="#section-5.2.3">5.2.3. </a><a class="section-name selfRef" href="#name-versions-4-and-6-signature-">Versions 4 and 6 Signature Packet Formats</a>
          </h4>
<p id="section-5.2.3-1">The body of a version 4 or version 6 Signature packet contains:<a class="pilcrow" href="#section-5.2.3-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.3-2.1">
              <p id="section-5.2.3-2.1.1">A 1-octet version number.
This is 4 for version 4 signatures and 6 for version 6 signatures.<a class="pilcrow" href="#section-5.2.3-2.1.1">¶</a></p>
</li>
            <li class="normal" id="section-5.2.3-2.2">
              <p id="section-5.2.3-2.2.1">A 1-octet Signature Type ID.<a class="pilcrow" href="#section-5.2.3-2.2.1">¶</a></p>
</li>
            <li class="normal" id="section-5.2.3-2.3">
              <p id="section-5.2.3-2.3.1">A 1-octet public key algorithm.<a class="pilcrow" href="#section-5.2.3-2.3.1">¶</a></p>
</li>
            <li class="normal" id="section-5.2.3-2.4">
              <p id="section-5.2.3-2.4.1">A 1-octet hash algorithm.<a class="pilcrow" href="#section-5.2.3-2.4.1">¶</a></p>
</li>
            <li class="normal" id="section-5.2.3-2.5">
              <p id="section-5.2.3-2.5.1">A scalar octet count for the hashed subpacket data that follows this field. For a version 4 signature, this is a 2-octet field.
For a version 6 signature, this is a 4-octet field.
Note that this is the length in octets of all of the hashed subpackets; an implementation's pointer incremented by this number will skip over the hashed subpackets.<a class="pilcrow" href="#section-5.2.3-2.5.1">¶</a></p>
</li>
            <li class="normal" id="section-5.2.3-2.6">
              <p id="section-5.2.3-2.6.1">A hashed subpacket data set (zero or more subpackets).<a class="pilcrow" href="#section-5.2.3-2.6.1">¶</a></p>
</li>
            <li class="normal" id="section-5.2.3-2.7">
              <p id="section-5.2.3-2.7.1">A scalar octet count for the unhashed subpacket data that follows this field.
For a version 4 signature, this is a 2-octet field.
For a version 6 signature, this is a 4-octet field.
Note that this is the length in octets of all of the unhashed subpackets; an implementation's pointer incremented by this number will skip over the unhashed subpackets.<a class="pilcrow" href="#section-5.2.3-2.7.1">¶</a></p>
</li>
            <li class="normal" id="section-5.2.3-2.8">
              <p id="section-5.2.3-2.8.1">An unhashed subpacket data set (zero or more subpackets).<a class="pilcrow" href="#section-5.2.3-2.8.1">¶</a></p>
</li>
            <li class="normal" id="section-5.2.3-2.9">
              <p id="section-5.2.3-2.9.1">A 2-octet field holding the left 16 bits of the signed hash value.<a class="pilcrow" href="#section-5.2.3-2.9.1">¶</a></p>
</li>
            <li class="normal" id="section-5.2.3-2.10">
              <p id="section-5.2.3-2.10.1">Only for version 6 signatures, a variable-length field containing:<a class="pilcrow" href="#section-5.2.3-2.10.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.3-2.10.2.1">
                  <p id="section-5.2.3-2.10.2.1.1">A 1-octet salt size. The value <span class="bcp14">MUST</span> match the value defined for the hash algorithm as specified in <a class="auto internal xref" href="#hash-algorithms-registry">Table 23</a>.<a class="pilcrow" href="#section-5.2.3-2.10.2.1.1">¶</a></p>
</li>
                <li class="normal" id="section-5.2.3-2.10.2.2">
                  <p id="section-5.2.3-2.10.2.2.1">The salt, which is a random value of the specified size.<a class="pilcrow" href="#section-5.2.3-2.10.2.2.1">¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="section-5.2.3-2.11">
              <p id="section-5.2.3-2.11.1">One or more MPIs comprising the signature.
This portion is algorithm specific.<a class="pilcrow" href="#section-5.2.3-2.11.1">¶</a></p>
</li>
          </ul>
<div id="sig-rsa">
<section id="section-5.2.3.1">
            <h5 id="name-algorithm-specific-fields-for-r">
<a class="section-number selfRef" href="#section-5.2.3.1">5.2.3.1. </a><a class="section-name selfRef" href="#name-algorithm-specific-fields-for-r">Algorithm-Specific Fields for RSA Signatures</a>
            </h5>
<ul class="normal">
<li class="normal" id="section-5.2.3.1-1.1">
                <p id="section-5.2.3.1-1.1.1">MPI of RSA signature value m<sup>d</sup> mod n.<a class="pilcrow" href="#section-5.2.3.1-1.1.1">¶</a></p>
</li>
            </ul>
<p id="section-5.2.3.1-2">With RSA signatures, the hash value is encoded using PKCS#1 encoding type EMSA-PKCS1-v1_5, as described in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc8017#section-9.2">Section 9.2</a> of [<a class="cite xref" href="#RFC8017">RFC8017</a>]</span> (see also <a class="auto internal xref" href="#emsa-pkcs1-v1-5">Section 12.1.3</a>).
This requires inserting the hash value as an octet string into an ASN.1 structure.
The object identifier (OID) for the hash algorithm itself is also included in the structure; see the OIDs in <a class="auto internal xref" href="#emsa-hash-oids-registry">Table 24</a>.<a class="pilcrow" href="#section-5.2.3.1-2">¶</a></p>
</section>
</div>
<div id="sig-dsa">
<section id="section-5.2.3.2">
            <h5 id="name-algorithm-specific-fields-for-d">
<a class="section-number selfRef" href="#section-5.2.3.2">5.2.3.2. </a><a class="section-name selfRef" href="#name-algorithm-specific-fields-for-d">Algorithm-Specific Fields for DSA or ECDSA Signatures</a>
            </h5>
<ul class="normal">
<li class="normal" id="section-5.2.3.2-1.1">
                <p id="section-5.2.3.2-1.1.1">MPI of DSA or ECDSA value r.<a class="pilcrow" href="#section-5.2.3.2-1.1.1">¶</a></p>
</li>
              <li class="normal" id="section-5.2.3.2-1.2">
                <p id="section-5.2.3.2-1.2.1">MPI of DSA or ECDSA value s.<a class="pilcrow" href="#section-5.2.3.2-1.2.1">¶</a></p>
</li>
            </ul>
<p id="section-5.2.3.2-2">A version 3 signature <span class="bcp14">MUST NOT</span> be created and <span class="bcp14">MUST NOT</span> be used with the Elliptic Curve Digital Signature Algorithm (ECDSA).<a class="pilcrow" href="#section-5.2.3.2-2">¶</a></p>
<p id="section-5.2.3.2-3">A DSA signature <span class="bcp14">MUST</span> use a hash algorithm with a digest size of at least the number of bits of q, the group generated by the DSA key's generator value.<a class="pilcrow" href="#section-5.2.3.2-3">¶</a></p>
<p id="section-5.2.3.2-4">If the output size of the chosen hash is larger than the number of bits of q, the hash result is truncated to fit by taking the number of leftmost bits equal to the number of bits of q.
This (possibly truncated) hash function result is treated as a number and used directly in the DSA signature algorithm.<a class="pilcrow" href="#section-5.2.3.2-4">¶</a></p>
<p id="section-5.2.3.2-5">An ECDSA signature <span class="bcp14">MUST</span> use a hash algorithm with a digest size of at least the curve's "fsize" value (see <a class="auto internal xref" href="#ec-curves">Section 9.2</a>), except in the case of NIST P-521, for which at least a 512-bit hash algorithm <span class="bcp14">MUST</span> be used.<a class="pilcrow" href="#section-5.2.3.2-5">¶</a></p>
</section>
</div>
<div id="sig-eddsa-legacy">
<section id="section-5.2.3.3">
            <h5 id="name-algorithm-specific-fields-for-e">
<a class="section-number selfRef" href="#section-5.2.3.3">5.2.3.3. </a><a class="section-name selfRef" href="#name-algorithm-specific-fields-for-e">Algorithm-Specific Fields for EdDSALegacy Signatures (Deprecated)</a>
            </h5>
<ul class="normal">
<li class="normal" id="section-5.2.3.3-1.1">
                <p id="section-5.2.3.3-1.1.1">Two MPI-encoded values, whose contents and formatting depend on the choice of curve used (see <a class="auto internal xref" href="#curve-specific-formats">Section 9.2.1</a>).<a class="pilcrow" href="#section-5.2.3.3-1.1.1">¶</a></p>
</li>
            </ul>
<p id="section-5.2.3.3-2">A version 3 signature <span class="bcp14">MUST NOT</span> be created and <span class="bcp14">MUST NOT</span> be used with EdDSALegacy.<a class="pilcrow" href="#section-5.2.3.3-2">¶</a></p>
<p id="section-5.2.3.3-3">An EdDSALegacy signature <span class="bcp14">MUST</span> use a hash algorithm with a digest size of at least the curve's "fsize" value (see <a class="auto internal xref" href="#ec-curves">Section 9.2</a>).
A verifying implementation <span class="bcp14">MUST</span> reject any EdDSALegacy signature that uses a hash algorithm with a smaller digest size.<a class="pilcrow" href="#section-5.2.3.3-3">¶</a></p>
<div id="algorithm-specific-fields-for-ed25519legacy-signatures-deprecated">
<section id="section-5.2.3.3.1">
              <h6 id="name-algorithm-specific-fields-for-ed">
<a class="section-number selfRef" href="#section-5.2.3.3.1">5.2.3.3.1. </a><a class="section-name selfRef" href="#name-algorithm-specific-fields-for-ed">Algorithm-Specific Fields for Ed25519Legacy Signatures (Deprecated)</a>
              </h6>
<p id="section-5.2.3.3.1-1">The two MPIs for Ed25519Legacy represent the octet strings R and S of the Edwards-curve Digital Signature Algorithm (EdDSA) described in <span>[<a class="cite xref" href="#RFC8032">RFC8032</a>]</span>.<a class="pilcrow" href="#section-5.2.3.3.1-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.3.3.1-2.1">
                  <p id="section-5.2.3.3.1-2.1.1">MPI of an EC point R, represented as a (non-prefixed) native (little-endian) octet string up to 32 octets.<a class="pilcrow" href="#section-5.2.3.3.1-2.1.1">¶</a></p>
</li>
                <li class="normal" id="section-5.2.3.3.1-2.2">
                  <p id="section-5.2.3.3.1-2.2.1">MPI of EdDSA value S, also in (non-prefixed) native (little-endian) format with a length up to 32 octets.<a class="pilcrow" href="#section-5.2.3.3.1-2.2.1">¶</a></p>
</li>
              </ul>
<p id="section-5.2.3.3.1-3">
Ed25519Legacy <span class="bcp14">MUST NOT</span> be used in Signature packets version 6 or above.<a class="pilcrow" href="#section-5.2.3.3.1-3">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sig-ed25519">
<section id="section-5.2.3.4">
            <h5 id="name-algorithm-specific-fields-for-ed2">
<a class="section-number selfRef" href="#section-5.2.3.4">5.2.3.4. </a><a class="section-name selfRef" href="#name-algorithm-specific-fields-for-ed2">Algorithm-Specific Fields for Ed25519 Signatures</a>
            </h5>
<ul class="normal">
<li class="normal" id="section-5.2.3.4-1.1">
                <p id="section-5.2.3.4-1.1.1">64 octets of the native signature.<a class="pilcrow" href="#section-5.2.3.4-1.1.1">¶</a></p>
</li>
            </ul>
<p id="section-5.2.3.4-2">For more details, see <a class="auto internal xref" href="#eddsa-notes">Section 12.7</a>.<a class="pilcrow" href="#section-5.2.3.4-2">¶</a></p>
<p id="section-5.2.3.4-3">A version 3 signature <span class="bcp14">MUST NOT</span> be created and <span class="bcp14">MUST NOT</span> be used with Ed25519.<a class="pilcrow" href="#section-5.2.3.4-3">¶</a></p>
<p id="section-5.2.3.4-4">An Ed25519 signature <span class="bcp14">MUST</span> use a hash algorithm with a digest size of at least 256 bits.
A verifying implementation <span class="bcp14">MUST</span> reject any Ed25519 signature that uses a hash algorithm with a smaller digest size.<a class="pilcrow" href="#section-5.2.3.4-4">¶</a></p>
</section>
</div>
<div id="sig-ed448">
<section id="section-5.2.3.5">
            <h5 id="name-algorithm-specific-fields-for-ed4">
<a class="section-number selfRef" href="#section-5.2.3.5">5.2.3.5. </a><a class="section-name selfRef" href="#name-algorithm-specific-fields-for-ed4">Algorithm-Specific Fields for Ed448 Signatures</a>
            </h5>
<ul class="normal">
<li class="normal" id="section-5.2.3.5-1.1">
                <p id="section-5.2.3.5-1.1.1">114 octets of the native signature.<a class="pilcrow" href="#section-5.2.3.5-1.1.1">¶</a></p>
</li>
            </ul>
<p id="section-5.2.3.5-2">For more details, see <a class="auto internal xref" href="#eddsa-notes">Section 12.7</a>.<a class="pilcrow" href="#section-5.2.3.5-2">¶</a></p>
<p id="section-5.2.3.5-3">A version 3 signature <span class="bcp14">MUST NOT</span> be created and <span class="bcp14">MUST NOT</span> be used with Ed448.<a class="pilcrow" href="#section-5.2.3.5-3">¶</a></p>
<p id="section-5.2.3.5-4">An Ed448 signature <span class="bcp14">MUST</span> use a hash algorithm with a digest size of at least 512 bits.
A verifying implementation <span class="bcp14">MUST</span> reject any Ed448 signature that uses a hash algorithm with a smaller digest size.<a class="pilcrow" href="#section-5.2.3.5-4">¶</a></p>
</section>
</div>
<div id="notes-on-signatures">
<section id="section-5.2.3.6">
            <h5 id="name-notes-on-signatures">
<a class="section-number selfRef" href="#section-5.2.3.6">5.2.3.6. </a><a class="section-name selfRef" href="#name-notes-on-signatures">Notes on Signatures</a>
            </h5>
<p id="section-5.2.3.6-1">The concatenation of the data being signed, the signature data from the version number through the hashed subpacket data (inclusive), and (for signature versions later than 3) a 6-octet trailer (see <a class="auto internal xref" href="#computing-signatures">Section 5.2.4</a>) is hashed. The resulting hash value is what is signed. The high 16 bits (first two octets) of the hash are included in the Signature packet to provide a way to reject some invalid signatures without performing a signature verification. When verifying a version 6 signature, an implementation <span class="bcp14">MUST</span> reject the signature if these octets do not match the first two octets of the computed hash.<a class="pilcrow" href="#section-5.2.3.6-1">¶</a></p>
<p id="section-5.2.3.6-2">There are two fields consisting of Signature subpackets.
The first field is hashed with the rest of the signature data, while the second is not hashed into the signature. The second set of subpackets (the "unhashed section") is not cryptographically protected by the signature and should include only advisory information. See <a class="auto internal xref" href="#subpacket-section-guidance">Section 13.13</a> for more information.<a class="pilcrow" href="#section-5.2.3.6-2">¶</a></p>
<p id="section-5.2.3.6-3">The differences between a version 4 and version 6 signature are two-fold: first, a version 6 signature increases the width of the fields that indicate the size of the hashed and unhashed subpackets, making it possible to include significantly more data in subpackets.
Second, the hash is salted with random data (see <a class="auto internal xref" href="#signature-salt-rationale">Section 13.2</a>).<a class="pilcrow" href="#section-5.2.3.6-3">¶</a></p>
<p id="section-5.2.3.6-4">The algorithms for converting the hash function result to a signature are described in <a class="auto internal xref" href="#computing-signatures">Section 5.2.4</a>.<a class="pilcrow" href="#section-5.2.3.6-4">¶</a></p>
</section>
</div>
<div id="signature-subpacket">
<section id="section-5.2.3.7">
            <h5 id="name-signature-subpacket-specifi">
<a class="section-number selfRef" href="#section-5.2.3.7">5.2.3.7. </a><a class="section-name selfRef" href="#name-signature-subpacket-specifi">Signature Subpacket Specification</a>
            </h5>
<p id="section-5.2.3.7-1">A subpacket data set consists of zero or more Signature subpackets.
In Signature packets, the subpacket data set is preceded by a 2-octet (for version 4 signatures) or 4-octet (for version 6 signatures) scalar count of the length in octets of all the subpackets.
A pointer incremented by this number will skip over the subpacket data set.<a class="pilcrow" href="#section-5.2.3.7-1">¶</a></p>
<p id="section-5.2.3.7-2">Each subpacket consists of a subpacket header and a body.
The header consists of:<a class="pilcrow" href="#section-5.2.3.7-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.3.7-3.1">The encoded subpacket length (1, 2, or 5 octets).<a class="pilcrow" href="#section-5.2.3.7-3.1">¶</a>
</li>
              <li class="normal" id="section-5.2.3.7-3.2">The encoded Subpacket Type ID (1 octet).<a class="pilcrow" href="#section-5.2.3.7-3.2">¶</a>
</li>
              <li class="normal" id="section-5.2.3.7-3.3">The subpacket-specific data.<a class="pilcrow" href="#section-5.2.3.7-3.3">¶</a>
</li>
            </ul>
<p id="section-5.2.3.7-4">The subpacket length field covers the encoded Subpacket Type ID and the subpacket-specific data, and it does not include the subpacket length field itself. It is encoded similarly to a 1-octet, 2-octet, or 5-octet OpenPGP format packet header. The encoded subpacket length can be decoded as follows:<a class="pilcrow" href="#section-5.2.3.7-4">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2.3.7-5">
<pre>if the 1st octet &lt;  192, then
    lengthOfLength = 1
    subpacketLen = 1st_octet

if the 1st octet &gt;= 192 and &lt; 255, then
    lengthOfLength = 2
    subpacketLen = ((1st_octet - 192) &lt;&lt; 8) + (2nd_octet) + 192

if the 1st octet = 255, then
    lengthOfLength = 5
    subpacket length = [4-octet scalar starting at 2nd_octet]
</pre><a class="pilcrow" href="#section-5.2.3.7-5">¶</a>
</div>
<p id="section-5.2.3.7-6">Bit 7 of the encoded Subpacket Type ID is the "critical" bit.
If set, it denotes that the subpacket is one that is critical for the evaluator of the signature to recognize. If a subpacket is encountered that is marked critical but is unknown to the evaluating implementation, the evaluator <span class="bcp14">SHOULD</span> consider the signature to be in error.<a class="pilcrow" href="#section-5.2.3.7-6">¶</a></p>
<p id="section-5.2.3.7-7">An implementation <span class="bcp14">SHOULD</span> ignore any non-critical subpacket of a type that it does not recognize.<a class="pilcrow" href="#section-5.2.3.7-7">¶</a></p>
<p id="section-5.2.3.7-8">An evaluator may "recognize" a subpacket but not implement it.
The purpose of the critical bit is to allow the signer to tell an evaluator that it would prefer a new, unknown feature to generate an error rather than being ignored.<a class="pilcrow" href="#section-5.2.3.7-8">¶</a></p>
<p id="section-5.2.3.7-9">The other bits of the encoded Subpacket Type ID (i.e., bits 6-0) contain the Subpacket Type ID.<a class="pilcrow" href="#section-5.2.3.7-9">¶</a></p>
<p id="section-5.2.3.7-10">The following signature subpackets are defined:<a class="pilcrow" href="#section-5.2.3.7-10">¶</a></p>
<span id="name-openpgp-signature-subpacket"></span><div id="signature-subpacket-types-registry">
<table class="center" id="table-5">
              <caption>
<a class="selfRef" href="#table-5">Table 5</a>:
<a class="selfRef" href="#name-openpgp-signature-subpacket">OpenPGP Signature Subpacket Types Registry</a>
              </caption>
<thead>
                <tr>
                  <th class="text-right" colspan="1" rowspan="1">ID</th>
                  <th class="text-left" colspan="1" rowspan="1">Description</th>
                  <th class="text-left" colspan="1" rowspan="1">Reference</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-right" colspan="1" rowspan="1">0</td>
                  <td class="text-left" colspan="1" rowspan="1">Reserved</td>
                  <td class="text-left" colspan="1" rowspan="1"></td>
                </tr>
                <tr>
                  <td class="text-right" colspan="1" rowspan="1">1</td>
                  <td class="text-left" colspan="1" rowspan="1">Reserved</td>
                  <td class="text-left" colspan="1" rowspan="1"></td>
                </tr>
                <tr>
                  <td class="text-right" colspan="1" rowspan="1">2</td>
                  <td class="text-left" colspan="1" rowspan="1">Signature Creation Time</td>
                  <td class="text-left" colspan="1" rowspan="1">
                    <a class="auto internal xref" href="#signature-creation-subpacket">Section 5.2.3.11</a>
</td>
                </tr>
                <tr>
                  <td class="text-right" colspan="1" rowspan="1">3</td>
                  <td class="text-left" colspan="1" rowspan="1">Signature Expiration Time</td>
                  <td class="text-left" colspan="1" rowspan="1">
                    <a class="auto internal xref" href="#signature-expiration-subpacket">Section 5.2.3.18</a>
</td>
                </tr>
                <tr>
                  <td class="text-right" colspan="1" rowspan="1">4</td>
                  <td class="text-left" colspan="1" rowspan="1">Exportable Certification</td>
                  <td class="text-left" colspan="1" rowspan="1">
                    <a class="auto internal xref" href="#exportable-certification-subpacket">Section 5.2.3.19</a>
</td>
                </tr>
                <tr>
                  <td class="text-right" colspan="1" rowspan="1">5</td>
                  <td class="text-left" colspan="1" rowspan="1">Trust Signature</td>
                  <td class="text-left" colspan="1" rowspan="1">
                    <a class="auto internal xref" href="#trust-signature-subpacket">Section 5.2.3.21</a>
</td>
                </tr>
                <tr>
                  <td class="text-right" colspan="1" rowspan="1">6</td>
                  <td class="text-left" colspan="1" rowspan="1">Regular Expression</td>
                  <td class="text-left" colspan="1" rowspan="1">
                    <a class="auto internal xref" href="#regex-subpacket">Section 5.2.3.22</a>
</td>
                </tr>
                <tr>
                  <td class="text-right" colspan="1" rowspan="1">7</td>
                  <td class="text-left" colspan="1" rowspan="1">Revocable</td>
                  <td class="text-left" colspan="1" rowspan="1">
                    <a class="auto internal xref" href="#revocable-subpacket">Section 5.2.3.20</a>
</td>
                </tr>
                <tr>
                  <td class="text-right" colspan="1" rowspan="1">8</td>
                  <td class="text-left" colspan="1" rowspan="1">Reserved</td>
                  <td class="text-left" colspan="1" rowspan="1"></td>
                </tr>
                <tr>
                  <td class="text-right" colspan="1" rowspan="1">9</td>
                  <td class="text-left" colspan="1" rowspan="1">Key Expiration Time</td>
                  <td class="text-left" colspan="1" rowspan="1">
                    <a class="auto internal xref" href="#key-expiration-subpacket">Section 5.2.3.13</a>
</td>
                </tr>
                <tr>
                  <td class="text-right" colspan="1" rowspan="1">10</td>
                  <td class="text-left" colspan="1" rowspan="1">Placeholder for backward compatibility</td>
                  <td class="text-left" colspan="1" rowspan="1"></td>
                </tr>
                <tr>
                  <td class="text-right" colspan="1" rowspan="1">11</td>
                  <td class="text-left" colspan="1" rowspan="1">Preferred Symmetric Ciphers for v1 SEIPD</td>
                  <td class="text-left" colspan="1" rowspan="1">
                    <a class="auto internal xref" href="#preferred-v1-seipd">Section 5.2.3.14</a>
</td>
                </tr>
                <tr>
                  <td class="text-right" colspan="1" rowspan="1">12</td>
                  <td class="text-left" colspan="1" rowspan="1">Revocation Key (deprecated)</td>
                  <td class="text-left" colspan="1" rowspan="1">
                    <a class="auto internal xref" href="#revocation-key">Section 5.2.3.23</a>
</td>
                </tr>
                <tr>
                  <td class="text-right" colspan="1" rowspan="1">13-15</td>
                  <td class="text-left" colspan="1" rowspan="1">Reserved</td>
                  <td class="text-left" colspan="1" rowspan="1"></td>
                </tr>
                <tr>
                  <td class="text-right" colspan="1" rowspan="1">16</td>
                  <td class="text-left" colspan="1" rowspan="1">Issuer Key ID</td>
                  <td class="text-left" colspan="1" rowspan="1">
                    <a class="auto internal xref" href="#issuer-keyid-subpacket">Section 5.2.3.12</a>
</td>
                </tr>
                <tr>
                  <td class="text-right" colspan="1" rowspan="1">17-19</td>
                  <td class="text-left" colspan="1" rowspan="1">Reserved</td>
                  <td class="text-left" colspan="1" rowspan="1"></td>
                </tr>
                <tr>
                  <td class="text-right" colspan="1" rowspan="1">20</td>
                  <td class="text-left" colspan="1" rowspan="1">Notation Data</td>
                  <td class="text-left" colspan="1" rowspan="1">
                    <a class="auto internal xref" href="#notation-data">Section 5.2.3.24</a>
</td>
                </tr>
                <tr>
                  <td class="text-right" colspan="1" rowspan="1">21</td>
                  <td class="text-left" colspan="1" rowspan="1">Preferred Hash Algorithms</td>
                  <td class="text-left" colspan="1" rowspan="1">
                    <a class="auto internal xref" href="#preferred-hashes-subpacket">Section 5.2.3.16</a>
</td>
                </tr>
                <tr>
                  <td class="text-right" colspan="1" rowspan="1">22</td>
                  <td class="text-left" colspan="1" rowspan="1">Preferred Compression Algorithms</td>
                  <td class="text-left" colspan="1" rowspan="1">
                    <a class="auto internal xref" href="#preferred-compression-subpacket">Section 5.2.3.17</a>
</td>
                </tr>
                <tr>
                  <td class="text-right" colspan="1" rowspan="1">23</td>
                  <td class="text-left" colspan="1" rowspan="1">Key Server Preferences</td>
                  <td class="text-left" colspan="1" rowspan="1">
                    <a class="auto internal xref" href="#key-server-preferences">Section 5.2.3.25</a>
</td>
                </tr>
                <tr>
                  <td class="text-right" colspan="1" rowspan="1">24</td>
                  <td class="text-left" colspan="1" rowspan="1">Preferred Key Server</td>
                  <td class="text-left" colspan="1" rowspan="1">
                    <a class="auto internal xref" href="#preferred-key-server-subpacket">Section 5.2.3.26</a>
</td>
                </tr>
                <tr>
                  <td class="text-right" colspan="1" rowspan="1">25</td>
                  <td class="text-left" colspan="1" rowspan="1">Primary User ID</td>
                  <td class="text-left" colspan="1" rowspan="1">
                    <a class="auto internal xref" href="#primary-user-id-subpacket">Section 5.2.3.27</a>
</td>
                </tr>
                <tr>
                  <td class="text-right" colspan="1" rowspan="1">26</td>
                  <td class="text-left" colspan="1" rowspan="1">Policy URI</td>
                  <td class="text-left" colspan="1" rowspan="1">
                    <a class="auto internal xref" href="#policy-uri-subpacket">Section 5.2.3.28</a>
</td>
                </tr>
                <tr>
                  <td class="text-right" colspan="1" rowspan="1">27</td>
                  <td class="text-left" colspan="1" rowspan="1">Key Flags</td>
                  <td class="text-left" colspan="1" rowspan="1">
                    <a class="auto internal xref" href="#key-flags">Section 5.2.3.29</a>
</td>
                </tr>
                <tr>
                  <td class="text-right" colspan="1" rowspan="1">28</td>
                  <td class="text-left" colspan="1" rowspan="1">Signer's User ID</td>
                  <td class="text-left" colspan="1" rowspan="1">
                    <a class="auto internal xref" href="#signers-user-id-subpacket">Section 5.2.3.30</a>
</td>
                </tr>
                <tr>
                  <td class="text-right" colspan="1" rowspan="1">29</td>
                  <td class="text-left" colspan="1" rowspan="1">Reason for Revocation</td>
                  <td class="text-left" colspan="1" rowspan="1">
                    <a class="auto internal xref" href="#reason-for-revocation">Section 5.2.3.31</a>
</td>
                </tr>
                <tr>
                  <td class="text-right" colspan="1" rowspan="1">30</td>
                  <td class="text-left" colspan="1" rowspan="1">Features</td>
                  <td class="text-left" colspan="1" rowspan="1">
                    <a class="auto internal xref" href="#features-subpacket">Section 5.2.3.32</a>
</td>
                </tr>
                <tr>
                  <td class="text-right" colspan="1" rowspan="1">31</td>
                  <td class="text-left" colspan="1" rowspan="1">Signature Target</td>
                  <td class="text-left" colspan="1" rowspan="1">
                    <a class="auto internal xref" href="#signature-target-subpacket">Section 5.2.3.33</a>
</td>
                </tr>
                <tr>
                  <td class="text-right" colspan="1" rowspan="1">32</td>
                  <td class="text-left" colspan="1" rowspan="1">Embedded Signature</td>
                  <td class="text-left" colspan="1" rowspan="1">
                    <a class="auto internal xref" href="#embedded-signature-subpacket">Section 5.2.3.34</a>
</td>
                </tr>
                <tr>
                  <td class="text-right" colspan="1" rowspan="1">33</td>
                  <td class="text-left" colspan="1" rowspan="1">Issuer Fingerprint</td>
                  <td class="text-left" colspan="1" rowspan="1">
                    <a class="auto internal xref" href="#issuer-fingerprint-subpacket">Section 5.2.3.35</a>
</td>
                </tr>
                <tr>
                  <td class="text-right" colspan="1" rowspan="1">34</td>
                  <td class="text-left" colspan="1" rowspan="1">Reserved</td>
                  <td class="text-left" colspan="1" rowspan="1"></td>
                </tr>
                <tr>
                  <td class="text-right" colspan="1" rowspan="1">35</td>
                  <td class="text-left" colspan="1" rowspan="1">Intended Recipient Fingerprint</td>
                  <td class="text-left" colspan="1" rowspan="1">
                    <a class="auto internal xref" href="#intended-recipient-fingerprint">Section 5.2.3.36</a>
</td>
                </tr>
                <tr>
                  <td class="text-right" colspan="1" rowspan="1">37</td>
                  <td class="text-left" colspan="1" rowspan="1">Reserved (Attested Certifications)</td>
                  <td class="text-left" colspan="1" rowspan="1"></td>
                </tr>
                <tr>
                  <td class="text-right" colspan="1" rowspan="1">38</td>
                  <td class="text-left" colspan="1" rowspan="1">Reserved (Key Block)</td>
                  <td class="text-left" colspan="1" rowspan="1"></td>
                </tr>
                <tr>
                  <td class="text-right" colspan="1" rowspan="1">39</td>
                  <td class="text-left" colspan="1" rowspan="1">Preferred AEAD Ciphersuites</td>
                  <td class="text-left" colspan="1" rowspan="1">
                    <a class="auto internal xref" href="#preferred-v2-seipd">Section 5.2.3.15</a>
</td>
                </tr>
                <tr>
                  <td class="text-right" colspan="1" rowspan="1">100-110</td>
                  <td class="text-left" colspan="1" rowspan="1">Private or Experimental Use</td>
                  <td class="text-left" colspan="1" rowspan="1"></td>
                </tr>
              </tbody>
            </table>
</div>
<p id="section-5.2.3.7-12">Implementations <span class="bcp14">SHOULD</span> implement the four preferred algorithm subpackets (11, 21, 22, and 39), as well as the "Features" (30) and "Reason for Revocation" (29) subpackets.
To avoid surreptitious forwarding (see <a class="auto internal xref" href="#surreptitious-forwarding">Section 13.12</a>), implementations <span class="bcp14">SHOULD</span> also implement the "Intended Recipients Fingerprint" (35) subpacket.
Note that if an implementation chooses not to implement some of the preferences subpackets, it <span class="bcp14">MUST</span> default to the mandatory-to-implement algorithms to ensure interoperability.
An encrypting implementation that does not implement the "Features" (30) subpacket <span class="bcp14">SHOULD</span> select the type of encrypted data format based on the versions of the recipient keys or external inference (see <a class="auto internal xref" href="#ciphertext-malleability">Section 13.7</a> for more details).<a class="pilcrow" href="#section-5.2.3.7-12">¶</a></p>
</section>
</div>
<div id="signature-subpacket-types">
<section id="section-5.2.3.8">
            <h5 id="name-signature-subpacket-types">
<a class="section-number selfRef" href="#section-5.2.3.8">5.2.3.8. </a><a class="section-name selfRef" href="#name-signature-subpacket-types">Signature Subpacket Types</a>
            </h5>
<p id="section-5.2.3.8-1">A number of subpackets are currently defined for OpenPGP signatures.
Some subpackets apply to the signature itself and some are attributes of the key.
Subpackets that are found on a self-signature are placed on a certification made by the key itself.
Note that a key may have more than one User ID and thus may have more than one self-signature and differing subpackets.<a class="pilcrow" href="#section-5.2.3.8-1">¶</a></p>
<p id="section-5.2.3.8-2">A subpacket may be found in either the hashed or the unhashed subpacket sections of a signature. If a subpacket is not hashed, then the information in it cannot be considered definitive because it is not covered by the cryptographic signature. See <a class="auto internal xref" href="#subpacket-section-guidance">Section 13.13</a> for more discussion about hashed and unhashed subpackets.<a class="pilcrow" href="#section-5.2.3.8-2">¶</a></p>
</section>
</div>
<div id="notes-on-subpackets">
<section id="section-5.2.3.9">
            <h5 id="name-notes-on-subpackets">
<a class="section-number selfRef" href="#section-5.2.3.9">5.2.3.9. </a><a class="section-name selfRef" href="#name-notes-on-subpackets">Notes on Subpackets</a>
            </h5>
<p id="section-5.2.3.9-1">It is certainly possible for a signature to contain conflicting information in subpackets.
For example, a signature may contain multiple copies of a preference or multiple expiration times. In most cases, an implementation <span class="bcp14">SHOULD</span> use the last subpacket in the hashed section of the signature, but it <span class="bcp14">MAY</span> use any conflict resolution scheme that makes more sense. Please note that conflict resolution is intentionally left to the implementer; most conflicts are simply syntax errors, and the ambiguous language here allows a receiver to be generous in what they accept, while putting pressure on a creator to be stingy in what they generate.<a class="pilcrow" href="#section-5.2.3.9-1">¶</a></p>
<p id="section-5.2.3.9-2">Some apparent conflicts may actually make sense. For example, suppose a keyholder has a version 3 key and a version 4 key that share the same RSA key material. Either of these keys can verify a signature created by the other, and it may be reasonable for a signature to contain an Issuer Key ID subpacket (<a class="auto internal xref" href="#issuer-keyid-subpacket">Section 5.2.3.12</a>) for each key, as a way of explicitly tying those keys to the signature.<a class="pilcrow" href="#section-5.2.3.9-2">¶</a></p>
</section>
</div>
<div id="self-sigs">
<section id="section-5.2.3.10">
            <h5 id="name-notes-on-self-signatures">
<a class="section-number selfRef" href="#section-5.2.3.10">5.2.3.10. </a><a class="section-name selfRef" href="#name-notes-on-self-signatures">Notes on Self-Signatures</a>
            </h5>
<p id="section-5.2.3.10-1">A self-signature is a binding signature made by the key to which the signature refers. There are three types of self-signatures: the certification signatures (Type IDs 0x10-0x13), the Direct Key signature (Type ID 0x1F), and the Subkey Binding signature (Type ID 0x18). A cryptographically valid self-signature should be accepted from any primary key, regardless of what Key Flags (<a class="auto internal xref" href="#key-flags">Section 5.2.3.29</a>) apply to the primary key.
In particular, a primary key does not need to have 0x01 set in the first octet of the Key Flags order to make a valid self-signature.<a class="pilcrow" href="#section-5.2.3.10-1">¶</a></p>
<p id="section-5.2.3.10-2">For certification self-signatures, each User ID <span class="bcp14">MAY</span> have a self-signature and thus different subpackets in those self-signatures.
For Subkey Binding signatures, each subkey <span class="bcp14">MUST</span> have a self-signature.
Subpackets that appear in a certification self-signature apply to the User ID, and subpackets that appear in the subkey self-signature apply to the subkey.
Lastly, subpackets on the Direct Key signature apply to the entire key.<a class="pilcrow" href="#section-5.2.3.10-2">¶</a></p>
<p id="section-5.2.3.10-3">An implementation should interpret a self-signature's preference subpackets as narrowly as possible.
For example, suppose a key has two user names, Alice and Bob.
Suppose that Alice prefers the AEAD ciphersuite AES-256 with OCB, and Bob prefers Camellia-256 with GCM. If the implementation locates this key via Alice's name, then the preferred AEAD ciphersuite is AES-256 with OCB; if the implementation locates the key via Bob's name, then the preferred algorithm is Camellia-256 with GCM.
If the key is located by Key ID, the algorithm of the Primary User ID of the key provides the preferred AEAD ciphersuite.<a class="pilcrow" href="#section-5.2.3.10-3">¶</a></p>
<p id="section-5.2.3.10-4">Revoking a self-signature or allowing it to expire has a semantic meaning that varies with the signature type.
Revoking the self-signature on a User ID effectively retires that user name.
The self-signature is a statement, "My name X is tied to my signing key K", and it is corroborated by other users' certifications.
If another user revokes their certification, they are effectively saying that they no longer believe that name and that key are tied together.
Similarly, if the users themselves revoke their self-signature, then the users no longer go by that name, no longer have that email address, etc.
Revoking a binding signature effectively retires that subkey. Revoking a Direct Key signature cancels that signature.
Please see <a class="auto internal xref" href="#reason-for-revocation">Section 5.2.3.31</a> for more relevant details.<a class="pilcrow" href="#section-5.2.3.10-4">¶</a></p>
<p id="section-5.2.3.10-5">Since a self-signature contains important information about the key's use, an implementation <span class="bcp14">SHOULD</span> allow the user to rewrite the self-signature and important information in it, such as preferences and key expiration.<a class="pilcrow" href="#section-5.2.3.10-5">¶</a></p>
<p id="section-5.2.3.10-6">When an implementation imports a secret key, it <span class="bcp14">SHOULD</span> verify that the key's internal self-signatures do not advertise features or algorithms that the implementation doesn't support.
If an implementation observes such a mismatch, it <span class="bcp14">SHOULD</span> warn the user and offer to create new self-signatures that advertise the actual set of features and algorithms supported by the implementation.<a class="pilcrow" href="#section-5.2.3.10-6">¶</a></p>
<p id="section-5.2.3.10-7">An implementation that encounters multiple self-signatures on the same object <span class="bcp14">MUST</span> select the most recent valid self-signature and ignore all other self-signatures.<a class="pilcrow" href="#section-5.2.3.10-7">¶</a></p>
<p id="section-5.2.3.10-8">By convention, a version 4 key stores information about the primary Public Key (key flags, key expiration, etc.) and the Transferable Public Key as a whole (features, algorithm preferences, etc.) in a User ID self-signature of type 0x10 or 0x13. To use a version 4 key, 
some implementations require at least one User ID with a valid self-signature to be present.
For this reason, it is <span class="bcp14">RECOMMENDED</span> to include at least one User ID with a self-signature in version 4 keys.<a class="pilcrow" href="#section-5.2.3.10-8">¶</a></p>
<p id="section-5.2.3.10-9">For version 6 keys, it is <span class="bcp14">RECOMMENDED</span> to store information about the primary Public Key as well as the Transferable Public Key as a whole (key flags, key expiration, features, algorithm preferences, etc.) in a Direct Key signature (Type ID 0x1F) over the Public Key, instead of placing that information in a User ID self-signature.
An implementation <span class="bcp14">MUST</span> ensure that a valid Direct Key signature is present before using a version 6 key.
This prevents certain attacks where an adversary strips a self-signature specifying a Key Expiration Time or certain preferences.<a class="pilcrow" href="#section-5.2.3.10-9">¶</a></p>
<p id="section-5.2.3.10-10">An implementation <span class="bcp14">SHOULD NOT</span> require a User ID self-signature to be present in order to consume or use a key, unless the particular use is contingent on the keyholder identifying themselves with the textual label in the User ID.
For example, when refreshing a key to learn about changes in expiration, advertised features, algorithm preferences, revocation, subkey rotation, and so forth, there is no need to require a User ID self-signature. On the other hand, when verifying a signature over an email message, an implementation <span class="bcp14">MAY</span> choose to only accept a signature from a key that has a valid self-signature over a User ID that matches the message's From: header, as a way to avoid a signature transplant attack.<a class="pilcrow" href="#section-5.2.3.10-10">¶</a></p>
</section>
</div>
<div id="signature-creation-subpacket">
<section id="section-5.2.3.11">
            <h5 id="name-signature-creation-time">
<a class="section-number selfRef" href="#section-5.2.3.11">5.2.3.11. </a><a class="section-name selfRef" href="#name-signature-creation-time">Signature Creation Time</a>
            </h5>
<p id="section-5.2.3.11-1">(4-octet time field)<a class="pilcrow" href="#section-5.2.3.11-1">¶</a></p>
<p id="section-5.2.3.11-2">The time the signature was made.<a class="pilcrow" href="#section-5.2.3.11-2">¶</a></p>
<p id="section-5.2.3.11-3">This subpacket <span class="bcp14">MUST</span> be present in the hashed area.<a class="pilcrow" href="#section-5.2.3.11-3">¶</a></p>
<p id="section-5.2.3.11-4">When generating this subpacket, it <span class="bcp14">SHOULD</span> be marked as critical.<a class="pilcrow" href="#section-5.2.3.11-4">¶</a></p>
</section>
</div>
<div id="issuer-keyid-subpacket">
<section id="section-5.2.3.12">
            <h5 id="name-issuer-key-id">
<a class="section-number selfRef" href="#section-5.2.3.12">5.2.3.12. </a><a class="section-name selfRef" href="#name-issuer-key-id">Issuer Key ID</a>
            </h5>
<p id="section-5.2.3.12-1">(8-octet Key ID)<a class="pilcrow" href="#section-5.2.3.12-1">¶</a></p>
<p id="section-5.2.3.12-2">The OpenPGP Key ID of the key issuing the signature.
If the version of that key is greater than 4, this subpacket <span class="bcp14">MUST NOT</span> be included in the signature.
     For these keys, consider the Issuer Fingerprint subpacket (<a class="auto internal xref" href="#issuer-fingerprint-subpacket">Section 5.2.3.35</a>) instead.<a class="pilcrow" href="#section-5.2.3.12-2">¶</a></p>
<p id="section-5.2.3.12-3">Note: in previous versions of this specification, this subpacket was simply known as the "Issuer" subpacket.<a class="pilcrow" href="#section-5.2.3.12-3">¶</a></p>
</section>
</div>
<div id="key-expiration-subpacket">
<section id="section-5.2.3.13">
            <h5 id="name-key-expiration-time">
<a class="section-number selfRef" href="#section-5.2.3.13">5.2.3.13. </a><a class="section-name selfRef" href="#name-key-expiration-time">Key Expiration Time</a>
            </h5>
<p id="section-5.2.3.13-1">(4-octet time field)<a class="pilcrow" href="#section-5.2.3.13-1">¶</a></p>
<p id="section-5.2.3.13-2">The validity period of the key.
This is the number of seconds after the key creation time that the key expires.
For a direct or certification self-signature, the key creation time is that of the primary key.
For a Subkey Binding signature, the key creation time is that of the subkey.
If this is not present or has a value of zero, the key never expires.
This is found only on a self-signature.<a class="pilcrow" href="#section-5.2.3.13-2">¶</a></p>
<p id="section-5.2.3.13-3">When an implementation generates this subpacket, it <span class="bcp14">SHOULD</span> be marked as critical.<a class="pilcrow" href="#section-5.2.3.13-3">¶</a></p>
</section>
</div>
<div id="preferred-v1-seipd">
<section id="section-5.2.3.14">
            <h5 id="name-preferred-symmetric-ciphers">
<a class="section-number selfRef" href="#section-5.2.3.14">5.2.3.14. </a><a class="section-name selfRef" href="#name-preferred-symmetric-ciphers">Preferred Symmetric Ciphers for v1 SEIPD</a>
            </h5>
<p id="section-5.2.3.14-1">(array of 1-octet values)<a class="pilcrow" href="#section-5.2.3.14-1">¶</a></p>
<p id="section-5.2.3.14-2">A series of Symmetric Cipher Algorithm IDs indicating how the keyholder prefers to receive the version 1 Symmetrically Encrypted and Integrity Protected Data packet (<a class="auto internal xref" href="#version-one-seipd">Section 5.13.1</a>).
The subpacket body is an ordered list of octets with the most preferred listed first.
It is assumed that only the algorithms listed are supported by the recipient's implementation.
Algorithm IDs are defined in <a class="auto internal xref" href="#symmetric-algos">Section 9.3</a>.
This is only found on a self-signature.<a class="pilcrow" href="#section-5.2.3.14-2">¶</a></p>
<p id="section-5.2.3.14-3">When generating a v2 SEIPD packet, this preference list is not relevant.
See <a class="auto internal xref" href="#preferred-v2-seipd">Section 5.2.3.15</a> instead.<a class="pilcrow" href="#section-5.2.3.14-3">¶</a></p>
</section>
</div>
<div id="preferred-v2-seipd">
<section id="section-5.2.3.15">
            <h5 id="name-preferred-aead-ciphersuites">
<a class="section-number selfRef" href="#section-5.2.3.15">5.2.3.15. </a><a class="section-name selfRef" href="#name-preferred-aead-ciphersuites">Preferred AEAD Ciphersuites</a>
            </h5>
<p id="section-5.2.3.15-1">(array of pairs of octets indicating Symmetric Cipher and AEAD algorithms)<a class="pilcrow" href="#section-5.2.3.15-1">¶</a></p>
<p id="section-5.2.3.15-2">A series of paired algorithm IDs indicating how the keyholder prefers to receive the version 2 Symmetrically Encrypted and Integrity Protected Data packet (<a class="auto internal xref" href="#version-two-seipd">Section 5.13.2</a>).
Each pair of octets indicates a combination of a symmetric cipher and an AEAD mode that the keyholder prefers to use.
The Symmetric Cipher Algorithm ID precedes the AEAD algorithm ID in each pair.
The subpacket body is an ordered list of pairs of octets with the most preferred algorithm combination listed first.<a class="pilcrow" href="#section-5.2.3.15-2">¶</a></p>
<p id="section-5.2.3.15-3">It is assumed that only the combinations of algorithms listed are supported by the recipient's implementation, with the exception of the mandatory-to-implement combination of AES-128 and OCB.
If AES-128 and OCB are not found in the subpacket, it is implicitly listed at the end.<a class="pilcrow" href="#section-5.2.3.15-3">¶</a></p>
<p id="section-5.2.3.15-4">AEAD algorithm IDs are listed in <a class="auto internal xref" href="#aead-algorithms">Section 9.6</a>.
Symmetric Cipher Algorithm IDs are listed in <a class="auto internal xref" href="#symmetric-algos">Section 9.3</a>.<a class="pilcrow" href="#section-5.2.3.15-4">¶</a></p>
<p id="section-5.2.3.15-5">For example, a subpacket containing the six octets<a class="pilcrow" href="#section-5.2.3.15-5">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2.3.15-6">
<pre>09 02 09 03 13 02
</pre><a class="pilcrow" href="#section-5.2.3.15-6">¶</a>
</div>
<p id="section-5.2.3.15-7">indicates that the keyholder prefers to receive v2 SEIPD using AES-256 with OCB, then AES-256 with GCM, then Camellia-256 with OCB, and finally the implicit AES-128 with OCB.<a class="pilcrow" href="#section-5.2.3.15-7">¶</a></p>
<p id="section-5.2.3.15-8">Note that support for the version 2 Symmetrically Encrypted and Integrity Protected Data packet (<a class="auto internal xref" href="#version-two-seipd">Section 5.13.2</a>) in general is indicated by a Features Flag (<a class="auto internal xref" href="#features-subpacket">Section 5.2.3.32</a>).<a class="pilcrow" href="#section-5.2.3.15-8">¶</a></p>
<p id="section-5.2.3.15-9">This subpacket is only found on a self-signature.<a class="pilcrow" href="#section-5.2.3.15-9">¶</a></p>
<p id="section-5.2.3.15-10">When generating a v1 SEIPD packet, this preference list is not relevant.
See <a class="auto internal xref" href="#preferred-v1-seipd">Section 5.2.3.14</a> instead.<a class="pilcrow" href="#section-5.2.3.15-10">¶</a></p>
</section>
</div>
<div id="preferred-hashes-subpacket">
<section id="section-5.2.3.16">
            <h5 id="name-preferred-hash-algorithms">
<a class="section-number selfRef" href="#section-5.2.3.16">5.2.3.16. </a><a class="section-name selfRef" href="#name-preferred-hash-algorithms">Preferred Hash Algorithms</a>
            </h5>
<p id="section-5.2.3.16-1">(array of 1-octet values)<a class="pilcrow" href="#section-5.2.3.16-1">¶</a></p>
<p id="section-5.2.3.16-2">Message digest algorithm IDs that indicate which algorithms the keyholder prefers to receive.
Like the Preferred AEAD Ciphersuites, the list is ordered.
Algorithm IDs are defined in <a class="auto internal xref" href="#hash-algos">Section 9.5</a>.
This is only found on a self-signature.<a class="pilcrow" href="#section-5.2.3.16-2">¶</a></p>
</section>
</div>
<div id="preferred-compression-subpacket">
<section id="section-5.2.3.17">
            <h5 id="name-preferred-compression-algor">
<a class="section-number selfRef" href="#section-5.2.3.17">5.2.3.17. </a><a class="section-name selfRef" href="#name-preferred-compression-algor">Preferred Compression Algorithms</a>
            </h5>
<p id="section-5.2.3.17-1">(array of 1-octet values)<a class="pilcrow" href="#section-5.2.3.17-1">¶</a></p>
<p id="section-5.2.3.17-2">Compression algorithm IDs that indicate which algorithms the keyholder prefers to use.
Like the Preferred AEAD Ciphersuites, the list is ordered.
Algorithm IDs are defined in <a class="auto internal xref" href="#compression-algos">Section 9.4</a>.
A zero, or the absence of this subpacket, denotes that uncompressed data is preferred; the keyholder's implementation might have no compression support available.
This is only found on a self-signature.<a class="pilcrow" href="#section-5.2.3.17-2">¶</a></p>
</section>
</div>
<div id="signature-expiration-subpacket">
<section id="section-5.2.3.18">
            <h5 id="name-signature-expiration-time">
<a class="section-number selfRef" href="#section-5.2.3.18">5.2.3.18. </a><a class="section-name selfRef" href="#name-signature-expiration-time">Signature Expiration Time</a>
            </h5>
<p id="section-5.2.3.18-1">(4-octet time field)<a class="pilcrow" href="#section-5.2.3.18-1">¶</a></p>
<p id="section-5.2.3.18-2">The validity period of the signature.
This is the number of seconds after the Signature Creation Time that the signature expires.
If this is not present or has a value of zero, it never expires.<a class="pilcrow" href="#section-5.2.3.18-2">¶</a></p>
<p id="section-5.2.3.18-3">When an implementation generates this subpacket, it <span class="bcp14">SHOULD</span> be marked as critical.<a class="pilcrow" href="#section-5.2.3.18-3">¶</a></p>
</section>
</div>
<div id="exportable-certification-subpacket">
<section id="section-5.2.3.19">
            <h5 id="name-exportable-certification">
<a class="section-number selfRef" href="#section-5.2.3.19">5.2.3.19. </a><a class="section-name selfRef" href="#name-exportable-certification">Exportable Certification</a>
            </h5>
<p id="section-5.2.3.19-1">(1 octet of exportability, 0 for not, 1 for exportable)<a class="pilcrow" href="#section-5.2.3.19-1">¶</a></p>
<p id="section-5.2.3.19-2">This subpacket denotes whether a certification signature is "exportable"; it is intended for use by users other than the signature's issuer.
The packet body contains a Boolean flag indicating whether the signature is exportable.
If this packet is not present, the certification is exportable; it is equivalent to a flag containing a 1.<a class="pilcrow" href="#section-5.2.3.19-2">¶</a></p>
<p id="section-5.2.3.19-3">Non-exportable, or "local", certifications are signatures made by a user to mark a key as valid within that user's implementation only.<a class="pilcrow" href="#section-5.2.3.19-3">¶</a></p>
<p id="section-5.2.3.19-4">Thus, when an implementation prepares a user's copy of a key for transport to another user (this is the process of "exporting" the key), any local certification signatures are deleted from the key.<a class="pilcrow" href="#section-5.2.3.19-4">¶</a></p>
<p id="section-5.2.3.19-5">The receiver of a transported key "imports" it and likewise trims any local certifications. In normal operation, there won't be any local certifications, assuming the import is performed on an exported key. However, there are instances where this can reasonably happen.
For example, if an implementation allows keys to be imported from a key database in addition to an exported key, then this situation can arise.<a class="pilcrow" href="#section-5.2.3.19-5">¶</a></p>
<p id="section-5.2.3.19-6">Some implementations do not represent the interest of a single user (for example, a key server).
Such implementations always trim local certifications from any key they handle.<a class="pilcrow" href="#section-5.2.3.19-6">¶</a></p>
<p id="section-5.2.3.19-7">When an implementation generates this subpacket and denotes the signature as non-exportable, the subpacket <span class="bcp14">MUST</span> be marked as critical.<a class="pilcrow" href="#section-5.2.3.19-7">¶</a></p>
</section>
</div>
<div id="revocable-subpacket">
<section id="section-5.2.3.20">
            <h5 id="name-revocable">
<a class="section-number selfRef" href="#section-5.2.3.20">5.2.3.20. </a><a class="section-name selfRef" href="#name-revocable">Revocable</a>
            </h5>
<p id="section-5.2.3.20-1">(1 octet of revocability, 0 for not, 1 for revocable)<a class="pilcrow" href="#section-5.2.3.20-1">¶</a></p>
<p id="section-5.2.3.20-2">A Signature's revocability status. The packet body contains a Boolean flag indicating whether the signature is revocable. Signatures that are not revocable ignore any later Revocation Signatures. They represent the signer's commitment that its signature cannot be revoked for the life of its key.
If this packet is not present, the signature is revocable.<a class="pilcrow" href="#section-5.2.3.20-2">¶</a></p>
</section>
</div>
<div id="trust-signature-subpacket">
<section id="section-5.2.3.21">
            <h5 id="name-trust-signature">
<a class="section-number selfRef" href="#section-5.2.3.21">5.2.3.21. </a><a class="section-name selfRef" href="#name-trust-signature">Trust Signature</a>
            </h5>
<p id="section-5.2.3.21-1">(1 octet "level" (depth), 1 octet of trust amount)<a class="pilcrow" href="#section-5.2.3.21-1">¶</a></p>
<p id="section-5.2.3.21-2">The signer asserts that the key is not only valid but also trustworthy at the specified level. Level 0 has the same meaning as an ordinary validity signature.
Level 1 means that the signed key is asserted to be a valid trusted introducer, with the 2nd octet of the body specifying the degree of trust.
Level 2 means that the signed key is asserted to be trusted to issue level 1 Trust Signatures; that is, the signed key is a "meta introducer".
Generally, a level n Trust Signature asserts that a key is trusted to issue level n-1 Trust Signatures.
The trust amount is in a range from 0-255, interpreted such that values less than 120 indicate partial trust and values of 120 or greater indicate complete trust.
Implementations <span class="bcp14">SHOULD</span> emit values of 60 for partial trust and 120 for complete trust.<a class="pilcrow" href="#section-5.2.3.21-2">¶</a></p>
</section>
</div>
<div id="regex-subpacket">
<section id="section-5.2.3.22">
            <h5 id="name-regular-expression">
<a class="section-number selfRef" href="#section-5.2.3.22">5.2.3.22. </a><a class="section-name selfRef" href="#name-regular-expression">Regular Expression</a>
            </h5>
<p id="section-5.2.3.22-1">(null-terminated UTF-8 encoded Regular Expression)<a class="pilcrow" href="#section-5.2.3.22-1">¶</a></p>
<p id="section-5.2.3.22-2">Used in conjunction with Trust Signature packets (of level &gt; 0) to limit the scope of trust that is extended.
Only signatures by the target key on User IDs that match the Regular Expression in the body of this packet have trust extended by the Trust Signature subpacket.
The Regular Expression uses the same syntax as Henry Spencer's "almost public domain" Regular Expression <span>[<a class="cite xref" href="#REGEX">REGEX</a>]</span> package.
A description of the syntax is found in <a class="auto internal xref" href="#regular-expressions">Section 8</a>.
The Regular Expression matches (or does not match) a sequence of UTF-8-encoded Unicode characters from User IDs.
The expression itself is also written with UTF-8 characters.<a class="pilcrow" href="#section-5.2.3.22-2">¶</a></p>
<p id="section-5.2.3.22-3">For historical reasons, this subpacket includes a null character (an octet with value zero) after the Regular Expression.
When an implementation parses a Regular Expression subpacket, it <span class="bcp14">MUST</span> remove this octet; if it is not present, it <span class="bcp14">MUST</span> reject the subpacket (i.e., ignore the subpacket if it's non-critical and reject the signature if it's critical).
When an implementation generates a Regular Expression subpacket, it <span class="bcp14">MUST</span> include the null terminator.<a class="pilcrow" href="#section-5.2.3.22-3">¶</a></p>
<p id="section-5.2.3.22-4">When generating this subpacket, it <span class="bcp14">SHOULD</span> be marked as critical.<a class="pilcrow" href="#section-5.2.3.22-4">¶</a></p>
</section>
</div>
<div id="revocation-key">
<section id="section-5.2.3.23">
            <h5 id="name-revocation-key-deprecated">
<a class="section-number selfRef" href="#section-5.2.3.23">5.2.3.23. </a><a class="section-name selfRef" href="#name-revocation-key-deprecated">Revocation Key (Deprecated)</a>
            </h5>
<p id="section-5.2.3.23-1">(1 octet of class, 1 octet of public key algorithm ID, 20 octets of version 4 fingerprint)<a class="pilcrow" href="#section-5.2.3.23-1">¶</a></p>
<p id="section-5.2.3.23-2">This mechanism is deprecated.
Applications <span class="bcp14">MUST NOT</span> generate such a subpacket.<a class="pilcrow" href="#section-5.2.3.23-2">¶</a></p>
<p id="section-5.2.3.23-3">An application that wants the functionality of delegating revocation can use an escrowed Revocation Signature.
See <a class="auto internal xref" href="#escrowed-revocations">Section 13.9</a> for more details.<a class="pilcrow" href="#section-5.2.3.23-3">¶</a></p>
<p id="section-5.2.3.23-4">The remainder of this section describes how some implementations attempt to interpret this deprecated subpacket.<a class="pilcrow" href="#section-5.2.3.23-4">¶</a></p>
<p id="section-5.2.3.23-5">This packet was intended to authorize the specified key to issue Revocation Signatures for this key. The class octet must have bit 0x80 set.
If bit 0x40 is set, it means the revocation information is sensitive.
Other bits are for future expansion to other kinds of authorizations.
This is only found on a Direct Key self-signature (Type ID 0x1F).
The use on other types of self-signatures is unspecified.<a class="pilcrow" href="#section-5.2.3.23-5">¶</a></p>
<p id="section-5.2.3.23-6">If the "sensitive" flag is set, the keyholder feels this subpacket contains private trust information that describes a real-world sensitive relationship.
If this flag is set, implementations <span class="bcp14">SHOULD NOT</span> export this signature to other users except in cases where the data needs to be available, i.e., when the signature is being sent to the designated revoker or when it is accompanied by a Revocation Signature from that revoker.
Note that it may be appropriate to isolate this subpacket within a separate signature so that it is not combined with other subpackets that need to be exported.<a class="pilcrow" href="#section-5.2.3.23-6">¶</a></p>
</section>
</div>
<div id="notation-data">
<section id="section-5.2.3.24">
            <h5 id="name-notation-data">
<a class="section-number selfRef" href="#section-5.2.3.24">5.2.3.24. </a><a class="section-name selfRef" href="#name-notation-data">Notation Data</a>
            </h5>
<p id="section-5.2.3.24-1">(4 octets of flags, 2 octets of name length (M), 2 octets of value length (N), M octets of name data, N octets of value data)<a class="pilcrow" href="#section-5.2.3.24-1">¶</a></p>
<p id="section-5.2.3.24-2">This subpacket describes a "notation" on the signature that the issuer wishes to make.
The notation has a name and a value, each of which are strings of octets.
There may be more than one notation in a signature.
Notations can be used for any extension the issuer of the signature cares to make.
The "flags" field holds 4 octets of flags.<a class="pilcrow" href="#section-5.2.3.24-2">¶</a></p>
<p id="section-5.2.3.24-3">All undefined flags <span class="bcp14">MUST</span> be zero.
Defined flags are as follows:<a class="pilcrow" href="#section-5.2.3.24-3">¶</a></p>
<span id="name-openpgp-signature-notation-"></span><div id="sig-note-data-note-flags-registry">
<table class="center" id="table-6">
              <caption>
<a class="selfRef" href="#table-6">Table 6</a>:
<a class="selfRef" href="#name-openpgp-signature-notation-">OpenPGP Signature Notation Data Subpacket Notation Flags Registry</a>
              </caption>
<thead>
                <tr>
                  <th class="text-left" colspan="1" rowspan="1">Flag Position</th>
                  <th class="text-left" colspan="1" rowspan="1">Shorthand</th>
                  <th class="text-left" colspan="1" rowspan="1">Description</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">0x80000000 (first bit of the first octet)</td>
                  <td class="text-left" colspan="1" rowspan="1">human-readable</td>
                  <td class="text-left" colspan="1" rowspan="1">Notation value is UTF-8 text</td>
                </tr>
              </tbody>
            </table>
</div>
<p id="section-5.2.3.24-5">Notation names are arbitrary strings encoded in UTF-8.
They reside in two namespaces: the IETF namespace and the user namespace.<a class="pilcrow" href="#section-5.2.3.24-5">¶</a></p>
<p id="section-5.2.3.24-6">The IETF namespace is registered with IANA.
These names <span class="bcp14">MUST NOT</span> contain the "@" character (0x40).
This is a tag for the user namespace.<a class="pilcrow" href="#section-5.2.3.24-6">¶</a></p>
<span id="name-openpgp-signature-notation-d"></span><div id="sig-note-data-subpacket-types">
<table class="center" id="table-7">
              <caption>
<a class="selfRef" href="#table-7">Table 7</a>:
<a class="selfRef" href="#name-openpgp-signature-notation-d">OpenPGP Signature Notation Data Subpacket Types Registry</a>
              </caption>
<thead>
                <tr>
                  <th class="text-left" colspan="1" rowspan="1">Notation Name</th>
                  <th class="text-left" colspan="1" rowspan="1">Data Type</th>
                  <th class="text-left" colspan="1" rowspan="1">Allowed Values</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <th class="text-left" colspan="3" rowspan="1">No registrations at this time.</th>
                </tr>
              </tbody>
            </table>
</div>
<p id="section-5.2.3.24-8">This registry is initially empty.<a class="pilcrow" href="#section-5.2.3.24-8">¶</a></p>
<p id="section-5.2.3.24-9">Names in the user namespace consist of a UTF-8 string tag followed by "@", followed by a DNS domain name.
Note that the tag <span class="bcp14">MUST NOT</span> contain an "@" character.
For example, the "sample" tag used by Example Corporation could be "sample@example.com".<a class="pilcrow" href="#section-5.2.3.24-9">¶</a></p>
<p id="section-5.2.3.24-10">Names in a user space are owned and controlled by the owners of that domain.
Obviously, it's bad form to create a new name in a DNS space that you don't own.<a class="pilcrow" href="#section-5.2.3.24-10">¶</a></p>
<p id="section-5.2.3.24-11">Since the user namespace is in the form of an email address, implementers <span class="bcp14">MAY</span> wish to arrange for that address to reach a person who can be consulted about the use of the named tag.
Note that due to UTF-8 encoding, not all valid user space name tags are valid email addresses.<a class="pilcrow" href="#section-5.2.3.24-11">¶</a></p>
<p id="section-5.2.3.24-12">If there is a critical notation, the criticality applies to that specific notation and not to notations in general.<a class="pilcrow" href="#section-5.2.3.24-12">¶</a></p>
</section>
</div>
<div id="key-server-preferences">
<section id="section-5.2.3.25">
            <h5 id="name-key-server-preferences">
<a class="section-number selfRef" href="#section-5.2.3.25">5.2.3.25. </a><a class="section-name selfRef" href="#name-key-server-preferences">Key Server Preferences</a>
            </h5>
<p id="section-5.2.3.25-1">(N octets of flags)<a class="pilcrow" href="#section-5.2.3.25-1">¶</a></p>
<p id="section-5.2.3.25-2">This is a list of 1-bit flags that indicates preferences that the keyholder has about how the key is handled on a key server.
All undefined flags <span class="bcp14">MUST</span> be zero.<a class="pilcrow" href="#section-5.2.3.25-2">¶</a></p>
<span id="name-openpgp-key-server-preferen"></span><div id="key-server-preference-flags-registry">
<table class="center" id="table-8">
              <caption>
<a class="selfRef" href="#table-8">Table 8</a>:
<a class="selfRef" href="#name-openpgp-key-server-preferen">OpenPGP Key Server Preference Flags Registry</a>
              </caption>
<thead>
                <tr>
                  <th class="text-left" colspan="1" rowspan="1">Flag</th>
                  <th class="text-left" colspan="1" rowspan="1">Shorthand</th>
                  <th class="text-left" colspan="1" rowspan="1">Definition</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">0x80...</td>
                  <td class="text-left" colspan="1" rowspan="1">No-modify</td>
                  <td class="text-left" colspan="1" rowspan="1">The keyholder requests that this key only be modified or updated by the keyholder or an administrator of the key server.</td>
                </tr>
              </tbody>
            </table>
</div>
<p id="section-5.2.3.25-4">This is found only on a self-signature.<a class="pilcrow" href="#section-5.2.3.25-4">¶</a></p>
</section>
</div>
<div id="preferred-key-server-subpacket">
<section id="section-5.2.3.26">
            <h5 id="name-preferred-key-server">
<a class="section-number selfRef" href="#section-5.2.3.26">5.2.3.26. </a><a class="section-name selfRef" href="#name-preferred-key-server">Preferred Key Server</a>
            </h5>
<p id="section-5.2.3.26-1">(String)<a class="pilcrow" href="#section-5.2.3.26-1">¶</a></p>
<p id="section-5.2.3.26-2">This is a URI of a key server that the keyholder prefers be used for updates.
Note that keys with multiple User IDs can have a Preferred Key Server for each User ID.
Note also that since this is a URI, the key server can actually be a copy of the key retrieved by https, ftp, http, etc.<a class="pilcrow" href="#section-5.2.3.26-2">¶</a></p>
</section>
</div>
<div id="primary-user-id-subpacket">
<section id="section-5.2.3.27">
            <h5 id="name-primary-user-id">
<a class="section-number selfRef" href="#section-5.2.3.27">5.2.3.27. </a><a class="section-name selfRef" href="#name-primary-user-id">Primary User ID</a>
            </h5>
<p id="section-5.2.3.27-1">(1 octet, Boolean)<a class="pilcrow" href="#section-5.2.3.27-1">¶</a></p>
<p id="section-5.2.3.27-2">This is a flag in a User ID's self-signature that states whether this User ID is the main User ID for this key.
It is reasonable for an implementation to resolve ambiguities in preferences, for example, by referring to the Primary User ID.
If this flag is absent, its value is zero.
If more than one User ID in a key is marked as primary, the implementation may resolve the ambiguity in any way it sees fit, but it is <span class="bcp14">RECOMMENDED</span> that priority be given to the User ID with the most recent self-signature.<a class="pilcrow" href="#section-5.2.3.27-2">¶</a></p>
<p id="section-5.2.3.27-3">When appearing on a self-signature on a User ID packet, this subpacket applies only to User ID packets.
When appearing on a self-signature on a User Attribute packet, this subpacket applies only to User Attribute packets. That is, there are two different and independent "primaries" -- one for User IDs and one for User Attributes.<a class="pilcrow" href="#section-5.2.3.27-3">¶</a></p>
</section>
</div>
<div id="policy-uri-subpacket">
<section id="section-5.2.3.28">
            <h5 id="name-policy-uri">
<a class="section-number selfRef" href="#section-5.2.3.28">5.2.3.28. </a><a class="section-name selfRef" href="#name-policy-uri">Policy URI</a>
            </h5>
<p id="section-5.2.3.28-1">(String)<a class="pilcrow" href="#section-5.2.3.28-1">¶</a></p>
<p id="section-5.2.3.28-2">This subpacket contains a URI of a document that describes the policy under which the signature was issued.<a class="pilcrow" href="#section-5.2.3.28-2">¶</a></p>
</section>
</div>
<div id="key-flags">
<section id="section-5.2.3.29">
            <h5 id="name-key-flags">
<a class="section-number selfRef" href="#section-5.2.3.29">5.2.3.29. </a><a class="section-name selfRef" href="#name-key-flags">Key Flags</a>
            </h5>
<p id="section-5.2.3.29-1">(N octets of flags)<a class="pilcrow" href="#section-5.2.3.29-1">¶</a></p>
<p id="section-5.2.3.29-2">This subpacket contains a list of binary flags that hold information about a key.
It is a string of octets, and an implementation <span class="bcp14">MUST NOT</span> assume a fixed size, so that it can grow over time. If a list is shorter than an implementation expects, the unstated flags are considered to be zero. The defined flags are as follows:<a class="pilcrow" href="#section-5.2.3.29-2">¶</a></p>
<span id="name-openpgp-key-flags-registry"></span><div id="key-flags-registry">
<table class="center" id="table-9">
              <caption>
<a class="selfRef" href="#table-9">Table 9</a>:
<a class="selfRef" href="#name-openpgp-key-flags-registry">OpenPGP Key Flags Registry</a>
              </caption>
<thead>
                <tr>
                  <th class="text-left" colspan="1" rowspan="1">Flag</th>
                  <th class="text-left" colspan="1" rowspan="1">Definition</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">0x01...</td>
                  <td class="text-left" colspan="1" rowspan="1">This key may be used to make User ID certifications (Signature Type IDs 0x10-0x13) or Direct Key signatures (Signature Type ID 0x1F) over other keys.</td>
                </tr>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">0x02...</td>
                  <td class="text-left" colspan="1" rowspan="1">This key may be used to sign data.</td>
                </tr>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">0x04...</td>
                  <td class="text-left" colspan="1" rowspan="1">This key may be used to encrypt communications.</td>
                </tr>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">0x08...</td>
                  <td class="text-left" colspan="1" rowspan="1">This key may be used to encrypt storage.</td>
                </tr>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">0x10...</td>
                  <td class="text-left" colspan="1" rowspan="1">The private component of this key may have been split by a secret-sharing mechanism.</td>
                </tr>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">0x20...</td>
                  <td class="text-left" colspan="1" rowspan="1">This key may be used for authentication.</td>
                </tr>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">0x80...</td>
                  <td class="text-left" colspan="1" rowspan="1">The private component of this key may be in the possession of more than one person.</td>
                </tr>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">0x0004...</td>
                  <td class="text-left" colspan="1" rowspan="1">Reserved (ADSK)</td>
                </tr>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">0x0008...</td>
                  <td class="text-left" colspan="1" rowspan="1">Reserved (timestamping)</td>
                </tr>
              </tbody>
            </table>
</div>
<p id="section-5.2.3.29-4">Usage notes:<a class="pilcrow" href="#section-5.2.3.29-4">¶</a></p>
<p id="section-5.2.3.29-5">The flags in this packet may appear in self-signatures or in certification signatures. They mean different things depending on who is making the statement. For example, a certification signature that has the "sign data" flag is stating that the certification is for that use. On the other hand, the "communications encryption" flag in a self-signature is stating a preference that a given key be used for communications. However, note that determining what is "communications" and what is "storage" is a thorny issue. This decision is left wholly up to the implementation; the authors of this document do not claim any special wisdom on the issue and realize that accepted opinion may change.<a class="pilcrow" href="#section-5.2.3.29-5">¶</a></p>
<p id="section-5.2.3.29-6">The "split key" (0x10) and "group key" (0x80) flags are placed on a self-signature only; they are meaningless on a certification signature.
They <span class="bcp14">SHOULD</span> be placed only on a Direct Key signature (Type ID 0x1F) or a Subkey Binding signature (Type ID 0x18), one that refers to the key the flag applies to.<a class="pilcrow" href="#section-5.2.3.29-6">¶</a></p>
<p id="section-5.2.3.29-7">When an implementation generates this subpacket, it <span class="bcp14">SHOULD</span> be marked as critical.<a class="pilcrow" href="#section-5.2.3.29-7">¶</a></p>
</section>
</div>
<div id="signers-user-id-subpacket">
<section id="section-5.2.3.30">
            <h5 id="name-signers-user-id">
<a class="section-number selfRef" href="#section-5.2.3.30">5.2.3.30. </a><a class="section-name selfRef" href="#name-signers-user-id">Signer's User ID</a>
            </h5>
<p id="section-5.2.3.30-1">(String)<a class="pilcrow" href="#section-5.2.3.30-1">¶</a></p>
<p id="section-5.2.3.30-2">This subpacket allows a keyholder to state which User ID is responsible for the signing.
Many keyholders use a single key for different purposes, such as business communications as well as personal communications.
This subpacket allows such a keyholder to state which of their roles is making a signature.<a class="pilcrow" href="#section-5.2.3.30-2">¶</a></p>
<p id="section-5.2.3.30-3">This subpacket is not appropriate to use to refer to a User Attribute packet.<a class="pilcrow" href="#section-5.2.3.30-3">¶</a></p>
</section>
</div>
<div id="reason-for-revocation">
<section id="section-5.2.3.31">
            <h5 id="name-reason-for-revocation">
<a class="section-number selfRef" href="#section-5.2.3.31">5.2.3.31. </a><a class="section-name selfRef" href="#name-reason-for-revocation">Reason for Revocation</a>
            </h5>
<p id="section-5.2.3.31-1">(1 octet of revocation code, N octets of reason string)<a class="pilcrow" href="#section-5.2.3.31-1">¶</a></p>
<p id="section-5.2.3.31-2">This subpacket is used only in Key Revocation and Certification Revocation signatures.
It describes the reason why the key or certification was revoked.<a class="pilcrow" href="#section-5.2.3.31-2">¶</a></p>
<p id="section-5.2.3.31-3">The first octet contains a machine-readable code that denotes the reason for the revocation:<a class="pilcrow" href="#section-5.2.3.31-3">¶</a></p>
<span id="name-openpgp-reason-for-revocati"></span><div id="reason-for-revocation-code-registry">
<table class="center" id="table-10">
              <caption>
<a class="selfRef" href="#table-10">Table 10</a>:
<a class="selfRef" href="#name-openpgp-reason-for-revocati">OpenPGP Reason for Revocation (Revocation Octet) Registry</a>
              </caption>
<thead>
                <tr>
                  <th class="text-right" colspan="1" rowspan="1">Code</th>
                  <th class="text-left" colspan="1" rowspan="1">Reason</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-right" colspan="1" rowspan="1">0</td>
                  <td class="text-left" colspan="1" rowspan="1">No reason specified (Key Revocation or Certification Revocation signatures)</td>
                </tr>
                <tr>
                  <td class="text-right" colspan="1" rowspan="1">1</td>
                  <td class="text-left" colspan="1" rowspan="1">Key is superseded (Key Revocation signatures)</td>
                </tr>
                <tr>
                  <td class="text-right" colspan="1" rowspan="1">2</td>
                  <td class="text-left" colspan="1" rowspan="1">Key material has been compromised (Key Revocation signatures)</td>
                </tr>
                <tr>
                  <td class="text-right" colspan="1" rowspan="1">3</td>
                  <td class="text-left" colspan="1" rowspan="1">Key is retired and no longer used (Key Revocation signatures)</td>
                </tr>
                <tr>
                  <td class="text-right" colspan="1" rowspan="1">32</td>
                  <td class="text-left" colspan="1" rowspan="1">User ID information is no longer valid (Certification Revocation signatures)</td>
                </tr>
                <tr>
                  <td class="text-right" colspan="1" rowspan="1">100-110</td>
                  <td class="text-left" colspan="1" rowspan="1">Private Use</td>
                </tr>
              </tbody>
            </table>
</div>
<p id="section-5.2.3.31-5">Following the revocation code is a string of octets that gives information about the Reason for Revocation in human-readable form (UTF-8).
The string may be null (of zero length).
The length of the subpacket is the length of the reason string plus one.
An implementation <span class="bcp14">SHOULD</span> implement this subpacket, include it in all Revocation Signatures, and interpret revocations appropriately.
There are important semantic differences between the reasons, and there are thus important reasons for revoking signatures.<a class="pilcrow" href="#section-5.2.3.31-5">¶</a></p>
<p id="section-5.2.3.31-6">If a key has been revoked because of a compromise, all signatures created by that key are suspect. However, if it was merely superseded or retired, old signatures are still valid. If the revoked signature is the self-signature for certifying a User ID, a revocation denotes that that user name is no longer in use.
Such a signature revocation <span class="bcp14">SHOULD</span> include a Reason for Revocation subpacket containing code 32.<a class="pilcrow" href="#section-5.2.3.31-6">¶</a></p>
<p id="section-5.2.3.31-7">Note that any certification may be revoked, including a certification on some other person's key. There are many good reasons for revoking a certification signature, such as the case where the keyholder leaves the employ of a business with an email address. A revoked certification is no longer a part of validity calculations.<a class="pilcrow" href="#section-5.2.3.31-7">¶</a></p>
</section>
</div>
<div id="features-subpacket">
<section id="section-5.2.3.32">
            <h5 id="name-features">
<a class="section-number selfRef" href="#section-5.2.3.32">5.2.3.32. </a><a class="section-name selfRef" href="#name-features">Features</a>
            </h5>
<p id="section-5.2.3.32-1">(N octets of flags)<a class="pilcrow" href="#section-5.2.3.32-1">¶</a></p>
<p id="section-5.2.3.32-2">The Features subpacket denotes which advanced OpenPGP features a user's implementation supports. This is so that as features are added to OpenPGP that cannot be backward compatible, a user can state that they can use that feature. The flags are single bits that indicate that a given feature is supported.<a class="pilcrow" href="#section-5.2.3.32-2">¶</a></p>
<p id="section-5.2.3.32-3">This subpacket is similar to a preferences subpacket and only appears in a self-signature.<a class="pilcrow" href="#section-5.2.3.32-3">¶</a></p>
<p id="section-5.2.3.32-4">An implementation <span class="bcp14">SHOULD NOT</span> use a feature listed when sending to a user who does not state that they can use it, unless the implementation can infer support for the feature from another implementation-dependent mechanism.<a class="pilcrow" href="#section-5.2.3.32-4">¶</a></p>
<p id="section-5.2.3.32-5">Defined features are as follows:<a class="pilcrow" href="#section-5.2.3.32-5">¶</a></p>
<p id="section-5.2.3.32-6">First octet:<a class="pilcrow" href="#section-5.2.3.32-6">¶</a></p>
<span id="name-openpgp-features-flags-regi"></span><div id="features-flags-registry">
<table class="center" id="table-11">
              <caption>
<a class="selfRef" href="#table-11">Table 11</a>:
<a class="selfRef" href="#name-openpgp-features-flags-regi">OpenPGP Features Flags Registry</a>
              </caption>
<thead>
                <tr>
                  <th class="text-left" colspan="1" rowspan="1">Feature</th>
                  <th class="text-left" colspan="1" rowspan="1">Definition</th>
                  <th class="text-left" colspan="1" rowspan="1">Reference</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">0x01...</td>
                  <td class="text-left" colspan="1" rowspan="1">Version 1 Symmetrically Encrypted and Integrity Protected Data packet</td>
                  <td class="text-left" colspan="1" rowspan="1">
                    <a class="auto internal xref" href="#version-one-seipd">Section 5.13.1</a>
</td>
                </tr>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">0x02...</td>
                  <td class="text-left" colspan="1" rowspan="1">Reserved</td>
                  <td class="text-left" colspan="1" rowspan="1"></td>
                </tr>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">0x04...</td>
                  <td class="text-left" colspan="1" rowspan="1">Reserved</td>
                  <td class="text-left" colspan="1" rowspan="1"></td>
                </tr>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">0x08...</td>
                  <td class="text-left" colspan="1" rowspan="1">Version 2 Symmetrically Encrypted and Integrity Protected Data packet</td>
                  <td class="text-left" colspan="1" rowspan="1">
                    <a class="auto internal xref" href="#version-two-seipd">Section 5.13.2</a>
</td>
                </tr>
              </tbody>
            </table>
</div>
<p id="section-5.2.3.32-8">If an implementation implements any of the defined features, it <span class="bcp14">SHOULD</span> implement the Features subpacket, too.<a class="pilcrow" href="#section-5.2.3.32-8">¶</a></p>
<p id="section-5.2.3.32-9">See <a class="auto internal xref" href="#ciphertext-malleability">Section 13.7</a> for details about how to use the Features subpacket when generating encryption data.<a class="pilcrow" href="#section-5.2.3.32-9">¶</a></p>
</section>
</div>
<div id="signature-target-subpacket">
<section id="section-5.2.3.33">
            <h5 id="name-signature-target">
<a class="section-number selfRef" href="#section-5.2.3.33">5.2.3.33. </a><a class="section-name selfRef" href="#name-signature-target">Signature Target</a>
            </h5>
<p id="section-5.2.3.33-1">(1 octet public key algorithm, 1 octet hash algorithm, N octets hash)<a class="pilcrow" href="#section-5.2.3.33-1">¶</a></p>
<p id="section-5.2.3.33-2">This subpacket identifies a specific target signature to which a signature refers.
For Revocation Signatures, this subpacket provides explicit designation of which signature is being revoked. For a Third-Party Confirmation or Timestamp signature, this designates what signature is signed.
All arguments are an identifier of that target signature.<a class="pilcrow" href="#section-5.2.3.33-2">¶</a></p>
<p id="section-5.2.3.33-3">The N octets of hash data <span class="bcp14">MUST</span> be the size of the signature's hash. For example, a target signature with a SHA-1 hash <span class="bcp14">MUST</span> have 20 octets of hash data.<a class="pilcrow" href="#section-5.2.3.33-3">¶</a></p>
</section>
</div>
<div id="embedded-signature-subpacket">
<section id="section-5.2.3.34">
            <h5 id="name-embedded-signature">
<a class="section-number selfRef" href="#section-5.2.3.34">5.2.3.34. </a><a class="section-name selfRef" href="#name-embedded-signature">Embedded Signature</a>
            </h5>
<p id="section-5.2.3.34-1">(1 Signature packet body)<a class="pilcrow" href="#section-5.2.3.34-1">¶</a></p>
<p id="section-5.2.3.34-2">This subpacket contains a complete Signature packet body as specified in <a class="auto internal xref" href="#signature-packet">Section 5.2</a>.
It is useful when one signature needs to refer to, or be incorporated in, another signature.<a class="pilcrow" href="#section-5.2.3.34-2">¶</a></p>
</section>
</div>
<div id="issuer-fingerprint-subpacket">
<section id="section-5.2.3.35">
            <h5 id="name-issuer-fingerprint">
<a class="section-number selfRef" href="#section-5.2.3.35">5.2.3.35. </a><a class="section-name selfRef" href="#name-issuer-fingerprint">Issuer Fingerprint</a>
            </h5>
<p id="section-5.2.3.35-1">(1 octet key version number, N octets of fingerprint)<a class="pilcrow" href="#section-5.2.3.35-1">¶</a></p>
<p id="section-5.2.3.35-2">The OpenPGP Key fingerprint of the key issuing the signature.
This subpacket <span class="bcp14">SHOULD</span> be included in all signatures.
If the version of the issuing key is 4 and an Issuer Key ID subpacket (<a class="auto internal xref" href="#issuer-keyid-subpacket">Section 5.2.3.12</a>) is also included in the signature, the Key ID of the Issuer Key ID subpacket <span class="bcp14">MUST</span> match the low 64 bits of the fingerprint.<a class="pilcrow" href="#section-5.2.3.35-2">¶</a></p>
<p id="section-5.2.3.35-3">Note that the length N of the fingerprint for a version 4 key is 20 octets; for a version 6 key, N is 32.
Since the version of the signature is bound to the version of the key, the version octet here <span class="bcp14">MUST</span> match the version of the signature.
If the version octet does not match the signature version, the receiving implementation <span class="bcp14">MUST</span> treat it as a malformed signature (see <a class="auto internal xref" href="#malformed-signatures">Section 5.2.5</a>).<a class="pilcrow" href="#section-5.2.3.35-3">¶</a></p>
</section>
</div>
<div id="intended-recipient-fingerprint">
<section id="section-5.2.3.36">
            <h5 id="name-intended-recipient-fingerpr">
<a class="section-number selfRef" href="#section-5.2.3.36">5.2.3.36. </a><a class="section-name selfRef" href="#name-intended-recipient-fingerpr">Intended Recipient Fingerprint</a>
            </h5>
<p id="section-5.2.3.36-1">(1 octet key version number, N octets of fingerprint)<a class="pilcrow" href="#section-5.2.3.36-1">¶</a></p>
<p id="section-5.2.3.36-2">The OpenPGP Key fingerprint of the intended recipient primary key.
If one or more subpackets of this type are included in a signature, it <span class="bcp14">SHOULD</span> be considered valid only in an encrypted context, where the key it was encrypted to is one of the indicated primary keys or one of their subkeys. This can be used to prevent forwarding a signature outside of its intended, encrypted context (see <a class="auto internal xref" href="#surreptitious-forwarding">Section 13.12</a>).<a class="pilcrow" href="#section-5.2.3.36-2">¶</a></p>
<p id="section-5.2.3.36-3">Note that the length N of the fingerprint for a version 4 key is 20 octets; for a version 6 key, N is 32.<a class="pilcrow" href="#section-5.2.3.36-3">¶</a></p>
<p id="section-5.2.3.36-4">An implementation <span class="bcp14">SHOULD</span> generate this subpacket when creating a signed and encrypted message.<a class="pilcrow" href="#section-5.2.3.36-4">¶</a></p>
<p id="section-5.2.3.36-5">When generating this subpacket in a version 6 signature, it <span class="bcp14">SHOULD</span> be marked as critical.<a class="pilcrow" href="#section-5.2.3.36-5">¶</a></p>
</section>
</div>
</section>
</div>
<div id="computing-signatures">
<section id="section-5.2.4">
          <h4 id="name-computing-signatures">
<a class="section-number selfRef" href="#section-5.2.4">5.2.4. </a><a class="section-name selfRef" href="#name-computing-signatures">Computing Signatures</a>
          </h4>
<p id="section-5.2.4-1">All signatures are formed by producing a hash over the signature data and then using the resulting hash in the signature algorithm.<a class="pilcrow" href="#section-5.2.4-1">¶</a></p>
<p id="section-5.2.4-2">When creating or verifying a version 6 signature, the salt is fed into the hash context before any other data.<a class="pilcrow" href="#section-5.2.4-2">¶</a></p>
<p id="section-5.2.4-3">For binary document signatures (Type ID 0x00), the document data is hashed directly.
For text document signatures (Type ID 0x01), the implementation <span class="bcp14">MUST</span> first canonicalize the document by converting line endings to &lt;CR&gt;&lt;LF&gt; and encoding it in UTF-8 (see <span>[<a class="cite xref" href="#RFC3629">RFC3629</a>]</span>).
   The resulting UTF-8 byte stream is hashed.<a class="pilcrow" href="#section-5.2.4-3">¶</a></p>
<p id="section-5.2.4-4">When a version 4 signature is made over a key, the hash data starts with the octet 0x99, followed by a 2-octet length of the key, followed by the body of the key packet.
When a version 6 signature is made over a key, the hash data starts with the salt and then octet 0x9B, followed by a 4-octet length of the key, followed by the body of the key packet.<a class="pilcrow" href="#section-5.2.4-4">¶</a></p>
<p id="section-5.2.4-5">A Subkey Binding signature (Type ID 0x18) or Primary Key Binding signature (Type ID 0x19) then hashes the subkey using the same format as the main key (also using 0x99 or 0x9B as the first octet). Primary Key Revocation signatures (Type ID 0x20) hash only the key being revoked.
A Subkey Revocation signature (Type ID 0x28) first hashes the primary key and then the subkey being revoked.<a class="pilcrow" href="#section-5.2.4-5">¶</a></p>
<p id="section-5.2.4-6">A Certification signature (Type IDs 0x10 through 0x13) hashes the User ID that is bound to the key into the hash context after the above data. A version 3 certification hashes the contents of the User ID or User Attribute packet without the packet header. A version 4 or version 6 certification hashes the constant 0xB4 for User ID certifications or the constant 0xD1 for User Attribute certifications, followed by a 4-octet number giving the length of the User ID or User Attribute data, followed by the User ID or User Attribute data.<a class="pilcrow" href="#section-5.2.4-6">¶</a></p>
<p id="section-5.2.4-7">A Third-Party Confirmation signature (Type ID 0x50) hashes the salt (version 6 signatures only), followed by the octet 0x88, followed by the 4-octet length of the signature, and then the body of the Signature packet. (Note that this is a Legacy packet header for a Signature packet with the length-of-length field set to zero.) The unhashed subpacket data of the Signature packet being hashed is not included in the hash, and the unhashed subpacket data length value is set to zero.<a class="pilcrow" href="#section-5.2.4-7">¶</a></p>
<p id="section-5.2.4-8">Once the data body is hashed, then a trailer is hashed. This trailer depends on the version of the signature.<a class="pilcrow" href="#section-5.2.4-8">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.4-9.1">
              <p id="section-5.2.4-9.1.1">A version 3 signature hashes five octets of the packet body, starting from the signature type field. This data is the signature type, followed by the 4-octet Signature Creation Time.<a class="pilcrow" href="#section-5.2.4-9.1.1">¶</a></p>
</li>
            <li class="normal" id="section-5.2.4-9.2">
              <p id="section-5.2.4-9.2.1">A version 4 or version 6 signature hashes the packet body starting from its first field, the version number, through the end of the hashed subpacket data and a final extra trailer. Thus, the hashed fields are:<a class="pilcrow" href="#section-5.2.4-9.2.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.4-9.2.2.1">
                  <p id="section-5.2.4-9.2.2.1.1">an octet indicating the signature version (0x04 for version 4, and 0x06 for version 6),<a class="pilcrow" href="#section-5.2.4-9.2.2.1.1">¶</a></p>
</li>
                <li class="normal" id="section-5.2.4-9.2.2.2">
                  <p id="section-5.2.4-9.2.2.2.1">the signature type,<a class="pilcrow" href="#section-5.2.4-9.2.2.2.1">¶</a></p>
</li>
                <li class="normal" id="section-5.2.4-9.2.2.3">
                  <p id="section-5.2.4-9.2.2.3.1">the public key algorithm,<a class="pilcrow" href="#section-5.2.4-9.2.2.3.1">¶</a></p>
</li>
                <li class="normal" id="section-5.2.4-9.2.2.4">
                  <p id="section-5.2.4-9.2.2.4.1">the hash algorithm,<a class="pilcrow" href="#section-5.2.4-9.2.2.4.1">¶</a></p>
</li>
                <li class="normal" id="section-5.2.4-9.2.2.5">
                  <p id="section-5.2.4-9.2.2.5.1">the hashed subpacket length,<a class="pilcrow" href="#section-5.2.4-9.2.2.5.1">¶</a></p>
</li>
                <li class="normal" id="section-5.2.4-9.2.2.6">
                  <p id="section-5.2.4-9.2.2.6.1">the hashed subpacket body,<a class="pilcrow" href="#section-5.2.4-9.2.2.6.1">¶</a></p>
</li>
                <li class="normal" id="section-5.2.4-9.2.2.7">
                  <p id="section-5.2.4-9.2.2.7.1">a second version octet (0x04 for version 4, and 0x06 for version 6),<a class="pilcrow" href="#section-5.2.4-9.2.2.7.1">¶</a></p>
</li>
                <li class="normal" id="section-5.2.4-9.2.2.8">
                  <p id="section-5.2.4-9.2.2.8.1">a single octet 0xFF, and<a class="pilcrow" href="#section-5.2.4-9.2.2.8.1">¶</a></p>
</li>
                <li class="normal" id="section-5.2.4-9.2.2.9">
                  <p id="section-5.2.4-9.2.2.9.1">a number representing the length (in octets) of the hashed data from the Signature packet through the hashed subpacket body. This a 4-octet big-endian unsigned integer of the length modulo 2<sup>32</sup>.<a class="pilcrow" href="#section-5.2.4-9.2.2.9.1">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<p id="section-5.2.4-10">After all this has been hashed in a single hash context, the resulting hash field is used in the signature algorithm, and its first two octets are placed in the Signature packet, as described in <a class="auto internal xref" href="#version-four-and-six-sig">Section 5.2.3</a>.<a class="pilcrow" href="#section-5.2.4-10">¶</a></p>
<p id="section-5.2.4-11">For worked examples of the data hashed during a signature, see <a class="auto internal xref" href="#sig-hashed-data-example">Appendix A.3.1</a>.<a class="pilcrow" href="#section-5.2.4-11">¶</a></p>
<div id="sig-computation-notes">
<section id="section-5.2.4.1">
            <h5 id="name-notes-about-signature-compu">
<a class="section-number selfRef" href="#section-5.2.4.1">5.2.4.1. </a><a class="section-name selfRef" href="#name-notes-about-signature-compu">Notes about Signature Computation</a>
            </h5>
<p id="section-5.2.4.1-1">The data actually hashed by OpenPGP varies depending on the signature version, in order to ensure that a signature made using one version cannot be repurposed as a signature with a different version over subtly different data. The hashed data streams differ based on their trailer, most critically in the fifth and sixth octets from the end of the stream.
In particular:<a class="pilcrow" href="#section-5.2.4.1-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.4.1-2.1">
                <p id="section-5.2.4.1-2.1.1">A version 3 signature uses the fifth octet from the end to store its Signature Type ID.
This <span class="bcp14">MUST NOT</span> be Signature Type ID <code>0xFF</code>.<a class="pilcrow" href="#section-5.2.4.1-2.1.1">¶</a></p>
</li>
              <li class="normal" id="section-5.2.4.1-2.2">
                <p id="section-5.2.4.1-2.2.1">All signature versions later than version 3 always use a literal <code>0xFF</code> in the fifth octet from the end.
For these later signature versions, the sixth octet from the end (the octet before the <code>0xFF</code>) stores the signature version number.<a class="pilcrow" href="#section-5.2.4.1-2.2.1">¶</a></p>
</li>
            </ul>
</section>
</div>
</section>
</div>
<div id="malformed-signatures">
<section id="section-5.2.5">
          <h4 id="name-malformed-and-unknown-signa">
<a class="section-number selfRef" href="#section-5.2.5">5.2.5. </a><a class="section-name selfRef" href="#name-malformed-and-unknown-signa">Malformed and Unknown Signatures</a>
          </h4>
<p id="section-5.2.5-1">In some cases, a Signature packet (or its corresponding One-Pass Signature packet; see <a class="auto internal xref" href="#one-pass-sig">Section 5.4</a>) may be malformed or unknown.
For example, it might encounter any of the following problems (this is not an exhaustive list):<a class="pilcrow" href="#section-5.2.5-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.5-2.1">
              <p id="section-5.2.5-2.1.1">An unknown signature type<a class="pilcrow" href="#section-5.2.5-2.1.1">¶</a></p>
</li>
            <li class="normal" id="section-5.2.5-2.2">
              <p id="section-5.2.5-2.2.1">An unknown signature version<a class="pilcrow" href="#section-5.2.5-2.2.1">¶</a></p>
</li>
            <li class="normal" id="section-5.2.5-2.3">
              <p id="section-5.2.5-2.3.1">An unsupported signature version<a class="pilcrow" href="#section-5.2.5-2.3.1">¶</a></p>
</li>
            <li class="normal" id="section-5.2.5-2.4">
              <p id="section-5.2.5-2.4.1">An unknown "critical" subpacket (see <a class="auto internal xref" href="#signature-subpacket">Section 5.2.3.7</a>) in the hashed area<a class="pilcrow" href="#section-5.2.5-2.4.1">¶</a></p>
</li>
            <li class="normal" id="section-5.2.5-2.5">
              <p id="section-5.2.5-2.5.1">A subpacket with a length that diverges from the expected length<a class="pilcrow" href="#section-5.2.5-2.5.1">¶</a></p>
</li>
            <li class="normal" id="section-5.2.5-2.6">
              <p id="section-5.2.5-2.6.1">A hashed subpacket area with length that exceeds the length of the Signature packet itself<a class="pilcrow" href="#section-5.2.5-2.6.1">¶</a></p>
</li>
            <li class="normal" id="section-5.2.5-2.7">
              <p id="section-5.2.5-2.7.1">A hash algorithm known to be weak (e.g., MD5)<a class="pilcrow" href="#section-5.2.5-2.7.1">¶</a></p>
</li>
            <li class="normal" id="section-5.2.5-2.8">
              <p id="section-5.2.5-2.8.1">A mismatch between the expected salt length of the hash algorithm and the actual salt length<a class="pilcrow" href="#section-5.2.5-2.8.1">¶</a></p>
</li>
            <li class="normal" id="section-5.2.5-2.9">
              <p id="section-5.2.5-2.9.1">A mismatch between the One-Pass Signature version and the Signature version (see <a class="auto internal xref" href="#signed-message-versions">Section 10.3.2.2</a>)<a class="pilcrow" href="#section-5.2.5-2.9.1">¶</a></p>
</li>
            <li class="normal" id="section-5.2.5-2.10">
              <p id="section-5.2.5-2.10.1">A signature with a version other than 6, made by a version 6 key<a class="pilcrow" href="#section-5.2.5-2.10.1">¶</a></p>
</li>
          </ul>
<p id="section-5.2.5-3">When an implementation encounters such a malformed or unknown signature, it <span class="bcp14">MUST</span> ignore the signature for validation purposes.
It <span class="bcp14">MUST NOT</span> indicate a successful signature validation for such a signature.
At the same time, it <span class="bcp14">MUST NOT</span> halt processing on the packet stream or reject other signatures in the same packet stream just because an unknown or invalid signature exists.<a class="pilcrow" href="#section-5.2.5-3">¶</a></p>
<p id="section-5.2.5-4">This requirement is necessary for forward compatibility.
Producing an output that indicates that no successful signatures were found is preferable to aborting processing entirely.<a class="pilcrow" href="#section-5.2.5-4">¶</a></p>
</section>
</div>
</section>
</div>
<div id="skesk">
<section id="section-5.3">
        <h3 id="name-symmetric-key-encrypted-ses">
<a class="section-number selfRef" href="#section-5.3">5.3. </a><a class="section-name selfRef" href="#name-symmetric-key-encrypted-ses">Symmetric Key Encrypted Session Key Packet (Type ID 3)</a>
        </h3>
<p id="section-5.3-1">The Symmetric Key Encrypted Session Key (SKESK) packet holds the symmetric key encryption of a session key used to encrypt a message.
Zero or more Public Key Encrypted Session Key packets (<a class="auto internal xref" href="#pkesk">Section 5.1</a>) and/or Symmetric Key Encrypted Session Key packets precede an encryption container (that is, a Symmetrically Encrypted and Integrity Protected Data packet or -- for historic data -- a Symmetrically Encrypted Data packet) that holds an Encrypted Message. The message is encrypted with a session key, and the session key is itself encrypted and stored in the Encrypted Session Key packet(s).<a class="pilcrow" href="#section-5.3-1">¶</a></p>
<p id="section-5.3-2">If the encryption container is preceded by one or more Symmetric Key Encrypted Session Key packets, each specifies a passphrase that may be used to decrypt the message.
This allows a message to be encrypted to a number of public keys, and also to one or more passphrases.<a class="pilcrow" href="#section-5.3-2">¶</a></p>
<p id="section-5.3-3">The body of this packet starts with a 1-octet number giving the version number of the packet type.
The currently defined versions are 4 and 6.
The remainder of the packet depends on the version.<a class="pilcrow" href="#section-5.3-3">¶</a></p>
<p id="section-5.3-4">The versions differ in how they encrypt the session key with the passphrase and in what they encode.
The version of the SKESK packet must align with the version of the SEIPD packet (see <a class="auto internal xref" href="#encrypted-message-versions">Section 10.3.2.1</a>).
Any new version of the SKESK packet should be registered in the registry established in <a class="auto internal xref" href="#encrypted-message-versions">Section 10.3.2.1</a>.<a class="pilcrow" href="#section-5.3-4">¶</a></p>
<div id="v4-skesk">
<section id="section-5.3.1">
          <h4 id="name-version-4-symmetric-key-enc">
<a class="section-number selfRef" href="#section-5.3.1">5.3.1. </a><a class="section-name selfRef" href="#name-version-4-symmetric-key-enc">Version 4 Symmetric Key Encrypted Session Key Packet Format</a>
          </h4>
<p id="section-5.3.1-1">A v4 SKESK packet precedes a v1 SEIPD (see <a class="auto internal xref" href="#version-one-seipd">Section 5.13.1</a>).
In historic data, it is sometimes found preceding a deprecated SED packet (see <a class="auto internal xref" href="#sed">Section 5.7</a>). A v4 SKESK packet <span class="bcp14">MUST NOT</span> precede a v2 SEIPD packet (see <a class="auto internal xref" href="#encrypted-message-versions">Section 10.3.2.1</a>).<a class="pilcrow" href="#section-5.3.1-1">¶</a></p>
<p id="section-5.3.1-2">A version 4 Symmetric Key Encrypted Session Key packet consists of:<a class="pilcrow" href="#section-5.3.1-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3.1-3.1">
              <p id="section-5.3.1-3.1.1">A 1-octet version number with value 4.<a class="pilcrow" href="#section-5.3.1-3.1.1">¶</a></p>
</li>
            <li class="normal" id="section-5.3.1-3.2">
              <p id="section-5.3.1-3.2.1">A 1-octet number describing the symmetric algorithm used.<a class="pilcrow" href="#section-5.3.1-3.2.1">¶</a></p>
</li>
            <li class="normal" id="section-5.3.1-3.3">
              <p id="section-5.3.1-3.3.1">An S2K Specifier. The length of the S2K Specifier depends on its type (see <a class="auto internal xref" href="#s2k-types">Section 3.7.1</a>).<a class="pilcrow" href="#section-5.3.1-3.3.1">¶</a></p>
</li>
            <li class="normal" id="section-5.3.1-3.4">
              <p id="section-5.3.1-3.4.1">Optionally, the encrypted session key itself, which is decrypted with the S2K object.<a class="pilcrow" href="#section-5.3.1-3.4.1">¶</a></p>
</li>
          </ul>
<p id="section-5.3.1-4">If the encrypted session key is not present (which can be detected on the basis of packet length and S2K Specifier size), then the S2K algorithm applied to the passphrase produces the session key for decrypting the message, using the Symmetric Cipher Algorithm ID from the Symmetric Key Encrypted Session Key packet.<a class="pilcrow" href="#section-5.3.1-4">¶</a></p>
<p id="section-5.3.1-5">If the encrypted session key is present, the result of applying the S2K algorithm to the passphrase is used to decrypt just that encrypted session key field, using CFB mode with an IV of all zeros.
The decryption result consists of a 1-octet algorithm identifier that specifies the symmetric key encryption algorithm used to encrypt the following encryption container, followed by the session key octets themselves.<a class="pilcrow" href="#section-5.3.1-5">¶</a></p>
<p id="section-5.3.1-6">Note: because an all-zero IV is used for this decryption, the S2K Specifier <span class="bcp14">MUST</span> use a salt value, a Salted S2K, an Iterated and Salted S2K, or Argon2.
The salt value will ensure that the decryption key is not repeated even if the passphrase is reused.<a class="pilcrow" href="#section-5.3.1-6">¶</a></p>
</section>
</div>
<div id="v6-skesk">
<section id="section-5.3.2">
          <h4 id="name-version-6-symmetric-key-enc">
<a class="section-number selfRef" href="#section-5.3.2">5.3.2. </a><a class="section-name selfRef" href="#name-version-6-symmetric-key-enc">Version 6 Symmetric Key Encrypted Session Key Packet Format</a>
          </h4>
<p id="section-5.3.2-1">A v6 SKESK packet precedes a v2 SEIPD packet (see <a class="auto internal xref" href="#version-two-seipd">Section 5.13.2</a>).
A v6 SKESK packet <span class="bcp14">MUST NOT</span> precede a v1 SEIPD packet or a deprecated Symmetrically Encrypted Data packet (see <a class="auto internal xref" href="#encrypted-message-versions">Section 10.3.2.1</a>).<a class="pilcrow" href="#section-5.3.2-1">¶</a></p>
<p id="section-5.3.2-2">A version 6 Symmetric Key Encrypted Session Key packet consists of:<a class="pilcrow" href="#section-5.3.2-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3.2-3.1">
              <p id="section-5.3.2-3.1.1">A 1-octet version number with value 6.<a class="pilcrow" href="#section-5.3.2-3.1.1">¶</a></p>
</li>
            <li class="normal" id="section-5.3.2-3.2">
              <p id="section-5.3.2-3.2.1">A 1-octet scalar octet count for the 5 fields following this octet.<a class="pilcrow" href="#section-5.3.2-3.2.1">¶</a></p>
</li>
            <li class="normal" id="section-5.3.2-3.3">
              <p id="section-5.3.2-3.3.1">A 1-octet Symmetric Cipher Algorithm ID (from <a class="auto internal xref" href="#symkey-algorithms-registry">Table 21</a>).<a class="pilcrow" href="#section-5.3.2-3.3.1">¶</a></p>
</li>
            <li class="normal" id="section-5.3.2-3.4">
              <p id="section-5.3.2-3.4.1">A 1-octet AEAD algorithm identifier (from <a class="auto internal xref" href="#aead-algorithms-registry">Table 25</a>).<a class="pilcrow" href="#section-5.3.2-3.4.1">¶</a></p>
</li>
            <li class="normal" id="section-5.3.2-3.5">
              <p id="section-5.3.2-3.5.1">A 1-octet scalar octet count of the following field.<a class="pilcrow" href="#section-5.3.2-3.5.1">¶</a></p>
</li>
            <li class="normal" id="section-5.3.2-3.6">
              <p id="section-5.3.2-3.6.1">An S2K Specifier. The length of the S2K Specifier depends on its type (see <a class="auto internal xref" href="#s2k-types">Section 3.7.1</a>).<a class="pilcrow" href="#section-5.3.2-3.6.1">¶</a></p>
</li>
            <li class="normal" id="section-5.3.2-3.7">
              <p id="section-5.3.2-3.7.1">A starting IV of the size specified by the AEAD algorithm.<a class="pilcrow" href="#section-5.3.2-3.7.1">¶</a></p>
</li>
            <li class="normal" id="section-5.3.2-3.8">
              <p id="section-5.3.2-3.8.1">The encrypted session key itself.<a class="pilcrow" href="#section-5.3.2-3.8.1">¶</a></p>
</li>
            <li class="normal" id="section-5.3.2-3.9">
              <p id="section-5.3.2-3.9.1">An authentication tag for the AEAD mode.<a class="pilcrow" href="#section-5.3.2-3.9.1">¶</a></p>
</li>
          </ul>
<p id="section-5.3.2-4">A key-encryption key (KEK) is derived using HKDF <span>[<a class="cite xref" href="#RFC5869">RFC5869</a>]</span> with SHA256 <span>[<a class="cite xref" href="#RFC6234">RFC6234</a>]</span> as the hash algorithm.
The Initial Keying Material (IKM) for HKDF is the key derived from S2K.
No salt is used. The info parameter is comprised of the Packet Type ID in OpenPGP format encoding (bits 7 and 6 are set, and bits 5-0 carry the Packet Type ID), the packet version, and the cipher-algo and AEAD-mode used to encrypt the key material.<a class="pilcrow" href="#section-5.3.2-4">¶</a></p>
<p id="section-5.3.2-5">Then, the session key is encrypted using the resulting key, with the AEAD algorithm specified for the version 2 Symmetrically Encrypted and Integrity Protected Data packet.
Note that no chunks are used and that there is only one authentication tag.
The Packet Type ID encoded in OpenPGP format (bits 7 and 6 are set, and bits 5-0 carry the Packet Type ID), the packet version number, the cipher algorithm ID, and the AEAD algorithm ID are given as additional data.
For example, the additional data used with AES-128 with OCB consists of the octets 0xC3, 0x06, 0x07, and 0x02.<a class="pilcrow" href="#section-5.3.2-5">¶</a></p>
</section>
</div>
</section>
</div>
<div id="one-pass-sig">
<section id="section-5.4">
        <h3 id="name-one-pass-signature-packet-t">
<a class="section-number selfRef" href="#section-5.4">5.4. </a><a class="section-name selfRef" href="#name-one-pass-signature-packet-t">One-Pass Signature Packet (Type ID 4)</a>
        </h3>
<p id="section-5.4-1">The One-Pass Signature packet precedes the signed data and contains enough information to allow the receiver to begin calculating any hashes needed to verify the signature.
It allows the Signature packet to be placed at the end of the message so that the signer can compute the entire signed message in one pass.<a class="pilcrow" href="#section-5.4-1">¶</a></p>
<p id="section-5.4-2">The body of this packet consists of:<a class="pilcrow" href="#section-5.4-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.4-3.1">
            <p id="section-5.4-3.1.1">A 1-octet version number.
The currently defined versions are 3 and 6.
Any new One-Pass Signature packet version should be registered in the registry established in <a class="auto internal xref" href="#signed-message-versions">Section 10.3.2.2</a>.<a class="pilcrow" href="#section-5.4-3.1.1">¶</a></p>
</li>
          <li class="normal" id="section-5.4-3.2">
            <p id="section-5.4-3.2.1">A 1-octet Signature Type ID.
Signature types are described in <a class="auto internal xref" href="#signature-types">Section 5.2.1</a>.<a class="pilcrow" href="#section-5.4-3.2.1">¶</a></p>
</li>
          <li class="normal" id="section-5.4-3.3">
            <p id="section-5.4-3.3.1">A 1-octet number describing the hash algorithm used.<a class="pilcrow" href="#section-5.4-3.3.1">¶</a></p>
</li>
          <li class="normal" id="section-5.4-3.4">
            <p id="section-5.4-3.4.1">A 1-octet number describing the public key algorithm used.<a class="pilcrow" href="#section-5.4-3.4.1">¶</a></p>
</li>
          <li class="normal" id="section-5.4-3.5">
            <p id="section-5.4-3.5.1">Only for version 6 packets, a variable-length field containing:<a class="pilcrow" href="#section-5.4-3.5.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.4-3.5.2.1">
                <p id="section-5.4-3.5.2.1.1">A 1-octet salt size. The value <span class="bcp14">MUST</span> match the value defined for the hash algorithm as specified in <a class="auto internal xref" href="#hash-algorithms-registry">Table 23</a>.<a class="pilcrow" href="#section-5.4-3.5.2.1.1">¶</a></p>
</li>
              <li class="normal" id="section-5.4-3.5.2.2">
                <p id="section-5.4-3.5.2.2.1">The salt; a random value of the specified size. The value <span class="bcp14">MUST</span> match the salt field of the corresponding Signature packet.<a class="pilcrow" href="#section-5.4-3.5.2.2.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-5.4-3.6">
            <p id="section-5.4-3.6.1">Only for v3 packets, an 8-octet number holding the Key ID of the signing key.<a class="pilcrow" href="#section-5.4-3.6.1">¶</a></p>
</li>
          <li class="normal" id="section-5.4-3.7">
            <p id="section-5.4-3.7.1">Only for version 6 packets, 32 octets of the fingerprint of the signing key.
Since a version 6 signature can only be made by a version 6 key, the length of the fingerprint is fixed.<a class="pilcrow" href="#section-5.4-3.7.1">¶</a></p>
</li>
          <li class="normal" id="section-5.4-3.8">
            <p id="section-5.4-3.8.1">A 1-octet number holding a flag showing whether the signature is nested.
A zero value indicates that the next packet is another One-Pass Signature packet that describes another signature to be applied to the same message data.<a class="pilcrow" href="#section-5.4-3.8.1">¶</a></p>
</li>
        </ul>
<p id="section-5.4-4">When generating a one-pass signature, the OPS packet version <span class="bcp14">MUST</span> correspond to the version of the associated Signature packet, except for the historical accident that version 4 keys use a version 3 One-Pass Signature packet (there is no version 4 OPS).
See <a class="auto internal xref" href="#signed-message-versions">Section 10.3.2.2</a> for the full correspondence of versions between Keys, Signatures, and One-Pass Signatures.<a class="pilcrow" href="#section-5.4-4">¶</a></p>
<p id="section-5.4-5">Note that if a message contains more than one one-pass signature, then the Signature packets bracket the message; that is, the first Signature packet after the message corresponds to the last One-Pass Signature packet and the final Signature packet corresponds to the first One-Pass Signature packet.<a class="pilcrow" href="#section-5.4-5">¶</a></p>
</section>
</div>
<div id="key-material-packets">
<section id="section-5.5">
        <h3 id="name-key-material-packets">
<a class="section-number selfRef" href="#section-5.5">5.5. </a><a class="section-name selfRef" href="#name-key-material-packets">Key Material Packets</a>
        </h3>
<p id="section-5.5-1">A key material packet contains all the information about a public or private key.
There are four variants of this packet type: two major versions (versions 4 and 6) and two strongly deprecated versions (versions 2 and 3). Consequently, this section is complex.<a class="pilcrow" href="#section-5.5-1">¶</a></p>
<p id="section-5.5-2">For historical reasons, versions 1 and 5 of the key packets are unspecified.<a class="pilcrow" href="#section-5.5-2">¶</a></p>
<div id="key-packet-variants">
<section id="section-5.5.1">
          <h4 id="name-key-packet-variants">
<a class="section-number selfRef" href="#section-5.5.1">5.5.1. </a><a class="section-name selfRef" href="#name-key-packet-variants">Key Packet Variants</a>
          </h4>
<div id="pubkey">
<section id="section-5.5.1.1">
            <h5 id="name-public-key-packet-type-id-6">
<a class="section-number selfRef" href="#section-5.5.1.1">5.5.1.1. </a><a class="section-name selfRef" href="#name-public-key-packet-type-id-6">Public Key Packet (Type ID 6)</a>
            </h5>
<p id="section-5.5.1.1-1">A Public Key packet starts a series of packets that forms an OpenPGP Key (sometimes called an OpenPGP certificate).<a class="pilcrow" href="#section-5.5.1.1-1">¶</a></p>
</section>
</div>
<div id="pubsubkey">
<section id="section-5.5.1.2">
            <h5 id="name-public-subkey-packet-type-i">
<a class="section-number selfRef" href="#section-5.5.1.2">5.5.1.2. </a><a class="section-name selfRef" href="#name-public-subkey-packet-type-i">Public Subkey Packet (Type ID 14)</a>
            </h5>
<p id="section-5.5.1.2-1">A Public Subkey packet (Type ID 14) has exactly the same format as a Public Key packet, but it denotes a subkey. One or more subkeys may be associated with a top-level key.
By convention, the top-level key offers certification capability, but it does not provide encryption services, while a dedicated subkey provides encryption (see <a class="auto internal xref" href="#common-requirements">Section 10.1.5</a>).<a class="pilcrow" href="#section-5.5.1.2-1">¶</a></p>
</section>
</div>
<div id="seckey">
<section id="section-5.5.1.3">
            <h5 id="name-secret-key-packet-type-id-5">
<a class="section-number selfRef" href="#section-5.5.1.3">5.5.1.3. </a><a class="section-name selfRef" href="#name-secret-key-packet-type-id-5">Secret Key Packet (Type ID 5)</a>
            </h5>
<p id="section-5.5.1.3-1">A Secret Key packet contains all the information that is found in a Public Key packet, including the public key material, but it also includes the secret key material after all the public key fields.<a class="pilcrow" href="#section-5.5.1.3-1">¶</a></p>
</section>
</div>
<div id="secsubkey">
<section id="section-5.5.1.4">
            <h5 id="name-secret-subkey-packet-type-i">
<a class="section-number selfRef" href="#section-5.5.1.4">5.5.1.4. </a><a class="section-name selfRef" href="#name-secret-subkey-packet-type-i">Secret Subkey Packet (Type ID 7)</a>
            </h5>
<p id="section-5.5.1.4-1">A Secret Subkey packet (Type ID 7) is the subkey analog of the Secret Key packet and has exactly the same format.<a class="pilcrow" href="#section-5.5.1.4-1">¶</a></p>
</section>
</div>
</section>
</div>
<div id="public-key-packet-formats">
<section id="section-5.5.2">
          <h4 id="name-public-key-packet-formats">
<a class="section-number selfRef" href="#section-5.5.2">5.5.2. </a><a class="section-name selfRef" href="#name-public-key-packet-formats">Public Key Packet Formats</a>
          </h4>
<p id="section-5.5.2-1">There are four versions of key material packets.
Versions 2 and 3 have been deprecated since 1998. Version 4 has been deprecated by this document.<a class="pilcrow" href="#section-5.5.2-1">¶</a></p>
<p id="section-5.5.2-2">OpenPGP implementations <span class="bcp14">SHOULD</span> create keys with version 6 format.
Version 4 keys are deprecated; an implementation <span class="bcp14">SHOULD NOT</span> generate a version 4 key but <span class="bcp14">SHOULD</span> accept it. Version 3 keys are deprecated; an implementation <span class="bcp14">MUST NOT</span> generate a version 3 key but <span class="bcp14">MAY</span> accept it. Version 2 keys are deprecated; an implementation <span class="bcp14">MUST NOT</span> generate a version 2 key but <span class="bcp14">MAY</span> accept it.<a class="pilcrow" href="#section-5.5.2-2">¶</a></p>
<p id="section-5.5.2-3">Any new Key Version must be registered in the registry established in <a class="auto internal xref" href="#signed-message-versions">Section 10.3.2.2</a>.<a class="pilcrow" href="#section-5.5.2-3">¶</a></p>
<div id="v3-pubkeys">
<section id="section-5.5.2.1">
            <h5 id="name-version-3-public-keys">
<a class="section-number selfRef" href="#section-5.5.2.1">5.5.2.1. </a><a class="section-name selfRef" href="#name-version-3-public-keys">Version 3 Public Keys</a>
            </h5>
<p id="section-5.5.2.1-1">Version 2 keys are identical to version 3 keys except for the version number.
A version 3 Public Key or Public Subkey packet contains:<a class="pilcrow" href="#section-5.5.2.1-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.5.2.1-2.1">
                <p id="section-5.5.2.1-2.1.1">A 1-octet version number (3).<a class="pilcrow" href="#section-5.5.2.1-2.1.1">¶</a></p>
</li>
              <li class="normal" id="section-5.5.2.1-2.2">
                <p id="section-5.5.2.1-2.2.1">A 4-octet number denoting the time that the key was created.<a class="pilcrow" href="#section-5.5.2.1-2.2.1">¶</a></p>
</li>
              <li class="normal" id="section-5.5.2.1-2.3">
                <p id="section-5.5.2.1-2.3.1">A 2-octet number denoting the time in days that the key is valid.
If this number is zero, then it does not expire.<a class="pilcrow" href="#section-5.5.2.1-2.3.1">¶</a></p>
</li>
              <li class="normal" id="section-5.5.2.1-2.4">
                <p id="section-5.5.2.1-2.4.1">A 1-octet number denoting the public key algorithm of the key.<a class="pilcrow" href="#section-5.5.2.1-2.4.1">¶</a></p>
</li>
              <li class="normal" id="section-5.5.2.1-2.5">
                <p id="section-5.5.2.1-2.5.1">A series of multiprecision integers comprising the key material:<a class="pilcrow" href="#section-5.5.2.1-2.5.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.5.2.1-2.5.2.1">
                    <p id="section-5.5.2.1-2.5.2.1.1">MPI of RSA public modulus n.<a class="pilcrow" href="#section-5.5.2.1-2.5.2.1.1">¶</a></p>
</li>
                  <li class="normal" id="section-5.5.2.1-2.5.2.2">
                    <p id="section-5.5.2.1-2.5.2.2.1">MPI of RSA public encryption exponent e.<a class="pilcrow" href="#section-5.5.2.1-2.5.2.2.1">¶</a></p>
</li>
                </ul>
</li>
            </ul>
<p id="section-5.5.2.1-3">Version 3 keys are deprecated. They contain three weaknesses.
First, it is relatively easy to construct a version 3 key that has the same Key ID as any other key because the Key ID is simply the low 64 bits of the public modulus.
Second, because the fingerprint of a version 3 key hashes the key material, but not its length, there is an increased opportunity for fingerprint collisions.
Third, there are weaknesses in the MD5 hash algorithm that cause developers to prefer other algorithms.
See <a class="auto internal xref" href="#key-ids-fingerprints">Section 5.5.4</a> for a fuller discussion of Key IDs and fingerprints.<a class="pilcrow" href="#section-5.5.2.1-3">¶</a></p>
</section>
</div>
<div id="v4-pubkeys">
<section id="section-5.5.2.2">
            <h5 id="name-version-4-public-keys">
<a class="section-number selfRef" href="#section-5.5.2.2">5.5.2.2. </a><a class="section-name selfRef" href="#name-version-4-public-keys">Version 4 Public Keys</a>
            </h5>
<p id="section-5.5.2.2-1">The version 4 format is similar to the version 3 format except for the absence of a validity period.
This has been moved to the Signature packet.
In addition, fingerprints of version 4 keys are calculated differently from version 3 keys, as described in <a class="auto internal xref" href="#key-ids-fingerprints">Section 5.5.4</a>.<a class="pilcrow" href="#section-5.5.2.2-1">¶</a></p>
<p id="section-5.5.2.2-2">A version 4 packet contains:<a class="pilcrow" href="#section-5.5.2.2-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.5.2.2-3.1">
                <p id="section-5.5.2.2-3.1.1">A 1-octet version number (4).<a class="pilcrow" href="#section-5.5.2.2-3.1.1">¶</a></p>
</li>
              <li class="normal" id="section-5.5.2.2-3.2">
                <p id="section-5.5.2.2-3.2.1">A 4-octet number denoting the time that the key was created.<a class="pilcrow" href="#section-5.5.2.2-3.2.1">¶</a></p>
</li>
              <li class="normal" id="section-5.5.2.2-3.3">
                <p id="section-5.5.2.2-3.3.1">A 1-octet number denoting the public key algorithm of the key.<a class="pilcrow" href="#section-5.5.2.2-3.3.1">¶</a></p>
</li>
              <li class="normal" id="section-5.5.2.2-3.4">
                <p id="section-5.5.2.2-3.4.1">A series of values comprising the key material.
This is algorithm specific and described in <a class="auto internal xref" href="#algorithm-specific-parts-of-keys">Section 5.5.5</a>.<a class="pilcrow" href="#section-5.5.2.2-3.4.1">¶</a></p>
</li>
            </ul>
</section>
</div>
<div id="v6-pubkeys">
<section id="section-5.5.2.3">
            <h5 id="name-version-6-public-keys">
<a class="section-number selfRef" href="#section-5.5.2.3">5.5.2.3. </a><a class="section-name selfRef" href="#name-version-6-public-keys">Version 6 Public Keys</a>
            </h5>
<p id="section-5.5.2.3-1">The version 6 format is similar to the version 4 format except for the addition of a count for the key material.
This count helps parsing Secret Key packets (which are an extension of the Public Key packet format) in the case of an unknown algorithm.
     In addition, fingerprints of version 6 keys are calculated differently from version 4 keys, as described in <a class="auto internal xref" href="#key-ids-fingerprints">Section 5.5.4</a>.<a class="pilcrow" href="#section-5.5.2.3-1">¶</a></p>
<p id="section-5.5.2.3-2">A version 6 packet contains:<a class="pilcrow" href="#section-5.5.2.3-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.5.2.3-3.1">
                <p id="section-5.5.2.3-3.1.1">A 1-octet version number (6).<a class="pilcrow" href="#section-5.5.2.3-3.1.1">¶</a></p>
</li>
              <li class="normal" id="section-5.5.2.3-3.2">
                <p id="section-5.5.2.3-3.2.1">A 4-octet number denoting the time that the key was created.<a class="pilcrow" href="#section-5.5.2.3-3.2.1">¶</a></p>
</li>
              <li class="normal" id="section-5.5.2.3-3.3">
                <p id="section-5.5.2.3-3.3.1">A 1-octet number denoting the public key algorithm of the key.<a class="pilcrow" href="#section-5.5.2.3-3.3.1">¶</a></p>
</li>
              <li class="normal" id="section-5.5.2.3-3.4">
                <p id="section-5.5.2.3-3.4.1">A 4-octet scalar octet count for the public key material specified in the next field.<a class="pilcrow" href="#section-5.5.2.3-3.4.1">¶</a></p>
</li>
              <li class="normal" id="section-5.5.2.3-3.5">
                <p id="section-5.5.2.3-3.5.1">A series of values comprising the public key material.
This is algorithm specific and described in <a class="auto internal xref" href="#algorithm-specific-parts-of-keys">Section 5.5.5</a>.<a class="pilcrow" href="#section-5.5.2.3-3.5.1">¶</a></p>
</li>
            </ul>
</section>
</div>
</section>
</div>
<div id="secret-key-packet-formats">
<section id="section-5.5.3">
          <h4 id="name-secret-key-packet-formats">
<a class="section-number selfRef" href="#section-5.5.3">5.5.3. </a><a class="section-name selfRef" href="#name-secret-key-packet-formats">Secret Key Packet Formats</a>
          </h4>
<p id="section-5.5.3-1">The Secret Key and Secret Subkey packets contain all the data of the Public Key and Public Subkey packets, with additional algorithm-specific secret key data appended, usually in encrypted form.<a class="pilcrow" href="#section-5.5.3-1">¶</a></p>
<p id="section-5.5.3-2">The packet contains:<a class="pilcrow" href="#section-5.5.3-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.5.3-3.1">
              <p id="section-5.5.3-3.1.1">The fields of a Public Key or Public Subkey packet, as described above.<a class="pilcrow" href="#section-5.5.3-3.1.1">¶</a></p>
</li>
            <li class="normal" id="section-5.5.3-3.2">
              <p id="section-5.5.3-3.2.1">One octet (the "S2K usage octet") indicating whether and how the secret key material is protected by a passphrase.
Zero indicates that the secret key data is not encrypted.  253 (AEAD), 254 (CFB), or 255 (MalleableCFB) indicates that an S2K Specifier and other parameters will follow.
Any other value is a symmetric key encryption algorithm identifier.
A version 6 packet <span class="bcp14">MUST NOT</span> use the value 255 (MalleableCFB).<a class="pilcrow" href="#section-5.5.3-3.2.1">¶</a></p>
</li>
            <li class="normal" id="section-5.5.3-3.3">
              <p id="section-5.5.3-3.3.1">Only for a version 6 packet where the secret key material is encrypted (that is, where the previous octet is not zero), a 1-octet scalar octet count of the cumulative length of all the following conditionally included S2K parameter fields.<a class="pilcrow" href="#section-5.5.3-3.3.1">¶</a></p>
</li>
            <li class="normal" id="section-5.5.3-3.4">
              <p id="section-5.5.3-3.4.1">Conditionally included S2K parameter fields:<a class="pilcrow" href="#section-5.5.3-3.4.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.5.3-3.4.2.1">
                  <p id="section-5.5.3-3.4.2.1.1">If the S2K usage octet was 253, 254, or 255, a 1-octet symmetric key encryption algorithm.<a class="pilcrow" href="#section-5.5.3-3.4.2.1.1">¶</a></p>
</li>
                <li class="normal" id="section-5.5.3-3.4.2.2">
                  <p id="section-5.5.3-3.4.2.2.1">If the S2K usage octet was 253 (AEAD), a 1-octet AEAD algorithm.<a class="pilcrow" href="#section-5.5.3-3.4.2.2.1">¶</a></p>
</li>
                <li class="normal" id="section-5.5.3-3.4.2.3">
                  <p id="section-5.5.3-3.4.2.3.1">Only for a version 6 packet, and if the S2K usage octet was 253 or 254, a 1-octet count of the size of the one field following this octet.<a class="pilcrow" href="#section-5.5.3-3.4.2.3.1">¶</a></p>
</li>
                <li class="normal" id="section-5.5.3-3.4.2.4">
                  <p id="section-5.5.3-3.4.2.4.1">If the S2K usage octet was 253, 254, or 255, an S2K Specifier. The length of the S2K Specifier depends on its type (see <a class="auto internal xref" href="#s2k-types">Section 3.7.1</a>).<a class="pilcrow" href="#section-5.5.3-3.4.2.4.1">¶</a></p>
</li>
                <li class="normal" id="section-5.5.3-3.4.2.5">
                  <p id="section-5.5.3-3.4.2.5.1">If the S2K usage octet was 253 (AEAD), an IV of a size specified by the AEAD algorithm (see <a class="auto internal xref" href="#version-two-seipd">Section 5.13.2</a>), which is used as the nonce for the AEAD algorithm.<a class="pilcrow" href="#section-5.5.3-3.4.2.5.1">¶</a></p>
</li>
                <li class="normal" id="section-5.5.3-3.4.2.6">
                  <p id="section-5.5.3-3.4.2.6.1">If the S2K usage octet was 254, 255, or a cipher algorithm ID (that is, the secret data uses some form of CFB encryption), an IV of the same length as the cipher's block size.<a class="pilcrow" href="#section-5.5.3-3.4.2.6.1">¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="section-5.5.3-3.5">
              <p id="section-5.5.3-3.5.1">Plain or encrypted multiprecision integers comprising the secret key data.
This is algorithm specific and described in <a class="auto internal xref" href="#algorithm-specific-parts-of-keys">Section 5.5.5</a>.
If the S2K usage octet is 253 (AEAD), then an AEAD authentication tag is at the end of that data.
If the S2K usage octet is 254 (CFB), a 20-octet SHA-1 hash of the plaintext of the algorithm-specific portion is appended to plaintext and encrypted with it.
If the S2K usage octet is 255 (MalleableCFB) or another non-zero value (that is, a symmetric key encryption algorithm identifier), a 2-octet checksum of the plaintext of the algorithm-specific portion (sum of all octets, mod 65536) is appended to plaintext and encrypted with it.
(This is deprecated and <span class="bcp14">SHOULD NOT</span> be used; see below.)<a class="pilcrow" href="#section-5.5.3-3.5.1">¶</a></p>
</li>
            <li class="normal" id="section-5.5.3-3.6">
              <p id="section-5.5.3-3.6.1">Only for a version 3 or 4 packet where the S2K usage octet is zero, a 2-octet checksum of the algorithm-specific portion (sum of all octets, mod 65536).<a class="pilcrow" href="#section-5.5.3-3.6.1">¶</a></p>
</li>
          </ul>
<p id="section-5.5.3-4">The details about storing algorithm-specific secrets above are summarized in <a class="auto internal xref" href="#secret-key-protection-registry">Table 2</a>.<a class="pilcrow" href="#section-5.5.3-4">¶</a></p>
<p id="section-5.5.3-5">Note that the version 6 packet format adds two count values to help parsing packets with unknown S2K or public key algorithms.<a class="pilcrow" href="#section-5.5.3-5">¶</a></p>
<p id="section-5.5.3-6">Secret MPI values can be encrypted using a passphrase. If an S2K Specifier is given, it describes the algorithm for converting the passphrase to a key; otherwise, a simple MD5 hash of the passphrase is used. An implementation producing a passphrase-protected Secret Key packet <span class="bcp14">MUST</span> use an S2K Specifier; the simple hash is for read-only backward compatibility, though implementations <span class="bcp14">MAY</span> continue to use existing private keys in the old format. The cipher for encrypting the MPIs is specified in the Secret Key packet.<a class="pilcrow" href="#section-5.5.3-6">¶</a></p>
<p id="section-5.5.3-7">Encryption/decryption of the secret data is done using the key created from the passphrase and the IV from the packet.
If the S2K usage octet is not 253, CFB mode is used.
A different mode is used with version 3 keys (which are only RSA) than with other key formats.
With version 3 keys, the MPI bit count prefix (that is, the first two octets) is not encrypted.
Only the MPI non-prefix data is encrypted.
Furthermore, the CFB state is resynchronized at the beginning of each new MPI value so that the CFB block boundary is aligned with the start of the MPI data.<a class="pilcrow" href="#section-5.5.3-7">¶</a></p>
<p id="section-5.5.3-8">With version 4 and version 6 keys, a simpler method is used.
All secret MPI values are encrypted, including the MPI bit count prefix.<a class="pilcrow" href="#section-5.5.3-8">¶</a></p>
<p id="section-5.5.3-9">If the S2K usage octet is 253, the KEK is derived using HKDF <span>[<a class="cite xref" href="#RFC5869">RFC5869</a>]</span> to provide key separation. SHA256 <span>[<a class="cite xref" href="#RFC6234">RFC6234</a>]</span> is used as the hash algorithm for HKDF. IKM for HKDF is the key derived from S2K.
   No salt is used. The info parameter is comprised of the Packet Type ID encoded in OpenPGP format (bits 7 and 6 are set, and bits 5-0 carry the Packet Type ID), the packet version, and the cipher-algo and AEAD-mode used to encrypt the key material.<a class="pilcrow" href="#section-5.5.3-9">¶</a></p>
<p id="section-5.5.3-10">Then, the encrypted MPI values are encrypted as one combined plaintext using one of the AEAD algorithms specified for the version 2 Symmetrically Encrypted and Integrity Protected Data packet.
Note that no chunks are used and that there is only one authentication tag.
As additional data, the Packet Type ID in OpenPGP format encoding (bits 7 and 6 are set, and bits 5-0 carry the Packet Type ID), followed by the Public Key packet fields, starting with the packet version number, are passed to the AEAD algorithm. For example, the additional data used with a Secret Key packet of version 4 consists of the octets 0xC5, 0x04, followed by four octets of creation time, one octet denoting the public key algorithm, and the algorithm-specific public key parameters.
For a Secret Subkey packet, the first octet would be 0xC7.
For a version 6 key packet, the second octet would be 0x06, and the 4-octet octet count of the public key material would be included as well (see <a class="auto internal xref" href="#public-key-packet-formats">Section 5.5.2</a>).<a class="pilcrow" href="#section-5.5.3-10">¶</a></p>
<p id="section-5.5.3-11">The 2-octet checksum that follows the algorithm-specific portion is the algebraic sum, mod 65536, of the plaintext of all the algorithm-specific octets (including the MPI prefix and data).
With version 3 keys, the checksum is stored in the clear. With version 4 keys, the checksum is encrypted like the algorithm-specific data. This value is used to check that the passphrase was correct.
However, this checksum is deprecated, and an implementation <span class="bcp14">SHOULD NOT</span> use it; instead, an implementation should use the SHA-1 hash denoted with a usage octet of 254.
The reason for this is that there are some attacks that involve modifying the secret key undetected.
If the S2K usage octet is 253, no checksum or SHA-1 hash is used, but the authentication tag of the AEAD algorithm follows.<a class="pilcrow" href="#section-5.5.3-11">¶</a></p>
<p id="section-5.5.3-12">When decrypting the secret key material using any of these schemes (that is, where the usage octet is non-zero), the resulting cleartext octet stream must be well formed.
In particular, an implementation <span class="bcp14">MUST NOT</span> interpret octets beyond the unwrapped cleartext octet stream as part of any of the unwrapped MPI objects.
Furthermore, an implementation <span class="bcp14">MUST</span> reject any secret key material whose cleartext length does not align with the lengths of the unwrapped MPI objects as unusable.<a class="pilcrow" href="#section-5.5.3-12">¶</a></p>
</section>
</div>
<div id="key-ids-fingerprints">
<section id="section-5.5.4">
          <h4 id="name-key-ids-and-fingerprints-2">
<a class="section-number selfRef" href="#section-5.5.4">5.5.4. </a><a class="section-name selfRef" href="#name-key-ids-and-fingerprints-2">Key IDs and Fingerprints</a>
          </h4>
<p id="section-5.5.4-1">Every OpenPGP Key has a fingerprint and a Key ID.
The computation of these values differs based on the key version.
The fingerprint length varies with the key version, but the Key ID (which is only used in v3 PKESK packets; see <a class="auto internal xref" href="#v3-pkesk">Section 5.1.1</a>) is always 64 bits.
The following registry represents the subsections below:<a class="pilcrow" href="#section-5.5.4-1">¶</a></p>
<span id="name-openpgp-key-ids-and-fingerp"></span><div id="key-id-fingerprint-registry">
<table class="center" id="table-12">
            <caption>
<a class="selfRef" href="#table-12">Table 12</a>:
<a class="selfRef" href="#name-openpgp-key-ids-and-fingerp">OpenPGP Key IDs and Fingerprints Registry</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" colspan="1" rowspan="1">Key Version</th>
                <th class="text-left" colspan="1" rowspan="1">Fingerprint</th>
                <th class="text-left" colspan="1" rowspan="1">Fingerprint Length (Bits)</th>
                <th class="text-left" colspan="1" rowspan="1">Key ID</th>
                <th class="text-left" colspan="1" rowspan="1">Reference</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">3</td>
                <td class="text-left" colspan="1" rowspan="1">MD5(MPIs without length octets)</td>
                <td class="text-left" colspan="1" rowspan="1">128</td>
                <td class="text-left" colspan="1" rowspan="1">low 64 bits of RSA modulus</td>
                <td class="text-left" colspan="1" rowspan="1">
                  <a class="auto internal xref" href="#v3-key-id-fingerprint">Section 5.5.4.1</a>
</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">4</td>
                <td class="text-left" colspan="1" rowspan="1">SHA1(normalized pubkey packet)</td>
                <td class="text-left" colspan="1" rowspan="1">160</td>
                <td class="text-left" colspan="1" rowspan="1">last 64 bits of fingerprint</td>
                <td class="text-left" colspan="1" rowspan="1">
                  <a class="auto internal xref" href="#v4-key-id-fingerprint">Section 5.5.4.2</a>
</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">6</td>
                <td class="text-left" colspan="1" rowspan="1">SHA256(normalized pubkey packet)</td>
                <td class="text-left" colspan="1" rowspan="1">256</td>
                <td class="text-left" colspan="1" rowspan="1">first 64 bits of fingerprint</td>
                <td class="text-left" colspan="1" rowspan="1">
                  <a class="auto internal xref" href="#v6-key-id-fingerprint">Section 5.5.4.3</a>
</td>
              </tr>
            </tbody>
          </table>
</div>
<div id="v3-key-id-fingerprint">
<section id="section-5.5.4.1">
            <h5 id="name-version-3-key-id-and-finger">
<a class="section-number selfRef" href="#section-5.5.4.1">5.5.4.1. </a><a class="section-name selfRef" href="#name-version-3-key-id-and-finger">Version 3 Key ID and Fingerprint</a>
            </h5>
<p id="section-5.5.4.1-1">For a version 3 key, the 8-octet Key ID consists of the low 64 bits of the public modulus of the RSA key.<a class="pilcrow" href="#section-5.5.4.1-1">¶</a></p>
<p id="section-5.5.4.1-2">The fingerprint of a version 3 key is formed by hashing the body (but not the 2-octet length) of the MPIs that form the key material (public modulus n, followed by exponent e) with MD5.
Note that both version 3 keys and MD5 are deprecated.<a class="pilcrow" href="#section-5.5.4.1-2">¶</a></p>
</section>
</div>
<div id="v4-key-id-fingerprint">
<section id="section-5.5.4.2">
            <h5 id="name-version-4-key-id-and-finger">
<a class="section-number selfRef" href="#section-5.5.4.2">5.5.4.2. </a><a class="section-name selfRef" href="#name-version-4-key-id-and-finger">Version 4 Key ID and Fingerprint</a>
            </h5>
<p id="section-5.5.4.2-1">A version 4 fingerprint is the 160-bit SHA-1 hash of the octet 0x99, followed by the 2-octet packet length, followed by the entire Public Key packet starting with the version field.
The Key ID is the low-order 64 bits of the fingerprint.
Here are the fields of the hash material, including an example of an Ed25519 key:<a class="pilcrow" href="#section-5.5.4.2-1">¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-5.5.4.2-2">
            <dt>a.1)</dt>
<dd id="section-5.5.4.2-2.1">0x99 (1 octet)<a class="pilcrow" href="#section-5.5.4.2-2.1">¶</a>
</dd>
              <dd class="break"></dd>
<dt>a.2)</dt>
<dd id="section-5.5.4.2-2.2">2-octet, big-endian scalar octet count of (b)-(e)<a class="pilcrow" href="#section-5.5.4.2-2.2">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="olPercent" id="section-5.5.4.2-3">
            <dt>b)</dt>
<dd id="section-5.5.4.2-3.1">version number = 4 (1 octet)<a class="pilcrow" href="#section-5.5.4.2-3.1">¶</a>
</dd>
              <dd class="break"></dd>
<dt>c)</dt>
<dd id="section-5.5.4.2-3.2">timestamp of key creation (4 octets)<a class="pilcrow" href="#section-5.5.4.2-3.2">¶</a>
</dd>
              <dd class="break"></dd>
<dt>d)</dt>
<dd id="section-5.5.4.2-3.3">algorithm (1 octet): 27 = Ed25519 (example)<a class="pilcrow" href="#section-5.5.4.2-3.3">¶</a>
</dd>
              <dd class="break"></dd>
<dt>e)</dt>
<dd id="section-5.5.4.2-3.4">algorithm-specific fields<a class="pilcrow" href="#section-5.5.4.2-3.4">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
<p id="section-5.5.4.2-4">Algorithm-specific fields for Ed25519 keys (example):<a class="pilcrow" href="#section-5.5.4.2-4">¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-5.5.4.2-5">
            <dt>e.1)</dt>
<dd id="section-5.5.4.2-5.1">32 octets representing the public key<a class="pilcrow" href="#section-5.5.4.2-5.1">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</section>
</div>
<div id="v6-key-id-fingerprint">
<section id="section-5.5.4.3">
            <h5 id="name-version-6-key-id-and-finger">
<a class="section-number selfRef" href="#section-5.5.4.3">5.5.4.3. </a><a class="section-name selfRef" href="#name-version-6-key-id-and-finger">Version 6 Key ID and Fingerprint</a>
            </h5>
<p id="section-5.5.4.3-1">A version 6 fingerprint is the 256-bit SHA2-256 hash of the octet 0x9B, followed by the 4-octet packet length, followed by the entire Public Key packet starting with the version field.
The Key ID is the high-order 64 bits of the fingerprint.
     Here are the fields of the hash material, including an example of an Ed25519 key:<a class="pilcrow" href="#section-5.5.4.3-1">¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-5.5.4.3-2">
            <dt>a.1)</dt>
<dd id="section-5.5.4.3-2.1">0x9B (1 octet)<a class="pilcrow" href="#section-5.5.4.3-2.1">¶</a>
</dd>
              <dd class="break"></dd>
<dt>a.2)</dt>
<dd id="section-5.5.4.3-2.2">4-octet scalar octet count of (b)-(f)<a class="pilcrow" href="#section-5.5.4.3-2.2">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="olPercent" id="section-5.5.4.3-3">
            <dt>b)</dt>
<dd id="section-5.5.4.3-3.1">version number = 6 (1 octet)<a class="pilcrow" href="#section-5.5.4.3-3.1">¶</a>
</dd>
              <dd class="break"></dd>
<dt>c)</dt>
<dd id="section-5.5.4.3-3.2">timestamp of key creation (4 octets)<a class="pilcrow" href="#section-5.5.4.3-3.2">¶</a>
</dd>
              <dd class="break"></dd>
<dt>d)</dt>
<dd id="section-5.5.4.3-3.3">algorithm (1 octet): 27 = Ed25519 (example)<a class="pilcrow" href="#section-5.5.4.3-3.3">¶</a>
</dd>
              <dd class="break"></dd>
<dt>e)</dt>
<dd id="section-5.5.4.3-3.4">4-octet scalar octet count for the key material specified in the next field<a class="pilcrow" href="#section-5.5.4.3-3.4">¶</a>
</dd>
              <dd class="break"></dd>
<dt>f)</dt>
<dd id="section-5.5.4.3-3.5">algorithm-specific public key material<a class="pilcrow" href="#section-5.5.4.3-3.5">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
<p id="section-5.5.4.3-4">Algorithm-specific fields for Ed25519 keys (example):<a class="pilcrow" href="#section-5.5.4.3-4">¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-5.5.4.3-5">
            <dt>f.1)</dt>
<dd id="section-5.5.4.3-5.1">32 octets representing the public key<a class="pilcrow" href="#section-5.5.4.3-5.1">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
<p id="section-5.5.4.3-6">Note that it is possible for there to be collisions of Key IDs -- that is, two different keys with the same Key ID. Note that there is a much smaller, but still non-zero, probability that two different keys have the same fingerprint.<a class="pilcrow" href="#section-5.5.4.3-6">¶</a></p>
<p id="section-5.5.4.3-7">Also note that if version 3, version 4, and version 6 format keys share the same RSA key material, they will have different Key IDs as well as different fingerprints.<a class="pilcrow" href="#section-5.5.4.3-7">¶</a></p>
<p id="section-5.5.4.3-8">Finally, the Key ID and fingerprint of a subkey are calculated in the same way as for a primary key, including the 0x99 (version 4 key) or 0x9B (version 6 key) as the first octet (even though this is not a valid Packet Type ID for a public subkey).<a class="pilcrow" href="#section-5.5.4.3-8">¶</a></p>
</section>
</div>
</section>
</div>
<div id="algorithm-specific-parts-of-keys">
<section id="section-5.5.5">
          <h4 id="name-algorithm-specific-parts-of">
<a class="section-number selfRef" href="#section-5.5.5">5.5.5. </a><a class="section-name selfRef" href="#name-algorithm-specific-parts-of">Algorithm-Specific Parts of Keys</a>
          </h4>
<p id="section-5.5.5-1">The public and secret key formats specify algorithm-specific parts of a key.
The following sections describe them in detail.<a class="pilcrow" href="#section-5.5.5-1">¶</a></p>
<div id="key-rsa">
<section id="section-5.5.5.1">
            <h5 id="name-algorithm-specific-part-for">
<a class="section-number selfRef" href="#section-5.5.5.1">5.5.5.1. </a><a class="section-name selfRef" href="#name-algorithm-specific-part-for">Algorithm-Specific Part for RSA Keys</a>
            </h5>
<p id="section-5.5.5.1-1">For RSA keys, the public key consists of this series of multiprecision integers:<a class="pilcrow" href="#section-5.5.5.1-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.5.5.1-2.1">
                <p id="section-5.5.5.1-2.1.1">MPI of RSA public modulus n,<a class="pilcrow" href="#section-5.5.5.1-2.1.1">¶</a></p>
</li>
              <li class="normal" id="section-5.5.5.1-2.2">
                <p id="section-5.5.5.1-2.2.1">MPI of RSA public encryption exponent e.<a class="pilcrow" href="#section-5.5.5.1-2.2.1">¶</a></p>
</li>
            </ul>
<p id="section-5.5.5.1-3">The secret key consists of this series of multiprecision integers:<a class="pilcrow" href="#section-5.5.5.1-3">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.5.5.1-4.1">
                <p id="section-5.5.5.1-4.1.1">MPI of RSA secret exponent d;<a class="pilcrow" href="#section-5.5.5.1-4.1.1">¶</a></p>
</li>
              <li class="normal" id="section-5.5.5.1-4.2">
                <p id="section-5.5.5.1-4.2.1">MPI of RSA secret prime value p;<a class="pilcrow" href="#section-5.5.5.1-4.2.1">¶</a></p>
</li>
              <li class="normal" id="section-5.5.5.1-4.3">
                <p id="section-5.5.5.1-4.3.1">MPI of RSA secret prime value q (p &lt; q); and<a class="pilcrow" href="#section-5.5.5.1-4.3.1">¶</a></p>
</li>
              <li class="normal" id="section-5.5.5.1-4.4">
                <p id="section-5.5.5.1-4.4.1">MPI of u, the multiplicative inverse of p, mod q.<a class="pilcrow" href="#section-5.5.5.1-4.4.1">¶</a></p>
</li>
            </ul>
</section>
</div>
<div id="key-dsa">
<section id="section-5.5.5.2">
            <h5 id="name-algorithm-specific-part-for-">
<a class="section-number selfRef" href="#section-5.5.5.2">5.5.5.2. </a><a class="section-name selfRef" href="#name-algorithm-specific-part-for-">Algorithm-Specific Part for DSA Keys</a>
            </h5>
<p id="section-5.5.5.2-1">For DSA keys, the public key consists of this series of multiprecision integers:<a class="pilcrow" href="#section-5.5.5.2-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.5.5.2-2.1">
                <p id="section-5.5.5.2-2.1.1">MPI of DSA prime p;<a class="pilcrow" href="#section-5.5.5.2-2.1.1">¶</a></p>
</li>
              <li class="normal" id="section-5.5.5.2-2.2">
                <p id="section-5.5.5.2-2.2.1">MPI of DSA group order q (q is a prime divisor of p-1);<a class="pilcrow" href="#section-5.5.5.2-2.2.1">¶</a></p>
</li>
              <li class="normal" id="section-5.5.5.2-2.3">
                <p id="section-5.5.5.2-2.3.1">MPI of DSA group generator g; and<a class="pilcrow" href="#section-5.5.5.2-2.3.1">¶</a></p>
</li>
              <li class="normal" id="section-5.5.5.2-2.4">
                <p id="section-5.5.5.2-2.4.1">MPI of DSA public key value y (= g<sup>x</sup> mod p where x is secret).<a class="pilcrow" href="#section-5.5.5.2-2.4.1">¶</a></p>
</li>
            </ul>
<p id="section-5.5.5.2-3">The secret key consists of this single multiprecision integer:<a class="pilcrow" href="#section-5.5.5.2-3">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.5.5.2-4.1">
                <p id="section-5.5.5.2-4.1.1">MPI of DSA secret exponent x.<a class="pilcrow" href="#section-5.5.5.2-4.1.1">¶</a></p>
</li>
            </ul>
</section>
</div>
<div id="key-elgamal">
<section id="section-5.5.5.3">
            <h5 id="name-algorithm-specific-part-for-e">
<a class="section-number selfRef" href="#section-5.5.5.3">5.5.5.3. </a><a class="section-name selfRef" href="#name-algorithm-specific-part-for-e">Algorithm-Specific Part for Elgamal Keys</a>
            </h5>
<p id="section-5.5.5.3-1">For Elgamal keys, the public key consists of this series of multiprecision integers:<a class="pilcrow" href="#section-5.5.5.3-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.5.5.3-2.1">
                <p id="section-5.5.5.3-2.1.1">MPI of Elgamal prime p;<a class="pilcrow" href="#section-5.5.5.3-2.1.1">¶</a></p>
</li>
              <li class="normal" id="section-5.5.5.3-2.2">
                <p id="section-5.5.5.3-2.2.1">MPI of Elgamal group generator g; and<a class="pilcrow" href="#section-5.5.5.3-2.2.1">¶</a></p>
</li>
              <li class="normal" id="section-5.5.5.3-2.3">
                <p id="section-5.5.5.3-2.3.1">MPI of Elgamal public key value y (= g<sup>x</sup> mod p where x is secret).<a class="pilcrow" href="#section-5.5.5.3-2.3.1">¶</a></p>
</li>
            </ul>
<p id="section-5.5.5.3-3">The secret key consists of this single multiprecision integer:<a class="pilcrow" href="#section-5.5.5.3-3">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.5.5.3-4.1">
                <p id="section-5.5.5.3-4.1.1">MPI of Elgamal secret exponent x.<a class="pilcrow" href="#section-5.5.5.3-4.1.1">¶</a></p>
</li>
            </ul>
</section>
</div>
<div id="key-ecdsa">
<section id="section-5.5.5.4">
            <h5 id="name-algorithm-specific-part-for-ec">
<a class="section-number selfRef" href="#section-5.5.5.4">5.5.5.4. </a><a class="section-name selfRef" href="#name-algorithm-specific-part-for-ec">Algorithm-Specific Part for ECDSA Keys</a>
            </h5>
<p id="section-5.5.5.4-1">For ECDSA keys, the public key consists of this series of values:<a class="pilcrow" href="#section-5.5.5.4-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.5.5.4-2.1">
                <p id="section-5.5.5.4-2.1.1">A variable-length field containing a curve OID, which is formatted as follows:<a class="pilcrow" href="#section-5.5.5.4-2.1.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.5.5.4-2.1.2.1">
                    <p id="section-5.5.5.4-2.1.2.1.1">A 1-octet size of the following field; values 0 and 0xFF are reserved for future extensions.<a class="pilcrow" href="#section-5.5.5.4-2.1.2.1.1">¶</a></p>
</li>
                  <li class="normal" id="section-5.5.5.4-2.1.2.2">
                    <p id="section-5.5.5.4-2.1.2.2.1">The octets representing a curve OID, as defined in <a class="auto internal xref" href="#ec-curves">Section 9.2</a>.<a class="pilcrow" href="#section-5.5.5.4-2.1.2.2.1">¶</a></p>
</li>
                </ul>
</li>
              <li class="normal" id="section-5.5.5.4-2.2">
                <p id="section-5.5.5.4-2.2.1">An MPI of an EC point representing a public key.<a class="pilcrow" href="#section-5.5.5.4-2.2.1">¶</a></p>
</li>
            </ul>
<p id="section-5.5.5.4-3">The secret key consists of this single multiprecision integer:<a class="pilcrow" href="#section-5.5.5.4-3">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.5.5.4-4.1">
                <p id="section-5.5.5.4-4.1.1">An MPI of an integer representing the secret key, which is a scalar of the public EC point.<a class="pilcrow" href="#section-5.5.5.4-4.1.1">¶</a></p>
</li>
            </ul>
</section>
</div>
<div id="key-eddsa-legacy">
<section id="section-5.5.5.5">
            <h5 id="name-algorithm-specific-part-for-ed">
<a class="section-number selfRef" href="#section-5.5.5.5">5.5.5.5. </a><a class="section-name selfRef" href="#name-algorithm-specific-part-for-ed">Algorithm-Specific Part for EdDSALegacy Keys (Deprecated)</a>
            </h5>
<p id="section-5.5.5.5-1">For EdDSALegacy keys (deprecated), the public key consists of this series of values:<a class="pilcrow" href="#section-5.5.5.5-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.5.5.5-2.1">
                <p id="section-5.5.5.5-2.1.1">A variable-length field containing a curve OID, formatted as follows:<a class="pilcrow" href="#section-5.5.5.5-2.1.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.5.5.5-2.1.2.1">
                    <p id="section-5.5.5.5-2.1.2.1.1">A 1-octet size of the following field; values 0 and 0xFF are reserved for future extensions.<a class="pilcrow" href="#section-5.5.5.5-2.1.2.1.1">¶</a></p>
</li>
                  <li class="normal" id="section-5.5.5.5-2.1.2.2">
                    <p id="section-5.5.5.5-2.1.2.2.1">The octets representing a curve OID, as defined in <a class="auto internal xref" href="#ec-curves">Section 9.2</a>.<a class="pilcrow" href="#section-5.5.5.5-2.1.2.2.1">¶</a></p>
</li>
                </ul>
</li>
              <li class="normal" id="section-5.5.5.5-2.2">
                <p id="section-5.5.5.5-2.2.1">An MPI of an EC point representing a public key Q in prefixed native form (see <a class="auto internal xref" href="#ec-point-prefixed-native">Section 11.2.2</a>).<a class="pilcrow" href="#section-5.5.5.5-2.2.1">¶</a></p>
</li>
            </ul>
<p id="section-5.5.5.5-3">The secret key consists of this single multiprecision integer:<a class="pilcrow" href="#section-5.5.5.5-3">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.5.5.5-4.1">
                <p id="section-5.5.5.5-4.1.1">An MPI-encoded octet string representing the native form of the secret key in the curve-specific format, as described in <a class="auto internal xref" href="#curve-specific-formats">Section 9.2.1</a>.<a class="pilcrow" href="#section-5.5.5.5-4.1.1">¶</a></p>
</li>
            </ul>
<p id="section-5.5.5.5-5">Note that the native form for an EdDSA secret key is a fixed-width sequence of unstructured random octets, with size corresponding to the specific curve. That sequence of random octets is used with a cryptographic digest to produce both a curve-specific secret scalar and a prefix used when making a signature.
See <span><a class="relref" href="https://rfc-editor.org/rfc/rfc8032#section-5.1.5">Section 5.1.5</a> of [<a class="cite xref" href="#RFC8032">RFC8032</a>]</span> for more details about how to use the native octet strings for Ed25519Legacy.
The value stored in an OpenPGP EdDSALegacy Secret Key packet is the original sequence of random octets.<a class="pilcrow" href="#section-5.5.5.5-5">¶</a></p>
<p id="section-5.5.5.5-6">Note that the only curve defined for use with EdDSALegacy is the Ed25519Legacy OID.<a class="pilcrow" href="#section-5.5.5.5-6">¶</a></p>
</section>
</div>
<div id="key-ecdh">
<section id="section-5.5.5.6">
            <h5 id="name-algorithm-specific-part-for-ecd">
<a class="section-number selfRef" href="#section-5.5.5.6">5.5.5.6. </a><a class="section-name selfRef" href="#name-algorithm-specific-part-for-ecd">Algorithm-Specific Part for ECDH Keys</a>
            </h5>
<p id="section-5.5.5.6-1">For ECDH keys, the public key consists of this series of values:<a class="pilcrow" href="#section-5.5.5.6-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.5.5.6-2.1">
                <p id="section-5.5.5.6-2.1.1">A variable-length field containing a curve OID, which is formatted as follows:<a class="pilcrow" href="#section-5.5.5.6-2.1.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.5.5.6-2.1.2.1">
                    <p id="section-5.5.5.6-2.1.2.1.1">A 1-octet size of the following field; values 0 and 0xFF are reserved for future extensions.<a class="pilcrow" href="#section-5.5.5.6-2.1.2.1.1">¶</a></p>
</li>
                  <li class="normal" id="section-5.5.5.6-2.1.2.2">
                    <p id="section-5.5.5.6-2.1.2.2.1">The octets representing a curve OID, as defined in <a class="auto internal xref" href="#ec-curves">Section 9.2</a>.<a class="pilcrow" href="#section-5.5.5.6-2.1.2.2.1">¶</a></p>
</li>
                </ul>
</li>
              <li class="normal" id="section-5.5.5.6-2.2">
                <p id="section-5.5.5.6-2.2.1">An MPI of an EC point representing a public key, in the point format associated with the curve, as specified in <a class="auto internal xref" href="#curve-specific-formats">Section 9.2.1</a>.<a class="pilcrow" href="#section-5.5.5.6-2.2.1">¶</a></p>
</li>
              <li class="normal" id="section-5.5.5.6-2.3">
                <p id="section-5.5.5.6-2.3.1">A variable-length field containing key derivation function (KDF) parameters, which is formatted as follows:<a class="pilcrow" href="#section-5.5.5.6-2.3.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.5.5.6-2.3.2.1">
                    <p id="section-5.5.5.6-2.3.2.1.1">A 1-octet size of the following fields; values 0 and 0xFF are reserved for future extensions.<a class="pilcrow" href="#section-5.5.5.6-2.3.2.1.1">¶</a></p>
</li>
                  <li class="normal" id="section-5.5.5.6-2.3.2.2">
                    <p id="section-5.5.5.6-2.3.2.2.1">A 1-octet value 1, reserved for future extensions.<a class="pilcrow" href="#section-5.5.5.6-2.3.2.2.1">¶</a></p>
</li>
                  <li class="normal" id="section-5.5.5.6-2.3.2.3">
                    <p id="section-5.5.5.6-2.3.2.3.1">A 1-octet hash function ID used with a KDF.<a class="pilcrow" href="#section-5.5.5.6-2.3.2.3.1">¶</a></p>
</li>
                  <li class="normal" id="section-5.5.5.6-2.3.2.4">
                    <p id="section-5.5.5.6-2.3.2.4.1">A 1-octet algorithm ID for the symmetric algorithm that is used to wrap the symmetric key for message encryption; see <a class="auto internal xref" href="#ecdh">Section 11.5</a> for details.<a class="pilcrow" href="#section-5.5.5.6-2.3.2.4.1">¶</a></p>
</li>
                </ul>
</li>
            </ul>
<p id="section-5.5.5.6-3">The secret key consists of this single multiprecision integer:<a class="pilcrow" href="#section-5.5.5.6-3">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.5.5.6-4.1">
                <p id="section-5.5.5.6-4.1.1">An MPI representing the secret key, in the curve-specific format described in <a class="auto internal xref" href="#curve-specific-formats">Section 9.2.1</a>.<a class="pilcrow" href="#section-5.5.5.6-4.1.1">¶</a></p>
</li>
            </ul>
<div id="ecdh-secret-key-material">
<section id="section-5.5.5.6.1">
              <h6 id="name-ecdh-secret-key-material">
<a class="section-number selfRef" href="#section-5.5.5.6.1">5.5.5.6.1. </a><a class="section-name selfRef" href="#name-ecdh-secret-key-material">ECDH Secret Key Material</a>
              </h6>
<p id="section-5.5.5.6.1-1">When curve NIST P-256, NIST P-384, NIST P-521, brainpoolP256r1, brainpoolP384r1, or brainpoolP512r1 are used in ECDH, their secret keys are represented as a simple integer in standard MPI form.
Other curves are presented on the wire differently (though still as a single MPI), as described below and in <a class="auto internal xref" href="#curve-specific-formats">Section 9.2.1</a>.<a class="pilcrow" href="#section-5.5.5.6.1-1">¶</a></p>
<div id="curve25519-secrets">
<section id="section-5.5.5.6.1.1">
                <h6 id="name-curve25519legacy-ecdh-secre">
<a class="section-number selfRef" href="#section-5.5.5.6.1.1">5.5.5.6.1.1. </a><a class="section-name selfRef" href="#name-curve25519legacy-ecdh-secre">Curve25519Legacy ECDH Secret Key Material (Deprecated)</a>
                </h6>
<p id="section-5.5.5.6.1.1-1">A Curve25519Legacy secret key is stored as a standard integer in big-endian MPI form.
Curve25519Legacy <span class="bcp14">MUST NOT</span> be used in key packets version 6 or above.
Note that this form is in reverse octet order from the little-endian "native" form found in <span>[<a class="cite xref" href="#RFC7748">RFC7748</a>]</span>.<a class="pilcrow" href="#section-5.5.5.6.1.1-1">¶</a></p>
<p id="section-5.5.5.6.1.1-2">Note also that the integer for a Curve25519Legacy secret key for OpenPGP <span class="bcp14">MUST</span> have the appropriate form; that is, it <span class="bcp14">MUST</span> be divisible by 8, <span class="bcp14">MUST</span> be at least 2<sup>254</sup>, and <span class="bcp14">MUST</span> be less than 2<sup>255</sup>.
The length of this MPI in bits is by definition always 255, so the two leading octets of the MPI will always be <code>00 FF</code>, and reversing the following 32 octets from the wire will produce the "native" form.<a class="pilcrow" href="#section-5.5.5.6.1.1-2">¶</a></p>
<p id="section-5.5.5.6.1.1-3">When generating a new Curve25519Legacy secret key from 32 fully random octets, the following pseudocode produces the MPI wire format (note the similarity to <code>decodeScalar25519</code> as described in <span>[<a class="cite xref" href="#RFC7748">RFC7748</a>]</span>):<a class="pilcrow" href="#section-5.5.5.6.1.1-3">¶</a></p>
<div class="lang-pseudocode sourcecode" id="section-5.5.5.6.1.1-4">
<pre>def curve25519Legacy_MPI_from_random(octet_list):
    octet_list[0] &amp;= 248
    octet_list[31] &amp;= 127
    octet_list[31] |= 64
    mpi_header = [ 0x00, 0xFF ]
    return mpi_header || reversed(octet_list)
</pre><a class="pilcrow" href="#section-5.5.5.6.1.1-4">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="key-x25519">
<section id="section-5.5.5.7">
            <h5 id="name-algorithm-specific-part-for-x">
<a class="section-number selfRef" href="#section-5.5.5.7">5.5.5.7. </a><a class="section-name selfRef" href="#name-algorithm-specific-part-for-x">Algorithm-Specific Part for X25519 Keys</a>
            </h5>
<p id="section-5.5.5.7-1">For X25519 keys, the public key consists of this single value:<a class="pilcrow" href="#section-5.5.5.7-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.5.5.7-2.1">
                <p id="section-5.5.5.7-2.1.1">32 octets of the native public key.<a class="pilcrow" href="#section-5.5.5.7-2.1.1">¶</a></p>
</li>
            </ul>
<p id="section-5.5.5.7-3">The secret key consists of this single value:<a class="pilcrow" href="#section-5.5.5.7-3">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.5.5.7-4.1">
                <p id="section-5.5.5.7-4.1.1">32 octets of the native secret key.<a class="pilcrow" href="#section-5.5.5.7-4.1.1">¶</a></p>
</li>
            </ul>
<p id="section-5.5.5.7-5">See <span><a class="relref" href="https://rfc-editor.org/rfc/rfc7748#section-6.1">Section 6.1</a> of [<a class="cite xref" href="#RFC7748">RFC7748</a>]</span> for more details about how to use the native octet strings.
The value stored in an OpenPGP X25519 Secret Key packet is the original sequence of random octets.
The value stored in an OpenPGP X25519 Public Key packet is the value X25519(secretKey, 9).<a class="pilcrow" href="#section-5.5.5.7-5">¶</a></p>
</section>
</div>
<div id="key-x448">
<section id="section-5.5.5.8">
            <h5 id="name-algorithm-specific-part-for-x4">
<a class="section-number selfRef" href="#section-5.5.5.8">5.5.5.8. </a><a class="section-name selfRef" href="#name-algorithm-specific-part-for-x4">Algorithm-Specific Part for X448 Keys</a>
            </h5>
<p id="section-5.5.5.8-1">For X448 keys, the public key consists of this single value:<a class="pilcrow" href="#section-5.5.5.8-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.5.5.8-2.1">
                <p id="section-5.5.5.8-2.1.1">56 octets of the native public key.<a class="pilcrow" href="#section-5.5.5.8-2.1.1">¶</a></p>
</li>
            </ul>
<p id="section-5.5.5.8-3">The secret key consists of this single value:<a class="pilcrow" href="#section-5.5.5.8-3">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.5.5.8-4.1">
                <p id="section-5.5.5.8-4.1.1">56 octets of the native secret key.<a class="pilcrow" href="#section-5.5.5.8-4.1.1">¶</a></p>
</li>
            </ul>
<p id="section-5.5.5.8-5">See <span><a class="relref" href="https://rfc-editor.org/rfc/rfc7748#section-6.2">Section 6.2</a> of [<a class="cite xref" href="#RFC7748">RFC7748</a>]</span> for more details about how to use the native octet strings.
The value stored in an OpenPGP X448 Secret Key packet is the original sequence of random octets.
The value stored in an OpenPGP X448 Public Key packet is the value X448(secretKey, 5).<a class="pilcrow" href="#section-5.5.5.8-5">¶</a></p>
</section>
</div>
<div id="key-ed25519">
<section id="section-5.5.5.9">
            <h5 id="name-algorithm-specific-part-for-ed2">
<a class="section-number selfRef" href="#section-5.5.5.9">5.5.5.9. </a><a class="section-name selfRef" href="#name-algorithm-specific-part-for-ed2">Algorithm-Specific Part for Ed25519 Keys</a>
            </h5>
<p id="section-5.5.5.9-1">For Ed25519 keys, the public key consists of this single value:<a class="pilcrow" href="#section-5.5.5.9-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.5.5.9-2.1">
                <p id="section-5.5.5.9-2.1.1">32 octets of the native public key.<a class="pilcrow" href="#section-5.5.5.9-2.1.1">¶</a></p>
</li>
            </ul>
<p id="section-5.5.5.9-3">The secret key consists of this single value:<a class="pilcrow" href="#section-5.5.5.9-3">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.5.5.9-4.1">
                <p id="section-5.5.5.9-4.1.1">32 octets of the native secret key.<a class="pilcrow" href="#section-5.5.5.9-4.1.1">¶</a></p>
</li>
            </ul>
<p id="section-5.5.5.9-5">See <span><a class="relref" href="https://rfc-editor.org/rfc/rfc8032#section-5.1.5">Section 5.1.5</a> of [<a class="cite xref" href="#RFC8032">RFC8032</a>]</span> for more details about how to use the native octet strings.
The value stored in an OpenPGP Ed25519 Secret Key packet is the original sequence of random octets.<a class="pilcrow" href="#section-5.5.5.9-5">¶</a></p>
</section>
</div>
<div id="key-ed448">
<section id="section-5.5.5.10">
            <h5 id="name-algorithm-specific-part-for-ed4">
<a class="section-number selfRef" href="#section-5.5.5.10">5.5.5.10. </a><a class="section-name selfRef" href="#name-algorithm-specific-part-for-ed4">Algorithm-Specific Part for Ed448 Keys</a>
            </h5>
<p id="section-5.5.5.10-1">For Ed448 keys, the public key consists of this single value:<a class="pilcrow" href="#section-5.5.5.10-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.5.5.10-2.1">
                <p id="section-5.5.5.10-2.1.1">57 octets of the native public key.<a class="pilcrow" href="#section-5.5.5.10-2.1.1">¶</a></p>
</li>
            </ul>
<p id="section-5.5.5.10-3">The secret key consists of this single value:<a class="pilcrow" href="#section-5.5.5.10-3">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.5.5.10-4.1">
                <p id="section-5.5.5.10-4.1.1">57 octets of the native secret key.<a class="pilcrow" href="#section-5.5.5.10-4.1.1">¶</a></p>
</li>
            </ul>
<p id="section-5.5.5.10-5">See <span><a class="relref" href="https://rfc-editor.org/rfc/rfc8032#section-5.2.5">Section 5.2.5</a> of [<a class="cite xref" href="#RFC8032">RFC8032</a>]</span> for more details about how to use the native octet strings.
The value stored in an OpenPGP Ed448 Secret Key packet is the original sequence of random octets.<a class="pilcrow" href="#section-5.5.5.10-5">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="compressed-data">
<section id="section-5.6">
        <h3 id="name-compressed-data-packet-type">
<a class="section-number selfRef" href="#section-5.6">5.6. </a><a class="section-name selfRef" href="#name-compressed-data-packet-type">Compressed Data Packet (Type ID 8)</a>
        </h3>
<p id="section-5.6-1">The Compressed Data packet contains compressed data.
Typically, this packet is found as the contents of an encrypted packet, or following a Signature or One-Pass Signature packet, and contains a Literal Data packet.<a class="pilcrow" href="#section-5.6-1">¶</a></p>
<p id="section-5.6-2">The body of this packet consists of:<a class="pilcrow" href="#section-5.6-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.6-3.1">
            <p id="section-5.6-3.1.1">One octet specifying the algorithm used to compress the packet.<a class="pilcrow" href="#section-5.6-3.1.1">¶</a></p>
</li>
          <li class="normal" id="section-5.6-3.2">
            <p id="section-5.6-3.2.1">Compressed data, which makes up the remainder of the packet.<a class="pilcrow" href="#section-5.6-3.2.1">¶</a></p>
</li>
        </ul>
<p id="section-5.6-4">A Compressed Data packet's body contains data that is a compression of a series of OpenPGP packets.
See <a class="auto internal xref" href="#packet-sequence-composition">Section 10</a> for details on how messages are formed.<a class="pilcrow" href="#section-5.6-4">¶</a></p>
<p id="section-5.6-5">A ZIP-compressed series of packets is compressed into raw DEFLATE blocks <span>[<a class="cite xref" href="#RFC1951">RFC1951</a>]</span>.<a class="pilcrow" href="#section-5.6-5">¶</a></p>
<p id="section-5.6-6">A ZLIB-compressed series of packets is compressed with raw ZLIB-style blocks <span>[<a class="cite xref" href="#RFC1950">RFC1950</a>]</span>.<a class="pilcrow" href="#section-5.6-6">¶</a></p>
<p id="section-5.6-7">A BZip2-compressed series of packets is compressed using the BZip2 <span>[<a class="cite xref" href="#BZ2">BZ2</a>]</span> algorithm.<a class="pilcrow" href="#section-5.6-7">¶</a></p>
<p id="section-5.6-8">An implementation that generates a Compressed Data packet <span class="bcp14">MUST</span> use the OpenPGP format for packet framing (see <a class="auto internal xref" href="#openpgp-packet-format">Section 4.2.1</a>).
It <span class="bcp14">MUST NOT</span> generate a Compressed Data packet with Legacy format (<a class="auto internal xref" href="#legacy-packet-format">Section 4.2.2</a>).<a class="pilcrow" href="#section-5.6-8">¶</a></p>
<p id="section-5.6-9">An implementation that deals with either historic data or data generated by legacy implementations predating support for <span>[<a class="cite xref" href="#RFC2440">RFC2440</a>]</span> <span class="bcp14">MAY</span> interpret Compressed Data packets that use the Legacy format for packet framing.<a class="pilcrow" href="#section-5.6-9">¶</a></p>
</section>
</div>
<div id="sed">
<section id="section-5.7">
        <h3 id="name-symmetrically-encrypted-dat">
<a class="section-number selfRef" href="#section-5.7">5.7. </a><a class="section-name selfRef" href="#name-symmetrically-encrypted-dat">Symmetrically Encrypted Data Packet (Type ID 9)</a>
        </h3>
<p id="section-5.7-1">The Symmetrically Encrypted Data packet contains data encrypted with a symmetric key algorithm. When it has been decrypted, it contains other packets (usually a Literal Data packet or compressed data packet, but in theory, it could be another sequence of packets that forms a valid OpenPGP Message).<a class="pilcrow" href="#section-5.7-1">¶</a></p>
<p id="section-5.7-2">This packet is obsolete.
An implementation <span class="bcp14">MUST NOT</span> create this packet.
An implementation <span class="bcp14">SHOULD</span> reject such a packet and stop processing the message.
If an implementation chooses to process the packet anyway, it <span class="bcp14">MUST</span> return a clear warning that a non-integrity-protected packet has been processed.<a class="pilcrow" href="#section-5.7-2">¶</a></p>
<p id="section-5.7-3">This packet format is impossible to handle safely in general because the ciphertext it provides is malleable.
See <a class="auto internal xref" href="#ciphertext-malleability">Section 13.7</a> about selecting a better OpenPGP encryption container that does not have this flaw.<a class="pilcrow" href="#section-5.7-3">¶</a></p>
<p id="section-5.7-4">The body of this packet consists of:<a class="pilcrow" href="#section-5.7-4">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.7-5.1">
            <p id="section-5.7-5.1.1">A random prefix, containing block-size random octets (for example, 16 octets for a 128-bit block length) followed by a copy of the last two octets, encrypted together using Cipher Feedback (CFB) mode, with an IV of all zeros.<a class="pilcrow" href="#section-5.7-5.1.1">¶</a></p>
</li>
          <li class="normal" id="section-5.7-5.2">
            <p id="section-5.7-5.2.1">Data encrypted using CFB mode, with the last block-size octets of the first ciphertext as the IV.<a class="pilcrow" href="#section-5.7-5.2.1">¶</a></p>
</li>
        </ul>
<p id="section-5.7-6">The symmetric cipher used may be specified in a Public Key or Symmetric Key Encrypted Session Key packet that precedes the Symmetrically Encrypted Data packet.
In that case, the cipher algorithm ID is prefixed to the session key before it is encrypted.
If no packets of these types precede the encrypted data, the IDEA algorithm is used with the session key calculated as the MD5 hash of the passphrase, though this use is deprecated.<a class="pilcrow" href="#section-5.7-6">¶</a></p>
<p id="section-5.7-7">The data is encrypted in CFB mode (see <a class="auto internal xref" href="#cfb-mode">Section 12.9</a>).
For the random prefix, the IV is specified as all zeros. Instead of achieving randomized encryption through an IV, a string of length equal to the block size of the cipher plus two is encrypted for this purpose. The first block-size octets (for example, 16 octets for a 128-bit block length) are random, and the following two octets are copies of the last two octets of the first block-size random octets. For example, for a 16-octet block length, octet 17 is a copy of octet 15, and octet 18 is a copy of octet 16. For a cipher of block length 8, octet 9 is a copy of octet 7, and octet 10 is a copy of octet 8. (In both of these examples, we consider the first octet to be numbered 1.)<a class="pilcrow" href="#section-5.7-7">¶</a></p>
<p id="section-5.7-8">After encrypting these block-size-plus-two octets, a new CFB context is created for the encryption of the data, with the last block-size octets of the first ciphertext as the IV. (Alternatively and equivalently, the CFB state is resynchronized: the last block-size octets of ciphertext are passed through the cipher, and the block boundary is reset.)<a class="pilcrow" href="#section-5.7-8">¶</a></p>
<p id="section-5.7-9">The repetition of two octets in the random prefix allows the receiver to immediately check whether the session key is incorrect.
See <a class="auto internal xref" href="#quick-check-oracle">Section 13.4</a> for hints on the proper use of this "quick check".<a class="pilcrow" href="#section-5.7-9">¶</a></p>
</section>
</div>
<div id="marker-packet">
<section id="section-5.8">
        <h3 id="name-marker-packet-type-id-10">
<a class="section-number selfRef" href="#section-5.8">5.8. </a><a class="section-name selfRef" href="#name-marker-packet-type-id-10">Marker Packet (Type ID 10)</a>
        </h3>
<p id="section-5.8-1">The body of the Marker packet consists of:<a class="pilcrow" href="#section-5.8-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.8-2.1">
            <p id="section-5.8-2.1.1">The three octets 0x50, 0x47, 0x50 (which spell "PGP" in UTF-8).<a class="pilcrow" href="#section-5.8-2.1.1">¶</a></p>
</li>
        </ul>
<p id="section-5.8-3">Such a packet <span class="bcp14">MUST</span> be ignored when received.<a class="pilcrow" href="#section-5.8-3">¶</a></p>
</section>
</div>
<div id="lit">
<section id="section-5.9">
        <h3 id="name-literal-data-packet-type-id">
<a class="section-number selfRef" href="#section-5.9">5.9. </a><a class="section-name selfRef" href="#name-literal-data-packet-type-id">Literal Data Packet (Type ID 11)</a>
        </h3>
<p id="section-5.9-1">A Literal Data packet contains the body of a message; that is, data that is not to be further interpreted.<a class="pilcrow" href="#section-5.9-1">¶</a></p>
<p id="section-5.9-2">The body of this packet consists of:<a class="pilcrow" href="#section-5.9-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.9-3.1">
            <p id="section-5.9-3.1.1">A 1-octet field that describes how the data is formatted.<a class="pilcrow" href="#section-5.9-3.1.1">¶</a></p>
<p id="section-5.9-3.1.2">
If it is a <code>b</code> (0x62), then the Literal Data packet contains binary data.
If it is a <code>u</code> (0x75), then the Literal Data packet contains UTF-8-encoded text data and thus may need line ends converted to local form or other text mode changes.<a class="pilcrow" href="#section-5.9-3.1.2">¶</a></p>
<p id="section-5.9-3.1.3">
Previous versions of the OpenPGP specification used <code>t</code> (0x74) to indicate textual data but did not specify the character encoding. Implementations <span class="bcp14">SHOULD NOT</span> emit this value.
An implementation that receives a Literal Data packet with this value in the format field <span class="bcp14">SHOULD</span> interpret the packet data as UTF-8 encoded text, unless reliable (not attacker-controlled) context indicates a specific alternate text encoding. This mode is deprecated due to its ambiguity.<a class="pilcrow" href="#section-5.9-3.1.3">¶</a></p>
<p id="section-5.9-3.1.4">
Some implementations predating <span>[<a class="cite xref" href="#RFC2440">RFC2440</a>]</span> also defined a value of <code>l</code> as a "local" mode for machine-local conversions. <span>[<a class="cite xref" href="#RFC1991">RFC1991</a>]</span> incorrectly states that this local mode flag is <code>1</code> (ASCII numeral one). Both of these local modes are deprecated.<a class="pilcrow" href="#section-5.9-3.1.4">¶</a></p>
</li>
          <li class="normal" id="section-5.9-3.2">
            <p id="section-5.9-3.2.1">The file name as a string (1-octet length, followed by a file name).
     This may be a zero-length string. Commonly, if the source of the encrypted data is a file, it will be the name of the encrypted file. An implementation <span class="bcp14">MAY</span> consider the file name in the Literal Data packet to be a more authoritative name than the actual file name.<a class="pilcrow" href="#section-5.9-3.2.1">¶</a></p>
</li>
          <li class="normal" id="section-5.9-3.3">
            <p id="section-5.9-3.3.1">A 4-octet number that indicates a date associated with the literal data.
Commonly, the date might be the modification date of a file, or the time the packet was created, or a zero that indicates no specific time.<a class="pilcrow" href="#section-5.9-3.3.1">¶</a></p>
</li>
          <li class="normal" id="section-5.9-3.4">
            <p id="section-5.9-3.4.1">The remainder of the packet is literal data.<a class="pilcrow" href="#section-5.9-3.4.1">¶</a></p>
<p id="section-5.9-3.4.2">
Text data <span class="bcp14">MUST</span> be encoded with UTF-8 (see <span>[<a class="cite xref" href="#RFC3629">RFC3629</a>]</span>) and stored with &lt;CR&gt;&lt;LF&gt; text endings (that is, network-normal line endings).
These should be converted to native line endings by the receiving implementation.<a class="pilcrow" href="#section-5.9-3.4.2">¶</a></p>
</li>
        </ul>
<p id="section-5.9-4">Note that OpenPGP signatures do not include the formatting octet, the file name, and the date field of the Literal Data packet in a signature hash; therefore, those fields are not protected against tampering in a signed document. A receiving implementation <span class="bcp14">MUST NOT</span> treat those fields as though they were cryptographically secured by the surrounding signature when either representing them to the user or acting on them.<a class="pilcrow" href="#section-5.9-4">¶</a></p>
<p id="section-5.9-5">Due to their inherent malleability, an implementation that generates a Literal Data packet <span class="bcp14">SHOULD</span> avoid storing any significant data in these fields.
If the implementation is certain that the data is textual and is encoded with UTF-8 (for example, if it will follow this Literal Data packet with a Signature packet of type 0x01 (see <a class="auto internal xref" href="#signature-types">Section 5.2.1</a>), it <span class="bcp14">MAY</span> set the format octet to <code>u</code>.
Otherwise, it <span class="bcp14">MUST</span> set the format octet to <code>b</code>.
It <span class="bcp14">SHOULD</span> set the filename to the empty string (encoded as a single zero octet) and the timestamp to zero (encoded as four zero octets).<a class="pilcrow" href="#section-5.9-5">¶</a></p>
<p id="section-5.9-6">An application that wishes to include such filesystem metadata within a signature is advised to sign an encapsulated archive (for example, <span>[<a class="cite xref" href="#PAX">PAX</a>]</span>).<a class="pilcrow" href="#section-5.9-6">¶</a></p>
<p id="section-5.9-7">An implementation that generates a Literal Data packet <span class="bcp14">MUST</span> use the OpenPGP format for packet framing (see <a class="auto internal xref" href="#openpgp-packet-format">Section 4.2.1</a>).
It <span class="bcp14">MUST NOT</span> generate a Literal Data packet with Legacy format (<a class="auto internal xref" href="#legacy-packet-format">Section 4.2.2</a>).<a class="pilcrow" href="#section-5.9-7">¶</a></p>
<p id="section-5.9-8">An implementation that deals with either historic data or data generated by an implementation that predates support for <span>[<a class="cite xref" href="#RFC2440">RFC2440</a>]</span> <span class="bcp14">MAY</span> interpret Literal Data packets that use the Legacy format for packet framing.<a class="pilcrow" href="#section-5.9-8">¶</a></p>
<div id="for-eyes-only">
<section id="section-5.9.1">
          <h4 id="name-special-filename-_console-d">
<a class="section-number selfRef" href="#section-5.9.1">5.9.1. </a><a class="section-name selfRef" href="#name-special-filename-_console-d">Special Filename _CONSOLE (Deprecated)</a>
          </h4>
<p id="section-5.9.1-1">The Literal Data packet's filename field has a historical special case for the special name <code>_CONSOLE</code>.
When the filename field is <code>_CONSOLE</code>, the message is considered to be "for your eyes only".
This advises that the message data is unusually sensitive, and the receiving program should process it more carefully, perhaps avoiding storing the received data to disk, for example.<a class="pilcrow" href="#section-5.9.1-1">¶</a></p>
<p id="section-5.9.1-2">An OpenPGP deployment that generates Literal Data packets <span class="bcp14">MUST NOT</span> depend on this indicator being honored in any particular way.
It cannot be enforced, and the field itself is not covered by any cryptographic signature.<a class="pilcrow" href="#section-5.9.1-2">¶</a></p>
<p id="section-5.9.1-3">It is <span class="bcp14">NOT RECOMMENDED</span> to use this special filename in a newly generated Literal Data packet.<a class="pilcrow" href="#section-5.9.1-3">¶</a></p>
</section>
</div>
</section>
</div>
<div id="trust">
<section id="section-5.10">
        <h3 id="name-trust-packet-type-id-12">
<a class="section-number selfRef" href="#section-5.10">5.10. </a><a class="section-name selfRef" href="#name-trust-packet-type-id-12">Trust Packet (Type ID 12)</a>
        </h3>
<p id="section-5.10-1">The Trust packet is used only within keyrings and is not normally exported.
Trust packets contain data that record the user's specifications of which keyholders are trustworthy introducers, along with other information that implementation uses for trust information.
The format of Trust packets is defined by a given implementation.<a class="pilcrow" href="#section-5.10-1">¶</a></p>
<p id="section-5.10-2">Trust packets <span class="bcp14">SHOULD NOT</span> be emitted to output streams that are transferred to other users, and they <span class="bcp14">SHOULD</span> be ignored on any input other than local keyring files.<a class="pilcrow" href="#section-5.10-2">¶</a></p>
</section>
</div>
<div id="uid">
<section id="section-5.11">
        <h3 id="name-user-id-packet-type-id-13">
<a class="section-number selfRef" href="#section-5.11">5.11. </a><a class="section-name selfRef" href="#name-user-id-packet-type-id-13">User ID Packet (Type ID 13)</a>
        </h3>
<p id="section-5.11-1">A User ID packet consists of UTF-8 text that is intended to represent the name and email address of the keyholder.
By convention, it includes a mail name-addr as described in <span>[<a class="cite xref" href="#RFC2822">RFC2822</a>]</span>, but there are no restrictions on its content. The packet length in the header specifies the length of the User ID.<a class="pilcrow" href="#section-5.11-1">¶</a></p>
</section>
</div>
<div id="user-attribute-packet">
<section id="section-5.12">
        <h3 id="name-user-attribute-packet-type-">
<a class="section-number selfRef" href="#section-5.12">5.12. </a><a class="section-name selfRef" href="#name-user-attribute-packet-type-">User Attribute Packet (Type ID 17)</a>
        </h3>
<p id="section-5.12-1">The User Attribute packet is a variation of the User ID packet.
It is capable of storing more types of data than the User ID packet, which is limited to text.
Like the User ID packet, a User Attribute packet may be certified by the key owner ("self-signed") or any other key owner who cares to certify it.
Except as noted, a User Attribute packet may be used anywhere that a User ID packet may be used.<a class="pilcrow" href="#section-5.12-1">¶</a></p>
<p id="section-5.12-2">While User Attribute packets are not a required part of the OpenPGP specification, implementations <span class="bcp14">SHOULD</span> provide at least enough compatibility to properly handle a certification signature on the User Attribute packet.
A simple way to do this is by treating the User Attribute packet as a User ID packet with opaque contents, but an implementation may use any method desired.<a class="pilcrow" href="#section-5.12-2">¶</a></p>
<p id="section-5.12-3">The User Attribute packet is made up of one or more attribute subpackets.
Each subpacket consists of a subpacket header and a body.
The header consists of:<a class="pilcrow" href="#section-5.12-3">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.12-4.1">
            <p id="section-5.12-4.1.1">the subpacket length (1, 2, or 5 octets)<a class="pilcrow" href="#section-5.12-4.1.1">¶</a></p>
</li>
          <li class="normal" id="section-5.12-4.2">
            <p id="section-5.12-4.2.1">the Subpacket Type ID (1 octet)<a class="pilcrow" href="#section-5.12-4.2.1">¶</a></p>
</li>
        </ul>
<p id="section-5.12-5">and is followed by the subpacket specific data.<a class="pilcrow" href="#section-5.12-5">¶</a></p>
<p id="section-5.12-6">The following table lists the currently known subpackets:<a class="pilcrow" href="#section-5.12-6">¶</a></p>
<span id="name-openpgp-user-attribute-subp"></span><div id="user-attr-subpacket-types-registry">
<table class="center" id="table-13">
          <caption>
<a class="selfRef" href="#table-13">Table 13</a>:
<a class="selfRef" href="#name-openpgp-user-attribute-subp">OpenPGP User Attribute Subpacket Types Registry</a>
          </caption>
<thead>
            <tr>
              <th class="text-right" colspan="1" rowspan="1">ID</th>
              <th class="text-left" colspan="1" rowspan="1">Attribute Subpacket</th>
              <th class="text-left" colspan="1" rowspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">Reserved</td>
              <td class="text-left" colspan="1" rowspan="1"></td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">1</td>
              <td class="text-left" colspan="1" rowspan="1">Image Attribute Subpacket</td>
              <td class="text-left" colspan="1" rowspan="1">
                <a class="auto internal xref" href="#uat-image">Section 5.12.1</a>
</td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">100-110</td>
              <td class="text-left" colspan="1" rowspan="1">Private or Experimental Use</td>
              <td class="text-left" colspan="1" rowspan="1"></td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-5.12-8">An implementation <span class="bcp14">SHOULD</span> ignore any subpacket of a type that it does not recognize.<a class="pilcrow" href="#section-5.12-8">¶</a></p>
<div id="uat-image">
<section id="section-5.12.1">
          <h4 id="name-image-attribute-subpacket">
<a class="section-number selfRef" href="#section-5.12.1">5.12.1. </a><a class="section-name selfRef" href="#name-image-attribute-subpacket">Image Attribute Subpacket</a>
          </h4>
<p id="section-5.12.1-1">The Image Attribute subpacket is used to encode an image, presumably (but not required to be) that of the key owner.<a class="pilcrow" href="#section-5.12.1-1">¶</a></p>
<p id="section-5.12.1-2">The Image Attribute subpacket begins with an image header.
The first two octets of the image header contain the length of the image header.
Note that unlike other multi-octet numerical values in this document, due to a historical accident, this value is encoded as a little-endian number. The image header length is followed by a single octet for the image header version.
The only currently defined version of the image header is 1, which is a 16-octet image header.
The first three octets of a version 1 image header are thus 0x10, 0x00, 0x01.<a class="pilcrow" href="#section-5.12.1-2">¶</a></p>
<span id="name-openpgp-image-attribute-ver"></span><div id="image-attribute-version-registry">
<table class="center" id="table-14">
            <caption>
<a class="selfRef" href="#table-14">Table 14</a>:
<a class="selfRef" href="#name-openpgp-image-attribute-ver">OpenPGP Image Attribute Versions Registry</a>
            </caption>
<thead>
              <tr>
                <th class="text-right" colspan="1" rowspan="1">Version</th>
                <th class="text-left" colspan="1" rowspan="1">Reference</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-right" colspan="1" rowspan="1">1</td>
                <td class="text-left" colspan="1" rowspan="1">
                  <a class="auto internal xref" href="#uat-image">Section 5.12.1</a>
</td>
              </tr>
            </tbody>
          </table>
</div>
<p id="section-5.12.1-4">The fourth octet of a version 1 image header designates the encoding format of the image.
The only currently defined encoding format is the value 1 to indicate JPEG.
Image format IDs 100 through 110 are reserved for Private or Experimental Use.
The rest of the version 1 image header is made up of 12 reserved octets, all of which <span class="bcp14">MUST</span> be set to 0.<a class="pilcrow" href="#section-5.12.1-4">¶</a></p>
<span id="name-openpgp-image-attribute-enc"></span><div id="image-attr-encoding-format-registry">
<table class="center" id="table-15">
            <caption>
<a class="selfRef" href="#table-15">Table 15</a>:
<a class="selfRef" href="#name-openpgp-image-attribute-enc">OpenPGP Image Attribute Encoding Format Registry</a>
            </caption>
<thead>
              <tr>
                <th class="text-right" colspan="1" rowspan="1">ID</th>
                <th class="text-left" colspan="1" rowspan="1">Encoding</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-right" colspan="1" rowspan="1">0</td>
                <td class="text-left" colspan="1" rowspan="1">Reserved</td>
              </tr>
              <tr>
                <td class="text-right" colspan="1" rowspan="1">1</td>
                <td class="text-left" colspan="1" rowspan="1">JPEG <span>[<a class="cite xref" href="#JFIF">JFIF</a>]</span>
</td>
              </tr>
              <tr>
                <td class="text-right" colspan="1" rowspan="1">100-110</td>
                <td class="text-left" colspan="1" rowspan="1">Private or Experimental Use</td>
              </tr>
            </tbody>
          </table>
</div>
<p id="section-5.12.1-6">The rest of the image subpacket contains the image itself.
As the only currently defined image type is JPEG, the image is encoded in the JPEG File Interchange Format (JFIF), a standard file format for JPEG images <span>[<a class="cite xref" href="#JFIF">JFIF</a>]</span>.<a class="pilcrow" href="#section-5.12.1-6">¶</a></p>
<p id="section-5.12.1-7">An implementation <span class="bcp14">MAY</span> try to determine the type of an image by examination of the image data if it is unable to handle a particular version of the image header or if a specified encoding format value is not recognized.<a class="pilcrow" href="#section-5.12.1-7">¶</a></p>
</section>
</div>
</section>
</div>
<div id="seipd">
<section id="section-5.13">
        <h3 id="name-symmetrically-encrypted-and">
<a class="section-number selfRef" href="#section-5.13">5.13. </a><a class="section-name selfRef" href="#name-symmetrically-encrypted-and">Symmetrically Encrypted and Integrity Protected Data Packet (Type ID 18)</a>
        </h3>
<p id="section-5.13-1">The SEIPD packet contains integrity-protected and encrypted data.
When it has been decrypted, it will contain other packets forming an OpenPGP Message (see <a class="auto internal xref" href="#openpgp-messages">Section 10.3</a>).<a class="pilcrow" href="#section-5.13-1">¶</a></p>
<p id="section-5.13-2">The first octet of this packet is always used to indicate the version number, but different versions contain ciphertext that is structured differently. Version 1 of this packet contains data encrypted with a symmetric key algorithm and is thus protected against modification by the SHA-1 hash algorithm. This mechanism was introduced in <span>[<a class="cite xref" href="#RFC4880">RFC4880</a>]</span> and offers some protections against ciphertext malleability.<a class="pilcrow" href="#section-5.13-2">¶</a></p>
<p id="section-5.13-3">Version 2 of this packet contains data encrypted with an AEAD construction.
This offers a more cryptographically rigorous defense against ciphertext malleability.
See <a class="auto internal xref" href="#ciphertext-malleability">Section 13.7</a> for more details on choosing between these formats.<a class="pilcrow" href="#section-5.13-3">¶</a></p>
<p id="section-5.13-4">Any new version of the SEIPD packet should be registered in the registry established in <a class="auto internal xref" href="#encrypted-message-versions">Section 10.3.2.1</a>.<a class="pilcrow" href="#section-5.13-4">¶</a></p>
<div id="version-one-seipd">
<section id="section-5.13.1">
          <h4 id="name-version-1-symmetrically-enc">
<a class="section-number selfRef" href="#section-5.13.1">5.13.1. </a><a class="section-name selfRef" href="#name-version-1-symmetrically-enc">Version 1 Symmetrically Encrypted and Integrity Protected Data Packet Format</a>
          </h4>
<p id="section-5.13.1-1">A version 1 Symmetrically Encrypted and Integrity Protected Data packet consists of:<a class="pilcrow" href="#section-5.13.1-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.13.1-2.1">
              <p id="section-5.13.1-2.1.1">A 1-octet version number with value 1.<a class="pilcrow" href="#section-5.13.1-2.1.1">¶</a></p>
</li>
            <li class="normal" id="section-5.13.1-2.2">
              <p id="section-5.13.1-2.2.1">Encrypted data -- the output of the selected symmetric key cipher operating in CFB mode.<a class="pilcrow" href="#section-5.13.1-2.2.1">¶</a></p>
</li>
          </ul>
<p id="section-5.13.1-3">The symmetric cipher used <span class="bcp14">MUST</span> be specified in a Public Key or Symmetric Key Encrypted Session Key packet that precedes the Symmetrically Encrypted and Integrity Protected Data packet. In either case, the cipher algorithm ID is prefixed to the session key before it is encrypted.<a class="pilcrow" href="#section-5.13.1-3">¶</a></p>
<p id="section-5.13.1-4">The data is encrypted in CFB mode (see <a class="auto internal xref" href="#cfb-mode">Section 12.9</a>). The IV is specified as all zeros. Instead of achieving randomized encryption through an IV, OpenPGP prefixes an octet string to the data before it is encrypted for this purpose.
The length of the octet string equals the block size of the cipher in octets, plus two.
The first octets in the group, of length equal to the block size of the cipher, are random; the last two octets are each copies of their 2nd preceding octet.
For example, with a cipher whose block size is 128 bits or 16 octets, the prefix data will contain 16 random octets, then two more octets, which are copies of the 15th and 16th octets, respectively.
Unlike the deprecated Symmetrically Encrypted Data packet (<a class="auto internal xref" href="#sed">Section 5.7</a>), this prefix data is encrypted in the same CFB context, and no special CFB resynchronization is done.<a class="pilcrow" href="#section-5.13.1-4">¶</a></p>
<p id="section-5.13.1-5">The repetition of 16 bits in the random data prefixed to the message allows the receiver to immediately check whether the session key is incorrect.
See <a class="auto internal xref" href="#quick-check-oracle">Section 13.4</a> for hints on the proper use of this "quick check".<a class="pilcrow" href="#section-5.13.1-5">¶</a></p>
<p id="section-5.13.1-6">Two constant octets with the values 0xD3 and 0x14 are appended to the plaintext. Then, the plaintext of the data to be encrypted is passed through the SHA-1 hash function. The input to the hash function is comprised of the prefix data described above and all of the plaintext, including the trailing constant octets 0xD3, 0x14.
The 20 octets of the SHA-1 hash are then appended to the plaintext (after the constant octets 0xD3, 0x14) and encrypted along with the plaintext using the same CFB context.
This trailing checksum is known as the Modification Detection Code (MDC).<a class="pilcrow" href="#section-5.13.1-6">¶</a></p>
<p id="section-5.13.1-7">During decryption, the plaintext data should be hashed with SHA-1, including the prefix data as well as the trailing constant octets 0xD3, 0x14, but excluding the last 20 octets containing the SHA-1 hash. The computed SHA-1 hash is then compared with the last 20 octets of plaintext.
A mismatch of the hash indicates that the message has been modified and <span class="bcp14">MUST</span> be treated as a security problem. Any failure <span class="bcp14">SHOULD</span> be reported to the user.<a class="pilcrow" href="#section-5.13.1-7">¶</a></p>
<p id="section-5.13.1-8" style="margin-left: 1.5em">NON-NORMATIVE EXPLANATION<a class="pilcrow" href="#section-5.13.1-8">¶</a></p>
<p id="section-5.13.1-9" style="margin-left: 1.5em">The MDC system, as the integrity
  protection mechanism of the version 1 Symmetrically Encrypted
  and Integrity Protected Data packet is called, was created to
  provide an integrity mechanism that is less strong than a
  signature, yet stronger than bare CFB encryption.<a class="pilcrow" href="#section-5.13.1-9">¶</a></p>
<p id="section-5.13.1-10" style="margin-left: 1.5em">CFB encryption has a limitation as damage to the ciphertext
  will corrupt the affected cipher blocks and the block following.
  Additionally, if data is removed from the end of a CFB-encrypted
  block, that removal is undetectable.  (Note also that CBC mode has
  a similar limitation, but data removed from the front of the block
  is undetectable.)<a class="pilcrow" href="#section-5.13.1-10">¶</a></p>
<p id="section-5.13.1-11" style="margin-left: 1.5em">The obvious way to protect or authenticate an encrypted block is
  to digitally sign it.  However, many people do not wish to
  habitually sign data for a large number of reasons that are beyond the
  scope of this document.  Suffice it to say that many people
  consider properties such as deniability to be as valuable as
  integrity.<a class="pilcrow" href="#section-5.13.1-11">¶</a></p>
<p id="section-5.13.1-12" style="margin-left: 1.5em">OpenPGP addresses this desire to have more security than raw
  encryption and yet preserve deniability with the MDC system.  An
  MDC is intentionally not a Message Authentication Code (MAC).  Its name was not selected by
  accident.  It is analogous to a checksum.<a class="pilcrow" href="#section-5.13.1-12">¶</a></p>
<p id="section-5.13.1-13" style="margin-left: 1.5em">Despite the fact that it is a relatively modest system, it has
  proved itself in the real world.  It is an effective defense to
  several attacks that have surfaced since it has been created.  It
  has met its modest goals admirably.<a class="pilcrow" href="#section-5.13.1-13">¶</a></p>
<p id="section-5.13.1-14" style="margin-left: 1.5em">Consequently, because it is a modest security system, it has
  modest requirements on the hash function(s) it employs.  It does
  not rely on a hash function being collision-free; it relies on a
  hash function being one-way.  If a forger, Frank, wishes to send
  Alice a (digitally) unsigned message that says, "I've always
  secretly loved you, signed Bob", it is far easier for him to
  construct a new message than it is to modify anything intercepted
  from Bob.  (Note also that if Bob wishes to communicate secretly
  with Alice, but without authentication or identification and with
  a threat model that includes forgers, he has a problem that
  transcends mere cryptography.)<a class="pilcrow" href="#section-5.13.1-14">¶</a></p>
<p id="section-5.13.1-15" style="margin-left: 1.5em">Note also that unlike nearly every other OpenPGP subsystem, there
  are no parameters in the MDC system.  It hard-defines SHA-1 as its
  hash function.  This is not an accident.  It is an intentional
  choice to avoid downgrade and cross-grade attacks while making a
  simple, fast system.  (A downgrade attack is an attack that would
  replace SHA2-256 with SHA-1, for example.  A cross-grade attack
  would replace SHA-1 with another 160-bit hash, such as
  RIPEMD-160, for example.)<a class="pilcrow" href="#section-5.13.1-15">¶</a></p>
<p id="section-5.13.1-16" style="margin-left: 1.5em">However, no update will be needed because the MDC has been replaced
  by the AEAD encryption described in this document.<a class="pilcrow" href="#section-5.13.1-16">¶</a></p>
</section>
</div>
<div id="version-two-seipd">
<section id="section-5.13.2">
          <h4 id="name-version-2-symmetrically-enc">
<a class="section-number selfRef" href="#section-5.13.2">5.13.2. </a><a class="section-name selfRef" href="#name-version-2-symmetrically-enc">Version 2 Symmetrically Encrypted and Integrity Protected Data Packet Format</a>
          </h4>
<p id="section-5.13.2-1">A version 2 Symmetrically Encrypted and Integrity Protected Data packet consists of:<a class="pilcrow" href="#section-5.13.2-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.13.2-2.1">
              <p id="section-5.13.2-2.1.1">A 1-octet version number with value 2.<a class="pilcrow" href="#section-5.13.2-2.1.1">¶</a></p>
</li>
            <li class="normal" id="section-5.13.2-2.2">
              <p id="section-5.13.2-2.2.1">A 1-octet cipher algorithm ID.<a class="pilcrow" href="#section-5.13.2-2.2.1">¶</a></p>
</li>
            <li class="normal" id="section-5.13.2-2.3">
              <p id="section-5.13.2-2.3.1">A 1-octet AEAD algorithm identifier.<a class="pilcrow" href="#section-5.13.2-2.3.1">¶</a></p>
</li>
            <li class="normal" id="section-5.13.2-2.4">
              <p id="section-5.13.2-2.4.1">A 1-octet chunk size.<a class="pilcrow" href="#section-5.13.2-2.4.1">¶</a></p>
</li>
            <li class="normal" id="section-5.13.2-2.5">
              <p id="section-5.13.2-2.5.1">32 octets of salt.
The salt is used to derive the message key and <span class="bcp14">MUST</span> be securely generated (see <a class="auto internal xref" href="#CSPRNG">Section 13.10</a>).<a class="pilcrow" href="#section-5.13.2-2.5.1">¶</a></p>
</li>
            <li class="normal" id="section-5.13.2-2.6">
              <p id="section-5.13.2-2.6.1">Encrypted data; that is, the output of the selected symmetric key cipher operating in the given AEAD mode.<a class="pilcrow" href="#section-5.13.2-2.6.1">¶</a></p>
</li>
            <li class="normal" id="section-5.13.2-2.7">
              <p id="section-5.13.2-2.7.1">A final summary authentication tag for the AEAD mode.<a class="pilcrow" href="#section-5.13.2-2.7.1">¶</a></p>
</li>
          </ul>
<p id="section-5.13.2-3">The decrypted session key and the salt are used to derive an M-bit message key and N-64 bits used as the IV, where M is the key size of the symmetric algorithm and N is the nonce size of the AEAD algorithm. M + N - 64 bits are derived using HKDF (see <span>[<a class="cite xref" href="#RFC5869">RFC5869</a>]</span>). The leftmost M bits are used as a symmetric algorithm key, and the remaining N - 64 bits are used as an IV. HKDF is used with SHA256 <span>[<a class="cite xref" href="#RFC6234">RFC6234</a>]</span> as hash algorithm. The session key is used as IKM and the salt as salt. The Packet Type ID in OpenPGP format encoding (bits 7 and 6 are set, and bits 5-0 carry the Packet Type ID), version number, cipher algorithm ID, AEAD algorithm ID, and chunk size octet are used as info parameter.<a class="pilcrow" href="#section-5.13.2-3">¶</a></p>
<p id="section-5.13.2-4">The KDF mechanism provides key separation between cipher and AEAD algorithms.
Furthermore, an implementation can securely reply to a message even if a recipient's certificate is unknown by reusing the Encrypted Session Key packets and replying with a different salt that yields a new, unique message key.
See <a class="auto internal xref" href="#secure-sessionkey-reuse">Section 13.8</a> for guidance on how applications can securely implement this feature.<a class="pilcrow" href="#section-5.13.2-4">¶</a></p>
<p id="section-5.13.2-5">A v2 SEIPD packet consists of one or more chunks of data. The plaintext of each chunk is of a size specified by the chunk size octet using the method specified below.<a class="pilcrow" href="#section-5.13.2-5">¶</a></p>
<p id="section-5.13.2-6">The encrypted data consists of the encryption of each chunk of plaintext, followed immediately by the relevant authentication tag. If the last chunk of plaintext is smaller than the chunk size, the ciphertext for that data may be shorter; nevertheless, it is followed by a full authentication tag.<a class="pilcrow" href="#section-5.13.2-6">¶</a></p>
<p id="section-5.13.2-7">For each chunk, the AEAD construction is given the Packet Type ID encoded in OpenPGP format (bits 7 and 6 are set, and bits 5-0 carry the Packet Type ID), version number, cipher algorithm ID, AEAD algorithm ID, and chunk size octet as additional data.
For example, the additional data of the first chunk using EAX and AES-128 with a chunk size of 2<sup>22</sup> octets consists of the octets 0xD2, 0x02, 0x07, 0x01, and 0x10.<a class="pilcrow" href="#section-5.13.2-7">¶</a></p>
<p id="section-5.13.2-8">After the final chunk, the AEAD algorithm is used to produce a final authentication tag encrypting the empty string.
This AEAD instance is given the additional data specified above, plus an 8-octet, big-endian value specifying the total number of plaintext octets encrypted. This allows detection of a truncated ciphertext.<a class="pilcrow" href="#section-5.13.2-8">¶</a></p>
<p id="section-5.13.2-9">The chunk size octet specifies the size of chunks using the following formula (in C <span>[<a class="cite xref" href="#C99">C99</a>]</span>), where c is the chunk size octet:<a class="pilcrow" href="#section-5.13.2-9">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.13.2-10">
<pre>  chunk_size = (uint32_t) 1 &lt;&lt; (c + 6)
</pre><a class="pilcrow" href="#section-5.13.2-10">¶</a>
</div>
<p id="section-5.13.2-11">An implementation <span class="bcp14">MUST</span> accept chunk size octets with values from 0 to 16.
An implementation <span class="bcp14">MUST NOT</span> create data with a chunk size octet value larger than 16 (4 MiB chunks).<a class="pilcrow" href="#section-5.13.2-11">¶</a></p>
<p id="section-5.13.2-12">The nonce for AEAD mode consists of two parts.
Let N be the size of the nonce. The leftmost N - 64 bits are the IV derived using HKDF.
The rightmost 64 bits are the chunk index as a big-endian value.
The index of the first chunk is zero.<a class="pilcrow" href="#section-5.13.2-12">¶</a></p>
</section>
</div>
<div id="aead-mode-eax">
<section id="section-5.13.3">
          <h4 id="name-eax-mode">
<a class="section-number selfRef" href="#section-5.13.3">5.13.3. </a><a class="section-name selfRef" href="#name-eax-mode">EAX Mode</a>
          </h4>
<p id="section-5.13.3-1">The EAX AEAD algorithm used in this document is defined in <span>[<a class="cite xref" href="#EAX">EAX</a>]</span>.<a class="pilcrow" href="#section-5.13.3-1">¶</a></p>
<p id="section-5.13.3-2">The EAX algorithm can only use block ciphers with 16-octet blocks.
The nonce is 16 octets long.
EAX authentication tags are 16 octets long.<a class="pilcrow" href="#section-5.13.3-2">¶</a></p>
</section>
</div>
<div id="aead-mode-ocb">
<section id="section-5.13.4">
          <h4 id="name-ocb-mode">
<a class="section-number selfRef" href="#section-5.13.4">5.13.4. </a><a class="section-name selfRef" href="#name-ocb-mode">OCB Mode</a>
          </h4>
<p id="section-5.13.4-1">The OCB AEAD algorithm used in this document is defined in <span>[<a class="cite xref" href="#RFC7253">RFC7253</a>]</span>.<a class="pilcrow" href="#section-5.13.4-1">¶</a></p>
<p id="section-5.13.4-2">The OCB algorithm can only use block ciphers with 16-octet blocks.
The nonce is 15 octets long.
OCB authentication tags are 16 octets long.<a class="pilcrow" href="#section-5.13.4-2">¶</a></p>
</section>
</div>
<div id="aead-mode-gcm">
<section id="section-5.13.5">
          <h4 id="name-gcm-mode">
<a class="section-number selfRef" href="#section-5.13.5">5.13.5. </a><a class="section-name selfRef" href="#name-gcm-mode">GCM Mode</a>
          </h4>
<p id="section-5.13.5-1">The GCM AEAD algorithm used in this document is defined in <span>[<a class="cite xref" href="#SP800-38D">SP800-38D</a>]</span>.<a class="pilcrow" href="#section-5.13.5-1">¶</a></p>
<p id="section-5.13.5-2">The GCM algorithm can only use block ciphers with 16-octet blocks.
The nonce is 12 octets long.
GCM authentication tags are 16 octets long.<a class="pilcrow" href="#section-5.13.5-2">¶</a></p>
</section>
</div>
</section>
</div>
<div id="padding-packet">
<section id="section-5.14">
        <h3 id="name-padding-packet-type-id-21">
<a class="section-number selfRef" href="#section-5.14">5.14. </a><a class="section-name selfRef" href="#name-padding-packet-type-id-21">Padding Packet (Type ID 21)</a>
        </h3>
<p id="section-5.14-1">The Padding packet contains random data and can be used to defend against traffic analysis (see <a class="auto internal xref" href="#traffic-analysis">Section 13.11</a>) on v2 SEIPD messages (see <a class="auto internal xref" href="#version-two-seipd">Section 5.13.2</a>) and Transferable Public Keys (see <a class="auto internal xref" href="#transferable-public-keys">Section 10.1</a>).<a class="pilcrow" href="#section-5.14-1">¶</a></p>
<p id="section-5.14-2">Such a packet <span class="bcp14">MUST</span> be ignored when received.<a class="pilcrow" href="#section-5.14-2">¶</a></p>
<p id="section-5.14-3">Its contents <span class="bcp14">SHOULD</span> be random octets to make the length obfuscation it provides more robust even when compressed.<a class="pilcrow" href="#section-5.14-3">¶</a></p>
<p id="section-5.14-4">An implementation adding padding to an OpenPGP stream <span class="bcp14">SHOULD</span> place such a packet:<a class="pilcrow" href="#section-5.14-4">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.14-5.1">
            <p id="section-5.14-5.1.1">At the end of a version 6 Transferable Public Key that is transferred over an encrypted channel (see <a class="auto internal xref" href="#transferable-public-keys">Section 10.1</a>).<a class="pilcrow" href="#section-5.14-5.1.1">¶</a></p>
</li>
          <li class="normal" id="section-5.14-5.2">
            <p id="section-5.14-5.2.1">As the last packet of an Optionally Padded Message within a version 2 Symmetrically Encrypted and Integrity Protected Data packet (see <a class="auto internal xref" href="#unwrapping">Section 10.3.1</a>).<a class="pilcrow" href="#section-5.14-5.2.1">¶</a></p>
</li>
        </ul>
<p id="section-5.14-6">An implementation <span class="bcp14">MUST</span> be able to process Padding packets anywhere else in an OpenPGP stream so that future revisions of this document may specify further locations for padding.<a class="pilcrow" href="#section-5.14-6">¶</a></p>
<p id="section-5.14-7">Policy about how large to make such a packet to defend against traffic analysis is beyond the scope of this document.<a class="pilcrow" href="#section-5.14-7">¶</a></p>
</section>
</div>
</section>
</div>
<div id="base64">
<section id="section-6">
      <h2 id="name-base64-conversions">
<a class="section-number selfRef" href="#section-6">6. </a><a class="section-name selfRef" href="#name-base64-conversions">Base64 Conversions</a>
      </h2>
<p id="section-6-1">As stated in the introduction, OpenPGP's underlying representation for objects is a stream of arbitrary octets, and some systems desire these objects to be immune to damage caused by character set translation, data conversions, etc.<a class="pilcrow" href="#section-6-1">¶</a></p>
<p id="section-6-2">In principle, any printable encoding scheme that met the requirements of the unsafe channel would suffice, since it would not change the underlying binary bit streams of the OpenPGP data structures.
The OpenPGP specification specifies one such printable encoding scheme to ensure interoperability; see <a class="auto internal xref" href="#forming-ascii-armor">Section 6.2</a>.<a class="pilcrow" href="#section-6-2">¶</a></p>
<p id="section-6-3">The encoding is composed of two parts: a base64 encoding of the binary data and an optional checksum.
The base64 encoding used is described in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc4648#section-4">Section 4</a> of [<a class="cite xref" href="#RFC4648">RFC4648</a>]</span>, and it is wrapped into lines of no more than 76 characters each.<a class="pilcrow" href="#section-6-3">¶</a></p>
<p id="section-6-4">When decoding base64, an OpenPGP implementation <span class="bcp14">MUST</span> ignore all whitespace.<a class="pilcrow" href="#section-6-4">¶</a></p>
<div id="optional-crc24">
<section id="section-6.1">
        <h3 id="name-optional-checksum">
<a class="section-number selfRef" href="#section-6.1">6.1. </a><a class="section-name selfRef" href="#name-optional-checksum">Optional Checksum</a>
        </h3>
<p id="section-6.1-1">The optional checksum is a 24-bit Cyclic Redundancy Check (CRC) converted to four characters of base64 encoding by the same MIME base64 transformation, preceded by an equal sign (=). The CRC is computed by using the generator 0x864CFB and an initialization of 0xB704CE. The accumulation is done on the data before it is converted to base64 rather than on the converted data. A sample implementation of this algorithm is in <a class="auto internal xref" href="#sample-crc24">Section 6.1.1</a>.<a class="pilcrow" href="#section-6.1-1">¶</a></p>
<p id="section-6.1-2">If present, the checksum with its leading equal sign <span class="bcp14">MUST</span> appear on the next line after the base64-encoded data.<a class="pilcrow" href="#section-6.1-2">¶</a></p>
<p id="section-6.1-3">An implementation <span class="bcp14">MUST NOT</span> reject an OpenPGP object when the CRC24 footer is present, missing, malformed, or disagrees with the computed CRC24 sum. When forming ASCII Armor, the CRC24 footer <span class="bcp14">SHOULD NOT</span> be generated, unless interoperability with implementations that require the CRC24 footer to be present is a concern.<a class="pilcrow" href="#section-6.1-3">¶</a></p>
<p id="section-6.1-4">The CRC24 footer <span class="bcp14">MUST NOT</span> be generated if it can be determined by the context or by the OpenPGP object being encoded that the consuming implementation accepts base64-encoded blocks without a CRC24 footer. Notably:<a class="pilcrow" href="#section-6.1-4">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1-5.1">
            <p id="section-6.1-5.1.1">An ASCII-armored Encrypted Message packet sequence that ends in a v2 SEIPD packet <span class="bcp14">MUST NOT</span> contain a CRC24 footer.<a class="pilcrow" href="#section-6.1-5.1.1">¶</a></p>
</li>
          <li class="normal" id="section-6.1-5.2">
            <p id="section-6.1-5.2.1">An ASCII-armored sequence of Signature packets that only includes version 6 Signature packets <span class="bcp14">MUST NOT</span> contain a CRC24 footer.<a class="pilcrow" href="#section-6.1-5.2.1">¶</a></p>
</li>
          <li class="normal" id="section-6.1-5.3">
            <p id="section-6.1-5.3.1">An ASCII-armored Transferable Public Key packet sequence of a version 6 key <span class="bcp14">MUST NOT</span> contain a CRC24 footer.<a class="pilcrow" href="#section-6.1-5.3.1">¶</a></p>
</li>
          <li class="normal" id="section-6.1-5.4">
            <p id="section-6.1-5.4.1">An ASCII-armored keyring consisting of only version 6 keys <span class="bcp14">MUST NOT</span> contain a CRC24 footer.<a class="pilcrow" href="#section-6.1-5.4.1">¶</a></p>
</li>
        </ul>
<p id="section-6.1-6">Rationale:
Previous draft versions of this document stated that the CRC24 footer is optional, but the text was ambiguous. In practice, very few implementations require the CRC24 footer to be present. Computing the CRC24 incurs a significant cost, while providing no meaningful integrity protection.
Therefore, generating it is now discouraged.<a class="pilcrow" href="#section-6.1-6">¶</a></p>
<div id="sample-crc24">
<section id="section-6.1.1">
          <h4 id="name-an-implementation-of-the-cr">
<a class="section-number selfRef" href="#section-6.1.1">6.1.1. </a><a class="section-name selfRef" href="#name-an-implementation-of-the-cr">An Implementation of the CRC24 in "C"</a>
          </h4>
<p id="section-6.1.1-1">The following code is written in <span>[<a class="cite xref" href="#C99">C99</a>]</span>.<a class="pilcrow" href="#section-6.1.1-1">¶</a></p>
<div class="lang-text/c sourcecode" id="section-6.1.1-2">
<pre>#define CRC24_INIT 0xB704CEL
#define CRC24_GENERATOR 0x864CFBL

typedef unsigned long crc24;
crc24 crc_octets(unsigned char *octets, size_t len)
{
    crc24 crc = CRC24_INIT;
    int i;
    while (len--) {
        crc ^= (*octets++) &lt;&lt; 16;
        for (i = 0; i &lt; 8; i++) {
            crc &lt;&lt;= 1;
            if (crc &amp; 0x1000000) {
                crc &amp;= 0XFFFFFF; /* Clear bit 25 to avoid overflow */
                crc ^= CRC24_GENERATOR;
            }
        }
    }
    return crc &amp; 0xFFFFFFL;
}
</pre><a class="pilcrow" href="#section-6.1.1-2">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="forming-ascii-armor">
<section id="section-6.2">
        <h3 id="name-forming-ascii-armor">
<a class="section-number selfRef" href="#section-6.2">6.2. </a><a class="section-name selfRef" href="#name-forming-ascii-armor">Forming ASCII Armor</a>
        </h3>
<p id="section-6.2-1">When OpenPGP encodes data into ASCII Armor, it puts specific headers around the base64-encoded data, so OpenPGP can reconstruct the data later.
An OpenPGP implementation <span class="bcp14">MAY</span> use ASCII Armor to protect raw binary data.
OpenPGP informs the user what kind of data is encoded in the ASCII Armor through the use of the headers.<a class="pilcrow" href="#section-6.2-1">¶</a></p>
<p id="section-6.2-2">Concatenating the following data creates ASCII Armor:<a class="pilcrow" href="#section-6.2-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2-3.1">
            <p id="section-6.2-3.1.1">An Armor Header Line, appropriate for the type of data<a class="pilcrow" href="#section-6.2-3.1.1">¶</a></p>
</li>
          <li class="normal" id="section-6.2-3.2">
            <p id="section-6.2-3.2.1">Armor Headers<a class="pilcrow" href="#section-6.2-3.2.1">¶</a></p>
</li>
          <li class="normal" id="section-6.2-3.3">
            <p id="section-6.2-3.3.1">A blank (zero length or containing only whitespace) line<a class="pilcrow" href="#section-6.2-3.3.1">¶</a></p>
</li>
          <li class="normal" id="section-6.2-3.4">
            <p id="section-6.2-3.4.1">The ASCII-Armored data<a class="pilcrow" href="#section-6.2-3.4.1">¶</a></p>
</li>
          <li class="normal" id="section-6.2-3.5">
            <p id="section-6.2-3.5.1">An optional Armor Checksum (discouraged; see <a class="auto internal xref" href="#optional-crc24">Section 6.1</a>)<a class="pilcrow" href="#section-6.2-3.5.1">¶</a></p>
</li>
          <li class="normal" id="section-6.2-3.6">
            <p id="section-6.2-3.6.1">The Armor Tail, which depends on the Armor Header Line<a class="pilcrow" href="#section-6.2-3.6.1">¶</a></p>
</li>
        </ul>
<div id="armor-header-line">
<section id="section-6.2.1">
          <h4 id="name-armor-header-line">
<a class="section-number selfRef" href="#section-6.2.1">6.2.1. </a><a class="section-name selfRef" href="#name-armor-header-line">Armor Header Line</a>
          </h4>
<p id="section-6.2.1-1">An Armor Header Line consists of the appropriate header line text surrounded by five (5) dashes (<code>-</code>, 0x2D) on either side of the header line text. The header line text is chosen based on the type of data being encoded in Armor and how it is being encoded.
Header line texts include the following strings:<a class="pilcrow" href="#section-6.2.1-1">¶</a></p>
<span id="name-openpgp-armor-header-lines-"></span><div id="armor-header-line-registry">
<table class="center" id="table-16">
            <caption>
<a class="selfRef" href="#table-16">Table 16</a>:
<a class="selfRef" href="#name-openpgp-armor-header-lines-">OpenPGP Armor Header Lines Registry</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" colspan="1" rowspan="1">Armor Header</th>
                <th class="text-left" colspan="1" rowspan="1">Use</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">
                  <code>BEGIN PGP MESSAGE</code>
</td>
                <td class="text-left" colspan="1" rowspan="1">Used for signed, encrypted, or compressed files.</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">
                  <code>BEGIN PGP PUBLIC KEY BLOCK</code>
</td>
                <td class="text-left" colspan="1" rowspan="1">Used for armoring public keys.</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">
                  <code>BEGIN PGP PRIVATE KEY BLOCK</code>
</td>
                <td class="text-left" colspan="1" rowspan="1">Used for armoring private keys.</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">
                  <code>BEGIN PGP SIGNATURE</code>
</td>
                <td class="text-left" colspan="1" rowspan="1">Used for detached signatures, OpenPGP/MIME signatures, and cleartext signatures.</td>
              </tr>
            </tbody>
          </table>
</div>
<p id="section-6.2.1-3">Note that all of these Armor Header Lines are to consist of a complete line.
Therefore, the header lines <span class="bcp14">MUST</span> start at the beginning of a line and <span class="bcp14">MUST NOT</span> have text other than whitespace following them on the same line.<a class="pilcrow" href="#section-6.2.1-3">¶</a></p>
</section>
</div>
<div id="armor-headers">
<section id="section-6.2.2">
          <h4 id="name-armor-headers">
<a class="section-number selfRef" href="#section-6.2.2">6.2.2. </a><a class="section-name selfRef" href="#name-armor-headers">Armor Headers</a>
          </h4>
<p id="section-6.2.2-1">The Armor Headers are pairs of strings that can give the user or the receiving OpenPGP implementation some information about how to decode or use the message. The Armor Headers are a part of the armor, not the message, and hence are not protected by any signatures applied to the message.<a class="pilcrow" href="#section-6.2.2-1">¶</a></p>
<p id="section-6.2.2-2">The format of an Armor Header is that of a key-value pair. A colon (<code>:</code> 0x3A) and a single space (0x20) separate the key and value.
An OpenPGP implementation may consider improperly formatted Armor Headers to be a corruption of the ASCII Armor, but it <span class="bcp14">SHOULD</span> make an effort to recover. Unknown keys should be silently ignored, and an OpenPGP implementation <span class="bcp14">SHOULD</span> continue to process the message.<a class="pilcrow" href="#section-6.2.2-2">¶</a></p>
<p id="section-6.2.2-3">Note that some transport methods are sensitive to line length.
For example, the SMTP protocol that transports email messages has a line length limit of 998 characters (see <span><a class="relref" href="https://rfc-editor.org/rfc/rfc5322#section-2.1.1">Section 2.1.1</a> of [<a class="cite xref" href="#RFC5322">RFC5322</a>]</span>).<a class="pilcrow" href="#section-6.2.2-3">¶</a></p>
<p id="section-6.2.2-4">While there is a limit of 76 characters for the base64 data (<a class="auto internal xref" href="#base64">Section 6</a>), there is no limit for the length of Armor Headers.
Care should be taken to ensure that the Armor Headers are short enough to survive transport.
One way to do this is to repeat an Armor Header Key multiple times with different values for each so that no one line is overly long.<a class="pilcrow" href="#section-6.2.2-4">¶</a></p>
<p id="section-6.2.2-5">Currently defined Armor Header Keys are as follows:<a class="pilcrow" href="#section-6.2.2-5">¶</a></p>
<span id="name-openpgp-armor-header-keys-r"></span><div id="armor-header-key-registry">
<table class="center" id="table-17">
            <caption>
<a class="selfRef" href="#table-17">Table 17</a>:
<a class="selfRef" href="#name-openpgp-armor-header-keys-r">OpenPGP Armor Header Keys Registry</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" colspan="1" rowspan="1">Key</th>
                <th class="text-left" colspan="1" rowspan="1">Summary</th>
                <th class="text-left" colspan="1" rowspan="1">Reference</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">
                  <code>Version</code>
</td>
                <td class="text-left" colspan="1" rowspan="1">Implementation information</td>
                <td class="text-left" colspan="1" rowspan="1">
                  <a class="auto internal xref" href="#armor-header-key-version">Section 6.2.2.1</a>
</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">
                  <code>Comment</code>
</td>
                <td class="text-left" colspan="1" rowspan="1">Arbitrary text</td>
                <td class="text-left" colspan="1" rowspan="1">
                  <a class="auto internal xref" href="#armor-header-key-comment">Section 6.2.2.2</a>
</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">
                  <code>Hash</code>
</td>
                <td class="text-left" colspan="1" rowspan="1">Hash algorithms used in some v4 cleartext signed messages</td>
                <td class="text-left" colspan="1" rowspan="1">
                  <a class="auto internal xref" href="#armor-header-key-hash">Section 6.2.2.3</a>
</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">
                  <code>Charset</code>
</td>
                <td class="text-left" colspan="1" rowspan="1">Character set</td>
                <td class="text-left" colspan="1" rowspan="1">
                  <a class="auto internal xref" href="#armor-header-key-charset">Section 6.2.2.4</a>
</td>
              </tr>
            </tbody>
          </table>
</div>
<div id="armor-header-key-version">
<section id="section-6.2.2.1">
            <h5 id="name-version-armor-header">
<a class="section-number selfRef" href="#section-6.2.2.1">6.2.2.1. </a><a class="section-name selfRef" href="#name-version-armor-header">"Version" Armor Header</a>
            </h5>
<p id="section-6.2.2.1-1">The Armor Header Key <code>Version</code> describes the OpenPGP implementation and version used to encode the message.
To minimize metadata, implementations <span class="bcp14">SHOULD NOT</span> emit this key and its corresponding value except for debugging purposes with explicit user consent.<a class="pilcrow" href="#section-6.2.2.1-1">¶</a></p>
</section>
</div>
<div id="armor-header-key-comment">
<section id="section-6.2.2.2">
            <h5 id="name-comment-armor-header">
<a class="section-number selfRef" href="#section-6.2.2.2">6.2.2.2. </a><a class="section-name selfRef" href="#name-comment-armor-header">"Comment" Armor Header</a>
            </h5>
<p id="section-6.2.2.2-1">The Armor Header Key <code>Comment</code> supplies a user-defined comment.
     OpenPGP defines all text to be in UTF-8. A comment may be any UTF-8 string. However, the whole point of armoring is to provide 7-bit clean data. Consequently, if a comment has characters that are outside the ASCII range of UTF-8, they may very well not survive transport.<a class="pilcrow" href="#section-6.2.2.2-1">¶</a></p>
</section>
</div>
<div id="armor-header-key-hash">
<section id="section-6.2.2.3">
            <h5 id="name-hash-armor-header">
<a class="section-number selfRef" href="#section-6.2.2.3">6.2.2.3. </a><a class="section-name selfRef" href="#name-hash-armor-header">"Hash" Armor Header</a>
            </h5>
<p id="section-6.2.2.3-1">The Armor Header Key <code>Hash</code> is deprecated, but some older implementations expect it in messages using the Cleartext Signature Framework (<a class="auto internal xref" href="#cleartext-signature">Section 7</a>). When present, this Armor Header Key contains a comma-separated list of hash algorithms used in the signatures on message, with digest names as specified in the "Text Name" column in <a class="auto internal xref" href="#hash-algorithms-registry">Table 23</a>.
These headers <span class="bcp14">SHOULD NOT</span> be emitted unless:<a class="pilcrow" href="#section-6.2.2.3-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2.2.3-2.1">
                <p id="section-6.2.2.3-2.1.1">the cleartext signed message contains a version 4 signature made using a SHA2-based digest (SHA224, SHA256, SHA384, or SHA512), and<a class="pilcrow" href="#section-6.2.2.3-2.1.1">¶</a></p>
</li>
              <li class="normal" id="section-6.2.2.3-2.2">
                <p id="section-6.2.2.3-2.2.1">the cleartext signed message might be verified by a legacy OpenPGP implementation that requires this header.<a class="pilcrow" href="#section-6.2.2.3-2.2.1">¶</a></p>
</li>
            </ul>
<p id="section-6.2.2.3-3">A verifying application <span class="bcp14">MUST</span> decline to validate any signature in a message with a non-conformant <code>Hash</code> header (that is, a <code>Hash</code> header that contains anything other than a comma-separated list of hash algorithms).
When a conformant <code>Hash</code> header is present, a verifying application <span class="bcp14">MUST</span> ignore its contents, deferring to the hash algorithm indicated in the Embedded Signature.<a class="pilcrow" href="#section-6.2.2.3-3">¶</a></p>
</section>
</div>
<div id="armor-header-key-charset">
<section id="section-6.2.2.4">
            <h5 id="name-charset-armor-header">
<a class="section-number selfRef" href="#section-6.2.2.4">6.2.2.4. </a><a class="section-name selfRef" href="#name-charset-armor-header">"Charset" Armor Header</a>
            </h5>
<p id="section-6.2.2.4-1">The Armor Header Key <code>Charset</code> contains a description of the character set that the plaintext is in (see <span>[<a class="cite xref" href="#RFC2978">RFC2978</a>]</span>).
Please note that OpenPGP defines text to be in UTF-8.
An implementation will get the best results by translating into and out of UTF-8.
However, there are many instances where this is easier said than done.
Also, there are communities of users who have no need for UTF-8 because they are all happy with a character set like ISO Latin-5 or a Japanese character set.
In such instances, an implementation <span class="bcp14">MAY</span> override the UTF-8 default by using this header key.
An implementation <span class="bcp14">MAY</span> implement this key and any translations it cares to; an implementation <span class="bcp14">MAY</span> ignore it and assume all text is UTF-8.<a class="pilcrow" href="#section-6.2.2.4-1">¶</a></p>
</section>
</div>
</section>
</div>
<div id="armor-tail-line">
<section id="section-6.2.3">
          <h4 id="name-armor-tail-line">
<a class="section-number selfRef" href="#section-6.2.3">6.2.3. </a><a class="section-name selfRef" href="#name-armor-tail-line">Armor Tail Line</a>
          </h4>
<p id="section-6.2.3-1">The Armor Tail Line is composed in the same manner as the Armor Header Line, except the string "BEGIN" is replaced by the string "END".<a class="pilcrow" href="#section-6.2.3-1">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="cleartext-signature">
<section id="section-7">
      <h2 id="name-cleartext-signature-framewo">
<a class="section-number selfRef" href="#section-7">7. </a><a class="section-name selfRef" href="#name-cleartext-signature-framewo">Cleartext Signature Framework</a>
      </h2>
<p id="section-7-1">It is desirable to be able to sign a textual octet stream without ASCII armoring the stream itself, so the signed text is still readable with any tool capable of rendering text.
In order to bind a signature to such a cleartext, the Cleartext Signature Framework is used, which follows the same basic format and restrictions as the ASCII armoring described in <a class="auto internal xref" href="#forming-ascii-armor">Section 6.2</a>.
(Note that this framework is not intended to be reversible.
<span>[<a class="cite xref" href="#RFC3156">RFC3156</a>]</span> defines another way to sign cleartext messages for environments that support MIME.)<a class="pilcrow" href="#section-7-1">¶</a></p>
<div id="cleartext-structure">
<section id="section-7.1">
        <h3 id="name-cleartext-signed-message-st">
<a class="section-number selfRef" href="#section-7.1">7.1. </a><a class="section-name selfRef" href="#name-cleartext-signed-message-st">Cleartext Signed Message Structure</a>
        </h3>
<p id="section-7.1-1">An OpenPGP cleartext signed message consists of:<a class="pilcrow" href="#section-7.1-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.1-2.1">
            <p id="section-7.1-2.1.1">The cleartext header <code>-----BEGIN PGP SIGNED MESSAGE-----</code> on a single line.<a class="pilcrow" href="#section-7.1-2.1.1">¶</a></p>
</li>
          <li class="normal" id="section-7.1-2.2">
            <p id="section-7.1-2.2.1">One or more legacy <code>Hash</code> Armor Headers that <span class="bcp14">MAY</span> be included by some implementations and <span class="bcp14">MUST</span> be ignored when well formed (see <a class="auto internal xref" href="#armor-header-key-hash">Section 6.2.2.3</a>).<a class="pilcrow" href="#section-7.1-2.2.1">¶</a></p>
</li>
          <li class="normal" id="section-7.1-2.3">
            <p id="section-7.1-2.3.1">An empty line (not included in the message digest).<a class="pilcrow" href="#section-7.1-2.3.1">¶</a></p>
</li>
          <li class="normal" id="section-7.1-2.4">
            <p id="section-7.1-2.4.1">The dash-escaped cleartext.<a class="pilcrow" href="#section-7.1-2.4.1">¶</a></p>
</li>
          <li class="normal" id="section-7.1-2.5">
            <p id="section-7.1-2.5.1">A line ending separating the cleartext and following armored signature (not included in the message digest).<a class="pilcrow" href="#section-7.1-2.5.1">¶</a></p>
</li>
          <li class="normal" id="section-7.1-2.6">
            <p id="section-7.1-2.6.1">The ASCII-armored signature(s), including the <code>-----BEGIN PGP SIGNATURE-----</code> Armor Header and Armor Tail Lines.<a class="pilcrow" href="#section-7.1-2.6.1">¶</a></p>
</li>
        </ul>
<p id="section-7.1-3">As with any other Text signature (<a class="auto internal xref" href="#sigtype-text">Section 5.2.1.2</a>), a cleartext signature is calculated on the text using canonical &lt;CR&gt;&lt;LF&gt; line endings.
As described above, the line ending before the <code>-----BEGIN PGP SIGNATURE-----</code> Armor Header Line of the armored signature is not considered part of the signed text.<a class="pilcrow" href="#section-7.1-3">¶</a></p>
<p id="section-7.1-4">Also, any trailing whitespace -- spaces (0x20) and tabs (0x09) -- at the end of any line is removed before signing or verifying a cleartext signed message.<a class="pilcrow" href="#section-7.1-4">¶</a></p>
<p id="section-7.1-5">Between the <code>-----BEGIN PGP SIGNED MESSAGE-----</code> line and the first empty line, the only Armor Header permitted is a well-formed <code>Hash</code> Armor Header (see <a class="auto internal xref" href="#armor-header-key-hash">Section 6.2.2.3</a>).
To reduce the risk of confusion about what has been signed, a verifying implementation <span class="bcp14">MUST</span> decline to validate any signature in a cleartext message if that message has any other Armor Header present in this location.<a class="pilcrow" href="#section-7.1-5">¶</a></p>
</section>
</div>
<div id="dash-escaping">
<section id="section-7.2">
        <h3 id="name-dash-escaped-text">
<a class="section-number selfRef" href="#section-7.2">7.2. </a><a class="section-name selfRef" href="#name-dash-escaped-text">Dash-Escaped Text</a>
        </h3>
<p id="section-7.2-1">The cleartext content of the message must also be dash-escaped.<a class="pilcrow" href="#section-7.2-1">¶</a></p>
<p id="section-7.2-2">Dash-escaped cleartext is the ordinary cleartext where every line starting with a <span class="unicode">"-" (HYPHEN-MINUS, U+002D)</span> is prefixed by the sequence <span class="unicode">"-" (HYPHEN-MINUS, U+002D)</span> and <span class="unicode">" " (SPACE, U+0020)</span>.
This prevents the parser from recognizing Armor Headers of the cleartext itself.
An implementation <span class="bcp14">MAY</span> dash-escape any line, <span class="bcp14">SHOULD</span> dash-escape lines commencing in "From" followed by a space, and <span class="bcp14">MUST</span> dash-escape any line commencing in a dash. The message digest is computed using the cleartext itself, not the dash-escaped form.<a class="pilcrow" href="#section-7.2-2">¶</a></p>
<p id="section-7.2-3">When reversing dash-escaping, an implementation <span class="bcp14">MUST</span> strip the string <code>-</code> if it occurs at the beginning of a line, and it <span class="bcp14">SHOULD</span> provide a warning for <code>-</code> and any character other than a space at the beginning of a line.<a class="pilcrow" href="#section-7.2-3">¶</a></p>
</section>
</div>
<div id="csf-issues">
<section id="section-7.3">
        <h3 id="name-issues-with-the-cleartext-s">
<a class="section-number selfRef" href="#section-7.3">7.3. </a><a class="section-name selfRef" href="#name-issues-with-the-cleartext-s">Issues with the Cleartext Signature Framework</a>
        </h3>
<p id="section-7.3-1">Since creating a cleartext signed message involves trimming trailing whitespace on every line, the Cleartext Signature Framework will fail to safely round-trip any textual stream that may include semantically meaningful whitespace.<a class="pilcrow" href="#section-7.3-1">¶</a></p>
<p id="section-7.3-2">For example, the Unified Diff format <span>[<a class="cite xref" href="#UNIFIED-DIFF">UNIFIED-DIFF</a>]</span> contains semantically meaningful whitespace: an empty line of context will consist of a line with a single <span class="unicode">" " (SPACE, U+0020)</span> character, and any line that has trailing whitespace added or removed will represent such a change with semantically meaningful whitespace.<a class="pilcrow" href="#section-7.3-2">¶</a></p>
<p id="section-7.3-3">Furthermore, a Cleartext Signature Framework message that is very large is unlikely to work well.
In particular, it will be difficult for any human reading the message to know which part is covered by the signature because they can't understand the whole message at once, especially in the case where an Armor Header line is placed somewhere in the body.
And, very large Cleartext Signature Framework messages cannot be processed in a single pass, since the signature salt and digest algorithms are only discovered at the end.<a class="pilcrow" href="#section-7.3-3">¶</a></p>
<p id="section-7.3-4">An implementation that knows it is working with a textual stream with any of the above characteristics <span class="bcp14">SHOULD NOT</span> use the Cleartext Signature Framework.
Safe alternatives for a semantically meaningful OpenPGP signature over such a file format are:<a class="pilcrow" href="#section-7.3-4">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.3-5.1">
            <p id="section-7.3-5.1.1">A signed message, as described in <a class="auto internal xref" href="#openpgp-messages">Section 10.3</a>.<a class="pilcrow" href="#section-7.3-5.1.1">¶</a></p>
</li>
          <li class="normal" id="section-7.3-5.2">
            <p id="section-7.3-5.2.1">A detached signature, as described in <a class="auto internal xref" href="#detached-signatures">Section 10.4</a>.<a class="pilcrow" href="#section-7.3-5.2.1">¶</a></p>
</li>
        </ul>
<p id="section-7.3-6">Either of these alternatives may be ASCII-armored (see <a class="auto internal xref" href="#forming-ascii-armor">Section 6.2</a>) if they need to be transmitted across a text-only (or 7-bit clean) channel.<a class="pilcrow" href="#section-7.3-6">¶</a></p>
<p id="section-7.3-7">Finally, when a Cleartext Signature Framework message is presented to the user as is, an attacker can include additional text in the <code>Hash</code> header, which may mislead the user into thinking it is part of the signed text.
The signature validation constraints described in Sections <a class="auto internal xref" href="#armor-header-key-hash">6.2.2.3</a> and <a class="auto internal xref" href="#cleartext-structure">7.1</a> help to mitigate the risk of arbitrary or misleading text in the Armor Headers.<a class="pilcrow" href="#section-7.3-7">¶</a></p>
</section>
</div>
</section>
</div>
<div id="regular-expressions">
<section id="section-8">
      <h2 id="name-regular-expressions">
<a class="section-number selfRef" href="#section-8">8. </a><a class="section-name selfRef" href="#name-regular-expressions">Regular Expressions</a>
      </h2>
<p id="section-8-1">This section describes Regular Expressions.<a class="pilcrow" href="#section-8-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-8-2">
        <dt id="section-8-2.1">Regular Expression:</dt>
        <dd id="section-8-2.2" style="margin-left: 1.5em">Zero or more branches, separated by <code>|</code>.
It matches anything that matches one of the branches.<a class="pilcrow" href="#section-8-2.2">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-8-2.3">Branch:</dt>
        <dd id="section-8-2.4" style="margin-left: 1.5em">Zero or more pieces, concatenated. It matches a match for the first, followed by a match for the second, etc.<a class="pilcrow" href="#section-8-2.4">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-8-2.5">Piece:</dt>
        <dd id="section-8-2.6" style="margin-left: 1.5em">An atom possibly followed by <code>*</code>, <code>+</code>, or <code>?</code>.
An atom followed by <code>*</code> matches a sequence of 0 or more matches of the atom.
An atom followed by <code>+</code> matches a sequence of 1 or more matches of the atom.
An atom followed by <code>?</code> matches a match of the atom or the null string.<a class="pilcrow" href="#section-8-2.6">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-8-2.7">Atom:</dt>
        <dd id="section-8-2.8" style="margin-left: 1.5em">A Regular Expression in parentheses (matching a match for the Regular Expression), a range (see below), a <code>.</code> (matching any single Unicode character), a <code>^</code> (matching the null string at the beginning of the input string), a <code>$</code> (matching the null string at the end of the input string), a <code>\</code> followed by a single Unicode character (matching that character), or a single Unicode character with no other significance (matching that character).<a class="pilcrow" href="#section-8-2.8">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-8-2.9">Range:</dt>
        <dd id="section-8-2.10" style="margin-left: 1.5em">A sequence of characters enclosed in <code>[]</code>.
It normally matches any single character from the sequence.
If the sequence begins with <code>^</code>, it matches any single Unicode character not from the rest of the sequence. If two characters in the sequence are separated by <code>-</code>, this is shorthand for the full list of Unicode characters between them in codepoint order (for example, <code>[0-9]</code> matches any decimal digit). To include a literal <code>]</code> in the sequence, make it the first character (following a possible <code>^</code>). To include a literal <code>-</code>, make it the first or last character.<a class="pilcrow" href="#section-8-2.10">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
</section>
</div>
<div id="constants">
<section id="section-9">
      <h2 id="name-constants">
<a class="section-number selfRef" href="#section-9">9. </a><a class="section-name selfRef" href="#name-constants">Constants</a>
      </h2>
<p id="section-9-1">This section describes the constants used in OpenPGP.<a class="pilcrow" href="#section-9-1">¶</a></p>
<p id="section-9-2">Note that these tables are not exhaustive lists; an implementation <span class="bcp14">MAY</span> implement an algorithm that is not on these lists, as long as the algorithm IDs are chosen from the Private or Experimental Use algorithm range.<a class="pilcrow" href="#section-9-2">¶</a></p>
<p id="section-9-3">See <a class="auto internal xref" href="#notes-on-algorithms">Section 12</a> for more discussion of the algorithms.<a class="pilcrow" href="#section-9-3">¶</a></p>
<div id="pubkey-algos">
<section id="section-9.1">
        <h3 id="name-public-key-algorithms">
<a class="section-number selfRef" href="#section-9.1">9.1. </a><a class="section-name selfRef" href="#name-public-key-algorithms">Public Key Algorithms</a>
        </h3>
<span id="name-openpgp-public-key-algorith"></span><div id="pubkey-algo-registry">
<table class="center" id="table-18">
          <caption>
<a class="selfRef" href="#table-18">Table 18</a>:
<a class="selfRef" href="#name-openpgp-public-key-algorith">OpenPGP Public Key Algorithms Registry</a>
          </caption>
<thead>
            <tr>
              <th class="text-right" colspan="1" rowspan="1">ID</th>
              <th class="text-left" colspan="1" rowspan="1">Algorithm</th>
              <th class="text-left" colspan="1" rowspan="1">Public Key Format</th>
              <th class="text-left" colspan="1" rowspan="1">Secret Key Format</th>
              <th class="text-left" colspan="1" rowspan="1">Signature Format</th>
              <th class="text-left" colspan="1" rowspan="1">PKESK Format</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">Reserved</td>
              <td class="text-left" colspan="1" rowspan="1"> </td>
              <td class="text-left" colspan="1" rowspan="1"> </td>
              <td class="text-left" colspan="1" rowspan="1"> </td>
              <td class="text-left" colspan="1" rowspan="1"> </td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">1</td>
              <td class="text-left" colspan="1" rowspan="1">RSA (Encrypt or Sign) <span>[<a class="cite xref" href="#FIPS186">FIPS186</a>]</span>
</td>
              <td class="text-left" colspan="1" rowspan="1">MPI(n), MPI(e) [<a class="auto internal xref" href="#key-rsa">Section 5.5.5.1</a>]</td>
              <td class="text-left" colspan="1" rowspan="1">MPI(d), MPI(p), MPI(q), MPI(u)</td>
              <td class="text-left" colspan="1" rowspan="1">MPI(m<sup>d</sup> mod n) [<a class="auto internal xref" href="#sig-rsa">Section 5.2.3.1</a>]</td>
              <td class="text-left" colspan="1" rowspan="1">MPI(m<sup>e</sup> mod n) [<a class="auto internal xref" href="#pkesk-rsa">Section 5.1.3</a>]</td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">2</td>
              <td class="text-left" colspan="1" rowspan="1">RSA Encrypt-Only <span>[<a class="cite xref" href="#FIPS186">FIPS186</a>]</span>
</td>
              <td class="text-left" colspan="1" rowspan="1">MPI(n), MPI(e) [<a class="auto internal xref" href="#key-rsa">Section 5.5.5.1</a>]</td>
              <td class="text-left" colspan="1" rowspan="1">MPI(d), MPI(p), MPI(q), MPI(u)</td>
              <td class="text-left" colspan="1" rowspan="1">N/A</td>
              <td class="text-left" colspan="1" rowspan="1">MPI(m<sup>e</sup> mod n) [<a class="auto internal xref" href="#pkesk-rsa">Section 5.1.3</a>]</td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">3</td>
              <td class="text-left" colspan="1" rowspan="1">RSA Sign-Only <span>[<a class="cite xref" href="#FIPS186">FIPS186</a>]</span>
</td>
              <td class="text-left" colspan="1" rowspan="1">MPI(n), MPI(e) [<a class="auto internal xref" href="#key-rsa">Section 5.5.5.1</a>]</td>
              <td class="text-left" colspan="1" rowspan="1">MPI(d), MPI(p), MPI(q), MPI(u)</td>
              <td class="text-left" colspan="1" rowspan="1">MPI(m<sup>d</sup> mod n) [<a class="auto internal xref" href="#sig-rsa">Section 5.2.3.1</a>]</td>
              <td class="text-left" colspan="1" rowspan="1">N/A</td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">16</td>
              <td class="text-left" colspan="1" rowspan="1">Elgamal (Encrypt-Only) <span>[<a class="cite xref" href="#ELGAMAL">ELGAMAL</a>]</span>
</td>
              <td class="text-left" colspan="1" rowspan="1">MPI(p), MPI(g), MPI(y) [<a class="auto internal xref" href="#key-elgamal">Section 5.5.5.3</a>]</td>
              <td class="text-left" colspan="1" rowspan="1">MPI(x)</td>
              <td class="text-left" colspan="1" rowspan="1">N/A</td>
              <td class="text-left" colspan="1" rowspan="1">MPI(g<sup>k</sup> mod p), MPI(m * y<sup>k</sup> mod p) [<a class="auto internal xref" href="#pkesk-elgamal">Section 5.1.4</a>]</td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">17</td>
              <td class="text-left" colspan="1" rowspan="1">DSA (Digital Signature Algorithm) <span>[<a class="cite xref" href="#FIPS186">FIPS186</a>]</span>
</td>
              <td class="text-left" colspan="1" rowspan="1">MPI(p), MPI(q), MPI(g), MPI(y) [<a class="auto internal xref" href="#key-dsa">Section 5.5.5.2</a>]</td>
              <td class="text-left" colspan="1" rowspan="1">MPI(x)</td>
              <td class="text-left" colspan="1" rowspan="1">MPI(r), MPI(s) [<a class="auto internal xref" href="#sig-dsa">Section 5.2.3.2</a>]</td>
              <td class="text-left" colspan="1" rowspan="1">N/A</td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">18</td>
              <td class="text-left" colspan="1" rowspan="1">ECDH public key algorithm</td>
              <td class="text-left" colspan="1" rowspan="1">OID, MPI(point in curve-specific point format), KDFParams [Sections <a class="auto internal xref" href="#curve-specific-formats">9.2.1</a> and <a class="auto internal xref" href="#key-ecdh">5.5.5.6</a>]</td>
              <td class="text-left" colspan="1" rowspan="1">MPI(value in curve-specific format) [<a class="auto internal xref" href="#curve-specific-formats">Section 9.2.1</a>]</td>
              <td class="text-left" colspan="1" rowspan="1">N/A</td>
              <td class="text-left" colspan="1" rowspan="1">MPI(point in curve-specific point format), size octet, encoded key [Sections <a class="auto internal xref" href="#curve-specific-formats">9.2.1</a>, <a class="auto internal xref" href="#pkesk-ecdh">5.1.5</a>, and <a class="auto internal xref" href="#ecdh">11.5</a>]</td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">19</td>
              <td class="text-left" colspan="1" rowspan="1">ECDSA public key algorithm <span>[<a class="cite xref" href="#FIPS186">FIPS186</a>]</span>
</td>
              <td class="text-left" colspan="1" rowspan="1">OID, MPI(point in SEC1 format) [<a class="auto internal xref" href="#key-ecdsa">Section 5.5.5.4</a>]</td>
              <td class="text-left" colspan="1" rowspan="1">MPI(value)</td>
              <td class="text-left" colspan="1" rowspan="1">MPI(r), MPI(s) [<a class="auto internal xref" href="#sig-dsa">Section 5.2.3.2</a>]</td>
              <td class="text-left" colspan="1" rowspan="1">N/A</td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">20</td>
              <td class="text-left" colspan="1" rowspan="1">Reserved (formerly Elgamal Encrypt or Sign)</td>
              <td class="text-left" colspan="1" rowspan="1"> </td>
              <td class="text-left" colspan="1" rowspan="1"> </td>
              <td class="text-left" colspan="1" rowspan="1"> </td>
              <td class="text-left" colspan="1" rowspan="1"> </td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">21</td>
              <td class="text-left" colspan="1" rowspan="1">Reserved for Diffie-Hellman (X9.42, as defined for IETF-S/MIME)</td>
              <td class="text-left" colspan="1" rowspan="1"> </td>
              <td class="text-left" colspan="1" rowspan="1"> </td>
              <td class="text-left" colspan="1" rowspan="1"> </td>
              <td class="text-left" colspan="1" rowspan="1"> </td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">22</td>
              <td class="text-left" colspan="1" rowspan="1">EdDSALegacy (deprecated)</td>
              <td class="text-left" colspan="1" rowspan="1">OID, MPI(point in prefixed native format) [Sections <a class="auto internal xref" href="#ec-point-prefixed-native">11.2.2</a> and <a class="auto internal xref" href="#key-eddsa-legacy">5.5.5.5</a>]</td>
              <td class="text-left" colspan="1" rowspan="1">MPI(value in curve-specific format) [<a class="auto internal xref" href="#curve-specific-formats">Section 9.2.1</a>]</td>
              <td class="text-left" colspan="1" rowspan="1">MPI, MPI [Sections <a class="auto internal xref" href="#curve-specific-formats">9.2.1</a> and <a class="auto internal xref" href="#sig-eddsa-legacy">5.2.3.3</a>]</td>
              <td class="text-left" colspan="1" rowspan="1">N/A</td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">23</td>
              <td class="text-left" colspan="1" rowspan="1">Reserved (AEDH)</td>
              <td class="text-left" colspan="1" rowspan="1"> </td>
              <td class="text-left" colspan="1" rowspan="1"> </td>
              <td class="text-left" colspan="1" rowspan="1"> </td>
              <td class="text-left" colspan="1" rowspan="1"> </td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">24</td>
              <td class="text-left" colspan="1" rowspan="1">Reserved (AEDSA)</td>
              <td class="text-left" colspan="1" rowspan="1"> </td>
              <td class="text-left" colspan="1" rowspan="1"> </td>
              <td class="text-left" colspan="1" rowspan="1"> </td>
              <td class="text-left" colspan="1" rowspan="1"> </td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">25</td>
              <td class="text-left" colspan="1" rowspan="1">X25519</td>
              <td class="text-left" colspan="1" rowspan="1">32 octets [<a class="auto internal xref" href="#key-x25519">Section 5.5.5.7</a>]</td>
              <td class="text-left" colspan="1" rowspan="1">32 octets</td>
              <td class="text-left" colspan="1" rowspan="1">N/A</td>
              <td class="text-left" colspan="1" rowspan="1">32 octets, size octet, encoded key [<a class="auto internal xref" href="#pkesk-x25519">Section 5.1.6</a>]</td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">26</td>
              <td class="text-left" colspan="1" rowspan="1">X448</td>
              <td class="text-left" colspan="1" rowspan="1">56 octets [<a class="auto internal xref" href="#key-x448">Section 5.5.5.8</a>]</td>
              <td class="text-left" colspan="1" rowspan="1">56 octets</td>
              <td class="text-left" colspan="1" rowspan="1">N/A</td>
              <td class="text-left" colspan="1" rowspan="1">56 octets, size octet, encoded key [<a class="auto internal xref" href="#pkesk-x448">Section 5.1.7</a>]</td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">27</td>
              <td class="text-left" colspan="1" rowspan="1">Ed25519</td>
              <td class="text-left" colspan="1" rowspan="1">32 octets [<a class="auto internal xref" href="#key-ed25519">Section 5.5.5.9</a>]</td>
              <td class="text-left" colspan="1" rowspan="1">32 octets</td>
              <td class="text-left" colspan="1" rowspan="1">64 octets [<a class="auto internal xref" href="#sig-ed25519">Section 5.2.3.4</a>]</td>
              <td class="text-left" colspan="1" rowspan="1"> </td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">28</td>
              <td class="text-left" colspan="1" rowspan="1">Ed448</td>
              <td class="text-left" colspan="1" rowspan="1">57 octets [<a class="auto internal xref" href="#key-ed448">Section 5.5.5.10</a>]</td>
              <td class="text-left" colspan="1" rowspan="1">57 octets</td>
              <td class="text-left" colspan="1" rowspan="1">114 octets [<a class="auto internal xref" href="#sig-ed448">Section 5.2.3.5</a>]</td>
              <td class="text-left" colspan="1" rowspan="1"> </td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">100 to 110</td>
              <td class="text-left" colspan="1" rowspan="1">Private or Experimental Use</td>
              <td class="text-left" colspan="1" rowspan="1"> </td>
              <td class="text-left" colspan="1" rowspan="1"> </td>
              <td class="text-left" colspan="1" rowspan="1"> </td>
              <td class="text-left" colspan="1" rowspan="1"> </td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-9.1-2">Implementations <span class="bcp14">MUST</span> implement Ed25519 (27) for signatures and X25519 (25) for encryption.
Implementations <span class="bcp14">SHOULD</span> implement Ed448 (28) and X448 (26).<a class="pilcrow" href="#section-9.1-2">¶</a></p>
<p id="section-9.1-3">RSA (1) keys are deprecated and <span class="bcp14">SHOULD NOT</span> be generated but may be interpreted.
RSA Encrypt-Only (2) and RSA Sign-Only (3) are deprecated and <span class="bcp14">MUST NOT</span> be generated (see <a class="auto internal xref" href="#rsa-notes">Section 12.4</a>). Elgamal (16) keys are deprecated and <span class="bcp14">MUST NOT</span> be generated (see <a class="auto internal xref" href="#elgamal-notes">Section 12.6</a>). DSA (17) keys are deprecated and <span class="bcp14">MUST NOT</span> be generated (see <a class="auto internal xref" href="#dsa-notes">Section 12.5</a>). For notes on Elgamal Encrypt or Sign (20) and X9.42 (21), see <a class="auto internal xref" href="#reserved-notes">Section 12.8</a>.
Implementations <span class="bcp14">MAY</span> implement any other algorithm.<a class="pilcrow" href="#section-9.1-3">¶</a></p>
<p id="section-9.1-4">Note that an implementation conforming to the previous version of this specification <span>[<a class="cite xref" href="#RFC4880">RFC4880</a>]</span> has only DSA (17) and Elgamal (16) as the algorithms that <span class="bcp14">MUST</span> be implemented.<a class="pilcrow" href="#section-9.1-4">¶</a></p>
<p id="section-9.1-5">A compatible specification of ECDSA is given in <span>[<a class="cite xref" href="#RFC6090">RFC6090</a>]</span> (as "KT-I Signatures") and in <span>[<a class="cite xref" href="#SEC1">SEC1</a>]</span>; ECDH is defined in <a class="auto internal xref" href="#ecdh">Section 11.5</a> of this document.<a class="pilcrow" href="#section-9.1-5">¶</a></p>
</section>
</div>
<div id="ec-curves">
<section id="section-9.2">
        <h3 id="name-ecc-curves-for-openpgp">
<a class="section-number selfRef" href="#section-9.2">9.2. </a><a class="section-name selfRef" href="#name-ecc-curves-for-openpgp">ECC Curves for OpenPGP</a>
        </h3>
<p id="section-9.2-1">The parameter curve OID is an array of octets that defines a named curve.<a class="pilcrow" href="#section-9.2-1">¶</a></p>
<p id="section-9.2-2">The table below specifies the exact sequence of octets for each named curve referenced in this document. It also specifies which public key algorithms the curve can be used with, as well as the size of expected elements in octets. Note that there is a break in "EdDSALegacy" for display purposes only.<a class="pilcrow" href="#section-9.2-2">¶</a></p>
<span id="name-openpgp-ecc-curve-oids-and-"></span><div id="ecc-oid-usage-registry">
<table class="center" id="table-19">
          <caption>
<a class="selfRef" href="#table-19">Table 19</a>:
<a class="selfRef" href="#name-openpgp-ecc-curve-oids-and-">OpenPGP ECC Curve OIDs and Usage Registry</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">ASN.1 Object Identifier</th>
              <th class="text-left" colspan="1" rowspan="1">OID Len</th>
              <th class="text-left" colspan="1" rowspan="1">Curve OID Octets</th>
              <th class="text-left" colspan="1" rowspan="1">Curve Name</th>
              <th class="text-left" colspan="1" rowspan="1">Usage</th>
              <th class="text-left" colspan="1" rowspan="1">Field Size (fsize)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">1.2.840.10045.3.1.7</td>
              <td class="text-left" colspan="1" rowspan="1">8</td>
              <td class="text-left" colspan="1" rowspan="1">2A 86 48 CE 3D 03 01 07</td>
              <td class="text-left" colspan="1" rowspan="1">NIST P-256</td>
              <td class="text-left" colspan="1" rowspan="1">ECDSA, ECDH</td>
              <td class="text-left" colspan="1" rowspan="1">32</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">1.3.132.0.34</td>
              <td class="text-left" colspan="1" rowspan="1">5</td>
              <td class="text-left" colspan="1" rowspan="1">2B 81 04 00 22</td>
              <td class="text-left" colspan="1" rowspan="1">NIST P-384</td>
              <td class="text-left" colspan="1" rowspan="1">ECDSA, ECDH</td>
              <td class="text-left" colspan="1" rowspan="1">48</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">1.3.132.0.35</td>
              <td class="text-left" colspan="1" rowspan="1">5</td>
              <td class="text-left" colspan="1" rowspan="1">2B 81 04 00 23</td>
              <td class="text-left" colspan="1" rowspan="1">NIST P-521</td>
              <td class="text-left" colspan="1" rowspan="1">ECDSA, ECDH</td>
              <td class="text-left" colspan="1" rowspan="1">66</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">1.3.36.3.3.2.8.1.1.7</td>
              <td class="text-left" colspan="1" rowspan="1">9</td>
              <td class="text-left" colspan="1" rowspan="1">2B 24 03 03 02 08 01 01 07</td>
              <td class="text-left" colspan="1" rowspan="1">brainpoolP256r1</td>
              <td class="text-left" colspan="1" rowspan="1">ECDSA, ECDH</td>
              <td class="text-left" colspan="1" rowspan="1">32</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">1.3.36.3.3.2.8.1.1.11</td>
              <td class="text-left" colspan="1" rowspan="1">9</td>
              <td class="text-left" colspan="1" rowspan="1">2B 24 03 03 02 08 01 01 0B</td>
              <td class="text-left" colspan="1" rowspan="1">brainpoolP384r1</td>
              <td class="text-left" colspan="1" rowspan="1">ECDSA, ECDH</td>
              <td class="text-left" colspan="1" rowspan="1">48</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">1.3.36.3.3.2.8.1.1.13</td>
              <td class="text-left" colspan="1" rowspan="1">9</td>
              <td class="text-left" colspan="1" rowspan="1">2B 24 03 03 02 08 01 01 0D</td>
              <td class="text-left" colspan="1" rowspan="1">brainpoolP512r1</td>
              <td class="text-left" colspan="1" rowspan="1">ECDSA, ECDH</td>
              <td class="text-left" colspan="1" rowspan="1">64</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">1.3.6.1.4.1.11591.15.1</td>
              <td class="text-left" colspan="1" rowspan="1">9</td>
              <td class="text-left" colspan="1" rowspan="1">2B 06 01 04 01 DA 47 0F 01</td>
              <td class="text-left" colspan="1" rowspan="1">Ed25519Legacy</td>
              <td class="text-left" colspan="1" rowspan="1">EdDSA<br/>Legacy</td>
              <td class="text-left" colspan="1" rowspan="1">32</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">1.3.6.1.4.1.3029.1.5.1</td>
              <td class="text-left" colspan="1" rowspan="1">10</td>
              <td class="text-left" colspan="1" rowspan="1">2B 06 01 04 01 97 55 01 05 01</td>
              <td class="text-left" colspan="1" rowspan="1">Curve25519Legacy</td>
              <td class="text-left" colspan="1" rowspan="1">ECDH</td>
              <td class="text-left" colspan="1" rowspan="1">32</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-9.2-4">The "Field Size (fsize)" column represents the field size of the group in number of octets, rounded up, such that x or y coordinates for a point on the curve or native point representations for the curve can be represented in that many octets. The curves specified here, and scalars such as the base point order and the private key, can be represented in fsize octets. However, note that curves exist outside this specification where the representation of scalars requires an additional octet.<a class="pilcrow" href="#section-9.2-4">¶</a></p>
<p id="section-9.2-5">The sequence of octets in the third column is the result of applying the Distinguished Encoding Rules (DER) to the ASN.1 Object Identifier with subsequent truncation. The truncation removes the two fields of encoded Object Identifier. The first omitted field is 1 octet representing the Object Identifier tag, and the second omitted field is the length of the Object Identifier body.
For example, the complete ASN.1 DER encoding for the NIST P-256 curve OID is "06 08 2A 86 48 CE 3D 03 01 07", from which the first entry in the table above is constructed by omitting the first two octets.
Only the truncated sequence of octets is the valid representation of a curve OID.<a class="pilcrow" href="#section-9.2-5">¶</a></p>
<p id="section-9.2-6">The deprecated OIDs for Ed25519Legacy and Curve25519Legacy are used only in version 4 keys and signatures.
Implementations <span class="bcp14">MAY</span> implement these variants for compatibility with existing version 4 key material and signatures.
Implementations <span class="bcp14">MUST NOT</span> accept or generate version 6 key material using the deprecated OIDs.<a class="pilcrow" href="#section-9.2-6">¶</a></p>
<div id="curve-specific-formats">
<section id="section-9.2.1">
          <h4 id="name-curve-specific-wire-formats">
<a class="section-number selfRef" href="#section-9.2.1">9.2.1. </a><a class="section-name selfRef" href="#name-curve-specific-wire-formats">Curve-Specific Wire Formats</a>
          </h4>
<p id="section-9.2.1-1">Some elliptic curve public key algorithms use different conventions for specific fields depending on the curve in use. Each field is always formatted as an MPI, but with a curve-specific framing. This table summarizes those distinctions.<a class="pilcrow" href="#section-9.2.1-1">¶</a></p>
<span id="name-openpgp-ecc-curve-specific-"></span><div id="ecc-wire-formats-registry">
<table class="center" id="table-20">
            <caption>
<a class="selfRef" href="#table-20">Table 20</a>:
<a class="selfRef" href="#name-openpgp-ecc-curve-specific-">OpenPGP ECC Curve-Specific Wire Formats Registry</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" colspan="1" rowspan="1">Curve</th>
                <th class="text-left" colspan="1" rowspan="1">ECDH Point Format</th>
                <th class="text-left" colspan="1" rowspan="1">ECDH Secret Key MPI</th>
                <th class="text-left" colspan="1" rowspan="1">EdDSA Secret Key MPI</th>
                <th class="text-left" colspan="1" rowspan="1">EdDSA Signature first MPI</th>
                <th class="text-left" colspan="1" rowspan="1">EdDSA Signature second MPI</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">NIST P-256</td>
                <td class="text-left" colspan="1" rowspan="1">SEC1</td>
                <td class="text-left" colspan="1" rowspan="1">integer</td>
                <td class="text-left" colspan="1" rowspan="1">N/A</td>
                <td class="text-left" colspan="1" rowspan="1">N/A</td>
                <td class="text-left" colspan="1" rowspan="1">N/A</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">NIST P-384</td>
                <td class="text-left" colspan="1" rowspan="1">SEC1</td>
                <td class="text-left" colspan="1" rowspan="1">integer</td>
                <td class="text-left" colspan="1" rowspan="1">N/A</td>
                <td class="text-left" colspan="1" rowspan="1">N/A</td>
                <td class="text-left" colspan="1" rowspan="1">N/A</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">NIST P-521</td>
                <td class="text-left" colspan="1" rowspan="1">SEC1</td>
                <td class="text-left" colspan="1" rowspan="1">integer</td>
                <td class="text-left" colspan="1" rowspan="1">N/A</td>
                <td class="text-left" colspan="1" rowspan="1">N/A</td>
                <td class="text-left" colspan="1" rowspan="1">N/A</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">brainpoolP256r1</td>
                <td class="text-left" colspan="1" rowspan="1">SEC1</td>
                <td class="text-left" colspan="1" rowspan="1">integer</td>
                <td class="text-left" colspan="1" rowspan="1">N/A</td>
                <td class="text-left" colspan="1" rowspan="1">N/A</td>
                <td class="text-left" colspan="1" rowspan="1">N/A</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">brainpoolP384r1</td>
                <td class="text-left" colspan="1" rowspan="1">SEC1</td>
                <td class="text-left" colspan="1" rowspan="1">integer</td>
                <td class="text-left" colspan="1" rowspan="1">N/A</td>
                <td class="text-left" colspan="1" rowspan="1">N/A</td>
                <td class="text-left" colspan="1" rowspan="1">N/A</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">brainpoolP512r1</td>
                <td class="text-left" colspan="1" rowspan="1">SEC1</td>
                <td class="text-left" colspan="1" rowspan="1">integer</td>
                <td class="text-left" colspan="1" rowspan="1">N/A</td>
                <td class="text-left" colspan="1" rowspan="1">N/A</td>
                <td class="text-left" colspan="1" rowspan="1">N/A</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">Ed25519Legacy</td>
                <td class="text-left" colspan="1" rowspan="1">N/A</td>
                <td class="text-left" colspan="1" rowspan="1">N/A</td>
                <td class="text-left" colspan="1" rowspan="1">32 octets of secret</td>
                <td class="text-left" colspan="1" rowspan="1">32 octets of R</td>
                <td class="text-left" colspan="1" rowspan="1">32 octets of S</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">Curve25519Legacy</td>
                <td class="text-left" colspan="1" rowspan="1">prefixed native</td>
                <td class="text-left" colspan="1" rowspan="1">integer (<a class="auto internal xref" href="#curve25519-secrets">Section 5.5.5.6.1.1</a>)</td>
                <td class="text-left" colspan="1" rowspan="1">N/A</td>
                <td class="text-left" colspan="1" rowspan="1">N/A</td>
                <td class="text-left" colspan="1" rowspan="1">N/A</td>
              </tr>
            </tbody>
          </table>
</div>
<p id="section-9.2.1-3">For the native octet-string forms of Ed25519Legacy values, see <span>[<a class="cite xref" href="#RFC8032">RFC8032</a>]</span>.
For the native octet-string forms of Curve25519Legacy secret scalars and points, see <span>[<a class="cite xref" href="#RFC7748">RFC7748</a>]</span>.<a class="pilcrow" href="#section-9.2.1-3">¶</a></p>
</section>
</div>
</section>
</div>
<div id="symmetric-algos">
<section id="section-9.3">
        <h3 id="name-symmetric-key-algorithms">
<a class="section-number selfRef" href="#section-9.3">9.3. </a><a class="section-name selfRef" href="#name-symmetric-key-algorithms">Symmetric Key Algorithms</a>
        </h3>
<span id="name-openpgp-symmetric-key-algor"></span><div id="symkey-algorithms-registry">
<table class="center" id="table-21">
          <caption>
<a class="selfRef" href="#table-21">Table 21</a>:
<a class="selfRef" href="#name-openpgp-symmetric-key-algor">OpenPGP Symmetric Key Algorithms Registry</a>
          </caption>
<thead>
            <tr>
              <th class="text-right" colspan="1" rowspan="1">ID</th>
              <th class="text-left" colspan="1" rowspan="1">Algorithm</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">Plaintext or unencrypted data</td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">1</td>
              <td class="text-left" colspan="1" rowspan="1">IDEA <span>[<a class="cite xref" href="#IDEA">IDEA</a>]</span>
</td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">2</td>
              <td class="text-left" colspan="1" rowspan="1">TripleDES (or DES-EDE) <span>[<a class="cite xref" href="#SP800-67">SP800-67</a>]</span> with 168-bit key derived from 192</td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">3</td>
              <td class="text-left" colspan="1" rowspan="1">CAST5 with 128-bit key <span>[<a class="cite xref" href="#RFC2144">RFC2144</a>]</span>
</td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">4</td>
              <td class="text-left" colspan="1" rowspan="1">Blowfish with 128-bit key, 16 rounds <span>[<a class="cite xref" href="#BLOWFISH">BLOWFISH</a>]</span>
</td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">5</td>
              <td class="text-left" colspan="1" rowspan="1">Reserved</td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">6</td>
              <td class="text-left" colspan="1" rowspan="1">Reserved</td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">7</td>
              <td class="text-left" colspan="1" rowspan="1">AES with 128-bit key <span>[<a class="cite xref" href="#AES">AES</a>]</span>
</td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">8</td>
              <td class="text-left" colspan="1" rowspan="1">AES with 192-bit key</td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">9</td>
              <td class="text-left" colspan="1" rowspan="1">AES with 256-bit key</td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">10</td>
              <td class="text-left" colspan="1" rowspan="1">Twofish with 256-bit key <span>[<a class="cite xref" href="#TWOFISH">TWOFISH</a>]</span>
</td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">11</td>
              <td class="text-left" colspan="1" rowspan="1">Camellia with 128-bit key <span>[<a class="cite xref" href="#RFC3713">RFC3713</a>]</span>
</td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">12</td>
              <td class="text-left" colspan="1" rowspan="1">Camellia with 192-bit key</td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">13</td>
              <td class="text-left" colspan="1" rowspan="1">Camellia with 256-bit key</td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">100-110</td>
              <td class="text-left" colspan="1" rowspan="1">Private or Experimental Use</td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">253-255</td>
              <td class="text-left" colspan="1" rowspan="1">Reserved to avoid collision with Secret Key Encryption (<a class="auto internal xref" href="#secret-key-protection-registry">Table 2</a> and <a class="auto internal xref" href="#secret-key-packet-formats">Section 5.5.3</a>)</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-9.3-2">Implementations <span class="bcp14">MUST</span> implement AES-128.
Implementations <span class="bcp14">SHOULD</span> implement AES-256.
Implementations <span class="bcp14">MUST NOT</span> encrypt data with IDEA, TripleDES, or CAST5.
Implementations <span class="bcp14">MAY</span> decrypt data that uses IDEA, TripleDES, or CAST5 for the sake of reading older messages or new messages from implementations predating support for <span>[<a class="cite xref" href="#RFC2440">RFC2440</a>]</span>.
An Implementation that decrypts data using IDEA, TripleDES, or CAST5 <span class="bcp14">SHOULD</span> generate a deprecation warning about the symmetric algorithm, indicating that message confidentiality is suspect.
Implementations <span class="bcp14">MAY</span> implement any other algorithm.<a class="pilcrow" href="#section-9.3-2">¶</a></p>
</section>
</div>
<div id="compression-algos">
<section id="section-9.4">
        <h3 id="name-compression-algorithms">
<a class="section-number selfRef" href="#section-9.4">9.4. </a><a class="section-name selfRef" href="#name-compression-algorithms">Compression Algorithms</a>
        </h3>
<span id="name-openpgp-compression-algorit"></span><div id="compression-algorithms-registry">
<table class="center" id="table-22">
          <caption>
<a class="selfRef" href="#table-22">Table 22</a>:
<a class="selfRef" href="#name-openpgp-compression-algorit">OpenPGP Compression Algorithms Registry</a>
          </caption>
<thead>
            <tr>
              <th class="text-right" colspan="1" rowspan="1">ID</th>
              <th class="text-left" colspan="1" rowspan="1">Algorithm</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">Uncompressed</td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">1</td>
              <td class="text-left" colspan="1" rowspan="1">ZIP <span>[<a class="cite xref" href="#RFC1951">RFC1951</a>]</span>
</td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">2</td>
              <td class="text-left" colspan="1" rowspan="1">ZLIB <span>[<a class="cite xref" href="#RFC1950">RFC1950</a>]</span>
</td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">3</td>
              <td class="text-left" colspan="1" rowspan="1">BZip2 <span>[<a class="cite xref" href="#BZ2">BZ2</a>]</span>
</td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">100-110</td>
              <td class="text-left" colspan="1" rowspan="1">Private or Experimental Use</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-9.4-2">Implementations <span class="bcp14">MUST</span> implement uncompressed data.
Implementations <span class="bcp14">SHOULD</span> implement ZLIB.
For interoperability reasons, implementations <span class="bcp14">SHOULD</span> be able to decompress using ZIP.
Implementations <span class="bcp14">MAY</span> implement any other algorithm.<a class="pilcrow" href="#section-9.4-2">¶</a></p>
</section>
</div>
<div id="hash-algos">
<section id="section-9.5">
        <h3 id="name-hash-algorithms">
<a class="section-number selfRef" href="#section-9.5">9.5. </a><a class="section-name selfRef" href="#name-hash-algorithms">Hash Algorithms</a>
        </h3>
<span id="name-openpgp-hash-algorithms-reg"></span><div id="hash-algorithms-registry">
<table class="center" id="table-23">
          <caption>
<a class="selfRef" href="#table-23">Table 23</a>:
<a class="selfRef" href="#name-openpgp-hash-algorithms-reg">OpenPGP Hash Algorithms Registry</a>
          </caption>
<thead>
            <tr>
              <th class="text-right" colspan="1" rowspan="1">ID</th>
              <th class="text-left" colspan="1" rowspan="1">Algorithm</th>
              <th class="text-left" colspan="1" rowspan="1">Text Name</th>
              <th class="text-left" colspan="1" rowspan="1">V6 Signature Salt Size</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">Reserved</td>
              <td class="text-left" colspan="1" rowspan="1"></td>
              <td class="text-left" colspan="1" rowspan="1"></td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">1</td>
              <td class="text-left" colspan="1" rowspan="1">MD5 <span>[<a class="cite xref" href="#RFC1321">RFC1321</a>]</span>
</td>
              <td class="text-left" colspan="1" rowspan="1">"MD5"</td>
              <td class="text-left" colspan="1" rowspan="1">N/A</td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">2</td>
              <td class="text-left" colspan="1" rowspan="1">SHA-1 <span>[<a class="cite xref" href="#FIPS180">FIPS180</a>]</span>
</td>
              <td class="text-left" colspan="1" rowspan="1">"SHA1"</td>
              <td class="text-left" colspan="1" rowspan="1">N/A</td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">3</td>
              <td class="text-left" colspan="1" rowspan="1">RIPEMD-160 <span>[<a class="cite xref" href="#RIPEMD-160">RIPEMD-160</a>]</span>
</td>
              <td class="text-left" colspan="1" rowspan="1">"RIPEMD160"</td>
              <td class="text-left" colspan="1" rowspan="1">N/A</td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">4</td>
              <td class="text-left" colspan="1" rowspan="1">Reserved</td>
              <td class="text-left" colspan="1" rowspan="1"> </td>
              <td class="text-left" colspan="1" rowspan="1">  </td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">5</td>
              <td class="text-left" colspan="1" rowspan="1">Reserved</td>
              <td class="text-left" colspan="1" rowspan="1"> </td>
              <td class="text-left" colspan="1" rowspan="1"> </td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">6</td>
              <td class="text-left" colspan="1" rowspan="1">Reserved</td>
              <td class="text-left" colspan="1" rowspan="1"> </td>
              <td class="text-left" colspan="1" rowspan="1"> </td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">7</td>
              <td class="text-left" colspan="1" rowspan="1">Reserved</td>
              <td class="text-left" colspan="1" rowspan="1"> </td>
              <td class="text-left" colspan="1" rowspan="1"> </td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">8</td>
              <td class="text-left" colspan="1" rowspan="1">SHA2-256 <span>[<a class="cite xref" href="#FIPS180">FIPS180</a>]</span>
</td>
              <td class="text-left" colspan="1" rowspan="1">"SHA256"</td>
              <td class="text-left" colspan="1" rowspan="1">16</td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">9</td>
              <td class="text-left" colspan="1" rowspan="1">SHA2-384 <span>[<a class="cite xref" href="#FIPS180">FIPS180</a>]</span>
</td>
              <td class="text-left" colspan="1" rowspan="1">"SHA384"</td>
              <td class="text-left" colspan="1" rowspan="1">24</td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">10</td>
              <td class="text-left" colspan="1" rowspan="1">SHA2-512 <span>[<a class="cite xref" href="#FIPS180">FIPS180</a>]</span>
</td>
              <td class="text-left" colspan="1" rowspan="1">"SHA512"</td>
              <td class="text-left" colspan="1" rowspan="1">32</td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">11</td>
              <td class="text-left" colspan="1" rowspan="1">SHA2-224 <span>[<a class="cite xref" href="#FIPS180">FIPS180</a>]</span>
</td>
              <td class="text-left" colspan="1" rowspan="1">"SHA224"</td>
              <td class="text-left" colspan="1" rowspan="1">16</td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">12</td>
              <td class="text-left" colspan="1" rowspan="1">SHA3-256 <span>[<a class="cite xref" href="#FIPS202">FIPS202</a>]</span>
</td>
              <td class="text-left" colspan="1" rowspan="1">"SHA3-256"</td>
              <td class="text-left" colspan="1" rowspan="1">16</td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">13</td>
              <td class="text-left" colspan="1" rowspan="1">Reserved</td>
              <td class="text-left" colspan="1" rowspan="1"> </td>
              <td class="text-left" colspan="1" rowspan="1"> </td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">14</td>
              <td class="text-left" colspan="1" rowspan="1">SHA3-512 <span>[<a class="cite xref" href="#FIPS202">FIPS202</a>]</span>
</td>
              <td class="text-left" colspan="1" rowspan="1">"SHA3-512"</td>
              <td class="text-left" colspan="1" rowspan="1">32</td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">100-110</td>
              <td class="text-left" colspan="1" rowspan="1">Private or Experimental Use</td>
              <td class="text-left" colspan="1" rowspan="1"> </td>
              <td class="text-left" colspan="1" rowspan="1"> </td>
            </tr>
          </tbody>
        </table>
</div>
<span id="name-openpgp-hash-algorithm-iden"></span><div id="emsa-hash-oids-registry">
<table class="center" id="table-24">
          <caption>
<a class="selfRef" href="#table-24">Table 24</a>:
<a class="selfRef" href="#name-openpgp-hash-algorithm-iden">OpenPGP Hash Algorithm Identifiers for RSA Signatures' Use of EMSA‑PKCS1‑v1_5 Padding Registry</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Hash Algorithm</th>
              <th class="text-left" colspan="1" rowspan="1">OID</th>
              <th class="text-left" colspan="1" rowspan="1">Full Hash Prefix</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">MD5</td>
              <td class="text-left" colspan="1" rowspan="1">1.2.840.113549.2.5</td>
              <td class="text-left" colspan="1" rowspan="1">0x30, 0x20, 0x30, 0x0C, 0x06, 0x08, 0x2A, 0x86, 0x48, 0x86, 0xF7, 0x0D, 0x02, 0x05, 0x05, 0x00, 0x04, 0x10</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">SHA-1</td>
              <td class="text-left" colspan="1" rowspan="1">1.3.14.3.2.26</td>
              <td class="text-left" colspan="1" rowspan="1">0x30, 0x21, 0x30, 0x09, 0x06, 0x05, 0x2B, 0x0E, 0x03, 0x02, 0x1A, 0x05, 0x00, 0x04, 0x14</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">RIPEMD-160</td>
              <td class="text-left" colspan="1" rowspan="1">1.3.36.3.2.1</td>
              <td class="text-left" colspan="1" rowspan="1">0x30, 0x21, 0x30, 0x09, 0x06, 0x05, 0x2B, 0x24, 0x03, 0x02, 0x01, 0x05, 0x00, 0x04, 0x14</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">SHA2-256</td>
              <td class="text-left" colspan="1" rowspan="1">2.16.840.1.101.3.4.2.1</td>
              <td class="text-left" colspan="1" rowspan="1">0x30, 0x31, 0x30, 0x0D, 0x06, 0x09, 0x60, 0x86, 0x48, 0x01, 0x65, 0x03, 0x04, 0x02, 0x01, 0x05, 0x00, 0x04, 0x20</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">SHA2-384</td>
              <td class="text-left" colspan="1" rowspan="1">2.16.840.1.101.3.4.2.2</td>
              <td class="text-left" colspan="1" rowspan="1">0x30, 0x41, 0x30, 0x0D, 0x06, 0x09, 0x60, 0x86, 0x48, 0x01, 0x65, 0x03, 0x04, 0x02, 0x02, 0x05, 0x00, 0x04, 0x30</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">SHA2-512</td>
              <td class="text-left" colspan="1" rowspan="1">2.16.840.1.101.3.4.2.3</td>
              <td class="text-left" colspan="1" rowspan="1">0x30, 0x51, 0x30, 0x0D, 0x06, 0x09, 0x60, 0x86, 0x48, 0x01, 0x65, 0x03, 0x04, 0x02, 0x03, 0x05, 0x00, 0x04, 0x40</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">SHA2-224</td>
              <td class="text-left" colspan="1" rowspan="1">2.16.840.1.101.3.4.2.4</td>
              <td class="text-left" colspan="1" rowspan="1">0x30, 0x2D, 0x30, 0x0D, 0x06, 0x09, 0x60, 0x86, 0x48, 0x01, 0x65, 0x03, 0x04, 0x02, 0x04, 0x05, 0x00, 0x04, 0x1C</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">SHA3-256</td>
              <td class="text-left" colspan="1" rowspan="1">2.16.840.1.101.3.4.2.8</td>
              <td class="text-left" colspan="1" rowspan="1">0x30, 0x31, 0x30, 0x0D, 0x06, 0x09, 0x60, 0x86, 0x48, 0x01, 0x65, 0x03, 0x04, 0x02, 0x08, 0x05, 0x00, 0x04, 0x20</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">SHA3-512</td>
              <td class="text-left" colspan="1" rowspan="1">2.16.840.1.101.3.4.2.10</td>
              <td class="text-left" colspan="1" rowspan="1">0x30, 0x51, 0x30, 0x0D, 0x06, 0x09, 0x60, 0x86, 0x48, 0x01, 0x65, 0x03, 0x04, 0x02, 0x0a, 0x05, 0x00, 0x04, 0x40</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-9.5-3">Implementations <span class="bcp14">MUST</span> implement SHA2-256.
Implementations <span class="bcp14">SHOULD</span> implement SHA2-384 and SHA2-512.
Implementations <span class="bcp14">MAY</span> implement other algorithms.
Implementations <span class="bcp14">SHOULD NOT</span> create messages that require the use of SHA-1, with the exception of computing version 4 key fingerprints for purposes of the MDC in version 1 Symmetrically Encrypted and Integrity Protected Data packets.
Implementations <span class="bcp14">MUST NOT</span> generate signatures with MD5, SHA-1, or RIPEMD-160.
Implementations <span class="bcp14">MUST NOT</span> use MD5, SHA-1, or RIPEMD-160 as a hash function in an ECDH KDF.
Implementations <span class="bcp14">MUST NOT</span> generate packets using MD5, SHA-1, or RIPEMD-160 as a hash function in an S2K KDF.
Implementations <span class="bcp14">MUST NOT</span> decrypt a secret using MD5, SHA-1, or RIPEMD-160 as a hash function in an S2K KDF in a version 6 (or later) packet.
Implementations <span class="bcp14">MUST NOT</span> validate any recent signature that depends on MD5, SHA-1, or RIPEMD-160.
Implementations <span class="bcp14">SHOULD NOT</span> validate any old signature that depends on MD5, SHA-1, or RIPEMD-160 unless the signature's creation date predates known weakness of the algorithm used, and the implementation is confident that the message has been in the secure custody of the user the whole time.<a class="pilcrow" href="#section-9.5-3">¶</a></p>
</section>
</div>
<div id="aead-algorithms">
<section id="section-9.6">
        <h3 id="name-aead-algorithms">
<a class="section-number selfRef" href="#section-9.6">9.6. </a><a class="section-name selfRef" href="#name-aead-algorithms">AEAD Algorithms</a>
        </h3>
<span id="name-openpgp-aead-algorithms-reg"></span><div id="aead-algorithms-registry">
<table class="center" id="table-25">
          <caption>
<a class="selfRef" href="#table-25">Table 25</a>:
<a class="selfRef" href="#name-openpgp-aead-algorithms-reg">OpenPGP AEAD Algorithms Registry</a>
          </caption>
<thead>
            <tr>
              <th class="text-right" colspan="1" rowspan="1">ID</th>
              <th class="text-left" colspan="1" rowspan="1">Name</th>
              <th class="text-left" colspan="1" rowspan="1">Nonce Length (Octets)</th>
              <th class="text-left" colspan="1" rowspan="1">Authentication Tag Length (Octets)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">Reserved</td>
              <td class="text-left" colspan="1" rowspan="1"></td>
              <td class="text-left" colspan="1" rowspan="1"></td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">1</td>
              <td class="text-left" colspan="1" rowspan="1">EAX <span>[<a class="cite xref" href="#EAX">EAX</a>]</span>
</td>
              <td class="text-left" colspan="1" rowspan="1">16</td>
              <td class="text-left" colspan="1" rowspan="1">16</td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">2</td>
              <td class="text-left" colspan="1" rowspan="1">OCB <span>[<a class="cite xref" href="#RFC7253">RFC7253</a>]</span>
</td>
              <td class="text-left" colspan="1" rowspan="1">15</td>
              <td class="text-left" colspan="1" rowspan="1">16</td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">3</td>
              <td class="text-left" colspan="1" rowspan="1">GCM <span>[<a class="cite xref" href="#SP800-38D">SP800-38D</a>]</span>
</td>
              <td class="text-left" colspan="1" rowspan="1">12</td>
              <td class="text-left" colspan="1" rowspan="1">16</td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">100-110</td>
              <td class="text-left" colspan="1" rowspan="1">Private or Experimental Use</td>
              <td class="text-left" colspan="1" rowspan="1"> </td>
              <td class="text-left" colspan="1" rowspan="1"> </td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-9.6-2">Implementations <span class="bcp14">MUST</span> implement OCB. Implementations <span class="bcp14">MAY</span> implement EAX, GCM, and other algorithms.<a class="pilcrow" href="#section-9.6-2">¶</a></p>
</section>
</div>
</section>
</div>
<div id="packet-sequence-composition">
<section id="section-10">
      <h2 id="name-packet-sequence-composition">
<a class="section-number selfRef" href="#section-10">10. </a><a class="section-name selfRef" href="#name-packet-sequence-composition">Packet Sequence Composition</a>
      </h2>
<p id="section-10-1">OpenPGP packets are assembled into sequences in order to create messages and to transfer keys.
Not all possible packet sequences are meaningful and correct.
This section describes the rules for how packets should be placed into sequences.<a class="pilcrow" href="#section-10-1">¶</a></p>
<p id="section-10-2">There are three distinct sequences of packets:<a class="pilcrow" href="#section-10-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10-3.1">
          <p id="section-10-3.1.1">Transferable Public Keys (<a class="auto internal xref" href="#transferable-public-keys">Section 10.1</a>) and their close counterpart, Transferable Secret Keys (<a class="auto internal xref" href="#transferable-secret-keys">Section 10.2</a>)<a class="pilcrow" href="#section-10-3.1.1">¶</a></p>
</li>
        <li class="normal" id="section-10-3.2">
          <p id="section-10-3.2.1">OpenPGP Messages (<a class="auto internal xref" href="#openpgp-messages">Section 10.3</a>)<a class="pilcrow" href="#section-10-3.2.1">¶</a></p>
</li>
        <li class="normal" id="section-10-3.3">
          <p id="section-10-3.3.1">Detached Signatures (<a class="auto internal xref" href="#detached-signatures">Section 10.4</a>)<a class="pilcrow" href="#section-10-3.3.1">¶</a></p>
</li>
      </ul>
<p id="section-10-4">Each sequence has an explicit grammar of what packet types (<a class="auto internal xref" href="#packet-types-registry">Table 3</a>) can appear in what place. The presence of an unknown critical packet, or a known but unexpected packet, is a critical error, invalidating the entire sequence (see <a class="auto internal xref" href="#packet-criticality">Section 4.3</a>).
On the other hand, unknown non-critical packets can appear anywhere within any sequence. This provides a structured way to introduce new packets into OpenPGP, while making sure that certain packets will be handled strictly.<a class="pilcrow" href="#section-10-4">¶</a></p>
<p id="section-10-5">An implementation may "recognize" a packet but not implement it.
The purpose of Packet Criticality is to allow the producer to tell the consumer whether it would prefer a new, unknown packet to generate an error or be ignored.<a class="pilcrow" href="#section-10-5">¶</a></p>
<p id="section-10-6">Note that previous versions of this document did not have a concept of Packet Criticality and did not give clear guidance on what to do when unknown packets are encountered. Therefore, implementations of the previous versions may reject unknown non-critical packets or accept unknown critical packets.<a class="pilcrow" href="#section-10-6">¶</a></p>
<p id="section-10-7">When generating a sequence of OpenPGP packets according to one of the three grammars, an implementation <span class="bcp14">MUST NOT</span> inject a critical packet of a type that does not adhere to the grammar.<a class="pilcrow" href="#section-10-7">¶</a></p>
<p id="section-10-8">When consuming a sequence of OpenPGP packets, if an implementation encounters a critical packet of an inappropriate type according to the relevant grammar, the implementation <span class="bcp14">MUST</span> reject the sequence with an error.<a class="pilcrow" href="#section-10-8">¶</a></p>
<div id="transferable-public-keys">
<section id="section-10.1">
        <h3 id="name-transferable-public-keys">
<a class="section-number selfRef" href="#section-10.1">10.1. </a><a class="section-name selfRef" href="#name-transferable-public-keys">Transferable Public Keys</a>
        </h3>
<p id="section-10.1-1">OpenPGP users may transfer public keys.
This section describes the structure of public keys in transit to ensure interoperability.
An OpenPGP Transferable Public Key is also known as an OpenPGP certificate, in order to distinguish it from both its constituent Public Key packets (Sections <a class="auto internal xref" href="#pubkey">5.5.1.1</a> and <a class="auto internal xref" href="#pubsubkey">5.5.1.2</a>) and the underlying cryptographic key material.<a class="pilcrow" href="#section-10.1-1">¶</a></p>
<div id="v6-certificate-structures">
<section id="section-10.1.1">
          <h4 id="name-openpgp-version-6-certifica">
<a class="section-number selfRef" href="#section-10.1.1">10.1.1. </a><a class="section-name selfRef" href="#name-openpgp-version-6-certifica">OpenPGP Version 6 Certificate Structure</a>
          </h4>
<p id="section-10.1.1-1">The format of an OpenPGP version 6 certificate is as follows.
Entries in square brackets are optional and ellipses indicate repetition.<a class="pilcrow" href="#section-10.1.1-1">¶</a></p>
<div class="alignLeft art-text artwork" id="section-10.1.1-2">
<pre>Primary Key
   [Revocation Signature...]
    Direct Key Signature...
   [User ID or User Attribute
           [Certification Revocation Signature...]
           [Certification Signature...]]...
   [Subkey [Subkey Revocation Signature...]
           Subkey Binding Signature...]...
   [Padding]
</pre><a class="pilcrow" href="#section-10.1.1-2">¶</a>
</div>
<p id="section-10.1.1-3">In addition to these rules, a Marker packet (<a class="auto internal xref" href="#marker-packet">Section 5.8</a>) can appear anywhere in the sequence.<a class="pilcrow" href="#section-10.1.1-3">¶</a></p>
<p id="section-10.1.1-4">Note that a version 6 key uses a self-signed Direct Key signature to store algorithm preferences.<a class="pilcrow" href="#section-10.1.1-4">¶</a></p>
<p id="section-10.1.1-5">Every subkey for a version 6 primary key <span class="bcp14">MUST</span> be a version 6 subkey.
Every subkey <span class="bcp14">MUST</span> have at least one Subkey Binding signature.
Every Subkey Binding signature <span class="bcp14">MUST</span> be a self-signature (that is, made by the version 6 primary key).
Like all other signatures, every self-signature made by a version 6 key <span class="bcp14">MUST</span> be a version 6 signature.<a class="pilcrow" href="#section-10.1.1-5">¶</a></p>
</section>
</div>
<div id="v6-revocation-certificate">
<section id="section-10.1.2">
          <h4 id="name-openpgp-version-6-revocatio">
<a class="section-number selfRef" href="#section-10.1.2">10.1.2. </a><a class="section-name selfRef" href="#name-openpgp-version-6-revocatio">OpenPGP Version 6 Revocation Certificate</a>
          </h4>
<p id="section-10.1.2-1">When a primary version 6 Public Key is revoked, it is sometimes distributed with only the Revocation Signature:<a class="pilcrow" href="#section-10.1.2-1">¶</a></p>
<div class="alignLeft art-text artwork" id="section-10.1.2-2">
<pre>Primary Key
    Revocation Signature
</pre><a class="pilcrow" href="#section-10.1.2-2">¶</a>
</div>
<p id="section-10.1.2-3">In this case, the Direct Key signature is no longer necessary, since the primary key itself has been marked as unusable.<a class="pilcrow" href="#section-10.1.2-3">¶</a></p>
</section>
</div>
<div id="openpgp-v4-certificate-structure">
<section id="section-10.1.3">
          <h4 id="name-openpgp-version-4-certifica">
<a class="section-number selfRef" href="#section-10.1.3">10.1.3. </a><a class="section-name selfRef" href="#name-openpgp-version-4-certifica">OpenPGP Version 4 Certificate Structure</a>
          </h4>
<p id="section-10.1.3-1">The format of an OpenPGP version 4 key is as follows.<a class="pilcrow" href="#section-10.1.3-1">¶</a></p>
<div class="alignLeft art-text artwork" id="section-10.1.3-2">
<pre>Primary Key
   [Revocation Signature]
   [Direct Key Signature...]
   [User ID or User Attribute [Signature...]]...
   [Subkey [Subkey Revocation Signature...]
           Subkey Binding Signature...]...
</pre><a class="pilcrow" href="#section-10.1.3-2">¶</a>
</div>
<p id="section-10.1.3-3">In addition to these rules, a Marker packet (<a class="auto internal xref" href="#marker-packet">Section 5.8</a>) can appear anywhere in the sequence.<a class="pilcrow" href="#section-10.1.3-3">¶</a></p>
<p id="section-10.1.3-4">A subkey always has at least one Subkey Binding signature after it that is issued using the primary key to tie the two keys together. These binding signatures may be in either version 3 or version 4 format, but they <span class="bcp14">SHOULD</span> be in version 4 format.
Subkeys that can issue signatures <span class="bcp14">MUST</span> have a version 4 binding signature due to the <span class="bcp14">REQUIRED</span> embedded Primary Key Binding signature.<a class="pilcrow" href="#section-10.1.3-4">¶</a></p>
<p id="section-10.1.3-5">Every subkey for a version 4 primary key <span class="bcp14">MUST</span> be a version 4 subkey.<a class="pilcrow" href="#section-10.1.3-5">¶</a></p>
<p id="section-10.1.3-6">When a primary version 4 Public Key is revoked, the Revocation Signature is sometimes distributed by itself, without the primary key packet it applies to. This is referred to as a "revocation certificate".
Instead, a version 6 revocation certificate <span class="bcp14">MUST</span> include the primary key packet, as described in <a class="auto internal xref" href="#v6-revocation-certificate">Section 10.1.2</a>.<a class="pilcrow" href="#section-10.1.3-6">¶</a></p>
</section>
</div>
<div id="openpgp-v3-key-structure">
<section id="section-10.1.4">
          <h4 id="name-openpgp-version-3-key-struc">
<a class="section-number selfRef" href="#section-10.1.4">10.1.4. </a><a class="section-name selfRef" href="#name-openpgp-version-3-key-struc">OpenPGP Version 3 Key Structure</a>
          </h4>
<p id="section-10.1.4-1">The format of an OpenPGP version 3 key is as follows.<a class="pilcrow" href="#section-10.1.4-1">¶</a></p>
<div class="alignLeft art-text artwork" id="section-10.1.4-2">
<pre>RSA Public Key
   [Revocation Signature]
    User ID [Signature...]
   [User ID [Signature...]]...
</pre><a class="pilcrow" href="#section-10.1.4-2">¶</a>
</div>
<p id="section-10.1.4-3">In addition to these rules, a Marker packet (<a class="auto internal xref" href="#marker-packet">Section 5.8</a>) can appear anywhere in the sequence.<a class="pilcrow" href="#section-10.1.4-3">¶</a></p>
<p id="section-10.1.4-4">Each signature certifies the RSA public key and the preceding User ID.
The RSA public key can have many User IDs, and each User ID can have many signatures.
Version 3 keys are deprecated. Implementations <span class="bcp14">MUST NOT</span> generate new version 3 keys but <span class="bcp14">MAY</span> continue to use existing ones.<a class="pilcrow" href="#section-10.1.4-4">¶</a></p>
<p id="section-10.1.4-5">Version 3 keys <span class="bcp14">MUST NOT</span> have subkeys.<a class="pilcrow" href="#section-10.1.4-5">¶</a></p>
</section>
</div>
<div id="common-requirements">
<section id="section-10.1.5">
          <h4 id="name-common-requirements">
<a class="section-number selfRef" href="#section-10.1.5">10.1.5. </a><a class="section-name selfRef" href="#name-common-requirements">Common Requirements</a>
          </h4>
<p id="section-10.1.5-1">The Public Key packet occurs first.<a class="pilcrow" href="#section-10.1.5-1">¶</a></p>
<p id="section-10.1.5-2">The primary key <span class="bcp14">MUST</span> be an algorithm capable of making signatures (that is, not an encryption-only algorithm). This is because the primary key needs to be able to create self-signatures (see <a class="auto internal xref" href="#self-sigs">Section 5.2.3.10</a>).
The subkeys may be keys of any type. For example, there may be a single-key RSA key, an Ed25519 primary key with an RSA encryption subkey, an Ed25519 primary key with an X25519 subkey, etc.<a class="pilcrow" href="#section-10.1.5-2">¶</a></p>
<p id="section-10.1.5-3">Each of the following User ID packets provides the identity of the owner of this public key.
If there are multiple User ID packets, this corresponds to multiple means of identifying the same unique individual user; for example, a user may have more than one email address and construct a User ID for each one.
A Transferable Public Key <span class="bcp14">SHOULD</span> include at least one User ID packet unless storage requirements prohibit this.<a class="pilcrow" href="#section-10.1.5-3">¶</a></p>
<p id="section-10.1.5-4">Immediately following each User ID packet, there are zero or more Signature packets.
Each Signature packet is calculated on the immediately preceding User ID packet and the initial Public Key packet. The signature serves to certify the corresponding public key and User ID. In effect, the signer is testifying to the belief that this public key belongs to the user identified by this User ID.<a class="pilcrow" href="#section-10.1.5-4">¶</a></p>
<p id="section-10.1.5-5">Within the same section as the User ID packets, there are zero or more User Attribute packets. Like the User ID packets, a User Attribute packet is followed by zero or more Signature packets calculated on the immediately preceding User Attribute packet and the initial Public Key packet.<a class="pilcrow" href="#section-10.1.5-5">¶</a></p>
<p id="section-10.1.5-6">User Attribute packets and User ID packets may be freely intermixed in this section, as long as the signatures that follow them are maintained on the proper User Attribute or User ID packet.<a class="pilcrow" href="#section-10.1.5-6">¶</a></p>
<p id="section-10.1.5-7">After the sequence of User ID packets and Attribute packets and their associated signatures, zero or more Subkey packets follow, each with their own signatures. In general, subkeys are provided in cases where the top-level public key is a certification-only key.
However, any version 4 or version 6 key may have subkeys, and the subkeys may be encryption keys, signing keys, authentication keys, etc.
It is good practice to use separate subkeys for every operation (i.e., signature-only, encryption-only, authentication-only keys, etc.).<a class="pilcrow" href="#section-10.1.5-7">¶</a></p>
<p id="section-10.1.5-8">Each Subkey packet <span class="bcp14">MUST</span> be followed by one Signature packet, which should be a Subkey Binding signature issued by the top-level key.
For subkeys that can issue signatures, the Subkey Binding signature <span class="bcp14">MUST</span> contain an Embedded Signature subpacket with a Primary Key Binding signature (Type ID 0x19) issued by the subkey on the top-level key.<a class="pilcrow" href="#section-10.1.5-8">¶</a></p>
<p id="section-10.1.5-9">Subkey and Key packets may each be followed by a Revocation Signature packet to indicate that the key is revoked.
Revocation Signatures are only accepted if they are issued by the key itself or by a key that is authorized to issue revocations via a Revocation Key subpacket in a self-signature by the top-level key.<a class="pilcrow" href="#section-10.1.5-9">¶</a></p>
<p id="section-10.1.5-10">The optional trailing Padding packet is a mechanism to defend against traffic analysis (see <a class="auto internal xref" href="#traffic-analysis">Section 13.11</a>).
For maximum interoperability, if the Public Key packet is a version 4 key, the optional Padding packet <span class="bcp14">SHOULD NOT</span> be present unless the recipient has indicated that they are capable of ignoring it successfully.
An implementation that is capable of receiving a Transferable Public Key with a version 6 Public Key primary key <span class="bcp14">MUST</span> be able to accept (and ignore) the trailing optional Padding packet.<a class="pilcrow" href="#section-10.1.5-10">¶</a></p>
<p id="section-10.1.5-11">Transferable Public Key packet sequences may be concatenated to allow transferring multiple public keys in one operation (see <a class="auto internal xref" href="#keyrings">Section 3.6</a>).<a class="pilcrow" href="#section-10.1.5-11">¶</a></p>
</section>
</div>
</section>
</div>
<div id="transferable-secret-keys">
<section id="section-10.2">
        <h3 id="name-transferable-secret-keys">
<a class="section-number selfRef" href="#section-10.2">10.2. </a><a class="section-name selfRef" href="#name-transferable-secret-keys">Transferable Secret Keys</a>
        </h3>
<p id="section-10.2-1">OpenPGP users may transfer secret keys.
 The format of a Transferable Secret Key is the same as a Transferable Public Key except that Secret Key and Secret Subkey packets can be used in addition to the Public Key and Public Subkey packets. If a single Secret Key or Secret Subkey packet is included in a packet sequence, it is a Transferable Secret Key and should be handled and marked as such (see <a class="auto internal xref" href="#armor-header-line">Section 6.2.1</a>).
An implementation <span class="bcp14">SHOULD</span> include self-signatures on any User IDs and subkeys, as this allows for a complete public key to be automatically extracted from the Transferable Secret Key. An implementation <span class="bcp14">MAY</span> choose to omit the self-signatures, especially if a Transferable Public Key accompanies the Transferable Secret Key.<a class="pilcrow" href="#section-10.2-1">¶</a></p>
</section>
</div>
<div id="openpgp-messages">
<section id="section-10.3">
        <h3 id="name-openpgp-messages">
<a class="section-number selfRef" href="#section-10.3">10.3. </a><a class="section-name selfRef" href="#name-openpgp-messages">OpenPGP Messages</a>
        </h3>
<p id="section-10.3-1">An OpenPGP Message is a packet or sequence of packets that adheres to the following grammatical rules (a comma (,) represents sequential composition, and a vertical bar (|) separates alternatives):<a class="pilcrow" href="#section-10.3-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-10.3-2">
          <dt id="section-10.3-2.1">OpenPGP Message:</dt>
          <dd id="section-10.3-2.2" style="margin-left: 1.5em">
            <p id="section-10.3-2.2.1">Encrypted Message | Signed Message | Compressed Message | Literal Message.<a class="pilcrow" href="#section-10.3-2.2.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-10.3-2.3">Compressed Message:</dt>
          <dd id="section-10.3-2.4" style="margin-left: 1.5em">
            <p id="section-10.3-2.4.1">Compressed Data Packet.<a class="pilcrow" href="#section-10.3-2.4.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-10.3-2.5">Literal Message:</dt>
          <dd id="section-10.3-2.6" style="margin-left: 1.5em">
            <p id="section-10.3-2.6.1">Literal Data Packet.<a class="pilcrow" href="#section-10.3-2.6.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-10.3-2.7">ESK:</dt>
          <dd id="section-10.3-2.8" style="margin-left: 1.5em">
            <p id="section-10.3-2.8.1">Public Key Encrypted Session Key Packet | Symmetric Key Encrypted Session Key Packet.<a class="pilcrow" href="#section-10.3-2.8.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-10.3-2.9">ESK Sequence:</dt>
          <dd id="section-10.3-2.10" style="margin-left: 1.5em">
            <p id="section-10.3-2.10.1">ESK | ESK Sequence, ESK.<a class="pilcrow" href="#section-10.3-2.10.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-10.3-2.11">Encrypted Data:</dt>
          <dd id="section-10.3-2.12" style="margin-left: 1.5em">
            <p id="section-10.3-2.12.1">Symmetrically Encrypted Data Packet | Symmetrically Encrypted and Integrity Protected Data Packet.<a class="pilcrow" href="#section-10.3-2.12.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-10.3-2.13">Encrypted Message:</dt>
          <dd id="section-10.3-2.14" style="margin-left: 1.5em">
            <p id="section-10.3-2.14.1">Encrypted Data | ESK Sequence, Encrypted Data.<a class="pilcrow" href="#section-10.3-2.14.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-10.3-2.15">One-Pass Signed Message:</dt>
          <dd id="section-10.3-2.16" style="margin-left: 1.5em">
            <p id="section-10.3-2.16.1">One-Pass Signature Packet, OpenPGP Message, Corresponding Signature Packet.<a class="pilcrow" href="#section-10.3-2.16.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-10.3-2.17">Signed Message:</dt>
          <dd id="section-10.3-2.18" style="margin-left: 1.5em">
            <p id="section-10.3-2.18.1">Signature Packet, OpenPGP Message | One-Pass Signed Message.<a class="pilcrow" href="#section-10.3-2.18.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-10.3-2.19">Optionally Padded Message:</dt>
          <dd id="section-10.3-2.20" style="margin-left: 1.5em">
            <p id="section-10.3-2.20.1">OpenPGP Message | OpenPGP Message, Padding Packet.<a class="pilcrow" href="#section-10.3-2.20.1">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-10.3-3">In addition to these rules, a Marker packet (<a class="auto internal xref" href="#marker-packet">Section 5.8</a>) can appear anywhere in the sequence.<a class="pilcrow" href="#section-10.3-3">¶</a></p>
<div id="unwrapping">
<section id="section-10.3.1">
          <h4 id="name-unwrapping-encrypted-and-co">
<a class="section-number selfRef" href="#section-10.3.1">10.3.1. </a><a class="section-name selfRef" href="#name-unwrapping-encrypted-and-co">Unwrapping Encrypted and Compressed Messages</a>
          </h4>
<p id="section-10.3.1-1">In addition to the above grammar, certain messages can be "unwrapped" to yield new messages.
In particular:<a class="pilcrow" href="#section-10.3.1-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.3.1-2.1">
              <p id="section-10.3.1-2.1.1">Decrypting a version 2 Symmetrically Encrypted and Integrity Protected Data packet <span class="bcp14">MUST</span> yield a valid Optionally Padded Message.<a class="pilcrow" href="#section-10.3.1-2.1.1">¶</a></p>
</li>
            <li class="normal" id="section-10.3.1-2.2">
              <p id="section-10.3.1-2.2.1">Decrypting a version 1 Symmetrically Encrypted and Integrity Protected Data packet or -- for historic data -- a Symmetrically Encrypted Data packet <span class="bcp14">MUST</span> yield a valid OpenPGP Message.<a class="pilcrow" href="#section-10.3.1-2.2.1">¶</a></p>
</li>
            <li class="normal" id="section-10.3.1-2.3">
              <p id="section-10.3.1-2.3.1">Decompressing a Compressed Data packet <span class="bcp14">MUST</span> also yield a valid OpenPGP Message.<a class="pilcrow" href="#section-10.3.1-2.3.1">¶</a></p>
</li>
          </ul>
<p id="section-10.3.1-3">When any unwrapping is performed, the resulting stream of octets is parsed into a series of OpenPGP packets like any other stream of octets.
The packet boundaries found in the series of octets are expected to align with the length of the unwrapped octet stream.
An implementation <span class="bcp14">MUST NOT</span> interpret octets beyond the boundaries of the unwrapped octet stream as part of any OpenPGP packet.
If an implementation encounters a packet whose header length indicates that it would extend beyond the boundaries of the unwrapped octet stream, the implementation <span class="bcp14">MUST</span> reject that packet as malformed and unusable.<a class="pilcrow" href="#section-10.3.1-3">¶</a></p>
</section>
</div>
<div id="additional-constraints-on-packet-sequences">
<section id="section-10.3.2">
          <h4 id="name-additional-constraints-on-p">
<a class="section-number selfRef" href="#section-10.3.2">10.3.2. </a><a class="section-name selfRef" href="#name-additional-constraints-on-p">Additional Constraints on Packet Sequences</a>
          </h4>
<p id="section-10.3.2-1">Note that some subtle combinations that are formally acceptable by this grammar are nonetheless unacceptable.<a class="pilcrow" href="#section-10.3.2-1">¶</a></p>
<div id="encrypted-message-versions">
<section id="section-10.3.2.1">
            <h5 id="name-packet-versions-in-encrypte">
<a class="section-number selfRef" href="#section-10.3.2.1">10.3.2.1. </a><a class="section-name selfRef" href="#name-packet-versions-in-encrypte">Packet Versions in Encrypted Messages</a>
            </h5>
<p id="section-10.3.2.1-1">As noted above, an Encrypted Message is a sequence of zero or more PKESK packets (<a class="auto internal xref" href="#pkesk">Section 5.1</a>) and SKESK packets (<a class="auto internal xref" href="#skesk">Section 5.3</a>), followed by an SEIPD (<a class="auto internal xref" href="#seipd">Section 5.13</a>) payload. In some historic data, the payload may be a deprecated SED packet (<a class="auto internal xref" href="#sed">Section 5.7</a>) instead of SEIPD, though implementations <span class="bcp14">MUST NOT</span> generate SED packets (see <a class="auto internal xref" href="#ciphertext-malleability">Section 13.7</a>).
The versions of the preceding ESK packets within an Encrypted Message <span class="bcp14">MUST</span> align with the version of the payload SEIPD packet, as described in this section.<a class="pilcrow" href="#section-10.3.2.1-1">¶</a></p>
<p id="section-10.3.2.1-2">v3 PKESK and v4 SKESK packets both contain the Symmetric Cipher Algorithm ID and the session key for the subsequent SEIPD packet in their cleartext.
Since a v1 SEIPD does not contain a symmetric algorithm ID, all ESK packets preceding a v1 SEIPD payload <span class="bcp14">MUST</span> be either v3 PKESK or v4 SKESK.<a class="pilcrow" href="#section-10.3.2.1-2">¶</a></p>
<p id="section-10.3.2.1-3">On the other hand, the cleartext of the v6 ESK packets (either PKESK or SKESK) do not contain a Symmetric Cipher Algorithm ID, so they cannot be used in combination with a v1 SEIPD payload.
The payload following any v6 PKESK or v6 SKESK packet <span class="bcp14">MUST</span> be a v2 SEIPD.<a class="pilcrow" href="#section-10.3.2.1-3">¶</a></p>
<p id="section-10.3.2.1-4">Additionally, to avoid potentially conflicting cipher algorithm IDs, and for simplicity, implementations <span class="bcp14">MUST NOT</span> precede a v2 SEIPD payload with either v3 PKESK or v4 SKESK packets.<a class="pilcrow" href="#section-10.3.2.1-4">¶</a></p>
<p id="section-10.3.2.1-5">The versions of packets found in an Encrypted Message are summarized in the following table.
An implementation <span class="bcp14">MUST</span> only generate an Encrypted Message using packet versions that match a row with "Yes" in the "Generate?" column.
Other rows are provided for the purpose of historic interoperability.
A conforming implementation <span class="bcp14">MUST</span> only generate an Encrypted Message using packets whose versions correspond to a single row.<a class="pilcrow" href="#section-10.3.2.1-5">¶</a></p>
<span id="name-openpgp-encrypted-message-p"></span><div id="encrypted-packet-versions-registry">
<table class="center" id="table-26">
              <caption>
<a class="selfRef" href="#table-26">Table 26</a>:
<a class="selfRef" href="#name-openpgp-encrypted-message-p">OpenPGP Encrypted Message Packet Versions Registry</a>
              </caption>
<thead>
                <tr>
                  <th class="text-left" colspan="1" rowspan="1">Version of Encrypted Data Payload</th>
                  <th class="text-left" colspan="1" rowspan="1">Version of Preceding Symmetric Key ESK (If Any)</th>
                  <th class="text-left" colspan="1" rowspan="1">Version of Preceding Public Key ESK (If Any)</th>
                  <th class="text-left" colspan="1" rowspan="1">Generate?</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">SED (<a class="auto internal xref" href="#sed">Section 5.7</a>)</td>
                  <td class="text-left" colspan="1" rowspan="1">-</td>
                  <td class="text-left" colspan="1" rowspan="1">v2 PKESK <span>[<a class="cite xref" href="#RFC2440">RFC2440</a>]</span>
</td>
                  <td class="text-left" colspan="1" rowspan="1">No</td>
                </tr>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">SED (<a class="auto internal xref" href="#sed">Section 5.7</a>)</td>
                  <td class="text-left" colspan="1" rowspan="1">v4 SKESK (<a class="auto internal xref" href="#v4-skesk">Section 5.3.1</a>)</td>
                  <td class="text-left" colspan="1" rowspan="1">v3 PKESK (<a class="auto internal xref" href="#v3-pkesk">Section 5.1.1</a>)</td>
                  <td class="text-left" colspan="1" rowspan="1">No</td>
                </tr>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">v1 SEIPD (<a class="auto internal xref" href="#version-one-seipd">Section 5.13.1</a>)</td>
                  <td class="text-left" colspan="1" rowspan="1">v4 SKESK (<a class="auto internal xref" href="#v4-skesk">Section 5.3.1</a>)</td>
                  <td class="text-left" colspan="1" rowspan="1">v3 PKESK (<a class="auto internal xref" href="#v3-pkesk">Section 5.1.1</a>)</td>
                  <td class="text-left" colspan="1" rowspan="1">Yes</td>
                </tr>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">v2 SEIPD (<a class="auto internal xref" href="#version-two-seipd">Section 5.13.2</a>)</td>
                  <td class="text-left" colspan="1" rowspan="1">v6 SKESK (<a class="auto internal xref" href="#v6-skesk">Section 5.3.2</a>)</td>
                  <td class="text-left" colspan="1" rowspan="1">v6 PKESK (<a class="auto internal xref" href="#v6-pkesk">Section 5.1.2</a>)</td>
                  <td class="text-left" colspan="1" rowspan="1">Yes</td>
                </tr>
              </tbody>
            </table>
</div>
<p id="section-10.3.2.1-7">An implementation processing an Encrypted Message <span class="bcp14">MUST</span> discard any preceding ESK packet with a version that does not align with the version of the payload.<a class="pilcrow" href="#section-10.3.2.1-7">¶</a></p>
</section>
</div>
<div id="signed-message-versions">
<section id="section-10.3.2.2">
            <h5 id="name-packet-versions-in-signatur">
<a class="section-number selfRef" href="#section-10.3.2.2">10.3.2.2. </a><a class="section-name selfRef" href="#name-packet-versions-in-signatur">Packet Versions in Signatures</a>
            </h5>
<p id="section-10.3.2.2-1">OpenPGP Key packets and Signature packets are also versioned.
The version of a Signature typically matches the version of the signing key.
When a version 6 key produces a Signature packet, it <span class="bcp14">MUST</span> produce a version 6 Signature packet, regardless of the Signature packet type.
When a message is signed or verified using the one-pass construction, the version of the One-Pass Signature packet (<a class="auto internal xref" href="#one-pass-sig">Section 5.4</a>) should also be aligned to the other versions.<a class="pilcrow" href="#section-10.3.2.2-1">¶</a></p>
<p id="section-10.3.2.2-2">Some legacy implementations have produced unaligned signature versions for older key material, which are also described in the table below for the purpose of historic interoperability.
A conforming implementation <span class="bcp14">MUST</span> only generate Signature packets with version numbers matching rows with "Yes" in the "Generate?" column.<a class="pilcrow" href="#section-10.3.2.2-2">¶</a></p>
<span id="name-openpgp-key-and-signature-v"></span><div id="signed-packet-versions-registry">
<table class="center" id="table-27">
              <caption>
<a class="selfRef" href="#table-27">Table 27</a>:
<a class="selfRef" href="#name-openpgp-key-and-signature-v">OpenPGP Key and Signature Versions Registry</a>
              </caption>
<thead>
                <tr>
                  <th class="text-left" colspan="1" rowspan="1">Signing Key Version</th>
                  <th class="text-left" colspan="1" rowspan="1">Signature Packet Version</th>
                  <th class="text-left" colspan="1" rowspan="1">OPS Packet Version</th>
                  <th class="text-left" colspan="1" rowspan="1">Generate?</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">3 (<a class="auto internal xref" href="#v3-pubkeys">Section 5.5.2.1</a>)</td>
                  <td class="text-left" colspan="1" rowspan="1">3 (<a class="auto internal xref" href="#version-three-sig">Section 5.2.2</a>)</td>
                  <td class="text-left" colspan="1" rowspan="1">3 (<a class="auto internal xref" href="#one-pass-sig">Section 5.4</a>)</td>
                  <td class="text-left" colspan="1" rowspan="1">No</td>
                </tr>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">4 (<a class="auto internal xref" href="#v4-pubkeys">Section 5.5.2.2</a>)</td>
                  <td class="text-left" colspan="1" rowspan="1">3 (<a class="auto internal xref" href="#version-three-sig">Section 5.2.2</a>)</td>
                  <td class="text-left" colspan="1" rowspan="1">3 (<a class="auto internal xref" href="#one-pass-sig">Section 5.4</a>)</td>
                  <td class="text-left" colspan="1" rowspan="1">No</td>
                </tr>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">4 (<a class="auto internal xref" href="#v4-pubkeys">Section 5.5.2.2</a>)</td>
                  <td class="text-left" colspan="1" rowspan="1">4 (<a class="auto internal xref" href="#version-four-and-six-sig">Section 5.2.3</a>)</td>
                  <td class="text-left" colspan="1" rowspan="1">3 (<a class="auto internal xref" href="#one-pass-sig">Section 5.4</a>)</td>
                  <td class="text-left" colspan="1" rowspan="1">Yes</td>
                </tr>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">6 (<a class="auto internal xref" href="#v6-pubkeys">Section 5.5.2.3</a>)</td>
                  <td class="text-left" colspan="1" rowspan="1">6 (<a class="auto internal xref" href="#version-four-and-six-sig">Section 5.2.3</a>)</td>
                  <td class="text-left" colspan="1" rowspan="1">6 (<a class="auto internal xref" href="#one-pass-sig">Section 5.4</a>)</td>
                  <td class="text-left" colspan="1" rowspan="1">Yes</td>
                </tr>
              </tbody>
            </table>
</div>
<p id="section-10.3.2.2-4">Note, however, that a version mismatch between these packets does not invalidate the packet sequence as a whole; it merely invalidates the signature, as a signature with an unknown version <span class="bcp14">SHOULD</span> be discarded (see <a class="auto internal xref" href="#malformed-signatures">Section 5.2.5</a>).<a class="pilcrow" href="#section-10.3.2.2-4">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="detached-signatures">
<section id="section-10.4">
        <h3 id="name-detached-signatures">
<a class="section-number selfRef" href="#section-10.4">10.4. </a><a class="section-name selfRef" href="#name-detached-signatures">Detached Signatures</a>
        </h3>
<p id="section-10.4-1">Some OpenPGP applications use so-called "detached signatures".
For example, a program bundle may contain a file, and with it a second file that is a detached signature of the first file. These detached signatures are simply one or more Signature packets stored separately from the data for which they are a signature.<a class="pilcrow" href="#section-10.4-1">¶</a></p>
<p id="section-10.4-2">In addition, a Marker packet (<a class="auto internal xref" href="#marker-packet">Section 5.8</a>) and a Padding packet (<a class="auto internal xref" href="#padding-packet">Section 5.14</a>) can appear anywhere in the sequence.<a class="pilcrow" href="#section-10.4-2">¶</a></p>
</section>
</div>
</section>
</div>
<div id="elliptic-curve-cryptography">
<section id="section-11">
      <h2 id="name-elliptic-curve-cryptography">
<a class="section-number selfRef" href="#section-11">11. </a><a class="section-name selfRef" href="#name-elliptic-curve-cryptography">Elliptic Curve Cryptography</a>
      </h2>
<p id="section-11-1">This section describes algorithms and parameters used with Elliptic Curve Cryptography (ECC) keys. A thorough introduction to ECC can be found in <span>[<a class="cite xref" href="#KOBLITZ">KOBLITZ</a>]</span>. Refer to <span>[<a class="cite xref" href="#FIPS186">FIPS186</a>]</span>, Appendix B.4, for the methods to generate a uniformly distributed ECC private key.<a class="pilcrow" href="#section-11-1">¶</a></p>
<p id="section-11-2">None of the ECC methods described in this document are allowed with deprecated version 3 keys.<a class="pilcrow" href="#section-11-2">¶</a></p>
<div id="ecc-curves">
<section id="section-11.1">
        <h3 id="name-ecc-curves">
<a class="section-number selfRef" href="#section-11.1">11.1. </a><a class="section-name selfRef" href="#name-ecc-curves">ECC Curves</a>
        </h3>
<p id="section-11.1-1">This document references three named prime field curves defined in <span>[<a class="cite xref" href="#FIPS186">FIPS186</a>]</span> as "Curve P-256", "Curve P-384", and "Curve P-521" and three named prime field curves defined in <span>[<a class="cite xref" href="#RFC5639">RFC5639</a>]</span> as "brainpoolP256r1", "brainpoolP384r1", and "brainpoolP512r1". All six curves can be used with ECDSA and ECDH public key algorithms. They are referenced using a sequence of octets, referred to as the curve OID. <a class="auto internal xref" href="#ec-curves">Section 9.2</a> describes in detail how this sequence of octets is formed.<a class="pilcrow" href="#section-11.1-1">¶</a></p>
<p id="section-11.1-2">Separate algorithms are also defined for the use of X25519 and X448 <span>[<a class="cite xref" href="#RFC7748">RFC7748</a>]</span> and Ed25519 and Ed448 <span>[<a class="cite xref" href="#RFC8032">RFC8032</a>]</span>.
Additionally, legacy OIDs are defined for "Curve25519Legacy" (for encryption using the ECDH algorithm) and "Ed25519Legacy" (for signing using the EdDSALegacy algorithm).<a class="pilcrow" href="#section-11.1-2">¶</a></p>
</section>
</div>
<div id="ec-point-wire-formats">
<section id="section-11.2">
        <h3 id="name-ec-point-wire-formats">
<a class="section-number selfRef" href="#section-11.2">11.2. </a><a class="section-name selfRef" href="#name-ec-point-wire-formats">EC Point Wire Formats</a>
        </h3>
<p id="section-11.2-1">A point on an elliptic curve will always be represented on the wire as an MPI.
Each curve uses a specific point format for the data within the MPI itself.
Each format uses a designated prefix octet to ensure that the high octet has at least 1 bit set to make the MPI a constant size.<a class="pilcrow" href="#section-11.2-1">¶</a></p>
<span id="name-openpgp-elliptic-curve-poin"></span><div id="ec-point-wire-formats-registry">
<table class="center" id="table-28">
          <caption>
<a class="selfRef" href="#table-28">Table 28</a>:
<a class="selfRef" href="#name-openpgp-elliptic-curve-poin">OpenPGP Elliptic Curve Point Wire Formats Registry</a>
          </caption>
<thead>
            <tr>
              <th class="text-right" colspan="1" rowspan="1">Name</th>
              <th class="text-left" colspan="1" rowspan="1">Wire Format</th>
              <th class="text-left" colspan="1" rowspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">SEC1</td>
              <td class="text-left" colspan="1" rowspan="1">0x04 || x || y</td>
              <td class="text-left" colspan="1" rowspan="1">
                <a class="auto internal xref" href="#ec-point-sec1">Section 11.2.1</a>
</td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">Prefixed native</td>
              <td class="text-left" colspan="1" rowspan="1">0x40 || native</td>
              <td class="text-left" colspan="1" rowspan="1">
                <a class="auto internal xref" href="#ec-point-prefixed-native">Section 11.2.2</a>
</td>
            </tr>
          </tbody>
        </table>
</div>
<div id="ec-point-sec1">
<section id="section-11.2.1">
          <h4 id="name-sec1-ec-point-wire-format">
<a class="section-number selfRef" href="#section-11.2.1">11.2.1. </a><a class="section-name selfRef" href="#name-sec1-ec-point-wire-format">SEC1 EC Point Wire Format</a>
          </h4>
<p id="section-11.2.1-1">For a SEC1-encoded (uncompressed) point, the content of the MPI is:<a class="pilcrow" href="#section-11.2.1-1">¶</a></p>
<div class="alignLeft art-text artwork" id="section-11.2.1-2">
<pre>B = 04 || x || y
</pre><a class="pilcrow" href="#section-11.2.1-2">¶</a>
</div>
<p id="section-11.2.1-3">where x and y are coordinates of the point P = (x, y), and each is encoded in the big-endian format and zero-padded to the adjusted underlying field size.
The adjusted underlying field size is the underlying field size rounded up to the nearest 8-bit boundary, as noted in the "fsize" column in <a class="auto internal xref" href="#ec-curves">Section 9.2</a>.
This encoding is compatible with the definition given in <span>[<a class="cite xref" href="#SEC1">SEC1</a>]</span>.<a class="pilcrow" href="#section-11.2.1-3">¶</a></p>
</section>
</div>
<div id="ec-point-prefixed-native">
<section id="section-11.2.2">
          <h4 id="name-prefixed-native-ec-point-wi">
<a class="section-number selfRef" href="#section-11.2.2">11.2.2. </a><a class="section-name selfRef" href="#name-prefixed-native-ec-point-wi">Prefixed Native EC Point Wire Format</a>
          </h4>
<p id="section-11.2.2-1">For a custom compressed point, the content of the MPI is:<a class="pilcrow" href="#section-11.2.2-1">¶</a></p>
<div class="alignLeft art-text artwork" id="section-11.2.2-2">
<pre>B = 40 || p
</pre><a class="pilcrow" href="#section-11.2.2-2">¶</a>
</div>
<p id="section-11.2.2-3">where p is the public key of the point encoded using the rules defined for the specified curve.
This format is used for ECDH keys based on curves expressed in Montgomery form and for points when using EdDSA.<a class="pilcrow" href="#section-11.2.2-3">¶</a></p>
</section>
</div>
<div id="notes-on-ec-point-wire-formats">
<section id="section-11.2.3">
          <h4 id="name-notes-on-ec-point-wire-form">
<a class="section-number selfRef" href="#section-11.2.3">11.2.3. </a><a class="section-name selfRef" href="#name-notes-on-ec-point-wire-form">Notes on EC Point Wire Formats</a>
          </h4>
<p id="section-11.2.3-1">Given the above definitions, the exact size of the MPI payload for an encoded point is 515 bits for both NIST P-256 and brainpoolP256r1, 771 for both NIST P-384 and brainpoolP384r1, 1059 for NIST P-521, 1027 for brainpoolP512r1, and 263 for both Curve25519Legacy and Ed25519Legacy. For example, the length of an EdDSALegacy public key for the curve Ed25519Legacy is 263 bits: 7 bits to represent the 0x40 prefix octet and 32 octets for the native value of the public key.<a class="pilcrow" href="#section-11.2.3-1">¶</a></p>
<p id="section-11.2.3-2">Even though the zero point (also called the "point at infinity") may occur as a result of arithmetic operations on points of an elliptic curve, it <span class="bcp14">SHALL NOT</span> appear in data structures defined in this document.<a class="pilcrow" href="#section-11.2.3-2">¶</a></p>
<p id="section-11.2.3-3">Each particular curve uses a designated wire format for the point found in its public key or ECDH data structure.
An implementation <span class="bcp14">MUST NOT</span> use a different wire format for a point other than the wire format associated with the curve.<a class="pilcrow" href="#section-11.2.3-3">¶</a></p>
</section>
</div>
</section>
</div>
<div id="ec-scalar-wire-formats">
<section id="section-11.3">
        <h3 id="name-ec-scalar-wire-formats">
<a class="section-number selfRef" href="#section-11.3">11.3. </a><a class="section-name selfRef" href="#name-ec-scalar-wire-formats">EC Scalar Wire Formats</a>
        </h3>
<p id="section-11.3-1">Some non-curve values in elliptic curve cryptography (for example, secret keys and signature components) are not points on a curve, but they are also encoded on the wire in OpenPGP as an MPI.<a class="pilcrow" href="#section-11.3-1">¶</a></p>
<p id="section-11.3-2">Because of different patterns of deployment, some curves treat these values as opaque bit strings with the high bit set, while others are treated as actual integers, encoded in the standard OpenPGP big-endian form.
 The choice of encoding is specific to the public key algorithm in use.<a class="pilcrow" href="#section-11.3-2">¶</a></p>
<span id="name-openpgp-elliptic-curve-scal"></span><div id="ec-scalar-wire-formats-registry">
<table class="center" id="table-29">
          <caption>
<a class="selfRef" href="#table-29">Table 29</a>:
<a class="selfRef" href="#name-openpgp-elliptic-curve-scal">OpenPGP Elliptic Curve Scalar Encodings Registry</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Type</th>
              <th class="text-left" colspan="1" rowspan="1">Description</th>
              <th class="text-left" colspan="1" rowspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">integer</td>
              <td class="text-left" colspan="1" rowspan="1">An integer encoded in big-endian format as a standard OpenPGP MPI</td>
              <td class="text-left" colspan="1" rowspan="1">
                <a class="auto internal xref" href="#mpi">Section 3.2</a>
</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">octet string</td>
              <td class="text-left" colspan="1" rowspan="1">An octet string of fixed length that may be shorter on the wire due to leading zeros being stripped by the MPI encoding and may need to be zero-padded before use</td>
              <td class="text-left" colspan="1" rowspan="1">
                <a class="auto internal xref" href="#ec-octet-string">Section 11.3.1</a>
</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">prefixed N octets</td>
              <td class="text-left" colspan="1" rowspan="1">An octet string of fixed length N, prefixed with octet 0x40 to ensure no leading zero octet</td>
              <td class="text-left" colspan="1" rowspan="1">
                <a class="auto internal xref" href="#ec-prefix">Section 11.3.2</a>
</td>
            </tr>
          </tbody>
        </table>
</div>
<div id="ec-octet-string">
<section id="section-11.3.1">
          <h4 id="name-ec-octet-string-wire-format">
<a class="section-number selfRef" href="#section-11.3.1">11.3.1. </a><a class="section-name selfRef" href="#name-ec-octet-string-wire-format">EC Octet String Wire Format</a>
          </h4>
<p id="section-11.3.1-1">Some opaque strings of octets are represented on the wire as an MPI by simply stripping the leading zeros and counting the remaining bits.
These strings are of known, fixed length.
They are represented in this document as <code>MPI(N octets of X)</code>, where <code>N</code> is the expected length in octets of the octet string.<a class="pilcrow" href="#section-11.3.1-1">¶</a></p>
<p id="section-11.3.1-2">For example, a 5-octet opaque string (<code>MPI(5 octets of X)</code>) where <code>X</code> has the value <code>00 02 EE 19 00</code> would be represented on the wire as an MPI like so: <code>00 1A 02 EE 19 00</code>.<a class="pilcrow" href="#section-11.3.1-2">¶</a></p>
<p id="section-11.3.1-3">To encode <code>X</code> to the wire format, set the MPI's 2-octet bit counter to the value of the highest set bit (bit 26, or 0x001A), and do not transfer the leading all-zero octet to the wire.<a class="pilcrow" href="#section-11.3.1-3">¶</a></p>
<p id="section-11.3.1-4">To reverse the process, an implementation can take the following steps, if it knows that X has an expected length of, for example, 5 octets:<a class="pilcrow" href="#section-11.3.1-4">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.3.1-5.1">
              <p id="section-11.3.1-5.1.1">Ensure that the MPI's 2-octet bit count is less than or equal to 40 (5 octets of 8 bits)<a class="pilcrow" href="#section-11.3.1-5.1.1">¶</a></p>
</li>
            <li class="normal" id="section-11.3.1-5.2">
              <p id="section-11.3.1-5.2.1">Allocate 5 octets, setting all to zero initially<a class="pilcrow" href="#section-11.3.1-5.2.1">¶</a></p>
</li>
            <li class="normal" id="section-11.3.1-5.3">
              <p id="section-11.3.1-5.3.1">Copy the MPI data octets (without the two count octets) into the lower octets of the allocated space<a class="pilcrow" href="#section-11.3.1-5.3.1">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="ec-prefix">
<section id="section-11.3.2">
          <h4 id="name-ec-prefixed-octet-string-wi">
<a class="section-number selfRef" href="#section-11.3.2">11.3.2. </a><a class="section-name selfRef" href="#name-ec-prefixed-octet-string-wi">EC Prefixed Octet String Wire Format</a>
          </h4>
<p id="section-11.3.2-1">Another way to ensure that a fixed-length bytes string is encoded simply to the wire while remaining in MPI format is to prefix the byte string with a dedicated non-zero octet.
This specification uses 0x40 as the prefix octet.
This is represented in this specification as <code>MPI(prefixed N octets of X)</code>, where <code>N</code> is the known byte string length.<a class="pilcrow" href="#section-11.3.2-1">¶</a></p>
<p id="section-11.3.2-2">For example, a 5-octet opaque string using <code>MPI(prefixed 5 octets of X)</code> where <code>X</code> has the value <code>00 02 EE 19 00</code> would be written to the wire form as: <code>00 2F 40 00 02 EE 19 00</code>.<a class="pilcrow" href="#section-11.3.2-2">¶</a></p>
<p id="section-11.3.2-3">To encode the string, prefix it with the octet 0x40 (whose 7th bit is set), and then set the MPI's 2-octet bit counter to 47 (0x002F -- 7 bits for the prefix octet and 40 bits for the string).<a class="pilcrow" href="#section-11.3.2-3">¶</a></p>
<p id="section-11.3.2-4">To decode the string from the wire, an implementation that knows that the variable is formed in this way can:<a class="pilcrow" href="#section-11.3.2-4">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.3.2-5.1">
              <p id="section-11.3.2-5.1.1">ensure that the first three octets of the MPI (the 2-bit count octets plus the prefix octet) are <code>00 2F 40</code>, and<a class="pilcrow" href="#section-11.3.2-5.1.1">¶</a></p>
</li>
            <li class="normal" id="section-11.3.2-5.2">
              <p id="section-11.3.2-5.2.1">use the remainder of the MPI directly off the wire.<a class="pilcrow" href="#section-11.3.2-5.2.1">¶</a></p>
</li>
          </ul>
<p id="section-11.3.2-6">Note that this is a similar approach to that used in the EC point encodings found in <a class="auto internal xref" href="#ec-point-prefixed-native">Section 11.2.2</a>.<a class="pilcrow" href="#section-11.3.2-6">¶</a></p>
</section>
</div>
</section>
</div>
<div id="key-derivation-function">
<section id="section-11.4">
        <h3 id="name-key-derivation-function">
<a class="section-number selfRef" href="#section-11.4">11.4. </a><a class="section-name selfRef" href="#name-key-derivation-function">Key Derivation Function</a>
        </h3>
<p id="section-11.4-1">A key derivation function (KDF) is necessary to implement EC encryption.
The Concatenation Key Derivation Function (Approved Alternative 1) <span>[<a class="cite xref" href="#SP800-56A">SP800-56A</a>]</span> with the KDF hash function that is SHA2-256 <span>[<a class="cite xref" href="#FIPS180">FIPS180</a>]</span> or stronger is <span class="bcp14">REQUIRED</span>.<a class="pilcrow" href="#section-11.4-1">¶</a></p>
<p id="section-11.4-2">For convenience, the synopsis of the encoding method is given below with significant simplifications attributable to the restricted choice of hash functions in this document.
However, <span>[<a class="cite xref" href="#SP800-56A">SP800-56A</a>]</span> is the normative source of the definition.<a class="pilcrow" href="#section-11.4-2">¶</a></p>
<div class="alignLeft art-text artwork" id="section-11.4-3">
<pre>//   Implements KDF( X, oBits, Param );
//   Input: point X = (x,y)
//   oBits - the desired size of output
//   hBits - the size of output of hash function Hash
//   Param - octets representing the parameters
//   Assumes that oBits &lt;= hBits
// Convert the point X to the octet string:
//   ZB' = 04 || x || y
// and extract the x portion from ZB'
ZB = x;
MB = Hash ( 00 || 00 || 00 || 01 || ZB || Param );
return oBits leftmost bits of MB.
</pre><a class="pilcrow" href="#section-11.4-3">¶</a>
</div>
<p id="section-11.4-4">Note that ZB in the KDF description above is the compact representation of X as defined in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc6090#section-4.2">Section 4.2</a> of [<a class="cite xref" href="#RFC6090">RFC6090</a>]</span>.<a class="pilcrow" href="#section-11.4-4">¶</a></p>
</section>
</div>
<div id="ecdh">
<section id="section-11.5">
        <h3 id="name-ecdh-algorithm">
<a class="section-number selfRef" href="#section-11.5">11.5. </a><a class="section-name selfRef" href="#name-ecdh-algorithm">ECDH Algorithm</a>
        </h3>
<p id="section-11.5-1">This section describes the One-Pass Diffie-Hellman method, which is a
combination of the ECC Diffie-Hellman method that establishes a
shared secret and the key derivation method that processes the
shared secret into a derived key.  Additionally, this section
describes a key wrapping method that uses the derived key to protect
a session key used to encrypt a message.<a class="pilcrow" href="#section-11.5-1">¶</a></p>
<p id="section-11.5-2">The One-Pass Diffie-Hellman method C(1, 1, ECC CDH) <span>[<a class="cite xref" href="#SP800-56A">SP800-56A</a>]</span> <span class="bcp14">MUST</span> be implemented with the following restrictions: the ECC Cofactor Diffie-Hellman (CDH) primitive employed by this method is modified to always assume the cofactor is 1, the KDF specified in <a class="auto internal xref" href="#key-derivation-function">Section 11.4</a> is used, and the KDF parameters specified below are used.<a class="pilcrow" href="#section-11.5-2">¶</a></p>
<p id="section-11.5-3">The KDF parameters are encoded as a concatenation of the following 5 variable-length and fixed-length fields, which are compatible with the definition of the OtherInfo bit string <span>[<a class="cite xref" href="#SP800-56A">SP800-56A</a>]</span>:<a class="pilcrow" href="#section-11.5-3">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.5-4.1">
            <p id="section-11.5-4.1.1">A variable-length field containing a curve OID, which is formatted as follows:<a class="pilcrow" href="#section-11.5-4.1.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.5-4.1.2.1">
                <p id="section-11.5-4.1.2.1.1">A 1-octet size of the following field.<a class="pilcrow" href="#section-11.5-4.1.2.1.1">¶</a></p>
</li>
              <li class="normal" id="section-11.5-4.1.2.2">
                <p id="section-11.5-4.1.2.2.1">The octets representing a curve OID, as defined in <a class="auto internal xref" href="#ec-curves">Section 9.2</a>.<a class="pilcrow" href="#section-11.5-4.1.2.2.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-11.5-4.2">
            <p id="section-11.5-4.2.1">A 1-octet public key algorithm ID, as defined in <a class="auto internal xref" href="#pubkey-algos">Section 9.1</a>.<a class="pilcrow" href="#section-11.5-4.2.1">¶</a></p>
</li>
          <li class="normal" id="section-11.5-4.3">
            <p id="section-11.5-4.3.1">A variable-length field containing KDF parameters, which are identical to the corresponding field in the ECDH public key and formatted as follows:<a class="pilcrow" href="#section-11.5-4.3.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.5-4.3.2.1">
                <p id="section-11.5-4.3.2.1.1">A 1-octet size of the following fields; values 0 and 0xFF are reserved for future extensions.<a class="pilcrow" href="#section-11.5-4.3.2.1.1">¶</a></p>
</li>
              <li class="normal" id="section-11.5-4.3.2.2">
                <p id="section-11.5-4.3.2.2.1">A 1-octet value 0x01, reserved for future extensions.<a class="pilcrow" href="#section-11.5-4.3.2.2.1">¶</a></p>
</li>
              <li class="normal" id="section-11.5-4.3.2.3">
                <p id="section-11.5-4.3.2.3.1">A 1-octet hash function ID used with the KDF.<a class="pilcrow" href="#section-11.5-4.3.2.3.1">¶</a></p>
</li>
              <li class="normal" id="section-11.5-4.3.2.4">
                <p id="section-11.5-4.3.2.4.1">A 1-octet algorithm ID for the symmetric algorithm that is used to wrap the symmetric key for message encryption; see <a class="auto internal xref" href="#ecdh">Section 11.5</a> for details.<a class="pilcrow" href="#section-11.5-4.3.2.4.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-11.5-4.4">
            <p id="section-11.5-4.4.1">20 octets representing the UTF-8 encoding of the string "Anonymous Sender" padded at the end with spaces (0x20) to 20 octets, which is the octet sequence 41 6E 6F 6E 79 6D 6F 75 73 20 53 65 6E 64 65 72 20 20 20 20.<a class="pilcrow" href="#section-11.5-4.4.1">¶</a></p>
</li>
          <li class="normal" id="section-11.5-4.5">
            <p id="section-11.5-4.5.1">A variable-length field containing the fingerprint of the recipient encryption subkey identifying the key material that is needed for decryption.
For version 4 keys, this field is 20 octets.
For version 6 keys, this field is 32 octets.<a class="pilcrow" href="#section-11.5-4.5.1">¶</a></p>
</li>
        </ul>
<p id="section-11.5-5">The size in octets of the KDF parameters sequence, as defined above, for encrypting to a version 4 key is 54 for curve NIST P-256; 51 for curves NIST P-384 and NIST P-521; 55 for curves brainpoolP256r1, brainpoolP384r1, and brainpoolP512r1; or 56 for Curve25519Legacy. For encrypting to a version 6 key, the size of the sequence is 66 for curve NIST P-256; 63 for curves NIST P-384 and NIST P-521; or 67 for curves brainpoolP256r1, brainpoolP384r1, and brainpoolP512r1.<a class="pilcrow" href="#section-11.5-5">¶</a></p>
<p id="section-11.5-6">The key wrapping method is described in <span>[<a class="cite xref" href="#RFC3394">RFC3394</a>]</span>.
The KDF produces a symmetric key that is used as a KEK as specified in <span>[<a class="cite xref" href="#RFC3394">RFC3394</a>]</span>. Refer to <a class="auto internal xref" href="#ecdh-parameters">Section 11.5.1</a> for the details regarding the choice of the KEK algorithm, which <span class="bcp14">SHOULD</span> be one of the three AES algorithms.
Key wrapping and unwrapping is performed with the default initial value of <span>[<a class="cite xref" href="#RFC3394">RFC3394</a>]</span>.<a class="pilcrow" href="#section-11.5-6">¶</a></p>
<p id="section-11.5-7">To produce the input to the key wrapping method, first concatenate the following values:<a class="pilcrow" href="#section-11.5-7">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.5-8.1">
            <p id="section-11.5-8.1.1">The 1-octet algorithm identifier, if it was passed (in the case of a v3 PKESK packet).<a class="pilcrow" href="#section-11.5-8.1.1">¶</a></p>
</li>
          <li class="normal" id="section-11.5-8.2">
            <p id="section-11.5-8.2.1">The session key.<a class="pilcrow" href="#section-11.5-8.2.1">¶</a></p>
</li>
          <li class="normal" id="section-11.5-8.3">
            <p id="section-11.5-8.3.1">A 2-octet checksum of the session key, equal to the sum of the session key octets, modulo 65536.<a class="pilcrow" href="#section-11.5-8.3.1">¶</a></p>
</li>
        </ul>
<p id="section-11.5-9">Then, the above values are padded to an 8-octet granularity using the method described in <span>[<a class="cite xref" href="#RFC8018">RFC8018</a>]</span>.<a class="pilcrow" href="#section-11.5-9">¶</a></p>
<p id="section-11.5-10">For example, in a version 3 Public Key Encrypted Session Key packet, an AES-256 session key is encoded as follows, forming a 40-octet sequence:<a class="pilcrow" href="#section-11.5-10">¶</a></p>
<div class="alignLeft art-text artwork" id="section-11.5-11">
<pre>09 k0 k1 ... k31 s0 s1 05 05 05 05 05
</pre><a class="pilcrow" href="#section-11.5-11">¶</a>
</div>
<p id="section-11.5-12">The octets k0 to k31 above denote the session key, and the octets s0 and s1 denote the checksum of the session key octets.
This encoding allows the sender to obfuscate the size of the symmetric encryption key used to encrypt the data.
For example, assuming that an AES algorithm is used for the session key, the sender <span class="bcp14">MAY</span> use 21, 13, and 5 octets of padding for AES-128, AES-192, and AES-256, respectively, to provide the same number of octets, 40 total, as an input to the key wrapping method.<a class="pilcrow" href="#section-11.5-12">¶</a></p>
<p id="section-11.5-13">In a version 6 Public Key Encrypted Session Key packet, the symmetric algorithm is not included, as described in <a class="auto internal xref" href="#pkesk">Section 5.1</a>.
For example, an AES-256 session key would be composed as follows:<a class="pilcrow" href="#section-11.5-13">¶</a></p>
<div class="alignLeft art-text artwork" id="section-11.5-14">
<pre>k0 k1 ... k31 s0 s1 06 06 06 06 06 06
</pre><a class="pilcrow" href="#section-11.5-14">¶</a>
</div>
<p id="section-11.5-15">The octets k0 to k31 above again denote the session key, and the octets s0 and s1 denote the checksum.
In this case, assuming that an AES algorithm is used for the session key, the sender <span class="bcp14">MAY</span> use 22, 14, and 6 octets of padding for AES-128, AES-192, and AES-256, respectively, to provide the same number of octets, 40 total, as an input to the key wrapping method.<a class="pilcrow" href="#section-11.5-15">¶</a></p>
<p id="section-11.5-16">The output of the method consists of two fields.
The first field is the MPI containing the ephemeral key used to establish the shared secret.
The second field is composed of the following two subfields:<a class="pilcrow" href="#section-11.5-16">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.5-17.1">
            <p id="section-11.5-17.1.1">One octet encoding the size in octets of the result of the key wrapping method; the value 255 is reserved for future extensions.<a class="pilcrow" href="#section-11.5-17.1.1">¶</a></p>
</li>
          <li class="normal" id="section-11.5-17.2">
            <p id="section-11.5-17.2.1">Up to 254 octets representing the result of the key wrapping method, applied to the 8-octet padded session key, as described above.<a class="pilcrow" href="#section-11.5-17.2.1">¶</a></p>
</li>
        </ul>
<p id="section-11.5-18">Note that for session key sizes 128, 192, and 256 bits, the size of the result of the key wrapping method is, respectively, 32, 40, and 48 octets, unless size obfuscation is used.<a class="pilcrow" href="#section-11.5-18">¶</a></p>
<p id="section-11.5-19">For convenience, the synopsis of the encoding method is given below; however, this section, <span>[<a class="cite xref" href="#SP800-56A">SP800-56A</a>]</span>, and <span>[<a class="cite xref" href="#RFC3394">RFC3394</a>]</span> are the normative sources of the definition.<a class="pilcrow" href="#section-11.5-19">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.5-20.1">
            <p id="section-11.5-20.1.1">Obtain the authenticated recipient public key R<a class="pilcrow" href="#section-11.5-20.1.1">¶</a></p>
</li>
          <li class="normal" id="section-11.5-20.2">
            <p id="section-11.5-20.2.1">Generate an ephemeral, single-use key pair {v, V=vG}<a class="pilcrow" href="#section-11.5-20.2.1">¶</a></p>
</li>
          <li class="normal" id="section-11.5-20.3">
            <p id="section-11.5-20.3.1">Compute the shared point S = vR<a class="pilcrow" href="#section-11.5-20.3.1">¶</a></p>
</li>
          <li class="normal" id="section-11.5-20.4">
            <p id="section-11.5-20.4.1">m = symm_alg_ID || session key || checksum || pkcs5_padding<a class="pilcrow" href="#section-11.5-20.4.1">¶</a></p>
</li>
          <li class="normal" id="section-11.5-20.5">
            <p id="section-11.5-20.5.1">curve_OID_len = (octet)len(curve_OID)<a class="pilcrow" href="#section-11.5-20.5.1">¶</a></p>
</li>
          <li class="normal" id="section-11.5-20.6">
            <p id="section-11.5-20.6.1">Param = curve_OID_len || curve_OID || public_key_alg_ID || 03 || 01 || KDF_hash_ID || KEK_alg_ID for AESKeyWrap || 41 6E 6F 6E 79 6D 6F 75 73 20 53 65 6E 64 65 72 20 20 20 20 || recipient_fingerprint<a class="pilcrow" href="#section-11.5-20.6.1">¶</a></p>
</li>
          <li class="normal" id="section-11.5-20.7">
            <p id="section-11.5-20.7.1">Z_len = the key size for the KEK_alg_ID used with AESKeyWrap<a class="pilcrow" href="#section-11.5-20.7.1">¶</a></p>
</li>
          <li class="normal" id="section-11.5-20.8">
            <p id="section-11.5-20.8.1">Compute Z = KDF( S, Z_len, Param )<a class="pilcrow" href="#section-11.5-20.8.1">¶</a></p>
</li>
          <li class="normal" id="section-11.5-20.9">
            <p id="section-11.5-20.9.1">Compute C = AESKeyWrap( Z, m ) (per <span>[<a class="cite xref" href="#RFC3394">RFC3394</a>]</span>)<a class="pilcrow" href="#section-11.5-20.9.1">¶</a></p>
</li>
          <li class="normal" id="section-11.5-20.10">
            <p id="section-11.5-20.10.1">Wipe the memory that contained S, v, and Z to avoid leaking ephemeral secrets<a class="pilcrow" href="#section-11.5-20.10.1">¶</a></p>
</li>
          <li class="normal" id="section-11.5-20.11">
            <p id="section-11.5-20.11.1">VB = convert point V to the octet string<a class="pilcrow" href="#section-11.5-20.11.1">¶</a></p>
</li>
          <li class="normal" id="section-11.5-20.12">
            <p id="section-11.5-20.12.1">Output (MPI(VB) || len(C) || C)<a class="pilcrow" href="#section-11.5-20.12.1">¶</a></p>
</li>
        </ul>
<p id="section-11.5-21">The decryption is the inverse of the method given.
Note that the recipient with key pair (r,R) obtains the shared secret by calculating:<a class="pilcrow" href="#section-11.5-21">¶</a></p>
<div class="alignLeft art-text artwork" id="section-11.5-22">
<pre>S = rV = rvG
</pre><a class="pilcrow" href="#section-11.5-22">¶</a>
</div>
<div id="ecdh-parameters">
<section id="section-11.5.1">
          <h4 id="name-ecdh-parameters">
<a class="section-number selfRef" href="#section-11.5.1">11.5.1. </a><a class="section-name selfRef" href="#name-ecdh-parameters">ECDH Parameters</a>
          </h4>
<p id="section-11.5.1-1">ECDH keys have a hash algorithm parameter for key derivation and a symmetric algorithm for key encapsulation.<a class="pilcrow" href="#section-11.5.1-1">¶</a></p>
<p id="section-11.5.1-2">For version 6 keys, the following algorithms <span class="bcp14">MUST</span> be used depending on the curve.
An implementation <span class="bcp14">MUST NOT</span> generate a version 6 ECDH key over any listed curve that uses different KDF or KEK parameters.
An implementation <span class="bcp14">MUST NOT</span> encrypt any message to a version 6 ECDH key over a listed curve that announces a different KDF or KEK parameter.<a class="pilcrow" href="#section-11.5.1-2">¶</a></p>
<p id="section-11.5.1-3">For version 4 keys, the following algorithms <span class="bcp14">SHOULD</span> be used depending on the curve.
An implementation <span class="bcp14">SHOULD</span> only use an AES algorithm as a KEK algorithm.<a class="pilcrow" href="#section-11.5.1-3">¶</a></p>
<span id="name-openpgp-ecdh-kdf-and-kek-pa"></span><div id="ecdh-kdf-kek-parameters-registry">
<table class="center" id="table-30">
            <caption>
<a class="selfRef" href="#table-30">Table 30</a>:
<a class="selfRef" href="#name-openpgp-ecdh-kdf-and-kek-pa">OpenPGP ECDH KDF and KEK Parameters Registry</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" colspan="1" rowspan="1">Curve</th>
                <th class="text-left" colspan="1" rowspan="1">Hash Algorithm</th>
                <th class="text-left" colspan="1" rowspan="1">Symmetric Algorithm</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">NIST P-256</td>
                <td class="text-left" colspan="1" rowspan="1">SHA2-256</td>
                <td class="text-left" colspan="1" rowspan="1">AES-128</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">NIST P-384</td>
                <td class="text-left" colspan="1" rowspan="1">SHA2-384</td>
                <td class="text-left" colspan="1" rowspan="1">AES-192</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">NIST P-521</td>
                <td class="text-left" colspan="1" rowspan="1">SHA2-512</td>
                <td class="text-left" colspan="1" rowspan="1">AES-256</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">brainpoolP256r1</td>
                <td class="text-left" colspan="1" rowspan="1">SHA2-256</td>
                <td class="text-left" colspan="1" rowspan="1">AES-128</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">brainpoolP384r1</td>
                <td class="text-left" colspan="1" rowspan="1">SHA2-384</td>
                <td class="text-left" colspan="1" rowspan="1">AES-192</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">brainpoolP512r1</td>
                <td class="text-left" colspan="1" rowspan="1">SHA2-512</td>
                <td class="text-left" colspan="1" rowspan="1">AES-256</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">Curve25519Legacy</td>
                <td class="text-left" colspan="1" rowspan="1">SHA2-256</td>
                <td class="text-left" colspan="1" rowspan="1">AES-128</td>
              </tr>
            </tbody>
          </table>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="notes-on-algorithms">
<section id="section-12">
      <h2 id="name-notes-on-algorithms">
<a class="section-number selfRef" href="#section-12">12. </a><a class="section-name selfRef" href="#name-notes-on-algorithms">Notes on Algorithms</a>
      </h2>
<div id="pkcs-encoding">
<section id="section-12.1">
        <h3 id="name-pkcs1-encoding-in-openpgp">
<a class="section-number selfRef" href="#section-12.1">12.1. </a><a class="section-name selfRef" href="#name-pkcs1-encoding-in-openpgp">PKCS#1 Encoding in OpenPGP</a>
        </h3>
<p id="section-12.1-1">This specification makes use of the PKCS#1 functions EME-PKCS1-v1_5 and EMSA-PKCS1-v1_5. However, the calling conventions of these functions have changed in the past. To avoid potential confusion and interoperability problems, we are including local copies in this document, adapted from those in PKCS#1 v2.1 <span>[<a class="cite xref" href="#RFC8017">RFC8017</a>]</span>. <span>[<a class="cite xref" href="#RFC8017">RFC8017</a>]</span> should be treated as the ultimate authority on PKCS#1 for OpenPGP. Nonetheless, we believe that there is value in having a self-contained document that avoids problems in the future with needed changes in the conventions.<a class="pilcrow" href="#section-12.1-1">¶</a></p>
<div id="eme-pkcs1-v1-5-encode">
<section id="section-12.1.1">
          <h4 id="name-eme-pkcs1-v1_5-encode">
<a class="section-number selfRef" href="#section-12.1.1">12.1.1. </a><a class="section-name selfRef" href="#name-eme-pkcs1-v1_5-encode">EME-PKCS1-v1_5-ENCODE</a>
          </h4>
<p id="section-12.1.1-1">Input:<a class="pilcrow" href="#section-12.1.1-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-12.1.1-2">
            <dt id="section-12.1.1-2.1">k =</dt>
            <dd id="section-12.1.1-2.2" style="margin-left: 1.5em">key modulus length in octets.<a class="pilcrow" href="#section-12.1.1-2.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-12.1.1-2.3">M =</dt>
            <dd id="section-12.1.1-2.4" style="margin-left: 1.5em">message to be encoded; an octet string of length mLen, where mLen &lt;= k - 11.<a class="pilcrow" href="#section-12.1.1-2.4">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-12.1.1-3">Output:<a class="pilcrow" href="#section-12.1.1-3">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-12.1.1-4">
            <dt id="section-12.1.1-4.1">EM =</dt>
            <dd id="section-12.1.1-4.2" style="margin-left: 1.5em">encoded message; an octet string of length k.<a class="pilcrow" href="#section-12.1.1-4.2">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-12.1.1-5">Error: "message too long".<a class="pilcrow" href="#section-12.1.1-5">¶</a></p>
<ol class="normal type-1" id="section-12.1.1-6" start="1" type="1">
<li id="section-12.1.1-6.1">
              <p id="section-12.1.1-6.1.1">Length checking: If mLen &gt; k - 11, output "message too long" and stop.<a class="pilcrow" href="#section-12.1.1-6.1.1">¶</a></p>
</li>
            <li id="section-12.1.1-6.2">
              <p id="section-12.1.1-6.2.1">Generate an octet string PS of length k - mLen - 3 consisting of pseudorandomly generated non-zero octets. The length of PS will be at least 8 octets.<a class="pilcrow" href="#section-12.1.1-6.2.1">¶</a></p>
</li>
            <li id="section-12.1.1-6.3">
              <p id="section-12.1.1-6.3.1">Concatenate PS, the message M, and other padding to form an encoded message EM of length k octets as<a class="pilcrow" href="#section-12.1.1-6.3.1">¶</a></p>
<div class="alignLeft art-text artwork" id="section-12.1.1-6.3.2">
<pre>EM = 0x00 || 0x02 || PS || 0x00 || M.
</pre><a class="pilcrow" href="#section-12.1.1-6.3.2">¶</a>
</div>
</li>
            <li id="section-12.1.1-6.4">
              <p id="section-12.1.1-6.4.1">Output EM.<a class="pilcrow" href="#section-12.1.1-6.4.1">¶</a></p>
</li>
          </ol>
</section>
</div>
<div id="eme-pkcs1-v1-5-decode">
<section id="section-12.1.2">
          <h4 id="name-eme-pkcs1-v1_5-decode">
<a class="section-number selfRef" href="#section-12.1.2">12.1.2. </a><a class="section-name selfRef" href="#name-eme-pkcs1-v1_5-decode">EME-PKCS1-v1_5-DECODE</a>
          </h4>
<p id="section-12.1.2-1">Input:<a class="pilcrow" href="#section-12.1.2-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-12.1.2-2">
            <dt id="section-12.1.2-2.1">EM =</dt>
            <dd id="section-12.1.2-2.2" style="margin-left: 1.5em">
              <p id="section-12.1.2-2.2.1">encoded message; an octet string.<a class="pilcrow" href="#section-12.1.2-2.2.1">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-12.1.2-3">Output:<a class="pilcrow" href="#section-12.1.2-3">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-12.1.2-4">
            <dt id="section-12.1.2-4.1">M =</dt>
            <dd id="section-12.1.2-4.2" style="margin-left: 1.5em">
              <p id="section-12.1.2-4.2.1">decoded message; an octet string.<a class="pilcrow" href="#section-12.1.2-4.2.1">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-12.1.2-5">Error: "decryption error".<a class="pilcrow" href="#section-12.1.2-5">¶</a></p>
<p id="section-12.1.2-6">To decode an EME-PKCS1_v1_5 message, separate the encoded message EM into an octet string PS consisting of non-zero octets and a message M as follows<a class="pilcrow" href="#section-12.1.2-6">¶</a></p>
<div class="alignLeft art-text artwork" id="section-12.1.2-7">
<pre>  EM = 0x00 || 0x02 || PS || 0x00 || M.
</pre><a class="pilcrow" href="#section-12.1.2-7">¶</a>
</div>
<p id="section-12.1.2-8">If the first octet of EM does not have hexadecimal value 0x00, the second octet of EM does not have hexadecimal value 0x02, there is no octet with hexadecimal value 0x00 to separate PS from M, or the length of PS is less than 8 octets, output "decryption error" and stop. See also <a class="auto internal xref" href="#pkcs1-errors">Section 13.5</a> regarding differences in reporting between a decryption error and a padding error.<a class="pilcrow" href="#section-12.1.2-8">¶</a></p>
</section>
</div>
<div id="emsa-pkcs1-v1-5">
<section id="section-12.1.3">
          <h4 id="name-emsa-pkcs1-v1_5">
<a class="section-number selfRef" href="#section-12.1.3">12.1.3. </a><a class="section-name selfRef" href="#name-emsa-pkcs1-v1_5">EMSA-PKCS1-v1_5</a>
          </h4>
<p id="section-12.1.3-1">This encoding method is deterministic and only has an encoding operation.<a class="pilcrow" href="#section-12.1.3-1">¶</a></p>
<p id="section-12.1.3-2">Input:<a class="pilcrow" href="#section-12.1.3-2">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-12.1.3-3">
            <dt id="section-12.1.3-3.1">Hash =</dt>
            <dd id="section-12.1.3-3.2" style="margin-left: 1.5em">
              <p id="section-12.1.3-3.2.1">hash function to be used.<a class="pilcrow" href="#section-12.1.3-3.2.1">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-12.1.3-3.3">M =</dt>
            <dd id="section-12.1.3-3.4" style="margin-left: 1.5em">
              <p id="section-12.1.3-3.4.1">message to be encoded.<a class="pilcrow" href="#section-12.1.3-3.4.1">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-12.1.3-3.5">emLen =</dt>
            <dd id="section-12.1.3-3.6" style="margin-left: 1.5em">
              <p id="section-12.1.3-3.6.1">intended length of the encoded message in octets, at least tLen + 11, where tLen is the octet length of the DER encoding T of a certain value computed during the encoding operation.<a class="pilcrow" href="#section-12.1.3-3.6.1">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-12.1.3-4">Output:<a class="pilcrow" href="#section-12.1.3-4">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-12.1.3-5">
            <dt id="section-12.1.3-5.1">EM =</dt>
            <dd id="section-12.1.3-5.2" style="margin-left: 1.5em">
              <p id="section-12.1.3-5.2.1">encoded message; an octet string of length emLen.<a class="pilcrow" href="#section-12.1.3-5.2.1">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-12.1.3-6">Errors: "message too long"; "intended encoded message length too short".<a class="pilcrow" href="#section-12.1.3-6">¶</a></p>
<p id="section-12.1.3-7">Steps:<a class="pilcrow" href="#section-12.1.3-7">¶</a></p>
<ol class="normal type-1" id="section-12.1.3-8" start="1" type="1">
<li id="section-12.1.3-8.1">
              <p id="section-12.1.3-8.1.1">Apply the hash function to the message M to produce hash value H:<a class="pilcrow" href="#section-12.1.3-8.1.1">¶</a></p>
<p id="section-12.1.3-8.1.2">
H = Hash(M).<a class="pilcrow" href="#section-12.1.3-8.1.2">¶</a></p>
<p id="section-12.1.3-8.1.3">
If the hash function outputs "message too long," output "message too long" and stop.<a class="pilcrow" href="#section-12.1.3-8.1.3">¶</a></p>
</li>
            <li id="section-12.1.3-8.2">
              <p id="section-12.1.3-8.2.1">Let T be the Full Hash Prefix from <a class="auto internal xref" href="#emsa-hash-oids-registry">Table 24</a> for the given hash function, concatenated with the hash digest H (representing an ASN.1 DER value for the hash function used and the hash digest). Let tLen be the length in octets of T.<a class="pilcrow" href="#section-12.1.3-8.2.1">¶</a></p>
</li>
            <li id="section-12.1.3-8.3">
              <p id="section-12.1.3-8.3.1">If emLen &lt; tLen + 11, output "intended encoded message length too short" and stop.<a class="pilcrow" href="#section-12.1.3-8.3.1">¶</a></p>
</li>
            <li id="section-12.1.3-8.4">
              <p id="section-12.1.3-8.4.1">Generate an octet string PS consisting of emLen - tLen - 3 octets with hexadecimal value 0xFF.
The length of PS will be at least 8 octets.<a class="pilcrow" href="#section-12.1.3-8.4.1">¶</a></p>
</li>
            <li id="section-12.1.3-8.5">
              <p id="section-12.1.3-8.5.1">Concatenate PS, the hash prefix T, and other padding to form the encoded message EM as<a class="pilcrow" href="#section-12.1.3-8.5.1">¶</a></p>
<div class="alignLeft art-text artwork" id="section-12.1.3-8.5.2">
<pre>EM = 0x00 || 0x01 || PS || 0x00 || T.
</pre><a class="pilcrow" href="#section-12.1.3-8.5.2">¶</a>
</div>
</li>
            <li id="section-12.1.3-8.6">
              <p id="section-12.1.3-8.6.1">Output EM.<a class="pilcrow" href="#section-12.1.3-8.6.1">¶</a></p>
</li>
          </ol>
</section>
</div>
</section>
</div>
<div id="symmetric-algorithm-preferences">
<section id="section-12.2">
        <h3 id="name-symmetric-algorithm-prefere">
<a class="section-number selfRef" href="#section-12.2">12.2. </a><a class="section-name selfRef" href="#name-symmetric-algorithm-prefere">Symmetric Algorithm Preferences</a>
        </h3>
<p id="section-12.2-1">The symmetric algorithm preference is an ordered list of algorithms that the keyholder accepts.
Since it is found on a self-signature, it is possible that a keyholder may have multiple, different preferences. For example, Alice may have AES-128 only specified for "alice@work.com" but Camellia-256, Twofish, and AES-128 specified for "alice@home.org". Note that it is also possible for preferences to be in a subkey's binding signature.<a class="pilcrow" href="#section-12.2-1">¶</a></p>
<p id="section-12.2-2">Since AES-128 is the algorithm that <span class="bcp14">MUST</span> be implemented, if it is not explicitly in the list, it is tacitly at the end. However, it is good form to place it there explicitly.
Note also that if an implementation does not implement the preference, then it is implicitly an AES-128-only implementation. Furthermore, note that implementations conforming to the previous version of this specification <span>[<a class="cite xref" href="#RFC4880">RFC4880</a>]</span> have TripleDES as the only algorithm that <span class="bcp14">MUST</span> be implemented.<a class="pilcrow" href="#section-12.2-2">¶</a></p>
<p id="section-12.2-3">An implementation <span class="bcp14">MUST NOT</span> use a symmetric algorithm that is not in the recipient's preference list. When encrypting to more than one recipient, the implementation finds a suitable algorithm by taking the intersection of the preferences of the recipients. Note that since the AES-128 algorithm <span class="bcp14">MUST</span> be implemented, the intersection is guaranteed to be non-empty.<a class="pilcrow" href="#section-12.2-3">¶</a></p>
<p id="section-12.2-4">If an implementation can decrypt a message that a keyholder doesn't have in their preferences, the implementation <span class="bcp14">SHOULD</span> decrypt the message anyway, but it <span class="bcp14">MUST</span> warn the keyholder. For example, suppose that Alice (above) has an implementation that implements all algorithms in this specification. Nonetheless, she prefers subsets for work or home. If she is sent a message encrypted with IDEA, which is not in her preferences, the implementation warns her that someone sent an IDEA-encrypted message, but it would ideally decrypt it anyway.<a class="pilcrow" href="#section-12.2-4">¶</a></p>
<div id="plaintext">
<section id="section-12.2.1">
          <h4 id="name-plaintext">
<a class="section-number selfRef" href="#section-12.2.1">12.2.1. </a><a class="section-name selfRef" href="#name-plaintext">Plaintext</a>
          </h4>
<p id="section-12.2.1-1">Algorithm 0, "plaintext", may only be used to denote secret keys that are stored in the clear.
An implementation <span class="bcp14">MUST NOT</span> use algorithm 0 as the indicated symmetric cipher for an encrypted data packet (Sections <a class="auto internal xref" href="#sed">5.7</a> or <a class="auto internal xref" href="#seipd">5.13</a>); it can use a Literal Data packet (<a class="auto internal xref" href="#lit">Section 5.9</a>) to encode unencrypted literal data.<a class="pilcrow" href="#section-12.2.1-1">¶</a></p>
</section>
</div>
</section>
</div>
<div id="other-algorithm-preferences">
<section id="section-12.3">
        <h3 id="name-other-algorithm-preferences">
<a class="section-number selfRef" href="#section-12.3">12.3. </a><a class="section-name selfRef" href="#name-other-algorithm-preferences">Other Algorithm Preferences</a>
        </h3>
<p id="section-12.3-1">Other algorithm preferences work similarly to the symmetric algorithm preference in that they specify which algorithms the keyholder accepts. There are two interesting cases in which further comments are needed: the compression preferences and the hash preferences.<a class="pilcrow" href="#section-12.3-1">¶</a></p>
<div id="compression-preferences">
<section id="section-12.3.1">
          <h4 id="name-compression-preferences">
<a class="section-number selfRef" href="#section-12.3.1">12.3.1. </a><a class="section-name selfRef" href="#name-compression-preferences">Compression Preferences</a>
          </h4>
<p id="section-12.3.1-1">Like the algorithm preferences, an implementation <span class="bcp14">MUST NOT</span> use an algorithm that is not in the preference vector.
If Uncompressed (0) is not explicitly in the list, it is tacitly at the end.
That is, uncompressed messages may always be sent.<a class="pilcrow" href="#section-12.3.1-1">¶</a></p>
<p id="section-12.3.1-2">Note that earlier implementations may assume that the absence of compression preferences means that [ZIP(1), Uncompressed(0)] are preferred, and default to ZIP compression.
Therefore, an implementation that prefers uncompressed data <span class="bcp14">SHOULD</span> explicitly state this in the Preferred Compression Algorithms.<a class="pilcrow" href="#section-12.3.1-2">¶</a></p>
<div id="uncompressed">
<section id="section-12.3.1.1">
            <h5 id="name-uncompressed">
<a class="section-number selfRef" href="#section-12.3.1.1">12.3.1.1. </a><a class="section-name selfRef" href="#name-uncompressed">Uncompressed</a>
            </h5>
<p id="section-12.3.1.1-1">Algorithm 0, "uncompressed", may only be used to denote a preference for uncompressed data.
An implementation <span class="bcp14">MUST NOT</span> use algorithm 0 as the indicated compression algorithm in a Compressed Data packet (<a class="auto internal xref" href="#compressed-data">Section 5.6</a>); it can use a Literal Data packet (<a class="auto internal xref" href="#lit">Section 5.9</a>) to encode uncompressed literal data.<a class="pilcrow" href="#section-12.3.1.1-1">¶</a></p>
</section>
</div>
</section>
</div>
<div id="hash-algorithm-preferences">
<section id="section-12.3.2">
          <h4 id="name-hash-algorithm-preferences">
<a class="section-number selfRef" href="#section-12.3.2">12.3.2. </a><a class="section-name selfRef" href="#name-hash-algorithm-preferences">Hash Algorithm Preferences</a>
          </h4>
<p id="section-12.3.2-1">Typically, the signer chooses which hash algorithm to use, rather than the verifier, because a signer rarely knows who is going to be verifying the signature. This preference allows a protocol based upon digital signatures ease in negotiation.<a class="pilcrow" href="#section-12.3.2-1">¶</a></p>
<p id="section-12.3.2-2">Thus, if Alice is authenticating herself to Bob with a signature, it makes sense for her to use a hash algorithm that Bob's implementation uses. This preference allows Bob to state which algorithms Alice may use in his key.<a class="pilcrow" href="#section-12.3.2-2">¶</a></p>
<p id="section-12.3.2-3">Since SHA2-256 is the hash algorithm that <span class="bcp14">MUST</span> be implemented, if it is not explicitly in the list, it is tacitly at the end.
However, it is good form to place it there explicitly.<a class="pilcrow" href="#section-12.3.2-3">¶</a></p>
</section>
</div>
</section>
</div>
<div id="rsa-notes">
<section id="section-12.4">
        <h3 id="name-rsa">
<a class="section-number selfRef" href="#section-12.4">12.4. </a><a class="section-name selfRef" href="#name-rsa">RSA</a>
        </h3>
<p id="section-12.4-1">The PKCS1-v1_5 padding scheme, used by the RSA algorithms defined in this document, is no longer recommended, and its use is deprecated by <span>[<a class="cite xref" href="#SP800-131A">SP800-131A</a>]</span>.
Therefore, an implementation <span class="bcp14">SHOULD NOT</span> generate RSA keys.<a class="pilcrow" href="#section-12.4-1">¶</a></p>
<p id="section-12.4-2">There are algorithm types for RSA Sign-Only and RSA Encrypt-Only keys. These types are deprecated in favor of the Key Flags signature subpacket. An implementation <span class="bcp14">MUST NOT</span> create such a key, but it <span class="bcp14">MAY</span> interpret it.<a class="pilcrow" href="#section-12.4-2">¶</a></p>
<p id="section-12.4-3">An implementation <span class="bcp14">MUST NOT</span> generate RSA keys of a size less than 3072 bits.
An implementation <span class="bcp14">SHOULD NOT</span> encrypt, sign, or verify using RSA keys of a size less than 3072 bits. An implementation <span class="bcp14">MUST NOT</span> encrypt, sign, or verify using RSA keys of a size less than 2048 bits. An implementation that decrypts a message using an RSA secret key of a size less than 3072 bits <span class="bcp14">SHOULD</span> generate a deprecation warning that the key is too weak for modern use.<a class="pilcrow" href="#section-12.4-3">¶</a></p>
</section>
</div>
<div id="dsa-notes">
<section id="section-12.5">
        <h3 id="name-dsa">
<a class="section-number selfRef" href="#section-12.5">12.5. </a><a class="section-name selfRef" href="#name-dsa">DSA</a>
        </h3>
<p id="section-12.5-1">DSA is no longer recommended.
It has also been deprecated in <span>[<a class="cite xref" href="#FIPS186">FIPS186</a>]</span>.
Therefore, an implementation <span class="bcp14">MUST NOT</span> generate DSA keys.<a class="pilcrow" href="#section-12.5-1">¶</a></p>
<p id="section-12.5-2">An implementation <span class="bcp14">MUST NOT</span> sign or verify using DSA keys.<a class="pilcrow" href="#section-12.5-2">¶</a></p>
</section>
</div>
<div id="elgamal-notes">
<section id="section-12.6">
        <h3 id="name-elgamal">
<a class="section-number selfRef" href="#section-12.6">12.6. </a><a class="section-name selfRef" href="#name-elgamal">Elgamal</a>
        </h3>
<p id="section-12.6-1">The PKCS1-v1_5 padding scheme, used by the Elgamal algorithm defined in this document, is no longer recommended, and its use is deprecated by <span>[<a class="cite xref" href="#SP800-131A">SP800-131A</a>]</span>.
Therefore, an implementation <span class="bcp14">MUST NOT</span> generate Elgamal keys.<a class="pilcrow" href="#section-12.6-1">¶</a></p>
<p id="section-12.6-2">An implementation <span class="bcp14">MUST NOT</span> encrypt using Elgamal keys.
An implementation that decrypts a message using an Elgamal secret key <span class="bcp14">SHOULD</span> generate a deprecation warning that the key is too weak for modern use.<a class="pilcrow" href="#section-12.6-2">¶</a></p>
</section>
</div>
<div id="eddsa-notes">
<section id="section-12.7">
        <h3 id="name-eddsa">
<a class="section-number selfRef" href="#section-12.7">12.7. </a><a class="section-name selfRef" href="#name-eddsa">EdDSA</a>
        </h3>
<p id="section-12.7-1">Although the EdDSA algorithm allows arbitrary data as input, its use with OpenPGP requires that a digest of the message be used as input (pre-hashed). See <a class="auto internal xref" href="#computing-signatures">Section 5.2.4</a> for details.
Truncation of the resulting digest is never applied; the resulting digest value is used verbatim as input to the EdDSA algorithm.<a class="pilcrow" href="#section-12.7-1">¶</a></p>
<p id="section-12.7-2">For clarity: while <span>[<a class="cite xref" href="#RFC8032">RFC8032</a>]</span> describes different variants of EdDSA, OpenPGP uses the "pure" variant (PureEdDSA).
The hashing that happens with OpenPGP is done as part of the standard OpenPGP signature process, and that hash itself is fed as the input message to the PureEdDSA algorithm.<a class="pilcrow" href="#section-12.7-2">¶</a></p>
<p id="section-12.7-3">As specified in <span>[<a class="cite xref" href="#RFC8032">RFC8032</a>]</span>, Ed448 also expects a "context string".
In OpenPGP, Ed448 is used with the empty string as a context string.<a class="pilcrow" href="#section-12.7-3">¶</a></p>
</section>
</div>
<div id="reserved-notes">
<section id="section-12.8">
        <h3 id="name-reserved-algorithm-ids">
<a class="section-number selfRef" href="#section-12.8">12.8. </a><a class="section-name selfRef" href="#name-reserved-algorithm-ids">Reserved Algorithm IDs</a>
        </h3>
<p id="section-12.8-1">A number of algorithm IDs have been reserved for algorithms that would be useful to use in an OpenPGP implementation, yet there are issues that prevent an implementer from actually implementing the algorithm. These are marked as reserved in <a class="auto internal xref" href="#pubkey-algos">Section 9.1</a>.<a class="pilcrow" href="#section-12.8-1">¶</a></p>
<p id="section-12.8-2">The reserved public key algorithm X9.42 (21) does not have the necessary parameters, parameter order, or semantics defined. The same is currently true for reserved public key algorithms AEDH (23) and AEDSA (24).<a class="pilcrow" href="#section-12.8-2">¶</a></p>
<p id="section-12.8-3">Previous versions of the OpenPGP specification permitted Elgamal <span>[<a class="cite xref" href="#ELGAMAL">ELGAMAL</a>]</span> signatures with a public key algorithm ID of 20. These are no longer permitted. An implementation <span class="bcp14">MUST NOT</span> generate such keys. An implementation <span class="bcp14">MUST NOT</span> generate Elgamal signatures;
see <span>[<a class="cite xref" href="#BLEICHENBACHER">BLEICHENBACHER</a>]</span>.<a class="pilcrow" href="#section-12.8-3">¶</a></p>
</section>
</div>
<div id="cfb-mode">
<section id="section-12.9">
        <h3 id="name-cfb-mode">
<a class="section-number selfRef" href="#section-12.9">12.9. </a><a class="section-name selfRef" href="#name-cfb-mode">CFB Mode</a>
        </h3>
<p id="section-12.9-1">The Cipher Feedback (CFB) mode used in this document is defined in Section 6.3 of <span>[<a class="cite xref" href="#SP800-38A">SP800-38A</a>]</span>.<a class="pilcrow" href="#section-12.9-1">¶</a></p>
<p id="section-12.9-2">The CFB segment size <code>s</code> is equal to the block size of the cipher (i.e., n-bit CFB mode, where n is the block size used).<a class="pilcrow" href="#section-12.9-2">¶</a></p>
</section>
</div>
<div id="private-or-experimental-parameters">
<section id="section-12.10">
        <h3 id="name-private-or-experimental-par">
<a class="section-number selfRef" href="#section-12.10">12.10. </a><a class="section-name selfRef" href="#name-private-or-experimental-par">Private or Experimental Parameters</a>
        </h3>
<p id="section-12.10-1">S2K Specifiers, Signature Subpacket Type IDs, User Attribute Subpacket Type IDs, image format IDs, and the various algorithm IDs described in <a class="auto internal xref" href="#constants">Section 9</a> all reserve the range 100 to 110 for Private and Experimental Use.
Packet Type IDs reserve the range 60 to 63 for Private and Experimental Use.
These are intentionally managed by the Private Use and Experimental Use policies, as described in <span>[<a class="cite xref" href="#RFC8126">RFC8126</a>]</span>.<a class="pilcrow" href="#section-12.10-1">¶</a></p>
<p id="section-12.10-2">However, implementations need to be careful with these and promote them to full IANA-managed parameters when they grow beyond the original, limited system.<a class="pilcrow" href="#section-12.10-2">¶</a></p>
</section>
</div>
<div id="meta-considerations-for-expansion">
<section id="section-12.11">
        <h3 id="name-meta-considerations-for-exp">
<a class="section-number selfRef" href="#section-12.11">12.11. </a><a class="section-name selfRef" href="#name-meta-considerations-for-exp">Meta Considerations for Expansion</a>
        </h3>
<p id="section-12.11-1">If OpenPGP is extended in a way that is not backward compatible, meaning that old implementations will not gracefully handle their absence of a new feature, the extension proposal can be declared in the keyholder's self-signature as part of the Features signature subpacket.<a class="pilcrow" href="#section-12.11-1">¶</a></p>
<p id="section-12.11-2">We cannot state definitively what extensions will not be forward compatible, but typically new algorithms are forward compatible, whereas new packets are not.<a class="pilcrow" href="#section-12.11-2">¶</a></p>
<p id="section-12.11-3">If an extension proposal does not update the Features system, it <span class="bcp14">SHOULD</span> include an explanation of why this is unnecessary.
If the proposal contains neither an extension to the Features system nor an explanation of why such an extension is unnecessary, the proposal <span class="bcp14">SHOULD</span> be rejected.<a class="pilcrow" href="#section-12.11-3">¶</a></p>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-13">
      <h2 id="name-security-considerations">
<a class="section-number selfRef" href="#section-13">13. </a><a class="section-name selfRef" href="#name-security-considerations">Security Considerations</a>
      </h2>
<ul class="normal">
<li class="normal" id="section-13-1.1">
          <p id="section-13-1.1.1">As with any technology involving cryptography, implementers should check the current literature to determine if any algorithms used here have been found to be vulnerable to an attack.
If so, implementers should consider disallowing such algorithms for new data and warning the end user, or preventing use, when they are trying to consume data protected by such algorithms that are now vulnerable.<a class="pilcrow" href="#section-13-1.1.1">¶</a></p>
</li>
        <li class="normal" id="section-13-1.2">
          <p id="section-13-1.2.1">This specification uses Public Key Cryptography technologies.
It is assumed that the private key portion of a public-private key pair is controlled and secured by the proper party or parties.<a class="pilcrow" href="#section-13-1.2.1">¶</a></p>
</li>
        <li class="normal" id="section-13-1.3">
          <p id="section-13-1.3.1">The MD5 and SHA-1 hash algorithms have been found to have weaknesses, with collisions found in a number of cases.
MD5 and SHA-1 are deprecated for use in OpenPGP (see <a class="auto internal xref" href="#hash-algos">Section 9.5</a>).<a class="pilcrow" href="#section-13-1.3.1">¶</a></p>
</li>
        <li class="normal" id="section-13-1.4">
          <p id="section-13-1.4.1">Many security protocol designers think that it is a bad idea to use a single key for both privacy (encryption) and integrity (signatures).
In fact, this was one of the motivating forces behind the version 4 key format with separate signature and encryption keys. Using a single key for encrypting and signing is discouraged.<a class="pilcrow" href="#section-13-1.4.1">¶</a></p>
</li>
        <li class="normal" id="section-13-1.5">
          <p id="section-13-1.5.1">The DSA algorithm will work with any hash, but it is sensitive to the quality of the hash algorithm.
Verifiers should be aware that even if the signer used a strong hash, an attacker could have modified the signature to use a weak one. Only signatures using acceptably strong hash algorithms should be accepted as valid.<a class="pilcrow" href="#section-13-1.5.1">¶</a></p>
</li>
        <li class="normal" id="section-13-1.6">
          <p id="section-13-1.6.1">As OpenPGP combines many different asymmetric, symmetric, and hash algorithms, each with different measures of strength, care should be taken to ensure that the weakest element of an OpenPGP Message is still sufficiently strong for the purpose at hand. While consensus about the strength of a given algorithm may evolve, NIST Special Publication 800-57 <span>[<a class="cite xref" href="#SP800-57">SP800-57</a>]</span> contains recommendations (current at the time of this publication) about equivalent security levels of different algorithms.<a class="pilcrow" href="#section-13-1.6.1">¶</a></p>
</li>
        <li class="normal" id="section-13-1.7">
          <p id="section-13-1.7.1">There is a somewhat-related potential security problem in signatures.
If an attacker can find a message that hashes to the same hash with a different algorithm, a bogus signature structure can be constructed that evaluates correctly.<a class="pilcrow" href="#section-13-1.7.1">¶</a></p>
<p id="section-13-1.7.2">
For example, suppose Alice DSA-signs message M using hash algorithm H.
Suppose that Mallet finds a message M' that has the same hash value as M with H'.
Mallet can then construct a signature block that verifies as Alice's signature of M' with H'.
However, this would also constitute a weakness in either H or H', or both.
Should this ever occur, a revision will have to be made to this document to revise the allowed hash algorithms.<a class="pilcrow" href="#section-13-1.7.2">¶</a></p>
</li>
        <li class="normal" id="section-13-1.8">
          <p id="section-13-1.8.1">If you are building an authentication system, the recipient may specify a preferred signing algorithm.
However, the signer would be foolish to use a weak algorithm simply because the recipient requests it.<a class="pilcrow" href="#section-13-1.8.1">¶</a></p>
</li>
        <li class="normal" id="section-13-1.9">
          <p id="section-13-1.9.1">Some of the encryption algorithms mentioned in this document have been analyzed less than others.
For example, although TWOFISH is presently considered reasonably strong, it has been analyzed much less than AES.
Other algorithms may have other concerns surrounding them.<a class="pilcrow" href="#section-13-1.9.1">¶</a></p>
</li>
        <li class="normal" id="section-13-1.10">
          <p id="section-13-1.10.1">In late summer 2002, Jallad, Katz, and Schneier published an interesting attack on previous versions of the OpenPGP specification and some of its implementations <span>[<a class="cite xref" href="#JKS02">JKS02</a>]</span>.
In this attack, the attacker modifies a message and sends it to a user who then returns the erroneously decrypted message to the attacker.
The attacker is thus using the user as a decryption oracle and can often decrypt the message.
This attack is a particular form of ciphertext malleability.
See <a class="auto internal xref" href="#ciphertext-malleability">Section 13.7</a> for information on how to defend against such an attack using more recent versions of OpenPGP.<a class="pilcrow" href="#section-13-1.10.1">¶</a></p>
</li>
      </ul>
<div id="sha1cd">
<section id="section-13.1">
        <h3 id="name-sha-1-collision-detection">
<a class="section-number selfRef" href="#section-13.1">13.1. </a><a class="section-name selfRef" href="#name-sha-1-collision-detection">SHA-1 Collision Detection</a>
        </h3>
<p id="section-13.1-1">As described in <span>[<a class="cite xref" href="#SHAMBLES">SHAMBLES</a>]</span>, the SHA-1 digest algorithm is not collision resistant.
However, an OpenPGP implementation cannot completely discard the SHA-1 algorithm, because it is required for implementing version 4 public keys.
In particular, the version 4 fingerprint derivation uses SHA-1.
So as long as an OpenPGP implementation supports version 4 public keys, it will need to implement SHA-1 in at least some scenarios.<a class="pilcrow" href="#section-13.1-1">¶</a></p>
<p id="section-13.1-2">To avoid the risk of uncertain breakage from a maliciously introduced SHA-1 collision, an OpenPGP implementation <span class="bcp14">MAY</span> attempt to detect when a hash input is likely from a known collision attack and then either reject the hash input deliberately or modify the hash output.
This should convert an uncertain breakage (where it is unclear what the effect of a collision will be) to an explicit breakage, which is more desirable for a robust implementation.<a class="pilcrow" href="#section-13.1-2">¶</a></p>
<p id="section-13.1-3"><span>[<a class="cite xref" href="#STEVENS2013">STEVENS2013</a>]</span> describes a method for detecting indicators of well-known SHA-1 collision attacks.
Some example C code implementing this technique can be found at <span>[<a class="cite xref" href="#SHA1CD">SHA1CD</a>]</span>.<a class="pilcrow" href="#section-13.1-3">¶</a></p>
</section>
</div>
<div id="signature-salt-rationale">
<section id="section-13.2">
        <h3 id="name-advantages-of-salted-signat">
<a class="section-number selfRef" href="#section-13.2">13.2. </a><a class="section-name selfRef" href="#name-advantages-of-salted-signat">Advantages of Salted Signatures</a>
        </h3>
<p id="section-13.2-1">Version 6 signatures include a salt that is hashed first, and it's size depends on the hashing algorithm. This makes version 6 OpenPGP signatures non-deterministic and protects against a broad class of attacks that depend on creating a signature over a predictable message. By selecting a new random salt for each signature made, the signed hashes and the signatures are not predictable.<a class="pilcrow" href="#section-13.2-1">¶</a></p>
<p id="section-13.2-2">While the material to be signed could be attacker controlled, hashing the salt first means that there is no attacker-controlled hashed prefix.
An example of this kind of attack is described in the paper "SHA-1 is a Shambles" <span>[<a class="cite xref" href="#SHAMBLES">SHAMBLES</a>]</span>, which leverages a chosen prefix collision attack against SHA-1.
This means that an adversary carrying out a chosen-message attack will not be able to control the hash that is being signed and will need to break second-preimage resistance instead of the simpler collision resistance to create two messages having the same signature.
The size of the salt is bound to the hash function to match the expected collision-resistance level and is at least 16 octets.<a class="pilcrow" href="#section-13.2-2">¶</a></p>
<p id="section-13.2-3">In some cases, an attacker may be able to induce a signature to be made, even if they do not control the content of the message. In some scenarios, a repeated signature over the exact same message may risk leakage of part or all of the signing key; for example, see discussion of hardware faults over EdDSA and deterministic ECDSA in <span>[<a class="cite xref" href="#PSSLR17">PSSLR17</a>]</span>.
Choosing a new random salt for each signature ensures that no repeated signatures are produced, which mitigates this risk.<a class="pilcrow" href="#section-13.2-3">¶</a></p>
</section>
</div>
<div id="ecc-side-channels">
<section id="section-13.3">
        <h3 id="name-elliptic-curve-side-channel">
<a class="section-number selfRef" href="#section-13.3">13.3. </a><a class="section-name selfRef" href="#name-elliptic-curve-side-channel">Elliptic Curve Side Channels</a>
        </h3>
<p id="section-13.3-1">Side-channel attacks are a concern when a compliant application's use of the OpenPGP format can be modeled by a decryption or signing oracle, for example, when an application is a network service performing decryption to unauthenticated remote users.
ECC scalar multiplication operations used in ECDSA and ECDH are vulnerable to side-channel attacks. Countermeasures can often be taken at the higher protocol level, such as limiting the number of allowed failures or time-blinding the operations associated with each network interface. Mitigations at the scalar multiplication level seek to eliminate any measurable distinction between the ECC point addition and doubling operations.<a class="pilcrow" href="#section-13.3-1">¶</a></p>
</section>
</div>
<div id="quick-check-oracle">
<section id="section-13.4">
        <h3 id="name-risks-of-a-quick-check-orac">
<a class="section-number selfRef" href="#section-13.4">13.4. </a><a class="section-name selfRef" href="#name-risks-of-a-quick-check-orac">Risks of a Quick Check Oracle</a>
        </h3>
<p id="section-13.4-1">In winter 2005, Serge Mister and Robert Zuccherato from Entrust released a paper describing a way that the "quick check" in v1 SEIPD and SED packets can be used as an oracle to decrypt two octets of every cipher block <span>[<a class="cite xref" href="#MZ05">MZ05</a>]</span>.
This check was intended for early detection of session key decryption errors, particularly to detect a wrong passphrase, since v4 SKESK packets do not include an integrity check.<a class="pilcrow" href="#section-13.4-1">¶</a></p>
<p id="section-13.4-2">There is a danger when using the quick check if timing or error information about the check can be exposed to an attacker, particularly via an automated service that allows rapidly repeated queries.<a class="pilcrow" href="#section-13.4-2">¶</a></p>
<p id="section-13.4-3">Disabling the quick check prevents the attack.<a class="pilcrow" href="#section-13.4-3">¶</a></p>
<p id="section-13.4-4">For very large encrypted data whose session key is protected by a passphrase using a v4 SKESK, the quick check may be convenient to the user by informing them early that they typed the wrong passphrase.
But the implementation should use the quick check with care.
The recommended approach for secure and early detection of decryption failure is to encrypt data using v2 SEIPD.
If the session key is public key encrypted, the quick check is not useful as the public key encryption of the session key should guarantee that it is the right session key.<a class="pilcrow" href="#section-13.4-4">¶</a></p>
<p id="section-13.4-5">The quick check oracle attack is a particular type of attack that exploits ciphertext malleability.
For information about other similar attacks, see <a class="auto internal xref" href="#ciphertext-malleability">Section 13.7</a>.<a class="pilcrow" href="#section-13.4-5">¶</a></p>
</section>
</div>
<div id="pkcs1-errors">
<section id="section-13.5">
        <h3 id="name-avoiding-leaks-from-pkcs1-e">
<a class="section-number selfRef" href="#section-13.5">13.5. </a><a class="section-name selfRef" href="#name-avoiding-leaks-from-pkcs1-e">Avoiding Leaks from PKCS#1 Errors</a>
        </h3>
<p id="section-13.5-1">The PKCS#1 padding (used in RSA-encrypted and ElGamal-encrypted PKESK) has been found to be vulnerable to attacks in which a system that allows distinguishing padding errors from other decryption errors can act as a decryption and/or signing oracle that can leak the session key or allow signing arbitrary data, respectively <span>[<a class="cite xref" href="#BLEICHENBACHER-PKCS1">BLEICHENBACHER-PKCS1</a>]</span>.
The number of queries required to carry out an attack can range from thousands to millions, depending on how strict and careful an implementation is in processing the padding.<a class="pilcrow" href="#section-13.5-1">¶</a></p>
<p id="section-13.5-2">To make the attack more difficult, an implementation <span class="bcp14">SHOULD</span> implement strict, robust, and constant time padding checks.<a class="pilcrow" href="#section-13.5-2">¶</a></p>
<p id="section-13.5-3">To prevent the attack, in settings where the attacker does not have access to timing information concerning message decryption, the simplest solution is to report a single error code for all variants of PKESK processing errors as well as SEIPD integrity errors (this also includes session key parsing errors, such as on an invalid cipher algorithm for v3 PKESK, or a session key size mismatch for v6 PKESK). If the attacker may have access to timing information, then a constant time solution is also needed. This requires careful design, especially for v3 PKESK, where session key size and cipher information is typically not known in advance, as it is part of the PKESK encrypted payload.<a class="pilcrow" href="#section-13.5-3">¶</a></p>
</section>
</div>
<div id="fingerprint-usability">
<section id="section-13.6">
        <h3 id="name-fingerprint-usability">
<a class="section-number selfRef" href="#section-13.6">13.6. </a><a class="section-name selfRef" href="#name-fingerprint-usability">Fingerprint Usability</a>
        </h3>
<p id="section-13.6-1">This specification uses fingerprints in several places on the wire (e.g., Sections <a class="auto internal xref" href="#revocation-key">5.2.3.23</a>, <a class="auto internal xref" href="#issuer-fingerprint-subpacket">5.2.3.35</a>, and <a class="auto internal xref" href="#intended-recipient-fingerprint">5.2.3.36</a>) and in processing (e.g., in ECDH KDF <a class="auto internal xref" href="#ecdh">Section 11.5</a>). An implementation may also use the fingerprint internally, for example, as an index to a keystore.<a class="pilcrow" href="#section-13.6-1">¶</a></p>
<p id="section-13.6-2">Additionally, some OpenPGP users have historically used manual fingerprint comparison to verify the public key of a peer.
For a version 4 fingerprint, this has typically been done with the fingerprint represented as 40 hexadecimal digits, often broken into groups of four digits with whitespace between each group.<a class="pilcrow" href="#section-13.6-2">¶</a></p>
<p id="section-13.6-3">When a human is actively involved, the result of such a verification is dubious.
There is little evidence that most humans are good at precise comparison of high-entropy data, particularly when that data is represented in compact textual form like a hexadecimal <span>[<a class="cite xref" href="#USENIX-STUDY">USENIX-STUDY</a>]</span>.<a class="pilcrow" href="#section-13.6-3">¶</a></p>
<p id="section-13.6-4">The version 6 fingerprint makes the challenge for a human verifier even worse.
At 256 bits (compared to version 4's 160-bit fingerprint), a version 6 fingerprint is even harder for a human to successfully compare.<a class="pilcrow" href="#section-13.6-4">¶</a></p>
<p id="section-13.6-5">An OpenPGP implementation should prioritize mechanical fingerprint transfer and comparison where possible and <span class="bcp14">SHOULD NOT</span> promote manual transfer or comparison of full fingerprints by a human unless there is no other way to achieve the desired result.<a class="pilcrow" href="#section-13.6-5">¶</a></p>
<p id="section-13.6-6">While this subsection acknowledges existing practice for human-representable version 4 fingerprints, this document does not attempt to standardize any specific human-readable form of version 6 fingerprint for this discouraged use case.<a class="pilcrow" href="#section-13.6-6">¶</a></p>
<p id="section-13.6-7">NOTE: the topic of interoperable human-in-the-loop key verification needs more work, which will be done in a separate document.<a class="pilcrow" href="#section-13.6-7">¶</a></p>
</section>
</div>
<div id="ciphertext-malleability">
<section id="section-13.7">
        <h3 id="name-avoiding-ciphertext-malleab">
<a class="section-number selfRef" href="#section-13.7">13.7. </a><a class="section-name selfRef" href="#name-avoiding-ciphertext-malleab">Avoiding Ciphertext Malleability</a>
        </h3>
<p id="section-13.7-1">If ciphertext can be modified by an attacker but still subsequently decrypted to some new plaintext, it is considered "malleable". A number of attacks can arise in any cryptosystem that uses malleable encryption, so <span>[<a class="cite xref" href="#RFC4880">RFC4880</a>]</span> and later versions of OpenPGP offer mechanisms to defend against it. However, OpenPGP data may have been created before these defense mechanisms were available. Because OpenPGP implementations deal with historic stored data, they may encounter malleable ciphertexts.<a class="pilcrow" href="#section-13.7-1">¶</a></p>
<p id="section-13.7-2">When an OpenPGP implementation discovers that it is decrypting data that appears to be malleable, it <span class="bcp14">MUST</span> generate a clear error message that indicates the integrity of the message is suspect, it <span class="bcp14">SHOULD NOT</span> attempt to parse nor release decrypted data to the user, and it <span class="bcp14">SHOULD</span> halt with an error.
Parsing or releasing decrypted data before having confirmed its integrity can leak the decrypted data <span>[<a class="cite xref" href="#EFAIL">EFAIL</a>]</span> <span>[<a class="cite xref" href="#MRLG15">MRLG15</a>]</span>.<a class="pilcrow" href="#section-13.7-2">¶</a></p>
<p id="section-13.7-3">In the case of AEAD encrypted data, if the authentication tag fails to verify, the implementation <span class="bcp14">MUST NOT</span> attempt to parse nor release decrypted data to the user, and it <span class="bcp14">MUST</span> halt with an error.<a class="pilcrow" href="#section-13.7-3">¶</a></p>
<p id="section-13.7-4">An implementation that encounters malleable ciphertext <span class="bcp14">MAY</span> choose to release cleartext to the user if it is not encrypted using AEAD, it is known to be dealing with historic archived legacy data, and the user is aware of the risks.<a class="pilcrow" href="#section-13.7-4">¶</a></p>
<p id="section-13.7-5">In the case of AEAD encrypted messages, if the message is truncated, i.e., the final zero-octet chunk and possibly (part of) some chunks before it are missing, the implementation <span class="bcp14">MAY</span> choose to release cleartext from the fully authenticated chunks before it to the user if it is operating in a streaming fashion, but it <span class="bcp14">MUST</span> indicate a clear error message as soon as the truncation is detected.<a class="pilcrow" href="#section-13.7-5">¶</a></p>
<p id="section-13.7-6">Any of the following OpenPGP data elements indicate that malleable ciphertext is present:<a class="pilcrow" href="#section-13.7-6">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13.7-7.1">
            <p id="section-13.7-7.1.1">All Symmetrically Encrypted Data packets (<a class="auto internal xref" href="#sed">Section 5.7</a>).<a class="pilcrow" href="#section-13.7-7.1.1">¶</a></p>
</li>
          <li class="normal" id="section-13.7-7.2">
            <p id="section-13.7-7.2.1">Within any encrypted container, any Compressed Data packet (<a class="auto internal xref" href="#compressed-data">Section 5.6</a>) where there is a decompression failure.<a class="pilcrow" href="#section-13.7-7.2.1">¶</a></p>
</li>
          <li class="normal" id="section-13.7-7.3">
            <p id="section-13.7-7.3.1">Any version 1 Symmetrically Encrypted and Integrity Protected Data packet (<a class="auto internal xref" href="#version-one-seipd">Section 5.13.1</a>) where the internal Modification Detection Code does not validate.<a class="pilcrow" href="#section-13.7-7.3.1">¶</a></p>
</li>
          <li class="normal" id="section-13.7-7.4">
            <p id="section-13.7-7.4.1">Any version 2 Symmetrically Encrypted and Integrity Protected Data packet (<a class="auto internal xref" href="#version-two-seipd">Section 5.13.2</a>) where the authentication tag of any chunk fails or where there is no final zero-octet chunk.<a class="pilcrow" href="#section-13.7-7.4.1">¶</a></p>
</li>
          <li class="normal" id="section-13.7-7.5">
            <p id="section-13.7-7.5.1">Any Secret-Key packet with encrypted secret key material (<a class="auto internal xref" href="#secret-key-encryption">Section 3.7.2.1</a>) where there is an integrity failure, based on the value of the secret key protection octet:<a class="pilcrow" href="#section-13.7-7.5.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13.7-7.5.2.1">
                <p id="section-13.7-7.5.2.1.1">Value 253 (AEAD): where the AEAD authentication tag is invalid.<a class="pilcrow" href="#section-13.7-7.5.2.1.1">¶</a></p>
</li>
              <li class="normal" id="section-13.7-7.5.2.2">
                <p id="section-13.7-7.5.2.2.1">Value 254 (CFB): where the SHA1 checksum is mismatched.<a class="pilcrow" href="#section-13.7-7.5.2.2.1">¶</a></p>
</li>
              <li class="normal" id="section-13.7-7.5.2.3">
                <p id="section-13.7-7.5.2.3.1">Value 255 (MalleableCFB) or raw cipher algorithm: where the trailing 2-octet checksum does not match.<a class="pilcrow" href="#section-13.7-7.5.2.3.1">¶</a></p>
</li>
            </ul>
</li>
        </ul>
<p id="section-13.7-8">To avoid these circumstances, an implementation that generates OpenPGP encrypted data <span class="bcp14">SHOULD</span> select the encrypted container format with the most robust protections that can be handled by the intended recipients.
In particular:<a class="pilcrow" href="#section-13.7-8">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13.7-9.1">
            <p id="section-13.7-9.1.1">The SED packet is deprecated and <span class="bcp14">MUST NOT</span> be generated.<a class="pilcrow" href="#section-13.7-9.1.1">¶</a></p>
</li>
          <li class="normal" id="section-13.7-9.2">
            <p id="section-13.7-9.2.1">When encrypting to one or more public keys:<a class="pilcrow" href="#section-13.7-9.2.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13.7-9.2.2.1">
                <p id="section-13.7-9.2.2.1.1">If all recipient keys indicate support for a version 2 Symmetrically Encrypted and Integrity Protected Data packet in their Features signature subpacket (<a class="auto internal xref" href="#features-subpacket">Section 5.2.3.32</a>), if all recipient keys are version 6 keys without a Features signature subpacket, or the implementation can otherwise infer that all recipients support v2 SEIPD packets, the implementation <span class="bcp14">SHOULD</span> encrypt using a v2 SEIPD packet.<a class="pilcrow" href="#section-13.7-9.2.2.1.1">¶</a></p>
</li>
              <li class="normal" id="section-13.7-9.2.2.2">
                <p id="section-13.7-9.2.2.2.1">If one of the recipients does not support v2 SEIPD packets, then the message generator <span class="bcp14">MAY</span> use a v1 SEIPD packet instead.<a class="pilcrow" href="#section-13.7-9.2.2.2.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-13.7-9.3">
            <p id="section-13.7-9.3.1">Passphrase-protected secret key material in a version 6 Secret Key or version 6 Secret Subkey packet <span class="bcp14">SHOULD</span> be protected with AEAD encryption (S2K usage octet 253) unless it will be transferred to an implementation that is known to not support AEAD.
An implementation should be aware that, in scenarios where an attacker has write access to encrypted private keys, CFB-encrypted keys (S2K usage octet 254 or 255) are vulnerable to corruption attacks that can cause leakage of secret data when the secret key is used <span>[<a class="cite xref" href="#KOPENPGP">KOPENPGP</a>]</span> <span>[<a class="cite xref" href="#KR02">KR02</a>]</span>.<a class="pilcrow" href="#section-13.7-9.3.1">¶</a></p>
</li>
        </ul>
<p id="section-13.7-10">Implementers should implement AEAD (v2 SEIPD and S2K usage octet 253) promptly and encourage its spread.<a class="pilcrow" href="#section-13.7-10">¶</a></p>
<p id="section-13.7-11">Users are <span class="bcp14">RECOMMENDED</span> to migrate to AEAD.<a class="pilcrow" href="#section-13.7-11">¶</a></p>
</section>
</div>
<div id="secure-sessionkey-reuse">
<section id="section-13.8">
        <h3 id="name-secure-use-of-the-v2-seipd-">
<a class="section-number selfRef" href="#section-13.8">13.8. </a><a class="section-name selfRef" href="#name-secure-use-of-the-v2-seipd-">Secure Use of the v2 SEIPD Session-Key-Reuse Feature</a>
        </h3>
<p id="section-13.8-1">The salted key derivation of v2 SEIPD packets (<a class="auto internal xref" href="#version-two-seipd">Section 5.13.2</a>) allows the recipient of an encrypted message to reply to the sender and all other recipients without needing their public keys but by using the same v6 PKESK packets it received and a different random salt value.
This ensures a secure mechanism on the cryptographic level that enables the use of message encryption in cases where a sender does not have a copy of an encryption-capable certificate for one or more participants in the conversation and thus can enhance the overall security of an application. However, care must be taken when using this mechanism not to create security vulnerabilities, such as the following:<a class="pilcrow" href="#section-13.8-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13.8-2.1">
            <p id="section-13.8-2.1.1">Replying to only a subset of the original recipients and the original sender by use of the session-key-reuse feature would mean that the remaining recipients (including the sender) of the original message could read the encrypted reply message, too.<a class="pilcrow" href="#section-13.8-2.1.1">¶</a></p>
</li>
          <li class="normal" id="section-13.8-2.2">
            <p id="section-13.8-2.2.1">Adding a further recipient to the reply that is encrypted using the session-key-reuse feature gives that further recipient also cryptographic access to the original message that is being replied to (and potentially to a longer history of previous messages).<a class="pilcrow" href="#section-13.8-2.2.1">¶</a></p>
</li>
          <li class="normal" id="section-13.8-2.3">
            <p id="section-13.8-2.3.1">A modification of the list of recipients addressed in the above points also needs to be safeguarded when a message is initially composed as a reply with session-key reuse but then is stored (e.g., as a draft) and later reopened for further editing and to be finally sent.<a class="pilcrow" href="#section-13.8-2.3.1">¶</a></p>
</li>
          <li class="normal" id="section-13.8-2.4">
            <p id="section-13.8-2.4.1">There is the potential threat that an attacker with network or mailbox access, who is at the same time a recipient of the original message, silently removes themselves from the message before the victim's client receives it.
The victim's client that then uses the mechanism for replying with session-key reuse would unknowingly compose an encrypted message that could be read by the attacker.
Implementations are encouraged to use the Intended Recipient Fingerprint subpacket (<a class="auto internal xref" href="#intended-recipient-fingerprint">Section 5.2.3.36</a>) when composing messages and checking the consistency of the set of recipients of a message before replying to it with session-key reuse.<a class="pilcrow" href="#section-13.8-2.4.1">¶</a></p>
</li>
          <li class="normal" id="section-13.8-2.5">
            <p id="section-13.8-2.5.1">When using the session-key-reuse feature in any higher-layer protocol, care should be taken to ensure that there is no other potentially interfering practice of session-key reuse established in that protocol. Such interfering session-key reuse could, for instance, be given -- if an initial message is already composed -- by reusing the session key of an existing encrypted file that may have been shared among a group of users already. Using the session-key-reuse feature to compose an encrypted reply to such a message would unknowingly give this whole group of users cryptographic access to the encrypted message.<a class="pilcrow" href="#section-13.8-2.5.1">¶</a></p>
</li>
          <li class="normal" id="section-13.8-2.6">
            <p id="section-13.8-2.6.1">Generally, the use of the session-key-reuse feature should be under the control of the user. Specifically, care should be taken so that this feature is not silently used when the user assumes that proper public key encryption is used. This can be the case, for instance, when the public key of one of the recipients of the reply is known but has expired. Special care should be taken to ensure that users do not get caught in continued use of the session-key reuse unknowingly but instead receive the chance to switch to proper fresh public key encryption as soon as possible.<a class="pilcrow" href="#section-13.8-2.6.1">¶</a></p>
</li>
          <li class="normal" id="section-13.8-2.7">
            <p id="section-13.8-2.7.1">Whenever possible, a client should prefer a fresh public key encryption over the session-key reuse.<a class="pilcrow" href="#section-13.8-2.7.1">¶</a></p>
</li>
        </ul>
<p id="section-13.8-3">Even though this is not necessarily a security aspect, note that initially composing an encrypted reply using the session-key-reuse feature on one client and then storing it (e.g., as a draft) and later reopening the stored unfinished reply with another client that does not support the session-key-reuse feature may lead to interoperability problems.<a class="pilcrow" href="#section-13.8-3">¶</a></p>
<p id="section-13.8-4">Avoiding the pitfalls described above requires context-specific expertise.
An implementation should only make use of the session-key-reuse feature in any particular application layer when it can follow reasonable documentation about how to deploy the feature safely in the specific application.
At the time of this writing, there is no known documentation about safe reuse of OpenPGP session keys for any specific context. An implementer that intends to make use of this feature should publish their own proposed guidance for others to review.<a class="pilcrow" href="#section-13.8-4">¶</a></p>
</section>
</div>
<div id="escrowed-revocations">
<section id="section-13.9">
        <h3 id="name-escrowed-revocation-signatu">
<a class="section-number selfRef" href="#section-13.9">13.9. </a><a class="section-name selfRef" href="#name-escrowed-revocation-signatu">Escrowed Revocation Signatures</a>
        </h3>
<p id="section-13.9-1">A keyholder, Alice, may wish to designate a third party to be able to revoke her own key.<a class="pilcrow" href="#section-13.9-1">¶</a></p>
<p id="section-13.9-2">The preferred way for Alice to do this is to produce a specific Revocation Signature (Signature Type ID 0x20, 0x28, or 0x30) and distribute it securely to a preferred revoker who can hold it in escrow. The preferred revoker can then publish the escrowed Revocation Signature at whatever time is deemed appropriate rather than generating the Revocation Signature themselves.<a class="pilcrow" href="#section-13.9-2">¶</a></p>
<p id="section-13.9-3">There are multiple advantages of using an escrowed Revocation Signature over the deprecated Revocation Key subpacket (<a class="auto internal xref" href="#revocation-key">Section 5.2.3.23</a>):<a class="pilcrow" href="#section-13.9-3">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13.9-4.1">
            <p id="section-13.9-4.1.1">The keyholder can constrain what types of revocation the preferred revoker can issue, by only escrowing those specific signatures.<a class="pilcrow" href="#section-13.9-4.1.1">¶</a></p>
</li>
          <li class="normal" id="section-13.9-4.2">
            <p id="section-13.9-4.2.1">There is no public/visible linkage between the keyholder and the preferred revoker.<a class="pilcrow" href="#section-13.9-4.2.1">¶</a></p>
</li>
          <li class="normal" id="section-13.9-4.3">
            <p id="section-13.9-4.3.1">Third parties can verify the revocation without needing to find the key of the preferred revoker.<a class="pilcrow" href="#section-13.9-4.3.1">¶</a></p>
</li>
          <li class="normal" id="section-13.9-4.4">
            <p id="section-13.9-4.4.1">The preferred revoker doesn't even need to have a public OpenPGP Key if some other secure transport is possible between them and the keyholder.<a class="pilcrow" href="#section-13.9-4.4.1">¶</a></p>
</li>
          <li class="normal" id="section-13.9-4.5">
            <p id="section-13.9-4.5.1">Implementation support for enforcing a revocation from an authorized Revocation Key subpacket is uneven and unreliable.<a class="pilcrow" href="#section-13.9-4.5.1">¶</a></p>
</li>
          <li class="normal" id="section-13.9-4.6">
            <p id="section-13.9-4.6.1">If the fingerprint mechanism suffers a cryptanalytic flaw, the escrowed Revocation Signature is not affected.<a class="pilcrow" href="#section-13.9-4.6.1">¶</a></p>
</li>
        </ul>
<p id="section-13.9-5">A Revocation Signature may also be split up into shares and distributed among multiple parties, requiring some subset of those parties to collaborate before the escrowed Revocation Signature is recreated.<a class="pilcrow" href="#section-13.9-5">¶</a></p>
</section>
</div>
<div id="CSPRNG">
<section id="section-13.10">
        <h3 id="name-random-number-generation-an">
<a class="section-number selfRef" href="#section-13.10">13.10. </a><a class="section-name selfRef" href="#name-random-number-generation-an">Random Number Generation and Seeding</a>
        </h3>
<p id="section-13.10-1">OpenPGP requires a cryptographically secure pseudorandom number generator (CSPRNG). In most cases, the operating system provides an appropriate facility such as a <code>getrandom()</code> syscall on Linux or BSD, which should be used absent other (for example, performance) concerns.
It is <span class="bcp14">RECOMMENDED</span> to use an existing CSPRNG implementation as opposed to crafting a new one.
Many adequate cryptographic libraries are already available under favorable license terms. Should those prove unsatisfactory, <span>[<a class="cite xref" href="#RFC4086">RFC4086</a>]</span> provides guidance on the generation of random values.<a class="pilcrow" href="#section-13.10-1">¶</a></p>
<p id="section-13.10-2">OpenPGP uses random data with three different levels of visibility:<a class="pilcrow" href="#section-13.10-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13.10-3.1">
            <p id="section-13.10-3.1.1">In publicly visible fields such as nonces, IVs, public padding material, or salts.<a class="pilcrow" href="#section-13.10-3.1.1">¶</a></p>
</li>
          <li class="normal" id="section-13.10-3.2">
            <p id="section-13.10-3.2.1">In shared-secret values, such as session keys for encrypted data or padding material within an encrypted packet.<a class="pilcrow" href="#section-13.10-3.2.1">¶</a></p>
</li>
          <li class="normal" id="section-13.10-3.3">
            <p id="section-13.10-3.3.1">In entirely private data, such as asymmetric key generation.<a class="pilcrow" href="#section-13.10-3.3.1">¶</a></p>
</li>
        </ul>
<p id="section-13.10-4">With a properly functioning CSPRNG, this range of visibility does not present a security problem, as it is not feasible to determine the CSPRNG state from its output.
However, with a broken CSPRNG, it may be possible for an attacker to use visible output to determine the CSPRNG internal state and thereby predict less-visible data like keying material, as documented in <span>[<a class="cite xref" href="#CHECKOWAY">CHECKOWAY</a>]</span>.<a class="pilcrow" href="#section-13.10-4">¶</a></p>
<p id="section-13.10-5">An implementation can provide extra security against this form of attack by using separate CSPRNGs to generate random data with different levels of visibility.<a class="pilcrow" href="#section-13.10-5">¶</a></p>
</section>
</div>
<div id="traffic-analysis">
<section id="section-13.11">
        <h3 id="name-traffic-analysis">
<a class="section-number selfRef" href="#section-13.11">13.11. </a><a class="section-name selfRef" href="#name-traffic-analysis">Traffic Analysis</a>
        </h3>
<p id="section-13.11-1">When sending OpenPGP data through the network, the size of the data may leak information to an attacker. There are circumstances where such a leak could be unacceptable from a security perspective.<a class="pilcrow" href="#section-13.11-1">¶</a></p>
<p id="section-13.11-2">For example, if possible cleartext messages for a given protocol are known to be either <code>yes</code> (3 octets) or <code>no</code> (2 octets) and the messages are sent within a Symmetrically Encrypted and Integrity Protected Data packet, the length of the encrypted message will reveal the contents of the cleartext.<a class="pilcrow" href="#section-13.11-2">¶</a></p>
<p id="section-13.11-3">In another example, sending an OpenPGP Transferable Public Key over an encrypted network connection might reveal the length of the certificate. Since the length of an OpenPGP certificate varies based on the content, an external observer interested in metadata (e.g., which individual is trying to contact another individual) may be able to guess the identity of the certificate sent, if its length is unique.<a class="pilcrow" href="#section-13.11-3">¶</a></p>
<p id="section-13.11-4">In both cases, an implementation can adjust the size of the compound structure by including a Padding packet (see <a class="auto internal xref" href="#padding-packet">Section 5.14</a>).<a class="pilcrow" href="#section-13.11-4">¶</a></p>
</section>
</div>
<div id="surreptitious-forwarding">
<section id="section-13.12">
        <h3 id="name-surreptitious-forwarding">
<a class="section-number selfRef" href="#section-13.12">13.12. </a><a class="section-name selfRef" href="#name-surreptitious-forwarding">Surreptitious Forwarding</a>
        </h3>
<p id="section-13.12-1">When an attacker obtains a signature for some text, e.g., by receiving a signed message, they may be able to use that signature maliciously by sending a message purporting to come from the original sender, with the same body and signature, to a different recipient.
To prevent this, an implementation <span class="bcp14">SHOULD</span> implement the Intended Recipient Fingerprint subpacket (<a class="auto internal xref" href="#intended-recipient-fingerprint">Section 5.2.3.36</a>).<a class="pilcrow" href="#section-13.12-1">¶</a></p>
</section>
</div>
<div id="subpacket-section-guidance">
<section id="section-13.13">
        <h3 id="name-hashed-vs-unhashed-subpacke">
<a class="section-number selfRef" href="#section-13.13">13.13. </a><a class="section-name selfRef" href="#name-hashed-vs-unhashed-subpacke">Hashed vs. Unhashed Subpackets</a>
        </h3>
<p id="section-13.13-1">Each OpenPGP signature can have subpackets in two different sections.
The first set of subpackets (the "hashed section") is covered by the signature itself.
The second set has no cryptographic protections and is used for advisory material only, including locally stored annotations about the signature.<a class="pilcrow" href="#section-13.13-1">¶</a></p>
<p id="section-13.13-2">For example, consider an implementation working with a specific signature that happens to know that the signature was made by a certain key, even though the signature contains no Issuer Fingerprint subpacket (<a class="auto internal xref" href="#issuer-fingerprint-subpacket">Section 5.2.3.35</a>) in the hashed section.
That implementation <span class="bcp14">MAY</span> synthesize an Issuer Fingerprint subpacket and store it in the unhashed section so that it will be able to recall which key issued the signature in the future.<a class="pilcrow" href="#section-13.13-2">¶</a></p>
<p id="section-13.13-3">Some subpackets are only useful when they are in the hashed section, and an implementation <span class="bcp14">SHOULD</span> ignore them when they are found with unknown provenance in the unhashed section.
For example, a Preferred AEAD Ciphersuites subpacket (<a class="auto internal xref" href="#preferred-v2-seipd">Section 5.2.3.15</a>) in a Direct Key self-signature indicates the preferences of the keyholder when encrypting v2 SEIPD data to the key.
An implementation that observes such a subpacket found in the unhashed section would open itself to an attack where the recipient's certificate is tampered with to encourage the use of a specific cipher or mode of operation.<a class="pilcrow" href="#section-13.13-3">¶</a></p>
</section>
</div>
<div id="compress-bomb">
<section id="section-13.14">
        <h3 id="name-malicious-compressed-data">
<a class="section-number selfRef" href="#section-13.14">13.14. </a><a class="section-name selfRef" href="#name-malicious-compressed-data">Malicious Compressed Data</a>
        </h3>
<p id="section-13.14-1">It is possible to form a compression quine that produces itself upon decompression, leading to infinite regress in any implementation willing to parse arbitrary numbers of layers of compression. This could cause resource exhaustion, which itself could lead to termination by the operating system. If the operating system creates a "crash report", that report could contain confidential information.<a class="pilcrow" href="#section-13.14-1">¶</a></p>
<p id="section-13.14-2">An OpenPGP implementation <span class="bcp14">SHOULD</span> limit the number of layers of compression it is willing to decompress in a single message.<a class="pilcrow" href="#section-13.14-2">¶</a></p>
</section>
</div>
</section>
</div>
<div id="implementation-considerations">
<section id="section-14">
      <h2 id="name-implementation-consideratio">
<a class="section-number selfRef" href="#section-14">14. </a><a class="section-name selfRef" href="#name-implementation-consideratio">Implementation Considerations</a>
      </h2>
<p id="section-14-1">This section is a collection of comments to help an implementer who has a particular interest in backward compatibility. Often the differences are small, but small differences are frequently more vexing than large differences. Thus, this is a non-comprehensive list of potential problems and gotchas for a developer who is trying to achieve backward compatibility.<a class="pilcrow" href="#section-14-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-14-2.1">
          <p id="section-14-2.1.1">There are many possible ways for two keys to have the same key material but different fingerprints (and thus different Key IDs). For example, since a version 4 fingerprint is constructed by hashing the key creation time along with other things, two version 4 keys created at different times yet with the same key material will have different fingerprints.<a class="pilcrow" href="#section-14-2.1.1">¶</a></p>
</li>
        <li class="normal" id="section-14-2.2">
          <p id="section-14-2.2.1">OpenPGP does not put limits on the size of public keys.
However, larger keys are not necessarily better keys.
Larger keys take more computation time to use, and this can quickly become impractical.
Different OpenPGP implementations may also use different upper bounds for public key sizes, so care should be taken when choosing sizes to maintain interoperability.<a class="pilcrow" href="#section-14-2.2.1">¶</a></p>
</li>
        <li class="normal" id="section-14-2.3">
          <p id="section-14-2.3.1">ASCII Armor is an optional feature of OpenPGP.
The OpenPGP Working Group strives for a minimal set of mandatory-to-implement features, and since there could be useful implementations that only use binary object formats, this is not a "<span class="bcp14">MUST</span>" feature for an implementation.
For example, an implementation that is using OpenPGP as a mechanism for file signatures may find ASCII Armor unnecessary.
OpenPGP permits an implementation to declare what features it does and does not support, but ASCII Armor is not one of these.
Since most implementations allow binary and armored objects to be used indiscriminately, an implementation that does not implement ASCII Armor may find itself with compatibility issues with general-purpose implementations.
Moreover, implementations of OpenPGP-MIME <span>[<a class="cite xref" href="#RFC3156">RFC3156</a>]</span> already have a requirement for ASCII Armor, so those implementations will necessarily have support.<a class="pilcrow" href="#section-14-2.3.1">¶</a></p>
</li>
        <li class="normal" id="section-14-2.4">
          <p id="section-14-2.4.1">What this document calls the "Legacy packet format" (<a class="auto internal xref" href="#legacy-packet-format">Section 4.2.2</a>) is what older documents called the "old packet format".
It is the packet format used by implementations predating <span>[<a class="cite xref" href="#RFC2440">RFC2440</a>]</span>.
The current "OpenPGP packet format" (<a class="auto internal xref" href="#openpgp-packet-format">Section 4.2.1</a>) was called the "new packet format" by older RFCs. This is the format introduced in <span>[<a class="cite xref" href="#RFC2440">RFC2440</a>]</span> and maintained through <span>[<a class="cite xref" href="#RFC4880">RFC4880</a>]</span> to this document.<a class="pilcrow" href="#section-14-2.4.1">¶</a></p>
</li>
      </ul>
<div id="constrained-legacy-fingerprint-storage-for-v6-keys">
<section id="section-14.1">
        <h3 id="name-constrained-legacy-fingerpr">
<a class="section-number selfRef" href="#section-14.1">14.1. </a><a class="section-name selfRef" href="#name-constrained-legacy-fingerpr">Constrained Legacy Fingerprint Storage for Version 6 Keys</a>
        </h3>
<p id="section-14.1-1">Some OpenPGP implementations have fixed length constraints for key fingerprint storage that will not fit all 32 octets of a version 6 fingerprint.
For example, <span>[<a class="cite xref" href="#OPENPGPCARD">OPENPGPCARD</a>]</span> reserves 20 octets for each stored fingerprint.<a class="pilcrow" href="#section-14.1-1">¶</a></p>
<p id="section-14.1-2">An OpenPGP implementation <span class="bcp14">MUST NOT</span> attempt to map any part of a version 6 fingerprint to such a constrained field unless the relevant specification for the constrained environment has explicit guidance for storing a version 6 fingerprint that distinguishes it from a version 4 fingerprint. An implementation interacting with such a constrained field <span class="bcp14">SHOULD</span> directly calculate the version 6 fingerprint from public key material and associated metadata instead of relying on the constrained field.<a class="pilcrow" href="#section-14.1-2">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-15">
      <h2 id="name-iana-considerations">
<a class="section-number selfRef" href="#section-15">15. </a><a class="section-name selfRef" href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<p id="section-15-1">This document obsoletes <span>[<a class="cite xref" href="#RFC4880">RFC4880</a>]</span>. IANA has updated all registration information that references <span>[<a class="cite xref" href="#RFC4880">RFC4880</a>]</span> to reference this RFC instead.<a class="pilcrow" href="#section-15-1">¶</a></p>
<div id="rename-pretty-good-privacy-pgp-protocol-group-to-openpgp">
<section id="section-15.1">
        <h3 id="name-renamed-protocol-group">
<a class="section-number selfRef" href="#section-15.1">15.1. </a><a class="section-name selfRef" href="#name-renamed-protocol-group">Renamed Protocol Group</a>
        </h3>
<p id="section-15.1-1">IANA bundles a set of registries associated with a particular protocol into a "protocol group". IANA has updated the name of the "Pretty Good Privacy (PGP)" protocol group (i.e., the group of registries described at <span>&lt;<a href="https://www.iana.org/assignments/pgp-parameters">https://www.iana.org/assignments/pgp-parameters</a>&gt;</span>) to "OpenPGP". IANA has arranged a permanent redirect from the existing URL to the new URL for the registries in this protocol group. All further updates specified below are for registries within this same OpenPGP protocol group.<a class="pilcrow" href="#section-15.1-1">¶</a></p>
</section>
</div>
<div id="registries-to-be-renamed-and-updated">
<section id="section-15.2">
        <h3 id="name-renamed-and-updated-registr">
<a class="section-number selfRef" href="#section-15.2">15.2. </a><a class="section-name selfRef" href="#name-renamed-and-updated-registr">Renamed and Updated Registries</a>
        </h3>
<p id="section-15.2-1">IANA has renamed the "PGP String-to-Key (S2K)" registry to "OpenPGP String-to-Key (S2K) Types" and updated its contents as shown in  <a class="auto internal xref" href="#s2k-types-registry">Table 1</a>.<a class="pilcrow" href="#section-15.2-1">¶</a></p>
<p id="section-15.2-2">IANA has renamed the "PGP Packet Types/Tags" registry to "OpenPGP Packet Types" and updated its contents as shown in <a class="auto internal xref" href="#packet-types-registry">Table 3</a>.<a class="pilcrow" href="#section-15.2-2">¶</a></p>
<p id="section-15.2-3">IANA has renamed the "Signature Subpacket Types" registry to "OpenPGP Signature Subpacket Types" and updated its contents as shown in <a class="auto internal xref" href="#signature-subpacket-types-registry">Table 5</a>.<a class="pilcrow" href="#section-15.2-3">¶</a></p>
<p id="section-15.2-4">IANA has renamed the "Key Server Preference Extensions" registry to "OpenPGP Key Server Preference Flags" and updated its contents as shown in <a class="auto internal xref" href="#key-server-preference-flags-registry">Table 8</a>.<a class="pilcrow" href="#section-15.2-4">¶</a></p>
<p id="section-15.2-5">IANA has renamed the "Key Flags Extensions" registry to "OpenPGP Key Flags" and updated its contents as shown in <a class="auto internal xref" href="#key-flags-registry">Table 9</a>.<a class="pilcrow" href="#section-15.2-5">¶</a></p>
<p id="section-15.2-6">IANA has renamed the "Reason for Revocation Extensions" registry to "OpenPGP Reason for Revocation (Revocation Octet)" and updated its contents as shown in <a class="auto internal xref" href="#reason-for-revocation-code-registry">Table 10</a>.<a class="pilcrow" href="#section-15.2-6">¶</a></p>
<p id="section-15.2-7">IANA has renamed the "Implementation Features" registry to "OpenPGP Features Flags" and updated its contents as shown in <a class="auto internal xref" href="#features-flags-registry">Table 11</a>.<a class="pilcrow" href="#section-15.2-7">¶</a></p>
<p id="section-15.2-8">IANA has renamed the "PGP User Attribute Types" registry to "OpenPGP User Attribute Subpacket Types" and updated its contents as shown in <a class="auto internal xref" href="#user-attr-subpacket-types-registry">Table 13</a>.<a class="pilcrow" href="#section-15.2-8">¶</a></p>
<p id="section-15.2-9">IANA has renamed the "Image Format Subpacket Types" registry to "OpenPGP Image Attribute Encoding Format" and updated its contents as shown in <a class="auto internal xref" href="#image-attr-encoding-format-registry">Table 15</a>.<a class="pilcrow" href="#section-15.2-9">¶</a></p>
<p id="section-15.2-10">IANA has renamed the "Public Key Algorithms" registry to "OpenPGP Public Key Algorithms" and updated its contents as shown in <a class="auto internal xref" href="#pubkey-algo-registry">Table 18</a>.<a class="pilcrow" href="#section-15.2-10">¶</a></p>
<p id="section-15.2-11">IANA has renamed the "Symmetric Key Algorithms" registry to "OpenPGP Symmetric Key Algorithms" and updated its contents as shown in <a class="auto internal xref" href="#symkey-algorithms-registry">Table 21</a>.<a class="pilcrow" href="#section-15.2-11">¶</a></p>
<p id="section-15.2-12">IANA has renamed the "Compression Algorithms" registry to "OpenPGP Compression Algorithms" and updated its contents as shown in <a class="auto internal xref" href="#compression-algorithms-registry">Table 22</a>.<a class="pilcrow" href="#section-15.2-12">¶</a></p>
<p id="section-15.2-13">IANA has renamed the "Hash Algorithms" registry to "OpenPGP Hash Algorithms" and updated its contents as shown in <a class="auto internal xref" href="#hash-algorithms-registry">Table 23</a>.<a class="pilcrow" href="#section-15.2-13">¶</a></p>
</section>
</div>
<div id="removed-registries">
<section id="section-15.3">
        <h3 id="name-removed-registry">
<a class="section-number selfRef" href="#section-15.3">15.3. </a><a class="section-name selfRef" href="#name-removed-registry">Removed Registry</a>
        </h3>
<p id="section-15.3-1">IANA has marked the empty "New Packet Versions" registry as OBSOLETE.<a class="pilcrow" href="#section-15.3-1">¶</a></p>
<p id="section-15.3-2">A tombstone note has been added to the OpenPGP protocol group with the following content:<a class="pilcrow" href="#section-15.3-2">¶</a></p>
<blockquote id="section-15.3-3">Those wishing to use the removed "New Packet Versions" registry should instead register new versions of the relevant packets in the "OpenPGP Key and Signature Versions", "OpenPGP Key IDs and Fingerprints", and "OpenPGP Encrypted Message Packet Versions" registries.<a class="pilcrow" href="#section-15.3-3">¶</a>
</blockquote>
</section>
</div>
<div id="added-registries">
<section id="section-15.4">
        <h3 id="name-added-registries">
<a class="section-number selfRef" href="#section-15.4">15.4. </a><a class="section-name selfRef" href="#name-added-registries">Added Registries</a>
        </h3>
<p id="section-15.4-1">IANA has added the following registries in the OpenPGP protocol group. Note that the initial contents of each registry is shown in the corresponding table.<a class="pilcrow" href="#section-15.4-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-15.4-2.1">
            <p id="section-15.4-2.1.1">"OpenPGP Secret Key Encryption (S2K Usage Octet)" (<a class="auto internal xref" href="#secret-key-protection-registry">Table 2</a>).<a class="pilcrow" href="#section-15.4-2.1.1">¶</a></p>
</li>
          <li class="normal" id="section-15.4-2.2">
            <p id="section-15.4-2.2.1">"OpenPGP Signature Types" (<a class="auto internal xref" href="#signature-types-registry">Table 4</a>).<a class="pilcrow" href="#section-15.4-2.2.1">¶</a></p>
</li>
          <li class="normal" id="section-15.4-2.3">
            <p id="section-15.4-2.3.1">"OpenPGP Signature Notation Data Subpacket Notation Flags" (<a class="auto internal xref" href="#sig-note-data-note-flags-registry">Table 6</a>).<a class="pilcrow" href="#section-15.4-2.3.1">¶</a></p>
</li>
          <li class="normal" id="section-15.4-2.4">
            <p id="section-15.4-2.4.1">"OpenPGP Signature Notation Data Subpacket Types" (<a class="auto internal xref" href="#sig-note-data-subpacket-types">Table 7</a>).<a class="pilcrow" href="#section-15.4-2.4.1">¶</a></p>
</li>
          <li class="normal" id="section-15.4-2.5">
            <p id="section-15.4-2.5.1">"OpenPGP Key IDs and Fingerprints" (<a class="auto internal xref" href="#key-id-fingerprint-registry">Table 12</a>).<a class="pilcrow" href="#section-15.4-2.5.1">¶</a></p>
</li>
          <li class="normal" id="section-15.4-2.6">
            <p id="section-15.4-2.6.1">"OpenPGP Image Attribute Versions" (<a class="auto internal xref" href="#image-attribute-version-registry">Table 14</a>).<a class="pilcrow" href="#section-15.4-2.6.1">¶</a></p>
</li>
          <li class="normal" id="section-15.4-2.7">
            <p id="section-15.4-2.7.1">"OpenPGP Armor Header Lines" (<a class="auto internal xref" href="#armor-header-line-registry">Table 16</a>).<a class="pilcrow" href="#section-15.4-2.7.1">¶</a></p>
</li>
          <li class="normal" id="section-15.4-2.8">
            <p id="section-15.4-2.8.1">"OpenPGP Armor Header Keys" (<a class="auto internal xref" href="#armor-header-key-registry">Table 17</a>).<a class="pilcrow" href="#section-15.4-2.8.1">¶</a></p>
</li>
          <li class="normal" id="section-15.4-2.9">
            <p id="section-15.4-2.9.1">"OpenPGP ECC Curve OIDs and Usage" (<a class="auto internal xref" href="#ecc-oid-usage-registry">Table 19</a>).<a class="pilcrow" href="#section-15.4-2.9.1">¶</a></p>
</li>
          <li class="normal" id="section-15.4-2.10">
            <p id="section-15.4-2.10.1">"OpenPGP ECC Curve-Specific Wire Formats" (<a class="auto internal xref" href="#ecc-wire-formats-registry">Table 20</a>).<a class="pilcrow" href="#section-15.4-2.10.1">¶</a></p>
</li>
          <li class="normal" id="section-15.4-2.11">
            <p id="section-15.4-2.11.1">"OpenPGP Hash Algorithm Identifiers for RSA Signatures' Use of EMSA-PKCS1-v1_5 Padding" (<a class="auto internal xref" href="#emsa-hash-oids-registry">Table 24</a>).<a class="pilcrow" href="#section-15.4-2.11.1">¶</a></p>
</li>
          <li class="normal" id="section-15.4-2.12">
            <p id="section-15.4-2.12.1">"OpenPGP AEAD Algorithms" (<a class="auto internal xref" href="#aead-algorithms-registry">Table 25</a>).<a class="pilcrow" href="#section-15.4-2.12.1">¶</a></p>
</li>
          <li class="normal" id="section-15.4-2.13">
            <p id="section-15.4-2.13.1">"OpenPGP Encrypted Message Packet Versions" (<a class="auto internal xref" href="#encrypted-packet-versions-registry">Table 26</a>).<a class="pilcrow" href="#section-15.4-2.13.1">¶</a></p>
</li>
          <li class="normal" id="section-15.4-2.14">
            <p id="section-15.4-2.14.1">"OpenPGP Key and Signature Versions" (<a class="auto internal xref" href="#signed-packet-versions-registry">Table 27</a>).<a class="pilcrow" href="#section-15.4-2.14.1">¶</a></p>
</li>
          <li class="normal" id="section-15.4-2.15">
            <p id="section-15.4-2.15.1">"OpenPGP Elliptic Curve Point Wire Formats" (<a class="auto internal xref" href="#ec-point-wire-formats-registry">Table 28</a>).<a class="pilcrow" href="#section-15.4-2.15.1">¶</a></p>
</li>
          <li class="normal" id="section-15.4-2.16">
            <p id="section-15.4-2.16.1">"OpenPGP Elliptic Curve Scalar Encodings" (<a class="auto internal xref" href="#ec-scalar-wire-formats-registry">Table 29</a>).<a class="pilcrow" href="#section-15.4-2.16.1">¶</a></p>
</li>
          <li class="normal" id="section-15.4-2.17">
            <p id="section-15.4-2.17.1">"OpenPGP ECDH KDF and KEK Parameters" (<a class="auto internal xref" href="#ecdh-kdf-kek-parameters-registry">Table 30</a>).<a class="pilcrow" href="#section-15.4-2.17.1">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="registration-policies">
<section id="section-15.5">
        <h3 id="name-registration-policies">
<a class="section-number selfRef" href="#section-15.5">15.5. </a><a class="section-name selfRef" href="#name-registration-policies">Registration Policies</a>
        </h3>
<p id="section-15.5-1">All registries within the OpenPGP protocol group, with the exception of the registries listed in <a class="auto internal xref" href="#rfc-required-registries">Section 15.5.1</a>, use the Specification Required registration policy; see <span><a class="relref" href="https://rfc-editor.org/rfc/rfc8126#section-4.6">Section 4.6</a> of [<a class="cite xref" href="#RFC8126">RFC8126</a>]</span>.
This policy means that review and approval by a designated expert is required and that the IDs and their meanings must be documented in a permanent and readily available public specification, in sufficient detail, so that interoperability between independent implementations is possible.<a class="pilcrow" href="#section-15.5-1">¶</a></p>
<div id="rfc-required-registries">
<section id="section-15.5.1">
          <h4 id="name-registries-that-use-rfc-req">
<a class="section-number selfRef" href="#section-15.5.1">15.5.1. </a><a class="section-name selfRef" href="#name-registries-that-use-rfc-req">Registries That Use RFC Required</a>
          </h4>
<p id="section-15.5.1-1">The following registries use the RFC Required registration policy, as described in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc8126#section-4.7">Section 4.7</a> of [<a class="cite xref" href="#RFC8126">RFC8126</a>]</span>:<a class="pilcrow" href="#section-15.5.1-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-15.5.1-2.1">
              <p id="section-15.5.1-2.1.1">"OpenPGP Packet Types" (<a class="auto internal xref" href="#packet-types-registry">Table 3</a>).<a class="pilcrow" href="#section-15.5.1-2.1.1">¶</a></p>
</li>
            <li class="normal" id="section-15.5.1-2.2">
              <p id="section-15.5.1-2.2.1">"OpenPGP Key IDs and Fingerprints" (<a class="auto internal xref" href="#key-id-fingerprint-registry">Table 12</a>).<a class="pilcrow" href="#section-15.5.1-2.2.1">¶</a></p>
</li>
            <li class="normal" id="section-15.5.1-2.3">
              <p id="section-15.5.1-2.3.1">"OpenPGP Encrypted Message Packet Versions" (<a class="auto internal xref" href="#encrypted-packet-versions-registry">Table 26</a>).<a class="pilcrow" href="#section-15.5.1-2.3.1">¶</a></p>
</li>
            <li class="normal" id="section-15.5.1-2.4">
              <p id="section-15.5.1-2.4.1">"OpenPGP Key and Signature Versions" (<a class="auto internal xref" href="#signed-packet-versions-registry">Table 27</a>).<a class="pilcrow" href="#section-15.5.1-2.4.1">¶</a></p>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="designated-experts">
<section id="section-15.6">
        <h3 id="name-designated-experts">
<a class="section-number selfRef" href="#section-15.6">15.6. </a><a class="section-name selfRef" href="#name-designated-experts">Designated Experts</a>
        </h3>
<p id="section-15.6-1">The designated experts will determine whether the new registrations retain the security properties that are expected by the base implementation and whether these new registrations do not cause interoperability issues with existing implementations, other than not producing or consuming the IDs associated with these new registrations.
Registration proposals that fail to meet these criteria could instead be proposed as new work items for the OpenPGP Working Group or its successor.<a class="pilcrow" href="#section-15.6-1">¶</a></p>
<p id="section-15.6-2">The subsections below describe specific guidance for classes of registry updates that a designated expert will consider.<a class="pilcrow" href="#section-15.6-2">¶</a></p>
<p id="section-15.6-3">The designated experts should also consider <a class="auto internal xref" href="#meta-considerations-for-expansion">Section 12.11</a> when reviewing proposed additions to the OpenPGP protocol group.<a class="pilcrow" href="#section-15.6-3">¶</a></p>
<div id="key-and-signature-versions">
<section id="section-15.6.1">
          <h4 id="name-key-and-signature-versions">
<a class="section-number selfRef" href="#section-15.6.1">15.6.1. </a><a class="section-name selfRef" href="#name-key-and-signature-versions">Key and Signature Versions</a>
          </h4>
<p id="section-15.6.1-1">When defining a new version of OpenPGP Keys or Signatures, the "OpenPGP Key and Signature Versions" registry (<a class="auto internal xref" href="#signed-packet-versions-registry">Table 27</a>) should be updated. When a new version of OpenPGP Key is defined, the "OpenPGP Key IDs and Fingerprints" registry (<a class="auto internal xref" href="#key-id-fingerprint-registry">Table 12</a>) should also be updated.<a class="pilcrow" href="#section-15.6.1-1">¶</a></p>
</section>
</div>
<div id="encryption-versions">
<section id="section-15.6.2">
          <h4 id="name-encryption-versions">
<a class="section-number selfRef" href="#section-15.6.2">15.6.2. </a><a class="section-name selfRef" href="#name-encryption-versions">Encryption Versions</a>
          </h4>
<p id="section-15.6.2-1">When defining a new version of the Symmetrically Encrypted and Integrity Protected Data packet (<a class="auto internal xref" href="#seipd">Section 5.13</a>), Public Key Encrypted Session Key packet (<a class="auto internal xref" href="#pkesk">Section 5.1</a>), and/or Symmetric Key Encrypted Session Key packet (<a class="auto internal xref" href="#skesk">Section 5.3</a>), the "OpenPGP Encrypted Message Packet Versions" registry (<a class="auto internal xref" href="#encrypted-packet-versions-registry">Table 26</a>) should be updated. When the SEIPD is updated, consider also adding a corresponding flag to the "OpenPGP Features Flags" registry (<a class="auto internal xref" href="#features-flags-registry">Table 11</a>).<a class="pilcrow" href="#section-15.6.2-1">¶</a></p>
</section>
</div>
<div id="algorithms">
<section id="section-15.6.3">
          <h4 id="name-algorithms">
<a class="section-number selfRef" href="#section-15.6.3">15.6.3. </a><a class="section-name selfRef" href="#name-algorithms">Algorithms</a>
          </h4>
<p id="section-15.6.3-1"><a class="auto internal xref" href="#constants">Section 9</a> lists the cryptographic and compression algorithms that OpenPGP uses.
Adding new algorithms is usually simple; in some cases, allocating an ID and pointing to a reference is only needed. But some algorithm registries require some subtle additional details when a new algorithm is introduced.<a class="pilcrow" href="#section-15.6.3-1">¶</a></p>
<div id="elliptic-curve-algorithms">
<section id="section-15.6.3.1">
            <h5 id="name-elliptic-curve-algorithms">
<a class="section-number selfRef" href="#section-15.6.3.1">15.6.3.1. </a><a class="section-name selfRef" href="#name-elliptic-curve-algorithms">Elliptic Curve Algorithms</a>
            </h5>
<p id="section-15.6.3.1-1">To register a new elliptic curve for use with OpenPGP, its OID needs to be registered in the "OpenPGP ECC Curve OIDs and Usage" registry (<a class="auto internal xref" href="#ecc-oid-usage-registry">Table 19</a>), its wire format needs to be documented in the "OpenPGP ECC Curve-Specific Wire Formats" registry (<a class="auto internal xref" href="#ecc-wire-formats-registry">Table 20</a>), and if used for ECDH, its KDF and KEK parameters must be populated in the "OpenPGP ECDH KDF and KEK Parameters" registry (<a class="auto internal xref" href="#ecdh-kdf-kek-parameters-registry">Table 30</a>). If the wire format(s) used is not already defined in the "OpenPGP Elliptic Curve Point Wire Formats" (<a class="auto internal xref" href="#ec-point-wire-formats-registry">Table 28</a>) or "OpenPGP Elliptic Curve Scalar Encodings" (<a class="auto internal xref" href="#ec-scalar-wire-formats-registry">Table 29</a>) registries, they should be defined there as well.<a class="pilcrow" href="#section-15.6.3.1-1">¶</a></p>
</section>
</div>
<div id="symmetric-key-algorithms">
<section id="section-15.6.3.2">
            <h5 id="name-symmetric-key-algorithms-2">
<a class="section-number selfRef" href="#section-15.6.3.2">15.6.3.2. </a><a class="section-name selfRef" href="#name-symmetric-key-algorithms-2">Symmetric Key Algorithms</a>
            </h5>
<p id="section-15.6.3.2-1">When registering a new symmetric cipher with a block size of 64 or 128 bits and a key size that is a multiple of 64 bits, no new considerations are needed.<a class="pilcrow" href="#section-15.6.3.2-1">¶</a></p>
<p id="section-15.6.3.2-2">If the new cipher has a different block size, there needs to be additional documentation describing how to use the cipher in CFB mode.<a class="pilcrow" href="#section-15.6.3.2-2">¶</a></p>
<p id="section-15.6.3.2-3">If the new cipher has an unusual key size, then padding needs to be considered for X25519 and X448 key wrapping, which currently needs no padding.<a class="pilcrow" href="#section-15.6.3.2-3">¶</a></p>
</section>
</div>
<div id="hash-algorithms">
<section id="section-15.6.3.3">
            <h5 id="name-hash-algorithms-2">
<a class="section-number selfRef" href="#section-15.6.3.3">15.6.3.3. </a><a class="section-name selfRef" href="#name-hash-algorithms-2">Hash Algorithms</a>
            </h5>
<p id="section-15.6.3.3-1">When registering a new hash algorithm in the "OpenPGP Hash Algorithms" registry (<a class="auto internal xref" href="#hash-algorithms-registry">Table 23</a>), if the algorithm is also to be used with RSA signing schemes, it must also have an entry in the "OpenPGP Hash Algorithm Identifiers for RSA Signatures' Use of EMSA-PKCS1-v1_5 Padding" registry (<a class="auto internal xref" href="#emsa-hash-oids-registry">Table 24</a>).<a class="pilcrow" href="#section-15.6.3.3-1">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<section id="section-16">
      <h2 id="name-references">
<a class="section-number selfRef" href="#section-16">16. </a><a class="section-name selfRef" href="#name-references">References</a>
      </h2>
<section id="section-16.1">
        <h3 id="name-normative-references">
<a class="section-number selfRef" href="#section-16.1">16.1. </a><a class="section-name selfRef" href="#name-normative-references">Normative References</a>
        </h3>
<dl class="references">
<dt id="AES">[AES]</dt>
        <dd>
<span class="refAuthor">NIST</span>, <span class="refTitle">"Advanced Encryption Standard (AES)"</span>, <span class="refContent">Updated May 2023</span>, <span class="seriesInfo">FIPS PUB 197</span>, <span class="seriesInfo">DOI 10.6028/NIST.FIPS.197-upd1</span>, <time class="refDate" datetime="2001-11">November 2001</time>, <span>&lt;<a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.197-upd1.pdf">https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.197-upd1.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="BLOWFISH">[BLOWFISH]</dt>
        <dd>
<span class="refAuthor">Schneier, B.</span>, <span class="refTitle">"Description of a New Variable-Length Key, 64-Bit Block Cipher (Blowfish)"</span>, <span class="refContent">Fast Software Encryption, Cambridge Security Workshop Proceedings, pp. 191-204</span>, <time class="refDate" datetime="1993-12">December 1993</time>, <span>&lt;<a href="https://www.schneier.com/academic/archives/1994/09/description_of_a_new.html">https://www.schneier.com/academic/archives/1994/09/description_of_a_new.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="BZ2">[BZ2]</dt>
        <dd>
<span class="refAuthor">bzip2</span>, <span class="refTitle">"bzip2 and libbzip2"</span>, <time class="refDate" datetime="2010">2010</time>, <span>&lt;<a href="https://sourceware.org/bzip2/">https://sourceware.org/bzip2/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="EAX">[EAX]</dt>
        <dd>
<span class="refAuthor">Bellare, M.</span>, <span class="refAuthor">Rogaway, P.</span>, and <span class="refAuthor">D. Wagner</span>, <span class="refTitle">"A Conventional Authenticated-Encryption Mode"</span>, <time class="refDate" datetime="2003-04">April 2003</time>, <span>&lt;<a href="https://seclab.cs.ucdavis.edu/papers/eax.pdf">https://seclab.cs.ucdavis.edu/papers/eax.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ELGAMAL">[ELGAMAL]</dt>
        <dd>
<span class="refAuthor">Elgamal, T.</span>, <span class="refTitle">"A Public Key Cryptosystem and a Signature Scheme Based on Discrete Logarithms"</span>, <span class="refContent">IEEE Transactions on Information Theory, Vol. 31, Issue 4, pp. 469-472</span>, <span class="seriesInfo">DOI 10.1109/TIT.1985.1057074</span>, <time class="refDate" datetime="1985-07">July 1985</time>, <span>&lt;<a href="https://doi.org/10.1109/TIT.1985.1057074">https://doi.org/10.1109/TIT.1985.1057074</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="FIPS180">[FIPS180]</dt>
        <dd>
<span class="refAuthor">NIST</span>, <span class="refTitle">"Secure Hash Standard (SHS)"</span>, <span class="seriesInfo">FIPS PUB 180-4</span>, <span class="seriesInfo">DOI 10.6028/NIST.FIPS.180-4</span>, <time class="refDate" datetime="2015-08">August 2015</time>, <span>&lt;<a href="https://nvlpubs.nist.gov/nistpubs/fips/nist.fips.180-4.pdf">https://nvlpubs.nist.gov/nistpubs/fips/nist.fips.180-4.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="FIPS186">[FIPS186]</dt>
        <dd>
<span class="refAuthor">NIST</span>, <span class="refTitle">"Digital Signature Standard (DSS)"</span>, <span class="seriesInfo">FIPS PUB 186-5</span>, <span class="seriesInfo">DOI 10.6028/NIST.FIPS.186-5</span>, <time class="refDate" datetime="2023-02">February 2023</time>, <span>&lt;<a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.186-5.pdf">https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.186-5.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="FIPS202">[FIPS202]</dt>
        <dd>
<span class="refAuthor">NIST</span>, <span class="refTitle">"SHA-3 Standard: Permutation-Based Hash and Extendable-Output Functions"</span>, <span class="seriesInfo">FIPS PUB 202</span>, <span class="seriesInfo">DOI 10.6028/NIST.FIPS.202</span>, <time class="refDate" datetime="2015-08">August 2015</time>, <span>&lt;<a href="https://nvlpubs.nist.gov/nistpubs/fips/nist.fips.202.pdf">https://nvlpubs.nist.gov/nistpubs/fips/nist.fips.202.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IDEA">[IDEA]</dt>
        <dd>
<span class="refAuthor">Lai, X.</span> and <span class="refAuthor">J. L. Massey</span>, <span class="refTitle">"A Proposal for a New Block Encryption Standard"</span>, <span class="refContent">Advances in Cryptology - EUROCRYPT '90, Vol. 473, pp. 389-404</span>, <span class="seriesInfo">DOI 10.1007/3-540-46877-3_35</span>, <time class="refDate" datetime="1991-01">January 1991</time>, <span>&lt;<a href="https://link.springer.com/chapter/10.1007/3-540-46877-3_35">https://link.springer.com/chapter/10.1007/3-540-46877-3_35</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ISO10646">[ISO10646]</dt>
        <dd>
<span class="refAuthor">ISO</span>, <span class="refTitle">"Information technology - Universal coded character set (UCS)"</span>, <span class="seriesInfo">ISO/IEC 10646:2020</span>, <time class="refDate" datetime="2020-12">December 2020</time>, <span>&lt;<a href="https://www.iso.org/standard/76835.html">https://www.iso.org/standard/76835.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="JFIF">[JFIF]</dt>
        <dd>
<span class="refAuthor">ITU-T</span>, <span class="refTitle">"Information technology - Digital compression and coding of continuous-tone still images: JPEG File Interchange Format (JFIF)"</span>, <span class="seriesInfo">Recommendation ITU-T T.871</span>, <time class="refDate" datetime="2011-05">May 2011</time>, <span>&lt;<a href="https://www.itu.int/rec/T-REC-T.871-201105-I">https://www.itu.int/rec/T-REC-T.871-201105-I</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1321">[RFC1321]</dt>
        <dd>
<span class="refAuthor">Rivest, R.</span>, <span class="refTitle">"The MD5 Message-Digest Algorithm"</span>, <span class="seriesInfo">RFC 1321</span>, <span class="seriesInfo">DOI 10.17487/RFC1321</span>, <time class="refDate" datetime="1992-04">April 1992</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1321">https://www.rfc-editor.org/info/rfc1321</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1950">[RFC1950]</dt>
        <dd>
<span class="refAuthor">Deutsch, P.</span> and <span class="refAuthor">J. Gailly</span>, <span class="refTitle">"ZLIB Compressed Data Format Specification version 3.3"</span>, <span class="seriesInfo">RFC 1950</span>, <span class="seriesInfo">DOI 10.17487/RFC1950</span>, <time class="refDate" datetime="1996-05">May 1996</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1950">https://www.rfc-editor.org/info/rfc1950</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1951">[RFC1951]</dt>
        <dd>
<span class="refAuthor">Deutsch, P.</span>, <span class="refTitle">"DEFLATE Compressed Data Format Specification version 1.3"</span>, <span class="seriesInfo">RFC 1951</span>, <span class="seriesInfo">DOI 10.17487/RFC1951</span>, <time class="refDate" datetime="1996-05">May 1996</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1951">https://www.rfc-editor.org/info/rfc1951</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time class="refDate" datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2144">[RFC2144]</dt>
        <dd>
<span class="refAuthor">Adams, C.</span>, <span class="refTitle">"The CAST-128 Encryption Algorithm"</span>, <span class="seriesInfo">RFC 2144</span>, <span class="seriesInfo">DOI 10.17487/RFC2144</span>, <time class="refDate" datetime="1997-05">May 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2144">https://www.rfc-editor.org/info/rfc2144</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2822">[RFC2822]</dt>
        <dd>
<span class="refAuthor">Resnick, P., Ed.</span>, <span class="refTitle">"Internet Message Format"</span>, <span class="seriesInfo">RFC 2822</span>, <span class="seriesInfo">DOI 10.17487/RFC2822</span>, <time class="refDate" datetime="2001-04">April 2001</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2822">https://www.rfc-editor.org/info/rfc2822</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3156">[RFC3156]</dt>
        <dd>
<span class="refAuthor">Elkins, M.</span>, <span class="refAuthor">Del Torto, D.</span>, <span class="refAuthor">Levien, R.</span>, and <span class="refAuthor">T. Roessler</span>, <span class="refTitle">"MIME Security with OpenPGP"</span>, <span class="seriesInfo">RFC 3156</span>, <span class="seriesInfo">DOI 10.17487/RFC3156</span>, <time class="refDate" datetime="2001-08">August 2001</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3156">https://www.rfc-editor.org/info/rfc3156</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3394">[RFC3394]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span> and <span class="refAuthor">R. Housley</span>, <span class="refTitle">"Advanced Encryption Standard (AES) Key Wrap Algorithm"</span>, <span class="seriesInfo">RFC 3394</span>, <span class="seriesInfo">DOI 10.17487/RFC3394</span>, <time class="refDate" datetime="2002-09">September 2002</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3394">https://www.rfc-editor.org/info/rfc3394</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3629">[RFC3629]</dt>
        <dd>
<span class="refAuthor">Yergeau, F.</span>, <span class="refTitle">"UTF-8, a transformation format of ISO 10646"</span>, <span class="seriesInfo">STD 63</span>, <span class="seriesInfo">RFC 3629</span>, <span class="seriesInfo">DOI 10.17487/RFC3629</span>, <time class="refDate" datetime="2003-11">November 2003</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3629">https://www.rfc-editor.org/info/rfc3629</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3713">[RFC3713]</dt>
        <dd>
<span class="refAuthor">Matsui, M.</span>, <span class="refAuthor">Nakajima, J.</span>, and <span class="refAuthor">S. Moriai</span>, <span class="refTitle">"A Description of the Camellia Encryption Algorithm"</span>, <span class="seriesInfo">RFC 3713</span>, <span class="seriesInfo">DOI 10.17487/RFC3713</span>, <time class="refDate" datetime="2004-04">April 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3713">https://www.rfc-editor.org/info/rfc3713</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4086">[RFC4086]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span>, <span class="refAuthor">Schiller, J.</span>, and <span class="refAuthor">S. Crocker</span>, <span class="refTitle">"Randomness Requirements for Security"</span>, <span class="seriesInfo">BCP 106</span>, <span class="seriesInfo">RFC 4086</span>, <span class="seriesInfo">DOI 10.17487/RFC4086</span>, <time class="refDate" datetime="2005-06">June 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4086">https://www.rfc-editor.org/info/rfc4086</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4648">[RFC4648]</dt>
        <dd>
<span class="refAuthor">Josefsson, S.</span>, <span class="refTitle">"The Base16, Base32, and Base64 Data Encodings"</span>, <span class="seriesInfo">RFC 4648</span>, <span class="seriesInfo">DOI 10.17487/RFC4648</span>, <time class="refDate" datetime="2006-10">October 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4648">https://www.rfc-editor.org/info/rfc4648</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5322">[RFC5322]</dt>
        <dd>
<span class="refAuthor">Resnick, P., Ed.</span>, <span class="refTitle">"Internet Message Format"</span>, <span class="seriesInfo">RFC 5322</span>, <span class="seriesInfo">DOI 10.17487/RFC5322</span>, <time class="refDate" datetime="2008-10">October 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5322">https://www.rfc-editor.org/info/rfc5322</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6234">[RFC6234]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span> and <span class="refAuthor">T. Hansen</span>, <span class="refTitle">"US Secure Hash Algorithms (SHA and SHA-based HMAC and HKDF)"</span>, <span class="seriesInfo">RFC 6234</span>, <span class="seriesInfo">DOI 10.17487/RFC6234</span>, <time class="refDate" datetime="2011-05">May 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6234">https://www.rfc-editor.org/info/rfc6234</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7253">[RFC7253]</dt>
        <dd>
<span class="refAuthor">Krovetz, T.</span> and <span class="refAuthor">P. Rogaway</span>, <span class="refTitle">"The OCB Authenticated-Encryption Algorithm"</span>, <span class="seriesInfo">RFC 7253</span>, <span class="seriesInfo">DOI 10.17487/RFC7253</span>, <time class="refDate" datetime="2014-05">May 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7253">https://www.rfc-editor.org/info/rfc7253</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7748">[RFC7748]</dt>
        <dd>
<span class="refAuthor">Langley, A.</span>, <span class="refAuthor">Hamburg, M.</span>, and <span class="refAuthor">S. Turner</span>, <span class="refTitle">"Elliptic Curves for Security"</span>, <span class="seriesInfo">RFC 7748</span>, <span class="seriesInfo">DOI 10.17487/RFC7748</span>, <time class="refDate" datetime="2016-01">January 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7748">https://www.rfc-editor.org/info/rfc7748</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8017">[RFC8017]</dt>
        <dd>
<span class="refAuthor">Moriarty, K., Ed.</span>, <span class="refAuthor">Kaliski, B.</span>, <span class="refAuthor">Jonsson, J.</span>, and <span class="refAuthor">A. Rusch</span>, <span class="refTitle">"PKCS #1: RSA Cryptography Specifications Version 2.2"</span>, <span class="seriesInfo">RFC 8017</span>, <span class="seriesInfo">DOI 10.17487/RFC8017</span>, <time class="refDate" datetime="2016-11">November 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8017">https://www.rfc-editor.org/info/rfc8017</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8018">[RFC8018]</dt>
        <dd>
<span class="refAuthor">Moriarty, K., Ed.</span>, <span class="refAuthor">Kaliski, B.</span>, and <span class="refAuthor">A. Rusch</span>, <span class="refTitle">"PKCS #5: Password-Based Cryptography Specification Version 2.1"</span>, <span class="seriesInfo">RFC 8018</span>, <span class="seriesInfo">DOI 10.17487/RFC8018</span>, <time class="refDate" datetime="2017-01">January 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8018">https://www.rfc-editor.org/info/rfc8018</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8032">[RFC8032]</dt>
        <dd>
<span class="refAuthor">Josefsson, S.</span> and <span class="refAuthor">I. Liusvaara</span>, <span class="refTitle">"Edwards-Curve Digital Signature Algorithm (EdDSA)"</span>, <span class="seriesInfo">RFC 8032</span>, <span class="seriesInfo">DOI 10.17487/RFC8032</span>, <time class="refDate" datetime="2017-01">January 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8032">https://www.rfc-editor.org/info/rfc8032</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time class="refDate" datetime="2017-06">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time class="refDate" datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9106">[RFC9106]</dt>
        <dd>
<span class="refAuthor">Biryukov, A.</span>, <span class="refAuthor">Dinu, D.</span>, <span class="refAuthor">Khovratovich, D.</span>, and <span class="refAuthor">S. Josefsson</span>, <span class="refTitle">"Argon2 Memory-Hard Function for Password Hashing and Proof-of-Work Applications"</span>, <span class="seriesInfo">RFC 9106</span>, <span class="seriesInfo">DOI 10.17487/RFC9106</span>, <time class="refDate" datetime="2021-09">September 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9106">https://www.rfc-editor.org/info/rfc9106</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RIPEMD-160">[RIPEMD-160]</dt>
        <dd>
<span class="refAuthor">ISO</span>, <span class="refTitle">"Information technology - Security techniques - Hash-functions - Part 3: Dedicated hash-functions"</span>, <span class="seriesInfo">ISO/IEC 10118-3:1998</span>, <time class="refDate" datetime="1998-05">May 1998</time>. </dd>
<dd class="break"></dd>
<dt id="SP800-38A">[SP800-38A]</dt>
        <dd>
<span class="refAuthor">NIST</span>, <span class="refTitle">"Recommendation for Block Cipher Modes of Operation: Methods and Techniques"</span>, <span class="seriesInfo">NIST Special Publication 800-38A</span>, <span class="seriesInfo">DOI 10.6028/NIST.SP.800-38A</span>, <time class="refDate" datetime="2001-12">December 2001</time>, <span>&lt;<a href="https://nvlpubs.nist.gov/nistpubs/legacy/sp/nistspecialpublication800-38a.pdf">https://nvlpubs.nist.gov/nistpubs/legacy/sp/nistspecialpublication800-38a.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SP800-38D">[SP800-38D]</dt>
        <dd>
<span class="refAuthor">NIST</span>, <span class="refTitle">"Recommendation for Block Cipher Modes of Operation: Galois/Counter Mode (GCM) and GMAC"</span>, <span class="seriesInfo">NIST Special Publication 800-38D</span>, <span class="seriesInfo">DOI 10.6028/NIST.SP.800-38D</span>, <time class="refDate" datetime="2007-11">November 2007</time>, <span>&lt;<a href="https://nvlpubs.nist.gov/nistpubs/legacy/sp/nistspecialpublication800-38d.pdf">https://nvlpubs.nist.gov/nistpubs/legacy/sp/nistspecialpublication800-38d.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SP800-56A">[SP800-56A]</dt>
        <dd>
<span class="refAuthor">NIST</span>, <span class="refTitle">"Recommendation for Pair-Wise Key Establishment Schemes Using Discrete Logarithm Cryptography"</span>, <span class="seriesInfo">NIST Special Publication 800-56A Revision 3</span>, <span class="seriesInfo">DOI 10.6028/NIST.SP.800-56Ar</span>, <time class="refDate" datetime="2018-04">April 2018</time>, <span>&lt;<a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/%20%20%20%20%20%20%20%20%20%20nist.sp.800-56Ar3.pdf">https://nvlpubs.nist.gov/nistpubs/SpecialPublications/          nist.sp.800-56Ar3.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SP800-67">[SP800-67]</dt>
        <dd>
<span class="refAuthor">NIST</span>, <span class="refTitle">"Recommendation for the Triple Data Encryption Algorithm (TDEA) Block Cipher"</span>, <span class="seriesInfo">NIST Special Publication 800-67 Revision 2</span>, <span class="seriesInfo">DOI 10.6028/NIST.SP.800-67r2</span>, <time class="refDate" datetime="2017-11">November 2017</time>, <span>&lt;<a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-67r2.pdf">https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-67r2.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TWOFISH">[TWOFISH]</dt>
      <dd>
<span class="refAuthor">Schneier, B.</span>, <span class="refAuthor">Kelsey, J.</span>, <span class="refAuthor">Whiting, D.</span>, <span class="refAuthor">Wagner, D.</span>, <span class="refAuthor">Hall, C.</span>, and <span class="refAuthor">N. Ferguson</span>, <span class="refTitle">"Twofish: A 128-Bit Block Cipher"</span>, <time class="refDate" datetime="1998-06">June 1998</time>, <span>&lt;<a href="https://www.schneier.com/wp-content/uploads/2016/02/paper-twofish-paper.pdf">https://www.schneier.com/wp-content/uploads/2016/02/paper-twofish-paper.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-16.2">
        <h3 id="name-informative-references">
<a class="section-number selfRef" href="#section-16.2">16.2. </a><a class="section-name selfRef" href="#name-informative-references">Informative References</a>
        </h3>
<dl class="references">
<dt id="BLEICHENBACHER">[BLEICHENBACHER]</dt>
        <dd>
<span class="refAuthor">Bleichenbacher, D.</span>, <span class="refTitle">"Generating ElGamal Signatures Without Knowing the Secret Key"</span>, <span class="refContent">EUROCRYPT'96: International Conference on the Theory and Applications of Cryptographic Techniques Proceedings, Vol. 1070, pp. 10-18</span>, <time class="refDate" datetime="1996-05">May 1996</time>. </dd>
<dd class="break"></dd>
<dt id="BLEICHENBACHER-PKCS1">[BLEICHENBACHER-PKCS1]</dt>
        <dd>
<span class="refAuthor">Bleichenbacher, D.</span>, <span class="refTitle">"Chosen Ciphertext Attacks Against Protocols Based on the RSA Encryption Standard PKCS #1"</span>, <span class="refContent">CRYPTO '98: International Cryptology Conference Proceedings, Vol. 1462, pp. 1-12</span>, <time class="refDate" datetime="1998-08">August 1998</time>, <span>&lt;<a href="http://archiv.infsec.ethz.ch/education/fs08/secsem/Bleichenbacher98.pdf">http://archiv.infsec.ethz.ch/education/fs08/secsem/Bleichenbacher98.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="C99">[C99]</dt>
        <dd>
<span class="refAuthor">ISO</span>, <span class="refTitle">"Information technology - Programming languages: C"</span>, <span class="seriesInfo">ISO/IEC 9899:2018</span>, <time class="refDate" datetime="2018-06">June 2018</time>, <span>&lt;<a href="https://www.iso.org/standard/74528.html">https://www.iso.org/standard/74528.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="CHECKOWAY">[CHECKOWAY]</dt>
        <dd>
<span class="refAuthor">Checkoway, S.</span>, <span class="refAuthor">Maskiewicz, J.</span>, <span class="refAuthor">Garman, C.</span>, <span class="refAuthor">Fried, J.</span>, <span class="refAuthor">Cohney, S.</span>, <span class="refAuthor">Green, M.</span>, <span class="refAuthor">Heninger, N.</span>, <span class="refAuthor">Weinmann, RP.</span>, <span class="refAuthor">Rescorla, E.</span>, and <span class="refAuthor">H. Shacham</span>, <span class="refTitle">"A Systematic Analysis of the Juniper Dual EC Incident"</span>, <span class="refContent">Proceedings of the 2016 ACM SIGSAC Conference on Computer and Communications Security</span>, <span class="seriesInfo">DOI 10.1145/2976749.2978395</span>, <time class="refDate" datetime="2016-10">October 2016</time>, <span>&lt;<a href="https://doi.org/10.1145/2976749.2978395">https://doi.org/10.1145/2976749.2978395</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="EFAIL">[EFAIL]</dt>
        <dd>
<span class="refAuthor">Poddebniak, D.</span>, <span class="refAuthor">Dresen, C.</span>, <span class="refAuthor">Müller, J.</span>, <span class="refAuthor">Ising, F.</span>, <span class="refAuthor">Schinzel, S.</span>, <span class="refAuthor">Friedberger, S.</span>, <span class="refAuthor">Somorovsky, J.</span>, and <span class="refAuthor">J. Schwenk</span>, <span class="refTitle">"Efail: Breaking S/MIME and OpenPGP Email Encryption using Exfiltration Channels"</span>, <span class="refContent">Proceedings of the 27th USENIX Security Symposium</span>, <time class="refDate" datetime="2018-08">August 2018</time>, <span>&lt;<a href="https://www.usenix.org/system/files/conference/usenixsecurity18/sec18-poddebniak.pdf">https://www.usenix.org/system/files/conference/usenixsecurity18/sec18-poddebniak.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Errata-2199">[Errata-2199]</dt>
        <dd>
<span class="refAuthor">RFC Errata</span>, <span class="refTitle">Erratum ID 2199</span>, <span class="refContent">RFC 4880</span>, <span>&lt;<a href="https://www.rfc-editor.org/errata/eid2199">https://www.rfc-editor.org/errata/eid2199</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Errata-2200">[Errata-2200]</dt>
        <dd>
<span class="refAuthor">RFC Errata</span>, <span class="refTitle">Erratum ID 2200</span>, <span class="refContent">RFC 4880</span>, <span>&lt;<a href="https://www.rfc-editor.org/errata/eid2200">https://www.rfc-editor.org/errata/eid2200</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Errata-2206">[Errata-2206]</dt>
        <dd>
<span class="refAuthor">RFC Errata</span>, <span class="refTitle">Erratum ID 2206</span>, <span class="refContent">RFC 4880</span>, <span>&lt;<a href="https://www.rfc-editor.org/errata/eid2206">https://www.rfc-editor.org/errata/eid2206</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Errata-2208">[Errata-2208]</dt>
        <dd>
<span class="refAuthor">RFC Errata</span>, <span class="refTitle">Erratum ID 2208</span>, <span class="refContent">RFC 4880</span>, <span>&lt;<a href="https://www.rfc-editor.org/errata/eid2208">https://www.rfc-editor.org/errata/eid2208</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Errata-2214">[Errata-2214]</dt>
        <dd>
<span class="refAuthor">RFC Errata</span>, <span class="refTitle">Erratum ID 2214</span>, <span class="refContent">RFC 4880</span>, <span>&lt;<a href="https://www.rfc-editor.org/errata/eid2214">https://www.rfc-editor.org/errata/eid2214</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Errata-2216">[Errata-2216]</dt>
        <dd>
<span class="refAuthor">RFC Errata</span>, <span class="refTitle">Erratum ID 2216</span>, <span class="refContent">RFC 4880</span>, <span>&lt;<a href="https://www.rfc-editor.org/errata/eid2216">https://www.rfc-editor.org/errata/eid2216</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Errata-2219">[Errata-2219]</dt>
        <dd>
<span class="refAuthor">RFC Errata</span>, <span class="refTitle">Erratum ID 2219</span>, <span class="refContent">RFC 4880</span>, <span>&lt;<a href="https://www.rfc-editor.org/errata/eid2219">https://www.rfc-editor.org/errata/eid2219</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Errata-2222">[Errata-2222]</dt>
        <dd>
<span class="refAuthor">RFC Errata</span>, <span class="refTitle">Erratum ID 2222</span>, <span class="refContent">RFC 4880</span>, <span>&lt;<a href="https://www.rfc-editor.org/errata/eid2222">https://www.rfc-editor.org/errata/eid2222</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Errata-2226">[Errata-2226]</dt>
        <dd>
<span class="refAuthor">RFC Errata</span>, <span class="refTitle">Erratum ID 2226</span>, <span class="refContent">RFC 4880</span>, <span>&lt;<a href="https://www.rfc-editor.org/errata/eid2226">https://www.rfc-editor.org/errata/eid2226</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Errata-2234">[Errata-2234]</dt>
        <dd>
<span class="refAuthor">RFC Errata</span>, <span class="refTitle">Erratum ID 2234</span>, <span class="refContent">RFC 4880</span>, <span>&lt;<a href="https://www.rfc-editor.org/errata/eid2234">https://www.rfc-editor.org/errata/eid2234</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Errata-2235">[Errata-2235]</dt>
        <dd>
<span class="refAuthor">RFC Errata</span>, <span class="refTitle">Erratum ID 2235</span>, <span class="refContent">RFC 4880</span>, <span>&lt;<a href="https://www.rfc-editor.org/errata/eid2235">https://www.rfc-editor.org/errata/eid2235</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Errata-2236">[Errata-2236]</dt>
        <dd>
<span class="refAuthor">RFC Errata</span>, <span class="refTitle">Erratum ID 2236</span>, <span class="refContent">RFC 4880</span>, <span>&lt;<a href="https://www.rfc-editor.org/errata/eid2236">https://www.rfc-editor.org/errata/eid2236</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Errata-2238">[Errata-2238]</dt>
        <dd>
<span class="refAuthor">RFC Errata</span>, <span class="refTitle">Erratum ID 2238</span>, <span class="refContent">RFC 4880</span>, <span>&lt;<a href="https://www.rfc-editor.org/errata/eid2238">https://www.rfc-editor.org/errata/eid2238</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Errata-2240">[Errata-2240]</dt>
        <dd>
<span class="refAuthor">RFC Errata</span>, <span class="refTitle">Erratum ID 2240</span>, <span class="refContent">RFC 4880</span>, <span>&lt;<a href="https://www.rfc-editor.org/errata/eid2240">https://www.rfc-editor.org/errata/eid2240</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Errata-2242">[Errata-2242]</dt>
        <dd>
<span class="refAuthor">RFC Errata</span>, <span class="refTitle">Erratum ID 2242</span>, <span class="refContent">RFC 4880</span>, <span>&lt;<a href="https://www.rfc-editor.org/errata/eid2242">https://www.rfc-editor.org/errata/eid2242</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Errata-2243">[Errata-2243]</dt>
        <dd>
<span class="refAuthor">RFC Errata</span>, <span class="refTitle">Erratum ID 2243</span>, <span class="refContent">RFC 4880</span>, <span>&lt;<a href="https://www.rfc-editor.org/errata/eid2243">https://www.rfc-editor.org/errata/eid2243</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Errata-2270">[Errata-2270]</dt>
        <dd>
<span class="refAuthor">RFC Errata</span>, <span class="refTitle">Erratum ID 2270</span>, <span class="refContent">RFC 4880</span>, <span>&lt;<a href="https://www.rfc-editor.org/errata/eid2270">https://www.rfc-editor.org/errata/eid2270</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Errata-2271">[Errata-2271]</dt>
        <dd>
<span class="refAuthor">RFC Errata</span>, <span class="refTitle">Erratum ID 2271</span>, <span class="refContent">RFC 4880</span>, <span>&lt;<a href="https://www.rfc-editor.org/errata/eid2271">https://www.rfc-editor.org/errata/eid2271</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Errata-3298">[Errata-3298]</dt>
        <dd>
<span class="refAuthor">RFC Errata</span>, <span class="refTitle">Erratum ID 3298</span>, <span class="refContent">RFC 4880</span>, <span>&lt;<a href="https://www.rfc-editor.org/errata/eid3298">https://www.rfc-editor.org/errata/eid3298</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Errata-5491">[Errata-5491]</dt>
        <dd>
<span class="refAuthor">RFC Errata</span>, <span class="refTitle">Erratum ID 5491</span>, <span class="refContent">RFC 4880</span>, <span>&lt;<a href="https://www.rfc-editor.org/errata/eid5491">https://www.rfc-editor.org/errata/eid5491</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Errata-7545">[Errata-7545]</dt>
        <dd>
<span class="refAuthor">RFC Errata</span>, <span class="refTitle">Erratum ID 7545</span>, <span class="refContent">RFC 4880</span>, <span>&lt;<a href="https://www.rfc-editor.org/errata/eid7545">https://www.rfc-editor.org/errata/eid7545</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Errata-7889">[Errata-7889]</dt>
        <dd>
<span class="refAuthor">RFC Errata</span>, <span class="refTitle">Erratum ID 7889</span>, <span class="refContent">RFC 4880</span>, <span>&lt;<a href="https://www.rfc-editor.org/errata/eid7889">https://www.rfc-editor.org/errata/eid7889</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="HASTAD">[HASTAD]</dt>
        <dd>
<span class="refAuthor">Hastad, J.</span>, <span class="refTitle">"Solving Simultaneous Modular Equations of Low Degree"</span>, <span class="seriesInfo">DOI 10.1137/0217019</span>, <time class="refDate" datetime="1988-04">April 1988</time>, <span>&lt;<a href="https://doi.org/10.1137/0217019">https://doi.org/10.1137/0217019</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="JKS02">[JKS02]</dt>
        <dd>
<span class="refAuthor">Jallad, K.</span>, <span class="refAuthor">Katz, J.</span>, and <span class="refAuthor">B. Schneier</span>, <span class="refTitle">"Implementation of Chosen-Ciphertext Attacks against PGP and GnuPG"</span>, <span class="seriesInfo">DOI 0.1007/3-540-45811-5_7</span>, <time class="refDate" datetime="2002-09">September 2002</time>, <span>&lt;<a href="https://www.schneier.com/academic/archives/2002/01/implementation_of_ch.html">https://www.schneier.com/academic/archives/2002/01/implementation_of_ch.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="KOBLITZ">[KOBLITZ]</dt>
        <dd>
<span class="refAuthor">Koblitz, N.</span>, <span class="refTitle">"A course in number theory and cryptography"</span>, <span class="refContent">Chapter VI: Elliptic Curves</span>, <span class="seriesInfo">DOI 10.2307/3618498</span>, <time class="refDate" datetime="1997">1997</time>, <span>&lt;<a href="https://doi.org/10.2307/3618498">https://doi.org/10.2307/3618498</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="KOPENPGP">[KOPENPGP]</dt>
        <dd>
<span class="refAuthor">Bruseghini, L.</span>, <span class="refAuthor">Paterson, K. G.</span>, and <span class="refAuthor">D. Huigens</span>, <span class="refTitle">"Victory by KO: Attacking OpenPGP Using Key Overwriting"</span>, <span class="refContent">Proceedings of the ACM SIGSAC Conference on Computer and Communications Security, pp. 411-423</span>, <span class="seriesInfo">DOI 10.1145/3548606.3559363</span>, <time class="refDate" datetime="2022-11">November 2022</time>, <span>&lt;<a href="https://dl.acm.org/doi/10.1145/3548606.3559363">https://dl.acm.org/doi/10.1145/3548606.3559363</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="KR02">[KR02]</dt>
        <dd>
<span class="refAuthor">Klíma, V.</span> and <span class="refAuthor">T. Rosa</span>, <span class="refTitle">"Attack on Private Signature Keys of the OpenPGP Format, PGP(TM) Programs and Other Applications Compatible with OpenPGP"</span>, <span class="refContent">Cryptology ePrint Archive, Paper 2002/076</span>, <time class="refDate" datetime="2001-03">March 2001</time>, <span>&lt;<a href="https://eprint.iacr.org/2002/076">https://eprint.iacr.org/2002/076</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="MRLG15">[MRLG15]</dt>
        <dd>
<span class="refAuthor">Maury, F.</span>, <span class="refAuthor">Reinhard, JR.</span>, <span class="refAuthor">Levillain, O.</span>, and <span class="refAuthor">H. Gilbert</span>, <span class="refTitle">"Format Oracles on OpenPGP"</span>, <span class="refContent">Topics in Cryptology -- CT-RSA 2015, Vol. 9048, pp. 220-236</span>, <span class="seriesInfo">DOI 10.1007/978-3-319-16715-2_12</span>, <time class="refDate" datetime="2015-01">January 2015</time>, <span>&lt;<a href="https://doi.org/10.1007/978-3-319-16715-2_12">https://doi.org/10.1007/978-3-319-16715-2_12</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="MZ05">[MZ05]</dt>
        <dd>
<span class="refAuthor">Mister, S.</span> and <span class="refAuthor">R. Zuccherato</span>, <span class="refTitle">"An Attack on CFB Mode Encryption As Used By OpenPGP"</span>, <span class="refContent">Cryptology ePrint Archive, Paper 2005/033</span>, <time class="refDate" datetime="2005-02">February 2005</time>, <span>&lt;<a href="http://eprint.iacr.org/2005/033">http://eprint.iacr.org/2005/033</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="OPENPGPCARD">[OPENPGPCARD]</dt>
        <dd>
<span class="refAuthor">Pietig, A.</span>, <span class="refTitle">"Functional Specification of the OpenPGP application on ISO Smart Card Operating Systems"</span>, <span class="refContent">Version 3.4.1</span>, <time class="refDate" datetime="2020-03">March 2020</time>, <span>&lt;<a href="https://gnupg.org/ftp/specs/OpenPGP-smart-card-application-3.4.1.pdf">https://gnupg.org/ftp/specs/OpenPGP-smart-card-application-3.4.1.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="PAX">[PAX]</dt>
        <dd>
<span class="refAuthor">The Open Group</span>, <span class="refTitle">"The Open Group Base Specifications"</span>, <span class="refContent">'pax - portable archive interchange', Issue 7, 2018 Edition </span>, <span class="seriesInfo">IEEE Std 1003.1-2017</span>, <time class="refDate" datetime="2018">2018</time>, <span>&lt;<a href="https://pubs.opengroup.org/onlinepubs/9699919799/utilities/pax.html">https://pubs.opengroup.org/onlinepubs/9699919799/utilities/pax.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="PSSLR17">[PSSLR17]</dt>
        <dd>
<span class="refAuthor">Poddebniak, D.</span>, <span class="refAuthor">Somorovsky, J.</span>, <span class="refAuthor">Schinzel, S.</span>, <span class="refAuthor">Lochter, M.</span>, and <span class="refAuthor">P. Rösler</span>, <span class="refTitle">"Attacking Deterministic Signature Schemes using Fault Attacks"</span>, <span class="refContent">Cryptology ePrint Archive, Paper 2017/1014 </span>, <time class="refDate" datetime="2017-10">October 2017</time>, <span>&lt;<a href="https://eprint.iacr.org/2017/1014">https://eprint.iacr.org/2017/1014</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="REGEX">[REGEX]</dt>
        <dd>
<span class="refAuthor">regex</span>, <span class="refTitle">"Henry Spencer's regular expression libraries"</span>, <span>&lt;<a href="https://garyhouston.github.io/regex/">https://garyhouston.github.io/regex/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1991">[RFC1991]</dt>
        <dd>
<span class="refAuthor">Atkins, D.</span>, <span class="refAuthor">Stallings, W.</span>, and <span class="refAuthor">P. Zimmermann</span>, <span class="refTitle">"PGP Message Exchange Formats"</span>, <span class="seriesInfo">RFC 1991</span>, <span class="seriesInfo">DOI 10.17487/RFC1991</span>, <time class="refDate" datetime="1996-08">August 1996</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1991">https://www.rfc-editor.org/info/rfc1991</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2440">[RFC2440]</dt>
        <dd>
<span class="refAuthor">Callas, J.</span>, <span class="refAuthor">Donnerhacke, L.</span>, <span class="refAuthor">Finney, H.</span>, and <span class="refAuthor">R. Thayer</span>, <span class="refTitle">"OpenPGP Message Format"</span>, <span class="seriesInfo">RFC 2440</span>, <span class="seriesInfo">DOI 10.17487/RFC2440</span>, <time class="refDate" datetime="1998-11">November 1998</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2440">https://www.rfc-editor.org/info/rfc2440</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2978">[RFC2978]</dt>
        <dd>
<span class="refAuthor">Freed, N.</span> and <span class="refAuthor">J. Postel</span>, <span class="refTitle">"IANA Charset Registration Procedures"</span>, <span class="seriesInfo">BCP 19</span>, <span class="seriesInfo">RFC 2978</span>, <span class="seriesInfo">DOI 10.17487/RFC2978</span>, <time class="refDate" datetime="2000-10">October 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2978">https://www.rfc-editor.org/info/rfc2978</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4880">[RFC4880]</dt>
        <dd>
<span class="refAuthor">Callas, J.</span>, <span class="refAuthor">Donnerhacke, L.</span>, <span class="refAuthor">Finney, H.</span>, <span class="refAuthor">Shaw, D.</span>, and <span class="refAuthor">R. Thayer</span>, <span class="refTitle">"OpenPGP Message Format"</span>, <span class="seriesInfo">RFC 4880</span>, <span class="seriesInfo">DOI 10.17487/RFC4880</span>, <time class="refDate" datetime="2007-11">November 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4880">https://www.rfc-editor.org/info/rfc4880</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5581">[RFC5581]</dt>
        <dd>
<span class="refAuthor">Shaw, D.</span>, <span class="refTitle">"The Camellia Cipher in OpenPGP"</span>, <span class="seriesInfo">RFC 5581</span>, <span class="seriesInfo">DOI 10.17487/RFC5581</span>, <time class="refDate" datetime="2009-06">June 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5581">https://www.rfc-editor.org/info/rfc5581</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5639">[RFC5639]</dt>
        <dd>
<span class="refAuthor">Lochter, M.</span> and <span class="refAuthor">J. Merkle</span>, <span class="refTitle">"Elliptic Curve Cryptography (ECC) Brainpool Standard Curves and Curve Generation"</span>, <span class="seriesInfo">RFC 5639</span>, <span class="seriesInfo">DOI 10.17487/RFC5639</span>, <time class="refDate" datetime="2010-03">March 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5639">https://www.rfc-editor.org/info/rfc5639</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5869">[RFC5869]</dt>
        <dd>
<span class="refAuthor">Krawczyk, H.</span> and <span class="refAuthor">P. Eronen</span>, <span class="refTitle">"HMAC-based Extract-and-Expand Key Derivation Function (HKDF)"</span>, <span class="seriesInfo">RFC 5869</span>, <span class="seriesInfo">DOI 10.17487/RFC5869</span>, <time class="refDate" datetime="2010-05">May 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5869">https://www.rfc-editor.org/info/rfc5869</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6090">[RFC6090]</dt>
        <dd>
<span class="refAuthor">McGrew, D.</span>, <span class="refAuthor">Igoe, K.</span>, and <span class="refAuthor">M. Salter</span>, <span class="refTitle">"Fundamental Elliptic Curve Cryptography Algorithms"</span>, <span class="seriesInfo">RFC 6090</span>, <span class="seriesInfo">DOI 10.17487/RFC6090</span>, <time class="refDate" datetime="2011-02">February 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6090">https://www.rfc-editor.org/info/rfc6090</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6637">[RFC6637]</dt>
        <dd>
<span class="refAuthor">Jivsov, A.</span>, <span class="refTitle">"Elliptic Curve Cryptography (ECC) in OpenPGP"</span>, <span class="seriesInfo">RFC 6637</span>, <span class="seriesInfo">DOI 10.17487/RFC6637</span>, <time class="refDate" datetime="2012-06">June 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6637">https://www.rfc-editor.org/info/rfc6637</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SEC1">[SEC1]</dt>
        <dd>
<span class="refAuthor">Standards for Efficient Cryptography Group</span>, <span class="refTitle">"SEC 1: Elliptic Curve Cryptography"</span>, <span class="refContent"></span>, <time class="refDate" datetime="2009-05">May 2009</time>, <span>&lt;<a href="https://www.secg.org/sec1-v2.pdf">https://www.secg.org/sec1-v2.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SHA1CD">[SHA1CD]</dt>
        <dd>
<span class="refTitle">"sha1collisiondetection"</span>, <span class="refContent">commit b4a7b0b</span>, <time class="refDate" datetime="2020-12">December 2020</time>, <span>&lt;<a href="https://github.com/cr-marcstevens/sha1collisiondetection">https://github.com/cr-marcstevens/sha1collisiondetection</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SHAMBLES">[SHAMBLES]</dt>
        <dd>
<span class="refAuthor">Leurent, G.</span> and <span class="refAuthor">T. Peyrin</span>, <span class="refTitle">"Sha-1 is a shambles: first chosen-prefix collision on sha-1 and application to the PGP web of trust"</span>, <time class="refDate" datetime="2020-08">August 2020</time>, <span>&lt;<a href="https://dl.acm.org/doi/abs/10.5555/3489212.3489316/">https://dl.acm.org/doi/abs/10.5555/3489212.3489316/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SP800-131A">[SP800-131A]</dt>
        <dd>
<span class="refAuthor">NIST</span>, <span class="refTitle">"Transitioning the Use of Cryptographic Algorithms and Key Lengths"</span>, <span class="seriesInfo">NIST Special Publication 800-131A, Revision 2</span>, <span class="seriesInfo">DOI 10.6028/NIST.SP.800-131Ar2</span>, <time class="refDate" datetime="2019-03">March 2019</time>, <span>&lt;<a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-131Ar2.pdf">https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-131Ar2.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SP800-57">[SP800-57]</dt>
        <dd>
<span class="refAuthor">NIST</span>, <span class="refTitle">"Recommendation for Key Management: Part 1 - General"</span>, <span class="seriesInfo">NIST Special Publication 800-57 Part 1, Revision 5</span>, <span class="seriesInfo">DOI 10.6028/NIST.SP.800-57pt1r5</span>, <time class="refDate" datetime="2020-05">May 2020</time>, <span>&lt;<a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-57pt1r5.pdf">https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-57pt1r5.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="STEVENS2013">[STEVENS2013]</dt>
        <dd>
<span class="refAuthor">Stevens, M.</span>, <span class="refTitle">"Counter-cryptanalysis"</span>, <span class="refContent">Cryptology ePrint Archive, Paper 2013/358</span>, <time class="refDate" datetime="2013-06">June 2013</time>, <span>&lt;<a href="https://eprint.iacr.org/2013/358">https://eprint.iacr.org/2013/358</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="UNIFIED-DIFF">[UNIFIED-DIFF]</dt>
        <dd>
<span class="refAuthor">Free Software Foundation</span>, <span class="refTitle">"Comparing and Merging Files"</span>, <span class="refContent">'Detailed Description of Unified Format', Section 2.2.2.2</span>, <time class="refDate" datetime="2021-01">January 2021</time>, <span>&lt;<a href="https://www.gnu.org/software/diffutils/manual/html_node/Detailed-Unified.html">https://www.gnu.org/software/diffutils/manual/html_node/Detailed-Unified.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="USENIX-STUDY">[USENIX-STUDY]</dt>
      <dd>
<span class="refAuthor">Dechand, S.</span>, <span class="refAuthor">Schürmann, D.</span>, <span class="refAuthor">Busse, K.</span>, <span class="refAuthor">Acar, Y.</span>, <span class="refAuthor">Fahl, S.</span>, and <span class="refAuthor">M. Smith</span>, <span class="refTitle">"An Empirical Study of Textual Key-Fingerprint Representations"</span>, <span class="seriesInfo">ISBN 978-1-931971-32-4</span>, <time class="refDate" datetime="2016-08">August 2016</time>, <span>&lt;<a href="https://www.usenix.org/system/files/conference/usenixsecurity16/sec16_paper_dechand.pdf">https://www.usenix.org/system/files/conference/usenixsecurity16/sec16_paper_dechand.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="test-vectors">
<section id="appendix-A">
      <h2 id="name-test-vectors">
<a class="section-number selfRef" href="#appendix-A">Appendix A. </a><a class="section-name selfRef" href="#name-test-vectors">Test Vectors</a>
      </h2>
<p id="appendix-A-1">To help with the implementation of this specification, a set of non-normative examples follow.<a class="pilcrow" href="#appendix-A-1">¶</a></p>
<div id="sample-v4-ed25519legacy-key">
<section id="appendix-A.1">
        <h3 id="name-sample-version-4-ed25519leg">
<a class="section-number selfRef" href="#appendix-A.1">A.1. </a><a class="section-name selfRef" href="#name-sample-version-4-ed25519leg">Sample Version 4 Ed25519Legacy Key</a>
        </h3>
<p id="appendix-A.1-1">The secret key used for this example is:<a class="pilcrow" href="#appendix-A.1-1">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.1-2">
<pre>D: 1a8b1ff05ded48e18bf50166c664ab023ea70003d78d9e41f5758a91d850f8d2
</pre><a class="pilcrow" href="#appendix-A.1-2">¶</a>
</div>
<p id="appendix-A.1-3">Note that this is the raw secret key used as input to the EdDSA signing operation.
The key was created on 2014-08-19 14:28:27 and thus the fingerprint of the OpenPGP Key is:<a class="pilcrow" href="#appendix-A.1-3">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.1-4">
<pre>   C959 BDBA FA32 A2F8 9A15  3B67 8CFD E121 9796 5A9A
</pre><a class="pilcrow" href="#appendix-A.1-4">¶</a>
</div>
<p id="appendix-A.1-5">The algorithm-specific input parameters without the MPI length headers are:<a class="pilcrow" href="#appendix-A.1-5">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.1-6">
<pre>oid: 2b06010401da470f01

q: 403f098994bdd916ed4053197934e4a87c80733a1280d62f8010992e43ee3b2406
</pre><a class="pilcrow" href="#appendix-A.1-6">¶</a>
</div>
<p id="appendix-A.1-7">The entire Public Key packet is thus:<a class="pilcrow" href="#appendix-A.1-7">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.1-8">
<pre>   98 33 04 53 f3 5f 0b 16  09 2b 06 01 04 01 da 47
   0f 01 01 07 40 3f 09 89  94 bd d9 16 ed 40 53 19
   79 34 e4 a8 7c 80 73 3a  12 80 d6 2f 80 10 99 2e
   43 ee 3b 24 06
</pre><a class="pilcrow" href="#appendix-A.1-8">¶</a>
</div>
<p id="appendix-A.1-9">The same packet represented in ASCII-armored form is:<a class="pilcrow" href="#appendix-A.1-9">¶</a></p>
<div class="lang-application/pgp-keys sourcecode" id="appendix-A.1-10">
<pre>-----BEGIN PGP PUBLIC KEY BLOCK-----

xjMEU/NfCxYJKwYBBAHaRw8BAQdAPwmJlL3ZFu1AUxl5NOSofIBzOhKA1i+AEJku
Q+47JAY=
-----END PGP PUBLIC KEY BLOCK-----
</pre><a class="pilcrow" href="#appendix-A.1-10">¶</a>
</div>
</section>
</div>
<div id="sample-v4-ed25519legacy-signature">
<section id="appendix-A.2">
        <h3 id="name-sample-version-4-ed25519lega">
<a class="section-number selfRef" href="#appendix-A.2">A.2. </a><a class="section-name selfRef" href="#name-sample-version-4-ed25519lega">Sample Version 4 Ed25519Legacy Signature</a>
        </h3>
<p id="appendix-A.2-1">The signature is created using the sample key over the input data "OpenPGP" on 2015-09-16 12:24:53 UTC and thus the input to the hash function is:<a class="pilcrow" href="#appendix-A.2-1">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.2-2">
<pre>m: 4f70656e504750040016080006050255f95f9504ff0000000c
</pre><a class="pilcrow" href="#appendix-A.2-2">¶</a>
</div>
<p id="appendix-A.2-3">Using the SHA2-256 hash algorithm yields the digest:<a class="pilcrow" href="#appendix-A.2-3">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.2-4">
<pre>d: f6220a3f757814f4c2176ffbb68b00249cd4ccdc059c4b34ad871f30b1740280
</pre><a class="pilcrow" href="#appendix-A.2-4">¶</a>
</div>
<p id="appendix-A.2-5">which is fed into the EdDSA signature function and yields the following signature:<a class="pilcrow" href="#appendix-A.2-5">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.2-6">
<pre>r: 56f90cca98e2102637bd983fdb16c131dfd27ed82bf4dde5606e0d756aed3366

s: d09c4fa11527f038e0f57f2201d82f2ea2c9033265fa6ceb489e854bae61b404
</pre><a class="pilcrow" href="#appendix-A.2-6">¶</a>
</div>
<p id="appendix-A.2-7">The entire Signature packet is thus:<a class="pilcrow" href="#appendix-A.2-7">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.2-8">
<pre>   88 5e 04 00 16 08 00 06  05 02 55 f9 5f 95 00 0a
   09 10 8c fd e1 21 97 96  5a 9a f6 22 00 ff 56 f9
   0c ca 98 e2 10 26 37 bd  98 3f db 16 c1 31 df d2
   7e d8 2b f4 dd e5 60 6e  0d 75 6a ed 33 66 01 00
   d0 9c 4f a1 15 27 f0 38  e0 f5 7f 22 01 d8 2f 2e
   a2 c9 03 32 65 fa 6c eb  48 9e 85 4b ae 61 b4 04
</pre><a class="pilcrow" href="#appendix-A.2-8">¶</a>
</div>
<p id="appendix-A.2-9">The same packet represented in ASCII-armored form is:<a class="pilcrow" href="#appendix-A.2-9">¶</a></p>
<div class="lang-application/pgp-signature sourcecode" id="appendix-A.2-10">
<pre>-----BEGIN PGP SIGNATURE-----

iF4EABYIAAYFAlX5X5UACgkQjP3hIZeWWpr2IgD/VvkMypjiECY3vZg/2xbBMd/S
ftgr9N3lYG4NdWrtM2YBANCcT6EVJ/A44PV/IgHYLy6iyQMyZfps60iehUuuYbQE
-----END PGP SIGNATURE-----
</pre><a class="pilcrow" href="#appendix-A.2-10">¶</a>
</div>
</section>
</div>
<div id="v6-cert">
<section id="appendix-A.3">
        <h3 id="name-sample-version-6-certificat">
<a class="section-number selfRef" href="#appendix-A.3">A.3. </a><a class="section-name selfRef" href="#name-sample-version-6-certificat">Sample Version 6 Certificate (Transferable Public Key)</a>
        </h3>
<p id="appendix-A.3-1">Here is a Transferable Public Key consisting of:<a class="pilcrow" href="#appendix-A.3-1">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A.3-2.1">
            <p id="appendix-A.3-2.1.1">A version 6 Ed25519 Public Key packet<a class="pilcrow" href="#appendix-A.3-2.1.1">¶</a></p>
</li>
          <li class="normal" id="appendix-A.3-2.2">
            <p id="appendix-A.3-2.2.1">A version 6 Direct Key self-signature<a class="pilcrow" href="#appendix-A.3-2.2.1">¶</a></p>
</li>
          <li class="normal" id="appendix-A.3-2.3">
            <p id="appendix-A.3-2.3.1">A version 6 X25519 Public Subkey packet<a class="pilcrow" href="#appendix-A.3-2.3.1">¶</a></p>
</li>
          <li class="normal" id="appendix-A.3-2.4">
            <p id="appendix-A.3-2.4.1">A version 6 Subkey Binding signature<a class="pilcrow" href="#appendix-A.3-2.4.1">¶</a></p>
</li>
        </ul>
<p id="appendix-A.3-3">The primary key has the following fingerprint:<a class="pilcrow" href="#appendix-A.3-3">¶</a></p>
<p id="appendix-A.3-4"><code>CB186C4F0609A697E4D52DFA6C722B0C1F1E27C18A56708F6525EC27BAD9ACC9</code><a class="pilcrow" href="#appendix-A.3-4">¶</a></p>
<p id="appendix-A.3-5">The subkey has the following fingerprint:<a class="pilcrow" href="#appendix-A.3-5">¶</a></p>
<p id="appendix-A.3-6"><code>12C83F1E706F6308FE151A417743A1F033790E93E9978488D1DB378DA9930885</code><a class="pilcrow" href="#appendix-A.3-6">¶</a></p>
<div class="lang-application/pgp-keys sourcecode" id="appendix-A.3-7">
<pre>-----BEGIN PGP PUBLIC KEY BLOCK-----

xioGY4d/4xsAAAAg+U2nu0jWCmHlZ3BqZYfQMxmZu52JGggkLq2EVD34laPCsQYf
GwoAAABCBYJjh3/jAwsJBwUVCg4IDAIWAAKbAwIeCSIhBssYbE8GCaaX5NUt+mxy
KwwfHifBilZwj2Ul7Ce62azJBScJAgcCAAAAAK0oIBA+LX0ifsDm185Ecds2v8lw
gyU2kCcUmKfvBXbAf6rhRYWzuQOwEn7E/aLwIwRaLsdry0+VcallHhSu4RN6HWaE
QsiPlR4zxP/TP7mhfVEe7XWPxtnMUMtf15OyA51YBM4qBmOHf+MZAAAAIIaTJINn
+eUBXbki+PSAld2nhJh/LVmFsS+60WyvXkQ1wpsGGBsKAAAALAWCY4d/4wKbDCIh
BssYbE8GCaaX5NUt+mxyKwwfHifBilZwj2Ul7Ce62azJAAAAAAQBIKbpGG2dWTX8
j+VjFM21J0hqWlEg+bdiojWnKfA5AQpWUWtnNwDEM0g12vYxoWM8Y81W+bHBw805
I8kWVkXU6vFOi+HWvv/ira7ofJu16NnoUkhclkUrk0mXubZvyl4GBg==
-----END PGP PUBLIC KEY BLOCK-----
</pre><a class="pilcrow" href="#appendix-A.3-7">¶</a>
</div>
<p id="appendix-A.3-8">The corresponding Transferable Secret Key can be found in <a class="auto internal xref" href="#v6-key">Appendix A.4</a>.<a class="pilcrow" href="#appendix-A.3-8">¶</a></p>
<div id="sig-hashed-data-example">
<section id="appendix-A.3.1">
          <h4 id="name-hashed-data-stream-for-sign">
<a class="section-number selfRef" href="#appendix-A.3.1">A.3.1. </a><a class="section-name selfRef" href="#name-hashed-data-stream-for-sign">Hashed Data Stream for Signature Verification</a>
          </h4>
<p id="appendix-A.3.1-1">The Direct Key self-signature in the certificate in <a class="auto internal xref" href="#v6-cert">Appendix A.3</a> is made over the following sequence of data:<a class="pilcrow" href="#appendix-A.3.1-1">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.3.1-2">
<pre>0x0000  10 3e 2d 7d 22 7e c0 e6
0x0008  d7 ce 44 71 db 36 bf c9
0x0010  70 83 25 36 90 27 14 98
0x0018  a7 ef 05 76 c0 7f aa e1
0x0020  9b 00 00 00 2a 06 63 87
0x0028  7f e3 1b 00 00 00 20 f9
0x0030  4d a7 bb 48 d6 0a 61 e5
0x0038  67 70 6a 65 87 d0 33 19
0x0040  99 bb 9d 89 1a 08 24 2e
0x0048  ad 84 54 3d f8 95 a3 06
0x0050  1f 1b 0a 00 00 00 42 05
0x0058  82 63 87 7f e3 03 0b 09
0x0060  07 05 15 0a 0e 08 0c 02
0x0068  16 00 02 9b 03 02 1e 09
0x0070  22 21 06 cb 18 6c 4f 06
0x0078  09 a6 97 e4 d5 2d fa 6c
0x0080  72 2b 0c 1f 1e 27 c1 8a
0x0088  56 70 8f 65 25 ec 27 ba
0x0090  d9 ac c9 05 27 09 02 07
0x0098  02 06 ff 00 00 00 4a
</pre><a class="pilcrow" href="#appendix-A.3.1-2">¶</a>
</div>
<p id="appendix-A.3.1-3">The same data, broken out by octet and semantics, is:<a class="pilcrow" href="#appendix-A.3.1-3">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.3.1-4">
<pre>0x0000  10 3e 2d 7d 22 7e c0 e6  salt
0x0008  d7 ce 44 71 db 36 bf c9
0x0010  70 83 25 36 90 27 14 98
0x0018  a7 ef 05 76 c0 7f aa e1
        [ pubkey begins ]
0x0020  9b                       key packet
0x0021     00 00 00 2a           pubkey length
0x0025                 06        pubkey version
0x0026                    63 87  creation time
0x0028  7f e3                      (2022-11-30T16:08:03Z)
0x002a        1b                 key algo: Ed25519
0x002b           00 00 00 20     key length
0x002f                       f9  Ed25519 public key
0x0030  4d a7 bb 48 d6 0a 61 e5
0x0038  67 70 6a 65 87 d0 33 19
0x0040  99 bb 9d 89 1a 08 24 2e
0x0048  ad 84 54 3d f8 95 a3
         [ trailer begins ]
0x004f                       06  sig version 6
0x0050  1f                       sig type: Direct Key signature
0x0051     1b                    sig algo: Ed25519
0x0052        0a                 hash ago: SHA2-512
0x0053           00 00 00 42     hashed subpackets length
0x0057                       05  subpkt length
0x0058  82                       critical subpkt: Sig Creation Time
0x0059     63 87 7f e3           Signature Creation Time
0x005d                 03        subpkt length
0x005e                    0b     subpkt type: Pref. v1 SEIPD Ciphers
0x005f                       09  Ciphers: [AES256 AES128]
0x0060  07
0x0061     05                    subpkt length
0x0062        15                 subpkt type: Pref. Hash Algorithms
0x0063           0a 0e           Hashes: [SHA2-512 SHA3-512
0x0065                 08 0c              SHA2-256 SHA3-256]
0x0067                       02  subpkt length
0x0068  16                       subpkt type: Pref. Compression
0x0069     00                    Compression: [none]
0x006a        02                 subpkt length
0x006b           9b              critical subpkt: Key Flags
0x006c              03           Key Flags: {certify, sign}
0x006d                 02        subpkt length
0x006e                    1e     subpkt type: Features
0x006f                       09  Features: {v1SEIPD, v2SEIPD}
0x0070  22                       subpkt length
0x0071     21                    subpkt type: Issuer Fingerprint
0x0072        06                 Fingerprint version 6
0x0073           cb 18 6c 4f 06  Fingerprint
0x0078  09 a6 97 e4 d5 2d fa 6c
0x0080  72 2b 0c 1f 1e 27 c1 8a
0x0088  56 70 8f 65 25 ec 27 ba
0x0090  d9 ac c9
0x0093           05              subpkt length
0x0094              27           subpkt type: Pref. AEAD Ciphersuites
0x0095                 09 02 07  Ciphersuites:
0x0098  02                         [ AES256-OCB, AES128-OCB ]
0x0099     06                    sig version 6
0x009a        ff                 sentinel octet
0x009b           00 00 00 4a     trailer length
</pre><a class="pilcrow" href="#appendix-A.3.1-4">¶</a>
</div>
<p id="appendix-A.3.1-5">The Subkey Binding signature in <a class="auto internal xref" href="#v6-cert">Appendix A.3</a> is made over the following sequence of data:<a class="pilcrow" href="#appendix-A.3.1-5">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.3.1-6">
<pre>0x0000  a6 e9 18 6d 9d 59 35 fc
0x0008  8f e5 63 14 cd b5 27 48
0x0010  6a 5a 51 20 f9 b7 62 a2
0x0018  35 a7 29 f0 39 01 0a 56
0x0020  9b 00 00 00 2a 06 63 87
0x0028  7f e3 1b 00 00 00 20 f9
0x0030  4d a7 bb 48 d6 0a 61 e5
0x0038  67 70 6a 65 87 d0 33 19
0x0040  99 bb 9d 89 1a 08 24 2e
0x0048  ad 84 54 3d f8 95 a3 9b
0x0050  00 00 00 2a 06 63 87 7f
0x0058  e3 19 00 00 00 20 86 93
0x0060  24 83 67 f9 e5 01 5d b9
0x0068  22 f8 f4 80 95 dd a7 84
0x0070  98 7f 2d 59 85 b1 2f ba
0x0078  d1 6c af 5e 44 35 06 18
0x0080  1b 0a 00 00 00 2c 05 82
0x0088  63 87 7f e3 02 9b 0c 22
0x0090  21 06 cb 18 6c 4f 06 09
0x0098  a6 97 e4 d5 2d fa 6c 72
0x00a0  2b 0c 1f 1e 27 c1 8a 56
0x00a8  70 8f 65 25 ec 27 ba d9
0x00b0  ac c9 06 ff 00 00 00 34
</pre><a class="pilcrow" href="#appendix-A.3.1-6">¶</a>
</div>
<p id="appendix-A.3.1-7">The same data, broken out by octet and semantics, is:<a class="pilcrow" href="#appendix-A.3.1-7">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.3.1-8">
<pre>0x0000  a6 e9 18 6d 9d 59 35 fc  salt
0x0008  8f e5 63 14 cd b5 27 48
0x0010  6a 5a 51 20 f9 b7 62 a2
0x0018  35 a7 29 f0 39 01 0a 56
      [ primary pubkey begins ]
0x0020  9b                       key packet
0x0021     00 00 00 2a           pubkey length
0x0025                 06        pubkey version
0x0026                    63 87  creation time
0x0028  7f e3                      (2022-11-30T16:08:03Z)
0x002a        1b                 key algo: Ed25519
0x002b           00 00 00 20     key length
0x002f                       f9  Ed25519 public key
0x0030  4d a7 bb 48 d6 0a 61 e5
0x0038  67 70 6a 65 87 d0 33 19
0x0040  99 bb 9d 89 1a 08 24 2e
0x0048  ad 84 54 3d f8 95 a3
      [ subkey pubkey begins ]
0x004f                       9b  key packet
0x0050  00 00 00 2a              pubkey length
0x0054              06           pubkey version
0x0055                 63 87 7f  creation time (2022-11-30T16:08:03Z)
0x0058  e3
0x0059     19                    key algo: X25519
0x005a        00 00 00 20        key length
0x005e                    86 93  X25519 public key
0x0060  24 83 67 f9 e5 01 5d b9
0x0068  22 f8 f4 80 95 dd a7 84
0x0070  98 7f 2d 59 85 b1 2f ba
0x0078  d1 6c af 5e 44 35
       [ trailer begins ]
0x007e                    06     sig version 6
0x007f                       18  sig type: Subkey Binding sig
0x0080  1b                       sig algo Ed25519
0x0081     0a                    hash algo: SHA2-512
0x0082        00 00 00 2c        hashed subpackets length
0x0086                    05     subpkt length
0x0087                       82  critical subpkt: Sig Creation Time
0x0088  63 87 7f e3              Signature Creation Time
0x008c              02           subpkt length
0x008d                 9b        critical subpkt: Key Flags
0x008e                    0c     Key Flags: {EncComms, EncStorage}
0x008f                       22  subpkt length
0x0090  21                       subpkt type: Issuer Fingerprint
0x0091     06                    Fingerprint version 6
0x0092        cb 18 6c 4f 06 09  Fingerprint
0x0098  a6 97 e4 d5 2d fa 6c 72
0x00a0  2b 0c 1f 1e 27 c1 8a 56
0x00a8  70 8f 65 25 ec 27 ba d9
0x00b0  ac c9
0x00b2        06                 sig version 6
0x00b3           ff              sentinel octet
0x00b4              00 00 00 34  trailer length
</pre><a class="pilcrow" href="#appendix-A.3.1-8">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="v6-key">
<section id="appendix-A.4">
        <h3 id="name-sample-version-6-secret-key">
<a class="section-number selfRef" href="#appendix-A.4">A.4. </a><a class="section-name selfRef" href="#name-sample-version-6-secret-key">Sample Version 6 Secret Key (Transferable Secret Key)</a>
        </h3>
<p id="appendix-A.4-1">Here is a Transferable Secret Key consisting of:<a class="pilcrow" href="#appendix-A.4-1">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A.4-2.1">
            <p id="appendix-A.4-2.1.1">A version 6 Ed25519 Secret Key packet<a class="pilcrow" href="#appendix-A.4-2.1.1">¶</a></p>
</li>
          <li class="normal" id="appendix-A.4-2.2">
            <p id="appendix-A.4-2.2.1">A version 6 Direct Key self-signature<a class="pilcrow" href="#appendix-A.4-2.2.1">¶</a></p>
</li>
          <li class="normal" id="appendix-A.4-2.3">
            <p id="appendix-A.4-2.3.1">A version 6 X25519 Secret Subkey packet<a class="pilcrow" href="#appendix-A.4-2.3.1">¶</a></p>
</li>
          <li class="normal" id="appendix-A.4-2.4">
            <p id="appendix-A.4-2.4.1">A version 6 Subkey Binding signature<a class="pilcrow" href="#appendix-A.4-2.4.1">¶</a></p>
</li>
        </ul>
<div class="lang-application/pgp-keys sourcecode" id="appendix-A.4-3">
<pre>-----BEGIN PGP PRIVATE KEY BLOCK-----

xUsGY4d/4xsAAAAg+U2nu0jWCmHlZ3BqZYfQMxmZu52JGggkLq2EVD34laMAGXKB
exK+cH6NX1hs5hNhIB00TrJmosgv3mg1ditlsLfCsQYfGwoAAABCBYJjh3/jAwsJ
BwUVCg4IDAIWAAKbAwIeCSIhBssYbE8GCaaX5NUt+mxyKwwfHifBilZwj2Ul7Ce6
2azJBScJAgcCAAAAAK0oIBA+LX0ifsDm185Ecds2v8lwgyU2kCcUmKfvBXbAf6rh
RYWzuQOwEn7E/aLwIwRaLsdry0+VcallHhSu4RN6HWaEQsiPlR4zxP/TP7mhfVEe
7XWPxtnMUMtf15OyA51YBMdLBmOHf+MZAAAAIIaTJINn+eUBXbki+PSAld2nhJh/
LVmFsS+60WyvXkQ1AE1gCk95TUR3XFeibg/u/tVY6a//1q0NWC1X+yui3O24wpsG
GBsKAAAALAWCY4d/4wKbDCIhBssYbE8GCaaX5NUt+mxyKwwfHifBilZwj2Ul7Ce6
2azJAAAAAAQBIKbpGG2dWTX8j+VjFM21J0hqWlEg+bdiojWnKfA5AQpWUWtnNwDE
M0g12vYxoWM8Y81W+bHBw805I8kWVkXU6vFOi+HWvv/ira7ofJu16NnoUkhclkUr
k0mXubZvyl4GBg==
-----END PGP PRIVATE KEY BLOCK-----
</pre><a class="pilcrow" href="#appendix-A.4-3">¶</a>
</div>
<p id="appendix-A.4-4">The corresponding Transferable Public Key can be found in <a class="auto internal xref" href="#v6-cert">Appendix A.3</a>.<a class="pilcrow" href="#appendix-A.4-4">¶</a></p>
</section>
</div>
<div id="v6-locked-key">
<section id="appendix-A.5">
        <h3 id="name-sample-locked-version-6-sec">
<a class="section-number selfRef" href="#appendix-A.5">A.5. </a><a class="section-name selfRef" href="#name-sample-locked-version-6-sec">Sample Locked Version 6 Secret Key (Transferable Secret Key)</a>
        </h3>
<p id="appendix-A.5-1">Here is the same secret key as in <a class="auto internal xref" href="#v6-key">Appendix A.4</a>, but the secret key material is locked with a passphrase using AEAD and Argon2.<a class="pilcrow" href="#appendix-A.5-1">¶</a></p>
<p id="appendix-A.5-2">The passphrase is the ASCII string:<a class="pilcrow" href="#appendix-A.5-2">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.5-3">
<pre>correct horse battery staple
</pre><a class="pilcrow" href="#appendix-A.5-3">¶</a>
</div>
<div class="lang-application/pgp-keys sourcecode" id="appendix-A.5-4">
<pre>-----BEGIN PGP PRIVATE KEY BLOCK-----

xYIGY4d/4xsAAAAg+U2nu0jWCmHlZ3BqZYfQMxmZu52JGggkLq2EVD34laP9JgkC
FARdb9ccngltHraRe25uHuyuAQQVtKipJ0+r5jL4dacGWSAheCWPpITYiyfyIOPS
3gIDyg8f7strd1OB4+LZsUhcIjOMpVHgmiY/IutJkulneoBYwrEGHxsKAAAAQgWC
Y4d/4wMLCQcFFQoOCAwCFgACmwMCHgkiIQbLGGxPBgmml+TVLfpscisMHx4nwYpW
cI9lJewnutmsyQUnCQIHAgAAAACtKCAQPi19In7A5tfORHHbNr/JcIMlNpAnFJin
7wV2wH+q4UWFs7kDsBJ+xP2i8CMEWi7Ha8tPlXGpZR4UruETeh1mhELIj5UeM8T/
0z+5oX1RHu11j8bZzFDLX9eTsgOdWATHggZjh3/jGQAAACCGkySDZ/nlAV25Ivj0
gJXdp4SYfy1ZhbEvutFsr15ENf0mCQIUBA5hhGgp2oaavg6mFUXcFMwBBBUuE8qf
9Ock+xwusd+GAglBr5LVyr/lup3xxQvHXFSjjA2haXfoN6xUGRdDEHI6+uevKjVR
v5oAxgu7eJpaXNjCmwYYGwoAAAAsBYJjh3/jApsMIiEGyxhsTwYJppfk1S36bHIr
DB8eJ8GKVnCPZSXsJ7rZrMkAAAAABAEgpukYbZ1ZNfyP5WMUzbUnSGpaUSD5t2Ki
Nacp8DkBClZRa2c3AMQzSDXa9jGhYzxjzVb5scHDzTkjyRZWRdTq8U6L4da+/+Kt
ruh8m7Xo2ehSSFyWRSuTSZe5tm/KXgYG
-----END PGP PRIVATE KEY BLOCK-----
</pre><a class="pilcrow" href="#appendix-A.5-4">¶</a>
</div>
<div id="intermediate-data-for-locked-primary-key">
<section id="appendix-A.5.1">
          <h4 id="name-intermediate-data-for-locke">
<a class="section-number selfRef" href="#appendix-A.5.1">A.5.1. </a><a class="section-name selfRef" href="#name-intermediate-data-for-locke">Intermediate Data for Locked Primary Key</a>
          </h4>
<p id="appendix-A.5.1-1">The S2K-derived material for the primary key is:<a class="pilcrow" href="#appendix-A.5.1-1">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.5.1-2">
<pre>832bd2662a5c2b251ee3fc82aec349a766ca539015880133002e5a21960b3bcf
</pre><a class="pilcrow" href="#appendix-A.5.1-2">¶</a>
</div>
<p id="appendix-A.5.1-3">After HKDF, the symmetric key used for AEAD encryption of the primary key is:<a class="pilcrow" href="#appendix-A.5.1-3">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.5.1-4">
<pre>9e37cb26787f37e18db172795c4c297550d39ac82511d9af4c8706db6a77fd51
</pre><a class="pilcrow" href="#appendix-A.5.1-4">¶</a>
</div>
<p id="appendix-A.5.1-5">The additional data for AEAD for the primary key is:<a class="pilcrow" href="#appendix-A.5.1-5">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.5.1-6">
<pre>c50663877fe31b00000020f94da7bb48d60a61e567706a6587d0331999bb9d89
1a08242ead84543df895a3
</pre><a class="pilcrow" href="#appendix-A.5.1-6">¶</a>
</div>
</section>
</div>
<div id="intermediate-data-for-locked-subkey">
<section id="appendix-A.5.2">
          <h4 id="name-intermediate-data-for-locked">
<a class="section-number selfRef" href="#appendix-A.5.2">A.5.2. </a><a class="section-name selfRef" href="#name-intermediate-data-for-locked">Intermediate Data for Locked Subkey</a>
          </h4>
<p id="appendix-A.5.2-1">The S2K-derived key material for the subkey is:<a class="pilcrow" href="#appendix-A.5.2-1">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.5.2-2">
<pre>f74a6ce873a089ef13a3da9ac059777bb22340d15eaa6c9dc0f8ef09035c67cd
</pre><a class="pilcrow" href="#appendix-A.5.2-2">¶</a>
</div>
<p id="appendix-A.5.2-3">After HKDF, the symmetric key used for AEAD encryption of the subkey is:<a class="pilcrow" href="#appendix-A.5.2-3">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.5.2-4">
<pre>3c60cb63285f62f4c3de49835786f011cf6f4c069f61232cd7013ff5fd31e603
</pre><a class="pilcrow" href="#appendix-A.5.2-4">¶</a>
</div>
<p id="appendix-A.5.2-5">The additional data for AEAD for the subkey is:<a class="pilcrow" href="#appendix-A.5.2-5">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.5.2-6">
<pre>c70663877fe319000000208693248367f9e5015db922f8f48095dda784987f2d
5985b12fbad16caf5e4435
</pre><a class="pilcrow" href="#appendix-A.5.2-6">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="sample-csf-message">
<section id="appendix-A.6">
        <h3 id="name-sample-cleartext-signed-mes">
<a class="section-number selfRef" href="#appendix-A.6">A.6. </a><a class="section-name selfRef" href="#name-sample-cleartext-signed-mes">Sample Cleartext Signed Message</a>
        </h3>
<p id="appendix-A.6-1">Here is a signed message that uses the Cleartext Signature Framework (<a class="auto internal xref" href="#cleartext-signature">Section 7</a>). It can be verified with the certificate from <a class="auto internal xref" href="#v6-cert">Appendix A.3</a>.<a class="pilcrow" href="#appendix-A.6-1">¶</a></p>
<p id="appendix-A.6-2">Note that this message makes use of dash-escaping (<a class="auto internal xref" href="#dash-escaping">Section 7.2</a>) due to its contents.<a class="pilcrow" href="#appendix-A.6-2">¶</a></p>
<div class="lang-text/plain sourcecode" id="appendix-A.6-3">
<pre>-----BEGIN PGP SIGNED MESSAGE-----

What we need from the grocery store:

- - tofu
- - vegetables
- - noodles

-----BEGIN PGP SIGNATURE-----

wpgGARsKAAAAKQWCY5ijYyIhBssYbE8GCaaX5NUt+mxyKwwfHifBilZwj2Ul7Ce6
2azJAAAAAGk2IHZJX1AhiJD39eLuPBgiUU9wUA9VHYblySHkBONKU/usJ9BvuAqo
/FvLFuGWMbKAdA+epq7V4HOtAPlBWmU8QOd6aud+aSunHQaaEJ+iTFjP2OMW0KBr
NK2ay45cX1IVAQ==
-----END PGP SIGNATURE-----
</pre><a class="pilcrow" href="#appendix-A.6-3">¶</a>
</div>
<p id="appendix-A.6-4">The Signature packet here is:<a class="pilcrow" href="#appendix-A.6-4">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.6-5">
<pre>0x0000  c2                       packet type: Signature
0x0001     98                    packet length
0x0002        06                 sig version 6
0x0003           01              sig type: Canonical Text
0x0004              1b           pubkey algorithm: Ed25519
0x0005                 0a        hash algorithm used: SHA2-512
0x0006                    00 00  hashed subpackets length: 41
0x0008  00 29
0x000a        05                 subpkt length
0x000b           82              critical subpkt: Sig Creation Time
0x000c              63 98 a3 63   (2022-12-13T16:08:03Z)
0x0010  22                       subpkt length
0x0011     21                    subpkt type: Issuer Fingerprint
0x0012        06                 Fingerprint version 6
0x0013           cb 18 6c 4f 06  Fingerprint
0x001a  09 a6 97 e4 d5 2d fa 6c
0x0020  72 2b 0c 1f 1e 27 c1 8a
0x0028  56 70 8f 65 25 ec 27 ba
0x0030  d9 ac c9
0x0033           00 00 00 00     unhashed subpackets length: 0
0x0037                       69  left 16 bits of signed hash
0x0038  36
0x0039     20                    salt length
0x003a        76 49 5f 50 21 88  salt
0x0040  90 f7 f5 e2 ee 3c 18 22
0x0048  51 4f 70 50 0f 55 1d 86
0x0050  e5 c9 21 e4 04 e3 4a 53
0x0058  fb ac
0x005a        27 d0 6f b8 0a a8  Ed25519 signature
0x0060  fc 5b cb 16 e1 96 31 b2
0x0068  80 74 0f 9e a6 ae d5 e0
0x0070  73 ad 00 f9 41 5a 65 3c
0x0078  40 e7 7a 6a e7 7e 69 2b
0x0080  a7 1d 06 9a 10 9f a2 4c
0x0088  58 cf d8 e3 16 d0 a0 6b
0x0090  34 ad 9a cb 8e 5c 5f 52
0x0098  15 01
</pre><a class="pilcrow" href="#appendix-A.6-5">¶</a>
</div>
<p id="appendix-A.6-6">The signature is made over the following data:<a class="pilcrow" href="#appendix-A.6-6">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.6-7">
<pre>0x0000  76 49 5f 50 21 88 90 f7
0x0008  f5 e2 ee 3c 18 22 51 4f
0x0010  70 50 0f 55 1d 86 e5 c9
0x0018  21 e4 04 e3 4a 53 fb ac
0x0020  57 68 61 74 20 77 65 20
0x0028  6e 65 65 64 20 66 72 6f
0x0030  6d 20 74 68 65 20 67 72
0x0038  6f 63 65 72 79 20 73 74
0x0040  6f 72 65 3a 0d 0a 0d 0a
0x0048  2d 20 74 6f 66 75 0d 0a
0x0050  2d 20 76 65 67 65 74 61
0x0058  62 6c 65 73 0d 0a 2d 20
0x0060  6e 6f 6f 64 6c 65 73 0d
0x0068  0a 06 01 1b 0a 00 00 00
0x0070  29 05 82 63 98 a3 63 22
0x0078  21 06 cb 18 6c 4f 06 09
0x0080  a6 97 e4 d5 2d fa 6c 72
0x0088  2b 0c 1f 1e 27 c1 8a 56
0x0090  70 8f 65 25 ec 27 ba d9
0x0098  ac c9 06 ff 00 00 00 31
</pre><a class="pilcrow" href="#appendix-A.6-7">¶</a>
</div>
<p id="appendix-A.6-8">The same data, broken out by octet and semantics, is:<a class="pilcrow" href="#appendix-A.6-8">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.6-9">
<pre>0x0000  76 49 5f 50 21 88 90 f7  salt
0x0008  f5 e2 ee 3c 18 22 51 4f
0x0010  70 50 0f 55 1d 86 e5 c9
0x0018  21 e4 04 e3 4a 53 fb ac
      [ message begins ]
0x0020  57 68 61 74 20 77 65 20  canonicalized message
0x0028  6e 65 65 64 20 66 72 6f
0x0030  6d 20 74 68 65 20 67 72
0x0038  6f 63 65 72 79 20 73 74
0x0040  6f 72 65 3a 0d 0a 0d 0a
0x0048  2d 20 74 6f 66 75 0d 0a
0x0050  2d 20 76 65 67 65 74 61
0x0058  62 6c 65 73 0d 0a 2d 20
0x0060  6e 6f 6f 64 6c 65 73 0d
0x0068  0a
      [ trailer begins ]
0x0069     06                    sig version 6
0x006a        01                 sig type: Canonical Text
0x006b           1b              pubkey algorithm: Ed25519
0x006c              0a           hash algorithm: SHA2-512
0x006d                 00 00 00  hashed subpackets length
0x0070  29
0x0071     05                    subpacket length
0x0072        82                 critical subpkt: Sig Creation Time
0x0073           63 98 a3 63       (2022-12-13T16:08:03Z)
0x0077                       22  subpkt length
0x0078  21                       subpkt type: Issuer Fingerprint
0x0079     06                    Fingerprint version 6
0x007a        cb 18 6c 4f 06 09  Fingerprint
0x0080  a6 97 e4 d5 2d fa 6c 72
0x0088  2b 0c 1f 1e 27 c1 8a 56
0x0090  70 8f 65 25 ec 27 ba d9
0x0098  ac c9
0x009a        06                 sig version 6
0x009b           ff              sentinel octet
0x009c              00 00 00 31  trailer length
</pre><a class="pilcrow" href="#appendix-A.6-9">¶</a>
</div>
<p id="appendix-A.6-10">The calculated SHA2-512 hash digest over this data is:<a class="pilcrow" href="#appendix-A.6-10">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.6-11">
<pre>69365bf44a97af1f0844f1f6ab83fdf6b36f26692efaa621a8aac91c4e29ea07
e894cabc6e2f20eedfce6c03b89141a2cc7cbe245e6e7a5654addbec5000b89b
</pre><a class="pilcrow" href="#appendix-A.6-11">¶</a>
</div>
</section>
</div>
<div id="sample-inline-signed-message">
<section id="appendix-A.7">
        <h3 id="name-sample-inline-signed-messag">
<a class="section-number selfRef" href="#appendix-A.7">A.7. </a><a class="section-name selfRef" href="#name-sample-inline-signed-messag">Sample Inline-Signed Message</a>
        </h3>
<p id="appendix-A.7-1">This is the same message and signature as in <a class="auto internal xref" href="#sample-csf-message">Appendix A.6</a> but as an inline-signed message. The hashed data is exactly the same, and all intermediate values and annotated hex dumps are also applicable.<a class="pilcrow" href="#appendix-A.7-1">¶</a></p>
<div class="lang-text/plain sourcecode" id="appendix-A.7-2">
<pre>-----BEGIN PGP MESSAGE-----

xEYGAQobIHZJX1AhiJD39eLuPBgiUU9wUA9VHYblySHkBONKU/usyxhsTwYJppfk
1S36bHIrDB8eJ8GKVnCPZSXsJ7rZrMkBy0p1AAAAAABXaGF0IHdlIG5lZWQgZnJv
bSB0aGUgZ3JvY2VyeSBzdG9yZToKCi0gdG9mdQotIHZlZ2V0YWJsZXMKLSBub29k
bGVzCsKYBgEbCgAAACkFgmOYo2MiIQbLGGxPBgmml+TVLfpscisMHx4nwYpWcI9l
JewnutmsyQAAAABpNiB2SV9QIYiQ9/Xi7jwYIlFPcFAPVR2G5ckh5ATjSlP7rCfQ
b7gKqPxbyxbhljGygHQPnqau1eBzrQD5QVplPEDnemrnfmkrpx0GmhCfokxYz9jj
FtCgazStmsuOXF9SFQE=
-----END PGP MESSAGE-----
</pre><a class="pilcrow" href="#appendix-A.7-2">¶</a>
</div>
</section>
</div>
<div id="sample-x25519-aead-ocb-encryption-and-decryption">
<section id="appendix-A.8">
        <h3 id="name-sample-x25519-aead-ocb-encr">
<a class="section-number selfRef" href="#appendix-A.8">A.8. </a><a class="section-name selfRef" href="#name-sample-x25519-aead-ocb-encr">Sample X25519-AEAD-OCB Encryption and Decryption</a>
        </h3>
<p id="appendix-A.8-1">This example encrypts the cleartext string <code>Hello, world!</code> for the sample cert (see <a class="auto internal xref" href="#v6-cert">Appendix A.3</a>), using AES-128 with AEAD-OCB encryption.<a class="pilcrow" href="#appendix-A.8-1">¶</a></p>
<div id="sample-public-key-encrypted-session-key-packet-v6">
<section id="appendix-A.8.1">
          <h4 id="name-sample-version-6-public-key">
<a class="section-number selfRef" href="#appendix-A.8.1">A.8.1. </a><a class="section-name selfRef" href="#name-sample-version-6-public-key">Sample Version 6 Public Key Encrypted Session Key Packet</a>
          </h4>
<p id="appendix-A.8.1-1">This packet contains the following series of octets:<a class="pilcrow" href="#appendix-A.8.1-1">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.8.1-2">
<pre>0x0000  c1 5d 06 21 06 12 c8 3f
0x0008  1e 70 6f 63 08 fe 15 1a
0x0010  41 77 43 a1 f0 33 79 0e
0x0018  93 e9 97 84 88 d1 db 37
0x0020  8d a9 93 08 85 19 87 cf
0x0028  18 d5 f1 b5 3f 81 7c ce
0x0030  5a 00 4c f3 93 cc 89 58
0x0038  bd dc 06 5f 25 f8 4a f5
0x0040  09 b1 7d d3 67 64 18 de
0x0048  a3 55 43 79 56 61 79 01
0x0050  e0 69 57 fb ca 8a 6a 47
0x0058  a5 b5 15 3e 8d 3a b7
</pre><a class="pilcrow" href="#appendix-A.8.1-2">¶</a>
</div>
<p id="appendix-A.8.1-3">The same data, broken out by octet and semantics, is:<a class="pilcrow" href="#appendix-A.8.1-3">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.8.1-4">
<pre>0x0000  c1                       packet type: PKESK
0x0001     5d                    packet length
0x0002        06                 v6 PKESK
0x0003           21              length of fingerprint
0x0004              06           Key version 6
0x0005                 12 c8 3f  Key fingerprint
0x0008  1e 70 6f 63 08 fe 15 1a
0x0010  41 77 43 a1 f0 33 79 0e
0x0018  93 e9 97 84 88 d1 db 37
0x0020  8d a9 93 08 85
0x0025                 19        algorithm: X25519
0x0026                    87 cf  Ephemeral key
0x0028  18 d5 f1 b5 3f 81 7c ce
0x0030  5a 00 4c f3 93 cc 89 58
0x0038  bd dc 06 5f 25 f8 4a f5
0x0040  09 b1 7d d3 67 64
0x0046                    18     ESK length
0x0047                       de  ESK
0x0048  a3 55 43 79 56 61 79 01
0x0050  e0 69 57 fb ca 8a 6a 47
0x0058  a5 b5 15 3e 8d 3a b7
</pre><a class="pilcrow" href="#appendix-A.8.1-4">¶</a>
</div>
</section>
</div>
<div id="x25519-encryptiondecryption-of-the-session-key">
<section id="appendix-A.8.2">
          <h4 id="name-x25519-encryption-decryptio">
<a class="section-number selfRef" href="#appendix-A.8.2">A.8.2. </a><a class="section-name selfRef" href="#name-x25519-encryption-decryptio">X25519 Encryption/Decryption of the Session Key</a>
          </h4>
<p id="appendix-A.8.2-1">Ephemeral key:<a class="pilcrow" href="#appendix-A.8.2-1">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.8.2-2">
<pre>  87 cf 18 d5 f1 b5 3f 81 7c ce 5a 00 4c f3 93 cc
  89 58 bd dc 06 5f 25 f8 4a f5 09 b1 7d d3 67 64
</pre><a class="pilcrow" href="#appendix-A.8.2-2">¶</a>
</div>
<p id="appendix-A.8.2-3">This ephemeral key is derived from the following ephemeral secret key material, which is never placed on the wire:<a class="pilcrow" href="#appendix-A.8.2-3">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.8.2-4">
<pre>  af 1e 43 c0 d1 23 ef e8 93 a7 d4 d3 90 f3 a7 61
  e3 fa c3 3d fc 7f 3e da a8 30 c9 01 13 52 c7 79
</pre><a class="pilcrow" href="#appendix-A.8.2-4">¶</a>
</div>
<p id="appendix-A.8.2-5">Public key from the target certificate (see <a class="auto internal xref" href="#v6-cert">Appendix A.3</a>):<a class="pilcrow" href="#appendix-A.8.2-5">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.8.2-6">
<pre>  86 93 24 83 67 f9 e5 01 5d b9 22 f8 f4 80 95 dd
  a7 84 98 7f 2d 59 85 b1 2f ba d1 6c af 5e 44 35
</pre><a class="pilcrow" href="#appendix-A.8.2-6">¶</a>
</div>
<p id="appendix-A.8.2-7">The corresponding long-lived X25519 private key material (see <a class="auto internal xref" href="#v6-key">Appendix A.4</a>):<a class="pilcrow" href="#appendix-A.8.2-7">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.8.2-8">
<pre>  4d 60 0a 4f 79 4d 44 77 5c 57 a2 6e 0f ee fe d5
  58 e9 af ff d6 ad 0d 58 2d 57 fb 2b a2 dc ed b8
</pre><a class="pilcrow" href="#appendix-A.8.2-8">¶</a>
</div>
<p id="appendix-A.8.2-9">Shared point:<a class="pilcrow" href="#appendix-A.8.2-9">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.8.2-10">
<pre>  67 e3 0e 69 cd c7 ba b2 a2 68 0d 78 ac a4 6a 2f
  8b 6e 2a e4 4d 39 8b dc 6f 92 c5 ad 4a 49 25 14
</pre><a class="pilcrow" href="#appendix-A.8.2-10">¶</a>
</div>
<p id="appendix-A.8.2-11">HKDF output:<a class="pilcrow" href="#appendix-A.8.2-11">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.8.2-12">
<pre>  f6 6d ad cf f6 45 92 23 9b 25 45 39 b6 4f f6 07
</pre><a class="pilcrow" href="#appendix-A.8.2-12">¶</a>
</div>
<p id="appendix-A.8.2-13">Decrypted session key:<a class="pilcrow" href="#appendix-A.8.2-13">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.8.2-14">
<pre>  dd 70 8f 6f a1 ed 65 11 4d 68 d2 34 3e 7c 2f 1d
</pre><a class="pilcrow" href="#appendix-A.8.2-14">¶</a>
</div>
</section>
</div>
<div id="sample-v2-seipd-packet">
<section id="appendix-A.8.3">
          <h4 id="name-sample-v2-seipd-packet">
<a class="section-number selfRef" href="#appendix-A.8.3">A.8.3. </a><a class="section-name selfRef" href="#name-sample-v2-seipd-packet">Sample v2 SEIPD Packet</a>
          </h4>
<p id="appendix-A.8.3-1">This packet contains the following series of octets:<a class="pilcrow" href="#appendix-A.8.3-1">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.8.3-2">
<pre>0x0000  d2 69 02 07 02 06 61 64
0x0008  16 53 5b e0 b0 71 6d 60
0x0010  e0 52 a5 6c 4c 40 7f 9e
0x0018  b3 6b 0e fa fe 9a d0 a0
0x0020  df 9b 03 3c 69 a2 1b a9
0x0028  eb d2 c0 ec 95 bf 56 9d
0x0030  25 c9 99 ee 4a 3d e1 70
0x0038  58 f4 0d fa 8b 4c 68 2b
0x0040  e3 fb bb d7 b2 7e b0 f5
0x0048  9b b5 00 5f 80 c7 c6 f4
0x0050  03 88 c3 0a d4 06 ab 05
0x0058  13 dc d6 f9 fd 73 76 56
0x0060  28 6e 11 77 d0 0f 88 8a
0x0068  db 31 c4
</pre><a class="pilcrow" href="#appendix-A.8.3-2">¶</a>
</div>
<p id="appendix-A.8.3-3">The same data, broken out by octet and semantics, is:<a class="pilcrow" href="#appendix-A.8.3-3">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.8.3-4">
<pre>0x0000  d2                       packet type: SEIPD
0x0001     69                    packet length
0x0002        02                 v2 SEIPD
0x0003           07              cipher: AES128
0x0004              02           AEAD mode: OCB
0x0005                 06        chunk size (2^12 octets)
0x0006                    61 64  salt
0x0008  16 53 5b e0 b0 71 6d 60
0x0010  e0 52 a5 6c 4c 40 7f 9e
0x0018  b3 6b 0e fa fe 9a d0 a0
0x0020  df 9b 03 3c 69 a2
0x0026                    1b a9  chunk #0 encrypted data
0x0028  eb d2 c0 ec 95 bf 56 9d
0x0030  25 c9 99 ee 4a 3d e1 70
0x0038  58 f4 0d fa 8b 4c 68 2b
0x0040  e3 fb bb d7 b2 7e b0 f5
0x0048  9b b5 00
0x004b           5f 80 c7 c6 f4  chunk #0 AEAD tag
0x0050  03 88 c3 0a d4 06 ab 05
0x0058  13 dc d6
0x005b           f9 fd 73 76 56  final AEAD tag (#1)
S0x0060  28 6e 11 77 d0 0f 88 8a
0x0068  db 31 c4
</pre><a class="pilcrow" href="#appendix-A.8.3-4">¶</a>
</div>
</section>
</div>
<div id="decryption-of-data">
<section id="appendix-A.8.4">
          <h4 id="name-decryption-of-data">
<a class="section-number selfRef" href="#appendix-A.8.4">A.8.4. </a><a class="section-name selfRef" href="#name-decryption-of-data">Decryption of Data</a>
          </h4>
<p id="appendix-A.8.4-1">Starting AEAD-OCB decryption of data, using the session key.<a class="pilcrow" href="#appendix-A.8.4-1">¶</a></p>
<p id="appendix-A.8.4-2">HKDF info:<a class="pilcrow" href="#appendix-A.8.4-2">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.8.4-3">
<pre>  d2 02 07 02 06
</pre><a class="pilcrow" href="#appendix-A.8.4-3">¶</a>
</div>
<p id="appendix-A.8.4-4">HKDF output:<a class="pilcrow" href="#appendix-A.8.4-4">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.8.4-5">
<pre>  45 12 f7 14 9d 86 33 41 52 7c 65 67 d5 bf fc 42
  5f af 32 50 21 2f f9
</pre><a class="pilcrow" href="#appendix-A.8.4-5">¶</a>
</div>
<p id="appendix-A.8.4-6">Message key:<a class="pilcrow" href="#appendix-A.8.4-6">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.8.4-7">
<pre>  45 12 f7 14 9d 86 33 41 52 7c 65 67 d5 bf fc 42
</pre><a class="pilcrow" href="#appendix-A.8.4-7">¶</a>
</div>
<p id="appendix-A.8.4-8">Initialization vector:<a class="pilcrow" href="#appendix-A.8.4-8">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.8.4-9">
<pre>  5f af 32 50 21 2f f9
</pre><a class="pilcrow" href="#appendix-A.8.4-9">¶</a>
</div>
<p id="appendix-A.8.4-10">Chunk #0:<a class="pilcrow" href="#appendix-A.8.4-10">¶</a></p>
<p id="appendix-A.8.4-11">Nonce:<a class="pilcrow" href="#appendix-A.8.4-11">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.8.4-12">
<pre>  5f af 32 50 21 2f f9 00 00 00 00 00 00 00 00
</pre><a class="pilcrow" href="#appendix-A.8.4-12">¶</a>
</div>
<p id="appendix-A.8.4-13">Additional authenticated data:<a class="pilcrow" href="#appendix-A.8.4-13">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.8.4-14">
<pre>  d2 02 07 02 06
</pre><a class="pilcrow" href="#appendix-A.8.4-14">¶</a>
</div>
<p id="appendix-A.8.4-15">Encrypted data chunk:<a class="pilcrow" href="#appendix-A.8.4-15">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.8.4-16">
<pre>  1b a9 eb d2 c0 ec 95 bf 56 9d 25 c9 99 ee 4a 3d
  e1 70 58 f4 0d fa 8b 4c 68 2b e3 fb bb d7 b2 7e
  b0 f5 9b b5 00 5f 80 c7 c6 f4 03 88 c3 0a d4 06
  ab 05 13 dc d6
</pre><a class="pilcrow" href="#appendix-A.8.4-16">¶</a>
</div>
<p id="appendix-A.8.4-17">Decrypted chunk #0.<a class="pilcrow" href="#appendix-A.8.4-17">¶</a></p>
<p id="appendix-A.8.4-18">Literal Data packet with the string contents <code>Hello, world!</code>:<a class="pilcrow" href="#appendix-A.8.4-18">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.8.4-19">
<pre>  cb 13 62 00 00 00 00 00 48 65 6c 6c 6f 2c 20 77
  6f 72 6c 64 21
</pre><a class="pilcrow" href="#appendix-A.8.4-19">¶</a>
</div>
<p id="appendix-A.8.4-20">Padding packet:<a class="pilcrow" href="#appendix-A.8.4-20">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.8.4-21">
<pre>  d5 0e c5 a2 93 07 29 91 62 81 47 d7 2c 8f 86 b7
</pre><a class="pilcrow" href="#appendix-A.8.4-21">¶</a>
</div>
<p id="appendix-A.8.4-22">Authenticating final tag:<a class="pilcrow" href="#appendix-A.8.4-22">¶</a></p>
<p id="appendix-A.8.4-23">Final nonce:<a class="pilcrow" href="#appendix-A.8.4-23">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.8.4-24">
<pre>  5f af 32 50 21 2f f9 00 00 00 00 00 00 00 01
</pre><a class="pilcrow" href="#appendix-A.8.4-24">¶</a>
</div>
<p id="appendix-A.8.4-25">Final additional authenticated data:<a class="pilcrow" href="#appendix-A.8.4-25">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.8.4-26">
<pre>  d2 02 07 02 06 00 00 00 00 00 00 00 25
</pre><a class="pilcrow" href="#appendix-A.8.4-26">¶</a>
</div>
</section>
</div>
<div id="complete-x25519-aead-ocb-encrypted-packet-sequence">
<section id="appendix-A.8.5">
          <h4 id="name-complete-x25519-aead-ocb-en">
<a class="section-number selfRef" href="#appendix-A.8.5">A.8.5. </a><a class="section-name selfRef" href="#name-complete-x25519-aead-ocb-en">Complete X25519-AEAD-OCB Encrypted Packet Sequence</a>
          </h4>
<div class="lang-application/pgp-encrypted sourcecode" id="appendix-A.8.5-1">
<pre>-----BEGIN PGP MESSAGE-----

wV0GIQYSyD8ecG9jCP4VGkF3Q6HwM3kOk+mXhIjR2zeNqZMIhRmHzxjV8bU/gXzO
WgBM85PMiVi93AZfJfhK9QmxfdNnZBjeo1VDeVZheQHgaVf7yopqR6W1FT6NOrfS
aQIHAgZhZBZTW+CwcW1g4FKlbExAf56zaw76/prQoN+bAzxpohup69LA7JW/Vp0l
yZnuSj3hcFj0DfqLTGgr4/u717J+sPWbtQBfgMfG9AOIwwrUBqsFE9zW+f1zdlYo
bhF30A+IitsxxA==
-----END PGP MESSAGE-----
</pre><a class="pilcrow" href="#appendix-A.8.5-1">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="sample-aead-eax-encryption-and-decryption">
<section id="appendix-A.9">
        <h3 id="name-sample-aead-eax-encryption-">
<a class="section-number selfRef" href="#appendix-A.9">A.9. </a><a class="section-name selfRef" href="#name-sample-aead-eax-encryption-">Sample AEAD-EAX Encryption and Decryption</a>
        </h3>
<p id="appendix-A.9-1">This example encrypts the cleartext string <code>Hello, world!</code> with the passphrase <code>password</code>, using AES-128 with AEAD-EAX encryption.<a class="pilcrow" href="#appendix-A.9-1">¶</a></p>
<div id="sample-symmetric-key-encrypted-session-key-packet-v6">
<section id="appendix-A.9.1">
          <h4 id="name-sample-version-6-symmetric-">
<a class="section-number selfRef" href="#appendix-A.9.1">A.9.1. </a><a class="section-name selfRef" href="#name-sample-version-6-symmetric-">Sample Version 6 Symmetric Key Encrypted Session Key Packet</a>
          </h4>
<p id="appendix-A.9.1-1">This packet contains the following series of octets:<a class="pilcrow" href="#appendix-A.9.1-1">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.9.1-2">
<pre>0x0000  c3 40 06 1e 07 01 0b 03
0x0008  08 a5 ae 57 9d 1f c5 d8
0x0010  2b ff 69 22 4f 91 99 93
0x0018  b3 50 6f a3 b5 9a 6a 73
0x0020  cf f8 c5 ef c5 f4 1c 57
0x0028  fb 54 e1 c2 26 81 5d 78
0x0030  28 f5 f9 2c 45 4e b6 5e
0x0038  be 00 ab 59 86 c6 8e 6e
0x0040  7c 55
</pre><a class="pilcrow" href="#appendix-A.9.1-2">¶</a>
</div>
<p id="appendix-A.9.1-3">The same data, broken out by octet and semantics, is:<a class="pilcrow" href="#appendix-A.9.1-3">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.9.1-4">
<pre>0x0000  c3                       packet type: SKESK
0x0001     40                    packet length
0x0002        06                 v6 SKESK
0x0003           1e              length through end of AEAD nonce
0x0004              07           cipher: AES128
0x0005                 01        AEAD mode: EAX
0x0006                    0b     length of S2K
0x0007                       03  S2K type: iterated+salted
0x0008  08                       S2K hash: SHA2-256
0x0009     a5 ae 57 9d 1f c5 d8  S2K salt
0x0010  2b
0x0011     ff                    S2K iterations (65011712 octets)
0x0012        69 22 4f 91 99 93  AEAD nonce
0x0018  b3 50 6f a3 b5 9a 6a 73
0x0020  cf f8
0x0022        c5 ef c5 f4 1c 57  encrypted session key
0x0028  fb 54 e1 c2 26 81 5d 78
0x0030  28 f5
0x0032        f9 2c 45 4e b6 5e  AEAD tag
0x0038  be 00 ab 59 86 c6 8e 6e
0x0040  7c 55
</pre><a class="pilcrow" href="#appendix-A.9.1-4">¶</a>
</div>
</section>
</div>
<div id="starting-aead-eax-decryption-of-the-session-key">
<section id="appendix-A.9.2">
          <h4 id="name-starting-aead-eax-decryptio">
<a class="section-number selfRef" href="#appendix-A.9.2">A.9.2. </a><a class="section-name selfRef" href="#name-starting-aead-eax-decryptio">Starting AEAD-EAX Decryption of the Session Key</a>
          </h4>
<p id="appendix-A.9.2-1">The derived key is:<a class="pilcrow" href="#appendix-A.9.2-1">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.9.2-2">
<pre>  15 49 67 e5 90 aa 1f 92 3e 1c 0a c6 4c 88 f2 3d
</pre><a class="pilcrow" href="#appendix-A.9.2-2">¶</a>
</div>
<p id="appendix-A.9.2-3">HKDF info:<a class="pilcrow" href="#appendix-A.9.2-3">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.9.2-4">
<pre>  c3 06 07 01
</pre><a class="pilcrow" href="#appendix-A.9.2-4">¶</a>
</div>
<p id="appendix-A.9.2-5">HKDF output:<a class="pilcrow" href="#appendix-A.9.2-5">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.9.2-6">
<pre>  2f ce 33 1f 39 dd 95 5c c4 1e 95 d8 70 c7 21 39
</pre><a class="pilcrow" href="#appendix-A.9.2-6">¶</a>
</div>
<p id="appendix-A.9.2-7">Authenticated Data:<a class="pilcrow" href="#appendix-A.9.2-7">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.9.2-8">
<pre>  c3 06 07 01
</pre><a class="pilcrow" href="#appendix-A.9.2-8">¶</a>
</div>
<p id="appendix-A.9.2-9">Nonce:<a class="pilcrow" href="#appendix-A.9.2-9">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.9.2-10">
<pre>  69 22 4f 91 99 93 b3 50 6f a3 b5 9a 6a 73 cf f8
</pre><a class="pilcrow" href="#appendix-A.9.2-10">¶</a>
</div>
<p id="appendix-A.9.2-11">Decrypted session key:<a class="pilcrow" href="#appendix-A.9.2-11">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.9.2-12">
<pre>  38 81 ba fe 98 54 12 45 9b 86 c3 6f 98 cb 9a 5e
</pre><a class="pilcrow" href="#appendix-A.9.2-12">¶</a>
</div>
</section>
</div>
<div id="sample-v2-seipd-packet-1">
<section id="appendix-A.9.3">
          <h4 id="name-sample-v2-seipd-packet-2">
<a class="section-number selfRef" href="#appendix-A.9.3">A.9.3. </a><a class="section-name selfRef" href="#name-sample-v2-seipd-packet-2">Sample v2 SEIPD Packet</a>
          </h4>
<p id="appendix-A.9.3-1">This packet contains the following series of octets:<a class="pilcrow" href="#appendix-A.9.3-1">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.9.3-2">
<pre>0x0000  d2 69 02 07 01 06 9f f9
0x0008  0e 3b 32 19 64 f3 a4 29
0x0010  13 c8 dc c6 61 93 25 01
0x0018  52 27 ef b7 ea ea a4 9f
0x0020  04 c2 e6 74 17 5d 4a 3d
0x0028  22 6e d6 af cb 9c a9 ac
0x0030  12 2c 14 70 e1 1c 63 d4
0x0038  c0 ab 24 1c 6a 93 8a d4
0x0040  8b f9 9a 5a 99 b9 0b ba
0x0048  83 25 de 61 04 75 40 25
0x0050  8a b7 95 9a 95 ad 05 1d
0x0058  da 96 eb 15 43 1d fe f5
0x0060  f5 e2 25 5c a7 82 61 54
0x0068  6e 33 9a
</pre><a class="pilcrow" href="#appendix-A.9.3-2">¶</a>
</div>
<p id="appendix-A.9.3-3">The same data, broken out by octet and semantics, is:<a class="pilcrow" href="#appendix-A.9.3-3">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.9.3-4">
<pre>0x0000  d2                       packet type: SEIPD
0x0001     69                    packet length
0x0002        02                 v2 SEIPD
0x0003           07              cipher: AES128
0x0004              01           AEAD mode: EAX
0x0005                 06        chunk size (2^12 octets)
0x0005                    9f f9  salt
0x0008  0e 3b 32 19 64 f3 a4 29
0x0010  13 c8 dc c6 61 93 25 01
0x0018  52 27 ef b7 ea ea a4 9f
0x0020  04 c2 e6 74 17 5d
0x0026                    4a 3d  chunk #0 encrypted data
0x0028  22 6e d6 af cb 9c a9 ac
0x0030  12 2c 14 70 e1 1c 63 d4
0x0038  c0 ab 24 1c 6a 93 8a d4
0x0040  8b f9 9a 5a 99 b9 0b ba
0x0048  83 25 de
0x004b           61 04 75 40 25  chunk #0 AEAD tag
0x0050  8a b7 95 9a 95 ad 05 1d
0x0058  da 96 eb
0x005b           15 43 1d fe f5  final AEAD tag (#1)
0x0060  f5 e2 25 5c a7 82 61 54
0x0068  6e 33 9a
</pre><a class="pilcrow" href="#appendix-A.9.3-4">¶</a>
</div>
</section>
</div>
<div id="decryption-of-data-1">
<section id="appendix-A.9.4">
          <h4 id="name-decryption-of-data-2">
<a class="section-number selfRef" href="#appendix-A.9.4">A.9.4. </a><a class="section-name selfRef" href="#name-decryption-of-data-2">Decryption of Data</a>
          </h4>
<p id="appendix-A.9.4-1">Starting AEAD-EAX decryption of data, using the session key.<a class="pilcrow" href="#appendix-A.9.4-1">¶</a></p>
<p id="appendix-A.9.4-2">HKDF info:<a class="pilcrow" href="#appendix-A.9.4-2">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.9.4-3">
<pre>  d2 02 07 01 06
</pre><a class="pilcrow" href="#appendix-A.9.4-3">¶</a>
</div>
<p id="appendix-A.9.4-4">HKDF output:<a class="pilcrow" href="#appendix-A.9.4-4">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.9.4-5">
<pre>  b5 04 22 ac 1c 26 be 9d dd 83 1d 5b bb 36 b6 4f
  78 b8 33 f2 e9 4a 60 c0
</pre><a class="pilcrow" href="#appendix-A.9.4-5">¶</a>
</div>
<p id="appendix-A.9.4-6">Message key:<a class="pilcrow" href="#appendix-A.9.4-6">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.9.4-7">
<pre>  b5 04 22 ac 1c 26 be 9d dd 83 1d 5b bb 36 b6 4f
</pre><a class="pilcrow" href="#appendix-A.9.4-7">¶</a>
</div>
<p id="appendix-A.9.4-8">Initialization vector:<a class="pilcrow" href="#appendix-A.9.4-8">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.9.4-9">
<pre>  78 b8 33 f2 e9 4a 60 c0
</pre><a class="pilcrow" href="#appendix-A.9.4-9">¶</a>
</div>
<p id="appendix-A.9.4-10">Chunk #0:<a class="pilcrow" href="#appendix-A.9.4-10">¶</a></p>
<p id="appendix-A.9.4-11">Nonce:<a class="pilcrow" href="#appendix-A.9.4-11">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.9.4-12">
<pre>  78 b8 33 f2 e9 4a 60 c0 00 00 00 00 00 00 00 00
</pre><a class="pilcrow" href="#appendix-A.9.4-12">¶</a>
</div>
<p id="appendix-A.9.4-13">Additional authenticated data:<a class="pilcrow" href="#appendix-A.9.4-13">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.9.4-14">
<pre>  d2 02 07 01 06
</pre><a class="pilcrow" href="#appendix-A.9.4-14">¶</a>
</div>
<p id="appendix-A.9.4-15">Decrypted chunk #0.<a class="pilcrow" href="#appendix-A.9.4-15">¶</a></p>
<p id="appendix-A.9.4-16">Literal Data packet with the string contents <code>Hello, world!</code>:<a class="pilcrow" href="#appendix-A.9.4-16">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.9.4-17">
<pre>  cb 13 62 00 00 00 00 00 48 65 6c 6c 6f 2c 20 77
  6f 72 6c 64 21
</pre><a class="pilcrow" href="#appendix-A.9.4-17">¶</a>
</div>
<p id="appendix-A.9.4-18">Padding packet:<a class="pilcrow" href="#appendix-A.9.4-18">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.9.4-19">
<pre>  d5 0e ae 5b f0 cd 67 05 50 03 55 81 6c b0 c8 ff
</pre><a class="pilcrow" href="#appendix-A.9.4-19">¶</a>
</div>
<p id="appendix-A.9.4-20">Authenticating final tag:<a class="pilcrow" href="#appendix-A.9.4-20">¶</a></p>
<p id="appendix-A.9.4-21">Final nonce:<a class="pilcrow" href="#appendix-A.9.4-21">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.9.4-22">
<pre>  78 b8 33 f2 e9 4a 60 c0 00 00 00 00 00 00 00 01
</pre><a class="pilcrow" href="#appendix-A.9.4-22">¶</a>
</div>
<p id="appendix-A.9.4-23">Final additional authenticated data:<a class="pilcrow" href="#appendix-A.9.4-23">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.9.4-24">
<pre>  d2 02 07 01 06 00 00 00 00 00 00 00 25
</pre><a class="pilcrow" href="#appendix-A.9.4-24">¶</a>
</div>
</section>
</div>
<div id="complete-aead-eax-encrypted-packet-sequence">
<section id="appendix-A.9.5">
          <h4 id="name-complete-aead-eax-encrypted">
<a class="section-number selfRef" href="#appendix-A.9.5">A.9.5. </a><a class="section-name selfRef" href="#name-complete-aead-eax-encrypted">Complete AEAD-EAX Encrypted Packet Sequence</a>
          </h4>
<div class="lang-application/pgp-encrypted sourcecode" id="appendix-A.9.5-1">
<pre>-----BEGIN PGP MESSAGE-----

w0AGHgcBCwMIpa5XnR/F2Cv/aSJPkZmTs1Bvo7WaanPP+MXvxfQcV/tU4cImgV14
KPX5LEVOtl6+AKtZhsaObnxV0mkCBwEGn/kOOzIZZPOkKRPI3MZhkyUBUifvt+rq
pJ8EwuZ0F11KPSJu1q/LnKmsEiwUcOEcY9TAqyQcapOK1Iv5mlqZuQu6gyXeYQR1
QCWKt5Wala0FHdqW6xVDHf719eIlXKeCYVRuM5o=
-----END PGP MESSAGE-----
</pre><a class="pilcrow" href="#appendix-A.9.5-1">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="sample-aead-ocb-encryption-and-decryption">
<section id="appendix-A.10">
        <h3 id="name-sample-aead-ocb-encryption-">
<a class="section-number selfRef" href="#appendix-A.10">A.10. </a><a class="section-name selfRef" href="#name-sample-aead-ocb-encryption-">Sample AEAD-OCB Encryption and Decryption</a>
        </h3>
<p id="appendix-A.10-1">This example encrypts the cleartext string <code>Hello, world!</code> with the passphrase <code>password</code>, using AES-128 with AEAD-OCB encryption.<a class="pilcrow" href="#appendix-A.10-1">¶</a></p>
<div id="sample-symmetric-key-encrypted-session-key-packet-v6-1">
<section id="appendix-A.10.1">
          <h4 id="name-sample-version-6-symmetric-k">
<a class="section-number selfRef" href="#appendix-A.10.1">A.10.1. </a><a class="section-name selfRef" href="#name-sample-version-6-symmetric-k">Sample Version 6 Symmetric Key Encrypted Session Key Packet</a>
          </h4>
<p id="appendix-A.10.1-1">This packet contains the following series of octets:<a class="pilcrow" href="#appendix-A.10.1-1">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.10.1-2">
<pre>0x0000  c3 3f 06 1d 07 02 0b 03
0x0008  08 56 a2 98 d2 f5 e3 64
0x0010  53 ff cf cc 5c 11 66 4e
0x0018  db 9d b4 25 90 d7 dc 46
0x0020  b0 72 41 b6 12 c3 81 2c
0x0028  ff fb ea 00 f2 34 7b 25
0x0030  64 11 23 f8 87 ae 60 d4
0x0038  fd 61 4e 08 37 d8 19 d3
0x0040  6c
</pre><a class="pilcrow" href="#appendix-A.10.1-2">¶</a>
</div>
<p id="appendix-A.10.1-3">The same data, broken out by octet and semantics, is:<a class="pilcrow" href="#appendix-A.10.1-3">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.10.1-4">
<pre>0x0000  c3                       packet type: SKESK
0x0001     3f                    packet length
0x0002        06                 v6 SKESK
0x0003           1d              length through end of AEAD nonce
0x0004              07           cipher: AES128
0x0005                 02        AEAD mode: OCB
0x0006                    0b     length of S2K
0x0007                       03  S2K type: iterated+salted
0x0008  08                       S2K hash: SHA2-256
0x0009     56 a2 98 d2 f5 e3 64  S2K salt
0x0010  53
0x0011    ff                     S2K iterations (65011712 octets)
0x0012        cf cc 5c 11 66 4e  AEAD nonce
0x0018  db 9d b4 25 90 d7 dc 46
0x0020  b0
0x0021     72 41 b6 12 c3 81 2c  encrypted session key
0x0028  ff fb ea 00 f2 34 7b 25
0x0030  64
0x0031     11 23 f8 87 ae 60 d4  AEAD tag
0x0038  fd 61 4e 08 37 d8 19 d3
0x0040  6c
</pre><a class="pilcrow" href="#appendix-A.10.1-4">¶</a>
</div>
</section>
</div>
<div id="starting-aead-ocb-decryption-of-the-session-key">
<section id="appendix-A.10.2">
          <h4 id="name-starting-aead-ocb-decryptio">
<a class="section-number selfRef" href="#appendix-A.10.2">A.10.2. </a><a class="section-name selfRef" href="#name-starting-aead-ocb-decryptio">Starting AEAD-OCB Decryption of the Session Key</a>
          </h4>
<p id="appendix-A.10.2-1">The derived key is:<a class="pilcrow" href="#appendix-A.10.2-1">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.10.2-2">
<pre>  e8 0d e2 43 a3 62 d9 3b 9d c6 07 ed e9 6a 73 56
</pre><a class="pilcrow" href="#appendix-A.10.2-2">¶</a>
</div>
<p id="appendix-A.10.2-3">HKDF info:<a class="pilcrow" href="#appendix-A.10.2-3">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.10.2-4">
<pre>  c3 06 07 02
</pre><a class="pilcrow" href="#appendix-A.10.2-4">¶</a>
</div>
<p id="appendix-A.10.2-5">HKDF output:<a class="pilcrow" href="#appendix-A.10.2-5">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.10.2-6">
<pre>  38 a9 b3 45 b5 68 0b b6 1b b6 5d 73 ee c7 ec d9
</pre><a class="pilcrow" href="#appendix-A.10.2-6">¶</a>
</div>
<p id="appendix-A.10.2-7">Authenticated Data:<a class="pilcrow" href="#appendix-A.10.2-7">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.10.2-8">
<pre>  c3 06 07 02
</pre><a class="pilcrow" href="#appendix-A.10.2-8">¶</a>
</div>
<p id="appendix-A.10.2-9">Nonce:<a class="pilcrow" href="#appendix-A.10.2-9">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.10.2-10">
<pre>  cf cc 5c 11 66 4e db 9d b4 25 90 d7 dc 46 b0
</pre><a class="pilcrow" href="#appendix-A.10.2-10">¶</a>
</div>
<p id="appendix-A.10.2-11">Decrypted session key:<a class="pilcrow" href="#appendix-A.10.2-11">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.10.2-12">
<pre>  28 e7 9a b8 23 97 d3 c6 3d e2 4a c2 17 d7 b7 91
</pre><a class="pilcrow" href="#appendix-A.10.2-12">¶</a>
</div>
</section>
</div>
<div id="sample-v2-seipd-packet-2">
<section id="appendix-A.10.3">
          <h4 id="name-sample-v2-seipd-packet-3">
<a class="section-number selfRef" href="#appendix-A.10.3">A.10.3. </a><a class="section-name selfRef" href="#name-sample-v2-seipd-packet-3">Sample v2 SEIPD Packet</a>
          </h4>
<p id="appendix-A.10.3-1">This packet contains the following series of octets:<a class="pilcrow" href="#appendix-A.10.3-1">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.10.3-2">
<pre>0x0000  d2 69 02 07 02 06 20 a6
0x0008  61 f7 31 fc 9a 30 32 b5
0x0010  62 33 26 02 7e 3a 5d 8d
0x0018  b5 74 8e be ff 0b 0c 59
0x0020  10 d0 9e cd d6 41 ff 9f
0x0028  d3 85 62 75 80 35 bc 49
0x0030  75 4c e1 bf 3f ff a7 da
0x0038  d0 a3 b8 10 4f 51 33 cf
0x0040  42 a4 10 0a 83 ee f4 ca
0x0048  1b 48 01 a8 84 6b f4 2b
0x0050  cd a7 c8 ce 9d 65 e2 12
0x0058  f3 01 cb cd 98 fd ca de
0x0060  69 4a 87 7a d4 24 73 23
0x0068  f6 e8 57
</pre><a class="pilcrow" href="#appendix-A.10.3-2">¶</a>
</div>
<p id="appendix-A.10.3-3">The same data, broken out by octet and semantics, is:<a class="pilcrow" href="#appendix-A.10.3-3">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.10.3-4">
<pre>0x0000  d2                       packet type: SEIPD
0x0001     69                    packet length
0x0002        02                 v2 SEIPD
0x0003           07              cipher: AES128
0x0004              02           AEAD mode: OCB
0x0005                 06        chunk size (2^12 octets)
0x0006                    20 a6  salt
0x0008  61 f7 31 fc 9a 30 32 b5
0x0010  62 33 26 02 7e 3a 5d 8d
0x0018  b5 74 8e be ff 0b 0c 59
0x0020  10 d0 9e cd d6 41
0x0026                    ff 9f  chunk #0 encrypted data
0x0028  d3 85 62 75 80 35 bc 49
0x0030  75 4c e1 bf 3f ff a7 da
0x0038  d0 a3 b8 10 4f 51 33 cf
0x0040  42 a4 10 0a 83 ee f4 ca
0x0048  1b 48 01
0x004b           a8 84 6b f4 2b  chunk #0 authentication tag
0x0050  cd a7 c8 ce 9d 65 e2 12
0x0058  f3 01 cb
0x005b           cd 98 fd ca de  final AEAD tag (#1)
0x0060  69 4a 87 7a d4 24 73 23
0x0068  f6 e8 57
</pre><a class="pilcrow" href="#appendix-A.10.3-4">¶</a>
</div>
</section>
</div>
<div id="decryption-of-data-2">
<section id="appendix-A.10.4">
          <h4 id="name-decryption-of-data-3">
<a class="section-number selfRef" href="#appendix-A.10.4">A.10.4. </a><a class="section-name selfRef" href="#name-decryption-of-data-3">Decryption of Data</a>
          </h4>
<p id="appendix-A.10.4-1">Starting AEAD-OCB decryption of data, using the session key.<a class="pilcrow" href="#appendix-A.10.4-1">¶</a></p>
<p id="appendix-A.10.4-2">HKDF info:<a class="pilcrow" href="#appendix-A.10.4-2">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.10.4-3">
<pre>  d2 02 07 02 06
</pre><a class="pilcrow" href="#appendix-A.10.4-3">¶</a>
</div>
<p id="appendix-A.10.4-4">HKDF output:<a class="pilcrow" href="#appendix-A.10.4-4">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.10.4-5">
<pre>  71 66 2a 11 ee 5b 4e 08 14 4e 6d e8 83 a0 09 99
  eb de 12 bb 57 0d cf
</pre><a class="pilcrow" href="#appendix-A.10.4-5">¶</a>
</div>
<p id="appendix-A.10.4-6">Message key:<a class="pilcrow" href="#appendix-A.10.4-6">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.10.4-7">
<pre>  71 66 2a 11 ee 5b 4e 08 14 4e 6d e8 83 a0 09 99
</pre><a class="pilcrow" href="#appendix-A.10.4-7">¶</a>
</div>
<p id="appendix-A.10.4-8">Initialization vector:<a class="pilcrow" href="#appendix-A.10.4-8">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.10.4-9">
<pre>  eb de 12 bb 57 0d cf
</pre><a class="pilcrow" href="#appendix-A.10.4-9">¶</a>
</div>
<p id="appendix-A.10.4-10">Chunk #0:<a class="pilcrow" href="#appendix-A.10.4-10">¶</a></p>
<p id="appendix-A.10.4-11">Nonce:<a class="pilcrow" href="#appendix-A.10.4-11">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.10.4-12">
<pre>  eb de 12 bb 57 0d cf 00 00 00 00 00 00 00 00
</pre><a class="pilcrow" href="#appendix-A.10.4-12">¶</a>
</div>
<p id="appendix-A.10.4-13">Additional authenticated data:<a class="pilcrow" href="#appendix-A.10.4-13">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.10.4-14">
<pre>  d2 02 07 02 06
</pre><a class="pilcrow" href="#appendix-A.10.4-14">¶</a>
</div>
<p id="appendix-A.10.4-15">Decrypted chunk #0.<a class="pilcrow" href="#appendix-A.10.4-15">¶</a></p>
<p id="appendix-A.10.4-16">Literal Data packet with the string contents <code>Hello, world!</code>:<a class="pilcrow" href="#appendix-A.10.4-16">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.10.4-17">
<pre>  cb 13 62 00 00 00 00 00 48 65 6c 6c 6f 2c 20 77
  6f 72 6c 64 21
</pre><a class="pilcrow" href="#appendix-A.10.4-17">¶</a>
</div>
<p id="appendix-A.10.4-18">Padding packet:<a class="pilcrow" href="#appendix-A.10.4-18">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.10.4-19">
<pre>  d5 0e ae 6a a1 64 9b 56 aa 83 5b 26 13 90 2b d2
</pre><a class="pilcrow" href="#appendix-A.10.4-19">¶</a>
</div>
<p id="appendix-A.10.4-20">Authenticating final tag:<a class="pilcrow" href="#appendix-A.10.4-20">¶</a></p>
<p id="appendix-A.10.4-21">Final nonce:<a class="pilcrow" href="#appendix-A.10.4-21">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.10.4-22">
<pre>  eb de 12 bb 57 0d cf 00 00 00 00 00 00 00 01
</pre><a class="pilcrow" href="#appendix-A.10.4-22">¶</a>
</div>
<p id="appendix-A.10.4-23">Final additional authenticated data:<a class="pilcrow" href="#appendix-A.10.4-23">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.10.4-24">
<pre>  d2 02 07 02 06 00 00 00 00 00 00 00 25
</pre><a class="pilcrow" href="#appendix-A.10.4-24">¶</a>
</div>
</section>
</div>
<div id="complete-aead-ocb-encrypted-packet-sequence">
<section id="appendix-A.10.5">
          <h4 id="name-complete-aead-ocb-encrypted">
<a class="section-number selfRef" href="#appendix-A.10.5">A.10.5. </a><a class="section-name selfRef" href="#name-complete-aead-ocb-encrypted">Complete AEAD-OCB Encrypted Packet Sequence</a>
          </h4>
<div class="lang-application/pgp-encrypted sourcecode" id="appendix-A.10.5-1">
<pre>-----BEGIN PGP MESSAGE-----

wz8GHQcCCwMIVqKY0vXjZFP/z8xcEWZO2520JZDX3EawckG2EsOBLP/76gDyNHsl
ZBEj+IeuYNT9YU4IN9gZ02zSaQIHAgYgpmH3MfyaMDK1YjMmAn46XY21dI6+/wsM
WRDQns3WQf+f04VidYA1vEl1TOG/P/+n2tCjuBBPUTPPQqQQCoPu9MobSAGohGv0
K82nyM6dZeIS8wHLzZj9yt5pSod61CRzI/boVw==
-----END PGP MESSAGE-----
</pre><a class="pilcrow" href="#appendix-A.10.5-1">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="sample-aead-gcm-encryption-and-decryption">
<section id="appendix-A.11">
        <h3 id="name-sample-aead-gcm-encryption-">
<a class="section-number selfRef" href="#appendix-A.11">A.11. </a><a class="section-name selfRef" href="#name-sample-aead-gcm-encryption-">Sample AEAD-GCM Encryption and Decryption</a>
        </h3>
<p id="appendix-A.11-1">This example encrypts the cleartext string <code>Hello, world!</code> with the passphrase <code>password</code>, using AES-128 with AEAD-GCM encryption.<a class="pilcrow" href="#appendix-A.11-1">¶</a></p>
<div id="sample-symmetric-key-encrypted-session-key-packet-v6-2">
<section id="appendix-A.11.1">
          <h4 id="name-sample-version-6-symmetric-ke">
<a class="section-number selfRef" href="#appendix-A.11.1">A.11.1. </a><a class="section-name selfRef" href="#name-sample-version-6-symmetric-ke">Sample Version 6 Symmetric Key Encrypted Session Key Packet</a>
          </h4>
<p id="appendix-A.11.1-1">This packet contains the following series of octets:<a class="pilcrow" href="#appendix-A.11.1-1">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.11.1-2">
<pre>0x0000  c3 3c 06 1a 07 03 0b 03
0x0008  08 e9 d3 97 85 b2 07 00
0x0010  08 ff b4 2e 7c 48 3e f4
0x0018  88 44 57 cb 37 26 b9 b3
0x0020  db 9f f7 76 e5 f4 d9 a4
0x0028  09 52 e2 44 72 98 85 1a
0x0030  bf ff 75 26 df 2d d5 54
0x0038  41 75 79 a7 79 9f
</pre><a class="pilcrow" href="#appendix-A.11.1-2">¶</a>
</div>
<p id="appendix-A.11.1-3">The same data, broken out by octet and semantics, is:<a class="pilcrow" href="#appendix-A.11.1-3">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.11.1-4">
<pre>0x0000  c3                       packet type: SKESK
0x0001     3c                    packet length
0x0002        06                 v6 SKESK
0x0003           1a              length through end of AEAD nonce
0x0004              07           cipher: AES128
0x0005                 03        AEAD mode: GCM
0x0006                    0b     length of S2K
0x0007                       03  S2K type: iterated+salted
0x0008  08                       S2K hash: SHA2-256
0x0009     e9 d3 97 85 b2 07 00  S2K salt
0x0010  08
0x0011     ff                    S2K iterations (65011712 octets)
0x0012        b4 2e 7c 48 3e f4  AEAD nonce
0x0018  88 44 57 cb 37 26
0x001e                    b9 b3  encrypted session key
0x0020  db 9f f7 76 e5 f4 d9 a4
0x0028  09 52 e2 44 72 98
0x002e                     85 1a  AEAD tag
0x0030  bf ff 75 26 df 2d d5 54
0x0038  41 75 79 a7 79 9f
</pre><a class="pilcrow" href="#appendix-A.11.1-4">¶</a>
</div>
</section>
</div>
<div id="starting-aead-gcm-decryption-of-the-session-key">
<section id="appendix-A.11.2">
          <h4 id="name-starting-aead-gcm-decryptio">
<a class="section-number selfRef" href="#appendix-A.11.2">A.11.2. </a><a class="section-name selfRef" href="#name-starting-aead-gcm-decryptio">Starting AEAD-GCM Decryption of the Session Key</a>
          </h4>
<p id="appendix-A.11.2-1">The derived key is:<a class="pilcrow" href="#appendix-A.11.2-1">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.11.2-2">
<pre>  25 02 81 71 5b ba 78 28 ef 71 ef 64 c4 78 47 53
</pre><a class="pilcrow" href="#appendix-A.11.2-2">¶</a>
</div>
<p id="appendix-A.11.2-3">HKDF info:<a class="pilcrow" href="#appendix-A.11.2-3">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.11.2-4">
<pre>  c3 06 07 03
</pre><a class="pilcrow" href="#appendix-A.11.2-4">¶</a>
</div>
<p id="appendix-A.11.2-5">HKDF output:<a class="pilcrow" href="#appendix-A.11.2-5">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.11.2-6">
<pre>  7a 6f 9a b7 f9 9f 7e f8 db ef 84 1c 65 08 00 f5
</pre><a class="pilcrow" href="#appendix-A.11.2-6">¶</a>
</div>
<p id="appendix-A.11.2-7">Authenticated Data:<a class="pilcrow" href="#appendix-A.11.2-7">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.11.2-8">
<pre>  c3 06 07 03
</pre><a class="pilcrow" href="#appendix-A.11.2-8">¶</a>
</div>
<p id="appendix-A.11.2-9">Nonce:<a class="pilcrow" href="#appendix-A.11.2-9">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.11.2-10">
<pre>  b4 2e 7c 48 3e f4 88 44 57 cb 37 26
</pre><a class="pilcrow" href="#appendix-A.11.2-10">¶</a>
</div>
<p id="appendix-A.11.2-11">Decrypted session key:<a class="pilcrow" href="#appendix-A.11.2-11">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.11.2-12">
<pre>  19 36 fc 85 68 98 02 74 bb 90 0d 83 19 36 0c 77
</pre><a class="pilcrow" href="#appendix-A.11.2-12">¶</a>
</div>
</section>
</div>
<div id="sample-v2-seipd-packet-3">
<section id="appendix-A.11.3">
          <h4 id="name-sample-v2-seipd-packet-4">
<a class="section-number selfRef" href="#appendix-A.11.3">A.11.3. </a><a class="section-name selfRef" href="#name-sample-v2-seipd-packet-4">Sample v2 SEIPD Packet</a>
          </h4>
<p id="appendix-A.11.3-1">This packet contains the following series of octets, is:<a class="pilcrow" href="#appendix-A.11.3-1">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.11.3-2">
<pre>0x0000  d2 69 02 07 03 06 fc b9
0x0008  44 90 bc b9 8b bd c9 d1
0x0010  06 c6 09 02 66 94 0f 72
0x0018  e8 9e dc 21 b5 59 6b 15
0x0020  76 b1 01 ed 0f 9f fc 6f
0x0028  c6 d6 5b bf d2 4d cd 07
0x0030  90 96 6e 6d 1e 85 a3 00
0x0038  53 78 4c b1 d8 b6 a0 69
0x0040  9e f1 21 55 a7 b2 ad 62
0x0048  58 53 1b 57 65 1f d7 77
0x0050  79 12 fa 95 e3 5d 9b 40
0x0058  21 6f 69 a4 c2 48 db 28
0x0060  ff 43 31 f1 63 29 07 39
0x0068  9e 6f f9
</pre><a class="pilcrow" href="#appendix-A.11.3-2">¶</a>
</div>
<p id="appendix-A.11.3-3">The same data, broken out by octet and semantics, is:<a class="pilcrow" href="#appendix-A.11.3-3">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.11.3-4">
<pre>0x0000  d2                       packet type: SEIPD
0x0001     69                    packet length
0x0002        02                 v2 SEIPD
0x0003           07              cipher: AES128
0x0004              03           AEAD mode: GCM
0x0005                 06        chunk size (2^12 octets)
0x0006                    fc b9  salt
0x0008  44 90 bc b9 8b bd c9 d1
0x0010  06 c6 09 02 66 94 0f 72
0x0018  e8 9e dc 21 b5 59 6b 15
0x0020  76 b1 01 ed 0f 9f
0x0026                    fc 6f  chunk #0 encrypted data
0x0028  c6 d6 5b bf d2 4d cd 07
0x0030  90 96 6e 6d 1e 85 a3 00
0x0038  53 78 4c b1 d8 b6 a0 69
0x0040  9e f1 21 55 a7 b2 ad 62
0x0048  58 53 1b
0x004b           57 65 1f d7 77  chunk #0 authentication tag
0x0050  79 12 fa 95 e3 5d 9b 40
0x0058  21 6f 69
0x005b           a4 c2 48 db 28  final AEAD tag (#1)
0x0060  ff 43 31 f1 63 29 07 39
0x0068  9e 6f f9
</pre><a class="pilcrow" href="#appendix-A.11.3-4">¶</a>
</div>
</section>
</div>
<div id="decryption-of-data-3">
<section id="appendix-A.11.4">
          <h4 id="name-decryption-of-data-4">
<a class="section-number selfRef" href="#appendix-A.11.4">A.11.4. </a><a class="section-name selfRef" href="#name-decryption-of-data-4">Decryption of Data</a>
          </h4>
<p id="appendix-A.11.4-1">Starting AEAD-GCM decryption of data, using the session key.<a class="pilcrow" href="#appendix-A.11.4-1">¶</a></p>
<p id="appendix-A.11.4-2">HKDF info:<a class="pilcrow" href="#appendix-A.11.4-2">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.11.4-3">
<pre>  d2 02 07 03 06
</pre><a class="pilcrow" href="#appendix-A.11.4-3">¶</a>
</div>
<p id="appendix-A.11.4-4">HKDF output:<a class="pilcrow" href="#appendix-A.11.4-4">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.11.4-5">
<pre>  ea 14 38 80 3c b8 a4 77 40 ce 9b 54 c3 38 77 8d
  4d 2b dc 2b
</pre><a class="pilcrow" href="#appendix-A.11.4-5">¶</a>
</div>
<p id="appendix-A.11.4-6">Message key:<a class="pilcrow" href="#appendix-A.11.4-6">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.11.4-7">
<pre>  ea 14 38 80 3c b8 a4 77 40 ce 9b 54 c3 38 77 8d
</pre><a class="pilcrow" href="#appendix-A.11.4-7">¶</a>
</div>
<p id="appendix-A.11.4-8">Initialization vector:<a class="pilcrow" href="#appendix-A.11.4-8">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.11.4-9">
<pre>  4d 2b dc 2b
</pre><a class="pilcrow" href="#appendix-A.11.4-9">¶</a>
</div>
<p id="appendix-A.11.4-10">Chunk #0:<a class="pilcrow" href="#appendix-A.11.4-10">¶</a></p>
<p id="appendix-A.11.4-11">Nonce:<a class="pilcrow" href="#appendix-A.11.4-11">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.11.4-12">
<pre>  4d 2b dc 2b 00 00 00 00 00 00 00 00
</pre><a class="pilcrow" href="#appendix-A.11.4-12">¶</a>
</div>
<p id="appendix-A.11.4-13">Additional authenticated data:<a class="pilcrow" href="#appendix-A.11.4-13">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.11.4-14">
<pre>  d2 02 07 03 06
</pre><a class="pilcrow" href="#appendix-A.11.4-14">¶</a>
</div>
<p id="appendix-A.11.4-15">Decrypted chunk #0.<a class="pilcrow" href="#appendix-A.11.4-15">¶</a></p>
<p id="appendix-A.11.4-16">Literal Data packet with the string contents <code>Hello, world!</code>:<a class="pilcrow" href="#appendix-A.11.4-16">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.11.4-17">
<pre>  cb 13 62 00 00 00 00 00 48 65 6c 6c 6f 2c 20 77
  6f 72 6c 64 21
</pre><a class="pilcrow" href="#appendix-A.11.4-17">¶</a>
</div>
<p id="appendix-A.11.4-18">Padding packet:<a class="pilcrow" href="#appendix-A.11.4-18">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.11.4-19">
<pre>  d5 0e 1c e2 26 9a 9e dd ef 81 03 21 72 b7 ed 7c
</pre><a class="pilcrow" href="#appendix-A.11.4-19">¶</a>
</div>
<p id="appendix-A.11.4-20">Authenticating final tag:<a class="pilcrow" href="#appendix-A.11.4-20">¶</a></p>
<p id="appendix-A.11.4-21">Final nonce:<a class="pilcrow" href="#appendix-A.11.4-21">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.11.4-22">
<pre>  4d 2b dc 2b 00 00 00 00 00 00 00 01
</pre><a class="pilcrow" href="#appendix-A.11.4-22">¶</a>
</div>
<p id="appendix-A.11.4-23">Final additional authenticated data:<a class="pilcrow" href="#appendix-A.11.4-23">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.11.4-24">
<pre>  d2 02 07 03 06 00 00 00 00 00 00 00 25
</pre><a class="pilcrow" href="#appendix-A.11.4-24">¶</a>
</div>
</section>
</div>
<div id="complete-aead-gcm-encrypted-packet-sequence">
<section id="appendix-A.11.5">
          <h4 id="name-complete-aead-gcm-encrypted">
<a class="section-number selfRef" href="#appendix-A.11.5">A.11.5. </a><a class="section-name selfRef" href="#name-complete-aead-gcm-encrypted">Complete AEAD-GCM Encrypted Packet Sequence</a>
          </h4>
<div class="lang-application/pgp-encrypted sourcecode" id="appendix-A.11.5-1">
<pre>-----BEGIN PGP MESSAGE-----

wzwGGgcDCwMI6dOXhbIHAAj/tC58SD70iERXyzcmubPbn/d25fTZpAlS4kRymIUa
v/91Jt8t1VRBdXmneZ/SaQIHAwb8uUSQvLmLvcnRBsYJAmaUD3LontwhtVlrFXax
Ae0Pn/xvxtZbv9JNzQeQlm5tHoWjAFN4TLHYtqBpnvEhVaeyrWJYUxtXZR/Xd3kS
+pXjXZtAIW9ppMJI2yj/QzHxYykHOZ5v+Q==
-----END PGP MESSAGE-----
</pre><a class="pilcrow" href="#appendix-A.11.5-1">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="sample-messages-encrypted-using-argon2">
<section id="appendix-A.12">
        <h3 id="name-sample-messages-encrypted-u">
<a class="section-number selfRef" href="#appendix-A.12">A.12. </a><a class="section-name selfRef" href="#name-sample-messages-encrypted-u">Sample Messages Encrypted Using Argon2</a>
        </h3>
<p id="appendix-A.12-1">These messages are the literal data <code>Hello, world!</code> encrypted using v1 SEIPD, with Argon2 and the passphrase "password", using different session key sizes. In each example, the choice of symmetric cipher is the same in both the v4 SKESK packet and v1 SEIPD packet. In all cases, the Argon2 parameters are t = 1, p = 4, and m = 21.<a class="pilcrow" href="#appendix-A.12-1">¶</a></p>
<div id="version-4-skesk-using-argon2-with-aes-128">
<section id="appendix-A.12.1">
          <h4 id="name-v4-skesk-using-argon2-with-">
<a class="section-number selfRef" href="#appendix-A.12.1">A.12.1. </a><a class="section-name selfRef" href="#name-v4-skesk-using-argon2-with-">V4 SKESK Using Argon2 with AES-128</a>
          </h4>
<div class="lang-application/pgp-encrypted sourcecode" id="appendix-A.12.1-1">
<pre>-----BEGIN PGP MESSAGE-----
Comment: Encrypted using AES with 128-bit key
Comment: Session key: 01FE16BBACFD1E7B78EF3B865187374F

wycEBwScUvg8J/leUNU1RA7N/zE2AQQVnlL8rSLPP5VlQsunlO+ECxHSPgGYGKY+
YJz4u6F+DDlDBOr5NRQXt/KJIf4m4mOlKyC/uqLbpnLJZMnTq3o79GxBTdIdOzhH
XfA3pqV4mTzF
-----END PGP MESSAGE-----
</pre><a class="pilcrow" href="#appendix-A.12.1-1">¶</a>
</div>
</section>
</div>
<div id="version-4-skesk-using-argon2-with-aes-192">
<section id="appendix-A.12.2">
          <h4 id="name-v4-skesk-using-argon2-with-a">
<a class="section-number selfRef" href="#appendix-A.12.2">A.12.2. </a><a class="section-name selfRef" href="#name-v4-skesk-using-argon2-with-a">V4 SKESK Using Argon2 with AES-192</a>
          </h4>
<div class="lang-application/pgp-encrypted sourcecode" id="appendix-A.12.2-1">
<pre>-----BEGIN PGP MESSAGE-----
Comment: Encrypted using AES with 192-bit key
Comment: Session key: 27006DAE68E509022CE45A14E569E91001C2955...
Comment: Session key: ...AF8DFE194

wy8ECAThTKxHFTRZGKli3KNH4UP4AQQVhzLJ2va3FG8/pmpIPd/H/mdoVS5VBLLw
F9I+AdJ1Sw56PRYiKZjCvHg+2bnq02s33AJJoyBexBI4QKATFRkyez2gldJldRys
LVg77Mwwfgl2n/d572WciAM=
-----END PGP MESSAGE-----
</pre><a class="pilcrow" href="#appendix-A.12.2-1">¶</a>
</div>
</section>
</div>
<div id="version-4-skesk-using-argon2-with-aes-256">
<section id="appendix-A.12.3">
          <h4 id="name-v4-skesk-using-argon2-with-ae">
<a class="section-number selfRef" href="#appendix-A.12.3">A.12.3. </a><a class="section-name selfRef" href="#name-v4-skesk-using-argon2-with-ae">V4 SKESK Using Argon2 with AES-256</a>
          </h4>
<div class="lang-application/pgp-encrypted sourcecode" id="appendix-A.12.3-1">
<pre>-----BEGIN PGP MESSAGE-----
Comment: Encrypted using AES with 256-bit key
Comment: Session key: BBEDA55B9AAE63DAC45D4F49D89DACF4AF37FEF...
Comment: Session key: ...C13BAB2F1F8E18FB74580D8B0

wzcECQS4eJUgIG/3mcaILEJFpmJ8AQQVnZ9l7KtagdClm9UaQ/Z6M/5roklSGpGu
623YmaXezGj80j4B+Ku1sgTdJo87X1Wrup7l0wJypZls21Uwd67m9koF60eefH/K
95D1usliXOEm8ayQJQmZrjf6K6v9PWwqMQ==
-----END PGP MESSAGE-----
</pre><a class="pilcrow" href="#appendix-A.12.3-1">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="upgrade-guidance">
<section id="appendix-B">
      <h2 id="name-upgrade-guidance-adapting-i">
<a class="section-number selfRef" href="#appendix-B">Appendix B. </a><a class="section-name selfRef" href="#name-upgrade-guidance-adapting-i">Upgrade Guidance (Adapting Implementations from RFCs 4880 and 6637)</a>
      </h2>
<p id="appendix-B-1">This subsection offers a concise, non-normative summary of the substantial additions to and departures from <span>[<a class="cite xref" href="#RFC4880">RFC4880</a>]</span> and <span>[<a class="cite xref" href="#RFC6637">RFC6637</a>]</span>.
It is intended to help implementers who are augmenting an existing implementation from those specifications to comply with this specification. Cryptographic algorithms marked with "MTI" are mandatory to implement.<a class="pilcrow" href="#appendix-B-1">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-2.1">
          <p id="appendix-B-2.1.1">Public Key Signing Algorithms:<a class="pilcrow" href="#appendix-B-2.1.1">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-2.1.2.1">
              <p id="appendix-B-2.1.2.1.1">Ed25519 (Sections <a class="auto internal xref" href="#key-ed25519">5.5.5.9</a> and <a class="auto internal xref" href="#sig-ed25519">5.2.3.4</a>) -- MTI<a class="pilcrow" href="#appendix-B-2.1.2.1.1">¶</a></p>
</li>
            <li class="normal" id="appendix-B-2.1.2.2">
              <p id="appendix-B-2.1.2.2.1">Ed448 (Sections <a class="auto internal xref" href="#key-ed448">5.5.5.10</a> and <a class="auto internal xref" href="#sig-ed448">5.2.3.5</a>)<a class="pilcrow" href="#appendix-B-2.1.2.2.1">¶</a></p>
</li>
            <li class="normal" id="appendix-B-2.1.2.3">
              <p id="appendix-B-2.1.2.3.1">EdDSALegacy with Ed25519Legacy (Sections <a class="auto internal xref" href="#key-eddsa-legacy">5.5.5.5</a> and <a class="auto internal xref" href="#sig-eddsa-legacy">5.2.3.3</a>)<a class="pilcrow" href="#appendix-B-2.1.2.3.1">¶</a></p>
</li>
            <li class="normal" id="appendix-B-2.1.2.4">
              <p id="appendix-B-2.1.2.4.1">ECDSA with Brainpool curves (<a class="auto internal xref" href="#ec-curves">Section 9.2</a>)<a class="pilcrow" href="#appendix-B-2.1.2.4.1">¶</a></p>
</li>
          </ul>
</li>
        <li class="normal" id="appendix-B-2.2">
          <p id="appendix-B-2.2.1">Public Key Encryption Algorithms:<a class="pilcrow" href="#appendix-B-2.2.1">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-2.2.2.1">
              <p id="appendix-B-2.2.2.1.1">X25519 (Sections <a class="auto internal xref" href="#key-x25519">5.5.5.7</a> and <a class="auto internal xref" href="#pkesk-x25519">5.1.6</a>) -- MTI<a class="pilcrow" href="#appendix-B-2.2.2.1.1">¶</a></p>
</li>
            <li class="normal" id="appendix-B-2.2.2.2">
              <p id="appendix-B-2.2.2.2.1">X448 (Sections <a class="auto internal xref" href="#key-x448">5.5.5.8</a> and <a class="auto internal xref" href="#pkesk-x448">5.1.7</a>)<a class="pilcrow" href="#appendix-B-2.2.2.2.1">¶</a></p>
</li>
            <li class="normal" id="appendix-B-2.2.2.3">
              <p id="appendix-B-2.2.2.3.1">ECDH with Curve25519Legacy (<a class="auto internal xref" href="#ec-curves">Section 9.2</a>)<a class="pilcrow" href="#appendix-B-2.2.2.3.1">¶</a></p>
</li>
            <li class="normal" id="appendix-B-2.2.2.4">
              <p id="appendix-B-2.2.2.4.1">ECDH with Brainpool curves (<a class="auto internal xref" href="#ec-curves">Section 9.2</a>)<a class="pilcrow" href="#appendix-B-2.2.2.4.1">¶</a></p>
</li>
          </ul>
</li>
        <li class="normal" id="appendix-B-2.3">
          <p id="appendix-B-2.3.1">AEAD Encryption:<a class="pilcrow" href="#appendix-B-2.3.1">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-2.3.2.1">
              <p id="appendix-B-2.3.2.1.1">V2 SEIPD (<a class="auto internal xref" href="#version-two-seipd">Section 5.13.2</a>)<a class="pilcrow" href="#appendix-B-2.3.2.1.1">¶</a></p>
</li>
            <li class="normal" id="appendix-B-2.3.2.2">
              <p id="appendix-B-2.3.2.2.1">AEAD modes:<a class="pilcrow" href="#appendix-B-2.3.2.2.1">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-2.3.2.2.2.1">
                  <p id="appendix-B-2.3.2.2.2.1.1">OCB mode (<a class="auto internal xref" href="#aead-mode-ocb">Section 5.13.4</a>) -- MTI<a class="pilcrow" href="#appendix-B-2.3.2.2.2.1.1">¶</a></p>
</li>
                <li class="normal" id="appendix-B-2.3.2.2.2.2">
                  <p id="appendix-B-2.3.2.2.2.2.1">EAX mode (<a class="auto internal xref" href="#aead-mode-eax">Section 5.13.3</a>)<a class="pilcrow" href="#appendix-B-2.3.2.2.2.2.1">¶</a></p>
</li>
                <li class="normal" id="appendix-B-2.3.2.2.2.3">
                  <p id="appendix-B-2.3.2.2.2.3.1">GCM mode (<a class="auto internal xref" href="#aead-mode-gcm">Section 5.13.5</a>)<a class="pilcrow" href="#appendix-B-2.3.2.2.2.3.1">¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="appendix-B-2.3.2.3">
              <p id="appendix-B-2.3.2.3.1">V6 PKESK (<a class="auto internal xref" href="#v6-pkesk">Section 5.1.2</a>)<a class="pilcrow" href="#appendix-B-2.3.2.3.1">¶</a></p>
</li>
            <li class="normal" id="appendix-B-2.3.2.4">
              <p id="appendix-B-2.3.2.4.1">V6 SKESK (<a class="auto internal xref" href="#v6-skesk">Section 5.3.2</a>)<a class="pilcrow" href="#appendix-B-2.3.2.4.1">¶</a></p>
</li>
            <li class="normal" id="appendix-B-2.3.2.5">
              <p id="appendix-B-2.3.2.5.1">Features signature subpacket: add flag for v2 SEIPD (<a class="auto internal xref" href="#features-subpacket">Section 5.2.3.32</a>)<a class="pilcrow" href="#appendix-B-2.3.2.5.1">¶</a></p>
</li>
            <li class="normal" id="appendix-B-2.3.2.6">
              <p id="appendix-B-2.3.2.6.1">Signature Subpacket: Preferred AEAD Ciphersuites (<a class="auto internal xref" href="#preferred-v2-seipd">Section 5.2.3.15</a>)<a class="pilcrow" href="#appendix-B-2.3.2.6.1">¶</a></p>
</li>
            <li class="normal" id="appendix-B-2.3.2.7">
              <p id="appendix-B-2.3.2.7.1">Secret key encryption: AEAD "S2K usage octet" (Sections <a class="auto internal xref" href="#s2k-usage-octet">3.7.2</a> and <a class="auto internal xref" href="#secret-key-packet-formats">5.5.3</a>)<a class="pilcrow" href="#appendix-B-2.3.2.7.1">¶</a></p>
</li>
          </ul>
</li>
        <li class="normal" id="appendix-B-2.4">
          <p id="appendix-B-2.4.1">Version 6 Keys and Signatures:<a class="pilcrow" href="#appendix-B-2.4.1">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-2.4.2.1">
              <p id="appendix-B-2.4.2.1.1">Version 6 Public Keys (<a class="auto internal xref" href="#v6-pubkeys">Section 5.5.2.3</a>)<a class="pilcrow" href="#appendix-B-2.4.2.1.1">¶</a></p>
</li>
            <li class="normal" id="appendix-B-2.4.2.2">
              <p id="appendix-B-2.4.2.2.1">Version 6 Fingerprint and Key ID (<a class="auto internal xref" href="#v6-key-id-fingerprint">Section 5.5.4.3</a>)<a class="pilcrow" href="#appendix-B-2.4.2.2.1">¶</a></p>
</li>
            <li class="normal" id="appendix-B-2.4.2.3">
              <p id="appendix-B-2.4.2.3.1">Version 6 Secret Keys (<a class="auto internal xref" href="#secret-key-packet-formats">Section 5.5.3</a>)<a class="pilcrow" href="#appendix-B-2.4.2.3.1">¶</a></p>
</li>
            <li class="normal" id="appendix-B-2.4.2.4">
              <p id="appendix-B-2.4.2.4.1">Version 6 Signatures (<a class="auto internal xref" href="#version-four-and-six-sig">Section 5.2.3</a>)<a class="pilcrow" href="#appendix-B-2.4.2.4.1">¶</a></p>
</li>
            <li class="normal" id="appendix-B-2.4.2.5">
              <p id="appendix-B-2.4.2.5.1">Version 6 One-Pass Signatures (<a class="auto internal xref" href="#one-pass-sig">Section 5.4</a>)<a class="pilcrow" href="#appendix-B-2.4.2.5.1">¶</a></p>
</li>
          </ul>
</li>
        <li class="normal" id="appendix-B-2.5">
          <p id="appendix-B-2.5.1">Certificate (Transferable Public Key) Structure:<a class="pilcrow" href="#appendix-B-2.5.1">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-2.5.2.1">
              <p id="appendix-B-2.5.2.1.1">Preferences subpackets in Direct Key signatures (<a class="auto internal xref" href="#self-sigs">Section 5.2.3.10</a>)<a class="pilcrow" href="#appendix-B-2.5.2.1.1">¶</a></p>
</li>
            <li class="normal" id="appendix-B-2.5.2.2">
              <p id="appendix-B-2.5.2.2.1">Self-verifying revocation certificate (<a class="auto internal xref" href="#v6-revocation-certificate">Section 10.1.2</a>)<a class="pilcrow" href="#appendix-B-2.5.2.2.1">¶</a></p>
</li>
            <li class="normal" id="appendix-B-2.5.2.3">
              <p id="appendix-B-2.5.2.3.1">User ID is explicitly optional (<a class="auto internal xref" href="#v6-certificate-structures">Section 10.1.1</a>)<a class="pilcrow" href="#appendix-B-2.5.2.3.1">¶</a></p>
</li>
          </ul>
</li>
        <li class="normal" id="appendix-B-2.6">
          <p id="appendix-B-2.6.1">S2K: Argon2 (<a class="auto internal xref" href="#s2k-argon2">Section 3.7.1.4</a>)<a class="pilcrow" href="#appendix-B-2.6.1">¶</a></p>
</li>
        <li class="normal" id="appendix-B-2.7">
          <p id="appendix-B-2.7.1">Subpacket: Intended Recipient Fingerprint (<a class="auto internal xref" href="#intended-recipient-fingerprint">Section 5.2.3.36</a>)<a class="pilcrow" href="#appendix-B-2.7.1">¶</a></p>
</li>
        <li class="normal" id="appendix-B-2.8">
          <p id="appendix-B-2.8.1">Digest Algorithms: SHA3-256 and SHA3-512 (<a class="auto internal xref" href="#hash-algos">Section 9.5</a>)<a class="pilcrow" href="#appendix-B-2.8.1">¶</a></p>
</li>
        <li class="normal" id="appendix-B-2.9">
          <p id="appendix-B-2.9.1">Packet: Padding (<a class="auto internal xref" href="#padding-packet">Section 5.14</a>)<a class="pilcrow" href="#appendix-B-2.9.1">¶</a></p>
</li>
        <li class="normal" id="appendix-B-2.10">
          <p id="appendix-B-2.10.1">Message Structure: Packet Criticality (<a class="auto internal xref" href="#packet-criticality">Section 4.3</a>)<a class="pilcrow" href="#appendix-B-2.10.1">¶</a></p>
</li>
        <li class="normal" id="appendix-B-2.11">
          <p id="appendix-B-2.11.1">Deprecations:<a class="pilcrow" href="#appendix-B-2.11.1">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-2.11.2.1">
              <p id="appendix-B-2.11.2.1.1">Public Key Algorithms:<a class="pilcrow" href="#appendix-B-2.11.2.1.1">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-2.11.2.1.2.1">
                  <p id="appendix-B-2.11.2.1.2.1.1">Avoid RSA weak keys (<a class="auto internal xref" href="#rsa-notes">Section 12.4</a>)<a class="pilcrow" href="#appendix-B-2.11.2.1.2.1.1">¶</a></p>
</li>
                <li class="normal" id="appendix-B-2.11.2.1.2.2">
                  <p id="appendix-B-2.11.2.1.2.2.1">Avoid DSA (<a class="auto internal xref" href="#dsa-notes">Section 12.5</a>)<a class="pilcrow" href="#appendix-B-2.11.2.1.2.2.1">¶</a></p>
</li>
                <li class="normal" id="appendix-B-2.11.2.1.2.3">
                  <p id="appendix-B-2.11.2.1.2.3.1">Avoid ElGamal (Sections <a class="auto internal xref" href="#elgamal-notes">12.6</a> and <a class="auto internal xref" href="#pkesk-elgamal">5.1.4</a>)<a class="pilcrow" href="#appendix-B-2.11.2.1.2.3.1">¶</a></p>
</li>
                <li class="normal" id="appendix-B-2.11.2.1.2.4">
                  <p id="appendix-B-2.11.2.1.2.4.1">For Version 6 Keys: Avoid EdDSA25519Legacy and Curve25519Legacy (<a class="auto internal xref" href="#ec-curves">Section 9.2</a>)<a class="pilcrow" href="#appendix-B-2.11.2.1.2.4.1">¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="appendix-B-2.11.2.2">
              <p id="appendix-B-2.11.2.2.1">Digest Algorithms:<a class="pilcrow" href="#appendix-B-2.11.2.2.1">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-2.11.2.2.2.1">
                  <p id="appendix-B-2.11.2.2.2.1.1">Avoid MD5, SHA1, and RIPEMD160 (<a class="auto internal xref" href="#hash-algos">Section 9.5</a>)<a class="pilcrow" href="#appendix-B-2.11.2.2.2.1.1">¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="appendix-B-2.11.2.3">
              <p id="appendix-B-2.11.2.3.1">Symmetric Key Algorithms:<a class="pilcrow" href="#appendix-B-2.11.2.3.1">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-2.11.2.3.2.1">
                  <p id="appendix-B-2.11.2.3.2.1.1">Avoid IDEA, TripleDES, and CAST5 (<a class="auto internal xref" href="#symmetric-algos">Section 9.3</a>)<a class="pilcrow" href="#appendix-B-2.11.2.3.2.1.1">¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="appendix-B-2.11.2.4">
              <p id="appendix-B-2.11.2.4.1">S2K Specifier:<a class="pilcrow" href="#appendix-B-2.11.2.4.1">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-2.11.2.4.2.1">
                  <p id="appendix-B-2.11.2.4.2.1.1">Avoid Simple S2K (<a class="auto internal xref" href="#s2k-simple">Section 3.7.1.1</a>)<a class="pilcrow" href="#appendix-B-2.11.2.4.2.1.1">¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="appendix-B-2.11.2.5">
              <p id="appendix-B-2.11.2.5.1">Secret Key Protections (a.k.a. S2K Usage):<a class="pilcrow" href="#appendix-B-2.11.2.5.1">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-2.11.2.5.2.1">
                  <p id="appendix-B-2.11.2.5.2.1.1">Avoid MalleableCFB (<a class="auto internal xref" href="#secret-key-encryption">Section 3.7.2.1</a>)<a class="pilcrow" href="#appendix-B-2.11.2.5.2.1.1">¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="appendix-B-2.11.2.6">
              <p id="appendix-B-2.11.2.6.1">Packet Types:<a class="pilcrow" href="#appendix-B-2.11.2.6.1">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-2.11.2.6.2.1">
                  <p id="appendix-B-2.11.2.6.2.1.1">Avoid Symmetrically Encrypted Data (Sections <a class="auto internal xref" href="#sed">5.7</a> and <a class="auto internal xref" href="#ciphertext-malleability">13.7</a>)<a class="pilcrow" href="#appendix-B-2.11.2.6.2.1.1">¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="appendix-B-2.11.2.7">
              <p id="appendix-B-2.11.2.7.1">Literal Data Packet Metadata:<a class="pilcrow" href="#appendix-B-2.11.2.7.1">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-2.11.2.7.2.1">
                  <p id="appendix-B-2.11.2.7.2.1.1">Avoid Filename and Date fields (<a class="auto internal xref" href="#lit">Section 5.9</a>)<a class="pilcrow" href="#appendix-B-2.11.2.7.2.1.1">¶</a></p>
</li>
                <li class="normal" id="appendix-B-2.11.2.7.2.2">
                  <p id="appendix-B-2.11.2.7.2.2.1">Avoid Special <code>_CONSOLE</code> "filename" (<a class="auto internal xref" href="#for-eyes-only">Section 5.9.1</a>)<a class="pilcrow" href="#appendix-B-2.11.2.7.2.2.1">¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="appendix-B-2.11.2.8">
              <p id="appendix-B-2.11.2.8.1">Packet Versions:<a class="pilcrow" href="#appendix-B-2.11.2.8.1">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-2.11.2.8.2.1">
                  <p id="appendix-B-2.11.2.8.2.1.1">Avoid Version 3 Public Keys (<a class="auto internal xref" href="#v3-pubkeys">Section 5.5.2.1</a>)<a class="pilcrow" href="#appendix-B-2.11.2.8.2.1.1">¶</a></p>
</li>
                <li class="normal" id="appendix-B-2.11.2.8.2.2">
                  <p id="appendix-B-2.11.2.8.2.2.1">Avoid Version 3 Signatures (<a class="auto internal xref" href="#signature-packet">Section 5.2</a>)<a class="pilcrow" href="#appendix-B-2.11.2.8.2.2.1">¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="appendix-B-2.11.2.9">
              <p id="appendix-B-2.11.2.9.1">Signature Types:<a class="pilcrow" href="#appendix-B-2.11.2.9.1">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-2.11.2.9.2.1">
                  <p id="appendix-B-2.11.2.9.2.1.1">Avoid Reserved Signature Type ID 0xFF (Sections <a class="auto internal xref" href="#sigtype-reserved">5.2.1.16</a> and <a class="auto internal xref" href="#sig-computation-notes">5.2.4.1</a>)<a class="pilcrow" href="#appendix-B-2.11.2.9.2.1.1">¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="appendix-B-2.11.2.10">
              <p id="appendix-B-2.11.2.10.1">Signature Subpackets:<a class="pilcrow" href="#appendix-B-2.11.2.10.1">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-2.11.2.10.2.1">
                  <p id="appendix-B-2.11.2.10.2.1.1">For Version 6 Signatures: Avoid Issuer Key ID (<a class="auto internal xref" href="#issuer-keyid-subpacket">Section 5.2.3.12</a>)<a class="pilcrow" href="#appendix-B-2.11.2.10.2.1.1">¶</a></p>
</li>
                <li class="normal" id="appendix-B-2.11.2.10.2.2">
                  <p id="appendix-B-2.11.2.10.2.2.1">Avoid Revocation Key (<a class="auto internal xref" href="#revocation-key">Section 5.2.3.23</a>)<a class="pilcrow" href="#appendix-B-2.11.2.10.2.2.1">¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="appendix-B-2.11.2.11">
              <p id="appendix-B-2.11.2.11.1">ASCII Armor:<a class="pilcrow" href="#appendix-B-2.11.2.11.1">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-2.11.2.11.2.1">
                  <p id="appendix-B-2.11.2.11.2.1.1">Ignore; do not emit CRC (<a class="auto internal xref" href="#optional-crc24">Section 6.1</a>)<a class="pilcrow" href="#appendix-B-2.11.2.11.2.1.1">¶</a></p>
</li>
                <li class="normal" id="appendix-B-2.11.2.11.2.2">
                  <p id="appendix-B-2.11.2.11.2.2.1">Do not emit "Version" Armor Header (<a class="auto internal xref" href="#armor-header-key-version">Section 6.2.2.1</a>)<a class="pilcrow" href="#appendix-B-2.11.2.11.2.2.1">¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="appendix-B-2.11.2.12">
              <p id="appendix-B-2.11.2.12.1">Cleartext Signature Framework:<a class="pilcrow" href="#appendix-B-2.11.2.12.1">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-2.11.2.12.2.1">
                  <p id="appendix-B-2.11.2.12.2.1.1">Ignore; avoid emitting unnecessary Hash: headers (<a class="auto internal xref" href="#armor-header-key-hash">Section 6.2.2.3</a>)<a class="pilcrow" href="#appendix-B-2.11.2.12.2.1.1">¶</a></p>
</li>
                <li class="normal" id="appendix-B-2.11.2.12.2.2">
                  <p id="appendix-B-2.11.2.12.2.2.1">Reject Cleartext Signature Framework signatures with invalid Hash: headers (<a class="auto internal xref" href="#armor-header-key-hash">Section 6.2.2.3</a>) or any other Armor Header (<a class="auto internal xref" href="#cleartext-structure">Section 7.1</a>)<a class="pilcrow" href="#appendix-B-2.11.2.12.2.2.1">¶</a></p>
</li>
              </ul>
</li>
          </ul>
</li>
      </ul>
<div id="terminology-changes">
<section id="appendix-B.1">
        <h3 id="name-terminology-changes">
<a class="section-number selfRef" href="#appendix-B.1">B.1. </a><a class="section-name selfRef" href="#name-terminology-changes">Terminology Changes</a>
        </h3>
<p id="appendix-B.1-1">Note that some of the words used in previous versions of the OpenPGP specification have been improved in this document.<a class="pilcrow" href="#appendix-B.1-1">¶</a></p>
<p id="appendix-B.1-2">In previous versions, the following terms were used:<a class="pilcrow" href="#appendix-B.1-2">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B.1-3.1">
            <p id="appendix-B.1-3.1.1">"Radix-64" was used to refer to OpenPGP's ASCII Armor base64 encoding (<a class="auto internal xref" href="#base64">Section 6</a>).<a class="pilcrow" href="#appendix-B.1-3.1.1">¶</a></p>
</li>
          <li class="normal" id="appendix-B.1-3.2">
            <p id="appendix-B.1-3.2.1">"Old packet format" was used to refer to the Legacy packet format (<a class="auto internal xref" href="#legacy-packet-format">Section 4.2.2</a>) predating <span>[<a class="cite xref" href="#RFC2440">RFC2440</a>]</span>.<a class="pilcrow" href="#appendix-B.1-3.2.1">¶</a></p>
</li>
          <li class="normal" id="appendix-B.1-3.3">
            <p id="appendix-B.1-3.3.1">"New packet format" was used to refer to the OpenPGP packet format (<a class="auto internal xref" href="#openpgp-packet-format">Section 4.2.1</a>) introduced in <span>[<a class="cite xref" href="#RFC2440">RFC2440</a>]</span>.<a class="pilcrow" href="#appendix-B.1-3.3.1">¶</a></p>
</li>
          <li class="normal" id="appendix-B.1-3.4">
            <p id="appendix-B.1-3.4.1">"Certificate" was used ambiguously to mean multiple things.
In this document, it means "Transferable Public Key" exclusively.<a class="pilcrow" href="#appendix-B.1-3.4.1">¶</a></p>
</li>
          <li class="normal" id="appendix-B.1-3.5">
            <p id="appendix-B.1-3.5.1">"Preferred Symmetric Algorithms" was the old name for the "Preferred Symmetric Ciphers for v1 SEIPD" subpacket (<a class="auto internal xref" href="#preferred-v1-seipd">Section 5.2.3.14</a>).<a class="pilcrow" href="#appendix-B.1-3.5.1">¶</a></p>
</li>
          <li class="normal" id="appendix-B.1-3.6">
            <p id="appendix-B.1-3.6.1">"Modification Detection Code" or "MDC" was originally described as a distinct packet (Packet Type ID 19), and its corresponding flag in the Features signature subpacket (<a class="auto internal xref" href="#features-subpacket">Section 5.2.3.32</a>) was known as "Modification Detection".
It is now described as an intrinsic part of v1 SEIPD (<a class="auto internal xref" href="#version-one-seipd">Section 5.13.1</a>), and the same corresponding flag is known as "Version 1 Symmetrically Encrypted and Integrity Protected Data packet".<a class="pilcrow" href="#appendix-B.1-3.6.1">¶</a></p>
</li>
          <li class="normal" id="appendix-B.1-3.7">
            <p id="appendix-B.1-3.7.1">"Packet Tag" was used to refer to the Packet Type ID (<a class="auto internal xref" href="#packet-types">Section 5</a>) or sometimes to the encoded Packet Type ID (<a class="auto internal xref" href="#packet-headers">Section 4.2</a>).<a class="pilcrow" href="#appendix-B.1-3.7.1">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="errata-listing">
<section id="appendix-C">
      <h2 id="name-errata-addressed-by-this-do">
<a class="section-number selfRef" href="#appendix-C">Appendix C. </a><a class="section-name selfRef" href="#name-errata-addressed-by-this-do">Errata Addressed by This Document</a>
      </h2>
<p id="appendix-C-1">The following verified errata have been incorporated or are otherwise resolved by this document:<a class="pilcrow" href="#appendix-C-1">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-2.1">
          <p id="appendix-C-2.1.1"><span>[<a class="cite xref" href="#Errata-2199">Errata-2199</a>]</span> - S2K hash/cipher octet correction<a class="pilcrow" href="#appendix-C-2.1.1">¶</a></p>
</li>
        <li class="normal" id="appendix-C-2.2">
          <p id="appendix-C-2.2.1"><span>[<a class="cite xref" href="#Errata-2200">Errata-2200</a>]</span> - No implicit use of IDEA correction<a class="pilcrow" href="#appendix-C-2.2.1">¶</a></p>
</li>
        <li class="normal" id="appendix-C-2.3">
          <p id="appendix-C-2.3.1"><span>[<a class="cite xref" href="#Errata-2206">Errata-2206</a>]</span> - PKESK acronym expansion<a class="pilcrow" href="#appendix-C-2.3.1">¶</a></p>
</li>
        <li class="normal" id="appendix-C-2.4">
          <p id="appendix-C-2.4.1"><span>[<a class="cite xref" href="#Errata-2208">Errata-2208</a>]</span> - Signature key owner clarification<a class="pilcrow" href="#appendix-C-2.4.1">¶</a></p>
</li>
        <li class="normal" id="appendix-C-2.5">
          <p id="appendix-C-2.5.1"><span>[<a class="cite xref" href="#Errata-2214">Errata-2214</a>]</span> - Signature hashing clarification<a class="pilcrow" href="#appendix-C-2.5.1">¶</a></p>
</li>
        <li class="normal" id="appendix-C-2.6">
          <p id="appendix-C-2.6.1"><span>[<a class="cite xref" href="#Errata-2216">Errata-2216</a>]</span> - Self-signature applies to user ID correction<a class="pilcrow" href="#appendix-C-2.6.1">¶</a></p>
</li>
        <li class="normal" id="appendix-C-2.7">
          <p id="appendix-C-2.7.1"><span>[<a class="cite xref" href="#Errata-2219">Errata-2219</a>]</span> - Session key encryption storage clarification<a class="pilcrow" href="#appendix-C-2.7.1">¶</a></p>
</li>
        <li class="normal" id="appendix-C-2.8">
          <p id="appendix-C-2.8.1"><span>[<a class="cite xref" href="#Errata-2222">Errata-2222</a>]</span> - Simple hash <span class="bcp14">MUST</span>/<span class="bcp14">MAY</span> clarification<a class="pilcrow" href="#appendix-C-2.8.1">¶</a></p>
</li>
        <li class="normal" id="appendix-C-2.9">
          <p id="appendix-C-2.9.1"><span>[<a class="cite xref" href="#Errata-2226">Errata-2226</a>]</span> - Native line endings <span class="bcp14">SHOULD</span> clarification<a class="pilcrow" href="#appendix-C-2.9.1">¶</a></p>
</li>
        <li class="normal" id="appendix-C-2.10">
          <p id="appendix-C-2.10.1"><span>[<a class="cite xref" href="#Errata-2234">Errata-2234</a>]</span> - Radix-64/base64 clarification<a class="pilcrow" href="#appendix-C-2.10.1">¶</a></p>
</li>
        <li class="normal" id="appendix-C-2.11">
          <p id="appendix-C-2.11.1"><span>[<a class="cite xref" href="#Errata-2235">Errata-2235</a>]</span> - ASCII/UTF-8 collation sequence clarification<a class="pilcrow" href="#appendix-C-2.11.1">¶</a></p>
</li>
        <li class="normal" id="appendix-C-2.12">
          <p id="appendix-C-2.12.1"><span>[<a class="cite xref" href="#Errata-2236">Errata-2236</a>]</span> - Packet Composition is a sequence clarification<a class="pilcrow" href="#appendix-C-2.12.1">¶</a></p>
</li>
        <li class="normal" id="appendix-C-2.13">
          <p id="appendix-C-2.13.1"><span>[<a class="cite xref" href="#Errata-2238">Errata-2238</a>]</span> - Subkey packets come after all User ID packets clarification<a class="pilcrow" href="#appendix-C-2.13.1">¶</a></p>
</li>
        <li class="normal" id="appendix-C-2.14">
          <p id="appendix-C-2.14.1"><span>[<a class="cite xref" href="#Errata-2240">Errata-2240</a>]</span> - Subkey removal clarification<a class="pilcrow" href="#appendix-C-2.14.1">¶</a></p>
</li>
        <li class="normal" id="appendix-C-2.15">
          <p id="appendix-C-2.15.1"><span>[<a class="cite xref" href="#Errata-2242">Errata-2242</a>]</span> - mL/emLen variable correction<a class="pilcrow" href="#appendix-C-2.15.1">¶</a></p>
</li>
        <li class="normal" id="appendix-C-2.16">
          <p id="appendix-C-2.16.1"><span>[<a class="cite xref" href="#Errata-2243">Errata-2243</a>]</span> - CFB mode initialization vector (IV) clarification<a class="pilcrow" href="#appendix-C-2.16.1">¶</a></p>
</li>
        <li class="normal" id="appendix-C-2.17">
          <p id="appendix-C-2.17.1"><span>[<a class="cite xref" href="#Errata-2270">Errata-2270</a>]</span> - SHA-224 octet sequence correction<a class="pilcrow" href="#appendix-C-2.17.1">¶</a></p>
</li>
        <li class="normal" id="appendix-C-2.18">
          <p id="appendix-C-2.18.1"><span>[<a class="cite xref" href="#Errata-2271">Errata-2271</a>]</span> - Radix-64 correction<a class="pilcrow" href="#appendix-C-2.18.1">¶</a></p>
</li>
        <li class="normal" id="appendix-C-2.19">
          <p id="appendix-C-2.19.1"><span>[<a class="cite xref" href="#Errata-3298">Errata-3298</a>]</span> - Key Revocation signatures correction<a class="pilcrow" href="#appendix-C-2.19.1">¶</a></p>
</li>
        <li class="normal" id="appendix-C-2.20">
          <p id="appendix-C-2.20.1"><span>[<a class="cite xref" href="#Errata-5491">Errata-5491</a>]</span> - C code fix for CRC24_POLY define<a class="pilcrow" href="#appendix-C-2.20.1">¶</a></p>
</li>
        <li class="normal" id="appendix-C-2.21">
          <p id="appendix-C-2.21.1"><span>[<a class="cite xref" href="#Errata-7545">Errata-7545</a>]</span> - Armor Header colon hex fix<a class="pilcrow" href="#appendix-C-2.21.1">¶</a></p>
</li>
        <li class="normal" id="appendix-C-2.22">
          <p id="appendix-C-2.22.1"><span>[<a class="cite xref" href="#Errata-7889">Errata-7889</a>]</span> - Signature/certification correction<a class="pilcrow" href="#appendix-C-2.22.1">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="acknowledgements">
<section id="appendix-D">
      <h2 id="name-acknowledgements">
<a class="section-name selfRef" href="#name-acknowledgements">Acknowledgements</a>
      </h2>
<p id="appendix-D-1">Thanks to the OpenPGP Design Team for working on this document and preparing it for working group consumption: <span class="contact-name">Stephen Farrell</span>, <span class="contact-name">Daniel Kahn Gillmor</span>, <span class="contact-name">Daniel Huigens</span>, <span class="contact-name">Jeffrey Lau</span>, <span class="contact-name">Yutaka Niibe</span>, <span class="contact-name">Justus Winter</span>, and <span class="contact-name">Paul Wouters</span>.<a class="pilcrow" href="#appendix-D-1">¶</a></p>
<p id="appendix-D-2">Thanks to <span class="contact-name">Werner Koch</span> for the early work on rfc4880bis and <span class="contact-name">Andrey Jivsov</span> for the work on <span>[<a class="cite xref" href="#RFC6637">RFC6637</a>]</span>.<a class="pilcrow" href="#appendix-D-2">¶</a></p>
<p id="appendix-D-3">This document also draws on much previous work from a number of other authors including <span class="contact-name">Derek Atkins</span>, <span class="contact-name">Charles Breed</span>, <span class="contact-name">Dave Del Torto</span>, <span class="contact-name">Marc Dyksterhouse</span>, <span class="contact-name">Gail Haspert</span>, <span class="contact-name">Gene Hoffman</span>, <span class="contact-name">Paul Hoffman</span>, <span class="contact-name">Ben Laurie</span>, <span class="contact-name">Raph Levien</span>, <span class="contact-name">Colin Plumb</span>, <span class="contact-name">Will Price</span>, <span class="contact-name">Daphne Shaw</span>, <span class="contact-name">William Stallings</span>, <span class="contact-name">Mark Weaver</span>, and <span class="contact-name">Philip R. Zimmermann</span>.<a class="pilcrow" href="#appendix-D-3">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-E">
      <h2 id="name-authors-addresses">
<a class="section-name selfRef" href="#name-authors-addresses">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Paul Wouters (<span class="role">editor</span>)</span></div>
<div class="left" dir="auto"><span class="org">Aiven</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:paul.wouters@aiven.io">paul.wouters@aiven.io</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Daniel Huigens</span></div>
<div class="left" dir="auto"><span class="org">Proton AG</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:d.huigens@protonmail.com">d.huigens@protonmail.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Justus Winter</span></div>
<div class="left" dir="auto"><span class="org">Sequoia PGP</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:justus@sequoia-pgp.org">justus@sequoia-pgp.org</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Yutaka Niibe</span></div>
<div class="left" dir="auto"><span class="org">FSIJ</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:gniibe@fsij.org">gniibe@fsij.org</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>


</body></html>