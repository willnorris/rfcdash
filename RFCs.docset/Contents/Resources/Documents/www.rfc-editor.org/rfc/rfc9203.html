<!DOCTYPE html>
<html class="RFC" lang="en"><head>
<meta charset="utf-8"/>
<meta content="Common,Latin" name="scripts"/>
<meta content="initial-scale=1.0" name="viewport"/>
<title>RFC 9203: The Object Security for Constrained RESTful Environments (OSCORE) Profile of the Authentication and Authorization for Constrained Environments (ACE) Framework</title>
<meta content="Francesca Palombini" name="author"/>
<meta content="Ludwig Seitz" name="author"/>
<meta content="GÃ¶ran Selander" name="author"/>
<meta content="Martin Gunnarsson" name="author"/>
<meta content="
       
        This document specifies a profile for the Authentication and Authorization for Constrained Environments (ACE) framework.  It utilizes Object Security for Constrained RESTful Environments (OSCORE) to provide communication security and proof-of-possession for a key owned by the client and bound to an OAuth 2.0 access token.
       
    " name="description"/>
<meta content="xml2rfc 3.14.2" name="generator"/>
<meta content="CoAP" name="keyword"/>
<meta content="OAuth 2.0" name="keyword"/>
<meta content="Access Control" name="keyword"/>
<meta content="Authorization" name="keyword"/>
<meta content="Internet of Things" name="keyword"/>
<meta content="9203" name="rfc.number"/>
<!-- Generator version information:
  xml2rfc 3.14.2
    Python 3.9.13
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.1
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 3.1.2
    kitchen 1.2.6
    lxml 4.9.0
    MarkupSafe 2.1.1
    pycountry 22.3.5
    PyYAML 6.0
    requests 2.28.0
    setuptools 44.1.1
    six 1.16.0
    weasyprint 56.1
-->
<link href="rfc9203.xml" rel="alternate" type="application/rfc+xml"/>
<link href="#copyright" rel="license"/>
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  pre.breakable {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css"/>
<link href="https://dx.doi.org/10.17487/rfc9203" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <link href="https://datatracker.ietf.org/doc/draft-ietf-ace-oscore-profile-19" rel="prev"/>
  </head>
<body>
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 9203</td>
<td class="center">OSCORE Profile of ACE</td>
<td class="right">August 2022</td>
</tr></thead>
<tfoot><tr>
<td class="left">Palombini, et al.</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div class="document-information" id="external-metadata"></div>
<div class="document-information" id="internal-metadata">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a class="eref" href="https://www.rfc-editor.org/rfc/rfc9203">9203</a></dd>
<dt class="label-category">Category:</dt>
<dd class="category">Standards Track</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time class="published" datetime="2022-08">August 2022</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">F. Palombini</div>
<div class="org">Ericsson AB</div>
</div>
<div class="author">
      <div class="author-name">L. Seitz</div>
<div class="org">Combitech</div>
</div>
<div class="author">
      <div class="author-name">G. Selander</div>
<div class="org">Ericsson AB</div>
</div>
<div class="author">
      <div class="author-name">M. Gunnarsson</div>
<div class="org">RISE</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 9203</h1>
<h1 id="title">The Object Security for Constrained RESTful Environments (OSCORE) Profile of the Authentication and Authorization for Constrained Environments (ACE) Framework</h1>
<section id="section-abstract">
      <h2 id="abstract"><a class="selfRef" href="#abstract">Abstract</a></h2>
<p id="section-abstract-1">
        This document specifies a profile for the Authentication and Authorization for Constrained Environments (ACE) framework.  It utilizes Object Security for Constrained RESTful Environments (OSCORE) to provide communication security and proof-of-possession for a key owned by the client and bound to an OAuth 2.0 access token.<a class="pilcrow" href="#section-abstract-1">Â¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a class="section-name selfRef" href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This is an Internet Standards Track document.<a class="pilcrow" href="#section-boilerplate.1-1">Â¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.<a class="pilcrow" href="#section-boilerplate.1-2">Â¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc9203">https://www.rfc-editor.org/info/rfc9203</a></span>.<a class="pilcrow" href="#section-boilerplate.1-3">Â¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a class="section-name selfRef" href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2022 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a class="pilcrow" href="#section-boilerplate.2-1">Â¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a class="pilcrow" href="#section-boilerplate.2-2">Â¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a class="toplink" href="#" onclick="scroll(0,0)">â²</a><h2 id="name-table-of-contents">
<a class="section-name selfRef" href="#name-table-of-contents">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p class="keepWithNext" id="section-toc.1-1.1.1"><a class="xref" href="#section-1">1</a>.Â Â <a class="xref" href="#name-introduction">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p class="keepWithNext" id="section-toc.1-1.1.2.1.1"><a class="xref" href="#section-1.1">1.1</a>.Â Â <a class="xref" href="#name-terminology">Terminology</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p class="keepWithNext" id="section-toc.1-1.2.1"><a class="xref" href="#section-2">2</a>.Â Â <a class="xref" href="#name-protocol-overview">Protocol Overview</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a class="xref" href="#section-3">3</a>.Â Â <a class="xref" href="#name-client-as-communication">Client-AS Communication</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a class="xref" href="#section-3.1">3.1</a>.Â Â <a class="xref" href="#name-c-to-as-post-to-token-endpo">C-to-AS: POST to Token Endpoint</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a class="xref" href="#section-3.2">3.2</a>.Â Â <a class="xref" href="#name-as-to-c-access-token">AS-to-C: Access Token</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.1">
                    <p id="section-toc.1-1.3.2.2.2.1.1"><a class="xref" href="#section-3.2.1">3.2.1</a>.Â Â <a class="xref" href="#name-the-oscore_input_material">The OSCORE_Input_Material</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a class="xref" href="#section-4">4</a>.Â Â <a class="xref" href="#name-client-rs-communication">Client-RS Communication</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a class="xref" href="#section-4.1">4.1</a>.Â Â <a class="xref" href="#name-c-to-rs-post-to-authz-info-">C-to-RS: POST to authz-info Endpoint</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.1">
                    <p id="section-toc.1-1.4.2.1.2.1.1"><a class="xref" href="#section-4.1.1">4.1.1</a>.Â Â <a class="xref" href="#name-the-nonce-1-parameter">The Nonce 1 Parameter</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.2">
                    <p id="section-toc.1-1.4.2.1.2.2.1"><a class="xref" href="#section-4.1.2">4.1.2</a>.Â Â <a class="xref" href="#name-the-ace_client_recipientid-">The ace_client_recipientid Parameter</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a class="xref" href="#section-4.2">4.2</a>.Â Â <a class="xref" href="#name-rs-to-c-201-created">RS-to-C: 2.01 (Created)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a class="xref" href="#section-4.2.1">4.2.1</a>.Â Â <a class="xref" href="#name-the-nonce-2-parameter">The Nonce 2 Parameter</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.2">
                    <p id="section-toc.1-1.4.2.2.2.2.1"><a class="xref" href="#section-4.2.2">4.2.2</a>.Â Â <a class="xref" href="#name-the-ace_server_recipientid-">The ace_server_recipientid Parameter</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a class="xref" href="#section-4.3">4.3</a>.Â Â <a class="xref" href="#name-oscore-setup">OSCORE Setup</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a class="xref" href="#section-4.4">4.4</a>.Â Â <a class="xref" href="#name-access-rights-verification">Access Rights Verification</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a class="xref" href="#section-5">5</a>.Â Â <a class="xref" href="#name-secure-communication-with-a">Secure Communication with AS</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a class="xref" href="#section-6">6</a>.Â Â <a class="xref" href="#name-discarding-the-security-con">Discarding the Security Context</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a class="xref" href="#section-7">7</a>.Â Â <a class="xref" href="#name-security-considerations">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a class="xref" href="#section-8">8</a>.Â Â <a class="xref" href="#name-privacy-considerations">Privacy Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a class="xref" href="#section-9">9</a>.Â Â <a class="xref" href="#name-iana-considerations">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a class="xref" href="#section-9.1">9.1</a>.Â Â <a class="xref" href="#name-ace-profile-registry">ACE Profile Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a class="xref" href="#section-9.2">9.2</a>.Â Â <a class="xref" href="#name-oauth-parameters-registry">OAuth Parameters Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a class="xref" href="#section-9.3">9.3</a>.Â Â <a class="xref" href="#name-oauth-parameters-cbor-mappi">OAuth Parameters CBOR Mappings Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.4">
                <p id="section-toc.1-1.9.2.4.1"><a class="xref" href="#section-9.4">9.4</a>.Â Â <a class="xref" href="#name-oscore-security-context-par">OSCORE Security Context Parameters Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.5">
                <p id="section-toc.1-1.9.2.5.1"><a class="xref" href="#section-9.5">9.5</a>.Â Â <a class="xref" href="#name-cwt-confirmation-methods-re">CWT Confirmation Methods Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.6">
                <p id="section-toc.1-1.9.2.6.1"><a class="xref" href="#section-9.6">9.6</a>.Â Â <a class="xref" href="#name-jwt-confirmation-methods-re">JWT Confirmation Methods Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.7">
                <p id="section-toc.1-1.9.2.7.1"><a class="xref" href="#section-9.7">9.7</a>.Â Â <a class="xref" href="#name-expert-review-instructions">Expert Review Instructions</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a class="xref" href="#section-10">10</a>.Â <a class="xref" href="#name-references">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a class="xref" href="#section-10.1">10.1</a>.Â Â <a class="xref" href="#name-normative-references">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a class="xref" href="#section-10.2">10.2</a>.Â Â <a class="xref" href="#name-informative-references">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a class="xref" href="#appendix-A">Appendix A</a>.Â Â <a class="xref" href="#name-profile-requirements">Profile Requirements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a class="xref" href="#appendix-B"></a><a class="xref" href="#name-acknowledgments">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a class="xref" href="#appendix-C"></a><a class="xref" href="#name-authors-addresses">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a class="section-number selfRef" href="#section-1">1. </a><a class="section-name selfRef" href="#name-introduction">Introduction</a>
      </h2>
<p id="section-1-1">
        This document specifies the <code>coap_oscore</code> profile of the ACE framework <span>[<a class="xref" href="#RFC9200">RFC9200</a>]</span>.  In this profile, a client (C) and a resource server (RS) use the Constrained Application Protocol (CoAP) <span>[<a class="xref" href="#RFC7252">RFC7252</a>]</span> to communicate.  The client uses an access token, bound to a symmetric key (the proof-of-possession (PoP) key) to authorize its access to the resource server.  Note that this profile uses a symmetric-crypto-based scheme, where the symmetric secret is used as input material for keying material derivation.  In order to provide communication security and PoP, the client and resource server use Object Security for Constrained RESTful Environments (OSCORE) as defined in <span>[<a class="xref" href="#RFC8613">RFC8613</a>]</span>.  Note that the PoP is not achieved through a dedicated protocol element but rather occurs after the first message exchange using OSCORE.<a class="pilcrow" href="#section-1-1">Â¶</a></p>
<p id="section-1-2">
        OSCORE specifies how to use CBOR Object Signing and Encryption (COSE) <span>[<a class="xref" href="#RFC9052">RFC9052</a>]</span> <span>[<a class="xref" href="#RFC9053">RFC9053</a>]</span> to secure CoAP messages.
        Note that OSCORE can be used to secure CoAP messages, as well as HTTP and combinations of HTTP and CoAP; a profile of ACE similar to the one described in this document, with the difference of using HTTP instead of CoAP as the communication protocol, could be specified analogously to this one.<a class="pilcrow" href="#section-1-2">Â¶</a></p>
<div id="terminology">
<section id="section-1.1">
        <h3 id="name-terminology">
<a class="section-number selfRef" href="#section-1.1">1.1. </a><a class="section-name selfRef" href="#name-terminology">Terminology</a>
        </h3>
<p id="section-1.1-1">
    The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
    "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
    described in BCPÂ 14 <span>[<a class="xref" href="#RFC2119">RFC2119</a>]</span> <span>[<a class="xref" href="#RFC8174">RFC8174</a>]</span>
    when, and only when, they appear in all capitals, as shown here.<a class="pilcrow" href="#section-1.1-1">Â¶</a></p>
<p id="section-1.1-2">
          Certain security-related terms such as "authentication", "authorization", "confidentiality", "(data) integrity", "Message Authentication Code (MAC)", "Hash-based Message Authentication Code (HMAC)", and "verify" are taken from <span>[<a class="xref" href="#RFC4949">RFC4949</a>]</span>.<a class="pilcrow" href="#section-1.1-2">Â¶</a></p>
<p id="section-1.1-3">
          RESTful terminology follows HTTP <span>[<a class="xref" href="#RFC9110">RFC9110</a>]</span>.<a class="pilcrow" href="#section-1.1-3">Â¶</a></p>
<p id="section-1.1-4">
          Readers are expected to be familiar with the terms and concepts defined in OSCORE <span>[<a class="xref" href="#RFC8613">RFC8613</a>]</span>, such as "security context" and "Recipient ID".<a class="pilcrow" href="#section-1.1-4">Â¶</a></p>
<p id="section-1.1-5">
          Terminology for entities in the architecture is defined in OAuth 2.0 <span>[<a class="xref" href="#RFC6749">RFC6749</a>]</span>, such as client (C), resource server (RS), and authorization server (AS). It is assumed in this document that a given resource on a specific RS is associated to a unique AS.<a class="pilcrow" href="#section-1.1-5">Â¶</a></p>
<p id="section-1.1-6">
          Concise Binary Object Representation (CBOR) <span>[<a class="xref" href="#RFC8949">RFC8949</a>]</span> and Concise Data Definition Language (CDDL) <span>[<a class="xref" href="#RFC8610">RFC8610</a>]</span> are used in this document. CDDL predefined type names, especially "bstr" for CBOR byte strings and "tstr" for CBOR text strings, are used extensively in this document.<a class="pilcrow" href="#section-1.1-6">Â¶</a></p>
<p id="section-1.1-7">
          Note that the term "endpoint" is used as in <span>[<a class="xref" href="#RFC9200">RFC9200</a>]</span>, following its OAuth definition, which is to denote resources such as token and introspect at the AS and authz-info at the RS.

   The CoAP definition, which is "[a]n entity participating in the CoAP protocol" <span>[<a class="xref" href="#RFC7252">RFC7252</a>]</span>, is not used in this document.<a class="pilcrow" href="#section-1.1-7">Â¶</a></p>
<p id="section-1.1-8">Throughout this document, examples for CBOR data items are expressed in
           CBOR extended diagnostic notation as defined in
           <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8949#section-8">Section 8</a> of [<a class="xref" href="#RFC8949">RFC8949</a>]</span> and
           <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8610#appendix-G">Appendix G</a> of [<a class="xref" href="#RFC8610">RFC8610</a>]</span>
           ("diagnostic notation"), unless noted otherwise.
           We often use diagnostic notation comments to provide
           a textual representation of the numeric parameter names and values.<a class="pilcrow" href="#section-1.1-8">Â¶</a></p>
<p id="section-1.1-9">In this document, the term "base64-encoded" refers to URL-Safe base64 encoding (see <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc4648#section-5">Section 5</a> of [<a class="xref" href="#RFC4648">RFC4648</a>]</span>) without padding.<a class="pilcrow" href="#section-1.1-9">Â¶</a></p>
</section>
</div>
</section>
</div>
<section id="section-2">
      <h2 id="name-protocol-overview">
<a class="section-number selfRef" href="#section-2">2. </a><a class="section-name selfRef" href="#name-protocol-overview">Protocol Overview</a>
      </h2>
<p id="section-2-1">
        This section gives an overview of how to use the ACE Framework <span>[<a class="xref" href="#RFC9200">RFC9200</a>]</span> to secure the communication between a client and a resource server using OSCORE <span>[<a class="xref" href="#RFC8613">RFC8613</a>]</span>. The parameters needed by the client to negotiate the use of this profile with the AS, as well as the OSCORE setup process, are described in detail in the following sections.<a class="pilcrow" href="#section-2-1">Â¶</a></p>
<p id="section-2-2">
        The RS maintains a collection of OSCORE security contexts with associated authorization information for all the clients that it is communicating with. The
        authorization information is maintained as policy that is used as input to processing requests from those clients.<a class="pilcrow" href="#section-2-2">Â¶</a></p>
<p id="section-2-3">
        This profile requires a client to retrieve an access token from the AS for the resource it wants to access on an RS, by sending an access token request to the token endpoint, as specified in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9200#section-5.8">Section 5.8</a> of [<a class="xref" href="#RFC9200">RFC9200</a>]</span>. The access token request and response <span class="bcp14">MUST</span> be confidentiality protected and ensure authenticity.  The use of OSCORE between the client and AS is <span class="bcp14">RECOMMENDED</span> in this profile, to reduce the number of libraries the client has to support, but other protocols fulfilling the security requirements defined in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9200#section-5">Section 5</a> of [<a class="xref" href="#RFC9200">RFC9200</a>]</span> <span class="bcp14">MAY</span> alternatively be used, such as TLS <span>[<a class="xref" href="#RFC8446">RFC8446</a>]</span> or DTLS <span>[<a class="xref" href="#RFC9147">RFC9147</a>]</span>.<a class="pilcrow" href="#section-2-3">Â¶</a></p>
<p id="section-2-4">
        Once the client has retrieved the access token, it generates a nonce N1, as defined in this document (see <a class="xref" href="#nonce1">Section 4.1.1</a>). The client also generates its own OSCORE Recipient ID, ID1 (see <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8613#section-3.1">Section 3.1</a> of [<a class="xref" href="#RFC8613">RFC8613</a>]</span>), for use with the keying material associated to the RS. The client posts the token, N1, and its Recipient ID to the RS using the authz-info endpoint and mechanisms specified in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9200#section-5.8">Section 5.8</a> of [<a class="xref" href="#RFC9200">RFC9200</a>]</span> and Content-Format = application/ace+cbor. When using this profile, the communication with the authz-info endpoint is not protected, except for the update of access rights.<a class="pilcrow" href="#section-2-4">Â¶</a></p>
<p id="section-2-5">
        If the access token is valid, the RS replies to this request with a 2.01 (Created) response with Content-Format = application/ace+cbor, which contains a nonce N2 and its newly generated OSCORE Recipient ID, ID2, for use with the keying material associated to the client. Moreover, the server concatenates the input salt received in the token, N1, and N2 to obtain the Master Salt of the OSCORE security context (see <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8613#section-3">Section 3</a> of [<a class="xref" href="#RFC8613">RFC8613</a>]</span>).
        The RS then derives the complete security context associated with the received token from the Master Salt; the OSCORE Recipient ID generated by the client (set as its OSCORE Sender ID); its own OSCORE Recipient ID; plus the parameters received in the access token from the AS, following <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8613#section-3.2">Section 3.2</a> of [<a class="xref" href="#RFC8613">RFC8613</a>]</span>.<a class="pilcrow" href="#section-2-5">Â¶</a></p>
<p id="section-2-6">
        In a similar way, after receiving the nonce N2, the client concatenates the input salt, N1, and N2 to obtain the Master Salt of the OSCORE security context. The client then derives the complete security context from the Master Salt; the OSCORE Recipient ID generated by the RS (set as its OSCORE Sender ID); its own OSCORE Recipient ID; plus the parameters received from the AS.<a class="pilcrow" href="#section-2-6">Â¶</a></p>
<p id="section-2-7">
        Finally, the client starts the communication with the RS by sending a request protected with OSCORE to the RS. If the request is successfully verified, the server stores the complete security context state that is ready for use in protecting messages and uses it in the response, and in further communications with the client, until token deletion due to, for example, expiration. This security context is discarded when a token (whether the same or a different one) is used to successfully derive a new security context for that client.<a class="pilcrow" href="#section-2-7">Â¶</a></p>
<p id="section-2-8">
        The use of nonces N1 and N2 during the exchange prevents the reuse of an
        Authenticated Encryption with Associated Data (AEAD) nonce/key pair
        for two different messages. Reuse might otherwise occur when the
        client and RS derive a new security context from an existing (non-expired)
        access token, as might occur when either party has just rebooted, and that might lead to loss of both confidentiality and integrity.
        Instead, by using the exchanged nonces N1 and N2 as part of the Master Salt, the request to the authz-info endpoint posting the same token results in a different security context, by OSCORE construction, since even though the Master Secret, Sender ID, and Recipient ID are the same, the Master Salt is different (see <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8613#section-3.2.1">Section 3.2.1</a> of [<a class="xref" href="#RFC8613">RFC8613</a>]</span>). If the exchanged nonces were reused, a node reusing a non-expired old token would be susceptible to on-path attackers provoking the creation of an OSCORE message using an old AEAD key and nonce.<a class="pilcrow" href="#section-2-8">Â¶</a></p>
<p id="section-2-9">

        After the whole message exchange has taken place, the client can contact the AS to request an update of its access rights, sending a similar request to the token endpoint that also includes an identifier so that the AS can find the correct OSCORE Input Material it has previously shared with the client. This specific identifier, encoded as a byte string, is assigned by the AS to be unique in the sets of its OSCORE Input Materials, and it is not used as input material to derive the full OSCORE security context.<a class="pilcrow" href="#section-2-9">Â¶</a></p>
<p id="section-2-10">
        An overview of the profile flow for the OSCORE profile is given in <a class="xref" href="#prof-overview">Figure 1</a>. The names of messages coincide with those of <span>[<a class="xref" href="#RFC9200">RFC9200</a>]</span> when applicable.<a class="pilcrow" href="#section-2-10">Â¶</a></p>
<span id="name-protocol-overview-2"></span><div id="prof-overview">
<figure id="figure-1">
        <div class="alignLeft art-text artwork" id="section-2-11.1">
<pre>   C                            RS                   AS
   |                            |                     |
   | ----- POST /token  ----------------------------&gt; |
   |                            |                     |
   | &lt;---------------------------- Access Token ----- |
   |                           + Access Information   |
   | ---- POST /authz-info ---&gt; |                     |
   |   (access_token, N1, ID1)  |                     |
   |                            |                     |
   | &lt;- 2.01 Created (N2, ID2)- |                     |
   |                            |                     |
 /Sec Context             /Sec Context                |
   derivation/              derivation/               |
   |                            |                     |
   | ---- OSCORE Request -----&gt; |                     |
   |                            |                     |
   |                    /proof-of-possession          |
   |                    Sec Context storage/          |
   |                            |                     |
   | &lt;--- OSCORE Response ----- |                     |
   |                            |                     |
/proof-of-possession            |                     |
Sec Context storage/            |                     |
   |                            |                     |
   | ---- OSCORE Request -----&gt; |                     |
   |                            |                     |
   | &lt;--- OSCORE Response ----- |                     |
   |                            |                     |
   |           ...              |                     |
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-1">Figure 1</a>:
<a class="selfRef" href="#name-protocol-overview-2">Protocol Overview</a>
        </figcaption></figure>
</div>
</section>
<div id="client-as">
<section id="section-3">
      <h2 id="name-client-as-communication">
<a class="section-number selfRef" href="#section-3">3. </a><a class="section-name selfRef" href="#name-client-as-communication">Client-AS Communication</a>
      </h2>
<p id="section-3-1">
        The following subsections describe the details of the POST request and response to the token endpoint between the client and AS. <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8613#section-3.2">Section 3.2</a> of [<a class="xref" href="#RFC8613">RFC8613</a>]</span> defines how to derive a security context based on a shared Master Secret and a set of other parameters, established between the client and server, which the client receives from the AS in this exchange.  The PoP key included in the response from the AS <span class="bcp14">MUST</span> be used as a Master Secret in OSCORE.<a class="pilcrow" href="#section-3-1">Â¶</a></p>
<div id="c-as">
<section id="section-3.1">
        <h3 id="name-c-to-as-post-to-token-endpo">
<a class="section-number selfRef" href="#section-3.1">3.1. </a><a class="section-name selfRef" href="#name-c-to-as-post-to-token-endpo">C-to-AS: POST to Token Endpoint</a>
        </h3>
<p id="section-3.1-1">
          The client-to-AS request is specified in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9200#section-5.8.1">Section 5.8.1</a> of [<a class="xref" href="#RFC9200">RFC9200</a>]</span>.<a class="pilcrow" href="#section-3.1-1">Â¶</a></p>
<p id="section-3.1-2">
          The client must send this POST request to the token endpoint over a secure channel that guarantees authentication, message integrity, and confidentiality (see <a class="xref" href="#introsp">Section 5</a>).<a class="pilcrow" href="#section-3.1-2">Â¶</a></p>
<p id="section-3.1-3">
          An example of such a request is shown in <a class="xref" href="#ex0">Figure 2</a>.<a class="pilcrow" href="#section-3.1-3">Â¶</a></p>
<span id="name-example-c-to-as-post-token-"></span><div id="ex0">
<figure id="figure-2">
          <div id="section-3.1-4.1">
<pre class="lang-cbor-diag sourcecode">    Header: POST (Code=0.02)
    Uri-Host: "as.example.com"
    Uri-Path: "token"
    Content-Format: application/ace+cbor
    Payload:
    {
      / audience / 5 : "tempSensor4711",
         / scope / 9 : "read"
    }
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-2">Figure 2</a>:
<a class="selfRef" href="#name-example-c-to-as-post-token-">Example C-to-AS POST /token Request for an Access Token Bound to a Symmetric Key</a>
          </figcaption></figure>
</div>
<p id="section-3.1-5">
          If the client wants to update its access rights without changing an existing OSCORE security context, it <span class="bcp14">MUST</span> include a <code>req_cnf</code> object in its POST request to the token endpoint, with the <code>kid</code> field carrying a CBOR byte string containing the OSCORE Input Material identifier (assigned as discussed in <a class="xref" href="#as-c">Section 3.2</a>). This identifier, together with other information such as audience (see <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9200#section-5.8.1">Section 5.8.1</a> of [<a class="xref" href="#RFC9200">RFC9200</a>]</span>), can be used by the AS to determine the shared secret bound to the proof-of-possession token; therefore, it <span class="bcp14">MUST</span> identify a symmetric key that was previously generated by the AS as a shared secret for the communication between the client and the RS. The AS <span class="bcp14">MUST</span> verify that the received value identifies a proof-of-possession key that has previously been issued to the requesting client. If that is not the case, the client-to-AS request <span class="bcp14">MUST</span> be declined with the error code <code>invalid_request</code> as defined in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9200#section-5.8.3">Section 5.8.3</a> of [<a class="xref" href="#RFC9200">RFC9200</a>]</span>.<a class="pilcrow" href="#section-3.1-5">Â¶</a></p>
<p id="section-3.1-6">
          An example of such a request is shown in <a class="xref" href="#ex7">Figure 3</a>.<a class="pilcrow" href="#section-3.1-6">Â¶</a></p>
<span id="name-example-c-to-as-post-token-r"></span><div id="ex7">
<figure id="figure-3">
          <div id="section-3.1-7.1">
<pre class="lang-cbor-diag sourcecode">    Header: POST (Code=0.02)
    Uri-Host: "as.example.com"
    Uri-Path: "token"
    Content-Format: application/ace+cbor
    Payload:
    {
      / audience / 5 : "tempSensor4711",
         / scope / 9 : "write",
       / req_cnf / 4 : {
             / kid / 3 : h'01'
      }
    }
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-3">Figure 3</a>:
<a class="selfRef" href="#name-example-c-to-as-post-token-r">Example C-to-AS POST /token Request for Updating Rights to an Access Token Bound to a Symmetric Key</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="as-c">
<section id="section-3.2">
        <h3 id="name-as-to-c-access-token">
<a class="section-number selfRef" href="#section-3.2">3.2. </a><a class="section-name selfRef" href="#name-as-to-c-access-token">AS-to-C: Access Token</a>
        </h3>
<p id="section-3.2-1">
          After verifying the POST request to the token endpoint and that the client is authorized to obtain an access token corresponding to its access token request, the AS responds as defined in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9200#section-5.8.2">Section 5.8.2</a> of [<a class="xref" href="#RFC9200">RFC9200</a>]</span>. If the client request was invalid, or not authorized, the AS returns an error response as described in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9200#section-5.8.3">Section 5.8.3</a> of [<a class="xref" href="#RFC9200">RFC9200</a>]</span>.<a class="pilcrow" href="#section-3.2-1">Â¶</a></p>
<p id="section-3.2-2">
          The AS can signal that the use of OSCORE is <span class="bcp14">REQUIRED</span> for a specific access token by including the <code>ace_profile</code> parameter with the value <code>coap_oscore</code> in the access token response.  This means that the client <span class="bcp14">MUST</span> use OSCORE towards all resource servers for which this access token is valid, and follow <a class="xref" href="#oscore-setup">Section 4.3</a> to derive the security context to run OSCORE.
Usually, it is assumed that constrained devices will be preconfigured with the necessary profile, so that this kind of profile signaling can be omitted.<a class="pilcrow" href="#section-3.2-2">Â¶</a></p>
<p id="section-3.2-3">
          Moreover, the AS <span class="bcp14">MUST</span> send the following data:<a class="pilcrow" href="#section-3.2-3">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-4.1">a Master Secret<a class="pilcrow" href="#section-3.2-4.1">Â¶</a>
</li>
          <li class="normal" id="section-3.2-4.2">an identifier of the OSCORE Input Material<a class="pilcrow" href="#section-3.2-4.2">Â¶</a>
</li>
        </ul>
<p id="section-3.2-5">
          Additionally, the AS <span class="bcp14">MAY</span> send the following data, in the same response.<a class="pilcrow" href="#section-3.2-5">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-6.1">a context identifier<a class="pilcrow" href="#section-3.2-6.1">Â¶</a>
</li>
          <li class="normal" id="section-3.2-6.2">an AEAD algorithm<a class="pilcrow" href="#section-3.2-6.2">Â¶</a>
</li>
          <li class="normal" id="section-3.2-6.3">an HMAC-based key derivation function (HKDF) algorithm <span>[<a class="xref" href="#RFC5869">RFC5869</a>]</span>. It is specified by the HMAC algorithm value; see <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9053#section-3.1">Section 3.1</a> of [<a class="xref" href="#RFC9053">RFC9053</a>]</span>.<a class="pilcrow" href="#section-3.2-6.3">Â¶</a>
</li>
          <li class="normal" id="section-3.2-6.4">a salt<a class="pilcrow" href="#section-3.2-6.4">Â¶</a>
</li>
          <li class="normal" id="section-3.2-6.5">the OSCORE version number<a class="pilcrow" href="#section-3.2-6.5">Â¶</a>
</li>
        </ul>
<p id="section-3.2-7">
          This data is transported in the OSCORE_Input_Material. The OSCORE_Input_Material is a CBOR map object, defined in <a class="xref" href="#oscore-sec-ctx">Section 3.2.1</a>. This object is transported in the <code>cnf</code> parameter of the access token response, as defined in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9201#section-3.2">Section 3.2</a> of [<a class="xref" href="#RFC9201">RFC9201</a>]</span>, as the value of a field named <code>osc</code>, which is registered in Sections <a class="xref" href="#osc-cwt">9.5</a> and <a class="xref" href="#osc-jwt">9.6</a>.<a class="pilcrow" href="#section-3.2-7">Â¶</a></p>
<p id="section-3.2-8">
          The AS <span class="bcp14">MAY</span> assign an identifier to the context (context identifier). This identifier is used as ID Context in the OSCORE context as described in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8613#section-3.1">Section 3.1</a> of [<a class="xref" href="#RFC8613">RFC8613</a>]</span>. If assigned, these parameters <span class="bcp14">MUST</span> be communicated as the <code>contextId</code> field in the OSCORE_Input_Material. The application needs to consider that this identifier is sent in the clear and may reveal information about the endpoints, as mentioned in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8613#section-12.8">Section 12.8</a> of [<a class="xref" href="#RFC8613">RFC8613</a>]</span>.<a class="pilcrow" href="#section-3.2-8">Â¶</a></p>
<p id="section-3.2-9"> 
          The Master Secret and the identifier of the OSCORE_Input_Material <span class="bcp14">MUST</span> be communicated as the <code>ms</code> and <code>id</code> field in the <code>osc</code> field in the <code>cnf</code> parameter of the access token response. If included, the following are sent: the AEAD algorithm in the <code>alg</code> parameter in the OSCORE_Input_Material; the HKDF algorithm in the <code>hkdf</code> parameter of the OSCORE_Input_Material; a salt in the <code>salt</code> parameter of the OSCORE_Input_Material; and the OSCORE version in the <code>version</code> parameter of the OSCORE_Input_Material.<a class="pilcrow" href="#section-3.2-9">Â¶</a></p>
<p id="section-3.2-10">
         The same parameters <span class="bcp14">MUST</span> be included in the claims associated with the access token.
          The OSCORE Master Secret <span class="bcp14">MUST</span> be encrypted by the authorization server so that only the resource server can decrypt it (see <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9200#section-6.1">Section 6.1</a> of [<a class="xref" href="#RFC9200">RFC9200</a>]</span>). The use of a CBOR Web Token (CWT) protected with COSE_Encrypt/COSE_Encrypt0 as specified in <span>[<a class="xref" href="#RFC8392">RFC8392</a>]</span> is <span class="bcp14">RECOMMENDED</span> in this profile. If the token is a CWT, the same OSCORE_Input_Material structure defined above <span class="bcp14">MUST</span> be placed in the <code>osc</code> field of the <code>cnf</code> claim of this token.<a class="pilcrow" href="#section-3.2-10">Â¶</a></p>
<p id="section-3.2-11">
          The AS <span class="bcp14">MUST</span> send a different OSCORE_Input_Material (and therefore different access tokens) to different authorized clients, in order for the RS to differentiate between clients.<a class="pilcrow" href="#section-3.2-11">Â¶</a></p>
<p id="section-3.2-12">
          <a class="xref" href="#ex1">Figure 4</a> shows an example of an AS response. The access token has been truncated for readability.<a class="pilcrow" href="#section-3.2-12">Â¶</a></p>
<span id="name-example-as-to-c-access-toke"></span><div id="ex1">
<figure id="figure-4">
          <div id="section-3.2-13.1">
<pre class="lang-cbor-diag sourcecode">    Header: Created (Code=2.01)
    Content-Type: application/ace+cbor
    Payload:
    {
      / access_token / 1 : h'8343a1010aa2044c53/...
       (remainder of access token (CWT) omitted for brevity)/',
      / ace_profile / 38 : / coap_oscore / 2,
        / expires_in / 2 : 3600,
               / cnf / 8 : {
                 / osc / 4 : {
                    / id / 0 : h'01',
                    / ms / 2 : h'f9af838368e353e78888e1426bd94e6f'
        }
      }
    }
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-4">Figure 4</a>:
<a class="selfRef" href="#name-example-as-to-c-access-toke">Example AS-to-C Access Token Response with an OSCORE Profile</a>
          </figcaption></figure>
</div>
<p id="section-3.2-14">
          <a class="xref" href="#ex2">Figure 5</a> shows an example CWT Claims Set, including the relevant OSCORE parameters in the <code>cnf</code> claim.<a class="pilcrow" href="#section-3.2-14">Â¶</a></p>
<span id="name-example-cwt-claims-set-with"></span><div id="ex2">
<figure id="figure-5">
          <div id="section-3.2-15.1">
<pre class="lang-cbor-diag sourcecode">{
    / aud / 3 : "tempSensorInLivingRoom",
    / iat / 6 : 1360189224,
    / exp / 4 : 1360289224,
  / scope / 9 :  "temperature_g firmware_p",
    / cnf / 8 : {
      / osc / 4 : {
         / id / 0 : h'01',
         / ms / 2 : h'f9af838368e353e78888e1426bd94e6f'
    }
  }
}

</pre>
</div>
<figcaption><a class="selfRef" href="#figure-5">Figure 5</a>:
<a class="selfRef" href="#name-example-cwt-claims-set-with">Example CWT Claims Set with OSCORE Parameters</a>
          </figcaption></figure>
</div>
<p id="section-3.2-16">
          The same CWT Claims Set as in <a class="xref" href="#ex2">Figure 5</a>, using the value abbreviations defined in <span>[<a class="xref" href="#RFC9200">RFC9200</a>]</span> and <span>[<a class="xref" href="#RFC8747">RFC8747</a>]</span> and encoded in CBOR, is shown in <a class="xref" href="#ex2-cbor">Figure 6</a>. The bytes in hexadecimal are reported in the first column, while their corresponding CBOR meaning is reported after the <code>#</code> sign on the second column, for readability.<a class="pilcrow" href="#section-3.2-16">Â¶</a></p>
<span id="name-example-cwt-claims-set-with-"></span><div id="ex2-cbor">
<figure id="figure-6">
          <div id="section-3.2-17.1">
<pre class="lang-cbor-pretty sourcecode">A5                              # map(5)
   03                           # unsigned(3)
   76                           # text(22)
      74656D7053656E736F72496E4C6976696E67526F6F6D
                                # "tempSensorInLivingRoom"
   06                           # unsigned(6)
   1A 5112D728                  # unsigned(1360189224)
   04                           # unsigned(4)
   1A 51145DC8                  # unsigned(1360289224)
   09                           # unsigned(9)
   78 18                        # text(24)
      74656D70657261747572655F67206669726D776172655F70
                                # "temperature_g firmware_p"
   08                           # unsigned(8)
      A1                        # map(1)
         04                     # unsigned(4)
            A2                  # map(2)
               00               # unsigned(0)
               41               # bytes(1)
                  01
               02               # unsigned(2)
               50               # bytes(16)
                  F9AF838368E353E78888E1426BD94E6F
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-6">Figure 6</a>:
<a class="selfRef" href="#name-example-cwt-claims-set-with-">Example CWT Claims Set with OSCORE Parameters Using CBOR Encoding</a>
          </figcaption></figure>
</div>
<p id="section-3.2-18">
          If the client has requested an update to its access rights using the same OSCORE security context, which is valid and authorized, the AS <span class="bcp14">MUST</span> omit the <code>cnf</code> parameter in the response and <span class="bcp14">MUST</span> carry the OSCORE Input Material identifier in the <code>kid</code> field in the <code>cnf</code> claim of the token. This identifier needs to be included in the token in order for the RS to identify the correct OSCORE Input Material.<a class="pilcrow" href="#section-3.2-18">Â¶</a></p>
<p id="section-3.2-19">
          <a class="xref" href="#ex5">Figure 7</a> shows an example of such an AS response. The access token has been truncated for readability.<a class="pilcrow" href="#section-3.2-19">Â¶</a></p>
<span id="name-example-as-to-c-access-token"></span><div id="ex5">
<figure id="figure-7">
          <div id="section-3.2-20.1">
<pre class="lang-cbor-diag sourcecode">    Header: Created (Code=2.01)
    Content-Type: application/ace+cbor
    Payload:
    {
      / access_token / 1 : h'8343a1010aa2044c53/ ...
       (remainder of access token (CWT) omitted for brevity)/',
      / ace_profile / 38 : / coap_oscore / 2,
        / expires_in / 2 : 3600
    }
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-7">Figure 7</a>:
<a class="selfRef" href="#name-example-as-to-c-access-token">Example AS-to-C Access Token Response with an OSCORE Profile for the Update of Access Rights</a>
          </figcaption></figure>
</div>
<p id="section-3.2-21">
          <a class="xref" href="#ex6">Figure 8</a> shows an example CWT Claims Set that contains the necessary OSCORE parameters in the <code>cnf</code> claim for the update of access rights.<a class="pilcrow" href="#section-3.2-21">Â¶</a></p>
<span id="name-example-cwt-claims-set-with-o"></span><div id="ex6">
<figure id="figure-8">
          <div id="section-3.2-22.1">
<pre class="lang-cbor-diag sourcecode">  {
      / aud / 3 : "tempSensorInLivingRoom",
      / iat / 6 : 1360189224,
      / exp / 4 : 1360289224,
    / scope / 9 :  "temperature_h",
      / cnf / 8 : {
        / kid / 3 : h'01'
    }
  }
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-8">Figure 8</a>:
<a class="selfRef" href="#name-example-cwt-claims-set-with-o">Example CWT Claims Set with OSCORE Parameters for the Update of Access Rights</a>
          </figcaption></figure>
</div>
<div id="oscore-sec-ctx">
<section id="section-3.2.1">
          <h4 id="name-the-oscore_input_material">
<a class="section-number selfRef" href="#section-3.2.1">3.2.1. </a><a class="section-name selfRef" href="#name-the-oscore_input_material">The OSCORE_Input_Material</a>
          </h4>
<p id="section-3.2.1-1">
            An OSCORE_Input_Material is an object that represents the input material to derive an OSCORE security context, i.e., the local set of information elements necessary to carry out the cryptographic operations in OSCORE (<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8613#section-3.1">Section 3.1</a> of [<a class="xref" href="#RFC8613">RFC8613</a>]</span>). In particular, the OSCORE_Input_Material is defined to be serialized and transported between nodes, as specified by this document, but it can also be used by other specifications if needed. The OSCORE_Input_Material can be encoded as either a JSON object or a CBOR map. The set of common parameters that can appear in an OSCORE_Input_Material can be found in the IANA "OSCORE Security Context Parameters" registry (<a class="xref" href="#sec-ctx-params-reg">Section 9.4</a>), defined for extensibility, and the initial set of parameters defined in this document is specified below.
            All parameters are optional.
            <a class="xref" href="#key-labels">Table 1</a> provides a summary of the OSCORE_Input_Material parameters defined in this section.<a class="pilcrow" href="#section-3.2.1-1">Â¶</a></p>
<span id="name-oscore_input_material-param"></span><div id="key-labels">
<table class="center" id="table-1">
            <caption>
<a class="selfRef" href="#table-1">Table 1</a>:
<a class="selfRef" href="#name-oscore_input_material-param">OSCORE_Input_Material Parameters</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" colspan="1" rowspan="1">name</th>
                <th class="text-left" colspan="1" rowspan="1">CBOR label</th>
                <th class="text-left" colspan="1" rowspan="1">CBOR type</th>
                <th class="text-left" colspan="1" rowspan="1">registry</th>
                <th class="text-left" colspan="1" rowspan="1">description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">id</td>
                <td class="text-left" colspan="1" rowspan="1">0</td>
                <td class="text-left" colspan="1" rowspan="1">byte string</td>
                <td class="text-left" colspan="1" rowspan="1"></td>
                <td class="text-left" colspan="1" rowspan="1">OSCORE Input Material identifier</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">version</td>
                <td class="text-left" colspan="1" rowspan="1">1</td>
                <td class="text-left" colspan="1" rowspan="1">unsigned integer</td>
                <td class="text-left" colspan="1" rowspan="1"></td>
                <td class="text-left" colspan="1" rowspan="1">OSCORE version</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">ms</td>
                <td class="text-left" colspan="1" rowspan="1">2</td>
                <td class="text-left" colspan="1" rowspan="1">byte string</td>
                <td class="text-left" colspan="1" rowspan="1"></td>
                <td class="text-left" colspan="1" rowspan="1">OSCORE Master Secret value</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">hkdf</td>
                <td class="text-left" colspan="1" rowspan="1">3</td>
                <td class="text-left" colspan="1" rowspan="1">text string / integer</td>
                <td class="text-left" colspan="1" rowspan="1">
                  <span>[<a class="xref" href="#COSE.Algorithms">COSE.Algorithms</a>]</span> values (HMAC-based)</td>
                <td class="text-left" colspan="1" rowspan="1">OSCORE HKDF value</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">alg</td>
                <td class="text-left" colspan="1" rowspan="1">4</td>
                <td class="text-left" colspan="1" rowspan="1">text string / integer</td>
                <td class="text-left" colspan="1" rowspan="1">
                  <span>[<a class="xref" href="#COSE.Algorithms">COSE.Algorithms</a>]</span> values (AEAD)</td>
                <td class="text-left" colspan="1" rowspan="1">OSCORE AEAD Algorithm value</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">salt</td>
                <td class="text-left" colspan="1" rowspan="1">5</td>
                <td class="text-left" colspan="1" rowspan="1">byte string</td>
                <td class="text-left" colspan="1" rowspan="1"></td>
                <td class="text-left" colspan="1" rowspan="1">an input to OSCORE Master Salt value</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">contextId</td>
                <td class="text-left" colspan="1" rowspan="1">6</td>
                <td class="text-left" colspan="1" rowspan="1">byte string</td>
                <td class="text-left" colspan="1" rowspan="1"></td>
                <td class="text-left" colspan="1" rowspan="1">OSCORE ID Context value</td>
              </tr>
            </tbody>
          </table>
</div>
<span class="break"></span><dl class="dlParallel" id="section-3.2.1-3">
            <dt id="section-3.2.1-3.1">id:</dt>
            <dd id="section-3.2.1-3.2" style="margin-left: 1.5em">
                This parameter identifies the OSCORE_Input_Material and is encoded as a byte string.
                In JSON, the <code>id</code> value is a base64-encoded byte string.
                In CBOR, the <code>id</code> type is a byte string, and it has label 0.<a class="pilcrow" href="#section-3.2.1-3.2">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.1-3.3">version:</dt>
            <dd id="section-3.2.1-3.4" style="margin-left: 1.5em">
                This parameter identifies the OSCORE version number, which is an unsigned integer. For more information about this field, see <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8613#section-5.4">Section 5.4</a> of [<a class="xref" href="#RFC8613">RFC8613</a>]</span>.
                In JSON, the <code>version</code> value is an integer.
                In CBOR, the <code>version</code> type is an integer, and it has label 1.<a class="pilcrow" href="#section-3.2.1-3.4">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.1-3.5">ms:</dt>
            <dd id="section-3.2.1-3.6" style="margin-left: 1.5em">
                This parameter identifies the OSCORE Master Secret value, which is a byte string. For more information about this field, see <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8613#section-3.1">Section 3.1</a> of [<a class="xref" href="#RFC8613">RFC8613</a>]</span>.
                In JSON, the <code>ms</code> value is a base64-encoded byte string.
                In CBOR, the <code>ms</code> type is byte string, and it has label 2.<a class="pilcrow" href="#section-3.2.1-3.6">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.1-3.7">hkdf:</dt>
            <dd id="section-3.2.1-3.8" style="margin-left: 1.5em">
                This parameter identifies the OSCORE HKDF Algorithm. For more information about this field, see <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8613#section-3.1">Section 3.1</a> of [<a class="xref" href="#RFC8613">RFC8613</a>]</span>.
                The values used <span class="bcp14">MUST</span> be registered in the IANA "COSE Algorithms" registry (see <span>[<a class="xref" href="#COSE.Algorithms">COSE.Algorithms</a>]</span>) and <span class="bcp14">MUST</span> be HMAC-based HKDF algorithms (see <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9053#section-3.1">Section 3.1</a> of [<a class="xref" href="#RFC9053">RFC9053</a>]</span>). The value can be either the integer or the text-string value of the HMAC-based HKDF algorithm in the "COSE Algorithms" registry.
                In JSON, the <code>hkdf</code> value is a case-sensitive ASCII string or an integer.
                In CBOR, the <code>hkdf</code> type is a text string or integer, and it has label 3.<a class="pilcrow" href="#section-3.2.1-3.8">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.1-3.9">alg:</dt>
            <dd id="section-3.2.1-3.10" style="margin-left: 1.5em">
                This parameter identifies the OSCORE AEAD Algorithm. For more information about this field, see <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8613#section-3.1">Section 3.1</a> of [<a class="xref" href="#RFC8613">RFC8613</a>]</span>.
                The values used <span class="bcp14">MUST</span> be registered in the IANA "COSE Algorithms" registry (see <span>[<a class="xref" href="#COSE.Algorithms">COSE.Algorithms</a>]</span>) and <span class="bcp14">MUST</span> be AEAD algorithms. The value can be either the integer or the text-string value of the HMAC-based HKDF algorithm in the "COSE Algorithms" registry.
                In JSON, the <code>alg</code> value is a case-sensitive ASCII string or an integer.
                In CBOR, the <code>alg</code> type is a text string or integer, and it has label 4.<a class="pilcrow" href="#section-3.2.1-3.10">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.1-3.11">salt:</dt>
            <dd id="section-3.2.1-3.12" style="margin-left: 1.5em">
                This parameter identifies an input to the OSCORE Master Salt value, which is a byte string. For more information about this field, see <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8613#section-3.1">Section 3.1</a> of [<a class="xref" href="#RFC8613">RFC8613</a>]</span>.
                In JSON, the <code>salt</code> value is a base64-encoded byte string.
                In CBOR, the <code>salt</code> type is a byte string, and it has label 5.<a class="pilcrow" href="#section-3.2.1-3.12">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.1-3.13">contextId:</dt>
            <dd id="section-3.2.1-3.14" style="margin-left: 1.5em">
                This parameter identifies the security context as a byte string. This identifier is used as OSCORE ID Context. For more information about this field, see <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8613#section-3.1">Section 3.1</a> of [<a class="xref" href="#RFC8613">RFC8613</a>]</span>.
                In JSON, the <code>contextID</code> value is a base64-encoded byte string.
                In CBOR, the <code>contextID</code> type is a byte string, and it has label 6.<a class="pilcrow" href="#section-3.2.1-3.14">Â¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-3.2.1-4">
            An example of JSON OSCORE_Input_Material is given in <a class="xref" href="#JSON-osc">Figure 9</a>.<a class="pilcrow" href="#section-3.2.1-4">Â¶</a></p>
<span id="name-example-json-oscore_input_m"></span><div id="JSON-osc">
<figure id="figure-9">
            <div id="section-3.2.1-5.1">
<pre class="lang-json sourcecode">                "osc" : {
                  "alg" : "AES-CCM-16-64-128",
                   "id" : "AQ",
                   "ms" : "-a-Dg2jjU-eIiOFCa9lObw"
                }
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-9">Figure 9</a>:
<a class="selfRef" href="#name-example-json-oscore_input_m">Example JSON OSCORE_Input_Material</a>
            </figcaption></figure>
</div>
<p id="section-3.2.1-6">
            The CDDL grammar describing the CBOR OSCORE_Input_Material is shown in <a class="xref" href="#CDDL-osc">Figure 10</a>.<a class="pilcrow" href="#section-3.2.1-6">Â¶</a></p>
<span id="name-cddl-grammar-of-the-oscore_"></span><div id="CDDL-osc">
<figure id="figure-10">
            <div id="section-3.2.1-7.1">
<pre class="lang-cddl sourcecode">OSCORE_Input_Material = {
    ? 0 =&gt; bstr,              ; id
    ? 1 =&gt; int,               ; version
    ? 2 =&gt; bstr,              ; ms
    ? 3 =&gt; tstr / int,        ; hkdf
    ? 4 =&gt; tstr / int,        ; alg
    ? 5 =&gt; bstr,              ; salt
    ? 6 =&gt; bstr,              ; contextId
    * (int / tstr) =&gt; any
}
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-10">Figure 10</a>:
<a class="selfRef" href="#name-cddl-grammar-of-the-oscore_">CDDL Grammar of the OSCORE_Input_Material</a>
            </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="c-rs1">
<section id="section-4">
      <h2 id="name-client-rs-communication">
<a class="section-number selfRef" href="#section-4">4. </a><a class="section-name selfRef" href="#name-client-rs-communication">Client-RS Communication</a>
      </h2>
<p id="section-4-1">
        The following subsections describe the details of the POST request and response to the authz-info endpoint between the client and RS. The client generates a nonce N1 and an identifier ID1 that is unique in the sets of its own Recipient IDs and posts them together with the token that includes the materials (e.g., OSCORE parameters) received from the AS to the RS. The RS then generates a nonce N2 and an identifier ID2 that is unique in the sets of its own Recipient IDs and uses <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8613#section-3.2">Section 3.2</a> of [<a class="xref" href="#RFC8613">RFC8613</a>]</span> to derive a security context based on a shared Master Secret, the two exchanged nonces, and the two identifiers, established between the client and server. The exchanged nonces and identifiers are encoded as a CBOR byte string if CBOR is used and as a base64 string if JSON is used. This security context is used to protect all future communication between the client and RS using OSCORE, as long as the access token is valid.<a class="pilcrow" href="#section-4-1">Â¶</a></p>
<p id="section-4-2">
        Note that the RS and client authenticate each other
        by generating the shared OSCORE security context using
        the PoP key as the Master Secret.  An attacker
        posting a valid token to the RS will not be able to generate a valid OSCORE security context and
        thus will not be able to prove possession of the PoP key. Additionally, the mutual authentication is only achieved after the client has successfully verified a response from the RS protected with the generated OSCORE security context.<a class="pilcrow" href="#section-4-2">Â¶</a></p>
<div id="c-rs">
<section id="section-4.1">
        <h3 id="name-c-to-rs-post-to-authz-info-">
<a class="section-number selfRef" href="#section-4.1">4.1. </a><a class="section-name selfRef" href="#name-c-to-rs-post-to-authz-info-">C-to-RS: POST to authz-info Endpoint</a>
        </h3>
<p id="section-4.1-1">
          The client <span class="bcp14">MUST</span> generate a nonce value N1 that is very unlikely to have been previously used with the same input keying material. The use of a 64-bit long random number as the nonce's value is <span class="bcp14">RECOMMENDED</span> in this profile. The client <span class="bcp14">MUST</span> store the nonce N1 as long as the response from the RS is not received and the access token related to it is still valid (to the best of the client's knowledge).<a class="pilcrow" href="#section-4.1-1">Â¶</a></p>
<p id="section-4.1-2">
          The client generates its own Recipient ID, ID1, for the OSCORE security context that it is establishing with the RS. By generating its own Recipient ID, the client makes sure that it does not collide with any of its Recipient IDs, nor with any other identifier ID1 if the client is executing this exchange with a different RS at the same time.<a class="pilcrow" href="#section-4.1-2">Â¶</a></p>
<p id="section-4.1-3">
          The client <span class="bcp14">MUST</span> use CoAP and the authorization information resource as described in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9200#section-5.8.1">Section 5.8.1</a> of [<a class="xref" href="#RFC9200">RFC9200</a>]</span> to transport the token, N1, and ID1 to the RS.<a class="pilcrow" href="#section-4.1-3">Â¶</a></p>
<p id="section-4.1-4">
          Note that the use of the payload and the Content-Format is different from what is described in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9200#section-5.8.1">Section 5.8.1</a> of [<a class="xref" href="#RFC9200">RFC9200</a>]</span>, which only transports the token without any CBOR wrapping. In this profile, the client <span class="bcp14">MUST</span> wrap the token, N1, and ID1 in a CBOR map.
The client <span class="bcp14">MUST</span> use the Content-Format application/ace+cbor defined in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9200#section-8.16">Section 8.16</a> of [<a class="xref" href="#RFC9200">RFC9200</a>]</span>. The client <span class="bcp14">MUST</span> include the access token using the <code>access_token</code> parameter; N1 using the <code>nonce1</code> parameter defined in <a class="xref" href="#nonce1">Section 4.1.1</a>; and ID1 using the <code>ace_client_recipientid</code> parameter defined in <a class="xref" href="#id1">Section 4.1.2</a>.<a class="pilcrow" href="#section-4.1-4">Â¶</a></p>
<p id="section-4.1-5">
          The communication with the authz-info endpoint does not have to be protected, except for the update of access rights case described below.<a class="pilcrow" href="#section-4.1-5">Â¶</a></p>
<p id="section-4.1-6">
          Note that a client may be required to repost the access token in order to complete a request, since an RS may delete a stored access token (and associated security context) at any time, for example, due to all storage space being consumed. This situation is detected by the client when it receives an AS Request Creation Hints response. Reposting the same access token will result in deriving a new OSCORE security context to be used with the RS, as different exchanged nonces will be used.<a class="pilcrow" href="#section-4.1-6">Â¶</a></p>
<p id="section-4.1-7">
          The client may also choose to repost the access token in order to update its OSCORE security context. In that case, the client and the RS will exchange newly generated nonces, renegotiate identifiers, and derive new keying material. The client and RS might decide to keep the same identifiers or renew them during the renegotiation.<a class="pilcrow" href="#section-4.1-7">Â¶</a></p>
<p id="section-4.1-8">
          <a class="xref" href="#ex3">Figure 11</a> shows an example of the request sent from the client to the RS. The access token has been truncated for readability.<a class="pilcrow" href="#section-4.1-8">Â¶</a></p>
<span id="name-example-c-to-rs-post-authz-"></span><div id="ex3">
<figure id="figure-11">
          <div id="section-4.1-9.1">
<pre class="lang-cbor-diag sourcecode">      Header: POST (Code=0.02)
      Uri-Host: "rs.example.com"
      Uri-Path: "authz-info"
      Content-Format: application/ace+cbor
      Payload:
        {
                     / access_token / 1 : h'8343a1010aa2044c53/...
       (remainder of access token (CWT) omitted for brevity)/',
                          / nonce1 / 40 : h'018a278f7faab55a',
          / ace_client_recipientid / 43 : h'1645'
        }
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-11">Figure 11</a>:
<a class="selfRef" href="#name-example-c-to-rs-post-authz-">Example C-to-RS POST /authz-info Request Using CWT</a>
          </figcaption></figure>
</div>
<p id="section-4.1-10">
          If the client has already posted a valid token, has already established a security association with the RS, and wants to update its access rights, the client can do so by posting the new token (retrieved from the AS and containing the update of access rights) to the /authz-info endpoint. The client <span class="bcp14">MUST</span> protect the request using the OSCORE security context established during the first token exchange. The client <span class="bcp14">MUST</span> only send the <code>access_token</code> field in the CBOR map in the payload; no nonce or identifier is sent. After proper verification (see <a class="xref" href="#rs-c">Section 4.2</a>), the RS will replace the old token with the new one, maintaining the same security context.<a class="pilcrow" href="#section-4.1-10">Â¶</a></p>
<div id="nonce1">
<section id="section-4.1.1">
          <h4 id="name-the-nonce-1-parameter">
<a class="section-number selfRef" href="#section-4.1.1">4.1.1. </a><a class="section-name selfRef" href="#name-the-nonce-1-parameter">The Nonce 1 Parameter</a>
          </h4>
<p id="section-4.1.1-1">
             The <code>nonce1</code> parameter <span class="bcp14">MUST</span> be sent from the client to the RS, together with the access token, if the ACE profile used is <code>coap_oscore</code>, and the message is not an update of access rights, protected with an existing OSCORE security context.  The parameter is encoded as a byte string for
   CBOR-based interactions and as a string (base64-encoded binary) for
   JSON-based interactions. This parameter is registered in <a class="xref" href="#iana-nonces-ids">Section 9.2</a>.<a class="pilcrow" href="#section-4.1.1-1">Â¶</a></p>
</section>
</div>
<div id="id1">
<section id="section-4.1.2">
          <h4 id="name-the-ace_client_recipientid-">
<a class="section-number selfRef" href="#section-4.1.2">4.1.2. </a><a class="section-name selfRef" href="#name-the-ace_client_recipientid-">The ace_client_recipientid Parameter</a>
          </h4>
<p id="section-4.1.2-1">
             The <code>ace_client_recipientid</code> parameter <span class="bcp14">MUST</span> be sent from the client to the RS, together with the access token, if the ACE profile used is <code>coap_oscore</code>, and the message is not an update of access rights, protected with an existing OSCORE security context.  The parameter is encoded as a byte string for
   CBOR-based interactions and as a string (base64-encoded binary) for
   JSON-based interactions. This parameter is registered in <a class="xref" href="#iana-nonces-ids">Section 9.2</a>.<a class="pilcrow" href="#section-4.1.2-1">Â¶</a></p>
</section>
</div>
</section>
</div>
<div id="rs-c">
<section id="section-4.2">
        <h3 id="name-rs-to-c-201-created">
<a class="section-number selfRef" href="#section-4.2">4.2. </a><a class="section-name selfRef" href="#name-rs-to-c-201-created">RS-to-C: 2.01 (Created)</a>
        </h3>
<p id="section-4.2-1">
          The RS <span class="bcp14">MUST</span> follow the procedures defined in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9200#section-5.8.1">Section 5.8.1</a> of [<a class="xref" href="#RFC9200">RFC9200</a>]</span>: the RS must verify the validity of the token. If the token is valid, the RS must respond to the POST request with 2.01 (Created).
   If the token is valid but is associated to claims that the RS cannot process (e.g., an unknown scope), or if any of the expected parameters are missing (e.g., any of the mandatory parameters from the AS or the identifier ID1), or if any parameters received in the <code>osc</code> field are unrecognized, the RS must respond with an error response code equivalent to the CoAP code 4.00 (Bad Request). In the latter two cases, the RS may provide additional information in the error response, in order to clarify what went wrong.
          The RS may make an introspection request (see <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9200#section-5.9.1">Section 5.9.1</a> of [<a class="xref" href="#RFC9200">RFC9200</a>]</span>) to validate the token before responding to the POST request to the authz-info endpoint.<a class="pilcrow" href="#section-4.2-1">Â¶</a></p>
<p id="section-4.2-2">
          Additionally, the RS <span class="bcp14">MUST</span> generate a nonce N2 that is very unlikely to have been previously used with the same input keying material and its own Recipient ID, ID2. The RS makes sure that ID2 does not collide with any of its Recipient IDs. The RS <span class="bcp14">MUST</span> ensure that ID2 is different from the value received in the <code>ace_client_recipientid</code> parameter. The RS sends N2 and ID2 within the 2.01 (Created) response. The payload of the 2.01 (Created) response <span class="bcp14">MUST</span> be a CBOR map containing the <code>nonce2</code> parameter defined in <a class="xref" href="#nonce2">Section 4.2.1</a>, set to N2, and the <code>ace_server_recipientid</code> parameter defined in <a class="xref" href="#id2">Section 4.2.2</a>, set to ID2. The use of a 64-bit long random number as the nonce's value is <span class="bcp14">RECOMMENDED</span> in this profile.

   The RS <span class="bcp14">MUST</span> use the Content-Format application/ace+cbor defined in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9200#section-8.16">Section 8.16</a> of [<a class="xref" href="#RFC9200">RFC9200</a>]</span>.<a class="pilcrow" href="#section-4.2-2">Â¶</a></p>
<p id="section-4.2-3">
          <a class="xref" href="#ex4">Figure 12</a> shows an example of the response sent from the RS to the client.<a class="pilcrow" href="#section-4.2-3">Â¶</a></p>
<span id="name-example-rs-to-c-201-created"></span><div id="ex4">
<figure id="figure-12">
          <div id="section-4.2-4.1">
<pre class="lang-cbor-diag sourcecode">      Header: Created (Code=2.01)
      Content-Format: application/ace+cbor
      Payload:
        {
                          / nonce2 / 42 : h'25a8991cd700ac01',
          / ace_server_recipientid / 44 : h'0000'
        }
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-12">Figure 12</a>:
<a class="selfRef" href="#name-example-rs-to-c-201-created">Example RS-to-C 2.01 (Created) Response</a>
          </figcaption></figure>
</div>
<p id="section-4.2-5">
          As specified in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9200#section-5.8.3">Section 5.8.3</a> of [<a class="xref" href="#RFC9200">RFC9200</a>]</span>, the RS must notify the client with an error response with code 4.01 (Unauthorized) for any long running request before terminating the session, when the access token expires.<a class="pilcrow" href="#section-4.2-5">Â¶</a></p>
<p id="section-4.2-6">
          If the RS receives the token in an OSCORE-protected message, it means that the client is requesting an update of access rights. The RS <span class="bcp14">MUST</span> ignore any nonce and identifiers in the request, if any were sent. The RS <span class="bcp14">MUST</span> check that the <code>kid</code> of the <code>cnf</code> claim of the new access token matches the identifier of the OSCORE Input Material of the context used to protect the message. If that is the case, the RS <span class="bcp14">MUST</span> overwrite the old token and associate the new token to the security context identified by the <code>kid</code> value in the <code>cnf</code> claim. The RS <span class="bcp14">MUST</span> respond with a 2.01 (Created) response protected with the same security context, with no payload. If any verification fails, the RS <span class="bcp14">MUST</span> respond with a 4.01 (Unauthorized) error response.<a class="pilcrow" href="#section-4.2-6">Â¶</a></p>
<p id="section-4.2-7">
          As specified in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9200#section-5.8.1">Section 5.8.1</a> of [<a class="xref" href="#RFC9200">RFC9200</a>]</span>, when receiving an updated access token with updated authorization information from the client (see <a class="xref" href="#c-as">Section 3.1</a>), it is recommended that the RS overwrites the previous token; that is, only the latest authorization information in the token received by the RS is valid. This simplifies the process needed by the RS to keep track of authorization information for a given client.<a class="pilcrow" href="#section-4.2-7">Â¶</a></p>
<div id="nonce2">
<section id="section-4.2.1">
          <h4 id="name-the-nonce-2-parameter">
<a class="section-number selfRef" href="#section-4.2.1">4.2.1. </a><a class="section-name selfRef" href="#name-the-nonce-2-parameter">The Nonce 2 Parameter</a>
          </h4>
<p id="section-4.2.1-1">
             The <code>nonce2</code> parameter <span class="bcp14">MUST</span> be sent from the RS to the client if the ACE profile used is <code>coap_oscore</code> and the message is not a response to an update of access rights, protected with an existing OSCORE security context. The parameter is encoded as a byte string for
   CBOR-based interactions and as a string (base64-encoded binary) for
   JSON-based interactions. This parameter is registered in <a class="xref" href="#iana-nonces-ids">Section 9.2</a><a class="pilcrow" href="#section-4.2.1-1">Â¶</a></p>
</section>
</div>
<div id="id2">
<section id="section-4.2.2">
          <h4 id="name-the-ace_server_recipientid-">
<a class="section-number selfRef" href="#section-4.2.2">4.2.2. </a><a class="section-name selfRef" href="#name-the-ace_server_recipientid-">The ace_server_recipientid Parameter</a>
          </h4>
<p id="section-4.2.2-1">
             The <code>ace_server_recipientid</code> parameter <span class="bcp14">MUST</span> be sent from the RS to the client if the ACE profile used is <code>coap_oscore</code> and the message is not a response to an update of access rights, protected with an existing OSCORE security context. The parameter is encoded as a byte string for
   CBOR-based interactions and as a string (base64-encoded binary) for
   JSON-based interactions. This parameter is registered in <a class="xref" href="#iana-nonces-ids">Section 9.2</a><a class="pilcrow" href="#section-4.2.2-1">Â¶</a></p>
</section>
</div>
</section>
</div>
<div id="oscore-setup">
<section id="section-4.3">
        <h3 id="name-oscore-setup">
<a class="section-number selfRef" href="#section-4.3">4.3. </a><a class="section-name selfRef" href="#name-oscore-setup">OSCORE Setup</a>
        </h3>
<p id="section-4.3-1">
          Once the 2.01 (Created) response is received from the RS, following the POST request to authz-info endpoint, the client <span class="bcp14">MUST</span> extract the bstr nonce N2 from the <code>nonce2</code> parameter in the CBOR map in the payload of the response. Then, the client <span class="bcp14">MUST</span> set the Master Salt of the security context created to communicate with the RS to the concatenation of salt, N1, and N2 in this order: Master Salt = salt | N1 | N2, where | denotes byte string concatenation, salt is the CBOR byte string received from the AS in <a class="xref" href="#as-c">Section 3.2</a>, and N1 and N2 are the two nonces encoded as CBOR byte strings.  An example of Master Salt construction using CBOR encoding is given in <a class="xref" href="#ms-ex">Figure 13</a>.<a class="pilcrow" href="#section-4.3-1">Â¶</a></p>
<span id="name-example-of-master-salt-cons"></span><div id="ms-ex">
<figure id="figure-13">
          <div id="section-4.3-2.1">
<pre class="sourcecode">N1, N2, and input salt expressed in CBOR diagnostic notation:
      nonce1 = h'018a278f7faab55a'
      nonce2 = h'25a8991cd700ac01'
      input salt = h'f9af838368e353e78888e1426bd94e6f'

N1, N2, and input salt as CBOR encoded byte strings:
      nonce1 = 0x48018a278f7faab55a
      nonce2 = 0x4825a8991cd700ac01
      input salt = 0x50f9af838368e353e78888e1426bd94e6f

Master Salt = 0x50 f9af838368e353e78888e1426bd94e6f
                48 018a278f7faab55a 48 25a8991cd700ac01
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-13">Figure 13</a>:
<a class="selfRef" href="#name-example-of-master-salt-cons">Example of Master Salt Construction Using CBOR Encoding</a>
          </figcaption></figure>
</div>
<p id="section-4.3-3">
          If JSON is used instead of CBOR, the Master Salt of the security context is the base64 encoding of the concatenation of the same parameters, each of them prefixed by their size, encoded in 1 byte. When using JSON, the nonces and input salt have a maximum size of 255 bytes. An example of Master Salt construction using base64 encoding is given in <a class="xref" href="#ms-ex-2">Figure 14</a>.<a class="pilcrow" href="#section-4.3-3">Â¶</a></p>
<span id="name-example-of-master-salt-const"></span><div id="ms-ex-2">
<figure id="figure-14">
          <div id="section-4.3-4.1">
<pre class="sourcecode">N1, N2, and input salt values:
      nonce1 = 0x018a278f7faab55a (8 bytes)
      nonce2 = 0x25a8991cd700ac01 (8 bytes)
      input salt = 0xf9af838368e353e78888e1426bd94e6f (16 bytes)

Input to base64 encoding: 0x10 f9af838368e353e78888e1426bd94e6f
                            08 018a278f7faab55a 08 25a8991cd700ac01

Master Salt = b64'EPmvg4No41PniIjhQmvZTm8IAYonj3+qtVoIJaiZHNcArAE='
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-14">Figure 14</a>:
<a class="selfRef" href="#name-example-of-master-salt-const">Example of Master Salt Construction Using Base64 Encoding</a>
          </figcaption></figure>
</div>
<p id="section-4.3-5">
           The client <span class="bcp14">MUST</span> set the Sender ID to the <code>ace_server_recipientid</code> received in <a class="xref" href="#rs-c">Section 4.2</a> and set the Recipient ID to the <code>ace_client_recipientid</code> sent in <a class="xref" href="#c-rs">Section 4.1</a>. The client <span class="bcp14">MUST</span> set the Master Secret from the parameter received from the AS in <a class="xref" href="#as-c">Section 3.2</a>. The client <span class="bcp14">MUST</span> set the AEAD algorithm, ID Context, HKDF, and OSCORE version from the parameters received from the AS in <a class="xref" href="#as-c">Section 3.2</a>, if present. In case an optional parameter is omitted, the default value <span class="bcp14">SHALL</span> be used as described in Sections <a class="relref" href="https://www.rfc-editor.org/rfc/rfc8613#section-3.2">3.2</a> and <a class="relref" href="https://www.rfc-editor.org/rfc/rfc8613#section-5.4">5.4</a> of <span>[<a class="xref" href="#RFC8613">RFC8613</a>]</span>. After that, the client <span class="bcp14">MUST</span> derive the complete security context following <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8613#section-3.2.1">Section 3.2.1</a> of [<a class="xref" href="#RFC8613">RFC8613</a>]</span>. From this point on, the client <span class="bcp14">MUST</span> use this security context to communicate with the RS when accessing the resources as specified by the authorization information.<a class="pilcrow" href="#section-4.3-5">Â¶</a></p>
<p id="section-4.3-6">
          If any of the expected parameters are missing (e.g., any of the mandatory parameters from the AS or the RS), or if <code>ace_client_recipientid</code> equals <code>ace_server_recipientid</code> (and as a consequence, the Sender and Recipient Keys derived would be equal; see <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8613#section-3.3">Section 3.3</a> of [<a class="xref" href="#RFC8613">RFC8613</a>]</span>), then the client <span class="bcp14">MUST</span> stop the exchange and <span class="bcp14">MUST NOT</span> derive the security context. The client <span class="bcp14">MAY</span> restart the exchange, to get the correct security material.<a class="pilcrow" href="#section-4.3-6">Â¶</a></p>
<p id="section-4.3-7">
          The client then uses this security context to send requests to the RS using OSCORE.<a class="pilcrow" href="#section-4.3-7">Â¶</a></p>
<p id="section-4.3-8">
          After sending the 2.01 (Created) response, the RS <span class="bcp14">MUST</span> set the Master Salt of the security context created to communicate with the client to the concatenation of salt, N1, and N2 in the same way described above. An example of Master Salt construction using CBOR encoding is given in <a class="xref" href="#ms-ex">Figure 13</a> and using base64 encoding is given in <a class="xref" href="#ms-ex-2">Figure 14</a>. The RS <span class="bcp14">MUST</span> set the Sender ID from the <code>ace_client_recipientid</code> received in <a class="xref" href="#c-rs">Section 4.1</a> and set the Recipient ID from the <code>ace_server_recipientid</code> sent in <a class="xref" href="#rs-c">Section 4.2</a>. The RS <span class="bcp14">MUST</span> set the Master Secret from the parameter received from the AS and forwarded by the client in the access token in <a class="xref" href="#c-rs">Section 4.1</a> after validation of the token as specified in <a class="xref" href="#rs-c">Section 4.2</a>. The RS <span class="bcp14">MUST</span> set the AEAD algorithm, ID Context, HKDF, and OSCORE version from the parameters received from the AS and forwarded by the client in the access token in <a class="xref" href="#c-rs">Section 4.1</a> after validation of the token as specified in <a class="xref" href="#rs-c">Section 4.2</a>, if present. In case an optional parameter is omitted, the default value <span class="bcp14">SHALL</span> be used as described in Sections <a class="relref" href="https://www.rfc-editor.org/rfc/rfc8613#section-3.2">3.2</a> and <a class="relref" href="https://www.rfc-editor.org/rfc/rfc8613#section-5.4">5.4</a> of <span>[<a class="xref" href="#RFC8613">RFC8613</a>]</span>. After that, the RS <span class="bcp14">MUST</span> derive the complete security context following <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8613#section-3.2.1">Section 3.2.1</a> of [<a class="xref" href="#RFC8613">RFC8613</a>]</span> and <span class="bcp14">MUST</span> associate this security context with the authorization information from the access token.<a class="pilcrow" href="#section-4.3-8">Â¶</a></p>
<p id="section-4.3-9">
          The RS then uses this security context to verify requests and send responses to the client using OSCORE. If OSCORE verification fails, error responses are used, as specified in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8613#section-8">Section 8</a> of [<a class="xref" href="#RFC8613">RFC8613</a>]</span>. Additionally, if OSCORE verification succeeds, the verification of access rights is performed as described in <a class="xref" href="#tok-ver">Section 4.4</a>. The RS <span class="bcp14">MUST NOT</span> use the security context after the related token has expired and <span class="bcp14">MUST</span> respond with an unprotected 4.01 (Unauthorized) error message to
requests received that correspond to a security context with an expired
token.<a class="pilcrow" href="#section-4.3-9">Â¶</a></p>
<p id="section-4.3-10">
          Note that the ID Context can be assigned by the AS, communicated and set in both the RS and client after the exchange specified in this profile is executed. Subsequently, the client and RS can update their ID Context by running a mechanism such as the one defined in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8613#appendix-B.2">Appendix B.2</a> of [<a class="xref" href="#RFC8613">RFC8613</a>]</span> if they both support it and are configured to do so. In that case, the ID Context in the OSCORE security context will not match the <code>contextId</code> parameter of the corresponding OSCORE_Input_Material. Running Appendix <a class="relref" href="https://www.rfc-editor.org/rfc/rfc8613#appendix-B.2">B.2</a> results in the keying material being updated in the security contexts of the client and RS; this same result can also be achieved by the client reposting the access token to the unprotected /authz-info endpoint at the RS, as described in <a class="xref" href="#c-rs">Section 4.1</a>, but without updating the ID Context.<a class="pilcrow" href="#section-4.3-10">Â¶</a></p>
</section>
</div>
<div id="tok-ver">
<section id="section-4.4">
        <h3 id="name-access-rights-verification">
<a class="section-number selfRef" href="#section-4.4">4.4. </a><a class="section-name selfRef" href="#name-access-rights-verification">Access Rights Verification</a>
        </h3>
<p id="section-4.4-1">
          The RS <span class="bcp14">MUST</span> follow the procedures defined in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9200#section-5.8.2">Section 5.8.2</a> of [<a class="xref" href="#RFC9200">RFC9200</a>]</span>: if an RS receives an OSCORE-protected request from a client, then the RS processes it according to <span>[<a class="xref" href="#RFC8613">RFC8613</a>]</span>. If OSCORE verification succeeds, and the target resource
          requires authorization, the RS retrieves the authorization information using the access token associated to the security context. The RS then must verify that the authorization information covers the resource and the action requested.<a class="pilcrow" href="#section-4.4-1">Â¶</a></p>
</section>
</div>
</section>
</div>
<div id="introsp">
<section id="section-5">
      <h2 id="name-secure-communication-with-a">
<a class="section-number selfRef" href="#section-5">5. </a><a class="section-name selfRef" href="#name-secure-communication-with-a">Secure Communication with AS</a>
      </h2>
<p id="section-5-1">
        As specified in the ACE framework (<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9200#section-5.9">Section 5.9</a> of [<a class="xref" href="#RFC9200">RFC9200</a>]</span>), the requesting entity (RS and/or client) and the AS communicates via the introspection or token endpoint. The use of CoAP and OSCORE <span>[<a class="xref" href="#RFC8613">RFC8613</a>]</span> for this communication is <span class="bcp14">RECOMMENDED</span> in this profile; other protocols fulfilling the security requirements defined in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9200#section-5">Section 5</a> of [<a class="xref" href="#RFC9200">RFC9200</a>]</span> (such as HTTP and DTLS or TLS) <span class="bcp14">MAY</span> be used instead.<a class="pilcrow" href="#section-5-1">Â¶</a></p>
<p id="section-5-2">
        If OSCORE is used, the requesting entity and the AS are expected to have preestablished security contexts in place.  How these security contexts are established is out of scope for this profile.  Furthermore, the requesting entity and the AS communicate through the introspection endpoint as specified in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9200#section-5.9">Section 5.9</a> of [<a class="xref" href="#RFC9200">RFC9200</a>]</span> and through the token endpoint as specified in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9200#section-5.8">Section 5.8</a> of [<a class="xref" href="#RFC9200">RFC9200</a>]</span>.<a class="pilcrow" href="#section-5-2">Â¶</a></p>
</section>
</div>
<div id="sec-ctx-discard">
<section id="section-6">
      <h2 id="name-discarding-the-security-con">
<a class="section-number selfRef" href="#section-6">6. </a><a class="section-name selfRef" href="#name-discarding-the-security-con">Discarding the Security Context</a>
      </h2>
<p id="section-6-1">
        There are a number of scenarios where a client or RS needs to discard the OSCORE security context and acquire a new one.<a class="pilcrow" href="#section-6-1">Â¶</a></p>
<p id="section-6-2">
        The client <span class="bcp14">MUST</span> discard the current security context associated with an RS when any of the following occurs:<a class="pilcrow" href="#section-6-2">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-6-3.1"> the sequence number space ends.<a class="pilcrow" href="#section-6-3.1">Â¶</a>
</li>
        <li class="normal" id="section-6-3.2"> the access token associated with the context becomes invalid due to, for example, expiration.<a class="pilcrow" href="#section-6-3.2">Â¶</a>
</li>
        <li class="normal" id="section-6-3.3"> the client receives a number of 4.01 Unauthorized responses to OSCORE requests using the same security context. The exact number needs to be specified by the application.<a class="pilcrow" href="#section-6-3.3">Â¶</a>
</li>
        <li class="normal" id="section-6-3.4"> the client receives a new nonce in the 2.01 (Created) response (see <a class="xref" href="#rs-c">Section 4.2</a>) to a POST request to the authz-info endpoint, when reposting a (non-expired) token associated to the existing context.<a class="pilcrow" href="#section-6-3.4">Â¶</a>
</li>
      </ul>
<p id="section-6-4">
        The RS <span class="bcp14">MUST</span> discard the current security context associated with a client when any of the following occurs:<a class="pilcrow" href="#section-6-4">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-6-5.1"> the sequence number space ends.<a class="pilcrow" href="#section-6-5.1">Â¶</a>
</li>
        <li class="normal" id="section-6-5.2"> the access token associated with the context expires.<a class="pilcrow" href="#section-6-5.2">Â¶</a>
</li>
        <li class="normal" id="section-6-5.3"> the client has successfully replaced the current security context with a newer one by posting an access token to the unprotected /authz-info endpoint at the RS, e.g., by reposting the same token, as specified in <a class="xref" href="#c-rs">Section 4.1</a>.<a class="pilcrow" href="#section-6-5.3">Â¶</a>
</li>
      </ul>
<p id="section-6-6">
        Whenever one more access token is successfully posted to the RS, and a new security context is derived between the client and RS, messages in transit that were protected with the previous security context might not pass verification, as the old context is discarded. That means that messages sent shortly before the client posts one more access tokens to the RS might not successfully reach the destination. Analogously, implementations may want to cancel CoAP observations at the RS registered before the security context is replaced, or conversely, they will need to implement a mechanism to ensure that those observations are to be protected with the newly derived security context.<a class="pilcrow" href="#section-6-6">Â¶</a></p>
</section>
</div>
<div id="sec-cons">
<section id="section-7">
      <h2 id="name-security-considerations">
<a class="section-number selfRef" href="#section-7">7. </a><a class="section-name selfRef" href="#name-security-considerations">Security Considerations</a>
      </h2>
<p id="section-7-1">
        This document specifies a profile for the ACE framework
        <span>[<a class="xref" href="#RFC9200">RFC9200</a>]</span>.  Thus, the general security
        considerations from the framework also apply to this profile.<a class="pilcrow" href="#section-7-1">Â¶</a></p>
<p id="section-7-2">
        Furthermore, the general security considerations of OSCORE <span>[<a class="xref" href="#RFC8613">RFC8613</a>]</span> also apply to this specific
        use of the OSCORE protocol.<a class="pilcrow" href="#section-7-2">Â¶</a></p>
<p id="section-7-3">
        As previously stated, the proof of possession in this profile is performed by both parties verifying that they have established the same security context, as specified in <a class="xref" href="#oscore-setup">Section 4.3</a>, which means that both the OSCORE request and the OSCORE response passes verification.
        RS authentication requires both that the client trusts the AS and that the OSCORE response from the RS passes verification.<a class="pilcrow" href="#section-7-3">Â¶</a></p>
<p id="section-7-4">
        OSCORE is designed to secure point-to-point communication,
        providing a secure binding between the request and the response(s).
        Thus, the basic OSCORE protocol is not intended for use in
        point-to-multipoint communication (e.g., multicast, publish-subscribe).
        Implementers of this profile should make sure that their use case
        corresponds to the expected use of OSCORE, to prevent weakening the
        security assurances provided by OSCORE.<a class="pilcrow" href="#section-7-4">Â¶</a></p>
<p id="section-7-5">
        Since the use of nonces N1 and N2 during the exchange guarantees uniqueness of AEAD keys and nonces, it is <span class="bcp14">REQUIRED</span> that the exchanged nonces are not reused with the same input keying material even in case of reboots. The exchange of 64-bit random nonces is <span class="bcp14">RECOMMENDED</span> in this document.  Considering the birthday paradox, the average collision for each nonce will happen after 2<sup>32</sup> messages, which is considerably more token provisionings than would be expected for intended applications. If applications use something else, such as a counter, they need to guarantee that reboot and loss of state on either node does not provoke reuse.
        If that is not guaranteed, nodes are susceptible to reuse of AEAD (nonce, key) pairs, especially since an on-path attacker can cause the use of a previously exchanged client nonce N1 for security context establishment by replaying the corresponding client-to-server message.<a class="pilcrow" href="#section-7-5">Â¶</a></p>
<p id="section-7-6">
        In this profile, it is <span class="bcp14">RECOMMENDED</span> that the RS maintains a single access token for each client. The use of multiple access tokens for a single client increases the strain on the resource server as it must consider every access token and calculate the actual permissions of the client. Also, tokens indicating different or disjoint permissions from each other may lead the server to enforce wrong permissions. If one of the access tokens expires earlier than others, the resulting permissions may offer insufficient protection. Developers <span class="bcp14">SHOULD</span> avoid using multiple access tokens for the same client.<a class="pilcrow" href="#section-7-6">Â¶</a></p>
<p id="section-7-7">
        If a single OSCORE Input Material is used with multiple RSs, the RSs can impersonate the client to one of the other RSs and impersonate another RS to the client. If a Master Secret is used with several clients, the clients can impersonate RS to one of the other clients. Similarly, if symmetric keys are used to integrity protect the token between AS and RS and the token can be used with multiple RSs, the RSs can impersonate AS to one of the other RSs. If the token key is used for any other communication between the RSs and AS, the RSs can impersonate each other to the AS.<a class="pilcrow" href="#section-7-7">Â¶</a></p>
</section>
</div>
<section id="section-8">
      <h2 id="name-privacy-considerations">
<a class="section-number selfRef" href="#section-8">8. </a><a class="section-name selfRef" href="#name-privacy-considerations">Privacy Considerations</a>
      </h2>
<p id="section-8-1">
        This document specifies a profile for the ACE framework
        <span>[<a class="xref" href="#RFC9200">RFC9200</a>]</span>.  Thus, the general privacy
        considerations from the framework also apply to this profile.<a class="pilcrow" href="#section-8-1">Â¶</a></p>
<p id="section-8-2">
        As this document uses OSCORE, the privacy considerations from
 <span>[<a class="xref" href="#RFC8613">RFC8613</a>]</span> apply here as well.<a class="pilcrow" href="#section-8-2">Â¶</a></p>
<p id="section-8-3">
       An unprotected response to an unauthorized request may disclose information about the resource server and/or its existing relationship with the client. It is advisable to include as little information as possible in an unencrypted response. When an OSCORE security context already exists between the client and the resource server, more detailed information may be included.<a class="pilcrow" href="#section-8-3">Â¶</a></p>
<p id="section-8-4">
        The token is sent in the clear to the authz-info endpoint, so if a client uses the same single token from multiple locations with multiple resource servers, it can risk being tracked by the token's value even when the access token is encrypted.<a class="pilcrow" href="#section-8-4">Â¶</a></p>
<p id="section-8-5">
        The nonces exchanged in the request and response to the authz-info endpoint are also sent in the clear, so using random nonces is best for privacy (as opposed to, e.g., a counter, which might leak some information about the client).<a class="pilcrow" href="#section-8-5">Â¶</a></p>
<p id="section-8-6">
        The identifiers used in OSCORE, negotiated between the client and RS, are privacy sensitive (see <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8613#section-12.8">Section 12.8</a> of [<a class="xref" href="#RFC8613">RFC8613</a>]</span>) and could reveal information about the client, or they may be used for correlating requests from one client.<a class="pilcrow" href="#section-8-6">Â¶</a></p>
<p id="section-8-7">
       Note that some information might still leak after OSCORE is established, due to observable message sizes, the source, and the destination addresses.<a class="pilcrow" href="#section-8-7">Â¶</a></p>
</section>
<section id="section-9">
      <h2 id="name-iana-considerations">
<a class="section-number selfRef" href="#section-9">9. </a><a class="section-name selfRef" href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<section id="section-9.1">
        <h3 id="name-ace-profile-registry">
<a class="section-number selfRef" href="#section-9.1">9.1. </a><a class="section-name selfRef" href="#name-ace-profile-registry">ACE Profile Registry</a>
        </h3>
<p id="section-9.1-1">The following registration has been made in the "ACE Profiles"
        registry following the procedure specified in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9200#section-8.8">Section 8.8</a> of [<a class="xref" href="#RFC9200">RFC9200</a>]</span>:<a class="pilcrow" href="#section-9.1-1">Â¶</a></p>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-9.1-2">
          <dt id="section-9.1-2.1">Name:</dt>
          <dd id="section-9.1-2.2" style="margin-left: 1.5em"> coap_oscore<a class="pilcrow" href="#section-9.1-2.2">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.1-2.3">Description:</dt>
          <dd id="section-9.1-2.4" style="margin-left: 1.5em">Profile for using OSCORE to secure communication
        between constrained nodes using the Authentication and Authorization
        for Constrained Environments framework.<a class="pilcrow" href="#section-9.1-2.4">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.1-2.5">CBOR Value:</dt>
          <dd id="section-9.1-2.6" style="margin-left: 1.5em">2<a class="pilcrow" href="#section-9.1-2.6">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.1-2.7">Reference:</dt>
          <dd id="section-9.1-2.8" style="margin-left: 1.5em">RFC 9203<a class="pilcrow" href="#section-9.1-2.8">Â¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
<div id="iana-nonces-ids">
<section id="section-9.2">
        <h3 id="name-oauth-parameters-registry">
<a class="section-number selfRef" href="#section-9.2">9.2. </a><a class="section-name selfRef" href="#name-oauth-parameters-registry">OAuth Parameters Registry</a>
        </h3>
<p id="section-9.2-1">The following registrations have been made in the "OAuth Parameters"
        registry <span>[<a class="xref" href="#IANA.OAuthParameters">IANA.OAuthParameters</a>]</span> following the procedure specified in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc6749#section-11.2">Section 11.2</a> of [<a class="xref" href="#RFC6749">RFC6749</a>]</span>:<a class="pilcrow" href="#section-9.2-1">Â¶</a></p>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-9.2-2">
          <dt id="section-9.2-2.1">Parameter name:</dt>
          <dd id="section-9.2-2.2" style="margin-left: 1.5em">nonce1<a class="pilcrow" href="#section-9.2-2.2">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.2-2.3">Parameter usage location:</dt>
          <dd id="section-9.2-2.4" style="margin-left: 1.5em">client-rs request<a class="pilcrow" href="#section-9.2-2.4">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.2-2.5">Change Controller:</dt>
          <dd id="section-9.2-2.6" style="margin-left: 1.5em">IETF<a class="pilcrow" href="#section-9.2-2.6">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.2-2.7">Specification Document(s):</dt>
          <dd id="section-9.2-2.8" style="margin-left: 1.5em">RFC 9203<a class="pilcrow" href="#section-9.2-2.8">Â¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-9.2-3">
          <dt id="section-9.2-3.1">Parameter name:</dt>
          <dd id="section-9.2-3.2" style="margin-left: 1.5em">nonce2<a class="pilcrow" href="#section-9.2-3.2">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.2-3.3">Parameter usage location:</dt>
          <dd id="section-9.2-3.4" style="margin-left: 1.5em">rs-client response<a class="pilcrow" href="#section-9.2-3.4">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.2-3.5">Change Controller:</dt>
          <dd id="section-9.2-3.6" style="margin-left: 1.5em">IETF<a class="pilcrow" href="#section-9.2-3.6">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.2-3.7">Specification Document(s):</dt>
          <dd id="section-9.2-3.8" style="margin-left: 1.5em">RFC 9203<a class="pilcrow" href="#section-9.2-3.8">Â¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-9.2-4">
          <dt id="section-9.2-4.1">Parameter name:</dt>
          <dd id="section-9.2-4.2" style="margin-left: 1.5em">ace_client_recipientid<a class="pilcrow" href="#section-9.2-4.2">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.2-4.3">Parameter usage location:</dt>
          <dd id="section-9.2-4.4" style="margin-left: 1.5em">client-rs request<a class="pilcrow" href="#section-9.2-4.4">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.2-4.5">Change Controller:</dt>
          <dd id="section-9.2-4.6" style="margin-left: 1.5em">IETF<a class="pilcrow" href="#section-9.2-4.6">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.2-4.7">Specification Document(s):</dt>
          <dd id="section-9.2-4.8" style="margin-left: 1.5em">RFC 9203<a class="pilcrow" href="#section-9.2-4.8">Â¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-9.2-5">
          <dt id="section-9.2-5.1">Parameter name:</dt>
          <dd id="section-9.2-5.2" style="margin-left: 1.5em">ace_server_recipientid<a class="pilcrow" href="#section-9.2-5.2">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.2-5.3">Parameter usage location:</dt>
          <dd id="section-9.2-5.4" style="margin-left: 1.5em">rs-client response<a class="pilcrow" href="#section-9.2-5.4">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.2-5.5">Change Controller:</dt>
          <dd id="section-9.2-5.6" style="margin-left: 1.5em">IETF<a class="pilcrow" href="#section-9.2-5.6">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.2-5.7">Specification Document(s):</dt>
          <dd id="section-9.2-5.8" style="margin-left: 1.5em">RFC 9203<a class="pilcrow" href="#section-9.2-5.8">Â¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<section id="section-9.3">
        <h3 id="name-oauth-parameters-cbor-mappi">
<a class="section-number selfRef" href="#section-9.3">9.3. </a><a class="section-name selfRef" href="#name-oauth-parameters-cbor-mappi">OAuth Parameters CBOR Mappings Registry</a>
        </h3>
<p id="section-9.3-1">The following registrations have been made in the "OAuth Parameters CBOR Mappings"
        registry following the procedure specified in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9200#section-8.10">Section 8.10</a> of [<a class="xref" href="#RFC9200">RFC9200</a>]</span>:<a class="pilcrow" href="#section-9.3-1">Â¶</a></p>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-9.3-2">
          <dt id="section-9.3-2.1">Name:</dt>
          <dd id="section-9.3-2.2" style="margin-left: 6.0em">nonce1<a class="pilcrow" href="#section-9.3-2.2">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.3-2.3">CBOR Key:</dt>
          <dd id="section-9.3-2.4" style="margin-left: 6.0em">40<a class="pilcrow" href="#section-9.3-2.4">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.3-2.5">Value Type:</dt>
          <dd id="section-9.3-2.6" style="margin-left: 6.0em">bstr<a class="pilcrow" href="#section-9.3-2.6">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.3-2.7">Reference:</dt>
          <dd id="section-9.3-2.8" style="margin-left: 6.0em">RFC 9203<a class="pilcrow" href="#section-9.3-2.8">Â¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-9.3-3">
          <dt id="section-9.3-3.1">Name:</dt>
          <dd id="section-9.3-3.2" style="margin-left: 6.0em">nonce2<a class="pilcrow" href="#section-9.3-3.2">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.3-3.3">CBOR Key:</dt>
          <dd id="section-9.3-3.4" style="margin-left: 6.0em">42<a class="pilcrow" href="#section-9.3-3.4">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.3-3.5">Value Type:</dt>
          <dd id="section-9.3-3.6" style="margin-left: 6.0em">bstr<a class="pilcrow" href="#section-9.3-3.6">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.3-3.7">Reference:</dt>
          <dd id="section-9.3-3.8" style="margin-left: 6.0em">RFC 9203<a class="pilcrow" href="#section-9.3-3.8">Â¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-9.3-4">
          <dt id="section-9.3-4.1">Name:</dt>
          <dd id="section-9.3-4.2" style="margin-left: 6.0em">ace_client_recipientid<a class="pilcrow" href="#section-9.3-4.2">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.3-4.3">CBOR Key:</dt>
          <dd id="section-9.3-4.4" style="margin-left: 6.0em">43<a class="pilcrow" href="#section-9.3-4.4">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.3-4.5">Value Type:</dt>
          <dd id="section-9.3-4.6" style="margin-left: 6.0em">bstr<a class="pilcrow" href="#section-9.3-4.6">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.3-4.7">Reference:</dt>
          <dd id="section-9.3-4.8" style="margin-left: 6.0em">RFC 9203<a class="pilcrow" href="#section-9.3-4.8">Â¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-9.3-5">
          <dt id="section-9.3-5.1">Name:</dt>
          <dd id="section-9.3-5.2" style="margin-left: 6.0em">ace_server_recipientid<a class="pilcrow" href="#section-9.3-5.2">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.3-5.3">CBOR Key:</dt>
          <dd id="section-9.3-5.4" style="margin-left: 6.0em">44<a class="pilcrow" href="#section-9.3-5.4">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.3-5.5">Value Type:</dt>
          <dd id="section-9.3-5.6" style="margin-left: 6.0em">bstr<a class="pilcrow" href="#section-9.3-5.6">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.3-5.7">Reference:</dt>
          <dd id="section-9.3-5.8" style="margin-left: 6.0em">RFC 9203<a class="pilcrow" href="#section-9.3-5.8">Â¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
<div id="sec-ctx-params-reg">
<section id="section-9.4">
        <h3 id="name-oscore-security-context-par">
<a class="section-number selfRef" href="#section-9.4">9.4. </a><a class="section-name selfRef" href="#name-oscore-security-context-par">OSCORE Security Context Parameters Registry</a>
        </h3>
<p id="section-9.4-1">
          IANA has created a new registry entitled "OSCORE Security Context Parameters".
          The registration procedure depends on the range of CBOR label values, following <span>[<a class="xref" href="#RFC8126">RFC8126</a>]</span>.
          Guidelines for the experts are provided in <a class="xref" href="#review">Section 9.7</a>.<a class="pilcrow" href="#section-9.4-1">Â¶</a></p>
<p id="section-9.4-2">
          The columns of the registry are:<a class="pilcrow" href="#section-9.4-2">Â¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-9.4-3">
          <dt id="section-9.4-3.1">Name:</dt>
          <dd id="section-9.4-3.2" style="margin-left: 1.5em">
              The JSON name requested (e.g., "ms").
              Because a core goal of this document is for the resulting representations to be compact, it is <span class="bcp14">RECOMMENDED</span> that the name be short.
              This name is case sensitive.
              Names may not match other registered names in a case-insensitive manner unless the designated experts determine that there is a compelling reason to allow an exception.
              The name is not used in the CBOR encoding.<a class="pilcrow" href="#section-9.4-3.2">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.4-3.3">CBOR Label:</dt>
          <dd id="section-9.4-3.4" style="margin-left: 1.5em">
              The value to be used to identify this name.
              Map key labels <span class="bcp14">MUST</span> be unique.
              The label can be a positive integer, a negative integer, or a string.
              Integer values between -256 and 255 and strings of length 1 are designated as Standards Track document required.
              Integer values from -65536 to -257 and from 256 to 65535 and strings of length 2 are designated as Specification Required.
              Integer values greater than 65535 and strings of length greater than 2 are designated as Expert Review.
              Integer values less than -65536 are marked as Private Use.<a class="pilcrow" href="#section-9.4-3.4">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.4-3.5">CBOR Type:</dt>
          <dd id="section-9.4-3.6" style="margin-left: 1.5em">
              This field contains the CBOR type for the field.<a class="pilcrow" href="#section-9.4-3.6">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.4-3.7">Registry:</dt>
          <dd id="section-9.4-3.8" style="margin-left: 1.5em">
              This field denotes the registry that values may come from, if one exists.<a class="pilcrow" href="#section-9.4-3.8">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.4-3.9">Description:</dt>
          <dd id="section-9.4-3.10" style="margin-left: 1.5em">
              This field contains a brief description for the field.<a class="pilcrow" href="#section-9.4-3.10">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.4-3.11">Reference:</dt>
          <dd id="section-9.4-3.12" style="margin-left: 1.5em">
              This contains a pointer to the public specification for the field, if one exists.<a class="pilcrow" href="#section-9.4-3.12">Â¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-9.4-4">
          This registry has been initially populated by the values in <a class="xref" href="#key-labels">Table 1</a>.

          The Reference column for all of these entries is this document.<a class="pilcrow" href="#section-9.4-4">Â¶</a></p>
</section>
</div>
<div id="osc-cwt">
<section id="section-9.5">
        <h3 id="name-cwt-confirmation-methods-re">
<a class="section-number selfRef" href="#section-9.5">9.5. </a><a class="section-name selfRef" href="#name-cwt-confirmation-methods-re">CWT Confirmation Methods Registry</a>
        </h3>
<p id="section-9.5-1">The following registration has been made in the "CWT Confirmation Methods" registry <span>[<a class="xref" href="#IANA.CWTConfirmationMethods">IANA.CWTConfirmationMethods</a>]</span> following the procedure specified in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8747#section-7.2.1">Section 7.2.1</a> of [<a class="xref" href="#RFC8747">RFC8747</a>]</span>:<a class="pilcrow" href="#section-9.5-1">Â¶</a></p>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-9.5-2">
          <dt id="section-9.5-2.1">Confirmation Method Name:</dt>
          <dd id="section-9.5-2.2" style="margin-left: 1.5em">osc<a class="pilcrow" href="#section-9.5-2.2">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.5-2.3">Confirmation Method Description:</dt>
          <dd id="section-9.5-2.4" style="margin-left: 1.5em">OSCORE_Input_Material carrying the parameters for using OSCORE per-message security with implicit key confirmation<a class="pilcrow" href="#section-9.5-2.4">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.5-2.5">JWT Confirmation Method Name:</dt>
          <dd id="section-9.5-2.6" style="margin-left: 1.5em">osc<a class="pilcrow" href="#section-9.5-2.6">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.5-2.7">Confirmation Key:</dt>
          <dd id="section-9.5-2.8" style="margin-left: 1.5em">4<a class="pilcrow" href="#section-9.5-2.8">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.5-2.9">Confirmation Value Type(s):</dt>
          <dd id="section-9.5-2.10" style="margin-left: 1.5em">map<a class="pilcrow" href="#section-9.5-2.10">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.5-2.11">Change Controller:</dt>
          <dd id="section-9.5-2.12" style="margin-left: 1.5em">IETF<a class="pilcrow" href="#section-9.5-2.12">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.5-2.13">Specification Document(s):</dt>
          <dd id="section-9.5-2.14" style="margin-left: 1.5em">
            <a class="xref" href="#oscore-sec-ctx">Section 3.2.1</a> of RFC 9203<a class="pilcrow" href="#section-9.5-2.14">Â¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="osc-jwt">
<section id="section-9.6">
        <h3 id="name-jwt-confirmation-methods-re">
<a class="section-number selfRef" href="#section-9.6">9.6. </a><a class="section-name selfRef" href="#name-jwt-confirmation-methods-re">JWT Confirmation Methods Registry</a>
        </h3>
<p id="section-9.6-1">The following registration has been made in the "JWT Confirmation Methods" registry <span>[<a class="xref" href="#IANA.JWTConfirmationMethods">IANA.JWTConfirmationMethods</a>]</span> following the procedure specified in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc7800#section-6.2.1">Section 6.2.1</a> of [<a class="xref" href="#RFC7800">RFC7800</a>]</span>:<a class="pilcrow" href="#section-9.6-1">Â¶</a></p>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-9.6-2">
          <dt id="section-9.6-2.1">Confirmation Method Value:</dt>
          <dd id="section-9.6-2.2" style="margin-left: 1.5em">osc<a class="pilcrow" href="#section-9.6-2.2">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.6-2.3">Confirmation Method Description:</dt>
          <dd id="section-9.6-2.4" style="margin-left: 1.5em">OSCORE_Input_Material carrying the parameters for using OSCORE per-message security with implicit key confirmation<a class="pilcrow" href="#section-9.6-2.4">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.6-2.5">Change Controller:</dt>
          <dd id="section-9.6-2.6" style="margin-left: 1.5em">IETF<a class="pilcrow" href="#section-9.6-2.6">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.6-2.7">Specification Document(s):</dt>
          <dd id="section-9.6-2.8" style="margin-left: 1.5em">
            <a class="xref" href="#oscore-sec-ctx">Section 3.2.1</a> of RFC 9203<a class="pilcrow" href="#section-9.6-2.8">Â¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="review">
<section id="section-9.7">
        <h3 id="name-expert-review-instructions">
<a class="section-number selfRef" href="#section-9.7">9.7. </a><a class="section-name selfRef" href="#name-expert-review-instructions">Expert Review Instructions</a>
        </h3>
<p id="section-9.7-1">
          The IANA registry established in this document is defined to use the Expert Review registration policy.
          This section gives some general guidelines for what the experts should be looking for, but they are being designated as experts for a reason, so they should be given substantial latitude.<a class="pilcrow" href="#section-9.7-1">Â¶</a></p>
<p id="section-9.7-2">
          Expert reviewers should take into consideration the following points:<a class="pilcrow" href="#section-9.7-2">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.7-3.1">
              Point squatting should be discouraged. Reviewers are encouraged to get sufficient information for registration requests to ensure that the usage is not going to duplicate one that is already registered and that the point is likely to be used in deployments. The zones tagged as Private Use are intended for testing purposes and closed environments. Code points in other ranges should not be assigned for testing.<a class="pilcrow" href="#section-9.7-3.1">Â¶</a>
</li>
          <li class="normal" id="section-9.7-3.2">
              Specifications are required for the Standards Track range of point assignment.
              Specifications should exist for specification required ranges, but early assignment before a specification is available is considered to be permissible. Specifications are needed for the First Come First Served range if they are expected to be used outside of closed environments in an interoperable way. When specifications are not provided, the description provided needs to have sufficient information to identify what the point is being used for.<a class="pilcrow" href="#section-9.7-3.2">Â¶</a>
</li>
          <li class="normal" id="section-9.7-3.3">
              Experts should take into account the expected usage of fields when approving point assignment.
              The fact that there is a range for Standards Track documents does not mean that a Standards Track document cannot have points assigned outside of that range.
              The length of the encoded value should be weighed against how many code points of that length are left, the size of device it will be used on, and the number of code points left that encode to that size.<a class="pilcrow" href="#section-9.7-3.3">Â¶</a>
</li>
        </ul>
</section>
</div>
</section>
<section id="section-10">
      <h2 id="name-references">
<a class="section-number selfRef" href="#section-10">10. </a><a class="section-name selfRef" href="#name-references">References</a>
      </h2>
<section id="section-10.1">
        <h3 id="name-normative-references">
<a class="section-number selfRef" href="#section-10.1">10.1. </a><a class="section-name selfRef" href="#name-normative-references">Normative References</a>
        </h3>
<dl class="references">
<dt id="COSE.Algorithms">[COSE.Algorithms]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"COSE Algorithms"</span>, <span>&lt;<a href="https://www.iana.org/assignments/cose">https://www.iana.org/assignments/cose</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA.CWTConfirmationMethods">[IANA.CWTConfirmationMethods]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"CWT Confirmation Methods"</span>, <span>&lt;<a href="https://www.iana.org/assignments/cwt">https://www.iana.org/assignments/cwt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA.JWTConfirmationMethods">[IANA.JWTConfirmationMethods]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"JWT Confirmation Methods"</span>, <span>&lt;<a href="https://www.iana.org/assignments/jwt">https://www.iana.org/assignments/jwt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA.OAuthParameters">[IANA.OAuthParameters]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"OAuth Parameters"</span>, <span>&lt;<a href="https://www.iana.org/assignments/oauth-parameters">https://www.iana.org/assignments/oauth-parameters</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time class="refDate" datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4648">[RFC4648]</dt>
        <dd>
<span class="refAuthor">Josefsson, S.</span>, <span class="refTitle">"The Base16, Base32, and Base64 Data Encodings"</span>, <span class="seriesInfo">RFC 4648</span>, <span class="seriesInfo">DOI 10.17487/RFC4648</span>, <time class="refDate" datetime="2006-10">October 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4648">https://www.rfc-editor.org/info/rfc4648</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5869">[RFC5869]</dt>
        <dd>
<span class="refAuthor">Krawczyk, H.</span> and <span class="refAuthor">P. Eronen</span>, <span class="refTitle">"HMAC-based Extract-and-Expand Key Derivation Function (HKDF)"</span>, <span class="seriesInfo">RFC 5869</span>, <span class="seriesInfo">DOI 10.17487/RFC5869</span>, <time class="refDate" datetime="2010-05">May 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5869">https://www.rfc-editor.org/info/rfc5869</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7252">[RFC7252]</dt>
        <dd>
<span class="refAuthor">Shelby, Z.</span>, <span class="refAuthor">Hartke, K.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"The Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 7252</span>, <span class="seriesInfo">DOI 10.17487/RFC7252</span>, <time class="refDate" datetime="2014-06">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7252">https://www.rfc-editor.org/info/rfc7252</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time class="refDate" datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8392">[RFC8392]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Wahlstroem, E.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"CBOR Web Token (CWT)"</span>, <span class="seriesInfo">RFC 8392</span>, <span class="seriesInfo">DOI 10.17487/RFC8392</span>, <time class="refDate" datetime="2018-05">May 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8392">https://www.rfc-editor.org/info/rfc8392</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8610">[RFC8610]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Vigano, C.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"Concise Data Definition Language (CDDL): A Notational Convention to Express Concise Binary Object Representation (CBOR) and JSON Data Structures"</span>, <span class="seriesInfo">RFC 8610</span>, <span class="seriesInfo">DOI 10.17487/RFC8610</span>, <time class="refDate" datetime="2019-06">June 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8610">https://www.rfc-editor.org/info/rfc8610</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8613">[RFC8613]</dt>
        <dd>
<span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Mattsson, J.</span>, <span class="refAuthor">Palombini, F.</span>, and <span class="refAuthor">L. Seitz</span>, <span class="refTitle">"Object Security for Constrained RESTful Environments (OSCORE)"</span>, <span class="seriesInfo">RFC 8613</span>, <span class="seriesInfo">DOI 10.17487/RFC8613</span>, <time class="refDate" datetime="2019-07">July 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8613">https://www.rfc-editor.org/info/rfc8613</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8949">[RFC8949]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span> and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR)"</span>, <span class="seriesInfo">STD 94</span>, <span class="seriesInfo">RFC 8949</span>, <span class="seriesInfo">DOI 10.17487/RFC8949</span>, <time class="refDate" datetime="2020-12">December 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8949">https://www.rfc-editor.org/info/rfc8949</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9052">[RFC9052]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE): Structures and Process"</span>, <span class="seriesInfo">STD 96</span>, <span class="seriesInfo">RFC 9052</span>, <span class="seriesInfo">DOI 10.17487/RFC9052</span>, <time class="refDate" datetime="2022-08">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9052">https://www.rfc-editor.org/info/rfc9052</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9053">[RFC9053]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE): Initial Algorithms"</span>, <span class="seriesInfo">RFC 9053</span>, <span class="seriesInfo">DOI 10.17487/RFC9053</span>, <time class="refDate" datetime="2022-08">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9053">https://www.rfc-editor.org/info/rfc9053</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9200">[RFC9200]</dt>
        <dd>
<span class="refAuthor">Seitz, L.</span>, <span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Wahlstroem, E.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"Authentication and Authorization for Constrained Environments Using the OAuth 2.0 Framework (ACE-OAuth)"</span>, <span class="seriesInfo">RFC 9200</span>, <span class="seriesInfo">DOI 10.17487/RFC9200</span>, <time class="refDate" datetime="2022-08">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9200">https://www.rfc-editor.org/info/rfc9200</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9201">[RFC9201]</dt>
      <dd>
<span class="refAuthor">Seitz, L.</span>, <span class="refTitle">"Additional OAuth Parameters for Authentication and Authorization for Constrained Environments (ACE)"</span>, <span class="seriesInfo">RFC 9201</span>, <span class="seriesInfo">DOI 10.17487/RFC9201</span>, <time class="refDate" datetime="2022-08">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9201">https://www.rfc-editor.org/info/rfc9201</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-10.2">
        <h3 id="name-informative-references">
<a class="section-number selfRef" href="#section-10.2">10.2. </a><a class="section-name selfRef" href="#name-informative-references">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC4949">[RFC4949]</dt>
        <dd>
<span class="refAuthor">Shirey, R.</span>, <span class="refTitle">"Internet Security Glossary, Version 2"</span>, <span class="seriesInfo">FYI 36</span>, <span class="seriesInfo">RFC 4949</span>, <span class="seriesInfo">DOI 10.17487/RFC4949</span>, <time class="refDate" datetime="2007-08">August 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4949">https://www.rfc-editor.org/info/rfc4949</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6749">[RFC6749]</dt>
        <dd>
<span class="refAuthor">Hardt, D., Ed.</span>, <span class="refTitle">"The OAuth 2.0 Authorization Framework"</span>, <span class="seriesInfo">RFC 6749</span>, <span class="seriesInfo">DOI 10.17487/RFC6749</span>, <time class="refDate" datetime="2012-10">October 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6749">https://www.rfc-editor.org/info/rfc6749</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7800">[RFC7800]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"Proof-of-Possession Key Semantics for JSON Web Tokens (JWTs)"</span>, <span class="seriesInfo">RFC 7800</span>, <span class="seriesInfo">DOI 10.17487/RFC7800</span>, <time class="refDate" datetime="2016-04">April 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7800">https://www.rfc-editor.org/info/rfc7800</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time class="refDate" datetime="2017-06">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time class="refDate" datetime="2018-08">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8747">[RFC8747]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Seitz, L.</span>, <span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"Proof-of-Possession Key Semantics for CBOR Web Tokens (CWTs)"</span>, <span class="seriesInfo">RFC 8747</span>, <span class="seriesInfo">DOI 10.17487/RFC8747</span>, <time class="refDate" datetime="2020-03">March 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8747">https://www.rfc-editor.org/info/rfc8747</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9110">[RFC9110]</dt>
        <dd>
<span class="refAuthor">Fielding, R., Ed.</span>, <span class="refAuthor">Nottingham, M., Ed.</span>, and <span class="refAuthor">J. Reschke, Ed.</span>, <span class="refTitle">"HTTP Semantics"</span>, <span class="seriesInfo">STD 97</span>, <span class="seriesInfo">RFC 9110</span>, <span class="seriesInfo">DOI 10.17487/RFC9110</span>, <time class="refDate" datetime="2022-06">June 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9110">https://www.rfc-editor.org/info/rfc9110</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9147">[RFC9147]</dt>
      <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refAuthor">Tschofenig, H.</span>, and <span class="refAuthor">N. Modadugu</span>, <span class="refTitle">"The Datagram Transport Layer Security (DTLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 9147</span>, <span class="seriesInfo">DOI 10.17487/RFC9147</span>, <time class="refDate" datetime="2022-04">April 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9147">https://www.rfc-editor.org/info/rfc9147</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<section id="appendix-A">
      <h2 id="name-profile-requirements">
<a class="section-number selfRef" href="#appendix-A">Appendix A. </a><a class="section-name selfRef" href="#name-profile-requirements">Profile Requirements</a>
      </h2>
<p id="appendix-A-1">
        This section lists the specifications of this profile based on the requirements of the framework, as requested in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9200#appendix-C">Appendix C</a> of [<a class="xref" href="#RFC9200">RFC9200</a>]</span>.<a class="pilcrow" href="#appendix-A-1">Â¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A-2.1">
            Optionally, define new methods for the client to discover the
            necessary permissions and AS for accessing a resource, different
            from the one proposed in <span>[<a class="xref" href="#RFC9200">RFC9200</a>]</span>: Not specified<a class="pilcrow" href="#appendix-A-2.1">Â¶</a>
</li>
        <li class="normal" id="appendix-A-2.2">
            Optionally, specify new grant types: Not specified<a class="pilcrow" href="#appendix-A-2.2">Â¶</a>
</li>
        <li class="normal" id="appendix-A-2.3">
            Optionally, define the use of client certificates as client
            credential type: Not specified<a class="pilcrow" href="#appendix-A-2.3">Â¶</a>
</li>
        <li class="normal" id="appendix-A-2.4">
            Specify the communication protocol the client and RS must use: CoAP<a class="pilcrow" href="#appendix-A-2.4">Â¶</a>
</li>
        <li class="normal" id="appendix-A-2.5">
            Specify the security protocol the client and RS must use to
            protect their communication: OSCORE<a class="pilcrow" href="#appendix-A-2.5">Â¶</a>
</li>
        <li class="normal" id="appendix-A-2.6">
            Specify how the client and the RS mutually authenticate: Implicitly by possession of a common OSCORE security context. Note that the mutual authentication is not completed before the client has verified an OSCORE response using this security context.<a class="pilcrow" href="#appendix-A-2.6">Â¶</a>
</li>
        <li class="normal" id="appendix-A-2.7">
            Specify the proof-of-possession protocol(s) and how to select one,
            if several are available.  Also specify which key types (e.g.,
            symmetric/asymmetric) are supported by a specific proof-of-
            possession protocol: OSCORE algorithms; preestablished symmetric keys<a class="pilcrow" href="#appendix-A-2.7">Â¶</a>
</li>
        <li class="normal" id="appendix-A-2.8">
            Specify a unique ace_profile identifier: coap_oscore<a class="pilcrow" href="#appendix-A-2.8">Â¶</a>
</li>
        <li class="normal" id="appendix-A-2.9">
            If introspection is supported, specify the communication and
            security protocol for introspection: HTTP/CoAP (+ TLS/DTLS/OSCORE)<a class="pilcrow" href="#appendix-A-2.9">Â¶</a>
</li>
        <li class="normal" id="appendix-A-2.10">
            Specify the communication and security protocol for interactions
            between client and AS: HTTP/CoAP (+ TLS/DTLS/OSCORE)<a class="pilcrow" href="#appendix-A-2.10">Â¶</a>
</li>
        <li class="normal" id="appendix-A-2.11">
            Specify if/how the authz-info endpoint is protected, including how
            error responses are protected: Not protected<a class="pilcrow" href="#appendix-A-2.11">Â¶</a>
</li>
        <li class="normal" id="appendix-A-2.12">
            Optionally, define methods of token transport other than the authz-info
            endpoint: Not defined<a class="pilcrow" href="#appendix-A-2.12">Â¶</a>
</li>
      </ul>
</section>
<section id="appendix-B">
      <h2 id="name-acknowledgments">
<a class="section-name selfRef" href="#name-acknowledgments">Acknowledgments</a>
      </h2>
<p id="appendix-B-1">
        The authors wish to thank <span class="contact-name">Jim Schaad</span> and <span class="contact-name">Marco Tiloca</span> for the substantial input to this document, as well as <span class="contact-name">Carsten Bormann</span>, <span class="contact-name">Elwyn Davies</span>, <span class="contact-name">Linda Dunbar</span>, <span class="contact-name">Roman Danyliw</span>, <span class="contact-name">Martin Duke</span>, <span class="contact-name">Lars Eggert</span>, <span class="contact-name">Murray Kucherawy</span>, and <span class="contact-name">Zaheduzzaman Sarker</span> for their reviews and feedback. Special thanks to the responsible area director <span class="contact-name">Benjamin Kaduk</span> for his extensive review and contributed text.
        <span class="contact-name">Ludwig Seitz</span> worked on this document as part of the CelticNext projects CyberWI and CRITISEC with funding from Vinnova.
        The work on this document has been partly supported also by the H2020 project SIFIS-Home (Grant agreement 952652).<a class="pilcrow" href="#appendix-B-1">Â¶</a></p>
</section>
<div id="authors-addresses">
<section id="appendix-C">
      <h2 id="name-authors-addresses">
<a class="section-name selfRef" href="#name-authors-addresses">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Francesca Palombini</span></div>
<div class="left" dir="auto"><span class="org">Ericsson AB</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:francesca.palombini@ericsson.com">francesca.palombini@ericsson.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Ludwig Seitz</span></div>
<div class="left" dir="auto"><span class="org">Combitech</span></div>
<div class="left" dir="auto"><span class="street-address">DjÃ¤knegatan 31</span></div>
<div class="left" dir="auto">SE-<span class="postal-code">211 35</span> <span class="locality">MalmÃ¶</span>
</div>
<div class="left" dir="auto"><span class="country-name">Sweden</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:ludwig.seitz@combitech.com">ludwig.seitz@combitech.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">GÃ¶ran Selander</span></div>
<div class="left" dir="auto"><span class="org">Ericsson AB</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:goran.selander@ericsson.com">goran.selander@ericsson.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Martin Gunnarsson</span></div>
<div class="left" dir="auto"><span class="org">RISE</span></div>
<div class="left" dir="auto"><span class="street-address">ScheelevÃ¤gen 17</span></div>
<div class="left" dir="auto">SE-<span class="postal-code">22370</span> <span class="locality">Lund</span>
</div>
<div class="left" dir="auto"><span class="country-name">Sweden</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:martin.gunnarsson@ri.se">martin.gunnarsson@ri.se</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>


</body></html>