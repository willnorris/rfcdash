<html><head></head><body><pre>Network Working Group                                         R. Housley
Request for Comments: 5485                                Vigil Security
Category: Informational                                       March 2009


             <span class="h1">Digital Signatures on Internet-Draft Documents</span>

Status of This Memo

   This memo provides information for the Internet community.  It does
   not specify an Internet standard of any kind.  Distribution of this
   memo is unlimited.

Copyright Notice

   Copyright (c) 2009 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://www.rfc-editor.org/bcp/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents in effect on the date of
   publication of this document (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>).
   Please review these documents carefully, as they describe your rights
   and restrictions with respect to this document.

Abstract

   This document specifies the conventions for digital signatures on
   Internet-Drafts.  The Cryptographic Message Syntax (CMS) is used to
   create a detached signature, which is stored in a separate companion
   file so that no existing utilities are impacted by the addition of
   the digital signature.




















<span class="grey">Housley                      Informational                      [Page 1]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-2"></span>
<span class="grey"><a href="./rfc5485">RFC 5485</a>         Digital Signatures on Internet-Drafts        March 2009</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" id="section-1">1</a>.  Introduction</span>

   This document specifies the conventions for storing a digital
   signature on Internet-Drafts.  The Cryptographic Message Syntax (CMS)
   [<a href="#ref-CMS" title='"Cryptographic Message Syntax (CMS)"'>CMS</a>] is used to create a detached signature.  The signature is
   stored in a separate companion file so that no existing utilities are
   impacted by the addition of the digital signature.

   Shortly after the IETF Secretariat posts the Internet-Draft in the
   repository, the digital signature is generated and posted as a
   companion file in the same repository.  The digital signature allows
   anyone to confirm that the contents of the Internet-Draft have not
   been altered since the time that the document was posted in the
   repository.

   The signature of the IETF Secretariat is intended to provide a
   straightforward way for anyone to determine whether a particular file
   contains the document that was made available by the IETF
   Secretariat.  The signing-time included by the IETF Secretariat
   provides the wall-clock time; it is not intended to provide a trusted
   timestamp.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/1.1.%20%20Terminology"></a><a class="selflink" href="#section-1.1" id="section-1.1">1.1</a>.  Terminology</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in <a href="./rfc2119">RFC 2119</a> [<a href="#ref-STDWORDS" title='"Key words for use in RFCs to Indicate Requirement Levels"'>STDWORDS</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/1.2.%20%20ASN.1"></a><a class="selflink" href="#section-1.2" id="section-1.2">1.2</a>.  ASN.1</span>

   The CMS uses Abstract Syntax Notation One (ASN.1) [<a href="#ref-X.680" title=" Information technology - Abstract Syntax Notation One (ASN.1): Specification of basic notation">X.680</a>].  ASN.1 is
   a formal notation used for describing data protocols, regardless of
   the programming language used by the implementation.  Encoding rules
   describe how the values defined in ASN.1 will be represented for
   transmission.  The Basic Encoding Rules (BER) [<a href="#ref-X.690" title=" Information technology - ASN.1 encoding rules: Specification of Basic Encoding Rules (BER)">X.690</a>] are the most
   widely employed rule set, but they offer more than one way to
   represent data structures.  For example, both definite-length
   encoding and indefinite-length encoding are supported.  This
   flexibility is not desirable when digital signatures are used.  As a
   result, the Distinguished Encoding Rules (DER) [<a href="#ref-X.690" title=" Information technology - ASN.1 encoding rules: Specification of Basic Encoding Rules (BER)">X.690</a>] were invented.
   DER is a subset of BER that ensures a single way to represent a given
   value.  For example, DER always employs definite-length encoding.









<span class="grey">Housley                      Informational                      [Page 2]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-3"></span>
<span class="grey"><a href="./rfc5485">RFC 5485</a>         Digital Signatures on Internet-Drafts        March 2009</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/2.%20%20Internet-Draft%20Signature%20File"></a><a class="selflink" href="#section-2" id="section-2">2</a>.  Internet-Draft Signature File</span>

   All Internet-Draft file names begin with "draft-".  The next portion
   of the file name depends on the source of the document.  For example,
   documents from IETF working groups usually have "ietf-" followed by
   the working group abbreviation, and this is followed by a string that
   helps people figure out the subject of the document.

   All Internet-Draft file names end with a hyphen followed by a two-
   digit version number and a suffix.  The suffix indicates the type of
   file.  A plain text file with a suffix of ".txt" is required.  Other
   formats may also be provided, and they employ the appropriate suffix
   for the file format.

   The companion signature file has exactly the same file name as the
   Internet-Draft, except that ".p7s" is added to the end.  This file
   name suffix conforms to the conventions in [<a href="#ref-MSG" title='"Secure/Multipurpose Internet Mail Extensions (S/MIME) Version 3.1 Message Specification"'>MSG</a>].  Here are a few
   example names:

      Internet-Draft: <a href="./draft-ietf-example-widgets-03.txt">draft-ietf-example-widgets-03.txt</a>
      Signature File: <a href="./draft-ietf-example-widgets-03.txt">draft-ietf-example-widgets-03.txt</a>.p7s

      Internet-Draft: <a href="./draft-ietf-example-widgets-03">draft-ietf-example-widgets-03</a>.ps
      Signature File: <a href="./draft-ietf-example-widgets-03">draft-ietf-example-widgets-03</a>.ps.p7s

      Internet-Draft: <a href="./draft-housley-internet-draft-sig-file-00.txt">draft-housley-internet-draft-sig-file-00.txt</a>
      Signature File: <a href="./draft-housley-internet-draft-sig-file-00.txt">draft-housley-internet-draft-sig-file-00.txt</a>.p7s

   The IETF Secretariat will post the signature file in the repository
   shortly after the Internet-Draft is posted.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/2.1.%20%20Need%20for%20Canonicalization"></a><a class="selflink" href="#section-2.1" id="section-2.1">2.1</a>.  Need for Canonicalization</span>

   In general, the content of the Internet-Draft is treated like a
   single octet string for the generation of the digital signature.
   Unfortunately, the plain text file requires canonicalization to avoid
   signature validation problems.  The primary concern is the manner in
   which different operating systems indicate the end of a line of text.
   Some systems use a single new-line character, other systems use the
   combination of the carriage-return character followed by a line-feed
   character, and other systems use fixed-length records padded with
   space characters.  For the digital signature to validate properly, a
   single convention must be employed.








<span class="grey">Housley                      Informational                      [Page 3]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-4"></span>
<span class="grey"><a href="./rfc5485">RFC 5485</a>         Digital Signatures on Internet-Drafts        March 2009</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/2.2.%20%20Text%20File%20Canonicalization"></a><a class="selflink" href="#section-2.2" id="section-2.2">2.2</a>.  Text File Canonicalization</span>

   The canonicalization procedure follows the conventions used for text
   files in the File Transfer Protocol (FTP) [<a href="#ref-FTP" title='"File Transfer Protocol"'>FTP</a>].  Such files must be
   supported by FTP implementations, so code reuse seems likely.

   The canonicalization procedure converts the data from its internal
   character representation to the standard 8-bit NVT-ASCII
   representation (see TELNET [<a href="#ref-TELNET" title='"Telnet Protocol Specification"'>TELNET</a>]).  In accordance with the NVT
   standard, the &lt;CRLF&gt; sequence MUST be used to denote the end of a
   line of text.  Using the standard NVT-ASCII representation means that
   data MUST be interpreted as 8-bit bytes.

   Trailing space characters MUST NOT appear on a line of text.  That
   is, the space character must not be followed by the &lt;CRLF&gt; sequence.
   Thus, a blank line is represented solely by the &lt;CRLF&gt; sequence.

   The form-feed nonprintable character (0x0C) is expected in Internet-
   Drafts.  Other nonprintable characters, such as tab and backspace,
   are not expected, but they do occur.  For robustness, any
   nonprintable or non-ASCII characters (ones outside the range 0x20 to
   0x7E) MUST NOT be changed in any way not covered by the rules for
   end-of-line handling in the previous paragraph.

   Trailing blank lines MUST NOT appear at the end of the file.  That
   is, the file must not end with multiple consecutive &lt;CRLF&gt; sequences.

   Any end-of-file marker used by an operating system is not considered
   to be part of the file content.  When present, such end-of-file
   markers MUST NOT be processed by the digital signature algorithm.

   Note: This text file canonicalization procedure is consistent with
   the ASCII NVT definition offered in <a href="./rfc5198#appendix-B">Appendix B of RFC 5198</a> [<a href="#ref-UFNI" title='"Unicode Format for Network Interchange"'>UFNI</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/2.3.%20%20XML%20File%20Canonicalization"></a><a class="selflink" href="#section-2.3" id="section-2.3">2.3</a>.  XML File Canonicalization</span>

   In accordance with the guidance of the World Wide Web Consortium
   (W3C) in Section 2.11 of [<a href="#ref-R20060816" title='"Extensible Markup Language (XML) 1.0 (Fourth Edition)"'>R20060816</a>], a &lt;LF&gt; character MUST be used
   to denote the end of a line of text within an XML file.  Any two-
   character &lt;CRLF&gt; sequence and any &lt;CR&gt; that is not followed by &lt;LF&gt;
   are to be translated to a single &lt;LF&gt; character.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/2.4.%20%20Canonicalization%20of%20Other%20File%20Formats"></a><a class="selflink" href="#section-2.4" id="section-2.4">2.4</a>.  Canonicalization of Other File Formats</span>

   No canonicalization is needed for file formats currently used for
   Internet-Drafts other than plain text files and XML files.  Other
   file formats are treated as a simple sequence of octets by the
   digital signature algorithm.



<span class="grey">Housley                      Informational                      [Page 4]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-5"></span>
<span class="grey"><a href="./rfc5485">RFC 5485</a>         Digital Signatures on Internet-Drafts        March 2009</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.%20%20CMS%20Profile"></a><a class="selflink" href="#section-3" id="section-3">3</a>.  CMS Profile</span>

   CMS is used to construct the detached signature of the Internet-
   Draft.  The CMS ContentInfo content type MUST always be present, and
   it MUST encapsulate the CMS SignedData content type.  Since a
   detached signature is being created, the CMS SignedData content type
   MUST NOT encapsulate the Internet-Draft.  The CMS detached signature
   is summarized by:

    ContentInfo {
      contentType          id-signedData, -- (1.2.840.113549.1.7.2)
      content              SignedData
    }

    SignedData {
      version              CMSVersion, -- Always set to 3
      digestAlgorithms     DigestAlgorithmIdentifiers,
      encapContentInfo     EncapsulatedContentInfo,
      certificates         CertificateSet, -- Secretariat certificate(s)
      crls                 CertificateRevocationLists, -- Optional
      signerInfos          SET OF SignerInfo -- Only one signer
    }

    SignerInfo {
      version              CMSVersion, -- Always set to 3
      sid                  SignerIdentifier,
      digestAlgorithm      DigestAlgorithmIdentifier,
      signedAttrs          SignedAttributes, -- Always present
      signatureAlgorithm   SignatureAlgorithmIdentifier,
      signature            SignatureValue,
      unsignedAttrs        UnsignedAttributes -- Optional
    }

    EncapsulatedContentInfo {
      eContentType         id-ct-asciiTextWithCRLF,
                                       -- (1.2.840.113549.1.9.16.1.27)
      eContent             OCTET STRING  -- Always absent
    }













<span class="grey">Housley                      Informational                      [Page 5]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-6"></span>
<span class="grey"><a href="./rfc5485">RFC 5485</a>         Digital Signatures on Internet-Drafts        March 2009</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.1.%20%20ContentInfo"></a><a class="selflink" href="#section-3.1" id="section-3.1">3.1</a>.  ContentInfo</span>

   The CMS requires the outer-most encapsulation to be ContentInfo
   [<a href="#ref-CMS" title='"Cryptographic Message Syntax (CMS)"'>CMS</a>].  The fields of ContentInfo are used as follows:

      contentType
         indicates the type of the associated content.  For the detached
         Internet-Draft signature file, the encapsulated type is always
         SignedData, so the id-signedData (1.2.840.113549.1.7.2) object
         identifier MUST be present in this field.

      content
         holds the content.  For the detached Internet-Draft signature
         file, the content is always a SignedData content.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.2.%20%20SignedData"></a><a class="selflink" href="#section-3.2" id="section-3.2">3.2</a>.  SignedData</span>

   The SignedData content type [<a href="#ref-CMS" title='"Cryptographic Message Syntax (CMS)"'>CMS</a>] contains the signature of the
   Internet-Draft and information to aid in the validation of that
   signature.  The fields of SignedData are used as follows:

      version
         is the syntax version number.  For this specification, the
         version number MUST be set to 3.

      digestAlgorithms
         is a collection of one-way hash function identifiers.  It MUST
         contain the identifier used by the IETF Secretariat to generate
         the digital signature.  See the discussion of digestAlgorithm
         in <a href="#section-3.2.1">Section 3.2.1</a>.

      encapContentInfo
         is the signed content, including a content type identifier.
         Since a detached signature is being created, it does not
         encapsulate the Internet-Draft.  The use of the
         EncapsulatedContentInfo type is discussed further in <a href="#section-3.2.2">Section</a>
         <a href="#section-3.2.2">3.2.2</a>.

      certificates
         is an optional collection of certificates.  It SHOULD include
         the X.509 certificate needed to validate the digital signature
         value.  Certification Authority (CA) certificates and end
         entity certificates MUST conform to the certificate profile
         specified in [<a href="#ref-PKIX1" title='"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"'>PKIX1</a>].







<span class="grey">Housley                      Informational                      [Page 6]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-7"></span>
<span class="grey"><a href="./rfc5485">RFC 5485</a>         Digital Signatures on Internet-Drafts        March 2009</span>


      crls
         is an optional collection of certificate revocation lists
         (CRLs).  It SHOULD NOT include any CRLs; however, any CRLs that
         are present MUST conform to the CRL profile specified in
         [<a href="#ref-PKIX1" title='"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"'>PKIX1</a>].

      signerInfos
         is a collection of per-signer information.  For this
         specification, each item in the collection must represent the
         IETF Secretariat.  More than one SignerInfo MAY appear to
         facilitate transitions between keys or algorithms.  The use of
         the SignerInfo type is discussed further in <a href="#section-3.2.1">Section 3.2.1</a>.

<span class="h4"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.2.1.%20%20SignerInfo"></a><a class="selflink" href="#section-3.2.1" id="section-3.2.1">3.2.1</a>.  SignerInfo</span>

   The IETF Secretariat is represented in the SignerInfo type.  The
   fields of SignerInfo are used as follows:

      version
         is the syntax version number.  In this specification, the
         version MUST be set to 3.

      sid
         identifies the IETF Secretariat's public key.  In this
         specification, the subjectKeyIdentifier alternative is always
         used, which identifies the public key directly.  This
         identifier MUST match the value included in the
         subjectKeyIdentifier certificate extension in the IETF
         Secretariat's X.509 certificate.

      digestAlgorithm
         identifies the one-way hash function, and any associated
         parameters, used by the IETF Secretariat to generate the
         digital signature.

      signedAttrs
         is an optional set of attributes that are signed along with the
         content.  The signedAttrs are optional in the CMS, but
         signedAttrs is required by this specification.  The SET OF
         Attribute must be encoded with the distinguished encoding rules
         (DER) [<a href="#ref-X.690" title=" Information technology - ASN.1 encoding rules: Specification of Basic Encoding Rules (BER)">X.690</a>].  <a href="#section-3.2.3">Section 3.2.3</a> of this document lists the signed
         attributes that MUST be included in the collection.  Other
         signed attributes MAY also be included.

      signatureAlgorithm
         identifies the digital signature algorithm, and any associated
         parameters, used by the IETF Secretariat to generate the
         digital signature.



<span class="grey">Housley                      Informational                      [Page 7]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-8"></span>
<span class="grey"><a href="./rfc5485">RFC 5485</a>         Digital Signatures on Internet-Drafts        March 2009</span>


      signature
         is the digital signature value generated by the IETF
         Secretariat.

      unsignedAttrs
         is an optional set of attributes that are not signed.  Unsigned
         attributes are usually omitted; however, the unsigned
         attributes MAY hold a trusted timestamp generated in accordance
         with [<a href="#ref-TSP" title='"Internet X.509 Public Key Infrastructure Time-Stamp Protocol (TSP)"'>TSP</a>].  <a href="#appendix-A">Appendix A</a> of [<a href="#ref-TSP" title='"Internet X.509 Public Key Infrastructure Time-Stamp Protocol (TSP)"'>TSP</a>] provides more information
         about this unsigned attribute.

<span class="h4"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.2.2.%20%20EncapsulatedContentInfo"></a><a class="selflink" href="#section-3.2.2" id="section-3.2.2">3.2.2</a>.  EncapsulatedContentInfo</span>

   The EncapsulatedContentInfo structure contains a content type
   identifier.  Since a detached signature is being created, it does not
   encapsulate the Internet-Draft.  The fields of
   EncapsulatedContentInfo are used as follows:

      eContentType
         is an object identifier that uniquely specifies the content
         type.  The content type associated with the plain text file
         MUST be id-ct-asciiTextWithCRLF.  Other file formats may also
         be posted, and the appropriate content type for each format is
         discussed in <a href="#section-4">Section 4</a>.  Additional file formats can be added
         if the Internet community chooses.

      eContent
         is optional.  When an encapsulated signature is generated, the
         content to be signed is carried in this field.  Since a
         detached signature is being created, eContent MUST be absent.

<span class="h4"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.2.3.%20%20Signed%20Attributes"></a><a class="selflink" href="#section-3.2.3" id="section-3.2.3">3.2.3</a>.  Signed Attributes</span>

   The IETF Secretariat MUST digitally sign a collection of attributes
   along with the Internet-Draft.  Each attribute in the collection MUST
   be DER-encoded.  The syntax for attributes is defined in [<a href="#ref-X.501">X.501</a>], and
   the X.500 Directory provides a rich attribute syntax.  A very simple
   subset of this syntax is used extensively in [<a href="#ref-CMS" title='"Cryptographic Message Syntax (CMS)"'>CMS</a>], where
   ATTRIBUTE.&amp;Type and ATTRIBUTE.&amp;id are the only parts of the ATTRIBUTE
   class that are employed.

   Each of the attributes used with this CMS profile has a single
   attribute value.  Even though the syntax is defined as a SET OF
   AttributeValue, there MUST be exactly one instance of AttributeValue
   present.






<span class="grey">Housley                      Informational                      [Page 8]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-9"></span>
<span class="grey"><a href="./rfc5485">RFC 5485</a>         Digital Signatures on Internet-Drafts        March 2009</span>


   The SignedAttributes syntax within signerInfo is defined as a SET OF
   Attribute.  The SignedAttributes MUST include only one instance of
   any particular attribute.

   The IETF Secretariat MUST include the content-type, message-digest,
   and signing-time attributes.  The IETF Secretariat MAY also include
   the binary-signing-time signed attribute as well as any other
   attribute that is deemed appropriate.  The intent is to allow
   additional signed attributes to be included if a future need is
   identified.  This does not cause an interoperability concern because
   unrecognized signed attributes are ignored at verification.

<span class="h5"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.2.3.1.%20%20Content-Type%20Attribute"></a><a class="selflink" href="#section-3.2.3.1" id="section-3.2.3.1">3.2.3.1</a>.  Content-Type Attribute</span>

   A content-type attribute is required to contain the same object
   identifier as the content type contained in the
   EncapsulatedContentInfo.  The appropriate content type for each
   format is discussed in <a href="#section-4">Section 4</a>.  The IETF Secretariat MUST include
   a content-type attribute containing the appropriate content type.
   Section 11.1 of [<a href="#ref-CMS" title='"Cryptographic Message Syntax (CMS)"'>CMS</a>] defines the content-type attribute.

<span class="h5"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.2.3.2.%20%20Message-Digest%20Attribute"></a><a class="selflink" href="#section-3.2.3.2" id="section-3.2.3.2">3.2.3.2</a>.  Message-Digest Attribute</span>

   The IETF Secretariat MUST include a message-digest attribute, having
   as its value the output of a one-way hash function computed on the
   Internet-Draft that is being signed.  Section 11.2 of [<a href="#ref-CMS" title='"Cryptographic Message Syntax (CMS)"'>CMS</a>] defines
   the message-digest attribute.

<span class="h5"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.2.3.3.%20%20Signing-Time%20Attribute"></a><a class="selflink" href="#section-3.2.3.3" id="section-3.2.3.3">3.2.3.3</a>.  Signing-Time Attribute</span>

   The IETF Secretariat MUST include a signing-time attribute,
   specifying the time, based on the local system clock, at which the
   digital signature was applied to the Internet-Draft.  Since the IETF
   Secretariat may choose to perform signatures in batches, the signing-
   time may be several hours or days after the time that the Internet-
   Draft was actually posted.  Section 11.3 of [<a href="#ref-CMS" title='"Cryptographic Message Syntax (CMS)"'>CMS</a>] defines the
   content-type attribute.

<span class="h5"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.2.3.4.%20%20Binary-Signing-Time%20Attribute"></a><a class="selflink" href="#section-3.2.3.4" id="section-3.2.3.4">3.2.3.4</a>.  Binary-Signing-Time Attribute</span>

   The IETF Secretariat MAY include a binary-signing-time attribute,
   specifying the time at which the digital signature was applied to the
   Internet-Draft.  If present, the time that is represented MUST match
   the time represented in the signing-time attribute.  The binary-
   signing-time attribute is defined in [<a href="#ref-BinTime" title='"BinaryTime: An Alternate Format for Representing Date and Time in ASN.1"'>BinTime</a>].






<span class="grey">Housley                      Informational                      [Page 9]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-10"></span>
<span class="grey"><a href="./rfc5485">RFC 5485</a>         Digital Signatures on Internet-Drafts        March 2009</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.2.4.%20%20Unsigned%20Attributes"></a><a class="selflink" href="#section-3.2.4" id="section-3.2.4">3.2.4</a>.  Unsigned Attributes</span>

   Unsigned attributes are usually omitted.  However, an unsigned
   attribute MAY hold a trusted timestamp generated in accordance with
   [<a href="#ref-TSP" title='"Internet X.509 Public Key Infrastructure Time-Stamp Protocol (TSP)"'>TSP</a>].  The idea is to timestamp the IETF Secretariat digital
   signature to prove that it was created before a given time.  If the
   IETF Secretariat's certificate is revoked the timestamp allows a
   verifier to know whether the signature was created before or after
   the revocation date.  <a href="#appendix-A">Appendix A</a> of [<a href="#ref-TSP" title='"Internet X.509 Public Key Infrastructure Time-Stamp Protocol (TSP)"'>TSP</a>] defines the signature time-
   stamp attribute that can be used to timestamp a digital signature.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/4.%20%20Content%20Types"></a><a class="selflink" href="#section-4" id="section-4">4</a>.  Content Types</span>

   This section lists the content types that are used in this
   specification.  The eContentType field as described in <a href="#section-3.2.2">Section 3.2.2</a>
   contains a content type identifier, and the same value appears in the
   content-type attribute as described in <a href="#section-3.2.3.1">Section 3.2.3.1</a>.

   The following table lists the file formats and the associated content
   type.

      File Format                        Content Type
      -----------                        ------------
      Plain text                         id-ct-asciiTextWithCRLF
      Extensible Markup Language (XML)   id-ct-xml
      Portable Document Format (PDF)     id-ct-pdf
      PostScript                         id-ct-postscript

   The object identifiers associated with the content types listed in
   the above table are:

      id-ct  OBJECT IDENTIFIER  ::= { iso(1) member-body(2)
           us(840) rsadsi(113549) pkcs(1) pkcs9(9) smime(16) 1 }

      id-ct-asciiTextWithCRLF  OBJECT IDENTIFIER  ::= { id-ct 27 }

      id-ct-xml  OBJECT IDENTIFIER  ::= { id-ct 28 }

      id-ct-pdf  OBJECT IDENTIFIER  ::= { id-ct 29 }

      id-ct-postscript  OBJECT IDENTIFIER  ::= { id-ct 30 }

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.%20%20Security%20Considerations"></a><a class="selflink" href="#section-5" id="section-5">5</a>.  Security Considerations</span>

   The IETF Secretariat MUST protect its private key.  The use of a
   hardware security module (HSM) is strongly RECOMMENDED because
   compromise of the IETF Secretariat's private key permits masquerade.




<span class="grey">Housley                      Informational                     [Page 10]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-11"></span>
<span class="grey"><a href="./rfc5485">RFC 5485</a>         Digital Signatures on Internet-Drafts        March 2009</span>


   The IETF Secretariat currently maintains servers at a primary
   location and a backup location.  This configuration requires two
   HSMs, one at each location.  However, the two HSMs do not need to use
   the same signing key.  Each HSM can have a different signing key, as
   long as each one has their own certificate.

   The generation of a public/private key pair for signature operations
   relies on random number generation.  The use of an inadequate pseudo-
   random number generator (PRNG) can result in little or no security.
   An attacker may find it much easier to reproduce the PRNG environment
   that produced the key pair, searching the resulting small set of
   possibilities, than to brute-force search the whole private key
   space.  The generation of quality random numbers is difficult, but
   [<a href="#ref-RANDOM" title='"Randomness Requirements for Security"'>RANDOM</a>] offers important guidance in this area.

   The IETF Secretariat should be aware that cryptographic algorithms
   become weaker with time.  As new cryptanalysis techniques are
   developed and computing performance improves, the work factor to
   break a particular digital signature algorithm or one-way hash
   function will be reduced.  Therefore, it SHOULD be possible to
   migrate these algorithms.  That is, the IETF Secretariat SHOULD be
   prepared for the supported algorithms to change over time.

   The IETF Secretariat must take care to use the correct time in
   signing-time and binary-signing-time attributes.  The inclusion of a
   date within the Internet-Draft by the authors that is shortly before
   the signing time attributes supplied by the IETF Secretariat provides
   confidence about the date that the Internet-Draft was posted to the
   repository.  However, the IETF Secretariat may choose to perform
   signatures in batches, and the signing-time may be several hours or
   days after the time that the Internet-Draft was actually posted.

   As stated above, the IETF Secretariat may choose to sign Internet-
   Drafts in batches.  This allows a single HSM to be used if multiple
   servers are located in one geographic location, and it allows the HSM
   to be off-line except when signatures are being generated.  Further,
   this allows the IETF Secretariat to include manual steps, such as
   entering an HSM passphrase or inserting a smartcard, as part of the
   signing procedure to improve operations security.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/6.%20%20Deployment%20and%20Operational%20Considerations"></a><a class="selflink" href="#section-6" id="section-6">6</a>.  Deployment and Operational Considerations</span>

   The private key used to generate the IETF Secretariat signature ought
   to be stored in an HSM to provide protection from unauthorized
   disclosure.  While the HSM will be operated by the IETF Secretariat,
   it ought to be owned by the IETF Trust.  Accordingly, the Trustees of
   the IETF Trust will designate an appropriate certification authority




<span class="grey">Housley                      Informational                     [Page 11]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-12"></span>
<span class="grey"><a href="./rfc5485">RFC 5485</a>         Digital Signatures on Internet-Drafts        March 2009</span>


   to issue a certificate to the IETF Secretariat, and they will approve
   any procedures used by the IETF Secretariat for signing documents
   consistent with this specification.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/7.%20%20Design%20Rationale"></a><a class="selflink" href="#section-7" id="section-7">7</a>.  Design Rationale</span>

   A detached signature is used for all file formats.  Some file
   formats, such as PDF and XML, have file-format-specific ways of
   handling digital signatures.  These file-format-specific approaches
   are not used for two reasons.  First, a single way to sign Internet-
   Drafts will ease implementation by the IETF Secretariat.  Second, if
   the author includes a signature using one of these file-format-
   specific approaches, the IETF Secretariat signature does not harm it
   in any way.

   File names are the means linking the detached signature to the signed
   document.  A CMS signed attribute could have been specified to
   include another form of linkage, and this could be added in the
   future.  At this point in time, it is important to support signature
   validation of expired Internet-Drafts that are obtained from non-IETF
   repositories.  Therefore, the appropriate value for such a signed
   attribute is unclear.  This specification allows an Internet-Draft
   and companion signature file to be stored anywhere without hindering
   signature validation.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/8.%20%20Acknowledgments"></a><a class="selflink" href="#section-8" id="section-8">8</a>.  Acknowledgments</span>

   The idea for the Internet-Draft signature file came from a discussion
   with Scott Bradner at IETF 69 in Chicago.  Many helpful suggestions
   came from Jim Schaad, Pasi Eronen, and Chris Newman.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/9.%20%20References"></a><a class="selflink" href="#section-9" id="section-9">9</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/9.1.%20%20Normative%20References"></a><a class="selflink" href="#section-9.1" id="section-9.1">9.1</a>.  Normative References</span>

   [<a id="ref-CMS">CMS</a>]       Housley, R., "Cryptographic Message Syntax (CMS)", <a href="./rfc3852">RFC</a>
               <a href="./rfc3852">3852</a>, July 2004.

   [<a id="ref-PKIX1">PKIX1</a>]     Cooper, D., Santesson, S., Farrell, S., Boeyen, S.,
               Housley, R., and W. Polk, "Internet X.509 Public Key
               Infrastructure Certificate and Certificate Revocation
               List (CRL) Profile", <a href="./rfc5280">RFC 5280</a>, May 2008.

   [<a id="ref-STDWORDS">STDWORDS</a>]  Bradner, S., "Key words for use in RFCs to Indicate
               Requirement Levels", <a href="https://www.rfc-editor.org/bcp/bcp14">BCP 14</a>, <a href="./rfc2119">RFC 2119</a>, March 1997.






<span class="grey">Housley                      Informational                     [Page 12]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-13"></span>
<span class="grey"><a href="./rfc5485">RFC 5485</a>         Digital Signatures on Internet-Drafts        March 2009</span>


   [<a id="ref-X.680">X.680</a>]     ITU-T Recommendation X.680: ISO/IEC 8824-1:2002,
               Information technology - Abstract Syntax Notation One
               (ASN.1): Specification of basic notation, 2002.

   [<a id="ref-X.690">X.690</a>]     ITU-T Recommendation X.690: ISO/IEC 8825-1:2002,
               Information technology - ASN.1 encoding rules:
               Specification of Basic Encoding Rules (BER), Canonical
               Encoding Rules (CER) and Distinguished Encoding Rules
               (DER), 2002.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/9.2.%20%20Informative%20References"></a><a class="selflink" href="#section-9.2" id="section-9.2">9.2</a>.  Informative References</span>

   [<a id="ref-BinTime">BinTime</a>]   Housley, R., "BinaryTime: An Alternate Format for
               Representing Date and Time in ASN.1", <a href="./rfc4049">RFC 4049</a>, April
               2005.

   [<a id="ref-FTP">FTP</a>]       Postel, J. and J. Reynolds, "File Transfer Protocol", STD
               9, <a href="./rfc959">RFC 959</a>, October 1985.

   [<a id="ref-MSG">MSG</a>]       Ramsdell, B., Ed., "Secure/Multipurpose Internet Mail
               Extensions (S/MIME) Version 3.1 Message Specification",
               <a href="./rfc3851">RFC 3851</a>, July 2004.

   [<a id="ref-OpenSSL">OpenSSL</a>]   "OpenSSL: The Open Source toolkit for SSL/TLS",
               <a href="http://www.openssl.org/">http://www.openssl.org/</a>.

   [<a id="ref-R20060816">R20060816</a>] Bray, T., J. Paoli, C. M. Sperberg-McQueen, E. Maler, and
               F. Yergeau, "Extensible Markup Language (XML) 1.0 (Fourth
               Edition)", W3C Recommendation, 16 August 2006,
               <a href="http://www.w3.org/TR/2006/REC-xml-20060816/">http://www.w3.org/TR/2006/REC-xml-20060816/</a>.

   [<a id="ref-RANDOM">RANDOM</a>]    Eastlake, D., 3rd, Schiller, J., and S. Crocker,
               "Randomness Requirements for Security", <a href="https://www.rfc-editor.org/bcp/bcp106">BCP 106</a>, <a href="./rfc4086">RFC</a>
               <a href="./rfc4086">4086</a>, June 2005.

   [<a id="ref-TELNET">TELNET</a>]    Postel, J. and J. Reynolds, "Telnet Protocol
               Specification", STD 8, <a href="./rfc854">RFC 854</a>, May 1983.

   [<a id="ref-TSP">TSP</a>]       Adams, C., Cain, P., Pinkas, D., and R. Zuccherato,
               "Internet X.509 Public Key Infrastructure Time-Stamp
               Protocol (TSP)", <a href="./rfc3161">RFC 3161</a>, August 2001.

   [<a id="ref-UFNI">UFNI</a>]      Klensin, J. and M. Padlipsky, "Unicode Format for Network
               Interchange", <a href="./rfc5198">RFC 5198</a>, March 2008.

   [<a id="ref-X.501">X.501</a>]     ITU-T Recommendation X.501: Information Technology - Open
               Systems Interconnection - The Directory: Models, 1993.




<span class="grey">Housley                      Informational                     [Page 13]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-14"></span>
<span class="grey"><a href="./rfc5485">RFC 5485</a>         Digital Signatures on Internet-Drafts        March 2009</span>


Appendix: A

   OpenSSL 0.9.9 [<a href="#ref-OpenSSL" title='"OpenSSL: The Open Source toolkit for SSL/TLS"'>OpenSSL</a>] includes an implementation of CMS.  The
   following command line can be used to verify an Internet-Draft
   signature:

     openssl cms -verify -CAfile &lt;cert-file&gt; -content &lt;internet-draft&gt; /
          -inform DER -in &lt;p7s-file&gt; -out /dev/null

   The arguments need to be provided as follows:

      &lt;cert-file&gt;
         the name of the file containing the trust anchor, which is
         typically the self-signed certificate of the certification
         authority that issued a certificate to the IETF Secretariat.

      &lt;internet-draft&gt;
         the name of the file containing the Internet-Draft after
         canonicalization.

      &lt;p7s-file&gt;
         the name of the file containing the detached signature that was
         generated in accordance with this specification.

Author's Address

   Russell Housley
   Vigil Security, LLC
   918 Spring Knoll Drive
   Herndon, VA 20170
   USA

   EMail: housley@vigilsec.com


















Housley                      Informational                     [Page 14]
</pre>
</body></html>