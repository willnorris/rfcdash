<html><head></head><body><pre>Internet Engineering Task Force (IETF)                      B. Carpenter
Request for Comments: 6883                             Univ. of Auckland
Category: Informational                                         S. Jiang
ISSN: 2070-1721                             Huawei Technologies Co., Ltd
                                                              March 2013


              <span class="h1">IPv6 Guidance for Internet Content Providers</span>
                   <span class="h1">and Application Service Providers</span>

Abstract

   This document provides guidance and suggestions for Internet Content
   Providers and Application Service Providers who wish to offer their
   service to both IPv6 and IPv4 customers.  Many of the points will
   also apply to hosting providers or to any enterprise network
   preparing for IPv6 users.

Status of This Memo

   This document is not an Internet Standards Track specification; it is
   published for informational purposes.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Not all documents
   approved by the IESG are a candidate for any level of Internet
   Standard; see <a href="./rfc5741#section-2">Section 2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc6883">http://www.rfc-editor.org/info/rfc6883</a>.

Copyright Notice

   Copyright (c) 2013 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://www.rfc-editor.org/bcp/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.



<span class="grey">Carpenter &amp; Jiang             Informational                     [Page 1]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-2"></span>
<span class="grey"><a href="./rfc6883">RFC 6883</a>                IPv6 ICP and ASP Guidance             March 2013</span>


Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-2">2</a>
   <a href="#section-2">2</a>. General Strategy ................................................<a href="#page-3">3</a>
   <a href="#section-3">3</a>. Education and Skills ............................................<a href="#page-5">5</a>
   <a href="#section-4">4</a>. Arranging IPv6 Connectivity .....................................<a href="#page-6">6</a>
   <a href="#section-5">5</a>. IPv6 Infrastructure .............................................<a href="#page-7">7</a>
      <a href="#section-5.1">5.1</a>. Address and Subnet Assignment ..............................<a href="#page-7">7</a>
      <a href="#section-5.2">5.2</a>. Routing ....................................................<a href="#page-8">8</a>
      <a href="#section-5.3">5.3</a>. DNS ........................................................<a href="#page-9">9</a>
   <a href="#section-6">6</a>. Load Balancers .................................................<a href="#page-10">10</a>
   <a href="#section-7">7</a>. Proxies ........................................................<a href="#page-11">11</a>
   <a href="#section-8">8</a>. Servers ........................................................<a href="#page-12">12</a>
      <a href="#section-8.1">8.1</a>. Network Stack .............................................<a href="#page-12">12</a>
      <a href="#section-8.2">8.2</a>. Application Layer .........................................<a href="#page-12">12</a>
      <a href="#section-8.3">8.3</a>. Logging ...................................................<a href="#page-13">13</a>
      <a href="#section-8.4">8.4</a>. Geolocation ...............................................<a href="#page-13">13</a>
   <a href="#section-9">9</a>. Coping with Transition Technologies ............................<a href="#page-13">13</a>
   <a href="#section-10">10</a>. Content Delivery Networks .....................................<a href="#page-15">15</a>
   <a href="#section-11">11</a>. Business Partners .............................................<a href="#page-16">16</a>
   <a href="#section-12">12</a>. Possible Complexities .........................................<a href="#page-16">16</a>
   <a href="#section-13">13</a>. Operations and Management .....................................<a href="#page-17">17</a>
   <a href="#section-14">14</a>. Security Considerations .......................................<a href="#page-18">18</a>
   <a href="#section-15">15</a>. Acknowledgements ..............................................<a href="#page-20">20</a>
   <a href="#section-16">16</a>. References ....................................................<a href="#page-20">20</a>
      <a href="#section-16.1">16.1</a>. Normative References .....................................<a href="#page-20">20</a>
      <a href="#section-16.2">16.2</a>. Informative References ...................................<a href="#page-22">22</a>

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" id="section-1">1</a>.  Introduction</span>

   The deployment of IPv6 [<a href="./rfc2460" title='"Internet Protocol, Version 6 (IPv6) Specification"'>RFC2460</a>] is now in progress, and users
   without direct IPv4 access are likely to appear in increasing numbers
   in the coming years.  Any provider of content or application services
   over the Internet will need to arrange for IPv6 access or else risk
   losing large numbers of potential users.  For users who already have
   dual-stack connectivity, direct IPv6 access might provide more
   satisfactory performance than indirect access via NAT.

   In this document, we often refer to the users of content or
   application services as "customers" to clarify the part they play,
   but this is not intended to limit the scope to commercial sites.

   The time for action is now, while the number of IPv6-only customers
   is small, so that appropriate skills, software, and equipment can be
   acquired in good time to scale up the IPv6 service as demand
   increases.  An additional advantage of early support for IPv6





<span class="grey">Carpenter &amp; Jiang             Informational                     [Page 2]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-3"></span>
<span class="grey"><a href="./rfc6883">RFC 6883</a>                IPv6 ICP and ASP Guidance             March 2013</span>


   customers is that it will reduce the number of customers connecting
   later via IPv4 "extension" solutions such as double NAT or NAT64
   [<a href="./rfc6146" title='"Stateful NAT64: Network Address and Protocol Translation from IPv6 Clients to IPv4 Servers"'>RFC6146</a>], which will otherwise degrade the user experience.

   Nevertheless, it is important that the introduction of IPv6 service
   should not make service for IPv4 customers worse.  In some
   circumstances, technologies intended to assist in the transition from
   IPv4 to IPv6 are known to have negative effects on the user
   experience.  A deployment strategy for IPv6 must avoid these effects
   as much as possible.

   The purpose of this document is to provide guidance and suggestions
   for Internet Content Providers (ICPs) and Application Service
   Providers (ASPs) who wish to offer their services to both IPv6 and
   IPv4 customers but who are currently supporting only IPv4.  For
   simplicity, the term "ICP" is mainly used in the body of this
   document, but the guidance also applies to ASPs.  Any hosting
   provider whose customers include ICPs or ASPs is also concerned.
   Many of the points in this document will also apply to enterprise
   networks that do not classify themselves as ICPs.  Any enterprise or
   department that runs at least one externally accessible server, such
   as an HTTP server, may also be concerned.  Although specific
   managerial and technical approaches are described, this is not a rule
   book; each operator will need to make its own plan, tailored to its
   own services and customers.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/2.%20%20General%20Strategy"></a><a class="selflink" href="#section-2" id="section-2">2</a>.  General Strategy</span>

   The most important advice here is to actually have a general
   strategy.  Adding support for a second network-layer protocol is a
   new experience for most modern organizations, and it cannot be done
   casually on an unplanned basis.  Even if it is impossible to write a
   precisely dated plan, the intended steps in the process need to be
   defined well in advance.  There is no single blueprint for this.  The
   rest of this document is meant to provide a set of topics to be taken
   into account in defining the strategy.  Other documents about IPv6
   deployment, such as [<a href="#ref-IPv6-NETWORK-DESIGN">IPv6-NETWORK-DESIGN</a>], should be consulted as
   well.

   In determining the urgency of this strategy, it should be noted that
   the central IPv4 registry (IANA) ran out of spare blocks of IPv4
   addresses in February 2011, and the various regional registries are
   expected to exhaust their reserves over the next one to two years.
   After this, Internet Service Providers (ISPs) will run out at dates
   determined by their own customer base.  No precise date can be given
   for when IPv6-only customers will appear in commercially significant





<span class="grey">Carpenter &amp; Jiang             Informational                     [Page 3]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-4"></span>
<span class="grey"><a href="./rfc6883">RFC 6883</a>                IPv6 ICP and ASP Guidance             March 2013</span>


   numbers, but -- particularly in the case of mobile users -- it may be
   quite soon.  Complacency about this is therefore not an option for
   any ICP that wishes to grow its customer base over the coming years.

   The most common strategy for an ICP is to provide dual-stack services
   -- both IPv4 and IPv6 on an equal basis -- to cover both existing and
   future customers.  This is the recommended strategy in [<a href="./rfc6180" title='"Guidelines for Using IPv6 Transition Mechanisms during IPv6 Deployment"'>RFC6180</a>] for
   straightforward situations.  Some ICPs who already have satisfactory
   operational experience with IPv6 might consider an IPv6-only
   strategy, with IPv4 clients being supported by translation or proxy
   in front of their IPv6 content servers.  However, the present
   document is addressed to ICPs without IPv6 experience, who are likely
   to prefer the dual-stack model to build on their existing IPv4
   service.

   Due to the widespread impact of supporting IPv6 everywhere within an
   environment, it is important to select a focused initial approach
   based on clear business needs and real technical dependencies.

   Within the dual-stack model, two approaches could be adopted,
   sometimes referred to as "outside in" and "inside out":

   o  Outside in: Start by providing external users with an IPv6 public
      access to your services, for example, by running a reverse proxy
      that handles IPv6 customers (see <a href="#section-7">Section 7</a> for details).
      Progressively enable IPv6 internally.

   o  Inside out: Start by enabling internal networking infrastructure,
      hosts, and applications to support IPv6.  Progressively reveal
      IPv6 access to external customers.

   Which of these approaches to choose depends on the precise
   circumstances of the ICP concerned.  "Outside in" has the benefit of
   giving interested customers IPv6 access at an early stage, and
   thereby gaining precious operational experience, before meticulously
   updating every piece of equipment and software.  For example, if some
   back-office system that is never exposed to users only supports IPv4,
   it will not cause delay.  "Inside out" has the benefit of completing
   the implementation of IPv6 as a single project.  Any ICP could choose
   this approach, but it might be most appropriate for a small ICP
   without complex back-end systems.

   A point that must be considered in the strategy is that some
   customers will remain IPv4-only for many years, others will have both
   IPv4 and IPv6 access, and yet others will have only IPv6.
   Additionally, mobile customers may find themselves switching between
   IPv4 and IPv6 access as they travel, even within a single session.




<span class="grey">Carpenter &amp; Jiang             Informational                     [Page 4]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-5"></span>
<span class="grey"><a href="./rfc6883">RFC 6883</a>                IPv6 ICP and ASP Guidance             March 2013</span>


   Services and applications must be able to deal with this, just as
   easily as they deal today with a user whose IPv4 address changes (see
   the discussion of cookies in <a href="#section-8.2">Section 8.2</a>).

   Nevertheless, the end goal is to have a network that does not need
   major changes when at some point in the future it becomes possible to
   transition to IPv6-only, even if only for some parts of the network.
   That is, the IPv6 deployment should be designed in such a way as to
   more or less assume that IPv4 is already absent, so the network will
   function seamlessly when it is indeed no longer there.

   An important step in the strategy is to determine from hardware and
   software suppliers details of their planned dates for providing
   sufficient IPv6 support, with performance equivalent to IPv4, in
   their products and services.  Relevant specifications such as
   [<a href="./rfc6434" title='"IPv6 Node Requirements"'>RFC6434</a>] and [<a href="#ref-IPv6-CE-REQS">IPv6-CE-REQS</a>] should be used.  Even if complete
   information cannot be obtained, it is essential to determine which
   components are on the critical path during successive phases of
   deployment.  This information will make it possible to draw up a
   logical sequence of events and identify any components that may cause
   holdups.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.%20%20Education%20and%20Skills"></a><a class="selflink" href="#section-3" id="section-3">3</a>.  Education and Skills</span>

   Some staff may have experience running multiprotocol networks, which
   were common twenty years ago before the dominance of IPv4.  However,
   IPv6 will be new to them and also to staff brought up only on TCP/IP.
   It is not enough to have one "IPv6 expert" in a team.  On the
   contrary, everybody who knows about IPv4 needs to know about IPv6,
   from network architect to help desk responder.  Therefore, an early
   and essential part of the strategy must be education, including
   practical training, so that all staff acquire a general understanding
   of IPv6, how it affects basic features such as the DNS, and the
   relevant practical skills.  To take a trivial example, any staff used
   to dotted-decimal IPv4 addresses need to become familiar with the
   colon-hexadecimal format used for IPv6.

   There is an anecdote of one IPv6 deployment in which prefixes
   including the letters A to F were avoided by design, to avoid
   confusing system administrators unfamiliar with hexadecimal notation.
   This is not a desirable result.  There is another anecdote of a help
   desk responder telling a customer to "disable one-Pv6" in order to
   solve a problem.  It should be a goal to avoid having untrained staff
   who don't understand hexadecimal or who can't even spell "IPv6".







<span class="grey">Carpenter &amp; Jiang             Informational                     [Page 5]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-6"></span>
<span class="grey"><a href="./rfc6883">RFC 6883</a>                IPv6 ICP and ASP Guidance             March 2013</span>


   It is very useful to have a small laboratory network available for
   training and self-training in IPv6, where staff may experiment and
   make mistakes without disturbing the operational IPv4 service.  This
   lab should run both IPv4 and IPv6, to gain experience with a dual-
   stack environment and new features such as having multiple addresses
   per interface, and addresses with lifetimes and deprecation.

   Once staff are trained, they will likely need to support IPv4, IPv6,
   and dual-stack customers.  Rather than having separate internal
   escalation paths for IPv6, it generally makes sense for questions
   that may have an IPv6 element to follow normal escalation paths;
   there should not be an "IPv6 Department" once training is completed.

   A final remark about training is that it should not be given too
   soon, or it will be forgotten.  Training has a definite need to be
   done "just in time" in order to properly "stick".  Training, lab
   experience, and actual deployment should therefore follow each other
   immediately.  If possible, training should even be combined with
   actual operational experience.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/4.%20%20Arranging%20IPv6%20Connectivity"></a><a class="selflink" href="#section-4" id="section-4">4</a>.  Arranging IPv6 Connectivity</span>

   There are, in theory, two ways to obtain IPv6 connectivity to the
   Internet.

   o  Native.  In this case, the ISP simply provides IPv6 on exactly the
      same basis as IPv4 -- it will appear at the ICP's border
      router(s), which must then be configured in dual-stack mode to
      forward IPv6 packets in both directions.  This is by far the
      better method.  An ICP should contact all its ISPs to verify when
      they will provide native IPv6 support, whether this has any
      financial implications, and whether the same service level
      agreement will apply as for IPv4.  Any ISP that has no definite
      plan to offer native IPv6 service should be avoided.

   o  Managed Tunnel.  It is possible to configure an IPv6-in-IPv4
      tunnel to a remote ISP that offers such a service.  A dual-stack
      router in the ICP's network will act as a tunnel endpoint, or this
      function could be included in the ICP's border router.

      A managed tunnel is a reasonable way to obtain IPv6 connectivity
      for initial testing and skills acquisition.  However, it
      introduces an inevitable extra latency compared to native IPv6,
      giving customers a noticeably worse response time for complex web
      pages.  A tunnel may become a performance bottleneck (especially
      if offered as a free service) or a target for malicious attack.





<span class="grey">Carpenter &amp; Jiang             Informational                     [Page 6]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-7"></span>
<span class="grey"><a href="./rfc6883">RFC 6883</a>                IPv6 ICP and ASP Guidance             March 2013</span>


      It is also likely to limit the IPv6 MTU size.  In normal
      circumstances, native IPv6 will provide an MTU size of at least
      1500 bytes, but it will almost inevitably be less for a tunnel,
      possibly as low as 1280 bytes (the minimum MTU allowed for IPv6).
      Apart from the resulting loss of efficiency, there are cases in
      which Path MTU Discovery fails and IPv6 fragmentation therefore
      fails; in this case, the lower tunnel MTU will actually cause
      connectivity failures for customers.

      For these reasons, ICPs are strongly recommended to obtain native
      IPv6 service before attempting to offer a production-quality
      service to their customers.  Unfortunately, it is impossible to
      prevent customers from using unmanaged tunnel solutions (see
      <a href="#section-9">Section 9</a>).

   Some larger organizations may find themselves needing multiple forms
   of IPv6 connectivity, for their ICP data centers and for their staff
   working elsewhere.  It is important to obtain IPv6 connectivity for
   both, as testing and supporting an IPv6-enabled service is
   challenging for staff without IPv6 connectivity.  This may involve
   short-term alternatives to provide IPv6 connectivity to operations
   and support staff, such as a managed tunnel or HTTP proxy server with
   IPv6 connectivity.  Note that unmanaged tunnels (such as 6to4 and
   Teredo) are generally not useful for support staff, as recent client
   software will avoid them when accessing dual-stack sites.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.%20%20IPv6%20Infrastructure"></a><a class="selflink" href="#section-5" id="section-5">5</a>.  IPv6 Infrastructure</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.1.%20%20Address%20and%20Subnet%20Assignment"></a><a class="selflink" href="#section-5.1" id="section-5.1">5.1</a>.  Address and Subnet Assignment</span>

   An ICP must first decide whether to apply for its own Provider
   Independent (PI) address prefix for IPv6.  This option is available
   either from an ISP that acts as a Local Internet Registry or directly
   from the relevant Regional Internet Registry.  The alternative is to
   obtain a Provider Aggregated (PA) prefix from an ISP.  Both solutions
   are viable in IPv6.  However, the scaling properties of the wide-area
   routing system (BGP-4) mean that the number of PI prefixes should be
   limited, so only large content providers can justify obtaining a PI
   prefix and convincing their ISPs to route it.  Millions of enterprise
   networks, including smaller content providers, will use PA prefixes.
   In this case, a change of ISP would necessitate a change of the
   corresponding PA prefix, using the procedure outlined in [<a href="./rfc4192" title='"Procedures for Renumbering an IPv6 Network without a Flag Day"'>RFC4192</a>].









<span class="grey">Carpenter &amp; Jiang             Informational                     [Page 7]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-8"></span>
<span class="grey"><a href="./rfc6883">RFC 6883</a>                IPv6 ICP and ASP Guidance             March 2013</span>


   An ICP that has connections via multiple ISPs but does not have a PI
   prefix would therefore have multiple PA prefixes, one from each ISP.
   This would result in multiple IPv6 addresses for the ICP's servers or
   load balancers.  If one address fails due to an ISP malfunction,
   sessions using that address would be lost.  At the time of this
   writing, there is very limited operational experience with this
   approach [<a href="#ref-MULTIHOMING-WITHOUT-NAT">MULTIHOMING-WITHOUT-NAT</a>].

   An ICP may also choose to operate a Unique Local Address prefix
   [<a href="./rfc4193" title='"Unique Local IPv6 Unicast Addresses"'>RFC4193</a>] for internal traffic only, as described in [<a href="./rfc4864" title='"Local Network Protection for IPv6"'>RFC4864</a>].

   Depending on its projected future size, an ICP might choose to obtain
   /48 PI or PA prefixes (allowing 16 bits of subnet address) or longer
   PA prefixes, e.g., /56 (allowing 8 bits of subnet address).  Clearly,
   the choice of /48 is more future-proof.  Advice on the numbering of
   subnets may be found in [<a href="./rfc5375" title='"IPv6 Unicast Address Assignment Considerations"'>RFC5375</a>].  An ICP with multiple locations
   will probably need a prefix per location.

   An ICP that has its service hosted by a colocation provider, cloud
   provider, or the like will need to follow the addressing policy of
   that provider.

   Since IPv6 provides for operating multiple prefixes simultaneously,
   it is important to check that all relevant tools, such as address
   management packages, can deal with this.  In particular, the possible
   need to allow for multiple PA prefixes with IPv6, and the possible
   need to renumber, mean that the common technique of manually assigned
   static addresses for servers, proxies, or load balancers, with
   statically defined DNS entries, could be problematic [<a href="./rfc6866" title='"Problem Statement for Renumbering IPv6 Hosts with Static Addresses in Enterprise Networks"'>RFC6866</a>].  An
   ICP of reasonable size might instead choose to operate DHCPv6
   [<a href="./rfc3315" title='"Dynamic Host Configuration Protocol for IPv6 (DHCPv6)"'>RFC3315</a>] with standard DNS, to support stateful assignment.  In
   either case, a configuration management system is likely to be used
   to support stateful and/or on-demand address assignment.

   Theoretically, it would also be possible to operate an ICP's IPv6
   network using only Stateless Address Autoconfiguration [<a href="./rfc4862" title='"IPv6 Stateless Address Autoconfiguration"'>RFC4862</a>],
   with Dynamic DNS [<a href="./rfc3007" title='"Secure Domain Name System (DNS) Dynamic Update"'>RFC3007</a>] to publish server addresses for external
   users.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.2.%20%20Routing"></a><a class="selflink" href="#section-5.2" id="section-5.2">5.2</a>.  Routing</span>

   In a dual-stack network, most IPv4 and IPv6 interior routing
   protocols operate quite independently and in parallel.  The common
   routing protocols, such as OSPFv3 [<a href="./rfc5340" title='"OSPF for IPv6"'>RFC5340</a>], IS-IS [<a href="./rfc5308" title='"Routing IPv6 with IS-IS"'>RFC5308</a>], and
   even the Routing Information Protocol Next Generation (RIPng)
   [<a href="./rfc2080" title='"RIPng for IPv6"'>RFC2080</a>] [<a href="./rfc2081" title='"RIPng Protocol Applicability Statement"'>RFC2081</a>], all support IPv6.  It is worth noting that
   whereas OSPF and RIP differ significantly between IPv4 and IPv6,
   IS-IS has the advantage of handling them both in a single instance of



<span class="grey">Carpenter &amp; Jiang             Informational                     [Page 8]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-9"></span>
<span class="grey"><a href="./rfc6883">RFC 6883</a>                IPv6 ICP and ASP Guidance             March 2013</span>


   the protocol, with the potential for operational simplification in
   the long term.  Some versions of OSPFv3 may also have this advantage
   [<a href="./rfc5838" title='"Support of Address Families in OSPFv3"'>RFC5838</a>].  In any case, for trained staff, there should be no
   particular difficulty in deploying IPv6 routing without disturbance
   to IPv4 services.  In some cases, firmware upgrades may be needed on
   some network devices.

   The performance impact of dual-stack routing needs to be evaluated.
   In particular, what forwarding performance does the router vendor
   claim for IPv6?  If the forwarding performance is significantly
   inferior compared to IPv4, will this be an operational problem?
   Is extra memory or ternary content-addressable memory (TCAM) space
   needed to accommodate both IPv4 and IPv6 tables?  To answer these
   questions, the ICP will need a projected model for the amount of IPv6
   traffic expected initially and its likely rate of increase.

   If a site has multiple PA prefixes as mentioned in <a href="#section-5.1">Section 5.1</a>,
   complexities in routing configuration will appear.  In particular,
   source-based routing rules might be needed to ensure that outgoing
   packets are routed to the appropriate border router and ISP link.
   Normally, a packet sourced from an address assigned by ISP X should
   not be sent via ISP Y, to avoid ingress filtering by Y [<a href="./rfc2827" title='"Network Ingress Filtering: Defeating Denial of Service Attacks which employ IP Source Address Spoofing"'>RFC2827</a>]
   [<a href="./rfc3704" title='"Ingress Filtering for Multihomed Networks"'>RFC3704</a>].  Additional considerations may be found in
   [<a href="#ref-MULTIHOMING-WITHOUT-NAT">MULTIHOMING-WITHOUT-NAT</a>].  Note that the prefix translation
   technique discussed in [<a href="./rfc6296" title='"IPv6-to-IPv6 Network Prefix Translation"'>RFC6296</a>] does not describe a solution for
   enterprises that offer publicly available content servers.

   Each IPv6 subnet that supports end hosts normally has a /64 prefix,
   leaving another 64 bits for the interface identifiers of individual
   hosts.  In contrast, a typical IPv4 subnet will have no more than
   8 bits for the host identifier, thus limiting the subnet to 256 or
   fewer hosts.  A dual-stack design will typically use the same
   physical or VLAN subnet topology for IPv4 and IPv6, and therefore the
   same router topology.  In other words, the IPv4 and IPv6 topologies
   are congruent.  This means that the limited subnet size of IPv4 (such
   as 256 hosts) will be imposed on IPv6, even though the IPv6 prefix
   will allow many more hosts.  It would be theoretically possible to
   avoid this limitation by implementing a different physical or VLAN
   subnet topology for IPv6.  This is not advisable, as it would result
   in extremely complex fault diagnosis when something went wrong.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.3.%20%20DNS"></a><a class="selflink" href="#section-5.3" id="section-5.3">5.3</a>.  DNS</span>

   It must be understood that as soon as a AAAA record for a well-known
   name is published in the DNS, the corresponding server will start to
   receive IPv6 traffic.  Therefore, it is essential that an ICP test
   thoroughly to ensure that IPv6 works on its servers, load balancers,
   etc., before adding their AAAA records to DNS.  There have been



<span class="grey">Carpenter &amp; Jiang             Informational                     [Page 9]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-10"></span>
<span class="grey"><a href="./rfc6883">RFC 6883</a>                IPv6 ICP and ASP Guidance             March 2013</span>


   numerous cases of ICPs breaking their sites for all IPv6 users during
   a roll-out by returning AAAA records for servers improperly
   configured for IPv6.

   Once such tests have succeeded, each externally visible host (or
   virtual host) that has an A record for its IPv4 address needs a AAAA
   record [<a href="./rfc3596" title='"DNS Extensions to Support IP Version 6"'>RFC3596</a>] for its IPv6 address, and a reverse entry (in
   ip6.arpa) if applicable.  Note that if CNAME records are in use, the
   AAAA record must be added alongside the A record at the end of the
   CNAME chain.  It is not possible to have the AAAA record on the same
   name as used for a CNAME record, as per [<a href="./rfc1912" title='"Common DNS Operational and Configuration Errors"'>RFC1912</a>].

   One important detail is that some clients (especially Windows XP) can
   only resolve DNS names via IPv4, even if they can use IPv6 for
   application traffic.  Also, a dual-stack resolver might attempt to
   resolve queries for A records via IPv6, or AAAA records via IPv4.  It
   is therefore advisable for all DNS servers to respond to queries via
   both IPv4 and IPv6.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/6.%20%20Load%20Balancers"></a><a class="selflink" href="#section-6" id="section-6">6</a>.  Load Balancers</span>

   Most available load balancers now support IPv6.  However, it is
   important to obtain appropriate assurances from vendors about their
   IPv6 support, including performance aspects (as discussed for routers
   in <a href="#section-5.2">Section 5.2</a>).  The update needs to be planned in anticipation of
   expected traffic growth.  It is to be expected that IPv6 traffic will
   initially be low, i.e., a small but growing percentage of total
   traffic.  For this reason, it might be acceptable to have IPv6
   traffic bypass load balancing initially, by publishing a AAAA record
   for a specific server instead of the load balancer.  However, load
   balancers often also provide for server fail-over, in which case it
   would be better to implement IPv6 load balancing immediately.

   The same would apply to Transport Layer Security (TLS) or HTTP
   proxies used for load-balancing purposes.
















<span class="grey">Carpenter &amp; Jiang             Informational                    [Page 10]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-11"></span>
<span class="grey"><a href="./rfc6883">RFC 6883</a>                IPv6 ICP and ASP Guidance             March 2013</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/7.%20%20Proxies"></a><a class="selflink" href="#section-7" id="section-7">7</a>.  Proxies</span>

   An HTTP proxy [<a href="./rfc2616" title='"Hypertext Transfer Protocol -- HTTP/1.1"'>RFC2616</a>] can readily be configured to handle incoming
   connections over IPv6 and to proxy them to a server over IPv4.
   Therefore, a single proxy can be used as the first step in an
   outside-in strategy, as shown in the following diagram:

        ___________________________________________
       (                                           )
       (        IPv6 Clients in the Internet       )
       (___________________________________________)
                            |
                      -------------
                      |  Ingress  |
                      |  router   |
                      -------------
                ____________|_____________
                            |
                      -------------
                      | IPv6 stack|
                      |-----------|
                      | HTTP proxy|
                      |-----------|
                      | IPv4 stack|
                      -------------
                ____________|_____________
                            |
                      -------------
                      | IPv4 stack|
                      |-----------|
                      |   HTTP    |
                      |  server   |
                      -------------

   In this case, the AAAA record for the service would provide the IPv6
   address of the proxy.  This approach will work for any HTTP or HTTPS
   applications that operate successfully via a proxy, as long as IPv6
   load remains low.  Additionally, many load-balancer products
   incorporate such a proxy, in which case this approach would be
   possible at high load.

   Note that in any proxy scenario, an ICP will need to make sure that
   both IPv4 and IPv6 addresses are being properly passed to application
   servers in any relevant HTTP headers and that those application
   servers are properly handling the IPv6 addresses.






<span class="grey">Carpenter &amp; Jiang             Informational                    [Page 11]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-12"></span>
<span class="grey"><a href="./rfc6883">RFC 6883</a>                IPv6 ICP and ASP Guidance             March 2013</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/8.%20%20Servers"></a><a class="selflink" href="#section-8" id="section-8">8</a>.  Servers</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/8.1.%20%20Network%20Stack"></a><a class="selflink" href="#section-8.1" id="section-8.1">8.1</a>.  Network Stack</span>

   The TCP/IP network stacks in popular operating systems have supported
   IPv6 for many years.  In most cases, it is sufficient to enable IPv6
   and possibly DHCPv6; the rest will follow.  Servers inside an ICP
   network will not need to support any transition technologies beyond a
   simple dual stack, with a possible exception for 6to4 mitigation
   noted below in <a href="#section-9">Section 9</a>.

   As some operating systems have separate firewall rule sets for IPv4
   and IPv6, an ICP should also evaluate those rule sets and ensure that
   appropriate firewall rules are configured for IPv6.  More details are
   discussed in <a href="#section-14">Section 14</a>.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/8.2.%20%20Application%20Layer"></a><a class="selflink" href="#section-8.2" id="section-8.2">8.2</a>.  Application Layer</span>

   Basic HTTP servers have been able to handle an IPv6-enabled network
   stack for some years, so at the most it will be necessary to update
   to a more recent software version.  The same is true of generic
   applications such as email protocols.  No general statement can be
   made about other applications, especially proprietary ones, so each
   ASP will need to make its own determination.  As changes to the
   network layer to introduce IPv6 addresses can ripple through
   applications, testing of both client and server applications should
   be performed in IPv4-only, IPv6-only, and dual-stack environments
   prior to dual-stacking a production environment.

   One important recommendation here is that all applications should use
   domain names, which are IP-version-independent, rather than IP
   addresses.  Applications based on middleware platforms that have
   uniform support for IPv4 and IPv6, for example, Java, may be able to
   support both IPv4 and IPv6 naturally without additional work.
   Security certificates should also contain domain names rather than
   addresses.

   A specific issue for HTTP-based services is that IP address-based
   cookie authentication schemes will need to deal with dual-stack
   clients.  Servers might create a cookie for an IPv4 connection or an
   IPv6 connection, depending on the setup at the client site and on the
   whims of the client operating system.  There is no guarantee that a
   given client will consistently use the same address family,
   especially when accessing a collection of sites rather than a single
   site, such as when cookies are used for federated authentication.  If
   the client is using privacy addresses [<a href="./rfc4941" title='"Privacy Extensions for Stateless Address Autoconfiguration in IPv6"'>RFC4941</a>], the IPv6 address





<span class="grey">Carpenter &amp; Jiang             Informational                    [Page 12]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-13"></span>
<span class="grey"><a href="./rfc6883">RFC 6883</a>                IPv6 ICP and ASP Guidance             March 2013</span>


   (but usually not its /64 prefix) might change quite frequently.  Any
   cookie mechanism based on 32-bit IPv4 addresses will need significant
   remodeling.

   Generic considerations on application transition are discussed in
   [<a href="./rfc4038" title='"Application Aspects of IPv6 Transition"'>RFC4038</a>], but many of them will not apply to the dual-stack ICP
   scenario.  An ICP that creates and maintains its own applications
   will need to review them for any dependency on IPv4.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/8.3.%20%20Logging"></a><a class="selflink" href="#section-8.3" id="section-8.3">8.3</a>.  Logging</span>

   The introduction of IPv6 clients will generally also result in IPv6
   addresses appearing in the "client ip" field of server logs.  It
   might be convenient to use the same log field to hold a client's IP
   address, whether it is IPv4 or IPv6.  Downstream systems looking at
   logs and client IP addresses may also need testing to ensure that
   they can properly handle IPv6 addresses.  This includes any of an
   ICP's databases recording client IP addresses, such as for recording
   IP addresses of online purchases and comment posters.

   It is worth noting that accurate traceback from logs to individual
   customers requires end-to-end address transparency.  This is
   additional motivation for an ICP to support native IPv6 connectivity,
   since otherwise, IPv6-only customers will inevitably connect via some
   form of translation mechanism, interfering with traceback.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/8.4.%20%20Geolocation"></a><a class="selflink" href="#section-8.4" id="section-8.4">8.4</a>.  Geolocation</span>

   Initially, ICPs may observe some weakness in geolocation for IPv6
   clients.  As time goes on, it is to be assumed that geolocation
   methods and databases will be updated to fully support IPv6 prefixes.
   There is no reason they will be more or less accurate in the long
   term than those available for IPv4.  However, we can expect many more
   clients to be mobile as time goes on, so geolocation based on IP
   addresses alone may in any case become problematic.  A more robust
   technique such as HTTP-Enabled Location Delivery (HELD) [<a href="./rfc5985" title='"HTTP-Enabled Location Delivery (HELD)"'>RFC5985</a>]
   could be considered.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/9.%20%20Coping%20with%20Transition%20Technologies"></a><a class="selflink" href="#section-9" id="section-9">9</a>.  Coping with Transition Technologies</span>

   As mentioned above, an ICP should obtain native IPv6 connectivity
   from its ISPs.  In this way, the ICP can avoid most of the
   complexities of the numerous IPv4-to-IPv6 transition technologies
   that have been developed; they are all second-best solutions.
   However, some clients are sure to be using such technologies.  An ICP
   needs to be aware of the operational issues this may cause and how to
   deal with them.




<span class="grey">Carpenter &amp; Jiang             Informational                    [Page 13]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-14"></span>
<span class="grey"><a href="./rfc6883">RFC 6883</a>                IPv6 ICP and ASP Guidance             March 2013</span>


   In some cases outside the ICP's control, clients might reach a
   content server via a network-layer translator from IPv6 to IPv4.
   ICPs who are offering a dual-stack service and providing both A and
   AAAA records, as recommended in this document, should not normally
   receive IPv4 traffic from NAT64 translators [<a href="./rfc6146" title='"Stateful NAT64: Network Address and Protocol Translation from IPv6 Clients to IPv4 Servers"'>RFC6146</a>].
   Exceptionally, however, such traffic could arrive via IPv4 from an
   IPv6-only client whose DNS resolver failed to receive the ICP's AAAA
   record for some reason.  Such traffic would be indistinguishable from
   regular IPv4-via-NAT traffic.

   Alternatively, ICPs who are offering a dual-stack service might
   exceptionally receive IPv6 traffic translated from an IPv4-only
   client that somehow failed to receive the ICP's A record.  An ICP
   could also receive IPv6 traffic with translated prefixes [<a href="./rfc6296" title='"IPv6-to-IPv6 Network Prefix Translation"'>RFC6296</a>].
   These two cases would only be an issue if the ICP was offering any
   service that depends on the assumption of end-to-end IPv6 address
   transparency.

   Finally, some traffic might reach an ICP that has been translated
   twice en route (e.g., from IPv6 to IPv4 and back again).  Again, the
   ICP will be unable to detect this.  It is likely that real-time
   geolocation will be highly inaccurate for such traffic, since it will
   at best indicate the location of the second translator, which could
   be very distant from the customer.

   In other cases, also outside the ICP's control, IPv6 clients may
   reach the IPv6 Internet via some form of IPv6-in-IPv4 tunnel.  In
   this case, a variety of problems can arise, the most acute of which
   affect clients connected using the Anycast 6to4 solution [<a href="./rfc3068" title='"An Anycast Prefix for 6to4 Relay Routers"'>RFC3068</a>].
   Advice on how ICPs may mitigate these 6to4 problems is given in
   <a href="./rfc6343#section-4.5">Section 4.5. of [RFC6343]</a>.  For the benefit of all tunneled clients,
   it is essential to verify that Path MTU Discovery works correctly
   (i.e., the relevant ICMPv6 packets are not blocked) and that the
   server-side TCP implementation correctly supports the Maximum Segment
   Size (MSS) negotiation mechanism [<a href="./rfc2923" title='"TCP Problems with Path MTU Discovery"'>RFC2923</a>] for IPv6 traffic.

   Some ICPs have implemented an interim solution to mitigate transition
   problems by limiting the visibility of their AAAA records to users
   with validated IPv6 connectivity [<a href="./rfc6589" title='"Considerations for Transitioning Content to IPv6"'>RFC6589</a>] (known as "DNS
   whitelisting").  At the time of this writing, this solution seems to
   be passing out of use, being replaced by "DNS blacklisting" of
   customer sites known to have problems with IPv6 connectivity.  In the
   reverse direction, it is worth being aware that some ISPs with
   significant populations of clients with broken IPv6 setups have begun
   filtering AAAA record lookups by their clients.  None of these
   solutions are appropriate in the long term.





<span class="grey">Carpenter &amp; Jiang             Informational                    [Page 14]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-15"></span>
<span class="grey"><a href="./rfc6883">RFC 6883</a>                IPv6 ICP and ASP Guidance             March 2013</span>


   Another approach taken by some ICPs is to offer IPv6-only support via
   a specific DNS name, e.g., ipv6.example.com, if the primary service
   is www.example.com.  In this case, ipv6.example.com would have a AAAA
   record only.  This has some value for testing purposes but is
   otherwise only of interest to hobbyist users willing to type in
   special URLs.

   There is little an ICP can do to deal with client-side or remote ISP
   deficiencies in IPv6 support, but it is hoped that the "Happy
   Eyeballs" [<a href="./rfc6555" title='"Happy Eyeballs: Success with Dual-Stack Hosts"'>RFC6555</a>] approach will improve the ability for clients to
   deal with such problems.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/10.%20%20Content%20Delivery%20Networks"></a><a class="selflink" href="#section-10" id="section-10">10</a>.  Content Delivery Networks</span>

   DNS-based techniques for diverting users to Content Delivery Network
   (CDN) points of presence (POPs) will work for IPv6, if AAAA records
   as well as A records are provided.  In general, the CDN should follow
   the recommendations of this document, especially by operating a full
   dual-stack service at each POP.  Additionally, each POP will need to
   handle IPv6 routing exactly like IPv4, for example, running BGP-4+
   [<a href="./rfc4760" title='"Multiprotocol Extensions for BGP-4"'>RFC4760</a>].

   Note that if an ICP supports IPv6 but its external CDN provider does
   not, its clients will continue to use IPv4 and any IPv6-only clients
   will have to use a transition solution of some kind.  This is not a
   desirable situation, since the ICP's work to support IPv6 will be
   wasted.

   An ICP might face a complex situation if its CDN provider supports
   IPv6 at some POPs but not at others.  IPv6-only clients could only be
   diverted to a POP supporting IPv6.  There are also scenarios where a
   dual-stack client would be diverted to a mixture of IPv4 and IPv6
   POPs for different URLs, according to the A and AAAA records provided
   and the availability of optimizations such as "Happy Eyeballs".  A
   related side effect is that copies of the same content viewed at the
   same time via IPv4 and IPv6 may be different, due to latency in the
   underlying data synchronization process used by the CDN.  This effect
   has in fact been observed in the wild for a major social network
   supporting dual stack.  These complications do not affect the
   viability of relying on a dual-stack CDN, however.

   The CDN itself faces related complexity: "As IPv6 rolls out, it's
   going to roll out in pockets, and that's going to make the routing
   around congestion points that much more important but also that much
   harder," stated John Summers of Akamai in 2010 [<a href="#ref-CDN-UPGRADE">CDN-UPGRADE</a>].






<span class="grey">Carpenter &amp; Jiang             Informational                    [Page 15]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-16"></span>
<span class="grey"><a href="./rfc6883">RFC 6883</a>                IPv6 ICP and ASP Guidance             March 2013</span>


   A converse situation that might arise is that an ICP has not yet
   started its deployment of IPv6 but finds that its CDN provider
   already supports IPv6.  Then, assuming that the CDN provider
   announces appropriate AAAA DNS Resource Records, dual-stack and
   IPv6-only customers will obtain IPv6 access, and the ICP's content
   may well be delivered to them via IPv6.  In normal circumstances,
   this should create no problems, but it is a situation that the ICP
   and its support staff need to be aware of.  In particular, support
   staff should be given IPv6 connectivity in order to be able to
   investigate any problems that might arise (see <a href="#section-4">Section 4</a>).

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/11.%20%20Business%20Partners"></a><a class="selflink" href="#section-11" id="section-11">11</a>.  Business Partners</span>

   As noted earlier, it is in an ICP's or ASP's best interests that
   their users have direct IPv6 connectivity, rather than indirect IPv4
   connectivity via double NAT.  If the ICP or ASP has a direct business
   relationship with some of their clients, or with the networks that
   connect them to their clients, they are advised to coordinate with
   those partners to ensure that they have a plan to enable IPv6.  They
   should also verify and test that there is first-class IPv6
   connectivity end-to-end between the networks concerned.  This is
   especially true for implementations that require IPv6 support in
   specialized programs or systems in order for the IPv6 support on the
   ICP/ASP side to be useful.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/12.%20%20Possible%20Complexities"></a><a class="selflink" href="#section-12" id="section-12">12</a>.  Possible Complexities</span>

   Some additional considerations come into play for some types of
   complex or distributed sites and applications that an ICP may be
   delivering.  For example, an ICP may have a site spread across many
   hostnames (not all under their control).  Other ICPs may have their
   sites or applications distributed across multiple locations for
   availability, scale, or performance.

   Many modern web sites and applications now use a collection of
   resources and applications, some operated by the ICP and others by
   third parties.  While most clients support sites containing a mixture
   of IPv4-only and dual-stack elements, an ICP should track the IPv6
   availability of embedded resources (such as images), as otherwise
   their site may only be partially functional or may have degraded
   performance for IPv6-only users.

   DNS-based load-balancing techniques for diverting users to servers in
   multiple POPs will work for IPv6, if the load balancer supports IPv6
   and if AAAA records are provided.  Depending on the architecture of
   the load balancer, an ICP may need to operate a full dual-stack
   service at each POP.  With other architectures, it may be acceptable
   to initially only have IPv6 at a subset of locations.  Some



<span class="grey">Carpenter &amp; Jiang             Informational                    [Page 16]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-17"></span>
<span class="grey"><a href="./rfc6883">RFC 6883</a>                IPv6 ICP and ASP Guidance             March 2013</span>


   architectures will make it preferable for IPv6 routing to mirror IPv4
   routing (for example, running BGP-4+ [<a href="./rfc4760" title='"Multiprotocol Extensions for BGP-4"'>RFC4760</a>] if appropriate), but
   this may not always be possible, as IPv6 and IPv4 connectivity can be
   independent.

   Some complexities may arise when a client supporting both IPv4 and
   IPv6 uses different POPs for each IP version (such as when IPv6 is
   only available in a subset of locations).  There are also scenarios
   where a dual-stack client would be diverted to a mixture of IPv4 and
   IPv6 POPs for different URLs, according to the A and AAAA records
   provided and the availability of optimizations such as "Happy
   Eyeballs" [<a href="./rfc6555" title='"Happy Eyeballs: Success with Dual-Stack Hosts"'>RFC6555</a>].  A related side effect is that copies of the
   same content viewed at the same time via IPv4 and IPv6 may be
   different, due to latency in the underlying data synchronization
   process used at the application layer.  This effect has in fact been
   observed in the wild for a major social network supporting dual
   stack.

   Even with a single POP, unexpected behavior may arise if a client
   switches spontaneously between IPv4 and IPv6 as a performance
   optimization [<a href="./rfc6555" title='"Happy Eyeballs: Success with Dual-Stack Hosts"'>RFC6555</a>] or if its IPv6 address changes frequently for
   privacy reasons [<a href="./rfc4941" title='"Privacy Extensions for Stateless Address Autoconfiguration in IPv6"'>RFC4941</a>].  Such changes may affect cookies,
   geolocation, load balancing, and transactional integrity.  Although
   unexpected changes of client address also occur in an IPv4-only
   environment, they may be more frequent with IPv6.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/13.%20%20Operations%20and%20Management"></a><a class="selflink" href="#section-13" id="section-13">13</a>.  Operations and Management</span>

   There is no doubt that, initially, IPv6 deployment will have
   operational impact, and will also require education and training as
   mentioned in <a href="#section-3">Section 3</a>.  Staff will have to update network elements
   such as routers, update configurations, provide information to end
   users, and diagnose new problems.  However, for an enterprise
   network, there is plenty of experience, e.g., on numerous university
   campuses, showing that dual-stack operation is no harder than
   IPv4-only in the steady state.

   Whatever management, monitoring, and logging are performed for IPv4
   are also needed for IPv6.  Therefore, all products and tools used for
   these purposes must be updated to fully support IPv6 management data.
   It is important to verify that tools have been fully updated to
   support 128-bit addresses entered and displayed in hexadecimal format
   [<a href="./rfc5952" title='"A Recommendation for IPv6 Address Text Representation"'>RFC5952</a>].  Since an IPv6 network may operate with more than one IPv6
   prefix and therefore more than one address per host, the tools must
   deal with this as a normal situation.  This includes any address
   management tool in use (see <a href="#section-5.1">Section 5.1</a>) as well as tools used for
   creating DHCP and DNS configurations.  There is significant overlap
   here with the tools involved in site renumbering [<a href="./rfc6879" title='"IPv6 Enterprise Network Renumbering Scenarios, Considerations, and Methods"'>RFC6879</a>].



<span class="grey">Carpenter &amp; Jiang             Informational                    [Page 17]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-18"></span>
<span class="grey"><a href="./rfc6883">RFC 6883</a>                IPv6 ICP and ASP Guidance             March 2013</span>


   At an early stage of IPv6 deployment, it is likely that IPv6 will be
   mainly managed via IPv4 transport.  This allows network management
   systems to test for dependencies between IPv4 and IPv6 management
   data.  For example, will reports mixing IPv4 and IPv6 addresses
   display correctly?

   In a second phase, IPv6 transport should be used to manage the
   network.  Note that it will also be necessary for an ICP to provide
   IPv6 connectivity for its operations and support staff, even when
   working remotely.  As far as possible, mutual dependency between IPv4
   and IPv6 should be avoided, for both the management data and the
   transport.  Failure of one should not cause a failure of the other.
   One precaution to avoid this would be for network management systems
   to be dual-stacked.  It would then be possible to use IPv4
   connectivity to repair IPv6 configurations, and vice versa.

   Dual stack, while necessary, does have management scaling and
   overhead considerations.  As noted earlier, the long-term goal is to
   move to single-stack IPv6, when the network and its customers can
   support it.  This is an additional reason why mutual dependency
   between the address families should be avoided in the management
   system in particular; a hidden dependency on IPv4 that had been
   forgotten for many years would be highly inconvenient.  In
   particular, a management tool that manages IPv6 but itself runs only
   over IPv4 would prove disastrous on the day that IPv4 is switched
   off.

   An ICP should ensure that any end-to-end availability monitoring
   systems are updated to monitor dual-stacked servers over both IPv4
   and IPv6.  A particular challenge here may be monitoring systems
   relying on DNS names, as this may result in monitoring only one of
   IPv4 or IPv6, resulting in a loss of visibility to failures in
   network connectivity over either address family.

   As mentioned above, it will also be necessary for an ICP to provide
   IPv6 connectivity for its operations and support staff, even when
   working remotely.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/14.%20%20Security%20Considerations"></a><a class="selflink" href="#section-14" id="section-14">14</a>.  Security Considerations</span>

   While many ICPs may still be in the process of experimenting with and
   configuring IPv6, there is mature malware in the wild that will
   launch attacks over IPv6.  For example, if a AAAA DNS record is added
   for a hostname, malware using client OS libraries may automatically
   switch from attacking that hostname over IPv4 to attacking that
   hostname over IPv6.  As a result, it is crucial that firewalls and
   other network security appliances protecting servers support IPv6 and
   have rules tested and configured.



<span class="grey">Carpenter &amp; Jiang             Informational                    [Page 18]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-19"></span>
<span class="grey"><a href="./rfc6883">RFC 6883</a>                IPv6 ICP and ASP Guidance             March 2013</span>


   Security experience with IPv4 should be used as a guide as to the
   threats that may exist in IPv6, but they should not be assumed to be
   equally likely nor should they be assumed to be the only threats that
   could exist in IPv6.  However, essentially every threat that exists
   for IPv4 exists or will exist for IPv6, to a greater or lesser
   extent.  It is essential to update firewalls, intrusion detection
   systems, denial-of-service precautions, and security auditing
   technology to fully support IPv6.  Needless to say, it is also
   essential to turn on well-known security mechanisms such as DNS
   Security and DHCPv6 Authentication.  Otherwise, IPv6 will become an
   attractive target for attackers.

   When multiple PA prefixes are in use as mentioned in <a href="#section-5.1">Section 5.1</a>,
   firewall rules must allow for all valid prefixes and must be set up
   to work as intended even if packets are sent via one ISP but return
   packets arrive via another.

   Performance and memory size aspects of dual-stack firewalls must be
   considered (as discussed for routers in <a href="#section-5.2">Section 5.2</a>).

   In a dual-stack operation, there may be a risk of cross-contamination
   between the two protocols.  For example, a successful IPv4-based
   denial-of-service attack might also deplete resources needed by the
   IPv6 service, or vice versa.  This risk strengthens the argument that
   IPv6 security must be up to the same level as IPv4.  Risks can also
   occur with dual-stack Virtual Private Network (VPN) solutions
   [<a href="#ref-VPN-LEAKAGES">VPN-LEAKAGES</a>].

   A general overview of techniques to protect an IPv6 network against
   external attacks is given in [<a href="./rfc4864" title='"Local Network Protection for IPv6"'>RFC4864</a>].  Assuming that an ICP has
   native IPv6 connectivity, it is advisable to block incoming
   IPv6-in-IPv4 tunnel traffic using IPv4 protocol type 41.  Outgoing
   traffic of this kind should be blocked, except for the case noted in
   <a href="./rfc6343#section-4.5">Section 4.5 of [RFC6343]</a>.  ICMPv6 traffic should only be blocked in
   accordance with [<a href="./rfc4890" title='"Recommendations for Filtering ICMPv6 Messages in Firewalls"'>RFC4890</a>]; in particular, Packet Too Big messages,
   which are essential for Path MTU Discovery, must not be blocked.

   Brute-force scanning attacks to discover the existence of hosts are
   much less likely to succeed for IPv6 than for IPv4 [<a href="./rfc5157" title='"IPv6 Implications for Network Scanning"'>RFC5157</a>].
   However, this should not lull an ICP into a false sense of security,
   as various naming or addressing conventions can result in IPv6
   address space being predictable or guessable.  In the extreme case,
   IPv6 hosts might be configured with interface identifiers that are
   very easy to guess; for example, hosts or subnets manually numbered
   with consecutive interface identifiers starting from "1" would be
   much easier to guess.  Such practices should be avoided, and other





<span class="grey">Carpenter &amp; Jiang             Informational                    [Page 19]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-20"></span>
<span class="grey"><a href="./rfc6883">RFC 6883</a>                IPv6 ICP and ASP Guidance             March 2013</span>


   useful precautions are discussed in [<a href="./rfc6583" title='"Operational Neighbor Discovery Problems"'>RFC6583</a>].  Also, attackers might
   find IPv6 addresses in logs, packet traces, DNS records (including
   reverse records), or elsewhere.

   Protection against rogue Router Advertisements (RA Guard) should also
   be considered [<a href="./rfc6105" title='"IPv6 Router Advertisement Guard"'>RFC6105</a>].

   Transport Layer Security version 1.2 [<a href="./rfc5246" title='"The Transport Layer Security (TLS) Protocol Version 1.2"'>RFC5246</a>] and its predecessors
   work correctly with TCP over IPv6, meaning that HTTPS-based security
   solutions are immediately applicable.  The same should apply to any
   other transport-layer or application-layer security techniques.

   If an ASP uses IPsec [<a href="./rfc4301" title='"Security Architecture for the Internet Protocol"'>RFC4301</a>] and the Internet Key Exchange (IKE)
   protocol [<a href="./rfc5996" title='"Internet Key Exchange Protocol Version 2 (IKEv2)"'>RFC5996</a>] in any way to secure connections with clients,
   these too are fully applicable to IPv6, but only if the software
   stack at each end has been appropriately updated.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/15.%20%20Acknowledgements"></a><a class="selflink" href="#section-15" id="section-15">15</a>.  Acknowledgements</span>

   Valuable contributions were made by Erik Kline.  Useful comments were
   received from Tore Anderson, Cameron Byrne, Tassos Chatzithomaoglou,
   Wesley George, Deng Hui, Joel Jaeggli, Roger Jorgensen, Victor
   Kuarsingh, Bing Liu, Trent Lloyd, John Mann, Michael Newbery, Erik
   Nygren, Arturo Servin, Mark Smith, and other participants in the
   V6OPS working group.

   Brian Carpenter was a visitor at the Computer Laboratory, Cambridge
   University during part of this work.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/16.%20%20References"></a><a class="selflink" href="#section-16" id="section-16">16</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/16.1.%20%20Normative%20References"></a><a class="selflink" href="#section-16.1" id="section-16.1">16.1</a>.  Normative References</span>

   [<a id="ref-RFC2080">RFC2080</a>]  Malkin, G. and R. Minnear, "RIPng for IPv6", <a href="./rfc2080">RFC 2080</a>,
              January 1997.

   [<a id="ref-RFC2460">RFC2460</a>]  Deering, S. and R. Hinden, "Internet Protocol, Version 6
              (IPv6) Specification", <a href="./rfc2460">RFC 2460</a>, December 1998.

   [<a id="ref-RFC2616">RFC2616</a>]  Fielding, R., Gettys, J., Mogul, J., Frystyk, H.,
              Masinter, L., Leach, P., and T. Berners-Lee, "Hypertext
              Transfer Protocol -- HTTP/1.1", <a href="./rfc2616">RFC 2616</a>, June 1999.

   [<a id="ref-RFC2827">RFC2827</a>]  Ferguson, P. and D. Senie, "Network Ingress Filtering:
              Defeating Denial of Service Attacks which employ IP Source
              Address Spoofing", <a href="https://www.rfc-editor.org/bcp/bcp38">BCP 38</a>, <a href="./rfc2827">RFC 2827</a>, May 2000.





<span class="grey">Carpenter &amp; Jiang             Informational                    [Page 20]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-21"></span>
<span class="grey"><a href="./rfc6883">RFC 6883</a>                IPv6 ICP and ASP Guidance             March 2013</span>


   [<a id="ref-RFC3007">RFC3007</a>]  Wellington, B., "Secure Domain Name System (DNS) Dynamic
              Update", <a href="./rfc3007">RFC 3007</a>, November 2000.

   [<a id="ref-RFC3315">RFC3315</a>]  Droms, R., Bound, J., Volz, B., Lemon, T., Perkins, C.,
              and M. Carney, "Dynamic Host Configuration Protocol for
              IPv6 (DHCPv6)", <a href="./rfc3315">RFC 3315</a>, July 2003.

   [<a id="ref-RFC3596">RFC3596</a>]  Thomson, S., Huitema, C., Ksinant, V., and M. Souissi,
              "DNS Extensions to Support IP Version 6", <a href="./rfc3596">RFC 3596</a>,
              October 2003.

   [<a id="ref-RFC3704">RFC3704</a>]  Baker, F. and P. Savola, "Ingress Filtering for Multihomed
              Networks", <a href="https://www.rfc-editor.org/bcp/bcp84">BCP 84</a>, <a href="./rfc3704">RFC 3704</a>, March 2004.

   [<a id="ref-RFC4193">RFC4193</a>]  Hinden, R. and B. Haberman, "Unique Local IPv6 Unicast
              Addresses", <a href="./rfc4193">RFC 4193</a>, October 2005.

   [<a id="ref-RFC4301">RFC4301</a>]  Kent, S. and K. Seo, "Security Architecture for the
              Internet Protocol", <a href="./rfc4301">RFC 4301</a>, December 2005.

   [<a id="ref-RFC4760">RFC4760</a>]  Bates, T., Chandra, R., Katz, D., and Y. Rekhter,
              "Multiprotocol Extensions for BGP-4", <a href="./rfc4760">RFC 4760</a>,
              January 2007.

   [<a id="ref-RFC4862">RFC4862</a>]  Thomson, S., Narten, T., and T. Jinmei, "IPv6 Stateless
              Address Autoconfiguration", <a href="./rfc4862">RFC 4862</a>, September 2007.

   [<a id="ref-RFC4941">RFC4941</a>]  Narten, T., Draves, R., and S. Krishnan, "Privacy
              Extensions for Stateless Address Autoconfiguration in
              IPv6", <a href="./rfc4941">RFC 4941</a>, September 2007.

   [<a id="ref-RFC5246">RFC5246</a>]  Dierks, T. and E. Rescorla, "The Transport Layer Security
              (TLS) Protocol Version 1.2", <a href="./rfc5246">RFC 5246</a>, August 2008.

   [<a id="ref-RFC5308">RFC5308</a>]  Hopps, C., "Routing IPv6 with IS-IS", <a href="./rfc5308">RFC 5308</a>,
              October 2008.

   [<a id="ref-RFC5340">RFC5340</a>]  Coltun, R., Ferguson, D., Moy, J., and A. Lindem, "OSPF
              for IPv6", <a href="./rfc5340">RFC 5340</a>, July 2008.

   [<a id="ref-RFC5838">RFC5838</a>]  Lindem, A., Mirtorabi, S., Roy, A., Barnes, M., and R.
              Aggarwal, "Support of Address Families in OSPFv3",
              <a href="./rfc5838">RFC 5838</a>, April 2010.

   [<a id="ref-RFC5952">RFC5952</a>]  Kawamura, S. and M. Kawashima, "A Recommendation for IPv6
              Address Text Representation", <a href="./rfc5952">RFC 5952</a>, August 2010.





<span class="grey">Carpenter &amp; Jiang             Informational                    [Page 21]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-22"></span>
<span class="grey"><a href="./rfc6883">RFC 6883</a>                IPv6 ICP and ASP Guidance             March 2013</span>


   [<a id="ref-RFC5985">RFC5985</a>]  Barnes, M., "HTTP-Enabled Location Delivery (HELD)",
              <a href="./rfc5985">RFC 5985</a>, September 2010.

   [<a id="ref-RFC5996">RFC5996</a>]  Kaufman, C., Hoffman, P., Nir, Y., and P. Eronen,
              "Internet Key Exchange Protocol Version 2 (IKEv2)",
              <a href="./rfc5996">RFC 5996</a>, September 2010.

   [<a id="ref-RFC6434">RFC6434</a>]  Jankiewicz, E., Loughney, J., and T. Narten, "IPv6 Node
              Requirements", <a href="./rfc6434">RFC 6434</a>, December 2011.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/16.2.%20%20Informative%20References"></a><a class="selflink" href="#section-16.2" id="section-16.2">16.2</a>.  Informative References</span>

   [<a id="ref-CDN-UPGRADE">CDN-UPGRADE</a>]
              Marsan, C., "Akamai: Why our IPv6 upgrade is harder than
              Google's", Network World, September 2010, &lt;<a href="http://www.networkworld.com/news/2010/091610-akamai-ipv6.html">http://</a>
              <a href="http://www.networkworld.com/news/2010/091610-akamai-ipv6.html">www.networkworld.com/news/2010/091610-akamai-ipv6.html</a>&gt;.

   [<a id="ref-IPv6-CE-REQS">IPv6-CE-REQS</a>]
              Singh, H., Beebee, W., Donley, C., and B. Stark, "Basic
              Requirements for IPv6 Customer Edge Routers", Work
              in Progress, October 2012.

   [<a id="ref-IPv6-NETWORK-DESIGN">IPv6-NETWORK-DESIGN</a>]
              Matthews, P., <a href="https://www.google.com/search?sitesearch=datatracker.ietf.org%2Fdoc%2Fhtml%2F&amp;q=inurl:draft-+%22Design+Choices+for+IPv6+Networks%22" style="text-decoration: none">"Design Choices for IPv6 Networks"</a>, Work
              in Progress, February 2013.

   [<a id="ref-MULTIHOMING-WITHOUT-NAT">MULTIHOMING-WITHOUT-NAT</a>]
              Troan, O., Ed., Miles, D., Matsushima, S., Okimoto, T.,
              and D. Wing, "IPv6 Multihoming without Network Address
              Translation", Work in Progress, February 2012.

   [<a id="ref-RFC1912">RFC1912</a>]  Barr, D., "Common DNS Operational and Configuration
              Errors", <a href="./rfc1912">RFC 1912</a>, February 1996.

   [<a id="ref-RFC2081">RFC2081</a>]  Malkin, G., "RIPng Protocol Applicability Statement",
              <a href="./rfc2081">RFC 2081</a>, January 1997.

   [<a id="ref-RFC2923">RFC2923</a>]  Lahey, K., "TCP Problems with Path MTU Discovery",
              <a href="./rfc2923">RFC 2923</a>, September 2000.

   [<a id="ref-RFC3068">RFC3068</a>]  Huitema, C., "An Anycast Prefix for 6to4 Relay Routers",
              <a href="./rfc3068">RFC 3068</a>, June 2001.

   [<a id="ref-RFC4038">RFC4038</a>]  Shin, M-K., Hong, Y-G., Hagino, J., Savola, P., and E.
              Castro, "Application Aspects of IPv6 Transition",
              <a href="./rfc4038">RFC 4038</a>, March 2005.





<span class="grey">Carpenter &amp; Jiang             Informational                    [Page 22]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-23"></span>
<span class="grey"><a href="./rfc6883">RFC 6883</a>                IPv6 ICP and ASP Guidance             March 2013</span>


   [<a id="ref-RFC4192">RFC4192</a>]  Baker, F., Lear, E., and R. Droms, "Procedures for
              Renumbering an IPv6 Network without a Flag Day", <a href="./rfc4192">RFC 4192</a>,
              September 2005.

   [<a id="ref-RFC4864">RFC4864</a>]  Van de Velde, G., Hain, T., Droms, R., Carpenter, B., and
              E. Klein, "Local Network Protection for IPv6", <a href="./rfc4864">RFC 4864</a>,
              May 2007.

   [<a id="ref-RFC4890">RFC4890</a>]  Davies, E. and J. Mohacsi, "Recommendations for Filtering
              ICMPv6 Messages in Firewalls", <a href="./rfc4890">RFC 4890</a>, May 2007.

   [<a id="ref-RFC5157">RFC5157</a>]  Chown, T., "IPv6 Implications for Network Scanning",
              <a href="./rfc5157">RFC 5157</a>, March 2008.

   [<a id="ref-RFC5375">RFC5375</a>]  Van de Velde, G., Popoviciu, C., Chown, T., Bonness, O.,
              and C. Hahn, "IPv6 Unicast Address Assignment
              Considerations", <a href="./rfc5375">RFC 5375</a>, December 2008.

   [<a id="ref-RFC6105">RFC6105</a>]  Levy-Abegnoli, E., Van de Velde, G., Popoviciu, C., and J.
              Mohacsi, "IPv6 Router Advertisement Guard", <a href="./rfc6105">RFC 6105</a>,
              February 2011.

   [<a id="ref-RFC6146">RFC6146</a>]  Bagnulo, M., Matthews, P., and I. van Beijnum, "Stateful
              NAT64: Network Address and Protocol Translation from IPv6
              Clients to IPv4 Servers", <a href="./rfc6146">RFC 6146</a>, April 2011.

   [<a id="ref-RFC6180">RFC6180</a>]  Arkko, J. and F. Baker, "Guidelines for Using IPv6
              Transition Mechanisms during IPv6 Deployment", <a href="./rfc6180">RFC 6180</a>,
              May 2011.

   [<a id="ref-RFC6296">RFC6296</a>]  Wasserman, M. and F. Baker, "IPv6-to-IPv6 Network Prefix
              Translation", <a href="./rfc6296">RFC 6296</a>, June 2011.

   [<a id="ref-RFC6343">RFC6343</a>]  Carpenter, B., "Advisory Guidelines for 6to4 Deployment",
              <a href="./rfc6343">RFC 6343</a>, August 2011.

   [<a id="ref-RFC6555">RFC6555</a>]  Wing, D. and A. Yourtchenko, "Happy Eyeballs: Success with
              Dual-Stack Hosts", <a href="./rfc6555">RFC 6555</a>, April 2012.

   [<a id="ref-RFC6583">RFC6583</a>]  Gashinsky, I., Jaeggli, J., and W. Kumari, "Operational
              Neighbor Discovery Problems", <a href="./rfc6583">RFC 6583</a>, March 2012.

   [<a id="ref-RFC6589">RFC6589</a>]  Livingood, J., "Considerations for Transitioning Content
              to IPv6", <a href="./rfc6589">RFC 6589</a>, April 2012.

   [<a id="ref-RFC6866">RFC6866</a>]  Carpenter, B. and S. Jiang, "Problem Statement for
              Renumbering IPv6 Hosts with Static Addresses in Enterprise
              Networks", <a href="./rfc6866">RFC 6866</a>, February 2013.



<span class="grey">Carpenter &amp; Jiang             Informational                    [Page 23]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-24"></span>
<span class="grey"><a href="./rfc6883">RFC 6883</a>                IPv6 ICP and ASP Guidance             March 2013</span>


   [<a id="ref-RFC6879">RFC6879</a>]  Jiang, S., Liu, B., and B. Carpenter, "IPv6 Enterprise
              Network Renumbering Scenarios, Considerations, and
              Methods", <a href="./rfc6879">RFC 6879</a>, February 2013.

   [<a id="ref-VPN-LEAKAGES">VPN-LEAKAGES</a>]
              Gont, F., "Virtual Private Network (VPN) traffic leakages
              in dual-stack hosts/networks", Work in Progress,
              December 2012.

Authors' Addresses

   Brian Carpenter
   Department of Computer Science
   University of Auckland
   PB 92019
   Auckland  1142
   New Zealand

   EMail: brian.e.carpenter@gmail.com


   Sheng Jiang
   Huawei Technologies Co., Ltd
   Q14, Huawei Campus
   No. 156 Beiqing Road
   Hai-Dian District, Beijing  100095
   P.R. China

   EMail: jiangsheng@huawei.com






















Carpenter &amp; Jiang             Informational                    [Page 24]
</pre>
</body></html>