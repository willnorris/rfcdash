<!DOCTYPE html>
<html class="RFC" lang="en"><head>
<meta charset="utf-8"/>
<meta content="Common,Latin" name="scripts"/>
<meta content="initial-scale=1.0" name="viewport"/>
<title>RFC 8760: The Session Initiation Protocol (SIP) Digest Access Authentication Scheme</title>
<meta content="Rifaat Shekh-Yusef" name="author"/>
<meta content="
       
   This document updates RFC 3261 by modifying the Digest Access 
   Authentication scheme used by the Session Initiation Protocol (SIP) to add support 
   for more secure digest algorithms, e.g., SHA-256 and SHA-512/256, to replace the 
   obsolete MD5 algorithm.


       
    " name="description"/>
<meta content="xml2rfc 2.40.1" name="generator"/>
<meta content="Digest Auth" name="keyword"/>
<meta content="8760" name="rfc.number"/>
<link href="rfc8760.xml" rel="alternate" type="application/rfc+xml"/>
<link href="#copyright" rel="license"/>
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Avoid wrapping of URLs in references */
@media screen {
  .references a {
    white-space: nowrap;
  }
}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin: 0 0 0.25em 0;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/*
  The margin-left: 0 on <dd> removes all distinction
  between levels from nested <dl>s.  Undo that.
*/
dl.olPercent > dd,
dd {
  margin-left: revert;
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css"/>
<link href="https://dx.doi.org/10.17487/rfc8760" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <link href="https://datatracker.ietf.org/doc/draft-ietf-sipcore-digest-scheme-15" rel="prev"/>
  </head>
<body>
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 8760</td>
<td class="center">SIP Digest Authentication</td>
<td class="right">March 2020</td>
</tr></thead>
<tfoot><tr>
<td class="left">Shekh-Yusef</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div class="document-information" id="external-metadata"></div>
<div class="document-information" id="internal-metadata">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a class="eref" href="https://www.rfc-editor.org/rfc/rfc8760">8760</a></dd>
<dt class="label-updates">Updates:</dt>
<dd class="updates">
<a class="eref" href="https://www.rfc-editor.org/rfc/rfc3261">3261</a> </dd>
<dt class="label-category">Category:</dt>
<dd class="category">Standards Track</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time class="published" datetime="2020-03">March 2020</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">R. Shekh-Yusef</div>
<div class="org">Avaya</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 8760</h1>
<h1 id="title">The Session Initiation Protocol (SIP) Digest Access Authentication Scheme</h1>
<section id="section-abstract">
      <h2 id="abstract"><a class="selfRef" href="#abstract">Abstract</a></h2>
<p id="section-abstract-1">
   This document updates RFC 3261 by modifying the Digest Access 
   Authentication scheme used by the Session Initiation Protocol (SIP) to add support 
   for more secure digest algorithms, e.g., SHA-256 and SHA-512/256, to replace the 
   obsolete MD5 algorithm.<a class="pilcrow" href="#section-abstract-1">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a class="section-name selfRef" href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This is an Internet Standards Track document.<a class="pilcrow" href="#section-boilerplate.1-1">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.<a class="pilcrow" href="#section-boilerplate.1-2">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc8760">https://www.rfc-editor.org/info/rfc8760</a></span>.<a class="pilcrow" href="#section-boilerplate.1-3">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a class="section-name selfRef" href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2020 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a class="pilcrow" href="#section-boilerplate.2-1">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a class="pilcrow" href="#section-boilerplate.2-2">¶</a></p>
<p id="section-boilerplate.2-3">
            This document may contain material from IETF Documents or IETF
            Contributions published or made publicly available before November
            10, 2008. The person(s) controlling the copyright in some of this
            material may not have granted the IETF Trust the right to allow
            modifications of such material outside the IETF Standards Process.
            Without obtaining an adequate license from the person(s)
            controlling the copyright in such materials, this document may not
            be modified outside the IETF Standards Process, and derivative
            works of it may not be created outside the IETF Standards Process,
            except to format it for publication as an RFC or to translate it
            into languages other than English.<a class="pilcrow" href="#section-boilerplate.2-3">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a class="toplink" href="#" onclick="scroll(0,0)">▲</a><h2 id="name-table-of-contents">
<a class="section-name selfRef" href="#name-table-of-contents">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a class="xref" href="#section-1">1</a>.  <a class="xref" href="#name-introduction">Introduction</a><a class="pilcrow" href="#section-toc.1-1.1.1">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1"><a class="xref" href="#section-1.1">1.1</a>.  <a class="xref" href="#name-terminology">Terminology</a><a class="pilcrow" href="#section-toc.1-1.1.2.1.1">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a class="xref" href="#section-2">2</a>.  <a class="xref" href="#name-updates-to-the-sip-digest-a">Updates to the SIP Digest Access Authentication Scheme</a><a class="pilcrow" href="#section-toc.1-1.2.1">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a class="xref" href="#section-2.1">2.1</a>.  <a class="xref" href="#name-hash-algorithms">Hash Algorithms</a><a class="pilcrow" href="#section-toc.1-1.2.2.1.1">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a class="xref" href="#section-2.2">2.2</a>.  <a class="xref" href="#name-representation-of-digest-va">Representation of Digest Values</a><a class="pilcrow" href="#section-toc.1-1.2.2.2.1">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a class="xref" href="#section-2.3">2.3</a>.  <a class="xref" href="#name-uas-behavior">UAS Behavior</a><a class="pilcrow" href="#section-toc.1-1.2.2.3.1">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.2.2.4">
                <p id="section-toc.1-1.2.2.4.1"><a class="xref" href="#section-2.4">2.4</a>.  <a class="xref" href="#name-uac-behavior">UAC Behavior</a><a class="pilcrow" href="#section-toc.1-1.2.2.4.1">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.2.2.5">
                <p id="section-toc.1-1.2.2.5.1"><a class="xref" href="#section-2.5">2.5</a>.  <a class="xref" href="#name-forking">Forking</a><a class="pilcrow" href="#section-toc.1-1.2.2.5.1">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.2.2.6">
                <p id="section-toc.1-1.2.2.6.1"><a class="xref" href="#section-2.6">2.6</a>.  <a class="xref" href="#name-http-digest-authentication-">HTTP Digest Authentication Scheme Modifications</a><a class="pilcrow" href="#section-toc.1-1.2.2.6.1">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.2.2.7">
                <p id="section-toc.1-1.2.2.7.1"><a class="xref" href="#section-2.7">2.7</a>.  <a class="xref" href="#name-abnf-for-sip">ABNF for SIP</a><a class="pilcrow" href="#section-toc.1-1.2.2.7.1">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a class="xref" href="#section-3">3</a>.  <a class="xref" href="#name-security-considerations">Security Considerations</a><a class="pilcrow" href="#section-toc.1-1.3.1">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a class="xref" href="#section-4">4</a>.  <a class="xref" href="#name-iana-considerations">IANA Considerations</a><a class="pilcrow" href="#section-toc.1-1.4.1">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a class="xref" href="#section-5">5</a>.  <a class="xref" href="#name-references">References</a><a class="pilcrow" href="#section-toc.1-1.5.1">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a class="xref" href="#section-5.1">5.1</a>.  <a class="xref" href="#name-normative-references">Normative References</a><a class="pilcrow" href="#section-toc.1-1.5.2.1.1">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a class="xref" href="#section-5.2">5.2</a>.  <a class="xref" href="#name-informative-references">Informative References</a><a class="pilcrow" href="#section-toc.1-1.5.2.2.1">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a class="xref" href="#section-appendix.a"></a><a class="xref" href="#name-acknowledgments">Acknowledgments</a><a class="pilcrow" href="#section-toc.1-1.6.1">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a class="xref" href="#section-appendix.b"></a><a class="xref" href="#name-authors-address">Author's Address</a><a class="pilcrow" href="#section-toc.1-1.7.1">¶</a></p>
</li>
</ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a class="section-number selfRef" href="#section-1">1. </a><a class="section-name selfRef" href="#name-introduction">Introduction</a>
      </h2>
<p id="section-1-1">
    The Session Initiation Protocol <span>[<a class="xref" href="#RFC3261">RFC3261</a>]</span> uses the same mechanism
    as the Hypertext Transfer Protocol (HTTP) does for authenticating
    users. This mechanism is called "Digest Access Authentication". It is a simple challenge-response mechanism that allows a server
    to challenge a client request and allows a client to provide
    authentication information in response to that challenge. The
    version of Digest Access Authentication that <span>[<a class="xref" href="#RFC3261">RFC3261</a>]</span> references
    is specified in <span>[<a class="xref" href="#RFC2617">RFC2617</a>]</span>.<a class="pilcrow" href="#section-1-1">¶</a></p>
<p id="section-1-2">
    The default hash algorithm for Digest Access Authentication is MD5.
    However, it has been demonstrated that the MD5 algorithm is not
    collision resistant and is now considered a bad choice for a hash
    function (see <span>[<a class="xref" href="#RFC6151">RFC6151</a>]</span>).<a class="pilcrow" href="#section-1-2">¶</a></p>
<p id="section-1-3">
    The HTTP Digest Access Authentication document <span>[<a class="xref" href="#RFC7616">RFC7616</a>]</span> obsoletes
    <span>[<a class="xref" href="#RFC2617">RFC2617</a>]</span> and adds stronger algorithms that can be used with
    the Digest Access Authentication scheme and establishes a registry for
    these algorithms, known as the "Hash Algorithms for HTTP Digest
    Authentication" IANA registry, so that algorithms can be added in the
    future.<a class="pilcrow" href="#section-1-3">¶</a></p>
<p id="section-1-4">
    This document updates the Digest Access Authentication scheme used
    by SIP to support the algorithms listed in the "Hash Algorithms
    for HTTP Digest Authentication" IANA registry defined by <span>[<a class="xref" href="#RFC7616">RFC7616</a>]</span>.<a class="pilcrow" href="#section-1-4">¶</a></p>
<div id="terminology">
<section id="section-1.1">
        <h3 id="name-terminology">
<a class="section-number selfRef" href="#section-1.1">1.1. </a><a class="section-name selfRef" href="#name-terminology">Terminology</a>
        </h3>
<p id="section-1.1-1">
    The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
    "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
    described in BCP 14 <span>[<a class="xref" href="#RFC2119">RFC2119</a>]</span> <span>[<a class="xref" href="#RFC8174">RFC8174</a>]</span> 
    when, and only when, they appear in all capitals, as shown here.<a class="pilcrow" href="#section-1.1-1">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sip.digest.scheme">
<section id="section-2">
      <h2 id="name-updates-to-the-sip-digest-a">
<a class="section-number selfRef" href="#section-2">2. </a><a class="section-name selfRef" href="#name-updates-to-the-sip-digest-a">Updates to the SIP Digest Access Authentication Scheme</a>
      </h2>
<p id="section-2-1">
    This section describes the modifications to the operation of the
    Digest mechanism as specified in <span>[<a class="xref" href="#RFC3261">RFC3261</a>]</span> in order to support 
    the algorithms defined in the "Hash Algorithms for HTTP Digest Authentication" 
    IANA registry described in <span>[<a class="xref" href="#RFC7616">RFC7616</a>]</span>.<a class="pilcrow" href="#section-2-1">¶</a></p>
<p id="section-2-2">
    It replaces the reference used in <span>[<a class="xref" href="#RFC3261">RFC3261</a>]</span> for Digest Access Authentication, 
    substituting <span>[<a class="xref" href="#RFC7616">RFC7616</a>]</span> for the obsolete <span>[<a class="xref" href="#RFC2617">RFC2617</a>]</span>, and describes 
    the modifications to the usage of the Digest mechanism in <span>[<a class="xref" href="#RFC3261">RFC3261</a>]</span> 
    resulting from that reference update. It adds support for the SHA-256 and SHA-512/256 algorithms <span>[<a class="xref" href="#SHA2">SHA2</a>]</span>. 
    It adds required support for the "qop" parameter. It provides additional User Agent Client (UAC) 
    and User Agent Server (UAS) procedures regarding usage of multiple SIP Authorization, 
    WWW-Authenticate, and Proxy-Authenticate header fields, including the order
    in which to insert 
    and process them. It provides guidance regarding forking. Finally, it updates the SIP ABNF 
    as required by the updates.<a class="pilcrow" href="#section-2-2">¶</a></p>
<div id="hash.algorithms">
<section id="section-2.1">
        <h3 id="name-hash-algorithms">
<a class="section-number selfRef" href="#section-2.1">2.1. </a><a class="section-name selfRef" href="#name-hash-algorithms">Hash Algorithms</a>
        </h3>
<p id="section-2.1-1">
      The Digest Access Authentication scheme has an "algorithm" parameter that specifies the
      algorithm to be used to compute the digest of the response. The "Hash
      Algorithms for HTTP Digest Authentication" IANA registry specifies 
      the algorithms that correspond to 'algorithm' values.<a class="pilcrow" href="#section-2.1-1">¶</a></p>
<p id="section-2.1-2">
      <span>[<a class="xref" href="#RFC3261">RFC3261</a>]</span> specifies only one algorithm, MD5, which is used by default.
      This document extends <span>[<a class="xref" href="#RFC3261">RFC3261</a>]</span> to allow use of any algorithm listed in
      the "Hash Algorithms for HTTP Digest Authentication" IANA registry.<a class="pilcrow" href="#section-2.1-2">¶</a></p>
<p id="section-2.1-3">
     A UAS prioritizes which algorithm to use based on its policy,
     which is specified in <a class="xref" href="#uas.behavior">Section 2.3</a> and parallels the process used in
     HTTP specified by <span>[<a class="xref" href="#RFC7616">RFC7616</a>]</span>.<a class="pilcrow" href="#section-2.1-3">¶</a></p>
</section>
</div>
<div id="rep.digest.values">
<section id="section-2.2">
        <h3 id="name-representation-of-digest-va">
<a class="section-number selfRef" href="#section-2.2">2.2. </a><a class="section-name selfRef" href="#name-representation-of-digest-va">Representation of Digest Values</a>
        </h3>
<p id="section-2.2-1">
      The size of the digest depends on the algorithm used.  The bits in
      the digest are converted from the most significant to the least
      significant bit, four bits at a time, to the ASCII representation as
      follows. Each set of four bits is represented by its familiar hexadecimal
      notation from the characters 0123456789abcdef; that is, binary 0000 is
      represented by the character '0', 0001 is represented by '1', and so on up to the
      representation of 1111 as 'f'. If the SHA-256 or SHA-512/256 algorithm is 
      used to calculate the digest, then the digest will be represented as 64 
      hexadecimal characters.<a class="pilcrow" href="#section-2.2-1">¶</a></p>
</section>
</div>
<div id="uas.behavior">
<section id="section-2.3">
        <h3 id="name-uas-behavior">
<a class="section-number selfRef" href="#section-2.3">2.3. </a><a class="section-name selfRef" href="#name-uas-behavior">UAS Behavior</a>
        </h3>
<p id="section-2.3-1">
      When a UAS receives a request from a UAC, and an acceptable
      Authorization header field is not received, the UAS can challenge the
      originator to provide credentials by rejecting the request with a
      401/407 status code with the WWW-Authenticate/Proxy-Authenticate
      header field, respectively. The UAS <span class="bcp14">MAY</span> add multiple WWW-Authenticate/Proxy-Authenticate
      header fields to allow the UAS to utilize the best available
      algorithm supported by the client.<a class="pilcrow" href="#section-2.3-1">¶</a></p>
<p id="section-2.3-2">
      If the UAS challenges the originator using multiple WWW-Authenticate/Proxy-Authenticate 
      header fields with the same realm, then each of these
      header fields <span class="bcp14">MUST</span> use a different digest algorithm. The UAS <span class="bcp14">MUST</span> add these
      header fields to the response in the order in which it would prefer to see them
      used, starting with the most preferred algorithm at the top. The UAS cannot assume that the client 
      will use the algorithm specified in the topmost header field.<a class="pilcrow" href="#section-2.3-2">¶</a></p>
</section>
</div>
<div id="uac.behavior">
<section id="section-2.4">
        <h3 id="name-uac-behavior">
<a class="section-number selfRef" href="#section-2.4">2.4. </a><a class="section-name selfRef" href="#name-uac-behavior">UAC Behavior</a>
        </h3>
<p id="section-2.4-1">      When the UAC receives a response with multiple WWW-Authenticate/Proxy-Authenticate 
      header fields with the same realm, it <span class="bcp14">SHOULD</span> use the topmost 
      header field that it supports unless a local policy dictates otherwise. 
      The client <span class="bcp14">MUST</span> ignore any challenge it does not understand.<a class="pilcrow" href="#section-2.4-1">¶</a></p>
<p id="section-2.4-2">
      When the UAC receives a 401 response with multiple WWW-Authenticate
      header fields with different realms, it <span class="bcp14">SHOULD</span> retry and add an
      Authorization header field containing credentials that match the topmost
      header field of any of the realms unless a local policy dictates otherwise.<a class="pilcrow" href="#section-2.4-2">¶</a></p>
<p id="section-2.4-3">
    If the UAC cannot respond to any of the challenges in the response,
    then it <span class="bcp14">SHOULD</span> abandon attempts to send the request unless a local
    policy dictates otherwise, e.g., the policy might indicate the use of non-Digest mechanisms.  
    For example, if the UAC does not have credentials or has stale credentials for 
    any of the realms, the UAC will abandon the request.<a class="pilcrow" href="#section-2.4-3">¶</a></p>
</section>
</div>
<div id="forking">
<section id="section-2.5">
        <h3 id="name-forking">
<a class="section-number selfRef" href="#section-2.5">2.5. </a><a class="section-name selfRef" href="#name-forking">Forking</a>
        </h3>
<p id="section-2.5-1">
      <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc3261#section-22.3">Section 22.3</a> of [<a class="xref" href="#RFC3261">RFC3261</a>]</span> discusses the operation of the proxy-to-user
      authentication, which describes the operation of the proxy when it
      forks a request. This section clarifies that operation.<a class="pilcrow" href="#section-2.5-1">¶</a></p>
<p id="section-2.5-2">
      If a request is forked, various proxy servers and/or UAs may wish to
      challenge the UAC. In this case, the forking proxy server is
      responsible for aggregating these challenges into a single response.
      Each WWW-Authenticate and Proxy-Authenticate value received in
      response to the forked request <span class="bcp14">MUST</span> be placed into the single
      response that is sent by the forking proxy to the UAC.<a class="pilcrow" href="#section-2.5-2">¶</a></p>
<p id="section-2.5-3">
    When the forking proxy places multiple WWW-Authenticate and Proxy-Authenticate header
    fields received from one downstream proxy into a single response, it <span class="bcp14">MUST</span> maintain
    the order of these header fields.  The ordering of values received from different downstream 
    proxies is not significant.<a class="pilcrow" href="#section-2.5-3">¶</a></p>
</section>
</div>
<div id="http.modifications">
<section id="section-2.6">
        <h3 id="name-http-digest-authentication-">
<a class="section-number selfRef" href="#section-2.6">2.6. </a><a class="section-name selfRef" href="#name-http-digest-authentication-">HTTP Digest Authentication Scheme Modifications</a>
        </h3>
<p id="section-2.6-1">
      This section describes the modifications and clarifications required
      to apply the HTTP Digest Access Authentication scheme to SIP. The SIP scheme
      usage is similar to that for HTTP. For completeness, the bullets specified 
      below are mostly copied from <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc3261#section-22.4">Section 22.4</a> of [<a class="xref" href="#RFC3261">RFC3261</a>]</span>; the 
      only semantic changes are specified in bullets 1, 7, and 8 below.<a class="pilcrow" href="#section-2.6-1">¶</a></p>
<p id="section-2.6-2">
      SIP clients and servers <span class="bcp14">MUST NOT</span> accept or request Basic
      authentication.<a class="pilcrow" href="#section-2.6-2">¶</a></p>
<p id="section-2.6-3">
      The rules for Digest Access Authentication follow those defined in HTTP,
      with "HTTP/1.1" <span>[<a class="xref" href="#RFC7616">RFC7616</a>]</span> replaced by "SIP/2.0" in addition to the following
      differences:<a class="pilcrow" href="#section-2.6-3">¶</a></p>
<ol class="normal type-1" id="section-2.6-4" start="1" type="1">
          <li id="section-2.6-4.1">
            <p id="section-2.6-4.1.1">
The URI included in the challenge has the following ABNF <span>[<a class="xref" href="#RFC5234">RFC5234</a>]</span>:<a class="pilcrow" href="#section-2.6-4.1.1">¶</a></p>
<div id="section-2.6-4.1.2">
<pre class="sourcecode lang-abnf">      URI  =  Request-URI ; as defined in RFC 3261, Section 25
</pre><a class="pilcrow" href="#section-2.6-4.1.2">¶</a>
</div>
</li>
<li id="section-2.6-4.2">
The "uri" parameter of the Authorization header field <span class="bcp14">MUST</span> be
         enclosed in quotation marks.<a class="pilcrow" href="#section-2.6-4.2">¶</a>
</li>
<li id="section-2.6-4.3">
            <p id="section-2.6-4.3.1">
The ABNF for digest-uri-value is:<a class="pilcrow" href="#section-2.6-4.3.1">¶</a></p>
<div id="section-2.6-4.3.2">
<pre class="sourcecode lang-abnf">         digest-uri-value  =  Request-URI
</pre><a class="pilcrow" href="#section-2.6-4.3.2">¶</a>
</div>
</li>
<li id="section-2.6-4.4">
The example procedure for choosing a nonce based on ETag does not
         work for SIP.<a class="pilcrow" href="#section-2.6-4.4">¶</a>
</li>
<li id="section-2.6-4.5">
The text in <span>[<a class="xref" href="#RFC7234">RFC7234</a>]</span> regarding cache operation does not
         apply to SIP.<a class="pilcrow" href="#section-2.6-4.5">¶</a>
</li>
<li id="section-2.6-4.6">
            <span>[<a class="xref" href="#RFC7616">RFC7616</a>]</span> requires that a server check that the URI in the
          request line and the URI included in the Authorization header
          field point to the same resource.  In a SIP context, these two
          URIs may refer to different users due to forwarding at some
          proxy.  Therefore, in SIP, a UAS <span class="bcp14">MUST</span> check if the Request-URI in the
          Authorization/Proxy-Authorization header field value corresponds to a
          user for whom the UAS is willing to accept forwarded or direct
          requests; however, it <span class="bcp14">MAY</span> still accept it if the two fields are not equivalent.<a class="pilcrow" href="#section-2.6-4.6">¶</a>
</li>
<li id="section-2.6-4.7">
            <p id="section-2.6-4.7.1">As a clarification to the calculation of the A2 value for
    message integrity assurance in the Digest Access Authentication
    scheme, implementers should assume that the hash of the entity-body
resolves to the hash of an empty string when the entity-body is empty (that
is, when SIP messages have no body):<a class="pilcrow" href="#section-2.6-4.7.1">¶</a></p>
<div id="section-2.6-4.7.2">
<pre class="sourcecode"> H(entity-body) = &lt;algorithm&gt;("")
</pre><a class="pilcrow" href="#section-2.6-4.7.2">¶</a>
</div>
<p id="section-2.6-4.7.3">For example, when the chosen algorithm is SHA-256, then:<a class="pilcrow" href="#section-2.6-4.7.3">¶</a></p>
<div id="section-2.6-4.7.4">
<pre class="sourcecode"> H(entity-body) = SHA-256("") =
"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855"
</pre><a class="pilcrow" href="#section-2.6-4.7.4">¶</a>
</div>
</li>
<li id="section-2.6-4.8">
            <p id="section-2.6-4.8.1">
A UAS <span class="bcp14">MUST</span> be able to properly handle a "qop" parameter received
         in an Authorization/Proxy-Authorization header field, and a UAC <span class="bcp14">MUST</span> be able to
         properly handle a "qop" parameter received in WWW-Authenticate and
         Proxy-Authenticate header fields. However, for backward compatibility 
         reasons, the "qop" parameter is optional for clients and
  servers based on <span>[<a class="xref" href="#RFC3261">RFC3261</a>]</span> to receive. If the "qop" parameter is not specified, then the default 
         value is "auth".<a class="pilcrow" href="#section-2.6-4.8.1">¶</a></p>
<p id="section-2.6-4.8.2">
         A UAS <span class="bcp14">MUST</span> always send a "qop" parameter in WWW-Authenticate
         and Proxy-Authenticate header field values, and a UAC <span class="bcp14">MUST</span>
         send the "qop" parameter in any resulting authorization header
         field.<a class="pilcrow" href="#section-2.6-4.8.2">¶</a></p>
</li>
</ol>
<p id="section-2.6-5">
      The usage of the Authentication-Info header field continues to be
      allowed, since it provides integrity checks over the bodies and
      provides mutual authentication.<a class="pilcrow" href="#section-2.6-5">¶</a></p>
</section>
</div>
<div id="abnf">
<section id="section-2.7">
        <h3 id="name-abnf-for-sip">
<a class="section-number selfRef" href="#section-2.7">2.7. </a><a class="section-name selfRef" href="#name-abnf-for-sip">ABNF for SIP</a>
        </h3>
<p id="section-2.7-1">
      This document updates the ABNF <span>[<a class="xref" href="#RFC5234">RFC5234</a>]</span> for SIP as
      follows.<a class="pilcrow" href="#section-2.7-1">¶</a></p>
<p id="section-2.7-2">
      It extends the request-digest as follows to allow for different
      digest sizes:<a class="pilcrow" href="#section-2.7-2">¶</a></p>
<div id="section-2.7-3">
<pre class="sourcecode lang-abnf">      request-digest = LDQUOT *LHEX RDQUOT
</pre><a class="pilcrow" href="#section-2.7-3">¶</a>
</div>
<p id="section-2.7-4">
      The number of hex digits is implied by the length of the value of the algorithm used, 
      with a minimum size of 32. A parameter with an empty value (empty string) 
      is allowed when the UAC has not yet received a challenge.<a class="pilcrow" href="#section-2.7-4">¶</a></p>
<p id="section-2.7-5">
      It extends the algorithm parameter as follows to allow any algorithm 
      in the registry to be used:<a class="pilcrow" href="#section-2.7-5">¶</a></p>
<div id="section-2.7-6">
<pre class="sourcecode">algorithm =  "algorithm" EQUAL ( "MD5" / "MD5-sess" / "SHA-256" /
"SHA-256-sess" /
"SHA-512-256" /  "SHA-512-256-sess" / token )
</pre><a class="pilcrow" href="#section-2.7-6">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="security.considerations">
<section id="section-3">
      <h2 id="name-security-considerations">
<a class="section-number selfRef" href="#section-3">3. </a><a class="section-name selfRef" href="#name-security-considerations">Security Considerations</a>
      </h2>
<p id="section-3-1">
    This specification adds new secure algorithms to be used with the
    Digest mechanism to authenticate users. The obsolete MD5 algorithm
    remains only for backward compatibility with <span>[<a class="xref" href="#RFC2617">RFC2617</a>]</span>, but its use is
    <span class="bcp14">NOT RECOMMENDED</span>.<a class="pilcrow" href="#section-3-1">¶</a></p>
<p id="section-3-2">
    This opens the system to the potential for a downgrade attack by an on-path attacker.
    The most effective way of dealing with this type of attack is to either validate the 
    client and challenge it accordingly or remove the support for backward compatibility 
    by not supporting MD5.<a class="pilcrow" href="#section-3-2">¶</a></p>
<p id="section-3-3">
  See <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc7616#section-5">Section 5</a> of [<a class="xref" href="#RFC7616">RFC7616</a>]</span> for a detailed security discussion of
  the Digest Access Authentication scheme.<a class="pilcrow" href="#section-3-3">¶</a></p>
</section>
</div>
<div id="iana.considerations">
<section id="section-4">
      <h2 id="name-iana-considerations">
<a class="section-number selfRef" href="#section-4">4. </a><a class="section-name selfRef" href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<p id="section-4-1">
   <span>[<a class="xref" href="#RFC7616">RFC7616</a>]</span> defines an IANA registry named "Hash Algorithms
   for HTTP Digest Authentication" to simplify the introduction of new
   algorithms in the future. This document specifies that algorithms defined in 
   that registry may be used in SIP digest authentication.<a class="pilcrow" href="#section-4-1">¶</a></p>
<p id="section-4-2">
  This document has no actions for IANA.<a class="pilcrow" href="#section-4-2">¶</a></p>
</section>
</div>
<section id="section-5">
      <h2 id="name-references">
<a class="section-number selfRef" href="#section-5">5. </a><a class="section-name selfRef" href="#name-references">References</a>
      </h2>
<section id="section-5.1">
        <h3 id="name-normative-references">
<a class="section-number selfRef" href="#section-5.1">5.1. </a><a class="section-name selfRef" href="#name-normative-references">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
<dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dt id="RFC3261">[RFC3261]</dt>
<dd>
<span class="refAuthor">Rosenberg, J.</span><span class="refAuthor">, Schulzrinne, H.</span><span class="refAuthor">, Camarillo, G.</span><span class="refAuthor">, Johnston, A.</span><span class="refAuthor">, Peterson, J.</span><span class="refAuthor">, Sparks, R.</span><span class="refAuthor">, Handley, M.</span><span class="refAuthor">, and E. Schooler</span>, <span class="refTitle">"SIP: Session Initiation Protocol"</span>, <span class="seriesInfo">RFC 3261</span>, <span class="seriesInfo">DOI 10.17487/RFC3261</span>, <time datetime="2002-06">June 2002</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3261">https://www.rfc-editor.org/info/rfc3261</a>&gt;</span>. </dd>
<dt id="RFC7234">[RFC7234]</dt>
<dd>
<span class="refAuthor">Fielding, R., Ed.</span><span class="refAuthor">, Nottingham, M., Ed.</span><span class="refAuthor">, and J. Reschke, Ed.</span>, <span class="refTitle">"Hypertext Transfer Protocol (HTTP/1.1): Caching"</span>, <span class="seriesInfo">RFC 7234</span>, <span class="seriesInfo">DOI 10.17487/RFC7234</span>, <time datetime="2014-06">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7234">https://www.rfc-editor.org/info/rfc7234</a>&gt;</span>. </dd>
<dt id="RFC7616">[RFC7616]</dt>
<dd>
<span class="refAuthor">Shekh-Yusef, R., Ed.</span><span class="refAuthor">, Ahrens, D.</span><span class="refAuthor">, and S. Bremer</span>, <span class="refTitle">"HTTP Digest Access Authentication"</span>, <span class="seriesInfo">RFC 7616</span>, <span class="seriesInfo">DOI 10.17487/RFC7616</span>, <time datetime="2015-09">September 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7616">https://www.rfc-editor.org/info/rfc7616</a>&gt;</span>. </dd>
<dt id="RFC8174">[RFC8174]</dt>
<dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dt id="SHA2">[SHA2]</dt>
<dd>
<span class="refAuthor">National Institute of Standards and Technology</span>, <span class="refTitle">"Secure Hash Standard (SHS)"</span>, <span class="seriesInfo">DOI 10.6028/NIST.FIPS.180-4</span>, <span class="seriesInfo">FIPS 180-4</span>, <time datetime="2015-08">August 2015</time>, <span>&lt;<a href="https://doi.org/10.6028/NIST.FIPS.180-4">https://doi.org/10.6028/NIST.FIPS.180-4</a>&gt;</span>. </dd>
</dl>
</section>
<section id="section-5.2">
        <h3 id="name-informative-references">
<a class="section-number selfRef" href="#section-5.2">5.2. </a><a class="section-name selfRef" href="#name-informative-references">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC2617">[RFC2617]</dt>
<dd>
<span class="refAuthor">Franks, J.</span><span class="refAuthor">, Hallam-Baker, P.</span><span class="refAuthor">, Hostetler, J.</span><span class="refAuthor">, Lawrence, S.</span><span class="refAuthor">, Leach, P.</span><span class="refAuthor">, Luotonen, A.</span><span class="refAuthor">, and L. Stewart</span>, <span class="refTitle">"HTTP Authentication: Basic and Digest Access Authentication"</span>, <span class="seriesInfo">RFC 2617</span>, <span class="seriesInfo">DOI 10.17487/RFC2617</span>, <time datetime="1999-06">June 1999</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2617">https://www.rfc-editor.org/info/rfc2617</a>&gt;</span>. </dd>
<dt id="RFC5234">[RFC5234]</dt>
<dd>
<span class="refAuthor">Crocker, D., Ed.</span><span class="refAuthor"> and P. Overell</span>, <span class="refTitle">"Augmented BNF for Syntax Specifications: ABNF"</span>, <span class="seriesInfo">STD 68</span>, <span class="seriesInfo">RFC 5234</span>, <span class="seriesInfo">DOI 10.17487/RFC5234</span>, <time datetime="2008-01">January 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5234">https://www.rfc-editor.org/info/rfc5234</a>&gt;</span>. </dd>
<dt id="RFC6151">[RFC6151]</dt>
<dd>
<span class="refAuthor">Turner, S.</span><span class="refAuthor"> and L. Chen</span>, <span class="refTitle">"Updated Security Considerations for the MD5 Message-Digest and the HMAC-MD5 Algorithms"</span>, <span class="seriesInfo">RFC 6151</span>, <span class="seriesInfo">DOI 10.17487/RFC6151</span>, <time datetime="2011-03">March 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6151">https://www.rfc-editor.org/info/rfc6151</a>&gt;</span>. </dd>
</dl>
</section>
</section>
<div id="acknowledgments">
<section id="section-appendix.a">
      <h2 id="name-acknowledgments">
<a class="section-name selfRef" href="#name-acknowledgments">Acknowledgments</a>
      </h2>
<p id="section-appendix.a-1">
    The author would like to thank the following individuals
    for their careful review, comments, and suggestions: <span class="contact-name">Paul Kyzivat</span>,
    <span class="contact-name">Olle Johansson</span>, <span class="contact-name">Dale Worley</span>, <span class="contact-name">Michael Procter</span>, <span class="contact-name">Inaki Baz Castillo</span>,
    <span class="contact-name">Tolga Asveren</span>, <span class="contact-name">Christer Holmberg</span>, <span class="contact-name">Brian Rosen</span>, <span class="contact-name">Jean Mahoney</span>, <span class="contact-name">Adam Roach</span>, 
    <span class="contact-name">Barry Leiba</span>, <span class="contact-name">Roni Even</span>, <span class="contact-name">Eric Vyncke</span>, <span class="contact-name">Benjamin Kaduk</span>, <span class="contact-name">Alissa Cooper</span>, <span class="contact-name">Roman Danyliw</span>, <span class="contact-name">Alexey Melnikov</span>, and <span class="contact-name">Maxim Sobolev</span>.<a class="pilcrow" href="#section-appendix.a-1">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="section-appendix.b">
      <h2 id="name-authors-address">
<a class="section-name selfRef" href="#name-authors-address">Author's Address</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Rifaat Shekh-Yusef</span></div>
<div class="left" dir="auto"><span class="org">Avaya</span></div>
<div class="left" dir="auto"><span class="street-address">425 Legget Dr.</span></div>
<div class="left" dir="auto">
<span class="locality">Ottawa</span> <span class="region">Ontario</span> </div>
<div class="left" dir="auto"><span class="country-name">Canada</span></div>
<div class="tel">
<span>Phone:</span>
<a class="tel" href="tel:+1-613-595-9106">+1-613-595-9106</a>
</div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:rifaat.ietf@gmail.com">rifaat.ietf@gmail.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>


</body></html>